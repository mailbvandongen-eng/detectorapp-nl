const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/romeinseFortenOL-r2i3bfYV.js","assets/iconStyles-Mdz4m0k1.js","assets/amkOL-CZqz_adf.js","assets/layerLoaderOL-FemGwbvr.js","assets/romeinsOL-D7dIAnPs.js","assets/kastelenOL-Bkn_j31w.js","assets/ruinesOL-DIgzFkLW.js","assets/hunebeddenOL-T_w88NNH.js","assets/uikavArcheoPuntenOL-CO8fZSOp.js","assets/uikavVlakkenOL-DBGkps92.js","assets/uikavBufferlaagOL-CHbtwKla.js","assets/uikavExpertOL-D138lIij.js","assets/uikavUiterwaardenOL-B-m2QBUk.js","assets/speeltuinenOL-0MawOUu-.js","assets/museaOL-Dv_T35vo.js","assets/strandjesOL-D2y5PksW.js","assets/parkenOL-DazVuPyW.js","assets/kringloopwinkelsOL-BwCnEo0k.js","assets/fossielenOL-pSI3Yh7S.js","assets/fossielUtils-C3WAQDtL.js","assets/fossielenBelgieOL-CDbkVlxA.js","assets/fossielenDuitslandOL-Bt7CgL-2.js","assets/fossielenFrankrijkOL-B5uAxAD6.js","assets/bunkersOL-B4jJDcvL.js","assets/grafheuvelsOL-D8lszf2a.js","assets/slagveldenOL-Se0FlgsO.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();function Wb(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var _2={exports:{}},Mg={},x2={exports:{}},ln={};var Sk;function EB(){if(Sk)return ln;Sk=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),a=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;function g(se){return se===null||typeof se!="object"?null:(se=f&&se[f]||se["@@iterator"],typeof se=="function"?se:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,x={};function E(se,V,J){this.props=se,this.context=V,this.refs=x,this.updater=J||y}E.prototype.isReactComponent={},E.prototype.setState=function(se,V){if(typeof se!="object"&&typeof se!="function"&&se!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,se,V,"setState")},E.prototype.forceUpdate=function(se){this.updater.enqueueForceUpdate(this,se,"forceUpdate")};function T(){}T.prototype=E.prototype;function b(se,V,J){this.props=se,this.context=V,this.refs=x,this.updater=J||y}var I=b.prototype=new T;I.constructor=b,v(I,E.prototype),I.isPureReactComponent=!0;var M=Array.isArray,F=Object.prototype.hasOwnProperty,z={current:null},k={key:!0,ref:!0,__self:!0,__source:!0};function C(se,V,J){var ne,X={},ue=null,Me=null;if(V!=null)for(ne in V.ref!==void 0&&(Me=V.ref),V.key!==void 0&&(ue=""+V.key),V)F.call(V,ne)&&!k.hasOwnProperty(ne)&&(X[ne]=V[ne]);var je=arguments.length-2;if(je===1)X.children=J;else if(1<je){for(var De=Array(je),Be=0;Be<je;Be++)De[Be]=arguments[Be+2];X.children=De}if(se&&se.defaultProps)for(ne in je=se.defaultProps,je)X[ne]===void 0&&(X[ne]=je[ne]);return{$$typeof:n,type:se,key:ue,ref:Me,props:X,_owner:z.current}}function P(se,V){return{$$typeof:n,type:se.type,key:V,ref:se.ref,props:se.props,_owner:se._owner}}function L(se){return typeof se=="object"&&se!==null&&se.$$typeof===n}function O(se){var V={"=":"=0",":":"=2"};return"$"+se.replace(/[=:]/g,function(J){return V[J]})}var U=/\/+/g;function j(se,V){return typeof se=="object"&&se!==null&&se.key!=null?O(""+se.key):V.toString(36)}function Ie(se,V,J,ne,X){var ue=typeof se;(ue==="undefined"||ue==="boolean")&&(se=null);var Me=!1;if(se===null)Me=!0;else switch(ue){case"string":case"number":Me=!0;break;case"object":switch(se.$$typeof){case n:case e:Me=!0}}if(Me)return Me=se,X=X(Me),se=ne===""?"."+j(Me,0):ne,M(X)?(J="",se!=null&&(J=se.replace(U,"$&/")+"/"),Ie(X,V,J,"",function(Be){return Be})):X!=null&&(L(X)&&(X=P(X,J+(!X.key||Me&&Me.key===X.key?"":(""+X.key).replace(U,"$&/")+"/")+se)),V.push(X)),1;if(Me=0,ne=ne===""?".":ne+":",M(se))for(var je=0;je<se.length;je++){ue=se[je];var De=ne+j(ue,je);Me+=Ie(ue,V,J,De,X)}else if(De=g(se),typeof De=="function")for(se=De.call(se),je=0;!(ue=se.next()).done;)ue=ue.value,De=ne+j(ue,je++),Me+=Ie(ue,V,J,De,X);else if(ue==="object")throw V=String(se),Error("Objects are not valid as a React child (found: "+(V==="[object Object]"?"object with keys {"+Object.keys(se).join(", ")+"}":V)+"). If you meant to render a collection of children, use an array instead.");return Me}function ke(se,V,J){if(se==null)return se;var ne=[],X=0;return Ie(se,ne,"","",function(ue){return V.call(J,ue,X++)}),ne}function ze(se){if(se._status===-1){var V=se._result;V=V(),V.then(function(J){(se._status===0||se._status===-1)&&(se._status=1,se._result=J)},function(J){(se._status===0||se._status===-1)&&(se._status=2,se._result=J)}),se._status===-1&&(se._status=0,se._result=V)}if(se._status===1)return se._result.default;throw se._result}var Ne={current:null},ce={transition:null},Te={ReactCurrentDispatcher:Ne,ReactCurrentBatchConfig:ce,ReactCurrentOwner:z};function Ee(){throw Error("act(...) is not supported in production builds of React.")}return ln.Children={map:ke,forEach:function(se,V,J){ke(se,function(){V.apply(this,arguments)},J)},count:function(se){var V=0;return ke(se,function(){V++}),V},toArray:function(se){return ke(se,function(V){return V})||[]},only:function(se){if(!L(se))throw Error("React.Children.only expected to receive a single React element child.");return se}},ln.Component=E,ln.Fragment=t,ln.Profiler=i,ln.PureComponent=b,ln.StrictMode=r,ln.Suspense=l,ln.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Te,ln.act=Ee,ln.cloneElement=function(se,V,J){if(se==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+se+".");var ne=v({},se.props),X=se.key,ue=se.ref,Me=se._owner;if(V!=null){if(V.ref!==void 0&&(ue=V.ref,Me=z.current),V.key!==void 0&&(X=""+V.key),se.type&&se.type.defaultProps)var je=se.type.defaultProps;for(De in V)F.call(V,De)&&!k.hasOwnProperty(De)&&(ne[De]=V[De]===void 0&&je!==void 0?je[De]:V[De])}var De=arguments.length-2;if(De===1)ne.children=J;else if(1<De){je=Array(De);for(var Be=0;Be<De;Be++)je[Be]=arguments[Be+2];ne.children=je}return{$$typeof:n,type:se.type,key:X,ref:ue,props:ne,_owner:Me}},ln.createContext=function(se){return se={$$typeof:a,_currentValue:se,_currentValue2:se,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},se.Provider={$$typeof:s,_context:se},se.Consumer=se},ln.createElement=C,ln.createFactory=function(se){var V=C.bind(null,se);return V.type=se,V},ln.createRef=function(){return{current:null}},ln.forwardRef=function(se){return{$$typeof:o,render:se}},ln.isValidElement=L,ln.lazy=function(se){return{$$typeof:h,_payload:{_status:-1,_result:se},_init:ze}},ln.memo=function(se,V){return{$$typeof:u,type:se,compare:V===void 0?null:V}},ln.startTransition=function(se){var V=ce.transition;ce.transition={};try{se()}finally{ce.transition=V}},ln.unstable_act=Ee,ln.useCallback=function(se,V){return Ne.current.useCallback(se,V)},ln.useContext=function(se){return Ne.current.useContext(se)},ln.useDebugValue=function(){},ln.useDeferredValue=function(se){return Ne.current.useDeferredValue(se)},ln.useEffect=function(se,V){return Ne.current.useEffect(se,V)},ln.useId=function(){return Ne.current.useId()},ln.useImperativeHandle=function(se,V,J){return Ne.current.useImperativeHandle(se,V,J)},ln.useInsertionEffect=function(se,V){return Ne.current.useInsertionEffect(se,V)},ln.useLayoutEffect=function(se,V){return Ne.current.useLayoutEffect(se,V)},ln.useMemo=function(se,V){return Ne.current.useMemo(se,V)},ln.useReducer=function(se,V,J){return Ne.current.useReducer(se,V,J)},ln.useRef=function(se){return Ne.current.useRef(se)},ln.useState=function(se){return Ne.current.useState(se)},ln.useSyncExternalStore=function(se,V,J){return Ne.current.useSyncExternalStore(se,V,J)},ln.useTransition=function(){return Ne.current.useTransition()},ln.version="18.3.1",ln}var Tk;function Fp(){return Tk||(Tk=1,x2.exports=EB()),x2.exports}var bk;function SB(){if(bk)return Mg;bk=1;var n=Fp(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,i=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function a(o,l,u){var h,f={},g=null,y=null;u!==void 0&&(g=""+u),l.key!==void 0&&(g=""+l.key),l.ref!==void 0&&(y=l.ref);for(h in l)r.call(l,h)&&!s.hasOwnProperty(h)&&(f[h]=l[h]);if(o&&o.defaultProps)for(h in l=o.defaultProps,l)f[h]===void 0&&(f[h]=l[h]);return{$$typeof:e,type:o,key:g,ref:y,props:f,_owner:i.current}}return Mg.Fragment=t,Mg.jsx=a,Mg.jsxs=a,Mg}var Ik;function TB(){return Ik||(Ik=1,_2.exports=SB()),_2.exports}var p=TB(),Fy={},v2={exports:{}},ys={},w2={exports:{}},E2={};var Ak;function bB(){return Ak||(Ak=1,(function(n){function e(ce,Te){var Ee=ce.length;ce.push(Te);e:for(;0<Ee;){var se=Ee-1>>>1,V=ce[se];if(0<i(V,Te))ce[se]=Te,ce[Ee]=V,Ee=se;else break e}}function t(ce){return ce.length===0?null:ce[0]}function r(ce){if(ce.length===0)return null;var Te=ce[0],Ee=ce.pop();if(Ee!==Te){ce[0]=Ee;e:for(var se=0,V=ce.length,J=V>>>1;se<J;){var ne=2*(se+1)-1,X=ce[ne],ue=ne+1,Me=ce[ue];if(0>i(X,Ee))ue<V&&0>i(Me,X)?(ce[se]=Me,ce[ue]=Ee,se=ue):(ce[se]=X,ce[ne]=Ee,se=ne);else if(ue<V&&0>i(Me,Ee))ce[se]=Me,ce[ue]=Ee,se=ue;else break e}}return Te}function i(ce,Te){var Ee=ce.sortIndex-Te.sortIndex;return Ee!==0?Ee:ce.id-Te.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();n.unstable_now=function(){return a.now()-o}}var l=[],u=[],h=1,f=null,g=3,y=!1,v=!1,x=!1,E=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function I(ce){for(var Te=t(u);Te!==null;){if(Te.callback===null)r(u);else if(Te.startTime<=ce)r(u),Te.sortIndex=Te.expirationTime,e(l,Te);else break;Te=t(u)}}function M(ce){if(x=!1,I(ce),!v)if(t(l)!==null)v=!0,ze(F);else{var Te=t(u);Te!==null&&Ne(M,Te.startTime-ce)}}function F(ce,Te){v=!1,x&&(x=!1,T(C),C=-1),y=!0;var Ee=g;try{for(I(Te),f=t(l);f!==null&&(!(f.expirationTime>Te)||ce&&!O());){var se=f.callback;if(typeof se=="function"){f.callback=null,g=f.priorityLevel;var V=se(f.expirationTime<=Te);Te=n.unstable_now(),typeof V=="function"?f.callback=V:f===t(l)&&r(l),I(Te)}else r(l);f=t(l)}if(f!==null)var J=!0;else{var ne=t(u);ne!==null&&Ne(M,ne.startTime-Te),J=!1}return J}finally{f=null,g=Ee,y=!1}}var z=!1,k=null,C=-1,P=5,L=-1;function O(){return!(n.unstable_now()-L<P)}function U(){if(k!==null){var ce=n.unstable_now();L=ce;var Te=!0;try{Te=k(!0,ce)}finally{Te?j():(z=!1,k=null)}}else z=!1}var j;if(typeof b=="function")j=function(){b(U)};else if(typeof MessageChannel<"u"){var Ie=new MessageChannel,ke=Ie.port2;Ie.port1.onmessage=U,j=function(){ke.postMessage(null)}}else j=function(){E(U,0)};function ze(ce){k=ce,z||(z=!0,j())}function Ne(ce,Te){C=E(function(){ce(n.unstable_now())},Te)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ce){ce.callback=null},n.unstable_continueExecution=function(){v||y||(v=!0,ze(F))},n.unstable_forceFrameRate=function(ce){0>ce||125<ce?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<ce?Math.floor(1e3/ce):5},n.unstable_getCurrentPriorityLevel=function(){return g},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(ce){switch(g){case 1:case 2:case 3:var Te=3;break;default:Te=g}var Ee=g;g=Te;try{return ce()}finally{g=Ee}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(ce,Te){switch(ce){case 1:case 2:case 3:case 4:case 5:break;default:ce=3}var Ee=g;g=ce;try{return Te()}finally{g=Ee}},n.unstable_scheduleCallback=function(ce,Te,Ee){var se=n.unstable_now();switch(typeof Ee=="object"&&Ee!==null?(Ee=Ee.delay,Ee=typeof Ee=="number"&&0<Ee?se+Ee:se):Ee=se,ce){case 1:var V=-1;break;case 2:V=250;break;case 5:V=1073741823;break;case 4:V=1e4;break;default:V=5e3}return V=Ee+V,ce={id:h++,callback:Te,priorityLevel:ce,startTime:Ee,expirationTime:V,sortIndex:-1},Ee>se?(ce.sortIndex=Ee,e(u,ce),t(l)===null&&ce===t(u)&&(x?(T(C),C=-1):x=!0,Ne(M,Ee-se))):(ce.sortIndex=V,e(l,ce),v||y||(v=!0,ze(F))),ce},n.unstable_shouldYield=O,n.unstable_wrapCallback=function(ce){var Te=g;return function(){var Ee=g;g=Te;try{return ce.apply(this,arguments)}finally{g=Ee}}}})(E2)),E2}var Rk;function IB(){return Rk||(Rk=1,w2.exports=bB()),w2.exports}var Ck;function AB(){if(Ck)return ys;Ck=1;var n=Fp(),e=IB();function t(c){for(var d="https://reactjs.org/docs/error-decoder.html?invariant="+c,m=1;m<arguments.length;m++)d+="&args[]="+encodeURIComponent(arguments[m]);return"Minified React error #"+c+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,i={};function s(c,d){a(c,d),a(c+"Capture",d)}function a(c,d){for(i[c]=d,c=0;c<d.length;c++)r.add(d[c])}var o=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),l=Object.prototype.hasOwnProperty,u=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},f={};function g(c){return l.call(f,c)?!0:l.call(h,c)?!1:u.test(c)?f[c]=!0:(h[c]=!0,!1)}function y(c,d,m,w){if(m!==null&&m.type===0)return!1;switch(typeof d){case"function":case"symbol":return!0;case"boolean":return w?!1:m!==null?!m.acceptsBooleans:(c=c.toLowerCase().slice(0,5),c!=="data-"&&c!=="aria-");default:return!1}}function v(c,d,m,w){if(d===null||typeof d>"u"||y(c,d,m,w))return!0;if(w)return!1;if(m!==null)switch(m.type){case 3:return!d;case 4:return d===!1;case 5:return isNaN(d);case 6:return isNaN(d)||1>d}return!1}function x(c,d,m,w,S,A,G){this.acceptsBooleans=d===2||d===3||d===4,this.attributeName=w,this.attributeNamespace=S,this.mustUseProperty=m,this.propertyName=c,this.type=d,this.sanitizeURL=A,this.removeEmptyString=G}var E={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(c){E[c]=new x(c,0,!1,c,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(c){var d=c[0];E[d]=new x(d,1,!1,c[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(c){E[c]=new x(c,2,!1,c.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(c){E[c]=new x(c,2,!1,c,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(c){E[c]=new x(c,3,!1,c.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(c){E[c]=new x(c,3,!0,c,null,!1,!1)}),["capture","download"].forEach(function(c){E[c]=new x(c,4,!1,c,null,!1,!1)}),["cols","rows","size","span"].forEach(function(c){E[c]=new x(c,6,!1,c,null,!1,!1)}),["rowSpan","start"].forEach(function(c){E[c]=new x(c,5,!1,c.toLowerCase(),null,!1,!1)});var T=/[\-:]([a-z])/g;function b(c){return c[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(c){var d=c.replace(T,b);E[d]=new x(d,1,!1,c,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(c){var d=c.replace(T,b);E[d]=new x(d,1,!1,c,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(c){var d=c.replace(T,b);E[d]=new x(d,1,!1,c,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(c){E[c]=new x(c,1,!1,c.toLowerCase(),null,!1,!1)}),E.xlinkHref=new x("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(c){E[c]=new x(c,1,!1,c.toLowerCase(),null,!0,!0)});function I(c,d,m,w){var S=E.hasOwnProperty(d)?E[d]:null;(S!==null?S.type!==0:w||!(2<d.length)||d[0]!=="o"&&d[0]!=="O"||d[1]!=="n"&&d[1]!=="N")&&(v(d,m,S,w)&&(m=null),w||S===null?g(d)&&(m===null?c.removeAttribute(d):c.setAttribute(d,""+m)):S.mustUseProperty?c[S.propertyName]=m===null?S.type===3?!1:"":m:(d=S.attributeName,w=S.attributeNamespace,m===null?c.removeAttribute(d):(S=S.type,m=S===3||S===4&&m===!0?"":""+m,w?c.setAttributeNS(w,d,m):c.setAttribute(d,m))))}var M=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,F=Symbol.for("react.element"),z=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),P=Symbol.for("react.profiler"),L=Symbol.for("react.provider"),O=Symbol.for("react.context"),U=Symbol.for("react.forward_ref"),j=Symbol.for("react.suspense"),Ie=Symbol.for("react.suspense_list"),ke=Symbol.for("react.memo"),ze=Symbol.for("react.lazy"),Ne=Symbol.for("react.offscreen"),ce=Symbol.iterator;function Te(c){return c===null||typeof c!="object"?null:(c=ce&&c[ce]||c["@@iterator"],typeof c=="function"?c:null)}var Ee=Object.assign,se;function V(c){if(se===void 0)try{throw Error()}catch(m){var d=m.stack.trim().match(/\n( *(at )?)/);se=d&&d[1]||""}return`
`+se+c}var J=!1;function ne(c,d){if(!c||J)return"";J=!0;var m=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(d)if(d=function(){throw Error()},Object.defineProperty(d.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(d,[])}catch(be){var w=be}Reflect.construct(c,[],d)}else{try{d.call()}catch(be){w=be}c.call(d.prototype)}else{try{throw Error()}catch(be){w=be}c()}}catch(be){if(be&&w&&typeof be.stack=="string"){for(var S=be.stack.split(`
`),A=w.stack.split(`
`),G=S.length-1,re=A.length-1;1<=G&&0<=re&&S[G]!==A[re];)re--;for(;1<=G&&0<=re;G--,re--)if(S[G]!==A[re]){if(G!==1||re!==1)do if(G--,re--,0>re||S[G]!==A[re]){var ae=`
`+S[G].replace(" at new "," at ");return c.displayName&&ae.includes("<anonymous>")&&(ae=ae.replace("<anonymous>",c.displayName)),ae}while(1<=G&&0<=re);break}}}finally{J=!1,Error.prepareStackTrace=m}return(c=c?c.displayName||c.name:"")?V(c):""}function X(c){switch(c.tag){case 5:return V(c.type);case 16:return V("Lazy");case 13:return V("Suspense");case 19:return V("SuspenseList");case 0:case 2:case 15:return c=ne(c.type,!1),c;case 11:return c=ne(c.type.render,!1),c;case 1:return c=ne(c.type,!0),c;default:return""}}function ue(c){if(c==null)return null;if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c;switch(c){case k:return"Fragment";case z:return"Portal";case P:return"Profiler";case C:return"StrictMode";case j:return"Suspense";case Ie:return"SuspenseList"}if(typeof c=="object")switch(c.$$typeof){case O:return(c.displayName||"Context")+".Consumer";case L:return(c._context.displayName||"Context")+".Provider";case U:var d=c.render;return c=c.displayName,c||(c=d.displayName||d.name||"",c=c!==""?"ForwardRef("+c+")":"ForwardRef"),c;case ke:return d=c.displayName||null,d!==null?d:ue(c.type)||"Memo";case ze:d=c._payload,c=c._init;try{return ue(c(d))}catch{}}return null}function Me(c){var d=c.type;switch(c.tag){case 24:return"Cache";case 9:return(d.displayName||"Context")+".Consumer";case 10:return(d._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return c=d.render,c=c.displayName||c.name||"",d.displayName||(c!==""?"ForwardRef("+c+")":"ForwardRef");case 7:return"Fragment";case 5:return d;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ue(d);case 8:return d===C?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof d=="function")return d.displayName||d.name||null;if(typeof d=="string")return d}return null}function je(c){switch(typeof c){case"boolean":case"number":case"string":case"undefined":return c;case"object":return c;default:return""}}function De(c){var d=c.type;return(c=c.nodeName)&&c.toLowerCase()==="input"&&(d==="checkbox"||d==="radio")}function Be(c){var d=De(c)?"checked":"value",m=Object.getOwnPropertyDescriptor(c.constructor.prototype,d),w=""+c[d];if(!c.hasOwnProperty(d)&&typeof m<"u"&&typeof m.get=="function"&&typeof m.set=="function"){var S=m.get,A=m.set;return Object.defineProperty(c,d,{configurable:!0,get:function(){return S.call(this)},set:function(G){w=""+G,A.call(this,G)}}),Object.defineProperty(c,d,{enumerable:m.enumerable}),{getValue:function(){return w},setValue:function(G){w=""+G},stopTracking:function(){c._valueTracker=null,delete c[d]}}}}function Gt(c){c._valueTracker||(c._valueTracker=Be(c))}function Kt(c){if(!c)return!1;var d=c._valueTracker;if(!d)return!0;var m=d.getValue(),w="";return c&&(w=De(c)?c.checked?"true":"false":c.value),c=w,c!==m?(d.setValue(c),!0):!1}function wn(c){if(c=c||(typeof document<"u"?document:void 0),typeof c>"u")return null;try{return c.activeElement||c.body}catch{return c.body}}function Bt(c,d){var m=d.checked;return Ee({},d,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:m??c._wrapperState.initialChecked})}function Fn(c,d){var m=d.defaultValue==null?"":d.defaultValue,w=d.checked!=null?d.checked:d.defaultChecked;m=je(d.value!=null?d.value:m),c._wrapperState={initialChecked:w,initialValue:m,controlled:d.type==="checkbox"||d.type==="radio"?d.checked!=null:d.value!=null}}function Qt(c,d){d=d.checked,d!=null&&I(c,"checked",d,!1)}function ot(c,d){Qt(c,d);var m=je(d.value),w=d.type;if(m!=null)w==="number"?(m===0&&c.value===""||c.value!=m)&&(c.value=""+m):c.value!==""+m&&(c.value=""+m);else if(w==="submit"||w==="reset"){c.removeAttribute("value");return}d.hasOwnProperty("value")?on(c,d.type,m):d.hasOwnProperty("defaultValue")&&on(c,d.type,je(d.defaultValue)),d.checked==null&&d.defaultChecked!=null&&(c.defaultChecked=!!d.defaultChecked)}function Xn(c,d,m){if(d.hasOwnProperty("value")||d.hasOwnProperty("defaultValue")){var w=d.type;if(!(w!=="submit"&&w!=="reset"||d.value!==void 0&&d.value!==null))return;d=""+c._wrapperState.initialValue,m||d===c.value||(c.value=d),c.defaultValue=d}m=c.name,m!==""&&(c.name=""),c.defaultChecked=!!c._wrapperState.initialChecked,m!==""&&(c.name=m)}function on(c,d,m){(d!=="number"||wn(c.ownerDocument)!==c)&&(m==null?c.defaultValue=""+c._wrapperState.initialValue:c.defaultValue!==""+m&&(c.defaultValue=""+m))}var en=Array.isArray;function Zn(c,d,m,w){if(c=c.options,d){d={};for(var S=0;S<m.length;S++)d["$"+m[S]]=!0;for(m=0;m<c.length;m++)S=d.hasOwnProperty("$"+c[m].value),c[m].selected!==S&&(c[m].selected=S),S&&w&&(c[m].defaultSelected=!0)}else{for(m=""+je(m),d=null,S=0;S<c.length;S++){if(c[S].value===m){c[S].selected=!0,w&&(c[S].defaultSelected=!0);return}d!==null||c[S].disabled||(d=c[S])}d!==null&&(d.selected=!0)}}function gt(c,d){if(d.dangerouslySetInnerHTML!=null)throw Error(t(91));return Ee({},d,{value:void 0,defaultValue:void 0,children:""+c._wrapperState.initialValue})}function jt(c,d){var m=d.value;if(m==null){if(m=d.children,d=d.defaultValue,m!=null){if(d!=null)throw Error(t(92));if(en(m)){if(1<m.length)throw Error(t(93));m=m[0]}d=m}d==null&&(d=""),m=d}c._wrapperState={initialValue:je(m)}}function kn(c,d){var m=je(d.value),w=je(d.defaultValue);m!=null&&(m=""+m,m!==c.value&&(c.value=m),d.defaultValue==null&&c.defaultValue!==m&&(c.defaultValue=m)),w!=null&&(c.defaultValue=""+w)}function yt(c){var d=c.textContent;d===c._wrapperState.initialValue&&d!==""&&d!==null&&(c.value=d)}function Jt(c){switch(c){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Rt(c,d){return c==null||c==="http://www.w3.org/1999/xhtml"?Jt(d):c==="http://www.w3.org/2000/svg"&&d==="foreignObject"?"http://www.w3.org/1999/xhtml":c}var rr,si=(function(c){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(d,m,w,S){MSApp.execUnsafeLocalFunction(function(){return c(d,m,w,S)})}:c})(function(c,d){if(c.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in c)c.innerHTML=d;else{for(rr=rr||document.createElement("div"),rr.innerHTML="<svg>"+d.valueOf().toString()+"</svg>",d=rr.firstChild;c.firstChild;)c.removeChild(c.firstChild);for(;d.firstChild;)c.appendChild(d.firstChild)}});function Vr(c,d){if(d){var m=c.firstChild;if(m&&m===c.lastChild&&m.nodeType===3){m.nodeValue=d;return}}c.textContent=d}var Ut={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ji=["Webkit","ms","Moz","O"];Object.keys(Ut).forEach(function(c){Ji.forEach(function(d){d=d+c.charAt(0).toUpperCase()+c.substring(1),Ut[d]=Ut[c]})});function Oe(c,d,m){return d==null||typeof d=="boolean"||d===""?"":m||typeof d!="number"||d===0||Ut.hasOwnProperty(c)&&Ut[c]?(""+d).trim():d+"px"}function ve(c,d){c=c.style;for(var m in d)if(d.hasOwnProperty(m)){var w=m.indexOf("--")===0,S=Oe(m,d[m],w);m==="float"&&(m="cssFloat"),w?c.setProperty(m,S):c[m]=S}}var me=Ee({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ct(c,d){if(d){if(me[c]&&(d.children!=null||d.dangerouslySetInnerHTML!=null))throw Error(t(137,c));if(d.dangerouslySetInnerHTML!=null){if(d.children!=null)throw Error(t(60));if(typeof d.dangerouslySetInnerHTML!="object"||!("__html"in d.dangerouslySetInnerHTML))throw Error(t(61))}if(d.style!=null&&typeof d.style!="object")throw Error(t(62))}}function N(c,d){if(c.indexOf("-")===-1)return typeof d.is=="string";switch(c){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Pt=null;function W(c){return c=c.target||c.srcElement||window,c.correspondingUseElement&&(c=c.correspondingUseElement),c.nodeType===3?c.parentNode:c}var Z=null,q=null,le=null;function he(c){if(c=yg(c)){if(typeof Z!="function")throw Error(t(280));var d=c.stateNode;d&&(d=Q1(d),Z(c.stateNode,c.type,d))}}function Ve(c){q?le?le.push(c):le=[c]:q=c}function Se(){if(q){var c=q,d=le;if(le=q=null,he(c),d)for(c=0;c<d.length;c++)he(d[c])}}function $e(c,d){return c(d)}function et(){}var dt=!1;function St(c,d,m){if(dt)return c(d,m);dt=!0;try{return $e(c,d,m)}finally{dt=!1,(q!==null||le!==null)&&(et(),Se())}}function sn(c,d){var m=c.stateNode;if(m===null)return null;var w=Q1(m);if(w===null)return null;m=w[d];e:switch(d){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(w=!w.disabled)||(c=c.type,w=!(c==="button"||c==="input"||c==="select"||c==="textarea")),c=!w;break e;default:c=!1}if(c)return null;if(m&&typeof m!="function")throw Error(t(231,d,typeof m));return m}var ur=!1;if(o)try{var cn={};Object.defineProperty(cn,"passive",{get:function(){ur=!0}}),window.addEventListener("test",cn,cn),window.removeEventListener("test",cn,cn)}catch{ur=!1}function hr(c,d,m,w,S,A,G,re,ae){var be=Array.prototype.slice.call(arguments,3);try{d.apply(m,be)}catch(He){this.onError(He)}}var pr=!1,Ni=null,B=!1,Q=null,K={onError:function(c){pr=!0,Ni=c}};function Y(c,d,m,w,S,A,G,re,ae){pr=!1,Ni=null,hr.apply(K,arguments)}function ee(c,d,m,w,S,A,G,re,ae){if(Y.apply(this,arguments),pr){if(pr){var be=Ni;pr=!1,Ni=null}else throw Error(t(198));B||(B=!0,Q=be)}}function te(c){var d=c,m=c;if(c.alternate)for(;d.return;)d=d.return;else{c=d;do d=c,(d.flags&4098)!==0&&(m=d.return),c=d.return;while(c)}return d.tag===3?m:null}function ye(c){if(c.tag===13){var d=c.memoizedState;if(d===null&&(c=c.alternate,c!==null&&(d=c.memoizedState)),d!==null)return d.dehydrated}return null}function Ce(c){if(te(c)!==c)throw Error(t(188))}function pe(c){var d=c.alternate;if(!d){if(d=te(c),d===null)throw Error(t(188));return d!==c?null:c}for(var m=c,w=d;;){var S=m.return;if(S===null)break;var A=S.alternate;if(A===null){if(w=S.return,w!==null){m=w;continue}break}if(S.child===A.child){for(A=S.child;A;){if(A===m)return Ce(S),c;if(A===w)return Ce(S),d;A=A.sibling}throw Error(t(188))}if(m.return!==w.return)m=S,w=A;else{for(var G=!1,re=S.child;re;){if(re===m){G=!0,m=S,w=A;break}if(re===w){G=!0,w=S,m=A;break}re=re.sibling}if(!G){for(re=A.child;re;){if(re===m){G=!0,m=A,w=S;break}if(re===w){G=!0,w=A,m=S;break}re=re.sibling}if(!G)throw Error(t(189))}}if(m.alternate!==w)throw Error(t(190))}if(m.tag!==3)throw Error(t(188));return m.stateNode.current===m?c:d}function xe(c){return c=pe(c),c!==null?we(c):null}function we(c){if(c.tag===5||c.tag===6)return c;for(c=c.child;c!==null;){var d=we(c);if(d!==null)return d;c=c.sibling}return null}var Ke=e.unstable_scheduleCallback,tt=e.unstable_cancelCallback,ft=e.unstable_shouldYield,Ye=e.unstable_requestPaint,qe=e.unstable_now,zt=e.unstable_getCurrentPriorityLevel,Mn=e.unstable_ImmediatePriority,jn=e.unstable_UserBlockingPriority,dr=e.unstable_NormalPriority,Pa=e.unstable_LowPriority,ia=e.unstable_IdlePriority,Ns=null,Pr=null;function tc(c){if(Pr&&typeof Pr.onCommitFiberRoot=="function")try{Pr.onCommitFiberRoot(Ns,c,void 0,(c.current.flags&128)===128)}catch{}}var yr=Math.clz32?Math.clz32:ku,ho=Math.log,sa=Math.LN2;function ku(c){return c>>>=0,c===0?32:31-(ho(c)/sa|0)|0}var fo=64,nc=4194304;function In(c){switch(c&-c){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return c&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return c}}function il(c,d){var m=c.pendingLanes;if(m===0)return 0;var w=0,S=c.suspendedLanes,A=c.pingedLanes,G=m&268435455;if(G!==0){var re=G&~S;re!==0?w=In(re):(A&=G,A!==0&&(w=In(A)))}else G=m&~S,G!==0?w=In(G):A!==0&&(w=In(A));if(w===0)return 0;if(d!==0&&d!==w&&(d&S)===0&&(S=w&-w,A=d&-d,S>=A||S===16&&(A&4194240)!==0))return d;if((w&4)!==0&&(w|=m&16),d=c.entangledLanes,d!==0)for(c=c.entanglements,d&=w;0<d;)m=31-yr(d),S=1<<m,w|=c[m],d&=~S;return w}function Mu(c,d){switch(c){case 1:case 2:case 4:return d+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Nu(c,d){for(var m=c.suspendedLanes,w=c.pingedLanes,S=c.expirationTimes,A=c.pendingLanes;0<A;){var G=31-yr(A),re=1<<G,ae=S[G];ae===-1?((re&m)===0||(re&w)!==0)&&(S[G]=Mu(re,d)):ae<=d&&(c.expiredLanes|=re),A&=~re}}function X0(c){return c=c.pendingLanes&-1073741825,c!==0?c:c&1073741824?1073741824:0}function Z0(){var c=fo;return fo<<=1,(fo&4194240)===0&&(fo=64),c}function Q0(c){for(var d=[],m=0;31>m;m++)d.push(c);return d}function Lu(c,d,m){c.pendingLanes|=d,d!==536870912&&(c.suspendedLanes=0,c.pingedLanes=0),c=c.eventTimes,d=31-yr(d),c[d]=m}function Xw(c,d){var m=c.pendingLanes&~d;c.pendingLanes=d,c.suspendedLanes=0,c.pingedLanes=0,c.expiredLanes&=d,c.mutableReadLanes&=d,c.entangledLanes&=d,d=c.entanglements;var w=c.eventTimes;for(c=c.expirationTimes;0<m;){var S=31-yr(m),A=1<<S;d[S]=0,w[S]=-1,c[S]=-1,m&=~A}}function J0(c,d){var m=c.entangledLanes|=d;for(c=c.entanglements;m;){var w=31-yr(m),S=1<<w;S&d|c[w]&d&&(c[w]|=d),m&=~S}}var gn=0;function go(c){return c&=-c,1<c?4<c?(c&268435455)!==0?16:536870912:4:1}var eg,Sd,tg,ng,rg,mo=!1,Td=[],po=null,yo=null,yi=null,Ou=new Map,sl=new Map,Ls=[],D1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function rc(c,d){switch(c){case"focusin":case"focusout":po=null;break;case"dragenter":case"dragleave":yo=null;break;case"mouseover":case"mouseout":yi=null;break;case"pointerover":case"pointerout":Ou.delete(d.pointerId);break;case"gotpointercapture":case"lostpointercapture":sl.delete(d.pointerId)}}function ka(c,d,m,w,S,A){return c===null||c.nativeEvent!==A?(c={blockedOn:d,domEventName:m,eventSystemFlags:w,nativeEvent:A,targetContainers:[S]},d!==null&&(d=yg(d),d!==null&&Sd(d)),c):(c.eventSystemFlags|=w,d=c.targetContainers,S!==null&&d.indexOf(S)===-1&&d.push(S),c)}function F1(c,d,m,w,S){switch(d){case"focusin":return po=ka(po,c,d,m,w,S),!0;case"dragenter":return yo=ka(yo,c,d,m,w,S),!0;case"mouseover":return yi=ka(yi,c,d,m,w,S),!0;case"pointerover":var A=S.pointerId;return Ou.set(A,ka(Ou.get(A)||null,c,d,m,w,S)),!0;case"gotpointercapture":return A=S.pointerId,sl.set(A,ka(sl.get(A)||null,c,d,m,w,S)),!0}return!1}function bd(c){var d=Vu(c.target);if(d!==null){var m=te(d);if(m!==null){if(d=m.tag,d===13){if(d=ye(m),d!==null){c.blockedOn=d,rg(c.priority,function(){tg(m)});return}}else if(d===3&&m.stateNode.current.memoizedState.isDehydrated){c.blockedOn=m.tag===3?m.stateNode.containerInfo:null;return}}}c.blockedOn=null}function Qn(c){if(c.blockedOn!==null)return!1;for(var d=c.targetContainers;0<d.length;){var m=Id(c.domEventName,c.eventSystemFlags,d[0],c.nativeEvent);if(m===null){m=c.nativeEvent;var w=new m.constructor(m.type,m);Pt=w,m.target.dispatchEvent(w),Pt=null}else return d=yg(m),d!==null&&Sd(d),c.blockedOn=m,!1;d.shift()}return!0}function j1(c,d,m){Qn(c)&&m.delete(d)}function Zw(){mo=!1,po!==null&&Qn(po)&&(po=null),yo!==null&&Qn(yo)&&(yo=null),yi!==null&&Qn(yi)&&(yi=null),Ou.forEach(j1),sl.forEach(j1)}function ic(c,d){c.blockedOn===d&&(c.blockedOn=null,mo||(mo=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Zw)))}function sc(c){function d(S){return ic(S,c)}if(0<Td.length){ic(Td[0],c);for(var m=1;m<Td.length;m++){var w=Td[m];w.blockedOn===c&&(w.blockedOn=null)}}for(po!==null&&ic(po,c),yo!==null&&ic(yo,c),yi!==null&&ic(yi,c),Ou.forEach(d),sl.forEach(d),m=0;m<Ls.length;m++)w=Ls[m],w.blockedOn===c&&(w.blockedOn=null);for(;0<Ls.length&&(m=Ls[0],m.blockedOn===null);)bd(m),m.blockedOn===null&&Ls.shift()}var al=M.ReactCurrentBatchConfig,ol=!0;function _o(c,d,m,w){var S=gn,A=al.transition;al.transition=null;try{gn=1,ig(c,d,m,w)}finally{gn=S,al.transition=A}}function V1(c,d,m,w){var S=gn,A=al.transition;al.transition=null;try{gn=4,ig(c,d,m,w)}finally{gn=S,al.transition=A}}function ig(c,d,m,w){if(ol){var S=Id(c,d,m,w);if(S===null)lE(c,d,w,xo,m),rc(c,w);else if(F1(S,c,d,m,w))w.stopPropagation();else if(rc(c,w),d&4&&-1<D1.indexOf(c)){for(;S!==null;){var A=yg(S);if(A!==null&&eg(A),A=Id(c,d,m,w),A===null&&lE(c,d,w,xo,m),A===S)break;S=A}S!==null&&w.stopPropagation()}else lE(c,d,w,null,m)}}var xo=null;function Id(c,d,m,w){if(xo=null,c=W(w),c=Vu(c),c!==null)if(d=te(c),d===null)c=null;else if(m=d.tag,m===13){if(c=ye(d),c!==null)return c;c=null}else if(m===3){if(d.stateNode.current.memoizedState.isDehydrated)return d.tag===3?d.stateNode.containerInfo:null;c=null}else d!==c&&(c=null);return xo=c,null}function Ad(c){switch(c){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(zt()){case Mn:return 1;case jn:return 4;case dr:case Pa:return 16;case ia:return 536870912;default:return 16}default:return 16}}var Os=null,Rd=null,ll=null;function G1(){if(ll)return ll;var c,d=Rd,m=d.length,w,S="value"in Os?Os.value:Os.textContent,A=S.length;for(c=0;c<m&&d[c]===S[c];c++);var G=m-c;for(w=1;w<=G&&d[m-w]===S[A-w];w++);return ll=S.slice(c,1<w?1-w:void 0)}function Du(c){var d=c.keyCode;return"charCode"in c?(c=c.charCode,c===0&&d===13&&(c=13)):c=d,c===10&&(c=13),32<=c||c===13?c:0}function vo(){return!0}function sg(){return!1}function Li(c){function d(m,w,S,A,G){this._reactName=m,this._targetInst=S,this.type=w,this.nativeEvent=A,this.target=G,this.currentTarget=null;for(var re in c)c.hasOwnProperty(re)&&(m=c[re],this[re]=m?m(A):A[re]);return this.isDefaultPrevented=(A.defaultPrevented!=null?A.defaultPrevented:A.returnValue===!1)?vo:sg,this.isPropagationStopped=sg,this}return Ee(d.prototype,{preventDefault:function(){this.defaultPrevented=!0;var m=this.nativeEvent;m&&(m.preventDefault?m.preventDefault():typeof m.returnValue!="unknown"&&(m.returnValue=!1),this.isDefaultPrevented=vo)},stopPropagation:function(){var m=this.nativeEvent;m&&(m.stopPropagation?m.stopPropagation():typeof m.cancelBubble!="unknown"&&(m.cancelBubble=!0),this.isPropagationStopped=vo)},persist:function(){},isPersistent:vo}),d}var wo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(c){return c.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Fu=Li(wo),ac=Ee({},wo,{view:0,detail:0}),Cd=Li(ac),Pd,kd,Ds,ju=Ee({},ac,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Zt,button:0,buttons:0,relatedTarget:function(c){return c.relatedTarget===void 0?c.fromElement===c.srcElement?c.toElement:c.fromElement:c.relatedTarget},movementX:function(c){return"movementX"in c?c.movementX:(c!==Ds&&(Ds&&c.type==="mousemove"?(Pd=c.screenX-Ds.screenX,kd=c.screenY-Ds.screenY):kd=Pd=0,Ds=c),Pd)},movementY:function(c){return"movementY"in c?c.movementY:kd}}),ag=Li(ju),B1=Ee({},ju,{dataTransfer:0}),U1=Li(B1),Md=Ee({},ac,{relatedTarget:0}),_i=Li(Md),z1=Ee({},wo,{animationName:0,elapsedTime:0,pseudoElement:0}),$1=Li(z1),oc=Ee({},wo,{clipboardData:function(c){return"clipboardData"in c?c.clipboardData:window.clipboardData}}),_=Li(oc),R=Ee({},wo,{data:0}),D=Li(R),H={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ge={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ae={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function it(c){var d=this.nativeEvent;return d.getModifierState?d.getModifierState(c):(c=Ae[c])?!!d[c]:!1}function Zt(){return it}var kr=Ee({},ac,{key:function(c){if(c.key){var d=H[c.key]||c.key;if(d!=="Unidentified")return d}return c.type==="keypress"?(c=Du(c),c===13?"Enter":String.fromCharCode(c)):c.type==="keydown"||c.type==="keyup"?ge[c.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Zt,charCode:function(c){return c.type==="keypress"?Du(c):0},keyCode:function(c){return c.type==="keydown"||c.type==="keyup"?c.keyCode:0},which:function(c){return c.type==="keypress"?Du(c):c.type==="keydown"||c.type==="keyup"?c.keyCode:0}}),Vn=Li(kr),Gr=Ee({},ju,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Fs=Li(Gr),cl=Ee({},ac,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Zt}),Eo=Li(cl),So=Ee({},wo,{propertyName:0,elapsedTime:0,pseudoElement:0}),Nd=Li(So),og=Ee({},ju,{deltaX:function(c){return"deltaX"in c?c.deltaX:"wheelDeltaX"in c?-c.wheelDeltaX:0},deltaY:function(c){return"deltaY"in c?c.deltaY:"wheelDeltaY"in c?-c.wheelDeltaY:"wheelDelta"in c?-c.wheelDelta:0},deltaZ:0,deltaMode:0}),pG=Li(og),yG=[9,13,27,32],Qw=o&&"CompositionEvent"in window,lg=null;o&&"documentMode"in document&&(lg=document.documentMode);var _G=o&&"TextEvent"in window&&!lg,mC=o&&(!Qw||lg&&8<lg&&11>=lg),pC=" ",yC=!1;function _C(c,d){switch(c){case"keyup":return yG.indexOf(d.keyCode)!==-1;case"keydown":return d.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function xC(c){return c=c.detail,typeof c=="object"&&"data"in c?c.data:null}var Ld=!1;function xG(c,d){switch(c){case"compositionend":return xC(d);case"keypress":return d.which!==32?null:(yC=!0,pC);case"textInput":return c=d.data,c===pC&&yC?null:c;default:return null}}function vG(c,d){if(Ld)return c==="compositionend"||!Qw&&_C(c,d)?(c=G1(),ll=Rd=Os=null,Ld=!1,c):null;switch(c){case"paste":return null;case"keypress":if(!(d.ctrlKey||d.altKey||d.metaKey)||d.ctrlKey&&d.altKey){if(d.char&&1<d.char.length)return d.char;if(d.which)return String.fromCharCode(d.which)}return null;case"compositionend":return mC&&d.locale!=="ko"?null:d.data;default:return null}}var wG={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function vC(c){var d=c&&c.nodeName&&c.nodeName.toLowerCase();return d==="input"?!!wG[c.type]:d==="textarea"}function wC(c,d,m,w){Ve(w),d=q1(d,"onChange"),0<d.length&&(m=new Fu("onChange","change",null,m,w),c.push({event:m,listeners:d}))}var cg=null,ug=null;function EG(c){VC(c,0)}function W1(c){var d=Vd(c);if(Kt(d))return c}function SG(c,d){if(c==="change")return d}var EC=!1;if(o){var Jw;if(o){var eE="oninput"in document;if(!eE){var SC=document.createElement("div");SC.setAttribute("oninput","return;"),eE=typeof SC.oninput=="function"}Jw=eE}else Jw=!1;EC=Jw&&(!document.documentMode||9<document.documentMode)}function TC(){cg&&(cg.detachEvent("onpropertychange",bC),ug=cg=null)}function bC(c){if(c.propertyName==="value"&&W1(ug)){var d=[];wC(d,ug,c,W(c)),St(EG,d)}}function TG(c,d,m){c==="focusin"?(TC(),cg=d,ug=m,cg.attachEvent("onpropertychange",bC)):c==="focusout"&&TC()}function bG(c){if(c==="selectionchange"||c==="keyup"||c==="keydown")return W1(ug)}function IG(c,d){if(c==="click")return W1(d)}function AG(c,d){if(c==="input"||c==="change")return W1(d)}function RG(c,d){return c===d&&(c!==0||1/c===1/d)||c!==c&&d!==d}var Ma=typeof Object.is=="function"?Object.is:RG;function hg(c,d){if(Ma(c,d))return!0;if(typeof c!="object"||c===null||typeof d!="object"||d===null)return!1;var m=Object.keys(c),w=Object.keys(d);if(m.length!==w.length)return!1;for(w=0;w<m.length;w++){var S=m[w];if(!l.call(d,S)||!Ma(c[S],d[S]))return!1}return!0}function IC(c){for(;c&&c.firstChild;)c=c.firstChild;return c}function AC(c,d){var m=IC(c);c=0;for(var w;m;){if(m.nodeType===3){if(w=c+m.textContent.length,c<=d&&w>=d)return{node:m,offset:d-c};c=w}e:{for(;m;){if(m.nextSibling){m=m.nextSibling;break e}m=m.parentNode}m=void 0}m=IC(m)}}function RC(c,d){return c&&d?c===d?!0:c&&c.nodeType===3?!1:d&&d.nodeType===3?RC(c,d.parentNode):"contains"in c?c.contains(d):c.compareDocumentPosition?!!(c.compareDocumentPosition(d)&16):!1:!1}function CC(){for(var c=window,d=wn();d instanceof c.HTMLIFrameElement;){try{var m=typeof d.contentWindow.location.href=="string"}catch{m=!1}if(m)c=d.contentWindow;else break;d=wn(c.document)}return d}function tE(c){var d=c&&c.nodeName&&c.nodeName.toLowerCase();return d&&(d==="input"&&(c.type==="text"||c.type==="search"||c.type==="tel"||c.type==="url"||c.type==="password")||d==="textarea"||c.contentEditable==="true")}function CG(c){var d=CC(),m=c.focusedElem,w=c.selectionRange;if(d!==m&&m&&m.ownerDocument&&RC(m.ownerDocument.documentElement,m)){if(w!==null&&tE(m)){if(d=w.start,c=w.end,c===void 0&&(c=d),"selectionStart"in m)m.selectionStart=d,m.selectionEnd=Math.min(c,m.value.length);else if(c=(d=m.ownerDocument||document)&&d.defaultView||window,c.getSelection){c=c.getSelection();var S=m.textContent.length,A=Math.min(w.start,S);w=w.end===void 0?A:Math.min(w.end,S),!c.extend&&A>w&&(S=w,w=A,A=S),S=AC(m,A);var G=AC(m,w);S&&G&&(c.rangeCount!==1||c.anchorNode!==S.node||c.anchorOffset!==S.offset||c.focusNode!==G.node||c.focusOffset!==G.offset)&&(d=d.createRange(),d.setStart(S.node,S.offset),c.removeAllRanges(),A>w?(c.addRange(d),c.extend(G.node,G.offset)):(d.setEnd(G.node,G.offset),c.addRange(d)))}}for(d=[],c=m;c=c.parentNode;)c.nodeType===1&&d.push({element:c,left:c.scrollLeft,top:c.scrollTop});for(typeof m.focus=="function"&&m.focus(),m=0;m<d.length;m++)c=d[m],c.element.scrollLeft=c.left,c.element.scrollTop=c.top}}var PG=o&&"documentMode"in document&&11>=document.documentMode,Od=null,nE=null,dg=null,rE=!1;function PC(c,d,m){var w=m.window===m?m.document:m.nodeType===9?m:m.ownerDocument;rE||Od==null||Od!==wn(w)||(w=Od,"selectionStart"in w&&tE(w)?w={start:w.selectionStart,end:w.selectionEnd}:(w=(w.ownerDocument&&w.ownerDocument.defaultView||window).getSelection(),w={anchorNode:w.anchorNode,anchorOffset:w.anchorOffset,focusNode:w.focusNode,focusOffset:w.focusOffset}),dg&&hg(dg,w)||(dg=w,w=q1(nE,"onSelect"),0<w.length&&(d=new Fu("onSelect","select",null,d,m),c.push({event:d,listeners:w}),d.target=Od)))}function H1(c,d){var m={};return m[c.toLowerCase()]=d.toLowerCase(),m["Webkit"+c]="webkit"+d,m["Moz"+c]="moz"+d,m}var Dd={animationend:H1("Animation","AnimationEnd"),animationiteration:H1("Animation","AnimationIteration"),animationstart:H1("Animation","AnimationStart"),transitionend:H1("Transition","TransitionEnd")},iE={},kC={};o&&(kC=document.createElement("div").style,"AnimationEvent"in window||(delete Dd.animationend.animation,delete Dd.animationiteration.animation,delete Dd.animationstart.animation),"TransitionEvent"in window||delete Dd.transitionend.transition);function K1(c){if(iE[c])return iE[c];if(!Dd[c])return c;var d=Dd[c],m;for(m in d)if(d.hasOwnProperty(m)&&m in kC)return iE[c]=d[m];return c}var MC=K1("animationend"),NC=K1("animationiteration"),LC=K1("animationstart"),OC=K1("transitionend"),DC=new Map,FC="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function lc(c,d){DC.set(c,d),s(d,[c])}for(var sE=0;sE<FC.length;sE++){var aE=FC[sE],kG=aE.toLowerCase(),MG=aE[0].toUpperCase()+aE.slice(1);lc(kG,"on"+MG)}lc(MC,"onAnimationEnd"),lc(NC,"onAnimationIteration"),lc(LC,"onAnimationStart"),lc("dblclick","onDoubleClick"),lc("focusin","onFocus"),lc("focusout","onBlur"),lc(OC,"onTransitionEnd"),a("onMouseEnter",["mouseout","mouseover"]),a("onMouseLeave",["mouseout","mouseover"]),a("onPointerEnter",["pointerout","pointerover"]),a("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var fg="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),NG=new Set("cancel close invalid load scroll toggle".split(" ").concat(fg));function jC(c,d,m){var w=c.type||"unknown-event";c.currentTarget=m,ee(w,d,void 0,c),c.currentTarget=null}function VC(c,d){d=(d&4)!==0;for(var m=0;m<c.length;m++){var w=c[m],S=w.event;w=w.listeners;e:{var A=void 0;if(d)for(var G=w.length-1;0<=G;G--){var re=w[G],ae=re.instance,be=re.currentTarget;if(re=re.listener,ae!==A&&S.isPropagationStopped())break e;jC(S,re,be),A=ae}else for(G=0;G<w.length;G++){if(re=w[G],ae=re.instance,be=re.currentTarget,re=re.listener,ae!==A&&S.isPropagationStopped())break e;jC(S,re,be),A=ae}}}if(B)throw c=Q,B=!1,Q=null,c}function ir(c,d){var m=d[gE];m===void 0&&(m=d[gE]=new Set);var w=c+"__bubble";m.has(w)||(GC(d,c,2,!1),m.add(w))}function oE(c,d,m){var w=0;d&&(w|=4),GC(m,c,w,d)}var Y1="_reactListening"+Math.random().toString(36).slice(2);function gg(c){if(!c[Y1]){c[Y1]=!0,r.forEach(function(m){m!=="selectionchange"&&(NG.has(m)||oE(m,!1,c),oE(m,!0,c))});var d=c.nodeType===9?c:c.ownerDocument;d===null||d[Y1]||(d[Y1]=!0,oE("selectionchange",!1,d))}}function GC(c,d,m,w){switch(Ad(d)){case 1:var S=_o;break;case 4:S=V1;break;default:S=ig}m=S.bind(null,d,m,c),S=void 0,!ur||d!=="touchstart"&&d!=="touchmove"&&d!=="wheel"||(S=!0),w?S!==void 0?c.addEventListener(d,m,{capture:!0,passive:S}):c.addEventListener(d,m,!0):S!==void 0?c.addEventListener(d,m,{passive:S}):c.addEventListener(d,m,!1)}function lE(c,d,m,w,S){var A=w;if((d&1)===0&&(d&2)===0&&w!==null)e:for(;;){if(w===null)return;var G=w.tag;if(G===3||G===4){var re=w.stateNode.containerInfo;if(re===S||re.nodeType===8&&re.parentNode===S)break;if(G===4)for(G=w.return;G!==null;){var ae=G.tag;if((ae===3||ae===4)&&(ae=G.stateNode.containerInfo,ae===S||ae.nodeType===8&&ae.parentNode===S))return;G=G.return}for(;re!==null;){if(G=Vu(re),G===null)return;if(ae=G.tag,ae===5||ae===6){w=A=G;continue e}re=re.parentNode}}w=w.return}St(function(){var be=A,He=W(m),Xe=[];e:{var Ue=DC.get(c);if(Ue!==void 0){var pt=Fu,wt=c;switch(c){case"keypress":if(Du(m)===0)break e;case"keydown":case"keyup":pt=Vn;break;case"focusin":wt="focus",pt=_i;break;case"focusout":wt="blur",pt=_i;break;case"beforeblur":case"afterblur":pt=_i;break;case"click":if(m.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":pt=ag;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":pt=U1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":pt=Eo;break;case MC:case NC:case LC:pt=$1;break;case OC:pt=Nd;break;case"scroll":pt=Cd;break;case"wheel":pt=pG;break;case"copy":case"cut":case"paste":pt=_;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":pt=Fs}var Tt=(d&4)!==0,Mr=!Tt&&c==="scroll",fe=Tt?Ue!==null?Ue+"Capture":null:Ue;Tt=[];for(var oe=be,_e;oe!==null;){_e=oe;var Je=_e.stateNode;if(_e.tag===5&&Je!==null&&(_e=Je,fe!==null&&(Je=sn(oe,fe),Je!=null&&Tt.push(mg(oe,Je,_e)))),Mr)break;oe=oe.return}0<Tt.length&&(Ue=new pt(Ue,wt,null,m,He),Xe.push({event:Ue,listeners:Tt}))}}if((d&7)===0){e:{if(Ue=c==="mouseover"||c==="pointerover",pt=c==="mouseout"||c==="pointerout",Ue&&m!==Pt&&(wt=m.relatedTarget||m.fromElement)&&(Vu(wt)||wt[ul]))break e;if((pt||Ue)&&(Ue=He.window===He?He:(Ue=He.ownerDocument)?Ue.defaultView||Ue.parentWindow:window,pt?(wt=m.relatedTarget||m.toElement,pt=be,wt=wt?Vu(wt):null,wt!==null&&(Mr=te(wt),wt!==Mr||wt.tag!==5&&wt.tag!==6)&&(wt=null)):(pt=null,wt=be),pt!==wt)){if(Tt=ag,Je="onMouseLeave",fe="onMouseEnter",oe="mouse",(c==="pointerout"||c==="pointerover")&&(Tt=Fs,Je="onPointerLeave",fe="onPointerEnter",oe="pointer"),Mr=pt==null?Ue:Vd(pt),_e=wt==null?Ue:Vd(wt),Ue=new Tt(Je,oe+"leave",pt,m,He),Ue.target=Mr,Ue.relatedTarget=_e,Je=null,Vu(He)===be&&(Tt=new Tt(fe,oe+"enter",wt,m,He),Tt.target=_e,Tt.relatedTarget=Mr,Je=Tt),Mr=Je,pt&&wt)t:{for(Tt=pt,fe=wt,oe=0,_e=Tt;_e;_e=Fd(_e))oe++;for(_e=0,Je=fe;Je;Je=Fd(Je))_e++;for(;0<oe-_e;)Tt=Fd(Tt),oe--;for(;0<_e-oe;)fe=Fd(fe),_e--;for(;oe--;){if(Tt===fe||fe!==null&&Tt===fe.alternate)break t;Tt=Fd(Tt),fe=Fd(fe)}Tt=null}else Tt=null;pt!==null&&BC(Xe,Ue,pt,Tt,!1),wt!==null&&Mr!==null&&BC(Xe,Mr,wt,Tt,!0)}}e:{if(Ue=be?Vd(be):window,pt=Ue.nodeName&&Ue.nodeName.toLowerCase(),pt==="select"||pt==="input"&&Ue.type==="file")var It=SG;else if(vC(Ue))if(EC)It=AG;else{It=bG;var Lt=TG}else(pt=Ue.nodeName)&&pt.toLowerCase()==="input"&&(Ue.type==="checkbox"||Ue.type==="radio")&&(It=IG);if(It&&(It=It(c,be))){wC(Xe,It,m,He);break e}Lt&&Lt(c,Ue,be),c==="focusout"&&(Lt=Ue._wrapperState)&&Lt.controlled&&Ue.type==="number"&&on(Ue,"number",Ue.value)}switch(Lt=be?Vd(be):window,c){case"focusin":(vC(Lt)||Lt.contentEditable==="true")&&(Od=Lt,nE=be,dg=null);break;case"focusout":dg=nE=Od=null;break;case"mousedown":rE=!0;break;case"contextmenu":case"mouseup":case"dragend":rE=!1,PC(Xe,m,He);break;case"selectionchange":if(PG)break;case"keydown":case"keyup":PC(Xe,m,He)}var Ot;if(Qw)e:{switch(c){case"compositionstart":var $t="onCompositionStart";break e;case"compositionend":$t="onCompositionEnd";break e;case"compositionupdate":$t="onCompositionUpdate";break e}$t=void 0}else Ld?_C(c,m)&&($t="onCompositionEnd"):c==="keydown"&&m.keyCode===229&&($t="onCompositionStart");$t&&(mC&&m.locale!=="ko"&&(Ld||$t!=="onCompositionStart"?$t==="onCompositionEnd"&&Ld&&(Ot=G1()):(Os=He,Rd="value"in Os?Os.value:Os.textContent,Ld=!0)),Lt=q1(be,$t),0<Lt.length&&($t=new D($t,c,null,m,He),Xe.push({event:$t,listeners:Lt}),Ot?$t.data=Ot:(Ot=xC(m),Ot!==null&&($t.data=Ot)))),(Ot=_G?xG(c,m):vG(c,m))&&(be=q1(be,"onBeforeInput"),0<be.length&&(He=new D("onBeforeInput","beforeinput",null,m,He),Xe.push({event:He,listeners:be}),He.data=Ot))}VC(Xe,d)})}function mg(c,d,m){return{instance:c,listener:d,currentTarget:m}}function q1(c,d){for(var m=d+"Capture",w=[];c!==null;){var S=c,A=S.stateNode;S.tag===5&&A!==null&&(S=A,A=sn(c,m),A!=null&&w.unshift(mg(c,A,S)),A=sn(c,d),A!=null&&w.push(mg(c,A,S))),c=c.return}return w}function Fd(c){if(c===null)return null;do c=c.return;while(c&&c.tag!==5);return c||null}function BC(c,d,m,w,S){for(var A=d._reactName,G=[];m!==null&&m!==w;){var re=m,ae=re.alternate,be=re.stateNode;if(ae!==null&&ae===w)break;re.tag===5&&be!==null&&(re=be,S?(ae=sn(m,A),ae!=null&&G.unshift(mg(m,ae,re))):S||(ae=sn(m,A),ae!=null&&G.push(mg(m,ae,re)))),m=m.return}G.length!==0&&c.push({event:d,listeners:G})}var LG=/\r\n?/g,OG=/\u0000|\uFFFD/g;function UC(c){return(typeof c=="string"?c:""+c).replace(LG,`
`).replace(OG,"")}function X1(c,d,m){if(d=UC(d),UC(c)!==d&&m)throw Error(t(425))}function Z1(){}var cE=null,uE=null;function hE(c,d){return c==="textarea"||c==="noscript"||typeof d.children=="string"||typeof d.children=="number"||typeof d.dangerouslySetInnerHTML=="object"&&d.dangerouslySetInnerHTML!==null&&d.dangerouslySetInnerHTML.__html!=null}var dE=typeof setTimeout=="function"?setTimeout:void 0,DG=typeof clearTimeout=="function"?clearTimeout:void 0,zC=typeof Promise=="function"?Promise:void 0,FG=typeof queueMicrotask=="function"?queueMicrotask:typeof zC<"u"?function(c){return zC.resolve(null).then(c).catch(jG)}:dE;function jG(c){setTimeout(function(){throw c})}function fE(c,d){var m=d,w=0;do{var S=m.nextSibling;if(c.removeChild(m),S&&S.nodeType===8)if(m=S.data,m==="/$"){if(w===0){c.removeChild(S),sc(d);return}w--}else m!=="$"&&m!=="$?"&&m!=="$!"||w++;m=S}while(m);sc(d)}function cc(c){for(;c!=null;c=c.nextSibling){var d=c.nodeType;if(d===1||d===3)break;if(d===8){if(d=c.data,d==="$"||d==="$!"||d==="$?")break;if(d==="/$")return null}}return c}function $C(c){c=c.previousSibling;for(var d=0;c;){if(c.nodeType===8){var m=c.data;if(m==="$"||m==="$!"||m==="$?"){if(d===0)return c;d--}else m==="/$"&&d++}c=c.previousSibling}return null}var jd=Math.random().toString(36).slice(2),To="__reactFiber$"+jd,pg="__reactProps$"+jd,ul="__reactContainer$"+jd,gE="__reactEvents$"+jd,VG="__reactListeners$"+jd,GG="__reactHandles$"+jd;function Vu(c){var d=c[To];if(d)return d;for(var m=c.parentNode;m;){if(d=m[ul]||m[To]){if(m=d.alternate,d.child!==null||m!==null&&m.child!==null)for(c=$C(c);c!==null;){if(m=c[To])return m;c=$C(c)}return d}c=m,m=c.parentNode}return null}function yg(c){return c=c[To]||c[ul],!c||c.tag!==5&&c.tag!==6&&c.tag!==13&&c.tag!==3?null:c}function Vd(c){if(c.tag===5||c.tag===6)return c.stateNode;throw Error(t(33))}function Q1(c){return c[pg]||null}var mE=[],Gd=-1;function uc(c){return{current:c}}function sr(c){0>Gd||(c.current=mE[Gd],mE[Gd]=null,Gd--)}function er(c,d){Gd++,mE[Gd]=c.current,c.current=d}var hc={},Oi=uc(hc),ds=uc(!1),Gu=hc;function Bd(c,d){var m=c.type.contextTypes;if(!m)return hc;var w=c.stateNode;if(w&&w.__reactInternalMemoizedUnmaskedChildContext===d)return w.__reactInternalMemoizedMaskedChildContext;var S={},A;for(A in m)S[A]=d[A];return w&&(c=c.stateNode,c.__reactInternalMemoizedUnmaskedChildContext=d,c.__reactInternalMemoizedMaskedChildContext=S),S}function fs(c){return c=c.childContextTypes,c!=null}function J1(){sr(ds),sr(Oi)}function WC(c,d,m){if(Oi.current!==hc)throw Error(t(168));er(Oi,d),er(ds,m)}function HC(c,d,m){var w=c.stateNode;if(d=d.childContextTypes,typeof w.getChildContext!="function")return m;w=w.getChildContext();for(var S in w)if(!(S in d))throw Error(t(108,Me(c)||"Unknown",S));return Ee({},m,w)}function ey(c){return c=(c=c.stateNode)&&c.__reactInternalMemoizedMergedChildContext||hc,Gu=Oi.current,er(Oi,c),er(ds,ds.current),!0}function KC(c,d,m){var w=c.stateNode;if(!w)throw Error(t(169));m?(c=HC(c,d,Gu),w.__reactInternalMemoizedMergedChildContext=c,sr(ds),sr(Oi),er(Oi,c)):sr(ds),er(ds,m)}var hl=null,ty=!1,pE=!1;function YC(c){hl===null?hl=[c]:hl.push(c)}function BG(c){ty=!0,YC(c)}function dc(){if(!pE&&hl!==null){pE=!0;var c=0,d=gn;try{var m=hl;for(gn=1;c<m.length;c++){var w=m[c];do w=w(!0);while(w!==null)}hl=null,ty=!1}catch(S){throw hl!==null&&(hl=hl.slice(c+1)),Ke(Mn,dc),S}finally{gn=d,pE=!1}}return null}var Ud=[],zd=0,ny=null,ry=0,aa=[],oa=0,Bu=null,dl=1,fl="";function Uu(c,d){Ud[zd++]=ry,Ud[zd++]=ny,ny=c,ry=d}function qC(c,d,m){aa[oa++]=dl,aa[oa++]=fl,aa[oa++]=Bu,Bu=c;var w=dl;c=fl;var S=32-yr(w)-1;w&=~(1<<S),m+=1;var A=32-yr(d)+S;if(30<A){var G=S-S%5;A=(w&(1<<G)-1).toString(32),w>>=G,S-=G,dl=1<<32-yr(d)+S|m<<S|w,fl=A+c}else dl=1<<A|m<<S|w,fl=c}function yE(c){c.return!==null&&(Uu(c,1),qC(c,1,0))}function _E(c){for(;c===ny;)ny=Ud[--zd],Ud[zd]=null,ry=Ud[--zd],Ud[zd]=null;for(;c===Bu;)Bu=aa[--oa],aa[oa]=null,fl=aa[--oa],aa[oa]=null,dl=aa[--oa],aa[oa]=null}var js=null,Vs=null,fr=!1,Na=null;function XC(c,d){var m=ha(5,null,null,0);m.elementType="DELETED",m.stateNode=d,m.return=c,d=c.deletions,d===null?(c.deletions=[m],c.flags|=16):d.push(m)}function ZC(c,d){switch(c.tag){case 5:var m=c.type;return d=d.nodeType!==1||m.toLowerCase()!==d.nodeName.toLowerCase()?null:d,d!==null?(c.stateNode=d,js=c,Vs=cc(d.firstChild),!0):!1;case 6:return d=c.pendingProps===""||d.nodeType!==3?null:d,d!==null?(c.stateNode=d,js=c,Vs=null,!0):!1;case 13:return d=d.nodeType!==8?null:d,d!==null?(m=Bu!==null?{id:dl,overflow:fl}:null,c.memoizedState={dehydrated:d,treeContext:m,retryLane:1073741824},m=ha(18,null,null,0),m.stateNode=d,m.return=c,c.child=m,js=c,Vs=null,!0):!1;default:return!1}}function xE(c){return(c.mode&1)!==0&&(c.flags&128)===0}function vE(c){if(fr){var d=Vs;if(d){var m=d;if(!ZC(c,d)){if(xE(c))throw Error(t(418));d=cc(m.nextSibling);var w=js;d&&ZC(c,d)?XC(w,m):(c.flags=c.flags&-4097|2,fr=!1,js=c)}}else{if(xE(c))throw Error(t(418));c.flags=c.flags&-4097|2,fr=!1,js=c}}}function QC(c){for(c=c.return;c!==null&&c.tag!==5&&c.tag!==3&&c.tag!==13;)c=c.return;js=c}function iy(c){if(c!==js)return!1;if(!fr)return QC(c),fr=!0,!1;var d;if((d=c.tag!==3)&&!(d=c.tag!==5)&&(d=c.type,d=d!=="head"&&d!=="body"&&!hE(c.type,c.memoizedProps)),d&&(d=Vs)){if(xE(c))throw JC(),Error(t(418));for(;d;)XC(c,d),d=cc(d.nextSibling)}if(QC(c),c.tag===13){if(c=c.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(t(317));e:{for(c=c.nextSibling,d=0;c;){if(c.nodeType===8){var m=c.data;if(m==="/$"){if(d===0){Vs=cc(c.nextSibling);break e}d--}else m!=="$"&&m!=="$!"&&m!=="$?"||d++}c=c.nextSibling}Vs=null}}else Vs=js?cc(c.stateNode.nextSibling):null;return!0}function JC(){for(var c=Vs;c;)c=cc(c.nextSibling)}function $d(){Vs=js=null,fr=!1}function wE(c){Na===null?Na=[c]:Na.push(c)}var UG=M.ReactCurrentBatchConfig;function _g(c,d,m){if(c=m.ref,c!==null&&typeof c!="function"&&typeof c!="object"){if(m._owner){if(m=m._owner,m){if(m.tag!==1)throw Error(t(309));var w=m.stateNode}if(!w)throw Error(t(147,c));var S=w,A=""+c;return d!==null&&d.ref!==null&&typeof d.ref=="function"&&d.ref._stringRef===A?d.ref:(d=function(G){var re=S.refs;G===null?delete re[A]:re[A]=G},d._stringRef=A,d)}if(typeof c!="string")throw Error(t(284));if(!m._owner)throw Error(t(290,c))}return c}function sy(c,d){throw c=Object.prototype.toString.call(d),Error(t(31,c==="[object Object]"?"object with keys {"+Object.keys(d).join(", ")+"}":c))}function eP(c){var d=c._init;return d(c._payload)}function tP(c){function d(fe,oe){if(c){var _e=fe.deletions;_e===null?(fe.deletions=[oe],fe.flags|=16):_e.push(oe)}}function m(fe,oe){if(!c)return null;for(;oe!==null;)d(fe,oe),oe=oe.sibling;return null}function w(fe,oe){for(fe=new Map;oe!==null;)oe.key!==null?fe.set(oe.key,oe):fe.set(oe.index,oe),oe=oe.sibling;return fe}function S(fe,oe){return fe=vc(fe,oe),fe.index=0,fe.sibling=null,fe}function A(fe,oe,_e){return fe.index=_e,c?(_e=fe.alternate,_e!==null?(_e=_e.index,_e<oe?(fe.flags|=2,oe):_e):(fe.flags|=2,oe)):(fe.flags|=1048576,oe)}function G(fe){return c&&fe.alternate===null&&(fe.flags|=2),fe}function re(fe,oe,_e,Je){return oe===null||oe.tag!==6?(oe=d2(_e,fe.mode,Je),oe.return=fe,oe):(oe=S(oe,_e),oe.return=fe,oe)}function ae(fe,oe,_e,Je){var It=_e.type;return It===k?He(fe,oe,_e.props.children,Je,_e.key):oe!==null&&(oe.elementType===It||typeof It=="object"&&It!==null&&It.$$typeof===ze&&eP(It)===oe.type)?(Je=S(oe,_e.props),Je.ref=_g(fe,oe,_e),Je.return=fe,Je):(Je=Cy(_e.type,_e.key,_e.props,null,fe.mode,Je),Je.ref=_g(fe,oe,_e),Je.return=fe,Je)}function be(fe,oe,_e,Je){return oe===null||oe.tag!==4||oe.stateNode.containerInfo!==_e.containerInfo||oe.stateNode.implementation!==_e.implementation?(oe=f2(_e,fe.mode,Je),oe.return=fe,oe):(oe=S(oe,_e.children||[]),oe.return=fe,oe)}function He(fe,oe,_e,Je,It){return oe===null||oe.tag!==7?(oe=Xu(_e,fe.mode,Je,It),oe.return=fe,oe):(oe=S(oe,_e),oe.return=fe,oe)}function Xe(fe,oe,_e){if(typeof oe=="string"&&oe!==""||typeof oe=="number")return oe=d2(""+oe,fe.mode,_e),oe.return=fe,oe;if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case F:return _e=Cy(oe.type,oe.key,oe.props,null,fe.mode,_e),_e.ref=_g(fe,null,oe),_e.return=fe,_e;case z:return oe=f2(oe,fe.mode,_e),oe.return=fe,oe;case ze:var Je=oe._init;return Xe(fe,Je(oe._payload),_e)}if(en(oe)||Te(oe))return oe=Xu(oe,fe.mode,_e,null),oe.return=fe,oe;sy(fe,oe)}return null}function Ue(fe,oe,_e,Je){var It=oe!==null?oe.key:null;if(typeof _e=="string"&&_e!==""||typeof _e=="number")return It!==null?null:re(fe,oe,""+_e,Je);if(typeof _e=="object"&&_e!==null){switch(_e.$$typeof){case F:return _e.key===It?ae(fe,oe,_e,Je):null;case z:return _e.key===It?be(fe,oe,_e,Je):null;case ze:return It=_e._init,Ue(fe,oe,It(_e._payload),Je)}if(en(_e)||Te(_e))return It!==null?null:He(fe,oe,_e,Je,null);sy(fe,_e)}return null}function pt(fe,oe,_e,Je,It){if(typeof Je=="string"&&Je!==""||typeof Je=="number")return fe=fe.get(_e)||null,re(oe,fe,""+Je,It);if(typeof Je=="object"&&Je!==null){switch(Je.$$typeof){case F:return fe=fe.get(Je.key===null?_e:Je.key)||null,ae(oe,fe,Je,It);case z:return fe=fe.get(Je.key===null?_e:Je.key)||null,be(oe,fe,Je,It);case ze:var Lt=Je._init;return pt(fe,oe,_e,Lt(Je._payload),It)}if(en(Je)||Te(Je))return fe=fe.get(_e)||null,He(oe,fe,Je,It,null);sy(oe,Je)}return null}function wt(fe,oe,_e,Je){for(var It=null,Lt=null,Ot=oe,$t=oe=0,li=null;Ot!==null&&$t<_e.length;$t++){Ot.index>$t?(li=Ot,Ot=null):li=Ot.sibling;var En=Ue(fe,Ot,_e[$t],Je);if(En===null){Ot===null&&(Ot=li);break}c&&Ot&&En.alternate===null&&d(fe,Ot),oe=A(En,oe,$t),Lt===null?It=En:Lt.sibling=En,Lt=En,Ot=li}if($t===_e.length)return m(fe,Ot),fr&&Uu(fe,$t),It;if(Ot===null){for(;$t<_e.length;$t++)Ot=Xe(fe,_e[$t],Je),Ot!==null&&(oe=A(Ot,oe,$t),Lt===null?It=Ot:Lt.sibling=Ot,Lt=Ot);return fr&&Uu(fe,$t),It}for(Ot=w(fe,Ot);$t<_e.length;$t++)li=pt(Ot,fe,$t,_e[$t],Je),li!==null&&(c&&li.alternate!==null&&Ot.delete(li.key===null?$t:li.key),oe=A(li,oe,$t),Lt===null?It=li:Lt.sibling=li,Lt=li);return c&&Ot.forEach(function(wc){return d(fe,wc)}),fr&&Uu(fe,$t),It}function Tt(fe,oe,_e,Je){var It=Te(_e);if(typeof It!="function")throw Error(t(150));if(_e=It.call(_e),_e==null)throw Error(t(151));for(var Lt=It=null,Ot=oe,$t=oe=0,li=null,En=_e.next();Ot!==null&&!En.done;$t++,En=_e.next()){Ot.index>$t?(li=Ot,Ot=null):li=Ot.sibling;var wc=Ue(fe,Ot,En.value,Je);if(wc===null){Ot===null&&(Ot=li);break}c&&Ot&&wc.alternate===null&&d(fe,Ot),oe=A(wc,oe,$t),Lt===null?It=wc:Lt.sibling=wc,Lt=wc,Ot=li}if(En.done)return m(fe,Ot),fr&&Uu(fe,$t),It;if(Ot===null){for(;!En.done;$t++,En=_e.next())En=Xe(fe,En.value,Je),En!==null&&(oe=A(En,oe,$t),Lt===null?It=En:Lt.sibling=En,Lt=En);return fr&&Uu(fe,$t),It}for(Ot=w(fe,Ot);!En.done;$t++,En=_e.next())En=pt(Ot,fe,$t,En.value,Je),En!==null&&(c&&En.alternate!==null&&Ot.delete(En.key===null?$t:En.key),oe=A(En,oe,$t),Lt===null?It=En:Lt.sibling=En,Lt=En);return c&&Ot.forEach(function(wB){return d(fe,wB)}),fr&&Uu(fe,$t),It}function Mr(fe,oe,_e,Je){if(typeof _e=="object"&&_e!==null&&_e.type===k&&_e.key===null&&(_e=_e.props.children),typeof _e=="object"&&_e!==null){switch(_e.$$typeof){case F:e:{for(var It=_e.key,Lt=oe;Lt!==null;){if(Lt.key===It){if(It=_e.type,It===k){if(Lt.tag===7){m(fe,Lt.sibling),oe=S(Lt,_e.props.children),oe.return=fe,fe=oe;break e}}else if(Lt.elementType===It||typeof It=="object"&&It!==null&&It.$$typeof===ze&&eP(It)===Lt.type){m(fe,Lt.sibling),oe=S(Lt,_e.props),oe.ref=_g(fe,Lt,_e),oe.return=fe,fe=oe;break e}m(fe,Lt);break}else d(fe,Lt);Lt=Lt.sibling}_e.type===k?(oe=Xu(_e.props.children,fe.mode,Je,_e.key),oe.return=fe,fe=oe):(Je=Cy(_e.type,_e.key,_e.props,null,fe.mode,Je),Je.ref=_g(fe,oe,_e),Je.return=fe,fe=Je)}return G(fe);case z:e:{for(Lt=_e.key;oe!==null;){if(oe.key===Lt)if(oe.tag===4&&oe.stateNode.containerInfo===_e.containerInfo&&oe.stateNode.implementation===_e.implementation){m(fe,oe.sibling),oe=S(oe,_e.children||[]),oe.return=fe,fe=oe;break e}else{m(fe,oe);break}else d(fe,oe);oe=oe.sibling}oe=f2(_e,fe.mode,Je),oe.return=fe,fe=oe}return G(fe);case ze:return Lt=_e._init,Mr(fe,oe,Lt(_e._payload),Je)}if(en(_e))return wt(fe,oe,_e,Je);if(Te(_e))return Tt(fe,oe,_e,Je);sy(fe,_e)}return typeof _e=="string"&&_e!==""||typeof _e=="number"?(_e=""+_e,oe!==null&&oe.tag===6?(m(fe,oe.sibling),oe=S(oe,_e),oe.return=fe,fe=oe):(m(fe,oe),oe=d2(_e,fe.mode,Je),oe.return=fe,fe=oe),G(fe)):m(fe,oe)}return Mr}var Wd=tP(!0),nP=tP(!1),ay=uc(null),oy=null,Hd=null,EE=null;function SE(){EE=Hd=oy=null}function TE(c){var d=ay.current;sr(ay),c._currentValue=d}function bE(c,d,m){for(;c!==null;){var w=c.alternate;if((c.childLanes&d)!==d?(c.childLanes|=d,w!==null&&(w.childLanes|=d)):w!==null&&(w.childLanes&d)!==d&&(w.childLanes|=d),c===m)break;c=c.return}}function Kd(c,d){oy=c,EE=Hd=null,c=c.dependencies,c!==null&&c.firstContext!==null&&((c.lanes&d)!==0&&(gs=!0),c.firstContext=null)}function la(c){var d=c._currentValue;if(EE!==c)if(c={context:c,memoizedValue:d,next:null},Hd===null){if(oy===null)throw Error(t(308));Hd=c,oy.dependencies={lanes:0,firstContext:c}}else Hd=Hd.next=c;return d}var zu=null;function IE(c){zu===null?zu=[c]:zu.push(c)}function rP(c,d,m,w){var S=d.interleaved;return S===null?(m.next=m,IE(d)):(m.next=S.next,S.next=m),d.interleaved=m,gl(c,w)}function gl(c,d){c.lanes|=d;var m=c.alternate;for(m!==null&&(m.lanes|=d),m=c,c=c.return;c!==null;)c.childLanes|=d,m=c.alternate,m!==null&&(m.childLanes|=d),m=c,c=c.return;return m.tag===3?m.stateNode:null}var fc=!1;function AE(c){c.updateQueue={baseState:c.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function iP(c,d){c=c.updateQueue,d.updateQueue===c&&(d.updateQueue={baseState:c.baseState,firstBaseUpdate:c.firstBaseUpdate,lastBaseUpdate:c.lastBaseUpdate,shared:c.shared,effects:c.effects})}function ml(c,d){return{eventTime:c,lane:d,tag:0,payload:null,callback:null,next:null}}function gc(c,d,m){var w=c.updateQueue;if(w===null)return null;if(w=w.shared,(_n&2)!==0){var S=w.pending;return S===null?d.next=d:(d.next=S.next,S.next=d),w.pending=d,gl(c,m)}return S=w.interleaved,S===null?(d.next=d,IE(w)):(d.next=S.next,S.next=d),w.interleaved=d,gl(c,m)}function ly(c,d,m){if(d=d.updateQueue,d!==null&&(d=d.shared,(m&4194240)!==0)){var w=d.lanes;w&=c.pendingLanes,m|=w,d.lanes=m,J0(c,m)}}function sP(c,d){var m=c.updateQueue,w=c.alternate;if(w!==null&&(w=w.updateQueue,m===w)){var S=null,A=null;if(m=m.firstBaseUpdate,m!==null){do{var G={eventTime:m.eventTime,lane:m.lane,tag:m.tag,payload:m.payload,callback:m.callback,next:null};A===null?S=A=G:A=A.next=G,m=m.next}while(m!==null);A===null?S=A=d:A=A.next=d}else S=A=d;m={baseState:w.baseState,firstBaseUpdate:S,lastBaseUpdate:A,shared:w.shared,effects:w.effects},c.updateQueue=m;return}c=m.lastBaseUpdate,c===null?m.firstBaseUpdate=d:c.next=d,m.lastBaseUpdate=d}function cy(c,d,m,w){var S=c.updateQueue;fc=!1;var A=S.firstBaseUpdate,G=S.lastBaseUpdate,re=S.shared.pending;if(re!==null){S.shared.pending=null;var ae=re,be=ae.next;ae.next=null,G===null?A=be:G.next=be,G=ae;var He=c.alternate;He!==null&&(He=He.updateQueue,re=He.lastBaseUpdate,re!==G&&(re===null?He.firstBaseUpdate=be:re.next=be,He.lastBaseUpdate=ae))}if(A!==null){var Xe=S.baseState;G=0,He=be=ae=null,re=A;do{var Ue=re.lane,pt=re.eventTime;if((w&Ue)===Ue){He!==null&&(He=He.next={eventTime:pt,lane:0,tag:re.tag,payload:re.payload,callback:re.callback,next:null});e:{var wt=c,Tt=re;switch(Ue=d,pt=m,Tt.tag){case 1:if(wt=Tt.payload,typeof wt=="function"){Xe=wt.call(pt,Xe,Ue);break e}Xe=wt;break e;case 3:wt.flags=wt.flags&-65537|128;case 0:if(wt=Tt.payload,Ue=typeof wt=="function"?wt.call(pt,Xe,Ue):wt,Ue==null)break e;Xe=Ee({},Xe,Ue);break e;case 2:fc=!0}}re.callback!==null&&re.lane!==0&&(c.flags|=64,Ue=S.effects,Ue===null?S.effects=[re]:Ue.push(re))}else pt={eventTime:pt,lane:Ue,tag:re.tag,payload:re.payload,callback:re.callback,next:null},He===null?(be=He=pt,ae=Xe):He=He.next=pt,G|=Ue;if(re=re.next,re===null){if(re=S.shared.pending,re===null)break;Ue=re,re=Ue.next,Ue.next=null,S.lastBaseUpdate=Ue,S.shared.pending=null}}while(!0);if(He===null&&(ae=Xe),S.baseState=ae,S.firstBaseUpdate=be,S.lastBaseUpdate=He,d=S.shared.interleaved,d!==null){S=d;do G|=S.lane,S=S.next;while(S!==d)}else A===null&&(S.shared.lanes=0);Hu|=G,c.lanes=G,c.memoizedState=Xe}}function aP(c,d,m){if(c=d.effects,d.effects=null,c!==null)for(d=0;d<c.length;d++){var w=c[d],S=w.callback;if(S!==null){if(w.callback=null,w=m,typeof S!="function")throw Error(t(191,S));S.call(w)}}}var xg={},bo=uc(xg),vg=uc(xg),wg=uc(xg);function $u(c){if(c===xg)throw Error(t(174));return c}function RE(c,d){switch(er(wg,d),er(vg,c),er(bo,xg),c=d.nodeType,c){case 9:case 11:d=(d=d.documentElement)?d.namespaceURI:Rt(null,"");break;default:c=c===8?d.parentNode:d,d=c.namespaceURI||null,c=c.tagName,d=Rt(d,c)}sr(bo),er(bo,d)}function Yd(){sr(bo),sr(vg),sr(wg)}function oP(c){$u(wg.current);var d=$u(bo.current),m=Rt(d,c.type);d!==m&&(er(vg,c),er(bo,m))}function CE(c){vg.current===c&&(sr(bo),sr(vg))}var _r=uc(0);function uy(c){for(var d=c;d!==null;){if(d.tag===13){var m=d.memoizedState;if(m!==null&&(m=m.dehydrated,m===null||m.data==="$?"||m.data==="$!"))return d}else if(d.tag===19&&d.memoizedProps.revealOrder!==void 0){if((d.flags&128)!==0)return d}else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===c)break;for(;d.sibling===null;){if(d.return===null||d.return===c)return null;d=d.return}d.sibling.return=d.return,d=d.sibling}return null}var PE=[];function kE(){for(var c=0;c<PE.length;c++)PE[c]._workInProgressVersionPrimary=null;PE.length=0}var hy=M.ReactCurrentDispatcher,ME=M.ReactCurrentBatchConfig,Wu=0,xr=null,Xr=null,ai=null,dy=!1,Eg=!1,Sg=0,zG=0;function Di(){throw Error(t(321))}function NE(c,d){if(d===null)return!1;for(var m=0;m<d.length&&m<c.length;m++)if(!Ma(c[m],d[m]))return!1;return!0}function LE(c,d,m,w,S,A){if(Wu=A,xr=d,d.memoizedState=null,d.updateQueue=null,d.lanes=0,hy.current=c===null||c.memoizedState===null?KG:YG,c=m(w,S),Eg){A=0;do{if(Eg=!1,Sg=0,25<=A)throw Error(t(301));A+=1,ai=Xr=null,d.updateQueue=null,hy.current=qG,c=m(w,S)}while(Eg)}if(hy.current=my,d=Xr!==null&&Xr.next!==null,Wu=0,ai=Xr=xr=null,dy=!1,d)throw Error(t(300));return c}function OE(){var c=Sg!==0;return Sg=0,c}function Io(){var c={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ai===null?xr.memoizedState=ai=c:ai=ai.next=c,ai}function ca(){if(Xr===null){var c=xr.alternate;c=c!==null?c.memoizedState:null}else c=Xr.next;var d=ai===null?xr.memoizedState:ai.next;if(d!==null)ai=d,Xr=c;else{if(c===null)throw Error(t(310));Xr=c,c={memoizedState:Xr.memoizedState,baseState:Xr.baseState,baseQueue:Xr.baseQueue,queue:Xr.queue,next:null},ai===null?xr.memoizedState=ai=c:ai=ai.next=c}return ai}function Tg(c,d){return typeof d=="function"?d(c):d}function DE(c){var d=ca(),m=d.queue;if(m===null)throw Error(t(311));m.lastRenderedReducer=c;var w=Xr,S=w.baseQueue,A=m.pending;if(A!==null){if(S!==null){var G=S.next;S.next=A.next,A.next=G}w.baseQueue=S=A,m.pending=null}if(S!==null){A=S.next,w=w.baseState;var re=G=null,ae=null,be=A;do{var He=be.lane;if((Wu&He)===He)ae!==null&&(ae=ae.next={lane:0,action:be.action,hasEagerState:be.hasEagerState,eagerState:be.eagerState,next:null}),w=be.hasEagerState?be.eagerState:c(w,be.action);else{var Xe={lane:He,action:be.action,hasEagerState:be.hasEagerState,eagerState:be.eagerState,next:null};ae===null?(re=ae=Xe,G=w):ae=ae.next=Xe,xr.lanes|=He,Hu|=He}be=be.next}while(be!==null&&be!==A);ae===null?G=w:ae.next=re,Ma(w,d.memoizedState)||(gs=!0),d.memoizedState=w,d.baseState=G,d.baseQueue=ae,m.lastRenderedState=w}if(c=m.interleaved,c!==null){S=c;do A=S.lane,xr.lanes|=A,Hu|=A,S=S.next;while(S!==c)}else S===null&&(m.lanes=0);return[d.memoizedState,m.dispatch]}function FE(c){var d=ca(),m=d.queue;if(m===null)throw Error(t(311));m.lastRenderedReducer=c;var w=m.dispatch,S=m.pending,A=d.memoizedState;if(S!==null){m.pending=null;var G=S=S.next;do A=c(A,G.action),G=G.next;while(G!==S);Ma(A,d.memoizedState)||(gs=!0),d.memoizedState=A,d.baseQueue===null&&(d.baseState=A),m.lastRenderedState=A}return[A,w]}function lP(){}function cP(c,d){var m=xr,w=ca(),S=d(),A=!Ma(w.memoizedState,S);if(A&&(w.memoizedState=S,gs=!0),w=w.queue,jE(dP.bind(null,m,w,c),[c]),w.getSnapshot!==d||A||ai!==null&&ai.memoizedState.tag&1){if(m.flags|=2048,bg(9,hP.bind(null,m,w,S,d),void 0,null),oi===null)throw Error(t(349));(Wu&30)!==0||uP(m,d,S)}return S}function uP(c,d,m){c.flags|=16384,c={getSnapshot:d,value:m},d=xr.updateQueue,d===null?(d={lastEffect:null,stores:null},xr.updateQueue=d,d.stores=[c]):(m=d.stores,m===null?d.stores=[c]:m.push(c))}function hP(c,d,m,w){d.value=m,d.getSnapshot=w,fP(d)&&gP(c)}function dP(c,d,m){return m(function(){fP(d)&&gP(c)})}function fP(c){var d=c.getSnapshot;c=c.value;try{var m=d();return!Ma(c,m)}catch{return!0}}function gP(c){var d=gl(c,1);d!==null&&Fa(d,c,1,-1)}function mP(c){var d=Io();return typeof c=="function"&&(c=c()),d.memoizedState=d.baseState=c,c={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Tg,lastRenderedState:c},d.queue=c,c=c.dispatch=HG.bind(null,xr,c),[d.memoizedState,c]}function bg(c,d,m,w){return c={tag:c,create:d,destroy:m,deps:w,next:null},d=xr.updateQueue,d===null?(d={lastEffect:null,stores:null},xr.updateQueue=d,d.lastEffect=c.next=c):(m=d.lastEffect,m===null?d.lastEffect=c.next=c:(w=m.next,m.next=c,c.next=w,d.lastEffect=c)),c}function pP(){return ca().memoizedState}function fy(c,d,m,w){var S=Io();xr.flags|=c,S.memoizedState=bg(1|d,m,void 0,w===void 0?null:w)}function gy(c,d,m,w){var S=ca();w=w===void 0?null:w;var A=void 0;if(Xr!==null){var G=Xr.memoizedState;if(A=G.destroy,w!==null&&NE(w,G.deps)){S.memoizedState=bg(d,m,A,w);return}}xr.flags|=c,S.memoizedState=bg(1|d,m,A,w)}function yP(c,d){return fy(8390656,8,c,d)}function jE(c,d){return gy(2048,8,c,d)}function _P(c,d){return gy(4,2,c,d)}function xP(c,d){return gy(4,4,c,d)}function vP(c,d){if(typeof d=="function")return c=c(),d(c),function(){d(null)};if(d!=null)return c=c(),d.current=c,function(){d.current=null}}function wP(c,d,m){return m=m!=null?m.concat([c]):null,gy(4,4,vP.bind(null,d,c),m)}function VE(){}function EP(c,d){var m=ca();d=d===void 0?null:d;var w=m.memoizedState;return w!==null&&d!==null&&NE(d,w[1])?w[0]:(m.memoizedState=[c,d],c)}function SP(c,d){var m=ca();d=d===void 0?null:d;var w=m.memoizedState;return w!==null&&d!==null&&NE(d,w[1])?w[0]:(c=c(),m.memoizedState=[c,d],c)}function TP(c,d,m){return(Wu&21)===0?(c.baseState&&(c.baseState=!1,gs=!0),c.memoizedState=m):(Ma(m,d)||(m=Z0(),xr.lanes|=m,Hu|=m,c.baseState=!0),d)}function $G(c,d){var m=gn;gn=m!==0&&4>m?m:4,c(!0);var w=ME.transition;ME.transition={};try{c(!1),d()}finally{gn=m,ME.transition=w}}function bP(){return ca().memoizedState}function WG(c,d,m){var w=_c(c);if(m={lane:w,action:m,hasEagerState:!1,eagerState:null,next:null},IP(c))AP(d,m);else if(m=rP(c,d,m,w),m!==null){var S=ts();Fa(m,c,w,S),RP(m,d,w)}}function HG(c,d,m){var w=_c(c),S={lane:w,action:m,hasEagerState:!1,eagerState:null,next:null};if(IP(c))AP(d,S);else{var A=c.alternate;if(c.lanes===0&&(A===null||A.lanes===0)&&(A=d.lastRenderedReducer,A!==null))try{var G=d.lastRenderedState,re=A(G,m);if(S.hasEagerState=!0,S.eagerState=re,Ma(re,G)){var ae=d.interleaved;ae===null?(S.next=S,IE(d)):(S.next=ae.next,ae.next=S),d.interleaved=S;return}}catch{}m=rP(c,d,S,w),m!==null&&(S=ts(),Fa(m,c,w,S),RP(m,d,w))}}function IP(c){var d=c.alternate;return c===xr||d!==null&&d===xr}function AP(c,d){Eg=dy=!0;var m=c.pending;m===null?d.next=d:(d.next=m.next,m.next=d),c.pending=d}function RP(c,d,m){if((m&4194240)!==0){var w=d.lanes;w&=c.pendingLanes,m|=w,d.lanes=m,J0(c,m)}}var my={readContext:la,useCallback:Di,useContext:Di,useEffect:Di,useImperativeHandle:Di,useInsertionEffect:Di,useLayoutEffect:Di,useMemo:Di,useReducer:Di,useRef:Di,useState:Di,useDebugValue:Di,useDeferredValue:Di,useTransition:Di,useMutableSource:Di,useSyncExternalStore:Di,useId:Di,unstable_isNewReconciler:!1},KG={readContext:la,useCallback:function(c,d){return Io().memoizedState=[c,d===void 0?null:d],c},useContext:la,useEffect:yP,useImperativeHandle:function(c,d,m){return m=m!=null?m.concat([c]):null,fy(4194308,4,vP.bind(null,d,c),m)},useLayoutEffect:function(c,d){return fy(4194308,4,c,d)},useInsertionEffect:function(c,d){return fy(4,2,c,d)},useMemo:function(c,d){var m=Io();return d=d===void 0?null:d,c=c(),m.memoizedState=[c,d],c},useReducer:function(c,d,m){var w=Io();return d=m!==void 0?m(d):d,w.memoizedState=w.baseState=d,c={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:c,lastRenderedState:d},w.queue=c,c=c.dispatch=WG.bind(null,xr,c),[w.memoizedState,c]},useRef:function(c){var d=Io();return c={current:c},d.memoizedState=c},useState:mP,useDebugValue:VE,useDeferredValue:function(c){return Io().memoizedState=c},useTransition:function(){var c=mP(!1),d=c[0];return c=$G.bind(null,c[1]),Io().memoizedState=c,[d,c]},useMutableSource:function(){},useSyncExternalStore:function(c,d,m){var w=xr,S=Io();if(fr){if(m===void 0)throw Error(t(407));m=m()}else{if(m=d(),oi===null)throw Error(t(349));(Wu&30)!==0||uP(w,d,m)}S.memoizedState=m;var A={value:m,getSnapshot:d};return S.queue=A,yP(dP.bind(null,w,A,c),[c]),w.flags|=2048,bg(9,hP.bind(null,w,A,m,d),void 0,null),m},useId:function(){var c=Io(),d=oi.identifierPrefix;if(fr){var m=fl,w=dl;m=(w&~(1<<32-yr(w)-1)).toString(32)+m,d=":"+d+"R"+m,m=Sg++,0<m&&(d+="H"+m.toString(32)),d+=":"}else m=zG++,d=":"+d+"r"+m.toString(32)+":";return c.memoizedState=d},unstable_isNewReconciler:!1},YG={readContext:la,useCallback:EP,useContext:la,useEffect:jE,useImperativeHandle:wP,useInsertionEffect:_P,useLayoutEffect:xP,useMemo:SP,useReducer:DE,useRef:pP,useState:function(){return DE(Tg)},useDebugValue:VE,useDeferredValue:function(c){var d=ca();return TP(d,Xr.memoizedState,c)},useTransition:function(){var c=DE(Tg)[0],d=ca().memoizedState;return[c,d]},useMutableSource:lP,useSyncExternalStore:cP,useId:bP,unstable_isNewReconciler:!1},qG={readContext:la,useCallback:EP,useContext:la,useEffect:jE,useImperativeHandle:wP,useInsertionEffect:_P,useLayoutEffect:xP,useMemo:SP,useReducer:FE,useRef:pP,useState:function(){return FE(Tg)},useDebugValue:VE,useDeferredValue:function(c){var d=ca();return Xr===null?d.memoizedState=c:TP(d,Xr.memoizedState,c)},useTransition:function(){var c=FE(Tg)[0],d=ca().memoizedState;return[c,d]},useMutableSource:lP,useSyncExternalStore:cP,useId:bP,unstable_isNewReconciler:!1};function La(c,d){if(c&&c.defaultProps){d=Ee({},d),c=c.defaultProps;for(var m in c)d[m]===void 0&&(d[m]=c[m]);return d}return d}function GE(c,d,m,w){d=c.memoizedState,m=m(w,d),m=m==null?d:Ee({},d,m),c.memoizedState=m,c.lanes===0&&(c.updateQueue.baseState=m)}var py={isMounted:function(c){return(c=c._reactInternals)?te(c)===c:!1},enqueueSetState:function(c,d,m){c=c._reactInternals;var w=ts(),S=_c(c),A=ml(w,S);A.payload=d,m!=null&&(A.callback=m),d=gc(c,A,S),d!==null&&(Fa(d,c,S,w),ly(d,c,S))},enqueueReplaceState:function(c,d,m){c=c._reactInternals;var w=ts(),S=_c(c),A=ml(w,S);A.tag=1,A.payload=d,m!=null&&(A.callback=m),d=gc(c,A,S),d!==null&&(Fa(d,c,S,w),ly(d,c,S))},enqueueForceUpdate:function(c,d){c=c._reactInternals;var m=ts(),w=_c(c),S=ml(m,w);S.tag=2,d!=null&&(S.callback=d),d=gc(c,S,w),d!==null&&(Fa(d,c,w,m),ly(d,c,w))}};function CP(c,d,m,w,S,A,G){return c=c.stateNode,typeof c.shouldComponentUpdate=="function"?c.shouldComponentUpdate(w,A,G):d.prototype&&d.prototype.isPureReactComponent?!hg(m,w)||!hg(S,A):!0}function PP(c,d,m){var w=!1,S=hc,A=d.contextType;return typeof A=="object"&&A!==null?A=la(A):(S=fs(d)?Gu:Oi.current,w=d.contextTypes,A=(w=w!=null)?Bd(c,S):hc),d=new d(m,A),c.memoizedState=d.state!==null&&d.state!==void 0?d.state:null,d.updater=py,c.stateNode=d,d._reactInternals=c,w&&(c=c.stateNode,c.__reactInternalMemoizedUnmaskedChildContext=S,c.__reactInternalMemoizedMaskedChildContext=A),d}function kP(c,d,m,w){c=d.state,typeof d.componentWillReceiveProps=="function"&&d.componentWillReceiveProps(m,w),typeof d.UNSAFE_componentWillReceiveProps=="function"&&d.UNSAFE_componentWillReceiveProps(m,w),d.state!==c&&py.enqueueReplaceState(d,d.state,null)}function BE(c,d,m,w){var S=c.stateNode;S.props=m,S.state=c.memoizedState,S.refs={},AE(c);var A=d.contextType;typeof A=="object"&&A!==null?S.context=la(A):(A=fs(d)?Gu:Oi.current,S.context=Bd(c,A)),S.state=c.memoizedState,A=d.getDerivedStateFromProps,typeof A=="function"&&(GE(c,d,A,m),S.state=c.memoizedState),typeof d.getDerivedStateFromProps=="function"||typeof S.getSnapshotBeforeUpdate=="function"||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(d=S.state,typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount(),d!==S.state&&py.enqueueReplaceState(S,S.state,null),cy(c,m,S,w),S.state=c.memoizedState),typeof S.componentDidMount=="function"&&(c.flags|=4194308)}function qd(c,d){try{var m="",w=d;do m+=X(w),w=w.return;while(w);var S=m}catch(A){S=`
Error generating stack: `+A.message+`
`+A.stack}return{value:c,source:d,stack:S,digest:null}}function UE(c,d,m){return{value:c,source:null,stack:m??null,digest:d??null}}function zE(c,d){try{console.error(d.value)}catch(m){setTimeout(function(){throw m})}}var XG=typeof WeakMap=="function"?WeakMap:Map;function MP(c,d,m){m=ml(-1,m),m.tag=3,m.payload={element:null};var w=d.value;return m.callback=function(){Sy||(Sy=!0,i2=w),zE(c,d)},m}function NP(c,d,m){m=ml(-1,m),m.tag=3;var w=c.type.getDerivedStateFromError;if(typeof w=="function"){var S=d.value;m.payload=function(){return w(S)},m.callback=function(){zE(c,d)}}var A=c.stateNode;return A!==null&&typeof A.componentDidCatch=="function"&&(m.callback=function(){zE(c,d),typeof w!="function"&&(pc===null?pc=new Set([this]):pc.add(this));var G=d.stack;this.componentDidCatch(d.value,{componentStack:G!==null?G:""})}),m}function LP(c,d,m){var w=c.pingCache;if(w===null){w=c.pingCache=new XG;var S=new Set;w.set(d,S)}else S=w.get(d),S===void 0&&(S=new Set,w.set(d,S));S.has(m)||(S.add(m),c=uB.bind(null,c,d,m),d.then(c,c))}function OP(c){do{var d;if((d=c.tag===13)&&(d=c.memoizedState,d=d!==null?d.dehydrated!==null:!0),d)return c;c=c.return}while(c!==null);return null}function DP(c,d,m,w,S){return(c.mode&1)===0?(c===d?c.flags|=65536:(c.flags|=128,m.flags|=131072,m.flags&=-52805,m.tag===1&&(m.alternate===null?m.tag=17:(d=ml(-1,1),d.tag=2,gc(m,d,1))),m.lanes|=1),c):(c.flags|=65536,c.lanes=S,c)}var ZG=M.ReactCurrentOwner,gs=!1;function es(c,d,m,w){d.child=c===null?nP(d,null,m,w):Wd(d,c.child,m,w)}function FP(c,d,m,w,S){m=m.render;var A=d.ref;return Kd(d,S),w=LE(c,d,m,w,A,S),m=OE(),c!==null&&!gs?(d.updateQueue=c.updateQueue,d.flags&=-2053,c.lanes&=~S,pl(c,d,S)):(fr&&m&&yE(d),d.flags|=1,es(c,d,w,S),d.child)}function jP(c,d,m,w,S){if(c===null){var A=m.type;return typeof A=="function"&&!h2(A)&&A.defaultProps===void 0&&m.compare===null&&m.defaultProps===void 0?(d.tag=15,d.type=A,VP(c,d,A,w,S)):(c=Cy(m.type,null,w,d,d.mode,S),c.ref=d.ref,c.return=d,d.child=c)}if(A=c.child,(c.lanes&S)===0){var G=A.memoizedProps;if(m=m.compare,m=m!==null?m:hg,m(G,w)&&c.ref===d.ref)return pl(c,d,S)}return d.flags|=1,c=vc(A,w),c.ref=d.ref,c.return=d,d.child=c}function VP(c,d,m,w,S){if(c!==null){var A=c.memoizedProps;if(hg(A,w)&&c.ref===d.ref)if(gs=!1,d.pendingProps=w=A,(c.lanes&S)!==0)(c.flags&131072)!==0&&(gs=!0);else return d.lanes=c.lanes,pl(c,d,S)}return $E(c,d,m,w,S)}function GP(c,d,m){var w=d.pendingProps,S=w.children,A=c!==null?c.memoizedState:null;if(w.mode==="hidden")if((d.mode&1)===0)d.memoizedState={baseLanes:0,cachePool:null,transitions:null},er(Zd,Gs),Gs|=m;else{if((m&1073741824)===0)return c=A!==null?A.baseLanes|m:m,d.lanes=d.childLanes=1073741824,d.memoizedState={baseLanes:c,cachePool:null,transitions:null},d.updateQueue=null,er(Zd,Gs),Gs|=c,null;d.memoizedState={baseLanes:0,cachePool:null,transitions:null},w=A!==null?A.baseLanes:m,er(Zd,Gs),Gs|=w}else A!==null?(w=A.baseLanes|m,d.memoizedState=null):w=m,er(Zd,Gs),Gs|=w;return es(c,d,S,m),d.child}function BP(c,d){var m=d.ref;(c===null&&m!==null||c!==null&&c.ref!==m)&&(d.flags|=512,d.flags|=2097152)}function $E(c,d,m,w,S){var A=fs(m)?Gu:Oi.current;return A=Bd(d,A),Kd(d,S),m=LE(c,d,m,w,A,S),w=OE(),c!==null&&!gs?(d.updateQueue=c.updateQueue,d.flags&=-2053,c.lanes&=~S,pl(c,d,S)):(fr&&w&&yE(d),d.flags|=1,es(c,d,m,S),d.child)}function UP(c,d,m,w,S){if(fs(m)){var A=!0;ey(d)}else A=!1;if(Kd(d,S),d.stateNode===null)_y(c,d),PP(d,m,w),BE(d,m,w,S),w=!0;else if(c===null){var G=d.stateNode,re=d.memoizedProps;G.props=re;var ae=G.context,be=m.contextType;typeof be=="object"&&be!==null?be=la(be):(be=fs(m)?Gu:Oi.current,be=Bd(d,be));var He=m.getDerivedStateFromProps,Xe=typeof He=="function"||typeof G.getSnapshotBeforeUpdate=="function";Xe||typeof G.UNSAFE_componentWillReceiveProps!="function"&&typeof G.componentWillReceiveProps!="function"||(re!==w||ae!==be)&&kP(d,G,w,be),fc=!1;var Ue=d.memoizedState;G.state=Ue,cy(d,w,G,S),ae=d.memoizedState,re!==w||Ue!==ae||ds.current||fc?(typeof He=="function"&&(GE(d,m,He,w),ae=d.memoizedState),(re=fc||CP(d,m,re,w,Ue,ae,be))?(Xe||typeof G.UNSAFE_componentWillMount!="function"&&typeof G.componentWillMount!="function"||(typeof G.componentWillMount=="function"&&G.componentWillMount(),typeof G.UNSAFE_componentWillMount=="function"&&G.UNSAFE_componentWillMount()),typeof G.componentDidMount=="function"&&(d.flags|=4194308)):(typeof G.componentDidMount=="function"&&(d.flags|=4194308),d.memoizedProps=w,d.memoizedState=ae),G.props=w,G.state=ae,G.context=be,w=re):(typeof G.componentDidMount=="function"&&(d.flags|=4194308),w=!1)}else{G=d.stateNode,iP(c,d),re=d.memoizedProps,be=d.type===d.elementType?re:La(d.type,re),G.props=be,Xe=d.pendingProps,Ue=G.context,ae=m.contextType,typeof ae=="object"&&ae!==null?ae=la(ae):(ae=fs(m)?Gu:Oi.current,ae=Bd(d,ae));var pt=m.getDerivedStateFromProps;(He=typeof pt=="function"||typeof G.getSnapshotBeforeUpdate=="function")||typeof G.UNSAFE_componentWillReceiveProps!="function"&&typeof G.componentWillReceiveProps!="function"||(re!==Xe||Ue!==ae)&&kP(d,G,w,ae),fc=!1,Ue=d.memoizedState,G.state=Ue,cy(d,w,G,S);var wt=d.memoizedState;re!==Xe||Ue!==wt||ds.current||fc?(typeof pt=="function"&&(GE(d,m,pt,w),wt=d.memoizedState),(be=fc||CP(d,m,be,w,Ue,wt,ae)||!1)?(He||typeof G.UNSAFE_componentWillUpdate!="function"&&typeof G.componentWillUpdate!="function"||(typeof G.componentWillUpdate=="function"&&G.componentWillUpdate(w,wt,ae),typeof G.UNSAFE_componentWillUpdate=="function"&&G.UNSAFE_componentWillUpdate(w,wt,ae)),typeof G.componentDidUpdate=="function"&&(d.flags|=4),typeof G.getSnapshotBeforeUpdate=="function"&&(d.flags|=1024)):(typeof G.componentDidUpdate!="function"||re===c.memoizedProps&&Ue===c.memoizedState||(d.flags|=4),typeof G.getSnapshotBeforeUpdate!="function"||re===c.memoizedProps&&Ue===c.memoizedState||(d.flags|=1024),d.memoizedProps=w,d.memoizedState=wt),G.props=w,G.state=wt,G.context=ae,w=be):(typeof G.componentDidUpdate!="function"||re===c.memoizedProps&&Ue===c.memoizedState||(d.flags|=4),typeof G.getSnapshotBeforeUpdate!="function"||re===c.memoizedProps&&Ue===c.memoizedState||(d.flags|=1024),w=!1)}return WE(c,d,m,w,A,S)}function WE(c,d,m,w,S,A){BP(c,d);var G=(d.flags&128)!==0;if(!w&&!G)return S&&KC(d,m,!1),pl(c,d,A);w=d.stateNode,ZG.current=d;var re=G&&typeof m.getDerivedStateFromError!="function"?null:w.render();return d.flags|=1,c!==null&&G?(d.child=Wd(d,c.child,null,A),d.child=Wd(d,null,re,A)):es(c,d,re,A),d.memoizedState=w.state,S&&KC(d,m,!0),d.child}function zP(c){var d=c.stateNode;d.pendingContext?WC(c,d.pendingContext,d.pendingContext!==d.context):d.context&&WC(c,d.context,!1),RE(c,d.containerInfo)}function $P(c,d,m,w,S){return $d(),wE(S),d.flags|=256,es(c,d,m,w),d.child}var HE={dehydrated:null,treeContext:null,retryLane:0};function KE(c){return{baseLanes:c,cachePool:null,transitions:null}}function WP(c,d,m){var w=d.pendingProps,S=_r.current,A=!1,G=(d.flags&128)!==0,re;if((re=G)||(re=c!==null&&c.memoizedState===null?!1:(S&2)!==0),re?(A=!0,d.flags&=-129):(c===null||c.memoizedState!==null)&&(S|=1),er(_r,S&1),c===null)return vE(d),c=d.memoizedState,c!==null&&(c=c.dehydrated,c!==null)?((d.mode&1)===0?d.lanes=1:c.data==="$!"?d.lanes=8:d.lanes=1073741824,null):(G=w.children,c=w.fallback,A?(w=d.mode,A=d.child,G={mode:"hidden",children:G},(w&1)===0&&A!==null?(A.childLanes=0,A.pendingProps=G):A=Py(G,w,0,null),c=Xu(c,w,m,null),A.return=d,c.return=d,A.sibling=c,d.child=A,d.child.memoizedState=KE(m),d.memoizedState=HE,c):YE(d,G));if(S=c.memoizedState,S!==null&&(re=S.dehydrated,re!==null))return QG(c,d,G,w,re,S,m);if(A){A=w.fallback,G=d.mode,S=c.child,re=S.sibling;var ae={mode:"hidden",children:w.children};return(G&1)===0&&d.child!==S?(w=d.child,w.childLanes=0,w.pendingProps=ae,d.deletions=null):(w=vc(S,ae),w.subtreeFlags=S.subtreeFlags&14680064),re!==null?A=vc(re,A):(A=Xu(A,G,m,null),A.flags|=2),A.return=d,w.return=d,w.sibling=A,d.child=w,w=A,A=d.child,G=c.child.memoizedState,G=G===null?KE(m):{baseLanes:G.baseLanes|m,cachePool:null,transitions:G.transitions},A.memoizedState=G,A.childLanes=c.childLanes&~m,d.memoizedState=HE,w}return A=c.child,c=A.sibling,w=vc(A,{mode:"visible",children:w.children}),(d.mode&1)===0&&(w.lanes=m),w.return=d,w.sibling=null,c!==null&&(m=d.deletions,m===null?(d.deletions=[c],d.flags|=16):m.push(c)),d.child=w,d.memoizedState=null,w}function YE(c,d){return d=Py({mode:"visible",children:d},c.mode,0,null),d.return=c,c.child=d}function yy(c,d,m,w){return w!==null&&wE(w),Wd(d,c.child,null,m),c=YE(d,d.pendingProps.children),c.flags|=2,d.memoizedState=null,c}function QG(c,d,m,w,S,A,G){if(m)return d.flags&256?(d.flags&=-257,w=UE(Error(t(422))),yy(c,d,G,w)):d.memoizedState!==null?(d.child=c.child,d.flags|=128,null):(A=w.fallback,S=d.mode,w=Py({mode:"visible",children:w.children},S,0,null),A=Xu(A,S,G,null),A.flags|=2,w.return=d,A.return=d,w.sibling=A,d.child=w,(d.mode&1)!==0&&Wd(d,c.child,null,G),d.child.memoizedState=KE(G),d.memoizedState=HE,A);if((d.mode&1)===0)return yy(c,d,G,null);if(S.data==="$!"){if(w=S.nextSibling&&S.nextSibling.dataset,w)var re=w.dgst;return w=re,A=Error(t(419)),w=UE(A,w,void 0),yy(c,d,G,w)}if(re=(G&c.childLanes)!==0,gs||re){if(w=oi,w!==null){switch(G&-G){case 4:S=2;break;case 16:S=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:S=32;break;case 536870912:S=268435456;break;default:S=0}S=(S&(w.suspendedLanes|G))!==0?0:S,S!==0&&S!==A.retryLane&&(A.retryLane=S,gl(c,S),Fa(w,c,S,-1))}return u2(),w=UE(Error(t(421))),yy(c,d,G,w)}return S.data==="$?"?(d.flags|=128,d.child=c.child,d=hB.bind(null,c),S._reactRetry=d,null):(c=A.treeContext,Vs=cc(S.nextSibling),js=d,fr=!0,Na=null,c!==null&&(aa[oa++]=dl,aa[oa++]=fl,aa[oa++]=Bu,dl=c.id,fl=c.overflow,Bu=d),d=YE(d,w.children),d.flags|=4096,d)}function HP(c,d,m){c.lanes|=d;var w=c.alternate;w!==null&&(w.lanes|=d),bE(c.return,d,m)}function qE(c,d,m,w,S){var A=c.memoizedState;A===null?c.memoizedState={isBackwards:d,rendering:null,renderingStartTime:0,last:w,tail:m,tailMode:S}:(A.isBackwards=d,A.rendering=null,A.renderingStartTime=0,A.last=w,A.tail=m,A.tailMode=S)}function KP(c,d,m){var w=d.pendingProps,S=w.revealOrder,A=w.tail;if(es(c,d,w.children,m),w=_r.current,(w&2)!==0)w=w&1|2,d.flags|=128;else{if(c!==null&&(c.flags&128)!==0)e:for(c=d.child;c!==null;){if(c.tag===13)c.memoizedState!==null&&HP(c,m,d);else if(c.tag===19)HP(c,m,d);else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===d)break e;for(;c.sibling===null;){if(c.return===null||c.return===d)break e;c=c.return}c.sibling.return=c.return,c=c.sibling}w&=1}if(er(_r,w),(d.mode&1)===0)d.memoizedState=null;else switch(S){case"forwards":for(m=d.child,S=null;m!==null;)c=m.alternate,c!==null&&uy(c)===null&&(S=m),m=m.sibling;m=S,m===null?(S=d.child,d.child=null):(S=m.sibling,m.sibling=null),qE(d,!1,S,m,A);break;case"backwards":for(m=null,S=d.child,d.child=null;S!==null;){if(c=S.alternate,c!==null&&uy(c)===null){d.child=S;break}c=S.sibling,S.sibling=m,m=S,S=c}qE(d,!0,m,null,A);break;case"together":qE(d,!1,null,null,void 0);break;default:d.memoizedState=null}return d.child}function _y(c,d){(d.mode&1)===0&&c!==null&&(c.alternate=null,d.alternate=null,d.flags|=2)}function pl(c,d,m){if(c!==null&&(d.dependencies=c.dependencies),Hu|=d.lanes,(m&d.childLanes)===0)return null;if(c!==null&&d.child!==c.child)throw Error(t(153));if(d.child!==null){for(c=d.child,m=vc(c,c.pendingProps),d.child=m,m.return=d;c.sibling!==null;)c=c.sibling,m=m.sibling=vc(c,c.pendingProps),m.return=d;m.sibling=null}return d.child}function JG(c,d,m){switch(d.tag){case 3:zP(d),$d();break;case 5:oP(d);break;case 1:fs(d.type)&&ey(d);break;case 4:RE(d,d.stateNode.containerInfo);break;case 10:var w=d.type._context,S=d.memoizedProps.value;er(ay,w._currentValue),w._currentValue=S;break;case 13:if(w=d.memoizedState,w!==null)return w.dehydrated!==null?(er(_r,_r.current&1),d.flags|=128,null):(m&d.child.childLanes)!==0?WP(c,d,m):(er(_r,_r.current&1),c=pl(c,d,m),c!==null?c.sibling:null);er(_r,_r.current&1);break;case 19:if(w=(m&d.childLanes)!==0,(c.flags&128)!==0){if(w)return KP(c,d,m);d.flags|=128}if(S=d.memoizedState,S!==null&&(S.rendering=null,S.tail=null,S.lastEffect=null),er(_r,_r.current),w)break;return null;case 22:case 23:return d.lanes=0,GP(c,d,m)}return pl(c,d,m)}var YP,XE,qP,XP;YP=function(c,d){for(var m=d.child;m!==null;){if(m.tag===5||m.tag===6)c.appendChild(m.stateNode);else if(m.tag!==4&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===d)break;for(;m.sibling===null;){if(m.return===null||m.return===d)return;m=m.return}m.sibling.return=m.return,m=m.sibling}},XE=function(){},qP=function(c,d,m,w){var S=c.memoizedProps;if(S!==w){c=d.stateNode,$u(bo.current);var A=null;switch(m){case"input":S=Bt(c,S),w=Bt(c,w),A=[];break;case"select":S=Ee({},S,{value:void 0}),w=Ee({},w,{value:void 0}),A=[];break;case"textarea":S=gt(c,S),w=gt(c,w),A=[];break;default:typeof S.onClick!="function"&&typeof w.onClick=="function"&&(c.onclick=Z1)}Ct(m,w);var G;m=null;for(be in S)if(!w.hasOwnProperty(be)&&S.hasOwnProperty(be)&&S[be]!=null)if(be==="style"){var re=S[be];for(G in re)re.hasOwnProperty(G)&&(m||(m={}),m[G]="")}else be!=="dangerouslySetInnerHTML"&&be!=="children"&&be!=="suppressContentEditableWarning"&&be!=="suppressHydrationWarning"&&be!=="autoFocus"&&(i.hasOwnProperty(be)?A||(A=[]):(A=A||[]).push(be,null));for(be in w){var ae=w[be];if(re=S?.[be],w.hasOwnProperty(be)&&ae!==re&&(ae!=null||re!=null))if(be==="style")if(re){for(G in re)!re.hasOwnProperty(G)||ae&&ae.hasOwnProperty(G)||(m||(m={}),m[G]="");for(G in ae)ae.hasOwnProperty(G)&&re[G]!==ae[G]&&(m||(m={}),m[G]=ae[G])}else m||(A||(A=[]),A.push(be,m)),m=ae;else be==="dangerouslySetInnerHTML"?(ae=ae?ae.__html:void 0,re=re?re.__html:void 0,ae!=null&&re!==ae&&(A=A||[]).push(be,ae)):be==="children"?typeof ae!="string"&&typeof ae!="number"||(A=A||[]).push(be,""+ae):be!=="suppressContentEditableWarning"&&be!=="suppressHydrationWarning"&&(i.hasOwnProperty(be)?(ae!=null&&be==="onScroll"&&ir("scroll",c),A||re===ae||(A=[])):(A=A||[]).push(be,ae))}m&&(A=A||[]).push("style",m);var be=A;(d.updateQueue=be)&&(d.flags|=4)}},XP=function(c,d,m,w){m!==w&&(d.flags|=4)};function Ig(c,d){if(!fr)switch(c.tailMode){case"hidden":d=c.tail;for(var m=null;d!==null;)d.alternate!==null&&(m=d),d=d.sibling;m===null?c.tail=null:m.sibling=null;break;case"collapsed":m=c.tail;for(var w=null;m!==null;)m.alternate!==null&&(w=m),m=m.sibling;w===null?d||c.tail===null?c.tail=null:c.tail.sibling=null:w.sibling=null}}function Fi(c){var d=c.alternate!==null&&c.alternate.child===c.child,m=0,w=0;if(d)for(var S=c.child;S!==null;)m|=S.lanes|S.childLanes,w|=S.subtreeFlags&14680064,w|=S.flags&14680064,S.return=c,S=S.sibling;else for(S=c.child;S!==null;)m|=S.lanes|S.childLanes,w|=S.subtreeFlags,w|=S.flags,S.return=c,S=S.sibling;return c.subtreeFlags|=w,c.childLanes=m,d}function eB(c,d,m){var w=d.pendingProps;switch(_E(d),d.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Fi(d),null;case 1:return fs(d.type)&&J1(),Fi(d),null;case 3:return w=d.stateNode,Yd(),sr(ds),sr(Oi),kE(),w.pendingContext&&(w.context=w.pendingContext,w.pendingContext=null),(c===null||c.child===null)&&(iy(d)?d.flags|=4:c===null||c.memoizedState.isDehydrated&&(d.flags&256)===0||(d.flags|=1024,Na!==null&&(o2(Na),Na=null))),XE(c,d),Fi(d),null;case 5:CE(d);var S=$u(wg.current);if(m=d.type,c!==null&&d.stateNode!=null)qP(c,d,m,w,S),c.ref!==d.ref&&(d.flags|=512,d.flags|=2097152);else{if(!w){if(d.stateNode===null)throw Error(t(166));return Fi(d),null}if(c=$u(bo.current),iy(d)){w=d.stateNode,m=d.type;var A=d.memoizedProps;switch(w[To]=d,w[pg]=A,c=(d.mode&1)!==0,m){case"dialog":ir("cancel",w),ir("close",w);break;case"iframe":case"object":case"embed":ir("load",w);break;case"video":case"audio":for(S=0;S<fg.length;S++)ir(fg[S],w);break;case"source":ir("error",w);break;case"img":case"image":case"link":ir("error",w),ir("load",w);break;case"details":ir("toggle",w);break;case"input":Fn(w,A),ir("invalid",w);break;case"select":w._wrapperState={wasMultiple:!!A.multiple},ir("invalid",w);break;case"textarea":jt(w,A),ir("invalid",w)}Ct(m,A),S=null;for(var G in A)if(A.hasOwnProperty(G)){var re=A[G];G==="children"?typeof re=="string"?w.textContent!==re&&(A.suppressHydrationWarning!==!0&&X1(w.textContent,re,c),S=["children",re]):typeof re=="number"&&w.textContent!==""+re&&(A.suppressHydrationWarning!==!0&&X1(w.textContent,re,c),S=["children",""+re]):i.hasOwnProperty(G)&&re!=null&&G==="onScroll"&&ir("scroll",w)}switch(m){case"input":Gt(w),Xn(w,A,!0);break;case"textarea":Gt(w),yt(w);break;case"select":case"option":break;default:typeof A.onClick=="function"&&(w.onclick=Z1)}w=S,d.updateQueue=w,w!==null&&(d.flags|=4)}else{G=S.nodeType===9?S:S.ownerDocument,c==="http://www.w3.org/1999/xhtml"&&(c=Jt(m)),c==="http://www.w3.org/1999/xhtml"?m==="script"?(c=G.createElement("div"),c.innerHTML="<script><\/script>",c=c.removeChild(c.firstChild)):typeof w.is=="string"?c=G.createElement(m,{is:w.is}):(c=G.createElement(m),m==="select"&&(G=c,w.multiple?G.multiple=!0:w.size&&(G.size=w.size))):c=G.createElementNS(c,m),c[To]=d,c[pg]=w,YP(c,d,!1,!1),d.stateNode=c;e:{switch(G=N(m,w),m){case"dialog":ir("cancel",c),ir("close",c),S=w;break;case"iframe":case"object":case"embed":ir("load",c),S=w;break;case"video":case"audio":for(S=0;S<fg.length;S++)ir(fg[S],c);S=w;break;case"source":ir("error",c),S=w;break;case"img":case"image":case"link":ir("error",c),ir("load",c),S=w;break;case"details":ir("toggle",c),S=w;break;case"input":Fn(c,w),S=Bt(c,w),ir("invalid",c);break;case"option":S=w;break;case"select":c._wrapperState={wasMultiple:!!w.multiple},S=Ee({},w,{value:void 0}),ir("invalid",c);break;case"textarea":jt(c,w),S=gt(c,w),ir("invalid",c);break;default:S=w}Ct(m,S),re=S;for(A in re)if(re.hasOwnProperty(A)){var ae=re[A];A==="style"?ve(c,ae):A==="dangerouslySetInnerHTML"?(ae=ae?ae.__html:void 0,ae!=null&&si(c,ae)):A==="children"?typeof ae=="string"?(m!=="textarea"||ae!=="")&&Vr(c,ae):typeof ae=="number"&&Vr(c,""+ae):A!=="suppressContentEditableWarning"&&A!=="suppressHydrationWarning"&&A!=="autoFocus"&&(i.hasOwnProperty(A)?ae!=null&&A==="onScroll"&&ir("scroll",c):ae!=null&&I(c,A,ae,G))}switch(m){case"input":Gt(c),Xn(c,w,!1);break;case"textarea":Gt(c),yt(c);break;case"option":w.value!=null&&c.setAttribute("value",""+je(w.value));break;case"select":c.multiple=!!w.multiple,A=w.value,A!=null?Zn(c,!!w.multiple,A,!1):w.defaultValue!=null&&Zn(c,!!w.multiple,w.defaultValue,!0);break;default:typeof S.onClick=="function"&&(c.onclick=Z1)}switch(m){case"button":case"input":case"select":case"textarea":w=!!w.autoFocus;break e;case"img":w=!0;break e;default:w=!1}}w&&(d.flags|=4)}d.ref!==null&&(d.flags|=512,d.flags|=2097152)}return Fi(d),null;case 6:if(c&&d.stateNode!=null)XP(c,d,c.memoizedProps,w);else{if(typeof w!="string"&&d.stateNode===null)throw Error(t(166));if(m=$u(wg.current),$u(bo.current),iy(d)){if(w=d.stateNode,m=d.memoizedProps,w[To]=d,(A=w.nodeValue!==m)&&(c=js,c!==null))switch(c.tag){case 3:X1(w.nodeValue,m,(c.mode&1)!==0);break;case 5:c.memoizedProps.suppressHydrationWarning!==!0&&X1(w.nodeValue,m,(c.mode&1)!==0)}A&&(d.flags|=4)}else w=(m.nodeType===9?m:m.ownerDocument).createTextNode(w),w[To]=d,d.stateNode=w}return Fi(d),null;case 13:if(sr(_r),w=d.memoizedState,c===null||c.memoizedState!==null&&c.memoizedState.dehydrated!==null){if(fr&&Vs!==null&&(d.mode&1)!==0&&(d.flags&128)===0)JC(),$d(),d.flags|=98560,A=!1;else if(A=iy(d),w!==null&&w.dehydrated!==null){if(c===null){if(!A)throw Error(t(318));if(A=d.memoizedState,A=A!==null?A.dehydrated:null,!A)throw Error(t(317));A[To]=d}else $d(),(d.flags&128)===0&&(d.memoizedState=null),d.flags|=4;Fi(d),A=!1}else Na!==null&&(o2(Na),Na=null),A=!0;if(!A)return d.flags&65536?d:null}return(d.flags&128)!==0?(d.lanes=m,d):(w=w!==null,w!==(c!==null&&c.memoizedState!==null)&&w&&(d.child.flags|=8192,(d.mode&1)!==0&&(c===null||(_r.current&1)!==0?Zr===0&&(Zr=3):u2())),d.updateQueue!==null&&(d.flags|=4),Fi(d),null);case 4:return Yd(),XE(c,d),c===null&&gg(d.stateNode.containerInfo),Fi(d),null;case 10:return TE(d.type._context),Fi(d),null;case 17:return fs(d.type)&&J1(),Fi(d),null;case 19:if(sr(_r),A=d.memoizedState,A===null)return Fi(d),null;if(w=(d.flags&128)!==0,G=A.rendering,G===null)if(w)Ig(A,!1);else{if(Zr!==0||c!==null&&(c.flags&128)!==0)for(c=d.child;c!==null;){if(G=uy(c),G!==null){for(d.flags|=128,Ig(A,!1),w=G.updateQueue,w!==null&&(d.updateQueue=w,d.flags|=4),d.subtreeFlags=0,w=m,m=d.child;m!==null;)A=m,c=w,A.flags&=14680066,G=A.alternate,G===null?(A.childLanes=0,A.lanes=c,A.child=null,A.subtreeFlags=0,A.memoizedProps=null,A.memoizedState=null,A.updateQueue=null,A.dependencies=null,A.stateNode=null):(A.childLanes=G.childLanes,A.lanes=G.lanes,A.child=G.child,A.subtreeFlags=0,A.deletions=null,A.memoizedProps=G.memoizedProps,A.memoizedState=G.memoizedState,A.updateQueue=G.updateQueue,A.type=G.type,c=G.dependencies,A.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),m=m.sibling;return er(_r,_r.current&1|2),d.child}c=c.sibling}A.tail!==null&&qe()>Qd&&(d.flags|=128,w=!0,Ig(A,!1),d.lanes=4194304)}else{if(!w)if(c=uy(G),c!==null){if(d.flags|=128,w=!0,m=c.updateQueue,m!==null&&(d.updateQueue=m,d.flags|=4),Ig(A,!0),A.tail===null&&A.tailMode==="hidden"&&!G.alternate&&!fr)return Fi(d),null}else 2*qe()-A.renderingStartTime>Qd&&m!==1073741824&&(d.flags|=128,w=!0,Ig(A,!1),d.lanes=4194304);A.isBackwards?(G.sibling=d.child,d.child=G):(m=A.last,m!==null?m.sibling=G:d.child=G,A.last=G)}return A.tail!==null?(d=A.tail,A.rendering=d,A.tail=d.sibling,A.renderingStartTime=qe(),d.sibling=null,m=_r.current,er(_r,w?m&1|2:m&1),d):(Fi(d),null);case 22:case 23:return c2(),w=d.memoizedState!==null,c!==null&&c.memoizedState!==null!==w&&(d.flags|=8192),w&&(d.mode&1)!==0?(Gs&1073741824)!==0&&(Fi(d),d.subtreeFlags&6&&(d.flags|=8192)):Fi(d),null;case 24:return null;case 25:return null}throw Error(t(156,d.tag))}function tB(c,d){switch(_E(d),d.tag){case 1:return fs(d.type)&&J1(),c=d.flags,c&65536?(d.flags=c&-65537|128,d):null;case 3:return Yd(),sr(ds),sr(Oi),kE(),c=d.flags,(c&65536)!==0&&(c&128)===0?(d.flags=c&-65537|128,d):null;case 5:return CE(d),null;case 13:if(sr(_r),c=d.memoizedState,c!==null&&c.dehydrated!==null){if(d.alternate===null)throw Error(t(340));$d()}return c=d.flags,c&65536?(d.flags=c&-65537|128,d):null;case 19:return sr(_r),null;case 4:return Yd(),null;case 10:return TE(d.type._context),null;case 22:case 23:return c2(),null;case 24:return null;default:return null}}var xy=!1,ji=!1,nB=typeof WeakSet=="function"?WeakSet:Set,xt=null;function Xd(c,d){var m=c.ref;if(m!==null)if(typeof m=="function")try{m(null)}catch(w){Sr(c,d,w)}else m.current=null}function ZE(c,d,m){try{m()}catch(w){Sr(c,d,w)}}var ZP=!1;function rB(c,d){if(cE=ol,c=CC(),tE(c)){if("selectionStart"in c)var m={start:c.selectionStart,end:c.selectionEnd};else e:{m=(m=c.ownerDocument)&&m.defaultView||window;var w=m.getSelection&&m.getSelection();if(w&&w.rangeCount!==0){m=w.anchorNode;var S=w.anchorOffset,A=w.focusNode;w=w.focusOffset;try{m.nodeType,A.nodeType}catch{m=null;break e}var G=0,re=-1,ae=-1,be=0,He=0,Xe=c,Ue=null;t:for(;;){for(var pt;Xe!==m||S!==0&&Xe.nodeType!==3||(re=G+S),Xe!==A||w!==0&&Xe.nodeType!==3||(ae=G+w),Xe.nodeType===3&&(G+=Xe.nodeValue.length),(pt=Xe.firstChild)!==null;)Ue=Xe,Xe=pt;for(;;){if(Xe===c)break t;if(Ue===m&&++be===S&&(re=G),Ue===A&&++He===w&&(ae=G),(pt=Xe.nextSibling)!==null)break;Xe=Ue,Ue=Xe.parentNode}Xe=pt}m=re===-1||ae===-1?null:{start:re,end:ae}}else m=null}m=m||{start:0,end:0}}else m=null;for(uE={focusedElem:c,selectionRange:m},ol=!1,xt=d;xt!==null;)if(d=xt,c=d.child,(d.subtreeFlags&1028)!==0&&c!==null)c.return=d,xt=c;else for(;xt!==null;){d=xt;try{var wt=d.alternate;if((d.flags&1024)!==0)switch(d.tag){case 0:case 11:case 15:break;case 1:if(wt!==null){var Tt=wt.memoizedProps,Mr=wt.memoizedState,fe=d.stateNode,oe=fe.getSnapshotBeforeUpdate(d.elementType===d.type?Tt:La(d.type,Tt),Mr);fe.__reactInternalSnapshotBeforeUpdate=oe}break;case 3:var _e=d.stateNode.containerInfo;_e.nodeType===1?_e.textContent="":_e.nodeType===9&&_e.documentElement&&_e.removeChild(_e.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Je){Sr(d,d.return,Je)}if(c=d.sibling,c!==null){c.return=d.return,xt=c;break}xt=d.return}return wt=ZP,ZP=!1,wt}function Ag(c,d,m){var w=d.updateQueue;if(w=w!==null?w.lastEffect:null,w!==null){var S=w=w.next;do{if((S.tag&c)===c){var A=S.destroy;S.destroy=void 0,A!==void 0&&ZE(d,m,A)}S=S.next}while(S!==w)}}function vy(c,d){if(d=d.updateQueue,d=d!==null?d.lastEffect:null,d!==null){var m=d=d.next;do{if((m.tag&c)===c){var w=m.create;m.destroy=w()}m=m.next}while(m!==d)}}function QE(c){var d=c.ref;if(d!==null){var m=c.stateNode;switch(c.tag){case 5:c=m;break;default:c=m}typeof d=="function"?d(c):d.current=c}}function QP(c){var d=c.alternate;d!==null&&(c.alternate=null,QP(d)),c.child=null,c.deletions=null,c.sibling=null,c.tag===5&&(d=c.stateNode,d!==null&&(delete d[To],delete d[pg],delete d[gE],delete d[VG],delete d[GG])),c.stateNode=null,c.return=null,c.dependencies=null,c.memoizedProps=null,c.memoizedState=null,c.pendingProps=null,c.stateNode=null,c.updateQueue=null}function JP(c){return c.tag===5||c.tag===3||c.tag===4}function ek(c){e:for(;;){for(;c.sibling===null;){if(c.return===null||JP(c.return))return null;c=c.return}for(c.sibling.return=c.return,c=c.sibling;c.tag!==5&&c.tag!==6&&c.tag!==18;){if(c.flags&2||c.child===null||c.tag===4)continue e;c.child.return=c,c=c.child}if(!(c.flags&2))return c.stateNode}}function JE(c,d,m){var w=c.tag;if(w===5||w===6)c=c.stateNode,d?m.nodeType===8?m.parentNode.insertBefore(c,d):m.insertBefore(c,d):(m.nodeType===8?(d=m.parentNode,d.insertBefore(c,m)):(d=m,d.appendChild(c)),m=m._reactRootContainer,m!=null||d.onclick!==null||(d.onclick=Z1));else if(w!==4&&(c=c.child,c!==null))for(JE(c,d,m),c=c.sibling;c!==null;)JE(c,d,m),c=c.sibling}function e2(c,d,m){var w=c.tag;if(w===5||w===6)c=c.stateNode,d?m.insertBefore(c,d):m.appendChild(c);else if(w!==4&&(c=c.child,c!==null))for(e2(c,d,m),c=c.sibling;c!==null;)e2(c,d,m),c=c.sibling}var xi=null,Oa=!1;function mc(c,d,m){for(m=m.child;m!==null;)tk(c,d,m),m=m.sibling}function tk(c,d,m){if(Pr&&typeof Pr.onCommitFiberUnmount=="function")try{Pr.onCommitFiberUnmount(Ns,m)}catch{}switch(m.tag){case 5:ji||Xd(m,d);case 6:var w=xi,S=Oa;xi=null,mc(c,d,m),xi=w,Oa=S,xi!==null&&(Oa?(c=xi,m=m.stateNode,c.nodeType===8?c.parentNode.removeChild(m):c.removeChild(m)):xi.removeChild(m.stateNode));break;case 18:xi!==null&&(Oa?(c=xi,m=m.stateNode,c.nodeType===8?fE(c.parentNode,m):c.nodeType===1&&fE(c,m),sc(c)):fE(xi,m.stateNode));break;case 4:w=xi,S=Oa,xi=m.stateNode.containerInfo,Oa=!0,mc(c,d,m),xi=w,Oa=S;break;case 0:case 11:case 14:case 15:if(!ji&&(w=m.updateQueue,w!==null&&(w=w.lastEffect,w!==null))){S=w=w.next;do{var A=S,G=A.destroy;A=A.tag,G!==void 0&&((A&2)!==0||(A&4)!==0)&&ZE(m,d,G),S=S.next}while(S!==w)}mc(c,d,m);break;case 1:if(!ji&&(Xd(m,d),w=m.stateNode,typeof w.componentWillUnmount=="function"))try{w.props=m.memoizedProps,w.state=m.memoizedState,w.componentWillUnmount()}catch(re){Sr(m,d,re)}mc(c,d,m);break;case 21:mc(c,d,m);break;case 22:m.mode&1?(ji=(w=ji)||m.memoizedState!==null,mc(c,d,m),ji=w):mc(c,d,m);break;default:mc(c,d,m)}}function nk(c){var d=c.updateQueue;if(d!==null){c.updateQueue=null;var m=c.stateNode;m===null&&(m=c.stateNode=new nB),d.forEach(function(w){var S=dB.bind(null,c,w);m.has(w)||(m.add(w),w.then(S,S))})}}function Da(c,d){var m=d.deletions;if(m!==null)for(var w=0;w<m.length;w++){var S=m[w];try{var A=c,G=d,re=G;e:for(;re!==null;){switch(re.tag){case 5:xi=re.stateNode,Oa=!1;break e;case 3:xi=re.stateNode.containerInfo,Oa=!0;break e;case 4:xi=re.stateNode.containerInfo,Oa=!0;break e}re=re.return}if(xi===null)throw Error(t(160));tk(A,G,S),xi=null,Oa=!1;var ae=S.alternate;ae!==null&&(ae.return=null),S.return=null}catch(be){Sr(S,d,be)}}if(d.subtreeFlags&12854)for(d=d.child;d!==null;)rk(d,c),d=d.sibling}function rk(c,d){var m=c.alternate,w=c.flags;switch(c.tag){case 0:case 11:case 14:case 15:if(Da(d,c),Ao(c),w&4){try{Ag(3,c,c.return),vy(3,c)}catch(Tt){Sr(c,c.return,Tt)}try{Ag(5,c,c.return)}catch(Tt){Sr(c,c.return,Tt)}}break;case 1:Da(d,c),Ao(c),w&512&&m!==null&&Xd(m,m.return);break;case 5:if(Da(d,c),Ao(c),w&512&&m!==null&&Xd(m,m.return),c.flags&32){var S=c.stateNode;try{Vr(S,"")}catch(Tt){Sr(c,c.return,Tt)}}if(w&4&&(S=c.stateNode,S!=null)){var A=c.memoizedProps,G=m!==null?m.memoizedProps:A,re=c.type,ae=c.updateQueue;if(c.updateQueue=null,ae!==null)try{re==="input"&&A.type==="radio"&&A.name!=null&&Qt(S,A),N(re,G);var be=N(re,A);for(G=0;G<ae.length;G+=2){var He=ae[G],Xe=ae[G+1];He==="style"?ve(S,Xe):He==="dangerouslySetInnerHTML"?si(S,Xe):He==="children"?Vr(S,Xe):I(S,He,Xe,be)}switch(re){case"input":ot(S,A);break;case"textarea":kn(S,A);break;case"select":var Ue=S._wrapperState.wasMultiple;S._wrapperState.wasMultiple=!!A.multiple;var pt=A.value;pt!=null?Zn(S,!!A.multiple,pt,!1):Ue!==!!A.multiple&&(A.defaultValue!=null?Zn(S,!!A.multiple,A.defaultValue,!0):Zn(S,!!A.multiple,A.multiple?[]:"",!1))}S[pg]=A}catch(Tt){Sr(c,c.return,Tt)}}break;case 6:if(Da(d,c),Ao(c),w&4){if(c.stateNode===null)throw Error(t(162));S=c.stateNode,A=c.memoizedProps;try{S.nodeValue=A}catch(Tt){Sr(c,c.return,Tt)}}break;case 3:if(Da(d,c),Ao(c),w&4&&m!==null&&m.memoizedState.isDehydrated)try{sc(d.containerInfo)}catch(Tt){Sr(c,c.return,Tt)}break;case 4:Da(d,c),Ao(c);break;case 13:Da(d,c),Ao(c),S=c.child,S.flags&8192&&(A=S.memoizedState!==null,S.stateNode.isHidden=A,!A||S.alternate!==null&&S.alternate.memoizedState!==null||(r2=qe())),w&4&&nk(c);break;case 22:if(He=m!==null&&m.memoizedState!==null,c.mode&1?(ji=(be=ji)||He,Da(d,c),ji=be):Da(d,c),Ao(c),w&8192){if(be=c.memoizedState!==null,(c.stateNode.isHidden=be)&&!He&&(c.mode&1)!==0)for(xt=c,He=c.child;He!==null;){for(Xe=xt=He;xt!==null;){switch(Ue=xt,pt=Ue.child,Ue.tag){case 0:case 11:case 14:case 15:Ag(4,Ue,Ue.return);break;case 1:Xd(Ue,Ue.return);var wt=Ue.stateNode;if(typeof wt.componentWillUnmount=="function"){w=Ue,m=Ue.return;try{d=w,wt.props=d.memoizedProps,wt.state=d.memoizedState,wt.componentWillUnmount()}catch(Tt){Sr(w,m,Tt)}}break;case 5:Xd(Ue,Ue.return);break;case 22:if(Ue.memoizedState!==null){ak(Xe);continue}}pt!==null?(pt.return=Ue,xt=pt):ak(Xe)}He=He.sibling}e:for(He=null,Xe=c;;){if(Xe.tag===5){if(He===null){He=Xe;try{S=Xe.stateNode,be?(A=S.style,typeof A.setProperty=="function"?A.setProperty("display","none","important"):A.display="none"):(re=Xe.stateNode,ae=Xe.memoizedProps.style,G=ae!=null&&ae.hasOwnProperty("display")?ae.display:null,re.style.display=Oe("display",G))}catch(Tt){Sr(c,c.return,Tt)}}}else if(Xe.tag===6){if(He===null)try{Xe.stateNode.nodeValue=be?"":Xe.memoizedProps}catch(Tt){Sr(c,c.return,Tt)}}else if((Xe.tag!==22&&Xe.tag!==23||Xe.memoizedState===null||Xe===c)&&Xe.child!==null){Xe.child.return=Xe,Xe=Xe.child;continue}if(Xe===c)break e;for(;Xe.sibling===null;){if(Xe.return===null||Xe.return===c)break e;He===Xe&&(He=null),Xe=Xe.return}He===Xe&&(He=null),Xe.sibling.return=Xe.return,Xe=Xe.sibling}}break;case 19:Da(d,c),Ao(c),w&4&&nk(c);break;case 21:break;default:Da(d,c),Ao(c)}}function Ao(c){var d=c.flags;if(d&2){try{e:{for(var m=c.return;m!==null;){if(JP(m)){var w=m;break e}m=m.return}throw Error(t(160))}switch(w.tag){case 5:var S=w.stateNode;w.flags&32&&(Vr(S,""),w.flags&=-33);var A=ek(c);e2(c,A,S);break;case 3:case 4:var G=w.stateNode.containerInfo,re=ek(c);JE(c,re,G);break;default:throw Error(t(161))}}catch(ae){Sr(c,c.return,ae)}c.flags&=-3}d&4096&&(c.flags&=-4097)}function iB(c,d,m){xt=c,ik(c)}function ik(c,d,m){for(var w=(c.mode&1)!==0;xt!==null;){var S=xt,A=S.child;if(S.tag===22&&w){var G=S.memoizedState!==null||xy;if(!G){var re=S.alternate,ae=re!==null&&re.memoizedState!==null||ji;re=xy;var be=ji;if(xy=G,(ji=ae)&&!be)for(xt=S;xt!==null;)G=xt,ae=G.child,G.tag===22&&G.memoizedState!==null?ok(S):ae!==null?(ae.return=G,xt=ae):ok(S);for(;A!==null;)xt=A,ik(A),A=A.sibling;xt=S,xy=re,ji=be}sk(c)}else(S.subtreeFlags&8772)!==0&&A!==null?(A.return=S,xt=A):sk(c)}}function sk(c){for(;xt!==null;){var d=xt;if((d.flags&8772)!==0){var m=d.alternate;try{if((d.flags&8772)!==0)switch(d.tag){case 0:case 11:case 15:ji||vy(5,d);break;case 1:var w=d.stateNode;if(d.flags&4&&!ji)if(m===null)w.componentDidMount();else{var S=d.elementType===d.type?m.memoizedProps:La(d.type,m.memoizedProps);w.componentDidUpdate(S,m.memoizedState,w.__reactInternalSnapshotBeforeUpdate)}var A=d.updateQueue;A!==null&&aP(d,A,w);break;case 3:var G=d.updateQueue;if(G!==null){if(m=null,d.child!==null)switch(d.child.tag){case 5:m=d.child.stateNode;break;case 1:m=d.child.stateNode}aP(d,G,m)}break;case 5:var re=d.stateNode;if(m===null&&d.flags&4){m=re;var ae=d.memoizedProps;switch(d.type){case"button":case"input":case"select":case"textarea":ae.autoFocus&&m.focus();break;case"img":ae.src&&(m.src=ae.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(d.memoizedState===null){var be=d.alternate;if(be!==null){var He=be.memoizedState;if(He!==null){var Xe=He.dehydrated;Xe!==null&&sc(Xe)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}ji||d.flags&512&&QE(d)}catch(Ue){Sr(d,d.return,Ue)}}if(d===c){xt=null;break}if(m=d.sibling,m!==null){m.return=d.return,xt=m;break}xt=d.return}}function ak(c){for(;xt!==null;){var d=xt;if(d===c){xt=null;break}var m=d.sibling;if(m!==null){m.return=d.return,xt=m;break}xt=d.return}}function ok(c){for(;xt!==null;){var d=xt;try{switch(d.tag){case 0:case 11:case 15:var m=d.return;try{vy(4,d)}catch(ae){Sr(d,m,ae)}break;case 1:var w=d.stateNode;if(typeof w.componentDidMount=="function"){var S=d.return;try{w.componentDidMount()}catch(ae){Sr(d,S,ae)}}var A=d.return;try{QE(d)}catch(ae){Sr(d,A,ae)}break;case 5:var G=d.return;try{QE(d)}catch(ae){Sr(d,G,ae)}}}catch(ae){Sr(d,d.return,ae)}if(d===c){xt=null;break}var re=d.sibling;if(re!==null){re.return=d.return,xt=re;break}xt=d.return}}var sB=Math.ceil,wy=M.ReactCurrentDispatcher,t2=M.ReactCurrentOwner,ua=M.ReactCurrentBatchConfig,_n=0,oi=null,Br=null,vi=0,Gs=0,Zd=uc(0),Zr=0,Rg=null,Hu=0,Ey=0,n2=0,Cg=null,ms=null,r2=0,Qd=1/0,yl=null,Sy=!1,i2=null,pc=null,Ty=!1,yc=null,by=0,Pg=0,s2=null,Iy=-1,Ay=0;function ts(){return(_n&6)!==0?qe():Iy!==-1?Iy:Iy=qe()}function _c(c){return(c.mode&1)===0?1:(_n&2)!==0&&vi!==0?vi&-vi:UG.transition!==null?(Ay===0&&(Ay=Z0()),Ay):(c=gn,c!==0||(c=window.event,c=c===void 0?16:Ad(c.type)),c)}function Fa(c,d,m,w){if(50<Pg)throw Pg=0,s2=null,Error(t(185));Lu(c,m,w),((_n&2)===0||c!==oi)&&(c===oi&&((_n&2)===0&&(Ey|=m),Zr===4&&xc(c,vi)),ps(c,w),m===1&&_n===0&&(d.mode&1)===0&&(Qd=qe()+500,ty&&dc()))}function ps(c,d){var m=c.callbackNode;Nu(c,d);var w=il(c,c===oi?vi:0);if(w===0)m!==null&&tt(m),c.callbackNode=null,c.callbackPriority=0;else if(d=w&-w,c.callbackPriority!==d){if(m!=null&&tt(m),d===1)c.tag===0?BG(ck.bind(null,c)):YC(ck.bind(null,c)),FG(function(){(_n&6)===0&&dc()}),m=null;else{switch(go(w)){case 1:m=Mn;break;case 4:m=jn;break;case 16:m=dr;break;case 536870912:m=ia;break;default:m=dr}m=yk(m,lk.bind(null,c))}c.callbackPriority=d,c.callbackNode=m}}function lk(c,d){if(Iy=-1,Ay=0,(_n&6)!==0)throw Error(t(327));var m=c.callbackNode;if(Jd()&&c.callbackNode!==m)return null;var w=il(c,c===oi?vi:0);if(w===0)return null;if((w&30)!==0||(w&c.expiredLanes)!==0||d)d=Ry(c,w);else{d=w;var S=_n;_n|=2;var A=hk();(oi!==c||vi!==d)&&(yl=null,Qd=qe()+500,Yu(c,d));do try{lB();break}catch(re){uk(c,re)}while(!0);SE(),wy.current=A,_n=S,Br!==null?d=0:(oi=null,vi=0,d=Zr)}if(d!==0){if(d===2&&(S=X0(c),S!==0&&(w=S,d=a2(c,S))),d===1)throw m=Rg,Yu(c,0),xc(c,w),ps(c,qe()),m;if(d===6)xc(c,w);else{if(S=c.current.alternate,(w&30)===0&&!aB(S)&&(d=Ry(c,w),d===2&&(A=X0(c),A!==0&&(w=A,d=a2(c,A))),d===1))throw m=Rg,Yu(c,0),xc(c,w),ps(c,qe()),m;switch(c.finishedWork=S,c.finishedLanes=w,d){case 0:case 1:throw Error(t(345));case 2:qu(c,ms,yl);break;case 3:if(xc(c,w),(w&130023424)===w&&(d=r2+500-qe(),10<d)){if(il(c,0)!==0)break;if(S=c.suspendedLanes,(S&w)!==w){ts(),c.pingedLanes|=c.suspendedLanes&S;break}c.timeoutHandle=dE(qu.bind(null,c,ms,yl),d);break}qu(c,ms,yl);break;case 4:if(xc(c,w),(w&4194240)===w)break;for(d=c.eventTimes,S=-1;0<w;){var G=31-yr(w);A=1<<G,G=d[G],G>S&&(S=G),w&=~A}if(w=S,w=qe()-w,w=(120>w?120:480>w?480:1080>w?1080:1920>w?1920:3e3>w?3e3:4320>w?4320:1960*sB(w/1960))-w,10<w){c.timeoutHandle=dE(qu.bind(null,c,ms,yl),w);break}qu(c,ms,yl);break;case 5:qu(c,ms,yl);break;default:throw Error(t(329))}}}return ps(c,qe()),c.callbackNode===m?lk.bind(null,c):null}function a2(c,d){var m=Cg;return c.current.memoizedState.isDehydrated&&(Yu(c,d).flags|=256),c=Ry(c,d),c!==2&&(d=ms,ms=m,d!==null&&o2(d)),c}function o2(c){ms===null?ms=c:ms.push.apply(ms,c)}function aB(c){for(var d=c;;){if(d.flags&16384){var m=d.updateQueue;if(m!==null&&(m=m.stores,m!==null))for(var w=0;w<m.length;w++){var S=m[w],A=S.getSnapshot;S=S.value;try{if(!Ma(A(),S))return!1}catch{return!1}}}if(m=d.child,d.subtreeFlags&16384&&m!==null)m.return=d,d=m;else{if(d===c)break;for(;d.sibling===null;){if(d.return===null||d.return===c)return!0;d=d.return}d.sibling.return=d.return,d=d.sibling}}return!0}function xc(c,d){for(d&=~n2,d&=~Ey,c.suspendedLanes|=d,c.pingedLanes&=~d,c=c.expirationTimes;0<d;){var m=31-yr(d),w=1<<m;c[m]=-1,d&=~w}}function ck(c){if((_n&6)!==0)throw Error(t(327));Jd();var d=il(c,0);if((d&1)===0)return ps(c,qe()),null;var m=Ry(c,d);if(c.tag!==0&&m===2){var w=X0(c);w!==0&&(d=w,m=a2(c,w))}if(m===1)throw m=Rg,Yu(c,0),xc(c,d),ps(c,qe()),m;if(m===6)throw Error(t(345));return c.finishedWork=c.current.alternate,c.finishedLanes=d,qu(c,ms,yl),ps(c,qe()),null}function l2(c,d){var m=_n;_n|=1;try{return c(d)}finally{_n=m,_n===0&&(Qd=qe()+500,ty&&dc())}}function Ku(c){yc!==null&&yc.tag===0&&(_n&6)===0&&Jd();var d=_n;_n|=1;var m=ua.transition,w=gn;try{if(ua.transition=null,gn=1,c)return c()}finally{gn=w,ua.transition=m,_n=d,(_n&6)===0&&dc()}}function c2(){Gs=Zd.current,sr(Zd)}function Yu(c,d){c.finishedWork=null,c.finishedLanes=0;var m=c.timeoutHandle;if(m!==-1&&(c.timeoutHandle=-1,DG(m)),Br!==null)for(m=Br.return;m!==null;){var w=m;switch(_E(w),w.tag){case 1:w=w.type.childContextTypes,w!=null&&J1();break;case 3:Yd(),sr(ds),sr(Oi),kE();break;case 5:CE(w);break;case 4:Yd();break;case 13:sr(_r);break;case 19:sr(_r);break;case 10:TE(w.type._context);break;case 22:case 23:c2()}m=m.return}if(oi=c,Br=c=vc(c.current,null),vi=Gs=d,Zr=0,Rg=null,n2=Ey=Hu=0,ms=Cg=null,zu!==null){for(d=0;d<zu.length;d++)if(m=zu[d],w=m.interleaved,w!==null){m.interleaved=null;var S=w.next,A=m.pending;if(A!==null){var G=A.next;A.next=S,w.next=G}m.pending=w}zu=null}return c}function uk(c,d){do{var m=Br;try{if(SE(),hy.current=my,dy){for(var w=xr.memoizedState;w!==null;){var S=w.queue;S!==null&&(S.pending=null),w=w.next}dy=!1}if(Wu=0,ai=Xr=xr=null,Eg=!1,Sg=0,t2.current=null,m===null||m.return===null){Zr=1,Rg=d,Br=null;break}e:{var A=c,G=m.return,re=m,ae=d;if(d=vi,re.flags|=32768,ae!==null&&typeof ae=="object"&&typeof ae.then=="function"){var be=ae,He=re,Xe=He.tag;if((He.mode&1)===0&&(Xe===0||Xe===11||Xe===15)){var Ue=He.alternate;Ue?(He.updateQueue=Ue.updateQueue,He.memoizedState=Ue.memoizedState,He.lanes=Ue.lanes):(He.updateQueue=null,He.memoizedState=null)}var pt=OP(G);if(pt!==null){pt.flags&=-257,DP(pt,G,re,A,d),pt.mode&1&&LP(A,be,d),d=pt,ae=be;var wt=d.updateQueue;if(wt===null){var Tt=new Set;Tt.add(ae),d.updateQueue=Tt}else wt.add(ae);break e}else{if((d&1)===0){LP(A,be,d),u2();break e}ae=Error(t(426))}}else if(fr&&re.mode&1){var Mr=OP(G);if(Mr!==null){(Mr.flags&65536)===0&&(Mr.flags|=256),DP(Mr,G,re,A,d),wE(qd(ae,re));break e}}A=ae=qd(ae,re),Zr!==4&&(Zr=2),Cg===null?Cg=[A]:Cg.push(A),A=G;do{switch(A.tag){case 3:A.flags|=65536,d&=-d,A.lanes|=d;var fe=MP(A,ae,d);sP(A,fe);break e;case 1:re=ae;var oe=A.type,_e=A.stateNode;if((A.flags&128)===0&&(typeof oe.getDerivedStateFromError=="function"||_e!==null&&typeof _e.componentDidCatch=="function"&&(pc===null||!pc.has(_e)))){A.flags|=65536,d&=-d,A.lanes|=d;var Je=NP(A,re,d);sP(A,Je);break e}}A=A.return}while(A!==null)}fk(m)}catch(It){d=It,Br===m&&m!==null&&(Br=m=m.return);continue}break}while(!0)}function hk(){var c=wy.current;return wy.current=my,c===null?my:c}function u2(){(Zr===0||Zr===3||Zr===2)&&(Zr=4),oi===null||(Hu&268435455)===0&&(Ey&268435455)===0||xc(oi,vi)}function Ry(c,d){var m=_n;_n|=2;var w=hk();(oi!==c||vi!==d)&&(yl=null,Yu(c,d));do try{oB();break}catch(S){uk(c,S)}while(!0);if(SE(),_n=m,wy.current=w,Br!==null)throw Error(t(261));return oi=null,vi=0,Zr}function oB(){for(;Br!==null;)dk(Br)}function lB(){for(;Br!==null&&!ft();)dk(Br)}function dk(c){var d=pk(c.alternate,c,Gs);c.memoizedProps=c.pendingProps,d===null?fk(c):Br=d,t2.current=null}function fk(c){var d=c;do{var m=d.alternate;if(c=d.return,(d.flags&32768)===0){if(m=eB(m,d,Gs),m!==null){Br=m;return}}else{if(m=tB(m,d),m!==null){m.flags&=32767,Br=m;return}if(c!==null)c.flags|=32768,c.subtreeFlags=0,c.deletions=null;else{Zr=6,Br=null;return}}if(d=d.sibling,d!==null){Br=d;return}Br=d=c}while(d!==null);Zr===0&&(Zr=5)}function qu(c,d,m){var w=gn,S=ua.transition;try{ua.transition=null,gn=1,cB(c,d,m,w)}finally{ua.transition=S,gn=w}return null}function cB(c,d,m,w){do Jd();while(yc!==null);if((_n&6)!==0)throw Error(t(327));m=c.finishedWork;var S=c.finishedLanes;if(m===null)return null;if(c.finishedWork=null,c.finishedLanes=0,m===c.current)throw Error(t(177));c.callbackNode=null,c.callbackPriority=0;var A=m.lanes|m.childLanes;if(Xw(c,A),c===oi&&(Br=oi=null,vi=0),(m.subtreeFlags&2064)===0&&(m.flags&2064)===0||Ty||(Ty=!0,yk(dr,function(){return Jd(),null})),A=(m.flags&15990)!==0,(m.subtreeFlags&15990)!==0||A){A=ua.transition,ua.transition=null;var G=gn;gn=1;var re=_n;_n|=4,t2.current=null,rB(c,m),rk(m,c),CG(uE),ol=!!cE,uE=cE=null,c.current=m,iB(m),Ye(),_n=re,gn=G,ua.transition=A}else c.current=m;if(Ty&&(Ty=!1,yc=c,by=S),A=c.pendingLanes,A===0&&(pc=null),tc(m.stateNode),ps(c,qe()),d!==null)for(w=c.onRecoverableError,m=0;m<d.length;m++)S=d[m],w(S.value,{componentStack:S.stack,digest:S.digest});if(Sy)throw Sy=!1,c=i2,i2=null,c;return(by&1)!==0&&c.tag!==0&&Jd(),A=c.pendingLanes,(A&1)!==0?c===s2?Pg++:(Pg=0,s2=c):Pg=0,dc(),null}function Jd(){if(yc!==null){var c=go(by),d=ua.transition,m=gn;try{if(ua.transition=null,gn=16>c?16:c,yc===null)var w=!1;else{if(c=yc,yc=null,by=0,(_n&6)!==0)throw Error(t(331));var S=_n;for(_n|=4,xt=c.current;xt!==null;){var A=xt,G=A.child;if((xt.flags&16)!==0){var re=A.deletions;if(re!==null){for(var ae=0;ae<re.length;ae++){var be=re[ae];for(xt=be;xt!==null;){var He=xt;switch(He.tag){case 0:case 11:case 15:Ag(8,He,A)}var Xe=He.child;if(Xe!==null)Xe.return=He,xt=Xe;else for(;xt!==null;){He=xt;var Ue=He.sibling,pt=He.return;if(QP(He),He===be){xt=null;break}if(Ue!==null){Ue.return=pt,xt=Ue;break}xt=pt}}}var wt=A.alternate;if(wt!==null){var Tt=wt.child;if(Tt!==null){wt.child=null;do{var Mr=Tt.sibling;Tt.sibling=null,Tt=Mr}while(Tt!==null)}}xt=A}}if((A.subtreeFlags&2064)!==0&&G!==null)G.return=A,xt=G;else e:for(;xt!==null;){if(A=xt,(A.flags&2048)!==0)switch(A.tag){case 0:case 11:case 15:Ag(9,A,A.return)}var fe=A.sibling;if(fe!==null){fe.return=A.return,xt=fe;break e}xt=A.return}}var oe=c.current;for(xt=oe;xt!==null;){G=xt;var _e=G.child;if((G.subtreeFlags&2064)!==0&&_e!==null)_e.return=G,xt=_e;else e:for(G=oe;xt!==null;){if(re=xt,(re.flags&2048)!==0)try{switch(re.tag){case 0:case 11:case 15:vy(9,re)}}catch(It){Sr(re,re.return,It)}if(re===G){xt=null;break e}var Je=re.sibling;if(Je!==null){Je.return=re.return,xt=Je;break e}xt=re.return}}if(_n=S,dc(),Pr&&typeof Pr.onPostCommitFiberRoot=="function")try{Pr.onPostCommitFiberRoot(Ns,c)}catch{}w=!0}return w}finally{gn=m,ua.transition=d}}return!1}function gk(c,d,m){d=qd(m,d),d=MP(c,d,1),c=gc(c,d,1),d=ts(),c!==null&&(Lu(c,1,d),ps(c,d))}function Sr(c,d,m){if(c.tag===3)gk(c,c,m);else for(;d!==null;){if(d.tag===3){gk(d,c,m);break}else if(d.tag===1){var w=d.stateNode;if(typeof d.type.getDerivedStateFromError=="function"||typeof w.componentDidCatch=="function"&&(pc===null||!pc.has(w))){c=qd(m,c),c=NP(d,c,1),d=gc(d,c,1),c=ts(),d!==null&&(Lu(d,1,c),ps(d,c));break}}d=d.return}}function uB(c,d,m){var w=c.pingCache;w!==null&&w.delete(d),d=ts(),c.pingedLanes|=c.suspendedLanes&m,oi===c&&(vi&m)===m&&(Zr===4||Zr===3&&(vi&130023424)===vi&&500>qe()-r2?Yu(c,0):n2|=m),ps(c,d)}function mk(c,d){d===0&&((c.mode&1)===0?d=1:(d=nc,nc<<=1,(nc&130023424)===0&&(nc=4194304)));var m=ts();c=gl(c,d),c!==null&&(Lu(c,d,m),ps(c,m))}function hB(c){var d=c.memoizedState,m=0;d!==null&&(m=d.retryLane),mk(c,m)}function dB(c,d){var m=0;switch(c.tag){case 13:var w=c.stateNode,S=c.memoizedState;S!==null&&(m=S.retryLane);break;case 19:w=c.stateNode;break;default:throw Error(t(314))}w!==null&&w.delete(d),mk(c,m)}var pk;pk=function(c,d,m){if(c!==null)if(c.memoizedProps!==d.pendingProps||ds.current)gs=!0;else{if((c.lanes&m)===0&&(d.flags&128)===0)return gs=!1,JG(c,d,m);gs=(c.flags&131072)!==0}else gs=!1,fr&&(d.flags&1048576)!==0&&qC(d,ry,d.index);switch(d.lanes=0,d.tag){case 2:var w=d.type;_y(c,d),c=d.pendingProps;var S=Bd(d,Oi.current);Kd(d,m),S=LE(null,d,w,c,S,m);var A=OE();return d.flags|=1,typeof S=="object"&&S!==null&&typeof S.render=="function"&&S.$$typeof===void 0?(d.tag=1,d.memoizedState=null,d.updateQueue=null,fs(w)?(A=!0,ey(d)):A=!1,d.memoizedState=S.state!==null&&S.state!==void 0?S.state:null,AE(d),S.updater=py,d.stateNode=S,S._reactInternals=d,BE(d,w,c,m),d=WE(null,d,w,!0,A,m)):(d.tag=0,fr&&A&&yE(d),es(null,d,S,m),d=d.child),d;case 16:w=d.elementType;e:{switch(_y(c,d),c=d.pendingProps,S=w._init,w=S(w._payload),d.type=w,S=d.tag=gB(w),c=La(w,c),S){case 0:d=$E(null,d,w,c,m);break e;case 1:d=UP(null,d,w,c,m);break e;case 11:d=FP(null,d,w,c,m);break e;case 14:d=jP(null,d,w,La(w.type,c),m);break e}throw Error(t(306,w,""))}return d;case 0:return w=d.type,S=d.pendingProps,S=d.elementType===w?S:La(w,S),$E(c,d,w,S,m);case 1:return w=d.type,S=d.pendingProps,S=d.elementType===w?S:La(w,S),UP(c,d,w,S,m);case 3:e:{if(zP(d),c===null)throw Error(t(387));w=d.pendingProps,A=d.memoizedState,S=A.element,iP(c,d),cy(d,w,null,m);var G=d.memoizedState;if(w=G.element,A.isDehydrated)if(A={element:w,isDehydrated:!1,cache:G.cache,pendingSuspenseBoundaries:G.pendingSuspenseBoundaries,transitions:G.transitions},d.updateQueue.baseState=A,d.memoizedState=A,d.flags&256){S=qd(Error(t(423)),d),d=$P(c,d,w,m,S);break e}else if(w!==S){S=qd(Error(t(424)),d),d=$P(c,d,w,m,S);break e}else for(Vs=cc(d.stateNode.containerInfo.firstChild),js=d,fr=!0,Na=null,m=nP(d,null,w,m),d.child=m;m;)m.flags=m.flags&-3|4096,m=m.sibling;else{if($d(),w===S){d=pl(c,d,m);break e}es(c,d,w,m)}d=d.child}return d;case 5:return oP(d),c===null&&vE(d),w=d.type,S=d.pendingProps,A=c!==null?c.memoizedProps:null,G=S.children,hE(w,S)?G=null:A!==null&&hE(w,A)&&(d.flags|=32),BP(c,d),es(c,d,G,m),d.child;case 6:return c===null&&vE(d),null;case 13:return WP(c,d,m);case 4:return RE(d,d.stateNode.containerInfo),w=d.pendingProps,c===null?d.child=Wd(d,null,w,m):es(c,d,w,m),d.child;case 11:return w=d.type,S=d.pendingProps,S=d.elementType===w?S:La(w,S),FP(c,d,w,S,m);case 7:return es(c,d,d.pendingProps,m),d.child;case 8:return es(c,d,d.pendingProps.children,m),d.child;case 12:return es(c,d,d.pendingProps.children,m),d.child;case 10:e:{if(w=d.type._context,S=d.pendingProps,A=d.memoizedProps,G=S.value,er(ay,w._currentValue),w._currentValue=G,A!==null)if(Ma(A.value,G)){if(A.children===S.children&&!ds.current){d=pl(c,d,m);break e}}else for(A=d.child,A!==null&&(A.return=d);A!==null;){var re=A.dependencies;if(re!==null){G=A.child;for(var ae=re.firstContext;ae!==null;){if(ae.context===w){if(A.tag===1){ae=ml(-1,m&-m),ae.tag=2;var be=A.updateQueue;if(be!==null){be=be.shared;var He=be.pending;He===null?ae.next=ae:(ae.next=He.next,He.next=ae),be.pending=ae}}A.lanes|=m,ae=A.alternate,ae!==null&&(ae.lanes|=m),bE(A.return,m,d),re.lanes|=m;break}ae=ae.next}}else if(A.tag===10)G=A.type===d.type?null:A.child;else if(A.tag===18){if(G=A.return,G===null)throw Error(t(341));G.lanes|=m,re=G.alternate,re!==null&&(re.lanes|=m),bE(G,m,d),G=A.sibling}else G=A.child;if(G!==null)G.return=A;else for(G=A;G!==null;){if(G===d){G=null;break}if(A=G.sibling,A!==null){A.return=G.return,G=A;break}G=G.return}A=G}es(c,d,S.children,m),d=d.child}return d;case 9:return S=d.type,w=d.pendingProps.children,Kd(d,m),S=la(S),w=w(S),d.flags|=1,es(c,d,w,m),d.child;case 14:return w=d.type,S=La(w,d.pendingProps),S=La(w.type,S),jP(c,d,w,S,m);case 15:return VP(c,d,d.type,d.pendingProps,m);case 17:return w=d.type,S=d.pendingProps,S=d.elementType===w?S:La(w,S),_y(c,d),d.tag=1,fs(w)?(c=!0,ey(d)):c=!1,Kd(d,m),PP(d,w,S),BE(d,w,S,m),WE(null,d,w,!0,c,m);case 19:return KP(c,d,m);case 22:return GP(c,d,m)}throw Error(t(156,d.tag))};function yk(c,d){return Ke(c,d)}function fB(c,d,m,w){this.tag=c,this.key=m,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=d,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=w,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ha(c,d,m,w){return new fB(c,d,m,w)}function h2(c){return c=c.prototype,!(!c||!c.isReactComponent)}function gB(c){if(typeof c=="function")return h2(c)?1:0;if(c!=null){if(c=c.$$typeof,c===U)return 11;if(c===ke)return 14}return 2}function vc(c,d){var m=c.alternate;return m===null?(m=ha(c.tag,d,c.key,c.mode),m.elementType=c.elementType,m.type=c.type,m.stateNode=c.stateNode,m.alternate=c,c.alternate=m):(m.pendingProps=d,m.type=c.type,m.flags=0,m.subtreeFlags=0,m.deletions=null),m.flags=c.flags&14680064,m.childLanes=c.childLanes,m.lanes=c.lanes,m.child=c.child,m.memoizedProps=c.memoizedProps,m.memoizedState=c.memoizedState,m.updateQueue=c.updateQueue,d=c.dependencies,m.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext},m.sibling=c.sibling,m.index=c.index,m.ref=c.ref,m}function Cy(c,d,m,w,S,A){var G=2;if(w=c,typeof c=="function")h2(c)&&(G=1);else if(typeof c=="string")G=5;else e:switch(c){case k:return Xu(m.children,S,A,d);case C:G=8,S|=8;break;case P:return c=ha(12,m,d,S|2),c.elementType=P,c.lanes=A,c;case j:return c=ha(13,m,d,S),c.elementType=j,c.lanes=A,c;case Ie:return c=ha(19,m,d,S),c.elementType=Ie,c.lanes=A,c;case Ne:return Py(m,S,A,d);default:if(typeof c=="object"&&c!==null)switch(c.$$typeof){case L:G=10;break e;case O:G=9;break e;case U:G=11;break e;case ke:G=14;break e;case ze:G=16,w=null;break e}throw Error(t(130,c==null?c:typeof c,""))}return d=ha(G,m,d,S),d.elementType=c,d.type=w,d.lanes=A,d}function Xu(c,d,m,w){return c=ha(7,c,w,d),c.lanes=m,c}function Py(c,d,m,w){return c=ha(22,c,w,d),c.elementType=Ne,c.lanes=m,c.stateNode={isHidden:!1},c}function d2(c,d,m){return c=ha(6,c,null,d),c.lanes=m,c}function f2(c,d,m){return d=ha(4,c.children!==null?c.children:[],c.key,d),d.lanes=m,d.stateNode={containerInfo:c.containerInfo,pendingChildren:null,implementation:c.implementation},d}function mB(c,d,m,w,S){this.tag=d,this.containerInfo=c,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Q0(0),this.expirationTimes=Q0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Q0(0),this.identifierPrefix=w,this.onRecoverableError=S,this.mutableSourceEagerHydrationData=null}function g2(c,d,m,w,S,A,G,re,ae){return c=new mB(c,d,m,re,ae),d===1?(d=1,A===!0&&(d|=8)):d=0,A=ha(3,null,null,d),c.current=A,A.stateNode=c,A.memoizedState={element:w,isDehydrated:m,cache:null,transitions:null,pendingSuspenseBoundaries:null},AE(A),c}function pB(c,d,m){var w=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:z,key:w==null?null:""+w,children:c,containerInfo:d,implementation:m}}function _k(c){if(!c)return hc;c=c._reactInternals;e:{if(te(c)!==c||c.tag!==1)throw Error(t(170));var d=c;do{switch(d.tag){case 3:d=d.stateNode.context;break e;case 1:if(fs(d.type)){d=d.stateNode.__reactInternalMemoizedMergedChildContext;break e}}d=d.return}while(d!==null);throw Error(t(171))}if(c.tag===1){var m=c.type;if(fs(m))return HC(c,m,d)}return d}function xk(c,d,m,w,S,A,G,re,ae){return c=g2(m,w,!0,c,S,A,G,re,ae),c.context=_k(null),m=c.current,w=ts(),S=_c(m),A=ml(w,S),A.callback=d??null,gc(m,A,S),c.current.lanes=S,Lu(c,S,w),ps(c,w),c}function ky(c,d,m,w){var S=d.current,A=ts(),G=_c(S);return m=_k(m),d.context===null?d.context=m:d.pendingContext=m,d=ml(A,G),d.payload={element:c},w=w===void 0?null:w,w!==null&&(d.callback=w),c=gc(S,d,G),c!==null&&(Fa(c,S,G,A),ly(c,S,G)),G}function My(c){if(c=c.current,!c.child)return null;switch(c.child.tag){case 5:return c.child.stateNode;default:return c.child.stateNode}}function vk(c,d){if(c=c.memoizedState,c!==null&&c.dehydrated!==null){var m=c.retryLane;c.retryLane=m!==0&&m<d?m:d}}function m2(c,d){vk(c,d),(c=c.alternate)&&vk(c,d)}function yB(){return null}var wk=typeof reportError=="function"?reportError:function(c){console.error(c)};function p2(c){this._internalRoot=c}Ny.prototype.render=p2.prototype.render=function(c){var d=this._internalRoot;if(d===null)throw Error(t(409));ky(c,d,null,null)},Ny.prototype.unmount=p2.prototype.unmount=function(){var c=this._internalRoot;if(c!==null){this._internalRoot=null;var d=c.containerInfo;Ku(function(){ky(null,c,null,null)}),d[ul]=null}};function Ny(c){this._internalRoot=c}Ny.prototype.unstable_scheduleHydration=function(c){if(c){var d=ng();c={blockedOn:null,target:c,priority:d};for(var m=0;m<Ls.length&&d!==0&&d<Ls[m].priority;m++);Ls.splice(m,0,c),m===0&&bd(c)}};function y2(c){return!(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)}function Ly(c){return!(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11&&(c.nodeType!==8||c.nodeValue!==" react-mount-point-unstable "))}function Ek(){}function _B(c,d,m,w,S){if(S){if(typeof w=="function"){var A=w;w=function(){var be=My(G);A.call(be)}}var G=xk(d,w,c,0,null,!1,!1,"",Ek);return c._reactRootContainer=G,c[ul]=G.current,gg(c.nodeType===8?c.parentNode:c),Ku(),G}for(;S=c.lastChild;)c.removeChild(S);if(typeof w=="function"){var re=w;w=function(){var be=My(ae);re.call(be)}}var ae=g2(c,0,!1,null,null,!1,!1,"",Ek);return c._reactRootContainer=ae,c[ul]=ae.current,gg(c.nodeType===8?c.parentNode:c),Ku(function(){ky(d,ae,m,w)}),ae}function Oy(c,d,m,w,S){var A=m._reactRootContainer;if(A){var G=A;if(typeof S=="function"){var re=S;S=function(){var ae=My(G);re.call(ae)}}ky(d,G,c,S)}else G=_B(m,d,c,S,w);return My(G)}eg=function(c){switch(c.tag){case 3:var d=c.stateNode;if(d.current.memoizedState.isDehydrated){var m=In(d.pendingLanes);m!==0&&(J0(d,m|1),ps(d,qe()),(_n&6)===0&&(Qd=qe()+500,dc()))}break;case 13:Ku(function(){var w=gl(c,1);if(w!==null){var S=ts();Fa(w,c,1,S)}}),m2(c,1)}},Sd=function(c){if(c.tag===13){var d=gl(c,134217728);if(d!==null){var m=ts();Fa(d,c,134217728,m)}m2(c,134217728)}},tg=function(c){if(c.tag===13){var d=_c(c),m=gl(c,d);if(m!==null){var w=ts();Fa(m,c,d,w)}m2(c,d)}},ng=function(){return gn},rg=function(c,d){var m=gn;try{return gn=c,d()}finally{gn=m}},Z=function(c,d,m){switch(d){case"input":if(ot(c,m),d=m.name,m.type==="radio"&&d!=null){for(m=c;m.parentNode;)m=m.parentNode;for(m=m.querySelectorAll("input[name="+JSON.stringify(""+d)+'][type="radio"]'),d=0;d<m.length;d++){var w=m[d];if(w!==c&&w.form===c.form){var S=Q1(w);if(!S)throw Error(t(90));Kt(w),ot(w,S)}}}break;case"textarea":kn(c,m);break;case"select":d=m.value,d!=null&&Zn(c,!!m.multiple,d,!1)}},$e=l2,et=Ku;var xB={usingClientEntryPoint:!1,Events:[yg,Vd,Q1,Ve,Se,l2]},kg={findFiberByHostInstance:Vu,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},vB={bundleType:kg.bundleType,version:kg.version,rendererPackageName:kg.rendererPackageName,rendererConfig:kg.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:M.ReactCurrentDispatcher,findHostInstanceByFiber:function(c){return c=xe(c),c===null?null:c.stateNode},findFiberByHostInstance:kg.findFiberByHostInstance||yB,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Dy=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Dy.isDisabled&&Dy.supportsFiber)try{Ns=Dy.inject(vB),Pr=Dy}catch{}}return ys.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xB,ys.createPortal=function(c,d){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!y2(d))throw Error(t(200));return pB(c,d,null,m)},ys.createRoot=function(c,d){if(!y2(c))throw Error(t(299));var m=!1,w="",S=wk;return d!=null&&(d.unstable_strictMode===!0&&(m=!0),d.identifierPrefix!==void 0&&(w=d.identifierPrefix),d.onRecoverableError!==void 0&&(S=d.onRecoverableError)),d=g2(c,1,!1,null,null,m,!1,w,S),c[ul]=d.current,gg(c.nodeType===8?c.parentNode:c),new p2(d)},ys.findDOMNode=function(c){if(c==null)return null;if(c.nodeType===1)return c;var d=c._reactInternals;if(d===void 0)throw typeof c.render=="function"?Error(t(188)):(c=Object.keys(c).join(","),Error(t(268,c)));return c=xe(d),c=c===null?null:c.stateNode,c},ys.flushSync=function(c){return Ku(c)},ys.hydrate=function(c,d,m){if(!Ly(d))throw Error(t(200));return Oy(null,c,d,!0,m)},ys.hydrateRoot=function(c,d,m){if(!y2(c))throw Error(t(405));var w=m!=null&&m.hydratedSources||null,S=!1,A="",G=wk;if(m!=null&&(m.unstable_strictMode===!0&&(S=!0),m.identifierPrefix!==void 0&&(A=m.identifierPrefix),m.onRecoverableError!==void 0&&(G=m.onRecoverableError)),d=xk(d,null,c,1,m??null,S,!1,A,G),c[ul]=d.current,gg(c),w)for(c=0;c<w.length;c++)m=w[c],S=m._getVersion,S=S(m._source),d.mutableSourceEagerHydrationData==null?d.mutableSourceEagerHydrationData=[m,S]:d.mutableSourceEagerHydrationData.push(m,S);return new Ny(d)},ys.render=function(c,d,m){if(!Ly(d))throw Error(t(200));return Oy(null,c,d,!1,m)},ys.unmountComponentAtNode=function(c){if(!Ly(c))throw Error(t(40));return c._reactRootContainer?(Ku(function(){Oy(null,null,c,!1,function(){c._reactRootContainer=null,c[ul]=null})}),!0):!1},ys.unstable_batchedUpdates=l2,ys.unstable_renderSubtreeIntoContainer=function(c,d,m,w){if(!Ly(m))throw Error(t(200));if(c==null||c._reactInternals===void 0)throw Error(t(38));return Oy(c,d,m,!1,w)},ys.version="18.3.1-next-f1338f8080-20240426",ys}var Pk;function RB(){if(Pk)return v2.exports;Pk=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),v2.exports=AB(),v2.exports}var kk;function CB(){if(kk)return Fy;kk=1;var n=RB();return Fy.createRoot=n.createRoot,Fy.hydrateRoot=n.hydrateRoot,Fy}var PB=CB();const kB=Wb(PB);var ie=Fp();const MB=Wb(ie),vs={ADD:"add",REMOVE:"remove"},a0={PROPERTYCHANGE:"propertychange"},Yt={CHANGE:"change",ERROR:"error",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",TOUCHMOVE:"touchmove",WHEEL:"wheel"};class Av{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function NB(n,e,t){let r,i;t=t||Cl;let s=0,a=n.length,o=!1;for(;s<a;)r=s+(a-s>>1),i=+t(n[r],e),i<0?s=r+1:(a=r,o=!i);return o?s:~s}function Cl(n,e){return n>e?1:n<e?-1:0}function LB(n,e){return n<e?1:n>e?-1:0}function Rv(n,e,t){if(n[0]<=e)return 0;const r=n.length;if(e<=n[r-1])return r-1;if(typeof t=="function"){for(let i=1;i<r;++i){const s=n[i];if(s===e)return i;if(s<e)return t(e,n[i-1],s)>0?i-1:i}return r-1}if(t>0){for(let i=1;i<r;++i)if(n[i]<e)return i-1;return r-1}if(t<0){for(let i=1;i<r;++i)if(n[i]<=e)return i;return r-1}for(let i=1;i<r;++i){if(n[i]==e)return i;if(n[i]<e)return n[i-1]-e<e-n[i]?i-1:i}return r-1}function OB(n,e,t){for(;e<t;){const r=n[e];n[e]=n[t],n[t]=r,++e,--t}}function Nn(n,e){const t=Array.isArray(e)?e:[e],r=t.length;for(let i=0;i<r;i++)n[n.length]=t[i]}function Su(n,e){const t=n.length;if(t!==e.length)return!1;for(let r=0;r<t;r++)if(n[r]!==e[r])return!1;return!0}function DB(n,e,t){const r=e||Cl;return n.every(function(i,s){if(s===0)return!0;const a=r(n[s-1],i);return!(a>0||a===0)})}function zm(){return!0}function Cv(){return!1}function $m(){}function jO(n){let e,t,r;return function(){const i=Array.prototype.slice.call(arguments);return(!t||this!==r||!Su(i,t))&&(r=this,t=i,e=n.apply(this,arguments)),e}}function VO(n){function e(){let t;try{t=n()}catch(r){return Promise.reject(r)}return t instanceof Promise?t:Promise.resolve(t)}return e()}function jp(n){for(const e in n)delete n[e]}function Nh(n){let e;for(e in n)return!1;return!e}class el{constructor(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}let Vp=class extends Av{constructor(e){super(),this.eventTarget_=e,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(e,t){if(!e||!t)return;const r=this.listeners_||(this.listeners_={}),i=r[e]||(r[e]=[]);i.includes(t)||i.push(t)}dispatchEvent(e){const t=typeof e=="string",r=t?e:e.type,i=this.listeners_&&this.listeners_[r];if(!i)return;const s=t?new el(e):e;s.target||(s.target=this.eventTarget_||this);const a=this.dispatching_||(this.dispatching_={}),o=this.pendingRemovals_||(this.pendingRemovals_={});r in a||(a[r]=0,o[r]=0),++a[r];let l;for(let u=0,h=i.length;u<h;++u)if("handleEvent"in i[u]?l=i[u].handleEvent(s):l=i[u].call(this,s),l===!1||s.propagationStopped){l=!1;break}if(--a[r]===0){let u=o[r];for(delete o[r];u--;)this.removeEventListener(r,$m);delete a[r]}return l}disposeInternal(){this.listeners_&&jp(this.listeners_)}getListeners(e){return this.listeners_&&this.listeners_[e]||void 0}hasListener(e){return this.listeners_?e?e in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(e,t){if(!this.listeners_)return;const r=this.listeners_[e];if(!r)return;const i=r.indexOf(t);i!==-1&&(this.pendingRemovals_&&e in this.pendingRemovals_?(r[i]=$m,++this.pendingRemovals_[e]):(r.splice(i,1),r.length===0&&delete this.listeners_[e]))}};function yn(n,e,t,r,i){if(i){const a=t;t=function(o){return n.removeEventListener(e,t),a.call(r??this,o)}}else r&&r!==n&&(t=t.bind(r));const s={target:n,type:e,listener:t};return n.addEventListener(e,t),s}function Q_(n,e,t,r){return yn(n,e,t,r,!0)}function tr(n){n&&n.target&&(n.target.removeEventListener(n.type,n.listener),jp(n))}class Gp extends Vp{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(Yt.CHANGE)}getRevision(){return this.revision_}onInternal(e,t){if(Array.isArray(e)){const r=e.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=yn(this,e[s],t);return i}return yn(this,e,t)}onceInternal(e,t){let r;if(Array.isArray(e)){const i=e.length;r=new Array(i);for(let s=0;s<i;++s)r[s]=Q_(this,e[s],t)}else r=Q_(this,e,t);return t.ol_key=r,r}unInternal(e,t){const r=t.ol_key;if(r)FB(r);else if(Array.isArray(e))for(let i=0,s=e.length;i<s;++i)this.removeEventListener(e[i],t);else this.removeEventListener(e,t)}}Gp.prototype.on;Gp.prototype.once;Gp.prototype.un;function FB(n){if(Array.isArray(n))for(let e=0,t=n.length;e<t;++e)tr(n[e]);else tr(n)}function Vt(){throw new Error("Unimplemented abstract method.")}let jB=0;function bn(n){return n.ol_uid||(n.ol_uid=String(++jB))}class Mk extends el{constructor(e,t,r){super(e),this.key=t,this.oldValue=r}}class tl extends Gp{constructor(e){super(),this.on,this.once,this.un,bn(this),this.values_=null,e!==void 0&&this.setProperties(e)}get(e){let t;return this.values_&&this.values_.hasOwnProperty(e)&&(t=this.values_[e]),t}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(e,t){let r;r=`change:${e}`,this.hasListener(r)&&this.dispatchEvent(new Mk(r,e,t)),r=a0.PROPERTYCHANGE,this.hasListener(r)&&this.dispatchEvent(new Mk(r,e,t))}addChangeListener(e,t){this.addEventListener(`change:${e}`,t)}removeChangeListener(e,t){this.removeEventListener(`change:${e}`,t)}set(e,t,r){const i=this.values_||(this.values_={});if(r)i[e]=t;else{const s=i[e];i[e]=t,s!==t&&this.notify(e,s)}}setProperties(e,t){for(const r in e)this.set(r,e[r],t)}applyProperties(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}unset(e,t){if(this.values_&&e in this.values_){const r=this.values_[e];delete this.values_[e],Nh(this.values_)&&(this.values_=null),t||this.notify(e,r)}}}const Nk={LENGTH:"length"};class jy extends el{constructor(e,t,r){super(e),this.element=t,this.index=r}}class xa extends tl{constructor(e,t){if(super(),this.on,this.once,this.un,t=t||{},this.unique_=!!t.unique,this.array_=e??[],this.unique_)for(let r=1,i=this.array_.length;r<i;++r)this.assertUnique_(this.array_[r],r);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(e){for(let t=0,r=e.length;t<r;++t)this.push(e[t]);return this}forEach(e){const t=this.array_;for(let r=0,i=t.length;r<i;++r)e(t[r],r,t)}getArray(){return this.array_}item(e){return this.array_[e]}getLength(){return this.get(Nk.LENGTH)}insertAt(e,t){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t),this.array_.splice(e,0,t),this.updateLength_(),this.dispatchEvent(new jy(vs.ADD,t,e))}pop(){return this.removeAt(this.getLength()-1)}push(e){const t=this.getLength();return this.insertAt(t,e),this.getLength()}remove(e){const t=this.array_;for(let r=0,i=t.length;r<i;++r)if(t[r]===e)return this.removeAt(r)}removeAt(e){if(e<0||e>=this.getLength())return;const t=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new jy(vs.REMOVE,t,e)),t}setAt(e,t){const r=this.getLength();if(e>=r){this.insertAt(e,t);return}if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t,e);const i=this.array_[e];this.array_[e]=t,this.dispatchEvent(new jy(vs.REMOVE,i,e)),this.dispatchEvent(new jy(vs.ADD,t,e))}updateLength_(){this.set(Nk.LENGTH,this.array_.length)}assertUnique_(e,t){const r=this.array_;for(let i=0,s=r.length;i<s;++i)if(r[i]===e&&i!==t)throw new Error("Duplicate item added to a unique collection")}}function Dn(n,e){if(!n)throw new Error(e)}let io=class GO extends tl{constructor(e){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),e)if(typeof e.getSimplifiedGeometry=="function"){const t=e;this.setGeometry(t)}else{const t=e;this.setProperties(t)}}clone(){const e=new GO(this.hasProperties()?this.getProperties():null);e.setGeometryName(this.getGeometryName());const t=this.getGeometry();t&&e.setGeometry(t.clone());const r=this.getStyle();return r&&e.setStyle(r),e}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(tr(this.geometryChangeKey_),this.geometryChangeKey_=null);const e=this.getGeometry();e&&(this.geometryChangeKey_=yn(e,Yt.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(e){this.set(this.geometryName_,e)}setStyle(e){this.style_=e,this.styleFunction_=e?VB(e):void 0,this.changed()}setId(e){this.id_=e,this.changed()}setGeometryName(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}};function VB(n){if(typeof n=="function")return n;let e;return Array.isArray(n)?e=n:(Dn(typeof n.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[n]),function(){return e}}const ci={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function Lk(n){const e=Qs();for(let t=0,r=n.length;t<r;++t)dm(e,n[t]);return e}function Wm(n,e,t){return t?(t[0]=n[0]-e,t[1]=n[1]-e,t[2]=n[2]+e,t[3]=n[3]+e,t):[n[0]-e,n[1]-e,n[2]+e,n[3]+e]}function BO(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n.slice()}function id(n,e,t){let r,i;return e<n[0]?r=n[0]-e:n[2]<e?r=e-n[2]:r=0,t<n[1]?i=n[1]-t:n[3]<t?i=t-n[3]:i=0,r*r+i*i}function Lh(n,e){return Hb(n,e[0],e[1])}function Uc(n,e){return n[0]<=e[0]&&e[2]<=n[2]&&n[1]<=e[1]&&e[3]<=n[3]}function Hb(n,e,t){return n[0]<=e&&e<=n[2]&&n[1]<=t&&t<=n[3]}function XS(n,e){const t=n[0],r=n[1],i=n[2],s=n[3],a=e[0],o=e[1];let l=ci.UNKNOWN;return a<t?l=l|ci.LEFT:a>i&&(l=l|ci.RIGHT),o<r?l=l|ci.BELOW:o>s&&(l=l|ci.ABOVE),l===ci.UNKNOWN&&(l=ci.INTERSECTING),l}function Qs(){return[1/0,1/0,-1/0,-1/0]}function lu(n,e,t,r,i){return i?(i[0]=n,i[1]=e,i[2]=t,i[3]=r,i):[n,e,t,r]}function Bp(n){return lu(1/0,1/0,-1/0,-1/0,n)}function UO(n,e){const t=n[0],r=n[1];return lu(t,r,t,r,e)}function Kb(n,e,t,r,i){const s=Bp(i);return $O(s,n,e,t,r)}function o0(n,e){return n[0]==e[0]&&n[2]==e[2]&&n[1]==e[1]&&n[3]==e[3]}function zO(n,e){return e[0]<n[0]&&(n[0]=e[0]),e[2]>n[2]&&(n[2]=e[2]),e[1]<n[1]&&(n[1]=e[1]),e[3]>n[3]&&(n[3]=e[3]),n}function dm(n,e){e[0]<n[0]&&(n[0]=e[0]),e[0]>n[2]&&(n[2]=e[0]),e[1]<n[1]&&(n[1]=e[1]),e[1]>n[3]&&(n[3]=e[1])}function $O(n,e,t,r,i){for(;t<r;t+=i)GB(n,e[t],e[t+1]);return n}function GB(n,e,t){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}function WO(n,e){let t;return t=e(Pv(n)),t||(t=e(kv(n)),t)||(t=e(Mv(n)),t)||(t=e(sd(n)),t)?t:!1}function ZS(n){let e=0;return N0(n)||(e=un(n)*$r(n)),e}function Pv(n){return[n[0],n[1]]}function kv(n){return[n[2],n[1]]}function Wo(n){return[(n[0]+n[2])/2,(n[1]+n[3])/2]}function BB(n,e){let t;if(e==="bottom-left")t=Pv(n);else if(e==="bottom-right")t=kv(n);else if(e==="top-left")t=sd(n);else if(e==="top-right")t=Mv(n);else throw new Error("Invalid corner");return t}function J_(n,e,t,r,i){const[s,a,o,l,u,h,f,g]=HO(n,e,t,r);return lu(Math.min(s,o,u,f),Math.min(a,l,h,g),Math.max(s,o,u,f),Math.max(a,l,h,g),i)}function HO(n,e,t,r){const i=e*r[0]/2,s=e*r[1]/2,a=Math.cos(t),o=Math.sin(t),l=i*a,u=i*o,h=s*a,f=s*o,g=n[0],y=n[1];return[g-l+f,y-u-h,g-l-f,y-u+h,g+l-f,y+u+h,g+l+f,y+u-h,g-l+f,y-u-h]}function $r(n){return n[3]-n[1]}function Pl(n,e,t){const r=t||Qs();return as(n,e)?(n[0]>e[0]?r[0]=n[0]:r[0]=e[0],n[1]>e[1]?r[1]=n[1]:r[1]=e[1],n[2]<e[2]?r[2]=n[2]:r[2]=e[2],n[3]<e[3]?r[3]=n[3]:r[3]=e[3]):Bp(r),r}function sd(n){return[n[0],n[3]]}function Mv(n){return[n[2],n[3]]}function un(n){return n[2]-n[0]}function as(n,e){return n[0]<=e[2]&&n[2]>=e[0]&&n[1]<=e[3]&&n[3]>=e[1]}function N0(n){return n[2]<n[0]||n[3]<n[1]}function UB(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n}function zB(n,e,t){let r=!1;const i=XS(n,e),s=XS(n,t);if(i===ci.INTERSECTING||s===ci.INTERSECTING)r=!0;else{const a=n[0],o=n[1],l=n[2],u=n[3],h=e[0],f=e[1],g=t[0],y=t[1],v=(y-f)/(g-h);let x,E;s&ci.ABOVE&&!(i&ci.ABOVE)&&(x=g-(y-u)/v,r=x>=a&&x<=l),!r&&s&ci.RIGHT&&!(i&ci.RIGHT)&&(E=y-(g-l)*v,r=E>=o&&E<=u),!r&&s&ci.BELOW&&!(i&ci.BELOW)&&(x=g-(y-o)/v,r=x>=a&&x<=l),!r&&s&ci.LEFT&&!(i&ci.LEFT)&&(E=y-(g-a)*v,r=E>=o&&E<=u)}return r}function KO(n,e){const t=e.getExtent(),r=Wo(n);if(e.canWrapX()&&(r[0]<t[0]||r[0]>=t[2])){const i=un(t),a=Math.floor((r[0]-t[0])/i)*i;n[0]-=a,n[2]-=a}return n}function YO(n,e,t){if(e.canWrapX()){const r=e.getExtent();if(!isFinite(n[0])||!isFinite(n[2]))return[[r[0],n[1],r[2],n[3]]];KO(n,e);const i=un(r);if(un(n)>i&&!t)return[[r[0],n[1],r[2],n[3]]];if(n[0]<r[0])return[[n[0]+i,n[1],r[2],n[3]],[r[0],n[1],n[2],n[3]]];if(n[2]>r[2])return[[n[0],n[1],r[2],n[3]],[r[0],n[1],n[2]-i,n[3]]]}return[n]}function ar(n,e,t){return Math.min(Math.max(n,e),t)}function $B(n,e,t,r,i,s){const a=i-t,o=s-r;if(a!==0||o!==0){const l=((n-t)*a+(e-r)*o)/(a*a+o*o);l>1?(t=i,r=s):l>0&&(t+=a*l,r+=o*l)}return bh(n,e,t,r)}function bh(n,e,t,r){const i=t-n,s=r-e;return i*i+s*s}function WB(n){const e=n.length;for(let r=0;r<e;r++){let i=r,s=Math.abs(n[r][r]);for(let o=r+1;o<e;o++){const l=Math.abs(n[o][r]);l>s&&(s=l,i=o)}if(s===0)return null;const a=n[i];n[i]=n[r],n[r]=a;for(let o=r+1;o<e;o++){const l=-n[o][r]/n[r][r];for(let u=r;u<e+1;u++)r==u?n[o][u]=0:n[o][u]+=l*n[r][u]}}const t=new Array(e);for(let r=e-1;r>=0;r--){t[r]=n[r][e]/n[r][r];for(let i=r-1;i>=0;i--)n[i][e]-=n[i][r]*t[r]}return t}function Ok(n){return n*180/Math.PI}function kl(n){return n*Math.PI/180}function Jc(n,e){const t=n%e;return t*e<0?t+e:t}function $s(n,e,t){return n+t*(e-n)}function Up(n,e){const t=Math.pow(10,e);return Math.round(n*t)/t}function ex(n,e){return Math.round(Up(n,e))}function Vy(n,e){return Math.floor(Up(n,e))}function zc(n,e){return Math.ceil(Up(n,e))}function QS(n,e,t){if(n>=e&&n<t)return n;const r=t-e;return((n-e)%r+r)%r+e}function Ng(n,e,t){const r=""+n;let i=r.indexOf(".");return i=i===-1?r.length:i,i>e?r:new Array(1+e-i).join("0")+r}function qO(n,e){const t=(""+n).split("."),r=(""+e).split(".");for(let i=0;i<Math.max(t.length,r.length);i++){const s=parseInt(t[i]||"0",10),a=parseInt(r[i]||"0",10);if(s>a)return 1;if(a>s)return-1}return 0}function HB(n,e){return n[0]+=+e[0],n[1]+=+e[1],n}function tx(n,e){let t=!0;for(let r=n.length-1;r>=0;--r)if(n[r]!=e[r]){t=!1;break}return t}function Yb(n,e){const t=Math.cos(e),r=Math.sin(e),i=n[0]*t-n[1]*r,s=n[1]*t+n[0]*r;return n[0]=i,n[1]=s,n}function KB(n,e){return n[0]*=e,n[1]*=e,n}function XO(n,e){if(e.canWrapX()){const t=un(e.getExtent()),r=ZO(n,e,t);r&&(n[0]-=r*t)}return n}function ZO(n,e,t){const r=e.getExtent();let i=0;return e.canWrapX()&&(n[0]<r[0]||n[0]>r[2])&&(t=t||un(r),i=Math.floor((n[0]-r[0])/t)),i}function QO(...n){console.warn(...n)}const l0={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};let Nv=class{constructor(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||l0[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(e){this.defaultTileGrid_=e}setExtent(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)}setWorldExtent(e){this.worldExtent_=e}setGetPointResolution(e){this.getPointResolutionFunc_=e}getPointResolutionFunc(){return this.getPointResolutionFunc_}};const zp=6378137,kf=Math.PI*zp,YB=[-kf,-kf,kf,kf],qB=[-180,-85,180,85],Gy=zp*Math.log(Math.tan(Math.PI/2));class ef extends Nv{constructor(e){super({code:e,units:"m",extent:YB,global:!0,worldExtent:qB,getPointResolution:function(t,r){return t/Math.cosh(r[1]/zp)}})}}const Dk=[new ef("EPSG:3857"),new ef("EPSG:102100"),new ef("EPSG:102113"),new ef("EPSG:900913"),new ef("http://www.opengis.net/def/crs/EPSG/0/3857"),new ef("http://www.opengis.net/gml/srs/epsg.xml#3857")];function XB(n,e,t,r){const i=n.length;t=t>1?t:2,r=r??t,e===void 0&&(t>2?e=n.slice():e=new Array(i));for(let s=0;s<i;s+=r){e[s]=kf*n[s]/180;let a=zp*Math.log(Math.tan(Math.PI*(+n[s+1]+90)/360));a>Gy?a=Gy:a<-Gy&&(a=-Gy),e[s+1]=a}return e}function ZB(n,e,t,r){const i=n.length;t=t>1?t:2,r=r??t,e===void 0&&(t>2?e=n.slice():e=new Array(i));for(let s=0;s<i;s+=r)e[s]=180*n[s]/kf,e[s+1]=360*Math.atan(Math.exp(n[s+1]/zp))/Math.PI-90;return e}const QB=6378137,Fk=[-180,-90,180,90],JB=Math.PI*QB/180;class Zu extends Nv{constructor(e,t){super({code:e,units:"degrees",extent:Fk,axisOrientation:t,global:!0,metersPerUnit:JB,worldExtent:Fk})}}const jk=[new Zu("CRS:84"),new Zu("EPSG:4326","neu"),new Zu("urn:ogc:def:crs:OGC:1.3:CRS84"),new Zu("urn:ogc:def:crs:OGC:2:84"),new Zu("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new Zu("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Zu("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let JS={};function T_(n){return JS[n]||JS[n.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function eU(n,e){JS[n]=e}let Uf={};function Oh(n,e,t){const r=n.getCode(),i=e.getCode();r in Uf||(Uf[r]={}),Uf[r][i]=t}function b_(n,e){return n in Uf&&e in Uf[n]?Uf[n][e]:null}const nx=.9996,Sa=.00669438,Lv=Sa*Sa,Ov=Lv*Sa,ph=Sa/(1-Sa),Vk=Math.sqrt(1-Sa),c0=(1-Vk)/(1+Vk),JO=c0*c0,qb=JO*c0,Xb=qb*c0,e5=Xb*c0,t5=1-Sa/4-3*Lv/64-5*Ov/256,tU=3*Sa/8+3*Lv/32+45*Ov/1024,nU=15*Lv/256+45*Ov/1024,rU=35*Ov/3072,iU=3/2*c0-27/32*qb+269/512*e5,sU=21/16*JO-55/32*Xb,aU=151/96*qb-417/128*e5,oU=1097/512*Xb,rx=6378137;function lU(n,e,t){const r=n-5e5,a=(t.north?e:e-1e7)/nx/(rx*t5),o=a+iU*Math.sin(2*a)+sU*Math.sin(4*a)+aU*Math.sin(6*a)+oU*Math.sin(8*a),l=Math.sin(o),u=l*l,h=Math.cos(o),f=l/h,g=f*f,y=g*g,v=1-Sa*u,x=Math.sqrt(1-Sa*u),E=rx/x,T=(1-Sa)/v,b=ph*h**2,I=b*b,M=r/(E*nx),F=M*M,z=F*M,k=z*M,C=k*M,P=C*M,L=o-f/T*(F/2-k/24*(5+3*g+10*b-4*I-9*ph))+P/720*(61+90*g+298*b+45*y-252*ph-3*I);let O=(M-z/6*(1+2*g+b)+C/120*(5-2*b+28*g-3*I+8*ph+24*y))/h;return O=QS(O+kl(n5(t.number)),-Math.PI,Math.PI),[Ok(O),Ok(L)]}const Gk=-80,Bk=84,cU=-180,uU=180;function hU(n,e,t){n=QS(n,cU,uU),e<Gk?e=Gk:e>Bk&&(e=Bk);const r=kl(e),i=Math.sin(r),s=Math.cos(r),a=i/s,o=a*a,l=o*o,u=kl(n),h=n5(t.number),f=kl(h),g=rx/Math.sqrt(1-Sa*i**2),y=ph*s**2,v=s*QS(u-f,-Math.PI,Math.PI),x=v*v,E=x*v,T=E*v,b=T*v,I=b*v,M=rx*(t5*r-tU*Math.sin(2*r)+nU*Math.sin(4*r)-rU*Math.sin(6*r)),F=nx*g*(v+E/6*(1-o+y)+b/120*(5-18*o+l+72*y-58*ph))+5e5;let z=nx*(M+g*a*(x/2+T/24*(5-o+9*y+4*y**2)+I/720*(61-58*o+l+600*y-330*ph)));return t.north||(z+=1e7),[F,z]}function n5(n){return(n-1)*6-180+3}const dU=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function r5(n){let e=0;for(const i of dU){const s=n.match(i);if(s){e=parseInt(s[1]);break}}if(!e)return null;let t=0,r=!1;return e>32700&&e<32761?t=e-32700:e>32600&&e<32661&&(r=!0,t=e-32600),t?{number:t,north:r}:null}function Uk(n,e){return function(t,r,i,s){const a=t.length;i=i>1?i:2,s=s??i,r||(i>2?r=t.slice():r=new Array(a));for(let o=0;o<a;o+=s){const l=t[o],u=t[o+1],h=n(l,u,e);r[o]=h[0],r[o+1]=h[1]}return r}}function fU(n){return r5(n)?new Nv({code:n,units:"m"}):null}function gU(n){const e=r5(n.getCode());return e?{forward:Uk(hU,e),inverse:Uk(lU,e)}:null}const mU=63710088e-1;function zk(n,e,t){t=t||mU;const r=kl(n[1]),i=kl(e[1]),s=(i-r)/2,a=kl(e[0]-n[0])/2,o=Math.sin(s)*Math.sin(s)+Math.sin(a)*Math.sin(a)*Math.cos(r)*Math.cos(i);return 2*t*Math.atan2(Math.sqrt(o),Math.sqrt(1-o))}const pU=[gU],yU=[fU];let eT=!0;function i5(n){eT=!1}function Zb(n,e){if(e!==void 0){for(let t=0,r=n.length;t<r;++t)e[t]=n[t];e=e}else e=n.slice();return e}function ix(n){eU(n.getCode(),n),Oh(n,n,Zb)}function _U(n){n.forEach(ix)}function qn(n){if(typeof n!="string")return n;const e=T_(n);if(e)return e;for(const t of yU){const r=t(n);if(r)return r}return null}function sx(n,e,t,r){n=qn(n);let i;const s=n.getPointResolutionFunc();if(s){if(i=s(e,t),r&&r!==n.getUnits()){const a=n.getMetersPerUnit();a&&(i=i*a/l0[r])}}else{const a=n.getUnits();if(a=="degrees"&&!r||r=="degrees")i=e;else{const o=Jb(n,qn("EPSG:4326"));if(!o&&a!=="degrees")i=e*n.getMetersPerUnit();else{let u=[t[0]-e/2,t[1],t[0]+e/2,t[1],t[0],t[1]-e/2,t[0],t[1]+e/2];u=o(u,u,2);const h=zk(u.slice(0,2),u.slice(2,4)),f=zk(u.slice(4,6),u.slice(6,8));i=(h+f)/2}const l=r?l0[r]:n.getMetersPerUnit();l!==void 0&&(i/=l)}}return i}function tT(n){_U(n),n.forEach(function(e){n.forEach(function(t){e!==t&&Oh(e,t,Zb)})})}function xU(n,e,t,r){n.forEach(function(i){e.forEach(function(s){Oh(i,s,t),Oh(s,i,r)})})}function Qb(n,e){return n?typeof n=="string"?qn(n):n:qn(e)}function nT(n){return(function(e,t,r,i){const s=e.length;r=r!==void 0?r:2,i=i??r,t=t!==void 0?t:new Array(s);for(let a=0;a<s;a+=i){const o=n(e.slice(a,a+r)),l=o.length;for(let u=0,h=i;u<h;++u)t[a+u]=u>=l?e[a+u]:o[u]}return t})}function vU(n,e,t,r){const i=qn(n),s=qn(e);Oh(i,s,nT(t)),Oh(s,i,nT(r))}function Ho(n,e){return i5(),$p(n,"EPSG:4326","EPSG:3857")}function xn(n,e){const t=$p(n,"EPSG:3857","EPSG:4326"),r=t[0];return(r<-180||r>180)&&(t[0]=Jc(r+180,360)-180),t}function Ih(n,e){if(n===e)return!0;const t=n.getUnits()===e.getUnits();return(n.getCode()===e.getCode()||Jb(n,e)===Zb)&&t}function Jb(n,e){const t=n.getCode(),r=e.getCode();let i=b_(t,r);if(i)return i;let s=null,a=null;for(const l of pU)s||(s=l(n)),a||(a=l(e));if(!s&&!a)return null;const o="EPSG:4326";if(a)if(s)i=S2(s.inverse,a.forward);else{const l=b_(t,o);l&&(i=S2(l,a.forward))}else{const l=b_(o,r);l&&(i=S2(s.inverse,l))}return i&&(ix(n),ix(e),Oh(n,e,i)),i}function S2(n,e){return function(t,r,i,s){return r=n(t,r,i,s),e(r,r,i,s)}}function Hm(n,e){const t=qn(n),r=qn(e);return Jb(t,r)}function $p(n,e,t){const r=Hm(e,t);if(!r){const i=qn(e).getCode(),s=qn(t).getCode();throw new Error(`No transform available between ${i} and ${s}`)}return r(n,void 0,n.length)}function rT(n,e){return n}function wl(n,e){return eT&&!tx(n,[0,0])&&n[0]>=-180&&n[0]<=180&&n[1]>=-90&&n[1]<=90&&(eT=!1,QO("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),n}function s5(n,e){return n}function No(n,e){return n}function $k(n,e,t){return function(r){let i,s;if(n.canWrapX()){const a=n.getExtent(),o=un(a);r=r.slice(0),s=ZO(r,n,o),s&&(r[0]=r[0]-s*o),r[0]=ar(r[0],a[0],a[2]),r[1]=ar(r[1],a[1],a[3]),i=t(r)}else i=t(r);return s&&e.canWrapX()&&(i[0]+=s*un(e.getExtent())),i}}function wU(){tT(Dk),tT(jk),xU(jk,Dk,XB,ZB)}wU();new Array(6);function Qa(){return[1,0,0,1,0,0]}function EU(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n}function ti(n,e){const t=e[0],r=e[1];return e[0]=n[0]*t+n[2]*r+n[4],e[1]=n[1]*t+n[3]*r+n[5],e}function Ko(n,e,t,r,i,s,a,o){const l=Math.sin(s),u=Math.cos(s);return n[0]=r*u,n[1]=i*l,n[2]=-r*l,n[3]=i*u,n[4]=a*r*u-o*r*l+e,n[5]=a*i*l+o*i*u+t,n}function a5(n,e){const t=SU(e);Dn(t!==0,"Transformation matrix cannot be inverted");const r=e[0],i=e[1],s=e[2],a=e[3],o=e[4],l=e[5];return n[0]=a/t,n[1]=-i/t,n[2]=-s/t,n[3]=r/t,n[4]=(s*l-a*o)/t,n[5]=-(r*l-i*o)/t,n}function SU(n){return n[0]*n[3]-n[1]*n[2]}const TU=[1e5,1e5,1e5,1e5,2,2];function bU(n){return"matrix("+n.join(", ")+")"}function iT(n){return n.substring(7,n.length-1).split(",").map(parseFloat)}function IU(n,e){const t=iT(n),r=iT(e);for(let i=0;i<6;++i)if(Math.round((t[i]-r[i])*TU[i])!==0)return!1;return!0}function eu(n,e,t,r,i,s,a){s=s||[],a=a||2;let o=0;for(let l=e;l<t;l+=r){const u=n[l],h=n[l+1];s[o++]=i[0]*u+i[2]*h+i[4],s[o++]=i[1]*u+i[3]*h+i[5];for(let f=2;f<a;f++)s[o++]=n[l+f]}return s&&s.length!=o&&(s.length=o),s}function o5(n,e,t,r,i,s,a){a=a||[];const o=Math.cos(i),l=Math.sin(i),u=s[0],h=s[1];let f=0;for(let g=e;g<t;g+=r){const y=n[g]-u,v=n[g+1]-h;a[f++]=u+y*o-v*l,a[f++]=h+y*l+v*o;for(let x=g+2;x<g+r;++x)a[f++]=n[x]}return a&&a.length!=f&&(a.length=f),a}function AU(n,e,t,r,i,s,a,o){o=o||[];const l=a[0],u=a[1];let h=0;for(let f=e;f<t;f+=r){const g=n[f]-l,y=n[f+1]-u;o[h++]=l+i*g,o[h++]=u+s*y;for(let v=f+2;v<f+r;++v)o[h++]=n[v]}return o&&o.length!=h&&(o.length=h),o}function RU(n,e,t,r,i,s,a){a=a||[];let o=0;for(let l=e;l<t;l+=r){a[o++]=n[l]+i,a[o++]=n[l+1]+s;for(let u=l+2;u<l+r;++u)a[o++]=n[u]}return a&&a.length!=o&&(a.length=o),a}const Wk=Qa(),CU=[NaN,NaN];class l5 extends tl{constructor(){super(),this.extent_=Qs(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=jO((e,t,r)=>{if(!r)return this.getSimplifiedGeometry(t);const i=this.clone();return i.applyTransform(r),i.getSimplifiedGeometry(t)})}simplifyTransformed(e,t){return this.simplifyTransformedInternal(this.getRevision(),e,t)}clone(){return Vt()}closestPointXY(e,t,r,i){return Vt()}containsXY(e,t){return this.closestPointXY(e,t,CU,Number.MIN_VALUE)===0}getClosestPoint(e,t){return t=t||[NaN,NaN],this.closestPointXY(e[0],e[1],t,1/0),t}intersectsCoordinate(e){return this.containsXY(e[0],e[1])}computeExtent(e){return Vt()}getExtent(e){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&Bp(t),this.extentRevision_=this.getRevision()}return UB(this.extent_,e)}rotate(e,t){Vt()}scale(e,t,r){Vt()}simplify(e){return this.getSimplifiedGeometry(e*e)}getSimplifiedGeometry(e){return Vt()}getType(){return Vt()}applyTransform(e){Vt()}intersectsExtent(e){return Vt()}translate(e,t){Vt()}transform(e,t){const r=qn(e),i=r.getUnits()=="tile-pixels"?function(s,a,o){const l=r.getExtent(),u=r.getWorldExtent(),h=$r(u)/$r(l);Ko(Wk,u[0],u[3],h,-h,0,0,0);const f=eu(s,0,s.length,o,Wk,a),g=Hm(r,t);return g?g(f,f,o):f}:Hm(r,t);return this.applyTransform(i),this}}class ad extends l5{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(e){return Kb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinates(){return Vt()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=this.getSimplifiedGeometryInternal(e);return t.getFlatCoordinates().length<this.flatCoordinates.length?t:(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getSimplifiedGeometryInternal(e){return this}getStride(){return this.stride}setFlatCoordinates(e,t){this.stride=Hk(e),this.layout=e,this.flatCoordinates=t}setCoordinates(e,t){Vt()}setLayout(e,t,r){let i;if(e)i=Hk(e);else{for(let s=0;s<r;++s){if(t.length===0){this.layout="XY",this.stride=2;return}t=t[0]}i=t.length,e=od(i)}this.layout=e,this.stride=i}applyTransform(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(e,t){const r=this.getFlatCoordinates();if(r){const i=this.getStride();o5(r,0,r.length,i,e,t,r),this.changed()}}scale(e,t,r){t===void 0&&(t=e),r||(r=Wo(this.getExtent()));const i=this.getFlatCoordinates();if(i){const s=this.getStride();AU(i,0,i.length,s,e,t,r,i),this.changed()}}translate(e,t){const r=this.getFlatCoordinates();if(r){const i=this.getStride();RU(r,0,r.length,i,e,t,r),this.changed()}}}function od(n){let e;return n==2?e="XY":n==3?e="XYZ":n==4&&(e="XYZM"),e}function Hk(n){let e;return n=="XY"?e=2:n=="XYZ"||n=="XYM"?e=3:n=="XYZM"&&(e=4),e}function PU(n,e,t){const r=n.getFlatCoordinates();if(!r)return null;const i=n.getStride();return eu(r,0,r.length,i,e,t)}function Kk(n,e,t,r,i,s,a){const o=n[e],l=n[e+1],u=n[t]-o,h=n[t+1]-l;let f;if(u===0&&h===0)f=e;else{const g=((i-o)*u+(s-l)*h)/(u*u+h*h);if(g>1)f=t;else if(g>0){for(let y=0;y<r;++y)a[y]=$s(n[e+y],n[t+y],g);a.length=r;return}else f=e}for(let g=0;g<r;++g)a[g]=n[f+g];a.length=r}function eI(n,e,t,r,i){let s=n[e],a=n[e+1];for(e+=r;e<t;e+=r){const o=n[e],l=n[e+1],u=bh(s,a,o,l);u>i&&(i=u),s=o,a=l}return i}function tI(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){const o=t[s];i=eI(n,e,o,r,i),e=o}return i}function kU(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){const o=t[s];i=tI(n,e,o,r,i),e=o[o.length-1]}return i}function nI(n,e,t,r,i,s,a,o,l,u,h){if(e==t)return u;let f,g;if(i===0){if(g=bh(a,o,n[e],n[e+1]),g<u){for(f=0;f<r;++f)l[f]=n[e+f];return l.length=r,g}return u}h=h||[NaN,NaN];let y=e+r;for(;y<t;)if(Kk(n,y-r,y,r,a,o,h),g=bh(a,o,h[0],h[1]),g<u){for(u=g,f=0;f<r;++f)l[f]=h[f];l.length=r,y+=r}else y+=r*Math.max((Math.sqrt(g)-Math.sqrt(u))/i|0,1);if(s&&(Kk(n,t-r,e,r,a,o,h),g=bh(a,o,h[0],h[1]),g<u)){for(u=g,f=0;f<r;++f)l[f]=h[f];l.length=r}return u}function rI(n,e,t,r,i,s,a,o,l,u,h){h=h||[NaN,NaN];for(let f=0,g=t.length;f<g;++f){const y=t[f];u=nI(n,e,y,r,i,s,a,o,l,u,h),e=y}return u}function MU(n,e,t,r,i,s,a,o,l,u,h){h=h||[NaN,NaN];for(let f=0,g=t.length;f<g;++f){const y=t[f];u=rI(n,e,y,r,i,s,a,o,l,u,h),e=y[y.length-1]}return u}function NU(n,e,t,r){for(let i=0,s=t.length;i<s;++i)n[e++]=t[i];return e}function Dv(n,e,t,r){for(let i=0,s=t.length;i<s;++i){const a=t[i];for(let o=0;o<r;++o)n[e++]=a[o]}return e}function Wp(n,e,t,r,i){i=i||[];let s=0;for(let a=0,o=t.length;a<o;++a){const l=Dv(n,e,t[a],r);i[s++]=l,e=l}return i.length=s,i}function c5(n,e,t,r,i){i=i||[];let s=0;for(let a=0,o=t.length;a<o;++a){const l=Wp(n,e,t[a],r,i[s]);l.length===0&&(l[0]=e),i[s++]=l,e=l[l.length-1]}return i.length=s,i}function $c(n,e,t,r,i){i=i!==void 0?i:[];let s=0;for(let a=e;a<t;a+=r)i[s++]=n.slice(a,a+r);return i.length=s,i}function Km(n,e,t,r,i){i=i!==void 0?i:[];let s=0;for(let a=0,o=t.length;a<o;++a){const l=t[a];i[s++]=$c(n,e,l,r,i[s]),e=l}return i.length=s,i}function sT(n,e,t,r,i){i=i!==void 0?i:[];let s=0;for(let a=0,o=t.length;a<o;++a){const l=t[a];i[s++]=l.length===1&&l[0]===e?[]:Km(n,e,l,r,i[s]),e=l[l.length-1]}return i.length=s,i}function ax(n,e,t,r,i,s,a){let o,l;const u=(t-e)/r;if(u===1)o=e;else if(u===2)o=e,l=i;else if(u!==0){let h=n[e],f=n[e+1],g=0;const y=[0];for(let E=e+r;E<t;E+=r){const T=n[E],b=n[E+1];g+=Math.sqrt((T-h)*(T-h)+(b-f)*(b-f)),y.push(g),h=T,f=b}const v=i*g,x=NB(y,v);x<0?(l=(v-y[-x-2])/(y[-x-1]-y[-x-2]),o=e+(-x-2)*r):o=e+x*r}a=a>1?a:2,s=s||new Array(a);for(let h=0;h<a;++h)s[h]=o===void 0?NaN:l===void 0?n[o+h]:$s(n[o+h],n[o+r+h],l);return s}function aT(n,e,t,r,i,s){if(t==e)return null;let a;if(i<n[e+r-1])return s?(a=n.slice(e,e+r),a[r-1]=i,a):null;if(n[t-1]<i)return s?(a=n.slice(t-r,t),a[r-1]=i,a):null;if(i==n[e+r-1])return n.slice(e,e+r);let o=e/r,l=t/r;for(;o<l;){const g=o+l>>1;i<n[(g+1)*r-1]?l=g:o=g+1}const u=n[o*r-1];if(i==u)return n.slice((o-1)*r,(o-1)*r+r);const h=n[(o+1)*r-1],f=(i-u)/(h-u);a=[];for(let g=0;g<r-1;++g)a.push($s(n[(o-1)*r+g],n[o*r+g],f));return a.push(i),a}function LU(n,e,t,r,i,s,a){if(a)return aT(n,e,t[t.length-1],r,i,s);let o;if(i<n[r-1])return s?(o=n.slice(0,r),o[r-1]=i,o):null;if(n[n.length-1]<i)return s?(o=n.slice(n.length-r),o[r-1]=i,o):null;for(let l=0,u=t.length;l<u;++l){const h=t[l];if(e!=h){if(i<n[e+r-1])return null;if(i<=n[h-1])return aT(n,e,h,r,i,!1);e=h}}return null}function OU(n,e,t,r,i){return!WO(i,function(a){return!yh(n,e,t,r,a[0],a[1])})}function yh(n,e,t,r,i,s){let a=0,o=n[t-r],l=n[t-r+1];for(;e<t;e+=r){const u=n[e],h=n[e+1];l<=s?h>s&&(u-o)*(s-l)-(i-o)*(h-l)>0&&a++:h<=s&&(u-o)*(s-l)-(i-o)*(h-l)<0&&a--,o=u,l=h}return a!==0}function iI(n,e,t,r,i,s){if(t.length===0||!yh(n,e,t[0],r,i,s))return!1;for(let a=1,o=t.length;a<o;++a)if(yh(n,t[a-1],t[a],r,i,s))return!1;return!0}function DU(n,e,t,r,i,s){if(t.length===0)return!1;for(let a=0,o=t.length;a<o;++a){const l=t[a];if(iI(n,e,l,r,i,s))return!0;e=l[l.length-1]}return!1}function u5(n,e,t,r,i){let s;for(e+=r;e<t;e+=r)if(s=i(n.slice(e-r,e),n.slice(e,e+r)),s)return s;return!1}function Fv(n,e,t,r,i,s){return s=s??$O(Qs(),n,e,t,r),as(i,s)?s[0]>=i[0]&&s[2]<=i[2]||s[1]>=i[1]&&s[3]<=i[3]?!0:u5(n,e,t,r,function(a,o){return zB(i,a,o)}):!1}function FU(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){if(Fv(n,e,t[s],r,i))return!0;e=t[s]}return!1}function h5(n,e,t,r,i){return!!(Fv(n,e,t,r,i)||yh(n,e,t,r,i[0],i[1])||yh(n,e,t,r,i[0],i[3])||yh(n,e,t,r,i[2],i[1])||yh(n,e,t,r,i[2],i[3]))}function d5(n,e,t,r,i){if(!h5(n,e,t[0],r,i))return!1;if(t.length===1)return!0;for(let s=1,a=t.length;s<a;++s)if(OU(n,t[s-1],t[s],r,i)&&!Fv(n,t[s-1],t[s],r,i))return!1;return!0}function jU(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){const o=t[s];if(d5(n,e,o,r,i))return!0;e=o[o.length-1]}return!1}function sI(n,e,t,r){let i=n[e],s=n[e+1],a=0;for(let o=e+r;o<t;o+=r){const l=n[o],u=n[o+1];a+=Math.sqrt((l-i)*(l-i)+(u-s)*(u-s)),i=l,s=u}return a}function jv(n,e,t,r,i,s,a){const o=(t-e)/r;if(o<3){for(;e<t;e+=r)s[a++]=n[e],s[a++]=n[e+1];return a}const l=new Array(o);l[0]=1,l[o-1]=1;const u=[e,t-r];let h=0;for(;u.length>0;){const f=u.pop(),g=u.pop();let y=0;const v=n[g],x=n[g+1],E=n[f],T=n[f+1];for(let b=g+r;b<f;b+=r){const I=n[b],M=n[b+1],F=$B(I,M,v,x,E,T);F>y&&(h=b,y=F)}y>i&&(l[(h-e)/r]=1,g+r<h&&u.push(g,h),h+r<f&&u.push(h,f))}for(let f=0;f<o;++f)l[f]&&(s[a++]=n[e+f*r],s[a++]=n[e+f*r+1]);return a}function f5(n,e,t,r,i,s,a,o){for(let l=0,u=t.length;l<u;++l){const h=t[l];a=jv(n,e,h,r,i,s,a),o.push(a),e=h}return a}function th(n,e){return e*Math.round(n/e)}function VU(n,e,t,r,i,s,a){if(e==t)return a;let o=th(n[e],i),l=th(n[e+1],i);e+=r,s[a++]=o,s[a++]=l;let u,h;do if(u=th(n[e],i),h=th(n[e+1],i),e+=r,e==t)return s[a++]=u,s[a++]=h,a;while(u==o&&h==l);for(;e<t;){const f=th(n[e],i),g=th(n[e+1],i);if(e+=r,f==u&&g==h)continue;const y=u-o,v=h-l,x=f-o,E=g-l;if(y*E==v*x&&(y<0&&x<y||y==x||y>0&&x>y)&&(v<0&&E<v||v==E||v>0&&E>v)){u=f,h=g;continue}s[a++]=u,s[a++]=h,o=u,l=h,u=f,h=g}return s[a++]=u,s[a++]=h,a}function aI(n,e,t,r,i,s,a,o){for(let l=0,u=t.length;l<u;++l){const h=t[l];a=VU(n,e,h,r,i,s,a),o.push(a),e=h}return a}function GU(n,e,t,r,i,s,a,o){for(let l=0,u=t.length;l<u;++l){const h=t[l],f=[];a=aI(n,e,h,r,i,s,a,f),o.push(f),e=h[h.length-1]}return a}class so extends ad{constructor(e,t){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}appendCoordinate(e){Nn(this.flatCoordinates,e),this.changed()}clone(){const e=new so(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,r,i){return i<id(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(eI(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),nI(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,e,t,r,i))}forEachSegment(e){return u5(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinateAtM(e,t){return this.layout!="XYM"&&this.layout!="XYZM"?null:(t=t!==void 0?t:!1,aT(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t))}getCoordinates(){return $c(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(e,t){return ax(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,this.stride)}getLength(){return sI(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(e){const t=[];return t.length=jv(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new so(t,"XY")}getType(){return"LineString"}intersectsExtent(e){return Fv(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,this.getExtent())}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Dv(this.flatCoordinates,0,e,this.stride),this.changed()}}let Js=class g5 extends ad{constructor(e,t){super(),this.setCoordinates(e,t)}clone(){const e=new g5(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,r,i){const s=this.flatCoordinates,a=bh(e,t,s[0],s[1]);if(a<i){const o=this.stride;for(let l=0;l<o;++l)r[l]=s[l];return r.length=o,a}return i}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(e){return UO(this.flatCoordinates,e)}getType(){return"Point"}intersectsExtent(e){return Hb(e,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(e,t){this.setLayout(t,e,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=NU(this.flatCoordinates,0,e,this.stride),this.changed()}};const va={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},Dh=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",BU=Dh.includes("safari")&&!Dh.includes("chrom");BU&&(Dh.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(Dh));const UU=Dh.includes("webkit")&&!Dh.includes("edge"),m5=Dh.includes("macintosh"),zU=typeof devicePixelRatio<"u"?devicePixelRatio:1,qs=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,oI=typeof Image<"u"&&Image.prototype.decode,p5=typeof createImageBitmap=="function",y5=(function(){let n=!1;try{const e=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return n})(),vt={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function ni(n,e,t,r){let i;return t&&t.length?i=t.shift():qs?i=new class extends OffscreenCanvas{style={}}(n??300,e??150):i=document.createElement("canvas"),n&&(i.width=n),e&&(i.height=e),i.getContext("2d",r)}let T2;function ox(){return T2||(T2=ni(1,1)),T2}function Vv(n){const e=n.canvas;e.width=1,e.height=1,n.clearRect(0,0,1,1)}function Yk(n,e){const t=e.parentNode;t&&t.replaceChild(n,e)}function $U(n){for(;n.lastChild;)n.lastChild.remove()}function WU(n,e){const t=n.childNodes;for(let r=0;;++r){const i=t[r],s=e[r];if(!i&&!s)break;if(i!==s){if(!i){n.appendChild(s);continue}if(!s){n.removeChild(i),--r;continue}n.insertBefore(s,i)}}}function _5(){return new Proxy({childNodes:[],appendChild:function(e){return this.childNodes.push(e),e},remove:function(){},removeChild:function(e){const t=this.childNodes.indexOf(e);if(t===-1)throw new Error("Node to remove was not found");return this.childNodes.splice(t,1),e},insertBefore:function(e,t){const r=this.childNodes.indexOf(t);if(r===-1)throw new Error("Reference node not found");return this.childNodes.splice(r,0,e),e},style:{}},{get(e,t,r){return t==="firstElementChild"?e.childNodes.length>0?e.childNodes[0]:null:Reflect.get(e,t,r)}})}function Wc(n){return typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas}const lI=[NaN,NaN,NaN,0];let b2;function HU(){return b2||(b2=ni(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),b2}const KU=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,YU=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,qU=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,XU=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function By(n,e){return n.endsWith("%")?Number(n.substring(0,n.length-1))/e:Number(n)}function fm(n){throw new Error('failed to parse "'+n+'" as color')}function x5(n){if(n.toLowerCase().startsWith("rgb")){const s=n.match(YU)||n.match(KU)||n.match(qU);if(s){const a=s[4],o=100/255;return[ar(By(s[1],o)+.5|0,0,255),ar(By(s[2],o)+.5|0,0,255),ar(By(s[3],o)+.5|0,0,255),a!==void 0?ar(By(a,100),0,1):1]}fm(n)}if(n.startsWith("#")){if(XU.test(n)){const s=n.substring(1),a=s.length<=4?1:2,o=[0,0,0,255];for(let l=0,u=s.length;l<u;l+=a){let h=parseInt(s.substring(l,l+a),16);a===1&&(h+=h<<4),o[l/a]=h}return o[3]=o[3]/255,o}fm(n)}const e=HU();e.fillStyle="#abcdef";let t=e.fillStyle;e.fillStyle=n,e.fillStyle===t&&(e.fillStyle="#fedcba",t=e.fillStyle,e.fillStyle=n,e.fillStyle===t&&fm(n));const r=e.fillStyle;if(r.startsWith("#")||r.startsWith("rgba"))return x5(r);e.clearRect(0,0,1,1),e.fillRect(0,0,1,1);const i=Array.from(e.getImageData(0,0,1,1).data);return i[3]=Up(i[3]/255,3),i}function ZU(n){return typeof n=="string"?n:uI(n)}const QU=1024,Lg={};let I2=0;function JU(n){if(n.length===4)return n;const e=n.slice();return e[3]=1,e}function A2(n){return n>.0031308?Math.pow(n,1/2.4)*269.025-14.025:n*3294.6}function R2(n){return n>.2068965?Math.pow(n,3):(n-4/29)*(108/841)}function C2(n){return n>10.314724?Math.pow((n+14.025)/269.025,2.4):n/3294.6}function P2(n){return n>.0088564?Math.pow(n,1/3):n/(108/841)+4/29}function qk(n){const e=C2(n[0]),t=C2(n[1]),r=C2(n[2]),i=P2(e*.222488403+t*.716873169+r*.06060791),s=500*(P2(e*.452247074+t*.399439023+r*.148375274)-i),a=200*(i-P2(e*.016863605+t*.117638439+r*.865350722)),o=Math.atan2(a,s)*(180/Math.PI);return[116*i-16,Math.sqrt(s*s+a*a),o<0?o+360:o,n[3]]}function ez(n){const e=(n[0]+16)/116,t=n[1],r=n[2]*Math.PI/180,i=R2(e),s=R2(e+t/500*Math.cos(r)),a=R2(e-t/200*Math.sin(r)),o=A2(s*3.021973625-i*1.617392459-a*.404875592),l=A2(s*-.943766287+i*1.916279586+a*.027607165),u=A2(s*.069407491-i*.22898585+a*1.159737864);return[ar(o+.5|0,0,255),ar(l+.5|0,0,255),ar(u+.5|0,0,255),n[3]]}function cI(n){if(n==="none")return lI;if(Lg.hasOwnProperty(n))return Lg[n];if(I2>=QU){let t=0;for(const r in Lg)(t++&3)===0&&(delete Lg[r],--I2)}const e=x5(n);e.length!==4&&fm(n);for(const t of e)isNaN(t)&&fm(n);return Lg[n]=e,++I2,e}function Fh(n){return Array.isArray(n)?n:cI(n)}function uI(n){let e=n[0];e!=(e|0)&&(e=e+.5|0);let t=n[1];t!=(t|0)&&(t=t+.5|0);let r=n[2];r!=(r|0)&&(r=r+.5|0);const i=n[3]===void 0?1:Math.round(n[3]*1e3)/1e3;return"rgba("+e+","+t+","+r+","+i+")"}class v5 extends Vp{constructor(e,t,r,i){super(),this.extent=e,this.pixelRatio_=r,this.resolution=t,this.state=typeof i=="function"?vt.IDLE:i,this.image_=null,this.loader=typeof i=="function"?i:null}changed(){this.dispatchEvent(Yt.CHANGE)}getExtent(){return this.extent}getImage(){return this.image_}getPixelRatio(){return this.pixelRatio_}getResolution(){return this.resolution}getState(){return this.state}load(){if(this.state==vt.IDLE&&this.loader){this.state=vt.LOADING,this.changed();const e=this.getResolution(),t=Array.isArray(e)?e[0]:e;VO(()=>this.loader(this.getExtent(),t,this.getPixelRatio())).then(r=>{"image"in r&&(this.image_=r.image),"extent"in r&&(this.extent=r.extent),"resolution"in r&&(this.resolution=r.resolution),"pixelRatio"in r&&(this.pixelRatio_=r.pixelRatio),(r instanceof HTMLImageElement||p5&&r instanceof ImageBitmap||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement)&&(this.image_=r),this.state=vt.LOADED}).catch(r=>{this.state=vt.ERROR,console.error(r)}).finally(()=>this.changed())}}setImage(e){this.image_=e}setResolution(e){this.resolution=e}}function tz(n,e,t){const r=n;let i=!0,s=!1,a=!1;const o=[Q_(r,Yt.LOAD,function(){a=!0,s||e()})];return r.src&&oI?(s=!0,r.decode().then(function(){i&&e()}).catch(function(l){i&&(a?e():t())})):o.push(Q_(r,Yt.ERROR,t)),function(){i=!1,o.forEach(tr)}}function nz(n,e){return new Promise((t,r)=>{function i(){a(),t(n)}function s(){a(),r(new Error("Image load error"))}function a(){n.removeEventListener("load",i),n.removeEventListener("error",s)}n.addEventListener("load",i),n.addEventListener("error",s)})}function w5(n,e){return e&&(n.src=e),n.src&&oI?new Promise((t,r)=>n.decode().then(()=>t(n)).catch(i=>n.complete&&n.width?t(n):r(i))):nz(n)}function E5(n,e){return e&&(n.src=e),n.src&&oI&&p5?n.decode().then(()=>createImageBitmap(n)).catch(t=>{if(n.complete&&n.width)return n;throw t}):w5(n)}class rz{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let e=0;for(const t in this.cache_){const r=this.cache_[t];(e++&3)===0&&!r.hasListener()&&(delete this.cache_[t],delete this.patternCache_[t],--this.cacheSize_)}}}get(e,t,r){const i=k2(e,t,r);return i in this.cache_?this.cache_[i]:null}getPattern(e,t,r){const i=k2(e,t,r);return i in this.patternCache_?this.patternCache_[i]:null}set(e,t,r,i,s){const a=k2(e,t,r),o=a in this.cache_;this.cache_[a]=i,s&&(i.getImageState()===vt.IDLE&&i.load(),i.getImageState()===vt.LOADING?i.ready().then(()=>{this.patternCache_[a]=ox().createPattern(i.getImage(1),"repeat")}):this.patternCache_[a]=ox().createPattern(i.getImage(1),"repeat")),o||++this.cacheSize_}setSize(e){this.maxCacheSize_=e,this.expire()}}function k2(n,e,t){const r=t?Fh(t):"null";return e+":"+n+":"+r}const wa=new rz;let Og=null;class S5 extends Vp{constructor(e,t,r,i,s){super(),this.hitDetectionImage_=null,this.image_=e,this.crossOrigin_=r,this.canvas_={},this.color_=s,this.imageState_=i===void 0?vt.IDLE:i,this.size_=e&&e.width&&e.height?[e.width,e.height]:null,this.src_=t,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===vt.LOADED){Og||(Og=ni(1,1,void 0,{willReadFrequently:!0})),Og.drawImage(this.image_,0,0);try{Og.getImageData(0,0,1,1),this.tainted_=!1}catch{Og=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(Yt.CHANGE)}handleImageError_(){this.imageState_=vt.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=vt.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}getPixelRatio(e){return this.replaceColor_(e),this.canvas_[e]?e:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const e=this.size_[0],t=this.size_[1],r=ni(e,t);r.fillRect(0,0,e,t),this.hitDetectionImage_=r.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===vt.IDLE){this.image_||this.initializeImage_(),this.imageState_=vt.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&w5(this.image_,this.src_).then(e=>{this.image_=e,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(e){if(!this.color_||this.canvas_[e]||this.imageState_!==vt.LOADED)return;const t=this.image_,r=ni(Math.ceil(t.width*e),Math.ceil(t.height*e)),i=r.canvas;r.scale(e,e),r.drawImage(t,0,0),r.globalCompositeOperation="multiply",r.fillStyle=ZU(this.color_),r.fillRect(0,0,i.width/e,i.height/e),r.globalCompositeOperation="destination-in",r.drawImage(t,0,0),this.canvas_[e]=i}ready(){return this.ready_||(this.ready_=new Promise(e=>{if(this.imageState_===vt.LOADED||this.imageState_===vt.ERROR)e();else{const t=()=>{(this.imageState_===vt.LOADED||this.imageState_===vt.ERROR)&&(this.removeEventListener(Yt.CHANGE,t),e())};this.addEventListener(Yt.CHANGE,t)}})),this.ready_}}function lx(n,e,t,r,i,s){let a=e===void 0?void 0:wa.get(e,t,i);return a||(a=new S5(n,n&&"src"in n?n.src||void 0:e,t,r,i),wa.set(e,t,i,a,s)),s&&a&&!wa.getPattern(e,t,i)&&wa.set(e,t,i,a,s),a}function Lo(n){return n?Array.isArray(n)?uI(n):typeof n=="object"&&"src"in n?iz(n):n:null}function iz(n){if(!n.offset||!n.size)return wa.getPattern(n.src,"anonymous",n.color);const e=n.src+":"+n.offset,t=wa.getPattern(e,void 0,n.color);if(t)return t;const r=wa.get(n.src,"anonymous",null);if(r.getImageState()!==vt.LOADED)return null;const i=ni(n.size[0],n.size[1]);return i.drawImage(r.getImage(1),n.offset[0],n.offset[1],n.size[0],n.size[1],0,0,n.size[0],n.size[1]),lx(i.canvas,e,void 0,vt.LOADED,n.color,!0),wa.getPattern(e,void 0,n.color)}class T5{drawCustom(e,t,r,i,s){}drawGeometry(e){}setStyle(e){}drawCircle(e,t,r){}drawFeature(e,t,r){}drawGeometryCollection(e,t,r){}drawLineString(e,t,r){}drawMultiLineString(e,t,r){}drawMultiPoint(e,t,r){}drawMultiPolygon(e,t,r){}drawPoint(e,t,r){}drawPolygon(e,t,r){}drawText(e,t,r){}setFillStrokeStyle(e,t){}setImageStyle(e,t){}setTextStyle(e,t){}}const Uy="ol-hidden",Hp="ol-unselectable",hI="ol-control",Xk="ol-collapsed",sz=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),Zk=["style","variant","weight","size","lineHeight","family"],oT={normal:400,bold:700},lT=function(n){const e=n.match(sz);if(!e)return null;const t={lineHeight:"normal",size:"1.2em",style:"normal",weight:"400",variant:"normal"};for(let r=0,i=Zk.length;r<i;++r){const s=e[r+1];s!==void 0&&(t[Zk[r]]=typeof s=="string"?s.trim():s)}return isNaN(Number(t.weight))&&t.weight in oT&&(t.weight=oT[t.weight]),t.families=t.family.split(/,\s?/).map(r=>r.trim().replace(/^['"]|['"]$/g,"")),t},b5="10px sans-serif",ws="#000",u0="round",Ml=[],Nl=0,h0="round",Ym=10,qm="#000",Xm="center",cx="middle",_h=[0,0,0,0],Zm=1,_f=new tl;let Dg=null,Qk;const cT={},az=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"]);function oz(n,e,t){return`${n} ${e} 16px "${t}"`}const lz=(function(){let e,t;async function r(s){await t.ready;const a=await t.load(s);if(a.length===0)return!1;const o=lT(s),l=o.families[0].toLowerCase(),u=o.weight;return a.some(h=>{const f=h.family.replace(/^['"]|['"]$/g,"").toLowerCase(),g=oT[h.weight]||h.weight;return f===l&&h.style===o.style&&g==u})}async function i(){await t.ready;let s=!0;const a=_f.getProperties(),o=Object.keys(a).filter(l=>a[l]<100);for(let l=o.length-1;l>=0;--l){const u=o[l];let h=a[u];h<100&&(await r(u)?(jp(cT),_f.set(u,100)):(h+=10,_f.set(u,h,!0),h<100&&(s=!1)))}e=void 0,s||(e=setTimeout(i,100))}return async function(s){t||(t=qs?self.fonts:document.fonts);const a=lT(s);if(!a)return;const o=a.families;let l=!1;for(const u of o){if(az.has(u))continue;const h=oz(a.style,a.weight,u);_f.get(h)===void 0&&(_f.set(h,0,!0),l=!0)}l&&(clearTimeout(e),e=setTimeout(i,100))}})(),cz=(function(){let n;return function(e){let t=cT[e];if(t==null){if(qs){const r=lT(e),i=I5(e,"g");t=(isNaN(Number(r.lineHeight))?1.2:Number(r.lineHeight))*(i.actualBoundingBoxAscent+i.actualBoundingBoxDescent)}else n||(n=document.createElement("div"),n.innerHTML="M",n.style.minHeight="0",n.style.maxHeight="none",n.style.height="auto",n.style.padding="0",n.style.border="none",n.style.position="absolute",n.style.display="block",n.style.left="-99999px"),n.style.font=e,document.body.appendChild(n),t=n.offsetHeight,document.body.removeChild(n);cT[e]=t}return t}})();function I5(n,e){return Dg||(Dg=ni(1,1)),n!=Qk&&(Dg.font=n,Qk=Dg.font),Dg.measureText(e)}function A5(n,e){return I5(n,e).width}function Jk(n,e,t){if(e in t)return t[e];const r=e.split(`
`).reduce((i,s)=>Math.max(i,A5(n,s)),0);return t[e]=r,r}function uz(n,e){const t=[],r=[],i=[];let s=0,a=0,o=0,l=0;for(let u=0,h=e.length;u<=h;u+=2){const f=e[u];if(f===`
`||u===h){s=Math.max(s,a),i.push(a),a=0,o+=l,l=0;continue}const g=e[u+1]||n.font,y=A5(g,f);t.push(y),a+=y;const v=cz(g);r.push(v),l=Math.max(l,v)}return{width:s,height:o,widths:t,heights:r,lineWidths:i}}function hz(n,e,t,r,i,s,a,o,l,u,h){n.save(),t!==1&&(n.globalAlpha===void 0?n.globalAlpha=f=>f.globalAlpha*=t:n.globalAlpha*=t),e&&n.transform.apply(n,e),r.contextInstructions?(n.translate(l,u),n.scale(h[0],h[1]),dz(r,n)):h[0]<0||h[1]<0?(n.translate(l,u),n.scale(h[0],h[1]),n.drawImage(r,i,s,a,o,0,0,a,o)):n.drawImage(r,i,s,a,o,l,u,a*h[0],o*h[1]),n.restore()}function dz(n,e){const t=n.contextInstructions;for(let r=0,i=t.length;r<i;r+=2)Array.isArray(t[r+1])?e[t[r]].apply(e,t[r+1]):e[t[r]]=t[r+1]}class fz extends T5{constructor(e,t,r,i,s,a,o){super(),this.context_=e,this.pixelRatio_=t,this.extent_=r,this.transform_=i,this.transformRotation_=i?Up(Math.atan2(i[1],i[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=a,this.userTransform_=o,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=Qa()}drawImages_(e,t,r,i){if(!this.image_)return;const s=eu(e,t,r,i,this.transform_,this.pixelCoordinates_),a=this.context_,o=this.tmpLocalTransform_,l=a.globalAlpha;this.imageOpacity_!=1&&(a.globalAlpha=l*this.imageOpacity_);let u=this.imageRotation_;this.transformRotation_===0&&(u-=this.viewRotation_),this.imageRotateWithView_&&(u+=this.viewRotation_);for(let h=0,f=s.length;h<f;h+=2){const g=s[h]-this.imageAnchorX_,y=s[h+1]-this.imageAnchorY_;if(u!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const v=g+this.imageAnchorX_,x=y+this.imageAnchorY_;Ko(o,v,x,1,1,u,-v,-x),a.save(),a.transform.apply(a,o),a.translate(v,x),a.scale(this.imageScale_[0],this.imageScale_[1]),a.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),a.restore()}else a.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,g,y,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(a.globalAlpha=l)}drawText_(e,t,r,i){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=eu(e,t,r,i,this.transform_,this.pixelCoordinates_),a=this.context_;let o=this.textRotation_;for(this.transformRotation_===0&&(o-=this.viewRotation_),this.textRotateWithView_&&(o+=this.viewRotation_);t<r;t+=i){const l=s[t]+this.textOffsetX_,u=s[t+1]+this.textOffsetY_;o!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(a.save(),a.translate(l-this.textOffsetX_,u-this.textOffsetY_),a.rotate(o),a.translate(this.textOffsetX_,this.textOffsetY_),a.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&a.strokeText(this.text_,0,0),this.textFillState_&&a.fillText(this.text_,0,0),a.restore()):(this.textStrokeState_&&a.strokeText(this.text_,l,u),this.textFillState_&&a.fillText(this.text_,l,u))}}moveToLineTo_(e,t,r,i,s){const a=this.context_,o=eu(e,t,r,i,this.transform_,this.pixelCoordinates_);a.moveTo(o[0],o[1]);let l=o.length;s&&(l-=2);for(let u=2;u<l;u+=2)a.lineTo(o[u],o[u+1]);return s&&a.closePath(),r}drawRings_(e,t,r,i){for(let s=0,a=r.length;s<a;++s)t=this.moveToLineTo_(e,t,r[s],i,!0);return t}drawCircle(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!as(this.extent_,e.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=PU(e,this.transform_,this.pixelCoordinates_),r=t[2]-t[0],i=t[3]-t[1],s=Math.sqrt(r*r+i*i),a=this.context_;a.beginPath(),a.arc(t[0],t[1],s,0,2*Math.PI),this.fillState_&&a.fill(),this.strokeState_&&a.stroke()}this.text_!==""&&this.drawText_(e.getCenter(),0,2,2)}}setStyle(e){this.setFillStrokeStyle(e.getFill(),e.getStroke()),this.setImageStyle(e.getImage()),this.setTextStyle(e.getText())}setTransform(e){this.transform_=e}drawGeometry(e){switch(e.getType()){case"Point":this.drawPoint(e);break;case"LineString":this.drawLineString(e);break;case"Polygon":this.drawPolygon(e);break;case"MultiPoint":this.drawMultiPoint(e);break;case"MultiLineString":this.drawMultiLineString(e);break;case"MultiPolygon":this.drawMultiPolygon(e);break;case"GeometryCollection":this.drawGeometryCollection(e);break;case"Circle":this.drawCircle(e);break}}drawFeature(e,t){const r=t.getGeometryFunction()(e);r&&(this.setStyle(t),this.drawGeometry(r))}drawGeometryCollection(e){const t=e.getGeometriesArray();for(let r=0,i=t.length;r<i;++r)this.drawGeometry(t[r])}drawPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),r=e.getStride();this.image_&&this.drawImages_(t,0,t.length,r),this.text_!==""&&this.drawText_(t,0,t.length,r)}drawMultiPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),r=e.getStride();this.image_&&this.drawImages_(t,0,t.length,r),this.text_!==""&&this.drawText_(t,0,t.length,r)}drawLineString(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!as(this.extent_,e.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const t=this.context_,r=e.getFlatCoordinates();t.beginPath(),this.moveToLineTo_(r,0,r.length,e.getStride(),!1),t.stroke()}if(this.text_!==""){const t=e.getFlatMidpoint();this.drawText_(t,0,2,2)}}}drawMultiLineString(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getExtent();if(as(this.extent_,t)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const r=this.context_,i=e.getFlatCoordinates();let s=0;const a=e.getEnds(),o=e.getStride();r.beginPath();for(let l=0,u=a.length;l<u;++l)s=this.moveToLineTo_(i,s,a[l],o,!1);r.stroke()}if(this.text_!==""){const r=e.getFlatMidpoints();this.drawText_(r,0,r.length,2)}}}drawPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!as(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_;t.beginPath(),this.drawRings_(e.getOrientedFlatCoordinates(),0,e.getEnds(),e.getStride()),this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoint();this.drawText_(t,0,2,2)}}}drawMultiPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!as(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_,r=e.getOrientedFlatCoordinates();let i=0;const s=e.getEndss(),a=e.getStride();t.beginPath();for(let o=0,l=s.length;o<l;++o){const u=s[o];i=this.drawRings_(r,i,u,a)}this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoints();this.drawText_(t,0,t.length,2)}}}setContextFillState_(e){const t=this.context_,r=this.contextFillState_;r?r.fillStyle!=e.fillStyle&&(r.fillStyle=e.fillStyle,t.fillStyle=e.fillStyle):(t.fillStyle=e.fillStyle,this.contextFillState_={fillStyle:e.fillStyle})}setContextStrokeState_(e){const t=this.context_,r=this.contextStrokeState_;r?(r.lineCap!=e.lineCap&&(r.lineCap=e.lineCap,t.lineCap=e.lineCap),Su(r.lineDash,e.lineDash)||t.setLineDash(r.lineDash=e.lineDash),r.lineDashOffset!=e.lineDashOffset&&(r.lineDashOffset=e.lineDashOffset,t.lineDashOffset=e.lineDashOffset),r.lineJoin!=e.lineJoin&&(r.lineJoin=e.lineJoin,t.lineJoin=e.lineJoin),r.lineWidth!=e.lineWidth&&(r.lineWidth=e.lineWidth,t.lineWidth=e.lineWidth),r.miterLimit!=e.miterLimit&&(r.miterLimit=e.miterLimit,t.miterLimit=e.miterLimit),r.strokeStyle!=e.strokeStyle&&(r.strokeStyle=e.strokeStyle,t.strokeStyle=e.strokeStyle)):(t.lineCap=e.lineCap,t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset,t.lineJoin=e.lineJoin,t.lineWidth=e.lineWidth,t.miterLimit=e.miterLimit,t.strokeStyle=e.strokeStyle,this.contextStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle})}setContextTextState_(e){const t=this.context_,r=this.contextTextState_,i=e.textAlign?e.textAlign:Xm;r?(r.font!=e.font&&(r.font=e.font,t.font=e.font),r.textAlign!=i&&(r.textAlign=i,t.textAlign=i),r.textBaseline!=e.textBaseline&&(r.textBaseline=e.textBaseline,t.textBaseline=e.textBaseline)):(t.font=e.font,t.textAlign=i,t.textBaseline=e.textBaseline,this.contextTextState_={font:e.font,textAlign:i,textBaseline:e.textBaseline})}setFillStrokeStyle(e,t){if(!e)this.fillState_=null;else{const r=e.getColor();this.fillState_={fillStyle:Lo(r||ws)}}if(!t)this.strokeState_=null;else{const r=t.getColor(),i=t.getLineCap(),s=t.getLineDash(),a=t.getLineDashOffset(),o=t.getLineJoin(),l=t.getWidth(),u=t.getMiterLimit(),h=s||Ml;this.strokeState_={lineCap:i!==void 0?i:u0,lineDash:this.pixelRatio_===1?h:h.map(f=>f*this.pixelRatio_),lineDashOffset:(a||Nl)*this.pixelRatio_,lineJoin:o!==void 0?o:h0,lineWidth:(l!==void 0?l:Zm)*this.pixelRatio_,miterLimit:u!==void 0?u:Ym,strokeStyle:Lo(r||qm)}}}setImageStyle(e){let t;if(!e||!(t=e.getSize())){this.image_=null;return}const r=e.getPixelRatio(this.pixelRatio_),i=e.getAnchor(),s=e.getOrigin();this.image_=e.getImage(this.pixelRatio_),this.imageAnchorX_=i[0]*r,this.imageAnchorY_=i[1]*r,this.imageHeight_=t[1]*r,this.imageOpacity_=e.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=e.getRotateWithView(),this.imageRotation_=e.getRotation();const a=e.getScaleArray();this.imageScale_=[a[0]*this.pixelRatio_/r,a[1]*this.pixelRatio_/r],this.imageWidth_=t[0]*r}setTextStyle(e){if(!e)this.text_="";else{const t=e.getFill();if(!t)this.textFillState_=null;else{const y=t.getColor();this.textFillState_={fillStyle:Lo(y||ws)}}const r=e.getStroke();if(!r)this.textStrokeState_=null;else{const y=r.getColor(),v=r.getLineCap(),x=r.getLineDash(),E=r.getLineDashOffset(),T=r.getLineJoin(),b=r.getWidth(),I=r.getMiterLimit();this.textStrokeState_={lineCap:v!==void 0?v:u0,lineDash:x||Ml,lineDashOffset:E||Nl,lineJoin:T!==void 0?T:h0,lineWidth:b!==void 0?b:Zm,miterLimit:I!==void 0?I:Ym,strokeStyle:Lo(y||qm)}}const i=e.getFont(),s=e.getOffsetX(),a=e.getOffsetY(),o=e.getRotateWithView(),l=e.getRotation(),u=e.getScaleArray(),h=e.getText(),f=e.getTextAlign(),g=e.getTextBaseline();this.textState_={font:i!==void 0?i:b5,textAlign:f!==void 0?f:Xm,textBaseline:g!==void 0?g:cx},this.text_=h!==void 0?Array.isArray(h)?h.reduce((y,v,x)=>y+=x%2?" ":v,""):h:"",this.textOffsetX_=s!==void 0?this.pixelRatio_*s:0,this.textOffsetY_=a!==void 0?this.pixelRatio_*a:0,this.textRotateWithView_=o!==void 0?o:!1,this.textRotation_=l!==void 0?l:0,this.textScale_=[this.pixelRatio_*u[0],this.pixelRatio_*u[1]]}}}const gz=.5,R5={Point:Ez,LineString:xz,Polygon:Tz,MultiPoint:Sz,MultiLineString:vz,MultiPolygon:wz,GeometryCollection:_z,Circle:pz};function mz(n,e){return parseInt(bn(n),10)-parseInt(bn(e),10)}function e4(n,e){const t=C5(n,e);return t*t}function C5(n,e){return gz*n/e}function pz(n,e,t,r,i){const s=t.getFill(),a=t.getStroke();if(s||a){const l=n.getBuilder(t.getZIndex(),"Circle");l.setFillStrokeStyle(s,a),l.drawCircle(e,r,i)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,r)}}function t4(n,e,t,r,i,s,a,o){const l=[],u=t.getImage();if(u){let g=!0;const y=u.getImageState();y==vt.LOADED||y==vt.ERROR?g=!1:y==vt.IDLE&&u.load(),g&&l.push(u.ready())}const h=t.getFill();h&&h.loading()&&l.push(h.ready());const f=l.length>0;return f&&Promise.all(l).then(()=>i(null)),yz(n,e,t,r,s,a,o),f}function yz(n,e,t,r,i,s,a){const o=t.getGeometryFunction()(e);if(!o)return;const l=o.simplifyTransformed(r,i);if(t.getRenderer())P5(n,l,t,e,a);else{const h=R5[l.getType()];h(n,l,t,e,a,s)}}function P5(n,e,t,r,i){if(e.getType()=="GeometryCollection"){const a=e.getGeometries();for(let o=0,l=a.length;o<l;++o)P5(n,a[o],t,r,i);return}n.getBuilder(t.getZIndex(),"Default").drawCustom(e,r,t.getRenderer(),t.getHitDetectionRenderer(),i)}function _z(n,e,t,r,i,s){const a=e.getGeometriesArray();let o,l;for(o=0,l=a.length;o<l;++o){const u=R5[a[o].getType()];u(n,a[o],t,r,i,s)}}function xz(n,e,t,r,i){const s=t.getStroke();if(s){const o=n.getBuilder(t.getZIndex(),"LineString");o.setFillStrokeStyle(null,s),o.drawLineString(e,r,i)}const a=t.getText();if(a&&a.getText()){const o=n.getBuilder(t.getZIndex(),"Text");o.setTextStyle(a),o.drawText(e,r,i)}}function vz(n,e,t,r,i){const s=t.getStroke();if(s){const o=n.getBuilder(t.getZIndex(),"LineString");o.setFillStrokeStyle(null,s),o.drawMultiLineString(e,r,i)}const a=t.getText();if(a&&a.getText()){const o=n.getBuilder(t.getZIndex(),"Text");o.setTextStyle(a),o.drawText(e,r,i)}}function wz(n,e,t,r,i){const s=t.getFill(),a=t.getStroke();if(a||s){const l=n.getBuilder(t.getZIndex(),"Polygon");l.setFillStrokeStyle(s,a),l.drawMultiPolygon(e,r,i)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,r,i)}}function Ez(n,e,t,r,i,s){const a=t.getImage(),o=t.getText(),l=o&&o.getText(),u=s&&a&&l?{}:void 0;if(a){if(a.getImageState()!=vt.LOADED)return;const h=n.getBuilder(t.getZIndex(),"Image");h.setImageStyle(a,u),h.drawPoint(e,r,i)}if(l){const h=n.getBuilder(t.getZIndex(),"Text");h.setTextStyle(o,u),h.drawText(e,r,i)}}function Sz(n,e,t,r,i,s){const a=t.getImage(),o=a&&a.getOpacity()!==0,l=t.getText(),u=l&&l.getText(),h=s&&o&&u?{}:void 0;if(o){if(a.getImageState()!=vt.LOADED)return;const f=n.getBuilder(t.getZIndex(),"Image");f.setImageStyle(a,h),f.drawMultiPoint(e,r,i)}if(u){const f=n.getBuilder(t.getZIndex(),"Text");f.setTextStyle(l,h),f.drawText(e,r,i)}}function Tz(n,e,t,r,i){const s=t.getFill(),a=t.getStroke();if(s||a){const l=n.getBuilder(t.getZIndex(),"Polygon");l.setFillStrokeStyle(s,a),l.drawPolygon(e,r,i)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,r,i)}}let bz=!1;function Iz(n,e,t,r,i,s,a){const o=new XMLHttpRequest;o.open("GET",typeof n=="function"?n(t,r,i):n,!0),e.getType()=="arraybuffer"&&(o.responseType="arraybuffer"),o.withCredentials=bz,o.onload=function(l){if(!o.status||o.status>=200&&o.status<300){const u=e.getType();try{let h;u=="text"||u=="json"?h=o.responseText:u=="xml"?h=o.responseXML||o.responseText:u=="arraybuffer"&&(h=o.response),h?s(e.readFeatures(h,{extent:t,featureProjection:i}),e.readProjection(h)):a()}catch{a()}}else a()},o.onerror=a,o.send()}function n4(n,e){return function(t,r,i,s,a){Iz(n,e,t,r,i,(o,l)=>{this.addFeatures(o),s!==void 0&&s(o)},()=>{this.changed(),a!==void 0&&a()})}}function Az(n,e){return[[-1/0,-1/0,1/0,1/0]]}function k5(n,e,t,r){const i=[];let s=Qs();for(let a=0,o=t.length;a<o;++a){const l=t[a];s=Kb(n,e,l[0],r),i.push((s[0]+s[2])/2,(s[1]+s[3])/2),e=l[l.length-1]}return i}function dI(n,e,t,r,i,s,a){let o,l,u,h,f,g,y;const v=i[s+1],x=[];for(let b=0,I=t.length;b<I;++b){const M=t[b];for(h=n[M-r],g=n[M-r+1],o=e;o<M;o+=r)f=n[o],y=n[o+1],(v<=g&&y<=v||g<=v&&v<=y)&&(u=(v-g)/(y-g)*(f-h)+h,x.push(u)),h=f,g=y}let E=NaN,T=-1/0;for(x.sort(Cl),h=x[0],o=1,l=x.length;o<l;++o){f=x[o];const b=Math.abs(f-h);b>T&&(u=(h+f)/2,iI(n,e,t,r,u,v)&&(E=u,T=b)),h=f}return isNaN(E)&&(E=i[s]),a?(a.push(E,v,T),a):[E,v,T]}function M5(n,e,t,r,i){let s=[];for(let a=0,o=t.length;a<o;++a){const l=t[a];s=dI(n,e,l,r,i,2*a,s),e=l[l.length-1]}return s}function Rz(n,e,t,r){for(;e<t-r;){for(let i=0;i<r;++i){const s=n[e+i];n[e+i]=n[t-r+i],n[t-r+i]=s}e+=r,t-=r}}function fI(n,e,t,r){let i=0,s=n[t-r],a=n[t-r+1];for(;e<t;e+=r){const o=n[e],l=n[e+1];i+=(o-s)*(l+a),s=o,a=l}return i===0?void 0:i>0}function gI(n,e,t,r,i){i=i!==void 0?i:!1;for(let s=0,a=t.length;s<a;++s){const o=t[s],l=fI(n,e,o,r);if(s===0){if(i&&l||!i&&!l)return!1}else if(i&&!l||!i&&l)return!1;e=o}return!0}function N5(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){const o=t[s];if(!gI(n,e,o,r,i))return!1;o.length&&(e=o[o.length-1])}return!0}function ux(n,e,t,r,i){i=i!==void 0?i:!1;for(let s=0,a=t.length;s<a;++s){const o=t[s],l=fI(n,e,o,r);(s===0?i&&l||!i&&!l:i&&!l||!i&&l)&&Rz(n,e,o,r),e=o}return e}function uT(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s)e=ux(n,e,t[s],r,i);return e}function Cz(n,e){const t=[];let r=0,i=0,s;for(let a=0,o=e.length;a<o;++a){const l=e[a],u=fI(n,r,l,2);if(s===void 0&&(s=u),u===s)t.push(e.slice(i,a+1));else{if(t.length===0)continue;t[t.length-1].push(e[i])}i=a+1,r=l}return t}class Ja extends l5{constructor(e){super(),this.geometries_=e,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(tr),this.changeEventsKeys_.length=0}listenGeometriesChange_(){const e=this.geometries_;for(let t=0,r=e.length;t<r;++t)this.changeEventsKeys_.push(yn(e[t],Yt.CHANGE,this.changed,this))}clone(){const e=new Ja(M2(this.geometries_));return e.applyProperties(this),e}closestPointXY(e,t,r,i){if(i<id(this.getExtent(),e,t))return i;const s=this.geometries_;for(let a=0,o=s.length;a<o;++a)i=s[a].closestPointXY(e,t,r,i);return i}containsXY(e,t){const r=this.geometries_;for(let i=0,s=r.length;i<s;++i)if(r[i].containsXY(e,t))return!0;return!1}computeExtent(e){Bp(e);const t=this.geometries_;for(let r=0,i=t.length;r<i;++r)zO(e,t[r].getExtent());return e}getGeometries(){return M2(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let e=[];const t=this.geometries_;for(let r=0,i=t.length;r<i;++r)t[r].getType()===this.getType()?e=e.concat(t[r].getGeometriesArrayRecursive()):e.push(t[r]);return e}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=[],r=this.geometries_;let i=!1;for(let s=0,a=r.length;s<a;++s){const o=r[s],l=o.getSimplifiedGeometry(e);t.push(l),l!==o&&(i=!0)}return i?new Ja(t):(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getType(){return"GeometryCollection"}intersectsExtent(e){const t=this.geometries_;for(let r=0,i=t.length;r<i;++r)if(t[r].intersectsExtent(e))return!0;return!1}isEmpty(){return this.geometries_.length===0}rotate(e,t){const r=this.geometries_;for(let i=0,s=r.length;i<s;++i)r[i].rotate(e,t);this.changed()}scale(e,t,r){r||(r=Wo(this.getExtent()));const i=this.geometries_;for(let s=0,a=i.length;s<a;++s)i[s].scale(e,t,r);this.changed()}setGeometries(e){this.setGeometriesArray(M2(e))}setGeometriesArray(e){this.unlistenGeometriesChange_(),this.geometries_=e,this.listenGeometriesChange_(),this.changed()}applyTransform(e){const t=this.geometries_;for(let r=0,i=t.length;r<i;++r)t[r].applyTransform(e);this.changed()}translate(e,t){const r=this.geometries_;for(let i=0,s=r.length;i<s;++i)r[i].translate(e,t);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function M2(n){return n.map(e=>e.clone())}function L5(n,e,t,r){let i=0;const s=n[t-r],a=n[t-r+1];let o=0,l=0;for(;e<t;e+=r){const u=n[e]-s,h=n[e+1]-a;i+=l*u-o*h,o=u,l=h}return i/2}function O5(n,e,t,r){let i=0;for(let s=0,a=t.length;s<a;++s){const o=t[s];i+=L5(n,e,o,r),e=o}return i}function Pz(n,e,t,r){let i=0;for(let s=0,a=t.length;s<a;++s){const o=t[s];i+=O5(n,e,o,r),e=o[o.length-1]}return i}class Qm extends ad{constructor(e,t){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}clone(){return new Qm(this.flatCoordinates.slice(),this.layout)}closestPointXY(e,t,r,i){return i<id(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(eI(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),nI(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,t,r,i))}getArea(){return L5(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return $c(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(e){const t=[];return t.length=jv(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new Qm(t,"XY")}getType(){return"LinearRing"}intersectsExtent(e){return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Dv(this.flatCoordinates,0,e,this.stride),this.changed()}}class Vl extends ad{constructor(e,t,r){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(e[0]))this.setCoordinates(e,t);else if(t!==void 0&&r)this.setFlatCoordinates(t,e),this.ends_=r;else{const i=e,s=[],a=[];for(let l=0,u=i.length;l<u;++l){const h=i[l];Nn(s,h.getFlatCoordinates()),a.push(s.length)}const o=i.length===0?this.getLayout():i[0].getLayout();this.setFlatCoordinates(o,s),this.ends_=a}}appendLineString(e){Nn(this.flatCoordinates,e.getFlatCoordinates().slice()),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new Vl(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,r,i){return i<id(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(tI(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),rI(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,e,t,r,i))}getCoordinateAtM(e,t,r){return this.layout!="XYM"&&this.layout!="XYZM"||this.flatCoordinates.length===0?null:(t=t!==void 0?t:!1,r=r!==void 0?r:!1,LU(this.flatCoordinates,0,this.ends_,this.stride,e,t,r))}getCoordinates(){return Km(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(e){return e<0||this.ends_.length<=e?null:new so(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLineStrings(){const e=this.flatCoordinates,t=this.ends_,r=this.layout,i=[];let s=0;for(let a=0,o=t.length;a<o;++a){const l=t[a],u=new so(e.slice(s,l),r);i.push(u),s=l}return i}getLength(){const e=this.ends_;let t=0,r=0;for(let i=0,s=e.length;i<s;++i)r+=sI(this.flatCoordinates,t,e[i],this.stride),t=e[i];return r}getFlatMidpoints(){const e=[],t=this.flatCoordinates;let r=0;const i=this.ends_,s=this.stride;for(let a=0,o=i.length;a<o;++a){const l=i[a],u=ax(t,r,l,s,.5);Nn(e,u),r=l}return e}getSimplifiedGeometryInternal(e){const t=[],r=[];return t.length=f5(this.flatCoordinates,0,this.ends_,this.stride,e,t,0,r),new Vl(t,"XY",r)}getType(){return"MultiLineString"}intersectsExtent(e){return FU(this.flatCoordinates,0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const r=Wp(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=r.length===0?0:r[r.length-1],this.changed()}}class ld extends ad{constructor(e,t){super(),t&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}appendPoint(e){Nn(this.flatCoordinates,e.getFlatCoordinates()),this.changed()}clone(){const e=new ld(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,r,i){if(i<id(this.getExtent(),e,t))return i;const s=this.flatCoordinates,a=this.stride;for(let o=0,l=s.length;o<l;o+=a){const u=bh(e,t,s[o],s[o+1]);if(u<i){i=u;for(let h=0;h<a;++h)r[h]=s[o+h];r.length=a}}return i}getCoordinates(){return $c(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(e){const t=this.flatCoordinates.length/this.stride;return e<0||t<=e?null:new Js(this.flatCoordinates.slice(e*this.stride,(e+1)*this.stride),this.layout)}getPoints(){const e=this.flatCoordinates,t=this.layout,r=this.stride,i=[];for(let s=0,a=e.length;s<a;s+=r){const o=new Js(e.slice(s,s+r),t);i.push(o)}return i}getType(){return"MultiPoint"}intersectsExtent(e){const t=this.flatCoordinates,r=this.stride;for(let i=0,s=t.length;i<s;i+=r){const a=t[i],o=t[i+1];if(Hb(e,a,o))return!0}return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Dv(this.flatCoordinates,0,e,this.stride),this.changed()}}class Ia extends ad{constructor(e,t,r){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,t!==void 0&&r?(this.setFlatCoordinates(t,e),this.ends_=r):this.setCoordinates(e,t)}appendLinearRing(e){this.flatCoordinates?Nn(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new Ia(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,r,i){return i<id(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(tI(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),rI(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,t,r,i))}containsXY(e,t){return iI(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,t)}getArea(){return O5(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),ux(t,0,this.ends_,this.stride,e)):t=this.flatCoordinates,Km(t,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const e=Wo(this.getExtent());this.flatInteriorPoint_=dI(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new Js(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(e){return e<0||this.ends_.length<=e?null:new Qm(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLinearRings(){const e=this.layout,t=this.flatCoordinates,r=this.ends_,i=[];let s=0;for(let a=0,o=r.length;a<o;++a){const l=r[a],u=new Qm(t.slice(s,l),e);i.push(u),s=l}return i}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;gI(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=ux(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],r=[];return t.length=aI(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(e),t,0,r),new Ia(t,"XY",r)}getType(){return"Polygon"}intersectsExtent(e){return d5(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const r=Wp(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=r.length===0?0:r[r.length-1],this.changed()}}function r4(n){if(N0(n))throw new Error("Cannot create polygon from empty extent");const e=n[0],t=n[1],r=n[2],i=n[3],s=[e,t,e,i,r,i,r,t,e,t];return new Ia(s,"XY",[s.length])}class jh extends ad{constructor(e,t,r){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!r&&!Array.isArray(e[0])){const i=e,s=[],a=[];for(let o=0,l=i.length;o<l;++o){const u=i[o],h=s.length,f=u.getEnds();for(let g=0,y=f.length;g<y;++g)f[g]+=h;Nn(s,u.getFlatCoordinates()),a.push(f)}t=i.length===0?this.getLayout():i[0].getLayout(),e=s,r=a}t!==void 0&&r?(this.setFlatCoordinates(t,e),this.endss_=r):this.setCoordinates(e,t)}appendPolygon(e){let t;if(!this.flatCoordinates)this.flatCoordinates=e.getFlatCoordinates().slice(),t=e.getEnds().slice(),this.endss_.push();else{const r=this.flatCoordinates.length;Nn(this.flatCoordinates,e.getFlatCoordinates()),t=e.getEnds().slice();for(let i=0,s=t.length;i<s;++i)t[i]+=r}this.endss_.push(t),this.changed()}clone(){const e=this.endss_.length,t=new Array(e);for(let i=0;i<e;++i)t[i]=this.endss_[i].slice();const r=new jh(this.flatCoordinates.slice(),this.layout,t);return r.applyProperties(this),r}closestPointXY(e,t,r,i){return i<id(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(kU(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),MU(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,e,t,r,i))}containsXY(e,t){return DU(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e,t)}getArea(){return Pz(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),uT(t,0,this.endss_,this.stride,e)):t=this.flatCoordinates,sT(t,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const e=k5(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=M5(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new ld(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;N5(e,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=uT(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],r=[];return t.length=GU(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(e),t,0,r),new jh(t,"XY",r)}getPolygon(e){if(e<0||this.endss_.length<=e)return null;let t;if(e===0)t=0;else{const s=this.endss_[e-1];t=s[s.length-1]}const r=this.endss_[e].slice(),i=r[r.length-1];if(t!==0)for(let s=0,a=r.length;s<a;++s)r[s]-=t;return new Ia(this.flatCoordinates.slice(t,i),this.layout,r)}getPolygons(){const e=this.layout,t=this.flatCoordinates,r=this.endss_,i=[];let s=0;for(let a=0,o=r.length;a<o;++a){const l=r[a].slice(),u=l[l.length-1];if(s!==0)for(let f=0,g=l.length;f<g;++f)l[f]-=s;const h=new Ia(t.slice(s,u),e,l);i.push(h),s=u}return i}getType(){return"MultiPolygon"}intersectsExtent(e){return jU(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,3),this.flatCoordinates||(this.flatCoordinates=[]);const r=c5(this.flatCoordinates,0,e,this.stride,this.endss_);if(r.length===0)this.flatCoordinates.length=0;else{const i=r[r.length-1];this.flatCoordinates.length=i.length===0?0:i[i.length-1]}this.changed()}}const i4=Qa();class Ws{constructor(e,t,r,i,s,a){this.styleFunction,this.extent_,this.id_=a,this.type_=e,this.flatCoordinates_=t,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=r||null,this.properties_=s,this.squaredTolerance_,this.stride_=i,this.simplifiedGeometry_}get(e){return this.properties_[e]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?UO(this.flatCoordinates_):Kb(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const e=Wo(this.getExtent());this.flatInteriorPoints_=dI(this.flatCoordinates_,0,this.ends_,2,e,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const e=Cz(this.flatCoordinates_,this.ends_),t=k5(this.flatCoordinates_,0,e,2);this.flatInteriorPoints_=M5(this.flatCoordinates_,0,e,2,t)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=ax(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const e=this.flatCoordinates_;let t=0;const r=this.ends_;for(let i=0,s=r.length;i<s;++i){const a=r[i],o=ax(e,t,a,2,.5);Nn(this.flatMidpoints_,o),t=a}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(e){return this}simplifyTransformed(e,t){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(e){e=qn(e);const t=e.getExtent(),r=e.getWorldExtent();if(t&&r){const i=$r(r)/$r(t);Ko(i4,r[0],r[3],i,-i,0,0,0),eu(this.flatCoordinates_,0,this.flatCoordinates_.length,2,i4,this.flatCoordinates_)}}applyTransform(e){e(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new Ws(this.type_,this.flatCoordinates_.slice(),this.ends_?.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=jO((e,t)=>{if(e===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),t&&this.simplifiedGeometry_.applyTransform(t);const r=this.simplifiedGeometry_.getFlatCoordinates();let i;switch(this.type_){case"LineString":r.length=jv(r,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,e,r,0),i=[r.length];break;case"MultiLineString":i=[],r.length=f5(r,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,e,r,0,i);break;case"Polygon":i=[],r.length=aI(r,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(e),r,0,i);break}return i&&(this.simplifiedGeometry_=new Ws(this.type_,r,i,2,this.properties_,this.id_)),this.squaredTolerance_=e,this.simplifiedGeometry_}),this}}Ws.prototype.getFlatCoordinates=Ws.prototype.getOrientedFlatCoordinates;function D5(n,e,t=0,r=n.length-1,i=kz){for(;r>t;){if(r-t>600){const l=r-t+1,u=e-t+1,h=Math.log(l),f=.5*Math.exp(2*h/3),g=.5*Math.sqrt(h*f*(l-f)/l)*(u-l/2<0?-1:1),y=Math.max(t,Math.floor(e-u*f/l+g)),v=Math.min(r,Math.floor(e+(l-u)*f/l+g));D5(n,e,y,v,i)}const s=n[e];let a=t,o=r;for(Fg(n,t,e),i(n[r],s)>0&&Fg(n,t,r);a<o;){for(Fg(n,a,o),a++,o--;i(n[a],s)<0;)a++;for(;i(n[o],s)>0;)o--}i(n[t],s)===0?Fg(n,t,o):(o++,Fg(n,o,r)),o<=e&&(t=o+1),e<=o&&(r=o-1)}}function Fg(n,e,t){const r=n[e];n[e]=n[t],n[t]=r}function kz(n,e){return n<e?-1:n>e?1:0}let F5=class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data;const r=[];if(!$y(e,t))return r;const i=this.toBBox,s=[];for(;t;){for(let a=0;a<t.children.length;a++){const o=t.children[a],l=t.leaf?i(o):o;$y(e,l)&&(t.leaf?r.push(o):L2(e,l)?this._all(o,r):s.push(o))}t=s.pop()}return r}collides(e){let t=this.data;if(!$y(e,t))return!1;const r=[];for(;t;){for(let i=0;i<t.children.length;i++){const s=t.children[i],a=t.leaf?this.toBBox(s):s;if($y(e,a)){if(t.leaf||L2(e,a))return!0;r.push(s)}}t=r.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let r=0;r<e.length;r++)this.insert(e[r]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=t;else if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const r=this.data;this.data=t,t=r}this._insert(t,this.data.height-t.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=xf([]),this}remove(e,t){if(!e)return this;let r=this.data;const i=this.toBBox(e),s=[],a=[];let o,l,u;for(;r||s.length;){if(r||(r=s.pop(),l=s[s.length-1],o=a.pop(),u=!0),r.leaf){const h=Mz(e,r.children,t);if(h!==-1)return r.children.splice(h,1),s.push(r),this._condense(s),this}!u&&!r.leaf&&L2(r,i)?(s.push(r),a.push(o),o=0,l=r,r=r.children[0]):l?(o++,r=l.children[o],u=!1):r=null}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){const r=[];for(;e;)e.leaf?t.push(...e.children):r.push(...e.children),e=r.pop();return t}_build(e,t,r,i){const s=r-t+1;let a=this._maxEntries,o;if(s<=a)return o=xf(e.slice(t,r+1)),tf(o,this.toBBox),o;i||(i=Math.ceil(Math.log(s)/Math.log(a)),a=Math.ceil(s/Math.pow(a,i-1))),o=xf([]),o.leaf=!1,o.height=i;const l=Math.ceil(s/a),u=l*Math.ceil(Math.sqrt(a));s4(e,t,r,u,this.compareMinX);for(let h=t;h<=r;h+=u){const f=Math.min(h+u-1,r);s4(e,h,f,l,this.compareMinY);for(let g=h;g<=f;g+=l){const y=Math.min(g+l-1,f);o.children.push(this._build(e,g,y,i-1))}}return tf(o,this.toBBox),o}_chooseSubtree(e,t,r,i){for(;i.push(t),!(t.leaf||i.length-1===r);){let s=1/0,a=1/0,o;for(let l=0;l<t.children.length;l++){const u=t.children[l],h=N2(u),f=Oz(e,u)-h;f<a?(a=f,s=h<s?h:s,o=u):f===a&&h<s&&(s=h,o=u)}t=o||t.children[0]}return t}_insert(e,t,r){const i=r?e:this.toBBox(e),s=[],a=this._chooseSubtree(i,this.data,t,s);for(a.children.push(e),qg(a,i);t>=0&&s[t].children.length>this._maxEntries;)this._split(s,t),t--;this._adjustParentBBoxes(i,s,t)}_split(e,t){const r=e[t],i=r.children.length,s=this._minEntries;this._chooseSplitAxis(r,s,i);const a=this._chooseSplitIndex(r,s,i),o=xf(r.children.splice(a,r.children.length-a));o.height=r.height,o.leaf=r.leaf,tf(r,this.toBBox),tf(o,this.toBBox),t?e[t-1].children.push(o):this._splitRoot(r,o)}_splitRoot(e,t){this.data=xf([e,t]),this.data.height=e.height+1,this.data.leaf=!1,tf(this.data,this.toBBox)}_chooseSplitIndex(e,t,r){let i,s=1/0,a=1/0;for(let o=t;o<=r-t;o++){const l=Yg(e,0,o,this.toBBox),u=Yg(e,o,r,this.toBBox),h=Dz(l,u),f=N2(l)+N2(u);h<s?(s=h,i=o,a=f<a?f:a):h===s&&f<a&&(a=f,i=o)}return i||r-t}_chooseSplitAxis(e,t,r){const i=e.leaf?this.compareMinX:Nz,s=e.leaf?this.compareMinY:Lz,a=this._allDistMargin(e,t,r,i),o=this._allDistMargin(e,t,r,s);a<o&&e.children.sort(i)}_allDistMargin(e,t,r,i){e.children.sort(i);const s=this.toBBox,a=Yg(e,0,t,s),o=Yg(e,r-t,r,s);let l=zy(a)+zy(o);for(let u=t;u<r-t;u++){const h=e.children[u];qg(a,e.leaf?s(h):h),l+=zy(a)}for(let u=r-t-1;u>=t;u--){const h=e.children[u];qg(o,e.leaf?s(h):h),l+=zy(o)}return l}_adjustParentBBoxes(e,t,r){for(let i=r;i>=0;i--)qg(t[i],e)}_condense(e){for(let t=e.length-1,r;t>=0;t--)e[t].children.length===0?t>0?(r=e[t-1].children,r.splice(r.indexOf(e[t]),1)):this.clear():tf(e[t],this.toBBox)}};function Mz(n,e,t){if(!t)return e.indexOf(n);for(let r=0;r<e.length;r++)if(t(n,e[r]))return r;return-1}function tf(n,e){Yg(n,0,n.children.length,e,n)}function Yg(n,e,t,r,i){i||(i=xf(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(let s=e;s<t;s++){const a=n.children[s];qg(i,n.leaf?r(a):a)}return i}function qg(n,e){return n.minX=Math.min(n.minX,e.minX),n.minY=Math.min(n.minY,e.minY),n.maxX=Math.max(n.maxX,e.maxX),n.maxY=Math.max(n.maxY,e.maxY),n}function Nz(n,e){return n.minX-e.minX}function Lz(n,e){return n.minY-e.minY}function N2(n){return(n.maxX-n.minX)*(n.maxY-n.minY)}function zy(n){return n.maxX-n.minX+(n.maxY-n.minY)}function Oz(n,e){return(Math.max(e.maxX,n.maxX)-Math.min(e.minX,n.minX))*(Math.max(e.maxY,n.maxY)-Math.min(e.minY,n.minY))}function Dz(n,e){const t=Math.max(n.minX,e.minX),r=Math.max(n.minY,e.minY),i=Math.min(n.maxX,e.maxX),s=Math.min(n.maxY,e.maxY);return Math.max(0,i-t)*Math.max(0,s-r)}function L2(n,e){return n.minX<=e.minX&&n.minY<=e.minY&&e.maxX<=n.maxX&&e.maxY<=n.maxY}function $y(n,e){return e.minX<=n.maxX&&e.minY<=n.maxY&&e.maxX>=n.minX&&e.maxY>=n.minY}function xf(n){return{children:n,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function s4(n,e,t,r,i){const s=[e,t];for(;s.length;){if(t=s.pop(),e=s.pop(),t-e<=r)continue;const a=e+Math.ceil((t-e)/r/2)*r;D5(n,a,e,t,i),s.push(e,a,a,t)}}class a4{constructor(e){this.rbush_=new F5(e),this.items_={}}insert(e,t){const r={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:t};this.rbush_.insert(r),this.items_[bn(t)]=r}load(e,t){const r=new Array(t.length);for(let i=0,s=t.length;i<s;i++){const a=e[i],o=t[i],l={minX:a[0],minY:a[1],maxX:a[2],maxY:a[3],value:o};r[i]=l,this.items_[bn(o)]=l}this.rbush_.load(r)}remove(e){const t=bn(e),r=this.items_[t];return delete this.items_[t],this.rbush_.remove(r)!==null}update(e,t){const r=this.items_[bn(t)],i=[r.minX,r.minY,r.maxX,r.maxY];o0(i,e)||(this.remove(t),this.insert(e,t))}getAll(){return this.rbush_.all().map(function(t){return t.value})}getInExtent(e){const t={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this.rbush_.search(t).map(function(i){return i.value})}forEach(e){return this.forEach_(this.getAll(),e)}forEachInExtent(e,t){return this.forEach_(this.getInExtent(e),t)}forEach_(e,t){let r;for(let i=0,s=e.length;i<s;i++)if(r=t(e[i]),r)return r;return r}isEmpty(){return Nh(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(e){const t=this.rbush_.toJSON();return lu(t.minX,t.minY,t.maxX,t.maxY,e)}concat(e){this.rbush_.load(e.rbush_.all());for(const t in e.items_)this.items_[t]=e.items_[t]}}class mI extends tl{constructor(e){super(),this.projection=qn(e.projection),this.attributions_=o4(e.attributions),this.attributionsCollapsible_=e.attributionsCollapsible??!0,this.loading=!1,this.state_=e.state!==void 0?e.state:"ready",this.wrapX_=e.wrapX!==void 0?e.wrapX:!1,this.interpolate_=!!e.interpolate,this.viewResolver=null,this.viewRejector=null;const t=this;this.viewPromise_=new Promise(function(r,i){t.viewResolver=r,t.viewRejector=i})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(e){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(e){this.attributions_=o4(e),this.changed()}setState(e){this.state_=e,this.changed()}}function o4(n){return n?typeof n=="function"?n:(Array.isArray(n)||(n=[n]),e=>n):null}const da={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};class Ec extends el{constructor(e,t,r){super(e),this.feature=t,this.features=r}}class Kp extends mI{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:e.wrapX!==void 0?e.wrapX:!0}),this.on,this.once,this.un,this.loader_=$m,this.format_=e.format||null,this.overlaps_=e.overlaps===void 0?!0:e.overlaps,this.url_=e.url,e.loader!==void 0?this.loader_=e.loader:this.url_!==void 0&&(Dn(this.format_,"`format` must be set when `url` is set"),this.loader_=n4(this.url_,this.format_)),this.strategy_=e.strategy!==void 0?e.strategy:Az;const t=e.useSpatialIndex!==void 0?e.useSpatialIndex:!0;this.featuresRtree_=t?new a4:null,this.loadedExtentsRtree_=new a4,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let r,i;Array.isArray(e.features)?i=e.features:e.features&&(r=e.features,i=r.getArray()),!t&&r===void 0&&(r=new xa(i)),i!==void 0&&this.addFeaturesInternal(i),r!==void 0&&this.bindFeaturesCollection_(r)}addFeature(e){this.addFeatureInternal(e),this.changed()}addFeatureInternal(e){const t=bn(e);if(!this.addToIndex_(t,e)){this.featuresCollection_&&this.featuresCollection_.remove(e);return}this.setupChangeEvents_(t,e);const r=e.getGeometry();if(r){const i=r.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(i,e)}else this.nullGeometryFeatures_[t]=e;this.dispatchEvent(new Ec(da.ADDFEATURE,e))}setupChangeEvents_(e,t){t instanceof Ws||(this.featureChangeKeys_[e]=[yn(t,Yt.CHANGE,this.handleFeatureChange_,this),yn(t,a0.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(e,t){let r=!0;if(t.getId()!==void 0){const i=String(t.getId());if(!(i in this.idIndex_))this.idIndex_[i]=t;else if(t instanceof Ws){const s=this.idIndex_[i];s instanceof Ws?Array.isArray(s)?s.push(t):this.idIndex_[i]=[s,t]:r=!1}else r=!1}return r&&(Dn(!(e in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[e]=t),r}addFeatures(e){this.addFeaturesInternal(e),this.changed()}addFeaturesInternal(e){const t=[],r=[],i=[];for(let s=0,a=e.length;s<a;s++){const o=e[s],l=bn(o);this.addToIndex_(l,o)&&r.push(o)}for(let s=0,a=r.length;s<a;s++){const o=r[s],l=bn(o);this.setupChangeEvents_(l,o);const u=o.getGeometry();if(u){const h=u.getExtent();t.push(h),i.push(o)}else this.nullGeometryFeatures_[l]=o}if(this.featuresRtree_&&this.featuresRtree_.load(t,i),this.hasListener(da.ADDFEATURE))for(let s=0,a=r.length;s<a;s++)this.dispatchEvent(new Ec(da.ADDFEATURE,r[s]))}bindFeaturesCollection_(e){let t=!1;this.addEventListener(da.ADDFEATURE,function(r){t||(t=!0,e.push(r.feature),t=!1)}),this.addEventListener(da.REMOVEFEATURE,function(r){t||(t=!0,e.remove(r.feature),t=!1)}),e.addEventListener(vs.ADD,r=>{t||(t=!0,this.addFeature(r.element),t=!1)}),e.addEventListener(vs.REMOVE,r=>{t||(t=!0,this.removeFeature(r.element),t=!1)}),this.featuresCollection_=e}clear(e){if(e){for(const r in this.featureChangeKeys_)this.featureChangeKeys_[r].forEach(tr);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(r=>{this.removeFeatureInternal(r)});for(const r in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[r])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const t=new Ec(da.CLEAR);this.dispatchEvent(t),this.changed()}forEachFeature(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureAtCoordinateDirect(e,t){const r=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(r,function(i){const s=i.getGeometry();if(s instanceof Ws||s.intersectsCoordinate(e))return t(i)})}forEachFeatureInExtent(e,t){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureIntersectingExtent(e,t){return this.forEachFeatureInExtent(e,function(r){const i=r.getGeometry();if(i instanceof Ws||i.intersectsExtent(e)){const s=t(r);if(s)return s}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let e;return this.featuresCollection_?e=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(e=this.featuresRtree_.getAll(),Nh(this.nullGeometryFeatures_)||Nn(e,Object.values(this.nullGeometryFeatures_))),e}getFeaturesAtCoordinate(e){const t=[];return this.forEachFeatureAtCoordinateDirect(e,function(r){t.push(r)}),t}getFeaturesInExtent(e,t){if(this.featuresRtree_){if(!(t&&t.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(e);const i=YO(e,t);return[].concat(...i.map(s=>this.featuresRtree_.getInExtent(s)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(e,t){const r=e[0],i=e[1];let s=null;const a=[NaN,NaN];let o=1/0;const l=[-1/0,-1/0,1/0,1/0];return t=t||zm,this.featuresRtree_.forEachInExtent(l,function(u){if(t(u)){const h=u.getGeometry(),f=o;if(o=h instanceof Ws?0:h.closestPointXY(r,i,a,o),o<f){s=u;const g=Math.sqrt(o);l[0]=r-g,l[1]=i-g,l[2]=r+g,l[3]=i+g}}}),s}getExtent(e){return this.featuresRtree_.getExtent(e)}getFeatureById(e){const t=this.idIndex_[e.toString()];return t!==void 0?t:null}getFeatureByUid(e){const t=this.uidIndex_[e];return t!==void 0?t:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(e){const t=e.target,r=bn(t),i=t.getGeometry();if(!i)r in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(t),this.nullGeometryFeatures_[r]=t);else{const a=i.getExtent();r in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[r],this.featuresRtree_&&this.featuresRtree_.insert(a,t)):this.featuresRtree_&&this.featuresRtree_.update(a,t)}const s=t.getId();if(s!==void 0){const a=s.toString();this.idIndex_[a]!==t&&(this.removeFromIdIndex_(t),this.idIndex_[a]=t)}else this.removeFromIdIndex_(t),this.uidIndex_[r]=t;this.changed(),this.dispatchEvent(new Ec(da.CHANGEFEATURE,t))}hasFeature(e){const t=e.getId();return t!==void 0?t in this.idIndex_:bn(e)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&Nh(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(e,t,r){const i=this.loadedExtentsRtree_,s=this.strategy_(e,t,r);for(let a=0,o=s.length;a<o;++a){const l=s[a];i.forEachInExtent(l,function(h){return Uc(h.extent,l)})||(++this.loadingExtentsCount_,this.dispatchEvent(new Ec(da.FEATURESLOADSTART)),this.loader_.call(this,l,t,r,h=>{--this.loadingExtentsCount_,this.dispatchEvent(new Ec(da.FEATURESLOADEND,void 0,h))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new Ec(da.FEATURESLOADERROR))}),i.insert(l,{extent:l.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(e){const t=this.loadedExtentsRtree_,r=t.forEachInExtent(e,function(i){if(o0(i.extent,e))return i});r&&t.remove(r)}removeFeatures(e){let t=!1;for(let r=0,i=e.length;r<i;++r)t=this.removeFeatureInternal(e[r])||t;t&&this.changed()}removeFeature(e){if(!e)return;this.removeFeatureInternal(e)&&this.changed()}removeFeatureInternal(e){const t=bn(e);if(!(t in this.uidIndex_))return!1;t in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[t]:this.featuresRtree_&&this.featuresRtree_.remove(e),this.featureChangeKeys_[t]?.forEach(tr),delete this.featureChangeKeys_[t];const i=e.getId();if(i!==void 0){const s=i.toString(),a=this.idIndex_[s];a===e?delete this.idIndex_[s]:Array.isArray(a)&&(a.splice(a.indexOf(e),1),a.length===1&&(this.idIndex_[s]=a[0]))}return delete this.uidIndex_[t],this.hasListener(da.REMOVEFEATURE)&&this.dispatchEvent(new Ec(da.REMOVEFEATURE,e)),!0}removeFromIdIndex_(e){for(const t in this.idIndex_)if(this.idIndex_[t]===e){delete this.idIndex_[t];break}}setLoader(e){this.loader_=e}setUrl(e){Dn(this.format_,"`format` must be set when `url` is set"),this.url_=e,this.setLoader(n4(e,this.format_))}setOverlaps(e){this.overlaps_=e,this.changed()}}class Wr{constructor(e){e=e||{},this.patternImage_=null,this.color_=null,e.color!==void 0&&this.setColor(e.color)}clone(){const e=this.getColor();return new Wr({color:Array.isArray(e)?e.slice():e||void 0})}getColor(){return this.color_}setColor(e){if(e!==null&&typeof e=="object"&&"src"in e){const t=lx(null,e.src,"anonymous",void 0,e.offset?null:e.color?e.color:null,!(e.offset&&e.size));t.ready().then(()=>{this.patternImage_=null}),t.getImageState()===vt.IDLE&&t.load(),t.getImageState()===vt.LOADING&&(this.patternImage_=t)}this.color_=e}getKey(){const e=this.getColor();return e?e instanceof CanvasPattern||e instanceof CanvasGradient?bn(e):typeof e=="object"&&"src"in e?e.src+":"+e.offset:Fh(e).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}class Ci{constructor(e){e=e||{},this.color_=e.color!==void 0?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=e.lineDash!==void 0?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}clone(){const e=this.getColor();return new Ci({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(e){this.color_=e}setLineCap(e){this.lineCap_=e}setLineDash(e){this.lineDash_=e}setLineDashOffset(e){this.lineDashOffset_=e}setLineJoin(e){this.lineJoin_=e}setMiterLimit(e){this.miterLimit_=e}setWidth(e){this.width_=e}}function l4(n){return n[0]>0&&n[1]>0}function Fz(n,e,t){return t===void 0&&(t=[0,0]),t[0]=n[0]*e+.5|0,t[1]=n[1]*e+.5|0,t}function bs(n,e){return Array.isArray(n)?n:(e===void 0?e=[n,n]:(e[0]=n,e[1]=n),e)}class Gv{constructor(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=bs(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new Gv({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return Vt()}getImage(e){return Vt()}getHitDetectionImage(){return Vt()}getPixelRatio(e){return 1}getImageState(){return Vt()}getImageSize(){return Vt()}getOrigin(){return Vt()}getSize(){return Vt()}setDisplacement(e){this.displacement_=e}setOpacity(e){this.opacity_=e}setRotateWithView(e){this.rotateWithView_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=bs(e)}listenImageChange(e){Vt()}load(){Vt()}unlistenImageChange(e){Vt()}ready(){return Promise.resolve()}}class Bv extends Gv{constructor(e){super({opacity:1,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,rotation:e.rotation!==void 0?e.rotation:0,scale:e.scale!==void 0?e.scale:1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=e.fill!==void 0?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius=e.radius,this.radius2_=e.radius2,this.angle_=e.angle!==void 0?e.angle:0,this.stroke_=e.stroke!==void 0?e.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?vt.LOADING:vt.LOADED,this.imageState_===vt.LOADING&&this.ready().then(()=>this.imageState_=vt.LOADED),this.render()}clone(){const e=this.getScale(),t=new Bv({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}getAnchor(){const e=this.size_,t=this.getDisplacement(),r=this.getScaleArray();return[e[0]/2-t[0]/r[0],e[1]/2+t[1]/r[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(e){this.fill_=e,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(e){const t=this.fill_?.getKey(),r=`${e},${this.angle_},${this.radius},${this.radius2_},${this.points_},${t}`+Object.values(this.renderOptions_).join(",");let i=wa.get(r,null,null)?.getImage(1);if(!i){const s=this.renderOptions_,a=Math.ceil(s.size*e),o=ni(a,a);this.draw_(s,o,e),i=o.canvas,wa.set(r,null,null,new S5(i,void 0,null,vt.LOADED,null))}return i}getPixelRatio(e){return e}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e,this.render()}listenImageChange(e){}load(){}unlistenImageChange(e){}calculateLineJoinSize_(e,t,r){if(t===0||this.points_===1/0||e!=="bevel"&&e!=="miter")return t;let i=this.radius,s=this.radius2_===void 0?i:this.radius2_;if(i<s){const z=i;i=s,s=z}const a=this.radius2_===void 0?this.points_:this.points_*2,o=2*Math.PI/a,l=s*Math.sin(o),u=Math.sqrt(s*s-l*l),h=i-u,f=Math.sqrt(l*l+h*h),g=f/l;if(e==="miter"&&g<=r)return g*t;const y=t/2/g,v=t/2*(h/f),E=Math.sqrt((i+y)*(i+y)+v*v)-i;if(this.radius2_===void 0||e==="bevel")return E*2;const T=i*Math.sin(o),b=Math.sqrt(i*i-T*T),I=s-b,F=Math.sqrt(T*T+I*I)/T;if(F<=r){const z=F*t/2-s-i;return 2*Math.max(E,z)}return E*2}createRenderOptions(){let e=u0,t=h0,r=0,i=null,s=0,a,o=0;this.stroke_&&(a=Lo(this.stroke_.getColor()??qm),o=this.stroke_.getWidth()??Zm,i=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,t=this.stroke_.getLineJoin()??h0,e=this.stroke_.getLineCap()??u0,r=this.stroke_.getMiterLimit()??Ym);const l=this.calculateLineJoinSize_(t,o,r),u=Math.max(this.radius,this.radius2_||0),h=Math.ceil(2*u+l);return{strokeStyle:a,strokeWidth:o,size:h,lineCap:e,lineDash:i,lineDashOffset:s,lineJoin:t,miterLimit:r}}render(){this.renderOptions_=this.createRenderOptions();const e=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[e,e]}draw_(e,t,r){if(t.scale(r,r),t.translate(e.size/2,e.size/2),this.createPath_(t),this.fill_){let i=this.fill_.getColor();i===null&&(i=ws),t.fillStyle=Lo(i),t.fill()}e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}createHitDetectionCanvas_(e){let t;if(this.fill_){let r=this.fill_.getColor(),i=0;typeof r=="string"&&(r=Fh(r)),r===null?i=1:Array.isArray(r)&&(i=r.length===4?r[3]:1),i===0&&(t=ni(e.size,e.size),this.drawHitDetectionCanvas_(e,t))}return t?t.canvas:this.getImage(1)}createPath_(e){let t=this.points_;const r=this.radius;if(t===1/0)e.arc(0,0,r,0,2*Math.PI);else{const i=this.radius2_===void 0?r:this.radius2_;this.radius2_!==void 0&&(t*=2);const s=this.angle_-Math.PI/2,a=2*Math.PI/t;for(let o=0;o<t;o++){const l=s+o*a,u=o%2===0?r:i;e.lineTo(u*Math.cos(l),u*Math.sin(l))}e.closePath()}}drawHitDetectionCanvas_(e,t){t.translate(e.size/2,e.size/2),this.createPath_(t),t.fillStyle=ws,t.fill(),e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class Yo extends Bv{constructor(e){e=e||{radius:5},super({points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:e.scale!==void 0?e.scale:1,rotation:e.rotation!==void 0?e.rotation:0,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode})}clone(){const e=this.getScale(),t=new Yo({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}setRadius(e){this.radius=e,this.render()}}class nr{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=c4,e.geometry!==void 0&&this.setGeometry(e.geometry),this.fill_=e.fill!==void 0?e.fill:null,this.image_=e.image!==void 0?e.image:null,this.renderer_=e.renderer!==void 0?e.renderer:null,this.hitDetectionRenderer_=e.hitDetectionRenderer!==void 0?e.hitDetectionRenderer:null,this.stroke_=e.stroke!==void 0?e.stroke:null,this.text_=e.text!==void 0?e.text:null,this.zIndex_=e.zIndex}clone(){let e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new nr({geometry:e??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(e){this.renderer_=e}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(e){this.fill_=e}getImage(){return this.image_}setImage(e){this.image_=e}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e}getText(){return this.text_}setText(e){this.text_=e}getZIndex(){return this.zIndex_}setGeometry(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(t){return t.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=c4,this.geometry_=e}setZIndex(e){this.zIndex_=e}}function jz(n){let e;if(typeof n=="function")e=n;else{let t;Array.isArray(n)?t=n:(Dn(typeof n.getZIndex=="function","Expected an `Style` or an array of `Style`"),t=[n]),e=function(){return t}}return e}let O2=null;function j5(n,e){if(!O2){const t=new Wr({color:"rgba(255,255,255,0.4)"}),r=new Ci({color:"#3399CC",width:1.25});O2=[new nr({image:new Yo({fill:t,stroke:r,radius:5}),fill:t,stroke:r})]}return O2}function c4(n){return n.getGeometry()}const Vz="#333";class cd{constructor(e){e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.keepUpright_=e.keepUpright,this.scale_=e.scale,this.scaleArray_=bs(e.scale!==void 0?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=e.fill!==void 0?e.fill:new Wr({color:Vz}),this.maxAngle_=e.maxAngle!==void 0?e.maxAngle:Math.PI/4,this.placement_=e.placement!==void 0?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=e.stroke!==void 0?e.stroke:null,this.offsetX_=e.offsetX!==void 0?e.offsetX:0,this.offsetY_=e.offsetY!==void 0?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=e.padding===void 0?null:e.padding,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new cd({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()instanceof Wr?this.getFill().clone():this.getFill(),stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(e){this.overflow_=e}setFont(e){this.font_=e}setMaxAngle(e){this.maxAngle_=e}setOffsetX(e){this.offsetX_=e}setOffsetY(e){this.offsetY_=e}setPlacement(e){this.placement_=e}setRepeat(e){this.repeat_=e}setRotateWithView(e){this.rotateWithView_=e}setKeepUpright(e){this.keepUpright_=e}setFill(e){this.fill_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=bs(e!==void 0?e:1)}setStroke(e){this.stroke_=e}setText(e){this.text_=e}setTextAlign(e){this.textAlign_=e}setJustify(e){this.justify_=e}setTextBaseline(e){this.textBaseline_=e}setBackgroundFill(e){this.backgroundFill_=e}setBackgroundStroke(e){this.backgroundStroke_=e}setPadding(e){this.padding_=e}}const hi={ANIMATING:0,INTERACTING:1},Mt={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Wy=[Mt.FILL],Hc=[Mt.STROKE],xh=[Mt.BEGIN_PATH],u4=[Mt.CLOSE_PATH];class Yp extends T5{constructor(e,t,r,i){super(),this.tolerance=e,this.maxExtent=t,this.pixelRatio=i,this.maxLineWidth=0,this.resolution=r,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(e){const t=this.pixelRatio;return t==1?e:e.map(function(r){return r*t})}appendFlatPointCoordinates(e,t){const r=this.getBufferedMaxExtent(),i=this.tmpCoordinate_,s=this.coordinates;let a=s.length;for(let o=0,l=e.length;o<l;o+=t)i[0]=e[o],i[1]=e[o+1],Lh(r,i)&&(s[a++]=i[0],s[a++]=i[1]);return a}appendFlatLineCoordinates(e,t,r,i,s,a){const o=this.coordinates;let l=o.length;const u=this.getBufferedMaxExtent();a&&(t+=i);let h=e[t],f=e[t+1];const g=this.tmpCoordinate_;let y=!0,v,x,E;for(v=t+i;v<r;v+=i)g[0]=e[v],g[1]=e[v+1],E=XS(u,g),E!==x?(y&&(o[l++]=h,o[l++]=f,y=!1),o[l++]=g[0],o[l++]=g[1]):E===ci.INTERSECTING?(o[l++]=g[0],o[l++]=g[1],y=!1):y=!0,h=g[0],f=g[1],x=E;return(s&&y||v===t+i)&&(o[l++]=h,o[l++]=f),l}drawCustomCoordinates_(e,t,r,i,s){for(let a=0,o=r.length;a<o;++a){const l=r[a],u=this.appendFlatLineCoordinates(e,t,l,i,!1,!1);s.push(u),t=l}return t}drawCustom(e,t,r,i,s){this.beginGeometry(e,t,s);const a=e.getType(),o=e.getStride(),l=this.coordinates.length;let u,h,f,g,y;switch(a){case"MultiPolygon":u=e.getOrientedFlatCoordinates(),g=[];const v=e.getEndss();y=0;for(let x=0,E=v.length;x<E;++x){const T=[];y=this.drawCustomCoordinates_(u,y,v[x],o,T),g.push(T)}this.instructions.push([Mt.CUSTOM,l,g,e,r,sT,s]),this.hitDetectionInstructions.push([Mt.CUSTOM,l,g,e,i||r,sT,s]);break;case"Polygon":case"MultiLineString":f=[],u=a=="Polygon"?e.getOrientedFlatCoordinates():e.getFlatCoordinates(),y=this.drawCustomCoordinates_(u,0,e.getEnds(),o,f),this.instructions.push([Mt.CUSTOM,l,f,e,r,Km,s]),this.hitDetectionInstructions.push([Mt.CUSTOM,l,f,e,i||r,Km,s]);break;case"LineString":case"Circle":u=e.getFlatCoordinates(),h=this.appendFlatLineCoordinates(u,0,u.length,o,!1,!1),this.instructions.push([Mt.CUSTOM,l,h,e,r,$c,s]),this.hitDetectionInstructions.push([Mt.CUSTOM,l,h,e,i||r,$c,s]);break;case"MultiPoint":u=e.getFlatCoordinates(),h=this.appendFlatPointCoordinates(u,o),h>l&&(this.instructions.push([Mt.CUSTOM,l,h,e,r,$c,s]),this.hitDetectionInstructions.push([Mt.CUSTOM,l,h,e,i||r,$c,s]));break;case"Point":u=e.getFlatCoordinates(),this.coordinates.push(u[0],u[1]),h=this.coordinates.length,this.instructions.push([Mt.CUSTOM,l,h,e,r,void 0,s]),this.hitDetectionInstructions.push([Mt.CUSTOM,l,h,e,i||r,void 0,s]);break}this.endGeometry(t)}beginGeometry(e,t,r){this.beginGeometryInstruction1_=[Mt.BEGIN_GEOMETRY,t,0,e,r],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[Mt.BEGIN_GEOMETRY,t,0,e,r],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const e=this.hitDetectionInstructions;e.reverse();let t;const r=e.length;let i,s,a=-1;for(t=0;t<r;++t)i=e[t],s=i[0],s==Mt.END_GEOMETRY?a=t:s==Mt.BEGIN_GEOMETRY&&(i[2]=t,OB(this.hitDetectionInstructions,a,t),a=-1)}fillStyleToState(e,t={}){if(e){const r=e.getColor();t.fillPatternScale=r&&typeof r=="object"&&"src"in r?this.pixelRatio:1,t.fillStyle=Lo(r||ws)}else t.fillStyle=void 0;return t}strokeStyleToState(e,t={}){if(e){const r=e.getColor();t.strokeStyle=Lo(r||qm);const i=e.getLineCap();t.lineCap=i!==void 0?i:u0;const s=e.getLineDash();t.lineDash=s?s.slice():Ml;const a=e.getLineDashOffset();t.lineDashOffset=a||Nl;const o=e.getLineJoin();t.lineJoin=o!==void 0?o:h0;const l=e.getWidth();t.lineWidth=l!==void 0?l:Zm;const u=e.getMiterLimit();t.miterLimit=u!==void 0?u:Ym,t.lineWidth>this.maxLineWidth&&(this.maxLineWidth=t.lineWidth,this.bufferedMaxExtent_=null)}else t.strokeStyle=void 0,t.lineCap=void 0,t.lineDash=null,t.lineDashOffset=void 0,t.lineJoin=void 0,t.lineWidth=void 0,t.miterLimit=void 0;return t}setFillStrokeStyle(e,t){const r=this.state;this.fillStyleToState(e,r),this.strokeStyleToState(t,r)}createFill(e){const t=e.fillStyle,r=[Mt.SET_FILL_STYLE,t];return typeof t!="string"&&r.push(e.fillPatternScale),r}applyStroke(e){this.instructions.push(this.createStroke(e))}createStroke(e){return[Mt.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth*this.pixelRatio,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash?this.applyPixelRatio(e.lineDash):null,e.lineDashOffset*this.pixelRatio]}updateFillStyle(e,t){const r=e.fillStyle;(typeof r!="string"||e.currentFillStyle!=r)&&(this.instructions.push(t.call(this,e)),e.currentFillStyle=r)}updateStrokeStyle(e,t){const r=e.strokeStyle,i=e.lineCap,s=e.lineDash,a=e.lineDashOffset,o=e.lineJoin,l=e.lineWidth,u=e.miterLimit;(e.currentStrokeStyle!=r||e.currentLineCap!=i||s!=e.currentLineDash&&!Su(e.currentLineDash,s)||e.currentLineDashOffset!=a||e.currentLineJoin!=o||e.currentLineWidth!=l||e.currentMiterLimit!=u)&&(t.call(this,e),e.currentStrokeStyle=r,e.currentLineCap=i,e.currentLineDash=s,e.currentLineDashOffset=a,e.currentLineJoin=o,e.currentLineWidth=l,e.currentMiterLimit=u)}endGeometry(e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const t=[Mt.END_GEOMETRY,e];this.instructions.push(t),this.hitDetectionInstructions.push(t)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=BO(this.maxExtent),this.maxLineWidth>0)){const e=this.resolution*(this.maxLineWidth+1)/2;Wm(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class Gz extends Yp{constructor(e,t,r,i){super(e,t,r,i),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(e,t,r){if(!this.image_||this.maxExtent&&!Lh(this.maxExtent,e.getFlatCoordinates()))return;this.beginGeometry(e,t,r);const i=e.getFlatCoordinates(),s=e.getStride(),a=this.coordinates.length,o=this.appendFlatPointCoordinates(i,s);this.instructions.push([Mt.DRAW_IMAGE,a,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Mt.DRAW_IMAGE,a,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}drawMultiPoint(e,t,r){if(!this.image_)return;this.beginGeometry(e,t,r);const i=e.getFlatCoordinates(),s=[];for(let l=0,u=i.length;l<u;l+=e.getStride())(!this.maxExtent||Lh(this.maxExtent,i.slice(l,l+2)))&&s.push(i[l],i[l+1]);const a=this.coordinates.length,o=this.appendFlatPointCoordinates(s,2);this.instructions.push([Mt.DRAW_IMAGE,a,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Mt.DRAW_IMAGE,a,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(e,t){const r=e.getAnchor(),i=e.getSize(),s=e.getOrigin();this.imagePixelRatio_=e.getPixelRatio(this.pixelRatio),this.anchorX_=r[0],this.anchorY_=r[1],this.hitDetectionImage_=e.getHitDetectionImage(),this.image_=e.getImage(this.pixelRatio),this.height_=i[1],this.opacity_=e.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=e.getRotateWithView(),this.rotation_=e.getRotation(),this.scale_=e.getScaleArray(),this.width_=i[0],this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}class Bz extends Yp{constructor(e,t,r,i){super(e,t,r,i)}drawFlatCoordinates_(e,t,r,i){const s=this.coordinates.length,a=this.appendFlatLineCoordinates(e,t,r,i,!1,!1),o=[Mt.MOVE_TO_LINE_TO,s,a];return this.instructions.push(o),this.hitDetectionInstructions.push(o),r}drawLineString(e,t,r){const i=this.state,s=i.strokeStyle,a=i.lineWidth;if(s===void 0||a===void 0)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(e,t,r),this.hitDetectionInstructions.push([Mt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Ml,Nl],xh);const o=e.getFlatCoordinates(),l=e.getStride();this.drawFlatCoordinates_(o,0,o.length,l),this.hitDetectionInstructions.push(Hc),this.endGeometry(t)}drawMultiLineString(e,t,r){const i=this.state,s=i.strokeStyle,a=i.lineWidth;if(s===void 0||a===void 0)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(e,t,r),this.hitDetectionInstructions.push([Mt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Ml,Nl],xh);const o=e.getEnds(),l=e.getFlatCoordinates(),u=e.getStride();let h=0;for(let f=0,g=o.length;f<g;++f)h=this.drawFlatCoordinates_(l,h,o[f],u);this.hitDetectionInstructions.push(Hc),this.endGeometry(t)}finish(){const e=this.state;return e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&this.instructions.push(Hc),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(e){e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(Hc),e.lastStroke=this.coordinates.length),e.lastStroke=0,super.applyStroke(e),this.instructions.push(xh)}}class h4 extends Yp{constructor(e,t,r,i){super(e,t,r,i)}drawFlatCoordinatess_(e,t,r,i){const s=this.state,a=s.fillStyle!==void 0,o=s.strokeStyle!==void 0,l=r.length;this.instructions.push(xh),this.hitDetectionInstructions.push(xh);for(let u=0;u<l;++u){const h=r[u],f=this.coordinates.length,g=this.appendFlatLineCoordinates(e,t,h,i,!0,!o),y=[Mt.MOVE_TO_LINE_TO,f,g];this.instructions.push(y),this.hitDetectionInstructions.push(y),o&&(this.instructions.push(u4),this.hitDetectionInstructions.push(u4)),t=h}return a&&(this.instructions.push(Wy),this.hitDetectionInstructions.push(Wy)),o&&(this.instructions.push(Hc),this.hitDetectionInstructions.push(Hc)),t}drawCircle(e,t,r){const i=this.state,s=i.fillStyle,a=i.strokeStyle;if(s===void 0&&a===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([Mt.SET_FILL_STYLE,ws]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Mt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Ml,Nl]);const o=e.getFlatCoordinates(),l=e.getStride(),u=this.coordinates.length;this.appendFlatLineCoordinates(o,0,o.length,l,!1,!1);const h=[Mt.CIRCLE,u];this.instructions.push(xh,h),this.hitDetectionInstructions.push(xh,h),i.fillStyle!==void 0&&(this.instructions.push(Wy),this.hitDetectionInstructions.push(Wy)),i.strokeStyle!==void 0&&(this.instructions.push(Hc),this.hitDetectionInstructions.push(Hc)),this.endGeometry(t)}drawPolygon(e,t,r){const i=this.state,s=i.fillStyle,a=i.strokeStyle;if(s===void 0&&a===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([Mt.SET_FILL_STYLE,ws]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Mt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Ml,Nl]);const o=e.getEnds(),l=e.getOrientedFlatCoordinates(),u=e.getStride();this.drawFlatCoordinatess_(l,0,o,u),this.endGeometry(t)}drawMultiPolygon(e,t,r){const i=this.state,s=i.fillStyle,a=i.strokeStyle;if(s===void 0&&a===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([Mt.SET_FILL_STYLE,ws]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Mt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Ml,Nl]);const o=e.getEndss(),l=e.getOrientedFlatCoordinates(),u=e.getStride();let h=0;for(let f=0,g=o.length;f<g;++f)h=this.drawFlatCoordinatess_(l,h,o[f],u);this.endGeometry(t)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const e=this.tolerance;if(e!==0){const t=this.coordinates;for(let r=0,i=t.length;r<i;++r)t[r]=th(t[r],e)}return super.finish()}setFillStrokeStyles_(){const e=this.state;this.updateFillStyle(e,this.createFill),this.updateStrokeStyle(e,this.applyStroke)}}function Uz(n,e,t,r,i){const s=[];let a=t,o=0,l=e.slice(t,2);for(;o<n&&a+i<r;){const[u,h]=l.slice(-2),f=e[a+i],g=e[a+i+1],y=Math.sqrt((f-u)*(f-u)+(g-h)*(g-h));if(o+=y,o>=n){const v=(n-o+y)/y,x=$s(u,f,v),E=$s(h,g,v);l.push(x,E),s.push(l),l=[x,E],o==n&&(a+=i),o=0}else if(o<n)l.push(e[a+i],e[a+i+1]),a+=i;else{const v=y-o,x=$s(u,f,v/y),E=$s(h,g,v/y);l.push(x,E),s.push(l),l=[x,E],o=0,a+=i}}return o>0&&s.push(l),s}function zz(n,e,t,r,i){let s=t,a=t,o=0,l=0,u=t,h,f,g,y,v,x,E,T,b,I;for(f=t;f<r;f+=i){const M=e[f],F=e[f+1];v!==void 0&&(b=M-v,I=F-x,y=Math.sqrt(b*b+I*I),E!==void 0&&(l+=g,h=Math.acos((E*b+T*I)/(g*y)),h>n&&(l>o&&(o=l,s=u,a=f),l=0,u=f-i)),g=y,E=b,T=I),v=M,x=F}return l+=y,l>o?[u,f]:[s,a]}const hx={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class $z extends Yp{constructor(e,t,r,i){super(e,t,r,i),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[ws]={fillStyle:ws},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const e=super.finish();return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e}drawText(e,t,r){const i=this.textFillState_,s=this.textStrokeState_,a=this.textState_;if(this.text_===""||!a||!i&&!s)return;const o=this.coordinates;let l=o.length;const u=e.getType();let h=null,f=e.getStride();if(a.placement==="line"&&(u=="LineString"||u=="MultiLineString"||u=="Polygon"||u=="MultiPolygon")){if(!as(this.maxExtent,e.getExtent()))return;let g;if(h=e.getFlatCoordinates(),u=="LineString")g=[h.length];else if(u=="MultiLineString")g=e.getEnds();else if(u=="Polygon")g=e.getEnds().slice(0,1);else if(u=="MultiPolygon"){const E=e.getEndss();g=[];for(let T=0,b=E.length;T<b;++T)g.push(E[T][0])}this.beginGeometry(e,t,r);const y=a.repeat,v=y?void 0:a.textAlign;let x=0;for(let E=0,T=g.length;E<T;++E){let b;y?b=Uz(y*this.resolution,h,x,g[E],f):b=[h.slice(x,g[E])];for(let I=0,M=b.length;I<M;++I){const F=b[I];let z=0,k=F.length;if(v==null){const P=zz(a.maxAngle,F,0,F.length,2);z=P[0],k=P[1]}for(let P=z;P<k;P+=f)o.push(F[P],F[P+1]);const C=o.length;x=g[E],this.drawChars_(l,C),l=C}}this.endGeometry(t)}else{let g=a.overflow?null:[];switch(u){case"Point":case"MultiPoint":h=e.getFlatCoordinates();break;case"LineString":h=e.getFlatMidpoint();break;case"Circle":h=e.getCenter();break;case"MultiLineString":h=e.getFlatMidpoints(),f=2;break;case"Polygon":h=e.getFlatInteriorPoint(),a.overflow||g.push(h[2]/this.resolution),f=3;break;case"MultiPolygon":const M=e.getFlatInteriorPoints();h=[];for(let F=0,z=M.length;F<z;F+=3)a.overflow||g.push(M[F+2]/this.resolution),h.push(M[F],M[F+1]);if(h.length===0)return;f=2;break}const y=this.appendFlatPointCoordinates(h,f);if(y===l)return;if(g&&(y-l)/2!==h.length/f){let M=l/2;g=g.filter((F,z)=>{const k=o[(M+z)*2]===h[z*f]&&o[(M+z)*2+1]===h[z*f+1];return k||--M,k})}this.saveTextStates_();const v=a.backgroundFill?this.createFill(this.fillStyleToState(a.backgroundFill)):null,x=a.backgroundStroke?this.createStroke(this.strokeStyleToState(a.backgroundStroke)):null;this.beginGeometry(e,t,r);let E=a.padding;if(E!=_h&&(a.scale[0]<0||a.scale[1]<0)){let M=a.padding[0],F=a.padding[1],z=a.padding[2],k=a.padding[3];a.scale[0]<0&&(F=-F,k=-k),a.scale[1]<0&&(M=-M,z=-z),E=[M,F,z,k]}const T=this.pixelRatio;this.instructions.push([Mt.DRAW_IMAGE,l,y,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,E==_h?_h:E.map(function(M){return M*T}),v,x,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,g]);const b=1/T,I=v?v.slice(0):null;I&&(I[1]=ws),this.hitDetectionInstructions.push([Mt.DRAW_IMAGE,l,y,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[b,b],NaN,this.declutterMode_,this.declutterImageWithText_,E,I,x,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?ws:this.fillKey_,this.textOffsetX_,this.textOffsetY_,g]),this.endGeometry(t)}}saveTextStates_(){const e=this.textStrokeState_,t=this.textState_,r=this.textFillState_,i=this.strokeKey_;e&&(i in this.strokeStates||(this.strokeStates[i]={strokeStyle:e.strokeStyle,lineCap:e.lineCap,lineDashOffset:e.lineDashOffset,lineWidth:e.lineWidth,lineJoin:e.lineJoin,miterLimit:e.miterLimit,lineDash:e.lineDash}));const s=this.textKey_;s in this.textStates||(this.textStates[s]={font:t.font,textAlign:t.textAlign||Xm,justify:t.justify,textBaseline:t.textBaseline||cx,scale:t.scale});const a=this.fillKey_;r&&(a in this.fillStates||(this.fillStates[a]={fillStyle:r.fillStyle}))}drawChars_(e,t){const r=this.textStrokeState_,i=this.textState_,s=this.strokeKey_,a=this.textKey_,o=this.fillKey_;this.saveTextStates_();const l=this.pixelRatio,u=hx[i.textBaseline],h=this.textOffsetY_*l,f=this.text_,g=r?r.lineWidth*Math.abs(i.scale[0])/2:0;this.instructions.push([Mt.DRAW_CHARS,e,t,u,i.overflow,o,i.maxAngle,l,h,s,g*l,f,a,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([Mt.DRAW_CHARS,e,t,u,i.overflow,o&&ws,i.maxAngle,l,h,s,g*l,f,a,1/l,this.declutterMode_,this.textKeepUpright_])}setTextStyle(e,t){let r,i,s;if(!e)this.text_="";else{const a=e.getFill();a?(i=this.textFillState_,i||(i={},this.textFillState_=i),i.fillStyle=Lo(a.getColor()||ws)):(i=null,this.textFillState_=i);const o=e.getStroke();if(!o)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);const x=o.getLineDash(),E=o.getLineDashOffset(),T=o.getWidth(),b=o.getMiterLimit();s.lineCap=o.getLineCap()||u0,s.lineDash=x?x.slice():Ml,s.lineDashOffset=E===void 0?Nl:E,s.lineJoin=o.getLineJoin()||h0,s.lineWidth=T===void 0?Zm:T,s.miterLimit=b===void 0?Ym:b,s.strokeStyle=Lo(o.getColor()||qm)}r=this.textState_;const l=e.getFont()||b5;lz(l);const u=e.getScaleArray();r.overflow=e.getOverflow(),r.font=l,r.maxAngle=e.getMaxAngle(),r.placement=e.getPlacement(),r.textAlign=e.getTextAlign(),r.repeat=e.getRepeat(),r.justify=e.getJustify(),r.textBaseline=e.getTextBaseline()||cx,r.backgroundFill=e.getBackgroundFill(),r.backgroundStroke=e.getBackgroundStroke(),r.padding=e.getPadding()||_h,r.scale=u===void 0?[1,1]:u;const h=e.getOffsetX(),f=e.getOffsetY(),g=e.getRotateWithView(),y=e.getKeepUpright(),v=e.getRotation();this.text_=e.getText()||"",this.textOffsetX_=h===void 0?0:h,this.textOffsetY_=f===void 0?0:f,this.textRotateWithView_=g===void 0?!1:g,this.textKeepUpright_=y===void 0?!0:y,this.textRotation_=v===void 0?0:v,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:bn(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=r.font+r.scale+(r.textAlign||"?")+(r.repeat||"?")+(r.justify||"?")+(r.textBaseline||"?"),this.fillKey_=i&&i.fillStyle?typeof i.fillStyle=="string"?i.fillStyle:"|"+bn(i.fillStyle):""}this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}const Wz={Circle:h4,Default:Yp,Image:Gz,LineString:Bz,Polygon:h4,Text:$z};class Hz{constructor(e,t,r,i){this.tolerance_=e,this.maxExtent_=t,this.pixelRatio_=i,this.resolution_=r,this.buildersByZIndex_={}}finish(){const e={};for(const t in this.buildersByZIndex_){e[t]=e[t]||{};const r=this.buildersByZIndex_[t];for(const i in r){const s=r[i].finish();e[t][i]=s}}return e}getBuilder(e,t){const r=e!==void 0?e.toString():"0";let i=this.buildersByZIndex_[r];i===void 0&&(i={},this.buildersByZIndex_[r]=i);let s=i[t];if(s===void 0){const a=Wz[t];s=new a(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),i[t]=s}return s}}function Kz(n,e,t,r,i,s,a,o,l,u,h,f,g=!0){let y=n[e],v=n[e+1],x=0,E=0,T=0,b=0;function I(){x=y,E=v,e+=r,y=n[e],v=n[e+1],b+=T,T=Math.sqrt((y-x)*(y-x)+(v-E)*(v-E))}do I();while(e<t-r&&b+T<s);let M=T===0?0:(s-b)/T;const F=$s(x,y,M),z=$s(E,v,M),k=e-r,C=b,P=s+o*l(u,i,h);for(;e<t-r&&b+T<P;)I();M=T===0?0:(P-b)/T;const L=$s(x,y,M),O=$s(E,v,M);let U=!1;if(g)if(f){const Ne=[F,z,L,O];o5(Ne,0,4,2,f,Ne,Ne),U=Ne[0]>Ne[2]}else U=F>L;const j=Math.PI,Ie=[],ke=k+r===e;e=k,T=0,b=C,y=n[e],v=n[e+1];let ze;if(ke){I(),ze=Math.atan2(v-E,y-x),U&&(ze+=ze>0?-j:j);const Ne=(L+F)/2,ce=(O+z)/2;return Ie[0]=[Ne,ce,(P-s)/2,ze,i],Ie}i=i.replace(/\n/g," ");for(let Ne=0,ce=i.length;Ne<ce;){I();let Te=Math.atan2(v-E,y-x);if(U&&(Te+=Te>0?-j:j),ze!==void 0){let X=Te-ze;if(X+=X>j?-2*j:X<-j?2*j:0,Math.abs(X)>a)return null}ze=Te;const Ee=Ne;let se=0;for(;Ne<ce;++Ne){const X=U?ce-Ne-1:Ne,ue=o*l(u,i[X],h);if(e+r<t&&b+T<s+se+ue/2)break;se+=ue}if(Ne===Ee)continue;const V=U?i.substring(ce-Ee,ce-Ne):i.substring(Ee,Ne);M=T===0?0:(s+se/2-b)/T;const J=$s(x,y,M),ne=$s(E,v,M);Ie.push([J,ne,se/2,Te,V]),s+=se}return Ie}class V5{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(ox(),{get:(e,t)=>{if(typeof ox()[t]=="function")return this.push_(t),this.pushMethodArgs_},set:(e,t,r)=>(this.push_(t,r),!0)})}push_(...e){const t=this.instructions_,r=this.zIndex+this.offset_;t[r]||(t[r]=[]),t[r].push(...e)}pushMethodArgs_=(...e)=>(this.push_(e),this);pushFunction(e){this.push_(e)}getContext(){return this.context_}draw(e){this.instructions_.forEach(t=>{for(let r=0,i=t.length;r<i;++r){const s=t[r];if(typeof s=="function"){s(e);continue}const a=t[++r];if(typeof e[s]=="function")e[s](...a);else{if(typeof a=="function"){e[s]=a(e);continue}e[s]=a}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const nf=Qs(),Sc=[],_l=[],xl=[],Tc=[];function d4(n){return n[3].declutterBox}const f4=new RegExp("[-----]");function D2(n,e){return e==="start"?e=f4.test(n)?"right":"left":e==="end"&&(e=f4.test(n)?"left":"right"),hx[e]}function Yz(n,e,t){return t>0&&n.push(`
`,""),n.push(e,""),n}function qz(n,e,t){return t%2===0&&(n+=e),n}class Xz{constructor(e,t,r,i,s){this.overlaps=r,this.pixelRatio=t,this.resolution=e,this.alignAndScaleFill_,this.instructions=i.instructions,this.coordinates=i.coordinates,this.coordinateCache_={},this.renderedTransform_=Qa(),this.hitDetectionInstructions=i.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=i.fillStates||{},this.strokeStates=i.strokeStates||{},this.textStates=i.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=s?new V5:null}getZIndexContext(){return this.zIndexContext_}createLabel(e,t,r,i){const s=e+t+r+i;if(this.labels_[s])return this.labels_[s];const a=i?this.strokeStates[i]:null,o=r?this.fillStates[r]:null,l=this.textStates[t],u=this.pixelRatio,h=[l.scale[0]*u,l.scale[1]*u],f=l.justify?hx[l.justify]:D2(Array.isArray(e)?e[0]:e,l.textAlign||Xm),g=i&&a.lineWidth?a.lineWidth:0,y=Array.isArray(e)?e:String(e).split(`
`).reduce(Yz,[]),{width:v,height:x,widths:E,heights:T,lineWidths:b}=uz(l,y),I=v+g,M=[],F=(I+2)*h[0],z=(x+g)*h[1],k={width:F<0?Math.floor(F):Math.ceil(F),height:z<0?Math.floor(z):Math.ceil(z),contextInstructions:M};(h[0]!=1||h[1]!=1)&&M.push("scale",h),i&&(M.push("strokeStyle",a.strokeStyle),M.push("lineWidth",g),M.push("lineCap",a.lineCap),M.push("lineJoin",a.lineJoin),M.push("miterLimit",a.miterLimit),M.push("setLineDash",[a.lineDash]),M.push("lineDashOffset",a.lineDashOffset)),r&&M.push("fillStyle",o.fillStyle),M.push("textBaseline","middle"),M.push("textAlign","center");const C=.5-f;let P=f*I+C*g;const L=[],O=[];let U=0,j=0,Ie=0,ke=0,ze;for(let Ne=0,ce=y.length;Ne<ce;Ne+=2){const Te=y[Ne];if(Te===`
`){j+=U,U=0,P=f*I+C*g,++ke;continue}const Ee=y[Ne+1]||l.font;Ee!==ze&&(i&&L.push("font",Ee),r&&O.push("font",Ee),ze=Ee),U=Math.max(U,T[Ie]);const se=[Te,P+C*E[Ie]+f*(E[Ie]-b[ke]),.5*(g+U)+j];P+=E[Ie],i&&L.push("strokeText",se),r&&O.push("fillText",se),++Ie}return Array.prototype.push.apply(M,L),Array.prototype.push.apply(M,O),this.labels_[s]=k,k}replayTextBackground_(e,t,r,i,s,a,o){e.beginPath(),e.moveTo.apply(e,t),e.lineTo.apply(e,r),e.lineTo.apply(e,i),e.lineTo.apply(e,s),e.lineTo.apply(e,t),a&&(this.alignAndScaleFill_=a[2],e.fillStyle=a[1],this.fill_(e)),o&&(this.setStrokeStyle_(e,o),e.stroke())}calculateImageOrLabelDimensions_(e,t,r,i,s,a,o,l,u,h,f,g,y,v,x,E){o*=g[0],l*=g[1];let T=r-o,b=i-l;const I=s+u>e?e-u:s,M=a+h>t?t-h:a,F=v[3]+I*g[0]+v[1],z=v[0]+M*g[1]+v[2],k=T-v[3],C=b-v[0];(x||f!==0)&&(Sc[0]=k,Tc[0]=k,Sc[1]=C,_l[1]=C,_l[0]=k+F,xl[0]=_l[0],xl[1]=C+z,Tc[1]=xl[1]);let P;return f!==0?(P=Ko(Qa(),r,i,1,1,f,-r,-i),ti(P,Sc),ti(P,_l),ti(P,xl),ti(P,Tc),lu(Math.min(Sc[0],_l[0],xl[0],Tc[0]),Math.min(Sc[1],_l[1],xl[1],Tc[1]),Math.max(Sc[0],_l[0],xl[0],Tc[0]),Math.max(Sc[1],_l[1],xl[1],Tc[1]),nf)):lu(Math.min(k,k+F),Math.min(C,C+z),Math.max(k,k+F),Math.max(C,C+z),nf),y&&(T=Math.round(T),b=Math.round(b)),{drawImageX:T,drawImageY:b,drawImageW:I,drawImageH:M,originX:u,originY:h,declutterBox:{minX:nf[0],minY:nf[1],maxX:nf[2],maxY:nf[3],value:E},canvasTransform:P,scale:g}}replayImageOrLabel_(e,t,r,i,s,a,o){const l=!!(a||o),u=i.declutterBox,h=o?o[2]*i.scale[0]/2:0;return u.minX-h<=t[0]&&u.maxX+h>=0&&u.minY-h<=t[1]&&u.maxY+h>=0&&(l&&this.replayTextBackground_(e,Sc,_l,xl,Tc,a,o),hz(e,i.canvasTransform,s,r,i.originX,i.originY,i.drawImageW,i.drawImageH,i.drawImageX,i.drawImageY,i.scale)),!0}fill_(e){const t=this.alignAndScaleFill_;if(t){const r=ti(this.renderedTransform_,[0,0]),i=512*this.pixelRatio;e.save(),e.translate(r[0]%i,r[1]%i),t!==1&&e.scale(t,t),e.rotate(this.viewRotation_)}e.fill(),t&&e.restore()}setStrokeStyle_(e,t){e.strokeStyle=t[1],t[1]&&(e.lineWidth=t[2],e.lineCap=t[3],e.lineJoin=t[4],e.miterLimit=t[5],e.lineDashOffset=t[7],e.setLineDash(t[6]))}drawLabelWithPointPlacement_(e,t,r,i){const s=this.textStates[t],a=this.createLabel(e,t,i,r),o=this.strokeStates[r],l=this.pixelRatio,u=D2(Array.isArray(e)?e[0]:e,s.textAlign||Xm),h=hx[s.textBaseline||cx],f=o&&o.lineWidth?o.lineWidth:0,g=a.width/l-2*s.scale[0],y=u*g+2*(.5-u)*f,v=h*a.height/l+2*(.5-h)*f;return{label:a,anchorX:y,anchorY:v}}execute_(e,t,r,i,s,a,o,l){const u=this.zIndexContext_;let h;this.pixelCoordinates_&&Su(r,this.renderedTransform_)?h=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),h=eu(this.coordinates,0,this.coordinates.length,2,r,this.pixelCoordinates_),EU(this.renderedTransform_,r));let f=0;const g=i.length;let y=0,v,x,E,T,b,I,M,F,z,k,C,P,L,O=0,U=0;const j=this.coordinateCache_,Ie=this.viewRotation_,ke=Math.round(Math.atan2(-r[1],r[0])*1e12)/1e12,ze={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:Ie},Ne=this.instructions!=i||this.overlaps?0:200;let ce,Te,Ee,se;for(;f<g;){const V=i[f];switch(V[0]){case Mt.BEGIN_GEOMETRY:ce=V[1],se=V[3],ce.getGeometry()?o!==void 0&&!as(o,se.getExtent())?f=V[2]+1:++f:f=V[2],u&&(u.zIndex=V[4]);break;case Mt.BEGIN_PATH:O>Ne&&(this.fill_(e),O=0),U>Ne&&(e.stroke(),U=0),!O&&!U&&(e.beginPath(),b=NaN,I=NaN),++f;break;case Mt.CIRCLE:y=V[1];const ne=h[y],X=h[y+1],ue=h[y+2],Me=h[y+3],je=ue-ne,De=Me-X,Be=Math.sqrt(je*je+De*De);e.moveTo(ne+Be,X),e.arc(ne,X,Be,0,2*Math.PI,!0),++f;break;case Mt.CLOSE_PATH:e.closePath(),++f;break;case Mt.CUSTOM:y=V[1],v=V[2];const Gt=V[3],Kt=V[4],wn=V[5];ze.geometry=Gt,ze.feature=ce,f in j||(j[f]=[]);const Bt=j[f];wn?wn(h,y,v,2,Bt):(Bt[0]=h[y],Bt[1]=h[y+1],Bt.length=2),u&&(u.zIndex=V[6]),Kt(Bt,ze),++f;break;case Mt.DRAW_IMAGE:y=V[1],v=V[2],z=V[3],x=V[4],E=V[5];let Fn=V[6];const Qt=V[7],ot=V[8],Xn=V[9],on=V[10];let en=V[11];const Zn=V[12];let gt=V[13];T=V[14]||"declutter";const jt=V[15];if(!z&&V.length>=20){k=V[19],C=V[20],P=V[21],L=V[22];const Se=this.drawLabelWithPointPlacement_(k,C,P,L);z=Se.label,V[3]=z;const $e=V[23];x=(Se.anchorX-$e)*this.pixelRatio,V[4]=x;const et=V[24];E=(Se.anchorY-et)*this.pixelRatio,V[5]=E,Fn=z.height,V[6]=Fn,gt=z.width,V[13]=gt}let kn;V.length>25&&(kn=V[25]);let yt,Jt,Rt;V.length>17?(yt=V[16],Jt=V[17],Rt=V[18]):(yt=_h,Jt=null,Rt=null),on&&ke?en+=Ie:!on&&!ke&&(en-=Ie);let rr=0;for(;y<v;y+=2){if(kn&&kn[rr++]<gt/this.pixelRatio)continue;const Se=this.calculateImageOrLabelDimensions_(z.width,z.height,h[y],h[y+1],gt,Fn,x,E,ot,Xn,en,Zn,s,yt,!!Jt||!!Rt,ce),$e=[e,t,z,Se,Qt,Jt,Rt];if(l){let et,dt,St;if(jt){const cn=v-y;if(!jt[cn]){jt[cn]={args:$e,declutterMode:T};continue}const hr=jt[cn];et=hr.args,dt=hr.declutterMode,delete jt[cn],St=d4(et)}let sn,ur;if(et&&(dt!=="declutter"||!l.collides(St))&&(sn=!0),(T!=="declutter"||!l.collides(Se.declutterBox))&&(ur=!0),dt==="declutter"&&T==="declutter"){const cn=sn&&ur;sn=cn,ur=cn}sn&&(dt!=="none"&&l.insert(St),this.replayImageOrLabel_.apply(this,et)),ur&&(T!=="none"&&l.insert(Se.declutterBox),this.replayImageOrLabel_.apply(this,$e))}else this.replayImageOrLabel_.apply(this,$e)}++f;break;case Mt.DRAW_CHARS:const si=V[1],Vr=V[2],Ut=V[3],Ji=V[4];L=V[5];const Oe=V[6],ve=V[7],me=V[8];P=V[9];const Ct=V[10];k=V[11],Array.isArray(k)&&(k=k.reduce(qz,"")),C=V[12];const N=[V[13],V[13]];T=V[14]||"declutter";const Pt=V[15],W=this.textStates[C],Z=W.font,q=[W.scale[0]*ve,W.scale[1]*ve];let le;Z in this.widths_?le=this.widths_[Z]:(le={},this.widths_[Z]=le);const he=sI(h,si,Vr,2),Ve=Math.abs(q[0])*Jk(Z,k,le);if(Ji||Ve<=he){const Se=this.textStates[C].textAlign,$e=(he-Ve)*D2(k,Se),et=Kz(h,si,Vr,2,k,$e,Oe,Math.abs(q[0]),Jk,Z,le,ke?0:this.viewRotation_,Pt);e:if(et){const dt=[];let St,sn,ur,cn,hr;if(P)for(St=0,sn=et.length;St<sn;++St){hr=et[St],ur=hr[4],cn=this.createLabel(ur,C,"",P),x=hr[2]+(q[0]<0?-Ct:Ct),E=Ut*cn.height+(.5-Ut)*2*Ct*q[1]/q[0]-me;const pr=this.calculateImageOrLabelDimensions_(cn.width,cn.height,hr[0],hr[1],cn.width,cn.height,x,E,0,0,hr[3],N,!1,_h,!1,ce);if(l&&T==="declutter"&&l.collides(pr.declutterBox))break e;dt.push([e,t,cn,pr,1,null,null])}if(L)for(St=0,sn=et.length;St<sn;++St){hr=et[St],ur=hr[4],cn=this.createLabel(ur,C,L,""),x=hr[2],E=Ut*cn.height-me;const pr=this.calculateImageOrLabelDimensions_(cn.width,cn.height,hr[0],hr[1],cn.width,cn.height,x,E,0,0,hr[3],N,!1,_h,!1,ce);if(l&&T==="declutter"&&l.collides(pr.declutterBox))break e;dt.push([e,t,cn,pr,1,null,null])}l&&T!=="none"&&l.load(dt.map(d4));for(let pr=0,Ni=dt.length;pr<Ni;++pr)this.replayImageOrLabel_.apply(this,dt[pr])}}++f;break;case Mt.END_GEOMETRY:if(a!==void 0){ce=V[1];const Se=a(ce,se,T);if(Se)return Se}++f;break;case Mt.FILL:Ne?O++:this.fill_(e),++f;break;case Mt.MOVE_TO_LINE_TO:for(y=V[1],v=V[2],Te=h[y],Ee=h[y+1],e.moveTo(Te,Ee),b=Te+.5|0,I=Ee+.5|0,y+=2;y<v;y+=2)Te=h[y],Ee=h[y+1],M=Te+.5|0,F=Ee+.5|0,(y==v-2||M!==b||F!==I)&&(e.lineTo(Te,Ee),b=M,I=F);++f;break;case Mt.SET_FILL_STYLE:this.alignAndScaleFill_=V[2],O&&(this.fill_(e),O=0,U&&(e.stroke(),U=0)),e.fillStyle=V[1],++f;break;case Mt.SET_STROKE_STYLE:U&&(e.stroke(),U=0),this.setStrokeStyle_(e,V),++f;break;case Mt.STROKE:Ne?U++:e.stroke(),++f;break;default:++f;break}}O&&this.fill_(e),U&&e.stroke()}execute(e,t,r,i,s,a){this.viewRotation_=i,this.execute_(e,t,r,this.instructions,s,void 0,void 0,a)}executeHitDetection(e,t,r,i,s){return this.viewRotation_=r,this.execute_(e,[e.canvas.width,e.canvas.height],t,this.hitDetectionInstructions,!0,i,s)}}const uh=["Polygon","Circle","LineString","Image","Text","Default"],G5=["Image","Text"],Zz=uh.filter(n=>!G5.includes(n));class Qz{constructor(e,t,r,i,s,a,o){this.maxExtent_=e,this.overlaps_=i,this.pixelRatio_=r,this.resolution_=t,this.renderBuffer_=a,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=Qa(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(s,o)}clip(e,t){const r=this.getClipCoords(t);e.beginPath(),e.moveTo(r[0],r[1]),e.lineTo(r[2],r[3]),e.lineTo(r[4],r[5]),e.lineTo(r[6],r[7]),e.clip()}createExecutors_(e,t){for(const r in e){let i=this.executorsByZIndex_[r];i===void 0&&(i={},this.executorsByZIndex_[r]=i);const s=e[r];for(const a in s){const o=s[a];i[a]=new Xz(this.resolution_,this.pixelRatio_,this.overlaps_,o,t)}}}hasExecutors(e){for(const t in this.executorsByZIndex_){const r=this.executorsByZIndex_[t];for(let i=0,s=e.length;i<s;++i)if(e[i]in r)return!0}return!1}forEachFeatureAtCoordinate(e,t,r,i,s,a){i=Math.round(i);const o=i*2+1,l=Ko(this.hitDetectionTransform_,i+.5,i+.5,1/t,-1/t,-r,-e[0],-e[1]),u=!this.hitDetectionContext_;u&&(this.hitDetectionContext_=ni(o,o));const h=this.hitDetectionContext_;h.canvas.width!==o||h.canvas.height!==o?(h.canvas.width=o,h.canvas.height=o):u||h.clearRect(0,0,o,o);let f;this.renderBuffer_!==void 0&&(f=Qs(),dm(f,e),Wm(f,t*(this.renderBuffer_+i),f));const g=Jz(i);let y;function v(F,z,k){const C=h.getImageData(0,0,o,o).data;for(let P=0,L=g.length;P<L;P++)if(C[g[P]]>0){if(!a||k==="none"||y!=="Image"&&y!=="Text"||a.includes(F)){const O=(g[P]-3)/4,U=i-O%o,j=i-(O/o|0),Ie=s(F,z,U*U+j*j);if(Ie)return Ie}h.clearRect(0,0,o,o);break}}const x=Object.keys(this.executorsByZIndex_).map(Number);x.sort(Cl);let E,T,b,I,M;for(E=x.length-1;E>=0;--E){const F=x[E].toString();for(b=this.executorsByZIndex_[F],T=uh.length-1;T>=0;--T)if(y=uh[T],I=b[y],I!==void 0&&(M=I.executeHitDetection(h,l,r,v,f),M))return M}}getClipCoords(e){const t=this.maxExtent_;if(!t)return null;const r=t[0],i=t[1],s=t[2],a=t[3],o=[r,i,r,a,s,a,s,i];return eu(o,0,8,2,e,o),o}isEmpty(){return Nh(this.executorsByZIndex_)}execute(e,t,r,i,s,a,o){const l=Object.keys(this.executorsByZIndex_).map(Number);l.sort(o?LB:Cl),a=a||uh;const u=uh.length;for(let h=0,f=l.length;h<f;++h){const g=l[h].toString(),y=this.executorsByZIndex_[g];for(let v=0,x=a.length;v<x;++v){const E=a[v],T=y[E];if(T!==void 0){const b=o===null?void 0:T.getZIndexContext(),I=b?b.getContext():e,M=this.maxExtent_&&E!=="Image"&&E!=="Text";if(M&&(I.save(),this.clip(I,r)),!b||E==="Text"||E==="Image"?T.execute(I,t,r,i,s,o):b.pushFunction(F=>T.execute(F,t,r,i,s,o)),M&&I.restore(),b){b.offset();const F=l[h]*u+uh.indexOf(E);this.deferredZIndexContexts_[F]||(this.deferredZIndexContexts_[F]=[]),this.deferredZIndexContexts_[F].push(b)}}}}this.renderedContext_=e}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const e=this.deferredZIndexContexts_,t=Object.keys(e).map(Number).sort(Cl);for(let r=0,i=t.length;r<i;++r)e[t[r]].forEach(s=>{s.draw(this.renderedContext_),s.clear()}),e[t[r]].length=0}}const F2={};function Jz(n){if(F2[n]!==void 0)return F2[n];const e=n*2+1,t=n*n,r=new Array(t+1);for(let s=0;s<=n;++s)for(let a=0;a<=n;++a){const o=s*s+a*a;if(o>t)break;let l=r[o];l||(l=[],r[o]=l),l.push(((n+s)*e+(n+a))*4+3),s>0&&l.push(((n-s)*e+(n+a))*4+3),a>0&&(l.push(((n+s)*e+(n-a))*4+3),s>0&&l.push(((n-s)*e+(n-a))*4+3))}const i=[];for(let s=0,a=r.length;s<a;++s)r[s]&&i.push(...r[s]);return F2[n]=i,i}function g4(n,e,t,r){return t!==void 0&&r!==void 0?[t/n,r/e]:t!==void 0?t/n:r!==void 0?r/e:1}let qp=class B5 extends Gv{constructor(e){e=e||{};const t=e.opacity!==void 0?e.opacity:1,r=e.rotation!==void 0?e.rotation:0,i=e.scale!==void 0?e.scale:1,s=e.rotateWithView!==void 0?e.rotateWithView:!1;super({opacity:t,rotation:r,scale:i,displacement:e.displacement!==void 0?e.displacement:[0,0],rotateWithView:s,declutterMode:e.declutterMode}),this.anchor_=e.anchor!==void 0?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=e.anchorOrigin!==void 0?e.anchorOrigin:"top-left",this.anchorXUnits_=e.anchorXUnits!==void 0?e.anchorXUnits:"fraction",this.anchorYUnits_=e.anchorYUnits!==void 0?e.anchorYUnits:"fraction",this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null;const a=e.img!==void 0?e.img:null;let o=e.src;Dn(!(o!==void 0&&a),"`image` and `src` cannot be provided at the same time"),(o===void 0||o.length===0)&&a&&(o=a.src||bn(a)),Dn(o!==void 0&&o.length>0,"A defined and non-empty `src` or `image` must be provided"),Dn(!((e.width!==void 0||e.height!==void 0)&&e.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let l;if(e.src!==void 0?l=vt.IDLE:a!==void 0&&("complete"in a?a.complete?l=a.src?vt.LOADED:vt.IDLE:l=vt.LOADING:l=vt.LOADED),this.color_=e.color!==void 0?Fh(e.color):null,this.iconImage_=lx(a,o,this.crossOrigin_,l,this.color_),this.offset_=e.offset!==void 0?e.offset:[0,0],this.offsetOrigin_=e.offsetOrigin!==void 0?e.offsetOrigin:"top-left",this.origin_=null,this.size_=e.size!==void 0?e.size:null,this.initialOptions_,e.width!==void 0||e.height!==void 0){let u,h;if(e.size)[u,h]=e.size;else{const f=this.getImage(1);if(f.width&&f.height)u=f.width,h=f.height;else if(f instanceof HTMLImageElement){this.initialOptions_=e;const g=()=>{if(this.unlistenImageChange(g),!this.initialOptions_)return;const y=this.iconImage_.getSize();this.setScale(g4(y[0],y[1],e.width,e.height))};this.listenImageChange(g);return}}u!==void 0&&this.setScale(g4(u,h,e.width,e.height))}}clone(){let e,t,r;return this.initialOptions_?(t=this.initialOptions_.width,r=this.initialOptions_.height):(e=this.getScale(),e=Array.isArray(e)?e.slice():e),new B5({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:e,width:t,height:r,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let e=this.normalizedAnchor_;if(!e){e=this.anchor_;const i=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!i)return null;e=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(e[0]*=i[0]),this.anchorYUnits_=="fraction"&&(e[1]*=i[1])}if(this.anchorOrigin_!="top-left"){if(!i)return null;e===this.anchor_&&(e=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(e[0]=-e[0]+i[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(e[1]=-e[1]+i[1])}this.normalizedAnchor_=e}const t=this.getDisplacement(),r=this.getScaleArray();return[e[0]-t[0]/r[0],e[1]+t[1]/r[1]]}setAnchor(e){this.anchor_=e,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(e){return this.iconImage_.getImage(e)}getPixelRatio(e){return this.iconImage_.getPixelRatio(e)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let e=this.offset_;if(this.offsetOrigin_!="top-left"){const t=this.getSize(),r=this.iconImage_.getSize();if(!t||!r)return null;e=e.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(e[0]=r[0]-t[0]-e[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(e[1]=r[1]-t[1]-e[1])}return this.origin_=e,this.origin_}getSrc(){return this.iconImage_.getSrc()}setSrc(e){this.iconImage_=lx(null,e,this.crossOrigin_,vt.IDLE,this.color_)}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const e=this.getScaleArray();if(this.size_)return this.size_[0]*e[0];if(this.iconImage_.getImageState()==vt.LOADED)return this.iconImage_.getSize()[0]*e[0]}getHeight(){const e=this.getScaleArray();if(this.size_)return this.size_[1]*e[1];if(this.iconImage_.getImageState()==vt.LOADED)return this.iconImage_.getSize()[1]*e[1]}setScale(e){delete this.initialOptions_,super.setScale(e)}listenImageChange(e){this.iconImage_.addEventListener(Yt.CHANGE,e)}load(){this.iconImage_.load()}unlistenImageChange(e){this.iconImage_.removeEventListener(Yt.CHANGE,e)}ready(){return this.iconImage_.ready()}};const ko=.5;function e$(n,e,t,r,i,s,a,o,l){const u=i,h=n[0]*ko,f=n[1]*ko,g=ni(h,f);g.imageSmoothingEnabled=!1;const y=g.canvas,v=new fz(g,ko,i,null,a,o,null),x=t.length,E=Math.floor((256*256*256-1)/x),T={};for(let I=1;I<=x;++I){const M=t[I-1],F=M.getStyleFunction()||r;if(!F)continue;let z=F(M,s);if(!z)continue;Array.isArray(z)||(z=[z]);const C=(I*E).toString(16).padStart(7,"#00000");for(let P=0,L=z.length;P<L;++P){const O=z[P],U=O.getGeometryFunction()(M);if(!U||!as(u,U.getExtent()))continue;const j=O.clone(),Ie=j.getFill();Ie&&Ie.setColor(C);const ke=j.getStroke();ke&&(ke.setColor(C),ke.setLineDash(null)),j.setText(void 0);const ze=O.getImage();if(ze){const Ee=ze.getImageSize();if(!Ee)continue;const se=ni(Ee[0],Ee[1],void 0,{alpha:!1}),V=se.canvas;se.fillStyle=C,se.fillRect(0,0,V.width,V.height),j.setImage(new qp({img:V,anchor:ze.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:ze.getOrigin(),opacity:1,size:ze.getSize(),scale:ze.getScale(),rotation:ze.getRotation(),rotateWithView:ze.getRotateWithView()}))}const Ne=j.getZIndex()||0;let ce=T[Ne];ce||(ce={},T[Ne]=ce,ce.Polygon=[],ce.Circle=[],ce.LineString=[],ce.Point=[]);const Te=U.getType();if(Te==="GeometryCollection"){const Ee=U.getGeometriesArrayRecursive();for(let se=0,V=Ee.length;se<V;++se){const J=Ee[se];ce[J.getType().replace("Multi","")].push(J,j)}}else ce[Te.replace("Multi","")].push(U,j)}}const b=Object.keys(T).map(Number).sort(Cl);for(let I=0,M=b.length;I<M;++I){const F=T[b[I]];for(const z in F){const k=F[z];for(let C=0,P=k.length;C<P;C+=2){v.setStyle(k[C+1]);for(let L=0,O=e.length;L<O;++L)v.setTransform(e[L]),v.drawGeometry(k[C])}}}return g.getImageData(0,0,y.width,y.height)}function t$(n,e,t){const r=[];if(t){const i=Math.floor(Math.round(n[0])*ko),s=Math.floor(Math.round(n[1])*ko),a=(ar(i,0,t.width-1)+ar(s,0,t.height-1)*t.width)*4,o=t.data[a],l=t.data[a+1],h=t.data[a+2]+256*(l+256*o),f=Math.floor((256*256*256-1)/e.length);h&&h%f===0&&r.push(e[h/f-1])}return r}class U5 extends el{constructor(e,t,r,i){super(e),this.inversePixelTransform=t,this.frameState=r,this.context=i}}const n$=5;class r$ extends Gp{constructor(e){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e,this.staleKeys_=new Array,this.maxStaleKeys=n$}getStaleKeys(){return this.staleKeys_}prependStaleKey(e){this.staleKeys_.unshift(e),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(e){return Vt()}getData(e){return null}prepareFrame(e){return Vt()}renderFrame(e,t){return Vt()}forEachFeatureAtCoordinate(e,t,r,i,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(e){const t=e.target;(t.getState()===vt.LOADED||t.getState()===vt.ERROR)&&this.renderIfReadyAndVisible()}loadImage(e){let t=e.getState();return t!=vt.LOADED&&t!=vt.ERROR&&e.addEventListener(Yt.CHANGE,this.boundHandleImageChange_),t==vt.IDLE&&(e.load(),t=e.getState()),t==vt.LOADED}renderIfReadyAndVisible(){const e=this.getLayer();e&&e.getVisible()&&e.getSourceState()==="ready"&&e.changed()}renderDeferred(e){}disposeInternal(){delete this.layer_,super.disposeInternal()}}const m4=[];let vf=null;function i$(){vf=ni(1,1,void 0,{willReadFrequently:!0})}class pI extends r${constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=Qa(),this.pixelTransform=Qa(),this.inversePixelTransform=Qa(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(e,t,r){vf||i$(),vf.clearRect(0,0,1,1);let i;try{vf.drawImage(e,t,r,1,1,0,0,1,1),i=vf.getImageData(0,0,1,1).data}catch{return vf=null,null}return i}getBackground(e){let r=this.getLayer().getBackground();return typeof r=="function"&&(r=r(e.viewState.resolution)),r||void 0}useContainer(e,t,r){const i=this.getLayer().getClassName();let s,a;if(e&&e.className===i&&(!r||e&&e.style.backgroundColor&&Su(Fh(e.style.backgroundColor),Fh(r)))){const o=e.firstElementChild;Wc(o)&&(a=o.getContext("2d"))}if(a&&IU(a.canvas.style.transform,t)?(this.container=e,this.context=a,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){s=qs?_5():document.createElement("div"),s.className=i;let o=s.style;o.position="absolute",o.width="100%",o.height="100%",a=ni();const l=a.canvas;s.appendChild(l),o=l.style,o.position="absolute",o.left="0",o.transformOrigin="top left",this.container=s,this.context=a}!this.containerReused&&r&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=r)}clipUnrotated(e,t,r){const i=sd(r),s=Mv(r),a=kv(r),o=Pv(r);ti(t.coordinateToPixelTransform,i),ti(t.coordinateToPixelTransform,s),ti(t.coordinateToPixelTransform,a),ti(t.coordinateToPixelTransform,o);const l=this.inversePixelTransform;ti(l,i),ti(l,s),ti(l,a),ti(l,o),e.save(),e.beginPath(),e.moveTo(Math.round(i[0]),Math.round(i[1])),e.lineTo(Math.round(s[0]),Math.round(s[1])),e.lineTo(Math.round(a[0]),Math.round(a[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.clip()}prepareContainer(e,t){const r=e.extent,i=e.viewState.resolution,s=e.viewState.rotation,a=e.pixelRatio,o=Math.round(un(r)/i*a),l=Math.round($r(r)/i*a);Ko(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/a,1/a,s,-o/2,-l/2),a5(this.inversePixelTransform,this.pixelTransform);const u=bU(this.pixelTransform);if(this.useContainer(t,u,this.getBackground(e)),!this.containerReused){const h=this.context.canvas;h.width!=o||h.height!=l?(h.width=o,h.height=l):this.context.clearRect(0,0,o,l),u!==h.style.transform&&(h.style.transform=u)}}dispatchRenderEvent_(e,t,r){const i=this.getLayer();if(i.hasListener(e)){const s=new U5(e,this.inversePixelTransform,r,t);i.dispatchEvent(s)}}preRender(e,t){this.frameState=t,!t.declutter&&this.dispatchRenderEvent_(va.PRERENDER,e,t)}postRender(e,t){t.declutter||this.dispatchRenderEvent_(va.POSTRENDER,e,t)}renderDeferredInternal(e){}getRenderContext(e){return e.declutter&&!this.deferredContext_&&(this.deferredContext_=new V5),e.declutter?this.deferredContext_.getContext():this.context}renderDeferred(e){e.declutter&&(this.dispatchRenderEvent_(va.PRERENDER,this.context,e),e.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(e),this.dispatchRenderEvent_(va.POSTRENDER,this.context,e))}getRenderTransform(e,t,r,i,s,a,o){const l=s/2,u=a/2,h=i/t,f=-h,g=-e[0]+o,y=-e[1];return Ko(this.tempTransform,l,u,h,f,-r,g,y)}disposeInternal(){delete this.frameState,super.disposeInternal()}}class s$ extends pI{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=Qs(),this.wrappedRenderedExtent_=Qs(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(e,t,r){const i=t.extent,s=t.viewState,a=s.center,o=s.resolution,l=s.projection,u=s.rotation,h=l.getExtent(),f=this.getLayer().getSource(),g=this.getLayer().getDeclutter(),y=t.pixelRatio,v=t.viewHints,x=!(v[hi.ANIMATING]||v[hi.INTERACTING]),E=this.context,T=Math.round(un(i)/o*y),b=Math.round($r(i)/o*y),I=f.getWrapX()&&l.canWrapX(),M=I?un(h):null,F=I?Math.ceil((i[2]-h[2])/M)+1:1;let z=I?Math.floor((i[0]-h[0])/M):0;do{let k=this.getRenderTransform(a,o,0,y,T,b,z*M);t.declutter&&(k=k.slice(0)),e.execute(E,[E.canvas.width,E.canvas.height],k,u,x,r===void 0?uh:r?G5:Zz,r?g&&t.declutter[g]:void 0)}while(++z<F)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=ni(this.context.canvas.width,this.context.canvas.height,m4))}resetDrawContext_(){if(this.opacity_!==1&&this.targetContext_){const e=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=e,Vv(this.context),m4.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(e){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,e,!0)}renderDeferredInternal(e){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(e,t){const r=e.layerStatesArray[e.layerIndex];this.opacity_=r.opacity;const i=e.viewState;this.prepareContainer(e,t);const s=this.context,a=this.replayGroup_;let o=a&&!a.isEmpty();if(!o&&!(this.getLayer().hasListener(va.PRERENDER)||this.getLayer().hasListener(va.POSTRENDER)))return this.container;if(this.setDrawContext_(),this.preRender(s,e),i.projection,this.clipped_=!1,o&&r.extent&&this.clipping){const l=No(r.extent);o=as(l,e.extent),this.clipped_=o&&!Uc(l,e.extent),this.clipped_&&this.clipUnrotated(s,e,l)}return o&&this.renderWorlds(a,e,this.getLayer().getDeclutter()?!1:void 0),!e.declutter&&this.clipped_&&s.restore(),this.postRender(s,e),this.renderedRotation_!==i.rotation&&(this.renderedRotation_=i.rotation,this.hitDetectionImageData_=null),e.declutter||this.resetDrawContext_(),this.container}getFeatures(e){return new Promise(t=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const r=this.frameState.size.slice(),i=this.renderedCenter_,s=this.renderedResolution_,a=this.renderedRotation_,o=this.renderedProjection_,l=this.wrappedRenderedExtent_,u=this.getLayer(),h=[],f=r[0]*ko,g=r[1]*ko;h.push(this.getRenderTransform(i,s,a,ko,f,g,0).slice());const y=u.getSource(),v=o.getExtent();if(y.getWrapX()&&o.canWrapX()&&!Uc(v,l)){let x=l[0];const E=un(v);let T=0,b;for(;x<v[0];)--T,b=E*T,h.push(this.getRenderTransform(i,s,a,ko,f,g,b).slice()),x+=E;for(T=0,x=l[2];x>v[2];)++T,b=E*T,h.push(this.getRenderTransform(i,s,a,ko,f,g,b).slice()),x-=E}this.hitDetectionImageData_=e$(r,h,this.renderedFeatures_,u.getStyleFunction(),l,s,a,e4(s,this.renderedPixelRatio_))}t(t$(e,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(e,t,r,i,s){if(!this.replayGroup_)return;const a=t.viewState.resolution,o=t.viewState.rotation,l=this.getLayer(),u={},h=function(g,y,v){const x=bn(g),E=u[x];if(E){if(E!==!0&&v<E.distanceSq){if(v===0)return u[x]=!0,s.splice(s.lastIndexOf(E),1),i(g,l,y);E.geometry=y,E.distanceSq=v}}else{if(v===0)return u[x]=!0,i(g,l,y);s.push(u[x]={feature:g,layer:l,geometry:y,distanceSq:v,callback:i})}},f=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(e,a,o,r,h,f?t.declutter?.[f]?.all().map(g=>g.value):null)}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}prepareFrame(e){const t=this.getLayer(),r=t.getSource();if(!r)return!1;const i=e.viewHints[hi.ANIMATING],s=e.viewHints[hi.INTERACTING],a=t.getUpdateWhileAnimating(),o=t.getUpdateWhileInteracting();if(this.ready&&!a&&i||!o&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const l=e.extent,u=e.viewState,h=u.projection,f=u.resolution,g=e.pixelRatio,y=t.getRevision(),v=t.getRenderBuffer();let x=t.getRenderOrder();x===void 0&&(x=mz);const E=u.center.slice(),T=Wm(l,v*f),b=T.slice(),I=[T.slice()],M=h.getExtent();if(r.getWrapX()&&h.canWrapX()&&!Uc(M,e.extent)){const Ie=un(M),ke=Math.max(un(T)/2,Ie);T[0]=M[0]-ke,T[2]=M[2]+ke,XO(E,h);const ze=KO(I[0],h);ze[0]<M[0]&&ze[2]<M[2]?I.push([ze[0]+Ie,ze[1],ze[2]+Ie,ze[3]]):ze[0]>M[0]&&ze[2]>M[2]&&I.push([ze[0]-Ie,ze[1],ze[2]-Ie,ze[3]])}if(this.ready&&this.renderedResolution_==f&&this.renderedRevision_==y&&this.renderedRenderOrder_==x&&this.renderedFrameDeclutter_===!!e.declutter&&Uc(this.wrappedRenderedExtent_,T))return Su(this.renderedExtent_,b)||(this.hitDetectionImageData_=null,this.renderedExtent_=b),this.renderedCenter_=E,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const F=new Hz(C5(f,g),T,f,g);let z;for(let Ie=0,ke=I.length;Ie<ke;++Ie)r.loadFeatures(I[Ie],f,h);const k=e4(f,g);let C=!0;const P=(Ie,ke)=>{let ze;const Ne=Ie.getStyleFunction()||t.getStyleFunction();if(Ne&&(ze=Ne(Ie,f)),ze){const ce=this.renderFeature(Ie,k,ze,F,z,this.getLayer().getDeclutter(),ke);C=C&&!ce}},L=s5(T),O=r.getFeaturesInExtent(L);x&&O.sort(x);for(let Ie=0,ke=O.length;Ie<ke;++Ie)P(O[Ie],Ie);this.renderedFeatures_=O,this.ready=C;const U=F.finish(),j=new Qz(T,f,g,r.getOverlaps(),U,t.getRenderBuffer(),!!e.declutter);return this.renderedResolution_=f,this.renderedRevision_=y,this.renderedRenderOrder_=x,this.renderedFrameDeclutter_=!!e.declutter,this.renderedExtent_=b,this.wrappedRenderedExtent_=T,this.renderedCenter_=E,this.renderedProjection_=h,this.renderedPixelRatio_=g,this.replayGroup_=j,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(e,t,r,i,s,a,o){if(!r)return!1;let l=!1;if(Array.isArray(r))for(let u=0,h=r.length;u<h;++u)l=t4(i,e,r[u],t,this.boundHandleStyleImageChange_,s,a,o)||l;else l=t4(i,e,r,t,this.boundHandleStyleImageChange_,s,a,o);return l}}let ud=0;const ss=1<<ud++,mn=1<<ud++,Es=1<<ud++,Wa=1<<ud++,Vh=1<<ud++,Xg=1<<ud++,Hy=Math.pow(2,ud)-1,yI={[ss]:"boolean",[mn]:"number",[Es]:"string",[Wa]:"color",[Vh]:"number[]",[Xg]:"size"},a$=Object.keys(yI).map(Number).sort(Cl);function o$(n){return n in yI}function Zg(n){const e=[];for(const t of a$)Qg(n,t)&&e.push(yI[t]);return e.length===0?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function Qg(n,e){return(n&e)===e}function bc(n,e){return n===e}class ei{constructor(e,t){if(!o$(e))throw new Error(`literal expressions must have a specific type, got ${Zg(e)}`);this.type=e,this.value=t}}class l${constructor(e,t,...r){this.type=e,this.operator=t,this.args=r}}function z5(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function Pi(n,e,t){switch(typeof n){case"boolean":{if(bc(e,Es))return new ei(Es,n?"true":"false");if(!Qg(e,ss))throw new Error(`got a boolean, but expected ${Zg(e)}`);return new ei(ss,n)}case"number":{if(bc(e,Xg))return new ei(Xg,bs(n));if(bc(e,ss))return new ei(ss,!!n);if(bc(e,Es))return new ei(Es,n.toString());if(!Qg(e,mn))throw new Error(`got a number, but expected ${Zg(e)}`);return new ei(mn,n)}case"string":{if(bc(e,Wa))return new ei(Wa,cI(n));if(bc(e,ss))return new ei(ss,!!n);if(!Qg(e,Es))throw new Error(`got a string, but expected ${Zg(e)}`);return new ei(Es,n)}}if(!Array.isArray(n))throw new Error("expression must be an array or a primitive value");if(n.length===0)throw new Error("empty expression");if(typeof n[0]=="string")return x$(n,e,t);for(const r of n)if(typeof r!="number")throw new Error("expected an array of numbers");if(bc(e,Xg)){if(n.length!==2)throw new Error(`expected an array of two values for a size, got ${n.length}`);return new ei(Xg,n)}if(bc(e,Wa)){if(n.length===3)return new ei(Wa,[...n,1]);if(n.length===4)return new ei(Wa,n);throw new Error(`expected an array of 3 or 4 values for a color, got ${n.length}`)}if(!Qg(e,Vh))throw new Error(`got an array of numbers, but expected ${Zg(e)}`);return new ei(Vh,n)}const Le={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},c$={[Le.Get]:Wt(tn(1,1/0),p4),[Le.Var]:Wt(tn(1,1),u$),[Le.Has]:Wt(tn(1,1/0),p4),[Le.Id]:Wt(h$,rf),[Le.Concat]:Wt(tn(2,1/0),An(Es)),[Le.GeometryType]:Wt(d$,rf),[Le.LineMetric]:Wt(rf),[Le.Resolution]:Wt(j2,rf),[Le.Zoom]:Wt(j2,rf),[Le.Time]:Wt(j2,rf),[Le.Any]:Wt(tn(2,1/0),An(ss)),[Le.All]:Wt(tn(2,1/0),An(ss)),[Le.Not]:Wt(tn(1,1),An(ss)),[Le.Equal]:Wt(tn(2,2),An(Hy)),[Le.NotEqual]:Wt(tn(2,2),An(Hy)),[Le.GreaterThan]:Wt(tn(2,2),An(mn)),[Le.GreaterThanOrEqualTo]:Wt(tn(2,2),An(mn)),[Le.LessThan]:Wt(tn(2,2),An(mn)),[Le.LessThanOrEqualTo]:Wt(tn(2,2),An(mn)),[Le.Multiply]:Wt(tn(2,1/0),y4),[Le.Coalesce]:Wt(tn(2,1/0),y4),[Le.Divide]:Wt(tn(2,2),An(mn)),[Le.Add]:Wt(tn(2,1/0),An(mn)),[Le.Subtract]:Wt(tn(2,2),An(mn)),[Le.Clamp]:Wt(tn(3,3),An(mn)),[Le.Mod]:Wt(tn(2,2),An(mn)),[Le.Pow]:Wt(tn(2,2),An(mn)),[Le.Abs]:Wt(tn(1,1),An(mn)),[Le.Floor]:Wt(tn(1,1),An(mn)),[Le.Ceil]:Wt(tn(1,1),An(mn)),[Le.Round]:Wt(tn(1,1),An(mn)),[Le.Sin]:Wt(tn(1,1),An(mn)),[Le.Cos]:Wt(tn(1,1),An(mn)),[Le.Atan]:Wt(tn(1,2),An(mn)),[Le.Sqrt]:Wt(tn(1,1),An(mn)),[Le.Match]:Wt(tn(4,1/0),_4,g$),[Le.Between]:Wt(tn(3,3),An(mn)),[Le.Interpolate]:Wt(tn(6,1/0),_4,m$),[Le.Case]:Wt(tn(3,1/0),f$,p$),[Le.In]:Wt(tn(2,2),y$),[Le.Number]:Wt(tn(1,1/0),An(Hy)),[Le.String]:Wt(tn(1,1/0),An(Hy)),[Le.Array]:Wt(tn(1,1/0),An(mn)),[Le.Color]:Wt(tn(1,4),An(mn)),[Le.Band]:Wt(tn(1,3),An(mn)),[Le.Palette]:Wt(tn(2,2),_$),[Le.ToString]:Wt(tn(1,1),An(ss|mn|Es|Wa))};function p4(n,e,t){const r=n.length-1,i=new Array(r);for(let s=0;s<r;++s){const a=n[s+1];switch(typeof a){case"number":{i[s]=new ei(mn,a);break}case"string":{i[s]=new ei(Es,a);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${a}`)}s===0&&t.properties.add(String(a))}return i}function u$(n,e,t){const r=n[1];if(typeof r!="string")throw new Error("expected a string argument for var operation");return t.variables.add(r),[new ei(Es,r)]}function h$(n,e,t){t.featureId=!0}function d$(n,e,t){t.geometryType=!0}function j2(n,e,t){t.mapState=!0}function rf(n,e,t){const r=n[0];if(n.length!==1)throw new Error(`expected no arguments for ${r} operation`);return[]}function tn(n,e){return function(t,r,i){const s=t[0],a=t.length-1;if(n===e){if(a!==n){const o=n===1?"":"s";throw new Error(`expected ${n} argument${o} for ${s}, got ${a}`)}}else if(a<n||a>e){const o=e===1/0?`${n} or more`:`${n} to ${e}`;throw new Error(`expected ${o} arguments for ${s}, got ${a}`)}}}function y4(n,e,t){const r=n.length-1,i=new Array(r);for(let s=0;s<r;++s){const a=Pi(n[s+1],e,t);i[s]=a}return i}function An(n){return function(e,t,r){const i=e.length-1,s=new Array(i);for(let a=0;a<i;++a){const o=Pi(e[a+1],n,r);s[a]=o}return s}}function f$(n,e,t){const r=n[0],i=n.length-1;if(i%2===0)throw new Error(`expected an odd number of arguments for ${r}, got ${i} instead`)}function _4(n,e,t){const r=n[0],i=n.length-1;if(i%2===1)throw new Error(`expected an even number of arguments for operation ${r}, got ${i} instead`)}function g$(n,e,t){const r=n.length-1,i=Es|mn|ss,s=Pi(n[1],i,t),a=Pi(n[n.length-1],e,t),o=new Array(r-2);for(let l=0;l<r-2;l+=2){try{const u=Pi(n[l+2],s.type,t);o[l]=u}catch(u){throw new Error(`failed to parse argument ${l+1} of match expression: ${u.message}`)}try{const u=Pi(n[l+3],a.type,t);o[l+1]=u}catch(u){throw new Error(`failed to parse argument ${l+2} of match expression: ${u.message}`)}}return[s,...o,a]}function m$(n,e,t){const r=n[1];let i;switch(r[0]){case"linear":i=1;break;case"exponential":const l=r[1];if(typeof l!="number"||l<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(l)} instead`);i=l;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(r)}`)}const s=new ei(mn,i);let a;try{a=Pi(n[2],mn,t)}catch(l){throw new Error(`failed to parse argument 1 in interpolate expression: ${l.message}`)}const o=new Array(n.length-3);for(let l=0;l<o.length;l+=2){try{const u=Pi(n[l+3],mn,t);o[l]=u}catch(u){throw new Error(`failed to parse argument ${l+2} for interpolate expression: ${u.message}`)}try{const u=Pi(n[l+4],e,t);o[l+1]=u}catch(u){throw new Error(`failed to parse argument ${l+3} for interpolate expression: ${u.message}`)}}return[s,a,...o]}function p$(n,e,t){const r=Pi(n[n.length-1],e,t),i=new Array(n.length-1);for(let s=0;s<i.length-1;s+=2){try{const a=Pi(n[s+1],ss,t);i[s]=a}catch(a){throw new Error(`failed to parse argument ${s} of case expression: ${a.message}`)}try{const a=Pi(n[s+2],r.type,t);i[s+1]=a}catch(a){throw new Error(`failed to parse argument ${s+1} of case expression: ${a.message}`)}}return i[i.length-1]=r,i}function y$(n,e,t){let r=n[2];if(!Array.isArray(r))throw new Error('the second argument for the "in" operator must be an array');let i;if(typeof r[0]=="string"){if(r[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(r[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');r=r[1],i=Es}else i=mn;const s=new Array(r.length);for(let o=0;o<s.length;o++)try{const l=Pi(r[o],i,t);s[o]=l}catch(l){throw new Error(`failed to parse haystack item ${o} for "in" expression: ${l.message}`)}return[Pi(n[1],i,t),...s]}function _$(n,e,t){let r;try{r=Pi(n[1],mn,t)}catch(a){throw new Error(`failed to parse first argument in palette expression: ${a.message}`)}const i=n[2];if(!Array.isArray(i))throw new Error("the second argument of palette must be an array");const s=new Array(i.length);for(let a=0;a<s.length;a++){let o;try{o=Pi(i[a],Wa,t)}catch(l){throw new Error(`failed to parse color at index ${a} in palette expression: ${l.message}`)}if(!(o instanceof ei))throw new Error(`the palette color at index ${a} must be a literal value`);s[a]=o}return[r,...s]}function Wt(...n){return function(e,t,r){const i=e[0];let s;for(let a=0;a<n.length;a++){const o=n[a](e,t,r);if(a==n.length-1){if(!o)throw new Error("expected last argument validator to return the parsed args");s=o}}return new l$(t,i,...s)}}function x$(n,e,t){const r=n[0],i=c$[r];if(!i)throw new Error(`unknown operator: ${r}`);return i(n,e,t)}function $5(n){if(!n)return"";const e=n.getType();switch(e){case"Point":case"LineString":case"Polygon":return e;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return e.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return $5(n.getGeometries()[0]);default:return""}}function W5(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function ql(n,e,t){const r=Pi(n,e,t);return ao(r)}function ao(n,e){if(n instanceof ei){if(n.type===Wa&&typeof n.value=="string"){const r=cI(n.value);return function(){return r}}return function(){return n.value}}const t=n.operator;switch(t){case Le.Number:case Le.String:case Le.Coalesce:return v$(n);case Le.Get:case Le.Var:case Le.Has:return w$(n);case Le.Id:return r=>r.featureId;case Le.GeometryType:return r=>r.geometryType;case Le.Concat:{const r=n.args.map(i=>ao(i));return i=>"".concat(...r.map(s=>s(i).toString()))}case Le.Resolution:return r=>r.resolution;case Le.Any:case Le.All:case Le.Between:case Le.In:case Le.Not:return S$(n);case Le.Equal:case Le.NotEqual:case Le.LessThan:case Le.LessThanOrEqualTo:case Le.GreaterThan:case Le.GreaterThanOrEqualTo:return E$(n);case Le.Multiply:case Le.Divide:case Le.Add:case Le.Subtract:case Le.Clamp:case Le.Mod:case Le.Pow:case Le.Abs:case Le.Floor:case Le.Ceil:case Le.Round:case Le.Sin:case Le.Cos:case Le.Atan:case Le.Sqrt:return T$(n);case Le.Case:return b$(n);case Le.Match:return I$(n);case Le.Interpolate:return A$(n);case Le.ToString:return R$(n);default:throw new Error(`Unsupported operator ${t}`)}}function v$(n,e){const t=n.operator,r=n.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=ao(n.args[s]);switch(t){case Le.Coalesce:return s=>{for(let a=0;a<r;++a){const o=i[a](s);if(typeof o<"u"&&o!==null)return o}throw new Error("Expected one of the values to be non-null")};case Le.Number:case Le.String:return s=>{for(let a=0;a<r;++a){const o=i[a](s);if(typeof o===t)return o}throw new Error(`Expected one of the values to be a ${t}`)};default:throw new Error(`Unsupported assertion operator ${t}`)}}function w$(n,e){const r=n.args[0].value;switch(n.operator){case Le.Get:return i=>{const s=n.args;let a=i.properties[r];for(let o=1,l=s.length;o<l;++o){const h=s[o].value;a=a[h]}return a};case Le.Var:return i=>i.variables[r];case Le.Has:return i=>{const s=n.args;if(!(r in i.properties))return!1;let a=i.properties[r];for(let o=1,l=s.length;o<l;++o){const h=s[o].value;if(!a||!Object.hasOwn(a,h))return!1;a=a[h]}return!0};default:throw new Error(`Unsupported accessor operator ${n.operator}`)}}function E$(n,e){const t=n.operator,r=ao(n.args[0]),i=ao(n.args[1]);switch(t){case Le.Equal:return s=>r(s)===i(s);case Le.NotEqual:return s=>r(s)!==i(s);case Le.LessThan:return s=>r(s)<i(s);case Le.LessThanOrEqualTo:return s=>r(s)<=i(s);case Le.GreaterThan:return s=>r(s)>i(s);case Le.GreaterThanOrEqualTo:return s=>r(s)>=i(s);default:throw new Error(`Unsupported comparison operator ${t}`)}}function S$(n,e){const t=n.operator,r=n.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=ao(n.args[s]);switch(t){case Le.Any:return s=>{for(let a=0;a<r;++a)if(i[a](s))return!0;return!1};case Le.All:return s=>{for(let a=0;a<r;++a)if(!i[a](s))return!1;return!0};case Le.Between:return s=>{const a=i[0](s),o=i[1](s),l=i[2](s);return a>=o&&a<=l};case Le.In:return s=>{const a=i[0](s);for(let o=1;o<r;++o)if(a===i[o](s))return!0;return!1};case Le.Not:return s=>!i[0](s);default:throw new Error(`Unsupported logical operator ${t}`)}}function T$(n,e){const t=n.operator,r=n.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=ao(n.args[s]);switch(t){case Le.Multiply:return s=>{let a=1;for(let o=0;o<r;++o)a*=i[o](s);return a};case Le.Divide:return s=>i[0](s)/i[1](s);case Le.Add:return s=>{let a=0;for(let o=0;o<r;++o)a+=i[o](s);return a};case Le.Subtract:return s=>i[0](s)-i[1](s);case Le.Clamp:return s=>{const a=i[0](s),o=i[1](s);if(a<o)return o;const l=i[2](s);return a>l?l:a};case Le.Mod:return s=>i[0](s)%i[1](s);case Le.Pow:return s=>Math.pow(i[0](s),i[1](s));case Le.Abs:return s=>Math.abs(i[0](s));case Le.Floor:return s=>Math.floor(i[0](s));case Le.Ceil:return s=>Math.ceil(i[0](s));case Le.Round:return s=>Math.round(i[0](s));case Le.Sin:return s=>Math.sin(i[0](s));case Le.Cos:return s=>Math.cos(i[0](s));case Le.Atan:return r===2?s=>Math.atan2(i[0](s),i[1](s)):s=>Math.atan(i[0](s));case Le.Sqrt:return s=>Math.sqrt(i[0](s));default:throw new Error(`Unsupported numeric operator ${t}`)}}function b$(n,e){const t=n.args.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=ao(n.args[i]);return i=>{for(let s=0;s<t-1;s+=2)if(r[s](i))return r[s+1](i);return r[t-1](i)}}function I$(n,e){const t=n.args.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=ao(n.args[i]);return i=>{const s=r[0](i);for(let a=1;a<t-1;a+=2)if(s===r[a](i))return r[a+1](i);return r[t-1](i)}}function A$(n,e){const t=n.args.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=ao(n.args[i]);return i=>{const s=r[0](i),a=r[1](i);let o,l;for(let u=2;u<t;u+=2){const h=r[u](i);let f=r[u+1](i);const g=Array.isArray(f);if(g&&(f=JU(f)),h>=a)return u===2?f:g?C$(s,a,o,l,h,f):Jg(s,a,o,l,h,f);o=h,l=f}return l}}function R$(n,e){const t=n.operator,r=n.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=ao(n.args[s]);switch(t){case Le.ToString:return s=>{const a=i[0](s);return n.args[0].type===Wa?uI(a):a.toString()};default:throw new Error(`Unsupported convert operator ${t}`)}}function Jg(n,e,t,r,i,s){const a=i-t;if(a===0)return r;const o=e-t,l=n===1?o/a:(Math.pow(n,o)-1)/(Math.pow(n,a)-1);return r+l*(s-r)}function C$(n,e,t,r,i,s){if(i-t===0)return r;const o=qk(r),l=qk(s);let u=l[2]-o[2];u>180?u-=360:u<-180&&(u+=360);const h=[Jg(n,e,t,o[0],i,l[0]),Jg(n,e,t,o[1],i,l[1]),o[2]+Jg(n,e,t,0,i,u),Jg(n,e,t,r[3],i,s[3])];return ez(h)}function P$(n){return!0}function k$(n){const e=z5(),t=M$(n,e),r=W5();return function(i,s){if(r.properties=i.getPropertiesInternal(),r.resolution=s,e.featureId){const a=i.getId();a!==void 0?r.featureId=a:r.featureId=null}return e.geometryType&&(r.geometryType=$5(i.getGeometry())),t(r)}}function x4(n){const e=z5(),t=n.length,r=new Array(t);for(let a=0;a<t;++a)r[a]=hT(n[a],e);const i=W5(),s=new Array(t);return function(a,o){if(i.properties=a.getPropertiesInternal(),i.resolution=o,e.featureId){const u=a.getId();u!==void 0?i.featureId=u:i.featureId=null}let l=0;for(let u=0;u<t;++u){const h=r[u](i);h&&(s[l]=h,l+=1)}return s.length=l,s}}function M$(n,e){const t=n.length,r=new Array(t);for(let i=0;i<t;++i){const s=n[i],a="filter"in s?ql(s.filter,ss,e):P$;let o;if(Array.isArray(s.style)){const l=s.style.length;o=new Array(l);for(let u=0;u<l;++u)o[u]=hT(s.style[u],e)}else o=[hT(s.style,e)];r[i]={filter:a,styles:o}}return function(i){const s=[];let a=!1;for(let o=0;o<t;++o){const l=r[o].filter;if(l(i)&&!(n[o].else&&a)){a=!0;for(const u of r[o].styles){const h=u(i);h&&s.push(h)}}}return s}}function hT(n,e){const t=Jm(n,"",e),r=ep(n,"",e),i=N$(n,e),s=L$(n,e),a=Ss(n,"z-index",e);if(!t&&!r&&!i&&!s&&!Nh(n))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(n));const o=new nr;return function(l){let u=!0;if(t){const h=t(l);h&&(u=!1),o.setFill(h)}if(r){const h=r(l);h&&(u=!1),o.setStroke(h)}if(i){const h=i(l);h&&(u=!1),o.setText(h)}if(s){const h=s(l);h&&(u=!1),o.setImage(h)}return a&&o.setZIndex(a(l)),u?null:o}}function Jm(n,e,t){let r;if(e+"fill-pattern-src"in n)r=j$(n,e+"fill-",t);else{if(n[e+"fill-color"]==="none")return s=>null;r=_I(n,e+"fill-color",t)}if(!r)return null;const i=new Wr;return function(s){const a=r(s);return a===lI?null:(i.setColor(a),i)}}function ep(n,e,t){const r=Ss(n,e+"stroke-width",t),i=_I(n,e+"stroke-color",t);if(!r&&!i)return null;const s=El(n,e+"stroke-line-cap",t),a=El(n,e+"stroke-line-join",t),o=H5(n,e+"stroke-line-dash",t),l=Ss(n,e+"stroke-line-dash-offset",t),u=Ss(n,e+"stroke-miter-limit",t),h=new Ci;return function(f){if(i){const g=i(f);if(g===lI)return null;h.setColor(g)}if(r&&h.setWidth(r(f)),s){const g=s(f);if(g!=="butt"&&g!=="round"&&g!=="square")throw new Error("Expected butt, round, or square line cap");h.setLineCap(g)}if(a){const g=a(f);if(g!=="bevel"&&g!=="round"&&g!=="miter")throw new Error("Expected bevel, round, or miter line join");h.setLineJoin(g)}return o&&h.setLineDash(o(f)),l&&h.setLineDashOffset(l(f)),u&&h.setMiterLimit(u(f)),h}}function N$(n,e){const t="text-",r=El(n,t+"value",e);if(!r)return null;const i=Jm(n,t,e),s=Jm(n,t+"background-",e),a=ep(n,t,e),o=ep(n,t+"background-",e),l=El(n,t+"font",e),u=Ss(n,t+"max-angle",e),h=Ss(n,t+"offset-x",e),f=Ss(n,t+"offset-y",e),g=zf(n,t+"overflow",e),y=El(n,t+"placement",e),v=Ss(n,t+"repeat",e),x=Uv(n,t+"scale",e),E=zf(n,t+"rotate-with-view",e),T=Ss(n,t+"rotation",e),b=El(n,t+"align",e),I=El(n,t+"justify",e),M=El(n,t+"baseline",e),F=zf(n,t+"keep-upright",e),z=H5(n,t+"padding",e),k=zv(n,t+"declutter-mode"),C=new cd({declutterMode:k});return function(P){if(C.setText(r(P)),i&&C.setFill(i(P)),s&&C.setBackgroundFill(s(P)),a&&C.setStroke(a(P)),o&&C.setBackgroundStroke(o(P)),l&&C.setFont(l(P)),u&&C.setMaxAngle(u(P)),h&&C.setOffsetX(h(P)),f&&C.setOffsetY(f(P)),g&&C.setOverflow(g(P)),y){const L=y(P);if(L!=="point"&&L!=="line")throw new Error("Expected point or line for text-placement");C.setPlacement(L)}if(v&&C.setRepeat(v(P)),x&&C.setScale(x(P)),E&&C.setRotateWithView(E(P)),T&&C.setRotation(T(P)),b){const L=b(P);if(L!=="left"&&L!=="center"&&L!=="right"&&L!=="end"&&L!=="start")throw new Error("Expected left, right, center, start, or end for text-align");C.setTextAlign(L)}if(I){const L=I(P);if(L!=="left"&&L!=="right"&&L!=="center")throw new Error("Expected left, right, or center for text-justify");C.setJustify(L)}if(M){const L=M(P);if(L!=="bottom"&&L!=="top"&&L!=="middle"&&L!=="alphabetic"&&L!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");C.setTextBaseline(L)}return z&&C.setPadding(z(P)),F&&C.setKeepUpright(F(P)),C}}function L$(n,e){return"icon-src"in n?O$(n,e):"shape-points"in n?D$(n,e):"circle-radius"in n?F$(n,e):null}function O$(n,e){const t="icon-",r=t+"src",i=K5(n[r],r),s=dx(n,t+"anchor",e),a=Uv(n,t+"scale",e),o=Ss(n,t+"opacity",e),l=dx(n,t+"displacement",e),u=Ss(n,t+"rotation",e),h=zf(n,t+"rotate-with-view",e),f=w4(n,t+"anchor-origin"),g=E4(n,t+"anchor-x-units"),y=E4(n,t+"anchor-y-units"),v=U$(n,t+"color"),x=G$(n,t+"cross-origin"),E=B$(n,t+"offset"),T=w4(n,t+"offset-origin"),b=fx(n,t+"width"),I=fx(n,t+"height"),M=V$(n,t+"size"),F=zv(n,t+"declutter-mode"),z=new qp({src:i,anchorOrigin:f,anchorXUnits:g,anchorYUnits:y,color:v,crossOrigin:x,offset:E,offsetOrigin:T,height:I,width:b,size:M,declutterMode:F});return function(k){return o&&z.setOpacity(o(k)),l&&z.setDisplacement(l(k)),u&&z.setRotation(u(k)),h&&z.setRotateWithView(h(k)),a&&z.setScale(a(k)),s&&z.setAnchor(s(k)),z}}function D$(n,e){const t="shape-",r=t+"points",i=t+"radius",s=dT(n[r],r),a=dT(n[i],i),o=Jm(n,t,e),l=ep(n,t,e),u=Uv(n,t+"scale",e),h=dx(n,t+"displacement",e),f=Ss(n,t+"rotation",e),g=zf(n,t+"rotate-with-view",e),y=fx(n,t+"radius2"),v=fx(n,t+"angle"),x=zv(n,t+"declutter-mode"),E=new Bv({points:s,radius:a,radius2:y,angle:v,declutterMode:x});return function(T){return o&&E.setFill(o(T)),l&&E.setStroke(l(T)),h&&E.setDisplacement(h(T)),f&&E.setRotation(f(T)),g&&E.setRotateWithView(g(T)),u&&E.setScale(u(T)),E}}function F$(n,e){const t="circle-",r=Jm(n,t,e),i=ep(n,t,e),s=Ss(n,t+"radius",e),a=Uv(n,t+"scale",e),o=dx(n,t+"displacement",e),l=Ss(n,t+"rotation",e),u=zf(n,t+"rotate-with-view",e),h=zv(n,t+"declutter-mode"),f=new Yo({radius:5,declutterMode:h});return function(g){return s&&f.setRadius(s(g)),r&&f.setFill(r(g)),i&&f.setStroke(i(g)),o&&f.setDisplacement(o(g)),l&&f.setRotation(l(g)),u&&f.setRotateWithView(u(g)),a&&f.setScale(a(g)),f}}function Ss(n,e,t){if(!(e in n))return;const r=ql(n[e],mn,t);return function(i){return dT(r(i),e)}}function El(n,e,t){if(!(e in n))return null;const r=ql(n[e],Es,t);return function(i){return K5(r(i),e)}}function j$(n,e,t){const r=El(n,e+"pattern-src",t),i=v4(n,e+"pattern-offset",t),s=v4(n,e+"pattern-size",t),a=_I(n,e+"color",t);return function(o){return{src:r(o),offset:i&&i(o),size:s&&s(o),color:a&&a(o)}}}function zf(n,e,t){if(!(e in n))return null;const r=ql(n[e],ss,t);return function(i){const s=r(i);if(typeof s!="boolean")throw new Error(`Expected a boolean for ${e}`);return s}}function _I(n,e,t){if(!(e in n))return null;const r=ql(n[e],Wa,t);return function(i){return Y5(r(i),e)}}function H5(n,e,t){if(!(e in n))return null;const r=ql(n[e],Vh,t);return function(i){return Xp(r(i),e)}}function dx(n,e,t){if(!(e in n))return null;const r=ql(n[e],Vh,t);return function(i){const s=Xp(r(i),e);if(s.length!==2)throw new Error(`Expected two numbers for ${e}`);return s}}function v4(n,e,t){if(!(e in n))return null;const r=ql(n[e],Vh,t);return function(i){return q5(r(i),e)}}function Uv(n,e,t){if(!(e in n))return null;const r=ql(n[e],Vh|mn,t);return function(i){return z$(r(i),e)}}function fx(n,e){const t=n[e];if(t!==void 0){if(typeof t!="number")throw new Error(`Expected a number for ${e}`);return t}}function V$(n,e){const t=n[e];if(t!==void 0){if(typeof t=="number")return bs(t);if(!Array.isArray(t))throw new Error(`Expected a number or size array for ${e}`);if(t.length!==2||typeof t[0]!="number"||typeof t[1]!="number")throw new Error(`Expected a number or size array for ${e}`);return t}}function G$(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);return t}}function w4(n,e){const t=n[e];if(t!==void 0){if(t!=="bottom-left"&&t!=="bottom-right"&&t!=="top-left"&&t!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return t}}function E4(n,e){const t=n[e];if(t!==void 0){if(t!=="pixels"&&t!=="fraction")throw new Error(`Expected pixels or fraction for ${e}`);return t}}function B$(n,e){const t=n[e];if(t!==void 0)return Xp(t,e)}function zv(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);if(t!=="declutter"&&t!=="obstacle"&&t!=="none")throw new Error(`Expected declutter, obstacle, or none for ${e}`);return t}}function U$(n,e){const t=n[e];if(t!==void 0)return Y5(t,e)}function Xp(n,e){if(!Array.isArray(n))throw new Error(`Expected an array for ${e}`);const t=n.length;for(let r=0;r<t;++r)if(typeof n[r]!="number")throw new Error(`Expected an array of numbers for ${e}`);return n}function K5(n,e){if(typeof n!="string")throw new Error(`Expected a string for ${e}`);return n}function dT(n,e){if(typeof n!="number")throw new Error(`Expected a number for ${e}`);return n}function Y5(n,e){if(typeof n=="string")return n;const t=Xp(n,e),r=t.length;if(r<3||r>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return t}function q5(n,e){const t=Xp(n,e);if(t.length!==2)throw new Error(`Expected an array of two numbers for ${e}`);return t}function z$(n,e){return typeof n=="number"?n:q5(n,e)}const ja={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function S4(n,e,t){return(function(r,i,s,a,o){if(!r)return;if(!i&&!e)return r;const l=e?0:s[0]*i,u=e?0:s[1]*i,h=o?o[0]:0,f=o?o[1]:0;let g=n[0]+l/2+h,y=n[2]-l/2+h,v=n[1]+u/2+f,x=n[3]-u/2+f;g>y&&(g=(y+g)/2,y=g),v>x&&(v=(x+v)/2,x=v);let E=ar(r[0],g,y),T=ar(r[1],v,x);if(a&&t&&i){const b=30*i;E+=-b*Math.log(1+Math.max(0,g-r[0])/b)+b*Math.log(1+Math.max(0,r[0]-y)/b),T+=-b*Math.log(1+Math.max(0,v-r[1])/b)+b*Math.log(1+Math.max(0,r[1]-x)/b)}return[E,T]})}function $$(n){return n}function X5(n){return Math.pow(n,3)}function L0(n){return 1-X5(1-n)}function W$(n){return 3*n*n-2*n*n*n}function H$(n){return n}function xI(n,e,t,r){const i=un(e)/t[0],s=$r(e)/t[1];return r?Math.min(n,Math.max(i,s)):Math.min(n,Math.min(i,s))}function vI(n,e,t){let r=Math.min(n,e);const i=50;return r*=Math.log(1+i*Math.max(0,n/e-1))/i+1,t&&(r=Math.max(r,t),r/=Math.log(1+i*Math.max(0,t/n-1))/i+1),ar(r,t/2,e*2)}function K$(n,e,t,r){return e=e!==void 0?e:!0,(function(i,s,a,o){if(i!==void 0){const l=n[0],u=n[n.length-1],h=t?xI(l,t,a,r):l;if(o)return e?vI(i,h,u):ar(i,u,h);const f=Math.min(h,i),g=Math.floor(Rv(n,f,s));return n[g]>h&&g<n.length-1?n[g+1]:n[g]}})}function Y$(n,e,t,r,i,s){return r=r!==void 0?r:!0,t=t!==void 0?t:0,(function(a,o,l,u){if(a!==void 0){const h=i?xI(e,i,l,s):e;if(u)return r?vI(a,h,t):ar(a,t,h);const f=1e-9,g=Math.ceil(Math.log(e/h)/Math.log(n)-f),y=-o*(.5-f)+.5,v=Math.min(h,a),x=Math.floor(Math.log(e/v)/Math.log(n)+y),E=Math.max(g,x),T=e/Math.pow(n,E);return ar(T,t,h)}})}function T4(n,e,t,r,i){return t=t!==void 0?t:!0,(function(s,a,o,l){if(s!==void 0){const u=r?xI(n,r,o,i):n;return!t||!l?ar(s,e,u):vI(s,u,e)}})}function wI(n){if(n!==void 0)return 0}function b4(n){if(n!==void 0)return n}function q$(n){const e=2*Math.PI/n;return(function(t,r){if(r)return t;if(t!==void 0)return t=Math.floor(t/e+.5)*e,t})}function X$(n){const e=kl(5);return(function(t,r){return r||t===void 0?t:Math.abs(t)<=e?0:t})}const Z$=42,EI=256,V2=0;class Mo extends tl{constructor(e){super(),this.on,this.once,this.un,e=Object.assign({},e),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=Qb(e.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,e.projection&&i5(),e.center&&(e.center=wl(e.center,this.projection_)),e.extent&&(e.extent=No(e.extent,this.projection_)),this.applyOptions_(e)}applyOptions_(e){const t=Object.assign({},e);for(const o in ja)delete t[o];this.setProperties(t,!0);const r=J$(e);this.maxResolution_=r.maxResolution,this.minResolution_=r.minResolution,this.zoomFactor_=r.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=r.minZoom;const i=Q$(e),s=r.constraint,a=eW(e);this.constraints_={center:i,resolution:s,rotation:a},this.setRotation(e.rotation!==void 0?e.rotation:0),this.setCenterInternal(e.center!==void 0?e.center:null),e.resolution!==void 0?this.setResolution(e.resolution):e.zoom!==void 0&&this.setZoom(e.zoom)}get padding(){return this.padding_}set padding(e){let t=this.padding_;this.padding_=e;const r=this.getCenterInternal();if(r){const i=e||[0,0,0,0];t=t||[0,0,0,0];const s=this.getResolution(),a=s/2*(i[3]-t[3]+t[1]-i[1]),o=s/2*(i[0]-t[0]+t[2]-i[2]);this.setCenterInternal([r[0]+a,r[1]-o])}}getUpdatedOptions_(e){const t=this.getProperties();return t.resolution!==void 0?t.resolution=this.getResolution():t.zoom=this.getZoom(),t.center=this.getCenterInternal(),t.rotation=this.getRotation(),Object.assign({},t,e)}animate(e){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const t=new Array(arguments.length);for(let r=0;r<t.length;++r){let i=arguments[r];i.center&&(i=Object.assign({},i),i.center=wl(i.center,this.getProjection())),i.anchor&&(i=Object.assign({},i),i.anchor=wl(i.anchor,this.getProjection())),t[r]=i}this.animateInternal.apply(this,t)}animateInternal(e){let t=arguments.length,r;t>1&&typeof arguments[t-1]=="function"&&(r=arguments[t-1],--t);let i=0;for(;i<t&&!this.isDef();++i){const h=arguments[i];h.center&&this.setCenterInternal(h.center),h.zoom!==void 0?this.setZoom(h.zoom):h.resolution&&this.setResolution(h.resolution),h.rotation!==void 0&&this.setRotation(h.rotation)}if(i===t){r&&Ky(r,!0);return}let s=Date.now(),a=this.targetCenter_.slice(),o=this.targetResolution_,l=this.targetRotation_;const u=[];for(;i<t;++i){const h=arguments[i],f={start:s,complete:!1,anchor:h.anchor,duration:h.duration!==void 0?h.duration:1e3,easing:h.easing||W$,callback:r};if(h.center&&(f.sourceCenter=a,f.targetCenter=h.center.slice(),a=f.targetCenter),h.zoom!==void 0?(f.sourceResolution=o,f.targetResolution=this.getResolutionForZoom(h.zoom),o=f.targetResolution):h.resolution&&(f.sourceResolution=o,f.targetResolution=h.resolution,o=f.targetResolution),h.rotation!==void 0){f.sourceRotation=l;const g=Jc(h.rotation-l+Math.PI,2*Math.PI)-Math.PI;f.targetRotation=l+g,l=f.targetRotation}tW(f)?f.complete=!0:s+=f.duration,u.push(f)}this.animations_.push(u),this.setHint(hi.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[hi.ANIMATING]>0}getInteracting(){return this.hints_[hi.INTERACTING]>0}cancelAnimations(){this.setHint(hi.ANIMATING,-this.hints_[hi.ANIMATING]);let e;for(let t=0,r=this.animations_.length;t<r;++t){const i=this.animations_[t];if(i[0].callback&&Ky(i[0].callback,!1),!e)for(let s=0,a=i.length;s<a;++s){const o=i[s];if(!o.complete){e=o.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=e,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const e=Date.now();let t=!1;for(let r=this.animations_.length-1;r>=0;--r){const i=this.animations_[r];let s=!0;for(let a=0,o=i.length;a<o;++a){const l=i[a];if(l.complete)continue;const u=e-l.start;let h=l.duration>0?u/l.duration:1;h>=1?(l.complete=!0,h=1):s=!1;const f=l.easing(h);if(l.sourceCenter){const g=l.sourceCenter[0],y=l.sourceCenter[1],v=l.targetCenter[0],x=l.targetCenter[1];this.nextCenter_=l.targetCenter;const E=g+f*(v-g),T=y+f*(x-y);this.targetCenter_=[E,T]}if(l.sourceResolution&&l.targetResolution){const g=f===1?l.targetResolution:l.sourceResolution+f*(l.targetResolution-l.sourceResolution);if(l.anchor){const y=this.getViewportSize_(this.getRotation()),v=this.constraints_.resolution(g,0,y,!0);this.targetCenter_=this.calculateCenterZoom(v,l.anchor)}this.nextResolution_=l.targetResolution,this.targetResolution_=g,this.applyTargetState_(!0)}if(l.sourceRotation!==void 0&&l.targetRotation!==void 0){const g=f===1?Jc(l.targetRotation+Math.PI,2*Math.PI)-Math.PI:l.sourceRotation+f*(l.targetRotation-l.sourceRotation);if(l.anchor){const y=this.constraints_.rotation(g,!0);this.targetCenter_=this.calculateCenterRotate(y,l.anchor)}this.nextRotation_=l.targetRotation,this.targetRotation_=g}if(this.applyTargetState_(!0),t=!0,!l.complete)break}if(s){this.animations_[r]=null,this.setHint(hi.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const a=i[0].callback;a&&Ky(a,!0)}}this.animations_=this.animations_.filter(Boolean),t&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(e,t){let r;const i=this.getCenterInternal();return i!==void 0&&(r=[i[0]-t[0],i[1]-t[1]],Yb(r,e-this.getRotation()),HB(r,t)),r}calculateCenterZoom(e,t){let r;const i=this.getCenterInternal(),s=this.getResolution();if(i!==void 0&&s!==void 0){const a=t[0]-e*(t[0]-i[0])/s,o=t[1]-e*(t[1]-i[1])/s;r=[a,o]}return r}getViewportSize_(e){const t=this.viewportSize_;if(e){const r=t[0],i=t[1];return[Math.abs(r*Math.cos(e))+Math.abs(i*Math.sin(e)),Math.abs(r*Math.sin(e))+Math.abs(i*Math.cos(e))]}return t}setViewportSize(e){this.viewportSize_=Array.isArray(e)?e.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const e=this.getCenterInternal();return e&&rT(e,this.getProjection())}getCenterInternal(){return this.get(ja.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(e){return e!==void 0?(e[0]=this.hints_[0],e[1]=this.hints_[1],e):this.hints_.slice()}calculateExtent(e){const t=this.calculateExtentInternal(e);return s5(t,this.getProjection())}calculateExtentInternal(e){e=e||this.getViewportSizeMinusPadding_();const t=this.getCenterInternal();Dn(t,"The view center is not defined");const r=this.getResolution();Dn(r!==void 0,"The view resolution is not defined");const i=this.getRotation();return Dn(i!==void 0,"The view rotation is not defined"),J_(t,r,i,e)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))}setConstrainResolution(e){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:e}))}getProjection(){return this.projection_}getResolution(){return this.get(ja.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(e,t){return this.getResolutionForExtentInternal(No(e,this.getProjection()),t)}getResolutionForExtentInternal(e,t){t=t||this.getViewportSizeMinusPadding_();const r=un(e)/t[0],i=$r(e)/t[1];return Math.max(r,i)}getResolutionForValueFunction(e){e=e||2;const t=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,i=Math.log(t/r)/Math.log(e);return(function(s){return t/Math.pow(e,s*i)})}getRotation(){return this.get(ja.ROTATION)}getValueForResolutionFunction(e){const t=Math.log(e||2),r=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,s=Math.log(r/i)/t;return(function(a){return Math.log(r/a)/t/s})}getViewportSizeMinusPadding_(e){let t=this.getViewportSize_(e);const r=this.padding_;return r&&(t=[t[0]-r[1]-r[3],t[1]-r[0]-r[2]]),t}getState(){const e=this.getProjection(),t=this.getResolution(),r=this.getRotation();let i=this.getCenterInternal();const s=this.padding_;if(s){const a=this.getViewportSizeMinusPadding_();i=G2(i,this.getViewportSize_(),[a[0]/2+s[3],a[1]/2+s[0]],t,r)}return{center:i.slice(0),projection:e!==void 0?e:null,resolution:t,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:r,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let e;const t=this.getResolution();return t!==void 0&&(e=this.getZoomForResolution(t)),e}getZoomForResolution(e){let t=this.minZoom_||0,r,i;if(this.resolutions_){const s=Rv(this.resolutions_,e,1);t=s,r=this.resolutions_[s],s==this.resolutions_.length-1?i=2:i=r/this.resolutions_[s+1]}else r=this.maxResolution_,i=this.zoomFactor_;return t+Math.log(r/e)/Math.log(i)}getResolutionForZoom(e){if(this.resolutions_?.length){if(this.resolutions_.length===1)return this.resolutions_[0];const t=ar(Math.floor(e),0,this.resolutions_.length-2),r=this.resolutions_[t]/this.resolutions_[t+1];return this.resolutions_[t]/Math.pow(r,ar(e-t,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,e-this.minZoom_)}fit(e,t){let r;if(Dn(Array.isArray(e)||typeof e.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(e)){Dn(!N0(e),"Cannot fit empty extent provided as `geometry`");const i=No(e,this.getProjection());r=r4(i)}else if(e.getType()==="Circle"){const i=No(e.getExtent(),this.getProjection());r=r4(i),r.rotate(this.getRotation(),Wo(i))}else r=e;this.fitInternal(r,t)}rotatedExtentForGeometry(e){const t=this.getRotation(),r=Math.cos(t),i=Math.sin(-t),s=e.getFlatCoordinates(),a=e.getStride();let o=1/0,l=1/0,u=-1/0,h=-1/0;for(let f=0,g=s.length;f<g;f+=a){const y=s[f]*r-s[f+1]*i,v=s[f]*i+s[f+1]*r;o=Math.min(o,y),l=Math.min(l,v),u=Math.max(u,y),h=Math.max(h,v)}return[o,l,u,h]}fitInternal(e,t){t=t||{};let r=t.size;r||(r=this.getViewportSizeMinusPadding_());const i=t.padding!==void 0?t.padding:[0,0,0,0],s=t.nearest!==void 0?t.nearest:!1;let a;t.minResolution!==void 0?a=t.minResolution:t.maxZoom!==void 0?a=this.getResolutionForZoom(t.maxZoom):a=0;const o=this.rotatedExtentForGeometry(e);let l=this.getResolutionForExtentInternal(o,[r[0]-i[1]-i[3],r[1]-i[0]-i[2]]);l=isNaN(l)?a:Math.max(l,a),l=this.getConstrainedResolution(l,s?0:1);const u=this.getRotation(),h=Math.sin(u),f=Math.cos(u),g=Wo(o);g[0]+=(i[1]-i[3])/2*l,g[1]+=(i[0]-i[2])/2*l;const y=g[0]*f-g[1]*h,v=g[1]*f+g[0]*h,x=this.getConstrainedCenter([y,v],l),E=t.callback?t.callback:$m;t.duration!==void 0?this.animateInternal({resolution:l,center:x,duration:t.duration,easing:t.easing},E):(this.targetResolution_=l,this.targetCenter_=x,this.applyTargetState_(!1,!0),Ky(E,!0))}centerOn(e,t,r){this.centerOnInternal(wl(e,this.getProjection()),t,r)}centerOnInternal(e,t,r){this.setCenterInternal(G2(e,t,r,this.getResolution(),this.getRotation()))}calculateCenterShift(e,t,r,i){let s;const a=this.padding_;if(a&&e){const o=this.getViewportSizeMinusPadding_(-r),l=G2(e,i,[o[0]/2+a[3],o[1]/2+a[0]],t,r);s=[e[0]-l[0],e[1]-l[1]]}return s}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(e){const t=rT(this.targetCenter_,this.getProjection());this.setCenter([t[0]+e[0],t[1]+e[1]])}adjustCenterInternal(e){const t=this.targetCenter_;this.setCenterInternal([t[0]+e[0],t[1]+e[1]])}adjustResolution(e,t){t=t&&wl(t,this.getProjection()),this.adjustResolutionInternal(e,t)}adjustResolutionInternal(e,t){const r=this.getAnimating()||this.getInteracting(),i=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*e,0,i,r);t&&(this.targetCenter_=this.calculateCenterZoom(s,t)),this.targetResolution_*=e,this.applyTargetState_()}adjustZoom(e,t){this.adjustResolution(Math.pow(this.zoomFactor_,-e),t)}adjustRotation(e,t){t&&(t=wl(t,this.getProjection())),this.adjustRotationInternal(e,t)}adjustRotationInternal(e,t){const r=this.getAnimating()||this.getInteracting(),i=this.constraints_.rotation(this.targetRotation_+e,r);t&&(this.targetCenter_=this.calculateCenterRotate(i,t)),this.targetRotation_+=e,this.applyTargetState_()}setCenter(e){this.setCenterInternal(e&&wl(e,this.getProjection()))}setCenterInternal(e){this.targetCenter_=e,this.applyTargetState_()}setHint(e,t){return this.hints_[e]+=t,this.changed(),this.hints_[e]}setResolution(e){this.targetResolution_=e,this.applyTargetState_()}setRotation(e){this.targetRotation_=e,this.applyTargetState_()}setZoom(e){this.setResolution(this.getResolutionForZoom(e))}applyTargetState_(e,t){const r=this.getAnimating()||this.getInteracting()||t,i=this.constraints_.rotation(this.targetRotation_,r),s=this.getViewportSize_(i),a=this.constraints_.resolution(this.targetResolution_,0,s,r),o=this.constraints_.center(this.targetCenter_,a,s,r,this.calculateCenterShift(this.targetCenter_,a,i,s));this.get(ja.ROTATION)!==i&&this.set(ja.ROTATION,i),this.get(ja.RESOLUTION)!==a&&(this.set(ja.RESOLUTION,a),this.set("zoom",this.getZoom(),!0)),(!o||!this.get(ja.CENTER)||!tx(this.get(ja.CENTER),o))&&this.set(ja.CENTER,o),this.getAnimating()&&!e&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(e,t,r){e=e!==void 0?e:200;const i=t||0,s=this.constraints_.rotation(this.targetRotation_),a=this.getViewportSize_(s),o=this.constraints_.resolution(this.targetResolution_,i,a),l=this.constraints_.center(this.targetCenter_,o,a,!1,this.calculateCenterShift(this.targetCenter_,o,s,a));if(e===0&&!this.cancelAnchor_){this.targetResolution_=o,this.targetRotation_=s,this.targetCenter_=l,this.applyTargetState_();return}r=r||(e===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==o||this.getRotation()!==s||!this.getCenterInternal()||!tx(this.getCenterInternal(),l))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:l,resolution:o,duration:e,easing:L0,anchor:r}))}beginInteraction(){this.resolveConstraints(0),this.setHint(hi.INTERACTING,1)}endInteraction(e,t,r){r=r&&wl(r,this.getProjection()),this.endInteractionInternal(e,t,r)}endInteractionInternal(e,t,r){this.getInteracting()&&(this.setHint(hi.INTERACTING,-1),this.resolveConstraints(e,t,r))}getConstrainedCenter(e,t){const r=this.getViewportSize_(this.getRotation());return this.constraints_.center(e,t||this.getResolution(),r)}getConstrainedZoom(e,t){const r=this.getResolutionForZoom(e);return this.getZoomForResolution(this.getConstrainedResolution(r,t))}getConstrainedResolution(e,t){t=t||0;const r=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(e,t,r)}}function Ky(n,e){setTimeout(function(){n(e)},0)}function Q$(n){if(n.extent!==void 0){const t=n.smoothExtentConstraint!==void 0?n.smoothExtentConstraint:!0;return S4(n.extent,n.constrainOnlyCenter,t)}const e=Qb(n.projection,"EPSG:3857");if(n.multiWorld!==!0&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,S4(t,!1,!1)}return $$}function J$(n){let e,t,r,a=n.minZoom!==void 0?n.minZoom:V2,o=n.maxZoom!==void 0?n.maxZoom:28;const l=n.zoomFactor!==void 0?n.zoomFactor:2,u=n.multiWorld!==void 0?n.multiWorld:!1,h=n.smoothResolutionConstraint!==void 0?n.smoothResolutionConstraint:!0,f=n.showFullExtent!==void 0?n.showFullExtent:!1,g=Qb(n.projection,"EPSG:3857"),y=g.getExtent();let v=n.constrainOnlyCenter,x=n.extent;if(!u&&!x&&g.isGlobal()&&(v=!1,x=y),n.resolutions!==void 0){const E=n.resolutions;t=E[a],r=E[o]!==void 0?E[o]:E[E.length-1],n.constrainResolution?e=K$(E,h,!v&&x,f):e=T4(t,r,h,!v&&x,f)}else{const T=(y?Math.max(un(y),$r(y)):360*l0.degrees/g.getMetersPerUnit())/EI/Math.pow(2,V2),b=T/Math.pow(2,28-V2);t=n.maxResolution,t!==void 0?a=0:t=T/Math.pow(l,a),r=n.minResolution,r===void 0&&(n.maxZoom!==void 0?n.maxResolution!==void 0?r=t/Math.pow(l,o):r=T/Math.pow(l,o):r=b),o=a+Math.floor(Math.log(t/r)/Math.log(l)),r=t/Math.pow(l,o-a),n.constrainResolution?e=Y$(l,t,r,h,!v&&x,f):e=T4(t,r,h,!v&&x,f)}return{constraint:e,maxResolution:t,minResolution:r,minZoom:a,zoomFactor:l}}function eW(n){if(n.enableRotation!==void 0?n.enableRotation:!0){const t=n.constrainRotation;return t===void 0||t===!0?X$():t===!1?b4:typeof t=="number"?q$(t):b4}return wI}function tW(n){return!(n.sourceCenter&&n.targetCenter&&!tx(n.sourceCenter,n.targetCenter)||n.sourceResolution!==n.targetResolution||n.sourceRotation!==n.targetRotation)}function G2(n,e,t,r,i){const s=Math.cos(-i);let a=Math.sin(-i),o=n[0]*s-n[1]*a,l=n[1]*s+n[0]*a;o+=(e[0]/2-t[0])*r,l+=(t[1]-e[1]/2)*r,a=-a;const u=o*s-l*a,h=l*s+o*a;return[u,h]}const Gn={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class Z5 extends tl{constructor(e){super(),this.on,this.once,this.un,this.background_=e.background;const t=Object.assign({},e);typeof e.properties=="object"&&(delete t.properties,Object.assign(t,e.properties)),t[Gn.OPACITY]=e.opacity!==void 0?e.opacity:1,Dn(typeof t[Gn.OPACITY]=="number","Layer opacity must be a number"),t[Gn.VISIBLE]=e.visible!==void 0?e.visible:!0,t[Gn.Z_INDEX]=e.zIndex,t[Gn.MAX_RESOLUTION]=e.maxResolution!==void 0?e.maxResolution:1/0,t[Gn.MIN_RESOLUTION]=e.minResolution!==void 0?e.minResolution:0,t[Gn.MIN_ZOOM]=e.minZoom!==void 0?e.minZoom:-1/0,t[Gn.MAX_ZOOM]=e.maxZoom!==void 0?e.maxZoom:1/0,this.className_=t.className!==void 0?t.className:"ol-layer",delete t.className,this.setProperties(t),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(e){const t=this.state_||{layer:this,managed:e===void 0?!0:e},r=this.getZIndex();return t.opacity=ar(Math.round(this.getOpacity()*100)/100,0,1),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=r===void 0&&!t.managed?1/0:r,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),t.minZoom=this.getMinZoom(),t.maxZoom=this.getMaxZoom(),this.state_=t,t}getLayersArray(e){return Vt()}getLayerStatesArray(e){return Vt()}getExtent(){return this.get(Gn.EXTENT)}getMaxResolution(){return this.get(Gn.MAX_RESOLUTION)}getMinResolution(){return this.get(Gn.MIN_RESOLUTION)}getMinZoom(){return this.get(Gn.MIN_ZOOM)}getMaxZoom(){return this.get(Gn.MAX_ZOOM)}getOpacity(){return this.get(Gn.OPACITY)}getSourceState(){return Vt()}getVisible(){return this.get(Gn.VISIBLE)}getZIndex(){return this.get(Gn.Z_INDEX)}setBackground(e){this.background_=e,this.changed()}setExtent(e){this.set(Gn.EXTENT,e)}setMaxResolution(e){this.set(Gn.MAX_RESOLUTION,e)}setMinResolution(e){this.set(Gn.MIN_RESOLUTION,e)}setMaxZoom(e){this.set(Gn.MAX_ZOOM,e)}setMinZoom(e){this.set(Gn.MIN_ZOOM,e)}setOpacity(e){Dn(typeof e=="number","Layer opacity must be a number"),this.set(Gn.OPACITY,e)}setVisible(e){this.set(Gn.VISIBLE,e)}setZIndex(e){this.set(Gn.Z_INDEX,e)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}class Zp extends Z5{constructor(e){const t=Object.assign({},e);delete t.source,super(t),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,e.render&&(this.render=e.render),e.map&&this.setMap(e.map),this.addChangeListener(Gn.SOURCE,this.handleSourcePropertyChange_);const r=e.source?e.source:null;this.setSource(r)}getLayersArray(e){return e=e||[],e.push(this),e}getLayerStatesArray(e){return e=e||[],e.push(this.getLayerState()),e}getSource(){return this.get(Gn.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const e=this.getSource();return e?e.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(tr(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const e=this.getSource();e&&(this.sourceChangeKey_=yn(e,Yt.CHANGE,this.handleSourceChange_,this),e.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(e){return this.renderer_?this.renderer_.getFeatures(e):Promise.resolve([])}getData(e){return!this.renderer_||!this.rendered?null:this.renderer_.getData(e)}isVisible(e){let t;const r=this.getMapInternal();!e&&r&&(e=r.getView()),e instanceof Mo?t={viewState:e.getState(),extent:e.calculateExtent()}:t=e,!t.layerStatesArray&&r&&(t.layerStatesArray=r.getLayerGroup().getLayerStatesArray());let i;if(t.layerStatesArray){if(i=t.layerStatesArray.find(a=>a.layer===this),!i)return!1}else i=this.getLayerState();const s=this.getExtent();return SI(i,t.viewState)&&(!s||as(s,t.extent))}getAttributions(e){if(!this.isVisible(e))return[];const t=this.getSource()?.getAttributions();if(!t)return[];const r=e instanceof Mo?e.getViewStateAndExtent():e;let i=t(r);return Array.isArray(i)||(i=[i]),i}render(e,t){const r=this.getRenderer();return r.prepareFrame(e)?(this.rendered=!0,r.renderFrame(e,t)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(e,t){}renderDeferred(e){const t=this.getRenderer();t&&t.renderDeferred(e)}setMapInternal(e){e||this.unrender(),this.set(Gn.MAP,e)}getMapInternal(){return this.get(Gn.MAP)}setMap(e){this.mapPrecomposeKey_&&(tr(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(tr(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=yn(e,va.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=yn(this,Yt.CHANGE,e.render,e),this.changed())}handlePrecompose_(e){const t=e.frameState.layerStatesArray,r=this.getLayerState(!1);Dn(!t.some(i=>i.layer===r.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),t.push(r)}setSource(e){this.set(Gn.SOURCE,e)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}}function SI(n,e){if(!n.visible)return!1;const t=e.resolution;if(t<n.minResolution||t>=n.maxResolution)return!1;const r=e.zoom;return r>n.minZoom&&r<=n.maxZoom}const I4={RENDER_ORDER:"renderOrder"};class Q5 extends Zp{constructor(e){e=e||{};const t=Object.assign({},e);delete t.style,delete t.renderBuffer,delete t.updateWhileAnimating,delete t.updateWhileInteracting,super(t),this.declutter_=e.declutter?String(e.declutter):void 0,this.renderBuffer_=e.renderBuffer!==void 0?e.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(e.style),this.updateWhileAnimating_=e.updateWhileAnimating!==void 0?e.updateWhileAnimating:!1,this.updateWhileInteracting_=e.updateWhileInteracting!==void 0?e.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(e){return super.getFeatures(e)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(I4.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(e,t){const r=this.getDeclutter();r in e.declutter||(e.declutter[r]=new F5(9)),this.getRenderer().renderDeclutter(e,t)}setRenderOrder(e){this.set(I4.RENDER_ORDER,e)}setStyle(e){this.style_=e===void 0?j5:e;const t=nW(e);this.styleFunction_=e===null?void 0:jz(t),this.changed()}setDeclutter(e){this.declutter_=e?String(e):void 0,this.changed()}}function nW(n){if(n===void 0)return j5;if(!n)return null;if(typeof n=="function"||n instanceof nr)return n;if(!Array.isArray(n))return x4([n]);if(n.length===0)return[];const e=n.length,t=n[0];if(t instanceof nr){const i=new Array(e);for(let s=0;s<e;++s){const a=n[s];if(!(a instanceof nr))throw new Error("Expected a list of style instances");i[s]=a}return i}if("style"in t){const i=new Array(e);for(let s=0;s<e;++s){const a=n[s];if(!("style"in a))throw new Error("Expected a list of rules with a style property");i[s]=a}return k$(i)}return x4(n)}class Qp extends Q5{constructor(e){super(e)}createRenderer(){return new s$(this)}}const Ic={ADDLAYER:"addlayer",REMOVELAYER:"removelayer"};class Dc extends el{constructor(e,t){super(e),this.layer=t}}const B2={LAYERS:"layers"};let $v=class J5 extends Z5{constructor(e){e=e||{};const t=Object.assign({},e);delete t.layers;let r=e.layers;super(t),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(B2.LAYERS,this.handleLayersChanged_),r?Array.isArray(r)?r=new xa(r.slice(),{unique:!0}):Dn(typeof r.getArray=="function","Expected `layers` to be an array or a `Collection`"):r=new xa(void 0,{unique:!0}),this.setLayers(r)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(tr),this.layersListenerKeys_.length=0;const e=this.getLayers();this.layersListenerKeys_.push(yn(e,vs.ADD,this.handleLayersAdd_,this),yn(e,vs.REMOVE,this.handleLayersRemove_,this));for(const r in this.listenerKeys_)this.listenerKeys_[r].forEach(tr);jp(this.listenerKeys_);const t=e.getArray();for(let r=0,i=t.length;r<i;r++){const s=t[r];this.registerLayerListeners_(s),this.dispatchEvent(new Dc(Ic.ADDLAYER,s))}this.changed()}registerLayerListeners_(e){const t=[yn(e,a0.PROPERTYCHANGE,this.handleLayerChange_,this),yn(e,Yt.CHANGE,this.handleLayerChange_,this)];e instanceof J5&&t.push(yn(e,Ic.ADDLAYER,this.handleLayerGroupAdd_,this),yn(e,Ic.REMOVELAYER,this.handleLayerGroupRemove_,this)),this.listenerKeys_[bn(e)]=t}handleLayerGroupAdd_(e){this.dispatchEvent(new Dc(Ic.ADDLAYER,e.layer))}handleLayerGroupRemove_(e){this.dispatchEvent(new Dc(Ic.REMOVELAYER,e.layer))}handleLayersAdd_(e){const t=e.element;this.registerLayerListeners_(t),this.dispatchEvent(new Dc(Ic.ADDLAYER,t)),this.changed()}handleLayersRemove_(e){const t=e.element,r=bn(t);this.listenerKeys_[r].forEach(tr),delete this.listenerKeys_[r],this.dispatchEvent(new Dc(Ic.REMOVELAYER,t)),this.changed()}getLayers(){return this.get(B2.LAYERS)}setLayers(e){const t=this.getLayers();if(t){const r=t.getArray();for(let i=0,s=r.length;i<s;++i)this.dispatchEvent(new Dc(Ic.REMOVELAYER,r[i]))}this.set(B2.LAYERS,e)}getLayersArray(e){return e=e!==void 0?e:[],this.getLayers().forEach(function(t){t.getLayersArray(e)}),e}getLayerStatesArray(e){const t=e!==void 0?e:[],r=t.length;this.getLayers().forEach(function(a){a.getLayerStatesArray(t)});const i=this.getLayerState();let s=i.zIndex;!e&&i.zIndex===void 0&&(s=0);for(let a=r,o=t.length;a<o;a++){const l=t[a];l.opacity*=i.opacity,l.visible=l.visible&&i.visible,l.maxResolution=Math.min(l.maxResolution,i.maxResolution),l.minResolution=Math.max(l.minResolution,i.minResolution),l.minZoom=Math.max(l.minZoom,i.minZoom),l.maxZoom=Math.min(l.maxZoom,i.maxZoom),i.extent!==void 0&&(l.extent!==void 0?l.extent=Pl(l.extent,i.extent):l.extent=i.extent),l.zIndex===void 0&&(l.zIndex=s)}return t}getSourceState(){return"ready"}};const Nt={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};class TI extends Vp{constructor(e,t,r){super(),r=r||{},this.tileCoord=e,this.state=t,this.key="",this.transition_=r.transition===void 0?250:r.transition,this.transitionStarts_={},this.interpolate=!!r.interpolate}changed(){this.dispatchEvent(Yt.CHANGE)}release(){this.setState(Nt.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(e){if(this.state!==Nt.EMPTY){if(this.state!==Nt.ERROR&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()}}load(){Vt()}getAlpha(e,t){if(!this.transition_)return 1;let r=this.transitionStarts_[e];if(!r)r=t,this.transitionStarts_[e]=r;else if(r===-1)return 1;const i=t-r+1e3/60;return i>=this.transition_?1:X5(i/this.transition_)}inTransition(e){return this.transition_?this.transitionStarts_[e]!==-1:!1}endTransition(e){this.transition_&&(this.transitionStarts_[e]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}function fT(n){return n instanceof Image||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageBitmap?n:null}const rW=new Error("disposed"),iW=[256,256];class A4 extends TI{constructor(e){const t=Nt.IDLE;super(e.tileCoord,t,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null,this.controller_=e.controller||null}getSize(){if(this.size_)return this.size_;const e=fT(this.data_);return e?[e.width,e.height]:iW}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==Nt.IDLE&&this.state!==Nt.ERROR)return;this.state=Nt.LOADING,this.changed();const e=this;this.loader_().then(function(t){e.data_=t,e.state=Nt.LOADED,e.changed()}).catch(function(t){e.error_=t,e.state=Nt.ERROR,e.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(rW),this.controller_=null),super.disposeInternal()}}class eD extends TI{constructor(e,t,r,i,s,a){super(e,t,a),this.crossOrigin_=i,this.src_=r,this.key=r,this.image_,qs?this.image_=new OffscreenCanvas(1,1):(this.image_=new Image,i!==null&&(this.image_.crossOrigin=i)),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(e){this.image_=e,this.state=Nt.LOADED,this.unlistenImage_(),this.changed()}getCrossOrigin(){return this.crossOrigin_}handleImageError_(){this.state=Nt.ERROR,this.unlistenImage_(),this.image_=sW(),this.changed()}handleImageLoad_(){if(qs)this.state=Nt.LOADED;else{const e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=Nt.LOADED:this.state=Nt.EMPTY}this.unlistenImage_(),this.changed()}load(){this.state==Nt.ERROR&&(this.state=Nt.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==Nt.IDLE&&(this.state=Nt.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=tz(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function sW(){const n=ni(1,1);return n.fillStyle="rgba(0,0,0,0)",n.fillRect(0,0,1,1),n.canvas}let U2;const $f=[];function R4(n,e,t,r,i){n.beginPath(),n.moveTo(0,0),n.lineTo(e,t),n.lineTo(r,i),n.closePath(),n.save(),n.clip(),n.fillRect(0,0,Math.max(e,r)+1,Math.max(t,i)),n.restore()}function z2(n,e){return Math.abs(n[e*4]-210)>2||Math.abs(n[e*4+3]-.75*255)>2}function aW(){if(U2===void 0){const n=ni(6,6,$f);n.globalCompositeOperation="lighter",n.fillStyle="rgba(210, 0, 0, 0.75)",R4(n,4,5,4,0),R4(n,4,5,0,5);const e=n.getImageData(0,0,3,3).data;U2=z2(e,0)||z2(e,4)||z2(e,8),Vv(n),$f.push(n.canvas)}return U2}function gx(n,e,t,r){const i=$p(t,e,n);let s=sx(e,r,t);const a=e.getMetersPerUnit();a!==void 0&&(s*=a);const o=n.getMetersPerUnit();o!==void 0&&(s/=o);const l=n.getExtent();if(!l||Lh(l,i)){const u=sx(n,s,i)/s;isFinite(u)&&u>0&&(s/=u)}return s}function oW(n,e,t,r){const i=Wo(t);let s=gx(n,e,i,r);return(!isFinite(s)||s<=0)&&WO(t,function(a){return s=gx(n,e,a,r),isFinite(s)&&s>0}),s}function tD(n,e,t,r,i,s,a,o,l,u,h,f,g,y){const v=ni(Math.round(t*n),Math.round(t*e),$f);if(f||(v.imageSmoothingEnabled=!1),l.length===0)return v.canvas;v.scale(t,t);function x(F){return Math.round(F*t)/t}v.globalCompositeOperation="lighter";const E=Qs();l.forEach(function(F,z,k){zO(E,F.extent)});let T;const b=t/r,I=(f?1:1+Math.pow(2,-24))/b;(!g||l.length!==1||u!==0)&&(T=ni(Math.round(un(E)*b),Math.round($r(E)*b),$f),f||(T.imageSmoothingEnabled=!1),l.forEach(function(F,z,k){if(F.image.width>0&&F.image.height>0){if(F.clipExtent){T.save();const U=(F.clipExtent[0]-E[0])*b,j=-(F.clipExtent[3]-E[3])*b,Ie=un(F.clipExtent)*b,ke=$r(F.clipExtent)*b;T.rect(f?U:Math.round(U),f?j:Math.round(j),f?Ie:Math.round(U+Ie)-Math.round(U),f?ke:Math.round(j+ke)-Math.round(j)),T.clip()}const C=(F.extent[0]-E[0])*b,P=-(F.extent[3]-E[3])*b,L=un(F.extent)*b,O=$r(F.extent)*b;T.drawImage(F.image,u,u,F.image.width-2*u,F.image.height-2*u,f?C:Math.round(C),f?P:Math.round(P),f?L:Math.round(C+L)-Math.round(C),f?O:Math.round(P+O)-Math.round(P)),F.clipExtent&&T.restore()}}));const M=sd(a);return o.getTriangles().forEach(function(F,z,k){const C=F.source,P=F.target;let L=C[0][0],O=C[0][1],U=C[1][0],j=C[1][1],Ie=C[2][0],ke=C[2][1];const ze=x((P[0][0]-M[0])/s),Ne=x(-(P[0][1]-M[1])/s),ce=x((P[1][0]-M[0])/s),Te=x(-(P[1][1]-M[1])/s),Ee=x((P[2][0]-M[0])/s),se=x(-(P[2][1]-M[1])/s),V=L,J=O;L=0,O=0,U-=V,j-=J,Ie-=V,ke-=J;const ne=[[U,j,0,0,ce-ze],[Ie,ke,0,0,Ee-ze],[0,0,U,j,Te-Ne],[0,0,Ie,ke,se-Ne]],X=WB(ne);if(!X)return;if(v.save(),v.beginPath(),aW()||!f){v.moveTo(ce,Te);const Me=4,je=ze-ce,De=Ne-Te;for(let Be=0;Be<Me;Be++)v.lineTo(ce+x((Be+1)*je/Me),Te+x(Be*De/(Me-1))),Be!=Me-1&&v.lineTo(ce+x((Be+1)*je/Me),Te+x((Be+1)*De/(Me-1)));v.lineTo(Ee,se)}else v.moveTo(ce,Te),v.lineTo(ze,Ne),v.lineTo(Ee,se);v.clip(),v.transform(X[0],X[2],X[1],X[3],ze,Ne),v.translate(E[0]-V,E[3]-J);let ue;if(T)ue=T.canvas,v.scale(I,-I);else{const Me=l[0],je=Me.extent;ue=Me.image,v.scale(un(je)/ue.width,-$r(je)/ue.height)}v.drawImage(ue,0,0),v.restore()}),T&&(Vv(T),$f.push(T.canvas)),h&&(v.save(),v.globalCompositeOperation="source-over",v.strokeStyle="black",v.lineWidth=1,o.getTriangles().forEach(function(F,z,k){const C=F.target,P=(C[0][0]-M[0])/s,L=-(C[0][1]-M[1])/s,O=(C[1][0]-M[0])/s,U=-(C[1][1]-M[1])/s,j=(C[2][0]-M[0])/s,Ie=-(C[2][1]-M[1])/s;v.beginPath(),v.moveTo(O,U),v.lineTo(P,L),v.lineTo(j,Ie),v.closePath(),v.stroke()}),v.restore()),v.canvas}const lW=10,C4=.25;class nD{constructor(e,t,r,i,s,a,o){this.sourceProj_=e,this.targetProj_=t;let l={};const u=o?nT(I=>ti(o,$p(I,this.targetProj_,this.sourceProj_))):Hm(this.targetProj_,this.sourceProj_);this.transformInv_=function(I){const M=I[0]+"/"+I[1];return l[M]||(l[M]=u(I)),l[M]},this.maxSourceExtent_=i,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!i&&!!this.sourceProj_.getExtent()&&un(i)>=un(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?un(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?un(this.targetProj_.getExtent()):null;const h=sd(r),f=Mv(r),g=kv(r),y=Pv(r),v=this.transformInv_(h),x=this.transformInv_(f),E=this.transformInv_(g),T=this.transformInv_(y),b=lW+(a?Math.max(0,Math.ceil(Math.log2(ZS(r)/(a*a*256*256)))):0);if(this.addQuad_(h,f,g,y,v,x,E,T,b),this.wrapsXInSource_){let I=1/0;this.triangles_.forEach(function(M,F,z){I=Math.min(I,M.source[0][0],M.source[1][0],M.source[2][0])}),this.triangles_.forEach(M=>{if(Math.max(M.source[0][0],M.source[1][0],M.source[2][0])-I>this.sourceWorldWidth_/2){const F=[[M.source[0][0],M.source[0][1]],[M.source[1][0],M.source[1][1]],[M.source[2][0],M.source[2][1]]];F[0][0]-I>this.sourceWorldWidth_/2&&(F[0][0]-=this.sourceWorldWidth_),F[1][0]-I>this.sourceWorldWidth_/2&&(F[1][0]-=this.sourceWorldWidth_),F[2][0]-I>this.sourceWorldWidth_/2&&(F[2][0]-=this.sourceWorldWidth_);const z=Math.min(F[0][0],F[1][0],F[2][0]);Math.max(F[0][0],F[1][0],F[2][0])-z<this.sourceWorldWidth_/2&&(M.source=F)}})}l={}}addTriangle_(e,t,r,i,s,a){this.triangles_.push({source:[i,s,a],target:[e,t,r]})}addQuad_(e,t,r,i,s,a,o,l,u){const h=Lk([s,a,o,l]),f=this.sourceWorldWidth_?un(h)/this.sourceWorldWidth_:null,g=this.sourceWorldWidth_,y=this.sourceProj_.canWrapX()&&f>.5&&f<1;let v=!1;if(u>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const E=Lk([e,t,r,i]);v=un(E)/this.targetWorldWidth_>C4||v}!y&&this.sourceProj_.isGlobal()&&f&&(v=f>C4||v)}if(!v&&this.maxSourceExtent_&&isFinite(h[0])&&isFinite(h[1])&&isFinite(h[2])&&isFinite(h[3])&&!as(h,this.maxSourceExtent_))return;let x=0;if(!v&&(!isFinite(s[0])||!isFinite(s[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(l[0])||!isFinite(l[1]))){if(u>0)v=!0;else if(x=(!isFinite(s[0])||!isFinite(s[1])?8:0)+(!isFinite(a[0])||!isFinite(a[1])?4:0)+(!isFinite(o[0])||!isFinite(o[1])?2:0)+(!isFinite(l[0])||!isFinite(l[1])?1:0),x!=1&&x!=2&&x!=4&&x!=8)return}if(u>0){if(!v){const E=[(e[0]+r[0])/2,(e[1]+r[1])/2],T=this.transformInv_(E);let b;y?b=(Jc(s[0],g)+Jc(o[0],g))/2-Jc(T[0],g):b=(s[0]+o[0])/2-T[0];const I=(s[1]+o[1])/2-T[1];v=b*b+I*I>this.errorThresholdSquared_}if(v){if(Math.abs(e[0]-r[0])<=Math.abs(e[1]-r[1])){const E=[(t[0]+r[0])/2,(t[1]+r[1])/2],T=this.transformInv_(E),b=[(i[0]+e[0])/2,(i[1]+e[1])/2],I=this.transformInv_(b);this.addQuad_(e,t,E,b,s,a,T,I,u-1),this.addQuad_(b,E,r,i,I,T,o,l,u-1)}else{const E=[(e[0]+t[0])/2,(e[1]+t[1])/2],T=this.transformInv_(E),b=[(r[0]+i[0])/2,(r[1]+i[1])/2],I=this.transformInv_(b);this.addQuad_(e,E,b,i,s,T,I,l,u-1),this.addQuad_(E,t,r,b,T,a,o,I,u-1)}return}}if(y){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(x&11)==0&&this.addTriangle_(e,r,i,s,o,l),(x&14)==0&&this.addTriangle_(e,r,t,s,o,a),x&&((x&13)==0&&this.addTriangle_(t,i,e,a,l,s),(x&7)==0&&this.addTriangle_(t,i,r,a,l,o))}calculateSourceExtent(){const e=Qs();return this.triangles_.forEach(function(t,r,i){const s=t.source;dm(e,s[0]),dm(e,s[1]),dm(e,s[2])}),e}getTriangles(){return this.triangles_}}const rD=.5;class iD extends TI{constructor(e,t,r,i,s,a,o,l,u,h,f,g){super(s,Nt.IDLE,g),this.renderEdges_=f!==void 0?f:!1,this.pixelRatio_=o,this.gutter_=l,this.canvas_=null,this.sourceTileGrid_=t,this.targetTileGrid_=i,this.wrappedTileCoord_=a||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=e.canWrapX()?e.getExtent():void 0;const y=i.getTileCoordExtent(this.wrappedTileCoord_),v=this.targetTileGrid_.getExtent();let x=this.sourceTileGrid_.getExtent();const E=v?Pl(y,v):y;if(ZS(E)===0){this.state=Nt.EMPTY;return}const T=e.getExtent();T&&(x?x=Pl(x,T):x=T);const b=i.getResolution(this.wrappedTileCoord_[0]),I=oW(e,r,E,b);if(!isFinite(I)||I<=0){this.state=Nt.EMPTY;return}const M=h!==void 0?h:rD;if(this.triangulation_=new nD(e,r,E,x,I*M,b),this.triangulation_.getTriangles().length===0){this.state=Nt.EMPTY;return}this.sourceZ_=t.getZForResolution(I);let F=this.triangulation_.calculateSourceExtent();if(x&&(e.canWrapX()?(F[1]=ar(F[1],x[1],x[3]),F[3]=ar(F[3],x[1],x[3])):F=Pl(F,x)),!ZS(F))this.state=Nt.EMPTY;else{let z=0,k=0;e.canWrapX()&&(z=un(T),k=Math.floor((F[0]-T[0])/z)),YO(F.slice(),e,!0).forEach(P=>{const L=t.getTileRangeForExtentAndZ(P,this.sourceZ_);for(let O=L.minX;O<=L.maxX;O++)for(let U=L.minY;U<=L.maxY;U++){const j=u(this.sourceZ_,O,U,o);if(j){const Ie=k*z;this.sourceTiles_.push({tile:j,offset:Ie})}}++k}),this.sourceTiles_.length===0&&(this.state=Nt.EMPTY)}}getImage(){return this.canvas_}reproject_(){const e=[];if(this.sourceTiles_.forEach(t=>{const r=t.tile;if(r&&r.getState()==Nt.LOADED){const i=this.sourceTileGrid_.getTileCoordExtent(r.tileCoord);i[0]+=t.offset,i[2]+=t.offset;const s=this.clipExtent_?.slice();s&&(s[0]+=t.offset,s[2]+=t.offset),e.push({extent:i,clipExtent:s,image:r.getImage()})}}),this.sourceTiles_.length=0,e.length===0)this.state=Nt.ERROR;else{const t=this.wrappedTileCoord_[0],r=this.targetTileGrid_.getTileSize(t),i=typeof r=="number"?r:r[0],s=typeof r=="number"?r:r[1],a=this.targetTileGrid_.getResolution(t),o=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=tD(i,s,this.pixelRatio_,o,this.sourceTileGrid_.getExtent(),a,l,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=Nt.LOADED}this.changed()}load(){if(this.state==Nt.IDLE){this.state=Nt.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:t})=>{const r=t.getState();if(r==Nt.IDLE||r==Nt.LOADING){e++;const i=yn(t,Yt.CHANGE,s=>{const a=t.getState();(a==Nt.LOADED||a==Nt.ERROR||a==Nt.EMPTY)&&(tr(i),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(i)}}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:t},r,i){t.getState()==Nt.IDLE&&t.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(tr),this.sourcesListenerKeys_=null}release(){this.canvas_&&(Vv(this.canvas_.getContext("2d")),$f.push(this.canvas_),this.canvas_=null),super.release()}}class bI{constructor(e,t,r,i){this.minX=e,this.maxX=t,this.minY=r,this.maxY=i}contains(e){return this.containsXY(e[1],e[2])}containsTileRange(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}containsXY(e,t){return this.minX<=e&&e<=this.maxX&&this.minY<=t&&t<=this.maxY}equals(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}extend(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}}function sf(n,e,t,r,i){return i!==void 0?(i.minX=n,i.maxX=e,i.minY=t,i.maxY=r,i):new bI(n,e,t,r)}class P4{constructor(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const e=this.pop();e instanceof Av&&e.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(e){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let t=this.oldest_;for(;t;)e(t.value_,t.key_,this),t=t.newer}get(e,t){const r=this.entries_[e];return Dn(r!==void 0,"Tried to get a value for a key that does not exist in the cache"),r===this.newest_||(r===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(r.newer.older=r.older,r.older.newer=r.newer),r.newer=null,r.older=this.newest_,this.newest_.newer=r,this.newest_=r),r.value_}remove(e){const t=this.entries_[e];return Dn(t!==void 0,"Tried to get a value for a key that does not exist in the cache"),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_}getCount(){return this.count_}getKeys(){const e=new Array(this.count_);let t=0,r;for(r=this.newest_;r;r=r.older)e[t++]=r.key_;return e}getValues(){const e=new Array(this.count_);let t=0,r;for(r=this.newest_;r;r=r.older)e[t++]=r.value_;return e}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){return this.entries_[e]?.value_}pop(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,t){this.get(e),this.entries_[e].value_=t}set(e,t){Dn(!(e in this.entries_),"Tried to set a value for a key that is used already");const r={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=r:this.oldest_=r,this.newest_=r,this.entries_[e]=r,++this.count_}setSize(e){this.highWaterMark=e}}function mx(n,e,t,r){return r!==void 0?(r[0]=n,r[1]=e,r[2]=t,r):[n,e,t]}function cW(n,e,t){return n+"/"+e+"/"+t}function I_(n,e,t,r,i){return`${bn(n)},${e},${cW(t,r,i)}`}function sD(n){return uW(n[0],n[1],n[2])}function uW(n,e,t){return(e<<n)+t}function hW(n,e){const t=n[0],r=n[1],i=n[2];if(e.getMinZoom()>t||t>e.getMaxZoom())return!1;const s=e.getFullTileRange(t);return s?s.containsXY(r,i):!0}class dW extends pI{constructor(e){super(e),this.image=null}getImage(){return this.image?this.image.getImage():null}prepareFrame(e){const t=e.layerStatesArray[e.layerIndex],r=e.pixelRatio,i=e.viewState,s=i.resolution,a=this.getLayer().getSource(),o=e.viewHints;let l=e.extent;if(t.extent!==void 0&&(l=Pl(l,No(t.extent,i.projection))),!o[hi.ANIMATING]&&!o[hi.INTERACTING]&&!N0(l))if(a){const u=i.projection,h=a.getImage(l,s,r,u);h&&(this.loadImage(h)?this.image=h:h.getState()===vt.EMPTY&&(this.image=null))}else this.image=null;return!!this.image}getData(e){const t=this.frameState;if(!t)return null;const r=this.getLayer(),i=ti(t.pixelToCoordinateTransform,e.slice()),s=r.getExtent();if(s&&!Lh(s,i))return null;const a=this.image.getExtent(),o=this.image.getImage(),l=un(a),u=Math.floor(o.width*((i[0]-a[0])/l));if(u<0||u>=o.width)return null;const h=$r(a),f=Math.floor(o.height*((a[3]-i[1])/h));return f<0||f>=o.height?null:this.getImageData(o,u,f)}renderFrame(e,t){const r=this.image,i=r.getExtent(),s=r.getResolution(),[a,o]=Array.isArray(s)?s:[s,s],l=r.getPixelRatio(),u=e.layerStatesArray[e.layerIndex],h=e.pixelRatio,f=e.viewState,g=f.center,y=f.resolution,v=h*a/(y*l),x=h*o/(y*l);this.prepareContainer(e,t);const E=this.context.canvas.width,T=this.context.canvas.height,b=this.getRenderContext(e);let I=!1,M=!0;if(u.extent){const P=No(u.extent,f.projection);M=as(P,e.extent),I=M&&!Uc(P,e.extent),I&&this.clipUnrotated(b,e,P)}const F=r.getImage(),z=Ko(this.tempTransform,E/2,T/2,v,x,0,l*(i[0]-g[0])/a,l*(g[1]-i[3])/o);this.renderedResolution=o*h/l;const k=F.width*z[0],C=F.height*z[3];if(this.getLayer().getSource().getInterpolate()||(b.imageSmoothingEnabled=!1),this.preRender(b,e),M&&k>=.5&&C>=.5){const P=z[4],L=z[5],O=u.opacity;O!==1&&(b.save(),b.globalAlpha=O),b.drawImage(F,0,0,+F.width,+F.height,P,L,k,C),O!==1&&b.restore()}return this.postRender(this.context,e),I&&b.restore(),b.imageSmoothingEnabled=!0,this.container}}class fW extends Zp{constructor(e){e=e||{},super(e)}}class gW extends fW{constructor(e){super(e)}createRenderer(){return new dW(this)}getData(e){return super.getData(e)}}function $2(n,e,t){if(!(t in n))return n[t]=new Set([e]),!0;const r=n[t],i=r.has(e);return i||r.add(e),!i}function mW(n,e,t){const r=n[t];return r?r.delete(e):!1}function k4(n,e){const t=n.layerStatesArray[n.layerIndex];t.extent&&(e=Pl(e,No(t.extent,n.viewState.projection)));const r=t.layer.getRenderSource();if(!r.getWrapX()){const i=r.getTileGridForProjection(n.viewState.projection).getExtent();i&&(e=Pl(e,i))}return e}class pW extends pI{constructor(e,t){super(e),t=t||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=Qs(),this.tempTileRange_=new bI(0,0,0,0),this.tempTileCoord_=mx(0,0,0);const r=t.cacheSize!==void 0?t.cacheSize:512;this.tileCache_=new P4(r),this.sourceTileCache_=null,this.maxStaleKeys=r*.5}getTileCache(){return this.tileCache_}getSourceTileCache(){return this.sourceTileCache_||(this.sourceTileCache_=new P4(512)),this.sourceTileCache_}getOrCreateTile(e,t,r,i){const s=this.tileCache_,o=this.getLayer().getSource(),l=I_(o,o.getKey(),e,t,r);let u;if(s.containsKey(l))u=s.get(l);else{const h=i.viewState.projection,f=o.getProjection();if(u=o.getTile(e,t,r,i.pixelRatio,h,!f||Ih(f,h)?void 0:this.getSourceTileCache()),!u)return null;s.set(l,u)}return u}getTile(e,t,r,i){const s=this.getOrCreateTile(e,t,r,i);return s||null}getData(e){const t=this.frameState;if(!t)return null;const r=this.getLayer(),i=ti(t.pixelToCoordinateTransform,e.slice()),s=r.getExtent();if(s&&!Lh(s,i))return null;const a=t.viewState,o=r.getRenderSource(),l=o.getTileGridForProjection(a.projection),u=o.getTilePixelRatio(t.pixelRatio);for(let h=l.getZForResolution(a.resolution);h>=l.getMinZoom();--h){const f=l.getTileCoordForCoordAndZ(i,h),g=this.getTile(h,f[1],f[2],t);if(!g||g.getState()!==Nt.LOADED)continue;const y=l.getOrigin(h),v=bs(l.getTileSize(h)),x=l.getResolution(h);let E;if(g instanceof eD||g instanceof iD)E=g.getImage();else if(g instanceof A4){if(E=fT(g.getData()),!E)continue}else continue;const T=Math.floor(u*((i[0]-y[0])/x-f[1]*v[0])),b=Math.floor(u*((y[1]-i[1])/x-f[2]*v[1])),I=Math.round(u*o.getGutterForProjection(a.projection));return this.getImageData(E,T+I,b+I)}return null}prepareFrame(e){this.renderedProjection?e.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=e.viewState.projection):this.renderedProjection=e.viewState.projection;const t=this.getLayer().getSource();if(!t)return!1;const r=t.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==r&&(this.renderedSourceRevision_=r,this.renderedSourceKey_===t.getKey()&&(this.tileCache_.clear(),this.sourceTileCache_?.clear())):this.renderedSourceRevision_=r,!0}enqueueTilesForNextExtent(){return!0}enqueueTiles(e,t,r,i,s){const a=e.viewState,o=this.getLayer(),l=o.getRenderSource(),u=l.getTileGridForProjection(a.projection),h=bn(l);h in e.wantedTiles||(e.wantedTiles[h]={});const f=e.wantedTiles[h],g=o.getMapInternal(),y=Math.max(r-s,u.getMinZoom(),u.getZForResolution(Math.min(o.getMaxResolution(),g?g.getView().getResolutionForZoom(Math.max(o.getMinZoom(),0)):u.getResolution(0)),l.zDirection)),v=a.rotation,x=v?HO(a.center,a.resolution,v,e.size):void 0;for(let E=r;E>=y;--E){const T=u.getTileRangeForExtentAndZ(t,E,this.tempTileRange_),b=u.getResolution(E);for(let I=T.minX;I<=T.maxX;++I)for(let M=T.minY;M<=T.maxY;++M){if(v&&!u.tileCoordIntersectsViewport([E,I,M],x))continue;const F=this.getTile(E,I,M,e);if(!F||!$2(i,F,E))continue;const k=F.getKey();if(f[k]=!0,F.getState()===Nt.IDLE&&!e.tileQueue.isKeyQueued(k)){const C=mx(E,I,M,this.tempTileCoord_);e.tileQueue.enqueue([F,h,u.getTileCoordCenter(C),b])}}}}findStaleTile_(e,t){const r=this.tileCache_,i=e[0],s=e[1],a=e[2],o=this.getStaleKeys();for(let l=0;l<o.length;++l){const u=I_(this.getLayer().getSource(),o[l],i,s,a);if(r.containsKey(u)){const h=r.peek(u);if(h.getState()===Nt.LOADED)return h.endTransition(bn(this)),$2(t,h,i),!0}}return!1}findAltTiles_(e,t,r,i){const s=e.getTileRangeForTileCoordAndZ(t,r,this.tempTileRange_);if(!s)return!1;let a=!0;const o=this.tileCache_,l=this.getLayer().getRenderSource(),u=l.getKey();for(let h=s.minX;h<=s.maxX;++h)for(let f=s.minY;f<=s.maxY;++f){const g=I_(l,u,r,h,f);let y=!1;if(o.containsKey(g)){const v=o.peek(g);v.getState()===Nt.LOADED&&($2(i,v,r),y=!0)}y||(a=!1)}return a}renderFrame(e,t){this.renderComplete=!0;const r=e.layerStatesArray[e.layerIndex],i=e.viewState,s=i.projection,a=i.resolution,o=i.center,l=e.pixelRatio,u=this.getLayer(),h=u.getSource(),f=h.getTileGridForProjection(s),g=f.getZForResolution(a,h.zDirection),y=f.getResolution(g),v=h.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==v&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=v):this.renderedSourceKey_=v;let x=e.extent;const E=h.getTilePixelRatio(l);this.prepareContainer(e,t);const T=this.context.canvas.width,b=this.context.canvas.height,I=r.extent&&No(r.extent);I&&(x=Pl(x,No(r.extent)));const M=y*T/2/E,F=y*b/2/E,z=[o[0]-M,o[1]-F,o[0]+M,o[1]+F],k={};this.renderedTiles.length=0;const C=u.getPreload();if(e.nextExtent&&this.enqueueTilesForNextExtent()){const ce=f.getZForResolution(i.nextResolution,h.zDirection),Te=k4(e,e.nextExtent);this.enqueueTiles(e,Te,ce,k,C)}const P=k4(e,x);if(this.enqueueTiles(e,P,g,k,0),C>0&&setTimeout(()=>{this.enqueueTiles(e,P,g-1,k,C-1)},0),!(g in k))return this.container;const L=bn(this),O=e.time;for(const ce of k[g]){const Te=ce.getState();if(Te===Nt.EMPTY)continue;const Ee=ce.tileCoord;if(Te===Nt.LOADED&&ce.getAlpha(L,O)===1){ce.endTransition(L);continue}if(Te!==Nt.ERROR&&(this.renderComplete=!1),this.findStaleTile_(Ee,k)){mW(k,ce,g),e.animate=!0;continue}if(this.findAltTiles_(f,Ee,g+1,k))continue;const J=f.getMinZoom();for(let ne=g-1;ne>=J&&!this.findAltTiles_(f,Ee,ne,k);--ne);}const U=y/a*l/E,j=this.getRenderContext(e);Ko(this.tempTransform,T/2,b/2,U,U,0,-T/2,-b/2),r.extent&&this.clipUnrotated(j,e,I),h.getInterpolate()||(j.imageSmoothingEnabled=!1),this.preRender(j,e);const Ie=Object.keys(k).map(Number);Ie.sort(Cl);let ke;const ze=[],Ne=[];for(let ce=Ie.length-1;ce>=0;--ce){const Te=Ie[ce],Ee=h.getTilePixelSize(Te,l,s),V=f.getResolution(Te)/y,J=Ee[0]*V*U,ne=Ee[1]*V*U,X=f.getTileCoordForCoordAndZ(sd(z),Te),ue=f.getTileCoordExtent(X),Me=ti(this.tempTransform,[E*(ue[0]-z[0])/y,E*(z[3]-ue[3])/y]),je=E*h.getGutterForProjection(s);for(const De of k[Te]){if(De.getState()!==Nt.LOADED)continue;const Be=De.tileCoord,Gt=X[1]-Be[1],Kt=Math.round(Me[0]-(Gt-1)*J),wn=X[2]-Be[2],Bt=Math.round(Me[1]-(wn-1)*ne),Fn=Math.round(Me[0]-Gt*J),Qt=Math.round(Me[1]-wn*ne),ot=Kt-Fn,Xn=Bt-Qt,on=Ie.length===1;let en=!1;ke=[Fn,Qt,Fn+ot,Qt,Fn+ot,Qt+Xn,Fn,Qt+Xn];for(let Zn=0,gt=ze.length;Zn<gt;++Zn)if(!on&&Te<Ne[Zn]){const jt=ze[Zn];as([Fn,Qt,Fn+ot,Qt+Xn],[jt[0],jt[3],jt[4],jt[7]])&&(en||(j.save(),en=!0),j.beginPath(),j.moveTo(ke[0],ke[1]),j.lineTo(ke[2],ke[3]),j.lineTo(ke[4],ke[5]),j.lineTo(ke[6],ke[7]),j.moveTo(jt[6],jt[7]),j.lineTo(jt[4],jt[5]),j.lineTo(jt[2],jt[3]),j.lineTo(jt[0],jt[1]),j.clip())}ze.push(ke),Ne.push(Te),this.drawTile(De,e,Fn,Qt,ot,Xn,je,on),en&&j.restore(),this.renderedTiles.unshift(De),this.updateUsedTiles(e.usedTiles,h,De)}}if(this.renderedResolution=y,this.extentChanged=!this.renderedExtent_||!o0(this.renderedExtent_,z),this.renderedExtent_=z,this.renderedPixelRatio=l,this.postRender(this.context,e),r.extent&&j.restore(),j.imageSmoothingEnabled=!0,this.renderComplete){const ce=(Te,Ee)=>{const se=bn(h),V=Ee.wantedTiles[se],J=V?Object.keys(V).length:0;this.updateCacheSize(J),this.tileCache_.expireCache(),this.sourceTileCache_?.expireCache()};e.postRenderFunctions.push(ce)}return this.container}updateCacheSize(e){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,e*2)}drawTile(e,t,r,i,s,a,o,l){let u;if(e instanceof A4){if(u=fT(e.getData()),!u)throw new Error("Rendering array data is not yet supported")}else u=this.getTileImage(e);if(!u)return;const h=this.getRenderContext(t),f=bn(this),g=t.layerStatesArray[t.layerIndex],y=g.opacity*(l?e.getAlpha(f,t.time):1),v=y!==h.globalAlpha;v&&(h.save(),h.globalAlpha=y),h.drawImage(u,o,o,u.width-2*o,u.height-2*o,r,i,s,a),v&&h.restore(),y!==g.opacity?t.animate=!0:l&&e.endTransition(f)}getImage(){const e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}updateUsedTiles(e,t,r){const i=bn(t);i in e||(e[i]={}),e[i][r.getKey()]=!0}}const Yy={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class yW extends Zp{constructor(e){e=e||{};const t=Object.assign({},e),r=e.cacheSize;delete e.cacheSize,delete t.preload,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un,this.cacheSize_=r,this.setPreload(e.preload!==void 0?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(Yy.PRELOAD)}setPreload(e){this.set(Yy.PRELOAD,e)}getUseInterimTilesOnError(){return this.get(Yy.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(Yy.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}}class nh extends yW{constructor(e){super(e)}createRenderer(){return new pW(this,{cacheSize:this.getCacheSize()})}}function gT(n){return Array.isArray(n)?Math.min(...n):n}const af=[0,0,0],Ac=5;class aD{constructor(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,Dn(DB(this.resolutions_,(i,s)=>s-i),"`resolutions` must be sorted in descending order");let t;if(!e.origins){for(let i=0,s=this.resolutions_.length-1;i<s;++i)if(!t)t=this.resolutions_[i]/this.resolutions_[i+1];else if(this.resolutions_[i]/this.resolutions_[i+1]!==t){t=void 0;break}}this.zoomFactor_=t,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,Dn(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const r=e.extent;r!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=sd(r)),Dn(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,Dn(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:EI,Dn(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=r!==void 0?r:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map((i,s)=>{const a=new bI(Math.min(0,i[0]),Math.max(i[0]-1,-1),Math.min(0,i[1]),Math.max(i[1]-1,-1));if(r){const o=this.getTileRangeForExtentAndZ(r,s);a.minX=Math.max(o.minX,a.minX),a.maxX=Math.min(o.maxX,a.maxX),a.minY=Math.max(o.minY,a.minY),a.maxY=Math.min(o.maxY,a.maxY)}return a}):r&&this.calculateTileRanges_(r)}forEachTileCoord(e,t,r){const i=this.getTileRangeForExtentAndZ(e,t);for(let s=i.minX,a=i.maxX;s<=a;++s)for(let o=i.minY,l=i.maxY;o<=l;++o)r([t,s,o])}forEachTileCoordParentTileRange(e,t,r,i){let s,a,o,l=null,u=e[0]-1;for(this.zoomFactor_===2?(a=e[1],o=e[2]):l=this.getTileCoordExtent(e,i);u>=this.minZoom;){if(a!==void 0&&o!==void 0?(a=Math.floor(a/2),o=Math.floor(o/2),s=sf(a,a,o,o,r)):s=this.getTileRangeForExtentAndZ(l,u,r),t(u,s))return!0;--u}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,t,r){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){const s=e[1]*2,a=e[2]*2;return sf(s,s+1,a,a+1,t)}const i=this.getTileCoordExtent(e,r||this.tmpExtent_);return this.getTileRangeForExtentAndZ(i,e[0]+1,t)}return null}getTileRangeForTileCoordAndZ(e,t,r){if(t>this.maxZoom||t<this.minZoom)return null;const i=e[0],s=e[1],a=e[2];if(t===i)return sf(s,a,s,a,r);if(this.zoomFactor_){const l=Math.pow(this.zoomFactor_,t-i),u=Math.floor(s*l),h=Math.floor(a*l);if(t<i)return sf(u,u,h,h,r);const f=Math.floor(l*(s+1))-1,g=Math.floor(l*(a+1))-1;return sf(u,f,h,g,r)}const o=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(o,t,r)}getTileRangeForExtentAndZ(e,t,r){this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,af);const i=af[1],s=af[2];this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,af);const a=af[1],o=af[2];return sf(i,a,s,o,r)}getTileCoordCenter(e){const t=this.getOrigin(e[0]),r=this.getResolution(e[0]),i=bs(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*i[0]*r,t[1]-(e[2]+.5)*i[1]*r]}getTileCoordExtent(e,t){const r=this.getOrigin(e[0]),i=this.getResolution(e[0]),s=bs(this.getTileSize(e[0]),this.tmpSize_),a=r[0]+e[1]*s[0]*i,o=r[1]-(e[2]+1)*s[1]*i,l=a+s[0]*i,u=o+s[1]*i;return lu(a,o,l,u,t)}getTileCoordForCoordAndResolution(e,t,r){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,r)}getTileCoordForXYAndResolution_(e,t,r,i,s){const a=this.getZForResolution(r),o=r/this.getResolution(a),l=this.getOrigin(a),u=bs(this.getTileSize(a),this.tmpSize_);let h=o*(e-l[0])/r/u[0],f=o*(l[1]-t)/r/u[1];return i?(h=zc(h,Ac)-1,f=zc(f,Ac)-1):(h=Vy(h,Ac),f=Vy(f,Ac)),mx(a,h,f,s)}getTileCoordForXYAndZ_(e,t,r,i,s){const a=this.getOrigin(r),o=this.getResolution(r),l=bs(this.getTileSize(r),this.tmpSize_);let u=(e-a[0])/o/l[0],h=(a[1]-t)/o/l[1];return i?(u=zc(u,Ac)-1,h=zc(h,Ac)-1):(u=Vy(u,Ac),h=Vy(h,Ac)),mx(r,u,h,s)}getTileCoordForCoordAndZ(e,t,r){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,r)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,t){const r=Rv(this.resolutions_,e,t||0);return ar(r,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,t){return h5(t,0,t.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){const t=this.resolutions_.length,r=new Array(t);for(let i=this.minZoom;i<t;++i)r[i]=this.getTileRangeForExtentAndZ(e,i);this.fullTileRanges_=r}}function oD(n){let e=n.getDefaultTileGrid();return e||(e=wW(n),n.setDefaultTileGrid(e)),e}function _W(n,e,t){const r=e[0],i=n.getTileCoordCenter(e),s=II(t);if(!Lh(s,i)){const a=un(s),o=Math.ceil((s[0]-i[0])/a);return i[0]+=a*o,n.getTileCoordForCoordAndZ(i,r)}return e}function xW(n,e,t,r){r=r!==void 0?r:"top-left";const i=lD(n,e,t);return new aD({extent:n,origin:BB(n,r),resolutions:i,tileSize:t})}function vW(n){const e=n||{},t=e.extent||qn("EPSG:3857").getExtent(),r={extent:t,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:lD(t,e.maxZoom,e.tileSize,e.maxResolution)};return new aD(r)}function lD(n,e,t,r){e=e!==void 0?e:Z$,t=bs(t!==void 0?t:EI);const i=$r(n),s=un(n);r=r>0?r:Math.max(s/t[0],i/t[1]);const a=e+1,o=new Array(a);for(let l=0;l<a;++l)o[l]=r/Math.pow(2,l);return o}function wW(n,e,t,r){const i=II(n);return xW(i,e,t,r)}function II(n){n=qn(n);let e=n.getExtent();if(!e){const t=180*l0.degrees/n.getMetersPerUnit();e=lu(-t,-t,t,t)}return e}function AI(n,e){const t=[];Object.keys(e).forEach(function(i){e[i]!==null&&e[i]!==void 0&&t.push(i+"="+encodeURIComponent(e[i]))});const r=t.join("&");return n=n.replace(/[?&]$/,""),n+=n.includes("?")?"&":"?",n+r}const EW=/\{z\}/g,SW=/\{x\}/g,TW=/\{y\}/g,bW=/\{-y\}/g;function IW(n,e,t,r,i){return n.replace(EW,e.toString()).replace(SW,t.toString()).replace(TW,r.toString()).replace(bW,function(){if(i===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(i-r).toString()})}function AW(n){const e=[];let t=/\{([a-z])-([a-z])\}/.exec(n);if(t){const r=t[1].charCodeAt(0),i=t[2].charCodeAt(0);let s;for(s=r;s<=i;++s)e.push(n.replace(t[0],String.fromCharCode(s)));return e}if(t=/\{(\d+)-(\d+)\}/.exec(n),t){const r=parseInt(t[2],10);for(let i=parseInt(t[1],10);i<=r;i++)e.push(n.replace(t[0],i.toString()));return e}return e.push(n),e}function RW(n,e){return(function(t,r,i){if(!t)return;let s;const a=t[0];if(e){const o=e.getFullTileRange(a);o&&(s=o.getHeight()-1)}return IW(n,a,t[1],t[2],s)})}function CW(n,e){const t=n.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=RW(n[i],e);return PW(r)}function PW(n){return n.length===1?n[0]:(function(e,t,r){if(!e)return;const i=sD(e),s=Jc(i,n.length);return n[s](e,t,r)})}class kW extends mI{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=e.tilePixelRatio!==void 0?e.tilePixelRatio:1,this.tileGrid=e.tileGrid!==void 0?e.tileGrid:null;const t=[256,256];this.tileGrid&&bs(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),t),this.tmpSize=[0,0],this.key_=e.key||bn(this),this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}getGutterForProjection(e){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getResolutions(e){const t=e?this.getTileGridForProjection(e):this.tileGrid;return t?t.getResolutions():null}getTile(e,t,r,i,s,a){return Vt()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:oD(e)}getTilePixelRatio(e){return this.tilePixelRatio_}getTilePixelSize(e,t,r){const i=this.getTileGridForProjection(r),s=this.getTilePixelRatio(t),a=bs(i.getTileSize(e),this.tmpSize);return s==1?a:Fz(a,s,this.tmpSize)}getTileCoordForTileUrlFunction(e,t){const r=t!==void 0?t:this.getProjection(),i=t!==void 0?this.getTileGridForProjection(r):this.tileGrid||this.getTileGridForProjection(r);return this.getWrapX()&&r.isGlobal()&&(e=_W(i,e,r)),hW(e,i)?e:null}clear(){}refresh(){this.clear(),super.refresh()}}class MW extends el{constructor(e,t){super(e),this.tile=t}}const W2={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class RI extends kW{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===RI.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){const t=e.target,r=bn(t),i=t.getState();let s;i==Nt.LOADING?(this.tileLoadingKeys_[r]=!0,s=W2.TILELOADSTART):r in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[r],s=i==Nt.ERROR?W2.TILELOADERROR:i==Nt.LOADED?W2.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new MW(s,t))}setTileLoadFunction(e){this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,t){this.tileUrlFunction=e,typeof t<"u"?this.setKey(t):this.changed()}setUrl(e){const t=AW(e);this.urls=t,this.setUrls(t)}setUrls(e){this.urls=e;const t=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(CW(e,this.tileGrid),t):this.setKey(t)}tileUrlFunction(e,t,r){}}class cD extends RI{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:uD,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate!==void 0?e.interpolate:!0,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,this.tileClass=e.tileClass!==void 0?e.tileClass:eD,this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(e){return this.getProjection()&&e&&!Ih(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getTileGridForProjection(e){const t=this.getProjection();if(this.tileGrid&&(!t||Ih(t,e)))return this.tileGrid;const r=bn(e);return r in this.tileGridForProjection||(this.tileGridForProjection[r]=oD(e)),this.tileGridForProjection[r]}createTile_(e,t,r,i,s,a){const o=[e,t,r],l=this.getTileCoordForTileUrlFunction(o,s),u=l?this.tileUrlFunction(l,i,s):void 0,h=new this.tileClass(o,u!==void 0?Nt.IDLE:Nt.EMPTY,u!==void 0?u:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return h.key=a,h.addEventListener(Yt.CHANGE,this.handleTileChange.bind(this)),h}getTile(e,t,r,i,s,a){const o=this.getProjection();if(!o||!s||Ih(o,s))return this.getTileInternal(e,t,r,i,o||s);const l=[e,t,r],u=this.getKey(),h=this.getTileGridForProjection(o),f=this.getTileGridForProjection(s),g=this.getTileCoordForTileUrlFunction(l,s),y=new iD(o,h,s,f,l,g,this.getTilePixelRatio(i),this.getGutter(),(v,x,E,T)=>this.getTileInternal(v,x,E,T,o,a),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return y.key=u,y}getTileInternal(e,t,r,i,s,a){const o=this.getKey(),l=I_(this,o,e,t,r);if(a&&a.containsKey(l))return a.get(l);const u=this.createTile_(e,t,r,i,s,o);return a?.set(l,u),u}setRenderReprojectionEdges(e){this.renderReprojectionEdges_!=e&&(this.renderReprojectionEdges_=e,this.changed())}setTileGridForProjection(e,t){const r=qn(e);if(r){const i=bn(r);i in this.tileGridForProjection||(this.tileGridForProjection[i]=t)}}}function uD(n,e){if(qs){const t=n.getCrossOrigin();let r="same-origin",i="same-origin";t==="anonymous"||t===""?(r="cors",i="omit"):t==="use-credentials"&&(r="cors",i="include"),fetch(e,{mode:r,credentials:i}).then(s=>{if(!s.ok)throw new Error(`HTTP ${s.status}`);return s.blob()}).then(s=>createImageBitmap(s)).then(s=>{const a=n.getImage();a.width=s.width,a.height=s.height,a.getContext("2d").drawImage(s,0,0),s.close?.(),a.dispatchEvent(new Event("load"))}).catch(()=>{n.getImage().dispatchEvent(new Event("error"))});return}n.getImage().src=e}class wf extends cD{constructor(e){e=e||{};const t=e.projection!==void 0?e.projection:"EPSG:3857",r=e.tileGrid!==void 0?e.tileGrid:vW({extent:II(t),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:t,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:r,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0}getGutter(){return this.gutter_}}const NW="modulepreload",LW=function(n){return"/detectorapp-nl/"+n},M4={},mt=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){let l=function(u){return Promise.all(u.map(h=>Promise.resolve(h).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=a?.nonce||a?.getAttribute("nonce");i=l(t.map(u=>{if(u=LW(u),u in M4)return;M4[u]=!0;const h=u.endsWith(".css"),f=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${f}`))return;const g=document.createElement("link");if(g.rel=h?"stylesheet":NW,h||(g.as="script"),g.crossOrigin="",g.href=u,o&&g.setAttribute("nonce",o),document.head.appendChild(g),h)return new Promise((y,v)=>{g.addEventListener("load",y),g.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${u}`)))})}))}function s(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return i.then(a=>{for(const o of a||[])o.status==="rejected"&&s(o.reason);return e().catch(s)})};class OW extends v5{constructor(e,t,r,i,s,a,o){let l=e.getExtent();l&&e.canWrapX()&&(l=l.slice(),l[0]=-1/0,l[2]=1/0);let u=t.getExtent();u&&t.canWrapX()&&(u=u.slice(),u[0]=-1/0,u[2]=1/0);const h=u?Pl(r,u):r,f=Wo(h),g=gx(e,t,f,i),y=rD,v=new nD(e,t,h,l,g*y,i),x=v.calculateSourceExtent(),E=N0(x)?null:a(x,g,s),T=E?vt.IDLE:vt.EMPTY,b=E?E.getPixelRatio():1;super(r,i,b,T),this.targetProj_=t,this.maxSourceExtent_=l,this.triangulation_=v,this.targetResolution_=i,this.targetExtent_=r,this.sourceImage_=E,this.sourcePixelRatio_=b,this.interpolate_=o,this.canvas_=null,this.sourceListenerKey_=null}disposeInternal(){this.state==vt.LOADING&&this.unlistenSource_(),super.disposeInternal()}getImage(){return this.canvas_}getProjection(){return this.targetProj_}reproject_(){const e=this.sourceImage_.getState();if(e==vt.LOADED){const t=un(this.targetExtent_)/this.targetResolution_,r=$r(this.targetExtent_)/this.targetResolution_;this.canvas_=tD(t,r,this.sourcePixelRatio_,gT(this.sourceImage_.getResolution()),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0,void 0,this.interpolate_,!0)}this.state=e,this.changed()}load(){if(this.state==vt.IDLE){this.state=vt.LOADING,this.changed();const e=this.sourceImage_.getState();e==vt.LOADED||e==vt.ERROR?this.reproject_():(this.sourceListenerKey_=yn(this.sourceImage_,Yt.CHANGE,t=>{const r=this.sourceImage_.getState();(r==vt.LOADED||r==vt.ERROR)&&(this.unlistenSource_(),this.reproject_())}),this.sourceImage_.load())}}unlistenSource_(){tr(this.sourceListenerKey_),this.sourceListenerKey_=null}}const Kc=4,H2={IMAGELOADSTART:"imageloadstart",IMAGELOADEND:"imageloadend",IMAGELOADERROR:"imageloaderror"};class DW extends el{constructor(e,t){super(e),this.image=t}}class FW extends mI{constructor(e){super({attributions:e.attributions,projection:e.projection,state:e.state,interpolate:e.interpolate!==void 0?e.interpolate:!0}),this.on,this.once,this.un,this.loader=e.loader||null,this.resolutions_=e.resolutions!==void 0?e.resolutions:null,this.reprojectedImage_=null,this.reprojectedRevision_=0,this.image=null,this.wantedExtent_,this.wantedResolution_,this.static_=e.loader?e.loader.length===0:!1,this.wantedProjection_=null}getResolutions(){return this.resolutions_}setResolutions(e){this.resolutions_=e}findNearestResolution(e){const t=this.getResolutions();if(t){const r=Rv(t,e,0);e=t[r]}return e}getImage(e,t,r,i){const s=this.getProjection();if(!s||!i||Ih(s,i))return s&&(i=s),this.getImageInternal(e,t,r,i);if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&Ih(this.reprojectedImage_.getProjection(),i)&&this.reprojectedImage_.getResolution()==t&&o0(this.reprojectedImage_.getExtent(),e))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new OW(s,i,e,t,r,(a,o,l)=>this.getImageInternal(a,o,l,s),this.getInterpolate()),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}getImageInternal(e,t,r,i){if(this.loader){const s=hD(e,t,r,1),a=this.findNearestResolution(t);if(this.image&&(this.static_||this.wantedProjection_===i&&(this.wantedExtent_&&Uc(this.wantedExtent_,s)||Uc(this.image.getExtent(),s))&&(this.wantedResolution_&&gT(this.wantedResolution_)===a||gT(this.image.getResolution())===a)))return this.image;this.wantedProjection_=i,this.wantedExtent_=s,this.wantedResolution_=a,this.image=new v5(s,a,r,this.loader),this.image.addEventListener(Yt.CHANGE,this.handleImageChange.bind(this))}return this.image}handleImageChange(e){const t=e.target;let r;switch(t.getState()){case vt.LOADING:this.loading=!0,r=H2.IMAGELOADSTART;break;case vt.LOADED:this.loading=!1,r=H2.IMAGELOADEND;break;case vt.ERROR:this.loading=!1,r=H2.IMAGELOADERROR;break;default:return}this.hasListener(r)&&this.dispatchEvent(new DW(r,t))}}function jW(n,e){n.getImage().src=e}function hD(n,e,t,r){const i=e/t,s=Wo(n),a=zc(un(n)/i,Kc),o=zc($r(n)/i,Kc),l=zc((r-1)*a/2,Kc),u=a+2*l,h=zc((r-1)*o/2,Kc),f=o+2*h;return J_(s,i,0,[u,f])}function VW(n,e,t,r,i,s){const a=i.getCode().split(/:(?=\d+$)/).pop(),o=t/r,l=[ex(un(e)/o,Kc),ex($r(e)/o,Kc)];s.SIZE=l[0]+","+l[1],s.BBOX=e.join(","),s.BBOXSR=a,s.IMAGESR=a,s.DPI=Math.round(s.DPI?s.DPI*r:90*r);const u=n.replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage");return AI(u,s)}function GW(n){const e=n.load?n.load:E5,t=qn(n.projection||"EPSG:3857"),r=n.ratio??1.5,i=n.crossOrigin??null;return function(s,a,o){o=n.hidpi?o:1;const l={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};Object.assign(l,n.params),s=hD(s,a,o,r);const u=VW(n.url,s,a,o,t,l),h=new Image;return h.crossOrigin=i,e(h,u).then(f=>{const g=un(s)/f.width*o;return{image:f,extent:s,resolution:g,pixelRatio:o}})}}class BW extends FW{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:e.interpolate,projection:e.projection,resolutions:e.resolutions}),this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.url_=e.url,this.imageLoadFunction_=e.imageLoadFunction!==void 0?e.imageLoadFunction:jW,this.params_=Object.assign({},e.params),this.imageSize_=[0,0],this.renderedRevision_=0,this.ratio_=e.ratio!==void 0?e.ratio:1.5,this.loaderProjection_=null}getParams(){return this.params_}getImageInternal(e,t,r,i){return this.url_===void 0?null:((!this.loader||this.loaderProjection_!==i)&&(this.loaderProjection_=i,this.loader=GW({crossOrigin:this.crossOrigin_,params:this.params_,projection:i,hidpi:this.hidpi_,url:this.url_,ratio:this.ratio_,load:(s,a)=>(this.image.setImage(s),this.imageLoadFunction_(this.image,a),E5(s))})),super.getImageInternal(e,t,r,i))}getImageLoadFunction(){return this.imageLoadFunction_}getUrl(){return this.url_}setImageLoadFunction(e){this.imageLoadFunction_=e,this.changed()}setUrl(e){e!=this.url_&&(this.url_=e,this.loader=null,this.changed())}setParams(e){this.params_=Object.assign({},e),this.changed()}updateParams(e){Object.assign(this.params_,e),this.changed()}changed(){this.image=null,super.changed()}}const mT="1.3.0";function UW(n,e,t,r,i){i.WIDTH=t[0],i.HEIGHT=t[1];const s=r.getAxisOrientation(),a=qO(i.VERSION,"1.3")>=0;i[a?"CRS":"SRS"]=r.getCode();const o=a&&s.startsWith("ne")?[e[1],e[0],e[3],e[2]]:e;return i.BBOX=o.join(","),AI(n,i)}function zW(n,e,t,r,i,s,a){s=Object.assign({REQUEST:"GetMap"},s);const o=e/t,l=[ex(un(n)/o,Kc),ex($r(n)/o,Kc)];if(t!=1)switch(a){case"geoserver":const h=90*t+.5|0;"FORMAT_OPTIONS"in s?s.FORMAT_OPTIONS+=";dpi:"+h:s.FORMAT_OPTIONS="dpi:"+h;break;case"mapserver":s.MAP_RESOLUTION=90*t;break;case"carmentaserver":case"qgis":s.DPI=90*t;break;default:throw new Error("Unknown `serverType` configured")}return UW(i,n,l,r,s)}function N4(n,e){return Object.assign({REQUEST:e,SERVICE:"WMS",VERSION:mT,FORMAT:"image/png",STYLES:"",TRANSPARENT:"TRUE"},n)}const $W='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.';class WW extends wf{constructor(e){e=e||{};let t;e.attributions!==void 0?t=e.attributions:t=[$W];const r=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",i=e.url!==void 0?e.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:t,attributionsCollapsible:!1,cacheSize:e.cacheSize,crossOrigin:r,interpolate:e.interpolate,maxZoom:e.maxZoom!==void 0?e.maxZoom:19,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:(s,a)=>{const o=s.getImage();!qs&&o instanceof HTMLImageElement&&(o.referrerPolicy="origin-when-cross-origin"),(e.tileLoadFunction||uD)(s,a)},transition:e.transition,url:i,wrapX:e.wrapX,zDirection:e.zDirection})}}const px=1/0;class HW{constructor(e,t){this.priorityFunction_=e,this.keyFunction_=t,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,jp(this.queuedElements_)}dequeue(){const e=this.elements_,t=this.priorities_,r=e[0];e.length==1?(e.length=0,t.length=0):(e[0]=e.pop(),t[0]=t.pop(),this.siftUp_(0));const i=this.keyFunction_(r);return delete this.queuedElements_[i],r}enqueue(e){Dn(!(this.keyFunction_(e)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const t=this.priorityFunction_(e);return t!=px?(this.elements_.push(e),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(e){return e*2+1}getRightChildIndex_(e){return e*2+2}getParentIndex_(e){return e-1>>1}heapify_(){let e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)}isEmpty(){return this.elements_.length===0}isKeyQueued(e){return e in this.queuedElements_}isQueued(e){return this.isKeyQueued(this.keyFunction_(e))}siftUp_(e){const t=this.elements_,r=this.priorities_,i=t.length,s=t[e],a=r[e],o=e;for(;e<i>>1;){const l=this.getLeftChildIndex_(e),u=this.getRightChildIndex_(e),h=u<i&&r[u]<r[l]?u:l;t[e]=t[h],r[e]=r[h],e=h}t[e]=s,r[e]=a,this.siftDown_(o,e)}siftDown_(e,t){const r=this.elements_,i=this.priorities_,s=r[t],a=i[t];for(;t>e;){const o=this.getParentIndex_(t);if(i[o]>a)r[t]=r[o],i[t]=i[o],t=o;else break}r[t]=s,i[t]=a}reprioritize(){const e=this.priorityFunction_,t=this.elements_,r=this.priorities_;let i=0;const s=t.length;let a,o,l;for(o=0;o<s;++o)a=t[o],l=e(a),l==px?delete this.queuedElements_[this.keyFunction_(a)]:(r[i]=l,t[i++]=a);t.length=i,r.length=i,this.heapify_()}}class KW extends HW{constructor(e,t){super(r=>e.apply(null,r),r=>r[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=t,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(e){const t=super.enqueue(e);return t&&e[0].addEventListener(Yt.CHANGE,this.boundHandleTileChange_),t}getTilesLoading(){return this.tilesLoading_}handleTileChange(e){const t=e.target,r=t.getState();if(r===Nt.LOADED||r===Nt.ERROR||r===Nt.EMPTY){r!==Nt.ERROR&&t.removeEventListener(Yt.CHANGE,this.boundHandleTileChange_);const i=t.getKey();i in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[i],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(e,t){let r=0;for(;this.tilesLoading_<e&&r<t&&this.getCount()>0;){const i=this.dequeue()[0],s=i.getKey();i.getState()===Nt.IDLE&&!(s in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++r,i.load())}}}function YW(n,e,t,r,i){if(!n||!(t in n.wantedTiles)||!n.wantedTiles[t][e.getKey()])return px;const s=n.viewState.center,a=r[0]-s[0],o=r[1]-s[1];return 65536*Math.log(i)+Math.sqrt(a*a+o*o)/i}class qW extends cD{constructor(e){e=e||{};const t=Object.assign({},e.params);super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:e.tileClass,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0,this.params_=t,this.v13_=!0,this.serverType_=e.serverType,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.tmpExtent_=Qs(),this.updateV13_(),this.setKey(this.getKeyForParams_())}getFeatureInfoUrl(e,t,r,i){const s=qn(r),a=this.getProjection()||s;let o=this.getTileGrid();o||(o=this.getTileGridForProjection(a));const l=$p(e,s,a),u=gx(a,s,e,t),h=o.getZForResolution(u,this.zDirection),f=o.getResolution(h),g=o.getTileCoordForCoordAndZ(l,h);if(o.getResolutions().length<=g[0])return;let y=o.getTileCoordExtent(g,this.tmpExtent_);const v=this.gutter_;v!==0&&(y=Wm(y,f*v,y));const x={QUERY_LAYERS:this.params_.LAYERS};Object.assign(x,N4(this.params_,"GetFeatureInfo"),i);const E=Math.floor((l[0]-y[0])/f),T=Math.floor((y[3]-l[1])/f);return x[this.v13_?"I":"X"]=E,x[this.v13_?"J":"Y"]=T,this.getRequestUrl_(g,y,1,a||s,x)}getLegendUrl(e,t){if(this.urls[0]===void 0)return;const r={SERVICE:"WMS",VERSION:mT,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(t===void 0||t.LAYER===void 0){const i=this.params_.LAYERS;if(!(!Array.isArray(i)||i.length===1))return;r.LAYER=i}if(e!==void 0){const i=this.getProjection()?this.getProjection().getMetersPerUnit():1,s=28e-5;r.SCALE=e*i/s}return Object.assign(r,t),AI(this.urls[0],r)}getGutter(){return this.gutter_}getParams(){return this.params_}getRequestUrl_(e,t,r,i,s){const a=this.urls;if(!a)return;let o;if(a.length==1)o=a[0];else{const l=Jc(sD(e),a.length);o=a[l]}return zW(t,(this.tileGrid||this.getTileGridForProjection(i)).getResolution(e[0]),r,i,o,s,this.serverType_)}getTilePixelRatio(e){return!this.hidpi_||this.serverType_===void 0?1:e}getKeyForParams_(){let e=0;const t=[];for(const r in this.params_)t[e++]=r+"-"+this.params_[r];return t.join("/")}setParams_(e){this.params_=e,this.updateV13_(),this.setKey(this.getKeyForParams_())}setParams(e){this.setParams_(Object.assign({},e))}updateParams(e){this.setParams_(Object.assign(this.params_,e))}updateV13_(){const e=this.params_.VERSION||mT;this.v13_=qO(e,"1.3")>=0}tileUrlFunction(e,t,r){let i=this.getTileGrid();if(i||(i=this.getTileGridForProjection(r)),i.getResolutions().length<=e[0])return;t!=1&&(!this.hidpi_||this.serverType_===void 0)&&(t=1);const s=i.getResolution(e[0]);let a=i.getTileCoordExtent(e,this.tmpExtent_);const o=this.gutter_;o!==0&&(a=Wm(a,s*o,a));const l=Object.assign({},N4(this.params_,"GetMap"));return this.getRequestUrl_(e,a,t,r,l)}}class Ef extends el{constructor(e,t,r){super(e),this.map=t,this.frameState=r!==void 0?r:null}}class Nc extends Ef{constructor(e,t,r,i,s,a){super(e,t,s),this.originalEvent=r,this.pixel_=null,this.coordinate_=null,this.dragging=i!==void 0?i:!1,this.activePointers=a}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(e){this.pixel_=e}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(e){this.coordinate_=e}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const Tr={SINGLECLICK:"singleclick",CLICK:Yt.CLICK,DBLCLICK:Yt.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},pT={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown"};class XW extends Vp{constructor(e,t){super(e),this.map_=e,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=t===void 0?1:t,this.down_=null;const r=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=r,this.pointerdownListenerKey_=yn(r,pT.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=yn(r,pT.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(Yt.TOUCHMOVE,this.boundHandleTouchMove_,y5?{passive:!1}:!1)}emulateClick_(e){let t=new Nc(Tr.CLICK,this.map_,e);this.dispatchEvent(t),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,t=new Nc(Tr.DBLCLICK,this.map_,e),this.dispatchEvent(t)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const r=new Nc(Tr.SINGLECLICK,this.map_,e);this.dispatchEvent(r)},250)}updateActivePointers_(e){const t=e,r=t.pointerId;if(t.type==Tr.POINTERUP||t.type==Tr.POINTERCANCEL){delete this.trackedTouches_[r];for(const i in this.trackedTouches_)if(this.trackedTouches_[i].target!==t.target){delete this.trackedTouches_[i];break}}else(t.type==Tr.POINTERDOWN||t.type==Tr.POINTERMOVE)&&(this.trackedTouches_[r]=t);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(e){this.updateActivePointers_(e);const t=new Nc(Tr.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(t),this.emulateClicks_&&!t.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(tr),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(e){return e.button===0}handlePointerDown_(e){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(e);const t=new Nc(Tr.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);if(this.dispatchEvent(t),this.down_=new PointerEvent(e.type,e),Object.defineProperty(this.down_,"target",{writable:!1,value:e.target}),this.dragListenerKeys_.length===0){const r=this.map_.getOwnerDocument();this.dragListenerKeys_.push(yn(r,Tr.POINTERMOVE,this.handlePointerMove_,this),yn(r,Tr.POINTERUP,this.handlePointerUp_,this),yn(this.element_,Tr.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==r&&this.dragListenerKeys_.push(yn(this.element_.getRootNode(),Tr.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;const t=new Nc(Tr.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(t)}}relayMoveEvent_(e){this.originalPointerMoveEvent_=e;const t=!!(this.down_&&this.isMoving_(e));this.dispatchEvent(new Nc(Tr.POINTERMOVE,this.map_,e,t))}handleTouchMove_(e){const t=this.originalPointerMoveEvent_;(!t||t.defaultPrevented)&&(typeof e.cancelable!="boolean"||e.cancelable===!0)&&e.preventDefault()}isMoving_(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(tr(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(Yt.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(tr(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(tr),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const Lc={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},Gi={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};class Wv extends tl{constructor(e){super();const t=e.element;t&&!e.target&&!t.style.pointerEvents&&(t.style.pointerEvents="auto"),this.element=t||null,this.target_=null,this.map_=null,this.listenerKeys=[],e.render&&(this.render=e.render),e.target&&this.setTarget(e.target)}disposeInternal(){this.element?.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(e){this.map_&&this.element?.remove();for(let t=0,r=this.listenerKeys.length;t<r;++t)tr(this.listenerKeys[t]);if(this.listenerKeys.length=0,this.map_=e,e){const t=this.target_??e.getOverlayContainerStopEvent();this.element&&t.appendChild(this.element),this.render!==$m&&this.listenerKeys.push(yn(e,Lc.POSTRENDER,this.render,this)),e.render()}}render(e){}setTarget(e){this.target_=typeof e=="string"?document.getElementById(e):e}}class ZW extends Wv{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=e.collapsible!==void 0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=e.attributions;const t=e.className!==void 0?e.className:"ol-attribution",r=e.tipLabel!==void 0?e.tipLabel:"Attributions",i=e.expandClassName!==void 0?e.expandClassName:t+"-expand",s=e.collapseLabel!==void 0?e.collapseLabel:"",a=e.collapseClassName!==void 0?e.collapseClassName:t+"-collapse";typeof s=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=a):this.collapseLabel_=s;const o=e.label!==void 0?e.label:"i";typeof o=="string"?(this.label_=document.createElement("span"),this.label_.textContent=o,this.label_.className=i):this.label_=o;const l=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=r,this.toggleButton_.appendChild(l),this.toggleButton_.addEventListener(Yt.CLICK,this.handleClick_.bind(this),!1);const u=t+" "+Hp+" "+hI+(this.collapsed_&&this.collapsible_?" "+Xk:"")+(this.collapsible_?"":" ol-uncollapsible"),h=this.element;h.className=u,h.appendChild(this.toggleButton_),h.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(e){const t=this.getMap().getAllLayers(),r=new Set(t.flatMap(i=>i.getAttributions(e)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(i=>r.add(i)):r.add(this.attributions_)),!this.overrideCollapsible_){const i=!t.some(s=>s.getSource()?.getAttributionsCollapsible()===!1);this.setCollapsible(i)}return Array.from(r)}async updateElement_(e){if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=await Promise.all(this.collectSourceAttributions_(e).map(i=>VO(()=>i))),r=t.length>0;if(this.renderedVisible_!=r&&(this.element.style.display=r?"":"none",this.renderedVisible_=r),!Su(t,this.renderedAttributions_)){$U(this.ulElement_);for(let i=0,s=t.length;i<s;++i){const a=document.createElement("li");a.innerHTML=t[i],this.ulElement_.appendChild(a)}this.renderedAttributions_=t}}handleClick_(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(Xk),this.collapsed_?Yk(this.collapseLabel_,this.label_):Yk(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(e){this.userCollapsed_=e,!(!this.collapsible_||this.collapsed_===e)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(e){this.updateElement_(e.frameState)}}class QW extends Wv{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target});const t=e.className!==void 0?e.className:"ol-rotate",r=e.label!==void 0?e.label:"",i=e.compassClassName!==void 0?e.compassClassName:"ol-compass";this.label_=null,typeof r=="string"?(this.label_=document.createElement("span"),this.label_.className=i,this.label_.textContent=r):(this.label_=r,this.label_.classList.add(i));const s=e.tipLabel?e.tipLabel:"Reset rotation",a=document.createElement("button");a.className=t+"-reset",a.setAttribute("type","button"),a.title=s,a.appendChild(this.label_),a.addEventListener(Yt.CLICK,this.handleClick_.bind(this),!1);const o=t+" "+Hp+" "+hI,l=this.element;l.className=o,l.appendChild(a),this.callResetNorth_=e.resetNorth?e.resetNorth:void 0,this.duration_=e.duration!==void 0?e.duration:250,this.autoHide_=e.autoHide!==void 0?e.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(Uy)}handleClick_(e){e.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const r=t.getRotation();r!==void 0&&(this.duration_>0&&r%(2*Math.PI)!==0?t.animate({rotation:0,duration:this.duration_,easing:L0}):t.setRotation(0))}render(e){const t=e.frameState;if(!t)return;const r=t.viewState.rotation;if(r!=this.rotation_){const i="rotate("+r+"rad)";if(this.autoHide_){const s=this.element.classList.contains(Uy);!s&&r===0?this.element.classList.add(Uy):s&&r!==0&&this.element.classList.remove(Uy)}this.label_.style.transform=i}this.rotation_=r}}class JW extends Wv{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target});const t=e.className!==void 0?e.className:"ol-zoom",r=e.delta!==void 0?e.delta:1,i=e.zoomInClassName!==void 0?e.zoomInClassName:t+"-in",s=e.zoomOutClassName!==void 0?e.zoomOutClassName:t+"-out",a=e.zoomInLabel!==void 0?e.zoomInLabel:"+",o=e.zoomOutLabel!==void 0?e.zoomOutLabel:"",l=e.zoomInTipLabel!==void 0?e.zoomInTipLabel:"Zoom in",u=e.zoomOutTipLabel!==void 0?e.zoomOutTipLabel:"Zoom out",h=document.createElement("button");h.className=i,h.setAttribute("type","button"),h.title=l,h.appendChild(typeof a=="string"?document.createTextNode(a):a),h.addEventListener(Yt.CLICK,this.handleClick_.bind(this,r),!1);const f=document.createElement("button");f.className=s,f.setAttribute("type","button"),f.title=u,f.appendChild(typeof o=="string"?document.createTextNode(o):o),f.addEventListener(Yt.CLICK,this.handleClick_.bind(this,-r),!1);const g=t+" "+Hp+" "+hI,y=this.element;y.className=g,y.appendChild(h),y.appendChild(f),this.duration_=e.duration!==void 0?e.duration:250}handleClick_(e,t){t.preventDefault(),this.zoomByDelta_(e)}zoomByDelta_(e){const r=this.getMap().getView();if(!r)return;const i=r.getZoom();if(i!==void 0){const s=r.getConstrainedZoom(i+e);this.duration_>0?(r.getAnimating()&&r.cancelAnimations(),r.animate({zoom:s,duration:this.duration_,easing:L0})):r.setZoom(s)}}}function eH(n){n=n||{};const e=new xa;return(n.zoom===void 0||n.zoom)&&e.push(new JW(n.zoomOptions)),(n.rotate===void 0||n.rotate)&&e.push(new QW(n.rotateOptions)),(n.attribution===void 0||n.attribution)&&e.push(new ZW(n.attributionOptions)),e}class tH{constructor(e,t,r){this.decay_=e,this.minVelocity_=t,this.delay_=r,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(e,t){this.points_.push(e,t,Date.now())}end(){if(this.points_.length<6)return!1;const e=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[t+2]<e)return!1;let r=t-3;for(;r>0&&this.points_[r+2]>e;)r-=3;const i=this.points_[t+2]-this.points_[r+2];if(i<1e3/60)return!1;const s=this.points_[t]-this.points_[r],a=this.points_[t+1]-this.points_[r+1];return this.angle_=Math.atan2(a,s),this.initialVelocity_=Math.sqrt(s*s+a*a)/i,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}const L4={ACTIVE:"active"};class Jp extends tl{constructor(e){super(),this.on,this.once,this.un,e&&e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(L4.ACTIVE)}getMap(){return this.map_}handleEvent(e){return!0}setActive(e){this.set(L4.ACTIVE,e)}setMap(e){this.map_=e}}function nH(n,e,t){const r=n.getCenterInternal();if(r){const i=[r[0]+e[0],r[1]+e[1]];n.animateInternal({duration:t!==void 0?t:250,easing:H$,center:n.getConstrainedCenter(i)})}}function CI(n,e,t,r){const i=n.getZoom();if(i===void 0)return;const s=n.getConstrainedZoom(i+e),a=n.getResolutionForZoom(s);n.getAnimating()&&n.cancelAnimations(),n.animate({resolution:a,anchor:t,duration:r!==void 0?r:250,easing:L0})}class rH extends Jp{constructor(e){super(),e=e||{},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:250}handleEvent(e){let t=!1;if(e.type==Tr.DBLCLICK){const r=e.originalEvent,i=e.map,s=e.coordinate,a=r.shiftKey?-this.delta_:this.delta_,o=i.getView();CI(o,a,s,this.duration_),r.preventDefault(),t=!0}return!t}}function yT(n){const e=arguments;return function(t){let r=!0;for(let i=0,s=e.length;i<s&&(r=r&&e[i](t),!!r);++i);return r}}const iH=function(n){const e=n.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},sH=function(n){const e=n.map.getTargetElement(),t=e.getRootNode(),r=n.map.getOwnerDocument().activeElement;return t instanceof ShadowRoot?t.host.contains(r):e.contains(r)},dD=function(n){const e=n.map.getTargetElement(),t=e.getRootNode();return(t instanceof ShadowRoot?t.host:e).hasAttribute("tabindex")?sH(n):!0},aH=zm,fD=function(n){const e=n.originalEvent;return"pointerId"in e&&e.button==0&&!(UU&&m5&&e.ctrlKey)},gD=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},oH=function(n){const e=n.originalEvent;return m5?e.metaKey:e.ctrlKey},lH=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},mD=function(n){const e=n.originalEvent,t=e.target.tagName;return t!=="INPUT"&&t!=="SELECT"&&t!=="TEXTAREA"&&!e.target.isContentEditable},K2=function(n){const e=n.originalEvent;return"pointerId"in e&&e.pointerType=="mouse"},cH=function(n){const e=n.originalEvent;return"pointerId"in e&&e.isPrimary&&e.button===0};class e1 extends Jp{constructor(e){e=e||{},super(e),e.handleDownEvent&&(this.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(this.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(this.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(this.handleUpEvent=e.handleUpEvent),e.stopDown&&(this.stopDown=e.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(e){return!1}handleDragEvent(e){}handleEvent(e){if(!e.originalEvent)return!0;let t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==Tr.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==Tr.POINTERUP){const r=this.handleUpEvent(e);this.handlingDownUpSequence=r&&this.targetPointers.length>0}}else if(e.type==Tr.POINTERDOWN){const r=this.handleDownEvent(e);this.handlingDownUpSequence=r,t=this.stopDown(r)}else e.type==Tr.POINTERMOVE&&this.handleMoveEvent(e);return!t}handleMoveEvent(e){}handleUpEvent(e){return!1}stopDown(e){return e}updateTrackedPointers_(e){e.activePointers&&(this.targetPointers=e.activePointers)}}function PI(n){const e=n.length;let t=0,r=0;for(let i=0;i<e;i++)t+=n[i].clientX,r+=n[i].clientY;return{clientX:t/e,clientY:r/e}}class uH extends e1{constructor(e){super({stopDown:Cv}),e=e||{},this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const t=e.condition?e.condition:yT(gD,cH);this.condition_=e.onFocusOnly?yT(dD,t):t,this.noKinetic_=!1}handleDragEvent(e){const t=e.map;this.panning_||(this.panning_=!0,t.getView().beginInteraction());const r=this.targetPointers,i=t.getEventPixel(PI(r));if(r.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(i[0],i[1]),this.lastCentroid){const s=[this.lastCentroid[0]-i[0],i[1]-this.lastCentroid[1]],o=e.map.getView();KB(s,o.getResolution()),Yb(s,o.getRotation()),o.adjustCenterInternal(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=i,this.lastPointersCount_=r.length,e.originalEvent.preventDefault()}handleUpEvent(e){const t=e.map,r=t.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const i=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),a=r.getCenterInternal(),o=t.getPixelFromCoordinateInternal(a),l=t.getCoordinateFromPixelInternal([o[0]-i*Math.cos(s),o[1]-i*Math.sin(s)]);r.animateInternal({center:r.getConstrainedCenter(l),duration:500,easing:L0})}return this.panning_&&(this.panning_=!1,r.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(e){if(this.targetPointers.length>0&&this.condition_(e)){const r=e.map.getView();return this.lastCentroid=null,r.getAnimating()&&r.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class hH extends e1{constructor(e){e=e||{},super({stopDown:Cv}),this.condition_=e.condition?e.condition:iH,this.lastAngle_=void 0,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){if(!K2(e))return;const t=e.map,r=t.getView();if(r.getConstraints().rotation===wI)return;const i=t.getSize(),s=e.pixel,a=Math.atan2(i[1]/2-s[1],s[0]-i[0]/2);if(this.lastAngle_!==void 0){const o=a-this.lastAngle_;r.adjustRotationInternal(-o)}this.lastAngle_=a}handleUpEvent(e){return K2(e)?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){return K2(e)&&fD(e)&&this.condition_(e)?(e.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class dH extends Av{constructor(e){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const e=this.startPixel_,t=this.endPixel_,r="px",i=this.element_.style;i.left=Math.min(e[0],t[0])+r,i.top=Math.min(e[1],t[1])+r,i.width=Math.abs(t[0]-e[0])+r,i.height=Math.abs(t[1]-e[1])+r}setMap(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(e,t){this.startPixel_=e,this.endPixel_=t,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const e=this.startPixel_,t=this.endPixel_,i=[e,[e[0],t[1]],t,[t[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);i[4]=i[0].slice(),this.geometry_?this.geometry_.setCoordinates([i]):this.geometry_=new Ia([i])}getGeometry(){return this.geometry_}}const of={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class jg extends el{constructor(e,t,r){super(e),this.coordinate=t,this.mapBrowserEvent=r}}class fH extends e1{constructor(e){super(),this.on,this.once,this.un,e=e??{},this.box_=new dH(e.className||"ol-dragbox"),this.minArea_=e.minArea??64,e.onBoxEnd&&(this.onBoxEnd=e.onBoxEnd),this.startPixel_=null,this.condition_=e.condition??fD,this.boxEndCondition_=e.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(e,t,r){const i=r[0]-t[0],s=r[1]-t[1];return i*i+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(e){this.startPixel_&&(this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new jg(of.BOXDRAG,e.coordinate,e)))}handleUpEvent(e){if(!this.startPixel_)return!1;const t=this.boxEndCondition_(e,this.startPixel_,e.pixel);return t&&this.onBoxEnd(e),this.dispatchEvent(new jg(t?of.BOXEND:of.BOXCANCEL,e.coordinate,e)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(e){return this.condition_(e)?(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new jg(of.BOXSTART,e.coordinate,e)),!0):!1}onBoxEnd(e){}setActive(e){e||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new jg(of.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(e)}setMap(e){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new jg(of.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(e)}}class gH extends fH{constructor(e){e=e||{};const t=e.condition?e.condition:lH;super({condition:t,className:e.className||"ol-dragzoom",minArea:e.minArea}),this.duration_=e.duration!==void 0?e.duration:200,this.out_=e.out!==void 0?e.out:!1}onBoxEnd(e){const r=this.getMap().getView();let i=this.getGeometry();if(this.out_){const s=r.rotatedExtentForGeometry(i),a=r.getResolutionForExtentInternal(s),o=r.getResolution()/a;i=i.clone(),i.scale(o*o)}r.fitInternal(i,{duration:this.duration_,easing:L0})}}const Qu={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class mH extends Jp{constructor(e){super(),e=e||{},this.defaultCondition_=function(t){return gD(t)&&mD(t)},this.condition_=e.condition!==void 0?e.condition:this.defaultCondition_,this.duration_=e.duration!==void 0?e.duration:100,this.pixelDelta_=e.pixelDelta!==void 0?e.pixelDelta:128}handleEvent(e){let t=!1;if(e.type==Yt.KEYDOWN){const r=e.originalEvent,i=r.key;if(this.condition_(e)&&(i==Qu.DOWN||i==Qu.LEFT||i==Qu.RIGHT||i==Qu.UP)){const a=e.map.getView(),o=a.getResolution()*this.pixelDelta_;let l=0,u=0;i==Qu.DOWN?u=-o:i==Qu.LEFT?l=-o:i==Qu.RIGHT?l=o:u=o;const h=[l,u];Yb(h,a.getRotation()),nH(a,h,this.duration_),r.preventDefault(),t=!0}}return!t}}class pH extends Jp{constructor(e){super(),e=e||{},this.condition_=e.condition?e.condition:function(t){return!oH(t)&&mD(t)},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:100}handleEvent(e){let t=!1;if(e.type==Yt.KEYDOWN||e.type==Yt.KEYPRESS){const r=e.originalEvent,i=r.key;if(this.condition_(e)&&(i==="+"||i==="-")){const s=e.map,a=i==="+"?this.delta_:-this.delta_,o=s.getView();CI(o,a,void 0,this.duration_),r.preventDefault(),t=!0}}return!t}}const yH=40,_H=300;class xH extends Jp{constructor(e){e=e||{},super(e),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=e.maxDelta!==void 0?e.maxDelta:1,this.duration_=e.duration!==void 0?e.duration:250,this.timeout_=e.timeout!==void 0?e.timeout:80,this.useAnchor_=e.useAnchor!==void 0?e.useAnchor:!0,this.constrainResolution_=e.constrainResolution!==void 0?e.constrainResolution:!1;const t=e.condition?e.condition:aH;this.condition_=e.onFocusOnly?yT(dD,t):t,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const e=this.getMap();if(!e)return;e.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(e){if(!this.condition_(e)||e.type!==Yt.WHEEL)return!0;const r=e.map,i=e.originalEvent;i.preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.pixel);let s=i.deltaY;switch(i.deltaMode){case WheelEvent.DOM_DELTA_LINE:s*=yH;break;case WheelEvent.DOM_DELTA_PAGE:s*=_H;break}if(s===0)return!1;this.lastDelta_=s;const a=Date.now();this.startTime_===void 0&&(this.startTime_=a),(!this.mode_||a-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?"trackpad":"wheel");const o=r.getView();if(this.mode_==="trackpad"&&!(o.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(o.getAnimating()&&o.cancelAnimations(),o.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),o.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_?r.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=a,!1;this.totalDelta_+=s;const l=Math.max(this.timeout_-(a-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,r),l),!1}handleWheelZoom_(e){const t=e.getView();t.getAnimating()&&t.cancelAnimations();let r=-ar(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(t.getConstrainResolution()||this.constrainResolution_)&&(r=r?r>0?1:-1:0),CI(t,r,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(e){this.useAnchor_=e,e||(this.lastAnchor_=null)}}class vH extends e1{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=Cv),super(t),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=e.threshold!==void 0?e.threshold:.3,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){let t=0;const r=this.targetPointers[0],i=this.targetPointers[1],s=Math.atan2(i.clientY-r.clientY,i.clientX-r.clientX);if(this.lastAngle_!==void 0){const l=s-this.lastAngle_;this.rotationDelta_+=l,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),t=l}this.lastAngle_=s;const a=e.map,o=a.getView();o.getConstraints().rotation!==wI&&(this.anchor_=a.getCoordinateFromPixelInternal(a.getEventPixel(PI(this.targetPointers))),this.rotating_&&(a.render(),o.adjustRotationInternal(t,this.anchor_)))}handleUpEvent(e){return this.targetPointers.length<2?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}class wH extends e1{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=Cv),super(t),this.anchor_=null,this.duration_=e.duration!==void 0?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(e){let t=1;const r=this.targetPointers[0],i=this.targetPointers[1],s=r.clientX-i.clientX,a=r.clientY-i.clientY,o=Math.sqrt(s*s+a*a);this.lastDistance_!==void 0&&(t=this.lastDistance_/o),this.lastDistance_=o;const l=e.map,u=l.getView();t!=1&&(this.lastScaleDelta_=t),this.anchor_=l.getCoordinateFromPixelInternal(l.getEventPixel(PI(this.targetPointers))),l.render(),u.adjustResolutionInternal(t,this.anchor_)}handleUpEvent(e){if(this.targetPointers.length<2){const r=e.map.getView(),i=this.lastScaleDelta_>1?1:-1;return r.endInteraction(this.duration_,i),!1}return!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}function EH(n){n=n||{};const e=new xa,t=new tH(-.005,.05,100);return(n.altShiftDragRotate===void 0||n.altShiftDragRotate)&&e.push(new hH),(n.doubleClickZoom===void 0||n.doubleClickZoom)&&e.push(new rH({delta:n.zoomDelta,duration:n.zoomDuration})),(n.dragPan===void 0||n.dragPan)&&e.push(new uH({onFocusOnly:n.onFocusOnly,kinetic:t})),(n.pinchRotate===void 0||n.pinchRotate)&&e.push(new vH),(n.pinchZoom===void 0||n.pinchZoom)&&e.push(new wH({duration:n.zoomDuration})),(n.keyboard===void 0||n.keyboard)&&(e.push(new mH),e.push(new pH({delta:n.zoomDelta,duration:n.zoomDuration}))),(n.mouseWheelZoom===void 0||n.mouseWheelZoom)&&e.push(new xH({onFocusOnly:n.onFocusOnly,duration:n.zoomDuration})),(n.shiftDragZoom===void 0||n.shiftDragZoom)&&e.push(new gH({duration:n.zoomDuration})),e}class SH extends Av{constructor(e){super(),this.map_=e}dispatchRenderEvent(e,t){Vt()}calculateMatrices2D(e){const t=e.viewState,r=e.coordinateToPixelTransform,i=e.pixelToCoordinateTransform;Ko(r,e.size[0]/2,e.size[1]/2,1/t.resolution,-1/t.resolution,-t.rotation,-t.center[0],-t.center[1]),a5(i,r)}forEachFeatureAtCoordinate(e,t,r,i,s,a,o,l){let u;const h=t.viewState;function f(M,F,z,k){return s.call(a,F,M?z:null,k)}const g=h.projection,y=XO(e.slice(),g),v=[[0,0]];if(g.canWrapX()&&i){const M=g.getExtent(),F=un(M);v.push([-F,0],[F,0])}const x=t.layerStatesArray,E=x.length,T=[],b=[];for(let M=0;M<v.length;M++)for(let F=E-1;F>=0;--F){const z=x[F],k=z.layer;if(k.hasRenderer()&&SI(z,h)&&o.call(l,k)){const C=k.getRenderer(),P=k.getSource();if(C&&P){const L=P.getWrapX()?y:e,O=f.bind(null,z.managed);b[0]=L[0]+v[M][0],b[1]=L[1]+v[M][1],u=C.forEachFeatureAtCoordinate(b,t,r,O,T)}if(u)return u}}if(T.length===0)return;const I=1/T.length;return T.forEach((M,F)=>M.distanceSq+=F*I),T.sort((M,F)=>M.distanceSq-F.distanceSq),T.some(M=>u=M.callback(M.feature,M.layer,M.geometry)),u}hasFeatureAtCoordinate(e,t,r,i,s,a){return this.forEachFeatureAtCoordinate(e,t,r,i,zm,this,s,a)!==void 0}getMap(){return this.map_}renderFrame(e){Vt()}scheduleExpireIconCache(e){wa.canExpireCache()&&e.postRenderFunctions.push(TH)}}function TH(n,e){wa.expire()}class bH extends SH{constructor(e){super(e),this.fontChangeListenerKey_=yn(_f,a0.PROPERTYCHANGE,e.redrawText,e),this.element_=qs?_5():document.createElement("div");const t=this.element_.style;t.position="absolute",t.width="100%",t.height="100%",t.zIndex="0",this.element_.className=Hp+" ol-layers";const r=e.getViewport();r&&r.insertBefore(this.element_,r.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(e,t){const r=this.getMap();if(r.hasListener(e)){const i=new U5(e,void 0,t);r.dispatchEvent(i)}}disposeInternal(){tr(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(e){if(!e){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(e),this.dispatchRenderEvent(va.PRECOMPOSE,e);const t=e.layerStatesArray.sort((u,h)=>u.zIndex-h.zIndex);t.some(u=>u.layer instanceof Q5&&u.layer.getDeclutter())&&(e.declutter={});const i=e.viewState;this.children_.length=0;const s=[];let a=null;for(let u=0,h=t.length;u<h;++u){const f=t[u];e.layerIndex=u;const g=f.layer,y=g.getSourceState();if(!SI(f,i)||y!="ready"&&y!="undefined"){g.unrender();continue}const v=g.render(e,a);v&&(v!==a&&(this.children_.push(v),a=v),s.push(f))}this.declutter(e,s),WU(this.element_,this.children_);const l=this.getMap().getTargetElement();if(Wc(l)){const u=l.getContext("2d");for(const h of this.children_){const f=h.firstElementChild||h,g=h.style.backgroundColor;if(g&&(!Wc(f)||f.width>0)&&(u.fillStyle=g,u.fillRect(0,0,l.width,l.height)),Wc(f)&&f.width>0){const y=h.style.opacity||f.style.opacity;u.globalAlpha=y===""?1:Number(y);const v=f.style.transform;if(v)u.setTransform(...iT(v));else{const x=parseFloat(f.style.width)/f.width,E=parseFloat(f.style.height)/f.height;u.setTransform(x,0,0,E,0,0)}u.drawImage(f,0,0)}}u.globalAlpha=1,u.setTransform(1,0,0,1,0,0)}this.dispatchRenderEvent(va.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}declutter(e,t){if(e.declutter){for(let r=t.length-1;r>=0;--r){const i=t[r],s=i.layer;s.getDeclutter()&&s.renderDeclutter(e,i)}t.forEach(r=>r.layer.renderDeferred(e))}}}function pD(n){if(n instanceof Zp){n.setMapInternal(null);return}n instanceof $v&&n.getLayers().forEach(pD)}function yD(n,e){if(n instanceof Zp){n.setMapInternal(e);return}if(n instanceof $v){const t=n.getLayers().getArray();for(let r=0,i=t.length;r<i;++r)yD(t[r],e)}}let IH=class extends tl{constructor(e){super(),e=e||{},this.on,this.once,this.un;const t=AH(e);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=e.maxTilesLoading!==void 0?e.maxTilesLoading:16,this.pixelRatio_=e.pixelRatio!==void 0?e.pixelRatio:zU,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=Qa(),this.pixelToCoordinateTransform_=Qa(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,qs||(this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_)),this.mapBrowserEventHandler_=null,this.moveTolerance_=e.moveTolerance,this.keyboardEventTarget_=t.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,qs||(this.resizeObserver_=new ResizeObserver(()=>this.updateSize())),this.controls=t.controls||(qs?new xa:eH()),this.interactions=t.interactions||(qs?new xa:EH({onFocusOnly:!0})),this.overlays_=t.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new KW(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(Gi.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(Gi.VIEW,this.handleViewChanged_),this.addChangeListener(Gi.SIZE,this.handleSizeChanged_),this.addChangeListener(Gi.TARGET,this.handleTargetChanged_),this.setProperties(t.values);const r=this;e.view&&!(e.view instanceof Mo)&&e.view.then(function(i){r.setView(new Mo(i))}),this.controls.addEventListener(vs.ADD,i=>{i.element.setMap(this)}),this.controls.addEventListener(vs.REMOVE,i=>{i.element.setMap(null)}),this.interactions.addEventListener(vs.ADD,i=>{i.element.setMap(this)}),this.interactions.addEventListener(vs.REMOVE,i=>{i.element.setMap(null)}),this.overlays_.addEventListener(vs.ADD,i=>{this.addOverlayInternal_(i.element)}),this.overlays_.addEventListener(vs.REMOVE,i=>{const s=i.element.getId();s!==void 0&&delete this.overlayIdIndex_[s.toString()],i.element.setMap(null)}),this.controls.forEach(i=>{i.setMap(this)}),this.interactions.forEach(i=>{i.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(e){this.getControls().push(e)}addInteraction(e){this.getInteractions().push(e)}addLayer(e){this.getLayerGroup().getLayers().push(e)}handleLayerAdd_(e){yD(e.layer,this)}addOverlay(e){this.getOverlays().push(e)}addOverlayInternal_(e){const t=e.getId();t!==void 0&&(this.overlayIdIndex_[t.toString()]=e),e.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_?.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(e,t,r){if(!this.frameState_||!this.renderer_)return;const i=this.getCoordinateFromPixelInternal(e);r=r!==void 0?r:{};const s=r.hitTolerance!==void 0?r.hitTolerance:0,a=r.layerFilter!==void 0?r.layerFilter:zm,o=r.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(i,this.frameState_,s,o,t,null,a,null)}getFeaturesAtPixel(e,t){const r=[];return this.forEachFeatureAtPixel(e,function(i){r.push(i)},t),r}getAllLayers(){const e=[];function t(r){r.forEach(function(i){i instanceof $v?t(i.getLayers()):e.push(i)})}return t(this.getLayers()),e}hasFeatureAtPixel(e,t){if(!this.frameState_||!this.renderer_)return!1;const r=this.getCoordinateFromPixelInternal(e);t=t!==void 0?t:{};const i=t.layerFilter!==void 0?t.layerFilter:zm,s=t.hitTolerance!==void 0?t.hitTolerance:0,a=t.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(r,this.frameState_,s,a,i,null)}getEventCoordinate(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}getEventCoordinateInternal(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}getEventPixel(e){const r=this.viewport_.getBoundingClientRect(),i=this.getSize(),s=r.width/i[0],a=r.height/i[1],o="changedTouches"in e?e.changedTouches[0]:e;return[(o.clientX-r.left)/s,(o.clientY-r.top)/a]}getTarget(){return this.get(Gi.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(e){return rT(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}getCoordinateFromPixelInternal(e){const t=this.frameState_;return t?ti(t.pixelToCoordinateTransform,e.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(e){const t=this.overlayIdIndex_[e.toString()];return t!==void 0?t:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(Gi.LAYERGROUP)}setLayers(e){const t=this.getLayerGroup();if(e instanceof xa){t.setLayers(e);return}const r=t.getLayers();r.clear(),r.extend(e)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const e=this.getLayerGroup().getLayerStatesArray();for(let t=0,r=e.length;t<r;++t){const i=e[t];if(!i.visible)continue;const s=i.layer.getRenderer();if(s&&!s.ready)return!0;const a=i.layer.getSource();if(a&&a.loading)return!0}return!1}getPixelFromCoordinate(e){const t=wl(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(t)}getPixelFromCoordinateInternal(e){const t=this.frameState_;return t?ti(t.coordinateToPixelTransform,e.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(Gi.SIZE)}getView(){return this.get(Gi.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const e=this.getTargetElement();return e?e.ownerDocument:document}getTilePriority(e,t,r,i){return YW(this.frameState_,e,t,r,i)}handleBrowserEvent(e,t){t=t||e.type;const r=new Nc(t,this,e);this.handleMapBrowserEvent(r)}handleMapBrowserEvent(e){if(!this.frameState_)return;const t=e.originalEvent,r=t.type;if(r===pT.POINTERDOWN||r===Yt.WHEEL||r===Yt.KEYDOWN){const i=this.getOwnerDocument(),s=this.viewport_.getRootNode?this.viewport_.getRootNode():i,a=t.target,o=s instanceof ShadowRoot?s.host===a?s.host.ownerDocument:s:s===i?i.documentElement:s;if(this.overlayContainerStopEvent_.contains(a)||!o.contains(a))return}if(e.frameState=this.frameState_,this.dispatchEvent(e)!==!1){const i=this.getInteractions().getArray().slice();for(let s=i.length-1;s>=0;s--){const a=i[s];if(a.getMap()!==this||!a.getActive()||!this.getTargetElement())continue;if(!a.handleEvent(e)||e.propagationStopped)break}}}handlePostRender(){const e=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){let i=this.maxTilesLoading_,s=i;if(e){const a=e.viewHints;if(a[hi.ANIMATING]||a[hi.INTERACTING]){const o=Date.now()-e.time>8;i=o?0:8,s=o?0:2}}t.getTilesLoading()<i&&(t.reprioritize(),t.loadMoreTiles(i,s))}e&&this.renderer_&&!e.animate&&(this.renderComplete_?(this.hasListener(va.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(va.RENDERCOMPLETE,e),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new Ef(Lc.LOADEND,this,e)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new Ef(Lc.LOADSTART,this,e))));const r=this.postRenderFunctions_;if(e)for(let i=0,s=r.length;i<s;++i)r[i](this,e);r.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let r=0,i=this.targetChangeHandlerKeys_.length;r<i;++r)tr(this.targetChangeHandlerKeys_[r]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(Yt.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(Yt.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_&&!Wc(this.targetElement_)){this.resizeObserver_?.unobserve(this.targetElement_);const r=this.targetElement_.getRootNode();r instanceof ShadowRoot&&this.resizeObserver_.unobserve(r.host),this.setSize(void 0)}const e=this.getTarget(),t=typeof e=="string"?document.getElementById(e):e;if(this.targetElement_=t,!t)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{if(Wc(t)||t.appendChild(this.viewport_),this.renderer_||(this.renderer_=new bH(this)),!Wc(t)){this.mapBrowserEventHandler_=new XW(this,this.moveTolerance_);for(const i in Tr)this.mapBrowserEventHandler_.addEventListener(Tr[i],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(Yt.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(Yt.WHEEL,this.boundHandleBrowserEvent_,y5?{passive:!1}:!1);let r;if(this.keyboardEventTarget_)r=this.keyboardEventTarget_;else{const i=t.getRootNode();r=i instanceof ShadowRoot?i.host:t}if(this.targetChangeHandlerKeys_=[yn(r,Yt.KEYDOWN,this.handleBrowserEvent,this),yn(r,Yt.KEYPRESS,this.handleBrowserEvent,this)],t instanceof HTMLElement){const i=t.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.observe(i.host),this.resizeObserver_?.observe(t)}}this.updateSize()}}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(tr(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(tr(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const e=this.getView();e&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=yn(e,a0.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=yn(e,Yt.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(tr),this.layerGroupPropertyListenerKeys_=null);const e=this.getLayerGroup();e&&(this.handleLayerAdd_(new Dc("addlayer",e)),this.layerGroupPropertyListenerKeys_=[yn(e,a0.PROPERTYCHANGE,this.render,this),yn(e,Yt.CHANGE,this.render,this),yn(e,"addlayer",this.handleLayerAdd_,this),yn(e,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;const e=this.frameState_.layerStatesArray;for(let t=0,r=e.length;t<r;++t){const i=e[t].layer;i.hasRenderer()&&i.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(e){return this.getControls().remove(e)}removeInteraction(e){return this.getInteractions().remove(e)}removeLayer(e){return this.getLayerGroup().getLayers().remove(e)}handleLayerRemove_(e){pD(e.layer)}removeOverlay(e){return this.getOverlays().remove(e)}renderFrame_(e){const t=this.getSize(),r=this.getView(),i=this.frameState_;let s=null;if(t!==void 0&&l4(t)&&r&&r.isDef()){const a=r.getHints(this.frameState_?this.frameState_.viewHints:void 0),o=r.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:J_(o.center,o.resolution,o.rotation,t),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:t,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:o,viewHints:a,wantedTiles:{},mapId:bn(this),renderTargets:{}},o.nextCenter&&o.nextResolution){const l=isNaN(o.nextRotation)?o.rotation:o.nextRotation;s.nextExtent=J_(o.nextCenter,o.nextResolution,l,t)}}this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),i&&(!this.previousExtent_||!N0(this.previousExtent_)&&!o0(s.extent,this.previousExtent_))&&(this.dispatchEvent(new Ef(Lc.MOVESTART,this,i)),this.previousExtent_=Bp(this.previousExtent_)),this.previousExtent_&&!s.viewHints[hi.ANIMATING]&&!s.viewHints[hi.INTERACTING]&&!o0(s.extent,this.previousExtent_)&&(this.dispatchEvent(new Ef(Lc.MOVEEND,this,s)),BO(s.extent,this.previousExtent_))),this.dispatchEvent(new Ef(Lc.POSTRENDER,this,s)),this.renderComplete_=(this.hasListener(Lc.LOADSTART)||this.hasListener(Lc.LOADEND)||this.hasListener(va.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(e){const t=this.getLayerGroup();t&&this.handleLayerRemove_(new Dc("removelayer",t)),this.set(Gi.LAYERGROUP,e)}setSize(e){this.set(Gi.SIZE,e)}setTarget(e){this.set(Gi.TARGET,e)}setView(e){if(!e||e instanceof Mo){this.set(Gi.VIEW,e);return}this.set(Gi.VIEW,new Mo);const t=this;e.then(function(r){t.setView(new Mo(r))})}updateSize(){const e=this.getTargetElement();let t;if(e){let i,s;if(Wc(e))i=e.width,s=e.height;else{const a=getComputedStyle(e);i=e.offsetWidth-parseFloat(a.borderLeftWidth)-parseFloat(a.paddingLeft)-parseFloat(a.paddingRight)-parseFloat(a.borderRightWidth),s=e.offsetHeight-parseFloat(a.borderTopWidth)-parseFloat(a.paddingTop)-parseFloat(a.paddingBottom)-parseFloat(a.borderBottomWidth)}!isNaN(i)&&!isNaN(s)&&(t=[Math.max(0,i),Math.max(0,s)],!l4(t)&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&QO("No map visible because the map container's width or height are 0."))}const r=this.getSize();t&&(!r||!Su(t,r))&&(this.setSize(t),this.updateViewportSize_(t))}updateViewportSize_(e){const t=this.getView();t&&t.setViewportSize(e)}};function AH(n){let e=null;n.keyboardEventTarget!==void 0&&(e=typeof n.keyboardEventTarget=="string"?document.getElementById(n.keyboardEventTarget):n.keyboardEventTarget);const t={},r=n.layers&&typeof n.layers.getLayers=="function"?n.layers:new $v({layers:n.layers});t[Gi.LAYERGROUP]=r,t[Gi.TARGET]=n.target,t[Gi.VIEW]=n.view instanceof Mo?n.view:new Mo;let i;n.controls!==void 0&&(Array.isArray(n.controls)?i=new xa(n.controls.slice()):(Dn(typeof n.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),i=n.controls));let s;n.interactions!==void 0&&(Array.isArray(n.interactions)?s=new xa(n.interactions.slice()):(Dn(typeof n.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),s=n.interactions));let a;return n.overlays!==void 0?Array.isArray(n.overlays)?a=new xa(n.overlays.slice()):(Dn(typeof n.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),a=n.overlays):a=new xa,{controls:i,interactions:s,keyboardEventTarget:e,overlays:a,values:t}}const Y2="units",RH=[1,2,5],Vg=25.4/.28;class CH extends Wv{constructor(e){e=e||{};const t=document.createElement("div");t.style.pointerEvents="none",super({element:t,render:e.render,target:e.target}),this.on,this.once,this.un;const r=e.className!==void 0?e.className:e.bar?"ol-scale-bar":"ol-scale-line";this.innerElement_=document.createElement("div"),this.innerElement_.className=r+"-inner",this.element.className=r+" "+Hp,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=e.minWidth!==void 0?e.minWidth:64,this.maxWidth_=e.maxWidth,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",this.addChangeListener(Y2,this.handleUnitsChanged_),this.setUnits(e.units||"metric"),this.scaleBar_=e.bar||!1,this.scaleBarSteps_=e.steps||4,this.scaleBarText_=e.text||!1,this.dpi_=e.dpi||void 0}getUnits(){return this.get(Y2)}handleUnitsChanged_(){this.updateElement_()}setUnits(e){this.set(Y2,e)}setDpi(e){this.dpi_=e}updateElement_(){const e=this.viewState_;if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=e.center,r=e.projection,i=this.getUnits(),s=i=="degrees"?"degrees":"m";let a=sx(r,e.resolution,t,s);const o=this.minWidth_*(this.dpi_||Vg)/Vg,l=this.maxWidth_!==void 0?this.maxWidth_*(this.dpi_||Vg)/Vg:void 0;let u=o*a,h="";if(i=="degrees"){const I=l0.degrees;u*=I,u<I/60?(h="",a*=3600):u<I?(h="",a*=60):h=""}else if(i=="imperial")u<.9144?(h="in",a/=.0254):u<1609.344?(h="ft",a/=.3048):(h="mi",a/=1609.344);else if(i=="nautical")a/=1852,h="NM";else if(i=="metric")u<1e-6?(h="nm",a*=1e9):u<.001?(h="m",a*=1e6):u<1?(h="mm",a*=1e3):u<1e3?h="m":(h="km",a/=1e3);else if(i=="us")u<.9144?(h="in",a*=39.37):u<1609.344?(h="ft",a/=.30480061):(h="mi",a/=1609.3472);else throw new Error("Invalid units");let f=3*Math.floor(Math.log(o*a)/Math.log(10)),g,y,v,x=0,E,T;for(;;){v=Math.floor(f/3);const I=Math.pow(10,v);if(g=RH[(f%3+3)%3]*I,y=Math.round(g/a),isNaN(y)){this.element.style.display="none",this.renderedVisible_=!1;return}if(l!==void 0&&y>=l){g=x,y=E,v=T;break}else if(y>=o)break;x=g,E=y,T=v,++f}const b=this.scaleBar_?this.createScaleBar(y,g,h):g.toFixed(v<0?-v:0)+" "+h;this.renderedHTML_!=b&&(this.innerElement_.innerHTML=b,this.renderedHTML_=b),this.renderedWidth_!=y&&(this.innerElement_.style.width=y+"px",this.renderedWidth_=y),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}createScaleBar(e,t,r){const i=this.getScaleForResolution(),s=i<1?Math.round(1/i).toLocaleString()+" : 1":"1 : "+Math.round(i).toLocaleString(),a=this.scaleBarSteps_,o=e/a,l=[this.createMarker("absolute")];for(let h=0;h<a;++h){const f=h%2===0?"ol-scale-singlebar-odd":"ol-scale-singlebar-even";l.push(`<div><div class="ol-scale-singlebar ${f}" style="width: ${o}px;"></div>`+this.createMarker("relative")+(h%2===0||a===2?this.createStepText(h,e,!1,t,r):"")+"</div>")}return l.push(this.createStepText(a,e,!0,t,r)),(this.scaleBarText_?`<div class="ol-scale-text" style="width: ${e}px;">`+s+"</div>":"")+l.join("")}createMarker(e){return`<div class="ol-scale-step-marker" style="position: ${e}; top: ${e==="absolute"?3:-10}px;"></div>`}createStepText(e,t,r,i,s){const o=(e===0?0:Math.round(i/this.scaleBarSteps_*e*100)/100)+(e===0?"":" "+s),l=e===0?-3:t/this.scaleBarSteps_*-1,u=e===0?0:t/this.scaleBarSteps_*2;return`<div class="ol-scale-step-text" style="margin-left: ${l}px;text-align: ${e===0?"left":"center"};min-width: ${u}px;left: ${r?t+"px":"unset"};">`+o+"</div>"}getScaleForResolution(){const e=sx(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,"m"),t=this.dpi_||Vg,r=1e3/25.4;return e*r*t}render(e){const t=e.frameState;t?this.viewState_=t.viewState:this.viewState_=null,this.updateElement_()}}const PH={},O4=n=>{let e;const t=new Set,r=(h,f)=>{const g=typeof h=="function"?h(e):h;if(!Object.is(g,e)){const y=e;e=f??(typeof g!="object"||g===null)?g:Object.assign({},e,g),t.forEach(v=>v(e,y))}},i=()=>e,l={setState:r,getState:i,getInitialState:()=>u,subscribe:h=>(t.add(h),()=>t.delete(h)),destroy:()=>{(PH?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},u=e=n(r,i,l);return l},kH=n=>n?O4(n):O4;var q2={exports:{}},X2={},Z2={exports:{}},Q2={};var D4;function MH(){if(D4)return Q2;D4=1;var n=Fp();function e(f,g){return f===g&&(f!==0||1/f===1/g)||f!==f&&g!==g}var t=typeof Object.is=="function"?Object.is:e,r=n.useState,i=n.useEffect,s=n.useLayoutEffect,a=n.useDebugValue;function o(f,g){var y=g(),v=r({inst:{value:y,getSnapshot:g}}),x=v[0].inst,E=v[1];return s(function(){x.value=y,x.getSnapshot=g,l(x)&&E({inst:x})},[f,y,g]),i(function(){return l(x)&&E({inst:x}),f(function(){l(x)&&E({inst:x})})},[f]),a(y),y}function l(f){var g=f.getSnapshot;f=f.value;try{var y=g();return!t(f,y)}catch{return!0}}function u(f,g){return g()}var h=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?u:o;return Q2.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:h,Q2}var F4;function NH(){return F4||(F4=1,Z2.exports=MH()),Z2.exports}var j4;function LH(){if(j4)return X2;j4=1;var n=Fp(),e=NH();function t(u,h){return u===h&&(u!==0||1/u===1/h)||u!==u&&h!==h}var r=typeof Object.is=="function"?Object.is:t,i=e.useSyncExternalStore,s=n.useRef,a=n.useEffect,o=n.useMemo,l=n.useDebugValue;return X2.useSyncExternalStoreWithSelector=function(u,h,f,g,y){var v=s(null);if(v.current===null){var x={hasValue:!1,value:null};v.current=x}else x=v.current;v=o(function(){function T(z){if(!b){if(b=!0,I=z,z=g(z),y!==void 0&&x.hasValue){var k=x.value;if(y(k,z))return M=k}return M=z}if(k=M,r(I,z))return k;var C=g(z);return y!==void 0&&y(k,C)?(I=z,k):(I=z,M=C)}var b=!1,I,M,F=f===void 0?null:f;return[function(){return T(h())},F===null?void 0:function(){return T(F())}]},[h,f,g,y]);var E=i(u,v[0],v[1]);return a(function(){x.hasValue=!0,x.value=E},[E]),l(E),E},X2}var V4;function OH(){return V4||(V4=1,q2.exports=LH()),q2.exports}var DH=OH();const FH=Wb(DH),_D={},{useDebugValue:jH}=MB,{useSyncExternalStoreWithSelector:VH}=FH;let G4=!1;const GH=n=>n;function BH(n,e=GH,t){(_D?"production":void 0)!=="production"&&t&&!G4&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),G4=!0);const r=VH(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return jH(r),r}const UH=n=>{(_D?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?kH(n):n,t=(r,i)=>BH(e,r,i);return Object.assign(t,e),t},Ra=n=>UH;var xD=Symbol.for("immer-nothing"),B4=Symbol.for("immer-draftable"),ea=Symbol.for("immer-state");function Ha(n,...e){throw new Error(`[Immer] minified error nr: ${n}. Full error at: https://bit.ly/3cXEKWf`)}var tp=Object.getPrototypeOf;function d0(n){return!!n&&!!n[ea]}function Gh(n){return n?vD(n)||Array.isArray(n)||!!n[B4]||!!n.constructor?.[B4]||t1(n)||Kv(n):!1}var zH=Object.prototype.constructor.toString(),U4=new WeakMap;function vD(n){if(!n||typeof n!="object")return!1;const e=Object.getPrototypeOf(n);if(e===null||e===Object.prototype)return!0;const t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(t===Object)return!0;if(typeof t!="function")return!1;let r=U4.get(t);return r===void 0&&(r=Function.toString.call(t),U4.set(t,r)),r===zH}function yx(n,e,t=!0){Hv(n)===0?(t?Reflect.ownKeys(n):Object.keys(n)).forEach(i=>{e(i,n[i],n)}):n.forEach((r,i)=>e(i,r,n))}function Hv(n){const e=n[ea];return e?e.type_:Array.isArray(n)?1:t1(n)?2:Kv(n)?3:0}function _T(n,e){return Hv(n)===2?n.has(e):Object.prototype.hasOwnProperty.call(n,e)}function wD(n,e,t){const r=Hv(n);r===2?n.set(e,t):r===3?n.add(t):n[e]=t}function $H(n,e){return n===e?n!==0||1/n===1/e:n!==n&&e!==e}function t1(n){return n instanceof Map}function Kv(n){return n instanceof Set}function rh(n){return n.copy_||n.base_}function xT(n,e){if(t1(n))return new Map(n);if(Kv(n))return new Set(n);if(Array.isArray(n))return Array.prototype.slice.call(n);const t=vD(n);if(e===!0||e==="class_only"&&!t){const r=Object.getOwnPropertyDescriptors(n);delete r[ea];let i=Reflect.ownKeys(r);for(let s=0;s<i.length;s++){const a=i[s],o=r[a];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(r[a]={configurable:!0,writable:!0,enumerable:o.enumerable,value:n[a]})}return Object.create(tp(n),r)}else{const r=tp(n);if(r!==null&&t)return{...n};const i=Object.create(r);return Object.assign(i,n)}}function kI(n,e=!1){return Yv(n)||d0(n)||!Gh(n)||(Hv(n)>1&&Object.defineProperties(n,{set:qy,add:qy,clear:qy,delete:qy}),Object.freeze(n),e&&Object.values(n).forEach(t=>kI(t,!0))),n}function WH(){Ha(2)}var qy={value:WH};function Yv(n){return n===null||typeof n!="object"?!0:Object.isFrozen(n)}var HH={};function Bh(n){const e=HH[n];return e||Ha(0,n),e}var np;function ED(){return np}function KH(n,e){return{drafts_:[],parent_:n,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function z4(n,e){e&&(Bh("Patches"),n.patches_=[],n.inversePatches_=[],n.patchListener_=e)}function vT(n){wT(n),n.drafts_.forEach(YH),n.drafts_=null}function wT(n){n===np&&(np=n.parent_)}function $4(n){return np=KH(np,n)}function YH(n){const e=n[ea];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function W4(n,e){e.unfinalizedDrafts_=e.drafts_.length;const t=e.drafts_[0];return n!==void 0&&n!==t?(t[ea].modified_&&(vT(e),Ha(4)),Gh(n)&&(n=_x(e,n),e.parent_||xx(e,n)),e.patches_&&Bh("Patches").generateReplacementPatches_(t[ea].base_,n,e.patches_,e.inversePatches_)):n=_x(e,t,[]),vT(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),n!==xD?n:void 0}function _x(n,e,t){if(Yv(e))return e;const r=n.immer_.shouldUseStrictIteration(),i=e[ea];if(!i)return yx(e,(s,a)=>H4(n,i,e,s,a,t),r),e;if(i.scope_!==n)return e;if(!i.modified_)return xx(n,i.base_,!0),i.base_;if(!i.finalized_){i.finalized_=!0,i.scope_.unfinalizedDrafts_--;const s=i.copy_;let a=s,o=!1;i.type_===3&&(a=new Set(s),s.clear(),o=!0),yx(a,(l,u)=>H4(n,i,s,l,u,t,o),r),xx(n,s,!1),t&&n.patches_&&Bh("Patches").generatePatches_(i,t,n.patches_,n.inversePatches_)}return i.copy_}function H4(n,e,t,r,i,s,a){if(i==null||typeof i!="object"&&!a)return;const o=Yv(i);if(!(o&&!a)){if(d0(i)){const l=s&&e&&e.type_!==3&&!_T(e.assigned_,r)?s.concat(r):void 0,u=_x(n,i,l);if(wD(t,r,u),d0(u))n.canAutoFreeze_=!1;else return}else a&&t.add(i);if(Gh(i)&&!o){if(!n.immer_.autoFreeze_&&n.unfinalizedDrafts_<1||e&&e.base_&&e.base_[r]===i&&o)return;_x(n,i),(!e||!e.scope_.parent_)&&typeof r!="symbol"&&(t1(t)?t.has(r):Object.prototype.propertyIsEnumerable.call(t,r))&&xx(n,i)}}}function xx(n,e,t=!1){!n.parent_&&n.immer_.autoFreeze_&&n.canAutoFreeze_&&kI(e,t)}function qH(n,e){const t=Array.isArray(n),r={type_:t?1:0,scope_:e?e.scope_:ED(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:n,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=r,s=MI;t&&(i=[r],s=rp);const{revoke:a,proxy:o}=Proxy.revocable(i,s);return r.draft_=o,r.revoke_=a,o}var MI={get(n,e){if(e===ea)return n;const t=rh(n);if(!_T(t,e))return XH(n,t,e);const r=t[e];return n.finalized_||!Gh(r)?r:r===J2(n.base_,e)?(eS(n),n.copy_[e]=ST(r,n)):r},has(n,e){return e in rh(n)},ownKeys(n){return Reflect.ownKeys(rh(n))},set(n,e,t){const r=SD(rh(n),e);if(r?.set)return r.set.call(n.draft_,t),!0;if(!n.modified_){const i=J2(rh(n),e),s=i?.[ea];if(s&&s.base_===t)return n.copy_[e]=t,n.assigned_[e]=!1,!0;if($H(t,i)&&(t!==void 0||_T(n.base_,e)))return!0;eS(n),ET(n)}return n.copy_[e]===t&&(t!==void 0||e in n.copy_)||Number.isNaN(t)&&Number.isNaN(n.copy_[e])||(n.copy_[e]=t,n.assigned_[e]=!0),!0},deleteProperty(n,e){return J2(n.base_,e)!==void 0||e in n.base_?(n.assigned_[e]=!1,eS(n),ET(n)):delete n.assigned_[e],n.copy_&&delete n.copy_[e],!0},getOwnPropertyDescriptor(n,e){const t=rh(n),r=Reflect.getOwnPropertyDescriptor(t,e);return r&&{writable:!0,configurable:n.type_!==1||e!=="length",enumerable:r.enumerable,value:t[e]}},defineProperty(){Ha(11)},getPrototypeOf(n){return tp(n.base_)},setPrototypeOf(){Ha(12)}},rp={};yx(MI,(n,e)=>{rp[n]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});rp.deleteProperty=function(n,e){return rp.set.call(this,n,e,void 0)};rp.set=function(n,e,t){return MI.set.call(this,n[0],e,t,n[0])};function J2(n,e){const t=n[ea];return(t?rh(t):n)[e]}function XH(n,e,t){const r=SD(e,t);return r?"value"in r?r.value:r.get?.call(n.draft_):void 0}function SD(n,e){if(!(e in n))return;let t=tp(n);for(;t;){const r=Object.getOwnPropertyDescriptor(t,e);if(r)return r;t=tp(t)}}function ET(n){n.modified_||(n.modified_=!0,n.parent_&&ET(n.parent_))}function eS(n){n.copy_||(n.copy_=xT(n.base_,n.scope_.immer_.useStrictShallowCopy_))}var ZH=class{constructor(n){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,t,r)=>{if(typeof e=="function"&&typeof t!="function"){const s=t;t=e;const a=this;return function(l=s,...u){return a.produce(l,h=>t.call(this,h,...u))}}typeof t!="function"&&Ha(6),r!==void 0&&typeof r!="function"&&Ha(7);let i;if(Gh(e)){const s=$4(this),a=ST(e,void 0);let o=!0;try{i=t(a),o=!1}finally{o?vT(s):wT(s)}return z4(s,r),W4(i,s)}else if(!e||typeof e!="object"){if(i=t(e),i===void 0&&(i=e),i===xD&&(i=void 0),this.autoFreeze_&&kI(i,!0),r){const s=[],a=[];Bh("Patches").generateReplacementPatches_(e,i,s,a),r(s,a)}return i}else Ha(1,e)},this.produceWithPatches=(e,t)=>{if(typeof e=="function")return(a,...o)=>this.produceWithPatches(a,l=>e(l,...o));let r,i;return[this.produce(e,t,(a,o)=>{r=a,i=o}),r,i]},typeof n?.autoFreeze=="boolean"&&this.setAutoFreeze(n.autoFreeze),typeof n?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(n.useStrictShallowCopy),typeof n?.useStrictIteration=="boolean"&&this.setUseStrictIteration(n.useStrictIteration)}createDraft(n){Gh(n)||Ha(8),d0(n)&&(n=QH(n));const e=$4(this),t=ST(n,void 0);return t[ea].isManual_=!0,wT(e),t}finishDraft(n,e){const t=n&&n[ea];(!t||!t.isManual_)&&Ha(9);const{scope_:r}=t;return z4(r,e),W4(void 0,r)}setAutoFreeze(n){this.autoFreeze_=n}setUseStrictShallowCopy(n){this.useStrictShallowCopy_=n}setUseStrictIteration(n){this.useStrictIteration_=n}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(n,e){let t;for(t=e.length-1;t>=0;t--){const i=e[t];if(i.path.length===0&&i.op==="replace"){n=i.value;break}}t>-1&&(e=e.slice(t+1));const r=Bh("Patches").applyPatches_;return d0(n)?r(n,e):this.produce(n,i=>r(i,e))}};function ST(n,e){const t=t1(n)?Bh("MapSet").proxyMap_(n,e):Kv(n)?Bh("MapSet").proxySet_(n,e):qH(n,e);return(e?e.scope_:ED()).drafts_.push(t),t}function QH(n){return d0(n)||Ha(10,n),TD(n)}function TD(n){if(!Gh(n)||Yv(n))return n;const e=n[ea];let t,r=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,t=xT(n,e.scope_.immer_.useStrictShallowCopy_),r=e.scope_.immer_.shouldUseStrictIteration()}else t=xT(n,!0);return yx(t,(i,s)=>{wD(t,i,TD(s))},r),e&&(e.finalized_=!1),t}var JH=new ZH,eK=JH.produce;const tK=n=>(e,t,r)=>(r.setState=(i,s,...a)=>{const o=typeof i=="function"?eK(i):i;return e(o,s,...a)},n(r.setState,t,r)),O0=tK,is=Ra()(O0((n,e)=>({tracking:!1,position:null,heading:null,smoothHeading:null,accuracy:null,speed:null,headingSource:null,watchId:null,firstFix:!0,config:{smoothingFactor:.2,minRotationSpeed:8,centerOnUser:!0,animationDuration:100},startTracking:()=>{n(t=>{t.tracking=!0})},stopTracking:()=>{n(t=>{const{watchId:r}=e();r!==null&&navigator.geolocation.clearWatch(r),t.tracking=!1,t.speed=null,t.headingSource=null,t.watchId=null})},updatePosition:t=>{n(r=>{r.position={lat:t.coords.latitude,lng:t.coords.longitude},r.accuracy=t.coords.accuracy,r.speed=t.coords.speed;const i=15,s=.5;if(!(t.coords.accuracy!==null&&t.coords.accuracy<i)){r.headingSource=null;return}if(t.coords.heading!==null&&t.coords.speed!==null&&t.coords.speed>s){r.headingSource="gps";const o=t.coords.heading;e().updateHeading(o,"gps")}else r.headingSource="compass"})},updateHeading:(t,r="compass")=>{n(i=>{const{smoothHeading:s,config:a}=e();if(s===null){i.smoothHeading=t,i.heading=t;return}let o=t-s;o>180&&(o-=360),o<-180&&(o+=360);const l=r==="compass"?5:3;if(Math.abs(o)<l)return;const h=s+o*(r==="gps"?.5:.35);i.smoothHeading=(h+360)%360,i.heading=t})},setSmoothedHeading:t=>{n(r=>{r.smoothHeading=t,r.heading=t})},setWatchId:t=>{n(r=>{r.watchId=t})},resetFirstFix:()=>{n(t=>{t.firstFix=!1})}}))),qv={"TMK 1850":{name:"TMK 1850",factory:async()=>null,immediateLoad:!0,tier:"premium"},"Bonnebladen 1900":{name:"Bonnebladen 1900",factory:async()=>null,immediateLoad:!0,tier:"premium"},"AHN 0.5m":{name:"AHN 0.5m",factory:async()=>{const{createAHNLayerOL:n}=await mt(async()=>{const{createAHNLayerOL:e}=await import("./pdokWMSLayers-5yZF2pIX.js");return{createAHNLayerOL:e}},[]);return n()},immediateLoad:!0},Geomorfologie:{name:"Geomorfologie",factory:async()=>{const{createGeomorfologieLayerOL:n}=await mt(async()=>{const{createGeomorfologieLayerOL:e}=await import("./pdokWMSLayers-5yZF2pIX.js");return{createGeomorfologieLayerOL:e}},[]);return n()},immediateLoad:!0},Bodemkaart:{name:"Bodemkaart",factory:async()=>{const{createBodemkaartLayerOL:n}=await mt(async()=>{const{createBodemkaartLayerOL:e}=await import("./pdokWMSLayers-5yZF2pIX.js");return{createBodemkaartLayerOL:e}},[]);return n()},immediateLoad:!0},IKAW:{name:"IKAW",factory:async()=>{const{createIKAWLayerOL:n}=await mt(async()=>{const{createIKAWLayerOL:e}=await import("./pdokWMSLayers-5yZF2pIX.js");return{createIKAWLayerOL:e}},[]);return n()},immediateLoad:!0},"FAMKE Steentijd":{name:"FAMKE Steentijd",factory:async()=>{const{createFAMKESteentijdLayerOL:n}=await mt(async()=>{const{createFAMKESteentijdLayerOL:e}=await import("./pdokWMSLayers-5yZF2pIX.js");return{createFAMKESteentijdLayerOL:e}},[]);return n()},immediateLoad:!0},"Archeo Landschappen":{name:"Archeo Landschappen",factory:async()=>{const{createArcheoLandschappenLayerOL:n}=await mt(async()=>{const{createArcheoLandschappenLayerOL:e}=await import("./pdokWMSLayers-5yZF2pIX.js");return{createArcheoLandschappenLayerOL:e}},[]);return n()},immediateLoad:!0},Essen:{name:"Essen",factory:async()=>{const{createEssenLayerOL:n}=await mt(async()=>{const{createEssenLayerOL:e}=await import("./pdokWMSLayers-5yZF2pIX.js");return{createEssenLayerOL:e}},[]);return n()},immediateLoad:!0},Rijksmonumenten:{name:"Rijksmonumenten",factory:async()=>{const{createRijksmonumentenLayerOL:n}=await mt(async()=>{const{createRijksmonumentenLayerOL:e}=await import("./pdokWMSLayers-5yZF2pIX.js");return{createRijksmonumentenLayerOL:e}},[]);return n()},immediateLoad:!0},"Archeo Onderzoeken":{name:"Archeo Onderzoeken",factory:async()=>{const{createArcheoOnderzoekenLayerOL:n}=await mt(async()=>{const{createArcheoOnderzoekenLayerOL:e}=await import("./pdokWMSLayers-5yZF2pIX.js");return{createArcheoOnderzoekenLayerOL:e}},[]);return n()},immediateLoad:!0},Werelderfgoed:{name:"Werelderfgoed",factory:async()=>{const{createWerelderfgoedLayerOL:n}=await mt(async()=>{const{createWerelderfgoedLayerOL:e}=await import("./pdokWMSLayers-5yZF2pIX.js");return{createWerelderfgoedLayerOL:e}},[]);return n()},immediateLoad:!0},Terpen:{name:"Terpen",factory:async()=>{const{createTerpenLayerOL:n}=await mt(async()=>{const{createTerpenLayerOL:e}=await import("./terpenOL-CTwkCvMI.js");return{createTerpenLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},Verdedigingslinies:{name:"Verdedigingslinies",factory:async()=>{const{createLiniesLayerOL:n}=await mt(async()=>{const{createLiniesLayerOL:e}=await import("./verdedigingswerkenOL-BpcUHiqU.js");return{createLiniesLayerOL:e}},[]);return n()},immediateLoad:!0},Inundatiegebieden:{name:"Inundatiegebieden",factory:async()=>{const{createInundatiesLayerOL:n}=await mt(async()=>{const{createInundatiesLayerOL:e}=await import("./verdedigingswerkenOL-BpcUHiqU.js");return{createInundatiesLayerOL:e}},[]);return n()},immediateLoad:!0},"Militaire Objecten":{name:"Militaire Objecten",factory:async()=>{const{createMilitaireObjectenLayerOL:n}=await mt(async()=>{const{createMilitaireObjectenLayerOL:e}=await import("./verdedigingswerkenOL-BpcUHiqU.js");return{createMilitaireObjectenLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 800 n.Chr.":{name:"Paleokaart 800 n.Chr.",factory:async()=>{const{createPaleo800ncLayerOL:n}=await mt(async()=>{const{createPaleo800ncLayerOL:e}=await import("./paleokaartOL-B6dYqU8O.js");return{createPaleo800ncLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 100 n.Chr.":{name:"Paleokaart 100 n.Chr.",factory:async()=>{const{createPaleo100ncLayerOL:n}=await mt(async()=>{const{createPaleo100ncLayerOL:e}=await import("./paleokaartOL-B6dYqU8O.js");return{createPaleo100ncLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 500 v.Chr.":{name:"Paleokaart 500 v.Chr.",factory:async()=>{const{createPaleo500vcLayerOL:n}=await mt(async()=>{const{createPaleo500vcLayerOL:e}=await import("./paleokaartOL-B6dYqU8O.js");return{createPaleo500vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 1500 v.Chr.":{name:"Paleokaart 1500 v.Chr.",factory:async()=>{const{createPaleo1500vcLayerOL:n}=await mt(async()=>{const{createPaleo1500vcLayerOL:e}=await import("./paleokaartOL-B6dYqU8O.js");return{createPaleo1500vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 2750 v.Chr.":{name:"Paleokaart 2750 v.Chr.",factory:async()=>{const{createPaleo2750vcLayerOL:n}=await mt(async()=>{const{createPaleo2750vcLayerOL:e}=await import("./paleokaartOL-B6dYqU8O.js");return{createPaleo2750vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 5500 v.Chr.":{name:"Paleokaart 5500 v.Chr.",factory:async()=>{const{createPaleo5500vcLayerOL:n}=await mt(async()=>{const{createPaleo5500vcLayerOL:e}=await import("./paleokaartOL-B6dYqU8O.js");return{createPaleo5500vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 9000 v.Chr.":{name:"Paleokaart 9000 v.Chr.",factory:async()=>{const{createPaleo9000vcLayerOL:n}=await mt(async()=>{const{createPaleo9000vcLayerOL:e}=await import("./paleokaartOL-B6dYqU8O.js");return{createPaleo9000vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Religieus Erfgoed":{name:"Religieus Erfgoed",factory:async()=>{const{createReligieusErfgoedLayerOL:n}=await mt(async()=>{const{createReligieusErfgoedLayerOL:e}=await import("./religieusErfgoedOL-CFenHJmB.js");return{createReligieusErfgoedLayerOL:e}},[]);return n()},immediateLoad:!0},"AHN4 Hoogtekaart Kleur":{name:"AHN4 Hoogtekaart Kleur",factory:async()=>{const{createAHN4ColorElevationLayerOL:n}=await mt(async()=>{const{createAHN4ColorElevationLayerOL:e}=await import("./hillshadeLayers-BaStVGeo.js");return{createAHN4ColorElevationLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},"AHN4 Hillshade NL":{name:"AHN4 Hillshade NL",factory:async()=>{const{createAHN4HillshadeLayerOL:n}=await mt(async()=>{const{createAHN4HillshadeLayerOL:e}=await import("./hillshadeLayers-BaStVGeo.js");return{createAHN4HillshadeLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},"AHN4 Multi-Hillshade NL":{name:"AHN4 Multi-Hillshade NL",factory:async()=>{const{createAHN4MultiHillshadeLayerOL:n}=await mt(async()=>{const{createAHN4MultiHillshadeLayerOL:e}=await import("./hillshadeLayers-BaStVGeo.js");return{createAHN4MultiHillshadeLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},Gewaspercelen:{name:"Gewaspercelen",factory:async()=>{const{createGewaspercelenLayerOL:n}=await mt(async()=>{const{createGewaspercelenLayerOL:e}=await import("./pdokWMSLayers-5yZF2pIX.js");return{createGewaspercelenLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},"Kadastrale Grenzen":{name:"Kadastrale Grenzen",factory:async()=>{const{createKadastraleKaartLayerOL:n}=await mt(async()=>{const{createKadastraleKaartLayerOL:e}=await import("./pdokWMSLayers-5yZF2pIX.js");return{createKadastraleKaartLayerOL:e}},[]);return n()},immediateLoad:!0},Scheepswrakken:{name:"Scheepswrakken",factory:async()=>{const{createScheepswrakkenLayerOL:n}=await mt(async()=>{const{createScheepswrakkenLayerOL:e}=await import("./pdokWMSLayers-5yZF2pIX.js");return{createScheepswrakkenLayerOL:e}},[]);return n()},immediateLoad:!0},"Woonheuvels ZH":{name:"Woonheuvels ZH",factory:async()=>{const{createWoonheuvelsLayerOL:n}=await mt(async()=>{const{createWoonheuvelsLayerOL:e}=await import("./pdokWMSLayers-5yZF2pIX.js");return{createWoonheuvelsLayerOL:e}},[]);return n()},immediateLoad:!0},"Romeinse Forten":{name:"Romeinse Forten",factory:async()=>{const{createRomeinseFortenLayerOL:n}=await mt(async()=>{const{createRomeinseFortenLayerOL:e}=await import("./romeinseFortenOL-r2i3bfYV.js");return{createRomeinseFortenLayerOL:e}},__vite__mapDeps([0,1]));return n()},immediateLoad:!1},"Romeinse Forten Lijnen":{name:"Romeinse Forten Lijnen",factory:async()=>{const{createRomeinseFortenLijnenLayerOL:n}=await mt(async()=>{const{createRomeinseFortenLijnenLayerOL:e}=await import("./romeinseFortenOL-r2i3bfYV.js");return{createRomeinseFortenLijnenLayerOL:e}},__vite__mapDeps([0,1]));return n()},immediateLoad:!1},Windmolens:{name:"Windmolens",factory:async()=>{const{createWindmolensLayerOL:n}=await mt(async()=>{const{createWindmolensLayerOL:e}=await import("./pdokWMSLayers-5yZF2pIX.js");return{createWindmolensLayerOL:e}},[]);return n()},immediateLoad:!0},Erfgoedlijnen:{name:"Erfgoedlijnen",factory:async()=>{const{createErfgoedlijnenLayerOL:n}=await mt(async()=>{const{createErfgoedlijnenLayerOL:e}=await import("./pdokWMSLayers-5yZF2pIX.js");return{createErfgoedlijnenLayerOL:e}},[]);return n()},immediateLoad:!0},"Oude Kernen":{name:"Oude Kernen",factory:async()=>{const{createOudeKernenLayerOL:n}=await mt(async()=>{const{createOudeKernenLayerOL:e}=await import("./pdokWMSLayers-5yZF2pIX.js");return{createOudeKernenLayerOL:e}},[]);return n()},immediateLoad:!0},"Relictenkaart Punten":{name:"Relictenkaart Punten",factory:async()=>{const{createRelictenkaartPuntenLayerOL:n}=await mt(async()=>{const{createRelictenkaartPuntenLayerOL:e}=await import("./pdokWMSLayers-5yZF2pIX.js");return{createRelictenkaartPuntenLayerOL:e}},[]);return n()},immediateLoad:!0},"Relictenkaart Lijnen":{name:"Relictenkaart Lijnen",factory:async()=>{const{createRelictenkaartLijnenLayerOL:n}=await mt(async()=>{const{createRelictenkaartLijnenLayerOL:e}=await import("./pdokWMSLayers-5yZF2pIX.js");return{createRelictenkaartLijnenLayerOL:e}},[]);return n()},immediateLoad:!0},"Relictenkaart Vlakken":{name:"Relictenkaart Vlakken",factory:async()=>{const{createRelictenkaartVlakkenLayerOL:n}=await mt(async()=>{const{createRelictenkaartVlakkenLayerOL:e}=await import("./pdokWMSLayers-5yZF2pIX.js");return{createRelictenkaartVlakkenLayerOL:e}},[]);return n()},immediateLoad:!0},"Verdronken Dorpen":{name:"Verdronken Dorpen",factory:async()=>{const{createVerdronkenDorpenLayerOL:n}=await mt(async()=>{const{createVerdronkenDorpenLayerOL:e}=await import("./pdokWMSLayers-5yZF2pIX.js");return{createVerdronkenDorpenLayerOL:e}},[]);return n()},immediateLoad:!0},"AMK Monumenten":{name:"AMK Monumenten",factory:async()=>{const{createAMKLayerOL:n}=await mt(async()=>{const{createAMKLayerOL:e}=await import("./amkOL-CZqz_adf.js");return{createAMKLayerOL:e}},__vite__mapDeps([2,3]));return n()},immediateLoad:!1,tier:"premium"},"AMK Romeins":{name:"AMK Romeins",factory:async()=>{const{createAMKRomeinsLayerOL:n}=await mt(async()=>{const{createAMKRomeinsLayerOL:e}=await import("./amkOL-CZqz_adf.js");return{createAMKRomeinsLayerOL:e}},__vite__mapDeps([2,3]));return n()},immediateLoad:!1,tier:"premium"},"AMK Steentijd":{name:"AMK Steentijd",factory:async()=>{const{createAMKSteentijdLayerOL:n}=await mt(async()=>{const{createAMKSteentijdLayerOL:e}=await import("./amkOL-CZqz_adf.js");return{createAMKSteentijdLayerOL:e}},__vite__mapDeps([2,3]));return n()},immediateLoad:!1,tier:"premium"},"AMK Vroege ME":{name:"AMK Vroege ME",factory:async()=>{const{createAMKVroegeMELayerOL:n}=await mt(async()=>{const{createAMKVroegeMELayerOL:e}=await import("./amkOL-CZqz_adf.js");return{createAMKVroegeMELayerOL:e}},__vite__mapDeps([2,3]));return n()},immediateLoad:!1,tier:"premium"},"AMK Late ME":{name:"AMK Late ME",factory:async()=>{const{createAMKLateMELayerOL:n}=await mt(async()=>{const{createAMKLateMELayerOL:e}=await import("./amkOL-CZqz_adf.js");return{createAMKLateMELayerOL:e}},__vite__mapDeps([2,3]));return n()},immediateLoad:!1,tier:"premium"},"AMK Overig":{name:"AMK Overig",factory:async()=>{const{createAMKOverigLayerOL:n}=await mt(async()=>{const{createAMKOverigLayerOL:e}=await import("./amkOL-CZqz_adf.js");return{createAMKOverigLayerOL:e}},__vite__mapDeps([2,3]));return n()},immediateLoad:!1,tier:"premium"},"Romeinse wegen (regio)":{name:"Romeinse wegen (regio)",factory:async()=>{const{createRomeinseWegenLayerOL:n}=await mt(async()=>{const{createRomeinseWegenLayerOL:e}=await import("./romeinsOL-D7dIAnPs.js");return{createRomeinseWegenLayerOL:e}},__vite__mapDeps([4,3]));return n()},immediateLoad:!1},"Romeinse wegen (Wereld)":{name:"Romeinse wegen (Wereld)",factory:async()=>{const{createRomeinseWegenWereldLayerOL:n}=await mt(async()=>{const{createRomeinseWegenWereldLayerOL:e}=await import("./romeinsOL-D7dIAnPs.js");return{createRomeinseWegenWereldLayerOL:e}},__vite__mapDeps([4,3]));return n()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},Kastelen:{name:"Kastelen",factory:async()=>{const{createKastelenLayerOL:n}=await mt(async()=>{const{createKastelenLayerOL:e}=await import("./kastelenOL-Bkn_j31w.js");return{createKastelenLayerOL:e}},__vite__mapDeps([5,1]));return n()},immediateLoad:!1},Runes:{name:"Runes",factory:async()=>{const{createRuinesLayerOL:n}=await mt(async()=>{const{createRuinesLayerOL:e}=await import("./ruinesOL-DIgzFkLW.js");return{createRuinesLayerOL:e}},__vite__mapDeps([6,1]));return n()},immediateLoad:!1},Veengebieden:{name:"Veengebieden",factory:async()=>{const{createVeengebiedenLayerOL:n}=await mt(async()=>{const{createVeengebiedenLayerOL:e}=await import("./veengebiedenOL-ChkJqrz8.js");return{createVeengebiedenLayerOL:e}},[]);return n()},immediateLoad:!1},Hunebedden:{name:"Hunebedden",factory:async()=>{const{createHunebeddenLayerOL:n}=await mt(async()=>{const{createHunebeddenLayerOL:e}=await import("./hunebeddenOL-T_w88NNH.js");return{createHunebeddenLayerOL:e}},__vite__mapDeps([7,1]));return n()},immediateLoad:!1},"UIKAV Punten":{name:"UIKAV Punten",factory:async()=>{const{createUIKAVArcheoPuntenLayerOL:n}=await mt(async()=>{const{createUIKAVArcheoPuntenLayerOL:e}=await import("./uikavArcheoPuntenOL-CO8fZSOp.js");return{createUIKAVArcheoPuntenLayerOL:e}},__vite__mapDeps([8,3,1]));return n()},immediateLoad:!1,tier:"premium"},"UIKAV Vlakken":{name:"UIKAV Vlakken",factory:async()=>{const{createUIKAVVlakkenLayerOL:n}=await mt(async()=>{const{createUIKAVVlakkenLayerOL:e}=await import("./uikavVlakkenOL-DBGkps92.js");return{createUIKAVVlakkenLayerOL:e}},__vite__mapDeps([9,3]));return n()},immediateLoad:!1},"UIKAV Buffer":{name:"UIKAV Buffer",factory:async()=>{const{createUIKAVBufferlaagLayerOL:n}=await mt(async()=>{const{createUIKAVBufferlaagLayerOL:e}=await import("./uikavBufferlaagOL-CHbtwKla.js");return{createUIKAVBufferlaagLayerOL:e}},__vite__mapDeps([10,3]));return n()},immediateLoad:!1},"UIKAV Expert":{name:"UIKAV Expert",factory:async()=>{const{createUIKAVExpertLayerOL:n}=await mt(async()=>{const{createUIKAVExpertLayerOL:e}=await import("./uikavExpertOL-D138lIij.js");return{createUIKAVExpertLayerOL:e}},__vite__mapDeps([11,3]));return n()},immediateLoad:!1},"UIKAV Indeling":{name:"UIKAV Indeling",factory:async()=>{const{createUIKAVUiterwaardenLayerOL:n}=await mt(async()=>{const{createUIKAVUiterwaardenLayerOL:e}=await import("./uikavUiterwaardenOL-B-m2QBUk.js");return{createUIKAVUiterwaardenLayerOL:e}},__vite__mapDeps([12,3]));return n()},immediateLoad:!1},Speeltuinen:{name:"Speeltuinen",factory:async()=>{const{createSpeeltuinenLayerOL:n}=await mt(async()=>{const{createSpeeltuinenLayerOL:e}=await import("./speeltuinenOL-0MawOUu-.js");return{createSpeeltuinenLayerOL:e}},__vite__mapDeps([13,3,1]));return n()},immediateLoad:!1},Musea:{name:"Musea",factory:async()=>{const{createMuseaLayerOL:n}=await mt(async()=>{const{createMuseaLayerOL:e}=await import("./museaOL-Dv_T35vo.js");return{createMuseaLayerOL:e}},__vite__mapDeps([14,3,1]));return n()},immediateLoad:!1},Strandjes:{name:"Strandjes",factory:async()=>{const{createStrandjesLayerOL:n}=await mt(async()=>{const{createStrandjesLayerOL:e}=await import("./strandjesOL-D2y5PksW.js");return{createStrandjesLayerOL:e}},__vite__mapDeps([15,3]));return n()},immediateLoad:!1},Parken:{name:"Parken",factory:async()=>{const{createParkenLayerOL:n}=await mt(async()=>{const{createParkenLayerOL:e}=await import("./parkenOL-DazVuPyW.js");return{createParkenLayerOL:e}},__vite__mapDeps([16,3]));return n()},immediateLoad:!1},Kringloopwinkels:{name:"Kringloopwinkels",factory:async()=>{const{createKringloopwinkelsLayerOL:n}=await mt(async()=>{const{createKringloopwinkelsLayerOL:e}=await import("./kringloopwinkelsOL-BwCnEo0k.js");return{createKringloopwinkelsLayerOL:e}},__vite__mapDeps([17,1]));return n()},immediateLoad:!1},"Fossielen Nederland":{name:"Fossielen Nederland",factory:async()=>{const{createFossielenLayerOL:n}=await mt(async()=>{const{createFossielenLayerOL:e}=await import("./fossielenOL-pSI3Yh7S.js");return{createFossielenLayerOL:e}},__vite__mapDeps([18,19,1]));return n()},immediateLoad:!1,tier:"premium"},"Fossielen Belgi":{name:"Fossielen Belgi",factory:async()=>{const{createFossielenBelgieLayerOL:n}=await mt(async()=>{const{createFossielenBelgieLayerOL:e}=await import("./fossielenBelgieOL-CDbkVlxA.js");return{createFossielenBelgieLayerOL:e}},__vite__mapDeps([20,19,1]));return n()},immediateLoad:!1,tier:"premium",regions:["be"]},"Fossielen Duitsland":{name:"Fossielen Duitsland",factory:async()=>{const{createFossielenDuitslandLayerOL:n}=await mt(async()=>{const{createFossielenDuitslandLayerOL:e}=await import("./fossielenDuitslandOL-Bt7CgL-2.js");return{createFossielenDuitslandLayerOL:e}},__vite__mapDeps([21,19,1]));return n()},immediateLoad:!1,tier:"premium",regions:["de"]},"Fossielen Frankrijk":{name:"Fossielen Frankrijk",factory:async()=>{const{createFossielenFrankrijkLayerOL:n}=await mt(async()=>{const{createFossielenFrankrijkLayerOL:e}=await import("./fossielenFrankrijkOL-B5uAxAD6.js");return{createFossielenFrankrijkLayerOL:e}},__vite__mapDeps([22,19,1]));return n()},immediateLoad:!1,tier:"premium",regions:["fr"]},"Fossiel Hotspots":{name:"Fossiel Hotspots",factory:async()=>{const{createFossielHotspotsLayerOL:n}=await mt(async()=>{const{createFossielHotspotsLayerOL:e}=await import("./fossielHotspotsOL-BcetaAnN.js");return{createFossielHotspotsLayerOL:e}},[]);return n()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},"Mineralen Hotspots":{name:"Mineralen Hotspots",factory:async()=>{const{createMineralenHotspotsLayerOL:n}=await mt(async()=>{const{createMineralenHotspotsLayerOL:e}=await import("./mineralenHotspotsOL-CJCr3yeN.js");return{createMineralenHotspotsLayerOL:e}},[]);return n()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},Goudrivieren:{name:"Goudrivieren",factory:async()=>{const{createGoudrivierenLayerOL:n}=await mt(async()=>{const{createGoudrivierenLayerOL:e}=await import("./goudrivierenOL-B3pagJAi.js");return{createGoudrivierenLayerOL:e}},[]);return n()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},Wandelroutes:{name:"Wandelroutes",factory:async()=>{const{createWandelroutesLayer:n}=await mt(async()=>{const{createWandelroutesLayer:e}=await import("./wandelroutesOL-kxXcwGZD.js");return{createWandelroutesLayer:e}},[]);return n()},immediateLoad:!1,tier:"free",regions:["nl","be"]},"WWII Bunkers":{name:"WWII Bunkers",factory:async()=>{const{createBunkersLayerOL:n}=await mt(async()=>{const{createBunkersLayerOL:e}=await import("./bunkersOL-B4jJDcvL.js");return{createBunkersLayerOL:e}},__vite__mapDeps([23,1]));return n()},immediateLoad:!1},Grafheuvels:{name:"Grafheuvels",factory:async()=>{const{createGrafheuvelsLayerOL:n}=await mt(async()=>{const{createGrafheuvelsLayerOL:e}=await import("./grafheuvelsOL-D8lszf2a.js");return{createGrafheuvelsLayerOL:e}},__vite__mapDeps([24,1]));return n()},immediateLoad:!1},Slagvelden:{name:"Slagvelden",factory:async()=>{const{createSlagveldenLayerOL:n}=await mt(async()=>{const{createSlagveldenLayerOL:e}=await import("./slagveldenOL-Se0FlgsO.js");return{createSlagveldenLayerOL:e}},__vite__mapDeps([25,1]));return n()},immediateLoad:!1},"Militaire Vliegvelden":{name:"Militaire Vliegvelden",factory:async()=>{const{createVliegveldenLayerOL:n}=await mt(async()=>{const{createVliegveldenLayerOL:e}=await import("./vliegveldenOL-wIbphCPt.js");return{createVliegveldenLayerOL:e}},[]);return n()},immediateLoad:!1}};function nK(){return Object.values(qv).filter(n=>n.immediateLoad)}const hs=Ra()(O0((n,e)=>({map:null,rotation:0,rotationEnabled:!0,setMap:t=>{n(r=>{r.map=t})},setRotation:t=>{n(r=>{if(r.rotation=t,r.map&&r.rotationEnabled){const i=t*Math.PI/180;r.map.getView().setRotation(i)}})},enableRotation:()=>{n(t=>{t.rotationEnabled=!0})},disableRotation:()=>{n(t=>{t.rotationEnabled=!1,t.rotation=0,t.map&&t.map.getView().animate({rotation:0,duration:500})})}}))),di=Ra()(O0((n,e)=>({visible:{"CartoDB (licht)":!0,OpenStreetMap:!1,Luchtfoto:!1,"Labels Overlay":!1,"TMK 1850":!1,"Bonnebladen 1900":!1,Hunebedden:!1,"FAMKE Steentijd":!1,Grafheuvels:!1,Terpen:!1,"AMK Monumenten":!1,"AMK Romeins":!1,"AMK Steentijd":!1,"AMK Vroege ME":!1,"AMK Late ME":!1,"AMK Overig":!1,"Archeo Onderzoeken":!1,"Romeinse wegen (regio)":!1,"Romeinse wegen (Wereld)":!1,Kastelen:!1,IKAW:!1,"Archeo Landschappen":!1,Essen:!1,Rijksmonumenten:!1,Werelderfgoed:!1,"WWII Bunkers":!1,Slagvelden:!1,"Militaire Vliegvelden":!1,Verdedigingslinies:!1,Inundatiegebieden:!1,"Militaire Objecten":!1,"Paleokaart 800 n.Chr.":!1,"Paleokaart 100 n.Chr.":!1,"Paleokaart 500 v.Chr.":!1,"Paleokaart 1500 v.Chr.":!1,"Paleokaart 2750 v.Chr.":!1,"Paleokaart 5500 v.Chr.":!1,"Paleokaart 9000 v.Chr.":!1,"Religieus Erfgoed":!1,"UIKAV Punten":!1,"UIKAV Vlakken":!1,"UIKAV Buffer":!1,"UIKAV Expert":!1,"UIKAV Indeling":!1,"AHN4 Hoogtekaart Kleur":!1,"AHN4 Hillshade NL":!1,"AHN4 Multi-Hillshade NL":!1,"AHN 0.5m":!1,Veengebieden:!1,Geomorfologie:!1,Bodemkaart:!1,"Fossielen Nederland":!1,"Fossielen Belgi":!1,"Fossielen Duitsland":!1,"Fossielen Frankrijk":!1,Parken:!1,Speeltuinen:!1,Musea:!1,Strandjes:!1,Gewaspercelen:!1,"Kadastrale Grenzen":!1,Scheepswrakken:!1,"Woonheuvels ZH":!1,"Romeinse Forten":!1,Windmolens:!1,Erfgoedlijnen:!1,"Oude Kernen":!1,"Relictenkaart Punten":!1,"Relictenkaart Lijnen":!1,"Relictenkaart Vlakken":!1,"Verdronken Dorpen":!1,"Mijn Vondsten":!0},opacity:{"AHN4 Hoogtekaart Kleur":.85,"AHN4 Hillshade NL":.7,"AHN4 Multi-Hillshade NL":.7,"AHN 0.5m":.7,"TMK 1850":.8,"Bonnebladen 1900":.8,Geomorfologie:.5,Bodemkaart:.6,Veengebieden:.6,IKAW:.5,"Archeo Landschappen":.5,Essen:.6,Terpen:.7,"Paleokaart 9000 v.Chr.":.7,"Paleokaart 5500 v.Chr.":.7,"Paleokaart 2750 v.Chr.":.7,"Paleokaart 1500 v.Chr.":.7,"Paleokaart 500 v.Chr.":.7,"Paleokaart 100 n.Chr.":.7,"Paleokaart 800 n.Chr.":.7,Verdedigingslinies:.7,Inundatiegebieden:.5,"Militaire Objecten":.8,"Religieus Erfgoed":.8,Gewaspercelen:.6,"Kadastrale Grenzen":.7,Erfgoedlijnen:.7,"Oude Kernen":.6,"Relictenkaart Vlakken":.5},loadingState:{},layers:{},toggleLayer:t=>{const r=e(),i=!r.visible[t];n(s=>{s.visible[t]=i}),i&&!r.layers[t]?e().loadLayer(t):r.layers[t]&&r.layers[t].setVisible(i)},setLayerVisibility:(t,r)=>{const i=e();n(s=>{s.visible[t]=r;const a=s.layers[t];a&&a.setVisible(r)}),r&&!i.layers[t]&&e().loadLayer(t)},setLayerOpacity:(t,r)=>{n(i=>{i.opacity[t]=r;const s=i.layers[t];s&&s.setOpacity(r)})},registerLayer:(t,r)=>{n(i=>{i.layers[t]=r,i.loadingState[t]="loaded",i.visible[t]!==void 0&&r.setVisible(i.visible[t]),i.opacity[t]!==void 0&&r.setOpacity(i.opacity[t])})},unregisterLayer:t=>{n(r=>{delete r.layers[t],delete r.loadingState[t]})},loadLayer:async t=>{const r=e();if(r.loadingState[t]==="loading"||r.layers[t])return;const i=qv[t];if(!i){console.warn(` Layer "${t}" not found in registry`);return}const s=hs.getState().map;if(!s){console.warn(` Cannot load layer "${t}": map not initialized`);return}n(a=>{a.loadingState[t]="loading"}),console.log(` Loading layer: ${t}...`);try{const a=await i.factory();if(!a)throw new Error("Factory returned null");const o=e();a.setVisible(o.visible[t]??!1),o.opacity[t]!==void 0&&a.setOpacity(o.opacity[t]),s.addLayer(a),n(l=>{l.layers[t]=a,l.loadingState[t]="loaded"}),console.log(` Layer loaded: ${t}`)}catch(a){console.error(` Failed to load layer "${t}":`,a),n(o=>{o.loadingState[t]="error"})}}}))),Or=Ra()(O0((n,e)=>({layerControlOpen:!1,legendOpen:!1,backgroundsPanelOpen:!1,themesPanelOpen:!1,settingsPanelOpen:!1,infoPanelOpen:!1,presetsPanelOpen:!1,vondstFormOpen:!1,vondstFormLocation:null,vondstFormPhoto:null,vondstDashboardOpen:!1,createLayerModalOpen:!1,addPointModalOpen:!1,addPointModalLayerId:null,addPointModalLocation:null,layerManagerModalOpen:!1,layerDashboardOpen:!1,layerDashboardLayerId:null,collapsedCategories:new Set,closeAllPanels:()=>{n(t=>{t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1})},toggleLayerControl:()=>{n(t=>{t.layerControlOpen=!t.layerControlOpen})},toggleLegend:()=>{n(t=>{t.legendOpen=!t.legendOpen})},toggleBackgroundsPanel:()=>{n(t=>{const r=t.backgroundsPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,r||(t.backgroundsPanelOpen=!0)})},toggleThemesPanel:()=>{n(t=>{const r=t.themesPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,r||(t.themesPanelOpen=!0)})},toggleSettingsPanel:()=>{n(t=>{const r=t.settingsPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,r||(t.settingsPanelOpen=!0)})},toggleInfoPanel:()=>{n(t=>{const r=t.infoPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,r||(t.infoPanelOpen=!0)})},togglePresetsPanel:()=>{n(t=>{const r=t.presetsPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,r||(t.presetsPanelOpen=!0)})},toggleCategory:t=>{n(r=>{r.collapsedCategories.has(t)?r.collapsedCategories.delete(t):r.collapsedCategories.add(t)})},setLayerControlOpen:t=>{n(r=>{r.layerControlOpen=t})},setLegendOpen:t=>{n(r=>{r.legendOpen=t})},openVondstForm:(t,r)=>{n(i=>{i.backgroundsPanelOpen=!1,i.themesPanelOpen=!1,i.settingsPanelOpen=!1,i.infoPanelOpen=!1,i.presetsPanelOpen=!1,i.vondstFormOpen=!0,i.vondstFormLocation=t||null,i.vondstFormPhoto=r||null})},closeVondstForm:()=>{n(t=>{t.vondstFormOpen=!1,t.vondstFormLocation=null,t.vondstFormPhoto=null})},toggleVondstDashboard:()=>{n(t=>{const r=t.vondstDashboardOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,t.vondstDashboardOpen=!r})},openCreateLayerModal:()=>{n(t=>{t.createLayerModalOpen=!0})},closeCreateLayerModal:()=>{n(t=>{t.createLayerModalOpen=!1})},openAddPointModal:(t,r)=>{n(i=>{i.addPointModalOpen=!0,i.addPointModalLayerId=t,i.addPointModalLocation=r})},closeAddPointModal:()=>{n(t=>{t.addPointModalOpen=!1,t.addPointModalLayerId=null,t.addPointModalLocation=null})},openLayerManagerModal:()=>{n(t=>{t.layerManagerModalOpen=!0})},closeLayerManagerModal:()=>{n(t=>{t.layerManagerModalOpen=!1})},openLayerDashboard:t=>{n(r=>{r.layerDashboardOpen=!0,r.layerDashboardLayerId=t,r.layerManagerModalOpen=!1})},closeLayerDashboard:()=>{n(t=>{t.layerDashboardOpen=!1,t.layerDashboardLayerId=null})}}))),rK=()=>{};var K4={};const bD=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},iK=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=n[t++],a=n[t++],o=n[t++],l=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=n[t++],a=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},ID={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const s=n[i],a=i+1<n.length,o=a?n[i+1]:0,l=i+2<n.length,u=l?n[i+2]:0,h=s>>2,f=(s&3)<<4|o>>4;let g=(o&15)<<2|u>>6,y=u&63;l||(y=64,a||(g=64)),r.push(t[h],t[f],t[g],t[y])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(bD(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):iK(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const s=t[n.charAt(i++)],o=i<n.length?t[n.charAt(i)]:0;++i;const u=i<n.length?t[n.charAt(i)]:64;++i;const f=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||o==null||u==null||f==null)throw new sK;const g=s<<2|o>>4;if(r.push(g),u!==64){const y=o<<4&240|u>>2;if(r.push(y),f!==64){const v=u<<6&192|f;r.push(v)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class sK extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const aK=function(n){const e=bD(n);return ID.encodeByteArray(e,!0)},vx=function(n){return aK(n).replace(/\./g,"")},AD=function(n){try{return ID.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function RD(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const oK=()=>RD().__FIREBASE_DEFAULTS__,lK=()=>{if(typeof process>"u"||typeof K4>"u")return;const n=K4.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},cK=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&AD(n[1]);return e&&JSON.parse(e)},Xv=()=>{try{return rK()||oK()||lK()||cK()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},CD=n=>Xv()?.emulatorHosts?.[n],PD=n=>{const e=CD(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},kD=()=>Xv()?.config,MD=n=>Xv()?.[`_${n}`];class uK{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function hd(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function NI(n){return(await fetch(n,{credentials:"include"})).ok}function ND(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...n};return[vx(JSON.stringify(t)),vx(JSON.stringify(a)),""].join(".")}const gm={};function hK(){const n={prod:[],emulator:[]};for(const e of Object.keys(gm))gm[e]?n.emulator.push(e):n.prod.push(e);return n}function dK(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let Y4=!1;function LI(n,e){if(typeof window>"u"||typeof document>"u"||!hd(window.location.host)||gm[n]===e||gm[n]||Y4)return;gm[n]=e;function t(g){return`__firebase__banner__${g}`}const r="__firebase__banner",s=hK().prod.length>0;function a(){const g=document.getElementById(r);g&&g.remove()}function o(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function l(g,y){g.setAttribute("width","24"),g.setAttribute("id",y),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function u(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{Y4=!0,a()},g}function h(g,y){g.setAttribute("id",y),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function f(){const g=dK(r),y=t("text"),v=document.getElementById(y)||document.createElement("span"),x=t("learnmore"),E=document.getElementById(x)||document.createElement("a"),T=t("preprendIcon"),b=document.getElementById(T)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const I=g.element;o(I),h(E,x);const M=u();l(b,T),I.append(b,v,E,M),document.body.appendChild(I)}s?(v.innerText="Preview backend disconnected.",b.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(b.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,v.innerText="Preview backend running in this workspace."),v.setAttribute("id",y)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}function ri(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function fK(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ri())}function LD(){const n=Xv()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function gK(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function mK(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function pK(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function yK(){const n=ri();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function OD(){return!LD()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function DD(){return!LD()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function FD(){try{return typeof indexedDB=="object"}catch{return!1}}function _K(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(t){e(t)}})}const xK="FirebaseError";class nl extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=xK,Object.setPrototypeOf(this,nl.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,n1.prototype.create)}}class n1{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?vK(s,r):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new nl(i,o,r)}}function vK(n,e){return n.replace(wK,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const wK=/\{\$([^}]+)}/g;function EK(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Uh(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const s=n[i],a=e[i];if(q4(s)&&q4(a)){if(!Uh(s,a))return!1}else if(s!==a)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function q4(n){return n!==null&&typeof n=="object"}function r1(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function SK(n,e){const t=new TK(n,e);return t.subscribe.bind(t)}class TK{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");bK(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=tS),i.error===void 0&&(i.error=tS),i.complete===void 0&&(i.complete=tS);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function bK(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function tS(){}function pi(n){return n&&n._delegate?n._delegate:n}class cu{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const ih="[DEFAULT]";class IK{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new uK;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(RK(e))try{this.getOrInitializeService({instanceIdentifier:ih})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=ih){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ih){return this.instances.has(e)}getOptions(e=ih){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);r===o&&a.resolve(i)}return i}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:AK(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=ih){return this.component?this.component.multipleInstances?e:ih:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function AK(n){return n===ih?void 0:n}function RK(n){return n.instantiationMode==="EAGER"}class CK{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new IK(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var hn;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(hn||(hn={}));const PK={debug:hn.DEBUG,verbose:hn.VERBOSE,info:hn.INFO,warn:hn.WARN,error:hn.ERROR,silent:hn.SILENT},kK=hn.INFO,MK={[hn.DEBUG]:"log",[hn.VERBOSE]:"log",[hn.INFO]:"info",[hn.WARN]:"warn",[hn.ERROR]:"error"},NK=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=MK[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class OI{constructor(e){this.name=e,this._logLevel=kK,this._logHandler=NK,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in hn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?PK[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,hn.DEBUG,...e),this._logHandler(this,hn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,hn.VERBOSE,...e),this._logHandler(this,hn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,hn.INFO,...e),this._logHandler(this,hn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,hn.WARN,...e),this._logHandler(this,hn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,hn.ERROR,...e),this._logHandler(this,hn.ERROR,...e)}}const LK=(n,e)=>e.some(t=>n instanceof t);let X4,Z4;function OK(){return X4||(X4=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function DK(){return Z4||(Z4=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const jD=new WeakMap,TT=new WeakMap,VD=new WeakMap,nS=new WeakMap,DI=new WeakMap;function FK(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",a)},s=()=>{t(tu(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&jD.set(t,n)}).catch(()=>{}),DI.set(e,n),e}function jK(n){if(TT.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",a),n.removeEventListener("abort",a)},s=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",a),n.addEventListener("abort",a)});TT.set(n,e)}let bT={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return TT.get(n);if(e==="objectStoreNames")return n.objectStoreNames||VD.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return tu(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function VK(n){bT=n(bT)}function GK(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(rS(this),e,...t);return VD.set(r,e.sort?e.sort():[e]),tu(r)}:DK().includes(n)?function(...e){return n.apply(rS(this),e),tu(jD.get(this))}:function(...e){return tu(n.apply(rS(this),e))}}function BK(n){return typeof n=="function"?GK(n):(n instanceof IDBTransaction&&jK(n),LK(n,OK())?new Proxy(n,bT):n)}function tu(n){if(n instanceof IDBRequest)return FK(n);if(nS.has(n))return nS.get(n);const e=BK(n);return e!==n&&(nS.set(n,e),DI.set(e,n)),e}const rS=n=>DI.get(n);function UK(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){const a=indexedDB.open(n,e),o=tu(a);return r&&a.addEventListener("upgradeneeded",l=>{r(tu(a.result),l.oldVersion,l.newVersion,tu(a.transaction),l)}),t&&a.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),o.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),o}const zK=["get","getKey","getAll","getAllKeys","count"],$K=["put","add","delete","clear"],iS=new Map;function Q4(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(iS.get(e))return iS.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=$K.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||zK.includes(t)))return;const s=async function(a,...o){const l=this.transaction(a,i?"readwrite":"readonly");let u=l.store;return r&&(u=u.index(o.shift())),(await Promise.all([u[t](...o),i&&l.done]))[0]};return iS.set(e,s),s}VK(n=>({...n,get:(e,t,r)=>Q4(e,t)||n.get(e,t,r),has:(e,t)=>!!Q4(e,t)||n.has(e,t)}));class WK{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(HK(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function HK(n){return n.getComponent()?.type==="VERSION"}const IT="@firebase/app",J4="0.14.6";const Gl=new OI("@firebase/app"),KK="@firebase/app-compat",YK="@firebase/analytics-compat",qK="@firebase/analytics",XK="@firebase/app-check-compat",ZK="@firebase/app-check",QK="@firebase/auth",JK="@firebase/auth-compat",eY="@firebase/database",tY="@firebase/data-connect",nY="@firebase/database-compat",rY="@firebase/functions",iY="@firebase/functions-compat",sY="@firebase/installations",aY="@firebase/installations-compat",oY="@firebase/messaging",lY="@firebase/messaging-compat",cY="@firebase/performance",uY="@firebase/performance-compat",hY="@firebase/remote-config",dY="@firebase/remote-config-compat",fY="@firebase/storage",gY="@firebase/storage-compat",mY="@firebase/firestore",pY="@firebase/ai",yY="@firebase/firestore-compat",_Y="firebase",xY="12.6.0";const AT="[DEFAULT]",vY={[IT]:"fire-core",[KK]:"fire-core-compat",[qK]:"fire-analytics",[YK]:"fire-analytics-compat",[ZK]:"fire-app-check",[XK]:"fire-app-check-compat",[QK]:"fire-auth",[JK]:"fire-auth-compat",[eY]:"fire-rtdb",[tY]:"fire-data-connect",[nY]:"fire-rtdb-compat",[rY]:"fire-fn",[iY]:"fire-fn-compat",[sY]:"fire-iid",[aY]:"fire-iid-compat",[oY]:"fire-fcm",[lY]:"fire-fcm-compat",[cY]:"fire-perf",[uY]:"fire-perf-compat",[hY]:"fire-rc",[dY]:"fire-rc-compat",[fY]:"fire-gcs",[gY]:"fire-gcs-compat",[mY]:"fire-fst",[yY]:"fire-fst-compat",[pY]:"fire-vertex","fire-js":"fire-js",[_Y]:"fire-js-all"};const wx=new Map,wY=new Map,RT=new Map;function eM(n,e){try{n.container.addComponent(e)}catch(t){Gl.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function zh(n){const e=n.name;if(RT.has(e))return Gl.debug(`There were multiple attempts to register component ${e}.`),!1;RT.set(e,n);for(const t of wx.values())eM(t,n);for(const t of wY.values())eM(t,n);return!0}function Zv(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Ys(n){return n==null?!1:n.settings!==void 0}const EY={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},nu=new n1("app","Firebase",EY);class SY{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new cu("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw nu.create("app-deleted",{appName:this._name})}}const dd=xY;function GD(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:AT,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw nu.create("bad-app-name",{appName:String(i)});if(t||(t=kD()),!t)throw nu.create("no-options");const s=wx.get(i);if(s){if(Uh(t,s.options)&&Uh(r,s.config))return s;throw nu.create("duplicate-app",{appName:i})}const a=new CK(i);for(const l of RT.values())a.addComponent(l);const o=new SY(t,r,a);return wx.set(i,o),o}function FI(n=AT){const e=wx.get(n);if(!e&&n===AT&&kD())return GD();if(!e)throw nu.create("no-app",{appName:n});return e}function Fo(n,e,t){let r=vY[n]??n;t&&(r+=`-${t}`);const i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){const a=[`Unable to register library "${r}" with version "${e}":`];i&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&a.push("and"),s&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Gl.warn(a.join(" "));return}zh(new cu(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}const TY="firebase-heartbeat-database",bY=1,ip="firebase-heartbeat-store";let sS=null;function BD(){return sS||(sS=UK(TY,bY,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(ip)}catch(t){console.warn(t)}}}}).catch(n=>{throw nu.create("idb-open",{originalErrorMessage:n.message})})),sS}async function IY(n){try{const t=(await BD()).transaction(ip),r=await t.objectStore(ip).get(UD(n));return await t.done,r}catch(e){if(e instanceof nl)Gl.warn(e.message);else{const t=nu.create("idb-get",{originalErrorMessage:e?.message});Gl.warn(t.message)}}}async function tM(n,e){try{const r=(await BD()).transaction(ip,"readwrite");await r.objectStore(ip).put(e,UD(n)),await r.done}catch(t){if(t instanceof nl)Gl.warn(t.message);else{const r=nu.create("idb-set",{originalErrorMessage:t?.message});Gl.warn(r.message)}}}function UD(n){return`${n.name}!${n.options.appId}`}const AY=1024,RY=30;class CY{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new kY(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=nM();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>RY){const i=MY(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Gl.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=nM(),{heartbeatsToSend:t,unsentEntries:r}=PY(this._heartbeatsCache.heartbeats),i=vx(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return Gl.warn(e),""}}}function nM(){return new Date().toISOString().substring(0,10)}function PY(n,e=AY){const t=[];let r=n.slice();for(const i of n){const s=t.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),rM(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),rM(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class kY{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return FD()?_K().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await IY(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return tM(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return tM(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function rM(n){return vx(JSON.stringify({version:2,heartbeats:n})).length}function MY(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function NY(n){zh(new cu("platform-logger",e=>new WK(e),"PRIVATE")),zh(new cu("heartbeat",e=>new CY(e),"PRIVATE")),Fo(IT,J4,n),Fo(IT,J4,"esm2020"),Fo("fire-js","")}NY("");function zD(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const LY=zD,$D=new n1("auth","Firebase",zD());const Ex=new OI("@firebase/auth");function OY(n,...e){Ex.logLevel<=hn.WARN&&Ex.warn(`Auth (${dd}): ${n}`,...e)}function A_(n,...e){Ex.logLevel<=hn.ERROR&&Ex.error(`Auth (${dd}): ${n}`,...e)}function qo(n,...e){throw VI(n,...e)}function eo(n,...e){return VI(n,...e)}function jI(n,e,t){const r={...LY(),[e]:t};return new n1("auth","Firebase",r).create(e,{appName:n.name})}function ru(n){return jI(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function DY(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&qo(n,"argument-error"),jI(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function VI(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return $D.create(n,...e)}function Ht(n,e,...t){if(!n)throw VI(e,...t)}function Tl(n){const e="INTERNAL ASSERTION FAILED: "+n;throw A_(e),new Error(e)}function Bl(n,e){n||Tl(e)}function CT(){return typeof self<"u"&&self.location?.href||""}function FY(){return iM()==="http:"||iM()==="https:"}function iM(){return typeof self<"u"&&self.location?.protocol||null}function jY(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(FY()||mK()||"connection"in navigator)?navigator.onLine:!0}function VY(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class i1{constructor(e,t){this.shortDelay=e,this.longDelay=t,Bl(t>e,"Short delay should be less than long delay!"),this.isMobile=fK()||pK()}get(){return jY()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function GI(n,e){Bl(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class WD{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Tl("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Tl("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Tl("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const GY={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const BY=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],UY=new i1(3e4,6e4);function Qv(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function D0(n,e,t,r,i={}){return HD(n,i,async()=>{let s={},a={};r&&(e==="GET"?a=r:s={body:JSON.stringify(r)});const o=r1({key:n.config.apiKey,...a}).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const u={method:e,headers:l,...s};return gK()||(u.referrerPolicy="no-referrer"),n.emulatorConfig&&hd(n.emulatorConfig.host)&&(u.credentials="include"),WD.fetch()(await YD(n,n.config.apiHost,t,o),u)})}async function HD(n,e,t){n._canInitEmulator=!1;const r={...GY,...e};try{const i=new zY(n),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw Xy(n,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const o=s.ok?a.errorMessage:a.error.message,[l,u]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Xy(n,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw Xy(n,"email-already-in-use",a);if(l==="USER_DISABLED")throw Xy(n,"user-disabled",a);const h=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw jI(n,h,u);qo(n,h)}}catch(i){if(i instanceof nl)throw i;qo(n,"network-request-failed",{message:String(i)})}}async function KD(n,e,t,r,i={}){const s=await D0(n,e,t,r,i);return"mfaPendingCredential"in s&&qo(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function YD(n,e,t,r){const i=`${e}${t}?${r}`,s=n,a=s.config.emulator?GI(n.config,i):`${n.config.apiScheme}://${i}`;return BY.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(a).toString():a}class zY{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(eo(this.auth,"network-request-failed")),UY.get())})}}function Xy(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=eo(n,e,r);return i.customData._tokenResponse=t,i}async function $Y(n,e){return D0(n,"POST","/v1/accounts:delete",e)}async function Sx(n,e){return D0(n,"POST","/v1/accounts:lookup",e)}function mm(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function WY(n,e=!1){const t=pi(n),r=await t.getIdToken(e),i=BI(r);Ht(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s?.sign_in_provider;return{claims:i,token:r,authTime:mm(aS(i.auth_time)),issuedAtTime:mm(aS(i.iat)),expirationTime:mm(aS(i.exp)),signInProvider:a||null,signInSecondFactor:s?.sign_in_second_factor||null}}function aS(n){return Number(n)*1e3}function BI(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return A_("JWT malformed, contained fewer than 3 sections"),null;try{const i=AD(t);return i?JSON.parse(i):(A_("Failed to decode base64 JWT payload"),null)}catch(i){return A_("Caught error parsing JWT payload as JSON",i?.toString()),null}}function sM(n){const e=BI(n);return Ht(e,"internal-error"),Ht(typeof e.exp<"u","internal-error"),Ht(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function sp(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof nl&&HY(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function HY({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class KY{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class PT{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=mm(this.lastLoginAt),this.creationTime=mm(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Tx(n){const e=n.auth,t=await n.getIdToken(),r=await sp(n,Sx(e,{idToken:t}));Ht(r?.users.length,e,"internal-error");const i=r.users[0];n._notifyReloadListener(i);const s=i.providerUserInfo?.length?qD(i.providerUserInfo):[],a=qY(n.providerData,s),o=n.isAnonymous,l=!(n.email&&i.passwordHash)&&!a?.length,u=o?l:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new PT(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(n,h)}async function YY(n){const e=pi(n);await Tx(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function qY(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function qD(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function XY(n,e){const t=await HD(n,{},async()=>{const r=r1({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,a=await YD(n,i,"/v1/token",`key=${s}`),o=await n._getAdditionalHeaders();o["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:o,body:r};return n.emulatorConfig&&hd(n.emulatorConfig.host)&&(l.credentials="include"),WD.fetch()(a,l)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function ZY(n,e){return D0(n,"POST","/v2/accounts:revokeToken",Qv(n,e))}class Wf{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ht(e.idToken,"internal-error"),Ht(typeof e.idToken<"u","internal-error"),Ht(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):sM(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Ht(e.length!==0,"internal-error");const t=sM(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Ht(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:s}=await XY(e,t);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:s}=t,a=new Wf;return r&&(Ht(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(Ht(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(Ht(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Wf,this.toJSON())}_performRefresh(){return Tl("not implemented")}}function Rc(n,e){Ht(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class qa{constructor({uid:e,auth:t,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new KY(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new PT(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await sp(this,this.stsTokenManager.getToken(this.auth,e));return Ht(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return WY(this,e)}reload(){return YY(this)}_assign(e){this!==e&&(Ht(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new qa({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Ht(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await Tx(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ys(this.auth.app))return Promise.reject(ru(this.auth));const e=await this.getIdToken();return await sp(this,$Y(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,i=t.email??void 0,s=t.phoneNumber??void 0,a=t.photoURL??void 0,o=t.tenantId??void 0,l=t._redirectEventId??void 0,u=t.createdAt??void 0,h=t.lastLoginAt??void 0,{uid:f,emailVerified:g,isAnonymous:y,providerData:v,stsTokenManager:x}=t;Ht(f&&x,e,"internal-error");const E=Wf.fromJSON(this.name,x);Ht(typeof f=="string",e,"internal-error"),Rc(r,e.name),Rc(i,e.name),Ht(typeof g=="boolean",e,"internal-error"),Ht(typeof y=="boolean",e,"internal-error"),Rc(s,e.name),Rc(a,e.name),Rc(o,e.name),Rc(l,e.name),Rc(u,e.name),Rc(h,e.name);const T=new qa({uid:f,auth:e,email:i,emailVerified:g,displayName:r,isAnonymous:y,photoURL:a,phoneNumber:s,tenantId:o,stsTokenManager:E,createdAt:u,lastLoginAt:h});return v&&Array.isArray(v)&&(T.providerData=v.map(b=>({...b}))),l&&(T._redirectEventId=l),T}static async _fromIdTokenResponse(e,t,r=!1){const i=new Wf;i.updateFromServerResponse(t);const s=new qa({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await Tx(s),s}static async _fromGetAccountInfoResponse(e,t,r){const i=t.users[0];Ht(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?qD(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!s?.length,o=new Wf;o.updateFromIdToken(r);const l=new qa({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:a}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new PT(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(l,u),l}}const aM=new Map;function bl(n){Bl(n instanceof Function,"Expected a class definition");let e=aM.get(n);return e?(Bl(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,aM.set(n,e),e)}class XD{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}XD.type="NONE";const oM=XD;function R_(n,e,t){return`firebase:${n}:${e}:${t}`}class Hf{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=R_(this.userKey,i.apiKey,s),this.fullPersistenceKey=R_("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Sx(this.auth,{idToken:e}).catch(()=>{});return t?qa._fromGetAccountInfoResponse(this.auth,t,e):null}return qa._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Hf(bl(oM),e,r);const i=(await Promise.all(t.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let s=i[0]||bl(oM);const a=R_(r,e.config.apiKey,e.name);let o=null;for(const u of t)try{const h=await u._get(a);if(h){let f;if(typeof h=="string"){const g=await Sx(e,{idToken:h}).catch(()=>{});if(!g)break;f=await qa._fromGetAccountInfoResponse(e,g,h)}else f=qa._fromJSON(e,h);u!==s&&(o=f),s=u;break}}catch{}const l=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new Hf(s,e,r):(s=l[0],o&&await s._set(a,o.toJSON()),await Promise.all(t.map(async u=>{if(u!==s)try{await u._remove(a)}catch{}})),new Hf(s,e,r))}}function lM(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(e6(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(ZD(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(n6(e))return"Blackberry";if(r6(e))return"Webos";if(QD(e))return"Safari";if((e.includes("chrome/")||JD(e))&&!e.includes("edge/"))return"Chrome";if(t6(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function ZD(n=ri()){return/firefox\//i.test(n)}function QD(n=ri()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function JD(n=ri()){return/crios\//i.test(n)}function e6(n=ri()){return/iemobile/i.test(n)}function t6(n=ri()){return/android/i.test(n)}function n6(n=ri()){return/blackberry/i.test(n)}function r6(n=ri()){return/webos/i.test(n)}function UI(n=ri()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function QY(n=ri()){return UI(n)&&!!window.navigator?.standalone}function JY(){return yK()&&document.documentMode===10}function i6(n=ri()){return UI(n)||t6(n)||r6(n)||n6(n)||/windows phone/i.test(n)||e6(n)}function s6(n,e=[]){let t;switch(n){case"Browser":t=lM(ri());break;case"Worker":t=`${lM(ri())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${dd}/${r}`}class eq{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=s=>new Promise((a,o)=>{try{const l=e(s);a(l)}catch(l){o(l)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function tq(n,e={}){return D0(n,"GET","/v2/passwordPolicy",Qv(n,e))}const nq=6;class rq{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??nq,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class iq{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new cM(this),this.idTokenSubscription=new cM(this),this.beforeStateQueue=new eq(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=$D,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=bl(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Hf.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Sx(this,{idToken:e}),r=await qa._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Ys(this.app)){const s=this.app.settings.authIdToken;return s?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(a,a))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const s=this.redirectUser?._redirectEventId,a=r?._redirectEventId,o=await this.tryRedirectSignIn(e);(!s||s===a)&&o?.user&&(r=o.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(s){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Ht(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Tx(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=VY()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ys(this.app))return Promise.reject(ru(this));const t=e?pi(e):null;return t&&Ht(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Ht(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ys(this.app)?Promise.reject(ru(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ys(this.app)?Promise.reject(ru(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(bl(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await tq(this),t=new rq(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new n1("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await ZY(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&bl(e)||this._popupRedirectResolver;Ht(t,this,"argument-error"),this.redirectPersistenceManager=await Hf.create(this,[bl(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ht(o,this,"internal-error"),o.then(()=>{a||s(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,r,i);return()=>{a=!0,l()}}else{const l=e.addObserver(t);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ht(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=s6(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(Ys(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&OY(`Error while retrieving App Check token: ${e.error}`),e?.token}}function s1(n){return pi(n)}class cM{constructor(e){this.auth=e,this.observer=null,this.addObserver=SK(t=>this.observer=t)}get next(){return Ht(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let zI={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function sq(n){zI=n}function aq(n){return zI.loadJS(n)}function oq(){return zI.gapiScript}function lq(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function cq(n,e){const t=Zv(n,"auth");if(t.isInitialized()){const i=t.getImmediate(),s=t.getOptions();if(Uh(s,e??{}))return i;qo(i,"already-initialized")}return t.initialize({options:e})}function uq(n,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(bl);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function hq(n,e,t){const r=s1(n);Ht(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=a6(e),{host:a,port:o}=dq(e),l=o===null?"":`:${o}`,u={url:`${s}//${a}${l}/`},h=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){Ht(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Ht(Uh(u,r.config.emulator)&&Uh(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=u,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,hd(a)?(NI(`${s}//${a}${l}`),LI("Auth",!0)):fq()}function a6(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function dq(n){const e=a6(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:uM(r.substr(s.length+1))}}else{const[s,a]=r.split(":");return{host:s,port:uM(a)}}}function uM(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function fq(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class o6{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Tl("not implemented")}_getIdTokenResponse(e){return Tl("not implemented")}_linkToIdToken(e,t){return Tl("not implemented")}_getReauthenticationResolver(e){return Tl("not implemented")}}async function Kf(n,e){return KD(n,"POST","/v1/accounts:signInWithIdp",Qv(n,e))}const gq="http://localhost";class $h extends o6{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new $h(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):qo("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...s}=t;if(!r||!i)return null;const a=new $h(r,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const t=this.buildRequest();return Kf(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Kf(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Kf(e,t)}buildRequest(){const e={requestUri:gq,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=r1(t)}return e}}class $I{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class a1 extends $I{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class jc extends a1{constructor(){super("facebook.com")}static credential(e){return $h._fromParams({providerId:jc.PROVIDER_ID,signInMethod:jc.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return jc.credentialFromTaggedObject(e)}static credentialFromError(e){return jc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return jc.credential(e.oauthAccessToken)}catch{return null}}}jc.FACEBOOK_SIGN_IN_METHOD="facebook.com";jc.PROVIDER_ID="facebook.com";class Sl extends a1{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return $h._fromParams({providerId:Sl.PROVIDER_ID,signInMethod:Sl.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Sl.credentialFromTaggedObject(e)}static credentialFromError(e){return Sl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Sl.credential(t,r)}catch{return null}}}Sl.GOOGLE_SIGN_IN_METHOD="google.com";Sl.PROVIDER_ID="google.com";class Vc extends a1{constructor(){super("github.com")}static credential(e){return $h._fromParams({providerId:Vc.PROVIDER_ID,signInMethod:Vc.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Vc.credentialFromTaggedObject(e)}static credentialFromError(e){return Vc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Vc.credential(e.oauthAccessToken)}catch{return null}}}Vc.GITHUB_SIGN_IN_METHOD="github.com";Vc.PROVIDER_ID="github.com";class Gc extends a1{constructor(){super("twitter.com")}static credential(e,t){return $h._fromParams({providerId:Gc.PROVIDER_ID,signInMethod:Gc.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Gc.credentialFromTaggedObject(e)}static credentialFromError(e){return Gc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return Gc.credential(t,r)}catch{return null}}}Gc.TWITTER_SIGN_IN_METHOD="twitter.com";Gc.PROVIDER_ID="twitter.com";async function mq(n,e){return KD(n,"POST","/v1/accounts:signUp",Qv(n,e))}class uu{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const s=await qa._fromIdTokenResponse(e,r,i),a=hM(r);return new uu({user:s,providerId:a,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=hM(r);return new uu({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function hM(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}async function pq(n){if(Ys(n.app))return Promise.reject(ru(n));const e=s1(n);if(await e._initializationPromise,e.currentUser?.isAnonymous)return new uu({user:e.currentUser,providerId:null,operationType:"signIn"});const t=await mq(e,{returnSecureToken:!0}),r=await uu._fromIdTokenResponse(e,"signIn",t,!0);return await e._updateCurrentUser(r.user),r}class bx extends nl{constructor(e,t,r,i){super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,bx.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new bx(e,t,r,i)}}function l6(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?bx._fromErrorAndOperation(n,s,e,r):s})}async function yq(n,e,t=!1){const r=await sp(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return uu._forOperation(n,"link",r)}async function _q(n,e,t=!1){const{auth:r}=n;if(Ys(r.app))return Promise.reject(ru(r));const i="reauthenticate";try{const s=await sp(n,l6(r,i,e,n),t);Ht(s.idToken,r,"internal-error");const a=BI(s.idToken);Ht(a,r,"internal-error");const{sub:o}=a;return Ht(n.uid===o,r,"user-mismatch"),uu._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&qo(r,"user-mismatch"),s}}async function xq(n,e,t=!1){if(Ys(n.app))return Promise.reject(ru(n));const r="signIn",i=await l6(n,r,e),s=await uu._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(s.user),s}function vq(n,e,t,r){return pi(n).onIdTokenChanged(e,t,r)}function wq(n,e,t){return pi(n).beforeAuthStateChanged(e,t)}function c6(n,e,t,r){return pi(n).onAuthStateChanged(e,t,r)}function u6(n){return pi(n).signOut()}const Ix="__sak";class h6{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Ix,"1"),this.storage.removeItem(Ix),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const Eq=1e3,Sq=10;class d6 extends h6{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=i6(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const r=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(r);!t&&this.localCache[r]===a||this.notifyListeners(r,a)},s=this.storage.getItem(r);JY()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,Sq):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},Eq)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}d6.type="LOCAL";const Tq=d6;class f6 extends h6{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}f6.type="SESSION";const g6=f6;function bq(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class Jv{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new Jv(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:s}=t.data,a=this.handlersMap[i];if(!a?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const o=Array.from(a).map(async u=>u(t.origin,s)),l=await bq(o);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Jv.receivers=[];function WI(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}class Iq{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((o,l)=>{const u=WI("",20);i.port1.start();const h=setTimeout(()=>{l(new Error("unsupported_event"))},r);a={messageChannel:i,onMessage(f){const g=f;if(g.data.eventId===u)switch(g.data.status){case"ack":clearTimeout(h),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),o(g.data.response);break;default:clearTimeout(h),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:u,data:t},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}function jo(){return window}function Aq(n){jo().location.href=n}function m6(){return typeof jo().WorkerGlobalScope<"u"&&typeof jo().importScripts=="function"}async function Rq(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Cq(){return navigator?.serviceWorker?.controller||null}function Pq(){return m6()?self:null}const p6="firebaseLocalStorageDb",kq=1,Ax="firebaseLocalStorage",y6="fbase_key";class o1{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function ew(n,e){return n.transaction([Ax],e?"readwrite":"readonly").objectStore(Ax)}function Mq(){const n=indexedDB.deleteDatabase(p6);return new o1(n).toPromise()}function kT(){const n=indexedDB.open(p6,kq);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(Ax,{keyPath:y6})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(Ax)?e(r):(r.close(),await Mq(),e(await kT()))})})}async function dM(n,e,t){const r=ew(n,!0).put({[y6]:e,value:t});return new o1(r).toPromise()}async function Nq(n,e){const t=ew(n,!1).get(e),r=await new o1(t).toPromise();return r===void 0?null:r.value}function fM(n,e){const t=ew(n,!0).delete(e);return new o1(t).toPromise()}const Lq=800,Oq=3;class _6{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await kT(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>Oq)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return m6()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Jv._getInstance(Pq()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await Rq(),!this.activeServiceWorker)return;this.sender=new Iq(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Cq()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await kT();return await dM(e,Ix,"1"),await fM(e,Ix),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>dM(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>Nq(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>fM(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=ew(i,!1).getAll();return new o1(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Lq)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}_6.type="LOCAL";const Dq=_6;new i1(3e4,6e4);function x6(n,e){return e?bl(e):(Ht(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class HI extends o6{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Kf(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Kf(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Kf(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Fq(n){return xq(n.auth,new HI(n),n.bypassAuthState)}function jq(n){const{auth:e,user:t}=n;return Ht(t,e,"internal-error"),_q(t,new HI(n),n.bypassAuthState)}async function Vq(n){const{auth:e,user:t}=n;return Ht(t,e,"internal-error"),yq(t,new HI(n),n.bypassAuthState)}class v6{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:a,type:o}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Fq;case"linkViaPopup":case"linkViaRedirect":return Vq;case"reauthViaPopup":case"reauthViaRedirect":return jq;default:qo(this.auth,"internal-error")}}resolve(e){Bl(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Bl(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Gq=new i1(2e3,1e4);async function Bq(n,e,t){if(Ys(n.app))return Promise.reject(eo(n,"operation-not-supported-in-this-environment"));const r=s1(n);DY(n,e,$I);const i=x6(r,t);return new vh(r,"signInViaPopup",e,i).executeNotNull()}class vh extends v6{constructor(e,t,r,i,s){super(e,t,i,s),this.provider=r,this.authWindow=null,this.pollId=null,vh.currentPopupAction&&vh.currentPopupAction.cancel(),vh.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ht(e,this.auth,"internal-error"),e}async onExecution(){Bl(this.filter.length===1,"Popup operations only handle one event");const e=WI();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(eo(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(eo(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,vh.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(eo(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Gq.get())};e()}}vh.currentPopupAction=null;const Uq="pendingRedirect",C_=new Map;class zq extends v6{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=C_.get(this.auth._key());if(!e){try{const r=await $q(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}C_.set(this.auth._key(),e)}return this.bypassAuthState||C_.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function $q(n,e){const t=Kq(e),r=Hq(n);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}function Wq(n,e){C_.set(n._key(),e)}function Hq(n){return bl(n._redirectPersistence)}function Kq(n){return R_(Uq,n.config.apiKey,n.name)}async function Yq(n,e,t=!1){if(Ys(n.app))return Promise.reject(ru(n));const r=s1(n),i=x6(r,e),a=await new zq(r,i,t).execute();return a&&!t&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}const qq=600*1e3;class Xq{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Zq(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!w6(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(eo(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=qq&&this.cachedEventUids.clear(),this.cachedEventUids.has(gM(e))}saveEventToCache(e){this.cachedEventUids.add(gM(e)),this.lastProcessedEventTime=Date.now()}}function gM(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function w6({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function Zq(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return w6(n);default:return!1}}async function Qq(n,e={}){return D0(n,"GET","/v1/projects",e)}const Jq=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,eX=/^https?/;async function tX(n){if(n.config.emulator)return;const{authorizedDomains:e}=await Qq(n);for(const t of e)try{if(nX(t))return}catch{}qo(n,"unauthorized-domain")}function nX(n){const e=CT(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!eX.test(t))return!1;if(Jq.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const rX=new i1(3e4,6e4);function mM(){const n=jo().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function iX(n){return new Promise((e,t)=>{function r(){mM(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{mM(),t(eo(n,"network-request-failed"))},timeout:rX.get()})}if(jo().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(jo().gapi?.load)r();else{const i=lq("iframefcb");return jo()[i]=()=>{gapi.load?r():t(eo(n,"network-request-failed"))},aq(`${oq()}?onload=${i}`).catch(s=>t(s))}}).catch(e=>{throw P_=null,e})}let P_=null;function sX(n){return P_=P_||iX(n),P_}const aX=new i1(5e3,15e3),oX="__/auth/iframe",lX="emulator/auth/iframe",cX={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},uX=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function hX(n){const e=n.config;Ht(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?GI(e,lX):`https://${n.config.authDomain}/${oX}`,r={apiKey:e.apiKey,appName:n.name,v:dd},i=uX.get(n.config.apiHost);i&&(r.eid=i);const s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${r1(r).slice(1)}`}async function dX(n){const e=await sX(n),t=jo().gapi;return Ht(t,n,"internal-error"),e.open({where:document.body,url:hX(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:cX,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const a=eo(n,"network-request-failed"),o=jo().setTimeout(()=>{s(a)},aX.get());function l(){jo().clearTimeout(o),i(r)}r.ping(l).then(l,()=>{s(a)})}))}const fX={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},gX=500,mX=600,pX="_blank",yX="http://localhost";class pM{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function _X(n,e,t,r=gX,i=mX){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let o="";const l={...fX,width:r.toString(),height:i.toString(),top:s,left:a},u=ri().toLowerCase();t&&(o=JD(u)?pX:t),ZD(u)&&(e=e||yX,l.scrollbars="yes");const h=Object.entries(l).reduce((g,[y,v])=>`${g}${y}=${v},`,"");if(QY(u)&&o!=="_self")return xX(e||"",o),new pM(null);const f=window.open(e||"",o,h);Ht(f,n,"popup-blocked");try{f.focus()}catch{}return new pM(f)}function xX(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}const vX="__/auth/handler",wX="emulator/auth/handler",EX=encodeURIComponent("fac");async function yM(n,e,t,r,i,s){Ht(n.config.authDomain,n,"auth-domain-config-required"),Ht(n.config.apiKey,n,"invalid-api-key");const a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:dd,eventId:i};if(e instanceof $I){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",EK(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,f]of Object.entries({}))a[h]=f}if(e instanceof a1){const h=e.getScopes().filter(f=>f!=="");h.length>0&&(a.scopes=h.join(","))}n.tenantId&&(a.tid=n.tenantId);const o=a;for(const h of Object.keys(o))o[h]===void 0&&delete o[h];const l=await n._getAppCheckToken(),u=l?`#${EX}=${encodeURIComponent(l)}`:"";return`${SX(n)}?${r1(o).slice(1)}${u}`}function SX({config:n}){return n.emulator?GI(n,wX):`https://${n.authDomain}/${vX}`}const oS="webStorageSupport";class TX{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=g6,this._completeRedirectFn=Yq,this._overrideRedirectResult=Wq}async _openPopup(e,t,r,i){Bl(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const s=await yM(e,t,r,CT(),i);return _X(e,s,WI())}async _openRedirect(e,t,r,i){await this._originValidation(e);const s=await yM(e,t,r,CT(),i);return Aq(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(Bl(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await dX(e),r=new Xq(e);return t.register("authEvent",i=>(Ht(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(oS,{type:oS},i=>{const s=i?.[0]?.[oS];s!==void 0&&t(!!s),qo(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=tX(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return i6()||QD()||UI()}}const bX=TX;var _M="@firebase/auth",xM="1.12.0";class IX{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Ht(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function AX(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function RX(n){zh(new cu("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=r.options;Ht(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:a,authDomain:o,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:s6(n)},u=new iq(r,i,s,l);return uq(u,t),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),zh(new cu("auth-internal",e=>{const t=s1(e.getProvider("auth").getImmediate());return(r=>new IX(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Fo(_M,xM,AX(n)),Fo(_M,xM,"esm2020")}const CX=300,PX=MD("authIdTokenMaxAge")||CX;let vM=null;const kX=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>PX)return;const i=t?.token;vM!==i&&(vM=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function MX(n=FI()){const e=Zv(n,"auth");if(e.isInitialized())return e.getImmediate();const t=cq(n,{popupRedirectResolver:bX,persistence:[Dq,Tq,g6]}),r=MD("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const a=kX(s.toString());wq(t,a,()=>a(t.currentUser)),vq(t,o=>a(o))}}const i=CD("auth");return i&&hq(t,`http://${i}`),t}function NX(){return document.getElementsByTagName("head")?.[0]??document}sq({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{const s=eo("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",NX().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});RX("Browser");var LX="firebase",OX="12.7.0";Fo(LX,OX,"app");var wM=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var iu,E6;(function(){var n;function e(k,C){function P(){}P.prototype=C.prototype,k.F=C.prototype,k.prototype=new P,k.prototype.constructor=k,k.D=function(L,O,U){for(var j=Array(arguments.length-2),Ie=2;Ie<arguments.length;Ie++)j[Ie-2]=arguments[Ie];return C.prototype[O].apply(L,j)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(k,C,P){P||(P=0);const L=Array(16);if(typeof C=="string")for(var O=0;O<16;++O)L[O]=C.charCodeAt(P++)|C.charCodeAt(P++)<<8|C.charCodeAt(P++)<<16|C.charCodeAt(P++)<<24;else for(O=0;O<16;++O)L[O]=C[P++]|C[P++]<<8|C[P++]<<16|C[P++]<<24;C=k.g[0],P=k.g[1],O=k.g[2];let U=k.g[3],j;j=C+(U^P&(O^U))+L[0]+3614090360&4294967295,C=P+(j<<7&4294967295|j>>>25),j=U+(O^C&(P^O))+L[1]+3905402710&4294967295,U=C+(j<<12&4294967295|j>>>20),j=O+(P^U&(C^P))+L[2]+606105819&4294967295,O=U+(j<<17&4294967295|j>>>15),j=P+(C^O&(U^C))+L[3]+3250441966&4294967295,P=O+(j<<22&4294967295|j>>>10),j=C+(U^P&(O^U))+L[4]+4118548399&4294967295,C=P+(j<<7&4294967295|j>>>25),j=U+(O^C&(P^O))+L[5]+1200080426&4294967295,U=C+(j<<12&4294967295|j>>>20),j=O+(P^U&(C^P))+L[6]+2821735955&4294967295,O=U+(j<<17&4294967295|j>>>15),j=P+(C^O&(U^C))+L[7]+4249261313&4294967295,P=O+(j<<22&4294967295|j>>>10),j=C+(U^P&(O^U))+L[8]+1770035416&4294967295,C=P+(j<<7&4294967295|j>>>25),j=U+(O^C&(P^O))+L[9]+2336552879&4294967295,U=C+(j<<12&4294967295|j>>>20),j=O+(P^U&(C^P))+L[10]+4294925233&4294967295,O=U+(j<<17&4294967295|j>>>15),j=P+(C^O&(U^C))+L[11]+2304563134&4294967295,P=O+(j<<22&4294967295|j>>>10),j=C+(U^P&(O^U))+L[12]+1804603682&4294967295,C=P+(j<<7&4294967295|j>>>25),j=U+(O^C&(P^O))+L[13]+4254626195&4294967295,U=C+(j<<12&4294967295|j>>>20),j=O+(P^U&(C^P))+L[14]+2792965006&4294967295,O=U+(j<<17&4294967295|j>>>15),j=P+(C^O&(U^C))+L[15]+1236535329&4294967295,P=O+(j<<22&4294967295|j>>>10),j=C+(O^U&(P^O))+L[1]+4129170786&4294967295,C=P+(j<<5&4294967295|j>>>27),j=U+(P^O&(C^P))+L[6]+3225465664&4294967295,U=C+(j<<9&4294967295|j>>>23),j=O+(C^P&(U^C))+L[11]+643717713&4294967295,O=U+(j<<14&4294967295|j>>>18),j=P+(U^C&(O^U))+L[0]+3921069994&4294967295,P=O+(j<<20&4294967295|j>>>12),j=C+(O^U&(P^O))+L[5]+3593408605&4294967295,C=P+(j<<5&4294967295|j>>>27),j=U+(P^O&(C^P))+L[10]+38016083&4294967295,U=C+(j<<9&4294967295|j>>>23),j=O+(C^P&(U^C))+L[15]+3634488961&4294967295,O=U+(j<<14&4294967295|j>>>18),j=P+(U^C&(O^U))+L[4]+3889429448&4294967295,P=O+(j<<20&4294967295|j>>>12),j=C+(O^U&(P^O))+L[9]+568446438&4294967295,C=P+(j<<5&4294967295|j>>>27),j=U+(P^O&(C^P))+L[14]+3275163606&4294967295,U=C+(j<<9&4294967295|j>>>23),j=O+(C^P&(U^C))+L[3]+4107603335&4294967295,O=U+(j<<14&4294967295|j>>>18),j=P+(U^C&(O^U))+L[8]+1163531501&4294967295,P=O+(j<<20&4294967295|j>>>12),j=C+(O^U&(P^O))+L[13]+2850285829&4294967295,C=P+(j<<5&4294967295|j>>>27),j=U+(P^O&(C^P))+L[2]+4243563512&4294967295,U=C+(j<<9&4294967295|j>>>23),j=O+(C^P&(U^C))+L[7]+1735328473&4294967295,O=U+(j<<14&4294967295|j>>>18),j=P+(U^C&(O^U))+L[12]+2368359562&4294967295,P=O+(j<<20&4294967295|j>>>12),j=C+(P^O^U)+L[5]+4294588738&4294967295,C=P+(j<<4&4294967295|j>>>28),j=U+(C^P^O)+L[8]+2272392833&4294967295,U=C+(j<<11&4294967295|j>>>21),j=O+(U^C^P)+L[11]+1839030562&4294967295,O=U+(j<<16&4294967295|j>>>16),j=P+(O^U^C)+L[14]+4259657740&4294967295,P=O+(j<<23&4294967295|j>>>9),j=C+(P^O^U)+L[1]+2763975236&4294967295,C=P+(j<<4&4294967295|j>>>28),j=U+(C^P^O)+L[4]+1272893353&4294967295,U=C+(j<<11&4294967295|j>>>21),j=O+(U^C^P)+L[7]+4139469664&4294967295,O=U+(j<<16&4294967295|j>>>16),j=P+(O^U^C)+L[10]+3200236656&4294967295,P=O+(j<<23&4294967295|j>>>9),j=C+(P^O^U)+L[13]+681279174&4294967295,C=P+(j<<4&4294967295|j>>>28),j=U+(C^P^O)+L[0]+3936430074&4294967295,U=C+(j<<11&4294967295|j>>>21),j=O+(U^C^P)+L[3]+3572445317&4294967295,O=U+(j<<16&4294967295|j>>>16),j=P+(O^U^C)+L[6]+76029189&4294967295,P=O+(j<<23&4294967295|j>>>9),j=C+(P^O^U)+L[9]+3654602809&4294967295,C=P+(j<<4&4294967295|j>>>28),j=U+(C^P^O)+L[12]+3873151461&4294967295,U=C+(j<<11&4294967295|j>>>21),j=O+(U^C^P)+L[15]+530742520&4294967295,O=U+(j<<16&4294967295|j>>>16),j=P+(O^U^C)+L[2]+3299628645&4294967295,P=O+(j<<23&4294967295|j>>>9),j=C+(O^(P|~U))+L[0]+4096336452&4294967295,C=P+(j<<6&4294967295|j>>>26),j=U+(P^(C|~O))+L[7]+1126891415&4294967295,U=C+(j<<10&4294967295|j>>>22),j=O+(C^(U|~P))+L[14]+2878612391&4294967295,O=U+(j<<15&4294967295|j>>>17),j=P+(U^(O|~C))+L[5]+4237533241&4294967295,P=O+(j<<21&4294967295|j>>>11),j=C+(O^(P|~U))+L[12]+1700485571&4294967295,C=P+(j<<6&4294967295|j>>>26),j=U+(P^(C|~O))+L[3]+2399980690&4294967295,U=C+(j<<10&4294967295|j>>>22),j=O+(C^(U|~P))+L[10]+4293915773&4294967295,O=U+(j<<15&4294967295|j>>>17),j=P+(U^(O|~C))+L[1]+2240044497&4294967295,P=O+(j<<21&4294967295|j>>>11),j=C+(O^(P|~U))+L[8]+1873313359&4294967295,C=P+(j<<6&4294967295|j>>>26),j=U+(P^(C|~O))+L[15]+4264355552&4294967295,U=C+(j<<10&4294967295|j>>>22),j=O+(C^(U|~P))+L[6]+2734768916&4294967295,O=U+(j<<15&4294967295|j>>>17),j=P+(U^(O|~C))+L[13]+1309151649&4294967295,P=O+(j<<21&4294967295|j>>>11),j=C+(O^(P|~U))+L[4]+4149444226&4294967295,C=P+(j<<6&4294967295|j>>>26),j=U+(P^(C|~O))+L[11]+3174756917&4294967295,U=C+(j<<10&4294967295|j>>>22),j=O+(C^(U|~P))+L[2]+718787259&4294967295,O=U+(j<<15&4294967295|j>>>17),j=P+(U^(O|~C))+L[9]+3951481745&4294967295,k.g[0]=k.g[0]+C&4294967295,k.g[1]=k.g[1]+(O+(j<<21&4294967295|j>>>11))&4294967295,k.g[2]=k.g[2]+O&4294967295,k.g[3]=k.g[3]+U&4294967295}r.prototype.v=function(k,C){C===void 0&&(C=k.length);const P=C-this.blockSize,L=this.C;let O=this.h,U=0;for(;U<C;){if(O==0)for(;U<=P;)i(this,k,U),U+=this.blockSize;if(typeof k=="string"){for(;U<C;)if(L[O++]=k.charCodeAt(U++),O==this.blockSize){i(this,L),O=0;break}}else for(;U<C;)if(L[O++]=k[U++],O==this.blockSize){i(this,L),O=0;break}}this.h=O,this.o+=C},r.prototype.A=function(){var k=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);k[0]=128;for(var C=1;C<k.length-8;++C)k[C]=0;C=this.o*8;for(var P=k.length-8;P<k.length;++P)k[P]=C&255,C/=256;for(this.v(k),k=Array(16),C=0,P=0;P<4;++P)for(let L=0;L<32;L+=8)k[C++]=this.g[P]>>>L&255;return k};function s(k,C){var P=o;return Object.prototype.hasOwnProperty.call(P,k)?P[k]:P[k]=C(k)}function a(k,C){this.h=C;const P=[];let L=!0;for(let O=k.length-1;O>=0;O--){const U=k[O]|0;L&&U==C||(P[O]=U,L=!1)}this.g=P}var o={};function l(k){return-128<=k&&k<128?s(k,function(C){return new a([C|0],C<0?-1:0)}):new a([k|0],k<0?-1:0)}function u(k){if(isNaN(k)||!isFinite(k))return f;if(k<0)return E(u(-k));const C=[];let P=1;for(let L=0;k>=P;L++)C[L]=k/P|0,P*=4294967296;return new a(C,0)}function h(k,C){if(k.length==0)throw Error("number format error: empty string");if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(k.charAt(0)=="-")return E(h(k.substring(1),C));if(k.indexOf("-")>=0)throw Error('number format error: interior "-" character');const P=u(Math.pow(C,8));let L=f;for(let U=0;U<k.length;U+=8){var O=Math.min(8,k.length-U);const j=parseInt(k.substring(U,U+O),C);O<8?(O=u(Math.pow(C,O)),L=L.j(O).add(u(j))):(L=L.j(P),L=L.add(u(j)))}return L}var f=l(0),g=l(1),y=l(16777216);n=a.prototype,n.m=function(){if(x(this))return-E(this).m();let k=0,C=1;for(let P=0;P<this.g.length;P++){const L=this.i(P);k+=(L>=0?L:4294967296+L)*C,C*=4294967296}return k},n.toString=function(k){if(k=k||10,k<2||36<k)throw Error("radix out of range: "+k);if(v(this))return"0";if(x(this))return"-"+E(this).toString(k);const C=u(Math.pow(k,6));var P=this;let L="";for(;;){const O=M(P,C).g;P=T(P,O.j(C));let U=((P.g.length>0?P.g[0]:P.h)>>>0).toString(k);if(P=O,v(P))return U+L;for(;U.length<6;)U="0"+U;L=U+L}},n.i=function(k){return k<0?0:k<this.g.length?this.g[k]:this.h};function v(k){if(k.h!=0)return!1;for(let C=0;C<k.g.length;C++)if(k.g[C]!=0)return!1;return!0}function x(k){return k.h==-1}n.l=function(k){return k=T(this,k),x(k)?-1:v(k)?0:1};function E(k){const C=k.g.length,P=[];for(let L=0;L<C;L++)P[L]=~k.g[L];return new a(P,~k.h).add(g)}n.abs=function(){return x(this)?E(this):this},n.add=function(k){const C=Math.max(this.g.length,k.g.length),P=[];let L=0;for(let O=0;O<=C;O++){let U=L+(this.i(O)&65535)+(k.i(O)&65535),j=(U>>>16)+(this.i(O)>>>16)+(k.i(O)>>>16);L=j>>>16,U&=65535,j&=65535,P[O]=j<<16|U}return new a(P,P[P.length-1]&-2147483648?-1:0)};function T(k,C){return k.add(E(C))}n.j=function(k){if(v(this)||v(k))return f;if(x(this))return x(k)?E(this).j(E(k)):E(E(this).j(k));if(x(k))return E(this.j(E(k)));if(this.l(y)<0&&k.l(y)<0)return u(this.m()*k.m());const C=this.g.length+k.g.length,P=[];for(var L=0;L<2*C;L++)P[L]=0;for(L=0;L<this.g.length;L++)for(let O=0;O<k.g.length;O++){const U=this.i(L)>>>16,j=this.i(L)&65535,Ie=k.i(O)>>>16,ke=k.i(O)&65535;P[2*L+2*O]+=j*ke,b(P,2*L+2*O),P[2*L+2*O+1]+=U*ke,b(P,2*L+2*O+1),P[2*L+2*O+1]+=j*Ie,b(P,2*L+2*O+1),P[2*L+2*O+2]+=U*Ie,b(P,2*L+2*O+2)}for(k=0;k<C;k++)P[k]=P[2*k+1]<<16|P[2*k];for(k=C;k<2*C;k++)P[k]=0;return new a(P,0)};function b(k,C){for(;(k[C]&65535)!=k[C];)k[C+1]+=k[C]>>>16,k[C]&=65535,C++}function I(k,C){this.g=k,this.h=C}function M(k,C){if(v(C))throw Error("division by zero");if(v(k))return new I(f,f);if(x(k))return C=M(E(k),C),new I(E(C.g),E(C.h));if(x(C))return C=M(k,E(C)),new I(E(C.g),C.h);if(k.g.length>30){if(x(k)||x(C))throw Error("slowDivide_ only works with positive integers.");for(var P=g,L=C;L.l(k)<=0;)P=F(P),L=F(L);var O=z(P,1),U=z(L,1);for(L=z(L,2),P=z(P,2);!v(L);){var j=U.add(L);j.l(k)<=0&&(O=O.add(P),U=j),L=z(L,1),P=z(P,1)}return C=T(k,O.j(C)),new I(O,C)}for(O=f;k.l(C)>=0;){for(P=Math.max(1,Math.floor(k.m()/C.m())),L=Math.ceil(Math.log(P)/Math.LN2),L=L<=48?1:Math.pow(2,L-48),U=u(P),j=U.j(C);x(j)||j.l(k)>0;)P-=L,U=u(P),j=U.j(C);v(U)&&(U=g),O=O.add(U),k=T(k,j)}return new I(O,k)}n.B=function(k){return M(this,k).h},n.and=function(k){const C=Math.max(this.g.length,k.g.length),P=[];for(let L=0;L<C;L++)P[L]=this.i(L)&k.i(L);return new a(P,this.h&k.h)},n.or=function(k){const C=Math.max(this.g.length,k.g.length),P=[];for(let L=0;L<C;L++)P[L]=this.i(L)|k.i(L);return new a(P,this.h|k.h)},n.xor=function(k){const C=Math.max(this.g.length,k.g.length),P=[];for(let L=0;L<C;L++)P[L]=this.i(L)^k.i(L);return new a(P,this.h^k.h)};function F(k){const C=k.g.length+1,P=[];for(let L=0;L<C;L++)P[L]=k.i(L)<<1|k.i(L-1)>>>31;return new a(P,k.h)}function z(k,C){const P=C>>5;C%=32;const L=k.g.length-P,O=[];for(let U=0;U<L;U++)O[U]=C>0?k.i(U+P)>>>C|k.i(U+P+1)<<32-C:k.i(U+P);return new a(O,k.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,E6=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.B,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=u,a.fromString=h,iu=a}).apply(typeof wM<"u"?wM:typeof self<"u"?self:typeof window<"u"?window:{});var Zy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var S6,em,T6,k_,MT,b6,I6,A6;(function(){var n,e=Object.defineProperty;function t(_){_=[typeof globalThis=="object"&&globalThis,_,typeof window=="object"&&window,typeof self=="object"&&self,typeof Zy=="object"&&Zy];for(var R=0;R<_.length;++R){var D=_[R];if(D&&D.Math==Math)return D}throw Error("Cannot find global object")}var r=t(this);function i(_,R){if(R)e:{var D=r;_=_.split(".");for(var H=0;H<_.length-1;H++){var ge=_[H];if(!(ge in D))break e;D=D[ge]}_=_[_.length-1],H=D[_],R=R(H),R!=H&&R!=null&&e(D,_,{configurable:!0,writable:!0,value:R})}}i("Symbol.dispose",function(_){return _||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(_){return _||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(_){return _||function(R){var D=[],H;for(H in R)Object.prototype.hasOwnProperty.call(R,H)&&D.push([H,R[H]]);return D}});var s=s||{},a=this||self;function o(_){var R=typeof _;return R=="object"&&_!=null||R=="function"}function l(_,R,D){return _.call.apply(_.bind,arguments)}function u(_,R,D){return u=l,u.apply(null,arguments)}function h(_,R){var D=Array.prototype.slice.call(arguments,1);return function(){var H=D.slice();return H.push.apply(H,arguments),_.apply(this,H)}}function f(_,R){function D(){}D.prototype=R.prototype,_.Z=R.prototype,_.prototype=new D,_.prototype.constructor=_,_.Ob=function(H,ge,Ae){for(var it=Array(arguments.length-2),Zt=2;Zt<arguments.length;Zt++)it[Zt-2]=arguments[Zt];return R.prototype[ge].apply(H,it)}}var g=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?_=>_&&AsyncContext.Snapshot.wrap(_):_=>_;function y(_){const R=_.length;if(R>0){const D=Array(R);for(let H=0;H<R;H++)D[H]=_[H];return D}return[]}function v(_,R){for(let H=1;H<arguments.length;H++){const ge=arguments[H];var D=typeof ge;if(D=D!="object"?D:ge?Array.isArray(ge)?"array":D:"null",D=="array"||D=="object"&&typeof ge.length=="number"){D=_.length||0;const Ae=ge.length||0;_.length=D+Ae;for(let it=0;it<Ae;it++)_[D+it]=ge[it]}else _.push(ge)}}class x{constructor(R,D){this.i=R,this.j=D,this.h=0,this.g=null}get(){let R;return this.h>0?(this.h--,R=this.g,this.g=R.next,R.next=null):R=this.i(),R}}function E(_){a.setTimeout(()=>{throw _},0)}function T(){var _=k;let R=null;return _.g&&(R=_.g,_.g=_.g.next,_.g||(_.h=null),R.next=null),R}class b{constructor(){this.h=this.g=null}add(R,D){const H=I.get();H.set(R,D),this.h?this.h.next=H:this.g=H,this.h=H}}var I=new x(()=>new M,_=>_.reset());class M{constructor(){this.next=this.g=this.h=null}set(R,D){this.h=R,this.g=D,this.next=null}reset(){this.next=this.g=this.h=null}}let F,z=!1,k=new b,C=()=>{const _=Promise.resolve(void 0);F=()=>{_.then(P)}};function P(){for(var _;_=T();){try{_.h.call(_.g)}catch(D){E(D)}var R=I;R.j(_),R.h<100&&(R.h++,_.next=R.g,R.g=_)}z=!1}function L(){this.u=this.u,this.C=this.C}L.prototype.u=!1,L.prototype.dispose=function(){this.u||(this.u=!0,this.N())},L.prototype[Symbol.dispose]=function(){this.dispose()},L.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function O(_,R){this.type=_,this.g=this.target=R,this.defaultPrevented=!1}O.prototype.h=function(){this.defaultPrevented=!0};var U=(function(){if(!a.addEventListener||!Object.defineProperty)return!1;var _=!1,R=Object.defineProperty({},"passive",{get:function(){_=!0}});try{const D=()=>{};a.addEventListener("test",D,R),a.removeEventListener("test",D,R)}catch{}return _})();function j(_){return/^[\s\xa0]*$/.test(_)}function Ie(_,R){O.call(this,_?_.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,_&&this.init(_,R)}f(Ie,O),Ie.prototype.init=function(_,R){const D=this.type=_.type,H=_.changedTouches&&_.changedTouches.length?_.changedTouches[0]:null;this.target=_.target||_.srcElement,this.g=R,R=_.relatedTarget,R||(D=="mouseover"?R=_.fromElement:D=="mouseout"&&(R=_.toElement)),this.relatedTarget=R,H?(this.clientX=H.clientX!==void 0?H.clientX:H.pageX,this.clientY=H.clientY!==void 0?H.clientY:H.pageY,this.screenX=H.screenX||0,this.screenY=H.screenY||0):(this.clientX=_.clientX!==void 0?_.clientX:_.pageX,this.clientY=_.clientY!==void 0?_.clientY:_.pageY,this.screenX=_.screenX||0,this.screenY=_.screenY||0),this.button=_.button,this.key=_.key||"",this.ctrlKey=_.ctrlKey,this.altKey=_.altKey,this.shiftKey=_.shiftKey,this.metaKey=_.metaKey,this.pointerId=_.pointerId||0,this.pointerType=_.pointerType,this.state=_.state,this.i=_,_.defaultPrevented&&Ie.Z.h.call(this)},Ie.prototype.h=function(){Ie.Z.h.call(this);const _=this.i;_.preventDefault?_.preventDefault():_.returnValue=!1};var ke="closure_listenable_"+(Math.random()*1e6|0),ze=0;function Ne(_,R,D,H,ge){this.listener=_,this.proxy=null,this.src=R,this.type=D,this.capture=!!H,this.ha=ge,this.key=++ze,this.da=this.fa=!1}function ce(_){_.da=!0,_.listener=null,_.proxy=null,_.src=null,_.ha=null}function Te(_,R,D){for(const H in _)R.call(D,_[H],H,_)}function Ee(_,R){for(const D in _)R.call(void 0,_[D],D,_)}function se(_){const R={};for(const D in _)R[D]=_[D];return R}const V="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function J(_,R){let D,H;for(let ge=1;ge<arguments.length;ge++){H=arguments[ge];for(D in H)_[D]=H[D];for(let Ae=0;Ae<V.length;Ae++)D=V[Ae],Object.prototype.hasOwnProperty.call(H,D)&&(_[D]=H[D])}}function ne(_){this.src=_,this.g={},this.h=0}ne.prototype.add=function(_,R,D,H,ge){const Ae=_.toString();_=this.g[Ae],_||(_=this.g[Ae]=[],this.h++);const it=ue(_,R,H,ge);return it>-1?(R=_[it],D||(R.fa=!1)):(R=new Ne(R,this.src,Ae,!!H,ge),R.fa=D,_.push(R)),R};function X(_,R){const D=R.type;if(D in _.g){var H=_.g[D],ge=Array.prototype.indexOf.call(H,R,void 0),Ae;(Ae=ge>=0)&&Array.prototype.splice.call(H,ge,1),Ae&&(ce(R),_.g[D].length==0&&(delete _.g[D],_.h--))}}function ue(_,R,D,H){for(let ge=0;ge<_.length;++ge){const Ae=_[ge];if(!Ae.da&&Ae.listener==R&&Ae.capture==!!D&&Ae.ha==H)return ge}return-1}var Me="closure_lm_"+(Math.random()*1e6|0),je={};function De(_,R,D,H,ge){if(Array.isArray(R)){for(let Ae=0;Ae<R.length;Ae++)De(_,R[Ae],D,H,ge);return null}return D=Xn(D),_&&_[ke]?_.J(R,D,o(H)?!!H.capture:!1,ge):Be(_,R,D,!1,H,ge)}function Be(_,R,D,H,ge,Ae){if(!R)throw Error("Invalid event type");const it=o(ge)?!!ge.capture:!!ge;let Zt=Qt(_);if(Zt||(_[Me]=Zt=new ne(_)),D=Zt.add(R,D,H,it,Ae),D.proxy)return D;if(H=Gt(),D.proxy=H,H.src=_,H.listener=D,_.addEventListener)U||(ge=it),ge===void 0&&(ge=!1),_.addEventListener(R.toString(),H,ge);else if(_.attachEvent)_.attachEvent(Bt(R.toString()),H);else if(_.addListener&&_.removeListener)_.addListener(H);else throw Error("addEventListener and attachEvent are unavailable.");return D}function Gt(){function _(D){return R.call(_.src,_.listener,D)}const R=Fn;return _}function Kt(_,R,D,H,ge){if(Array.isArray(R))for(var Ae=0;Ae<R.length;Ae++)Kt(_,R[Ae],D,H,ge);else H=o(H)?!!H.capture:!!H,D=Xn(D),_&&_[ke]?(_=_.i,Ae=String(R).toString(),Ae in _.g&&(R=_.g[Ae],D=ue(R,D,H,ge),D>-1&&(ce(R[D]),Array.prototype.splice.call(R,D,1),R.length==0&&(delete _.g[Ae],_.h--)))):_&&(_=Qt(_))&&(R=_.g[R.toString()],_=-1,R&&(_=ue(R,D,H,ge)),(D=_>-1?R[_]:null)&&wn(D))}function wn(_){if(typeof _!="number"&&_&&!_.da){var R=_.src;if(R&&R[ke])X(R.i,_);else{var D=_.type,H=_.proxy;R.removeEventListener?R.removeEventListener(D,H,_.capture):R.detachEvent?R.detachEvent(Bt(D),H):R.addListener&&R.removeListener&&R.removeListener(H),(D=Qt(R))?(X(D,_),D.h==0&&(D.src=null,R[Me]=null)):ce(_)}}}function Bt(_){return _ in je?je[_]:je[_]="on"+_}function Fn(_,R){if(_.da)_=!0;else{R=new Ie(R,this);const D=_.listener,H=_.ha||_.src;_.fa&&wn(_),_=D.call(H,R)}return _}function Qt(_){return _=_[Me],_ instanceof ne?_:null}var ot="__closure_events_fn_"+(Math.random()*1e9>>>0);function Xn(_){return typeof _=="function"?_:(_[ot]||(_[ot]=function(R){return _.handleEvent(R)}),_[ot])}function on(){L.call(this),this.i=new ne(this),this.M=this,this.G=null}f(on,L),on.prototype[ke]=!0,on.prototype.removeEventListener=function(_,R,D,H){Kt(this,_,R,D,H)};function en(_,R){var D,H=_.G;if(H)for(D=[];H;H=H.G)D.push(H);if(_=_.M,H=R.type||R,typeof R=="string")R=new O(R,_);else if(R instanceof O)R.target=R.target||_;else{var ge=R;R=new O(H,_),J(R,ge)}ge=!0;let Ae,it;if(D)for(it=D.length-1;it>=0;it--)Ae=R.g=D[it],ge=Zn(Ae,H,!0,R)&&ge;if(Ae=R.g=_,ge=Zn(Ae,H,!0,R)&&ge,ge=Zn(Ae,H,!1,R)&&ge,D)for(it=0;it<D.length;it++)Ae=R.g=D[it],ge=Zn(Ae,H,!1,R)&&ge}on.prototype.N=function(){if(on.Z.N.call(this),this.i){var _=this.i;for(const R in _.g){const D=_.g[R];for(let H=0;H<D.length;H++)ce(D[H]);delete _.g[R],_.h--}}this.G=null},on.prototype.J=function(_,R,D,H){return this.i.add(String(_),R,!1,D,H)},on.prototype.K=function(_,R,D,H){return this.i.add(String(_),R,!0,D,H)};function Zn(_,R,D,H){if(R=_.i.g[String(R)],!R)return!0;R=R.concat();let ge=!0;for(let Ae=0;Ae<R.length;++Ae){const it=R[Ae];if(it&&!it.da&&it.capture==D){const Zt=it.listener,kr=it.ha||it.src;it.fa&&X(_.i,it),ge=Zt.call(kr,H)!==!1&&ge}}return ge&&!H.defaultPrevented}function gt(_,R){if(typeof _!="function")if(_&&typeof _.handleEvent=="function")_=u(_.handleEvent,_);else throw Error("Invalid listener argument");return Number(R)>2147483647?-1:a.setTimeout(_,R||0)}function jt(_){_.g=gt(()=>{_.g=null,_.i&&(_.i=!1,jt(_))},_.l);const R=_.h;_.h=null,_.m.apply(null,R)}class kn extends L{constructor(R,D){super(),this.m=R,this.l=D,this.h=null,this.i=!1,this.g=null}j(R){this.h=arguments,this.g?this.i=!0:jt(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function yt(_){L.call(this),this.h=_,this.g={}}f(yt,L);var Jt=[];function Rt(_){Te(_.g,function(R,D){this.g.hasOwnProperty(D)&&wn(R)},_),_.g={}}yt.prototype.N=function(){yt.Z.N.call(this),Rt(this)},yt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var rr=a.JSON.stringify,si=a.JSON.parse,Vr=class{stringify(_){return a.JSON.stringify(_,void 0)}parse(_){return a.JSON.parse(_,void 0)}};function Ut(){}function Ji(){}var Oe={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function ve(){O.call(this,"d")}f(ve,O);function me(){O.call(this,"c")}f(me,O);var Ct={},N=null;function Pt(){return N=N||new on}Ct.Ia="serverreachability";function W(_){O.call(this,Ct.Ia,_)}f(W,O);function Z(_){const R=Pt();en(R,new W(R))}Ct.STAT_EVENT="statevent";function q(_,R){O.call(this,Ct.STAT_EVENT,_),this.stat=R}f(q,O);function le(_){const R=Pt();en(R,new q(R,_))}Ct.Ja="timingevent";function he(_,R){O.call(this,Ct.Ja,_),this.size=R}f(he,O);function Ve(_,R){if(typeof _!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){_()},R)}function Se(){this.g=!0}Se.prototype.ua=function(){this.g=!1};function $e(_,R,D,H,ge,Ae){_.info(function(){if(_.g)if(Ae){var it="",Zt=Ae.split("&");for(let Vn=0;Vn<Zt.length;Vn++){var kr=Zt[Vn].split("=");if(kr.length>1){const Gr=kr[0];kr=kr[1];const Fs=Gr.split("_");it=Fs.length>=2&&Fs[1]=="type"?it+(Gr+"="+kr+"&"):it+(Gr+"=redacted&")}}}else it=null;else it=Ae;return"XMLHTTP REQ ("+H+") [attempt "+ge+"]: "+R+`
`+D+`
`+it})}function et(_,R,D,H,ge,Ae,it){_.info(function(){return"XMLHTTP RESP ("+H+") [ attempt "+ge+"]: "+R+`
`+D+`
`+Ae+" "+it})}function dt(_,R,D,H){_.info(function(){return"XMLHTTP TEXT ("+R+"): "+sn(_,D)+(H?" "+H:"")})}function St(_,R){_.info(function(){return"TIMEOUT: "+R})}Se.prototype.info=function(){};function sn(_,R){if(!_.g)return R;if(!R)return null;try{const Ae=JSON.parse(R);if(Ae){for(_=0;_<Ae.length;_++)if(Array.isArray(Ae[_])){var D=Ae[_];if(!(D.length<2)){var H=D[1];if(Array.isArray(H)&&!(H.length<1)){var ge=H[0];if(ge!="noop"&&ge!="stop"&&ge!="close")for(let it=1;it<H.length;it++)H[it]=""}}}}return rr(Ae)}catch{return R}}var ur={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},cn={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},hr;function pr(){}f(pr,Ut),pr.prototype.g=function(){return new XMLHttpRequest},hr=new pr;function Ni(_){return encodeURIComponent(String(_))}function B(_){var R=1;_=_.split(":");const D=[];for(;R>0&&_.length;)D.push(_.shift()),R--;return _.length&&D.push(_.join(":")),D}function Q(_,R,D,H){this.j=_,this.i=R,this.l=D,this.S=H||1,this.V=new yt(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new K}function K(){this.i=null,this.g="",this.h=!1}var Y={},ee={};function te(_,R,D){_.M=1,_.A=il(sa(R)),_.u=D,_.R=!0,ye(_,null)}function ye(_,R){_.F=Date.now(),we(_),_.B=sa(_.A);var D=_.B,H=_.S;Array.isArray(H)||(H=[String(H)]),ng(D.i,"t",H),_.C=0,D=_.j.L,_.h=new K,_.g=B1(_.j,D?R:null,!_.u),_.P>0&&(_.O=new kn(u(_.Y,_,_.g),_.P)),R=_.V,D=_.g,H=_.ba;var ge="readystatechange";Array.isArray(ge)||(ge&&(Jt[0]=ge.toString()),ge=Jt);for(let Ae=0;Ae<ge.length;Ae++){const it=De(D,ge[Ae],H||R.handleEvent,!1,R.h||R);if(!it)break;R.g[it.key]=it}R=_.J?se(_.J):{},_.u?(_.v||(_.v="POST"),R["Content-Type"]="application/x-www-form-urlencoded",_.g.ea(_.B,_.v,_.u,R)):(_.v="GET",_.g.ea(_.B,_.v,null,R)),Z(),$e(_.i,_.v,_.B,_.l,_.S,_.u)}Q.prototype.ba=function(_){_=_.target;const R=this.O;R&&_o(_)==3?R.j():this.Y(_)},Q.prototype.Y=function(_){try{if(_==this.g)e:{const Zt=_o(this.g),kr=this.g.ya(),Vn=this.g.ca();if(!(Zt<3)&&(Zt!=3||this.g&&(this.h.h||this.g.la()||V1(this.g)))){this.K||Zt!=4||kr==7||(kr==8||Vn<=0?Z(3):Z(2)),tt(this);var R=this.g.ca();this.X=R;var D=Ce(this);if(this.o=R==200,et(this.i,this.v,this.B,this.l,this.S,Zt,R),this.o){if(this.U&&!this.L){t:{if(this.g){var H,ge=this.g;if((H=ge.g?ge.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!j(H)){var Ae=H;break t}}Ae=null}if(_=Ae)dt(this.i,this.l,_,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,qe(this,_);else{this.o=!1,this.m=3,le(12),Ye(this),ft(this);break e}}if(this.R){_=!0;let Gr;for(;!this.K&&this.C<D.length;)if(Gr=xe(this,D),Gr==ee){Zt==4&&(this.m=4,le(14),_=!1),dt(this.i,this.l,null,"[Incomplete Response]");break}else if(Gr==Y){this.m=4,le(15),dt(this.i,this.l,D,"[Invalid Chunk]"),_=!1;break}else dt(this.i,this.l,Gr,null),qe(this,Gr);if(pe(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Zt!=4||D.length!=0||this.h.h||(this.m=1,le(16),_=!1),this.o=this.o&&_,!_)dt(this.i,this.l,D,"[Invalid Chunked Response]"),Ye(this),ft(this);else if(D.length>0&&!this.W){this.W=!0;var it=this.j;it.g==this&&it.aa&&!it.P&&(it.j.info("Great, no buffering proxy detected. Bytes received: "+D.length),Fu(it),it.P=!0,le(11))}}else dt(this.i,this.l,D,null),qe(this,D);Zt==4&&Ye(this),this.o&&!this.K&&(Zt==4?Pd(this.j,this):(this.o=!1,we(this)))}else ig(this.g),R==400&&D.indexOf("Unknown SID")>0?(this.m=3,le(12)):(this.m=0,le(13)),Ye(this),ft(this)}}}catch{}};function Ce(_){if(!pe(_))return _.g.la();const R=V1(_.g);if(R==="")return"";let D="";const H=R.length,ge=_o(_.g)==4;if(!_.h.i){if(typeof TextDecoder>"u")return Ye(_),ft(_),"";_.h.i=new a.TextDecoder}for(let Ae=0;Ae<H;Ae++)_.h.h=!0,D+=_.h.i.decode(R[Ae],{stream:!(ge&&Ae==H-1)});return R.length=0,_.h.g+=D,_.C=0,_.h.g}function pe(_){return _.g?_.v=="GET"&&_.M!=2&&_.j.Aa:!1}function xe(_,R){var D=_.C,H=R.indexOf(`
`,D);return H==-1?ee:(D=Number(R.substring(D,H)),isNaN(D)?Y:(H+=1,H+D>R.length?ee:(R=R.slice(H,H+D),_.C=H+D,R)))}Q.prototype.cancel=function(){this.K=!0,Ye(this)};function we(_){_.T=Date.now()+_.H,Ke(_,_.H)}function Ke(_,R){if(_.D!=null)throw Error("WatchDog timer not null");_.D=Ve(u(_.aa,_),R)}function tt(_){_.D&&(a.clearTimeout(_.D),_.D=null)}Q.prototype.aa=function(){this.D=null;const _=Date.now();_-this.T>=0?(St(this.i,this.B),this.M!=2&&(Z(),le(17)),Ye(this),this.m=2,ft(this)):Ke(this,this.T-_)};function ft(_){_.j.I==0||_.K||Pd(_.j,_)}function Ye(_){tt(_);var R=_.O;R&&typeof R.dispose=="function"&&R.dispose(),_.O=null,Rt(_.V),_.g&&(R=_.g,_.g=null,R.abort(),R.dispose())}function qe(_,R){try{var D=_.j;if(D.I!=0&&(D.g==_||Pa(D.h,_))){if(!_.L&&Pa(D.h,_)&&D.I==3){try{var H=D.Ba.g.parse(R)}catch{H=null}if(Array.isArray(H)&&H.length==3){var ge=H;if(ge[0]==0){e:if(!D.v){if(D.g)if(D.g.F+3e3<_.F)Cd(D),Os(D);else break e;wo(D),le(18)}}else D.xa=ge[1],0<D.xa-D.K&&ge[2]<37500&&D.F&&D.A==0&&!D.C&&(D.C=Ve(u(D.Va,D),6e3));dr(D.h)<=1&&D.ta&&(D.ta=void 0)}else Ds(D,11)}else if((_.L||D.g==_)&&Cd(D),!j(R))for(ge=D.Ba.g.parse(R),R=0;R<ge.length;R++){let Vn=ge[R];const Gr=Vn[0];if(!(Gr<=D.K))if(D.K=Gr,Vn=Vn[1],D.I==2)if(Vn[0]=="c"){D.M=Vn[1],D.ba=Vn[2];const Fs=Vn[3];Fs!=null&&(D.ka=Fs,D.j.info("VER="+D.ka));const cl=Vn[4];cl!=null&&(D.za=cl,D.j.info("SVER="+D.za));const Eo=Vn[5];Eo!=null&&typeof Eo=="number"&&Eo>0&&(H=1.5*Eo,D.O=H,D.j.info("backChannelRequestTimeoutMs_="+H)),H=D;const So=_.g;if(So){const Nd=So.g?So.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Nd){var Ae=H.h;Ae.g||Nd.indexOf("spdy")==-1&&Nd.indexOf("quic")==-1&&Nd.indexOf("h2")==-1||(Ae.j=Ae.l,Ae.g=new Set,Ae.h&&(ia(Ae,Ae.h),Ae.h=null))}if(H.G){const og=So.g?So.g.getResponseHeader("X-HTTP-Session-Id"):null;og&&(H.wa=og,In(H.J,H.G,og))}}D.I=3,D.l&&D.l.ra(),D.aa&&(D.T=Date.now()-_.F,D.j.info("Handshake RTT: "+D.T+"ms")),H=D;var it=_;if(H.na=ag(H,H.L?H.ba:null,H.W),it.L){Ns(H.h,it);var Zt=it,kr=H.O;kr&&(Zt.H=kr),Zt.D&&(tt(Zt),we(Zt)),H.g=it}else Li(H);D.i.length>0&&ll(D)}else Vn[0]!="stop"&&Vn[0]!="close"||Ds(D,7);else D.I==3&&(Vn[0]=="stop"||Vn[0]=="close"?Vn[0]=="stop"?Ds(D,7):Ad(D):Vn[0]!="noop"&&D.l&&D.l.qa(Vn),D.A=0)}}Z(4)}catch{}}var zt=class{constructor(_,R){this.g=_,this.map=R}};function Mn(_){this.l=_||10,a.PerformanceNavigationTiming?(_=a.performance.getEntriesByType("navigation"),_=_.length>0&&(_[0].nextHopProtocol=="hq"||_[0].nextHopProtocol=="h2")):_=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=_?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function jn(_){return _.h?!0:_.g?_.g.size>=_.j:!1}function dr(_){return _.h?1:_.g?_.g.size:0}function Pa(_,R){return _.h?_.h==R:_.g?_.g.has(R):!1}function ia(_,R){_.g?_.g.add(R):_.h=R}function Ns(_,R){_.h&&_.h==R?_.h=null:_.g&&_.g.has(R)&&_.g.delete(R)}Mn.prototype.cancel=function(){if(this.i=Pr(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const _ of this.g.values())_.cancel();this.g.clear()}};function Pr(_){if(_.h!=null)return _.i.concat(_.h.G);if(_.g!=null&&_.g.size!==0){let R=_.i;for(const D of _.g.values())R=R.concat(D.G);return R}return y(_.i)}var tc=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function yr(_,R){if(_){_=_.split("&");for(let D=0;D<_.length;D++){const H=_[D].indexOf("=");let ge,Ae=null;H>=0?(ge=_[D].substring(0,H),Ae=_[D].substring(H+1)):ge=_[D],R(ge,Ae?decodeURIComponent(Ae.replace(/\+/g," ")):"")}}}function ho(_){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let R;_ instanceof ho?(this.l=_.l,ku(this,_.j),this.o=_.o,this.g=_.g,fo(this,_.u),this.h=_.h,nc(this,rg(_.i)),this.m=_.m):_&&(R=String(_).match(tc))?(this.l=!1,ku(this,R[1]||"",!0),this.o=Mu(R[2]||""),this.g=Mu(R[3]||"",!0),fo(this,R[4]),this.h=Mu(R[5]||"",!0),nc(this,R[6]||"",!0),this.m=Mu(R[7]||"")):(this.l=!1,this.i=new gn(null,this.l))}ho.prototype.toString=function(){const _=[];var R=this.j;R&&_.push(Nu(R,Z0,!0),":");var D=this.g;return(D||R=="file")&&(_.push("//"),(R=this.o)&&_.push(Nu(R,Z0,!0),"@"),_.push(Ni(D).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),D=this.u,D!=null&&_.push(":",String(D))),(D=this.h)&&(this.g&&D.charAt(0)!="/"&&_.push("/"),_.push(Nu(D,D.charAt(0)=="/"?Lu:Q0,!0))),(D=this.i.toString())&&_.push("?",D),(D=this.m)&&_.push("#",Nu(D,J0)),_.join("")},ho.prototype.resolve=function(_){const R=sa(this);let D=!!_.j;D?ku(R,_.j):D=!!_.o,D?R.o=_.o:D=!!_.g,D?R.g=_.g:D=_.u!=null;var H=_.h;if(D)fo(R,_.u);else if(D=!!_.h){if(H.charAt(0)!="/")if(this.g&&!this.h)H="/"+H;else{var ge=R.h.lastIndexOf("/");ge!=-1&&(H=R.h.slice(0,ge+1)+H)}if(ge=H,ge==".."||ge==".")H="";else if(ge.indexOf("./")!=-1||ge.indexOf("/.")!=-1){H=ge.lastIndexOf("/",0)==0,ge=ge.split("/");const Ae=[];for(let it=0;it<ge.length;){const Zt=ge[it++];Zt=="."?H&&it==ge.length&&Ae.push(""):Zt==".."?((Ae.length>1||Ae.length==1&&Ae[0]!="")&&Ae.pop(),H&&it==ge.length&&Ae.push("")):(Ae.push(Zt),H=!0)}H=Ae.join("/")}else H=ge}return D?R.h=H:D=_.i.toString()!=="",D?nc(R,rg(_.i)):D=!!_.m,D&&(R.m=_.m),R};function sa(_){return new ho(_)}function ku(_,R,D){_.j=D?Mu(R,!0):R,_.j&&(_.j=_.j.replace(/:$/,""))}function fo(_,R){if(R){if(R=Number(R),isNaN(R)||R<0)throw Error("Bad port number "+R);_.u=R}else _.u=null}function nc(_,R,D){R instanceof gn?(_.i=R,Td(_.i,_.l)):(D||(R=Nu(R,Xw)),_.i=new gn(R,_.l))}function In(_,R,D){_.i.set(R,D)}function il(_){return In(_,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),_}function Mu(_,R){return _?R?decodeURI(_.replace(/%25/g,"%2525")):decodeURIComponent(_):""}function Nu(_,R,D){return typeof _=="string"?(_=encodeURI(_).replace(R,X0),D&&(_=_.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_):null}function X0(_){return _=_.charCodeAt(0),"%"+(_>>4&15).toString(16)+(_&15).toString(16)}var Z0=/[#\/\?@]/g,Q0=/[#\?:]/g,Lu=/[#\?]/g,Xw=/[#\?@]/g,J0=/#/g;function gn(_,R){this.h=this.g=null,this.i=_||null,this.j=!!R}function go(_){_.g||(_.g=new Map,_.h=0,_.i&&yr(_.i,function(R,D){_.add(decodeURIComponent(R.replace(/\+/g," ")),D)}))}n=gn.prototype,n.add=function(_,R){go(this),this.i=null,_=mo(this,_);let D=this.g.get(_);return D||this.g.set(_,D=[]),D.push(R),this.h+=1,this};function eg(_,R){go(_),R=mo(_,R),_.g.has(R)&&(_.i=null,_.h-=_.g.get(R).length,_.g.delete(R))}function Sd(_,R){return go(_),R=mo(_,R),_.g.has(R)}n.forEach=function(_,R){go(this),this.g.forEach(function(D,H){D.forEach(function(ge){_.call(R,ge,H,this)},this)},this)};function tg(_,R){go(_);let D=[];if(typeof R=="string")Sd(_,R)&&(D=D.concat(_.g.get(mo(_,R))));else for(_=Array.from(_.g.values()),R=0;R<_.length;R++)D=D.concat(_[R]);return D}n.set=function(_,R){return go(this),this.i=null,_=mo(this,_),Sd(this,_)&&(this.h-=this.g.get(_).length),this.g.set(_,[R]),this.h+=1,this},n.get=function(_,R){return _?(_=tg(this,_),_.length>0?String(_[0]):R):R};function ng(_,R,D){eg(_,R),D.length>0&&(_.i=null,_.g.set(mo(_,R),y(D)),_.h+=D.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const _=[],R=Array.from(this.g.keys());for(let H=0;H<R.length;H++){var D=R[H];const ge=Ni(D);D=tg(this,D);for(let Ae=0;Ae<D.length;Ae++){let it=ge;D[Ae]!==""&&(it+="="+Ni(D[Ae])),_.push(it)}}return this.i=_.join("&")};function rg(_){const R=new gn;return R.i=_.i,_.g&&(R.g=new Map(_.g),R.h=_.h),R}function mo(_,R){return R=String(R),_.j&&(R=R.toLowerCase()),R}function Td(_,R){R&&!_.j&&(go(_),_.i=null,_.g.forEach(function(D,H){const ge=H.toLowerCase();H!=ge&&(eg(this,H),ng(this,ge,D))},_)),_.j=R}function po(_,R){const D=new Se;if(a.Image){const H=new Image;H.onload=h(yi,D,"TestLoadImage: loaded",!0,R,H),H.onerror=h(yi,D,"TestLoadImage: error",!1,R,H),H.onabort=h(yi,D,"TestLoadImage: abort",!1,R,H),H.ontimeout=h(yi,D,"TestLoadImage: timeout",!1,R,H),a.setTimeout(function(){H.ontimeout&&H.ontimeout()},1e4),H.src=_}else R(!1)}function yo(_,R){const D=new Se,H=new AbortController,ge=setTimeout(()=>{H.abort(),yi(D,"TestPingServer: timeout",!1,R)},1e4);fetch(_,{signal:H.signal}).then(Ae=>{clearTimeout(ge),Ae.ok?yi(D,"TestPingServer: ok",!0,R):yi(D,"TestPingServer: server error",!1,R)}).catch(()=>{clearTimeout(ge),yi(D,"TestPingServer: error",!1,R)})}function yi(_,R,D,H,ge){try{ge&&(ge.onload=null,ge.onerror=null,ge.onabort=null,ge.ontimeout=null),H(D)}catch{}}function Ou(){this.g=new Vr}function sl(_){this.i=_.Sb||null,this.h=_.ab||!1}f(sl,Ut),sl.prototype.g=function(){return new Ls(this.i,this.h)};function Ls(_,R){on.call(this),this.H=_,this.o=R,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}f(Ls,on),n=Ls.prototype,n.open=function(_,R){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=_,this.D=R,this.readyState=1,ka(this)},n.send=function(_){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const R={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};_&&(R.body=_),(this.H||a).fetch(new Request(this.D,R)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,rc(this)),this.readyState=0},n.Pa=function(_){if(this.g&&(this.l=_,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=_.headers,this.readyState=2,ka(this)),this.g&&(this.readyState=3,ka(this),this.g)))if(this.responseType==="arraybuffer")_.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in _){if(this.j=_.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;D1(this)}else _.text().then(this.Oa.bind(this),this.ga.bind(this))};function D1(_){_.j.read().then(_.Ma.bind(_)).catch(_.ga.bind(_))}n.Ma=function(_){if(this.g){if(this.o&&_.value)this.response.push(_.value);else if(!this.o){var R=_.value?_.value:new Uint8Array(0);(R=this.B.decode(R,{stream:!_.done}))&&(this.response=this.responseText+=R)}_.done?rc(this):ka(this),this.readyState==3&&D1(this)}},n.Oa=function(_){this.g&&(this.response=this.responseText=_,rc(this))},n.Na=function(_){this.g&&(this.response=_,rc(this))},n.ga=function(){this.g&&rc(this)};function rc(_){_.readyState=4,_.l=null,_.j=null,_.B=null,ka(_)}n.setRequestHeader=function(_,R){this.A.append(_,R)},n.getResponseHeader=function(_){return this.h&&this.h.get(_.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const _=[],R=this.h.entries();for(var D=R.next();!D.done;)D=D.value,_.push(D[0]+": "+D[1]),D=R.next();return _.join(`\r
`)};function ka(_){_.onreadystatechange&&_.onreadystatechange.call(_)}Object.defineProperty(Ls.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(_){this.m=_?"include":"same-origin"}});function F1(_){let R="";return Te(_,function(D,H){R+=H,R+=":",R+=D,R+=`\r
`}),R}function bd(_,R,D){e:{for(H in D){var H=!1;break e}H=!0}H||(D=F1(D),typeof _=="string"?D!=null&&Ni(D):In(_,R,D))}function Qn(_){on.call(this),this.headers=new Map,this.L=_||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}f(Qn,on);var j1=/^https?$/i,Zw=["POST","PUT"];n=Qn.prototype,n.Fa=function(_){this.H=_},n.ea=function(_,R,D,H){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+_);R=R?R.toUpperCase():"GET",this.D=_,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():hr.g(),this.g.onreadystatechange=g(u(this.Ca,this));try{this.B=!0,this.g.open(R,String(_),!0),this.B=!1}catch(Ae){ic(this,Ae);return}if(_=D||"",D=new Map(this.headers),H)if(Object.getPrototypeOf(H)===Object.prototype)for(var ge in H)D.set(ge,H[ge]);else if(typeof H.keys=="function"&&typeof H.get=="function")for(const Ae of H.keys())D.set(Ae,H.get(Ae));else throw Error("Unknown input type for opt_headers: "+String(H));H=Array.from(D.keys()).find(Ae=>Ae.toLowerCase()=="content-type"),ge=a.FormData&&_ instanceof a.FormData,!(Array.prototype.indexOf.call(Zw,R,void 0)>=0)||H||ge||D.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Ae,it]of D)this.g.setRequestHeader(Ae,it);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(_),this.v=!1}catch(Ae){ic(this,Ae)}};function ic(_,R){_.h=!1,_.g&&(_.j=!0,_.g.abort(),_.j=!1),_.l=R,_.o=5,sc(_),ol(_)}function sc(_){_.A||(_.A=!0,en(_,"complete"),en(_,"error"))}n.abort=function(_){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=_||7,en(this,"complete"),en(this,"abort"),ol(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ol(this,!0)),Qn.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?al(this):this.Xa())},n.Xa=function(){al(this)};function al(_){if(_.h&&typeof s<"u"){if(_.v&&_o(_)==4)setTimeout(_.Ca.bind(_),0);else if(en(_,"readystatechange"),_o(_)==4){_.h=!1;try{const Ae=_.ca();e:switch(Ae){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var R=!0;break e;default:R=!1}var D;if(!(D=R)){var H;if(H=Ae===0){let it=String(_.D).match(tc)[1]||null;!it&&a.self&&a.self.location&&(it=a.self.location.protocol.slice(0,-1)),H=!j1.test(it?it.toLowerCase():"")}D=H}if(D)en(_,"complete"),en(_,"success");else{_.o=6;try{var ge=_o(_)>2?_.g.statusText:""}catch{ge=""}_.l=ge+" ["+_.ca()+"]",sc(_)}}finally{ol(_)}}}}function ol(_,R){if(_.g){_.m&&(clearTimeout(_.m),_.m=null);const D=_.g;_.g=null,R||en(_,"ready");try{D.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function _o(_){return _.g?_.g.readyState:0}n.ca=function(){try{return _o(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(_){if(this.g){var R=this.g.responseText;return _&&R.indexOf(_)==0&&(R=R.substring(_.length)),si(R)}};function V1(_){try{if(!_.g)return null;if("response"in _.g)return _.g.response;switch(_.F){case"":case"text":return _.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in _.g)return _.g.mozResponseArrayBuffer}return null}catch{return null}}function ig(_){const R={};_=(_.g&&_o(_)>=2&&_.g.getAllResponseHeaders()||"").split(`\r
`);for(let H=0;H<_.length;H++){if(j(_[H]))continue;var D=B(_[H]);const ge=D[0];if(D=D[1],typeof D!="string")continue;D=D.trim();const Ae=R[ge]||[];R[ge]=Ae,Ae.push(D)}Ee(R,function(H){return H.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function xo(_,R,D){return D&&D.internalChannelParams&&D.internalChannelParams[_]||R}function Id(_){this.za=0,this.i=[],this.j=new Se,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=xo("failFast",!1,_),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=xo("baseRetryDelayMs",5e3,_),this.Za=xo("retryDelaySeedMs",1e4,_),this.Ta=xo("forwardChannelMaxRetries",2,_),this.va=xo("forwardChannelRequestTimeoutMs",2e4,_),this.ma=_&&_.xmlHttpFactory||void 0,this.Ua=_&&_.Rb||void 0,this.Aa=_&&_.useFetchStreams||!1,this.O=void 0,this.L=_&&_.supportsCrossDomainXhr||!1,this.M="",this.h=new Mn(_&&_.concurrentRequestLimit),this.Ba=new Ou,this.S=_&&_.fastHandshake||!1,this.R=_&&_.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=_&&_.Pb||!1,_&&_.ua&&this.j.ua(),_&&_.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&_&&_.detectBufferingProxy||!1,this.ia=void 0,_&&_.longPollingTimeout&&_.longPollingTimeout>0&&(this.ia=_.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Id.prototype,n.ka=8,n.I=1,n.connect=function(_,R,D,H){le(0),this.W=_,this.H=R||{},D&&H!==void 0&&(this.H.OSID=D,this.H.OAID=H),this.F=this.X,this.J=ag(this,null,this.W),ll(this)};function Ad(_){if(Rd(_),_.I==3){var R=_.V++,D=sa(_.J);if(In(D,"SID",_.M),In(D,"RID",R),In(D,"TYPE","terminate"),vo(_,D),R=new Q(_,_.j,R),R.M=2,R.A=il(sa(D)),D=!1,a.navigator&&a.navigator.sendBeacon)try{D=a.navigator.sendBeacon(R.A.toString(),"")}catch{}!D&&a.Image&&(new Image().src=R.A,D=!0),D||(R.g=B1(R.j,null),R.g.ea(R.A)),R.F=Date.now(),we(R)}ju(_)}function Os(_){_.g&&(Fu(_),_.g.cancel(),_.g=null)}function Rd(_){Os(_),_.v&&(a.clearTimeout(_.v),_.v=null),Cd(_),_.h.cancel(),_.m&&(typeof _.m=="number"&&a.clearTimeout(_.m),_.m=null)}function ll(_){if(!jn(_.h)&&!_.m){_.m=!0;var R=_.Ea;F||C(),z||(F(),z=!0),k.add(R,_),_.D=0}}function G1(_,R){return dr(_.h)>=_.h.j-(_.m?1:0)?!1:_.m?(_.i=R.G.concat(_.i),!0):_.I==1||_.I==2||_.D>=(_.Sa?0:_.Ta)?!1:(_.m=Ve(u(_.Ea,_,R),kd(_,_.D)),_.D++,!0)}n.Ea=function(_){if(this.m)if(this.m=null,this.I==1){if(!_){this.V=Math.floor(Math.random()*1e5),_=this.V++;const ge=new Q(this,this.j,_);let Ae=this.o;if(this.U&&(Ae?(Ae=se(Ae),J(Ae,this.U)):Ae=this.U),this.u!==null||this.R||(ge.J=Ae,Ae=null),this.S)e:{for(var R=0,D=0;D<this.i.length;D++){t:{var H=this.i[D];if("__data__"in H.map&&(H=H.map.__data__,typeof H=="string")){H=H.length;break t}H=void 0}if(H===void 0)break;if(R+=H,R>4096){R=D;break e}if(R===4096||D===this.i.length-1){R=D+1;break e}}R=1e3}else R=1e3;R=sg(this,ge,R),D=sa(this.J),In(D,"RID",_),In(D,"CVER",22),this.G&&In(D,"X-HTTP-Session-Id",this.G),vo(this,D),Ae&&(this.R?R="headers="+Ni(F1(Ae))+"&"+R:this.u&&bd(D,this.u,Ae)),ia(this.h,ge),this.Ra&&In(D,"TYPE","init"),this.S?(In(D,"$req",R),In(D,"SID","null"),ge.U=!0,te(ge,D,null)):te(ge,D,R),this.I=2}}else this.I==3&&(_?Du(this,_):this.i.length==0||jn(this.h)||Du(this))};function Du(_,R){var D;R?D=R.l:D=_.V++;const H=sa(_.J);In(H,"SID",_.M),In(H,"RID",D),In(H,"AID",_.K),vo(_,H),_.u&&_.o&&bd(H,_.u,_.o),D=new Q(_,_.j,D,_.D+1),_.u===null&&(D.J=_.o),R&&(_.i=R.G.concat(_.i)),R=sg(_,D,1e3),D.H=Math.round(_.va*.5)+Math.round(_.va*.5*Math.random()),ia(_.h,D),te(D,H,R)}function vo(_,R){_.H&&Te(_.H,function(D,H){In(R,H,D)}),_.l&&Te({},function(D,H){In(R,H,D)})}function sg(_,R,D){D=Math.min(_.i.length,D);const H=_.l?u(_.l.Ka,_.l,_):null;e:{var ge=_.i;let Zt=-1;for(;;){const kr=["count="+D];Zt==-1?D>0?(Zt=ge[0].g,kr.push("ofs="+Zt)):Zt=0:kr.push("ofs="+Zt);let Vn=!0;for(let Gr=0;Gr<D;Gr++){var Ae=ge[Gr].g;const Fs=ge[Gr].map;if(Ae-=Zt,Ae<0)Zt=Math.max(0,ge[Gr].g-100),Vn=!1;else try{Ae="req"+Ae+"_"||"";try{var it=Fs instanceof Map?Fs:Object.entries(Fs);for(const[cl,Eo]of it){let So=Eo;o(Eo)&&(So=rr(Eo)),kr.push(Ae+cl+"="+encodeURIComponent(So))}}catch(cl){throw kr.push(Ae+"type="+encodeURIComponent("_badmap")),cl}}catch{H&&H(Fs)}}if(Vn){it=kr.join("&");break e}}it=void 0}return _=_.i.splice(0,D),R.G=_,it}function Li(_){if(!_.g&&!_.v){_.Y=1;var R=_.Da;F||C(),z||(F(),z=!0),k.add(R,_),_.A=0}}function wo(_){return _.g||_.v||_.A>=3?!1:(_.Y++,_.v=Ve(u(_.Da,_),kd(_,_.A)),_.A++,!0)}n.Da=function(){if(this.v=null,ac(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var _=4*this.T;this.j.info("BP detection timer enabled: "+_),this.B=Ve(u(this.Wa,this),_)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,le(10),Os(this),ac(this))};function Fu(_){_.B!=null&&(a.clearTimeout(_.B),_.B=null)}function ac(_){_.g=new Q(_,_.j,"rpc",_.Y),_.u===null&&(_.g.J=_.o),_.g.P=0;var R=sa(_.na);In(R,"RID","rpc"),In(R,"SID",_.M),In(R,"AID",_.K),In(R,"CI",_.F?"0":"1"),!_.F&&_.ia&&In(R,"TO",_.ia),In(R,"TYPE","xmlhttp"),vo(_,R),_.u&&_.o&&bd(R,_.u,_.o),_.O&&(_.g.H=_.O);var D=_.g;_=_.ba,D.M=1,D.A=il(sa(R)),D.u=null,D.R=!0,ye(D,_)}n.Va=function(){this.C!=null&&(this.C=null,Os(this),wo(this),le(19))};function Cd(_){_.C!=null&&(a.clearTimeout(_.C),_.C=null)}function Pd(_,R){var D=null;if(_.g==R){Cd(_),Fu(_),_.g=null;var H=2}else if(Pa(_.h,R))D=R.G,Ns(_.h,R),H=1;else return;if(_.I!=0){if(R.o)if(H==1){D=R.u?R.u.length:0,R=Date.now()-R.F;var ge=_.D;H=Pt(),en(H,new he(H,D)),ll(_)}else Li(_);else if(ge=R.m,ge==3||ge==0&&R.X>0||!(H==1&&G1(_,R)||H==2&&wo(_)))switch(D&&D.length>0&&(R=_.h,R.i=R.i.concat(D)),ge){case 1:Ds(_,5);break;case 4:Ds(_,10);break;case 3:Ds(_,6);break;default:Ds(_,2)}}}function kd(_,R){let D=_.Qa+Math.floor(Math.random()*_.Za);return _.isActive()||(D*=2),D*R}function Ds(_,R){if(_.j.info("Error code "+R),R==2){var D=u(_.bb,_),H=_.Ua;const ge=!H;H=new ho(H||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||ku(H,"https"),il(H),ge?po(H.toString(),D):yo(H.toString(),D)}else le(2);_.I=0,_.l&&_.l.pa(R),ju(_),Rd(_)}n.bb=function(_){_?(this.j.info("Successfully pinged google.com"),le(2)):(this.j.info("Failed to ping google.com"),le(1))};function ju(_){if(_.I=0,_.ja=[],_.l){const R=Pr(_.h);(R.length!=0||_.i.length!=0)&&(v(_.ja,R),v(_.ja,_.i),_.h.i.length=0,y(_.i),_.i.length=0),_.l.oa()}}function ag(_,R,D){var H=D instanceof ho?sa(D):new ho(D);if(H.g!="")R&&(H.g=R+"."+H.g),fo(H,H.u);else{var ge=a.location;H=ge.protocol,R=R?R+"."+ge.hostname:ge.hostname,ge=+ge.port;const Ae=new ho(null);H&&ku(Ae,H),R&&(Ae.g=R),ge&&fo(Ae,ge),D&&(Ae.h=D),H=Ae}return D=_.G,R=_.wa,D&&R&&In(H,D,R),In(H,"VER",_.ka),vo(_,H),H}function B1(_,R,D){if(R&&!_.L)throw Error("Can't create secondary domain capable XhrIo object.");return R=_.Aa&&!_.ma?new Qn(new sl({ab:D})):new Qn(_.ma),R.Fa(_.L),R}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function U1(){}n=U1.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Md(){}Md.prototype.g=function(_,R){return new _i(_,R)};function _i(_,R){on.call(this),this.g=new Id(R),this.l=_,this.h=R&&R.messageUrlParams||null,_=R&&R.messageHeaders||null,R&&R.clientProtocolHeaderRequired&&(_?_["X-Client-Protocol"]="webchannel":_={"X-Client-Protocol":"webchannel"}),this.g.o=_,_=R&&R.initMessageHeaders||null,R&&R.messageContentType&&(_?_["X-WebChannel-Content-Type"]=R.messageContentType:_={"X-WebChannel-Content-Type":R.messageContentType}),R&&R.sa&&(_?_["X-WebChannel-Client-Profile"]=R.sa:_={"X-WebChannel-Client-Profile":R.sa}),this.g.U=_,(_=R&&R.Qb)&&!j(_)&&(this.g.u=_),this.A=R&&R.supportsCrossDomainXhr||!1,this.v=R&&R.sendRawJson||!1,(R=R&&R.httpSessionIdParam)&&!j(R)&&(this.g.G=R,_=this.h,_!==null&&R in _&&(_=this.h,R in _&&delete _[R])),this.j=new oc(this)}f(_i,on),_i.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},_i.prototype.close=function(){Ad(this.g)},_i.prototype.o=function(_){var R=this.g;if(typeof _=="string"){var D={};D.__data__=_,_=D}else this.v&&(D={},D.__data__=rr(_),_=D);R.i.push(new zt(R.Ya++,_)),R.I==3&&ll(R)},_i.prototype.N=function(){this.g.l=null,delete this.j,Ad(this.g),delete this.g,_i.Z.N.call(this)};function z1(_){ve.call(this),_.__headers__&&(this.headers=_.__headers__,this.statusCode=_.__status__,delete _.__headers__,delete _.__status__);var R=_.__sm__;if(R){e:{for(const D in R){_=D;break e}_=void 0}(this.i=_)&&(_=this.i,R=R!==null&&_ in R?R[_]:void 0),this.data=R}else this.data=_}f(z1,ve);function $1(){me.call(this),this.status=1}f($1,me);function oc(_){this.g=_}f(oc,U1),oc.prototype.ra=function(){en(this.g,"a")},oc.prototype.qa=function(_){en(this.g,new z1(_))},oc.prototype.pa=function(_){en(this.g,new $1)},oc.prototype.oa=function(){en(this.g,"b")},Md.prototype.createWebChannel=Md.prototype.g,_i.prototype.send=_i.prototype.o,_i.prototype.open=_i.prototype.m,_i.prototype.close=_i.prototype.close,A6=function(){return new Md},I6=function(){return Pt()},b6=Ct,MT={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ur.NO_ERROR=0,ur.TIMEOUT=8,ur.HTTP_ERROR=6,k_=ur,cn.COMPLETE="complete",T6=cn,Ji.EventType=Oe,Oe.OPEN="a",Oe.CLOSE="b",Oe.ERROR="c",Oe.MESSAGE="d",on.prototype.listen=on.prototype.J,em=Ji,Qn.prototype.listenOnce=Qn.prototype.K,Qn.prototype.getLastError=Qn.prototype.Ha,Qn.prototype.getLastErrorCode=Qn.prototype.ya,Qn.prototype.getStatus=Qn.prototype.ca,Qn.prototype.getResponseJson=Qn.prototype.La,Qn.prototype.getResponseText=Qn.prototype.la,Qn.prototype.send=Qn.prototype.ea,Qn.prototype.setWithCredentials=Qn.prototype.Fa,S6=Qn}).apply(typeof Zy<"u"?Zy:typeof self<"u"?self:typeof window<"u"?window:{});const EM="@firebase/firestore",SM="4.9.3";let bi=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};bi.UNAUTHENTICATED=new bi(null),bi.GOOGLE_CREDENTIALS=new bi("google-credentials-uid"),bi.FIRST_PARTY=new bi("first-party-uid"),bi.MOCK_USER=new bi("mock-user");let F0="12.7.0";const Wh=new OI("@firebase/firestore");function Sf(){return Wh.logLevel}function Ze(n,...e){if(Wh.logLevel<=hn.DEBUG){const t=e.map(KI);Wh.debug(`Firestore (${F0}): ${n}`,...t)}}function os(n,...e){if(Wh.logLevel<=hn.ERROR){const t=e.map(KI);Wh.error(`Firestore (${F0}): ${n}`,...t)}}function Hh(n,...e){if(Wh.logLevel<=hn.WARN){const t=e.map(KI);Wh.warn(`Firestore (${F0}): ${n}`,...t)}}function KI(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Et(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,R6(n,r,t)}function R6(n,e,t){let r=`FIRESTORE (${F0}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw os(r),new Error(r)}function At(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||R6(e,i,r)}function Xt(n,e){return n}const Pe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class at extends nl{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Vo{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class C6{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class DX{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(bi.UNAUTHENTICATED)))}shutdown(){}}class FX{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class jX{constructor(e){this.t=e,this.currentUser=bi.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){At(this.o===void 0,42304);let r=this.i;const i=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve();let s=new Vo;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Vo,e.enqueueRetryable((()=>i(this.currentUser)))};const a=()=>{const l=s;e.enqueueRetryable((async()=>{await l.promise,await i(this.currentUser)}))},o=l=>{Ze("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit((l=>o(l))),setTimeout((()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(Ze("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Vo)}}),0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(Ze("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(At(typeof r.accessToken=="string",31837,{l:r}),new C6(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return At(e===null||typeof e=="string",2055,{h:e}),new bi(e)}}class VX{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=bi.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class GX{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new VX(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(bi.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class TM{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class BX{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Ys(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){At(this.o===void 0,3512);const r=s=>{s.error!=null&&Ze("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.m;return this.m=s.token,Ze("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable((()=>r(s)))};const i=s=>{Ze("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((s=>i(s))),setTimeout((()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):Ze("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new TM(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(At(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new TM(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function UX(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class YI{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=UX(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%62))}return r}}function qt(n,e){return n<e?-1:n>e?1:0}function NT(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const i=n.charAt(r),s=e.charAt(r);if(i!==s)return lS(i)===lS(s)?qt(i,s):lS(i)?1:-1}return qt(n.length,e.length)}const zX=55296,$X=57343;function lS(n){const e=n.charCodeAt(0);return e>=zX&&e<=$X}function f0(n,e,t){return n.length===e.length&&n.every(((r,i)=>t(r,e[i])))}function P6(n){return n+"\0"}const bM="__name__";class Po{constructor(e,t,r){t===void 0?t=0:t>e.length&&Et(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&Et(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Po.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Po?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const s=Po.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return qt(e.length,t.length)}static compareSegments(e,t){const r=Po.isNumericId(e),i=Po.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?Po.extractNumericId(e).compare(Po.extractNumericId(t)):NT(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return iu.fromString(e.substring(4,e.length-2))}}class Pn extends Po{construct(e,t,r){return new Pn(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new at(Pe.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((i=>i.length>0)))}return new Pn(t)}static emptyPath(){return new Pn([])}}const WX=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class wr extends Po{construct(e,t,r){return new wr(e,t,r)}static isValidIdentifier(e){return WX.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),wr.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===bM}static keyField(){return new wr([bM])}static fromServerFormat(e){const t=[];let r="",i=0;const s=()=>{if(r.length===0)throw new at(Pe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let a=!1;for(;i<e.length;){const o=e[i];if(o==="\\"){if(i+1===e.length)throw new at(Pe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new at(Pe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else o==="`"?(a=!a,i++):o!=="."||a?(r+=o,i++):(s(),i++)}if(s(),a)throw new at(Pe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new wr(t)}static emptyPath(){return new wr([])}}class ct{constructor(e){this.path=e}static fromPath(e){return new ct(Pn.fromString(e))}static fromName(e){return new ct(Pn.fromString(e).popFirst(5))}static empty(){return new ct(Pn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Pn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Pn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ct(new Pn(e.slice()))}}function k6(n,e,t){if(!t)throw new at(Pe.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function HX(n,e,t,r){if(e===!0&&r===!0)throw new at(Pe.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function IM(n){if(!ct.isDocumentKey(n))throw new at(Pe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function AM(n){if(ct.isDocumentKey(n))throw new at(Pe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function M6(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function tw(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Et(12329,{type:typeof n})}function Aa(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new at(Pe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=tw(n);throw new at(Pe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Hr(n,e){const t={typeString:n};return e&&(t.value=e),t}function l1(n,e){if(!M6(n))throw new at(Pe.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const a=n[r];if(i&&typeof a!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&a!==s.value){t=`Expected '${r}' field to equal '${s.value}'`;break}}if(t)throw new at(Pe.INVALID_ARGUMENT,t);return!0}const RM=-62135596800,CM=1e6;class zn{static now(){return zn.fromMillis(Date.now())}static fromDate(e){return zn.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*CM);return new zn(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new at(Pe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new at(Pe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<RM)throw new at(Pe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new at(Pe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/CM}_compareTo(e){return this.seconds===e.seconds?qt(this.nanoseconds,e.nanoseconds):qt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:zn._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(l1(e,zn._jsonSchema))return new zn(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-RM;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}zn._jsonSchemaVersion="firestore/timestamp/1.0",zn._jsonSchema={type:Hr("string",zn._jsonSchemaVersion),seconds:Hr("number"),nanoseconds:Hr("number")};class kt{static fromTimestamp(e){return new kt(e)}static min(){return new kt(new zn(0,0))}static max(){return new kt(new zn(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const ap=-1;class Rx{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function LT(n){return n.fields.find((e=>e.kind===2))}function sh(n){return n.fields.filter((e=>e.kind!==2))}Rx.UNKNOWN_ID=-1;class M_{constructor(e,t){this.fieldPath=e,this.kind=t}}class op{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new op(0,ta.min())}}function KX(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=kt.fromTimestamp(r===1e9?new zn(t+1,0):new zn(t,r));return new ta(i,ct.empty(),e)}function N6(n){return new ta(n.readTime,n.key,ap)}class ta{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new ta(kt.min(),ct.empty(),ap)}static max(){return new ta(kt.max(),ct.empty(),ap)}}function qI(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=ct.comparator(n.documentKey,e.documentKey),t!==0?t:qt(n.largestBatchId,e.largestBatchId))}const L6="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class O6{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function fd(n){if(n.code!==Pe.FAILED_PRECONDITION||n.message!==L6)throw n;Ze("LocalStore","Unexpectedly lost primary lease")}class de{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Et(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new de(((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof de?t:de.resolve(t)}catch(t){return de.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):de.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):de.reject(t)}static resolve(e){return new de(((t,r)=>{t(e)}))}static reject(e){return new de(((t,r)=>{r(e)}))}static waitFor(e){return new de(((t,r)=>{let i=0,s=0,a=!1;e.forEach((o=>{++i,o.next((()=>{++s,a&&s===i&&t()}),(l=>r(l)))})),a=!0,s===i&&t()}))}static or(e){let t=de.resolve(!1);for(const r of e)t=t.next((i=>i?de.resolve(i):r()));return t}static forEach(e,t){const r=[];return e.forEach(((i,s)=>{r.push(t.call(this,i,s))})),this.waitFor(r)}static mapArray(e,t){return new de(((r,i)=>{const s=e.length,a=new Array(s);let o=0;for(let l=0;l<s;l++){const u=l;t(e[u]).next((h=>{a[u]=h,++o,o===s&&r(a)}),(h=>i(h)))}}))}static doWhile(e,t){return new de(((r,i)=>{const s=()=>{e()===!0?t().next((()=>{s()}),i):r()};s()}))}}const Us="SimpleDb";class nw{static open(e,t,r,i){try{return new nw(t,e.transaction(i,r))}catch(s){throw new pm(t,s)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new Vo,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new pm(e,t.error)):this.S.resolve()},this.transaction.onerror=r=>{const i=XI(r.target.error);this.S.reject(new pm(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(Ze(Us,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new qX(t)}}class su{static delete(e){return Ze(Us,"Removing database:",e),hh(RD().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!FD())return!1;if(su.F())return!0;const e=ri(),t=su.M(e),r=0<t&&t<10,i=D6(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.N=r,this.B=null,su.M(ri())===12.2&&os("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(Ze(Us,"Opening database:",this.name),this.db=await new Promise(((t,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const a=s.target.result;t(a)},i.onblocked=()=>{r(new pm(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const a=s.target.error;a.name==="VersionError"?r(new at(Pe.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):a.name==="InvalidStateError"?r(new at(Pe.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a)):r(new pm(e,a))},i.onupgradeneeded=s=>{Ze(Us,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const a=s.target.result;this.N.k(a,i.transaction,s.oldVersion,this.version).next((()=>{Ze(Us,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,i){const s=t==="readonly";let a=0;for(;;){++a;try{this.db=await this.L(e);const o=nw.open(this.db,e,s?"readonly":"readwrite",r),l=i(o).next((u=>(o.C(),u))).catch((u=>(o.abort(u),de.reject(u)))).toPromise();return l.catch((()=>{})),await o.D,l}catch(o){const l=o,u=l.name!=="FirebaseError"&&a<3;if(Ze(Us,"Transaction failed with error:",l.message,"Retrying:",u),this.close(),!u)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function D6(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class YX{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return hh(this.U.delete())}}class pm extends at{constructor(e,t){super(Pe.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Tu(n){return n.name==="IndexedDbTransactionError"}class qX{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(Ze(Us,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(Ze(Us,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),hh(r)}add(e){return Ze(Us,"ADD",this.store.name,e,e),hh(this.store.add(e))}get(e){return hh(this.store.get(e)).next((t=>(t===void 0&&(t=null),Ze(Us,"GET",this.store.name,e,t),t)))}delete(e){return Ze(Us,"DELETE",this.store.name,e),hh(this.store.delete(e))}count(){return Ze(Us,"COUNT",this.store.name),hh(this.store.count())}J(e,t){const r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(r.range);return new de(((a,o)=>{s.onerror=l=>{o(l.target.error)},s.onsuccess=l=>{a(l.target.result)}}))}{const s=this.cursor(r),a=[];return this.H(s,((o,l)=>{a.push(l)})).next((()=>a))}}Y(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new de(((i,s)=>{r.onerror=a=>{s(a.target.error)},r.onsuccess=a=>{i(a.target.result)}}))}Z(e,t){Ze(Us,"DELETE ALL",this.store.name);const r=this.options(e,t);r.X=!1;const i=this.cursor(r);return this.H(i,((s,a,o)=>o.delete()))}ee(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.H(i,t)}te(e){const t=this.cursor({});return new de(((r,i)=>{t.onerror=s=>{const a=XI(s.target.error);i(a)},t.onsuccess=s=>{const a=s.target.result;a?e(a.primaryKey,a.value).next((o=>{o?a.continue():r()})):r()}}))}H(e,t){const r=[];return new de(((i,s)=>{e.onerror=a=>{s(a.target.error)},e.onsuccess=a=>{const o=a.target.result;if(!o)return void i();const l=new YX(o),u=t(o.primaryKey,o.value,l);if(u instanceof de){const h=u.catch((f=>(l.done(),de.reject(f))));r.push(h)}l.isDone?i():l.G===null?o.continue():o.continue(l.G)}})).next((()=>de.waitFor(r)))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function hh(n){return new de(((e,t)=>{n.onsuccess=r=>{const i=r.target.result;e(i)},n.onerror=r=>{const i=XI(r.target.error);t(i)}}))}let PM=!1;function XI(n){const e=su.M(ri());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new at("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return PM||(PM=!0,setTimeout((()=>{throw r}),0)),r}}return n}const ym="IndexBackfiller";class XX{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){Ze(ym,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();Ze(ym,`Documents written: ${t}`)}catch(t){Tu(t)?Ze(ym,"Ignoring IndexedDB error during index backfill: ",t):await fd(t)}await this.re(6e4)}))}}class ZX{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const r=new Set;let i=t,s=!0;return de.doWhile((()=>s===!0&&i>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((a=>{if(a!==null&&!r.has(a))return Ze(ym,`Processing collection: ${a}`),this.oe(e,a,i).next((o=>{i-=o,r.add(a)}));s=!1})))).next((()=>t-i))}oe(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next((s=>{const a=s.changes;return this.localStore.indexManager.updateIndexEntries(e,a).next((()=>this._e(i,s))).next((o=>(Ze(ym,`Updating offset: ${o}`),this.localStore.indexManager.updateCollectionGroup(e,t,o)))).next((()=>a.size))}))))}_e(e,t){let r=e;return t.changes.forEach(((i,s)=>{const a=N6(s);qI(a,r)>0&&(r=a)})),new ta(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}class Ea{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Ea.ce=-1;const Ah=-1;function rw(n){return n==null}function lp(n){return n===0&&1/n==-1/0}function QX(n){return typeof n=="number"&&Number.isInteger(n)&&!lp(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const Cx="";function Ki(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=kM(e)),e=JX(n.get(t),e);return kM(e)}function JX(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const s=n.charAt(i);switch(s){case"\0":t+="";break;case Cx:t+="";break;default:t+=s}}return t}function kM(n){return n+Cx+""}function Oo(n){const e=n.length;if(At(e>=2,64408,{path:n}),e===2)return At(n.charAt(0)===Cx&&n.charAt(1)==="",56145,{path:n}),Pn.emptyPath();const t=e-2,r=[];let i="";for(let s=0;s<e;){const a=n.indexOf(Cx,s);switch((a<0||a>t)&&Et(50515,{path:n}),n.charAt(a+1)){case"":const o=n.substring(s,a);let l;i.length===0?l=o:(i+=o,l=i,i=""),r.push(l);break;case"":i+=n.substring(s,a),i+="\0";break;case"":i+=n.substring(s,a+1);break;default:Et(61167,{path:n})}s=a+2}return new Pn(r)}const ah="remoteDocuments",c1="owner",lf="owner",cp="mutationQueues",eZ="userId",za="mutations",MM="batchId",wh="userMutationsIndex",NM=["userId","batchId"];function N_(n,e){return[n,Ki(e)]}function F6(n,e,t){return[n,Ki(e),t]}const tZ={},g0="documentMutations",Px="remoteDocumentsV14",nZ=["prefixPath","collectionGroup","readTime","documentId"],L_="documentKeyIndex",rZ=["prefixPath","collectionGroup","documentId"],j6="collectionGroupIndex",iZ=["collectionGroup","readTime","prefixPath","documentId"],up="remoteDocumentGlobal",OT="remoteDocumentGlobalKey",m0="targets",V6="queryTargetsIndex",sZ=["canonicalId","targetId"],p0="targetDocuments",aZ=["targetId","path"],ZI="documentTargetsIndex",oZ=["path","targetId"],kx="targetGlobalKey",Rh="targetGlobal",hp="collectionParents",lZ=["collectionId","parent"],y0="clientMetadata",cZ="clientId",iw="bundles",uZ="bundleId",sw="namedQueries",hZ="name",QI="indexConfiguration",dZ="indexId",DT="collectionGroupIndex",fZ="collectionGroup",_m="indexState",gZ=["indexId","uid"],G6="sequenceNumberIndex",mZ=["uid","sequenceNumber"],xm="indexEntries",pZ=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],B6="documentKeyIndex",yZ=["indexId","uid","orderedDocumentKey"],aw="documentOverlays",_Z=["userId","collectionPath","documentId"],FT="collectionPathOverlayIndex",xZ=["userId","collectionPath","largestBatchId"],U6="collectionGroupOverlayIndex",vZ=["userId","collectionGroup","largestBatchId"],JI="globals",wZ="name",z6=[cp,za,g0,ah,m0,c1,Rh,p0,y0,up,hp,iw,sw],EZ=[...z6,aw],$6=[cp,za,g0,Px,m0,c1,Rh,p0,y0,up,hp,iw,sw,aw],W6=$6,eA=[...W6,QI,_m,xm],SZ=eA,H6=[...eA,JI],TZ=H6;class jT extends O6{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function ii(n,e){const t=Xt(n);return su.O(t.le,e)}function LM(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function bu(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function K6(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class mr{constructor(e,t){this.comparator=e,this.root=t||Ii.EMPTY}insert(e,t){return new mr(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ii.BLACK,null,null))}remove(e){return new mr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ii.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Qy(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Qy(this.root,e,this.comparator,!1)}getReverseIterator(){return new Qy(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Qy(this.root,e,this.comparator,!0)}}class Qy{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ii{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??Ii.RED,this.left=i??Ii.EMPTY,this.right=s??Ii.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new Ii(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Ii.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return Ii.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ii.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ii.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Et(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Et(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Et(27949);return e+(this.isRed()?0:1)}}Ii.EMPTY=null,Ii.RED=!0,Ii.BLACK=!1;Ii.EMPTY=new class{constructor(){this.size=0}get key(){throw Et(57766)}get value(){throw Et(16141)}get color(){throw Et(16727)}get left(){throw Et(29726)}get right(){throw Et(36894)}copy(e,t,r,i,s){return this}insert(e,t,r){return new Ii(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Hn{constructor(e){this.comparator=e,this.data=new mr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new OM(this.data.getIterator())}getIteratorFrom(e){return new OM(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof Hn)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Hn(this.comparator);return t.data=e,t}}class OM{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function cf(n){return n.hasNext()?n.getNext():void 0}class Is{constructor(e){this.fields=e,e.sort(wr.comparator)}static empty(){return new Is([])}unionWith(e){let t=new Hn(wr.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Is(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return f0(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}class Y6 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Yr{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Y6("Invalid base64 string: "+s):s}})(e);return new Yr(t)}static fromUint8Array(e){const t=(function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s})(e);return new Yr(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return qt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Yr.EMPTY_BYTE_STRING=new Yr("");const bZ=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ul(n){if(At(!!n,39018),typeof n=="string"){let e=0;const t=bZ.exec(n);if(At(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:gr(n.seconds),nanos:gr(n.nanos)}}function gr(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function zl(n){return typeof n=="string"?Yr.fromBase64String(n):Yr.fromUint8Array(n)}const q6="server_timestamp",X6="__type__",Z6="__previous_value__",Q6="__local_write_time__";function tA(n){return(n?.mapValue?.fields||{})[X6]?.stringValue===q6}function ow(n){const e=n.mapValue.fields[Z6];return tA(e)?ow(e):e}function dp(n){const e=Ul(n.mapValue.fields[Q6].timestampValue);return new zn(e.seconds,e.nanos)}class IZ{constructor(e,t,r,i,s,a,o,l,u,h){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=u,this.isUsingEmulator=h}}const Mx="(default)";class Kh{constructor(e,t){this.projectId=e,this.database=t||Mx}static empty(){return new Kh("","")}get isDefaultDatabase(){return this.database===Mx}isEqual(e){return e instanceof Kh&&e.projectId===this.projectId&&e.database===this.database}}const nA="__type__",J6="__max__",Yc={mapValue:{fields:{__type__:{stringValue:J6}}}},rA="__vector__",_0="value",O_={nullValue:"NULL_VALUE"};function hu(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?tA(n)?4:eF(n)?9007199254740991:lw(n)?10:11:Et(28295,{value:n})}function Xo(n,e){if(n===e)return!0;const t=hu(n);if(t!==hu(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return dp(n).isEqual(dp(e));case 3:return(function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=Ul(i.timestampValue),o=Ul(s.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,s){return zl(i.bytesValue).isEqual(zl(s.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,s){return gr(i.geoPointValue.latitude)===gr(s.geoPointValue.latitude)&&gr(i.geoPointValue.longitude)===gr(s.geoPointValue.longitude)})(n,e);case 2:return(function(i,s){if("integerValue"in i&&"integerValue"in s)return gr(i.integerValue)===gr(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=gr(i.doubleValue),o=gr(s.doubleValue);return a===o?lp(a)===lp(o):isNaN(a)&&isNaN(o)}return!1})(n,e);case 9:return f0(n.arrayValue.values||[],e.arrayValue.values||[],Xo);case 10:case 11:return(function(i,s){const a=i.mapValue.fields||{},o=s.mapValue.fields||{};if(LM(a)!==LM(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!Xo(a[l],o[l])))return!1;return!0})(n,e);default:return Et(52216,{left:n})}}function fp(n,e){return(n.values||[]).find((t=>Xo(t,e)))!==void 0}function du(n,e){if(n===e)return 0;const t=hu(n),r=hu(e);if(t!==r)return qt(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return qt(n.booleanValue,e.booleanValue);case 2:return(function(s,a){const o=gr(s.integerValue||s.doubleValue),l=gr(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1})(n,e);case 3:return DM(n.timestampValue,e.timestampValue);case 4:return DM(dp(n),dp(e));case 5:return NT(n.stringValue,e.stringValue);case 6:return(function(s,a){const o=zl(s),l=zl(a);return o.compareTo(l)})(n.bytesValue,e.bytesValue);case 7:return(function(s,a){const o=s.split("/"),l=a.split("/");for(let u=0;u<o.length&&u<l.length;u++){const h=qt(o[u],l[u]);if(h!==0)return h}return qt(o.length,l.length)})(n.referenceValue,e.referenceValue);case 8:return(function(s,a){const o=qt(gr(s.latitude),gr(a.latitude));return o!==0?o:qt(gr(s.longitude),gr(a.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return FM(n.arrayValue,e.arrayValue);case 10:return(function(s,a){const o=s.fields||{},l=a.fields||{},u=o[_0]?.arrayValue,h=l[_0]?.arrayValue,f=qt(u?.values?.length||0,h?.values?.length||0);return f!==0?f:FM(u,h)})(n.mapValue,e.mapValue);case 11:return(function(s,a){if(s===Yc.mapValue&&a===Yc.mapValue)return 0;if(s===Yc.mapValue)return 1;if(a===Yc.mapValue)return-1;const o=s.fields||{},l=Object.keys(o),u=a.fields||{},h=Object.keys(u);l.sort(),h.sort();for(let f=0;f<l.length&&f<h.length;++f){const g=NT(l[f],h[f]);if(g!==0)return g;const y=du(o[l[f]],u[h[f]]);if(y!==0)return y}return qt(l.length,h.length)})(n.mapValue,e.mapValue);default:throw Et(23264,{he:t})}}function DM(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return qt(n,e);const t=Ul(n),r=Ul(e),i=qt(t.seconds,r.seconds);return i!==0?i:qt(t.nanos,r.nanos)}function FM(n,e){const t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const s=du(t[i],r[i]);if(s)return s}return qt(t.length,r.length)}function x0(n){return VT(n)}function VT(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=Ul(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return zl(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return ct.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(const s of t.values||[])i?i=!1:r+=",",r+=VT(s);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const a of r)s?s=!1:i+=",",i+=`${a}:${VT(t.fields[a])}`;return i+"}"})(n.mapValue):Et(61005,{value:n})}function D_(n){switch(hu(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=ow(n);return e?16+D_(e):16;case 5:return 2*n.stringValue.length;case 6:return zl(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((i,s)=>i+D_(s)),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return bu(r.fields,((s,a)=>{i+=s.length+D_(a)})),i})(n.mapValue);default:throw Et(13486,{value:n})}}function gp(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function GT(n){return!!n&&"integerValue"in n}function mp(n){return!!n&&"arrayValue"in n}function jM(n){return!!n&&"nullValue"in n}function VM(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function F_(n){return!!n&&"mapValue"in n}function lw(n){return(n?.mapValue?.fields||{})[nA]?.stringValue===rA}function vm(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return bu(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=vm(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=vm(n.arrayValue.values[t]);return e}return{...n}}function eF(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===J6}const tF={mapValue:{fields:{[nA]:{stringValue:rA},[_0]:{arrayValue:{}}}}};function AZ(n){return"nullValue"in n?O_:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?gp(Kh.empty(),ct.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?lw(n)?tF:{mapValue:{}}:Et(35942,{value:n})}function RZ(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?gp(Kh.empty(),ct.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?tF:"mapValue"in n?lw(n)?{mapValue:{}}:Yc:Et(61959,{value:n})}function GM(n,e){const t=du(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function BM(n,e){const t=du(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class $i{constructor(e){this.value=e}static empty(){return new $i({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!F_(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=vm(t)}setAll(e){let t=wr.emptyPath(),r={},i=[];e.forEach(((a,o)=>{if(!t.isImmediateParentOf(o)){const l=this.getFieldsMap(t);this.applyChanges(l,r,i),r={},i=[],t=o.popLast()}a?r[o.lastSegment()]=vm(a):i.push(o.lastSegment())}));const s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){const t=this.field(e.popLast());F_(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Xo(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];F_(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){bu(t,((i,s)=>e[i]=s));for(const i of r)delete e[i]}clone(){return new $i(vm(this.value))}}function nF(n){const e=[];return bu(n.fields,((t,r)=>{const i=new wr([t]);if(F_(r)){const s=nF(r.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)})),new Is(e)}class Rr{constructor(e,t,r,i,s,a,o){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(e){return new Rr(e,0,kt.min(),kt.min(),kt.min(),$i.empty(),0)}static newFoundDocument(e,t,r,i){return new Rr(e,1,t,kt.min(),r,i,0)}static newNoDocument(e,t){return new Rr(e,2,t,kt.min(),kt.min(),$i.empty(),0)}static newUnknownDocument(e,t){return new Rr(e,3,t,kt.min(),kt.min(),$i.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(kt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=$i.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=$i.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=kt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Rr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Rr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class v0{constructor(e,t){this.position=e,this.inclusive=t}}function UM(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const s=e[i],a=n.position[i];if(s.field.isKeyField()?r=ct.comparator(ct.fromName(a.referenceValue),t.key):r=du(a,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function zM(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Xo(n.position[t],e.position[t]))return!1;return!0}class Nx{constructor(e,t="asc"){this.field=e,this.dir=t}}function CZ(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class rF{}class dn extends rF{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new PZ(e,t,r):t==="array-contains"?new NZ(e,r):t==="in"?new cF(e,r):t==="not-in"?new LZ(e,r):t==="array-contains-any"?new OZ(e,r):new dn(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new kZ(e,r):new MZ(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(du(t,this.value)):t!==null&&hu(this.value)===hu(t)&&this.matchesComparison(du(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Et(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class $n extends rF{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new $n(e,t)}matches(e){return w0(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function w0(n){return n.op==="and"}function BT(n){return n.op==="or"}function iA(n){return iF(n)&&w0(n)}function iF(n){for(const e of n.filters)if(e instanceof $n)return!1;return!0}function UT(n){if(n instanceof dn)return n.field.canonicalString()+n.op.toString()+x0(n.value);if(iA(n))return n.filters.map((e=>UT(e))).join(",");{const e=n.filters.map((t=>UT(t))).join(",");return`${n.op}(${e})`}}function sF(n,e){return n instanceof dn?(function(r,i){return i instanceof dn&&r.op===i.op&&r.field.isEqual(i.field)&&Xo(r.value,i.value)})(n,e):n instanceof $n?(function(r,i){return i instanceof $n&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce(((s,a,o)=>s&&sF(a,i.filters[o])),!0):!1})(n,e):void Et(19439)}function aF(n,e){const t=n.filters.concat(e);return $n.create(t,n.op)}function oF(n){return n instanceof dn?(function(t){return`${t.field.canonicalString()} ${t.op} ${x0(t.value)}`})(n):n instanceof $n?(function(t){return t.op.toString()+" {"+t.getFilters().map(oF).join(" ,")+"}"})(n):"Filter"}class PZ extends dn{constructor(e,t,r){super(e,t,r),this.key=ct.fromName(r.referenceValue)}matches(e){const t=ct.comparator(e.key,this.key);return this.matchesComparison(t)}}class kZ extends dn{constructor(e,t){super(e,"in",t),this.keys=lF("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class MZ extends dn{constructor(e,t){super(e,"not-in",t),this.keys=lF("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function lF(n,e){return(e.arrayValue?.values||[]).map((t=>ct.fromName(t.referenceValue)))}class NZ extends dn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return mp(t)&&fp(t.arrayValue,this.value)}}class cF extends dn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&fp(this.value.arrayValue,t)}}class LZ extends dn{constructor(e,t){super(e,"not-in",t)}matches(e){if(fp(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!fp(this.value.arrayValue,t)}}class OZ extends dn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!mp(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>fp(this.value.arrayValue,r)))}}class DZ{constructor(e,t=null,r=[],i=[],s=null,a=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=a,this.endAt=o,this.Te=null}}function zT(n,e=null,t=[],r=[],i=null,s=null,a=null){return new DZ(n,e,t,r,i,s,a)}function Yh(n){const e=Xt(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>UT(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(s){return s.field.canonicalString()+s.dir})(r))).join(","),rw(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>x0(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>x0(r))).join(",")),e.Te=t}return e.Te}function u1(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!CZ(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!sF(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!zM(n.startAt,e.startAt)&&zM(n.endAt,e.endAt)}function Lx(n){return ct.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Ox(n,e){return n.filters.filter((t=>t instanceof dn&&t.field.isEqual(e)))}function $M(n,e,t){let r=O_,i=!0;for(const s of Ox(n,e)){let a=O_,o=!0;switch(s.op){case"<":case"<=":a=AZ(s.value);break;case"==":case"in":case">=":a=s.value;break;case">":a=s.value,o=!1;break;case"!=":case"not-in":a=O_}GM({value:r,inclusive:i},{value:a,inclusive:o})<0&&(r=a,i=o)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const a=t.position[s];GM({value:r,inclusive:i},{value:a,inclusive:t.inclusive})<0&&(r=a,i=t.inclusive);break}}return{value:r,inclusive:i}}function WM(n,e,t){let r=Yc,i=!0;for(const s of Ox(n,e)){let a=Yc,o=!0;switch(s.op){case">=":case">":a=RZ(s.value),o=!1;break;case"==":case"in":case"<=":a=s.value;break;case"<":a=s.value,o=!1;break;case"!=":case"not-in":a=Yc}BM({value:r,inclusive:i},{value:a,inclusive:o})>0&&(r=a,i=o)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const a=t.position[s];BM({value:r,inclusive:i},{value:a,inclusive:t.inclusive})>0&&(r=a,i=t.inclusive);break}}return{value:r,inclusive:i}}class h1{constructor(e,t=null,r=[],i=[],s=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function FZ(n,e,t,r,i,s,a,o){return new h1(n,e,t,r,i,s,a,o)}function cw(n){return new h1(n)}function HM(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function uF(n){return n.collectionGroup!==null}function wm(n){const e=Xt(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),t.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new Hn(wr.comparator);return a.filters.forEach((l=>{l.getFlattenedFilters().forEach((u=>{u.isInequality()&&(o=o.add(u.field))}))})),o})(e).forEach((s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new Nx(s,r))})),t.has(wr.keyField().canonicalString())||e.Ie.push(new Nx(wr.keyField(),r))}return e.Ie}function Ta(n){const e=Xt(n);return e.Ee||(e.Ee=jZ(e,wm(n))),e.Ee}function jZ(n,e){if(n.limitType==="F")return zT(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((i=>{const s=i.dir==="desc"?"asc":"desc";return new Nx(i.field,s)}));const t=n.endAt?new v0(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new v0(n.startAt.position,n.startAt.inclusive):null;return zT(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function $T(n,e){const t=n.filters.concat([e]);return new h1(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function WT(n,e,t){return new h1(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function uw(n,e){return u1(Ta(n),Ta(e))&&n.limitType===e.limitType}function hF(n){return`${Yh(Ta(n))}|lt:${n.limitType}`}function Tf(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((i=>oF(i))).join(", ")}]`),rw(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((i=>(function(a){return`${a.field.canonicalString()} (${a.dir})`})(i))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((i=>x0(i))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((i=>x0(i))).join(",")),`Target(${r})`})(Ta(n))}; limitType=${n.limitType})`}function d1(n,e){return e.isFoundDocument()&&(function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):ct.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)})(n,e)&&(function(r,i){for(const s of wm(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(a,o,l){const u=UM(a,o,l);return a.inclusive?u<=0:u<0})(r.startAt,wm(r),i)||r.endAt&&!(function(a,o,l){const u=UM(a,o,l);return a.inclusive?u>=0:u>0})(r.endAt,wm(r),i))})(n,e)}function VZ(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function dF(n){return(e,t)=>{let r=!1;for(const i of wm(n)){const s=GZ(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function GZ(n,e,t){const r=n.field.isKeyField()?ct.comparator(e.key,t.key):(function(s,a,o){const l=a.data.field(s),u=o.data.field(s);return l!==null&&u!==null?du(l,u):Et(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Et(19790,{direction:n.dir})}}class Xl{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){bu(this.inner,((t,r)=>{for(const[i,s]of r)e(i,s)}))}isEmpty(){return K6(this.inner)}size(){return this.innerSize}}const BZ=new mr(ct.comparator);function Xs(){return BZ}const fF=new mr(ct.comparator);function tm(...n){let e=fF;for(const t of n)e=e.insert(t.key,t);return e}function gF(n){let e=fF;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function Do(){return Em()}function mF(){return Em()}function Em(){return new Xl((n=>n.toString()),((n,e)=>n.isEqual(e)))}const UZ=new mr(ct.comparator),zZ=new Hn(ct.comparator);function an(...n){let e=zZ;for(const t of n)e=e.add(t);return e}const $Z=new Hn(qt);function WZ(){return $Z}function sA(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:lp(e)?"-0":e}}function pF(n){return{integerValue:""+n}}function HZ(n,e){return QX(e)?pF(e):sA(n,e)}class hw{constructor(){this._=void 0}}function KZ(n,e,t){return n instanceof E0?(function(i,s){const a={fields:{[X6]:{stringValue:q6},[Q6]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&tA(s)&&(s=ow(s)),s&&(a.fields[Z6]=s),{mapValue:a}})(t,e):n instanceof S0?_F(n,e):n instanceof T0?xF(n,e):(function(i,s){const a=yF(i,s),o=KM(a)+KM(i.Ae);return GT(a)&&GT(i.Ae)?pF(o):sA(i.serializer,o)})(n,e)}function YZ(n,e,t){return n instanceof S0?_F(n,e):n instanceof T0?xF(n,e):t}function yF(n,e){return n instanceof pp?(function(r){return GT(r)||(function(s){return!!s&&"doubleValue"in s})(r)})(e)?e:{integerValue:0}:null}class E0 extends hw{}class S0 extends hw{constructor(e){super(),this.elements=e}}function _F(n,e){const t=vF(e);for(const r of n.elements)t.some((i=>Xo(i,r)))||t.push(r);return{arrayValue:{values:t}}}class T0 extends hw{constructor(e){super(),this.elements=e}}function xF(n,e){let t=vF(e);for(const r of n.elements)t=t.filter((i=>!Xo(i,r)));return{arrayValue:{values:t}}}class pp extends hw{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function KM(n){return gr(n.integerValue||n.doubleValue)}function vF(n){return mp(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class wF{constructor(e,t){this.field=e,this.transform=t}}function qZ(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof S0&&i instanceof S0||r instanceof T0&&i instanceof T0?f0(r.elements,i.elements,Xo):r instanceof pp&&i instanceof pp?Xo(r.Ae,i.Ae):r instanceof E0&&i instanceof E0})(n.transform,e.transform)}class XZ{constructor(e,t){this.version=e,this.transformResults=t}}class Wi{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Wi}static exists(e){return new Wi(void 0,e)}static updateTime(e){return new Wi(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function j_(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class dw{}function EF(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new fw(n.key,Wi.none()):new j0(n.key,n.data,Wi.none());{const t=n.data,r=$i.empty();let i=new Hn(wr.comparator);for(let s of e.fields)if(!i.has(s)){let a=t.field(s);a===null&&s.length>1&&(s=s.popLast(),a=t.field(s)),a===null?r.delete(s):r.set(s,a),i=i.add(s)}return new Zl(n.key,r,new Is(i.toArray()),Wi.none())}}function ZZ(n,e,t){n instanceof j0?(function(i,s,a){const o=i.value.clone(),l=qM(i.fieldTransforms,s,a.transformResults);o.setAll(l),s.convertToFoundDocument(a.version,o).setHasCommittedMutations()})(n,e,t):n instanceof Zl?(function(i,s,a){if(!j_(i.precondition,s))return void s.convertToUnknownDocument(a.version);const o=qM(i.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(SF(i)),l.setAll(o),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()})(n,e,t):(function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()})(0,e,t)}function Sm(n,e,t,r){return n instanceof j0?(function(s,a,o,l){if(!j_(s.precondition,a))return o;const u=s.value.clone(),h=XM(s.fieldTransforms,l,a);return u.setAll(h),a.convertToFoundDocument(a.version,u).setHasLocalMutations(),null})(n,e,t,r):n instanceof Zl?(function(s,a,o,l){if(!j_(s.precondition,a))return o;const u=XM(s.fieldTransforms,l,a),h=a.data;return h.setAll(SF(s)),h.setAll(u),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map((f=>f.field)))})(n,e,t,r):(function(s,a,o){return j_(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o})(n,e,t)}function QZ(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),s=yF(r.transform,i||null);s!=null&&(t===null&&(t=$i.empty()),t.set(r.field,s))}return t||null}function YM(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&f0(r,i,((s,a)=>qZ(s,a)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class j0 extends dw{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Zl extends dw{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function SF(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function qM(n,e,t){const r=new Map;At(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let i=0;i<t.length;i++){const s=n[i],a=s.transform,o=e.data.field(s.field);r.set(s.field,YZ(a,o,t[i]))}return r}function XM(n,e,t){const r=new Map;for(const i of n){const s=i.transform,a=t.data.field(i.field);r.set(i.field,KZ(s,a,e))}return r}class fw extends dw{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class TF extends dw{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class aA{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&ZZ(s,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Sm(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Sm(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=mF();return this.mutations.forEach((i=>{const s=e.get(i.key),a=s.overlayedDocument;let o=this.applyToLocalView(a,s.mutatedFields);o=t.has(i.key)?null:o;const l=EF(a,o);l!==null&&r.set(i.key,l),a.isValidDocument()||a.convertToNoDocument(kt.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),an())}isEqual(e){return this.batchId===e.batchId&&f0(this.mutations,e.mutations,((t,r)=>YM(t,r)))&&f0(this.baseMutations,e.baseMutations,((t,r)=>YM(t,r)))}}class oA{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){At(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=(function(){return UZ})();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,r[a].version);return new oA(e,t,r,i)}}class lA{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class JZ{constructor(e,t){this.count=e,this.unchangedNames=t}}var zr,pn;function eQ(n){switch(n){case Pe.OK:return Et(64938);case Pe.CANCELLED:case Pe.UNKNOWN:case Pe.DEADLINE_EXCEEDED:case Pe.RESOURCE_EXHAUSTED:case Pe.INTERNAL:case Pe.UNAVAILABLE:case Pe.UNAUTHENTICATED:return!1;case Pe.INVALID_ARGUMENT:case Pe.NOT_FOUND:case Pe.ALREADY_EXISTS:case Pe.PERMISSION_DENIED:case Pe.FAILED_PRECONDITION:case Pe.ABORTED:case Pe.OUT_OF_RANGE:case Pe.UNIMPLEMENTED:case Pe.DATA_LOSS:return!0;default:return Et(15467,{code:n})}}function bF(n){if(n===void 0)return os("GRPC error has no .code"),Pe.UNKNOWN;switch(n){case zr.OK:return Pe.OK;case zr.CANCELLED:return Pe.CANCELLED;case zr.UNKNOWN:return Pe.UNKNOWN;case zr.DEADLINE_EXCEEDED:return Pe.DEADLINE_EXCEEDED;case zr.RESOURCE_EXHAUSTED:return Pe.RESOURCE_EXHAUSTED;case zr.INTERNAL:return Pe.INTERNAL;case zr.UNAVAILABLE:return Pe.UNAVAILABLE;case zr.UNAUTHENTICATED:return Pe.UNAUTHENTICATED;case zr.INVALID_ARGUMENT:return Pe.INVALID_ARGUMENT;case zr.NOT_FOUND:return Pe.NOT_FOUND;case zr.ALREADY_EXISTS:return Pe.ALREADY_EXISTS;case zr.PERMISSION_DENIED:return Pe.PERMISSION_DENIED;case zr.FAILED_PRECONDITION:return Pe.FAILED_PRECONDITION;case zr.ABORTED:return Pe.ABORTED;case zr.OUT_OF_RANGE:return Pe.OUT_OF_RANGE;case zr.UNIMPLEMENTED:return Pe.UNIMPLEMENTED;case zr.DATA_LOSS:return Pe.DATA_LOSS;default:return Et(39323,{code:n})}}(pn=zr||(zr={}))[pn.OK=0]="OK",pn[pn.CANCELLED=1]="CANCELLED",pn[pn.UNKNOWN=2]="UNKNOWN",pn[pn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",pn[pn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",pn[pn.NOT_FOUND=5]="NOT_FOUND",pn[pn.ALREADY_EXISTS=6]="ALREADY_EXISTS",pn[pn.PERMISSION_DENIED=7]="PERMISSION_DENIED",pn[pn.UNAUTHENTICATED=16]="UNAUTHENTICATED",pn[pn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",pn[pn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",pn[pn.ABORTED=10]="ABORTED",pn[pn.OUT_OF_RANGE=11]="OUT_OF_RANGE",pn[pn.UNIMPLEMENTED=12]="UNIMPLEMENTED",pn[pn.INTERNAL=13]="INTERNAL",pn[pn.UNAVAILABLE=14]="UNAVAILABLE",pn[pn.DATA_LOSS=15]="DATA_LOSS";function tQ(){return new TextEncoder}const nQ=new iu([4294967295,4294967295],0);function ZM(n){const e=tQ().encode(n),t=new E6;return t.update(e),new Uint8Array(t.digest())}function QM(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new iu([t,r],0),new iu([i,s],0)]}class cA{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new nm(`Invalid padding: ${t}`);if(r<0)throw new nm(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new nm(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new nm(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=iu.fromNumber(this.ge)}ye(e,t,r){let i=e.add(t.multiply(iu.fromNumber(r)));return i.compare(nQ)===1&&(i=new iu([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=ZM(e),[r,i]=QM(t);for(let s=0;s<this.hashCount;s++){const a=this.ye(r,i,s);if(!this.we(a))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new cA(s,i,t);return r.forEach((o=>a.insert(o))),a}insert(e){if(this.ge===0)return;const t=ZM(e),[r,i]=QM(t);for(let s=0;s<this.hashCount;s++){const a=this.ye(r,i,s);this.Se(a)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class nm extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class gw{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,f1.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new gw(kt.min(),i,new mr(qt),Xs(),an())}}class f1{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new f1(r,t,an(),an(),an())}}class V_{constructor(e,t,r,i){this.be=e,this.removedTargetIds=t,this.key=r,this.De=i}}class IF{constructor(e,t){this.targetId=e,this.Ce=t}}class AF{constructor(e,t,r=Yr.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class JM{constructor(){this.ve=0,this.Fe=eN(),this.Me=Yr.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=an(),t=an(),r=an();return this.Fe.forEach(((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:Et(38017,{changeType:s})}})),new f1(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=eN()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,At(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class rQ{constructor(e){this.Ge=e,this.ze=new Map,this.je=Xs(),this.Je=Jy(),this.He=Jy(),this.Ye=new mr(qt)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:Et(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,i)=>{this.rt(i)&&t(i)}))}st(e){const t=e.targetId,r=e.Ce.count,i=this.ot(t);if(i){const s=i.target;if(Lx(s))if(r===0){const a=new ct(s.path);this.et(t,a,Rr.newNoDocument(a,kt.min()))}else At(r===1,20013,{expectedCount:r});else{const a=this._t(t);if(a!==r){const o=this.ut(e),l=o?this.ct(o,e,a):1;if(l!==0){this.it(t);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,u)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t;let a,o;try{a=zl(r).toUint8Array()}catch(l){if(l instanceof Y6)return Hh("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new cA(a,i,s)}catch(l){return Hh(l instanceof nm?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.ge===0?null:o}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let i=0;return r.forEach((s=>{const a=this.Ge.ht(),o=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(o)||(this.et(t,s,null),i++)})),i}Tt(e){const t=new Map;this.ze.forEach(((s,a)=>{const o=this.ot(a);if(o){if(s.current&&Lx(o.target)){const l=new ct(o.target.path);this.It(l).has(a)||this.Et(a,l)||this.et(a,l,Rr.newNoDocument(l,e))}s.Be&&(t.set(a,s.ke()),s.qe())}}));let r=an();this.He.forEach(((s,a)=>{let o=!0;a.forEachWhile((l=>{const u=this.ot(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)})),o&&(r=r.add(s))})),this.je.forEach(((s,a)=>a.setReadTime(e)));const i=new gw(e,t,this.Ye,this.je,r);return this.je=Xs(),this.Je=Jy(),this.He=Jy(),this.Ye=new mr(qt),i}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,t)?i.Qe(t,1):i.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new JM,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Hn(qt),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Hn(qt),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Ze("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new JM),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Jy(){return new mr(ct.comparator)}function eN(){return new mr(ct.comparator)}const iQ={asc:"ASCENDING",desc:"DESCENDING"},sQ={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},aQ={and:"AND",or:"OR"};class oQ{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function HT(n,e){return n.useProto3Json||rw(e)?e:{value:e}}function b0(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function RF(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function lQ(n,e){return b0(n,e.toTimestamp())}function cs(n){return At(!!n,49232),kt.fromTimestamp((function(t){const r=Ul(t);return new zn(r.seconds,r.nanos)})(n))}function uA(n,e){return KT(n,e).canonicalString()}function KT(n,e){const t=(function(i){return new Pn(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function CF(n){const e=Pn.fromString(n);return At(jF(e),10190,{key:e.toString()}),e}function Dx(n,e){return uA(n.databaseId,e.path)}function Ch(n,e){const t=CF(e);if(t.get(1)!==n.databaseId.projectId)throw new at(Pe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new at(Pe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new ct(MF(t))}function PF(n,e){return uA(n.databaseId,e)}function kF(n){const e=CF(n);return e.length===4?Pn.emptyPath():MF(e)}function YT(n){return new Pn(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function MF(n){return At(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function tN(n,e,t){return{name:Dx(n,e),fields:t.value.mapValue.fields}}function cQ(n,e,t){const r=Ch(n,e.name),i=cs(e.updateTime),s=e.createTime?cs(e.createTime):kt.min(),a=new $i({mapValue:{fields:e.fields}}),o=Rr.newFoundDocument(r,i,s,a);return t&&o.setHasCommittedMutations(),t?o.setHasCommittedMutations():o}function uQ(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:Et(39313,{state:u})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=(function(u,h){return u.useProto3Json?(At(h===void 0||typeof h=="string",58123),Yr.fromBase64String(h||"")):(At(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),Yr.fromUint8Array(h||new Uint8Array))})(n,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&(function(u){const h=u.code===void 0?Pe.UNKNOWN:bF(u.code);return new at(h,u.message||"")})(a);t=new AF(r,i,s,o||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Ch(n,r.document.name),s=cs(r.document.updateTime),a=r.document.createTime?cs(r.document.createTime):kt.min(),o=new $i({mapValue:{fields:r.document.fields}}),l=Rr.newFoundDocument(i,s,a,o),u=r.targetIds||[],h=r.removedTargetIds||[];t=new V_(u,h,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Ch(n,r.document),s=r.readTime?cs(r.readTime):kt.min(),a=Rr.newNoDocument(i,s),o=r.removedTargetIds||[];t=new V_([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Ch(n,r.document),s=r.removedTargetIds||[];t=new V_([],s,i,null)}else{if(!("filter"in e))return Et(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,a=new JZ(i,s),o=r.targetId;t=new IF(o,a)}}return t}function Fx(n,e){let t;if(e instanceof j0)t={update:tN(n,e.key,e.value)};else if(e instanceof fw)t={delete:Dx(n,e.key)};else if(e instanceof Zl)t={update:tN(n,e.key,e.data),updateMask:pQ(e.fieldMask)};else{if(!(e instanceof TF))return Et(16599,{Vt:e.type});t={verify:Dx(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(s,a){const o=a.transform;if(o instanceof E0)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof S0)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof T0)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof pp)return{fieldPath:a.field.canonicalString(),increment:o.Ae};throw Et(20930,{transform:a.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(i,s){return s.updateTime!==void 0?{updateTime:lQ(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Et(27497)})(n,e.precondition)),t}function qT(n,e){const t=e.currentDocument?(function(s){return s.updateTime!==void 0?Wi.updateTime(cs(s.updateTime)):s.exists!==void 0?Wi.exists(s.exists):Wi.none()})(e.currentDocument):Wi.none(),r=e.updateTransforms?e.updateTransforms.map((i=>(function(a,o){let l=null;if("setToServerValue"in o)At(o.setToServerValue==="REQUEST_TIME",16630,{proto:o}),l=new E0;else if("appendMissingElements"in o){const h=o.appendMissingElements.values||[];l=new S0(h)}else if("removeAllFromArray"in o){const h=o.removeAllFromArray.values||[];l=new T0(h)}else"increment"in o?l=new pp(a,o.increment):Et(16584,{proto:o});const u=wr.fromServerFormat(o.fieldPath);return new wF(u,l)})(n,i))):[];if(e.update){e.update.name;const i=Ch(n,e.update.name),s=new $i({mapValue:{fields:e.update.fields}});if(e.updateMask){const a=(function(l){const u=l.fieldPaths||[];return new Is(u.map((h=>wr.fromServerFormat(h))))})(e.updateMask);return new Zl(i,s,a,t,r)}return new j0(i,s,t,r)}if(e.delete){const i=Ch(n,e.delete);return new fw(i,t)}if(e.verify){const i=Ch(n,e.verify);return new TF(i,t)}return Et(1463,{proto:e})}function hQ(n,e){return n&&n.length>0?(At(e!==void 0,14353),n.map((t=>(function(i,s){let a=i.updateTime?cs(i.updateTime):cs(s);return a.isEqual(kt.min())&&(a=cs(s)),new XZ(a,i.transformResults||[])})(t,e)))):[]}function NF(n,e){return{documents:[PF(n,e.path)]}}function LF(n,e){const t={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=PF(n,i);const s=(function(u){if(u.length!==0)return FF($n.create(u,"and"))})(e.filters);s&&(t.structuredQuery.where=s);const a=(function(u){if(u.length!==0)return u.map((h=>(function(g){return{field:bf(g.field),direction:fQ(g.dir)}})(h)))})(e.orderBy);a&&(t.structuredQuery.orderBy=a);const o=HT(n,e.limit);return o!==null&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt=(function(u){return{before:u.inclusive,values:u.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(u){return{before:!u.inclusive,values:u.position}})(e.endAt)),{ft:t,parent:i}}function OF(n){let e=kF(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){At(r===1,65062);const h=t.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let s=[];t.where&&(s=(function(f){const g=DF(f);return g instanceof $n&&iA(g)?g.getFilters():[g]})(t.where));let a=[];t.orderBy&&(a=(function(f){return f.map((g=>(function(v){return new Nx(If(v.field),(function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(v.direction))})(g)))})(t.orderBy));let o=null;t.limit&&(o=(function(f){let g;return g=typeof f=="object"?f.value:f,rw(g)?null:g})(t.limit));let l=null;t.startAt&&(l=(function(f){const g=!!f.before,y=f.values||[];return new v0(y,g)})(t.startAt));let u=null;return t.endAt&&(u=(function(f){const g=!f.before,y=f.values||[];return new v0(y,g)})(t.endAt)),FZ(e,i,a,s,o,"F",l,u)}function dQ(n,e){const t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Et(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function DF(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=If(t.unaryFilter.field);return dn.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=If(t.unaryFilter.field);return dn.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=If(t.unaryFilter.field);return dn.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=If(t.unaryFilter.field);return dn.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Et(61313);default:return Et(60726)}})(n):n.fieldFilter!==void 0?(function(t){return dn.create(If(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Et(58110);default:return Et(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return $n.create(t.compositeFilter.filters.map((r=>DF(r))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Et(1026)}})(t.compositeFilter.op))})(n):Et(30097,{filter:n})}function fQ(n){return iQ[n]}function gQ(n){return sQ[n]}function mQ(n){return aQ[n]}function bf(n){return{fieldPath:n.canonicalString()}}function If(n){return wr.fromServerFormat(n.fieldPath)}function FF(n){return n instanceof dn?(function(t){if(t.op==="=="){if(VM(t.value))return{unaryFilter:{field:bf(t.field),op:"IS_NAN"}};if(jM(t.value))return{unaryFilter:{field:bf(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(VM(t.value))return{unaryFilter:{field:bf(t.field),op:"IS_NOT_NAN"}};if(jM(t.value))return{unaryFilter:{field:bf(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:bf(t.field),op:gQ(t.op),value:t.value}}})(n):n instanceof $n?(function(t){const r=t.getFilters().map((i=>FF(i)));return r.length===1?r[0]:{compositeFilter:{op:mQ(t.op),filters:r}}})(n):Et(54877,{filter:n})}function pQ(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function jF(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class Il{constructor(e,t,r,i,s=kt.min(),a=kt.min(),o=Yr.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new Il(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Il(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Il(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Il(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class VF{constructor(e){this.yt=e}}function yQ(n,e){let t;if(e.document)t=cQ(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=ct.fromSegments(e.noDocument.path),i=Xh(e.noDocument.readTime);t=Rr.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Et(56709);{const r=ct.fromSegments(e.unknownDocument.path),i=Xh(e.unknownDocument.version);t=Rr.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime((function(i){const s=new zn(i[0],i[1]);return kt.fromTimestamp(s)})(e.readTime)),t}function nN(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:jx(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=(function(s,a){return{name:Dx(s,a.key),fields:a.data.value.mapValue.fields,updateTime:b0(s,a.version.toTimestamp()),createTime:b0(s,a.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:qh(e.version)};else{if(!e.isUnknownDocument())return Et(57904,{document:e});r.unknownDocument={path:t.path.toArray(),version:qh(e.version)}}return r}function jx(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function qh(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Xh(n){const e=new zn(n.seconds,n.nanoseconds);return kt.fromTimestamp(e)}function dh(n,e){const t=(e.baseMutations||[]).map((s=>qT(n.yt,s)));for(let s=0;s<e.mutations.length-1;++s){const a=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const o=e.mutations[s+1];a.updateTransforms=o.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map((s=>qT(n.yt,s))),i=zn.fromMillis(e.localWriteTimeMs);return new aA(e.batchId,i,t,r)}function rm(n){const e=Xh(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Xh(n.lastLimboFreeSnapshotVersion):kt.min();let r;return r=(function(s){return s.documents!==void 0})(n.query)?(function(s){const a=s.documents.length;return At(a===1,1966,{count:a}),Ta(cw(kF(s.documents[0])))})(n.query):(function(s){return Ta(OF(s))})(n.query),new Il(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Yr.fromBase64String(n.resumeToken))}function GF(n,e){const t=qh(e.snapshotVersion),r=qh(e.lastLimboFreeSnapshotVersion);let i;i=Lx(e.target)?NF(n.yt,e.target):LF(n.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Yh(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function BF(n){const e=OF({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?WT(e,e.limit,"L"):e}function cS(n,e){return new lA(e.largestBatchId,qT(n.yt,e.overlayMutation))}function rN(n,e){const t=e.path.lastSegment();return[n,Ki(e.path.popLast()),t]}function iN(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:qh(r.readTime),documentKey:Ki(r.documentKey.path),largestBatchId:r.largestBatchId}}class _Q{getBundleMetadata(e,t){return sN(e).get(t).next((r=>{if(r)return(function(s){return{id:s.bundleId,createTime:Xh(s.createTime),version:s.version}})(r)}))}saveBundleMetadata(e,t){return sN(e).put((function(i){return{bundleId:i.id,createTime:qh(cs(i.createTime)),version:i.version}})(t))}getNamedQuery(e,t){return aN(e).get(t).next((r=>{if(r)return(function(s){return{name:s.name,query:BF(s.bundledQuery),readTime:Xh(s.readTime)}})(r)}))}saveNamedQuery(e,t){return aN(e).put((function(i){return{name:i.name,readTime:qh(cs(i.readTime)),bundledQuery:i.bundledQuery}})(t))}}function sN(n){return ii(n,iw)}function aN(n){return ii(n,sw)}class mw{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const r=t.uid||"";return new mw(e,r)}getOverlay(e,t){return Gg(e).get(rN(this.userId,t)).next((r=>r?cS(this.serializer,r):null))}getOverlays(e,t){const r=Do();return de.forEach(t,(i=>this.getOverlay(e,i).next((s=>{s!==null&&r.set(i,s)})))).next((()=>r))}saveOverlays(e,t,r){const i=[];return r.forEach(((s,a)=>{const o=new lA(t,a);i.push(this.St(e,o))})),de.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach((a=>i.add(Ki(a.getCollectionPath()))));const s=[];return i.forEach((a=>{const o=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,r+1],!1,!0);s.push(Gg(e).Z(FT,o))})),de.waitFor(s)}getOverlaysForCollection(e,t,r){const i=Do(),s=Ki(t),a=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Gg(e).J(FT,a).next((o=>{for(const l of o){const u=cS(this.serializer,l);i.set(u.getKey(),u)}return i}))}getOverlaysForCollectionGroup(e,t,r,i){const s=Do();let a;const o=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Gg(e).ee({index:U6,range:o},((l,u,h)=>{const f=cS(this.serializer,u);s.size()<i||f.largestBatchId===a?(s.set(f.getKey(),f),a=f.largestBatchId):h.done()})).next((()=>s))}St(e,t){return Gg(e).put((function(i,s,a){const[o,l,u]=rN(s,a.mutation.key);return{userId:s,collectionPath:l,documentId:u,collectionGroup:a.mutation.key.getCollectionGroup(),largestBatchId:a.largestBatchId,overlayMutation:Fx(i.yt,a.mutation)}})(this.serializer,this.userId,t))}}function Gg(n){return ii(n,aw)}class xQ{bt(e){return ii(e,JI)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const r=t?.value;return r?Yr.fromUint8Array(r):Yr.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class fh{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(gr(e.integerValue));else if("doubleValue"in e){const r=gr(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),lp(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),typeof r=="string"&&(r=Ul(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(zl(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?eF(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):lw(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):Et(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const r=e.fields||{};this.Ft(t,55);for(const i of Object.keys(r))this.Ot(i,t),this.Ct(r[i],t)}kt(e,t){const r=e.fields||{};this.Ft(t,53);const i=_0,s=r[i].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(gr(s)),this.Ot(i,t),this.Ct(r[i],t)}Qt(e,t){const r=e.values||[];this.Ft(t,50);for(const i of r)this.Ct(i,t)}Lt(e,t){this.Ft(t,37),ct.fromName(e).path.forEach((r=>{this.Ft(t,60),this.Ut(r,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}fh.Kt=new fh;const uf=255;function vQ(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function oN(n){const e=64-(function(r){let i=0;for(let s=0;s<8;++s){const a=vQ(255&r[s]);if(i+=a,a!==8)break}return i})(n);return Math.ceil(e/8)}class wQ{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Gt(r.value),r=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Jt(r.value),r=t.next();this.Ht()}Yt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const i=t.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Zt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const i=t.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Ht()}Xt(e){const t=this.en(e),r=oN(t);this.tn(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}nn(e){const t=this.en(e),r=oN(t);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}rn(){this.sn(uf),this.sn(255)}_n(){this.an(uf),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(s){const a=new DataView(new ArrayBuffer(8));return a.setFloat64(0,s,!1),new Uint8Array(a.buffer)})(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===uf?(this.sn(uf),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===uf?(this.an(uf),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class EQ{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class SQ{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Bg{constructor(){this.cn=new wQ,this.ln=new EQ(this.cn),this.hn=new SQ(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class gh{constructor(e,t,r,i){this.Tn=e,this.In=t,this.En=r,this.dn=i}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.dn,0),t!==e?r.set([0],this.dn.length):++r[r.length-1],new gh(this.Tn,this.In,this.En,r)}Rn(e,t,r){return{indexId:this.Tn,uid:e,arrayValue:G_(this.En),directionalValue:G_(this.dn),orderedDocumentKey:G_(t),documentKey:r.path.toArray()}}Vn(e,t,r){const i=this.Rn(e,t,r);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function Cc(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=lN(n.En,e.En),t!==0?t:(t=lN(n.dn,e.dn),t!==0?t:ct.comparator(n.In,e.In)))}function lN(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}function G_(n){return DD()?(function(t){let r="";for(let i=0;i<t.length;i++)r+=String.fromCharCode(t[i]);return r})(n):n}function cN(n){return typeof n!="string"?n:(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(n)}class uN{constructor(e){this.mn=new Hn(((t,r)=>wr.comparator(t.field,r.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const r=t;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(At(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=LT(e);if(t!==void 0&&!this.wn(t))return!1;const r=sh(e);let i=new Set,s=0,a=0;for(;s<r.length&&this.wn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.mn.size>0){const o=this.mn.getIterator().getNext();if(!i.has(o.field.canonicalString())){const l=r[s];if(!this.Sn(o,l)||!this.bn(this.fn[a++],l))return!1}++s}for(;s<r.length;++s){const o=r[s];if(a>=this.fn.length||!this.bn(this.fn[a++],o))return!1}return!0}Dn(){if(this.pn)return null;let e=new Hn(wr.comparator);const t=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new M_(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new M_(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new M_(r.field,r.dir==="asc"?0:1)));return new Rx(Rx.UNKNOWN_ID,this.collectionId,t,op.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function UF(n){if(At(n instanceof dn||n instanceof $n,20012),n instanceof dn){if(n instanceof cF){const t=n.value.arrayValue?.values?.map((r=>dn.create(n.field,"==",r)))||[];return $n.create(t,"or")}return n}const e=n.filters.map((t=>UF(t)));return $n.create(e,n.op)}function TQ(n){if(n.getFilters().length===0)return[];const e=QT(UF(n));return At(zF(e),7391),XT(e)||ZT(e)?[e]:e.getFilters()}function XT(n){return n instanceof dn}function ZT(n){return n instanceof $n&&iA(n)}function zF(n){return XT(n)||ZT(n)||(function(t){if(t instanceof $n&&BT(t)){for(const r of t.getFilters())if(!XT(r)&&!ZT(r))return!1;return!0}return!1})(n)}function QT(n){if(At(n instanceof dn||n instanceof $n,34018),n instanceof dn)return n;if(n.filters.length===1)return QT(n.filters[0]);const e=n.filters.map((r=>QT(r)));let t=$n.create(e,n.op);return t=Vx(t),zF(t)?t:(At(t instanceof $n,64498),At(w0(t),40251),At(t.filters.length>1,57927),t.filters.reduce(((r,i)=>hA(r,i))))}function hA(n,e){let t;return At(n instanceof dn||n instanceof $n,38388),At(e instanceof dn||e instanceof $n,25473),t=n instanceof dn?e instanceof dn?(function(i,s){return $n.create([i,s],"and")})(n,e):hN(n,e):e instanceof dn?hN(e,n):(function(i,s){if(At(i.filters.length>0&&s.filters.length>0,48005),w0(i)&&w0(s))return aF(i,s.getFilters());const a=BT(i)?i:s,o=BT(i)?s:i,l=a.filters.map((u=>hA(u,o)));return $n.create(l,"or")})(n,e),Vx(t)}function hN(n,e){if(w0(e))return aF(e,n.getFilters());{const t=e.filters.map((r=>hA(n,r)));return $n.create(t,"or")}}function Vx(n){if(At(n instanceof dn||n instanceof $n,11850),n instanceof dn)return n;const e=n.getFilters();if(e.length===1)return Vx(e[0]);if(iF(n))return n;const t=e.map((i=>Vx(i))),r=[];return t.forEach((i=>{i instanceof dn?r.push(i):i instanceof $n&&(i.op===n.op?r.push(...i.filters):r.push(i))})),r.length===1?r[0]:$n.create(r,n.op)}class bQ{constructor(){this.Cn=new dA}addToCollectionParentIndex(e,t){return this.Cn.add(t),de.resolve()}getCollectionParents(e,t){return de.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return de.resolve()}deleteFieldIndex(e,t){return de.resolve()}deleteAllFieldIndexes(e){return de.resolve()}createTargetIndexes(e,t){return de.resolve()}getDocumentsMatchingTarget(e,t){return de.resolve(null)}getIndexType(e,t){return de.resolve(0)}getFieldIndexes(e,t){return de.resolve([])}getNextCollectionGroupToUpdate(e){return de.resolve(null)}getMinOffset(e,t){return de.resolve(ta.min())}getMinOffsetFromCollectionGroup(e,t){return de.resolve(ta.min())}updateCollectionGroup(e,t,r){return de.resolve()}updateIndexEntries(e,t){return de.resolve()}}class dA{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Hn(Pn.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Hn(Pn.comparator)).toArray()}}const dN="IndexedDbIndexManager",e_=new Uint8Array(0);class IQ{constructor(e,t){this.databaseId=t,this.vn=new dA,this.Fn=new Xl((r=>Yh(r)),((r,i)=>u1(r,i))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const s={collectionId:r,parent:Ki(i)};return fN(e).put(s)}return de.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[P6(t),""],!1,!0);return fN(e).J(i).next((s=>{for(const a of s){if(a.collectionId!==t)break;r.push(Oo(a.parent))}return r}))}addFieldIndex(e,t){const r=Ug(e),i=(function(o){return{indexId:o.indexId,collectionGroup:o.collectionGroup,fields:o.fields.map((l=>[l.fieldPath.canonicalString(),l.kind]))}})(t);delete i.indexId;const s=r.add(i);if(t.indexState){const a=df(e);return s.next((o=>{a.put(iN(o,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return s.next()}deleteFieldIndex(e,t){const r=Ug(e),i=df(e),s=hf(e);return r.delete(t.indexId).next((()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=Ug(e),r=hf(e),i=df(e);return t.Z().next((()=>r.Z())).next((()=>i.Z()))}createTargetIndexes(e,t){return de.forEach(this.Mn(t),(r=>this.getIndexType(e,r).next((i=>{if(i===0||i===1){const s=new uN(r).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))))}getDocumentsMatchingTarget(e,t){const r=hf(e);let i=!0;const s=new Map;return de.forEach(this.Mn(t),(a=>this.xn(e,a).next((o=>{i&&(i=!!o),s.set(a,o)})))).next((()=>{if(i){let a=an();const o=[];return de.forEach(s,((l,u)=>{Ze(dN,`Using index ${(function(I){return`id=${I.indexId}|cg=${I.collectionGroup}|f=${I.fields.map((M=>`${M.fieldPath}:${M.kind}`)).join(",")}`})(l)} to execute ${Yh(t)}`);const h=(function(I,M){const F=LT(M);if(F===void 0)return null;for(const z of Ox(I,F.fieldPath))switch(z.op){case"array-contains-any":return z.value.arrayValue.values||[];case"array-contains":return[z.value]}return null})(u,l),f=(function(I,M){const F=new Map;for(const z of sh(M))for(const k of Ox(I,z.fieldPath))switch(k.op){case"==":case"in":F.set(z.fieldPath.canonicalString(),k.value);break;case"not-in":case"!=":return F.set(z.fieldPath.canonicalString(),k.value),Array.from(F.values())}return null})(u,l),g=(function(I,M){const F=[];let z=!0;for(const k of sh(M)){const C=k.kind===0?$M(I,k.fieldPath,I.startAt):WM(I,k.fieldPath,I.startAt);F.push(C.value),z&&(z=C.inclusive)}return new v0(F,z)})(u,l),y=(function(I,M){const F=[];let z=!0;for(const k of sh(M)){const C=k.kind===0?WM(I,k.fieldPath,I.endAt):$M(I,k.fieldPath,I.endAt);F.push(C.value),z&&(z=C.inclusive)}return new v0(F,z)})(u,l),v=this.On(l,u,g),x=this.On(l,u,y),E=this.Nn(l,u,f),T=this.Bn(l.indexId,h,v,g.inclusive,x,y.inclusive,E);return de.forEach(T,(b=>r.Y(b,t.limit).next((I=>{I.forEach((M=>{const F=ct.fromSegments(M.documentKey);a.has(F)||(a=a.add(F),o.push(F))}))}))))})).next((()=>o))}return de.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=TQ($n.create(e.filters,"and")).map((r=>zT(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,r,i,s,a,o){const l=(t!=null?t.length:1)*Math.max(r.length,s.length),u=l/(t!=null?t.length:1),h=[];for(let f=0;f<l;++f){const g=t?this.Ln(t[f/u]):e_,y=this.kn(e,g,r[f%u],i),v=this.qn(e,g,s[f%u],a),x=o.map((E=>this.kn(e,g,E,!0)));h.push(...this.createRange(y,v,x))}return h}kn(e,t,r,i){const s=new gh(e,ct.empty(),t,r);return i?s:s.An()}qn(e,t,r,i){const s=new gh(e,ct.empty(),t,r);return i?s.An():s}xn(e,t){const r=new uN(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next((s=>{let a=null;for(const o of s)r.yn(o)&&(!a||o.fields.length>a.fields.length)&&(a=o);return a}))}getIndexType(e,t){let r=2;const i=this.Mn(t);return de.forEach(i,(s=>this.xn(e,s).next((a=>{a?r!==0&&a.fields.length<(function(l){let u=new Hn(wr.comparator),h=!1;for(const f of l.filters)for(const g of f.getFlattenedFilters())g.field.isKeyField()||(g.op==="array-contains"||g.op==="array-contains-any"?h=!0:u=u.add(g.field));for(const f of l.orderBy)f.field.isKeyField()||(u=u.add(f.field));return u.size+(h?1:0)})(s)&&(r=1):r=0})))).next((()=>(function(a){return a.limit!==null})(t)&&i.length>1&&r===2?1:r))}Qn(e,t){const r=new Bg;for(const i of sh(e)){const s=t.data.field(i.fieldPath);if(s==null)return null;const a=r.Pn(i.kind);fh.Kt.Dt(s,a)}return r.un()}Ln(e){const t=new Bg;return fh.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const r=new Bg;return fh.Kt.Dt(gp(this.databaseId,t),r.Pn((function(s){const a=sh(s);return a.length===0?0:a[a.length-1].kind})(e))),r.un()}Nn(e,t,r){if(r===null)return[];let i=[];i.push(new Bg);let s=0;for(const a of sh(e)){const o=r[s++];for(const l of i)if(this.Un(t,a.fieldPath)&&mp(o))i=this.Kn(i,a,o);else{const u=l.Pn(a.kind);fh.Kt.Dt(o,u)}}return this.Wn(i)}On(e,t,r){return this.Nn(e,t,r.position)}Wn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].un();return t}Kn(e,t,r){const i=[...e],s=[];for(const a of r.arrayValue.values||[])for(const o of i){const l=new Bg;l.seed(o.un()),fh.Kt.Dt(a,l.Pn(t.kind)),s.push(l)}return s}Un(e,t){return!!e.filters.find((r=>r instanceof dn&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in")))}getFieldIndexes(e,t){const r=Ug(e),i=df(e);return(t?r.J(DT,IDBKeyRange.bound(t,t)):r.J()).next((s=>{const a=[];return de.forEach(s,(o=>i.get([o.indexId,this.uid]).next((l=>{a.push((function(h,f){const g=f?new op(f.sequenceNumber,new ta(Xh(f.readTime),new ct(Oo(f.documentKey)),f.largestBatchId)):op.empty(),y=h.fields.map((([v,x])=>new M_(wr.fromServerFormat(v),x)));return new Rx(h.indexId,h.collectionGroup,y,g)})(o,l))})))).next((()=>a))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:qt(r.collectionGroup,i.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,r){const i=Ug(e),s=df(e);return this.Gn(e).next((a=>i.J(DT,IDBKeyRange.bound(t,t)).next((o=>de.forEach(o,(l=>s.put(iN(l.indexId,this.uid,a,r))))))))}updateIndexEntries(e,t){const r=new Map;return de.forEach(t,((i,s)=>{const a=r.get(i.collectionGroup);return(a?de.resolve(a):this.getFieldIndexes(e,i.collectionGroup)).next((o=>(r.set(i.collectionGroup,o),de.forEach(o,(l=>this.zn(e,i,l).next((u=>{const h=this.jn(s,l);return u.isEqual(h)?de.resolve():this.Jn(e,s,l,u,h)})))))))}))}Hn(e,t,r,i){return hf(e).put(i.Rn(this.uid,this.$n(r,t.key),t.key))}Yn(e,t,r,i){return hf(e).delete(i.Vn(this.uid,this.$n(r,t.key),t.key))}zn(e,t,r){const i=hf(e);let s=new Hn(Cc);return i.ee({index:B6,range:IDBKeyRange.only([r.indexId,this.uid,G_(this.$n(r,t))])},((a,o)=>{s=s.add(new gh(r.indexId,t,cN(o.arrayValue),cN(o.directionalValue)))})).next((()=>s))}jn(e,t){let r=new Hn(Cc);const i=this.Qn(t,e);if(i==null)return r;const s=LT(t);if(s!=null){const a=e.data.field(s.fieldPath);if(mp(a))for(const o of a.arrayValue.values||[])r=r.add(new gh(t.indexId,e.key,this.Ln(o),i))}else r=r.add(new gh(t.indexId,e.key,e_,i));return r}Jn(e,t,r,i,s){Ze(dN,"Updating index entries for document '%s'",t.key);const a=[];return(function(l,u,h,f,g){const y=l.getIterator(),v=u.getIterator();let x=cf(y),E=cf(v);for(;x||E;){let T=!1,b=!1;if(x&&E){const I=h(x,E);I<0?b=!0:I>0&&(T=!0)}else x!=null?b=!0:T=!0;T?(f(E),E=cf(v)):b?(g(x),x=cf(y)):(x=cf(y),E=cf(v))}})(i,s,Cc,(o=>{a.push(this.Hn(e,t,r,o))}),(o=>{a.push(this.Yn(e,t,r,o))})),de.waitFor(a)}Gn(e){let t=1;return df(e).ee({index:G6,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((r,i,s)=>{s.done(),t=i.sequenceNumber+1})).next((()=>t))}createRange(e,t,r){r=r.sort(((a,o)=>Cc(a,o))).filter(((a,o,l)=>!o||Cc(a,l[o-1])!==0));const i=[];i.push(e);for(const a of r){const o=Cc(a,e),l=Cc(a,t);if(o===0)i[0]=e.An();else if(o>0&&l<0)i.push(a),i.push(a.An());else if(l>0)break}i.push(t);const s=[];for(let a=0;a<i.length;a+=2){if(this.Zn(i[a],i[a+1]))return[];const o=i[a].Vn(this.uid,e_,ct.empty()),l=i[a+1].Vn(this.uid,e_,ct.empty());s.push(IDBKeyRange.bound(o,l))}return s}Zn(e,t){return Cc(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(gN)}getMinOffset(e,t){return de.mapArray(this.Mn(t),(r=>this.xn(e,r).next((i=>i||Et(44426))))).next(gN)}}function fN(n){return ii(n,hp)}function hf(n){return ii(n,xm)}function Ug(n){return ii(n,QI)}function df(n){return ii(n,_m)}function gN(n){At(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;qI(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new ta(e.readTime,e.documentKey,t)}const mN={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},$F=41943040;class Ui{static withCacheSize(e){return new Ui(e,Ui.DEFAULT_COLLECTION_PERCENTILE,Ui.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}function WF(n,e,t){const r=n.store(za),i=n.store(g0),s=[],a=IDBKeyRange.only(t.batchId);let o=0;const l=r.ee({range:a},((h,f,g)=>(o++,g.delete())));s.push(l.next((()=>{At(o===1,47070,{batchId:t.batchId})})));const u=[];for(const h of t.mutations){const f=F6(e,h.key.path,t.batchId);s.push(i.delete(f)),u.push(h.key)}return de.waitFor(s).next((()=>u))}function Gx(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Et(14731);e=n.noDocument}return JSON.stringify(e).length}Ui.DEFAULT_COLLECTION_PERCENTILE=10,Ui.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ui.DEFAULT=new Ui($F,Ui.DEFAULT_COLLECTION_PERCENTILE,Ui.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ui.DISABLED=new Ui(-1,0,0);class pw{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Xn={}}static wt(e,t,r,i){At(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new pw(s,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Pc(e).ee({index:wh,range:r},((i,s,a)=>{t=!1,a.done()})).next((()=>t))}addMutationBatch(e,t,r,i){const s=Af(e),a=Pc(e);return a.add({}).next((o=>{At(typeof o=="number",49019);const l=new aA(o,t,r,i),u=(function(y,v,x){const E=x.baseMutations.map((b=>Fx(y.yt,b))),T=x.mutations.map((b=>Fx(y.yt,b)));return{userId:v,batchId:x.batchId,localWriteTimeMs:x.localWriteTime.toMillis(),baseMutations:E,mutations:T}})(this.serializer,this.userId,l),h=[];let f=new Hn(((g,y)=>qt(g.canonicalString(),y.canonicalString())));for(const g of i){const y=F6(this.userId,g.key.path,o);f=f.add(g.key.path.popLast()),h.push(a.put(u)),h.push(s.put(y,tZ))}return f.forEach((g=>{h.push(this.indexManager.addToCollectionParentIndex(e,g))})),e.addOnCommittedListener((()=>{this.Xn[o]=l.keys()})),de.waitFor(h).next((()=>l))}))}lookupMutationBatch(e,t){return Pc(e).get(t).next((r=>r?(At(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:t}),dh(this.serializer,r)):null))}er(e,t){return this.Xn[t]?de.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((r=>{if(r){const i=r.keys();return this.Xn[t]=i,i}return null}))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return Pc(e).ee({index:wh,range:i},((a,o,l)=>{o.userId===this.userId&&(At(o.batchId>=r,47524,{tr:r}),s=dh(this.serializer,o)),l.done()})).next((()=>s))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=Ah;return Pc(e).ee({index:wh,range:t,reverse:!0},((i,s,a)=>{r=s.batchId,a.done()})).next((()=>r))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Ah],[this.userId,Number.POSITIVE_INFINITY]);return Pc(e).J(wh,t).next((r=>r.map((i=>dh(this.serializer,i)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=N_(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return Af(e).ee({range:i},((a,o,l)=>{const[u,h,f]=a,g=Oo(h);if(u===this.userId&&t.path.isEqual(g))return Pc(e).get(f).next((y=>{if(!y)throw Et(61480,{nr:a,batchId:f});At(y.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:y.userId,batchId:f}),s.push(dh(this.serializer,y))}));l.done()})).next((()=>s))}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Hn(qt);const i=[];return t.forEach((s=>{const a=N_(this.userId,s.path),o=IDBKeyRange.lowerBound(a),l=Af(e).ee({range:o},((u,h,f)=>{const[g,y,v]=u,x=Oo(y);g===this.userId&&s.path.isEqual(x)?r=r.add(v):f.done()}));i.push(l)})),de.waitFor(i).next((()=>this.rr(e,r)))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,s=N_(this.userId,r),a=IDBKeyRange.lowerBound(s);let o=new Hn(qt);return Af(e).ee({range:a},((l,u,h)=>{const[f,g,y]=l,v=Oo(g);f===this.userId&&r.isPrefixOf(v)?v.length===i&&(o=o.add(y)):h.done()})).next((()=>this.rr(e,o)))}rr(e,t){const r=[],i=[];return t.forEach((s=>{i.push(Pc(e).get(s).next((a=>{if(a===null)throw Et(35274,{batchId:s});At(a.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:a.userId,batchId:s}),r.push(dh(this.serializer,a))})))})),de.waitFor(i).next((()=>r))}removeMutationBatch(e,t){return WF(e.le,this.userId,t).next((r=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),de.forEach(r,(i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return de.resolve();const r=IDBKeyRange.lowerBound((function(a){return[a]})(this.userId)),i=[];return Af(e).ee({range:r},((s,a,o)=>{if(s[0]===this.userId){const l=Oo(s[1]);i.push(l)}else o.done()})).next((()=>{At(i.length===0,56720,{sr:i.map((s=>s.canonicalString()))})}))}))}containsKey(e,t){return HF(e,this.userId,t)}_r(e){return KF(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:Ah,lastStreamToken:""}))}}function HF(n,e,t){const r=N_(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r);let a=!1;return Af(n).ee({range:s,X:!0},((o,l,u)=>{const[h,f,g]=o;h===e&&f===i&&(a=!0),u.done()})).next((()=>a))}function Pc(n){return ii(n,za)}function Af(n){return ii(n,g0)}function KF(n){return ii(n,cp)}class Zh{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Zh(0)}static cr(){return new Zh(-1)}}class AQ{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const r=new Zh(t.highestTargetId);return t.highestTargetId=r.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>kt.fromTimestamp(new zn(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,r){return this.lr(e).next((i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.hr(e,i))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((r=>(r.targetCount+=1,this.Tr(t,r),this.hr(e,r))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>ff(e).delete(t.targetId))).next((()=>this.lr(e))).next((r=>(At(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r))))}removeTargets(e,t,r){let i=0;const s=[];return ff(e).ee(((a,o)=>{const l=rm(o);l.sequenceNumber<=t&&r.get(l.targetId)===null&&(i++,s.push(this.removeTargetData(e,l)))})).next((()=>de.waitFor(s))).next((()=>i))}forEachTarget(e,t){return ff(e).ee(((r,i)=>{const s=rm(i);t(s)}))}lr(e){return pN(e).get(kx).next((t=>(At(t!==null,2888),t)))}hr(e,t){return pN(e).put(kx,t)}Pr(e,t){return ff(e).put(GF(this.serializer,t))}Tr(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const r=Yh(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return ff(e).ee({range:i,index:V6},((a,o,l)=>{const u=rm(o);u1(t,u.target)&&(s=u,l.done())})).next((()=>s))}addMatchingKeys(e,t,r){const i=[],s=Bc(e);return t.forEach((a=>{const o=Ki(a.path);i.push(s.put({targetId:r,path:o})),i.push(this.referenceDelegate.addReference(e,r,a))})),de.waitFor(i)}removeMatchingKeys(e,t,r){const i=Bc(e);return de.forEach(t,(s=>{const a=Ki(s.path);return de.waitFor([i.delete([r,a]),this.referenceDelegate.removeReference(e,r,s)])}))}removeMatchingKeysForTargetId(e,t){const r=Bc(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=Bc(e);let s=an();return i.ee({range:r,X:!0},((a,o,l)=>{const u=Oo(a[1]),h=new ct(u);s=s.add(h)})).next((()=>s))}containsKey(e,t){const r=Ki(t.path),i=IDBKeyRange.bound([r],[P6(r)],!1,!0);let s=0;return Bc(e).ee({index:ZI,X:!0,range:i},(([a,o],l,u)=>{a!==0&&(s++,u.done())})).next((()=>s>0))}At(e,t){return ff(e).get(t).next((r=>r?rm(r):null))}}function ff(n){return ii(n,m0)}function pN(n){return ii(n,Rh)}function Bc(n){return ii(n,p0)}const yN="LruGarbageCollector",RQ=1048576;function _N([n,e],[t,r]){const i=qt(n,t);return i===0?qt(e,r):i}class CQ{constructor(e){this.Ir=e,this.buffer=new Hn(_N),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();_N(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class YF{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Ze(yN,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Tu(t)?Ze(yN,"Ignoring IndexedDB error during garbage collection: ",t):await fd(t)}await this.Vr(3e5)}))}}class PQ{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return de.resolve(Ea.ce);const r=new CQ(t);return this.mr.forEachTarget(e,(i=>r.Ar(i.sequenceNumber))).next((()=>this.mr.pr(e,(i=>r.Ar(i))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Ze("LruGarbageCollector","Garbage collection skipped; disabled"),de.resolve(mN)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(Ze("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),mN):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,i,s,a,o,l,u;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((f=>(f>this.params.maximumSequenceNumbersToCollect?(Ze("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),i=this.params.maximumSequenceNumbersToCollect):i=f,a=Date.now(),this.nthSequenceNumber(e,i)))).next((f=>(r=f,o=Date.now(),this.removeTargets(e,r,t)))).next((f=>(s=f,l=Date.now(),this.removeOrphanedDocuments(e,r)))).next((f=>(u=Date.now(),Sf()<=hn.DEBUG&&Ze("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-h}ms
	Determined least recently used ${i} in `+(o-a)+`ms
	Removed ${s} targets in `+(l-o)+`ms
	Removed ${f} documents in `+(u-l)+`ms
Total Duration: ${u-h}ms`),de.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:f}))))}}function qF(n,e){return new PQ(n,e)}class kQ{constructor(e,t){this.db=e,this.garbageCollector=qF(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((r,i)=>t(i)))}addReference(e,t,r){return t_(e,r)}removeReference(e,t,r){return t_(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return t_(e,t)}br(e,t){return(function(i,s){let a=!1;return KF(i).te((o=>HF(i,o,s).next((l=>(l&&(a=!0),de.resolve(!l)))))).next((()=>a))})(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Sr(e,((a,o)=>{if(o<=t){const l=this.br(e,a).next((u=>{if(!u)return s++,r.getEntry(e,a).next((()=>(r.removeEntry(a,kt.min()),Bc(e).delete((function(f){return[0,Ki(f.path)]})(a)))))}));i.push(l)}})).next((()=>de.waitFor(i))).next((()=>r.apply(e))).next((()=>s))}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return t_(e,t)}Sr(e,t){const r=Bc(e);let i,s=Ea.ce;return r.ee({index:ZI},(([a,o],{path:l,sequenceNumber:u})=>{a===0?(s!==Ea.ce&&t(new ct(Oo(i)),s),s=u,i=l):s=Ea.ce})).next((()=>{s!==Ea.ce&&t(new ct(Oo(i)),s)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function t_(n,e){return Bc(n).put((function(r,i){return{targetId:0,path:Ki(r.path),sequenceNumber:i}})(e,n.currentSequenceNumber))}class XF{constructor(){this.changes=new Xl((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Rr.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?de.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class MQ{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Ju(e).put(r)}removeEntry(e,t,r){return Ju(e).delete((function(s,a){const o=s.path.toArray();return[o.slice(0,o.length-2),o[o.length-2],jx(a),o[o.length-1]]})(t,r))}updateMetadata(e,t){return this.getMetadata(e).next((r=>(r.byteSize+=t,this.Dr(e,r))))}getEntry(e,t){let r=Rr.newInvalidDocument(t);return Ju(e).ee({index:L_,range:IDBKeyRange.only(zg(t))},((i,s)=>{r=this.Cr(t,s)})).next((()=>r))}vr(e,t){let r={size:0,document:Rr.newInvalidDocument(t)};return Ju(e).ee({index:L_,range:IDBKeyRange.only(zg(t))},((i,s)=>{r={document:this.Cr(t,s),size:Gx(s)}})).next((()=>r))}getEntries(e,t){let r=Xs();return this.Fr(e,t,((i,s)=>{const a=this.Cr(i,s);r=r.insert(i,a)})).next((()=>r))}Mr(e,t){let r=Xs(),i=new mr(ct.comparator);return this.Fr(e,t,((s,a)=>{const o=this.Cr(s,a);r=r.insert(s,o),i=i.insert(s,Gx(a))})).next((()=>({documents:r,Or:i})))}Fr(e,t,r){if(t.isEmpty())return de.resolve();let i=new Hn(wN);t.forEach((l=>i=i.add(l)));const s=IDBKeyRange.bound(zg(i.first()),zg(i.last())),a=i.getIterator();let o=a.getNext();return Ju(e).ee({index:L_,range:s},((l,u,h)=>{const f=ct.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;o&&wN(o,f)<0;)r(o,null),o=a.getNext();o&&o.isEqual(f)&&(r(o,u),o=a.hasNext()?a.getNext():null),o?h.j(zg(o)):h.done()})).next((()=>{for(;o;)r(o,null),o=a.hasNext()?a.getNext():null}))}getDocumentsMatchingQuery(e,t,r,i,s){const a=t.path,o=[a.popLast().toArray(),a.lastSegment(),jx(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[a.popLast().toArray(),a.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Ju(e).J(IDBKeyRange.bound(o,l,!0)).next((u=>{s?.incrementDocumentReadCount(u.length);let h=Xs();for(const f of u){const g=this.Cr(ct.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);g.isFoundDocument()&&(d1(t,g)||i.has(g.key))&&(h=h.insert(g.key,g))}return h}))}getAllFromCollectionGroup(e,t,r,i){let s=Xs();const a=vN(t,r),o=vN(t,ta.max());return Ju(e).ee({index:j6,range:IDBKeyRange.bound(a,o,!0)},((l,u,h)=>{const f=this.Cr(ct.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);s=s.insert(f.key,f),s.size===i&&h.done()})).next((()=>s))}newChangeBuffer(e){return new NQ(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return xN(e).get(OT).next((t=>(At(!!t,20021),t)))}Dr(e,t){return xN(e).put(OT,t)}Cr(e,t){if(t){const r=yQ(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(kt.min())))return r}return Rr.newInvalidDocument(e)}}function ZF(n){return new MQ(n)}class NQ extends XF{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new Xl((r=>r.toString()),((r,i)=>r.isEqual(i)))}applyChanges(e){const t=[];let r=0,i=new Hn(((s,a)=>qt(s.canonicalString(),a.canonicalString())));return this.changes.forEach(((s,a)=>{const o=this.Br.get(s);if(t.push(this.Nr.removeEntry(e,s,o.readTime)),a.isValidDocument()){const l=nN(this.Nr.serializer,a);i=i.add(s.path.popLast());const u=Gx(l);r+=u-o.size,t.push(this.Nr.addEntry(e,s,l))}else if(r-=o.size,this.trackRemovals){const l=nN(this.Nr.serializer,a.convertToNoDocument(kt.min()));t.push(this.Nr.addEntry(e,s,l))}})),i.forEach((s=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))})),t.push(this.Nr.updateMetadata(e,r)),de.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((r=>(this.Br.set(t,{size:r.size,readTime:r.document.readTime}),r.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:r,Or:i})=>(i.forEach(((s,a)=>{this.Br.set(s,{size:a,readTime:r.get(s).readTime})})),r)))}}function xN(n){return ii(n,up)}function Ju(n){return ii(n,Px)}function zg(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function vN(n,e){const t=e.documentKey.path.toArray();return[n,jx(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function wN(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=qt(t[s],r[s]),i)return i;return i=qt(t.length,r.length),i||(i=qt(t[t.length-2],r[r.length-2]),i||qt(t[t.length-1],r[r.length-1]))}class LQ{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class QF{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(r=i,this.remoteDocumentCache.getEntry(e,t)))).next((i=>(r!==null&&Sm(r.mutation,i,Is.empty(),zn.now()),i)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,an()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=an()){const i=Do();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,r).next((s=>{let a=tm();return s.forEach(((o,l)=>{a=a.insert(o,l.overlayedDocument)})),a}))))}getOverlayedDocuments(e,t){const r=Do();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,an())))}populateOverlays(e,t,r){const i=[];return r.forEach((s=>{t.has(s)||i.push(s)})),this.documentOverlayCache.getOverlays(e,i).next((s=>{s.forEach(((a,o)=>{t.set(a,o)}))}))}computeViews(e,t,r,i){let s=Xs();const a=Em(),o=(function(){return Em()})();return t.forEach(((l,u)=>{const h=r.get(u.key);i.has(u.key)&&(h===void 0||h.mutation instanceof Zl)?s=s.insert(u.key,u):h!==void 0?(a.set(u.key,h.mutation.getFieldMask()),Sm(h.mutation,u,h.mutation.getFieldMask(),zn.now())):a.set(u.key,Is.empty())})),this.recalculateAndSaveOverlays(e,s).next((l=>(l.forEach(((u,h)=>a.set(u,h))),t.forEach(((u,h)=>o.set(u,new LQ(h,a.get(u)??null)))),o)))}recalculateAndSaveOverlays(e,t){const r=Em();let i=new mr(((a,o)=>a-o)),s=an();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((a=>{for(const o of a)o.keys().forEach((l=>{const u=t.get(l);if(u===null)return;let h=r.get(l)||Is.empty();h=o.applyToLocalView(u,h),r.set(l,h);const f=(i.get(o.batchId)||an()).add(l);i=i.insert(o.batchId,f)}))})).next((()=>{const a=[],o=i.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),u=l.key,h=l.value,f=mF();h.forEach((g=>{if(!s.has(g)){const y=EF(t.get(g),r.get(g));y!==null&&f.set(g,y),s=s.add(g)}})),a.push(this.documentOverlayCache.saveOverlays(e,u,f))}return de.waitFor(a)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,i){return(function(a){return ct.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):uF(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next((s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):de.resolve(Do());let o=ap,l=s;return a.next((u=>de.forEach(u,((h,f)=>(o<f.largestBatchId&&(o=f.largestBatchId),s.get(h)?de.resolve():this.remoteDocumentCache.getEntry(e,h).next((g=>{l=l.insert(h,g)}))))).next((()=>this.populateOverlays(e,u,s))).next((()=>this.computeViews(e,l,u,an()))).next((h=>({batchId:o,changes:gF(h)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ct(t)).next((r=>{let i=tm();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const s=t.collectionGroup;let a=tm();return this.indexManager.getCollectionParents(e,s).next((o=>de.forEach(o,(l=>{const u=(function(f,g){return new h1(g,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)})(t,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next((h=>{h.forEach(((f,g)=>{a=a.insert(f,g)}))}))})).next((()=>a))))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i)))).next((a=>{s.forEach(((l,u)=>{const h=u.getKey();a.get(h)===null&&(a=a.insert(h,Rr.newInvalidDocument(h)))}));let o=tm();return a.forEach(((l,u)=>{const h=s.get(l);h!==void 0&&Sm(h.mutation,u,Is.empty(),zn.now()),d1(t,u)&&(o=o.insert(l,u))})),o}))}}class OQ{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return de.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:cs(i.createTime)}})(t)),de.resolve()}getNamedQuery(e,t){return de.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(i){return{name:i.name,query:BF(i.bundledQuery),readTime:cs(i.readTime)}})(t)),de.resolve()}}class DQ{constructor(){this.overlays=new mr(ct.comparator),this.qr=new Map}getOverlay(e,t){return de.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Do();return de.forEach(t,(i=>this.getOverlay(e,i).next((s=>{s!==null&&r.set(i,s)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((i,s)=>{this.St(e,t,s)})),de.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach((s=>this.overlays=this.overlays.remove(s))),this.qr.delete(r)),de.resolve()}getOverlaysForCollection(e,t,r){const i=Do(),s=t.length+1,a=new ct(t.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,u=l.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return de.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new mr(((u,h)=>u-h));const a=this.overlays.getIterator();for(;a.hasNext();){const u=a.getNext().value;if(u.getKey().getCollectionGroup()===t&&u.largestBatchId>r){let h=s.get(u.largestBatchId);h===null&&(h=Do(),s=s.insert(u.largestBatchId,h)),h.set(u.getKey(),u)}}const o=Do(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach(((u,h)=>o.set(u,h))),!(o.size()>=i)););return de.resolve(o)}St(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const a=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new lA(t,r));let s=this.qr.get(t);s===void 0&&(s=an(),this.qr.set(t,s)),this.qr.set(t,s.add(r.key))}}class FQ{constructor(){this.sessionToken=Yr.EMPTY_BYTE_STRING}getSessionToken(e){return de.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,de.resolve()}}class fA{constructor(){this.Qr=new Hn(ui.$r),this.Ur=new Hn(ui.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new ui(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Gr(new ui(e,t))}zr(e,t){e.forEach((r=>this.removeReference(r,t)))}jr(e){const t=new ct(new Pn([])),r=new ui(t,e),i=new ui(t,e+1),s=[];return this.Ur.forEachInRange([r,i],(a=>{this.Gr(a),s.push(a.key)})),s}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new ct(new Pn([])),r=new ui(t,e),i=new ui(t,e+1);let s=an();return this.Ur.forEachInRange([r,i],(a=>{s=s.add(a.key)})),s}containsKey(e){const t=new ui(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class ui{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return ct.comparator(e.key,t.key)||qt(e.Yr,t.Yr)}static Kr(e,t){return qt(e.Yr,t.Yr)||ct.comparator(e.key,t.key)}}class jQ{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Hn(ui.$r)}checkEmpty(e){return de.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new aA(s,t,r,i);this.mutationQueue.push(a);for(const o of i)this.Zr=this.Zr.add(new ui(o.key,s)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return de.resolve(a)}lookupMutationBatch(e,t){return de.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.ei(r),s=i<0?0:i;return de.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return de.resolve(this.mutationQueue.length===0?Ah:this.tr-1)}getAllMutationBatches(e){return de.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new ui(t,0),i=new ui(t,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([r,i],(a=>{const o=this.Xr(a.Yr);s.push(o)})),de.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Hn(qt);return t.forEach((i=>{const s=new ui(i,0),a=new ui(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,a],(o=>{r=r.add(o.Yr)}))})),de.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let s=r;ct.isDocumentKey(s)||(s=s.child(""));const a=new ui(new ct(s),0);let o=new Hn(qt);return this.Zr.forEachWhile((l=>{const u=l.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(o=o.add(l.Yr)),!0)}),a),de.resolve(this.ti(o))}ti(e){const t=[];return e.forEach((r=>{const i=this.Xr(r);i!==null&&t.push(i)})),t}removeMutationBatch(e,t){At(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return de.forEach(t.mutations,(i=>{const s=new ui(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,t){const r=new ui(t,0),i=this.Zr.firstAfterOrEqual(r);return de.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,de.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class VQ{constructor(e){this.ri=e,this.docs=(function(){return new mr(ct.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),s=i?i.size:0,a=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return de.resolve(r?r.document.mutableCopy():Rr.newInvalidDocument(t))}getEntries(e,t){let r=Xs();return t.forEach((i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Rr.newInvalidDocument(i))})),de.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=Xs();const a=t.path,o=new ct(a.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:u,value:{document:h}}=l.getNext();if(!a.isPrefixOf(u.path))break;u.path.length>a.length+1||qI(N6(h),r)<=0||(i.has(h.key)||d1(t,h))&&(s=s.insert(h.key,h.mutableCopy()))}return de.resolve(s)}getAllFromCollectionGroup(e,t,r,i){Et(9500)}ii(e,t){return de.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new GQ(this)}getSize(e){return de.resolve(this.size)}}class GQ extends XF{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,i)=>{i.isValidDocument()?t.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)})),de.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class BQ{constructor(e){this.persistence=e,this.si=new Xl((t=>Yh(t)),u1),this.lastRemoteSnapshotVersion=kt.min(),this.highestTargetId=0,this.oi=0,this._i=new fA,this.targetCount=0,this.ai=Zh.ur()}forEachTarget(e,t){return this.si.forEach(((r,i)=>t(i))),de.resolve()}getLastRemoteSnapshotVersion(e){return de.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return de.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),de.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),de.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Zh(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,de.resolve()}updateTargetData(e,t){return this.Pr(t),de.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,de.resolve()}removeTargets(e,t,r){let i=0;const s=[];return this.si.forEach(((a,o)=>{o.sequenceNumber<=t&&r.get(o.targetId)===null&&(this.si.delete(a),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)})),de.waitFor(s).next((()=>i))}getTargetCount(e){return de.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return de.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),de.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach((a=>{s.push(i.markPotentiallyOrphaned(e,a))})),de.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),de.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return de.resolve(r)}containsKey(e,t){return de.resolve(this._i.containsKey(t))}}class gA{constructor(e,t){this.ui={},this.overlays={},this.ci=new Ea(0),this.li=!1,this.li=!0,this.hi=new FQ,this.referenceDelegate=e(this),this.Pi=new BQ(this),this.indexManager=new bQ,this.remoteDocumentCache=(function(i){return new VQ(i)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new VF(t),this.Ii=new OQ(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new DQ,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new jQ(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){Ze("MemoryPersistence","Starting transaction:",e);const i=new UQ(this.ci.next());return this.referenceDelegate.Ei(),r(i).next((s=>this.referenceDelegate.di(i).next((()=>s)))).toPromise().then((s=>(i.raiseOnCommittedEvent(),s)))}Ai(e,t){return de.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,t))))}}class UQ extends O6{constructor(e){super(),this.currentSequenceNumber=e}}class yw{constructor(e){this.persistence=e,this.Ri=new fA,this.Vi=null}static mi(e){return new yw(e)}get fi(){if(this.Vi)return this.Vi;throw Et(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),de.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),de.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),de.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((i=>this.fi.add(i.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((i=>{i.forEach((s=>this.fi.add(s.toString())))})).next((()=>r.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return de.forEach(this.fi,(r=>{const i=ct.fromPath(r);return this.gi(e,i).next((s=>{s||t.removeEntry(i,kt.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return de.or([()=>de.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Bx{constructor(e,t){this.persistence=e,this.pi=new Xl((r=>Ki(r.path)),((r,i)=>r.isEqual(i))),this.garbageCollector=qF(this,t)}static mi(e,t){return new Bx(e,t)}Ei(){}di(e){return de.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}pr(e,t){return de.forEach(this.pi,((r,i)=>this.br(e,r,i).next((s=>s?de.resolve():t(i)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ii(e,(a=>this.br(e,a,t).next((o=>{o||(r++,s.removeEntry(a,kt.min()))})))).next((()=>s.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),de.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),de.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),de.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),de.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=D_(e.data.value)),t}br(e,t,r){return de.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.pi.get(t);return de.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class zQ{constructor(e){this.serializer=e}k(e,t,r,i){const s=new nw("createOrUpgrade",t);r<1&&i>=1&&((function(l){l.createObjectStore(c1)})(e),(function(l){l.createObjectStore(cp,{keyPath:eZ}),l.createObjectStore(za,{keyPath:MM,autoIncrement:!0}).createIndex(wh,NM,{unique:!0}),l.createObjectStore(g0)})(e),EN(e),(function(l){l.createObjectStore(ah)})(e));let a=de.resolve();return r<3&&i>=3&&(r!==0&&((function(l){l.deleteObjectStore(p0),l.deleteObjectStore(m0),l.deleteObjectStore(Rh)})(e),EN(e)),a=a.next((()=>(function(l){const u=l.store(Rh),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:kt.min().toTimestamp(),targetCount:0};return u.put(kx,h)})(s)))),r<4&&i>=4&&(r!==0&&(a=a.next((()=>(function(l,u){return u.store(za).J().next((f=>{l.deleteObjectStore(za),l.createObjectStore(za,{keyPath:MM,autoIncrement:!0}).createIndex(wh,NM,{unique:!0});const g=u.store(za),y=f.map((v=>g.put(v)));return de.waitFor(y)}))})(e,s)))),a=a.next((()=>{(function(l){l.createObjectStore(y0,{keyPath:cZ})})(e)}))),r<5&&i>=5&&(a=a.next((()=>this.yi(s)))),r<6&&i>=6&&(a=a.next((()=>((function(l){l.createObjectStore(up)})(e),this.wi(s))))),r<7&&i>=7&&(a=a.next((()=>this.Si(s)))),r<8&&i>=8&&(a=a.next((()=>this.bi(e,s)))),r<9&&i>=9&&(a=a.next((()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)}))),r<10&&i>=10&&(a=a.next((()=>this.Di(s)))),r<11&&i>=11&&(a=a.next((()=>{(function(l){l.createObjectStore(iw,{keyPath:uZ})})(e),(function(l){l.createObjectStore(sw,{keyPath:hZ})})(e)}))),r<12&&i>=12&&(a=a.next((()=>{(function(l){const u=l.createObjectStore(aw,{keyPath:_Z});u.createIndex(FT,xZ,{unique:!1}),u.createIndex(U6,vZ,{unique:!1})})(e)}))),r<13&&i>=13&&(a=a.next((()=>(function(l){const u=l.createObjectStore(Px,{keyPath:nZ});u.createIndex(L_,rZ),u.createIndex(j6,iZ)})(e))).next((()=>this.Ci(e,s))).next((()=>e.deleteObjectStore(ah)))),r<14&&i>=14&&(a=a.next((()=>this.Fi(e,s)))),r<15&&i>=15&&(a=a.next((()=>(function(l){l.createObjectStore(QI,{keyPath:dZ,autoIncrement:!0}).createIndex(DT,fZ,{unique:!1}),l.createObjectStore(_m,{keyPath:gZ}).createIndex(G6,mZ,{unique:!1}),l.createObjectStore(xm,{keyPath:pZ}).createIndex(B6,yZ,{unique:!1})})(e)))),r<16&&i>=16&&(a=a.next((()=>{t.objectStore(_m).clear()})).next((()=>{t.objectStore(xm).clear()}))),r<17&&i>=17&&(a=a.next((()=>{(function(l){l.createObjectStore(JI,{keyPath:wZ})})(e)}))),r<18&&i>=18&&DD()&&(a=a.next((()=>{t.objectStore(_m).clear()})).next((()=>{t.objectStore(xm).clear()}))),a}wi(e){let t=0;return e.store(ah).ee(((r,i)=>{t+=Gx(i)})).next((()=>{const r={byteSize:t};return e.store(up).put(OT,r)}))}yi(e){const t=e.store(cp),r=e.store(za);return t.J().next((i=>de.forEach(i,(s=>{const a=IDBKeyRange.bound([s.userId,Ah],[s.userId,s.lastAcknowledgedBatchId]);return r.J(wh,a).next((o=>de.forEach(o,(l=>{At(l.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:l.batchId});const u=dh(this.serializer,l);return WF(e,s.userId,u).next((()=>{}))}))))}))))}Si(e){const t=e.store(p0),r=e.store(ah);return e.store(Rh).get(kx).next((i=>{const s=[];return r.ee(((a,o)=>{const l=new Pn(a),u=(function(f){return[0,Ki(f)]})(l);s.push(t.get(u).next((h=>h?de.resolve():(f=>t.put({targetId:0,path:Ki(f),sequenceNumber:i.highestListenSequenceNumber}))(l))))})).next((()=>de.waitFor(s)))}))}bi(e,t){e.createObjectStore(hp,{keyPath:lZ});const r=t.store(hp),i=new dA,s=a=>{if(i.add(a)){const o=a.lastSegment(),l=a.popLast();return r.put({collectionId:o,parent:Ki(l)})}};return t.store(ah).ee({X:!0},((a,o)=>{const l=new Pn(a);return s(l.popLast())})).next((()=>t.store(g0).ee({X:!0},(([a,o,l],u)=>{const h=Oo(o);return s(h.popLast())}))))}Di(e){const t=e.store(m0);return t.ee(((r,i)=>{const s=rm(i),a=GF(this.serializer,s);return t.put(a)}))}Ci(e,t){const r=t.store(ah),i=[];return r.ee(((s,a)=>{const o=t.store(Px),l=(function(f){return f.document?new ct(Pn.fromString(f.document.name).popFirst(5)):f.noDocument?ct.fromSegments(f.noDocument.path):f.unknownDocument?ct.fromSegments(f.unknownDocument.path):Et(36783)})(a).path.toArray(),u={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:a.readTime||[0,0],unknownDocument:a.unknownDocument,noDocument:a.noDocument,document:a.document,hasCommittedMutations:!!a.hasCommittedMutations};i.push(o.put(u))})).next((()=>de.waitFor(i)))}Fi(e,t){const r=t.store(za),i=ZF(this.serializer),s=new gA(yw.mi,this.serializer.yt);return r.J().next((a=>{const o=new Map;return a.forEach((l=>{let u=o.get(l.userId)??an();dh(this.serializer,l).keys().forEach((h=>u=u.add(h))),o.set(l.userId,u)})),de.forEach(o,((l,u)=>{const h=new bi(u),f=mw.wt(this.serializer,h),g=s.getIndexManager(h),y=pw.wt(h,this.serializer,g,s.referenceDelegate);return new QF(i,y,f,g).recalculateAndSaveOverlaysForDocumentKeys(new jT(t,Ea.ce),l).next()}))}))}}function EN(n){n.createObjectStore(p0,{keyPath:aZ}).createIndex(ZI,oZ,{unique:!0}),n.createObjectStore(m0,{keyPath:"targetId"}).createIndex(V6,sZ,{unique:!0}),n.createObjectStore(Rh)}const kc="IndexedDbPersistence",uS=18e5,hS=5e3,dS="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",$Q="main";class mA{constructor(e,t,r,i,s,a,o,l,u,h,f=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Mi=s,this.window=a,this.document=o,this.xi=u,this.Oi=h,this.Ni=f,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=g=>Promise.resolve(),!mA.v())throw new at(Pe.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new kQ(this,i),this.$i=t+$Q,this.serializer=new VF(l),this.Ui=new su(this.$i,this.Ni,new zQ(this.serializer)),this.hi=new xQ,this.Pi=new AQ(this.referenceDelegate,this.serializer),this.remoteDocumentCache=ZF(this.serializer),this.Ii=new _Q,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,h===!1&&os(kc,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new at(Pe.FAILED_PRECONDITION,dS);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new Ea(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>n_(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(Tu(e))return Ze(kc,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Ze(kc,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return $g(e).get(lf).next((t=>de.resolve(this.es(t))))}ts(e){return n_(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,uS)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const r=ii(t,y0);return r.J().next((i=>{const s=this.ss(i,uS),a=i.filter((o=>s.indexOf(o)===-1));return de.forEach(a,(o=>r.delete(o.clientId))).next((()=>a))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?de.resolve(!0):$g(e).get(lf).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,hS)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new at(Pe.FAILED_PRECONDITION,dS);return!1}}return!(!this.networkEnabled||!this.inForeground)||n_(e).J().next((r=>this.ss(r,hS).find((i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,a=!this.inForeground&&i.inForeground,o=this.networkEnabled===i.networkEnabled;if(s||a&&o)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&Ze(kc,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[c1,y0],(e=>{const t=new jT(e,Ea.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((r=>this.rs(r.updateTimeMs,t)&&!this.us(r.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>n_(e).J().next((t=>this.ss(t,uS).map((r=>r.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return pw.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new IQ(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return mw.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,r){Ze(kc,"Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",s=(function(l){return l===18?TZ:l===17?H6:l===16?SZ:l===15?eA:l===14?W6:l===13?$6:l===12?EZ:l===11?z6:void Et(60245)})(this.Ni);let a;return this.Ui.runTransaction(e,i,s,(o=>(a=new jT(o,this.ci?this.ci.next():Ea.ce),t==="readwrite-primary"?this.Hi(a).next((l=>!!l||this.Yi(a))).next((l=>{if(!l)throw os(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new at(Pe.FAILED_PRECONDITION,L6);return r(a)})).next((l=>this.Xi(a).next((()=>l)))):this.Is(a).next((()=>r(a)))))).then((o=>(a.raiseOnCommittedEvent(),o)))}Is(e){return $g(e).get(lf).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,hS)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new at(Pe.FAILED_PRECONDITION,dS)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return $g(e).put(lf,t)}static v(){return su.v()}Zi(e){const t=$g(e);return t.get(lf).next((r=>this.es(r)?(Ze(kc,"Releasing primary lease."),t.delete(lf)):de.resolve()))}rs(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(os(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;OD()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const t=this.Ki?.getItem(this._s(e))!==null;return Ze(kc,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return os(kc,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){os("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function $g(n){return ii(n,c1)}function n_(n){return ii(n,y0)}function WQ(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class pA{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=i}static As(e,t){let r=an(),i=an();for(const s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new pA(e,t.fromCache,r,i)}}class HQ{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class JF{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return OD()?8:D6(ri())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,i){const s={result:null};return this.ys(e,t).next((a=>{s.result=a})).next((()=>{if(!s.result)return this.ws(e,t,i,r).next((a=>{s.result=a}))})).next((()=>{if(s.result)return;const a=new HQ;return this.Ss(e,t,a).next((o=>{if(s.result=o,this.Vs)return this.bs(e,t,a,o.size)}))})).next((()=>s.result))}bs(e,t,r,i){return r.documentReadCount<this.fs?(Sf()<=hn.DEBUG&&Ze("QueryEngine","SDK will not create cache indexes for query:",Tf(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),de.resolve()):(Sf()<=hn.DEBUG&&Ze("QueryEngine","Query:",Tf(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(Sf()<=hn.DEBUG&&Ze("QueryEngine","The SDK decides to create cache indexes for query:",Tf(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ta(t))):de.resolve())}ys(e,t){if(HM(t))return de.resolve(null);let r=Ta(t);return this.indexManager.getIndexType(e,r).next((i=>i===0?null:(t.limit!==null&&i===1&&(t=WT(t,null,"F"),r=Ta(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((s=>{const a=an(...s);return this.ps.getDocuments(e,a).next((o=>this.indexManager.getMinOffset(e,r).next((l=>{const u=this.Ds(t,o);return this.Cs(t,u,a,l.readTime)?this.ys(e,WT(t,null,"F")):this.vs(e,u,t,l)}))))})))))}ws(e,t,r,i){return HM(t)||i.isEqual(kt.min())?de.resolve(null):this.ps.getDocuments(e,r).next((s=>{const a=this.Ds(t,s);return this.Cs(t,a,r,i)?de.resolve(null):(Sf()<=hn.DEBUG&&Ze("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Tf(t)),this.vs(e,a,t,KX(i,ap)).next((o=>o)))}))}Ds(e,t){let r=new Hn(dF(e));return t.forEach(((i,s)=>{d1(e,s)&&(r=r.add(s))})),r}Cs(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,t,r){return Sf()<=hn.DEBUG&&Ze("QueryEngine","Using full collection scan to execute query:",Tf(t)),this.ps.getDocumentsMatchingQuery(e,t,ta.min(),r)}vs(e,t,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next((s=>(t.forEach((a=>{s=s.insert(a.key,a)})),s)))}}const yA="LocalStore",KQ=3e8;class YQ{constructor(e,t,r,i){this.persistence=e,this.Fs=t,this.serializer=i,this.Ms=new mr(qt),this.xs=new Xl((s=>Yh(s)),u1),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new QF(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function e8(n,e,t,r){return new YQ(n,e,t,r)}async function t8(n,e){const t=Xt(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next((s=>(i=s,t.Bs(e),t.mutationQueue.getAllMutationBatches(r)))).next((s=>{const a=[],o=[];let l=an();for(const u of i){a.push(u.batchId);for(const h of u.mutations)l=l.add(h.key)}for(const u of s){o.push(u.batchId);for(const h of u.mutations)l=l.add(h.key)}return t.localDocuments.getDocuments(r,l).next((u=>({Ls:u,removedBatchIds:a,addedBatchIds:o})))}))}))}function qQ(n,e){const t=Xt(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const i=e.batch.keys(),s=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(o,l,u,h){const f=u.batch,g=f.keys();let y=de.resolve();return g.forEach((v=>{y=y.next((()=>h.getEntry(l,v))).next((x=>{const E=u.docVersions.get(v);At(E!==null,48541),x.version.compareTo(E)<0&&(f.applyToRemoteDocument(x,u),x.isValidDocument()&&(x.setReadTime(u.commitVersion),h.addEntry(x)))}))})),y.next((()=>o.mutationQueue.removeMutationBatch(l,f)))})(t,r,e,s).next((()=>s.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(o){let l=an();for(let u=0;u<o.mutationResults.length;++u)o.mutationResults[u].transformResults.length>0&&(l=l.add(o.batch.mutations[u].key));return l})(e)))).next((()=>t.localDocuments.getDocuments(r,i)))}))}function n8(n){const e=Xt(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function XQ(n,e){const t=Xt(n),r=e.snapshotVersion;let i=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(s=>{const a=t.Ns.newChangeBuffer({trackRemovals:!0});i=t.Ms;const o=[];e.targetChanges.forEach(((h,f)=>{const g=i.get(f);if(!g)return;o.push(t.Pi.removeMatchingKeys(s,h.removedDocuments,f).next((()=>t.Pi.addMatchingKeys(s,h.addedDocuments,f))));let y=g.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(f)!==null?y=y.withResumeToken(Yr.EMPTY_BYTE_STRING,kt.min()).withLastLimboFreeSnapshotVersion(kt.min()):h.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(h.resumeToken,r)),i=i.insert(f,y),(function(x,E,T){return x.resumeToken.approximateByteSize()===0||E.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=KQ?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0})(g,y,h)&&o.push(t.Pi.updateTargetData(s,y))}));let l=Xs(),u=an();if(e.documentUpdates.forEach((h=>{e.resolvedLimboDocuments.has(h)&&o.push(t.persistence.referenceDelegate.updateLimboDocument(s,h))})),o.push(ZQ(s,a,e.documentUpdates).next((h=>{l=h.ks,u=h.qs}))),!r.isEqual(kt.min())){const h=t.Pi.getLastRemoteSnapshotVersion(s).next((f=>t.Pi.setTargetsMetadata(s,s.currentSequenceNumber,r)));o.push(h)}return de.waitFor(o).next((()=>a.apply(s))).next((()=>t.localDocuments.getLocalViewOfDocuments(s,l,u))).next((()=>l))})).then((s=>(t.Ms=i,s)))}function ZQ(n,e,t){let r=an(),i=an();return t.forEach((s=>r=r.add(s))),e.getEntries(n,r).next((s=>{let a=Xs();return t.forEach(((o,l)=>{const u=s.get(o);l.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(o)),l.isNoDocument()&&l.version.isEqual(kt.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):Ze(yA,"Ignoring outdated watch update for ",o,". Current version:",u.version," Watch version:",l.version)})),{ks:a,qs:i}}))}function QQ(n,e){const t=Xt(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=Ah),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function JQ(n,e){const t=Xt(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let i;return t.Pi.getTargetData(r,e).next((s=>s?(i=s,de.resolve(i)):t.Pi.allocateTargetId(r).next((a=>(i=new Il(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,i).next((()=>i)))))))})).then((r=>{const i=t.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r}))}async function JT(n,e,t){const r=Xt(n),i=r.Ms.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,(a=>r.persistence.referenceDelegate.removeTarget(a,i)))}catch(a){if(!Tu(a))throw a;Ze(yA,`Failed to update sequence numbers for target ${e}: ${a}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function SN(n,e,t){const r=Xt(n);let i=kt.min(),s=an();return r.persistence.runTransaction("Execute query","readwrite",(a=>(function(l,u,h){const f=Xt(l),g=f.xs.get(h);return g!==void 0?de.resolve(f.Ms.get(g)):f.Pi.getTargetData(u,h)})(r,a,Ta(e)).next((o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(a,o.targetId).next((l=>{s=l}))})).next((()=>r.Fs.getDocumentsMatchingQuery(a,e,t?i:kt.min(),t?s:an()))).next((o=>(eJ(r,VZ(e),o),{documents:o,Qs:s})))))}function eJ(n,e,t){let r=n.Os.get(e)||kt.min();t.forEach(((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)})),n.Os.set(e,r)}class TN{constructor(){this.activeTargetIds=WZ()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class r8{constructor(){this.Mo=new TN,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new TN,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class tJ{Oo(e){}shutdown(){}}const bN="ConnectivityMonitor";class IN{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Ze(bN,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Ze(bN,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let r_=null;function eb(){return r_===null?r_=(function(){return 268435456+Math.round(2147483648*Math.random())})():r_++,"0x"+r_.toString(16)}const fS="RestConnection",nJ={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class rJ{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===Mx?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,t,r,i,s){const a=eb(),o=this.zo(e,t.toUriEncodedString());Ze(fS,`Sending RPC '${e}' ${a}:`,o,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,i,s);const{host:u}=new URL(o),h=hd(u);return this.Jo(e,o,l,r,h).then((f=>(Ze(fS,`Received RPC '${e}' ${a}: `,f),f)),(f=>{throw Hh(fS,`RPC '${e}' ${a} failed with error: `,f,"url: ",o,"request:",r),f}))}Ho(e,t,r,i,s,a){return this.Go(e,t,r,i,s)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+F0})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((i,s)=>e[s]=i)),r&&r.headers.forEach(((i,s)=>e[s]=i))}zo(e,t){const r=nJ[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}class iJ{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const Vi="WebChannelConnection";class sJ extends rJ{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,i,s){const a=eb();return new Promise(((o,l)=>{const u=new S6;u.setWithCredentials(!0),u.listenOnce(T6.COMPLETE,(()=>{try{switch(u.getLastErrorCode()){case k_.NO_ERROR:const f=u.getResponseJson();Ze(Vi,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(f)),o(f);break;case k_.TIMEOUT:Ze(Vi,`RPC '${e}' ${a} timed out`),l(new at(Pe.DEADLINE_EXCEEDED,"Request time out"));break;case k_.HTTP_ERROR:const g=u.getStatus();if(Ze(Vi,`RPC '${e}' ${a} failed with status:`,g,"response text:",u.getResponseText()),g>0){let y=u.getResponseJson();Array.isArray(y)&&(y=y[0]);const v=y?.error;if(v&&v.status&&v.message){const x=(function(T){const b=T.toLowerCase().replace(/_/g,"-");return Object.values(Pe).indexOf(b)>=0?b:Pe.UNKNOWN})(v.status);l(new at(x,v.message))}else l(new at(Pe.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new at(Pe.UNAVAILABLE,"Connection failed."));break;default:Et(9055,{l_:e,streamId:a,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{Ze(Vi,`RPC '${e}' ${a} completed.`)}}));const h=JSON.stringify(i);Ze(Vi,`RPC '${e}' ${a} sending request:`,i),u.send(t,"POST",h,r,15)}))}T_(e,t,r){const i=eb(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=A6(),o=I6(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;const h=s.join("");Ze(Vi,`Creating RPC '${e}' stream ${i}: ${h}`,l);const f=a.createWebChannel(h,l);this.I_(f);let g=!1,y=!1;const v=new iJ({Yo:E=>{y?Ze(Vi,`Not sending because RPC '${e}' stream ${i} is closed:`,E):(g||(Ze(Vi,`Opening RPC '${e}' stream ${i} transport.`),f.open(),g=!0),Ze(Vi,`RPC '${e}' stream ${i} sending:`,E),f.send(E))},Zo:()=>f.close()}),x=(E,T,b)=>{E.listen(T,(I=>{try{b(I)}catch(M){setTimeout((()=>{throw M}),0)}}))};return x(f,em.EventType.OPEN,(()=>{y||(Ze(Vi,`RPC '${e}' stream ${i} transport opened.`),v.o_())})),x(f,em.EventType.CLOSE,(()=>{y||(y=!0,Ze(Vi,`RPC '${e}' stream ${i} transport closed`),v.a_(),this.E_(f))})),x(f,em.EventType.ERROR,(E=>{y||(y=!0,Hh(Vi,`RPC '${e}' stream ${i} transport errored. Name:`,E.name,"Message:",E.message),v.a_(new at(Pe.UNAVAILABLE,"The operation could not be completed")))})),x(f,em.EventType.MESSAGE,(E=>{if(!y){const T=E.data[0];At(!!T,16349);const b=T,I=b?.error||b[0]?.error;if(I){Ze(Vi,`RPC '${e}' stream ${i} received error:`,I);const M=I.status;let F=(function(C){const P=zr[C];if(P!==void 0)return bF(P)})(M),z=I.message;F===void 0&&(F=Pe.INTERNAL,z="Unknown error status: "+M+" with message "+I.message),y=!0,v.a_(new at(F,z)),f.close()}else Ze(Vi,`RPC '${e}' stream ${i} received:`,T),v.u_(T)}})),x(o,b6.STAT_EVENT,(E=>{E.stat===MT.PROXY?Ze(Vi,`RPC '${e}' stream ${i} detected buffering proxy`):E.stat===MT.NOPROXY&&Ze(Vi,`RPC '${e}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{v.__()}),0),v}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function aJ(){return typeof window<"u"?window:null}function B_(){return typeof document<"u"?document:null}function _w(n){return new oQ(n,!0)}class i8{constructor(e,t,r=1e3,i=1.5,s=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=i,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-r);i>0&&Ze("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const AN="PersistentStream";class s8{constructor(e,t,r,i,s,a,o,l){this.Mi=e,this.S_=r,this.b_=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new i8(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===Pe.RESOURCE_EXHAUSTED?(os(t.toString()),os("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===Pe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,i])=>{this.D_===t&&this.G_(r,i)}),(r=>{e((()=>{const i=new at(Pe.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)}))}))}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((i=>{r((()=>this.z_(i)))})),this.stream.onMessage((i=>{r((()=>++this.F_==1?this.J_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Ze(AN,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(Ze(AN,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class oJ extends s8{constructor(e,t,r,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=uQ(this.serializer,e),r=(function(s){if(!("targetChange"in s))return kt.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?kt.min():a.readTime?cs(a.readTime):kt.min()})(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=YT(this.serializer),t.addTarget=(function(s,a){let o;const l=a.target;if(o=Lx(l)?{documents:NF(s,l)}:{query:LF(s,l).ft},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=RF(s,a.resumeToken);const u=HT(s,a.expectedCount);u!==null&&(o.expectedCount=u)}else if(a.snapshotVersion.compareTo(kt.min())>0){o.readTime=b0(s,a.snapshotVersion.toTimestamp());const u=HT(s,a.expectedCount);u!==null&&(o.expectedCount=u)}return o})(this.serializer,e);const r=dQ(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=YT(this.serializer),t.removeTarget=e,this.q_(t)}}class lJ extends s8{constructor(e,t,r,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return At(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,At(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){At(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=hQ(e.writeResults,e.commitTime),r=cs(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=YT(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>Fx(this.serializer,r)))};this.q_(t)}}class cJ{}class uJ extends cJ{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new at(Pe.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,a])=>this.connection.Go(e,KT(t,r),i,s,a))).catch((s=>{throw s.name==="FirebaseError"?(s.code===Pe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new at(Pe.UNKNOWN,s.toString())}))}Ho(e,t,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,o])=>this.connection.Ho(e,KT(t,r),i,a,o,s))).catch((a=>{throw a.name==="FirebaseError"?(a.code===Pe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new at(Pe.UNKNOWN,a.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class hJ{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(os(t),this.aa=!1):Ze("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Qh="RemoteStore";class dJ{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo((a=>{r.enqueueAndForget((async()=>{gd(this)&&(Ze(Qh,"Restarting streams for network reachability change."),await(async function(l){const u=Xt(l);u.Ea.add(4),await g1(u),u.Ra.set("Unknown"),u.Ea.delete(4),await xw(u)})(this))}))})),this.Ra=new hJ(r,i)}}async function xw(n){if(gd(n))for(const e of n.da)await e(!0)}async function g1(n){for(const e of n.da)await e(!1)}function a8(n,e){const t=Xt(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),wA(t)?vA(t):V0(t).O_()&&xA(t,e))}function _A(n,e){const t=Xt(n),r=V0(t);t.Ia.delete(e),r.O_()&&o8(t,e),t.Ia.size===0&&(r.O_()?r.L_():gd(t)&&t.Ra.set("Unknown"))}function xA(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(kt.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}V0(n).Y_(e)}function o8(n,e){n.Va.Ue(e),V0(n).Z_(e)}function vA(n){n.Va=new rQ({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),V0(n).start(),n.Ra.ua()}function wA(n){return gd(n)&&!V0(n).x_()&&n.Ia.size>0}function gd(n){return Xt(n).Ea.size===0}function l8(n){n.Va=void 0}async function fJ(n){n.Ra.set("Online")}async function gJ(n){n.Ia.forEach(((e,t)=>{xA(n,e)}))}async function mJ(n,e){l8(n),wA(n)?(n.Ra.ha(e),vA(n)):n.Ra.set("Unknown")}async function pJ(n,e,t){if(n.Ra.set("Online"),e instanceof AF&&e.state===2&&e.cause)try{await(async function(i,s){const a=s.cause;for(const o of s.targetIds)i.Ia.has(o)&&(await i.remoteSyncer.rejectListen(o,a),i.Ia.delete(o),i.Va.removeTarget(o))})(n,e)}catch(r){Ze(Qh,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Ux(n,r)}else if(e instanceof V_?n.Va.Ze(e):e instanceof IF?n.Va.st(e):n.Va.tt(e),!t.isEqual(kt.min()))try{const r=await n8(n.localStore);t.compareTo(r)>=0&&await(function(s,a){const o=s.Va.Tt(a);return o.targetChanges.forEach(((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const h=s.Ia.get(u);h&&s.Ia.set(u,h.withResumeToken(l.resumeToken,a))}})),o.targetMismatches.forEach(((l,u)=>{const h=s.Ia.get(l);if(!h)return;s.Ia.set(l,h.withResumeToken(Yr.EMPTY_BYTE_STRING,h.snapshotVersion)),o8(s,l);const f=new Il(h.target,l,u,h.sequenceNumber);xA(s,f)})),s.remoteSyncer.applyRemoteEvent(o)})(n,t)}catch(r){Ze(Qh,"Failed to raise snapshot:",r),await Ux(n,r)}}async function Ux(n,e,t){if(!Tu(e))throw e;n.Ea.add(1),await g1(n),n.Ra.set("Offline"),t||(t=()=>n8(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{Ze(Qh,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await xw(n)}))}function c8(n,e){return e().catch((t=>Ux(n,t,e)))}async function m1(n){const e=Xt(n),t=fu(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Ah;for(;yJ(e);)try{const i=await QQ(e.localStore,r);if(i===null){e.Ta.length===0&&t.L_();break}r=i.batchId,_J(e,i)}catch(i){await Ux(e,i)}u8(e)&&h8(e)}function yJ(n){return gd(n)&&n.Ta.length<10}function _J(n,e){n.Ta.push(e);const t=fu(n);t.O_()&&t.X_&&t.ea(e.mutations)}function u8(n){return gd(n)&&!fu(n).x_()&&n.Ta.length>0}function h8(n){fu(n).start()}async function xJ(n){fu(n).ra()}async function vJ(n){const e=fu(n);for(const t of n.Ta)e.ea(t.mutations)}async function wJ(n,e,t){const r=n.Ta.shift(),i=oA.from(r,e,t);await c8(n,(()=>n.remoteSyncer.applySuccessfulWrite(i))),await m1(n)}async function EJ(n,e){e&&fu(n).X_&&await(async function(r,i){if((function(a){return eQ(a)&&a!==Pe.ABORTED})(i.code)){const s=r.Ta.shift();fu(r).B_(),await c8(r,(()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i))),await m1(r)}})(n,e),u8(n)&&h8(n)}async function RN(n,e){const t=Xt(n);t.asyncQueue.verifyOperationInProgress(),Ze(Qh,"RemoteStore received new credentials");const r=gd(t);t.Ea.add(3),await g1(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await xw(t)}async function SJ(n,e){const t=Xt(n);e?(t.Ea.delete(2),await xw(t)):e||(t.Ea.add(2),await g1(t),t.Ra.set("Unknown"))}function V0(n){return n.ma||(n.ma=(function(t,r,i){const s=Xt(t);return s.sa(),new oJ(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Xo:fJ.bind(null,n),t_:gJ.bind(null,n),r_:mJ.bind(null,n),H_:pJ.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),wA(n)?vA(n):n.Ra.set("Unknown")):(await n.ma.stop(),l8(n))}))),n.ma}function fu(n){return n.fa||(n.fa=(function(t,r,i){const s=Xt(t);return s.sa(),new lJ(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:xJ.bind(null,n),r_:EJ.bind(null,n),ta:vJ.bind(null,n),na:wJ.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await m1(n)):(await n.fa.stop(),n.Ta.length>0&&(Ze(Qh,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class EA{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Vo,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((a=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){const a=Date.now()+r,o=new EA(e,t,a,i,s);return o.start(r),o}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new at(Pe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function SA(n,e){if(os("AsyncQueue",`${e}: ${n}`),Tu(n))return new at(Pe.UNAVAILABLE,`${e}: ${n}`);throw n}class Yf{static emptySet(e){return new Yf(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||ct.comparator(t.key,r.key):(t,r)=>ct.comparator(t.key,r.key),this.keyedMap=tm(),this.sortedSet=new mr(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Yf)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Yf;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class CN{constructor(){this.ga=new mr(ct.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Et(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class I0{constructor(e,t,r,i,s,a,o,l,u){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,t,r,i,s){const a=[];return t.forEach((o=>{a.push({type:0,doc:o})})),new I0(e,t,Yf.emptySet(t),a,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&uw(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}class TJ{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class bJ{constructor(){this.queries=PN(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const i=Xt(t),s=i.queries;i.queries=PN(),s.forEach(((a,o)=>{for(const l of o.Sa)l.onError(r)}))})(this,new at(Pe.ABORTED,"Firestore shutting down"))}}function PN(){return new Xl((n=>hF(n)),uw)}async function d8(n,e){const t=Xt(n);let r=3;const i=e.query;let s=t.queries.get(i);s?!s.ba()&&e.Da()&&(r=2):(s=new TJ,r=e.Da()?0:1);try{switch(r){case 0:s.wa=await t.onListen(i,!0);break;case 1:s.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(a){const o=SA(a,`Initialization of query '${Tf(e.query)}' failed`);return void e.onError(o)}t.queries.set(i,s),s.Sa.push(e),e.va(t.onlineState),s.wa&&e.Fa(s.wa)&&TA(t)}async function f8(n,e){const t=Xt(n),r=e.query;let i=3;const s=t.queries.get(r);if(s){const a=s.Sa.indexOf(e);a>=0&&(s.Sa.splice(a,1),s.Sa.length===0?i=e.Da()?0:1:!s.ba()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function IJ(n,e){const t=Xt(n);let r=!1;for(const i of e){const s=i.query,a=t.queries.get(s);if(a){for(const o of a.Sa)o.Fa(i)&&(r=!0);a.wa=i}}r&&TA(t)}function AJ(n,e,t){const r=Xt(n),i=r.queries.get(e);if(i)for(const s of i.Sa)s.onError(t);r.queries.delete(e)}function TA(n){n.Ca.forEach((e=>{e.next()}))}var tb,kN;(kN=tb||(tb={})).Ma="default",kN.Cache="cache";class g8{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new I0(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=I0.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==tb.Cache}}class m8{constructor(e){this.key=e}}class p8{constructor(e){this.key=e}}class RJ{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=an(),this.mutatedKeys=an(),this.eu=dF(e),this.tu=new Yf(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new CN,i=t?t.tu:this.tu;let s=t?t.mutatedKeys:this.mutatedKeys,a=i,o=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((h,f)=>{const g=i.get(h),y=d1(this.query,f)?f:null,v=!!g&&this.mutatedKeys.has(g.key),x=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let E=!1;g&&y?g.data.isEqual(y.data)?v!==x&&(r.track({type:3,doc:y}),E=!0):this.su(g,y)||(r.track({type:2,doc:y}),E=!0,(l&&this.eu(y,l)>0||u&&this.eu(y,u)<0)&&(o=!0)):!g&&y?(r.track({type:0,doc:y}),E=!0):g&&!y&&(r.track({type:1,doc:g}),E=!0,(l||u)&&(o=!0)),E&&(y?(a=a.add(y),s=x?s.add(h):s.delete(h)):(a=a.delete(h),s=s.delete(h)))})),this.query.limit!==null)for(;a.size>this.query.limit;){const h=this.query.limitType==="F"?a.last():a.first();a=a.delete(h.key),s=s.delete(h.key),r.track({type:1,doc:h})}return{tu:a,iu:r,Cs:o,mutatedKeys:s}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort(((h,f)=>(function(y,v){const x=E=>{switch(E){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Et(20277,{Rt:E})}};return x(y)-x(v)})(h.type,f.type)||this.eu(h.doc,f.doc))),this.ou(r),i=i??!1;const o=t&&!i?this._u():[],l=this.Xa.size===0&&this.current&&!i?1:0,u=l!==this.Za;return this.Za=l,a.length!==0||u?{snapshot:new I0(this.query,e.tu,s,a,e.mutatedKeys,l===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:o}:{au:o}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new CN,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=an(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const t=[];return e.forEach((r=>{this.Xa.has(r)||t.push(new p8(r))})),this.Xa.forEach((r=>{e.has(r)||t.push(new m8(r))})),t}cu(e){this.Ya=e.Qs,this.Xa=an();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return I0.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const bA="SyncEngine";class CJ{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class PJ{constructor(e){this.key=e,this.hu=!1}}class kJ{constructor(e,t,r,i,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new Xl((o=>hF(o)),uw),this.Iu=new Map,this.Eu=new Set,this.du=new mr(ct.comparator),this.Au=new Map,this.Ru=new fA,this.Vu={},this.mu=new Map,this.fu=Zh.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function MJ(n,e,t=!0){const r=E8(n);let i;const s=r.Tu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await y8(r,e,t,!0),i}async function NJ(n,e){const t=E8(n);await y8(t,e,!0,!1)}async function y8(n,e,t,r){const i=await JQ(n.localStore,Ta(e)),s=i.targetId,a=n.sharedClientState.addLocalQueryTarget(s,t);let o;return r&&(o=await LJ(n,e,s,a==="current",i.resumeToken)),n.isPrimaryClient&&t&&a8(n.remoteStore,i),o}async function LJ(n,e,t,r,i){n.pu=(f,g,y)=>(async function(x,E,T,b){let I=E.view.ru(T);I.Cs&&(I=await SN(x.localStore,E.query,!1).then((({documents:k})=>E.view.ru(k,I))));const M=b&&b.targetChanges.get(E.targetId),F=b&&b.targetMismatches.get(E.targetId)!=null,z=E.view.applyChanges(I,x.isPrimaryClient,M,F);return NN(x,E.targetId,z.au),z.snapshot})(n,f,g,y);const s=await SN(n.localStore,e,!0),a=new RJ(e,s.Qs),o=a.ru(s.documents),l=f1.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),u=a.applyChanges(o,n.isPrimaryClient,l);NN(n,t,u.au);const h=new CJ(e,t,a);return n.Tu.set(e,h),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),u.snapshot}async function OJ(n,e,t){const r=Xt(n),i=r.Tu.get(e),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter((a=>!uw(a,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await JT(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),t&&_A(r.remoteStore,i.targetId),nb(r,i.targetId)})).catch(fd)):(nb(r,i.targetId),await JT(r.localStore,i.targetId,!0))}async function DJ(n,e){const t=Xt(n),r=t.Tu.get(e),i=t.Iu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),_A(t.remoteStore,r.targetId))}async function FJ(n,e,t){const r=S8(n);try{const i=await(function(a,o){const l=Xt(a),u=zn.now(),h=o.reduce(((y,v)=>y.add(v.key)),an());let f,g;return l.persistence.runTransaction("Locally write mutations","readwrite",(y=>{let v=Xs(),x=an();return l.Ns.getEntries(y,h).next((E=>{v=E,v.forEach(((T,b)=>{b.isValidDocument()||(x=x.add(T))}))})).next((()=>l.localDocuments.getOverlayedDocuments(y,v))).next((E=>{f=E;const T=[];for(const b of o){const I=QZ(b,f.get(b.key).overlayedDocument);I!=null&&T.push(new Zl(b.key,I,nF(I.value.mapValue),Wi.exists(!0)))}return l.mutationQueue.addMutationBatch(y,u,T,o)})).next((E=>{g=E;const T=E.applyToLocalDocumentSet(f,x);return l.documentOverlayCache.saveOverlays(y,E.batchId,T)}))})).then((()=>({batchId:g.batchId,changes:gF(f)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(a,o,l){let u=a.Vu[a.currentUser.toKey()];u||(u=new mr(qt)),u=u.insert(o,l),a.Vu[a.currentUser.toKey()]=u})(r,i.batchId,t),await p1(r,i.changes),await m1(r.remoteStore)}catch(i){const s=SA(i,"Failed to persist write");t.reject(s)}}async function _8(n,e){const t=Xt(n);try{const r=await XQ(t.localStore,e);e.targetChanges.forEach(((i,s)=>{const a=t.Au.get(s);a&&(At(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?a.hu=!0:i.modifiedDocuments.size>0?At(a.hu,14607):i.removedDocuments.size>0&&(At(a.hu,42227),a.hu=!1))})),await p1(t,r,e)}catch(r){await fd(r)}}function MN(n,e,t){const r=Xt(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.Tu.forEach(((s,a)=>{const o=a.view.va(e);o.snapshot&&i.push(o.snapshot)})),(function(a,o){const l=Xt(a);l.onlineState=o;let u=!1;l.queries.forEach(((h,f)=>{for(const g of f.Sa)g.va(o)&&(u=!0)})),u&&TA(l)})(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function jJ(n,e,t){const r=Xt(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Au.get(e),s=i&&i.key;if(s){let a=new mr(ct.comparator);a=a.insert(s,Rr.newNoDocument(s,kt.min()));const o=an().add(s),l=new gw(kt.min(),new Map,new mr(qt),a,o);await _8(r,l),r.du=r.du.remove(s),r.Au.delete(e),IA(r)}else await JT(r.localStore,e,!1).then((()=>nb(r,e,t))).catch(fd)}async function VJ(n,e){const t=Xt(n),r=e.batch.batchId;try{const i=await qQ(t.localStore,e);v8(t,r,null),x8(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await p1(t,i)}catch(i){await fd(i)}}async function GJ(n,e,t){const r=Xt(n);try{const i=await(function(a,o){const l=Xt(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",(u=>{let h;return l.mutationQueue.lookupMutationBatch(u,o).next((f=>(At(f!==null,37113),h=f.keys(),l.mutationQueue.removeMutationBatch(u,f)))).next((()=>l.mutationQueue.performConsistencyCheck(u))).next((()=>l.documentOverlayCache.removeOverlaysForBatchId(u,h,o))).next((()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,h))).next((()=>l.localDocuments.getDocuments(u,h)))}))})(r.localStore,e);v8(r,e,t),x8(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await p1(r,i)}catch(i){await fd(i)}}function x8(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function v8(n,e,t){const r=Xt(n);let i=r.Vu[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function nb(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((r=>{n.Ru.containsKey(r)||w8(n,r)}))}function w8(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(_A(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),IA(n))}function NN(n,e,t){for(const r of t)r instanceof m8?(n.Ru.addReference(r.key,e),BJ(n,r)):r instanceof p8?(Ze(bA,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||w8(n,r.key)):Et(19791,{wu:r})}function BJ(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(Ze(bA,"New document in limbo: "+t),n.Eu.add(r),IA(n))}function IA(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new ct(Pn.fromString(e)),r=n.fu.next();n.Au.set(r,new PJ(t)),n.du=n.du.insert(t,r),a8(n.remoteStore,new Il(Ta(cw(t.path)),r,"TargetPurposeLimboResolution",Ea.ce))}}async function p1(n,e,t){const r=Xt(n),i=[],s=[],a=[];r.Tu.isEmpty()||(r.Tu.forEach(((o,l)=>{a.push(r.pu(l,e,t).then((u=>{if((u||t)&&r.isPrimaryClient){const h=u?!u.fromCache:t?.targetChanges.get(l.targetId)?.current;r.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(u){i.push(u);const h=pA.As(l.targetId,u);s.push(h)}})))})),await Promise.all(a),r.Pu.H_(i),await(async function(l,u){const h=Xt(l);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",(f=>de.forEach(u,(g=>de.forEach(g.Es,(y=>h.persistence.referenceDelegate.addReference(f,g.targetId,y))).next((()=>de.forEach(g.ds,(y=>h.persistence.referenceDelegate.removeReference(f,g.targetId,y)))))))))}catch(f){if(!Tu(f))throw f;Ze(yA,"Failed to update sequence numbers: "+f)}for(const f of u){const g=f.targetId;if(!f.fromCache){const y=h.Ms.get(g),v=y.snapshotVersion,x=y.withLastLimboFreeSnapshotVersion(v);h.Ms=h.Ms.insert(g,x)}}})(r.localStore,s))}async function UJ(n,e){const t=Xt(n);if(!t.currentUser.isEqual(e)){Ze(bA,"User change. New user:",e.toKey());const r=await t8(t.localStore,e);t.currentUser=e,(function(s,a){s.mu.forEach((o=>{o.forEach((l=>{l.reject(new at(Pe.CANCELLED,a))}))})),s.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await p1(t,r.Ls)}}function zJ(n,e){const t=Xt(n),r=t.Au.get(e);if(r&&r.hu)return an().add(r.key);{let i=an();const s=t.Iu.get(e);if(!s)return i;for(const a of s){const o=t.Tu.get(a);i=i.unionWith(o.view.nu)}return i}}function E8(n){const e=Xt(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=_8.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=zJ.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=jJ.bind(null,e),e.Pu.H_=IJ.bind(null,e.eventManager),e.Pu.yu=AJ.bind(null,e.eventManager),e}function S8(n){const e=Xt(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=VJ.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=GJ.bind(null,e),e}class yp{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=_w(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return e8(this.persistence,new JF,e.initialUser,this.serializer)}Cu(e){return new gA(yw.mi,this.serializer)}Du(e){return new r8}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}yp.provider={build:()=>new yp};class $J extends yp{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){At(this.persistence.referenceDelegate instanceof Bx,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new YF(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Ui.withCacheSize(this.cacheSizeBytes):Ui.DEFAULT;return new gA((r=>Bx.mi(r,t)),this.serializer)}}class WJ extends yp{constructor(e,t,r){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await S8(this.xu.syncEngine),await m1(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return e8(this.persistence,new JF,e.initialUser,this.serializer)}Fu(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new YF(r,e.asyncQueue,t)}Mu(e,t){const r=new ZX(t,this.persistence);return new XX(e.asyncQueue,r)}Cu(e){const t=WQ(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Ui.withCacheSize(this.cacheSizeBytes):Ui.DEFAULT;return new mA(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,aJ(),B_(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new r8}}class zx{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>MN(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=UJ.bind(null,this.syncEngine),await SJ(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new bJ})()}createDatastore(e){const t=_w(e.databaseInfo.databaseId),r=(function(s){return new sJ(s)})(e.databaseInfo);return(function(s,a,o,l){return new uJ(s,a,o,l)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,i,s,a,o){return new dJ(r,i,s,a,o)})(this.localStore,this.datastore,e.asyncQueue,(t=>MN(this.syncEngine,t,0)),(function(){return IN.v()?new IN:new tJ})())}createSyncEngine(e,t){return(function(i,s,a,o,l,u,h){const f=new kJ(i,s,a,o,l,u);return h&&(f.gu=!0),f})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const r=Xt(t);Ze(Qh,"RemoteStore shutting down."),r.Ea.add(5),await g1(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}zx.provider={build:()=>new zx};class T8{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):os("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const gu="FirestoreClient";class HJ{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=bi.UNAUTHENTICATED,this.clientId=YI.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,(async a=>{Ze(gu,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(r,(a=>(Ze(gu,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Vo;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=SA(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function gS(n,e){n.asyncQueue.verifyOperationInProgress(),Ze(gu,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async i=>{r.isEqual(i)||(await t8(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function LN(n,e){n.asyncQueue.verifyOperationInProgress();const t=await KJ(n);Ze(gu,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>RN(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,i)=>RN(e.remoteStore,i))),n._onlineComponents=e}async function KJ(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Ze(gu,"Using user provided OfflineComponentProvider");try{await gS(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===Pe.FAILED_PRECONDITION||i.code===Pe.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;Hh("Error using user provided cache. Falling back to memory cache: "+t),await gS(n,new yp)}}else Ze(gu,"Using default OfflineComponentProvider"),await gS(n,new $J(void 0));return n._offlineComponents}async function b8(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Ze(gu,"Using user provided OnlineComponentProvider"),await LN(n,n._uninitializedComponentsProvider._online)):(Ze(gu,"Using default OnlineComponentProvider"),await LN(n,new zx))),n._onlineComponents}function YJ(n){return b8(n).then((e=>e.syncEngine))}async function I8(n){const e=await b8(n),t=e.eventManager;return t.onListen=MJ.bind(null,e.syncEngine),t.onUnlisten=OJ.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=NJ.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=DJ.bind(null,e.syncEngine),t}function qJ(n,e,t={}){const r=new Vo;return n.asyncQueue.enqueueAndForget((async()=>(function(s,a,o,l,u){const h=new T8({next:g=>{h.Nu(),a.enqueueAndForget((()=>f8(s,f)));const y=g.docs.has(o);!y&&g.fromCache?u.reject(new at(Pe.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&g.fromCache&&l&&l.source==="server"?u.reject(new at(Pe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(g)},error:g=>u.reject(g)}),f=new g8(cw(o.path),h,{includeMetadataChanges:!0,qa:!0});return d8(s,f)})(await I8(n),n.asyncQueue,e,t,r))),r.promise}function XJ(n,e,t={}){const r=new Vo;return n.asyncQueue.enqueueAndForget((async()=>(function(s,a,o,l,u){const h=new T8({next:g=>{h.Nu(),a.enqueueAndForget((()=>f8(s,f))),g.fromCache&&l.source==="server"?u.reject(new at(Pe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(g)},error:g=>u.reject(g)}),f=new g8(o,h,{includeMetadataChanges:!0,qa:!0});return d8(s,f)})(await I8(n),n.asyncQueue,e,t,r))),r.promise}function A8(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const ON=new Map;const R8="firestore.googleapis.com",DN=!0;class FN{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new at(Pe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=R8,this.ssl=DN}else this.host=e.host,this.ssl=e.ssl??DN;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=$F;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<RQ)throw new at(Pe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}HX("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=A8(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new at(Pe.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new at(Pe.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new at(Pe.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class vw{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new FN({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new at(Pe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new at(Pe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new FN(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new DX;switch(r.type){case"firstParty":return new GX(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new at(Pe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=ON.get(t);r&&(Ze("ComponentProvider","Removing Datastore"),ON.delete(t),r.terminate())})(this),Promise.resolve()}}function ZJ(n,e,t,r={}){n=Aa(n,vw);const i=hd(e),s=n._getSettings(),a={...s,emulatorOptions:n._getEmulatorOptions()},o=`${e}:${t}`;i&&(NI(`https://${o}`),LI("Firestore",!0)),s.host!==R8&&s.host!==o&&Hh("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...s,host:o,ssl:i,emulatorOptions:r};if(!Uh(l,a)&&(n._setSettings(l),r.mockUserToken)){let u,h;if(typeof r.mockUserToken=="string")u=r.mockUserToken,h=bi.MOCK_USER;else{u=ND(r.mockUserToken,n._app?.options.projectId);const f=r.mockUserToken.sub||r.mockUserToken.user_id;if(!f)throw new at(Pe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new bi(f)}n._authCredentials=new FX(new C6(u,h))}}class G0{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new G0(this.firestore,e,this._query)}}class Dr{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new au(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Dr(this.firestore,e,this._key)}toJSON(){return{type:Dr._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(l1(t,Dr._jsonSchema))return new Dr(e,r||null,new ct(Pn.fromString(t.referencePath)))}}Dr._jsonSchemaVersion="firestore/documentReference/1.0",Dr._jsonSchema={type:Hr("string",Dr._jsonSchemaVersion),referencePath:Hr("string")};class au extends G0{constructor(e,t,r){super(e,t,cw(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Dr(this.firestore,null,new ct(e))}withConverter(e){return new au(this.firestore,e,this._path)}}function jN(n,e,...t){if(n=pi(n),k6("collection","path",e),n instanceof vw){const r=Pn.fromString(e,...t);return AM(r),new au(n,null,r)}{if(!(n instanceof Dr||n instanceof au))throw new at(Pe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Pn.fromString(e,...t));return AM(r),new au(n.firestore,null,r)}}function qf(n,e,...t){if(n=pi(n),arguments.length===1&&(e=YI.newId()),k6("doc","path",e),n instanceof vw){const r=Pn.fromString(e,...t);return IM(r),new Dr(n,null,new ct(r))}{if(!(n instanceof Dr||n instanceof au))throw new at(Pe.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Pn.fromString(e,...t));return IM(r),new Dr(n.firestore,n instanceof au?n.converter:null,new ct(r))}}const VN="AsyncQueue";class GN{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new i8(this,"async_queue_retry"),this._c=()=>{const r=B_();r&&Ze(VN,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=B_();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=B_();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Vo;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Tu(e))throw e;Ze(VN,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,os("INTERNAL UNHANDLED ERROR: ",BN(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const i=EA.createAndSchedule(this,e,t,r,(s=>this.hc(s)));return this.tc.push(i),i}uc(){this.nc&&Et(47125,{Pc:BN(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function BN(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class Iu extends vw{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new GN,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new GN(e),this._firestoreClient=void 0,await e}}}function QJ(n,e){const t=typeof n=="object"?n:FI(),r=typeof n=="string"?n:Mx,i=Zv(t,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=PD("firestore");s&&ZJ(i,...s)}return i}function AA(n){if(n._terminated)throw new at(Pe.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||C8(n),n._firestoreClient}function C8(n){const e=n._freezeSettings(),t=(function(i,s,a,o){return new IZ(i,s,a,o.host,o.ssl,o.experimentalForceLongPolling,o.experimentalAutoDetectLongPolling,A8(o.experimentalLongPollingOptions),o.useFetchStreams,o.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new HJ(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(i){const s=i?._online.build();return{_offline:i?._offline.build(s),_online:s}})(n._componentsProvider))}function JJ(n,e){Hh("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return eee(n,zx.provider,{build:r=>new WJ(r,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function eee(n,e,t){if((n=Aa(n,Iu))._firestoreClient||n._terminated)throw new at(Pe.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new at(Pe.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},C8(n)}class _a{constructor(e){this._byteString=e}static fromBase64String(e){try{return new _a(Yr.fromBase64String(e))}catch(t){throw new at(Pe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new _a(Yr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:_a._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(l1(e,_a._jsonSchema))return _a.fromBase64String(e.bytes)}}_a._jsonSchemaVersion="firestore/bytes/1.0",_a._jsonSchema={type:Hr("string",_a._jsonSchemaVersion),bytes:Hr("string")};class ww{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new at(Pe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new wr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Ew{constructor(e){this._methodName=e}}class Go{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new at(Pe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new at(Pe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return qt(this._lat,e._lat)||qt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Go._jsonSchemaVersion}}static fromJSON(e){if(l1(e,Go._jsonSchema))return new Go(e.latitude,e.longitude)}}Go._jsonSchemaVersion="firestore/geoPoint/1.0",Go._jsonSchema={type:Hr("string",Go._jsonSchemaVersion),latitude:Hr("number"),longitude:Hr("number")};class Bo{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Bo._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(l1(e,Bo._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Bo(e.vectorValues);throw new at(Pe.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Bo._jsonSchemaVersion="firestore/vectorValue/1.0",Bo._jsonSchema={type:Hr("string",Bo._jsonSchemaVersion),vectorValues:Hr("object")};const tee=/^__.*__$/;class nee{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Zl(e,this.data,this.fieldMask,t,this.fieldTransforms):new j0(e,this.data,t,this.fieldTransforms)}}class P8{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Zl(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function k8(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Et(40011,{Ac:n})}}class RA{constructor(e,t,r,i,s,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new RA({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return $x(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(k8(this.Ac)&&tee.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class ree{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||_w(e)}Cc(e,t,r,i=!1){return new RA({Ac:e,methodName:t,Dc:r,path:wr.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Sw(n){const e=n._freezeSettings(),t=_w(n._databaseId);return new ree(n._databaseId,!!e.ignoreUndefinedProperties,t)}function M8(n,e,t,r,i,s={}){const a=n.Cc(s.merge||s.mergeFields?2:0,e,t,i);PA("Data must be an object, but it was:",a,r);const o=N8(r,a);let l,u;if(s.merge)l=new Is(a.fieldMask),u=a.fieldTransforms;else if(s.mergeFields){const h=[];for(const f of s.mergeFields){const g=rb(e,f,t);if(!a.contains(g))throw new at(Pe.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);O8(h,g)||h.push(g)}l=new Is(h),u=a.fieldTransforms.filter((f=>l.covers(f.field)))}else l=null,u=a.fieldTransforms;return new nee(new $i(o),l,u)}class Tw extends Ew{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Tw}}class CA extends Ew{_toFieldTransform(e){return new wF(e.path,new E0)}isEqual(e){return e instanceof CA}}function iee(n,e,t,r){const i=n.Cc(1,e,t);PA("Data must be an object, but it was:",i,r);const s=[],a=$i.empty();bu(r,((l,u)=>{const h=kA(e,l,t);u=pi(u);const f=i.yc(h);if(u instanceof Tw)s.push(h);else{const g=y1(u,f);g!=null&&(s.push(h),a.set(h,g))}}));const o=new Is(s);return new P8(a,o,i.fieldTransforms)}function see(n,e,t,r,i,s){const a=n.Cc(1,e,t),o=[rb(e,r,t)],l=[i];if(s.length%2!=0)throw new at(Pe.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<s.length;g+=2)o.push(rb(e,s[g])),l.push(s[g+1]);const u=[],h=$i.empty();for(let g=o.length-1;g>=0;--g)if(!O8(u,o[g])){const y=o[g];let v=l[g];v=pi(v);const x=a.yc(y);if(v instanceof Tw)u.push(y);else{const E=y1(v,x);E!=null&&(u.push(y),h.set(y,E))}}const f=new Is(u);return new P8(h,f,a.fieldTransforms)}function aee(n,e,t,r=!1){return y1(t,n.Cc(r?4:3,e))}function y1(n,e){if(L8(n=pi(n)))return PA("Unsupported field value:",e,n),N8(n,e);if(n instanceof Ew)return(function(r,i){if(!k8(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,i){const s=[];let a=0;for(const o of r){let l=y1(o,i.wc(a));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),a++}return{arrayValue:{values:s}}})(n,e)}return(function(r,i){if((r=pi(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return HZ(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=zn.fromDate(r);return{timestampValue:b0(i.serializer,s)}}if(r instanceof zn){const s=new zn(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:b0(i.serializer,s)}}if(r instanceof Go)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof _a)return{bytesValue:RF(i.serializer,r._byteString)};if(r instanceof Dr){const s=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(s))throw i.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:uA(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Bo)return(function(a,o){return{mapValue:{fields:{[nA]:{stringValue:rA},[_0]:{arrayValue:{values:a.toArray().map((u=>{if(typeof u!="number")throw o.Sc("VectorValues must only contain numeric values.");return sA(o.serializer,u)}))}}}}}})(r,i);throw i.Sc(`Unsupported field value: ${tw(r)}`)})(n,e)}function N8(n,e){const t={};return K6(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):bu(n,((r,i)=>{const s=y1(i,e.mc(r));s!=null&&(t[r]=s)})),{mapValue:{fields:t}}}function L8(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof zn||n instanceof Go||n instanceof _a||n instanceof Dr||n instanceof Ew||n instanceof Bo)}function PA(n,e,t){if(!L8(t)||!M6(t)){const r=tw(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function rb(n,e,t){if((e=pi(e))instanceof ww)return e._internalPath;if(typeof e=="string")return kA(n,e);throw $x("Field path arguments must be of type string or ",n,!1,void 0,t)}const oee=new RegExp("[~\\*/\\[\\]]");function kA(n,e,t){if(e.search(oee)>=0)throw $x(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new ww(...e.split("."))._internalPath}catch{throw $x(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function $x(n,e,t,r,i){const s=r&&!r.isEmpty(),a=i!==void 0;let o=`Function ${e}() called with invalid data`;t&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${r}`),a&&(l+=` in document ${i}`),l+=")"),new at(Pe.INVALID_ARGUMENT,o+n+l)}function O8(n,e){return n.some((t=>t.isEqual(e)))}class D8{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Dr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new lee(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(MA("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class lee extends D8{data(){return super.data()}}function MA(n,e){return typeof e=="string"?kA(n,e):e instanceof ww?e._internalPath:e._delegate._internalPath}function cee(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new at(Pe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class NA{}class uee extends NA{}function hee(n,e,...t){let r=[];e instanceof NA&&r.push(e),r=r.concat(t),(function(s){const a=s.filter((l=>l instanceof LA)).length,o=s.filter((l=>l instanceof bw)).length;if(a>1||a>0&&o>0)throw new at(Pe.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const i of r)n=i._apply(n);return n}class bw extends uee{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new bw(e,t,r)}_apply(e){const t=this._parse(e);return F8(e._query,t),new G0(e.firestore,e.converter,$T(e._query,t))}_parse(e){const t=Sw(e.firestore);return(function(s,a,o,l,u,h,f){let g;if(u.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new at(Pe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){zN(f,h);const v=[];for(const x of f)v.push(UN(l,s,x));g={arrayValue:{values:v}}}else g=UN(l,s,f)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||zN(f,h),g=aee(o,a,f,h==="in"||h==="not-in");return dn.create(u,h,g)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function dee(n,e,t){const r=e,i=MA("where",n);return bw._create(i,r,t)}class LA extends NA{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new LA(e,t)}_parse(e){const t=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return t.length===1?t[0]:$n.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(i,s){let a=i;const o=s.getFlattenedFilters();for(const l of o)F8(a,l),a=$T(a,l)})(e._query,t),new G0(e.firestore,e.converter,$T(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function UN(n,e,t){if(typeof(t=pi(t))=="string"){if(t==="")throw new at(Pe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!uF(e)&&t.indexOf("/")!==-1)throw new at(Pe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(Pn.fromString(t));if(!ct.isDocumentKey(r))throw new at(Pe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return gp(n,new ct(r))}if(t instanceof Dr)return gp(n,t._key);throw new at(Pe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${tw(t)}.`)}function zN(n,e){if(!Array.isArray(n)||n.length===0)throw new at(Pe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function F8(n,e){const t=(function(i,s){for(const a of i)for(const o of a.getFlattenedFilters())if(s.indexOf(o.op)>=0)return o.op;return null})(n.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new at(Pe.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new at(Pe.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class fee{convertValue(e,t="none"){switch(hu(e)){case 0:return null;case 1:return e.booleanValue;case 2:return gr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(zl(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Et(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return bu(e,((i,s)=>{r[i]=this.convertValue(s,t)})),r}convertVectorValue(e){const t=e.fields?.[_0].arrayValue?.values?.map((r=>gr(r.doubleValue)));return new Bo(t)}convertGeoPoint(e){return new Go(gr(e.latitude),gr(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=ow(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(dp(e));default:return null}}convertTimestamp(e){const t=Ul(e);return new zn(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Pn.fromString(e);At(jF(r),9688,{name:e});const i=new Kh(r.get(1),r.get(3)),s=new ct(r.popFirst(5));return i.isEqual(t)||os(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function j8(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class im{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ph extends D8{constructor(e,t,r,i,s,a){super(e,t,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new U_(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(MA("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new at(Pe.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Ph._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Ph._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ph._jsonSchema={type:Hr("string",Ph._jsonSchemaVersion),bundleSource:Hr("string","DocumentSnapshot"),bundleName:Hr("string"),bundle:Hr("string")};class U_ extends Ph{data(e={}){return super.data(e)}}class Xf{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new im(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new U_(this._firestore,this._userDataWriter,r.key,r,new im(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new at(Pe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map((o=>{const l=new U_(i._firestore,i._userDataWriter,o.doc.key,o.doc,new im(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}}))}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((o=>s||o.type!==3)).map((o=>{const l=new U_(i._firestore,i._userDataWriter,o.doc.key,o.doc,new im(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,h=-1;return o.type!==0&&(u=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),h=a.indexOf(o.doc.key)),{type:gee(o.type),doc:l,oldIndex:u,newIndex:h}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new at(Pe.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Xf._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=YI.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],i=[];return this.docs.forEach((s=>{s._document!==null&&(t.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function gee(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Et(61501,{type:n})}}function mee(n){n=Aa(n,Dr);const e=Aa(n.firestore,Iu);return qJ(AA(e),n._key).then((t=>vee(e,n,t)))}Xf._jsonSchemaVersion="firestore/querySnapshot/1.0",Xf._jsonSchema={type:Hr("string",Xf._jsonSchemaVersion),bundleSource:Hr("string","QuerySnapshot"),bundleName:Hr("string"),bundle:Hr("string")};class V8 extends fee{constructor(e){super(),this.firestore=e}convertBytes(e){return new _a(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Dr(this.firestore,null,t)}}function pee(n){n=Aa(n,G0);const e=Aa(n.firestore,Iu),t=AA(e),r=new V8(e);return cee(n._query),XJ(t,n._query).then((i=>new Xf(e,r,n,i)))}function $N(n,e,t){n=Aa(n,Dr);const r=Aa(n.firestore,Iu),i=j8(n.converter,e,t);return Iw(r,[M8(Sw(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,Wi.none())])}function yee(n,e,t,...r){n=Aa(n,Dr);const i=Aa(n.firestore,Iu),s=Sw(i);let a;return a=typeof(e=pi(e))=="string"||e instanceof ww?see(s,"updateDoc",n._key,e,t,r):iee(s,"updateDoc",n._key,e),Iw(i,[a.toMutation(n._key,Wi.exists(!0))])}function _ee(n){return Iw(Aa(n.firestore,Iu),[new fw(n._key,Wi.none())])}function xee(n,e){const t=Aa(n.firestore,Iu),r=qf(n),i=j8(n.converter,e);return Iw(t,[M8(Sw(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,Wi.exists(!1))]).then((()=>r))}function Iw(n,e){return(function(r,i){const s=new Vo;return r.asyncQueue.enqueueAndForget((async()=>FJ(await YJ(r),i,s))),s.promise})(AA(n),e)}function vee(n,e,t){const r=t.docs.get(e._key),i=new V8(n);return new Ph(n,i,e._key,r,new im(t.hasPendingWrites,t.fromCache),e.converter)}function WN(){return new CA("serverTimestamp")}(function(e,t=!0){(function(i){F0=i})(dd),zh(new cu("firestore",((r,{instanceIdentifier:i,options:s})=>{const a=r.getProvider("app").getImmediate(),o=new Iu(new jX(r.getProvider("auth-internal")),new BX(a,r.getProvider("app-check-internal")),(function(u,h){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new at(Pe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Kh(u.options.projectId,h)})(a,i),a);return s={useFetchStreams:t,...s},o._setSettings(s),o}),"PUBLIC").setMultipleInstances(!0)),Fo(EM,SM,e),Fo(EM,SM,"esm2020")})();const G8="firebasestorage.googleapis.com",wee="storageBucket",Eee=120*1e3,See=600*1e3;class rl extends nl{constructor(e,t,r=0){super(mS(e),`Firebase Storage: ${t} (${mS(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,rl.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return mS(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Zo;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Zo||(Zo={}));function mS(n){return"storage/"+n}function Tee(){const n="An unknown error occurred, please check the error payload for server response.";return new rl(Zo.UNKNOWN,n)}function bee(){return new rl(Zo.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Iee(){return new rl(Zo.CANCELED,"User canceled the upload/download.")}function Aee(n){return new rl(Zo.INVALID_URL,"Invalid URL '"+n+"'.")}function Ree(n){return new rl(Zo.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function HN(n){return new rl(Zo.INVALID_ARGUMENT,n)}function B8(){return new rl(Zo.APP_DELETED,"The Firebase app was deleted.")}function Cee(n){return new rl(Zo.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}class Xa{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=Xa.makeFromUrl(e,t)}catch{return new Xa(e,"")}if(r.path==="")return r;throw Ree(e)}static makeFromUrl(e,t){let r=null;const i="([A-Za-z0-9.\\-_]+)";function s(M){M.path.charAt(M.path.length-1)==="/"&&(M.path_=M.path_.slice(0,-1))}const a="(/(.*))?$",o=new RegExp("^gs://"+i+a,"i"),l={bucket:1,path:3};function u(M){M.path_=decodeURIComponent(M.path)}const h="v[A-Za-z0-9_]+",f=t.replace(/[.]/g,"\\."),g="(/([^?#]*).*)?$",y=new RegExp(`^https?://${f}/${h}/b/${i}/o${g}`,"i"),v={bucket:1,path:3},x=t===G8?"(?:storage.googleapis.com|storage.cloud.google.com)":t,E="([^?#]*)",T=new RegExp(`^https?://${x}/${i}/${E}`,"i"),I=[{regex:o,indices:l,postModify:s},{regex:y,indices:v,postModify:u},{regex:T,indices:{bucket:1,path:2},postModify:u}];for(let M=0;M<I.length;M++){const F=I[M],z=F.regex.exec(e);if(z){const k=z[F.indices.bucket];let C=z[F.indices.path];C||(C=""),r=new Xa(k,C),F.postModify(r);break}}if(r==null)throw Aee(e);return r}}class Pee{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function kee(n,e,t){let r=1,i=null,s=null,a=!1,o=0;function l(){return o===2}let u=!1;function h(...E){u||(u=!0,e.apply(null,E))}function f(E){i=setTimeout(()=>{i=null,n(y,l())},E)}function g(){s&&clearTimeout(s)}function y(E,...T){if(u){g();return}if(E){g(),h.call(null,E,...T);return}if(l()||a){g(),h.call(null,E,...T);return}r<64&&(r*=2);let I;o===1?(o=2,I=0):I=(r+Math.random())*1e3,f(I)}let v=!1;function x(E){v||(v=!0,g(),!u&&(i!==null?(E||(o=2),clearTimeout(i),f(0)):E||(o=1)))}return f(0),s=setTimeout(()=>{a=!0,x(!0)},t),x}function Mee(n){n(!1)}function Nee(n){return n!==void 0}function KN(n,e,t,r){if(r<e)throw HN(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw HN(`Invalid value for '${n}'. Expected ${t} or less.`)}function Lee(n){const e=encodeURIComponent;let t="?";for(const r in n)if(n.hasOwnProperty(r)){const i=e(r)+"="+e(n[r]);t=t+i+"&"}return t=t.slice(0,-1),t}var Wx;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(Wx||(Wx={}));function Oee(n,e){const t=n>=500&&n<600,i=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||i||s}class Dee{constructor(e,t,r,i,s,a,o,l,u,h,f,g=!0,y=!1){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=a,this.callback_=o,this.errorCallback_=l,this.timeout_=u,this.progressCallback_=h,this.connectionFactory_=f,this.retry=g,this.isUsingEmulator=y,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((v,x)=>{this.resolve_=v,this.reject_=x,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new i_(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const a=o=>{const l=o.loaded,u=o.lengthComputable?o.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,u)};this.progressCallback_!==null&&s.addUploadProgressListener(a),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(a),this.pendingConnection_=null;const o=s.getErrorCode()===Wx.NO_ERROR,l=s.getStatus();if(!o||Oee(l,this.additionalRetryCodes_)&&this.retry){const h=s.getErrorCode()===Wx.ABORT;r(!1,new i_(!1,null,h));return}const u=this.successCodes_.indexOf(l)!==-1;r(!0,new i_(u,s))})},t=(r,i)=>{const s=this.resolve_,a=this.reject_,o=i.connection;if(i.wasSuccessCode)try{const l=this.callback_(o,o.getResponse());Nee(l)?s(l):s()}catch(l){a(l)}else if(o!==null){const l=Tee();l.serverResponse=o.getErrorText(),this.errorCallback_?a(this.errorCallback_(o,l)):a(l)}else if(i.canceled){const l=this.appDelete_?B8():Iee();a(l)}else{const l=bee();a(l)}};this.canceled_?t(!1,new i_(!1,null,!0)):this.backoffId_=kee(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&Mee(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class i_{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}function Fee(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function jee(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function Vee(n,e){e&&(n["X-Firebase-GMPID"]=e)}function Gee(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function Bee(n,e,t,r,i,s,a=!0,o=!1){const l=Lee(n.urlParams),u=n.url+l,h=Object.assign({},n.headers);return Vee(h,e),Fee(h,t),jee(h,s),Gee(h,r),new Dee(u,n.method,h,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,a,o)}function Uee(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function zee(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}class Hx{constructor(e,t){this._service=e,t instanceof Xa?this._location=t:this._location=Xa.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Hx(e,t)}get root(){const e=new Xa(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return zee(this._location.path)}get storage(){return this._service}get parent(){const e=Uee(this._location.path);if(e===null)return null;const t=new Xa(this._location.bucket,e);return new Hx(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw Cee(e)}}function YN(n,e){const t=e?.[wee];return t==null?null:Xa.makeFromBucketSpec(t,n)}function $ee(n,e,t,r={}){n.host=`${e}:${t}`;const i=hd(e);i&&(NI(`https://${n.host}/b`),LI("Storage",!0)),n._isUsingEmulator=!0,n._protocol=i?"https":"http";const{mockUserToken:s}=r;s&&(n._overrideAuthToken=typeof s=="string"?s:ND(s,n.app.options.projectId))}class Wee{constructor(e,t,r,i,s,a=!1){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._isUsingEmulator=a,this._bucket=null,this._host=G8,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=Eee,this._maxUploadRetryTime=See,this._requests=new Set,i!=null?this._bucket=Xa.makeFromBucketSpec(i,this._host):this._bucket=YN(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Xa.makeFromBucketSpec(this._url,e):this._bucket=YN(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){KN("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){KN("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Ys(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Hx(this,e)}_makeRequest(e,t,r,i,s=!0){if(this._deleted)return new Pee(B8());{const a=Bee(e,this._appId,r,i,t,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,t){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,i).getPromise()}}const qN="@firebase/storage",XN="0.14.0";const U8="storage";function Hee(n=FI(),e){n=pi(n);const r=Zv(n,U8).getImmediate({identifier:e}),i=PD("storage");return i&&Kee(r,...i),r}function Kee(n,e,t,r={}){$ee(n,e,t,r)}function Yee(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new Wee(t,r,i,e,dd)}function qee(){zh(new cu(U8,Yee,"PUBLIC").setMultipleInstances(!0)),Fo(qN,XN,""),Fo(qN,XN,"esm2020")}qee();const Xee={apiKey:"AIzaSyBcLuKvUr5XqEJTwOf9I0hqJ1o9g3kOZ-g",authDomain:"detectorapp-nl.firebaseapp.com",projectId:"detectorapp-nl",storageBucket:"detectorapp-nl.firebasestorage.app",messagingSenderId:"110954177210",appId:"1:110954177210:web:d77c9ed262ad92bc431883"},OA=GD(Xee),Zf=MX(OA),qc=QJ(OA);Hee(OA);JJ(qc).catch(n=>{n.code==="failed-precondition"?console.warn("Offline persistence failed: Multiple tabs open"):n.code==="unimplemented"&&console.warn("Offline persistence not available in this browser")});const Zee={};function Qee(n,e){let t;try{t=n()}catch{return}return{getItem:i=>{var s;const a=l=>l===null?null:JSON.parse(l,void 0),o=(s=t.getItem(i))!=null?s:null;return o instanceof Promise?o.then(a):a(o)},setItem:(i,s)=>t.setItem(i,JSON.stringify(s,void 0)),removeItem:i=>t.removeItem(i)}}const _p=n=>e=>{try{const t=n(e);return t instanceof Promise?t:{then(r){return _p(r)(t)},catch(r){return this}}}catch(t){return{then(r){return this},catch(r){return _p(r)(t)}}}},Jee=(n,e)=>(t,r,i)=>{let s={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:E=>E,version:0,merge:(E,T)=>({...T,...E}),...e},a=!1;const o=new Set,l=new Set;let u;try{u=s.getStorage()}catch{}if(!u)return n((...E)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...E)},r,i);const h=_p(s.serialize),f=()=>{const E=s.partialize({...r()});let T;const b=h({state:E,version:s.version}).then(I=>u.setItem(s.name,I)).catch(I=>{T=I});if(T)throw T;return b},g=i.setState;i.setState=(E,T)=>{g(E,T),f()};const y=n((...E)=>{t(...E),f()},r,i);let v;const x=()=>{var E;if(!u)return;a=!1,o.forEach(b=>b(r()));const T=((E=s.onRehydrateStorage)==null?void 0:E.call(s,r()))||void 0;return _p(u.getItem.bind(u))(s.name).then(b=>{if(b)return s.deserialize(b)}).then(b=>{if(b)if(typeof b.version=="number"&&b.version!==s.version){if(s.migrate)return s.migrate(b.state,b.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return b.state}).then(b=>{var I;return v=s.merge(b,(I=r())!=null?I:y),t(v,!0),f()}).then(()=>{T?.(v,void 0),a=!0,l.forEach(b=>b(v))}).catch(b=>{T?.(void 0,b)})};return i.persist={setOptions:E=>{s={...s,...E},E.getStorage&&(u=E.getStorage())},clearStorage:()=>{u?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>x(),hasHydrated:()=>a,onHydrate:E=>(o.add(E),()=>{o.delete(E)}),onFinishHydration:E=>(l.add(E),()=>{l.delete(E)})},x(),v||y},ete=(n,e)=>(t,r,i)=>{let s={storage:Qee(()=>localStorage),partialize:x=>x,version:0,merge:(x,E)=>({...E,...x}),...e},a=!1;const o=new Set,l=new Set;let u=s.storage;if(!u)return n((...x)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...x)},r,i);const h=()=>{const x=s.partialize({...r()});return u.setItem(s.name,{state:x,version:s.version})},f=i.setState;i.setState=(x,E)=>{f(x,E),h()};const g=n((...x)=>{t(...x),h()},r,i);i.getInitialState=()=>g;let y;const v=()=>{var x,E;if(!u)return;a=!1,o.forEach(b=>{var I;return b((I=r())!=null?I:g)});const T=((E=s.onRehydrateStorage)==null?void 0:E.call(s,(x=r())!=null?x:g))||void 0;return _p(u.getItem.bind(u))(s.name).then(b=>{if(b)if(typeof b.version=="number"&&b.version!==s.version){if(s.migrate)return[!0,s.migrate(b.state,b.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,b.state];return[!1,void 0]}).then(b=>{var I;const[M,F]=b;if(y=s.merge(F,(I=r())!=null?I:g),t(y,!0),M)return h()}).then(()=>{T?.(y,void 0),y=r(),a=!0,l.forEach(b=>b(y))}).catch(b=>{T?.(void 0,b)})};return i.persist={setOptions:x=>{s={...s,...x},x.storage&&(u=x.storage)},clearStorage:()=>{u?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>v(),hasHydrated:()=>a,onHydrate:x=>(o.add(x),()=>{o.delete(x)}),onFinishHydration:x=>(l.add(x),()=>{l.delete(x)})},s.skipHydration||v(),y||g},tte=(n,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((Zee?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),Jee(n,e)):ete(n,e),B0=tte,Fr=Ra()(B0(n=>({defaultBackground:"CartoDB (licht)",showScaleBar:!0,gpsAutoStart:!1,showAccuracyCircle:!0,hapticFeedback:!0,vondstenLocalOnly:!0,showVondstButton:!1,showLocalVondsten:!0,showCustomPointLayers:!0,fontScale:100,layerPanelFontScale:100,presetPanelFontScale:100,menuFontScale:100,setDefaultBackground:e=>n({defaultBackground:e}),setShowScaleBar:e=>n({showScaleBar:e}),setGpsAutoStart:e=>n({gpsAutoStart:e}),setShowAccuracyCircle:e=>n({showAccuracyCircle:e}),setHapticFeedback:e=>n({hapticFeedback:e}),setVondstenLocalOnly:e=>n({vondstenLocalOnly:e}),setShowVondstButton:e=>n({showVondstButton:e}),setShowLocalVondsten:e=>n({showLocalVondsten:e}),setShowCustomPointLayers:e=>n({showCustomPointLayers:e}),setFontScale:e=>n({fontScale:e}),setLayerPanelFontScale:e=>n({layerPanelFontScale:e}),setPresetPanelFontScale:e=>n({presetPanelFontScale:e}),setMenuFontScale:e=>n({menuFontScale:e})}),{name:"detectorapp-settings",version:2,migrate:(n,e)=>e<2?{...n,showScaleBar:!0}:n})),Aw=Ra()(O0((n,e)=>({user:null,loading:!1,error:null,initialized:!1,setUser:t=>{n(r=>{r.user=t,r.loading=!1})},setLoading:t=>{n(r=>{r.loading=t})},setError:t=>{n(r=>{r.error=t})},signInWithGoogle:async()=>{n(t=>{t.loading=!0,t.error=null});try{const t=new Sl;await Bq(Zf,t)}catch(t){console.error("Google sign-in error:",t),n(r=>{r.error=t.message,r.loading=!1})}},logout:async()=>{n(t=>{t.loading=!0});try{await u6(Zf)}catch(t){console.error("Logout error:",t),n(r=>{r.error=t.message,r.loading=!1})}},initAuth:()=>{e().initialized||(n(t=>{t.initialized=!0}),c6(Zf,t=>{n(r=>{r.user=t,r.loading=!1}),t&&Fr.getState().setVondstenLocalOnly(!1)}))}})));Ra()(O0((n,e)=>({vondsten:[],loading:!1,error:null,loadVondsten:async t=>{n(r=>{r.loading=!0});try{const r=hee(jN(qc,"vondsten"),dee("userId","==",t)),s=(await pee(r)).docs.map(a=>({id:a.id,...a.data()}));n(a=>{a.vondsten=s,a.loading=!1})}catch(r){n(i=>{i.error=r.message,i.loading=!1})}},addVondst:async t=>{const r=new Date().toISOString(),i={...t,createdAt:r,updatedAt:r},s=await xee(jN(qc,"vondsten"),i);return n(a=>{a.vondsten.push({...i,id:s.id})}),s.id},updateVondst:async(t,r)=>{const i=qf(qc,"vondsten",t);await yee(i,{...r,updatedAt:new Date().toISOString()}),n(s=>{const a=s.vondsten.findIndex(o=>o.id===t);a!==-1&&(s.vondsten[a]={...s.vondsten[a],...r})})},deleteVondst:async t=>{await _ee(qf(qc,"vondsten",t)),n(r=>{r.vondsten=r.vondsten.filter(i=>i.id!==t)})}})));const pS=[{id:"detectie",name:"Detectie",icon:"Compass",layers:["AMK Monumenten","Gewaspercelen"],baseLayer:"CartoDB (licht)",isBuiltIn:!1},{id:"steentijd",name:"Steentijd",icon:"Mountain",layers:["Hunebedden","Grafheuvels","Terpen","FAMKE Steentijd","AMK Steentijd","AHN4 Multi-Hillshade NL","Labels Overlay"],baseLayer:"Luchtfoto",isBuiltIn:!1},{id:"romeins-midvroeg",name:"Romeins - Mid vroeg",icon:"Layers",layers:["Romeinse wegen (regio)","Romeinse Forten","Romeinse Forten Lijnen","AMK Romeins","AMK Vroege ME","Gewaspercelen","Kadastrale Grenzen"],isBuiltIn:!1},{id:"midlaat-nieuwetijd",name:"Mid laat - Nieuwe tijd",icon:"Grid",layers:["AMK Late ME","Kastelen","Essen","Rijksmonumenten","Gewaspercelen","Kadastrale Grenzen","Oude Kernen"],isBuiltIn:!1},{id:"woii-militair",name:"WOII & Militair",icon:"Target",layers:["WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Inundatiegebieden","Militaire Objecten"],isBuiltIn:!1},{id:"analyse",name:"Terrein Analyse",icon:"Search",layers:["IKAW","Geomorfologie","Bodemkaart","Archeo Landschappen","AHN4 Multi-Hillshade NL","AHN4 Hoogtekaart Kleur"],isBuiltIn:!1}],ZN=["Labels Overlay","TMK 1850","Bonnebladen 1900","Hunebedden","FAMKE Steentijd","Grafheuvels","Terpen","AMK Monumenten","AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig","Romeinse wegen (regio)","Romeinse wegen (Wereld)","Romeinse Forten","Romeinse Forten Lijnen","Kastelen","IKAW","Archeo Landschappen","Rijksmonumenten","Werelderfgoed","Religieus Erfgoed","Essen","WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Inundatiegebieden","Militaire Objecten","Paleokaart 800 n.Chr.","Paleokaart 100 n.Chr.","Paleokaart 500 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 9000 v.Chr.","UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling","AHN4 Hoogtekaart Kleur","AHN4 Hillshade NL","AHN4 Multi-Hillshade NL","AHN 0.5m","Veengebieden","Geomorfologie","Bodemkaart","Fossielen Nederland","Fossielen Belgi","Fossielen Duitsland","Fossielen Frankrijk","Parken","Speeltuinen","Musea","Strandjes","Kringloopwinkels","Gewaspercelen","Kadastrale Grenzen","Scheepswrakken","Woonheuvels ZH","Windmolens","Erfgoedlijnen","Oude Kernen","Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken","Verdronken Dorpen"],z8=Ra()(B0((n,e)=>({presets:[...pS],applyPreset:t=>{const r=e().presets.find(s=>s.id===t);if(!r)return;const i=di.getState();ZN.forEach(s=>i.setLayerVisibility(s,!1)),r.layers.forEach(s=>i.setLayerVisibility(s,!0)),r.baseLayer&&["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"].forEach(a=>{i.setLayerVisibility(a,a===r.baseLayer)}),console.log(` Preset toegepast: ${r.name}${r.baseLayer?` (${r.baseLayer})`:""}`)},createPreset:(t,r)=>{const i=di.getState(),s=Object.entries(i.visible).filter(([o,l])=>l&&ZN.includes(o)).map(([o])=>o),a={id:`custom-${Date.now()}`,name:t,icon:r,layers:s,isBuiltIn:!1};n(o=>({presets:[...o.presets,a]})),console.log(` Preset aangemaakt: ${t} met ${s.length} lagen`)},updatePreset:(t,r)=>{n(i=>({presets:i.presets.map(s=>s.id===t?{...s,...r}:s)}))},deletePreset:t=>{n(r=>({presets:r.presets.filter(i=>i.id!==t||i.isBuiltIn)}))},resetToDefaults:()=>{n({presets:[...pS]})}}),{name:"detectorapp-presets",version:9,migrate:(n,e)=>e<9?{presets:[...pS]}:n})),QN=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899"],_1=Ra()(B0((n,e)=>({layers:[],addLayer:t=>{const r=crypto.randomUUID(),i=e().layers.length,s=QN[i%QN.length];return n(a=>({layers:[...a.layers,{...t,id:r,createdAt:new Date().toISOString(),color:t.color||s,visible:t.visible??!0,opacity:t.opacity??1}]})),r},removeLayer:t=>n(r=>({layers:r.layers.filter(i=>i.id!==t)})),updateLayer:(t,r)=>n(i=>({layers:i.layers.map(s=>s.id===t?{...s,...r}:s)})),toggleVisibility:t=>n(r=>({layers:r.layers.map(i=>i.id===t?{...i,visible:!i.visible}:i)})),setOpacity:(t,r)=>n(i=>({layers:i.layers.map(s=>s.id===t?{...s,opacity:r}:s)})),setColor:(t,r)=>n(i=>({layers:i.layers.map(s=>s.id===t?{...s,color:r}:s)})),clearAll:()=>n({layers:[]})}),{name:"detectorapp-custom-layers",version:1})),nte=["CartoDB (licht)","OpenStreetMap","Luchtfoto","Labels Overlay","Mijn Vondsten"],DA=Ra()(B0((n,e)=>({tier:"free",unlockedRegions:["nl"],devMode:!0,setTier:t=>n({tier:t}),unlockRegion:t=>n(r=>({unlockedRegions:r.unlockedRegions.includes(t)?r.unlockedRegions:[...r.unlockedRegions,t]})),lockRegion:t=>n(r=>({unlockedRegions:r.unlockedRegions.filter(i=>i!==t)})),setDevMode:t=>n({devMode:t}),isRegionUnlocked:t=>{const r=e();return r.devMode||r.tier==="pro"?!0:r.unlockedRegions.includes(t)},isLayerUnlocked:(t,r="free",i=["nl"])=>{const s=e();return s.devMode||nte.includes(t)||r==="free"||s.tier==="pro"?!0:s.tier==="premium"?i.some(a=>s.unlockedRegions.includes(a)):!1},canAccessPremiumFeatures:()=>{const t=e();return t.devMode||t.tier!=="free"}}),{name:"detectorapp-subscription",version:1}));function rte({target:n,viewOptions:e}){const t=ie.useRef(null),r=ie.useRef(null),i=hs(a=>a.setMap),s=Fr(a=>a.showScaleBar);return ie.useEffect(()=>{if(!t.current){const a={center:[5.1214,52.0907],zoom:8,rotation:0,minZoom:3,maxZoom:19,...e},o=new IH({target:n,controls:[],view:new Mo({center:Ho(a.center),zoom:a.zoom,rotation:a.rotation,minZoom:a.minZoom,maxZoom:a.maxZoom})});t.current=o,i(o),window.__olMap=o}return()=>{t.current&&(t.current.setTarget(void 0),i(null),window.__olMap=null)}},[n,e,i]),ie.useEffect(()=>{const a=t.current;a&&(s?r.current||(r.current=new CH({units:"metric",bar:!1,text:!0,minWidth:80}),a.addControl(r.current)):r.current&&(a.removeControl(r.current),r.current=null))},[s]),t.current}const JN=["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"];function ite(){const n=ie.useRef(null),e=ie.useRef(!1);rte({target:"map"});const t=hs(f=>f.map),r=di(f=>f.registerLayer),i=di(f=>f.setLayerVisibility),s=Fr(f=>f.defaultBackground);ie.useEffect(()=>{if(!t){console.warn(" Map not initialized yet");return}console.log(" Initializing map layers...");const f=new nh({properties:{title:"OpenStreetMap",type:"base"},visible:!1,source:new WW}),g=new nh({properties:{title:"CartoDB (licht)",type:"base"},visible:!0,source:new wf({url:"https://{a-d}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO"})}),y=new nh({properties:{title:"Luchtfoto",type:"base"},visible:!1,source:new wf({url:"https://service.pdok.nl/hwh/luchtfotorgb/wmts/v1_0/Actueel_orthoHR/EPSG:3857/{z}/{x}/{y}.jpeg",attributions:" Kadaster / PDOK Luchtfoto",maxZoom:19})}),v=new nh({properties:{title:"Labels Overlay",type:"overlay"},visible:!1,source:new wf({url:"https://{a-d}.basemaps.cartocdn.com/rastertiles/voyager_only_labels/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO",maxZoom:20}),zIndex:100}),x=new nh({properties:{title:"TMK 1850",type:"base"},visible:!1,source:new wf({url:"https://s.map5.nl/map/gast/tiles/tmk_1850/EPSG3857/{z}/{x}/{y}.png",attributions:" Kadaster / Map5.nl",crossOrigin:"anonymous",maxZoom:14})}),E=new nh({properties:{title:"Bonnebladen 1900",type:"base"},visible:!1,source:new wf({url:"https://s.map5.nl/map/gast/tiles/bonne_1900/EPSG3857/{z}/{x}/{y}.png",attributions:" Kadaster / Map5.nl",crossOrigin:"anonymous",maxZoom:14})});t.addLayer(f),t.addLayer(g),t.addLayer(y),t.addLayer(v),t.addLayer(x),t.addLayer(E),console.log(" Base layers added:",{osm:f.getVisible(),cartodb:g.getVisible(),satellite:y.getVisible()}),r("OpenStreetMap",f),r("CartoDB (licht)",g),r("Luchtfoto",y),r("Labels Overlay",v),r("TMK 1850",x),r("Bonnebladen 1900",E),t.updateSize(),console.log(" Map size:",t.getSize()),console.log(" Map center:",t.getView().getCenter()),console.log(" Map zoom:",t.getView().getZoom()),a()},[t,r]);async function a(){if(!t){console.error(" Cannot load layers: map is null");return}const f=nK();console.log(` Loading ${f.length} immediate-load layers (WMS/Tile)...`);const g=await Promise.allSettled(f.map(async v=>{try{const x=await v.factory();return x?{name:v.name,layer:x}:null}catch(x){return console.warn(` Failed to create ${v.name}:`,x),null}}));let y=0;g.forEach(v=>{if(v.status==="fulfilled"&&v.value){const{name:x,layer:E}=v.value;t.addLayer(E),r(x,E),y++,console.log(`   ${x}`)}}),console.log(` Immediate layers loaded: ${y}/${f.length}`),console.log(` Total layers on map: ${t.getLayers().getLength()}`),console.log(" Vector layers will load on first toggle (lazy loading enabled)")}ie.useEffect(()=>{if(!t||e.current)return;const f=setTimeout(()=>{const g=s||"CartoDB (licht)";JN.forEach(y=>{i(y,!1)}),JN.includes(g)?i(g,!0):i("CartoDB (licht)",!0),e.current=!0,console.log(` Default background: ${g}`)},100);return()=>clearTimeout(f)},[t,s,i]);const o=Fr(f=>f.gpsAutoStart),l=is(f=>f.startTracking),u=ie.useRef(!1);ie.useEffect(()=>{if(!(!t||u.current)&&o){const f=setTimeout(()=>{l(),u.current=!0,console.log(" GPS autostart enabled - tracking started")},500);return()=>clearTimeout(f)}},[t,o,l]);const h={width:"100%",height:"100vh"};return p.jsx("div",{id:"map",ref:n,style:h})}const FA=ie.createContext({});function jA(n){const e=ie.useRef(null);return e.current===null&&(e.current=n()),e.current}const Rw=ie.createContext(null),VA=ie.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});class ste extends ie.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=t.offsetHeight||0,r.width=t.offsetWidth||0,r.top=t.offsetTop,r.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function ate({children:n,isPresent:e}){const t=ie.useId(),r=ie.useRef(null),i=ie.useRef({width:0,height:0,top:0,left:0}),{nonce:s}=ie.useContext(VA);return ie.useInsertionEffect(()=>{const{width:a,height:o,top:l,left:u}=i.current;if(e||!r.current||!a||!o)return;r.current.dataset.motionPopId=t;const h=document.createElement("style");return s&&(h.nonce=s),document.head.appendChild(h),h.sheet&&h.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${a}px !important;
            height: ${o}px !important;
            top: ${l}px !important;
            left: ${u}px !important;
          }
        `),()=>{document.head.removeChild(h)}},[e]),p.jsx(ste,{isPresent:e,childRef:r,sizeRef:i,children:ie.cloneElement(n,{ref:r})})}const ote=({children:n,initial:e,isPresent:t,onExitComplete:r,custom:i,presenceAffectsLayout:s,mode:a})=>{const o=jA(lte),l=ie.useId(),u=ie.useCallback(f=>{o.set(f,!0);for(const g of o.values())if(!g)return;r&&r()},[o,r]),h=ie.useMemo(()=>({id:l,initial:e,isPresent:t,custom:i,onExitComplete:u,register:f=>(o.set(f,!1),()=>o.delete(f))}),s?[Math.random(),u]:[t,u]);return ie.useMemo(()=>{o.forEach((f,g)=>o.set(g,!1))},[t]),ie.useEffect(()=>{!t&&!o.size&&r&&r()},[t]),a==="popLayout"&&(n=p.jsx(ate,{isPresent:t,children:n})),p.jsx(Rw.Provider,{value:h,children:n})};function lte(){return new Map}function $8(n=!0){const e=ie.useContext(Rw);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:r,register:i}=e,s=ie.useId();ie.useEffect(()=>{n&&i(s)},[n]);const a=ie.useCallback(()=>n&&r&&r(s),[s,r,n]);return!t&&r?[!1,a]:[!0]}const s_=n=>n.key||"";function e3(n){const e=[];return ie.Children.forEach(n,t=>{ie.isValidElement(t)&&e.push(t)}),e}const GA=typeof window<"u",W8=GA?ie.useLayoutEffect:ie.useEffect,jr=({children:n,custom:e,initial:t=!0,onExitComplete:r,presenceAffectsLayout:i=!0,mode:s="sync",propagate:a=!1})=>{const[o,l]=$8(a),u=ie.useMemo(()=>e3(n),[n]),h=a&&!o?[]:u.map(s_),f=ie.useRef(!0),g=ie.useRef(u),y=jA(()=>new Map),[v,x]=ie.useState(u),[E,T]=ie.useState(u);W8(()=>{f.current=!1,g.current=u;for(let M=0;M<E.length;M++){const F=s_(E[M]);h.includes(F)?y.delete(F):y.get(F)!==!0&&y.set(F,!1)}},[E,h.length,h.join("-")]);const b=[];if(u!==v){let M=[...u];for(let F=0;F<E.length;F++){const z=E[F],k=s_(z);h.includes(k)||(M.splice(F,0,z),b.push(z))}s==="wait"&&b.length&&(M=b),T(e3(M)),x(u);return}const{forceRender:I}=ie.useContext(FA);return p.jsx(p.Fragment,{children:E.map(M=>{const F=s_(M),z=a&&!o?!1:u===E||h.includes(F),k=()=>{if(y.has(F))y.set(F,!0);else return;let C=!0;y.forEach(P=>{P||(C=!1)}),C&&(I?.(),T(g.current),a&&l?.(),r&&r())};return p.jsx(ote,{isPresent:z,initial:!f.current||t?void 0:!1,custom:z?void 0:e,presenceAffectsLayout:i,mode:s,onExitComplete:z?void 0:k,children:M},F)})})},Zs=n=>n;let H8=Zs;function BA(n){let e;return()=>(e===void 0&&(e=n()),e)}const A0=(n,e,t)=>{const r=e-n;return r===0?1:(t-n)/r},Ll=n=>n*1e3,Ol=n=>n/1e3,cte={useManualTiming:!1};function ute(n){let e=new Set,t=new Set,r=!1,i=!1;const s=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1};function o(u){s.has(u)&&(l.schedule(u),n()),u(a)}const l={schedule:(u,h=!1,f=!1)=>{const y=f&&r?e:t;return h&&s.add(u),y.has(u)||y.add(u),u},cancel:u=>{t.delete(u),s.delete(u)},process:u=>{if(a=u,r){i=!0;return}r=!0,[e,t]=[t,e],e.forEach(o),e.clear(),r=!1,i&&(i=!1,l.process(u))}};return l}const a_=["read","resolveKeyframes","update","preRender","render","postRender"],hte=40;function K8(n,e){let t=!1,r=!0;const i={delta:0,timestamp:0,isProcessing:!1},s=()=>t=!0,a=a_.reduce((T,b)=>(T[b]=ute(s),T),{}),{read:o,resolveKeyframes:l,update:u,preRender:h,render:f,postRender:g}=a,y=()=>{const T=performance.now();t=!1,i.delta=r?1e3/60:Math.max(Math.min(T-i.timestamp,hte),1),i.timestamp=T,i.isProcessing=!0,o.process(i),l.process(i),u.process(i),h.process(i),f.process(i),g.process(i),i.isProcessing=!1,t&&e&&(r=!1,n(y))},v=()=>{t=!0,r=!0,i.isProcessing||n(y)};return{schedule:a_.reduce((T,b)=>{const I=a[b];return T[b]=(M,F=!1,z=!1)=>(t||v(),I.schedule(M,F,z)),T},{}),cancel:T=>{for(let b=0;b<a_.length;b++)a[a_[b]].cancel(T)},state:i,steps:a}}const{schedule:lr,cancel:mu,state:Si,steps:yS}=K8(typeof requestAnimationFrame<"u"?requestAnimationFrame:Zs,!0),Y8=ie.createContext({strict:!1}),t3={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},R0={};for(const n in t3)R0[n]={isEnabled:e=>t3[n].some(t=>!!e[t])};function dte(n){for(const e in n)R0[e]={...R0[e],...n[e]}}const fte=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Kx(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||fte.has(n)}let q8=n=>!Kx(n);function gte(n){n&&(q8=e=>e.startsWith("on")?!Kx(e):n(e))}try{gte(require("@emotion/is-prop-valid").default)}catch{}function mte(n,e,t){const r={};for(const i in n)i==="values"&&typeof n.values=="object"||(q8(i)||t===!0&&Kx(i)||!e&&!Kx(i)||n.draggable&&i.startsWith("onDrag"))&&(r[i]=n[i]);return r}function pte(n){if(typeof Proxy>"u")return n;const e=new Map,t=(...r)=>n(...r);return new Proxy(t,{get:(r,i)=>i==="create"?n:(e.has(i)||e.set(i,n(i)),e.get(i))})}const Cw=ie.createContext({});function xp(n){return typeof n=="string"||Array.isArray(n)}function Pw(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}const UA=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],zA=["initial",...UA];function kw(n){return Pw(n.animate)||zA.some(e=>xp(n[e]))}function X8(n){return!!(kw(n)||n.variants)}function yte(n,e){if(kw(n)){const{initial:t,animate:r}=n;return{initial:t===!1||xp(t)?t:void 0,animate:xp(r)?r:void 0}}return n.inherit!==!1?e:{}}function _te(n){const{initial:e,animate:t}=yte(n,ie.useContext(Cw));return ie.useMemo(()=>({initial:e,animate:t}),[n3(e),n3(t)])}function n3(n){return Array.isArray(n)?n.join(" "):n}const xte=Symbol.for("motionComponentSymbol");function Mf(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function vte(n,e,t){return ie.useCallback(r=>{r&&n.onMount&&n.onMount(r),e&&(r?e.mount(r):e.unmount()),t&&(typeof t=="function"?t(r):Mf(t)&&(t.current=r))},[e])}const $A=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),wte="framerAppearId",Z8="data-"+$A(wte),{schedule:WA}=K8(queueMicrotask,!1),Q8=ie.createContext({});function Ete(n,e,t,r,i){var s,a;const{visualElement:o}=ie.useContext(Cw),l=ie.useContext(Y8),u=ie.useContext(Rw),h=ie.useContext(VA).reducedMotion,f=ie.useRef(null);r=r||l.renderer,!f.current&&r&&(f.current=r(n,{visualState:e,parent:o,props:t,presenceContext:u,blockInitialAnimation:u?u.initial===!1:!1,reducedMotionConfig:h}));const g=f.current,y=ie.useContext(Q8);g&&!g.projection&&i&&(g.type==="html"||g.type==="svg")&&Ste(f.current,t,i,y);const v=ie.useRef(!1);ie.useInsertionEffect(()=>{g&&v.current&&g.update(t,u)});const x=t[Z8],E=ie.useRef(!!x&&!(!((s=window.MotionHandoffIsComplete)===null||s===void 0)&&s.call(window,x))&&((a=window.MotionHasOptimisedAnimation)===null||a===void 0?void 0:a.call(window,x)));return W8(()=>{g&&(v.current=!0,window.MotionIsMounted=!0,g.updateFeatures(),WA.render(g.render),E.current&&g.animationState&&g.animationState.animateChanges())}),ie.useEffect(()=>{g&&(!E.current&&g.animationState&&g.animationState.animateChanges(),E.current&&(queueMicrotask(()=>{var T;(T=window.MotionHandoffMarkAsComplete)===null||T===void 0||T.call(window,x)}),E.current=!1))}),g}function Ste(n,e,t,r){const{layoutId:i,layout:s,drag:a,dragConstraints:o,layoutScroll:l,layoutRoot:u}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:J8(n.parent)),n.projection.setOptions({layoutId:i,layout:s,alwaysMeasureLayout:!!a||o&&Mf(o),visualElement:n,animationType:typeof s=="string"?s:"both",initialPromotionConfig:r,layoutScroll:l,layoutRoot:u})}function J8(n){if(n)return n.options.allowProjection!==!1?n.projection:J8(n.parent)}function Tte({preloadedFeatures:n,createVisualElement:e,useRender:t,useVisualState:r,Component:i}){var s,a;n&&dte(n);function o(u,h){let f;const g={...ie.useContext(VA),...u,layoutId:bte(u)},{isStatic:y}=g,v=_te(u),x=r(u,y);if(!y&&GA){Ite();const E=Ate(g);f=E.MeasureLayout,v.visualElement=Ete(i,x,g,e,E.ProjectionNode)}return p.jsxs(Cw.Provider,{value:v,children:[f&&v.visualElement?p.jsx(f,{visualElement:v.visualElement,...g}):null,t(i,u,vte(x,v.visualElement,h),x,y,v.visualElement)]})}o.displayName=`motion.${typeof i=="string"?i:`create(${(a=(s=i.displayName)!==null&&s!==void 0?s:i.name)!==null&&a!==void 0?a:""})`}`;const l=ie.forwardRef(o);return l[xte]=i,l}function bte({layoutId:n}){const e=ie.useContext(FA).id;return e&&n!==void 0?e+"-"+n:n}function Ite(n,e){ie.useContext(Y8).strict}function Ate(n){const{drag:e,layout:t}=R0;if(!e&&!t)return{};const r={...e,...t};return{MeasureLayout:e?.isEnabled(n)||t?.isEnabled(n)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}const Rte=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function HA(n){return typeof n!="string"||n.includes("-")?!1:!!(Rte.indexOf(n)>-1||/[A-Z]/u.test(n))}function r3(n){const e=[{},{}];return n?.values.forEach((t,r)=>{e[0][r]=t.get(),e[1][r]=t.getVelocity()}),e}function KA(n,e,t,r){if(typeof e=="function"){const[i,s]=r3(r);e=e(t!==void 0?t:n.custom,i,s)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[i,s]=r3(r);e=e(t!==void 0?t:n.custom,i,s)}return e}const ib=n=>Array.isArray(n),Cte=n=>!!(n&&typeof n=="object"&&n.mix&&n.toValue),Pte=n=>ib(n)?n[n.length-1]||0:n,Hi=n=>!!(n&&n.getVelocity);function z_(n){const e=Hi(n)?n.get():n;return Cte(e)?e.toValue():e}function kte({scrapeMotionValuesFromProps:n,createRenderState:e,onUpdate:t},r,i,s){const a={latestValues:Mte(r,i,s,n),renderState:e()};return t&&(a.onMount=o=>t({props:r,current:o,...a}),a.onUpdate=o=>t(o)),a}const ej=n=>(e,t)=>{const r=ie.useContext(Cw),i=ie.useContext(Rw),s=()=>kte(n,e,r,i);return t?s():jA(s)};function Mte(n,e,t,r){const i={},s=r(n,{});for(const g in s)i[g]=z_(s[g]);let{initial:a,animate:o}=n;const l=kw(n),u=X8(n);e&&u&&!l&&n.inherit!==!1&&(a===void 0&&(a=e.initial),o===void 0&&(o=e.animate));let h=t?t.initial===!1:!1;h=h||a===!1;const f=h?o:a;if(f&&typeof f!="boolean"&&!Pw(f)){const g=Array.isArray(f)?f:[f];for(let y=0;y<g.length;y++){const v=KA(n,g[y]);if(v){const{transitionEnd:x,transition:E,...T}=v;for(const b in T){let I=T[b];if(Array.isArray(I)){const M=h?I.length-1:0;I=I[M]}I!==null&&(i[b]=I)}for(const b in x)i[b]=x[b]}}}return i}const U0=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],md=new Set(U0),tj=n=>e=>typeof e=="string"&&e.startsWith(n),nj=tj("--"),Nte=tj("var(--"),YA=n=>Nte(n)?Lte.test(n.split("/*")[0].trim()):!1,Lte=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,rj=(n,e)=>e&&typeof n=="number"?e.transform(n):n,$l=(n,e,t)=>t>e?e:t<n?n:t,z0={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},vp={...z0,transform:n=>$l(0,1,n)},o_={...z0,default:1},x1=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),Oc=x1("deg"),Uo=x1("%"),Dt=x1("px"),Ote=x1("vh"),Dte=x1("vw"),i3={...Uo,parse:n=>Uo.parse(n)/100,transform:n=>Uo.transform(n*100)},Fte={borderWidth:Dt,borderTopWidth:Dt,borderRightWidth:Dt,borderBottomWidth:Dt,borderLeftWidth:Dt,borderRadius:Dt,radius:Dt,borderTopLeftRadius:Dt,borderTopRightRadius:Dt,borderBottomRightRadius:Dt,borderBottomLeftRadius:Dt,width:Dt,maxWidth:Dt,height:Dt,maxHeight:Dt,top:Dt,right:Dt,bottom:Dt,left:Dt,padding:Dt,paddingTop:Dt,paddingRight:Dt,paddingBottom:Dt,paddingLeft:Dt,margin:Dt,marginTop:Dt,marginRight:Dt,marginBottom:Dt,marginLeft:Dt,backgroundPositionX:Dt,backgroundPositionY:Dt},jte={rotate:Oc,rotateX:Oc,rotateY:Oc,rotateZ:Oc,scale:o_,scaleX:o_,scaleY:o_,scaleZ:o_,skew:Oc,skewX:Oc,skewY:Oc,distance:Dt,translateX:Dt,translateY:Dt,translateZ:Dt,x:Dt,y:Dt,z:Dt,perspective:Dt,transformPerspective:Dt,opacity:vp,originX:i3,originY:i3,originZ:Dt},s3={...z0,transform:Math.round},qA={...Fte,...jte,zIndex:s3,size:Dt,fillOpacity:vp,strokeOpacity:vp,numOctaves:s3},Vte={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},Gte=U0.length;function Bte(n,e,t){let r="",i=!0;for(let s=0;s<Gte;s++){const a=U0[s],o=n[a];if(o===void 0)continue;let l=!0;if(typeof o=="number"?l=o===(a.startsWith("scale")?1:0):l=parseFloat(o)===0,!l||t){const u=rj(o,qA[a]);if(!l){i=!1;const h=Vte[a]||a;r+=`${h}(${u}) `}t&&(e[a]=u)}}return r=r.trim(),t?r=t(e,i?"":r):i&&(r="none"),r}function XA(n,e,t){const{style:r,vars:i,transformOrigin:s}=n;let a=!1,o=!1;for(const l in e){const u=e[l];if(md.has(l)){a=!0;continue}else if(nj(l)){i[l]=u;continue}else{const h=rj(u,qA[l]);l.startsWith("origin")?(o=!0,s[l]=h):r[l]=h}}if(e.transform||(a||t?r.transform=Bte(e,n.transform,t):r.transform&&(r.transform="none")),o){const{originX:l="50%",originY:u="50%",originZ:h=0}=s;r.transformOrigin=`${l} ${u} ${h}`}}const Ute={offset:"stroke-dashoffset",array:"stroke-dasharray"},zte={offset:"strokeDashoffset",array:"strokeDasharray"};function $te(n,e,t=1,r=0,i=!0){n.pathLength=1;const s=i?Ute:zte;n[s.offset]=Dt.transform(-r);const a=Dt.transform(e),o=Dt.transform(t);n[s.array]=`${a} ${o}`}function a3(n,e,t){return typeof n=="string"?n:Dt.transform(e+t*n)}function Wte(n,e,t){const r=a3(e,n.x,n.width),i=a3(t,n.y,n.height);return`${r} ${i}`}function ZA(n,{attrX:e,attrY:t,attrScale:r,originX:i,originY:s,pathLength:a,pathSpacing:o=1,pathOffset:l=0,...u},h,f){if(XA(n,u,f),h){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:g,style:y,dimensions:v}=n;g.transform&&(v&&(y.transform=g.transform),delete g.transform),v&&(i!==void 0||s!==void 0||y.transform)&&(y.transformOrigin=Wte(v,i!==void 0?i:.5,s!==void 0?s:.5)),e!==void 0&&(g.x=e),t!==void 0&&(g.y=t),r!==void 0&&(g.scale=r),a!==void 0&&$te(g,a,o,l,!1)}const QA=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),ij=()=>({...QA(),attrs:{}}),JA=n=>typeof n=="string"&&n.toLowerCase()==="svg";function sj(n,{style:e,vars:t},r,i){Object.assign(n.style,e,i&&i.getProjectionStyles(r));for(const s in t)n.style.setProperty(s,t[s])}const aj=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function oj(n,e,t,r){sj(n,e,void 0,r);for(const i in e.attrs)n.setAttribute(aj.has(i)?i:$A(i),e.attrs[i])}const Yx={};function Hte(n){Object.assign(Yx,n)}function lj(n,{layout:e,layoutId:t}){return md.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!Yx[n]||n==="opacity")}function eR(n,e,t){var r;const{style:i}=n,s={};for(const a in i)(Hi(i[a])||e.style&&Hi(e.style[a])||lj(a,n)||((r=t?.getValue(a))===null||r===void 0?void 0:r.liveStyle)!==void 0)&&(s[a]=i[a]);return s}function cj(n,e,t){const r=eR(n,e,t);for(const i in n)if(Hi(n[i])||Hi(e[i])){const s=U0.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;r[s]=n[i]}return r}function Kte(n,e){try{e.dimensions=typeof n.getBBox=="function"?n.getBBox():n.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const o3=["x","y","width","height","cx","cy","r"],Yte={useVisualState:ej({scrapeMotionValuesFromProps:cj,createRenderState:ij,onUpdate:({props:n,prevProps:e,current:t,renderState:r,latestValues:i})=>{if(!t)return;let s=!!n.drag;if(!s){for(const o in i)if(md.has(o)){s=!0;break}}if(!s)return;let a=!e;if(e)for(let o=0;o<o3.length;o++){const l=o3[o];n[l]!==e[l]&&(a=!0)}a&&lr.read(()=>{Kte(t,r),lr.render(()=>{ZA(r,i,JA(t.tagName),n.transformTemplate),oj(t,r)})})}})},qte={useVisualState:ej({scrapeMotionValuesFromProps:eR,createRenderState:QA})};function uj(n,e,t){for(const r in e)!Hi(e[r])&&!lj(r,t)&&(n[r]=e[r])}function Xte({transformTemplate:n},e){return ie.useMemo(()=>{const t=QA();return XA(t,e,n),Object.assign({},t.vars,t.style)},[e])}function Zte(n,e){const t=n.style||{},r={};return uj(r,t,n),Object.assign(r,Xte(n,e)),r}function Qte(n,e){const t={},r=Zte(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=r,t}function Jte(n,e,t,r){const i=ie.useMemo(()=>{const s=ij();return ZA(s,e,JA(r),n.transformTemplate),{...s.attrs,style:{...s.style}}},[e]);if(n.style){const s={};uj(s,n.style,n),i.style={...s,...i.style}}return i}function ene(n=!1){return(t,r,i,{latestValues:s},a)=>{const l=(HA(t)?Jte:Qte)(r,s,a,t),u=mte(r,typeof t=="string",n),h=t!==ie.Fragment?{...u,...l,ref:i}:{},{children:f}=r,g=ie.useMemo(()=>Hi(f)?f.get():f,[f]);return ie.createElement(t,{...h,children:g})}}function tne(n,e){return function(r,{forwardMotionProps:i}={forwardMotionProps:!1}){const a={...HA(r)?Yte:qte,preloadedFeatures:n,useRender:ene(i),createVisualElement:e,Component:r};return Tte(a)}}function hj(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let r=0;r<t;r++)if(e[r]!==n[r])return!1;return!0}function Mw(n,e,t){const r=n.getProps();return KA(r,e,t!==void 0?t:r.custom,n)}const nne=BA(()=>window.ScrollTimeline!==void 0);class rne{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,t){for(let r=0;r<this.animations.length;r++)this.animations[r][e]=t}attachTimeline(e,t){const r=this.animations.map(i=>{if(nne()&&i.attachTimeline)return i.attachTimeline(e);if(typeof t=="function")return t(i)});return()=>{r.forEach((i,s)=>{i&&i(),this.animations[s].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let t=0;t<this.animations.length;t++)e=Math.max(e,this.animations[t].duration);return e}runAll(e){this.animations.forEach(t=>t[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class ine extends rne{then(e,t){return Promise.all(this.animations).then(e).catch(t)}}function tR(n,e){return n?n[e]||n.default||n:void 0}const sb=2e4;function dj(n){let e=0;const t=50;let r=n.next(e);for(;!r.done&&e<sb;)e+=t,r=n.next(e);return e>=sb?1/0:e}function nR(n){return typeof n=="function"}function l3(n,e){n.timeline=e,n.onfinish=null}const rR=n=>Array.isArray(n)&&typeof n[0]=="number",sne={linearEasing:void 0};function ane(n,e){const t=BA(n);return()=>{var r;return(r=sne[e])!==null&&r!==void 0?r:t()}}const qx=ane(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),fj=(n,e,t=10)=>{let r="";const i=Math.max(Math.round(e/t),2);for(let s=0;s<i;s++)r+=n(A0(0,i-1,s))+", ";return`linear(${r.substring(0,r.length-2)})`};function gj(n){return!!(typeof n=="function"&&qx()||!n||typeof n=="string"&&(n in ab||qx())||rR(n)||Array.isArray(n)&&n.every(gj))}const sm=([n,e,t,r])=>`cubic-bezier(${n}, ${e}, ${t}, ${r})`,ab={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:sm([0,.65,.55,1]),circOut:sm([.55,0,1,.45]),backIn:sm([.31,.01,.66,-.59]),backOut:sm([.33,1.53,.69,.99])};function mj(n,e){if(n)return typeof n=="function"&&qx()?fj(n,e):rR(n)?sm(n):Array.isArray(n)?n.map(t=>mj(t,e)||ab.easeOut):ab[n]}const Ba={x:!1,y:!1};function pj(){return Ba.x||Ba.y}function one(n,e,t){var r;if(n instanceof Element)return[n];if(typeof n=="string"){let i=document;const s=(r=void 0)!==null&&r!==void 0?r:i.querySelectorAll(n);return s?Array.from(s):[]}return Array.from(n)}function yj(n,e){const t=one(n),r=new AbortController,i={passive:!0,...e,signal:r.signal};return[t,i,()=>r.abort()]}function c3(n){return e=>{e.pointerType==="touch"||pj()||n(e)}}function lne(n,e,t={}){const[r,i,s]=yj(n,t),a=c3(o=>{const{target:l}=o,u=e(o);if(typeof u!="function"||!l)return;const h=c3(f=>{u(f),l.removeEventListener("pointerleave",h)});l.addEventListener("pointerleave",h,i)});return r.forEach(o=>{o.addEventListener("pointerenter",a,i)}),s}const _j=(n,e)=>e?n===e?!0:_j(n,e.parentElement):!1,iR=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,cne=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function une(n){return cne.has(n.tagName)||n.tabIndex!==-1}const am=new WeakSet;function u3(n){return e=>{e.key==="Enter"&&n(e)}}function _S(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const hne=(n,e)=>{const t=n.currentTarget;if(!t)return;const r=u3(()=>{if(am.has(t))return;_S(t,"down");const i=u3(()=>{_S(t,"up")}),s=()=>_S(t,"cancel");t.addEventListener("keyup",i,e),t.addEventListener("blur",s,e)});t.addEventListener("keydown",r,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",r),e)};function h3(n){return iR(n)&&!pj()}function dne(n,e,t={}){const[r,i,s]=yj(n,t),a=o=>{const l=o.currentTarget;if(!h3(o)||am.has(l))return;am.add(l);const u=e(o),h=(y,v)=>{window.removeEventListener("pointerup",f),window.removeEventListener("pointercancel",g),!(!h3(y)||!am.has(l))&&(am.delete(l),typeof u=="function"&&u(y,{success:v}))},f=y=>{h(y,t.useGlobalTarget||_j(l,y.target))},g=y=>{h(y,!1)};window.addEventListener("pointerup",f,i),window.addEventListener("pointercancel",g,i)};return r.forEach(o=>{!une(o)&&o.getAttribute("tabindex")===null&&(o.tabIndex=0),(t.useGlobalTarget?window:o).addEventListener("pointerdown",a,i),o.addEventListener("focus",u=>hne(u,i),i)}),s}function fne(n){return n==="x"||n==="y"?Ba[n]?null:(Ba[n]=!0,()=>{Ba[n]=!1}):Ba.x||Ba.y?null:(Ba.x=Ba.y=!0,()=>{Ba.x=Ba.y=!1})}const xj=new Set(["width","height","top","left","right","bottom",...U0]);let $_;function gne(){$_=void 0}const zo={now:()=>($_===void 0&&zo.set(Si.isProcessing||cte.useManualTiming?Si.timestamp:performance.now()),$_),set:n=>{$_=n,queueMicrotask(gne)}};function sR(n,e){n.indexOf(e)===-1&&n.push(e)}function aR(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}class oR{constructor(){this.subscriptions=[]}add(e){return sR(this.subscriptions,e),()=>aR(this.subscriptions,e)}notify(e,t,r){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,t,r);else for(let s=0;s<i;s++){const a=this.subscriptions[s];a&&a(e,t,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function vj(n,e){return e?n*(1e3/e):0}const d3=30,mne=n=>!isNaN(parseFloat(n));class pne{constructor(e,t={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(r,i=!0)=>{const s=zo.now();this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),i&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=zo.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=mne(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new oR);const r=this.events[e].add(t);return e==="change"?()=>{r(),lr.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e,t=!0){!t||!this.passiveEffect?this.updateAndNotify(e,t):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,t,r){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=zo.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>d3)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,d3);return vj(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function wp(n,e){return new pne(n,e)}function yne(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,wp(t))}function _ne(n,e){const t=Mw(n,e);let{transitionEnd:r={},transition:i={},...s}=t||{};s={...s,...r};for(const a in s){const o=Pte(s[a]);yne(n,a,o)}}function xne(n){return!!(Hi(n)&&n.add)}function ob(n,e){const t=n.getValue("willChange");if(xne(t))return t.add(e)}function wj(n){return n.props[Z8]}const Ej=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,vne=1e-7,wne=12;function Ene(n,e,t,r,i){let s,a,o=0;do a=e+(t-e)/2,s=Ej(a,r,i)-n,s>0?t=a:e=a;while(Math.abs(s)>vne&&++o<wne);return a}function v1(n,e,t,r){if(n===e&&t===r)return Zs;const i=s=>Ene(s,0,1,n,t);return s=>s===0||s===1?s:Ej(i(s),e,r)}const Sj=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,Tj=n=>e=>1-n(1-e),bj=v1(.33,1.53,.69,.99),lR=Tj(bj),Ij=Sj(lR),Aj=n=>(n*=2)<1?.5*lR(n):.5*(2-Math.pow(2,-10*(n-1))),cR=n=>1-Math.sin(Math.acos(n)),Rj=Tj(cR),Cj=Sj(cR),Pj=n=>/^0[^.\s]+$/u.test(n);function Sne(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||Pj(n):!0}const Tm=n=>Math.round(n*1e5)/1e5,uR=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function Tne(n){return n==null}const bne=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,hR=(n,e)=>t=>!!(typeof t=="string"&&bne.test(t)&&t.startsWith(n)||e&&!Tne(t)&&Object.prototype.hasOwnProperty.call(t,e)),kj=(n,e,t)=>r=>{if(typeof r!="string")return r;const[i,s,a,o]=r.match(uR);return{[n]:parseFloat(i),[e]:parseFloat(s),[t]:parseFloat(a),alpha:o!==void 0?parseFloat(o):1}},Ine=n=>$l(0,255,n),xS={...z0,transform:n=>Math.round(Ine(n))},Eh={test:hR("rgb","red"),parse:kj("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:r=1})=>"rgba("+xS.transform(n)+", "+xS.transform(e)+", "+xS.transform(t)+", "+Tm(vp.transform(r))+")"};function Ane(n){let e="",t="",r="",i="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),r=n.substring(5,7),i=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),r=n.substring(3,4),i=n.substring(4,5),e+=e,t+=t,r+=r,i+=i),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}}const lb={test:hR("#"),parse:Ane,transform:Eh.transform},Nf={test:hR("hsl","hue"),parse:kj("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:r=1})=>"hsla("+Math.round(n)+", "+Uo.transform(Tm(e))+", "+Uo.transform(Tm(t))+", "+Tm(vp.transform(r))+")"},Bi={test:n=>Eh.test(n)||lb.test(n)||Nf.test(n),parse:n=>Eh.test(n)?Eh.parse(n):Nf.test(n)?Nf.parse(n):lb.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?Eh.transform(n):Nf.transform(n)},Rne=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function Cne(n){var e,t;return isNaN(n)&&typeof n=="string"&&(((e=n.match(uR))===null||e===void 0?void 0:e.length)||0)+(((t=n.match(Rne))===null||t===void 0?void 0:t.length)||0)>0}const Mj="number",Nj="color",Pne="var",kne="var(",f3="${}",Mne=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Ep(n){const e=n.toString(),t=[],r={color:[],number:[],var:[]},i=[];let s=0;const o=e.replace(Mne,l=>(Bi.test(l)?(r.color.push(s),i.push(Nj),t.push(Bi.parse(l))):l.startsWith(kne)?(r.var.push(s),i.push(Pne),t.push(l)):(r.number.push(s),i.push(Mj),t.push(parseFloat(l))),++s,f3)).split(f3);return{values:t,split:o,indexes:r,types:i}}function Lj(n){return Ep(n).values}function Oj(n){const{split:e,types:t}=Ep(n),r=e.length;return i=>{let s="";for(let a=0;a<r;a++)if(s+=e[a],i[a]!==void 0){const o=t[a];o===Mj?s+=Tm(i[a]):o===Nj?s+=Bi.transform(i[a]):s+=i[a]}return s}}const Nne=n=>typeof n=="number"?0:n;function Lne(n){const e=Lj(n);return Oj(n)(e.map(Nne))}const pu={test:Cne,parse:Lj,createTransformer:Oj,getAnimatableNone:Lne},One=new Set(["brightness","contrast","saturate","opacity"]);function Dne(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[r]=t.match(uR)||[];if(!r)return n;const i=t.replace(r,"");let s=One.has(e)?1:0;return r!==t&&(s*=100),e+"("+s+i+")"}const Fne=/\b([a-z-]*)\(.*?\)/gu,cb={...pu,getAnimatableNone:n=>{const e=n.match(Fne);return e?e.map(Dne).join(" "):n}},jne={...qA,color:Bi,backgroundColor:Bi,outlineColor:Bi,fill:Bi,stroke:Bi,borderColor:Bi,borderTopColor:Bi,borderRightColor:Bi,borderBottomColor:Bi,borderLeftColor:Bi,filter:cb,WebkitFilter:cb},dR=n=>jne[n];function Dj(n,e){let t=dR(n);return t!==cb&&(t=pu),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const Vne=new Set(["auto","none","0"]);function Gne(n,e,t){let r=0,i;for(;r<n.length&&!i;){const s=n[r];typeof s=="string"&&!Vne.has(s)&&Ep(s).values.length&&(i=n[r]),r++}if(i&&t)for(const s of e)n[s]=Dj(t,i)}const g3=n=>n===z0||n===Dt,m3=(n,e)=>parseFloat(n.split(", ")[e]),p3=(n,e)=>(t,{transform:r})=>{if(r==="none"||!r)return 0;const i=r.match(/^matrix3d\((.+)\)$/u);if(i)return m3(i[1],e);{const s=r.match(/^matrix\((.+)\)$/u);return s?m3(s[1],n):0}},Bne=new Set(["x","y","z"]),Une=U0.filter(n=>!Bne.has(n));function zne(n){const e=[];return Une.forEach(t=>{const r=n.getValue(t);r!==void 0&&(e.push([t,r.get()]),r.set(t.startsWith("scale")?1:0))}),e}const C0={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:p3(4,13),y:p3(5,14)};C0.translateX=C0.x;C0.translateY=C0.y;const kh=new Set;let ub=!1,hb=!1;function Fj(){if(hb){const n=Array.from(kh).filter(r=>r.needsMeasurement),e=new Set(n.map(r=>r.element)),t=new Map;e.forEach(r=>{const i=zne(r);i.length&&(t.set(r,i),r.render())}),n.forEach(r=>r.measureInitialState()),e.forEach(r=>{r.render();const i=t.get(r);i&&i.forEach(([s,a])=>{var o;(o=r.getValue(s))===null||o===void 0||o.set(a)})}),n.forEach(r=>r.measureEndState()),n.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}hb=!1,ub=!1,kh.forEach(n=>n.complete()),kh.clear()}function jj(){kh.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(hb=!0)})}function $ne(){jj(),Fj()}class fR{constructor(e,t,r,i,s,a=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=r,this.motionValue=i,this.element=s,this.isAsync=a}scheduleResolve(){this.isScheduled=!0,this.isAsync?(kh.add(this),ub||(ub=!0,lr.read(jj),lr.resolveKeyframes(Fj))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:r,motionValue:i}=this;for(let s=0;s<e.length;s++)if(e[s]===null)if(s===0){const a=i?.get(),o=e[e.length-1];if(a!==void 0)e[0]=a;else if(r&&t){const l=r.readValue(t,o);l!=null&&(e[0]=l)}e[0]===void 0&&(e[0]=o),i&&a===void 0&&i.set(e[0])}else e[s]=e[s-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),kh.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,kh.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const Vj=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n),Wne=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Hne(n){const e=Wne.exec(n);if(!e)return[,];const[,t,r,i]=e;return[`--${t??r}`,i]}function Gj(n,e,t=1){const[r,i]=Hne(n);if(!r)return;const s=window.getComputedStyle(e).getPropertyValue(r);if(s){const a=s.trim();return Vj(a)?parseFloat(a):a}return YA(i)?Gj(i,e,t+1):i}const Bj=n=>e=>e.test(n),Kne={test:n=>n==="auto",parse:n=>n},Uj=[z0,Dt,Uo,Oc,Dte,Ote,Kne],y3=n=>Uj.find(Bj(n));class zj extends fR{constructor(e,t,r,i,s){super(e,t,r,i,s,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:r}=this;if(!t||!t.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let u=e[l];if(typeof u=="string"&&(u=u.trim(),YA(u))){const h=Gj(u,t.current);h!==void 0&&(e[l]=h),l===e.length-1&&(this.finalKeyframe=u)}}if(this.resolveNoneKeyframes(),!xj.has(r)||e.length!==2)return;const[i,s]=e,a=y3(i),o=y3(s);if(a!==o)if(g3(a)&&g3(o))for(let l=0;l<e.length;l++){const u=e[l];typeof u=="string"&&(e[l]=parseFloat(u))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,r=[];for(let i=0;i<e.length;i++)Sne(e[i])&&r.push(i);r.length&&Gne(e,r,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:r}=this;if(!e||!e.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=C0[r](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const i=t[t.length-1];i!==void 0&&e.getValue(r,i).jump(i,!1)}measureEndState(){var e;const{element:t,name:r,unresolvedKeyframes:i}=this;if(!t||!t.current)return;const s=t.getValue(r);s&&s.jump(this.measuredOrigin,!1);const a=i.length-1,o=i[a];i[a]=C0[r](t.measureViewportBox(),window.getComputedStyle(t.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([l,u])=>{t.getValue(l).set(u)}),this.resolveNoneKeyframes()}}const _3=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(pu.test(n)||n==="0")&&!n.startsWith("url("));function Yne(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function qne(n,e,t,r){const i=n[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const s=n[n.length-1],a=_3(i,e),o=_3(s,e);return!a||!o?!1:Yne(n)||(t==="spring"||nR(t))&&r}const Xne=n=>n!==null;function Nw(n,{repeat:e,repeatType:t="loop"},r){const i=n.filter(Xne),s=e&&t!=="loop"&&e%2===1?0:i.length-1;return!s||r===void 0?i[s]:r}const Zne=40;class $j{constructor({autoplay:e=!0,delay:t=0,type:r="keyframes",repeat:i=0,repeatDelay:s=0,repeatType:a="loop",...o}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=zo.now(),this.options={autoplay:e,delay:t,type:r,repeat:i,repeatDelay:s,repeatType:a,...o},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>Zne?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&$ne(),this._resolved}onKeyframesResolved(e,t){this.resolvedAt=zo.now(),this.hasAttemptedResolve=!0;const{name:r,type:i,velocity:s,delay:a,onComplete:o,onUpdate:l,isGenerator:u}=this.options;if(!u&&!qne(e,r,i,s))if(a)this.options.duration=0;else{l&&l(Nw(e,this.options,t)),o&&o(),this.resolveFinishedPromise();return}const h=this.initPlayback(e,t);h!==!1&&(this._resolved={keyframes:e,finalKeyframe:t,...h},this.onPostResolved())}onPostResolved(){}then(e,t){return this.currentFinishedPromise.then(e,t)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const Er=(n,e,t)=>n+(e-n)*t;function vS(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function Qne({hue:n,saturation:e,lightness:t,alpha:r}){n/=360,e/=100,t/=100;let i=0,s=0,a=0;if(!e)i=s=a=t;else{const o=t<.5?t*(1+e):t+e-t*e,l=2*t-o;i=vS(l,o,n+1/3),s=vS(l,o,n),a=vS(l,o,n-1/3)}return{red:Math.round(i*255),green:Math.round(s*255),blue:Math.round(a*255),alpha:r}}function Xx(n,e){return t=>t>0?e:n}const wS=(n,e,t)=>{const r=n*n,i=t*(e*e-r)+r;return i<0?0:Math.sqrt(i)},Jne=[lb,Eh,Nf],ere=n=>Jne.find(e=>e.test(n));function x3(n){const e=ere(n);if(!e)return!1;let t=e.parse(n);return e===Nf&&(t=Qne(t)),t}const v3=(n,e)=>{const t=x3(n),r=x3(e);if(!t||!r)return Xx(n,e);const i={...t};return s=>(i.red=wS(t.red,r.red,s),i.green=wS(t.green,r.green,s),i.blue=wS(t.blue,r.blue,s),i.alpha=Er(t.alpha,r.alpha,s),Eh.transform(i))},tre=(n,e)=>t=>e(n(t)),w1=(...n)=>n.reduce(tre),db=new Set(["none","hidden"]);function nre(n,e){return db.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function rre(n,e){return t=>Er(n,e,t)}function gR(n){return typeof n=="number"?rre:typeof n=="string"?YA(n)?Xx:Bi.test(n)?v3:are:Array.isArray(n)?Wj:typeof n=="object"?Bi.test(n)?v3:ire:Xx}function Wj(n,e){const t=[...n],r=t.length,i=n.map((s,a)=>gR(s)(s,e[a]));return s=>{for(let a=0;a<r;a++)t[a]=i[a](s);return t}}function ire(n,e){const t={...n,...e},r={};for(const i in t)n[i]!==void 0&&e[i]!==void 0&&(r[i]=gR(n[i])(n[i],e[i]));return i=>{for(const s in r)t[s]=r[s](i);return t}}function sre(n,e){var t;const r=[],i={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const a=e.types[s],o=n.indexes[a][i[a]],l=(t=n.values[o])!==null&&t!==void 0?t:0;r[s]=l,i[a]++}return r}const are=(n,e)=>{const t=pu.createTransformer(e),r=Ep(n),i=Ep(e);return r.indexes.var.length===i.indexes.var.length&&r.indexes.color.length===i.indexes.color.length&&r.indexes.number.length>=i.indexes.number.length?db.has(n)&&!i.values.length||db.has(e)&&!r.values.length?nre(n,e):w1(Wj(sre(r,i),i.values),t):Xx(n,e)};function Hj(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?Er(n,e,t):gR(n)(n,e)}const ore=5;function Kj(n,e,t){const r=Math.max(e-ore,0);return vj(t-n(r),e-r)}const Ir={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},ES=.001;function lre({duration:n=Ir.duration,bounce:e=Ir.bounce,velocity:t=Ir.velocity,mass:r=Ir.mass}){let i,s,a=1-e;a=$l(Ir.minDamping,Ir.maxDamping,a),n=$l(Ir.minDuration,Ir.maxDuration,Ol(n)),a<1?(i=u=>{const h=u*a,f=h*n,g=h-t,y=fb(u,a),v=Math.exp(-f);return ES-g/y*v},s=u=>{const f=u*a*n,g=f*t+t,y=Math.pow(a,2)*Math.pow(u,2)*n,v=Math.exp(-f),x=fb(Math.pow(u,2),a);return(-i(u)+ES>0?-1:1)*((g-y)*v)/x}):(i=u=>{const h=Math.exp(-u*n),f=(u-t)*n+1;return-ES+h*f},s=u=>{const h=Math.exp(-u*n),f=(t-u)*(n*n);return h*f});const o=5/n,l=ure(i,s,o);if(n=Ll(n),isNaN(l))return{stiffness:Ir.stiffness,damping:Ir.damping,duration:n};{const u=Math.pow(l,2)*r;return{stiffness:u,damping:a*2*Math.sqrt(r*u),duration:n}}}const cre=12;function ure(n,e,t){let r=t;for(let i=1;i<cre;i++)r=r-n(r)/e(r);return r}function fb(n,e){return n*Math.sqrt(1-e*e)}const hre=["duration","bounce"],dre=["stiffness","damping","mass"];function w3(n,e){return e.some(t=>n[t]!==void 0)}function fre(n){let e={velocity:Ir.velocity,stiffness:Ir.stiffness,damping:Ir.damping,mass:Ir.mass,isResolvedFromDuration:!1,...n};if(!w3(n,dre)&&w3(n,hre))if(n.visualDuration){const t=n.visualDuration,r=2*Math.PI/(t*1.2),i=r*r,s=2*$l(.05,1,1-(n.bounce||0))*Math.sqrt(i);e={...e,mass:Ir.mass,stiffness:i,damping:s}}else{const t=lre(n);e={...e,...t,mass:Ir.mass},e.isResolvedFromDuration=!0}return e}function Yj(n=Ir.visualDuration,e=Ir.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:r,restDelta:i}=t;const s=t.keyframes[0],a=t.keyframes[t.keyframes.length-1],o={done:!1,value:s},{stiffness:l,damping:u,mass:h,duration:f,velocity:g,isResolvedFromDuration:y}=fre({...t,velocity:-Ol(t.velocity||0)}),v=g||0,x=u/(2*Math.sqrt(l*h)),E=a-s,T=Ol(Math.sqrt(l/h)),b=Math.abs(E)<5;r||(r=b?Ir.restSpeed.granular:Ir.restSpeed.default),i||(i=b?Ir.restDelta.granular:Ir.restDelta.default);let I;if(x<1){const F=fb(T,x);I=z=>{const k=Math.exp(-x*T*z);return a-k*((v+x*T*E)/F*Math.sin(F*z)+E*Math.cos(F*z))}}else if(x===1)I=F=>a-Math.exp(-T*F)*(E+(v+T*E)*F);else{const F=T*Math.sqrt(x*x-1);I=z=>{const k=Math.exp(-x*T*z),C=Math.min(F*z,300);return a-k*((v+x*T*E)*Math.sinh(C)+F*E*Math.cosh(C))/F}}const M={calculatedDuration:y&&f||null,next:F=>{const z=I(F);if(y)o.done=F>=f;else{let k=0;x<1&&(k=F===0?Ll(v):Kj(I,F,z));const C=Math.abs(k)<=r,P=Math.abs(a-z)<=i;o.done=C&&P}return o.value=o.done?a:z,o},toString:()=>{const F=Math.min(dj(M),sb),z=fj(k=>M.next(F*k).value,F,30);return F+"ms "+z}};return M}function E3({keyframes:n,velocity:e=0,power:t=.8,timeConstant:r=325,bounceDamping:i=10,bounceStiffness:s=500,modifyTarget:a,min:o,max:l,restDelta:u=.5,restSpeed:h}){const f=n[0],g={done:!1,value:f},y=C=>o!==void 0&&C<o||l!==void 0&&C>l,v=C=>o===void 0?l:l===void 0||Math.abs(o-C)<Math.abs(l-C)?o:l;let x=t*e;const E=f+x,T=a===void 0?E:a(E);T!==E&&(x=T-f);const b=C=>-x*Math.exp(-C/r),I=C=>T+b(C),M=C=>{const P=b(C),L=I(C);g.done=Math.abs(P)<=u,g.value=g.done?T:L};let F,z;const k=C=>{y(g.value)&&(F=C,z=Yj({keyframes:[g.value,v(g.value)],velocity:Kj(I,C,g.value),damping:i,stiffness:s,restDelta:u,restSpeed:h}))};return k(0),{calculatedDuration:null,next:C=>{let P=!1;return!z&&F===void 0&&(P=!0,M(C),k(C)),F!==void 0&&C>=F?z.next(C-F):(!P&&M(C),g)}}}const gre=v1(.42,0,1,1),mre=v1(0,0,.58,1),qj=v1(.42,0,.58,1),pre=n=>Array.isArray(n)&&typeof n[0]!="number",yre={linear:Zs,easeIn:gre,easeInOut:qj,easeOut:mre,circIn:cR,circInOut:Cj,circOut:Rj,backIn:lR,backInOut:Ij,backOut:bj,anticipate:Aj},S3=n=>{if(rR(n)){H8(n.length===4);const[e,t,r,i]=n;return v1(e,t,r,i)}else if(typeof n=="string")return yre[n];return n};function _re(n,e,t){const r=[],i=t||Hj,s=n.length-1;for(let a=0;a<s;a++){let o=i(n[a],n[a+1]);if(e){const l=Array.isArray(e)?e[a]||Zs:e;o=w1(l,o)}r.push(o)}return r}function xre(n,e,{clamp:t=!0,ease:r,mixer:i}={}){const s=n.length;if(H8(s===e.length),s===1)return()=>e[0];if(s===2&&e[0]===e[1])return()=>e[1];const a=n[0]===n[1];n[0]>n[s-1]&&(n=[...n].reverse(),e=[...e].reverse());const o=_re(e,r,i),l=o.length,u=h=>{if(a&&h<n[0])return e[0];let f=0;if(l>1)for(;f<n.length-2&&!(h<n[f+1]);f++);const g=A0(n[f],n[f+1],h);return o[f](g)};return t?h=>u($l(n[0],n[s-1],h)):u}function vre(n,e){const t=n[n.length-1];for(let r=1;r<=e;r++){const i=A0(0,e,r);n.push(Er(t,1,i))}}function wre(n){const e=[0];return vre(e,n.length-1),e}function Ere(n,e){return n.map(t=>t*e)}function Sre(n,e){return n.map(()=>e||qj).splice(0,n.length-1)}function Zx({duration:n=300,keyframes:e,times:t,ease:r="easeInOut"}){const i=pre(r)?r.map(S3):S3(r),s={done:!1,value:e[0]},a=Ere(t&&t.length===e.length?t:wre(e),n),o=xre(a,e,{ease:Array.isArray(i)?i:Sre(e,i)});return{calculatedDuration:n,next:l=>(s.value=o(l),s.done=l>=n,s)}}const Tre=n=>{const e=({timestamp:t})=>n(t);return{start:()=>lr.update(e,!0),stop:()=>mu(e),now:()=>Si.isProcessing?Si.timestamp:zo.now()}},bre={decay:E3,inertia:E3,tween:Zx,keyframes:Zx,spring:Yj},Ire=n=>n/100;class mR extends $j{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:l}=this.options;l&&l()};const{name:t,motionValue:r,element:i,keyframes:s}=this.options,a=i?.KeyframeResolver||fR,o=(l,u)=>this.onKeyframesResolved(l,u);this.resolver=new a(s,o,t,r,i),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:t="keyframes",repeat:r=0,repeatDelay:i=0,repeatType:s,velocity:a=0}=this.options,o=nR(t)?t:bre[t]||Zx;let l,u;o!==Zx&&typeof e[0]!="number"&&(l=w1(Ire,Hj(e[0],e[1])),e=[0,100]);const h=o({...this.options,keyframes:e});s==="mirror"&&(u=o({...this.options,keyframes:[...e].reverse(),velocity:-a})),h.calculatedDuration===null&&(h.calculatedDuration=dj(h));const{calculatedDuration:f}=h,g=f+i,y=g*(r+1)-i;return{generator:h,mirroredGenerator:u,mapPercentToKeyframes:l,calculatedDuration:f,resolvedDuration:g,totalDuration:y}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,t=!1){const{resolved:r}=this;if(!r){const{keyframes:C}=this.options;return{done:!0,value:C[C.length-1]}}const{finalKeyframe:i,generator:s,mirroredGenerator:a,mapPercentToKeyframes:o,keyframes:l,calculatedDuration:u,totalDuration:h,resolvedDuration:f}=r;if(this.startTime===null)return s.next(0);const{delay:g,repeat:y,repeatType:v,repeatDelay:x,onUpdate:E}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-h/this.speed,this.startTime)),t?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const T=this.currentTime-g*(this.speed>=0?1:-1),b=this.speed>=0?T<0:T>h;this.currentTime=Math.max(T,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=h);let I=this.currentTime,M=s;if(y){const C=Math.min(this.currentTime,h)/f;let P=Math.floor(C),L=C%1;!L&&C>=1&&(L=1),L===1&&P--,P=Math.min(P,y+1),P%2&&(v==="reverse"?(L=1-L,x&&(L-=x/f)):v==="mirror"&&(M=a)),I=$l(0,1,L)*f}const F=b?{done:!1,value:l[0]}:M.next(I);o&&(F.value=o(F.value));let{done:z}=F;!b&&u!==null&&(z=this.speed>=0?this.currentTime>=h:this.currentTime<=0);const k=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&z);return k&&i!==void 0&&(F.value=Nw(l,this.options,i)),E&&E(F.value),k&&this.finish(),F}get duration(){const{resolved:e}=this;return e?Ol(e.calculatedDuration):0}get time(){return Ol(this.currentTime)}set time(e){e=Ll(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=Ol(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=Tre,onPlay:t,startTime:r}=this.options;this.driver||(this.driver=e(s=>this.tick(s))),t&&t();const i=this.driver.now();this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=i):this.startTime=r??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const Are=new Set(["opacity","clipPath","filter","transform"]);function Rre(n,e,t,{delay:r=0,duration:i=300,repeat:s=0,repeatType:a="loop",ease:o="easeInOut",times:l}={}){const u={[e]:t};l&&(u.offset=l);const h=mj(o,i);return Array.isArray(h)&&(u.easing=h),n.animate(u,{delay:r,duration:i,easing:Array.isArray(h)?"linear":h,fill:"both",iterations:s+1,direction:a==="reverse"?"alternate":"normal"})}const Cre=BA(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Qx=10,Pre=2e4;function kre(n){return nR(n.type)||n.type==="spring"||!gj(n.ease)}function Mre(n,e){const t=new mR({...e,keyframes:n,repeat:0,delay:0,isGenerator:!0});let r={done:!1,value:n[0]};const i=[];let s=0;for(;!r.done&&s<Pre;)r=t.sample(s),i.push(r.value),s+=Qx;return{times:void 0,keyframes:i,duration:s-Qx,ease:"linear"}}const Xj={anticipate:Aj,backInOut:Ij,circInOut:Cj};function Nre(n){return n in Xj}class T3 extends $j{constructor(e){super(e);const{name:t,motionValue:r,element:i,keyframes:s}=this.options;this.resolver=new zj(s,(a,o)=>this.onKeyframesResolved(a,o),t,r,i),this.resolver.scheduleResolve()}initPlayback(e,t){let{duration:r=300,times:i,ease:s,type:a,motionValue:o,name:l,startTime:u}=this.options;if(!o.owner||!o.owner.current)return!1;if(typeof s=="string"&&qx()&&Nre(s)&&(s=Xj[s]),kre(this.options)){const{onComplete:f,onUpdate:g,motionValue:y,element:v,...x}=this.options,E=Mre(e,x);e=E.keyframes,e.length===1&&(e[1]=e[0]),r=E.duration,i=E.times,s=E.ease,a="keyframes"}const h=Rre(o.owner.current,l,e,{...this.options,duration:r,times:i,ease:s});return h.startTime=u??this.calcStartTime(),this.pendingTimeline?(l3(h,this.pendingTimeline),this.pendingTimeline=void 0):h.onfinish=()=>{const{onComplete:f}=this.options;o.set(Nw(e,this.options,t)),f&&f(),this.cancel(),this.resolveFinishedPromise()},{animation:h,duration:r,times:i,type:a,ease:s,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:t}=e;return Ol(t)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:t}=e;return Ol(t.currentTime||0)}set time(e){const{resolved:t}=this;if(!t)return;const{animation:r}=t;r.currentTime=Ll(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:t}=e;return t.playbackRate}set speed(e){const{resolved:t}=this;if(!t)return;const{animation:r}=t;r.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:t}=e;return t.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:t}=e;return t.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:t}=this;if(!t)return Zs;const{animation:r}=t;l3(r,e)}return Zs}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.playState==="finished"&&this.updateFinishedPromise(),t.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:t,keyframes:r,duration:i,type:s,ease:a,times:o}=e;if(t.playState==="idle"||t.playState==="finished")return;if(this.time){const{motionValue:u,onUpdate:h,onComplete:f,element:g,...y}=this.options,v=new mR({...y,keyframes:r,duration:i,type:s,ease:a,times:o,isGenerator:!0}),x=Ll(this.time);u.setWithVelocity(v.sample(x-Qx).value,v.sample(x).value,Qx)}const{onStop:l}=this.options;l&&l(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:t,name:r,repeatDelay:i,repeatType:s,damping:a,type:o}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:u}=t.owner.getProps();return Cre()&&r&&Are.has(r)&&!l&&!u&&!i&&s!=="mirror"&&a!==0&&o!=="inertia"}}const Lre={type:"spring",stiffness:500,damping:25,restSpeed:10},Ore=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),Dre={type:"keyframes",duration:.8},Fre={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},jre=(n,{keyframes:e})=>e.length>2?Dre:md.has(n)?n.startsWith("scale")?Ore(e[1]):Lre:Fre;function Vre({when:n,delay:e,delayChildren:t,staggerChildren:r,staggerDirection:i,repeat:s,repeatType:a,repeatDelay:o,from:l,elapsed:u,...h}){return!!Object.keys(h).length}const pR=(n,e,t,r={},i,s)=>a=>{const o=tR(r,n)||{},l=o.delay||r.delay||0;let{elapsed:u=0}=r;u=u-Ll(l);let h={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...o,delay:-u,onUpdate:g=>{e.set(g),o.onUpdate&&o.onUpdate(g)},onComplete:()=>{a(),o.onComplete&&o.onComplete()},name:n,motionValue:e,element:s?void 0:i};Vre(o)||(h={...h,...jre(n,h)}),h.duration&&(h.duration=Ll(h.duration)),h.repeatDelay&&(h.repeatDelay=Ll(h.repeatDelay)),h.from!==void 0&&(h.keyframes[0]=h.from);let f=!1;if((h.type===!1||h.duration===0&&!h.repeatDelay)&&(h.duration=0,h.delay===0&&(f=!0)),f&&!s&&e.get()!==void 0){const g=Nw(h.keyframes,o);if(g!==void 0)return lr.update(()=>{h.onUpdate(g),h.onComplete()}),new ine([])}return!s&&T3.supports(h)?new T3(h):new mR(h)};function Gre({protectedKeys:n,needsAnimating:e},t){const r=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,r}function Zj(n,e,{delay:t=0,transitionOverride:r,type:i}={}){var s;let{transition:a=n.getDefaultTransition(),transitionEnd:o,...l}=e;r&&(a=r);const u=[],h=i&&n.animationState&&n.animationState.getState()[i];for(const f in l){const g=n.getValue(f,(s=n.latestValues[f])!==null&&s!==void 0?s:null),y=l[f];if(y===void 0||h&&Gre(h,f))continue;const v={delay:t,...tR(a||{},f)};let x=!1;if(window.MotionHandoffAnimation){const T=wj(n);if(T){const b=window.MotionHandoffAnimation(T,f,lr);b!==null&&(v.startTime=b,x=!0)}}ob(n,f),g.start(pR(f,g,y,n.shouldReduceMotion&&xj.has(f)?{type:!1}:v,n,x));const E=g.animation;E&&u.push(E)}return o&&Promise.all(u).then(()=>{lr.update(()=>{o&&_ne(n,o)})}),u}function gb(n,e,t={}){var r;const i=Mw(n,e,t.type==="exit"?(r=n.presenceContext)===null||r===void 0?void 0:r.custom:void 0);let{transition:s=n.getDefaultTransition()||{}}=i||{};t.transitionOverride&&(s=t.transitionOverride);const a=i?()=>Promise.all(Zj(n,i,t)):()=>Promise.resolve(),o=n.variantChildren&&n.variantChildren.size?(u=0)=>{const{delayChildren:h=0,staggerChildren:f,staggerDirection:g}=s;return Bre(n,e,h+u,f,g,t)}:()=>Promise.resolve(),{when:l}=s;if(l){const[u,h]=l==="beforeChildren"?[a,o]:[o,a];return u().then(()=>h())}else return Promise.all([a(),o(t.delay)])}function Bre(n,e,t=0,r=0,i=1,s){const a=[],o=(n.variantChildren.size-1)*r,l=i===1?(u=0)=>u*r:(u=0)=>o-u*r;return Array.from(n.variantChildren).sort(Ure).forEach((u,h)=>{u.notify("AnimationStart",e),a.push(gb(u,e,{...s,delay:t+l(h)}).then(()=>u.notify("AnimationComplete",e)))}),Promise.all(a)}function Ure(n,e){return n.sortNodePosition(e)}function zre(n,e,t={}){n.notify("AnimationStart",e);let r;if(Array.isArray(e)){const i=e.map(s=>gb(n,s,t));r=Promise.all(i)}else if(typeof e=="string")r=gb(n,e,t);else{const i=typeof e=="function"?Mw(n,e,t.custom):e;r=Promise.all(Zj(n,i,t))}return r.then(()=>{n.notify("AnimationComplete",e)})}const $re=zA.length;function Qj(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?Qj(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<$re;t++){const r=zA[t],i=n.props[r];(xp(i)||i===!1)&&(e[r]=i)}return e}const Wre=[...UA].reverse(),Hre=UA.length;function Kre(n){return e=>Promise.all(e.map(({animation:t,options:r})=>zre(n,t,r)))}function Yre(n){let e=Kre(n),t=b3(),r=!0;const i=l=>(u,h)=>{var f;const g=Mw(n,h,l==="exit"?(f=n.presenceContext)===null||f===void 0?void 0:f.custom:void 0);if(g){const{transition:y,transitionEnd:v,...x}=g;u={...u,...x,...v}}return u};function s(l){e=l(n)}function a(l){const{props:u}=n,h=Qj(n.parent)||{},f=[],g=new Set;let y={},v=1/0;for(let E=0;E<Hre;E++){const T=Wre[E],b=t[T],I=u[T]!==void 0?u[T]:h[T],M=xp(I),F=T===l?b.isActive:null;F===!1&&(v=E);let z=I===h[T]&&I!==u[T]&&M;if(z&&r&&n.manuallyAnimateOnMount&&(z=!1),b.protectedKeys={...y},!b.isActive&&F===null||!I&&!b.prevProp||Pw(I)||typeof I=="boolean")continue;const k=qre(b.prevProp,I);let C=k||T===l&&b.isActive&&!z&&M||E>v&&M,P=!1;const L=Array.isArray(I)?I:[I];let O=L.reduce(i(T),{});F===!1&&(O={});const{prevResolvedValues:U={}}=b,j={...U,...O},Ie=Ne=>{C=!0,g.has(Ne)&&(P=!0,g.delete(Ne)),b.needsAnimating[Ne]=!0;const ce=n.getValue(Ne);ce&&(ce.liveStyle=!1)};for(const Ne in j){const ce=O[Ne],Te=U[Ne];if(y.hasOwnProperty(Ne))continue;let Ee=!1;ib(ce)&&ib(Te)?Ee=!hj(ce,Te):Ee=ce!==Te,Ee?ce!=null?Ie(Ne):g.add(Ne):ce!==void 0&&g.has(Ne)?Ie(Ne):b.protectedKeys[Ne]=!0}b.prevProp=I,b.prevResolvedValues=O,b.isActive&&(y={...y,...O}),r&&n.blockInitialAnimation&&(C=!1),C&&(!(z&&k)||P)&&f.push(...L.map(Ne=>({animation:Ne,options:{type:T}})))}if(g.size){const E={};g.forEach(T=>{const b=n.getBaseTarget(T),I=n.getValue(T);I&&(I.liveStyle=!0),E[T]=b??null}),f.push({animation:E})}let x=!!f.length;return r&&(u.initial===!1||u.initial===u.animate)&&!n.manuallyAnimateOnMount&&(x=!1),r=!1,x?e(f):Promise.resolve()}function o(l,u){var h;if(t[l].isActive===u)return Promise.resolve();(h=n.variantChildren)===null||h===void 0||h.forEach(g=>{var y;return(y=g.animationState)===null||y===void 0?void 0:y.setActive(l,u)}),t[l].isActive=u;const f=a(l);for(const g in t)t[g].protectedKeys={};return f}return{animateChanges:a,setActive:o,setAnimateFunction:s,getState:()=>t,reset:()=>{t=b3(),r=!0}}}function qre(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!hj(e,n):!1}function eh(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function b3(){return{animate:eh(!0),whileInView:eh(),whileHover:eh(),whileTap:eh(),whileDrag:eh(),whileFocus:eh(),exit:eh()}}class Au{constructor(e){this.isMounted=!1,this.node=e}update(){}}class Xre extends Au{constructor(e){super(e),e.animationState||(e.animationState=Yre(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();Pw(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let Zre=0;class Qre extends Au{constructor(){super(...arguments),this.id=Zre++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const i=this.node.animationState.setActive("exit",!e);t&&!e&&i.then(()=>t(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const Jre={animation:{Feature:Xre},exit:{Feature:Qre}};function Sp(n,e,t,r={passive:!0}){return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t)}function E1(n){return{point:{x:n.pageX,y:n.pageY}}}const eie=n=>e=>iR(e)&&n(e,E1(e));function bm(n,e,t,r){return Sp(n,e,eie(t),r)}const I3=(n,e)=>Math.abs(n-e);function tie(n,e){const t=I3(n.x,e.x),r=I3(n.y,e.y);return Math.sqrt(t**2+r**2)}class Jj{constructor(e,t,{transformPagePoint:r,contextWindow:i,dragSnapToOrigin:s=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const f=TS(this.lastMoveEventInfo,this.history),g=this.startEvent!==null,y=tie(f.offset,{x:0,y:0})>=3;if(!g&&!y)return;const{point:v}=f,{timestamp:x}=Si;this.history.push({...v,timestamp:x});const{onStart:E,onMove:T}=this.handlers;g||(E&&E(this.lastMoveEvent,f),this.startEvent=this.lastMoveEvent),T&&T(this.lastMoveEvent,f)},this.handlePointerMove=(f,g)=>{this.lastMoveEvent=f,this.lastMoveEventInfo=SS(g,this.transformPagePoint),lr.update(this.updatePoint,!0)},this.handlePointerUp=(f,g)=>{this.end();const{onEnd:y,onSessionEnd:v,resumeAnimation:x}=this.handlers;if(this.dragSnapToOrigin&&x&&x(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const E=TS(f.type==="pointercancel"?this.lastMoveEventInfo:SS(g,this.transformPagePoint),this.history);this.startEvent&&y&&y(f,E),v&&v(f,E)},!iR(e))return;this.dragSnapToOrigin=s,this.handlers=t,this.transformPagePoint=r,this.contextWindow=i||window;const a=E1(e),o=SS(a,this.transformPagePoint),{point:l}=o,{timestamp:u}=Si;this.history=[{...l,timestamp:u}];const{onSessionStart:h}=t;h&&h(e,TS(o,this.history)),this.removeListeners=w1(bm(this.contextWindow,"pointermove",this.handlePointerMove),bm(this.contextWindow,"pointerup",this.handlePointerUp),bm(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),mu(this.updatePoint)}}function SS(n,e){return e?{point:e(n.point)}:n}function A3(n,e){return{x:n.x-e.x,y:n.y-e.y}}function TS({point:n},e){return{point:n,delta:A3(n,e9(e)),offset:A3(n,nie(e)),velocity:rie(e,.1)}}function nie(n){return n[0]}function e9(n){return n[n.length-1]}function rie(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,r=null;const i=e9(n);for(;t>=0&&(r=n[t],!(i.timestamp-r.timestamp>Ll(e)));)t--;if(!r)return{x:0,y:0};const s=Ol(i.timestamp-r.timestamp);if(s===0)return{x:0,y:0};const a={x:(i.x-r.x)/s,y:(i.y-r.y)/s};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}const t9=1e-4,iie=1-t9,sie=1+t9,n9=.01,aie=0-n9,oie=0+n9;function na(n){return n.max-n.min}function lie(n,e,t){return Math.abs(n-e)<=t}function R3(n,e,t,r=.5){n.origin=r,n.originPoint=Er(e.min,e.max,n.origin),n.scale=na(t)/na(e),n.translate=Er(t.min,t.max,n.origin)-n.originPoint,(n.scale>=iie&&n.scale<=sie||isNaN(n.scale))&&(n.scale=1),(n.translate>=aie&&n.translate<=oie||isNaN(n.translate))&&(n.translate=0)}function Im(n,e,t,r){R3(n.x,e.x,t.x,r?r.originX:void 0),R3(n.y,e.y,t.y,r?r.originY:void 0)}function C3(n,e,t){n.min=t.min+e.min,n.max=n.min+na(e)}function cie(n,e,t){C3(n.x,e.x,t.x),C3(n.y,e.y,t.y)}function P3(n,e,t){n.min=e.min-t.min,n.max=n.min+na(e)}function Am(n,e,t){P3(n.x,e.x,t.x),P3(n.y,e.y,t.y)}function uie(n,{min:e,max:t},r){return e!==void 0&&n<e?n=r?Er(e,n,r.min):Math.max(n,e):t!==void 0&&n>t&&(n=r?Er(t,n,r.max):Math.min(n,t)),n}function k3(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function hie(n,{top:e,left:t,bottom:r,right:i}){return{x:k3(n.x,t,i),y:k3(n.y,e,r)}}function M3(n,e){let t=e.min-n.min,r=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,r]=[r,t]),{min:t,max:r}}function die(n,e){return{x:M3(n.x,e.x),y:M3(n.y,e.y)}}function fie(n,e){let t=.5;const r=na(n),i=na(e);return i>r?t=A0(e.min,e.max-r,n.min):r>i&&(t=A0(n.min,n.max-i,e.min)),$l(0,1,t)}function gie(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const mb=.35;function mie(n=mb){return n===!1?n=0:n===!0&&(n=mb),{x:N3(n,"left","right"),y:N3(n,"top","bottom")}}function N3(n,e,t){return{min:L3(n,e),max:L3(n,t)}}function L3(n,e){return typeof n=="number"?n:n[e]||0}const O3=()=>({translate:0,scale:1,origin:0,originPoint:0}),Lf=()=>({x:O3(),y:O3()}),D3=()=>({min:0,max:0}),Nr=()=>({x:D3(),y:D3()});function ma(n){return[n("x"),n("y")]}function r9({top:n,left:e,right:t,bottom:r}){return{x:{min:e,max:t},y:{min:n,max:r}}}function pie({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function yie(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),r=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:r.y,right:r.x}}function bS(n){return n===void 0||n===1}function pb({scale:n,scaleX:e,scaleY:t}){return!bS(n)||!bS(e)||!bS(t)}function oh(n){return pb(n)||i9(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function i9(n){return F3(n.x)||F3(n.y)}function F3(n){return n&&n!=="0%"}function Jx(n,e,t){const r=n-t,i=e*r;return t+i}function j3(n,e,t,r,i){return i!==void 0&&(n=Jx(n,i,r)),Jx(n,t,r)+e}function yb(n,e=0,t=1,r,i){n.min=j3(n.min,e,t,r,i),n.max=j3(n.max,e,t,r,i)}function s9(n,{x:e,y:t}){yb(n.x,e.translate,e.scale,e.originPoint),yb(n.y,t.translate,t.scale,t.originPoint)}const V3=.999999999999,G3=1.0000000000001;function _ie(n,e,t,r=!1){const i=t.length;if(!i)return;e.x=e.y=1;let s,a;for(let o=0;o<i;o++){s=t[o],a=s.projectionDelta;const{visualElement:l}=s.options;l&&l.props.style&&l.props.style.display==="contents"||(r&&s.options.layoutScroll&&s.scroll&&s!==s.root&&Df(n,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),a&&(e.x*=a.x.scale,e.y*=a.y.scale,s9(n,a)),r&&oh(s.latestValues)&&Df(n,s.latestValues))}e.x<G3&&e.x>V3&&(e.x=1),e.y<G3&&e.y>V3&&(e.y=1)}function Of(n,e){n.min=n.min+e,n.max=n.max+e}function B3(n,e,t,r,i=.5){const s=Er(n.min,n.max,i);yb(n,e,t,s,r)}function Df(n,e){B3(n.x,e.x,e.scaleX,e.scale,e.originX),B3(n.y,e.y,e.scaleY,e.scale,e.originY)}function a9(n,e){return r9(yie(n.getBoundingClientRect(),e))}function xie(n,e,t){const r=a9(n,t),{scroll:i}=e;return i&&(Of(r.x,i.offset.x),Of(r.y,i.offset.y)),r}const o9=({current:n})=>n?n.ownerDocument.defaultView:null,vie=new WeakMap;class wie{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Nr(),this.visualElement=e}start(e,{snapToCursor:t=!1}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const i=h=>{const{dragSnapToOrigin:f}=this.getProps();f?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(E1(h).point)},s=(h,f)=>{const{drag:g,dragPropagation:y,onDragStart:v}=this.getProps();if(g&&!y&&(this.openDragLock&&this.openDragLock(),this.openDragLock=fne(g),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),ma(E=>{let T=this.getAxisMotionValue(E).get()||0;if(Uo.test(T)){const{projection:b}=this.visualElement;if(b&&b.layout){const I=b.layout.layoutBox[E];I&&(T=na(I)*(parseFloat(T)/100))}}this.originPoint[E]=T}),v&&lr.postRender(()=>v(h,f)),ob(this.visualElement,"transform");const{animationState:x}=this.visualElement;x&&x.setActive("whileDrag",!0)},a=(h,f)=>{const{dragPropagation:g,dragDirectionLock:y,onDirectionLock:v,onDrag:x}=this.getProps();if(!g&&!this.openDragLock)return;const{offset:E}=f;if(y&&this.currentDirection===null){this.currentDirection=Eie(E),this.currentDirection!==null&&v&&v(this.currentDirection);return}this.updateAxis("x",f.point,E),this.updateAxis("y",f.point,E),this.visualElement.render(),x&&x(h,f)},o=(h,f)=>this.stop(h,f),l=()=>ma(h=>{var f;return this.getAnimationState(h)==="paused"&&((f=this.getAxisMotionValue(h).animation)===null||f===void 0?void 0:f.play())}),{dragSnapToOrigin:u}=this.getProps();this.panSession=new Jj(e,{onSessionStart:i,onStart:s,onMove:a,onSessionEnd:o,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,contextWindow:o9(this.visualElement)})}stop(e,t){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:i}=t;this.startAnimation(i);const{onDragEnd:s}=this.getProps();s&&lr.postRender(()=>s(e,t))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,r){const{drag:i}=this.getProps();if(!r||!l_(e,i,this.currentDirection))return;const s=this.getAxisMotionValue(e);let a=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(a=uie(a,this.constraints[e],this.elastic[e])),s.set(a)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:r}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,s=this.constraints;t&&Mf(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&i?this.constraints=hie(i.layoutBox,t):this.constraints=!1,this.elastic=mie(r),s!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&ma(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=gie(i.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!Mf(e))return!1;const r=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const s=xie(r,i.root,this.visualElement.getTransformPagePoint());let a=die(i.layout.layoutBox,s);if(t){const o=t(pie(a));this.hasMutatedConstraints=!!o,o&&(a=r9(o))}return a}startAnimation(e){const{drag:t,dragMomentum:r,dragElastic:i,dragTransition:s,dragSnapToOrigin:a,onDragTransitionEnd:o}=this.getProps(),l=this.constraints||{},u=ma(h=>{if(!l_(h,t,this.currentDirection))return;let f=l&&l[h]||{};a&&(f={min:0,max:0});const g=i?200:1e6,y=i?40:1e7,v={type:"inertia",velocity:r?e[h]:0,bounceStiffness:g,bounceDamping:y,timeConstant:750,restDelta:1,restSpeed:10,...s,...f};return this.startAxisValueAnimation(h,v)});return Promise.all(u).then(o)}startAxisValueAnimation(e,t){const r=this.getAxisMotionValue(e);return ob(this.visualElement,e),r.start(pR(e,r,0,t,this.visualElement,!1))}stopAnimation(){ma(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){ma(e=>{var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.pause()})}getAnimationState(e){var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,r=this.visualElement.getProps(),i=r[t];return i||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){ma(t=>{const{drag:r}=this.getProps();if(!l_(t,r,this.currentDirection))return;const{projection:i}=this.visualElement,s=this.getAxisMotionValue(t);if(i&&i.layout){const{min:a,max:o}=i.layout.layoutBox[t];s.set(e[t]-Er(a,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:r}=this.visualElement;if(!Mf(t)||!r||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};ma(a=>{const o=this.getAxisMotionValue(a);if(o&&this.constraints!==!1){const l=o.get();i[a]=fie({min:l,max:l},this.constraints[a])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),ma(a=>{if(!l_(a,e,null))return;const o=this.getAxisMotionValue(a),{min:l,max:u}=this.constraints[a];o.set(Er(l,u,i[a]))})}addListeners(){if(!this.visualElement.current)return;vie.set(this.visualElement,this);const e=this.visualElement.current,t=bm(e,"pointerdown",l=>{const{drag:u,dragListener:h=!0}=this.getProps();u&&h&&this.start(l)}),r=()=>{const{dragConstraints:l}=this.getProps();Mf(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,s=i.addEventListener("measure",r);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),lr.read(r);const a=Sp(window,"resize",()=>this.scalePositionWithinConstraints()),o=i.addEventListener("didUpdate",(({delta:l,hasLayoutChanged:u})=>{this.isDragging&&u&&(ma(h=>{const f=this.getAxisMotionValue(h);f&&(this.originPoint[h]+=l[h].translate,f.set(f.get()+l[h].translate))}),this.visualElement.render())}));return()=>{a(),t(),s(),o&&o()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:r=!1,dragPropagation:i=!1,dragConstraints:s=!1,dragElastic:a=mb,dragMomentum:o=!0}=e;return{...e,drag:t,dragDirectionLock:r,dragPropagation:i,dragConstraints:s,dragElastic:a,dragMomentum:o}}}function l_(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function Eie(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class Sie extends Au{constructor(e){super(e),this.removeGroupControls=Zs,this.removeListeners=Zs,this.controls=new wie(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Zs}unmount(){this.removeGroupControls(),this.removeListeners()}}const U3=n=>(e,t)=>{n&&lr.postRender(()=>n(e,t))};class Tie extends Au{constructor(){super(...arguments),this.removePointerDownListener=Zs}onPointerDown(e){this.session=new Jj(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:o9(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:r,onPanEnd:i}=this.node.getProps();return{onSessionStart:U3(e),onStart:U3(t),onMove:r,onEnd:(s,a)=>{delete this.session,i&&lr.postRender(()=>i(s,a))}}}mount(){this.removePointerDownListener=bm(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const W_={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function z3(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const Wg={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(Dt.test(n))n=parseFloat(n);else return n;const t=z3(n,e.target.x),r=z3(n,e.target.y);return`${t}% ${r}%`}},bie={correct:(n,{treeScale:e,projectionDelta:t})=>{const r=n,i=pu.parse(n);if(i.length>5)return r;const s=pu.createTransformer(n),a=typeof i[0]!="number"?1:0,o=t.x.scale*e.x,l=t.y.scale*e.y;i[0+a]/=o,i[1+a]/=l;const u=Er(o,l,.5);return typeof i[2+a]=="number"&&(i[2+a]/=u),typeof i[3+a]=="number"&&(i[3+a]/=u),s(i)}};class Iie extends ie.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r,layoutId:i}=this.props,{projection:s}=e;Hte(Aie),s&&(t.group&&t.group.add(s),r&&r.register&&i&&r.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),W_.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:r,drag:i,isPresent:s}=this.props,a=r.projection;return a&&(a.isPresent=s,i||e.layoutDependency!==t||t===void 0?a.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?a.promote():a.relegate()||lr.postRender(()=>{const o=a.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),WA.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r}=this.props,{projection:i}=e;i&&(i.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(i),r&&r.deregister&&r.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function l9(n){const[e,t]=$8(),r=ie.useContext(FA);return p.jsx(Iie,{...n,layoutGroup:r,switchLayoutGroup:ie.useContext(Q8),isPresent:e,safeToRemove:t})}const Aie={borderRadius:{...Wg,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Wg,borderTopRightRadius:Wg,borderBottomLeftRadius:Wg,borderBottomRightRadius:Wg,boxShadow:bie};function Rie(n,e,t){const r=Hi(n)?n:wp(n);return r.start(pR("",r,e,t)),r.animation}function Cie(n){return n instanceof SVGElement&&n.tagName!=="svg"}const Pie=(n,e)=>n.depth-e.depth;class kie{constructor(){this.children=[],this.isDirty=!1}add(e){sR(this.children,e),this.isDirty=!0}remove(e){aR(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(Pie),this.isDirty=!1,this.children.forEach(e)}}function Mie(n,e){const t=zo.now(),r=({timestamp:i})=>{const s=i-t;s>=e&&(mu(r),n(s-e))};return lr.read(r,!0),()=>mu(r)}const c9=["TopLeft","TopRight","BottomLeft","BottomRight"],Nie=c9.length,$3=n=>typeof n=="string"?parseFloat(n):n,W3=n=>typeof n=="number"||Dt.test(n);function Lie(n,e,t,r,i,s){i?(n.opacity=Er(0,t.opacity!==void 0?t.opacity:1,Oie(r)),n.opacityExit=Er(e.opacity!==void 0?e.opacity:1,0,Die(r))):s&&(n.opacity=Er(e.opacity!==void 0?e.opacity:1,t.opacity!==void 0?t.opacity:1,r));for(let a=0;a<Nie;a++){const o=`border${c9[a]}Radius`;let l=H3(e,o),u=H3(t,o);if(l===void 0&&u===void 0)continue;l||(l=0),u||(u=0),l===0||u===0||W3(l)===W3(u)?(n[o]=Math.max(Er($3(l),$3(u),r),0),(Uo.test(u)||Uo.test(l))&&(n[o]+="%")):n[o]=u}(e.rotate||t.rotate)&&(n.rotate=Er(e.rotate||0,t.rotate||0,r))}function H3(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const Oie=u9(0,.5,Rj),Die=u9(.5,.95,Zs);function u9(n,e,t){return r=>r<n?0:r>e?1:t(A0(n,e,r))}function K3(n,e){n.min=e.min,n.max=e.max}function fa(n,e){K3(n.x,e.x),K3(n.y,e.y)}function Y3(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function q3(n,e,t,r,i){return n-=e,n=Jx(n,1/t,r),i!==void 0&&(n=Jx(n,1/i,r)),n}function Fie(n,e=0,t=1,r=.5,i,s=n,a=n){if(Uo.test(e)&&(e=parseFloat(e),e=Er(a.min,a.max,e/100)-a.min),typeof e!="number")return;let o=Er(s.min,s.max,r);n===s&&(o-=e),n.min=q3(n.min,e,t,o,i),n.max=q3(n.max,e,t,o,i)}function X3(n,e,[t,r,i],s,a){Fie(n,e[t],e[r],e[i],e.scale,s,a)}const jie=["x","scaleX","originX"],Vie=["y","scaleY","originY"];function Z3(n,e,t,r){X3(n.x,e,jie,t?t.x:void 0,r?r.x:void 0),X3(n.y,e,Vie,t?t.y:void 0,r?r.y:void 0)}function Q3(n){return n.translate===0&&n.scale===1}function h9(n){return Q3(n.x)&&Q3(n.y)}function J3(n,e){return n.min===e.min&&n.max===e.max}function Gie(n,e){return J3(n.x,e.x)&&J3(n.y,e.y)}function eL(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function d9(n,e){return eL(n.x,e.x)&&eL(n.y,e.y)}function tL(n){return na(n.x)/na(n.y)}function nL(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class Bie{constructor(){this.members=[]}add(e){sR(this.members,e),e.scheduleRender()}remove(e){if(aR(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(i=>e===i);if(t===0)return!1;let r;for(let i=t;i>=0;i--){const s=this.members[i];if(s.isPresent!==!1){r=s;break}}return r?(this.promote(r),!0):!1}promote(e,t){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,t&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:r}=e;t.onExitComplete&&t.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function Uie(n,e,t){let r="";const i=n.x.translate/e.x,s=n.y.translate/e.y,a=t?.z||0;if((i||s||a)&&(r=`translate3d(${i}px, ${s}px, ${a}px) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:u,rotate:h,rotateX:f,rotateY:g,skewX:y,skewY:v}=t;u&&(r=`perspective(${u}px) ${r}`),h&&(r+=`rotate(${h}deg) `),f&&(r+=`rotateX(${f}deg) `),g&&(r+=`rotateY(${g}deg) `),y&&(r+=`skewX(${y}deg) `),v&&(r+=`skewY(${v}deg) `)}const o=n.x.scale*e.x,l=n.y.scale*e.y;return(o!==1||l!==1)&&(r+=`scale(${o}, ${l})`),r||"none"}const lh={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},om=typeof window<"u"&&window.MotionDebug!==void 0,IS=["","X","Y","Z"],zie={visibility:"hidden"},rL=1e3;let $ie=0;function AS(n,e,t,r){const{latestValues:i}=e;i[n]&&(t[n]=i[n],e.setStaticValue(n,0),r&&(r[n]=0))}function f9(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=wj(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:i,layoutId:s}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",lr,!(i||s))}const{parent:r}=n;r&&!r.hasCheckedOptimisedAppear&&f9(r)}function g9({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:r,resetTransform:i}){return class{constructor(a={},o=e?.()){this.id=$ie++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,om&&(lh.totalNodes=lh.resolvedTargetDeltas=lh.recalculatedProjection=0),this.nodes.forEach(Kie),this.nodes.forEach(Qie),this.nodes.forEach(Jie),this.nodes.forEach(Yie),om&&window.MotionDebug.record(lh)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new kie)}addEventListener(a,o){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new oR),this.eventHandlers.get(a).add(o)}notifyListeners(a,...o){const l=this.eventHandlers.get(a);l&&l.notify(...o)}hasListeners(a){return this.eventHandlers.has(a)}mount(a,o=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=Cie(a),this.instance=a;const{layoutId:l,layout:u,visualElement:h}=this.options;if(h&&!h.current&&h.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),o&&(u||l)&&(this.isLayoutDirty=!0),n){let f;const g=()=>this.root.updateBlockedByResize=!1;n(a,()=>{this.root.updateBlockedByResize=!0,f&&f(),f=Mie(g,250),W_.hasAnimatedSinceResize&&(W_.hasAnimatedSinceResize=!1,this.nodes.forEach(sL))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&h&&(l||u)&&this.addEventListener("didUpdate",({delta:f,hasLayoutChanged:g,hasRelativeTargetChanged:y,layout:v})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const x=this.options.transition||h.getDefaultTransition()||ise,{onLayoutAnimationStart:E,onLayoutAnimationComplete:T}=h.getProps(),b=!this.targetLayout||!d9(this.targetLayout,v)||y,I=!g&&y;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||I||g&&(b||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(f,I);const M={...tR(x,"layout"),onPlay:E,onComplete:T};(h.shouldReduceMotion||this.options.layoutRoot)&&(M.delay=0,M.type=!1),this.startAnimation(M)}else g||sL(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=v})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,mu(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(ese),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&f9(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let h=0;h<this.path.length;h++){const f=this.path[h];f.shouldResetTransform=!0,f.updateScroll("snapshot"),f.options.layoutRoot&&f.willUpdate(!1)}const{layoutId:o,layout:l}=this.options;if(o===void 0&&!l)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(iL);return}this.isUpdating||this.nodes.forEach(Xie),this.isUpdating=!1,this.nodes.forEach(Zie),this.nodes.forEach(Wie),this.nodes.forEach(Hie),this.clearAllSnapshots();const o=zo.now();Si.delta=$l(0,1e3/60,o-Si.timestamp),Si.timestamp=o,Si.isProcessing=!0,yS.update.process(Si),yS.preRender.process(Si),yS.render.process(Si),Si.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,WA.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(qie),this.sharedNodes.forEach(tse)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,lr.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){lr.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Nr(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(o=!1),o){const l=r(this.instance);this.scroll={animationId:this.root.animationId,phase:a,isRoot:l,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!i)return;const a=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!h9(this.projectionDelta),l=this.getTransformTemplate(),u=l?l(this.latestValues,""):void 0,h=u!==this.prevTransformTemplateValue;a&&(o||oh(this.latestValues)||h)&&(i(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const o=this.measurePageBox();let l=this.removeElementScroll(o);return a&&(l=this.removeTransform(l)),sse(l),{animationId:this.root.animationId,measuredBox:o,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var a;const{visualElement:o}=this.options;if(!o)return Nr();const l=o.measureViewportBox();if(!(((a=this.scroll)===null||a===void 0?void 0:a.wasRoot)||this.path.some(ase))){const{scroll:h}=this.root;h&&(Of(l.x,h.offset.x),Of(l.y,h.offset.y))}return l}removeElementScroll(a){var o;const l=Nr();if(fa(l,a),!((o=this.scroll)===null||o===void 0)&&o.wasRoot)return l;for(let u=0;u<this.path.length;u++){const h=this.path[u],{scroll:f,options:g}=h;h!==this.root&&f&&g.layoutScroll&&(f.wasRoot&&fa(l,a),Of(l.x,f.offset.x),Of(l.y,f.offset.y))}return l}applyTransform(a,o=!1){const l=Nr();fa(l,a);for(let u=0;u<this.path.length;u++){const h=this.path[u];!o&&h.options.layoutScroll&&h.scroll&&h!==h.root&&Df(l,{x:-h.scroll.offset.x,y:-h.scroll.offset.y}),oh(h.latestValues)&&Df(l,h.latestValues)}return oh(this.latestValues)&&Df(l,this.latestValues),l}removeTransform(a){const o=Nr();fa(o,a);for(let l=0;l<this.path.length;l++){const u=this.path[l];if(!u.instance||!oh(u.latestValues))continue;pb(u.latestValues)&&u.updateSnapshot();const h=Nr(),f=u.measurePageBox();fa(h,f),Z3(o,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,h)}return oh(this.latestValues)&&Z3(o,this.latestValues),o}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Si.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var o;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==l;if(!(a||u&&this.isSharedProjectionDirty||this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:f,layoutId:g}=this.options;if(!(!this.layout||!(f||g))){if(this.resolvedRelativeTargetAt=Si.timestamp,!this.targetDelta&&!this.relativeTarget){const y=this.getClosestProjectingParent();y&&y.layout&&this.animationProgress!==1?(this.relativeParent=y,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Nr(),this.relativeTargetOrigin=Nr(),Am(this.relativeTargetOrigin,this.layout.layoutBox,y.layout.layoutBox),fa(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Nr(),this.targetWithTransforms=Nr()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),cie(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):fa(this.target,this.layout.layoutBox),s9(this.target,this.targetDelta)):fa(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const y=this.getClosestProjectingParent();y&&!!y.resumingFrom==!!this.resumingFrom&&!y.options.layoutScroll&&y.target&&this.animationProgress!==1?(this.relativeParent=y,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Nr(),this.relativeTargetOrigin=Nr(),Am(this.relativeTargetOrigin,this.target,y.target),fa(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}om&&lh.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||pb(this.parent.latestValues)||i9(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var a;const o=this.getLead(),l=!!this.resumingFrom||this!==o;let u=!0;if((this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty)&&(u=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===Si.timestamp&&(u=!1),u)return;const{layout:h,layoutId:f}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(h||f))return;fa(this.layoutCorrected,this.layout.layoutBox);const g=this.treeScale.x,y=this.treeScale.y;_ie(this.layoutCorrected,this.treeScale,this.path,l),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=Nr());const{target:v}=o;if(!v){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(Y3(this.prevProjectionDelta.x,this.projectionDelta.x),Y3(this.prevProjectionDelta.y,this.projectionDelta.y)),Im(this.projectionDelta,this.layoutCorrected,v,this.latestValues),(this.treeScale.x!==g||this.treeScale.y!==y||!nL(this.projectionDelta.x,this.prevProjectionDelta.x)||!nL(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",v)),om&&lh.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){var o;if((o=this.options.visualElement)===null||o===void 0||o.scheduleRender(),a){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Lf(),this.projectionDelta=Lf(),this.projectionDeltaWithTransform=Lf()}setAnimationOrigin(a,o=!1){const l=this.snapshot,u=l?l.latestValues:{},h={...this.latestValues},f=Lf();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const g=Nr(),y=l?l.source:void 0,v=this.layout?this.layout.source:void 0,x=y!==v,E=this.getStack(),T=!E||E.members.length<=1,b=!!(x&&!T&&this.options.crossfade===!0&&!this.path.some(rse));this.animationProgress=0;let I;this.mixTargetDelta=M=>{const F=M/1e3;aL(f.x,a.x,F),aL(f.y,a.y,F),this.setTargetDelta(f),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Am(g,this.layout.layoutBox,this.relativeParent.layout.layoutBox),nse(this.relativeTarget,this.relativeTargetOrigin,g,F),I&&Gie(this.relativeTarget,I)&&(this.isProjectionDirty=!1),I||(I=Nr()),fa(I,this.relativeTarget)),x&&(this.animationValues=h,Lie(h,u,this.latestValues,F,b,T)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=F},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(mu(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=lr.update(()=>{W_.hasAnimatedSinceResize=!0,this.currentAnimation=Rie(0,rL,{...a,onUpdate:o=>{this.mixTargetDelta(o),a.onUpdate&&a.onUpdate(o)},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(rL),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:o,target:l,layout:u,latestValues:h}=a;if(!(!o||!l||!u)){if(this!==a&&this.layout&&u&&m9(this.options.animationType,this.layout.layoutBox,u.layoutBox)){l=this.target||Nr();const f=na(this.layout.layoutBox.x);l.x.min=a.target.x.min,l.x.max=l.x.min+f;const g=na(this.layout.layoutBox.y);l.y.min=a.target.y.min,l.y.max=l.y.min+g}fa(o,l),Df(o,h),Im(this.projectionDeltaWithTransform,this.layoutCorrected,o,h)}}registerSharedNode(a,o){this.sharedNodes.has(a)||this.sharedNodes.set(a,new Bie),this.sharedNodes.get(a).add(o);const u=o.options.initialPromotionConfig;o.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(o):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var a;const{layoutId:o}=this.options;return o?((a=this.getStack())===null||a===void 0?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:o}=this.options;return o?(a=this.getStack())===null||a===void 0?void 0:a.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:o,preserveFollowOpacity:l}={}){const u=this.getStack();u&&u.promote(this,l),a&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetSkewAndRotation(){const{visualElement:a}=this.options;if(!a)return;let o=!1;const{latestValues:l}=a;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(o=!0),!o)return;const u={};l.z&&AS("z",a,u,this.animationValues);for(let h=0;h<IS.length;h++)AS(`rotate${IS[h]}`,a,u,this.animationValues),AS(`skew${IS[h]}`,a,u,this.animationValues);a.render();for(const h in u)a.setStaticValue(h,u[h]),this.animationValues&&(this.animationValues[h]=u[h]);a.scheduleRender()}getProjectionStyles(a){var o,l;if(!this.instance||this.isSVG)return;if(!this.isVisible)return zie;const u={visibility:""},h=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,u.opacity="",u.pointerEvents=z_(a?.pointerEvents)||"",u.transform=h?h(this.latestValues,""):"none",u;const f=this.getLead();if(!this.projectionDelta||!this.layout||!f.target){const x={};return this.options.layoutId&&(x.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,x.pointerEvents=z_(a?.pointerEvents)||""),this.hasProjected&&!oh(this.latestValues)&&(x.transform=h?h({},""):"none",this.hasProjected=!1),x}const g=f.animationValues||f.latestValues;this.applyTransformsToTarget(),u.transform=Uie(this.projectionDeltaWithTransform,this.treeScale,g),h&&(u.transform=h(g,u.transform));const{x:y,y:v}=this.projectionDelta;u.transformOrigin=`${y.origin*100}% ${v.origin*100}% 0`,f.animationValues?u.opacity=f===this?(l=(o=g.opacity)!==null&&o!==void 0?o:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:g.opacityExit:u.opacity=f===this?g.opacity!==void 0?g.opacity:"":g.opacityExit!==void 0?g.opacityExit:0;for(const x in Yx){if(g[x]===void 0)continue;const{correct:E,applyTo:T}=Yx[x],b=u.transform==="none"?g[x]:E(g[x],f);if(T){const I=T.length;for(let M=0;M<I;M++)u[T[M]]=b}else u[x]=b}return this.options.layoutId&&(u.pointerEvents=f===this?z_(a?.pointerEvents)||"":"none"),u}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var o;return(o=a.currentAnimation)===null||o===void 0?void 0:o.stop()}),this.root.nodes.forEach(iL),this.root.sharedNodes.clear()}}}function Wie(n){n.updateLayout()}function Hie(n){var e;const t=((e=n.resumeFrom)===null||e===void 0?void 0:e.snapshot)||n.snapshot;if(n.isLead()&&n.layout&&t&&n.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:i}=n.layout,{animationType:s}=n.options,a=t.source!==n.layout.source;s==="size"?ma(f=>{const g=a?t.measuredBox[f]:t.layoutBox[f],y=na(g);g.min=r[f].min,g.max=g.min+y}):m9(s,t.layoutBox,r)&&ma(f=>{const g=a?t.measuredBox[f]:t.layoutBox[f],y=na(r[f]);g.max=g.min+y,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[f].max=n.relativeTarget[f].min+y)});const o=Lf();Im(o,r,t.layoutBox);const l=Lf();a?Im(l,n.applyTransform(i,!0),t.measuredBox):Im(l,r,t.layoutBox);const u=!h9(o);let h=!1;if(!n.resumeFrom){const f=n.getClosestProjectingParent();if(f&&!f.resumeFrom){const{snapshot:g,layout:y}=f;if(g&&y){const v=Nr();Am(v,t.layoutBox,g.layoutBox);const x=Nr();Am(x,r,y.layoutBox),d9(v,x)||(h=!0),f.options.layoutRoot&&(n.relativeTarget=x,n.relativeTargetOrigin=v,n.relativeParent=f)}}}n.notifyListeners("didUpdate",{layout:r,snapshot:t,delta:l,layoutDelta:o,hasLayoutChanged:u,hasRelativeTargetChanged:h})}else if(n.isLead()){const{onExitComplete:r}=n.options;r&&r()}n.options.transition=void 0}function Kie(n){om&&lh.totalNodes++,n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function Yie(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function qie(n){n.clearSnapshot()}function iL(n){n.clearMeasurements()}function Xie(n){n.isLayoutDirty=!1}function Zie(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function sL(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function Qie(n){n.resolveTargetDelta()}function Jie(n){n.calcProjection()}function ese(n){n.resetSkewAndRotation()}function tse(n){n.removeLeadSnapshot()}function aL(n,e,t){n.translate=Er(e.translate,0,t),n.scale=Er(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function oL(n,e,t,r){n.min=Er(e.min,t.min,r),n.max=Er(e.max,t.max,r)}function nse(n,e,t,r){oL(n.x,e.x,t.x,r),oL(n.y,e.y,t.y,r)}function rse(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const ise={duration:.45,ease:[.4,0,.1,1]},lL=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),cL=lL("applewebkit/")&&!lL("chrome/")?Math.round:Zs;function uL(n){n.min=cL(n.min),n.max=cL(n.max)}function sse(n){uL(n.x),uL(n.y)}function m9(n,e,t){return n==="position"||n==="preserve-aspect"&&!lie(tL(e),tL(t),.2)}function ase(n){var e;return n!==n.root&&((e=n.scroll)===null||e===void 0?void 0:e.wasRoot)}const ose=g9({attachResizeListener:(n,e)=>Sp(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),RS={current:void 0},p9=g9({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!RS.current){const n=new ose({});n.mount(window),n.setOptions({layoutScroll:!0}),RS.current=n}return RS.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),lse={pan:{Feature:Tie},drag:{Feature:Sie,ProjectionNode:p9,MeasureLayout:l9}};function hL(n,e,t){const{props:r}=n;n.animationState&&r.whileHover&&n.animationState.setActive("whileHover",t==="Start");const i="onHover"+t,s=r[i];s&&lr.postRender(()=>s(e,E1(e)))}class cse extends Au{mount(){const{current:e}=this.node;e&&(this.unmount=lne(e,t=>(hL(this.node,t,"Start"),r=>hL(this.node,r,"End"))))}unmount(){}}class use extends Au{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=w1(Sp(this.node.current,"focus",()=>this.onFocus()),Sp(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function dL(n,e,t){const{props:r}=n;n.animationState&&r.whileTap&&n.animationState.setActive("whileTap",t==="Start");const i="onTap"+(t==="End"?"":t),s=r[i];s&&lr.postRender(()=>s(e,E1(e)))}class hse extends Au{mount(){const{current:e}=this.node;e&&(this.unmount=dne(e,t=>(dL(this.node,t,"Start"),(r,{success:i})=>dL(this.node,r,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const _b=new WeakMap,CS=new WeakMap,dse=n=>{const e=_b.get(n.target);e&&e(n)},fse=n=>{n.forEach(dse)};function gse({root:n,...e}){const t=n||document;CS.has(t)||CS.set(t,{});const r=CS.get(t),i=JSON.stringify(e);return r[i]||(r[i]=new IntersectionObserver(fse,{root:n,...e})),r[i]}function mse(n,e,t){const r=gse(e);return _b.set(n,t),r.observe(n),()=>{_b.delete(n),r.unobserve(n)}}const pse={some:0,all:1};class yse extends Au{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:r,amount:i="some",once:s}=e,a={root:t?t.current:void 0,rootMargin:r,threshold:typeof i=="number"?i:pse[i]},o=l=>{const{isIntersecting:u}=l;if(this.isInView===u||(this.isInView=u,s&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:h,onViewportLeave:f}=this.node.getProps(),g=u?h:f;g&&g(l)};return mse(this.node.current,a,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(_se(e,t))&&this.startObserver()}unmount(){}}function _se({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const xse={inView:{Feature:yse},tap:{Feature:hse},focus:{Feature:use},hover:{Feature:cse}},vse={layout:{ProjectionNode:p9,MeasureLayout:l9}},xb={current:null},y9={current:!1};function wse(){if(y9.current=!0,!!GA)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>xb.current=n.matches;n.addListener(e),e()}else xb.current=!1}const Ese=[...Uj,Bi,pu],Sse=n=>Ese.find(Bj(n)),fL=new WeakMap;function Tse(n,e,t){for(const r in e){const i=e[r],s=t[r];if(Hi(i))n.addValue(r,i);else if(Hi(s))n.addValue(r,wp(i,{owner:n}));else if(s!==i)if(n.hasValue(r)){const a=n.getValue(r);a.liveStyle===!0?a.jump(i):a.hasAnimated||a.set(i)}else{const a=n.getStaticValue(r);n.addValue(r,wp(a!==void 0?a:i,{owner:n}))}}for(const r in t)e[r]===void 0&&n.removeValue(r);return e}const gL=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class bse{scrapeMotionValuesFromProps(e,t,r){return{}}constructor({parent:e,props:t,presenceContext:r,reducedMotionConfig:i,blockInitialAnimation:s,visualState:a},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=fR,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const y=zo.now();this.renderScheduledAt<y&&(this.renderScheduledAt=y,lr.render(this.render,!1,!0))};const{latestValues:l,renderState:u,onUpdate:h}=a;this.onUpdate=h,this.latestValues=l,this.baseTarget={...l},this.initialValues=t.initial?{...l}:{},this.renderState=u,this.parent=e,this.props=t,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=o,this.blockInitialAnimation=!!s,this.isControllingVariants=kw(t),this.isVariantNode=X8(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:f,...g}=this.scrapeMotionValuesFromProps(t,{},this);for(const y in g){const v=g[y];l[y]!==void 0&&Hi(v)&&v.set(l[y],!1)}}mount(e){this.current=e,fL.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,r)=>this.bindToMotionValue(r,t)),y9.current||wse(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:xb.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){fL.delete(this.current),this.projection&&this.projection.unmount(),mu(this.notifyUpdate),mu(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const r=md.has(e),i=t.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&lr.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0)}),s=t.on("renderRequest",this.scheduleRender);let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{i(),s(),a&&a(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in R0){const t=R0[e];if(!t)continue;const{isEnabled:r,Feature:i}=t;if(!this.features[e]&&i&&r(this.props)&&(this.features[e]=new i(this)),this.features[e]){const s=this.features[e];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Nr()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let r=0;r<gL.length;r++){const i=gL[r];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const s="on"+i,a=e[s];a&&(this.propEventSubscriptions[i]=this.on(i,a))}this.prevMotionValues=Tse(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const r=this.values.get(e);t!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&t!==void 0&&(r=wp(t===null?void 0:t,{owner:this}),this.addValue(e,r)),r}readValue(e,t){var r;let i=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(r=this.getBaseTargetFromProps(this.props,e))!==null&&r!==void 0?r:this.readValueFromInstance(this.current,e,this.options);return i!=null&&(typeof i=="string"&&(Vj(i)||Pj(i))?i=parseFloat(i):!Sse(i)&&pu.test(t)&&(i=Dj(e,t)),this.setBaseTarget(e,Hi(i)?i.get():i)),Hi(i)?i.get():i}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;const{initial:r}=this.props;let i;if(typeof r=="string"||typeof r=="object"){const a=KA(this.props,r,(t=this.presenceContext)===null||t===void 0?void 0:t.custom);a&&(i=a[e])}if(r&&i!==void 0)return i;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!Hi(s)?s:this.initialValues[e]!==void 0&&i===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new oR),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}}class _9 extends bse{constructor(){super(...arguments),this.KeyframeResolver=zj}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:r}){delete t[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Hi(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function Ise(n){return window.getComputedStyle(n)}class Ase extends _9{constructor(){super(...arguments),this.type="html",this.renderInstance=sj}readValueFromInstance(e,t){if(md.has(t)){const r=dR(t);return r&&r.default||0}else{const r=Ise(e),i=(nj(t)?r.getPropertyValue(t):r[t])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:t}){return a9(e,t)}build(e,t,r){XA(e,t,r.transformTemplate)}scrapeMotionValuesFromProps(e,t,r){return eR(e,t,r)}}class Rse extends _9{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Nr}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(md.has(t)){const r=dR(t);return r&&r.default||0}return t=aj.has(t)?t:$A(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,r){return cj(e,t,r)}build(e,t,r){ZA(e,t,this.isSVGTag,r.transformTemplate)}renderInstance(e,t,r,i){oj(e,t,r,i)}mount(e){this.isSVGTag=JA(e.tagName),super.mount(e)}}const Cse=(n,e)=>HA(n)?new Rse(e):new Ase(e,{allowProjection:n!==ie.Fragment}),Pse=tne({...Jre,...xse,...lse,...vse},Cse),Ft=pte(Pse);const kse=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Mse=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),mL=n=>{const e=Mse(n);return e.charAt(0).toUpperCase()+e.slice(1)},x9=(...n)=>n.filter((e,t,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===t).join(" ").trim(),Nse=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var Lse={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Ose=ie.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:i="",children:s,iconNode:a,...o},l)=>ie.createElement("svg",{ref:l,...Lse,width:e,height:e,stroke:n,strokeWidth:r?Number(t)*24/Number(e):t,className:x9("lucide",i),...!s&&!Nse(o)&&{"aria-hidden":"true"},...o},[...a.map(([u,h])=>ie.createElement(u,h)),...Array.isArray(s)?s:[s]]));const _t=(n,e)=>{const t=ie.forwardRef(({className:r,...i},s)=>ie.createElement(Ose,{ref:s,iconNode:e,className:x9(`lucide-${kse(mL(n))}`,`lucide-${n}`,r),...i}));return t.displayName=mL(n),t};const Dse=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h2",key:"tvwodi"}],["path",{d:"M20 8v11a2 2 0 0 1-2 2h-2",key:"1gkqxj"}],["path",{d:"m9 15 3-3 3 3",key:"1pd0qc"}],["path",{d:"M12 12v9",key:"192myk"}]],Fse=_t("archive-restore",Dse);const jse=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],v9=_t("archive",jse);const Vse=[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Gse=_t("ban",Vse);const Bse=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],Use=_t("book-open",Bse);const zse=[["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M14 7a4 4 0 0 1 4 4v3a6 6 0 0 1-12 0v-3a4 4 0 0 1 4-4z",key:"uouzyp"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M21 21a4 4 0 0 0-3.81-4",key:"1b0z45"}],["path",{d:"M21 5a4 4 0 0 1-3.55 3.97",key:"5cxbf6"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M3 21a4 4 0 0 1 3.81-4",key:"1fjd4g"}],["path",{d:"M3 5a4 4 0 0 0 3.55 3.97",key:"1d7oge"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M9 7.13V6a3 3 0 1 1 6 0v1.13",key:"1vgav8"}]],w9=_t("bug",zse);const $se=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Wse=_t("calendar",$se);const Hse=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],yR=_t("camera",Hse);const Kse=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],E9=_t("chart-column",Kse);const Yse=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Wl=_t("check",Yse);const qse=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],_R=_t("chevron-down",qse);const Xse=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Zse=_t("chevron-left",Xse);const Qse=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Lw=_t("chevron-right",Qse);const Jse=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],S9=_t("chevron-up",Jse);const eae=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],T9=_t("circle-alert",eae);const tae=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],nae=_t("circle-check-big",tae);const rae=[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5.782 5.782A7 7 0 0 0 9 19h8.5a4.5 4.5 0 0 0 1.307-.193",key:"yfwify"}],["path",{d:"M21.532 16.5A4.5 4.5 0 0 0 17.5 10h-1.79A7.008 7.008 0 0 0 10 5.07",key:"jlfiyv"}]],iae=_t("cloud-off",rae);const sae=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]],pL=_t("cloud",sae);const aae=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],oae=_t("code",aae);const lae=[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],cae=_t("compass",lae);const uae=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"22",x2:"18",y1:"12",y2:"12",key:"l9bcsi"}],["line",{x1:"6",x2:"2",y1:"12",y2:"12",key:"13hhkx"}],["line",{x1:"12",x2:"12",y1:"6",y2:"2",key:"10w3f3"}],["line",{x1:"12",x2:"12",y1:"22",y2:"18",key:"15g9kq"}]],vb=_t("crosshair",uae);const hae=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],wb=_t("download",hae);const dae=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],S1=_t("external-link",dae);const fae=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],b9=_t("eye-off",fae);const gae=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],I9=_t("eye",gae);const mae=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],A9=_t("file-text",mae);const pae=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],yae=_t("folder-open",pae);const _ae=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],xae=_t("folder",_ae);const vae=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],wae=_t("grid-3x3",vae);const Eae=[["path",{d:"M16 5h6",key:"1vod17"}],["path",{d:"M19 2v6",key:"4bpg5p"}],["path",{d:"M21 11.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7.5",key:"1ue2ih"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}]],Sae=_t("image-plus",Eae);const Tae=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],R9=_t("info",Tae);const bae=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],to=_t("layers",bae);const Iae=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],Aae=_t("list",Iae);const Rae=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],xR=_t("loader-circle",Rae);const Cae=[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Pae=_t("locate-fixed",Cae);const kae=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],Eb=_t("lock",kae);const Mae=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],vR=_t("log-out",Mae);const Nae=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Hl=_t("map-pin",Nae);const Lae=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],wR=_t("map",Lae);const Oae=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],Dae=_t("menu",Oae);const Fae=[["path",{d:"M5 12h14",key:"1ays0h"}]],jae=_t("minus",Fae);const Vae=[["path",{d:"m8 3 4 8 5-5 5 15H2L8 3z",key:"otkl63"}]],Sb=_t("mountain",Vae);const Gae=[["path",{d:"M12.586 12.586 19 19",key:"ea5xo7"}],["path",{d:"M3.688 3.037a.497.497 0 0 0-.651.651l6.5 15.999a.501.501 0 0 0 .947-.062l1.569-6.083a2 2 0 0 1 1.448-1.479l6.124-1.579a.5.5 0 0 0 .063-.947z",key:"277e5u"}]],Bae=_t("mouse-pointer",Gae);const Uae=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],ER=_t("navigation",Uae);const zae=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],yL=_t("pen-line",zae);const $ae=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Wae=_t("pen",$ae);const Hae=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Tp=_t("pencil",Hae);const Kae=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],oo=_t("plus",Kae);const Yae=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],qae=_t("rotate-ccw",Yae);const Xae=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],Zae=_t("rotate-cw",Xae);const Qae=[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]],Jae=_t("ruler",Qae);const eoe=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],toe=_t("save",eoe);const noe=[["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"m19 8 3 8a5 5 0 0 1-6 0zV7",key:"zcdpyk"}],["path",{d:"M3 7h1a17 17 0 0 0 8-2 17 17 0 0 0 8 2h1",key:"1yorad"}],["path",{d:"m5 8 3 8a5 5 0 0 1-6 0zV7",key:"eua70x"}],["path",{d:"M7 21h10",key:"1b0cd5"}]],roe=_t("scale",noe);const ioe=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Tb=_t("search",ioe);const soe=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],bb=_t("settings",soe);const aoe=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],ooe=_t("settings-2",aoe);const loe=[["path",{d:"M10 5H3",key:"1qgfaw"}],["path",{d:"M12 19H3",key:"yhmn1j"}],["path",{d:"M14 3v4",key:"1sua03"}],["path",{d:"M16 17v4",key:"1q0r14"}],["path",{d:"M21 12h-9",key:"1o4lsq"}],["path",{d:"M21 19h-5",key:"1rlt1p"}],["path",{d:"M21 5h-7",key:"1oszz2"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M8 12H3",key:"a7s4jb"}]],coe=_t("sliders-horizontal",loe);const uoe=[["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M12 21v-9",key:"17s77i"}],["path",{d:"M12 8V3",key:"13r4qs"}],["path",{d:"M17 16h4",key:"h1uq16"}],["path",{d:"M19 12V3",key:"o1uvq1"}],["path",{d:"M19 21v-5",key:"qua636"}],["path",{d:"M3 14h4",key:"bcjad9"}],["path",{d:"M5 10V3",key:"cb8scm"}],["path",{d:"M5 21v-7",key:"1w1uti"}]],hoe=_t("sliders-vertical",uoe);const doe=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],foe=_t("smartphone",doe);const goe=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],moe=_t("tag",goe);const poe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],yoe=_t("target",poe);const _oe=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],pd=_t("trash-2",_oe);const xoe=[["path",{d:"M13 8c0-2.76-2.46-5-5.5-5S2 5.24 2 8h2l1-1 1 1h4",key:"foxbe7"}],["path",{d:"M13 7.14A5.82 5.82 0 0 1 16.5 6c3.04 0 5.5 2.24 5.5 5h-3l-1-1-1 1h-3",key:"18arnh"}],["path",{d:"M5.89 9.71c-2.15 2.15-2.3 5.47-.35 7.43l4.24-4.25.7-.7.71-.71 2.12-2.12c-1.95-1.96-5.27-1.8-7.42.35",key:"ywahnh"}],["path",{d:"M11 15.5c.5 2.5-.17 4.5-1 6.5h4c2-5.5-.5-12-1-14",key:"ft0feo"}]],voe=_t("tree-palm",xoe);const woe=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],Eoe=_t("type",woe);const Soe=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Ow=_t("upload",Soe);const Toe=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],SR=_t("user",Toe);const boe=[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]],Ioe=_t("waves",boe);const Aoe=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Qi=_t("x",Aoe);function Roe(){const{tracking:n,startTracking:e,stopTracking:t,updatePosition:r,setWatchId:i,resetFirstFix:s}=is(),a=ie.useCallback(l=>{r(l)},[r]),o=ie.useCallback(l=>{console.error("GPS error:",l),alert(`GPS fout: ${l.message}`),t()},[t]);return ie.useEffect(()=>{if(!n)return;if(!navigator.geolocation){alert("Geolocation wordt niet ondersteund door deze browser"),t();return}const l=navigator.geolocation.watchPosition(a,o,{enableHighAccuracy:!0,maximumAge:1e3,timeout:15e3});return i(l),()=>{navigator.geolocation.clearWatch(l)}},[n,a,o,i,t]),{tracking:n,start:e,stop:t,toggle:()=>n?t():e()}}function Coe(){const{tracking:n,toggle:e}=Roe();return p.jsx(Ft.button,{className:`
        fixed bottom-2 right-2 z-[1000]
        w-11 h-11 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${n?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},animate:n?{scale:[1,1.02,1]}:{},transition:n?{scale:{duration:2,repeat:1/0,ease:"easeInOut"}}:{},"aria-label":n?"GPS tracking actief":"GPS tracking starten",title:n?"GPS tracking actief":"GPS tracking starten",children:p.jsx(Pae,{size:22,strokeWidth:2})})}const Poe="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48">
    <polygon points="24,6 38,38 24,30 10,38" fill="#4285F4" stroke="white" stroke-width="3" stroke-linejoin="round"/>
  </svg>`);function koe(){const n=hs(y=>y.map),e=is(y=>y.position),t=is(y=>y.accuracy),r=is(y=>y.tracking),i=is(y=>y.smoothHeading),s=Fr(y=>y.showAccuracyCircle),a=is(y=>y.firstFix),o=is(y=>y.resetFirstFix),l=is(y=>y.config.centerOnUser),u=ie.useRef(null),h=ie.useRef(null),f=ie.useRef(null),g=ie.useMemo(()=>y=>new nr({image:new qp({src:Poe,scale:.9,rotation:y,rotateWithView:!1,anchor:[.5,.5]})}),[]);return ie.useEffect(()=>{if(!n||!r&&!e)return;const y=Ho([5.1214,52.0907]);return u.current=new io({geometry:new Js(y)}),u.current.setStyle(g(0)),h.current=new io({geometry:new Js(y)}),f.current=new Qp({source:new Kp({features:[h.current,u.current]}),zIndex:1e3}),n.addLayer(f.current),()=>{f.current&&n&&n.removeLayer(f.current)}},[n,r,e,g]),ie.useEffect(()=>{if(!n||!e||!u.current||!h.current)return;const y=Ho([e.lng,e.lat]);if(u.current.getGeometry()?.setCoordinates(y),h.current.getGeometry()?.setCoordinates(y),s&&t){const v=n.getView().getResolution()||1,x=Math.min(t/v,80);h.current.setStyle(new nr({image:new Yo({radius:x,fill:new Wr({color:"rgba(66, 133, 244, 0.12)"})})}))}else h.current.setStyle(new nr({}));if(a&&r){n.getView().setCenter(y),n.getView().setZoom(17),o();return}r&&l&&!a&&n.getView().animate({center:y,duration:150})},[n,r,e,t,a,o,l,s]),ie.useEffect(()=>{if(!u.current)return;const y=i!==null?i*Math.PI/180:0;u.current.setStyle(g(y))},[i,g]),null}function Moe(){const n=Or(t=>t.themesPanelOpen),e=Or(t=>t.toggleThemesPanel);return p.jsx(Ft.button,{className:`
        fixed bottom-[60px] right-2 z-[1000]
        w-11 h-11 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${n?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":n?"Kaartlagen sluiten":"Kaartlagen openen",title:"Kaartlagen",children:p.jsx(wR,{size:22,strokeWidth:2})})}function Noe(){return p.jsx(Moe,{})}const c_=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899"],Fc=["Mineraal","Fossiel","Erfgoed","Monument","Overig"],$a="default-vondsten",C9={id:$a,name:"Mijn vondsten",color:"#f97316",categories:["Munt","Aardewerk","Gesp","Fibula","Ring","Speld","Sieraad","Gereedschap","Wapen","Anders"],points:[],visible:!0,archived:!1,createdAt:new Date().toISOString()},Loe=n=>n.some(t=>t.id===$a)?n:[{...C9,createdAt:new Date().toISOString()},...n],Yi=Ra()(B0((n,e)=>({layers:[{...C9}],colorIndex:0,addLayer:(t,r=Fc)=>{const i=crypto.randomUUID(),s=c_[e().colorIndex%c_.length];return n(a=>({layers:[...a.layers,{id:i,name:t,color:s,categories:[...r],points:[],visible:!0,archived:!1,createdAt:new Date().toISOString()}],colorIndex:a.colorIndex+1})),i},removeLayer:t=>{n(r=>({layers:r.layers.filter(i=>i.id!==t)}))},updateLayer:(t,r)=>{n(i=>({layers:i.layers.map(s=>s.id===t?{...s,...r}:s)}))},toggleVisibility:t=>{n(r=>({layers:r.layers.map(i=>i.id===t?{...i,visible:!i.visible}:i)}))},toggleArchived:t=>{n(r=>({layers:r.layers.map(i=>i.id===t?{...i,archived:!i.archived,visible:i.archived?i.visible:!1}:i)}))},addPoint:(t,r)=>{const i={...r,status:r.status||"todo",id:crypto.randomUUID(),createdAt:new Date().toISOString()};n(s=>({layers:s.layers.map(a=>a.id===t?{...a,points:[...a.points,i]}:a)}))},removePoint:(t,r)=>{n(i=>({layers:i.layers.map(s=>s.id===t?{...s,points:s.points.filter(a=>a.id!==r)}:s)}))},updatePoint:(t,r,i)=>{n(s=>({layers:s.layers.map(a=>a.id===t?{...a,points:a.points.map(o=>o.id===r?{...o,...i}:o)}:a)}))},setPointStatus:(t,r,i)=>{n(s=>({layers:s.layers.map(a=>a.id===t?{...a,points:a.points.map(o=>o.id===r?{...o,status:i}:o)}:a)}))},addCategory:(t,r)=>{n(i=>({layers:i.layers.map(s=>s.id===t&&!s.categories.includes(r)?{...s,categories:[...s.categories,r]}:s)}))},removeCategory:(t,r)=>{n(i=>({layers:i.layers.map(s=>s.id===t?{...s,categories:s.categories.filter(a=>a!==r)}:s)}))},addPhotoToPoint:(t,r,i)=>{n(s=>({layers:s.layers.map(a=>a.id===t?{...a,points:a.points.map(o=>o.id===r?{...o,photos:[...o.photos||[],i]}:o)}:a)}))},removePhotoFromPoint:(t,r,i)=>{n(s=>({layers:s.layers.map(a=>a.id===t?{...a,points:a.points.map(o=>o.id===r?{...o,photos:(o.photos||[]).filter(l=>l.id!==i)}:o)}:a)}))},updatePhotoInPoint:(t,r,i,s)=>{n(a=>({layers:a.layers.map(o=>o.id===t?{...o,points:o.points.map(l=>l.id===r?{...l,photos:(l.photos||[]).map(u=>u.id===i?{...u,...s}:u)}:l)}:o)}))},exportLayerAsGeoJSON:t=>{const r=e().layers.find(l=>l.id===t);if(!r)return;const i={type:"FeatureCollection",properties:{name:r.name,color:r.color,categories:r.categories,createdAt:r.createdAt,exportedAt:new Date().toISOString()},features:r.points.map(l=>({type:"Feature",geometry:{type:"Point",coordinates:l.coordinates},properties:{id:l.id,name:l.name,category:l.category,notes:l.notes,url:l.url,status:l.status,sourceLayer:l.sourceLayer,sourceId:l.sourceId,photos:l.photos,createdAt:l.createdAt}}))},s=new Blob([JSON.stringify(i,null,2)],{type:"application/geo+json"}),a=URL.createObjectURL(s),o=document.createElement("a");o.href=a,o.download=`${r.name.replace(/[^a-zA-Z0-9]/g,"-")}-${new Date().toISOString().split("T")[0]}.geojson`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(a)},importLayerFromGeoJSON:t=>{try{const r=JSON.parse(t);if(r.type!=="FeatureCollection")return{success:!1,error:"Ongeldig GeoJSON formaat"};const i=r.properties||{},s=i.name||`Gemporteerd ${new Date().toLocaleDateString("nl-NL")}`,a=i.categories||Fc,o=i.color||c_[e().colorIndex%c_.length],l=(r.features||[]).filter(h=>h.geometry?.type==="Point").map(h=>({id:h.properties?.id||crypto.randomUUID(),name:h.properties?.name||"Naamloos",category:h.properties?.category||"Overig",notes:h.properties?.notes||"",url:h.properties?.url,status:h.properties?.status||"todo",sourceLayer:h.properties?.sourceLayer,sourceId:h.properties?.sourceId,photos:h.properties?.photos,coordinates:h.geometry.coordinates,createdAt:h.properties?.createdAt||new Date().toISOString()})),u=crypto.randomUUID();return n(h=>({layers:[...h.layers,{id:u,name:s,color:o,categories:a,points:l,visible:!0,archived:!1,createdAt:new Date().toISOString()}],colorIndex:h.colorIndex+1})),{success:!0,layerId:u}}catch{return{success:!1,error:"Fout bij parsen van GeoJSON"}}},getLayer:t=>e().layers.find(r=>r.id===t),getActiveLayerCount:()=>e().layers.filter(t=>!t.archived).length,getArchivedLayerCount:()=>e().layers.filter(t=>t.archived).length,clearAll:()=>{n(t=>({layers:t.layers.map(r=>r.id===$a?{...r,points:[]}:r).filter(r=>r.id===$a),colorIndex:0}))}}),{name:"detectorapp-custom-point-layers",version:3,migrate:(n,e)=>{const t=n;return e<2?{...t,layers:Loe(t.layers||[])}:e<3?{...t,layers:(t.layers||[]).map(r=>r.id===$a?{...r,name:"Mijn vondsten"}:r)}:t}}));function Qr({title:n,children:e,defaultExpanded:t=!0,layerNames:r}){const[i,s]=ie.useState(t),a=di(E=>E.visible),o=di(E=>E.setLayerVisibility),l=DA(E=>E.isLayerUnlocked),u=E=>{const T=qv[E],b=T?.tier??"free",I=T?.regions??["nl"];return l(E,b,I)},h=r?.filter(E=>u(E))||[],f=h.filter(E=>a[E]).length,g=h.length,y=g>0&&f===g,v=f>0&&f<g,x=E=>{if(E.stopPropagation(),!r||h.length===0)return;const T=!y;h.forEach(b=>{o(b,T)})};return p.jsxs("div",{className:"mb-0.5",children:[p.jsxs("div",{className:"flex items-center gap-1 py-1 px-1 hover:bg-blue-50 transition-colors",children:[p.jsxs("button",{onClick:E=>{E.stopPropagation(),s(!i)},className:"flex-1 flex items-center gap-1 bg-transparent border-0 outline-none text-left",style:{fontSize:"inherit"},children:[p.jsx(Ft.span,{animate:{rotate:i?90:0},transition:{duration:.15},className:"text-gray-400",children:p.jsx(Lw,{size:14})}),i?p.jsx(yae,{size:16,className:"text-blue-500"}):p.jsx(xae,{size:16,className:"text-blue-500"}),p.jsx("span",{className:"text-gray-700 font-medium",style:{fontSize:"1em"},children:n}),f>0&&p.jsx("span",{className:"ml-1 px-1.5 py-0.5 font-medium bg-blue-100 text-blue-600 rounded-full",style:{fontSize:"0.7em"},children:f})]}),r&&r.length>0&&p.jsx("button",{onClick:x,className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:y?"#3b82f6":v?"#93c5fd":"white",border:y?"2px solid #3b82f6":"2px solid #60a5fa",color:"white"},children:(y||v)&&p.jsx("svg",{width:"10",height:"10",viewBox:"0 0 10 10",children:p.jsx("path",{d:"M2 5 L4 7 L8 3",stroke:"currentColor",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),p.jsx(jr,{initial:!1,children:i&&p.jsx(Ft.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.15},style:{overflow:"hidden"},className:"ml-5",children:e})})]})}function lt({name:n,type:e,hasOverlay:t}){const r=di(I=>I.visible[n]),i=di(I=>I.visible["Labels Overlay"]),s=di(I=>I.loadingState[n]),a=di(I=>I.toggleLayer),o=di(I=>I.setLayerVisibility),l=DA(I=>I.isLayerUnlocked),u=s==="loading",h=s==="error",f=qv[n],g=f?.tier??"free",y=f?.regions??["nl"],x=!l(n,g,y),E=I=>{I.stopPropagation(),!(u||x)&&(e==="overlay"?a(n):["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"].forEach(F=>{o(F,F===n)}))},T=I=>{I.stopPropagation(),o("Labels Overlay",!i)},b=r??!1;return p.jsxs("div",{className:"flex items-center gap-1",children:[p.jsxs("button",{onClick:E,disabled:u||x,className:`flex-1 flex items-center justify-between py-1 pl-3 pr-2 border-0 outline-none transition-colors text-left ${x?"opacity-50 cursor-not-allowed bg-gray-50":u?"opacity-70 cursor-wait bg-transparent":b?"bg-blue-50 hover:bg-blue-100":"bg-transparent hover:bg-blue-50"}`,style:{fontSize:"inherit"},title:x?"Premium laag - upgrade om te ontgrendelen":void 0,children:[p.jsxs("span",{className:`flex items-center gap-1 ${h?"text-red-500":x?"text-gray-400":"text-gray-600"}`,children:[n,h&&p.jsx(T9,{size:12,className:"text-red-500"}),x&&p.jsx(Eb,{size:12,className:"text-amber-500"})]}),p.jsx("div",{className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:x?"#e5e7eb":u?"#93c5fd":b?"#3b82f6":"white",border:x?"2px solid #d1d5db":u?"2px solid #93c5fd":b?"2px solid #3b82f6":"2px solid #60a5fa",color:"white"},children:x?p.jsx(Eb,{size:10,strokeWidth:3,className:"text-gray-400"}):u?p.jsx(xR,{size:10,strokeWidth:3,className:"animate-spin"}):b?p.jsx(Wl,{size:12,strokeWidth:3}):null})]}),t&&b&&p.jsx("button",{onClick:T,className:`p-1 rounded transition-colors border-0 outline-none ${i?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-400 hover:bg-gray-200"}`,title:i?"Labels verbergen":"Labels tonen",children:p.jsx(moe,{size:12})})]})}const Ooe=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899","#6b7280"];function P9({layer:n,compact:e=!1}){const{toggleVisibility:t,removeLayer:r,updateLayer:i,setColor:s}=_1(),[a,o]=ie.useState(!1),[l,u]=ie.useState(!1),[h,f]=ie.useState(n.name),[g,y]=ie.useState(!1),v=ie.useRef(null),x=ie.useRef(null),E=n.features.features.length,T=[...new Set(n.features.features.map(k=>k.geometry?.type).filter(Boolean))];ie.useEffect(()=>{l&&v.current&&(v.current.focus(),v.current.select())},[l]),ie.useEffect(()=>{const k=C=>{x.current&&!x.current.contains(C.target)&&y(!1)};if(g)return document.addEventListener("mousedown",k),()=>document.removeEventListener("mousedown",k)},[g]);const b=()=>{a?r(n.id):(o(!0),setTimeout(()=>o(!1),3e3))},I=()=>{const k=h.trim();k&&k!==n.name&&i(n.id,{name:k}),u(!1)},M=()=>{f(n.name),u(!1)},F=k=>{k.key==="Enter"?I():k.key==="Escape"&&M()},z=k=>{s(n.id,k),y(!1)};return e?p.jsxs("div",{className:"flex items-center gap-1 py-0.5 px-1 hover:bg-blue-50 transition-colors rounded",children:[p.jsx("button",{onClick:()=>t(n.id),className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:n.visible?n.color:"white",border:`2px solid ${n.color}`},title:n.visible?"Verbergen":"Tonen",children:n.visible&&p.jsx("svg",{width:"10",height:"10",viewBox:"0 0 10 10",children:p.jsx("path",{d:"M2 5 L4 7 L8 3",stroke:"white",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})})}),p.jsx("span",{className:"text-gray-700 truncate flex-1 cursor-pointer",style:{fontSize:"0.9em"},onClick:()=>t(n.id),children:n.name}),p.jsx("span",{className:"text-[10px] text-gray-400 flex-shrink-0",children:E})]}):p.jsxs("div",{className:"flex items-center justify-between py-1.5 group",children:[p.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[p.jsxs("div",{className:"relative",ref:x,children:[p.jsx("button",{onClick:()=>y(!g),className:"w-5 h-5 rounded border-2 border-white shadow-sm flex-shrink-0 hover:scale-110 transition-transform",style:{backgroundColor:n.color},title:"Kleur wijzigen"}),g&&p.jsx("div",{className:"absolute top-6 left-0 z-50 bg-white rounded-lg shadow-lg border p-2 grid grid-cols-3 gap-1",children:Ooe.map(k=>p.jsx("button",{onClick:()=>z(k),className:`w-6 h-6 rounded border-2 transition-transform hover:scale-110 ${k===n.color?"border-gray-800 scale-110":"border-white"}`,style:{backgroundColor:k},title:k},k))})]}),p.jsx("div",{className:"flex-1 min-w-0",children:l?p.jsxs("div",{className:"flex items-center gap-1",children:[p.jsx("input",{ref:v,type:"text",value:h,onChange:k=>f(k.target.value),onKeyDown:F,className:"flex-1 text-sm px-1 py-0.5 border rounded min-w-0"}),p.jsx("button",{onClick:I,className:"p-0.5 text-green-600 hover:bg-green-50 rounded",title:"Opslaan",children:p.jsx(Wl,{size:14})}),p.jsx("button",{onClick:M,className:"p-0.5 text-gray-400 hover:bg-gray-100 rounded",title:"Annuleren",children:p.jsx(Qi,{size:14})})]}):p.jsxs(p.Fragment,{children:[p.jsxs("div",{className:"flex items-center gap-1",children:[p.jsx("span",{className:"text-sm text-gray-700 truncate",children:n.name}),p.jsx("button",{onClick:()=>u(!0),className:"p-0.5 text-gray-400 hover:text-blue-500 opacity-0 group-hover:opacity-100 transition-opacity",title:"Naam wijzigen",children:p.jsx(Tp,{size:12})})]}),p.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-400",children:[p.jsxs("span",{children:[E," ",E===1?"feature":"features"]}),T.length>0&&p.jsxs(p.Fragment,{children:[p.jsx("span",{className:"mx-0.5",children:""}),p.jsx("span",{children:T.join(", ")})]})]})]})})]}),p.jsxs("div",{className:"flex items-center gap-1",children:[p.jsx("button",{onClick:()=>t(n.id),className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:n.visible?n.color:"white",border:`2px solid ${n.visible?n.color:"#9ca3af"}`},title:n.visible?"Verbergen":"Tonen",children:n.visible&&p.jsx("svg",{width:"10",height:"10",viewBox:"0 0 10 10",children:p.jsx("path",{d:"M2 5 L4 7 L8 3",stroke:"white",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})})}),p.jsx("button",{onClick:b,className:`p-1 rounded transition-colors border-0 outline-none ${a?"text-white bg-red-500 hover:bg-red-600":"text-gray-400 hover:text-red-500 hover:bg-red-50"}`,title:a?"Klik nogmaals om te verwijderen":"Verwijderen",children:p.jsx(pd,{size:14})})]})]})}function Doe(){const{themesPanelOpen:n,toggleThemesPanel:e,toggleSettingsPanel:t}=Or(),{layers:r,toggleVisibility:i}=Yi(),s=_1(h=>h.layers),a=ie.useRef(null),o=Fr(h=>h.layerPanelFontScale),l=Fr(h=>h.setLayerPanelFontScale),u=13*o/100;return ie.useEffect(()=>{if(!n)return;const h=g=>{a.current&&!a.current.contains(g.target)&&e()},f=setTimeout(()=>{document.addEventListener("click",h)},100);return()=>{clearTimeout(f),document.removeEventListener("click",h)}},[n,e]),p.jsx(jr,{children:n&&p.jsxs(Ft.div,{ref:a,className:"fixed top-2.5 right-2 z-[1101] bg-white rounded-lg shadow-lg overflow-hidden w-[300px] max-h-[calc(100vh-200px)] flex flex-col",initial:{opacity:0,x:10},animate:{opacity:1,x:0},exit:{opacity:0,x:10},transition:{duration:.15},children:[p.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-blue-500",style:{fontSize:`${u}px`},children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(to,{size:14,className:"text-white"}),p.jsx("span",{className:"font-medium text-white",children:"Kaartlagen"})]}),p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("span",{className:"text-[10px] text-blue-200",children:"T"}),p.jsx("input",{type:"range",min:"80",max:"130",step:"10",value:o,onInput:h=>{l(parseInt(h.target.value))},onChange:h=>l(parseInt(h.target.value)),className:"w-20 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${o}%`}),p.jsx("span",{className:"text-xs text-blue-200",children:"T"}),p.jsx("button",{onClick:e,className:"p-0.5 rounded border-0 outline-none bg-blue-400/50 hover:bg-blue-400 transition-colors ml-1",children:p.jsx(Qi,{size:16,className:"text-white",strokeWidth:2.5})})]})]}),p.jsxs("div",{className:"p-2 overflow-y-auto flex-1",style:{fontSize:`${u}px`},children:[r.filter(h=>!h.archived).length>0&&p.jsxs("div",{className:"mb-2 pb-1 border-b border-gray-100",children:[p.jsx("div",{className:"flex items-center gap-1 py-0.5 px-1 mb-1",children:p.jsx("span",{className:"text-orange-600 font-medium",style:{fontSize:"0.9em"},children:"Mijn lagen"})}),r.filter(h=>!h.archived).map(h=>p.jsxs("button",{onClick:f=>{f.stopPropagation(),i(h.id)},className:`w-full flex items-center justify-between py-1 pl-3 pr-2 border-0 outline-none transition-colors text-left ${h.visible?"bg-orange-50 hover:bg-orange-100":"bg-transparent hover:bg-orange-50"}`,style:{fontSize:"inherit"},children:[p.jsxs("span",{className:"flex items-center gap-2 text-gray-600",children:[h.name,p.jsxs("span",{className:"text-xs text-gray-400",children:["(",h.points.length,")"]})]}),p.jsx("div",{className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:h.visible?"#f97316":"white",border:h.visible?"2px solid #f97316":"2px solid #fb923c",color:"white"},children:h.visible&&p.jsx(Wl,{size:12,strokeWidth:3})})]},h.id))]}),s.length>0&&p.jsxs("div",{className:"mb-2 pb-1 border-b border-gray-100",children:[p.jsxs("div",{className:"flex items-center gap-1 py-0.5 px-1 mb-1",children:[p.jsx(Ow,{size:12,className:"text-cyan-600"}),p.jsx("span",{className:"text-cyan-600 font-medium",style:{fontSize:"0.9em"},children:"Gemporteerde lagen"})]}),s.map(h=>p.jsx(P9,{layer:h,compact:!0},h.id)),p.jsx("button",{onClick:()=>{e(),t()},className:"w-full text-left py-1 pl-3 text-xs text-cyan-500 hover:text-cyan-700 hover:bg-cyan-50 transition-colors",children:"+ Laag importeren..."})]}),p.jsxs("div",{className:"mb-2",children:[p.jsx("div",{className:"flex items-center gap-1 py-1 px-1 mb-1",children:p.jsx("span",{className:"text-blue-600 font-medium",style:{fontSize:"0.95em"},children:"Basislaag"})}),p.jsxs("div",{className:"space-y-0",children:[p.jsx(lt,{name:"CartoDB (licht)",type:"base"}),p.jsx(lt,{name:"OpenStreetMap",type:"base"}),p.jsx(lt,{name:"Luchtfoto",type:"base",hasOverlay:!0}),p.jsx(lt,{name:"TMK 1850",type:"base",hasOverlay:!0}),p.jsx(lt,{name:"Bonnebladen 1900",type:"base",hasOverlay:!0})]})]}),p.jsxs("div",{className:"mb-2",children:[p.jsx("div",{className:"flex items-center gap-1 py-1 px-1 mb-1 border-t border-gray-100 pt-2",children:p.jsx("span",{className:"text-blue-600 font-medium",style:{fontSize:"0.95em"},children:"Thema's"})}),p.jsxs(Qr,{title:"Steentijd & Prehistorie",defaultExpanded:!1,layerNames:["Hunebedden","FAMKE Steentijd","Grafheuvels","Terpen","Paleokaart 9000 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 500 v.Chr.","Paleokaart 100 n.Chr.","Paleokaart 800 n.Chr."],children:[p.jsx(lt,{name:"Hunebedden",type:"overlay"}),p.jsx(lt,{name:"FAMKE Steentijd",type:"overlay"}),p.jsx(lt,{name:"Grafheuvels",type:"overlay"}),p.jsx(lt,{name:"Terpen",type:"overlay"}),p.jsxs(Qr,{title:"Paleokaarten (tijdreizen)",defaultExpanded:!1,layerNames:["Paleokaart 9000 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 500 v.Chr.","Paleokaart 100 n.Chr.","Paleokaart 800 n.Chr."],children:[p.jsx(lt,{name:"Paleokaart 9000 v.Chr.",type:"overlay"}),p.jsx(lt,{name:"Paleokaart 5500 v.Chr.",type:"overlay"}),p.jsx(lt,{name:"Paleokaart 2750 v.Chr.",type:"overlay"}),p.jsx(lt,{name:"Paleokaart 1500 v.Chr.",type:"overlay"}),p.jsx(lt,{name:"Paleokaart 500 v.Chr.",type:"overlay"}),p.jsx(lt,{name:"Paleokaart 100 n.Chr.",type:"overlay"}),p.jsx(lt,{name:"Paleokaart 800 n.Chr.",type:"overlay"})]})]}),p.jsxs(Qr,{title:"Archeologische lagen",defaultExpanded:!1,layerNames:["AMK Monumenten","AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig","Archeo Onderzoeken","Romeinse wegen (regio)","Romeinse wegen (Wereld)","Romeinse Forten","Romeinse Forten Lijnen","IKAW","Archeo Landschappen","UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling"],children:[p.jsx(lt,{name:"AMK Monumenten",type:"overlay"}),p.jsxs(Qr,{title:"AMK per periode",defaultExpanded:!1,layerNames:["AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig"],children:[p.jsx(lt,{name:"AMK Romeins",type:"overlay"}),p.jsx(lt,{name:"AMK Steentijd",type:"overlay"}),p.jsx(lt,{name:"AMK Vroege ME",type:"overlay"}),p.jsx(lt,{name:"AMK Late ME",type:"overlay"}),p.jsx(lt,{name:"AMK Overig",type:"overlay"})]}),p.jsx(lt,{name:"Archeo Onderzoeken",type:"overlay"}),p.jsxs(Qr,{title:"Romeinse tijd",defaultExpanded:!1,layerNames:["Romeinse wegen (regio)","Romeinse wegen (Wereld)","Romeinse Forten","Romeinse Forten Lijnen"],children:[p.jsxs(Qr,{title:"Romeinse wegen",defaultExpanded:!1,layerNames:["Romeinse wegen (regio)","Romeinse wegen (Wereld)"],children:[p.jsx(lt,{name:"Romeinse wegen (regio)",type:"overlay"}),p.jsx(lt,{name:"Romeinse wegen (Wereld)",type:"overlay"})]}),p.jsxs(Qr,{title:"Romeinse forten",defaultExpanded:!1,layerNames:["Romeinse Forten","Romeinse Forten Lijnen"],children:[p.jsx(lt,{name:"Romeinse Forten",type:"overlay"}),p.jsx(lt,{name:"Romeinse Forten Lijnen",type:"overlay"})]})]}),p.jsx(lt,{name:"IKAW",type:"overlay"}),p.jsx(lt,{name:"Archeo Landschappen",type:"overlay"}),p.jsxs(Qr,{title:"Verwachtingen uiterwaarden",defaultExpanded:!1,layerNames:["UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling"],children:[p.jsx(lt,{name:"UIKAV Punten",type:"overlay"}),p.jsx(lt,{name:"UIKAV Vlakken",type:"overlay"}),p.jsx(lt,{name:"UIKAV Expert",type:"overlay"}),p.jsx(lt,{name:"UIKAV Buffer",type:"overlay"}),p.jsx(lt,{name:"UIKAV Indeling",type:"overlay"})]})]}),p.jsxs(Qr,{title:"Erfgoed & Monumenten",defaultExpanded:!1,layerNames:["Rijksmonumenten","Werelderfgoed","Religieus Erfgoed","Kastelen","Runes"],children:[p.jsx(lt,{name:"Rijksmonumenten",type:"overlay"}),p.jsx(lt,{name:"Werelderfgoed",type:"overlay"}),p.jsx(lt,{name:"Religieus Erfgoed",type:"overlay"}),p.jsx(lt,{name:"Kastelen",type:"overlay"}),p.jsx(lt,{name:"Runes",type:"overlay"})]}),p.jsxs(Qr,{title:"WOII & Militair",defaultExpanded:!1,layerNames:["WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Militaire Objecten","Inundatiegebieden"],children:[p.jsx(lt,{name:"WWII Bunkers",type:"overlay"}),p.jsx(lt,{name:"Slagvelden",type:"overlay"}),p.jsx(lt,{name:"Militaire Vliegvelden",type:"overlay"}),p.jsx(lt,{name:"Verdedigingslinies",type:"overlay"}),p.jsx(lt,{name:"Militaire Objecten",type:"overlay"}),p.jsx(lt,{name:"Inundatiegebieden",type:"overlay"})]}),p.jsxs(Qr,{title:"Hillshade & LiDAR",defaultExpanded:!1,layerNames:["AHN4 Hoogtekaart Kleur","AHN4 Hillshade NL","AHN4 Multi-Hillshade NL","AHN 0.5m"],children:[p.jsx(lt,{name:"AHN4 Hoogtekaart Kleur",type:"overlay"}),p.jsx(lt,{name:"AHN4 Hillshade NL",type:"overlay"}),p.jsx(lt,{name:"AHN4 Multi-Hillshade NL",type:"overlay"}),p.jsx(lt,{name:"AHN 0.5m",type:"overlay"})]}),p.jsxs(Qr,{title:"Terrein & Bodem",defaultExpanded:!1,layerNames:["Veengebieden","Geomorfologie","Bodemkaart","Essen"],children:[p.jsx(lt,{name:"Veengebieden",type:"overlay"}),p.jsx(lt,{name:"Geomorfologie",type:"overlay"}),p.jsx(lt,{name:"Bodemkaart",type:"overlay"}),p.jsx(lt,{name:"Essen",type:"overlay"})]}),p.jsxs(Qr,{title:"Percelen",defaultExpanded:!1,layerNames:["Gewaspercelen","Kadastrale Grenzen"],children:[p.jsx(lt,{name:"Gewaspercelen",type:"overlay"}),p.jsx(lt,{name:"Kadastrale Grenzen",type:"overlay"})]}),p.jsxs(Qr,{title:"Provinciale Thema's",defaultExpanded:!1,layerNames:["Scheepswrakken","Woonheuvels ZH","Windmolens","Erfgoedlijnen","Oude Kernen","Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken","Verdronken Dorpen"],children:[p.jsxs(Qr,{title:"Zuid-Holland",defaultExpanded:!1,layerNames:["Scheepswrakken","Woonheuvels ZH","Windmolens","Erfgoedlijnen","Oude Kernen"],children:[p.jsx(lt,{name:"Scheepswrakken",type:"overlay"}),p.jsx(lt,{name:"Woonheuvels ZH",type:"overlay"}),p.jsx(lt,{name:"Windmolens",type:"overlay"}),p.jsx(lt,{name:"Erfgoedlijnen",type:"overlay"}),p.jsx(lt,{name:"Oude Kernen",type:"overlay"})]}),p.jsxs(Qr,{title:"Gelderland",defaultExpanded:!1,layerNames:["Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken"],children:[p.jsx(lt,{name:"Relictenkaart Punten",type:"overlay"}),p.jsx(lt,{name:"Relictenkaart Lijnen",type:"overlay"}),p.jsx(lt,{name:"Relictenkaart Vlakken",type:"overlay"})]}),p.jsx(Qr,{title:"Zeeland",defaultExpanded:!1,layerNames:["Verdronken Dorpen"],children:p.jsx(lt,{name:"Verdronken Dorpen",type:"overlay"})})]}),p.jsxs(Qr,{title:"Fossielen, Mineralen & Goud",defaultExpanded:!1,layerNames:["Fossiel Hotspots","Mineralen Hotspots","Goudrivieren","Fossielen Nederland","Fossielen Belgi","Fossielen Duitsland","Fossielen Frankrijk"],children:[p.jsx(lt,{name:"Fossiel Hotspots",type:"overlay"}),p.jsx(lt,{name:"Mineralen Hotspots",type:"overlay"}),p.jsx(lt,{name:"Goudrivieren",type:"overlay"}),p.jsx(lt,{name:"Fossielen Nederland",type:"overlay"}),p.jsx(lt,{name:"Fossielen Belgi",type:"overlay"}),p.jsx(lt,{name:"Fossielen Duitsland",type:"overlay"}),p.jsx(lt,{name:"Fossielen Frankrijk",type:"overlay"})]}),p.jsxs(Qr,{title:"Recreatie",defaultExpanded:!1,layerNames:["Wandelroutes","Parken","Speeltuinen","Musea","Strandjes","Kringloopwinkels"],children:[p.jsx(lt,{name:"Wandelroutes",type:"overlay"}),p.jsx(lt,{name:"Parken",type:"overlay"}),p.jsx(lt,{name:"Speeltuinen",type:"overlay"}),p.jsx(lt,{name:"Musea",type:"overlay"}),p.jsx(lt,{name:"Strandjes",type:"overlay"}),p.jsx(lt,{name:"Kringloopwinkels",type:"overlay"})]})]})]})]})})}function Foe(n){n("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),n("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),n("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs");for(var e=1;e<=60;++e)n("EPSG:"+(32600+e),"+proj=utm +zone="+e+" +datum=WGS84 +units=m"),n("EPSG:"+(32700+e),"+proj=utm +zone="+e+" +south +datum=WGS84 +units=m");n("EPSG:5041","+title=WGS 84 / UPS North (E,N) +proj=stere +lat_0=90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m"),n("EPSG:5042","+title=WGS 84 / UPS South (E,N) +proj=stere +lat_0=-90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m"),n.WGS84=n["EPSG:4326"],n["EPSG:3785"]=n["EPSG:3857"],n.GOOGLE=n["EPSG:3857"],n["EPSG:900913"]=n["EPSG:3857"],n["EPSG:102113"]=n["EPSG:3857"]}var Jh=1,ed=2,Qf=3,joe=4,Ib=5,_L=6378137,Voe=6356752314e-3,xL=.0066943799901413165,Rm=484813681109536e-20,We=Math.PI/2,Goe=.16666666666666666,Boe=.04722222222222222,Uoe=.022156084656084655,st=1e-10,br=.017453292519943295,As=57.29577951308232,Ln=Math.PI/4,bp=Math.PI*2,Lr=3.14159265359,Ms={};Ms.greenwich=0;Ms.lisbon=-9.131906111111;Ms.paris=2.337229166667;Ms.bogota=-74.080916666667;Ms.madrid=-3.687938888889;Ms.rome=12.452333333333;Ms.bern=7.439583333333;Ms.jakarta=106.807719444444;Ms.ferro=-17.666666666667;Ms.brussels=4.367975;Ms.stockholm=18.058277777778;Ms.athens=23.7163375;Ms.oslo=10.722916666667;const zoe={mm:{to_meter:.001},cm:{to_meter:.01},ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937},fath:{to_meter:1.8288},kmi:{to_meter:1852},"us-ch":{to_meter:20.1168402336805},"us-mi":{to_meter:1609.34721869444},km:{to_meter:1e3},"ind-ft":{to_meter:.30479841},"ind-yd":{to_meter:.91439523},mi:{to_meter:1609.344},yd:{to_meter:.9144},ch:{to_meter:20.1168},link:{to_meter:.201168},dm:{to_meter:.1},in:{to_meter:.0254},"ind-ch":{to_meter:20.11669506},"us-in":{to_meter:.025400050800101},"us-yd":{to_meter:.914401828803658}};var vL=/[\s_\-\/\(\)]/g;function yu(n,e){if(n[e])return n[e];for(var t=Object.keys(n),r=e.toLowerCase().replace(vL,""),i=-1,s,a;++i<t.length;)if(s=t[i],a=s.toLowerCase().replace(vL,""),a===r)return n[s]}function Ab(n){var e={},t=n.split("+").map(function(o){return o.trim()}).filter(function(o){return o}).reduce(function(o,l){var u=l.split("=");return u.push(!0),o[u[0].toLowerCase()]=u[1],o},{}),r,i,s,a={proj:"projName",datum:"datumCode",rf:function(o){e.rf=parseFloat(o)},lat_0:function(o){e.lat0=o*br},lat_1:function(o){e.lat1=o*br},lat_2:function(o){e.lat2=o*br},lat_ts:function(o){e.lat_ts=o*br},lon_0:function(o){e.long0=o*br},lon_1:function(o){e.long1=o*br},lon_2:function(o){e.long2=o*br},alpha:function(o){e.alpha=parseFloat(o)*br},gamma:function(o){e.rectified_grid_angle=parseFloat(o)*br},lonc:function(o){e.longc=o*br},x_0:function(o){e.x0=parseFloat(o)},y_0:function(o){e.y0=parseFloat(o)},k_0:function(o){e.k0=parseFloat(o)},k:function(o){e.k0=parseFloat(o)},a:function(o){e.a=parseFloat(o)},b:function(o){e.b=parseFloat(o)},r:function(o){e.a=e.b=parseFloat(o)},r_a:function(){e.R_A=!0},zone:function(o){e.zone=parseInt(o,10)},south:function(){e.utmSouth=!0},towgs84:function(o){e.datum_params=o.split(",").map(function(l){return parseFloat(l)})},to_meter:function(o){e.to_meter=parseFloat(o)},units:function(o){e.units=o;var l=yu(zoe,o);l&&(e.to_meter=l.to_meter)},from_greenwich:function(o){e.from_greenwich=o*br},pm:function(o){var l=yu(Ms,o);e.from_greenwich=(l||parseFloat(o))*br},nadgrids:function(o){o==="@null"?e.datumCode="none":e.nadgrids=o},axis:function(o){var l="ewnsud";o.length===3&&l.indexOf(o.substr(0,1))!==-1&&l.indexOf(o.substr(1,1))!==-1&&l.indexOf(o.substr(2,1))!==-1&&(e.axis=o)},approx:function(){e.approx=!0},over:function(){e.over=!0}};for(r in t)i=t[r],r in a?(s=a[r],typeof s=="function"?s(i):e[s]=i):e[r]=i;return typeof e.datumCode=="string"&&e.datumCode!=="WGS84"&&(e.datumCode=e.datumCode.toLowerCase()),e.projStr=n,e}class k9{static getId(e){const t=e.find(r=>Array.isArray(r)&&r[0]==="ID");return t&&t.length>=3?{authority:t[1],code:parseInt(t[2],10)}:null}static convertUnit(e,t="unit"){if(!e||e.length<3)return{type:t,name:"unknown",conversion_factor:null};const r=e[1],i=parseFloat(e[2])||null,s=e.find(o=>Array.isArray(o)&&o[0]==="ID"),a=s?{authority:s[1],code:parseInt(s[2],10)}:null;return{type:t,name:r,conversion_factor:i,id:a}}static convertAxis(e){const t=e[1]||"Unknown";let r;const i=t.match(/^\((.)\)$/);if(i){const u=i[1].toUpperCase();if(u==="E")r="east";else if(u==="N")r="north";else if(u==="U")r="up";else throw new Error(`Unknown axis abbreviation: ${u}`)}else r=e[2]?e[2].toLowerCase():"unknown";const s=e.find(u=>Array.isArray(u)&&u[0]==="ORDER"),a=s?parseInt(s[1],10):null,o=e.find(u=>Array.isArray(u)&&(u[0]==="LENGTHUNIT"||u[0]==="ANGLEUNIT"||u[0]==="SCALEUNIT")),l=this.convertUnit(o);return{name:t,direction:r,unit:l,order:a}}static extractAxes(e){return e.filter(t=>Array.isArray(t)&&t[0]==="AXIS").map(t=>this.convertAxis(t)).sort((t,r)=>(t.order||0)-(r.order||0))}static convert(e,t={}){switch(e[0]){case"PROJCRS":t.type="ProjectedCRS",t.name=e[1],t.base_crs=e.find(g=>Array.isArray(g)&&g[0]==="BASEGEOGCRS")?this.convert(e.find(g=>Array.isArray(g)&&g[0]==="BASEGEOGCRS")):null,t.conversion=e.find(g=>Array.isArray(g)&&g[0]==="CONVERSION")?this.convert(e.find(g=>Array.isArray(g)&&g[0]==="CONVERSION")):null;const r=e.find(g=>Array.isArray(g)&&g[0]==="CS");r&&(t.coordinate_system={type:r[1],axis:this.extractAxes(e)});const i=e.find(g=>Array.isArray(g)&&g[0]==="LENGTHUNIT");if(i){const g=this.convertUnit(i);t.coordinate_system.unit=g}t.id=this.getId(e);break;case"BASEGEOGCRS":case"GEOGCRS":t.type="GeographicCRS",t.name=e[1];const s=e.find(g=>Array.isArray(g)&&(g[0]==="DATUM"||g[0]==="ENSEMBLE"));if(s){const g=this.convert(s);s[0]==="ENSEMBLE"?t.datum_ensemble=g:t.datum=g;const y=e.find(v=>Array.isArray(v)&&v[0]==="PRIMEM");y&&y[1]!=="Greenwich"&&(g.prime_meridian={name:y[1],longitude:parseFloat(y[2])})}t.coordinate_system={type:"ellipsoidal",axis:this.extractAxes(e)},t.id=this.getId(e);break;case"DATUM":t.type="GeodeticReferenceFrame",t.name=e[1],t.ellipsoid=e.find(g=>Array.isArray(g)&&g[0]==="ELLIPSOID")?this.convert(e.find(g=>Array.isArray(g)&&g[0]==="ELLIPSOID")):null;break;case"ENSEMBLE":t.type="DatumEnsemble",t.name=e[1],t.members=e.filter(g=>Array.isArray(g)&&g[0]==="MEMBER").map(g=>({type:"DatumEnsembleMember",name:g[1],id:this.getId(g)}));const a=e.find(g=>Array.isArray(g)&&g[0]==="ENSEMBLEACCURACY");a&&(t.accuracy=parseFloat(a[1]));const o=e.find(g=>Array.isArray(g)&&g[0]==="ELLIPSOID");o&&(t.ellipsoid=this.convert(o)),t.id=this.getId(e);break;case"ELLIPSOID":t.type="Ellipsoid",t.name=e[1],t.semi_major_axis=parseFloat(e[2]),t.inverse_flattening=parseFloat(e[3]),e.find(g=>Array.isArray(g)&&g[0]==="LENGTHUNIT")&&this.convert(e.find(g=>Array.isArray(g)&&g[0]==="LENGTHUNIT"),t);break;case"CONVERSION":t.type="Conversion",t.name=e[1],t.method=e.find(g=>Array.isArray(g)&&g[0]==="METHOD")?this.convert(e.find(g=>Array.isArray(g)&&g[0]==="METHOD")):null,t.parameters=e.filter(g=>Array.isArray(g)&&g[0]==="PARAMETER").map(g=>this.convert(g));break;case"METHOD":t.type="Method",t.name=e[1],t.id=this.getId(e);break;case"PARAMETER":t.type="Parameter",t.name=e[1],t.value=parseFloat(e[2]),t.unit=this.convertUnit(e.find(g=>Array.isArray(g)&&(g[0]==="LENGTHUNIT"||g[0]==="ANGLEUNIT"||g[0]==="SCALEUNIT"))),t.id=this.getId(e);break;case"BOUNDCRS":t.type="BoundCRS";const l=e.find(g=>Array.isArray(g)&&g[0]==="SOURCECRS");if(l){const g=l.find(y=>Array.isArray(y));t.source_crs=g?this.convert(g):null}const u=e.find(g=>Array.isArray(g)&&g[0]==="TARGETCRS");if(u){const g=u.find(y=>Array.isArray(y));t.target_crs=g?this.convert(g):null}const h=e.find(g=>Array.isArray(g)&&g[0]==="ABRIDGEDTRANSFORMATION");h?t.transformation=this.convert(h):t.transformation=null;break;case"ABRIDGEDTRANSFORMATION":if(t.type="Transformation",t.name=e[1],t.method=e.find(g=>Array.isArray(g)&&g[0]==="METHOD")?this.convert(e.find(g=>Array.isArray(g)&&g[0]==="METHOD")):null,t.parameters=e.filter(g=>Array.isArray(g)&&(g[0]==="PARAMETER"||g[0]==="PARAMETERFILE")).map(g=>{if(g[0]==="PARAMETER")return this.convert(g);if(g[0]==="PARAMETERFILE")return{name:g[1],value:g[2],id:{authority:"EPSG",code:8656}}}),t.parameters.length===7){const g=t.parameters[6];g.name==="Scale difference"&&(g.value=Math.round((g.value-1)*1e12)/1e6)}t.id=this.getId(e);break;case"AXIS":t.coordinate_system||(t.coordinate_system={type:"unspecified",axis:[]}),t.coordinate_system.axis.push(this.convertAxis(e));break;case"LENGTHUNIT":const f=this.convertUnit(e,"LinearUnit");t.coordinate_system&&t.coordinate_system.axis&&t.coordinate_system.axis.forEach(g=>{g.unit||(g.unit=f)}),f.conversion_factor&&f.conversion_factor!==1&&t.semi_major_axis&&(t.semi_major_axis={value:t.semi_major_axis,unit:f});break;default:t.keyword=e[0];break}return t}}class $oe extends k9{static convert(e,t={}){return super.convert(e,t),t.coordinate_system&&t.coordinate_system.subtype==="Cartesian"&&delete t.coordinate_system,t.usage&&delete t.usage,t}}class Woe extends k9{static convert(e,t={}){super.convert(e,t);const r=e.find(s=>Array.isArray(s)&&s[0]==="CS");r&&(t.coordinate_system={subtype:r[1],axis:this.extractAxes(e)});const i=e.find(s=>Array.isArray(s)&&s[0]==="USAGE");if(i){const s=i.find(l=>Array.isArray(l)&&l[0]==="SCOPE"),a=i.find(l=>Array.isArray(l)&&l[0]==="AREA"),o=i.find(l=>Array.isArray(l)&&l[0]==="BBOX");t.usage={},s&&(t.usage.scope=s[1]),a&&(t.usage.area=a[1]),o&&(t.usage.bbox=o.slice(1))}return t}}function Hoe(n){return n.find(e=>Array.isArray(e)&&e[0]==="USAGE")?"2019":(n.find(e=>Array.isArray(e)&&e[0]==="CS")||n[0]==="BOUNDCRS"||n[0]==="PROJCRS"||n[0]==="GEOGCRS","2015")}function Koe(n){return(Hoe(n)==="2019"?Woe:$oe).convert(n)}function Yoe(n){const e=n.toUpperCase();return e.includes("PROJCRS")||e.includes("GEOGCRS")||e.includes("BOUNDCRS")||e.includes("VERTCRS")||e.includes("LENGTHUNIT")||e.includes("ANGLEUNIT")||e.includes("SCALEUNIT")?"WKT2":(e.includes("PROJCS")||e.includes("GEOGCS")||e.includes("LOCAL_CS")||e.includes("VERT_CS")||e.includes("UNIT"),"WKT1")}var Ip=1,M9=2,N9=3,ev=4,L9=5,TR=-1,qoe=/\s/,Xoe=/[A-Za-z]/,Zoe=/[A-Za-z84_]/,Dw=/[,\]]/,O9=/[\d\.E\-\+]/;function Ql(n){if(typeof n!="string")throw new Error("not a string");this.text=n.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=Ip}Ql.prototype.readCharicter=function(){var n=this.text[this.place++];if(this.state!==ev)for(;qoe.test(n);){if(this.place>=this.text.length)return;n=this.text[this.place++]}switch(this.state){case Ip:return this.neutral(n);case M9:return this.keyword(n);case ev:return this.quoted(n);case L9:return this.afterquote(n);case N9:return this.number(n);case TR:return}};Ql.prototype.afterquote=function(n){if(n==='"'){this.word+='"',this.state=ev;return}if(Dw.test(n)){this.word=this.word.trim(),this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in afterquote yet, index '+this.place)};Ql.prototype.afterItem=function(n){if(n===","){this.word!==null&&this.currentObject.push(this.word),this.word=null,this.state=Ip;return}if(n==="]"){this.level--,this.word!==null&&(this.currentObject.push(this.word),this.word=null),this.state=Ip,this.currentObject=this.stack.pop(),this.currentObject||(this.state=TR);return}};Ql.prototype.number=function(n){if(O9.test(n)){this.word+=n;return}if(Dw.test(n)){this.word=parseFloat(this.word),this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in number yet, index '+this.place)};Ql.prototype.quoted=function(n){if(n==='"'){this.state=L9;return}this.word+=n};Ql.prototype.keyword=function(n){if(Zoe.test(n)){this.word+=n;return}if(n==="["){var e=[];e.push(this.word),this.level++,this.root===null?this.root=e:this.currentObject.push(e),this.stack.push(this.currentObject),this.currentObject=e,this.state=Ip;return}if(Dw.test(n)){this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in keyword yet, index '+this.place)};Ql.prototype.neutral=function(n){if(Xoe.test(n)){this.word=n,this.state=M9;return}if(n==='"'){this.word="",this.state=ev;return}if(O9.test(n)){this.word=n,this.state=N9;return}if(Dw.test(n)){this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in neutral yet, index '+this.place)};Ql.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===TR)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function Qoe(n){var e=new Ql(n);return e.output()}function PS(n,e,t){Array.isArray(e)&&(t.unshift(e),e=null);var r=e?{}:n,i=t.reduce(function(s,a){return Ff(a,s),s},r);e&&(n[e]=i)}function Ff(n,e){if(!Array.isArray(n)){e[n]=!0;return}var t=n.shift();if(t==="PARAMETER"&&(t=n.shift()),n.length===1){if(Array.isArray(n[0])){e[t]={},Ff(n[0],e[t]);return}e[t]=n[0];return}if(!n.length){e[t]=!0;return}if(t==="TOWGS84"){e[t]=n;return}if(t==="AXIS"){t in e||(e[t]=[]),e[t].push(n);return}Array.isArray(t)||(e[t]={});var r;switch(t){case"UNIT":case"PRIMEM":case"VERT_DATUM":e[t]={name:n[0].toLowerCase(),convert:n[1]},n.length===3&&Ff(n[2],e[t]);return;case"SPHEROID":case"ELLIPSOID":e[t]={name:n[0],a:n[1],rf:n[2]},n.length===4&&Ff(n[3],e[t]);return;case"EDATUM":case"ENGINEERINGDATUM":case"LOCAL_DATUM":case"DATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":n[0]=["name",n[0]],PS(e,t,n);return;case"COMPD_CS":case"COMPOUNDCRS":case"FITTED_CS":case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"ENGCRS":case"ENGINEERINGCRS":n[0]=["name",n[0]],PS(e,t,n),e[t].type=t;return;default:for(r=-1;++r<n.length;)if(!Array.isArray(n[r]))return Ff(n,e[t]);return PS(e,t,n)}}var Joe=.017453292519943295;function Ua(n){return n*Joe}function D9(n){const e=(n.projName||"").toLowerCase().replace(/_/g," ");!n.long0&&n.longc&&(e==="albers conic equal area"||e==="lambert azimuthal equal area")&&(n.long0=n.longc),!n.lat_ts&&n.lat1&&(e==="stereographic south pole"||e==="polar stereographic (variant b)")?(n.lat0=Ua(n.lat1>0?90:-90),n.lat_ts=n.lat1,delete n.lat1):!n.lat_ts&&n.lat0&&(e==="polar stereographic"||e==="polar stereographic (variant a)")&&(n.lat_ts=n.lat0,n.lat0=Ua(n.lat0>0?90:-90),delete n.lat1)}function wL(n){let e={units:null,to_meter:void 0};return typeof n=="string"?(e.units=n.toLowerCase(),e.units==="metre"&&(e.units="meter"),e.units==="meter"&&(e.to_meter=1)):n&&n.name&&(e.units=n.name.toLowerCase(),e.units==="metre"&&(e.units="meter"),e.to_meter=n.conversion_factor),e}function EL(n){return typeof n=="object"?n.value*n.unit.conversion_factor:n}function SL(n,e){n.ellipsoid.radius?(e.a=n.ellipsoid.radius,e.rf=0):(e.a=EL(n.ellipsoid.semi_major_axis),n.ellipsoid.inverse_flattening!==void 0?e.rf=n.ellipsoid.inverse_flattening:n.ellipsoid.semi_major_axis!==void 0&&n.ellipsoid.semi_minor_axis!==void 0&&(e.rf=e.a/(e.a-EL(n.ellipsoid.semi_minor_axis))))}function tv(n,e={}){return!n||typeof n!="object"?n:n.type==="BoundCRS"?(tv(n.source_crs,e),n.transformation&&(n.transformation.method&&n.transformation.method.name==="NTv2"?e.nadgrids=n.transformation.parameters[0].value:e.datum_params=n.transformation.parameters.map(t=>t.value)),e):(Object.keys(n).forEach(t=>{const r=n[t];if(r!==null)switch(t){case"name":if(e.srsCode)break;e.name=r,e.srsCode=r;break;case"type":r==="GeographicCRS"?e.projName="longlat":r==="ProjectedCRS"&&n.conversion&&n.conversion.method&&(e.projName=n.conversion.method.name);break;case"datum":case"datum_ensemble":r.ellipsoid&&(e.ellps=r.ellipsoid.name,SL(r,e)),r.prime_meridian&&(e.from_greenwich=r.prime_meridian.longitude*Math.PI/180);break;case"ellipsoid":e.ellps=r.name,SL(r,e);break;case"prime_meridian":e.long0=(r.longitude||0)*Math.PI/180;break;case"coordinate_system":if(r.axis){if(e.axis=r.axis.map(i=>{const s=i.direction;if(s==="east")return"e";if(s==="north")return"n";if(s==="west")return"w";if(s==="south")return"s";throw new Error(`Unknown axis direction: ${s}`)}).join("")+"u",r.unit){const{units:i,to_meter:s}=wL(r.unit);e.units=i,e.to_meter=s}else if(r.axis[0]&&r.axis[0].unit){const{units:i,to_meter:s}=wL(r.axis[0].unit);e.units=i,e.to_meter=s}}break;case"id":r.authority&&r.code&&(e.title=r.authority+":"+r.code);break;case"conversion":r.method&&r.method.name&&(e.projName=r.method.name),r.parameters&&r.parameters.forEach(i=>{const s=i.name.toLowerCase().replace(/\s+/g,"_"),a=i.value;i.unit&&i.unit.conversion_factor?e[s]=a*i.unit.conversion_factor:i.unit==="degree"?e[s]=a*Math.PI/180:e[s]=a});break;case"unit":r.name&&(e.units=r.name.toLowerCase(),e.units==="metre"&&(e.units="meter")),r.conversion_factor&&(e.to_meter=r.conversion_factor);break;case"base_crs":tv(r,e),e.datumCode=r.id?r.id.authority+"_"+r.id.code:r.name;break}}),e.latitude_of_false_origin!==void 0&&(e.lat0=e.latitude_of_false_origin),e.longitude_of_false_origin!==void 0&&(e.long0=e.longitude_of_false_origin),e.latitude_of_standard_parallel!==void 0&&(e.lat0=e.latitude_of_standard_parallel,e.lat1=e.latitude_of_standard_parallel),e.latitude_of_1st_standard_parallel!==void 0&&(e.lat1=e.latitude_of_1st_standard_parallel),e.latitude_of_2nd_standard_parallel!==void 0&&(e.lat2=e.latitude_of_2nd_standard_parallel),e.latitude_of_projection_centre!==void 0&&(e.lat0=e.latitude_of_projection_centre),e.longitude_of_projection_centre!==void 0&&(e.longc=e.longitude_of_projection_centre),e.easting_at_false_origin!==void 0&&(e.x0=e.easting_at_false_origin),e.northing_at_false_origin!==void 0&&(e.y0=e.northing_at_false_origin),e.latitude_of_natural_origin!==void 0&&(e.lat0=e.latitude_of_natural_origin),e.longitude_of_natural_origin!==void 0&&(e.long0=e.longitude_of_natural_origin),e.longitude_of_origin!==void 0&&(e.long0=e.longitude_of_origin),e.false_easting!==void 0&&(e.x0=e.false_easting),e.easting_at_projection_centre&&(e.x0=e.easting_at_projection_centre),e.false_northing!==void 0&&(e.y0=e.false_northing),e.northing_at_projection_centre&&(e.y0=e.northing_at_projection_centre),e.standard_parallel_1!==void 0&&(e.lat1=e.standard_parallel_1),e.standard_parallel_2!==void 0&&(e.lat2=e.standard_parallel_2),e.scale_factor_at_natural_origin!==void 0&&(e.k0=e.scale_factor_at_natural_origin),e.scale_factor_at_projection_centre!==void 0&&(e.k0=e.scale_factor_at_projection_centre),e.scale_factor_on_pseudo_standard_parallel!==void 0&&(e.k0=e.scale_factor_on_pseudo_standard_parallel),e.azimuth!==void 0&&(e.alpha=e.azimuth),e.azimuth_at_projection_centre!==void 0&&(e.alpha=e.azimuth_at_projection_centre),e.angle_from_rectified_to_skew_grid&&(e.rectified_grid_angle=e.angle_from_rectified_to_skew_grid),D9(e),e)}var ele=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function tle(n,e){var t=e[0],r=e[1];!(t in n)&&r in n&&(n[t]=n[r],e.length===3&&(n[t]=e[2](n[t])))}function F9(n){for(var e=Object.keys(n),t=0,r=e.length;t<r;++t){var i=e[t];ele.indexOf(i)!==-1&&nle(n[i]),typeof n[i]=="object"&&F9(n[i])}}function nle(n){if(n.AUTHORITY){var e=Object.keys(n.AUTHORITY)[0];e&&e in n.AUTHORITY&&(n.title=e+":"+n.AUTHORITY[e])}if(n.type==="GEOGCS"?n.projName="longlat":n.type==="LOCAL_CS"?(n.projName="identity",n.local=!0):typeof n.PROJECTION=="object"?n.projName=Object.keys(n.PROJECTION)[0]:n.projName=n.PROJECTION,n.AXIS){for(var t="",r=0,i=n.AXIS.length;r<i;++r){var s=[n.AXIS[r][0].toLowerCase(),n.AXIS[r][1].toLowerCase()];s[0].indexOf("north")!==-1||(s[0]==="y"||s[0]==="lat")&&s[1]==="north"?t+="n":s[0].indexOf("south")!==-1||(s[0]==="y"||s[0]==="lat")&&s[1]==="south"?t+="s":s[0].indexOf("east")!==-1||(s[0]==="x"||s[0]==="lon")&&s[1]==="east"?t+="e":(s[0].indexOf("west")!==-1||(s[0]==="x"||s[0]==="lon")&&s[1]==="west")&&(t+="w")}t.length===2&&(t+="u"),t.length===3&&(n.axis=t)}n.UNIT&&(n.units=n.UNIT.name.toLowerCase(),n.units==="metre"&&(n.units="meter"),n.UNIT.convert&&(n.type==="GEOGCS"?n.DATUM&&n.DATUM.SPHEROID&&(n.to_meter=n.UNIT.convert*n.DATUM.SPHEROID.a):n.to_meter=n.UNIT.convert));var a=n.GEOGCS;n.type==="GEOGCS"&&(a=n),a&&(a.DATUM?n.datumCode=a.DATUM.name.toLowerCase():n.datumCode=a.name.toLowerCase(),n.datumCode.slice(0,2)==="d_"&&(n.datumCode=n.datumCode.slice(2)),n.datumCode==="new_zealand_1949"&&(n.datumCode="nzgd49"),(n.datumCode==="wgs_1984"||n.datumCode==="world_geodetic_system_1984")&&(n.PROJECTION==="Mercator_Auxiliary_Sphere"&&(n.sphere=!0),n.datumCode="wgs84"),n.datumCode==="belge_1972"&&(n.datumCode="rnb72"),a.DATUM&&a.DATUM.SPHEROID&&(n.ellps=a.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),n.ellps.toLowerCase().slice(0,13)==="international"&&(n.ellps="intl"),n.a=a.DATUM.SPHEROID.a,n.rf=parseFloat(a.DATUM.SPHEROID.rf,10)),a.DATUM&&a.DATUM.TOWGS84&&(n.datum_params=a.DATUM.TOWGS84),~n.datumCode.indexOf("osgb_1936")&&(n.datumCode="osgb36"),~n.datumCode.indexOf("osni_1952")&&(n.datumCode="osni52"),(~n.datumCode.indexOf("tm65")||~n.datumCode.indexOf("geodetic_datum_of_1965"))&&(n.datumCode="ire65"),n.datumCode==="ch1903+"&&(n.datumCode="ch1903"),~n.datumCode.indexOf("israel")&&(n.datumCode="isr93")),n.b&&!isFinite(n.b)&&(n.b=n.a),n.rectified_grid_angle&&(n.rectified_grid_angle=Ua(n.rectified_grid_angle));function o(h){var f=n.to_meter||1;return h*f}var l=function(h){return tle(n,h)},u=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",Ua],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",Ua],["x0","false_easting",o],["y0","false_northing",o],["long0","central_meridian",Ua],["lat0","latitude_of_origin",Ua],["lat0","standard_parallel_1",Ua],["lat1","standard_parallel_1",Ua],["lat2","standard_parallel_2",Ua],["azimuth","Azimuth"],["alpha","azimuth",Ua],["srsCode","name"]];u.forEach(l),D9(n)}function nv(n){if(typeof n=="object")return tv(n);const e=Yoe(n);var t=Qoe(n);if(e==="WKT2"){const s=Koe(t);return tv(s)}var r=t[0],i={};return Ff(t,i),F9(i),i[r]}function Ei(n){var e=this;if(arguments.length===2){var t=arguments[1];typeof t=="string"?t.charAt(0)==="+"?Ei[n]=Ab(arguments[1]):Ei[n]=nv(arguments[1]):t&&typeof t=="object"&&!("projName"in t)?Ei[n]=nv(arguments[1]):(Ei[n]=t,t||delete Ei[n])}else if(arguments.length===1){if(Array.isArray(n))return n.map(function(r){return Array.isArray(r)?Ei.apply(e,r):Ei(r)});if(typeof n=="string"){if(n in Ei)return Ei[n]}else"EPSG"in n?Ei["EPSG:"+n.EPSG]=n:"ESRI"in n?Ei["ESRI:"+n.ESRI]=n:"IAU2000"in n?Ei["IAU2000:"+n.IAU2000]=n:console.log(n);return}}Foe(Ei);function rle(n){return typeof n=="string"}function ile(n){return n in Ei}function sle(n){return n.indexOf("+")!==0&&n.indexOf("[")!==-1||typeof n=="object"&&!("srsCode"in n)}var ale=["3857","900913","3785","102113"];function ole(n){var e=yu(n,"authority");if(e){var t=yu(e,"epsg");return t&&ale.indexOf(t)>-1}}function lle(n){var e=yu(n,"extension");if(e)return yu(e,"proj4")}function cle(n){return n[0]==="+"}function ule(n){if(rle(n)){if(ile(n))return Ei[n];if(sle(n)){var e=nv(n);if(ole(e))return Ei["EPSG:3857"];var t=lle(e);return t?Ab(t):e}if(cle(n))return Ab(n)}else return"projName"in n?n:nv(n)}function TL(n,e){n=n||{};var t,r;if(!e)return n;for(r in e)t=e[r],t!==void 0&&(n[r]=t);return n}function Qo(n,e,t){var r=n*e;return t/Math.sqrt(1-r*r)}function T1(n){return n<0?-1:1}function ht(n,e){return e||Math.abs(n)<=Lr?n:n-T1(n)*bp}function no(n,e,t){var r=n*t,i=.5*n;return r=Math.pow((1-r)/(1+r),i),Math.tan(.5*(We-e))/r}function Ap(n,e){for(var t=.5*n,r,i,s=We-2*Math.atan(e),a=0;a<=15;a++)if(r=n*Math.sin(s),i=We-2*Math.atan(e*Math.pow((1-r)/(1+r),t))-s,s+=i,Math.abs(i)<=1e-10)return s;return-9999}function hle(){var n=this.b/this.a;this.es=1-n*n,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=Qo(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function dle(n){var e=n.x,t=n.y;if(t*As>90&&t*As<-90&&e*As>180&&e*As<-180)return null;var r,i;if(Math.abs(Math.abs(t)-We)<=st)return null;if(this.sphere)r=this.x0+this.a*this.k0*ht(e-this.long0,this.over),i=this.y0+this.a*this.k0*Math.log(Math.tan(Ln+.5*t));else{var s=Math.sin(t),a=no(this.e,t,s);r=this.x0+this.a*this.k0*ht(e-this.long0,this.over),i=this.y0-this.a*this.k0*Math.log(a)}return n.x=r,n.y=i,n}function fle(n){var e=n.x-this.x0,t=n.y-this.y0,r,i;if(this.sphere)i=We-2*Math.atan(Math.exp(-t/(this.a*this.k0)));else{var s=Math.exp(-t/(this.a*this.k0));if(i=Ap(this.e,s),i===-9999)return null}return r=ht(this.long0+e/(this.a*this.k0),this.over),n.x=r,n.y=i,n}var gle=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","Mercator_Variant_A","merc"];const mle={init:hle,forward:dle,inverse:fle,names:gle};function ple(){}function bL(n){return n}var j9=["longlat","identity"];const yle={init:ple,forward:bL,inverse:bL,names:j9};var _le=[mle,yle],ch={},jf=[];function V9(n,e){var t=jf.length;return n.names?(jf[t]=n,n.names.forEach(function(r){ch[r.toLowerCase()]=t}),this):(console.log(e),!0)}function G9(n){return n.replace(/[-\(\)\s]+/g," ").trim().replace(/ /g,"_")}function xle(n){if(!n)return!1;var e=n.toLowerCase();if(typeof ch[e]<"u"&&jf[ch[e]]||(e=G9(e),e in ch&&jf[ch[e]]))return jf[ch[e]]}function vle(){_le.forEach(V9)}const wle={start:vle,add:V9,get:xle};var B9={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563396e-3,b:635625691e-2,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340189e-3,b:6356034446e-3,ellipseName:"Modified Airy"},andrae:{a:637710443e-2,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397155e-3,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483865e-3,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:63782064e-1,b:63565838e-1,ellipseName:"Clarke 1866"},clrk80:{a:6378249145e-3,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk80ign:{a:63782492e-1,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"},clrk58:{a:6378293645208759e-9,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:63757387e-1,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:637813605e-2,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276345e-3,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304063e-3,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301243e-3,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295664e-3,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298556e-3,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:63781575e-1,b:63567722e-1,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:63567733205e-4,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:63558348467e-4,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"},WGS84:{a:6378137,rf:298.257223563,ellipseName:"WGS 84"},sphere:{a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}};const Ele=B9.WGS84;function Sle(n,e,t,r){var i=n*n,s=e*e,a=(i-s)/i,o=0;r?(n*=1-a*(Goe+a*(Boe+a*Uoe)),i=n*n,a=0):o=Math.sqrt(a);var l=(i-s)/s;return{es:a,e:o,ep2:l}}function Tle(n,e,t,r,i){if(!n){var s=yu(B9,r);s||(s=Ele),n=s.a,e=s.b,t=s.rf}return t&&!e&&(e=(1-1/t)*n),(t===0||Math.abs(n-e)<st)&&(i=!0,e=n),{a:n,b:e,rf:t,sphere:i}}var H_={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},mgi:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Ordnance Survey of Great Britain 1936"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"},EPSG_5451:{towgs84:"6.41,-49.05,-11.28,1.5657,0.5242,6.9718,-5.7649"},IGNF_LURESG:{towgs84:"-192.986,13.673,-39.309,-0.4099,-2.9332,2.6881,0.43"},EPSG_4614:{towgs84:"-119.4248,-303.65872,-11.00061,1.164298,0.174458,1.096259,3.657065"},EPSG_4615:{towgs84:"-494.088,-312.129,279.877,-1.423,-1.013,1.59,-0.748"},ESRI_37241:{towgs84:"-76.822,257.457,-12.817,2.136,-0.033,-2.392,-0.031"},ESRI_37249:{towgs84:"-440.296,58.548,296.265,1.128,10.202,4.559,-0.438"},ESRI_37245:{towgs84:"-511.151,-181.269,139.609,1.05,2.703,1.798,3.071"},EPSG_4178:{towgs84:"24.9,-126.4,-93.2,-0.063,-0.247,-0.041,1.01"},EPSG_4622:{towgs84:"-472.29,-5.63,-304.12,0.4362,-0.8374,0.2563,1.8984"},EPSG_4625:{towgs84:"126.93,547.94,130.41,-2.7867,5.1612,-0.8584,13.8227"},EPSG_5252:{towgs84:"0.023,0.036,-0.068,0.00176,0.00912,-0.01136,0.00439"},EPSG_4314:{towgs84:"597.1,71.4,412.1,0.894,0.068,-1.563,7.58"},EPSG_4282:{towgs84:"-178.3,-316.7,-131.5,5.278,6.077,10.979,19.166"},EPSG_4231:{towgs84:"-83.11,-97.38,-117.22,0.0276,-0.2167,0.2147,0.1218"},EPSG_4274:{towgs84:"-230.994,102.591,25.199,0.633,-0.239,0.9,1.95"},EPSG_4134:{towgs84:"-180.624,-225.516,173.919,-0.81,-1.898,8.336,16.71006"},EPSG_4254:{towgs84:"18.38,192.45,96.82,0.056,-0.142,-0.2,-0.0013"},EPSG_4159:{towgs84:"-194.513,-63.978,-25.759,-3.4027,3.756,-3.352,-0.9175"},EPSG_4687:{towgs84:"0.072,-0.507,-0.245,0.0183,-0.0003,0.007,-0.0093"},EPSG_4227:{towgs84:"-83.58,-397.54,458.78,-17.595,-2.847,4.256,3.225"},EPSG_4746:{towgs84:"599.4,72.4,419.2,-0.062,-0.022,-2.723,6.46"},EPSG_4745:{towgs84:"612.4,77,440.2,-0.054,0.057,-2.797,2.55"},EPSG_6311:{towgs84:"8.846,-4.394,-1.122,-0.00237,-0.146528,0.130428,0.783926"},EPSG_4289:{towgs84:"565.7381,50.4018,465.2904,-1.91514,1.60363,-9.09546,4.07244"},EPSG_4230:{towgs84:"-68.863,-134.888,-111.49,-0.53,-0.14,0.57,-3.4"},EPSG_4154:{towgs84:"-123.02,-158.95,-168.47"},EPSG_4156:{towgs84:"570.8,85.7,462.8,4.998,1.587,5.261,3.56"},EPSG_4299:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4179:{towgs84:"33.4,-146.6,-76.3,-0.359,-0.053,0.844,-0.84"},EPSG_4313:{towgs84:"-106.8686,52.2978,-103.7239,0.3366,-0.457,1.8422,-1.2747"},EPSG_4194:{towgs84:"163.511,127.533,-159.789"},EPSG_4195:{towgs84:"105,326,-102.5"},EPSG_4196:{towgs84:"-45,417,-3.5"},EPSG_4611:{towgs84:"-162.619,-276.959,-161.764,0.067753,-2.243649,-1.158827,-1.094246"},EPSG_4633:{towgs84:"137.092,131.66,91.475,-1.9436,-11.5993,-4.3321,-7.4824"},EPSG_4641:{towgs84:"-408.809,366.856,-412.987,1.8842,-0.5308,2.1655,-121.0993"},EPSG_4643:{towgs84:"-480.26,-438.32,-643.429,16.3119,20.1721,-4.0349,-111.7002"},EPSG_4300:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4188:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4660:{towgs84:"982.6087,552.753,-540.873,32.39344,-153.25684,-96.2266,16.805"},EPSG_4662:{towgs84:"97.295,-263.247,310.882,-1.5999,0.8386,3.1409,13.3259"},EPSG_3906:{towgs84:"577.88891,165.22205,391.18289,4.9145,-0.94729,-13.05098,7.78664"},EPSG_4307:{towgs84:"-209.3622,-87.8162,404.6198,0.0046,3.4784,0.5805,-1.4547"},EPSG_6892:{towgs84:"-76.269,-16.683,68.562,-6.275,10.536,-4.286,-13.686"},EPSG_4690:{towgs84:"221.597,152.441,176.523,2.403,1.3893,0.884,11.4648"},EPSG_4691:{towgs84:"218.769,150.75,176.75,3.5231,2.0037,1.288,10.9817"},EPSG_4629:{towgs84:"72.51,345.411,79.241,-1.5862,-0.8826,-0.5495,1.3653"},EPSG_4630:{towgs84:"165.804,216.213,180.26,-0.6251,-0.4515,-0.0721,7.4111"},EPSG_4692:{towgs84:"217.109,86.452,23.711,0.0183,-0.0003,0.007,-0.0093"},EPSG_9333:{towgs84:"0,0,0,-8.393,0.749,-10.276,0"},EPSG_9059:{towgs84:"0,0,0"},EPSG_4312:{towgs84:"601.705,84.263,485.227,4.7354,1.3145,5.393,-2.3887"},EPSG_4123:{towgs84:"-96.062,-82.428,-121.753,4.801,0.345,-1.376,1.496"},EPSG_4309:{towgs84:"-124.45,183.74,44.64,-0.4384,0.5446,-0.9706,-2.1365"},ESRI_104106:{towgs84:"-283.088,-70.693,117.445,-1.157,0.059,-0.652,-4.058"},EPSG_4281:{towgs84:"-219.247,-73.802,269.529"},EPSG_4322:{towgs84:"0,0,4.5"},EPSG_4324:{towgs84:"0,0,1.9"},EPSG_4284:{towgs84:"43.822,-108.842,-119.585,1.455,-0.761,0.737,0.549"},EPSG_4277:{towgs84:"446.448,-125.157,542.06,0.15,0.247,0.842,-20.489"},EPSG_4207:{towgs84:"-282.1,-72.2,120,-1.529,0.145,-0.89,-4.46"},EPSG_4688:{towgs84:"347.175,1077.618,2623.677,33.9058,-70.6776,9.4013,186.0647"},EPSG_4689:{towgs84:"410.793,54.542,80.501,-2.5596,-2.3517,-0.6594,17.3218"},EPSG_4720:{towgs84:"0,0,4.5"},EPSG_4273:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},EPSG_4240:{towgs84:"204.64,834.74,293.8"},EPSG_4817:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},ESRI_104131:{towgs84:"426.62,142.62,460.09,4.98,4.49,-12.42,-17.1"},EPSG_4265:{towgs84:"-104.1,-49.1,-9.9,0.971,-2.917,0.714,-11.68"},EPSG_4263:{towgs84:"-111.92,-87.85,114.5,1.875,0.202,0.219,0.032"},EPSG_4298:{towgs84:"-689.5937,623.84046,-65.93566,-0.02331,1.17094,-0.80054,5.88536"},EPSG_4270:{towgs84:"-253.4392,-148.452,386.5267,0.15605,0.43,-0.1013,-0.0424"},EPSG_4229:{towgs84:"-121.8,98.1,-10.7"},EPSG_4220:{towgs84:"-55.5,-348,-229.2"},EPSG_4214:{towgs84:"12.646,-155.176,-80.863"},EPSG_4232:{towgs84:"-345,3,223"},EPSG_4238:{towgs84:"-1.977,-13.06,-9.993,0.364,0.254,0.689,-1.037"},EPSG_4168:{towgs84:"-170,33,326"},EPSG_4131:{towgs84:"199,931,318.9"},EPSG_4152:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_5228:{towgs84:"572.213,85.334,461.94,4.9732,1.529,5.2484,3.5378"},EPSG_8351:{towgs84:"485.021,169.465,483.839,7.786342,4.397554,4.102655,0"},EPSG_4683:{towgs84:"-127.62,-67.24,-47.04,-3.068,4.903,1.578,-1.06"},EPSG_4133:{towgs84:"0,0,0"},EPSG_7373:{towgs84:"0.819,-0.5762,-1.6446,-0.00378,-0.03317,0.00318,0.0693"},EPSG_9075:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9072:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9294:{towgs84:"1.16835,-1.42001,-2.24431,-0.00822,-0.05508,0.01818,0.23388"},EPSG_4212:{towgs84:"-267.434,173.496,181.814,-13.4704,8.7154,7.3926,14.7492"},EPSG_4191:{towgs84:"-44.183,-0.58,-38.489,2.3867,2.7072,-3.5196,-8.2703"},EPSG_4237:{towgs84:"52.684,-71.194,-13.975,-0.312,-0.1063,-0.3729,1.0191"},EPSG_4740:{towgs84:"-1.08,-0.27,-0.9"},EPSG_4124:{towgs84:"419.3836,99.3335,591.3451,0.850389,1.817277,-7.862238,-0.99496"},EPSG_5681:{towgs84:"584.9636,107.7175,413.8067,1.1155,0.2824,-3.1384,7.9922"},EPSG_4141:{towgs84:"23.772,17.49,17.859,-0.3132,-1.85274,1.67299,-5.4262"},EPSG_4204:{towgs84:"-85.645,-273.077,-79.708,2.289,-1.421,2.532,3.194"},EPSG_4319:{towgs84:"226.702,-193.337,-35.371,-2.229,-4.391,9.238,0.9798"},EPSG_4200:{towgs84:"24.82,-131.21,-82.66"},EPSG_4130:{towgs84:"0,0,0"},EPSG_4127:{towgs84:"-82.875,-57.097,-156.768,-2.158,1.524,-0.982,-0.359"},EPSG_4149:{towgs84:"674.374,15.056,405.346"},EPSG_4617:{towgs84:"-0.991,1.9072,0.5129,1.25033e-7,4.6785e-8,5.6529e-8,0"},EPSG_4663:{towgs84:"-210.502,-66.902,-48.476,2.094,-15.067,-5.817,0.485"},EPSG_4664:{towgs84:"-211.939,137.626,58.3,-0.089,0.251,0.079,0.384"},EPSG_4665:{towgs84:"-105.854,165.589,-38.312,-0.003,-0.026,0.024,-0.048"},EPSG_4666:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},EPSG_4756:{towgs84:"-192.873,-39.382,-111.202,-0.00205,-0.0005,0.00335,0.0188"},EPSG_4723:{towgs84:"-179.483,-69.379,-27.584,-7.862,8.163,6.042,-13.925"},EPSG_4726:{towgs84:"8.853,-52.644,180.304,-0.393,-2.323,2.96,-24.081"},EPSG_4267:{towgs84:"-8.0,160.0,176.0"},EPSG_5365:{towgs84:"-0.16959,0.35312,0.51846,0.03385,-0.16325,0.03446,0.03693"},EPSG_4218:{towgs84:"304.5,306.5,-318.1"},EPSG_4242:{towgs84:"-33.722,153.789,94.959,-8.581,-4.478,4.54,8.95"},EPSG_4216:{towgs84:"-292.295,248.758,429.447,4.9971,2.99,6.6906,1.0289"},ESRI_104105:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},ESRI_104129:{towgs84:"0,0,0"},EPSG_4673:{towgs84:"174.05,-25.49,112.57"},EPSG_4202:{towgs84:"-124,-60,154"},EPSG_4203:{towgs84:"-117.763,-51.51,139.061,0.292,0.443,0.277,-0.191"},EPSG_3819:{towgs84:"595.48,121.69,515.35,4.115,-2.9383,0.853,-3.408"},EPSG_8694:{towgs84:"-93.799,-132.737,-219.073,-1.844,0.648,-6.37,-0.169"},EPSG_4145:{towgs84:"275.57,676.78,229.6"},EPSG_4283:{towgs84:"61.55,-10.87,-40.19,39.4924,32.7221,32.8979,-9.994"},EPSG_4317:{towgs84:"2.3287,-147.0425,-92.0802,-0.3092483,0.32482185,0.49729934,5.68906266"},EPSG_4272:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993"},EPSG_4248:{towgs84:"-307.7,265.3,-363.5"},EPSG_5561:{towgs84:"24,-121,-76"},EPSG_5233:{towgs84:"-0.293,766.95,87.713,0.195704,1.695068,3.473016,-0.039338"},ESRI_104130:{towgs84:"-86,-98,-119"},ESRI_104102:{towgs84:"682,-203,480"},ESRI_37207:{towgs84:"7,-10,-26"},EPSG_4675:{towgs84:"59.935,118.4,-10.871"},ESRI_104109:{towgs84:"-89.121,-348.182,260.871"},ESRI_104112:{towgs84:"-185.583,-230.096,281.361"},ESRI_104113:{towgs84:"25.1,-275.6,222.6"},IGNF_WGS72G:{towgs84:"0,12,6"},IGNF_NTFG:{towgs84:"-168,-60,320"},IGNF_EFATE57G:{towgs84:"-127,-769,472"},IGNF_PGP50G:{towgs84:"324.8,153.6,172.1"},IGNF_REUN47G:{towgs84:"94,-948,-1262"},IGNF_CSG67G:{towgs84:"-186,230,110"},IGNF_GUAD48G:{towgs84:"-467,-16,-300"},IGNF_TAHI51G:{towgs84:"162,117,154"},IGNF_TAHAAG:{towgs84:"65,342,77"},IGNF_NUKU72G:{towgs84:"84,274,65"},IGNF_PETRELS72G:{towgs84:"365,194,166"},IGNF_WALL78G:{towgs84:"253,-133,-127"},IGNF_MAYO50G:{towgs84:"-382,-59,-262"},IGNF_TANNAG:{towgs84:"-139,-967,436"},IGNF_IGN72G:{towgs84:"-13,-348,292"},IGNF_ATIGG:{towgs84:"1118,23,66"},IGNF_FANGA84G:{towgs84:"150.57,158.33,118.32"},IGNF_RUSAT84G:{towgs84:"202.13,174.6,-15.74"},IGNF_KAUE70G:{towgs84:"126.74,300.1,-75.49"},IGNF_MOP90G:{towgs84:"-10.8,-1.8,12.77"},IGNF_MHPF67G:{towgs84:"338.08,212.58,-296.17"},IGNF_TAHI79G:{towgs84:"160.61,116.05,153.69"},IGNF_ANAA92G:{towgs84:"1.5,3.84,4.81"},IGNF_MARQUI72G:{towgs84:"330.91,-13.92,58.56"},IGNF_APAT86G:{towgs84:"143.6,197.82,74.05"},IGNF_TUBU69G:{towgs84:"237.17,171.61,-77.84"},IGNF_STPM50G:{towgs84:"11.363,424.148,373.13"},EPSG_4150:{towgs84:"674.374,15.056,405.346"},EPSG_4754:{towgs84:"-208.4058,-109.8777,-2.5764"},ESRI_104101:{towgs84:"374,150,588"},EPSG_4693:{towgs84:"0,-0.15,0.68"},EPSG_6207:{towgs84:"293.17,726.18,245.36"},EPSG_4153:{towgs84:"-133.63,-157.5,-158.62"},EPSG_4132:{towgs84:"-241.54,-163.64,396.06"},EPSG_4221:{towgs84:"-154.5,150.7,100.4"},EPSG_4266:{towgs84:"-80.7,-132.5,41.1"},EPSG_4193:{towgs84:"-70.9,-151.8,-41.4"},EPSG_5340:{towgs84:"-0.41,0.46,-0.35"},EPSG_4246:{towgs84:"-294.7,-200.1,525.5"},EPSG_4318:{towgs84:"-3.2,-5.7,2.8"},EPSG_4121:{towgs84:"-199.87,74.79,246.62"},EPSG_4223:{towgs84:"-260.1,5.5,432.2"},EPSG_4158:{towgs84:"-0.465,372.095,171.736"},EPSG_4285:{towgs84:"-128.16,-282.42,21.93"},EPSG_4613:{towgs84:"-404.78,685.68,45.47"},EPSG_4607:{towgs84:"195.671,332.517,274.607"},EPSG_4475:{towgs84:"-381.788,-57.501,-256.673"},EPSG_4208:{towgs84:"-157.84,308.54,-146.6"},EPSG_4743:{towgs84:"70.995,-335.916,262.898"},EPSG_4710:{towgs84:"-323.65,551.39,-491.22"},EPSG_7881:{towgs84:"-0.077,0.079,0.086"},EPSG_4682:{towgs84:"283.729,735.942,261.143"},EPSG_4739:{towgs84:"-156,-271,-189"},EPSG_4679:{towgs84:"-80.01,253.26,291.19"},EPSG_4750:{towgs84:"-56.263,16.136,-22.856"},EPSG_4644:{towgs84:"-10.18,-350.43,291.37"},EPSG_4695:{towgs84:"-103.746,-9.614,-255.95"},EPSG_4292:{towgs84:"-355,21,72"},EPSG_4302:{towgs84:"-61.702,284.488,472.052"},EPSG_4143:{towgs84:"-124.76,53,466.79"},EPSG_4606:{towgs84:"-153,153,307"},EPSG_4699:{towgs84:"-770.1,158.4,-498.2"},EPSG_4247:{towgs84:"-273.5,110.6,-357.9"},EPSG_4160:{towgs84:"8.88,184.86,106.69"},EPSG_4161:{towgs84:"-233.43,6.65,173.64"},EPSG_9251:{towgs84:"-9.5,122.9,138.2"},EPSG_9253:{towgs84:"-78.1,101.6,133.3"},EPSG_4297:{towgs84:"-198.383,-240.517,-107.909"},EPSG_4269:{towgs84:"0,0,0"},EPSG_4301:{towgs84:"-147,506,687"},EPSG_4618:{towgs84:"-59,-11,-52"},EPSG_4612:{towgs84:"0,0,0"},EPSG_4678:{towgs84:"44.585,-131.212,-39.544"},EPSG_4250:{towgs84:"-130,29,364"},EPSG_4144:{towgs84:"214,804,268"},EPSG_4147:{towgs84:"-17.51,-108.32,-62.39"},EPSG_4259:{towgs84:"-254.1,-5.36,-100.29"},EPSG_4164:{towgs84:"-76,-138,67"},EPSG_4211:{towgs84:"-378.873,676.002,-46.255"},EPSG_4182:{towgs84:"-422.651,-172.995,84.02"},EPSG_4224:{towgs84:"-143.87,243.37,-33.52"},EPSG_4225:{towgs84:"-205.57,168.77,-4.12"},EPSG_5527:{towgs84:"-67.35,3.88,-38.22"},EPSG_4752:{towgs84:"98,390,-22"},EPSG_4310:{towgs84:"-30,190,89"},EPSG_9248:{towgs84:"-192.26,65.72,132.08"},EPSG_4680:{towgs84:"124.5,-63.5,-281"},EPSG_4701:{towgs84:"-79.9,-158,-168.9"},EPSG_4706:{towgs84:"-146.21,112.63,4.05"},EPSG_4805:{towgs84:"682,-203,480"},EPSG_4201:{towgs84:"-165,-11,206"},EPSG_4210:{towgs84:"-157,-2,-299"},EPSG_4183:{towgs84:"-104,167,-38"},EPSG_4139:{towgs84:"11,72,-101"},EPSG_4668:{towgs84:"-86,-98,-119"},EPSG_4717:{towgs84:"-2,151,181"},EPSG_4732:{towgs84:"102,52,-38"},EPSG_4280:{towgs84:"-377,681,-50"},EPSG_4209:{towgs84:"-138,-105,-289"},EPSG_4261:{towgs84:"31,146,47"},EPSG_4658:{towgs84:"-73,46,-86"},EPSG_4721:{towgs84:"265.025,384.929,-194.046"},EPSG_4222:{towgs84:"-136,-108,-292"},EPSG_4601:{towgs84:"-255,-15,71"},EPSG_4602:{towgs84:"725,685,536"},EPSG_4603:{towgs84:"72,213.7,93"},EPSG_4605:{towgs84:"9,183,236"},EPSG_4621:{towgs84:"137,248,-430"},EPSG_4657:{towgs84:"-28,199,5"},EPSG_4316:{towgs84:"103.25,-100.4,-307.19"},EPSG_4642:{towgs84:"-13,-348,292"},EPSG_4698:{towgs84:"145,-187,103"},EPSG_4192:{towgs84:"-206.1,-174.7,-87.7"},EPSG_4311:{towgs84:"-265,120,-358"},EPSG_4135:{towgs84:"58,-283,-182"},ESRI_104138:{towgs84:"198,-226,-347"},EPSG_4245:{towgs84:"-11,851,5"},EPSG_4142:{towgs84:"-125,53,467"},EPSG_4213:{towgs84:"-106,-87,188"},EPSG_4253:{towgs84:"-133,-77,-51"},EPSG_4129:{towgs84:"-132,-110,-335"},EPSG_4713:{towgs84:"-77,-128,142"},EPSG_4239:{towgs84:"217,823,299"},EPSG_4146:{towgs84:"295,736,257"},EPSG_4155:{towgs84:"-83,37,124"},EPSG_4165:{towgs84:"-173,253,27"},EPSG_4672:{towgs84:"175,-38,113"},EPSG_4236:{towgs84:"-637,-549,-203"},EPSG_4251:{towgs84:"-90,40,88"},EPSG_4271:{towgs84:"-2,374,172"},EPSG_4175:{towgs84:"-88,4,101"},EPSG_4716:{towgs84:"298,-304,-375"},EPSG_4315:{towgs84:"-23,259,-9"},EPSG_4744:{towgs84:"-242.2,-144.9,370.3"},EPSG_4244:{towgs84:"-97,787,86"},EPSG_4293:{towgs84:"616,97,-251"},EPSG_4714:{towgs84:"-127,-769,472"},EPSG_4736:{towgs84:"260,12,-147"},EPSG_6883:{towgs84:"-235,-110,393"},EPSG_6894:{towgs84:"-63,176,185"},EPSG_4205:{towgs84:"-43,-163,45"},EPSG_4256:{towgs84:"41,-220,-134"},EPSG_4262:{towgs84:"639,405,60"},EPSG_4604:{towgs84:"174,359,365"},EPSG_4169:{towgs84:"-115,118,426"},EPSG_4620:{towgs84:"-106,-129,165"},EPSG_4184:{towgs84:"-203,141,53"},EPSG_4616:{towgs84:"-289,-124,60"},EPSG_9403:{towgs84:"-307,-92,127"},EPSG_4684:{towgs84:"-133,-321,50"},EPSG_4708:{towgs84:"-491,-22,435"},EPSG_4707:{towgs84:"114,-116,-333"},EPSG_4709:{towgs84:"145,75,-272"},EPSG_4712:{towgs84:"-205,107,53"},EPSG_4711:{towgs84:"124,-234,-25"},EPSG_4718:{towgs84:"230,-199,-752"},EPSG_4719:{towgs84:"211,147,111"},EPSG_4724:{towgs84:"208,-435,-229"},EPSG_4725:{towgs84:"189,-79,-202"},EPSG_4735:{towgs84:"647,1777,-1124"},EPSG_4722:{towgs84:"-794,119,-298"},EPSG_4728:{towgs84:"-307,-92,127"},EPSG_4734:{towgs84:"-632,438,-609"},EPSG_4727:{towgs84:"912,-58,1227"},EPSG_4729:{towgs84:"185,165,42"},EPSG_4730:{towgs84:"170,42,84"},EPSG_4733:{towgs84:"276,-57,149"},ESRI_37218:{towgs84:"230,-199,-752"},ESRI_37240:{towgs84:"-7,215,225"},ESRI_37221:{towgs84:"252,-209,-751"},ESRI_4305:{towgs84:"-123,-206,219"},ESRI_104139:{towgs84:"-73,-247,227"},EPSG_4748:{towgs84:"51,391,-36"},EPSG_4219:{towgs84:"-384,664,-48"},EPSG_4255:{towgs84:"-333,-222,114"},EPSG_4257:{towgs84:"-587.8,519.75,145.76"},EPSG_4646:{towgs84:"-963,510,-359"},EPSG_6881:{towgs84:"-24,-203,268"},EPSG_6882:{towgs84:"-183,-15,273"},EPSG_4715:{towgs84:"-104,-129,239"},IGNF_RGF93GDD:{towgs84:"0,0,0"},IGNF_RGM04GDD:{towgs84:"0,0,0"},IGNF_RGSPM06GDD:{towgs84:"0,0,0"},IGNF_RGTAAF07GDD:{towgs84:"0,0,0"},IGNF_RGFG95GDD:{towgs84:"0,0,0"},IGNF_RGNCG:{towgs84:"0,0,0"},IGNF_RGPFGDD:{towgs84:"0,0,0"},IGNF_ETRS89G:{towgs84:"0,0,0"},IGNF_RGR92GDD:{towgs84:"0,0,0"},EPSG_4173:{towgs84:"0,0,0"},EPSG_4180:{towgs84:"0,0,0"},EPSG_4619:{towgs84:"0,0,0"},EPSG_4667:{towgs84:"0,0,0"},EPSG_4075:{towgs84:"0,0,0"},EPSG_6706:{towgs84:"0,0,0"},EPSG_7798:{towgs84:"0,0,0"},EPSG_4661:{towgs84:"0,0,0"},EPSG_4669:{towgs84:"0,0,0"},EPSG_8685:{towgs84:"0,0,0"},EPSG_4151:{towgs84:"0,0,0"},EPSG_9702:{towgs84:"0,0,0"},EPSG_4758:{towgs84:"0,0,0"},EPSG_4761:{towgs84:"0,0,0"},EPSG_4765:{towgs84:"0,0,0"},EPSG_8997:{towgs84:"0,0,0"},EPSG_4023:{towgs84:"0,0,0"},EPSG_4670:{towgs84:"0,0,0"},EPSG_4694:{towgs84:"0,0,0"},EPSG_4148:{towgs84:"0,0,0"},EPSG_4163:{towgs84:"0,0,0"},EPSG_4167:{towgs84:"0,0,0"},EPSG_4189:{towgs84:"0,0,0"},EPSG_4190:{towgs84:"0,0,0"},EPSG_4176:{towgs84:"0,0,0"},EPSG_4659:{towgs84:"0,0,0"},EPSG_3824:{towgs84:"0,0,0"},EPSG_3889:{towgs84:"0,0,0"},EPSG_4046:{towgs84:"0,0,0"},EPSG_4081:{towgs84:"0,0,0"},EPSG_4558:{towgs84:"0,0,0"},EPSG_4483:{towgs84:"0,0,0"},EPSG_5013:{towgs84:"0,0,0"},EPSG_5264:{towgs84:"0,0,0"},EPSG_5324:{towgs84:"0,0,0"},EPSG_5354:{towgs84:"0,0,0"},EPSG_5371:{towgs84:"0,0,0"},EPSG_5373:{towgs84:"0,0,0"},EPSG_5381:{towgs84:"0,0,0"},EPSG_5393:{towgs84:"0,0,0"},EPSG_5489:{towgs84:"0,0,0"},EPSG_5593:{towgs84:"0,0,0"},EPSG_6135:{towgs84:"0,0,0"},EPSG_6365:{towgs84:"0,0,0"},EPSG_5246:{towgs84:"0,0,0"},EPSG_7886:{towgs84:"0,0,0"},EPSG_8431:{towgs84:"0,0,0"},EPSG_8427:{towgs84:"0,0,0"},EPSG_8699:{towgs84:"0,0,0"},EPSG_8818:{towgs84:"0,0,0"},EPSG_4757:{towgs84:"0,0,0"},EPSG_9140:{towgs84:"0,0,0"},EPSG_8086:{towgs84:"0,0,0"},EPSG_4686:{towgs84:"0,0,0"},EPSG_4737:{towgs84:"0,0,0"},EPSG_4702:{towgs84:"0,0,0"},EPSG_4747:{towgs84:"0,0,0"},EPSG_4749:{towgs84:"0,0,0"},EPSG_4674:{towgs84:"0,0,0"},EPSG_4755:{towgs84:"0,0,0"},EPSG_4759:{towgs84:"0,0,0"},EPSG_4762:{towgs84:"0,0,0"},EPSG_4763:{towgs84:"0,0,0"},EPSG_4764:{towgs84:"0,0,0"},EPSG_4166:{towgs84:"0,0,0"},EPSG_4170:{towgs84:"0,0,0"},EPSG_5546:{towgs84:"0,0,0"},EPSG_7844:{towgs84:"0,0,0"},EPSG_4818:{towgs84:"589,76,480"}};for(var ble in H_){var kS=H_[ble];kS.datumName&&(H_[kS.datumName]=kS)}function Ile(n,e,t,r,i,s,a){var o={};return n===void 0||n==="none"?o.datum_type=Ib:o.datum_type=joe,e&&(o.datum_params=e.map(parseFloat),(o.datum_params[0]!==0||o.datum_params[1]!==0||o.datum_params[2]!==0)&&(o.datum_type=Jh),o.datum_params.length>3&&(o.datum_params[3]!==0||o.datum_params[4]!==0||o.datum_params[5]!==0||o.datum_params[6]!==0)&&(o.datum_type=ed,o.datum_params[3]*=Rm,o.datum_params[4]*=Rm,o.datum_params[5]*=Rm,o.datum_params[6]=o.datum_params[6]/1e6+1)),a&&(o.datum_type=Qf,o.grids=a),o.a=t,o.b=r,o.es=i,o.ep2=s,o}var bR={};function Ale(n,e,t){return e instanceof ArrayBuffer?Rle(n,e,t):{ready:Cle(n,e)}}function Rle(n,e,t){var r=!0;t!==void 0&&t.includeErrorFields===!1&&(r=!1);var i=new DataView(e),s=Mle(i),a=Nle(i,s),o=Lle(i,a,s,r),l={header:a,subgrids:o};return bR[n]=l,l}async function Cle(n,e){for(var t=[],r=await e.getImageCount(),i=r-1;i>=0;i--){var s=await e.getImage(i),a=await s.readRasters(),o=a,l=[s.getWidth(),s.getHeight()],u=s.getBoundingBox().map(IL),h=[s.fileDirectory.ModelPixelScale[0],s.fileDirectory.ModelPixelScale[1]].map(IL),f=u[0]+(l[0]-1)*h[0],g=u[3]-(l[1]-1)*h[1],y=o[0],v=o[1],x=[];for(let b=l[1]-1;b>=0;b--)for(let I=l[0]-1;I>=0;I--){var E=b*l[0]+I;x.push([-Xc(v[E]),Xc(y[E])])}t.push({del:h,lim:l,ll:[-f,g],cvs:x})}var T={header:{nSubgrids:r},subgrids:t};return bR[n]=T,T}function Ple(n){if(n===void 0)return null;var e=n.split(",");return e.map(kle)}function kle(n){if(n.length===0)return null;var e=n[0]==="@";return e&&(n=n.slice(1)),n==="null"?{name:"null",mandatory:!e,grid:null,isNull:!0}:{name:n,mandatory:!e,grid:bR[n]||null,isNull:!1}}function IL(n){return n*Math.PI/180}function Xc(n){return n/3600*Math.PI/180}function Mle(n){var e=n.getInt32(8,!1);return e===11?!1:(e=n.getInt32(8,!0),e!==11&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}function Nle(n,e){return{nFields:n.getInt32(8,e),nSubgridFields:n.getInt32(24,e),nSubgrids:n.getInt32(40,e),shiftType:Rb(n,56,64).trim(),fromSemiMajorAxis:n.getFloat64(120,e),fromSemiMinorAxis:n.getFloat64(136,e),toSemiMajorAxis:n.getFloat64(152,e),toSemiMinorAxis:n.getFloat64(168,e)}}function Rb(n,e,t){return String.fromCharCode.apply(null,new Uint8Array(n.buffer.slice(e,t)))}function Lle(n,e,t,r){for(var i=176,s=[],a=0;a<e.nSubgrids;a++){var o=Dle(n,i,t),l=Fle(n,i,o,t,r),u=Math.round(1+(o.upperLongitude-o.lowerLongitude)/o.longitudeInterval),h=Math.round(1+(o.upperLatitude-o.lowerLatitude)/o.latitudeInterval);s.push({ll:[Xc(o.lowerLongitude),Xc(o.lowerLatitude)],del:[Xc(o.longitudeInterval),Xc(o.latitudeInterval)],lim:[u,h],count:o.gridNodeCount,cvs:Ole(l)});var f=16;r===!1&&(f=8),i+=176+o.gridNodeCount*f}return s}function Ole(n){return n.map(function(e){return[Xc(e.longitudeShift),Xc(e.latitudeShift)]})}function Dle(n,e,t){return{name:Rb(n,e+8,e+16).trim(),parent:Rb(n,e+24,e+24+8).trim(),lowerLatitude:n.getFloat64(e+72,t),upperLatitude:n.getFloat64(e+88,t),lowerLongitude:n.getFloat64(e+104,t),upperLongitude:n.getFloat64(e+120,t),latitudeInterval:n.getFloat64(e+136,t),longitudeInterval:n.getFloat64(e+152,t),gridNodeCount:n.getInt32(e+168,t)}}function Fle(n,e,t,r,i){var s=e+176,a=16;i===!1&&(a=8);for(var o=[],l=0;l<t.gridNodeCount;l++){var u={latitudeShift:n.getFloat32(s+l*a,r),longitudeShift:n.getFloat32(s+l*a+4,r)};i!==!1&&(u.latitudeAccuracy=n.getFloat32(s+l*a+8,r),u.longitudeAccuracy=n.getFloat32(s+l*a+12,r)),o.push(u)}return o}function ba(n,e){if(!(this instanceof ba))return new ba(n);this.forward=null,this.inverse=null,this.init=null,this.name,this.names=null,this.title,e=e||function(u){if(u)throw u};var t=ule(n);if(typeof t!="object"){e("Could not parse to valid json: "+n);return}var r=ba.projections.get(t.projName);if(!r){e("Could not get projection name from: "+n);return}if(t.datumCode&&t.datumCode!=="none"){var i=yu(H_,t.datumCode);i&&(t.datum_params=t.datum_params||(i.towgs84?i.towgs84.split(","):null),t.ellps=i.ellipse,t.datumName=i.datumName?i.datumName:t.datumCode)}t.k0=t.k0||1,t.axis=t.axis||"enu",t.ellps=t.ellps||"wgs84",t.lat1=t.lat1||t.lat0;var s=Tle(t.a,t.b,t.rf,t.ellps,t.sphere),a=Sle(s.a,s.b,s.rf,t.R_A),o=Ple(t.nadgrids),l=t.datum||Ile(t.datumCode,t.datum_params,s.a,s.b,a.es,a.ep2,o);TL(this,t),TL(this,r),this.a=s.a,this.b=s.b,this.rf=s.rf,this.sphere=s.sphere,this.es=a.es,this.e=a.e,this.ep2=a.ep2,this.datum=l,"init"in this&&typeof this.init=="function"&&this.init(),e(null,this)}ba.projections=wle;ba.projections.start();function jle(n,e){return n.datum_type!==e.datum_type||n.a!==e.a||Math.abs(n.es-e.es)>5e-11?!1:n.datum_type===Jh?n.datum_params[0]===e.datum_params[0]&&n.datum_params[1]===e.datum_params[1]&&n.datum_params[2]===e.datum_params[2]:n.datum_type===ed?n.datum_params[0]===e.datum_params[0]&&n.datum_params[1]===e.datum_params[1]&&n.datum_params[2]===e.datum_params[2]&&n.datum_params[3]===e.datum_params[3]&&n.datum_params[4]===e.datum_params[4]&&n.datum_params[5]===e.datum_params[5]&&n.datum_params[6]===e.datum_params[6]:!0}function U9(n,e,t){var r=n.x,i=n.y,s=n.z?n.z:0,a,o,l,u;if(i<-We&&i>-1.001*We)i=-We;else if(i>We&&i<1.001*We)i=We;else{if(i<-We)return{x:-1/0,y:-1/0,z:n.z};if(i>We)return{x:1/0,y:1/0,z:n.z}}return r>Math.PI&&(r-=2*Math.PI),o=Math.sin(i),u=Math.cos(i),l=o*o,a=t/Math.sqrt(1-e*l),{x:(a+s)*u*Math.cos(r),y:(a+s)*u*Math.sin(r),z:(a*(1-e)+s)*o}}function z9(n,e,t,r){var i=1e-12,s=i*i,a=30,o,l,u,h,f,g,y,v,x,E,T,b,I,M=n.x,F=n.y,z=n.z?n.z:0,k,C,P;if(o=Math.sqrt(M*M+F*F),l=Math.sqrt(M*M+F*F+z*z),o/t<i){if(k=0,l/t<i)return C=We,P=-r,{x:n.x,y:n.y,z:n.z}}else k=Math.atan2(F,M);u=z/l,h=o/l,f=1/Math.sqrt(1-e*(2-e)*h*h),v=h*(1-e)*f,x=u*f,I=0;do I++,y=t/Math.sqrt(1-e*x*x),P=o*v+z*x-y*(1-e*x*x),g=e*y/(y+P),f=1/Math.sqrt(1-g*(2-g)*h*h),E=h*(1-g)*f,T=u*f,b=T*v-E*x,v=E,x=T;while(b*b>s&&I<a);return C=Math.atan(T/Math.abs(E)),{x:k,y:C,z:P}}function Vle(n,e,t){if(e===Jh)return{x:n.x+t[0],y:n.y+t[1],z:n.z+t[2]};if(e===ed){var r=t[0],i=t[1],s=t[2],a=t[3],o=t[4],l=t[5],u=t[6];return{x:u*(n.x-l*n.y+o*n.z)+r,y:u*(l*n.x+n.y-a*n.z)+i,z:u*(-o*n.x+a*n.y+n.z)+s}}}function Gle(n,e,t){if(e===Jh)return{x:n.x-t[0],y:n.y-t[1],z:n.z-t[2]};if(e===ed){var r=t[0],i=t[1],s=t[2],a=t[3],o=t[4],l=t[5],u=t[6],h=(n.x-r)/u,f=(n.y-i)/u,g=(n.z-s)/u;return{x:h+l*f-o*g,y:-l*h+f+a*g,z:o*h-a*f+g}}}function u_(n){return n===Jh||n===ed}function Ble(n,e,t){if(jle(n,e)||n.datum_type===Ib||e.datum_type===Ib)return t;var r=n.a,i=n.es;if(n.datum_type===Qf){var s=AL(n,!1,t);if(s!==0)return;r=_L,i=xL}var a=e.a,o=e.b,l=e.es;if(e.datum_type===Qf&&(a=_L,o=Voe,l=xL),i===l&&r===a&&!u_(n.datum_type)&&!u_(e.datum_type))return t;if(t=U9(t,i,r),u_(n.datum_type)&&(t=Vle(t,n.datum_type,n.datum_params)),u_(e.datum_type)&&(t=Gle(t,e.datum_type,e.datum_params)),t=z9(t,l,a,o),e.datum_type===Qf){var u=AL(e,!0,t);if(u!==0)return}return t}function AL(n,e,t){if(n.grids===null||n.grids.length===0)return console.log("Grid shift grids not found"),-1;var r={x:-t.x,y:t.y},i={x:Number.NaN,y:Number.NaN},s=[];e:for(var a=0;a<n.grids.length;a++){var o=n.grids[a];if(s.push(o.name),o.isNull){i=r;break}if(o.grid===null){if(o.mandatory)return console.log("Unable to find mandatory grid '"+o.name+"'"),-1;continue}for(var l=o.grid.subgrids,u=0,h=l.length;u<h;u++){var f=l[u],g=(Math.abs(f.del[1])+Math.abs(f.del[0]))/1e4,y=f.ll[0]-g,v=f.ll[1]-g,x=f.ll[0]+(f.lim[0]-1)*f.del[0]+g,E=f.ll[1]+(f.lim[1]-1)*f.del[1]+g;if(!(v>r.y||y>r.x||E<r.y||x<r.x)&&(i=Ule(r,e,f),!isNaN(i.x)))break e}}return isNaN(i.x)?(console.log("Failed to find a grid shift table for location '"+-r.x*As+" "+r.y*As+" tried: '"+s+"'"),-1):(t.x=-i.x,t.y=i.y,0)}function Ule(n,e,t){var r={x:Number.NaN,y:Number.NaN};if(isNaN(n.x))return r;var i={x:n.x,y:n.y};i.x-=t.ll[0],i.y-=t.ll[1],i.x=ht(i.x-Math.PI)+Math.PI;var s=RL(i,t);if(e){if(isNaN(s.x))return r;s.x=i.x-s.x,s.y=i.y-s.y;var a=9,o=1e-12,l,u;do{if(u=RL(s,t),isNaN(u.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}l={x:i.x-(u.x+s.x),y:i.y-(u.y+s.y)},s.x+=l.x,s.y+=l.y}while(a--&&Math.abs(l.x)>o&&Math.abs(l.y)>o);if(a<0)return console.log("Inverse grid shift iterator failed to converge."),r;r.x=ht(s.x+t.ll[0]),r.y=s.y+t.ll[1]}else isNaN(s.x)||(r.x=n.x+s.x,r.y=n.y+s.y);return r}function RL(n,e){var t={x:n.x/e.del[0],y:n.y/e.del[1]},r={x:Math.floor(t.x),y:Math.floor(t.y)},i={x:t.x-1*r.x,y:t.y-1*r.y},s={x:Number.NaN,y:Number.NaN},a;if(r.x<0||r.x>=e.lim[0]||r.y<0||r.y>=e.lim[1])return s;a=r.y*e.lim[0]+r.x;var o={x:e.cvs[a][0],y:e.cvs[a][1]};a++;var l={x:e.cvs[a][0],y:e.cvs[a][1]};a+=e.lim[0];var u={x:e.cvs[a][0],y:e.cvs[a][1]};a--;var h={x:e.cvs[a][0],y:e.cvs[a][1]},f=i.x*i.y,g=i.x*(1-i.y),y=(1-i.x)*(1-i.y),v=(1-i.x)*i.y;return s.x=y*o.x+g*l.x+v*h.x+f*u.x,s.y=y*o.y+g*l.y+v*h.y+f*u.y,s}function CL(n,e,t){var r=t.x,i=t.y,s=t.z||0,a,o,l,u={};for(l=0;l<3;l++)if(!(e&&l===2&&t.z===void 0))switch(l===0?(a=r,"ew".indexOf(n.axis[l])!==-1?o="x":o="y"):l===1?(a=i,"ns".indexOf(n.axis[l])!==-1?o="y":o="x"):(a=s,o="z"),n.axis[l]){case"e":u[o]=a;break;case"w":u[o]=-a;break;case"n":u[o]=a;break;case"s":u[o]=-a;break;case"u":t[o]!==void 0&&(u.z=a);break;case"d":t[o]!==void 0&&(u.z=-a);break;default:return null}return u}function $9(n){var e={x:n[0],y:n[1]};return n.length>2&&(e.z=n[2]),n.length>3&&(e.m=n[3]),e}function zle(n){PL(n.x),PL(n.y)}function PL(n){if(typeof Number.isFinite=="function"){if(Number.isFinite(n))return;throw new TypeError("coordinates must be finite numbers")}if(typeof n!="number"||n!==n||!isFinite(n))throw new TypeError("coordinates must be finite numbers")}function $le(n,e){return(n.datum.datum_type===Jh||n.datum.datum_type===ed||n.datum.datum_type===Qf)&&e.datumCode!=="WGS84"||(e.datum.datum_type===Jh||e.datum.datum_type===ed||e.datum.datum_type===Qf)&&n.datumCode!=="WGS84"}function rv(n,e,t,r){var i;Array.isArray(t)?t=$9(t):t={x:t.x,y:t.y,z:t.z,m:t.m};var s=t.z!==void 0;if(zle(t),n.datum&&e.datum&&$le(n,e)&&(i=new ba("WGS84"),t=rv(n,i,t,r),n=i),r&&n.axis!=="enu"&&(t=CL(n,!1,t)),n.projName==="longlat")t={x:t.x*br,y:t.y*br,z:t.z||0};else if(n.to_meter&&(t={x:t.x*n.to_meter,y:t.y*n.to_meter,z:t.z||0}),t=n.inverse(t),!t)return;if(n.from_greenwich&&(t.x+=n.from_greenwich),t=Ble(n.datum,e.datum,t),!!t)return t=t,e.from_greenwich&&(t={x:t.x-e.from_greenwich,y:t.y,z:t.z||0}),e.projName==="longlat"?t={x:t.x*As,y:t.y*As,z:t.z||0}:(t=e.forward(t),e.to_meter&&(t={x:t.x/e.to_meter,y:t.y/e.to_meter,z:t.z||0})),r&&e.axis!=="enu"?CL(e,!0,t):(t&&!s&&delete t.z,t)}var kL=ba("WGS84");function MS(n,e,t,r){var i,s,a;return Array.isArray(t)?(i=rv(n,e,t,r)||{x:NaN,y:NaN},t.length>2?typeof n.name<"u"&&n.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"?typeof i.z=="number"?[i.x,i.y,i.z].concat(t.slice(3)):[i.x,i.y,t[2]].concat(t.slice(3)):[i.x,i.y].concat(t.slice(2)):[i.x,i.y]):(s=rv(n,e,t,r),a=Object.keys(t),a.length===2||a.forEach(function(o){if(typeof n.name<"u"&&n.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"){if(o==="x"||o==="y"||o==="z")return}else if(o==="x"||o==="y")return;s[o]=t[o]}),s)}function h_(n){return n instanceof ba?n:typeof n=="object"&&"oProj"in n?n.oProj:ba(n)}function Wle(n,e,t){var r,i,s=!1,a;return typeof e>"u"?(i=h_(n),r=kL,s=!0):(typeof e.x<"u"||Array.isArray(e))&&(t=e,i=h_(n),r=kL,s=!0),r||(r=h_(n)),i||(i=h_(e)),t?MS(r,i,t):(a={forward:function(o,l){return MS(r,i,o,l)},inverse:function(o,l){return MS(i,r,o,l)}},s&&(a.oProj=i),a)}var ML=6,W9="AJSAJS",H9="AFAFAF",Vf=65,_s=73,pa=79,lm=86,cm=90;const Hle={forward:K9,inverse:Kle,toPoint:Y9};function K9(n,e){return e=e||5,Xle(Yle({lat:n[1],lon:n[0]}),e)}function Kle(n){var e=IR(X9(n.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat,e.lon,e.lat]:[e.left,e.bottom,e.right,e.top]}function Y9(n){var e=IR(X9(n.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}function NS(n){return n*(Math.PI/180)}function NL(n){return 180*(n/Math.PI)}function Yle(n){var e=n.lat,t=n.lon,r=6378137,i=.00669438,s=.9996,a,o,l,u,h,f,g,y=NS(e),v=NS(t),x,E;E=Math.floor((t+180)/6)+1,t===180&&(E=60),e>=56&&e<64&&t>=3&&t<12&&(E=32),e>=72&&e<84&&(t>=0&&t<9?E=31:t>=9&&t<21?E=33:t>=21&&t<33?E=35:t>=33&&t<42&&(E=37)),a=(E-1)*6-180+3,x=NS(a),o=i/(1-i),l=r/Math.sqrt(1-i*Math.sin(y)*Math.sin(y)),u=Math.tan(y)*Math.tan(y),h=o*Math.cos(y)*Math.cos(y),f=Math.cos(y)*(v-x),g=r*((1-i/4-3*i*i/64-5*i*i*i/256)*y-(3*i/8+3*i*i/32+45*i*i*i/1024)*Math.sin(2*y)+(15*i*i/256+45*i*i*i/1024)*Math.sin(4*y)-35*i*i*i/3072*Math.sin(6*y));var T=s*l*(f+(1-u+h)*f*f*f/6+(5-18*u+u*u+72*h-58*o)*f*f*f*f*f/120)+5e5,b=s*(g+l*Math.tan(y)*(f*f/2+(5-u+9*h+4*h*h)*f*f*f*f/24+(61-58*u+u*u+600*h-330*o)*f*f*f*f*f*f/720));return e<0&&(b+=1e7),{northing:Math.round(b),easting:Math.round(T),zoneNumber:E,zoneLetter:qle(e)}}function IR(n){var e=n.northing,t=n.easting,r=n.zoneLetter,i=n.zoneNumber;if(i<0||i>60)return null;var s=.9996,a=6378137,o=.00669438,l,u=(1-Math.sqrt(1-o))/(1+Math.sqrt(1-o)),h,f,g,y,v,x,E,T,b,I=t-5e5,M=e;r<"N"&&(M-=1e7),E=(i-1)*6-180+3,l=o/(1-o),x=M/s,T=x/(a*(1-o/4-3*o*o/64-5*o*o*o/256)),b=T+(3*u/2-27*u*u*u/32)*Math.sin(2*T)+(21*u*u/16-55*u*u*u*u/32)*Math.sin(4*T)+151*u*u*u/96*Math.sin(6*T),h=a/Math.sqrt(1-o*Math.sin(b)*Math.sin(b)),f=Math.tan(b)*Math.tan(b),g=l*Math.cos(b)*Math.cos(b),y=a*(1-o)/Math.pow(1-o*Math.sin(b)*Math.sin(b),1.5),v=I/(h*s);var F=b-h*Math.tan(b)/y*(v*v/2-(5+3*f+10*g-4*g*g-9*l)*v*v*v*v/24+(61+90*f+298*g+45*f*f-252*l-3*g*g)*v*v*v*v*v*v/720);F=NL(F);var z=(v-(1+2*f+g)*v*v*v/6+(5-2*g+28*f-3*g*g+8*l+24*f*f)*v*v*v*v*v/120)/Math.cos(b);z=E+NL(z);var k;if(n.accuracy){var C=IR({northing:n.northing+n.accuracy,easting:n.easting+n.accuracy,zoneLetter:n.zoneLetter,zoneNumber:n.zoneNumber});k={top:C.lat,right:C.lon,bottom:F,left:z}}else k={lat:F,lon:z};return k}function qle(n){var e="Z";return 84>=n&&n>=72?e="X":72>n&&n>=64?e="W":64>n&&n>=56?e="V":56>n&&n>=48?e="U":48>n&&n>=40?e="T":40>n&&n>=32?e="S":32>n&&n>=24?e="R":24>n&&n>=16?e="Q":16>n&&n>=8?e="P":8>n&&n>=0?e="N":0>n&&n>=-8?e="M":-8>n&&n>=-16?e="L":-16>n&&n>=-24?e="K":-24>n&&n>=-32?e="J":-32>n&&n>=-40?e="H":-40>n&&n>=-48?e="G":-48>n&&n>=-56?e="F":-56>n&&n>=-64?e="E":-64>n&&n>=-72?e="D":-72>n&&n>=-80&&(e="C"),e}function Xle(n,e){var t="00000"+n.easting,r="00000"+n.northing;return n.zoneNumber+n.zoneLetter+Zle(n.easting,n.northing,n.zoneNumber)+t.substr(t.length-5,e)+r.substr(r.length-5,e)}function Zle(n,e,t){var r=q9(t),i=Math.floor(n/1e5),s=Math.floor(e/1e5)%20;return Qle(i,s,r)}function q9(n){var e=n%ML;return e===0&&(e=ML),e}function Qle(n,e,t){var r=t-1,i=W9.charCodeAt(r),s=H9.charCodeAt(r),a=i+n-1,o=s+e,l=!1;a>cm&&(a=a-cm+Vf-1,l=!0),(a===_s||i<_s&&a>_s||(a>_s||i<_s)&&l)&&a++,(a===pa||i<pa&&a>pa||(a>pa||i<pa)&&l)&&(a++,a===_s&&a++),a>cm&&(a=a-cm+Vf-1),o>lm?(o=o-lm+Vf-1,l=!0):l=!1,(o===_s||s<_s&&o>_s||(o>_s||s<_s)&&l)&&o++,(o===pa||s<pa&&o>pa||(o>pa||s<pa)&&l)&&(o++,o===_s&&o++),o>lm&&(o=o-lm+Vf-1);var u=String.fromCharCode(a)+String.fromCharCode(o);return u}function X9(n){if(n&&n.length===0)throw"MGRSPoint coverting from nothing";for(var e=n.length,t=null,r="",i,s=0;!/[A-Z]/.test(i=n.charAt(s));){if(s>=2)throw"MGRSPoint bad conversion from: "+n;r+=i,s++}var a=parseInt(r,10);if(s===0||s+3>e)throw"MGRSPoint bad conversion from: "+n;var o=n.charAt(s++);if(o<="A"||o==="B"||o==="Y"||o>="Z"||o==="I"||o==="O")throw"MGRSPoint zone letter "+o+" not handled: "+n;t=n.substring(s,s+=2);for(var l=q9(a),u=Jle(t.charAt(0),l),h=ece(t.charAt(1),l);h<tce(o);)h+=2e6;var f=e-s;if(f%2!==0)throw`MGRSPoint has to have an even number 
of digits after the zone letter and two 100km letters - front 
half for easting meters, second half for 
northing meters`+n;var g=f/2,y=0,v=0,x,E,T,b,I;return g>0&&(x=1e5/Math.pow(10,g),E=n.substring(s,s+g),y=parseFloat(E)*x,T=n.substring(s+g),v=parseFloat(T)*x),b=y+u,I=v+h,{easting:b,northing:I,zoneLetter:o,zoneNumber:a,accuracy:x}}function Jle(n,e){for(var t=W9.charCodeAt(e-1),r=1e5,i=!1;t!==n.charCodeAt(0);){if(t++,t===_s&&t++,t===pa&&t++,t>cm){if(i)throw"Bad character: "+n;t=Vf,i=!0}r+=1e5}return r}function ece(n,e){if(n>"V")throw"MGRSPoint given invalid Northing "+n;for(var t=H9.charCodeAt(e-1),r=0,i=!1;t!==n.charCodeAt(0);){if(t++,t===_s&&t++,t===pa&&t++,t>lm){if(i)throw"Bad character: "+n;t=Vf,i=!0}r+=1e5}return r}function tce(n){var e;switch(n){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+n}function P0(n,e,t){if(!(this instanceof P0))return new P0(n,e,t);if(Array.isArray(n))this.x=n[0],this.y=n[1],this.z=n[2]||0;else if(typeof n=="object")this.x=n.x,this.y=n.y,this.z=n.z||0;else if(typeof n=="string"&&typeof e>"u"){var r=n.split(",");this.x=parseFloat(r[0]),this.y=parseFloat(r[1]),this.z=parseFloat(r[2])||0}else this.x=n,this.y=e,this.z=t||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}P0.fromMGRS=function(n){return new P0(Y9(n))};P0.prototype.toMGRS=function(n){return K9([this.x,this.y],n)};var nce=1,rce=.25,LL=.046875,OL=.01953125,DL=.01068115234375,ice=.75,sce=.46875,ace=.013020833333333334,oce=.007120768229166667,lce=.3645833333333333,cce=.005696614583333333,uce=.3076171875;function AR(n){var e=[];e[0]=nce-n*(rce+n*(LL+n*(OL+n*DL))),e[1]=n*(ice-n*(LL+n*(OL+n*DL)));var t=n*n;return e[2]=t*(sce-n*(ace+n*oce)),t*=n,e[3]=t*(lce-n*cce),e[4]=t*n*uce,e}function $0(n,e,t,r){return t*=e,e*=e,r[0]*n-t*(r[1]+e*(r[2]+e*(r[3]+e*r[4])))}var hce=20;function RR(n,e,t){for(var r=1/(1-e),i=n,s=hce;s;--s){var a=Math.sin(i),o=1-e*a*a;if(o=($0(i,a,Math.cos(i),t)-n)*(o*Math.sqrt(o))*r,i-=o,Math.abs(o)<st)return i}return i}function dce(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.es&&(this.en=AR(this.es),this.ml0=$0(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))}function fce(n){var e=n.x,t=n.y,r=ht(e-this.long0,this.over),i,s,a,o=Math.sin(t),l=Math.cos(t);if(this.es){var h=l*r,f=Math.pow(h,2),g=this.ep2*Math.pow(l,2),y=Math.pow(g,2),v=Math.abs(l)>st?Math.tan(t):0,x=Math.pow(v,2),E=Math.pow(x,2);i=1-this.es*Math.pow(o,2),h=h/Math.sqrt(i);var T=$0(t,o,l,this.en);s=this.a*(this.k0*h*(1+f/6*(1-x+g+f/20*(5-18*x+E+14*g-58*x*g+f/42*(61+179*E-E*x-479*x)))))+this.x0,a=this.a*(this.k0*(T-this.ml0+o*r*h/2*(1+f/12*(5-x+9*g+4*y+f/30*(61+E-58*x+270*g-330*x*g+f/56*(1385+543*E-E*x-3111*x))))))+this.y0}else{var u=l*Math.sin(r);if(Math.abs(Math.abs(u)-1)<st)return 93;if(s=.5*this.a*this.k0*Math.log((1+u)/(1-u))+this.x0,a=l*Math.cos(r)/Math.sqrt(1-Math.pow(u,2)),u=Math.abs(a),u>=1){if(u-1>st)return 93;a=0}else a=Math.acos(a);t<0&&(a=-a),a=this.a*this.k0*(a-this.lat0)+this.y0}return n.x=s,n.y=a,n}function gce(n){var e,t,r,i,s=(n.x-this.x0)*(1/this.a),a=(n.y-this.y0)*(1/this.a);if(this.es)if(e=this.ml0+a/this.k0,t=RR(e,this.es,this.en),Math.abs(t)<We){var f=Math.sin(t),g=Math.cos(t),y=Math.abs(g)>st?Math.tan(t):0,v=this.ep2*Math.pow(g,2),x=Math.pow(v,2),E=Math.pow(y,2),T=Math.pow(E,2);e=1-this.es*Math.pow(f,2);var b=s*Math.sqrt(e)/this.k0,I=Math.pow(b,2);e=e*y,r=t-e*I/(1-this.es)*.5*(1-I/12*(5+3*E-9*v*E+v-4*x-I/30*(61+90*E-252*v*E+45*T+46*v-I/56*(1385+3633*E+4095*T+1574*T*E)))),i=ht(this.long0+b*(1-I/6*(1+2*E+v-I/20*(5+28*E+24*T+8*v*E+6*v-I/42*(61+662*E+1320*T+720*T*E))))/g,this.over)}else r=We*T1(a),i=0;else{var o=Math.exp(s/this.k0),l=.5*(o-1/o),u=this.lat0+a/this.k0,h=Math.cos(u);e=Math.sqrt((1-Math.pow(h,2))/(1+Math.pow(l,2))),r=Math.asin(e),a<0&&(r=-r),l===0&&h===0?i=0:i=ht(Math.atan2(l,h)+this.long0,this.over)}return n.x=i,n.y=r,n}var mce=["Fast_Transverse_Mercator","Fast Transverse Mercator"];const K_={init:dce,forward:fce,inverse:gce,names:mce};function Z9(n){var e=Math.exp(n);return e=(e-1/e)/2,e}function Ts(n,e){n=Math.abs(n),e=Math.abs(e);var t=Math.max(n,e),r=Math.min(n,e)/(t||1);return t*Math.sqrt(1+Math.pow(r,2))}function pce(n){var e=1+n,t=e-1;return t===0?n:n*Math.log(e)/t}function yce(n){var e=Math.abs(n);return e=pce(e*(1+e/(Ts(1,e)+1))),n<0?-e:e}function CR(n,e){for(var t=2*Math.cos(2*e),r=n.length-1,i=n[r],s=0,a;--r>=0;)a=-s+t*i+n[r],s=i,i=a;return e+a*Math.sin(2*e)}function _ce(n,e){for(var t=2*Math.cos(e),r=n.length-1,i=n[r],s=0,a;--r>=0;)a=-s+t*i+n[r],s=i,i=a;return Math.sin(e)*a}function xce(n){var e=Math.exp(n);return e=(e+1/e)/2,e}function Q9(n,e,t){for(var r=Math.sin(e),i=Math.cos(e),s=Z9(t),a=xce(t),o=2*i*a,l=-2*r*s,u=n.length-1,h=n[u],f=0,g=0,y=0,v,x;--u>=0;)v=g,x=f,g=h,f=y,h=-v+o*g-l*f+n[u],y=-x+l*g+o*f;return o=r*a,l=i*s,[o*h-l*y,o*y+l*h]}function vce(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(K_.init.apply(this),this.forward=K_.forward,this.inverse=K_.inverse),this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var n=this.es/(1+Math.sqrt(1-this.es)),e=n/(2-n),t=e;this.cgb[0]=e*(2+e*(-2/3+e*(-2+e*(116/45+e*(26/45+e*(-2854/675)))))),this.cbg[0]=e*(-2+e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725)))))),t=t*e,this.cgb[1]=t*(7/3+e*(-8/5+e*(-227/45+e*(2704/315+e*(2323/945))))),this.cbg[1]=t*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945))))),t=t*e,this.cgb[2]=t*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835)))),this.cbg[2]=t*(-26/15+e*(34/21+e*(8/5+e*(-12686/2835)))),t=t*e,this.cgb[3]=t*(4279/630+e*(-332/35+e*(-399572/14175))),this.cbg[3]=t*(1237/630+e*(-12/5+e*(-24832/14175))),t=t*e,this.cgb[4]=t*(4174/315+e*(-144838/6237)),this.cbg[4]=t*(-734/315+e*(109598/31185)),t=t*e,this.cgb[5]=t*(601676/22275),this.cbg[5]=t*(444337/155925),t=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+t*(1/4+t*(1/64+t/256))),this.utg[0]=e*(-.5+e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800)))))),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800)))))),this.utg[1]=t*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720))))),this.gtu[1]=t*(13/48+e*(-3/5+e*(557/1440+e*(281/630+e*(-1983433/1935360))))),t=t*e,this.utg[2]=t*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720)))),this.gtu[2]=t*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440)))),t=t*e,this.utg[3]=t*(-4397/161280+e*(11/504+e*(830251/7257600))),this.gtu[3]=t*(49561/161280+e*(-179/168+e*(6601661/7257600))),t=t*e,this.utg[4]=t*(-4583/161280+e*(108847/3991680)),this.gtu[4]=t*(34729/80640+e*(-3418889/1995840)),t=t*e,this.utg[5]=t*(-20648693/638668800),this.gtu[5]=t*(212378941/319334400);var r=CR(this.cbg,this.lat0);this.Zb=-this.Qn*(r+_ce(this.gtu,2*r))}function wce(n){var e=ht(n.x-this.long0,this.over),t=n.y;t=CR(this.cbg,t);var r=Math.sin(t),i=Math.cos(t),s=Math.sin(e),a=Math.cos(e);t=Math.atan2(r,a*i),e=Math.atan2(s*i,Ts(r,i*a)),e=yce(Math.tan(e));var o=Q9(this.gtu,2*t,2*e);t=t+o[0],e=e+o[1];var l,u;return Math.abs(e)<=2.623395162778?(l=this.a*(this.Qn*e)+this.x0,u=this.a*(this.Qn*t+this.Zb)+this.y0):(l=1/0,u=1/0),n.x=l,n.y=u,n}function Ece(n){var e=(n.x-this.x0)*(1/this.a),t=(n.y-this.y0)*(1/this.a);t=(t-this.Zb)/this.Qn,e=e/this.Qn;var r,i;if(Math.abs(e)<=2.623395162778){var s=Q9(this.utg,2*t,2*e);t=t+s[0],e=e+s[1],e=Math.atan(Z9(e));var a=Math.sin(t),o=Math.cos(t),l=Math.sin(e),u=Math.cos(e);t=Math.atan2(a*u,Ts(l,u*o)),e=Math.atan2(l,u*o),r=ht(e+this.long0,this.over),i=CR(this.cgb,t)}else r=1/0,i=1/0;return n.x=r,n.y=i,n}var Sce=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"];const Y_={init:vce,forward:wce,inverse:Ece,names:Sce};function Tce(n,e){if(n===void 0){if(n=Math.floor((ht(e)+Math.PI)*30/Math.PI)+1,n<0)return 0;if(n>60)return 60}return n}var bce="etmerc";function Ice(){var n=Tce(this.zone,this.long0);if(n===void 0)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(n)-183)*br,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,Y_.init.apply(this),this.forward=Y_.forward,this.inverse=Y_.inverse}var Ace=["Universal Transverse Mercator System","utm"];const Rce={init:Ice,names:Ace,dependsOn:bce};function PR(n,e){return Math.pow((1-n)/(1+n),e)}var Cce=20;function Pce(){var n=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*n*n),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(n/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+Ln)/(Math.pow(Math.tan(.5*this.lat0+Ln),this.C)*PR(this.e*n,this.ratexp))}function kce(n){var e=n.x,t=n.y;return n.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*t+Ln),this.C)*PR(this.e*Math.sin(t),this.ratexp))-We,n.x=this.C*e,n}function Mce(n){for(var e=1e-14,t=n.x/this.C,r=n.y,i=Math.pow(Math.tan(.5*r+Ln)/this.K,1/this.C),s=Cce;s>0&&(r=2*Math.atan(i*PR(this.e*Math.sin(n.y),-.5*this.e))-We,!(Math.abs(r-n.y)<e));--s)n.y=r;return s?(n.x=t,n.y=r,n):null}const kR={init:Pce,forward:kce,inverse:Mce};function Nce(){kR.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))}function Lce(n){var e,t,r,i;return n.x=ht(n.x-this.long0,this.over),kR.forward.apply(this,[n]),e=Math.sin(n.y),t=Math.cos(n.y),r=Math.cos(n.x),i=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*t*r),n.x=i*t*Math.sin(n.x),n.y=i*(this.cosc0*e-this.sinc0*t*r),n.x=this.a*n.x+this.x0,n.y=this.a*n.y+this.y0,n}function Oce(n){var e,t,r,i,s;if(n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,n.x/=this.k0,n.y/=this.k0,s=Ts(n.x,n.y)){var a=2*Math.atan2(s,this.R2);e=Math.sin(a),t=Math.cos(a),i=Math.asin(t*this.sinc0+n.y*e*this.cosc0/s),r=Math.atan2(n.x*e,s*this.cosc0*t-n.y*this.sinc0*e)}else i=this.phic0,r=0;return n.x=r,n.y=i,kR.inverse.apply(this,[n]),n.x=ht(n.x+this.long0,this.over),n}var Dce=["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"];const Fce={init:Nce,forward:Lce,inverse:Oce,names:Dce};function MR(n,e,t){return e*=t,Math.tan(.5*(We+n))*Math.pow((1-e)/(1+e),.5*t)}function jce(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=st&&(this.k0=.5*(1+T1(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=st&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=st&&Math.abs(Math.cos(this.lat_ts))>st&&(this.k0=.5*this.cons*Qo(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/no(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=Qo(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(MR(this.lat0,this.sinlat0,this.e))-We,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function Vce(n){var e=n.x,t=n.y,r=Math.sin(t),i=Math.cos(t),s,a,o,l,u,h,f=ht(e-this.long0,this.over);return Math.abs(Math.abs(e-this.long0)-Math.PI)<=st&&Math.abs(t+this.lat0)<=st?(n.x=NaN,n.y=NaN,n):this.sphere?(s=2*this.k0/(1+this.sinlat0*r+this.coslat0*i*Math.cos(f)),n.x=this.a*s*i*Math.sin(f)+this.x0,n.y=this.a*s*(this.coslat0*r-this.sinlat0*i*Math.cos(f))+this.y0,n):(a=2*Math.atan(MR(t,r,this.e))-We,l=Math.cos(a),o=Math.sin(a),Math.abs(this.coslat0)<=st?(u=no(this.e,t*this.con,this.con*r),h=2*this.a*this.k0*u/this.cons,n.x=this.x0+h*Math.sin(e-this.long0),n.y=this.y0-this.con*h*Math.cos(e-this.long0),n):(Math.abs(this.sinlat0)<st?(s=2*this.a*this.k0/(1+l*Math.cos(f)),n.y=s*o):(s=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*o+this.cosX0*l*Math.cos(f))),n.y=s*(this.cosX0*o-this.sinX0*l*Math.cos(f))+this.y0),n.x=s*l*Math.sin(f)+this.x0,n))}function Gce(n){n.x-=this.x0,n.y-=this.y0;var e,t,r,i,s,a=Math.sqrt(n.x*n.x+n.y*n.y);if(this.sphere){var o=2*Math.atan(a/(2*this.a*this.k0));return e=this.long0,t=this.lat0,a<=st?(n.x=e,n.y=t,n):(t=Math.asin(Math.cos(o)*this.sinlat0+n.y*Math.sin(o)*this.coslat0/a),Math.abs(this.coslat0)<st?this.lat0>0?e=ht(this.long0+Math.atan2(n.x,-1*n.y),this.over):e=ht(this.long0+Math.atan2(n.x,n.y),this.over):e=ht(this.long0+Math.atan2(n.x*Math.sin(o),a*this.coslat0*Math.cos(o)-n.y*this.sinlat0*Math.sin(o)),this.over),n.x=e,n.y=t,n)}else if(Math.abs(this.coslat0)<=st){if(a<=st)return t=this.lat0,e=this.long0,n.x=e,n.y=t,n;n.x*=this.con,n.y*=this.con,r=a*this.cons/(2*this.a*this.k0),t=this.con*Ap(this.e,r),e=this.con*ht(this.con*this.long0+Math.atan2(n.x,-1*n.y),this.over)}else i=2*Math.atan(a*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,a<=st?s=this.X0:(s=Math.asin(Math.cos(i)*this.sinX0+n.y*Math.sin(i)*this.cosX0/a),e=ht(this.long0+Math.atan2(n.x*Math.sin(i),a*this.cosX0*Math.cos(i)-n.y*this.sinX0*Math.sin(i)),this.over)),t=-1*Ap(this.e,Math.tan(.5*(We+s)));return n.x=e,n.y=t,n}var Bce=["stere","Stereographic_South_Pole","Polar_Stereographic_variant_A","Polar_Stereographic_variant_B","Polar_Stereographic"];const Uce={init:jce,forward:Vce,inverse:Gce,names:Bce,ssfn_:MR};function zce(){var n=this.lat0;this.lambda0=this.long0;var e=Math.sin(n),t=this.a,r=this.rf,i=1/r,s=2*i-Math.pow(i,2),a=this.e=Math.sqrt(s);this.R=this.k0*t*Math.sqrt(1-s)/(1-s*Math.pow(e,2)),this.alpha=Math.sqrt(1+s/(1-s)*Math.pow(Math.cos(n),4)),this.b0=Math.asin(e/this.alpha);var o=Math.log(Math.tan(Math.PI/4+this.b0/2)),l=Math.log(Math.tan(Math.PI/4+n/2)),u=Math.log((1+a*e)/(1-a*e));this.K=o-this.alpha*l+this.alpha*a/2*u}function $ce(n){var e=Math.log(Math.tan(Math.PI/4-n.y/2)),t=this.e/2*Math.log((1+this.e*Math.sin(n.y))/(1-this.e*Math.sin(n.y))),r=-this.alpha*(e+t)+this.K,i=2*(Math.atan(Math.exp(r))-Math.PI/4),s=this.alpha*(n.x-this.lambda0),a=Math.atan(Math.sin(s)/(Math.sin(this.b0)*Math.tan(i)+Math.cos(this.b0)*Math.cos(s))),o=Math.asin(Math.cos(this.b0)*Math.sin(i)-Math.sin(this.b0)*Math.cos(i)*Math.cos(s));return n.y=this.R/2*Math.log((1+Math.sin(o))/(1-Math.sin(o)))+this.y0,n.x=this.R*a+this.x0,n}function Wce(n){for(var e=n.x-this.x0,t=n.y-this.y0,r=e/this.R,i=2*(Math.atan(Math.exp(t/this.R))-Math.PI/4),s=Math.asin(Math.cos(this.b0)*Math.sin(i)+Math.sin(this.b0)*Math.cos(i)*Math.cos(r)),a=Math.atan(Math.sin(r)/(Math.cos(this.b0)*Math.cos(r)-Math.sin(this.b0)*Math.tan(i))),o=this.lambda0+a/this.alpha,l=0,u=s,h=-1e3,f=0;Math.abs(u-h)>1e-7;){if(++f>20)return;l=1/this.alpha*(Math.log(Math.tan(Math.PI/4+s/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(u))/2)),h=u,u=2*Math.atan(Math.exp(l))-Math.PI/2}return n.x=o,n.y=u,n}var Hce=["somerc"];const Kce={init:zce,forward:$ce,inverse:Wce,names:Hce};var Rf=1e-7;function Yce(n){var e=["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"],t=typeof n.projName=="object"?Object.keys(n.projName)[0]:n.projName;return"no_uoff"in n||"no_off"in n||e.indexOf(t)!==-1||e.indexOf(G9(t))!==-1}function qce(){var n,e,t,r,i,s,a,o,l,u,h=0,f,g=0,y=0,v=0,x=0,E=0,T=0;this.no_off=Yce(this),this.no_rot="no_rot"in this;var b=!1;"alpha"in this&&(b=!0);var I=!1;if("rectified_grid_angle"in this&&(I=!0),b&&(T=this.alpha),I&&(h=this.rectified_grid_angle),b||I)g=this.longc;else if(y=this.long1,x=this.lat1,v=this.long2,E=this.lat2,Math.abs(x-E)<=Rf||(n=Math.abs(x))<=Rf||Math.abs(n-We)<=Rf||Math.abs(Math.abs(this.lat0)-We)<=Rf||Math.abs(Math.abs(E)-We)<=Rf)throw new Error;var M=1-this.es;e=Math.sqrt(M),Math.abs(this.lat0)>st?(o=Math.sin(this.lat0),t=Math.cos(this.lat0),n=1-this.es*o*o,this.B=t*t,this.B=Math.sqrt(1+this.es*this.B*this.B/M),this.A=this.B*this.k0*e/n,r=this.B*e/(t*Math.sqrt(n)),i=r*r-1,i<=0?i=0:(i=Math.sqrt(i),this.lat0<0&&(i=-i)),this.E=i+=r,this.E*=Math.pow(no(this.e,this.lat0,o),this.B)):(this.B=1/e,this.A=this.k0,this.E=r=i=1),b||I?(b?(f=Math.asin(Math.sin(T)/r),I||(h=T)):(f=h,T=Math.asin(r*Math.sin(f))),this.lam0=g-Math.asin(.5*(i-1/i)*Math.tan(f))/this.B):(s=Math.pow(no(this.e,x,Math.sin(x)),this.B),a=Math.pow(no(this.e,E,Math.sin(E)),this.B),i=this.E/s,l=(a-s)/(a+s),u=this.E*this.E,u=(u-a*s)/(u+a*s),n=y-v,n<-Math.PI?v-=bp:n>Math.PI&&(v+=bp),this.lam0=ht(.5*(y+v)-Math.atan(u*Math.tan(.5*this.B*(y-v))/l)/this.B,this.over),f=Math.atan(2*Math.sin(this.B*ht(y-this.lam0,this.over))/(i-1/i)),h=T=Math.asin(r*Math.sin(f))),this.singam=Math.sin(f),this.cosgam=Math.cos(f),this.sinrot=Math.sin(h),this.cosrot=Math.cos(h),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(r*r-1)/Math.cos(T))),this.lat0<0&&(this.u_0=-this.u_0)),i=.5*f,this.v_pole_n=this.ArB*Math.log(Math.tan(Ln-i)),this.v_pole_s=this.ArB*Math.log(Math.tan(Ln+i))}function Xce(n){var e={},t,r,i,s,a,o,l,u;if(n.x=n.x-this.lam0,Math.abs(Math.abs(n.y)-We)>st){if(a=this.E/Math.pow(no(this.e,n.y,Math.sin(n.y)),this.B),o=1/a,t=.5*(a-o),r=.5*(a+o),s=Math.sin(this.B*n.x),i=(t*this.singam-s*this.cosgam)/r,Math.abs(Math.abs(i)-1)<st)throw new Error;u=.5*this.ArB*Math.log((1-i)/(1+i)),o=Math.cos(this.B*n.x),Math.abs(o)<Rf?l=this.A*n.x:l=this.ArB*Math.atan2(t*this.cosgam+s*this.singam,o)}else u=n.y>0?this.v_pole_n:this.v_pole_s,l=this.ArB*n.y;return this.no_rot?(e.x=l,e.y=u):(l-=this.u_0,e.x=u*this.cosrot+l*this.sinrot,e.y=l*this.cosrot-u*this.sinrot),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e}function Zce(n){var e,t,r,i,s,a,o,l={};if(n.x=(n.x-this.x0)*(1/this.a),n.y=(n.y-this.y0)*(1/this.a),this.no_rot?(t=n.y,e=n.x):(t=n.x*this.cosrot-n.y*this.sinrot,e=n.y*this.cosrot+n.x*this.sinrot+this.u_0),r=Math.exp(-this.BrA*t),i=.5*(r-1/r),s=.5*(r+1/r),a=Math.sin(this.BrA*e),o=(a*this.cosgam+i*this.singam)/s,Math.abs(Math.abs(o)-1)<st)l.x=0,l.y=o<0?-We:We;else{if(l.y=this.E/Math.sqrt((1+o)/(1-o)),l.y=Ap(this.e,Math.pow(l.y,1/this.B)),l.y===1/0)throw new Error;l.x=-this.rB*Math.atan2(i*this.cosgam-a*this.singam,Math.cos(this.BrA*e))}return l.x+=this.lam0,l}var Qce=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Variant_B","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"];const Jce={init:qce,forward:Xce,inverse:Zce,names:Qce};function eue(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<st)){var n=this.b/this.a;this.e=Math.sqrt(1-n*n);var e=Math.sin(this.lat1),t=Math.cos(this.lat1),r=Qo(this.e,e,t),i=no(this.e,this.lat1,e),s=Math.sin(this.lat2),a=Math.cos(this.lat2),o=Qo(this.e,s,a),l=no(this.e,this.lat2,s),u=Math.abs(Math.abs(this.lat0)-We)<st?0:no(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>st?this.ns=Math.log(r/o)/Math.log(i/l):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=r/(this.ns*Math.pow(i,this.ns)),this.rh=this.a*this.f0*Math.pow(u,this.ns),this.title||(this.title="Lambert Conformal Conic")}}function tue(n){var e=n.x,t=n.y;Math.abs(2*Math.abs(t)-Math.PI)<=st&&(t=T1(t)*(We-2*st));var r=Math.abs(Math.abs(t)-We),i,s;if(r>st)i=no(this.e,t,Math.sin(t)),s=this.a*this.f0*Math.pow(i,this.ns);else{if(r=t*this.ns,r<=0)return null;s=0}var a=this.ns*ht(e-this.long0,this.over);return n.x=this.k0*(s*Math.sin(a))+this.x0,n.y=this.k0*(this.rh-s*Math.cos(a))+this.y0,n}function nue(n){var e,t,r,i,s,a=(n.x-this.x0)/this.k0,o=this.rh-(n.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(a*a+o*o),t=1):(e=-Math.sqrt(a*a+o*o),t=-1);var l=0;if(e!==0&&(l=Math.atan2(t*a,t*o)),e!==0||this.ns>0){if(t=1/this.ns,r=Math.pow(e/(this.a*this.f0),t),i=Ap(this.e,r),i===-9999)return null}else i=-We;return s=ht(l/this.ns+this.long0,this.over),n.x=s,n.y=i,n}var rue=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"];const iue={init:eue,forward:tue,inverse:nue,names:rue};function sue(){this.a=6377397155e-3,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.7417649320975901-.308341501185665),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq}function aue(n){var e,t,r,i,s,a,o,l=n.x,u=n.y,h=ht(l-this.long0,this.over);return e=Math.pow((1+this.e*Math.sin(u))/(1-this.e*Math.sin(u)),this.alfa*this.e/2),t=2*(Math.atan(this.k*Math.pow(Math.tan(u/2+this.s45),this.alfa)/e)-this.s45),r=-h*this.alfa,i=Math.asin(Math.cos(this.ad)*Math.sin(t)+Math.sin(this.ad)*Math.cos(t)*Math.cos(r)),s=Math.asin(Math.cos(t)*Math.sin(r)/Math.cos(i)),a=this.n*s,o=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(i/2+this.s45),this.n),n.y=o*Math.cos(a)/1,n.x=o*Math.sin(a)/1,this.czech||(n.y*=-1,n.x*=-1),n}function oue(n){var e,t,r,i,s,a,o,l,u=n.x;n.x=n.y,n.y=u,this.czech||(n.y*=-1,n.x*=-1),a=Math.sqrt(n.x*n.x+n.y*n.y),s=Math.atan2(n.y,n.x),i=s/Math.sin(this.s0),r=2*(Math.atan(Math.pow(this.ro0/a,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(r)-Math.sin(this.ad)*Math.cos(r)*Math.cos(i)),t=Math.asin(Math.cos(r)*Math.sin(i)/Math.cos(e)),n.x=this.long0-t/this.alfa,o=e,l=0;var h=0;do n.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(o))/(1-this.e*Math.sin(o)),this.e/2))-this.s45),Math.abs(o-n.y)<1e-10&&(l=1),o=n.y,h+=1;while(l===0&&h<15);return h>=15?null:n}var lue=["Krovak","krovak"];const cue={init:sue,forward:aue,inverse:oue,names:lue};function ls(n,e,t,r,i){return n*i-e*Math.sin(2*i)+t*Math.sin(4*i)-r*Math.sin(6*i)}function b1(n){return 1-.25*n*(1+n/16*(3+1.25*n))}function I1(n){return .375*n*(1+.25*n*(1+.46875*n))}function A1(n){return .05859375*n*n*(1+.75*n)}function R1(n){return n*n*n*(35/3072)}function NR(n,e,t){var r=e*t;return n/Math.sqrt(1-r*r)}function Ru(n){return Math.abs(n)<We?n:n-T1(n)*Math.PI}function iv(n,e,t,r,i){var s,a;s=n/e;for(var o=0;o<15;o++)if(a=(n-(e*s-t*Math.sin(2*s)+r*Math.sin(4*s)-i*Math.sin(6*s)))/(e-2*t*Math.cos(2*s)+4*r*Math.cos(4*s)-6*i*Math.cos(6*s)),s+=a,Math.abs(a)<=1e-10)return s;return NaN}function uue(){this.sphere||(this.e0=b1(this.es),this.e1=I1(this.es),this.e2=A1(this.es),this.e3=R1(this.es),this.ml0=this.a*ls(this.e0,this.e1,this.e2,this.e3,this.lat0))}function hue(n){var e,t,r=n.x,i=n.y;if(r=ht(r-this.long0,this.over),this.sphere)e=this.a*Math.asin(Math.cos(i)*Math.sin(r)),t=this.a*(Math.atan2(Math.tan(i),Math.cos(r))-this.lat0);else{var s=Math.sin(i),a=Math.cos(i),o=NR(this.a,this.e,s),l=Math.tan(i)*Math.tan(i),u=r*Math.cos(i),h=u*u,f=this.es*a*a/(1-this.es),g=this.a*ls(this.e0,this.e1,this.e2,this.e3,i);e=o*u*(1-h*l*(1/6-(8-l+8*f)*h/120)),t=g-this.ml0+o*s/a*h*(.5+(5-l+6*f)*h/24)}return n.x=e+this.x0,n.y=t+this.y0,n}function due(n){n.x-=this.x0,n.y-=this.y0;var e=n.x/this.a,t=n.y/this.a,r,i;if(this.sphere){var s=t+this.lat0;r=Math.asin(Math.sin(s)*Math.cos(e)),i=Math.atan2(Math.tan(e),Math.cos(s))}else{var a=this.ml0/this.a+t,o=iv(a,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(o)-We)<=st)return n.x=this.long0,n.y=We,t<0&&(n.y*=-1),n;var l=NR(this.a,this.e,Math.sin(o)),u=l*l*l/this.a/this.a*(1-this.es),h=Math.pow(Math.tan(o),2),f=e*this.a/l,g=f*f;r=o-l*Math.tan(o)/u*f*f*(.5-(1+3*h)*f*f/24),i=f*(1-g*(h/3+(1+3*h)*h*g/15))/Math.cos(o)}return n.x=ht(i+this.long0,this.over),n.y=Ru(r),n}var fue=["Cassini","Cassini_Soldner","cass"];const gue={init:uue,forward:hue,inverse:due,names:fue};function ou(n,e){var t;return n>1e-7?(t=n*e,(1-n*n)*(e/(1-t*t)-.5/n*Math.log((1-t)/(1+t)))):2*e}var Cb=1,Pb=2,kb=3,q_=4;function mue(){var n=Math.abs(this.lat0);if(Math.abs(n-We)<st?this.mode=this.lat0<0?Cb:Pb:Math.abs(n)<st?this.mode=kb:this.mode=q_,this.es>0){var e;switch(this.qp=ou(this.e,1),this.mmf=.5/(1-this.es),this.apa=Tue(this.es),this.mode){case Pb:this.dd=1;break;case Cb:this.dd=1;break;case kb:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case q_:this.rq=Math.sqrt(.5*this.qp),e=Math.sin(this.lat0),this.sinb1=ou(this.e,e)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*e*e)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd;break}}else this.mode===q_&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function pue(n){var e,t,r,i,s,a,o,l,u,h,f=n.x,g=n.y;if(f=ht(f-this.long0,this.over),this.sphere){if(s=Math.sin(g),h=Math.cos(g),r=Math.cos(f),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(t=this.mode===this.EQUIT?1+h*r:1+this.sinph0*s+this.cosph0*h*r,t<=st)return null;t=Math.sqrt(2/t),e=t*h*Math.sin(f),t*=this.mode===this.EQUIT?s:this.cosph0*s-this.sinph0*h*r}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(r=-r),Math.abs(g+this.lat0)<st)return null;t=Ln-g*.5,t=2*(this.mode===this.S_POLE?Math.cos(t):Math.sin(t)),e=t*Math.sin(f),t*=r}}else{switch(o=0,l=0,u=0,r=Math.cos(f),i=Math.sin(f),s=Math.sin(g),a=ou(this.e,s),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(o=a/this.qp,l=Math.sqrt(1-o*o)),this.mode){case this.OBLIQ:u=1+this.sinb1*o+this.cosb1*l*r;break;case this.EQUIT:u=1+l*r;break;case this.N_POLE:u=We+g,a=this.qp-a;break;case this.S_POLE:u=g-We,a=this.qp+a;break}if(Math.abs(u)<st)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:u=Math.sqrt(2/u),this.mode===this.OBLIQ?t=this.ymf*u*(this.cosb1*o-this.sinb1*l*r):t=(u=Math.sqrt(2/(1+l*r)))*o*this.ymf,e=this.xmf*u*l*i;break;case this.N_POLE:case this.S_POLE:a>=0?(e=(u=Math.sqrt(a))*i,t=r*(this.mode===this.S_POLE?u:-u)):e=t=0;break}}return n.x=this.a*e+this.x0,n.y=this.a*t+this.y0,n}function yue(n){n.x-=this.x0,n.y-=this.y0;var e=n.x/this.a,t=n.y/this.a,r,i,s,a,o,l,u;if(this.sphere){var h=0,f,g=0;if(f=Math.sqrt(e*e+t*t),i=f*.5,i>1)return null;switch(i=2*Math.asin(i),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(g=Math.sin(i),h=Math.cos(i)),this.mode){case this.EQUIT:i=Math.abs(f)<=st?0:Math.asin(t*g/f),e*=g,t=h*f;break;case this.OBLIQ:i=Math.abs(f)<=st?this.lat0:Math.asin(h*this.sinph0+t*g*this.cosph0/f),e*=g*this.cosph0,t=(h-Math.sin(i)*this.sinph0)*f;break;case this.N_POLE:t=-t,i=We-i;break;case this.S_POLE:i-=We;break}r=t===0&&(this.mode===this.EQUIT||this.mode===this.OBLIQ)?0:Math.atan2(e,t)}else{if(u=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(e/=this.dd,t*=this.dd,l=Math.sqrt(e*e+t*t),l<st)return n.x=this.long0,n.y=this.lat0,n;a=2*Math.asin(.5*l/this.rq),s=Math.cos(a),e*=a=Math.sin(a),this.mode===this.OBLIQ?(u=s*this.sinb1+t*a*this.cosb1/l,o=this.qp*u,t=l*this.cosb1*s-t*this.sinb1*a):(u=t*a/l,o=this.qp*u,t=l*s)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(t=-t),o=e*e+t*t,!o)return n.x=this.long0,n.y=this.lat0,n;u=1-o/this.qp,this.mode===this.S_POLE&&(u=-u)}r=Math.atan2(e,t),i=bue(Math.asin(u),this.apa)}return n.x=ht(this.long0+r,this.over),n.y=i,n}var _ue=.3333333333333333,xue=.17222222222222222,vue=.10257936507936508,wue=.06388888888888888,Eue=.0664021164021164,Sue=.016415012942191543;function Tue(n){var e,t=[];return t[0]=n*_ue,e=n*n,t[0]+=e*xue,t[1]=e*wue,e*=n,t[0]+=e*vue,t[1]+=e*Eue,t[2]=e*Sue,t}function bue(n,e){var t=n+n;return n+e[0]*Math.sin(t)+e[1]*Math.sin(t+t)+e[2]*Math.sin(t+t+t)}var Iue=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"];const Aue={init:mue,forward:pue,inverse:yue,names:Iue,S_POLE:Cb,N_POLE:Pb,EQUIT:kb,OBLIQ:q_};function _u(n){return Math.abs(n)>1&&(n=n>1?1:-1),Math.asin(n)}function Rue(){Math.abs(this.lat1+this.lat2)<st||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=Qo(this.e3,this.sin_po,this.cos_po),this.qs1=ou(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=Qo(this.e3,this.sin_po,this.cos_po),this.qs2=ou(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=ou(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>st?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function Cue(n){var e=n.x,t=n.y;this.sin_phi=Math.sin(t),this.cos_phi=Math.cos(t);var r=ou(this.e3,this.sin_phi),i=this.a*Math.sqrt(this.c-this.ns0*r)/this.ns0,s=this.ns0*ht(e-this.long0,this.over),a=i*Math.sin(s)+this.x0,o=this.rh-i*Math.cos(s)+this.y0;return n.x=a,n.y=o,n}function Pue(n){var e,t,r,i,s,a;return n.x-=this.x0,n.y=this.rh-n.y+this.y0,this.ns0>=0?(e=Math.sqrt(n.x*n.x+n.y*n.y),r=1):(e=-Math.sqrt(n.x*n.x+n.y*n.y),r=-1),i=0,e!==0&&(i=Math.atan2(r*n.x,r*n.y)),r=e*this.ns0/this.a,this.sphere?a=Math.asin((this.c-r*r)/(2*this.ns0)):(t=(this.c-r*r)/this.ns0,a=this.phi1z(this.e3,t)),s=ht(i/this.ns0+this.long0,this.over),n.x=s,n.y=a,n}function kue(n,e){var t,r,i,s,a,o=_u(.5*e);if(n<st)return o;for(var l=n*n,u=1;u<=25;u++)if(t=Math.sin(o),r=Math.cos(o),i=n*t,s=1-i*i,a=.5*s*s/r*(e/(1-l)-t/s+.5/n*Math.log((1-i)/(1+i))),o=o+a,Math.abs(a)<=1e-7)return o;return null}var Mue=["Albers_Conic_Equal_Area","Albers_Equal_Area","Albers","aea"];const Nue={init:Rue,forward:Cue,inverse:Pue,names:Mue,phi1z:kue};function Lue(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1}function Oue(n){var e,t,r,i,s,a,o,l,u=n.x,h=n.y;return r=ht(u-this.long0,this.over),e=Math.sin(h),t=Math.cos(h),i=Math.cos(r),a=this.sin_p14*e+this.cos_p14*t*i,s=1,a>0||Math.abs(a)<=st?(o=this.x0+this.a*s*t*Math.sin(r)/a,l=this.y0+this.a*s*(this.cos_p14*e-this.sin_p14*t*i)/a):(o=this.x0+this.infinity_dist*t*Math.sin(r),l=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*t*i)),n.x=o,n.y=l,n}function Due(n){var e,t,r,i,s,a;return n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,n.x/=this.k0,n.y/=this.k0,(e=Math.sqrt(n.x*n.x+n.y*n.y))?(i=Math.atan2(e,this.rc),t=Math.sin(i),r=Math.cos(i),a=_u(r*this.sin_p14+n.y*t*this.cos_p14/e),s=Math.atan2(n.x*t,e*this.cos_p14*r-n.y*this.sin_p14*t),s=ht(this.long0+s,this.over)):(a=this.phic0,s=0),n.x=s,n.y=a,n}var Fue=["gnom"];const jue={init:Lue,forward:Oue,inverse:Due,names:Fue};function Vue(n,e){var t=1-(1-n*n)/(2*n)*Math.log((1-n)/(1+n));if(Math.abs(Math.abs(e)-t)<1e-6)return e<0?-1*We:We;for(var r=Math.asin(.5*e),i,s,a,o,l=0;l<30;l++)if(s=Math.sin(r),a=Math.cos(r),o=n*s,i=Math.pow(1-o*o,2)/(2*a)*(e/(1-n*n)-s/(1-o*o)+.5/n*Math.log((1-o)/(1+o))),r+=i,Math.abs(i)<=1e-10)return r;return NaN}function Gue(){this.sphere||(this.k0=Qo(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))}function Bue(n){var e=n.x,t=n.y,r,i,s=ht(e-this.long0,this.over);if(this.sphere)r=this.x0+this.a*s*Math.cos(this.lat_ts),i=this.y0+this.a*Math.sin(t)/Math.cos(this.lat_ts);else{var a=ou(this.e,Math.sin(t));r=this.x0+this.a*this.k0*s,i=this.y0+this.a*a*.5/this.k0}return n.x=r,n.y=i,n}function Uue(n){n.x-=this.x0,n.y-=this.y0;var e,t;return this.sphere?(e=ht(this.long0+n.x/this.a/Math.cos(this.lat_ts),this.over),t=Math.asin(n.y/this.a*Math.cos(this.lat_ts))):(t=Vue(this.e,2*n.y*this.k0/this.a),e=ht(this.long0+n.x/(this.a*this.k0),this.over)),n.x=e,n.y=t,n}var zue=["cea"];const $ue={init:Gue,forward:Bue,inverse:Uue,names:zue};function Wue(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)}function Hue(n){var e=n.x,t=n.y,r=ht(e-this.long0,this.over),i=Ru(t-this.lat0);return n.x=this.x0+this.a*r*this.rc,n.y=this.y0+this.a*i,n}function Kue(n){var e=n.x,t=n.y;return n.x=ht(this.long0+(e-this.x0)/(this.a*this.rc),this.over),n.y=Ru(this.lat0+(t-this.y0)/this.a),n}var Yue=["Equirectangular","Equidistant_Cylindrical","Equidistant_Cylindrical_Spherical","eqc"];const que={init:Wue,forward:Hue,inverse:Kue,names:Yue};var FL=20;function Xue(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=b1(this.es),this.e1=I1(this.es),this.e2=A1(this.es),this.e3=R1(this.es),this.ml0=this.a*ls(this.e0,this.e1,this.e2,this.e3,this.lat0)}function Zue(n){var e=n.x,t=n.y,r,i,s,a=ht(e-this.long0,this.over);if(s=a*Math.sin(t),this.sphere)Math.abs(t)<=st?(r=this.a*a,i=-1*this.a*this.lat0):(r=this.a*Math.sin(s)/Math.tan(t),i=this.a*(Ru(t-this.lat0)+(1-Math.cos(s))/Math.tan(t)));else if(Math.abs(t)<=st)r=this.a*a,i=-1*this.ml0;else{var o=NR(this.a,this.e,Math.sin(t))/Math.tan(t);r=o*Math.sin(s),i=this.a*ls(this.e0,this.e1,this.e2,this.e3,t)-this.ml0+o*(1-Math.cos(s))}return n.x=r+this.x0,n.y=i+this.y0,n}function Que(n){var e,t,r,i,s,a,o,l,u;if(r=n.x-this.x0,i=n.y-this.y0,this.sphere)if(Math.abs(i+this.a*this.lat0)<=st)e=ht(r/this.a+this.long0,this.over),t=0;else{a=this.lat0+i/this.a,o=r*r/this.a/this.a+a*a,l=a;var h;for(s=FL;s;--s)if(h=Math.tan(l),u=-1*(a*(l*h+1)-l-.5*(l*l+o)*h)/((l-a)/h-1),l+=u,Math.abs(u)<=st){t=l;break}e=ht(this.long0+Math.asin(r*Math.tan(l)/this.a)/Math.sin(t),this.over)}else if(Math.abs(i+this.ml0)<=st)t=0,e=ht(this.long0+r/this.a,this.over);else{a=(this.ml0+i)/this.a,o=r*r/this.a/this.a+a*a,l=a;var f,g,y,v,x;for(s=FL;s;--s)if(x=this.e*Math.sin(l),f=Math.sqrt(1-x*x)*Math.tan(l),g=this.a*ls(this.e0,this.e1,this.e2,this.e3,l),y=this.e0-2*this.e1*Math.cos(2*l)+4*this.e2*Math.cos(4*l)-6*this.e3*Math.cos(6*l),v=g/this.a,u=(a*(f*v+1)-v-.5*f*(v*v+o))/(this.es*Math.sin(2*l)*(v*v+o-2*a*v)/(4*f)+(a-v)*(f*y-2/Math.sin(2*l))-y),l-=u,Math.abs(u)<=st){t=l;break}f=Math.sqrt(1-this.es*Math.pow(Math.sin(t),2))*Math.tan(t),e=ht(this.long0+Math.asin(r*f/this.a)/Math.sin(t),this.over)}return n.x=e,n.y=t,n}var Jue=["Polyconic","American_Polyconic","poly"];const ehe={init:Xue,forward:Zue,inverse:Que,names:Jue};function the(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function nhe(n){var e,t=n.x,r=n.y,i=r-this.lat0,s=t-this.long0,a=i/Rm*1e-5,o=s,l=1,u=0;for(e=1;e<=10;e++)l=l*a,u=u+this.A[e]*l;var h=u,f=o,g=1,y=0,v,x,E=0,T=0;for(e=1;e<=6;e++)v=g*h-y*f,x=y*h+g*f,g=v,y=x,E=E+this.B_re[e]*g-this.B_im[e]*y,T=T+this.B_im[e]*g+this.B_re[e]*y;return n.x=T*this.a+this.x0,n.y=E*this.a+this.y0,n}function rhe(n){var e,t=n.x,r=n.y,i=t-this.x0,s=r-this.y0,a=s/this.a,o=i/this.a,l=1,u=0,h,f,g=0,y=0;for(e=1;e<=6;e++)h=l*a-u*o,f=u*a+l*o,l=h,u=f,g=g+this.C_re[e]*l-this.C_im[e]*u,y=y+this.C_im[e]*l+this.C_re[e]*u;for(var v=0;v<this.iterations;v++){var x=g,E=y,T,b,I=a,M=o;for(e=2;e<=6;e++)T=x*g-E*y,b=E*g+x*y,x=T,E=b,I=I+(e-1)*(this.B_re[e]*x-this.B_im[e]*E),M=M+(e-1)*(this.B_im[e]*x+this.B_re[e]*E);x=1,E=0;var F=this.B_re[1],z=this.B_im[1];for(e=2;e<=6;e++)T=x*g-E*y,b=E*g+x*y,x=T,E=b,F=F+e*(this.B_re[e]*x-this.B_im[e]*E),z=z+e*(this.B_im[e]*x+this.B_re[e]*E);var k=F*F+z*z;g=(I*F+M*z)/k,y=(M*F-I*z)/k}var C=g,P=y,L=1,O=0;for(e=1;e<=9;e++)L=L*C,O=O+this.D[e]*L;var U=this.lat0+O*Rm*1e5,j=this.long0+P;return n.x=j,n.y=U,n}var ihe=["New_Zealand_Map_Grid","nzmg"];const she={init:the,forward:nhe,inverse:rhe,names:ihe};function ahe(){}function ohe(n){var e=n.x,t=n.y,r=ht(e-this.long0,this.over),i=this.x0+this.a*r,s=this.y0+this.a*Math.log(Math.tan(Math.PI/4+t/2.5))*1.25;return n.x=i,n.y=s,n}function lhe(n){n.x-=this.x0,n.y-=this.y0;var e=ht(this.long0+n.x/this.a,this.over),t=2.5*(Math.atan(Math.exp(.8*n.y/this.a))-Math.PI/4);return n.x=e,n.y=t,n}var che=["Miller_Cylindrical","mill"];const uhe={init:ahe,forward:ohe,inverse:lhe,names:che};var hhe=20;function dhe(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=AR(this.es)}function fhe(n){var e,t,r=n.x,i=n.y;if(r=ht(r-this.long0,this.over),this.sphere){if(!this.m)i=this.n!==1?Math.asin(this.n*Math.sin(i)):i;else for(var s=this.n*Math.sin(i),a=hhe;a;--a){var o=(this.m*i+Math.sin(i)-s)/(this.m+Math.cos(i));if(i-=o,Math.abs(o)<st)break}e=this.a*this.C_x*r*(this.m+Math.cos(i)),t=this.a*this.C_y*i}else{var l=Math.sin(i),u=Math.cos(i);t=this.a*$0(i,l,u,this.en),e=this.a*r*u/Math.sqrt(1-this.es*l*l)}return n.x=e,n.y=t,n}function ghe(n){var e,t,r,i;return n.x-=this.x0,r=n.x/this.a,n.y-=this.y0,e=n.y/this.a,this.sphere?(e/=this.C_y,r=r/(this.C_x*(this.m+Math.cos(e))),this.m?e=_u((this.m*e+Math.sin(e))/this.n):this.n!==1&&(e=_u(Math.sin(e)/this.n)),r=ht(r+this.long0,this.over),e=Ru(e)):(e=RR(n.y/this.a,this.es,this.en),i=Math.abs(e),i<We?(i=Math.sin(e),t=this.long0+n.x*Math.sqrt(1-this.es*i*i)/(this.a*Math.cos(e)),r=ht(t,this.over)):i-st<We&&(r=this.long0)),n.x=r,n.y=e,n}var mhe=["Sinusoidal","sinu"];const phe={init:dhe,forward:fhe,inverse:ghe,names:mhe};function yhe(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0}function _he(n){for(var e=n.x,t=n.y,r=ht(e-this.long0,this.over),i=t,s=Math.PI*Math.sin(t);;){var a=-(i+Math.sin(i)-s)/(1+Math.cos(i));if(i+=a,Math.abs(a)<st)break}i/=2,Math.PI/2-Math.abs(t)<st&&(r=0);var o=.900316316158*this.a*r*Math.cos(i)+this.x0,l=1.4142135623731*this.a*Math.sin(i)+this.y0;return n.x=o,n.y=l,n}function xhe(n){var e,t;n.x-=this.x0,n.y-=this.y0,t=n.y/(1.4142135623731*this.a),Math.abs(t)>.999999999999&&(t=.999999999999),e=Math.asin(t);var r=ht(this.long0+n.x/(.900316316158*this.a*Math.cos(e)),this.over);r<-Math.PI&&(r=-Math.PI),r>Math.PI&&(r=Math.PI),t=(2*e+Math.sin(2*e))/Math.PI,Math.abs(t)>1&&(t=1);var i=Math.asin(t);return n.x=r,n.y=i,n}var vhe=["Mollweide","moll"];const whe={init:yhe,forward:_he,inverse:xhe,names:vhe};function Ehe(){Math.abs(this.lat1+this.lat2)<st||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=b1(this.es),this.e1=I1(this.es),this.e2=A1(this.es),this.e3=R1(this.es),this.sin_phi=Math.sin(this.lat1),this.cos_phi=Math.cos(this.lat1),this.ms1=Qo(this.e,this.sin_phi,this.cos_phi),this.ml1=ls(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<st?this.ns=this.sin_phi:(this.sin_phi=Math.sin(this.lat2),this.cos_phi=Math.cos(this.lat2),this.ms2=Qo(this.e,this.sin_phi,this.cos_phi),this.ml2=ls(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=ls(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))}function She(n){var e=n.x,t=n.y,r;if(this.sphere)r=this.a*(this.g-t);else{var i=ls(this.e0,this.e1,this.e2,this.e3,t);r=this.a*(this.g-i)}var s=this.ns*ht(e-this.long0,this.over),a=this.x0+r*Math.sin(s),o=this.y0+this.rh-r*Math.cos(s);return n.x=a,n.y=o,n}function The(n){n.x-=this.x0,n.y=this.rh-n.y+this.y0;var e,t,r,i;this.ns>=0?(t=Math.sqrt(n.x*n.x+n.y*n.y),e=1):(t=-Math.sqrt(n.x*n.x+n.y*n.y),e=-1);var s=0;if(t!==0&&(s=Math.atan2(e*n.x,e*n.y)),this.sphere)return i=ht(this.long0+s/this.ns,this.over),r=Ru(this.g-t/this.a),n.x=i,n.y=r,n;var a=this.g-t/this.a;return r=iv(a,this.e0,this.e1,this.e2,this.e3),i=ht(this.long0+s/this.ns,this.over),n.x=i,n.y=r,n}var bhe=["Equidistant_Conic","eqdc"];const Ihe={init:Ehe,forward:She,inverse:The,names:bhe};function Ahe(){this.R=this.a}function Rhe(n){var e=n.x,t=n.y,r=ht(e-this.long0,this.over),i,s;Math.abs(t)<=st&&(i=this.x0+this.R*r,s=this.y0);var a=_u(2*Math.abs(t/Math.PI));(Math.abs(r)<=st||Math.abs(Math.abs(t)-We)<=st)&&(i=this.x0,t>=0?s=this.y0+Math.PI*this.R*Math.tan(.5*a):s=this.y0+Math.PI*this.R*-Math.tan(.5*a));var o=.5*Math.abs(Math.PI/r-r/Math.PI),l=o*o,u=Math.sin(a),h=Math.cos(a),f=h/(u+h-1),g=f*f,y=f*(2/u-1),v=y*y,x=Math.PI*this.R*(o*(f-v)+Math.sqrt(l*(f-v)*(f-v)-(v+l)*(g-v)))/(v+l);r<0&&(x=-x),i=this.x0+x;var E=l+f;return x=Math.PI*this.R*(y*E-o*Math.sqrt((v+l)*(l+1)-E*E))/(v+l),t>=0?s=this.y0+x:s=this.y0-x,n.x=i,n.y=s,n}function Che(n){var e,t,r,i,s,a,o,l,u,h,f,g,y;return n.x-=this.x0,n.y-=this.y0,f=Math.PI*this.R,r=n.x/f,i=n.y/f,s=r*r+i*i,a=-Math.abs(i)*(1+s),o=a-2*i*i+r*r,l=-2*a+1+2*i*i+s*s,y=i*i/l+(2*o*o*o/l/l/l-9*a*o/l/l)/27,u=(a-o*o/3/l)/l,h=2*Math.sqrt(-u/3),f=3*y/u/h,Math.abs(f)>1&&(f>=0?f=1:f=-1),g=Math.acos(f)/3,n.y>=0?t=(-h*Math.cos(g+Math.PI/3)-o/3/l)*Math.PI:t=-(-h*Math.cos(g+Math.PI/3)-o/3/l)*Math.PI,Math.abs(r)<st?e=this.long0:e=ht(this.long0+Math.PI*(s-1+Math.sqrt(1+2*(r*r-i*i)+s*s))/2/r,this.over),n.x=e,n.y=t,n}var Phe=["Van_der_Grinten_I","VanDerGrinten","Van_der_Grinten","vandg"];const khe={init:Ahe,forward:Rhe,inverse:Che,names:Phe};function Mhe(n,e,t,r,i,s){const a=r-e,o=Math.atan((1-s)*Math.tan(n)),l=Math.atan((1-s)*Math.tan(t)),u=Math.sin(o),h=Math.cos(o),f=Math.sin(l),g=Math.cos(l);let y=a,v,x=100,E,T,b,I,M,F,z,k,C,P,L,O,U,j;do{if(E=Math.sin(y),T=Math.cos(y),b=Math.sqrt(g*E*(g*E)+(h*f-u*g*T)*(h*f-u*g*T)),b===0)return{azi1:0,s12:0};I=u*f+h*g*T,M=Math.atan2(b,I),F=h*g*E/b,z=1-F*F,k=z!==0?I-2*u*f/z:0,C=s/16*z*(4+s*(4-3*z)),v=y,y=a+(1-C)*s*F*(M+C*b*(k+C*I*(-1+2*k*k)))}while(Math.abs(y-v)>1e-12&&--x>0);return x===0?{azi1:NaN,s12:NaN}:(P=z*(i*i-i*(1-s)*(i*(1-s)))/(i*(1-s)*(i*(1-s))),L=1+P/16384*(4096+P*(-768+P*(320-175*P))),O=P/1024*(256+P*(-128+P*(74-47*P))),U=O*b*(k+O/4*(I*(-1+2*k*k)-O/6*k*(-3+4*b*b)*(-3+4*k*k))),j=i*(1-s)*L*(M-U),{azi1:Math.atan2(g*E,h*f-u*g*T),s12:j})}function Nhe(n,e,t,r,i,s){const a=Math.atan((1-s)*Math.tan(n)),o=Math.sin(a),l=Math.cos(a),u=Math.sin(t),h=Math.cos(t),f=Math.atan2(o,l*h),g=l*u,y=1-g*g,v=y*(i*i-i*(1-s)*(i*(1-s)))/(i*(1-s)*(i*(1-s))),x=1+v/16384*(4096+v*(-768+v*(320-175*v))),E=v/1024*(256+v*(-128+v*(74-47*v)));let T=r/(i*(1-s)*x),b,I=100,M,F,z,k;do M=Math.cos(2*f+T),F=Math.sin(T),z=Math.cos(T),k=E*F*(M+E/4*(z*(-1+2*M*M)-E/6*M*(-3+4*F*F)*(-3+4*M*M))),b=T,T=r/(i*(1-s)*x)+k;while(Math.abs(T-b)>1e-12&&--I>0);if(I===0)return{lat2:NaN,lon2:NaN};const C=o*F-l*z*h,P=Math.atan2(o*z+l*F*h,(1-s)*Math.sqrt(g*g+C*C)),L=Math.atan2(F*u,l*z-o*F*h),O=s/16*y*(4+s*(4-3*y)),U=L-(1-O)*s*g*(T+O*F*(M+O*z*(-1+2*M*M))),j=e+U;return{lat2:P,lon2:j}}function Lhe(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0),this.f=this.es/(1+Math.sqrt(1-this.es))}function Ohe(n){var e=n.x,t=n.y,r=Math.sin(n.y),i=Math.cos(n.y),s=ht(e-this.long0,this.over),a,o,l,u,h,f,g,y,v,x,E;return this.sphere?Math.abs(this.sin_p12-1)<=st?(n.x=this.x0+this.a*(We-t)*Math.sin(s),n.y=this.y0-this.a*(We-t)*Math.cos(s),n):Math.abs(this.sin_p12+1)<=st?(n.x=this.x0+this.a*(We+t)*Math.sin(s),n.y=this.y0+this.a*(We+t)*Math.cos(s),n):(v=this.sin_p12*r+this.cos_p12*i*Math.cos(s),g=Math.acos(v),y=g?g/Math.sin(g):1,n.x=this.x0+this.a*y*i*Math.sin(s),n.y=this.y0+this.a*y*(this.cos_p12*r-this.sin_p12*i*Math.cos(s)),n):(a=b1(this.es),o=I1(this.es),l=A1(this.es),u=R1(this.es),Math.abs(this.sin_p12-1)<=st?(h=this.a*ls(a,o,l,u,We),f=this.a*ls(a,o,l,u,t),n.x=this.x0+(h-f)*Math.sin(s),n.y=this.y0-(h-f)*Math.cos(s),n):Math.abs(this.sin_p12+1)<=st?(h=this.a*ls(a,o,l,u,We),f=this.a*ls(a,o,l,u,t),n.x=this.x0+(h+f)*Math.sin(s),n.y=this.y0+(h+f)*Math.cos(s),n):Math.abs(e)<st&&Math.abs(t-this.lat0)<st?(n.x=n.y=0,n):(x=Mhe(this.lat0,this.long0,t,e,this.a,this.f),E=x.azi1,n.x=x.s12*Math.sin(E),n.y=x.s12*Math.cos(E),n))}function Dhe(n){n.x-=this.x0,n.y-=this.y0;var e,t,r,i,s,a,o,l,u,h,f,g,y,v,x,E;return this.sphere?(e=Math.sqrt(n.x*n.x+n.y*n.y),e>2*We*this.a?void 0:(t=e/this.a,r=Math.sin(t),i=Math.cos(t),s=this.long0,Math.abs(e)<=st?a=this.lat0:(a=_u(i*this.sin_p12+n.y*r*this.cos_p12/e),o=Math.abs(this.lat0)-We,Math.abs(o)<=st?this.lat0>=0?s=ht(this.long0+Math.atan2(n.x,-n.y),this.over):s=ht(this.long0-Math.atan2(-n.x,n.y),this.over):s=ht(this.long0+Math.atan2(n.x*r,e*this.cos_p12*i-n.y*this.sin_p12*r),this.over)),n.x=s,n.y=a,n)):(l=b1(this.es),u=I1(this.es),h=A1(this.es),f=R1(this.es),Math.abs(this.sin_p12-1)<=st?(g=this.a*ls(l,u,h,f,We),e=Math.sqrt(n.x*n.x+n.y*n.y),y=g-e,a=iv(y/this.a,l,u,h,f),s=ht(this.long0+Math.atan2(n.x,-1*n.y),this.over),n.x=s,n.y=a,n):Math.abs(this.sin_p12+1)<=st?(g=this.a*ls(l,u,h,f,We),e=Math.sqrt(n.x*n.x+n.y*n.y),y=e-g,a=iv(y/this.a,l,u,h,f),s=ht(this.long0+Math.atan2(n.x,n.y),this.over),n.x=s,n.y=a,n):(v=Math.atan2(n.x,n.y),x=Math.sqrt(n.x*n.x+n.y*n.y),E=Nhe(this.lat0,this.long0,v,x,this.a,this.f),n.x=E.lon2,n.y=E.lat2,n))}var Fhe=["Azimuthal_Equidistant","aeqd"];const jhe={init:Lhe,forward:Ohe,inverse:Dhe,names:Fhe};function Vhe(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)}function Ghe(n){var e,t,r,i,s,a,o,l,u=n.x,h=n.y;return r=ht(u-this.long0,this.over),e=Math.sin(h),t=Math.cos(h),i=Math.cos(r),a=this.sin_p14*e+this.cos_p14*t*i,s=1,(a>0||Math.abs(a)<=st)&&(o=this.a*s*t*Math.sin(r),l=this.y0+this.a*s*(this.cos_p14*e-this.sin_p14*t*i)),n.x=o,n.y=l,n}function Bhe(n){var e,t,r,i,s,a,o;return n.x-=this.x0,n.y-=this.y0,e=Math.sqrt(n.x*n.x+n.y*n.y),t=_u(e/this.a),r=Math.sin(t),i=Math.cos(t),a=this.long0,Math.abs(e)<=st?(o=this.lat0,n.x=a,n.y=o,n):(o=_u(i*this.sin_p14+n.y*r*this.cos_p14/e),s=Math.abs(this.lat0)-We,Math.abs(s)<=st?(this.lat0>=0?a=ht(this.long0+Math.atan2(n.x,-n.y),this.over):a=ht(this.long0-Math.atan2(-n.x,n.y),this.over),n.x=a,n.y=o,n):(a=ht(this.long0+Math.atan2(n.x*r,e*this.cos_p14*i-n.y*this.sin_p14*r),this.over),n.x=a,n.y=o,n))}var Uhe=["ortho"];const zhe={init:Vhe,forward:Ghe,inverse:Bhe,names:Uhe};var vr={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},On={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function $he(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=We-Ln/2?this.face=vr.TOP:this.lat0<=-(We-Ln/2)?this.face=vr.BOTTOM:Math.abs(this.long0)<=Ln?this.face=vr.FRONT:Math.abs(this.long0)<=We+Ln?this.face=this.long0>0?vr.RIGHT:vr.LEFT:this.face=vr.BACK,this.es!==0&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)}function Whe(n){var e={x:0,y:0},t,r,i,s,a,o,l={value:0};if(n.x-=this.long0,this.es!==0?t=Math.atan(this.one_minus_f_squared*Math.tan(n.y)):t=n.y,r=n.x,this.face===vr.TOP)s=We-t,r>=Ln&&r<=We+Ln?(l.value=On.AREA_0,i=r-We):r>We+Ln||r<=-(We+Ln)?(l.value=On.AREA_1,i=r>0?r-Lr:r+Lr):r>-(We+Ln)&&r<=-Ln?(l.value=On.AREA_2,i=r+We):(l.value=On.AREA_3,i=r);else if(this.face===vr.BOTTOM)s=We+t,r>=Ln&&r<=We+Ln?(l.value=On.AREA_0,i=-r+We):r<Ln&&r>=-Ln?(l.value=On.AREA_1,i=-r):r<-Ln&&r>=-(We+Ln)?(l.value=On.AREA_2,i=-r-We):(l.value=On.AREA_3,i=r>0?-r+Lr:-r-Lr);else{var u,h,f,g,y,v,x;this.face===vr.RIGHT?r=Jf(r,+We):this.face===vr.BACK?r=Jf(r,+Lr):this.face===vr.LEFT&&(r=Jf(r,-We)),g=Math.sin(t),y=Math.cos(t),v=Math.sin(r),x=Math.cos(r),u=y*x,h=y*v,f=g,this.face===vr.FRONT?(s=Math.acos(u),i=d_(s,f,h,l)):this.face===vr.RIGHT?(s=Math.acos(h),i=d_(s,f,-u,l)):this.face===vr.BACK?(s=Math.acos(-u),i=d_(s,f,-h,l)):this.face===vr.LEFT?(s=Math.acos(-h),i=d_(s,f,u,l)):(s=i=0,l.value=On.AREA_0)}return o=Math.atan(12/Lr*(i+Math.acos(Math.sin(i)*Math.cos(Ln))-We)),a=Math.sqrt((1-Math.cos(s))/(Math.cos(o)*Math.cos(o))/(1-Math.cos(Math.atan(1/Math.cos(i))))),l.value===On.AREA_1?o+=We:l.value===On.AREA_2?o+=Lr:l.value===On.AREA_3&&(o+=1.5*Lr),e.x=a*Math.cos(o),e.y=a*Math.sin(o),e.x=e.x*this.a+this.x0,e.y=e.y*this.a+this.y0,n.x=e.x,n.y=e.y,n}function Hhe(n){var e={lam:0,phi:0},t,r,i,s,a,o,l,u,h,f={value:0};if(n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,r=Math.atan(Math.sqrt(n.x*n.x+n.y*n.y)),t=Math.atan2(n.y,n.x),n.x>=0&&n.x>=Math.abs(n.y)?f.value=On.AREA_0:n.y>=0&&n.y>=Math.abs(n.x)?(f.value=On.AREA_1,t-=We):n.x<0&&-n.x>=Math.abs(n.y)?(f.value=On.AREA_2,t=t<0?t+Lr:t-Lr):(f.value=On.AREA_3,t+=We),h=Lr/12*Math.tan(t),a=Math.sin(h)/(Math.cos(h)-1/Math.sqrt(2)),o=Math.atan(a),i=Math.cos(t),s=Math.tan(r),l=1-i*i*s*s*(1-Math.cos(Math.atan(1/Math.cos(o)))),l<-1?l=-1:l>1&&(l=1),this.face===vr.TOP)u=Math.acos(l),e.phi=We-u,f.value===On.AREA_0?e.lam=o+We:f.value===On.AREA_1?e.lam=o<0?o+Lr:o-Lr:f.value===On.AREA_2?e.lam=o-We:e.lam=o;else if(this.face===vr.BOTTOM)u=Math.acos(l),e.phi=u-We,f.value===On.AREA_0?e.lam=-o+We:f.value===On.AREA_1?e.lam=-o:f.value===On.AREA_2?e.lam=-o-We:e.lam=o<0?-o-Lr:-o+Lr;else{var g,y,v;g=l,h=g*g,h>=1?v=0:v=Math.sqrt(1-h)*Math.sin(o),h+=v*v,h>=1?y=0:y=Math.sqrt(1-h),f.value===On.AREA_1?(h=y,y=-v,v=h):f.value===On.AREA_2?(y=-y,v=-v):f.value===On.AREA_3&&(h=y,y=v,v=-h),this.face===vr.RIGHT?(h=g,g=-y,y=h):this.face===vr.BACK?(g=-g,y=-y):this.face===vr.LEFT&&(h=g,g=y,y=-h),e.phi=Math.acos(-v)-We,e.lam=Math.atan2(y,g),this.face===vr.RIGHT?e.lam=Jf(e.lam,-We):this.face===vr.BACK?e.lam=Jf(e.lam,-Lr):this.face===vr.LEFT&&(e.lam=Jf(e.lam,+We))}if(this.es!==0){var x,E,T;x=e.phi<0?1:0,E=Math.tan(e.phi),T=this.b/Math.sqrt(E*E+this.one_minus_f_squared),e.phi=Math.atan(Math.sqrt(this.a*this.a-T*T)/(this.one_minus_f*T)),x&&(e.phi=-e.phi)}return e.lam+=this.long0,n.x=e.lam,n.y=e.phi,n}function d_(n,e,t,r){var i;return n<st?(r.value=On.AREA_0,i=0):(i=Math.atan2(e,t),Math.abs(i)<=Ln?r.value=On.AREA_0:i>Ln&&i<=We+Ln?(r.value=On.AREA_1,i-=We):i>We+Ln||i<=-(We+Ln)?(r.value=On.AREA_2,i=i>=0?i-Lr:i+Lr):(r.value=On.AREA_3,i+=We)),i}function Jf(n,e){var t=n+e;return t<-Lr?t+=bp:t>+Lr&&(t-=bp),t}var Khe=["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"];const Yhe={init:$he,forward:Whe,inverse:Hhe,names:Khe};var Mb=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-986701e-12],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,18736e-12],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,934959e-12],[.7986,-.00755338,-500009e-10,935324e-12],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],um=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-126793e-14,422642e-15],[.124,.0124,507171e-14,-160604e-14],[.186,.0123999,-190189e-13,600152e-14],[.248,.0124002,710039e-13,-224e-10],[.31,.0123992,-264997e-12,835986e-13],[.372,.0124029,988983e-12,-311994e-12],[.434,.0123893,-369093e-11,-435621e-12],[.4958,.0123198,-102252e-10,-345523e-12],[.5571,.0121916,-154081e-10,-582288e-12],[.6176,.0119938,-241424e-10,-525327e-12],[.6769,.011713,-320223e-10,-516405e-12],[.7346,.0113541,-397684e-10,-609052e-12],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-140374e-14],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],J9=.8487,e7=1.3523,t7=As/5,qhe=1/t7,Gf=18,sv=function(n,e){return n[0]+e*(n[1]+e*(n[2]+e*n[3]))},Xhe=function(n,e){return n[1]+e*(2*n[2]+e*3*n[3])};function Zhe(n,e,t,r){for(var i=e;r;--r){var s=n(i);if(i-=s,Math.abs(s)<t)break}return i}function Qhe(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"}function Jhe(n){var e=ht(n.x-this.long0,this.over),t=Math.abs(n.y),r=Math.floor(t*t7);r<0?r=0:r>=Gf&&(r=Gf-1),t=As*(t-qhe*r);var i={x:sv(Mb[r],t)*e,y:sv(um[r],t)};return n.y<0&&(i.y=-i.y),i.x=i.x*this.a*J9+this.x0,i.y=i.y*this.a*e7+this.y0,i}function ede(n){var e={x:(n.x-this.x0)/(this.a*J9),y:Math.abs(n.y-this.y0)/(this.a*e7)};if(e.y>=1)e.x/=Mb[Gf][0],e.y=n.y<0?-We:We;else{var t=Math.floor(e.y*Gf);for(t<0?t=0:t>=Gf&&(t=Gf-1);;)if(um[t][0]>e.y)--t;else if(um[t+1][0]<=e.y)++t;else break;var r=um[t],i=5*(e.y-r[0])/(um[t+1][0]-r[0]);i=Zhe(function(s){return(sv(r,s)-e.y)/Xhe(r,s)},i,st,100),e.x/=sv(Mb[t],i),e.y=(5*t+i)*br,n.y<0&&(e.y=-e.y)}return e.x=ht(e.x+this.long0,this.over),e}var tde=["Robinson","robin"];const nde={init:Qhe,forward:Jhe,inverse:ede,names:tde};function rde(){this.name="geocent"}function ide(n){var e=U9(n,this.es,this.a);return e}function sde(n){var e=z9(n,this.es,this.a,this.b);return e}var ade=["Geocentric","geocentric","geocent","Geocent"];const ode={init:rde,forward:ide,inverse:sde,names:ade};var zi={N_POLE:0,S_POLE:1,EQUIT:2,OBLIQ:3},Hg={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};function lde(){if(Object.keys(Hg).forEach((function(t){if(typeof this[t]>"u")this[t]=Hg[t].def;else{if(Hg[t].num&&isNaN(this[t]))throw new Error("Invalid parameter value, must be numeric "+t+" = "+this[t]);Hg[t].num&&(this[t]=parseFloat(this[t]))}Hg[t].degrees&&(this[t]=this[t]*br)}).bind(this)),Math.abs(Math.abs(this.lat0)-We)<st?this.mode=this.lat0<0?zi.S_POLE:zi.N_POLE:Math.abs(this.lat0)<st?this.mode=zi.EQUIT:(this.mode=zi.OBLIQ,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var n=this.tilt,e=this.azi;this.cg=Math.cos(e),this.sg=Math.sin(e),this.cw=Math.cos(n),this.sw=Math.sin(n)}function cde(n){n.x-=this.long0;var e=Math.sin(n.y),t=Math.cos(n.y),r=Math.cos(n.x),i,s;switch(this.mode){case zi.OBLIQ:s=this.sinph0*e+this.cosph0*t*r;break;case zi.EQUIT:s=t*r;break;case zi.S_POLE:s=-e;break;case zi.N_POLE:s=e;break}switch(s=this.pn1/(this.p-s),i=s*t*Math.sin(n.x),this.mode){case zi.OBLIQ:s*=this.cosph0*e-this.sinph0*t*r;break;case zi.EQUIT:s*=e;break;case zi.N_POLE:s*=-(t*r);break;case zi.S_POLE:s*=t*r;break}var a,o;return a=s*this.cg+i*this.sg,o=1/(a*this.sw*this.h1+this.cw),i=(i*this.cg-s*this.sg)*this.cw*o,s=a*o,n.x=i*this.a,n.y=s*this.a,n}function ude(n){n.x/=this.a,n.y/=this.a;var e={x:n.x,y:n.y},t,r,i;i=1/(this.pn1-n.y*this.sw),t=this.pn1*n.x*i,r=this.pn1*n.y*this.cw*i,n.x=t*this.cg+r*this.sg,n.y=r*this.cg-t*this.sg;var s=Ts(n.x,n.y);if(Math.abs(s)<st)e.x=0,e.y=n.y;else{var a,o;switch(o=1-s*s*this.pfact,o=(this.p-Math.sqrt(o))/(this.pn1/s+s/this.pn1),a=Math.sqrt(1-o*o),this.mode){case zi.OBLIQ:e.y=Math.asin(a*this.sinph0+n.y*o*this.cosph0/s),n.y=(a-this.sinph0*Math.sin(e.y))*s,n.x*=o*this.cosph0;break;case zi.EQUIT:e.y=Math.asin(n.y*o/s),n.y=a*s,n.x*=o;break;case zi.N_POLE:e.y=Math.asin(a),n.y=-n.y;break;case zi.S_POLE:e.y=-Math.asin(a);break}e.x=Math.atan2(n.x,n.y)}return n.x=e.x+this.long0,n.y=e.y,n}var hde=["Tilted_Perspective","tpers"];const dde={init:lde,forward:cde,inverse:ude,names:hde};function fde(){if(this.flip_axis=this.sweep==="x"?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,this.es!==0){var n=1-this.es,e=1/n;this.radius_p=Math.sqrt(n),this.radius_p2=n,this.radius_p_inv2=e,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")}function gde(n){var e=n.x,t=n.y,r,i,s,a;if(e=e-this.long0,this.shape==="ellipse"){t=Math.atan(this.radius_p2*Math.tan(t));var o=this.radius_p/Ts(this.radius_p*Math.cos(t),Math.sin(t));if(i=o*Math.cos(e)*Math.cos(t),s=o*Math.sin(e)*Math.cos(t),a=o*Math.sin(t),(this.radius_g-i)*i-s*s-a*a*this.radius_p_inv2<0)return n.x=Number.NaN,n.y=Number.NaN,n;r=this.radius_g-i,this.flip_axis?(n.x=this.radius_g_1*Math.atan(s/Ts(a,r)),n.y=this.radius_g_1*Math.atan(a/r)):(n.x=this.radius_g_1*Math.atan(s/r),n.y=this.radius_g_1*Math.atan(a/Ts(s,r)))}else this.shape==="sphere"&&(r=Math.cos(t),i=Math.cos(e)*r,s=Math.sin(e)*r,a=Math.sin(t),r=this.radius_g-i,this.flip_axis?(n.x=this.radius_g_1*Math.atan(s/Ts(a,r)),n.y=this.radius_g_1*Math.atan(a/r)):(n.x=this.radius_g_1*Math.atan(s/r),n.y=this.radius_g_1*Math.atan(a/Ts(s,r))));return n.x=n.x*this.a,n.y=n.y*this.a,n}function mde(n){var e=-1,t=0,r=0,i,s,a,o;if(n.x=n.x/this.a,n.y=n.y/this.a,this.shape==="ellipse"){this.flip_axis?(r=Math.tan(n.y/this.radius_g_1),t=Math.tan(n.x/this.radius_g_1)*Ts(1,r)):(t=Math.tan(n.x/this.radius_g_1),r=Math.tan(n.y/this.radius_g_1)*Ts(1,t));var l=r/this.radius_p;if(i=t*t+l*l+e*e,s=2*this.radius_g*e,a=s*s-4*i*this.C,a<0)return n.x=Number.NaN,n.y=Number.NaN,n;o=(-s-Math.sqrt(a))/(2*i),e=this.radius_g+o*e,t*=o,r*=o,n.x=Math.atan2(t,e),n.y=Math.atan(r*Math.cos(n.x)/e),n.y=Math.atan(this.radius_p_inv2*Math.tan(n.y))}else if(this.shape==="sphere"){if(this.flip_axis?(r=Math.tan(n.y/this.radius_g_1),t=Math.tan(n.x/this.radius_g_1)*Math.sqrt(1+r*r)):(t=Math.tan(n.x/this.radius_g_1),r=Math.tan(n.y/this.radius_g_1)*Math.sqrt(1+t*t)),i=t*t+r*r+e*e,s=2*this.radius_g*e,a=s*s-4*i*this.C,a<0)return n.x=Number.NaN,n.y=Number.NaN,n;o=(-s-Math.sqrt(a))/(2*i),e=this.radius_g+o*e,t*=o,r*=o,n.x=Math.atan2(t,e),n.y=Math.atan(r*Math.cos(n.x)/e)}return n.x=n.x+this.long0,n}var pde=["Geostationary Satellite View","Geostationary_Satellite","geos"];const yde={init:fde,forward:gde,inverse:mde,names:pde};var Cm=1.340264,Pm=-.081106,km=893e-6,Mm=.003796,av=Math.sqrt(3)/2;function _de(){this.es=0,this.long0=this.long0!==void 0?this.long0:0,this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0}function xde(n){var e=ht(n.x-this.long0,this.over),t=n.y,r=Math.asin(av*Math.sin(t)),i=r*r,s=i*i*i;return n.x=e*Math.cos(r)/(av*(Cm+3*Pm*i+s*(7*km+9*Mm*i))),n.y=r*(Cm+Pm*i+s*(km+Mm*i)),n.x=this.a*n.x+this.x0,n.y=this.a*n.y+this.y0,n}function vde(n){n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a;var e=1e-9,t=12,r=n.y,i,s,a,o,l,u;for(u=0;u<t&&(i=r*r,s=i*i*i,a=r*(Cm+Pm*i+s*(km+Mm*i))-n.y,o=Cm+3*Pm*i+s*(7*km+9*Mm*i),r-=l=a/o,!(Math.abs(l)<e));++u);return i=r*r,s=i*i*i,n.x=av*n.x*(Cm+3*Pm*i+s*(7*km+9*Mm*i))/Math.cos(r),n.y=Math.asin(Math.sin(r)/av),n.x=ht(n.x+this.long0,this.over),n}var wde=["eqearth","Equal Earth","Equal_Earth"];const Ede={init:_de,forward:xde,inverse:vde,names:wde};var Rp=1e-10;function Sde(){var n;if(this.phi1=this.lat1,Math.abs(this.phi1)<Rp)throw new Error;this.es?(this.en=AR(this.es),this.m1=$0(this.phi1,this.am1=Math.sin(this.phi1),n=Math.cos(this.phi1),this.en),this.am1=n/(Math.sqrt(1-this.es*this.am1*this.am1)*this.am1),this.inverse=bde,this.forward=Tde):(Math.abs(this.phi1)+Rp>=We?this.cphi1=0:this.cphi1=1/Math.tan(this.phi1),this.inverse=Ade,this.forward=Ide)}function Tde(n){var e=ht(n.x-(this.long0||0),this.over),t=n.y,r,i,s;return r=this.am1+this.m1-$0(t,i=Math.sin(t),s=Math.cos(t),this.en),i=s*e/(r*Math.sqrt(1-this.es*i*i)),n.x=r*Math.sin(i),n.y=this.am1-r*Math.cos(i),n.x=this.a*n.x+(this.x0||0),n.y=this.a*n.y+(this.y0||0),n}function bde(n){n.x=(n.x-(this.x0||0))/this.a,n.y=(n.y-(this.y0||0))/this.a;var e,t,r,i;if(t=Ts(n.x,n.y=this.am1-n.y),i=RR(this.am1+this.m1-t,this.es,this.en),(e=Math.abs(i))<We)e=Math.sin(i),r=t*Math.atan2(n.x,n.y)*Math.sqrt(1-this.es*e*e)/Math.cos(i);else if(Math.abs(e-We)<=Rp)r=0;else throw new Error;return n.x=ht(r+(this.long0||0),this.over),n.y=Ru(i),n}function Ide(n){var e=ht(n.x-(this.long0||0),this.over),t=n.y,r,i;return i=this.cphi1+this.phi1-t,Math.abs(i)>Rp?(n.x=i*Math.sin(r=e*Math.cos(t)/i),n.y=this.cphi1-i*Math.cos(r)):n.x=n.y=0,n.x=this.a*n.x+(this.x0||0),n.y=this.a*n.y+(this.y0||0),n}function Ade(n){n.x=(n.x-(this.x0||0))/this.a,n.y=(n.y-(this.y0||0))/this.a;var e,t,r=Ts(n.x,n.y=this.cphi1-n.y);if(t=this.cphi1+this.phi1-r,Math.abs(t)>We)throw new Error;return Math.abs(Math.abs(t)-We)<=Rp?e=0:e=r*Math.atan2(n.x,n.y)/Math.cos(t),n.x=ht(e+(this.long0||0),this.over),n.y=Ru(t),n}var Rde=["bonne","Bonne (Werner lat_1=90)"];const Cde={init:Sde,names:Rde},jL={OBLIQUE:{forward:Lde,inverse:Dde},TRANSVERSE:{forward:Ode,inverse:Fde}},ov={ROTATE:{o_alpha:"oAlpha",o_lon_c:"oLongC",o_lat_c:"oLatC"},NEW_POLE:{o_lat_p:"oLatP",o_lon_p:"oLongP"},NEW_EQUATOR:{o_lon_1:"oLong1",o_lat_1:"oLat1",o_lon_2:"oLong2",o_lat_2:"oLat2"}};function Pde(){if(this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.title=this.title||"General Oblique Transformation",this.isIdentity=j9.includes(this.o_proj),!this.o_proj)throw new Error("Missing parameter: o_proj");if(this.o_proj==="ob_tran")throw new Error("Invalid value for o_proj: "+this.o_proj);const n=this.projStr.replace("+proj=ob_tran","").replace("+o_proj=","+proj=").trim(),e=ba(n);if(!e)throw new Error("Invalid parameter: o_proj. Unknown projection "+this.o_proj);e.long0=0,this.obliqueProjection=e;let t;const r=Object.keys(ov),i=o=>{if(typeof this[o]>"u")return;const l=parseFloat(this[o])*br;if(isNaN(l))throw new Error("Invalid value for "+o+": "+this[o]);return l};for(let o=0;o<r.length;o++){const l=r[o],u=ov[l],h=Object.entries(u);if(h.some(([g])=>typeof this[g]<"u")){t=u;for(let g=0;g<h.length;g++){const[y,v]=h[g],x=i(y);if(typeof x>"u")throw new Error("Missing parameter: "+y+".");this[v]=x}break}}if(!t)throw new Error("No valid parameters provided for ob_tran projection.");const{lamp:s,phip:a}=Nde(this,t);this.lamp=s,Math.abs(a)>st?(this.cphip=Math.cos(a),this.sphip=Math.sin(a),this.projectionType=jL.OBLIQUE):this.projectionType=jL.TRANSVERSE}function kde(n){return this.projectionType.forward(this,n)}function Mde(n){return this.projectionType.inverse(this,n)}function Nde(n,e){let t,r;if(e===ov.ROTATE){let i=n.oLongC,s=n.oLatC,a=n.oAlpha;if(Math.abs(Math.abs(s)-We)<=st)throw new Error("Invalid value for o_lat_c: "+n.o_lat_c+" should be < 90");r=i+Math.atan2(-1*Math.cos(a),-1*Math.sin(a)*Math.sin(s)),t=Math.asin(Math.cos(s)*Math.sin(a))}else if(e===ov.NEW_POLE)r=n.oLongP,t=n.oLatP;else{let i=n.oLong1,s=n.oLat1,a=n.oLong2,o=n.oLat2,l=Math.abs(s);if(Math.abs(s)>We-st)throw new Error("Invalid value for o_lat_1: "+n.o_lat_1+" should be < 90");if(Math.abs(o)>We-st)throw new Error("Invalid value for o_lat_2: "+n.o_lat_2+" should be < 90");if(Math.abs(s-o)<st)throw new Error("Invalid value for o_lat_1 and o_lat_2: o_lat_1 should be different from o_lat_2");if(l<st)throw new Error("Invalid value for o_lat_1: o_lat_1 should be different from zero");r=Math.atan2(Math.cos(s)*Math.sin(o)*Math.cos(i)-Math.sin(s)*Math.cos(o)*Math.cos(a),Math.sin(s)*Math.cos(o)*Math.sin(a)-Math.cos(s)*Math.sin(o)*Math.sin(i)),t=Math.atan(-1*Math.cos(r-i)/Math.tan(s))}return{lamp:r,phip:t}}function Lde(n,e){let{x:t,y:r}=e;t+=n.long0;const i=Math.cos(t),s=Math.sin(r),a=Math.cos(r);e.x=ht(Math.atan2(a*Math.sin(t),n.sphip*a*i+n.cphip*s)+n.lamp),e.y=Math.asin(n.sphip*s-n.cphip*a*i);const o=n.obliqueProjection.forward(e);return n.isIdentity&&(o.x*=As,o.y*=As),o}function Ode(n,e){let{x:t,y:r}=e;t+=n.long0;const i=Math.cos(r),s=Math.cos(t);e.x=ht(Math.atan2(i*Math.sin(t),Math.sin(r))+n.lamp),e.y=Math.asin(-1*i*s);const a=n.obliqueProjection.forward(e);return n.isIdentity&&(a.x*=As,a.y*=As),a}function Dde(n,e){n.isIdentity&&(e.x*=br,e.y*=br);const t=n.obliqueProjection.inverse(e);let{x:r,y:i}=t;if(r<Number.MAX_VALUE){r-=n.lamp;const s=Math.cos(r),a=Math.sin(i),o=Math.cos(i);e.x=Math.atan2(o*Math.sin(r),n.sphip*o*s-n.cphip*a),e.y=Math.asin(n.sphip*a+n.cphip*o*s)}return e.x=ht(e.x+n.long0),e}function Fde(n,e){n.isIdentity&&(e.x*=br,e.y*=br);const t=n.obliqueProjection.inverse(e);let{x:r,y:i}=t;if(r<Number.MAX_VALUE){const s=Math.cos(i);r-=n.lamp,e.x=Math.atan2(s*Math.sin(r),-1*Math.sin(i)),e.y=Math.asin(s*Math.cos(r))}return e.x=ht(e.x+n.long0),e}var jde=["General Oblique Transformation","General_Oblique_Transformation","ob_tran"];const Vde={init:Pde,forward:kde,inverse:Mde,names:jde};function Gde(n){n.Proj.projections.add(K_),n.Proj.projections.add(Y_),n.Proj.projections.add(Rce),n.Proj.projections.add(Fce),n.Proj.projections.add(Uce),n.Proj.projections.add(Kce),n.Proj.projections.add(Jce),n.Proj.projections.add(iue),n.Proj.projections.add(cue),n.Proj.projections.add(gue),n.Proj.projections.add(Aue),n.Proj.projections.add(Nue),n.Proj.projections.add(jue),n.Proj.projections.add($ue),n.Proj.projections.add(que),n.Proj.projections.add(ehe),n.Proj.projections.add(she),n.Proj.projections.add(uhe),n.Proj.projections.add(phe),n.Proj.projections.add(whe),n.Proj.projections.add(Ihe),n.Proj.projections.add(khe),n.Proj.projections.add(jhe),n.Proj.projections.add(zhe),n.Proj.projections.add(Yhe),n.Proj.projections.add(nde),n.Proj.projections.add(ode),n.Proj.projections.add(dde),n.Proj.projections.add(yde),n.Proj.projections.add(Ede),n.Proj.projections.add(Cde),n.Proj.projections.add(Vde)}const vn=Object.assign(Wle,{defaultDatum:"WGS84",Proj:ba,WGS84:new ba("WGS84"),Point:P0,toPoint:$9,defs:Ei,nadgrid:Ale,transform:rv,mgrs:Hle,version:"__VERSION__"});Gde(vn);class n7{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=io,this.supportedMediaTypes=null}getReadOptions(e,t){if(t){let r=t.dataProjection?qn(t.dataProjection):this.readProjection(e);t.extent&&r&&r.getUnits()==="tile-pixels"&&(r=qn(r),r.setWorldExtent(t.extent)),t={dataProjection:r,featureProjection:t.featureProjection}}return this.adaptOptions(t)}adaptOptions(e){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},e)}getType(){return Vt()}readFeature(e,t){return Vt()}readFeatures(e,t){return Vt()}readGeometry(e,t){return Vt()}readProjection(e){return Vt()}writeFeature(e,t){return Vt()}writeFeatures(e,t){return Vt()}writeGeometry(e,t){return Vt()}}function lo(n,e,t){const r=t?qn(t.featureProjection):null,i=t?qn(t.dataProjection):null;let s=n;if(r&&i&&!Ih(r,i)){e&&(s=n.clone());const a=e?r:i,o=e?i:r;a.getUnits()==="tile-pixels"?s.transform(a,o):s.applyTransform(Hm(a,o))}if(e&&t&&t.decimals!==void 0){const a=Math.pow(10,t.decimals),o=function(l){for(let u=0,h=l.length;u<h;++u)l[u]=Math.round(l[u]*a)/a;return l};s===n&&(s=n.clone()),s.applyTransform(o)}return s}const Bde={Point:Js,LineString:so,Polygon:Ia,MultiPoint:ld,MultiLineString:Vl,MultiPolygon:jh};function Ude(n,e,t){return Array.isArray(e[0])?(N5(n,0,e,t)||(n=n.slice(),uT(n,0,e,t)),n):(gI(n,0,e,t)||(n=n.slice(),ux(n,0,e,t)),n)}function r7(n,e){const t=n.geometry;if(!t)return[];if(Array.isArray(t))return t.map(s=>r7({...n,geometry:s})).flat();const r=t.type==="MultiPolygon"?"Polygon":t.type;if(r==="GeometryCollection"||r==="Circle")throw new Error("Unsupported geometry type: "+r);const i=t.layout.length;return lo(new Ws(r,r==="Polygon"?Ude(t.flatCoordinates,t.ends,i):t.flatCoordinates,t.ends?.flat(),i,n.properties||{},n.id).enableSimplifyTransformed(),!1,e)}function LR(n,e){if(!n)return null;if(Array.isArray(n)){const r=n.map(i=>LR(i,e));return new Ja(r)}const t=Bde[n.type];return lo(new t(n.flatCoordinates,n.layout||"XY",n.ends),!1,e)}class zde extends n7{constructor(){super()}getType(){return"json"}readFeature(e,t){return this.readFeatureFromObject(f_(e),this.getReadOptions(e,t))}readFeatures(e,t){return this.readFeaturesFromObject(f_(e),this.getReadOptions(e,t))}readFeatureFromObject(e,t){return Vt()}readFeaturesFromObject(e,t){return Vt()}readGeometry(e,t){return this.readGeometryFromObject(f_(e),this.getReadOptions(e,t))}readGeometryFromObject(e,t){return Vt()}readProjection(e){return this.readProjectionFromObject(f_(e))}readProjectionFromObject(e){return Vt()}writeFeature(e,t){return JSON.stringify(this.writeFeatureObject(e,t))}writeFeatureObject(e,t){return Vt()}writeFeatures(e,t){return JSON.stringify(this.writeFeaturesObject(e,t))}writeFeaturesObject(e,t){return Vt()}writeGeometry(e,t){return JSON.stringify(this.writeGeometryObject(e,t))}writeGeometryObject(e,t){return Vt()}}function f_(n){if(typeof n=="string"){const e=JSON.parse(n);return e||null}return n!==null?n:null}class OR extends zde{constructor(e){e=e||{},super(),this.dataProjection=qn(e.dataProjection?e.dataProjection:"EPSG:4326"),e.featureProjection&&(this.defaultFeatureProjection=qn(e.featureProjection)),e.featureClass&&(this.featureClass=e.featureClass),this.geometryName_=e.geometryName,this.extractGeometryName_=e.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(e,t){let r=null;e.type==="Feature"?r=e:r={type:"Feature",geometry:e,properties:null};const i=DR(r.geometry);if(this.featureClass===Ws)return r7({geometry:i,id:r.id,properties:r.properties},t);const s=new io;return this.geometryName_?s.setGeometryName(this.geometryName_):this.extractGeometryName_&&r.geometry_name&&s.setGeometryName(r.geometry_name),s.setGeometry(LR(i,t)),"id"in r&&s.setId(r.id),r.properties&&s.setProperties(r.properties,!0),s}readFeaturesFromObject(e,t){const r=e;let i=null;if(r.type==="FeatureCollection"){const s=e;i=[];const a=s.features;for(let o=0,l=a.length;o<l;++o){const u=this.readFeatureFromObject(a[o],t);u&&i.push(u)}}else i=[this.readFeatureFromObject(e,t)];return i.flat()}readGeometryFromObject(e,t){return $de(e,t)}readProjectionFromObject(e){const t=e.crs;let r;if(t)if(t.type=="name")r=qn(t.properties.name);else if(t.type==="EPSG")r=qn("EPSG:"+t.properties.code);else throw new Error("Unknown SRS type");else r=this.dataProjection;return r}writeFeatureObject(e,t){t=this.adaptOptions(t);const r={type:"Feature",geometry:null,properties:null},i=e.getId();if(i!==void 0&&(r.id=i),!e.hasProperties())return r;const s=e.getProperties(),a=e.getGeometry();return a&&(r.geometry=Nb(a,t),delete s[e.getGeometryName()]),Nh(s)||(r.properties=s),r}writeFeaturesObject(e,t){t=this.adaptOptions(t);const r=[];for(let i=0,s=e.length;i<s;++i)r.push(this.writeFeatureObject(e[i],t));return{type:"FeatureCollection",features:r}}writeGeometryObject(e,t){return Nb(e,this.adaptOptions(t))}}function DR(n,e){if(!n)return null;let t;switch(n.type){case"Point":{t=Hde(n);break}case"LineString":{t=Kde(n);break}case"Polygon":{t=Zde(n);break}case"MultiPoint":{t=qde(n);break}case"MultiLineString":{t=Yde(n);break}case"MultiPolygon":{t=Xde(n);break}case"GeometryCollection":{t=Wde(n);break}default:throw new Error("Unsupported GeoJSON type: "+n.type)}return t}function $de(n,e){const t=DR(n);return LR(t,e)}function Wde(n,e){return n.geometries.map(function(r){return DR(r)})}function Hde(n){const e=n.coordinates;return{type:"Point",flatCoordinates:e,layout:od(e.length)}}function Kde(n){const e=n.coordinates,t=e.flat();return{type:"LineString",flatCoordinates:t,ends:[t.length],layout:od(e[0]?.length||2)}}function Yde(n){const e=n.coordinates,t=e[0]?.[0]?.length||2,r=[],i=Wp(r,0,e,t);return{type:"MultiLineString",flatCoordinates:r,ends:i,layout:od(t)}}function qde(n){const e=n.coordinates;return{type:"MultiPoint",flatCoordinates:e.flat(),layout:od(e[0]?.length||2)}}function Xde(n){const e=n.coordinates,t=[],r=e[0]?.[0]?.[0].length||2,i=c5(t,0,e,r);return{type:"MultiPolygon",flatCoordinates:t,ends:i,layout:od(r)}}function Zde(n){const e=n.coordinates,t=[],r=e[0]?.[0]?.length,i=Wp(t,0,e,r);return{type:"Polygon",flatCoordinates:t,ends:i,layout:od(r)}}function Nb(n,e){n=lo(n,!0,e);const t=n.getType();let r;switch(t){case"Point":{r=rfe(n);break}case"LineString":{r=Jde(n);break}case"Polygon":{r=ife(n,e);break}case"MultiPoint":{r=tfe(n);break}case"MultiLineString":{r=efe(n);break}case"MultiPolygon":{r=nfe(n,e);break}case"GeometryCollection":{r=Qde(n,e);break}case"Circle":{r={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+t)}return r}function Qde(n,e){return e=Object.assign({},e),delete e.featureProjection,{type:"GeometryCollection",geometries:n.getGeometriesArray().map(function(r){return Nb(r,e)})}}function Jde(n,e){return{type:"LineString",coordinates:n.getCoordinates()}}function efe(n,e){return{type:"MultiLineString",coordinates:n.getCoordinates()}}function tfe(n,e){return{type:"MultiPoint",coordinates:n.getCoordinates()}}function nfe(n,e){let t;return e&&(t=e.rightHanded),{type:"MultiPolygon",coordinates:n.getCoordinates(t)}}function rfe(n,e){return{type:"Point",coordinates:n.getCoordinates()}}function ife(n,e){let t;return e&&(t=e.rightHanded),{type:"Polygon",coordinates:n.getCoordinates(t)}}const lv="http://www.w3.org/2001/XMLSchema-instance";function yd(n,e){return W0().createElementNS(n,e)}function co(n,e){return i7(n,e,[]).join("")}function i7(n,e,t){if(n.nodeType==Node.CDATA_SECTION_NODE||n.nodeType==Node.TEXT_NODE)t.push(n.nodeValue);else{let r;for(r=n.firstChild;r;r=r.nextSibling)i7(r,e,t)}return t}function Al(n){return"documentElement"in n}function Rl(n){return new DOMParser().parseFromString(n,"application/xml")}function VL(n,e){return(function(t,r){const i=n.call(e??this,t,r);if(i!==void 0){const s=r[r.length-1];Nn(s,i)}})}function Ka(n,e){return(function(t,r){const i=n.call(e??this,t,r);i!==void 0&&r[r.length-1].push(i)})}function FR(n,e){return(function(t,r){const i=n.call(this,t,r);i!==void 0&&(r[r.length-1]=i)})}function Fe(n,e,t){return(function(r,i){const s=n.call(this,r,i);if(s!==void 0){const a=i[i.length-1],o=e!==void 0?e:r.localName;a[o]=s}})}function Qe(n,e){return(function(t,r,i){n.call(this,t,r,i),i[i.length-1].node.appendChild(t)})}function s7(n,e){let t,r;return function(i,s,a){if(t===void 0){t={};const o={};o[i.localName]=n,t[i.namespaceURI]=o,r=uo(i.localName)}a7(t,r,s,a)}}function uo(n,e){return(function(t,r,i){const a=r[r.length-1].node;let o=n;o===void 0&&(o=i);const l=a.namespaceURI;return yd(l,o)})}const qi=uo();function Cs(n,e){const t=e.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=n[e[i]];return r}function ut(n,e,t){t=t!==void 0?t:{};let r,i;for(r=0,i=n.length;r<i;++r)t[n[r]]=e;return t}function Cu(n,e,t,r){let i;for(i=e.firstElementChild;i;i=i.nextElementSibling){const s=n[i.namespaceURI];if(s!==void 0){const a=s[i.localName];a!==void 0&&a.call(r,i,t)}}}function fn(n,e,t,r,i){return r.push(n),Cu(e,t,r,i),r.pop()}function a7(n,e,t,r,i,s){const a=(i!==void 0?i:t).length;let o,l;for(let u=0;u<a;++u)o=t[u],o!==void 0&&(l=e.call(s,o,r,i!==void 0?i[u]:void 0),l!==void 0&&n[l.namespaceURI][l.localName].call(s,l,o,r))}function Jn(n,e,t,r,i,s,a){return i.push(n),a7(e,t,r,i,s,a),i.pop()}let LS;function sfe(){return LS===void 0&&typeof XMLSerializer<"u"&&(LS=new XMLSerializer),LS}let OS;function W0(){return OS===void 0&&typeof document<"u"&&(OS=document.implementation.createDocument("","",null)),OS}class o7 extends n7{constructor(){super(),this.xmlSerializer_=sfe()}getType(){return"xml"}readFeature(e,t){if(!e)return null;if(typeof e=="string"){const r=Rl(e);return this.readFeatureFromDocument(r,t)}return Al(e)?this.readFeatureFromDocument(e,t):this.readFeatureFromNode(e,t)}readFeatureFromDocument(e,t){const r=this.readFeaturesFromDocument(e,t);return r.length>0?r[0]:null}readFeatureFromNode(e,t){return null}readFeatures(e,t){if(!e)return[];if(typeof e=="string"){const r=Rl(e);return this.readFeaturesFromDocument(r,t)}return Al(e)?this.readFeaturesFromDocument(e,t):this.readFeaturesFromNode(e,t)}readFeaturesFromDocument(e,t){const r=[];for(let i=e.firstChild;i;i=i.nextSibling)i.nodeType==Node.ELEMENT_NODE&&Nn(r,this.readFeaturesFromNode(i,t));return r}readFeaturesFromNode(e,t){return Vt()}readGeometry(e,t){if(!e)return null;if(typeof e=="string"){const r=Rl(e);return this.readGeometryFromDocument(r,t)}return Al(e)?this.readGeometryFromDocument(e,t):this.readGeometryFromNode(e,t)}readGeometryFromDocument(e,t){return null}readGeometryFromNode(e,t){return null}readProjection(e){if(!e)return null;if(typeof e=="string"){const t=Rl(e);return this.readProjectionFromDocument(t)}return Al(e)?this.readProjectionFromDocument(e):this.readProjectionFromNode(e)}readProjectionFromDocument(e){return this.dataProjection}readProjectionFromNode(e){return this.dataProjection}writeFeature(e,t){const r=this.writeFeatureNode(e,t);return this.xmlSerializer_.serializeToString(r)}writeFeatureNode(e,t){return null}writeFeatures(e,t){const r=this.writeFeaturesNode(e,t);return this.xmlSerializer_.serializeToString(r)}writeFeaturesNode(e,t){return null}writeGeometry(e,t){const r=this.writeGeometryNode(e,t);return this.xmlSerializer_.serializeToString(r)}writeGeometryNode(e,t){return null}}function xu(n){const e=co(n,!1);return afe(e)}function afe(n){const e=/^\s*(true|1)|(false|0)\s*$/.exec(n);if(e)return e[1]!==void 0||!1}function Fw(n){const e=co(n,!1),t=Date.parse(e);return isNaN(t)?void 0:t/1e3}function Tn(n){const e=co(n,!1);return ofe(e)}function ofe(n){const e=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(n);if(e)return parseFloat(e[1])}function Cp(n){const e=co(n,!1);return lfe(e)}function lfe(n){const e=/^\s*(\d+)\s*$/.exec(n);if(e)return parseInt(e[1],10)}function rn(n){return co(n,!1).trim()}function k0(n,e){Cn(n,e?"1":"0")}function cfe(n,e){n.appendChild(W0().createCDATASection(e))}function ufe(n,e){const t=new Date(e*1e3),r=t.getUTCFullYear()+"-"+Ng(t.getUTCMonth()+1,2)+"-"+Ng(t.getUTCDate(),2)+"T"+Ng(t.getUTCHours(),2)+":"+Ng(t.getUTCMinutes(),2)+":"+Ng(t.getUTCSeconds(),2)+"Z";n.appendChild(W0().createTextNode(r))}function xs(n,e){const t=e.toPrecision();n.appendChild(W0().createTextNode(t))}function cv(n,e){const t=e.toString();n.appendChild(W0().createTextNode(t))}const hfe=/^\s/,dfe=/\s$/,ffe=/(\n|\t|\r|<|&| {2})/;function Cn(n,e){typeof e=="string"&&(hfe.test(e)||dfe.test(e)||ffe.test(e))?e.split("]]>").forEach((t,r,i)=>{r<i.length-1&&(t+="]]"),r>0&&(t=">"+t),cfe(n,t)}):n.appendChild(W0().createTextNode(e))}const or=[null,"http://www.topografix.com/GPX/1/0","http://www.topografix.com/GPX/1/1"],gfe="http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd",mfe={rte:l7,trk:c7,wpt:u7},pfe=ut(or,{rte:Ka(l7),trk:Ka(c7),wpt:Ka(u7)}),yfe=ut(or,{text:Fe(rn,"linkText"),type:Fe(rn,"linkType")}),_fe=ut(or,{name:Fe(rn),email:Wfe,link:C1}),xfe=ut(or,{name:Fe(rn),desc:Fe(rn),author:Fe(Ufe),copyright:Fe(zfe),link:C1,time:Fe(Fw),keywords:Fe(rn),bounds:$fe,extensions:jw}),vfe=ut(or,{year:Fe(Cp),license:Fe(rn)}),wfe=ut(or,{rte:Qe(qfe),trk:Qe(Xfe),wpt:Qe(Qfe)});class Efe extends o7{constructor(e){super(),e=e||{},this.dataProjection=qn("EPSG:4326"),this.readExtensions_=e.readExtensions}handleReadExtensions_(e){e||(e=[]);for(let t=0,r=e.length;t<r;++t){const i=e[t];if(this.readExtensions_){const s=i.get("extensionsNode_")||null;this.readExtensions_(i,s)}i.set("extensionsNode_",void 0)}}readMetadata(e){return e?typeof e=="string"?this.readMetadataFromDocument(Rl(e)):Al(e)?this.readMetadataFromDocument(e):this.readMetadataFromNode(e):null}readMetadataFromDocument(e){for(let t=e.firstChild;t;t=t.nextSibling)if(t.nodeType===Node.ELEMENT_NODE){const r=this.readMetadataFromNode(t);if(r)return r}return null}readMetadataFromNode(e){if(!or.includes(e.namespaceURI))return null;for(let t=e.firstElementChild;t;t=t.nextElementSibling)if(or.includes(t.namespaceURI)&&t.localName==="metadata")return fn({},xfe,t,[]);return null}readFeatureFromNode(e,t){if(!or.includes(e.namespaceURI))return null;const r=mfe[e.localName];if(!r)return null;const i=r(e,[this.getReadOptions(e,t)]);return i?(this.handleReadExtensions_([i]),i):null}readFeaturesFromNode(e,t){if(!or.includes(e.namespaceURI))return[];if(e.localName=="gpx"){const r=fn([],pfe,e,[this.getReadOptions(e,t)]);return r?(this.handleReadExtensions_(r),r):[]}return[]}writeFeaturesNode(e,t){t=this.adaptOptions(t);const r=yd("http://www.topografix.com/GPX/1/1","gpx");return r.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xsi",lv),r.setAttributeNS(lv,"xsi:schemaLocation",gfe),r.setAttribute("version","1.1"),r.setAttribute("creator","OpenLayers"),Jn({node:r},wfe,Bfe,e,[t]),r}}const Sfe=ut(or,{name:Fe(rn),cmt:Fe(rn),desc:Fe(rn),src:Fe(rn),link:C1,number:Fe(Cp),extensions:jw,type:Fe(rn),rtept:Hfe}),Tfe=ut(or,{ele:Fe(Tn),time:Fe(Fw)}),bfe=ut(or,{name:Fe(rn),cmt:Fe(rn),desc:Fe(rn),src:Fe(rn),link:C1,number:Fe(Cp),type:Fe(rn),extensions:jw,trkseg:Yfe}),Ife=ut(or,{trkpt:Kfe}),Afe=ut(or,{ele:Fe(Tn),time:Fe(Fw)}),Rfe=ut(or,{ele:Fe(Tn),time:Fe(Fw),magvar:Fe(Tn),geoidheight:Fe(Tn),name:Fe(rn),cmt:Fe(rn),desc:Fe(rn),src:Fe(rn),link:C1,sym:Fe(rn),type:Fe(rn),fix:Fe(rn),sat:Fe(Cp),hdop:Fe(Tn),vdop:Fe(Tn),pdop:Fe(Tn),ageofdgpsdata:Fe(Tn),dgpsid:Fe(Cp),extensions:jw}),Cfe=["text","type"],Pfe=ut(or,{text:Qe(Cn),type:Qe(Cn)}),kfe=ut(or,["name","cmt","desc","src","link","number","type","rtept"]),Mfe=ut(or,{name:Qe(Cn),cmt:Qe(Cn),desc:Qe(Cn),src:Qe(Cn),link:Qe(GR),number:Qe(cv),type:Qe(Cn),rtept:s7(Qe(BR))}),Nfe=ut(or,["ele","time"]),Lfe=ut(or,["name","cmt","desc","src","link","number","type","trkseg"]),Ofe=ut(or,{name:Qe(Cn),cmt:Qe(Cn),desc:Qe(Cn),src:Qe(Cn),link:Qe(GR),number:Qe(cv),type:Qe(Cn),trkseg:s7(Qe(Zfe))}),Dfe=uo("trkpt"),Ffe=ut(or,{trkpt:Qe(BR)}),jfe=ut(or,["ele","time","magvar","geoidheight","name","cmt","desc","src","link","sym","type","fix","sat","hdop","vdop","pdop","ageofdgpsdata","dgpsid"]),Vfe=ut(or,{ele:Qe(xs),time:Qe(ufe),magvar:Qe(xs),geoidheight:Qe(xs),name:Qe(Cn),cmt:Qe(Cn),desc:Qe(Cn),src:Qe(Cn),link:Qe(GR),sym:Qe(Cn),type:Qe(Cn),fix:Qe(Cn),sat:Qe(cv),hdop:Qe(xs),vdop:Qe(xs),pdop:Qe(xs),ageofdgpsdata:Qe(xs),dgpsid:Qe(cv)}),Gfe={Point:"wpt",LineString:"rte",MultiLineString:"trk"};function Bfe(n,e,t){const r=n.getGeometry();if(r){const i=Gfe[r.getType()];if(i){const s=e[e.length-1].node;return yd(s.namespaceURI,i)}}}function jR(n,e,t,r){return n.push(parseFloat(t.getAttribute("lon")),parseFloat(t.getAttribute("lat"))),"ele"in r?(n.push(r.ele),delete r.ele,e.hasZ=!0):n.push(0),"time"in r?(n.push(r.time),delete r.time,e.hasM=!0):n.push(0),n}function VR(n,e,t){let r="XY",i=2;if(n.hasZ&&n.hasM?(r="XYZM",i=4):n.hasZ?(r="XYZ",i=3):n.hasM&&(r="XYM",i=3),i!==4){for(let s=0,a=e.length/4;s<a;s++)e[s*i]=e[s*4],e[s*i+1]=e[s*4+1],n.hasZ&&(e[s*i+2]=e[s*4+2]),n.hasM&&(e[s*i+2]=e[s*4+3]);if(e.length=e.length/4*i,t)for(let s=0,a=t.length;s<a;s++)t[s]=t[s]/4*i}return r}function Ufe(n,e){const t=fn({},_fe,n,e);if(t)return t}function zfe(n,e){const t=fn({},vfe,n,e);if(t){const r=n.getAttribute("author");return r!==null&&(t.author=r),t}}function $fe(n,e){const t=e[e.length-1],r=n.getAttribute("minlat"),i=n.getAttribute("minlon"),s=n.getAttribute("maxlat"),a=n.getAttribute("maxlon");i!==null&&r!==null&&a!==null&&s!==null&&(t.bounds=[[parseFloat(i),parseFloat(r)],[parseFloat(a),parseFloat(s)]])}function Wfe(n,e){const t=e[e.length-1],r=n.getAttribute("id"),i=n.getAttribute("domain");r!==null&&i!==null&&(t.email=`${r}@${i}`)}function C1(n,e){const t=e[e.length-1],r=n.getAttribute("href");r!==null&&(t.link=r),Cu(yfe,n,e)}function jw(n,e){const t=e[e.length-1];t.extensionsNode_=n}function Hfe(n,e){const t=fn({},Tfe,n,e);if(t){const r=e[e.length-1],i=r.flatCoordinates,s=r.layoutOptions;jR(i,s,n,t)}}function Kfe(n,e){const t=fn({},Afe,n,e);if(t){const r=e[e.length-1],i=r.flatCoordinates,s=r.layoutOptions;jR(i,s,n,t)}}function Yfe(n,e){const t=e[e.length-1];Cu(Ife,n,e);const r=t.flatCoordinates;t.ends.push(r.length)}function l7(n,e){const t=e[0],r=fn({flatCoordinates:[],layoutOptions:{}},Sfe,n,e);if(!r)return;const i=r.flatCoordinates;delete r.flatCoordinates;const s=r.layoutOptions;delete r.layoutOptions;const a=VR(s,i),o=new so(i,a);lo(o,!1,t);const l=new io(o);return l.setProperties(r,!0),l}function c7(n,e){const t=e[0],r=fn({flatCoordinates:[],ends:[],layoutOptions:{}},bfe,n,e);if(!r)return;const i=r.flatCoordinates;delete r.flatCoordinates;const s=r.ends;delete r.ends;const a=r.layoutOptions;delete r.layoutOptions;const o=VR(a,i,s),l=new Vl(i,o,s);lo(l,!1,t);const u=new io(l);return u.setProperties(r,!0),u}function u7(n,e){const t=e[0],r=fn({},Rfe,n,e);if(!r)return;const i={},s=jR([],i,n,r),a=VR(i,s),o=new Js(s,a);lo(o,!1,t);const l=new io(o);return l.setProperties(r,!0),l}function GR(n,e,t){n.setAttribute("href",e);const i=t[t.length-1].properties,s=[i.linkText,i.linkType];Jn({node:n},Pfe,qi,s,t,Cfe)}function BR(n,e,t){const r=t[t.length-1],s=r.node.namespaceURI,a=r.properties;switch(n.setAttributeNS(null,"lat",String(e[1])),n.setAttributeNS(null,"lon",String(e[0])),r.geometryLayout){case"XYZM":e[3]!==0&&(a.time=e[3]);case"XYZ":e[2]!==0&&(a.ele=e[2]);break;case"XYM":e[2]!==0&&(a.time=e[2]);break}const l=n.nodeName=="rtept"?Nfe[s]:jfe[s],u=Cs(a,l);Jn({node:n,properties:a},Vfe,qi,u,t,l)}function qfe(n,e,t){const r=t[0],i=e.getProperties(),s={node:n};s.properties=i;const a=e.getGeometry();if(a.getType()=="LineString"){const h=lo(a,!0,r);s.geometryLayout=h.getLayout(),i.rtept=h.getCoordinates()}const o=t[t.length-1].node,l=kfe[o.namespaceURI],u=Cs(i,l);Jn(s,Mfe,qi,u,t,l)}function Xfe(n,e,t){const r=t[0],i=e.getProperties(),s={node:n};s.properties=i;const a=e.getGeometry();if(a.getType()=="MultiLineString"){const h=lo(a,!0,r);i.trkseg=h.getLineStrings()}const o=t[t.length-1].node,l=Lfe[o.namespaceURI],u=Cs(i,l);Jn(s,Ofe,qi,u,t,l)}function Zfe(n,e,t){const r={node:n};r.geometryLayout=e.getLayout(),r.properties={},Jn(r,Ffe,Dfe,e.getCoordinates(),t)}function Qfe(n,e,t){const r=t[0],i=t[t.length-1];i.properties=e.getProperties();const s=e.getGeometry();if(s.getType()=="Point"){const a=lo(s,!0,r);i.geometryLayout=a.getLayout(),BR(n,a.getCoordinates(),t)}}const Jl=["http://www.google.com/kml/ext/2.2"],bt=[null,"http://earth.google.com/kml/2.0","http://earth.google.com/kml/2.1","http://earth.google.com/kml/2.2","http://www.opengis.net/kml/2.2"],Jfe="http://www.opengis.net/kml/2.2 https://developers.google.com/kml/schema/kml22gx.xsd",GL={fraction:"fraction",pixels:"pixels",insetPixels:"pixels"},e0e=ut(bt,{ExtendedData:b7,Region:I7,MultiGeometry:Fe(E7,"geometry"),LineString:Fe(v7,"geometry"),LinearRing:Fe(w7,"geometry"),Point:Fe(S7,"geometry"),Polygon:Fe(T7,"geometry"),Style:Fe($R),StyleMap:F0e,address:Fe(rn),description:Fe(rn),name:Fe(rn),open:Fe(xu),phoneNumber:Fe(rn),styleUrl:Fe(m7),visibility:Fe(xu)},ut(Jl,{MultiTrack:Fe(T0e,"geometry"),Track:Fe(x7,"geometry")})),t0e=ut(bt,{ExtendedData:b7,Region:I7,Link:q0e,address:Fe(rn),description:Fe(rn),name:Fe(rn),open:Fe(xu),phoneNumber:Fe(rn),visibility:Fe(xu)}),n0e=ut(bt,{href:Fe(g7)}),r0e=ut(bt,{Altitude:Fe(Tn),Longitude:Fe(Tn),Latitude:Fe(Tn),Tilt:Fe(Tn),AltitudeMode:Fe(rn),Heading:Fe(Tn),Roll:Fe(Tn)}),h7=ut(bt,{LatLonAltBox:U0e,Lod:$0e}),i0e=ut(bt,["Document","Placemark"]),s0e=ut(bt,{Document:Qe(rge),Placemark:Qe(C7)});let e0,X_=null,Lb,Nm,Lm,Om,uv,Ob=null,UR,Db=null,Fb,Sh=null,BL=null,jb=null;function hv(n){return 32/Math.min(n[0],n[1])}function a0e(){e0=[255,255,255,1],X_=new Wr({color:e0}),Lb=[20,2],Nm="pixels",Lm="pixels",Om=[64,64],uv="https://maps.google.com/mapfiles/kml/pushpin/ylw-pushpin.png",Ob=new qp({anchor:Lb,anchorOrigin:"bottom-left",anchorXUnits:Nm,anchorYUnits:Lm,crossOrigin:"anonymous",rotation:0,scale:hv(Om),size:Om,src:uv}),UR="NO_IMAGE",Db=new Ci({color:e0,width:1}),Fb=new Ci({color:[51,51,51,1],width:2}),Sh=new cd({font:"bold 16px Helvetica",fill:X_,stroke:Fb,scale:.8}),BL=new nr({fill:X_,image:Ob,text:Sh,stroke:Db,zIndex:0}),jb=[BL]}let g_;function o0e(n){return n}class l0e extends o7{constructor(e){super(),e=e||{},jb||a0e(),this.dataProjection=qn("EPSG:4326"),this.defaultStyle_=e.defaultStyle?e.defaultStyle:jb,this.extractStyles_=e.extractStyles!==void 0?e.extractStyles:!0,this.writeStyles_=e.writeStyles!==void 0?e.writeStyles:!0,this.sharedStyles_={},this.showPointNames_=e.showPointNames!==void 0?e.showPointNames:!0,this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",this.iconUrlFunction_=e.iconUrlFunction?e.iconUrlFunction:o0e,this.supportedMediaTypes=["application/vnd.google-earth.kml+xml"]}readDocumentOrFolder_(e,t){const r=ut(bt,{Document:VL(this.readDocumentOrFolder_,this),Folder:VL(this.readDocumentOrFolder_,this),Placemark:Ka(this.readPlacemark_,this),Style:this.readSharedStyle_.bind(this),StyleMap:this.readSharedStyleMap_.bind(this)}),i=fn([],r,e,t,this);if(i)return i}readPlacemark_(e,t){const r=fn({geometry:null},e0e,e,t,this);if(!r)return;const i=new io,s=e.getAttribute("id");s!==null&&i.setId(s);const a=t[0],o=r.geometry;if(o&&lo(o,!1,a),i.setGeometry(o),delete r.geometry,this.extractStyles_){const l=r.Style,u=r.styleUrl,h=u0e(l,u,this.defaultStyle_,this.sharedStyles_,this.showPointNames_);i.setStyle(h)}return delete r.Style,i.setProperties(r,!0),i}readSharedStyle_(e,t){const r=e.getAttribute("id");if(r!==null){const i=$R.call(this,e,t);if(i){let s,a=e.baseURI;(!a||a=="about:blank")&&(a=window.location.href),a?s=new URL("#"+r,a).href:s="#"+r,this.sharedStyles_[s]=i}}}readSharedStyleMap_(e,t){const r=e.getAttribute("id");if(r===null)return;const i=y7.call(this,e,t);if(!i)return;let s,a=e.baseURI;(!a||a=="about:blank")&&(a=window.location.href),a?s=new URL("#"+r,a).href:s="#"+r,this.sharedStyles_[s]=i}readFeatureFromNode(e,t){if(!bt.includes(e.namespaceURI))return null;const r=this.readPlacemark_(e,[this.getReadOptions(e,t)]);return r||null}readFeaturesFromNode(e,t){if(!bt.includes(e.namespaceURI))return[];let r;const i=e.localName;if(i=="Document"||i=="Folder")return r=this.readDocumentOrFolder_(e,[this.getReadOptions(e,t)]),r||[];if(i=="Placemark"){const s=this.readPlacemark_(e,[this.getReadOptions(e,t)]);return s?[s]:[]}if(i=="kml"){r=[];for(let s=e.firstElementChild;s;s=s.nextElementSibling){const a=this.readFeaturesFromNode(s,t);a&&Nn(r,a)}return r}return[]}readName(e){if(e){if(typeof e=="string"){const t=Rl(e);return this.readNameFromDocument(t)}return Al(e)?this.readNameFromDocument(e):this.readNameFromNode(e)}}readNameFromDocument(e){for(let t=e.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE){const r=this.readNameFromNode(t);if(r)return r}}readNameFromNode(e){for(let t=e.firstElementChild;t;t=t.nextElementSibling)if(bt.includes(t.namespaceURI)&&t.localName=="name")return rn(t);for(let t=e.firstElementChild;t;t=t.nextElementSibling){const r=t.localName;if(bt.includes(t.namespaceURI)&&(r=="Document"||r=="Folder"||r=="Placemark"||r=="kml")){const i=this.readNameFromNode(t);if(i)return i}}}readNetworkLinks(e){const t=[];if(typeof e=="string"){const r=Rl(e);Nn(t,this.readNetworkLinksFromDocument(r))}else Al(e)?Nn(t,this.readNetworkLinksFromDocument(e)):Nn(t,this.readNetworkLinksFromNode(e));return t}readNetworkLinksFromDocument(e){const t=[];for(let r=e.firstChild;r;r=r.nextSibling)r.nodeType==Node.ELEMENT_NODE&&Nn(t,this.readNetworkLinksFromNode(r));return t}readNetworkLinksFromNode(e){const t=[];for(let r=e.firstElementChild;r;r=r.nextElementSibling)if(bt.includes(r.namespaceURI)&&r.localName=="NetworkLink"){const i=fn({},t0e,r,[]);t.push(i)}for(let r=e.firstElementChild;r;r=r.nextElementSibling){const i=r.localName;bt.includes(r.namespaceURI)&&(i=="Document"||i=="Folder"||i=="kml")&&Nn(t,this.readNetworkLinksFromNode(r))}return t}readRegion(e){const t=[];if(typeof e=="string"){const r=Rl(e);Nn(t,this.readRegionFromDocument(r))}else Al(e)?Nn(t,this.readRegionFromDocument(e)):Nn(t,this.readRegionFromNode(e));return t}readRegionFromDocument(e){const t=[];for(let r=e.firstChild;r;r=r.nextSibling)r.nodeType==Node.ELEMENT_NODE&&Nn(t,this.readRegionFromNode(r));return t}readRegionFromNode(e){const t=[];for(let r=e.firstElementChild;r;r=r.nextElementSibling)if(bt.includes(r.namespaceURI)&&r.localName=="Region"){const i=fn({},h7,r,[]);t.push(i)}for(let r=e.firstElementChild;r;r=r.nextElementSibling){const i=r.localName;bt.includes(r.namespaceURI)&&(i=="Document"||i=="Folder"||i=="kml")&&Nn(t,this.readRegionFromNode(r))}return t}readCamera(e){const t=[];if(typeof e=="string"){const r=Rl(e);Nn(t,this.readCameraFromDocument(r))}else Al(e)?Nn(t,this.readCameraFromDocument(e)):Nn(t,this.readCameraFromNode(e));return t}readCameraFromDocument(e){const t=[];for(let r=e.firstChild;r;r=r.nextSibling)r.nodeType===Node.ELEMENT_NODE&&Nn(t,this.readCameraFromNode(r));return t}readCameraFromNode(e){const t=[];for(let r=e.firstElementChild;r;r=r.nextElementSibling)if(bt.includes(r.namespaceURI)&&r.localName==="Camera"){const i=fn({},r0e,r,[]);t.push(i)}for(let r=e.firstElementChild;r;r=r.nextElementSibling){const i=r.localName;bt.includes(r.namespaceURI)&&(i==="Document"||i==="Folder"||i==="Placemark"||i==="kml")&&Nn(t,this.readCameraFromNode(r))}return t}writeFeaturesNode(e,t){t=this.adaptOptions(t);const r=yd(bt[4],"kml"),i="http://www.w3.org/2000/xmlns/";r.setAttributeNS(i,"xmlns:gx",Jl[0]),r.setAttributeNS(i,"xmlns:xsi",lv),r.setAttributeNS(lv,"xsi:schemaLocation",Jfe);const s={node:r},a={};e.length>1?a.Document=e:e.length==1&&(a.Placemark=e[0]);const o=i0e[r.namespaceURI],l=Cs(a,o);return Jn(s,s0e,qi,l,[t],o,this),r}}function c0e(n,e){const t=[0,0];let r="start";const i=n.getImage();if(i){const o=i.getSize();if(o&&o.length==2){const l=i.getScaleArray(),u=i.getAnchor();t[0]=l[0]*(o[0]-u[0]),t[1]=l[1]*(o[1]/2-u[1]),r="left"}}let s=n.getText();return s?(s=s.clone(),s.setFont(s.getFont()||Sh.getFont()),s.setScale(s.getScale()||Sh.getScale()),s.setFill(s.getFill()||Sh.getFill()),s.setStroke(s.getStroke()||Fb)):s=Sh.clone(),s.setText(e),s.setOffsetX(t[0]),s.setOffsetY(t[1]),s.setTextAlign(r),new nr({image:i,text:s})}function u0e(n,e,t,r,i){return(function(s,a){let o=i,l="",u=[];if(o){const f=s.getGeometry();if(f)if(f instanceof Ja)u=f.getGeometriesArrayRecursive().filter(function(g){const y=g.getType();return y==="Point"||y==="MultiPoint"}),o=u.length>0;else{const g=f.getType();o=g==="Point"||g==="MultiPoint"}}o&&(l=s.get("name"),o=o&&!!l,o&&/&[^&]+;/.test(l)&&(g_||(g_=document.createElement("textarea")),g_.innerHTML=l,l=g_.value));let h=t;if(n?h=n:e&&(h=d7(e,t,r)),o){const f=c0e(h[0],l);if(u.length>0){f.setGeometry(new Ja(u));const g=new nr({geometry:h[0].getGeometry(),image:null,fill:h[0].getFill(),stroke:h[0].getStroke(),text:null});return[f,g].concat(h.slice(1))}return f}return h})}function d7(n,e,t){return Array.isArray(n)?n:typeof n=="string"?d7(t[n],e,t):e}function Vw(n){const e=co(n,!1),t=/^\s*#?\s*([0-9A-Fa-f]{8})\s*$/.exec(e);if(t){const r=t[1];return[parseInt(r.substr(6,2),16),parseInt(r.substr(4,2),16),parseInt(r.substr(2,2),16),parseInt(r.substr(0,2),16)/255]}}function f7(n){let e=co(n,!1);const t=[];e=e.replace(/\s*,\s*/g,",");const r=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?),([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s+|,|$)(?:([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s+|$))?\s*/i;let i;for(;i=r.exec(e);){const s=parseFloat(i[1]),a=parseFloat(i[2]),o=i[3]?parseFloat(i[3]):0;t.push(s,a,o),e=e.substr(i[0].length)}if(e==="")return t}function g7(n){const e=co(n,!1).trim();let t=n.baseURI;return(!t||t=="about:blank")&&(t=window.location.href),t?new URL(e,t).href:e}function m7(n){const e=co(n,!1).trim().replace(/^(?!.*#)/,"#");let t=n.baseURI;return(!t||t=="about:blank")&&(t=window.location.href),t?new URL(e,t).href:e}function h0e(n){const e=n.getAttribute("xunits"),t=n.getAttribute("yunits");let r;return e!=="insetPixels"?t!=="insetPixels"?r="bottom-left":r="top-left":t!=="insetPixels"?r="bottom-right":r="top-right",{x:parseFloat(n.getAttribute("x")),xunits:GL[e],y:parseFloat(n.getAttribute("y")),yunits:GL[t],origin:r}}function p7(n){return Tn(n)}const d0e=ut(bt,{Pair:D0e});function y7(n,e){return fn(void 0,d0e,n,e,this)}const f0e=ut(bt,{Icon:Fe(A0e),color:Fe(Vw),heading:Fe(Tn),hotSpot:Fe(h0e),scale:Fe(p7)});function g0e(n,e){const t=fn({},f0e,n,e);if(!t)return;const r=e[e.length-1],i="Icon"in t?t.Icon:{},s=!("Icon"in t)||Object.keys(i).length>0;let a;const o=i.href;o?a=o:s&&(a=uv);let l,u,h,f="bottom-left";const g=t.hotSpot;g?(l=[g.x,g.y],u=g.xunits,h=g.yunits,f=g.origin):/^https?:\/\/maps\.(?:google|gstatic)\.com\//.test(a)&&(a.includes("pushpin")?(l=Lb,u=Nm,h=Lm):a.includes("arrow-reverse")?(l=[54,42],u=Nm,h=Lm):a.includes("paddle")&&(l=[32,1],u=Nm,h=Lm));let y;const v=i.x,x=i.y;v!==void 0&&x!==void 0&&(y=[v,x]);let E;const T=i.w,b=i.h;T!==void 0&&b!==void 0&&(E=[T,b]);let I;const M=t.heading;M!==void 0&&(I=kl(M));const F=t.scale,z=t.color;if(s){a==uv&&(E=Om);const k=new qp({anchor:l,anchorOrigin:f,anchorXUnits:u,anchorYUnits:h,crossOrigin:this.crossOrigin_,offset:y,offsetOrigin:"bottom-left",rotation:I,scale:F,size:E,src:this.iconUrlFunction_(a),color:z}),C=k.getScaleArray()[0],P=k.getSize();if(P===null){const L=k.getImageState();if(L===vt.IDLE||L===vt.LOADING){const O=function(){const U=k.getImageState();if(!(U===vt.IDLE||U===vt.LOADING)){const j=k.getSize();if(j&&j.length==2){const Ie=hv(j);k.setScale(C*Ie)}k.unlistenImageChange(O)}};k.listenImageChange(O),L===vt.IDLE&&k.load()}}else if(P.length==2){const L=hv(P);k.setScale(C*L)}r.imageStyle=k}else r.imageStyle=UR}const m0e=ut(bt,{color:Fe(Vw),scale:Fe(p7)});function p0e(n,e){const t=fn({},m0e,n,e);if(!t)return;const r=e[e.length-1],i=new cd({fill:new Wr({color:"color"in t?t.color:e0}),scale:t.scale});r.textStyle=i}const y0e=ut(bt,{color:Fe(Vw),width:Fe(Tn)});function _0e(n,e){const t=fn({},y0e,n,e);if(!t)return;const r=e[e.length-1],i=new Ci({color:"color"in t?t.color:e0,width:"width"in t?t.width:1});r.strokeStyle=i}const x0e=ut(bt,{color:Fe(Vw),fill:Fe(xu),outline:Fe(xu)});function v0e(n,e){const t=fn({},x0e,n,e);if(!t)return;const r=e[e.length-1],i=new Wr({color:"color"in t?t.color:e0});r.fillStyle=i;const s=t.fill;s!==void 0&&(r.fill=s);const a=t.outline;a!==void 0&&(r.outline=a)}const w0e=ut(bt,{coordinates:FR(f7)});function _7(n,e){return fn(null,w0e,n,e)}function E0e(n,e){const r=e[e.length-1].coordinates,i=co(n,!1),a=/^\s*([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s*$/i.exec(i);if(a){const o=parseFloat(a[1]),l=parseFloat(a[2]),u=parseFloat(a[3]);r.push([o,l,u])}else r.push([])}const S0e=ut(Jl,{Track:Ka(x7)});function T0e(n,e){const t=fn([],S0e,n,e);if(t)return new Vl(t)}const b0e=ut(bt,{when:X0e},ut(Jl,{coord:E0e}));function x7(n,e){const t=fn({coordinates:[],whens:[]},b0e,n,e);if(!t)return;const r=[],i=t.coordinates,s=t.whens;for(let a=0,o=Math.min(i.length,s.length);a<o;++a)i[a].length==3&&r.push(i[a][0],i[a][1],i[a][2],s[a]);return new so(r,"XYZM")}const I0e=ut(bt,{href:Fe(g7)},ut(Jl,{x:Fe(Tn),y:Fe(Tn),w:Fe(Tn),h:Fe(Tn)}));function A0e(n,e){const t=fn({},I0e,n,e);return t||null}const R0e=ut(bt,{coordinates:FR(f7)});function zR(n,e){return fn(null,R0e,n,e)}const Gw=ut(bt,{extrude:Fe(xu),tessellate:Fe(xu),altitudeMode:Fe(rn)});function v7(n,e){const t=fn({},Gw,n,e),r=zR(n,e);if(r){const i=new so(r,"XYZ");return i.setProperties(t,!0),i}}function w7(n,e){const t=fn({},Gw,n,e),r=zR(n,e);if(r){const i=new Ia(r,"XYZ",[r.length]);return i.setProperties(t,!0),i}}const C0e=ut(bt,{LineString:Ka(v7),LinearRing:Ka(w7),MultiGeometry:Ka(E7),Point:Ka(S7),Polygon:Ka(T7)});function E7(n,e){const t=fn([],C0e,n,e);if(!t)return null;if(t.length===0)return new Ja(t);let r,i=!0;const s=t[0].getType();let a;for(let o=1,l=t.length;o<l;++o)if(a=t[o],a.getType()!=s){i=!1;break}if(i){let o,l;if(s=="Point"){const u=t[0];o=u.getLayout(),l=u.getFlatCoordinates();for(let h=1,f=t.length;h<f;++h)a=t[h],Nn(l,a.getFlatCoordinates());r=new ld(l,o),DS(r,t)}else if(s=="LineString")r=new Vl(t),DS(r,t);else if(s=="Polygon")r=new jh(t),DS(r,t);else if(s=="GeometryCollection"||s.startsWith("Multi"))r=new Ja(t);else throw new Error("Unknown geometry type found")}else r=new Ja(t);return r}function S7(n,e){const t=fn({},Gw,n,e),r=zR(n,e);if(r){const i=new Js(r,"XYZ");return i.setProperties(t,!0),i}}const P0e=ut(bt,{innerBoundaryIs:H0e,outerBoundaryIs:Y0e});function T7(n,e){const t=fn({},Gw,n,e),r=fn([null],P0e,n,e);if(r&&r[0]){const i=r[0],s=[i.length];for(let o=1,l=r.length;o<l;++o)Nn(i,r[o]),s.push(i.length);const a=new Ia(i,"XYZ",s);return a.setProperties(t,!0),a}}const k0e=ut(bt,{IconStyle:g0e,LabelStyle:p0e,LineStyle:_0e,PolyStyle:v0e});function $R(n,e){const t=fn({},k0e,n,e,this);if(!t)return null;let r="fillStyle"in t?t.fillStyle:X_;const i=t.fill;i!==void 0&&!i&&(r=null);let s;"imageStyle"in t?t.imageStyle!=UR&&(s=t.imageStyle):s=Ob;const a="textStyle"in t?t.textStyle:Sh,o="strokeStyle"in t?t.strokeStyle:Db,l=t.outline;return l!==void 0&&!l?[new nr({geometry:function(u){const h=u.getGeometry(),f=h.getType();if(f==="GeometryCollection"){const g=h;return new Ja(g.getGeometriesArrayRecursive().filter(function(y){const v=y.getType();return v!=="Polygon"&&v!=="MultiPolygon"}))}if(f!=="Polygon"&&f!=="MultiPolygon")return h},fill:r,image:s,stroke:o,text:a,zIndex:void 0}),new nr({geometry:function(u){const h=u.getGeometry(),f=h.getType();if(f==="GeometryCollection"){const g=h;return new Ja(g.getGeometriesArrayRecursive().filter(function(y){const v=y.getType();return v==="Polygon"||v==="MultiPolygon"}))}if(f==="Polygon"||f==="MultiPolygon")return h},fill:r,stroke:null,zIndex:void 0})]:[new nr({fill:r,image:s,stroke:o,text:a,zIndex:void 0})]}function DS(n,e){const t=e.length,r=new Array(e.length),i=new Array(e.length),s=new Array(e.length);let a,o,l;a=!1,o=!1,l=!1;for(let u=0;u<t;++u){const h=e[u];r[u]=h.get("extrude"),i[u]=h.get("tessellate"),s[u]=h.get("altitudeMode"),a=a||r[u]!==void 0,o=o||i[u]!==void 0,l=l||s[u]}a&&n.set("extrude",r),o&&n.set("tessellate",i),l&&n.set("altitudeMode",s)}const M0e=ut(bt,{displayName:Fe(rn),value:Fe(rn)});function N0e(n,e){const t=n.getAttribute("name");Cu(M0e,n,e);const r=e[e.length-1];t&&r.displayName?r[t]={value:r.value,displayName:r.displayName,toString:function(){return r.value}}:t!==null?r[t]=r.value:r.displayName!==null&&(r[r.displayName]=r.value),delete r.value}const L0e=ut(bt,{Data:N0e,SchemaData:V0e});function b7(n,e){Cu(L0e,n,e)}function I7(n,e){Cu(h7,n,e)}const O0e=ut(bt,{Style:Fe($R),key:Fe(rn),styleUrl:Fe(m7)});function D0e(n,e){const t=fn({},O0e,n,e,this);if(!t)return;const r=t.key;if(r&&r=="normal"){const i=t.styleUrl;i&&(e[e.length-1]=i);const s=t.Style;s&&(e[e.length-1]=s)}}function F0e(n,e){const t=y7.call(this,n,e);if(!t)return;const r=e[e.length-1];if(Array.isArray(t))r.Style=t;else if(typeof t=="string")r.styleUrl=t;else throw new Error("`styleMapValue` has an unknown type")}const j0e=ut(bt,{SimpleData:G0e});function V0e(n,e){Cu(j0e,n,e)}function G0e(n,e){const t=n.getAttribute("name");if(t!==null){const r=rn(n),i=e[e.length-1];i[t]=r}}const B0e=ut(bt,{altitudeMode:Fe(rn),minAltitude:Fe(Tn),maxAltitude:Fe(Tn),north:Fe(Tn),south:Fe(Tn),east:Fe(Tn),west:Fe(Tn)});function U0e(n,e){const t=fn({},B0e,n,e);if(!t)return;const r=e[e.length-1],i=[parseFloat(t.west),parseFloat(t.south),parseFloat(t.east),parseFloat(t.north)];r.extent=i,r.altitudeMode=t.altitudeMode,r.minAltitude=parseFloat(t.minAltitude),r.maxAltitude=parseFloat(t.maxAltitude)}const z0e=ut(bt,{minLodPixels:Fe(Tn),maxLodPixels:Fe(Tn),minFadeExtent:Fe(Tn),maxFadeExtent:Fe(Tn)});function $0e(n,e){const t=fn({},z0e,n,e);if(!t)return;const r=e[e.length-1];r.minLodPixels=parseFloat(t.minLodPixels),r.maxLodPixels=parseFloat(t.maxLodPixels),r.minFadeExtent=parseFloat(t.minFadeExtent),r.maxFadeExtent=parseFloat(t.maxFadeExtent)}const W0e=ut(bt,{LinearRing:Ka(_7)});function H0e(n,e){const t=fn([],W0e,n,e);t.length>0&&e[e.length-1].push(...t)}const K0e=ut(bt,{LinearRing:FR(_7)});function Y0e(n,e){const t=fn(void 0,K0e,n,e);if(t){const r=e[e.length-1];r[0]=t}}function q0e(n,e){Cu(n0e,n,e)}function X0e(n,e){const r=e[e.length-1].whens,i=co(n,!1),s=Date.parse(i);r.push(isNaN(s)?0:s)}function Bw(n,e){const t=Fh(e),i=[(t.length==4?t[3]:1)*255,t[2],t[1],t[0]];for(let s=0;s<4;++s){const a=Math.floor(i[s]).toString(16);i[s]=a.length==1?"0"+a:a}Cn(n,i.join(""))}function Z0e(n,e,t){const r=t[t.length-1],i=r.layout,s=r.stride;let a;if(i=="XY"||i=="XYM")a=2;else if(i=="XYZ"||i=="XYZM")a=3;else throw new Error("Invalid geometry layout");const o=e.length;let l="";if(o>0){l+=e[0];for(let u=1;u<a;++u)l+=","+e[u];for(let u=s;u<o;u+=s){l+=" "+e[u];for(let h=1;h<a;++h)l+=","+e[u+h]}}Cn(n,l)}const Z_=ut(bt,{Data:Qe(Q0e),value:Qe(ege),displayName:Qe(J0e)});function Q0e(n,e,t){n.setAttribute("name",e.name);const r={node:n},i=e.value;typeof i=="object"?(i!==null&&i.displayName&&Jn(r,Z_,qi,[i.displayName],t,["displayName"]),i!==null&&i.value&&Jn(r,Z_,qi,[i.value],t,["value"])):Jn(r,Z_,qi,[i],t,["value"])}function J0e(n,e){Cn(n,e)}function ege(n,e){Cn(n,e)}const tge=ut(bt,{Placemark:Qe(C7)}),nge=function(n,e,t){const r=e[e.length-1].node;return yd(r.namespaceURI,"Placemark")};function rge(n,e,t){Jn({node:n},tge,nge,e,t,void 0,this)}const ige=uo("Data");function sge(n,e,t){const r={node:n},i=e.names,s=e.values,a=i.length;for(let o=0;o<a;o++)Jn(r,Z_,ige,[{name:i[o],value:s[o]}],t)}const UL=ut(bt,["href"],ut(Jl,["x","y","w","h"])),zL=ut(bt,{href:Qe(Cn)},ut(Jl,{x:Qe(xs),y:Qe(xs),w:Qe(xs),h:Qe(xs)})),age=function(n,e,t){return yd(Jl[0],"gx:"+t)};function oge(n,e,t){const r={node:n},i=t[t.length-1].node;let s=UL[i.namespaceURI],a=Cs(e,s);Jn(r,zL,qi,a,t,s),s=UL[Jl[0]],a=Cs(e,s),Jn(r,zL,age,a,t,s)}const lge=ut(bt,["scale","heading","Icon","color","hotSpot"]),cge=ut(bt,{Icon:Qe(oge),color:Qe(Bw),heading:Qe(xs),hotSpot:Qe(Dge),scale:Qe(k7)});function uge(n,e,t){const r={node:n},i={},s=e.getSrc(),a=e.getSize(),o=e.getImageSize(),l={href:s};if(a){l.w=a[0],l.h=a[1];const E=e.getAnchor(),T=e.getOrigin();if(T&&o&&T[0]!==0&&T[1]!==a[1]&&(l.x=T[0],l.y=o[1]-(T[1]+a[1])),E&&(E[0]!==a[0]/2||E[1]!==a[1]/2)){const b={x:E[0],xunits:"pixels",y:a[1]-E[1],yunits:"pixels"};i.hotSpot=b}}i.Icon=l;let u=e.getScaleArray()[0],h=a;if(h===null&&(h=Om),h.length==2){const E=hv(h);u=u/E}u!==1&&(i.scale=u);const f=e.getRotation();f!==0&&(i.heading=f);const g=e.getColor();g&&(i.color=g);const y=t[t.length-1].node,v=lge[y.namespaceURI],x=Cs(i,v);Jn(r,cge,qi,x,t,v)}const hge=ut(bt,["color","scale"]),dge=ut(bt,{color:Qe(Bw),scale:Qe(k7)});function fge(n,e,t){const r={node:n},i={},s=e.getFill();s&&(i.color=s.getColor());const a=e.getScale();a&&a!==1&&(i.scale=a);const o=t[t.length-1].node,l=hge[o.namespaceURI],u=Cs(i,l);Jn(r,dge,qi,u,t,l)}const gge=ut(bt,["color","width"]),mge=ut(bt,{color:Qe(Bw),width:Qe(xs)});function pge(n,e,t){const r={node:n},i={color:e.getColor(),width:Number(e.getWidth())||1},s=t[t.length-1].node,a=gge[s.namespaceURI],o=Cs(i,a);Jn(r,mge,qi,o,t,a)}const yge={Point:"Point",LineString:"LineString",LinearRing:"LinearRing",Polygon:"Polygon",MultiPoint:"MultiGeometry",MultiLineString:"MultiGeometry",MultiPolygon:"MultiGeometry",GeometryCollection:"MultiGeometry"},A7=function(n,e,t){if(n){const r=e[e.length-1].node;return yd(r.namespaceURI,yge[n.getType()])}},_ge=uo("Point"),xge=uo("LineString"),vge=uo("LinearRing"),wge=uo("Polygon"),Ege=ut(bt,{LineString:Qe(t0),Point:Qe(t0),Polygon:Qe(P7),GeometryCollection:Qe(R7)});function R7(n,e,t){const r={node:n},i=e.getType();let s=[],a;if(i==="GeometryCollection")e.getGeometriesArrayRecursive().forEach(function(o){const l=o.getType();if(l==="MultiPoint")s=s.concat(o.getPoints());else if(l==="MultiLineString")s=s.concat(o.getLineStrings());else if(l==="MultiPolygon")s=s.concat(o.getPolygons());else if(l==="Point"||l==="LineString"||l==="Polygon")s.push(o);else throw new Error("Unknown geometry type")}),a=A7;else if(i==="MultiPoint")s=e.getPoints(),a=_ge;else if(i==="MultiLineString")s=e.getLineStrings(),a=xge;else if(i==="MultiPolygon")s=e.getPolygons(),a=wge;else throw new Error("Unknown geometry type");Jn(r,Ege,a,s,t)}const Sge=ut(bt,{LinearRing:Qe(t0)});function $L(n,e,t){Jn({node:n},Sge,vge,[e],t)}const FS=ut(bt,{ExtendedData:Qe(sge),MultiGeometry:Qe(R7),LineString:Qe(t0),LinearRing:Qe(t0),Point:Qe(t0),Polygon:Qe(P7),Style:Qe(Oge),address:Qe(Cn),description:Qe(Cn),name:Qe(Cn),open:Qe(k0),phoneNumber:Qe(Cn),styleUrl:Qe(Cn),visibility:Qe(k0)}),Tge=ut(bt,["name","open","visibility","address","phoneNumber","description","styleUrl","Style"]),bge=uo("ExtendedData");function C7(n,e,t){const r={node:n};e.getId()&&n.setAttribute("id",e.getId());const i=e.getProperties(),s={address:1,description:1,name:1,open:1,phoneNumber:1,styleUrl:1,visibility:1};s[e.getGeometryName()]=1;const a=Object.keys(i||{}).sort().filter(function(y){return!s[y]}),o=e.getStyleFunction();if(o){const y=o(e,0);if(y){const v=Array.isArray(y)?y:[y];let x=v;if(e.getGeometry()&&(x=v.filter(function(E){const T=E.getGeometryFunction()(e);if(T){const b=T.getType();return b==="GeometryCollection"?T.getGeometriesArrayRecursive().filter(function(I){const M=I.getType();return M==="Point"||M==="MultiPoint"}).length:b==="Point"||b==="MultiPoint"}})),this.writeStyles_){let E=v,T=v;e.getGeometry()&&(E=v.filter(function(b){const I=b.getGeometryFunction()(e);if(I){const M=I.getType();return M==="GeometryCollection"?I.getGeometriesArrayRecursive().filter(function(F){const z=F.getType();return z==="LineString"||z==="MultiLineString"}).length:M==="LineString"||M==="MultiLineString"}}),T=v.filter(function(b){const I=b.getGeometryFunction()(e);if(I){const M=I.getType();return M==="GeometryCollection"?I.getGeometriesArrayRecursive().filter(function(F){const z=F.getType();return z==="Polygon"||z==="MultiPolygon"}).length:M==="Polygon"||M==="MultiPolygon"}})),i.Style={pointStyles:x,lineStyles:E,polyStyles:T}}if(x.length&&i.name===void 0){const E=x[0].getText();E&&(i.name=E.getText())}}}const l=t[t.length-1].node,u=Tge[l.namespaceURI],h=Cs(i,u);if(Jn(r,FS,qi,h,t,u),a.length>0){const y=Cs(i,a);Jn(r,FS,bge,[{names:a,values:y}],t)}const f=t[0];let g=e.getGeometry();g&&(g=lo(g,!0,f)),Jn(r,FS,A7,[g],t)}const Ige=ut(bt,["extrude","tessellate","altitudeMode","coordinates"]),Age=ut(bt,{extrude:Qe(k0),tessellate:Qe(k0),altitudeMode:Qe(Cn),coordinates:Qe(Z0e)});function t0(n,e,t){const r=e.getFlatCoordinates(),i={node:n};i.layout=e.getLayout(),i.stride=e.getStride();const s=e.getProperties();s.coordinates=r;const a=t[t.length-1].node,o=Ige[a.namespaceURI],l=Cs(s,o);Jn(i,Age,qi,l,t,o)}const Rge=ut(bt,["color","fill","outline"]),WL=ut(bt,{outerBoundaryIs:Qe($L),innerBoundaryIs:Qe($L)}),Cge=uo("innerBoundaryIs"),Pge=uo("outerBoundaryIs");function P7(n,e,t){const r=e.getLinearRings(),i=r.shift(),s={node:n};Jn(s,WL,Cge,r,t),Jn(s,WL,Pge,[i],t)}const kge=ut(bt,{color:Qe(Bw),fill:Qe(k0),outline:Qe(k0)});function Mge(n,e,t){const r={node:n},i=e.getFill(),s=e.getStroke(),a={color:i?i.getColor():void 0,fill:i?void 0:!1,outline:s?void 0:!1},o=t[t.length-1].node,l=Rge[o.namespaceURI],u=Cs(a,l);Jn(r,kge,qi,u,t,l)}function k7(n,e){xs(n,Math.round(e*1e6)/1e6)}const Nge=ut(bt,["IconStyle","LabelStyle","LineStyle","PolyStyle"]),Lge=ut(bt,{IconStyle:Qe(uge),LabelStyle:Qe(fge),LineStyle:Qe(pge),PolyStyle:Qe(Mge)});function Oge(n,e,t){const r={node:n},i={};if(e.pointStyles.length){const l=e.pointStyles[0].getText();l&&(i.LabelStyle=l);const u=e.pointStyles[0].getImage();u&&typeof u.getSrc=="function"&&(i.IconStyle=u)}if(e.lineStyles.length){const l=e.lineStyles[0].getStroke();l&&(i.LineStyle=l)}if(e.polyStyles.length){const l=e.polyStyles[0].getStroke();l&&!i.LineStyle&&(i.LineStyle=l),i.PolyStyle=e.polyStyles[0]}const s=t[t.length-1].node,a=Nge[s.namespaceURI],o=Cs(i,a);Jn(r,Lge,qi,o,t,a)}function Dge(n,e){n.setAttribute("x",String(e.x)),n.setAttribute("y",String(e.y)),n.setAttribute("xunits",e.xunits),n.setAttribute("yunits",e.yunits)}function M7(n){const e=Object.keys(n.defs),t=e.length;let r,i;for(r=0;r<t;++r){const s=e[r];if(!T_(s)){const a=n.defs(s);let o=a.units;!o&&a.projName==="longlat"&&(o="degrees"),ix(new Nv({code:s,axisOrientation:a.axis,metersPerUnit:a.to_meter,units:o}))}}for(r=0;r<t;++r){const s=e[r],a=T_(s);for(i=0;i<t;++i){const o=e[i],l=T_(o);if(!b_(s,o))if(n.defs[s]===n.defs[o])tT([a,l]);else{const u=n(s,o);vU(a,l,$k(a,l,u.forward),$k(l,a,u.inverse))}}}}console.log(" parcelHighlight.ts v3.1 loaded - fixed pixelRatio for Android");vn.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs");M7(vn);let Th=null,Dm=null,Cf=null;function Vb(n){Th&&(n.removeLayer(Th),Th=null),Dm&&(n.removeLayer(Dm),Dm=null),Cf=null}async function Fge(n,e){try{const t=xn(e);console.log(` Click (3857): ${e[0].toFixed(0)}, ${e[1].toFixed(0)}`),console.log(` LonLat (WGS84): ${t[0].toFixed(5)}, ${t[1].toFixed(5)}`);const r=vn("EPSG:4326","EPSG:28992",t);if(console.log(` RD (28992): ${r?r[0].toFixed(0)+", "+r[1].toFixed(0):"FAILED"}`),!r||r[0]<7e3||r[0]>3e5||r[1]<289e3||r[1]>629e3)return console.error(" Coordinate outside Netherlands or transformation failed:",r),!1;Vb(n);const i=1,s=`${r[0]-i},${r[1]-i},${r[0]+i},${r[1]+i}`,a=Date.now(),o=`https://service.pdok.nl/rvo/brpgewaspercelen/wfs/v1_0?SERVICE=WFS&VERSION=2.0.0&REQUEST=GetFeature&TYPENAMES=brpgewaspercelen:BrpGewas&OUTPUTFORMAT=json&SRSNAME=EPSG:28992&BBOX=${s},EPSG:28992&_=${a}`;console.log(" WFS URL:",o);const l=new AbortController,u=setTimeout(()=>l.abort(),1e4),h=await fetch(o,{signal:l.signal});if(clearTimeout(u),!h.ok)return console.error("WFS request failed:",h.status),!1;const f=await h.json();if(console.log(" WFS RESPONSE:",JSON.stringify(f).substring(0,500)),!f.features||f.features.length===0)return console.log("No parcel found at location"),!1;const g=f.features[0];console.log(" PARCEL ID:",g.id||g.properties?.id||"geen ID"),console.log(" PARCEL BBOX:",JSON.stringify(g.bbox||"geen bbox"));const v=new OR().readFeature(g,{dataProjection:"EPSG:28992",featureProjection:"EPSG:3857"}),x=v.getGeometry();if(!x)return console.log("No geometry in parcel feature"),!1;const E=g.properties||{};console.log(` Parcel: ${E.category||"unknown"} - ${E.gewasnaam||E.gewas||"geen gewas"}`),console.log(` Geometry type: ${x.getType()}, extent: ${x.getExtent().map(P=>P.toFixed(0)).join(", ")}`);const T=x.getExtent(),b=T[2]-T[0],I=T[3]-T[1],M=Math.max(b,I)*.05,F=[T[0]-M,T[1]-M,T[2]+M,T[3]+M],z=Math.max(b,I)*.3,k=[T[0]-z,T[1]-z,T[2]+z,T[3]+z];Cf=x,Th=new gW({source:new BW({url:"https://ahn.arcgisonline.nl/arcgis/rest/services/Hoogtebestand/AHN4_DTM_50cm/ImageServer",params:{renderingRule:JSON.stringify({rasterFunction:"AHN - Color Ramp D"})},crossOrigin:"anonymous"}),extent:F,zIndex:998}),Th.on("prerender",P=>{if(!Cf)return;const L=P.context;if(!L)return;const O=P.frameState;if(!O)return;L.save(),L.beginPath(),(Cf.getType()==="Polygon"?Cf.getCoordinates()[0]:Cf.getCoordinates()[0][0]).forEach((j,Ie)=>{const ke=n.getPixelFromCoordinate(j);if(!ke)return;const ze=O.pixelRatio,Ne=ke[0]*ze,ce=ke[1]*ze;Ie===0?L.moveTo(Ne,ce):L.lineTo(Ne,ce)}),L.closePath(),L.clip()}),Th.on("postrender",P=>{const L=P.context;L&&L.restore()}),n.addLayer(Th);const C=new Kp({features:[v]});return Dm=new Qp({source:C,style:new nr({fill:new Wr({color:"rgba(0, 0, 0, 0)"}),stroke:new Ci({color:"#dc2626",width:3})}),zIndex:999}),n.addLayer(Dm),console.log(" Parcel height map displayed"),!0}catch(t){return console.error("Failed to show parcel height map:",t),!1}}var dv={};dv.version="0.18.5";var N7=1252,jge=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],L7=function(n){jge.indexOf(n)!=-1&&(N7=n)};function Vge(){L7(1252)}var Pp=function(n){L7(n)};function Gge(){Pp(1200),Vge()}var m_=function(e){return String.fromCharCode(e)},HL=function(e){return String.fromCharCode(e)},fv,Zc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function kp(n){for(var e="",t=0,r=0,i=0,s=0,a=0,o=0,l=0,u=0;u<n.length;)t=n.charCodeAt(u++),s=t>>2,r=n.charCodeAt(u++),a=(t&3)<<4|r>>4,i=n.charCodeAt(u++),o=(r&15)<<2|i>>6,l=i&63,isNaN(r)?o=l=64:isNaN(i)&&(l=64),e+=Zc.charAt(s)+Zc.charAt(a)+Zc.charAt(o)+Zc.charAt(l);return e}function Kl(n){var e="",t=0,r=0,i=0,s=0,a=0,o=0,l=0;n=n.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<n.length;)s=Zc.indexOf(n.charAt(u++)),a=Zc.indexOf(n.charAt(u++)),t=s<<2|a>>4,e+=String.fromCharCode(t),o=Zc.indexOf(n.charAt(u++)),r=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(r)),l=Zc.indexOf(n.charAt(u++)),i=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var Rn=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),ec=(function(){if(typeof Buffer<"u"){var n=!Buffer.from;if(!n)try{Buffer.from("foo","utf8")}catch{n=!0}return n?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}})();function td(n){return Rn?Buffer.alloc?Buffer.alloc(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}function KL(n){return Rn?Buffer.allocUnsafe?Buffer.allocUnsafe(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}var Ya=function(e){return Rn?ec(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)&255})};function Uw(n){if(typeof ArrayBuffer>"u")return Ya(n);for(var e=new ArrayBuffer(n.length),t=new Uint8Array(e),r=0;r!=n.length;++r)t[r]=n.charCodeAt(r)&255;return e}function P1(n){if(Array.isArray(n))return n.map(function(r){return String.fromCharCode(r)}).join("");for(var e=[],t=0;t<n.length;++t)e[t]=String.fromCharCode(n[t]);return e.join("")}function Bge(n){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(n)}var Ai=Rn?function(n){return Buffer.concat(n.map(function(e){return Buffer.isBuffer(e)?e:ec(e)}))}:function(n){if(typeof Uint8Array<"u"){var e=0,t=0;for(e=0;e<n.length;++e)t+=n[e].length;var r=new Uint8Array(t),i=0;for(e=0,t=0;e<n.length;t+=i,++e)if(i=n[e].length,n[e]instanceof Uint8Array)r.set(n[e],t);else{if(typeof n[e]=="string")throw"wtf";r.set(new Uint8Array(n[e]),t)}return r}return[].concat.apply([],n.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function Uge(n){for(var e=[],t=0,r=n.length+250,i=td(n.length+255),s=0;s<n.length;++s){var a=n.charCodeAt(s);if(a<128)i[t++]=a;else if(a<2048)i[t++]=192|a>>6&31,i[t++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=n.charCodeAt(++s)&1023;i[t++]=240|a>>8&7,i[t++]=128|a>>2&63,i[t++]=128|o>>6&15|(a&3)<<4,i[t++]=128|o&63}else i[t++]=224|a>>12&15,i[t++]=128|a>>6&63,i[t++]=128|a&63;t>r&&(e.push(i.slice(0,t)),t=0,i=td(65535),r=65530)}return e.push(i.slice(0,t)),Ai(e)}var Fm=/\u0000/g,p_=/[\u0001-\u0006]/g;function n0(n){for(var e="",t=n.length-1;t>=0;)e+=n.charAt(t--);return e}function Za(n,e){var t=""+n;return t.length>=e?t:Ar("0",e-t.length)+t}function WR(n,e){var t=""+n;return t.length>=e?t:Ar(" ",e-t.length)+t}function gv(n,e){var t=""+n;return t.length>=e?t:t+Ar(" ",e-t.length)}function zge(n,e){var t=""+Math.round(n);return t.length>=e?t:Ar("0",e-t.length)+t}function $ge(n,e){var t=""+n;return t.length>=e?t:Ar("0",e-t.length)+t}var YL=Math.pow(2,32);function gf(n,e){if(n>YL||n<-YL)return zge(n,e);var t=Math.round(n);return $ge(t,e)}function mv(n,e){return e=e||0,n.length>=7+e&&(n.charCodeAt(e)|32)===103&&(n.charCodeAt(e+1)|32)===101&&(n.charCodeAt(e+2)|32)===110&&(n.charCodeAt(e+3)|32)===101&&(n.charCodeAt(e+4)|32)===114&&(n.charCodeAt(e+5)|32)===97&&(n.charCodeAt(e+6)|32)===108}var qL=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],jS=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Wge(n){return n||(n={}),n[0]="General",n[1]="0",n[2]="0.00",n[3]="#,##0",n[4]="#,##0.00",n[9]="0%",n[10]="0.00%",n[11]="0.00E+00",n[12]="# ?/?",n[13]="# ??/??",n[14]="m/d/yy",n[15]="d-mmm-yy",n[16]="d-mmm",n[17]="mmm-yy",n[18]="h:mm AM/PM",n[19]="h:mm:ss AM/PM",n[20]="h:mm",n[21]="h:mm:ss",n[22]="m/d/yy h:mm",n[37]="#,##0 ;(#,##0)",n[38]="#,##0 ;[Red](#,##0)",n[39]="#,##0.00;(#,##0.00)",n[40]="#,##0.00;[Red](#,##0.00)",n[45]="mm:ss",n[46]="[h]:mm:ss",n[47]="mmss.0",n[48]="##0.0E+0",n[49]="@",n[56]='"/ "hh""mm""ss" "',n}var Cr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},XL={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Hge={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function pv(n,e,t){for(var r=n<0?-1:1,i=n*r,s=0,a=1,o=0,l=1,u=0,h=0,f=Math.floor(i);u<e&&(f=Math.floor(i),o=f*a+s,h=f*u+l,!(i-f<5e-8));)i=1/(i-f),s=a,a=o,l=u,u=h;if(h>e&&(u>e?(h=l,o=s):(h=u,o=a)),!t)return[0,r*o,h];var g=Math.floor(r*o/h);return[g,r*o-g*h,h]}function y_(n,e,t){if(n>2958465||n<0)return null;var r=n|0,i=Math.floor(86400*(n-r)),s=0,a=[],o={D:r,T:i,u:86400*(n-r)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(r+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++r,++o.D)),r===60)a=t?[1317,10,29]:[1900,2,29],s=3;else if(r===0)a=t?[1317,8,29]:[1900,1,0],s=6;else{r>60&&--r;var l=new Date(1900,0,1);l.setDate(l.getDate()+r-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),r<60&&(s=(s+6)%7),t&&(s=Jge(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var O7=new Date(1899,11,31,0,0,0),Kge=O7.getTime(),Yge=new Date(1900,2,1,0,0,0);function D7(n,e){var t=n.getTime();return e?t-=1461*24*60*60*1e3:n>=Yge&&(t+=1440*60*1e3),(t-(Kge+(n.getTimezoneOffset()-O7.getTimezoneOffset())*6e4))/(1440*60*1e3)}function HR(n){return n.indexOf(".")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function qge(n){return n.indexOf("E")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Xge(n){var e=n<0?12:11,t=HR(n.toFixed(12));return t.length<=e||(t=n.toPrecision(10),t.length<=e)?t:n.toExponential(5)}function Zge(n){var e=HR(n.toFixed(11));return e.length>(n<0?12:11)||e==="0"||e==="-0"?n.toPrecision(6):e}function Qge(n){var e=Math.floor(Math.log(Math.abs(n))*Math.LOG10E),t;return e>=-4&&e<=-1?t=n.toPrecision(10+e):Math.abs(e)<=9?t=Xge(n):e===10?t=n.toFixed(10).substr(0,12):t=Zge(n),HR(qge(t.toUpperCase()))}function Gb(n,e){switch(typeof n){case"string":return n;case"boolean":return n?"TRUE":"FALSE";case"number":return(n|0)===n?n.toString(10):Qge(n);case"undefined":return"";case"object":if(n==null)return"";if(n instanceof Date)return vu(14,D7(n,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+n)}function Jge(n,e){e[0]-=581;var t=n.getDay();return n<60&&(t=(t+6)%7),t}function eme(n,e,t,r){var i="",s=0,a=0,o=t.y,l,u=0;switch(n){case 98:o=t.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,u=2;break;default:l=o%1e4,u=4;break}break;case 109:switch(e.length){case 1:case 2:l=t.m,u=e.length;break;case 3:return jS[t.m-1][1];case 5:return jS[t.m-1][0];default:return jS[t.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=t.d,u=e.length;break;case 3:return qL[t.q][0];default:return qL[t.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(t.H+11)%12,u=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=t.H,u=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=t.M,u=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return t.u===0&&(e=="s"||e=="ss")?Za(t.S,e.length):(r>=2?a=r===3?1e3:100:a=r===1?10:1,s=Math.round(a*(t.S+t.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(i=Za(s,2+r),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=t.D*24+t.H;break;case"[m]":case"[mm]":l=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":l=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+e}u=e.length===3?1:2;break;case 101:l=o,u=1;break}var h=u>0?Za(l,u):"";return h}function Qc(n){var e=3;if(n.length<=e)return n;for(var t=n.length%e,r=n.substr(0,t);t!=n.length;t+=e)r+=(r.length>0?",":"")+n.substr(t,e);return r}var F7=/%/g;function tme(n,e,t){var r=e.replace(F7,""),i=e.length-r.length;return Dl(n,r,t*Math.pow(10,2*i))+Ar("%",i)}function nme(n,e,t){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return Dl(n,e.substr(0,r),t/Math.pow(10,3*(e.length-r)))}function j7(n,e){var t,r=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+j7(n,-e);var i=n.indexOf(".");i===-1&&(i=n.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),t=(e/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),t.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(a-t.length+s):t+="E+"+(a-s);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,i)+"."+t.substr(2+i),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,h){return l+u+h.substr(0,(i+s)%i)+"."+h.substr(s)+"E"})}else t=e.toExponential(r);return n.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),n.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var V7=/# (\?+)( ?)\/( ?)(\d+)/;function rme(n,e,t){var r=parseInt(n[4],10),i=Math.round(e*r),s=Math.floor(i/r),a=i-s*r,o=r;return t+(s===0?"":""+s)+" "+(a===0?Ar(" ",n[1].length+1+n[4].length):WR(a,n[1].length)+n[2]+"/"+n[3]+Za(o,n[4].length))}function ime(n,e,t){return t+(e===0?"":""+e)+Ar(" ",n[1].length+2+n[4].length)}var G7=/^#*0*\.([0#]+)/,B7=/\).*[0#]/,U7=/\(###\) ###\\?-####/;function ns(n){for(var e="",t,r=0;r!=n.length;++r)switch(t=n.charCodeAt(r)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(t)}return e}function ZL(n,e){var t=Math.pow(10,e);return""+Math.round(n*t)/t}function QL(n,e){var t=n-Math.floor(n),r=Math.pow(10,e);return e<(""+Math.round(t*r)).length?0:Math.round(t*r)}function sme(n,e){return e<(""+Math.round((n-Math.floor(n))*Math.pow(10,e))).length?1:0}function ame(n){return n<2147483647&&n>-2147483648?""+(n>=0?n|0:n-1|0):""+Math.floor(n)}function ga(n,e,t){if(n.charCodeAt(0)===40&&!e.match(B7)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?ga("n",r,t):"("+ga("n",r,-t)+")"}if(e.charCodeAt(e.length-1)===44)return nme(n,e,t);if(e.indexOf("%")!==-1)return tme(n,e,t);if(e.indexOf("E")!==-1)return j7(e,t);if(e.charCodeAt(0)===36)return"$"+ga(n,e.substr(e.charAt(1)==" "?2:1),t);var i,s,a,o,l=Math.abs(t),u=t<0?"-":"";if(e.match(/^00+$/))return u+gf(l,e.length);if(e.match(/^[#?]+$/))return i=gf(t,0),i==="0"&&(i=""),i.length>e.length?i:ns(e.substr(0,e.length-i.length))+i;if(s=e.match(V7))return rme(s,l,u);if(e.match(/^#+0+$/))return u+gf(l,e.length-e.indexOf("0"));if(s=e.match(G7))return i=ZL(t,s[1].length).replace(/^([^\.]+)$/,"$1."+ns(s[1])).replace(/\.$/,"."+ns(s[1])).replace(/\.(\d*)$/,function(v,x){return"."+x+Ar("0",ns(s[1]).length-x.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+ZL(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+Qc(gf(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+ga(n,e,-t):Qc(""+(Math.floor(t)+sme(t,s[1].length)))+"."+Za(QL(t,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return ga(n,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=n0(ga(n,e.replace(/[\\-]/g,""),t)),a=0,n0(n0(e.replace(/\\/g,"")).replace(/[0#]/g,function(v){return a<i.length?i.charAt(a++):v==="0"?"0":""}));if(e.match(U7))return i=ga(n,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=pv(l,Math.pow(10,a)-1,!1),i=""+u,h=Dl("n",s[1],o[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+s[2]+"/"+s[3],h=gv(o[2],a),h.length<s[4].length&&(h=ns(s[4].substr(s[4].length-h.length))+h),i+=h,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=pv(l,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?WR(o[1],a)+s[2]+"/"+s[3]+gv(o[2],a):Ar(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=gf(t,0),e.length<=i.length?i:ns(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var f=e.indexOf(".")-a,g=e.length-i.length-f;return ns(e.substr(0,f)+i+e.substr(e.length-g))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=QL(t,s[1].length),t<0?"-"+ga(n,e,-t):Qc(ame(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Za(0,3-v.length):"")+v})+"."+Za(a,s[1].length);switch(e){case"###,##0.00":return ga(n,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var y=Qc(gf(l,0));return y!=="0"?u+y:"";case"###,###.00":return ga(n,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return ga(n,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function ome(n,e,t){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return Dl(n,e.substr(0,r),t/Math.pow(10,3*(e.length-r)))}function lme(n,e,t){var r=e.replace(F7,""),i=e.length-r.length;return Dl(n,r,t*Math.pow(10,2*i))+Ar("%",i)}function z7(n,e){var t,r=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+z7(n,-e);var i=n.indexOf(".");i===-1&&(i=n.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),t=(e/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),!t.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(a-t.length+s):t+="E+"+(a-s),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,h){return l+u+h.substr(0,(i+s)%i)+"."+h.substr(s)+"E"})}else t=e.toExponential(r);return n.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),n.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Ro(n,e,t){if(n.charCodeAt(0)===40&&!e.match(B7)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Ro("n",r,t):"("+Ro("n",r,-t)+")"}if(e.charCodeAt(e.length-1)===44)return ome(n,e,t);if(e.indexOf("%")!==-1)return lme(n,e,t);if(e.indexOf("E")!==-1)return z7(e,t);if(e.charCodeAt(0)===36)return"$"+Ro(n,e.substr(e.charAt(1)==" "?2:1),t);var i,s,a,o,l=Math.abs(t),u=t<0?"-":"";if(e.match(/^00+$/))return u+Za(l,e.length);if(e.match(/^[#?]+$/))return i=""+t,t===0&&(i=""),i.length>e.length?i:ns(e.substr(0,e.length-i.length))+i;if(s=e.match(V7))return ime(s,l,u);if(e.match(/^#+0+$/))return u+Za(l,e.length-e.indexOf("0"));if(s=e.match(G7))return i=(""+t).replace(/^([^\.]+)$/,"$1."+ns(s[1])).replace(/\.$/,"."+ns(s[1])),i=i.replace(/\.(\d*)$/,function(v,x){return"."+x+Ar("0",ns(s[1]).length-x.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+Qc(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Ro(n,e,-t):Qc(""+t)+"."+Ar("0",s[1].length);if(s=e.match(/^#,#*,#0/))return Ro(n,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=n0(Ro(n,e.replace(/[\\-]/g,""),t)),a=0,n0(n0(e.replace(/\\/g,"")).replace(/[0#]/g,function(v){return a<i.length?i.charAt(a++):v==="0"?"0":""}));if(e.match(U7))return i=Ro(n,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=pv(l,Math.pow(10,a)-1,!1),i=""+u,h=Dl("n",s[1],o[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+s[2]+"/"+s[3],h=gv(o[2],a),h.length<s[4].length&&(h=ns(s[4].substr(s[4].length-h.length))+h),i+=h,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=pv(l,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?WR(o[1],a)+s[2]+"/"+s[3]+gv(o[2],a):Ar(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+t,e.length<=i.length?i:ns(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var f=e.indexOf(".")-a,g=e.length-i.length-f;return ns(e.substr(0,f)+i+e.substr(e.length-g))}if(s=e.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Ro(n,e,-t):Qc(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Za(0,3-v.length):"")+v})+"."+Za(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var y=Qc(""+l);return y!=="0"?u+y:"";default:if(e.match(/\.[0#?]*$/))return Ro(n,e.slice(0,e.lastIndexOf(".")),t)+ns(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Dl(n,e,t){return(t|0)===t?Ro(n,e,t):ga(n,e,t)}function cme(n){for(var e=[],t=!1,r=0,i=0;r<n.length;++r)switch(n.charCodeAt(r)){case 34:t=!t;break;case 95:case 42:case 92:++r;break;case 59:e[e.length]=n.substr(i,r-i),i=r+1}if(e[e.length]=n.substr(i),t===!0)throw new Error("Format |"+n+"| unterminated string ");return e}var $7=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function W7(n){for(var e=0,t="",r="";e<n.length;)switch(t=n.charAt(e)){case"G":mv(n,e)&&(e+=6),e++;break;case'"':for(;n.charCodeAt(++e)!==34&&e<n.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(n.charAt(e+1)==="1"||n.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(n.substr(e,3).toUpperCase()==="A/P"||n.substr(e,5).toUpperCase()==="AM/PM"||n.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(r=t;n.charAt(e++)!=="]"&&e<n.length;)r+=n.charAt(e);if(r.match($7))return!0;break;case".":case"0":case"#":for(;e<n.length&&("0#?.,E+-%".indexOf(t=n.charAt(++e))>-1||t=="\\"&&n.charAt(e+1)=="-"&&"0#".indexOf(n.charAt(e+2))>-1););break;case"?":for(;n.charAt(++e)===t;);break;case"*":++e,(n.charAt(e)==" "||n.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<n.length&&"0123456789".indexOf(n.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function ume(n,e,t,r){for(var i=[],s="",a=0,o="",l="t",u,h,f,g="H";a<n.length;)switch(o=n.charAt(a)){case"G":if(!mv(n,a))throw new Error("unrecognized character "+o+" in "+n);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(f=n.charCodeAt(++a))!==34&&a<n.length;)s+=String.fromCharCode(f);i[i.length]={t:"t",v:s},++a;break;case"\\":var y=n.charAt(++a),v=y==="("||y===")"?y:"t";i[i.length]={t:v,v:y},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:e},++a;break;case"B":case"b":if(n.charAt(a+1)==="1"||n.charAt(a+1)==="2"){if(u==null&&(u=y_(e,t,n.charAt(a+1)==="2"),u==null))return"";i[i.length]={t:"X",v:n.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||u==null&&(u=y_(e,t),u==null))return"";for(s=o;++a<n.length&&n.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=g),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var x={t:o,v:o};if(u==null&&(u=y_(e,t)),n.substr(a,3).toUpperCase()==="A/P"?(u!=null&&(x.v=u.H>=12?"P":"A"),x.t="T",g="h",a+=3):n.substr(a,5).toUpperCase()==="AM/PM"?(u!=null&&(x.v=u.H>=12?"PM":"AM"),x.t="T",a+=5,g="h"):n.substr(a,5).toUpperCase()==="/"?(u!=null&&(x.v=u.H>=12?"":""),x.t="T",a+=5,g="h"):(x.t="t",++a),u==null&&x.t==="T")return"";i[i.length]=x,l=o;break;case"[":for(s=o;n.charAt(a++)!=="]"&&a<n.length;)s+=n.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match($7)){if(u==null&&(u=y_(e,t),u==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",W7(n)||(i[i.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=o;++a<n.length&&(o=n.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<n.length&&"0#?.,E+-%".indexOf(o=n.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;n.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(n.charAt(a)==" "||n.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:r===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<n.length&&"0123456789".indexOf(n.charAt(++a))>-1;)s+=n.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+n);i[i.length]={t:"t",v:o},++a;break}var E=0,T=0,b;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=g,l="h",E<1&&(E=1);break;case"s":(b=i[a].v.match(/\.0+$/))&&(T=Math.max(T,b[0].length-1)),E<3&&(E=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",E<2&&(E=2));break;case"X":break;case"Z":E<1&&i[a].v.match(/[Hh]/)&&(E=1),E<2&&i[a].v.match(/[Mm]/)&&(E=2),E<3&&i[a].v.match(/[Ss]/)&&(E=3)}switch(E){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var I="",M;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=eme(i[a].t.charCodeAt(0),i[a].v,u,T),i[a].t="t";break;case"n":case"?":for(M=a+1;i[M]!=null&&((o=i[M].t)==="?"||o==="D"||(o===" "||o==="t")&&i[M+1]!=null&&(i[M+1].t==="?"||i[M+1].t==="t"&&i[M+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[M].v==="/"||i[M].v===" "&&i[M+1]!=null&&i[M+1].t=="?"));)i[a].v+=i[M].v,i[M]={v:"",t:";"},++M;I+=i[a].v,a=M-1;break;case"G":i[a].t="t",i[a].v=Gb(e,t);break}var F="",z,k;if(I.length>0){I.charCodeAt(0)==40?(z=e<0&&I.charCodeAt(0)===45?-e:e,k=Dl("n",I,z)):(z=e<0&&r>1?-e:e,k=Dl("n",I,z),z<0&&i[0]&&i[0].t=="t"&&(k=k.substr(1),i[0].v="-"+i[0].v)),M=k.length-1;var C=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){C=a;break}var P=i.length;if(C===i.length&&k.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(M>=i[a].v.length-1?(M-=i[a].v.length,i[a].v=k.substr(M+1,i[a].v.length)):M<0?i[a].v="":(i[a].v=k.substr(0,M+1),M=-1),i[a].t="t",P=a);M>=0&&P<i.length&&(i[P].v=k.substr(0,M+1)+i[P].v)}else if(C!==i.length&&k.indexOf("E")===-1){for(M=k.indexOf(".")-1,a=C;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(h=i[a].v.indexOf(".")>-1&&a===C?i[a].v.indexOf(".")-1:i[a].v.length-1,F=i[a].v.substr(h+1);h>=0;--h)M>=0&&(i[a].v.charAt(h)==="0"||i[a].v.charAt(h)==="#")&&(F=k.charAt(M--)+F);i[a].v=F,i[a].t="t",P=a}for(M>=0&&P<i.length&&(i[P].v=k.substr(0,M+1)+i[P].v),M=k.indexOf(".")+1,a=C;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==C)){for(h=i[a].v.indexOf(".")>-1&&a===C?i[a].v.indexOf(".")+1:0,F=i[a].v.substr(0,h);h<i[a].v.length;++h)M<k.length&&(F+=k.charAt(M++));i[a].v=F,i[a].t="t",P=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(z=r>1&&e<0&&a>0&&i[a-1].v==="-"?-e:e,i[a].v=Dl(i[a].t,i[a].v,z),i[a].t="t");var L="";for(a=0;a!==i.length;++a)i[a]!=null&&(L+=i[a].v);return L}var JL=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function eO(n,e){if(e==null)return!1;var t=parseFloat(e[2]);switch(e[1]){case"=":if(n==t)return!0;break;case">":if(n>t)return!0;break;case"<":if(n<t)return!0;break;case"<>":if(n!=t)return!0;break;case">=":if(n>=t)return!0;break;case"<=":if(n<=t)return!0;break}return!1}function hme(n,e){var t=cme(n),r=t.length,i=t[r-1].indexOf("@");if(r<4&&i>-1&&--r,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof e!="number")return[4,t.length===4||i>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=i>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=i>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=i>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var s=e>0?t[0]:e<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[r,s];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var a=t[0].match(JL),o=t[1].match(JL);return eO(e,a)?[r,t[0]]:eO(e,o)?[r,t[1]]:[r,t[a!=null&&o!=null?2:1]]}return[r,s]}function vu(n,e,t){t==null&&(t={});var r="";switch(typeof n){case"string":n=="m/d/yy"&&t.dateNF?r=t.dateNF:r=n;break;case"number":n==14&&t.dateNF?r=t.dateNF:r=(t.table!=null?t.table:Cr)[n],r==null&&(r=t.table&&t.table[XL[n]]||Cr[XL[n]]),r==null&&(r=Hge[n]||"General");break}if(mv(r,0))return Gb(e,t);e instanceof Date&&(e=D7(e,t.date1904));var i=hme(r,e);if(mv(i[1]))return Gb(e,t);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return ume(i[1],e,t,i[0])}function H7(n,e){if(typeof e!="number"){e=+e||-1;for(var t=0;t<392;++t){if(Cr[t]==null){e<0&&(e=t);continue}if(Cr[t]==n){e=t;break}}e<0&&(e=391)}return Cr[e]=n,e}function zw(n){for(var e=0;e!=392;++e)n[e]!==void 0&&H7(n[e],e)}function $w(){Cr=Wge()}var K7=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function dme(n){var e=typeof n=="number"?Cr[n]:n;return e=e.replace(K7,"(\\d+)"),new RegExp("^"+e+"$")}function fme(n,e,t){var r=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(e.match(K7)||[]).forEach(function(f,g){var y=parseInt(t[g+1],10);switch(f.toLowerCase().charAt(0)){case"y":r=y;break;case"d":s=y;break;case"h":a=y;break;case"s":l=y;break;case"m":a>=0?o=y:i=y;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var u=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var h=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?u:r==-1&&i==-1&&s==-1?h:u+"T"+h}var gme=(function(){var n={};n.version="1.2.0";function e(){for(var k=0,C=new Array(256),P=0;P!=256;++P)k=P,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,C[P]=k;return typeof Int32Array<"u"?new Int32Array(C):C}var t=e();function r(k){var C=0,P=0,L=0,O=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(L=0;L!=256;++L)O[L]=k[L];for(L=0;L!=256;++L)for(P=k[L],C=256+L;C<4096;C+=256)P=O[C]=P>>>8^k[P&255];var U=[];for(L=1;L!=16;++L)U[L-1]=typeof Int32Array<"u"?O.subarray(L*256,L*256+256):O.slice(L*256,L*256+256);return U}var i=r(t),s=i[0],a=i[1],o=i[2],l=i[3],u=i[4],h=i[5],f=i[6],g=i[7],y=i[8],v=i[9],x=i[10],E=i[11],T=i[12],b=i[13],I=i[14];function M(k,C){for(var P=C^-1,L=0,O=k.length;L<O;)P=P>>>8^t[(P^k.charCodeAt(L++))&255];return~P}function F(k,C){for(var P=C^-1,L=k.length-15,O=0;O<L;)P=I[k[O++]^P&255]^b[k[O++]^P>>8&255]^T[k[O++]^P>>16&255]^E[k[O++]^P>>>24]^x[k[O++]]^v[k[O++]]^y[k[O++]]^g[k[O++]]^f[k[O++]]^h[k[O++]]^u[k[O++]]^l[k[O++]]^o[k[O++]]^a[k[O++]]^s[k[O++]]^t[k[O++]];for(L+=15;O<L;)P=P>>>8^t[(P^k[O++])&255];return~P}function z(k,C){for(var P=C^-1,L=0,O=k.length,U=0,j=0;L<O;)U=k.charCodeAt(L++),U<128?P=P>>>8^t[(P^U)&255]:U<2048?(P=P>>>8^t[(P^(192|U>>6&31))&255],P=P>>>8^t[(P^(128|U&63))&255]):U>=55296&&U<57344?(U=(U&1023)+64,j=k.charCodeAt(L++)&1023,P=P>>>8^t[(P^(240|U>>8&7))&255],P=P>>>8^t[(P^(128|U>>2&63))&255],P=P>>>8^t[(P^(128|j>>6&15|(U&3)<<4))&255],P=P>>>8^t[(P^(128|j&63))&255]):(P=P>>>8^t[(P^(224|U>>12&15))&255],P=P>>>8^t[(P^(128|U>>6&63))&255],P=P>>>8^t[(P^(128|U&63))&255]);return~P}return n.table=t,n.bstr=M,n.buf=F,n.str=z,n})(),Yn=(function(){var e={};e.version="1.2.1";function t(B,Q){for(var K=B.split("/"),Y=Q.split("/"),ee=0,te=0,ye=Math.min(K.length,Y.length);ee<ye;++ee){if(te=K[ee].length-Y[ee].length)return te;if(K[ee]!=Y[ee])return K[ee]<Y[ee]?-1:1}return K.length-Y.length}function r(B){if(B.charAt(B.length-1)=="/")return B.slice(0,-1).indexOf("/")===-1?B:r(B.slice(0,-1));var Q=B.lastIndexOf("/");return Q===-1?B:B.slice(0,Q+1)}function i(B){if(B.charAt(B.length-1)=="/")return i(B.slice(0,-1));var Q=B.lastIndexOf("/");return Q===-1?B:B.slice(Q+1)}function s(B,Q){typeof Q=="string"&&(Q=new Date(Q));var K=Q.getHours();K=K<<6|Q.getMinutes(),K=K<<5|Q.getSeconds()>>>1,B.write_shift(2,K);var Y=Q.getFullYear()-1980;Y=Y<<4|Q.getMonth()+1,Y=Y<<5|Q.getDate(),B.write_shift(2,Y)}function a(B){var Q=B.read_shift(2)&65535,K=B.read_shift(2)&65535,Y=new Date,ee=K&31;K>>>=5;var te=K&15;K>>>=4,Y.setMilliseconds(0),Y.setFullYear(K+1980),Y.setMonth(te-1),Y.setDate(ee);var ye=Q&31;Q>>>=5;var Ce=Q&63;return Q>>>=6,Y.setHours(Q),Y.setMinutes(Ce),Y.setSeconds(ye<<1),Y}function o(B){zs(B,0);for(var Q={},K=0;B.l<=B.length-4;){var Y=B.read_shift(2),ee=B.read_shift(2),te=B.l+ee,ye={};switch(Y){case 21589:K=B.read_shift(1),K&1&&(ye.mtime=B.read_shift(4)),ee>5&&(K&2&&(ye.atime=B.read_shift(4)),K&4&&(ye.ctime=B.read_shift(4))),ye.mtime&&(ye.mt=new Date(ye.mtime*1e3));break}B.l=te,Q[Y]=ye}return Q}var l;function u(){return l||(l={})}function h(B,Q){if(B[0]==80&&B[1]==75)return Z(B,Q);if((B[0]|32)==109&&(B[1]|32)==105)return St(B,Q);if(B.length<512)throw new Error("CFB file size "+B.length+" < 512");var K=3,Y=512,ee=0,te=0,ye=0,Ce=0,pe=0,xe=[],we=B.slice(0,512);zs(we,0);var Ke=f(we);switch(K=Ke[0],K){case 3:Y=512;break;case 4:Y=4096;break;case 0:if(Ke[1]==0)return Z(B,Q);default:throw new Error("Major Version: Expected 3 or 4 saw "+K)}Y!==512&&(we=B.slice(0,Y),zs(we,28));var tt=B.slice(0,Y);g(we,K);var ft=we.read_shift(4,"i");if(K===3&&ft!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ft);we.l+=4,ye=we.read_shift(4,"i"),we.l+=4,we.chk("00100000","Mini Stream Cutoff Size: "),Ce=we.read_shift(4,"i"),ee=we.read_shift(4,"i"),pe=we.read_shift(4,"i"),te=we.read_shift(4,"i");for(var Ye=-1,qe=0;qe<109&&(Ye=we.read_shift(4,"i"),!(Ye<0));++qe)xe[qe]=Ye;var zt=y(B,Y);E(pe,te,zt,Y,xe);var Mn=b(zt,ye,xe,Y);Mn[ye].name="!Directory",ee>0&&Ce!==j&&(Mn[Ce].name="!MiniFAT"),Mn[xe[0]].name="!FAT",Mn.fat_addrs=xe,Mn.ssz=Y;var jn={},dr=[],Pa=[],ia=[];I(ye,Mn,zt,dr,ee,jn,Pa,Ce),v(Pa,ia,dr),dr.shift();var Ns={FileIndex:Pa,FullPaths:ia};return Q&&Q.raw&&(Ns.raw={header:tt,sectors:zt}),Ns}function f(B){if(B[B.l]==80&&B[B.l+1]==75)return[0,0];B.chk(Ie,"Header Signature: "),B.l+=16;var Q=B.read_shift(2,"u");return[B.read_shift(2,"u"),Q]}function g(B,Q){var K=9;switch(B.l+=2,K=B.read_shift(2)){case 9:if(Q!=3)throw new Error("Sector Shift: Expected 9 saw "+K);break;case 12:if(Q!=4)throw new Error("Sector Shift: Expected 12 saw "+K);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+K)}B.chk("0600","Mini Sector Shift: "),B.chk("000000000000","Reserved: ")}function y(B,Q){for(var K=Math.ceil(B.length/Q)-1,Y=[],ee=1;ee<K;++ee)Y[ee-1]=B.slice(ee*Q,(ee+1)*Q);return Y[K-1]=B.slice(K*Q),Y}function v(B,Q,K){for(var Y=0,ee=0,te=0,ye=0,Ce=0,pe=K.length,xe=[],we=[];Y<pe;++Y)xe[Y]=we[Y]=Y,Q[Y]=K[Y];for(;Ce<we.length;++Ce)Y=we[Ce],ee=B[Y].L,te=B[Y].R,ye=B[Y].C,xe[Y]===Y&&(ee!==-1&&xe[ee]!==ee&&(xe[Y]=xe[ee]),te!==-1&&xe[te]!==te&&(xe[Y]=xe[te])),ye!==-1&&(xe[ye]=Y),ee!==-1&&Y!=xe[Y]&&(xe[ee]=xe[Y],we.lastIndexOf(ee)<Ce&&we.push(ee)),te!==-1&&Y!=xe[Y]&&(xe[te]=xe[Y],we.lastIndexOf(te)<Ce&&we.push(te));for(Y=1;Y<pe;++Y)xe[Y]===Y&&(te!==-1&&xe[te]!==te?xe[Y]=xe[te]:ee!==-1&&xe[ee]!==ee&&(xe[Y]=xe[ee]));for(Y=1;Y<pe;++Y)if(B[Y].type!==0){if(Ce=Y,Ce!=xe[Ce])do Ce=xe[Ce],Q[Y]=Q[Ce]+"/"+Q[Y];while(Ce!==0&&xe[Ce]!==-1&&Ce!=xe[Ce]);xe[Y]=-1}for(Q[0]+="/",Y=1;Y<pe;++Y)B[Y].type!==2&&(Q[Y]+="/")}function x(B,Q,K){for(var Y=B.start,ee=B.size,te=[],ye=Y;K&&ee>0&&ye>=0;)te.push(Q.slice(ye*U,ye*U+U)),ee-=U,ye=mh(K,ye*4);return te.length===0?Re(0):Ai(te).slice(0,B.size)}function E(B,Q,K,Y,ee){var te=j;if(B===j){if(Q!==0)throw new Error("DIFAT chain shorter than expected")}else if(B!==-1){var ye=K[B],Ce=(Y>>>2)-1;if(!ye)return;for(var pe=0;pe<Ce&&(te=mh(ye,pe*4))!==j;++pe)ee.push(te);E(mh(ye,Y-4),Q-1,K,Y,ee)}}function T(B,Q,K,Y,ee){var te=[],ye=[];ee||(ee=[]);var Ce=Y-1,pe=0,xe=0;for(pe=Q;pe>=0;){ee[pe]=!0,te[te.length]=pe,ye.push(B[pe]);var we=K[Math.floor(pe*4/Y)];if(xe=pe*4&Ce,Y<4+xe)throw new Error("FAT boundary crossed: "+pe+" 4 "+Y);if(!B[we])break;pe=mh(B[we],xe)}return{nodes:te,data:lO([ye])}}function b(B,Q,K,Y){var ee=B.length,te=[],ye=[],Ce=[],pe=[],xe=Y-1,we=0,Ke=0,tt=0,ft=0;for(we=0;we<ee;++we)if(Ce=[],tt=we+Q,tt>=ee&&(tt-=ee),!ye[tt]){pe=[];var Ye=[];for(Ke=tt;Ke>=0;){Ye[Ke]=!0,ye[Ke]=!0,Ce[Ce.length]=Ke,pe.push(B[Ke]);var qe=K[Math.floor(Ke*4/Y)];if(ft=Ke*4&xe,Y<4+ft)throw new Error("FAT boundary crossed: "+Ke+" 4 "+Y);if(!B[qe]||(Ke=mh(B[qe],ft),Ye[Ke]))break}te[tt]={nodes:Ce,data:lO([pe])}}return te}function I(B,Q,K,Y,ee,te,ye,Ce){for(var pe=0,xe=Y.length?2:0,we=Q[B].data,Ke=0,tt=0,ft;Ke<we.length;Ke+=128){var Ye=we.slice(Ke,Ke+128);zs(Ye,64),tt=Ye.read_shift(2),ft=ZR(Ye,0,tt-xe),Y.push(ft);var qe={name:ft,type:Ye.read_shift(1),color:Ye.read_shift(1),L:Ye.read_shift(4,"i"),R:Ye.read_shift(4,"i"),C:Ye.read_shift(4,"i"),clsid:Ye.read_shift(16),state:Ye.read_shift(4,"i"),start:0,size:0},zt=Ye.read_shift(2)+Ye.read_shift(2)+Ye.read_shift(2)+Ye.read_shift(2);zt!==0&&(qe.ct=M(Ye,Ye.l-8));var Mn=Ye.read_shift(2)+Ye.read_shift(2)+Ye.read_shift(2)+Ye.read_shift(2);Mn!==0&&(qe.mt=M(Ye,Ye.l-8)),qe.start=Ye.read_shift(4,"i"),qe.size=Ye.read_shift(4,"i"),qe.size<0&&qe.start<0&&(qe.size=qe.type=0,qe.start=j,qe.name=""),qe.type===5?(pe=qe.start,ee>0&&pe!==j&&(Q[pe].name="!StreamData")):qe.size>=4096?(qe.storage="fat",Q[qe.start]===void 0&&(Q[qe.start]=T(K,qe.start,Q.fat_addrs,Q.ssz)),Q[qe.start].name=qe.name,qe.content=Q[qe.start].data.slice(0,qe.size)):(qe.storage="minifat",qe.size<0?qe.size=0:pe!==j&&qe.start!==j&&Q[pe]&&(qe.content=x(qe,Q[pe].data,(Q[Ce]||{}).data))),qe.content&&zs(qe.content,0),te[ft]=qe,ye.push(qe)}}function M(B,Q){return new Date((Ks(B,Q+4)/1e7*Math.pow(2,32)+Ks(B,Q)/1e7-11644473600)*1e3)}function F(B,Q){return u(),h(l.readFileSync(B),Q)}function z(B,Q){var K=Q&&Q.type;switch(K||Rn&&Buffer.isBuffer(B)&&(K="buffer"),K||"base64"){case"file":return F(B,Q);case"base64":return h(Ya(Kl(B)),Q);case"binary":return h(Ya(B),Q)}return h(B,Q)}function k(B,Q){var K=Q||{},Y=K.root||"Root Entry";if(B.FullPaths||(B.FullPaths=[]),B.FileIndex||(B.FileIndex=[]),B.FullPaths.length!==B.FileIndex.length)throw new Error("inconsistent CFB structure");B.FullPaths.length===0&&(B.FullPaths[0]=Y+"/",B.FileIndex[0]={name:Y,type:5}),K.CLSID&&(B.FileIndex[0].clsid=K.CLSID),C(B)}function C(B){var Q="Sh33tJ5";if(!Yn.find(B,"/"+Q)){var K=Re(4);K[0]=55,K[1]=K[3]=50,K[2]=54,B.FileIndex.push({name:Q,type:2,content:K,size:4,L:69,R:69,C:69}),B.FullPaths.push(B.FullPaths[0]+Q),P(B)}}function P(B,Q){k(B);for(var K=!1,Y=!1,ee=B.FullPaths.length-1;ee>=0;--ee){var te=B.FileIndex[ee];switch(te.type){case 0:Y?K=!0:(B.FileIndex.pop(),B.FullPaths.pop());break;case 1:case 2:case 5:Y=!0,isNaN(te.R*te.L*te.C)&&(K=!0),te.R>-1&&te.L>-1&&te.R==te.L&&(K=!0);break;default:K=!0;break}}if(!(!K&&!Q)){var ye=new Date(1987,1,19),Ce=0,pe=Object.create?Object.create(null):{},xe=[];for(ee=0;ee<B.FullPaths.length;++ee)pe[B.FullPaths[ee]]=!0,B.FileIndex[ee].type!==0&&xe.push([B.FullPaths[ee],B.FileIndex[ee]]);for(ee=0;ee<xe.length;++ee){var we=r(xe[ee][0]);Y=pe[we],Y||(xe.push([we,{name:i(we).replace("/",""),type:1,clsid:ze,ct:ye,mt:ye,content:null}]),pe[we]=!0)}for(xe.sort(function(ft,Ye){return t(ft[0],Ye[0])}),B.FullPaths=[],B.FileIndex=[],ee=0;ee<xe.length;++ee)B.FullPaths[ee]=xe[ee][0],B.FileIndex[ee]=xe[ee][1];for(ee=0;ee<xe.length;++ee){var Ke=B.FileIndex[ee],tt=B.FullPaths[ee];if(Ke.name=i(tt).replace("/",""),Ke.L=Ke.R=Ke.C=-(Ke.color=1),Ke.size=Ke.content?Ke.content.length:0,Ke.start=0,Ke.clsid=Ke.clsid||ze,ee===0)Ke.C=xe.length>1?1:-1,Ke.size=0,Ke.type=5;else if(tt.slice(-1)=="/"){for(Ce=ee+1;Ce<xe.length&&r(B.FullPaths[Ce])!=tt;++Ce);for(Ke.C=Ce>=xe.length?-1:Ce,Ce=ee+1;Ce<xe.length&&r(B.FullPaths[Ce])!=r(tt);++Ce);Ke.R=Ce>=xe.length?-1:Ce,Ke.type=1}else r(B.FullPaths[ee+1]||"")==r(tt)&&(Ke.R=ee+1),Ke.type=2}}}function L(B,Q){var K=Q||{};if(K.fileType=="mad")return sn(B,K);switch(P(B),K.fileType){case"zip":return le(B,K)}var Y=(function(ft){for(var Ye=0,qe=0,zt=0;zt<ft.FileIndex.length;++zt){var Mn=ft.FileIndex[zt];if(Mn.content){var jn=Mn.content.length;jn>0&&(jn<4096?Ye+=jn+63>>6:qe+=jn+511>>9)}}for(var dr=ft.FullPaths.length+3>>2,Pa=Ye+7>>3,ia=Ye+127>>7,Ns=Pa+qe+dr+ia,Pr=Ns+127>>7,tc=Pr<=109?0:Math.ceil((Pr-109)/127);Ns+Pr+tc+127>>7>Pr;)tc=++Pr<=109?0:Math.ceil((Pr-109)/127);var yr=[1,tc,Pr,ia,dr,qe,Ye,0];return ft.FileIndex[0].size=Ye<<6,yr[7]=(ft.FileIndex[0].start=yr[0]+yr[1]+yr[2]+yr[3]+yr[4]+yr[5])+(yr[6]+7>>3),yr})(B),ee=Re(Y[7]<<9),te=0,ye=0;{for(te=0;te<8;++te)ee.write_shift(1,ke[te]);for(te=0;te<8;++te)ee.write_shift(2,0);for(ee.write_shift(2,62),ee.write_shift(2,3),ee.write_shift(2,65534),ee.write_shift(2,9),ee.write_shift(2,6),te=0;te<3;++te)ee.write_shift(2,0);for(ee.write_shift(4,0),ee.write_shift(4,Y[2]),ee.write_shift(4,Y[0]+Y[1]+Y[2]+Y[3]-1),ee.write_shift(4,0),ee.write_shift(4,4096),ee.write_shift(4,Y[3]?Y[0]+Y[1]+Y[2]-1:j),ee.write_shift(4,Y[3]),ee.write_shift(-4,Y[1]?Y[0]-1:j),ee.write_shift(4,Y[1]),te=0;te<109;++te)ee.write_shift(-4,te<Y[2]?Y[1]+te:-1)}if(Y[1])for(ye=0;ye<Y[1];++ye){for(;te<236+ye*127;++te)ee.write_shift(-4,te<Y[2]?Y[1]+te:-1);ee.write_shift(-4,ye===Y[1]-1?j:ye+1)}var Ce=function(ft){for(ye+=ft;te<ye-1;++te)ee.write_shift(-4,te+1);ft&&(++te,ee.write_shift(-4,j))};for(ye=te=0,ye+=Y[1];te<ye;++te)ee.write_shift(-4,Ne.DIFSECT);for(ye+=Y[2];te<ye;++te)ee.write_shift(-4,Ne.FATSECT);Ce(Y[3]),Ce(Y[4]);for(var pe=0,xe=0,we=B.FileIndex[0];pe<B.FileIndex.length;++pe)we=B.FileIndex[pe],we.content&&(xe=we.content.length,!(xe<4096)&&(we.start=ye,Ce(xe+511>>9)));for(Ce(Y[6]+7>>3);ee.l&511;)ee.write_shift(-4,Ne.ENDOFCHAIN);for(ye=te=0,pe=0;pe<B.FileIndex.length;++pe)we=B.FileIndex[pe],we.content&&(xe=we.content.length,!(!xe||xe>=4096)&&(we.start=ye,Ce(xe+63>>6)));for(;ee.l&511;)ee.write_shift(-4,Ne.ENDOFCHAIN);for(te=0;te<Y[4]<<2;++te){var Ke=B.FullPaths[te];if(!Ke||Ke.length===0){for(pe=0;pe<17;++pe)ee.write_shift(4,0);for(pe=0;pe<3;++pe)ee.write_shift(4,-1);for(pe=0;pe<12;++pe)ee.write_shift(4,0);continue}we=B.FileIndex[te],te===0&&(we.start=we.size?we.start-1:j);var tt=te===0&&K.root||we.name;if(xe=2*(tt.length+1),ee.write_shift(64,tt,"utf16le"),ee.write_shift(2,xe),ee.write_shift(1,we.type),ee.write_shift(1,we.color),ee.write_shift(-4,we.L),ee.write_shift(-4,we.R),ee.write_shift(-4,we.C),we.clsid)ee.write_shift(16,we.clsid,"hex");else for(pe=0;pe<4;++pe)ee.write_shift(4,0);ee.write_shift(4,we.state||0),ee.write_shift(4,0),ee.write_shift(4,0),ee.write_shift(4,0),ee.write_shift(4,0),ee.write_shift(4,we.start),ee.write_shift(4,we.size),ee.write_shift(4,0)}for(te=1;te<B.FileIndex.length;++te)if(we=B.FileIndex[te],we.size>=4096)if(ee.l=we.start+1<<9,Rn&&Buffer.isBuffer(we.content))we.content.copy(ee,ee.l,0,we.size),ee.l+=we.size+511&-512;else{for(pe=0;pe<we.size;++pe)ee.write_shift(1,we.content[pe]);for(;pe&511;++pe)ee.write_shift(1,0)}for(te=1;te<B.FileIndex.length;++te)if(we=B.FileIndex[te],we.size>0&&we.size<4096)if(Rn&&Buffer.isBuffer(we.content))we.content.copy(ee,ee.l,0,we.size),ee.l+=we.size+63&-64;else{for(pe=0;pe<we.size;++pe)ee.write_shift(1,we.content[pe]);for(;pe&63;++pe)ee.write_shift(1,0)}if(Rn)ee.l=ee.length;else for(;ee.l<ee.length;)ee.write_shift(1,0);return ee}function O(B,Q){var K=B.FullPaths.map(function(pe){return pe.toUpperCase()}),Y=K.map(function(pe){var xe=pe.split("/");return xe[xe.length-(pe.slice(-1)=="/"?2:1)]}),ee=!1;Q.charCodeAt(0)===47?(ee=!0,Q=K[0].slice(0,-1)+Q):ee=Q.indexOf("/")!==-1;var te=Q.toUpperCase(),ye=ee===!0?K.indexOf(te):Y.indexOf(te);if(ye!==-1)return B.FileIndex[ye];var Ce=!te.match(p_);for(te=te.replace(Fm,""),Ce&&(te=te.replace(p_,"!")),ye=0;ye<K.length;++ye)if((Ce?K[ye].replace(p_,"!"):K[ye]).replace(Fm,"")==te||(Ce?Y[ye].replace(p_,"!"):Y[ye]).replace(Fm,"")==te)return B.FileIndex[ye];return null}var U=64,j=-2,Ie="d0cf11e0a1b11ae1",ke=[208,207,17,224,161,177,26,225],ze="00000000000000000000000000000000",Ne={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:j,FREESECT:-1,HEADER_SIGNATURE:Ie,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ze,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ce(B,Q,K){u();var Y=L(B,K);l.writeFileSync(Q,Y)}function Te(B){for(var Q=new Array(B.length),K=0;K<B.length;++K)Q[K]=String.fromCharCode(B[K]);return Q.join("")}function Ee(B,Q){var K=L(B,Q);switch(Q&&Q.type||"buffer"){case"file":return u(),l.writeFileSync(Q.filename,K),K;case"binary":return typeof K=="string"?K:Te(K);case"base64":return kp(typeof K=="string"?K:Te(K));case"buffer":if(Rn)return Buffer.isBuffer(K)?K:ec(K);case"array":return typeof K=="string"?Ya(K):K}return K}var se;function V(B){try{var Q=B.InflateRaw,K=new Q;if(K._processChunk(new Uint8Array([3,0]),K._finishFlushFlag),K.bytesRead)se=B;else throw new Error("zlib does not expose bytesRead")}catch(Y){console.error("cannot use native zlib: "+(Y.message||Y))}}function J(B,Q){if(!se)return Pt(B,Q);var K=se.InflateRaw,Y=new K,ee=Y._processChunk(B.slice(B.l),Y._finishFlushFlag);return B.l+=Y.bytesRead,ee}function ne(B){return se?se.deflateRawSync(B):Vr(B)}var X=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ue=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Me=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function je(B){var Q=(B<<1|B<<11)&139536|(B<<5|B<<15)&558144;return(Q>>16|Q>>8|Q)&255}for(var De=typeof Uint8Array<"u",Be=De?new Uint8Array(256):[],Gt=0;Gt<256;++Gt)Be[Gt]=je(Gt);function Kt(B,Q){var K=Be[B&255];return Q<=8?K>>>8-Q:(K=K<<8|Be[B>>8&255],Q<=16?K>>>16-Q:(K=K<<8|Be[B>>16&255],K>>>24-Q))}function wn(B,Q){var K=Q&7,Y=Q>>>3;return(B[Y]|(K<=6?0:B[Y+1]<<8))>>>K&3}function Bt(B,Q){var K=Q&7,Y=Q>>>3;return(B[Y]|(K<=5?0:B[Y+1]<<8))>>>K&7}function Fn(B,Q){var K=Q&7,Y=Q>>>3;return(B[Y]|(K<=4?0:B[Y+1]<<8))>>>K&15}function Qt(B,Q){var K=Q&7,Y=Q>>>3;return(B[Y]|(K<=3?0:B[Y+1]<<8))>>>K&31}function ot(B,Q){var K=Q&7,Y=Q>>>3;return(B[Y]|(K<=1?0:B[Y+1]<<8))>>>K&127}function Xn(B,Q,K){var Y=Q&7,ee=Q>>>3,te=(1<<K)-1,ye=B[ee]>>>Y;return K<8-Y||(ye|=B[ee+1]<<8-Y,K<16-Y)||(ye|=B[ee+2]<<16-Y,K<24-Y)||(ye|=B[ee+3]<<24-Y),ye&te}function on(B,Q,K){var Y=Q&7,ee=Q>>>3;return Y<=5?B[ee]|=(K&7)<<Y:(B[ee]|=K<<Y&255,B[ee+1]=(K&7)>>8-Y),Q+3}function en(B,Q,K){var Y=Q&7,ee=Q>>>3;return K=(K&1)<<Y,B[ee]|=K,Q+1}function Zn(B,Q,K){var Y=Q&7,ee=Q>>>3;return K<<=Y,B[ee]|=K&255,K>>>=8,B[ee+1]=K,Q+8}function gt(B,Q,K){var Y=Q&7,ee=Q>>>3;return K<<=Y,B[ee]|=K&255,K>>>=8,B[ee+1]=K&255,B[ee+2]=K>>>8,Q+16}function jt(B,Q){var K=B.length,Y=2*K>Q?2*K:Q+5,ee=0;if(K>=Q)return B;if(Rn){var te=KL(Y);if(B.copy)B.copy(te);else for(;ee<B.length;++ee)te[ee]=B[ee];return te}else if(De){var ye=new Uint8Array(Y);if(ye.set)ye.set(B);else for(;ee<K;++ee)ye[ee]=B[ee];return ye}return B.length=Y,B}function kn(B){for(var Q=new Array(B),K=0;K<B;++K)Q[K]=0;return Q}function yt(B,Q,K){var Y=1,ee=0,te=0,ye=0,Ce=0,pe=B.length,xe=De?new Uint16Array(32):kn(32);for(te=0;te<32;++te)xe[te]=0;for(te=pe;te<K;++te)B[te]=0;pe=B.length;var we=De?new Uint16Array(pe):kn(pe);for(te=0;te<pe;++te)xe[ee=B[te]]++,Y<ee&&(Y=ee),we[te]=0;for(xe[0]=0,te=1;te<=Y;++te)xe[te+16]=Ce=Ce+xe[te-1]<<1;for(te=0;te<pe;++te)Ce=B[te],Ce!=0&&(we[te]=xe[Ce+16]++);var Ke=0;for(te=0;te<pe;++te)if(Ke=B[te],Ke!=0)for(Ce=Kt(we[te],Y)>>Y-Ke,ye=(1<<Y+4-Ke)-1;ye>=0;--ye)Q[Ce|ye<<Ke]=Ke&15|te<<4;return Y}var Jt=De?new Uint16Array(512):kn(512),Rt=De?new Uint16Array(32):kn(32);if(!De){for(var rr=0;rr<512;++rr)Jt[rr]=0;for(rr=0;rr<32;++rr)Rt[rr]=0}(function(){for(var B=[],Q=0;Q<32;Q++)B.push(5);yt(B,Rt,32);var K=[];for(Q=0;Q<=143;Q++)K.push(8);for(;Q<=255;Q++)K.push(9);for(;Q<=279;Q++)K.push(7);for(;Q<=287;Q++)K.push(8);yt(K,Jt,288)})();var si=(function(){for(var Q=De?new Uint8Array(32768):[],K=0,Y=0;K<Me.length-1;++K)for(;Y<Me[K+1];++Y)Q[Y]=K;for(;Y<32768;++Y)Q[Y]=29;var ee=De?new Uint8Array(259):[];for(K=0,Y=0;K<ue.length-1;++K)for(;Y<ue[K+1];++Y)ee[Y]=K;function te(Ce,pe){for(var xe=0;xe<Ce.length;){var we=Math.min(65535,Ce.length-xe),Ke=xe+we==Ce.length;for(pe.write_shift(1,+Ke),pe.write_shift(2,we),pe.write_shift(2,~we&65535);we-- >0;)pe[pe.l++]=Ce[xe++]}return pe.l}function ye(Ce,pe){for(var xe=0,we=0,Ke=De?new Uint16Array(32768):[];we<Ce.length;){var tt=Math.min(65535,Ce.length-we);if(tt<10){for(xe=on(pe,xe,+(we+tt==Ce.length)),xe&7&&(xe+=8-(xe&7)),pe.l=xe/8|0,pe.write_shift(2,tt),pe.write_shift(2,~tt&65535);tt-- >0;)pe[pe.l++]=Ce[we++];xe=pe.l*8;continue}xe=on(pe,xe,+(we+tt==Ce.length)+2);for(var ft=0;tt-- >0;){var Ye=Ce[we];ft=(ft<<5^Ye)&32767;var qe=-1,zt=0;if((qe=Ke[ft])&&(qe|=we&-32768,qe>we&&(qe-=32768),qe<we))for(;Ce[qe+zt]==Ce[we+zt]&&zt<250;)++zt;if(zt>2){Ye=ee[zt],Ye<=22?xe=Zn(pe,xe,Be[Ye+1]>>1)-1:(Zn(pe,xe,3),xe+=5,Zn(pe,xe,Be[Ye-23]>>5),xe+=3);var Mn=Ye<8?0:Ye-4>>2;Mn>0&&(gt(pe,xe,zt-ue[Ye]),xe+=Mn),Ye=Q[we-qe],xe=Zn(pe,xe,Be[Ye]>>3),xe-=3;var jn=Ye<4?0:Ye-2>>1;jn>0&&(gt(pe,xe,we-qe-Me[Ye]),xe+=jn);for(var dr=0;dr<zt;++dr)Ke[ft]=we&32767,ft=(ft<<5^Ce[we])&32767,++we;tt-=zt-1}else Ye<=143?Ye=Ye+48:xe=en(pe,xe,1),xe=Zn(pe,xe,Be[Ye]),Ke[ft]=we&32767,++we}xe=Zn(pe,xe,0)-1}return pe.l=(xe+7)/8|0,pe.l}return function(pe,xe){return pe.length<8?te(pe,xe):ye(pe,xe)}})();function Vr(B){var Q=Re(50+Math.floor(B.length*1.1)),K=si(B,Q);return Q.slice(0,K)}var Ut=De?new Uint16Array(32768):kn(32768),Ji=De?new Uint16Array(32768):kn(32768),Oe=De?new Uint16Array(128):kn(128),ve=1,me=1;function Ct(B,Q){var K=Qt(B,Q)+257;Q+=5;var Y=Qt(B,Q)+1;Q+=5;var ee=Fn(B,Q)+4;Q+=4;for(var te=0,ye=De?new Uint8Array(19):kn(19),Ce=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],pe=1,xe=De?new Uint8Array(8):kn(8),we=De?new Uint8Array(8):kn(8),Ke=ye.length,tt=0;tt<ee;++tt)ye[X[tt]]=te=Bt(B,Q),pe<te&&(pe=te),xe[te]++,Q+=3;var ft=0;for(xe[0]=0,tt=1;tt<=pe;++tt)we[tt]=ft=ft+xe[tt-1]<<1;for(tt=0;tt<Ke;++tt)(ft=ye[tt])!=0&&(Ce[tt]=we[ft]++);var Ye=0;for(tt=0;tt<Ke;++tt)if(Ye=ye[tt],Ye!=0){ft=Be[Ce[tt]]>>8-Ye;for(var qe=(1<<7-Ye)-1;qe>=0;--qe)Oe[ft|qe<<Ye]=Ye&7|tt<<3}var zt=[];for(pe=1;zt.length<K+Y;)switch(ft=Oe[ot(B,Q)],Q+=ft&7,ft>>>=3){case 16:for(te=3+wn(B,Q),Q+=2,ft=zt[zt.length-1];te-- >0;)zt.push(ft);break;case 17:for(te=3+Bt(B,Q),Q+=3;te-- >0;)zt.push(0);break;case 18:for(te=11+ot(B,Q),Q+=7;te-- >0;)zt.push(0);break;default:zt.push(ft),pe<ft&&(pe=ft);break}var Mn=zt.slice(0,K),jn=zt.slice(K);for(tt=K;tt<286;++tt)Mn[tt]=0;for(tt=Y;tt<30;++tt)jn[tt]=0;return ve=yt(Mn,Ut,286),me=yt(jn,Ji,30),Q}function N(B,Q){if(B[0]==3&&!(B[1]&3))return[td(Q),2];for(var K=0,Y=0,ee=KL(Q||1<<18),te=0,ye=ee.length>>>0,Ce=0,pe=0;(Y&1)==0;){if(Y=Bt(B,K),K+=3,Y>>>1)Y>>1==1?(Ce=9,pe=5):(K=Ct(B,K),Ce=ve,pe=me);else{K&7&&(K+=8-(K&7));var xe=B[K>>>3]|B[(K>>>3)+1]<<8;if(K+=32,xe>0)for(!Q&&ye<te+xe&&(ee=jt(ee,te+xe),ye=ee.length);xe-- >0;)ee[te++]=B[K>>>3],K+=8;continue}for(;;){!Q&&ye<te+32767&&(ee=jt(ee,te+32767),ye=ee.length);var we=Xn(B,K,Ce),Ke=Y>>>1==1?Jt[we]:Ut[we];if(K+=Ke&15,Ke>>>=4,(Ke>>>8&255)===0)ee[te++]=Ke;else{if(Ke==256)break;Ke-=257;var tt=Ke<8?0:Ke-4>>2;tt>5&&(tt=0);var ft=te+ue[Ke];tt>0&&(ft+=Xn(B,K,tt),K+=tt),we=Xn(B,K,pe),Ke=Y>>>1==1?Rt[we]:Ji[we],K+=Ke&15,Ke>>>=4;var Ye=Ke<4?0:Ke-2>>1,qe=Me[Ke];for(Ye>0&&(qe+=Xn(B,K,Ye),K+=Ye),!Q&&ye<ft&&(ee=jt(ee,ft+100),ye=ee.length);te<ft;)ee[te]=ee[te-qe],++te}}}return Q?[ee,K+7>>>3]:[ee.slice(0,te),K+7>>>3]}function Pt(B,Q){var K=B.slice(B.l||0),Y=N(K,Q);return B.l+=Y[1],Y[0]}function W(B,Q){if(B)typeof console<"u"&&console.error(Q);else throw new Error(Q)}function Z(B,Q){var K=B;zs(K,0);var Y=[],ee=[],te={FileIndex:Y,FullPaths:ee};k(te,{root:Q.root});for(var ye=K.length-4;(K[ye]!=80||K[ye+1]!=75||K[ye+2]!=5||K[ye+3]!=6)&&ye>=0;)--ye;K.l=ye+4,K.l+=4;var Ce=K.read_shift(2);K.l+=6;var pe=K.read_shift(4);for(K.l=pe,ye=0;ye<Ce;++ye){K.l+=20;var xe=K.read_shift(4),we=K.read_shift(4),Ke=K.read_shift(2),tt=K.read_shift(2),ft=K.read_shift(2);K.l+=8;var Ye=K.read_shift(4),qe=o(K.slice(K.l+Ke,K.l+Ke+tt));K.l+=Ke+tt+ft;var zt=K.l;K.l=Ye+4,q(K,xe,we,te,qe),K.l=zt}return te}function q(B,Q,K,Y,ee){B.l+=2;var te=B.read_shift(2),ye=B.read_shift(2),Ce=a(B);if(te&8257)throw new Error("Unsupported ZIP encryption");for(var pe=B.read_shift(4),xe=B.read_shift(4),we=B.read_shift(4),Ke=B.read_shift(2),tt=B.read_shift(2),ft="",Ye=0;Ye<Ke;++Ye)ft+=String.fromCharCode(B[B.l++]);if(tt){var qe=o(B.slice(B.l,B.l+tt));(qe[21589]||{}).mt&&(Ce=qe[21589].mt),((ee||{})[21589]||{}).mt&&(Ce=ee[21589].mt)}B.l+=tt;var zt=B.slice(B.l,B.l+xe);switch(ye){case 8:zt=J(B,we);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ye)}var Mn=!1;te&8&&(pe=B.read_shift(4),pe==134695760&&(pe=B.read_shift(4),Mn=!0),xe=B.read_shift(4),we=B.read_shift(4)),xe!=Q&&W(Mn,"Bad compressed size: "+Q+" != "+xe),we!=K&&W(Mn,"Bad uncompressed size: "+K+" != "+we),cn(Y,ft,zt,{unsafe:!0,mt:Ce})}function le(B,Q){var K=Q||{},Y=[],ee=[],te=Re(1),ye=K.compression?8:0,Ce=0,pe=0,xe=0,we=0,Ke=0,tt=B.FullPaths[0],ft=tt,Ye=B.FileIndex[0],qe=[],zt=0;for(pe=1;pe<B.FullPaths.length;++pe)if(ft=B.FullPaths[pe].slice(tt.length),Ye=B.FileIndex[pe],!(!Ye.size||!Ye.content||ft=="Sh33tJ5")){var Mn=we,jn=Re(ft.length);for(xe=0;xe<ft.length;++xe)jn.write_shift(1,ft.charCodeAt(xe)&127);jn=jn.slice(0,jn.l),qe[Ke]=gme.buf(Ye.content,0);var dr=Ye.content;ye==8&&(dr=ne(dr)),te=Re(30),te.write_shift(4,67324752),te.write_shift(2,20),te.write_shift(2,Ce),te.write_shift(2,ye),Ye.mt?s(te,Ye.mt):te.write_shift(4,0),te.write_shift(-4,qe[Ke]),te.write_shift(4,dr.length),te.write_shift(4,Ye.content.length),te.write_shift(2,jn.length),te.write_shift(2,0),we+=te.length,Y.push(te),we+=jn.length,Y.push(jn),we+=dr.length,Y.push(dr),te=Re(46),te.write_shift(4,33639248),te.write_shift(2,0),te.write_shift(2,20),te.write_shift(2,Ce),te.write_shift(2,ye),te.write_shift(4,0),te.write_shift(-4,qe[Ke]),te.write_shift(4,dr.length),te.write_shift(4,Ye.content.length),te.write_shift(2,jn.length),te.write_shift(2,0),te.write_shift(2,0),te.write_shift(2,0),te.write_shift(2,0),te.write_shift(4,0),te.write_shift(4,Mn),zt+=te.l,ee.push(te),zt+=jn.length,ee.push(jn),++Ke}return te=Re(22),te.write_shift(4,101010256),te.write_shift(2,0),te.write_shift(2,0),te.write_shift(2,Ke),te.write_shift(2,Ke),te.write_shift(4,zt),te.write_shift(4,we),te.write_shift(2,0),Ai([Ai(Y),Ai(ee),te])}var he={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ve(B,Q){if(B.ctype)return B.ctype;var K=B.name||"",Y=K.match(/\.([^\.]+)$/);return Y&&he[Y[1]]||Q&&(Y=(K=Q).match(/[\.\\]([^\.\\])+$/),Y&&he[Y[1]])?he[Y[1]]:"application/octet-stream"}function Se(B){for(var Q=kp(B),K=[],Y=0;Y<Q.length;Y+=76)K.push(Q.slice(Y,Y+76));return K.join(`\r
`)+`\r
`}function $e(B){var Q=B.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(xe){var we=xe.charCodeAt(0).toString(16).toUpperCase();return"="+(we.length==1?"0"+we:we)});Q=Q.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Q.charAt(0)==`
`&&(Q="=0D"+Q.slice(1)),Q=Q.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var K=[],Y=Q.split(`\r
`),ee=0;ee<Y.length;++ee){var te=Y[ee];if(te.length==0){K.push("");continue}for(var ye=0;ye<te.length;){var Ce=76,pe=te.slice(ye,ye+Ce);pe.charAt(Ce-1)=="="?Ce--:pe.charAt(Ce-2)=="="?Ce-=2:pe.charAt(Ce-3)=="="&&(Ce-=3),pe=te.slice(ye,ye+Ce),ye+=Ce,ye<te.length&&(pe+="="),K.push(pe)}}return K.join(`\r
`)}function et(B){for(var Q=[],K=0;K<B.length;++K){for(var Y=B[K];K<=B.length&&Y.charAt(Y.length-1)=="=";)Y=Y.slice(0,Y.length-1)+B[++K];Q.push(Y)}for(var ee=0;ee<Q.length;++ee)Q[ee]=Q[ee].replace(/[=][0-9A-Fa-f]{2}/g,function(te){return String.fromCharCode(parseInt(te.slice(1),16))});return Ya(Q.join(`\r
`))}function dt(B,Q,K){for(var Y="",ee="",te="",ye,Ce=0;Ce<10;++Ce){var pe=Q[Ce];if(!pe||pe.match(/^\s*$/))break;var xe=pe.match(/^(.*?):\s*([^\s].*)$/);if(xe)switch(xe[1].toLowerCase()){case"content-location":Y=xe[2].trim();break;case"content-type":te=xe[2].trim();break;case"content-transfer-encoding":ee=xe[2].trim();break}}switch(++Ce,ee.toLowerCase()){case"base64":ye=Ya(Kl(Q.slice(Ce).join("")));break;case"quoted-printable":ye=et(Q.slice(Ce));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ee)}var we=cn(B,Y.slice(K.length),ye,{unsafe:!0});te&&(we.ctype=te)}function St(B,Q){if(Te(B.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var K=Q&&Q.root||"",Y=(Rn&&Buffer.isBuffer(B)?B.toString("binary"):Te(B)).split(`\r
`),ee=0,te="";for(ee=0;ee<Y.length;++ee)if(te=Y[ee],!!/^Content-Location:/i.test(te)&&(te=te.slice(te.indexOf("file")),K||(K=te.slice(0,te.lastIndexOf("/")+1)),te.slice(0,K.length)!=K))for(;K.length>0&&(K=K.slice(0,K.length-1),K=K.slice(0,K.lastIndexOf("/")+1),te.slice(0,K.length)!=K););var ye=(Y[1]||"").match(/boundary="(.*?)"/);if(!ye)throw new Error("MAD cannot find boundary");var Ce="--"+(ye[1]||""),pe=[],xe=[],we={FileIndex:pe,FullPaths:xe};k(we);var Ke,tt=0;for(ee=0;ee<Y.length;++ee){var ft=Y[ee];ft!==Ce&&ft!==Ce+"--"||(tt++&&dt(we,Y.slice(Ke,ee),K),Ke=ee)}return we}function sn(B,Q){var K=Q||{},Y=K.boundary||"SheetJS";Y="------="+Y;for(var ee=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Y.slice(2)+'"',"","",""],te=B.FullPaths[0],ye=te,Ce=B.FileIndex[0],pe=1;pe<B.FullPaths.length;++pe)if(ye=B.FullPaths[pe].slice(te.length),Ce=B.FileIndex[pe],!(!Ce.size||!Ce.content||ye=="Sh33tJ5")){ye=ye.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(zt){return"_x"+zt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(zt){return"_u"+zt.charCodeAt(0).toString(16)+"_"});for(var xe=Ce.content,we=Rn&&Buffer.isBuffer(xe)?xe.toString("binary"):Te(xe),Ke=0,tt=Math.min(1024,we.length),ft=0,Ye=0;Ye<=tt;++Ye)(ft=we.charCodeAt(Ye))>=32&&ft<128&&++Ke;var qe=Ke>=tt*4/5;ee.push(Y),ee.push("Content-Location: "+(K.root||"file:///C:/SheetJS/")+ye),ee.push("Content-Transfer-Encoding: "+(qe?"quoted-printable":"base64")),ee.push("Content-Type: "+Ve(Ce,ye)),ee.push(""),ee.push(qe?$e(we):Se(we))}return ee.push(Y+`--\r
`),ee.join(`\r
`)}function ur(B){var Q={};return k(Q,B),Q}function cn(B,Q,K,Y){var ee=Y&&Y.unsafe;ee||k(B);var te=!ee&&Yn.find(B,Q);if(!te){var ye=B.FullPaths[0];Q.slice(0,ye.length)==ye?ye=Q:(ye.slice(-1)!="/"&&(ye+="/"),ye=(ye+Q).replace("//","/")),te={name:i(Q),type:2},B.FileIndex.push(te),B.FullPaths.push(ye),ee||Yn.utils.cfb_gc(B)}return te.content=K,te.size=K?K.length:0,Y&&(Y.CLSID&&(te.clsid=Y.CLSID),Y.mt&&(te.mt=Y.mt),Y.ct&&(te.ct=Y.ct)),te}function hr(B,Q){k(B);var K=Yn.find(B,Q);if(K){for(var Y=0;Y<B.FileIndex.length;++Y)if(B.FileIndex[Y]==K)return B.FileIndex.splice(Y,1),B.FullPaths.splice(Y,1),!0}return!1}function pr(B,Q,K){k(B);var Y=Yn.find(B,Q);if(Y){for(var ee=0;ee<B.FileIndex.length;++ee)if(B.FileIndex[ee]==Y)return B.FileIndex[ee].name=i(K),B.FullPaths[ee]=K,!0}return!1}function Ni(B){P(B,!0)}return e.find=O,e.read=z,e.parse=h,e.write=Ee,e.writeFile=ce,e.utils={cfb_new:ur,cfb_add:cn,cfb_del:hr,cfb_mov:pr,cfb_gc:Ni,ReadShift:Vm,CheckField:hV,prep_blob:zs,bconcat:Ai,use_zlib:V,_deflateRaw:Vr,_inflateRaw:Pt,consts:Ne},e})();function mme(n){return typeof n=="string"?Uw(n):Array.isArray(n)?Bge(n):n}function k1(n,e,t){if(typeof Deno<"u"){if(t&&typeof e=="string")switch(t){case"utf8":e=new TextEncoder(t).encode(e);break;case"binary":e=Uw(e);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(n,e)}var r=t=="utf8"?Np(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(r,n);if(typeof Blob<"u"){var i=new Blob([mme(r)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,n);if(typeof saveAs<"u")return saveAs(i,n);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:n,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=n,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(n);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=P1(e)),o.write(e),o.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+n)}function Mi(n){for(var e=Object.keys(n),t=[],r=0;r<e.length;++r)Object.prototype.hasOwnProperty.call(n,e[r])&&t.push(e[r]);return t}function tO(n,e){for(var t=[],r=Mi(n),i=0;i!==r.length;++i)t[n[r[i]][e]]==null&&(t[n[r[i]][e]]=r[i]);return t}function KR(n){for(var e=[],t=Mi(n),r=0;r!==t.length;++r)e[n[t[r]]]=t[r];return e}function Ww(n){for(var e=[],t=Mi(n),r=0;r!==t.length;++r)e[n[t[r]]]=parseInt(t[r],10);return e}function pme(n){for(var e=[],t=Mi(n),r=0;r!==t.length;++r)e[n[t[r]]]==null&&(e[n[t[r]]]=[]),e[n[t[r]]].push(t[r]);return e}var yv=new Date(1899,11,30,0,0,0);function Ps(n,e){var t=n.getTime(),r=yv.getTime()+(n.getTimezoneOffset()-yv.getTimezoneOffset())*6e4;return(t-r)/(1440*60*1e3)}var Y7=new Date,yme=yv.getTime()+(Y7.getTimezoneOffset()-yv.getTimezoneOffset())*6e4,nO=Y7.getTimezoneOffset();function q7(n){var e=new Date;return e.setTime(n*24*60*60*1e3+yme),e.getTimezoneOffset()!==nO&&e.setTime(e.getTime()+(e.getTimezoneOffset()-nO)*6e4),e}var rO=new Date("2017-02-19T19:06:09.000Z"),X7=isNaN(rO.getFullYear())?new Date("2/19/17"):rO,_me=X7.getFullYear()==2017;function us(n,e){var t=new Date(n);if(_me)return e>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):e<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(n instanceof Date)return n;if(X7.getFullYear()==1917&&!isNaN(t.getFullYear())){var r=t.getFullYear();return n.indexOf(""+r)>-1||t.setFullYear(t.getFullYear()+100),t}var i=n.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return n.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Hw(n,e){if(Rn&&Buffer.isBuffer(n))return n.toString("binary");if(typeof TextDecoder<"u")try{var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(n)&&(n=new Uint8Array(n)),new TextDecoder("latin1").decode(n).replace(/[]/g,function(s){return t[s]||s})}catch{}for(var r=[],i=0;i!=n.length;++i)r.push(String.fromCharCode(n[i]));return r.join("")}function ks(n){if(typeof JSON<"u"&&!Array.isArray(n))return JSON.parse(JSON.stringify(n));if(typeof n!="object"||n==null)return n;if(n instanceof Date)return new Date(n.getTime());var e={};for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=ks(n[t]));return e}function Ar(n,e){for(var t="";t.length<e;)t+=n;return t}function Fl(n){var e=Number(n);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(n))return e;var t=1,r=n.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(e=Number(r))||(r=r.replace(/[(](.*)[)]/,function(i,s){return t=-t,s}),!isNaN(e=Number(r)))?e/t:e}var xme=["january","february","march","april","may","june","july","august","september","october","november","december"];function Mp(n){var e=new Date(n),t=new Date(NaN),r=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return t;var a=n.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&xme.indexOf(a)==-1)return t}else if(a.match(/[a-z]/))return t;return r<0||r>8099?t:(i>0||s>1)&&r!=101?e:n.match(/[^-0-9:,\/\\]/)?t:e}function nn(n,e,t){if(n.FullPaths){if(typeof t=="string"){var r;return Rn?r=ec(t):r=Uge(t),Yn.utils.cfb_add(n,e,r)}Yn.utils.cfb_add(n,e,t)}else n.file(e,t)}function YR(){return Yn.utils.cfb_new()}var qr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,vme={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},qR=KR(vme),XR=/[&<>'"]/g,wme=/[\u0000-\u0008\u000b-\u001f]/g;function Wn(n){var e=n+"";return e.replace(XR,function(t){return qR[t]}).replace(wme,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function iO(n){return Wn(n).replace(/ /g,"_x0020_")}var Z7=/[\u0000-\u001f]/g;function Eme(n){var e=n+"";return e.replace(XR,function(t){return qR[t]}).replace(/\n/g,"<br/>").replace(Z7,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function Sme(n){var e=n+"";return e.replace(XR,function(t){return qR[t]}).replace(Z7,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}function Tme(n){return n.replace(/(\r\n|[\r\n])/g,"&#10;")}function bme(n){switch(n){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function VS(n){for(var e="",t=0,r=0,i=0,s=0,a=0,o=0;t<n.length;){if(r=n.charCodeAt(t++),r<128){e+=String.fromCharCode(r);continue}if(i=n.charCodeAt(t++),r>191&&r<224){a=(r&31)<<6,a|=i&63,e+=String.fromCharCode(a);continue}if(s=n.charCodeAt(t++),r<240){e+=String.fromCharCode((r&15)<<12|(i&63)<<6|s&63);continue}a=n.charCodeAt(t++),o=((r&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function sO(n){var e=td(2*n.length),t,r,i=1,s=0,a=0,o;for(r=0;r<n.length;r+=i)i=1,(o=n.charCodeAt(r))<128?t=o:o<224?(t=(o&31)*64+(n.charCodeAt(r+1)&63),i=2):o<240?(t=(o&15)*4096+(n.charCodeAt(r+1)&63)*64+(n.charCodeAt(r+2)&63),i=3):(i=4,t=(o&7)*262144+(n.charCodeAt(r+1)&63)*4096+(n.charCodeAt(r+2)&63)*64+(n.charCodeAt(r+3)&63),t-=65536,a=55296+(t>>>10&1023),t=56320+(t&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=t%256,e[s++]=t>>>8;return e.slice(0,s).toString("ucs2")}function aO(n){return ec(n,"binary").toString("utf8")}var __="foo bar baz",jm=Rn&&(aO(__)==VS(__)&&aO||sO(__)==VS(__)&&sO)||VS,Np=Rn?function(n){return ec(n,"utf8").toString("binary")}:function(n){for(var e=[],t=0,r=0,i=0;t<n.length;)switch(r=n.charCodeAt(t++),!0){case r<128:e.push(String.fromCharCode(r));break;case r<2048:e.push(String.fromCharCode(192+(r>>6))),e.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,i=n.charCodeAt(t++)-56320+(r<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(r>>12))),e.push(String.fromCharCode(128+(r>>6&63))),e.push(String.fromCharCode(128+(r&63)))}return e.join("")},Ime=(function(){var n=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var r=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<n.length;++i)r=r.replace(n[i][0],n[i][1]);return r}})(),Q7=/(^\s|\s$|\n)/;function Ri(n,e){return"<"+n+(e.match(Q7)?' xml:space="preserve"':"")+">"+e+"</"+n+">"}function Lp(n){return Mi(n).map(function(e){return" "+e+'="'+n[e]+'"'}).join("")}function nt(n,e,t){return"<"+n+(t!=null?Lp(t):"")+(e!=null?(e.match(Q7)?' xml:space="preserve"':"")+">"+e+"</"+n:"/")+">"}function Bb(n,e){try{return n.toISOString().replace(/\.\d*/,"")}catch(t){if(e)throw t}return""}function Ame(n,e){switch(typeof n){case"string":var t=nt("vt:lpwstr",Wn(n));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return nt((n|0)==n?"vt:i4":"vt:r8",Wn(String(n)));case"boolean":return nt("vt:bool",n?"true":"false")}if(n instanceof Date)return nt("vt:filetime",Bb(n));throw new Error("Unable to serialize "+n)}var fi={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},H0=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Hs={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Rme(n,e){for(var t=1-2*(n[e+7]>>>7),r=((n[e+7]&127)<<4)+(n[e+6]>>>4&15),i=n[e+6]&15,s=5;s>=0;--s)i=i*256+n[e+s];return r==2047?i==0?t*(1/0):NaN:(r==0?r=-1022:(r-=1023,i+=Math.pow(2,52)),t*Math.pow(2,r-52)*i)}function Cme(n,e,t){var r=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,a=r?-e:e;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)n[t+o]=s&255;n[t+6]=(i&15)<<4|s&15,n[t+7]=i>>4|r}var oO=function(n){for(var e=[],t=10240,r=0;r<n[0].length;++r)if(n[0][r])for(var i=0,s=n[0][r].length;i<s;i+=t)e.push.apply(e,n[0][r].slice(i,i+t));return e},lO=Rn?function(n){return n[0].length>0&&Buffer.isBuffer(n[0][0])?Buffer.concat(n[0].map(function(e){return Buffer.isBuffer(e)?e:ec(e)})):oO(n)}:oO,cO=function(n,e,t){for(var r=[],i=e;i<t;i+=2)r.push(String.fromCharCode(hm(n,i)));return r.join("").replace(Fm,"")},ZR=Rn?function(n,e,t){return Buffer.isBuffer(n)?n.toString("utf16le",e,t).replace(Fm,""):cO(n,e,t)}:cO,uO=function(n,e,t){for(var r=[],i=e;i<e+t;++i)r.push(("0"+n[i].toString(16)).slice(-2));return r.join("")},J7=Rn?function(n,e,t){return Buffer.isBuffer(n)?n.toString("hex",e,e+t):uO(n,e,t)}:uO,hO=function(n,e,t){for(var r=[],i=e;i<t;i++)r.push(String.fromCharCode(Pf(n,i)));return r.join("")},M1=Rn?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf8",t,r):hO(e,t,r)}:hO,eV=function(n,e){var t=Ks(n,e);return t>0?M1(n,e+4,e+4+t-1):""},tV=eV,nV=function(n,e){var t=Ks(n,e);return t>0?M1(n,e+4,e+4+t-1):""},rV=nV,iV=function(n,e){var t=2*Ks(n,e);return t>0?M1(n,e+4,e+4+t-1):""},sV=iV,aV=function(e,t){var r=Ks(e,t);return r>0?ZR(e,t+4,t+4+r):""},oV=aV,lV=function(n,e){var t=Ks(n,e);return t>0?M1(n,e+4,e+4+t):""},cV=lV,uV=function(n,e){return Rme(n,e)},_v=uV,QR=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Rn&&(tV=function(e,t){if(!Buffer.isBuffer(e))return eV(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},rV=function(e,t){if(!Buffer.isBuffer(e))return nV(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},sV=function(e,t){if(!Buffer.isBuffer(e))return iV(e,t);var r=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r-1)},oV=function(e,t){if(!Buffer.isBuffer(e))return aV(e,t);var r=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r)},cV=function(e,t){if(!Buffer.isBuffer(e))return lV(e,t);var r=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+r)},_v=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):uV(e,t)},QR=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Pf=function(n,e){return n[e]},hm=function(n,e){return n[e+1]*256+n[e]},Pme=function(n,e){var t=n[e+1]*256+n[e];return t<32768?t:(65535-t+1)*-1},Ks=function(n,e){return n[e+3]*(1<<24)+(n[e+2]<<16)+(n[e+1]<<8)+n[e]},mh=function(n,e){return n[e+3]<<24|n[e+2]<<16|n[e+1]<<8|n[e]},kme=function(n,e){return n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3]};function Vm(n,e){var t="",r,i,s=[],a,o,l,u;switch(e){case"dbcs":if(u=this.l,Rn&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*n).toString("utf16le");else for(l=0;l<n;++l)t+=String.fromCharCode(hm(this,u)),u+=2;n*=2;break;case"utf8":t=M1(this,this.l,this.l+n);break;case"utf16le":n*=2,t=ZR(this,this.l,this.l+n);break;case"wstr":return Vm.call(this,n,"dbcs");case"lpstr-ansi":t=tV(this,this.l),n=4+Ks(this,this.l);break;case"lpstr-cp":t=rV(this,this.l),n=4+Ks(this,this.l);break;case"lpwstr":t=sV(this,this.l),n=4+2*Ks(this,this.l);break;case"lpp4":n=4+Ks(this,this.l),t=oV(this,this.l),n&2&&(n+=2);break;case"8lpp4":n=4+Ks(this,this.l),t=cV(this,this.l),n&3&&(n+=4-(n&3));break;case"cstr":for(n=0,t="";(a=Pf(this,this.l+n++))!==0;)s.push(m_(a));t=s.join("");break;case"_wstr":for(n=0,t="";(a=hm(this,this.l+n))!==0;)s.push(m_(a)),n+=2;n+=2,t=s.join("");break;case"dbcs-cont":for(t="",u=this.l,l=0;l<n;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return a=Pf(this,u),this.l=u+1,o=Vm.call(this,n-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(m_(hm(this,u))),u+=2}t=s.join(""),n*=2;break;case"cpstr":case"sbcs-cont":for(t="",u=this.l,l=0;l!=n;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return a=Pf(this,u),this.l=u+1,o=Vm.call(this,n-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(m_(Pf(this,u))),u+=1}t=s.join("");break;default:switch(n){case 1:return r=Pf(this,this.l),this.l++,r;case 2:return r=(e==="i"?Pme:hm)(this,this.l),this.l+=2,r;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(r=(n>0?mh:kme)(this,this.l),this.l+=4,r):(i=Ks(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return n==8?i=_v(this,this.l):i=_v([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;n=8;case 16:t=J7(this,this.l,n);break}}return this.l+=n,t}var Mme=function(n,e,t){n[t]=e&255,n[t+1]=e>>>8&255,n[t+2]=e>>>16&255,n[t+3]=e>>>24&255},Nme=function(n,e,t){n[t]=e&255,n[t+1]=e>>8&255,n[t+2]=e>>16&255,n[t+3]=e>>24&255},Lme=function(n,e,t){n[t]=e&255,n[t+1]=e>>>8&255};function Ome(n,e,t){var r=0,i=0;if(t==="dbcs"){for(i=0;i!=e.length;++i)Lme(this,e.charCodeAt(i),this.l+2*i);r=2*e.length}else if(t==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;r=e.length}else if(t==="hex"){for(;i<n;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(t==="utf16le"){var s=Math.min(this.l+n,this.length);for(i=0;i<Math.min(e.length,n);++i){var a=e.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(n){case 1:r=1,this[this.l]=e&255;break;case 2:r=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:r=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:r=4,Mme(this,e,this.l);break;case 8:if(r=8,t==="f"){Cme(this,e,this.l);break}case 16:break;case-4:r=4,Nme(this,e,this.l);break}return this.l+=r,this}function hV(n,e){var t=J7(this,this.l,n.length>>1);if(t!==n)throw new Error(e+"Expected "+n+" saw "+t);this.l+=n.length>>1}function zs(n,e){n.l=e,n.read_shift=Vm,n.chk=hV,n.write_shift=Ome}function Jo(n,e){n.l+=e}function Re(n){var e=td(n);return zs(e,0),e}function Rs(){var n=[],e=Rn?256:2048,t=function(u){var h=Re(u);return zs(h,0),h},r=t(e),i=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&n.push(r),r=null)},s=function(u){return r&&u<r.length-r.l?r:(i(),r=t(Math.max(u+1,e)))},a=function(){return i(),Ai(n)},o=function(u){i(),r=u,r.l==null&&(r.l=r.length),s(e)};return{next:s,push:o,end:a,_bufs:n}}function Ge(n,e,t,r){var i=+e,s;if(!isNaN(i)){r||(r=Rve[i].p||(t||[]).length||0),s=1+(i>=128?1:0)+1,r>=128&&++s,r>=16384&&++s,r>=2097152&&++s;var a=n.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(r>=128)a.write_shift(1,(r&127)+128),r>>=7;else{a.write_shift(1,r);break}r>0&&QR(t)&&n.push(t)}}function Gm(n,e,t){var r=ks(n);if(e.s?(r.cRel&&(r.c+=e.s.c),r.rRel&&(r.r+=e.s.r)):(r.cRel&&(r.c+=e.c),r.rRel&&(r.r+=e.r)),!t||t.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function dO(n,e,t){var r=ks(n);return r.s=Gm(r.s,e.s,t),r.e=Gm(r.e,e.s,t),r}function Bm(n,e){if(n.cRel&&n.c<0)for(n=ks(n);n.c<0;)n.c+=e>8?16384:256;if(n.rRel&&n.r<0)for(n=ks(n);n.r<0;)n.r+=e>8?1048576:e>5?65536:16384;var t=Kn(n);return!n.cRel&&n.cRel!=null&&(t=jme(t)),!n.rRel&&n.rRel!=null&&(t=Dme(t)),t}function GS(n,e){return n.s.r==0&&!n.s.rRel&&n.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!n.e.rRel?(n.s.cRel?"":"$")+Xi(n.s.c)+":"+(n.e.cRel?"":"$")+Xi(n.e.c):n.s.c==0&&!n.s.cRel&&n.e.c==(e.biff>=12?16383:255)&&!n.e.cRel?(n.s.rRel?"":"$")+ki(n.s.r)+":"+(n.e.rRel?"":"$")+ki(n.e.r):Bm(n.s,e.biff)+":"+Bm(n.e,e.biff)}function JR(n){return parseInt(Fme(n),10)-1}function ki(n){return""+(n+1)}function Dme(n){return n.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Fme(n){return n.replace(/\$(\d+)$/,"$1")}function eC(n){for(var e=Vme(n),t=0,r=0;r!==e.length;++r)t=26*t+e.charCodeAt(r)-64;return t-1}function Xi(n){if(n<0)throw new Error("invalid column "+n);var e="";for(++n;n;n=Math.floor((n-1)/26))e=String.fromCharCode((n-1)%26+65)+e;return e}function jme(n){return n.replace(/^([A-Z])/,"$$$1")}function Vme(n){return n.replace(/^\$([A-Z])/,"$1")}function Gme(n){return n.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function gi(n){for(var e=0,t=0,r=0;r<n.length;++r){var i=n.charCodeAt(r);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(t=26*t+(i-64))}return{c:t-1,r:e-1}}function Kn(n){for(var e=n.c+1,t="";e;e=(e-1)/26|0)t=String.fromCharCode((e-1)%26+65)+t;return t+(n.r+1)}function ra(n){var e=n.indexOf(":");return e==-1?{s:gi(n),e:gi(n)}:{s:gi(n.slice(0,e)),e:gi(n.slice(e+1))}}function Kr(n,e){return typeof e>"u"||typeof e=="number"?Kr(n.s,n.e):(typeof n!="string"&&(n=Kn(n)),typeof e!="string"&&(e=Kn(e)),n==e?n:n+":"+e)}function cr(n){var e={s:{c:0,r:0},e:{c:0,r:0}},t=0,r=0,i=0,s=n.length;for(t=0;r<s&&!((i=n.charCodeAt(r)-64)<1||i>26);++r)t=26*t+i;for(e.s.c=--t,t=0;r<s&&!((i=n.charCodeAt(r)-48)<0||i>9);++r)t=10*t+i;if(e.s.r=--t,r===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++r,t=0;r!=s&&!((i=n.charCodeAt(r)-64)<1||i>26);++r)t=26*t+i;for(e.e.c=--t,t=0;r!=s&&!((i=n.charCodeAt(r)-48)<0||i>9);++r)t=10*t+i;return e.e.r=--t,e}function fO(n,e){var t=n.t=="d"&&e instanceof Date;if(n.z!=null)try{return n.w=vu(n.z,t?Ps(e):e)}catch{}try{return n.w=vu((n.XF||{}).numFmtId||(t?14:0),t?Ps(e):e)}catch{return""+e}}function Yl(n,e,t){return n==null||n.t==null||n.t=="z"?"":n.w!==void 0?n.w:(n.t=="d"&&!n.z&&t&&t.dateNF&&(n.z=t.dateNF),n.t=="e"?N1[n.v]||n.v:e==null?fO(n,n.v):fO(n,e))}function _d(n,e){var t=e&&e.sheet?e.sheet:"Sheet1",r={};return r[t]=n,{SheetNames:[t],Sheets:r}}function dV(n,e,t){var r=t||{},i=n?Array.isArray(n):r.dense,s=n||(i?[]:{}),a=0,o=0;if(s&&r.origin!=null){if(typeof r.origin=="number")a=r.origin;else{var l=typeof r.origin=="string"?gi(r.origin):r.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var h=cr(s["!ref"]);u.s.c=h.s.c,u.s.r=h.s.r,u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),a==-1&&(u.e.r=a=h.e.r+1)}for(var f=0;f!=e.length;++f)if(e[f]){if(!Array.isArray(e[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var g=0;g!=e[f].length;++g)if(!(typeof e[f][g]>"u")){var y={v:e[f][g]},v=a+f,x=o+g;if(u.s.r>v&&(u.s.r=v),u.s.c>x&&(u.s.c=x),u.e.r<v&&(u.e.r=v),u.e.c<x&&(u.e.c=x),e[f][g]&&typeof e[f][g]=="object"&&!Array.isArray(e[f][g])&&!(e[f][g]instanceof Date))y=e[f][g];else if(Array.isArray(y.v)&&(y.f=e[f][g][1],y.v=y.v[0]),y.v===null)if(y.f)y.t="n";else if(r.nullError)y.t="e",y.v=0;else if(r.sheetStubs)y.t="z";else continue;else typeof y.v=="number"?y.t="n":typeof y.v=="boolean"?y.t="b":y.v instanceof Date?(y.z=r.dateNF||Cr[14],r.cellDates?(y.t="d",y.w=vu(y.z,Ps(y.v))):(y.t="n",y.v=Ps(y.v),y.w=vu(y.z,y.v))):y.t="s";if(i)s[v]||(s[v]=[]),s[v][x]&&s[v][x].z&&(y.z=s[v][x].z),s[v][x]=y;else{var E=Kn({c:x,r:v});s[E]&&s[E].z&&(y.z=s[E].z),s[E]=y}}}return u.s.c<1e7&&(s["!ref"]=Kr(u)),s}function K0(n,e){return dV(null,n,e)}function Bme(n){return n.read_shift(4,"i")}function ro(n,e){return e||(e=Re(4)),e.write_shift(4,n),e}function Zi(n){var e=n.read_shift(4);return e===0?"":n.read_shift(e,"dbcs")}function mi(n,e){var t=!1;return e==null&&(t=!0,e=Re(4+2*n.length)),e.write_shift(4,n.length),n.length>0&&e.write_shift(0,n,"dbcs"),t?e.slice(0,e.l):e}function Ume(n){return{ich:n.read_shift(2),ifnt:n.read_shift(2)}}function zme(n,e){return e||(e=Re(4)),e.write_shift(2,0),e.write_shift(2,0),e}function tC(n,e){var t=n.l,r=n.read_shift(1),i=Zi(n),s=[],a={t:i,h:i};if((r&1)!==0){for(var o=n.read_shift(4),l=0;l!=o;++l)s.push(Ume(n));a.r=s}else a.r=[{ich:0,ifnt:0}];return n.l=t+e,a}function $me(n,e){var t=!1;return e==null&&(t=!0,e=Re(15+4*n.t.length)),e.write_shift(1,0),mi(n.t,e),t?e.slice(0,e.l):e}var Wme=tC;function Hme(n,e){var t=!1;return e==null&&(t=!0,e=Re(23+4*n.t.length)),e.write_shift(1,1),mi(n.t,e),e.write_shift(4,1),zme({},e),t?e.slice(0,e.l):e}function Ca(n){var e=n.read_shift(4),t=n.read_shift(2);return t+=n.read_shift(1)<<16,n.l++,{c:e,iStyleRef:t}}function xd(n,e){return e==null&&(e=Re(8)),e.write_shift(-4,n.c),e.write_shift(3,n.iStyleRef||n.s),e.write_shift(1,0),e}function vd(n){var e=n.read_shift(2);return e+=n.read_shift(1)<<16,n.l++,{c:-1,iStyleRef:e}}function wd(n,e){return e==null&&(e=Re(4)),e.write_shift(3,n.iStyleRef||n.s),e.write_shift(1,0),e}var Kme=Zi,fV=mi;function nC(n){var e=n.read_shift(4);return e===0||e===4294967295?"":n.read_shift(e,"dbcs")}function xv(n,e){var t=!1;return e==null&&(t=!0,e=Re(127)),e.write_shift(4,n.length>0?n.length:4294967295),n.length>0&&e.write_shift(0,n,"dbcs"),t?e.slice(0,e.l):e}var Yme=Zi,Ub=nC,rC=xv;function gV(n){var e=n.slice(n.l,n.l+4),t=e[0]&1,r=e[0]&2;n.l+=4;var i=r===0?_v([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):mh(e,0)>>2;return t?i/100:i}function mV(n,e){e==null&&(e=Re(4));var t=0,r=0,i=n*100;if(n==(n|0)&&n>=-536870912&&n<1<<29?r=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(r=1,t=1),r)e.write_shift(-4,((t?i:n)<<2)+(t+2));else throw new Error("unsupported RkNumber "+n)}function pV(n){var e={s:{},e:{}};return e.s.r=n.read_shift(4),e.e.r=n.read_shift(4),e.s.c=n.read_shift(4),e.e.c=n.read_shift(4),e}function qme(n,e){return e||(e=Re(16)),e.write_shift(4,n.s.r),e.write_shift(4,n.e.r),e.write_shift(4,n.s.c),e.write_shift(4,n.e.c),e}var Ed=pV,Y0=qme;function q0(n){if(n.length-n.l<8)throw"XLS Xnum Buffer underflow";return n.read_shift(8,"f")}function nd(n,e){return(e||Re(8)).write_shift(8,n,"f")}function Xme(n){var e={},t=n.read_shift(1),r=t>>>1,i=n.read_shift(1),s=n.read_shift(2,"i"),a=n.read_shift(1),o=n.read_shift(1),l=n.read_shift(1);switch(n.l++,r){case 0:e.auto=1;break;case 1:e.index=i;var u=spe[i];u&&(e.rgb=TO(u));break;case 2:e.rgb=TO([a,o,l]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function vv(n,e){if(e||(e=Re(8)),!n||n.auto)return e.write_shift(4,0),e.write_shift(4,0),e;n.index!=null?(e.write_shift(1,2),e.write_shift(1,n.index)):n.theme!=null?(e.write_shift(1,6),e.write_shift(1,n.theme)):(e.write_shift(1,5),e.write_shift(1,0));var t=n.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),e.write_shift(2,t),!n.rgb||n.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var r=n.rgb||"FFFFFF";typeof r=="number"&&(r=("000000"+r.toString(16)).slice(-6)),e.write_shift(1,parseInt(r.slice(0,2),16)),e.write_shift(1,parseInt(r.slice(2,4),16)),e.write_shift(1,parseInt(r.slice(4,6),16)),e.write_shift(1,255)}return e}function Zme(n){var e=n.read_shift(1);n.l++;var t={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return t}function Qme(n,e){e||(e=Re(2));var t=(n.italic?2:0)|(n.strike?8:0)|(n.outline?16:0)|(n.shadow?32:0)|(n.condense?64:0)|(n.extend?128:0);return e.write_shift(1,t),e.write_shift(1,0),e}var yV=2,Bs=3,x_=11,wv=19,v_=64,Jme=65,epe=71,tpe=4108,npe=4126,Ti=80,gO={1:{n:"CodePage",t:yV},2:{n:"Category",t:Ti},3:{n:"PresentationFormat",t:Ti},4:{n:"ByteCount",t:Bs},5:{n:"LineCount",t:Bs},6:{n:"ParagraphCount",t:Bs},7:{n:"SlideCount",t:Bs},8:{n:"NoteCount",t:Bs},9:{n:"HiddenCount",t:Bs},10:{n:"MultimediaClipCount",t:Bs},11:{n:"ScaleCrop",t:x_},12:{n:"HeadingPairs",t:tpe},13:{n:"TitlesOfParts",t:npe},14:{n:"Manager",t:Ti},15:{n:"Company",t:Ti},16:{n:"LinksUpToDate",t:x_},17:{n:"CharacterCount",t:Bs},19:{n:"SharedDoc",t:x_},22:{n:"HyperlinksChanged",t:x_},23:{n:"AppVersion",t:Bs,p:"version"},24:{n:"DigSig",t:Jme},26:{n:"ContentType",t:Ti},27:{n:"ContentStatus",t:Ti},28:{n:"Language",t:Ti},29:{n:"Version",t:Ti},255:{},2147483648:{n:"Locale",t:wv},2147483651:{n:"Behavior",t:wv},1919054434:{}},mO={1:{n:"CodePage",t:yV},2:{n:"Title",t:Ti},3:{n:"Subject",t:Ti},4:{n:"Author",t:Ti},5:{n:"Keywords",t:Ti},6:{n:"Comments",t:Ti},7:{n:"Template",t:Ti},8:{n:"LastAuthor",t:Ti},9:{n:"RevNumber",t:Ti},10:{n:"EditTime",t:v_},11:{n:"LastPrinted",t:v_},12:{n:"CreatedDate",t:v_},13:{n:"ModifiedDate",t:v_},14:{n:"PageCount",t:Bs},15:{n:"WordCount",t:Bs},16:{n:"CharCount",t:Bs},17:{n:"Thumbnail",t:epe},18:{n:"Application",t:Ti},19:{n:"DocSecurity",t:Bs},255:{},2147483648:{n:"Locale",t:wv},2147483651:{n:"Behavior",t:wv},1919054434:{}};function rpe(n){return n.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var ipe=rpe([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),spe=ks(ipe),N1={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},ape={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},w_={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function _V(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function xV(n,e){var t=pme(ape),r=[],i;r[r.length]=qr,r[r.length]=nt("Types",null,{xmlns:fi.CT,"xmlns:xsd":fi.xsd,"xmlns:xsi":fi.xsi}),r=r.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return nt("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){n[l]&&n[l].length>0&&(i=n[l][0],r[r.length]=nt("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:w_[l][e.bookType]||w_[l].xlsx}))},a=function(l){(n[l]||[]).forEach(function(u){r[r.length]=nt("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:w_[l][e.bookType]||w_[l].xlsx})})},o=function(l){(n[l]||[]).forEach(function(u){r[r.length]=nt("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:t[l][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),r.length>2&&(r[r.length]="</Types>",r[1]=r[1].replace("/>",">")),r.join("")}var Sn={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function vV(n){var e=n.lastIndexOf("/");return n.slice(0,e+1)+"_rels/"+n.slice(e+1)+".rels"}function r0(n){var e=[qr,nt("Relationships",null,{xmlns:fi.RELS})];return Mi(n["!id"]).forEach(function(t){e[e.length]=nt("Relationship",null,n["!id"][t])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Un(n,e,t,r,i,s){if(i||(i={}),n["!id"]||(n["!id"]={}),n["!idx"]||(n["!idx"]=1),e<0)for(e=n["!idx"];n["!id"]["rId"+e];++e);if(n["!idx"]=e+1,i.Id="rId"+e,i.Type=r,i.Target=t,[Sn.HLINK,Sn.XPATH,Sn.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),n["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return n["!id"][i.Id]=i,n[("/"+i.Target).replace("//","/")]=i,e}function ope(n){var e=[qr];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<n.length;++t)e.push('  <manifest:file-entry manifest:full-path="'+n[t][0]+'" manifest:media-type="'+n[t][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function pO(n,e,t){return['  <rdf:Description rdf:about="'+n+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function lpe(n,e){return['  <rdf:Description rdf:about="'+n+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function cpe(n){var e=[qr];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=n.length;++t)e.push(pO(n[t][0],n[t][1])),e.push(lpe("",n[t][0]));return e.push(pO("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function wV(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+dv.version+"</meta:generator></office:meta></office:document-meta>"}var Mh=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function BS(n,e,t,r,i){i[n]!=null||e==null||e===""||(i[n]=e,e=Wn(e),r[r.length]=t?nt(n,e,t):Ri(n,e))}function EV(n,e){var t=e||{},r=[qr,nt("cp:coreProperties",null,{"xmlns:cp":fi.CORE_PROPS,"xmlns:dc":fi.dc,"xmlns:dcterms":fi.dcterms,"xmlns:dcmitype":fi.dcmitype,"xmlns:xsi":fi.xsi})],i={};if(!n&&!t.Props)return r.join("");n&&(n.CreatedDate!=null&&BS("dcterms:created",typeof n.CreatedDate=="string"?n.CreatedDate:Bb(n.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i),n.ModifiedDate!=null&&BS("dcterms:modified",typeof n.ModifiedDate=="string"?n.ModifiedDate:Bb(n.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i));for(var s=0;s!=Mh.length;++s){var a=Mh[s],o=t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:n?n[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&BS(a[0],o,null,r,i)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var i0=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],SV=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function TV(n){var e=[],t=nt;return n||(n={}),n.Application="SheetJS",e[e.length]=qr,e[e.length]=nt("Properties",null,{xmlns:fi.EXT_PROPS,"xmlns:vt":fi.vt}),i0.forEach(function(r){if(n[r[1]]!==void 0){var i;switch(r[2]){case"string":i=Wn(String(n[r[1]]));break;case"bool":i=n[r[1]]?"true":"false";break}i!==void 0&&(e[e.length]=t(r[0],i))}}),e[e.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(n.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=t("TitlesOfParts",t("vt:vector",n.SheetNames.map(function(r){return"<vt:lpstr>"+Wn(r)+"</vt:lpstr>"}).join(""),{size:n.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}function bV(n){var e=[qr,nt("Properties",null,{xmlns:fi.CUST_PROPS,"xmlns:vt":fi.vt})];if(!n)return e.join("");var t=1;return Mi(n).forEach(function(i){++t,e[e.length]=nt("property",Ame(n[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:Wn(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var yO={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function upe(n,e){var t=[];return Mi(yO).map(function(r){for(var i=0;i<Mh.length;++i)if(Mh[i][1]==r)return Mh[i];for(i=0;i<i0.length;++i)if(i0[i][1]==r)return i0[i];throw r}).forEach(function(r){if(n[r[1]]!=null){var i=e&&e.Props&&e.Props[r[1]]!=null?e.Props[r[1]]:n[r[1]];switch(r[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),t.push(Ri(yO[r[1]]||r[1],i))}}),nt("DocumentProperties",t.join(""),{xmlns:Hs.o})}function hpe(n,e){var t=["Worksheets","SheetNames"],r="CustomDocumentProperties",i=[];return n&&Mi(n).forEach(function(s){if(Object.prototype.hasOwnProperty.call(n,s)){for(var a=0;a<Mh.length;++a)if(s==Mh[a][1])return;for(a=0;a<i0.length;++a)if(s==i0[a][1])return;for(a=0;a<t.length;++a)if(s==t[a])return;var o=n[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push(nt(iO(s),o,{"dt:dt":l}))}}),e&&Mi(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(n&&Object.prototype.hasOwnProperty.call(n,s))){var a=e[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(nt(iO(s),a,{"dt:dt":o}))}}),"<"+r+' xmlns="'+Hs.o+'">'+i.join("")+"</"+r+">"}function dpe(n){var e=typeof n=="string"?new Date(Date.parse(n)):n,t=e.getTime()/1e3+11644473600,r=t%Math.pow(2,32),i=(t-r)/Math.pow(2,32);r*=1e7,i*=1e7;var s=r/Math.pow(2,32)|0;s>0&&(r=r%Math.pow(2,32),i+=s);var a=Re(8);return a.write_shift(4,r),a.write_shift(4,i),a}function _O(n,e){var t=Re(4),r=Re(4);switch(t.write_shift(4,n==80?31:n),n){case 3:r.write_shift(-4,e);break;case 5:r=Re(8),r.write_shift(8,e,"f");break;case 11:r.write_shift(4,e?1:0);break;case 64:r=dpe(e);break;case 31:case 80:for(r=Re(4+2*(e.length+1)+(e.length%2?0:2)),r.write_shift(4,e.length+1),r.write_shift(0,e,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+e)}return Ai([t,r])}var IV=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function fpe(n){switch(typeof n){case"boolean":return 11;case"number":return(n|0)==n?3:5;case"string":return 31;case"object":if(n instanceof Date)return 64;break}return-1}function xO(n,e,t){var r=Re(8),i=[],s=[],a=8,o=0,l=Re(8),u=Re(8);if(l.write_shift(4,2),l.write_shift(4,1200),u.write_shift(4,1),s.push(l),i.push(u),a+=8+l.length,!e){u=Re(8),u.write_shift(4,0),i.unshift(u);var h=[Re(4)];for(h[0].write_shift(4,n.length),o=0;o<n.length;++o){var f=n[o][0];for(l=Re(8+2*(f.length+1)+(f.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,f.length+1),l.write_shift(0,f,"dbcs");l.l!=l.length;)l.write_shift(1,0);h.push(l)}l=Ai(h),s.unshift(l),a+=8+l.length}for(o=0;o<n.length;++o)if(!(e&&!e[n[o][0]])&&!(IV.indexOf(n[o][0])>-1||SV.indexOf(n[o][0])>-1)&&n[o][1]!=null){var g=n[o][1],y=0;if(e){y=+e[n[o][0]];var v=t[y];if(v.p=="version"&&typeof g=="string"){var x=g.split(".");g=(+x[0]<<16)+(+x[1]||0)}l=_O(v.t,g)}else{var E=fpe(g);E==-1&&(E=31,g=String(g)),l=_O(E,g)}s.push(l),u=Re(8),u.write_shift(4,e?y:2+o),i.push(u),a+=8+l.length}var T=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,T),T+=s[o].length;return r.write_shift(4,a),r.write_shift(4,s.length),Ai([r].concat(i).concat(s))}function vO(n,e,t,r,i,s){var a=Re(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,Yn.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,i?68:48);var l=xO(n,t,r);if(o.push(l),i){var u=xO(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+l.length),o.push(u)}return Ai(o)}function gpe(n,e){e||(e=Re(n));for(var t=0;t<n;++t)e.write_shift(1,0);return e}function mpe(n,e){return n.read_shift(e)===1}function rs(n,e){return e||(e=Re(2)),e.write_shift(2,+!!n),e}function AV(n){return n.read_shift(2,"u")}function ya(n,e){return e||(e=Re(2)),e.write_shift(2,n),e}function RV(n,e,t){return t||(t=Re(2)),t.write_shift(1,e=="e"?+n:+!!n),t.write_shift(1,e=="e"?1:0),t}function CV(n,e,t){var r=n.read_shift(t&&t.biff>=12?2:1),i="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var s=n.read_shift(1);s&&(i="dbcs-cont")}else t.biff==12&&(i="wstr");t.biff>=2&&t.biff<=5&&(i="cpstr");var a=r?n.read_shift(r,i):"";return a}function ppe(n){var e=n.t||"",t=Re(3);t.write_shift(2,e.length),t.write_shift(1,1);var r=Re(2*e.length);r.write_shift(2*e.length,e,"utf16le");var i=[t,r];return Ai(i)}function ype(n,e,t){var r;if(t){if(t.biff>=2&&t.biff<=5)return n.read_shift(e,"cpstr");if(t.biff>=12)return n.read_shift(e,"dbcs-cont")}var i=n.read_shift(1);return i===0?r=n.read_shift(e,"sbcs-cont"):r=n.read_shift(e,"dbcs-cont"),r}function _pe(n,e,t){var r=n.read_shift(t&&t.biff==2?1:2);return r===0?(n.l++,""):ype(n,r,t)}function xpe(n,e,t){if(t.biff>5)return _pe(n,e,t);var r=n.read_shift(1);return r===0?(n.l++,""):n.read_shift(r,t.biff<=4||!n.lens?"cpstr":"sbcs-cont")}function PV(n,e,t){return t||(t=Re(3+2*n.length)),t.write_shift(2,n.length),t.write_shift(1,1),t.write_shift(31,n,"utf16le"),t}function wO(n,e){e||(e=Re(6+n.length*2)),e.write_shift(4,1+n.length);for(var t=0;t<n.length;++t)e.write_shift(2,n.charCodeAt(t));return e.write_shift(2,0),e}function vpe(n){var e=Re(512),t=0,r=n.Target;r.slice(0,7)=="file://"&&(r=r.slice(7));var i=r.indexOf("#"),s=i>-1?31:23;switch(r.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(t=0;t<a.length;++t)e.write_shift(4,a[t]);if(s==28)r=r.slice(1),wO(r,e);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<a.length;++t)e.write_shift(1,parseInt(a[t],16));var o=i>-1?r.slice(0,i):r;for(e.write_shift(4,2*(o.length+1)),t=0;t<o.length;++t)e.write_shift(2,o.charCodeAt(t));e.write_shift(2,0),s&8&&wO(i>-1?r.slice(i+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<a.length;++t)e.write_shift(1,parseInt(a[t],16));for(var l=0;r.slice(l*3,l*3+3)=="../"||r.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,r.length-3*l+1),t=0;t<r.length-3*l;++t)e.write_shift(1,r.charCodeAt(t+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),t=0;t<6;++t)e.write_shift(4,0)}return e.slice(0,e.l)}function rd(n,e,t,r){return r||(r=Re(6)),r.write_shift(2,n),r.write_shift(2,e),r.write_shift(2,t||0),r}function wpe(n,e,t){var r=t.biff>8?4:2,i=n.read_shift(r),s=n.read_shift(r,"i"),a=n.read_shift(r,"i");return[i,s,a]}function Epe(n){var e=n.read_shift(2),t=n.read_shift(2),r=n.read_shift(2),i=n.read_shift(2);return{s:{c:r,r:e},e:{c:i,r:t}}}function kV(n,e){return e||(e=Re(8)),e.write_shift(2,n.s.r),e.write_shift(2,n.e.r),e.write_shift(2,n.s.c),e.write_shift(2,n.e.c),e}function iC(n,e,t){var r=1536,i=16;switch(t.bookType){case"biff8":break;case"biff5":r=1280,i=8;break;case"biff4":r=4,i=6;break;case"biff3":r=3,i=6;break;case"biff2":r=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=Re(i);return s.write_shift(2,r),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function Spe(n,e){var t=!e||e.biff==8,r=Re(t?112:54);for(r.write_shift(e.biff==8?2:1,7),t&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(t?0:536870912));r.l<r.length;)r.write_shift(1,t?0:32);return r}function Tpe(n,e){var t=!e||e.biff>=8?2:1,r=Re(8+t*n.name.length);r.write_shift(4,n.pos),r.write_shift(1,n.hs||0),r.write_shift(1,n.dt),r.write_shift(1,n.name.length),e.biff>=8&&r.write_shift(1,1),r.write_shift(t*n.name.length,n.name,e.biff<8?"sbcs":"utf16le");var i=r.slice(0,r.l);return i.l=r.l,i}function bpe(n,e){var t=Re(8);t.write_shift(4,n.Count),t.write_shift(4,n.Unique);for(var r=[],i=0;i<n.length;++i)r[i]=ppe(n[i]);var s=Ai([t].concat(r));return s.parts=[t.length].concat(r.map(function(a){return a.length})),s}function Ipe(){var n=Re(18);return n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,29280),n.write_shift(2,17600),n.write_shift(2,56),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,1),n.write_shift(2,500),n}function Ape(n){var e=Re(18),t=1718;return n&&n.RTL&&(t|=64),e.write_shift(2,t),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function Rpe(n,e){var t=n.name||"Arial",r=e&&e.biff==5,i=r?15+t.length:16+2*t.length,s=Re(i);return s.write_shift(2,n.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,t.length),r||s.write_shift(1,1),s.write_shift((r?1:2)*t.length,t,r?"sbcs":"utf16le"),s}function Cpe(n,e,t,r){var i=Re(10);return rd(n,e,r,i),i.write_shift(4,t),i}function Ppe(n,e,t,r,i){var s=!i||i.biff==8,a=Re(8+ +s+(1+s)*t.length);return rd(n,e,r,a),a.write_shift(2,t.length),s&&a.write_shift(1,1),a.write_shift((1+s)*t.length,t,s?"utf16le":"sbcs"),a}function kpe(n,e,t,r){var i=t&&t.biff==5;r||(r=Re(i?3+e.length:5+2*e.length)),r.write_shift(2,n),r.write_shift(i?1:2,e.length),i||r.write_shift(1,1),r.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=r.length>r.l?r.slice(0,r.l):r;return s.l==null&&(s.l=s.length),s}function Mpe(n,e){var t=e.biff==8||!e.biff?4:2,r=Re(2*t+6);return r.write_shift(t,n.s.r),r.write_shift(t,n.e.r+1),r.write_shift(2,n.s.c),r.write_shift(2,n.e.c+1),r.write_shift(2,0),r}function EO(n,e,t,r){var i=t&&t.biff==5;r||(r=Re(i?16:20)),r.write_shift(2,0),n.style?(r.write_shift(2,n.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,n.numFmtId||0),r.write_shift(2,e<<4));var s=0;return n.numFmtId>0&&i&&(s|=1024),r.write_shift(4,s),r.write_shift(4,0),i||r.write_shift(4,0),r.write_shift(2,0),r}function Npe(n){var e=Re(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function Lpe(n,e,t,r,i,s){var a=Re(8);return rd(n,e,r,a),RV(t,s,a),a}function Ope(n,e,t,r){var i=Re(14);return rd(n,e,r,i),nd(t,i),i}function Dpe(n,e,t){if(t.biff<8)return Fpe(n,e,t);for(var r=[],i=n.l+e,s=n.read_shift(t.biff>8?4:2);s--!==0;)r.push(wpe(n,t.biff>8?12:6,t));if(n.l!=i)throw new Error("Bad ExternSheet: "+n.l+" != "+i);return r}function Fpe(n,e,t){n[n.l+1]==3&&n[n.l]++;var r=CV(n,e,t);return r.charCodeAt(0)==3?r.slice(1):r}function jpe(n){var e=Re(2+n.length*8);e.write_shift(2,n.length);for(var t=0;t<n.length;++t)kV(n[t],e);return e}function Vpe(n){var e=Re(24),t=gi(n[0]);e.write_shift(2,t.r),e.write_shift(2,t.r),e.write_shift(2,t.c),e.write_shift(2,t.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(r[i],16));return Ai([e,vpe(n[1])])}function Gpe(n){var e=n[1].Tooltip,t=Re(10+2*(e.length+1));t.write_shift(2,2048);var r=gi(n[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var i=0;i<e.length;++i)t.write_shift(2,e.charCodeAt(i));return t.write_shift(2,0),t}function Bpe(n){return n||(n=Re(4)),n.write_shift(2,1),n.write_shift(2,1),n}function Upe(n,e,t){if(!t.cellStyles)return Jo(n,e);var r=t&&t.biff>=12?4:2,i=n.read_shift(r),s=n.read_shift(r),a=n.read_shift(r),o=n.read_shift(r),l=n.read_shift(2);r==2&&(n.l+=2);var u={s:i,e:s,w:a,ixfe:o,flags:l};return(t.biff>=5||!t.biff)&&(u.level=l>>8&7),u}function zpe(n,e){var t=Re(12);t.write_shift(2,e),t.write_shift(2,e),t.write_shift(2,n.width*256),t.write_shift(2,0);var r=0;return n.hidden&&(r|=1),t.write_shift(1,r),r=n.level||0,t.write_shift(1,r),t.write_shift(2,0),t}function $pe(n){for(var e=Re(2*n),t=0;t<n;++t)e.write_shift(2,t+1);return e}function Wpe(n,e,t){var r=Re(15);return O1(r,n,e),r.write_shift(8,t,"f"),r}function Hpe(n,e,t){var r=Re(9);return O1(r,n,e),r.write_shift(2,t),r}var Kpe=(function(){var n={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=KR({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(o,l){var u=[],h=td(1);switch(l.type){case"base64":h=Ya(Kl(o));break;case"binary":h=Ya(o);break;case"buffer":case"array":h=o;break}zs(h,0);var f=h.read_shift(1),g=!!(f&136),y=!1,v=!1;switch(f){case 2:break;case 3:break;case 48:y=!0,g=!0;break;case 49:y=!0,g=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var x=0,E=521;f==2&&(x=h.read_shift(2)),h.l+=3,f!=2&&(x=h.read_shift(4)),x>1048576&&(x=1e6),f!=2&&(E=h.read_shift(2));var T=h.read_shift(2),b=l.codepage||1252;f!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(b=n[h[h.l]]),h.l+=1,h.l+=2),v&&(h.l+=36);for(var I=[],M={},F=Math.min(h.length,f==2?521:E-10-(y?264:0)),z=v?32:11;h.l<F&&h[h.l]!=13;)switch(M={},M.name=fv.utils.decode(b,h.slice(h.l,h.l+z)).replace(/[\u0000\r\n].*$/g,""),h.l+=z,M.type=String.fromCharCode(h.read_shift(1)),f!=2&&!v&&(M.offset=h.read_shift(4)),M.len=h.read_shift(1),f==2&&(M.offset=h.read_shift(2)),M.dec=h.read_shift(1),M.name.length&&I.push(M),f!=2&&(h.l+=v?13:14),M.type){case"B":(!y||M.len!=8)&&l.WTF&&console.log("Skipping "+M.name+":"+M.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+M.name+":"+M.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+M.type)}if(h[h.l]!==13&&(h.l=E-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=E;var k=0,C=0;for(u[0]=[],C=0;C!=I.length;++C)u[0][C]=I[C].name;for(;x-- >0;){if(h[h.l]===42){h.l+=T;continue}for(++h.l,u[++k]=[],C=0,C=0;C!=I.length;++C){var P=h.slice(h.l,h.l+I[C].len);h.l+=I[C].len,zs(P,0);var L=fv.utils.decode(b,P);switch(I[C].type){case"C":L.trim().length&&(u[k][C]=L.replace(/\s+$/,""));break;case"D":L.length===8?u[k][C]=new Date(+L.slice(0,4),+L.slice(4,6)-1,+L.slice(6,8)):u[k][C]=L;break;case"F":u[k][C]=parseFloat(L.trim());break;case"+":case"I":u[k][C]=v?P.read_shift(-4,"i")^2147483648:P.read_shift(4,"i");break;case"L":switch(L.trim().toUpperCase()){case"Y":case"T":u[k][C]=!0;break;case"N":case"F":u[k][C]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+L+"|")}break;case"M":if(!g)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[k][C]="##MEMO##"+(v?parseInt(L.trim(),10):P.read_shift(4));break;case"N":L=L.replace(/\u0000/g,"").trim(),L&&L!="."&&(u[k][C]=+L||0);break;case"@":u[k][C]=new Date(P.read_shift(-8,"f")-621356832e5);break;case"T":u[k][C]=new Date((P.read_shift(4)-2440588)*864e5+P.read_shift(4));break;case"Y":u[k][C]=P.read_shift(4,"i")/1e4+P.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[k][C]=-P.read_shift(-8,"f");break;case"B":if(y&&I[C].len==8){u[k][C]=P.read_shift(8,"f");break}case"G":case"P":P.l+=I[C].len;break;case"0":if(I[C].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+I[C].type)}}}if(f!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=I,u}function r(o,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var h=K0(t(o,u),u);return h["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,h}function i(o,l){try{return _d(r(o,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var u=l||{};if(+u.codepage>=0&&Pp(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var h=Rs(),f=Iv(o,{header:1,raw:!0,cellDates:!0}),g=f[0],y=f.slice(1),v=o["!cols"]||[],x=0,E=0,T=0,b=1;for(x=0;x<g.length;++x){if(((v[x]||{}).DBF||{}).name){g[x]=v[x].DBF.name,++T;continue}if(g[x]!=null){if(++T,typeof g[x]=="number"&&(g[x]=g[x].toString(10)),typeof g[x]!="string")throw new Error("DBF Invalid column name "+g[x]+" |"+typeof g[x]+"|");if(g.indexOf(g[x])!==x){for(E=0;E<1024;++E)if(g.indexOf(g[x]+"_"+E)==-1){g[x]+="_"+E;break}}}}var I=cr(o["!ref"]),M=[],F=[],z=[];for(x=0;x<=I.e.c-I.s.c;++x){var k="",C="",P=0,L=[];for(E=0;E<y.length;++E)y[E][x]!=null&&L.push(y[E][x]);if(L.length==0||g[x]==null){M[x]="?";continue}for(E=0;E<L.length;++E){switch(typeof L[E]){case"number":C="B";break;case"string":C="C";break;case"boolean":C="L";break;case"object":C=L[E]instanceof Date?"D":"C";break;default:C="C"}P=Math.max(P,String(L[E]).length),k=k&&k!=C?"C":C}P>250&&(P=250),C=((v[x]||{}).DBF||{}).type,C=="C"&&v[x].DBF.len>P&&(P=v[x].DBF.len),k=="B"&&C=="N"&&(k="N",z[x]=v[x].DBF.dec,P=v[x].DBF.len),F[x]=k=="C"||C=="N"?P:s[k]||0,b+=F[x],M[x]=k}var O=h.next(32);for(O.write_shift(4,318902576),O.write_shift(4,y.length),O.write_shift(2,296+32*T),O.write_shift(2,b),x=0;x<4;++x)O.write_shift(4,0);for(O.write_shift(4,0|(+e[N7]||3)<<8),x=0,E=0;x<g.length;++x)if(g[x]!=null){var U=h.next(32),j=(g[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);U.write_shift(1,j,"sbcs"),U.write_shift(1,M[x]=="?"?"C":M[x],"sbcs"),U.write_shift(4,E),U.write_shift(1,F[x]||s[M[x]]||0),U.write_shift(1,z[x]||0),U.write_shift(1,2),U.write_shift(4,0),U.write_shift(1,0),U.write_shift(4,0),U.write_shift(4,0),E+=F[x]||s[M[x]]||0}var Ie=h.next(264);for(Ie.write_shift(4,13),x=0;x<65;++x)Ie.write_shift(4,0);for(x=0;x<y.length;++x){var ke=h.next(b);for(ke.write_shift(1,0),E=0;E<g.length;++E)if(g[E]!=null)switch(M[E]){case"L":ke.write_shift(1,y[x][E]==null?63:y[x][E]?84:70);break;case"B":ke.write_shift(8,y[x][E]||0,"f");break;case"N":var ze="0";for(typeof y[x][E]=="number"&&(ze=y[x][E].toFixed(z[E]||0)),T=0;T<F[E]-ze.length;++T)ke.write_shift(1,32);ke.write_shift(1,ze,"sbcs");break;case"D":y[x][E]?(ke.write_shift(4,("0000"+y[x][E].getFullYear()).slice(-4),"sbcs"),ke.write_shift(2,("00"+(y[x][E].getMonth()+1)).slice(-2),"sbcs"),ke.write_shift(2,("00"+y[x][E].getDate()).slice(-2),"sbcs")):ke.write_shift(8,"00000000","sbcs");break;case"C":var Ne=String(y[x][E]!=null?y[x][E]:"").slice(0,F[E]);for(ke.write_shift(1,Ne,"sbcs"),T=0;T<F[E]-Ne.length;++T)ke.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:i,to_sheet:r,from_sheet:a}})(),Ype=(function(){var n={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Mi(n).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(g,y){var v=n[y];return typeof v=="number"?HL(v):v},r=function(g,y,v){var x=y.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return x==59?g:HL(x)};n["|"]=254;function i(g,y){switch(y.type){case"base64":return s(Kl(g),y);case"binary":return s(g,y);case"buffer":return s(Rn&&Buffer.isBuffer(g)?g.toString("binary"):P1(g),y);case"array":return s(Hw(g),y)}throw new Error("Unrecognized type "+y.type)}function s(g,y){var v=g.split(/[\n\r]+/),x=-1,E=-1,T=0,b=0,I=[],M=[],F=null,z={},k=[],C=[],P=[],L=0,O;for(+y.codepage>=0&&Pp(+y.codepage);T!==v.length;++T){L=0;var U=v[T].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(e,t),j=U.replace(/;;/g,"\0").split(";").map(function(X){return X.replace(/\u0000/g,";")}),Ie=j[0],ke;if(U.length>0)switch(Ie){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":j[1].charAt(0)=="P"&&M.push(U.slice(3).replace(/;;/g,";"));break;case"C":var ze=!1,Ne=!1,ce=!1,Te=!1,Ee=-1,se=-1;for(b=1;b<j.length;++b)switch(j[b].charAt(0)){case"A":break;case"X":E=parseInt(j[b].slice(1))-1,Ne=!0;break;case"Y":for(x=parseInt(j[b].slice(1))-1,Ne||(E=0),O=I.length;O<=x;++O)I[O]=[];break;case"K":ke=j[b].slice(1),ke.charAt(0)==='"'?ke=ke.slice(1,ke.length-1):ke==="TRUE"?ke=!0:ke==="FALSE"?ke=!1:isNaN(Fl(ke))?isNaN(Mp(ke).getDate())||(ke=us(ke)):(ke=Fl(ke),F!==null&&W7(F)&&(ke=q7(ke))),ze=!0;break;case"E":Te=!0;var V=H1e(j[b].slice(1),{r:x,c:E});I[x][E]=[I[x][E],V];break;case"S":ce=!0,I[x][E]=[I[x][E],"S5S"];break;case"G":break;case"R":Ee=parseInt(j[b].slice(1))-1;break;case"C":se=parseInt(j[b].slice(1))-1;break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+U)}if(ze&&(I[x][E]&&I[x][E].length==2?I[x][E][0]=ke:I[x][E]=ke,F=null),ce){if(Te)throw new Error("SYLK shared formula cannot have own formula");var J=Ee>-1&&I[Ee][se];if(!J||!J[1])throw new Error("SYLK shared formula cannot find base");I[x][E][1]=K1e(J[1],{r:x-Ee,c:E-se})}break;case"F":var ne=0;for(b=1;b<j.length;++b)switch(j[b].charAt(0)){case"X":E=parseInt(j[b].slice(1))-1,++ne;break;case"Y":for(x=parseInt(j[b].slice(1))-1,O=I.length;O<=x;++O)I[O]=[];break;case"M":L=parseInt(j[b].slice(1))/20;break;case"F":break;case"G":break;case"P":F=M[parseInt(j[b].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(P=j[b].slice(1).split(" "),O=parseInt(P[0],10);O<=parseInt(P[1],10);++O)L=parseInt(P[2],10),C[O-1]=L===0?{hidden:!0}:{wch:L},sC(C[O-1]);break;case"C":E=parseInt(j[b].slice(1))-1,C[E]||(C[E]={});break;case"R":x=parseInt(j[b].slice(1))-1,k[x]||(k[x]={}),L>0?(k[x].hpt=L,k[x].hpx=DV(L)):L===0&&(k[x].hidden=!0);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+U)}ne<1&&(F=null);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+U)}}return k.length>0&&(z["!rows"]=k),C.length>0&&(z["!cols"]=C),y&&y.sheetRows&&(I=I.slice(0,y.sheetRows)),[I,z]}function a(g,y){var v=i(g,y),x=v[0],E=v[1],T=K0(x,y);return Mi(E).forEach(function(b){T[b]=E[b]}),T}function o(g,y){return _d(a(g,y),y)}function l(g,y,v,x){var E="C;Y"+(v+1)+";X"+(x+1)+";K";switch(g.t){case"n":E+=g.v||0,g.f&&!g.F&&(E+=";E"+oC(g.f,{r:v,c:x}));break;case"b":E+=g.v?"TRUE":"FALSE";break;case"e":E+=g.w||g.v;break;case"d":E+='"'+(g.w||g.v)+'"';break;case"s":E+='"'+g.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return E}function u(g,y){y.forEach(function(v,x){var E="F;W"+(x+1)+" "+(x+1)+" ";v.hidden?E+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=Ev(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=Sv(v.wpx)),typeof v.wch=="number"&&(E+=Math.round(v.wch))),E.charAt(E.length-1)!=" "&&g.push(E)})}function h(g,y){y.forEach(function(v,x){var E="F;";v.hidden?E+="M0;":v.hpt?E+="M"+20*v.hpt+";":v.hpx&&(E+="M"+20*Tv(v.hpx)+";"),E.length>2&&g.push(E+"R"+(x+1))})}function f(g,y){var v=["ID;PWXL;N;E"],x=[],E=cr(g["!ref"]),T,b=Array.isArray(g),I=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),g["!cols"]&&u(v,g["!cols"]),g["!rows"]&&h(v,g["!rows"]),v.push("B;Y"+(E.e.r-E.s.r+1)+";X"+(E.e.c-E.s.c+1)+";D"+[E.s.c,E.s.r,E.e.c,E.e.r].join(" "));for(var M=E.s.r;M<=E.e.r;++M)for(var F=E.s.c;F<=E.e.c;++F){var z=Kn({r:M,c:F});T=b?(g[M]||[])[F]:g[z],!(!T||T.v==null&&(!T.f||T.F))&&x.push(l(T,g,M,F))}return v.join(I)+I+x.join(I)+I+"E"+I}return{to_workbook:o,to_sheet:a,from_sheet:f}})(),qpe=(function(){function n(s,a){switch(a.type){case"base64":return e(Kl(s),a);case"binary":return e(s,a);case"buffer":return e(Rn&&Buffer.isBuffer(s)?s.toString("binary"):P1(s),a);case"array":return e(Hw(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var o=s.split(`
`),l=-1,u=-1,h=0,f=[];h!==o.length;++h){if(o[h].trim()==="BOT"){f[++l]=[],u=0;continue}if(!(l<0)){var g=o[h].trim().split(","),y=g[0],v=g[1];++h;for(var x=o[h]||"";(x.match(/["]/g)||[]).length&1&&h<o.length-1;)x+=`
`+o[++h];switch(x=x.trim(),+y){case-1:if(x==="BOT"){f[++l]=[],u=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?f[l][u]=!0:x==="FALSE"?f[l][u]=!1:isNaN(Fl(v))?isNaN(Mp(v).getDate())?f[l][u]=v:f[l][u]=us(v):f[l][u]=Fl(v),++u;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),f[l][u++]=x!==""?x:null;break}if(x==="EOD")break}}return a&&a.sheetRows&&(f=f.slice(0,a.sheetRows)),f}function t(s,a){return K0(n(s,a),a)}function r(s,a){return _d(t(s,a),a)}var i=(function(){var s=function(l,u,h,f,g){l.push(u),l.push(h+","+f),l.push('"'+g.replace(/"/g,'""')+'"')},a=function(l,u,h,f){l.push(u+","+h),l.push(u==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(l){var u=[],h=cr(l["!ref"]),f,g=Array.isArray(l);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,h.e.r-h.s.r+1,""),s(u,"TUPLES",0,h.e.c-h.s.c+1,""),s(u,"DATA",0,0,"");for(var y=h.s.r;y<=h.e.r;++y){a(u,-1,0,"BOT");for(var v=h.s.c;v<=h.e.c;++v){var x=Kn({r:y,c:v});if(f=g?(l[y]||[])[v]:l[x],!f){a(u,1,0,"");continue}switch(f.t){case"n":var E=f.w;!E&&f.v!=null&&(E=f.v),E==null?f.f&&!f.F?a(u,1,0,"="+f.f):a(u,1,0,""):a(u,0,E,"V");break;case"b":a(u,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":a(u,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=vu(f.z||Cr[14],Ps(us(f.v)))),a(u,0,f.w,"V");break;default:a(u,1,0,"")}}}a(u,-1,0,"EOD");var T=`\r
`,b=u.join(T);return b}})();return{to_workbook:r,to_sheet:t,from_sheet:i}})(),MV=(function(){function n(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(f,g){for(var y=f.split(`
`),v=-1,x=-1,E=0,T=[];E!==y.length;++E){var b=y[E].trim().split(":");if(b[0]==="cell"){var I=gi(b[1]);if(T.length<=I.r)for(v=T.length;v<=I.r;++v)T[v]||(T[v]=[]);switch(v=I.r,x=I.c,b[2]){case"t":T[v][x]=n(b[3]);break;case"v":T[v][x]=+b[3];break;case"vtf":var M=b[b.length-1];case"vtc":switch(b[3]){case"nl":T[v][x]=!!+b[4];break;default:T[v][x]=+b[4];break}b[2]=="vtf"&&(T[v][x]=[T[v][x],M])}}}return g&&g.sheetRows&&(T=T.slice(0,g.sheetRows)),T}function r(f,g){return K0(t(f,g),g)}function i(f,g){return _d(r(f,g),g)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var g=[],y=[],v,x="",E=ra(f["!ref"]),T=Array.isArray(f),b=E.s.r;b<=E.e.r;++b)for(var I=E.s.c;I<=E.e.c;++I)if(x=Kn({r:b,c:I}),v=T?(f[b]||[])[I]:f[x],!(!v||v.v==null||v.t==="z")){switch(y=["cell",x,"t"],v.t){case"s":case"str":y.push(e(v.v));break;case"n":v.f?(y[2]="vtf",y[3]="n",y[4]=v.v,y[5]=e(v.f)):(y[2]="v",y[3]=v.v);break;case"b":y[2]="vt"+(v.f?"f":"c"),y[3]="nl",y[4]=v.v?"1":"0",y[5]=e(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var M=Ps(us(v.v));y[2]="vtc",y[3]="nd",y[4]=""+M,y[5]=v.w||vu(v.z||Cr[14],M);break;case"e":continue}g.push(y.join(":"))}return g.push("sheet:c:"+(E.e.c-E.s.c+1)+":r:"+(E.e.r-E.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)}function h(f){return[s,a,o,a,u(f),l].join(`
`)}return{to_workbook:i,to_sheet:r,from_sheet:h}})(),Xpe=(function(){function n(h,f,g,y,v){v.raw?f[g][y]=h:h===""||(h==="TRUE"?f[g][y]=!0:h==="FALSE"?f[g][y]=!1:isNaN(Fl(h))?isNaN(Mp(h).getDate())?f[g][y]=h:f[g][y]=us(h):f[g][y]=Fl(h))}function e(h,f){var g=f||{},y=[];if(!h||h.length===0)return y;for(var v=h.split(/[\r\n]/),x=v.length-1;x>=0&&v[x].length===0;)--x;for(var E=10,T=0,b=0;b<=x;++b)T=v[b].indexOf(" "),T==-1?T=v[b].length:T++,E=Math.max(E,T);for(b=0;b<=x;++b){y[b]=[];var I=0;for(n(v[b].slice(0,E).trim(),y,b,I,g),I=1;I<=(v[b].length-E)/10+1;++I)n(v[b].slice(E+(I-1)*10,E+I*10).trim(),y,b,I,g)}return g.sheetRows&&(y=y.slice(0,g.sheetRows)),y}var t={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function i(h){for(var f={},g=!1,y=0,v=0;y<h.length;++y)(v=h.charCodeAt(y))==34?g=!g:!g&&v in t&&(f[v]=(f[v]||0)+1);v=[];for(y in f)Object.prototype.hasOwnProperty.call(f,y)&&v.push([f[y],y]);if(!v.length){f=r;for(y in f)Object.prototype.hasOwnProperty.call(f,y)&&v.push([f[y],y])}return v.sort(function(x,E){return x[0]-E[0]||r[x[1]]-r[E[1]]}),t[v.pop()[1]]||44}function s(h,f){var g=f||{},y="",v=g.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(y=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(y=h.charAt(4),h=h.slice(6)):y=i(h.slice(0,1024)):g&&g.FS?y=g.FS:y=i(h.slice(0,1024));var E=0,T=0,b=0,I=0,M=0,F=y.charCodeAt(0),z=!1,k=0,C=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var P=g.dateNF!=null?dme(g.dateNF):null;function L(){var O=h.slice(I,M),U={};if(O.charAt(0)=='"'&&O.charAt(O.length-1)=='"'&&(O=O.slice(1,-1).replace(/""/g,'"')),O.length===0)U.t="z";else if(g.raw)U.t="s",U.v=O;else if(O.trim().length===0)U.t="s",U.v=O;else if(O.charCodeAt(0)==61)O.charCodeAt(1)==34&&O.charCodeAt(O.length-1)==34?(U.t="s",U.v=O.slice(2,-1).replace(/""/g,'"')):Y1e(O)?(U.t="n",U.f=O.slice(1)):(U.t="s",U.v=O);else if(O=="TRUE")U.t="b",U.v=!0;else if(O=="FALSE")U.t="b",U.v=!1;else if(!isNaN(b=Fl(O)))U.t="n",g.cellText!==!1&&(U.w=O),U.v=b;else if(!isNaN(Mp(O).getDate())||P&&O.match(P)){U.z=g.dateNF||Cr[14];var j=0;P&&O.match(P)&&(O=fme(O,g.dateNF,O.match(P)||[]),j=1),g.cellDates?(U.t="d",U.v=us(O,j)):(U.t="n",U.v=Ps(us(O,j))),g.cellText!==!1&&(U.w=vu(U.z,U.v instanceof Date?Ps(U.v):U.v)),g.cellNF||delete U.z}else U.t="s",U.v=O;if(U.t=="z"||(g.dense?(v[E]||(v[E]=[]),v[E][T]=U):v[Kn({c:T,r:E})]=U),I=M+1,C=h.charCodeAt(I),x.e.c<T&&(x.e.c=T),x.e.r<E&&(x.e.r=E),k==F)++T;else if(T=0,++E,g.sheetRows&&g.sheetRows<=E)return!0}e:for(;M<h.length;++M)switch(k=h.charCodeAt(M)){case 34:C===34&&(z=!z);break;case F:case 10:case 13:if(!z&&L())break e;break}return M-I>0&&L(),v["!ref"]=Kr(x),v}function a(h,f){return!(f&&f.PRN)||f.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?s(h,f):K0(e(h,f),f)}function o(h,f){var g="",y=f.type=="string"?[0,0,0,0]:lwe(h,f);switch(f.type){case"base64":g=Kl(h);break;case"binary":g=h;break;case"buffer":f.codepage==65001?g=h.toString("utf8"):f.codepage&&typeof fv<"u"||(g=Rn&&Buffer.isBuffer(h)?h.toString("binary"):P1(h));break;case"array":g=Hw(h);break;case"string":g=h;break;default:throw new Error("Unrecognized type "+f.type)}return y[0]==239&&y[1]==187&&y[2]==191?g=jm(g.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?g=jm(g):f.type=="binary"&&typeof fv<"u",g.slice(0,19)=="socialcalc:version:"?MV.to_sheet(f.type=="string"?g:jm(g),f):a(g,f)}function l(h,f){return _d(o(h,f),f)}function u(h){for(var f=[],g=cr(h["!ref"]),y,v=Array.isArray(h),x=g.s.r;x<=g.e.r;++x){for(var E=[],T=g.s.c;T<=g.e.c;++T){var b=Kn({r:x,c:T});if(y=v?(h[x]||[])[T]:h[b],!y||y.v==null){E.push("          ");continue}for(var I=(y.w||(Yl(y),y.w)||"").slice(0,10);I.length<10;)I+=" ";E.push(I+(T===0?" ":""))}f.push(E.join(""))}return f.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:u}})(),SO=(function(){function n(V,J,ne){if(V){zs(V,V.l||0);for(var X=ne.Enum||Ee;V.l<V.length;){var ue=V.read_shift(2),Me=X[ue]||X[65535],je=V.read_shift(2),De=V.l+je,Be=Me.f&&Me.f(V,je,ne);if(V.l=De,J(Be,Me,ue))return}}}function e(V,J){switch(J.type){case"base64":return t(Ya(Kl(V)),J);case"binary":return t(Ya(V),J);case"buffer":case"array":return t(V,J)}throw"Unsupported type "+J.type}function t(V,J){if(!V)return V;var ne=J||{},X=ne.dense?[]:{},ue="Sheet1",Me="",je=0,De={},Be=[],Gt=[],Kt={s:{r:0,c:0},e:{r:0,c:0}},wn=ne.sheetRows||0;if(V[2]==0&&(V[3]==8||V[3]==9)&&V.length>=16&&V[14]==5&&V[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(V[2]==2)ne.Enum=Ee,n(V,function(ot,Xn,on){switch(on){case 0:ne.vers=ot,ot>=4096&&(ne.qpro=!0);break;case 6:Kt=ot;break;case 204:ot&&(Me=ot);break;case 222:Me=ot;break;case 15:case 51:ne.qpro||(ot[1].v=ot[1].v.slice(1));case 13:case 14:case 16:on==14&&(ot[2]&112)==112&&(ot[2]&15)>1&&(ot[2]&15)<15&&(ot[1].z=ne.dateNF||Cr[14],ne.cellDates&&(ot[1].t="d",ot[1].v=q7(ot[1].v))),ne.qpro&&ot[3]>je&&(X["!ref"]=Kr(Kt),De[ue]=X,Be.push(ue),X=ne.dense?[]:{},Kt={s:{r:0,c:0},e:{r:0,c:0}},je=ot[3],ue=Me||"Sheet"+(je+1),Me="");var en=ne.dense?(X[ot[0].r]||[])[ot[0].c]:X[Kn(ot[0])];if(en){en.t=ot[1].t,en.v=ot[1].v,ot[1].z!=null&&(en.z=ot[1].z),ot[1].f!=null&&(en.f=ot[1].f);break}ne.dense?(X[ot[0].r]||(X[ot[0].r]=[]),X[ot[0].r][ot[0].c]=ot[1]):X[Kn(ot[0])]=ot[1];break}},ne);else if(V[2]==26||V[2]==14)ne.Enum=se,V[2]==14&&(ne.qpro=!0,V.l=0),n(V,function(ot,Xn,on){switch(on){case 204:ue=ot;break;case 22:ot[1].v=ot[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ot[3]>je&&(X["!ref"]=Kr(Kt),De[ue]=X,Be.push(ue),X=ne.dense?[]:{},Kt={s:{r:0,c:0},e:{r:0,c:0}},je=ot[3],ue="Sheet"+(je+1)),wn>0&&ot[0].r>=wn)break;ne.dense?(X[ot[0].r]||(X[ot[0].r]=[]),X[ot[0].r][ot[0].c]=ot[1]):X[Kn(ot[0])]=ot[1],Kt.e.c<ot[0].c&&(Kt.e.c=ot[0].c),Kt.e.r<ot[0].r&&(Kt.e.r=ot[0].r);break;case 27:ot[14e3]&&(Gt[ot[14e3][0]]=ot[14e3][1]);break;case 1537:Gt[ot[0]]=ot[1],ot[0]==je&&(ue=ot[1]);break}},ne);else throw new Error("Unrecognized LOTUS BOF "+V[2]);if(X["!ref"]=Kr(Kt),De[Me||ue]=X,Be.push(Me||ue),!Gt.length)return{SheetNames:Be,Sheets:De};for(var Bt={},Fn=[],Qt=0;Qt<Gt.length;++Qt)De[Be[Qt]]?(Fn.push(Gt[Qt]||Be[Qt]),Bt[Gt[Qt]]=De[Gt[Qt]]||De[Be[Qt]]):(Fn.push(Gt[Qt]),Bt[Gt[Qt]]={"!ref":"A1"});return{SheetNames:Fn,Sheets:Bt}}function r(V,J){var ne=J||{};if(+ne.codepage>=0&&Pp(+ne.codepage),ne.type=="string")throw new Error("Cannot write WK1 to JS string");var X=Rs(),ue=cr(V["!ref"]),Me=Array.isArray(V),je=[];rt(X,0,s(1030)),rt(X,6,l(ue));for(var De=Math.min(ue.e.r,8191),Be=ue.s.r;Be<=De;++Be)for(var Gt=ki(Be),Kt=ue.s.c;Kt<=ue.e.c;++Kt){Be===ue.s.r&&(je[Kt]=Xi(Kt));var wn=je[Kt]+Gt,Bt=Me?(V[Be]||[])[Kt]:V[wn];if(!(!Bt||Bt.t=="z"))if(Bt.t=="n")(Bt.v|0)==Bt.v&&Bt.v>=-32768&&Bt.v<=32767?rt(X,13,y(Be,Kt,Bt.v)):rt(X,14,x(Be,Kt,Bt.v));else{var Fn=Yl(Bt);rt(X,15,f(Be,Kt,Fn.slice(0,239)))}}return rt(X,1),X.end()}function i(V,J){var ne=J||{};if(+ne.codepage>=0&&Pp(+ne.codepage),ne.type=="string")throw new Error("Cannot write WK3 to JS string");var X=Rs();rt(X,0,a(V));for(var ue=0,Me=0;ue<V.SheetNames.length;++ue)(V.Sheets[V.SheetNames[ue]]||{})["!ref"]&&rt(X,27,Te(V.SheetNames[ue],Me++));var je=0;for(ue=0;ue<V.SheetNames.length;++ue){var De=V.Sheets[V.SheetNames[ue]];if(!(!De||!De["!ref"])){for(var Be=cr(De["!ref"]),Gt=Array.isArray(De),Kt=[],wn=Math.min(Be.e.r,8191),Bt=Be.s.r;Bt<=wn;++Bt)for(var Fn=ki(Bt),Qt=Be.s.c;Qt<=Be.e.c;++Qt){Bt===Be.s.r&&(Kt[Qt]=Xi(Qt));var ot=Kt[Qt]+Fn,Xn=Gt?(De[Bt]||[])[Qt]:De[ot];if(!(!Xn||Xn.t=="z"))if(Xn.t=="n")rt(X,23,L(Bt,Qt,je,Xn.v));else{var on=Yl(Xn);rt(X,22,k(Bt,Qt,je,on.slice(0,239)))}}++je}}return rt(X,1),X.end()}function s(V){var J=Re(2);return J.write_shift(2,V),J}function a(V){var J=Re(26);J.write_shift(2,4096),J.write_shift(2,4),J.write_shift(4,0);for(var ne=0,X=0,ue=0,Me=0;Me<V.SheetNames.length;++Me){var je=V.SheetNames[Me],De=V.Sheets[je];if(!(!De||!De["!ref"])){++ue;var Be=ra(De["!ref"]);ne<Be.e.r&&(ne=Be.e.r),X<Be.e.c&&(X=Be.e.c)}}return ne>8191&&(ne=8191),J.write_shift(2,ne),J.write_shift(1,ue),J.write_shift(1,X),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(1,1),J.write_shift(1,2),J.write_shift(4,0),J.write_shift(4,0),J}function o(V,J,ne){var X={s:{c:0,r:0},e:{c:0,r:0}};return J==8&&ne.qpro?(X.s.c=V.read_shift(1),V.l++,X.s.r=V.read_shift(2),X.e.c=V.read_shift(1),V.l++,X.e.r=V.read_shift(2),X):(X.s.c=V.read_shift(2),X.s.r=V.read_shift(2),J==12&&ne.qpro&&(V.l+=2),X.e.c=V.read_shift(2),X.e.r=V.read_shift(2),J==12&&ne.qpro&&(V.l+=2),X.s.c==65535&&(X.s.c=X.e.c=X.s.r=X.e.r=0),X)}function l(V){var J=Re(8);return J.write_shift(2,V.s.c),J.write_shift(2,V.s.r),J.write_shift(2,V.e.c),J.write_shift(2,V.e.r),J}function u(V,J,ne){var X=[{c:0,r:0},{t:"n",v:0},0,0];return ne.qpro&&ne.vers!=20768?(X[0].c=V.read_shift(1),X[3]=V.read_shift(1),X[0].r=V.read_shift(2),V.l+=2):(X[2]=V.read_shift(1),X[0].c=V.read_shift(2),X[0].r=V.read_shift(2)),X}function h(V,J,ne){var X=V.l+J,ue=u(V,J,ne);if(ue[1].t="s",ne.vers==20768){V.l++;var Me=V.read_shift(1);return ue[1].v=V.read_shift(Me,"utf8"),ue}return ne.qpro&&V.l++,ue[1].v=V.read_shift(X-V.l,"cstr"),ue}function f(V,J,ne){var X=Re(7+ne.length);X.write_shift(1,255),X.write_shift(2,J),X.write_shift(2,V),X.write_shift(1,39);for(var ue=0;ue<X.length;++ue){var Me=ne.charCodeAt(ue);X.write_shift(1,Me>=128?95:Me)}return X.write_shift(1,0),X}function g(V,J,ne){var X=u(V,J,ne);return X[1].v=V.read_shift(2,"i"),X}function y(V,J,ne){var X=Re(7);return X.write_shift(1,255),X.write_shift(2,J),X.write_shift(2,V),X.write_shift(2,ne,"i"),X}function v(V,J,ne){var X=u(V,J,ne);return X[1].v=V.read_shift(8,"f"),X}function x(V,J,ne){var X=Re(13);return X.write_shift(1,255),X.write_shift(2,J),X.write_shift(2,V),X.write_shift(8,ne,"f"),X}function E(V,J,ne){var X=V.l+J,ue=u(V,J,ne);if(ue[1].v=V.read_shift(8,"f"),ne.qpro)V.l=X;else{var Me=V.read_shift(2);M(V.slice(V.l,V.l+Me),ue),V.l+=Me}return ue}function T(V,J,ne){var X=J&32768;return J&=-32769,J=(X?V:0)+(J>=8192?J-16384:J),(X?"":"$")+(ne?Xi(J):ki(J))}var b={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},I=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function M(V,J){zs(V,0);for(var ne=[],X=0,ue="",Me="",je="",De="";V.l<V.length;){var Be=V[V.l++];switch(Be){case 0:ne.push(V.read_shift(8,"f"));break;case 1:Me=T(J[0].c,V.read_shift(2),!0),ue=T(J[0].r,V.read_shift(2),!1),ne.push(Me+ue);break;case 2:{var Gt=T(J[0].c,V.read_shift(2),!0),Kt=T(J[0].r,V.read_shift(2),!1);Me=T(J[0].c,V.read_shift(2),!0),ue=T(J[0].r,V.read_shift(2),!1),ne.push(Gt+Kt+":"+Me+ue)}break;case 3:if(V.l<V.length){console.error("WK1 premature formula end");return}break;case 4:ne.push("("+ne.pop()+")");break;case 5:ne.push(V.read_shift(2));break;case 6:{for(var wn="";Be=V[V.l++];)wn+=String.fromCharCode(Be);ne.push('"'+wn.replace(/"/g,'""')+'"')}break;case 8:ne.push("-"+ne.pop());break;case 23:ne.push("+"+ne.pop());break;case 22:ne.push("NOT("+ne.pop()+")");break;case 20:case 21:De=ne.pop(),je=ne.pop(),ne.push(["AND","OR"][Be-20]+"("+je+","+De+")");break;default:if(Be<32&&I[Be])De=ne.pop(),je=ne.pop(),ne.push(je+I[Be]+De);else if(b[Be]){if(X=b[Be][1],X==69&&(X=V[V.l++]),X>ne.length){console.error("WK1 bad formula parse 0x"+Be.toString(16)+":|"+ne.join("|")+"|");return}var Bt=ne.slice(-X);ne.length-=X,ne.push(b[Be][0]+"("+Bt.join(",")+")")}else return Be<=7?console.error("WK1 invalid opcode "+Be.toString(16)):Be<=24?console.error("WK1 unsupported op "+Be.toString(16)):Be<=30?console.error("WK1 invalid opcode "+Be.toString(16)):Be<=115?console.error("WK1 unsupported function opcode "+Be.toString(16)):console.error("WK1 unrecognized opcode "+Be.toString(16))}}ne.length==1?J[1].f=""+ne[0]:console.error("WK1 bad formula parse |"+ne.join("|")+"|")}function F(V){var J=[{c:0,r:0},{t:"n",v:0},0];return J[0].r=V.read_shift(2),J[3]=V[V.l++],J[0].c=V[V.l++],J}function z(V,J){var ne=F(V);return ne[1].t="s",ne[1].v=V.read_shift(J-4,"cstr"),ne}function k(V,J,ne,X){var ue=Re(6+X.length);ue.write_shift(2,V),ue.write_shift(1,ne),ue.write_shift(1,J),ue.write_shift(1,39);for(var Me=0;Me<X.length;++Me){var je=X.charCodeAt(Me);ue.write_shift(1,je>=128?95:je)}return ue.write_shift(1,0),ue}function C(V,J){var ne=F(V);ne[1].v=V.read_shift(2);var X=ne[1].v>>1;if(ne[1].v&1)switch(X&7){case 0:X=(X>>3)*5e3;break;case 1:X=(X>>3)*500;break;case 2:X=(X>>3)/20;break;case 3:X=(X>>3)/200;break;case 4:X=(X>>3)/2e3;break;case 5:X=(X>>3)/2e4;break;case 6:X=(X>>3)/16;break;case 7:X=(X>>3)/64;break}return ne[1].v=X,ne}function P(V,J){var ne=F(V),X=V.read_shift(4),ue=V.read_shift(4),Me=V.read_shift(2);if(Me==65535)return X===0&&ue===3221225472?(ne[1].t="e",ne[1].v=15):X===0&&ue===3489660928?(ne[1].t="e",ne[1].v=42):ne[1].v=0,ne;var je=Me&32768;return Me=(Me&32767)-16446,ne[1].v=(1-je*2)*(ue*Math.pow(2,Me+32)+X*Math.pow(2,Me)),ne}function L(V,J,ne,X){var ue=Re(14);if(ue.write_shift(2,V),ue.write_shift(1,ne),ue.write_shift(1,J),X==0)return ue.write_shift(4,0),ue.write_shift(4,0),ue.write_shift(2,65535),ue;var Me=0,je=0,De=0,Be=0;return X<0&&(Me=1,X=-X),je=Math.log2(X)|0,X/=Math.pow(2,je-31),Be=X>>>0,(Be&2147483648)==0&&(X/=2,++je,Be=X>>>0),X-=Be,Be|=2147483648,Be>>>=0,X*=Math.pow(2,32),De=X>>>0,ue.write_shift(4,De),ue.write_shift(4,Be),je+=16383+(Me?32768:0),ue.write_shift(2,je),ue}function O(V,J){var ne=P(V);return V.l+=J-14,ne}function U(V,J){var ne=F(V),X=V.read_shift(4);return ne[1].v=X>>6,ne}function j(V,J){var ne=F(V),X=V.read_shift(8,"f");return ne[1].v=X,ne}function Ie(V,J){var ne=j(V);return V.l+=J-10,ne}function ke(V,J){return V[V.l+J-1]==0?V.read_shift(J,"cstr"):""}function ze(V,J){var ne=V[V.l++];ne>J-1&&(ne=J-1);for(var X="";X.length<ne;)X+=String.fromCharCode(V[V.l++]);return X}function Ne(V,J,ne){if(!(!ne.qpro||J<21)){var X=V.read_shift(1);V.l+=17,V.l+=1,V.l+=2;var ue=V.read_shift(J-21,"cstr");return[X,ue]}}function ce(V,J){for(var ne={},X=V.l+J;V.l<X;){var ue=V.read_shift(2);if(ue==14e3){for(ne[ue]=[0,""],ne[ue][0]=V.read_shift(2);V[V.l];)ne[ue][1]+=String.fromCharCode(V[V.l]),V.l++;V.l++}}return ne}function Te(V,J){var ne=Re(5+V.length);ne.write_shift(2,14e3),ne.write_shift(2,J);for(var X=0;X<V.length;++X){var ue=V.charCodeAt(X);ne[ne.l++]=ue>127?95:ue}return ne[ne.l++]=0,ne}var Ee={0:{n:"BOF",f:AV},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:g},14:{n:"NUMBER",f:v},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:E},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ke},222:{n:"SHEETNAMELP",f:ze},65535:{n:""}},se={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:z},23:{n:"NUMBER17",f:P},24:{n:"NUMBER18",f:C},25:{n:"FORMULA19",f:O},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ce},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:U},38:{n:"??"},39:{n:"NUMBER27",f:j},40:{n:"FORMULA28",f:Ie},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ke},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Ne},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:i,to_workbook:e}})(),Zpe=/^\s|\s$|[\t\n\r]/;function NV(n,e){if(!e.bookSST)return"";var t=[qr];t[t.length]=nt("sst",null,{xmlns:H0[0],count:n.Count,uniqueCount:n.Unique});for(var r=0;r!=n.length;++r)if(n[r]!=null){var i=n[r],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(Zpe)&&(s+=' xml:space="preserve"'),s+=">"+Wn(i.t)+"</t>"),s+="</si>",t[t.length]=s}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function Qpe(n){return[n.read_shift(4),n.read_shift(4)]}function Jpe(n,e){return e||(e=Re(8)),e.write_shift(4,n.Count),e.write_shift(4,n.Unique),e}var e1e=$me;function t1e(n){var e=Rs();Ge(e,159,Jpe(n));for(var t=0;t<n.length;++t)Ge(e,19,e1e(n[t]));return Ge(e,160),e.end()}function n1e(n){for(var e=[],t=n.split(""),r=0;r<t.length;++r)e[r]=t[r].charCodeAt(0);return e}function LV(n){var e=0,t,r=n1e(n),i=r.length+1,s,a,o,l,u;for(t=td(i),t[0]=r.length,s=1;s!=i;++s)t[s]=r[s-1];for(s=i-1;s>=0;--s)a=t[s],o=(e&16384)===0?0:1,l=e<<1&32767,u=o|l,e=u^a;return e^52811}var r1e=(function(){function n(i,s){switch(s.type){case"base64":return e(Kl(i),s);case"binary":return e(i,s);case"buffer":return e(Rn&&Buffer.isBuffer(i)?i.toString("binary"):P1(i),s);case"array":return e(Hw(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(h,f){Array.isArray(o)&&(o[f]=[]);for(var g=/\\\w+\b/g,y=0,v,x=-1;v=g.exec(h);){switch(v[0]){case"\\cell":var E=h.slice(y,g.lastIndex-v[0].length);if(E[0]==" "&&(E=E.slice(1)),++x,E.length){var T={v:E,t:"s"};Array.isArray(o)?o[f][x]=T:o[Kn({r:f,c:x})]=T}break}y=g.lastIndex}x>u.e.c&&(u.e.c=x)}),o["!ref"]=Kr(u),o}function t(i,s){return _d(n(i,s),s)}function r(i){for(var s=["{\\rtf1\\ansi"],a=cr(i["!ref"]),o,l=Array.isArray(i),u=a.s.r;u<=a.e.r;++u){s.push("\\trowd\\trautofit1");for(var h=a.s.c;h<=a.e.c;++h)s.push("\\cellx"+(h+1));for(s.push("\\pard\\intbl"),h=a.s.c;h<=a.e.c;++h){var f=Kn({r:u,c:h});o=l?(i[u]||[])[h]:i[f],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(Yl(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:t,to_sheet:n,from_sheet:r}})();function TO(n){for(var e=0,t=1;e!=3;++e)t=t*256+(n[e]>255?255:n[e]<0?0:n[e]);return t.toString(16).toUpperCase().slice(1)}var i1e=6,jl=i1e;function Ev(n){return Math.floor((n+Math.round(128/jl)/256)*jl)}function Sv(n){return Math.floor((n-5)/jl*100+.5)/100}function zb(n){return Math.round((n*jl+5)/jl*256)/256}function sC(n){n.width?(n.wpx=Ev(n.width),n.wch=Sv(n.wpx),n.MDW=jl):n.wpx?(n.wch=Sv(n.wpx),n.width=zb(n.wch),n.MDW=jl):typeof n.wch=="number"&&(n.width=zb(n.wch),n.wpx=Ev(n.width),n.MDW=jl),n.customWidth&&delete n.customWidth}var s1e=96,OV=s1e;function Tv(n){return n*96/OV}function DV(n){return n*OV/96}function a1e(n){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var r=t[0];r<=t[1];++r)n[r]!=null&&(e[e.length]=nt("numFmt",null,{numFmtId:r,formatCode:Wn(n[r])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=nt("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function o1e(n){var e=[];return e[e.length]=nt("cellXfs",null),n.forEach(function(t){e[e.length]=nt("xf",null,t)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=nt("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function FV(n,e){var t=[qr,nt("styleSheet",null,{xmlns:H0[0],"xmlns:vt":fi.vt})],r;return n.SSF&&(r=a1e(n.SSF))!=null&&(t[t.length]=r),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=o1e(e.cellXfs))&&(t[t.length]=r),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function l1e(n,e){var t=n.read_shift(2),r=Zi(n);return[t,r]}function c1e(n,e,t){t||(t=Re(6+4*e.length)),t.write_shift(2,n),mi(e,t);var r=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),r}function u1e(n,e,t){var r={};r.sz=n.read_shift(2)/20;var i=Zme(n);i.fItalic&&(r.italic=1),i.fCondense&&(r.condense=1),i.fExtend&&(r.extend=1),i.fShadow&&(r.shadow=1),i.fOutline&&(r.outline=1),i.fStrikeout&&(r.strike=1);var s=n.read_shift(2);switch(s===700&&(r.bold=1),n.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var a=n.read_shift(1);a!=0&&(r.underline=a);var o=n.read_shift(1);o>0&&(r.family=o);var l=n.read_shift(1);switch(l>0&&(r.charset=l),n.l++,r.color=Xme(n),n.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=Zi(n),r}function h1e(n,e){e||(e=Re(153)),e.write_shift(2,n.sz*20),Qme(n,e),e.write_shift(2,n.bold?700:400);var t=0;n.vertAlign=="superscript"?t=1:n.vertAlign=="subscript"&&(t=2),e.write_shift(2,t),e.write_shift(1,n.underline||0),e.write_shift(1,n.family||0),e.write_shift(1,n.charset||0),e.write_shift(1,0),vv(n.color,e);var r=0;return r=2,e.write_shift(1,r),mi(n.name,e),e.length>e.l?e.slice(0,e.l):e}var d1e=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],US,f1e=Jo;function bO(n,e){e||(e=Re(84)),US||(US=KR(d1e));var t=US[n.patternType];t==null&&(t=40),e.write_shift(4,t);var r=0;if(t!=40)for(vv({auto:1},e),vv({auto:1},e);r<12;++r)e.write_shift(4,0);else{for(;r<4;++r)e.write_shift(4,0);for(;r<12;++r)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function g1e(n,e){var t=n.l+e,r=n.read_shift(2),i=n.read_shift(2);return n.l=t,{ixfe:r,numFmtId:i}}function jV(n,e,t){t||(t=Re(16)),t.write_shift(2,e||0),t.write_shift(2,n.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var r=0;return t.write_shift(1,r),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function Kg(n,e){return e||(e=Re(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var m1e=Jo;function p1e(n,e){return e||(e=Re(51)),e.write_shift(1,0),Kg(null,e),Kg(null,e),Kg(null,e),Kg(null,e),Kg(null,e),e.length>e.l?e.slice(0,e.l):e}function y1e(n,e){return e||(e=Re(52)),e.write_shift(4,n.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),xv(n.name||"",e),e.length>e.l?e.slice(0,e.l):e}function _1e(n,e,t){var r=Re(2052);return r.write_shift(4,n),xv(e,r),xv(t,r),r.length>r.l?r.slice(0,r.l):r}function x1e(n,e){if(e){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&++t}),t!=0&&(Ge(n,615,ro(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&Ge(n,44,c1e(i,e[i]))}),Ge(n,616))}}function v1e(n){var e=1;Ge(n,611,ro(e)),Ge(n,43,h1e({sz:12,color:{theme:1},name:"Calibri",family:2})),Ge(n,612)}function w1e(n){var e=2;Ge(n,603,ro(e)),Ge(n,45,bO({patternType:"none"})),Ge(n,45,bO({patternType:"gray125"})),Ge(n,604)}function E1e(n){var e=1;Ge(n,613,ro(e)),Ge(n,46,p1e()),Ge(n,614)}function S1e(n){var e=1;Ge(n,626,ro(e)),Ge(n,47,jV({numFmtId:0},65535)),Ge(n,627)}function T1e(n,e){Ge(n,617,ro(e.length)),e.forEach(function(t){Ge(n,47,jV(t,0))}),Ge(n,618)}function b1e(n){var e=1;Ge(n,619,ro(e)),Ge(n,48,y1e({xfId:0,name:"Normal"})),Ge(n,620)}function I1e(n){var e=0;Ge(n,505,ro(e)),Ge(n,506)}function A1e(n){var e=0;Ge(n,508,_1e(e,"TableStyleMedium9","PivotStyleMedium4")),Ge(n,509)}function R1e(n,e){var t=Rs();return Ge(t,278),x1e(t,n.SSF),v1e(t),w1e(t),E1e(t),S1e(t),T1e(t,e.cellXfs),b1e(t),I1e(t),A1e(t),Ge(t,279),t.end()}function VV(n,e){if(e&&e.themeXLSX)return e.themeXLSX;if(n&&typeof n.raw=="string")return n.raw;var t=[qr];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function C1e(n,e){return{flags:n.read_shift(4),version:n.read_shift(4),name:Zi(n)}}function P1e(n){var e=Re(12+2*n.name.length);return e.write_shift(4,n.flags),e.write_shift(4,n.version),mi(n.name,e),e.slice(0,e.l)}function k1e(n){for(var e=[],t=n.read_shift(4);t-- >0;)e.push([n.read_shift(4),n.read_shift(4)]);return e}function M1e(n){var e=Re(4+8*n.length);e.write_shift(4,n.length);for(var t=0;t<n.length;++t)e.write_shift(4,n[t][0]),e.write_shift(4,n[t][1]);return e}function N1e(n,e){var t=Re(8+2*e.length);return t.write_shift(4,n),mi(e,t),t.slice(0,t.l)}function L1e(n){return n.l+=4,n.read_shift(4)!=0}function O1e(n,e){var t=Re(8);return t.write_shift(4,n),t.write_shift(4,1),t}function D1e(){var n=Rs();return Ge(n,332),Ge(n,334,ro(1)),Ge(n,335,P1e({name:"XLDAPR",version:12e4,flags:3496657072})),Ge(n,336),Ge(n,339,N1e(1,"XLDAPR")),Ge(n,52),Ge(n,35,ro(514)),Ge(n,4096,ro(0)),Ge(n,4097,ya(1)),Ge(n,36),Ge(n,53),Ge(n,340),Ge(n,337,O1e(1)),Ge(n,51,M1e([[1,0]])),Ge(n,338),Ge(n,333),n.end()}function GV(){var n=[qr];return n.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),n.join("")}function F1e(n){var e={};e.i=n.read_shift(4);var t={};t.r=n.read_shift(4),t.c=n.read_shift(4),e.r=Kn(t);var r=n.read_shift(1);return r&2&&(e.l="1"),r&8&&(e.a="1"),e}var Bf=1024;function BV(n,e){for(var t=[21600,21600],r=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),i=[nt("xml",null,{"xmlns:v":Hs.v,"xmlns:o":Hs.o,"xmlns:x":Hs.x,"xmlns:mv":Hs.mv}).replace(/\/>/,">"),nt("o:shapelayout",nt("o:idmap",null,{"v:ext":"edit",data:n}),{"v:ext":"edit"}),nt("v:shapetype",[nt("v:stroke",null,{joinstyle:"miter"}),nt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:r})];Bf<n*1e3;)Bf+=1e3;return e.forEach(function(s){var a=gi(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?nt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=nt("v:fill",l,o),h={on:"t",obscured:"t"};++Bf,i=i.concat(["<v:shape"+Lp({id:"_x0000_s"+Bf,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,nt("v:shadow",null,h),nt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Ri("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),Ri("x:AutoFill","False"),Ri("x:Row",String(a.r)),Ri("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function UV(n){var e=[qr,nt("comments",null,{xmlns:H0[0]})],t=[];return e.push("<authors>"),n.forEach(function(r){r[1].forEach(function(i){var s=Wn(i.a);t.indexOf(s)==-1&&(t.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&t.indexOf("tc="+i.ID)==-1&&(t.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),n.forEach(function(r){var i=0,s=[];if(r[1][0]&&r[1][0].T&&r[1][0].ID?i=t.indexOf("tc="+r[1][0].ID):r[1].forEach(function(l){l.a&&(i=t.indexOf(Wn(l.a))),s.push(l.t||"")}),e.push('<comment ref="'+r[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(Ri("t",Wn(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;e.push(Ri("t",Wn(a)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function j1e(n,e,t){var r=[qr,nt("ThreadedComments",null,{xmlns:fi.TCMNT}).replace(/[\/]>/,">")];return n.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),r.push(nt("threadedComment",Ri("text",a.t||""),l))})}),r.push("</ThreadedComments>"),r.join("")}function V1e(n){var e=[qr,nt("personList",null,{xmlns:fi.TCMNT,"xmlns:x":H0[0]}).replace(/[\/]>/,">")];return n.forEach(function(t,r){e.push(nt("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:t,providerId:"None"}))}),e.push("</personList>"),e.join("")}function G1e(n){var e={};e.iauthor=n.read_shift(4);var t=Ed(n);return e.rfx=t.s,e.ref=Kn(t.s),n.l+=16,e}function B1e(n,e){return e==null&&(e=Re(36)),e.write_shift(4,n[1].iauthor),Y0(n[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var U1e=Zi;function z1e(n){return mi(n.slice(0,54))}function $1e(n){var e=Rs(),t=[];return Ge(e,628),Ge(e,630),n.forEach(function(r){r[1].forEach(function(i){t.indexOf(i.a)>-1||(t.push(i.a.slice(0,54)),Ge(e,632,z1e(i.a)))})}),Ge(e,631),Ge(e,633),n.forEach(function(r){r[1].forEach(function(i){i.iauthor=t.indexOf(i.a);var s={s:gi(r[0]),e:gi(r[0])};Ge(e,635,B1e([s,i])),i.t&&i.t.length>0&&Ge(e,637,Hme(i)),Ge(e,636),delete i.iauthor})}),Ge(e,634),Ge(e,629),e.end()}function W1e(n,e){e.FullPaths.forEach(function(t,r){if(r!=0){var i=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Yn.utils.cfb_add(n,i,e.FileIndex[r].content)}})}var zV=["xlsb","xlsm","xlam","biff8","xla"],H1e=(function(){var n=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function t(r,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,h=a.length>0?parseInt(a,10)|0:0;return o?h+=e.c:--h,l?u+=e.r:--u,i+(o?"":"$")+Xi(h)+(l?"":"$")+ki(u)}return function(i,s){return e=s,i.replace(n,t)}})(),aC=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,oC=(function(){return function(e,t){return e.replace(aC,function(r,i,s,a,o,l){var u=eC(a)-(s?0:t.c),h=JR(l)-(o?0:t.r),f=h==0?"":o?h+1:"["+h+"]",g=u==0?"":s?u+1:"["+u+"]";return i+"R"+f+"C"+g})}})();function K1e(n,e){return n.replace(aC,function(t,r,i,s,a,o){return r+(i=="$"?i+s:Xi(eC(s)+e.c))+(a=="$"?a+o:ki(JR(o)+e.r))})}function Y1e(n){return n.length!=1}function Ur(n){n.l+=1}function wu(n,e){var t=n.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function $V(n,e,t){var r=2;if(t){if(t.biff>=2&&t.biff<=5)return WV(n);t.biff==12&&(r=4)}var i=n.read_shift(r),s=n.read_shift(r),a=wu(n),o=wu(n);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function WV(n){var e=wu(n),t=wu(n),r=n.read_shift(1),i=n.read_shift(1);return{s:{r:e[0],c:r,cRel:e[1],rRel:e[2]},e:{r:t[0],c:i,cRel:t[1],rRel:t[2]}}}function q1e(n,e,t){if(t.biff<8)return WV(n);var r=n.read_shift(t.biff==12?4:2),i=n.read_shift(t.biff==12?4:2),s=wu(n),a=wu(n);return{s:{r,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function HV(n,e,t){if(t&&t.biff>=2&&t.biff<=5)return X1e(n);var r=n.read_shift(t&&t.biff==12?4:2),i=wu(n);return{r,c:i[0],cRel:i[1],rRel:i[2]}}function X1e(n){var e=wu(n),t=n.read_shift(1);return{r:e[0],c:t,cRel:e[1],rRel:e[2]}}function Z1e(n){var e=n.read_shift(2),t=n.read_shift(2);return{r:e,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function Q1e(n,e,t){var r=t&&t.biff?t.biff:8;if(r>=2&&r<=5)return J1e(n);var i=n.read_shift(r>=12?4:2),s=n.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function J1e(n){var e=n.read_shift(2),t=n.read_shift(1),r=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,r==1&&e>=8192&&(e=e-16384),i==1&&t>=128&&(t=t-256),{r:e,c:t,cRel:i,rRel:r}}function eye(n,e,t){var r=(n[n.l++]&96)>>5,i=$V(n,t.biff>=2&&t.biff<=5?6:8,t);return[r,i]}function tye(n,e,t){var r=(n[n.l++]&96)>>5,i=n.read_shift(2,"i"),s=8;if(t)switch(t.biff){case 5:n.l+=12,s=6;break;case 12:s=12;break}var a=$V(n,s,t);return[r,i,a]}function nye(n,e,t){var r=(n[n.l++]&96)>>5;return n.l+=t&&t.biff>8?12:t.biff<8?6:8,[r]}function rye(n,e,t){var r=(n[n.l++]&96)>>5,i=n.read_shift(2),s=8;if(t)switch(t.biff){case 5:n.l+=12,s=6;break;case 12:s=12;break}return n.l+=s,[r,i]}function iye(n,e,t){var r=(n[n.l++]&96)>>5,i=q1e(n,e-1,t);return[r,i]}function sye(n,e,t){var r=(n[n.l++]&96)>>5;return n.l+=t.biff==2?6:t.biff==12?14:7,[r]}function IO(n){var e=n[n.l+1]&1,t=1;return n.l+=4,[e,t]}function aye(n,e,t){n.l+=2;for(var r=n.read_shift(t&&t.biff==2?1:2),i=[],s=0;s<=r;++s)i.push(n.read_shift(t&&t.biff==2?1:2));return i}function oye(n,e,t){var r=n[n.l+1]&255?1:0;return n.l+=2,[r,n.read_shift(t&&t.biff==2?1:2)]}function lye(n,e,t){var r=n[n.l+1]&255?1:0;return n.l+=2,[r,n.read_shift(t&&t.biff==2?1:2)]}function cye(n){var e=n[n.l+1]&255?1:0;return n.l+=2,[e,n.read_shift(2)]}function uye(n,e,t){var r=n[n.l+1]&255?1:0;return n.l+=t&&t.biff==2?3:4,[r]}function KV(n){var e=n.read_shift(1),t=n.read_shift(1);return[e,t]}function hye(n){return n.read_shift(2),KV(n)}function dye(n){return n.read_shift(2),KV(n)}function fye(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=HV(n,0,t);return[r,i]}function gye(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=Q1e(n,0,t);return[r,i]}function mye(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=n.read_shift(2);t&&t.biff==5&&(n.l+=12);var s=HV(n,0,t);return[r,i,s]}function pye(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=n.read_shift(t&&t.biff<=3?1:2);return[p_e[i],XV[i],r]}function yye(n,e,t){var r=n[n.l++],i=n.read_shift(1),s=t&&t.biff<=3?[r==88?-1:0,n.read_shift(1)]:_ye(n);return[i,(s[0]===0?XV:m_e)[s[1]]]}function _ye(n){return[n[n.l+1]>>7,n.read_shift(2)&32767]}function xye(n,e,t){n.l+=t&&t.biff==2?3:4}function vye(n,e,t){if(n.l++,t&&t.biff==12)return[n.read_shift(4,"i"),0];var r=n.read_shift(2),i=n.read_shift(t&&t.biff==2?1:2);return[r,i]}function wye(n){return n.l++,N1[n.read_shift(1)]}function Eye(n){return n.l++,n.read_shift(2)}function Sye(n){return n.l++,n.read_shift(1)!==0}function Tye(n){return n.l++,q0(n)}function bye(n,e,t){return n.l++,CV(n,e-1,t)}function Iye(n,e){var t=[n.read_shift(1)];if(e==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=mpe(n,1)?"TRUE":"FALSE",e!=12&&(n.l+=7);break;case 37:case 16:t[1]=N1[n[n.l]],n.l+=e==12?4:8;break;case 0:n.l+=8;break;case 1:t[1]=q0(n);break;case 2:t[1]=xpe(n,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function Aye(n,e,t){for(var r=n.read_shift(t.biff==12?4:2),i=[],s=0;s!=r;++s)i.push((t.biff==12?Ed:Epe)(n));return i}function Rye(n,e,t){var r=0,i=0;t.biff==12?(r=n.read_shift(4),i=n.read_shift(4)):(i=1+n.read_shift(1),r=1+n.read_shift(2)),t.biff>=2&&t.biff<8&&(--r,--i==0&&(i=256));for(var s=0,a=[];s!=r&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=Iye(n,t.biff);return a}function Cye(n,e,t){var r=n.read_shift(1)>>>5&3,i=!t||t.biff>=8?4:2,s=n.read_shift(i);switch(t.biff){case 2:n.l+=5;break;case 3:case 4:n.l+=8;break;case 5:n.l+=12;break}return[r,0,s]}function Pye(n,e,t){if(t.biff==5)return kye(n);var r=n.read_shift(1)>>>5&3,i=n.read_shift(2),s=n.read_shift(4);return[r,i,s]}function kye(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2,"i");n.l+=8;var r=n.read_shift(2);return n.l+=12,[e,t,r]}function Mye(n,e,t){var r=n.read_shift(1)>>>5&3;n.l+=t&&t.biff==2?3:4;var i=n.read_shift(t&&t.biff==2?1:2);return[r,i]}function Nye(n,e,t){var r=n.read_shift(1)>>>5&3,i=n.read_shift(t&&t.biff==2?1:2);return[r,i]}function Lye(n,e,t){var r=n.read_shift(1)>>>5&3;return n.l+=4,t.biff<8&&n.l--,t.biff==12&&(n.l+=2),[r]}function Oye(n,e,t){var r=(n[n.l++]&96)>>5,i=n.read_shift(2),s=4;if(t)switch(t.biff){case 5:s=15;break;case 12:s=6;break}return n.l+=s,[r,i]}var Dye=Jo,Fye=Jo,jye=Jo;function L1(n,e,t){return n.l+=2,[Z1e(n)]}function lC(n){return n.l+=6,[]}var Vye=L1,Gye=lC,Bye=lC,Uye=L1;function YV(n){return n.l+=2,[AV(n),n.read_shift(2)&1]}var zye=L1,$ye=YV,Wye=lC,Hye=L1,Kye=L1,Yye=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function qye(n){n.l+=2;var e=n.read_shift(2),t=n.read_shift(2),r=n.read_shift(4),i=n.read_shift(2),s=n.read_shift(2),a=Yye[t>>2&31];return{ixti:e,coltype:t&3,rt:a,idx:r,c:i,C:s}}function Xye(n){return n.l+=2,[n.read_shift(4)]}function Zye(n,e,t){return n.l+=5,n.l+=2,n.l+=t.biff==2?1:4,["PTGSHEET"]}function Qye(n,e,t){return n.l+=t.biff==2?4:5,["PTGENDSHEET"]}function Jye(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2);return[e,t]}function e_e(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2);return[e,t]}function t_e(n){return n.l+=4,[0,0]}var AO={1:{n:"PtgExp",f:vye},2:{n:"PtgTbl",f:jye},3:{n:"PtgAdd",f:Ur},4:{n:"PtgSub",f:Ur},5:{n:"PtgMul",f:Ur},6:{n:"PtgDiv",f:Ur},7:{n:"PtgPower",f:Ur},8:{n:"PtgConcat",f:Ur},9:{n:"PtgLt",f:Ur},10:{n:"PtgLe",f:Ur},11:{n:"PtgEq",f:Ur},12:{n:"PtgGe",f:Ur},13:{n:"PtgGt",f:Ur},14:{n:"PtgNe",f:Ur},15:{n:"PtgIsect",f:Ur},16:{n:"PtgUnion",f:Ur},17:{n:"PtgRange",f:Ur},18:{n:"PtgUplus",f:Ur},19:{n:"PtgUminus",f:Ur},20:{n:"PtgPercent",f:Ur},21:{n:"PtgParen",f:Ur},22:{n:"PtgMissArg",f:Ur},23:{n:"PtgStr",f:bye},26:{n:"PtgSheet",f:Zye},27:{n:"PtgEndSheet",f:Qye},28:{n:"PtgErr",f:wye},29:{n:"PtgBool",f:Sye},30:{n:"PtgInt",f:Eye},31:{n:"PtgNum",f:Tye},32:{n:"PtgArray",f:sye},33:{n:"PtgFunc",f:pye},34:{n:"PtgFuncVar",f:yye},35:{n:"PtgName",f:Cye},36:{n:"PtgRef",f:fye},37:{n:"PtgArea",f:eye},38:{n:"PtgMemArea",f:Mye},39:{n:"PtgMemErr",f:Dye},40:{n:"PtgMemNoMem",f:Fye},41:{n:"PtgMemFunc",f:Nye},42:{n:"PtgRefErr",f:Lye},43:{n:"PtgAreaErr",f:nye},44:{n:"PtgRefN",f:gye},45:{n:"PtgAreaN",f:iye},46:{n:"PtgMemAreaN",f:Jye},47:{n:"PtgMemNoMemN",f:e_e},57:{n:"PtgNameX",f:Pye},58:{n:"PtgRef3d",f:mye},59:{n:"PtgArea3d",f:tye},60:{n:"PtgRefErr3d",f:Oye},61:{n:"PtgAreaErr3d",f:rye},255:{}},n_e={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},r_e={1:{n:"PtgElfLel",f:YV},2:{n:"PtgElfRw",f:Hye},3:{n:"PtgElfCol",f:Vye},6:{n:"PtgElfRwV",f:Kye},7:{n:"PtgElfColV",f:Uye},10:{n:"PtgElfRadical",f:zye},11:{n:"PtgElfRadicalS",f:Wye},13:{n:"PtgElfColS",f:Gye},15:{n:"PtgElfColSV",f:Bye},16:{n:"PtgElfRadicalLel",f:$ye},25:{n:"PtgList",f:qye},29:{n:"PtgSxName",f:Xye},255:{}},i_e={0:{n:"PtgAttrNoop",f:t_e},1:{n:"PtgAttrSemi",f:uye},2:{n:"PtgAttrIf",f:lye},4:{n:"PtgAttrChoose",f:aye},8:{n:"PtgAttrGoto",f:oye},16:{n:"PtgAttrSum",f:xye},32:{n:"PtgAttrBaxcel",f:IO},33:{n:"PtgAttrBaxcel",f:IO},64:{n:"PtgAttrSpace",f:hye},65:{n:"PtgAttrSpaceSemi",f:dye},128:{n:"PtgAttrIfError",f:cye},255:{}};function s_e(n,e,t,r){if(r.biff<8)return Jo(n,e);for(var i=n.l+e,s=[],a=0;a!==t.length;++a)switch(t[a][0]){case"PtgArray":t[a][1]=Rye(n,0,r),s.push(t[a][1]);break;case"PtgMemArea":t[a][2]=Aye(n,t[a][1],r),s.push(t[a][2]);break;case"PtgExp":r&&r.biff==12&&(t[a][1][1]=n.read_shift(4),s.push(t[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[a][0]}return e=i-n.l,e!==0&&s.push(Jo(n,e)),s}function a_e(n,e,t){for(var r=n.l+e,i,s,a=[];r!=n.l;)e=r-n.l,s=n[n.l],i=AO[s]||AO[n_e[s]],(s===24||s===25)&&(i=(s===24?r_e:i_e)[n[n.l+1]]),!i||!i.f?Jo(n,e):a.push([i.n,i.f(n,e,t)]);return a}function o_e(n){for(var e=[],t=0;t<n.length;++t){for(var r=n[t],i=[],s=0;s<r.length;++s){var a=r[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var l_e={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function c_e(n,e){if(!n&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(n)?"'"+n+"'":n}function qV(n,e,t){if(!n)return"SH33TJSERR0";if(t.biff>8&&(!n.XTI||!n.XTI[e]))return n.SheetNames[e];if(!n.XTI)return"SH33TJSERR6";var r=n.XTI[e];if(t.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":n.XTI[e-1];if(!r)return"SH33TJSERR1";var i="";if(t.biff>8)switch(n[r[0]][0]){case 357:return i=r[1]==-1?"#REF":n.SheetNames[r[1]],r[1]==r[2]?i:i+":"+n.SheetNames[r[2]];case 358:return t.SID!=null?n.SheetNames[t.SID]:"SH33TJSSAME"+n[r[0]][0];case 355:default:return"SH33TJSSRC"+n[r[0]][0]}switch(n[r[0]][0][0]){case 1025:return i=r[1]==-1?"#REF":n.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?i:i+":"+n.SheetNames[r[2]];case 14849:return n[r[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return n[r[0]][0][3]?(i=r[1]==-1?"#REF":n[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?i:i+":"+n[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function RO(n,e,t){var r=qV(n,e,t);return r=="#REF"?r:c_e(r,t)}function M0(n,e,t,r,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},o=[],l,u,h,f=0,g=0,y,v="";if(!n[0]||!n[0][0])return"";for(var x=-1,E="",T=0,b=n[0].length;T<b;++T){var I=n[0][T];switch(I[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),u=o.pop(),x>=0){switch(n[0][x][1][0]){case 0:E=Ar(" ",n[0][x][1][1]);break;case 1:E=Ar("\r",n[0][x][1][1]);break;default:if(E="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][x][1][0])}u=u+E,x=-1}o.push(u+l_e[I[0]]+l);break;case"PtgIsect":l=o.pop(),u=o.pop(),o.push(u+" "+l);break;case"PtgUnion":l=o.pop(),u=o.pop(),o.push(u+","+l);break;case"PtgRange":l=o.pop(),u=o.pop(),o.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=Gm(I[1][1],a,i),o.push(Bm(h,s));break;case"PtgRefN":h=t?Gm(I[1][1],t,i):I[1][1],o.push(Bm(h,s));break;case"PtgRef3d":f=I[1][1],h=Gm(I[1][2],a,i),v=RO(r,f,i),o.push(v+"!"+Bm(h,s));break;case"PtgFunc":case"PtgFuncVar":var M=I[1][0],F=I[1][1];M||(M=0),M&=127;var z=M==0?[]:o.slice(-M);o.length-=M,F==="User"&&(F=z.shift()),o.push(F+"("+z.join(",")+")");break;case"PtgBool":o.push(I[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(I[1]);break;case"PtgNum":o.push(String(I[1]));break;case"PtgStr":o.push('"'+I[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(I[1]);break;case"PtgAreaN":y=dO(I[1][1],t?{s:t}:a,i),o.push(GS(y,i));break;case"PtgArea":y=dO(I[1][1],a,i),o.push(GS(y,i));break;case"PtgArea3d":f=I[1][1],y=I[1][2],v=RO(r,f,i),o.push(v+"!"+GS(y,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":g=I[1][2];var k=(r.names||[])[g-1]||(r[0]||[])[g],C=k?k.Name:"SH33TJSNAME"+String(g);C&&C.slice(0,6)=="_xlfn."&&!i.xlfn&&(C=C.slice(6)),o.push(C);break;case"PtgNameX":var P=I[1][1];g=I[1][2];var L;if(i.biff<=5)P<0&&(P=-P),r[P]&&(L=r[P][g]);else{var O="";if(((r[P]||[])[0]||[])[0]==14849||(((r[P]||[])[0]||[])[0]==1025?r[P][g]&&r[P][g].itab>0&&(O=r.SheetNames[r[P][g].itab-1]+"!"):O=r.SheetNames[g-1]+"!"),r[P]&&r[P][g])O+=r[P][g].Name;else if(r[0]&&r[0][g])O+=r[0][g].Name;else{var U=(qV(r,P,i)||"").split(";;");U[g-1]?O=U[g-1]:O+="SH33TJSERRX"}o.push(O);break}L||(L={Name:"SH33TJSERRY"}),o.push(L.Name);break;case"PtgParen":var j="(",Ie=")";if(x>=0){switch(E="",n[0][x][1][0]){case 2:j=Ar(" ",n[0][x][1][1])+j;break;case 3:j=Ar("\r",n[0][x][1][1])+j;break;case 4:Ie=Ar(" ",n[0][x][1][1])+Ie;break;case 5:Ie=Ar("\r",n[0][x][1][1])+Ie;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][x][1][0])}x=-1}o.push(j+o.pop()+Ie);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":h={c:I[1][1],r:I[1][0]};var ke={c:t.c,r:t.r};if(r.sharedf[Kn(h)]){var ze=r.sharedf[Kn(h)];o.push(M0(ze,a,ke,r,i))}else{var Ne=!1;for(l=0;l!=r.arrayf.length;++l)if(u=r.arrayf[l],!(h.c<u[0].s.c||h.c>u[0].e.c)&&!(h.r<u[0].s.r||h.r>u[0].e.r)){o.push(M0(u[1],a,ke,r,i)),Ne=!0;break}Ne||o.push(I[1])}break;case"PtgArray":o.push("{"+o_e(I[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=T;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+I[1].idx+"[#"+I[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(I));default:throw new Error("Unrecognized Formula Token: "+String(I))}var ce=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&x>=0&&ce.indexOf(n[0][T][0])==-1){I=n[0][x];var Te=!0;switch(I[1][0]){case 4:Te=!1;case 0:E=Ar(" ",I[1][1]);break;case 5:Te=!1;case 1:E=Ar("\r",I[1][1]);break;default:if(E="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+I[1][0])}o.push((Te?E:"")+o.pop()+(Te?"":E)),x=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function u_e(n){if(n==null){var e=Re(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof n=="number")return nd(n);return nd(0)}function h_e(n,e,t,r,i){var s=rd(e,t,i),a=u_e(n.v),o=Re(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var u=Re(n.bf.length),h=0;h<n.bf.length;++h)u[h]=n.bf[h];var f=Ai([s,a,o,u]);return f}function Kw(n,e,t){var r=n.read_shift(4),i=a_e(n,r,t),s=n.read_shift(4),a=s>0?s_e(n,s,i,t):null;return[i,a]}var d_e=Kw,Yw=Kw,f_e=Kw,g_e=Kw,m_e={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},XV={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},p_e={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function y_e(n){var e="of:="+n.replace(aC,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function __e(n){return n.replace(/\./,"!")}var Um=typeof Map<"u";function cC(n,e,t){var r=0,i=n.length;if(t){if(Um?t.has(e):Object.prototype.hasOwnProperty.call(t,e)){for(var s=Um?t.get(e):t[e];r<s.length;++r)if(n[s[r]].t===e)return n.Count++,s[r]}}else for(;r<i;++r)if(n[r].t===e)return n.Count++,r;return n[i]={t:e},n.Count++,n.Unique++,t&&(Um?(t.has(e)||t.set(e,[]),t.get(e).push(i)):(Object.prototype.hasOwnProperty.call(t,e)||(t[e]=[]),t[e].push(i))),i}function qw(n,e){var t={min:n+1,max:n+1},r=-1;return e.MDW&&(jl=e.MDW),e.width!=null?t.customWidth=1:e.wpx!=null?r=Sv(e.wpx):e.wch!=null&&(r=e.wch),r>-1?(t.width=zb(r),t.customWidth=1):e.width!=null&&(t.width=e.width),e.hidden&&(t.hidden=!0),e.level!=null&&(t.outlineLevel=t.level=e.level),t}function ZV(n,e){if(n){var t=[.7,.7,.75,.75,.3,.3];n.left==null&&(n.left=t[0]),n.right==null&&(n.right=t[1]),n.top==null&&(n.top=t[2]),n.bottom==null&&(n.bottom=t[3]),n.header==null&&(n.header=t[4]),n.footer==null&&(n.footer=t[5])}}function Pu(n,e,t){var r=t.revssf[e.z!=null?e.z:"General"],i=60,s=n.length;if(r==null&&t.ssf){for(;i<392;++i)if(t.ssf[i]==null){H7(e.z,i),t.ssf[i]=e.z,t.revssf[e.z]=r=i;break}}for(i=0;i!=s;++i)if(n[i].numFmtId===r)return i;return n[s]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function x_e(n,e,t){if(n&&n["!ref"]){var r=cr(n["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+t+"): "+n["!ref"])}}function v_e(n){if(n.length===0)return"";for(var e='<mergeCells count="'+n.length+'">',t=0;t!=n.length;++t)e+='<mergeCell ref="'+Kr(n[t])+'"/>';return e+"</mergeCells>"}function w_e(n,e,t,r,i){var s=!1,a={},o=null;if(r.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[t];try{e.Workbook&&(l=e.Workbook.Sheets[t].CodeName||l)}catch{}s=!0,a.codeName=Np(Wn(l))}if(n&&n["!outline"]){var u={summaryBelow:1,summaryRight:1};n["!outline"].above&&(u.summaryBelow=0),n["!outline"].left&&(u.summaryRight=0),o=(o||"")+nt("outlinePr",null,u)}!s&&!o||(i[i.length]=nt("sheetPr",o,a))}var E_e=["objects","scenarios","selectLockedCells","selectUnlockedCells"],S_e=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function T_e(n){var e={sheet:1};return E_e.forEach(function(t){n[t]!=null&&n[t]&&(e[t]="1")}),S_e.forEach(function(t){n[t]!=null&&!n[t]&&(e[t]="0")}),n.password&&(e.password=LV(n.password).toString(16).toUpperCase()),nt("sheetProtection",null,e)}function b_e(n){return ZV(n),nt("pageMargins",null,n)}function I_e(n,e){for(var t=["<cols>"],r,i=0;i!=e.length;++i)(r=e[i])&&(t[t.length]=nt("col",null,qw(i,r)));return t[t.length]="</cols>",t.join("")}function A_e(n,e,t,r){var i=typeof n.ref=="string"?n.ref:Kr(n.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var s=t.Workbook.Names,a=ra(i);a.s.r==a.e.r&&(a.e.r=ra(e["!ref"]).e.r,i=Kr(a));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==r){l.Ref="'"+t.SheetNames[r]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+t.SheetNames[r]+"'!"+i}),nt("autoFilter",null,{ref:i})}function R_e(n,e,t,r){var i={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),nt("sheetViews",nt("sheetView",null,i),{})}function C_e(n,e,t,r){if(n.c&&t["!comments"].push([e,n.c]),n.v===void 0&&typeof n.f!="string"||n.t==="z"&&!n.f)return"";var i="",s=n.t,a=n.v;if(n.t!=="z")switch(n.t){case"b":i=n.v?"1":"0";break;case"n":i=""+n.v;break;case"e":i=N1[n.v];break;case"d":r&&r.cellDates?i=us(n.v,-1).toISOString():(n=ks(n),n.t="n",i=""+(n.v=Ps(us(n.v)))),typeof n.z>"u"&&(n.z=Cr[14]);break;default:i=n.v;break}var o=Ri("v",Wn(i)),l={r:e},u=Pu(r.cellXfs,n,r);switch(u!==0&&(l.s=u),n.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(n.v==null){delete n.t;break}if(n.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){o=Ri("v",""+cC(r.Strings,n.v,r.revStrings)),l.t="s";break}l.t="str";break}if(n.t!=s&&(n.t=s,n.v=a),typeof n.f=="string"&&n.f){var h=n.F&&n.F.slice(0,e.length)==e?{t:"array",ref:n.F}:null;o=nt("f",Wn(n.f),h)+(n.v!=null?o:"")}return n.l&&t["!links"].push([e,n.l]),n.D&&(l.cm=1),nt("c",o,l)}function P_e(n,e,t,r){var i=[],s=[],a=cr(n["!ref"]),o="",l,u="",h=[],f=0,g=0,y=n["!rows"],v=Array.isArray(n),x={r:u},E,T=-1;for(g=a.s.c;g<=a.e.c;++g)h[g]=Xi(g);for(f=a.s.r;f<=a.e.r;++f){for(s=[],u=ki(f),g=a.s.c;g<=a.e.c;++g){l=h[g]+u;var b=v?(n[f]||[])[g]:n[l];b!==void 0&&(o=C_e(b,l,n,e))!=null&&s.push(o)}(s.length>0||y&&y[f])&&(x={r:u},y&&y[f]&&(E=y[f],E.hidden&&(x.hidden=1),T=-1,E.hpx?T=Tv(E.hpx):E.hpt&&(T=E.hpt),T>-1&&(x.ht=T,x.customHeight=1),E.level&&(x.outlineLevel=E.level)),i[i.length]=nt("row",s.join(""),x))}if(y)for(;f<y.length;++f)y&&y[f]&&(x={r:f+1},E=y[f],E.hidden&&(x.hidden=1),T=-1,E.hpx?T=Tv(E.hpx):E.hpt&&(T=E.hpt),T>-1&&(x.ht=T,x.customHeight=1),E.level&&(x.outlineLevel=E.level),i[i.length]=nt("row","",x));return i.join("")}function QV(n,e,t,r){var i=[qr,nt("worksheet",null,{xmlns:H0[0],"xmlns:r":fi.r})],s=t.SheetNames[n],a=0,o="",l=t.Sheets[s];l==null&&(l={});var u=l["!ref"]||"A1",h=cr(u);if(h.e.c>16383||h.e.r>1048575){if(e.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575),u=Kr(h)}r||(r={}),l["!comments"]=[];var f=[];w_e(l,t,n,e,i),i[i.length]=nt("dimension",null,{ref:u}),i[i.length]=R_e(l,e,n,t),e.sheetFormat&&(i[i.length]=nt("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=I_e(l,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=P_e(l,e),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=T_e(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=A_e(l["!autofilter"],l,t,n)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=v_e(l["!merges"]));var g=-1,y,v=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(x){x[1].Target&&(y={ref:x[0]},x[1].Target.charAt(0)!="#"&&(v=Un(r,-1,Wn(x[1].Target).replace(/#.*$/,""),Sn.HLINK),y["r:id"]="rId"+v),(g=x[1].Target.indexOf("#"))>-1&&(y.location=Wn(x[1].Target.slice(g+1))),x[1].Tooltip&&(y.tooltip=Wn(x[1].Tooltip)),i[i.length]=nt("hyperlink",null,y))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=b_e(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=Ri("ignoredErrors",nt("ignoredError",null,{numberStoredAsText:1,sqref:u}))),f.length>0&&(v=Un(r,-1,"../drawings/drawing"+(n+1)+".xml",Sn.DRAW),i[i.length]=nt("drawing",null,{"r:id":"rId"+v}),l["!drawing"]=f),l["!comments"].length>0&&(v=Un(r,-1,"../drawings/vmlDrawing"+(n+1)+".vml",Sn.VML),i[i.length]=nt("legacyDrawing",null,{"r:id":"rId"+v}),l["!legacy"]=v),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function k_e(n,e){var t={},r=n.l+e;t.r=n.read_shift(4),n.l+=4;var i=n.read_shift(2);n.l+=1;var s=n.read_shift(1);return n.l=r,s&7&&(t.level=s&7),s&16&&(t.hidden=!0),s&32&&(t.hpt=i/20),t}function M_e(n,e,t){var r=Re(145),i=(t["!rows"]||[])[n]||{};r.write_shift(4,n),r.write_shift(4,0);var s=320;i.hpx?s=Tv(i.hpx)*20:i.hpt&&(s=i.hpt*20),r.write_shift(2,s),r.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),r.write_shift(1,a),r.write_shift(1,0);var o=0,l=r.l;r.l+=4;for(var u={r:n,c:0},h=0;h<16;++h)if(!(e.s.c>h+1<<10||e.e.c<h<<10)){for(var f=-1,g=-1,y=h<<10;y<h+1<<10;++y){u.c=y;var v=Array.isArray(t)?(t[u.r]||[])[u.c]:t[Kn(u)];v&&(f<0&&(f=y),g=y)}f<0||(++o,r.write_shift(4,f),r.write_shift(4,g))}var x=r.l;return r.l=l,r.write_shift(4,o),r.l=x,r.length>r.l?r.slice(0,r.l):r}function N_e(n,e,t,r){var i=M_e(r,t,e);(i.length>17||(e["!rows"]||[])[r])&&Ge(n,0,i)}var L_e=Ed,O_e=Y0;function D_e(){}function F_e(n,e){var t={},r=n[n.l];return++n.l,t.above=!(r&64),t.left=!(r&128),n.l+=18,t.name=Kme(n),t}function j_e(n,e,t){t==null&&(t=Re(84+4*n.length));var r=192;e&&(e.above&&(r&=-65),e.left&&(r&=-129)),t.write_shift(1,r);for(var i=1;i<3;++i)t.write_shift(1,0);return vv({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),fV(n,t),t.slice(0,t.l)}function V_e(n){var e=Ca(n);return[e]}function G_e(n,e,t){return t==null&&(t=Re(8)),xd(e,t)}function B_e(n){var e=vd(n);return[e]}function U_e(n,e,t){return t==null&&(t=Re(4)),wd(e,t)}function z_e(n){var e=Ca(n),t=n.read_shift(1);return[e,t,"b"]}function $_e(n,e,t){return t==null&&(t=Re(9)),xd(e,t),t.write_shift(1,n.v?1:0),t}function W_e(n){var e=vd(n),t=n.read_shift(1);return[e,t,"b"]}function H_e(n,e,t){return t==null&&(t=Re(5)),wd(e,t),t.write_shift(1,n.v?1:0),t}function K_e(n){var e=Ca(n),t=n.read_shift(1);return[e,t,"e"]}function Y_e(n,e,t){return t==null&&(t=Re(9)),xd(e,t),t.write_shift(1,n.v),t}function q_e(n){var e=vd(n),t=n.read_shift(1);return[e,t,"e"]}function X_e(n,e,t){return t==null&&(t=Re(8)),wd(e,t),t.write_shift(1,n.v),t.write_shift(2,0),t.write_shift(1,0),t}function Z_e(n){var e=Ca(n),t=n.read_shift(4);return[e,t,"s"]}function Q_e(n,e,t){return t==null&&(t=Re(12)),xd(e,t),t.write_shift(4,e.v),t}function J_e(n){var e=vd(n),t=n.read_shift(4);return[e,t,"s"]}function exe(n,e,t){return t==null&&(t=Re(8)),wd(e,t),t.write_shift(4,e.v),t}function txe(n){var e=Ca(n),t=q0(n);return[e,t,"n"]}function nxe(n,e,t){return t==null&&(t=Re(16)),xd(e,t),nd(n.v,t),t}function rxe(n){var e=vd(n),t=q0(n);return[e,t,"n"]}function ixe(n,e,t){return t==null&&(t=Re(12)),wd(e,t),nd(n.v,t),t}function sxe(n){var e=Ca(n),t=gV(n);return[e,t,"n"]}function axe(n,e,t){return t==null&&(t=Re(12)),xd(e,t),mV(n.v,t),t}function oxe(n){var e=vd(n),t=gV(n);return[e,t,"n"]}function lxe(n,e,t){return t==null&&(t=Re(8)),wd(e,t),mV(n.v,t),t}function cxe(n){var e=Ca(n),t=tC(n);return[e,t,"is"]}function uxe(n){var e=Ca(n),t=Zi(n);return[e,t,"str"]}function hxe(n,e,t){return t==null&&(t=Re(12+4*n.v.length)),xd(e,t),mi(n.v,t),t.length>t.l?t.slice(0,t.l):t}function dxe(n){var e=vd(n),t=Zi(n);return[e,t,"str"]}function fxe(n,e,t){return t==null&&(t=Re(8+4*n.v.length)),wd(e,t),mi(n.v,t),t.length>t.l?t.slice(0,t.l):t}function gxe(n,e,t){var r=n.l+e,i=Ca(n);i.r=t["!row"];var s=n.read_shift(1),a=[i,s,"b"];if(t.cellFormula){n.l+=2;var o=Yw(n,r-n.l,t);a[3]=M0(o,null,i,t.supbooks,t)}else n.l=r;return a}function mxe(n,e,t){var r=n.l+e,i=Ca(n);i.r=t["!row"];var s=n.read_shift(1),a=[i,s,"e"];if(t.cellFormula){n.l+=2;var o=Yw(n,r-n.l,t);a[3]=M0(o,null,i,t.supbooks,t)}else n.l=r;return a}function pxe(n,e,t){var r=n.l+e,i=Ca(n);i.r=t["!row"];var s=q0(n),a=[i,s,"n"];if(t.cellFormula){n.l+=2;var o=Yw(n,r-n.l,t);a[3]=M0(o,null,i,t.supbooks,t)}else n.l=r;return a}function yxe(n,e,t){var r=n.l+e,i=Ca(n);i.r=t["!row"];var s=Zi(n),a=[i,s,"str"];if(t.cellFormula){n.l+=2;var o=Yw(n,r-n.l,t);a[3]=M0(o,null,i,t.supbooks,t)}else n.l=r;return a}var _xe=Ed,xxe=Y0;function vxe(n,e){return e==null&&(e=Re(4)),e.write_shift(4,n),e}function wxe(n,e){var t=n.l+e,r=Ed(n),i=nC(n),s=Zi(n),a=Zi(n),o=Zi(n);n.l=t;var l={rfx:r,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function Exe(n,e){var t=Re(50+4*(n[1].Target.length+(n[1].Tooltip||"").length));Y0({s:gi(n[0]),e:gi(n[0])},t),rC("rId"+e,t);var r=n[1].Target.indexOf("#"),i=r==-1?"":n[1].Target.slice(r+1);return mi(i||"",t),mi(n[1].Tooltip||"",t),mi("",t),t.slice(0,t.l)}function Sxe(){}function Txe(n,e,t){var r=n.l+e,i=pV(n),s=n.read_shift(1),a=[i];if(a[2]=s,t.cellFormula){var o=d_e(n,r-n.l,t);a[1]=o}else n.l=r;return a}function bxe(n,e,t){var r=n.l+e,i=Ed(n),s=[i];if(t.cellFormula){var a=g_e(n,r-n.l,t);s[1]=a,n.l=r}else n.l=r;return s}function Ixe(n,e,t){t==null&&(t=Re(18));var r=qw(n,e);t.write_shift(-4,n),t.write_shift(-4,n),t.write_shift(4,(r.width||10)*256),t.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof r.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),t.write_shift(2,i),t}var JV=["left","right","top","bottom","header","footer"];function Axe(n){var e={};return JV.forEach(function(t){e[t]=q0(n)}),e}function Rxe(n,e){return e==null&&(e=Re(48)),ZV(n),JV.forEach(function(t){nd(n[t],e)}),e}function Cxe(n){var e=n.read_shift(2);return n.l+=28,{RTL:e&32}}function Pxe(n,e,t){t==null&&(t=Re(30));var r=924;return(((e||{}).Views||[])[0]||{}).RTL&&(r|=32),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function kxe(n){var e=Re(24);return e.write_shift(4,4),e.write_shift(4,1),Y0(n,e),e}function Mxe(n,e){return e==null&&(e=Re(66)),e.write_shift(2,n.password?LV(n.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?e.write_shift(4,n[t[0]]!=null&&!n[t[0]]?1:0):e.write_shift(4,n[t[0]]!=null&&n[t[0]]?0:1)}),e}function Nxe(){}function Lxe(){}function Oxe(n,e,t,r,i,s,a){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=ks(e),e.z=e.z||Cr[14],e.v=Ps(us(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var l={r:t,c:r};switch(l.s=Pu(i.cellXfs,e,i),e.l&&s["!links"].push([Kn(l),e.l]),e.c&&s["!comments"].push([Kn(l),e.c]),e.t){case"s":case"str":return i.bookSST?(o=cC(i.Strings,e.v,i.revStrings),l.t="s",l.v=o,a?Ge(n,18,exe(e,l)):Ge(n,7,Q_e(e,l))):(l.t="str",a?Ge(n,17,fxe(e,l)):Ge(n,6,hxe(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?Ge(n,13,lxe(e,l)):Ge(n,2,axe(e,l)):a?Ge(n,16,ixe(e,l)):Ge(n,5,nxe(e,l)),!0;case"b":return l.t="b",a?Ge(n,15,H_e(e,l)):Ge(n,4,$_e(e,l)),!0;case"e":return l.t="e",a?Ge(n,14,X_e(e,l)):Ge(n,3,Y_e(e,l)),!0}return a?Ge(n,12,U_e(e,l)):Ge(n,1,G_e(e,l)),!0}function Dxe(n,e,t,r){var i=cr(e["!ref"]||"A1"),s,a="",o=[];Ge(n,145);var l=Array.isArray(e),u=i.e.r;e["!rows"]&&(u=Math.max(i.e.r,e["!rows"].length-1));for(var h=i.s.r;h<=u;++h){a=ki(h),N_e(n,e,i,h);var f=!1;if(h<=i.e.r)for(var g=i.s.c;g<=i.e.c;++g){h===i.s.r&&(o[g]=Xi(g)),s=o[g]+a;var y=l?(e[h]||[])[g]:e[s];if(!y){f=!1;continue}f=Oxe(n,y,h,g,r,e,f)}}Ge(n,146)}function Fxe(n,e){!e||!e["!merges"]||(Ge(n,177,vxe(e["!merges"].length)),e["!merges"].forEach(function(t){Ge(n,176,xxe(t))}),Ge(n,178))}function jxe(n,e){!e||!e["!cols"]||(Ge(n,390),e["!cols"].forEach(function(t,r){t&&Ge(n,60,Ixe(r,t))}),Ge(n,391))}function Vxe(n,e){!e||!e["!ref"]||(Ge(n,648),Ge(n,649,kxe(cr(e["!ref"]))),Ge(n,650))}function Gxe(n,e,t){e["!links"].forEach(function(r){if(r[1].Target){var i=Un(t,-1,r[1].Target.replace(/#.*$/,""),Sn.HLINK);Ge(n,494,Exe(r,i))}}),delete e["!links"]}function Bxe(n,e,t,r){if(e["!comments"].length>0){var i=Un(r,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Sn.VML);Ge(n,551,rC("rId"+i)),e["!legacy"]=i}}function Uxe(n,e,t,r){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:Kr(i.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var a=t.Workbook.Names,o=ra(s);o.s.r==o.e.r&&(o.e.r=ra(e["!ref"]).e.r,s=Kr(o));for(var l=0;l<a.length;++l){var u=a[l];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==r){u.Ref="'"+t.SheetNames[r]+"'!"+s;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+t.SheetNames[r]+"'!"+s}),Ge(n,161,Y0(cr(s))),Ge(n,162)}}function zxe(n,e,t){Ge(n,133),Ge(n,137,Pxe(e,t)),Ge(n,138),Ge(n,134)}function $xe(n,e){e["!protect"]&&Ge(n,535,Mxe(e["!protect"]))}function Wxe(n,e,t,r){var i=Rs(),s=t.SheetNames[n],a=t.Sheets[s]||{},o=s;try{t&&t.Workbook&&(o=t.Workbook.Sheets[n].CodeName||o)}catch{}var l=cr(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],Ge(i,129),(t.vbaraw||a["!outline"])&&Ge(i,147,j_e(o,a["!outline"])),Ge(i,148,O_e(l)),zxe(i,a,t.Workbook),jxe(i,a),Dxe(i,a,n,e),$xe(i,a),Uxe(i,a,t,n),Fxe(i,a),Gxe(i,a,r),a["!margins"]&&Ge(i,476,Rxe(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&Vxe(i,a),Bxe(i,a,n,r),Ge(i,130),i.end()}function Hxe(n,e){n.l+=10;var t=Zi(n);return{name:t}}var Kxe=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function Yxe(n){return!n.Workbook||!n.Workbook.WBProps?"false":bme(n.Workbook.WBProps.date1904)?"true":"false"}var qxe="][*?/\\".split("");function eG(n,e){if(n.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return qxe.forEach(function(r){if(n.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function Xxe(n,e,t){n.forEach(function(r,i){eG(r);for(var s=0;s<i;++s)if(r==n[s])throw new Error("Duplicate Sheet Name: "+r);if(t){var a=e&&e[i]&&e[i].CodeName||r;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function Zxe(n){if(!n||!n.SheetNames||!n.Sheets)throw new Error("Invalid Workbook");if(!n.SheetNames.length)throw new Error("Workbook is empty");var e=n.Workbook&&n.Workbook.Sheets||[];Xxe(n.SheetNames,e,!!n.vbaraw);for(var t=0;t<n.SheetNames.length;++t)x_e(n.Sheets[n.SheetNames[t]],n.SheetNames[t],t)}function tG(n){var e=[qr];e[e.length]=nt("workbook",null,{xmlns:H0[0],"xmlns:r":fi.r});var t=n.Workbook&&(n.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};n.Workbook&&n.Workbook.WBProps&&(Kxe.forEach(function(o){n.Workbook.WBProps[o[0]]!=null&&n.Workbook.WBProps[o[0]]!=o[1]&&(r[o[0]]=n.Workbook.WBProps[o[0]])}),n.Workbook.WBProps.CodeName&&(r.codeName=n.Workbook.WBProps.CodeName,delete r.CodeName)),e[e.length]=nt("workbookPr",null,r);var i=n.Workbook&&n.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=n.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==n.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=n.SheetNames.length;++s){var a={name:Wn(n.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=nt("sheet",null,a)}return e[e.length]="</sheets>",t&&(e[e.length]="<definedNames>",n.Workbook&&n.Workbook.Names&&n.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(e[e.length]=nt("definedName",Wn(o.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function Qxe(n,e){var t={};return t.Hidden=n.read_shift(4),t.iTabID=n.read_shift(4),t.strRelID=Ub(n),t.name=Zi(n),t}function Jxe(n,e){return e||(e=Re(127)),e.write_shift(4,n.Hidden),e.write_shift(4,n.iTabID),rC(n.strRelID,e),mi(n.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function eve(n,e){var t={},r=n.read_shift(4);t.defaultThemeVersion=n.read_shift(4);var i=e>8?Zi(n):"";return i.length>0&&(t.CodeName=i),t.autoCompressPictures=!!(r&65536),t.backupFile=!!(r&64),t.checkCompatibility=!!(r&4096),t.date1904=!!(r&1),t.filterPrivacy=!!(r&8),t.hidePivotFieldList=!!(r&1024),t.promptedSolutions=!!(r&16),t.publishItems=!!(r&2048),t.refreshAllConnections=!!(r&262144),t.saveExternalLinkValues=!!(r&128),t.showBorderUnselectedTables=!!(r&4),t.showInkAnnotation=!!(r&32),t.showObjects=["all","placeholders","none"][r>>13&3],t.showPivotChartFilter=!!(r&32768),t.updateLinks=["userSet","never","always"][r>>8&3],t}function tve(n,e){e||(e=Re(72));var t=0;return n&&n.filterPrivacy&&(t|=8),e.write_shift(4,t),e.write_shift(4,0),fV(n&&n.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function nve(n,e,t){var r=n.l+e;n.l+=4,n.l+=1;var i=n.read_shift(4),s=Yme(n),a=f_e(n,0,t),o=nC(n);n.l=r;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function rve(n,e){Ge(n,143);for(var t=0;t!=e.SheetNames.length;++t){var r=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[t]&&e.Workbook.Sheets[t].Hidden||0,i={Hidden:r,iTabID:t+1,strRelID:"rId"+(t+1),name:e.SheetNames[t]};Ge(n,156,Jxe(i))}Ge(n,144)}function ive(n,e){e||(e=Re(127));for(var t=0;t!=4;++t)e.write_shift(4,0);return mi("SheetJS",e),mi(dv.version,e),mi(dv.version,e),mi("7262",e),e.length>e.l?e.slice(0,e.l):e}function sve(n,e){e||(e=Re(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,n),e.write_shift(4,n);var t=120;return e.write_shift(1,t),e.length>e.l?e.slice(0,e.l):e}function ave(n,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var t=e.Workbook.Sheets,r=0,i=-1,s=-1;r<t.length;++r)!t[r]||!t[r].Hidden&&i==-1?i=r:t[r].Hidden==1&&s==-1&&(s=r);s>i||(Ge(n,135),Ge(n,158,sve(i)),Ge(n,136))}}function ove(n,e){var t=Rs();return Ge(t,131),Ge(t,128,ive()),Ge(t,153,tve(n.Workbook&&n.Workbook.WBProps||null)),ave(t,n),rve(t,n),Ge(t,132),t.end()}function lve(n,e,t){return(e.slice(-4)===".bin"?ove:tG)(n)}function cve(n,e,t,r,i){return(e.slice(-4)===".bin"?Wxe:QV)(n,t,r,i)}function uve(n,e,t){return(e.slice(-4)===".bin"?R1e:FV)(n,t)}function hve(n,e,t){return(e.slice(-4)===".bin"?t1e:NV)(n,t)}function dve(n,e,t){return(e.slice(-4)===".bin"?$1e:UV)(n)}function fve(n){return(n.slice(-4)===".bin"?D1e:GV)()}function gve(n,e){var t=[];return n.Props&&t.push(upe(n.Props,e)),n.Custprops&&t.push(hpe(n.Props,n.Custprops)),t.join("")}function mve(){return""}function pve(n,e){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(r,i){var s=[];s.push(nt("NumberFormat",null,{"ss:Format":Wn(Cr[r.numFmtId])}));var a={"ss:ID":"s"+(21+i)};t.push(nt("Style",s.join(""),a))}),nt("Styles",t.join(""))}function nG(n){return nt("NamedRange",null,{"ss:Name":n.Name,"ss:RefersTo":"="+oC(n.Ref,{r:0,c:0})})}function yve(n){if(!((n||{}).Workbook||{}).Names)return"";for(var e=n.Workbook.Names,t=[],r=0;r<e.length;++r){var i=e[r];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||t.push(nG(i)))}return nt("Names",t.join(""))}function _ve(n,e,t,r){if(!n||!((r||{}).Workbook||{}).Names)return"";for(var i=r.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==t&&(o.Name.match(/^_xlfn\./)||s.push(nG(o)))}return s.join("")}function xve(n,e,t,r){if(!n)return"";var i=[];if(n["!margins"]&&(i.push("<PageSetup>"),n["!margins"].header&&i.push(nt("Header",null,{"x:Margin":n["!margins"].header})),n["!margins"].footer&&i.push(nt("Footer",null,{"x:Margin":n["!margins"].footer})),i.push(nt("PageMargins",null,{"x:Bottom":n["!margins"].bottom||"0.75","x:Left":n["!margins"].left||"0.7","x:Right":n["!margins"].right||"0.7","x:Top":n["!margins"].top||"0.75"})),i.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[t])if(r.Workbook.Sheets[t].Hidden)i.push(nt("Visible",r.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<t&&!(r.Workbook.Sheets[s]&&!r.Workbook.Sheets[s].Hidden);++s);s==t&&i.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),n["!protect"]&&(i.push(Ri("ProtectContents","True")),n["!protect"].objects&&i.push(Ri("ProtectObjects","True")),n["!protect"].scenarios&&i.push(Ri("ProtectScenarios","True")),n["!protect"].selectLockedCells!=null&&!n["!protect"].selectLockedCells?i.push(Ri("EnableSelection","NoSelection")):n["!protect"].selectUnlockedCells!=null&&!n["!protect"].selectUnlockedCells&&i.push(Ri("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){n["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":nt("WorksheetOptions",i.join(""),{xmlns:Hs.x})}function vve(n){return n.map(function(e){var t=Tme(e.t||""),r=nt("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return nt("Comment",r,{"ss:Author":e.a})}).join("")}function wve(n,e,t,r,i,s,a){if(!n||n.v==null&&n.f==null)return"";var o={};if(n.f&&(o["ss:Formula"]="="+Wn(oC(n.f,a))),n.F&&n.F.slice(0,e.length)==e){var l=gi(n.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(n.l&&n.l.Target&&(o["ss:HRef"]=Wn(n.l.Target),n.l.Tooltip&&(o["x:HRefScreenTip"]=Wn(n.l.Tooltip))),t["!merges"])for(var u=t["!merges"],h=0;h!=u.length;++h)u[h].s.c!=a.c||u[h].s.r!=a.r||(u[h].e.c>u[h].s.c&&(o["ss:MergeAcross"]=u[h].e.c-u[h].s.c),u[h].e.r>u[h].s.r&&(o["ss:MergeDown"]=u[h].e.r-u[h].s.r));var f="",g="";switch(n.t){case"z":if(!r.sheetStubs)return"";break;case"n":f="Number",g=String(n.v);break;case"b":f="Boolean",g=n.v?"1":"0";break;case"e":f="Error",g=N1[n.v];break;case"d":f="DateTime",g=new Date(n.v).toISOString(),n.z==null&&(n.z=n.z||Cr[14]);break;case"s":f="String",g=Sme(n.v||"");break}var y=Pu(r.cellXfs,n,r);o["ss:StyleID"]="s"+(21+y),o["ss:Index"]=a.c+1;var v=n.v!=null?g:"",x=n.t=="z"?"":'<Data ss:Type="'+f+'">'+v+"</Data>";return(n.c||[]).length>0&&(x+=vve(n.c)),nt("Cell",x,o)}function Eve(n,e){var t='<Row ss:Index="'+(n+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=DV(e.hpt)),e.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(t+=' ss:Hidden="1"')),t+">"}function Sve(n,e,t,r){if(!n["!ref"])return"";var i=cr(n["!ref"]),s=n["!merges"]||[],a=0,o=[];n["!cols"]&&n["!cols"].forEach(function(E,T){sC(E);var b=!!E.width,I=qw(T,E),M={"ss:Index":T+1};b&&(M["ss:Width"]=Ev(I.width)),E.hidden&&(M["ss:Hidden"]="1"),o.push(nt("Column",null,M))});for(var l=Array.isArray(n),u=i.s.r;u<=i.e.r;++u){for(var h=[Eve(u,(n["!rows"]||[])[u])],f=i.s.c;f<=i.e.c;++f){var g=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>f)&&!(s[a].s.r>u)&&!(s[a].e.c<f)&&!(s[a].e.r<u)){(s[a].s.c!=f||s[a].s.r!=u)&&(g=!0);break}if(!g){var y={r:u,c:f},v=Kn(y),x=l?(n[u]||[])[f]:n[v];h.push(wve(x,v,n,e,t,r,y))}}h.push("</Row>"),h.length>2&&o.push(h.join(""))}return o.join("")}function Tve(n,e,t){var r=[],i=t.SheetNames[n],s=t.Sheets[i],a=s?_ve(s,e,n,t):"";return a.length>0&&r.push("<Names>"+a+"</Names>"),a=s?Sve(s,e,n,t):"",a.length>0&&r.push("<Table>"+a+"</Table>"),r.push(xve(s,e,n,t)),r.join("")}function bve(n,e){e||(e={}),n.SSF||(n.SSF=ks(Cr)),n.SSF&&($w(),zw(n.SSF),e.revssf=Ww(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF,e.cellXfs=[],Pu(e.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(gve(n,e)),t.push(mve()),t.push(""),t.push("");for(var r=0;r<n.SheetNames.length;++r)t.push(nt("Worksheet",Tve(r,e,n),{"ss:Name":Wn(n.SheetNames[r])}));return t[2]=pve(n,e),t[3]=yve(n),qr+nt("Workbook",t.join(""),{xmlns:Hs.ss,"xmlns:o":Hs.o,"xmlns:x":Hs.x,"xmlns:ss":Hs.ss,"xmlns:dt":Hs.dt,"xmlns:html":Hs.html})}var zS={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Ive(n,e){var t=[],r=[],i=[],s=0,a,o=tO(gO,"n"),l=tO(mO,"n");if(n.Props)for(a=Mi(n.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?t:Object.prototype.hasOwnProperty.call(l,a[s])?r:i).push([a[s],n.Props[a[s]]]);if(n.Custprops)for(a=Mi(n.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(n.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?t:Object.prototype.hasOwnProperty.call(l,a[s])?r:i).push([a[s],n.Custprops[a[s]]]);var u=[];for(s=0;s<i.length;++s)IV.indexOf(i[s][0])>-1||SV.indexOf(i[s][0])>-1||i[s][1]!=null&&u.push(i[s]);r.length&&Yn.utils.cfb_add(e,"/SummaryInformation",vO(r,zS.SI,l,mO)),(t.length||u.length)&&Yn.utils.cfb_add(e,"/DocumentSummaryInformation",vO(t,zS.DSI,o,gO,u.length?u:null,zS.UDI))}function Ave(n,e){var t=e||{},r=Yn.utils.cfb_new({root:"R"}),i="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":i="/Workbook",t.biff=8;break;case"biff5":i="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return Yn.utils.cfb_add(r,i,rG(n,t)),t.biff==8&&(n.Props||n.Custprops)&&Ive(n,r),t.biff==8&&n.vbaraw&&W1e(r,Yn.read(n.vbaraw,{type:typeof n.vbaraw=="string"?"binary":"buffer"})),r}var Rve={0:{f:k_e},1:{f:V_e},2:{f:sxe},3:{f:K_e},4:{f:z_e},5:{f:txe},6:{f:uxe},7:{f:Z_e},8:{f:yxe},9:{f:pxe},10:{f:gxe},11:{f:mxe},12:{f:B_e},13:{f:oxe},14:{f:q_e},15:{f:W_e},16:{f:rxe},17:{f:dxe},18:{f:J_e},19:{f:tC},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:nve},40:{},42:{},43:{f:u1e},44:{f:l1e},45:{f:f1e},46:{f:m1e},47:{f:g1e},48:{},49:{f:Bme},50:{},51:{f:k1e},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Upe},62:{f:cxe},63:{f:F1e},64:{f:Nxe},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Jo,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Cxe},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:F_e},148:{f:L_e,p:16},151:{f:Sxe},152:{},153:{f:eve},154:{},155:{},156:{f:Qxe},157:{},158:{},159:{T:1,f:Qpe},160:{T:-1},161:{T:1,f:Ed},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:_xe},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:C1e},336:{T:-1},337:{f:L1e,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Ub},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Dpe},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Txe},427:{f:bxe},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Axe},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:D_e},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:wxe},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Ub},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:U1e},633:{T:1},634:{T:-1},635:{T:1,f:G1e},636:{T:-1},637:{f:Wme},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Hxe},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Lxe},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function rt(n,e,t,r){var i=e;if(!isNaN(i)){var s=r||(t||[]).length||0,a=n.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&QR(t)&&n.push(t)}}function Cve(n,e,t,r){var i=(t||[]).length||0;if(i<=8224)return rt(n,e,t,i);var s=e;if(!isNaN(s)){for(var a=t.parts||[],o=0,l=0,u=0;u+(a[o]||8224)<=8224;)u+=a[o]||8224,o++;var h=n.next(4);for(h.write_shift(2,s),h.write_shift(2,u),n.push(t.slice(l,l+u)),l+=u;l<i;){for(h=n.next(4),h.write_shift(2,60),u=0;u+(a[o]||8224)<=8224;)u+=a[o]||8224,o++;h.write_shift(2,u),n.push(t.slice(l,l+u)),l+=u}}}function O1(n,e,t){return n||(n=Re(7)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,0),n.write_shift(1,0),n}function Pve(n,e,t,r){var i=Re(9);return O1(i,n,e),RV(t,r||"b",i),i}function kve(n,e,t){var r=Re(8+2*t.length);return O1(r,n,e),r.write_shift(1,t.length),r.write_shift(t.length,t,"sbcs"),r.l<r.length?r.slice(0,r.l):r}function Mve(n,e,t,r){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?Ps(us(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?rt(n,2,Hpe(t,r,i)):rt(n,3,Wpe(t,r,i));return;case"b":case"e":rt(n,5,Pve(t,r,e.v,e.t));return;case"s":case"str":rt(n,4,kve(t,r,(e.v||"").slice(0,255)));return}rt(n,1,O1(null,t,r))}function Nve(n,e,t,r){var i=Array.isArray(e),s=cr(e["!ref"]||"A1"),a,o="",l=[];if(s.e.c>255||s.e.r>16383){if(r.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=Kr(s)}for(var u=s.s.r;u<=s.e.r;++u){o=ki(u);for(var h=s.s.c;h<=s.e.c;++h){u===s.s.r&&(l[h]=Xi(h)),a=l[h]+o;var f=i?(e[u]||[])[h]:e[a];f&&Mve(n,f,u,h)}}}function Lve(n,e){for(var t=e||{},r=Rs(),i=0,s=0;s<n.SheetNames.length;++s)n.SheetNames[s]==t.sheet&&(i=s);if(i==0&&t.sheet&&n.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return rt(r,t.biff==4?1033:t.biff==3?521:9,iC(n,16,t)),Nve(r,n.Sheets[n.SheetNames[i]],i,t),rt(r,10),r.end()}function Ove(n,e,t){rt(n,49,Rpe({sz:12,name:"Arial"},t))}function Dve(n,e,t){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&rt(n,1054,kpe(i,e[i],t))})}function Fve(n,e){var t=Re(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),rt(n,2151,t),t=Re(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),kV(cr(e["!ref"]||"A1"),t),t.write_shift(4,4),rt(n,2152,t)}function jve(n,e){for(var t=0;t<16;++t)rt(n,224,EO({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(r){rt(n,224,EO(r,0,e))})}function Vve(n,e){for(var t=0;t<e["!links"].length;++t){var r=e["!links"][t];rt(n,440,Vpe(r)),r[1].Tooltip&&rt(n,2048,Gpe(r))}delete e["!links"]}function Gve(n,e){if(e){var t=0;e.forEach(function(r,i){++t<=256&&r&&rt(n,125,zpe(qw(i,r),i))})}}function Bve(n,e,t,r,i){var s=16+Pu(i.cellXfs,e,i);if(e.v==null&&!e.bf){rt(n,513,rd(t,r,s));return}if(e.bf)rt(n,6,h_e(e,t,r,i,s));else switch(e.t){case"d":case"n":var a=e.t=="d"?Ps(us(e.v)):e.v;rt(n,515,Ope(t,r,a,s));break;case"b":case"e":rt(n,517,Lpe(t,r,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var o=cC(i.Strings,e.v,i.revStrings);rt(n,253,Cpe(t,r,o,s))}else rt(n,516,Ppe(t,r,(e.v||"").slice(0,255),s,i));break;default:rt(n,513,rd(t,r,s))}}function Uve(n,e,t){var r=Rs(),i=t.SheetNames[n],s=t.Sheets[i]||{},a=(t||{}).Workbook||{},o=(a.Sheets||[])[n]||{},l=Array.isArray(s),u=e.biff==8,h,f="",g=[],y=cr(s["!ref"]||"A1"),v=u?65536:16384;if(y.e.c>255||y.e.r>=v){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");y.e.c=Math.min(y.e.c,255),y.e.r=Math.min(y.e.c,v-1)}rt(r,2057,iC(t,16,e)),rt(r,13,ya(1)),rt(r,12,ya(100)),rt(r,15,rs(!0)),rt(r,17,rs(!1)),rt(r,16,nd(.001)),rt(r,95,rs(!0)),rt(r,42,rs(!1)),rt(r,43,rs(!1)),rt(r,130,ya(1)),rt(r,128,Npe()),rt(r,131,rs(!1)),rt(r,132,rs(!1)),u&&Gve(r,s["!cols"]),rt(r,512,Mpe(y,e)),u&&(s["!links"]=[]);for(var x=y.s.r;x<=y.e.r;++x){f=ki(x);for(var E=y.s.c;E<=y.e.c;++E){x===y.s.r&&(g[E]=Xi(E)),h=g[E]+f;var T=l?(s[x]||[])[E]:s[h];T&&(Bve(r,T,x,E,e),u&&T.l&&s["!links"].push([h,T.l]))}}var b=o.CodeName||o.name||i;return u&&rt(r,574,Ape((a.Views||[])[0])),u&&(s["!merges"]||[]).length&&rt(r,229,jpe(s["!merges"])),u&&Vve(r,s),rt(r,442,PV(b)),u&&Fve(r,s),rt(r,10),r.end()}function zve(n,e,t){var r=Rs(),i=(n||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=t.biff==8,l=t.biff==5;if(rt(r,2057,iC(n,5,t)),t.bookType=="xla"&&rt(r,135),rt(r,225,o?ya(1200):null),rt(r,193,gpe(2)),l&&rt(r,191),l&&rt(r,192),rt(r,226),rt(r,92,Spe("SheetJS",t)),rt(r,66,ya(o?1200:1252)),o&&rt(r,353,ya(0)),o&&rt(r,448),rt(r,317,$pe(n.SheetNames.length)),o&&n.vbaraw&&rt(r,211),o&&n.vbaraw){var u=a.CodeName||"ThisWorkbook";rt(r,442,PV(u))}rt(r,156,ya(17)),rt(r,25,rs(!1)),rt(r,18,rs(!1)),rt(r,19,ya(0)),o&&rt(r,431,rs(!1)),o&&rt(r,444,ya(0)),rt(r,61,Ipe()),rt(r,64,rs(!1)),rt(r,141,ya(0)),rt(r,34,rs(Yxe(n)=="true")),rt(r,14,rs(!0)),o&&rt(r,439,rs(!1)),rt(r,218,ya(0)),Ove(r,n,t),Dve(r,n.SSF,t),jve(r,t),o&&rt(r,352,rs(!1));var h=r.end(),f=Rs();o&&rt(f,140,Bpe()),o&&t.Strings&&Cve(f,252,bpe(t.Strings)),rt(f,10);var g=f.end(),y=Rs(),v=0,x=0;for(x=0;x<n.SheetNames.length;++x)v+=(o?12:11)+(o?2:1)*n.SheetNames[x].length;var E=h.length+v+g.length;for(x=0;x<n.SheetNames.length;++x){var T=s[x]||{};rt(y,133,Tpe({pos:E,hs:T.Hidden||0,dt:0,name:n.SheetNames[x]},t)),E+=e[x].length}var b=y.end();if(v!=b.length)throw new Error("BS8 "+v+" != "+b.length);var I=[];return h.length&&I.push(h),b.length&&I.push(b),g.length&&I.push(g),Ai(I)}function $ve(n,e){var t=e||{},r=[];n&&!n.SSF&&(n.SSF=ks(Cr)),n&&n.SSF&&($w(),zw(n.SSF),t.revssf=Ww(n.SSF),t.revssf[n.SSF[65535]]=0,t.ssf=n.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,uC(t),t.cellXfs=[],Pu(t.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={});for(var i=0;i<n.SheetNames.length;++i)r[r.length]=Uve(i,t,n);return r.unshift(zve(n,r,t)),Ai(r)}function rG(n,e){for(var t=0;t<=n.SheetNames.length;++t){var r=n.Sheets[n.SheetNames[t]];if(!(!r||!r["!ref"])){var i=ra(r["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+n.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return $ve(n,e);case 4:case 3:case 2:return Lve(n,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function Wve(n,e,t,r){for(var i=n["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,u=0;u<i.length;++u)if(!(i[u].s.r>t||i[u].s.c>a)&&!(i[u].e.r<t||i[u].e.c<a)){if(i[u].s.r<t||i[u].s.c<a){o=-1;break}o=i[u].e.r-i[u].s.r+1,l=i[u].e.c-i[u].s.c+1;break}if(!(o<0)){var h=Kn({r:t,c:a}),f=r.dense?(n[t]||[])[a]:n[h],g=f&&f.v!=null&&(f.h||Eme(f.w||(Yl(f),f.w)||""))||"",y={};o>1&&(y.rowspan=o),l>1&&(y.colspan=l),r.editable?g='<span contenteditable="true">'+g+"</span>":f&&(y["data-t"]=f&&f.t||"z",f.v!=null&&(y["data-v"]=f.v),f.z!=null&&(y["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(g='<a href="'+f.l.Target+'">'+g+"</a>")),y.id=(r.id||"sjs")+"-"+h,s.push(nt("td",g,y))}}var v="<tr>";return v+s.join("")+"</tr>"}var Hve='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Kve="</body></html>";function Yve(n,e,t){var r=[];return r.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function iG(n,e){var t=e||{},r=t.header!=null?t.header:Hve,i=t.footer!=null?t.footer:Kve,s=[r],a=ra(n["!ref"]);t.dense=Array.isArray(n),s.push(Yve(n,a,t));for(var o=a.s.r;o<=a.e.r;++o)s.push(Wve(n,a,o,t));return s.push("</table>"+i),s.join("")}function sG(n,e,t){var r=t||{},i=0,s=0;if(r.origin!=null)if(typeof r.origin=="number")i=r.origin;else{var a=typeof r.origin=="string"?gi(r.origin):r.origin;i=a.r,s=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(r.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:i,c:s}};if(n["!ref"]){var h=ra(n["!ref"]);u.s.r=Math.min(u.s.r,h.s.r),u.s.c=Math.min(u.s.c,h.s.c),u.e.r=Math.max(u.e.r,h.e.r),u.e.c=Math.max(u.e.c,h.e.c),i==-1&&(u.e.r=i=h.e.r+1)}var f=[],g=0,y=n["!rows"]||(n["!rows"]=[]),v=0,x=0,E=0,T=0,b=0,I=0;for(n["!cols"]||(n["!cols"]=[]);v<o.length&&x<l;++v){var M=o[v];if(CO(M)){if(r.display)continue;y[x]={hidden:!0}}var F=M.children;for(E=T=0;E<F.length;++E){var z=F[E];if(!(r.display&&CO(z))){var k=z.hasAttribute("data-v")?z.getAttribute("data-v"):z.hasAttribute("v")?z.getAttribute("v"):Ime(z.innerHTML),C=z.getAttribute("data-z")||z.getAttribute("z");for(g=0;g<f.length;++g){var P=f[g];P.s.c==T+s&&P.s.r<x+i&&x+i<=P.e.r&&(T=P.e.c+1-s,g=-1)}I=+z.getAttribute("colspan")||1,((b=+z.getAttribute("rowspan")||1)>1||I>1)&&f.push({s:{r:x+i,c:T+s},e:{r:x+i+(b||1)-1,c:T+s+(I||1)-1}});var L={t:"s",v:k},O=z.getAttribute("data-t")||z.getAttribute("t")||"";k!=null&&(k.length==0?L.t=O||"z":r.raw||k.trim().length==0||O=="s"||(k==="TRUE"?L={t:"b",v:!0}:k==="FALSE"?L={t:"b",v:!1}:isNaN(Fl(k))?isNaN(Mp(k).getDate())||(L={t:"d",v:us(k)},r.cellDates||(L={t:"n",v:Ps(L.v)}),L.z=r.dateNF||Cr[14]):L={t:"n",v:Fl(k)})),L.z===void 0&&C!=null&&(L.z=C);var U="",j=z.getElementsByTagName("A");if(j&&j.length)for(var Ie=0;Ie<j.length&&!(j[Ie].hasAttribute("href")&&(U=j[Ie].getAttribute("href"),U.charAt(0)!="#"));++Ie);U&&U.charAt(0)!="#"&&(L.l={Target:U}),r.dense?(n[x+i]||(n[x+i]=[]),n[x+i][T+s]=L):n[Kn({c:T+s,r:x+i})]=L,u.e.c<T+s&&(u.e.c=T+s),T+=I}}++x}return f.length&&(n["!merges"]=(n["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,x-1+i),n["!ref"]=Kr(u),x>=l&&(n["!fullref"]=Kr((u.e.r=o.length-v+x-1+i,u))),n}function aG(n,e){var t=e||{},r=t.dense?[]:{};return sG(r,n,e)}function qve(n,e){return _d(aG(n,e),e)}function CO(n){var e="",t=Xve(n);return t&&(e=t(n).getPropertyValue("display")),e||(e=n.style&&n.style.display),e==="none"}function Xve(n){return n.ownerDocument.defaultView&&typeof n.ownerDocument.defaultView.getComputedStyle=="function"?n.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var Zve=(function(){var n=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+Lp({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+n+"</office:document-styles>";return function(){return qr+e}})(),PO=(function(){var n=function(s){return Wn(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,r=function(s,a,o){var l=[];l.push('      <table:table table:name="'+Wn(a.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,h=0,f=ra(s["!ref"]||"A1"),g=s["!merges"]||[],y=0,v=Array.isArray(s);if(s["!cols"])for(h=0;h<=f.e.c;++h)l.push("        <table:table-column"+(s["!cols"][h]?' table:style-name="co'+s["!cols"][h].ods+'"':"")+`></table:table-column>
`);var x="",E=s["!rows"]||[];for(u=0;u<f.s.r;++u)x=E[u]?' table:style-name="ro'+E[u].ods+'"':"",l.push("        <table:table-row"+x+`></table:table-row>
`);for(;u<=f.e.r;++u){for(x=E[u]?' table:style-name="ro'+E[u].ods+'"':"",l.push("        <table:table-row"+x+`>
`),h=0;h<f.s.c;++h)l.push(e);for(;h<=f.e.c;++h){var T=!1,b={},I="";for(y=0;y!=g.length;++y)if(!(g[y].s.c>h)&&!(g[y].s.r>u)&&!(g[y].e.c<h)&&!(g[y].e.r<u)){(g[y].s.c!=h||g[y].s.r!=u)&&(T=!0),b["table:number-columns-spanned"]=g[y].e.c-g[y].s.c+1,b["table:number-rows-spanned"]=g[y].e.r-g[y].s.r+1;break}if(T){l.push(t);continue}var M=Kn({r:u,c:h}),F=v?(s[u]||[])[h]:s[M];if(F&&F.f&&(b["table:formula"]=Wn(y_e(F.f)),F.F&&F.F.slice(0,M.length)==M)){var z=ra(F.F);b["table:number-matrix-columns-spanned"]=z.e.c-z.s.c+1,b["table:number-matrix-rows-spanned"]=z.e.r-z.s.r+1}if(!F){l.push(e);continue}switch(F.t){case"b":I=F.v?"TRUE":"FALSE",b["office:value-type"]="boolean",b["office:boolean-value"]=F.v?"true":"false";break;case"n":I=F.w||String(F.v||0),b["office:value-type"]="float",b["office:value"]=F.v||0;break;case"s":case"str":I=F.v==null?"":F.v,b["office:value-type"]="string";break;case"d":I=F.w||us(F.v).toISOString(),b["office:value-type"]="date",b["office:date-value"]=us(F.v).toISOString(),b["table:style-name"]="ce1";break;default:l.push(e);continue}var k=n(I);if(F.l&&F.l.Target){var C=F.l.Target;C=C.charAt(0)=="#"?"#"+__e(C.slice(1)):C,C.charAt(0)!="#"&&!C.match(/^\w+:/)&&(C="../"+C),k=nt("text:a",k,{"xlink:href":C.replace(/&/g,"&amp;")})}l.push("          "+nt("table:table-cell",nt("text:p",k,{}),b)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var h=0;h<u["!cols"].length;++h)if(u["!cols"][h]){var f=u["!cols"][h];if(f.width==null&&f.wpx==null&&f.wch==null)continue;sC(f),f.ods=o;var g=u["!cols"][h].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+g+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var h=0;h<u["!rows"].length;++h)if(u["!rows"][h]){u["!rows"][h].ods=l;var f=u["!rows"][h].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var l=[qr],u=Lp({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),h=Lp({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+u+h+`>
`),l.push(wV().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+u+`>
`),i(l,a),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var f=0;f!=a.SheetNames.length;++f)l.push(r(a.Sheets[a.SheetNames[f]],a,f));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}})();function oG(n,e){if(e.bookType=="fods")return PO(n,e);var t=YR(),r="",i=[],s=[];return r="mimetype",nn(t,r,"application/vnd.oasis.opendocument.spreadsheet"),r="content.xml",nn(t,r,PO(n,e)),i.push([r,"text/xml"]),s.push([r,"ContentFile"]),r="styles.xml",nn(t,r,Zve(n,e)),i.push([r,"text/xml"]),s.push([r,"StylesFile"]),r="meta.xml",nn(t,r,qr+wV()),i.push([r,"text/xml"]),s.push([r,"MetadataFile"]),r="manifest.rdf",nn(t,r,cpe(s)),i.push([r,"application/rdf+xml"]),r="META-INF/manifest.xml",nn(t,r,ope(i)),t}function bv(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}function Qve(n){return typeof TextEncoder<"u"?new TextEncoder().encode(n):Ya(Np(n))}function Jve(n,e){e:for(var t=0;t<=n.length-e.length;++t){for(var r=0;r<e.length;++r)if(n[t+r]!=e[r])continue e;return!0}return!1}function Eu(n){var e=n.reduce(function(i,s){return i+s.length},0),t=new Uint8Array(e),r=0;return n.forEach(function(i){t.set(i,r),r+=i.length}),t}function ewe(n,e,t){var r=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,i=t/Math.pow(10,r-6176);n[e+15]|=r>>7,n[e+14]|=(r&127)<<1;for(var s=0;i>=1;++s,i/=256)n[e+s]=i&255;n[e+15]|=t>=0?0:128}function Op(n,e){var t=e?e[0]:0,r=n[t]&127;e:if(n[t++]>=128&&(r|=(n[t]&127)<<7,n[t++]<128||(r|=(n[t]&127)<<14,n[t++]<128)||(r|=(n[t]&127)<<21,n[t++]<128)||(r+=(n[t]&127)*Math.pow(2,28),++t,n[t++]<128)||(r+=(n[t]&127)*Math.pow(2,35),++t,n[t++]<128)||(r+=(n[t]&127)*Math.pow(2,42),++t,n[t++]<128)))break e;return e&&(e[0]=t),r}function Bn(n){var e=new Uint8Array(7);e[0]=n&127;var t=1;e:if(n>127){if(e[t-1]|=128,e[t]=n>>7&127,++t,n<=16383||(e[t-1]|=128,e[t]=n>>14&127,++t,n<=2097151)||(e[t-1]|=128,e[t]=n>>21&127,++t,n<=268435455)||(e[t-1]|=128,e[t]=n/256>>>21&127,++t,n<=34359738367)||(e[t-1]|=128,e[t]=n/65536>>>21&127,++t,n<=4398046511103))break e;e[t-1]|=128,e[t]=n/16777216>>>21&127,++t}return e.slice(0,t)}function s0(n){var e=0,t=n[e]&127;e:if(n[e++]>=128){if(t|=(n[e]&127)<<7,n[e++]<128||(t|=(n[e]&127)<<14,n[e++]<128)||(t|=(n[e]&127)<<21,n[e++]<128))break e;t|=(n[e]&127)<<28}return t}function Jr(n){for(var e=[],t=[0];t[0]<n.length;){var r=t[0],i=Op(n,t),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=t[0];n[t[0]++]>=128;);o=n.slice(l,t[0])}break;case 5:a=4,o=n.slice(t[0],t[0]+a),t[0]+=a;break;case 1:a=8,o=n.slice(t[0],t[0]+a),t[0]+=a;break;case 2:a=Op(n,t),o=n.slice(t[0],t[0]+a),t[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(r))}var u={data:o,type:s};e[i]==null?e[i]=[u]:e[i].push(u)}return e}function wi(n){var e=[];return n.forEach(function(t,r){t.forEach(function(i){i.data&&(e.push(Bn(r*8+i.type)),i.type==2&&e.push(Bn(i.data.length)),e.push(i.data))})}),Eu(e)}function Va(n){for(var e,t=[],r=[0];r[0]<n.length;){var i=Op(n,r),s=Jr(n.slice(r[0],r[0]+i));r[0]+=i;var a={id:s0(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=Jr(o.data),u=s0(l[3][0].data);a.messages.push({meta:l,data:n.slice(r[0],r[0]+u)}),r[0]+=u}),(e=s[3])!=null&&e[0]&&(a.merge=s0(s[3][0].data)>>>0>0),t.push(a)}return t}function mf(n){var e=[];return n.forEach(function(t){var r=[];r[1]=[{data:Bn(t.id),type:0}],r[2]=[],t.merge!=null&&(r[3]=[{data:Bn(+!!t.merge),type:0}]);var i=[];t.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:Bn(a.data.length)}],r[2].push({data:wi(a.meta),type:2})});var s=wi(r);e.push(Bn(s.length)),e.push(s),i.forEach(function(a){return e.push(a)})}),Eu(e)}function twe(n,e){if(n!=0)throw new Error("Unexpected Snappy chunk type ".concat(n));for(var t=[0],r=Op(e,t),i=[];t[0]<e.length;){var s=e[t[0]]&3;if(s==0){var a=e[t[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[t[0]],o>1&&(a|=e[t[0]+1]<<8),o>2&&(a|=e[t[0]+2]<<16),o>3&&(a|=e[t[0]+3]<<24),a>>>=0,a++,t[0]+=o}i.push(e.slice(t[0],t[0]+a)),t[0]+=a;continue}else{var l=0,u=0;if(s==1?(u=(e[t[0]]>>2&7)+4,l=(e[t[0]++]&224)<<3,l|=e[t[0]++]):(u=(e[t[0]++]>>2)+1,s==2?(l=e[t[0]]|e[t[0]+1]<<8,t[0]+=2):(l=(e[t[0]]|e[t[0]+1]<<8|e[t[0]+2]<<16|e[t[0]+3]<<24)>>>0,t[0]+=4)),i=[Eu(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(i.push(i[0].slice(-l)),u-=l;u>=i[i.length-1].length;)i.push(i[i.length-1]),u-=i[i.length-1].length;i.push(i[0].slice(-l,-l+u))}}var h=Eu(i);if(h.length!=r)throw new Error("Unexpected length: ".concat(h.length," != ").concat(r));return h}function Ga(n){for(var e=[],t=0;t<n.length;){var r=n[t++],i=n[t]|n[t+1]<<8|n[t+2]<<16;t+=3,e.push(twe(r,n.slice(t,t+i))),t+=i}if(t!==n.length)throw new Error("data is not a valid framed stream!");return Eu(e)}function pf(n){for(var e=[],t=0;t<n.length;){var r=Math.min(n.length-t,268435455),i=new Uint8Array(4);e.push(i);var s=Bn(r),a=s.length;e.push(s),r<=60?(a++,e.push(new Uint8Array([r-1<<2]))):r<=256?(a+=2,e.push(new Uint8Array([240,r-1&255]))):r<=65536?(a+=3,e.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(a+=4,e.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(a+=5,e.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),e.push(n.slice(t,t+r)),a+=r,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,t+=r}return Eu(e)}function $S(n,e){var t=new Uint8Array(32),r=bv(t),i=12,s=0;switch(t[0]=5,n.t){case"n":t[1]=2,ewe(t,i,n.v),s|=1,i+=16;break;case"b":t[1]=6,r.setFloat64(i,n.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(n.v)==-1)throw new Error("Value ".concat(n.v," missing from SST!"));t[1]=3,r.setUint32(i,e.indexOf(n.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+n.t}return r.setUint32(8,s,!0),t.slice(0,i)}function WS(n,e){var t=new Uint8Array(32),r=bv(t),i=12,s=0;switch(t[0]=3,n.t){case"n":t[2]=2,r.setFloat64(i,n.v,!0),s|=32,i+=8;break;case"b":t[2]=6,r.setFloat64(i,n.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(n.v)==-1)throw new Error("Value ".concat(n.v," missing from SST!"));t[2]=3,r.setUint32(i,e.indexOf(n.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+n.t}return r.setUint32(4,s,!0),t.slice(0,i)}function Mc(n){var e=Jr(n);return Op(e[1][0].data)}function nwe(n,e,t){var r,i,s,a;if(!((r=n[6])!=null&&r[0])||!((i=n[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=n[8])==null?void 0:s[0])==null?void 0:a.data)&&s0(n[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,u=bv(n[7][0].data),h=0,f=[],g=bv(n[4][0].data),y=0,v=[],x=0;x<e.length;++x){if(e[x]==null){u.setUint16(x*2,65535,!0),g.setUint16(x*2,65535);continue}u.setUint16(x*2,h,!0),g.setUint16(x*2,y,!0);var E,T;switch(typeof e[x]){case"string":E=$S({t:"s",v:e[x]},t),T=WS({t:"s",v:e[x]},t);break;case"number":E=$S({t:"n",v:e[x]},t),T=WS({t:"n",v:e[x]},t);break;case"boolean":E=$S({t:"b",v:e[x]},t),T=WS({t:"b",v:e[x]},t);break;default:throw new Error("Unsupported value "+e[x])}f.push(E),h+=E.length,v.push(T),y+=T.length,++l}for(n[2][0].data=Bn(l);x<n[7][0].data.length/2;++x)u.setUint16(x*2,65535,!0),g.setUint16(x*2,65535,!0);return n[6][0].data=Eu(f),n[3][0].data=Eu(v),l}function rwe(n,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=n.Sheets[n.SheetNames[0]];n.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=ra(t["!ref"]);r.s.r=r.s.c=0;var i=!1;r.e.c>9&&(i=!0,r.e.c=9),r.e.r>49&&(i=!0,r.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(Kr(r)));var s=Iv(t,{range:r,header:1}),a=["~Sh33tJ5~"];s.forEach(function(J){return J.forEach(function(ne){typeof ne=="string"&&a.push(ne)})});var o={},l=[],u=Yn.read(e.numbers,{type:"base64"});u.FileIndex.map(function(J,ne){return[J,u.FullPaths[ne]]}).forEach(function(J){var ne=J[0],X=J[1];if(ne.type==2&&ne.name.match(/\.iwa/)){var ue=ne.content,Me=Ga(ue),je=Va(Me);je.forEach(function(De){l.push(De.id),o[De.id]={deps:[],location:X,type:s0(De.messages[0].meta[1][0].data)}})}}),l.sort(function(J,ne){return J-ne});var h=l.filter(function(J){return J>1}).map(function(J){return[J,Bn(J)]});u.FileIndex.map(function(J,ne){return[J,u.FullPaths[ne]]}).forEach(function(J){var ne=J[0];if(J[1],!!ne.name.match(/\.iwa/)){var X=Va(Ga(ne.content));X.forEach(function(ue){ue.messages.forEach(function(Me){h.forEach(function(je){ue.messages.some(function(De){return s0(De.meta[1][0].data)!=11006&&Jve(De.data,je[1])})&&o[je[0]].deps.push(ue.id)})})})}});for(var f=Yn.find(u,o[1].location),g=Va(Ga(f.content)),y,v=0;v<g.length;++v){var x=g[v];x.id==1&&(y=x)}var E=Mc(Jr(y.messages[0].data)[1][0].data);for(f=Yn.find(u,o[E].location),g=Va(Ga(f.content)),v=0;v<g.length;++v)x=g[v],x.id==E&&(y=x);for(E=Mc(Jr(y.messages[0].data)[2][0].data),f=Yn.find(u,o[E].location),g=Va(Ga(f.content)),v=0;v<g.length;++v)x=g[v],x.id==E&&(y=x);for(E=Mc(Jr(y.messages[0].data)[2][0].data),f=Yn.find(u,o[E].location),g=Va(Ga(f.content)),v=0;v<g.length;++v)x=g[v],x.id==E&&(y=x);var T=Jr(y.messages[0].data);{T[6][0].data=Bn(r.e.r+1),T[7][0].data=Bn(r.e.c+1);var b=Mc(T[46][0].data),I=Yn.find(u,o[b].location),M=Va(Ga(I.content));{for(var F=0;F<M.length&&M[F].id!=b;++F);if(M[F].id!=b)throw"Bad ColumnRowUIDMapArchive";var z=Jr(M[F].messages[0].data);z[1]=[],z[2]=[],z[3]=[];for(var k=0;k<=r.e.c;++k){var C=[];C[1]=C[2]=[{type:0,data:Bn(k+420690)}],z[1].push({type:2,data:wi(C)}),z[2].push({type:0,data:Bn(k)}),z[3].push({type:0,data:Bn(k)})}z[4]=[],z[5]=[],z[6]=[];for(var P=0;P<=r.e.r;++P)C=[],C[1]=C[2]=[{type:0,data:Bn(P+726270)}],z[4].push({type:2,data:wi(C)}),z[5].push({type:0,data:Bn(P)}),z[6].push({type:0,data:Bn(P)});M[F].messages[0].data=wi(z)}I.content=pf(mf(M)),I.size=I.content.length,delete T[46];var L=Jr(T[4][0].data);{L[7][0].data=Bn(r.e.r+1);var O=Jr(L[1][0].data),U=Mc(O[2][0].data);I=Yn.find(u,o[U].location),M=Va(Ga(I.content));{if(M[0].id!=U)throw"Bad HeaderStorageBucket";var j=Jr(M[0].messages[0].data);for(P=0;P<s.length;++P){var Ie=Jr(j[2][0].data);Ie[1][0].data=Bn(P),Ie[4][0].data=Bn(s[P].length),j[2][P]={type:j[2][0].type,data:wi(Ie)}}M[0].messages[0].data=wi(j)}I.content=pf(mf(M)),I.size=I.content.length;var ke=Mc(L[2][0].data);I=Yn.find(u,o[ke].location),M=Va(Ga(I.content));{if(M[0].id!=ke)throw"Bad HeaderStorageBucket";for(j=Jr(M[0].messages[0].data),k=0;k<=r.e.c;++k)Ie=Jr(j[2][0].data),Ie[1][0].data=Bn(k),Ie[4][0].data=Bn(r.e.r+1),j[2][k]={type:j[2][0].type,data:wi(Ie)};M[0].messages[0].data=wi(j)}I.content=pf(mf(M)),I.size=I.content.length;var ze=Mc(L[4][0].data);(function(){for(var J=Yn.find(u,o[ze].location),ne=Va(Ga(J.content)),X,ue=0;ue<ne.length;++ue){var Me=ne[ue];Me.id==ze&&(X=Me)}var je=Jr(X.messages[0].data);{je[3]=[];var De=[];a.forEach(function(Kt,wn){De[1]=[{type:0,data:Bn(wn)}],De[2]=[{type:0,data:Bn(1)}],De[3]=[{type:2,data:Qve(Kt)}],je[3].push({type:2,data:wi(De)})})}X.messages[0].data=wi(je);var Be=mf(ne),Gt=pf(Be);J.content=Gt,J.size=J.content.length})();var Ne=Jr(L[3][0].data);{var ce=Ne[1][0];delete Ne[2];var Te=Jr(ce.data);{var Ee=Mc(Te[2][0].data);(function(){for(var J=Yn.find(u,o[Ee].location),ne=Va(Ga(J.content)),X,ue=0;ue<ne.length;++ue){var Me=ne[ue];Me.id==Ee&&(X=Me)}var je=Jr(X.messages[0].data);{delete je[6],delete Ne[7];var De=new Uint8Array(je[5][0].data);je[5]=[];for(var Be=0,Gt=0;Gt<=r.e.r;++Gt){var Kt=Jr(De);Be+=nwe(Kt,s[Gt],a),Kt[1][0].data=Bn(Gt),je[5].push({data:wi(Kt),type:2})}je[1]=[{type:0,data:Bn(r.e.c+1)}],je[2]=[{type:0,data:Bn(r.e.r+1)}],je[3]=[{type:0,data:Bn(Be)}],je[4]=[{type:0,data:Bn(r.e.r+1)}]}X.messages[0].data=wi(je);var wn=mf(ne),Bt=pf(wn);J.content=Bt,J.size=J.content.length})()}ce.data=wi(Te)}L[3][0].data=wi(Ne)}T[4][0].data=wi(L)}y.messages[0].data=wi(T);var se=mf(g),V=pf(se);return f.content=V,f.size=f.content.length,u}function iwe(n){return function(t){for(var r=0;r!=n.length;++r){var i=n[r];t[i[0]]===void 0&&(t[i[0]]=i[1]),i[2]==="n"&&(t[i[0]]=Number(t[i[0]]))}}}function uC(n){iwe([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(n)}function swe(n,e){return e.bookType=="ods"?oG(n,e):e.bookType=="numbers"?rwe(n,e):e.bookType=="xlsb"?awe(n,e):owe(n,e)}function awe(n,e){Bf=1024,n&&!n.SSF&&(n.SSF=ks(Cr)),n&&n.SSF&&($w(),zw(n.SSF),e.revssf=Ww(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Um?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t=e.bookType=="xlsb"?"bin":"xml",r=zV.indexOf(e.bookType)>-1,i=_V();uC(e=e||{});var s=YR(),a="",o=0;if(e.cellXfs=[],Pu(e.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),a="docProps/core.xml",nn(s,a,EV(n.Props,e)),i.coreprops.push(a),Un(e.rels,2,a,Sn.CORE_PROPS),a="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var l=[],u=0;u<n.SheetNames.length;++u)(n.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(n.SheetNames[u]);n.Props.SheetNames=l}for(n.Props.Worksheets=n.Props.SheetNames.length,nn(s,a,TV(n.Props)),i.extprops.push(a),Un(e.rels,3,a,Sn.EXT_PROPS),n.Custprops!==n.Props&&Mi(n.Custprops||{}).length>0&&(a="docProps/custom.xml",nn(s,a,bV(n.Custprops)),i.custprops.push(a),Un(e.rels,4,a,Sn.CUST_PROPS)),o=1;o<=n.SheetNames.length;++o){var h={"!id":{}},f=n.Sheets[n.SheetNames[o-1]],g=(f||{})["!type"]||"sheet";switch(g){case"chart":default:a="xl/worksheets/sheet"+o+"."+t,nn(s,a,cve(o-1,a,e,n,h)),i.sheets.push(a),Un(e.wbrels,-1,"worksheets/sheet"+o+"."+t,Sn.WS[0])}if(f){var y=f["!comments"],v=!1,x="";y&&y.length>0&&(x="xl/comments"+o+"."+t,nn(s,x,dve(y,x)),i.comments.push(x),Un(h,-1,"../comments"+o+"."+t,Sn.CMNT),v=!0),f["!legacy"]&&v&&nn(s,"xl/drawings/vmlDrawing"+o+".vml",BV(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}h["!id"].rId1&&nn(s,vV(a),r0(h))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+t,nn(s,a,hve(e.Strings,a,e)),i.strs.push(a),Un(e.wbrels,-1,"sharedStrings."+t,Sn.SST)),a="xl/workbook."+t,nn(s,a,lve(n,a)),i.workbooks.push(a),Un(e.rels,1,a,Sn.WB),a="xl/theme/theme1.xml",nn(s,a,VV(n.Themes,e)),i.themes.push(a),Un(e.wbrels,-1,"theme/theme1.xml",Sn.THEME),a="xl/styles."+t,nn(s,a,uve(n,a,e)),i.styles.push(a),Un(e.wbrels,-1,"styles."+t,Sn.STY),n.vbaraw&&r&&(a="xl/vbaProject.bin",nn(s,a,n.vbaraw),i.vba.push(a),Un(e.wbrels,-1,"vbaProject.bin",Sn.VBA)),a="xl/metadata."+t,nn(s,a,fve(a)),i.metadata.push(a),Un(e.wbrels,-1,"metadata."+t,Sn.XLMETA),nn(s,"[Content_Types].xml",xV(i,e)),nn(s,"_rels/.rels",r0(e.rels)),nn(s,"xl/_rels/workbook."+t+".rels",r0(e.wbrels)),delete e.revssf,delete e.ssf,s}function owe(n,e){Bf=1024,n&&!n.SSF&&(n.SSF=ks(Cr)),n&&n.SSF&&($w(),zw(n.SSF),e.revssf=Ww(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Um?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t="xml",r=zV.indexOf(e.bookType)>-1,i=_V();uC(e=e||{});var s=YR(),a="",o=0;if(e.cellXfs=[],Pu(e.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),a="docProps/core.xml",nn(s,a,EV(n.Props,e)),i.coreprops.push(a),Un(e.rels,2,a,Sn.CORE_PROPS),a="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var l=[],u=0;u<n.SheetNames.length;++u)(n.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(n.SheetNames[u]);n.Props.SheetNames=l}n.Props.Worksheets=n.Props.SheetNames.length,nn(s,a,TV(n.Props)),i.extprops.push(a),Un(e.rels,3,a,Sn.EXT_PROPS),n.Custprops!==n.Props&&Mi(n.Custprops||{}).length>0&&(a="docProps/custom.xml",nn(s,a,bV(n.Custprops)),i.custprops.push(a),Un(e.rels,4,a,Sn.CUST_PROPS));var h=["SheetJ5"];for(e.tcid=0,o=1;o<=n.SheetNames.length;++o){var f={"!id":{}},g=n.Sheets[n.SheetNames[o-1]],y=(g||{})["!type"]||"sheet";switch(y){case"chart":default:a="xl/worksheets/sheet"+o+"."+t,nn(s,a,QV(o-1,e,n,f)),i.sheets.push(a),Un(e.wbrels,-1,"worksheets/sheet"+o+"."+t,Sn.WS[0])}if(g){var v=g["!comments"],x=!1,E="";if(v&&v.length>0){var T=!1;v.forEach(function(b){b[1].forEach(function(I){I.T==!0&&(T=!0)})}),T&&(E="xl/threadedComments/threadedComment"+o+"."+t,nn(s,E,j1e(v,h,e)),i.threadedcomments.push(E),Un(f,-1,"../threadedComments/threadedComment"+o+"."+t,Sn.TCMNT)),E="xl/comments"+o+"."+t,nn(s,E,UV(v)),i.comments.push(E),Un(f,-1,"../comments"+o+"."+t,Sn.CMNT),x=!0}g["!legacy"]&&x&&nn(s,"xl/drawings/vmlDrawing"+o+".vml",BV(o,g["!comments"])),delete g["!comments"],delete g["!legacy"]}f["!id"].rId1&&nn(s,vV(a),r0(f))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+t,nn(s,a,NV(e.Strings,e)),i.strs.push(a),Un(e.wbrels,-1,"sharedStrings."+t,Sn.SST)),a="xl/workbook."+t,nn(s,a,tG(n)),i.workbooks.push(a),Un(e.rels,1,a,Sn.WB),a="xl/theme/theme1.xml",nn(s,a,VV(n.Themes,e)),i.themes.push(a),Un(e.wbrels,-1,"theme/theme1.xml",Sn.THEME),a="xl/styles."+t,nn(s,a,FV(n,e)),i.styles.push(a),Un(e.wbrels,-1,"styles."+t,Sn.STY),n.vbaraw&&r&&(a="xl/vbaProject.bin",nn(s,a,n.vbaraw),i.vba.push(a),Un(e.wbrels,-1,"vbaProject.bin",Sn.VBA)),a="xl/metadata."+t,nn(s,a,GV()),i.metadata.push(a),Un(e.wbrels,-1,"metadata."+t,Sn.XLMETA),h.length>1&&(a="xl/persons/person.xml",nn(s,a,V1e(h)),i.people.push(a),Un(e.wbrels,-1,"persons/person.xml",Sn.PEOPLE)),nn(s,"[Content_Types].xml",xV(i,e)),nn(s,"_rels/.rels",r0(e.rels)),nn(s,"xl/_rels/workbook."+t+".rels",r0(e.wbrels)),delete e.revssf,delete e.ssf,s}function lwe(n,e){var t="";switch((e||{}).type||"base64"){case"buffer":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];case"base64":t=Kl(n.slice(0,12));break;case"binary":t=n;break;case"array":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function lG(n,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return k1(e.file,Yn.write(n,{type:Rn?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Yn.write(n,e)}function cwe(n,e){var t=ks(e||{}),r=swe(n,t);return uwe(r,t)}function uwe(n,e){var t={},r=Rn?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(t.compression="DEFLATE"),e.password)t.type=r;else switch(e.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":t.type=r;break;default:throw new Error("Unrecognized type "+e.type)}var i=n.FullPaths?Yn.write(n,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!e.compression}):n.generate(t);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(Uw(i))}return e.password&&typeof encrypt_agile<"u"?lG(encrypt_agile(i,e.password),e):e.type==="file"?k1(e.file,i):e.type=="string"?jm(i):i}function hwe(n,e){var t=e||{},r=Ave(n,t);return lG(r,t)}function Co(n,e,t){t||(t="");var r=t+n;switch(e.type){case"base64":return kp(Np(r));case"binary":return Np(r);case"string":return n;case"file":return k1(e.file,r,"utf8");case"buffer":return Rn?ec(r,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(r):Co(r,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function dwe(n,e){switch(e.type){case"base64":return kp(n);case"binary":return n;case"string":return n;case"file":return k1(e.file,n,"binary");case"buffer":return Rn?ec(n,"binary"):n.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function E_(n,e){switch(e.type){case"string":case"base64":case"binary":for(var t="",r=0;r<n.length;++r)t+=String.fromCharCode(n[r]);return e.type=="base64"?kp(t):e.type=="string"?jm(t):t;case"file":return k1(e.file,n);case"buffer":return n;default:throw new Error("Unrecognized type "+e.type)}}function cG(n,e){Gge(),Zxe(n);var t=ks(e||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var r=cG(n,t);return t.type="array",Uw(r)}var i=0;if(t.sheet&&(typeof t.sheet=="number"?i=t.sheet:i=n.SheetNames.indexOf(t.sheet),!n.SheetNames[i]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return Co(bve(n,t),t);case"slk":case"sylk":return Co(Ype.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"htm":case"html":return Co(iG(n.Sheets[n.SheetNames[i]],t),t);case"txt":return dwe(uG(n.Sheets[n.SheetNames[i]],t),t);case"csv":return Co(hC(n.Sheets[n.SheetNames[i]],t),t,"\uFEFF");case"dif":return Co(qpe.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"dbf":return E_(Kpe.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"prn":return Co(Xpe.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"rtf":return Co(r1e.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"eth":return Co(MV.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"fods":return Co(oG(n,t),t);case"wk1":return E_(SO.sheet_to_wk1(n.Sheets[n.SheetNames[i]],t),t);case"wk3":return E_(SO.book_to_wk3(n,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),E_(rG(n,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),hwe(n,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return cwe(n,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function fwe(n){if(!n.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=n.file.slice(n.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(n.bookType=t.slice(1)),n.bookType=e[n.bookType]||n.bookType}}function gwe(n,e,t){var r={};return r.type="file",r.file=e,fwe(r),cG(n,r)}function mwe(n,e,t,r,i,s,a,o){var l=ki(t),u=o.defval,h=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,g=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(g,"__rowNum__",{value:t,enumerable:!1})}catch{g.__rowNum__=t}else g.__rowNum__=t;if(!a||n[t])for(var y=e.s.c;y<=e.e.c;++y){var v=a?n[t][y]:n[r[y]+l];if(v===void 0||v.t===void 0){if(u===void 0)continue;s[y]!=null&&(g[s[y]]=u);continue}var x=v.v;switch(v.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(s[y]!=null){if(x==null)if(v.t=="e"&&x===null)g[s[y]]=null;else if(u!==void 0)g[s[y]]=u;else if(h&&x===null)g[s[y]]=null;else continue;else g[s[y]]=h&&(v.t!=="n"||v.t==="n"&&o.rawNumbers!==!1)?x:Yl(v,x,o);x!=null&&(f=!1)}}return{row:g,isempty:f}}function Iv(n,e){if(n==null||n["!ref"]==null)return[];var t={t:"n",v:0},r=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},u=e||{},h=u.range!=null?u.range:n["!ref"];switch(u.header===1?r=1:u.header==="A"?r=2:Array.isArray(u.header)?r=3:u.header==null&&(r=0),typeof h){case"string":l=cr(h);break;case"number":l=cr(n["!ref"]),l.s.r=h;break;default:l=h}r>0&&(i=0);var f=ki(l.s.r),g=[],y=[],v=0,x=0,E=Array.isArray(n),T=l.s.r,b=0,I={};E&&!n[T]&&(n[T]=[]);var M=u.skipHidden&&n["!cols"]||[],F=u.skipHidden&&n["!rows"]||[];for(b=l.s.c;b<=l.e.c;++b)if(!(M[b]||{}).hidden)switch(g[b]=Xi(b),t=E?n[T][b]:n[g[b]+f],r){case 1:s[b]=b-l.s.c;break;case 2:s[b]=g[b];break;case 3:s[b]=u.header[b-l.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),o=a=Yl(t,null,u),x=I[a]||0,!x)I[a]=1;else{do o=a+"_"+x++;while(I[o]);I[a]=x,I[o]=1}s[b]=o}for(T=l.s.r+i;T<=l.e.r;++T)if(!(F[T]||{}).hidden){var z=mwe(n,l,T,g,r,s,E,u);(z.isempty===!1||(r===1?u.blankrows!==!1:u.blankrows))&&(y[v++]=z.row)}return y.length=v,y}var kO=/"/g;function pwe(n,e,t,r,i,s,a,o){for(var l=!0,u=[],h="",f=ki(t),g=e.s.c;g<=e.e.c;++g)if(r[g]){var y=o.dense?(n[t]||[])[g]:n[r[g]+f];if(y==null)h="";else if(y.v!=null){l=!1,h=""+(o.rawNumbers&&y.t=="n"?y.v:Yl(y,null,o));for(var v=0,x=0;v!==h.length;++v)if((x=h.charCodeAt(v))===i||x===s||x===34||o.forceQuotes){h='"'+h.replace(kO,'""')+'"';break}h=="ID"&&(h='"ID"')}else y.f!=null&&!y.F?(l=!1,h="="+y.f,h.indexOf(",")>=0&&(h='"'+h.replace(kO,'""')+'"')):h="";u.push(h)}return o.blankrows===!1&&l?null:u.join(a)}function hC(n,e){var t=[],r=e??{};if(n==null||n["!ref"]==null)return"";var i=cr(n["!ref"]),s=r.FS!==void 0?r.FS:",",a=s.charCodeAt(0),o=r.RS!==void 0?r.RS:`
`,l=o.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),h="",f=[];r.dense=Array.isArray(n);for(var g=r.skipHidden&&n["!cols"]||[],y=r.skipHidden&&n["!rows"]||[],v=i.s.c;v<=i.e.c;++v)(g[v]||{}).hidden||(f[v]=Xi(v));for(var x=0,E=i.s.r;E<=i.e.r;++E)(y[E]||{}).hidden||(h=pwe(n,i,E,f,a,l,s,r),h!=null&&(r.strip&&(h=h.replace(u,"")),(h||r.blankrows!==!1)&&t.push((x++?o:"")+h)));return delete r.dense,t.join("")}function uG(n,e){e||(e={}),e.FS="	",e.RS=`
`;var t=hC(n,e);return t}function ywe(n){var e="",t,r="";if(n==null||n["!ref"]==null)return[];var i=cr(n["!ref"]),s="",a=[],o,l=[],u=Array.isArray(n);for(o=i.s.c;o<=i.e.c;++o)a[o]=Xi(o);for(var h=i.s.r;h<=i.e.r;++h)for(s=ki(h),o=i.s.c;o<=i.e.c;++o)if(e=a[o]+s,t=u?(n[h]||[])[o]:n[e],r="",t!==void 0){if(t.F!=null){if(e=t.F,!t.f)continue;r=t.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(t.f!=null)r=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)r=""+t.v;else if(t.t=="b")r=t.v?"TRUE":"FALSE";else if(t.w!==void 0)r="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?r="'"+t.v:r=""+t.v}}l[l.length]=e+"="+r}return l}function hG(n,e,t){var r=t||{},i=+!r.skipHeader,s=n||{},a=0,o=0;if(s&&r.origin!=null)if(typeof r.origin=="number")a=r.origin;else{var l=typeof r.origin=="string"?gi(r.origin):r.origin;a=l.r,o=l.c}var u,h={s:{c:0,r:0},e:{c:o,r:a+e.length-1+i}};if(s["!ref"]){var f=cr(s["!ref"]);h.e.c=Math.max(h.e.c,f.e.c),h.e.r=Math.max(h.e.r,f.e.r),a==-1&&(a=f.e.r+1,h.e.r=a+e.length-1+i)}else a==-1&&(a=0,h.e.r=e.length-1+i);var g=r.header||[],y=0;e.forEach(function(x,E){Mi(x).forEach(function(T){(y=g.indexOf(T))==-1&&(g[y=g.length]=T);var b=x[T],I="z",M="",F=Kn({c:o+y,r:a+E+i});u=Dp(s,F),b&&typeof b=="object"&&!(b instanceof Date)?s[F]=b:(typeof b=="number"?I="n":typeof b=="boolean"?I="b":typeof b=="string"?I="s":b instanceof Date?(I="d",r.cellDates||(I="n",b=Ps(b)),M=r.dateNF||Cr[14]):b===null&&r.nullError&&(I="e",b=0),u?(u.t=I,u.v=b,delete u.w,delete u.R,M&&(u.z=M)):s[F]=u={t:I,v:b},M&&(u.z=M))})}),h.e.c=Math.max(h.e.c,o+g.length-1);var v=ki(a);if(i)for(y=0;y<g.length;++y)s[Xi(y+o)+v]={t:"s",v:g[y]};return s["!ref"]=Kr(h),s}function _we(n,e){return hG(null,n,e)}function Dp(n,e,t){if(typeof e=="string"){if(Array.isArray(n)){var r=gi(e);return n[r.r]||(n[r.r]=[]),n[r.r][r.c]||(n[r.r][r.c]={t:"z"})}return n[e]||(n[e]={t:"z"})}return typeof e!="number"?Dp(n,Kn(e)):Dp(n,Kn({r:e,c:t||0}))}function xwe(n,e){if(typeof e=="number"){if(e>=0&&n.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var t=n.SheetNames.indexOf(e);if(t>-1)return t;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function vwe(){return{SheetNames:[],Sheets:{}}}function wwe(n,e,t,r){var i=1;if(!t)for(;i<=65535&&n.SheetNames.indexOf(t="Sheet"+i)!=-1;++i,t=void 0);if(!t||n.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&n.SheetNames.indexOf(t)>=0){var s=t.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||t;for(++i;i<=65535&&n.SheetNames.indexOf(t=a+i)!=-1;++i);}if(eG(t),n.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return n.SheetNames.push(t),n.Sheets[t]=e,t}function Ewe(n,e,t){n.Workbook||(n.Workbook={}),n.Workbook.Sheets||(n.Workbook.Sheets=[]);var r=xwe(n,e);switch(n.Workbook.Sheets[r]||(n.Workbook.Sheets[r]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}n.Workbook.Sheets[r].Hidden=t}function Swe(n,e){return n.z=e,n}function dG(n,e,t){return e?(n.l={Target:e},t&&(n.l.Tooltip=t)):delete n.l,n}function Twe(n,e,t){return dG(n,"#"+e,t)}function bwe(n,e,t){n.c||(n.c=[]),n.c.push({t:e,a:t||"SheetJS"})}function Iwe(n,e,t,r){for(var i=typeof e!="string"?e:cr(e),s=typeof e=="string"?e:Kr(e),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=Dp(n,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=t,r&&(l.D=!0))}return n}var HS={encode_col:Xi,encode_row:ki,encode_cell:Kn,encode_range:Kr,decode_col:eC,decode_row:JR,split_cell:Gme,decode_cell:gi,decode_range:ra,format_cell:Yl,sheet_add_aoa:dV,sheet_add_json:hG,sheet_add_dom:sG,aoa_to_sheet:K0,json_to_sheet:_we,table_to_sheet:aG,table_to_book:qve,sheet_to_csv:hC,sheet_to_txt:uG,sheet_to_json:Iv,sheet_to_html:iG,sheet_to_formulae:ywe,sheet_to_row_object_array:Iv,sheet_get_cell:Dp,book_new:vwe,book_append_sheet:wwe,book_set_sheet_visibility:Ewe,cell_set_number_format:Swe,cell_set_hyperlink:dG,cell_set_internal_link:Twe,cell_add_comment:bwe,sheet_set_array_formula:Iwe,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const $o=Ra()(B0((n,e)=>({vondsten:[],addVondst:t=>n(r=>({vondsten:[...r.vondsten,{...t,id:crypto.randomUUID(),timestamp:new Date().toISOString()}]})),removeVondst:t=>n(r=>({vondsten:r.vondsten.filter(i=>i.id!==t)})),updateVondst:(t,r)=>n(i=>({vondsten:i.vondsten.map(s=>s.id===t?{...s,...r}:s)})),clearAll:()=>n({vondsten:[]}),exportAsGeoJSON:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const r={type:"FeatureCollection",features:t.map(o=>({type:"Feature",geometry:{type:"Point",coordinates:[o.location.lng,o.location.lat]},properties:{id:o.id,objectType:o.objectType,material:o.material,period:o.period,depth:o.depth,notes:o.notes,timestamp:o.timestamp,photoUrl:o.photoUrl,condition:o.condition,weight:o.weight,length:o.length}}))},i=new Blob([JSON.stringify(r,null,2)],{type:"application/json"}),s=URL.createObjectURL(i),a=document.createElement("a");a.href=s,a.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.geojson`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(s)},exportAsCSV:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const r=`ID,Latitude,Longitude,Datum,Type,Materiaal,Periode,Diepte (cm),Conditie,Gewicht (g),Lengte (mm),Notities,Foto URL
`,i=t.map(u=>{const h=new Date(u.timestamp).toLocaleDateString("nl-NL"),f=u.notes?`"${u.notes.replace(/"/g,'""')}"`:"";return`${u.id},${u.location.lat},${u.location.lng},${h},${u.objectType},${u.material},${u.period},${u.depth||""},${u.condition||""},${u.weight||""},${u.length||""},${f},${u.photoUrl||""}`}).join(`
`),s=r+i,a=new Blob([s],{type:"text/csv;charset=utf-8;"}),o=URL.createObjectURL(a),l=document.createElement("a");l.href=o,l.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(o)},exportAsExcel:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const r=t.map(o=>({ID:o.id,Latitude:o.location.lat,Longitude:o.location.lng,Datum:new Date(o.timestamp).toLocaleDateString("nl-NL"),Type:o.objectType,Materiaal:o.material,Periode:o.period,"Diepte (cm)":o.depth||"",Conditie:o.condition||"","Gewicht (g)":o.weight||"","Lengte (mm)":o.length||"",Notities:o.notes||"","Foto URL":o.photoUrl||""})),i=HS.json_to_sheet(r),s=HS.book_new();HS.book_append_sheet(s,i,"Vondsten");const a=[{wch:36},{wch:12},{wch:12},{wch:12},{wch:15},{wch:12},{wch:25},{wch:12},{wch:12},{wch:12},{wch:12},{wch:40},{wch:50}];i["!cols"]=a,gwe(s,`mijn-vondsten-${new Date().toISOString().split("T")[0]}.xlsx`)},exportAsGPX:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const r=t.map(l=>{const u=new Date(l.timestamp).toISOString();return`  <wpt lat="${l.location.lat}" lon="${l.location.lng}">
    <name>${l.objectType} - ${l.material}</name>
    <desc>${l.period}${l.depth?`, ${l.depth}cm diep`:""}${l.condition&&l.condition!=="Onbekend"?`, ${l.condition}`:""}${l.weight?`, ${l.weight}g`:""}${l.length?`, ${l.length}mm`:""}${l.notes?`. ${l.notes}`:""}</desc>
    <time>${u}</time>
    <sym>Pin</sym>
  </wpt>`}).join(`
`),i=`<?xml version="1.0" encoding="UTF-8"?>
<gpx version="1.1" creator="DetectorApp NL" xmlns="http://www.topografix.com/GPX/1/1">
  <metadata>
    <name>Mijn Vondsten</name>
    <desc>Geexporteerd uit DetectorApp NL</desc>
    <time>${new Date().toISOString()}</time>
  </metadata>
${r}
</gpx>`,s=new Blob([i],{type:"application/gpx+xml"}),a=URL.createObjectURL(s),o=document.createElement("a");o.href=a,o.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.gpx`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(a)},exportAsKML:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const i=`<?xml version="1.0" encoding="UTF-8"?>
<kml xmlns="http://www.opengis.net/kml/2.2">
  <Document>
    <name>Mijn Vondsten</name>
    <description>Geexporteerd uit DetectorApp NL</description>
${t.map(l=>{const u=new Date(l.timestamp).toLocaleDateString("nl-NL"),h=`<![CDATA[
            <b>Type:</b> ${l.objectType}<br/>
            <b>Materiaal:</b> ${l.material}<br/>
            <b>Periode:</b> ${l.period}<br/>
            ${l.depth?`<b>Diepte:</b> ${l.depth} cm<br/>`:""}
            ${l.condition&&l.condition!=="Onbekend"?`<b>Conditie:</b> ${l.condition}<br/>`:""}
            ${l.weight?`<b>Gewicht:</b> ${l.weight} gram<br/>`:""}
            ${l.length?`<b>Lengte:</b> ${l.length} mm<br/>`:""}
            <b>Datum:</b> ${u}<br/>
            ${l.notes?`<b>Notities:</b> ${l.notes}<br/>`:""}
            ${l.photoUrl?`<a href="${l.photoUrl}">Bekijk foto</a>`:""}
          ]]>`;return`    <Placemark>
      <name>${l.objectType} - ${l.material}</name>
      <description>${h}</description>
      <Point>
        <coordinates>${l.location.lng},${l.location.lat},0</coordinates>
      </Point>
    </Placemark>`}).join(`
`)}
  </Document>
</kml>`,s=new Blob([i],{type:"application/vnd.google-earth.kml+xml"}),a=URL.createObjectURL(s),o=document.createElement("a");o.href=a,o.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.kml`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(a)}}),{name:"detectorapp-local-vondsten"})),Awe={Fectio:{naam:"Fectio",latinNaam:"Fectio",type:"castellum",periode:"4/5 n.Chr. - ca. 270 n.Chr.",beschrijving:"Fectio was een van de belangrijkste Romeinse legerbases in Nederland. Het fort lag bij de splitsing van de Rijn en de Vecht, een strategisch punt.",watWasHier:"Hier was een groot castellum (legerplaats) met ruimte voor ongeveer 500 soldaten. Er waren barakken, een badhuis, een hospitaal en pakhuizen. Buiten het fort woonden handelaren en families van soldaten.",watTeZien:"Archeologisch Park Castellum Hoge Woerd toont de contouren van het fort. In het museum zijn veel vondsten te zien, waaronder een Romeins schip.",verwachteVondsten:"Munten, fibulae (mantelspelden), aardewerk, wapens, paardentuig, en militaire uitrusting. Door de natte bodem zijn hier ook organische materialen zoals leer en hout bewaard.",betekenis:"Fectio was onderdeel van de Limes, de noordgrens van het Romeinse Rijk. Vanaf hier werden troepen en goederen vervoerd over de Rijn.",bronnen:["https://www.hogewoerd.nl","https://www.livius.org/articles/place/fectio-vechten/"]},Traiectum:{naam:"Traiectum",latinNaam:"Traiectum",type:"castellum",periode:"47 n.Chr. - ca. 270 n.Chr.",beschrijving:'Traiectum is het huidige Utrecht. De naam betekent "oversteekplaats". Hier stak een belangrijke weg de Rijn over.',watWasHier:"Een klein castellum met een bezetting van enkele honderden soldaten. Het fort bewaakte de oversteek van de Rijn. Er was een brug of veerpont.",watTeZien:"De Domkerk staat deels op de fundamenten van het Romeinse fort. In het Centraal Museum zijn Romeinse vondsten te zien. Onder het Domplein zijn resten gevonden.",verwachteVondsten:"Munten, sieraden, aardewerk, bouwmateriaal (tegels, bakstenen), en offers aan de rivier. Bij de brug werden vaak munten geofferd.",betekenis:"Traiectum was een belangrijk knooppunt waar de landweg de rivier kruiste. Later groeide het uit tot de stad Utrecht.",bronnen:["https://www.livius.org/articles/place/traiectum-utrecht/"]},Laurum:{naam:"Laurum",latinNaam:"Laurum",type:"castellum",periode:"ca. 40 n.Chr. - ca. 270 n.Chr.",beschrijving:"Laurum lag in het huidige Woerden. Het was een middelgroot fort aan de Rijn.",watWasHier:"Een castellum met ruimte voor ongeveer 500 soldaten. Er zijn resten gevonden van houten barakken, een badhuis en pakhuizen. Buiten het fort lag een vicus (burgerdorp).",watTeZien:"In het Stadsmuseum Woerden zijn vondsten te zien, waaronder een bijzondere Romeinse boot. De contouren van het fort zijn in het stratenpatroon te herkennen.",verwachteVondsten:"Militaria, aardewerk, munten, en schrijfplankjes. Door de natte veengrond zijn ook houten voorwerpen en leren schoenen bewaard gebleven.",betekenis:"Laurum toont hoe de Romeinen in het veengebied bouwden. De soldaten moesten constant vechten tegen het water.",bronnen:["https://www.castellumwoerden.nl"]},"Castellum Praetorium Agrippinae":{naam:"Praetorium Agrippinae",latinNaam:"Praetorium Agrippinae",type:"castellum",periode:"40 n.Chr. - ca. 270 n.Chr.",beschrijving:"Dit fort lag in Valkenburg (ZH). De naam verwijst naar Agrippina, de moeder van keizer Nero.",watWasHier:"Een middelgroot castellum met barakken voor hulptroepen. Er waren ook werkplaatsen en opslagruimtes. Het fort werd meerdere keren herbouwd na overstromingen.",watTeZien:"Het Archeologisch Steunpunt Valkenburg toont de geschiedenis. Delen van het fort zijn opgegraven en worden beschermd.",verwachteVondsten:"Militaire uitrusting, aardewerk uit het Rijnland en Galli, munten, en bouwmateriaal. Hier zijn ook inscripties gevonden.",betekenis:"Een van de best onderzochte forten aan de Rijn. Geeft veel informatie over het dagelijks leven van Romeinse soldaten.",bronnen:["https://www.livius.org/articles/place/praetorium-agrippinae-valkenburg/"]},"Castra Hunnerberg":{naam:"Castra Hunnerberg",latinNaam:"Castra",type:"legerkamp",periode:"19 v.Chr. - ca. 70 n.Chr.",beschrijving:"Op de Hunnerberg bij Nijmegen lag een groot legerkamp. Hier waren tijdelijk twee volledige legioenen (10.000 soldaten) gestationeerd.",watWasHier:"Een enorm legerkamp van 42 hectare, een van de grootste ten noorden van de Alpen. Hier werden veldtochten naar Germani voorbereid.",watTeZien:"Op de Hunnerberg zijn de wallen nog zichtbaar in het landschap. Het Museum Het Valkhof toont veel vondsten.",verwachteVondsten:"Militaire uitrusting van hoge kwaliteit, munten van Augustus en Tiberius, legioenstempels op dakpannen, en resten van wapens.",betekenis:"Dit was de belangrijkste legerbasis in het vroege Romeinse Nederland. Vanaf hier werden de oorlogen tegen de Germanen gevoerd.",bronnen:["https://www.livius.org/articles/place/noviomagus-nijmegen-hunnerberg/"]},"Castellum Kops Plateau":{naam:"Kops Plateau",latinNaam:"Oppidum Batavorum",type:"castellum",periode:"ca. 10 v.Chr. - 70 n.Chr.",beschrijving:"Op het Kops Plateau in Nijmegen lag een vroege militaire basis, later de hoofdstad van de Bataven.",watWasHier:"Eerst een Romeins kamp, later de civiele hoofdstad Oppidum Batavorum. Hier woonden Romeinen en Bataven samen.",watTeZien:"Het Kops Plateau is nu een natuurgebied. Opgravingen hebben veel informatie opgeleverd. Museum Het Valkhof toont de vondsten.",verwachteVondsten:"Vroege Romeinse militaria, Keltisch-Bataafse voorwerpen, importaardewerk, en munten uit de tijd van Augustus.",betekenis:"Dit was het eerste contactpunt tussen Romeinen en Bataven. Hier begon de romanisering van Nederland.",bronnen:["https://www.livius.org/articles/place/noviomagus-nijmegen-kops-plateau/"]},"Nijmegen, Valkhof":{naam:"Valkhof Nijmegen",latinNaam:"Valkhof",type:"versterking",periode:"ca. 270 n.Chr. - 400 n.Chr.",beschrijving:"Op het Valkhof stond een laat-Romeinse versterking. Later bouwde Karel de Grote hier een palts.",watWasHier:"Een versterkte positie uit de tijd dat het Romeinse Rijk onder druk stond. De soldaten bewaakten de Waaloever.",watTeZien:"Het Valkhofpark met de Sint-Nicolaaskapel (deels Karolingisch). Museum Het Valkhof toont de geschiedenis.",verwachteVondsten:"Laat-Romeinse munten, gordeltjes en riemtongen, aardewerk uit de 3e en 4e eeuw, en militaire gespen.",betekenis:"Toont de overgang van het Romeinse Rijk naar de vroege middeleeuwen. Nijmegen bleef een belangrijk centrum.",bronnen:["https://www.museumhetvalkhof.nl"]},"Castellum Op de Hoge Woerd":{naam:"Hoge Woerd",latinNaam:"Castellum",type:"castellum",periode:"ca. 50 n.Chr. - 270 n.Chr.",beschrijving:"Dit fort lag in Leidsche Rijn bij Utrecht. Het is nu een archeologisch park.",watWasHier:"Een middengroot castellum met houten gebouwen. Buiten de muren lag een burgerdorp. Hier is een compleet Romeins schip gevonden.",watTeZien:"Archeologisch Park Castellum Hoge Woerd met de reconstructie van het fort en een museum. Je kunt over de fundamenten lopen.",verwachteVondsten:"Militaire uitrusting, scheepsonderdelen, aardewerk, munten, en door de natte grond ook organisch materiaal.",betekenis:"Een van de best bewaarde en gepresenteerde Romeinse forten in Nederland. Ideaal om te zien hoe een fort eruitzag.",bronnen:["https://www.hogewoerd.nl"]},Lugdunum:{naam:"Lugdunum Batavorum",latinNaam:"Lugdunum Batavorum",type:"castellum",periode:"ca. 40 n.Chr. - 270 n.Chr.",beschrijving:"Lugdunum lag in Katwijk, aan de monding van de Rijn in zee. Het was het westelijkste fort van de Limes.",watWasHier:"Een castellum dat de riviermonding bewaakte. Hier eindigde de Rijn en begon de zee. Er was ook een vuurtoren.",watTeZien:"Het fort is door de zee weggespoeld. In het Rijksmuseum van Oudheden in Leiden zijn vondsten te zien.",verwachteVondsten:"Op het strand worden soms voorwerpen gevonden na stormen. Munten, aardewerk en militaria.",betekenis:"Het westelijke eindpunt van de Limes. Hier begonnen zeereizen naar Britannia.",bronnen:["https://www.livius.org/articles/place/lugdunum-batavorum-katwijk/"]},"Vlootbasis Naaldwijk":{naam:"Vlootbasis Naaldwijk",type:"vlootbasis",periode:"1e eeuw n.Chr.",beschrijving:"Bij Naaldwijk lag mogelijk een basis voor de Romeinse vloot (Classis Germanica).",watWasHier:"Een haven met schepen die langs de kust patrouilleerden en troepen naar Britannia vervoerden.",watTeZien:"Het gebied is nu landbouwgrond. Vondsten zijn in lokale musea te zien.",verwachteVondsten:"Scheepsonderdelen, ankers, militaire uitrusting voor mariniers, importaardewerk.",betekenis:"Toont het belang van de Romeinse vloot voor de verdediging van de kust.",bronnen:[]},"Minifort Ockenburg":{naam:"Minifort Ockenburg",type:"minifort",periode:"ca. 150 n.Chr.",beschrijving:"Bij Ockenburg in Den Haag stond een klein Romeins fortje dat de kust bewaakte.",watWasHier:"Een kleine wachtpost met ruimte voor een handvol soldaten. Het lag op een strandwal.",watTeZien:"Het terrein is beschermd maar niet toegankelijk. Vondsten zijn in het Haags Historisch Museum.",verwachteVondsten:"Kleine hoeveelheden militaria, aardewerk, en munten.",betekenis:"Toont dat de Romeinen ook de kust bewaakten, niet alleen de rivieren.",bronnen:[]},"Castellum Ceuclum":{naam:"Ceuclum",latinNaam:"Ceuclum",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Ceuclum lag bij Cuijk aan de Maas. Het bewaakte een brug over de rivier.",watWasHier:"Een middelgroot castellum bij een belangrijke rivierovergang. De weg naar het noorden liep hier.",watTeZien:"In Cuijk zijn restanten gevonden. Het Maasmuseum toont lokale vondsten.",verwachteVondsten:"Munten, fibulae, aardewerk, en materiaal gerelateerd aan de brug.",betekenis:"Een belangrijke schakel in het Romeinse wegennet langs de Maas.",bronnen:["https://www.livius.org/articles/place/ceuclum-cuijk/"]},"Castellum Meinerswijk":{naam:"Meinerswijk",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Bij Arnhem-Meinerswijk lag een Romeins fort aan de Rijn.",watWasHier:"Een castellum dat de rivierroute bewaakte. Het lag in de uiterwaarden.",watTeZien:"Het terrein is nu natuurgebied. Vondsten zijn in Museum Arnhem te zien.",verwachteVondsten:"Militaria, aardewerk, munten, en scheepsresten.",betekenis:"Onderdeel van de keten van forten langs de Rijn.",bronnen:[]},Levefanum:{naam:"Levefanum",latinNaam:"Levefanum",type:"versterking",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Levefanum lag bij Wijk bij Duurstede, waar de Rijn splitste in de Lek en de Kromme Rijn.",watWasHier:"Een militaire post bij een strategische riviersplitsing. Mogelijk ook een haven.",watTeZien:"Het terrein is bebouwd. Dorestad Museum toont de latere geschiedenis van deze plek.",verwachteVondsten:"Munten, aardewerk, militaria, en handelsproducten.",betekenis:"Een belangrijk controlepunt voor het scheepvaartverkeer.",bronnen:[]},"Nigrum Pullum":{naam:"Nigrum Pullum",latinNaam:"Nigrum Pullum",type:"minifort",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Nigrum Pullum (Zwarte Poel) lag bij Zwammerdam. Het was een klein fortje in het veengebied.",watWasHier:"Een klein fort met pakhuizen. Er zijn meerdere Romeinse schepen gevonden.",watTeZien:"De schepen zijn in het Rijksmuseum van Oudheden in Leiden. Het terrein zelf is niet te bezoeken.",verwachteVondsten:"Scheepsonderdelen, bouwmaterialen, aardewerk, en door de natte grond organisch materiaal.",betekenis:"Beroemd om de goed bewaarde Romeinse schepen. Toont transport over water.",bronnen:["https://www.rmo.nl"]},"Stenen wachttoren Vleuterweide":{naam:"Wachttoren Vleuterweide",type:"wachttoren",periode:"ca. 150 n.Chr.",beschrijving:"In Vleuterweide bij Utrecht stond een stenen wachttoren. Dit was ongebruikelijk - de meeste waren van hout.",watWasHier:"Een versterkte toren met uitzicht over de omgeving. Mogelijk woonden hier ook families van soldaten.",watTeZien:"De fundamenten zijn gemarkeerd in de wijk. Vondsten zijn in het Centraal Museum Utrecht.",verwachteVondsten:"Bouwmaterialen (dakpannen, stenen), aardewerk, en persoonlijke bezittingen.",betekenis:"Een van de weinige bekende stenen wachttorens. Toont variatie in Romeinse bouwwijzen.",bronnen:[]},"Wachttoren Bunnik":{naam:"Wachttoren Bunnik",type:"wachttoren",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Bij Bunnik stond een houten wachttoren aan de Rijn.",watWasHier:"Een uitkijkpost waar soldaten de rivier in de gaten hielden en signalen doorgaven.",watTeZien:"De exacte locatie is niet precies bekend. Het gebied is nu bebouwd.",verwachteVondsten:"Kleine hoeveelheden militaria en aardewerk.",betekenis:"Onderdeel van het signaleringssysteem langs de Limes.",bronnen:[]},"Castellum Maastricht":{naam:"Castellum Maastricht",latinNaam:"Mosae Trajectum",type:"versterking",periode:"3e - 4e eeuw n.Chr.",beschrijving:"In het centrum van Maastricht stond een laat-Romeinse versterking bij de brug over de Maas.",watWasHier:"Een verdedigingswerk uit de tijd dat het Rijk onder druk stond. Het bewaakte de rivierovergang.",watTeZien:"Onder het Vrijthof zijn resten gevonden. Centre Ceramique toont de Romeinse geschiedenis.",verwachteVondsten:"Laat-Romeinse munten, militaire riembeslag, aardewerk, en bouwmaterialen.",betekenis:"Toont de continuiteit - Maastricht bleef belangrijk van de Romeinse tijd tot nu.",bronnen:["https://www.centreceramique.nl"]},Roompot:{naam:"Roompot Fort",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Bij de Roompot in Zeeland lag een Romeins fort dat de zeeroute bewaakte.",watWasHier:"Een versterking aan de kust die schepen beschermde en piraterij teginging.",watTeZien:"Het fort is door de zee verzwolgen. Soms spoelen vondsten aan.",verwachteVondsten:"Door erosie kunnen munten en voorwerpen op het strand gevonden worden.",betekenis:"Toont dat de Romeinen ook de Zeeuwse wateren controleerden.",bronnen:[]},"Castellum Carvium":{naam:"Carvium",latinNaam:"Carvium",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Carvium lag bij Herwen, waar de Rijn en de Waal samenkwamen.",watWasHier:"Een fort bij een strategisch punt waar twee grote rivieren samenkwamen.",watTeZien:"Het gebied is nu natuurgebied. Vondsten zijn in Museum Het Valkhof in Nijmegen.",verwachteVondsten:"Militaria, aardewerk, munten, en scheepsresten.",betekenis:"Controleerde een belangrijk knooppunt van waterwegen.",bronnen:[]}},Rwe={naam:"Romeins fort",type:"versterking",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Een Romeinse militaire versterking langs de noordgrens van het Rijk.",watWasHier:"Een militaire post met soldaten die de grens bewaakten. Vaak was er ook een burgerdorp (vicus) in de buurt.",watTeZien:"De meeste forten zijn nu verdwenen of overbouwd. Lokale musea tonen vaak vondsten.",verwachteVondsten:"Munten, fibulae (mantelspelden), aardewerk, wapens en gereedschap.",betekenis:"Onderdeel van de Limes, de noordelijke grens van het Romeinse Rijk die door Nederland liep."},Cwe={castellum:"Castellum (legerplaats)",wachttoren:"Wachttoren (signaalpost)",vlootbasis:"Vlootbasis (haven)",legerkamp:"Legerkamp (castra)",minifort:"Minifort (wachtpost)",versterking:"Versterking",villa:"Villa (militair gebruikt)"};vn.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs");function Pwe(n){if(!n)return n;const e={Mo:"ma",Tu:"di",We:"wo",Th:"do",Fr:"vr",Sa:"za",Su:"zo",Mon:"ma",Tue:"di",Wed:"wo",Thu:"do",Fri:"vr",Sat:"za",Sun:"zo",PH:"feestdagen",SH:"schoolvakantie"};let t=n;return Object.entries(e).forEach(([r,i])=>{t=t.replace(new RegExp(`\\b${r}\\b`,"gi"),i)}),t=t.replace(/\boff\b/gi,"gesloten").replace(/\bclosed\b/gi,"gesloten").replace(/\bopen\b/gi,"open"),t}async function kwe(n){try{const e=xn(n),t=vn("EPSG:4326","EPSG:28992",e);if(t[0]<7e3||t[0]>3e5||t[1]<289e3||t[1]>629e3)return null;const r=1,s=`https://service.pdok.nl/rws/ahn/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=dtm_05m&QUERY_LAYERS=dtm_05m&INFO_FORMAT=application/json&CRS=EPSG:28992&BBOX=${`${t[0]-r},${t[1]-r},${t[0]+r},${t[1]+r}`}&WIDTH=1&HEIGHT=1&I=0&J=0`,o=await(await fetch(s)).json();if(o.features&&o.features.length>0){const l=o.features[0].properties,u=l?.value_list??l?.GRAY_INDEX??l?.value??l?.gray_index;if(u!=null){const h=typeof u=="number"?u:parseFloat(u);if(!isNaN(h))return h}}}catch(e){console.warn("AHN height query failed:",e)}return null}const Mwe={ABG:"Alphen-Chaam",ACM:"Alkmaar",ALF:"Alfen",ALK:"Alkemade",AML:"Ameland",AMR:"Amerongen",AMS:"Amsterdam",ANL:"Anloo",APD:"Apeldoorn",ARN:"Arnhem",ASN:"Assen",AVW:"Avenhorn",BDA:"Breda",BLK:"Blokker",BRN:"Barneveld",DEL:"Delft",DHG:"Den Haag",DRD:"Dordrecht",EHV:"Eindhoven",EMN:"Emmen",EPE:"Epe",GNP:"Gennep",GRN:"Groningen",GRV:"Grave",GTB:"Giethoorn",HDK:"Harderwijk",HLM:"Haarlem",HLN:"Heiloo",HRL:"Harlingen",HTN:"Houten",LDN:"Leiden",LWR:"Leeuwarden",MST:"Maastricht",NKK:"Nijkerk",NMG:"Nijmegen",OTM:"Ootmarsum",RTD:"Rotterdam",SND:"Sneek",TBG:"Tilburg",UTR:"Utrecht",VLO:"Venlo",WGN:"Wageningen",ZWL:"Zwolle",ZTP:"Zutphen",444:"Houten",811:"Gouda",310:"Utrecht",344:"Amsterdam",363:"Rotterdam",518:"Den Haag",758:"Eindhoven",772:"Tilburg",855:"Breda",85:"Arnhem",268:"Nijmegen",14:"Groningen",80:"Leeuwarden",995:"Maastricht",106:"Enschede",153:"Zwolle",34:"Almere"},Nwe={1:"Zeer lage trefkans op archeologische resten",2:"Lage trefkans op archeologische resten",3:"Middelhoge trefkans op archeologische resten",4:"Hoge trefkans op archeologische resten",5:"Lage trefkans (water)",6:"Middelhoge trefkans (water)",7:"Hoge trefkans (water)",8:"Water",9:"Niet gekarteerd"};function MO(n,e){const t=[],r=n.toLowerCase(),i=(e||"").toLowerCase();return r.includes("kalkhoudend")||i.endsWith("a")?t.push("Kalkhoudend = goede metaalconservering"):(r.includes("kalkarm")||r.includes("kalkloos"))&&t.push("Kalkarm = meer corrosie op metalen"),r.includes("poldervaag")?t.push("Poldervaaggrond = jonge rivierklei, ingepolderd gebied"):r.includes("enkeerdgrond")||r.includes("enk")?t.push("Enkeerdgrond = oude akkers met plaggenbemesting - archeologisch interessant!"):r.includes("podzol")?t.push("Podzolgrond = uitgeloogde zandgrond, vaak zuur"):(r.includes("veengrond")||r.includes("veen"))&&t.push("Veengrond = zuur, slechte metaalconservering (tenzij waterverzadigd)"),r.includes("zware klei")?t.push("Zware klei = moeilijk graven, goede conservering"):r.includes("lichte klei")||r.includes("zavel")?t.push("Zavel/lichte klei = redelijk te graven"):r.includes("zand")&&!r.includes("zavel")&&t.push("Zandgrond = makkelijk graven"),r.includes("rivierklei")||i.startsWith("r")?t.push("Rivierafzetting"):(r.includes("zeeklei")||i.startsWith("m"))&&t.push("Zeekleiafzetting"),t}function Lwe(){const n=hs(gt=>gt.map),e=$o(gt=>gt.removeVondst),t=$o(gt=>gt.updateVondst),r=$o(gt=>gt.vondsten),{layers:i,addPoint:s,addLayer:a}=Yi(),[o,l]=ie.useState([]),[u,h]=ie.useState(0),[f,g]=ie.useState(!1),[y,v]=ie.useState(null),[x,E]=ie.useState(!1),[T,b]=ie.useState(!1),[I,M]=ie.useState(null),[F,z]=ie.useState(null),[k,C]=ie.useState(null),[P,L]=ie.useState(!1),[O,U]=ie.useState(null),[j,Ie]=ie.useState(null),[ke,ze]=ie.useState(null),[Ne,ce]=ie.useState(!1),[Te,Ee]=ie.useState(""),[se,V]=ie.useState([]),J=se[u]||null,[ne,X]=ie.useState(()=>{const gt=localStorage.getItem("popupTextScale");return gt?parseInt(gt):100}),ue=gt=>{X(gt),localStorage.setItem("popupTextScale",gt.toString())},Me=o[u]||"",je=o.length>1,De=gt=>{const jt=gt.match(/<strong[^>]*>(.*?)<\/strong>/);if(jt){const kn=jt[1].replace(/<[^>]+>/g,""),yt=gt.replace(jt[0],"").replace(/^(<br\s*\/?>)+/,"");return{title:kn,contentWithoutTitle:yt}}return{title:"",contentWithoutTitle:gt}},Be=gt=>gt.replace(/class="([^"]*)"/g,(kn,yt)=>{if(yt.includes("text-xs")){const Jt=yt.replace(/\btext-xs\b/g,"").trim();return Jt?`style="font-size:0.857em" class="${Jt}"`:'style="font-size:0.857em"'}if(yt.includes("text-sm")){const Jt=yt.replace(/\btext-sm\b/g,"").trim();return Jt?`class="${Jt}"`:""}return kn}).replace(/class=""/g,""),{title:Gt,contentWithoutTitle:Kt}=De(Me),wn=Be(Kt),Bt=Me.includes("Landbouwperceel"),Fn=Me.includes("data-vondst-id="),Qt=()=>{h(gt=>(gt-1+o.length)%o.length)},ot=()=>{h(gt=>(gt+1)%o.length)},Xn=async()=>{if(console.log(" HOOGTEKAART KNOP GEKLIKT"),console.log(" parcelCoordinate uit state:",y),!n||!y||T){console.log(" STOP - map:",!!n,"coord:",y,"loading:",T);return}console.log(` DOORGEVEN AAN showParcelHeightMap: [${y[0]}, ${y[1]}]`),b(!0);try{await Fge(n,y)&&E(!0)}catch(gt){console.error("Failed to load height map:",gt)}finally{b(!1)}},on=()=>{n&&(Vb(n),E(!1))};ie.useEffect(()=>{if(!n)return;const gt=yt=>{let Jt='<strong class="text-purple-800">AMK Monument</strong>';if(yt.toponiem&&(Jt+=`<br/><span class="text-sm font-semibold">${yt.toponiem}</span>`),yt.kwaliteitswaarde&&(Jt+=`<br/><span class="text-sm text-purple-700">${yt.kwaliteitswaarde}</span>`),yt.omschrijving&&(Jt+=`<br/><span class="text-xs text-gray-600 mt-1 block">${yt.omschrijving}</span>`),yt.txt_label){const Rt=yt.txt_label.split(", ").slice(0,3).join(", ");Jt+=`<br/><span class="text-xs text-gray-500 italic">${Rt}${yt.txt_label.split(", ").length>3?"...":""}</span>`}return Jt},jt=async(yt,Jt)=>{const Rt=[],rr=n.getLayers().getArray().filter(si=>si instanceof nh&&si.getVisible()?si.getSource()instanceof qW:!1);for(const si of rr){const Vr=si.getSource();if(!Vr)continue;const Ut=si.get("title")||"";if(Ut.startsWith("Paleokaart"))continue;if(Ut==="Archeo Landschappen"){try{const Oe=xn(yt),ve=vn("EPSG:4326","EPSG:28992",Oe),me=100,N=`https://services.rce.geovoorziening.nl/landschappenkaart/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=landschappenkaart_nl&QUERY_LAYERS=landschappenkaart_nl&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ve[0]-me},${ve[1]-me},${ve[0]+me},${ve[1]+me}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties,q=Z.landschapsnaam||Z.naam||"Archeologisch Landschap",le=Z.omschrijving||"";let he=`<strong class="text-green-800">${q}</strong>`;le&&(he+=`<br/><span class="text-sm text-gray-600">${le}</span>`),he+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',he+='<div class="text-sm text-gray-700 mt-1">Een archeologisch landschap is een gebied waar het landschap nog sporen draagt van menselijke activiteit uit het verleden. Denk aan oude akkers, nederzettingen of verdedigingswerken.</div>',he+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',he+='<div class="text-sm text-gray-700 mt-1">Aardewerk, munten, gereedschap en andere voorwerpen van vroegere bewoners. De kans op vondsten hangt af van het type landschap.</div>',he+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',he+='<div class="text-sm text-gray-700 mt-1"><a href="https://www.cultureelerfgoed.nl/onderwerpen/bronnen-en-kaarten/overzicht/landschappenkaart" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">RCE Landschappenkaart</a></div>',he+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Landschapstypen_van_Nederland" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia: Landschapstypen</a></div>',Rt.push(he)}}catch(Oe){console.warn("Archeo Landschappen WMS query failed:",Oe)}continue}if(Ut==="Essen"){try{const Oe=xn(yt),ve=vn("EPSG:4326","EPSG:28992",Oe),me=100,N=`https://services.rce.geovoorziening.nl/landschapsatlas/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=essen&QUERY_LAYERS=essen&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ve[0]-me},${ve[1]-me},${ve[0]+me},${ve[1]+me}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties;let q='<strong class="text-amber-800">Es (historisch akkercomplex)</strong>';(Z.naam||Z.Naam||Z.NAME)&&(q+=`<br/><span class="text-sm font-semibold text-amber-700">${Z.naam||Z.Naam||Z.NAME}</span>`),(Z.type||Z.Type||Z.TYPE)&&(q+=`<br/><span class="text-xs text-gray-600">${Z.type||Z.Type||Z.TYPE}</span>`),(Z.omschrijving||Z.Omschrijving)&&(q+=`<br/><span class="text-xs text-gray-500">${Z.omschrijving||Z.Omschrijving}</span>`),q+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is een es?</span></div>',q+='<div class="text-sm text-gray-700 mt-1">Een es is een oud akkercomplex op hogere zandgronden. Eeuwenlang werden hier gewassen verbouwd. De bodem werd bemest met plaggen en mest, waardoor de grond donker en vruchtbaar werd.</div>',q+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',q+='<div class="text-sm text-gray-700 mt-1">Munten, gespen, knopen, aardewerk en soms bijzondere voorwerpen die door bemesting op het land terechtkwamen. Essen behoren tot de beste vindplaatsen voor metaaldetectie.</div>',q+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Conservering</span></div>',q+='<div class="text-sm text-gray-700 mt-1 italic">De zure zandgrond tast metaal aan. IJzer en koper zijn vaak slecht bewaard. Zilver en brons houden zich beter.</div>',q+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',q+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Es_(geografie)" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia: Es (geografie)</a></div>',Rt.push(q)}}catch(Oe){console.warn("Essen WMS query failed:",Oe)}continue}if(Ut==="FAMKE Steentijd"){try{const Oe=xn(yt),ve=vn("EPSG:4326","EPSG:28992",Oe),me=100,N=`https://geoportaal.fryslan.nl/arcgis/services/Themas/cultuurhistorie/MapServer/WMSServer?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=FAMKE_Advies_steentijd-bronstijd3339&QUERY_LAYERS=FAMKE_Advies_steentijd-bronstijd3339&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ve[0]-me},${ve[1]-me},${ve[0]+me},${ve[1]+me}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties;let q='<strong class="text-amber-800">FAMKE Steentijd-Bronstijd</strong>';q+='<br/><span class="text-sm text-gray-500">Friese verwachtingskaart voor oude vondsten</span>';const le=Z.advies||Z.Advies||"";if(le){q+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat betekent dit?</span></div>',q+=`<div class="text-sm text-amber-700 mt-1">${le}</div>`;const he=le.toLowerCase();let Ve="",Se="text-gray-600",$e="";he.includes("karterend")?(Ve="Op deze plek verwachten archeologen vondsten uit de steentijd of bronstijd. Bij graafwerk moet er eerst onderzoek komen.",$e="Goede kans op oude vondsten (vuursteen, bijlen, aardewerk)",Se="text-amber-600"):he.includes("waarderend")?(Ve="Hier zijn mogelijk belangrijke vindplaatsen. Proefsleuven zijn nodig om te kijken wat er precies zit.",$e="Mogelijk interessante vondsten uit de prehistorie",Se="text-orange-600"):he.includes("geen")?(Ve="De kans op prehistorische vondsten is hier klein. De grond is waarschijnlijk te jong of te veel verstoord.",$e="Weinig kans op steentijd-vondsten",Se="text-green-600"):he.includes("quickscan")&&(Ve="Hier is eerst bureau-onderzoek nodig. Er kunnen vondsten zitten, maar dat is nog niet zeker.",$e="Onbekend, nader onderzoek nodig",Se="text-blue-600"),Ve&&(q+=`<div class="text-sm ${Se} mt-1">${Ve}</div>`),$e&&(q+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',q+=`<div class="text-sm text-gray-700 mt-1">${$e}</div>`),q+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is FAMKE?</span></div>',q+='<div class="text-sm text-gray-700 mt-1">FAMKE is de Friese Archeologische Monumentenkaart Extra. Deze kaart toont waar in Friesland vondsten uit de steentijd en bronstijd te verwachten zijn.</div>'}Rt.push(q)}}catch(Oe){console.warn("FAMKE WMS query failed:",Oe)}continue}if(Ut==="Archeo Onderzoeken"){try{const Oe=xn(yt),ve=vn("EPSG:4326","EPSG:28992",Oe),me=100,N=`https://data.geo.cultureelerfgoed.nl/openbaar/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=archeologische_onderzoeksmeldingen_openbaar_rd&QUERY_LAYERS=archeologische_onderzoeksmeldingen_openbaar_rd&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ve[0]-me},${ve[1]-me},${ve[0]+me},${ve[1]+me}`}&FEATURE_COUNT=20`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0)for(const Z of W.features){const q=Z.properties;let le='<strong class="text-blue-800">Archeologisch Onderzoek</strong>';const he=q.type_onderzoek||"";he&&(le+=`<br/><span class="text-sm font-semibold text-blue-700">${he}</span>`);const Ve=q.projectnaam||q.project_naam||q.naam||"";if(Ve&&(le+=`<br/><span class="text-sm text-gray-800">${Ve}</span>`),q.onderzoeksmeldingnummer&&(le+=`<br/><span class="text-xs text-gray-500 font-mono">OM: ${q.onderzoeksmeldingnummer}</span>`),q.uitvoerder&&(le+=`<br/><span class="text-sm text-gray-700">Uitvoerder: ${q.uitvoerder}</span>`),q.startdatum||q.einddatum){const $e=[q.startdatum,q.einddatum].filter(Boolean).join(" - ");le+=`<br/><span class="text-xs text-gray-600">Periode: ${$e}</span>`}q.gemeente&&(le+=`<br/><span class="text-xs text-gray-500">${q.gemeente}</span>`);const Se=[];if(q.periode_paleolithicum&&Se.push("Paleolithicum"),q.periode_mesolithicum&&Se.push("Mesolithicum"),q.periode_neolithicum&&Se.push("Neolithicum"),q.periode_bronstijd&&Se.push("Bronstijd"),q.periode_ijzertijd&&Se.push("IJzertijd"),q.periode_romeins&&Se.push("Romeins"),q.periode_middeleeuwen&&Se.push("Middeleeuwen"),q.periode_nieuwe_tijd&&Se.push("Nieuwe tijd"),Se.length>0&&(le+=`<br/><span class="text-sm text-purple-700">Datering: ${Se.join(", ")}</span>`),le+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat betekent dit?</span></div>',he.toLowerCase().includes("opgraving")?le+='<div class="text-sm text-gray-700 mt-1">Hier is een archeologische opgraving gedaan. Professionele archeologen hebben vondsten en sporen gedocumenteerd en geborgen.</div>':he.toLowerCase().includes("bureauonderzoek")?le+='<div class="text-sm text-gray-700 mt-1">Een bureauonderzoek naar de archeologische verwachting op basis van historische bronnen en kaarten.</div>':he.toLowerCase().includes("booronderzoek")?le+='<div class="text-sm text-gray-700 mt-1">Met boringen is onderzocht wat er in de grond zit. Vaak de eerste stap om te bepalen of er verder onderzoek nodig is.</div>':he.toLowerCase().includes("proefsleuven")?le+='<div class="text-sm text-gray-700 mt-1">Proefsleuven zijn gegraven om te kijken of er archeologische sporen in de grond zitten.</div>':he.toLowerCase().includes("begeleiding")?le+='<div class="text-sm text-gray-700 mt-1">Archeologische begeleiding bij graafwerk. Een archeoloog was aanwezig om te controleren of er vondsten naar boven kwamen.</div>':he.toLowerCase().includes("inventariserend")?le+='<div class="text-sm text-gray-700 mt-1">Verkennend onderzoek om te bepalen of er archeologische resten in de grond kunnen zitten.</div>':le+='<div class="text-sm text-gray-700 mt-1">Op deze locatie is archeologisch onderzoek uitgevoerd. De resultaten zijn opgeslagen in het landelijke archief.</div>',le+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Interessant voor detectie?</span></div>',le+='<div class="text-sm text-gray-700 mt-1 italic">Onderzoekslocaties kunnen interessant zijn: archeologen vinden vaak niet alles. Maar check altijd eerst of je daar mag zoeken.</div>',le+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Rapport opzoeken</span></div>',q.onderzoeksmeldingnummer){const $e=q.onderzoeksmeldingnummer;le+=`<div class="text-sm text-gray-700 mt-1"><a href="https://easy.dans.knaw.nl/ui/datasets?q=${encodeURIComponent($e)}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Zoek rapport in DANS-EASY</a></div>`,le+='<div class="text-sm text-gray-700 mt-1"><a href="https://archis.cultureelerfgoed.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Zoek in ARCHIS</a></div>'}le+='<div class="text-sm text-gray-700 mt-1"><a href="https://bibliotheek.cultureelerfgoed.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Bibliotheek voor Archeologie</a></div>',Rt.push(le)}}catch(Oe){console.warn("Archeo Onderzoeken WMS query failed:",Oe)}continue}if(Ut==="IKAW"){try{const Oe=xn(yt),ve=vn("EPSG:4326","EPSG:28992",Oe),me=500,N=`https://services.rce.geovoorziening.nl/ikaw/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=IKAW3Indicatievekaartarcheologischewaarden2008&QUERY_LAYERS=IKAW3Indicatievekaartarcheologischewaarden2008&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ve[0]-me},${ve[1]-me},${ve[0]+me},${ve[1]+me}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties,q=Math.round(Z.PALETTE_INDEX||Z.palette_index||0),le=Nwe[q]||`Trefkans onbekend (${q})`;let he='<strong class="text-orange-800">IKAW Verwachtingskaart</strong>';he+='<br/><span class="text-sm text-gray-500">Kaart met kansen op archeologische vondsten</span>',he+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat betekent dit?</span></div>',he+=`<div class="text-sm text-orange-700 mt-1">${le}</div>`;const Se={1:{tekst:"De kans op archeologische vondsten is hier zeer klein. De grond is waarschijnlijk verstoord of te jong.",vondsten:"Niet veel te verwachten, maar verrassingen zijn altijd mogelijk.",kleur:"text-gray-600"},2:{tekst:"De kans op vondsten is laag, maar niet uitgesloten. Soms worden hier toch interessante objecten gevonden.",vondsten:"Af en toe losse vondsten uit verschillende periodes.",kleur:"text-yellow-600"},3:{tekst:"Dit is een interessant gebied met een redelijke kans op vondsten. Hier woonden of werkten mensen in het verleden.",vondsten:"Aardewerk, munten, metalen voorwerpen uit verschillende tijdperken.",kleur:"text-amber-600"},4:{tekst:"Dit is een zeer kansrijk gebied! Hier zijn waarschijnlijk resten van oude bewoning of activiteit. Let op: bij graafwerk kan een vergunning nodig zijn.",vondsten:"Grote kans op interessante vondsten: aardewerk, munten, sieraden, gereedschap.",kleur:"text-orange-600"},5:{tekst:"Dit is een waterbodem. Vondsten zijn hier moeilijker te bereiken maar kunnen goed bewaard zijn gebleven.",vondsten:"Scheepswrakken, verloren lading, gedumpte voorwerpen.",kleur:"text-blue-600"},6:{tekst:"Waterbodem met archeologische potentie. Hier kunnen interessante vondsten liggen die door het water goed bewaard zijn.",vondsten:"Scheepsresten, ankers, aardewerk, metalen voorwerpen.",kleur:"text-blue-600"},7:{tekst:"Waterbodem met hoge archeologische waarde. Hier zijn bekende vindplaatsen of scheepswrakken.",vondsten:"Belangrijke maritieme vondsten, beschermd gebied.",kleur:"text-blue-700"}}[q];Se&&(he+=`<div class="text-sm ${Se.kleur} mt-1">${Se.tekst}</div>`,he+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',he+=`<div class="text-sm text-gray-700 mt-1">${Se.vondsten}</div>`),he+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is de IKAW?</span></div>',he+='<div class="text-sm text-gray-700 mt-1">De IKAW (Indicatieve Kaart Archeologische Waarden) toont de kans op archeologische vondsten in heel Nederland. De kaart is gemaakt door de Rijksdienst voor het Cultureel Erfgoed.</div>',Rt.push(he)}}catch(Oe){console.warn("IKAW WMS query failed:",Oe)}continue}if(Ut==="Inundatiegebieden"){try{const Oe=xn(yt),ve=vn("EPSG:4326","EPSG:28992",Oe),me=100,N=`https://services.rce.geovoorziening.nl/liniesenstellingen/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=inundaties&QUERY_LAYERS=inundaties&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ve[0]-me},${ve[1]-me},${ve[0]+me},${ve[1]+me}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties;let q='<strong class="text-blue-800">Inundatiegebied</strong>';(Z["linie-naam"]||Z.linie_naam)&&(q+=`<br/><span class="text-sm font-semibold text-blue-700">${Z["linie-naam"]||Z.linie_naam}</span>`),Z.naam&&(q+=`<br/><span class="text-sm text-gray-700">${Z.naam}</span>`),Z.periode&&(q+=`<br/><span class="text-xs text-gray-500">${Z.periode}</span>`),Z.lin_period&&(q+=`<br/><span class="text-xs text-gray-400">${Z.lin_period}</span>`),Rt.push(q)}}catch(Oe){console.warn("Inundatiegebieden WMS query failed:",Oe)}continue}if(Ut==="Militaire Objecten"){try{const Oe=xn(yt),ve=vn("EPSG:4326","EPSG:28992",Oe),me=50,N=`https://services.rce.geovoorziening.nl/liniesenstellingen/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=objecten&QUERY_LAYERS=objecten&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ve[0]-me},${ve[1]-me},${ve[0]+me},${ve[1]+me}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties,q=Z.obj_soort||"",le=Z.obj_naam||"",he=Z.lin_period||"",Ve=Z["linie-naam"]||Z.linie_naam||"";let Se=q||"Militair Object",$e="Dit is een historisch militair object uit de Nederlandse verdedigingsgeschiedenis.",et="";const dt=q.toLowerCase();dt.includes("fort")?($e="Een fort is een versterkte verdedigingspost, vaak met dikke muren en geschutsopstellingen. Forten maakten deel uit van grotere verdedigingslinies.",et="Rond forten worden soms kogels, knopen van uniformen, muntjes of andere militaire voorwerpen gevonden."):dt.includes("schans")?($e="Een schans is een kleinere versterking, vaak gemaakt van aarde en palissaden. Schansen werden gebruikt om strategische punten te verdedigen.",et="Bij schansen kun je musketkogels, knopen en soms munten uit de 17e-18e eeuw tegenkomen."):dt.includes("batterij")||dt.includes("battery")?($e="Een batterij is een geschutsopstelling, vaak op een strategische plek om vijanden onder vuur te nemen.",et="Bij batterijen worden soms kanonkogels of onderdelen van geschut gevonden."):dt.includes("bunker")||dt.includes("kazemat")?($e="Een bunker of kazemat is een versterkte betonnen schuilplaats. Veel werden gebouwd rond 1940 als onderdeel van verdedigingslinies.",et="Bij bunkers worden soms militaire voorwerpen uit WOII gevonden, zoals knopen, gespen of munitieresten."):dt.includes("sluis")||dt.includes("inlaatwerk")?($e="Militaire sluizen en inlaatwerken werden gebruikt om land onder water te zetten (inunderen). Dit was een belangrijke verdedigingstactiek.",et="Bij historische sluizen worden soms voorwerpen gevonden van soldaten die deze bewaakten."):dt.includes("toren")||dt.includes("wachttoren")?($e="Wachttorens werden gebruikt om de omgeving in de gaten te houden en vijandelijke bewegingen te signaleren.",et="Bij torens worden soms persoonlijke voorwerpen van soldaten gevonden."):dt.includes("kazerne")&&($e="Een kazerne is een gebouw waar soldaten gelegerd waren. Hier woonden, aten en oefenden de troepen.",et="Rond kazernes worden regelmatig knopen, gespen en andere persoonlijke voorwerpen gevonden.");let St=`<strong class="text-stone-800">${Se}</strong>`;le&&(St+=`<br/><span class="text-sm font-semibold text-stone-700">${le}</span>`),Ve&&(St+=`<br/><span class="text-sm text-blue-600">${Ve}</span>`),he&&(St+=`<br/><span class="text-xs text-gray-500">${he}</span>`),St+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',St+=`<div class="text-sm text-gray-700 mt-1">${$e}</div>`,et&&(St+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',St+=`<div class="text-sm text-gray-700 mt-1">${et}</div>`),St+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',St+='<div class="text-sm text-gray-700 mt-1">',St+='<a href="https://erfgoedenlocatie.nl/linies-en-stellingen" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">RCE Linies en Stellingen</a>',St+="</div>",Rt.push(St)}}catch(Oe){console.warn("Militaire Objecten WMS query failed:",Oe)}continue}if(Ut==="Verdedigingslinies"){try{const Oe=xn(yt),ve=vn("EPSG:4326","EPSG:28992",Oe),me=100,N=`https://services.rce.geovoorziening.nl/liniesenstellingen/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=linies&QUERY_LAYERS=linies&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ve[0]-me},${ve[1]-me},${ve[0]+me},${ve[1]+me}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties;let q='<strong class="text-amber-800">Verdedigingslinie</strong>';const le={"Hollandse Waterlinie":"Verdedigingsstelsel (1815-1940) dat gebruik maakte van inundaties om Holland te beschermen. UNESCO Werelderfgoed.","Nieuwe Hollandse Waterlinie":"Uitgebreide versie (1815-1940) met forten en inundatiegebieden van Muiden tot Gorinchem.","Stelling van Amsterdam":"Ringverdediging rond Amsterdam (1880-1920) met 42 forten. UNESCO Werelderfgoed.",Grebbelinie:"Verdedigingslinie langs de Grebbe (17e-20e eeuw). Zware gevechten in mei 1940.",IJssellinie:"Koude Oorlog verdediging (1950-1968) langs de IJssel tegen Sovjet-invasie.",Atlantikwall:"Duitse kustverdediging WOII (1942-1945) van Noorwegen tot Spanje.","Peel-Raamstelling":"Verdedigingslinie in Brabant/Limburg. Gevechten mei 1940.","Maas-Waalstelling":"Linie tussen Maas en Waal, onderdeel landsverdediging.",Zuiderwaterlinie:"Waterlinie in West-Brabant en Zeeland (17e-19e eeuw).","Staats-Spaanse Linies":"Vestingwerken uit de 80-jarige oorlog (1568-1648)."},he=Z.naam||Z.lin_naam||"";if(he){q+=`<br/><span class="text-sm font-semibold text-amber-700">${he}</span>`;const Ve=Object.entries(le).find(([Se])=>he.toLowerCase().includes(Se.toLowerCase())||Se.toLowerCase().includes(he.toLowerCase()));Ve&&(q+=`<br/><span class="text-sm text-gray-700">${Ve[1]}</span>`)}Z.lin_period&&(q+=`<br/><span class="text-xs text-purple-600">${Z.lin_period}</span>`),Z.status&&(q+=`<br/><span class="text-xs text-gray-400">${Z.status}</span>`),Rt.push(q)}}catch(Oe){console.warn("Verdedigingslinies WMS query failed:",Oe)}continue}if(Ut==="Rijksmonumenten"){try{const Oe=xn(yt),ve=vn("EPSG:4326","EPSG:28992",Oe),me=50,N=`https://data.geo.cultureelerfgoed.nl/openbaar/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=rijksmonumentpunten&QUERY_LAYERS=rijksmonumentpunten&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ve[0]-me},${ve[1]-me},${ve[0]+me},${ve[1]+me}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties;let q='<strong class="text-red-800">Rijksmonument</strong>';(Z.cbsNaam||Z.cbs_naam)&&(q+=`<br/><span class="text-sm font-semibold">${Z.cbsNaam||Z.cbs_naam}</span>`),Z.hoofdcategorie&&(q+=`<br/><span class="text-sm text-red-700">${Z.hoofdcategorie}</span>`),Z.subcategorie&&(q+=`<br/><span class="text-xs text-gray-600">${Z.subcategorie}</span>`),Z.rijksmonumentnummer&&(q+=`<br/><span class="text-xs text-gray-500">Nr: ${Z.rijksmonumentnummer}</span>`),(Z.bouwjaar||Z.oorspronkelijkebouwjaar)&&(q+=`<br/><span class="text-xs text-gray-500">Bouwjaar: ${Z.bouwjaar||Z.oorspronkelijkebouwjaar}</span>`),q+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',Z.rijksmonumentnummer&&(q+=`<div class="text-sm text-gray-700 mt-1"><a href="https://monumentenregister.cultureelerfgoed.nl/monumenten/${Z.rijksmonumentnummer}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Bekijk in Monumentenregister</a></div>`),q+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Rijksmonument" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia: Rijksmonument</a></div>',Rt.push(q)}}catch(Oe){console.warn("Rijksmonumenten WMS query failed:",Oe)}continue}if(Ut==="Werelderfgoed"){try{const Oe=xn(yt),ve=vn("EPSG:4326","EPSG:28992",Oe),me=500,N=`https://service.pdok.nl/rce/ps-ch/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=PS.ProtectedSite&QUERY_LAYERS=PS.ProtectedSite&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ve[0]-me},${ve[1]-me},${ve[0]+me},${ve[1]+me}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties;let q='<strong class="text-cyan-800">UNESCO Werelderfgoed</strong>';(Z.siteName||Z.naam)&&(q+=`<br/><span class="text-sm font-semibold text-cyan-700">${Z.siteName||Z.naam}</span>`),Z.siteDesignation&&(q+=`<br/><span class="text-xs text-gray-600">${Z.siteDesignation}</span>`),Rt.push(q)}}catch(Oe){console.warn("Werelderfgoed WMS query failed:",Oe)}continue}if(Ut==="Terpen"){try{const Oe=xn(yt),ve=vn("EPSG:4326","EPSG:28992",Oe),me=100,N=`https://geoportaal.fryslan.nl/arcgis/services/Themas/cultuurhistorie/MapServer/WMSServer?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=terpen3335&QUERY_LAYERS=terpen3335&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ve[0]-me},${ve[1]-me},${ve[0]+me},${ve[1]+me}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties,q=Z.naam||Z.NAAM||Z.Naam||"Terp",le=Z.plaats||Z.PLAATS||Z.Plaats||"";let he=`<strong class="text-orange-800">${q}</strong>`;le&&(he+=`<br/><span class="text-sm text-gray-500">${le}</span>`),he+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',he+='<div class="text-sm text-gray-700 mt-1">Een terp is een kunstmatige heuvel. Mensen bouwden deze heuvels om droog te wonen in het vlakke, natte land. Terpen zijn vaak meer dan 2000 jaar oud.</div>',he+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',he+='<div class="text-sm text-gray-700 mt-1">Op en rond terpen worden vaak vondsten gedaan:</div>',he+='<ul class="list-disc list-inside text-sm text-gray-700 mt-1 space-y-0.5">',he+="<li>Middeleeuws aardewerk en botten</li>",he+="<li>Munten uit verschillende periodes</li>",he+="<li>Metalen voorwerpen (gespen, fibulae, sieraden)</li>",he+="<li>Soms Romeinse of zelfs prehistorische vondsten</li>",he+="</ul>",he+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Waarom zijn terpen interessant?</span></div>',he+='<div class="text-sm text-gray-700 mt-1">Terpen waren vaak dorpskernen waar mensen eeuwenlang woonden. Door de ophoging bleven veel voorwerpen goed bewaard. Let op: sommige terpen zijn beschermd monument!</div>',he+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bezoeken</span></div>',he+='<div class="text-sm text-gray-700 mt-1">Veel terpen zijn nog zichtbaar in het landschap. Vraag altijd toestemming aan de grondeigenaar voordat je gaat detecteren.</div>',Rt.push(he)}}catch(Oe){console.warn("Terpen WMS query failed:",Oe)}continue}if(Ut==="Religieus Erfgoed"){try{const Oe=xn(yt),ve=vn("EPSG:4326","EPSG:28992",Oe),me=50,N=`https://services.rce.geovoorziening.nl/landschapsatlas_view/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=religieuserfgoed&QUERY_LAYERS=religieuserfgoed&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ve[0]-me},${ve[1]-me},${ve[0]+me},${ve[1]+me}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties,q=Z.naam||Z.NAAM||Z.name||Z.NAME||"Onbekend",le=Z.denominatie||Z.DENOMINATIE||Z.religie||"",he=Z.type||Z.TYPE||Z.functie||"",Ve=Z.bouwjaar||Z.BOUWJAAR||Z.jaar||"",Se=Z.gemeente||Z.GEMEENTE||Z.plaats||"";let $e=`<strong class="text-purple-800">${q}</strong>`;const et=he.toLowerCase();let dt="Een religieus gebouw of heilige plek.",St="Munten van kerkgangers, knopen, gespen, religieuze voorwerpen";et.includes("kerk")||et.includes("church")?(dt="Een kerk was het hart van de gemeenschap. Hier kwamen mensen samen voor diensten, maar ook voor belangrijke gebeurtenissen.",St="Munten uit de collecte, knopen, gespen, pelgrimsinsignes, loden zegels"):et.includes("kapel")||et.includes("chapel")?(dt="Een kapel is een klein gebedshuis, vaak bij een landgoed, langs een weg, of op een bijzondere plek.",St="Devotionalia, munten, kruisjes, rozenkransen"):et.includes("synagoge")?(dt="Een synagoge is een Joods gebedshuis. Veel synagogen in Nederland zijn verwoest of herbestemd na de Tweede Wereldoorlog.",St="Munten, knopen, kleine religieuze voorwerpen"):et.includes("klooster")||et.includes("monastery")?(dt="Een klooster was een woon- en werkplek voor monniken of nonnen. Veel kloosters hadden eigen werkplaatsen en landerijen.",St="Religieuze voorwerpen, zegels, gereedschap, aardewerk, middeleeuwse munten"):et.includes("toren")||et.includes("tower")?(dt="Een kerktoren of klokkentoren. Soms is alleen de toren nog over van een verdwenen kerk.",St="Munten, knopen, bouwmateriaal"):(et.includes("begraafplaats")||et.includes("cemetery"))&&(dt="Een historische begraafplaats. Detecteren op begraafplaatsen is niet toegestaan zonder toestemming.",St="Detecteren hier niet toegestaan"),le&&($e+=`<br/><span class="text-sm text-purple-600">${le}</span>`),he&&($e+=`<br/><span class="text-sm text-gray-600">${he}</span>`),Ve&&($e+=`<br/><span class="text-sm text-gray-500">Bouwjaar: ${Ve}</span>`),Se&&($e+=`<br/><span class="text-xs text-gray-400">${Se}</span>`),$e+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',$e+=`<div class="text-sm text-gray-700 mt-1">${dt}</div>`,$e+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',$e+=`<div class="text-sm text-gray-700 mt-1">${St}</div>`,$e+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bezoeken</span></div>',et.includes("begraafplaats")?$e+='<div class="text-sm text-red-600 mt-1">Detecteren op begraafplaatsen is niet toegestaan. Respecteer de rust van de overledenen.</div>':$e+='<div class="text-sm text-gray-700 mt-1">Veel kerken en religieuze gebouwen zijn beschermd monument. Vraag altijd toestemming voordat je gaat detecteren op het terrein.</div>',Rt.push($e)}}catch(Oe){console.warn("Religieus Erfgoed WMS query failed:",Oe)}continue}if(Ut==="Gewaspercelen"){try{const Oe=xn(yt),ve=vn("EPSG:4326","EPSG:28992",Oe),me=50,Ct=`${ve[0]-me},${ve[1]-me},${ve[0]+me},${ve[1]+me}`,N=`https://service.pdok.nl/rvo/brpgewaspercelen/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=BrpGewas&QUERY_LAYERS=BrpGewas&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${Ct}`,Pt=`https://service.pdok.nl/bzk/bro-bodemkaart/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=soilarea&QUERY_LAYERS=soilarea&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${Ct}`,[W,Z]=await Promise.all([fetch(N),fetch(Pt).catch(()=>null)]),q=await W.json();if(q.features&&q.features.length>0){const le=q.features[0].properties;let he='<strong class="text-green-800">Landbouwperceel</strong>';if((le.gewas||le.gewasnaam)&&(he+=`<br/><span class="text-sm font-semibold text-green-700">${le.gewas||le.gewasnaam}</span>`),(le.categorie||le.category)&&(he+=`<br/><span class="text-xs text-gray-600">${le.categorie||le.category}</span>`),le.oppervlakte&&(he+=`<br/><span class="text-xs text-gray-500">${le.oppervlakte} ha</span>`),Z)try{const Ve=await Z.json();if(Ve.features&&Ve.features.length>0){const Se=Ve.features[0].properties,$e=Se.first_soilname||Se.soilname||Se.bodemtype,et=Se.first_soilcode||Se.soilcode||Se.maparea_soilcode;if($e){he+=`<br/><span class="text-xs text-amber-700 font-medium">Grondsoort: ${$e}</span>`;const dt=MO($e,et);dt.length>0&&(he+=`<br/><span class="text-xs text-gray-500 italic">${dt.join("  ")}</span>`)}}}catch{}Rt.push(he)}}catch(Oe){console.warn("BRP Gewaspercelen WMS query failed:",Oe)}continue}if(Ut==="Kadastrale Grenzen"){try{const Oe=xn(yt),ve=vn("EPSG:4326","EPSG:28992",Oe),me=20,N=`https://service.pdok.nl/kadaster/kadastralekaart/wms/v5_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=Perceel&QUERY_LAYERS=Perceel&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ve[0]-me},${ve[1]-me},${ve[0]+me},${ve[1]+me}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties,q=Z.kadastraleGemeenteWaarde||Z.kadastrale_gemeente_waarde||Z.kadastraleGemeente||Mwe[String(Z.kadastraleGemeenteCode)]||Z.kadastraleGemeenteCode,le=Z.sectie||Z.Sectie||"",he=Z.perceelnummer||Z.perceelNummer||Z.Perceelnummer||"",Ve=Z.kadastraleGrootteWaarde||Z.kadastrale_grootte_waarde||Z.kadastraleGrootte||Z.oppervlakte,Se=Z.AKRKadastraleGemeenteCodeWaarde||Z.akrKadastraleGemeenteCodeWaarde||"",$e=[q,le,he].filter(Boolean).join(" "),et=Se&&le&&he?`${Se}-${le}-${he}`:"";let dt='<strong class="text-indigo-800">Kadastraal Perceel</strong>';if($e&&(dt+=`<br/><span class="text-sm text-indigo-700">${$e}</span>`),et&&(dt+=`<br/><span class="text-sm font-bold text-gray-800 font-mono">${et}</span>`),Ve){const St=typeof Ve=="number"?Ve:parseFloat(Ve);isNaN(St)||(dt+=`<br/><span class="text-xs text-gray-600">${St.toLocaleString("nl-NL")} m</span>`)}dt+='<br/><br/><span class="text-xs text-gray-600">Eigenaar opzoeken? Kopieer bovenstaande code, ga naar </span><a href="https://www.kadaster.nl/winkel" target="_blank" rel="noopener" class="text-xs text-blue-600 hover:underline">kadaster.nl/winkel</a><span class="text-xs text-gray-600"> en klik "Zoek op aanduiding"</span><span class="text-xs text-gray-400"> (betaalde dienst)</span>',Rt.push(dt)}}catch(Oe){console.warn("Kadastrale Grenzen WMS query failed:",Oe)}continue}if(Ut==="Scheepswrakken"){try{const Oe=xn(yt),ve=vn("EPSG:4326","EPSG:28992",Oe),me=100,N=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_SCHEEPSRESTANTEN&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_SCHEEPSRESTANTEN&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ve[0]-me},${ve[1]-me},${ve[0]+me},${ve[1]+me}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties;let q='<strong class="text-cyan-800">Scheepswrak</strong>';(Z.naam||Z.NAAM)&&(q+=`<br/><span class="text-sm font-semibold text-cyan-700">${Z.naam||Z.NAAM}</span>`),(Z.type||Z.TYPE)&&(q+=`<br/><span class="text-sm text-gray-700">${Z.type||Z.TYPE}</span>`),(Z.datering||Z.DATERING)&&(q+=`<br/><span class="text-xs text-gray-500">Datering: ${Z.datering||Z.DATERING}</span>`),(Z.bron||Z.BRON)&&(q+=`<br/><span class="text-xs text-gray-400">${Z.bron||Z.BRON}</span>`),Rt.push(q)}}catch(Oe){console.warn("Scheepswrakken WMS query failed:",Oe)}continue}if(Ut==="Woonheuvels ZH"){try{const Oe=xn(yt),ve=vn("EPSG:4326","EPSG:28992",Oe),me=100,N=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_WOONHEUVEL&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_WOONHEUVEL&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ve[0]-me},${ve[1]-me},${ve[0]+me},${ve[1]+me}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties;let q='<strong class="text-orange-800">Woonheuvel</strong>';(Z.naam||Z.NAAM)&&(q+=`<br/><span class="text-sm font-semibold text-orange-700">${Z.naam||Z.NAAM}</span>`),(Z.type||Z.TYPE)&&(q+=`<br/><span class="text-sm text-gray-700">${Z.type||Z.TYPE}</span>`),Rt.push(q)}}catch(Oe){console.warn("Woonheuvels WMS query failed:",Oe)}continue}if(Ut==="Romeinse Forten"){try{const Oe=xn(yt),ve=vn("EPSG:4326","EPSG:28992",Oe),me=200,N=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_ROMEINSFORT&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_ROMEINSFORT&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ve[0]-me},${ve[1]-me},${ve[0]+me},${ve[1]+me}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties;let q='<strong class="text-red-800">Romeins Fort</strong>';(Z.naam||Z.NAAM)&&(q+=`<br/><span class="text-sm font-semibold text-red-700">${Z.naam||Z.NAAM}</span>`),(Z.type||Z.TYPE)&&(q+=`<br/><span class="text-sm text-gray-700">${Z.type||Z.TYPE}</span>`),(Z.periode||Z.PERIODE)&&(q+=`<br/><span class="text-xs text-gray-500">${Z.periode||Z.PERIODE}</span>`),Rt.push(q)}}catch(Oe){console.warn("Romeinse Forten WMS query failed:",Oe)}continue}if(Ut==="Windmolens"){try{const Oe=xn(yt),ve=vn("EPSG:4326","EPSG:28992",Oe),me=50,N=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_NEDERZETTING_WINDMOLENS&QUERY_LAYERS=CHS_2015_NEDERZETTING_WINDMOLENS&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ve[0]-me},${ve[1]-me},${ve[0]+me},${ve[1]+me}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties;let q='<strong class="text-amber-800">Windmolen</strong>';(Z.naam||Z.NAAM)&&(q+=`<br/><span class="text-sm font-semibold text-amber-700">${Z.naam||Z.NAAM}</span>`),(Z.type||Z.TYPE||Z.functie||Z.FUNCTIE)&&(q+=`<br/><span class="text-sm text-gray-700">${Z.type||Z.TYPE||Z.functie||Z.FUNCTIE}</span>`),(Z.bouwjaar||Z.BOUWJAAR)&&(q+=`<br/><span class="text-xs text-gray-500">Bouwjaar: ${Z.bouwjaar||Z.BOUWJAAR}</span>`),Rt.push(q)}}catch(Oe){console.warn("Windmolens WMS query failed:",Oe)}continue}if(Ut==="Erfgoedlijnen"){try{const Oe=xn(yt),ve=vn("EPSG:4326","EPSG:28992",Oe),me=200,N=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_ERFGOEDLIJN_HOOFDSTRUCTUUR&QUERY_LAYERS=CHS_ERFGOEDLIJN_HOOFDSTRUCTUUR&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ve[0]-me},${ve[1]-me},${ve[0]+me},${ve[1]+me}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties;let q='<strong class="text-purple-800">Erfgoedlijn</strong>';(Z.naam||Z.NAAM||Z.erfgoedlijn)&&(q+=`<br/><span class="text-sm font-semibold text-purple-700">${Z.naam||Z.NAAM||Z.erfgoedlijn}</span>`),(Z.type||Z.TYPE)&&(q+=`<br/><span class="text-sm text-gray-700">${Z.type||Z.TYPE}</span>`),(Z.omschrijving||Z.OMSCHRIJVING)&&(q+=`<br/><span class="text-xs text-gray-500">${Z.omschrijving||Z.OMSCHRIJVING}</span>`),Rt.push(q)}}catch(Oe){console.warn("Erfgoedlijnen WMS query failed:",Oe)}continue}if(Ut==="Oude Kernen"){try{const Oe=xn(yt),ve=vn("EPSG:4326","EPSG:28992",Oe),me=200,N=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_KERNEN&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_KERNEN&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ve[0]-me},${ve[1]-me},${ve[0]+me},${ve[1]+me}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties;let q='<strong class="text-stone-800">Historische Kern</strong>';(Z.naam||Z.NAAM)&&(q+=`<br/><span class="text-sm font-semibold text-stone-700">${Z.naam||Z.NAAM}</span>`),(Z.type||Z.TYPE)&&(q+=`<br/><span class="text-sm text-gray-700">${Z.type||Z.TYPE}</span>`),(Z.periode||Z.PERIODE)&&(q+=`<br/><span class="text-xs text-gray-500">${Z.periode||Z.PERIODE}</span>`),Rt.push(q)}}catch(Oe){console.warn("Oude Kernen WMS query failed:",Oe)}continue}if(Ut==="Relictenkaart Punten"){try{const Oe=xn(yt),ve=vn("EPSG:4326","EPSG:28992",Oe),me=50,N=`https://geoserver.gelderland.nl/geoserver/ngr_a/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=ChAr_Relictenkaart_p&QUERY_LAYERS=ChAr_Relictenkaart_p&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ve[0]-me},${ve[1]-me},${ve[0]+me},${ve[1]+me}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties,q={KV:"Kasteel/Vesting",K:"Kapel",KE:"Kerkhof",B:"Buitenhuis",OB:"Oud Bebouwingsrelict",OV:"Oude Verkaveling",NR:"Nijverheidsrelict",GH:"Grafheuvel",BP:"Begraafplaats",HH:"Havezate",RM:"Rosmolen",WM:"Windmolen",PM:"Poldermolen",EK:"Eendenkooi",SH:"Scholtenhoeve"},le=Z.type?.replace(/[0-9]/g,"")||"",he=q[le]||Z.type||"Cultuurhistorisch object";let Ve='<strong class="text-emerald-800">Relict</strong>';Ve+=`<br/><span class="text-sm font-semibold text-emerald-700">${he}</span>`,Z.type&&le!==Z.type&&(Ve+=`<br/><span class="text-xs text-gray-500">Code: ${Z.type}</span>`),Z.streek&&(Ve+=`<br/><span class="text-xs text-gray-400">Streek: ${Z.streek}</span>`),Rt.push(Ve)}}catch(Oe){console.warn("Relictenkaart Punten WMS query failed:",Oe)}continue}if(Ut==="Relictenkaart Lijnen"){try{const Oe=xn(yt),ve=vn("EPSG:4326","EPSG:28992",Oe),me=50,N=`https://geoserver.gelderland.nl/geoserver/ngr_a/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=ChAr_Relictenkaart_l&QUERY_LAYERS=ChAr_Relictenkaart_l&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ve[0]-me},${ve[1]-me},${ve[0]+me},${ve[1]+me}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties,le={1:"Sprengenbeek",2:"Oude waterloop",3:"Doorgaande weg",4:"Hessenweg",5:"Oude weg",6:"Historische grens",7:"Trekpad",8:"Jaagpad"}[Z.klasse]||`Historisch lijnrelict (${Z.klasse})`;let he='<strong class="text-teal-800">Lijnrelict</strong>';he+=`<br/><span class="text-sm font-semibold text-teal-700">${le}</span>`,Rt.push(he)}}catch(Oe){console.warn("Relictenkaart Lijnen WMS query failed:",Oe)}continue}if(Ut==="Relictenkaart Vlakken"){try{const Oe=xn(yt),ve=vn("EPSG:4326","EPSG:28992",Oe),me=100,N=`https://geoserver.gelderland.nl/geoserver/ngr_a/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=ChAr_Relictenkaart_v&QUERY_LAYERS=ChAr_Relictenkaart_v&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ve[0]-me},${ve[1]-me},${ve[0]+me},${ve[1]+me}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties,le={1:"Onveranderd agrarisch (voor 1850)",2:"Jonge heideontginning (1850-1950)",3:"Open essencomplex",4:"Kampenlandschap",5:"Heiderelict (1850)",6:"Bosrelict (1850)",7:"Stuifzandrelict",8:"Oud bouwland",9:"Historisch grasland",10:"Beekdal"}[Z.klasse]||`Historisch landschap (${Z.klasse})`;let he='<strong class="text-lime-800">Landschapsrelict</strong>';if(he+=`<br/><span class="text-sm font-semibold text-lime-700">${le}</span>`,Z.st_area_shape_){const Ve=(Z.st_area_shape_/1e4).toFixed(1);he+=`<br/><span class="text-xs text-gray-500">${Ve} ha</span>`}Rt.push(he)}}catch(Oe){console.warn("Relictenkaart Vlakken WMS query failed:",Oe)}continue}if(Ut==="Verdronken Dorpen"){try{const Oe=xn(yt),ve=vn("EPSG:4326","EPSG:28992",Oe),me=200,N=`https://opengeodata.zeeland.nl/geoserver/chs/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=geocmd_vrddrppnt&QUERY_LAYERS=geocmd_vrddrppnt&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${ve[0]-me},${ve[1]-me},${ve[0]+me},${ve[1]+me}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties;let q='<strong class="text-blue-800">Verdronken Dorp</strong>';(Z.naam||Z.NAAM)&&(q+=`<br/><span class="text-sm font-semibold text-blue-700">${Z.naam||Z.NAAM}</span>`),(Z.verdronken||Z.VERDRONKEN||Z.jaar||Z.JAAR)&&(q+=`<br/><span class="text-xs text-gray-600">Verdronken: ${Z.verdronken||Z.VERDRONKEN||Z.jaar||Z.JAAR}</span>`),(Z.gemeente||Z.GEMEENTE)&&(q+=`<br/><span class="text-xs text-gray-500">${Z.gemeente||Z.GEMEENTE}</span>`),(Z.bron||Z.BRON)&&(q+=`<br/><span class="text-xs text-gray-400">${Z.bron||Z.BRON}</span>`),Rt.push(q)}}catch(Oe){console.warn("Verdronken Dorpen WMS query failed:",Oe)}continue}const Ji=Vr.getFeatureInfoUrl(yt,Jt,"EPSG:3857",{INFO_FORMAT:"application/json"});if(Ji)try{const ve=await(await fetch(Ji)).json();if(ve.features&&ve.features.length>0){const me=ve.features[0].properties;if(Ut==="AHN 0.5m"){let W='<strong class="text-blue-800">AHN Hoogtekaart</strong>';const Z=me.value_list??me.GRAY_INDEX??me.value??me.gray_index??me.dtm_05m??me.DTM_05M??me.hoogte??me.HOOGTE??me.elevation??me.ELEVATION;if(Z!=null&&!isNaN(Number(Z))){const q=typeof Z=="number"?Z.toFixed(2):Number(Z).toFixed(2);W+=`<br/><span class="text-sm text-blue-700">Hoogte: ${q} m NAP</span>`,Rt.push(W)}else{let q=!1;const le=["geometry","id","fid","gml_id","bbox"];for(const[he,Ve]of Object.entries(me))!le.includes(he.toLowerCase())&&Ve!==null&&Ve!==""&&(W+=`<br/><span class="text-xs text-gray-600">${he}: ${Ve}</span>`,q=!0);q&&Rt.push(W)}continue}if(Ut==="Geomorfologie"){let W='<strong class="text-green-800">Geomorfologie</strong>',Z=!1;const q=me.landform_subgroup_description,le=me.relief_klasse,he=me.relief_subklasse,Ve=me.genese_description,Se=me.active_process;if(q&&(W+=`<br/><span class="text-sm text-green-700">${q}</span>`,Z=!0),le){const $e=he&&he!==le?`${le} (${he})`:le;W+=`<br/><span class="text-xs text-gray-600">Relief: ${$e}</span>`,Z=!0}if(Ve&&(W+=`<br/><span class="text-xs text-gray-500">Ontstaan: ${Ve}</span>`,Z=!0),Se&&Se!=="onbekend"&&(W+=`<br/><span class="text-xs text-gray-500">Actief proces: ${Se}</span>`,Z=!0),!Z){const $e=["geometry","id","fid","gml_id","bbox","fuuid","geom","collection_id"];for(const[et,dt]of Object.entries(me))!$e.includes(et.toLowerCase())&&dt!==null&&dt!==""&&!et.includes("validfrom")&&!et.includes("validto")&&(W+=`<br/><span class="text-xs text-gray-600">${et}: ${dt}</span>`)}W+='<br/><a href="https://legendageomorfologie.wur.nl/" target="_blank" rel="noopener" class="text-xs text-blue-600 hover:underline">Meer over geomorfologie</a>',Rt.push(W);continue}let Ct=`<strong>${Ut}</strong>`;const N=me.first_soilname||me.soilname,Pt=me.soilcode||me.first_soilcode;if(N&&(Ct+=`<br/><span class="text-sm text-amber-700">${N}</span>`,Ut==="Bodemkaart")){const W=MO(N,Pt);W.length>0&&(Ct+=`<br/><span class="text-xs text-gray-500 italic">${W.join("  ")}</span>`)}if(me.soilslope&&me.soilslope!=="Niet opgenomen"&&(Ct+=`<br/><span class="text-xs text-gray-500">Helling: ${me.soilslope}</span>`),!N){const W=["geometry","id","fid","gml_id","GRAY_INDEX","gray_index","value"];for(const[Z,q]of Object.entries(me))!W.includes(Z)&&q&&q!=="Niet opgenomen"&&(Ct+=`<br/><span class="text-xs text-gray-600">${Z}: ${q}</span>`)}Rt.push(Ct)}}catch(Oe){console.warn("WMS GetFeatureInfo failed:",Oe)}}return Rt},kn=async yt=>{const Jt=[],Rt=[],rr=ve=>{if(!ve)return;const me=ve.getType(),N=ve.clone().transform("EPSG:3857","EPSG:4326").getCoordinates();return{type:me,coordinates:N}},si=kwe(yt.coordinate),Vr=[];n.forEachFeatureAtPixel(yt.pixel,ve=>{Vr.push(ve)});for(const ve of Vr){const me=ve.getProperties(),{geometry:Ct,...N}=me;if(N.vondst){const q=N.vondst,le=`<strong>${q.objectType}</strong>
            <div data-vondst-id="${q.id}"></div>
            <br/><span class="text-sm text-gray-600"><strong>Materiaal:</strong> ${q.material}</span>
            <br/><span class="text-sm text-gray-600"><strong>Periode:</strong> ${q.period}</span>
            ${q.depth?`<br/><span class="text-sm text-gray-600"><strong>Diepte:</strong> ${q.depth} cm</span>`:""}
            ${q.condition&&q.condition!=="Onbekend"?`<br/><span class="text-sm text-gray-600"><strong>Conditie:</strong> ${q.condition}</span>`:""}
            ${q.weight?`<br/><span class="text-sm text-gray-600"><strong>Gewicht:</strong> ${q.weight} gram</span>`:""}
            ${q.notes?`<br/><span class="text-sm text-gray-600"><strong>Notities:</strong> ${q.notes}</span>`:""}
            ${q.photoUrl?`<br/><a href="${q.photoUrl}" target="_blank" rel="noopener" class="text-blue-600 hover:underline text-sm"> Bekijk foto</a>`:""}
            <br/><span class="text-xs text-gray-400">${new Date(q.timestamp).toLocaleDateString("nl-NL")}</span>`;Jt.push(le),Rt.push(null),M(q.id);continue}if(N.layerType==="customPoint"&&N.customPoint){const q=N.customPoint,le=N.customLayerName||"Mijn Laag",he=N.customLayerColor||"#f97316";let Ve="";if(q.popupContent?(Ve=`<div class="flex items-center gap-2 mb-2 pb-2 border-b border-gray-100">
              <span class="w-3 h-3 rounded-full flex-shrink-0" style="background-color: ${he}"></span>
              <span class="text-xs font-medium" style="color: ${he}">${le}</span>
            </div>`,Ve+=q.popupContent):(Ve=`<strong>${q.name}</strong>`,Ve+=`<br/><span class="text-xs text-gray-500">${le}</span>`,q.category&&q.category!=="Overig"&&(Ve+=`<br/><span class="text-sm text-gray-600"><strong>Categorie:</strong> ${q.category}</span>`)),q.photos&&q.photos.length>0){Ve+='<div class="flex flex-wrap gap-1 my-2">';for(const Se of q.photos.slice(0,3)){const $e=Se.thumbnailUrl||Se.thumbnailBase64;$e&&(Ve+=`<img src="${$e}" alt="Foto" class="w-16 h-16 object-cover rounded border border-gray-200" />`)}q.photos.length>3&&(Ve+=`<span class="text-xs text-gray-400 self-end">+${q.photos.length-3} meer</span>`),Ve+="</div>"}q.notes&&!q.popupContent&&(Ve+=`<br/><span class="text-sm text-gray-600 mt-1">${q.notes}</span>`),q.url&&(Ve+=`<br/><a href="${q.url}" target="_blank" rel="noopener" class="text-blue-600 hover:underline text-sm">Meer info</a>`),Ve+=`<br/><span class="text-xs text-gray-400">${new Date(q.createdAt).toLocaleDateString("nl-NL")}</span>`,Jt.push(Ve),Rt.push(null);continue}if(N.layerType==="importedLayer"){const q=N.layerName||"Gemporteerde laag",le=N.layerColor||"#8b5cf6",he=["layerType","layerId","layerName","layerColor","featureIndex","geometry"],Ve=N.name||N.Name||N.naam||N.title||N.NAAM||N.NAME||N.label||N.description||"Feature";let Se=`<strong style="color: ${le}">${Ve}</strong>`;Se+=`<br/><span class="text-xs text-gray-500">${q}</span>`;const $e=Object.entries(N).filter(([et])=>!he.includes(et)&&et!=="name"&&et!=="Name");if($e.length>0){Se+='<div class="mt-2 space-y-1">';for(const[et,dt]of $e)if(dt!=null&&dt!==""){const St=et.replace(/_/g," ").replace(/([a-z])([A-Z])/g,"$1 $2").replace(/^./,ur=>ur.toUpperCase());let sn=String(dt);sn.length>200&&(sn=sn.substring(0,200)+"..."),sn.startsWith("http://")||sn.startsWith("https://")?Se+=`<div class="text-sm"><span class="text-gray-500">${St}:</span> <a href="${sn}" target="_blank" rel="noopener" class="text-blue-600 hover:underline">Link</a></div>`:Se+=`<div class="text-sm"><span class="text-gray-500">${St}:</span> <span class="text-gray-700">${sn}</span></div>`}Se+="</div>"}Jt.push(Se),Rt.push({geometry:rr(Ct),properties:N,popupHtml:Se});continue}if(N.kwaliteitswaarde&&N.kwaliteitswaarde.includes("archeologische waarde")){const q=gt(N);Jt.push(q),Rt.push({geometry:rr(Ct),properties:N,popupHtml:q});continue}if(N.layerType==="romeinsFort"||N.layerType==="romeinsFortLijn"){const q=N.Name||N.name||"",le=N.description||"",he=Awe[q]||null,Ve=he||Rwe;let Se=`<strong class="text-red-800">${he?Ve.naam:q||"Romeins Fort"}</strong>`;he?.latinNaam&&he.latinNaam!==Ve.naam&&(Se+=`<br/><span class="text-sm text-red-600 italic">${he.latinNaam}</span>`),Se+=`<br/><span class="text-sm text-gray-600">${Cwe[Ve.type]||Ve.type}</span>`,Se+=`<br/><span class="text-xs text-gray-500">${Ve.periode}</span>`,N.layerType==="romeinsFortLijn"&&(Se+='<br/><span class="text-xs text-red-700 mt-1"> Gereconstrueerde fortomtrek</span>'),Se+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Over dit fort</span></div>',Se+=`<div class="text-sm text-gray-700 mt-1">${Ve.beschrijving}</div>`,Se+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat was hier?</span></div>',Se+=`<div class="text-sm text-gray-700 mt-1">${Ve.watWasHier}</div>`,Se+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is er nu nog te zien?</span></div>',Se+=`<div class="text-sm text-gray-700 mt-1">${Ve.watTeZien}</div>`,Se+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',Se+=`<div class="text-sm text-gray-700 mt-1">${Ve.verwachteVondsten}</div>`,Se+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Historische betekenis</span></div>',Se+=`<div class="text-sm text-gray-700 mt-1">${Ve.betekenis}</div>`,he?.bronnen&&he.bronnen.length>0?(Se+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bronnen</span></div>',Se+='<div class="text-sm text-gray-700 mt-1">',he.bronnen.forEach($e=>{const et=$e.replace(/^https?:\/\//,"").split("/")[0];Se+=`<a href="${$e}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline block">${et}</a>`}),Se+="</div>"):(Se+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',Se+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Limes_(Romeinse_Rijk)" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia: Romeinse Limes</a></div>'),!he&&le&&(Se+=`<div class="mt-3"><span class="text-xs text-gray-500 italic">${le}</span></div>`),Jt.push(Se),Rt.push({geometry:rr(Ct),properties:N,popupHtml:Se});continue}let Pt=N.name||N.Name||N.naam||N.title||N.NAAM||N.NAME||N.label||N.route_name||N.road_name;Pt||(N.leisure==="playground"?Pt="Speeltuin":N.leisure==="park"?Pt="Park":N.leisure==="swimming_area"||N.sport==="swimming"?Pt="Zwemplek":N.tourism==="museum"?Pt="Museum":N.amenity==="cafe"||N.amenity==="restaurant"?Pt=N.amenity==="cafe"?"Caf":"Restaurant":N.historic==="castle"?Pt="Kasteel":Pt="Info"),(N.bunker_type||N.name&&(N.name.toLowerCase().includes("bunker")||N.name.toLowerCase().includes("kazemat")||N.name.toLowerCase().includes("schuilplaats")))&&(Pt="Bunker"),N.historic==="battlefield"&&(Pt="Historisch slagveld");let W=`<strong>${Pt}</strong>`;if(N.category&&(W+=`<br/><span class="text-sm text-gray-600">Categorie: ${N.category}</span>`),N.from_to&&N.from_to!==Pt&&(W+=`<br/><span class="text-sm text-gray-600">${N.from_to}</span>`),N.route&&N.route!==Pt&&(W+=`<br/><span class="text-sm text-gray-600">${N.route}</span>`),N.TOPONIEM&&(W+=`<br/><span class="text-sm font-semibold text-gray-800">${N.TOPONIEM}</span>`,N.PLAATS&&(W+=`<br/><span class="text-xs text-gray-500">${N.PLAATS}</span>`)),(N.AARD_VINDP||N.Aard_vindp)&&(W+=`<br/><span class="text-sm text-gray-700">Aard: ${N.AARD_VINDP||N.Aard_vindp}</span>`),N.BEGIN_PER&&N.EIND_PER&&(W+=`<br/><span class="text-sm text-purple-700">Periode: ${N.BEGIN_PER} - ${N.EIND_PER}</span>`),(N.AARD_OPM||N.Aard_opmer)&&(W+=`<br/><span class="text-xs text-gray-600 italic">${N.AARD_OPM||N.Aard_opmer}</span>`),N.Gemeente&&(W+=`<br/><span class="text-sm text-gray-600">Gemeente: ${N.Gemeente}</span>`),N.Bron&&(W+=`<br/><span class="text-xs text-gray-500">Bron: ${N.Bron}</span>`),N.Bron_besch&&(W+=`<br/><span class="text-xs text-gray-500">${N.Bron_besch}</span>`),N.Dat_st_z&&N.Dat_ei_z&&(W+=`<br/><span class="text-sm text-purple-700">Datering: ${N.Dat_st_z} - ${N.Dat_ei_z}</span>`),N.Begin&&N.Einde&&(W+=`<br/><span class="text-sm text-purple-700">Periode: ${N.Begin} - ${N.Einde}</span>`),N.Uiterwaard&&(W+=`<br/><span class="text-sm font-semibold">${N.Uiterwaard}</span>`),N.rivier&&(W+=`<br/><span class="text-sm text-blue-600">Rivier: ${N.rivier}</span>`),N.Beschrijvi&&(W+=`<br/><span class="text-sm text-gray-700">${N.Beschrijvi}</span>`),N.leisure&&N.name){const q=N.leisure==="playground"?"Speeltuin":N.leisure==="park"?"Park":N.leisure==="swimming_area"?"Zwemplek":null;q&&(W+=`<br/><span class="text-xs text-green-600">${q}</span>`)}if((N.tourism==="museum"||N.museum)&&N.name&&(W+='<br/><span class="text-xs text-purple-600">Museum</span>'),(N.leisure==="swimming_area"||N.sport==="swimming")&&N.name&&(W+='<br/><span class="text-xs text-cyan-600">Zwemplek</span>'),N.osm_id&&N.address!==void 0&&(W+='<br/><span class="text-xs text-lime-600">Kringloopwinkel</span>',N.address&&(W+=`<br/><span class="text-xs text-gray-500">${N.address}</span>`),N.phone&&(W+=`<br/><span class="text-xs text-gray-600">${N.phone}</span>`)),N.site_type==="tumulus"){const q=ve.getGeometry()?.getCoordinates();let le="",he="";if(q){const Ve=xn(q),Se=Ve[0],$e=Ve[1];Se>5.5&&Se<6.3&&$e>52&&$e<52.5?(le="Veluwe",he="De Veluwe heeft de grootste concentratie grafheuvels van Nederland. Veel heuvels liggen in grafvelden met tientallen heuvels bij elkaar."):Se>6.2&&Se<7.1&&$e>52.6&&$e<53.3?(le="Drenthe",he="Drenthe is beroemd om zijn prehistorische monumenten. Naast hunebedden liggen hier honderden grafheuvels uit de Bronstijd."):Se>4.5&&Se<6&&$e>51.3&&$e<51.9?(le="Noord-Brabant",he="Op de Brabantse zandgronden liggen veel grafheuvels, vaak in kleine groepjes op hogere gronden."):Se>5.5&&Se<6.3&&$e>50.7&&$e<51.6?(le="Limburg",he="De Limburgse heuvels en plateaus herbergen grafheuvels uit verschillende periodes, van Bronstijd tot Romeinse tijd."):Se>5&&Se<5.6&&$e>52&&$e<52.4&&(le="Utrechtse Heuvelrug",he="De stuwwallen van de Utrechtse Heuvelrug en het Gooi waren al in de prehistorie bewoond. Grafheuvels markeren de laatste rustplaats van de vroege bewoners.")}W+='<br/><span class="text-sm text-amber-700">Grafheuvel uit de Bronstijd of IJzertijd</span>',le&&(W+=`<br/><span class="text-sm text-gray-500">${le}</span>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',W+='<div class="text-sm text-gray-700 mt-1">Een grafheuvel is een kunstmatige heuvel over een of meerdere graven. De meeste Nederlandse grafheuvels zijn 3000 tot 4000 jaar oud, uit de Bronstijd (2000-800 v.Chr.) of vroege IJzertijd.</div>',he&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Over deze regio</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${he}</div>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe herken je een grafheuvel?</span></div>',W+='<div class="text-sm text-gray-700 mt-1">Grafheuvels zijn vaak ronde, lage heuvels van 10-30 meter doorsnee en 1-3 meter hoog. Ze liggen meestal op zandgronden, vaak in groepjes (grafvelden). Let op de kenmerkende ronde vorm in het landschap.</div>',N.wikidata?(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer informatie</span></div>',W+=`<div class="text-sm text-gray-700 mt-1"><a href="https://www.wikidata.org/wiki/${N.wikidata}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Bekijk op Wikidata</a></div>`):(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer informatie</span></div>',W+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Grafheuvel" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Lees meer over grafheuvels op Wikipedia</a></div>')}if(N.historic==="castle"||N.castle_type){const q={manor:{label:"Landhuis",uitleg:"Een landhuis of havezate was het woonhuis van een adellijke familie. Vaak met een landgoed eromheen.",vondsten:"Sieraden, gespen, munten, aardewerk van rijke bewoners"},stately:{label:"Statig huis",uitleg:"Een groot en deftig woonhuis, vaak van welgestelde families. Soms met kasteelachtige kenmerken.",vondsten:"Huishoudelijke voorwerpen, munten, knopen, aardewerk"},fortress:{label:"Fort/Vesting",uitleg:"Een versterkte militaire bouwwerk, gebouwd om een gebied te verdedigen.",vondsten:"Militaire voorwerpen, kogels, gespen, uniformonderdelen"},defensive:{label:"Verdedigingskasteel",uitleg:"Een kasteel gebouwd voor verdediging, met dikke muren, een gracht en torens.",vondsten:"Wapens, harnasonderdelen, pijlpunten, middeleeuwse munten"},palace:{label:"Paleis",uitleg:"Een groot en luxueus gebouw voor koningen, prinsen of zeer rijke families.",vondsten:"Luxe voorwerpen, sieraden, zegels, zeldzame munten"},castrum:{label:"Romeins fort",uitleg:"Een Romeins legerkamp of fort. Deze zijn bijna 2000 jaar oud!",vondsten:"Romeinse munten, fibulae, militaria, aardewerk"},citadel:{label:"Citadel",uitleg:"Een sterk versterkte kern binnen een stad, als laatste verdedigingslinie.",vondsten:"Militaire voorwerpen uit verschillende periodes"}},le=N.castle_type?q[N.castle_type]:null,he=le?.label||"Kasteel";if(W+=`<br/><span class="text-sm text-purple-600">${he}</span>`,N.start_date&&(W+=`<br/><span class="text-sm text-gray-500">Bouwjaar: ${N.start_date}</span>`),N.heritage&&(W+='<br/><span class="text-sm text-amber-600">Rijksmonument</span>'),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',le?W+=`<div class="text-sm text-gray-700 mt-1">${le.uitleg}</div>`:W+='<div class="text-sm text-gray-700 mt-1">Een historisch kasteel of adellijk huis. Kastelen waren vaak het middelpunt van macht en rijkdom in een gebied.</div>',W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',le?W+=`<div class="text-sm text-gray-700 mt-1">${le.vondsten}</div>`:W+='<div class="text-sm text-gray-700 mt-1">Munten, sieraden, gespen, aardewerk en andere voorwerpen van de vroegere bewoners.</div>',N.wikipedia||N.website){if(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',N.wikipedia){const Ve=N.wikipedia.startsWith("http")?N.wikipedia:`https://nl.wikipedia.org/wiki/${N.wikipedia.replace(/^nl:/,"")}`;W+=`<div class="text-sm text-gray-700 mt-1"><a href="${Ve}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`}N.website&&(W+=`<div class="text-sm text-gray-700 mt-1"><a href="${N.website}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Website bezoeken</a></div>`)}}if(N.historic==="ruins"){const q=N.ruins_type||"";let le="Rune",he="Een rune is wat overblijft van een oud gebouw. Het kan een kerk, kasteel, molen of ander bouwwerk zijn geweest.",Ve="Baksteenfragmenten, aardewerk, metalen voorwerpen van vroegere bewoners of gebruikers";if(q.toLowerCase().includes("church")||q.toLowerCase().includes("kerk")?(le="Kerkrune",he="De overblijfselen van een oude kerk. Vaak nog te herkennen aan de fundering of een paar muren.",Ve="Religieuze voorwerpen, munten van kerkgangers, knopen, gespen"):q.toLowerCase().includes("castle")||q.toLowerCase().includes("kasteel")?(le="Kasteelrune",he="De resten van een middeleeuws kasteel. Soms is alleen de gracht of fundering nog zichtbaar.",Ve="Middeleeuwse munten, sieraden, harnasonderdelen, pijlpunten"):q.toLowerCase().includes("mill")||q.toLowerCase().includes("molen")?(le="Molenrune",he="Wat rest van een oude molen. Vaak nog te zien aan de stenen fundering of de molenberg.",Ve="Gereedschap, munten, huishoudelijke voorwerpen"):q.toLowerCase().includes("fort")&&(le="Fortrune",he="De overblijfselen van een militair fort of verdedigingswerk.",Ve="Militaire voorwerpen, kogels, gespen, uniformonderdelen"),W+=`<br/><span class="text-sm text-gray-600">${le}</span>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${he}</div>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${Ve}</div>`,N.description&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Beschrijving</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${N.description}</div>`),N.wikipedia){const Se=N.wikipedia.startsWith("http")?N.wikipedia:`https://${N.wikipedia.split(":")[0]||"nl"}.wikipedia.org/wiki/${N.wikipedia.replace(/^[a-z]{2}:/,"")}`;W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">Lees meer op <a href="${Se}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`}}if(N.bunker_type||N.name&&(N.name.toLowerCase().includes("bunker")||N.name.toLowerCase().includes("kazemat")||N.name.toLowerCase().includes("schuilplaats"))){const q={munitions:"Munitiebunker",personnel_shelter:"Personeelsschuilplaats",personell_shelter:"Personeelsschuilplaats",command:"Commandobunker",gun_emplacement:"Geschutsbunker",mg_nest:"Mitrailleursnest",technical:"Technische bunker",storage:"Opslagbunker",tobruk:"Tobruk",kazemat:"Kazemat",Flak:"Luchtafweerstelling",hardened_aircraft_shelter:"Vliegtuigshelter",shelter:"Schuilkelder",observation:"Observatiebunker",anti_aircraft:"Luchtafweerstelling"},le=N.name||"",he=N.bunker_type?q[N.bunker_type]||N.bunker_type:"";le&&le!=="Bunker"&&(W+=`<br/><span class="text-sm font-semibold text-gray-700">${le}</span>`),he&&he!==le&&(W+=`<br/><span class="text-xs text-gray-500">${he}</span>`);const Ve=ve.getGeometry()?.getCoordinates();let Se="",$e="",et="";if(Ve){const dt=xn(Ve),St=dt[0],sn=dt[1],ur=St<4.8||St<5.2&&sn>51.8&&sn<53.5,cn=St>4.2&&St<4.4&&sn>52&&sn<52.15,hr=St>4.5&&St<4.7&&sn>52.4&&sn<52.5,pr=St>4&&St<4.2&&sn>51.95&&sn<52.05,Ni=St<4.2&&sn<51.6,B=St>5.2&&St<5.8&&sn>51.9&&sn<52.3;cn?(Se="Deze bunker maakt deel uit van de Atlantikwall bij Scheveningen. De Duitsers bouwden hier tijdens WOII zo'n 80 bunkers in de duinen. De muren zijn soms 3 meter dik beton. Voor deze bunkers moesten 138.000 mensen uit Den Haag en Scheveningen hun huis verlaten.",$e="https://nl.wikipedia.org/wiki/Atlantikwall_Museum_Scheveningen",et="Atlantikwall Museum Scheveningen"):hr?(Se="Deze bunker hoort bij Festung IJmuiden, een van de zwaarst verdedigde punten van de Atlantikwall. De Duitsers bouwden hier bunkers om de haventoegang te beschermen. Er zijn nu rondleidingen door het Bunkermuseum.",$e="https://www.bunkermuseum.nl/",et="Bunkermuseum IJmuiden"):pr?(Se="Deze bunker maakt deel uit van de Atlantikwall bij Hoek van Holland. Dit was een strategisch punt voor de Duitsers vanwege de Nieuwe Waterweg. Veel bunkers zijn nog te bezoeken.",$e="https://www.atlantikwallhoekvanholland.nl/",et="Atlantikwall Hoek van Holland"):Ni?(Se="Deze bunker hoort bij de Atlantikwall in Zeeland. De Duitsers verdedigden hier de Westerschelde en de kust. Bij Zoutelande en Westkapelle zijn veel bunkers bewaard gebleven.",$e="https://www.bunkermuseumzoutelande.nl/",et="Bunkermuseum Zoutelande"):ur?(Se="Deze bunker maakt deel uit van de Atlantikwall: de Duitse verdedigingslinie langs de hele kust van Europa. In Nederland bouwden de Duitsers duizenden bunkers tussen 1942 en 1944.",$e="https://nl.wikipedia.org/wiki/Atlantikwall",et="Atlantikwall (Wikipedia)"):B?(Se="Deze bunker hoort mogelijk bij de Grebbelinie of de Nieuwe Hollandse Waterlinie. Dit waren Nederlandse verdedigingslinies die de Duitsers na 1940 versterkten met bunkers.",$e="https://nl.wikipedia.org/wiki/Grebbelinie",et="Grebbelinie (Wikipedia)"):(Se="Een bunker uit de Tweede Wereldoorlog. De meeste bunkers in Nederland zijn gebouwd tussen 1940 en 1944, als onderdeel van de Duitse verdediging of langs bestaande Nederlandse linies.",$e="https://nl.wikipedia.org/wiki/Atlantikwall",et="WOII bunkers (Wikipedia)")}else Se="Een bunker uit de Tweede Wereldoorlog.",$e="https://nl.wikipedia.org/wiki/Atlantikwall",et="WOII bunkers (Wikipedia)";W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${Se}</div>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je vinden?</span></div>',W+='<div class="text-sm text-gray-700 mt-1">Bij bunkers worden soms voorwerpen gevonden zoals patronen, uniformknopen, gespen en persoonlijke spullen van soldaten.</div>',W+='<div class="mt-2 text-xs text-gray-500 italic">Let op: betreed nooit een bunker zonder toestemming. Raak munitieresten niet aan.</div>',W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bronnen</span></div>',W+='<div class="text-sm text-gray-700 mt-1">',W+=`<a href="${$e}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">${et}</a>`,N.website?W+=`<br/><a href="${N.website}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">TracesOfWar</a>`:W+='<br/><a href="https://www.tracesofwar.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">TracesOfWar</a>',W+="</div>"}if(N.historic==="battlefield"){const q=N.name||"Onbekend slagveld",he={"Slag om Arnhem":{periode:"September 1944",samenvatting:"De Slag om Arnhem was onderdeel van Operatie Market Garden. Geallieerde parachutisten probeerden de brug over de Rijn te veroveren. Na negen dagen hevige gevechten moesten ze zich terugtrekken. Van de 10.000 Britse soldaten werden er 1.500 gedood en 6.500 krijgsgevangen gemaakt.",watZieJe:"Er zijn veel monumenten en infoborden. Het Airborne Museum in Oosterbeek vertelt het hele verhaal. Elk jaar in september is er een herdenking.",uitkomst:"De geallieerden verloren de slag. Nederland bleef nog tot mei 1945 bezet.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_om_Arnhem"},"Slag om de Sloedam":{periode:"1-2 november 1944",samenvatting:"Canadese soldaten vielen de Sloedam aan om Walcheren te bevrijden. De dam was smal en de Duitsers verdedigden fel. Veel soldaten sneuvelden bij deze bloedige aanval.",watZieJe:"Bij de dam staat een monument voor de gevallen Canadezen. Er zijn infoborden die de slag uitleggen.",uitkomst:"De Canadezen wonnen na zware verliezen. Dit opende de weg naar de bevrijding van Walcheren.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_om_de_Sloedam"},"Slag bij Heiligerlee (1568)":{periode:"23 mei 1568",samenvatting:"De eerste veldslag van de Tachtigjarige Oorlog. Lodewijk van Nassau versloeg het Spaanse leger. Zijn broer Adolf sneuvelde tijdens de strijd.",watZieJe:"In Heiligerlee staat het Slag bij Heiligerlee monument. Het klooster waar Adolf van Nassau begraven ligt is nog te bezoeken.",uitkomst:"De opstandelingen wonnen, maar dit was pas het begin van 80 jaar oorlog.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_bij_Heiligerlee_(1568)"},Overloon:{periode:"Oktober 1944",samenvatting:"Bij Overloon vochten Britten en Amerikanen tegen de Duitsers. Het was een van de zwaarste tankgevechten op Nederlandse bodem. Het dorp werd volledig verwoest.",watZieJe:"Het Oorlogsmuseum Overloon staat op het voormalige slagveld. Je kunt tanks, vliegtuigen en andere voertuigen zien.",uitkomst:"De geallieerden wonnen na wekenlange gevechten.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_om_Overloon"},"Slagveld Lanakerveld":{periode:"1568",samenvatting:"Onderdeel van de Nederlandse opstand tegen Spanje. Hier vonden gevechten plaats tijdens de beginjaren van de Tachtigjarige Oorlog.",watZieJe:"Het gebied is nu grotendeels landbouwgrond. Lokaal zijn er soms infoborden.",uitkomst:"Onderdeel van de lange strijd tegen de Spaanse overheersing.",wikiUrl:"https://nl.wikipedia.org/wiki/Tachtigjarige_Oorlog"},Blessebrugschans:{periode:"Diverse periodes",samenvatting:"Een historische schans die meerdere keren werd gebruikt in militaire conflicten.",watZieJe:"De resten van de schans zijn nog zichtbaar in het landschap.",uitkomst:"De schans speelde een rol in verschillende conflicten.",wikiUrl:"https://nl.wikipedia.org/wiki/Schans_(vestingwerk)"}}[q];if(q!=="Onbekend slagveld"&&q!=="Historisch slagveld"&&(W+=`<br/><span class="text-sm font-semibold text-red-700">${q}</span>`),he)W+=`<br/><span class="text-xs text-gray-500">${he.periode}</span>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat gebeurde hier?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${he.samenvatting}</div>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe liep het af?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${he.uitkomst}</div>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je zien?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${he.watZieJe}</div>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bronnen</span></div>',W+='<div class="text-sm text-gray-700 mt-1">',W+=`<a href="${he.wikiUrl}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a>`,q.includes("Arnhem")&&(W+='<br/><a href="https://www.airbornemuseum.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Airborne Museum Oosterbeek</a>'),q.includes("Overloon")&&(W+='<br/><a href="https://www.oorlogsmuseum.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Oorlogsmuseum Overloon</a>'),W+="</div>";else if(N.date&&(W+=`<br/><span class="text-xs text-gray-500">${N.date}</span>`),N.description?(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat gebeurde hier?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${N.description}</div>`):(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat gebeurde hier?</span></div>',W+='<div class="text-sm text-gray-700 mt-1">Op deze plek vonden historische gevechten plaats. Zoek lokaal naar infoborden of monumenten.</div>'),N.wikipedia){const Ve=N.wikipedia.startsWith("http")?N.wikipedia:`https://nl.wikipedia.org/wiki/${N.wikipedia.replace("nl:","")}`;W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bronnen</span></div>',W+=`<div class="text-sm text-gray-700 mt-1"><a href="${Ve}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`}}if(N.bron==="Paleobiology Database"){const q=Se=>{const $e={Mollusca:"weekdieren zoals schelpen en slakken",Brachiopoda:"armpotigen, schelp-achtige dieren",Echinodermata:"stekelhuidigen zoals zee-egels en zeesterren",Chordata:"gewervelde dieren",Arthropoda:"geleedpotigen zoals kreeften en trilobieten",Cnidaria:"neteldieren zoals koralen en kwallen",Bryozoa:"mosdiertjes",Foraminifera:"eencellige schelpdieren",Plantae:"planten",Crinoidea:"zeelelies",Gastropoda:"slakken",Bivalvia:"tweekleppigen zoals mossels en oesters",Cephalopoda:"koppotigen zoals inktvissen en ammonieten",Trilobita:"trilobieten, uitgestorven kreeftachtigen",Mammalia:"zoogdieren",Reptilia:"reptielen",Pisces:"vissen",Amphibia:"amfibien"};for(const[et,dt]of Object.entries($e))if(Se.toLowerCase().includes(et.toLowerCase()))return dt;return""},le=Se=>{const $e={Cambrium:"541-485 miljoen jaar geleden",Ordovicium:"485-444 miljoen jaar geleden",Siluur:"444-419 miljoen jaar geleden",Devoon:"419-359 miljoen jaar geleden",Carboon:"359-299 miljoen jaar geleden",Perm:"299-252 miljoen jaar geleden",Trias:"252-201 miljoen jaar geleden",Jura:"201-145 miljoen jaar geleden",Krijt:"145-66 miljoen jaar geleden",Paleogeen:"66-23 miljoen jaar geleden",Neogeen:"23-2,6 miljoen jaar geleden",Kwartair:"2,6 miljoen jaar - nu",Pleistoceen:"2,6 miljoen - 11.700 jaar geleden",Holoceen:"11.700 jaar geleden - nu"};for(const[et,dt]of Object.entries($e))if(Se.toLowerCase().includes(et.toLowerCase()))return dt;return""},he=Se=>{const $e={limestone:"kalksteen",sandstone:"zandsteen",shale:"schalie",clay:"klei",sand:"zand",gravel:"grind",marl:"mergel",chalk:"krijt",mudstone:"moddersteen",siltstone:"siltsteen"};let et=Se;for(const[dt,St]of Object.entries($e))et=et.replace(new RegExp(dt,"gi"),St);return et},Ve=Se=>{const $e={marine:"zee",coastal:"kust",terrestrial:"land",fluvial:"rivier",lacustrine:"meer",reef:"rif",deltaic:"delta",shallow:"ondiep water",deep:"diep water"};let et=Se;for(const[dt,St]of Object.entries($e))et=et.replace(new RegExp(dt,"gi"),St);return et};if(N.vindplaats&&(W+=`<br/><span class="text-xs text-gray-600">${N.vindplaats}</span>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is hier gevonden?</span></div>',N.taxonomie&&N.taxonomie!=="Onbekend"){const Se=q(N.taxonomie);Se?(W+=`<div class="text-sm text-gray-700 mt-1">${Se}</div>`,W+=`<div class="text-xs text-gray-500 italic">(${N.taxonomie})</div>`):W+=`<div class="text-sm text-gray-700 mt-1">${N.taxonomie}</div>`}if(N.aantal_fossielen){const Se=parseInt(N.aantal_fossielen),$e=Se>100?"Veel fossielen gevonden op deze locatie.":Se>10?"Meerdere fossielen gevonden op deze locatie.":`${N.aantal_fossielen} fossiel${Se>1?"en":""} gevonden op deze locatie.`;W+=`<div class="text-sm text-gray-600 mt-1">${$e}</div>`}if(N.periode&&N.periode!=="Onbekend"){W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wanneer leefden deze dieren?</span></div>';const Se=le(N.periode);W+=`<div class="text-sm text-gray-700 mt-1">${N.periode}</div>`,Se&&(W+=`<div class="text-sm text-gray-600">${Se}</div>`),N.ouderdom&&N.ouderdom!=="Onbekend"&&(W+=`<div class="text-sm text-gray-600">Ouderdom: ${N.ouderdom}</div>`)}(N.gesteente||N.formatie||N.milieu)&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">In wat voor gesteente?</span></div>',N.gesteente&&(W+=`<div class="text-sm text-gray-700 mt-1">${he(N.gesteente)}</div>`),N.formatie&&(W+=`<div class="text-sm text-gray-600">Formatie: ${N.formatie}</div>`,N.lid&&(W+=`<div class="text-sm text-gray-600 ml-3">Lid: ${N.lid}</div>`)),N.milieu&&(W+=`<div class="text-sm text-gray-600">Leefomgeving: ${Ve(N.milieu)}</div>`))}if(N.layerType==="fossielHotspot"){const q=[];if(N.type&&q.push(N.type),N.region&&q.push(N.region),N.country){const le={NL:"Nederland",BE:"Belgi",DE:"Duitsland",FR:"Frankrijk"};q.push(le[N.country]||N.country)}if(q.length>0&&(W+=`<br/><span class="text-xs text-gray-600">${q.join("  ")}</span>`),(N.finds||N.period)&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kan ik er vinden?</span></div>',N.finds&&(W+=`<div class="text-sm text-gray-700 mt-1">${N.finds}</div>`),N.period&&(W+=`<div class="text-sm text-gray-600 mt-1">Periode: ${N.period}</div>`),N.geology&&(W+=`<div class="text-sm text-gray-600 mt-1">Geologie: ${N.geology}</div>`)),N.access||N.tips){if(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe kom ik er?</span></div>',N.access){const he=N.access.toLowerCase().includes("verboden")||N.access.toLowerCase().includes("niet toegankelijk")?"text-red-600":"text-gray-700";W+=`<div class="text-sm ${he} mt-1">${N.access}</div>`}N.tips&&(W+=`<div class="text-sm text-gray-600 mt-1 italic">Tip: ${N.tips}</div>`)}}if(N.layerType==="mineralenHotspot"){const q=[];if(N.region&&q.push(N.region),N.country){const le={NL:"Nederland",BE:"Belgi",DE:"Duitsland",FR:"Frankrijk"};q.push(le[N.country]||N.country)}if(q.length>0&&(W+=`<br/><span class="text-xs text-gray-600">${q.join("  ")}</span>`),N.minerals&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kan ik er vinden?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${N.minerals}</div>`,N.geology&&(W+=`<div class="text-sm text-gray-600 mt-1">Geologie: ${N.geology}</div>`)),N.access||N.tips){if(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe kom ik er?</span></div>',N.access){const he=N.access.toLowerCase().includes("verboden")||N.access.toLowerCase().includes("niet toegankelijk")||N.access.toLowerCase().includes("gesloten")?"text-red-600":"text-gray-700";W+=`<div class="text-sm ${he} mt-1">${N.access}</div>`}N.tips&&(W+=`<div class="text-sm text-gray-600 mt-1 italic">Tip: ${N.tips}</div>`)}}if(N.layerType==="goudrivier"){const q=[];if(N.river&&q.push(N.river),N.region&&q.push(N.region),N.country){const le={NL:"Nederland",BE:"Belgi",DE:"Duitsland",FR:"Frankrijk"};q.push(le[N.country]||N.country)}if(q.length>0&&(W+=`<br/><span class="text-xs text-gray-600">${q.join("  ")}</span>`),(N.goldType||N.origin)&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kan ik er vinden?</span></div>',N.goldType&&(W+=`<div class="text-sm text-gray-700 mt-1">${N.goldType}</div>`),N.origin&&(W+=`<div class="text-sm text-gray-600 mt-1">Herkomst: ${N.origin}</div>`)),N.legal||N.tips){if(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Mag ik hier zoeken?</span></div>',N.legal){const he=N.legal.includes("VERBODEN")?"text-red-600 font-semibold":"text-gray-700";W+=`<div class="text-sm ${he} mt-1">${N.legal}</div>`}N.tips&&(W+=`<div class="text-sm text-gray-600 mt-1 italic">Tip: ${N.tips}</div>`)}}if(N.layerType==="wandelroute"){const q=[];if(N.region&&q.push(N.region),N.country){const le={NL:"Nederland",BE:"Belgi"};q.push(le[N.country]||N.country)}if(q.length>0&&(W+=`<br/><span class="text-xs text-gray-600">${q.join("  ")}</span>`),N.distance||N.duration){const le=N.distance?`${N.distance} km`:"",he=N.duration?`${N.duration}`:"",Ve=[le,he].filter(Boolean).join("  ");Ve&&(W+=`<br/><span class="text-sm text-green-700 font-medium">${Ve}</span>`)}(N.description||N.highlights)&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat ga je zien?</span></div>',N.description&&(W+=`<div class="text-sm text-gray-700 mt-1">${N.description}</div>`),N.highlights&&(W+=`<div class="text-sm text-gray-600 mt-1">Hoogtepunten: ${N.highlights}</div>`)),N.startAddress&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Waar begin ik?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${N.startAddress}</div>`),N.url&&(W+=`<div class="mt-3"><a href="${N.url}" target="_blank" class="text-sm text-blue-600 hover:underline">Bekijk route en download GPX</a></div>`)}if(N.layerType==="hunebed"){N.period&&(W+=`<br/><span class="text-sm text-purple-700">Periode: ${N.period}</span>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',N.description&&(W+=`<div class="text-sm text-gray-700 mt-1">${N.description}</div>`);const q=[];if(N.stones){const le=N.stones.toLowerCase(),he=le.match(/(\d+)\s*dekst[^\s,]*/i),Ve=le.match(/(\d+)\s*draagst[^\s,]*/i),Se=le.match(/(\d+)\s*sluitst[^\s,]*/i),$e=le.match(/(\d+)\s*poortst[^\s,]*/i),et=le.match(/(\d+)\s*gangdekst[^\s,]*/i),dt=le.match(/(\d+)\s*gangzijst[^\s,]*/i);he&&q.push(`${he[1]} deksteen${parseInt(he[1])>1?"en":""} (de grote steen${parseInt(he[1])>1?"en":""} bovenop)`),Ve&&q.push(`${Ve[1]} draagstenen (de stenen die de dekstenen dragen)`),Se&&q.push(`${Se[1]} sluitsteen${parseInt(Se[1])>1?"en":""} (afsluiting aan de korte zijden)`),$e&&q.push(`${$e[1]} poortsteen${parseInt($e[1])>1?"en":""} (bij de ingang)`),et&&q.push(`${et[1]} gangdeksteen${parseInt(et[1])>1?"en":""} (boven de toegangsgang)`),dt&&q.push(`${dt[1]} gangzijstenen (langs de toegangsgang)`)}if(N.length&&q.push(`Een grafkamer van ${N.length} lang`),N.width&&q.push(`${N.width}`),q.length>0&&(W+='<div class="text-sm text-gray-700 mt-1">Het hunebed heeft:</div>',W+='<ul class="list-disc list-inside text-sm text-gray-700 mt-1 space-y-0.5">',q.forEach(le=>{W+=`<li>${le}</li>`}),W+="</ul>"),N.notable){const le=N.notable.toLowerCase();let he="Wat is hier bijzonder?";le.includes("grootste")?he="Waarom is dit het grootste hunebed?":le.includes("klein")||le.includes("kindhunebed")?he="Waarom is dit hunebed zo klein?":le.includes("cluster")||le.includes("naast elkaar")?he="Waarom liggen hier meerdere hunebedden?":(le.includes("enige")||le.includes("westelijk")||le.includes("noordelijk"))&&(he="Wat maakt deze locatie bijzonder?"),W+=`<div class="mt-3"><span class="text-sm font-semibold text-gray-800">${he}</span></div>`,W+=`<div class="text-sm text-gray-700 mt-1">${N.notable}</div>`}W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is de Trechterbeker cultuur?</span></div>',W+='<div class="text-sm text-gray-700 mt-1">De Trechterbeker cultuur is de naam voor de mensen die 5.000 jaar geleden in Nederland woonden. Ze maakten potten met een trechter-vorm. Daarom heten ze zo. Deze mensen bouwden de hunebedden als graven voor hun doden.</div>',N.finds&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is hier gevonden?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${N.finds}</div>`),N.museum&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Museum in de buurt</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${N.museum}</div>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bezoeken</span></div>',N.access?W+=`<div class="text-sm text-gray-700 mt-1">${N.access}</div>`:W+='<div class="text-sm text-gray-700 mt-1">Je kunt dit hunebed gratis bezoeken.</div>',N.wikipedia&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">Lees meer op <a href="${N.wikipedia}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`)}if((N.inventarisnummer||N.locatie_naam)&&(N.locatie_naam&&(W+=`<br/><span class="text-sm font-semibold">${N.locatie_naam}</span>`),N.inventarisnummer&&(W+=`<br/><span class="text-xs text-gray-500">CAI: ${N.inventarisnummer}</span>`),N.datering_tekst&&(W+=`<br/><span class="text-sm text-purple-700">${N.datering_tekst}</span>`)),(N.veensoort||N.dikte)&&(N.veensoort&&(W+=`<br/><span class="text-sm text-amber-700">${N.veensoort}</span>`),N.dikte&&(W+=`<br/><span class="text-xs text-gray-600">Dikte: ${N.dikte}</span>`)),N.nature&&N.debut){W+=`<br/><span class="text-sm text-purple-700">${N.nature}</span>`;const q=N.debut===N.fin?N.debut:`${N.debut} - ${N.fin}`;q&&(W+=`<br/><span class="text-sm text-gray-700">Periode: ${q}</span>`),N.structure&&(W+=`<br/><span class="text-xs text-gray-600">${N.structure}</span>`),N.commune&&(W+=`<br/><span class="text-xs text-gray-500">${N.commune}</span>`),N.decouvert&&(W+=`<br/><span class="text-xs text-gray-400">Ontdekt: ${N.decouvert}</span>`),N.numero&&(W+=`<br/><span class="text-xs text-gray-400">${N.numero}</span>`)}if((N.NATURE_OPE||N.CODE_OPERA)&&(N.TITRE&&(W+=`<br/><span class="text-sm font-semibold">${N.TITRE}</span>`),N.NATURE_OPE&&(W+=`<br/><span class="text-sm text-amber-700">${N.NATURE_OPE}</span>`),N.AUTEUR&&(W+=`<br/><span class="text-xs text-gray-600">Auteur: ${N.AUTEUR}</span>`),N.DATE&&(W+=`<br/><span class="text-xs text-gray-500">Datum: ${N.DATE}</span>`),N.COMMUNE&&(W+=`<br/><span class="text-xs text-gray-500">${N.COMMUNE}</span>`)),N.type_protection&&(N.n_site||N.t_site)){const q=N.type_protection==="Classe"?"text-red-700":"text-amber-700";W+=`<br/><span class="text-sm ${q}">${N.type_protection}</span>`,N.n_site&&(W+=`<br/><span class="text-sm font-semibold">${N.n_site}</span>`),N.t_site&&(W+=`<br/><span class="text-xs text-gray-600">${N.t_site}</span>`),N.c_site&&(W+=`<br/><span class="text-xs text-gray-500">Code: ${N.c_site}</span>`),N.d_creation&&(W+=`<br/><span class="text-xs text-gray-400">Beschermd sinds: ${N.d_creation}</span>`)}if(N.type_protection&&N.cod_diren){const q=N.type_protection==="Classe"?"text-red-700":"text-amber-700";if(W+=`<br/><span class="text-sm ${q}">${N.type_protection}</span>`,N.proced&&(W+=`<br/><span class="text-xs text-gray-600">${N.proced}</span>`),N.d_proced&&(W+=`<br/><span class="text-xs text-gray-500">Date: ${N.d_proced}</span>`),N.comment){const le=String(N.comment).slice(0,150);W+=`<br/><span class="text-xs text-gray-600 italic">${le}${String(N.comment).length>150?"...":""}</span>`}}if(N.type_protection&&N.nomsite){const q=N.type_protection==="Classe"?"text-red-700":"text-amber-700";if(W+=`<br/><span class="text-sm ${q}">${N.type_protection}</span>`,N.caractere&&(W+=`<br/><span class="text-xs text-gray-600">${N.caractere}</span>`),N.datedecis&&(W+=`<br/><span class="text-xs text-gray-500">Date: ${N.datedecis}</span>`),N.descriptio){const le=String(N.descriptio).slice(0,150);W+=`<br/><span class="text-xs text-gray-600 italic">${le}${String(N.descriptio).length>150?"...":""}</span>`}}if(N.secteur&&N.style){if(W+=`<br/><span class="text-sm text-gray-700">${N.secteur}</span>`,N["sous-secteur"]&&(W+=`<br/><span class="text-xs text-gray-600">${N["sous-secteur"]}</span>`),N.description){const q=String(N.description).slice(0,150);W+=`<br/><span class="text-xs text-gray-600 italic">${q}${String(N.description).length>150?"...":""}</span>`}N.url&&(W+=`<br/><a href="${N.url}" target="_blank" class="text-xs text-blue-600 hover:underline">Meer info</a>`)}if(N.nature_operation||N.synthese){N.nature_operation&&(W+=`<br/><span class="text-sm text-red-700">${N.nature_operation}</span>`),N.responsable_operation&&(W+=`<br/><span class="text-xs text-gray-600">Responsable: ${N.responsable_operation}</span>`),N.date_operation&&(W+=`<br/><span class="text-xs text-gray-500">Datum: ${N.date_operation}</span>`);const q=[];if(N.prehistoire==="Oui"&&q.push("Prehistorie"),N.protohistoire==="Oui"&&q.push("Protohistorie"),N.antiquite==="Oui"&&q.push("Romeins"),N.moyen_age==="Oui"&&q.push("Middeleeuwen"),N.temps_modernes==="Oui"&&q.push("Moderne tijd"),q.length>0&&(W+=`<br/><span class="text-sm text-purple-700">${q.join(", ")}</span>`),N.adresse&&(W+=`<br/><span class="text-xs text-gray-500">${N.adresse}</span>`),N.synthese){const le=String(N.synthese).slice(0,200);W+=`<br/><span class="text-xs text-gray-600 italic">${le}${String(N.synthese).length>200?"...":""}</span>`}}if(N.operator&&(W+=`<br/><span class="text-sm text-gray-600">${N.operator}</span>`),N.opening_hours){const q=Pwe(String(N.opening_hours));W+=`<br/><span class="text-xs text-green-600">Open: ${q}</span>`}if(N.website&&(W+=`<br/><a href="${N.website}" target="_blank" class="text-xs text-blue-600 underline">Website</a>`),N.addr_street){const q=[N.addr_street,N.addr_housenumber,N.addr_postcode].filter(Boolean).join(" ");W+=`<br/><span class="text-xs text-gray-500">${q}</span>`}const Z=N.description||N.omschrijving||N.descr||N.info;Z&&Z!==Pt&&(W+=`<br/><span class="text-sm text-gray-600">${Z}</span>`),Jt.push(W),Rt.push({geometry:rr(Ct),properties:N,popupHtml:W})}const Ut=n.getView().getResolution()||1,Ji=await jt(yt.coordinate,Ut);Jt.push(...Ji);for(const ve of Ji)Rt.push(null);const Oe=await si;if(Jt.length===0&&Oe!==null){const ve=`<strong class="text-blue-800">Terrein</strong>
          <br/><div class="mt-2 pt-2 border-t border-gray-100 flex items-center gap-1">
            <span class="text-xs text-gray-400">Hoogte:</span>
            <span class="text-sm font-medium text-blue-600">${Oe.toFixed(2)} m NAP</span>
          </div>`;Jt.push(ve),Rt.push(null)}if(Jt.length>0&&Oe!==null&&(Jt[0]+=`<br/><div class="mt-2 pt-2 border-t border-gray-100 flex items-center gap-1">
          <span class="text-xs text-gray-400">Hoogte:</span>
          <span class="text-sm font-medium text-blue-600">${Oe.toFixed(2)} m NAP</span>
        </div>`),Jt.length>0){l(Jt),V(Rt),h(0),console.log(` KLIK OPGESLAGEN: [${yt.coordinate[0].toFixed(0)}, ${yt.coordinate[1].toFixed(0)}]`),v(yt.coordinate),E(!1),L(!1),ce(!1),Ee(""),U(null);const ve=xn(yt.coordinate);Ie(ve),C(`https://www.google.com/maps/dir/?api=1&destination=${ve[1]},${ve[0]}`),g(!0)}};return n.on("click",kn),()=>{n.un("click",kn)}},[n]);const en=()=>{g(!1),n&&x&&(Vb(n),E(!1))},Zn=(gt,jt)=>{jt.offset.y>100&&en()};return p.jsx(jr,{children:f&&p.jsxs(p.Fragment,{children:[p.jsx(Ft.div,{className:"fixed inset-0 z-[1500]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:en}),p.jsxs(Ft.div,{className:"fixed bottom-0 left-0 right-0 z-[1501] bg-white rounded-t-2xl shadow-2xl",style:{fontSize:`${14*ne/100}px`},initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",damping:25,stiffness:300},drag:"y",dragConstraints:{top:0},dragElastic:.2,onDragEnd:Zn,children:[p.jsx("div",{className:"flex justify-center pt-2 pb-1",children:p.jsx("div",{className:"w-10 h-1 bg-gray-300 rounded-full"})}),p.jsxs("div",{className:"flex items-center gap-2 px-3 pb-2 border-b border-gray-100",children:[je&&p.jsxs("div",{className:"flex items-center gap-0.5 flex-shrink-0",children:[p.jsx("button",{onClick:Qt,className:"p-1 text-blue-500 hover:text-blue-600 transition-colors border-0 outline-none bg-transparent","aria-label":"Vorige laag",children:p.jsx(Zse,{size:18})}),p.jsxs("span",{className:"text-gray-500 font-medium min-w-[32px] text-center",style:{fontSize:"0.857em"},children:[u+1,"/",o.length]}),p.jsx("button",{onClick:ot,className:"p-1 text-blue-500 hover:text-blue-600 transition-colors border-0 outline-none bg-transparent","aria-label":"Volgende laag",children:p.jsx(Lw,{size:18})})]}),p.jsx("span",{className:"flex-1 font-semibold text-gray-800 truncate",style:{fontSize:"1em"},children:Gt||"Info"}),j&&p.jsxs("div",{className:"relative",children:[p.jsx("button",{onClick:()=>L(!P),className:`p-1.5 transition-colors flex-shrink-0 border-0 outline-none bg-transparent ${O?"text-green-500":"text-orange-500 hover:text-orange-600"}`,title:"Toevoegen aan mijn laag","aria-label":"Toevoegen aan mijn laag",children:O?p.jsx(Wl,{size:18}):p.jsx(oo,{size:18})}),P&&p.jsxs("div",{className:"absolute right-0 top-8 z-50 bg-white rounded-lg shadow-md py-1 min-w-[180px] max-w-[220px]",children:[p.jsx("div",{className:"px-3 py-1 text-xs text-gray-400 font-medium",children:"Toevoegen aan:"}),p.jsx("div",{className:"max-h-[200px] overflow-y-auto",children:i.filter(gt=>!gt.archived).map(gt=>p.jsxs("button",{onClick:()=>{const jt=J;s(gt.id,{name:Gt||"Punt",category:"Overig",notes:"",url:void 0,coordinates:[j[0],j[1]],sourceLayer:Gt,geometry:jt?.geometry,sourceProperties:jt?.properties,popupContent:jt?.popupHtml}),L(!1),U(gt.name),setTimeout(()=>U(null),2e3)},className:"w-full px-3 py-1.5 text-left text-sm text-gray-700 hover:bg-blue-50 border-0 outline-none bg-transparent flex items-center gap-2",children:[p.jsx("span",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{backgroundColor:gt.color}}),p.jsx("span",{className:"truncate",children:gt.name})]},gt.id))}),p.jsx("div",{className:"border-t border-gray-100 mt-1 pt-1",children:Ne?p.jsxs("div",{className:"px-2 py-1",children:[p.jsx("input",{type:"text",value:Te,onChange:gt=>Ee(gt.target.value),placeholder:"Naam nieuwe laag...",className:"w-full px-2 py-1 text-sm border border-gray-200 rounded focus:outline-none focus:border-orange-400",autoFocus:!0,onKeyDown:gt=>{if(gt.key==="Enter"&&Te.trim()){const jt=a(Te.trim()),kn=J;s(jt,{name:Gt||"Punt",category:"Overig",notes:"",url:void 0,coordinates:[j[0],j[1]],sourceLayer:Gt,geometry:kn?.geometry,sourceProperties:kn?.properties,popupContent:kn?.popupHtml}),L(!1),ce(!1),Ee(""),U(Te.trim()),setTimeout(()=>U(null),2e3)}else gt.key==="Escape"&&(ce(!1),Ee(""))}}),p.jsxs("div",{className:"flex gap-1 mt-1",children:[p.jsx("button",{onClick:()=>{if(Te.trim()){const gt=a(Te.trim()),jt=J;s(gt,{name:Gt||"Punt",category:"Overig",notes:"",url:void 0,coordinates:[j[0],j[1]],sourceLayer:Gt,geometry:jt?.geometry,sourceProperties:jt?.properties,popupContent:jt?.popupHtml}),L(!1),ce(!1),Ee(""),U(Te.trim()),setTimeout(()=>U(null),2e3)}},disabled:!Te.trim(),className:"flex-1 px-2 py-1 text-xs bg-orange-500 text-white rounded disabled:opacity-50",children:"Toevoegen"}),p.jsx("button",{onClick:()=>{ce(!1),Ee("")},className:"px-2 py-1 text-xs text-gray-500 hover:text-gray-700",children:"Annuleer"})]})]}):p.jsxs("button",{onClick:()=>ce(!0),className:"w-full px-3 py-1.5 text-left text-sm text-orange-600 hover:bg-orange-50 border-0 outline-none bg-transparent flex items-center gap-2",children:[p.jsx(oo,{size:14}),p.jsx("span",{children:"Nieuwe laag maken..."})]})})]})]}),k&&p.jsx("a",{href:k,target:"_blank",rel:"noopener noreferrer",className:"p-1.5 text-blue-500 hover:text-blue-600 transition-colors flex-shrink-0",title:"Open in Google Maps","aria-label":"Open in Google Maps",children:p.jsx(S1,{size:18})}),p.jsx("button",{onClick:en,className:"p-1.5 text-gray-400 hover:text-gray-600 transition-colors flex-shrink-0 border-0 outline-none bg-transparent","aria-label":"Sluiten",children:p.jsx(Qi,{size:18})})]}),p.jsx("div",{className:"px-4 py-3 max-h-[45vh] overflow-y-auto select-text",style:{userSelect:"text",WebkitUserSelect:"text"},dangerouslySetInnerHTML:{__html:wn}}),p.jsxs("div",{className:"px-4 py-2 border-t border-gray-100 flex items-center gap-2",children:[p.jsx(Eoe,{size:14,className:"text-gray-400 flex-shrink-0"}),p.jsx("input",{type:"range",min:"80",max:"150",value:ne,onChange:gt=>ue(parseInt(gt.target.value)),className:"flex-1 h-1.5 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500"}),p.jsxs("span",{className:"text-gray-400 w-8 text-right",style:{fontSize:"0.857em"},children:[ne,"%"]})]}),Fn&&I&&!F&&p.jsxs("div",{className:"px-4 pb-4 flex gap-2",children:[p.jsxs("button",{onClick:()=>{const gt=r.find(jt=>jt.id===I);gt&&z(gt)},className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-white bg-blue-500 hover:bg-blue-600 rounded-lg transition-colors border-0 outline-none",children:[p.jsx(Tp,{size:16}),p.jsx("span",{children:"Bewerken"})]}),p.jsxs("button",{onClick:()=>{e(I),g(!1),M(null)},className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-white bg-red-500 hover:bg-red-600 rounded-lg transition-colors border-0 outline-none",children:[p.jsx(pd,{size:16}),p.jsx("span",{children:"Verwijderen"})]})]}),F&&p.jsxs("div",{className:"px-4 pb-4 space-y-3 border-t border-gray-100 pt-3",children:[p.jsx("div",{className:"text-sm font-medium text-blue-600",children:"Vondst bewerken"}),p.jsxs("div",{children:[p.jsx("label",{className:"text-xs text-gray-500",children:"Objecttype"}),p.jsx("input",{type:"text",value:F.objectType,onChange:gt=>z({...F,objectType:gt.target.value}),className:"w-full px-2 py-1 text-sm bg-gray-50 rounded border-0 outline-none focus:bg-blue-50"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"text-xs text-gray-500",children:"Materiaal"}),p.jsx("input",{type:"text",value:F.material,onChange:gt=>z({...F,material:gt.target.value}),className:"w-full px-2 py-1 text-sm bg-gray-50 rounded border-0 outline-none focus:bg-blue-50"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"text-xs text-gray-500",children:"Periode"}),p.jsx("input",{type:"text",value:F.period,onChange:gt=>z({...F,period:gt.target.value}),className:"w-full px-2 py-1 text-sm bg-gray-50 rounded border-0 outline-none focus:bg-blue-50"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"text-xs text-gray-500",children:"Notities"}),p.jsx("textarea",{value:F.notes,onChange:gt=>z({...F,notes:gt.target.value}),className:"w-full px-2 py-1 text-sm bg-gray-50 rounded border-0 outline-none focus:bg-blue-50 resize-none h-16"})]}),p.jsxs("div",{className:"flex gap-2",children:[p.jsx("button",{onClick:()=>z(null),className:"flex-1 px-3 py-2 text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors border-0 outline-none text-sm",children:"Annuleren"}),p.jsx("button",{onClick:()=>{t(F.id,{objectType:F.objectType,material:F.material,period:F.period,notes:F.notes}),z(null),g(!1)},className:"flex-1 px-3 py-2 text-white bg-blue-500 hover:bg-blue-600 rounded-lg transition-colors border-0 outline-none text-sm",children:"Opslaan"})]})]}),Bt&&y&&p.jsx("div",{className:"px-4 pb-4 border-t border-gray-100",children:x?p.jsxs("button",{onClick:on,className:"w-full flex items-center justify-center gap-2 px-3 py-2 mt-3 text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors border-0 outline-none",children:[p.jsx(Sb,{size:16}),p.jsx("span",{children:"Hoogtekaart verbergen"})]}):p.jsx("button",{onClick:Xn,disabled:T,className:`w-full flex items-center justify-center gap-2 px-3 py-2 mt-3 text-white rounded-lg transition-colors border-0 outline-none ${T?"bg-blue-400 cursor-wait":"bg-blue-500 hover:bg-blue-600"}`,children:T?p.jsxs(p.Fragment,{children:[p.jsx(xR,{size:16,className:"animate-spin"}),p.jsx("span",{children:"Laden..."})]}):p.jsxs(p.Fragment,{children:[p.jsx(Sb,{size:16}),p.jsx("span",{children:"Hoogtekaart tonen"})]})})})]})]})})}const NO=1e-4;function Owe(n,e){return n.points.some(t=>{const r=Math.abs(t.coordinates[0]-e[0]),i=Math.abs(t.coordinates[1]-e[1]);return r<NO&&i<NO})}function Dwe(){const n=hs(P=>P.map),e=Or(P=>P.openVondstForm),{openAddPointModal:t,openCreateLayerModal:r,openLayerManagerModal:i}=Or(),s=Yi(P=>P.layers),[a,o]=ie.useState(null),[l,u]=ie.useState(!1),[h,f]=ie.useState(!1),[g,y]=ie.useState(!1),v=ie.useRef(null),x=ie.useRef(null);ie.useEffect(()=>{if(!n){console.log(" LongPressMenu: map not ready");return}const P=n.getViewport();if(!P){console.log(" LongPressMenu: viewport not ready");return}console.log(" LongPressMenu: attached to viewport",P);const L=600,O=15,U=Te=>{if(console.log(" Touch start, touches:",Te.touches.length),Te.touches.length!==1)return;const Ee=Te.touches[0];x.current={x:Ee.clientX,y:Ee.clientY},console.log(" Starting long press timer at:",x.current),v.current&&clearTimeout(v.current),v.current=window.setTimeout(()=>{if(console.log(" Timer fired! startPos:",x.current),!x.current)return;const se=window.__olMap;if(!se){console.log(" Map not available (global)");return}const V=P.getBoundingClientRect(),J=[x.current.x-V.left,x.current.y-V.top],ne=se.getCoordinateFromPixel(J);if(ne){const X=xn(ne);Te.preventDefault(),o({pixel:[x.current.x,x.current.y],coordinate:X}),u(!0),f(!1),setTimeout(()=>f(!0),300),"vibrate"in navigator&&navigator.vibrate(50),console.log(" Long press detected at:",X)}},L)},j=Te=>{if(!v.current||!x.current)return;const Ee=Te.touches[0],se=Ee.clientX-x.current.x,V=Ee.clientY-x.current.y,J=Math.sqrt(se*se+V*V);J>O&&(console.log(" Touch moved too much, cancelling. Distance:",J),clearTimeout(v.current),v.current=null)},Ie=()=>{console.log(" Touch end, timer active:",!!v.current),v.current&&(console.log(" Cancelling timer on touch end"),clearTimeout(v.current),v.current=null),x.current=null},ke=Te=>{l&&Te.preventDefault()},ze=Te=>{Te.button===0&&(console.log(" Mouse down"),x.current={x:Te.clientX,y:Te.clientY},v.current&&clearTimeout(v.current),v.current=window.setTimeout(()=>{if(console.log(" Mouse timer fired!"),!x.current)return;const Ee=window.__olMap;if(console.log(" __olMap:",Ee),console.log(" __olMap constructor:",Ee?.constructor?.name),console.log(" has getCoordinateAtPixel:",typeof Ee?.getCoordinateAtPixel),!Ee){console.log(" Map not available (global)");return}const se=P.getBoundingClientRect(),V=[x.current.x-se.left,x.current.y-se.top];console.log(" Pixel:",V);const J=Ee.getCoordinateFromPixel(V);if(console.log(" Coordinate:",J),J){const ne=xn(J);o({pixel:[x.current.x,x.current.y],coordinate:ne}),u(!0),f(!1),setTimeout(()=>f(!0),300),console.log(" Long press (mouse) detected at:",ne)}},L))},Ne=Te=>{if(!v.current||!x.current)return;const Ee=Te.clientX-x.current.x,se=Te.clientY-x.current.y;Math.sqrt(Ee*Ee+se*se)>O&&(console.log(" Mouse moved, cancelling"),clearTimeout(v.current),v.current=null)},ce=()=>{console.log(" Mouse up"),v.current&&(clearTimeout(v.current),v.current=null),x.current=null};return P.addEventListener("touchstart",U,{passive:!1}),P.addEventListener("touchmove",j,{passive:!0}),P.addEventListener("touchend",Ie),P.addEventListener("touchcancel",Ie),P.addEventListener("contextmenu",ke),P.addEventListener("mousedown",ze),P.addEventListener("mousemove",Ne),P.addEventListener("mouseup",ce),P.addEventListener("mouseleave",ce),()=>{P.removeEventListener("touchstart",U),P.removeEventListener("touchmove",j),P.removeEventListener("touchend",Ie),P.removeEventListener("touchcancel",Ie),P.removeEventListener("contextmenu",ke),P.removeEventListener("mousedown",ze),P.removeEventListener("mousemove",Ne),P.removeEventListener("mouseup",ce),P.removeEventListener("mouseleave",ce),v.current&&clearTimeout(v.current)}},[n,l]);const E=()=>{h&&(u(!1),o(null),f(!1),y(!1))},T=()=>{u(!1),o(null),f(!1),y(!1)},b=P=>{if(!a)return;const[L,O]=a.coordinate;t(P,{lat:O,lng:L}),T()},I=()=>{r(),T()},M=()=>{if(!a)return;const[P,L]=a.coordinate;e({lat:L,lng:P}),u(!1),o(null),f(!1)},F=()=>{if(!a)return;const[P,L]=a.coordinate,O=`https://www.google.com/maps?q=${L},${P}`;window.open(O,"_blank"),u(!1),o(null),f(!1)},z=()=>{if(!a)return;const P=document.createElement("input");P.type="file",P.accept="image/*",P.capture="environment",P.onchange=async L=>{const O=L.target.files?.[0];if(!O)return;const[U,j]=a.coordinate;e({lat:j,lng:U},O)},P.click(),T()},k=()=>{i(),T()},C=P=>{const[L,O]=P;return`${O.toFixed(5)}N, ${L.toFixed(5)}E`};return p.jsx(jr,{children:l&&a&&p.jsxs(p.Fragment,{children:[p.jsx(Ft.div,{className:"fixed inset-0 z-[1600]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:E}),p.jsxs(Ft.div,{className:"fixed z-[1601] bg-white rounded-xl shadow-md overflow-hidden min-w-[200px] border-0 outline-none",style:{left:Math.min(a.pixel[0],window.innerWidth-220),top:Math.min(a.pixel[1],window.innerHeight-240)},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.15},children:[p.jsx("div",{className:"px-4 py-3 bg-white border-b border-gray-100",children:p.jsxs("div",{className:"flex items-center gap-2 text-blue-600",children:[p.jsx(Hl,{size:16}),p.jsx("span",{className:"text-xs font-mono",children:C(a.coordinate)})]})}),p.jsxs("div",{className:"bg-white",children:[p.jsxs("button",{onClick:M,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-orange-50 text-gray-700 bg-white border-0 outline-none",children:[p.jsx(vb,{size:20,className:"text-orange-500"}),p.jsx("span",{className:"font-medium",children:"Vondst toevoegen"})]}),p.jsxs("button",{onClick:z,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-green-50 text-gray-700 bg-white border-0 outline-none",children:[p.jsx(yR,{size:20,className:"text-green-500"}),p.jsx("span",{className:"font-medium",children:"Foto maken"})]}),p.jsxs("div",{className:"relative",children:[p.jsxs("button",{onClick:()=>y(!g),className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-blue-50 text-gray-700 bg-white border-0 outline-none",children:[p.jsx(to,{size:20,className:"text-purple-500"}),p.jsx("span",{className:"font-medium flex-1 text-left",children:"Voeg toe aan laag..."}),p.jsx(Lw,{size:16,className:`text-gray-400 transition-transform ${g?"rotate-90":""}`})]}),p.jsx(jr,{children:g&&p.jsx(Ft.div,{className:"bg-gray-50 border-t border-gray-100",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},children:s.length===0?p.jsxs("button",{onClick:I,className:"w-full px-4 py-2 pl-11 flex items-center gap-2 text-sm text-purple-600 hover:bg-purple-50 bg-transparent border-0 outline-none",children:[p.jsx(oo,{size:14}),p.jsx("span",{children:"Maak eerst een laag aan"})]}):p.jsxs(p.Fragment,{children:[s.map(P=>{const L=a?Owe(P,a.coordinate):!1;return p.jsxs("button",{onClick:()=>!L&&b(P.id),className:`w-full px-4 py-2 pl-11 flex items-center gap-2 text-sm bg-transparent border-0 outline-none ${L?"text-gray-400 cursor-not-allowed":"text-gray-700 hover:bg-gray-100"}`,title:L?"Al toegevoegd aan deze laag":void 0,disabled:L,children:[L&&p.jsx(Wl,{size:14,className:"text-green-500 flex-shrink-0"}),p.jsx("span",{className:"truncate",children:P.name}),p.jsx("span",{className:"text-xs text-gray-400 ml-auto",children:L?"al toegevoegd":`(${P.points.length})`})]},P.id)}),p.jsxs("button",{onClick:I,className:"w-full px-4 py-2 pl-11 flex items-center gap-2 text-sm text-purple-600 hover:bg-purple-50 bg-transparent border-0 outline-none border-t border-gray-200",children:[p.jsx(oo,{size:14}),p.jsx("span",{children:"Nieuwe laag..."})]})]})})})]}),p.jsxs("button",{onClick:k,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-purple-50 text-gray-700 bg-white border-0 outline-none",children:[p.jsx(ooe,{size:20,className:"text-purple-500"}),p.jsx("span",{className:"font-medium",children:"Lagen beheren"})]}),p.jsxs("button",{onClick:F,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-blue-50 text-gray-700 bg-white border-0 outline-none",children:[p.jsx(S1,{size:20,className:"text-blue-600"}),p.jsx("span",{className:"font-medium",children:"Open in Google Maps"})]})]}),p.jsx("div",{className:"bg-white",children:p.jsxs("button",{onClick:T,className:"w-full px-4 py-3 flex items-center justify-center gap-2 text-gray-500 hover:bg-blue-50 transition-colors bg-white border-0 outline-none",children:[p.jsx(Qi,{size:18}),p.jsx("span",{children:"Annuleren"})]})})]})]})})}const Fwe={Compass:cae,TreePalm:voe,Mountain:Sb,Waves:Ioe,Search:Tb,Target:yoe,Layers:to,Grid:wae},jwe={Compass:"text-purple-600",Waves:"text-cyan-600",TreePalm:"text-green-600",Mountain:"text-stone-600",Search:"text-amber-600",Target:"text-red-600",Layers:"text-blue-600",Grid:"text-lime-600"},Vwe={Compass:"hover:bg-purple-50",Waves:"hover:bg-cyan-50",TreePalm:"hover:bg-green-50",Mountain:"hover:bg-stone-50",Search:"hover:bg-amber-50",Target:"hover:bg-red-50",Layers:"hover:bg-blue-50",Grid:"hover:bg-lime-50"},LO=["Mijn Vondsten","Labels Overlay","TMK 1850","Bonnebladen 1900","Hunebedden","FAMKE Steentijd","Grafheuvels","Terpen","AMK Monumenten","AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig","Romeinse wegen (regio)","Romeinse wegen (Wereld)","Romeinse Forten","Romeinse Forten Lijnen","Kastelen","IKAW","Archeo Landschappen","Rijksmonumenten","Werelderfgoed","Religieus Erfgoed","Essen","Runes","WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Inundatiegebieden","Militaire Objecten","Paleokaart 800 n.Chr.","Paleokaart 100 n.Chr.","Paleokaart 500 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 9000 v.Chr.","UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling","AHN4 Hoogtekaart Kleur","AHN4 Hillshade NL","AHN4 Multi-Hillshade NL","AHN 0.5m","Veengebieden","Geomorfologie","Bodemkaart","Fossiel Hotspots","Mineralen Hotspots","Goudrivieren","Fossielen Nederland","Fossielen Belgi","Fossielen Duitsland","Fossielen Frankrijk","Wandelroutes","Parken","Speeltuinen","Musea","Strandjes","Kringloopwinkels","Gewaspercelen","Kadastrale Grenzen","Scheepswrakken","Woonheuvels ZH","Windmolens","Erfgoedlijnen","Oude Kernen","Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken","Verdronken Dorpen"],Gwe=["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"],Bwe=[5.2913,52.1326],Uwe=8;function zwe(){const n=di(L=>L.setLayerVisibility),e=is(L=>L.stopTracking),t=hs(L=>L.map),{presetsPanelOpen:r,togglePresetsPanel:i,closeAllPanels:s}=Or(),{presets:a,applyPreset:o,updatePreset:l,createPreset:u,resetToDefaults:h}=z8(),f=di(L=>L.visible),g=Fr(L=>L.presetPanelFontScale),y=Fr(L=>L.setPresetPanelFontScale),v=12*g/100,[x,E]=ie.useState(null),[T,b]=ie.useState(!1),[I,M]=ie.useState(""),F=()=>{s(),LO.forEach(L=>n(L,!1)),Gwe.forEach(L=>{n(L,L==="CartoDB (licht)")}),e(),t&&t.getView().animate({center:Ho(Bwe),zoom:Uwe,duration:500}),console.log(" Reset: CartoDB, alle lagen uit, GPS uit, zoom naar Nederland")},z=L=>{o(L),s()},k=(L,O)=>{L.stopPropagation();const U=Object.entries(f).filter(([j,Ie])=>Ie&&LO.includes(j)).map(([j])=>j);l(O,{layers:U}),E(O),setTimeout(()=>E(null),2e3),console.log(" Lagen opgeslagen naar preset")},C=()=>{I.trim()&&(u(I.trim(),"Layers"),M(""),b(!1))},P=()=>{confirm("Alle presets terugzetten naar standaard? Dit verwijdert aangepaste presets.")&&h()};return p.jsxs(p.Fragment,{children:[p.jsx(Ft.button,{onClick:F,className:"fixed bottom-2 left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Reset - CartoDB, alle lagen uit, GPS uit",children:p.jsx(qae,{size:20,className:"text-gray-600"})}),p.jsx(Ft.button,{onClick:i,className:"fixed bottom-[60px] left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Presets",children:r?p.jsx(S9,{size:20,className:"text-blue-600"}):p.jsx(to,{size:20,className:"text-blue-600"})}),p.jsx(jr,{children:r&&p.jsxs(p.Fragment,{children:[p.jsx(Ft.div,{className:"fixed inset-0 z-[800]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:i}),p.jsxs(Ft.div,{initial:{opacity:0,x:-10,scale:.95},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:-10,scale:.95},transition:{duration:.15},className:"fixed bottom-[60px] left-[56px] bg-white/95 rounded-xl shadow-lg overflow-hidden w-[240px] backdrop-blur-sm z-[801]",children:[p.jsxs("div",{className:"flex items-center justify-between gap-2 px-3 py-1.5 bg-blue-500",style:{fontSize:`${v}px`},children:[p.jsx("span",{className:"font-medium text-white",children:"Presets"}),p.jsxs("div",{className:"flex items-center gap-1",children:[p.jsx("span",{className:"text-[9px] text-blue-200",children:"T"}),p.jsx("input",{type:"range",min:"80",max:"130",step:"10",value:g,onInput:L=>{y(parseInt(L.target.value))},onChange:L=>y(parseInt(L.target.value)),className:"w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${g}%`}),p.jsx("span",{className:"text-[11px] text-blue-200",children:"T"})]})]}),p.jsx("div",{className:"p-2 max-h-[300px] overflow-y-auto",children:a.map(L=>{const O=Fwe[L.icon]||to,U=jwe[L.icon]||"text-blue-600",j=Vwe[L.icon]||"hover:bg-blue-50",Ie=x===L.id;return p.jsxs("button",{onClick:()=>z(L.id),className:`w-full h-8 flex items-center gap-2 px-2 ${j} rounded text-left transition-colors border-0 outline-none bg-transparent overflow-hidden ${Ie?"bg-green-50":""}`,style:{fontSize:`${v}px`},children:[p.jsx(O,{size:14,className:`${U} flex-shrink-0`}),p.jsx("span",{className:"text-gray-700 truncate flex-1",children:L.name}),Ie?p.jsx("span",{className:"ml-auto p-1 flex-shrink-0",children:p.jsx(Wl,{size:14,className:"text-green-500"})}):p.jsx("span",{onClick:ke=>k(ke,L.id),className:"ml-auto p-1 hover:bg-gray-200 rounded transition-colors flex-shrink-0",title:"Huidige lagen opslaan naar deze preset",children:p.jsx(toe,{size:12,className:"text-gray-400 hover:text-blue-500"})})]},L.id)})}),p.jsx("div",{className:"border-t border-gray-200 p-2",children:T?p.jsxs("div",{className:"flex gap-1",children:[p.jsx("input",{type:"text",value:I,onChange:L=>M(L.target.value),onKeyDown:L=>{L.key==="Enter"&&C(),L.key==="Escape"&&b(!1)},placeholder:"Naam preset...",autoFocus:!0,className:"flex-1 px-2 py-1 text-sm rounded bg-gray-50 border-0 outline-none focus:ring-1 focus:ring-blue-400",style:{fontSize:`${v}px`}}),p.jsx("button",{onClick:C,disabled:!I.trim(),className:"px-2 py-1 bg-blue-500 text-white rounded text-sm disabled:opacity-50 border-0 outline-none",children:p.jsx(Wl,{size:14})})]}):p.jsxs("div",{className:"flex gap-1",children:[p.jsxs("button",{onClick:()=>b(!0),className:"flex-1 flex items-center justify-center gap-1 px-2 py-1.5 text-sm text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",style:{fontSize:`${v}px`},children:[p.jsx(oo,{size:14}),p.jsx("span",{children:"Nieuwe preset"})]}),p.jsx("button",{onClick:P,className:"p-1.5 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded transition-colors border-0 outline-none",title:"Presets terugzetten naar standaard",children:p.jsx(Zae,{size:14})})]})})]})]})})]})}function $we(){const n=hs(a=>a.map),[e,t]=ie.useState(0),[r,i]=ie.useState(!1);ie.useEffect(()=>{if(!n)return;const a=n.getView(),o=()=>{const l=a.getRotation(),u=l*180/Math.PI;t(u),i(Math.abs(l)>.087)};return o(),a.on("change:rotation",o),()=>{a.un("change:rotation",o)}},[n]);const s=()=>{n&&n.getView().animate({rotation:0,duration:300})};return p.jsx(jr,{children:r&&p.jsx(Ft.button,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.2},onClick:s,className:"fixed top-[60px] right-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",title:"Klik om noorden te herstellen",children:p.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",style:{transform:`rotate(${-e}deg)`},children:[p.jsx("path",{d:"M12 2 L14.5 12 L12 10 L9.5 12 Z",fill:"#EA4335"}),p.jsx("path",{d:"M12 22 L9.5 12 L12 14 L14.5 12 Z",fill:"white",stroke:"#9CA3AF",strokeWidth:"0.5"}),p.jsx("circle",{cx:"12",cy:"12",r:"2",fill:"#374151"})]})})})}const Wwe=[{name:"AHN4 Hoogtekaart Kleur",color:"blue",default:.85},{name:"AHN4 Hillshade NL",color:"blue",default:.7},{name:"AHN4 Multi-Hillshade NL",color:"blue",default:.7},{name:"AHN 0.5m",color:"blue",default:.7},{name:"TMK 1850",color:"amber",default:.8},{name:"Bonnebladen 1900",color:"amber",default:.8},{name:"Geomorfologie",color:"green",default:.5},{name:"Bodemkaart",color:"amber",default:.6},{name:"Veengebieden",color:"amber",default:.6},{name:"IKAW",color:"orange",default:.5},{name:"Archeo Landschappen",color:"green",default:.5},{name:"Terpen",color:"orange",default:.7},{name:"Essen",color:"amber",default:.6},{name:"Paleokaart 9000 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 5500 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 2750 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 1500 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 500 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 100 n.Chr.",color:"indigo",default:.7},{name:"Paleokaart 800 n.Chr.",color:"indigo",default:.7},{name:"Verdedigingslinies",color:"red",default:.7},{name:"Inundatiegebieden",color:"red",default:.5},{name:"Gewaspercelen",color:"green",default:.6},{name:"Erfgoedlijnen",color:"purple",default:.7},{name:"Oude Kernen",color:"orange",default:.6},{name:"Relictenkaart Vlakken",color:"green",default:.5}],Hwe={blue:"accent-blue-500",amber:"accent-amber-500",red:"accent-red-500",indigo:"accent-indigo-500",green:"accent-green-500",orange:"accent-orange-500",purple:"accent-purple-500"};function Kwe(){const[n,e]=ie.useState(!1),[t,r]=ie.useState(!1),i=di(h=>h.visible),s=di(h=>h.opacity),a=di(h=>h.setLayerOpacity),o=Wwe.filter(h=>i[h.name]);if(o.length===0)return null;const l=t?o:o.slice(0,3),u=o.length>3;return p.jsxs("div",{className:"fixed bottom-[112px] right-2 z-[900]",children:[p.jsxs(Ft.button,{onClick:()=>e(!n),className:"w-11 h-11 bg-white/80 rounded-xl backdrop-blur-sm shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none hover:bg-white/90 transition-colors",whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":"Opacity sliders",title:n?"Sluit opacity sliders":"Open opacity sliders",children:[p.jsx(coe,{size:22,strokeWidth:2,className:"text-gray-500"}),o.length>0&&p.jsx("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-blue-500 text-white text-[10px] rounded-full flex items-center justify-center",children:o.length})]}),p.jsx(jr,{children:n&&p.jsxs(p.Fragment,{children:[p.jsx(Ft.div,{className:"fixed inset-0 z-[-1]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>e(!1)}),p.jsxs(Ft.div,{initial:{opacity:0,x:20,scale:.9},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:20,scale:.9},transition:{duration:.2},className:"absolute bottom-0 right-14 bg-white/95 rounded-lg shadow-lg p-3 min-w-[220px] max-h-[60vh] overflow-y-auto",children:[p.jsx("div",{className:"text-xs font-semibold text-gray-500 mb-2 uppercase tracking-wide",children:"Transparantie"}),p.jsx("div",{className:"space-y-3",children:l.map(h=>{const f=s[h.name]??h.default;return p.jsxs("div",{children:[p.jsx("label",{className:"text-xs font-medium text-gray-700 mb-1 block truncate",title:h.name,children:h.name}),p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("input",{type:"range",min:"0",max:"100",value:f*100,onChange:g=>a(h.name,parseInt(g.target.value)/100),className:`flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer ${Hwe[h.color]}`}),p.jsxs("span",{className:"text-xs text-gray-500 w-8 text-right select-none pointer-events-none",children:[Math.round(f*100),"%"]})]})]},h.name)})}),u&&p.jsx("button",{onClick:()=>r(!t),className:"w-full mt-3 pt-2 border-t border-gray-200 flex items-center justify-center gap-1 text-xs text-gray-500 hover:text-gray-700",children:t?p.jsxs(p.Fragment,{children:[p.jsx(S9,{size:14}),"Minder tonen"]}):p.jsxs(p.Fragment,{children:[p.jsx(_R,{size:14}),o.length-3," meer..."]})})]})]})})]})}function Ywe(){const n=hs(I=>I.map),[e,t]=ie.useState(!1),[r,i]=ie.useState(""),[s,a]=ie.useState([]),[o,l]=ie.useState(!1),[u,h]=ie.useState(!1),f=ie.useRef(null),g=ie.useRef(null),y=ie.useRef();ie.useEffect(()=>{e&&f.current&&f.current.focus()},[e]),ie.useEffect(()=>{if(!e)return;const I=M=>{g.current&&!g.current.contains(M.target)&&v()};return document.addEventListener("mousedown",I),()=>document.removeEventListener("mousedown",I)},[e]),ie.useEffect(()=>{if(!e)return;const I=M=>{M.key==="Escape"&&v()};return document.addEventListener("keydown",I),()=>document.removeEventListener("keydown",I)},[e]),ie.useEffect(()=>{if(y.current&&clearTimeout(y.current),r.length<2){a([]);return}return y.current=window.setTimeout(async()=>{h(!0);try{const M=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/suggest?q=${encodeURIComponent(r)}&rows=7`)).json();M.response?.docs&&a(M.response.docs)}catch(I){console.error("Search error:",I),a([])}finally{h(!1)}},300),()=>{y.current&&clearTimeout(y.current)}},[r]);const v=()=>{t(!1),i(""),a([]),l(!1)},x=async I=>{try{const F=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/lookup?id=${encodeURIComponent(I)}`)).json();if(F.response?.docs?.[0]?.centroide_ll){const k=F.response.docs[0].centroide_ll.match(/POINT\(([^ ]+) ([^)]+)\)/);if(k)return{lng:parseFloat(k[1]),lat:parseFloat(k[2])}}}catch(M){console.error("Lookup error:",M)}return null},E=async I=>{if(!n)return;const M=await x(I.id);M&&n.getView().animate({center:Ho([M.lng,M.lat]),zoom:16,duration:1e3}),v()},T=async(I,M)=>{M.stopPropagation();const F=await x(I.id);if(F){const z=`https://www.google.com/maps?q=${F.lat},${F.lng}`;window.open(z,"_blank")}v()},b={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"};return e?p.jsxs("div",{ref:g,className:"fixed left-[52px] right-14 z-[850]",style:b,children:[p.jsxs(Ft.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"search-input-wrapper",children:[p.jsx(Tb,{size:18,className:"search-icon"}),p.jsx("input",{ref:f,type:"text",value:r,onChange:I=>{i(I.target.value),l(!0)},onFocus:()=>l(!0),placeholder:"Zoek adres of plaats...",className:"search-input"}),p.jsx("button",{onClick:v,className:"search-clear",title:"Sluiten",children:p.jsx(Qi,{size:18})})]}),p.jsx(jr,{children:o&&s.length>0&&p.jsx(Ft.ul,{className:"search-results",initial:{opacity:0,y:-8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},children:s.map(I=>p.jsxs("li",{className:"search-result-item",children:[p.jsx("div",{className:"search-result-content",onClick:()=>E(I),children:p.jsx("span",{className:"search-result-text",children:I.weergavenaam})}),p.jsx("button",{className:"search-navigate-btn",onClick:M=>T(I,M),title:"Open in Google Maps",children:p.jsx(S1,{size:20})})]},I.id))})}),o&&u&&p.jsx("div",{className:"search-loading",children:"Zoeken..."})]}):p.jsx(Ft.button,{className:"fixed right-14 z-[800] w-11 h-11 flex items-center justify-center bg-white/90 hover:bg-white rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",style:b,onClick:()=>t(!0),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Zoeken",children:p.jsx(Tb,{size:22,className:"text-gray-600"})})}function qwe(){const n=hs(r=>r.map),e=()=>{if(!n)return;const r=n.getView(),i=r.getZoom();i!==void 0&&r.animate({zoom:i+1,duration:200})},t=()=>{if(!n)return;const r=n.getView(),i=r.getZoom();i!==void 0&&r.animate({zoom:i-1,duration:200})};return p.jsxs("div",{className:"fixed top-2 left-2 z-[800] flex flex-col gap-1",children:[p.jsx(Ft.button,{className:"w-9 h-9 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},title:"Inzoomen",children:p.jsx(oo,{size:18,className:"text-gray-600"})}),p.jsx(Ft.button,{className:"w-9 h-9 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",onClick:t,whileHover:{scale:1.05},whileTap:{scale:.95},title:"Uitzoomen",children:p.jsx(jae,{size:18,className:"text-gray-600"})})]})}const Xwe="detector2024",$b="detectorapp-auth";function Zwe({children:n}){const[e,t]=ie.useState(!1),[r,i]=ie.useState(""),[s,a]=ie.useState(!1),[o,l]=ie.useState(""),[u,h]=ie.useState(!0);ie.useEffect(()=>{localStorage.getItem($b)==="authenticated"&&t(!0),h(!1)},[]);const f=g=>{g.preventDefault(),l(""),r===Xwe?(localStorage.setItem($b,"authenticated"),t(!0)):(l("Onjuist wachtwoord"),i(""))};return u?p.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-blue-600 to-blue-800 flex items-center justify-center",children:p.jsx("div",{className:"text-white text-lg",children:"Laden..."})}):e?p.jsx(p.Fragment,{children:n}):p.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-blue-600 to-blue-800 flex items-center justify-center p-4",children:p.jsxs(Ft.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-sm",children:[p.jsxs("div",{className:"text-center mb-6",children:[p.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:p.jsx(Eb,{size:32,className:"text-blue-600"})}),p.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"DetectorApp"}),p.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Test versie - Toegang beveiligd"})]}),p.jsxs("form",{onSubmit:f,className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Wachtwoord"}),p.jsxs("div",{className:"relative",children:[p.jsx("input",{type:s?"text":"password",value:r,onChange:g=>i(g.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none pr-12",placeholder:"Voer wachtwoord in",autoFocus:!0}),p.jsx("button",{type:"button",onClick:()=>a(!s),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:s?p.jsx(b9,{size:20}):p.jsx(I9,{size:20})})]})]}),o&&p.jsx(Ft.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-red-500 text-sm text-center",children:o}),p.jsx("button",{type:"submit",className:"w-full py-3 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors",children:"Inloggen"})]}),p.jsx("p",{className:"text-center text-xs text-gray-400 mt-6",children:"Alleen voor testers"})]})})}function Qwe(){localStorage.removeItem($b),window.location.reload()}function Jwe({isOpen:n,onClose:e}){const t=$o(l=>l.vondsten),r={total:t.length,byType:{},byMaterial:{},byPeriod:{},byCondition:{},avgDepth:0,totalWeight:0,recent:t.slice(-5).reverse()};let i=0,s=0;t.forEach(l=>{r.byType[l.objectType]=(r.byType[l.objectType]||0)+1,r.byMaterial[l.material]=(r.byMaterial[l.material]||0)+1,r.byPeriod[l.period]=(r.byPeriod[l.period]||0)+1,l.condition&&(r.byCondition[l.condition]=(r.byCondition[l.condition]||0)+1),l.depth&&(i+=l.depth,s++),l.weight&&(r.totalWeight+=l.weight)}),r.avgDepth=s>0?Math.round(i/s):0;const a=l=>Object.entries(l).sort((u,h)=>h[1]-u[1]),o=l=>Math.max(...Object.values(l),1);return p.jsx(jr,{children:n&&p.jsxs(p.Fragment,{children:[p.jsx(Ft.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),p.jsxs(Ft.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-md mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},children:[p.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(E9,{size:18}),p.jsx("span",{className:"font-medium",children:"Mijn Vondsten Dashboard"})]}),p.jsx("button",{onClick:e,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none",children:p.jsx(Qi,{size:18})})]}),p.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-5",children:t.length===0?p.jsxs("div",{className:"text-center py-8 text-gray-500",children:[p.jsx(Hl,{size:48,className:"mx-auto mb-3 opacity-30"}),p.jsx("p",{className:"font-medium",children:"Nog geen vondsten"}),p.jsx("p",{className:"text-sm mt-1",children:"Voeg je eerste vondst toe via de oranje knop of long-press op de kaart"})]}):p.jsxs(p.Fragment,{children:[p.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[p.jsx(KS,{icon:p.jsx(Hl,{size:20}),value:r.total,label:"Totaal",color:"bg-orange-100 text-orange-700"}),p.jsx(KS,{icon:p.jsx(Jae,{size:20}),value:r.avgDepth>0?`${r.avgDepth}cm`:"-",label:"Gem. diepte",color:"bg-blue-100 text-blue-700"}),p.jsx(KS,{icon:p.jsx(roe,{size:20}),value:r.totalWeight>0?`${r.totalWeight.toFixed(1)}g`:"-",label:"Tot. gewicht",color:"bg-green-100 text-green-700"})]}),p.jsx(S_,{title:"Per Type",data:a(r.byType),max:o(r.byType),color:"bg-orange-500"}),p.jsx(S_,{title:"Per Periode",data:a(r.byPeriod),max:o(r.byPeriod),color:"bg-amber-500"}),p.jsx(S_,{title:"Per Materiaal",data:a(r.byMaterial),max:o(r.byMaterial),color:"bg-blue-500"}),Object.keys(r.byCondition).length>0&&p.jsx(S_,{title:"Per Conditie",data:a(r.byCondition),max:o(r.byCondition),color:"bg-green-500"}),p.jsxs("div",{children:[p.jsxs("h3",{className:"text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2",children:[p.jsx(Wse,{size:14}),"Recente Vondsten"]}),p.jsx("div",{className:"space-y-2",children:r.recent.map(l=>p.jsxs("div",{className:"flex items-center justify-between py-2 px-3 bg-gray-50 rounded-lg",children:[p.jsxs("div",{children:[p.jsx("span",{className:"font-medium text-sm text-gray-800",children:l.objectType}),p.jsx("span",{className:"text-gray-400 mx-1",children:"-"}),p.jsx("span",{className:"text-sm text-gray-600",children:l.material})]}),p.jsx("span",{className:"text-xs text-gray-400",children:new Date(l.timestamp).toLocaleDateString("nl-NL")})]},l.id))})]})]})})]})]})})}function KS({icon:n,value:e,label:t,color:r}){return p.jsxs("div",{className:`rounded-lg p-3 ${r}`,children:[p.jsx("div",{className:"flex items-center gap-2 mb-1 opacity-70",children:n}),p.jsx("div",{className:"text-xl font-bold",children:e}),p.jsx("div",{className:"text-xs opacity-70",children:t})]})}function S_({title:n,data:e,max:t,color:r}){return e.length===0?null:p.jsxs("div",{children:[p.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:n}),p.jsx("div",{className:"space-y-1.5",children:e.slice(0,6).map(([i,s])=>p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("div",{className:"w-24 text-xs text-gray-600 truncate",title:i,children:i}),p.jsx("div",{className:"flex-1 h-4 bg-gray-100 rounded-full overflow-hidden",children:p.jsx(Ft.div,{className:`h-full ${r} rounded-full`,initial:{width:0},animate:{width:`${s/t*100}%`},transition:{duration:.5,ease:"easeOut"}})}),p.jsx("div",{className:"w-6 text-xs text-gray-600 text-right font-medium",children:s})]},i))})]})}function eEe(n){const{type:e,coordinates:t}=n,r=o=>Ho(o),i=o=>o.map(r),s=o=>o.map(i),a=o=>o.map(s);switch(e){case"Point":return new Js(r(t));case"LineString":return new so(i(t));case"Polygon":return new Ia(s(t));case"MultiPoint":return new ld(i(t));case"MultiLineString":return new Vl(s(t));case"MultiPolygon":return new jh(a(t));default:return console.warn(`Unsupported geometry type: ${e}`),null}}function tEe(n,e,t){const r=n.color,i=10,s=5,a=14;let o=i;if(t>50?o=s:t>10?o=Math.max(s,i-(t-10)/10):t<2&&(o=a),e==="Point"||e==="MultiPoint")return new nr({image:new Yo({radius:o,fill:new Wr({color:r}),stroke:new Ci({color:"#ffffff",width:2})})});if(e==="LineString"||e==="MultiLineString")return new nr({stroke:new Ci({color:r,width:3})});if(e==="Polygon"||e==="MultiPolygon"){const l=nEe(r,.3);return new nr({fill:new Wr({color:l}),stroke:new Ci({color:r,width:2})})}return new nr({image:new Yo({radius:o,fill:new Wr({color:r}),stroke:new Ci({color:"#ffffff",width:2})})})}function nEe(n,e){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(n);if(t){const r=parseInt(t[1],16),i=parseInt(t[2],16),s=parseInt(t[3],16);return`rgba(${r}, ${i}, ${s}, ${e})`}return n}function rEe(){const n=hs(r=>r.map),e=_1(r=>r.layers),t=ie.useRef(new Map);return ie.useEffect(()=>{if(!n)return;const r=new Set;e.forEach(i=>{r.add(i.id);const s=new Kp;i.features.features.forEach((o,l)=>{if(!o.geometry)return;const u=eEe(o.geometry);if(!u)return;const h=new io({geometry:u,...o.properties,layerType:"importedLayer",layerId:i.id,layerName:i.name,layerColor:i.color,featureIndex:l});h.setStyle((f,g)=>tEe(i,o.geometry.type,g)),s.addFeature(h)});const a=t.current.get(i.id);if(a)a.setSource(s),a.setVisible(i.visible),a.setOpacity(i.opacity);else{const o=new Qp({source:s,zIndex:900,visible:i.visible,opacity:i.opacity,properties:{title:i.name,customLayerId:i.id}});n.addLayer(o),t.current.set(i.id,o)}}),t.current.forEach((i,s)=>{r.has(s)||(n.removeLayer(i),t.current.delete(s))})},[n,e]),ie.useEffect(()=>()=>{n&&(t.current.forEach(r=>{n.removeLayer(r)}),t.current.clear())},[n]),null}vn.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs");M7(vn);function iEe(n){if(!n||n.length<2)return"unknown";const[e,t]=n;return e>=7e3&&e<=3e5&&t>=289e3&&t<=629e3?"RD":Math.abs(e)<=180&&Math.abs(t)<=90?"WGS84":"unknown"}function sEe(n){const[e,t]=n;return vn("EPSG:28992","EPSG:4326",[e,t])}function fG(n,e){return typeof n[0]=="number"?e(n):n.map(t=>fG(t,e))}function aEe(n){const e=n.coordinates;return!e||Array.isArray(e)&&e.length===0?null:n.type==="Point"?e:n.type==="LineString"||n.type==="MultiPoint"?e[0]:n.type==="Polygon"||n.type==="MultiLineString"?e[0]?.[0]:n.type==="MultiPolygon"?e[0]?.[0]?.[0]:null}async function oEe(n){const e=[],t=[];try{const r=await n.text(),i=JSON.parse(r);if(!i.type)return e.push('Ongeldig GeoJSON: geen "type" veld gevonden'),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:t,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}};let s=[];i.type==="FeatureCollection"?s=i.features||[]:i.type==="Feature"?s=[i]:i.type==="GeometryCollection"?s=(i.geometries||[]).map((u,h)=>({type:"Feature",geometry:u,properties:{id:h}})):s=[{type:"Feature",geometry:i,properties:{}}],s.length===0&&t.push("Geen features gevonden in bestand");let a="unknown",o=!1;if(s.length>0&&s[0].geometry){const u=aEe(s[0].geometry);u&&(a=iEe(u))}a==="RD"&&(t.push("Rijksdriehoek coordinaten gedetecteerd, worden omgezet naar WGS84"),o=!0,s=s.map(u=>{if(!u.geometry)return u;const h=fG(u.geometry.coordinates,sEe);return{...u,geometry:{...u.geometry,coordinates:h}}}),a="WGS84");const l=[...new Set(s.filter(u=>u.geometry).map(u=>u.geometry.type))];return{success:!0,features:{type:"FeatureCollection",features:s},errors:e,warnings:t,metadata:{featureCount:s.length,geometryTypes:l,coordinateSystem:a,transformed:o}}}catch(r){return e.push(`Fout bij parsen: ${r instanceof Error?r.message:"Onbekende fout"}`),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:t,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}async function lEe(n){const e=[],t=[];try{const r=await n.text(),s=new l0e({extractStyles:!1}).readFeatures(r,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"});s.length===0&&t.push("Geen features gevonden in KML bestand");const l=new OR().writeFeaturesObject(s,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"}).features.map((h,f)=>{const g={...h.properties},y=g.name||g.Name||`Feature ${f+1}`,v=g.description||g.Description||"";return{type:"Feature",geometry:h.geometry,properties:{...g,name:y,description:v}}}),u=[...new Set(l.filter(h=>h.geometry).map(h=>h.geometry.type))];return{success:!0,features:{type:"FeatureCollection",features:l},errors:e,warnings:t,metadata:{featureCount:l.length,geometryTypes:u,coordinateSystem:"WGS84",transformed:!1}}}catch(r){return e.push(`Fout bij parsen KML: ${r instanceof Error?r.message:"Onbekende fout"}`),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:t,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}async function cEe(n){const e=[],t=[];try{const r=await n.text(),s=new Efe().readFeatures(r,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"});s.length===0&&t.push("Geen features gevonden in GPX bestand");const l=new OR().writeFeaturesObject(s,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"}).features.map((h,f)=>{const g={...h.properties},y=g.name||g.Name||`Waypoint ${f+1}`,v=g.desc||g.description||"",x=g.time||null,E=g.ele||null;return{type:"Feature",geometry:h.geometry,properties:{...g,name:y,description:v,time:x,elevation:E}}}),u=[...new Set(l.filter(h=>h.geometry).map(h=>h.geometry.type))];return u.includes("LineString")&&t.push("GPX track routes worden als lijnen weergegeven"),{success:!0,features:{type:"FeatureCollection",features:l},errors:e,warnings:t,metadata:{featureCount:l.length,geometryTypes:u,coordinateSystem:"WGS84",transformed:!1}}}catch(r){return e.push(`Fout bij parsen GPX: ${r instanceof Error?r.message:"Onbekende fout"}`),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:t,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}function dC(n){switch(n.split(".").pop()?.toLowerCase()){case"geojson":case"json":return"geojson";case"kml":case"kmz":return"kml";case"gpx":return"gpx";default:return"unsupported"}}function uEe(){return".geojson,.json,.kml,.gpx"}function fC(){return"GeoJSON, KML (Google My Maps), GPX"}async function hEe(n){switch(dC(n.name)){case"geojson":return oEe(n);case"kml":return lEe(n);case"gpx":return cEe(n);case"unsupported":default:return{success:!1,features:{type:"FeatureCollection",features:[]},errors:[`Niet-ondersteund bestandsformaat: ${n.name}. Ondersteunde formaten: ${fC()}`],warnings:[],metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}function dEe(n){return n.size>10485760?{valid:!1,error:`Bestand te groot (${(n.size/1024/1024).toFixed(1)} MB). Maximum is 10 MB.`}:dC(n.name)==="unsupported"?{valid:!1,error:`Niet-ondersteund bestandsformaat. Ondersteunde formaten: ${fC()}`}:n.name.toLowerCase().endsWith(".kmz")?{valid:!1,error:"KMZ bestanden worden nog niet ondersteund. Pak het bestand uit en importeer het .kml bestand."}:{valid:!0}}function fEe({isOpen:n,onClose:e}){const t=_1(C=>C.addLayer),r=ie.useRef(null),[i,s]=ie.useState("idle"),[a,o]=ie.useState(null),[l,u]=ie.useState(null),[h,f]=ie.useState(""),[g,y]=ie.useState(null),[v,x]=ie.useState(!1),E=ie.useCallback(()=>{s("idle"),o(null),u(null),f(""),y(null),r.current&&(r.current.value="")},[]),T=ie.useCallback(()=>{E(),e()},[E,e]),b=ie.useCallback(async C=>{const P=dEe(C);if(!P.valid){y(P.error||"Ongeldig bestand"),s("error");return}o(C),s("parsing"),y(null);const L=C.name.replace(/\.[^/.]+$/,"");f(L);try{const O=await hEe(C);if(!O.success){y(O.errors.join(`
`)),s("error");return}if(O.features.features.length===0){y("Geen features gevonden in het bestand"),s("error");return}u(O),s("preview")}catch(O){y(O instanceof Error?O.message:"Onbekende fout bij parsen"),s("error")}},[]),I=ie.useCallback(C=>{const P=C.target.files?.[0];P&&b(P)},[b]),M=ie.useCallback(C=>{C.preventDefault(),x(!0)},[]),F=ie.useCallback(C=>{C.preventDefault(),x(!1)},[]),z=ie.useCallback(C=>{C.preventDefault(),x(!1);const P=C.dataTransfer.files?.[0];P&&b(P)},[b]),k=ie.useCallback(()=>{if(!l||!h.trim())return;const C=a?dC(a.name):"geojson";t({name:h.trim(),type:C==="unsupported"?"geojson":C,features:l.features,visible:!0,opacity:1,color:"",sourceFileName:a?.name||"unknown"}),T()},[l,h,a,t,T]);return p.jsx(jr,{children:n&&p.jsxs(p.Fragment,{children:[p.jsx(Ft.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:T}),p.jsxs(Ft.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-md mx-auto my-auto max-h-[80vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[p.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-purple-500 to-purple-600 text-white",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(Ow,{size:18}),p.jsx("span",{className:"font-medium",children:"Laag Importeren"})]}),p.jsx("button",{onClick:T,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none",children:p.jsx(Qi,{size:18})})]}),p.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[i==="idle"&&p.jsxs(p.Fragment,{children:[p.jsxs("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${v?"border-purple-500 bg-purple-50":"border-gray-300 hover:border-gray-400"}`,onDragOver:M,onDragLeave:F,onDrop:z,children:[p.jsx(A9,{size:40,className:"mx-auto text-gray-400 mb-3"}),p.jsx("p",{className:"text-gray-600 mb-2",children:"Sleep een bestand hierheen"}),p.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"of"}),p.jsx("button",{onClick:()=>r.current?.click(),className:"px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors border-0 outline-none",children:"Bestand kiezen"}),p.jsx("input",{ref:r,type:"file",accept:uEe(),onChange:I,className:"hidden"})]}),p.jsxs("div",{className:"text-xs text-gray-500 text-center",children:[p.jsx("p",{className:"font-medium",children:"Ondersteunde formaten:"}),p.jsx("p",{children:fC()})]})]}),i==="parsing"&&p.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[p.jsx(xR,{size:40,className:"text-purple-500 animate-spin mb-4"}),p.jsx("p",{className:"text-gray-600",children:"Bestand verwerken..."}),p.jsx("p",{className:"text-gray-400 text-sm",children:a?.name})]}),i==="error"&&p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{className:"flex items-start gap-3 p-4 bg-red-50 rounded-lg",children:[p.jsx(T9,{size:20,className:"text-red-500 flex-shrink-0 mt-0.5"}),p.jsxs("div",{children:[p.jsx("p",{className:"font-medium text-red-700",children:"Import mislukt"}),p.jsx("p",{className:"text-sm text-red-600 mt-1 whitespace-pre-wrap",children:g})]})]}),p.jsx("button",{onClick:E,className:"w-full px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors border-0 outline-none",children:"Opnieuw proberen"})]}),i==="preview"&&l&&p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{className:"flex items-start gap-3 p-3 bg-green-50 rounded-lg",children:[p.jsx(nae,{size:20,className:"text-green-500 flex-shrink-0 mt-0.5"}),p.jsxs("div",{children:[p.jsx("p",{className:"font-medium text-green-700",children:"Bestand geladen"}),p.jsx("p",{className:"text-sm text-green-600",children:a?.name})]})]}),l.warnings.length>0&&p.jsxs("div",{className:"p-3 bg-amber-50 rounded-lg",children:[p.jsx("p",{className:"font-medium text-amber-700 text-sm",children:"Let op:"}),p.jsx("ul",{className:"text-sm text-amber-600 mt-1 list-disc list-inside",children:l.warnings.map((C,P)=>p.jsx("li",{children:C},P))})]}),p.jsx("div",{className:"p-3 bg-gray-50 rounded-lg text-sm",children:p.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[p.jsxs("div",{children:[p.jsx("span",{className:"text-gray-500",children:"Features:"}),p.jsx("span",{className:"ml-2 font-medium",children:l.metadata.featureCount})]}),p.jsxs("div",{children:[p.jsx("span",{className:"text-gray-500",children:"Types:"}),p.jsx("span",{className:"ml-2 font-medium",children:l.metadata.geometryTypes.join(", ")||"-"})]})]})}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Naam van de laag"}),p.jsx("input",{type:"text",value:h,onChange:C=>f(C.target.value),placeholder:"Bijv. Mijn locaties",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]})]}),i==="preview"&&p.jsxs("div",{className:"px-4 py-3 border-t border-gray-100 flex gap-2",children:[p.jsx("button",{onClick:E,className:"flex-1 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors border-0 outline-none",children:"Annuleren"}),p.jsx("button",{onClick:k,disabled:!h.trim(),className:"flex-1 px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors border-0 outline-none disabled:opacity-50 disabled:cursor-not-allowed",children:"Importeren"})]})]})]})})}function gEe(){const{user:n,loading:e,error:t,signInWithGoogle:r,logout:i,initAuth:s}=Aw();return ie.useEffect(()=>{s()},[s]),e?p.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-white rounded-lg text-gray-500",children:[p.jsx(pL,{size:16,className:"animate-pulse"}),p.jsx("span",{className:"text-sm",children:"Laden..."})]}):n?p.jsxs("div",{className:"flex items-center gap-3 px-3 py-2.5 bg-green-50 rounded-lg",children:[n.photoURL?p.jsx("img",{src:n.photoURL,alt:n.displayName||"User",className:"w-8 h-8 rounded-full border-2 border-green-200",referrerPolicy:"no-referrer"}):p.jsx("div",{className:"w-8 h-8 rounded-full bg-green-200 flex items-center justify-center",children:p.jsx(SR,{size:16,className:"text-green-600"})}),p.jsxs("div",{className:"flex-1 min-w-0",children:[p.jsx("div",{className:"text-sm font-medium text-green-800 truncate",children:n.displayName||n.email}),p.jsxs("div",{className:"text-xs text-green-600 flex items-center gap-1",children:[p.jsx(pL,{size:12}),"Cloud sync actief"]})]}),p.jsx("button",{onClick:i,className:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none bg-transparent",title:"Uitloggen",children:p.jsx(vR,{size:16})})]}):p.jsxs("div",{className:"space-y-2",children:[p.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-gray-50 rounded-lg text-gray-500",children:[p.jsx(iae,{size:16}),p.jsx("span",{className:"text-sm",children:"Alleen lokale opslag"})]}),p.jsxs("button",{onClick:r,className:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-white hover:bg-blue-50 rounded-lg transition-colors border-0 outline-none",children:[p.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",children:[p.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),p.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),p.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),p.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),p.jsx("span",{className:"text-sm text-gray-700",children:"Inloggen met Google"})]}),t&&p.jsx("div",{className:"px-3 py-2 bg-red-50 text-red-700 text-xs rounded-lg",children:t})]})}const mEe="https://forms.gle/R5LCk11Bzu5XrkBj8";function pEe(){const{settingsPanelOpen:n,toggleSettingsPanel:e,vondstDashboardOpen:t,toggleVondstDashboard:r,openLayerManagerModal:i}=Or(),s=Fr(),{presets:a,createPreset:o,deletePreset:l,updatePreset:u}=z8(),h=$o(J=>J.vondsten),f=_1(J=>J.layers),{layers:g,updateLayer:y}=Yi(),{devMode:v,setDevMode:x,tier:E}=DA(),[T,b]=ie.useState(""),[I,M]=ie.useState(!1),[F,z]=ie.useState(!1),[k,C]=ie.useState(null),[P,L]=ie.useState(""),[O,U]=ie.useState(null),[j,Ie]=ie.useState(""),[ke,ze]=ie.useState("algemeen"),Ne=14*s.fontScale/100,ce=()=>{T.trim()&&(o(T.trim(),"Layers"),b(""),M(!1))},Te=(J,ne)=>{C(J),L(ne)},Ee=J=>{P.trim()&&(u(J,{name:P.trim()}),console.log(` Preset hernoemd naar "${P.trim()}"`)),C(null),L("")},se=()=>{C(null),L("")},V=[{id:"algemeen",label:"Algemeen",icon:p.jsx(hoe,{size:14})},{id:"lagen",label:"Lagen",icon:p.jsx(to,{size:14})},{id:"vondsten",label:"Vondsten",icon:p.jsx(Hl,{size:14})}];return p.jsxs(p.Fragment,{children:[p.jsx(jr,{children:n&&p.jsxs(p.Fragment,{children:[p.jsx(Ft.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),p.jsxs(Ft.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-sm mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[p.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-blue-500",style:{fontSize:`${Ne}px`},children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(bb,{size:18,className:"text-white"}),p.jsx("span",{className:"font-medium text-white",children:"Instellingen"})]}),p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("span",{className:"text-[10px] text-blue-200",children:"T"}),p.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:s.fontScale,onInput:J=>{s.setFontScale(parseInt(J.target.value))},onChange:J=>s.setFontScale(parseInt(J.target.value)),className:"w-20 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${s.fontScale}%`}),p.jsx("span",{className:"text-xs text-blue-200",children:"T"}),p.jsx("button",{onClick:e,className:"p-1 rounded bg-blue-400/50 hover:bg-blue-400 transition-colors border-0 outline-none ml-1",children:p.jsx(Qi,{size:18,className:"text-white",strokeWidth:2.5})})]})]}),p.jsx("div",{className:"flex border-b border-gray-200",children:V.map(J=>p.jsxs("button",{onClick:()=>ze(J.id),className:`flex-1 flex items-center justify-center gap-1.5 px-3 py-2.5 text-sm font-medium transition-colors border-0 outline-none ${ke===J.id?"text-blue-600 border-b-2 border-blue-600 bg-blue-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[J.icon,J.label]},J.id))}),p.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-5",style:{fontSize:`${Ne}px`},children:[ke==="algemeen"&&p.jsxs(p.Fragment,{children:[p.jsx(vl,{title:"Account",icon:p.jsx(SR,{size:16}),children:p.jsx(gEe,{})}),p.jsxs(vl,{title:"Kaart",icon:p.jsx(wR,{size:16}),children:[p.jsx(yEe,{label:"Standaard achtergrond",children:p.jsxs("select",{value:s.defaultBackground,onChange:J=>s.setDefaultBackground(J.target.value),className:"px-2 py-1 bg-gray-100 rounded border-0 outline-none",style:{fontSize:"0.9em"},children:[p.jsx("option",{value:"CartoDB (licht)",children:"Licht"}),p.jsx("option",{value:"OpenStreetMap",children:"OSM"}),p.jsx("option",{value:"Luchtfoto",children:"Luchtfoto"})]})}),p.jsx(yf,{label:"Schaalbalk tonen",checked:s.showScaleBar,onChange:s.setShowScaleBar})]}),p.jsxs(vl,{title:"GPS",icon:p.jsx(ER,{size:16}),children:[p.jsx(yf,{label:"GPS aan bij start",checked:s.gpsAutoStart,onChange:s.setGpsAutoStart}),p.jsx(yf,{label:"Nauwkeurigheidscirkel",checked:s.showAccuracyCircle,onChange:s.setShowAccuracyCircle})]}),p.jsx(vl,{title:"Feedback",icon:p.jsx(foe,{size:16}),children:p.jsx(yf,{label:"Trillen bij acties",checked:s.hapticFeedback,onChange:s.setHapticFeedback})}),p.jsxs(vl,{title:"Development",icon:p.jsx(oae,{size:16}),children:[p.jsx(yf,{label:"Dev Mode (alles ontgrendeld)",checked:v,onChange:x}),p.jsxs("p",{className:"text-gray-500 mt-1",style:{fontSize:"0.75em"},children:["Huidige tier: ",p.jsx("span",{className:"font-medium text-blue-600",children:E}),v&&p.jsx("span",{className:"text-green-600",children:" (alle lagen ontgrendeld)"})]})]})]}),ke==="lagen"&&p.jsxs(p.Fragment,{children:[p.jsx(vl,{title:"Mijn lagen",icon:p.jsx(to,{size:16}),isOwn:!0,children:p.jsxs("div",{className:"space-y-1",children:[g.filter(J=>!J.archived).length===0?p.jsx("p",{className:"text-gray-500 py-1",style:{fontSize:"0.75em"},children:"Nog geen eigen lagen aangemaakt."}):g.filter(J=>!J.archived).map(J=>p.jsx("div",{className:"flex items-center gap-2 py-1.5 px-2 hover:bg-gray-50 rounded",children:O===J.id?p.jsx("input",{type:"text",value:j,onChange:ne=>Ie(ne.target.value),onKeyDown:ne=>{ne.key==="Enter"?(j.trim()&&y(J.id,{name:j.trim()}),U(null)):ne.key==="Escape"&&U(null)},onBlur:()=>{j.trim()&&y(J.id,{name:j.trim()}),U(null)},autoFocus:!0,className:"flex-1 px-1.5 py-0.5 text-sm bg-orange-50 rounded outline-none focus:ring-1 focus:ring-orange-400"}):p.jsxs(p.Fragment,{children:[p.jsx("span",{className:"flex-1 text-sm text-gray-700 truncate",children:J.name}),p.jsxs("span",{className:"text-xs text-gray-400",children:[J.points.length," punten"]}),p.jsx("button",{onClick:()=>{U(J.id),Ie(J.name)},className:"p-1 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none bg-transparent",title:"Naam bewerken",children:p.jsx(Tp,{size:12})})]})},J.id)),p.jsxs("button",{onClick:()=>{i(),e()},className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[p.jsx(bb,{size:14}),p.jsx("span",{children:"Lagen beheren"})]})]})}),p.jsx(vl,{title:"Lagen importeren",icon:p.jsx(Ow,{size:16}),children:p.jsxs("div",{className:"space-y-1",children:[f.length>0&&p.jsxs(p.Fragment,{children:[f.map(J=>p.jsx(P9,{layer:J},J.id)),p.jsx("div",{className:"border-t border-gray-100 my-2"})]}),p.jsxs("button",{onClick:()=>z(!0),className:"flex items-center gap-2 px-2 py-1.5 text-cyan-600 hover:bg-cyan-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[p.jsx(oo,{size:14}),p.jsx("span",{children:"Nieuwe laag importeren"})]}),p.jsx("p",{className:"text-gray-400 mt-1",style:{fontSize:"0.7em"},children:"GeoJSON, KML (Google My Maps), GPX"})]})}),p.jsx(vl,{title:"Presets",icon:p.jsx(to,{size:16}),children:p.jsxs("div",{className:"space-y-2",children:[a.map(J=>p.jsx("div",{className:"flex items-center justify-between py-1",children:k===J.id?p.jsxs("div",{className:"flex-1 flex items-center gap-1",children:[p.jsx("input",{type:"text",value:P,onChange:ne=>L(ne.target.value),onKeyDown:ne=>{ne.key==="Enter"&&Ee(J.id),ne.key==="Escape"&&se()},className:"flex-1 px-2 py-0.5 bg-blue-50 rounded border border-blue-300 outline-none",style:{fontSize:"0.9em"},autoFocus:!0}),p.jsx("button",{onClick:()=>Ee(J.id),className:"px-2 py-0.5 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors border-0 outline-none",style:{fontSize:"0.7em"},children:"OK"}),p.jsx("button",{onClick:se,className:"px-2 py-0.5 bg-gray-200 text-gray-600 rounded hover:bg-gray-300 transition-colors border-0 outline-none",style:{fontSize:"0.7em"},children:""})]}):p.jsxs(p.Fragment,{children:[p.jsxs("div",{className:"flex-1 min-w-0",children:[p.jsxs("span",{className:"text-gray-600",style:{fontSize:"0.9em"},children:[J.name,J.isBuiltIn&&p.jsx("span",{className:"ml-1 text-gray-400",style:{fontSize:"0.7em"},children:"(standaard)"})]}),p.jsxs("span",{className:"ml-1 text-gray-400",style:{fontSize:"0.7em"},children:["(",J.layers.length," lagen)"]})]}),!J.isBuiltIn&&p.jsxs("div",{className:"flex items-center gap-1",children:[p.jsx("button",{onClick:()=>Te(J.id,J.name),className:"p-1 text-blue-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",title:"Naam wijzigen",children:p.jsx(Tp,{size:14})}),p.jsx("button",{onClick:()=>l(J.id),className:"p-1 text-red-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors border-0 outline-none",title:"Verwijderen",children:p.jsx(pd,{size:14})})]})]})},J.id)),I?p.jsxs("div",{className:"flex gap-2 mt-2",children:[p.jsx("input",{type:"text",value:T,onChange:J=>b(J.target.value),placeholder:"Naam nieuwe preset",className:"flex-1 px-2 py-1 bg-gray-100 rounded border-0 outline-none",style:{fontSize:"0.9em"},onKeyDown:J=>J.key==="Enter"&&ce(),autoFocus:!0}),p.jsx("button",{onClick:ce,className:"px-2 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors border-0 outline-none",style:{fontSize:"0.75em"},children:"Opslaan"}),p.jsx("button",{onClick:()=>M(!1),className:"px-2 py-1 bg-gray-200 text-gray-600 rounded hover:bg-gray-300 transition-colors border-0 outline-none",style:{fontSize:"0.75em"},children:"Annuleren"})]}):p.jsxs("button",{onClick:()=>M(!0),className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[p.jsx(oo,{size:14}),p.jsx("span",{children:"Huidige lagen als preset opslaan"})]})]})})]}),ke==="vondsten"&&p.jsx(p.Fragment,{children:p.jsxs(vl,{title:"Vondsten",icon:p.jsx(Hl,{size:16}),isOwn:!0,children:[p.jsx(yf,{label:"Vondsten knop tonen",checked:s.showVondstButton,onChange:s.setShowVondstButton}),p.jsx("p",{className:"text-gray-500 mt-1 py-1",style:{fontSize:"0.75em"},children:"Vondsten worden altijd lokaal op dit apparaat opgeslagen."}),p.jsxs("button",{onClick:r,className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[p.jsx(E9,{size:14}),p.jsxs("span",{children:["Dashboard (",h.length," vondsten)"]})]}),p.jsx(_Ee,{})]})})]}),p.jsxs("div",{className:"px-4 py-3 border-t border-gray-100 space-y-2",style:{fontSize:`${Ne}px`},children:[p.jsxs("a",{href:mEe,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 w-full px-3 py-2 text-orange-600 hover:bg-orange-50 rounded-lg transition-colors border-0 outline-none",style:{fontSize:"0.9em"},children:[p.jsx(w9,{size:16}),p.jsx("span",{children:"Meld een bug"})]}),p.jsxs("button",{onClick:Qwe,className:"flex items-center justify-center gap-2 w-full px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none",style:{fontSize:"0.9em"},children:[p.jsx(vR,{size:16}),p.jsx("span",{children:"Uitloggen"})]}),p.jsx("p",{className:"text-gray-400 text-center",style:{fontSize:"0.75em"},children:"Instellingen worden lokaal opgeslagen"})]})]})]})}),p.jsx(Jwe,{isOpen:t,onClose:r}),p.jsx(fEe,{isOpen:F,onClose:()=>z(!1)})]})}function vl({title:n,icon:e,children:t,isOwn:r}){return p.jsxs("section",{children:[p.jsxs("div",{className:"flex items-center gap-2 mb-2 pb-1 border-b border-gray-100",children:[p.jsx("span",{className:r?"text-orange-600":"text-blue-600",children:e}),p.jsx("span",{className:`font-medium ${r?"text-orange-600":"text-gray-800"}`,style:{fontSize:"1em"},children:n})]}),p.jsx("div",{className:"space-y-2",children:t})]})}function yEe({label:n,children:e}){return p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsx("span",{className:"text-gray-600",style:{fontSize:"0.9em"},children:n}),e]})}function yf({label:n,checked:e,onChange:t}){return p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsx("span",{className:"text-gray-600",style:{fontSize:"0.9em"},children:n}),p.jsx("button",{onClick:()=>t(!e),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${e?"bg-gradient-to-r from-blue-500 to-blue-600":"bg-gray-300"}`,children:p.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${e?"left-[22px]":"left-0.5"}`})})]})}function _Ee(){const[n,e]=ie.useState(!1),{vondsten:t,exportAsGeoJSON:r,exportAsCSV:i,exportAsExcel:s,exportAsGPX:a,exportAsKML:o}=$o(),l=[{label:"Excel (.xlsx)",action:s,desc:"Spreadsheet"},{label:"CSV",action:i,desc:"Comma-separated"},{label:"GeoJSON",action:r,desc:"GIS software"},{label:"GPX",action:a,desc:"GPS apparaten"},{label:"KML",action:o,desc:"Google Earth"}],u=h=>{h(),e(!1)};return t.length===0?p.jsxs("div",{className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-gray-400 bg-gray-100 rounded w-full cursor-not-allowed",style:{fontSize:"0.9em"},children:[p.jsx(wb,{size:14}),p.jsx("span",{children:"Geen vondsten om te exporteren"})]}):p.jsxs("div",{className:"relative mt-2",children:[p.jsxs("button",{onClick:()=>e(!n),className:"flex items-center justify-between gap-2 px-2 py-1.5 text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(wb,{size:14}),p.jsxs("span",{children:["Exporteer vondsten (",t.length,")"]})]}),p.jsx("span",{style:{fontSize:"0.8em"},children:""})]}),n&&p.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg z-10 overflow-hidden",children:l.map((h,f)=>p.jsxs("button",{onClick:()=>u(h.action),className:"w-full px-3 py-2 text-left hover:bg-blue-50 transition-colors border-0 outline-none flex justify-between items-center",style:{fontSize:"0.9em"},children:[p.jsx("span",{className:"text-gray-700",children:h.label}),p.jsx("span",{className:"text-gray-400",style:{fontSize:"0.8em"},children:h.desc})]},f))})]})}const gC="2.27.5";function xEe({size:n=18}){return p.jsxs("svg",{viewBox:"0 0 24 24",width:n,height:n,children:[p.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),p.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),p.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),p.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]})}function vEe(){const[n,e]=ie.useState(!1),{user:t,loading:r,signInWithGoogle:i,logout:s}=Aw(),{toggleInfoPanel:a,toggleSettingsPanel:o}=Or(),l=Fr(T=>T.menuFontScale),u=Fr(T=>T.setMenuFontScale),h={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"},f=()=>e(!1),g=()=>{f(),a()},y=()=>{f(),o()},v=()=>{f(),i()},x=()=>{f(),s()},E=13*l/100;return p.jsxs(p.Fragment,{children:[p.jsx(Ft.button,{className:`fixed right-2 z-[800] w-11 h-11 flex items-center justify-center rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm ${n?"bg-blue-500 hover:bg-blue-600":"bg-white/90 hover:bg-white"}`,style:h,onClick:()=>e(!n),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Menu",children:n?p.jsx(Qi,{size:22,className:"text-white"}):p.jsx(Dae,{size:22,className:"text-gray-600"})}),p.jsx(jr,{children:n&&p.jsxs(p.Fragment,{children:[p.jsx(Ft.div,{className:"fixed inset-0 z-[799]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:f}),p.jsxs(Ft.div,{initial:{opacity:0,y:-8,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-8,scale:.95},transition:{duration:.15},className:"fixed right-2 z-[801] w-64 bg-white rounded-xl shadow-lg overflow-hidden flex flex-col",style:{top:"calc(max(0.5rem, env(safe-area-inset-top, 0.5rem)) + 52px)",fontSize:`${E}px`},children:[p.jsxs("div",{className:"flex items-center justify-between gap-2 px-3 py-1.5 bg-blue-500",children:[p.jsx("span",{className:"font-medium text-white",style:{fontSize:`${E}px`},children:"Menu"}),p.jsxs("div",{className:"flex items-center gap-1",children:[p.jsx("span",{className:"text-[9px] text-blue-200",children:"T"}),p.jsx("input",{type:"range",min:"80",max:"130",step:"10",value:l,onInput:T=>u(parseInt(T.target.value)),onChange:T=>u(parseInt(T.target.value)),className:"w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${l}%`}),p.jsx("span",{className:"text-[11px] text-blue-200",children:"T"})]})]}),r?p.jsx("div",{className:"px-3 py-4 flex items-center justify-center",children:p.jsx("div",{className:"w-5 h-5 border-2 border-gray-300 border-t-blue-500 rounded-full animate-spin"})}):t?p.jsx("div",{className:"px-3 py-3 border-b border-gray-100",children:p.jsxs("div",{className:"flex items-center gap-3",children:[t.photoURL?p.jsx("img",{src:t.photoURL,alt:t.displayName||"User",className:"w-8 h-8 rounded-full",referrerPolicy:"no-referrer"}):p.jsx("div",{className:"w-8 h-8 rounded-full bg-green-500 flex items-center justify-center",children:p.jsx(SR,{size:16,className:"text-white"})}),p.jsxs("div",{className:"flex-1 min-w-0",children:[p.jsx("div",{className:"font-medium text-gray-800 truncate",style:{fontSize:"0.85em"},children:t.displayName||"Gebruiker"}),p.jsx("div",{className:"text-green-600",style:{fontSize:"0.7em"},children:"Cloud sync actief"})]}),p.jsx("button",{onClick:x,className:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none bg-transparent",title:"Uitloggen",children:p.jsx(vR,{size:16})})]})}):p.jsxs("button",{onClick:v,className:"w-full px-3 py-3 flex items-center gap-3 hover:bg-blue-50 transition-colors border-0 outline-none bg-transparent",children:[p.jsx(xEe,{size:18}),p.jsx("span",{className:"text-gray-700",style:{fontSize:"0.9em"},children:"Inloggen met Google"})]}),p.jsx("div",{className:"py-1",children:p.jsxs("button",{onClick:g,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-blue-50",style:{fontSize:"0.95em"},children:[p.jsx(R9,{size:18,className:"text-blue-500"}),p.jsx("span",{children:"Info & handleiding"})]})}),p.jsx("div",{className:"mt-auto border-t border-gray-100",children:p.jsxs("button",{onClick:y,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-gray-50",style:{fontSize:"0.95em"},children:[p.jsx(bb,{size:18,className:"text-gray-500"}),p.jsx("span",{children:"Instellingen"})]})}),p.jsxs("div",{className:"px-3 py-1.5 bg-gray-50 text-center text-gray-400",style:{fontSize:"0.65em"},children:["DetectorApp NL v",gC]})]})]})})]})}const wEe="https://forms.gle/R5LCk11Bzu5XrkBj8";function EEe(){const{infoPanelOpen:n,toggleInfoPanel:e}=Or(),[t,r]=ie.useState("info"),i=[{id:"info",label:"Info",icon:p.jsx(R9,{size:14})},{id:"functies",label:"Functies",icon:p.jsx(A9,{size:14})},{id:"handleiding",label:"Handleiding",icon:p.jsx(Use,{size:14})}];return p.jsx(jr,{children:n&&p.jsxs(p.Fragment,{children:[p.jsx(Ft.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),p.jsxs(Ft.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[p.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-blue-500",children:[p.jsx("span",{className:"font-medium text-white",children:"DetectorApp NL"}),p.jsx("button",{onClick:e,className:"p-1 rounded bg-blue-400/50 hover:bg-blue-400 transition-colors border-0 outline-none",children:p.jsx(Qi,{size:18,className:"text-white",strokeWidth:2.5})})]}),p.jsx("div",{className:"flex border-b border-gray-200",children:i.map(s=>p.jsxs("button",{onClick:()=>r(s.id),className:`flex-1 flex items-center justify-center gap-1.5 px-3 py-2.5 text-sm font-medium transition-colors border-0 outline-none ${t===s.id?"text-blue-600 border-b-2 border-blue-600 bg-blue-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[s.icon,s.label]},s.id))}),p.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 text-sm",children:[t==="info"&&p.jsx(SEe,{}),t==="functies"&&p.jsx(TEe,{}),t==="handleiding"&&p.jsx(bEe,{}),p.jsxs("section",{className:"pt-2 border-t border-gray-200 space-y-2",children:[p.jsxs("a",{href:wEe,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 w-full px-3 py-2 text-orange-600 hover:bg-orange-50 rounded-lg transition-colors",children:[p.jsx(w9,{size:14}),p.jsx("span",{className:"text-sm",children:"Meld een bug"})]}),p.jsxs("p",{className:"text-xs text-gray-400 text-center",children:["DetectorApp NL v",gC]})]})]})]})]})})}function SEe(){return p.jsxs(p.Fragment,{children:[p.jsxs("section",{children:[p.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Over deze app"}),p.jsx("p",{className:"text-gray-600",children:"DetectorApp NL is d kaartapplicatie voor metaaldetectie en archeologische verkenning in Nederland. Met 60+ kaartlagen, GPS tracking met richtingspijl en vondstenbeheer."})]}),p.jsxs("section",{children:[p.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Databronnen & Licenties"}),p.jsxs("ul",{className:"space-y-2 text-gray-600",children:[p.jsxs("li",{children:[p.jsx("strong",{children:"RCE / Cultureelerfgoed.nl"})," (CC0/CC-BY)",p.jsx("br",{}),p.jsx("span",{className:"text-xs",children:"AMK, Rijksmonumenten, Werelderfgoed, Paleokaarten, Religieus Erfgoed, Essen"})]}),p.jsxs("li",{children:[p.jsx("strong",{children:"PDOK / Kadaster"})," (CC0/CC-BY)",p.jsx("br",{}),p.jsx("span",{className:"text-xs",children:"Luchtfoto, AHN, IKAW, Bodemkaart, Geomorfologie, Kadastrale Grenzen"})]}),p.jsxs("li",{children:[p.jsx("strong",{children:"OpenStreetMap"})," (ODbL)",p.jsx("br",{}),p.jsx("span",{className:"text-xs",children:"Hunebedden, Grafheuvels, Bunkers, Kastelen, Parken, Kringloopwinkels, Musea"})]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Itiner-E"})," (CC BY 4.0)",p.jsx("br",{}),p.jsx("span",{className:"text-xs",children:"Romeinse wegen - Brughmans, Paout, de Soto & Bjerregaard Vahlstrup"})]}),p.jsxs("li",{children:[p.jsx("strong",{children:"CARTO"})," (CC BY 3.0)",p.jsx("br",{}),p.jsx("span",{className:"text-xs",children:"CartoDB basiskaart"})]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Map5.nl / Kadaster"}),p.jsx("br",{}),p.jsx("span",{className:"text-xs",children:"Historische kaarten (TMK 1850, Bonnebladen 1900)"})]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Provinciale data"}),p.jsx("br",{}),p.jsx("span",{className:"text-xs",children:"Relictenkaart (Gelderland), Scheepswrakken (Zuid-Holland), Verdronken Dorpen (Zeeland)"})]}),p.jsxs("li",{children:[p.jsx("strong",{children:"UIKAV / Rijkswaterstaat"}),p.jsx("br",{}),p.jsx("span",{className:"text-xs",children:"Uiterwaarden archeologische data"})]})]})]}),p.jsxs("section",{children:[p.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Privacy"}),p.jsxs("div",{className:"text-gray-600 space-y-2",children:[p.jsxs("p",{children:[p.jsx("strong",{children:"Locatiegegevens:"})," Alleen voor navigatie, niet opgeslagen of gedeeld."]}),p.jsxs("p",{children:[p.jsx("strong",{children:"Geen tracking:"})," Geen analytics of gebruiksstatistieken."]}),p.jsxs("p",{children:[p.jsx("strong",{children:"Lokale opslag:"})," Alle data blijft op je apparaat."]})]})]})]})}function TEe(){return p.jsxs(p.Fragment,{children:[p.jsxs("section",{children:[p.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[p.jsx(wR,{size:16,className:"text-blue-600"}),"Kaartlagen (60+)"]}),p.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[p.jsxs("li",{children:[p.jsx("strong",{children:"Basis:"})," CartoDB, OpenStreetMap, PDOK Luchtfoto"]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Historisch:"})," TMK 1850, Bonnebladen 1900"]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Hoogtekaarten:"})," AHN4 Hillshade, Multi-Hillshade, Hoogtekaart Kleur, AHN 0.5m"]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Archeologie:"})," AMK Monumenten (per periode), Romeinse wegen, Kastelen, IKAW"]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Prehistorie:"})," Hunebedden, Grafheuvels, Terpen, Paleokaarten (7 periodes)"]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Militair:"})," WWII Bunkers, Slagvelden, Vliegvelden, Verdedigingslinies"]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Terrein:"})," Veengebieden, Geomorfologie, Bodemkaart"]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Percelen:"})," Gewaspercelen, Kadastrale Grenzen"]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Recreatie:"})," Parken, Musea, Kringloopwinkels, Strandjes"]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Provinciaal:"})," Relictenkaart, Scheepswrakken, Verdronken Dorpen"]})]})]}),p.jsxs("section",{children:[p.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[p.jsx(ER,{size:16,className:"text-green-600"}),"GPS Tracking"]}),p.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[p.jsx("li",{children:"Live GPS tracking met nauwkeurigheidscirkel"}),p.jsx("li",{children:"Richtingspijl draait mee met je telefoon (zoals Google Maps)"}),p.jsx("li",{children:"Kaart handmatig draaien + kompasknop om terug te draaien naar noorden"}),p.jsx("li",{children:"Schaalbalk onderaan (instelbaar in Instellingen)"}),p.jsx("li",{children:'Open locatie in Google Maps (long-press  "Open in Google Maps")'})]})]}),p.jsxs("section",{children:[p.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[p.jsx(Hl,{size:16,className:"text-orange-600"}),"Vondsten"]}),p.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[p.jsx("li",{children:"Toevoegen via GPS, long-press of handmatig"}),p.jsx("li",{children:"Velden: type, materiaal, periode, diepte, conditie, gewicht, foto-link"}),p.jsx("li",{children:"Export: Excel, CSV, GeoJSON, GPX, KML"}),p.jsx("li",{children:"Dashboard met statistieken"}),p.jsx("li",{children:"Lokale opslag (geen account nodig)"})]})]}),p.jsxs("section",{children:[p.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[p.jsx(to,{size:16,className:"text-purple-600"}),"Presets"]}),p.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[p.jsx("li",{children:"Detectie, Steentijd, Romeins, Middeleeuwen, WOII, Analyse, Fossielen"}),p.jsx("li",{children:"Alle presets zijn aanpasbaar - klik op het diskette-icoon om huidige lagen op te slaan"}),p.jsx("li",{children:"Eigen presets aanmaken via Instellingen"}),p.jsx("li",{children:"Tekstgrootte per panel instelbaar via slider in header"})]})]}),p.jsxs("section",{children:[p.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[p.jsx(Bae,{size:16,className:"text-cyan-600"}),"Perceelinformatie"]}),p.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[p.jsx("li",{children:'Zet "Kadastrale Grenzen" aan en tik op een perceel'}),p.jsx("li",{children:"Toont: kadastrale aanduiding (gemeente, sectie, nummer) + oppervlakte"}),p.jsx("li",{children:"Link naar eigenaar opzoeken (betaalde dienst)"}),p.jsx("li",{children:"Hoogtekaart per perceel (AHN4)"})]})]})]})}function bEe(){return p.jsxs(p.Fragment,{children:[p.jsxs("section",{children:[p.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Eerste stappen"}),p.jsxs("ol",{className:"text-gray-600 space-y-2 text-xs list-decimal list-inside",children:[p.jsxs("li",{children:["Tik op de ",p.jsx("strong",{children:"GPS knop"})," (rechtsonder) om je locatie te zien"]}),p.jsxs("li",{children:["Kies een ",p.jsx("strong",{children:"preset"})," (links, laagjes-icoon) of selecteer kaartlagen handmatig"]}),p.jsxs("li",{children:["Tik op de ",p.jsx("strong",{children:"Kaartlagen knop"})," voor alle beschikbare lagen"]})]})]}),p.jsxs("section",{children:[p.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"GPS knop"}),p.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[p.jsxs("p",{children:[p.jsx("strong",{children:"Uit (grijs icoon):"})," GPS tracking uit, geen locatie zichtbaar."]}),p.jsxs("p",{children:[p.jsx("strong",{children:"Aan (blauw icoon):"})," GPS tracking aan, je locatie en richting worden getoond."]}),p.jsxs("p",{children:[p.jsx("strong",{children:"Richtingspijl:"})," De blauwe pijl draait vloeiend mee met de richting van je telefoon."]}),p.jsxs("p",{children:[p.jsx("strong",{children:"Kompasknop:"})," Verschijnt rechtsboven als de kaart gedraaid is. Tik om terug naar noorden te draaien."]})]})]}),p.jsxs("section",{children:[p.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Vondst toevoegen"}),p.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[p.jsxs("p",{children:[p.jsx("strong",{children:"Methode 1 - GPS:"})," Tik op de oranje + knop rechtsonder. Je huidige locatie wordt automatisch ingevuld."]}),p.jsxs("p",{children:[p.jsx("strong",{children:"Methode 2 - Long-press:"}),' Houd je vinger lang op de kaart. Kies "Vondst toevoegen" in het menu.']}),p.jsxs("p",{children:[p.jsx("strong",{children:"Methode 3 - Handmatig:"}),' In het vondstenformulier, tik "Kies op kaart" en selecteer de exacte locatie.']})]})]}),p.jsxs("section",{children:[p.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Presets gebruiken"}),p.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[p.jsxs("p",{children:[p.jsx("strong",{children:"Toepassen:"})," Tik op het laagjes-icoon links en kies een preset."]}),p.jsxs("p",{children:[p.jsx("strong",{children:"Snel opslaan:"})," Zet de gewenste lagen aan en tik op het diskette-icoon naast een preset om die te overschrijven."]}),p.jsxs("p",{children:[p.jsx("strong",{children:"Nieuw aanmaken:"}),' Ga naar Instellingen  Presets  "Huidige lagen als preset opslaan".']}),p.jsxs("p",{children:[p.jsx("strong",{children:"Tekstgrootte:"})," Gebruik de slider in de header van het Presets/Kaartlagen panel."]})]})]}),p.jsxs("section",{children:[p.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Zoeken & Navigatie"}),p.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[p.jsxs("p",{children:[p.jsx("strong",{children:"Zoeken:"})," Gebruik de zoekbalk bovenaan om een adres te vinden."]}),p.jsxs("p",{children:[p.jsx("strong",{children:"Google Maps:"}),' Long-press op een locatie en kies "Open in Google Maps" om te navigeren.']}),p.jsxs("p",{children:[p.jsx("strong",{children:"Schaalbalk:"})," Onderaan de kaart - aan/uit in Instellingen."]})]})]}),p.jsxs("section",{children:[p.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Tips voor in het veld"}),p.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs list-disc list-inside",children:[p.jsxs("li",{children:["Gebruik ",p.jsx("strong",{children:"AHN Hillshade"})," om relif te zien (grafheuvels, wallen)"]}),p.jsxs("li",{children:["Combineer ",p.jsx("strong",{children:"AMK"})," met ",p.jsx("strong",{children:"Gewaspercelen"})," voor detectie"]}),p.jsxs("li",{children:["Check de ",p.jsx("strong",{children:"IKAW"})," voor archeologische verwachting"]}),p.jsxs("li",{children:["Gebruik ",p.jsx("strong",{children:"historische kaarten"})," om oude structuren te vinden"]}),p.jsxs("li",{children:["Zet ",p.jsx("strong",{children:"GPS tracking"})," aan om je route te volgen"]}),p.jsx("li",{children:"Tik op objecten (bunkers, musea, etc.) voor openingstijden en info"})]})]}),p.jsxs("section",{children:[p.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[p.jsx(S1,{size:16,className:"text-blue-600"}),"Meer informatie"]}),p.jsx("p",{className:"text-gray-600 text-xs mb-2",children:"Uitleg over grondsoorten wordt direct in de popup getoond bij Bodemkaart en Gewaspercelen."}),p.jsxs("ul",{className:"text-gray-600 space-y-2 text-xs",children:[p.jsxs("li",{children:[p.jsx("a",{href:"https://legendageomorfologie.wur.nl/",target:"_blank",rel:"noopener",className:"text-blue-600 hover:underline font-medium",children:"Geomorfologie legenda (WUR)"}),p.jsx("br",{}),p.jsx("span",{className:"text-gray-500",children:"Uitgebreide uitleg over landvormen"})]}),p.jsxs("li",{children:[p.jsx("a",{href:"https://legenda-bodemkaart.bodemdata.nl/",target:"_blank",rel:"noopener",className:"text-blue-600 hover:underline font-medium",children:"Bodemkaart legenda (BRO)"}),p.jsx("br",{}),p.jsx("span",{className:"text-gray-500",children:"Volledige bodemclassificatie"})]})]})]})]})}function YS({label:n,value:e,onChange:t,options:r,required:i=!1,placeholder:s="Typ hier..."}){const[a,o]=ie.useState(!1),[l,u]=ie.useState(!1),[h,f]=ie.useState(""),g=e&&!r.includes(e),y=()=>{u(!0),f(g?e:""),o(!1)},v=()=>{h.trim()&&t(h.trim()),u(!1)};return l?p.jsxs("div",{children:[p.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:[n,i&&p.jsx("span",{className:"text-orange-500 ml-0.5",children:"*"})]}),p.jsx("input",{type:"text",value:h,onChange:x=>f(x.target.value),onKeyDown:x=>{x.key==="Enter"&&(x.preventDefault(),v()),x.key==="Escape"&&u(!1)},onBlur:v,placeholder:s,autoFocus:!0,className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all",style:{border:"none",outline:"none"}})]}):p.jsxs("div",{className:"relative",children:[p.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:[n,i&&p.jsx("span",{className:"text-orange-500 ml-0.5",children:"*"})]}),p.jsxs("button",{type:"button",onClick:()=>o(!a),className:"w-full flex items-center justify-between px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors text-left",style:{border:"none",outline:"none"},children:[p.jsxs("span",{className:e?"":"text-gray-400",children:[e||"Selecteer...",g&&p.jsx(yL,{size:12,className:"inline ml-1 text-orange-500"})]}),p.jsx(_R,{size:16,className:`text-gray-400 transition-transform ${a?"rotate-180":""}`})]}),a&&p.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-white rounded-lg shadow-lg max-h-48 overflow-y-auto",children:[p.jsxs("button",{type:"button",onClick:y,className:"w-full px-3 py-2 text-left text-sm text-orange-600 hover:bg-orange-50 transition-colors flex items-center gap-2",style:{border:"none",outline:"none"},children:[p.jsx(yL,{size:12}),"Eigen invoer..."]}),p.jsx("div",{className:"border-t border-gray-100"}),r.map(x=>p.jsx("button",{type:"button",onClick:()=>{t(x),o(!1)},className:`w-full px-3 py-2 text-left text-sm transition-colors ${x===e?"bg-orange-50 text-orange-600":"text-gray-600 hover:bg-gray-50"}`,style:{border:"none",outline:"none"},children:x},x))]})]})}function gG({onClose:n,initialLocation:e}){const t=is(X=>X.position),r=hs(X=>X.map),i=Or(X=>X.vondstFormPhoto),s=Yi(X=>X.layers),a=Yi(X=>X.addPoint),[o,l]=ie.useState(""),[u,h]=ie.useState(""),[f,g]=ie.useState(""),[y,v]=ie.useState(""),[x,E]=ie.useState(!1),[T,b]=ie.useState(void 0),[I,M]=ie.useState(void 0),[F,z]=ie.useState($a),[k,C]=ie.useState(i),[P,L]=ie.useState(null);ie.useEffect(()=>{if(k){const X=URL.createObjectURL(k);return L(X),()=>URL.revokeObjectURL(X)}else L(null)},[k]);const[O,U]=ie.useState(e?"map-pick":t?"gps":"map-center"),[j,Ie]=ie.useState(e||null),[ke,ze]=ie.useState(!1),Ne=()=>{if(O==="gps"&&t)return{lat:t.lat,lng:t.lng};if(O==="map-pick"&&j)return j;if(r){const X=r.getView().getCenter();if(X){const[ue,Me]=xn(X);return{lat:Me,lng:ue}}}return null},ce=Ne();ie.useEffect(()=>{if(!ke||!r)return;const X=ue=>{const[Me,je]=xn(ue.coordinate);Ie({lat:je,lng:Me}),U("map-pick"),ze(!1)};return r.on("click",X),()=>r.un("click",X)},[ke,r]);const Te=()=>ze(!0),Ee=()=>{t&&(U("gps"),Ie(null))},se=()=>{const X=document.createElement("input");X.type="file",X.accept="image/*",X.capture="environment",X.onchange=ue=>{const Me=ue.target.files?.[0];Me&&C(Me)},X.click()},V=()=>C(null),J=async X=>{X.preventDefault();const ue=Ne();if(!ue){alert("Geen locatie beschikbaar");return}if(!u){alert("Vul een naam/type in");return}E(!0);try{let Me=o||"";if(F===$a){const De=[];f&&De.push(`Materiaal: ${f}`),y&&De.push(`Periode: ${y}`),T&&De.push(`Gewicht: ${T}g`),I&&De.push(`Lengte: ${I}mm`),De.length>0&&(Me=De.join(" | ")+(o?` | ${o}`:""))}a(F,{coordinates:[ue.lng,ue.lat],name:u,category:F===$a?u:"Overig",notes:Me||""});const je=s.find(De=>De.id===F)?.name||"Vondsten";alert(`Toegevoegd aan ${je}! `),n()}catch(Me){alert("Fout bij opslaan: "+Me.message)}finally{E(!1)}},ne=ie.useMemo(()=>s.map(X=>({id:X.id,name:X.name,color:X.color})),[s]);return ke?p.jsx(Ft.div,{className:"fixed bottom-0 left-0 right-0 z-[2000] p-4",initial:{y:100},animate:{y:0},exit:{y:100},children:p.jsxs("div",{className:"bg-orange-500 text-white rounded-xl shadow-xl p-4 flex items-center justify-between max-w-md mx-auto",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx(vb,{size:24,className:"animate-pulse"}),p.jsxs("div",{children:[p.jsx("div",{className:"font-medium",children:"Tik op de kaart"}),p.jsx("div",{className:"text-sm opacity-90",children:"om locatie te kiezen"})]})]}),p.jsx("button",{onClick:()=>ze(!1),className:"px-4 py-2 bg-white/20 hover:bg-white/30 rounded-lg transition-colors border-0 outline-none",children:"Annuleren"})]})}):p.jsx(Ft.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:p.jsxs(Ft.div,{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full max-h-[90vh] overflow-hidden flex flex-col",initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},children:[p.jsxs("div",{className:"bg-gradient-to-r from-orange-500 to-orange-600 text-white px-5 py-4 flex justify-between items-center flex-shrink-0",children:[p.jsx("h2",{className:"text-lg font-semibold",children:"Nieuwe Vondst"}),p.jsx("button",{onClick:n,className:"w-8 h-8 flex items-center justify-center rounded-full hover:bg-white/20 transition-colors border-0 outline-none",children:p.jsx(Qi,{size:20})})]}),p.jsxs("form",{onSubmit:J,className:"flex-1 overflow-y-auto",children:[p.jsxs("div",{className:"p-5 space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Foto"}),P?p.jsxs("div",{className:"relative",children:[p.jsx("img",{src:P,alt:"Vondst",className:"w-full h-40 object-cover rounded-xl"}),p.jsx("button",{type:"button",onClick:V,className:"absolute top-2 right-2 w-8 h-8 bg-red-500 text-white rounded-full flex items-center justify-center hover:bg-red-600 transition-colors border-0 outline-none shadow-lg",children:p.jsx(pd,{size:16})})]}):p.jsxs("button",{type:"button",onClick:se,className:"w-full h-32 bg-gray-50 rounded-xl flex flex-col items-center justify-center gap-2 hover:bg-gray-100 transition-colors text-gray-500 border-2 border-dashed border-gray-200",style:{outline:"none"},children:[p.jsx(yR,{size:32}),p.jsx("span",{className:"text-sm",children:"Maak een foto"})]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Locatie"}),ce&&p.jsxs("div",{className:"bg-orange-50 rounded-xl px-4 py-3 mb-2",children:[p.jsxs("div",{className:"text-sm text-orange-800 font-mono",children:[ce.lat.toFixed(6),"N, ",ce.lng.toFixed(6),"E"]}),p.jsx("div",{className:"text-xs text-orange-600 mt-1",children:O==="gps"?" GPS locatie":O==="map-pick"?" Gekozen op kaart":" Kaart midden"})]}),!ce&&p.jsx("div",{className:"bg-red-50 rounded-xl px-4 py-3 mb-2",children:p.jsx("div",{className:"text-sm text-red-600",children:"Geen locatie beschikbaar"})}),p.jsxs("div",{className:"flex gap-2",children:[t&&O!=="gps"&&p.jsxs("button",{type:"button",onClick:Ee,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-sm bg-green-50 text-green-700 rounded-lg hover:bg-green-100 transition-colors border-0 outline-none",children:[p.jsx(ER,{size:16}),"GPS"]}),p.jsxs("button",{type:"button",onClick:Te,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-sm bg-blue-50 text-blue-700 rounded-lg hover:bg-blue-100 transition-colors border-0 outline-none",children:[p.jsx(vb,{size:16}),"Kies op kaart"]})]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Opslaan naar"}),p.jsx("div",{className:"flex flex-wrap gap-2",children:ne.map(X=>p.jsx("button",{type:"button",onClick:()=>z(X.id),className:`px-3 py-2 rounded-lg text-sm font-medium transition-all border-0 outline-none ${F===X.id?"bg-gray-800 text-white shadow-md":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:X.name},X.id))})]}),F===$a&&p.jsx(YS,{label:"Type vondst",value:u,onChange:h,options:["Munt","Aardewerk","Gesp","Fibula","Ring","Speld","Sieraad","Gereedschap","Wapen","Anders"],required:!0,placeholder:"Typ type vondst..."}),F!==$a&&p.jsxs("div",{children:[p.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:["Naam",p.jsx("span",{className:"text-orange-500 ml-0.5",children:"*"})]}),p.jsx("input",{type:"text",value:u,onChange:X=>h(X.target.value),placeholder:"Naam van het punt...",className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all",style:{border:"none",outline:"none"}})]}),F===$a&&p.jsxs(p.Fragment,{children:[p.jsx(YS,{label:"Materiaal",value:f,onChange:g,options:["Brons","IJzer","Zilver","Goud","Koper","Lood","Tin","Keramiek","Steen","Glas","Bot","Hout","Leer","Onbekend"],placeholder:"Typ materiaal..."}),p.jsx(YS,{label:"Periode",value:y,onChange:v,options:["Steentijd","Bronstijd","IJzertijd","Romeins","Middeleeuws","Nieuwetijd","Modern","Onbekend"],placeholder:"Typ periode..."}),p.jsxs("div",{className:"flex gap-3",children:[p.jsxs("div",{className:"flex-1",children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Gewicht (g)"}),p.jsx("input",{type:"number",value:T??"",onChange:X=>b(X.target.value?parseFloat(X.target.value):void 0),className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all",style:{border:"none",outline:"none"},min:"0",step:"0.1"})]}),p.jsxs("div",{className:"flex-1",children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Lengte (mm)"}),p.jsx("input",{type:"number",value:I??"",onChange:X=>M(X.target.value?parseFloat(X.target.value):void 0),className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all",style:{border:"none",outline:"none"},min:"0",step:"0.1"})]})]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Notities"}),p.jsx("textarea",{value:o,onChange:X=>l(X.target.value),className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all resize-none h-20",style:{border:"none",outline:"none"},placeholder:"Beschrijving, context, vindplaats details..."})]}),p.jsx("div",{className:"rounded-xl px-4 py-3 bg-orange-50",children:p.jsx("p",{className:"text-sm text-orange-700",children:' Opgeslagen in "Mijn Lagen" op dit apparaat'})})]}),p.jsxs("div",{className:"p-5 pt-0 flex gap-3",children:[p.jsx("button",{type:"button",onClick:n,className:"flex-1 px-4 py-3 bg-gray-100 text-gray-700 rounded-xl hover:bg-gray-200 transition-colors font-medium border-0 outline-none",children:"Annuleren"}),p.jsx("button",{type:"submit",disabled:x||!ce||ke||!u,className:"flex-1 px-4 py-3 bg-orange-500 text-white rounded-xl hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium border-0 outline-none",children:x?"Opslaan...":"Opslaan"})]})]})]})})}function IEe(){const{user:n,setUser:e,setLoading:t}=Aw();return ie.useEffect(()=>{const s=c6(Zf,a=>{e(a),t(!1)});return()=>s()},[e,t]),{user:n,loginAnonymous:async()=>{try{await pq(Zf)}catch(s){console.error("Login failed:",s)}},logout:async()=>{try{await u6(Zf)}catch(s){console.error("Logout failed:",s)}},isAuthenticated:!!n}}function AEe(){const{isAuthenticated:n,loginAnonymous:e}=IEe(),t=Fr(u=>u.vondstenLocalOnly),r=Fr(u=>u.showVondstButton),i=Or(u=>u.vondstFormOpen),s=Or(u=>u.vondstFormLocation),a=Or(u=>u.openVondstForm),o=Or(u=>u.closeVondstForm);if(!r)return null;const l=()=>{if(t){a();return}if(!n){confirm("Je moet ingelogd zijn om vondsten in de cloud op te slaan. Anoniem inloggen?")&&e();return}a()};return p.jsxs(p.Fragment,{children:[p.jsx(Ft.button,{className:"fixed bottom-2 right-[60px] z-[1000] w-11 h-11 bg-orange-500 hover:bg-orange-600 text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},onClick:l,title:"Vondst toevoegen",children:p.jsx(Hl,{size:22,strokeWidth:2})}),p.jsx(jr,{children:i&&p.jsx(gG,{onClose:o,initialLocation:s||void 0})})]})}const OO={Munt:"#f59e0b",Aardewerk:"#a16207",Gesp:"#6b7280",Fibula:"#8b5cf6",Ring:"#ec4899",Speld:"#6366f1",Sieraad:"#f43f5e",Gereedschap:"#64748b",Wapen:"#ef4444",Anders:"#3b82f6"},REe={Munt:"M",Aardewerk:"A",Gesp:"G",Fibula:"F",Ring:"R",Speld:"S",Sieraad:"Si",Gereedschap:"Gr",Wapen:"W",Anders:"?"};function CEe(){const n=hs(i=>i.map),e=$o(i=>i.vondsten),t=Fr(i=>i.showLocalVondsten),r=ie.useRef(null);return ie.useEffect(()=>{if(!n)return;const i=new Kp;return e.forEach(s=>{const a=new io({geometry:new Js(Ho([s.location.lng,s.location.lat])),vondst:s}),o=OO[s.objectType]||OO.Anders,l=REe[s.objectType]||"?";a.setStyle((u,h)=>{let v=12;h>50?v=6:h>10?v=Math.max(6,12-(h-10)/10):h<2&&(v=14);const x=Math.max(8,Math.min(12,v-2));return new nr({image:new Yo({radius:v,fill:new Wr({color:o}),stroke:new Ci({color:"#ffffff",width:v>8?2:1})}),text:v>=8?new cd({text:l,font:`bold ${x}px sans-serif`,fill:new Wr({color:"#ffffff"}),offsetY:1}):void 0})}),i.addFeature(a)}),r.current?r.current.setSource(i):(r.current=new Qp({source:i,zIndex:1e3,properties:{title:"Mijn Vondsten"}}),r.current.setVisible(t),n.addLayer(r.current)),()=>{r.current&&n&&(n.removeLayer(r.current),r.current=null)}},[n,e]),ie.useEffect(()=>{r.current&&r.current.setVisible(t)},[t]),null}const PEe={Mineraal:"M",Fossiel:"F",Erfgoed:"E",Monument:"Mo",Overig:""};function kEe(n){const{type:e,coordinates:t}=n,r=s=>typeof s[0]=="number"?Ho(s):s.map(r),i=r(t);switch(e){case"Point":return new Js(i);case"LineString":return new so(i);case"Polygon":return new Ia(i);case"MultiPoint":return new ld(i);case"MultiLineString":return new Vl(i);case"MultiPolygon":return new jh(i);default:return new Js(Ho(t))}}function MEe(){const n=hs(i=>i.map),e=Yi(i=>i.layers),t=Fr(i=>i.showCustomPointLayers),r=ie.useRef(new Map);return ie.useEffect(()=>{if(!n)return;const i=new Set(e.map(s=>s.id));return r.current.forEach((s,a)=>{i.has(a)||(n.removeLayer(s),r.current.delete(a))}),e.forEach(s=>{const a=new Kp;s.points.forEach(l=>{let u;const h=l.geometry&&l.geometry.type!=="Point";l.geometry?u=kEe(l.geometry):u=new Js(Ho(l.coordinates));const f=new io({geometry:u,layerType:"customPoint",customPoint:l,customLayerId:s.id,customLayerName:s.name,customLayerColor:s.color}),g=PEe[l.category]||l.category.charAt(0).toUpperCase();if(h){const y=l.geometry.type;f.setStyle(()=>y==="Polygon"||y==="MultiPolygon"?new nr({fill:new Wr({color:s.color+"40"}),stroke:new Ci({color:s.color,width:2})}):y==="LineString"||y==="MultiLineString"?new nr({stroke:new Ci({color:s.color,width:3})}):new nr({image:new Yo({radius:8,fill:new Wr({color:s.color}),stroke:new Ci({color:"#ffffff",width:2})})}))}else f.setStyle((y,v)=>{let b=12;v>50?b=6:v>10?b=Math.max(6,12-(v-10)/10):v<2&&(b=14);const I=Math.max(8,Math.min(12,b-2));return new nr({image:new Yo({radius:b,fill:new Wr({color:s.color}),stroke:new Ci({color:"#ffffff",width:b>8?2:1})}),text:b>=8?new cd({text:g,font:`bold ${I}px sans-serif`,fill:new Wr({color:"#ffffff"}),offsetY:1}):void 0})});a.addFeature(f)});const o=r.current.get(s.id);if(o)o.setSource(a),o.setVisible(t&&s.visible);else{const l=new Qp({source:a,zIndex:950,properties:{title:s.name,customPointLayerId:s.id},visible:t&&s.visible});n.addLayer(l),r.current.set(s.id,l)}}),()=>{r.current.forEach(s=>{n&&n.removeLayer(s)}),r.current.clear()}},[n,e,t]),null}function NEe(){const{createLayerModalOpen:n,closeCreateLayerModal:e}=Or(),{addLayer:t}=Yi(),r=Fr(),[i,s]=ie.useState(""),[a,o]=ie.useState([...Fc]),[l,u]=ie.useState(""),h=14*r.fontScale/100,f=()=>{const E=l.trim();E&&!a.includes(E)&&(o([...a,E]),u(""))},g=E=>{o(a.filter(T=>T!==E))},y=E=>{a.includes(E)?o(a.filter(T=>T!==E)):o([...a,E])},v=()=>{i.trim()&&(t(i.trim(),a),s(""),o([...Fc]),u(""),e())},x=()=>{s(""),o([...Fc]),u(""),e()};return p.jsx(jr,{children:n&&p.jsxs(p.Fragment,{children:[p.jsx(Ft.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:x}),p.jsxs(Ft.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-sm mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[p.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(to,{size:18}),p.jsx("span",{className:"font-medium",children:"Nieuwe laag"})]}),p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),p.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:r.fontScale,onChange:E=>r.setFontScale(parseInt(E.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${r.fontScale}%`}),p.jsx("span",{className:"text-xs opacity-70",children:"T"}),p.jsx("button",{onClick:x,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:p.jsx(Qi,{size:18})})]})]}),p.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",style:{fontSize:`${h}px`},children:[p.jsxs("div",{children:[p.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Naam van de laag"}),p.jsx("input",{type:"text",value:i,onChange:E=>s(E.target.value),placeholder:"bijv. Vakantie Frankrijk 2026",className:"w-full px-3 py-2 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"},autoFocus:!0})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block font-medium text-gray-700 mb-2",style:{fontSize:"0.9em"},children:"Categorien"}),p.jsx("div",{className:"flex flex-wrap gap-2",children:Fc.map(E=>p.jsx("button",{onClick:()=>y(E),className:`px-3 py-1 rounded-full transition-colors border-0 outline-none ${a.includes(E)?"bg-orange-500 text-white":"bg-white text-gray-600 hover:bg-blue-50"}`,style:{fontSize:"0.9em"},children:E},E))})]}),a.filter(E=>!Fc.includes(E)).length>0&&p.jsxs("div",{children:[p.jsx("label",{className:"block font-medium text-gray-700 mb-2",style:{fontSize:"0.9em"},children:"Eigen categorien"}),p.jsx("div",{className:"flex flex-wrap gap-2",children:a.filter(E=>!Fc.includes(E)).map(E=>p.jsxs("div",{className:"flex items-center",children:[p.jsx("button",{onClick:()=>y(E),className:"px-3 py-1 rounded-l-full bg-orange-500 text-white hover:bg-orange-600 transition-colors border-0 outline-none",style:{fontSize:"0.9em"},children:E}),p.jsx("button",{onClick:()=>g(E),className:"px-2 py-1 rounded-r-full bg-orange-600 text-white hover:bg-orange-700 transition-colors border-0 outline-none",title:"Verwijder categorie",children:p.jsx(pd,{size:12})})]},E))})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Eigen categorie toevoegen"}),p.jsxs("div",{className:"flex gap-2",children:[p.jsx("input",{type:"text",value:l,onChange:E=>u(E.target.value),placeholder:"bijv. Grot, Bron, ...",className:"flex-1 px-3 py-2 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"},onKeyDown:E=>E.key==="Enter"&&f()}),p.jsx("button",{onClick:f,disabled:!l.trim(),className:"px-3 py-2 bg-white hover:bg-blue-50 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg transition-colors border-0 outline-none text-gray-600",children:p.jsx(oo,{size:20})})]})]})]}),p.jsxs("div",{className:"p-4 flex gap-3",style:{fontSize:`${h}px`},children:[p.jsx("button",{onClick:x,className:"flex-1 px-4 py-2 bg-white hover:bg-blue-50 rounded-lg transition-colors border-0 outline-none text-gray-600",style:{fontSize:"1em"},children:"Annuleren"}),p.jsx("button",{onClick:v,disabled:!i.trim(),className:"flex-1 px-4 py-2 bg-orange-500 hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg transition-colors border-0 outline-none",style:{fontSize:"1em"},children:"Aanmaken"})]})]})]})})}const mG=200,LEe=.7;async function OEe(n,e=mG){return new Promise((t,r)=>{const i=new Image,s=document.createElement("canvas"),a=s.getContext("2d");i.onload=()=>{let o=i.width,l=i.height;o>l?o>e&&(l=Math.round(l*e/o),o=e):l>e&&(o=Math.round(o*e/l),l=e),s.width=o,s.height=l,a?.drawImage(i,0,0,o,l),s.toBlob(u=>{u?t(u):r(new Error("Failed to create blob from canvas"))},"image/jpeg",LEe)},i.onerror=()=>r(new Error("Failed to load image")),i.src=URL.createObjectURL(n)})}function DEe(n){return new Promise((e,t)=>{const r=new FileReader;r.onloadend=()=>{typeof r.result=="string"?e(r.result):t(new Error("Failed to convert blob to base64"))},r.onerror=()=>t(new Error("Failed to read blob")),r.readAsDataURL(n)})}async function FEe(n){const e=await OEe(n,mG),t=await DEe(e);return{thumbnailBlob:e,thumbnailBase64:t}}function jEe(){return`photo_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}const qS=5;function VEe({photos:n,onAddPhoto:e,onRemovePhoto:t,disabled:r}){const i=ie.useRef(null),s=ie.useRef(null),a=async l=>{const u=l.target.files;if(!u||u.length===0)return;const h=qS-n.length,f=Array.from(u).slice(0,h);for(const g of f)try{const{thumbnailBase64:y}=await FEe(g),v={id:jEe(),thumbnailBase64:y,createdAt:new Date().toISOString(),pendingUpload:!0};e(v)}catch(y){console.error("Failed to process image:",y)}l.target.value=""},o=n.length<qS;return p.jsxs("div",{className:"space-y-2",children:[p.jsxs("label",{className:"block font-medium text-gray-700",style:{fontSize:"0.9em"},children:["Foto's (",n.length,"/",qS,")"]}),p.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.map(l=>p.jsxs("div",{className:"relative w-16 h-16 rounded-lg overflow-hidden bg-gray-100 border border-gray-200",children:[p.jsx("img",{src:l.thumbnailUrl||l.thumbnailBase64,alt:"Foto",className:"w-full h-full object-cover"}),!r&&p.jsx("button",{type:"button",onClick:()=>t(l.id),className:"absolute top-0.5 right-0.5 w-5 h-5 bg-red-500 rounded-full flex items-center justify-center border-0 outline-none",children:p.jsx(Qi,{size:12,className:"text-white"})}),l.pendingUpload&&p.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-orange-500/80 text-white text-center py-0.5",style:{fontSize:"0.6em"},children:"Wacht..."})]},l.id)),o&&!r&&p.jsxs(p.Fragment,{children:[p.jsxs("button",{type:"button",onClick:()=>s.current?.click(),className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 hover:border-orange-400 hover:bg-orange-50 flex flex-col items-center justify-center gap-1 transition-colors bg-transparent outline-none",title:"Maak foto",children:[p.jsx(yR,{size:20,className:"text-gray-400"}),p.jsx("span",{className:"text-gray-400",style:{fontSize:"0.6em"},children:"Camera"})]}),p.jsxs("button",{type:"button",onClick:()=>i.current?.click(),className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 hover:border-orange-400 hover:bg-orange-50 flex flex-col items-center justify-center gap-1 transition-colors bg-transparent outline-none",title:"Kies foto",children:[p.jsx(Sae,{size:20,className:"text-gray-400"}),p.jsx("span",{className:"text-gray-400",style:{fontSize:"0.6em"},children:"Gallerij"})]})]})]}),p.jsx("input",{ref:s,type:"file",accept:"image/*",capture:"environment",onChange:a,className:"hidden"}),p.jsx("input",{ref:i,type:"file",accept:"image/*",multiple:!0,onChange:a,className:"hidden"})]})}function GEe(){const{addPointModalOpen:n,addPointModalLayerId:e,addPointModalLocation:t,closeAddPointModal:r}=Or(),{addPoint:i,getLayer:s}=Yi(),a=Fr(),[o,l]=ie.useState(""),[u,h]=ie.useState(""),[f,g]=ie.useState(""),[y,v]=ie.useState([]),x=e?s(e):null,E=14*a.fontScale/100,T=()=>{!o.trim()||!e||!t||(i(e,{name:o.trim(),category:"Overig",notes:u.trim(),url:f.trim()||void 0,coordinates:[t.lng,t.lat],photos:y.length>0?y:void 0}),l(""),h(""),g(""),v([]),r())},b=()=>{l(""),h(""),g(""),v([]),r()};return x?p.jsx(jr,{children:n&&p.jsxs(p.Fragment,{children:[p.jsx(Ft.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:b}),p.jsxs(Ft.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-sm mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[p.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(Hl,{size:18}),p.jsx("span",{className:"font-medium",children:"Punt toevoegen"})]}),p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),p.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:a.fontScale,onChange:I=>a.setFontScale(parseInt(I.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${a.fontScale}%`}),p.jsx("span",{className:"text-xs opacity-70",children:"T"}),p.jsx("button",{onClick:b,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:p.jsx(Qi,{size:18})})]})]}),p.jsx("div",{className:"px-4 py-1.5",children:p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:x.color}}),p.jsx("span",{className:"text-sm text-gray-600",children:x.name})]})}),p.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",style:{fontSize:`${E}px`},children:[p.jsxs("div",{children:[p.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Naam *"}),p.jsx("input",{type:"text",value:o,onChange:I=>l(I.target.value),className:"w-full px-3 py-1.5 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"},autoFocus:!0})]}),p.jsx(VEe,{photos:y,onAddPhoto:I=>v([...y,I]),onRemovePhoto:I=>v(y.filter(M=>M.id!==I))}),p.jsxs("div",{children:[p.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Notities"}),p.jsx("textarea",{value:u,onChange:I=>h(I.target.value),placeholder:"Beschrijving, tips, opmerkingen...",rows:2,className:"w-full px-3 py-1.5 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors resize-none",style:{fontSize:"1em"}})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Link"}),p.jsx("input",{type:"url",value:f,onChange:I=>g(I.target.value),placeholder:"https://...",className:"w-full px-3 py-1.5 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"}})]})]}),p.jsxs("div",{className:"p-3 flex gap-3",style:{fontSize:`${E}px`},children:[p.jsx("button",{onClick:b,className:"flex-1 px-4 py-1.5 bg-white hover:bg-blue-50 rounded-lg transition-colors border-0 outline-none text-gray-600",style:{fontSize:"1em"},children:"Annuleren"}),p.jsx("button",{onClick:T,disabled:!o.trim(),className:"flex-1 px-4 py-1.5 bg-orange-500 hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg transition-colors border-0 outline-none",style:{fontSize:"1em"},children:"Toevoegen"})]})]})]})}):null}function BEe(){const{layerManagerModalOpen:n,closeLayerManagerModal:e,openCreateLayerModal:t,openLayerDashboard:r}=Or(),{layers:i,removeLayer:s,toggleVisibility:a,toggleArchived:o,exportLayerAsGeoJSON:l,importLayerFromGeoJSON:u}=Yi(),h=Fr(),f=14*h.fontScale/100,[g,y]=ie.useState(null),[v,x]=ie.useState(null),[E,T]=ie.useState(null),[b,I]=ie.useState(!1),M=i.filter(j=>!j.archived),F=i.filter(j=>j.archived),z=b?F:M,k=j=>{v===j?(s(j),x(null)):(x(j),setTimeout(()=>x(null),3e3))},C=j=>{l(j)},P=async j=>{const Ie=j.target.files?.[0];if(Ie){try{const ke=await Ie.text(),ze=u(ke);ze.success||(T(ze.error||"Import mislukt"),setTimeout(()=>T(null),3e3))}catch{T("Kon bestand niet lezen"),setTimeout(()=>T(null),3e3)}j.target.value=""}},L=()=>{y(null),x(null),T(null),I(!1),e()},O=j=>{r(j)},U=()=>{L(),t()};return p.jsx(jr,{children:n&&p.jsxs(p.Fragment,{children:[p.jsx(Ft.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:L}),p.jsxs(Ft.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[p.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(to,{size:18}),p.jsx("span",{className:"font-medium",children:"Mijn Lagen beheren"})]}),p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),p.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:h.fontScale,onChange:j=>h.setFontScale(parseInt(j.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${h.fontScale}%`}),p.jsx("span",{className:"text-xs opacity-70",children:"T"}),p.jsx("button",{onClick:L,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:p.jsx(Qi,{size:18})})]})]}),p.jsxs("div",{className:"flex border-b border-gray-100",children:[p.jsxs("button",{onClick:()=>I(!1),className:`flex-1 px-3 py-2 text-sm transition-colors border-0 outline-none ${b?"text-gray-500 hover:text-gray-700 hover:bg-gray-50":"text-orange-600 border-b-2 border-orange-500 bg-orange-50/50"}`,children:["Actief (",M.length,")"]}),p.jsxs("button",{onClick:()=>I(!0),className:`flex-1 px-3 py-2 text-sm transition-colors border-0 outline-none flex items-center justify-center gap-1 ${b?"text-orange-600 border-b-2 border-orange-500 bg-orange-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[p.jsx(v9,{size:14}),"Archief (",F.length,")"]})]}),p.jsxs("div",{className:"flex-1 overflow-y-auto",style:{fontSize:`${f}px`},children:[z.length===0?p.jsx("div",{className:"p-8 text-center text-gray-500",children:b?p.jsx("p",{style:{fontSize:"1em"},children:"Geen gearchiveerde lagen."}):p.jsxs(p.Fragment,{children:[p.jsx("p",{className:"mb-4",style:{fontSize:"1em"},children:"Je hebt nog geen eigen lagen."}),p.jsxs("button",{onClick:U,className:"px-4 py-2 bg-orange-500 hover:bg-orange-600 text-white rounded-lg transition-colors border-0 outline-none",style:{fontSize:"1em"},children:[p.jsx(oo,{size:16,className:"inline mr-2"}),"Nieuwe laag aanmaken"]})]})}):p.jsx("div",{className:"divide-y divide-gray-100",children:z.map(j=>p.jsx(zEe,{layer:j,isExpanded:g===j.id,onToggleExpand:()=>y(g===j.id?null:j.id),onToggleVisibility:()=>a(j.id),onToggleArchived:()=>o(j.id),onOpenDashboard:()=>O(j.id),onExport:()=>C(j.id),onDelete:()=>k(j.id),confirmDelete:v===j.id,onRename:Ie=>Yi.getState().updateLayer(j.id,{name:Ie}),onChangeColor:Ie=>Yi.getState().updateLayer(j.id,{color:Ie})},j.id))}),E&&p.jsx("div",{className:"mx-4 my-2 p-3 bg-red-50 text-red-700 text-sm rounded-lg",children:E})]}),p.jsxs("div",{className:"p-4 flex gap-3",style:{fontSize:`${f}px`},children:[p.jsxs("label",{className:"flex-1 px-4 py-2 bg-white hover:bg-blue-50 rounded-lg transition-colors cursor-pointer flex items-center justify-center gap-2 border-0 outline-none text-gray-600",children:[p.jsx(Ow,{size:16}),p.jsx("span",{style:{fontSize:"1em"},children:"Importeren"}),p.jsx("input",{type:"file",accept:".geojson,.json",onChange:P,className:"hidden"})]}),p.jsxs("button",{onClick:U,className:"flex-1 px-4 py-2 bg-orange-500 hover:bg-orange-600 text-white rounded-lg transition-colors border-0 outline-none flex items-center justify-center gap-2",style:{fontSize:"1em"},children:[p.jsx(oo,{size:16}),p.jsx("span",{children:"Nieuwe laag"})]})]})]})]})})}const UEe=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899"];function zEe({layer:n,isExpanded:e,onToggleExpand:t,onToggleVisibility:r,onToggleArchived:i,onOpenDashboard:s,onExport:a,onDelete:o,confirmDelete:l,onRename:u,onChangeColor:h}){const[f,g]=ie.useState(!1),[y,v]=ie.useState(n.name),[x,E]=ie.useState(!1),T=ie.useRef(null);ie.useEffect(()=>{f&&T.current&&(T.current.focus(),T.current.select())},[f]);const b=()=>{v(n.name),g(!0)},I=()=>{const C=y.trim();C&&C!==n.name&&u(C),g(!1)},M=()=>{v(n.name),g(!1)},F=C=>{C.key==="Enter"?I():C.key==="Escape"&&M()},z=n.points.filter(C=>C.status==="completed").length,k=n.points.length;return p.jsxs("div",{className:"bg-white",children:[p.jsxs("div",{className:"flex items-center gap-3 px-4 py-3",children:[p.jsx("button",{onClick:t,className:"p-1 text-gray-400 hover:text-gray-600 transition-colors border-0 outline-none bg-transparent",children:e?p.jsx(_R,{size:16}):p.jsx(Lw,{size:16})}),p.jsxs("div",{className:"relative",children:[p.jsx("button",{onClick:()=>E(!x),className:"w-5 h-5 rounded-full flex-shrink-0 border-2 border-white shadow-sm hover:scale-110 transition-transform cursor-pointer",style:{backgroundColor:n.color},title:"Kleur wijzigen"}),x&&p.jsx("div",{className:"absolute top-7 left-0 z-50 bg-white rounded-lg shadow-lg p-2 flex flex-wrap gap-1 w-24",children:UEe.map(C=>p.jsx("button",{onClick:()=>{h(C),E(!1)},className:`w-5 h-5 rounded-full border-2 hover:scale-110 transition-transform ${C===n.color?"border-gray-800":"border-white"}`,style:{backgroundColor:C}},C))})]}),f?p.jsxs("div",{className:"flex-1 min-w-0 flex items-center gap-2",children:[p.jsx("input",{ref:T,type:"text",value:y,onChange:C=>v(C.target.value),onKeyDown:F,onBlur:I,className:"flex-1 px-2 py-1 text-gray-800 font-medium bg-orange-50 rounded outline-none focus:ring-2 focus:ring-orange-400"}),p.jsx("button",{onClick:I,className:"p-1 text-green-600 hover:bg-green-50 rounded transition-colors border-0 outline-none",title:"Opslaan",children:p.jsx(Wl,{size:16})})]}):p.jsxs("button",{onClick:s,className:"flex-1 min-w-0 text-left border-0 outline-none bg-transparent hover:bg-orange-50 rounded px-2 py-1 -ml-2 transition-colors",title:"Bekijk dashboard",children:[p.jsx("div",{className:"font-medium text-gray-800 truncate hover:text-orange-600",children:n.name}),p.jsx("div",{className:"text-xs text-gray-500",children:k>0?p.jsxs("span",{className:z===k?"text-green-600":"",children:[z,"/",k," voltooid"]}):"Geen punten"})]}),!f&&p.jsx("button",{onClick:b,className:"p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",title:"Naam bewerken",children:p.jsx(Tp,{size:16})}),p.jsx("button",{onClick:s,className:"p-2 text-orange-400 hover:text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none",title:"Open dashboard",children:p.jsx(Aae,{size:18})}),!n.archived&&p.jsx("button",{onClick:r,className:`p-2 rounded transition-colors border-0 outline-none ${n.visible?"text-blue-500 hover:bg-blue-50":"text-gray-400 hover:bg-gray-100"}`,title:n.visible?"Verbergen":"Tonen",children:n.visible?p.jsx(I9,{size:18}):p.jsx(b9,{size:18})}),p.jsx("button",{onClick:i,className:`p-2 rounded transition-colors border-0 outline-none ${n.archived?"text-green-500 hover:text-green-600 hover:bg-green-50":"text-gray-400 hover:text-amber-600 hover:bg-amber-50"}`,title:n.archived?"Herstellen":"Archiveren",children:n.archived?p.jsx(Fse,{size:18}):p.jsx(v9,{size:18})}),p.jsx("button",{onClick:a,className:"p-2 text-gray-400 hover:text-green-600 hover:bg-green-50 rounded transition-colors border-0 outline-none",title:"Exporteren als GeoJSON",children:p.jsx(wb,{size:18})}),p.jsx("button",{onClick:o,className:`p-2 rounded transition-colors border-0 outline-none ${l?"text-white bg-red-500 hover:bg-red-600":"text-gray-400 hover:text-red-600 hover:bg-red-50"}`,title:l?"Klik nogmaals om te verwijderen":"Verwijderen",children:p.jsx(pd,{size:18})})]}),p.jsx(jr,{children:e&&p.jsx(Ft.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:p.jsxs("div",{className:"px-4 pb-3 pl-12 space-y-2",children:[n.categories.length>0&&p.jsx("div",{className:"flex flex-wrap gap-1",children:n.categories.map(C=>p.jsx("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-600 text-xs rounded-full",children:C},C))}),n.points.length>0&&p.jsxs("div",{className:"text-xs text-gray-500 space-y-1 max-h-32 overflow-y-auto",children:[n.points.slice(0,5).map(C=>p.jsx("div",{className:"flex items-center gap-2",children:p.jsx("span",{className:`font-medium ${C.status==="completed"?"text-green-600 line-through":C.status==="skipped"?"text-gray-400 line-through":"text-gray-700"}`,children:C.name})},C.id)),n.points.length>5&&p.jsxs("div",{className:"text-gray-400",children:["...en ",n.points.length-5," meer"]})]}),p.jsxs("div",{className:"text-xs text-gray-400",children:["Aangemaakt: ",new Date(n.createdAt).toLocaleDateString("nl-NL")]})]})})})]})}function $Ee(){const{layerDashboardOpen:n,layerDashboardLayerId:e,closeLayerDashboard:t}=Or(),{getLayer:r,setPointStatus:i,updatePoint:s,removePoint:a}=Yi(),o=Fr(),[l,u]=ie.useState("all"),[h,f]=ie.useState(null),[g,y]=ie.useState(""),[v,x]=ie.useState(null),E=e?r(e):null,T=14*o.fontScale/100;if(!E)return null;const b=E.points.filter(O=>l==="all"?!0:O.status===l),I=E.points.length,M=E.points.filter(O=>O.status==="completed").length,F=E.points.filter(O=>O.status==="todo").length,z=E.points.filter(O=>O.status==="skipped").length,k=(O,U)=>{i(E.id,O,U)},C=O=>{s(E.id,O,{notes:g}),f(null),y("")},P=O=>{v===O?(a(E.id,O),x(null)):(x(O),setTimeout(()=>x(null),3e3))},L=()=>{f(null),x(null),t()};return p.jsx(jr,{children:n&&p.jsxs(p.Fragment,{children:[p.jsx(Ft.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:L}),p.jsxs(Ft.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[p.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("div",{className:"w-4 h-4 rounded-full border-2 border-white/50",style:{backgroundColor:E.color}}),p.jsx("span",{className:"font-medium truncate",children:E.name})]}),p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),p.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:o.fontScale,onChange:O=>o.setFontScale(parseInt(O.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${o.fontScale}%`}),p.jsx("span",{className:"text-xs opacity-70",children:"T"}),p.jsx("button",{onClick:L,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:p.jsx(Qi,{size:18})})]})]}),p.jsxs("div",{className:"px-4 py-2 bg-orange-50 flex items-center justify-between text-sm",children:[p.jsxs("span",{className:"text-orange-800 font-medium",children:[M,"/",I," voltooid"]}),p.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[p.jsxs("span",{className:"text-orange-600",children:[F," te doen"]}),z>0&&p.jsxs("span",{className:"text-gray-500",children:[z," overgeslagen"]})]})]}),p.jsx("div",{className:"flex border-b border-gray-100",children:["all","todo","completed","skipped"].map(O=>p.jsxs("button",{onClick:()=>u(O),className:`flex-1 px-3 py-2 text-sm transition-colors border-0 outline-none ${l===O?"text-orange-600 border-b-2 border-orange-500 bg-orange-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[O==="all"&&"Alles",O==="todo"&&"Te doen",O==="completed"&&"Voltooid",O==="skipped"&&"Overgeslagen"]},O))}),p.jsx("div",{className:"flex-1 overflow-y-auto",style:{fontSize:`${T}px`},children:b.length===0?p.jsx("div",{className:"p-8 text-center text-gray-500",children:p.jsx("p",{children:"Geen punten gevonden"})}):p.jsx("div",{className:"divide-y divide-gray-100",children:b.map(O=>p.jsx("div",{className:"p-3",children:p.jsxs("div",{className:"flex items-start gap-3",children:[p.jsxs("div",{className:"flex flex-col gap-1 pt-0.5",children:[p.jsx("button",{onClick:()=>k(O.id,O.status==="completed"?"todo":"completed"),className:`w-6 h-6 flex items-center justify-center rounded border-0 outline-none transition-colors ${O.status==="completed"?"bg-green-100 hover:bg-green-200":"bg-gray-100 hover:bg-green-100"}`,title:O.status==="completed"?"Markeer als te doen":"Markeer als voltooid",children:p.jsx(Wl,{size:14,className:O.status==="completed"?"text-green-600":"text-gray-400"})}),p.jsx("button",{onClick:()=>k(O.id,O.status==="skipped"?"todo":"skipped"),className:`w-6 h-6 flex items-center justify-center rounded border-0 outline-none transition-colors ${O.status==="skipped"?"bg-gray-200 hover:bg-gray-300":"bg-gray-100 hover:bg-gray-200"}`,title:O.status==="skipped"?"Markeer als te doen":"Overslaan",children:p.jsx(Gse,{size:14,className:O.status==="skipped"?"text-gray-600":"text-gray-400"})})]}),O.photos&&O.photos.length>0&&p.jsxs("div",{className:"relative flex-shrink-0",children:[p.jsx("img",{src:O.photos[0].thumbnailUrl||O.photos[0].thumbnailBase64,alt:"Foto",className:"w-12 h-12 object-cover rounded border border-gray-200"}),O.photos.length>1&&p.jsxs("span",{className:"absolute -bottom-1 -right-1 bg-orange-500 text-white text-[9px] px-1 rounded-full",children:["+",O.photos.length-1]})]}),p.jsxs("div",{className:"flex-1 min-w-0",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("span",{className:`font-medium truncate ${O.status==="completed"?"text-green-700 line-through":O.status==="skipped"?"text-gray-400 line-through":"text-gray-800"}`,children:O.name}),O.sourceLayer&&p.jsxs("span",{className:"text-xs text-gray-400 truncate",children:["via ",O.sourceLayer]})]}),h===O.id?p.jsxs("div",{className:"mt-2",children:[p.jsx("textarea",{value:g,onChange:U=>y(U.target.value),placeholder:"Notities...",rows:2,className:"w-full px-2 py-1 bg-white rounded border-0 outline-none hover:bg-blue-50 transition-colors resize-none text-sm",autoFocus:!0}),p.jsxs("div",{className:"flex gap-2 mt-1",children:[p.jsx("button",{onClick:()=>C(O.id),className:"px-2 py-1 text-xs bg-orange-500 text-white rounded hover:bg-orange-600 border-0 outline-none",children:"Opslaan"}),p.jsx("button",{onClick:()=>{f(null),y("")},className:"px-2 py-1 text-xs bg-white text-gray-600 rounded hover:bg-blue-50 border-0 outline-none",children:"Annuleren"})]})]}):O.notes?p.jsx("p",{className:"text-sm text-gray-600 mt-1",children:O.notes}):null,O.url&&p.jsxs("a",{href:O.url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-xs text-blue-500 hover:text-blue-700 mt-1",children:[p.jsx(S1,{size:12}),"Link"]})]}),p.jsxs("div",{className:"flex flex-col gap-1",children:[p.jsx("button",{onClick:()=>{f(O.id),y(O.notes)},className:"w-6 h-6 flex items-center justify-center text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded border-0 outline-none",title:"Notities bewerken",children:p.jsx(Wae,{size:14})}),p.jsx("button",{onClick:()=>{window.open(`https://www.google.com/maps/dir/?api=1&destination=${O.coordinates[1]},${O.coordinates[0]}`,"_blank")},className:"w-6 h-6 flex items-center justify-center text-blue-400 hover:text-blue-600 hover:bg-blue-50 rounded border-0 outline-none",title:"Navigeer naar",children:p.jsx(Hl,{size:14})}),p.jsx("button",{onClick:()=>P(O.id),className:`w-6 h-6 flex items-center justify-center rounded border-0 outline-none ${v===O.id?"text-white bg-red-500 hover:bg-red-600":"text-gray-400 hover:text-red-600 hover:bg-red-50"}`,title:v===O.id?"Klik nogmaals":"Verwijderen",children:p.jsx(pd,{size:14})})]})]})},O.id))})})]})]})})}class DO{buffer=[];size;weights;constructor(e=8){this.size=e,this.weights=Array.from({length:e},(r,i)=>Math.pow(2,i));const t=this.weights.reduce((r,i)=>r+i,0);this.weights=this.weights.map(r=>r/t)}add(e){if(this.buffer.length>0){const t=this.buffer[this.buffer.length-1];let r=e-t;r>180&&(e-=360),r<-180&&(e+=360)}this.buffer.push(e),this.buffer.length>this.size&&this.buffer.shift()}getSmoothed(){if(this.buffer.length===0)return null;if(this.buffer.length===1)return this.normalizeHeading(this.buffer[0]);let e=0,t=0;const r=this.size-this.buffer.length;for(let i=0;i<this.buffer.length;i++){const s=this.weights[r+i];e+=this.buffer[i]*s,t+=s}return this.normalizeHeading(e/t)}normalizeHeading(e){return(e%360+360)%360}clear(){this.buffer=[]}}function WEe(){const n=is(u=>u.tracking),e=is(u=>u.headingSource);is(u=>u.speed);const t=is(u=>u.setSmoothedHeading),r=ie.useRef(new DO(6)),i=ie.useRef(new DO(10)),s=ie.useRef(0),a=ie.useRef(null),o=33,l=ie.useCallback((u,h)=>{const f=performance.now();if(f-s.current<o)return;const g=h==="gps"?r.current:i.current;g.add(u);const y=g.getSmoothed();y!==null&&(s.current=f,t(y))},[t]);ie.useEffect(()=>{if(!n)return;const u=f=>{f.coords.heading!==null&&f.coords.speed!==null&&f.coords.speed>.8&&f.coords.accuracy<20&&l(f.coords.heading,"gps")},h=navigator.geolocation.watchPosition(u,()=>{},{enableHighAccuracy:!0,maximumAge:500,timeout:1e4});return()=>navigator.geolocation.clearWatch(h)},[n,l]),ie.useEffect(()=>{if(!n||e!=="compass")return;let u=0;const h=50,f=y=>{const v=performance.now();if(!(v-u<h)&&(u=v,y.alpha!==null)){const x=(360-y.alpha)%360;l(x,"compass")}},g=y=>{const v=performance.now();v-u<h||(u=v,y.webkitCompassHeading!==void 0&&l(y.webkitCompassHeading,"compass"))};return window.addEventListener("deviceorientationabsolute",f),window.addEventListener("deviceorientation",g),()=>{window.removeEventListener("deviceorientationabsolute",f),window.removeEventListener("deviceorientation",g)}},[n,e,l]),ie.useEffect(()=>{n||(r.current.clear(),i.current.clear())},[n]),ie.useEffect(()=>()=>{a.current&&cancelAnimationFrame(a.current)},[])}function HEe(){const n=hs(i=>i.map),e=di(i=>i.setLayerOpacity),t=di(i=>i.visible),r=ie.useRef(null);ie.useEffect(()=>{if(!n)return;const i=()=>{const s=n.getView().getZoom();if(!s||r.current!==null&&Math.abs(s-r.current)<.5)return;r.current=s;const a=t["AHN 0.5m"],o=t["AHN4 Multi-Hillshade NL"];!a&&!o||(a&&(s>=18?e("AHN 0.5m",.85):s>=16?e("AHN 0.5m",.75):s>=14?e("AHN 0.5m",.65):e("AHN 0.5m",.55)),o&&(s>=18?e("AHN4 Multi-Hillshade NL",.8):s>=16?e("AHN4 Multi-Hillshade NL",.7):s>=14?e("AHN4 Multi-Hillshade NL",.6):e("AHN4 Multi-Hillshade NL",.5)))};return n.on("moveend",i),i(),()=>{n.un("moveend",i)}},[n,t,e])}const FO=2e3;function KEe(){const n=Aw(g=>g.user),{layers:e,clearAll:t}=Yi(),{vondsten:r,clearAll:i}=$o(),s=ie.useRef(null),a=ie.useRef(!0),o=ie.useRef(""),l=ie.useRef(""),u=ie.useCallback(async g=>{if(n)try{const y=qf(qc,"users",n.uid);await $N(y,{layers:g,layersUpdatedAt:WN()},{merge:!0}),console.log(" Lagen gesynchroniseerd naar cloud")}catch(y){console.error(" Fout bij synchroniseren lagen:",y)}},[n]),h=ie.useCallback(async g=>{if(n)try{const y=qf(qc,"users",n.uid);await $N(y,{vondsten:g,vondstenUpdatedAt:WN()},{merge:!0}),console.log(" Vondsten gesynchroniseerd naar cloud")}catch(y){console.error(" Fout bij synchroniseren vondsten:",y)}},[n]),f=ie.useCallback(async()=>{if(n)try{const g=qf(qc,"users",n.uid),y=await mee(g);if(y.exists()){const v=y.data();if(v.layers&&Array.isArray(v.layers)){const x=v.layers,E=Yi.getState().layers,T=[...x],b=new Set(x.map(I=>I.id));E.forEach(I=>{b.has(I.id)||T.push(I)}),Yi.setState({layers:T}),o.current=JSON.stringify(T),console.log(` ${x.length} lagen geladen uit cloud`)}if(v.vondsten&&Array.isArray(v.vondsten)){const x=v.vondsten,E=$o.getState().vondsten,T=[...x],b=new Set(x.map(I=>I.id));E.forEach(I=>{b.has(I.id)||T.push(I)}),$o.setState({vondsten:T}),l.current=JSON.stringify(T),console.log(` ${x.length} vondsten geladen uit cloud`)}}else console.log(" Geen cloud data gevonden, lokale data wordt gesynchroniseerd..."),await u(e),await h(r);a.current=!1}catch(g){console.error(" Fout bij laden uit cloud:",g),a.current=!1}},[n,e,r,u,h]);return ie.useEffect(()=>{n?(a.current=!0,f()):(a.current=!0,o.current="",l.current="")},[n?.uid]),ie.useEffect(()=>{if(!n||a.current)return;const g=JSON.stringify(e);if(g!==o.current)return s.current&&clearTimeout(s.current),s.current=setTimeout(()=>{o.current=g,u(e)},FO),()=>{s.current&&clearTimeout(s.current)}},[n,e,u]),ie.useEffect(()=>{if(!n||a.current)return;const g=JSON.stringify(r);if(g!==l.current)return s.current&&clearTimeout(s.current),s.current=setTimeout(()=>{l.current=g,h(r)},FO),()=>{s.current&&clearTimeout(s.current)}},[n,r,h]),{isLoggedIn:!!n,syncLayersToCloud:u,syncVondstenToCloud:h}}function YEe(){WEe(),HEe(),KEe();const e=14*Fr(s=>s.fontScale)/100,t=Or(s=>s.vondstFormOpen),r=Or(s=>s.vondstFormLocation),i=Or(s=>s.closeVondstForm);return p.jsx(Zwe,{children:p.jsxs("div",{style:{fontSize:`${e}px`},children:[p.jsx(ite,{}),p.jsx(koe,{}),p.jsx(CEe,{}),p.jsx(rEe,{}),p.jsx(MEe,{}),p.jsx(Lwe,{}),p.jsx(Dwe,{}),p.jsx(Ywe,{}),p.jsx(Coe,{}),p.jsx(AEe,{}),p.jsx(qwe,{}),p.jsx(Noe,{}),p.jsx(Doe,{}),p.jsx(Kwe,{}),p.jsx(vEe,{}),p.jsx(zwe,{}),p.jsx(EEe,{}),p.jsx($we,{}),p.jsx(pEe,{}),p.jsx(NEe,{}),p.jsx(GEe,{}),p.jsx(BEe,{}),p.jsx($Ee,{}),p.jsx(jr,{children:t&&p.jsx(gG,{onClose:i,initialLocation:r||void 0})})]})})}console.log(`%c DetectorApp v${gC}`,"background: #4CAF50; color: white; padding: 4px 8px; border-radius: 4px; font-weight: bold;");kB.createRoot(document.getElementById("root")).render(p.jsx(YEe,{}));export{Yo as C,Wr as F,OR as G,gW as I,so as L,Js as P,nr as S,nh as T,Kp as V,qW as a,BW as b,Qp as c,Ci as d,cd as e,io as f,Ho as g,qp as h,vn as p,M7 as r};
//# sourceMappingURL=index-fWXEgrAb.js.map
