const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/romeinseFortenOL-UGzk1WGu.js","assets/iconStyles-yuqzxjJ0.js","assets/amkOL-7RCfjzeD.js","assets/layerLoaderOL-2yXxRCou.js","assets/romeinsOL-FFPpumcd.js","assets/kastelenOL-BTVxiKfb.js","assets/ruinesOL-VoFRQq1p.js","assets/hunebeddenOL-B3edVa4l.js","assets/uikavArcheoPuntenOL-Dxajkn-H.js","assets/uikavVlakkenOL-BLcD1v0B.js","assets/uikavBufferlaagOL-e5zpYvuX.js","assets/uikavExpertOL-JLd2zpZV.js","assets/uikavUiterwaardenOL-DNCZ0EAH.js","assets/speeltuinenOL-CvibYSoW.js","assets/museaOL-BM5sCYK_.js","assets/strandjesOL-B2SZog1i.js","assets/parkenOL-DT0BrNxI.js","assets/kringloopwinkelsOL-CD8xGraP.js","assets/fossielenOL-kmWrsqWt.js","assets/fossielUtils-CGF-C3hJ.js","assets/fossielenBelgieOL-RieZM2EL.js","assets/fossielenDuitslandOL-B2DzxtIY.js","assets/fossielenFrankrijkOL-DwwmLf2r.js","assets/bunkersOL-BSnRqSk5.js","assets/grafheuvelsOL-Bi9LFZuL.js","assets/slagveldenOL-BTP7EZdH.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();function QR(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var gT={exports:{}},am={},mT={exports:{}},dn={};var W4;function _U(){if(W4)return dn;W4=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),a=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;function m(se){return se===null||typeof se!="object"?null:(se=f&&se[f]||se["@@iterator"],typeof se=="function"?se:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x=Object.assign,_={};function w(se,V,Z){this.props=se,this.context=V,this.refs=_,this.updater=Z||y}w.prototype.isReactComponent={},w.prototype.setState=function(se,V){if(typeof se!="object"&&typeof se!="function"&&se!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,se,V,"setState")},w.prototype.forceUpdate=function(se){this.updater.enqueueForceUpdate(this,se,"forceUpdate")};function S(){}S.prototype=w.prototype;function b(se,V,Z){this.props=se,this.context=V,this.refs=_,this.updater=Z||y}var R=b.prototype=new S;R.constructor=b,x(R,w.prototype),R.isPureReactComponent=!0;var M=Array.isArray,O=Object.prototype.hasOwnProperty,G={current:null},A={key:!0,ref:!0,__self:!0,__source:!0};function I(se,V,Z){var te,ie={},ue=null,Ve=null;if(V!=null)for(te in V.ref!==void 0&&(Ve=V.ref),V.key!==void 0&&(ue=""+V.key),V)O.call(V,te)&&!A.hasOwnProperty(te)&&(ie[te]=V[te]);var Ge=arguments.length-2;if(Ge===1)ie.children=Z;else if(1<Ge){for(var ye=Array(Ge),pe=0;pe<Ge;pe++)ye[pe]=arguments[pe+2];ie.children=ye}if(se&&se.defaultProps)for(te in Ge=se.defaultProps,Ge)ie[te]===void 0&&(ie[te]=Ge[te]);return{$$typeof:n,type:se,key:ue,ref:Ve,props:ie,_owner:G.current}}function P(se,V){return{$$typeof:n,type:se.type,key:V,ref:se.ref,props:se.props,_owner:se._owner}}function D(se){return typeof se=="object"&&se!==null&&se.$$typeof===n}function L(se){var V={"=":"=0",":":"=2"};return"$"+se.replace(/[=:]/g,function(Z){return V[Z]})}var U=/\/+/g;function j(se,V){return typeof se=="object"&&se!==null&&se.key!=null?L(""+se.key):V.toString(36)}function Ee(se,V,Z,te,ie){var ue=typeof se;(ue==="undefined"||ue==="boolean")&&(se=null);var Ve=!1;if(se===null)Ve=!0;else switch(ue){case"string":case"number":Ve=!0;break;case"object":switch(se.$$typeof){case n:case e:Ve=!0}}if(Ve)return Ve=se,ie=ie(Ve),se=te===""?"."+j(Ve,0):te,M(ie)?(Z="",se!=null&&(Z=se.replace(U,"$&/")+"/"),Ee(ie,V,Z,"",function(pe){return pe})):ie!=null&&(D(ie)&&(ie=P(ie,Z+(!ie.key||Ve&&Ve.key===ie.key?"":(""+ie.key).replace(U,"$&/")+"/")+se)),V.push(ie)),1;if(Ve=0,te=te===""?".":te+":",M(se))for(var Ge=0;Ge<se.length;Ge++){ue=se[Ge];var ye=te+j(ue,Ge);Ve+=Ee(ue,V,Z,ye,ie)}else if(ye=m(se),typeof ye=="function")for(se=ye.call(se),Ge=0;!(ue=se.next()).done;)ue=ue.value,ye=te+j(ue,Ge++),Ve+=Ee(ue,V,Z,ye,ie);else if(ue==="object")throw V=String(se),Error("Objects are not valid as a React child (found: "+(V==="[object Object]"?"object with keys {"+Object.keys(se).join(", ")+"}":V)+"). If you meant to render a collection of children, use an array instead.");return Ve}function ke(se,V,Z){if(se==null)return se;var te=[],ie=0;return Ee(se,te,"","",function(ue){return V.call(Z,ue,ie++)}),te}function Be(se){if(se._status===-1){var V=se._result;V=V(),V.then(function(Z){(se._status===0||se._status===-1)&&(se._status=1,se._result=Z)},function(Z){(se._status===0||se._status===-1)&&(se._status=2,se._result=Z)}),se._status===-1&&(se._status=0,se._result=V)}if(se._status===1)return se._result.default;throw se._result}var Me={current:null},ce={transition:null},Pe={ReactCurrentDispatcher:Me,ReactCurrentBatchConfig:ce,ReactCurrentOwner:G};function be(){throw Error("act(...) is not supported in production builds of React.")}return dn.Children={map:ke,forEach:function(se,V,Z){ke(se,function(){V.apply(this,arguments)},Z)},count:function(se){var V=0;return ke(se,function(){V++}),V},toArray:function(se){return ke(se,function(V){return V})||[]},only:function(se){if(!D(se))throw Error("React.Children.only expected to receive a single React element child.");return se}},dn.Component=w,dn.Fragment=t,dn.Profiler=i,dn.PureComponent=b,dn.StrictMode=r,dn.Suspense=l,dn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Pe,dn.act=be,dn.cloneElement=function(se,V,Z){if(se==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+se+".");var te=x({},se.props),ie=se.key,ue=se.ref,Ve=se._owner;if(V!=null){if(V.ref!==void 0&&(ue=V.ref,Ve=G.current),V.key!==void 0&&(ie=""+V.key),se.type&&se.type.defaultProps)var Ge=se.type.defaultProps;for(ye in V)O.call(V,ye)&&!A.hasOwnProperty(ye)&&(te[ye]=V[ye]===void 0&&Ge!==void 0?Ge[ye]:V[ye])}var ye=arguments.length-2;if(ye===1)te.children=Z;else if(1<ye){Ge=Array(ye);for(var pe=0;pe<ye;pe++)Ge[pe]=arguments[pe+2];te.children=Ge}return{$$typeof:n,type:se.type,key:ie,ref:ue,props:te,_owner:Ve}},dn.createContext=function(se){return se={$$typeof:a,_currentValue:se,_currentValue2:se,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},se.Provider={$$typeof:s,_context:se},se.Consumer=se},dn.createElement=I,dn.createFactory=function(se){var V=I.bind(null,se);return V.type=se,V},dn.createRef=function(){return{current:null}},dn.forwardRef=function(se){return{$$typeof:o,render:se}},dn.isValidElement=D,dn.lazy=function(se){return{$$typeof:h,_payload:{_status:-1,_result:se},_init:Be}},dn.memo=function(se,V){return{$$typeof:c,type:se,compare:V===void 0?null:V}},dn.startTransition=function(se){var V=ce.transition;ce.transition={};try{se()}finally{ce.transition=V}},dn.unstable_act=be,dn.useCallback=function(se,V){return Me.current.useCallback(se,V)},dn.useContext=function(se){return Me.current.useContext(se)},dn.useDebugValue=function(){},dn.useDeferredValue=function(se){return Me.current.useDeferredValue(se)},dn.useEffect=function(se,V){return Me.current.useEffect(se,V)},dn.useId=function(){return Me.current.useId()},dn.useImperativeHandle=function(se,V,Z){return Me.current.useImperativeHandle(se,V,Z)},dn.useInsertionEffect=function(se,V){return Me.current.useInsertionEffect(se,V)},dn.useLayoutEffect=function(se,V){return Me.current.useLayoutEffect(se,V)},dn.useMemo=function(se,V){return Me.current.useMemo(se,V)},dn.useReducer=function(se,V,Z){return Me.current.useReducer(se,V,Z)},dn.useRef=function(se){return Me.current.useRef(se)},dn.useState=function(se){return Me.current.useState(se)},dn.useSyncExternalStore=function(se,V,Z){return Me.current.useSyncExternalStore(se,V,Z)},dn.useTransition=function(){return Me.current.useTransition()},dn.version="18.3.1",dn}var H4;function my(){return H4||(H4=1,mT.exports=_U()),mT.exports}var K4;function vU(){if(K4)return am;K4=1;var n=my(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,i=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function a(o,l,c){var h,f={},m=null,y=null;c!==void 0&&(m=""+c),l.key!==void 0&&(m=""+l.key),l.ref!==void 0&&(y=l.ref);for(h in l)r.call(l,h)&&!s.hasOwnProperty(h)&&(f[h]=l[h]);if(o&&o.defaultProps)for(h in l=o.defaultProps,l)f[h]===void 0&&(f[h]=l[h]);return{$$typeof:e,type:o,key:m,ref:y,props:f,_owner:i.current}}return am.Fragment=t,am.jsx=a,am.jsxs=a,am}var X4;function wU(){return X4||(X4=1,gT.exports=vU()),gT.exports}var g=wU(),fx={},pT={exports:{}},Ms={},yT={exports:{}},xT={};var q4;function EU(){return q4||(q4=1,(function(n){function e(ce,Pe){var be=ce.length;ce.push(Pe);e:for(;0<be;){var se=be-1>>>1,V=ce[se];if(0<i(V,Pe))ce[se]=Pe,ce[be]=V,be=se;else break e}}function t(ce){return ce.length===0?null:ce[0]}function r(ce){if(ce.length===0)return null;var Pe=ce[0],be=ce.pop();if(be!==Pe){ce[0]=be;e:for(var se=0,V=ce.length,Z=V>>>1;se<Z;){var te=2*(se+1)-1,ie=ce[te],ue=te+1,Ve=ce[ue];if(0>i(ie,be))ue<V&&0>i(Ve,ie)?(ce[se]=Ve,ce[ue]=be,se=ue):(ce[se]=ie,ce[te]=be,se=te);else if(ue<V&&0>i(Ve,be))ce[se]=Ve,ce[ue]=be,se=ue;else break e}}return Pe}function i(ce,Pe){var be=ce.sortIndex-Pe.sortIndex;return be!==0?be:ce.id-Pe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();n.unstable_now=function(){return a.now()-o}}var l=[],c=[],h=1,f=null,m=3,y=!1,x=!1,_=!1,w=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function R(ce){for(var Pe=t(c);Pe!==null;){if(Pe.callback===null)r(c);else if(Pe.startTime<=ce)r(c),Pe.sortIndex=Pe.expirationTime,e(l,Pe);else break;Pe=t(c)}}function M(ce){if(_=!1,R(ce),!x)if(t(l)!==null)x=!0,Be(O);else{var Pe=t(c);Pe!==null&&Me(M,Pe.startTime-ce)}}function O(ce,Pe){x=!1,_&&(_=!1,S(I),I=-1),y=!0;var be=m;try{for(R(Pe),f=t(l);f!==null&&(!(f.expirationTime>Pe)||ce&&!L());){var se=f.callback;if(typeof se=="function"){f.callback=null,m=f.priorityLevel;var V=se(f.expirationTime<=Pe);Pe=n.unstable_now(),typeof V=="function"?f.callback=V:f===t(l)&&r(l),R(Pe)}else r(l);f=t(l)}if(f!==null)var Z=!0;else{var te=t(c);te!==null&&Me(M,te.startTime-Pe),Z=!1}return Z}finally{f=null,m=be,y=!1}}var G=!1,A=null,I=-1,P=5,D=-1;function L(){return!(n.unstable_now()-D<P)}function U(){if(A!==null){var ce=n.unstable_now();D=ce;var Pe=!0;try{Pe=A(!0,ce)}finally{Pe?j():(G=!1,A=null)}}else G=!1}var j;if(typeof b=="function")j=function(){b(U)};else if(typeof MessageChannel<"u"){var Ee=new MessageChannel,ke=Ee.port2;Ee.port1.onmessage=U,j=function(){ke.postMessage(null)}}else j=function(){w(U,0)};function Be(ce){A=ce,G||(G=!0,j())}function Me(ce,Pe){I=w(function(){ce(n.unstable_now())},Pe)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ce){ce.callback=null},n.unstable_continueExecution=function(){x||y||(x=!0,Be(O))},n.unstable_forceFrameRate=function(ce){0>ce||125<ce?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<ce?Math.floor(1e3/ce):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(ce){switch(m){case 1:case 2:case 3:var Pe=3;break;default:Pe=m}var be=m;m=Pe;try{return ce()}finally{m=be}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(ce,Pe){switch(ce){case 1:case 2:case 3:case 4:case 5:break;default:ce=3}var be=m;m=ce;try{return Pe()}finally{m=be}},n.unstable_scheduleCallback=function(ce,Pe,be){var se=n.unstable_now();switch(typeof be=="object"&&be!==null?(be=be.delay,be=typeof be=="number"&&0<be?se+be:se):be=se,ce){case 1:var V=-1;break;case 2:V=250;break;case 5:V=1073741823;break;case 4:V=1e4;break;default:V=5e3}return V=be+V,ce={id:h++,callback:Pe,priorityLevel:ce,startTime:be,expirationTime:V,sortIndex:-1},be>se?(ce.sortIndex=be,e(c,ce),t(l)===null&&ce===t(c)&&(_?(S(I),I=-1):_=!0,Me(M,be-se))):(ce.sortIndex=V,e(l,ce),x||y||(x=!0,Be(O))),ce},n.unstable_shouldYield=L,n.unstable_wrapCallback=function(ce){var Pe=m;return function(){var be=m;m=Pe;try{return ce.apply(this,arguments)}finally{m=be}}}})(xT)),xT}var Y4;function TU(){return Y4||(Y4=1,yT.exports=EU()),yT.exports}var Z4;function SU(){if(Z4)return Ms;Z4=1;var n=my(),e=TU();function t(u){for(var d="https://reactjs.org/docs/error-decoder.html?invariant="+u,p=1;p<arguments.length;p++)d+="&args[]="+encodeURIComponent(arguments[p]);return"Minified React error #"+u+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,i={};function s(u,d){a(u,d),a(u+"Capture",d)}function a(u,d){for(i[u]=d,u=0;u<d.length;u++)r.add(d[u])}var o=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),l=Object.prototype.hasOwnProperty,c=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},f={};function m(u){return l.call(f,u)?!0:l.call(h,u)?!1:c.test(u)?f[u]=!0:(h[u]=!0,!1)}function y(u,d,p,E){if(p!==null&&p.type===0)return!1;switch(typeof d){case"function":case"symbol":return!0;case"boolean":return E?!1:p!==null?!p.acceptsBooleans:(u=u.toLowerCase().slice(0,5),u!=="data-"&&u!=="aria-");default:return!1}}function x(u,d,p,E){if(d===null||typeof d>"u"||y(u,d,p,E))return!0;if(E)return!1;if(p!==null)switch(p.type){case 3:return!d;case 4:return d===!1;case 5:return isNaN(d);case 6:return isNaN(d)||1>d}return!1}function _(u,d,p,E,T,C,z){this.acceptsBooleans=d===2||d===3||d===4,this.attributeName=E,this.attributeNamespace=T,this.mustUseProperty=p,this.propertyName=u,this.type=d,this.sanitizeURL=C,this.removeEmptyString=z}var w={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(u){w[u]=new _(u,0,!1,u,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(u){var d=u[0];w[d]=new _(d,1,!1,u[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(u){w[u]=new _(u,2,!1,u.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(u){w[u]=new _(u,2,!1,u,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(u){w[u]=new _(u,3,!1,u.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(u){w[u]=new _(u,3,!0,u,null,!1,!1)}),["capture","download"].forEach(function(u){w[u]=new _(u,4,!1,u,null,!1,!1)}),["cols","rows","size","span"].forEach(function(u){w[u]=new _(u,6,!1,u,null,!1,!1)}),["rowSpan","start"].forEach(function(u){w[u]=new _(u,5,!1,u.toLowerCase(),null,!1,!1)});var S=/[\-:]([a-z])/g;function b(u){return u[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(u){var d=u.replace(S,b);w[d]=new _(d,1,!1,u,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(u){var d=u.replace(S,b);w[d]=new _(d,1,!1,u,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(u){var d=u.replace(S,b);w[d]=new _(d,1,!1,u,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(u){w[u]=new _(u,1,!1,u.toLowerCase(),null,!1,!1)}),w.xlinkHref=new _("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(u){w[u]=new _(u,1,!1,u.toLowerCase(),null,!0,!0)});function R(u,d,p,E){var T=w.hasOwnProperty(d)?w[d]:null;(T!==null?T.type!==0:E||!(2<d.length)||d[0]!=="o"&&d[0]!=="O"||d[1]!=="n"&&d[1]!=="N")&&(x(d,p,T,E)&&(p=null),E||T===null?m(d)&&(p===null?u.removeAttribute(d):u.setAttribute(d,""+p)):T.mustUseProperty?u[T.propertyName]=p===null?T.type===3?!1:"":p:(d=T.attributeName,E=T.attributeNamespace,p===null?u.removeAttribute(d):(T=T.type,p=T===3||T===4&&p===!0?"":""+p,E?u.setAttributeNS(E,d,p):u.setAttribute(d,p))))}var M=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,O=Symbol.for("react.element"),G=Symbol.for("react.portal"),A=Symbol.for("react.fragment"),I=Symbol.for("react.strict_mode"),P=Symbol.for("react.profiler"),D=Symbol.for("react.provider"),L=Symbol.for("react.context"),U=Symbol.for("react.forward_ref"),j=Symbol.for("react.suspense"),Ee=Symbol.for("react.suspense_list"),ke=Symbol.for("react.memo"),Be=Symbol.for("react.lazy"),Me=Symbol.for("react.offscreen"),ce=Symbol.iterator;function Pe(u){return u===null||typeof u!="object"?null:(u=ce&&u[ce]||u["@@iterator"],typeof u=="function"?u:null)}var be=Object.assign,se;function V(u){if(se===void 0)try{throw Error()}catch(p){var d=p.stack.trim().match(/\n( *(at )?)/);se=d&&d[1]||""}return`
`+se+u}var Z=!1;function te(u,d){if(!u||Z)return"";Z=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(d)if(d=function(){throw Error()},Object.defineProperty(d.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(d,[])}catch(Ae){var E=Ae}Reflect.construct(u,[],d)}else{try{d.call()}catch(Ae){E=Ae}u.call(d.prototype)}else{try{throw Error()}catch(Ae){E=Ae}u()}}catch(Ae){if(Ae&&E&&typeof Ae.stack=="string"){for(var T=Ae.stack.split(`
`),C=E.stack.split(`
`),z=T.length-1,ae=C.length-1;1<=z&&0<=ae&&T[z]!==C[ae];)ae--;for(;1<=z&&0<=ae;z--,ae--)if(T[z]!==C[ae]){if(z!==1||ae!==1)do if(z--,ae--,0>ae||T[z]!==C[ae]){var oe=`
`+T[z].replace(" at new "," at ");return u.displayName&&oe.includes("<anonymous>")&&(oe=oe.replace("<anonymous>",u.displayName)),oe}while(1<=z&&0<=ae);break}}}finally{Z=!1,Error.prepareStackTrace=p}return(u=u?u.displayName||u.name:"")?V(u):""}function ie(u){switch(u.tag){case 5:return V(u.type);case 16:return V("Lazy");case 13:return V("Suspense");case 19:return V("SuspenseList");case 0:case 2:case 15:return u=te(u.type,!1),u;case 11:return u=te(u.type.render,!1),u;case 1:return u=te(u.type,!0),u;default:return""}}function ue(u){if(u==null)return null;if(typeof u=="function")return u.displayName||u.name||null;if(typeof u=="string")return u;switch(u){case A:return"Fragment";case G:return"Portal";case P:return"Profiler";case I:return"StrictMode";case j:return"Suspense";case Ee:return"SuspenseList"}if(typeof u=="object")switch(u.$$typeof){case L:return(u.displayName||"Context")+".Consumer";case D:return(u._context.displayName||"Context")+".Provider";case U:var d=u.render;return u=u.displayName,u||(u=d.displayName||d.name||"",u=u!==""?"ForwardRef("+u+")":"ForwardRef"),u;case ke:return d=u.displayName||null,d!==null?d:ue(u.type)||"Memo";case Be:d=u._payload,u=u._init;try{return ue(u(d))}catch{}}return null}function Ve(u){var d=u.type;switch(u.tag){case 24:return"Cache";case 9:return(d.displayName||"Context")+".Consumer";case 10:return(d._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return u=d.render,u=u.displayName||u.name||"",d.displayName||(u!==""?"ForwardRef("+u+")":"ForwardRef");case 7:return"Fragment";case 5:return d;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ue(d);case 8:return d===I?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof d=="function")return d.displayName||d.name||null;if(typeof d=="string")return d}return null}function Ge(u){switch(typeof u){case"boolean":case"number":case"string":case"undefined":return u;case"object":return u;default:return""}}function ye(u){var d=u.type;return(u=u.nodeName)&&u.toLowerCase()==="input"&&(d==="checkbox"||d==="radio")}function pe(u){var d=ye(u)?"checked":"value",p=Object.getOwnPropertyDescriptor(u.constructor.prototype,d),E=""+u[d];if(!u.hasOwnProperty(d)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var T=p.get,C=p.set;return Object.defineProperty(u,d,{configurable:!0,get:function(){return T.call(this)},set:function(z){E=""+z,C.call(this,z)}}),Object.defineProperty(u,d,{enumerable:p.enumerable}),{getValue:function(){return E},setValue:function(z){E=""+z},stopTracking:function(){u._valueTracker=null,delete u[d]}}}}function Fe(u){u._valueTracker||(u._valueTracker=pe(u))}function wt(u){if(!u)return!1;var d=u._valueTracker;if(!d)return!0;var p=d.getValue(),E="";return u&&(E=ye(u)?u.checked?"true":"false":u.value),u=E,u!==p?(d.setValue(u),!0):!1}function jt(u){if(u=u||(typeof document<"u"?document:void 0),typeof u>"u")return null;try{return u.activeElement||u.body}catch{return u.body}}function Dt(u,d){var p=d.checked;return be({},d,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:p??u._wrapperState.initialChecked})}function Kt(u,d){var p=d.defaultValue==null?"":d.defaultValue,E=d.checked!=null?d.checked:d.defaultChecked;p=Ge(d.value!=null?d.value:p),u._wrapperState={initialChecked:E,initialValue:p,controlled:d.type==="checkbox"||d.type==="radio"?d.checked!=null:d.value!=null}}function Qt(u,d){d=d.checked,d!=null&&R(u,"checked",d,!1)}function ot(u,d){Qt(u,d);var p=Ge(d.value),E=d.type;if(p!=null)E==="number"?(p===0&&u.value===""||u.value!=p)&&(u.value=""+p):u.value!==""+p&&(u.value=""+p);else if(E==="submit"||E==="reset"){u.removeAttribute("value");return}d.hasOwnProperty("value")?hn(u,d.type,p):d.hasOwnProperty("defaultValue")&&hn(u,d.type,Ge(d.defaultValue)),d.checked==null&&d.defaultChecked!=null&&(u.defaultChecked=!!d.defaultChecked)}function tr(u,d,p){if(d.hasOwnProperty("value")||d.hasOwnProperty("defaultValue")){var E=d.type;if(!(E!=="submit"&&E!=="reset"||d.value!==void 0&&d.value!==null))return;d=""+u._wrapperState.initialValue,p||d===u.value||(u.value=d),u.defaultValue=d}p=u.name,p!==""&&(u.name=""),u.defaultChecked=!!u._wrapperState.initialChecked,p!==""&&(u.name=p)}function hn(u,d,p){(d!=="number"||jt(u.ownerDocument)!==u)&&(p==null?u.defaultValue=""+u._wrapperState.initialValue:u.defaultValue!==""+p&&(u.defaultValue=""+p))}var cn=Array.isArray;function sr(u,d,p,E){if(u=u.options,d){d={};for(var T=0;T<p.length;T++)d["$"+p[T]]=!0;for(p=0;p<u.length;p++)T=d.hasOwnProperty("$"+u[p].value),u[p].selected!==T&&(u[p].selected=T),T&&E&&(u[p].defaultSelected=!0)}else{for(p=""+Ge(p),d=null,T=0;T<u.length;T++){if(u[T].value===p){u[T].selected=!0,E&&(u[T].defaultSelected=!0);return}d!==null||u[T].disabled||(d=u[T])}d!==null&&(d.selected=!0)}}function Ni(u,d){if(d.dangerouslySetInnerHTML!=null)throw Error(t(91));return be({},d,{value:void 0,defaultValue:void 0,children:""+u._wrapperState.initialValue})}function Vn(u,d){var p=d.value;if(p==null){if(p=d.children,d=d.defaultValue,p!=null){if(d!=null)throw Error(t(92));if(cn(p)){if(1<p.length)throw Error(t(93));p=p[0]}d=p}d==null&&(d=""),p=d}u._wrapperState={initialValue:Ge(p)}}function Tr(u,d){var p=Ge(d.value),E=Ge(d.defaultValue);p!=null&&(p=""+p,p!==u.value&&(u.value=p),d.defaultValue==null&&u.defaultValue!==p&&(u.defaultValue=p)),E!=null&&(u.defaultValue=""+E)}function oi(u){var d=u.textContent;d===u._wrapperState.initialValue&&d!==""&&d!==null&&(u.value=d)}function _t(u){switch(u){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function pn(u,d){return u==null||u==="http://www.w3.org/1999/xhtml"?_t(d):u==="http://www.w3.org/2000/svg"&&d==="foreignObject"?"http://www.w3.org/1999/xhtml":u}var Rn,Tt=(function(u){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(d,p,E,T){MSApp.execUnsafeLocalFunction(function(){return u(d,p,E,T)})}:u})(function(u,d){if(u.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in u)u.innerHTML=d;else{for(Rn=Rn||document.createElement("div"),Rn.innerHTML="<svg>"+d.valueOf().toString()+"</svg>",d=Rn.firstChild;u.firstChild;)u.removeChild(u.firstChild);for(;d.firstChild;)u.appendChild(d.firstChild)}});function sn(u,d){if(d){var p=u.firstChild;if(p&&p===u.lastChild&&p.nodeType===3){p.nodeValue=d;return}}u.textContent=d}var Nt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qi=["Webkit","ms","Moz","O"];Object.keys(Nt).forEach(function(u){qi.forEach(function(d){d=d+u.charAt(0).toUpperCase()+u.substring(1),Nt[d]=Nt[u]})});function Nr(u,d,p){return d==null||typeof d=="boolean"||d===""?"":p||typeof d!="number"||d===0||Nt.hasOwnProperty(u)&&Nt[u]?(""+d).trim():d+"px"}function li(u,d){u=u.style;for(var p in d)if(d.hasOwnProperty(p)){var E=p.indexOf("--")===0,T=Nr(p,d[p],E);p==="float"&&(p="cssFloat"),E?u.setProperty(p,T):u[p]=T}}var nn=be({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Sr(u,d){if(d){if(nn[u]&&(d.children!=null||d.dangerouslySetInnerHTML!=null))throw Error(t(137,u));if(d.dangerouslySetInnerHTML!=null){if(d.children!=null)throw Error(t(60));if(typeof d.dangerouslySetInnerHTML!="object"||!("__html"in d.dangerouslySetInnerHTML))throw Error(t(61))}if(d.style!=null&&typeof d.style!="object")throw Error(t(62))}}function De(u,d){if(u.indexOf("-")===-1)return typeof d.is=="string";switch(u){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xe=null;function _e(u){return u=u.target||u.srcElement||window,u.correspondingUseElement&&(u=u.correspondingUseElement),u.nodeType===3?u.parentNode:u}var Ft=null,N=null,ut=null;function W(u){if(u=Wg(u)){if(typeof Ft!="function")throw Error(t(280));var d=u.stateNode;d&&(d=I1(d),Ft(u.stateNode,u.type,d))}}function re(u){N?ut?ut.push(u):ut=[u]:N=u}function ee(){if(N){var u=N,d=ut;if(ut=N=null,W(u),d)for(u=0;u<d.length;u++)W(d[u])}}function ne(u,d){return u(d)}function he(){}var Ce=!1;function je(u,d,p){if(Ce)return u(d,p);Ce=!0;try{return ne(u,d,p)}finally{Ce=!1,(N!==null||ut!==null)&&(he(),ee())}}function He(u,d){var p=u.stateNode;if(p===null)return null;var E=I1(p);if(E===null)return null;p=E[d];e:switch(d){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(E=!E.disabled)||(u=u.type,E=!(u==="button"||u==="input"||u==="select"||u==="textarea")),u=!E;break e;default:u=!1}if(u)return null;if(p&&typeof p!="function")throw Error(t(231,d,typeof p));return p}var Je=!1;if(o)try{var Qe={};Object.defineProperty(Qe,"passive",{get:function(){Je=!0}}),window.addEventListener("test",Qe,Qe),window.removeEventListener("test",Qe,Qe)}catch{Je=!1}function xt(u,d,p,E,T,C,z,ae,oe){var Ae=Array.prototype.slice.call(arguments,3);try{d.apply(p,Ae)}catch(Ke){this.onError(Ke)}}var St=!1,An=null,B=!1,Y=null,K={onError:function(u){St=!0,An=u}};function q(u,d,p,E,T,C,z,ae,oe){St=!1,An=null,xt.apply(K,arguments)}function J(u,d,p,E,T,C,z,ae,oe){if(q.apply(this,arguments),St){if(St){var Ae=An;St=!1,An=null}else throw Error(t(198));B||(B=!0,Y=Ae)}}function Q(u){var d=u,p=u;if(u.alternate)for(;d.return;)d=d.return;else{u=d;do d=u,(d.flags&4098)!==0&&(p=d.return),u=d.return;while(u)}return d.tag===3?p:null}function we(u){if(u.tag===13){var d=u.memoizedState;if(d===null&&(u=u.alternate,u!==null&&(d=u.memoizedState)),d!==null)return d.dehydrated}return null}function Le(u){if(Q(u)!==u)throw Error(t(188))}function ve(u){var d=u.alternate;if(!d){if(d=Q(u),d===null)throw Error(t(188));return d!==u?null:u}for(var p=u,E=d;;){var T=p.return;if(T===null)break;var C=T.alternate;if(C===null){if(E=T.return,E!==null){p=E;continue}break}if(T.child===C.child){for(C=T.child;C;){if(C===p)return Le(T),u;if(C===E)return Le(T),d;C=C.sibling}throw Error(t(188))}if(p.return!==E.return)p=T,E=C;else{for(var z=!1,ae=T.child;ae;){if(ae===p){z=!0,p=T,E=C;break}if(ae===E){z=!0,E=T,p=C;break}ae=ae.sibling}if(!z){for(ae=C.child;ae;){if(ae===p){z=!0,p=C,E=T;break}if(ae===E){z=!0,E=C,p=T;break}ae=ae.sibling}if(!z)throw Error(t(189))}}if(p.alternate!==E)throw Error(t(190))}if(p.tag!==3)throw Error(t(188));return p.stateNode.current===p?u:d}function Se(u){return u=ve(u),u!==null?Re(u):null}function Re(u){if(u.tag===5||u.tag===6)return u;for(u=u.child;u!==null;){var d=Re(u);if(d!==null)return d;u=u.sibling}return null}var Xe=e.unstable_scheduleCallback,rt=e.unstable_cancelCallback,pt=e.unstable_shouldYield,qe=e.unstable_requestPaint,Ye=e.unstable_now,Xt=e.unstable_getCurrentPriorityLevel,Gn=e.unstable_ImmediatePriority,Wn=e.unstable_UserBlockingPriority,pr=e.unstable_NormalPriority,Ya=e.unstable_LowPriority,_a=e.unstable_IdlePriority,Ys=null,Br=null;function Ec(u){if(Br&&typeof Br.onCommitFiberRoot=="function")try{Br.onCommitFiberRoot(Ys,u,void 0,(u.current.flags&128)===128)}catch{}}var br=Math.clz32?Math.clz32:Qu,Co=Math.log,va=Math.LN2;function Qu(u){return u>>>=0,u===0?32:31-(Co(u)/va|0)|0}var ko=64,Tc=4194304;function Nn(u){switch(u&-u){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return u&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return u}}function wl(u,d){var p=u.pendingLanes;if(p===0)return 0;var E=0,T=u.suspendedLanes,C=u.pingedLanes,z=p&268435455;if(z!==0){var ae=z&~T;ae!==0?E=Nn(ae):(C&=z,C!==0&&(E=Nn(C)))}else z=p&~T,z!==0?E=Nn(z):C!==0&&(E=Nn(C));if(E===0)return 0;if(d!==0&&d!==E&&(d&T)===0&&(T=E&-E,C=d&-d,T>=C||T===16&&(C&4194240)!==0))return d;if((E&4)!==0&&(E|=p&16),d=u.entangledLanes,d!==0)for(u=u.entanglements,d&=E;0<d;)p=31-br(d),T=1<<p,E|=u[p],d&=~T;return E}function eh(u,d){switch(u){case 1:case 2:case 4:return d+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function th(u,d){for(var p=u.suspendedLanes,E=u.pingedLanes,T=u.expirationTimes,C=u.pendingLanes;0<C;){var z=31-br(C),ae=1<<z,oe=T[z];oe===-1?((ae&p)===0||(ae&E)!==0)&&(T[z]=eh(ae,d)):oe<=d&&(u.expiredLanes|=ae),C&=~ae}}function Sg(u){return u=u.pendingLanes&-1073741825,u!==0?u:u&1073741824?1073741824:0}function bg(){var u=ko;return ko<<=1,(ko&4194240)===0&&(ko=64),u}function Rg(u){for(var d=[],p=0;31>p;p++)d.push(u);return d}function nh(u,d,p){u.pendingLanes|=d,d!==536870912&&(u.suspendedLanes=0,u.pingedLanes=0),u=u.eventTimes,d=31-br(d),u[d]=p}function HE(u,d){var p=u.pendingLanes&~d;u.pendingLanes=d,u.suspendedLanes=0,u.pingedLanes=0,u.expiredLanes&=d,u.mutableReadLanes&=d,u.entangledLanes&=d,d=u.entanglements;var E=u.eventTimes;for(u=u.expirationTimes;0<p;){var T=31-br(p),C=1<<T;d[T]=0,E[T]=-1,u[T]=-1,p&=~C}}function Ag(u,d){var p=u.entangledLanes|=d;for(u=u.entanglements;p;){var E=31-br(p),T=1<<E;T&d|u[E]&d&&(u[E]|=d),p&=~T}}var vn=0;function Po(u){return u&=-u,1<u?4<u?(u&268435455)!==0?16:536870912:4:1}var Ig,Ud,Cg,kg,Pg,Mo=!1,$d=[],No=null,Lo=null,Li=null,rh=new Map,El=new Map,Zs=[],d1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc(u,d){switch(u){case"focusin":case"focusout":No=null;break;case"dragenter":case"dragleave":Lo=null;break;case"mouseover":case"mouseout":Li=null;break;case"pointerover":case"pointerout":rh.delete(d.pointerId);break;case"gotpointercapture":case"lostpointercapture":El.delete(d.pointerId)}}function Za(u,d,p,E,T,C){return u===null||u.nativeEvent!==C?(u={blockedOn:d,domEventName:p,eventSystemFlags:E,nativeEvent:C,targetContainers:[T]},d!==null&&(d=Wg(d),d!==null&&Ud(d)),u):(u.eventSystemFlags|=E,d=u.targetContainers,T!==null&&d.indexOf(T)===-1&&d.push(T),u)}function f1(u,d,p,E,T){switch(d){case"focusin":return No=Za(No,u,d,p,E,T),!0;case"dragenter":return Lo=Za(Lo,u,d,p,E,T),!0;case"mouseover":return Li=Za(Li,u,d,p,E,T),!0;case"pointerover":var C=T.pointerId;return rh.set(C,Za(rh.get(C)||null,u,d,p,E,T)),!0;case"gotpointercapture":return C=T.pointerId,El.set(C,Za(El.get(C)||null,u,d,p,E,T)),!0}return!1}function Wd(u){var d=oh(u.target);if(d!==null){var p=Q(d);if(p!==null){if(d=p.tag,d===13){if(d=we(p),d!==null){u.blockedOn=d,Pg(u.priority,function(){Cg(p)});return}}else if(d===3&&p.stateNode.current.memoizedState.isDehydrated){u.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}u.blockedOn=null}function ar(u){if(u.blockedOn!==null)return!1;for(var d=u.targetContainers;0<d.length;){var p=Hd(u.domEventName,u.eventSystemFlags,d[0],u.nativeEvent);if(p===null){p=u.nativeEvent;var E=new p.constructor(p.type,p);xe=E,p.target.dispatchEvent(E),xe=null}else return d=Wg(p),d!==null&&Ud(d),u.blockedOn=p,!1;d.shift()}return!0}function g1(u,d,p){ar(u)&&p.delete(d)}function KE(){Mo=!1,No!==null&&ar(No)&&(No=null),Lo!==null&&ar(Lo)&&(Lo=null),Li!==null&&ar(Li)&&(Li=null),rh.forEach(g1),El.forEach(g1)}function bc(u,d){u.blockedOn===d&&(u.blockedOn=null,Mo||(Mo=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,KE)))}function Rc(u){function d(T){return bc(T,u)}if(0<$d.length){bc($d[0],u);for(var p=1;p<$d.length;p++){var E=$d[p];E.blockedOn===u&&(E.blockedOn=null)}}for(No!==null&&bc(No,u),Lo!==null&&bc(Lo,u),Li!==null&&bc(Li,u),rh.forEach(d),El.forEach(d),p=0;p<Zs.length;p++)E=Zs[p],E.blockedOn===u&&(E.blockedOn=null);for(;0<Zs.length&&(p=Zs[0],p.blockedOn===null);)Wd(p),p.blockedOn===null&&Zs.shift()}var Tl=M.ReactCurrentBatchConfig,Sl=!0;function Oo(u,d,p,E){var T=vn,C=Tl.transition;Tl.transition=null;try{vn=1,Mg(u,d,p,E)}finally{vn=T,Tl.transition=C}}function m1(u,d,p,E){var T=vn,C=Tl.transition;Tl.transition=null;try{vn=4,Mg(u,d,p,E)}finally{vn=T,Tl.transition=C}}function Mg(u,d,p,E){if(Sl){var T=Hd(u,d,p,E);if(T===null)i2(u,d,E,Do,p),Sc(u,E);else if(f1(T,u,d,p,E))E.stopPropagation();else if(Sc(u,E),d&4&&-1<d1.indexOf(u)){for(;T!==null;){var C=Wg(T);if(C!==null&&Ig(C),C=Hd(u,d,p,E),C===null&&i2(u,d,E,Do,p),C===T)break;T=C}T!==null&&E.stopPropagation()}else i2(u,d,E,null,p)}}var Do=null;function Hd(u,d,p,E){if(Do=null,u=_e(E),u=oh(u),u!==null)if(d=Q(u),d===null)u=null;else if(p=d.tag,p===13){if(u=we(d),u!==null)return u;u=null}else if(p===3){if(d.stateNode.current.memoizedState.isDehydrated)return d.tag===3?d.stateNode.containerInfo:null;u=null}else d!==u&&(u=null);return Do=u,null}function Kd(u){switch(u){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xt()){case Gn:return 1;case Wn:return 4;case pr:case Ya:return 16;case _a:return 536870912;default:return 16}default:return 16}}var Js=null,Xd=null,bl=null;function p1(){if(bl)return bl;var u,d=Xd,p=d.length,E,T="value"in Js?Js.value:Js.textContent,C=T.length;for(u=0;u<p&&d[u]===T[u];u++);var z=p-u;for(E=1;E<=z&&d[p-E]===T[C-E];E++);return bl=T.slice(u,1<E?1-E:void 0)}function ih(u){var d=u.keyCode;return"charCode"in u?(u=u.charCode,u===0&&d===13&&(u=13)):u=d,u===10&&(u=13),32<=u||u===13?u:0}function Fo(){return!0}function Ng(){return!1}function Yi(u){function d(p,E,T,C,z){this._reactName=p,this._targetInst=T,this.type=E,this.nativeEvent=C,this.target=z,this.currentTarget=null;for(var ae in u)u.hasOwnProperty(ae)&&(p=u[ae],this[ae]=p?p(C):C[ae]);return this.isDefaultPrevented=(C.defaultPrevented!=null?C.defaultPrevented:C.returnValue===!1)?Fo:Ng,this.isPropagationStopped=Ng,this}return be(d.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=Fo)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=Fo)},persist:function(){},isPersistent:Fo}),d}var jo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(u){return u.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},sh=Yi(jo),Ac=be({},jo,{view:0,detail:0}),qd=Yi(Ac),Yd,Zd,Qs,ah=be({},Ac,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:rn,button:0,buttons:0,relatedTarget:function(u){return u.relatedTarget===void 0?u.fromElement===u.srcElement?u.toElement:u.fromElement:u.relatedTarget},movementX:function(u){return"movementX"in u?u.movementX:(u!==Qs&&(Qs&&u.type==="mousemove"?(Yd=u.screenX-Qs.screenX,Zd=u.screenY-Qs.screenY):Zd=Yd=0,Qs=u),Yd)},movementY:function(u){return"movementY"in u?u.movementY:Zd}}),Lg=Yi(ah),y1=be({},ah,{dataTransfer:0}),x1=Yi(y1),Jd=be({},Ac,{relatedTarget:0}),Oi=Yi(Jd),_1=be({},jo,{animationName:0,elapsedTime:0,pseudoElement:0}),v1=Yi(_1),Ic=be({},jo,{clipboardData:function(u){return"clipboardData"in u?u.clipboardData:window.clipboardData}}),v=Yi(Ic),k=be({},jo,{data:0}),F=Yi(k),H={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ge={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ie={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function lt(u){var d=this.nativeEvent;return d.getModifierState?d.getModifierState(u):(u=Ie[u])?!!d[u]:!1}function rn(){return lt}var zr=be({},Ac,{key:function(u){if(u.key){var d=H[u.key]||u.key;if(d!=="Unidentified")return d}return u.type==="keypress"?(u=ih(u),u===13?"Enter":String.fromCharCode(u)):u.type==="keydown"||u.type==="keyup"?ge[u.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:rn,charCode:function(u){return u.type==="keypress"?ih(u):0},keyCode:function(u){return u.type==="keydown"||u.type==="keyup"?u.keyCode:0},which:function(u){return u.type==="keypress"?ih(u):u.type==="keydown"||u.type==="keyup"?u.keyCode:0}}),Hn=Yi(zr),Xr=be({},ah,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ea=Yi(Xr),Rl=be({},Ac,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:rn}),Vo=Yi(Rl),Go=be({},jo,{propertyName:0,elapsedTime:0,pseudoElement:0}),Qd=Yi(Go),Og=be({},ah,{deltaX:function(u){return"deltaX"in u?u.deltaX:"wheelDeltaX"in u?-u.wheelDeltaX:0},deltaY:function(u){return"deltaY"in u?u.deltaY:"wheelDeltaY"in u?-u.wheelDeltaY:"wheelDelta"in u?-u.wheelDelta:0},deltaZ:0,deltaMode:0}),fz=Yi(Og),gz=[9,13,27,32],XE=o&&"CompositionEvent"in window,Dg=null;o&&"documentMode"in document&&(Dg=document.documentMode);var mz=o&&"TextEvent"in window&&!Dg,Fk=o&&(!XE||Dg&&8<Dg&&11>=Dg),jk=" ",Vk=!1;function Gk(u,d){switch(u){case"keyup":return gz.indexOf(d.keyCode)!==-1;case"keydown":return d.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bk(u){return u=u.detail,typeof u=="object"&&"data"in u?u.data:null}var ef=!1;function pz(u,d){switch(u){case"compositionend":return Bk(d);case"keypress":return d.which!==32?null:(Vk=!0,jk);case"textInput":return u=d.data,u===jk&&Vk?null:u;default:return null}}function yz(u,d){if(ef)return u==="compositionend"||!XE&&Gk(u,d)?(u=p1(),bl=Xd=Js=null,ef=!1,u):null;switch(u){case"paste":return null;case"keypress":if(!(d.ctrlKey||d.altKey||d.metaKey)||d.ctrlKey&&d.altKey){if(d.char&&1<d.char.length)return d.char;if(d.which)return String.fromCharCode(d.which)}return null;case"compositionend":return Fk&&d.locale!=="ko"?null:d.data;default:return null}}var xz={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function zk(u){var d=u&&u.nodeName&&u.nodeName.toLowerCase();return d==="input"?!!xz[u.type]:d==="textarea"}function Uk(u,d,p,E){re(E),d=b1(d,"onChange"),0<d.length&&(p=new sh("onChange","change",null,p,E),u.push({event:p,listeners:d}))}var Fg=null,jg=null;function _z(u){oP(u,0)}function w1(u){var d=af(u);if(wt(d))return u}function vz(u,d){if(u==="change")return d}var $k=!1;if(o){var qE;if(o){var YE="oninput"in document;if(!YE){var Wk=document.createElement("div");Wk.setAttribute("oninput","return;"),YE=typeof Wk.oninput=="function"}qE=YE}else qE=!1;$k=qE&&(!document.documentMode||9<document.documentMode)}function Hk(){Fg&&(Fg.detachEvent("onpropertychange",Kk),jg=Fg=null)}function Kk(u){if(u.propertyName==="value"&&w1(jg)){var d=[];Uk(d,jg,u,_e(u)),je(_z,d)}}function wz(u,d,p){u==="focusin"?(Hk(),Fg=d,jg=p,Fg.attachEvent("onpropertychange",Kk)):u==="focusout"&&Hk()}function Ez(u){if(u==="selectionchange"||u==="keyup"||u==="keydown")return w1(jg)}function Tz(u,d){if(u==="click")return w1(d)}function Sz(u,d){if(u==="input"||u==="change")return w1(d)}function bz(u,d){return u===d&&(u!==0||1/u===1/d)||u!==u&&d!==d}var Ja=typeof Object.is=="function"?Object.is:bz;function Vg(u,d){if(Ja(u,d))return!0;if(typeof u!="object"||u===null||typeof d!="object"||d===null)return!1;var p=Object.keys(u),E=Object.keys(d);if(p.length!==E.length)return!1;for(E=0;E<p.length;E++){var T=p[E];if(!l.call(d,T)||!Ja(u[T],d[T]))return!1}return!0}function Xk(u){for(;u&&u.firstChild;)u=u.firstChild;return u}function qk(u,d){var p=Xk(u);u=0;for(var E;p;){if(p.nodeType===3){if(E=u+p.textContent.length,u<=d&&E>=d)return{node:p,offset:d-u};u=E}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=Xk(p)}}function Yk(u,d){return u&&d?u===d?!0:u&&u.nodeType===3?!1:d&&d.nodeType===3?Yk(u,d.parentNode):"contains"in u?u.contains(d):u.compareDocumentPosition?!!(u.compareDocumentPosition(d)&16):!1:!1}function Zk(){for(var u=window,d=jt();d instanceof u.HTMLIFrameElement;){try{var p=typeof d.contentWindow.location.href=="string"}catch{p=!1}if(p)u=d.contentWindow;else break;d=jt(u.document)}return d}function ZE(u){var d=u&&u.nodeName&&u.nodeName.toLowerCase();return d&&(d==="input"&&(u.type==="text"||u.type==="search"||u.type==="tel"||u.type==="url"||u.type==="password")||d==="textarea"||u.contentEditable==="true")}function Rz(u){var d=Zk(),p=u.focusedElem,E=u.selectionRange;if(d!==p&&p&&p.ownerDocument&&Yk(p.ownerDocument.documentElement,p)){if(E!==null&&ZE(p)){if(d=E.start,u=E.end,u===void 0&&(u=d),"selectionStart"in p)p.selectionStart=d,p.selectionEnd=Math.min(u,p.value.length);else if(u=(d=p.ownerDocument||document)&&d.defaultView||window,u.getSelection){u=u.getSelection();var T=p.textContent.length,C=Math.min(E.start,T);E=E.end===void 0?C:Math.min(E.end,T),!u.extend&&C>E&&(T=E,E=C,C=T),T=qk(p,C);var z=qk(p,E);T&&z&&(u.rangeCount!==1||u.anchorNode!==T.node||u.anchorOffset!==T.offset||u.focusNode!==z.node||u.focusOffset!==z.offset)&&(d=d.createRange(),d.setStart(T.node,T.offset),u.removeAllRanges(),C>E?(u.addRange(d),u.extend(z.node,z.offset)):(d.setEnd(z.node,z.offset),u.addRange(d)))}}for(d=[],u=p;u=u.parentNode;)u.nodeType===1&&d.push({element:u,left:u.scrollLeft,top:u.scrollTop});for(typeof p.focus=="function"&&p.focus(),p=0;p<d.length;p++)u=d[p],u.element.scrollLeft=u.left,u.element.scrollTop=u.top}}var Az=o&&"documentMode"in document&&11>=document.documentMode,tf=null,JE=null,Gg=null,QE=!1;function Jk(u,d,p){var E=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;QE||tf==null||tf!==jt(E)||(E=tf,"selectionStart"in E&&ZE(E)?E={start:E.selectionStart,end:E.selectionEnd}:(E=(E.ownerDocument&&E.ownerDocument.defaultView||window).getSelection(),E={anchorNode:E.anchorNode,anchorOffset:E.anchorOffset,focusNode:E.focusNode,focusOffset:E.focusOffset}),Gg&&Vg(Gg,E)||(Gg=E,E=b1(JE,"onSelect"),0<E.length&&(d=new sh("onSelect","select",null,d,p),u.push({event:d,listeners:E}),d.target=tf)))}function E1(u,d){var p={};return p[u.toLowerCase()]=d.toLowerCase(),p["Webkit"+u]="webkit"+d,p["Moz"+u]="moz"+d,p}var nf={animationend:E1("Animation","AnimationEnd"),animationiteration:E1("Animation","AnimationIteration"),animationstart:E1("Animation","AnimationStart"),transitionend:E1("Transition","TransitionEnd")},e2={},Qk={};o&&(Qk=document.createElement("div").style,"AnimationEvent"in window||(delete nf.animationend.animation,delete nf.animationiteration.animation,delete nf.animationstart.animation),"TransitionEvent"in window||delete nf.transitionend.transition);function T1(u){if(e2[u])return e2[u];if(!nf[u])return u;var d=nf[u],p;for(p in d)if(d.hasOwnProperty(p)&&p in Qk)return e2[u]=d[p];return u}var eP=T1("animationend"),tP=T1("animationiteration"),nP=T1("animationstart"),rP=T1("transitionend"),iP=new Map,sP="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Cc(u,d){iP.set(u,d),s(d,[u])}for(var t2=0;t2<sP.length;t2++){var n2=sP[t2],Iz=n2.toLowerCase(),Cz=n2[0].toUpperCase()+n2.slice(1);Cc(Iz,"on"+Cz)}Cc(eP,"onAnimationEnd"),Cc(tP,"onAnimationIteration"),Cc(nP,"onAnimationStart"),Cc("dblclick","onDoubleClick"),Cc("focusin","onFocus"),Cc("focusout","onBlur"),Cc(rP,"onTransitionEnd"),a("onMouseEnter",["mouseout","mouseover"]),a("onMouseLeave",["mouseout","mouseover"]),a("onPointerEnter",["pointerout","pointerover"]),a("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Bg="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),kz=new Set("cancel close invalid load scroll toggle".split(" ").concat(Bg));function aP(u,d,p){var E=u.type||"unknown-event";u.currentTarget=p,J(E,d,void 0,u),u.currentTarget=null}function oP(u,d){d=(d&4)!==0;for(var p=0;p<u.length;p++){var E=u[p],T=E.event;E=E.listeners;e:{var C=void 0;if(d)for(var z=E.length-1;0<=z;z--){var ae=E[z],oe=ae.instance,Ae=ae.currentTarget;if(ae=ae.listener,oe!==C&&T.isPropagationStopped())break e;aP(T,ae,Ae),C=oe}else for(z=0;z<E.length;z++){if(ae=E[z],oe=ae.instance,Ae=ae.currentTarget,ae=ae.listener,oe!==C&&T.isPropagationStopped())break e;aP(T,ae,Ae),C=oe}}}if(B)throw u=Y,B=!1,Y=null,u}function hr(u,d){var p=d[u2];p===void 0&&(p=d[u2]=new Set);var E=u+"__bubble";p.has(E)||(lP(d,u,2,!1),p.add(E))}function r2(u,d,p){var E=0;d&&(E|=4),lP(p,u,E,d)}var S1="_reactListening"+Math.random().toString(36).slice(2);function zg(u){if(!u[S1]){u[S1]=!0,r.forEach(function(p){p!=="selectionchange"&&(kz.has(p)||r2(p,!1,u),r2(p,!0,u))});var d=u.nodeType===9?u:u.ownerDocument;d===null||d[S1]||(d[S1]=!0,r2("selectionchange",!1,d))}}function lP(u,d,p,E){switch(Kd(d)){case 1:var T=Oo;break;case 4:T=m1;break;default:T=Mg}p=T.bind(null,d,p,u),T=void 0,!Je||d!=="touchstart"&&d!=="touchmove"&&d!=="wheel"||(T=!0),E?T!==void 0?u.addEventListener(d,p,{capture:!0,passive:T}):u.addEventListener(d,p,!0):T!==void 0?u.addEventListener(d,p,{passive:T}):u.addEventListener(d,p,!1)}function i2(u,d,p,E,T){var C=E;if((d&1)===0&&(d&2)===0&&E!==null)e:for(;;){if(E===null)return;var z=E.tag;if(z===3||z===4){var ae=E.stateNode.containerInfo;if(ae===T||ae.nodeType===8&&ae.parentNode===T)break;if(z===4)for(z=E.return;z!==null;){var oe=z.tag;if((oe===3||oe===4)&&(oe=z.stateNode.containerInfo,oe===T||oe.nodeType===8&&oe.parentNode===T))return;z=z.return}for(;ae!==null;){if(z=oh(ae),z===null)return;if(oe=z.tag,oe===5||oe===6){E=C=z;continue e}ae=ae.parentNode}}E=E.return}je(function(){var Ae=C,Ke=_e(p),Ze=[];e:{var $e=iP.get(u);if($e!==void 0){var vt=sh,At=u;switch(u){case"keypress":if(ih(p)===0)break e;case"keydown":case"keyup":vt=Hn;break;case"focusin":At="focus",vt=Oi;break;case"focusout":At="blur",vt=Oi;break;case"beforeblur":case"afterblur":vt=Oi;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":vt=Lg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":vt=x1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":vt=Vo;break;case eP:case tP:case nP:vt=v1;break;case rP:vt=Qd;break;case"scroll":vt=qd;break;case"wheel":vt=fz;break;case"copy":case"cut":case"paste":vt=v;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":vt=ea}var kt=(d&4)!==0,Ur=!kt&&u==="scroll",fe=kt?$e!==null?$e+"Capture":null:$e;kt=[];for(var le=Ae,Te;le!==null;){Te=le;var nt=Te.stateNode;if(Te.tag===5&&nt!==null&&(Te=nt,fe!==null&&(nt=He(le,fe),nt!=null&&kt.push(Ug(le,nt,Te)))),Ur)break;le=le.return}0<kt.length&&($e=new vt($e,At,null,p,Ke),Ze.push({event:$e,listeners:kt}))}}if((d&7)===0){e:{if($e=u==="mouseover"||u==="pointerover",vt=u==="mouseout"||u==="pointerout",$e&&p!==xe&&(At=p.relatedTarget||p.fromElement)&&(oh(At)||At[Al]))break e;if((vt||$e)&&($e=Ke.window===Ke?Ke:($e=Ke.ownerDocument)?$e.defaultView||$e.parentWindow:window,vt?(At=p.relatedTarget||p.toElement,vt=Ae,At=At?oh(At):null,At!==null&&(Ur=Q(At),At!==Ur||At.tag!==5&&At.tag!==6)&&(At=null)):(vt=null,At=Ae),vt!==At)){if(kt=Lg,nt="onMouseLeave",fe="onMouseEnter",le="mouse",(u==="pointerout"||u==="pointerover")&&(kt=ea,nt="onPointerLeave",fe="onPointerEnter",le="pointer"),Ur=vt==null?$e:af(vt),Te=At==null?$e:af(At),$e=new kt(nt,le+"leave",vt,p,Ke),$e.target=Ur,$e.relatedTarget=Te,nt=null,oh(Ke)===Ae&&(kt=new kt(fe,le+"enter",At,p,Ke),kt.target=Te,kt.relatedTarget=Ur,nt=kt),Ur=nt,vt&&At)t:{for(kt=vt,fe=At,le=0,Te=kt;Te;Te=rf(Te))le++;for(Te=0,nt=fe;nt;nt=rf(nt))Te++;for(;0<le-Te;)kt=rf(kt),le--;for(;0<Te-le;)fe=rf(fe),Te--;for(;le--;){if(kt===fe||fe!==null&&kt===fe.alternate)break t;kt=rf(kt),fe=rf(fe)}kt=null}else kt=null;vt!==null&&cP(Ze,$e,vt,kt,!1),At!==null&&Ur!==null&&cP(Ze,Ur,At,kt,!0)}}e:{if($e=Ae?af(Ae):window,vt=$e.nodeName&&$e.nodeName.toLowerCase(),vt==="select"||vt==="input"&&$e.type==="file")var Mt=vz;else if(zk($e))if($k)Mt=Sz;else{Mt=Ez;var zt=wz}else(vt=$e.nodeName)&&vt.toLowerCase()==="input"&&($e.type==="checkbox"||$e.type==="radio")&&(Mt=Tz);if(Mt&&(Mt=Mt(u,Ae))){Uk(Ze,Mt,p,Ke);break e}zt&&zt(u,$e,Ae),u==="focusout"&&(zt=$e._wrapperState)&&zt.controlled&&$e.type==="number"&&hn($e,"number",$e.value)}switch(zt=Ae?af(Ae):window,u){case"focusin":(zk(zt)||zt.contentEditable==="true")&&(tf=zt,JE=Ae,Gg=null);break;case"focusout":Gg=JE=tf=null;break;case"mousedown":QE=!0;break;case"contextmenu":case"mouseup":case"dragend":QE=!1,Jk(Ze,p,Ke);break;case"selectionchange":if(Az)break;case"keydown":case"keyup":Jk(Ze,p,Ke)}var Ut;if(XE)e:{switch(u){case"compositionstart":var qt="onCompositionStart";break e;case"compositionend":qt="onCompositionEnd";break e;case"compositionupdate":qt="onCompositionUpdate";break e}qt=void 0}else ef?Gk(u,p)&&(qt="onCompositionEnd"):u==="keydown"&&p.keyCode===229&&(qt="onCompositionStart");qt&&(Fk&&p.locale!=="ko"&&(ef||qt!=="onCompositionStart"?qt==="onCompositionEnd"&&ef&&(Ut=p1()):(Js=Ke,Xd="value"in Js?Js.value:Js.textContent,ef=!0)),zt=b1(Ae,qt),0<zt.length&&(qt=new F(qt,u,null,p,Ke),Ze.push({event:qt,listeners:zt}),Ut?qt.data=Ut:(Ut=Bk(p),Ut!==null&&(qt.data=Ut)))),(Ut=mz?pz(u,p):yz(u,p))&&(Ae=b1(Ae,"onBeforeInput"),0<Ae.length&&(Ke=new F("onBeforeInput","beforeinput",null,p,Ke),Ze.push({event:Ke,listeners:Ae}),Ke.data=Ut))}oP(Ze,d)})}function Ug(u,d,p){return{instance:u,listener:d,currentTarget:p}}function b1(u,d){for(var p=d+"Capture",E=[];u!==null;){var T=u,C=T.stateNode;T.tag===5&&C!==null&&(T=C,C=He(u,p),C!=null&&E.unshift(Ug(u,C,T)),C=He(u,d),C!=null&&E.push(Ug(u,C,T))),u=u.return}return E}function rf(u){if(u===null)return null;do u=u.return;while(u&&u.tag!==5);return u||null}function cP(u,d,p,E,T){for(var C=d._reactName,z=[];p!==null&&p!==E;){var ae=p,oe=ae.alternate,Ae=ae.stateNode;if(oe!==null&&oe===E)break;ae.tag===5&&Ae!==null&&(ae=Ae,T?(oe=He(p,C),oe!=null&&z.unshift(Ug(p,oe,ae))):T||(oe=He(p,C),oe!=null&&z.push(Ug(p,oe,ae)))),p=p.return}z.length!==0&&u.push({event:d,listeners:z})}var Pz=/\r\n?/g,Mz=/\u0000|\uFFFD/g;function uP(u){return(typeof u=="string"?u:""+u).replace(Pz,`
`).replace(Mz,"")}function R1(u,d,p){if(d=uP(d),uP(u)!==d&&p)throw Error(t(425))}function A1(){}var s2=null,a2=null;function o2(u,d){return u==="textarea"||u==="noscript"||typeof d.children=="string"||typeof d.children=="number"||typeof d.dangerouslySetInnerHTML=="object"&&d.dangerouslySetInnerHTML!==null&&d.dangerouslySetInnerHTML.__html!=null}var l2=typeof setTimeout=="function"?setTimeout:void 0,Nz=typeof clearTimeout=="function"?clearTimeout:void 0,hP=typeof Promise=="function"?Promise:void 0,Lz=typeof queueMicrotask=="function"?queueMicrotask:typeof hP<"u"?function(u){return hP.resolve(null).then(u).catch(Oz)}:l2;function Oz(u){setTimeout(function(){throw u})}function c2(u,d){var p=d,E=0;do{var T=p.nextSibling;if(u.removeChild(p),T&&T.nodeType===8)if(p=T.data,p==="/$"){if(E===0){u.removeChild(T),Rc(d);return}E--}else p!=="$"&&p!=="$?"&&p!=="$!"||E++;p=T}while(p);Rc(d)}function kc(u){for(;u!=null;u=u.nextSibling){var d=u.nodeType;if(d===1||d===3)break;if(d===8){if(d=u.data,d==="$"||d==="$!"||d==="$?")break;if(d==="/$")return null}}return u}function dP(u){u=u.previousSibling;for(var d=0;u;){if(u.nodeType===8){var p=u.data;if(p==="$"||p==="$!"||p==="$?"){if(d===0)return u;d--}else p==="/$"&&d++}u=u.previousSibling}return null}var sf=Math.random().toString(36).slice(2),Bo="__reactFiber$"+sf,$g="__reactProps$"+sf,Al="__reactContainer$"+sf,u2="__reactEvents$"+sf,Dz="__reactListeners$"+sf,Fz="__reactHandles$"+sf;function oh(u){var d=u[Bo];if(d)return d;for(var p=u.parentNode;p;){if(d=p[Al]||p[Bo]){if(p=d.alternate,d.child!==null||p!==null&&p.child!==null)for(u=dP(u);u!==null;){if(p=u[Bo])return p;u=dP(u)}return d}u=p,p=u.parentNode}return null}function Wg(u){return u=u[Bo]||u[Al],!u||u.tag!==5&&u.tag!==6&&u.tag!==13&&u.tag!==3?null:u}function af(u){if(u.tag===5||u.tag===6)return u.stateNode;throw Error(t(33))}function I1(u){return u[$g]||null}var h2=[],of=-1;function Pc(u){return{current:u}}function dr(u){0>of||(u.current=h2[of],h2[of]=null,of--)}function cr(u,d){of++,h2[of]=u.current,u.current=d}var Mc={},Zi=Pc(Mc),As=Pc(!1),lh=Mc;function lf(u,d){var p=u.type.contextTypes;if(!p)return Mc;var E=u.stateNode;if(E&&E.__reactInternalMemoizedUnmaskedChildContext===d)return E.__reactInternalMemoizedMaskedChildContext;var T={},C;for(C in p)T[C]=d[C];return E&&(u=u.stateNode,u.__reactInternalMemoizedUnmaskedChildContext=d,u.__reactInternalMemoizedMaskedChildContext=T),T}function Is(u){return u=u.childContextTypes,u!=null}function C1(){dr(As),dr(Zi)}function fP(u,d,p){if(Zi.current!==Mc)throw Error(t(168));cr(Zi,d),cr(As,p)}function gP(u,d,p){var E=u.stateNode;if(d=d.childContextTypes,typeof E.getChildContext!="function")return p;E=E.getChildContext();for(var T in E)if(!(T in d))throw Error(t(108,Ve(u)||"Unknown",T));return be({},p,E)}function k1(u){return u=(u=u.stateNode)&&u.__reactInternalMemoizedMergedChildContext||Mc,lh=Zi.current,cr(Zi,u),cr(As,As.current),!0}function mP(u,d,p){var E=u.stateNode;if(!E)throw Error(t(169));p?(u=gP(u,d,lh),E.__reactInternalMemoizedMergedChildContext=u,dr(As),dr(Zi),cr(Zi,u)):dr(As),cr(As,p)}var Il=null,P1=!1,d2=!1;function pP(u){Il===null?Il=[u]:Il.push(u)}function jz(u){P1=!0,pP(u)}function Nc(){if(!d2&&Il!==null){d2=!0;var u=0,d=vn;try{var p=Il;for(vn=1;u<p.length;u++){var E=p[u];do E=E(!0);while(E!==null)}Il=null,P1=!1}catch(T){throw Il!==null&&(Il=Il.slice(u+1)),Xe(Gn,Nc),T}finally{vn=d,d2=!1}}return null}var cf=[],uf=0,M1=null,N1=0,wa=[],Ea=0,ch=null,Cl=1,kl="";function uh(u,d){cf[uf++]=N1,cf[uf++]=M1,M1=u,N1=d}function yP(u,d,p){wa[Ea++]=Cl,wa[Ea++]=kl,wa[Ea++]=ch,ch=u;var E=Cl;u=kl;var T=32-br(E)-1;E&=~(1<<T),p+=1;var C=32-br(d)+T;if(30<C){var z=T-T%5;C=(E&(1<<z)-1).toString(32),E>>=z,T-=z,Cl=1<<32-br(d)+T|p<<T|E,kl=C+u}else Cl=1<<C|p<<T|E,kl=u}function f2(u){u.return!==null&&(uh(u,1),yP(u,1,0))}function g2(u){for(;u===M1;)M1=cf[--uf],cf[uf]=null,N1=cf[--uf],cf[uf]=null;for(;u===ch;)ch=wa[--Ea],wa[Ea]=null,kl=wa[--Ea],wa[Ea]=null,Cl=wa[--Ea],wa[Ea]=null}var ta=null,na=null,yr=!1,Qa=null;function xP(u,d){var p=Ra(5,null,null,0);p.elementType="DELETED",p.stateNode=d,p.return=u,d=u.deletions,d===null?(u.deletions=[p],u.flags|=16):d.push(p)}function _P(u,d){switch(u.tag){case 5:var p=u.type;return d=d.nodeType!==1||p.toLowerCase()!==d.nodeName.toLowerCase()?null:d,d!==null?(u.stateNode=d,ta=u,na=kc(d.firstChild),!0):!1;case 6:return d=u.pendingProps===""||d.nodeType!==3?null:d,d!==null?(u.stateNode=d,ta=u,na=null,!0):!1;case 13:return d=d.nodeType!==8?null:d,d!==null?(p=ch!==null?{id:Cl,overflow:kl}:null,u.memoizedState={dehydrated:d,treeContext:p,retryLane:1073741824},p=Ra(18,null,null,0),p.stateNode=d,p.return=u,u.child=p,ta=u,na=null,!0):!1;default:return!1}}function m2(u){return(u.mode&1)!==0&&(u.flags&128)===0}function p2(u){if(yr){var d=na;if(d){var p=d;if(!_P(u,d)){if(m2(u))throw Error(t(418));d=kc(p.nextSibling);var E=ta;d&&_P(u,d)?xP(E,p):(u.flags=u.flags&-4097|2,yr=!1,ta=u)}}else{if(m2(u))throw Error(t(418));u.flags=u.flags&-4097|2,yr=!1,ta=u}}}function vP(u){for(u=u.return;u!==null&&u.tag!==5&&u.tag!==3&&u.tag!==13;)u=u.return;ta=u}function L1(u){if(u!==ta)return!1;if(!yr)return vP(u),yr=!0,!1;var d;if((d=u.tag!==3)&&!(d=u.tag!==5)&&(d=u.type,d=d!=="head"&&d!=="body"&&!o2(u.type,u.memoizedProps)),d&&(d=na)){if(m2(u))throw wP(),Error(t(418));for(;d;)xP(u,d),d=kc(d.nextSibling)}if(vP(u),u.tag===13){if(u=u.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(t(317));e:{for(u=u.nextSibling,d=0;u;){if(u.nodeType===8){var p=u.data;if(p==="/$"){if(d===0){na=kc(u.nextSibling);break e}d--}else p!=="$"&&p!=="$!"&&p!=="$?"||d++}u=u.nextSibling}na=null}}else na=ta?kc(u.stateNode.nextSibling):null;return!0}function wP(){for(var u=na;u;)u=kc(u.nextSibling)}function hf(){na=ta=null,yr=!1}function y2(u){Qa===null?Qa=[u]:Qa.push(u)}var Vz=M.ReactCurrentBatchConfig;function Hg(u,d,p){if(u=p.ref,u!==null&&typeof u!="function"&&typeof u!="object"){if(p._owner){if(p=p._owner,p){if(p.tag!==1)throw Error(t(309));var E=p.stateNode}if(!E)throw Error(t(147,u));var T=E,C=""+u;return d!==null&&d.ref!==null&&typeof d.ref=="function"&&d.ref._stringRef===C?d.ref:(d=function(z){var ae=T.refs;z===null?delete ae[C]:ae[C]=z},d._stringRef=C,d)}if(typeof u!="string")throw Error(t(284));if(!p._owner)throw Error(t(290,u))}return u}function O1(u,d){throw u=Object.prototype.toString.call(d),Error(t(31,u==="[object Object]"?"object with keys {"+Object.keys(d).join(", ")+"}":u))}function EP(u){var d=u._init;return d(u._payload)}function TP(u){function d(fe,le){if(u){var Te=fe.deletions;Te===null?(fe.deletions=[le],fe.flags|=16):Te.push(le)}}function p(fe,le){if(!u)return null;for(;le!==null;)d(fe,le),le=le.sibling;return null}function E(fe,le){for(fe=new Map;le!==null;)le.key!==null?fe.set(le.key,le):fe.set(le.index,le),le=le.sibling;return fe}function T(fe,le){return fe=Bc(fe,le),fe.index=0,fe.sibling=null,fe}function C(fe,le,Te){return fe.index=Te,u?(Te=fe.alternate,Te!==null?(Te=Te.index,Te<le?(fe.flags|=2,le):Te):(fe.flags|=2,le)):(fe.flags|=1048576,le)}function z(fe){return u&&fe.alternate===null&&(fe.flags|=2),fe}function ae(fe,le,Te,nt){return le===null||le.tag!==6?(le=lT(Te,fe.mode,nt),le.return=fe,le):(le=T(le,Te),le.return=fe,le)}function oe(fe,le,Te,nt){var Mt=Te.type;return Mt===A?Ke(fe,le,Te.props.children,nt,Te.key):le!==null&&(le.elementType===Mt||typeof Mt=="object"&&Mt!==null&&Mt.$$typeof===Be&&EP(Mt)===le.type)?(nt=T(le,Te.props),nt.ref=Hg(fe,le,Te),nt.return=fe,nt):(nt=sx(Te.type,Te.key,Te.props,null,fe.mode,nt),nt.ref=Hg(fe,le,Te),nt.return=fe,nt)}function Ae(fe,le,Te,nt){return le===null||le.tag!==4||le.stateNode.containerInfo!==Te.containerInfo||le.stateNode.implementation!==Te.implementation?(le=cT(Te,fe.mode,nt),le.return=fe,le):(le=T(le,Te.children||[]),le.return=fe,le)}function Ke(fe,le,Te,nt,Mt){return le===null||le.tag!==7?(le=xh(Te,fe.mode,nt,Mt),le.return=fe,le):(le=T(le,Te),le.return=fe,le)}function Ze(fe,le,Te){if(typeof le=="string"&&le!==""||typeof le=="number")return le=lT(""+le,fe.mode,Te),le.return=fe,le;if(typeof le=="object"&&le!==null){switch(le.$$typeof){case O:return Te=sx(le.type,le.key,le.props,null,fe.mode,Te),Te.ref=Hg(fe,null,le),Te.return=fe,Te;case G:return le=cT(le,fe.mode,Te),le.return=fe,le;case Be:var nt=le._init;return Ze(fe,nt(le._payload),Te)}if(cn(le)||Pe(le))return le=xh(le,fe.mode,Te,null),le.return=fe,le;O1(fe,le)}return null}function $e(fe,le,Te,nt){var Mt=le!==null?le.key:null;if(typeof Te=="string"&&Te!==""||typeof Te=="number")return Mt!==null?null:ae(fe,le,""+Te,nt);if(typeof Te=="object"&&Te!==null){switch(Te.$$typeof){case O:return Te.key===Mt?oe(fe,le,Te,nt):null;case G:return Te.key===Mt?Ae(fe,le,Te,nt):null;case Be:return Mt=Te._init,$e(fe,le,Mt(Te._payload),nt)}if(cn(Te)||Pe(Te))return Mt!==null?null:Ke(fe,le,Te,nt,null);O1(fe,Te)}return null}function vt(fe,le,Te,nt,Mt){if(typeof nt=="string"&&nt!==""||typeof nt=="number")return fe=fe.get(Te)||null,ae(le,fe,""+nt,Mt);if(typeof nt=="object"&&nt!==null){switch(nt.$$typeof){case O:return fe=fe.get(nt.key===null?Te:nt.key)||null,oe(le,fe,nt,Mt);case G:return fe=fe.get(nt.key===null?Te:nt.key)||null,Ae(le,fe,nt,Mt);case Be:var zt=nt._init;return vt(fe,le,Te,zt(nt._payload),Mt)}if(cn(nt)||Pe(nt))return fe=fe.get(Te)||null,Ke(le,fe,nt,Mt,null);O1(le,nt)}return null}function At(fe,le,Te,nt){for(var Mt=null,zt=null,Ut=le,qt=le=0,vi=null;Ut!==null&&qt<Te.length;qt++){Ut.index>qt?(vi=Ut,Ut=null):vi=Ut.sibling;var Cn=$e(fe,Ut,Te[qt],nt);if(Cn===null){Ut===null&&(Ut=vi);break}u&&Ut&&Cn.alternate===null&&d(fe,Ut),le=C(Cn,le,qt),zt===null?Mt=Cn:zt.sibling=Cn,zt=Cn,Ut=vi}if(qt===Te.length)return p(fe,Ut),yr&&uh(fe,qt),Mt;if(Ut===null){for(;qt<Te.length;qt++)Ut=Ze(fe,Te[qt],nt),Ut!==null&&(le=C(Ut,le,qt),zt===null?Mt=Ut:zt.sibling=Ut,zt=Ut);return yr&&uh(fe,qt),Mt}for(Ut=E(fe,Ut);qt<Te.length;qt++)vi=vt(Ut,fe,qt,Te[qt],nt),vi!==null&&(u&&vi.alternate!==null&&Ut.delete(vi.key===null?qt:vi.key),le=C(vi,le,qt),zt===null?Mt=vi:zt.sibling=vi,zt=vi);return u&&Ut.forEach(function(zc){return d(fe,zc)}),yr&&uh(fe,qt),Mt}function kt(fe,le,Te,nt){var Mt=Pe(Te);if(typeof Mt!="function")throw Error(t(150));if(Te=Mt.call(Te),Te==null)throw Error(t(151));for(var zt=Mt=null,Ut=le,qt=le=0,vi=null,Cn=Te.next();Ut!==null&&!Cn.done;qt++,Cn=Te.next()){Ut.index>qt?(vi=Ut,Ut=null):vi=Ut.sibling;var zc=$e(fe,Ut,Cn.value,nt);if(zc===null){Ut===null&&(Ut=vi);break}u&&Ut&&zc.alternate===null&&d(fe,Ut),le=C(zc,le,qt),zt===null?Mt=zc:zt.sibling=zc,zt=zc,Ut=vi}if(Cn.done)return p(fe,Ut),yr&&uh(fe,qt),Mt;if(Ut===null){for(;!Cn.done;qt++,Cn=Te.next())Cn=Ze(fe,Cn.value,nt),Cn!==null&&(le=C(Cn,le,qt),zt===null?Mt=Cn:zt.sibling=Cn,zt=Cn);return yr&&uh(fe,qt),Mt}for(Ut=E(fe,Ut);!Cn.done;qt++,Cn=Te.next())Cn=vt(Ut,fe,qt,Cn.value,nt),Cn!==null&&(u&&Cn.alternate!==null&&Ut.delete(Cn.key===null?qt:Cn.key),le=C(Cn,le,qt),zt===null?Mt=Cn:zt.sibling=Cn,zt=Cn);return u&&Ut.forEach(function(xU){return d(fe,xU)}),yr&&uh(fe,qt),Mt}function Ur(fe,le,Te,nt){if(typeof Te=="object"&&Te!==null&&Te.type===A&&Te.key===null&&(Te=Te.props.children),typeof Te=="object"&&Te!==null){switch(Te.$$typeof){case O:e:{for(var Mt=Te.key,zt=le;zt!==null;){if(zt.key===Mt){if(Mt=Te.type,Mt===A){if(zt.tag===7){p(fe,zt.sibling),le=T(zt,Te.props.children),le.return=fe,fe=le;break e}}else if(zt.elementType===Mt||typeof Mt=="object"&&Mt!==null&&Mt.$$typeof===Be&&EP(Mt)===zt.type){p(fe,zt.sibling),le=T(zt,Te.props),le.ref=Hg(fe,zt,Te),le.return=fe,fe=le;break e}p(fe,zt);break}else d(fe,zt);zt=zt.sibling}Te.type===A?(le=xh(Te.props.children,fe.mode,nt,Te.key),le.return=fe,fe=le):(nt=sx(Te.type,Te.key,Te.props,null,fe.mode,nt),nt.ref=Hg(fe,le,Te),nt.return=fe,fe=nt)}return z(fe);case G:e:{for(zt=Te.key;le!==null;){if(le.key===zt)if(le.tag===4&&le.stateNode.containerInfo===Te.containerInfo&&le.stateNode.implementation===Te.implementation){p(fe,le.sibling),le=T(le,Te.children||[]),le.return=fe,fe=le;break e}else{p(fe,le);break}else d(fe,le);le=le.sibling}le=cT(Te,fe.mode,nt),le.return=fe,fe=le}return z(fe);case Be:return zt=Te._init,Ur(fe,le,zt(Te._payload),nt)}if(cn(Te))return At(fe,le,Te,nt);if(Pe(Te))return kt(fe,le,Te,nt);O1(fe,Te)}return typeof Te=="string"&&Te!==""||typeof Te=="number"?(Te=""+Te,le!==null&&le.tag===6?(p(fe,le.sibling),le=T(le,Te),le.return=fe,fe=le):(p(fe,le),le=lT(Te,fe.mode,nt),le.return=fe,fe=le),z(fe)):p(fe,le)}return Ur}var df=TP(!0),SP=TP(!1),D1=Pc(null),F1=null,ff=null,x2=null;function _2(){x2=ff=F1=null}function v2(u){var d=D1.current;dr(D1),u._currentValue=d}function w2(u,d,p){for(;u!==null;){var E=u.alternate;if((u.childLanes&d)!==d?(u.childLanes|=d,E!==null&&(E.childLanes|=d)):E!==null&&(E.childLanes&d)!==d&&(E.childLanes|=d),u===p)break;u=u.return}}function gf(u,d){F1=u,x2=ff=null,u=u.dependencies,u!==null&&u.firstContext!==null&&((u.lanes&d)!==0&&(Cs=!0),u.firstContext=null)}function Ta(u){var d=u._currentValue;if(x2!==u)if(u={context:u,memoizedValue:d,next:null},ff===null){if(F1===null)throw Error(t(308));ff=u,F1.dependencies={lanes:0,firstContext:u}}else ff=ff.next=u;return d}var hh=null;function E2(u){hh===null?hh=[u]:hh.push(u)}function bP(u,d,p,E){var T=d.interleaved;return T===null?(p.next=p,E2(d)):(p.next=T.next,T.next=p),d.interleaved=p,Pl(u,E)}function Pl(u,d){u.lanes|=d;var p=u.alternate;for(p!==null&&(p.lanes|=d),p=u,u=u.return;u!==null;)u.childLanes|=d,p=u.alternate,p!==null&&(p.childLanes|=d),p=u,u=u.return;return p.tag===3?p.stateNode:null}var Lc=!1;function T2(u){u.updateQueue={baseState:u.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function RP(u,d){u=u.updateQueue,d.updateQueue===u&&(d.updateQueue={baseState:u.baseState,firstBaseUpdate:u.firstBaseUpdate,lastBaseUpdate:u.lastBaseUpdate,shared:u.shared,effects:u.effects})}function Ml(u,d){return{eventTime:u,lane:d,tag:0,payload:null,callback:null,next:null}}function Oc(u,d,p){var E=u.updateQueue;if(E===null)return null;if(E=E.shared,(In&2)!==0){var T=E.pending;return T===null?d.next=d:(d.next=T.next,T.next=d),E.pending=d,Pl(u,p)}return T=E.interleaved,T===null?(d.next=d,E2(E)):(d.next=T.next,T.next=d),E.interleaved=d,Pl(u,p)}function j1(u,d,p){if(d=d.updateQueue,d!==null&&(d=d.shared,(p&4194240)!==0)){var E=d.lanes;E&=u.pendingLanes,p|=E,d.lanes=p,Ag(u,p)}}function AP(u,d){var p=u.updateQueue,E=u.alternate;if(E!==null&&(E=E.updateQueue,p===E)){var T=null,C=null;if(p=p.firstBaseUpdate,p!==null){do{var z={eventTime:p.eventTime,lane:p.lane,tag:p.tag,payload:p.payload,callback:p.callback,next:null};C===null?T=C=z:C=C.next=z,p=p.next}while(p!==null);C===null?T=C=d:C=C.next=d}else T=C=d;p={baseState:E.baseState,firstBaseUpdate:T,lastBaseUpdate:C,shared:E.shared,effects:E.effects},u.updateQueue=p;return}u=p.lastBaseUpdate,u===null?p.firstBaseUpdate=d:u.next=d,p.lastBaseUpdate=d}function V1(u,d,p,E){var T=u.updateQueue;Lc=!1;var C=T.firstBaseUpdate,z=T.lastBaseUpdate,ae=T.shared.pending;if(ae!==null){T.shared.pending=null;var oe=ae,Ae=oe.next;oe.next=null,z===null?C=Ae:z.next=Ae,z=oe;var Ke=u.alternate;Ke!==null&&(Ke=Ke.updateQueue,ae=Ke.lastBaseUpdate,ae!==z&&(ae===null?Ke.firstBaseUpdate=Ae:ae.next=Ae,Ke.lastBaseUpdate=oe))}if(C!==null){var Ze=T.baseState;z=0,Ke=Ae=oe=null,ae=C;do{var $e=ae.lane,vt=ae.eventTime;if((E&$e)===$e){Ke!==null&&(Ke=Ke.next={eventTime:vt,lane:0,tag:ae.tag,payload:ae.payload,callback:ae.callback,next:null});e:{var At=u,kt=ae;switch($e=d,vt=p,kt.tag){case 1:if(At=kt.payload,typeof At=="function"){Ze=At.call(vt,Ze,$e);break e}Ze=At;break e;case 3:At.flags=At.flags&-65537|128;case 0:if(At=kt.payload,$e=typeof At=="function"?At.call(vt,Ze,$e):At,$e==null)break e;Ze=be({},Ze,$e);break e;case 2:Lc=!0}}ae.callback!==null&&ae.lane!==0&&(u.flags|=64,$e=T.effects,$e===null?T.effects=[ae]:$e.push(ae))}else vt={eventTime:vt,lane:$e,tag:ae.tag,payload:ae.payload,callback:ae.callback,next:null},Ke===null?(Ae=Ke=vt,oe=Ze):Ke=Ke.next=vt,z|=$e;if(ae=ae.next,ae===null){if(ae=T.shared.pending,ae===null)break;$e=ae,ae=$e.next,$e.next=null,T.lastBaseUpdate=$e,T.shared.pending=null}}while(!0);if(Ke===null&&(oe=Ze),T.baseState=oe,T.firstBaseUpdate=Ae,T.lastBaseUpdate=Ke,d=T.shared.interleaved,d!==null){T=d;do z|=T.lane,T=T.next;while(T!==d)}else C===null&&(T.shared.lanes=0);gh|=z,u.lanes=z,u.memoizedState=Ze}}function IP(u,d,p){if(u=d.effects,d.effects=null,u!==null)for(d=0;d<u.length;d++){var E=u[d],T=E.callback;if(T!==null){if(E.callback=null,E=p,typeof T!="function")throw Error(t(191,T));T.call(E)}}}var Kg={},zo=Pc(Kg),Xg=Pc(Kg),qg=Pc(Kg);function dh(u){if(u===Kg)throw Error(t(174));return u}function S2(u,d){switch(cr(qg,d),cr(Xg,u),cr(zo,Kg),u=d.nodeType,u){case 9:case 11:d=(d=d.documentElement)?d.namespaceURI:pn(null,"");break;default:u=u===8?d.parentNode:d,d=u.namespaceURI||null,u=u.tagName,d=pn(d,u)}dr(zo),cr(zo,d)}function mf(){dr(zo),dr(Xg),dr(qg)}function CP(u){dh(qg.current);var d=dh(zo.current),p=pn(d,u.type);d!==p&&(cr(Xg,u),cr(zo,p))}function b2(u){Xg.current===u&&(dr(zo),dr(Xg))}var Rr=Pc(0);function G1(u){for(var d=u;d!==null;){if(d.tag===13){var p=d.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||p.data==="$?"||p.data==="$!"))return d}else if(d.tag===19&&d.memoizedProps.revealOrder!==void 0){if((d.flags&128)!==0)return d}else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===u)break;for(;d.sibling===null;){if(d.return===null||d.return===u)return null;d=d.return}d.sibling.return=d.return,d=d.sibling}return null}var R2=[];function A2(){for(var u=0;u<R2.length;u++)R2[u]._workInProgressVersionPrimary=null;R2.length=0}var B1=M.ReactCurrentDispatcher,I2=M.ReactCurrentBatchConfig,fh=0,Ar=null,ci=null,xi=null,z1=!1,Yg=!1,Zg=0,Gz=0;function Ji(){throw Error(t(321))}function C2(u,d){if(d===null)return!1;for(var p=0;p<d.length&&p<u.length;p++)if(!Ja(u[p],d[p]))return!1;return!0}function k2(u,d,p,E,T,C){if(fh=C,Ar=d,d.memoizedState=null,d.updateQueue=null,d.lanes=0,B1.current=u===null||u.memoizedState===null?$z:Wz,u=p(E,T),Yg){C=0;do{if(Yg=!1,Zg=0,25<=C)throw Error(t(301));C+=1,xi=ci=null,d.updateQueue=null,B1.current=Hz,u=p(E,T)}while(Yg)}if(B1.current=W1,d=ci!==null&&ci.next!==null,fh=0,xi=ci=Ar=null,z1=!1,d)throw Error(t(300));return u}function P2(){var u=Zg!==0;return Zg=0,u}function Uo(){var u={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xi===null?Ar.memoizedState=xi=u:xi=xi.next=u,xi}function Sa(){if(ci===null){var u=Ar.alternate;u=u!==null?u.memoizedState:null}else u=ci.next;var d=xi===null?Ar.memoizedState:xi.next;if(d!==null)xi=d,ci=u;else{if(u===null)throw Error(t(310));ci=u,u={memoizedState:ci.memoizedState,baseState:ci.baseState,baseQueue:ci.baseQueue,queue:ci.queue,next:null},xi===null?Ar.memoizedState=xi=u:xi=xi.next=u}return xi}function Jg(u,d){return typeof d=="function"?d(u):d}function M2(u){var d=Sa(),p=d.queue;if(p===null)throw Error(t(311));p.lastRenderedReducer=u;var E=ci,T=E.baseQueue,C=p.pending;if(C!==null){if(T!==null){var z=T.next;T.next=C.next,C.next=z}E.baseQueue=T=C,p.pending=null}if(T!==null){C=T.next,E=E.baseState;var ae=z=null,oe=null,Ae=C;do{var Ke=Ae.lane;if((fh&Ke)===Ke)oe!==null&&(oe=oe.next={lane:0,action:Ae.action,hasEagerState:Ae.hasEagerState,eagerState:Ae.eagerState,next:null}),E=Ae.hasEagerState?Ae.eagerState:u(E,Ae.action);else{var Ze={lane:Ke,action:Ae.action,hasEagerState:Ae.hasEagerState,eagerState:Ae.eagerState,next:null};oe===null?(ae=oe=Ze,z=E):oe=oe.next=Ze,Ar.lanes|=Ke,gh|=Ke}Ae=Ae.next}while(Ae!==null&&Ae!==C);oe===null?z=E:oe.next=ae,Ja(E,d.memoizedState)||(Cs=!0),d.memoizedState=E,d.baseState=z,d.baseQueue=oe,p.lastRenderedState=E}if(u=p.interleaved,u!==null){T=u;do C=T.lane,Ar.lanes|=C,gh|=C,T=T.next;while(T!==u)}else T===null&&(p.lanes=0);return[d.memoizedState,p.dispatch]}function N2(u){var d=Sa(),p=d.queue;if(p===null)throw Error(t(311));p.lastRenderedReducer=u;var E=p.dispatch,T=p.pending,C=d.memoizedState;if(T!==null){p.pending=null;var z=T=T.next;do C=u(C,z.action),z=z.next;while(z!==T);Ja(C,d.memoizedState)||(Cs=!0),d.memoizedState=C,d.baseQueue===null&&(d.baseState=C),p.lastRenderedState=C}return[C,E]}function kP(){}function PP(u,d){var p=Ar,E=Sa(),T=d(),C=!Ja(E.memoizedState,T);if(C&&(E.memoizedState=T,Cs=!0),E=E.queue,L2(LP.bind(null,p,E,u),[u]),E.getSnapshot!==d||C||xi!==null&&xi.memoizedState.tag&1){if(p.flags|=2048,Qg(9,NP.bind(null,p,E,T,d),void 0,null),_i===null)throw Error(t(349));(fh&30)!==0||MP(p,d,T)}return T}function MP(u,d,p){u.flags|=16384,u={getSnapshot:d,value:p},d=Ar.updateQueue,d===null?(d={lastEffect:null,stores:null},Ar.updateQueue=d,d.stores=[u]):(p=d.stores,p===null?d.stores=[u]:p.push(u))}function NP(u,d,p,E){d.value=p,d.getSnapshot=E,OP(d)&&DP(u)}function LP(u,d,p){return p(function(){OP(d)&&DP(u)})}function OP(u){var d=u.getSnapshot;u=u.value;try{var p=d();return!Ja(u,p)}catch{return!0}}function DP(u){var d=Pl(u,1);d!==null&&ro(d,u,1,-1)}function FP(u){var d=Uo();return typeof u=="function"&&(u=u()),d.memoizedState=d.baseState=u,u={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Jg,lastRenderedState:u},d.queue=u,u=u.dispatch=Uz.bind(null,Ar,u),[d.memoizedState,u]}function Qg(u,d,p,E){return u={tag:u,create:d,destroy:p,deps:E,next:null},d=Ar.updateQueue,d===null?(d={lastEffect:null,stores:null},Ar.updateQueue=d,d.lastEffect=u.next=u):(p=d.lastEffect,p===null?d.lastEffect=u.next=u:(E=p.next,p.next=u,u.next=E,d.lastEffect=u)),u}function jP(){return Sa().memoizedState}function U1(u,d,p,E){var T=Uo();Ar.flags|=u,T.memoizedState=Qg(1|d,p,void 0,E===void 0?null:E)}function $1(u,d,p,E){var T=Sa();E=E===void 0?null:E;var C=void 0;if(ci!==null){var z=ci.memoizedState;if(C=z.destroy,E!==null&&C2(E,z.deps)){T.memoizedState=Qg(d,p,C,E);return}}Ar.flags|=u,T.memoizedState=Qg(1|d,p,C,E)}function VP(u,d){return U1(8390656,8,u,d)}function L2(u,d){return $1(2048,8,u,d)}function GP(u,d){return $1(4,2,u,d)}function BP(u,d){return $1(4,4,u,d)}function zP(u,d){if(typeof d=="function")return u=u(),d(u),function(){d(null)};if(d!=null)return u=u(),d.current=u,function(){d.current=null}}function UP(u,d,p){return p=p!=null?p.concat([u]):null,$1(4,4,zP.bind(null,d,u),p)}function O2(){}function $P(u,d){var p=Sa();d=d===void 0?null:d;var E=p.memoizedState;return E!==null&&d!==null&&C2(d,E[1])?E[0]:(p.memoizedState=[u,d],u)}function WP(u,d){var p=Sa();d=d===void 0?null:d;var E=p.memoizedState;return E!==null&&d!==null&&C2(d,E[1])?E[0]:(u=u(),p.memoizedState=[u,d],u)}function HP(u,d,p){return(fh&21)===0?(u.baseState&&(u.baseState=!1,Cs=!0),u.memoizedState=p):(Ja(p,d)||(p=bg(),Ar.lanes|=p,gh|=p,u.baseState=!0),d)}function Bz(u,d){var p=vn;vn=p!==0&&4>p?p:4,u(!0);var E=I2.transition;I2.transition={};try{u(!1),d()}finally{vn=p,I2.transition=E}}function KP(){return Sa().memoizedState}function zz(u,d,p){var E=Vc(u);if(p={lane:E,action:p,hasEagerState:!1,eagerState:null,next:null},XP(u))qP(d,p);else if(p=bP(u,d,p,E),p!==null){var T=ys();ro(p,u,E,T),YP(p,d,E)}}function Uz(u,d,p){var E=Vc(u),T={lane:E,action:p,hasEagerState:!1,eagerState:null,next:null};if(XP(u))qP(d,T);else{var C=u.alternate;if(u.lanes===0&&(C===null||C.lanes===0)&&(C=d.lastRenderedReducer,C!==null))try{var z=d.lastRenderedState,ae=C(z,p);if(T.hasEagerState=!0,T.eagerState=ae,Ja(ae,z)){var oe=d.interleaved;oe===null?(T.next=T,E2(d)):(T.next=oe.next,oe.next=T),d.interleaved=T;return}}catch{}p=bP(u,d,T,E),p!==null&&(T=ys(),ro(p,u,E,T),YP(p,d,E))}}function XP(u){var d=u.alternate;return u===Ar||d!==null&&d===Ar}function qP(u,d){Yg=z1=!0;var p=u.pending;p===null?d.next=d:(d.next=p.next,p.next=d),u.pending=d}function YP(u,d,p){if((p&4194240)!==0){var E=d.lanes;E&=u.pendingLanes,p|=E,d.lanes=p,Ag(u,p)}}var W1={readContext:Ta,useCallback:Ji,useContext:Ji,useEffect:Ji,useImperativeHandle:Ji,useInsertionEffect:Ji,useLayoutEffect:Ji,useMemo:Ji,useReducer:Ji,useRef:Ji,useState:Ji,useDebugValue:Ji,useDeferredValue:Ji,useTransition:Ji,useMutableSource:Ji,useSyncExternalStore:Ji,useId:Ji,unstable_isNewReconciler:!1},$z={readContext:Ta,useCallback:function(u,d){return Uo().memoizedState=[u,d===void 0?null:d],u},useContext:Ta,useEffect:VP,useImperativeHandle:function(u,d,p){return p=p!=null?p.concat([u]):null,U1(4194308,4,zP.bind(null,d,u),p)},useLayoutEffect:function(u,d){return U1(4194308,4,u,d)},useInsertionEffect:function(u,d){return U1(4,2,u,d)},useMemo:function(u,d){var p=Uo();return d=d===void 0?null:d,u=u(),p.memoizedState=[u,d],u},useReducer:function(u,d,p){var E=Uo();return d=p!==void 0?p(d):d,E.memoizedState=E.baseState=d,u={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:u,lastRenderedState:d},E.queue=u,u=u.dispatch=zz.bind(null,Ar,u),[E.memoizedState,u]},useRef:function(u){var d=Uo();return u={current:u},d.memoizedState=u},useState:FP,useDebugValue:O2,useDeferredValue:function(u){return Uo().memoizedState=u},useTransition:function(){var u=FP(!1),d=u[0];return u=Bz.bind(null,u[1]),Uo().memoizedState=u,[d,u]},useMutableSource:function(){},useSyncExternalStore:function(u,d,p){var E=Ar,T=Uo();if(yr){if(p===void 0)throw Error(t(407));p=p()}else{if(p=d(),_i===null)throw Error(t(349));(fh&30)!==0||MP(E,d,p)}T.memoizedState=p;var C={value:p,getSnapshot:d};return T.queue=C,VP(LP.bind(null,E,C,u),[u]),E.flags|=2048,Qg(9,NP.bind(null,E,C,p,d),void 0,null),p},useId:function(){var u=Uo(),d=_i.identifierPrefix;if(yr){var p=kl,E=Cl;p=(E&~(1<<32-br(E)-1)).toString(32)+p,d=":"+d+"R"+p,p=Zg++,0<p&&(d+="H"+p.toString(32)),d+=":"}else p=Gz++,d=":"+d+"r"+p.toString(32)+":";return u.memoizedState=d},unstable_isNewReconciler:!1},Wz={readContext:Ta,useCallback:$P,useContext:Ta,useEffect:L2,useImperativeHandle:UP,useInsertionEffect:GP,useLayoutEffect:BP,useMemo:WP,useReducer:M2,useRef:jP,useState:function(){return M2(Jg)},useDebugValue:O2,useDeferredValue:function(u){var d=Sa();return HP(d,ci.memoizedState,u)},useTransition:function(){var u=M2(Jg)[0],d=Sa().memoizedState;return[u,d]},useMutableSource:kP,useSyncExternalStore:PP,useId:KP,unstable_isNewReconciler:!1},Hz={readContext:Ta,useCallback:$P,useContext:Ta,useEffect:L2,useImperativeHandle:UP,useInsertionEffect:GP,useLayoutEffect:BP,useMemo:WP,useReducer:N2,useRef:jP,useState:function(){return N2(Jg)},useDebugValue:O2,useDeferredValue:function(u){var d=Sa();return ci===null?d.memoizedState=u:HP(d,ci.memoizedState,u)},useTransition:function(){var u=N2(Jg)[0],d=Sa().memoizedState;return[u,d]},useMutableSource:kP,useSyncExternalStore:PP,useId:KP,unstable_isNewReconciler:!1};function eo(u,d){if(u&&u.defaultProps){d=be({},d),u=u.defaultProps;for(var p in u)d[p]===void 0&&(d[p]=u[p]);return d}return d}function D2(u,d,p,E){d=u.memoizedState,p=p(E,d),p=p==null?d:be({},d,p),u.memoizedState=p,u.lanes===0&&(u.updateQueue.baseState=p)}var H1={isMounted:function(u){return(u=u._reactInternals)?Q(u)===u:!1},enqueueSetState:function(u,d,p){u=u._reactInternals;var E=ys(),T=Vc(u),C=Ml(E,T);C.payload=d,p!=null&&(C.callback=p),d=Oc(u,C,T),d!==null&&(ro(d,u,T,E),j1(d,u,T))},enqueueReplaceState:function(u,d,p){u=u._reactInternals;var E=ys(),T=Vc(u),C=Ml(E,T);C.tag=1,C.payload=d,p!=null&&(C.callback=p),d=Oc(u,C,T),d!==null&&(ro(d,u,T,E),j1(d,u,T))},enqueueForceUpdate:function(u,d){u=u._reactInternals;var p=ys(),E=Vc(u),T=Ml(p,E);T.tag=2,d!=null&&(T.callback=d),d=Oc(u,T,E),d!==null&&(ro(d,u,E,p),j1(d,u,E))}};function ZP(u,d,p,E,T,C,z){return u=u.stateNode,typeof u.shouldComponentUpdate=="function"?u.shouldComponentUpdate(E,C,z):d.prototype&&d.prototype.isPureReactComponent?!Vg(p,E)||!Vg(T,C):!0}function JP(u,d,p){var E=!1,T=Mc,C=d.contextType;return typeof C=="object"&&C!==null?C=Ta(C):(T=Is(d)?lh:Zi.current,E=d.contextTypes,C=(E=E!=null)?lf(u,T):Mc),d=new d(p,C),u.memoizedState=d.state!==null&&d.state!==void 0?d.state:null,d.updater=H1,u.stateNode=d,d._reactInternals=u,E&&(u=u.stateNode,u.__reactInternalMemoizedUnmaskedChildContext=T,u.__reactInternalMemoizedMaskedChildContext=C),d}function QP(u,d,p,E){u=d.state,typeof d.componentWillReceiveProps=="function"&&d.componentWillReceiveProps(p,E),typeof d.UNSAFE_componentWillReceiveProps=="function"&&d.UNSAFE_componentWillReceiveProps(p,E),d.state!==u&&H1.enqueueReplaceState(d,d.state,null)}function F2(u,d,p,E){var T=u.stateNode;T.props=p,T.state=u.memoizedState,T.refs={},T2(u);var C=d.contextType;typeof C=="object"&&C!==null?T.context=Ta(C):(C=Is(d)?lh:Zi.current,T.context=lf(u,C)),T.state=u.memoizedState,C=d.getDerivedStateFromProps,typeof C=="function"&&(D2(u,d,C,p),T.state=u.memoizedState),typeof d.getDerivedStateFromProps=="function"||typeof T.getSnapshotBeforeUpdate=="function"||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(d=T.state,typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount(),d!==T.state&&H1.enqueueReplaceState(T,T.state,null),V1(u,p,T,E),T.state=u.memoizedState),typeof T.componentDidMount=="function"&&(u.flags|=4194308)}function pf(u,d){try{var p="",E=d;do p+=ie(E),E=E.return;while(E);var T=p}catch(C){T=`
Error generating stack: `+C.message+`
`+C.stack}return{value:u,source:d,stack:T,digest:null}}function j2(u,d,p){return{value:u,source:null,stack:p??null,digest:d??null}}function V2(u,d){try{console.error(d.value)}catch(p){setTimeout(function(){throw p})}}var Kz=typeof WeakMap=="function"?WeakMap:Map;function e4(u,d,p){p=Ml(-1,p),p.tag=3,p.payload={element:null};var E=d.value;return p.callback=function(){Q1||(Q1=!0,eT=E),V2(u,d)},p}function t4(u,d,p){p=Ml(-1,p),p.tag=3;var E=u.type.getDerivedStateFromError;if(typeof E=="function"){var T=d.value;p.payload=function(){return E(T)},p.callback=function(){V2(u,d)}}var C=u.stateNode;return C!==null&&typeof C.componentDidCatch=="function"&&(p.callback=function(){V2(u,d),typeof E!="function"&&(Fc===null?Fc=new Set([this]):Fc.add(this));var z=d.stack;this.componentDidCatch(d.value,{componentStack:z!==null?z:""})}),p}function n4(u,d,p){var E=u.pingCache;if(E===null){E=u.pingCache=new Kz;var T=new Set;E.set(d,T)}else T=E.get(d),T===void 0&&(T=new Set,E.set(d,T));T.has(p)||(T.add(p),u=oU.bind(null,u,d,p),d.then(u,u))}function r4(u){do{var d;if((d=u.tag===13)&&(d=u.memoizedState,d=d!==null?d.dehydrated!==null:!0),d)return u;u=u.return}while(u!==null);return null}function i4(u,d,p,E,T){return(u.mode&1)===0?(u===d?u.flags|=65536:(u.flags|=128,p.flags|=131072,p.flags&=-52805,p.tag===1&&(p.alternate===null?p.tag=17:(d=Ml(-1,1),d.tag=2,Oc(p,d,1))),p.lanes|=1),u):(u.flags|=65536,u.lanes=T,u)}var Xz=M.ReactCurrentOwner,Cs=!1;function ps(u,d,p,E){d.child=u===null?SP(d,null,p,E):df(d,u.child,p,E)}function s4(u,d,p,E,T){p=p.render;var C=d.ref;return gf(d,T),E=k2(u,d,p,E,C,T),p=P2(),u!==null&&!Cs?(d.updateQueue=u.updateQueue,d.flags&=-2053,u.lanes&=~T,Nl(u,d,T)):(yr&&p&&f2(d),d.flags|=1,ps(u,d,E,T),d.child)}function a4(u,d,p,E,T){if(u===null){var C=p.type;return typeof C=="function"&&!oT(C)&&C.defaultProps===void 0&&p.compare===null&&p.defaultProps===void 0?(d.tag=15,d.type=C,o4(u,d,C,E,T)):(u=sx(p.type,null,E,d,d.mode,T),u.ref=d.ref,u.return=d,d.child=u)}if(C=u.child,(u.lanes&T)===0){var z=C.memoizedProps;if(p=p.compare,p=p!==null?p:Vg,p(z,E)&&u.ref===d.ref)return Nl(u,d,T)}return d.flags|=1,u=Bc(C,E),u.ref=d.ref,u.return=d,d.child=u}function o4(u,d,p,E,T){if(u!==null){var C=u.memoizedProps;if(Vg(C,E)&&u.ref===d.ref)if(Cs=!1,d.pendingProps=E=C,(u.lanes&T)!==0)(u.flags&131072)!==0&&(Cs=!0);else return d.lanes=u.lanes,Nl(u,d,T)}return G2(u,d,p,E,T)}function l4(u,d,p){var E=d.pendingProps,T=E.children,C=u!==null?u.memoizedState:null;if(E.mode==="hidden")if((d.mode&1)===0)d.memoizedState={baseLanes:0,cachePool:null,transitions:null},cr(xf,ra),ra|=p;else{if((p&1073741824)===0)return u=C!==null?C.baseLanes|p:p,d.lanes=d.childLanes=1073741824,d.memoizedState={baseLanes:u,cachePool:null,transitions:null},d.updateQueue=null,cr(xf,ra),ra|=u,null;d.memoizedState={baseLanes:0,cachePool:null,transitions:null},E=C!==null?C.baseLanes:p,cr(xf,ra),ra|=E}else C!==null?(E=C.baseLanes|p,d.memoizedState=null):E=p,cr(xf,ra),ra|=E;return ps(u,d,T,p),d.child}function c4(u,d){var p=d.ref;(u===null&&p!==null||u!==null&&u.ref!==p)&&(d.flags|=512,d.flags|=2097152)}function G2(u,d,p,E,T){var C=Is(p)?lh:Zi.current;return C=lf(d,C),gf(d,T),p=k2(u,d,p,E,C,T),E=P2(),u!==null&&!Cs?(d.updateQueue=u.updateQueue,d.flags&=-2053,u.lanes&=~T,Nl(u,d,T)):(yr&&E&&f2(d),d.flags|=1,ps(u,d,p,T),d.child)}function u4(u,d,p,E,T){if(Is(p)){var C=!0;k1(d)}else C=!1;if(gf(d,T),d.stateNode===null)X1(u,d),JP(d,p,E),F2(d,p,E,T),E=!0;else if(u===null){var z=d.stateNode,ae=d.memoizedProps;z.props=ae;var oe=z.context,Ae=p.contextType;typeof Ae=="object"&&Ae!==null?Ae=Ta(Ae):(Ae=Is(p)?lh:Zi.current,Ae=lf(d,Ae));var Ke=p.getDerivedStateFromProps,Ze=typeof Ke=="function"||typeof z.getSnapshotBeforeUpdate=="function";Ze||typeof z.UNSAFE_componentWillReceiveProps!="function"&&typeof z.componentWillReceiveProps!="function"||(ae!==E||oe!==Ae)&&QP(d,z,E,Ae),Lc=!1;var $e=d.memoizedState;z.state=$e,V1(d,E,z,T),oe=d.memoizedState,ae!==E||$e!==oe||As.current||Lc?(typeof Ke=="function"&&(D2(d,p,Ke,E),oe=d.memoizedState),(ae=Lc||ZP(d,p,ae,E,$e,oe,Ae))?(Ze||typeof z.UNSAFE_componentWillMount!="function"&&typeof z.componentWillMount!="function"||(typeof z.componentWillMount=="function"&&z.componentWillMount(),typeof z.UNSAFE_componentWillMount=="function"&&z.UNSAFE_componentWillMount()),typeof z.componentDidMount=="function"&&(d.flags|=4194308)):(typeof z.componentDidMount=="function"&&(d.flags|=4194308),d.memoizedProps=E,d.memoizedState=oe),z.props=E,z.state=oe,z.context=Ae,E=ae):(typeof z.componentDidMount=="function"&&(d.flags|=4194308),E=!1)}else{z=d.stateNode,RP(u,d),ae=d.memoizedProps,Ae=d.type===d.elementType?ae:eo(d.type,ae),z.props=Ae,Ze=d.pendingProps,$e=z.context,oe=p.contextType,typeof oe=="object"&&oe!==null?oe=Ta(oe):(oe=Is(p)?lh:Zi.current,oe=lf(d,oe));var vt=p.getDerivedStateFromProps;(Ke=typeof vt=="function"||typeof z.getSnapshotBeforeUpdate=="function")||typeof z.UNSAFE_componentWillReceiveProps!="function"&&typeof z.componentWillReceiveProps!="function"||(ae!==Ze||$e!==oe)&&QP(d,z,E,oe),Lc=!1,$e=d.memoizedState,z.state=$e,V1(d,E,z,T);var At=d.memoizedState;ae!==Ze||$e!==At||As.current||Lc?(typeof vt=="function"&&(D2(d,p,vt,E),At=d.memoizedState),(Ae=Lc||ZP(d,p,Ae,E,$e,At,oe)||!1)?(Ke||typeof z.UNSAFE_componentWillUpdate!="function"&&typeof z.componentWillUpdate!="function"||(typeof z.componentWillUpdate=="function"&&z.componentWillUpdate(E,At,oe),typeof z.UNSAFE_componentWillUpdate=="function"&&z.UNSAFE_componentWillUpdate(E,At,oe)),typeof z.componentDidUpdate=="function"&&(d.flags|=4),typeof z.getSnapshotBeforeUpdate=="function"&&(d.flags|=1024)):(typeof z.componentDidUpdate!="function"||ae===u.memoizedProps&&$e===u.memoizedState||(d.flags|=4),typeof z.getSnapshotBeforeUpdate!="function"||ae===u.memoizedProps&&$e===u.memoizedState||(d.flags|=1024),d.memoizedProps=E,d.memoizedState=At),z.props=E,z.state=At,z.context=oe,E=Ae):(typeof z.componentDidUpdate!="function"||ae===u.memoizedProps&&$e===u.memoizedState||(d.flags|=4),typeof z.getSnapshotBeforeUpdate!="function"||ae===u.memoizedProps&&$e===u.memoizedState||(d.flags|=1024),E=!1)}return B2(u,d,p,E,C,T)}function B2(u,d,p,E,T,C){c4(u,d);var z=(d.flags&128)!==0;if(!E&&!z)return T&&mP(d,p,!1),Nl(u,d,C);E=d.stateNode,Xz.current=d;var ae=z&&typeof p.getDerivedStateFromError!="function"?null:E.render();return d.flags|=1,u!==null&&z?(d.child=df(d,u.child,null,C),d.child=df(d,null,ae,C)):ps(u,d,ae,C),d.memoizedState=E.state,T&&mP(d,p,!0),d.child}function h4(u){var d=u.stateNode;d.pendingContext?fP(u,d.pendingContext,d.pendingContext!==d.context):d.context&&fP(u,d.context,!1),S2(u,d.containerInfo)}function d4(u,d,p,E,T){return hf(),y2(T),d.flags|=256,ps(u,d,p,E),d.child}var z2={dehydrated:null,treeContext:null,retryLane:0};function U2(u){return{baseLanes:u,cachePool:null,transitions:null}}function f4(u,d,p){var E=d.pendingProps,T=Rr.current,C=!1,z=(d.flags&128)!==0,ae;if((ae=z)||(ae=u!==null&&u.memoizedState===null?!1:(T&2)!==0),ae?(C=!0,d.flags&=-129):(u===null||u.memoizedState!==null)&&(T|=1),cr(Rr,T&1),u===null)return p2(d),u=d.memoizedState,u!==null&&(u=u.dehydrated,u!==null)?((d.mode&1)===0?d.lanes=1:u.data==="$!"?d.lanes=8:d.lanes=1073741824,null):(z=E.children,u=E.fallback,C?(E=d.mode,C=d.child,z={mode:"hidden",children:z},(E&1)===0&&C!==null?(C.childLanes=0,C.pendingProps=z):C=ax(z,E,0,null),u=xh(u,E,p,null),C.return=d,u.return=d,C.sibling=u,d.child=C,d.child.memoizedState=U2(p),d.memoizedState=z2,u):$2(d,z));if(T=u.memoizedState,T!==null&&(ae=T.dehydrated,ae!==null))return qz(u,d,z,E,ae,T,p);if(C){C=E.fallback,z=d.mode,T=u.child,ae=T.sibling;var oe={mode:"hidden",children:E.children};return(z&1)===0&&d.child!==T?(E=d.child,E.childLanes=0,E.pendingProps=oe,d.deletions=null):(E=Bc(T,oe),E.subtreeFlags=T.subtreeFlags&14680064),ae!==null?C=Bc(ae,C):(C=xh(C,z,p,null),C.flags|=2),C.return=d,E.return=d,E.sibling=C,d.child=E,E=C,C=d.child,z=u.child.memoizedState,z=z===null?U2(p):{baseLanes:z.baseLanes|p,cachePool:null,transitions:z.transitions},C.memoizedState=z,C.childLanes=u.childLanes&~p,d.memoizedState=z2,E}return C=u.child,u=C.sibling,E=Bc(C,{mode:"visible",children:E.children}),(d.mode&1)===0&&(E.lanes=p),E.return=d,E.sibling=null,u!==null&&(p=d.deletions,p===null?(d.deletions=[u],d.flags|=16):p.push(u)),d.child=E,d.memoizedState=null,E}function $2(u,d){return d=ax({mode:"visible",children:d},u.mode,0,null),d.return=u,u.child=d}function K1(u,d,p,E){return E!==null&&y2(E),df(d,u.child,null,p),u=$2(d,d.pendingProps.children),u.flags|=2,d.memoizedState=null,u}function qz(u,d,p,E,T,C,z){if(p)return d.flags&256?(d.flags&=-257,E=j2(Error(t(422))),K1(u,d,z,E)):d.memoizedState!==null?(d.child=u.child,d.flags|=128,null):(C=E.fallback,T=d.mode,E=ax({mode:"visible",children:E.children},T,0,null),C=xh(C,T,z,null),C.flags|=2,E.return=d,C.return=d,E.sibling=C,d.child=E,(d.mode&1)!==0&&df(d,u.child,null,z),d.child.memoizedState=U2(z),d.memoizedState=z2,C);if((d.mode&1)===0)return K1(u,d,z,null);if(T.data==="$!"){if(E=T.nextSibling&&T.nextSibling.dataset,E)var ae=E.dgst;return E=ae,C=Error(t(419)),E=j2(C,E,void 0),K1(u,d,z,E)}if(ae=(z&u.childLanes)!==0,Cs||ae){if(E=_i,E!==null){switch(z&-z){case 4:T=2;break;case 16:T=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:T=32;break;case 536870912:T=268435456;break;default:T=0}T=(T&(E.suspendedLanes|z))!==0?0:T,T!==0&&T!==C.retryLane&&(C.retryLane=T,Pl(u,T),ro(E,u,T,-1))}return aT(),E=j2(Error(t(421))),K1(u,d,z,E)}return T.data==="$?"?(d.flags|=128,d.child=u.child,d=lU.bind(null,u),T._reactRetry=d,null):(u=C.treeContext,na=kc(T.nextSibling),ta=d,yr=!0,Qa=null,u!==null&&(wa[Ea++]=Cl,wa[Ea++]=kl,wa[Ea++]=ch,Cl=u.id,kl=u.overflow,ch=d),d=$2(d,E.children),d.flags|=4096,d)}function g4(u,d,p){u.lanes|=d;var E=u.alternate;E!==null&&(E.lanes|=d),w2(u.return,d,p)}function W2(u,d,p,E,T){var C=u.memoizedState;C===null?u.memoizedState={isBackwards:d,rendering:null,renderingStartTime:0,last:E,tail:p,tailMode:T}:(C.isBackwards=d,C.rendering=null,C.renderingStartTime=0,C.last=E,C.tail=p,C.tailMode=T)}function m4(u,d,p){var E=d.pendingProps,T=E.revealOrder,C=E.tail;if(ps(u,d,E.children,p),E=Rr.current,(E&2)!==0)E=E&1|2,d.flags|=128;else{if(u!==null&&(u.flags&128)!==0)e:for(u=d.child;u!==null;){if(u.tag===13)u.memoizedState!==null&&g4(u,p,d);else if(u.tag===19)g4(u,p,d);else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===d)break e;for(;u.sibling===null;){if(u.return===null||u.return===d)break e;u=u.return}u.sibling.return=u.return,u=u.sibling}E&=1}if(cr(Rr,E),(d.mode&1)===0)d.memoizedState=null;else switch(T){case"forwards":for(p=d.child,T=null;p!==null;)u=p.alternate,u!==null&&G1(u)===null&&(T=p),p=p.sibling;p=T,p===null?(T=d.child,d.child=null):(T=p.sibling,p.sibling=null),W2(d,!1,T,p,C);break;case"backwards":for(p=null,T=d.child,d.child=null;T!==null;){if(u=T.alternate,u!==null&&G1(u)===null){d.child=T;break}u=T.sibling,T.sibling=p,p=T,T=u}W2(d,!0,p,null,C);break;case"together":W2(d,!1,null,null,void 0);break;default:d.memoizedState=null}return d.child}function X1(u,d){(d.mode&1)===0&&u!==null&&(u.alternate=null,d.alternate=null,d.flags|=2)}function Nl(u,d,p){if(u!==null&&(d.dependencies=u.dependencies),gh|=d.lanes,(p&d.childLanes)===0)return null;if(u!==null&&d.child!==u.child)throw Error(t(153));if(d.child!==null){for(u=d.child,p=Bc(u,u.pendingProps),d.child=p,p.return=d;u.sibling!==null;)u=u.sibling,p=p.sibling=Bc(u,u.pendingProps),p.return=d;p.sibling=null}return d.child}function Yz(u,d,p){switch(d.tag){case 3:h4(d),hf();break;case 5:CP(d);break;case 1:Is(d.type)&&k1(d);break;case 4:S2(d,d.stateNode.containerInfo);break;case 10:var E=d.type._context,T=d.memoizedProps.value;cr(D1,E._currentValue),E._currentValue=T;break;case 13:if(E=d.memoizedState,E!==null)return E.dehydrated!==null?(cr(Rr,Rr.current&1),d.flags|=128,null):(p&d.child.childLanes)!==0?f4(u,d,p):(cr(Rr,Rr.current&1),u=Nl(u,d,p),u!==null?u.sibling:null);cr(Rr,Rr.current&1);break;case 19:if(E=(p&d.childLanes)!==0,(u.flags&128)!==0){if(E)return m4(u,d,p);d.flags|=128}if(T=d.memoizedState,T!==null&&(T.rendering=null,T.tail=null,T.lastEffect=null),cr(Rr,Rr.current),E)break;return null;case 22:case 23:return d.lanes=0,l4(u,d,p)}return Nl(u,d,p)}var p4,H2,y4,x4;p4=function(u,d){for(var p=d.child;p!==null;){if(p.tag===5||p.tag===6)u.appendChild(p.stateNode);else if(p.tag!==4&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===d)break;for(;p.sibling===null;){if(p.return===null||p.return===d)return;p=p.return}p.sibling.return=p.return,p=p.sibling}},H2=function(){},y4=function(u,d,p,E){var T=u.memoizedProps;if(T!==E){u=d.stateNode,dh(zo.current);var C=null;switch(p){case"input":T=Dt(u,T),E=Dt(u,E),C=[];break;case"select":T=be({},T,{value:void 0}),E=be({},E,{value:void 0}),C=[];break;case"textarea":T=Ni(u,T),E=Ni(u,E),C=[];break;default:typeof T.onClick!="function"&&typeof E.onClick=="function"&&(u.onclick=A1)}Sr(p,E);var z;p=null;for(Ae in T)if(!E.hasOwnProperty(Ae)&&T.hasOwnProperty(Ae)&&T[Ae]!=null)if(Ae==="style"){var ae=T[Ae];for(z in ae)ae.hasOwnProperty(z)&&(p||(p={}),p[z]="")}else Ae!=="dangerouslySetInnerHTML"&&Ae!=="children"&&Ae!=="suppressContentEditableWarning"&&Ae!=="suppressHydrationWarning"&&Ae!=="autoFocus"&&(i.hasOwnProperty(Ae)?C||(C=[]):(C=C||[]).push(Ae,null));for(Ae in E){var oe=E[Ae];if(ae=T?.[Ae],E.hasOwnProperty(Ae)&&oe!==ae&&(oe!=null||ae!=null))if(Ae==="style")if(ae){for(z in ae)!ae.hasOwnProperty(z)||oe&&oe.hasOwnProperty(z)||(p||(p={}),p[z]="");for(z in oe)oe.hasOwnProperty(z)&&ae[z]!==oe[z]&&(p||(p={}),p[z]=oe[z])}else p||(C||(C=[]),C.push(Ae,p)),p=oe;else Ae==="dangerouslySetInnerHTML"?(oe=oe?oe.__html:void 0,ae=ae?ae.__html:void 0,oe!=null&&ae!==oe&&(C=C||[]).push(Ae,oe)):Ae==="children"?typeof oe!="string"&&typeof oe!="number"||(C=C||[]).push(Ae,""+oe):Ae!=="suppressContentEditableWarning"&&Ae!=="suppressHydrationWarning"&&(i.hasOwnProperty(Ae)?(oe!=null&&Ae==="onScroll"&&hr("scroll",u),C||ae===oe||(C=[])):(C=C||[]).push(Ae,oe))}p&&(C=C||[]).push("style",p);var Ae=C;(d.updateQueue=Ae)&&(d.flags|=4)}},x4=function(u,d,p,E){p!==E&&(d.flags|=4)};function em(u,d){if(!yr)switch(u.tailMode){case"hidden":d=u.tail;for(var p=null;d!==null;)d.alternate!==null&&(p=d),d=d.sibling;p===null?u.tail=null:p.sibling=null;break;case"collapsed":p=u.tail;for(var E=null;p!==null;)p.alternate!==null&&(E=p),p=p.sibling;E===null?d||u.tail===null?u.tail=null:u.tail.sibling=null:E.sibling=null}}function Qi(u){var d=u.alternate!==null&&u.alternate.child===u.child,p=0,E=0;if(d)for(var T=u.child;T!==null;)p|=T.lanes|T.childLanes,E|=T.subtreeFlags&14680064,E|=T.flags&14680064,T.return=u,T=T.sibling;else for(T=u.child;T!==null;)p|=T.lanes|T.childLanes,E|=T.subtreeFlags,E|=T.flags,T.return=u,T=T.sibling;return u.subtreeFlags|=E,u.childLanes=p,d}function Zz(u,d,p){var E=d.pendingProps;switch(g2(d),d.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qi(d),null;case 1:return Is(d.type)&&C1(),Qi(d),null;case 3:return E=d.stateNode,mf(),dr(As),dr(Zi),A2(),E.pendingContext&&(E.context=E.pendingContext,E.pendingContext=null),(u===null||u.child===null)&&(L1(d)?d.flags|=4:u===null||u.memoizedState.isDehydrated&&(d.flags&256)===0||(d.flags|=1024,Qa!==null&&(rT(Qa),Qa=null))),H2(u,d),Qi(d),null;case 5:b2(d);var T=dh(qg.current);if(p=d.type,u!==null&&d.stateNode!=null)y4(u,d,p,E,T),u.ref!==d.ref&&(d.flags|=512,d.flags|=2097152);else{if(!E){if(d.stateNode===null)throw Error(t(166));return Qi(d),null}if(u=dh(zo.current),L1(d)){E=d.stateNode,p=d.type;var C=d.memoizedProps;switch(E[Bo]=d,E[$g]=C,u=(d.mode&1)!==0,p){case"dialog":hr("cancel",E),hr("close",E);break;case"iframe":case"object":case"embed":hr("load",E);break;case"video":case"audio":for(T=0;T<Bg.length;T++)hr(Bg[T],E);break;case"source":hr("error",E);break;case"img":case"image":case"link":hr("error",E),hr("load",E);break;case"details":hr("toggle",E);break;case"input":Kt(E,C),hr("invalid",E);break;case"select":E._wrapperState={wasMultiple:!!C.multiple},hr("invalid",E);break;case"textarea":Vn(E,C),hr("invalid",E)}Sr(p,C),T=null;for(var z in C)if(C.hasOwnProperty(z)){var ae=C[z];z==="children"?typeof ae=="string"?E.textContent!==ae&&(C.suppressHydrationWarning!==!0&&R1(E.textContent,ae,u),T=["children",ae]):typeof ae=="number"&&E.textContent!==""+ae&&(C.suppressHydrationWarning!==!0&&R1(E.textContent,ae,u),T=["children",""+ae]):i.hasOwnProperty(z)&&ae!=null&&z==="onScroll"&&hr("scroll",E)}switch(p){case"input":Fe(E),tr(E,C,!0);break;case"textarea":Fe(E),oi(E);break;case"select":case"option":break;default:typeof C.onClick=="function"&&(E.onclick=A1)}E=T,d.updateQueue=E,E!==null&&(d.flags|=4)}else{z=T.nodeType===9?T:T.ownerDocument,u==="http://www.w3.org/1999/xhtml"&&(u=_t(p)),u==="http://www.w3.org/1999/xhtml"?p==="script"?(u=z.createElement("div"),u.innerHTML="<script><\/script>",u=u.removeChild(u.firstChild)):typeof E.is=="string"?u=z.createElement(p,{is:E.is}):(u=z.createElement(p),p==="select"&&(z=u,E.multiple?z.multiple=!0:E.size&&(z.size=E.size))):u=z.createElementNS(u,p),u[Bo]=d,u[$g]=E,p4(u,d,!1,!1),d.stateNode=u;e:{switch(z=De(p,E),p){case"dialog":hr("cancel",u),hr("close",u),T=E;break;case"iframe":case"object":case"embed":hr("load",u),T=E;break;case"video":case"audio":for(T=0;T<Bg.length;T++)hr(Bg[T],u);T=E;break;case"source":hr("error",u),T=E;break;case"img":case"image":case"link":hr("error",u),hr("load",u),T=E;break;case"details":hr("toggle",u),T=E;break;case"input":Kt(u,E),T=Dt(u,E),hr("invalid",u);break;case"option":T=E;break;case"select":u._wrapperState={wasMultiple:!!E.multiple},T=be({},E,{value:void 0}),hr("invalid",u);break;case"textarea":Vn(u,E),T=Ni(u,E),hr("invalid",u);break;default:T=E}Sr(p,T),ae=T;for(C in ae)if(ae.hasOwnProperty(C)){var oe=ae[C];C==="style"?li(u,oe):C==="dangerouslySetInnerHTML"?(oe=oe?oe.__html:void 0,oe!=null&&Tt(u,oe)):C==="children"?typeof oe=="string"?(p!=="textarea"||oe!=="")&&sn(u,oe):typeof oe=="number"&&sn(u,""+oe):C!=="suppressContentEditableWarning"&&C!=="suppressHydrationWarning"&&C!=="autoFocus"&&(i.hasOwnProperty(C)?oe!=null&&C==="onScroll"&&hr("scroll",u):oe!=null&&R(u,C,oe,z))}switch(p){case"input":Fe(u),tr(u,E,!1);break;case"textarea":Fe(u),oi(u);break;case"option":E.value!=null&&u.setAttribute("value",""+Ge(E.value));break;case"select":u.multiple=!!E.multiple,C=E.value,C!=null?sr(u,!!E.multiple,C,!1):E.defaultValue!=null&&sr(u,!!E.multiple,E.defaultValue,!0);break;default:typeof T.onClick=="function"&&(u.onclick=A1)}switch(p){case"button":case"input":case"select":case"textarea":E=!!E.autoFocus;break e;case"img":E=!0;break e;default:E=!1}}E&&(d.flags|=4)}d.ref!==null&&(d.flags|=512,d.flags|=2097152)}return Qi(d),null;case 6:if(u&&d.stateNode!=null)x4(u,d,u.memoizedProps,E);else{if(typeof E!="string"&&d.stateNode===null)throw Error(t(166));if(p=dh(qg.current),dh(zo.current),L1(d)){if(E=d.stateNode,p=d.memoizedProps,E[Bo]=d,(C=E.nodeValue!==p)&&(u=ta,u!==null))switch(u.tag){case 3:R1(E.nodeValue,p,(u.mode&1)!==0);break;case 5:u.memoizedProps.suppressHydrationWarning!==!0&&R1(E.nodeValue,p,(u.mode&1)!==0)}C&&(d.flags|=4)}else E=(p.nodeType===9?p:p.ownerDocument).createTextNode(E),E[Bo]=d,d.stateNode=E}return Qi(d),null;case 13:if(dr(Rr),E=d.memoizedState,u===null||u.memoizedState!==null&&u.memoizedState.dehydrated!==null){if(yr&&na!==null&&(d.mode&1)!==0&&(d.flags&128)===0)wP(),hf(),d.flags|=98560,C=!1;else if(C=L1(d),E!==null&&E.dehydrated!==null){if(u===null){if(!C)throw Error(t(318));if(C=d.memoizedState,C=C!==null?C.dehydrated:null,!C)throw Error(t(317));C[Bo]=d}else hf(),(d.flags&128)===0&&(d.memoizedState=null),d.flags|=4;Qi(d),C=!1}else Qa!==null&&(rT(Qa),Qa=null),C=!0;if(!C)return d.flags&65536?d:null}return(d.flags&128)!==0?(d.lanes=p,d):(E=E!==null,E!==(u!==null&&u.memoizedState!==null)&&E&&(d.child.flags|=8192,(d.mode&1)!==0&&(u===null||(Rr.current&1)!==0?ui===0&&(ui=3):aT())),d.updateQueue!==null&&(d.flags|=4),Qi(d),null);case 4:return mf(),H2(u,d),u===null&&zg(d.stateNode.containerInfo),Qi(d),null;case 10:return v2(d.type._context),Qi(d),null;case 17:return Is(d.type)&&C1(),Qi(d),null;case 19:if(dr(Rr),C=d.memoizedState,C===null)return Qi(d),null;if(E=(d.flags&128)!==0,z=C.rendering,z===null)if(E)em(C,!1);else{if(ui!==0||u!==null&&(u.flags&128)!==0)for(u=d.child;u!==null;){if(z=G1(u),z!==null){for(d.flags|=128,em(C,!1),E=z.updateQueue,E!==null&&(d.updateQueue=E,d.flags|=4),d.subtreeFlags=0,E=p,p=d.child;p!==null;)C=p,u=E,C.flags&=14680066,z=C.alternate,z===null?(C.childLanes=0,C.lanes=u,C.child=null,C.subtreeFlags=0,C.memoizedProps=null,C.memoizedState=null,C.updateQueue=null,C.dependencies=null,C.stateNode=null):(C.childLanes=z.childLanes,C.lanes=z.lanes,C.child=z.child,C.subtreeFlags=0,C.deletions=null,C.memoizedProps=z.memoizedProps,C.memoizedState=z.memoizedState,C.updateQueue=z.updateQueue,C.type=z.type,u=z.dependencies,C.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),p=p.sibling;return cr(Rr,Rr.current&1|2),d.child}u=u.sibling}C.tail!==null&&Ye()>_f&&(d.flags|=128,E=!0,em(C,!1),d.lanes=4194304)}else{if(!E)if(u=G1(z),u!==null){if(d.flags|=128,E=!0,p=u.updateQueue,p!==null&&(d.updateQueue=p,d.flags|=4),em(C,!0),C.tail===null&&C.tailMode==="hidden"&&!z.alternate&&!yr)return Qi(d),null}else 2*Ye()-C.renderingStartTime>_f&&p!==1073741824&&(d.flags|=128,E=!0,em(C,!1),d.lanes=4194304);C.isBackwards?(z.sibling=d.child,d.child=z):(p=C.last,p!==null?p.sibling=z:d.child=z,C.last=z)}return C.tail!==null?(d=C.tail,C.rendering=d,C.tail=d.sibling,C.renderingStartTime=Ye(),d.sibling=null,p=Rr.current,cr(Rr,E?p&1|2:p&1),d):(Qi(d),null);case 22:case 23:return sT(),E=d.memoizedState!==null,u!==null&&u.memoizedState!==null!==E&&(d.flags|=8192),E&&(d.mode&1)!==0?(ra&1073741824)!==0&&(Qi(d),d.subtreeFlags&6&&(d.flags|=8192)):Qi(d),null;case 24:return null;case 25:return null}throw Error(t(156,d.tag))}function Jz(u,d){switch(g2(d),d.tag){case 1:return Is(d.type)&&C1(),u=d.flags,u&65536?(d.flags=u&-65537|128,d):null;case 3:return mf(),dr(As),dr(Zi),A2(),u=d.flags,(u&65536)!==0&&(u&128)===0?(d.flags=u&-65537|128,d):null;case 5:return b2(d),null;case 13:if(dr(Rr),u=d.memoizedState,u!==null&&u.dehydrated!==null){if(d.alternate===null)throw Error(t(340));hf()}return u=d.flags,u&65536?(d.flags=u&-65537|128,d):null;case 19:return dr(Rr),null;case 4:return mf(),null;case 10:return v2(d.type._context),null;case 22:case 23:return sT(),null;case 24:return null;default:return null}}var q1=!1,es=!1,Qz=typeof WeakSet=="function"?WeakSet:Set,Et=null;function yf(u,d){var p=u.ref;if(p!==null)if(typeof p=="function")try{p(null)}catch(E){Lr(u,d,E)}else p.current=null}function K2(u,d,p){try{p()}catch(E){Lr(u,d,E)}}var _4=!1;function eU(u,d){if(s2=Sl,u=Zk(),ZE(u)){if("selectionStart"in u)var p={start:u.selectionStart,end:u.selectionEnd};else e:{p=(p=u.ownerDocument)&&p.defaultView||window;var E=p.getSelection&&p.getSelection();if(E&&E.rangeCount!==0){p=E.anchorNode;var T=E.anchorOffset,C=E.focusNode;E=E.focusOffset;try{p.nodeType,C.nodeType}catch{p=null;break e}var z=0,ae=-1,oe=-1,Ae=0,Ke=0,Ze=u,$e=null;t:for(;;){for(var vt;Ze!==p||T!==0&&Ze.nodeType!==3||(ae=z+T),Ze!==C||E!==0&&Ze.nodeType!==3||(oe=z+E),Ze.nodeType===3&&(z+=Ze.nodeValue.length),(vt=Ze.firstChild)!==null;)$e=Ze,Ze=vt;for(;;){if(Ze===u)break t;if($e===p&&++Ae===T&&(ae=z),$e===C&&++Ke===E&&(oe=z),(vt=Ze.nextSibling)!==null)break;Ze=$e,$e=Ze.parentNode}Ze=vt}p=ae===-1||oe===-1?null:{start:ae,end:oe}}else p=null}p=p||{start:0,end:0}}else p=null;for(a2={focusedElem:u,selectionRange:p},Sl=!1,Et=d;Et!==null;)if(d=Et,u=d.child,(d.subtreeFlags&1028)!==0&&u!==null)u.return=d,Et=u;else for(;Et!==null;){d=Et;try{var At=d.alternate;if((d.flags&1024)!==0)switch(d.tag){case 0:case 11:case 15:break;case 1:if(At!==null){var kt=At.memoizedProps,Ur=At.memoizedState,fe=d.stateNode,le=fe.getSnapshotBeforeUpdate(d.elementType===d.type?kt:eo(d.type,kt),Ur);fe.__reactInternalSnapshotBeforeUpdate=le}break;case 3:var Te=d.stateNode.containerInfo;Te.nodeType===1?Te.textContent="":Te.nodeType===9&&Te.documentElement&&Te.removeChild(Te.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(nt){Lr(d,d.return,nt)}if(u=d.sibling,u!==null){u.return=d.return,Et=u;break}Et=d.return}return At=_4,_4=!1,At}function tm(u,d,p){var E=d.updateQueue;if(E=E!==null?E.lastEffect:null,E!==null){var T=E=E.next;do{if((T.tag&u)===u){var C=T.destroy;T.destroy=void 0,C!==void 0&&K2(d,p,C)}T=T.next}while(T!==E)}}function Y1(u,d){if(d=d.updateQueue,d=d!==null?d.lastEffect:null,d!==null){var p=d=d.next;do{if((p.tag&u)===u){var E=p.create;p.destroy=E()}p=p.next}while(p!==d)}}function X2(u){var d=u.ref;if(d!==null){var p=u.stateNode;switch(u.tag){case 5:u=p;break;default:u=p}typeof d=="function"?d(u):d.current=u}}function v4(u){var d=u.alternate;d!==null&&(u.alternate=null,v4(d)),u.child=null,u.deletions=null,u.sibling=null,u.tag===5&&(d=u.stateNode,d!==null&&(delete d[Bo],delete d[$g],delete d[u2],delete d[Dz],delete d[Fz])),u.stateNode=null,u.return=null,u.dependencies=null,u.memoizedProps=null,u.memoizedState=null,u.pendingProps=null,u.stateNode=null,u.updateQueue=null}function w4(u){return u.tag===5||u.tag===3||u.tag===4}function E4(u){e:for(;;){for(;u.sibling===null;){if(u.return===null||w4(u.return))return null;u=u.return}for(u.sibling.return=u.return,u=u.sibling;u.tag!==5&&u.tag!==6&&u.tag!==18;){if(u.flags&2||u.child===null||u.tag===4)continue e;u.child.return=u,u=u.child}if(!(u.flags&2))return u.stateNode}}function q2(u,d,p){var E=u.tag;if(E===5||E===6)u=u.stateNode,d?p.nodeType===8?p.parentNode.insertBefore(u,d):p.insertBefore(u,d):(p.nodeType===8?(d=p.parentNode,d.insertBefore(u,p)):(d=p,d.appendChild(u)),p=p._reactRootContainer,p!=null||d.onclick!==null||(d.onclick=A1));else if(E!==4&&(u=u.child,u!==null))for(q2(u,d,p),u=u.sibling;u!==null;)q2(u,d,p),u=u.sibling}function Y2(u,d,p){var E=u.tag;if(E===5||E===6)u=u.stateNode,d?p.insertBefore(u,d):p.appendChild(u);else if(E!==4&&(u=u.child,u!==null))for(Y2(u,d,p),u=u.sibling;u!==null;)Y2(u,d,p),u=u.sibling}var Di=null,to=!1;function Dc(u,d,p){for(p=p.child;p!==null;)T4(u,d,p),p=p.sibling}function T4(u,d,p){if(Br&&typeof Br.onCommitFiberUnmount=="function")try{Br.onCommitFiberUnmount(Ys,p)}catch{}switch(p.tag){case 5:es||yf(p,d);case 6:var E=Di,T=to;Di=null,Dc(u,d,p),Di=E,to=T,Di!==null&&(to?(u=Di,p=p.stateNode,u.nodeType===8?u.parentNode.removeChild(p):u.removeChild(p)):Di.removeChild(p.stateNode));break;case 18:Di!==null&&(to?(u=Di,p=p.stateNode,u.nodeType===8?c2(u.parentNode,p):u.nodeType===1&&c2(u,p),Rc(u)):c2(Di,p.stateNode));break;case 4:E=Di,T=to,Di=p.stateNode.containerInfo,to=!0,Dc(u,d,p),Di=E,to=T;break;case 0:case 11:case 14:case 15:if(!es&&(E=p.updateQueue,E!==null&&(E=E.lastEffect,E!==null))){T=E=E.next;do{var C=T,z=C.destroy;C=C.tag,z!==void 0&&((C&2)!==0||(C&4)!==0)&&K2(p,d,z),T=T.next}while(T!==E)}Dc(u,d,p);break;case 1:if(!es&&(yf(p,d),E=p.stateNode,typeof E.componentWillUnmount=="function"))try{E.props=p.memoizedProps,E.state=p.memoizedState,E.componentWillUnmount()}catch(ae){Lr(p,d,ae)}Dc(u,d,p);break;case 21:Dc(u,d,p);break;case 22:p.mode&1?(es=(E=es)||p.memoizedState!==null,Dc(u,d,p),es=E):Dc(u,d,p);break;default:Dc(u,d,p)}}function S4(u){var d=u.updateQueue;if(d!==null){u.updateQueue=null;var p=u.stateNode;p===null&&(p=u.stateNode=new Qz),d.forEach(function(E){var T=cU.bind(null,u,E);p.has(E)||(p.add(E),E.then(T,T))})}}function no(u,d){var p=d.deletions;if(p!==null)for(var E=0;E<p.length;E++){var T=p[E];try{var C=u,z=d,ae=z;e:for(;ae!==null;){switch(ae.tag){case 5:Di=ae.stateNode,to=!1;break e;case 3:Di=ae.stateNode.containerInfo,to=!0;break e;case 4:Di=ae.stateNode.containerInfo,to=!0;break e}ae=ae.return}if(Di===null)throw Error(t(160));T4(C,z,T),Di=null,to=!1;var oe=T.alternate;oe!==null&&(oe.return=null),T.return=null}catch(Ae){Lr(T,d,Ae)}}if(d.subtreeFlags&12854)for(d=d.child;d!==null;)b4(d,u),d=d.sibling}function b4(u,d){var p=u.alternate,E=u.flags;switch(u.tag){case 0:case 11:case 14:case 15:if(no(d,u),$o(u),E&4){try{tm(3,u,u.return),Y1(3,u)}catch(kt){Lr(u,u.return,kt)}try{tm(5,u,u.return)}catch(kt){Lr(u,u.return,kt)}}break;case 1:no(d,u),$o(u),E&512&&p!==null&&yf(p,p.return);break;case 5:if(no(d,u),$o(u),E&512&&p!==null&&yf(p,p.return),u.flags&32){var T=u.stateNode;try{sn(T,"")}catch(kt){Lr(u,u.return,kt)}}if(E&4&&(T=u.stateNode,T!=null)){var C=u.memoizedProps,z=p!==null?p.memoizedProps:C,ae=u.type,oe=u.updateQueue;if(u.updateQueue=null,oe!==null)try{ae==="input"&&C.type==="radio"&&C.name!=null&&Qt(T,C),De(ae,z);var Ae=De(ae,C);for(z=0;z<oe.length;z+=2){var Ke=oe[z],Ze=oe[z+1];Ke==="style"?li(T,Ze):Ke==="dangerouslySetInnerHTML"?Tt(T,Ze):Ke==="children"?sn(T,Ze):R(T,Ke,Ze,Ae)}switch(ae){case"input":ot(T,C);break;case"textarea":Tr(T,C);break;case"select":var $e=T._wrapperState.wasMultiple;T._wrapperState.wasMultiple=!!C.multiple;var vt=C.value;vt!=null?sr(T,!!C.multiple,vt,!1):$e!==!!C.multiple&&(C.defaultValue!=null?sr(T,!!C.multiple,C.defaultValue,!0):sr(T,!!C.multiple,C.multiple?[]:"",!1))}T[$g]=C}catch(kt){Lr(u,u.return,kt)}}break;case 6:if(no(d,u),$o(u),E&4){if(u.stateNode===null)throw Error(t(162));T=u.stateNode,C=u.memoizedProps;try{T.nodeValue=C}catch(kt){Lr(u,u.return,kt)}}break;case 3:if(no(d,u),$o(u),E&4&&p!==null&&p.memoizedState.isDehydrated)try{Rc(d.containerInfo)}catch(kt){Lr(u,u.return,kt)}break;case 4:no(d,u),$o(u);break;case 13:no(d,u),$o(u),T=u.child,T.flags&8192&&(C=T.memoizedState!==null,T.stateNode.isHidden=C,!C||T.alternate!==null&&T.alternate.memoizedState!==null||(Q2=Ye())),E&4&&S4(u);break;case 22:if(Ke=p!==null&&p.memoizedState!==null,u.mode&1?(es=(Ae=es)||Ke,no(d,u),es=Ae):no(d,u),$o(u),E&8192){if(Ae=u.memoizedState!==null,(u.stateNode.isHidden=Ae)&&!Ke&&(u.mode&1)!==0)for(Et=u,Ke=u.child;Ke!==null;){for(Ze=Et=Ke;Et!==null;){switch($e=Et,vt=$e.child,$e.tag){case 0:case 11:case 14:case 15:tm(4,$e,$e.return);break;case 1:yf($e,$e.return);var At=$e.stateNode;if(typeof At.componentWillUnmount=="function"){E=$e,p=$e.return;try{d=E,At.props=d.memoizedProps,At.state=d.memoizedState,At.componentWillUnmount()}catch(kt){Lr(E,p,kt)}}break;case 5:yf($e,$e.return);break;case 22:if($e.memoizedState!==null){I4(Ze);continue}}vt!==null?(vt.return=$e,Et=vt):I4(Ze)}Ke=Ke.sibling}e:for(Ke=null,Ze=u;;){if(Ze.tag===5){if(Ke===null){Ke=Ze;try{T=Ze.stateNode,Ae?(C=T.style,typeof C.setProperty=="function"?C.setProperty("display","none","important"):C.display="none"):(ae=Ze.stateNode,oe=Ze.memoizedProps.style,z=oe!=null&&oe.hasOwnProperty("display")?oe.display:null,ae.style.display=Nr("display",z))}catch(kt){Lr(u,u.return,kt)}}}else if(Ze.tag===6){if(Ke===null)try{Ze.stateNode.nodeValue=Ae?"":Ze.memoizedProps}catch(kt){Lr(u,u.return,kt)}}else if((Ze.tag!==22&&Ze.tag!==23||Ze.memoizedState===null||Ze===u)&&Ze.child!==null){Ze.child.return=Ze,Ze=Ze.child;continue}if(Ze===u)break e;for(;Ze.sibling===null;){if(Ze.return===null||Ze.return===u)break e;Ke===Ze&&(Ke=null),Ze=Ze.return}Ke===Ze&&(Ke=null),Ze.sibling.return=Ze.return,Ze=Ze.sibling}}break;case 19:no(d,u),$o(u),E&4&&S4(u);break;case 21:break;default:no(d,u),$o(u)}}function $o(u){var d=u.flags;if(d&2){try{e:{for(var p=u.return;p!==null;){if(w4(p)){var E=p;break e}p=p.return}throw Error(t(160))}switch(E.tag){case 5:var T=E.stateNode;E.flags&32&&(sn(T,""),E.flags&=-33);var C=E4(u);Y2(u,C,T);break;case 3:case 4:var z=E.stateNode.containerInfo,ae=E4(u);q2(u,ae,z);break;default:throw Error(t(161))}}catch(oe){Lr(u,u.return,oe)}u.flags&=-3}d&4096&&(u.flags&=-4097)}function tU(u,d,p){Et=u,R4(u)}function R4(u,d,p){for(var E=(u.mode&1)!==0;Et!==null;){var T=Et,C=T.child;if(T.tag===22&&E){var z=T.memoizedState!==null||q1;if(!z){var ae=T.alternate,oe=ae!==null&&ae.memoizedState!==null||es;ae=q1;var Ae=es;if(q1=z,(es=oe)&&!Ae)for(Et=T;Et!==null;)z=Et,oe=z.child,z.tag===22&&z.memoizedState!==null?C4(T):oe!==null?(oe.return=z,Et=oe):C4(T);for(;C!==null;)Et=C,R4(C),C=C.sibling;Et=T,q1=ae,es=Ae}A4(u)}else(T.subtreeFlags&8772)!==0&&C!==null?(C.return=T,Et=C):A4(u)}}function A4(u){for(;Et!==null;){var d=Et;if((d.flags&8772)!==0){var p=d.alternate;try{if((d.flags&8772)!==0)switch(d.tag){case 0:case 11:case 15:es||Y1(5,d);break;case 1:var E=d.stateNode;if(d.flags&4&&!es)if(p===null)E.componentDidMount();else{var T=d.elementType===d.type?p.memoizedProps:eo(d.type,p.memoizedProps);E.componentDidUpdate(T,p.memoizedState,E.__reactInternalSnapshotBeforeUpdate)}var C=d.updateQueue;C!==null&&IP(d,C,E);break;case 3:var z=d.updateQueue;if(z!==null){if(p=null,d.child!==null)switch(d.child.tag){case 5:p=d.child.stateNode;break;case 1:p=d.child.stateNode}IP(d,z,p)}break;case 5:var ae=d.stateNode;if(p===null&&d.flags&4){p=ae;var oe=d.memoizedProps;switch(d.type){case"button":case"input":case"select":case"textarea":oe.autoFocus&&p.focus();break;case"img":oe.src&&(p.src=oe.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(d.memoizedState===null){var Ae=d.alternate;if(Ae!==null){var Ke=Ae.memoizedState;if(Ke!==null){var Ze=Ke.dehydrated;Ze!==null&&Rc(Ze)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}es||d.flags&512&&X2(d)}catch($e){Lr(d,d.return,$e)}}if(d===u){Et=null;break}if(p=d.sibling,p!==null){p.return=d.return,Et=p;break}Et=d.return}}function I4(u){for(;Et!==null;){var d=Et;if(d===u){Et=null;break}var p=d.sibling;if(p!==null){p.return=d.return,Et=p;break}Et=d.return}}function C4(u){for(;Et!==null;){var d=Et;try{switch(d.tag){case 0:case 11:case 15:var p=d.return;try{Y1(4,d)}catch(oe){Lr(d,p,oe)}break;case 1:var E=d.stateNode;if(typeof E.componentDidMount=="function"){var T=d.return;try{E.componentDidMount()}catch(oe){Lr(d,T,oe)}}var C=d.return;try{X2(d)}catch(oe){Lr(d,C,oe)}break;case 5:var z=d.return;try{X2(d)}catch(oe){Lr(d,z,oe)}}}catch(oe){Lr(d,d.return,oe)}if(d===u){Et=null;break}var ae=d.sibling;if(ae!==null){ae.return=d.return,Et=ae;break}Et=d.return}}var nU=Math.ceil,Z1=M.ReactCurrentDispatcher,Z2=M.ReactCurrentOwner,ba=M.ReactCurrentBatchConfig,In=0,_i=null,qr=null,Fi=0,ra=0,xf=Pc(0),ui=0,nm=null,gh=0,J1=0,J2=0,rm=null,ks=null,Q2=0,_f=1/0,Ll=null,Q1=!1,eT=null,Fc=null,ex=!1,jc=null,tx=0,im=0,tT=null,nx=-1,rx=0;function ys(){return(In&6)!==0?Ye():nx!==-1?nx:nx=Ye()}function Vc(u){return(u.mode&1)===0?1:(In&2)!==0&&Fi!==0?Fi&-Fi:Vz.transition!==null?(rx===0&&(rx=bg()),rx):(u=vn,u!==0||(u=window.event,u=u===void 0?16:Kd(u.type)),u)}function ro(u,d,p,E){if(50<im)throw im=0,tT=null,Error(t(185));nh(u,p,E),((In&2)===0||u!==_i)&&(u===_i&&((In&2)===0&&(J1|=p),ui===4&&Gc(u,Fi)),Ps(u,E),p===1&&In===0&&(d.mode&1)===0&&(_f=Ye()+500,P1&&Nc()))}function Ps(u,d){var p=u.callbackNode;th(u,d);var E=wl(u,u===_i?Fi:0);if(E===0)p!==null&&rt(p),u.callbackNode=null,u.callbackPriority=0;else if(d=E&-E,u.callbackPriority!==d){if(p!=null&&rt(p),d===1)u.tag===0?jz(P4.bind(null,u)):pP(P4.bind(null,u)),Lz(function(){(In&6)===0&&Nc()}),p=null;else{switch(Po(E)){case 1:p=Gn;break;case 4:p=Wn;break;case 16:p=pr;break;case 536870912:p=_a;break;default:p=pr}p=V4(p,k4.bind(null,u))}u.callbackPriority=d,u.callbackNode=p}}function k4(u,d){if(nx=-1,rx=0,(In&6)!==0)throw Error(t(327));var p=u.callbackNode;if(vf()&&u.callbackNode!==p)return null;var E=wl(u,u===_i?Fi:0);if(E===0)return null;if((E&30)!==0||(E&u.expiredLanes)!==0||d)d=ix(u,E);else{d=E;var T=In;In|=2;var C=N4();(_i!==u||Fi!==d)&&(Ll=null,_f=Ye()+500,ph(u,d));do try{sU();break}catch(ae){M4(u,ae)}while(!0);_2(),Z1.current=C,In=T,qr!==null?d=0:(_i=null,Fi=0,d=ui)}if(d!==0){if(d===2&&(T=Sg(u),T!==0&&(E=T,d=nT(u,T))),d===1)throw p=nm,ph(u,0),Gc(u,E),Ps(u,Ye()),p;if(d===6)Gc(u,E);else{if(T=u.current.alternate,(E&30)===0&&!rU(T)&&(d=ix(u,E),d===2&&(C=Sg(u),C!==0&&(E=C,d=nT(u,C))),d===1))throw p=nm,ph(u,0),Gc(u,E),Ps(u,Ye()),p;switch(u.finishedWork=T,u.finishedLanes=E,d){case 0:case 1:throw Error(t(345));case 2:yh(u,ks,Ll);break;case 3:if(Gc(u,E),(E&130023424)===E&&(d=Q2+500-Ye(),10<d)){if(wl(u,0)!==0)break;if(T=u.suspendedLanes,(T&E)!==E){ys(),u.pingedLanes|=u.suspendedLanes&T;break}u.timeoutHandle=l2(yh.bind(null,u,ks,Ll),d);break}yh(u,ks,Ll);break;case 4:if(Gc(u,E),(E&4194240)===E)break;for(d=u.eventTimes,T=-1;0<E;){var z=31-br(E);C=1<<z,z=d[z],z>T&&(T=z),E&=~C}if(E=T,E=Ye()-E,E=(120>E?120:480>E?480:1080>E?1080:1920>E?1920:3e3>E?3e3:4320>E?4320:1960*nU(E/1960))-E,10<E){u.timeoutHandle=l2(yh.bind(null,u,ks,Ll),E);break}yh(u,ks,Ll);break;case 5:yh(u,ks,Ll);break;default:throw Error(t(329))}}}return Ps(u,Ye()),u.callbackNode===p?k4.bind(null,u):null}function nT(u,d){var p=rm;return u.current.memoizedState.isDehydrated&&(ph(u,d).flags|=256),u=ix(u,d),u!==2&&(d=ks,ks=p,d!==null&&rT(d)),u}function rT(u){ks===null?ks=u:ks.push.apply(ks,u)}function rU(u){for(var d=u;;){if(d.flags&16384){var p=d.updateQueue;if(p!==null&&(p=p.stores,p!==null))for(var E=0;E<p.length;E++){var T=p[E],C=T.getSnapshot;T=T.value;try{if(!Ja(C(),T))return!1}catch{return!1}}}if(p=d.child,d.subtreeFlags&16384&&p!==null)p.return=d,d=p;else{if(d===u)break;for(;d.sibling===null;){if(d.return===null||d.return===u)return!0;d=d.return}d.sibling.return=d.return,d=d.sibling}}return!0}function Gc(u,d){for(d&=~J2,d&=~J1,u.suspendedLanes|=d,u.pingedLanes&=~d,u=u.expirationTimes;0<d;){var p=31-br(d),E=1<<p;u[p]=-1,d&=~E}}function P4(u){if((In&6)!==0)throw Error(t(327));vf();var d=wl(u,0);if((d&1)===0)return Ps(u,Ye()),null;var p=ix(u,d);if(u.tag!==0&&p===2){var E=Sg(u);E!==0&&(d=E,p=nT(u,E))}if(p===1)throw p=nm,ph(u,0),Gc(u,d),Ps(u,Ye()),p;if(p===6)throw Error(t(345));return u.finishedWork=u.current.alternate,u.finishedLanes=d,yh(u,ks,Ll),Ps(u,Ye()),null}function iT(u,d){var p=In;In|=1;try{return u(d)}finally{In=p,In===0&&(_f=Ye()+500,P1&&Nc())}}function mh(u){jc!==null&&jc.tag===0&&(In&6)===0&&vf();var d=In;In|=1;var p=ba.transition,E=vn;try{if(ba.transition=null,vn=1,u)return u()}finally{vn=E,ba.transition=p,In=d,(In&6)===0&&Nc()}}function sT(){ra=xf.current,dr(xf)}function ph(u,d){u.finishedWork=null,u.finishedLanes=0;var p=u.timeoutHandle;if(p!==-1&&(u.timeoutHandle=-1,Nz(p)),qr!==null)for(p=qr.return;p!==null;){var E=p;switch(g2(E),E.tag){case 1:E=E.type.childContextTypes,E!=null&&C1();break;case 3:mf(),dr(As),dr(Zi),A2();break;case 5:b2(E);break;case 4:mf();break;case 13:dr(Rr);break;case 19:dr(Rr);break;case 10:v2(E.type._context);break;case 22:case 23:sT()}p=p.return}if(_i=u,qr=u=Bc(u.current,null),Fi=ra=d,ui=0,nm=null,J2=J1=gh=0,ks=rm=null,hh!==null){for(d=0;d<hh.length;d++)if(p=hh[d],E=p.interleaved,E!==null){p.interleaved=null;var T=E.next,C=p.pending;if(C!==null){var z=C.next;C.next=T,E.next=z}p.pending=E}hh=null}return u}function M4(u,d){do{var p=qr;try{if(_2(),B1.current=W1,z1){for(var E=Ar.memoizedState;E!==null;){var T=E.queue;T!==null&&(T.pending=null),E=E.next}z1=!1}if(fh=0,xi=ci=Ar=null,Yg=!1,Zg=0,Z2.current=null,p===null||p.return===null){ui=1,nm=d,qr=null;break}e:{var C=u,z=p.return,ae=p,oe=d;if(d=Fi,ae.flags|=32768,oe!==null&&typeof oe=="object"&&typeof oe.then=="function"){var Ae=oe,Ke=ae,Ze=Ke.tag;if((Ke.mode&1)===0&&(Ze===0||Ze===11||Ze===15)){var $e=Ke.alternate;$e?(Ke.updateQueue=$e.updateQueue,Ke.memoizedState=$e.memoizedState,Ke.lanes=$e.lanes):(Ke.updateQueue=null,Ke.memoizedState=null)}var vt=r4(z);if(vt!==null){vt.flags&=-257,i4(vt,z,ae,C,d),vt.mode&1&&n4(C,Ae,d),d=vt,oe=Ae;var At=d.updateQueue;if(At===null){var kt=new Set;kt.add(oe),d.updateQueue=kt}else At.add(oe);break e}else{if((d&1)===0){n4(C,Ae,d),aT();break e}oe=Error(t(426))}}else if(yr&&ae.mode&1){var Ur=r4(z);if(Ur!==null){(Ur.flags&65536)===0&&(Ur.flags|=256),i4(Ur,z,ae,C,d),y2(pf(oe,ae));break e}}C=oe=pf(oe,ae),ui!==4&&(ui=2),rm===null?rm=[C]:rm.push(C),C=z;do{switch(C.tag){case 3:C.flags|=65536,d&=-d,C.lanes|=d;var fe=e4(C,oe,d);AP(C,fe);break e;case 1:ae=oe;var le=C.type,Te=C.stateNode;if((C.flags&128)===0&&(typeof le.getDerivedStateFromError=="function"||Te!==null&&typeof Te.componentDidCatch=="function"&&(Fc===null||!Fc.has(Te)))){C.flags|=65536,d&=-d,C.lanes|=d;var nt=t4(C,ae,d);AP(C,nt);break e}}C=C.return}while(C!==null)}O4(p)}catch(Mt){d=Mt,qr===p&&p!==null&&(qr=p=p.return);continue}break}while(!0)}function N4(){var u=Z1.current;return Z1.current=W1,u===null?W1:u}function aT(){(ui===0||ui===3||ui===2)&&(ui=4),_i===null||(gh&268435455)===0&&(J1&268435455)===0||Gc(_i,Fi)}function ix(u,d){var p=In;In|=2;var E=N4();(_i!==u||Fi!==d)&&(Ll=null,ph(u,d));do try{iU();break}catch(T){M4(u,T)}while(!0);if(_2(),In=p,Z1.current=E,qr!==null)throw Error(t(261));return _i=null,Fi=0,ui}function iU(){for(;qr!==null;)L4(qr)}function sU(){for(;qr!==null&&!pt();)L4(qr)}function L4(u){var d=j4(u.alternate,u,ra);u.memoizedProps=u.pendingProps,d===null?O4(u):qr=d,Z2.current=null}function O4(u){var d=u;do{var p=d.alternate;if(u=d.return,(d.flags&32768)===0){if(p=Zz(p,d,ra),p!==null){qr=p;return}}else{if(p=Jz(p,d),p!==null){p.flags&=32767,qr=p;return}if(u!==null)u.flags|=32768,u.subtreeFlags=0,u.deletions=null;else{ui=6,qr=null;return}}if(d=d.sibling,d!==null){qr=d;return}qr=d=u}while(d!==null);ui===0&&(ui=5)}function yh(u,d,p){var E=vn,T=ba.transition;try{ba.transition=null,vn=1,aU(u,d,p,E)}finally{ba.transition=T,vn=E}return null}function aU(u,d,p,E){do vf();while(jc!==null);if((In&6)!==0)throw Error(t(327));p=u.finishedWork;var T=u.finishedLanes;if(p===null)return null;if(u.finishedWork=null,u.finishedLanes=0,p===u.current)throw Error(t(177));u.callbackNode=null,u.callbackPriority=0;var C=p.lanes|p.childLanes;if(HE(u,C),u===_i&&(qr=_i=null,Fi=0),(p.subtreeFlags&2064)===0&&(p.flags&2064)===0||ex||(ex=!0,V4(pr,function(){return vf(),null})),C=(p.flags&15990)!==0,(p.subtreeFlags&15990)!==0||C){C=ba.transition,ba.transition=null;var z=vn;vn=1;var ae=In;In|=4,Z2.current=null,eU(u,p),b4(p,u),Rz(a2),Sl=!!s2,a2=s2=null,u.current=p,tU(p),qe(),In=ae,vn=z,ba.transition=C}else u.current=p;if(ex&&(ex=!1,jc=u,tx=T),C=u.pendingLanes,C===0&&(Fc=null),Ec(p.stateNode),Ps(u,Ye()),d!==null)for(E=u.onRecoverableError,p=0;p<d.length;p++)T=d[p],E(T.value,{componentStack:T.stack,digest:T.digest});if(Q1)throw Q1=!1,u=eT,eT=null,u;return(tx&1)!==0&&u.tag!==0&&vf(),C=u.pendingLanes,(C&1)!==0?u===tT?im++:(im=0,tT=u):im=0,Nc(),null}function vf(){if(jc!==null){var u=Po(tx),d=ba.transition,p=vn;try{if(ba.transition=null,vn=16>u?16:u,jc===null)var E=!1;else{if(u=jc,jc=null,tx=0,(In&6)!==0)throw Error(t(331));var T=In;for(In|=4,Et=u.current;Et!==null;){var C=Et,z=C.child;if((Et.flags&16)!==0){var ae=C.deletions;if(ae!==null){for(var oe=0;oe<ae.length;oe++){var Ae=ae[oe];for(Et=Ae;Et!==null;){var Ke=Et;switch(Ke.tag){case 0:case 11:case 15:tm(8,Ke,C)}var Ze=Ke.child;if(Ze!==null)Ze.return=Ke,Et=Ze;else for(;Et!==null;){Ke=Et;var $e=Ke.sibling,vt=Ke.return;if(v4(Ke),Ke===Ae){Et=null;break}if($e!==null){$e.return=vt,Et=$e;break}Et=vt}}}var At=C.alternate;if(At!==null){var kt=At.child;if(kt!==null){At.child=null;do{var Ur=kt.sibling;kt.sibling=null,kt=Ur}while(kt!==null)}}Et=C}}if((C.subtreeFlags&2064)!==0&&z!==null)z.return=C,Et=z;else e:for(;Et!==null;){if(C=Et,(C.flags&2048)!==0)switch(C.tag){case 0:case 11:case 15:tm(9,C,C.return)}var fe=C.sibling;if(fe!==null){fe.return=C.return,Et=fe;break e}Et=C.return}}var le=u.current;for(Et=le;Et!==null;){z=Et;var Te=z.child;if((z.subtreeFlags&2064)!==0&&Te!==null)Te.return=z,Et=Te;else e:for(z=le;Et!==null;){if(ae=Et,(ae.flags&2048)!==0)try{switch(ae.tag){case 0:case 11:case 15:Y1(9,ae)}}catch(Mt){Lr(ae,ae.return,Mt)}if(ae===z){Et=null;break e}var nt=ae.sibling;if(nt!==null){nt.return=ae.return,Et=nt;break e}Et=ae.return}}if(In=T,Nc(),Br&&typeof Br.onPostCommitFiberRoot=="function")try{Br.onPostCommitFiberRoot(Ys,u)}catch{}E=!0}return E}finally{vn=p,ba.transition=d}}return!1}function D4(u,d,p){d=pf(p,d),d=e4(u,d,1),u=Oc(u,d,1),d=ys(),u!==null&&(nh(u,1,d),Ps(u,d))}function Lr(u,d,p){if(u.tag===3)D4(u,u,p);else for(;d!==null;){if(d.tag===3){D4(d,u,p);break}else if(d.tag===1){var E=d.stateNode;if(typeof d.type.getDerivedStateFromError=="function"||typeof E.componentDidCatch=="function"&&(Fc===null||!Fc.has(E))){u=pf(p,u),u=t4(d,u,1),d=Oc(d,u,1),u=ys(),d!==null&&(nh(d,1,u),Ps(d,u));break}}d=d.return}}function oU(u,d,p){var E=u.pingCache;E!==null&&E.delete(d),d=ys(),u.pingedLanes|=u.suspendedLanes&p,_i===u&&(Fi&p)===p&&(ui===4||ui===3&&(Fi&130023424)===Fi&&500>Ye()-Q2?ph(u,0):J2|=p),Ps(u,d)}function F4(u,d){d===0&&((u.mode&1)===0?d=1:(d=Tc,Tc<<=1,(Tc&130023424)===0&&(Tc=4194304)));var p=ys();u=Pl(u,d),u!==null&&(nh(u,d,p),Ps(u,p))}function lU(u){var d=u.memoizedState,p=0;d!==null&&(p=d.retryLane),F4(u,p)}function cU(u,d){var p=0;switch(u.tag){case 13:var E=u.stateNode,T=u.memoizedState;T!==null&&(p=T.retryLane);break;case 19:E=u.stateNode;break;default:throw Error(t(314))}E!==null&&E.delete(d),F4(u,p)}var j4;j4=function(u,d,p){if(u!==null)if(u.memoizedProps!==d.pendingProps||As.current)Cs=!0;else{if((u.lanes&p)===0&&(d.flags&128)===0)return Cs=!1,Yz(u,d,p);Cs=(u.flags&131072)!==0}else Cs=!1,yr&&(d.flags&1048576)!==0&&yP(d,N1,d.index);switch(d.lanes=0,d.tag){case 2:var E=d.type;X1(u,d),u=d.pendingProps;var T=lf(d,Zi.current);gf(d,p),T=k2(null,d,E,u,T,p);var C=P2();return d.flags|=1,typeof T=="object"&&T!==null&&typeof T.render=="function"&&T.$$typeof===void 0?(d.tag=1,d.memoizedState=null,d.updateQueue=null,Is(E)?(C=!0,k1(d)):C=!1,d.memoizedState=T.state!==null&&T.state!==void 0?T.state:null,T2(d),T.updater=H1,d.stateNode=T,T._reactInternals=d,F2(d,E,u,p),d=B2(null,d,E,!0,C,p)):(d.tag=0,yr&&C&&f2(d),ps(null,d,T,p),d=d.child),d;case 16:E=d.elementType;e:{switch(X1(u,d),u=d.pendingProps,T=E._init,E=T(E._payload),d.type=E,T=d.tag=hU(E),u=eo(E,u),T){case 0:d=G2(null,d,E,u,p);break e;case 1:d=u4(null,d,E,u,p);break e;case 11:d=s4(null,d,E,u,p);break e;case 14:d=a4(null,d,E,eo(E.type,u),p);break e}throw Error(t(306,E,""))}return d;case 0:return E=d.type,T=d.pendingProps,T=d.elementType===E?T:eo(E,T),G2(u,d,E,T,p);case 1:return E=d.type,T=d.pendingProps,T=d.elementType===E?T:eo(E,T),u4(u,d,E,T,p);case 3:e:{if(h4(d),u===null)throw Error(t(387));E=d.pendingProps,C=d.memoizedState,T=C.element,RP(u,d),V1(d,E,null,p);var z=d.memoizedState;if(E=z.element,C.isDehydrated)if(C={element:E,isDehydrated:!1,cache:z.cache,pendingSuspenseBoundaries:z.pendingSuspenseBoundaries,transitions:z.transitions},d.updateQueue.baseState=C,d.memoizedState=C,d.flags&256){T=pf(Error(t(423)),d),d=d4(u,d,E,p,T);break e}else if(E!==T){T=pf(Error(t(424)),d),d=d4(u,d,E,p,T);break e}else for(na=kc(d.stateNode.containerInfo.firstChild),ta=d,yr=!0,Qa=null,p=SP(d,null,E,p),d.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling;else{if(hf(),E===T){d=Nl(u,d,p);break e}ps(u,d,E,p)}d=d.child}return d;case 5:return CP(d),u===null&&p2(d),E=d.type,T=d.pendingProps,C=u!==null?u.memoizedProps:null,z=T.children,o2(E,T)?z=null:C!==null&&o2(E,C)&&(d.flags|=32),c4(u,d),ps(u,d,z,p),d.child;case 6:return u===null&&p2(d),null;case 13:return f4(u,d,p);case 4:return S2(d,d.stateNode.containerInfo),E=d.pendingProps,u===null?d.child=df(d,null,E,p):ps(u,d,E,p),d.child;case 11:return E=d.type,T=d.pendingProps,T=d.elementType===E?T:eo(E,T),s4(u,d,E,T,p);case 7:return ps(u,d,d.pendingProps,p),d.child;case 8:return ps(u,d,d.pendingProps.children,p),d.child;case 12:return ps(u,d,d.pendingProps.children,p),d.child;case 10:e:{if(E=d.type._context,T=d.pendingProps,C=d.memoizedProps,z=T.value,cr(D1,E._currentValue),E._currentValue=z,C!==null)if(Ja(C.value,z)){if(C.children===T.children&&!As.current){d=Nl(u,d,p);break e}}else for(C=d.child,C!==null&&(C.return=d);C!==null;){var ae=C.dependencies;if(ae!==null){z=C.child;for(var oe=ae.firstContext;oe!==null;){if(oe.context===E){if(C.tag===1){oe=Ml(-1,p&-p),oe.tag=2;var Ae=C.updateQueue;if(Ae!==null){Ae=Ae.shared;var Ke=Ae.pending;Ke===null?oe.next=oe:(oe.next=Ke.next,Ke.next=oe),Ae.pending=oe}}C.lanes|=p,oe=C.alternate,oe!==null&&(oe.lanes|=p),w2(C.return,p,d),ae.lanes|=p;break}oe=oe.next}}else if(C.tag===10)z=C.type===d.type?null:C.child;else if(C.tag===18){if(z=C.return,z===null)throw Error(t(341));z.lanes|=p,ae=z.alternate,ae!==null&&(ae.lanes|=p),w2(z,p,d),z=C.sibling}else z=C.child;if(z!==null)z.return=C;else for(z=C;z!==null;){if(z===d){z=null;break}if(C=z.sibling,C!==null){C.return=z.return,z=C;break}z=z.return}C=z}ps(u,d,T.children,p),d=d.child}return d;case 9:return T=d.type,E=d.pendingProps.children,gf(d,p),T=Ta(T),E=E(T),d.flags|=1,ps(u,d,E,p),d.child;case 14:return E=d.type,T=eo(E,d.pendingProps),T=eo(E.type,T),a4(u,d,E,T,p);case 15:return o4(u,d,d.type,d.pendingProps,p);case 17:return E=d.type,T=d.pendingProps,T=d.elementType===E?T:eo(E,T),X1(u,d),d.tag=1,Is(E)?(u=!0,k1(d)):u=!1,gf(d,p),JP(d,E,T),F2(d,E,T,p),B2(null,d,E,!0,u,p);case 19:return m4(u,d,p);case 22:return l4(u,d,p)}throw Error(t(156,d.tag))};function V4(u,d){return Xe(u,d)}function uU(u,d,p,E){this.tag=u,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=d,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=E,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ra(u,d,p,E){return new uU(u,d,p,E)}function oT(u){return u=u.prototype,!(!u||!u.isReactComponent)}function hU(u){if(typeof u=="function")return oT(u)?1:0;if(u!=null){if(u=u.$$typeof,u===U)return 11;if(u===ke)return 14}return 2}function Bc(u,d){var p=u.alternate;return p===null?(p=Ra(u.tag,d,u.key,u.mode),p.elementType=u.elementType,p.type=u.type,p.stateNode=u.stateNode,p.alternate=u,u.alternate=p):(p.pendingProps=d,p.type=u.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=u.flags&14680064,p.childLanes=u.childLanes,p.lanes=u.lanes,p.child=u.child,p.memoizedProps=u.memoizedProps,p.memoizedState=u.memoizedState,p.updateQueue=u.updateQueue,d=u.dependencies,p.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext},p.sibling=u.sibling,p.index=u.index,p.ref=u.ref,p}function sx(u,d,p,E,T,C){var z=2;if(E=u,typeof u=="function")oT(u)&&(z=1);else if(typeof u=="string")z=5;else e:switch(u){case A:return xh(p.children,T,C,d);case I:z=8,T|=8;break;case P:return u=Ra(12,p,d,T|2),u.elementType=P,u.lanes=C,u;case j:return u=Ra(13,p,d,T),u.elementType=j,u.lanes=C,u;case Ee:return u=Ra(19,p,d,T),u.elementType=Ee,u.lanes=C,u;case Me:return ax(p,T,C,d);default:if(typeof u=="object"&&u!==null)switch(u.$$typeof){case D:z=10;break e;case L:z=9;break e;case U:z=11;break e;case ke:z=14;break e;case Be:z=16,E=null;break e}throw Error(t(130,u==null?u:typeof u,""))}return d=Ra(z,p,d,T),d.elementType=u,d.type=E,d.lanes=C,d}function xh(u,d,p,E){return u=Ra(7,u,E,d),u.lanes=p,u}function ax(u,d,p,E){return u=Ra(22,u,E,d),u.elementType=Me,u.lanes=p,u.stateNode={isHidden:!1},u}function lT(u,d,p){return u=Ra(6,u,null,d),u.lanes=p,u}function cT(u,d,p){return d=Ra(4,u.children!==null?u.children:[],u.key,d),d.lanes=p,d.stateNode={containerInfo:u.containerInfo,pendingChildren:null,implementation:u.implementation},d}function dU(u,d,p,E,T){this.tag=d,this.containerInfo=u,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Rg(0),this.expirationTimes=Rg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Rg(0),this.identifierPrefix=E,this.onRecoverableError=T,this.mutableSourceEagerHydrationData=null}function uT(u,d,p,E,T,C,z,ae,oe){return u=new dU(u,d,p,ae,oe),d===1?(d=1,C===!0&&(d|=8)):d=0,C=Ra(3,null,null,d),u.current=C,C.stateNode=u,C.memoizedState={element:E,isDehydrated:p,cache:null,transitions:null,pendingSuspenseBoundaries:null},T2(C),u}function fU(u,d,p){var E=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:G,key:E==null?null:""+E,children:u,containerInfo:d,implementation:p}}function G4(u){if(!u)return Mc;u=u._reactInternals;e:{if(Q(u)!==u||u.tag!==1)throw Error(t(170));var d=u;do{switch(d.tag){case 3:d=d.stateNode.context;break e;case 1:if(Is(d.type)){d=d.stateNode.__reactInternalMemoizedMergedChildContext;break e}}d=d.return}while(d!==null);throw Error(t(171))}if(u.tag===1){var p=u.type;if(Is(p))return gP(u,p,d)}return d}function B4(u,d,p,E,T,C,z,ae,oe){return u=uT(p,E,!0,u,T,C,z,ae,oe),u.context=G4(null),p=u.current,E=ys(),T=Vc(p),C=Ml(E,T),C.callback=d??null,Oc(p,C,T),u.current.lanes=T,nh(u,T,E),Ps(u,E),u}function ox(u,d,p,E){var T=d.current,C=ys(),z=Vc(T);return p=G4(p),d.context===null?d.context=p:d.pendingContext=p,d=Ml(C,z),d.payload={element:u},E=E===void 0?null:E,E!==null&&(d.callback=E),u=Oc(T,d,z),u!==null&&(ro(u,T,z,C),j1(u,T,z)),z}function lx(u){if(u=u.current,!u.child)return null;switch(u.child.tag){case 5:return u.child.stateNode;default:return u.child.stateNode}}function z4(u,d){if(u=u.memoizedState,u!==null&&u.dehydrated!==null){var p=u.retryLane;u.retryLane=p!==0&&p<d?p:d}}function hT(u,d){z4(u,d),(u=u.alternate)&&z4(u,d)}function gU(){return null}var U4=typeof reportError=="function"?reportError:function(u){console.error(u)};function dT(u){this._internalRoot=u}cx.prototype.render=dT.prototype.render=function(u){var d=this._internalRoot;if(d===null)throw Error(t(409));ox(u,d,null,null)},cx.prototype.unmount=dT.prototype.unmount=function(){var u=this._internalRoot;if(u!==null){this._internalRoot=null;var d=u.containerInfo;mh(function(){ox(null,u,null,null)}),d[Al]=null}};function cx(u){this._internalRoot=u}cx.prototype.unstable_scheduleHydration=function(u){if(u){var d=kg();u={blockedOn:null,target:u,priority:d};for(var p=0;p<Zs.length&&d!==0&&d<Zs[p].priority;p++);Zs.splice(p,0,u),p===0&&Wd(u)}};function fT(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)}function ux(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11&&(u.nodeType!==8||u.nodeValue!==" react-mount-point-unstable "))}function $4(){}function mU(u,d,p,E,T){if(T){if(typeof E=="function"){var C=E;E=function(){var Ae=lx(z);C.call(Ae)}}var z=B4(d,E,u,0,null,!1,!1,"",$4);return u._reactRootContainer=z,u[Al]=z.current,zg(u.nodeType===8?u.parentNode:u),mh(),z}for(;T=u.lastChild;)u.removeChild(T);if(typeof E=="function"){var ae=E;E=function(){var Ae=lx(oe);ae.call(Ae)}}var oe=uT(u,0,!1,null,null,!1,!1,"",$4);return u._reactRootContainer=oe,u[Al]=oe.current,zg(u.nodeType===8?u.parentNode:u),mh(function(){ox(d,oe,p,E)}),oe}function hx(u,d,p,E,T){var C=p._reactRootContainer;if(C){var z=C;if(typeof T=="function"){var ae=T;T=function(){var oe=lx(z);ae.call(oe)}}ox(d,z,u,T)}else z=mU(p,d,u,T,E);return lx(z)}Ig=function(u){switch(u.tag){case 3:var d=u.stateNode;if(d.current.memoizedState.isDehydrated){var p=Nn(d.pendingLanes);p!==0&&(Ag(d,p|1),Ps(d,Ye()),(In&6)===0&&(_f=Ye()+500,Nc()))}break;case 13:mh(function(){var E=Pl(u,1);if(E!==null){var T=ys();ro(E,u,1,T)}}),hT(u,1)}},Ud=function(u){if(u.tag===13){var d=Pl(u,134217728);if(d!==null){var p=ys();ro(d,u,134217728,p)}hT(u,134217728)}},Cg=function(u){if(u.tag===13){var d=Vc(u),p=Pl(u,d);if(p!==null){var E=ys();ro(p,u,d,E)}hT(u,d)}},kg=function(){return vn},Pg=function(u,d){var p=vn;try{return vn=u,d()}finally{vn=p}},Ft=function(u,d,p){switch(d){case"input":if(ot(u,p),d=p.name,p.type==="radio"&&d!=null){for(p=u;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll("input[name="+JSON.stringify(""+d)+'][type="radio"]'),d=0;d<p.length;d++){var E=p[d];if(E!==u&&E.form===u.form){var T=I1(E);if(!T)throw Error(t(90));wt(E),ot(E,T)}}}break;case"textarea":Tr(u,p);break;case"select":d=p.value,d!=null&&sr(u,!!p.multiple,d,!1)}},ne=iT,he=mh;var pU={usingClientEntryPoint:!1,Events:[Wg,af,I1,re,ee,iT]},sm={findFiberByHostInstance:oh,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},yU={bundleType:sm.bundleType,version:sm.version,rendererPackageName:sm.rendererPackageName,rendererConfig:sm.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:M.ReactCurrentDispatcher,findHostInstanceByFiber:function(u){return u=Se(u),u===null?null:u.stateNode},findFiberByHostInstance:sm.findFiberByHostInstance||gU,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var dx=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!dx.isDisabled&&dx.supportsFiber)try{Ys=dx.inject(yU),Br=dx}catch{}}return Ms.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=pU,Ms.createPortal=function(u,d){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!fT(d))throw Error(t(200));return fU(u,d,null,p)},Ms.createRoot=function(u,d){if(!fT(u))throw Error(t(299));var p=!1,E="",T=U4;return d!=null&&(d.unstable_strictMode===!0&&(p=!0),d.identifierPrefix!==void 0&&(E=d.identifierPrefix),d.onRecoverableError!==void 0&&(T=d.onRecoverableError)),d=uT(u,1,!1,null,null,p,!1,E,T),u[Al]=d.current,zg(u.nodeType===8?u.parentNode:u),new dT(d)},Ms.findDOMNode=function(u){if(u==null)return null;if(u.nodeType===1)return u;var d=u._reactInternals;if(d===void 0)throw typeof u.render=="function"?Error(t(188)):(u=Object.keys(u).join(","),Error(t(268,u)));return u=Se(d),u=u===null?null:u.stateNode,u},Ms.flushSync=function(u){return mh(u)},Ms.hydrate=function(u,d,p){if(!ux(d))throw Error(t(200));return hx(null,u,d,!0,p)},Ms.hydrateRoot=function(u,d,p){if(!fT(u))throw Error(t(405));var E=p!=null&&p.hydratedSources||null,T=!1,C="",z=U4;if(p!=null&&(p.unstable_strictMode===!0&&(T=!0),p.identifierPrefix!==void 0&&(C=p.identifierPrefix),p.onRecoverableError!==void 0&&(z=p.onRecoverableError)),d=B4(d,null,u,1,p??null,T,!1,C,z),u[Al]=d.current,zg(u),E)for(u=0;u<E.length;u++)p=E[u],T=p._getVersion,T=T(p._source),d.mutableSourceEagerHydrationData==null?d.mutableSourceEagerHydrationData=[p,T]:d.mutableSourceEagerHydrationData.push(p,T);return new cx(d)},Ms.render=function(u,d,p){if(!ux(d))throw Error(t(200));return hx(null,u,d,!1,p)},Ms.unmountComponentAtNode=function(u){if(!ux(u))throw Error(t(40));return u._reactRootContainer?(mh(function(){hx(null,null,u,!1,function(){u._reactRootContainer=null,u[Al]=null})}),!0):!1},Ms.unstable_batchedUpdates=iT,Ms.unstable_renderSubtreeIntoContainer=function(u,d,p,E){if(!ux(p))throw Error(t(200));if(u==null||u._reactInternals===void 0)throw Error(t(38));return hx(u,d,p,!1,E)},Ms.version="18.3.1-next-f1338f8080-20240426",Ms}var J4;function bU(){if(J4)return pT.exports;J4=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),pT.exports=SU(),pT.exports}var Q4;function RU(){if(Q4)return fx;Q4=1;var n=bU();return fx.createRoot=n.createRoot,fx.hydrateRoot=n.hydrateRoot,fx}var AU=RU();const IU=QR(AU);var X=my();const CU=QR(X),Os={ADD:"add",REMOVE:"remove"},P0={PROPERTYCHANGE:"propertychange"},Ht={CHANGE:"change",ERROR:"error",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",TOUCHMOVE:"touchmove",WHEEL:"wheel"};class py{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function kU(n,e,t){let r,i;t=t||Xl;let s=0,a=n.length,o=!1;for(;s<a;)r=s+(a-s>>1),i=+t(n[r],e),i<0?s=r+1:(a=r,o=!i);return o?s:~s}function Xl(n,e){return n>e?1:n<e?-1:0}function vD(n,e){return n<e?1:n>e?-1:0}function pw(n,e,t){if(n[0]<=e)return 0;const r=n.length;if(e<=n[r-1])return r-1;if(typeof t=="function"){for(let i=1;i<r;++i){const s=n[i];if(s===e)return i;if(s<e)return t(e,n[i-1],s)>0?i-1:i}return r-1}if(t>0){for(let i=1;i<r;++i)if(n[i]<e)return i-1;return r-1}if(t<0){for(let i=1;i<r;++i)if(n[i]<=e)return i;return r-1}for(let i=1;i<r;++i){if(n[i]==e)return i;if(n[i]<e)return n[i-1]-e<e-n[i]?i-1:i}return r-1}function PU(n,e,t){for(;e<t;){const r=n[e];n[e]=n[t],n[t]=r,++e,--t}}function Bn(n,e){const t=Array.isArray(e)?e:[e],r=t.length;for(let i=0;i<r;i++)n[n.length]=t[i]}function fc(n,e){const t=n.length;if(t!==e.length)return!1;for(let r=0;r<t;r++)if(n[r]!==e[r])return!1;return!0}function MU(n,e,t){const r=e||Xl;return n.every(function(i,s){if(s===0)return!0;const a=r(n[s-1],i);return!(a>0||a===0)})}function xp(){return!0}function yw(){return!1}function _p(){}function wD(n){let e,t,r;return function(){const i=Array.prototype.slice.call(arguments);return(!t||this!==r||!fc(i,t))&&(r=this,t=i,e=n.apply(this,arguments)),e}}function ED(n){function e(){let t;try{t=n()}catch(r){return Promise.reject(r)}return t instanceof Promise?t:Promise.resolve(t)}return e()}function og(n){for(const e in n)delete n[e]}function nd(n){let e;for(e in n)return!1;return!e}class pl{constructor(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}let lg=class extends py{constructor(e){super(),this.eventTarget_=e,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(e,t){if(!e||!t)return;const r=this.listeners_||(this.listeners_={}),i=r[e]||(r[e]=[]);i.includes(t)||i.push(t)}dispatchEvent(e){const t=typeof e=="string",r=t?e:e.type,i=this.listeners_&&this.listeners_[r];if(!i)return;const s=t?new pl(e):e;s.target||(s.target=this.eventTarget_||this);const a=this.dispatching_||(this.dispatching_={}),o=this.pendingRemovals_||(this.pendingRemovals_={});r in a||(a[r]=0,o[r]=0),++a[r];let l;for(let c=0,h=i.length;c<h;++c)if("handleEvent"in i[c]?l=i[c].handleEvent(s):l=i[c].call(this,s),l===!1||s.propagationStopped){l=!1;break}if(--a[r]===0){let c=o[r];for(delete o[r];c--;)this.removeEventListener(r,_p);delete a[r]}return l}disposeInternal(){this.listeners_&&og(this.listeners_)}getListeners(e){return this.listeners_&&this.listeners_[e]||void 0}hasListener(e){return this.listeners_?e?e in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(e,t){if(!this.listeners_)return;const r=this.listeners_[e];if(!r)return;const i=r.indexOf(t);i!==-1&&(this.pendingRemovals_&&e in this.pendingRemovals_?(r[i]=_p,++this.pendingRemovals_[e]):(r.splice(i,1),r.length===0&&delete this.listeners_[e]))}};function fn(n,e,t,r,i){if(i){const a=t;t=function(o){return n.removeEventListener(e,t),a.call(r??this,o)}}else r&&r!==n&&(t=t.bind(r));const s={target:n,type:e,listener:t};return n.addEventListener(e,t),s}function P_(n,e,t,r){return fn(n,e,t,r,!0)}function or(n){n&&n.target&&(n.target.removeEventListener(n.type,n.listener),og(n))}class yy extends lg{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(Ht.CHANGE)}getRevision(){return this.revision_}onInternal(e,t){if(Array.isArray(e)){const r=e.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=fn(this,e[s],t);return i}return fn(this,e,t)}onceInternal(e,t){let r;if(Array.isArray(e)){const i=e.length;r=new Array(i);for(let s=0;s<i;++s)r[s]=P_(this,e[s],t)}else r=P_(this,e,t);return t.ol_key=r,r}unInternal(e,t){const r=t.ol_key;if(r)NU(r);else if(Array.isArray(e))for(let i=0,s=e.length;i<s;++i)this.removeEventListener(e[i],t);else this.removeEventListener(e,t)}}yy.prototype.on;yy.prototype.once;yy.prototype.un;function NU(n){if(Array.isArray(n))for(let e=0,t=n.length;e<t;++e)or(n[e]);else or(n)}function Wt(){throw new Error("Unimplemented abstract method.")}let LU=0;function Bt(n){return n.ol_uid||(n.ol_uid=String(++LU))}class eM extends pl{constructor(e,t,r){super(e),this.key=t,this.oldValue=r}}class yl extends yy{constructor(e){super(),this.on,this.once,this.un,Bt(this),this.values_=null,e!==void 0&&this.setProperties(e)}get(e){let t;return this.values_&&this.values_.hasOwnProperty(e)&&(t=this.values_[e]),t}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(e,t){let r;r=`change:${e}`,this.hasListener(r)&&this.dispatchEvent(new eM(r,e,t)),r=P0.PROPERTYCHANGE,this.hasListener(r)&&this.dispatchEvent(new eM(r,e,t))}addChangeListener(e,t){this.addEventListener(`change:${e}`,t)}removeChangeListener(e,t){this.removeEventListener(`change:${e}`,t)}set(e,t,r){const i=this.values_||(this.values_={});if(r)i[e]=t;else{const s=i[e];i[e]=t,s!==t&&this.notify(e,s)}}setProperties(e,t){for(const r in e)this.set(r,e[r],t)}applyProperties(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}unset(e,t){if(this.values_&&e in this.values_){const r=this.values_[e];delete this.values_[e],nd(this.values_)&&(this.values_=null),t||this.notify(e,r)}}}const tM={LENGTH:"length"};class gx extends pl{constructor(e,t,r){super(e),this.element=t,this.index=r}}class La extends yl{constructor(e,t){if(super(),this.on,this.once,this.un,t=t||{},this.unique_=!!t.unique,this.array_=e??[],this.unique_)for(let r=1,i=this.array_.length;r<i;++r)this.assertUnique_(this.array_[r],r);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(e){for(let t=0,r=e.length;t<r;++t)this.push(e[t]);return this}forEach(e){const t=this.array_;for(let r=0,i=t.length;r<i;++r)e(t[r],r,t)}getArray(){return this.array_}item(e){return this.array_[e]}getLength(){return this.get(tM.LENGTH)}insertAt(e,t){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t),this.array_.splice(e,0,t),this.updateLength_(),this.dispatchEvent(new gx(Os.ADD,t,e))}pop(){return this.removeAt(this.getLength()-1)}push(e){const t=this.getLength();return this.insertAt(t,e),this.getLength()}remove(e){const t=this.array_;for(let r=0,i=t.length;r<i;++r)if(t[r]===e)return this.removeAt(r)}removeAt(e){if(e<0||e>=this.getLength())return;const t=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new gx(Os.REMOVE,t,e)),t}setAt(e,t){const r=this.getLength();if(e>=r){this.insertAt(e,t);return}if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t,e);const i=this.array_[e];this.array_[e]=t,this.dispatchEvent(new gx(Os.REMOVE,i,e)),this.dispatchEvent(new gx(Os.ADD,t,e))}updateLength_(){this.set(tM.LENGTH,this.array_.length)}assertUnique_(e,t){const r=this.array_;for(let i=0,s=r.length;i<s;++i)if(r[i]===e&&i!==t)throw new Error("Duplicate item added to a unique collection")}}function bn(n,e){if(!n)throw new Error(e)}let _r=class TD extends yl{constructor(e){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),e)if(typeof e.getSimplifiedGeometry=="function"){const t=e;this.setGeometry(t)}else{const t=e;this.setProperties(t)}}clone(){const e=new TD(this.hasProperties()?this.getProperties():null);e.setGeometryName(this.getGeometryName());const t=this.getGeometry();t&&e.setGeometry(t.clone());const r=this.getStyle();return r&&e.setStyle(r),e}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(or(this.geometryChangeKey_),this.geometryChangeKey_=null);const e=this.getGeometry();e&&(this.geometryChangeKey_=fn(e,Ht.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(e){this.set(this.geometryName_,e)}setStyle(e){this.style_=e,this.styleFunction_=e?OU(e):void 0,this.changed()}setId(e){this.id_=e,this.changed()}setGeometryName(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}};function OU(n){if(typeof n=="function")return n;let e;return Array.isArray(n)?e=n:(bn(typeof n.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[n]),function(){return e}}const Ei={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function tb(n){const e=Us();for(let t=0,r=n.length;t<r;++t)jm(e,n[t]);return e}function M0(n,e,t){return t?(t[0]=n[0]-e,t[1]=n[1]-e,t[2]=n[2]+e,t[3]=n[3]+e,t):[n[0]-e,n[1]-e,n[2]+e,n[3]+e]}function SD(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n.slice()}function bd(n,e,t){let r,i;return e<n[0]?r=n[0]-e:n[2]<e?r=e-n[2]:r=0,t<n[1]?i=n[1]-t:n[3]<t?i=t-n[3]:i=0,r*r+i*i}function rc(n,e){return eA(n,e[0],e[1])}function lu(n,e){return n[0]<=e[0]&&e[2]<=n[2]&&n[1]<=e[1]&&e[3]<=n[3]}function eA(n,e,t){return n[0]<=e&&e<=n[2]&&n[1]<=t&&t<=n[3]}function nb(n,e){const t=n[0],r=n[1],i=n[2],s=n[3],a=e[0],o=e[1];let l=Ei.UNKNOWN;return a<t?l=l|Ei.LEFT:a>i&&(l=l|Ei.RIGHT),o<r?l=l|Ei.BELOW:o>s&&(l=l|Ei.ABOVE),l===Ei.UNKNOWN&&(l=Ei.INTERSECTING),l}function Us(){return[1/0,1/0,-1/0,-1/0]}function ku(n,e,t,r,i){return i?(i[0]=n,i[1]=e,i[2]=t,i[3]=r,i):[n,e,t,r]}function xy(n){return ku(1/0,1/0,-1/0,-1/0,n)}function bD(n,e){const t=n[0],r=n[1];return ku(t,r,t,r,e)}function tA(n,e,t,r,i){const s=xy(i);return AD(s,n,e,t,r)}function rd(n,e){return n[0]==e[0]&&n[2]==e[2]&&n[1]==e[1]&&n[3]==e[3]}function RD(n,e){return e[0]<n[0]&&(n[0]=e[0]),e[2]>n[2]&&(n[2]=e[2]),e[1]<n[1]&&(n[1]=e[1]),e[3]>n[3]&&(n[3]=e[3]),n}function jm(n,e){e[0]<n[0]&&(n[0]=e[0]),e[0]>n[2]&&(n[2]=e[0]),e[1]<n[1]&&(n[1]=e[1]),e[1]>n[3]&&(n[3]=e[1])}function AD(n,e,t,r,i){for(;t<r;t+=i)DU(n,e[t],e[t+1]);return n}function DU(n,e,t){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}function ID(n,e){let t;return t=e(xw(n)),t||(t=e(_w(n)),t)||(t=e(vw(n)),t)||(t=e(Rd(n)),t)?t:!1}function rb(n){let e=0;return Ad(n)||(e=gn(n)*ei(n)),e}function xw(n){return[n[0],n[1]]}function _w(n){return[n[2],n[1]]}function ul(n){return[(n[0]+n[2])/2,(n[1]+n[3])/2]}function FU(n,e){let t;if(e==="bottom-left")t=xw(n);else if(e==="bottom-right")t=_w(n);else if(e==="top-left")t=Rd(n);else if(e==="top-right")t=vw(n);else throw new Error("Invalid corner");return t}function M_(n,e,t,r,i){const[s,a,o,l,c,h,f,m]=nA(n,e,t,r);return ku(Math.min(s,o,c,f),Math.min(a,l,h,m),Math.max(s,o,c,f),Math.max(a,l,h,m),i)}function nA(n,e,t,r){const i=e*r[0]/2,s=e*r[1]/2,a=Math.cos(t),o=Math.sin(t),l=i*a,c=i*o,h=s*a,f=s*o,m=n[0],y=n[1];return[m-l+f,y-c-h,m-l-f,y-c+h,m+l-f,y+c+h,m+l+f,y+c-h,m-l+f,y-c-h]}function ei(n){return n[3]-n[1]}function Va(n,e,t){const r=t||Us();return Es(n,e)?(n[0]>e[0]?r[0]=n[0]:r[0]=e[0],n[1]>e[1]?r[1]=n[1]:r[1]=e[1],n[2]<e[2]?r[2]=n[2]:r[2]=e[2],n[3]<e[3]?r[3]=n[3]:r[3]=e[3]):xy(r),r}function Rd(n){return[n[0],n[3]]}function vw(n){return[n[2],n[3]]}function gn(n){return n[2]-n[0]}function Es(n,e){return n[0]<=e[2]&&n[2]>=e[0]&&n[1]<=e[3]&&n[3]>=e[1]}function Ad(n){return n[2]<n[0]||n[3]<n[1]}function jU(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n}function VU(n,e,t){let r=!1;const i=nb(n,e),s=nb(n,t);if(i===Ei.INTERSECTING||s===Ei.INTERSECTING)r=!0;else{const a=n[0],o=n[1],l=n[2],c=n[3],h=e[0],f=e[1],m=t[0],y=t[1],x=(y-f)/(m-h);let _,w;s&Ei.ABOVE&&!(i&Ei.ABOVE)&&(_=m-(y-c)/x,r=_>=a&&_<=l),!r&&s&Ei.RIGHT&&!(i&Ei.RIGHT)&&(w=y-(m-l)*x,r=w>=o&&w<=c),!r&&s&Ei.BELOW&&!(i&Ei.BELOW)&&(_=m-(y-o)/x,r=_>=a&&_<=l),!r&&s&Ei.LEFT&&!(i&Ei.LEFT)&&(w=y-(m-a)*x,r=w>=o&&w<=c)}return r}function CD(n,e){const t=e.getExtent(),r=ul(n);if(e.canWrapX()&&(r[0]<t[0]||r[0]>=t[2])){const i=gn(t),a=Math.floor((r[0]-t[0])/i)*i;n[0]-=a,n[2]-=a}return n}function kD(n,e,t){if(e.canWrapX()){const r=e.getExtent();if(!isFinite(n[0])||!isFinite(n[2]))return[[r[0],n[1],r[2],n[3]]];CD(n,e);const i=gn(r);if(gn(n)>i&&!t)return[[r[0],n[1],r[2],n[3]]];if(n[0]<r[0])return[[n[0]+i,n[1],r[2],n[3]],[r[0],n[1],n[2],n[3]]];if(n[2]>r[2])return[[n[0],n[1],r[2],n[3]],[r[0],n[1],n[2]-i,n[3]]]}return[n]}function ur(n,e,t){return Math.min(Math.max(n,e),t)}function GU(n,e,t,r,i,s){const a=i-t,o=s-r;if(a!==0||o!==0){const l=((n-t)*a+(e-r)*o)/(a*a+o*o);l>1?(t=i,r=s):l>0&&(t+=a*l,r+=o*l)}return Xh(n,e,t,r)}function Xh(n,e,t,r){const i=t-n,s=r-e;return i*i+s*s}function BU(n){const e=n.length;for(let r=0;r<e;r++){let i=r,s=Math.abs(n[r][r]);for(let o=r+1;o<e;o++){const l=Math.abs(n[o][r]);l>s&&(s=l,i=o)}if(s===0)return null;const a=n[i];n[i]=n[r],n[r]=a;for(let o=r+1;o<e;o++){const l=-n[o][r]/n[r][r];for(let c=r;c<e+1;c++)r==c?n[o][c]=0:n[o][c]+=l*n[r][c]}}const t=new Array(e);for(let r=e-1;r>=0;r--){t[r]=n[r][e]/n[r][r];for(let i=r-1;i>=0;i--)n[i][e]-=n[i][r]*t[r]}return t}function nM(n){return n*180/Math.PI}function ql(n){return n*Math.PI/180}function vu(n,e){const t=n%e;return t*e<0?t+e:t}function oa(n,e,t){return n+t*(e-n)}function _y(n,e){const t=Math.pow(10,e);return Math.round(n*t)/t}function N_(n,e){return Math.round(_y(n,e))}function mx(n,e){return Math.floor(_y(n,e))}function cu(n,e){return Math.ceil(_y(n,e))}function ib(n,e,t){if(n>=e&&n<t)return n;const r=t-e;return((n-e)%r+r)%r+e}function om(n,e,t){const r=""+n;let i=r.indexOf(".");return i=i===-1?r.length:i,i>e?r:new Array(1+e-i).join("0")+r}function PD(n,e){const t=(""+n).split("."),r=(""+e).split(".");for(let i=0;i<Math.max(t.length,r.length);i++){const s=parseInt(t[i]||"0",10),a=parseInt(r[i]||"0",10);if(s>a)return 1;if(a>s)return-1}return 0}function zU(n,e){return n[0]+=+e[0],n[1]+=+e[1],n}function L_(n,e){let t=!0;for(let r=n.length-1;r>=0;--r)if(n[r]!=e[r]){t=!1;break}return t}function rA(n,e){const t=Math.cos(e),r=Math.sin(e),i=n[0]*t-n[1]*r,s=n[1]*t+n[0]*r;return n[0]=i,n[1]=s,n}function UU(n,e){return n[0]*=e,n[1]*=e,n}function MD(n,e){if(e.canWrapX()){const t=gn(e.getExtent()),r=ND(n,e,t);r&&(n[0]-=r*t)}return n}function ND(n,e,t){const r=e.getExtent();let i=0;return e.canWrapX()&&(n[0]<r[0]||n[0]>r[2])&&(t=t||gn(r),i=Math.floor((n[0]-r[0])/t)),i}function LD(...n){console.warn(...n)}const N0={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};let ww=class{constructor(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||N0[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(e){this.defaultTileGrid_=e}setExtent(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)}setWorldExtent(e){this.worldExtent_=e}setGetPointResolution(e){this.getPointResolutionFunc_=e}getPointResolutionFunc(){return this.getPointResolutionFunc_}};const vy=6378137,n0=Math.PI*vy,$U=[-n0,-n0,n0,n0],WU=[-180,-85,180,85],px=vy*Math.log(Math.tan(Math.PI/2));class wf extends ww{constructor(e){super({code:e,units:"m",extent:$U,global:!0,worldExtent:WU,getPointResolution:function(t,r){return t/Math.cosh(r[1]/vy)}})}}const rM=[new wf("EPSG:3857"),new wf("EPSG:102100"),new wf("EPSG:102113"),new wf("EPSG:900913"),new wf("http://www.opengis.net/def/crs/EPSG/0/3857"),new wf("http://www.opengis.net/gml/srs/epsg.xml#3857")];function HU(n,e,t,r){const i=n.length;t=t>1?t:2,r=r??t,e===void 0&&(t>2?e=n.slice():e=new Array(i));for(let s=0;s<i;s+=r){e[s]=n0*n[s]/180;let a=vy*Math.log(Math.tan(Math.PI*(+n[s+1]+90)/360));a>px?a=px:a<-px&&(a=-px),e[s+1]=a}return e}function KU(n,e,t,r){const i=n.length;t=t>1?t:2,r=r??t,e===void 0&&(t>2?e=n.slice():e=new Array(i));for(let s=0;s<i;s+=r)e[s]=180*n[s]/n0,e[s+1]=360*Math.atan(Math.exp(n[s+1]/vy))/Math.PI-90;return e}const XU=6378137,iM=[-180,-90,180,90],qU=Math.PI*XU/180;class _h extends ww{constructor(e,t){super({code:e,units:"degrees",extent:iM,axisOrientation:t,global:!0,metersPerUnit:qU,worldExtent:iM})}}const sM=[new _h("CRS:84"),new _h("EPSG:4326","neu"),new _h("urn:ogc:def:crs:OGC:1.3:CRS84"),new _h("urn:ogc:def:crs:OGC:2:84"),new _h("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new _h("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new _h("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let sb={};function n_(n){return sb[n]||sb[n.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function YU(n,e){sb[n]=e}let g0={};function id(n,e,t){const r=n.getCode(),i=e.getCode();r in g0||(g0[r]={}),g0[r][i]=t}function r_(n,e){return n in g0&&e in g0[n]?g0[n][e]:null}const O_=.9996,Ga=.00669438,Ew=Ga*Ga,Tw=Ew*Ga,jh=Ga/(1-Ga),aM=Math.sqrt(1-Ga),L0=(1-aM)/(1+aM),OD=L0*L0,iA=OD*L0,sA=iA*L0,DD=sA*L0,FD=1-Ga/4-3*Ew/64-5*Tw/256,ZU=3*Ga/8+3*Ew/32+45*Tw/1024,JU=15*Ew/256+45*Tw/1024,QU=35*Tw/3072,e$=3/2*L0-27/32*iA+269/512*DD,t$=21/16*OD-55/32*sA,n$=151/96*iA-417/128*DD,r$=1097/512*sA,D_=6378137;function i$(n,e,t){const r=n-5e5,a=(t.north?e:e-1e7)/O_/(D_*FD),o=a+e$*Math.sin(2*a)+t$*Math.sin(4*a)+n$*Math.sin(6*a)+r$*Math.sin(8*a),l=Math.sin(o),c=l*l,h=Math.cos(o),f=l/h,m=f*f,y=m*m,x=1-Ga*c,_=Math.sqrt(1-Ga*c),w=D_/_,S=(1-Ga)/x,b=jh*h**2,R=b*b,M=r/(w*O_),O=M*M,G=O*M,A=G*M,I=A*M,P=I*M,D=o-f/S*(O/2-A/24*(5+3*m+10*b-4*R-9*jh))+P/720*(61+90*m+298*b+45*y-252*jh-3*R);let L=(M-G/6*(1+2*m+b)+I/120*(5-2*b+28*m-3*R+8*jh+24*y))/h;return L=ib(L+ql(jD(t.number)),-Math.PI,Math.PI),[nM(L),nM(D)]}const oM=-80,lM=84,s$=-180,a$=180;function o$(n,e,t){n=ib(n,s$,a$),e<oM?e=oM:e>lM&&(e=lM);const r=ql(e),i=Math.sin(r),s=Math.cos(r),a=i/s,o=a*a,l=o*o,c=ql(n),h=jD(t.number),f=ql(h),m=D_/Math.sqrt(1-Ga*i**2),y=jh*s**2,x=s*ib(c-f,-Math.PI,Math.PI),_=x*x,w=_*x,S=w*x,b=S*x,R=b*x,M=D_*(FD*r-ZU*Math.sin(2*r)+JU*Math.sin(4*r)-QU*Math.sin(6*r)),O=O_*m*(x+w/6*(1-o+y)+b/120*(5-18*o+l+72*y-58*jh))+5e5;let G=O_*(M+m*a*(_/2+S/24*(5-o+9*y+4*y**2)+R/720*(61-58*o+l+600*y-330*jh)));return t.north||(G+=1e7),[O,G]}function jD(n){return(n-1)*6-180+3}const l$=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function VD(n){let e=0;for(const i of l$){const s=n.match(i);if(s){e=parseInt(s[1]);break}}if(!e)return null;let t=0,r=!1;return e>32700&&e<32761?t=e-32700:e>32600&&e<32661&&(r=!0,t=e-32600),t?{number:t,north:r}:null}function cM(n,e){return function(t,r,i,s){const a=t.length;i=i>1?i:2,s=s??i,r||(i>2?r=t.slice():r=new Array(a));for(let o=0;o<a;o+=s){const l=t[o],c=t[o+1],h=n(l,c,e);r[o]=h[0],r[o+1]=h[1]}return r}}function c$(n){return VD(n)?new ww({code:n,units:"m"}):null}function u$(n){const e=VD(n.getCode());return e?{forward:cM(o$,e),inverse:cM(i$,e)}:null}const h$=63710088e-1;function uM(n,e,t){t=t||h$;const r=ql(n[1]),i=ql(e[1]),s=(i-r)/2,a=ql(e[0]-n[0])/2,o=Math.sin(s)*Math.sin(s)+Math.sin(a)*Math.sin(a)*Math.cos(r)*Math.cos(i);return 2*t*Math.atan2(Math.sqrt(o),Math.sqrt(1-o))}const d$=[u$],f$=[c$];let ab=!0;function GD(n){ab=!1}function aA(n,e){if(e!==void 0){for(let t=0,r=n.length;t<r;++t)e[t]=n[t];e=e}else e=n.slice();return e}function F_(n){YU(n.getCode(),n),id(n,n,aA)}function g$(n){n.forEach(F_)}function ir(n){if(typeof n!="string")return n;const e=n_(n);if(e)return e;for(const t of f$){const r=t(n);if(r)return r}return null}function j_(n,e,t,r){n=ir(n);let i;const s=n.getPointResolutionFunc();if(s){if(i=s(e,t),r&&r!==n.getUnits()){const a=n.getMetersPerUnit();a&&(i=i*a/N0[r])}}else{const a=n.getUnits();if(a=="degrees"&&!r||r=="degrees")i=e;else{const o=lA(n,ir("EPSG:4326"));if(!o&&a!=="degrees")i=e*n.getMetersPerUnit();else{let c=[t[0]-e/2,t[1],t[0]+e/2,t[1],t[0],t[1]-e/2,t[0],t[1]+e/2];c=o(c,c,2);const h=uM(c.slice(0,2),c.slice(2,4)),f=uM(c.slice(4,6),c.slice(6,8));i=(h+f)/2}const l=r?N0[r]:n.getMetersPerUnit();l!==void 0&&(i/=l)}}return i}function ob(n){g$(n),n.forEach(function(e){n.forEach(function(t){e!==t&&id(e,t,aA)})})}function m$(n,e,t,r){n.forEach(function(i){e.forEach(function(s){id(i,s,t),id(s,i,r)})})}function oA(n,e){return n?typeof n=="string"?ir(n):n:ir(e)}function lb(n){return(function(e,t,r,i){const s=e.length;r=r!==void 0?r:2,i=i??r,t=t!==void 0?t:new Array(s);for(let a=0;a<s;a+=i){const o=n(e.slice(a,a+r)),l=o.length;for(let c=0,h=i;c<h;++c)t[a+c]=c>=l?e[a+c]:o[c]}return t})}function p$(n,e,t,r){const i=ir(n),s=ir(e);id(i,s,lb(t)),id(s,i,lb(r))}function Ir(n,e){return GD(),wy(n,"EPSG:4326","EPSG:3857")}function En(n,e){const t=wy(n,"EPSG:3857","EPSG:4326"),r=t[0];return(r<-180||r>180)&&(t[0]=vu(r+180,360)-180),t}function qh(n,e){if(n===e)return!0;const t=n.getUnits()===e.getUnits();return(n.getCode()===e.getCode()||lA(n,e)===aA)&&t}function lA(n,e){const t=n.getCode(),r=e.getCode();let i=r_(t,r);if(i)return i;let s=null,a=null;for(const l of d$)s||(s=l(n)),a||(a=l(e));if(!s&&!a)return null;const o="EPSG:4326";if(a)if(s)i=_T(s.inverse,a.forward);else{const l=r_(t,o);l&&(i=_T(l,a.forward))}else{const l=r_(o,r);l&&(i=_T(s.inverse,l))}return i&&(F_(n),F_(e),id(n,e,i)),i}function _T(n,e){return function(t,r,i,s){return r=n(t,r,i,s),e(r,r,i,s)}}function vp(n,e){const t=ir(n),r=ir(e);return lA(t,r)}function wy(n,e,t){const r=vp(e,t);if(!r){const i=ir(e).getCode(),s=ir(t).getCode();throw new Error(`No transform available between ${i} and ${s}`)}return r(n,void 0,n.length)}function cb(n,e){return n}function Vl(n,e){return ab&&!L_(n,[0,0])&&n[0]>=-180&&n[0]<=180&&n[1]>=-90&&n[1]<=90&&(ab=!1,LD("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),n}function BD(n,e){return n}function Oa(n,e){return n}function hM(n,e,t){return function(r){let i,s;if(n.canWrapX()){const a=n.getExtent(),o=gn(a);r=r.slice(0),s=ND(r,n,o),s&&(r[0]=r[0]-s*o),r[0]=ur(r[0],a[0],a[2]),r[1]=ur(r[1],a[1],a[3]),i=t(r)}else i=t(r);return s&&e.canWrapX()&&(i[0]+=s*gn(e.getExtent())),i}}function y$(){ob(rM),ob(sM),m$(sM,rM,HU,KU)}y$();const cA=new Array(6);function ti(){return[1,0,0,1,0,0]}function x$(n){return bw(n,1,0,0,1,0,0)}function Sw(n,e){const t=n[0],r=n[1],i=n[2],s=n[3],a=n[4],o=n[5],l=e[0],c=e[1],h=e[2],f=e[3],m=e[4],y=e[5];return n[0]=t*l+i*c,n[1]=r*l+s*c,n[2]=t*h+i*f,n[3]=r*h+s*f,n[4]=t*m+i*y+a,n[5]=r*m+s*y+o,n}function bw(n,e,t,r,i,s,a){return n[0]=e,n[1]=t,n[2]=r,n[3]=i,n[4]=s,n[5]=a,n}function zD(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n}function kr(n,e){const t=e[0],r=e[1];return e[0]=n[0]*t+n[2]*r+n[4],e[1]=n[1]*t+n[3]*r+n[5],e}function _$(n,e){const t=Math.cos(e),r=Math.sin(e);return Sw(n,bw(cA,t,r,-r,t,0,0))}function dM(n,e,t){return Sw(n,bw(cA,e,0,0,t,0,0))}function UD(n,e,t){return Sw(n,bw(cA,1,0,0,1,e,t))}function $a(n,e,t,r,i,s,a,o){const l=Math.sin(s),c=Math.cos(s);return n[0]=r*c,n[1]=i*l,n[2]=-r*l,n[3]=i*c,n[4]=a*r*c-o*r*l+e,n[5]=a*i*l+o*i*c+t,n}function wp(n,e){const t=v$(e);bn(t!==0,"Transformation matrix cannot be inverted");const r=e[0],i=e[1],s=e[2],a=e[3],o=e[4],l=e[5];return n[0]=a/t,n[1]=-i/t,n[2]=-s/t,n[3]=r/t,n[4]=(s*l-a*o)/t,n[5]=-(r*l-i*o)/t,n}function v$(n){return n[0]*n[3]-n[1]*n[2]}const w$=[1e5,1e5,1e5,1e5,2,2];function E$(n){return"matrix("+n.join(", ")+")"}function ub(n){return n.substring(7,n.length-1).split(",").map(parseFloat)}function T$(n,e){const t=ub(n),r=ub(e);for(let i=0;i<6;++i)if(Math.round((t[i]-r[i])*w$[i])!==0)return!1;return!0}function tl(n,e,t,r,i,s,a){s=s||[],a=a||2;let o=0;for(let l=e;l<t;l+=r){const c=n[l],h=n[l+1];s[o++]=i[0]*c+i[2]*h+i[4],s[o++]=i[1]*c+i[3]*h+i[5];for(let f=2;f<a;f++)s[o++]=n[l+f]}return s&&s.length!=o&&(s.length=o),s}function $D(n,e,t,r,i,s,a){a=a||[];const o=Math.cos(i),l=Math.sin(i),c=s[0],h=s[1];let f=0;for(let m=e;m<t;m+=r){const y=n[m]-c,x=n[m+1]-h;a[f++]=c+y*o-x*l,a[f++]=h+y*l+x*o;for(let _=m+2;_<m+r;++_)a[f++]=n[_]}return a&&a.length!=f&&(a.length=f),a}function S$(n,e,t,r,i,s,a,o){o=o||[];const l=a[0],c=a[1];let h=0;for(let f=e;f<t;f+=r){const m=n[f]-l,y=n[f+1]-c;o[h++]=l+i*m,o[h++]=c+s*y;for(let x=f+2;x<f+r;++x)o[h++]=n[x]}return o&&o.length!=h&&(o.length=h),o}function b$(n,e,t,r,i,s,a){a=a||[];let o=0;for(let l=e;l<t;l+=r){a[o++]=n[l]+i,a[o++]=n[l+1]+s;for(let c=l+2;c<l+r;++c)a[o++]=n[c]}return a&&a.length!=o&&(a.length=o),a}const fM=ti(),R$=[NaN,NaN];class WD extends yl{constructor(){super(),this.extent_=Us(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=wD((e,t,r)=>{if(!r)return this.getSimplifiedGeometry(t);const i=this.clone();return i.applyTransform(r),i.getSimplifiedGeometry(t)})}simplifyTransformed(e,t){return this.simplifyTransformedInternal(this.getRevision(),e,t)}clone(){return Wt()}closestPointXY(e,t,r,i){return Wt()}containsXY(e,t){return this.closestPointXY(e,t,R$,Number.MIN_VALUE)===0}getClosestPoint(e,t){return t=t||[NaN,NaN],this.closestPointXY(e[0],e[1],t,1/0),t}intersectsCoordinate(e){return this.containsXY(e[0],e[1])}computeExtent(e){return Wt()}getExtent(e){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&xy(t),this.extentRevision_=this.getRevision()}return jU(this.extent_,e)}rotate(e,t){Wt()}scale(e,t,r){Wt()}simplify(e){return this.getSimplifiedGeometry(e*e)}getSimplifiedGeometry(e){return Wt()}getType(){return Wt()}applyTransform(e){Wt()}intersectsExtent(e){return Wt()}translate(e,t){Wt()}transform(e,t){const r=ir(e),i=r.getUnits()=="tile-pixels"?function(s,a,o){const l=r.getExtent(),c=r.getWorldExtent(),h=ei(c)/ei(l);$a(fM,c[0],c[3],h,-h,0,0,0);const f=tl(s,0,s.length,o,fM,a),m=vp(r,t);return m?m(f,f,o):f}:vp(r,t);return this.applyTransform(i),this}}class Id extends WD{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(e){return tA(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinates(){return Wt()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=this.getSimplifiedGeometryInternal(e);return t.getFlatCoordinates().length<this.flatCoordinates.length?t:(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getSimplifiedGeometryInternal(e){return this}getStride(){return this.stride}setFlatCoordinates(e,t){this.stride=gM(e),this.layout=e,this.flatCoordinates=t}setCoordinates(e,t){Wt()}setLayout(e,t,r){let i;if(e)i=gM(e);else{for(let s=0;s<r;++s){if(t.length===0){this.layout="XY",this.stride=2;return}t=t[0]}i=t.length,e=Cd(i)}this.layout=e,this.stride=i}applyTransform(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(e,t){const r=this.getFlatCoordinates();if(r){const i=this.getStride();$D(r,0,r.length,i,e,t,r),this.changed()}}scale(e,t,r){t===void 0&&(t=e),r||(r=ul(this.getExtent()));const i=this.getFlatCoordinates();if(i){const s=this.getStride();S$(i,0,i.length,s,e,t,r,i),this.changed()}}translate(e,t){const r=this.getFlatCoordinates();if(r){const i=this.getStride();b$(r,0,r.length,i,e,t,r),this.changed()}}}function Cd(n){let e;return n==2?e="XY":n==3?e="XYZ":n==4&&(e="XYZM"),e}function gM(n){let e;return n=="XY"?e=2:n=="XYZ"||n=="XYM"?e=3:n=="XYZM"&&(e=4),e}function A$(n,e,t){const r=n.getFlatCoordinates();if(!r)return null;const i=n.getStride();return tl(r,0,r.length,i,e,t)}function mM(n,e,t,r,i,s,a){const o=n[e],l=n[e+1],c=n[t]-o,h=n[t+1]-l;let f;if(c===0&&h===0)f=e;else{const m=((i-o)*c+(s-l)*h)/(c*c+h*h);if(m>1)f=t;else if(m>0){for(let y=0;y<r;++y)a[y]=oa(n[e+y],n[t+y],m);a.length=r;return}else f=e}for(let m=0;m<r;++m)a[m]=n[f+m];a.length=r}function uA(n,e,t,r,i){let s=n[e],a=n[e+1];for(e+=r;e<t;e+=r){const o=n[e],l=n[e+1],c=Xh(s,a,o,l);c>i&&(i=c),s=o,a=l}return i}function hA(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){const o=t[s];i=uA(n,e,o,r,i),e=o}return i}function I$(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){const o=t[s];i=hA(n,e,o,r,i),e=o[o.length-1]}return i}function dA(n,e,t,r,i,s,a,o,l,c,h){if(e==t)return c;let f,m;if(i===0){if(m=Xh(a,o,n[e],n[e+1]),m<c){for(f=0;f<r;++f)l[f]=n[e+f];return l.length=r,m}return c}h=h||[NaN,NaN];let y=e+r;for(;y<t;)if(mM(n,y-r,y,r,a,o,h),m=Xh(a,o,h[0],h[1]),m<c){for(c=m,f=0;f<r;++f)l[f]=h[f];l.length=r,y+=r}else y+=r*Math.max((Math.sqrt(m)-Math.sqrt(c))/i|0,1);if(s&&(mM(n,t-r,e,r,a,o,h),m=Xh(a,o,h[0],h[1]),m<c)){for(c=m,f=0;f<r;++f)l[f]=h[f];l.length=r}return c}function fA(n,e,t,r,i,s,a,o,l,c,h){h=h||[NaN,NaN];for(let f=0,m=t.length;f<m;++f){const y=t[f];c=dA(n,e,y,r,i,s,a,o,l,c,h),e=y}return c}function C$(n,e,t,r,i,s,a,o,l,c,h){h=h||[NaN,NaN];for(let f=0,m=t.length;f<m;++f){const y=t[f];c=fA(n,e,y,r,i,s,a,o,l,c,h),e=y[y.length-1]}return c}function k$(n,e,t,r){for(let i=0,s=t.length;i<s;++i)n[e++]=t[i];return e}function Rw(n,e,t,r){for(let i=0,s=t.length;i<s;++i){const a=t[i];for(let o=0;o<r;++o)n[e++]=a[o]}return e}function Ey(n,e,t,r,i){i=i||[];let s=0;for(let a=0,o=t.length;a<o;++a){const l=Rw(n,e,t[a],r);i[s++]=l,e=l}return i.length=s,i}function HD(n,e,t,r,i){i=i||[];let s=0;for(let a=0,o=t.length;a<o;++a){const l=Ey(n,e,t[a],r,i[s]);l.length===0&&(l[0]=e),i[s++]=l,e=l[l.length-1]}return i.length=s,i}function uu(n,e,t,r,i){i=i!==void 0?i:[];let s=0;for(let a=e;a<t;a+=r)i[s++]=n.slice(a,a+r);return i.length=s,i}function Ep(n,e,t,r,i){i=i!==void 0?i:[];let s=0;for(let a=0,o=t.length;a<o;++a){const l=t[a];i[s++]=uu(n,e,l,r,i[s]),e=l}return i.length=s,i}function hb(n,e,t,r,i){i=i!==void 0?i:[];let s=0;for(let a=0,o=t.length;a<o;++a){const l=t[a];i[s++]=l.length===1&&l[0]===e?[]:Ep(n,e,l,r,i[s]),e=l[l.length-1]}return i.length=s,i}function V_(n,e,t,r,i,s,a){let o,l;const c=(t-e)/r;if(c===1)o=e;else if(c===2)o=e,l=i;else if(c!==0){let h=n[e],f=n[e+1],m=0;const y=[0];for(let w=e+r;w<t;w+=r){const S=n[w],b=n[w+1];m+=Math.sqrt((S-h)*(S-h)+(b-f)*(b-f)),y.push(m),h=S,f=b}const x=i*m,_=kU(y,x);_<0?(l=(x-y[-_-2])/(y[-_-1]-y[-_-2]),o=e+(-_-2)*r):o=e+_*r}a=a>1?a:2,s=s||new Array(a);for(let h=0;h<a;++h)s[h]=o===void 0?NaN:l===void 0?n[o+h]:oa(n[o+h],n[o+r+h],l);return s}function db(n,e,t,r,i,s){if(t==e)return null;let a;if(i<n[e+r-1])return s?(a=n.slice(e,e+r),a[r-1]=i,a):null;if(n[t-1]<i)return s?(a=n.slice(t-r,t),a[r-1]=i,a):null;if(i==n[e+r-1])return n.slice(e,e+r);let o=e/r,l=t/r;for(;o<l;){const m=o+l>>1;i<n[(m+1)*r-1]?l=m:o=m+1}const c=n[o*r-1];if(i==c)return n.slice((o-1)*r,(o-1)*r+r);const h=n[(o+1)*r-1],f=(i-c)/(h-c);a=[];for(let m=0;m<r-1;++m)a.push(oa(n[(o-1)*r+m],n[o*r+m],f));return a.push(i),a}function P$(n,e,t,r,i,s,a){if(a)return db(n,e,t[t.length-1],r,i,s);let o;if(i<n[r-1])return s?(o=n.slice(0,r),o[r-1]=i,o):null;if(n[n.length-1]<i)return s?(o=n.slice(n.length-r),o[r-1]=i,o):null;for(let l=0,c=t.length;l<c;++l){const h=t[l];if(e!=h){if(i<n[e+r-1])return null;if(i<=n[h-1])return db(n,e,h,r,i,!1);e=h}}return null}function M$(n,e,t,r,i){return!ID(i,function(a){return!Vh(n,e,t,r,a[0],a[1])})}function Vh(n,e,t,r,i,s){let a=0,o=n[t-r],l=n[t-r+1];for(;e<t;e+=r){const c=n[e],h=n[e+1];l<=s?h>s&&(c-o)*(s-l)-(i-o)*(h-l)>0&&a++:h<=s&&(c-o)*(s-l)-(i-o)*(h-l)<0&&a--,o=c,l=h}return a!==0}function gA(n,e,t,r,i,s){if(t.length===0||!Vh(n,e,t[0],r,i,s))return!1;for(let a=1,o=t.length;a<o;++a)if(Vh(n,t[a-1],t[a],r,i,s))return!1;return!0}function N$(n,e,t,r,i,s){if(t.length===0)return!1;for(let a=0,o=t.length;a<o;++a){const l=t[a];if(gA(n,e,l,r,i,s))return!0;e=l[l.length-1]}return!1}function KD(n,e,t,r,i){let s;for(e+=r;e<t;e+=r)if(s=i(n.slice(e-r,e),n.slice(e,e+r)),s)return s;return!1}function Aw(n,e,t,r,i,s){return s=s??AD(Us(),n,e,t,r),Es(i,s)?s[0]>=i[0]&&s[2]<=i[2]||s[1]>=i[1]&&s[3]<=i[3]?!0:KD(n,e,t,r,function(a,o){return VU(i,a,o)}):!1}function L$(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){if(Aw(n,e,t[s],r,i))return!0;e=t[s]}return!1}function XD(n,e,t,r,i){return!!(Aw(n,e,t,r,i)||Vh(n,e,t,r,i[0],i[1])||Vh(n,e,t,r,i[0],i[3])||Vh(n,e,t,r,i[2],i[1])||Vh(n,e,t,r,i[2],i[3]))}function qD(n,e,t,r,i){if(!XD(n,e,t[0],r,i))return!1;if(t.length===1)return!0;for(let s=1,a=t.length;s<a;++s)if(M$(n,t[s-1],t[s],r,i)&&!Aw(n,t[s-1],t[s],r,i))return!1;return!0}function O$(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){const o=t[s];if(qD(n,e,o,r,i))return!0;e=o[o.length-1]}return!1}function mA(n,e,t,r){let i=n[e],s=n[e+1],a=0;for(let o=e+r;o<t;o+=r){const l=n[o],c=n[o+1];a+=Math.sqrt((l-i)*(l-i)+(c-s)*(c-s)),i=l,s=c}return a}function Iw(n,e,t,r,i,s,a){const o=(t-e)/r;if(o<3){for(;e<t;e+=r)s[a++]=n[e],s[a++]=n[e+1];return a}const l=new Array(o);l[0]=1,l[o-1]=1;const c=[e,t-r];let h=0;for(;c.length>0;){const f=c.pop(),m=c.pop();let y=0;const x=n[m],_=n[m+1],w=n[f],S=n[f+1];for(let b=m+r;b<f;b+=r){const R=n[b],M=n[b+1],O=GU(R,M,x,_,w,S);O>y&&(h=b,y=O)}y>i&&(l[(h-e)/r]=1,m+r<h&&c.push(m,h),h+r<f&&c.push(h,f))}for(let f=0;f<o;++f)l[f]&&(s[a++]=n[e+f*r],s[a++]=n[e+f*r+1]);return a}function YD(n,e,t,r,i,s,a,o){for(let l=0,c=t.length;l<c;++l){const h=t[l];a=Iw(n,e,h,r,i,s,a),o.push(a),e=h}return a}function Th(n,e){return e*Math.round(n/e)}function D$(n,e,t,r,i,s,a){if(e==t)return a;let o=Th(n[e],i),l=Th(n[e+1],i);e+=r,s[a++]=o,s[a++]=l;let c,h;do if(c=Th(n[e],i),h=Th(n[e+1],i),e+=r,e==t)return s[a++]=c,s[a++]=h,a;while(c==o&&h==l);for(;e<t;){const f=Th(n[e],i),m=Th(n[e+1],i);if(e+=r,f==c&&m==h)continue;const y=c-o,x=h-l,_=f-o,w=m-l;if(y*w==x*_&&(y<0&&_<y||y==_||y>0&&_>y)&&(x<0&&w<x||x==w||x>0&&w>x)){c=f,h=m;continue}s[a++]=c,s[a++]=h,o=c,l=h,c=f,h=m}return s[a++]=c,s[a++]=h,a}function pA(n,e,t,r,i,s,a,o){for(let l=0,c=t.length;l<c;++l){const h=t[l];a=D$(n,e,h,r,i,s,a),o.push(a),e=h}return a}function F$(n,e,t,r,i,s,a,o){for(let l=0,c=t.length;l<c;++l){const h=t[l],f=[];a=pA(n,e,h,r,i,s,a,f),o.push(f),e=h[h.length-1]}return a}class bi extends Id{constructor(e,t){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}appendCoordinate(e){Bn(this.flatCoordinates,e),this.changed()}clone(){const e=new bi(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,r,i){return i<bd(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(uA(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),dA(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,e,t,r,i))}forEachSegment(e){return KD(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinateAtM(e,t){return this.layout!="XYM"&&this.layout!="XYZM"?null:(t=t!==void 0?t:!1,db(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t))}getCoordinates(){return uu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(e,t){return V_(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,this.stride)}getLength(){return mA(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(e){const t=[];return t.length=Iw(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new bi(t,"XY")}getType(){return"LineString"}intersectsExtent(e){return Aw(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,this.getExtent())}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Rw(this.flatCoordinates,0,e,this.stride),this.changed()}}let gi=class ZD extends Id{constructor(e,t){super(),this.setCoordinates(e,t)}clone(){const e=new ZD(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,r,i){const s=this.flatCoordinates,a=Xh(e,t,s[0],s[1]);if(a<i){const o=this.stride;for(let l=0;l<o;++l)r[l]=s[l];return r.length=o,a}return i}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(e){return bD(this.flatCoordinates,e)}getType(){return"Point"}intersectsExtent(e){return eA(e,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(e,t){this.setLayout(t,e,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=k$(this.flatCoordinates,0,e,this.stride),this.changed()}};const Si={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},sd=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",j$=sd.includes("safari")&&!sd.includes("chrom"),V$=j$&&(sd.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(sd)),G$=sd.includes("webkit")&&!sd.includes("edge"),JD=sd.includes("macintosh"),B$=typeof devicePixelRatio<"u"?devicePixelRatio:1,ha=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,yA=typeof Image<"u"&&Image.prototype.decode,QD=typeof createImageBitmap=="function",eF=(function(){let n=!1;try{const e=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return n})(),bt={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function Kr(n,e,t,r){let i;return t&&t.length?i=t.shift():ha?i=new class extends OffscreenCanvas{style={}}(n??300,e??150):i=document.createElement("canvas"),n&&(i.width=n),e&&(i.height=e),i.getContext("2d",r)}let vT;function G_(){return vT||(vT=Kr(1,1)),vT}function Cw(n){const e=n.canvas;e.width=1,e.height=1,n.clearRect(0,0,1,1)}function pM(n,e){const t=e.parentNode;t&&t.replaceChild(n,e)}function z$(n){for(;n.lastChild;)n.lastChild.remove()}function U$(n,e){const t=n.childNodes;for(let r=0;;++r){const i=t[r],s=e[r];if(!i&&!s)break;if(i!==s){if(!i){n.appendChild(s);continue}if(!s){n.removeChild(i),--r;continue}n.insertBefore(s,i)}}}function tF(){return new Proxy({childNodes:[],appendChild:function(e){return this.childNodes.push(e),e},remove:function(){},removeChild:function(e){const t=this.childNodes.indexOf(e);if(t===-1)throw new Error("Node to remove was not found");return this.childNodes.splice(t,1),e},insertBefore:function(e,t){const r=this.childNodes.indexOf(t);if(r===-1)throw new Error("Reference node not found");return this.childNodes.splice(r,0,e),e},style:{}},{get(e,t,r){return t==="firstElementChild"?e.childNodes.length>0?e.childNodes[0]:null:Reflect.get(e,t,r)}})}function hu(n){return typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas}const xA=[NaN,NaN,NaN,0];let wT;function $$(){return wT||(wT=Kr(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),wT}const W$=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,H$=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,K$=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,X$=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function yx(n,e){return n.endsWith("%")?Number(n.substring(0,n.length-1))/e:Number(n)}function Vm(n){throw new Error('failed to parse "'+n+'" as color')}function nF(n){if(n.toLowerCase().startsWith("rgb")){const s=n.match(H$)||n.match(W$)||n.match(K$);if(s){const a=s[4],o=100/255;return[ur(yx(s[1],o)+.5|0,0,255),ur(yx(s[2],o)+.5|0,0,255),ur(yx(s[3],o)+.5|0,0,255),a!==void 0?ur(yx(a,100),0,1):1]}Vm(n)}if(n.startsWith("#")){if(X$.test(n)){const s=n.substring(1),a=s.length<=4?1:2,o=[0,0,0,255];for(let l=0,c=s.length;l<c;l+=a){let h=parseInt(s.substring(l,l+a),16);a===1&&(h+=h<<4),o[l/a]=h}return o[3]=o[3]/255,o}Vm(n)}const e=$$();e.fillStyle="#abcdef";let t=e.fillStyle;e.fillStyle=n,e.fillStyle===t&&(e.fillStyle="#fedcba",t=e.fillStyle,e.fillStyle=n,e.fillStyle===t&&Vm(n));const r=e.fillStyle;if(r.startsWith("#")||r.startsWith("rgba"))return nF(r);e.clearRect(0,0,1,1),e.fillRect(0,0,1,1);const i=Array.from(e.getImageData(0,0,1,1).data);return i[3]=_y(i[3]/255,3),i}function q$(n){return typeof n=="string"?n:vA(n)}const Y$=1024,lm={};let ET=0;function Z$(n){if(n.length===4)return n;const e=n.slice();return e[3]=1,e}function TT(n){return n>.0031308?Math.pow(n,1/2.4)*269.025-14.025:n*3294.6}function ST(n){return n>.2068965?Math.pow(n,3):(n-4/29)*(108/841)}function bT(n){return n>10.314724?Math.pow((n+14.025)/269.025,2.4):n/3294.6}function RT(n){return n>.0088564?Math.pow(n,1/3):n/(108/841)+4/29}function yM(n){const e=bT(n[0]),t=bT(n[1]),r=bT(n[2]),i=RT(e*.222488403+t*.716873169+r*.06060791),s=500*(RT(e*.452247074+t*.399439023+r*.148375274)-i),a=200*(i-RT(e*.016863605+t*.117638439+r*.865350722)),o=Math.atan2(a,s)*(180/Math.PI);return[116*i-16,Math.sqrt(s*s+a*a),o<0?o+360:o,n[3]]}function J$(n){const e=(n[0]+16)/116,t=n[1],r=n[2]*Math.PI/180,i=ST(e),s=ST(e+t/500*Math.cos(r)),a=ST(e-t/200*Math.sin(r)),o=TT(s*3.021973625-i*1.617392459-a*.404875592),l=TT(s*-.943766287+i*1.916279586+a*.027607165),c=TT(s*.069407491-i*.22898585+a*1.159737864);return[ur(o+.5|0,0,255),ur(l+.5|0,0,255),ur(c+.5|0,0,255),n[3]]}function _A(n){if(n==="none")return xA;if(lm.hasOwnProperty(n))return lm[n];if(ET>=Y$){let t=0;for(const r in lm)(t++&3)===0&&(delete lm[r],--ET)}const e=nF(n);e.length!==4&&Vm(n);for(const t of e)isNaN(t)&&Vm(n);return lm[n]=e,++ET,e}function Wa(n){return Array.isArray(n)?n:_A(n)}function vA(n){let e=n[0];e!=(e|0)&&(e=e+.5|0);let t=n[1];t!=(t|0)&&(t=t+.5|0);let r=n[2];r!=(r|0)&&(r=r+.5|0);const i=n[3]===void 0?1:Math.round(n[3]*1e3)/1e3;return"rgba("+e+","+t+","+r+","+i+")"}class rF extends lg{constructor(e,t,r,i){super(),this.extent=e,this.pixelRatio_=r,this.resolution=t,this.state=typeof i=="function"?bt.IDLE:i,this.image_=null,this.loader=typeof i=="function"?i:null}changed(){this.dispatchEvent(Ht.CHANGE)}getExtent(){return this.extent}getImage(){return this.image_}getPixelRatio(){return this.pixelRatio_}getResolution(){return this.resolution}getState(){return this.state}load(){if(this.state==bt.IDLE&&this.loader){this.state=bt.LOADING,this.changed();const e=this.getResolution(),t=Array.isArray(e)?e[0]:e;ED(()=>this.loader(this.getExtent(),t,this.getPixelRatio())).then(r=>{"image"in r&&(this.image_=r.image),"extent"in r&&(this.extent=r.extent),"resolution"in r&&(this.resolution=r.resolution),"pixelRatio"in r&&(this.pixelRatio_=r.pixelRatio),(r instanceof HTMLImageElement||QD&&r instanceof ImageBitmap||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement)&&(this.image_=r),this.state=bt.LOADED}).catch(r=>{this.state=bt.ERROR,console.error(r)}).finally(()=>this.changed())}}setImage(e){this.image_=e}setResolution(e){this.resolution=e}}function Q$(n,e,t){const r=n;let i=!0,s=!1,a=!1;const o=[P_(r,Ht.LOAD,function(){a=!0,s||e()})];return r.src&&yA?(s=!0,r.decode().then(function(){i&&e()}).catch(function(l){i&&(a?e():t())})):o.push(P_(r,Ht.ERROR,t)),function(){i=!1,o.forEach(or)}}function eW(n,e){return new Promise((t,r)=>{function i(){a(),t(n)}function s(){a(),r(new Error("Image load error"))}function a(){n.removeEventListener("load",i),n.removeEventListener("error",s)}n.addEventListener("load",i),n.addEventListener("error",s)})}function iF(n,e){return e&&(n.src=e),n.src&&yA?new Promise((t,r)=>n.decode().then(()=>t(n)).catch(i=>n.complete&&n.width?t(n):r(i))):eW(n)}function sF(n,e){return e&&(n.src=e),n.src&&yA&&QD?n.decode().then(()=>createImageBitmap(n)).catch(t=>{if(n.complete&&n.width)return n;throw t}):iF(n)}class tW{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let e=0;for(const t in this.cache_){const r=this.cache_[t];(e++&3)===0&&!r.hasListener()&&(delete this.cache_[t],delete this.patternCache_[t],--this.cacheSize_)}}}get(e,t,r){const i=AT(e,t,r);return i in this.cache_?this.cache_[i]:null}getPattern(e,t,r){const i=AT(e,t,r);return i in this.patternCache_?this.patternCache_[i]:null}set(e,t,r,i,s){const a=AT(e,t,r),o=a in this.cache_;this.cache_[a]=i,s&&(i.getImageState()===bt.IDLE&&i.load(),i.getImageState()===bt.LOADING?i.ready().then(()=>{this.patternCache_[a]=G_().createPattern(i.getImage(1),"repeat")}):this.patternCache_[a]=G_().createPattern(i.getImage(1),"repeat")),o||++this.cacheSize_}setSize(e){this.maxCacheSize_=e,this.expire()}}function AT(n,e,t){const r=t?Wa(t):"null";return e+":"+n+":"+r}const Da=new tW;let cm=null;class aF extends lg{constructor(e,t,r,i,s){super(),this.hitDetectionImage_=null,this.image_=e,this.crossOrigin_=r,this.canvas_={},this.color_=s,this.imageState_=i===void 0?bt.IDLE:i,this.size_=e&&e.width&&e.height?[e.width,e.height]:null,this.src_=t,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===bt.LOADED){cm||(cm=Kr(1,1,void 0,{willReadFrequently:!0})),cm.drawImage(this.image_,0,0);try{cm.getImageData(0,0,1,1),this.tainted_=!1}catch{cm=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(Ht.CHANGE)}handleImageError_(){this.imageState_=bt.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=bt.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}getPixelRatio(e){return this.replaceColor_(e),this.canvas_[e]?e:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const e=this.size_[0],t=this.size_[1],r=Kr(e,t);r.fillRect(0,0,e,t),this.hitDetectionImage_=r.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===bt.IDLE){this.image_||this.initializeImage_(),this.imageState_=bt.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&iF(this.image_,this.src_).then(e=>{this.image_=e,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(e){if(!this.color_||this.canvas_[e]||this.imageState_!==bt.LOADED)return;const t=this.image_,r=Kr(Math.ceil(t.width*e),Math.ceil(t.height*e)),i=r.canvas;r.scale(e,e),r.drawImage(t,0,0),r.globalCompositeOperation="multiply",r.fillStyle=q$(this.color_),r.fillRect(0,0,i.width/e,i.height/e),r.globalCompositeOperation="destination-in",r.drawImage(t,0,0),this.canvas_[e]=i}ready(){return this.ready_||(this.ready_=new Promise(e=>{if(this.imageState_===bt.LOADED||this.imageState_===bt.ERROR)e();else{const t=()=>{(this.imageState_===bt.LOADED||this.imageState_===bt.ERROR)&&(this.removeEventListener(Ht.CHANGE,t),e())};this.addEventListener(Ht.CHANGE,t)}})),this.ready_}}function B_(n,e,t,r,i,s){let a=e===void 0?void 0:Da.get(e,t,i);return a||(a=new aF(n,n&&"src"in n?n.src||void 0:e,t,r,i),Da.set(e,t,i,a,s)),s&&a&&!Da.getPattern(e,t,i)&&Da.set(e,t,i,a,s),a}function Jo(n){return n?Array.isArray(n)?vA(n):typeof n=="object"&&"src"in n?nW(n):n:null}function nW(n){if(!n.offset||!n.size)return Da.getPattern(n.src,"anonymous",n.color);const e=n.src+":"+n.offset,t=Da.getPattern(e,void 0,n.color);if(t)return t;const r=Da.get(n.src,"anonymous",null);if(r.getImageState()!==bt.LOADED)return null;const i=Kr(n.size[0],n.size[1]);return i.drawImage(r.getImage(1),n.offset[0],n.offset[1],n.size[0],n.size[1],0,0,n.size[0],n.size[1]),B_(i.canvas,e,void 0,bt.LOADED,n.color,!0),Da.getPattern(e,void 0,n.color)}class oF{drawCustom(e,t,r,i,s){}drawGeometry(e){}setStyle(e){}drawCircle(e,t,r){}drawFeature(e,t,r){}drawGeometryCollection(e,t,r){}drawLineString(e,t,r){}drawMultiLineString(e,t,r){}drawMultiPoint(e,t,r){}drawMultiPolygon(e,t,r){}drawPoint(e,t,r){}drawPolygon(e,t,r){}drawText(e,t,r){}setFillStrokeStyle(e,t){}setImageStyle(e,t){}setTextStyle(e,t){}}const xx="ol-hidden",Ty="ol-unselectable",wA="ol-control",xM="ol-collapsed",rW=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),_M=["style","variant","weight","size","lineHeight","family"],fb={normal:400,bold:700},gb=function(n){const e=n.match(rW);if(!e)return null;const t={lineHeight:"normal",size:"1.2em",style:"normal",weight:"400",variant:"normal"};for(let r=0,i=_M.length;r<i;++r){const s=e[r+1];s!==void 0&&(t[_M[r]]=typeof s=="string"?s.trim():s)}return isNaN(Number(t.weight))&&t.weight in fb&&(t.weight=fb[t.weight]),t.families=t.family.split(/,\s?/).map(r=>r.trim().replace(/^['"]|['"]$/g,"")),t},lF="10px sans-serif",Ds="#000",O0="round",Yl=[],Zl=0,D0="round",Tp=10,Sp="#000",bp="center",z_="middle",Gh=[0,0,0,0],Rp=1,Bf=new yl;let um=null,vM;const mb={},iW=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"]);function sW(n,e,t){return`${n} ${e} 16px "${t}"`}const aW=(function(){let e,t;async function r(s){await t.ready;const a=await t.load(s);if(a.length===0)return!1;const o=gb(s),l=o.families[0].toLowerCase(),c=o.weight;return a.some(h=>{const f=h.family.replace(/^['"]|['"]$/g,"").toLowerCase(),m=fb[h.weight]||h.weight;return f===l&&h.style===o.style&&m==c})}async function i(){await t.ready;let s=!0;const a=Bf.getProperties(),o=Object.keys(a).filter(l=>a[l]<100);for(let l=o.length-1;l>=0;--l){const c=o[l];let h=a[c];h<100&&(await r(c)?(og(mb),Bf.set(c,100)):(h+=10,Bf.set(c,h,!0),h<100&&(s=!1)))}e=void 0,s||(e=setTimeout(i,100))}return async function(s){t||(t=ha?self.fonts:document.fonts);const a=gb(s);if(!a)return;const o=a.families;let l=!1;for(const c of o){if(iW.has(c))continue;const h=sW(a.style,a.weight,c);Bf.get(h)===void 0&&(Bf.set(h,0,!0),l=!0)}l&&(clearTimeout(e),e=setTimeout(i,100))}})(),oW=(function(){let n;return function(e){let t=mb[e];if(t==null){if(ha){const r=gb(e),i=cF(e,"g");t=(isNaN(Number(r.lineHeight))?1.2:Number(r.lineHeight))*(i.actualBoundingBoxAscent+i.actualBoundingBoxDescent)}else n||(n=document.createElement("div"),n.innerHTML="M",n.style.minHeight="0",n.style.maxHeight="none",n.style.height="auto",n.style.padding="0",n.style.border="none",n.style.position="absolute",n.style.display="block",n.style.left="-99999px"),n.style.font=e,document.body.appendChild(n),t=n.offsetHeight,document.body.removeChild(n);mb[e]=t}return t}})();function cF(n,e){return um||(um=Kr(1,1)),n!=vM&&(um.font=n,vM=um.font),um.measureText(e)}function uF(n,e){return cF(n,e).width}function wM(n,e,t){if(e in t)return t[e];const r=e.split(`
`).reduce((i,s)=>Math.max(i,uF(n,s)),0);return t[e]=r,r}function lW(n,e){const t=[],r=[],i=[];let s=0,a=0,o=0,l=0;for(let c=0,h=e.length;c<=h;c+=2){const f=e[c];if(f===`
`||c===h){s=Math.max(s,a),i.push(a),a=0,o+=l,l=0;continue}const m=e[c+1]||n.font,y=uF(m,f);t.push(y),a+=y;const x=oW(m);r.push(x),l=Math.max(l,x)}return{width:s,height:o,widths:t,heights:r,lineWidths:i}}function cW(n,e,t,r,i,s,a,o,l,c,h){n.save(),t!==1&&(n.globalAlpha===void 0?n.globalAlpha=f=>f.globalAlpha*=t:n.globalAlpha*=t),e&&n.transform.apply(n,e),r.contextInstructions?(n.translate(l,c),n.scale(h[0],h[1]),uW(r,n)):h[0]<0||h[1]<0?(n.translate(l,c),n.scale(h[0],h[1]),n.drawImage(r,i,s,a,o,0,0,a,o)):n.drawImage(r,i,s,a,o,l,c,a*h[0],o*h[1]),n.restore()}function uW(n,e){const t=n.contextInstructions;for(let r=0,i=t.length;r<i;r+=2)Array.isArray(t[r+1])?e[t[r]].apply(e,t[r+1]):e[t[r]]=t[r+1]}class hW extends oF{constructor(e,t,r,i,s,a,o){super(),this.context_=e,this.pixelRatio_=t,this.extent_=r,this.transform_=i,this.transformRotation_=i?_y(Math.atan2(i[1],i[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=a,this.userTransform_=o,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=ti()}drawImages_(e,t,r,i){if(!this.image_)return;const s=tl(e,t,r,i,this.transform_,this.pixelCoordinates_),a=this.context_,o=this.tmpLocalTransform_,l=a.globalAlpha;this.imageOpacity_!=1&&(a.globalAlpha=l*this.imageOpacity_);let c=this.imageRotation_;this.transformRotation_===0&&(c-=this.viewRotation_),this.imageRotateWithView_&&(c+=this.viewRotation_);for(let h=0,f=s.length;h<f;h+=2){const m=s[h]-this.imageAnchorX_,y=s[h+1]-this.imageAnchorY_;if(c!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const x=m+this.imageAnchorX_,_=y+this.imageAnchorY_;$a(o,x,_,1,1,c,-x,-_),a.save(),a.transform.apply(a,o),a.translate(x,_),a.scale(this.imageScale_[0],this.imageScale_[1]),a.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),a.restore()}else a.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,m,y,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(a.globalAlpha=l)}drawText_(e,t,r,i){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=tl(e,t,r,i,this.transform_,this.pixelCoordinates_),a=this.context_;let o=this.textRotation_;for(this.transformRotation_===0&&(o-=this.viewRotation_),this.textRotateWithView_&&(o+=this.viewRotation_);t<r;t+=i){const l=s[t]+this.textOffsetX_,c=s[t+1]+this.textOffsetY_;o!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(a.save(),a.translate(l-this.textOffsetX_,c-this.textOffsetY_),a.rotate(o),a.translate(this.textOffsetX_,this.textOffsetY_),a.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&a.strokeText(this.text_,0,0),this.textFillState_&&a.fillText(this.text_,0,0),a.restore()):(this.textStrokeState_&&a.strokeText(this.text_,l,c),this.textFillState_&&a.fillText(this.text_,l,c))}}moveToLineTo_(e,t,r,i,s){const a=this.context_,o=tl(e,t,r,i,this.transform_,this.pixelCoordinates_);a.moveTo(o[0],o[1]);let l=o.length;s&&(l-=2);for(let c=2;c<l;c+=2)a.lineTo(o[c],o[c+1]);return s&&a.closePath(),r}drawRings_(e,t,r,i){for(let s=0,a=r.length;s<a;++s)t=this.moveToLineTo_(e,t,r[s],i,!0);return t}drawCircle(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Es(this.extent_,e.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=A$(e,this.transform_,this.pixelCoordinates_),r=t[2]-t[0],i=t[3]-t[1],s=Math.sqrt(r*r+i*i),a=this.context_;a.beginPath(),a.arc(t[0],t[1],s,0,2*Math.PI),this.fillState_&&a.fill(),this.strokeState_&&a.stroke()}this.text_!==""&&this.drawText_(e.getCenter(),0,2,2)}}setStyle(e){this.setFillStrokeStyle(e.getFill(),e.getStroke()),this.setImageStyle(e.getImage()),this.setTextStyle(e.getText())}setTransform(e){this.transform_=e}drawGeometry(e){switch(e.getType()){case"Point":this.drawPoint(e);break;case"LineString":this.drawLineString(e);break;case"Polygon":this.drawPolygon(e);break;case"MultiPoint":this.drawMultiPoint(e);break;case"MultiLineString":this.drawMultiLineString(e);break;case"MultiPolygon":this.drawMultiPolygon(e);break;case"GeometryCollection":this.drawGeometryCollection(e);break;case"Circle":this.drawCircle(e);break}}drawFeature(e,t){const r=t.getGeometryFunction()(e);r&&(this.setStyle(t),this.drawGeometry(r))}drawGeometryCollection(e){const t=e.getGeometriesArray();for(let r=0,i=t.length;r<i;++r)this.drawGeometry(t[r])}drawPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),r=e.getStride();this.image_&&this.drawImages_(t,0,t.length,r),this.text_!==""&&this.drawText_(t,0,t.length,r)}drawMultiPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),r=e.getStride();this.image_&&this.drawImages_(t,0,t.length,r),this.text_!==""&&this.drawText_(t,0,t.length,r)}drawLineString(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Es(this.extent_,e.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const t=this.context_,r=e.getFlatCoordinates();t.beginPath(),this.moveToLineTo_(r,0,r.length,e.getStride(),!1),t.stroke()}if(this.text_!==""){const t=e.getFlatMidpoint();this.drawText_(t,0,2,2)}}}drawMultiLineString(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getExtent();if(Es(this.extent_,t)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const r=this.context_,i=e.getFlatCoordinates();let s=0;const a=e.getEnds(),o=e.getStride();r.beginPath();for(let l=0,c=a.length;l<c;++l)s=this.moveToLineTo_(i,s,a[l],o,!1);r.stroke()}if(this.text_!==""){const r=e.getFlatMidpoints();this.drawText_(r,0,r.length,2)}}}drawPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Es(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_;t.beginPath(),this.drawRings_(e.getOrientedFlatCoordinates(),0,e.getEnds(),e.getStride()),this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoint();this.drawText_(t,0,2,2)}}}drawMultiPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Es(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_,r=e.getOrientedFlatCoordinates();let i=0;const s=e.getEndss(),a=e.getStride();t.beginPath();for(let o=0,l=s.length;o<l;++o){const c=s[o];i=this.drawRings_(r,i,c,a)}this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoints();this.drawText_(t,0,t.length,2)}}}setContextFillState_(e){const t=this.context_,r=this.contextFillState_;r?r.fillStyle!=e.fillStyle&&(r.fillStyle=e.fillStyle,t.fillStyle=e.fillStyle):(t.fillStyle=e.fillStyle,this.contextFillState_={fillStyle:e.fillStyle})}setContextStrokeState_(e){const t=this.context_,r=this.contextStrokeState_;r?(r.lineCap!=e.lineCap&&(r.lineCap=e.lineCap,t.lineCap=e.lineCap),fc(r.lineDash,e.lineDash)||t.setLineDash(r.lineDash=e.lineDash),r.lineDashOffset!=e.lineDashOffset&&(r.lineDashOffset=e.lineDashOffset,t.lineDashOffset=e.lineDashOffset),r.lineJoin!=e.lineJoin&&(r.lineJoin=e.lineJoin,t.lineJoin=e.lineJoin),r.lineWidth!=e.lineWidth&&(r.lineWidth=e.lineWidth,t.lineWidth=e.lineWidth),r.miterLimit!=e.miterLimit&&(r.miterLimit=e.miterLimit,t.miterLimit=e.miterLimit),r.strokeStyle!=e.strokeStyle&&(r.strokeStyle=e.strokeStyle,t.strokeStyle=e.strokeStyle)):(t.lineCap=e.lineCap,t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset,t.lineJoin=e.lineJoin,t.lineWidth=e.lineWidth,t.miterLimit=e.miterLimit,t.strokeStyle=e.strokeStyle,this.contextStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle})}setContextTextState_(e){const t=this.context_,r=this.contextTextState_,i=e.textAlign?e.textAlign:bp;r?(r.font!=e.font&&(r.font=e.font,t.font=e.font),r.textAlign!=i&&(r.textAlign=i,t.textAlign=i),r.textBaseline!=e.textBaseline&&(r.textBaseline=e.textBaseline,t.textBaseline=e.textBaseline)):(t.font=e.font,t.textAlign=i,t.textBaseline=e.textBaseline,this.contextTextState_={font:e.font,textAlign:i,textBaseline:e.textBaseline})}setFillStrokeStyle(e,t){if(!e)this.fillState_=null;else{const r=e.getColor();this.fillState_={fillStyle:Jo(r||Ds)}}if(!t)this.strokeState_=null;else{const r=t.getColor(),i=t.getLineCap(),s=t.getLineDash(),a=t.getLineDashOffset(),o=t.getLineJoin(),l=t.getWidth(),c=t.getMiterLimit(),h=s||Yl;this.strokeState_={lineCap:i!==void 0?i:O0,lineDash:this.pixelRatio_===1?h:h.map(f=>f*this.pixelRatio_),lineDashOffset:(a||Zl)*this.pixelRatio_,lineJoin:o!==void 0?o:D0,lineWidth:(l!==void 0?l:Rp)*this.pixelRatio_,miterLimit:c!==void 0?c:Tp,strokeStyle:Jo(r||Sp)}}}setImageStyle(e){let t;if(!e||!(t=e.getSize())){this.image_=null;return}const r=e.getPixelRatio(this.pixelRatio_),i=e.getAnchor(),s=e.getOrigin();this.image_=e.getImage(this.pixelRatio_),this.imageAnchorX_=i[0]*r,this.imageAnchorY_=i[1]*r,this.imageHeight_=t[1]*r,this.imageOpacity_=e.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=e.getRotateWithView(),this.imageRotation_=e.getRotation();const a=e.getScaleArray();this.imageScale_=[a[0]*this.pixelRatio_/r,a[1]*this.pixelRatio_/r],this.imageWidth_=t[0]*r}setTextStyle(e){if(!e)this.text_="";else{const t=e.getFill();if(!t)this.textFillState_=null;else{const y=t.getColor();this.textFillState_={fillStyle:Jo(y||Ds)}}const r=e.getStroke();if(!r)this.textStrokeState_=null;else{const y=r.getColor(),x=r.getLineCap(),_=r.getLineDash(),w=r.getLineDashOffset(),S=r.getLineJoin(),b=r.getWidth(),R=r.getMiterLimit();this.textStrokeState_={lineCap:x!==void 0?x:O0,lineDash:_||Yl,lineDashOffset:w||Zl,lineJoin:S!==void 0?S:D0,lineWidth:b!==void 0?b:Rp,miterLimit:R!==void 0?R:Tp,strokeStyle:Jo(y||Sp)}}const i=e.getFont(),s=e.getOffsetX(),a=e.getOffsetY(),o=e.getRotateWithView(),l=e.getRotation(),c=e.getScaleArray(),h=e.getText(),f=e.getTextAlign(),m=e.getTextBaseline();this.textState_={font:i!==void 0?i:lF,textAlign:f!==void 0?f:bp,textBaseline:m!==void 0?m:z_},this.text_=h!==void 0?Array.isArray(h)?h.reduce((y,x,_)=>y+=_%2?" ":x,""):h:"",this.textOffsetX_=s!==void 0?this.pixelRatio_*s:0,this.textOffsetY_=a!==void 0?this.pixelRatio_*a:0,this.textRotateWithView_=o!==void 0?o:!1,this.textRotation_=l!==void 0?l:0,this.textScale_=[this.pixelRatio_*c[0],this.pixelRatio_*c[1]]}}}const dW=.5,hF={Point:vW,LineString:yW,Polygon:EW,MultiPoint:wW,MultiLineString:xW,MultiPolygon:_W,GeometryCollection:pW,Circle:gW};function fW(n,e){return parseInt(Bt(n),10)-parseInt(Bt(e),10)}function EM(n,e){const t=dF(n,e);return t*t}function dF(n,e){return dW*n/e}function gW(n,e,t,r,i){const s=t.getFill(),a=t.getStroke();if(s||a){const l=n.getBuilder(t.getZIndex(),"Circle");l.setFillStrokeStyle(s,a),l.drawCircle(e,r,i)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,r)}}function TM(n,e,t,r,i,s,a,o){const l=[],c=t.getImage();if(c){let m=!0;const y=c.getImageState();y==bt.LOADED||y==bt.ERROR?m=!1:y==bt.IDLE&&c.load(),m&&l.push(c.ready())}const h=t.getFill();h&&h.loading()&&l.push(h.ready());const f=l.length>0;return f&&Promise.all(l).then(()=>i(null)),mW(n,e,t,r,s,a,o),f}function mW(n,e,t,r,i,s,a){const o=t.getGeometryFunction()(e);if(!o)return;const l=o.simplifyTransformed(r,i);if(t.getRenderer())fF(n,l,t,e,a);else{const h=hF[l.getType()];h(n,l,t,e,a,s)}}function fF(n,e,t,r,i){if(e.getType()=="GeometryCollection"){const a=e.getGeometries();for(let o=0,l=a.length;o<l;++o)fF(n,a[o],t,r,i);return}n.getBuilder(t.getZIndex(),"Default").drawCustom(e,r,t.getRenderer(),t.getHitDetectionRenderer(),i)}function pW(n,e,t,r,i,s){const a=e.getGeometriesArray();let o,l;for(o=0,l=a.length;o<l;++o){const c=hF[a[o].getType()];c(n,a[o],t,r,i,s)}}function yW(n,e,t,r,i){const s=t.getStroke();if(s){const o=n.getBuilder(t.getZIndex(),"LineString");o.setFillStrokeStyle(null,s),o.drawLineString(e,r,i)}const a=t.getText();if(a&&a.getText()){const o=n.getBuilder(t.getZIndex(),"Text");o.setTextStyle(a),o.drawText(e,r,i)}}function xW(n,e,t,r,i){const s=t.getStroke();if(s){const o=n.getBuilder(t.getZIndex(),"LineString");o.setFillStrokeStyle(null,s),o.drawMultiLineString(e,r,i)}const a=t.getText();if(a&&a.getText()){const o=n.getBuilder(t.getZIndex(),"Text");o.setTextStyle(a),o.drawText(e,r,i)}}function _W(n,e,t,r,i){const s=t.getFill(),a=t.getStroke();if(a||s){const l=n.getBuilder(t.getZIndex(),"Polygon");l.setFillStrokeStyle(s,a),l.drawMultiPolygon(e,r,i)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,r,i)}}function vW(n,e,t,r,i,s){const a=t.getImage(),o=t.getText(),l=o&&o.getText(),c=s&&a&&l?{}:void 0;if(a){if(a.getImageState()!=bt.LOADED)return;const h=n.getBuilder(t.getZIndex(),"Image");h.setImageStyle(a,c),h.drawPoint(e,r,i)}if(l){const h=n.getBuilder(t.getZIndex(),"Text");h.setTextStyle(o,c),h.drawText(e,r,i)}}function wW(n,e,t,r,i,s){const a=t.getImage(),o=a&&a.getOpacity()!==0,l=t.getText(),c=l&&l.getText(),h=s&&o&&c?{}:void 0;if(o){if(a.getImageState()!=bt.LOADED)return;const f=n.getBuilder(t.getZIndex(),"Image");f.setImageStyle(a,h),f.drawMultiPoint(e,r,i)}if(c){const f=n.getBuilder(t.getZIndex(),"Text");f.setTextStyle(l,h),f.drawText(e,r,i)}}function EW(n,e,t,r,i){const s=t.getFill(),a=t.getStroke();if(s||a){const l=n.getBuilder(t.getZIndex(),"Polygon");l.setFillStrokeStyle(s,a),l.drawPolygon(e,r,i)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,r,i)}}let TW=!1;function SW(n,e,t,r,i,s,a){const o=new XMLHttpRequest;o.open("GET",typeof n=="function"?n(t,r,i):n,!0),e.getType()=="arraybuffer"&&(o.responseType="arraybuffer"),o.withCredentials=TW,o.onload=function(l){if(!o.status||o.status>=200&&o.status<300){const c=e.getType();try{let h;c=="text"||c=="json"?h=o.responseText:c=="xml"?h=o.responseXML||o.responseText:c=="arraybuffer"&&(h=o.response),h?s(e.readFeatures(h,{extent:t,featureProjection:i}),e.readProjection(h)):a()}catch{a()}}else a()},o.onerror=a,o.send()}function SM(n,e){return function(t,r,i,s,a){SW(n,e,t,r,i,(o,l)=>{this.addFeatures(o),s!==void 0&&s(o)},()=>{this.changed(),a!==void 0&&a()})}}function bW(n,e){return[[-1/0,-1/0,1/0,1/0]]}function gF(n,e,t,r){const i=[];let s=Us();for(let a=0,o=t.length;a<o;++a){const l=t[a];s=tA(n,e,l[0],r),i.push((s[0]+s[2])/2,(s[1]+s[3])/2),e=l[l.length-1]}return i}function EA(n,e,t,r,i,s,a){let o,l,c,h,f,m,y;const x=i[s+1],_=[];for(let b=0,R=t.length;b<R;++b){const M=t[b];for(h=n[M-r],m=n[M-r+1],o=e;o<M;o+=r)f=n[o],y=n[o+1],(x<=m&&y<=x||m<=x&&x<=y)&&(c=(x-m)/(y-m)*(f-h)+h,_.push(c)),h=f,m=y}let w=NaN,S=-1/0;for(_.sort(Xl),h=_[0],o=1,l=_.length;o<l;++o){f=_[o];const b=Math.abs(f-h);b>S&&(c=(h+f)/2,gA(n,e,t,r,c,x)&&(w=c,S=b)),h=f}return isNaN(w)&&(w=i[s]),a?(a.push(w,x,S),a):[w,x,S]}function mF(n,e,t,r,i){let s=[];for(let a=0,o=t.length;a<o;++a){const l=t[a];s=EA(n,e,l,r,i,2*a,s),e=l[l.length-1]}return s}function RW(n,e,t,r){for(;e<t-r;){for(let i=0;i<r;++i){const s=n[e+i];n[e+i]=n[t-r+i],n[t-r+i]=s}e+=r,t-=r}}function TA(n,e,t,r){let i=0,s=n[t-r],a=n[t-r+1];for(;e<t;e+=r){const o=n[e],l=n[e+1];i+=(o-s)*(l+a),s=o,a=l}return i===0?void 0:i>0}function SA(n,e,t,r,i){i=i!==void 0?i:!1;for(let s=0,a=t.length;s<a;++s){const o=t[s],l=TA(n,e,o,r);if(s===0){if(i&&l||!i&&!l)return!1}else if(i&&!l||!i&&l)return!1;e=o}return!0}function pF(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){const o=t[s];if(!SA(n,e,o,r,i))return!1;o.length&&(e=o[o.length-1])}return!0}function U_(n,e,t,r,i){i=i!==void 0?i:!1;for(let s=0,a=t.length;s<a;++s){const o=t[s],l=TA(n,e,o,r);(s===0?i&&l||!i&&!l:i&&!l||!i&&l)&&RW(n,e,o,r),e=o}return e}function pb(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s)e=U_(n,e,t[s],r,i);return e}function yF(n,e){const t=[];let r=0,i=0,s;for(let a=0,o=e.length;a<o;++a){const l=e[a],c=TA(n,r,l,2);if(s===void 0&&(s=c),c===s)t.push(e.slice(i,a+1));else{if(t.length===0)continue;t[t.length-1].push(e[i])}i=a+1,r=l}return t}class _o extends WD{constructor(e){super(),this.geometries_=e,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(or),this.changeEventsKeys_.length=0}listenGeometriesChange_(){const e=this.geometries_;for(let t=0,r=e.length;t<r;++t)this.changeEventsKeys_.push(fn(e[t],Ht.CHANGE,this.changed,this))}clone(){const e=new _o(IT(this.geometries_));return e.applyProperties(this),e}closestPointXY(e,t,r,i){if(i<bd(this.getExtent(),e,t))return i;const s=this.geometries_;for(let a=0,o=s.length;a<o;++a)i=s[a].closestPointXY(e,t,r,i);return i}containsXY(e,t){const r=this.geometries_;for(let i=0,s=r.length;i<s;++i)if(r[i].containsXY(e,t))return!0;return!1}computeExtent(e){xy(e);const t=this.geometries_;for(let r=0,i=t.length;r<i;++r)RD(e,t[r].getExtent());return e}getGeometries(){return IT(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let e=[];const t=this.geometries_;for(let r=0,i=t.length;r<i;++r)t[r].getType()===this.getType()?e=e.concat(t[r].getGeometriesArrayRecursive()):e.push(t[r]);return e}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=[],r=this.geometries_;let i=!1;for(let s=0,a=r.length;s<a;++s){const o=r[s],l=o.getSimplifiedGeometry(e);t.push(l),l!==o&&(i=!0)}return i?new _o(t):(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getType(){return"GeometryCollection"}intersectsExtent(e){const t=this.geometries_;for(let r=0,i=t.length;r<i;++r)if(t[r].intersectsExtent(e))return!0;return!1}isEmpty(){return this.geometries_.length===0}rotate(e,t){const r=this.geometries_;for(let i=0,s=r.length;i<s;++i)r[i].rotate(e,t);this.changed()}scale(e,t,r){r||(r=ul(this.getExtent()));const i=this.geometries_;for(let s=0,a=i.length;s<a;++s)i[s].scale(e,t,r);this.changed()}setGeometries(e){this.setGeometriesArray(IT(e))}setGeometriesArray(e){this.unlistenGeometriesChange_(),this.geometries_=e,this.listenGeometriesChange_(),this.changed()}applyTransform(e){const t=this.geometries_;for(let r=0,i=t.length;r<i;++r)t[r].applyTransform(e);this.changed()}translate(e,t){const r=this.geometries_;for(let i=0,s=r.length;i<s;++i)r[i].translate(e,t);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function IT(n){return n.map(e=>e.clone())}function xF(n,e,t,r){let i=0;const s=n[t-r],a=n[t-r+1];let o=0,l=0;for(;e<t;e+=r){const c=n[e]-s,h=n[e+1]-a;i+=l*c-o*h,o=c,l=h}return i/2}function _F(n,e,t,r){let i=0;for(let s=0,a=t.length;s<a;++s){const o=t[s];i+=xF(n,e,o,r),e=o}return i}function AW(n,e,t,r){let i=0;for(let s=0,a=t.length;s<a;++s){const o=t[s];i+=_F(n,e,o,r),e=o[o.length-1]}return i}class Ap extends Id{constructor(e,t){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}clone(){return new Ap(this.flatCoordinates.slice(),this.layout)}closestPointXY(e,t,r,i){return i<bd(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(uA(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),dA(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,t,r,i))}getArea(){return xF(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return uu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(e){const t=[];return t.length=Iw(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new Ap(t,"XY")}getType(){return"LinearRing"}intersectsExtent(e){return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Rw(this.flatCoordinates,0,e,this.stride),this.changed()}}class ic extends Id{constructor(e,t,r){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(e[0]))this.setCoordinates(e,t);else if(t!==void 0&&r)this.setFlatCoordinates(t,e),this.ends_=r;else{const i=e,s=[],a=[];for(let l=0,c=i.length;l<c;++l){const h=i[l];Bn(s,h.getFlatCoordinates()),a.push(s.length)}const o=i.length===0?this.getLayout():i[0].getLayout();this.setFlatCoordinates(o,s),this.ends_=a}}appendLineString(e){Bn(this.flatCoordinates,e.getFlatCoordinates().slice()),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new ic(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,r,i){return i<bd(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(hA(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),fA(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,e,t,r,i))}getCoordinateAtM(e,t,r){return this.layout!="XYM"&&this.layout!="XYZM"||this.flatCoordinates.length===0?null:(t=t!==void 0?t:!1,r=r!==void 0?r:!1,P$(this.flatCoordinates,0,this.ends_,this.stride,e,t,r))}getCoordinates(){return Ep(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(e){return e<0||this.ends_.length<=e?null:new bi(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLineStrings(){const e=this.flatCoordinates,t=this.ends_,r=this.layout,i=[];let s=0;for(let a=0,o=t.length;a<o;++a){const l=t[a],c=new bi(e.slice(s,l),r);i.push(c),s=l}return i}getLength(){const e=this.ends_;let t=0,r=0;for(let i=0,s=e.length;i<s;++i)r+=mA(this.flatCoordinates,t,e[i],this.stride),t=e[i];return r}getFlatMidpoints(){const e=[],t=this.flatCoordinates;let r=0;const i=this.ends_,s=this.stride;for(let a=0,o=i.length;a<o;++a){const l=i[a],c=V_(t,r,l,s,.5);Bn(e,c),r=l}return e}getSimplifiedGeometryInternal(e){const t=[],r=[];return t.length=YD(this.flatCoordinates,0,this.ends_,this.stride,e,t,0,r),new ic(t,"XY",r)}getType(){return"MultiLineString"}intersectsExtent(e){return L$(this.flatCoordinates,0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const r=Ey(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=r.length===0?0:r[r.length-1],this.changed()}}class kd extends Id{constructor(e,t){super(),t&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}appendPoint(e){Bn(this.flatCoordinates,e.getFlatCoordinates()),this.changed()}clone(){const e=new kd(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,r,i){if(i<bd(this.getExtent(),e,t))return i;const s=this.flatCoordinates,a=this.stride;for(let o=0,l=s.length;o<l;o+=a){const c=Xh(e,t,s[o],s[o+1]);if(c<i){i=c;for(let h=0;h<a;++h)r[h]=s[o+h];r.length=a}}return i}getCoordinates(){return uu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(e){const t=this.flatCoordinates.length/this.stride;return e<0||t<=e?null:new gi(this.flatCoordinates.slice(e*this.stride,(e+1)*this.stride),this.layout)}getPoints(){const e=this.flatCoordinates,t=this.layout,r=this.stride,i=[];for(let s=0,a=e.length;s<a;s+=r){const o=new gi(e.slice(s,s+r),t);i.push(o)}return i}getType(){return"MultiPoint"}intersectsExtent(e){const t=this.flatCoordinates,r=this.stride;for(let i=0,s=t.length;i<s;i+=r){const a=t[i],o=t[i+1];if(eA(e,a,o))return!0}return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Rw(this.flatCoordinates,0,e,this.stride),this.changed()}}class Ha extends Id{constructor(e,t,r){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,t!==void 0&&r?(this.setFlatCoordinates(t,e),this.ends_=r):this.setCoordinates(e,t)}appendLinearRing(e){this.flatCoordinates?Bn(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new Ha(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,r,i){return i<bd(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(hA(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),fA(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,t,r,i))}containsXY(e,t){return gA(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,t)}getArea(){return _F(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),U_(t,0,this.ends_,this.stride,e)):t=this.flatCoordinates,Ep(t,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const e=ul(this.getExtent());this.flatInteriorPoint_=EA(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new gi(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(e){return e<0||this.ends_.length<=e?null:new Ap(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLinearRings(){const e=this.layout,t=this.flatCoordinates,r=this.ends_,i=[];let s=0;for(let a=0,o=r.length;a<o;++a){const l=r[a],c=new Ap(t.slice(s,l),e);i.push(c),s=l}return i}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;SA(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=U_(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],r=[];return t.length=pA(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(e),t,0,r),new Ha(t,"XY",r)}getType(){return"Polygon"}intersectsExtent(e){return qD(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const r=Ey(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=r.length===0?0:r[r.length-1],this.changed()}}function bM(n){if(Ad(n))throw new Error("Cannot create polygon from empty extent");const e=n[0],t=n[1],r=n[2],i=n[3],s=[e,t,e,i,r,i,r,t,e,t];return new Ha(s,"XY",[s.length])}class ad extends Id{constructor(e,t,r){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!r&&!Array.isArray(e[0])){const i=e,s=[],a=[];for(let o=0,l=i.length;o<l;++o){const c=i[o],h=s.length,f=c.getEnds();for(let m=0,y=f.length;m<y;++m)f[m]+=h;Bn(s,c.getFlatCoordinates()),a.push(f)}t=i.length===0?this.getLayout():i[0].getLayout(),e=s,r=a}t!==void 0&&r?(this.setFlatCoordinates(t,e),this.endss_=r):this.setCoordinates(e,t)}appendPolygon(e){let t;if(!this.flatCoordinates)this.flatCoordinates=e.getFlatCoordinates().slice(),t=e.getEnds().slice(),this.endss_.push();else{const r=this.flatCoordinates.length;Bn(this.flatCoordinates,e.getFlatCoordinates()),t=e.getEnds().slice();for(let i=0,s=t.length;i<s;++i)t[i]+=r}this.endss_.push(t),this.changed()}clone(){const e=this.endss_.length,t=new Array(e);for(let i=0;i<e;++i)t[i]=this.endss_[i].slice();const r=new ad(this.flatCoordinates.slice(),this.layout,t);return r.applyProperties(this),r}closestPointXY(e,t,r,i){return i<bd(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(I$(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),C$(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,e,t,r,i))}containsXY(e,t){return N$(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e,t)}getArea(){return AW(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),pb(t,0,this.endss_,this.stride,e)):t=this.flatCoordinates,hb(t,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const e=gF(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=mF(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new kd(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;pF(e,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=pb(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],r=[];return t.length=F$(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(e),t,0,r),new ad(t,"XY",r)}getPolygon(e){if(e<0||this.endss_.length<=e)return null;let t;if(e===0)t=0;else{const s=this.endss_[e-1];t=s[s.length-1]}const r=this.endss_[e].slice(),i=r[r.length-1];if(t!==0)for(let s=0,a=r.length;s<a;++s)r[s]-=t;return new Ha(this.flatCoordinates.slice(t,i),this.layout,r)}getPolygons(){const e=this.layout,t=this.flatCoordinates,r=this.endss_,i=[];let s=0;for(let a=0,o=r.length;a<o;++a){const l=r[a].slice(),c=l[l.length-1];if(s!==0)for(let f=0,m=l.length;f<m;++f)l[f]-=s;const h=new Ha(t.slice(s,c),e,l);i.push(h),s=c}return i}getType(){return"MultiPolygon"}intersectsExtent(e){return O$(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,3),this.flatCoordinates||(this.flatCoordinates=[]);const r=HD(this.flatCoordinates,0,e,this.stride,this.endss_);if(r.length===0)this.flatCoordinates.length=0;else{const i=r[r.length-1];this.flatCoordinates.length=i.length===0?0:i[i.length-1]}this.changed()}}const RM=ti();class Fs{constructor(e,t,r,i,s,a){this.styleFunction,this.extent_,this.id_=a,this.type_=e,this.flatCoordinates_=t,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=r||null,this.properties_=s,this.squaredTolerance_,this.stride_=i,this.simplifiedGeometry_}get(e){return this.properties_[e]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?bD(this.flatCoordinates_):tA(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const e=ul(this.getExtent());this.flatInteriorPoints_=EA(this.flatCoordinates_,0,this.ends_,2,e,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const e=yF(this.flatCoordinates_,this.ends_),t=gF(this.flatCoordinates_,0,e,2);this.flatInteriorPoints_=mF(this.flatCoordinates_,0,e,2,t)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=V_(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const e=this.flatCoordinates_;let t=0;const r=this.ends_;for(let i=0,s=r.length;i<s;++i){const a=r[i],o=V_(e,t,a,2,.5);Bn(this.flatMidpoints_,o),t=a}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(e){return this}simplifyTransformed(e,t){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(e){e=ir(e);const t=e.getExtent(),r=e.getWorldExtent();if(t&&r){const i=ei(r)/ei(t);$a(RM,r[0],r[3],i,-i,0,0,0),tl(this.flatCoordinates_,0,this.flatCoordinates_.length,2,RM,this.flatCoordinates_)}}applyTransform(e){e(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new Fs(this.type_,this.flatCoordinates_.slice(),this.ends_?.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=wD((e,t)=>{if(e===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),t&&this.simplifiedGeometry_.applyTransform(t);const r=this.simplifiedGeometry_.getFlatCoordinates();let i;switch(this.type_){case"LineString":r.length=Iw(r,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,e,r,0),i=[r.length];break;case"MultiLineString":i=[],r.length=YD(r,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,e,r,0,i);break;case"Polygon":i=[],r.length=pA(r,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(e),r,0,i);break}return i&&(this.simplifiedGeometry_=new Fs(this.type_,r,i,2,this.properties_,this.id_)),this.squaredTolerance_=e,this.simplifiedGeometry_}),this}}Fs.prototype.getFlatCoordinates=Fs.prototype.getOrientedFlatCoordinates;function vF(n,e,t=0,r=n.length-1,i=IW){for(;r>t;){if(r-t>600){const l=r-t+1,c=e-t+1,h=Math.log(l),f=.5*Math.exp(2*h/3),m=.5*Math.sqrt(h*f*(l-f)/l)*(c-l/2<0?-1:1),y=Math.max(t,Math.floor(e-c*f/l+m)),x=Math.min(r,Math.floor(e+(l-c)*f/l+m));vF(n,e,y,x,i)}const s=n[e];let a=t,o=r;for(hm(n,t,e),i(n[r],s)>0&&hm(n,t,r);a<o;){for(hm(n,a,o),a++,o--;i(n[a],s)<0;)a++;for(;i(n[o],s)>0;)o--}i(n[t],s)===0?hm(n,t,o):(o++,hm(n,o,r)),o<=e&&(t=o+1),e<=o&&(r=o-1)}}function hm(n,e,t){const r=n[e];n[e]=n[t],n[t]=r}function IW(n,e){return n<e?-1:n>e?1:0}let wF=class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data;const r=[];if(!vx(e,t))return r;const i=this.toBBox,s=[];for(;t;){for(let a=0;a<t.children.length;a++){const o=t.children[a],l=t.leaf?i(o):o;vx(e,l)&&(t.leaf?r.push(o):kT(e,l)?this._all(o,r):s.push(o))}t=s.pop()}return r}collides(e){let t=this.data;if(!vx(e,t))return!1;const r=[];for(;t;){for(let i=0;i<t.children.length;i++){const s=t.children[i],a=t.leaf?this.toBBox(s):s;if(vx(e,a)){if(t.leaf||kT(e,a))return!0;r.push(s)}}t=r.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let r=0;r<e.length;r++)this.insert(e[r]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=t;else if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const r=this.data;this.data=t,t=r}this._insert(t,this.data.height-t.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=zf([]),this}remove(e,t){if(!e)return this;let r=this.data;const i=this.toBBox(e),s=[],a=[];let o,l,c;for(;r||s.length;){if(r||(r=s.pop(),l=s[s.length-1],o=a.pop(),c=!0),r.leaf){const h=CW(e,r.children,t);if(h!==-1)return r.children.splice(h,1),s.push(r),this._condense(s),this}!c&&!r.leaf&&kT(r,i)?(s.push(r),a.push(o),o=0,l=r,r=r.children[0]):l?(o++,r=l.children[o],c=!1):r=null}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){const r=[];for(;e;)e.leaf?t.push(...e.children):r.push(...e.children),e=r.pop();return t}_build(e,t,r,i){const s=r-t+1;let a=this._maxEntries,o;if(s<=a)return o=zf(e.slice(t,r+1)),Ef(o,this.toBBox),o;i||(i=Math.ceil(Math.log(s)/Math.log(a)),a=Math.ceil(s/Math.pow(a,i-1))),o=zf([]),o.leaf=!1,o.height=i;const l=Math.ceil(s/a),c=l*Math.ceil(Math.sqrt(a));AM(e,t,r,c,this.compareMinX);for(let h=t;h<=r;h+=c){const f=Math.min(h+c-1,r);AM(e,h,f,l,this.compareMinY);for(let m=h;m<=f;m+=l){const y=Math.min(m+l-1,f);o.children.push(this._build(e,m,y,i-1))}}return Ef(o,this.toBBox),o}_chooseSubtree(e,t,r,i){for(;i.push(t),!(t.leaf||i.length-1===r);){let s=1/0,a=1/0,o;for(let l=0;l<t.children.length;l++){const c=t.children[l],h=CT(c),f=MW(e,c)-h;f<a?(a=f,s=h<s?h:s,o=c):f===a&&h<s&&(s=h,o=c)}t=o||t.children[0]}return t}_insert(e,t,r){const i=r?e:this.toBBox(e),s=[],a=this._chooseSubtree(i,this.data,t,s);for(a.children.push(e),Tm(a,i);t>=0&&s[t].children.length>this._maxEntries;)this._split(s,t),t--;this._adjustParentBBoxes(i,s,t)}_split(e,t){const r=e[t],i=r.children.length,s=this._minEntries;this._chooseSplitAxis(r,s,i);const a=this._chooseSplitIndex(r,s,i),o=zf(r.children.splice(a,r.children.length-a));o.height=r.height,o.leaf=r.leaf,Ef(r,this.toBBox),Ef(o,this.toBBox),t?e[t-1].children.push(o):this._splitRoot(r,o)}_splitRoot(e,t){this.data=zf([e,t]),this.data.height=e.height+1,this.data.leaf=!1,Ef(this.data,this.toBBox)}_chooseSplitIndex(e,t,r){let i,s=1/0,a=1/0;for(let o=t;o<=r-t;o++){const l=Em(e,0,o,this.toBBox),c=Em(e,o,r,this.toBBox),h=NW(l,c),f=CT(l)+CT(c);h<s?(s=h,i=o,a=f<a?f:a):h===s&&f<a&&(a=f,i=o)}return i||r-t}_chooseSplitAxis(e,t,r){const i=e.leaf?this.compareMinX:kW,s=e.leaf?this.compareMinY:PW,a=this._allDistMargin(e,t,r,i),o=this._allDistMargin(e,t,r,s);a<o&&e.children.sort(i)}_allDistMargin(e,t,r,i){e.children.sort(i);const s=this.toBBox,a=Em(e,0,t,s),o=Em(e,r-t,r,s);let l=_x(a)+_x(o);for(let c=t;c<r-t;c++){const h=e.children[c];Tm(a,e.leaf?s(h):h),l+=_x(a)}for(let c=r-t-1;c>=t;c--){const h=e.children[c];Tm(o,e.leaf?s(h):h),l+=_x(o)}return l}_adjustParentBBoxes(e,t,r){for(let i=r;i>=0;i--)Tm(t[i],e)}_condense(e){for(let t=e.length-1,r;t>=0;t--)e[t].children.length===0?t>0?(r=e[t-1].children,r.splice(r.indexOf(e[t]),1)):this.clear():Ef(e[t],this.toBBox)}};function CW(n,e,t){if(!t)return e.indexOf(n);for(let r=0;r<e.length;r++)if(t(n,e[r]))return r;return-1}function Ef(n,e){Em(n,0,n.children.length,e,n)}function Em(n,e,t,r,i){i||(i=zf(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(let s=e;s<t;s++){const a=n.children[s];Tm(i,n.leaf?r(a):a)}return i}function Tm(n,e){return n.minX=Math.min(n.minX,e.minX),n.minY=Math.min(n.minY,e.minY),n.maxX=Math.max(n.maxX,e.maxX),n.maxY=Math.max(n.maxY,e.maxY),n}function kW(n,e){return n.minX-e.minX}function PW(n,e){return n.minY-e.minY}function CT(n){return(n.maxX-n.minX)*(n.maxY-n.minY)}function _x(n){return n.maxX-n.minX+(n.maxY-n.minY)}function MW(n,e){return(Math.max(e.maxX,n.maxX)-Math.min(e.minX,n.minX))*(Math.max(e.maxY,n.maxY)-Math.min(e.minY,n.minY))}function NW(n,e){const t=Math.max(n.minX,e.minX),r=Math.max(n.minY,e.minY),i=Math.min(n.maxX,e.maxX),s=Math.min(n.maxY,e.maxY);return Math.max(0,i-t)*Math.max(0,s-r)}function kT(n,e){return n.minX<=e.minX&&n.minY<=e.minY&&e.maxX<=n.maxX&&e.maxY<=n.maxY}function vx(n,e){return e.minX<=n.maxX&&e.minY<=n.maxY&&e.maxX>=n.minX&&e.maxY>=n.minY}function zf(n){return{children:n,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function AM(n,e,t,r,i){const s=[e,t];for(;s.length;){if(t=s.pop(),e=s.pop(),t-e<=r)continue;const a=e+Math.ceil((t-e)/r/2)*r;vF(n,a,e,t,i),s.push(e,a,a,t)}}class IM{constructor(e){this.rbush_=new wF(e),this.items_={}}insert(e,t){const r={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:t};this.rbush_.insert(r),this.items_[Bt(t)]=r}load(e,t){const r=new Array(t.length);for(let i=0,s=t.length;i<s;i++){const a=e[i],o=t[i],l={minX:a[0],minY:a[1],maxX:a[2],maxY:a[3],value:o};r[i]=l,this.items_[Bt(o)]=l}this.rbush_.load(r)}remove(e){const t=Bt(e),r=this.items_[t];return delete this.items_[t],this.rbush_.remove(r)!==null}update(e,t){const r=this.items_[Bt(t)],i=[r.minX,r.minY,r.maxX,r.maxY];rd(i,e)||(this.remove(t),this.insert(e,t))}getAll(){return this.rbush_.all().map(function(t){return t.value})}getInExtent(e){const t={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this.rbush_.search(t).map(function(i){return i.value})}forEach(e){return this.forEach_(this.getAll(),e)}forEachInExtent(e,t){return this.forEach_(this.getInExtent(e),t)}forEach_(e,t){let r;for(let i=0,s=e.length;i<s;i++)if(r=t(e[i]),r)return r;return r}isEmpty(){return nd(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(e){const t=this.rbush_.toJSON();return ku(t.minX,t.minY,t.maxX,t.maxY,e)}concat(e){this.rbush_.load(e.rbush_.all());for(const t in e.items_)this.items_[t]=e.items_[t]}}class bA extends yl{constructor(e){super(),this.projection=ir(e.projection),this.attributions_=CM(e.attributions),this.attributionsCollapsible_=e.attributionsCollapsible??!0,this.loading=!1,this.state_=e.state!==void 0?e.state:"ready",this.wrapX_=e.wrapX!==void 0?e.wrapX:!1,this.interpolate_=!!e.interpolate,this.viewResolver=null,this.viewRejector=null;const t=this;this.viewPromise_=new Promise(function(r,i){t.viewResolver=r,t.viewRejector=i})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(e){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(e){this.attributions_=CM(e),this.changed()}setState(e){this.state_=e,this.changed()}}function CM(n){return n?typeof n=="function"?n:(Array.isArray(n)||(n=[n]),e=>n):null}const rs={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};class Uc extends pl{constructor(e,t,r){super(e),this.feature=t,this.features=r}}class gc extends bA{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:e.wrapX!==void 0?e.wrapX:!0}),this.on,this.once,this.un,this.loader_=_p,this.format_=e.format||null,this.overlaps_=e.overlaps===void 0?!0:e.overlaps,this.url_=e.url,e.loader!==void 0?this.loader_=e.loader:this.url_!==void 0&&(bn(this.format_,"`format` must be set when `url` is set"),this.loader_=SM(this.url_,this.format_)),this.strategy_=e.strategy!==void 0?e.strategy:bW;const t=e.useSpatialIndex!==void 0?e.useSpatialIndex:!0;this.featuresRtree_=t?new IM:null,this.loadedExtentsRtree_=new IM,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let r,i;Array.isArray(e.features)?i=e.features:e.features&&(r=e.features,i=r.getArray()),!t&&r===void 0&&(r=new La(i)),i!==void 0&&this.addFeaturesInternal(i),r!==void 0&&this.bindFeaturesCollection_(r)}addFeature(e){this.addFeatureInternal(e),this.changed()}addFeatureInternal(e){const t=Bt(e);if(!this.addToIndex_(t,e)){this.featuresCollection_&&this.featuresCollection_.remove(e);return}this.setupChangeEvents_(t,e);const r=e.getGeometry();if(r){const i=r.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(i,e)}else this.nullGeometryFeatures_[t]=e;this.dispatchEvent(new Uc(rs.ADDFEATURE,e))}setupChangeEvents_(e,t){t instanceof Fs||(this.featureChangeKeys_[e]=[fn(t,Ht.CHANGE,this.handleFeatureChange_,this),fn(t,P0.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(e,t){let r=!0;if(t.getId()!==void 0){const i=String(t.getId());if(!(i in this.idIndex_))this.idIndex_[i]=t;else if(t instanceof Fs){const s=this.idIndex_[i];s instanceof Fs?Array.isArray(s)?s.push(t):this.idIndex_[i]=[s,t]:r=!1}else r=!1}return r&&(bn(!(e in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[e]=t),r}addFeatures(e){this.addFeaturesInternal(e),this.changed()}addFeaturesInternal(e){const t=[],r=[],i=[];for(let s=0,a=e.length;s<a;s++){const o=e[s],l=Bt(o);this.addToIndex_(l,o)&&r.push(o)}for(let s=0,a=r.length;s<a;s++){const o=r[s],l=Bt(o);this.setupChangeEvents_(l,o);const c=o.getGeometry();if(c){const h=c.getExtent();t.push(h),i.push(o)}else this.nullGeometryFeatures_[l]=o}if(this.featuresRtree_&&this.featuresRtree_.load(t,i),this.hasListener(rs.ADDFEATURE))for(let s=0,a=r.length;s<a;s++)this.dispatchEvent(new Uc(rs.ADDFEATURE,r[s]))}bindFeaturesCollection_(e){let t=!1;this.addEventListener(rs.ADDFEATURE,function(r){t||(t=!0,e.push(r.feature),t=!1)}),this.addEventListener(rs.REMOVEFEATURE,function(r){t||(t=!0,e.remove(r.feature),t=!1)}),e.addEventListener(Os.ADD,r=>{t||(t=!0,this.addFeature(r.element),t=!1)}),e.addEventListener(Os.REMOVE,r=>{t||(t=!0,this.removeFeature(r.element),t=!1)}),this.featuresCollection_=e}clear(e){if(e){for(const r in this.featureChangeKeys_)this.featureChangeKeys_[r].forEach(or);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(r=>{this.removeFeatureInternal(r)});for(const r in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[r])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const t=new Uc(rs.CLEAR);this.dispatchEvent(t),this.changed()}forEachFeature(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureAtCoordinateDirect(e,t){const r=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(r,function(i){const s=i.getGeometry();if(s instanceof Fs||s.intersectsCoordinate(e))return t(i)})}forEachFeatureInExtent(e,t){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureIntersectingExtent(e,t){return this.forEachFeatureInExtent(e,function(r){const i=r.getGeometry();if(i instanceof Fs||i.intersectsExtent(e)){const s=t(r);if(s)return s}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let e;return this.featuresCollection_?e=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(e=this.featuresRtree_.getAll(),nd(this.nullGeometryFeatures_)||Bn(e,Object.values(this.nullGeometryFeatures_))),e}getFeaturesAtCoordinate(e){const t=[];return this.forEachFeatureAtCoordinateDirect(e,function(r){t.push(r)}),t}getFeaturesInExtent(e,t){if(this.featuresRtree_){if(!(t&&t.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(e);const i=kD(e,t);return[].concat(...i.map(s=>this.featuresRtree_.getInExtent(s)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(e,t){const r=e[0],i=e[1];let s=null;const a=[NaN,NaN];let o=1/0;const l=[-1/0,-1/0,1/0,1/0];return t=t||xp,this.featuresRtree_.forEachInExtent(l,function(c){if(t(c)){const h=c.getGeometry(),f=o;if(o=h instanceof Fs?0:h.closestPointXY(r,i,a,o),o<f){s=c;const m=Math.sqrt(o);l[0]=r-m,l[1]=i-m,l[2]=r+m,l[3]=i+m}}}),s}getExtent(e){return this.featuresRtree_.getExtent(e)}getFeatureById(e){const t=this.idIndex_[e.toString()];return t!==void 0?t:null}getFeatureByUid(e){const t=this.uidIndex_[e];return t!==void 0?t:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(e){const t=e.target,r=Bt(t),i=t.getGeometry();if(!i)r in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(t),this.nullGeometryFeatures_[r]=t);else{const a=i.getExtent();r in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[r],this.featuresRtree_&&this.featuresRtree_.insert(a,t)):this.featuresRtree_&&this.featuresRtree_.update(a,t)}const s=t.getId();if(s!==void 0){const a=s.toString();this.idIndex_[a]!==t&&(this.removeFromIdIndex_(t),this.idIndex_[a]=t)}else this.removeFromIdIndex_(t),this.uidIndex_[r]=t;this.changed(),this.dispatchEvent(new Uc(rs.CHANGEFEATURE,t))}hasFeature(e){const t=e.getId();return t!==void 0?t in this.idIndex_:Bt(e)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&nd(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(e,t,r){const i=this.loadedExtentsRtree_,s=this.strategy_(e,t,r);for(let a=0,o=s.length;a<o;++a){const l=s[a];i.forEachInExtent(l,function(h){return lu(h.extent,l)})||(++this.loadingExtentsCount_,this.dispatchEvent(new Uc(rs.FEATURESLOADSTART)),this.loader_.call(this,l,t,r,h=>{--this.loadingExtentsCount_,this.dispatchEvent(new Uc(rs.FEATURESLOADEND,void 0,h))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new Uc(rs.FEATURESLOADERROR))}),i.insert(l,{extent:l.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(e){const t=this.loadedExtentsRtree_,r=t.forEachInExtent(e,function(i){if(rd(i.extent,e))return i});r&&t.remove(r)}removeFeatures(e){let t=!1;for(let r=0,i=e.length;r<i;++r)t=this.removeFeatureInternal(e[r])||t;t&&this.changed()}removeFeature(e){if(!e)return;this.removeFeatureInternal(e)&&this.changed()}removeFeatureInternal(e){const t=Bt(e);if(!(t in this.uidIndex_))return!1;t in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[t]:this.featuresRtree_&&this.featuresRtree_.remove(e),this.featureChangeKeys_[t]?.forEach(or),delete this.featureChangeKeys_[t];const i=e.getId();if(i!==void 0){const s=i.toString(),a=this.idIndex_[s];a===e?delete this.idIndex_[s]:Array.isArray(a)&&(a.splice(a.indexOf(e),1),a.length===1&&(this.idIndex_[s]=a[0]))}return delete this.uidIndex_[t],this.hasListener(rs.REMOVEFEATURE)&&this.dispatchEvent(new Uc(rs.REMOVEFEATURE,e)),!0}removeFromIdIndex_(e){for(const t in this.idIndex_)if(this.idIndex_[t]===e){delete this.idIndex_[t];break}}setLoader(e){this.loader_=e}setUrl(e){bn(this.format_,"`format` must be set when `url` is set"),this.url_=e,this.setLoader(SM(e,this.format_))}setOverlaps(e){this.overlaps_=e,this.changed()}}class rr{constructor(e){e=e||{},this.patternImage_=null,this.color_=null,e.color!==void 0&&this.setColor(e.color)}clone(){const e=this.getColor();return new rr({color:Array.isArray(e)?e.slice():e||void 0})}getColor(){return this.color_}setColor(e){if(e!==null&&typeof e=="object"&&"src"in e){const t=B_(null,e.src,"anonymous",void 0,e.offset?null:e.color?e.color:null,!(e.offset&&e.size));t.ready().then(()=>{this.patternImage_=null}),t.getImageState()===bt.IDLE&&t.load(),t.getImageState()===bt.LOADING&&(this.patternImage_=t)}this.color_=e}getKey(){const e=this.getColor();return e?e instanceof CanvasPattern||e instanceof CanvasGradient?Bt(e):typeof e=="object"&&"src"in e?e.src+":"+e.offset:Wa(e).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}class Yn{constructor(e){e=e||{},this.color_=e.color!==void 0?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=e.lineDash!==void 0?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}clone(){const e=this.getColor();return new Yn({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(e){this.color_=e}setLineCap(e){this.lineCap_=e}setLineDash(e){this.lineDash_=e}setLineDashOffset(e){this.lineDashOffset_=e}setLineJoin(e){this.lineJoin_=e}setMiterLimit(e){this.miterLimit_=e}setWidth(e){this.width_=e}}function kM(n){return n[0]>0&&n[1]>0}function LW(n,e,t){return t===void 0&&(t=[0,0]),t[0]=n[0]*e+.5|0,t[1]=n[1]*e+.5|0,t}function Ii(n,e){return Array.isArray(n)?n:(e===void 0?e=[n,n]:(e[0]=n,e[1]=n),e)}class kw{constructor(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=Ii(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new kw({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return Wt()}getImage(e){return Wt()}getHitDetectionImage(){return Wt()}getPixelRatio(e){return 1}getImageState(){return Wt()}getImageSize(){return Wt()}getOrigin(){return Wt()}getSize(){return Wt()}setDisplacement(e){this.displacement_=e}setOpacity(e){this.opacity_=e}setRotateWithView(e){this.rotateWithView_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=Ii(e)}listenImageChange(e){Wt()}load(){Wt()}unlistenImageChange(e){Wt()}ready(){return Promise.resolve()}}class Pw extends kw{constructor(e){super({opacity:1,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,rotation:e.rotation!==void 0?e.rotation:0,scale:e.scale!==void 0?e.scale:1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=e.fill!==void 0?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius=e.radius,this.radius2_=e.radius2,this.angle_=e.angle!==void 0?e.angle:0,this.stroke_=e.stroke!==void 0?e.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?bt.LOADING:bt.LOADED,this.imageState_===bt.LOADING&&this.ready().then(()=>this.imageState_=bt.LOADED),this.render()}clone(){const e=this.getScale(),t=new Pw({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}getAnchor(){const e=this.size_,t=this.getDisplacement(),r=this.getScaleArray();return[e[0]/2-t[0]/r[0],e[1]/2+t[1]/r[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(e){this.fill_=e,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(e){const t=this.fill_?.getKey(),r=`${e},${this.angle_},${this.radius},${this.radius2_},${this.points_},${t}`+Object.values(this.renderOptions_).join(",");let i=Da.get(r,null,null)?.getImage(1);if(!i){const s=this.renderOptions_,a=Math.ceil(s.size*e),o=Kr(a,a);this.draw_(s,o,e),i=o.canvas,Da.set(r,null,null,new aF(i,void 0,null,bt.LOADED,null))}return i}getPixelRatio(e){return e}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e,this.render()}listenImageChange(e){}load(){}unlistenImageChange(e){}calculateLineJoinSize_(e,t,r){if(t===0||this.points_===1/0||e!=="bevel"&&e!=="miter")return t;let i=this.radius,s=this.radius2_===void 0?i:this.radius2_;if(i<s){const G=i;i=s,s=G}const a=this.radius2_===void 0?this.points_:this.points_*2,o=2*Math.PI/a,l=s*Math.sin(o),c=Math.sqrt(s*s-l*l),h=i-c,f=Math.sqrt(l*l+h*h),m=f/l;if(e==="miter"&&m<=r)return m*t;const y=t/2/m,x=t/2*(h/f),w=Math.sqrt((i+y)*(i+y)+x*x)-i;if(this.radius2_===void 0||e==="bevel")return w*2;const S=i*Math.sin(o),b=Math.sqrt(i*i-S*S),R=s-b,O=Math.sqrt(S*S+R*R)/S;if(O<=r){const G=O*t/2-s-i;return 2*Math.max(w,G)}return w*2}createRenderOptions(){let e=O0,t=D0,r=0,i=null,s=0,a,o=0;this.stroke_&&(a=Jo(this.stroke_.getColor()??Sp),o=this.stroke_.getWidth()??Rp,i=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,t=this.stroke_.getLineJoin()??D0,e=this.stroke_.getLineCap()??O0,r=this.stroke_.getMiterLimit()??Tp);const l=this.calculateLineJoinSize_(t,o,r),c=Math.max(this.radius,this.radius2_||0),h=Math.ceil(2*c+l);return{strokeStyle:a,strokeWidth:o,size:h,lineCap:e,lineDash:i,lineDashOffset:s,lineJoin:t,miterLimit:r}}render(){this.renderOptions_=this.createRenderOptions();const e=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[e,e]}draw_(e,t,r){if(t.scale(r,r),t.translate(e.size/2,e.size/2),this.createPath_(t),this.fill_){let i=this.fill_.getColor();i===null&&(i=Ds),t.fillStyle=Jo(i),t.fill()}e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}createHitDetectionCanvas_(e){let t;if(this.fill_){let r=this.fill_.getColor(),i=0;typeof r=="string"&&(r=Wa(r)),r===null?i=1:Array.isArray(r)&&(i=r.length===4?r[3]:1),i===0&&(t=Kr(e.size,e.size),this.drawHitDetectionCanvas_(e,t))}return t?t.canvas:this.getImage(1)}createPath_(e){let t=this.points_;const r=this.radius;if(t===1/0)e.arc(0,0,r,0,2*Math.PI);else{const i=this.radius2_===void 0?r:this.radius2_;this.radius2_!==void 0&&(t*=2);const s=this.angle_-Math.PI/2,a=2*Math.PI/t;for(let o=0;o<t;o++){const l=s+o*a,c=o%2===0?r:i;e.lineTo(c*Math.cos(l),c*Math.sin(l))}e.closePath()}}drawHitDetectionCanvas_(e,t){t.translate(e.size/2,e.size/2),this.createPath_(t),t.fillStyle=Ds,t.fill(),e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class $s extends Pw{constructor(e){e=e||{radius:5},super({points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:e.scale!==void 0?e.scale:1,rotation:e.rotation!==void 0?e.rotation:0,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode})}clone(){const e=this.getScale(),t=new $s({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}setRadius(e){this.radius=e,this.render()}}class mn{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=PM,e.geometry!==void 0&&this.setGeometry(e.geometry),this.fill_=e.fill!==void 0?e.fill:null,this.image_=e.image!==void 0?e.image:null,this.renderer_=e.renderer!==void 0?e.renderer:null,this.hitDetectionRenderer_=e.hitDetectionRenderer!==void 0?e.hitDetectionRenderer:null,this.stroke_=e.stroke!==void 0?e.stroke:null,this.text_=e.text!==void 0?e.text:null,this.zIndex_=e.zIndex}clone(){let e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new mn({geometry:e??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(e){this.renderer_=e}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(e){this.fill_=e}getImage(){return this.image_}setImage(e){this.image_=e}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e}getText(){return this.text_}setText(e){this.text_=e}getZIndex(){return this.zIndex_}setGeometry(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(t){return t.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=PM,this.geometry_=e}setZIndex(e){this.zIndex_=e}}function OW(n){let e;if(typeof n=="function")e=n;else{let t;Array.isArray(n)?t=n:(bn(typeof n.getZIndex=="function","Expected an `Style` or an array of `Style`"),t=[n]),e=function(){return t}}return e}let PT=null;function EF(n,e){if(!PT){const t=new rr({color:"rgba(255,255,255,0.4)"}),r=new Yn({color:"#3399CC",width:1.25});PT=[new mn({image:new $s({fill:t,stroke:r,radius:5}),fill:t,stroke:r})]}return PT}function PM(n){return n.getGeometry()}const DW="#333";class vo{constructor(e){e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.keepUpright_=e.keepUpright,this.scale_=e.scale,this.scaleArray_=Ii(e.scale!==void 0?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=e.fill!==void 0?e.fill:new rr({color:DW}),this.maxAngle_=e.maxAngle!==void 0?e.maxAngle:Math.PI/4,this.placement_=e.placement!==void 0?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=e.stroke!==void 0?e.stroke:null,this.offsetX_=e.offsetX!==void 0?e.offsetX:0,this.offsetY_=e.offsetY!==void 0?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=e.padding===void 0?null:e.padding,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new vo({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()instanceof rr?this.getFill().clone():this.getFill(),stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(e){this.overflow_=e}setFont(e){this.font_=e}setMaxAngle(e){this.maxAngle_=e}setOffsetX(e){this.offsetX_=e}setOffsetY(e){this.offsetY_=e}setPlacement(e){this.placement_=e}setRepeat(e){this.repeat_=e}setRotateWithView(e){this.rotateWithView_=e}setKeepUpright(e){this.keepUpright_=e}setFill(e){this.fill_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=Ii(e!==void 0?e:1)}setStroke(e){this.stroke_=e}setText(e){this.text_=e}setTextAlign(e){this.textAlign_=e}setJustify(e){this.justify_=e}setTextBaseline(e){this.textBaseline_=e}setBackgroundFill(e){this.backgroundFill_=e}setBackgroundStroke(e){this.backgroundStroke_=e}setPadding(e){this.padding_=e}}const Jr={ANIMATING:0,INTERACTING:1},Gt={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},wx=[Gt.FILL],du=[Gt.STROKE],Bh=[Gt.BEGIN_PATH],MM=[Gt.CLOSE_PATH];class Sy extends oF{constructor(e,t,r,i){super(),this.tolerance=e,this.maxExtent=t,this.pixelRatio=i,this.maxLineWidth=0,this.resolution=r,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(e){const t=this.pixelRatio;return t==1?e:e.map(function(r){return r*t})}appendFlatPointCoordinates(e,t){const r=this.getBufferedMaxExtent(),i=this.tmpCoordinate_,s=this.coordinates;let a=s.length;for(let o=0,l=e.length;o<l;o+=t)i[0]=e[o],i[1]=e[o+1],rc(r,i)&&(s[a++]=i[0],s[a++]=i[1]);return a}appendFlatLineCoordinates(e,t,r,i,s,a){const o=this.coordinates;let l=o.length;const c=this.getBufferedMaxExtent();a&&(t+=i);let h=e[t],f=e[t+1];const m=this.tmpCoordinate_;let y=!0,x,_,w;for(x=t+i;x<r;x+=i)m[0]=e[x],m[1]=e[x+1],w=nb(c,m),w!==_?(y&&(o[l++]=h,o[l++]=f,y=!1),o[l++]=m[0],o[l++]=m[1]):w===Ei.INTERSECTING?(o[l++]=m[0],o[l++]=m[1],y=!1):y=!0,h=m[0],f=m[1],_=w;return(s&&y||x===t+i)&&(o[l++]=h,o[l++]=f),l}drawCustomCoordinates_(e,t,r,i,s){for(let a=0,o=r.length;a<o;++a){const l=r[a],c=this.appendFlatLineCoordinates(e,t,l,i,!1,!1);s.push(c),t=l}return t}drawCustom(e,t,r,i,s){this.beginGeometry(e,t,s);const a=e.getType(),o=e.getStride(),l=this.coordinates.length;let c,h,f,m,y;switch(a){case"MultiPolygon":c=e.getOrientedFlatCoordinates(),m=[];const x=e.getEndss();y=0;for(let _=0,w=x.length;_<w;++_){const S=[];y=this.drawCustomCoordinates_(c,y,x[_],o,S),m.push(S)}this.instructions.push([Gt.CUSTOM,l,m,e,r,hb,s]),this.hitDetectionInstructions.push([Gt.CUSTOM,l,m,e,i||r,hb,s]);break;case"Polygon":case"MultiLineString":f=[],c=a=="Polygon"?e.getOrientedFlatCoordinates():e.getFlatCoordinates(),y=this.drawCustomCoordinates_(c,0,e.getEnds(),o,f),this.instructions.push([Gt.CUSTOM,l,f,e,r,Ep,s]),this.hitDetectionInstructions.push([Gt.CUSTOM,l,f,e,i||r,Ep,s]);break;case"LineString":case"Circle":c=e.getFlatCoordinates(),h=this.appendFlatLineCoordinates(c,0,c.length,o,!1,!1),this.instructions.push([Gt.CUSTOM,l,h,e,r,uu,s]),this.hitDetectionInstructions.push([Gt.CUSTOM,l,h,e,i||r,uu,s]);break;case"MultiPoint":c=e.getFlatCoordinates(),h=this.appendFlatPointCoordinates(c,o),h>l&&(this.instructions.push([Gt.CUSTOM,l,h,e,r,uu,s]),this.hitDetectionInstructions.push([Gt.CUSTOM,l,h,e,i||r,uu,s]));break;case"Point":c=e.getFlatCoordinates(),this.coordinates.push(c[0],c[1]),h=this.coordinates.length,this.instructions.push([Gt.CUSTOM,l,h,e,r,void 0,s]),this.hitDetectionInstructions.push([Gt.CUSTOM,l,h,e,i||r,void 0,s]);break}this.endGeometry(t)}beginGeometry(e,t,r){this.beginGeometryInstruction1_=[Gt.BEGIN_GEOMETRY,t,0,e,r],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[Gt.BEGIN_GEOMETRY,t,0,e,r],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const e=this.hitDetectionInstructions;e.reverse();let t;const r=e.length;let i,s,a=-1;for(t=0;t<r;++t)i=e[t],s=i[0],s==Gt.END_GEOMETRY?a=t:s==Gt.BEGIN_GEOMETRY&&(i[2]=t,PU(this.hitDetectionInstructions,a,t),a=-1)}fillStyleToState(e,t={}){if(e){const r=e.getColor();t.fillPatternScale=r&&typeof r=="object"&&"src"in r?this.pixelRatio:1,t.fillStyle=Jo(r||Ds)}else t.fillStyle=void 0;return t}strokeStyleToState(e,t={}){if(e){const r=e.getColor();t.strokeStyle=Jo(r||Sp);const i=e.getLineCap();t.lineCap=i!==void 0?i:O0;const s=e.getLineDash();t.lineDash=s?s.slice():Yl;const a=e.getLineDashOffset();t.lineDashOffset=a||Zl;const o=e.getLineJoin();t.lineJoin=o!==void 0?o:D0;const l=e.getWidth();t.lineWidth=l!==void 0?l:Rp;const c=e.getMiterLimit();t.miterLimit=c!==void 0?c:Tp,t.lineWidth>this.maxLineWidth&&(this.maxLineWidth=t.lineWidth,this.bufferedMaxExtent_=null)}else t.strokeStyle=void 0,t.lineCap=void 0,t.lineDash=null,t.lineDashOffset=void 0,t.lineJoin=void 0,t.lineWidth=void 0,t.miterLimit=void 0;return t}setFillStrokeStyle(e,t){const r=this.state;this.fillStyleToState(e,r),this.strokeStyleToState(t,r)}createFill(e){const t=e.fillStyle,r=[Gt.SET_FILL_STYLE,t];return typeof t!="string"&&r.push(e.fillPatternScale),r}applyStroke(e){this.instructions.push(this.createStroke(e))}createStroke(e){return[Gt.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth*this.pixelRatio,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash?this.applyPixelRatio(e.lineDash):null,e.lineDashOffset*this.pixelRatio]}updateFillStyle(e,t){const r=e.fillStyle;(typeof r!="string"||e.currentFillStyle!=r)&&(this.instructions.push(t.call(this,e)),e.currentFillStyle=r)}updateStrokeStyle(e,t){const r=e.strokeStyle,i=e.lineCap,s=e.lineDash,a=e.lineDashOffset,o=e.lineJoin,l=e.lineWidth,c=e.miterLimit;(e.currentStrokeStyle!=r||e.currentLineCap!=i||s!=e.currentLineDash&&!fc(e.currentLineDash,s)||e.currentLineDashOffset!=a||e.currentLineJoin!=o||e.currentLineWidth!=l||e.currentMiterLimit!=c)&&(t.call(this,e),e.currentStrokeStyle=r,e.currentLineCap=i,e.currentLineDash=s,e.currentLineDashOffset=a,e.currentLineJoin=o,e.currentLineWidth=l,e.currentMiterLimit=c)}endGeometry(e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const t=[Gt.END_GEOMETRY,e];this.instructions.push(t),this.hitDetectionInstructions.push(t)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=SD(this.maxExtent),this.maxLineWidth>0)){const e=this.resolution*(this.maxLineWidth+1)/2;M0(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class FW extends Sy{constructor(e,t,r,i){super(e,t,r,i),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(e,t,r){if(!this.image_||this.maxExtent&&!rc(this.maxExtent,e.getFlatCoordinates()))return;this.beginGeometry(e,t,r);const i=e.getFlatCoordinates(),s=e.getStride(),a=this.coordinates.length,o=this.appendFlatPointCoordinates(i,s);this.instructions.push([Gt.DRAW_IMAGE,a,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Gt.DRAW_IMAGE,a,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}drawMultiPoint(e,t,r){if(!this.image_)return;this.beginGeometry(e,t,r);const i=e.getFlatCoordinates(),s=[];for(let l=0,c=i.length;l<c;l+=e.getStride())(!this.maxExtent||rc(this.maxExtent,i.slice(l,l+2)))&&s.push(i[l],i[l+1]);const a=this.coordinates.length,o=this.appendFlatPointCoordinates(s,2);this.instructions.push([Gt.DRAW_IMAGE,a,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Gt.DRAW_IMAGE,a,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(e,t){const r=e.getAnchor(),i=e.getSize(),s=e.getOrigin();this.imagePixelRatio_=e.getPixelRatio(this.pixelRatio),this.anchorX_=r[0],this.anchorY_=r[1],this.hitDetectionImage_=e.getHitDetectionImage(),this.image_=e.getImage(this.pixelRatio),this.height_=i[1],this.opacity_=e.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=e.getRotateWithView(),this.rotation_=e.getRotation(),this.scale_=e.getScaleArray(),this.width_=i[0],this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}class jW extends Sy{constructor(e,t,r,i){super(e,t,r,i)}drawFlatCoordinates_(e,t,r,i){const s=this.coordinates.length,a=this.appendFlatLineCoordinates(e,t,r,i,!1,!1),o=[Gt.MOVE_TO_LINE_TO,s,a];return this.instructions.push(o),this.hitDetectionInstructions.push(o),r}drawLineString(e,t,r){const i=this.state,s=i.strokeStyle,a=i.lineWidth;if(s===void 0||a===void 0)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(e,t,r),this.hitDetectionInstructions.push([Gt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Yl,Zl],Bh);const o=e.getFlatCoordinates(),l=e.getStride();this.drawFlatCoordinates_(o,0,o.length,l),this.hitDetectionInstructions.push(du),this.endGeometry(t)}drawMultiLineString(e,t,r){const i=this.state,s=i.strokeStyle,a=i.lineWidth;if(s===void 0||a===void 0)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(e,t,r),this.hitDetectionInstructions.push([Gt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Yl,Zl],Bh);const o=e.getEnds(),l=e.getFlatCoordinates(),c=e.getStride();let h=0;for(let f=0,m=o.length;f<m;++f)h=this.drawFlatCoordinates_(l,h,o[f],c);this.hitDetectionInstructions.push(du),this.endGeometry(t)}finish(){const e=this.state;return e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&this.instructions.push(du),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(e){e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(du),e.lastStroke=this.coordinates.length),e.lastStroke=0,super.applyStroke(e),this.instructions.push(Bh)}}class NM extends Sy{constructor(e,t,r,i){super(e,t,r,i)}drawFlatCoordinatess_(e,t,r,i){const s=this.state,a=s.fillStyle!==void 0,o=s.strokeStyle!==void 0,l=r.length;this.instructions.push(Bh),this.hitDetectionInstructions.push(Bh);for(let c=0;c<l;++c){const h=r[c],f=this.coordinates.length,m=this.appendFlatLineCoordinates(e,t,h,i,!0,!o),y=[Gt.MOVE_TO_LINE_TO,f,m];this.instructions.push(y),this.hitDetectionInstructions.push(y),o&&(this.instructions.push(MM),this.hitDetectionInstructions.push(MM)),t=h}return a&&(this.instructions.push(wx),this.hitDetectionInstructions.push(wx)),o&&(this.instructions.push(du),this.hitDetectionInstructions.push(du)),t}drawCircle(e,t,r){const i=this.state,s=i.fillStyle,a=i.strokeStyle;if(s===void 0&&a===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([Gt.SET_FILL_STYLE,Ds]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Gt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Yl,Zl]);const o=e.getFlatCoordinates(),l=e.getStride(),c=this.coordinates.length;this.appendFlatLineCoordinates(o,0,o.length,l,!1,!1);const h=[Gt.CIRCLE,c];this.instructions.push(Bh,h),this.hitDetectionInstructions.push(Bh,h),i.fillStyle!==void 0&&(this.instructions.push(wx),this.hitDetectionInstructions.push(wx)),i.strokeStyle!==void 0&&(this.instructions.push(du),this.hitDetectionInstructions.push(du)),this.endGeometry(t)}drawPolygon(e,t,r){const i=this.state,s=i.fillStyle,a=i.strokeStyle;if(s===void 0&&a===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([Gt.SET_FILL_STYLE,Ds]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Gt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Yl,Zl]);const o=e.getEnds(),l=e.getOrientedFlatCoordinates(),c=e.getStride();this.drawFlatCoordinatess_(l,0,o,c),this.endGeometry(t)}drawMultiPolygon(e,t,r){const i=this.state,s=i.fillStyle,a=i.strokeStyle;if(s===void 0&&a===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([Gt.SET_FILL_STYLE,Ds]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Gt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Yl,Zl]);const o=e.getEndss(),l=e.getOrientedFlatCoordinates(),c=e.getStride();let h=0;for(let f=0,m=o.length;f<m;++f)h=this.drawFlatCoordinatess_(l,h,o[f],c);this.endGeometry(t)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const e=this.tolerance;if(e!==0){const t=this.coordinates;for(let r=0,i=t.length;r<i;++r)t[r]=Th(t[r],e)}return super.finish()}setFillStrokeStyles_(){const e=this.state;this.updateFillStyle(e,this.createFill),this.updateStrokeStyle(e,this.applyStroke)}}function VW(n,e,t,r,i){const s=[];let a=t,o=0,l=e.slice(t,2);for(;o<n&&a+i<r;){const[c,h]=l.slice(-2),f=e[a+i],m=e[a+i+1],y=Math.sqrt((f-c)*(f-c)+(m-h)*(m-h));if(o+=y,o>=n){const x=(n-o+y)/y,_=oa(c,f,x),w=oa(h,m,x);l.push(_,w),s.push(l),l=[_,w],o==n&&(a+=i),o=0}else if(o<n)l.push(e[a+i],e[a+i+1]),a+=i;else{const x=y-o,_=oa(c,f,x/y),w=oa(h,m,x/y);l.push(_,w),s.push(l),l=[_,w],o=0,a+=i}}return o>0&&s.push(l),s}function GW(n,e,t,r,i){let s=t,a=t,o=0,l=0,c=t,h,f,m,y,x,_,w,S,b,R;for(f=t;f<r;f+=i){const M=e[f],O=e[f+1];x!==void 0&&(b=M-x,R=O-_,y=Math.sqrt(b*b+R*R),w!==void 0&&(l+=m,h=Math.acos((w*b+S*R)/(m*y)),h>n&&(l>o&&(o=l,s=c,a=f),l=0,c=f-i)),m=y,w=b,S=R),x=M,_=O}return l+=y,l>o?[c,f]:[s,a]}const $_={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class BW extends Sy{constructor(e,t,r,i){super(e,t,r,i),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[Ds]={fillStyle:Ds},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const e=super.finish();return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e}drawText(e,t,r){const i=this.textFillState_,s=this.textStrokeState_,a=this.textState_;if(this.text_===""||!a||!i&&!s)return;const o=this.coordinates;let l=o.length;const c=e.getType();let h=null,f=e.getStride();if(a.placement==="line"&&(c=="LineString"||c=="MultiLineString"||c=="Polygon"||c=="MultiPolygon")){if(!Es(this.maxExtent,e.getExtent()))return;let m;if(h=e.getFlatCoordinates(),c=="LineString")m=[h.length];else if(c=="MultiLineString")m=e.getEnds();else if(c=="Polygon")m=e.getEnds().slice(0,1);else if(c=="MultiPolygon"){const w=e.getEndss();m=[];for(let S=0,b=w.length;S<b;++S)m.push(w[S][0])}this.beginGeometry(e,t,r);const y=a.repeat,x=y?void 0:a.textAlign;let _=0;for(let w=0,S=m.length;w<S;++w){let b;y?b=VW(y*this.resolution,h,_,m[w],f):b=[h.slice(_,m[w])];for(let R=0,M=b.length;R<M;++R){const O=b[R];let G=0,A=O.length;if(x==null){const P=GW(a.maxAngle,O,0,O.length,2);G=P[0],A=P[1]}for(let P=G;P<A;P+=f)o.push(O[P],O[P+1]);const I=o.length;_=m[w],this.drawChars_(l,I),l=I}}this.endGeometry(t)}else{let m=a.overflow?null:[];switch(c){case"Point":case"MultiPoint":h=e.getFlatCoordinates();break;case"LineString":h=e.getFlatMidpoint();break;case"Circle":h=e.getCenter();break;case"MultiLineString":h=e.getFlatMidpoints(),f=2;break;case"Polygon":h=e.getFlatInteriorPoint(),a.overflow||m.push(h[2]/this.resolution),f=3;break;case"MultiPolygon":const M=e.getFlatInteriorPoints();h=[];for(let O=0,G=M.length;O<G;O+=3)a.overflow||m.push(M[O+2]/this.resolution),h.push(M[O],M[O+1]);if(h.length===0)return;f=2;break}const y=this.appendFlatPointCoordinates(h,f);if(y===l)return;if(m&&(y-l)/2!==h.length/f){let M=l/2;m=m.filter((O,G)=>{const A=o[(M+G)*2]===h[G*f]&&o[(M+G)*2+1]===h[G*f+1];return A||--M,A})}this.saveTextStates_();const x=a.backgroundFill?this.createFill(this.fillStyleToState(a.backgroundFill)):null,_=a.backgroundStroke?this.createStroke(this.strokeStyleToState(a.backgroundStroke)):null;this.beginGeometry(e,t,r);let w=a.padding;if(w!=Gh&&(a.scale[0]<0||a.scale[1]<0)){let M=a.padding[0],O=a.padding[1],G=a.padding[2],A=a.padding[3];a.scale[0]<0&&(O=-O,A=-A),a.scale[1]<0&&(M=-M,G=-G),w=[M,O,G,A]}const S=this.pixelRatio;this.instructions.push([Gt.DRAW_IMAGE,l,y,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,w==Gh?Gh:w.map(function(M){return M*S}),x,_,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,m]);const b=1/S,R=x?x.slice(0):null;R&&(R[1]=Ds),this.hitDetectionInstructions.push([Gt.DRAW_IMAGE,l,y,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[b,b],NaN,this.declutterMode_,this.declutterImageWithText_,w,R,_,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?Ds:this.fillKey_,this.textOffsetX_,this.textOffsetY_,m]),this.endGeometry(t)}}saveTextStates_(){const e=this.textStrokeState_,t=this.textState_,r=this.textFillState_,i=this.strokeKey_;e&&(i in this.strokeStates||(this.strokeStates[i]={strokeStyle:e.strokeStyle,lineCap:e.lineCap,lineDashOffset:e.lineDashOffset,lineWidth:e.lineWidth,lineJoin:e.lineJoin,miterLimit:e.miterLimit,lineDash:e.lineDash}));const s=this.textKey_;s in this.textStates||(this.textStates[s]={font:t.font,textAlign:t.textAlign||bp,justify:t.justify,textBaseline:t.textBaseline||z_,scale:t.scale});const a=this.fillKey_;r&&(a in this.fillStates||(this.fillStates[a]={fillStyle:r.fillStyle}))}drawChars_(e,t){const r=this.textStrokeState_,i=this.textState_,s=this.strokeKey_,a=this.textKey_,o=this.fillKey_;this.saveTextStates_();const l=this.pixelRatio,c=$_[i.textBaseline],h=this.textOffsetY_*l,f=this.text_,m=r?r.lineWidth*Math.abs(i.scale[0])/2:0;this.instructions.push([Gt.DRAW_CHARS,e,t,c,i.overflow,o,i.maxAngle,l,h,s,m*l,f,a,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([Gt.DRAW_CHARS,e,t,c,i.overflow,o&&Ds,i.maxAngle,l,h,s,m*l,f,a,1/l,this.declutterMode_,this.textKeepUpright_])}setTextStyle(e,t){let r,i,s;if(!e)this.text_="";else{const a=e.getFill();a?(i=this.textFillState_,i||(i={},this.textFillState_=i),i.fillStyle=Jo(a.getColor()||Ds)):(i=null,this.textFillState_=i);const o=e.getStroke();if(!o)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);const _=o.getLineDash(),w=o.getLineDashOffset(),S=o.getWidth(),b=o.getMiterLimit();s.lineCap=o.getLineCap()||O0,s.lineDash=_?_.slice():Yl,s.lineDashOffset=w===void 0?Zl:w,s.lineJoin=o.getLineJoin()||D0,s.lineWidth=S===void 0?Rp:S,s.miterLimit=b===void 0?Tp:b,s.strokeStyle=Jo(o.getColor()||Sp)}r=this.textState_;const l=e.getFont()||lF;aW(l);const c=e.getScaleArray();r.overflow=e.getOverflow(),r.font=l,r.maxAngle=e.getMaxAngle(),r.placement=e.getPlacement(),r.textAlign=e.getTextAlign(),r.repeat=e.getRepeat(),r.justify=e.getJustify(),r.textBaseline=e.getTextBaseline()||z_,r.backgroundFill=e.getBackgroundFill(),r.backgroundStroke=e.getBackgroundStroke(),r.padding=e.getPadding()||Gh,r.scale=c===void 0?[1,1]:c;const h=e.getOffsetX(),f=e.getOffsetY(),m=e.getRotateWithView(),y=e.getKeepUpright(),x=e.getRotation();this.text_=e.getText()||"",this.textOffsetX_=h===void 0?0:h,this.textOffsetY_=f===void 0?0:f,this.textRotateWithView_=m===void 0?!1:m,this.textKeepUpright_=y===void 0?!0:y,this.textRotation_=x===void 0?0:x,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:Bt(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=r.font+r.scale+(r.textAlign||"?")+(r.repeat||"?")+(r.justify||"?")+(r.textBaseline||"?"),this.fillKey_=i&&i.fillStyle?typeof i.fillStyle=="string"?i.fillStyle:"|"+Bt(i.fillStyle):""}this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}const zW={Circle:NM,Default:Sy,Image:FW,LineString:jW,Polygon:NM,Text:BW};class UW{constructor(e,t,r,i){this.tolerance_=e,this.maxExtent_=t,this.pixelRatio_=i,this.resolution_=r,this.buildersByZIndex_={}}finish(){const e={};for(const t in this.buildersByZIndex_){e[t]=e[t]||{};const r=this.buildersByZIndex_[t];for(const i in r){const s=r[i].finish();e[t][i]=s}}return e}getBuilder(e,t){const r=e!==void 0?e.toString():"0";let i=this.buildersByZIndex_[r];i===void 0&&(i={},this.buildersByZIndex_[r]=i);let s=i[t];if(s===void 0){const a=zW[t];s=new a(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),i[t]=s}return s}}function $W(n,e,t,r,i,s,a,o,l,c,h,f,m=!0){let y=n[e],x=n[e+1],_=0,w=0,S=0,b=0;function R(){_=y,w=x,e+=r,y=n[e],x=n[e+1],b+=S,S=Math.sqrt((y-_)*(y-_)+(x-w)*(x-w))}do R();while(e<t-r&&b+S<s);let M=S===0?0:(s-b)/S;const O=oa(_,y,M),G=oa(w,x,M),A=e-r,I=b,P=s+o*l(c,i,h);for(;e<t-r&&b+S<P;)R();M=S===0?0:(P-b)/S;const D=oa(_,y,M),L=oa(w,x,M);let U=!1;if(m)if(f){const Me=[O,G,D,L];$D(Me,0,4,2,f,Me,Me),U=Me[0]>Me[2]}else U=O>D;const j=Math.PI,Ee=[],ke=A+r===e;e=A,S=0,b=I,y=n[e],x=n[e+1];let Be;if(ke){R(),Be=Math.atan2(x-w,y-_),U&&(Be+=Be>0?-j:j);const Me=(D+O)/2,ce=(L+G)/2;return Ee[0]=[Me,ce,(P-s)/2,Be,i],Ee}i=i.replace(/\n/g," ");for(let Me=0,ce=i.length;Me<ce;){R();let Pe=Math.atan2(x-w,y-_);if(U&&(Pe+=Pe>0?-j:j),Be!==void 0){let ie=Pe-Be;if(ie+=ie>j?-2*j:ie<-j?2*j:0,Math.abs(ie)>a)return null}Be=Pe;const be=Me;let se=0;for(;Me<ce;++Me){const ie=U?ce-Me-1:Me,ue=o*l(c,i[ie],h);if(e+r<t&&b+S<s+se+ue/2)break;se+=ue}if(Me===be)continue;const V=U?i.substring(ce-be,ce-Me):i.substring(be,Me);M=S===0?0:(s+se/2-b)/S;const Z=oa(_,y,M),te=oa(w,x,M);Ee.push([Z,te,se/2,Pe,V]),s+=se}return Ee}class TF{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(G_(),{get:(e,t)=>{if(typeof G_()[t]=="function")return this.push_(t),this.pushMethodArgs_},set:(e,t,r)=>(this.push_(t,r),!0)})}push_(...e){const t=this.instructions_,r=this.zIndex+this.offset_;t[r]||(t[r]=[]),t[r].push(...e)}pushMethodArgs_=(...e)=>(this.push_(e),this);pushFunction(e){this.push_(e)}getContext(){return this.context_}draw(e){this.instructions_.forEach(t=>{for(let r=0,i=t.length;r<i;++r){const s=t[r];if(typeof s=="function"){s(e);continue}const a=t[++r];if(typeof e[s]=="function")e[s](...a);else{if(typeof a=="function"){e[s]=a(e);continue}e[s]=a}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const Tf=Us(),$c=[],Ol=[],Dl=[],Wc=[];function LM(n){return n[3].declutterBox}const OM=new RegExp("[-----]");function MT(n,e){return e==="start"?e=OM.test(n)?"right":"left":e==="end"&&(e=OM.test(n)?"left":"right"),$_[e]}function WW(n,e,t){return t>0&&n.push(`
`,""),n.push(e,""),n}function HW(n,e,t){return t%2===0&&(n+=e),n}class KW{constructor(e,t,r,i,s){this.overlaps=r,this.pixelRatio=t,this.resolution=e,this.alignAndScaleFill_,this.instructions=i.instructions,this.coordinates=i.coordinates,this.coordinateCache_={},this.renderedTransform_=ti(),this.hitDetectionInstructions=i.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=i.fillStates||{},this.strokeStates=i.strokeStates||{},this.textStates=i.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=s?new TF:null}getZIndexContext(){return this.zIndexContext_}createLabel(e,t,r,i){const s=e+t+r+i;if(this.labels_[s])return this.labels_[s];const a=i?this.strokeStates[i]:null,o=r?this.fillStates[r]:null,l=this.textStates[t],c=this.pixelRatio,h=[l.scale[0]*c,l.scale[1]*c],f=l.justify?$_[l.justify]:MT(Array.isArray(e)?e[0]:e,l.textAlign||bp),m=i&&a.lineWidth?a.lineWidth:0,y=Array.isArray(e)?e:String(e).split(`
`).reduce(WW,[]),{width:x,height:_,widths:w,heights:S,lineWidths:b}=lW(l,y),R=x+m,M=[],O=(R+2)*h[0],G=(_+m)*h[1],A={width:O<0?Math.floor(O):Math.ceil(O),height:G<0?Math.floor(G):Math.ceil(G),contextInstructions:M};(h[0]!=1||h[1]!=1)&&M.push("scale",h),i&&(M.push("strokeStyle",a.strokeStyle),M.push("lineWidth",m),M.push("lineCap",a.lineCap),M.push("lineJoin",a.lineJoin),M.push("miterLimit",a.miterLimit),M.push("setLineDash",[a.lineDash]),M.push("lineDashOffset",a.lineDashOffset)),r&&M.push("fillStyle",o.fillStyle),M.push("textBaseline","middle"),M.push("textAlign","center");const I=.5-f;let P=f*R+I*m;const D=[],L=[];let U=0,j=0,Ee=0,ke=0,Be;for(let Me=0,ce=y.length;Me<ce;Me+=2){const Pe=y[Me];if(Pe===`
`){j+=U,U=0,P=f*R+I*m,++ke;continue}const be=y[Me+1]||l.font;be!==Be&&(i&&D.push("font",be),r&&L.push("font",be),Be=be),U=Math.max(U,S[Ee]);const se=[Pe,P+I*w[Ee]+f*(w[Ee]-b[ke]),.5*(m+U)+j];P+=w[Ee],i&&D.push("strokeText",se),r&&L.push("fillText",se),++Ee}return Array.prototype.push.apply(M,D),Array.prototype.push.apply(M,L),this.labels_[s]=A,A}replayTextBackground_(e,t,r,i,s,a,o){e.beginPath(),e.moveTo.apply(e,t),e.lineTo.apply(e,r),e.lineTo.apply(e,i),e.lineTo.apply(e,s),e.lineTo.apply(e,t),a&&(this.alignAndScaleFill_=a[2],e.fillStyle=a[1],this.fill_(e)),o&&(this.setStrokeStyle_(e,o),e.stroke())}calculateImageOrLabelDimensions_(e,t,r,i,s,a,o,l,c,h,f,m,y,x,_,w){o*=m[0],l*=m[1];let S=r-o,b=i-l;const R=s+c>e?e-c:s,M=a+h>t?t-h:a,O=x[3]+R*m[0]+x[1],G=x[0]+M*m[1]+x[2],A=S-x[3],I=b-x[0];(_||f!==0)&&($c[0]=A,Wc[0]=A,$c[1]=I,Ol[1]=I,Ol[0]=A+O,Dl[0]=Ol[0],Dl[1]=I+G,Wc[1]=Dl[1]);let P;return f!==0?(P=$a(ti(),r,i,1,1,f,-r,-i),kr(P,$c),kr(P,Ol),kr(P,Dl),kr(P,Wc),ku(Math.min($c[0],Ol[0],Dl[0],Wc[0]),Math.min($c[1],Ol[1],Dl[1],Wc[1]),Math.max($c[0],Ol[0],Dl[0],Wc[0]),Math.max($c[1],Ol[1],Dl[1],Wc[1]),Tf)):ku(Math.min(A,A+O),Math.min(I,I+G),Math.max(A,A+O),Math.max(I,I+G),Tf),y&&(S=Math.round(S),b=Math.round(b)),{drawImageX:S,drawImageY:b,drawImageW:R,drawImageH:M,originX:c,originY:h,declutterBox:{minX:Tf[0],minY:Tf[1],maxX:Tf[2],maxY:Tf[3],value:w},canvasTransform:P,scale:m}}replayImageOrLabel_(e,t,r,i,s,a,o){const l=!!(a||o),c=i.declutterBox,h=o?o[2]*i.scale[0]/2:0;return c.minX-h<=t[0]&&c.maxX+h>=0&&c.minY-h<=t[1]&&c.maxY+h>=0&&(l&&this.replayTextBackground_(e,$c,Ol,Dl,Wc,a,o),cW(e,i.canvasTransform,s,r,i.originX,i.originY,i.drawImageW,i.drawImageH,i.drawImageX,i.drawImageY,i.scale)),!0}fill_(e){const t=this.alignAndScaleFill_;if(t){const r=kr(this.renderedTransform_,[0,0]),i=512*this.pixelRatio;e.save(),e.translate(r[0]%i,r[1]%i),t!==1&&e.scale(t,t),e.rotate(this.viewRotation_)}e.fill(),t&&e.restore()}setStrokeStyle_(e,t){e.strokeStyle=t[1],t[1]&&(e.lineWidth=t[2],e.lineCap=t[3],e.lineJoin=t[4],e.miterLimit=t[5],e.lineDashOffset=t[7],e.setLineDash(t[6]))}drawLabelWithPointPlacement_(e,t,r,i){const s=this.textStates[t],a=this.createLabel(e,t,i,r),o=this.strokeStates[r],l=this.pixelRatio,c=MT(Array.isArray(e)?e[0]:e,s.textAlign||bp),h=$_[s.textBaseline||z_],f=o&&o.lineWidth?o.lineWidth:0,m=a.width/l-2*s.scale[0],y=c*m+2*(.5-c)*f,x=h*a.height/l+2*(.5-h)*f;return{label:a,anchorX:y,anchorY:x}}execute_(e,t,r,i,s,a,o,l){const c=this.zIndexContext_;let h;this.pixelCoordinates_&&fc(r,this.renderedTransform_)?h=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),h=tl(this.coordinates,0,this.coordinates.length,2,r,this.pixelCoordinates_),zD(this.renderedTransform_,r));let f=0;const m=i.length;let y=0,x,_,w,S,b,R,M,O,G,A,I,P,D,L=0,U=0;const j=this.coordinateCache_,Ee=this.viewRotation_,ke=Math.round(Math.atan2(-r[1],r[0])*1e12)/1e12,Be={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:Ee},Me=this.instructions!=i||this.overlaps?0:200;let ce,Pe,be,se;for(;f<m;){const V=i[f];switch(V[0]){case Gt.BEGIN_GEOMETRY:ce=V[1],se=V[3],ce.getGeometry()?o!==void 0&&!Es(o,se.getExtent())?f=V[2]+1:++f:f=V[2],c&&(c.zIndex=V[4]);break;case Gt.BEGIN_PATH:L>Me&&(this.fill_(e),L=0),U>Me&&(e.stroke(),U=0),!L&&!U&&(e.beginPath(),b=NaN,R=NaN),++f;break;case Gt.CIRCLE:y=V[1];const te=h[y],ie=h[y+1],ue=h[y+2],Ve=h[y+3],Ge=ue-te,ye=Ve-ie,pe=Math.sqrt(Ge*Ge+ye*ye);e.moveTo(te+pe,ie),e.arc(te,ie,pe,0,2*Math.PI,!0),++f;break;case Gt.CLOSE_PATH:e.closePath(),++f;break;case Gt.CUSTOM:y=V[1],x=V[2];const Fe=V[3],wt=V[4],jt=V[5];Be.geometry=Fe,Be.feature=ce,f in j||(j[f]=[]);const Dt=j[f];jt?jt(h,y,x,2,Dt):(Dt[0]=h[y],Dt[1]=h[y+1],Dt.length=2),c&&(c.zIndex=V[6]),wt(Dt,Be),++f;break;case Gt.DRAW_IMAGE:y=V[1],x=V[2],G=V[3],_=V[4],w=V[5];let Kt=V[6];const Qt=V[7],ot=V[8],tr=V[9],hn=V[10];let cn=V[11];const sr=V[12];let Ni=V[13];S=V[14]||"declutter";const Vn=V[15];if(!G&&V.length>=20){A=V[19],I=V[20],P=V[21],D=V[22];const ee=this.drawLabelWithPointPlacement_(A,I,P,D);G=ee.label,V[3]=G;const ne=V[23];_=(ee.anchorX-ne)*this.pixelRatio,V[4]=_;const he=V[24];w=(ee.anchorY-he)*this.pixelRatio,V[5]=w,Kt=G.height,V[6]=Kt,Ni=G.width,V[13]=Ni}let Tr;V.length>25&&(Tr=V[25]);let oi,_t,pn;V.length>17?(oi=V[16],_t=V[17],pn=V[18]):(oi=Gh,_t=null,pn=null),hn&&ke?cn+=Ee:!hn&&!ke&&(cn-=Ee);let Rn=0;for(;y<x;y+=2){if(Tr&&Tr[Rn++]<Ni/this.pixelRatio)continue;const ee=this.calculateImageOrLabelDimensions_(G.width,G.height,h[y],h[y+1],Ni,Kt,_,w,ot,tr,cn,sr,s,oi,!!_t||!!pn,ce),ne=[e,t,G,ee,Qt,_t,pn];if(l){let he,Ce,je;if(Vn){const Qe=x-y;if(!Vn[Qe]){Vn[Qe]={args:ne,declutterMode:S};continue}const xt=Vn[Qe];he=xt.args,Ce=xt.declutterMode,delete Vn[Qe],je=LM(he)}let He,Je;if(he&&(Ce!=="declutter"||!l.collides(je))&&(He=!0),(S!=="declutter"||!l.collides(ee.declutterBox))&&(Je=!0),Ce==="declutter"&&S==="declutter"){const Qe=He&&Je;He=Qe,Je=Qe}He&&(Ce!=="none"&&l.insert(je),this.replayImageOrLabel_.apply(this,he)),Je&&(S!=="none"&&l.insert(ee.declutterBox),this.replayImageOrLabel_.apply(this,ne))}else this.replayImageOrLabel_.apply(this,ne)}++f;break;case Gt.DRAW_CHARS:const Tt=V[1],sn=V[2],Nt=V[3],qi=V[4];D=V[5];const Nr=V[6],li=V[7],nn=V[8];P=V[9];const Sr=V[10];A=V[11],Array.isArray(A)&&(A=A.reduce(HW,"")),I=V[12];const De=[V[13],V[13]];S=V[14]||"declutter";const xe=V[15],_e=this.textStates[I],Ft=_e.font,N=[_e.scale[0]*li,_e.scale[1]*li];let ut;Ft in this.widths_?ut=this.widths_[Ft]:(ut={},this.widths_[Ft]=ut);const W=mA(h,Tt,sn,2),re=Math.abs(N[0])*wM(Ft,A,ut);if(qi||re<=W){const ee=this.textStates[I].textAlign,ne=(W-re)*MT(A,ee),he=$W(h,Tt,sn,2,A,ne,Nr,Math.abs(N[0]),wM,Ft,ut,ke?0:this.viewRotation_,xe);e:if(he){const Ce=[];let je,He,Je,Qe,xt;if(P)for(je=0,He=he.length;je<He;++je){xt=he[je],Je=xt[4],Qe=this.createLabel(Je,I,"",P),_=xt[2]+(N[0]<0?-Sr:Sr),w=Nt*Qe.height+(.5-Nt)*2*Sr*N[1]/N[0]-nn;const St=this.calculateImageOrLabelDimensions_(Qe.width,Qe.height,xt[0],xt[1],Qe.width,Qe.height,_,w,0,0,xt[3],De,!1,Gh,!1,ce);if(l&&S==="declutter"&&l.collides(St.declutterBox))break e;Ce.push([e,t,Qe,St,1,null,null])}if(D)for(je=0,He=he.length;je<He;++je){xt=he[je],Je=xt[4],Qe=this.createLabel(Je,I,D,""),_=xt[2],w=Nt*Qe.height-nn;const St=this.calculateImageOrLabelDimensions_(Qe.width,Qe.height,xt[0],xt[1],Qe.width,Qe.height,_,w,0,0,xt[3],De,!1,Gh,!1,ce);if(l&&S==="declutter"&&l.collides(St.declutterBox))break e;Ce.push([e,t,Qe,St,1,null,null])}l&&S!=="none"&&l.load(Ce.map(LM));for(let St=0,An=Ce.length;St<An;++St)this.replayImageOrLabel_.apply(this,Ce[St])}}++f;break;case Gt.END_GEOMETRY:if(a!==void 0){ce=V[1];const ee=a(ce,se,S);if(ee)return ee}++f;break;case Gt.FILL:Me?L++:this.fill_(e),++f;break;case Gt.MOVE_TO_LINE_TO:for(y=V[1],x=V[2],Pe=h[y],be=h[y+1],e.moveTo(Pe,be),b=Pe+.5|0,R=be+.5|0,y+=2;y<x;y+=2)Pe=h[y],be=h[y+1],M=Pe+.5|0,O=be+.5|0,(y==x-2||M!==b||O!==R)&&(e.lineTo(Pe,be),b=M,R=O);++f;break;case Gt.SET_FILL_STYLE:this.alignAndScaleFill_=V[2],L&&(this.fill_(e),L=0,U&&(e.stroke(),U=0)),e.fillStyle=V[1],++f;break;case Gt.SET_STROKE_STYLE:U&&(e.stroke(),U=0),this.setStrokeStyle_(e,V),++f;break;case Gt.STROKE:Me?U++:e.stroke(),++f;break;default:++f;break}}L&&this.fill_(e),U&&e.stroke()}execute(e,t,r,i,s,a){this.viewRotation_=i,this.execute_(e,t,r,this.instructions,s,void 0,void 0,a)}executeHitDetection(e,t,r,i,s){return this.viewRotation_=r,this.execute_(e,[e.canvas.width,e.canvas.height],t,this.hitDetectionInstructions,!0,i,s)}}const Mh=["Polygon","Circle","LineString","Image","Text","Default"],SF=["Image","Text"],XW=Mh.filter(n=>!SF.includes(n));class qW{constructor(e,t,r,i,s,a,o){this.maxExtent_=e,this.overlaps_=i,this.pixelRatio_=r,this.resolution_=t,this.renderBuffer_=a,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=ti(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(s,o)}clip(e,t){const r=this.getClipCoords(t);e.beginPath(),e.moveTo(r[0],r[1]),e.lineTo(r[2],r[3]),e.lineTo(r[4],r[5]),e.lineTo(r[6],r[7]),e.clip()}createExecutors_(e,t){for(const r in e){let i=this.executorsByZIndex_[r];i===void 0&&(i={},this.executorsByZIndex_[r]=i);const s=e[r];for(const a in s){const o=s[a];i[a]=new KW(this.resolution_,this.pixelRatio_,this.overlaps_,o,t)}}}hasExecutors(e){for(const t in this.executorsByZIndex_){const r=this.executorsByZIndex_[t];for(let i=0,s=e.length;i<s;++i)if(e[i]in r)return!0}return!1}forEachFeatureAtCoordinate(e,t,r,i,s,a){i=Math.round(i);const o=i*2+1,l=$a(this.hitDetectionTransform_,i+.5,i+.5,1/t,-1/t,-r,-e[0],-e[1]),c=!this.hitDetectionContext_;c&&(this.hitDetectionContext_=Kr(o,o));const h=this.hitDetectionContext_;h.canvas.width!==o||h.canvas.height!==o?(h.canvas.width=o,h.canvas.height=o):c||h.clearRect(0,0,o,o);let f;this.renderBuffer_!==void 0&&(f=Us(),jm(f,e),M0(f,t*(this.renderBuffer_+i),f));const m=YW(i);let y;function x(O,G,A){const I=h.getImageData(0,0,o,o).data;for(let P=0,D=m.length;P<D;P++)if(I[m[P]]>0){if(!a||A==="none"||y!=="Image"&&y!=="Text"||a.includes(O)){const L=(m[P]-3)/4,U=i-L%o,j=i-(L/o|0),Ee=s(O,G,U*U+j*j);if(Ee)return Ee}h.clearRect(0,0,o,o);break}}const _=Object.keys(this.executorsByZIndex_).map(Number);_.sort(Xl);let w,S,b,R,M;for(w=_.length-1;w>=0;--w){const O=_[w].toString();for(b=this.executorsByZIndex_[O],S=Mh.length-1;S>=0;--S)if(y=Mh[S],R=b[y],R!==void 0&&(M=R.executeHitDetection(h,l,r,x,f),M))return M}}getClipCoords(e){const t=this.maxExtent_;if(!t)return null;const r=t[0],i=t[1],s=t[2],a=t[3],o=[r,i,r,a,s,a,s,i];return tl(o,0,8,2,e,o),o}isEmpty(){return nd(this.executorsByZIndex_)}execute(e,t,r,i,s,a,o){const l=Object.keys(this.executorsByZIndex_).map(Number);l.sort(o?vD:Xl),a=a||Mh;const c=Mh.length;for(let h=0,f=l.length;h<f;++h){const m=l[h].toString(),y=this.executorsByZIndex_[m];for(let x=0,_=a.length;x<_;++x){const w=a[x],S=y[w];if(S!==void 0){const b=o===null?void 0:S.getZIndexContext(),R=b?b.getContext():e,M=this.maxExtent_&&w!=="Image"&&w!=="Text";if(M&&(R.save(),this.clip(R,r)),!b||w==="Text"||w==="Image"?S.execute(R,t,r,i,s,o):b.pushFunction(O=>S.execute(O,t,r,i,s,o)),M&&R.restore(),b){b.offset();const O=l[h]*c+Mh.indexOf(w);this.deferredZIndexContexts_[O]||(this.deferredZIndexContexts_[O]=[]),this.deferredZIndexContexts_[O].push(b)}}}}this.renderedContext_=e}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const e=this.deferredZIndexContexts_,t=Object.keys(e).map(Number).sort(Xl);for(let r=0,i=t.length;r<i;++r)e[t[r]].forEach(s=>{s.draw(this.renderedContext_),s.clear()}),e[t[r]].length=0}}const NT={};function YW(n){if(NT[n]!==void 0)return NT[n];const e=n*2+1,t=n*n,r=new Array(t+1);for(let s=0;s<=n;++s)for(let a=0;a<=n;++a){const o=s*s+a*a;if(o>t)break;let l=r[o];l||(l=[],r[o]=l),l.push(((n+s)*e+(n+a))*4+3),s>0&&l.push(((n-s)*e+(n+a))*4+3),a>0&&(l.push(((n+s)*e+(n-a))*4+3),s>0&&l.push(((n-s)*e+(n-a))*4+3))}const i=[];for(let s=0,a=r.length;s<a;++s)r[s]&&i.push(...r[s]);return NT[n]=i,i}function DM(n,e,t,r){return t!==void 0&&r!==void 0?[t/n,r/e]:t!==void 0?t/n:r!==void 0?r/e:1}let by=class bF extends kw{constructor(e){e=e||{};const t=e.opacity!==void 0?e.opacity:1,r=e.rotation!==void 0?e.rotation:0,i=e.scale!==void 0?e.scale:1,s=e.rotateWithView!==void 0?e.rotateWithView:!1;super({opacity:t,rotation:r,scale:i,displacement:e.displacement!==void 0?e.displacement:[0,0],rotateWithView:s,declutterMode:e.declutterMode}),this.anchor_=e.anchor!==void 0?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=e.anchorOrigin!==void 0?e.anchorOrigin:"top-left",this.anchorXUnits_=e.anchorXUnits!==void 0?e.anchorXUnits:"fraction",this.anchorYUnits_=e.anchorYUnits!==void 0?e.anchorYUnits:"fraction",this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null;const a=e.img!==void 0?e.img:null;let o=e.src;bn(!(o!==void 0&&a),"`image` and `src` cannot be provided at the same time"),(o===void 0||o.length===0)&&a&&(o=a.src||Bt(a)),bn(o!==void 0&&o.length>0,"A defined and non-empty `src` or `image` must be provided"),bn(!((e.width!==void 0||e.height!==void 0)&&e.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let l;if(e.src!==void 0?l=bt.IDLE:a!==void 0&&("complete"in a?a.complete?l=a.src?bt.LOADED:bt.IDLE:l=bt.LOADING:l=bt.LOADED),this.color_=e.color!==void 0?Wa(e.color):null,this.iconImage_=B_(a,o,this.crossOrigin_,l,this.color_),this.offset_=e.offset!==void 0?e.offset:[0,0],this.offsetOrigin_=e.offsetOrigin!==void 0?e.offsetOrigin:"top-left",this.origin_=null,this.size_=e.size!==void 0?e.size:null,this.initialOptions_,e.width!==void 0||e.height!==void 0){let c,h;if(e.size)[c,h]=e.size;else{const f=this.getImage(1);if(f.width&&f.height)c=f.width,h=f.height;else if(f instanceof HTMLImageElement){this.initialOptions_=e;const m=()=>{if(this.unlistenImageChange(m),!this.initialOptions_)return;const y=this.iconImage_.getSize();this.setScale(DM(y[0],y[1],e.width,e.height))};this.listenImageChange(m);return}}c!==void 0&&this.setScale(DM(c,h,e.width,e.height))}}clone(){let e,t,r;return this.initialOptions_?(t=this.initialOptions_.width,r=this.initialOptions_.height):(e=this.getScale(),e=Array.isArray(e)?e.slice():e),new bF({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:e,width:t,height:r,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let e=this.normalizedAnchor_;if(!e){e=this.anchor_;const i=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!i)return null;e=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(e[0]*=i[0]),this.anchorYUnits_=="fraction"&&(e[1]*=i[1])}if(this.anchorOrigin_!="top-left"){if(!i)return null;e===this.anchor_&&(e=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(e[0]=-e[0]+i[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(e[1]=-e[1]+i[1])}this.normalizedAnchor_=e}const t=this.getDisplacement(),r=this.getScaleArray();return[e[0]-t[0]/r[0],e[1]+t[1]/r[1]]}setAnchor(e){this.anchor_=e,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(e){return this.iconImage_.getImage(e)}getPixelRatio(e){return this.iconImage_.getPixelRatio(e)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let e=this.offset_;if(this.offsetOrigin_!="top-left"){const t=this.getSize(),r=this.iconImage_.getSize();if(!t||!r)return null;e=e.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(e[0]=r[0]-t[0]-e[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(e[1]=r[1]-t[1]-e[1])}return this.origin_=e,this.origin_}getSrc(){return this.iconImage_.getSrc()}setSrc(e){this.iconImage_=B_(null,e,this.crossOrigin_,bt.IDLE,this.color_)}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const e=this.getScaleArray();if(this.size_)return this.size_[0]*e[0];if(this.iconImage_.getImageState()==bt.LOADED)return this.iconImage_.getSize()[0]*e[0]}getHeight(){const e=this.getScaleArray();if(this.size_)return this.size_[1]*e[1];if(this.iconImage_.getImageState()==bt.LOADED)return this.iconImage_.getSize()[1]*e[1]}setScale(e){delete this.initialOptions_,super.setScale(e)}listenImageChange(e){this.iconImage_.addEventListener(Ht.CHANGE,e)}load(){this.iconImage_.load()}unlistenImageChange(e){this.iconImage_.removeEventListener(Ht.CHANGE,e)}ready(){return this.iconImage_.ready()}};const Yo=.5;function ZW(n,e,t,r,i,s,a,o,l){const c=i,h=n[0]*Yo,f=n[1]*Yo,m=Kr(h,f);m.imageSmoothingEnabled=!1;const y=m.canvas,x=new hW(m,Yo,i,null,a,o,null),_=t.length,w=Math.floor((256*256*256-1)/_),S={};for(let R=1;R<=_;++R){const M=t[R-1],O=M.getStyleFunction()||r;if(!O)continue;let G=O(M,s);if(!G)continue;Array.isArray(G)||(G=[G]);const I=(R*w).toString(16).padStart(7,"#00000");for(let P=0,D=G.length;P<D;++P){const L=G[P],U=L.getGeometryFunction()(M);if(!U||!Es(c,U.getExtent()))continue;const j=L.clone(),Ee=j.getFill();Ee&&Ee.setColor(I);const ke=j.getStroke();ke&&(ke.setColor(I),ke.setLineDash(null)),j.setText(void 0);const Be=L.getImage();if(Be){const be=Be.getImageSize();if(!be)continue;const se=Kr(be[0],be[1],void 0,{alpha:!1}),V=se.canvas;se.fillStyle=I,se.fillRect(0,0,V.width,V.height),j.setImage(new by({img:V,anchor:Be.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:Be.getOrigin(),opacity:1,size:Be.getSize(),scale:Be.getScale(),rotation:Be.getRotation(),rotateWithView:Be.getRotateWithView()}))}const Me=j.getZIndex()||0;let ce=S[Me];ce||(ce={},S[Me]=ce,ce.Polygon=[],ce.Circle=[],ce.LineString=[],ce.Point=[]);const Pe=U.getType();if(Pe==="GeometryCollection"){const be=U.getGeometriesArrayRecursive();for(let se=0,V=be.length;se<V;++se){const Z=be[se];ce[Z.getType().replace("Multi","")].push(Z,j)}}else ce[Pe.replace("Multi","")].push(U,j)}}const b=Object.keys(S).map(Number).sort(Xl);for(let R=0,M=b.length;R<M;++R){const O=S[b[R]];for(const G in O){const A=O[G];for(let I=0,P=A.length;I<P;I+=2){x.setStyle(A[I+1]);for(let D=0,L=e.length;D<L;++D)x.setTransform(e[D]),x.drawGeometry(A[I])}}}return m.getImageData(0,0,y.width,y.height)}function JW(n,e,t){const r=[];if(t){const i=Math.floor(Math.round(n[0])*Yo),s=Math.floor(Math.round(n[1])*Yo),a=(ur(i,0,t.width-1)+ur(s,0,t.height-1)*t.width)*4,o=t.data[a],l=t.data[a+1],h=t.data[a+2]+256*(l+256*o),f=Math.floor((256*256*256-1)/e.length);h&&h%f===0&&r.push(e[h/f-1])}return r}class Gm extends pl{constructor(e,t,r,i){super(e),this.inversePixelTransform=t,this.frameState=r,this.context=i}}const QW=5;class RF extends yy{constructor(e){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e,this.staleKeys_=new Array,this.maxStaleKeys=QW}getStaleKeys(){return this.staleKeys_}prependStaleKey(e){this.staleKeys_.unshift(e),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(e){return Wt()}getData(e){return null}prepareFrame(e){return Wt()}renderFrame(e,t){return Wt()}forEachFeatureAtCoordinate(e,t,r,i,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(e){const t=e.target;(t.getState()===bt.LOADED||t.getState()===bt.ERROR)&&this.renderIfReadyAndVisible()}loadImage(e){let t=e.getState();return t!=bt.LOADED&&t!=bt.ERROR&&e.addEventListener(Ht.CHANGE,this.boundHandleImageChange_),t==bt.IDLE&&(e.load(),t=e.getState()),t==bt.LOADED}renderIfReadyAndVisible(){const e=this.getLayer();e&&e.getVisible()&&e.getSourceState()==="ready"&&e.changed()}renderDeferred(e){}disposeInternal(){delete this.layer_,super.disposeInternal()}}const FM=[];let Uf=null;function eH(){Uf=Kr(1,1,void 0,{willReadFrequently:!0})}class RA extends RF{constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=ti(),this.pixelTransform=ti(),this.inversePixelTransform=ti(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(e,t,r){Uf||eH(),Uf.clearRect(0,0,1,1);let i;try{Uf.drawImage(e,t,r,1,1,0,0,1,1),i=Uf.getImageData(0,0,1,1).data}catch{return Uf=null,null}return i}getBackground(e){let r=this.getLayer().getBackground();return typeof r=="function"&&(r=r(e.viewState.resolution)),r||void 0}useContainer(e,t,r){const i=this.getLayer().getClassName();let s,a;if(e&&e.className===i&&(!r||e&&e.style.backgroundColor&&fc(Wa(e.style.backgroundColor),Wa(r)))){const o=e.firstElementChild;hu(o)&&(a=o.getContext("2d"))}if(a&&T$(a.canvas.style.transform,t)?(this.container=e,this.context=a,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){s=ha?tF():document.createElement("div"),s.className=i;let o=s.style;o.position="absolute",o.width="100%",o.height="100%",a=Kr();const l=a.canvas;s.appendChild(l),o=l.style,o.position="absolute",o.left="0",o.transformOrigin="top left",this.container=s,this.context=a}!this.containerReused&&r&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=r)}clipUnrotated(e,t,r){const i=Rd(r),s=vw(r),a=_w(r),o=xw(r);kr(t.coordinateToPixelTransform,i),kr(t.coordinateToPixelTransform,s),kr(t.coordinateToPixelTransform,a),kr(t.coordinateToPixelTransform,o);const l=this.inversePixelTransform;kr(l,i),kr(l,s),kr(l,a),kr(l,o),e.save(),e.beginPath(),e.moveTo(Math.round(i[0]),Math.round(i[1])),e.lineTo(Math.round(s[0]),Math.round(s[1])),e.lineTo(Math.round(a[0]),Math.round(a[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.clip()}prepareContainer(e,t){const r=e.extent,i=e.viewState.resolution,s=e.viewState.rotation,a=e.pixelRatio,o=Math.round(gn(r)/i*a),l=Math.round(ei(r)/i*a);$a(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/a,1/a,s,-o/2,-l/2),wp(this.inversePixelTransform,this.pixelTransform);const c=E$(this.pixelTransform);if(this.useContainer(t,c,this.getBackground(e)),!this.containerReused){const h=this.context.canvas;h.width!=o||h.height!=l?(h.width=o,h.height=l):this.context.clearRect(0,0,o,l),c!==h.style.transform&&(h.style.transform=c)}}dispatchRenderEvent_(e,t,r){const i=this.getLayer();if(i.hasListener(e)){const s=new Gm(e,this.inversePixelTransform,r,t);i.dispatchEvent(s)}}preRender(e,t){this.frameState=t,!t.declutter&&this.dispatchRenderEvent_(Si.PRERENDER,e,t)}postRender(e,t){t.declutter||this.dispatchRenderEvent_(Si.POSTRENDER,e,t)}renderDeferredInternal(e){}getRenderContext(e){return e.declutter&&!this.deferredContext_&&(this.deferredContext_=new TF),e.declutter?this.deferredContext_.getContext():this.context}renderDeferred(e){e.declutter&&(this.dispatchRenderEvent_(Si.PRERENDER,this.context,e),e.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(e),this.dispatchRenderEvent_(Si.POSTRENDER,this.context,e))}getRenderTransform(e,t,r,i,s,a,o){const l=s/2,c=a/2,h=i/t,f=-h,m=-e[0]+o,y=-e[1];return $a(this.tempTransform,l,c,h,f,-r,m,y)}disposeInternal(){delete this.frameState,super.disposeInternal()}}class tH extends RA{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=Us(),this.wrappedRenderedExtent_=Us(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(e,t,r){const i=t.extent,s=t.viewState,a=s.center,o=s.resolution,l=s.projection,c=s.rotation,h=l.getExtent(),f=this.getLayer().getSource(),m=this.getLayer().getDeclutter(),y=t.pixelRatio,x=t.viewHints,_=!(x[Jr.ANIMATING]||x[Jr.INTERACTING]),w=this.context,S=Math.round(gn(i)/o*y),b=Math.round(ei(i)/o*y),R=f.getWrapX()&&l.canWrapX(),M=R?gn(h):null,O=R?Math.ceil((i[2]-h[2])/M)+1:1;let G=R?Math.floor((i[0]-h[0])/M):0;do{let A=this.getRenderTransform(a,o,0,y,S,b,G*M);t.declutter&&(A=A.slice(0)),e.execute(w,[w.canvas.width,w.canvas.height],A,c,_,r===void 0?Mh:r?SF:XW,r?m&&t.declutter[m]:void 0)}while(++G<O)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=Kr(this.context.canvas.width,this.context.canvas.height,FM))}resetDrawContext_(){if(this.opacity_!==1&&this.targetContext_){const e=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=e,Cw(this.context),FM.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(e){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,e,!0)}renderDeferredInternal(e){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(e,t){const r=e.layerStatesArray[e.layerIndex];this.opacity_=r.opacity;const i=e.viewState;this.prepareContainer(e,t);const s=this.context,a=this.replayGroup_;let o=a&&!a.isEmpty();if(!o&&!(this.getLayer().hasListener(Si.PRERENDER)||this.getLayer().hasListener(Si.POSTRENDER)))return this.container;if(this.setDrawContext_(),this.preRender(s,e),i.projection,this.clipped_=!1,o&&r.extent&&this.clipping){const l=Oa(r.extent);o=Es(l,e.extent),this.clipped_=o&&!lu(l,e.extent),this.clipped_&&this.clipUnrotated(s,e,l)}return o&&this.renderWorlds(a,e,this.getLayer().getDeclutter()?!1:void 0),!e.declutter&&this.clipped_&&s.restore(),this.postRender(s,e),this.renderedRotation_!==i.rotation&&(this.renderedRotation_=i.rotation,this.hitDetectionImageData_=null),e.declutter||this.resetDrawContext_(),this.container}getFeatures(e){return new Promise(t=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const r=this.frameState.size.slice(),i=this.renderedCenter_,s=this.renderedResolution_,a=this.renderedRotation_,o=this.renderedProjection_,l=this.wrappedRenderedExtent_,c=this.getLayer(),h=[],f=r[0]*Yo,m=r[1]*Yo;h.push(this.getRenderTransform(i,s,a,Yo,f,m,0).slice());const y=c.getSource(),x=o.getExtent();if(y.getWrapX()&&o.canWrapX()&&!lu(x,l)){let _=l[0];const w=gn(x);let S=0,b;for(;_<x[0];)--S,b=w*S,h.push(this.getRenderTransform(i,s,a,Yo,f,m,b).slice()),_+=w;for(S=0,_=l[2];_>x[2];)++S,b=w*S,h.push(this.getRenderTransform(i,s,a,Yo,f,m,b).slice()),_-=w}this.hitDetectionImageData_=ZW(r,h,this.renderedFeatures_,c.getStyleFunction(),l,s,a,EM(s,this.renderedPixelRatio_))}t(JW(e,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(e,t,r,i,s){if(!this.replayGroup_)return;const a=t.viewState.resolution,o=t.viewState.rotation,l=this.getLayer(),c={},h=function(m,y,x){const _=Bt(m),w=c[_];if(w){if(w!==!0&&x<w.distanceSq){if(x===0)return c[_]=!0,s.splice(s.lastIndexOf(w),1),i(m,l,y);w.geometry=y,w.distanceSq=x}}else{if(x===0)return c[_]=!0,i(m,l,y);s.push(c[_]={feature:m,layer:l,geometry:y,distanceSq:x,callback:i})}},f=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(e,a,o,r,h,f?t.declutter?.[f]?.all().map(m=>m.value):null)}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}prepareFrame(e){const t=this.getLayer(),r=t.getSource();if(!r)return!1;const i=e.viewHints[Jr.ANIMATING],s=e.viewHints[Jr.INTERACTING],a=t.getUpdateWhileAnimating(),o=t.getUpdateWhileInteracting();if(this.ready&&!a&&i||!o&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const l=e.extent,c=e.viewState,h=c.projection,f=c.resolution,m=e.pixelRatio,y=t.getRevision(),x=t.getRenderBuffer();let _=t.getRenderOrder();_===void 0&&(_=fW);const w=c.center.slice(),S=M0(l,x*f),b=S.slice(),R=[S.slice()],M=h.getExtent();if(r.getWrapX()&&h.canWrapX()&&!lu(M,e.extent)){const Ee=gn(M),ke=Math.max(gn(S)/2,Ee);S[0]=M[0]-ke,S[2]=M[2]+ke,MD(w,h);const Be=CD(R[0],h);Be[0]<M[0]&&Be[2]<M[2]?R.push([Be[0]+Ee,Be[1],Be[2]+Ee,Be[3]]):Be[0]>M[0]&&Be[2]>M[2]&&R.push([Be[0]-Ee,Be[1],Be[2]-Ee,Be[3]])}if(this.ready&&this.renderedResolution_==f&&this.renderedRevision_==y&&this.renderedRenderOrder_==_&&this.renderedFrameDeclutter_===!!e.declutter&&lu(this.wrappedRenderedExtent_,S))return fc(this.renderedExtent_,b)||(this.hitDetectionImageData_=null,this.renderedExtent_=b),this.renderedCenter_=w,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const O=new UW(dF(f,m),S,f,m);let G;for(let Ee=0,ke=R.length;Ee<ke;++Ee)r.loadFeatures(R[Ee],f,h);const A=EM(f,m);let I=!0;const P=(Ee,ke)=>{let Be;const Me=Ee.getStyleFunction()||t.getStyleFunction();if(Me&&(Be=Me(Ee,f)),Be){const ce=this.renderFeature(Ee,A,Be,O,G,this.getLayer().getDeclutter(),ke);I=I&&!ce}},D=BD(S),L=r.getFeaturesInExtent(D);_&&L.sort(_);for(let Ee=0,ke=L.length;Ee<ke;++Ee)P(L[Ee],Ee);this.renderedFeatures_=L,this.ready=I;const U=O.finish(),j=new qW(S,f,m,r.getOverlaps(),U,t.getRenderBuffer(),!!e.declutter);return this.renderedResolution_=f,this.renderedRevision_=y,this.renderedRenderOrder_=_,this.renderedFrameDeclutter_=!!e.declutter,this.renderedExtent_=b,this.wrappedRenderedExtent_=S,this.renderedCenter_=w,this.renderedProjection_=h,this.renderedPixelRatio_=m,this.replayGroup_=j,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(e,t,r,i,s,a,o){if(!r)return!1;let l=!1;if(Array.isArray(r))for(let c=0,h=r.length;c<h;++c)l=TM(i,e,r[c],t,this.boundHandleStyleImageChange_,s,a,o)||l;else l=TM(i,e,r,t,this.boundHandleStyleImageChange_,s,a,o);return l}}let Pd=0;const Qr=1<<Pd++,It=1<<Pd++,fi=1<<Pd++,vr=1<<Pd++,Ws=1<<Pd++,Fa=1<<Pd++,Ex=Math.pow(2,Pd)-1,AA={[Qr]:"boolean",[It]:"number",[fi]:"string",[vr]:"color",[Ws]:"number[]",[Fa]:"size"},nH=Object.keys(AA).map(Number).sort(Xl);function rH(n){return n in AA}function r0(n){const e=[];for(const t of nH)Sm(n,t)&&e.push(AA[t]);return e.length===0?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function Sm(n,e){return(n&e)===e}function Xo(n,e){return n===e}class di{constructor(e,t){if(!rH(e))throw new Error(`literal expressions must have a specific type, got ${r0(e)}`);this.type=e,this.value=t}}class AF{constructor(e,t,...r){this.type=e,this.operator=t,this.args=r}}function IA(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function Ci(n,e,t){switch(typeof n){case"boolean":{if(Xo(e,fi))return new di(fi,n?"true":"false");if(!Sm(e,Qr))throw new Error(`got a boolean, but expected ${r0(e)}`);return new di(Qr,n)}case"number":{if(Xo(e,Fa))return new di(Fa,Ii(n));if(Xo(e,Qr))return new di(Qr,!!n);if(Xo(e,fi))return new di(fi,n.toString());if(!Sm(e,It))throw new Error(`got a number, but expected ${r0(e)}`);return new di(It,n)}case"string":{if(Xo(e,vr))return new di(vr,_A(n));if(Xo(e,Qr))return new di(Qr,!!n);if(!Sm(e,fi))throw new Error(`got a string, but expected ${r0(e)}`);return new di(fi,n)}}if(!Array.isArray(n))throw new Error("expression must be an array or a primitive value");if(n.length===0)throw new Error("empty expression");if(typeof n[0]=="string")return gH(n,e,t);for(const r of n)if(typeof r!="number")throw new Error("expected an array of numbers");if(Xo(e,Fa)){if(n.length!==2)throw new Error(`expected an array of two values for a size, got ${n.length}`);return new di(Fa,n)}if(Xo(e,vr)){if(n.length===3)return new di(vr,[...n,1]);if(n.length===4)return new di(vr,n);throw new Error(`expected an array of 3 or 4 values for a color, got ${n.length}`)}if(!Sm(e,Ws))throw new Error(`got an array of numbers, but expected ${r0(e)}`);return new di(Ws,n)}const me={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},iH={[me.Get]:Yt(an(1,1/0),jM),[me.Var]:Yt(an(1,1),sH),[me.Has]:Yt(an(1,1/0),jM),[me.Id]:Yt(aH,Sf),[me.Concat]:Yt(an(2,1/0),Ln(fi)),[me.GeometryType]:Yt(oH,Sf),[me.LineMetric]:Yt(Sf),[me.Resolution]:Yt(LT,Sf),[me.Zoom]:Yt(LT,Sf),[me.Time]:Yt(LT,Sf),[me.Any]:Yt(an(2,1/0),Ln(Qr)),[me.All]:Yt(an(2,1/0),Ln(Qr)),[me.Not]:Yt(an(1,1),Ln(Qr)),[me.Equal]:Yt(an(2,2),Ln(Ex)),[me.NotEqual]:Yt(an(2,2),Ln(Ex)),[me.GreaterThan]:Yt(an(2,2),Ln(It)),[me.GreaterThanOrEqualTo]:Yt(an(2,2),Ln(It)),[me.LessThan]:Yt(an(2,2),Ln(It)),[me.LessThanOrEqualTo]:Yt(an(2,2),Ln(It)),[me.Multiply]:Yt(an(2,1/0),VM),[me.Coalesce]:Yt(an(2,1/0),VM),[me.Divide]:Yt(an(2,2),Ln(It)),[me.Add]:Yt(an(2,1/0),Ln(It)),[me.Subtract]:Yt(an(2,2),Ln(It)),[me.Clamp]:Yt(an(3,3),Ln(It)),[me.Mod]:Yt(an(2,2),Ln(It)),[me.Pow]:Yt(an(2,2),Ln(It)),[me.Abs]:Yt(an(1,1),Ln(It)),[me.Floor]:Yt(an(1,1),Ln(It)),[me.Ceil]:Yt(an(1,1),Ln(It)),[me.Round]:Yt(an(1,1),Ln(It)),[me.Sin]:Yt(an(1,1),Ln(It)),[me.Cos]:Yt(an(1,1),Ln(It)),[me.Atan]:Yt(an(1,2),Ln(It)),[me.Sqrt]:Yt(an(1,1),Ln(It)),[me.Match]:Yt(an(4,1/0),GM,cH),[me.Between]:Yt(an(3,3),Ln(It)),[me.Interpolate]:Yt(an(6,1/0),GM,uH),[me.Case]:Yt(an(3,1/0),lH,hH),[me.In]:Yt(an(2,2),dH),[me.Number]:Yt(an(1,1/0),Ln(Ex)),[me.String]:Yt(an(1,1/0),Ln(Ex)),[me.Array]:Yt(an(1,1/0),Ln(It)),[me.Color]:Yt(an(1,4),Ln(It)),[me.Band]:Yt(an(1,3),Ln(It)),[me.Palette]:Yt(an(2,2),fH),[me.ToString]:Yt(an(1,1),Ln(Qr|It|fi|vr))};function jM(n,e,t){const r=n.length-1,i=new Array(r);for(let s=0;s<r;++s){const a=n[s+1];switch(typeof a){case"number":{i[s]=new di(It,a);break}case"string":{i[s]=new di(fi,a);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${a}`)}s===0&&t.properties.add(String(a))}return i}function sH(n,e,t){const r=n[1];if(typeof r!="string")throw new Error("expected a string argument for var operation");return t.variables.add(r),[new di(fi,r)]}function aH(n,e,t){t.featureId=!0}function oH(n,e,t){t.geometryType=!0}function LT(n,e,t){t.mapState=!0}function Sf(n,e,t){const r=n[0];if(n.length!==1)throw new Error(`expected no arguments for ${r} operation`);return[]}function an(n,e){return function(t,r,i){const s=t[0],a=t.length-1;if(n===e){if(a!==n){const o=n===1?"":"s";throw new Error(`expected ${n} argument${o} for ${s}, got ${a}`)}}else if(a<n||a>e){const o=e===1/0?`${n} or more`:`${n} to ${e}`;throw new Error(`expected ${o} arguments for ${s}, got ${a}`)}}}function VM(n,e,t){const r=n.length-1,i=new Array(r);for(let s=0;s<r;++s){const a=Ci(n[s+1],e,t);i[s]=a}return i}function Ln(n){return function(e,t,r){const i=e.length-1,s=new Array(i);for(let a=0;a<i;++a){const o=Ci(e[a+1],n,r);s[a]=o}return s}}function lH(n,e,t){const r=n[0],i=n.length-1;if(i%2===0)throw new Error(`expected an odd number of arguments for ${r}, got ${i} instead`)}function GM(n,e,t){const r=n[0],i=n.length-1;if(i%2===1)throw new Error(`expected an even number of arguments for operation ${r}, got ${i} instead`)}function cH(n,e,t){const r=n.length-1,i=fi|It|Qr,s=Ci(n[1],i,t),a=Ci(n[n.length-1],e,t),o=new Array(r-2);for(let l=0;l<r-2;l+=2){try{const c=Ci(n[l+2],s.type,t);o[l]=c}catch(c){throw new Error(`failed to parse argument ${l+1} of match expression: ${c.message}`)}try{const c=Ci(n[l+3],a.type,t);o[l+1]=c}catch(c){throw new Error(`failed to parse argument ${l+2} of match expression: ${c.message}`)}}return[s,...o,a]}function uH(n,e,t){const r=n[1];let i;switch(r[0]){case"linear":i=1;break;case"exponential":const l=r[1];if(typeof l!="number"||l<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(l)} instead`);i=l;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(r)}`)}const s=new di(It,i);let a;try{a=Ci(n[2],It,t)}catch(l){throw new Error(`failed to parse argument 1 in interpolate expression: ${l.message}`)}const o=new Array(n.length-3);for(let l=0;l<o.length;l+=2){try{const c=Ci(n[l+3],It,t);o[l]=c}catch(c){throw new Error(`failed to parse argument ${l+2} for interpolate expression: ${c.message}`)}try{const c=Ci(n[l+4],e,t);o[l+1]=c}catch(c){throw new Error(`failed to parse argument ${l+3} for interpolate expression: ${c.message}`)}}return[s,a,...o]}function hH(n,e,t){const r=Ci(n[n.length-1],e,t),i=new Array(n.length-1);for(let s=0;s<i.length-1;s+=2){try{const a=Ci(n[s+1],Qr,t);i[s]=a}catch(a){throw new Error(`failed to parse argument ${s} of case expression: ${a.message}`)}try{const a=Ci(n[s+2],r.type,t);i[s+1]=a}catch(a){throw new Error(`failed to parse argument ${s+1} of case expression: ${a.message}`)}}return i[i.length-1]=r,i}function dH(n,e,t){let r=n[2];if(!Array.isArray(r))throw new Error('the second argument for the "in" operator must be an array');let i;if(typeof r[0]=="string"){if(r[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(r[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');r=r[1],i=fi}else i=It;const s=new Array(r.length);for(let o=0;o<s.length;o++)try{const l=Ci(r[o],i,t);s[o]=l}catch(l){throw new Error(`failed to parse haystack item ${o} for "in" expression: ${l.message}`)}return[Ci(n[1],i,t),...s]}function fH(n,e,t){let r;try{r=Ci(n[1],It,t)}catch(a){throw new Error(`failed to parse first argument in palette expression: ${a.message}`)}const i=n[2];if(!Array.isArray(i))throw new Error("the second argument of palette must be an array");const s=new Array(i.length);for(let a=0;a<s.length;a++){let o;try{o=Ci(i[a],vr,t)}catch(l){throw new Error(`failed to parse color at index ${a} in palette expression: ${l.message}`)}if(!(o instanceof di))throw new Error(`the palette color at index ${a} must be a literal value`);s[a]=o}return[r,...s]}function Yt(...n){return function(e,t,r){const i=e[0];let s;for(let a=0;a<n.length;a++){const o=n[a](e,t,r);if(a==n.length-1){if(!o)throw new Error("expected last argument validator to return the parsed args");s=o}}return new AF(t,i,...s)}}function gH(n,e,t){const r=n[0],i=iH[r];if(!i)throw new Error(`unknown operator: ${r}`);return i(n,e,t)}function CA(n){if(!n)return"";const e=n.getType();switch(e){case"Point":case"LineString":case"Polygon":return e;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return e.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return CA(n.getGeometries()[0]);default:return""}}function IF(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function mc(n,e,t){const r=Ci(n,e,t);return bo(r)}function bo(n,e){if(n instanceof di){if(n.type===vr&&typeof n.value=="string"){const r=_A(n.value);return function(){return r}}return function(){return n.value}}const t=n.operator;switch(t){case me.Number:case me.String:case me.Coalesce:return mH(n);case me.Get:case me.Var:case me.Has:return pH(n);case me.Id:return r=>r.featureId;case me.GeometryType:return r=>r.geometryType;case me.Concat:{const r=n.args.map(i=>bo(i));return i=>"".concat(...r.map(s=>s(i).toString()))}case me.Resolution:return r=>r.resolution;case me.Any:case me.All:case me.Between:case me.In:case me.Not:return xH(n);case me.Equal:case me.NotEqual:case me.LessThan:case me.LessThanOrEqualTo:case me.GreaterThan:case me.GreaterThanOrEqualTo:return yH(n);case me.Multiply:case me.Divide:case me.Add:case me.Subtract:case me.Clamp:case me.Mod:case me.Pow:case me.Abs:case me.Floor:case me.Ceil:case me.Round:case me.Sin:case me.Cos:case me.Atan:case me.Sqrt:return _H(n);case me.Case:return vH(n);case me.Match:return wH(n);case me.Interpolate:return EH(n);case me.ToString:return TH(n);default:throw new Error(`Unsupported operator ${t}`)}}function mH(n,e){const t=n.operator,r=n.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=bo(n.args[s]);switch(t){case me.Coalesce:return s=>{for(let a=0;a<r;++a){const o=i[a](s);if(typeof o<"u"&&o!==null)return o}throw new Error("Expected one of the values to be non-null")};case me.Number:case me.String:return s=>{for(let a=0;a<r;++a){const o=i[a](s);if(typeof o===t)return o}throw new Error(`Expected one of the values to be a ${t}`)};default:throw new Error(`Unsupported assertion operator ${t}`)}}function pH(n,e){const r=n.args[0].value;switch(n.operator){case me.Get:return i=>{const s=n.args;let a=i.properties[r];for(let o=1,l=s.length;o<l;++o){const h=s[o].value;a=a[h]}return a};case me.Var:return i=>i.variables[r];case me.Has:return i=>{const s=n.args;if(!(r in i.properties))return!1;let a=i.properties[r];for(let o=1,l=s.length;o<l;++o){const h=s[o].value;if(!a||!Object.hasOwn(a,h))return!1;a=a[h]}return!0};default:throw new Error(`Unsupported accessor operator ${n.operator}`)}}function yH(n,e){const t=n.operator,r=bo(n.args[0]),i=bo(n.args[1]);switch(t){case me.Equal:return s=>r(s)===i(s);case me.NotEqual:return s=>r(s)!==i(s);case me.LessThan:return s=>r(s)<i(s);case me.LessThanOrEqualTo:return s=>r(s)<=i(s);case me.GreaterThan:return s=>r(s)>i(s);case me.GreaterThanOrEqualTo:return s=>r(s)>=i(s);default:throw new Error(`Unsupported comparison operator ${t}`)}}function xH(n,e){const t=n.operator,r=n.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=bo(n.args[s]);switch(t){case me.Any:return s=>{for(let a=0;a<r;++a)if(i[a](s))return!0;return!1};case me.All:return s=>{for(let a=0;a<r;++a)if(!i[a](s))return!1;return!0};case me.Between:return s=>{const a=i[0](s),o=i[1](s),l=i[2](s);return a>=o&&a<=l};case me.In:return s=>{const a=i[0](s);for(let o=1;o<r;++o)if(a===i[o](s))return!0;return!1};case me.Not:return s=>!i[0](s);default:throw new Error(`Unsupported logical operator ${t}`)}}function _H(n,e){const t=n.operator,r=n.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=bo(n.args[s]);switch(t){case me.Multiply:return s=>{let a=1;for(let o=0;o<r;++o)a*=i[o](s);return a};case me.Divide:return s=>i[0](s)/i[1](s);case me.Add:return s=>{let a=0;for(let o=0;o<r;++o)a+=i[o](s);return a};case me.Subtract:return s=>i[0](s)-i[1](s);case me.Clamp:return s=>{const a=i[0](s),o=i[1](s);if(a<o)return o;const l=i[2](s);return a>l?l:a};case me.Mod:return s=>i[0](s)%i[1](s);case me.Pow:return s=>Math.pow(i[0](s),i[1](s));case me.Abs:return s=>Math.abs(i[0](s));case me.Floor:return s=>Math.floor(i[0](s));case me.Ceil:return s=>Math.ceil(i[0](s));case me.Round:return s=>Math.round(i[0](s));case me.Sin:return s=>Math.sin(i[0](s));case me.Cos:return s=>Math.cos(i[0](s));case me.Atan:return r===2?s=>Math.atan2(i[0](s),i[1](s)):s=>Math.atan(i[0](s));case me.Sqrt:return s=>Math.sqrt(i[0](s));default:throw new Error(`Unsupported numeric operator ${t}`)}}function vH(n,e){const t=n.args.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=bo(n.args[i]);return i=>{for(let s=0;s<t-1;s+=2)if(r[s](i))return r[s+1](i);return r[t-1](i)}}function wH(n,e){const t=n.args.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=bo(n.args[i]);return i=>{const s=r[0](i);for(let a=1;a<t-1;a+=2)if(s===r[a](i))return r[a+1](i);return r[t-1](i)}}function EH(n,e){const t=n.args.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=bo(n.args[i]);return i=>{const s=r[0](i),a=r[1](i);let o,l;for(let c=2;c<t;c+=2){const h=r[c](i);let f=r[c+1](i);const m=Array.isArray(f);if(m&&(f=Z$(f)),h>=a)return c===2?f:m?SH(s,a,o,l,h,f):bm(s,a,o,l,h,f);o=h,l=f}return l}}function TH(n,e){const t=n.operator,r=n.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=bo(n.args[s]);switch(t){case me.ToString:return s=>{const a=i[0](s);return n.args[0].type===vr?vA(a):a.toString()};default:throw new Error(`Unsupported convert operator ${t}`)}}function bm(n,e,t,r,i,s){const a=i-t;if(a===0)return r;const o=e-t,l=n===1?o/a:(Math.pow(n,o)-1)/(Math.pow(n,a)-1);return r+l*(s-r)}function SH(n,e,t,r,i,s){if(i-t===0)return r;const o=yM(r),l=yM(s);let c=l[2]-o[2];c>180?c-=360:c<-180&&(c+=360);const h=[bm(n,e,t,o[0],i,l[0]),bm(n,e,t,o[1],i,l[1]),o[2]+bm(n,e,t,0,i,c),bm(n,e,t,r[3],i,s[3])];return J$(h)}function bH(n){return!0}function RH(n){const e=IA(),t=AH(n,e),r=IF();return function(i,s){if(r.properties=i.getPropertiesInternal(),r.resolution=s,e.featureId){const a=i.getId();a!==void 0?r.featureId=a:r.featureId=null}return e.geometryType&&(r.geometryType=CA(i.getGeometry())),t(r)}}function BM(n){const e=IA(),t=n.length,r=new Array(t);for(let a=0;a<t;++a)r[a]=yb(n[a],e);const i=IF(),s=new Array(t);return function(a,o){if(i.properties=a.getPropertiesInternal(),i.resolution=o,e.featureId){const c=a.getId();c!==void 0?i.featureId=c:i.featureId=null}let l=0;for(let c=0;c<t;++c){const h=r[c](i);h&&(s[l]=h,l+=1)}return s.length=l,s}}function AH(n,e){const t=n.length,r=new Array(t);for(let i=0;i<t;++i){const s=n[i],a="filter"in s?mc(s.filter,Qr,e):bH;let o;if(Array.isArray(s.style)){const l=s.style.length;o=new Array(l);for(let c=0;c<l;++c)o[c]=yb(s.style[c],e)}else o=[yb(s.style,e)];r[i]={filter:a,styles:o}}return function(i){const s=[];let a=!1;for(let o=0;o<t;++o){const l=r[o].filter;if(l(i)&&!(n[o].else&&a)){a=!0;for(const c of r[o].styles){const h=c(i);h&&s.push(h)}}}return s}}function yb(n,e){const t=Ip(n,"",e),r=Cp(n,"",e),i=IH(n,e),s=CH(n,e),a=js(n,"z-index",e);if(!t&&!r&&!i&&!s&&!nd(n))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(n));const o=new mn;return function(l){let c=!0;if(t){const h=t(l);h&&(c=!1),o.setFill(h)}if(r){const h=r(l);h&&(c=!1),o.setStroke(h)}if(i){const h=i(l);h&&(c=!1),o.setText(h)}if(s){const h=s(l);h&&(c=!1),o.setImage(h)}return a&&o.setZIndex(a(l)),c?null:o}}function Ip(n,e,t){let r;if(e+"fill-pattern-src"in n)r=NH(n,e+"fill-",t);else{if(n[e+"fill-color"]==="none")return s=>null;r=kA(n,e+"fill-color",t)}if(!r)return null;const i=new rr;return function(s){const a=r(s);return a===xA?null:(i.setColor(a),i)}}function Cp(n,e,t){const r=js(n,e+"stroke-width",t),i=kA(n,e+"stroke-color",t);if(!r&&!i)return null;const s=Bl(n,e+"stroke-line-cap",t),a=Bl(n,e+"stroke-line-join",t),o=CF(n,e+"stroke-line-dash",t),l=js(n,e+"stroke-line-dash-offset",t),c=js(n,e+"stroke-miter-limit",t),h=new Yn;return function(f){if(i){const m=i(f);if(m===xA)return null;h.setColor(m)}if(r&&h.setWidth(r(f)),s){const m=s(f);if(m!=="butt"&&m!=="round"&&m!=="square")throw new Error("Expected butt, round, or square line cap");h.setLineCap(m)}if(a){const m=a(f);if(m!=="bevel"&&m!=="round"&&m!=="miter")throw new Error("Expected bevel, round, or miter line join");h.setLineJoin(m)}return o&&h.setLineDash(o(f)),l&&h.setLineDashOffset(l(f)),c&&h.setMiterLimit(c(f)),h}}function IH(n,e){const t="text-",r=Bl(n,t+"value",e);if(!r)return null;const i=Ip(n,t,e),s=Ip(n,t+"background-",e),a=Cp(n,t,e),o=Cp(n,t+"background-",e),l=Bl(n,t+"font",e),c=js(n,t+"max-angle",e),h=js(n,t+"offset-x",e),f=js(n,t+"offset-y",e),m=m0(n,t+"overflow",e),y=Bl(n,t+"placement",e),x=js(n,t+"repeat",e),_=Mw(n,t+"scale",e),w=m0(n,t+"rotate-with-view",e),S=js(n,t+"rotation",e),b=Bl(n,t+"align",e),R=Bl(n,t+"justify",e),M=Bl(n,t+"baseline",e),O=m0(n,t+"keep-upright",e),G=CF(n,t+"padding",e),A=Nw(n,t+"declutter-mode"),I=new vo({declutterMode:A});return function(P){if(I.setText(r(P)),i&&I.setFill(i(P)),s&&I.setBackgroundFill(s(P)),a&&I.setStroke(a(P)),o&&I.setBackgroundStroke(o(P)),l&&I.setFont(l(P)),c&&I.setMaxAngle(c(P)),h&&I.setOffsetX(h(P)),f&&I.setOffsetY(f(P)),m&&I.setOverflow(m(P)),y){const D=y(P);if(D!=="point"&&D!=="line")throw new Error("Expected point or line for text-placement");I.setPlacement(D)}if(x&&I.setRepeat(x(P)),_&&I.setScale(_(P)),w&&I.setRotateWithView(w(P)),S&&I.setRotation(S(P)),b){const D=b(P);if(D!=="left"&&D!=="center"&&D!=="right"&&D!=="end"&&D!=="start")throw new Error("Expected left, right, center, start, or end for text-align");I.setTextAlign(D)}if(R){const D=R(P);if(D!=="left"&&D!=="right"&&D!=="center")throw new Error("Expected left, right, or center for text-justify");I.setJustify(D)}if(M){const D=M(P);if(D!=="bottom"&&D!=="top"&&D!=="middle"&&D!=="alphabetic"&&D!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");I.setTextBaseline(D)}return G&&I.setPadding(G(P)),O&&I.setKeepUpright(O(P)),I}}function CH(n,e){return"icon-src"in n?kH(n,e):"shape-points"in n?PH(n,e):"circle-radius"in n?MH(n,e):null}function kH(n,e){const t="icon-",r=t+"src",i=kF(n[r],r),s=W_(n,t+"anchor",e),a=Mw(n,t+"scale",e),o=js(n,t+"opacity",e),l=W_(n,t+"displacement",e),c=js(n,t+"rotation",e),h=m0(n,t+"rotate-with-view",e),f=UM(n,t+"anchor-origin"),m=$M(n,t+"anchor-x-units"),y=$M(n,t+"anchor-y-units"),x=FH(n,t+"color"),_=OH(n,t+"cross-origin"),w=DH(n,t+"offset"),S=UM(n,t+"offset-origin"),b=H_(n,t+"width"),R=H_(n,t+"height"),M=LH(n,t+"size"),O=Nw(n,t+"declutter-mode"),G=new by({src:i,anchorOrigin:f,anchorXUnits:m,anchorYUnits:y,color:x,crossOrigin:_,offset:w,offsetOrigin:S,height:R,width:b,size:M,declutterMode:O});return function(A){return o&&G.setOpacity(o(A)),l&&G.setDisplacement(l(A)),c&&G.setRotation(c(A)),h&&G.setRotateWithView(h(A)),a&&G.setScale(a(A)),s&&G.setAnchor(s(A)),G}}function PH(n,e){const t="shape-",r=t+"points",i=t+"radius",s=xb(n[r],r),a=xb(n[i],i),o=Ip(n,t,e),l=Cp(n,t,e),c=Mw(n,t+"scale",e),h=W_(n,t+"displacement",e),f=js(n,t+"rotation",e),m=m0(n,t+"rotate-with-view",e),y=H_(n,t+"radius2"),x=H_(n,t+"angle"),_=Nw(n,t+"declutter-mode"),w=new Pw({points:s,radius:a,radius2:y,angle:x,declutterMode:_});return function(S){return o&&w.setFill(o(S)),l&&w.setStroke(l(S)),h&&w.setDisplacement(h(S)),f&&w.setRotation(f(S)),m&&w.setRotateWithView(m(S)),c&&w.setScale(c(S)),w}}function MH(n,e){const t="circle-",r=Ip(n,t,e),i=Cp(n,t,e),s=js(n,t+"radius",e),a=Mw(n,t+"scale",e),o=W_(n,t+"displacement",e),l=js(n,t+"rotation",e),c=m0(n,t+"rotate-with-view",e),h=Nw(n,t+"declutter-mode"),f=new $s({radius:5,declutterMode:h});return function(m){return s&&f.setRadius(s(m)),r&&f.setFill(r(m)),i&&f.setStroke(i(m)),o&&f.setDisplacement(o(m)),l&&f.setRotation(l(m)),c&&f.setRotateWithView(c(m)),a&&f.setScale(a(m)),f}}function js(n,e,t){if(!(e in n))return;const r=mc(n[e],It,t);return function(i){return xb(r(i),e)}}function Bl(n,e,t){if(!(e in n))return null;const r=mc(n[e],fi,t);return function(i){return kF(r(i),e)}}function NH(n,e,t){const r=Bl(n,e+"pattern-src",t),i=zM(n,e+"pattern-offset",t),s=zM(n,e+"pattern-size",t),a=kA(n,e+"color",t);return function(o){return{src:r(o),offset:i&&i(o),size:s&&s(o),color:a&&a(o)}}}function m0(n,e,t){if(!(e in n))return null;const r=mc(n[e],Qr,t);return function(i){const s=r(i);if(typeof s!="boolean")throw new Error(`Expected a boolean for ${e}`);return s}}function kA(n,e,t){if(!(e in n))return null;const r=mc(n[e],vr,t);return function(i){return PF(r(i),e)}}function CF(n,e,t){if(!(e in n))return null;const r=mc(n[e],Ws,t);return function(i){return Ry(r(i),e)}}function W_(n,e,t){if(!(e in n))return null;const r=mc(n[e],Ws,t);return function(i){const s=Ry(r(i),e);if(s.length!==2)throw new Error(`Expected two numbers for ${e}`);return s}}function zM(n,e,t){if(!(e in n))return null;const r=mc(n[e],Ws,t);return function(i){return MF(r(i),e)}}function Mw(n,e,t){if(!(e in n))return null;const r=mc(n[e],Ws|It,t);return function(i){return jH(r(i),e)}}function H_(n,e){const t=n[e];if(t!==void 0){if(typeof t!="number")throw new Error(`Expected a number for ${e}`);return t}}function LH(n,e){const t=n[e];if(t!==void 0){if(typeof t=="number")return Ii(t);if(!Array.isArray(t))throw new Error(`Expected a number or size array for ${e}`);if(t.length!==2||typeof t[0]!="number"||typeof t[1]!="number")throw new Error(`Expected a number or size array for ${e}`);return t}}function OH(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);return t}}function UM(n,e){const t=n[e];if(t!==void 0){if(t!=="bottom-left"&&t!=="bottom-right"&&t!=="top-left"&&t!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return t}}function $M(n,e){const t=n[e];if(t!==void 0){if(t!=="pixels"&&t!=="fraction")throw new Error(`Expected pixels or fraction for ${e}`);return t}}function DH(n,e){const t=n[e];if(t!==void 0)return Ry(t,e)}function Nw(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);if(t!=="declutter"&&t!=="obstacle"&&t!=="none")throw new Error(`Expected declutter, obstacle, or none for ${e}`);return t}}function FH(n,e){const t=n[e];if(t!==void 0)return PF(t,e)}function Ry(n,e){if(!Array.isArray(n))throw new Error(`Expected an array for ${e}`);const t=n.length;for(let r=0;r<t;++r)if(typeof n[r]!="number")throw new Error(`Expected an array of numbers for ${e}`);return n}function kF(n,e){if(typeof n!="string")throw new Error(`Expected a string for ${e}`);return n}function xb(n,e){if(typeof n!="number")throw new Error(`Expected a number for ${e}`);return n}function PF(n,e){if(typeof n=="string")return n;const t=Ry(n,e),r=t.length;if(r<3||r>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return t}function MF(n,e){const t=Ry(n,e);if(t.length!==2)throw new Error(`Expected an array of two numbers for ${e}`);return t}function jH(n,e){return typeof n=="number"?n:MF(n,e)}const io={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function WM(n,e,t){return(function(r,i,s,a,o){if(!r)return;if(!i&&!e)return r;const l=e?0:s[0]*i,c=e?0:s[1]*i,h=o?o[0]:0,f=o?o[1]:0;let m=n[0]+l/2+h,y=n[2]-l/2+h,x=n[1]+c/2+f,_=n[3]-c/2+f;m>y&&(m=(y+m)/2,y=m),x>_&&(x=(_+x)/2,_=x);let w=ur(r[0],m,y),S=ur(r[1],x,_);if(a&&t&&i){const b=30*i;w+=-b*Math.log(1+Math.max(0,m-r[0])/b)+b*Math.log(1+Math.max(0,r[0]-y)/b),S+=-b*Math.log(1+Math.max(0,x-r[1])/b)+b*Math.log(1+Math.max(0,r[1]-_)/b)}return[w,S]})}function VH(n){return n}function NF(n){return Math.pow(n,3)}function cg(n){return 1-NF(1-n)}function GH(n){return 3*n*n-2*n*n*n}function BH(n){return n}function PA(n,e,t,r){const i=gn(e)/t[0],s=ei(e)/t[1];return r?Math.min(n,Math.max(i,s)):Math.min(n,Math.min(i,s))}function MA(n,e,t){let r=Math.min(n,e);const i=50;return r*=Math.log(1+i*Math.max(0,n/e-1))/i+1,t&&(r=Math.max(r,t),r/=Math.log(1+i*Math.max(0,t/n-1))/i+1),ur(r,t/2,e*2)}function zH(n,e,t,r){return e=e!==void 0?e:!0,(function(i,s,a,o){if(i!==void 0){const l=n[0],c=n[n.length-1],h=t?PA(l,t,a,r):l;if(o)return e?MA(i,h,c):ur(i,c,h);const f=Math.min(h,i),m=Math.floor(pw(n,f,s));return n[m]>h&&m<n.length-1?n[m+1]:n[m]}})}function UH(n,e,t,r,i,s){return r=r!==void 0?r:!0,t=t!==void 0?t:0,(function(a,o,l,c){if(a!==void 0){const h=i?PA(e,i,l,s):e;if(c)return r?MA(a,h,t):ur(a,t,h);const f=1e-9,m=Math.ceil(Math.log(e/h)/Math.log(n)-f),y=-o*(.5-f)+.5,x=Math.min(h,a),_=Math.floor(Math.log(e/x)/Math.log(n)+y),w=Math.max(m,_),S=e/Math.pow(n,w);return ur(S,t,h)}})}function HM(n,e,t,r,i){return t=t!==void 0?t:!0,(function(s,a,o,l){if(s!==void 0){const c=r?PA(n,r,o,i):n;return!t||!l?ur(s,e,c):MA(s,c,e)}})}function NA(n){if(n!==void 0)return 0}function KM(n){if(n!==void 0)return n}function $H(n){const e=2*Math.PI/n;return(function(t,r){if(r)return t;if(t!==void 0)return t=Math.floor(t/e+.5)*e,t})}function WH(n){const e=ql(5);return(function(t,r){return r||t===void 0?t:Math.abs(t)<=e?0:t})}const HH=42,LA=256,OT=0;class Zo extends yl{constructor(e){super(),this.on,this.once,this.un,e=Object.assign({},e),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=oA(e.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,e.projection&&GD(),e.center&&(e.center=Vl(e.center,this.projection_)),e.extent&&(e.extent=Oa(e.extent,this.projection_)),this.applyOptions_(e)}applyOptions_(e){const t=Object.assign({},e);for(const o in io)delete t[o];this.setProperties(t,!0);const r=XH(e);this.maxResolution_=r.maxResolution,this.minResolution_=r.minResolution,this.zoomFactor_=r.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=r.minZoom;const i=KH(e),s=r.constraint,a=qH(e);this.constraints_={center:i,resolution:s,rotation:a},this.setRotation(e.rotation!==void 0?e.rotation:0),this.setCenterInternal(e.center!==void 0?e.center:null),e.resolution!==void 0?this.setResolution(e.resolution):e.zoom!==void 0&&this.setZoom(e.zoom)}get padding(){return this.padding_}set padding(e){let t=this.padding_;this.padding_=e;const r=this.getCenterInternal();if(r){const i=e||[0,0,0,0];t=t||[0,0,0,0];const s=this.getResolution(),a=s/2*(i[3]-t[3]+t[1]-i[1]),o=s/2*(i[0]-t[0]+t[2]-i[2]);this.setCenterInternal([r[0]+a,r[1]-o])}}getUpdatedOptions_(e){const t=this.getProperties();return t.resolution!==void 0?t.resolution=this.getResolution():t.zoom=this.getZoom(),t.center=this.getCenterInternal(),t.rotation=this.getRotation(),Object.assign({},t,e)}animate(e){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const t=new Array(arguments.length);for(let r=0;r<t.length;++r){let i=arguments[r];i.center&&(i=Object.assign({},i),i.center=Vl(i.center,this.getProjection())),i.anchor&&(i=Object.assign({},i),i.anchor=Vl(i.anchor,this.getProjection())),t[r]=i}this.animateInternal.apply(this,t)}animateInternal(e){let t=arguments.length,r;t>1&&typeof arguments[t-1]=="function"&&(r=arguments[t-1],--t);let i=0;for(;i<t&&!this.isDef();++i){const h=arguments[i];h.center&&this.setCenterInternal(h.center),h.zoom!==void 0?this.setZoom(h.zoom):h.resolution&&this.setResolution(h.resolution),h.rotation!==void 0&&this.setRotation(h.rotation)}if(i===t){r&&Tx(r,!0);return}let s=Date.now(),a=this.targetCenter_.slice(),o=this.targetResolution_,l=this.targetRotation_;const c=[];for(;i<t;++i){const h=arguments[i],f={start:s,complete:!1,anchor:h.anchor,duration:h.duration!==void 0?h.duration:1e3,easing:h.easing||GH,callback:r};if(h.center&&(f.sourceCenter=a,f.targetCenter=h.center.slice(),a=f.targetCenter),h.zoom!==void 0?(f.sourceResolution=o,f.targetResolution=this.getResolutionForZoom(h.zoom),o=f.targetResolution):h.resolution&&(f.sourceResolution=o,f.targetResolution=h.resolution,o=f.targetResolution),h.rotation!==void 0){f.sourceRotation=l;const m=vu(h.rotation-l+Math.PI,2*Math.PI)-Math.PI;f.targetRotation=l+m,l=f.targetRotation}YH(f)?f.complete=!0:s+=f.duration,c.push(f)}this.animations_.push(c),this.setHint(Jr.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[Jr.ANIMATING]>0}getInteracting(){return this.hints_[Jr.INTERACTING]>0}cancelAnimations(){this.setHint(Jr.ANIMATING,-this.hints_[Jr.ANIMATING]);let e;for(let t=0,r=this.animations_.length;t<r;++t){const i=this.animations_[t];if(i[0].callback&&Tx(i[0].callback,!1),!e)for(let s=0,a=i.length;s<a;++s){const o=i[s];if(!o.complete){e=o.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=e,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const e=Date.now();let t=!1;for(let r=this.animations_.length-1;r>=0;--r){const i=this.animations_[r];let s=!0;for(let a=0,o=i.length;a<o;++a){const l=i[a];if(l.complete)continue;const c=e-l.start;let h=l.duration>0?c/l.duration:1;h>=1?(l.complete=!0,h=1):s=!1;const f=l.easing(h);if(l.sourceCenter){const m=l.sourceCenter[0],y=l.sourceCenter[1],x=l.targetCenter[0],_=l.targetCenter[1];this.nextCenter_=l.targetCenter;const w=m+f*(x-m),S=y+f*(_-y);this.targetCenter_=[w,S]}if(l.sourceResolution&&l.targetResolution){const m=f===1?l.targetResolution:l.sourceResolution+f*(l.targetResolution-l.sourceResolution);if(l.anchor){const y=this.getViewportSize_(this.getRotation()),x=this.constraints_.resolution(m,0,y,!0);this.targetCenter_=this.calculateCenterZoom(x,l.anchor)}this.nextResolution_=l.targetResolution,this.targetResolution_=m,this.applyTargetState_(!0)}if(l.sourceRotation!==void 0&&l.targetRotation!==void 0){const m=f===1?vu(l.targetRotation+Math.PI,2*Math.PI)-Math.PI:l.sourceRotation+f*(l.targetRotation-l.sourceRotation);if(l.anchor){const y=this.constraints_.rotation(m,!0);this.targetCenter_=this.calculateCenterRotate(y,l.anchor)}this.nextRotation_=l.targetRotation,this.targetRotation_=m}if(this.applyTargetState_(!0),t=!0,!l.complete)break}if(s){this.animations_[r]=null,this.setHint(Jr.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const a=i[0].callback;a&&Tx(a,!0)}}this.animations_=this.animations_.filter(Boolean),t&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(e,t){let r;const i=this.getCenterInternal();return i!==void 0&&(r=[i[0]-t[0],i[1]-t[1]],rA(r,e-this.getRotation()),zU(r,t)),r}calculateCenterZoom(e,t){let r;const i=this.getCenterInternal(),s=this.getResolution();if(i!==void 0&&s!==void 0){const a=t[0]-e*(t[0]-i[0])/s,o=t[1]-e*(t[1]-i[1])/s;r=[a,o]}return r}getViewportSize_(e){const t=this.viewportSize_;if(e){const r=t[0],i=t[1];return[Math.abs(r*Math.cos(e))+Math.abs(i*Math.sin(e)),Math.abs(r*Math.sin(e))+Math.abs(i*Math.cos(e))]}return t}setViewportSize(e){this.viewportSize_=Array.isArray(e)?e.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const e=this.getCenterInternal();return e&&cb(e,this.getProjection())}getCenterInternal(){return this.get(io.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(e){return e!==void 0?(e[0]=this.hints_[0],e[1]=this.hints_[1],e):this.hints_.slice()}calculateExtent(e){const t=this.calculateExtentInternal(e);return BD(t,this.getProjection())}calculateExtentInternal(e){e=e||this.getViewportSizeMinusPadding_();const t=this.getCenterInternal();bn(t,"The view center is not defined");const r=this.getResolution();bn(r!==void 0,"The view resolution is not defined");const i=this.getRotation();return bn(i!==void 0,"The view rotation is not defined"),M_(t,r,i,e)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))}setConstrainResolution(e){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:e}))}getProjection(){return this.projection_}getResolution(){return this.get(io.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(e,t){return this.getResolutionForExtentInternal(Oa(e,this.getProjection()),t)}getResolutionForExtentInternal(e,t){t=t||this.getViewportSizeMinusPadding_();const r=gn(e)/t[0],i=ei(e)/t[1];return Math.max(r,i)}getResolutionForValueFunction(e){e=e||2;const t=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,i=Math.log(t/r)/Math.log(e);return(function(s){return t/Math.pow(e,s*i)})}getRotation(){return this.get(io.ROTATION)}getValueForResolutionFunction(e){const t=Math.log(e||2),r=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,s=Math.log(r/i)/t;return(function(a){return Math.log(r/a)/t/s})}getViewportSizeMinusPadding_(e){let t=this.getViewportSize_(e);const r=this.padding_;return r&&(t=[t[0]-r[1]-r[3],t[1]-r[0]-r[2]]),t}getState(){const e=this.getProjection(),t=this.getResolution(),r=this.getRotation();let i=this.getCenterInternal();const s=this.padding_;if(s){const a=this.getViewportSizeMinusPadding_();i=DT(i,this.getViewportSize_(),[a[0]/2+s[3],a[1]/2+s[0]],t,r)}return{center:i.slice(0),projection:e!==void 0?e:null,resolution:t,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:r,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let e;const t=this.getResolution();return t!==void 0&&(e=this.getZoomForResolution(t)),e}getZoomForResolution(e){let t=this.minZoom_||0,r,i;if(this.resolutions_){const s=pw(this.resolutions_,e,1);t=s,r=this.resolutions_[s],s==this.resolutions_.length-1?i=2:i=r/this.resolutions_[s+1]}else r=this.maxResolution_,i=this.zoomFactor_;return t+Math.log(r/e)/Math.log(i)}getResolutionForZoom(e){if(this.resolutions_?.length){if(this.resolutions_.length===1)return this.resolutions_[0];const t=ur(Math.floor(e),0,this.resolutions_.length-2),r=this.resolutions_[t]/this.resolutions_[t+1];return this.resolutions_[t]/Math.pow(r,ur(e-t,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,e-this.minZoom_)}fit(e,t){let r;if(bn(Array.isArray(e)||typeof e.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(e)){bn(!Ad(e),"Cannot fit empty extent provided as `geometry`");const i=Oa(e,this.getProjection());r=bM(i)}else if(e.getType()==="Circle"){const i=Oa(e.getExtent(),this.getProjection());r=bM(i),r.rotate(this.getRotation(),ul(i))}else r=e;this.fitInternal(r,t)}rotatedExtentForGeometry(e){const t=this.getRotation(),r=Math.cos(t),i=Math.sin(-t),s=e.getFlatCoordinates(),a=e.getStride();let o=1/0,l=1/0,c=-1/0,h=-1/0;for(let f=0,m=s.length;f<m;f+=a){const y=s[f]*r-s[f+1]*i,x=s[f]*i+s[f+1]*r;o=Math.min(o,y),l=Math.min(l,x),c=Math.max(c,y),h=Math.max(h,x)}return[o,l,c,h]}fitInternal(e,t){t=t||{};let r=t.size;r||(r=this.getViewportSizeMinusPadding_());const i=t.padding!==void 0?t.padding:[0,0,0,0],s=t.nearest!==void 0?t.nearest:!1;let a;t.minResolution!==void 0?a=t.minResolution:t.maxZoom!==void 0?a=this.getResolutionForZoom(t.maxZoom):a=0;const o=this.rotatedExtentForGeometry(e);let l=this.getResolutionForExtentInternal(o,[r[0]-i[1]-i[3],r[1]-i[0]-i[2]]);l=isNaN(l)?a:Math.max(l,a),l=this.getConstrainedResolution(l,s?0:1);const c=this.getRotation(),h=Math.sin(c),f=Math.cos(c),m=ul(o);m[0]+=(i[1]-i[3])/2*l,m[1]+=(i[0]-i[2])/2*l;const y=m[0]*f-m[1]*h,x=m[1]*f+m[0]*h,_=this.getConstrainedCenter([y,x],l),w=t.callback?t.callback:_p;t.duration!==void 0?this.animateInternal({resolution:l,center:_,duration:t.duration,easing:t.easing},w):(this.targetResolution_=l,this.targetCenter_=_,this.applyTargetState_(!1,!0),Tx(w,!0))}centerOn(e,t,r){this.centerOnInternal(Vl(e,this.getProjection()),t,r)}centerOnInternal(e,t,r){this.setCenterInternal(DT(e,t,r,this.getResolution(),this.getRotation()))}calculateCenterShift(e,t,r,i){let s;const a=this.padding_;if(a&&e){const o=this.getViewportSizeMinusPadding_(-r),l=DT(e,i,[o[0]/2+a[3],o[1]/2+a[0]],t,r);s=[e[0]-l[0],e[1]-l[1]]}return s}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(e){const t=cb(this.targetCenter_,this.getProjection());this.setCenter([t[0]+e[0],t[1]+e[1]])}adjustCenterInternal(e){const t=this.targetCenter_;this.setCenterInternal([t[0]+e[0],t[1]+e[1]])}adjustResolution(e,t){t=t&&Vl(t,this.getProjection()),this.adjustResolutionInternal(e,t)}adjustResolutionInternal(e,t){const r=this.getAnimating()||this.getInteracting(),i=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*e,0,i,r);t&&(this.targetCenter_=this.calculateCenterZoom(s,t)),this.targetResolution_*=e,this.applyTargetState_()}adjustZoom(e,t){this.adjustResolution(Math.pow(this.zoomFactor_,-e),t)}adjustRotation(e,t){t&&(t=Vl(t,this.getProjection())),this.adjustRotationInternal(e,t)}adjustRotationInternal(e,t){const r=this.getAnimating()||this.getInteracting(),i=this.constraints_.rotation(this.targetRotation_+e,r);t&&(this.targetCenter_=this.calculateCenterRotate(i,t)),this.targetRotation_+=e,this.applyTargetState_()}setCenter(e){this.setCenterInternal(e&&Vl(e,this.getProjection()))}setCenterInternal(e){this.targetCenter_=e,this.applyTargetState_()}setHint(e,t){return this.hints_[e]+=t,this.changed(),this.hints_[e]}setResolution(e){this.targetResolution_=e,this.applyTargetState_()}setRotation(e){this.targetRotation_=e,this.applyTargetState_()}setZoom(e){this.setResolution(this.getResolutionForZoom(e))}applyTargetState_(e,t){const r=this.getAnimating()||this.getInteracting()||t,i=this.constraints_.rotation(this.targetRotation_,r),s=this.getViewportSize_(i),a=this.constraints_.resolution(this.targetResolution_,0,s,r),o=this.constraints_.center(this.targetCenter_,a,s,r,this.calculateCenterShift(this.targetCenter_,a,i,s));this.get(io.ROTATION)!==i&&this.set(io.ROTATION,i),this.get(io.RESOLUTION)!==a&&(this.set(io.RESOLUTION,a),this.set("zoom",this.getZoom(),!0)),(!o||!this.get(io.CENTER)||!L_(this.get(io.CENTER),o))&&this.set(io.CENTER,o),this.getAnimating()&&!e&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(e,t,r){e=e!==void 0?e:200;const i=t||0,s=this.constraints_.rotation(this.targetRotation_),a=this.getViewportSize_(s),o=this.constraints_.resolution(this.targetResolution_,i,a),l=this.constraints_.center(this.targetCenter_,o,a,!1,this.calculateCenterShift(this.targetCenter_,o,s,a));if(e===0&&!this.cancelAnchor_){this.targetResolution_=o,this.targetRotation_=s,this.targetCenter_=l,this.applyTargetState_();return}r=r||(e===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==o||this.getRotation()!==s||!this.getCenterInternal()||!L_(this.getCenterInternal(),l))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:l,resolution:o,duration:e,easing:cg,anchor:r}))}beginInteraction(){this.resolveConstraints(0),this.setHint(Jr.INTERACTING,1)}endInteraction(e,t,r){r=r&&Vl(r,this.getProjection()),this.endInteractionInternal(e,t,r)}endInteractionInternal(e,t,r){this.getInteracting()&&(this.setHint(Jr.INTERACTING,-1),this.resolveConstraints(e,t,r))}getConstrainedCenter(e,t){const r=this.getViewportSize_(this.getRotation());return this.constraints_.center(e,t||this.getResolution(),r)}getConstrainedZoom(e,t){const r=this.getResolutionForZoom(e);return this.getZoomForResolution(this.getConstrainedResolution(r,t))}getConstrainedResolution(e,t){t=t||0;const r=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(e,t,r)}}function Tx(n,e){setTimeout(function(){n(e)},0)}function KH(n){if(n.extent!==void 0){const t=n.smoothExtentConstraint!==void 0?n.smoothExtentConstraint:!0;return WM(n.extent,n.constrainOnlyCenter,t)}const e=oA(n.projection,"EPSG:3857");if(n.multiWorld!==!0&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,WM(t,!1,!1)}return VH}function XH(n){let e,t,r,a=n.minZoom!==void 0?n.minZoom:OT,o=n.maxZoom!==void 0?n.maxZoom:28;const l=n.zoomFactor!==void 0?n.zoomFactor:2,c=n.multiWorld!==void 0?n.multiWorld:!1,h=n.smoothResolutionConstraint!==void 0?n.smoothResolutionConstraint:!0,f=n.showFullExtent!==void 0?n.showFullExtent:!1,m=oA(n.projection,"EPSG:3857"),y=m.getExtent();let x=n.constrainOnlyCenter,_=n.extent;if(!c&&!_&&m.isGlobal()&&(x=!1,_=y),n.resolutions!==void 0){const w=n.resolutions;t=w[a],r=w[o]!==void 0?w[o]:w[w.length-1],n.constrainResolution?e=zH(w,h,!x&&_,f):e=HM(t,r,h,!x&&_,f)}else{const S=(y?Math.max(gn(y),ei(y)):360*N0.degrees/m.getMetersPerUnit())/LA/Math.pow(2,OT),b=S/Math.pow(2,28-OT);t=n.maxResolution,t!==void 0?a=0:t=S/Math.pow(l,a),r=n.minResolution,r===void 0&&(n.maxZoom!==void 0?n.maxResolution!==void 0?r=t/Math.pow(l,o):r=S/Math.pow(l,o):r=b),o=a+Math.floor(Math.log(t/r)/Math.log(l)),r=t/Math.pow(l,o-a),n.constrainResolution?e=UH(l,t,r,h,!x&&_,f):e=HM(t,r,h,!x&&_,f)}return{constraint:e,maxResolution:t,minResolution:r,minZoom:a,zoomFactor:l}}function qH(n){if(n.enableRotation!==void 0?n.enableRotation:!0){const t=n.constrainRotation;return t===void 0||t===!0?WH():t===!1?KM:typeof t=="number"?$H(t):KM}return NA}function YH(n){return!(n.sourceCenter&&n.targetCenter&&!L_(n.sourceCenter,n.targetCenter)||n.sourceResolution!==n.targetResolution||n.sourceRotation!==n.targetRotation)}function DT(n,e,t,r,i){const s=Math.cos(-i);let a=Math.sin(-i),o=n[0]*s-n[1]*a,l=n[1]*s+n[0]*a;o+=(e[0]/2-t[0])*r,l+=(t[1]-e[1]/2)*r,a=-a;const c=o*s-l*a,h=l*s+o*a;return[c,h]}const On={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class LF extends yl{constructor(e){super(),this.on,this.once,this.un,this.background_=e.background;const t=Object.assign({},e);typeof e.properties=="object"&&(delete t.properties,Object.assign(t,e.properties)),t[On.OPACITY]=e.opacity!==void 0?e.opacity:1,bn(typeof t[On.OPACITY]=="number","Layer opacity must be a number"),t[On.VISIBLE]=e.visible!==void 0?e.visible:!0,t[On.Z_INDEX]=e.zIndex,t[On.MAX_RESOLUTION]=e.maxResolution!==void 0?e.maxResolution:1/0,t[On.MIN_RESOLUTION]=e.minResolution!==void 0?e.minResolution:0,t[On.MIN_ZOOM]=e.minZoom!==void 0?e.minZoom:-1/0,t[On.MAX_ZOOM]=e.maxZoom!==void 0?e.maxZoom:1/0,this.className_=t.className!==void 0?t.className:"ol-layer",delete t.className,this.setProperties(t),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(e){const t=this.state_||{layer:this,managed:e===void 0?!0:e},r=this.getZIndex();return t.opacity=ur(Math.round(this.getOpacity()*100)/100,0,1),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=r===void 0&&!t.managed?1/0:r,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),t.minZoom=this.getMinZoom(),t.maxZoom=this.getMaxZoom(),this.state_=t,t}getLayersArray(e){return Wt()}getLayerStatesArray(e){return Wt()}getExtent(){return this.get(On.EXTENT)}getMaxResolution(){return this.get(On.MAX_RESOLUTION)}getMinResolution(){return this.get(On.MIN_RESOLUTION)}getMinZoom(){return this.get(On.MIN_ZOOM)}getMaxZoom(){return this.get(On.MAX_ZOOM)}getOpacity(){return this.get(On.OPACITY)}getSourceState(){return Wt()}getVisible(){return this.get(On.VISIBLE)}getZIndex(){return this.get(On.Z_INDEX)}setBackground(e){this.background_=e,this.changed()}setExtent(e){this.set(On.EXTENT,e)}setMaxResolution(e){this.set(On.MAX_RESOLUTION,e)}setMinResolution(e){this.set(On.MIN_RESOLUTION,e)}setMaxZoom(e){this.set(On.MAX_ZOOM,e)}setMinZoom(e){this.set(On.MIN_ZOOM,e)}setOpacity(e){bn(typeof e=="number","Layer opacity must be a number"),this.set(On.OPACITY,e)}setVisible(e){this.set(On.VISIBLE,e)}setZIndex(e){this.set(On.Z_INDEX,e)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}class Ay extends LF{constructor(e){const t=Object.assign({},e);delete t.source,super(t),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,e.render&&(this.render=e.render),e.map&&this.setMap(e.map),this.addChangeListener(On.SOURCE,this.handleSourcePropertyChange_);const r=e.source?e.source:null;this.setSource(r)}getLayersArray(e){return e=e||[],e.push(this),e}getLayerStatesArray(e){return e=e||[],e.push(this.getLayerState()),e}getSource(){return this.get(On.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const e=this.getSource();return e?e.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(or(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const e=this.getSource();e&&(this.sourceChangeKey_=fn(e,Ht.CHANGE,this.handleSourceChange_,this),e.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(e){return this.renderer_?this.renderer_.getFeatures(e):Promise.resolve([])}getData(e){return!this.renderer_||!this.rendered?null:this.renderer_.getData(e)}isVisible(e){let t;const r=this.getMapInternal();!e&&r&&(e=r.getView()),e instanceof Zo?t={viewState:e.getState(),extent:e.calculateExtent()}:t=e,!t.layerStatesArray&&r&&(t.layerStatesArray=r.getLayerGroup().getLayerStatesArray());let i;if(t.layerStatesArray){if(i=t.layerStatesArray.find(a=>a.layer===this),!i)return!1}else i=this.getLayerState();const s=this.getExtent();return OA(i,t.viewState)&&(!s||Es(s,t.extent))}getAttributions(e){if(!this.isVisible(e))return[];const t=this.getSource()?.getAttributions();if(!t)return[];const r=e instanceof Zo?e.getViewStateAndExtent():e;let i=t(r);return Array.isArray(i)||(i=[i]),i}render(e,t){const r=this.getRenderer();return r.prepareFrame(e)?(this.rendered=!0,r.renderFrame(e,t)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(e,t){}renderDeferred(e){const t=this.getRenderer();t&&t.renderDeferred(e)}setMapInternal(e){e||this.unrender(),this.set(On.MAP,e)}getMapInternal(){return this.get(On.MAP)}setMap(e){this.mapPrecomposeKey_&&(or(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(or(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=fn(e,Si.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=fn(this,Ht.CHANGE,e.render,e),this.changed())}handlePrecompose_(e){const t=e.frameState.layerStatesArray,r=this.getLayerState(!1);bn(!t.some(i=>i.layer===r.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),t.push(r)}setSource(e){this.set(On.SOURCE,e)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}}function OA(n,e){if(!n.visible)return!1;const t=e.resolution;if(t<n.minResolution||t>=n.maxResolution)return!1;const r=e.zoom;return r>n.minZoom&&r<=n.maxZoom}const XM={RENDER_ORDER:"renderOrder"};class Lw extends Ay{constructor(e){e=e||{};const t=Object.assign({},e);delete t.style,delete t.renderBuffer,delete t.updateWhileAnimating,delete t.updateWhileInteracting,super(t),this.declutter_=e.declutter?String(e.declutter):void 0,this.renderBuffer_=e.renderBuffer!==void 0?e.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(e.style),this.updateWhileAnimating_=e.updateWhileAnimating!==void 0?e.updateWhileAnimating:!1,this.updateWhileInteracting_=e.updateWhileInteracting!==void 0?e.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(e){return super.getFeatures(e)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(XM.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(e,t){const r=this.getDeclutter();r in e.declutter||(e.declutter[r]=new wF(9)),this.getRenderer().renderDeclutter(e,t)}setRenderOrder(e){this.set(XM.RENDER_ORDER,e)}setStyle(e){this.style_=e===void 0?EF:e;const t=ZH(e);this.styleFunction_=e===null?void 0:OW(t),this.changed()}setDeclutter(e){this.declutter_=e?String(e):void 0,this.changed()}}function ZH(n){if(n===void 0)return EF;if(!n)return null;if(typeof n=="function"||n instanceof mn)return n;if(!Array.isArray(n))return BM([n]);if(n.length===0)return[];const e=n.length,t=n[0];if(t instanceof mn){const i=new Array(e);for(let s=0;s<e;++s){const a=n[s];if(!(a instanceof mn))throw new Error("Expected a list of style instances");i[s]=a}return i}if("style"in t){const i=new Array(e);for(let s=0;s<e;++s){const a=n[s];if(!("style"in a))throw new Error("Expected a list of rules with a style property");i[s]=a}return RH(i)}return BM(n)}class Wu extends Lw{constructor(e){super(e)}createRenderer(){return new tH(this)}}const Hc={ADDLAYER:"addlayer",REMOVELAYER:"removelayer"};class nu extends pl{constructor(e,t){super(e),this.layer=t}}const FT={LAYERS:"layers"};let Ow=class OF extends LF{constructor(e){e=e||{};const t=Object.assign({},e);delete t.layers;let r=e.layers;super(t),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(FT.LAYERS,this.handleLayersChanged_),r?Array.isArray(r)?r=new La(r.slice(),{unique:!0}):bn(typeof r.getArray=="function","Expected `layers` to be an array or a `Collection`"):r=new La(void 0,{unique:!0}),this.setLayers(r)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(or),this.layersListenerKeys_.length=0;const e=this.getLayers();this.layersListenerKeys_.push(fn(e,Os.ADD,this.handleLayersAdd_,this),fn(e,Os.REMOVE,this.handleLayersRemove_,this));for(const r in this.listenerKeys_)this.listenerKeys_[r].forEach(or);og(this.listenerKeys_);const t=e.getArray();for(let r=0,i=t.length;r<i;r++){const s=t[r];this.registerLayerListeners_(s),this.dispatchEvent(new nu(Hc.ADDLAYER,s))}this.changed()}registerLayerListeners_(e){const t=[fn(e,P0.PROPERTYCHANGE,this.handleLayerChange_,this),fn(e,Ht.CHANGE,this.handleLayerChange_,this)];e instanceof OF&&t.push(fn(e,Hc.ADDLAYER,this.handleLayerGroupAdd_,this),fn(e,Hc.REMOVELAYER,this.handleLayerGroupRemove_,this)),this.listenerKeys_[Bt(e)]=t}handleLayerGroupAdd_(e){this.dispatchEvent(new nu(Hc.ADDLAYER,e.layer))}handleLayerGroupRemove_(e){this.dispatchEvent(new nu(Hc.REMOVELAYER,e.layer))}handleLayersAdd_(e){const t=e.element;this.registerLayerListeners_(t),this.dispatchEvent(new nu(Hc.ADDLAYER,t)),this.changed()}handleLayersRemove_(e){const t=e.element,r=Bt(t);this.listenerKeys_[r].forEach(or),delete this.listenerKeys_[r],this.dispatchEvent(new nu(Hc.REMOVELAYER,t)),this.changed()}getLayers(){return this.get(FT.LAYERS)}setLayers(e){const t=this.getLayers();if(t){const r=t.getArray();for(let i=0,s=r.length;i<s;++i)this.dispatchEvent(new nu(Hc.REMOVELAYER,r[i]))}this.set(FT.LAYERS,e)}getLayersArray(e){return e=e!==void 0?e:[],this.getLayers().forEach(function(t){t.getLayersArray(e)}),e}getLayerStatesArray(e){const t=e!==void 0?e:[],r=t.length;this.getLayers().forEach(function(a){a.getLayerStatesArray(t)});const i=this.getLayerState();let s=i.zIndex;!e&&i.zIndex===void 0&&(s=0);for(let a=r,o=t.length;a<o;a++){const l=t[a];l.opacity*=i.opacity,l.visible=l.visible&&i.visible,l.maxResolution=Math.min(l.maxResolution,i.maxResolution),l.minResolution=Math.max(l.minResolution,i.minResolution),l.minZoom=Math.max(l.minZoom,i.minZoom),l.maxZoom=Math.min(l.maxZoom,i.maxZoom),i.extent!==void 0&&(l.extent!==void 0?l.extent=Va(l.extent,i.extent):l.extent=i.extent),l.zIndex===void 0&&(l.zIndex=s)}return t}getSourceState(){return"ready"}};const Lt={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function DA(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function K_(n,e){return n[0]=e[0],n[1]=e[1],n[4]=e[2],n[5]=e[3],n[12]=e[4],n[13]=e[5],n}const kp=34962,Dw=34963,FA=35044,jT=35048,JH=5121,QH=5123,eK=5125,DF=5126,qM=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function tK(n,e){e=Object.assign({preserveDrawingBuffer:!0,antialias:!V$},e);const t=qM.length;for(let r=0;r<t;++r)try{const i=n.getContext(qM[r],e);if(i)return i}catch{}return null}const nK={STATIC_DRAW:FA};class Bm{constructor(e,t){this.array_=null,this.type_=e,bn(e===kp||e===Dw,"A `WebGLArrayBuffer` must either be of type `ELEMENT_ARRAY_BUFFER` or `ARRAY_BUFFER`"),this.usage_=t!==void 0?t:nK.STATIC_DRAW}ofSize(e){return this.array_=new(Sx(this.type_))(e),this}fromArray(e){return this.array_=Sx(this.type_).from(e),this}fromArrayBuffer(e){return this.array_=new(Sx(this.type_))(e),this}getType(){return this.type_}getArray(){return this.array_}setArray(e){const t=Sx(this.type_);if(!(e instanceof t))throw new Error(`Expected ${t}`);this.array_=e}getUsage(){return this.usage_}getSize(){return this.array_?this.array_.length:0}}function Sx(n){switch(n){case kp:return Float32Array;case Dw:return Uint32Array;default:return Float32Array}}const bx={LOST:"webglcontextlost",RESTORED:"webglcontextrestored"},rK=`
  precision mediump float;

  attribute vec2 a_position;
  varying vec2 v_texCoord;
  varying vec2 v_screenCoord;

  uniform vec2 u_screenSize;

  void main() {
    v_texCoord = a_position * 0.5 + 0.5;
    v_screenCoord = v_texCoord * u_screenSize;
    gl_Position = vec4(a_position, 0.0, 1.0);
  }
`,iK=`
  precision mediump float;

  uniform sampler2D u_image;
  uniform float u_opacity;

  varying vec2 v_texCoord;

  void main() {
    gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;
  }
`;class YM{constructor(e){this.gl_=e.webGlContext;const t=this.gl_;this.scaleRatio_=e.scaleRatio||1,this.renderTargetTexture_=t.createTexture(),this.renderTargetTextureSize_=null,this.frameBuffer_=t.createFramebuffer(),this.depthBuffer_=t.createRenderbuffer();const r=t.createShader(t.VERTEX_SHADER);t.shaderSource(r,e.vertexShader||rK),t.compileShader(r);const i=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(i,e.fragmentShader||iK),t.compileShader(i),this.renderTargetProgram_=t.createProgram(),t.attachShader(this.renderTargetProgram_,r),t.attachShader(this.renderTargetProgram_,i),t.linkProgram(this.renderTargetProgram_),this.renderTargetVerticesBuffer_=t.createBuffer();const s=[-1,-1,1,-1,-1,1,1,-1,1,1,-1,1];t.bindBuffer(t.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),t.bufferData(t.ARRAY_BUFFER,new Float32Array(s),t.STATIC_DRAW),this.renderTargetAttribLocation_=t.getAttribLocation(this.renderTargetProgram_,"a_position"),this.renderTargetUniformLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_screenSize"),this.renderTargetOpacityLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_opacity"),this.renderTargetTextureLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_image"),this.uniforms_=[],e.uniforms&&Object.keys(e.uniforms).forEach(a=>{this.uniforms_.push({value:e.uniforms[a],location:t.getUniformLocation(this.renderTargetProgram_,a)})})}getRenderTargetTexture(){return this.renderTargetTexture_}getGL(){return this.gl_}init(e){const t=this.getGL(),r=[t.drawingBufferWidth*this.scaleRatio_,t.drawingBufferHeight*this.scaleRatio_];if(t.bindFramebuffer(t.FRAMEBUFFER,this.getFrameBuffer()),t.bindRenderbuffer(t.RENDERBUFFER,this.getDepthBuffer()),t.viewport(0,0,r[0],r[1]),!this.renderTargetTextureSize_||this.renderTargetTextureSize_[0]!==r[0]||this.renderTargetTextureSize_[1]!==r[1]){this.renderTargetTextureSize_=r;const i=0,s=t.RGBA,a=0,o=t.RGBA,l=t.UNSIGNED_BYTE,c=null;t.bindTexture(t.TEXTURE_2D,this.renderTargetTexture_),t.texImage2D(t.TEXTURE_2D,i,s,r[0],r[1],a,o,l,c),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.renderTargetTexture_,0),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,r[0],r[1]),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,this.depthBuffer_)}}apply(e,t,r,i){const s=this.getGL(),a=e.size;if(s.bindFramebuffer(s.FRAMEBUFFER,t?t.getFrameBuffer():null),s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,this.renderTargetTexture_),!t){const l=Bt(s.canvas);if(!e.renderTargets[l]){const c=s.getContextAttributes();c&&c.preserveDrawingBuffer&&(s.clearColor(0,0,0,0),s.clearDepth(1),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT)),e.renderTargets[l]=!0}}s.disable(s.DEPTH_TEST),s.enable(s.BLEND),s.blendFunc(s.ONE,s.ONE_MINUS_SRC_ALPHA),s.viewport(0,0,s.drawingBufferWidth,s.drawingBufferHeight),s.bindBuffer(s.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),s.useProgram(this.renderTargetProgram_),s.enableVertexAttribArray(this.renderTargetAttribLocation_),s.vertexAttribPointer(this.renderTargetAttribLocation_,2,s.FLOAT,!1,0,0),s.uniform2f(this.renderTargetUniformLocation_,a[0],a[1]),s.uniform1i(this.renderTargetTextureLocation_,0);const o=e.layerStatesArray[e.layerIndex].opacity;s.uniform1f(this.renderTargetOpacityLocation_,o),this.applyUniforms(e),r&&r(s,e),s.drawArrays(s.TRIANGLES,0,6),i&&i(s,e)}getFrameBuffer(){return this.frameBuffer_}getDepthBuffer(){return this.depthBuffer_}applyUniforms(e){const t=this.getGL();let r,i=1;this.uniforms_.forEach(function(s){if(r=typeof s.value=="function"?s.value(e):s.value,r instanceof HTMLCanvasElement||r instanceof ImageData)s.texture||(s.texture=t.createTexture()),t.activeTexture(t[`TEXTURE${i}`]),t.bindTexture(t.TEXTURE_2D,s.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),r instanceof ImageData?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,r.width,r.height,0,t.UNSIGNED_BYTE,new Uint8Array(r.data)):t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r),t.uniform1i(s.location,i++);else if(Array.isArray(r))switch(r.length){case 2:t.uniform2f(s.location,r[0],r[1]);return;case 3:t.uniform3f(s.location,r[0],r[1],r[2]);return;case 4:t.uniform4f(s.location,r[0],r[1],r[2],r[3]);return;default:return}else typeof r=="number"&&t.uniform1f(s.location,r)})}}const Gl={PROJECTION_MATRIX:"u_projectionMatrix",SCREEN_TO_WORLD_MATRIX:"u_screenToWorldMatrix",TIME:"u_time",ZOOM:"u_zoom",RESOLUTION:"u_resolution",ROTATION:"u_rotation",VIEWPORT_SIZE_PX:"u_viewportSizePx",PIXEL_RATIO:"u_pixelRatio",HIT_DETECTION:"u_hitDetection"},wi={UNSIGNED_BYTE:JH,UNSIGNED_SHORT:QH,UNSIGNED_INT:eK,FLOAT:DF},X_={};function ZM(n){return"shared/"+n}let JM=0;function sK(){const n="unique/"+JM;return JM+=1,n}function aK(n){let e=X_[n];if(!e){const t=document.createElement("canvas");t.width=1,t.height=1,t.style.position="absolute",t.style.left="0",e={users:0,context:tK(t)},X_[n]=e}return e.users+=1,e.context}function oK(n){const e=X_[n];if(!e||(e.users-=1,e.users>0))return;const t=e.context,r=t.getExtension("WEBGL_lose_context");r&&r.loseContext();const i=t.canvas;i.width=1,i.height=1,delete X_[n]}class lK extends py{constructor(e){super(),e=e||{},this.boundHandleWebGLContextLost_=this.handleWebGLContextLost.bind(this),this.boundHandleWebGLContextRestored_=this.handleWebGLContextRestored.bind(this),this.canvasCacheKey_=e.canvasCacheKey?ZM(e.canvasCacheKey):sK(),this.gl_=aK(this.canvasCacheKey_),this.bufferCache_={},this.extensionCache_={},this.currentProgram_=null,this.needsToBeRecreated_=!1;const t=this.gl_.canvas;t.addEventListener(bx.LOST,this.boundHandleWebGLContextLost_),t.addEventListener(bx.RESTORED,this.boundHandleWebGLContextRestored_),this.offsetRotateMatrix_=ti(),this.offsetScaleMatrix_=ti(),this.tmpMat4_=DA(),this.uniformLocationsByProgram_={},this.attribLocationsByProgram_={},this.uniforms_=[],e.uniforms&&this.setUniforms(e.uniforms),this.postProcessPasses_=e.postProcesses?e.postProcesses.map(r=>new YM({webGlContext:this.gl_,scaleRatio:r.scaleRatio,vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,uniforms:r.uniforms})):[new YM({webGlContext:this.gl_})],this.shaderCompileErrors_=null,this.startTime_=Date.now(),this.maxAttributeCount_=this.gl_.getParameter(this.gl_.MAX_VERTEX_ATTRIBS)}setUniforms(e){this.uniforms_=[],this.addUniforms(e)}addUniforms(e){for(const t in e)this.uniforms_.push({name:t,value:e[t]})}canvasCacheKeyMatches(e){return this.canvasCacheKey_===ZM(e)}getExtension(e){if(e in this.extensionCache_)return this.extensionCache_[e];const t=this.gl_.getExtension(e);return this.extensionCache_[e]=t,t}getInstancedRenderingExtension_(){const e=this.getExtension("ANGLE_instanced_arrays");return bn(!!e,"WebGL extension 'ANGLE_instanced_arrays' is required for vector rendering"),e}bindBuffer(e){const t=this.gl_,r=Bt(e);let i=this.bufferCache_[r];if(!i){const s=t.createBuffer();i={buffer:e,webGlBuffer:s},this.bufferCache_[r]=i}t.bindBuffer(e.getType(),i.webGlBuffer)}flushBufferData(e){const t=this.gl_;this.bindBuffer(e),t.bufferData(e.getType(),e.getArray(),e.getUsage())}deleteBuffer(e){const t=Bt(e);delete this.bufferCache_[t]}disposeInternal(){const e=this.gl_.canvas;e.removeEventListener(bx.LOST,this.boundHandleWebGLContextLost_),e.removeEventListener(bx.RESTORED,this.boundHandleWebGLContextRestored_),oK(this.canvasCacheKey_),delete this.gl_}prepareDraw(e,t,r){const i=this.gl_,s=this.getCanvas(),a=e.size,o=e.pixelRatio;(s.width!==a[0]*o||s.height!==a[1]*o)&&(s.width=a[0]*o,s.height=a[1]*o,s.style.width=a[0]+"px",s.style.height=a[1]+"px");for(let l=this.postProcessPasses_.length-1;l>=0;l--)this.postProcessPasses_[l].init(e);i.bindTexture(i.TEXTURE_2D,null),i.clearColor(0,0,0,0),i.depthRange(0,1),i.clearDepth(1),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT),i.enable(i.BLEND),i.blendFunc(i.ONE,t?i.ZERO:i.ONE_MINUS_SRC_ALPHA),r?(i.enable(i.DEPTH_TEST),i.depthFunc(i.LEQUAL)):i.disable(i.DEPTH_TEST)}bindFrameBuffer(e,t){const r=this.getGL();r.bindFramebuffer(r.FRAMEBUFFER,e),t&&r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,t,0)}bindInitialFrameBuffer(){const e=this.getGL(),t=this.postProcessPasses_[0].getFrameBuffer();e.bindFramebuffer(e.FRAMEBUFFER,t);const r=this.postProcessPasses_[0].getRenderTargetTexture();e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0)}bindTexture(e,t,r){const i=this.gl_;i.activeTexture(i.TEXTURE0+t),i.bindTexture(i.TEXTURE_2D,e),i.uniform1i(this.getUniformLocation(r),t)}bindAttribute(e,t,r){const i=this.getGL();this.bindBuffer(e);const s=this.getAttributeLocation(t);i.enableVertexAttribArray(s),i.vertexAttribPointer(s,r,i.FLOAT,!1,0,0)}prepareDrawToRenderTarget(e,t,r,i){const s=this.gl_,a=t.getSize();s.bindFramebuffer(s.FRAMEBUFFER,t.getFramebuffer()),s.bindRenderbuffer(s.RENDERBUFFER,t.getDepthbuffer()),s.viewport(0,0,a[0],a[1]),s.bindTexture(s.TEXTURE_2D,t.getTexture()),s.clearColor(0,0,0,0),s.depthRange(0,1),s.clearDepth(1),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.enable(s.BLEND),s.blendFunc(s.ONE,r?s.ZERO:s.ONE_MINUS_SRC_ALPHA),i?(s.enable(s.DEPTH_TEST),s.depthFunc(s.LEQUAL)):s.disable(s.DEPTH_TEST)}drawElements(e,t){const r=this.gl_;this.getExtension("OES_element_index_uint");const i=r.UNSIGNED_INT,s=4,a=t-e,o=e*s;r.drawElements(r.TRIANGLES,a,i,o)}drawElementsInstanced(e,t,r){const i=this.gl_;this.getExtension("OES_element_index_uint");const s=this.getInstancedRenderingExtension_(),a=i.UNSIGNED_INT,o=4,l=t-e,c=e*o;s.drawElementsInstancedANGLE(i.TRIANGLES,l,a,c,r);for(let h=0;h<this.maxAttributeCount_;h++)s.vertexAttribDivisorANGLE(h,0)}finalizeDraw(e,t,r){for(let i=0,s=this.postProcessPasses_.length;i<s;i++)i===s-1?this.postProcessPasses_[i].apply(e,null,t,r):this.postProcessPasses_[i].apply(e,this.postProcessPasses_[i+1])}getCanvas(){return this.gl_.canvas}getGL(){return this.gl_}applyFrameState(e){const t=e.size,r=e.viewState.rotation,i=e.pixelRatio;this.setUniformFloatValue(Gl.TIME,(Date.now()-this.startTime_)*.001),this.setUniformFloatValue(Gl.ZOOM,e.viewState.zoom),this.setUniformFloatValue(Gl.RESOLUTION,e.viewState.resolution),this.setUniformFloatValue(Gl.PIXEL_RATIO,i),this.setUniformFloatVec2(Gl.VIEWPORT_SIZE_PX,[t[0],t[1]]),this.setUniformFloatValue(Gl.ROTATION,r)}applyHitDetectionUniform(e){const t=this.getUniformLocation(Gl.HIT_DETECTION);this.getGL().uniform1i(t,e?1:0),e&&this.setUniformFloatValue(Gl.PIXEL_RATIO,.5)}applyUniforms(e){const t=this.gl_;let r,i=0;this.uniforms_.forEach(s=>{if(r=typeof s.value=="function"?s.value(e):s.value,r instanceof HTMLCanvasElement||r instanceof HTMLImageElement||r instanceof ImageData||r instanceof WebGLTexture){r instanceof WebGLTexture&&!s.texture?(s.prevValue=void 0,s.texture=r):s.texture||(s.prevValue=void 0,s.texture=t.createTexture()),this.bindTexture(s.texture,i,s.name),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE);const a=!(r instanceof HTMLImageElement)||r.complete;!(r instanceof WebGLTexture)&&a&&s.prevValue!==r&&(s.prevValue=r,t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r)),i++}else if(Array.isArray(r)&&r.length===6)this.setUniformMatrixValue(s.name,K_(this.tmpMat4_,r));else if(Array.isArray(r)&&r.length<=4)switch(r.length){case 2:t.uniform2f(this.getUniformLocation(s.name),r[0],r[1]);return;case 3:t.uniform3f(this.getUniformLocation(s.name),r[0],r[1],r[2]);return;case 4:t.uniform4f(this.getUniformLocation(s.name),r[0],r[1],r[2],r[3]);return;default:return}else typeof r=="number"&&t.uniform1f(this.getUniformLocation(s.name),r)})}useProgram(e,t){this.disableAllAttributes_(),this.gl_.useProgram(e),this.currentProgram_=e,t&&(this.applyFrameState(t),this.applyUniforms(t))}compileShader(e,t){const r=this.gl_,i=r.createShader(t);return r.shaderSource(i,e),r.compileShader(i),i}getProgram(e,t){const r=this.gl_,i=this.compileShader(e,r.FRAGMENT_SHADER),s=this.compileShader(t,r.VERTEX_SHADER),a=r.createProgram();if(r.attachShader(a,i),r.attachShader(a,s),r.linkProgram(a),!r.getShaderParameter(i,r.COMPILE_STATUS)){const o=`Fragment shader compilation failed: ${r.getShaderInfoLog(i)}`;throw new Error(o)}if(r.deleteShader(i),!r.getShaderParameter(s,r.COMPILE_STATUS)){const o=`Vertex shader compilation failed: ${r.getShaderInfoLog(s)}`;throw new Error(o)}if(r.deleteShader(s),!r.getProgramParameter(a,r.LINK_STATUS)){const o=`GL program linking failed: ${r.getProgramInfoLog(a)}`;throw new Error(o)}return a}getUniformLocation(e){const t=Bt(this.currentProgram_);return this.uniformLocationsByProgram_[t]===void 0&&(this.uniformLocationsByProgram_[t]={}),this.uniformLocationsByProgram_[t][e]===void 0&&(this.uniformLocationsByProgram_[t][e]=this.gl_.getUniformLocation(this.currentProgram_,e)),this.uniformLocationsByProgram_[t][e]}getAttributeLocation(e){const t=Bt(this.currentProgram_);return this.attribLocationsByProgram_[t]===void 0&&(this.attribLocationsByProgram_[t]={}),this.attribLocationsByProgram_[t][e]===void 0&&(this.attribLocationsByProgram_[t][e]=this.gl_.getAttribLocation(this.currentProgram_,e)),this.attribLocationsByProgram_[t][e]}makeProjectionTransform(e,t){const r=e.size,i=e.viewState.rotation,s=e.viewState.resolution,a=e.viewState.center;return $a(t,0,0,2/(s*r[0]),2/(s*r[1]),-i,-a[0],-a[1]),t}setUniformFloatValue(e,t){this.gl_.uniform1f(this.getUniformLocation(e),t)}setUniformFloatVec2(e,t){this.gl_.uniform2fv(this.getUniformLocation(e),t)}setUniformFloatVec4(e,t){this.gl_.uniform4fv(this.getUniformLocation(e),t)}setUniformMatrixValue(e,t){this.gl_.uniformMatrix4fv(this.getUniformLocation(e),!1,t)}disableAllAttributes_(){for(let e=0;e<this.maxAttributeCount_;e++)this.gl_.disableVertexAttribArray(e)}enableAttributeArray_(e,t,r,i,s,a){const o=this.getAttributeLocation(e);o<0||(this.gl_.enableVertexAttribArray(o),this.gl_.vertexAttribPointer(o,t,r,!1,i,s),a&&this.getInstancedRenderingExtension_().vertexAttribDivisorANGLE(o,1))}enableAttributes_(e,t){const r=cK(e);let i=0;for(let s=0;s<e.length;s++){const a=e[s];a.name&&this.enableAttributeArray_(a.name,a.size,a.type||DF,r,i,t),i+=a.size*FF(a.type)}}enableAttributes(e){this.enableAttributes_(e,!1)}enableAttributesInstanced(e){this.enableAttributes_(e,!0)}handleWebGLContextLost(e){og(this.bufferCache_),this.currentProgram_=null,e.preventDefault()}handleWebGLContextRestored(){this.needsToBeRecreated_=!0}needsToBeRecreated(){return this.needsToBeRecreated_}createTexture(e,t,r,i){const s=this.gl_;r=r||s.createTexture();const a=i?s.NEAREST:s.LINEAR;s.bindTexture(s.TEXTURE_2D,r),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,a),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,a),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE);const o=0,l=s.RGBA,c=0,h=s.RGBA,f=s.UNSIGNED_BYTE;return t instanceof Uint8Array?s.texImage2D(s.TEXTURE_2D,o,l,e[0],e[1],c,h,f,t):t?s.texImage2D(s.TEXTURE_2D,o,l,h,f,t):s.texImage2D(s.TEXTURE_2D,o,l,e[0],e[1],c,h,f,null),r}}function cK(n){let e=0;for(let t=0;t<n.length;t++){const r=n[t];e+=r.size*FF(r.type)}return e}function FF(n){switch(n){case wi.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case wi.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case wi.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case wi.FLOAT:default:return Float32Array.BYTES_PER_ELEMENT}}class jA extends lg{constructor(e,t,r){super(),r=r||{},this.tileCoord=e,this.state=t,this.key="",this.transition_=r.transition===void 0?250:r.transition,this.transitionStarts_={},this.interpolate=!!r.interpolate}changed(){this.dispatchEvent(Ht.CHANGE)}release(){this.setState(Lt.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(e){if(this.state!==Lt.EMPTY){if(this.state!==Lt.ERROR&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()}}load(){Wt()}getAlpha(e,t){if(!this.transition_)return 1;let r=this.transitionStarts_[e];if(!r)r=t,this.transitionStarts_[e]=r;else if(r===-1)return 1;const i=t-r+1e3/60;return i>=this.transition_?1:NF(i/this.transition_)}inTransition(e){return this.transition_?this.transitionStarts_[e]!==-1:!1}endTransition(e){this.transition_&&(this.transitionStarts_[e]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}function Pp(n){return n instanceof Image||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageBitmap?n:null}function QM(n){return n instanceof Uint8Array||n instanceof Uint8ClampedArray||n instanceof Float32Array||n instanceof DataView?n:null}const uK=new Error("disposed"),hK=[256,256];class _b extends jA{constructor(e){const t=Lt.IDLE;super(e.tileCoord,t,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null,this.controller_=e.controller||null}getSize(){if(this.size_)return this.size_;const e=Pp(this.data_);return e?[e.width,e.height]:hK}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==Lt.IDLE&&this.state!==Lt.ERROR)return;this.state=Lt.LOADING,this.changed();const e=this;this.loader_().then(function(t){e.data_=t,e.state=Lt.LOADED,e.changed()}).catch(function(t){e.error_=t,e.state=Lt.ERROR,e.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(uK),this.controller_=null),super.disposeInternal()}}class Fw extends jA{constructor(e,t,r,i,s,a){super(e,t,a),this.crossOrigin_=i,this.src_=r,this.key=r,this.image_,ha?this.image_=new OffscreenCanvas(1,1):(this.image_=new Image,i!==null&&(this.image_.crossOrigin=i)),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(e){this.image_=e,this.state=Lt.LOADED,this.unlistenImage_(),this.changed()}getCrossOrigin(){return this.crossOrigin_}handleImageError_(){this.state=Lt.ERROR,this.unlistenImage_(),this.image_=dK(),this.changed()}handleImageLoad_(){if(ha)this.state=Lt.LOADED;else{const e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=Lt.LOADED:this.state=Lt.EMPTY}this.unlistenImage_(),this.changed()}load(){this.state==Lt.ERROR&&(this.state=Lt.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==Lt.IDLE&&(this.state=Lt.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=Q$(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function dK(){const n=Kr(1,1);return n.fillStyle="rgba(0,0,0,0)",n.fillRect(0,0,1,1),n.canvas}let VT;const p0=[];function eN(n,e,t,r,i){n.beginPath(),n.moveTo(0,0),n.lineTo(e,t),n.lineTo(r,i),n.closePath(),n.save(),n.clip(),n.fillRect(0,0,Math.max(e,r)+1,Math.max(t,i)),n.restore()}function GT(n,e){return Math.abs(n[e*4]-210)>2||Math.abs(n[e*4+3]-.75*255)>2}function fK(){if(VT===void 0){const n=Kr(6,6,p0);n.globalCompositeOperation="lighter",n.fillStyle="rgba(210, 0, 0, 0.75)",eN(n,4,5,4,0),eN(n,4,5,0,5);const e=n.getImageData(0,0,3,3).data;VT=GT(e,0)||GT(e,4)||GT(e,8),Cw(n),p0.push(n.canvas)}return VT}function q_(n,e,t,r){const i=wy(t,e,n);let s=j_(e,r,t);const a=e.getMetersPerUnit();a!==void 0&&(s*=a);const o=n.getMetersPerUnit();o!==void 0&&(s/=o);const l=n.getExtent();if(!l||rc(l,i)){const c=j_(n,s,i)/s;isFinite(c)&&c>0&&(s/=c)}return s}function gK(n,e,t,r){const i=ul(t);let s=q_(n,e,i,r);return(!isFinite(s)||s<=0)&&ID(t,function(a){return s=q_(n,e,a,r),isFinite(s)&&s>0}),s}function jF(n,e,t,r,i,s,a,o,l,c,h,f,m,y){const x=Kr(Math.round(t*n),Math.round(t*e),p0);if(f||(x.imageSmoothingEnabled=!1),l.length===0)return x.canvas;x.scale(t,t);function _(O){return Math.round(O*t)/t}x.globalCompositeOperation="lighter";const w=Us();l.forEach(function(O,G,A){RD(w,O.extent)});let S;const b=t/r,R=(f?1:1+Math.pow(2,-24))/b;(!m||l.length!==1||c!==0)&&(S=Kr(Math.round(gn(w)*b),Math.round(ei(w)*b),p0),f||(S.imageSmoothingEnabled=!1),l.forEach(function(O,G,A){if(O.image.width>0&&O.image.height>0){if(O.clipExtent){S.save();const U=(O.clipExtent[0]-w[0])*b,j=-(O.clipExtent[3]-w[3])*b,Ee=gn(O.clipExtent)*b,ke=ei(O.clipExtent)*b;S.rect(f?U:Math.round(U),f?j:Math.round(j),f?Ee:Math.round(U+Ee)-Math.round(U),f?ke:Math.round(j+ke)-Math.round(j)),S.clip()}const I=(O.extent[0]-w[0])*b,P=-(O.extent[3]-w[3])*b,D=gn(O.extent)*b,L=ei(O.extent)*b;S.drawImage(O.image,c,c,O.image.width-2*c,O.image.height-2*c,f?I:Math.round(I),f?P:Math.round(P),f?D:Math.round(I+D)-Math.round(I),f?L:Math.round(P+L)-Math.round(P)),O.clipExtent&&S.restore()}}));const M=Rd(a);return o.getTriangles().forEach(function(O,G,A){const I=O.source,P=O.target;let D=I[0][0],L=I[0][1],U=I[1][0],j=I[1][1],Ee=I[2][0],ke=I[2][1];const Be=_((P[0][0]-M[0])/s),Me=_(-(P[0][1]-M[1])/s),ce=_((P[1][0]-M[0])/s),Pe=_(-(P[1][1]-M[1])/s),be=_((P[2][0]-M[0])/s),se=_(-(P[2][1]-M[1])/s),V=D,Z=L;D=0,L=0,U-=V,j-=Z,Ee-=V,ke-=Z;const te=[[U,j,0,0,ce-Be],[Ee,ke,0,0,be-Be],[0,0,U,j,Pe-Me],[0,0,Ee,ke,se-Me]],ie=BU(te);if(!ie)return;if(x.save(),x.beginPath(),fK()||!f){x.moveTo(ce,Pe);const Ve=4,Ge=Be-ce,ye=Me-Pe;for(let pe=0;pe<Ve;pe++)x.lineTo(ce+_((pe+1)*Ge/Ve),Pe+_(pe*ye/(Ve-1))),pe!=Ve-1&&x.lineTo(ce+_((pe+1)*Ge/Ve),Pe+_((pe+1)*ye/(Ve-1)));x.lineTo(be,se)}else x.moveTo(ce,Pe),x.lineTo(Be,Me),x.lineTo(be,se);x.clip(),x.transform(ie[0],ie[2],ie[1],ie[3],Be,Me),x.translate(w[0]-V,w[3]-Z);let ue;if(S)ue=S.canvas,x.scale(R,-R);else{const Ve=l[0],Ge=Ve.extent;ue=Ve.image,x.scale(gn(Ge)/ue.width,-ei(Ge)/ue.height)}x.drawImage(ue,0,0),x.restore()}),S&&(Cw(S),p0.push(S.canvas)),h&&(x.save(),x.globalCompositeOperation="source-over",x.strokeStyle="black",x.lineWidth=1,o.getTriangles().forEach(function(O,G,A){const I=O.target,P=(I[0][0]-M[0])/s,D=-(I[0][1]-M[1])/s,L=(I[1][0]-M[0])/s,U=-(I[1][1]-M[1])/s,j=(I[2][0]-M[0])/s,Ee=-(I[2][1]-M[1])/s;x.beginPath(),x.moveTo(L,U),x.lineTo(P,D),x.lineTo(j,Ee),x.closePath(),x.stroke()}),x.restore()),x.canvas}const mK=10,tN=.25;class VF{constructor(e,t,r,i,s,a,o){this.sourceProj_=e,this.targetProj_=t;let l={};const c=o?lb(R=>kr(o,wy(R,this.targetProj_,this.sourceProj_))):vp(this.targetProj_,this.sourceProj_);this.transformInv_=function(R){const M=R[0]+"/"+R[1];return l[M]||(l[M]=c(R)),l[M]},this.maxSourceExtent_=i,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!i&&!!this.sourceProj_.getExtent()&&gn(i)>=gn(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?gn(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?gn(this.targetProj_.getExtent()):null;const h=Rd(r),f=vw(r),m=_w(r),y=xw(r),x=this.transformInv_(h),_=this.transformInv_(f),w=this.transformInv_(m),S=this.transformInv_(y),b=mK+(a?Math.max(0,Math.ceil(Math.log2(rb(r)/(a*a*256*256)))):0);if(this.addQuad_(h,f,m,y,x,_,w,S,b),this.wrapsXInSource_){let R=1/0;this.triangles_.forEach(function(M,O,G){R=Math.min(R,M.source[0][0],M.source[1][0],M.source[2][0])}),this.triangles_.forEach(M=>{if(Math.max(M.source[0][0],M.source[1][0],M.source[2][0])-R>this.sourceWorldWidth_/2){const O=[[M.source[0][0],M.source[0][1]],[M.source[1][0],M.source[1][1]],[M.source[2][0],M.source[2][1]]];O[0][0]-R>this.sourceWorldWidth_/2&&(O[0][0]-=this.sourceWorldWidth_),O[1][0]-R>this.sourceWorldWidth_/2&&(O[1][0]-=this.sourceWorldWidth_),O[2][0]-R>this.sourceWorldWidth_/2&&(O[2][0]-=this.sourceWorldWidth_);const G=Math.min(O[0][0],O[1][0],O[2][0]);Math.max(O[0][0],O[1][0],O[2][0])-G<this.sourceWorldWidth_/2&&(M.source=O)}})}l={}}addTriangle_(e,t,r,i,s,a){this.triangles_.push({source:[i,s,a],target:[e,t,r]})}addQuad_(e,t,r,i,s,a,o,l,c){const h=tb([s,a,o,l]),f=this.sourceWorldWidth_?gn(h)/this.sourceWorldWidth_:null,m=this.sourceWorldWidth_,y=this.sourceProj_.canWrapX()&&f>.5&&f<1;let x=!1;if(c>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const w=tb([e,t,r,i]);x=gn(w)/this.targetWorldWidth_>tN||x}!y&&this.sourceProj_.isGlobal()&&f&&(x=f>tN||x)}if(!x&&this.maxSourceExtent_&&isFinite(h[0])&&isFinite(h[1])&&isFinite(h[2])&&isFinite(h[3])&&!Es(h,this.maxSourceExtent_))return;let _=0;if(!x&&(!isFinite(s[0])||!isFinite(s[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(l[0])||!isFinite(l[1]))){if(c>0)x=!0;else if(_=(!isFinite(s[0])||!isFinite(s[1])?8:0)+(!isFinite(a[0])||!isFinite(a[1])?4:0)+(!isFinite(o[0])||!isFinite(o[1])?2:0)+(!isFinite(l[0])||!isFinite(l[1])?1:0),_!=1&&_!=2&&_!=4&&_!=8)return}if(c>0){if(!x){const w=[(e[0]+r[0])/2,(e[1]+r[1])/2],S=this.transformInv_(w);let b;y?b=(vu(s[0],m)+vu(o[0],m))/2-vu(S[0],m):b=(s[0]+o[0])/2-S[0];const R=(s[1]+o[1])/2-S[1];x=b*b+R*R>this.errorThresholdSquared_}if(x){if(Math.abs(e[0]-r[0])<=Math.abs(e[1]-r[1])){const w=[(t[0]+r[0])/2,(t[1]+r[1])/2],S=this.transformInv_(w),b=[(i[0]+e[0])/2,(i[1]+e[1])/2],R=this.transformInv_(b);this.addQuad_(e,t,w,b,s,a,S,R,c-1),this.addQuad_(b,w,r,i,R,S,o,l,c-1)}else{const w=[(e[0]+t[0])/2,(e[1]+t[1])/2],S=this.transformInv_(w),b=[(r[0]+i[0])/2,(r[1]+i[1])/2],R=this.transformInv_(b);this.addQuad_(e,w,b,i,s,S,R,l,c-1),this.addQuad_(w,t,r,b,S,a,o,R,c-1)}return}}if(y){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(_&11)==0&&this.addTriangle_(e,r,i,s,o,l),(_&14)==0&&this.addTriangle_(e,r,t,s,o,a),_&&((_&13)==0&&this.addTriangle_(t,i,e,a,l,s),(_&7)==0&&this.addTriangle_(t,i,r,a,l,o))}calculateSourceExtent(){const e=Us();return this.triangles_.forEach(function(t,r,i){const s=t.source;jm(e,s[0]),jm(e,s[1]),jm(e,s[2])}),e}getTriangles(){return this.triangles_}}const GF=.5;class VA extends jA{constructor(e,t,r,i,s,a,o,l,c,h,f,m){super(s,Lt.IDLE,m),this.renderEdges_=f!==void 0?f:!1,this.pixelRatio_=o,this.gutter_=l,this.canvas_=null,this.sourceTileGrid_=t,this.targetTileGrid_=i,this.wrappedTileCoord_=a||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=e.canWrapX()?e.getExtent():void 0;const y=i.getTileCoordExtent(this.wrappedTileCoord_),x=this.targetTileGrid_.getExtent();let _=this.sourceTileGrid_.getExtent();const w=x?Va(y,x):y;if(rb(w)===0){this.state=Lt.EMPTY;return}const S=e.getExtent();S&&(_?_=Va(_,S):_=S);const b=i.getResolution(this.wrappedTileCoord_[0]),R=gK(e,r,w,b);if(!isFinite(R)||R<=0){this.state=Lt.EMPTY;return}const M=h!==void 0?h:GF;if(this.triangulation_=new VF(e,r,w,_,R*M,b),this.triangulation_.getTriangles().length===0){this.state=Lt.EMPTY;return}this.sourceZ_=t.getZForResolution(R);let O=this.triangulation_.calculateSourceExtent();if(_&&(e.canWrapX()?(O[1]=ur(O[1],_[1],_[3]),O[3]=ur(O[3],_[1],_[3])):O=Va(O,_)),!rb(O))this.state=Lt.EMPTY;else{let G=0,A=0;e.canWrapX()&&(G=gn(S),A=Math.floor((O[0]-S[0])/G)),kD(O.slice(),e,!0).forEach(P=>{const D=t.getTileRangeForExtentAndZ(P,this.sourceZ_);for(let L=D.minX;L<=D.maxX;L++)for(let U=D.minY;U<=D.maxY;U++){const j=c(this.sourceZ_,L,U,o);if(j){const Ee=A*G;this.sourceTiles_.push({tile:j,offset:Ee})}}++A}),this.sourceTiles_.length===0&&(this.state=Lt.EMPTY)}}getImage(){return this.canvas_}reproject_(){const e=[];if(this.sourceTiles_.forEach(t=>{const r=t.tile;if(r&&r.getState()==Lt.LOADED){const i=this.sourceTileGrid_.getTileCoordExtent(r.tileCoord);i[0]+=t.offset,i[2]+=t.offset;const s=this.clipExtent_?.slice();s&&(s[0]+=t.offset,s[2]+=t.offset),e.push({extent:i,clipExtent:s,image:r.getImage()})}}),this.sourceTiles_.length=0,e.length===0)this.state=Lt.ERROR;else{const t=this.wrappedTileCoord_[0],r=this.targetTileGrid_.getTileSize(t),i=typeof r=="number"?r:r[0],s=typeof r=="number"?r:r[1],a=this.targetTileGrid_.getResolution(t),o=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=jF(i,s,this.pixelRatio_,o,this.sourceTileGrid_.getExtent(),a,l,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=Lt.LOADED}this.changed()}load(){if(this.state==Lt.IDLE){this.state=Lt.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:t})=>{const r=t.getState();if(r==Lt.IDLE||r==Lt.LOADING){e++;const i=fn(t,Ht.CHANGE,s=>{const a=t.getState();(a==Lt.LOADED||a==Lt.ERROR||a==Lt.EMPTY)&&(or(i),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(i)}}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:t},r,i){t.getState()==Lt.IDLE&&t.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(or),this.sourcesListenerKeys_=null}release(){this.canvas_&&(Cw(this.canvas_.getContext("2d")),p0.push(this.canvas_),this.canvas_=null),super.release()}}class pK extends lg{constructor(e){super(),this.tile,this.handleTileChange_=this.handleTileChange_.bind(this),this.gutter=e.gutter||0,this.helper=e.helper,this.loaded=!1,this.ready=!1}setTile(e){if(e!==this.tile)if(this.tile&&this.tile.removeEventListener(Ht.CHANGE,this.handleTileChange_),this.tile=e,this.loaded=e.getState()===Lt.LOADED,this.loaded)this.uploadTile();else{if(e instanceof Fw){const t=e.getImage();t instanceof Image&&!t.crossOrigin&&(t.crossOrigin="anonymous")}e.addEventListener(Ht.CHANGE,this.handleTileChange_)}}uploadTile(){Wt()}setReady(){this.ready=!0,this.dispatchEvent(Ht.CHANGE)}handleTileChange_(){this.tile.getState()===Lt.LOADED&&(this.loaded=!0,this.uploadTile())}setHelper(e){this.helper=e,this.helper&&this.loaded&&this.uploadTile()}disposeInternal(){this.setHelper(null),this.tile.removeEventListener(Ht.CHANGE,this.handleTileChange_)}}function BF(n,e,t){const r=t?n.LINEAR:n.NEAREST;n.bindTexture(n.TEXTURE_2D,e),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,r),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,r)}function yK(n,e,t,r){BF(n,e,r),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t)}function nN(n,e,t,r,i,s){const a=n.getGL();let o,l;t instanceof Float32Array?(o=a.FLOAT,n.getExtension("OES_texture_float"),l=n.getExtension("OES_texture_float_linear")!==null):(o=a.UNSIGNED_BYTE,l=!0),BF(a,e,s&&l);const c=t.byteLength/r[1];let h=1;c%8===0?h=8:c%4===0?h=4:c%2===0&&(h=2);let f;switch(i){case 1:{f=a.LUMINANCE;break}case 2:{f=a.LUMINANCE_ALPHA;break}case 3:{f=a.RGB;break}case 4:{f=a.RGBA;break}default:throw new Error(`Unsupported number of bands: ${i}`)}const m=a.getParameter(a.UNPACK_ALIGNMENT);a.pixelStorei(a.UNPACK_ALIGNMENT,h),a.texImage2D(a.TEXTURE_2D,0,f,r[0],r[1],0,f,o,t),a.pixelStorei(a.UNPACK_ALIGNMENT,m)}let $f=null;function xK(){$f=Kr(1,1,void 0,{willReadFrequently:!0})}class _K extends pK{constructor(e){super(e),this.textures=[],this.renderSize_=Ii(e.grid.getTileSize(e.tile.tileCoord[0])),this.bandCount=NaN;const t=new Bm(kp,FA);t.fromArray([0,1,1,1,1,0,0,0]),this.helper.flushBufferData(t),this.coords=t,this.setTile(e.tile)}setHelper(e){const t=this.helper?.getGL();if(t){this.helper.deleteBuffer(this.coords);for(let r=0;r<this.textures.length;++r)t.deleteTexture(this.textures[r])}super.setHelper(e),e&&e.flushBufferData(this.coords)}uploadTile(){const e=this.helper,t=e.getGL(),r=this.tile;this.textures.length=0;let i;r instanceof Fw||r instanceof VA?i=r.getImage():i=r.getData();const s=Pp(i);if(s){const b=t.createTexture();this.textures.push(b),this.bandCount=4,yK(t,b,s,r.interpolate),this.setReady();return}i=QM(i);const a=r.getSize(),o=[a[0]+2*this.gutter,a[1]+2*this.gutter],l=i instanceof Float32Array,c=o[0]*o[1],h=l?Float32Array:Uint8Array,f=h.BYTES_PER_ELEMENT,m=i.byteLength/o[1];this.bandCount=Math.floor(m/f/o[0]);const y=Math.ceil(this.bandCount/4);if(y===1){const b=t.createTexture();this.textures.push(b),nN(e,b,i,o,this.bandCount,r.interpolate),this.setReady();return}const x=new Array(y);for(let b=0;b<y;++b){const R=t.createTexture();this.textures.push(R);const M=b<y-1?4:(this.bandCount-1)%4+1;x[b]=new h(c*M)}let _=0,w=0;const S=o[0]*this.bandCount;for(let b=0;b<o[1];++b){for(let R=0;R<S;++R){const M=i[w+R],O=Math.floor(_/this.bandCount),G=R%this.bandCount,A=Math.floor(G/4),I=x[A],P=I.length/c,D=G%4;I[O*P+D]=M,++_}w+=m/f}for(let b=0;b<y;++b){const R=this.textures[b],M=x[b],O=M.length/c;nN(e,R,M,o,O,r.interpolate)}this.setReady()}getImagePixelData_(e,t,r){const i=this.gutter,s=this.renderSize_[0],a=this.renderSize_[1];$f||xK(),$f.clearRect(0,0,1,1);const o=e.width,l=e.height,c=o-2*i,h=l-2*i,f=i+Math.floor(c*(t/s)),m=i+Math.floor(h*(r/a));let y;try{$f.drawImage(e,f,m,1,1,0,0,1,1),y=$f.getImageData(0,0,1,1).data}catch{return $f=null,null}return y}getArrayPixelData_(e,t,r,i){const s=this.gutter,a=this.renderSize_[0],o=this.renderSize_[1],l=t[0],c=t[1],h=l+2*s,f=c+2*s,m=s+Math.floor(l*(r/a)),y=s+Math.floor(c*(i/o));if(e instanceof DataView){const _=e.byteLength/(h*f),w=_*(y*h+m),S=e.buffer.slice(w,w+_);return new DataView(S)}const x=this.bandCount*(y*h+m);return e.slice(x,x+this.bandCount)}getPixelData(e,t){if(!this.loaded)return null;if(this.tile instanceof _b){const r=this.tile.getData(),i=QM(r);if(i){const s=this.tile.getSize();return this.getArrayPixelData_(i,s,e,t)}return this.getImagePixelData_(Pp(r),e,t)}return this.getImagePixelData_(this.tile.getImage(),e,t)}}class jw{constructor(e,t,r,i){this.minX=e,this.maxX=t,this.minY=r,this.maxY=i}contains(e){return this.containsXY(e[1],e[2])}containsTileRange(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}containsXY(e,t){return this.minX<=e&&e<=this.maxX&&this.minY<=t&&t<=this.maxY}equals(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}extend(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}}function bf(n,e,t,r,i){return i!==void 0?(i.minX=n,i.maxX=e,i.minY=t,i.maxY=r,i):new jw(n,e,t,r)}class vb{constructor(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const e=this.pop();e instanceof py&&e.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(e){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let t=this.oldest_;for(;t;)e(t.value_,t.key_,this),t=t.newer}get(e,t){const r=this.entries_[e];return bn(r!==void 0,"Tried to get a value for a key that does not exist in the cache"),r===this.newest_||(r===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(r.newer.older=r.older,r.older.newer=r.newer),r.newer=null,r.older=this.newest_,this.newest_.newer=r,this.newest_=r),r.value_}remove(e){const t=this.entries_[e];return bn(t!==void 0,"Tried to get a value for a key that does not exist in the cache"),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_}getCount(){return this.count_}getKeys(){const e=new Array(this.count_);let t=0,r;for(r=this.newest_;r;r=r.older)e[t++]=r.key_;return e}getValues(){const e=new Array(this.count_);let t=0,r;for(r=this.newest_;r;r=r.older)e[t++]=r.value_;return e}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){return this.entries_[e]?.value_}pop(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,t){this.get(e),this.entries_[e].value_=t}set(e,t){bn(!(e in this.entries_),"Tried to set a value for a key that is used already");const r={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=r:this.oldest_=r,this.newest_=r,this.entries_[e]=r,++this.count_}setSize(e){this.highWaterMark=e}}function F0(n,e,t,r){return r!==void 0?(r[0]=n,r[1]=e,r[2]=t,r):[n,e,t]}function zF(n,e,t){return n+"/"+e+"/"+t}function Wf(n){return zF(n[0],n[1],n[2])}function i_(n,e,t,r,i){return`${Bt(n)},${e},${zF(t,r,i)}`}function UF(n){return vK(n[0],n[1],n[2])}function vK(n,e,t){return(e<<n)+t}function wK(n,e){const t=n[0],r=n[1],i=n[2];if(e.getMinZoom()>t||t>e.getMaxZoom())return!1;const s=e.getFullTileRange(t);return s?s.containsXY(r,i):!0}class Vw extends RF{constructor(e,t){super(e),t=t||{},this.inversePixelTransform_=ti(),this.postProcesses_=t.postProcesses,this.uniforms_=t.uniforms,this.helper,this.onMapChanged_=()=>{this.clearCache(),this.removeHelper()},e.addChangeListener(On.MAP,this.onMapChanged_),this.dispatchPreComposeEvent=this.dispatchPreComposeEvent.bind(this),this.dispatchPostComposeEvent=this.dispatchPostComposeEvent.bind(this)}dispatchPreComposeEvent(e,t){const r=this.getLayer();if(r.hasListener(Si.PRECOMPOSE)){const i=new Gm(Si.PRECOMPOSE,void 0,t,e);r.dispatchEvent(i)}}dispatchPostComposeEvent(e,t){const r=this.getLayer();if(r.hasListener(Si.POSTCOMPOSE)){const i=new Gm(Si.POSTCOMPOSE,void 0,t,e);r.dispatchEvent(i)}}reset(e){this.uniforms_=e.uniforms,this.helper&&this.helper.setUniforms(this.uniforms_)}removeHelper(){this.helper&&(this.helper.dispose(),delete this.helper)}prepareFrame(e){if(this.getLayer().getRenderSource()){let t=!0,r=-1,i;for(let a=0,o=e.layerStatesArray.length;a<o;a++){const l=e.layerStatesArray[a].layer,c=l.getRenderer();if(!(c instanceof Vw)){t=!0;continue}const h=l.getClassName();if((t||h!==i)&&(r+=1,t=!1),i=h,c===this)break}const s="map/"+e.mapId+"/group/"+r;(!this.helper||!this.helper.canvasCacheKeyMatches(s)||this.helper.needsToBeRecreated())&&(this.removeHelper(),this.helper=new lK({postProcesses:this.postProcesses_,uniforms:this.uniforms_,canvasCacheKey:s}),i&&(this.helper.getCanvas().className=i),this.afterHelperCreated())}return this.prepareFrameInternal(e)}afterHelperCreated(){}prepareFrameInternal(e){return!0}clearCache(){}disposeInternal(){this.clearCache(),this.removeHelper(),this.getLayer()?.removeChangeListener(On.MAP,this.onMapChanged_),super.disposeInternal()}dispatchRenderEvent_(e,t,r){const i=this.getLayer();if(i.hasListener(e)){$a(this.inversePixelTransform_,0,0,r.pixelRatio,-r.pixelRatio,0,0,-r.size[1]);const s=new Gm(e,this.inversePixelTransform_,r,t);i.dispatchEvent(s)}}preRender(e,t){this.dispatchRenderEvent_(Si.PRERENDER,e,t)}postRender(e,t){this.dispatchRenderEvent_(Si.POSTRENDER,e,t)}}const EK={TILE_TRANSFORM:"u_tileTransform",TRANSITION_ALPHA:"u_transitionAlpha",DEPTH:"u_depth",RENDER_EXTENT:"u_renderExtent",PATTERN_ORIGIN:"u_patternOrigin",RESOLUTION:"u_resolution",ZOOM:"u_zoom",GLOBAL_ALPHA:"u_globalAlpha",PROJECTION_MATRIX:"u_projectionMatrix",SCREEN_TO_WORLD_MATRIX:"u_screenToWorldMatrix"};function rN(n){return 1/(n+2)}function TK(){return{tileIds:new Set,representationsByZ:{}}}function iN(n,e){return n.tileIds.has(Bt(e))}function sN(n,e,t){const r=n.representationsByZ;t in r||(r[t]=new Set),r[t].add(e),n.tileIds.add(Bt(e.tile))}function BT(n,e){const t=n.layerStatesArray[n.layerIndex];t.extent&&(e=Va(e,Oa(t.extent,n.viewState.projection)));const r=t.layer.getRenderSource();if(!r.getWrapX()){const i=r.getTileGridForProjection(n.viewState.projection).getExtent();i&&(e=Va(e,i))}return e}function wb(n,e){return`${Bt(n)},${n.getKey()},${n.getRevision()},${Wf(e)}`}class SK extends Vw{constructor(e,t){super(e,{uniforms:t.uniforms,postProcesses:t.postProcesses}),this.renderComplete=!1,this.tileTransform_=ti(),this.tempMat4=DA(),this.tempTileRange_=new jw(0,0,0,0),this.tempTileCoord_=F0(0,0,0),this.tempSize_=[0,0];const r=t.cacheSize!==void 0?t.cacheSize:512;this.tileRepresentationCache=new vb(r),this.frameState=null,this.renderedProjection_=void 0}reset(e){super.reset({uniforms:e.uniforms})}prepareFrameInternal(e){this.renderedProjection_?e.viewState.projection!==this.renderedProjection_&&(this.clearCache(),this.renderedProjection_=e.viewState.projection):this.renderedProjection_=e.viewState.projection;const r=this.getLayer().getRenderSource();return!r||Ad(BT(e,e.extent))?!1:r.getState()==="ready"}createTileRepresentation(e){return Wt()}enqueueTiles(e,t,r,i,s){const a=e.viewState,o=this.getLayer(),l=o.getRenderSource(),c=l.getTileGridForProjection(a.projection),h=l.getGutterForProjection(a.projection),f=Bt(l);f in e.wantedTiles||(e.wantedTiles[f]={});const m=e.wantedTiles[f],y=this.tileRepresentationCache,x=o.getMapInternal(),_=Math.max(r-s,c.getMinZoom(),c.getZForResolution(Math.min(o.getMaxResolution(),x?x.getView().getResolutionForZoom(Math.max(o.getMinZoom(),0)):c.getResolution(0)),l.zDirection)),w=a.rotation,S=w?nA(a.center,a.resolution,w,e.size):void 0;for(let b=r;b>=_;--b){const R=c.getTileRangeForExtentAndZ(t,b,this.tempTileRange_),M=c.getResolution(b);for(let O=R.minX;O<=R.maxX;++O)for(let G=R.minY;G<=R.maxY;++G){if(w&&!c.tileCoordIntersectsViewport([b,O,G],S))continue;const A=F0(b,O,G,this.tempTileCoord_),I=wb(l,A);let P,D;if(y.containsKey(I)&&(P=y.get(I),D=P.tile),(!P||P.tile.key!==l.getKey())&&(D=l.getTile(b,O,G,e.pixelRatio,a.projection),!D)||iN(i,D))continue;P?P.setTile(D):(P=this.createTileRepresentation({tile:D,grid:c,helper:this.helper,gutter:h}),y.set(I,P)),sN(i,P,b);const L=D.getKey();m[L]=!0,D.getState()===Lt.IDLE&&(e.tileQueue.isKeyQueued(L)||e.tileQueue.enqueue([D,f,c.getTileCoordCenter(A),M]))}}}beforeTilesRender(e,t){this.helper.prepareDraw(this.frameState,!t,!0)}beforeTilesMaskRender(e){return!1}renderTile(e,t,r,i,s,a,o,l,c,h,f){}renderTileMask(e,t,r,i){}drawTile_(e,t,r,i,s,a,o){if(!t.ready)return;const c=t.tile.tileCoord,h=Wf(c),f=h in a?a[h]:1,m=o.getResolution(r),y=Ii(o.getTileSize(r),this.tempSize_),x=o.getOrigin(r),_=o.getTileCoordExtent(c),w=f<1?-1:rN(r);f<1&&(e.animate=!0);const S=e.viewState,b=S.center[0],R=S.center[1],M=y[0]+2*i,O=y[1]+2*i,G=M/O,A=(b-x[0])/(y[0]*m),I=(x[1]-R)/(y[1]*m),P=S.resolution/m,D=c[1],L=c[2];x$(this.tileTransform_),dM(this.tileTransform_,2/(e.size[0]*P/M),-2/(e.size[1]*P/M)),_$(this.tileTransform_,S.rotation),dM(this.tileTransform_,1,1/G),UD(this.tileTransform_,(y[0]*(D-A)-i)/M,(y[1]*(L-I)-i)/O),this.renderTile(t,this.tileTransform_,e,s,m,y,x,_,w,i,f)}renderFrame(e){this.frameState=e,this.renderComplete=!0;const t=this.helper.getGL();this.preRender(t,e);const r=e.viewState,i=this.getLayer(),s=i.getRenderSource(),a=s.getTileGridForProjection(r.projection),o=s.getGutterForProjection(r.projection),l=BT(e,e.extent),c=a.getZForResolution(r.resolution,s.zDirection),h=TK(),f=i.getPreload();if(e.nextExtent){const R=a.getZForResolution(r.nextResolution,s.zDirection),M=BT(e,e.nextExtent);this.enqueueTiles(e,M,R,h,f)}this.enqueueTiles(e,l,c,h,0),f>0&&setTimeout(()=>{this.enqueueTiles(e,l,c-1,h,f-1)},0);const m={};let y=!1;const x=h.representationsByZ;if(c in x){const R=Bt(this),M=e.time;for(const O of x[c]){const G=O.tile;if(G.getState()===Lt.EMPTY)continue;const A=G.tileCoord;if(O.ready){const D=G.getAlpha(R,M);if(D===1){G.endTransition(R);continue}y=!0;const L=Wf(A);m[L]=D}if(this.renderComplete=!1,this.findAltTiles_(a,A,c+1,h))continue;const P=a.getMinZoom();for(let D=c-1;D>=P&&!this.findAltTiles_(a,A,D,h);--D);}}const _=Object.keys(x).map(Number).sort(vD);if(this.beforeTilesMaskRender(e))for(let R=0,M=_.length;R<M;++R){const O=_[R];for(const G of x[O]){const A=G.tile.tileCoord;if(Wf(A)in m)continue;const P=a.getTileCoordExtent(A);this.renderTileMask(G,O,P,rN(O))}}this.beforeTilesRender(e,y);for(let R=0,M=_.length;R<M;++R){const O=_[R];for(const G of x[O]){const A=G.tile.tileCoord;Wf(A)in m||this.drawTile_(e,G,O,o,l,m,a)}}if(c in x)for(const R of x[c]){const M=R.tile.tileCoord;Wf(M)in m&&this.drawTile_(e,R,c,o,l,m,a)}this.beforeFinalize(e),this.helper.finalizeDraw(e,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent);const S=this.helper.getCanvas();return this.tileRepresentationCache.expireCache(),this.postRender(t,e),S}beforeFinalize(e){}findAltTiles_(e,t,r,i){const s=e.getTileRangeForTileCoordAndZ(t,r,this.tempTileRange_);if(!s)return!1;let a=!0;const o=this.tileRepresentationCache,l=this.getLayer().getRenderSource();for(let c=s.minX;c<=s.maxX;++c)for(let h=s.minY;h<=s.maxY;++h){const f=wb(l,[r,c,h]);let m=!1;if(o.containsKey(f)){const y=o.get(f);y.ready&&!iN(i,y.tile)&&(sN(i,y,r),m=!0)}m||(a=!1)}return a}clearCache(){super.clearCache();const e=this.tileRepresentationCache;e.forEach(t=>t.dispose()),e.clear()}afterHelperCreated(){super.afterHelperCreated(),this.tileRepresentationCache.forEach(e=>e.setHelper(this.helper))}disposeInternal(){super.disposeInternal(),delete this.frameState}}const xs={...EK,TILE_TEXTURE_ARRAY:"u_tileTextures",TEXTURE_PIXEL_WIDTH:"u_texturePixelWidth",TEXTURE_PIXEL_HEIGHT:"u_texturePixelHeight",TEXTURE_RESOLUTION:"u_textureResolution",TEXTURE_ORIGIN_X:"u_textureOriginX",TEXTURE_ORIGIN_Y:"u_textureOriginY"},bK={TEXTURE_COORD:"a_textureCoord"},RK=[{name:bK.TEXTURE_COORD,size:2,type:wi.FLOAT}];class Lbe extends SK{constructor(e,t){super(e,t),this.program_,this.vertexShader_=t.vertexShader,this.fragmentShader_=t.fragmentShader,this.indices_=new Bm(Dw,FA),this.indices_.fromArray([0,1,3,1,2,3]),this.paletteTextures_=t.paletteTextures||[]}reset(e){if(super.reset(e),this.helper){const t=this.helper.getGL();for(const r of this.paletteTextures_)r.delete(t)}if(this.vertexShader_=e.vertexShader,this.fragmentShader_=e.fragmentShader,this.paletteTextures_=e.paletteTextures||[],this.helper){this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_);const t=this.helper.getGL();for(const r of this.paletteTextures_)r.getTexture(t)}}afterHelperCreated(){super.afterHelperCreated();const e=this.helper.getGL();for(const t of this.paletteTextures_)t.getTexture(e);this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_),this.helper.flushBufferData(this.indices_)}removeHelper(){if(this.helper){const e=this.helper.getGL();for(const t of this.paletteTextures_)t.delete(e)}super.removeHelper()}createTileRepresentation(e){return new _K(e)}beforeTilesRender(e,t){super.beforeTilesRender(e,t),this.helper.useProgram(this.program_,e)}renderTile(e,t,r,i,s,a,o,l,c,h,f){const m=this.helper.getGL();this.helper.bindBuffer(e.coords),this.helper.bindBuffer(this.indices_),this.helper.enableAttributes(RK);let y=0;for(;y<e.textures.length;){const G=`${xs.TILE_TEXTURE_ARRAY}[${y}]`;this.helper.bindTexture(e.textures[y],y,G),++y}for(let G=0;G<this.paletteTextures_.length;++G){const A=this.paletteTextures_[G],I=A.getTexture(m);this.helper.bindTexture(I,y,A.name),++y}const x=r.viewState,_=a[0]+2*h,w=a[1]+2*h,b=e.tile.tileCoord,R=b[1],M=b[2];this.helper.setUniformMatrixValue(xs.TILE_TRANSFORM,K_(this.tempMat4,t)),this.helper.setUniformFloatValue(xs.TRANSITION_ALPHA,f),this.helper.setUniformFloatValue(xs.DEPTH,c);let O=i;h>0&&(O=l,Va(O,i,O)),this.helper.setUniformFloatVec4(xs.RENDER_EXTENT,O),this.helper.setUniformFloatValue(xs.RESOLUTION,x.resolution),this.helper.setUniformFloatValue(xs.ZOOM,x.zoom),this.helper.setUniformFloatValue(xs.TEXTURE_PIXEL_WIDTH,_),this.helper.setUniformFloatValue(xs.TEXTURE_PIXEL_HEIGHT,w),this.helper.setUniformFloatValue(xs.TEXTURE_RESOLUTION,s),this.helper.setUniformFloatValue(xs.TEXTURE_ORIGIN_X,o[0]+R*a[0]*s-h*s),this.helper.setUniformFloatValue(xs.TEXTURE_ORIGIN_Y,o[1]-M*a[1]*s+h*s),this.helper.drawElements(0,this.indices_.getSize())}getData(e){if(!this.helper.getGL())return null;const r=this.frameState;if(!r)return null;const i=this.getLayer(),s=kr(r.pixelToCoordinateTransform,e.slice()),a=r.viewState,o=i.getExtent();if(o&&!rc(Oa(o,a.projection),s))return null;const l=i.getSources(tb([s]),a.resolution);let c,h,f;for(c=l.length-1;c>=0;--c)if(h=l[c],h.getState()==="ready"){if(f=h.getTileGridForProjection(a.projection),h.getWrapX())break;const y=f.getExtent();if(!y||rc(y,s))break}if(c<0)return null;const m=this.tileRepresentationCache;for(let y=f.getZForResolution(a.resolution);y>=f.getMinZoom();--y){const x=f.getTileCoordForCoordAndZ(s,y),_=wb(h,x);if(!m.containsKey(_))continue;const w=m.get(_);if(w.tile.getState()===Lt.EMPTY)return null;if(!w.loaded)continue;const b=f.getOrigin(y),R=Ii(f.getTileSize(y)),M=f.getResolution(y),O=(s[0]-b[0])/M-x[1]*R[0],G=(b[1]-s[1])/M-x[2]*R[1];return w.getPixelData(O,G)}return null}disposeInternal(){const e=this.helper;if(e){const t=e.getGL();for(const r of this.paletteTextures_)r.delete(t);this.paletteTextures_.length=0,t.deleteProgram(this.program_),delete this.program_,e.deleteBuffer(this.indices_)}super.disposeInternal(),delete this.indices_}}class AK{constructor(e,t){this.name=e,this.data=t,this.texture_=null}getTexture(e){if(!this.texture_){const t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.data.length/4,1,0,e.RGBA,e.UNSIGNED_BYTE,this.data),this.texture_=t}return this.texture_}delete(e){this.texture_&&e.deleteTexture(this.texture_),this.texture_=null}}function IK(n,e){return`operator_${n}_${Object.keys(e.functions).length}`}function wu(n){const e=n.toString();return e.includes(".")?e:e+".0"}function GA(n){if(n.length<2||n.length>4)throw new Error("`formatArray` can only output `vec2`, `vec3` or `vec4` arrays.");return`vec${n.length}(${n.map(wu).join(", ")})`}function s_(n){const e=Wa(n),t=e.length>3?e[3]:1;return GA([e[0]/255,e[1]/255,e[2]/255,t])}function CK(n){const e=Ii(n);return GA(e)}const zT={};let kK=0;function Mp(n){return n in zT||(zT[n]=kK++),zT[n]}function zl(n){return wu(Mp(n))}function BA(n){return"u_var_"+n}function $F(){return{variables:{},properties:{},functions:{},bandCount:0,featureId:!1,geometryType:!1}}const UT="getBandValue",PK="u_paletteTextures",WF="featureId",HF="geometryType",Eb=-9999999;function MK(n,e,t,r){const i=Ci(n,e,t);return zA(i,e,r)}function kn(n){return(e,t,r)=>{const i=t.args.length,s=new Array(i);for(let a=0;a<i;++a)s[a]=zA(t.args[a],r,e);return n(s,e)}}const NK={[me.Get]:(n,e)=>{const r=e.args[0].value;r in n.properties||(n.properties[r]={name:r,type:e.type});let s="a_prop_"+r;return Xo(e.type,Qr)&&(s=`(${s} > 0.0)`),s},[me.Id]:n=>(n.featureId=!0,"a_"+WF),[me.GeometryType]:n=>(n.geometryType=!0,"a_"+HF),[me.LineMetric]:()=>"currentLineMetric",[me.Var]:(n,e)=>{const r=e.args[0].value;r in n.variables||(n.variables[r]={name:r,type:e.type});let s=BA(r);return Xo(e.type,Qr)&&(s=`(${s} > 0.0)`),s},[me.Has]:(n,e)=>{const r=e.args[0].value;return r in n.properties||(n.properties[r]={name:r,type:e.type}),`(a_prop_${r} != ${wu(Eb)})`},[me.Resolution]:()=>"u_resolution",[me.Zoom]:()=>"u_zoom",[me.Time]:()=>"u_time",[me.Any]:kn(n=>`(${n.join(" || ")})`),[me.All]:kn(n=>`(${n.join(" && ")})`),[me.Not]:kn(([n])=>`(!${n})`),[me.Equal]:kn(([n,e])=>`(${n} == ${e})`),[me.NotEqual]:kn(([n,e])=>`(${n} != ${e})`),[me.GreaterThan]:kn(([n,e])=>`(${n} > ${e})`),[me.GreaterThanOrEqualTo]:kn(([n,e])=>`(${n} >= ${e})`),[me.LessThan]:kn(([n,e])=>`(${n} < ${e})`),[me.LessThanOrEqualTo]:kn(([n,e])=>`(${n} <= ${e})`),[me.Multiply]:kn(n=>`(${n.join(" * ")})`),[me.Divide]:kn(([n,e])=>`(${n} / ${e})`),[me.Add]:kn(n=>`(${n.join(" + ")})`),[me.Subtract]:kn(([n,e])=>`(${n} - ${e})`),[me.Clamp]:kn(([n,e,t])=>`clamp(${n}, ${e}, ${t})`),[me.Mod]:kn(([n,e])=>`mod(${n}, ${e})`),[me.Pow]:kn(([n,e])=>`pow(${n}, ${e})`),[me.Abs]:kn(([n])=>`abs(${n})`),[me.Floor]:kn(([n])=>`floor(${n})`),[me.Ceil]:kn(([n])=>`ceil(${n})`),[me.Round]:kn(([n])=>`floor(${n} + 0.5)`),[me.Sin]:kn(([n])=>`sin(${n})`),[me.Cos]:kn(([n])=>`cos(${n})`),[me.Atan]:kn(([n,e])=>e!==void 0?`atan(${n}, ${e})`:`atan(${n})`),[me.Sqrt]:kn(([n])=>`sqrt(${n})`),[me.Match]:kn(n=>{const e=n[0],t=n[n.length-1];let r=null;for(let i=n.length-3;i>=1;i-=2){const s=n[i],a=n[i+1];r=`(${e} == ${s} ? ${a} : ${r||t})`}return r}),[me.Between]:kn(([n,e,t])=>`(${n} >= ${e} && ${n} <= ${t})`),[me.Interpolate]:kn(([n,e,...t])=>{let r="";for(let i=0;i<t.length-2;i+=2){const s=t[i],a=r||t[i+1],o=t[i+2],l=t[i+3];let c;n===wu(1)?c=`(${e} - ${s}) / (${o} - ${s})`:c=`(pow(${n}, (${e} - ${s})) - 1.0) / (pow(${n}, (${o} - ${s})) - 1.0)`,r=`mix(${a}, ${l}, clamp(${c}, 0.0, 1.0))`}return r}),[me.Case]:kn(n=>{const e=n[n.length-1];let t=null;for(let r=n.length-3;r>=0;r-=2){const i=n[r],s=n[r+1];t=`(${i} ? ${s} : ${t||e})`}return t}),[me.In]:kn(([n,...e],t)=>{const r=IK("in",t),i=[];for(let s=0;s<e.length;s+=1)i.push(`  if (inputValue == ${e[s]}) { return true; }`);return t.functions[r]=`bool ${r}(float inputValue) {
${i.join(`
`)}
  return false;
}`,`${r}(${n})`}),[me.Array]:kn(n=>`vec${n.length}(${n.join(", ")})`),[me.Color]:kn(n=>{if(n.length===1)return`vec4(vec3(${n[0]} / 255.0), 1.0)`;if(n.length===2)return`vec4(vec3(${n[0]} / 255.0), ${n[1]})`;const e=n.slice(0,3).map(r=>`${r} / 255.0`);if(n.length===3)return`vec4(${e.join(", ")}, 1.0)`;const t=n[3];return`vec4(${e.join(", ")}, ${t})`}),[me.Band]:kn(([n,e,t],r)=>{if(!(UT in r.functions)){let i="";const s=r.bandCount||1;for(let a=0;a<s;a++){const o=Math.floor(a/4);let l=a%4;a===s-1&&l===1&&(l=3);const c=`${xs.TILE_TEXTURE_ARRAY}[${o}]`;i+=`  if (band == ${a+1}.0) {
    return texture2D(${c}, v_textureCoord + vec2(dx, dy))[${l}];
  }
`}r.functions[UT]=`float getBandValue(float band, float xOffset, float yOffset) {
  float dx = xOffset / ${xs.TEXTURE_PIXEL_WIDTH};
  float dy = yOffset / ${xs.TEXTURE_PIXEL_HEIGHT};
${i}
}`}return`${UT}(${n}, ${e??"0.0"}, ${t??"0.0"})`}),[me.Palette]:(n,e)=>{const[t,...r]=e.args,i=r.length,s=new Uint8Array(i*4);for(let c=0;c<r.length;c++){const h=r[c].value,f=Wa(h),m=c*4;s[m]=f[0],s[m+1]=f[1],s[m+2]=f[2],s[m+3]=f[3]*255}n.paletteTextures||(n.paletteTextures=[]);const a=`${PK}[${n.paletteTextures.length}]`,o=new AK(a,s);n.paletteTextures.push(o);const l=zA(t,It,n);return`texture2D(${a}, vec2((${l} + 0.5) / ${i}.0, 0.5))`}};function zA(n,e,t){if(n instanceof AF){const r=NK[n.operator];if(r===void 0)throw new Error(`No compiler defined for this operator: ${JSON.stringify(n.operator)}`);return r(t,n,e)}if((n.type&It)>0)return wu(n.value);if((n.type&Qr)>0)return n.value.toString();if((n.type&fi)>0)return zl(n.value.toString());if((n.type&vr)>0)return s_(n.value);if((n.type&Ws)>0)return GA(n.value);if((n.type&Fa)>0)return CK(n.value);throw new Error(`Unexpected expression ${n.value} (expected type ${r0(e)})`)}function LK(){return{"fill-color":"rgba(255,255,255,0.4)","stroke-color":"#3399CC","stroke-width":1.25,"circle-radius":5,"circle-fill-color":"rgba(255,255,255,0.4)","circle-stroke-width":1.25,"circle-stroke-color":"#3399CC"}}const aN=.985;function Zt(n,e,t){const r=IA();return MK(e,t,r,n)}function OK(n){const e=Wa(n),t=e[0]*256,r=e[1],i=e[2]*256,s=Math.round(e[3]*255);return[t+r,i+s]}const DK=`vec4 unpackColor(vec2 packedColor) {
  return vec4(
    min(floor(packedColor[0] / 256.0) / 255.0, 1.0),
    min(mod(packedColor[0], 256.0) / 255.0, 1.0),
    min(floor(packedColor[1] / 256.0) / 255.0, 1.0),
    min(mod(packedColor[1], 256.0) / 255.0, 1.0)
  );
}`;function UA(n){return n===vr||n===Fa?2:n===Ws?4:1}function Tb(n){const e=UA(n);return e>1?`vec${e}`:"float"}function KF(n,e){for(const t in e.variables){const r=e.variables[t],i=BA(r.name);let s=Tb(r.type);r.type===vr&&(s="vec4"),n.addUniform(i,s)}for(const t in e.properties){const r=e.properties[t],i=Tb(r.type),s=`a_prop_${r.name}`;r.type===vr?n.addAttribute(s,i,`unpackColor(${s})`,"vec4"):n.addAttribute(s,i)}for(const t in e.functions)n.addVertexShaderFunction(e.functions[t]),n.addFragmentShaderFunction(e.functions[t])}function XF(n,e){const t={};for(const r in n.variables){const i=n.variables[r],s=BA(i.name);t[s]=()=>{const a=e[i.name];if(typeof a=="number")return a;if(typeof a=="boolean")return a?1:0;if(i.type===vr){const o=[...Wa(a||"#eee")];return o[0]/=255,o[1]/=255,o[2]/=255,o[3]??=1,o}return typeof a=="string"?Mp(a):a}}return t}function qF(n){const e={};for(const t in n.properties){const r=n.properties[t],i=s=>{const a=s.get(r.name);return r.type===vr?OK([...Wa(a||"#eee")]):typeof a=="string"?Mp(a):typeof a=="boolean"?a?1:0:a};e[`prop_${r.name}`]={size:UA(r.type),callback:i}}return e}const Rf=`#ifdef GL_FRAGMENT_PRECISION_HIGH
precision highp float;
#else
precision mediump float;
#endif
uniform mat4 u_projectionMatrix;
uniform mat4 u_screenToWorldMatrix;
uniform vec2 u_viewportSizePx;
uniform float u_pixelRatio;
uniform float u_globalAlpha;
uniform float u_time;
uniform float u_zoom;
uniform float u_resolution;
uniform float u_rotation;
uniform vec4 u_renderExtent;
uniform vec2 u_patternOrigin;
uniform float u_depth;
uniform mediump int u_hitDetection;

const float PI = 3.141592653589793238;
const float TWO_PI = 2.0 * PI;
float currentLineMetric = 0.; // an actual value will be used in the stroke shaders

${DK}
`,Af=LK();class YF{constructor(){this.uniforms_=[],this.attributes_=[],this.hasSymbol_=!1,this.symbolSizeExpression_=`vec2(${wu(Af["circle-radius"])} + ${wu(Af["circle-stroke-width"]*.5)})`,this.symbolRotationExpression_="0.0",this.symbolOffsetExpression_="vec2(0.0)",this.symbolColorExpression_=s_(Af["circle-fill-color"]),this.texCoordExpression_="vec4(0.0, 0.0, 1.0, 1.0)",this.discardExpression_="false",this.symbolRotateWithView_=!1,this.hasStroke_=!1,this.strokeWidthExpression_=wu(Af["stroke-width"]),this.strokeColorExpression_=s_(Af["stroke-color"]),this.strokeOffsetExpression_="0.",this.strokeCapExpression_=zl("round"),this.strokeJoinExpression_=zl("round"),this.strokeMiterLimitExpression_="10.",this.strokeDistanceFieldExpression_="-1000.",this.strokePatternLengthExpression_=null,this.hasFill_=!1,this.fillColorExpression_=s_(Af["fill-color"]),this.vertexShaderFunctions_=[],this.fragmentShaderFunctions_=[]}addUniform(e,t){return this.uniforms_.push({name:e,type:t}),this}addAttribute(e,t,r,i){return this.attributes_.push({name:e,type:t,varyingName:e.replace(/^a_/,"v_"),varyingType:i??t,varyingExpression:r??e}),this}setSymbolSizeExpression(e){return this.hasSymbol_=!0,this.symbolSizeExpression_=e,this}getSymbolSizeExpression(){return this.symbolSizeExpression_}setSymbolRotationExpression(e){return this.symbolRotationExpression_=e,this}setSymbolOffsetExpression(e){return this.symbolOffsetExpression_=e,this}getSymbolOffsetExpression(){return this.symbolOffsetExpression_}setSymbolColorExpression(e){return this.hasSymbol_=!0,this.symbolColorExpression_=e,this}getSymbolColorExpression(){return this.symbolColorExpression_}setTextureCoordinateExpression(e){return this.texCoordExpression_=e,this}setFragmentDiscardExpression(e){return this.discardExpression_=e,this}getFragmentDiscardExpression(){return this.discardExpression_}setSymbolRotateWithView(e){return this.symbolRotateWithView_=e,this}setStrokeWidthExpression(e){return this.hasStroke_=!0,this.strokeWidthExpression_=e,this}setStrokeColorExpression(e){return this.hasStroke_=!0,this.strokeColorExpression_=e,this}getStrokeColorExpression(){return this.strokeColorExpression_}setStrokeOffsetExpression(e){return this.strokeOffsetExpression_=e,this}setStrokeCapExpression(e){return this.strokeCapExpression_=e,this}setStrokeJoinExpression(e){return this.strokeJoinExpression_=e,this}setStrokeMiterLimitExpression(e){return this.strokeMiterLimitExpression_=e,this}setStrokeDistanceFieldExpression(e){return this.strokeDistanceFieldExpression_=e,this}setStrokePatternLengthExpression(e){return this.strokePatternLengthExpression_=e,this}getStrokePatternLengthExpression(){return this.strokePatternLengthExpression_}setFillColorExpression(e){return this.hasFill_=!0,this.fillColorExpression_=e,this}getFillColorExpression(){return this.fillColorExpression_}addVertexShaderFunction(e){return this.vertexShaderFunctions_.includes(e)?this:(this.vertexShaderFunctions_.push(e),this)}addFragmentShaderFunction(e){return this.fragmentShaderFunctions_.includes(e)?this:(this.fragmentShaderFunctions_.push(e),this)}getSymbolVertexShader(){return this.hasSymbol_?`${Rf}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
attribute vec2 a_position;
attribute vec2 a_localPosition;
attribute vec2 a_hitColor;

varying vec2 v_texCoord;
varying vec2 v_quadCoord;
varying vec4 v_hitColor;
varying vec2 v_centerPx;
varying float v_angle;
varying vec2 v_quadSizePx;

${this.attributes_.map(e=>`attribute ${e.type} ${e.name};
varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
vec2 pxToScreen(vec2 coordPx) {
  vec2 scaled = coordPx / u_viewportSizePx / 0.5;
  return scaled;
}

vec2 screenToPx(vec2 coordScreen) {
  return (coordScreen * 0.5 + 0.5) * u_viewportSizePx;
}

void main(void) {
  v_quadSizePx = ${this.symbolSizeExpression_};
  vec2 halfSizePx = v_quadSizePx * 0.5;
  vec2 centerOffsetPx = ${this.symbolOffsetExpression_};
  vec2 offsetPx = centerOffsetPx + a_localPosition * halfSizePx * vec2(1., -1.);
  float angle = ${this.symbolRotationExpression_}${this.symbolRotateWithView_?" + u_rotation":""};
  float c = cos(-angle);
  float s = sin(-angle);
  offsetPx = vec2(c * offsetPx.x - s * offsetPx.y, s * offsetPx.x + c * offsetPx.y);
  vec4 center = u_projectionMatrix * vec4(a_position, 0.0, 1.0);
  gl_Position = center + vec4(pxToScreen(offsetPx), u_depth, 0.);
  vec4 texCoord = ${this.texCoordExpression_};
  float u = mix(texCoord.s, texCoord.p, a_localPosition.x * 0.5 + 0.5);
  float v = mix(texCoord.t, texCoord.q, a_localPosition.y * 0.5 + 0.5);
  v_texCoord = vec2(u, v);
  v_hitColor = unpackColor(a_hitColor);
  v_angle = angle;
  c = cos(-v_angle);
  s = sin(-v_angle);
  centerOffsetPx = vec2(c * centerOffsetPx.x - s * centerOffsetPx.y, s * centerOffsetPx.x + c * centerOffsetPx.y);
  v_centerPx = screenToPx(center.xy) + centerOffsetPx;
${this.attributes_.map(e=>`  ${e.varyingName} = ${e.varyingExpression};`).join(`
`)}
}`:null}getSymbolFragmentShader(){return this.hasSymbol_?`${Rf}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
varying vec2 v_texCoord;
varying vec4 v_hitColor;
varying vec2 v_centerPx;
varying float v_angle;
varying vec2 v_quadSizePx;
${this.attributes_.map(e=>`varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}

void main(void) {
${this.attributes_.map(e=>`  ${e.varyingType} ${e.name} = ${e.varyingName}; // assign to original attribute name`).join(`
`)}
  if (${this.discardExpression_}) { discard; }
  vec2 coordsPx = gl_FragCoord.xy / u_pixelRatio - v_centerPx; // relative to center
  float c = cos(v_angle);
  float s = sin(v_angle);
  coordsPx = vec2(c * coordsPx.x - s * coordsPx.y, s * coordsPx.x + c * coordsPx.y);
  gl_FragColor = ${this.symbolColorExpression_};
  gl_FragColor.rgb *= gl_FragColor.a;
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.05) { discard; };
    gl_FragColor = v_hitColor;
  }
}`:null}getStrokeVertexShader(){return this.hasStroke_?`${Rf}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
attribute vec2 a_segmentStart;
attribute vec2 a_segmentEnd;
attribute vec2 a_localPosition;
attribute float a_measureStart;
attribute float a_measureEnd;
attribute float a_angleTangentSum;
attribute float a_distanceLow;
attribute float a_distanceHigh;
attribute vec2 a_joinAngles;
attribute vec2 a_hitColor;

varying vec2 v_segmentStartPx;
varying vec2 v_segmentEndPx;
varying float v_angleStart;
varying float v_angleEnd;
varying float v_width;
varying vec4 v_hitColor;
varying float v_distancePx;
varying float v_measureStart;
varying float v_measureEnd;

${this.attributes_.map(e=>`attribute ${e.type} ${e.name};
varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
vec2 worldToPx(vec2 worldPos) {
  vec4 screenPos = u_projectionMatrix * vec4(worldPos, 0.0, 1.0);
  return (0.5 * screenPos.xy + 0.5) * u_viewportSizePx;
}

vec4 pxToScreen(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return vec4(screenPos, u_depth, 1.0);
}

bool isCap(float joinAngle) {
  return joinAngle < -0.1;
}

vec2 getJoinOffsetDirection(vec2 normalPx, float joinAngle) {
  float halfAngle = joinAngle / 2.0;
  float c = cos(halfAngle);
  float s = sin(halfAngle);
  vec2 angleBisectorNormal = vec2(s * normalPx.x + c * normalPx.y, -c * normalPx.x + s * normalPx.y);
  float length = 1.0 / s;
  return angleBisectorNormal * length;
}

vec2 getOffsetPoint(vec2 point, vec2 normal, float joinAngle, float offsetPx) {
  // if on a cap or the join angle is too high, offset the line along the segment normal
  if (cos(joinAngle) > 0.998 || isCap(joinAngle)) {
    return point - normal * offsetPx;
  }
  // offset is applied along the inverted normal (positive offset goes "right" relative to line direction)
  return point - getJoinOffsetDirection(normal, joinAngle) * offsetPx;
}

void main(void) {
  v_angleStart = a_joinAngles.x;
  v_angleEnd = a_joinAngles.y;
  float startEndRatio = a_localPosition.x * 0.5 + 0.5;
  currentLineMetric = mix(a_measureStart, a_measureEnd, startEndRatio);
  // we're reading the fractional part while keeping the sign (so -4.12 gives -0.12, 3.45 gives 0.45)

  float lineWidth = ${this.strokeWidthExpression_};
  float lineOffsetPx = ${this.strokeOffsetExpression_};

  // compute segment start/end in px with offset
  vec2 segmentStartPx = worldToPx(a_segmentStart);
  vec2 segmentEndPx = worldToPx(a_segmentEnd);
  vec2 tangentPx = normalize(segmentEndPx - segmentStartPx);
  vec2 normalPx = vec2(-tangentPx.y, tangentPx.x);
  segmentStartPx = getOffsetPoint(segmentStartPx, normalPx, v_angleStart, lineOffsetPx),
  segmentEndPx = getOffsetPoint(segmentEndPx, normalPx, v_angleEnd, lineOffsetPx);

  // compute current vertex position
  float normalDir = -1. * a_localPosition.y;
  float tangentDir = -1. * a_localPosition.x;
  float angle = mix(v_angleStart, v_angleEnd, startEndRatio);
  vec2 joinDirection;
  vec2 positionPx = mix(segmentStartPx, segmentEndPx, startEndRatio);
  // if angle is too high, do not make a proper join
  if (cos(angle) > ${aN} || isCap(angle)) {
    joinDirection = normalPx * normalDir - tangentPx * tangentDir;
  } else {
    joinDirection = getJoinOffsetDirection(normalPx * normalDir, angle);
  }
  positionPx = positionPx + joinDirection * (lineWidth * 0.5 + 1.); // adding 1 pixel for antialiasing
  gl_Position = pxToScreen(positionPx);

  v_segmentStartPx = segmentStartPx;
  v_segmentEndPx = segmentEndPx;
  v_width = lineWidth;
  v_hitColor = unpackColor(a_hitColor);

  v_distancePx = a_distanceLow / u_resolution - (lineOffsetPx * a_angleTangentSum);
  float distanceHighPx = a_distanceHigh / u_resolution;
  ${this.strokePatternLengthExpression_!==null?`v_distancePx = mod(v_distancePx, ${this.strokePatternLengthExpression_});
  distanceHighPx = mod(distanceHighPx, ${this.strokePatternLengthExpression_});
  `:""}v_distancePx += distanceHighPx;

  v_measureStart = a_measureStart;
  v_measureEnd = a_measureEnd;
${this.attributes_.map(e=>`  ${e.varyingName} = ${e.varyingExpression};`).join(`
`)}
}`:null}getStrokeFragmentShader(){return this.hasStroke_?`${Rf}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
varying vec2 v_segmentStartPx;
varying vec2 v_segmentEndPx;
varying float v_angleStart;
varying float v_angleEnd;
varying float v_width;
varying vec4 v_hitColor;
varying float v_distancePx;
varying float v_measureStart;
varying float v_measureEnd;
${this.attributes_.map(e=>`varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}

vec2 pxToWorld(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return (u_screenToWorldMatrix * vec4(screenPos, 0.0, 1.0)).xy;
}

bool isCap(float joinAngle) {
  return joinAngle < -0.1;
}

float segmentDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  vec2 tangent = normalize(end - start);
  vec2 normal = vec2(-tangent.y, tangent.x);
  vec2 startToPoint = point - start;
  return abs(dot(startToPoint, normal)) - width * 0.5;
}

float buttCapDistanceField(vec2 point, vec2 start, vec2 end) {
  vec2 startToPoint = point - start;
  vec2 tangent = normalize(end - start);
  return dot(startToPoint, -tangent);
}

float squareCapDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  return buttCapDistanceField(point, start, end) - width * 0.5;
}

float roundCapDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  float onSegment = max(0., 1000. * dot(point - start, end - start)); // this is very high when inside the segment
  return length(point - start) - width * 0.5 - onSegment;
}

float roundJoinDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  return roundCapDistanceField(point, start, end, width);
}

float bevelJoinField(vec2 point, vec2 start, vec2 end, float width, float joinAngle) {
  vec2 startToPoint = point - start;
  vec2 tangent = normalize(end - start);
  float c = cos(joinAngle * 0.5);
  float s = sin(joinAngle * 0.5);
  float direction = -sign(sin(joinAngle));
  vec2 bisector = vec2(c * tangent.x - s * tangent.y, s * tangent.x + c * tangent.y);
  float radius = width * 0.5 * s;
  return dot(startToPoint, bisector * direction) - radius;
}

float miterJoinDistanceField(vec2 point, vec2 start, vec2 end, float width, float joinAngle) {
  if (cos(joinAngle) > ${aN}) { // avoid risking a division by zero
    return bevelJoinField(point, start, end, width, joinAngle);
  }
  float miterLength = 1. / sin(joinAngle * 0.5);
  float miterLimit = ${this.strokeMiterLimitExpression_};
  if (miterLength > miterLimit) {
    return bevelJoinField(point, start, end, width, joinAngle);
  }
  return -1000.;
}

float capDistanceField(vec2 point, vec2 start, vec2 end, float width, float capType) {
   if (capType == ${zl("butt")}) {
    return buttCapDistanceField(point, start, end);
  } else if (capType == ${zl("square")}) {
    return squareCapDistanceField(point, start, end, width);
  }
  return roundCapDistanceField(point, start, end, width);
}

float joinDistanceField(vec2 point, vec2 start, vec2 end, float width, float joinAngle, float joinType) {
  if (joinType == ${zl("bevel")}) {
    return bevelJoinField(point, start, end, width, joinAngle);
  } else if (joinType == ${zl("miter")}) {
    return miterJoinDistanceField(point, start, end, width, joinAngle);
  }
  return roundJoinDistanceField(point, start, end, width);
}

float computeSegmentPointDistance(vec2 point, vec2 start, vec2 end, float width, float joinAngle, float capType, float joinType) {
  if (isCap(joinAngle)) {
    return capDistanceField(point, start, end, width, capType);
  }
  return joinDistanceField(point, start, end, width, joinAngle, joinType);
}

float distanceFromSegment(vec2 point, vec2 start, vec2 end) {
  vec2 tangent = end - start;
  vec2 startToPoint = point - start;
  // inspire by capsule fn in https://iquilezles.org/articles/distfunctions/
  float h = clamp(dot(startToPoint, tangent) / dot(tangent, tangent), 0.0, 1.0);
  return length(startToPoint - tangent * h);
}

void main(void) {
${this.attributes_.map(e=>`  ${e.varyingType} ${e.name} = ${e.varyingName}; // assign to original attribute name`).join(`
`)}

  vec2 currentPointPx = gl_FragCoord.xy / u_pixelRatio;
  #ifdef GL_FRAGMENT_PRECISION_HIGH
  vec2 worldPos = pxToWorld(currentPointPx);
  if (
    abs(u_renderExtent[0] - u_renderExtent[2]) > 0.0 && (
      worldPos[0] < u_renderExtent[0] ||
      worldPos[1] < u_renderExtent[1] ||
      worldPos[0] > u_renderExtent[2] ||
      worldPos[1] > u_renderExtent[3]
    )
  ) {
    discard;
  }
  #endif

  float segmentLengthPx = length(v_segmentEndPx - v_segmentStartPx);
  segmentLengthPx = max(segmentLengthPx, 1.17549429e-38); // avoid divide by zero
  vec2 segmentTangent = (v_segmentEndPx - v_segmentStartPx) / segmentLengthPx;
  vec2 segmentNormal = vec2(-segmentTangent.y, segmentTangent.x);
  vec2 startToPointPx = currentPointPx - v_segmentStartPx;
  float lengthToPointPx = max(0., min(dot(segmentTangent, startToPointPx), segmentLengthPx));
  float currentLengthPx = lengthToPointPx + v_distancePx;
  float currentRadiusPx = distanceFromSegment(currentPointPx, v_segmentStartPx, v_segmentEndPx);
  float currentRadiusRatio = dot(segmentNormal, startToPointPx) * 2. / v_width;
  currentLineMetric = mix(v_measureStart, v_measureEnd, lengthToPointPx / segmentLengthPx);

  if (${this.discardExpression_}) { discard; }

  float capType = ${this.strokeCapExpression_};
  float joinType = ${this.strokeJoinExpression_};
  float segmentStartDistance = computeSegmentPointDistance(currentPointPx, v_segmentStartPx, v_segmentEndPx, v_width, v_angleStart, capType, joinType);
  float segmentEndDistance = computeSegmentPointDistance(currentPointPx, v_segmentEndPx, v_segmentStartPx, v_width, v_angleEnd, capType, joinType);
  float distanceField = max(
    segmentDistanceField(currentPointPx, v_segmentStartPx, v_segmentEndPx, v_width),
    max(segmentStartDistance, segmentEndDistance)
  );
  distanceField = max(distanceField, ${this.strokeDistanceFieldExpression_});

  vec4 color = ${this.strokeColorExpression_};
  color.a *= smoothstep(0.5, -0.5, distanceField);
  gl_FragColor = color;
  gl_FragColor.a *= u_globalAlpha;
  gl_FragColor.rgb *= gl_FragColor.a;
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.1) { discard; };
    gl_FragColor = v_hitColor;
  }
}`:null}getFillVertexShader(){return this.hasFill_?`${Rf}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
attribute vec2 a_position;
attribute vec2 a_hitColor;

varying vec4 v_hitColor;

${this.attributes_.map(e=>`attribute ${e.type} ${e.name};
varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
void main(void) {
  gl_Position = u_projectionMatrix * vec4(a_position, u_depth, 1.0);
  v_hitColor = unpackColor(a_hitColor);
${this.attributes_.map(e=>`  ${e.varyingName} = ${e.varyingExpression};`).join(`
`)}
}`:null}getFillFragmentShader(){return this.hasFill_?`${Rf}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
varying vec4 v_hitColor;
${this.attributes_.map(e=>`varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}
vec2 pxToWorld(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return (u_screenToWorldMatrix * vec4(screenPos, 0.0, 1.0)).xy;
}

vec2 worldToPx(vec2 worldPos) {
  vec4 screenPos = u_projectionMatrix * vec4(worldPos, 0.0, 1.0);
  return (0.5 * screenPos.xy + 0.5) * u_viewportSizePx;
}

void main(void) {
${this.attributes_.map(e=>`  ${e.varyingType} ${e.name} = ${e.varyingName}; // assign to original attribute name`).join(`
`)}
  vec2 pxPos = gl_FragCoord.xy / u_pixelRatio;
  vec2 pxOrigin = worldToPx(u_patternOrigin);
  #ifdef GL_FRAGMENT_PRECISION_HIGH
  vec2 worldPos = pxToWorld(pxPos);
  if (
    abs(u_renderExtent[0] - u_renderExtent[2]) > 0.0 && (
      worldPos[0] < u_renderExtent[0] ||
      worldPos[1] < u_renderExtent[1] ||
      worldPos[0] > u_renderExtent[2] ||
      worldPos[1] > u_renderExtent[3]
    )
  ) {
    discard;
  }
  #endif
  if (${this.discardExpression_}) { discard; }
  gl_FragColor = ${this.fillColorExpression_};
  gl_FragColor.a *= u_globalAlpha;
  gl_FragColor.rgb *= gl_FragColor.a;
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.1) { discard; };
    gl_FragColor = v_hitColor;
  }
}`:null}}class Y_{constructor(){this.globalCounter_=0,this.refToFeature_=new Map,this.uidToRef_=new Map,this.freeGlobalRef_=[],this.polygonBatch={entries:{},geometriesCount:0,verticesCount:0,ringsCount:0},this.pointBatch={entries:{},geometriesCount:0},this.lineStringBatch={entries:{},geometriesCount:0,verticesCount:0}}addFeatures(e,t){for(let r=0;r<e.length;r++)this.addFeature(e[r],t)}addFeature(e,t){let r=e.getGeometry();r&&(t&&(r=r.clone(),r.applyTransform(t)),this.addGeometry_(r,e))}clearFeatureEntryInPointBatch_(e){const t=Bt(e),r=this.pointBatch.entries[t];if(r)return this.pointBatch.geometriesCount-=r.flatCoordss.length,delete this.pointBatch.entries[t],r}clearFeatureEntryInLineStringBatch_(e){const t=Bt(e),r=this.lineStringBatch.entries[t];if(r)return this.lineStringBatch.verticesCount-=r.verticesCount,this.lineStringBatch.geometriesCount-=r.flatCoordss.length,delete this.lineStringBatch.entries[t],r}clearFeatureEntryInPolygonBatch_(e){const t=Bt(e),r=this.polygonBatch.entries[t];if(r)return this.polygonBatch.verticesCount-=r.verticesCount,this.polygonBatch.ringsCount-=r.ringsCount,this.polygonBatch.geometriesCount-=r.flatCoordss.length,delete this.polygonBatch.entries[t],r}addGeometry_(e,t){const r=e.getType();switch(r){case"GeometryCollection":{const i=e.getGeometriesArray();for(const s of i)this.addGeometry_(s,t);break}case"MultiPolygon":{const i=e;this.addCoordinates_(r,i.getFlatCoordinates(),i.getEndss(),t,Bt(t),i.getStride());break}case"MultiLineString":{const i=e;this.addCoordinates_(r,i.getFlatCoordinates(),i.getEnds(),t,Bt(t),i.getStride());break}case"MultiPoint":{const i=e;this.addCoordinates_(r,i.getFlatCoordinates(),null,t,Bt(t),i.getStride());break}case"Polygon":{const i=e;this.addCoordinates_(r,i.getFlatCoordinates(),i.getEnds(),t,Bt(t),i.getStride());break}case"Point":{const i=e;this.addCoordinates_(r,i.getFlatCoordinates(),null,t,Bt(t),i.getStride());break}case"LineString":case"LinearRing":{const i=e,s=i.getStride();this.addCoordinates_(r,i.getFlatCoordinates(),null,t,Bt(t),s,i.getLayout?.());break}}}addCoordinates_(e,t,r,i,s,a,o){let l;switch(e){case"MultiPolygon":{const c=r;for(let h=0,f=c.length;h<f;h++){let m=c[h];const y=h>0?c[h-1]:null,x=y?y[y.length-1]:0,_=m[m.length-1];m=x>0?m.map(w=>w-x):m,this.addCoordinates_("Polygon",t.slice(x,_),m,i,s,a,o)}break}case"MultiLineString":{const c=r;for(let h=0,f=c.length;h<f;h++){const m=h>0?c[h-1]:0;this.addCoordinates_("LineString",t.slice(m,c[h]),null,i,s,a,o)}break}case"MultiPoint":for(let c=0,h=t.length;c<h;c+=a)this.addCoordinates_("Point",t.slice(c,c+2),null,i,s,null,null);break;case"Polygon":{const c=r;if(i instanceof Fs){const m=yF(t,c);if(m.length>1){this.addCoordinates_("MultiPolygon",t,m,i,s,a,o);return}}this.polygonBatch.entries[s]||(this.polygonBatch.entries[s]=this.addRefToEntry_(s,{feature:i,flatCoordss:[],verticesCount:0,ringsCount:0,ringsVerticesCounts:[]})),l=t.length/a;const h=r.length,f=r.map((m,y,x)=>y>0?(m-x[y-1])/a:m/a);this.polygonBatch.verticesCount+=l,this.polygonBatch.ringsCount+=h,this.polygonBatch.geometriesCount++,this.polygonBatch.entries[s].flatCoordss.push(FK(t,a)),this.polygonBatch.entries[s].ringsVerticesCounts.push(f),this.polygonBatch.entries[s].verticesCount+=l,this.polygonBatch.entries[s].ringsCount+=h;for(let m=0,y=c.length;m<y;m++){const x=m>0?c[m-1]:0;this.addCoordinates_("LinearRing",t.slice(x,c[m]),null,i,s,a,o)}break}case"Point":this.pointBatch.entries[s]||(this.pointBatch.entries[s]=this.addRefToEntry_(s,{feature:i,flatCoordss:[]})),this.pointBatch.geometriesCount++,this.pointBatch.entries[s].flatCoordss.push(t);break;case"LineString":case"LinearRing":this.lineStringBatch.entries[s]||(this.lineStringBatch.entries[s]=this.addRefToEntry_(s,{feature:i,flatCoordss:[],verticesCount:0})),l=t.length/a,this.lineStringBatch.verticesCount+=l,this.lineStringBatch.geometriesCount++,this.lineStringBatch.entries[s].flatCoordss.push(jK(t,a,o)),this.lineStringBatch.entries[s].verticesCount+=l;break}}addRefToEntry_(e,t){const r=this.uidToRef_.get(e),i=r||this.freeGlobalRef_.pop()||++this.globalCounter_;return t.ref=i,r||(this.refToFeature_.set(i,t.feature),this.uidToRef_.set(e,i)),t}removeRef_(e,t){if(!e)throw new Error("This feature has no ref: "+t);this.refToFeature_.delete(e),this.uidToRef_.delete(t),this.freeGlobalRef_.push(e)}changeFeature(e,t){if(!this.uidToRef_.get(Bt(e)))return;this.removeFeature(e);let r=e.getGeometry();r&&(t&&(r=r.clone(),r.applyTransform(t)),this.addGeometry_(r,e))}removeFeature(e){let t=this.clearFeatureEntryInPointBatch_(e);t=this.clearFeatureEntryInPolygonBatch_(e)||t,t=this.clearFeatureEntryInLineStringBatch_(e)||t,t&&this.removeRef_(t.ref,Bt(t.feature))}clear(){this.polygonBatch.entries={},this.polygonBatch.geometriesCount=0,this.polygonBatch.verticesCount=0,this.polygonBatch.ringsCount=0,this.lineStringBatch.entries={},this.lineStringBatch.geometriesCount=0,this.lineStringBatch.verticesCount=0,this.pointBatch.entries={},this.pointBatch.geometriesCount=0,this.globalCounter_=0,this.freeGlobalRef_=[],this.refToFeature_.clear(),this.uidToRef_.clear()}getFeatureFromRef(e){return this.refToFeature_.get(e)}isEmpty(){return this.globalCounter_===0}filter(e){const t=new Y_;t.globalCounter_=this.globalCounter_,t.uidToRef_=this.uidToRef_,t.refToFeature_=this.refToFeature_;let r=!0;for(const i of this.refToFeature_.values())e(i)&&(t.addFeature(i),r=!1);return r?new Y_:t}}function FK(n,e){return e===2?n:n.filter((t,r)=>r%e<2)}function jK(n,e,t){return e===3&&t==="XYM"?n:e===4?n.filter((r,i)=>i%e!==2):e===3?n.map((r,i)=>i%e!==2?r:0):new Array(n.length*1.5).fill(0).map((r,i)=>i%3===2?0:n[Math.round(i/1.5)])}function VK(){const n='function t(t,n,x=2){const o=n&&n.length,i=o?n[0]*x:t.length;let f=e(t,0,i,x,!0);const l=[];if(!f||f.next===f.prev)return l;let c,y,h;if(o&&(f=function(t,n,r,x){const o=[];for(let r=0,i=n.length;r<i;r++){const f=e(t,n[r]*x,r<i-1?n[r+1]*x:t.length,x,!1);f===f.next&&(f.steiner=!0),o.push(a(f))}o.sort(u);for(let t=0;t<o.length;t++)r=s(o[t],r);return r}(t,n,f,x)),t.length>80*x){c=t[0],y=t[1];let e=c,n=y;for(let r=x;r<i;r+=x){const x=t[r],o=t[r+1];x<c&&(c=x),o<y&&(y=o),x>e&&(e=x),o>n&&(n=o)}h=Math.max(e-c,n-y),h=0!==h?32767/h:0}return r(f,l,x,c,y,h,0),l}function e(t,e,n,r,x){let o;if(x===function(t,e,n,r){let x=0;for(let o=e,i=n-r;o<n;o+=r)x+=(t[i]-t[o])*(t[o+1]+t[i+1]),i=o;return x}(t,e,n,r)>0)for(let x=e;x<n;x+=r)o=d(x/r|0,t[x],t[x+1],o);else for(let x=n-r;x>=e;x-=r)o=d(x/r|0,t[x],t[x+1],o);return o&&b(o,o.next)&&(w(o),o=o.next),o}function n(t,e){if(!t)return t;e||(e=t);let n,r=t;do{if(n=!1,r.steiner||!b(r,r.next)&&0!==v(r.prev,r,r.next))r=r.next;else{if(w(r),r=e=r.prev,r===r.next)break;n=!0}}while(n||r!==e);return e}function r(t,e,u,s,l,a,y){if(!t)return;!y&&a&&function(t,e,n,r){let x=t;do{0===x.z&&(x.z=c(x.x,x.y,e,n,r)),x.prevZ=x.prev,x.nextZ=x.next,x=x.next}while(x!==t);x.prevZ.nextZ=null,x.prevZ=null,function(t){let e,n=1;do{let r,x=t;t=null;let o=null;for(e=0;x;){e++;let i=x,f=0;for(let t=0;t<n&&(f++,i=i.nextZ,i);t++);let u=n;for(;f>0||u>0&&i;)0!==f&&(0===u||!i||x.z<=i.z)?(r=x,x=x.nextZ,f--):(r=i,i=i.nextZ,u--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;x=i}o.nextZ=null,n*=2}while(e>1)}(x)}(t,s,l,a);let h=t;for(;t.prev!==t.next;){const c=t.prev,p=t.next;if(a?o(t,s,l,a):x(t))e.push(c.i,t.i,p.i),w(t),t=p.next,h=p.next;else if((t=p)===h){y?1===y?r(t=i(n(t),e),e,u,s,l,a,2):2===y&&f(t,e,u,s,l,a):r(n(t),e,u,s,l,a,1);break}}}function x(t){const e=t.prev,n=t,r=t.next;if(v(e,n,r)>=0)return!1;const x=e.x,o=n.x,i=r.x,f=e.y,u=n.y,s=r.y,l=Math.min(x,o,i),c=Math.min(f,u,s),a=Math.max(x,o,i),y=Math.max(f,u,s);let p=r.next;for(;p!==e;){if(p.x>=l&&p.x<=a&&p.y>=c&&p.y<=y&&h(x,f,o,u,i,s,p.x,p.y)&&v(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function o(t,e,n,r){const x=t.prev,o=t,i=t.next;if(v(x,o,i)>=0)return!1;const f=x.x,u=o.x,s=i.x,l=x.y,a=o.y,y=i.y,p=Math.min(f,u,s),b=Math.min(l,a,y),M=Math.max(f,u,s),m=Math.max(l,a,y),A=c(p,b,e,n,r),g=c(M,m,e,n,r);let Z=t.prevZ,d=t.nextZ;for(;Z&&Z.z>=A&&d&&d.z<=g;){if(Z.x>=p&&Z.x<=M&&Z.y>=b&&Z.y<=m&&Z!==x&&Z!==i&&h(f,l,u,a,s,y,Z.x,Z.y)&&v(Z.prev,Z,Z.next)>=0)return!1;if(Z=Z.prevZ,d.x>=p&&d.x<=M&&d.y>=b&&d.y<=m&&d!==x&&d!==i&&h(f,l,u,a,s,y,d.x,d.y)&&v(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;Z&&Z.z>=A;){if(Z.x>=p&&Z.x<=M&&Z.y>=b&&Z.y<=m&&Z!==x&&Z!==i&&h(f,l,u,a,s,y,Z.x,Z.y)&&v(Z.prev,Z,Z.next)>=0)return!1;Z=Z.prevZ}for(;d&&d.z<=g;){if(d.x>=p&&d.x<=M&&d.y>=b&&d.y<=m&&d!==x&&d!==i&&h(f,l,u,a,s,y,d.x,d.y)&&v(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function i(t,e){let r=t;do{const n=r.prev,x=r.next.next;!b(n,x)&&M(n,r,r.next,x)&&g(n,x)&&g(x,n)&&(e.push(n.i,r.i,x.i),w(r),w(r.next),r=t=x),r=r.next}while(r!==t);return n(r)}function f(t,e,x,o,i,f){let u=t;do{let t=u.next.next;for(;t!==u.prev;){if(u.i!==t.i&&p(u,t)){let s=Z(u,t);return u=n(u,u.next),s=n(s,s.next),r(u,e,x,o,i,f,0),void r(s,e,x,o,i,f,0)}t=t.next}u=u.next}while(u!==t)}function u(t,e){let n=t.x-e.x;if(0===n&&(n=t.y-e.y,0===n)){n=(t.next.y-t.y)/(t.next.x-t.x)-(e.next.y-e.y)/(e.next.x-e.x)}return n}function s(t,e){const r=function(t,e){let n=e;const r=t.x,x=t.y;let o,i=-1/0;if(b(t,n))return n;do{if(b(t,n.next))return n.next;if(x<=n.y&&x>=n.next.y&&n.next.y!==n.y){const t=n.x+(x-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(t<=r&&t>i&&(i=t,o=n.x<n.next.x?n:n.next,t===r))return o}n=n.next}while(n!==e);if(!o)return null;const f=o,u=o.x,s=o.y;let c=1/0;n=o;do{if(r>=n.x&&n.x>=u&&r!==n.x&&y(x<s?r:i,x,u,s,x<s?i:r,x,n.x,n.y)){const e=Math.abs(x-n.y)/(r-n.x);g(n,t)&&(e<c||e===c&&(n.x>o.x||n.x===o.x&&l(o,n)))&&(o=n,c=e)}n=n.next}while(n!==f);return o}(t,e);if(!r)return e;const x=Z(r,t);return n(x,x.next),n(r,r.next)}function l(t,e){return v(t.prev,t,e.prev)<0&&v(e.next,t,t.next)<0}function c(t,e,n,r,x){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*x|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*x|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function a(t){let e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function y(t,e,n,r,x,o,i,f){return(x-i)*(e-f)>=(t-i)*(o-f)&&(t-i)*(r-f)>=(n-i)*(e-f)&&(n-i)*(o-f)>=(x-i)*(r-f)}function h(t,e,n,r,x,o,i,f){return!(t===i&&e===f)&&y(t,e,n,r,x,o,i,f)}function p(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&M(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(g(t,e)&&g(e,t)&&function(t,e){let n=t,r=!1;const x=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&x<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(v(t.prev,t,e.prev)||v(t,e.prev,e))||b(t,e)&&v(t.prev,t,t.next)>0&&v(e.prev,e,e.next)>0)}function v(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function b(t,e){return t.x===e.x&&t.y===e.y}function M(t,e,n,r){const x=A(v(t,e,n)),o=A(v(t,e,r)),i=A(v(n,r,t)),f=A(v(n,r,e));return x!==o&&i!==f||(!(0!==x||!m(t,n,e))||(!(0!==o||!m(t,r,e))||(!(0!==i||!m(n,t,r))||!(0!==f||!m(n,e,r)))))}function m(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function A(t){return t>0?1:t<0?-1:0}function g(t,e){return v(t.prev,t,t.next)<0?v(t,e,t.next)>=0&&v(t,t.prev,e)>=0:v(t,e,t.prev)<0||v(t,t.next,e)<0}function Z(t,e){const n=F(t.i,t.x,t.y),r=F(e.i,e.x,e.y),x=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=x,x.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function d(t,e,n,r){const x=F(t,e,n);return r?(x.next=r.next,x.prev=r,r.next.prev=x,r.next=x):(x.prev=x,x.next=x),x}function w(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function F(t,e,n){return{i:t,x:e,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function E(t,e){const n=e[0],r=e[1];return e[0]=t[0]*n+t[2]*r+t[4],e[1]=t[1]*n+t[3]*r+t[5],e}function I(t,e){const n=(r=e)[0]*r[3]-r[1]*r[2];var r;!function(t,e){if(!t)throw new Error(e)}(0!==n,"Transformation matrix cannot be inverted");const x=e[0],o=e[1],i=e[2],f=e[3],u=e[4],s=e[5];return t[0]=f/n,t[1]=-o/n,t[2]=-i/n,t[3]=x/n,t[4]=(i*s-f*u)/n,t[5]=-(x*s-o*u)/n,t}new Array(6);const z=[],B={vertexAttributesPosition:0,instanceAttributesPosition:0,indicesPosition:0};function P(t,e,n,r,x){const o=t[e++],i=t[e++],f=z;f.length=r;for(let n=0;n<f.length;n++)f[n]=t[e+n];let u=x?x.instanceAttributesPosition:0;return n[u++]=o,n[u++]=i,f.length&&(n.set(f,u),u+=f.length),B.instanceAttributesPosition=u,B}function N(t,e,n,r,x,o,i,f,u,s){const l=[t[e],t[e+1]],c=[t[n],t[n+1]],a=t[e+2],y=t[n+2],h=E(f,[...l]),p=E(f,[...c]);function v(t,e,n){const r=Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1])),x=[(e[0]-t[0])/r,(e[1]-t[1])/r],o=[-x[1],x[0]],i=Math.sqrt((n[0]-t[0])*(n[0]-t[0])+(n[1]-t[1])*(n[1]-t[1])),f=[(n[0]-t[0])/i,(n[1]-t[1])/i];let u=0===r||0===i?0:Math.acos((s=f[0]*x[0]+f[1]*x[1],l=-1,c=1,Math.min(Math.max(s,l),c)));var s,l,c;u=Math.max(u,1e-5);return f[0]*o[0]+f[1]*o[1]>0?u:2*Math.PI-u}let b=-1,M=-1,m=s;const A=null!==x;if(null!==r){b=v(h,p,E(f,[...[t[r],t[r+1]]])),Math.cos(b)<=.985&&(m+=Math.tan((b-Math.PI)/2))}if(A){M=v(p,h,E(f,[...[t[x],t[x+1]]])),Math.cos(M)<=.985&&(m+=Math.tan((Math.PI-M)/2))}const g=Math.pow(2,24),Z=u%g,d=Math.floor(u/g)*g;return o.push(l[0],l[1],a,c[0],c[1],y,b,M,Z,d,s),o.push(...i),{length:u+Math.sqrt((p[0]-h[0])*(p[0]-h[0])+(p[1]-h[1])*(p[1]-h[1])),angle:m}}function R(e,n,r,x,o){const i=2+o;let f=n;const u=e.slice(f,f+o);f+=o;const s=e[f++];let l=0;const c=new Array(s-1);for(let t=0;t<s;t++)l+=e[f++],t<s-1&&(c[t]=l);const a=e.slice(f,f+2*l),y=t(a,c,2);for(let t=0;t<y.length;t++)x.push(y[t]+r.length/i);for(let t=0;t<a.length;t+=2)r.push(a[t],a[t+1],...u);return f+2*l}const S="GENERATE_POLYGON_BUFFERS",T="GENERATE_POINT_BUFFERS",_="GENERATE_LINE_STRING_BUFFERS",O=self;O.onmessage=t=>{const e=t.data;switch(e.type){case T:{const t=2,n=2,r=e.customAttributesSize,x=n+r,o=new Float32Array(e.renderInstructions),i=o.length/x*(t+r),f=Uint32Array.from([0,1,3,1,2,3]),u=Float32Array.from([-1,-1,1,-1,1,1,-1,1]),s=new Float32Array(i);let l;for(let t=0;t<o.length;t+=x)l=P(o,t,s,r,l);const c=Object.assign({indicesBuffer:f.buffer,vertexAttributesBuffer:u.buffer,instanceAttributesBuffer:s.buffer,renderInstructions:o.buffer},e);O.postMessage(c,[u.buffer,s.buffer,f.buffer,o.buffer]);break}case _:{const t=[],n=e.customAttributesSize,r=3,x=new Float32Array(e.renderInstructions);let o=0;const i=[1,0,0,1,0,0];let f,u;for(I(i,e.renderInstructionsTransform);o<x.length;){u=Array.from(x.slice(o,o+n)),o+=n,f=x[o++];const e=o,s=o+(f-1)*r,l=x[e]===x[s]&&x[e+1]===x[s+1];let c=0,a=0;for(let n=0;n<f-1;n++){let y=null;n>0?y=o+(n-1)*r:l&&(y=s-r);let h=null;n<f-2?h=o+(n+2)*r:l&&(h=e+r);const p=N(x,o+n*r,o+(n+1)*r,y,h,t,u,i,c,a);c=p.length,a=p.angle}o+=f*r}const s=Uint32Array.from([0,1,3,1,2,3]),l=Float32Array.from([-1,-1,1,-1,1,1,-1,1]),c=Float32Array.from(t),a=Object.assign({indicesBuffer:s.buffer,vertexAttributesBuffer:l.buffer,instanceAttributesBuffer:c.buffer,renderInstructions:x.buffer},e);O.postMessage(a,[l.buffer,c.buffer,s.buffer,x.buffer]);break}case S:{const t=[],n=[],r=e.customAttributesSize,x=new Float32Array(e.renderInstructions);let o=0;for(;o<x.length;)o=R(x,o,t,n,r);const i=Uint32Array.from(n),f=Float32Array.from(t),u=Float32Array.from([]),s=Object.assign({indicesBuffer:i.buffer,vertexAttributesBuffer:f.buffer,instanceAttributesBuffer:u.buffer,renderInstructions:x.buffer},e);O.postMessage(s,[f.buffer,u.buffer,i.buffer,x.buffer]);break}}};';return new Worker(typeof Blob>"u"?"data:application/javascript;base64,"+Buffer.from(n,"binary").toString("base64"):URL.createObjectURL(new Blob([n],{type:"application/javascript"})))}const $T={GENERATE_POLYGON_BUFFERS:"GENERATE_POLYGON_BUFFERS",GENERATE_POINT_BUFFERS:"GENERATE_POINT_BUFFERS",GENERATE_LINE_STRING_BUFFERS:"GENERATE_LINE_STRING_BUFFERS"};function GK(n,e){e=e||[];const t=256,r=t-1,i=Math.floor(n/t/t/t)/r,s=Math.floor(n/t/t)%t/r,a=Math.floor(n/t)%t/r,o=n%t/r;return e[0]=i*256*255+s*255,e[1]=a*256*255+o*255,e}function BK(n){let e=0;const t=256,r=t-1;return e+=Math.round(n[0]*t*t*t*r),e+=Math.round(n[1]*t*t*r),e+=Math.round(n[2]*t*r),e+=Math.round(n[3]*r),e}function $A(n,e,t,r){let i=0;for(const s in e){const a=e[s],o=a.callback.call(t,t.feature);let l=o?.[0]??o;l===Eb&&console.warn('The "has" operator might return false positives.'),l===void 0?l=Eb:l===null&&(l=0),n[r+i++]=l,!(!a.size||a.size===1)&&(n[r+i++]=o[1],!(a.size<3)&&(n[r+i++]=o[2],!(a.size<4)&&(n[r+i++]=o[3])))}return i}function Gw(n){return Object.keys(n).reduce((e,t)=>e+(n[t].size||1),0)}function zK(n,e,t,r){const i=(2+Gw(t))*n.geometriesCount;(!e||e.length!==i)&&(e=new Float32Array(i));const s=[];let a=0;for(const o in n.entries){const l=n.entries[o];for(let c=0,h=l.flatCoordss.length;c<h;c++)s[0]=l.flatCoordss[c][0],s[1]=l.flatCoordss[c][1],kr(r,s),e[a++]=s[0],e[a++]=s[1],a+=$A(e,t,l,a)}return e}function UK(n,e,t,r){const i=3*n.verticesCount+(1+Gw(t))*n.geometriesCount;(!e||e.length!==i)&&(e=new Float32Array(i));const s=[];let a=0;for(const o in n.entries){const l=n.entries[o];for(let c=0,h=l.flatCoordss.length;c<h;c++){s.length=l.flatCoordss[c].length,tl(l.flatCoordss[c],0,s.length,3,r,s,3),a+=$A(e,t,l,a),e[a++]=s.length/3;for(let f=0,m=s.length;f<m;f+=3)e[a++]=s[f],e[a++]=s[f+1],e[a++]=s[f+2]}}return e}function $K(n,e,t,r){const i=2*n.verticesCount+(1+Gw(t))*n.geometriesCount+n.ringsCount;(!e||e.length!==i)&&(e=new Float32Array(i));const s=[];let a=0;for(const o in n.entries){const l=n.entries[o];for(let c=0,h=l.flatCoordss.length;c<h;c++){s.length=l.flatCoordss[c].length,tl(l.flatCoordss[c],0,s.length,2,r,s),a+=$A(e,t,l,a),e[a++]=l.ringsVerticesCounts[c].length;for(let f=0,m=l.ringsVerticesCounts[c].length;f<m;f++)e[a++]=l.ringsVerticesCounts[c][f];for(let f=0,m=s.length;f<m;f+=2)e[a++]=s[f],e[a++]=s[f+1]}}return e}function Z_(n){return(JSON.stringify(n).split("").reduce((t,r)=>(t<<5)-t+r.charCodeAt(0),0)>>>0).toString()}function WA(n,e,t,r){if(`${r}radius`in n&&r!=="icon-"){let i=Zt(t,n[`${r}radius`],It);if(`${r}radius2`in n){const s=Zt(t,n[`${r}radius2`],It);i=`max(${i}, ${s})`}`${r}stroke-width`in n&&(i=`(${i} + ${Zt(t,n[`${r}stroke-width`],It)} * 0.5)`),e.setSymbolSizeExpression(`vec2(${i} * 2. + 0.5)`)}if(`${r}scale`in n){const i=Zt(t,n[`${r}scale`],Fa);e.setSymbolSizeExpression(`${e.getSymbolSizeExpression()} * ${i}`)}`${r}displacement`in n&&e.setSymbolOffsetExpression(Zt(t,n[`${r}displacement`],Ws)),`${r}rotation`in n&&e.setSymbolRotationExpression(Zt(t,n[`${r}rotation`],It)),`${r}rotate-with-view`in n&&e.setSymbolRotateWithView(!!n[`${r}rotate-with-view`])}function ZF(n,e,t,r,i){let s="vec4(0.)";if(e!==null&&(s=e),t!==null&&r!==null){const l=`smoothstep(-${r} + 0.63, -${r} - 0.58, ${n})`;s=`mix(${t}, ${s}, ${l})`}const a=`(1.0 - smoothstep(-0.63, 0.58, ${n}))`;let o=`${s} * vec4(1.0, 1.0, 1.0, ${a})`;return i!==null&&(o=`${o} * vec4(1.0, 1.0, 1.0, ${i})`),o}function HA(n,e,t,r,i){const s=new Image;s.crossOrigin=n[`${r}cross-origin`]===void 0?"anonymous":n[`${r}cross-origin`],bn(typeof n[`${r}src`]=="string",`WebGL layers do not support expressions for the ${r}src style property`),s.src=n[`${r}src`],t[`u_texture${i}_size`]=()=>s.complete?[s.width,s.height]:[0,0],e.addUniform(`u_texture${i}_size`,"vec2");const a=`u_texture${i}_size`;return t[`u_texture${i}`]=s,e.addUniform(`u_texture${i}`,"sampler2D"),a}function KA(n,e,t,r,i){let s=Zt(t,n[`${e}offset`],Fa);if(`${e}offset-origin`in n)switch(n[`${e}offset-origin`]){case"top-right":s=`vec2(${r}.x, 0.) + ${i} * vec2(-1., 0.) + ${s} * vec2(-1., 1.)`;break;case"bottom-left":s=`vec2(0., ${r}.y) + ${i} * vec2(0., -1.) + ${s} * vec2(1., -1.)`;break;case"bottom-right":s=`${r} - ${i} - ${s}`;break}return s}function WK(n,e,t,r){r.functions.circleDistanceField=`float circleDistanceField(vec2 point, float radius) {
  return length(point) - radius;
}`,WA(n,e,r,"circle-");let i=null;"circle-opacity"in n&&(i=Zt(r,n["circle-opacity"],It));let s="coordsPx";"circle-scale"in n&&(s=`coordsPx / ${Zt(r,n["circle-scale"],Fa)}`);let a=null;"circle-fill-color"in n&&(a=Zt(r,n["circle-fill-color"],vr));let o=null;"circle-stroke-color"in n&&(o=Zt(r,n["circle-stroke-color"],vr));let l=Zt(r,n["circle-radius"],It),c=null;"circle-stroke-width"in n&&(c=Zt(r,n["circle-stroke-width"],It),l=`(${l} + ${c} * 0.5)`);const h=`circleDistanceField(${s}, ${l})`,f=ZF(h,a,o,c,i);e.setSymbolColorExpression(f)}function HK(n,e,t,r){r.functions.round=`float round(float v) {
  return sign(v) * floor(abs(v) + 0.5);
}`,r.functions.starDistanceField=`float starDistanceField(vec2 point, float numPoints, float radius, float radius2, float angle) {
  float startAngle = -PI * 0.5 + angle; // tip starts upwards and rotates clockwise with angle
  float c = cos(startAngle);
  float s = sin(startAngle);
  vec2 pointRotated = vec2(c * point.x - s * point.y, s * point.x + c * point.y);
  float alpha = TWO_PI / numPoints; // the angle of one sector
  float beta = atan(pointRotated.y, pointRotated.x);
  float gamma = round(beta / alpha) * alpha; // angle in sector
  c = cos(-gamma);
  s = sin(-gamma);
  vec2 inSector = vec2(c * pointRotated.x - s * pointRotated.y, abs(s * pointRotated.x + c * pointRotated.y));
  vec2 tipToPoint = inSector + vec2(-radius, 0.);
  vec2 edgeNormal = vec2(radius2 * sin(alpha * 0.5), -radius2 * cos(alpha * 0.5) + radius);
  return dot(normalize(edgeNormal), tipToPoint);
}`,r.functions.regularDistanceField=`float regularDistanceField(vec2 point, float numPoints, float radius, float angle) {
  float startAngle = -PI * 0.5 + angle; // tip starts upwards and rotates clockwise with angle
  float c = cos(startAngle);
  float s = sin(startAngle);
  vec2 pointRotated = vec2(c * point.x - s * point.y, s * point.x + c * point.y);
  float alpha = TWO_PI / numPoints; // the angle of one sector
  float radiusIn = radius * cos(PI / numPoints);
  float beta = atan(pointRotated.y, pointRotated.x);
  float gamma = round((beta - alpha * 0.5) / alpha) * alpha + alpha * 0.5; // angle in sector from mid
  c = cos(-gamma);
  s = sin(-gamma);
  vec2 inSector = vec2(c * pointRotated.x - s * pointRotated.y, abs(s * pointRotated.x + c * pointRotated.y));
  return inSector.x - radiusIn;
}`,WA(n,e,r,"shape-");let i=null;"shape-opacity"in n&&(i=Zt(r,n["shape-opacity"],It));let s="coordsPx";"shape-scale"in n&&(s=`coordsPx / ${Zt(r,n["shape-scale"],Fa)}`);let a=null;"shape-fill-color"in n&&(a=Zt(r,n["shape-fill-color"],vr));let o=null;"shape-stroke-color"in n&&(o=Zt(r,n["shape-stroke-color"],vr));let l=null;"shape-stroke-width"in n&&(l=Zt(r,n["shape-stroke-width"],It));const c=Zt(r,n["shape-points"],It);let h="0.";"shape-angle"in n&&(h=Zt(r,n["shape-angle"],It));let f,m=Zt(r,n["shape-radius"],It);if(l!==null&&(m=`${m} + ${l} * 0.5`),"shape-radius2"in n){let x=Zt(r,n["shape-radius2"],It);l!==null&&(x=`${x} + ${l} * 0.5`),f=`starDistanceField(${s}, ${c}, ${m}, ${x}, ${h})`}else f=`regularDistanceField(${s}, ${c}, ${m}, ${h})`;const y=ZF(f,a,o,l,i);e.setSymbolColorExpression(y)}function KK(n,e,t,r){let i="vec4(1.0)";"icon-color"in n&&(i=Zt(r,n["icon-color"],vr)),"icon-opacity"in n&&(i=`${i} * vec4(1.0, 1.0, 1.0, ${Zt(r,n["icon-opacity"],It)})`);const s=Z_(n["icon-src"]),a=HA(n,e,t,"icon-",s);if(e.setSymbolColorExpression(`${i} * texture2D(u_texture${s}, v_texCoord)`).setSymbolSizeExpression(a),"icon-width"in n&&"icon-height"in n&&e.setSymbolSizeExpression(`vec2(${Zt(r,n["icon-width"],It)}, ${Zt(r,n["icon-height"],It)})`),"icon-offset"in n&&"icon-size"in n){const o=Zt(r,n["icon-size"],Ws),l=e.getSymbolSizeExpression();e.setSymbolSizeExpression(o);const c=KA(n,"icon-",r,"v_quadSizePx",o);e.setTextureCoordinateExpression(`(vec4((${c}).xyxy) + vec4(0., 0., ${o})) / (${l}).xyxy`)}if(WA(n,e,r,"icon-"),"icon-anchor"in n){const o=Zt(r,n["icon-anchor"],Ws);let l="1.0";"icon-scale"in n&&(l=Zt(r,n["icon-scale"],Fa));let c;n["icon-anchor-x-units"]==="pixels"&&n["icon-anchor-y-units"]==="pixels"?c=`${o} * ${l}`:n["icon-anchor-x-units"]==="pixels"?c=`${o} * vec2(vec2(${l}).x, v_quadSizePx.y)`:n["icon-anchor-y-units"]==="pixels"?c=`${o} * vec2(v_quadSizePx.x, vec2(${l}).x)`:c=`${o} * v_quadSizePx`;let h=`v_quadSizePx * vec2(0.5, -0.5) + ${c} * vec2(-1., 1.)`;if("icon-anchor-origin"in n)switch(n["icon-anchor-origin"]){case"top-right":h=`v_quadSizePx * -0.5 + ${c}`;break;case"bottom-left":h=`v_quadSizePx * 0.5 - ${c}`;break;case"bottom-right":h=`v_quadSizePx * vec2(-0.5, 0.5) + ${c} * vec2(1., -1.)`;break}e.setSymbolOffsetExpression(`${e.getSymbolOffsetExpression()} + ${h}`)}}function XK(n,e,t,r){if("stroke-color"in n&&e.setStrokeColorExpression(Zt(r,n["stroke-color"],vr)),"stroke-pattern-src"in n){const i=Z_(n["stroke-pattern-src"]),s=HA(n,e,t,"stroke-pattern-",i);let a=s,o="vec2(0.)";"stroke-pattern-offset"in n&&"stroke-pattern-size"in n&&(a=Zt(r,n["stroke-pattern-size"],Ws),o=KA(n,"stroke-pattern-",r,s,a));let l="0.";"stroke-pattern-spacing"in n&&(l=Zt(r,n["stroke-pattern-spacing"],It));let c="0.";"stroke-pattern-start-offset"in n&&(c=Zt(r,n["stroke-pattern-start-offset"],It)),r.functions.sampleStrokePattern=`vec4 sampleStrokePattern(sampler2D texture, vec2 textureSize, vec2 textureOffset, vec2 sampleSize, float spacingPx, float startOffsetPx, float currentLengthPx, float currentRadiusRatio, float lineWidth) {
  float currentLengthScaled = (currentLengthPx - startOffsetPx) * sampleSize.y / lineWidth;
  float spacingScaled = spacingPx * sampleSize.y / lineWidth;
  float uCoordPx = mod(currentLengthScaled, (sampleSize.x + spacingScaled));
  float isInsideOfPattern = step(uCoordPx, sampleSize.x);
  float vCoordPx = (-currentRadiusRatio * 0.5 + 0.5) * sampleSize.y;
  // make sure that we're not sampling too close to the borders to avoid interpolation with outside pixels
  uCoordPx = clamp(uCoordPx, 0.5, sampleSize.x - 0.5);
  vCoordPx = clamp(vCoordPx, 0.5, sampleSize.y - 0.5);
  vec2 texCoord = (vec2(uCoordPx, vCoordPx) + textureOffset) / textureSize;
  return texture2D(texture, texCoord) * vec4(1.0, 1.0, 1.0, isInsideOfPattern);
}`;const h=`u_texture${i}`;let f="1.";"stroke-color"in n&&(f=e.getStrokeColorExpression()),e.setStrokeColorExpression(`${f} * sampleStrokePattern(${h}, ${s}, ${o}, ${a}, ${l}, ${c}, currentLengthPx, currentRadiusRatio, v_width)`),r.functions.computeStrokePatternLength=`float computeStrokePatternLength(vec2 sampleSize, float spacingPx, float lineWidth) {
  float patternLengthPx = sampleSize.x / sampleSize.y * lineWidth;
  return patternLengthPx + spacingPx;
}`,e.setStrokePatternLengthExpression(`computeStrokePatternLength(${a}, ${l}, v_width)`)}if("stroke-width"in n&&e.setStrokeWidthExpression(Zt(r,n["stroke-width"],It)),"stroke-offset"in n&&e.setStrokeOffsetExpression(Zt(r,n["stroke-offset"],It)),"stroke-line-cap"in n&&e.setStrokeCapExpression(Zt(r,n["stroke-line-cap"],fi)),"stroke-line-join"in n&&e.setStrokeJoinExpression(Zt(r,n["stroke-line-join"],fi)),"stroke-miter-limit"in n&&e.setStrokeMiterLimitExpression(Zt(r,n["stroke-miter-limit"],It)),"stroke-line-dash"in n){r.functions.getSingleDashDistance=`float getSingleDashDistance(float distance, float radius, float dashOffset, float dashLength, float dashLengthTotal, float capType, float lineWidth) {
  float localDistance = mod(distance, dashLengthTotal);
  float distanceSegment = abs(localDistance - dashOffset - dashLength * 0.5) - dashLength * 0.5;
  distanceSegment = min(distanceSegment, dashLengthTotal - localDistance);
  if (capType == ${zl("square")}) {
    distanceSegment -= lineWidth * 0.5;
  } else if (capType == ${zl("round")}) {
    distanceSegment = min(distanceSegment, sqrt(distanceSegment * distanceSegment + radius * radius) - lineWidth * 0.5);
  }
  return distanceSegment;
}`;let i=n["stroke-line-dash"].map(x=>Zt(r,x,It));i.length%2===1&&(i=[...i,...i]);let s="0.";"stroke-line-dash-offset"in n&&(s=Zt(r,n["stroke-line-dash-offset"],It));const o=`dashDistanceField_${Z_(n["stroke-line-dash"])}`,l=i.map((x,_)=>`float dashLength${_}`).join(", "),c=i.map((x,_)=>`dashLength${_}`).join(" + ");let h="0.",f=`getSingleDashDistance(distance, radius, ${h}, dashLength0, totalDashLength, capType, lineWidth)`;for(let x=2;x<i.length;x+=2)h=`${h} + dashLength${x-2} + dashLength${x-1}`,f=`min(${f}, getSingleDashDistance(distance, radius, ${h}, dashLength${x}, totalDashLength, capType, lineWidth))`;r.functions[o]=`float ${o}(float distance, float radius, float capType, float lineWidth, ${l}) {
  float totalDashLength = ${c};
  return ${f};
}`;const m=i.map((x,_)=>`${x}`).join(", ");e.setStrokeDistanceFieldExpression(`${o}(currentLengthPx + ${s}, currentRadiusPx, capType, v_width, ${m})`);let y=i.join(" + ");e.getStrokePatternLengthExpression()&&(r.functions.combinePatternLengths=`float combinePatternLengths(float patternLength1, float patternLength2) {
  return patternLength1 * patternLength2;
}`,y=`combinePatternLengths(${e.getStrokePatternLengthExpression()}, ${y})`),e.setStrokePatternLengthExpression(y)}}function qK(n,e,t,r){if("fill-color"in n&&e.setFillColorExpression(Zt(r,n["fill-color"],vr)),"fill-pattern-src"in n){const i=Z_(n["fill-pattern-src"]),s=HA(n,e,t,"fill-pattern-",i);let a=s,o="vec2(0.)";"fill-pattern-offset"in n&&"fill-pattern-size"in n&&(a=Zt(r,n["fill-pattern-size"],Ws),o=KA(n,"fill-pattern-",r,s,a)),r.functions.sampleFillPattern=`vec4 sampleFillPattern(sampler2D texture, vec2 textureSize, vec2 textureOffset, vec2 sampleSize, vec2 pxOrigin, vec2 pxPosition) {
  float scaleRatio = pow(2., mod(u_zoom + 0.5, 1.) - 0.5);
  vec2 pxRelativePos = pxPosition - pxOrigin;
  // rotate the relative position from origin by the current view rotation
  pxRelativePos = vec2(pxRelativePos.x * cos(u_rotation) - pxRelativePos.y * sin(u_rotation), pxRelativePos.x * sin(u_rotation) + pxRelativePos.y * cos(u_rotation));
  // sample position is computed according to the sample offset & size
  vec2 samplePos = mod(pxRelativePos / scaleRatio, sampleSize);
  // also make sure that we're not sampling too close to the borders to avoid interpolation with outside pixels
  samplePos = clamp(samplePos, vec2(0.5), sampleSize - vec2(0.5));
  samplePos.y = sampleSize.y - samplePos.y; // invert y axis so that images appear upright
  return texture2D(texture, (samplePos + textureOffset) / textureSize);
}`;const l=`u_texture${i}`;let c="1.";"fill-color"in n&&(c=e.getFillColorExpression()),e.setFillColorExpression(`${c} * sampleFillPattern(${l}, ${s}, ${o}, ${a}, pxOrigin, pxPos)`)}}function oN(n,e,t){const r=$F(),i=new YF,s={};if("icon-src"in n?KK(n,i,s,r):"shape-points"in n?HK(n,i,s,r):"circle-radius"in n&&WK(n,i,s,r),XK(n,i,s,r),qK(n,i,s,r),t){const l=Zt(r,t,Qr);i.setFragmentDiscardExpression(`!${l}`)}const a={};function o(l,c,h,f){if(!r[l])return;const m=Tb(h),y=UA(h);i.addAttribute(`a_${c}`,m),a[c]={size:y,callback:f}}return o("geometryType",HF,fi,l=>Mp(CA(l.getGeometry()))),o("featureId",WF,fi|It,l=>{const c=l.getId()??null;return typeof c=="string"?Mp(c):c}),KF(i,r),{builder:i,attributes:{...a,...qF(r)},uniforms:{...s,...XF(r,e)}}}const YK=[];let WT;function ZK(){return WT||(WT=VK()),WT}let JK=0;const Aa={POSITION:"a_position",LOCAL_POSITION:"a_localPosition",SEGMENT_START:"a_segmentStart",SEGMENT_END:"a_segmentEnd",MEASURE_START:"a_measureStart",MEASURE_END:"a_measureEnd",ANGLE_TANGENT_SUM:"a_angleTangentSum",JOIN_ANGLES:"a_joinAngles",DISTANCE_LOW:"a_distanceLow",DISTANCE_HIGH:"a_distanceHigh"};class QK{constructor(e,t,r,i){this.helper_,this.hitDetectionEnabled_=!!i,this.styleShaders=eX(e,t),this.customAttributes_={},this.uniforms_={},this.hitDetectionEnabled_&&(this.customAttributes_.hitColor={callback(){return GK(this.ref,YK)},size:2});for(const s of this.styleShaders){for(const a in s.attributes)a in this.customAttributes_||(this.customAttributes_[a]=s.attributes[a]);for(const a in s.uniforms)a in this.uniforms_||(this.uniforms_[a]=s.uniforms[a])}this.renderPasses_=this.styleShaders.map(s=>{const a={},o=Object.entries(this.customAttributes_).map(([l,c])=>({name:l in s.attributes||l==="hitColor"?`a_${l}`:null,size:c.size||1,type:wi.FLOAT}));return s.builder.getFillVertexShader()&&(a.fillRenderPass={vertexShader:s.builder.getFillVertexShader(),fragmentShader:s.builder.getFillFragmentShader(),attributesDesc:[{name:Aa.POSITION,size:2,type:wi.FLOAT},...o],instancedAttributesDesc:[],instancePrimitiveVertexCount:3}),s.builder.getStrokeVertexShader()&&(a.strokeRenderPass={vertexShader:s.builder.getStrokeVertexShader(),fragmentShader:s.builder.getStrokeFragmentShader(),attributesDesc:[{name:Aa.LOCAL_POSITION,size:2,type:wi.FLOAT}],instancedAttributesDesc:[{name:Aa.SEGMENT_START,size:2,type:wi.FLOAT},{name:Aa.MEASURE_START,size:1,type:wi.FLOAT},{name:Aa.SEGMENT_END,size:2,type:wi.FLOAT},{name:Aa.MEASURE_END,size:1,type:wi.FLOAT},{name:Aa.JOIN_ANGLES,size:2,type:wi.FLOAT},{name:Aa.DISTANCE_LOW,size:1,type:wi.FLOAT},{name:Aa.DISTANCE_HIGH,size:1,type:wi.FLOAT},{name:Aa.ANGLE_TANGENT_SUM,size:1,type:wi.FLOAT},...o],instancePrimitiveVertexCount:6}),s.builder.getSymbolVertexShader()&&(a.symbolRenderPass={vertexShader:s.builder.getSymbolVertexShader(),fragmentShader:s.builder.getSymbolFragmentShader(),attributesDesc:[{name:Aa.LOCAL_POSITION,size:2,type:wi.FLOAT}],instancedAttributesDesc:[{name:Aa.POSITION,size:2,type:wi.FLOAT},...o],instancePrimitiveVertexCount:6}),a}),this.hasFill_=this.renderPasses_.some(s=>s.fillRenderPass),this.hasStroke_=this.renderPasses_.some(s=>s.strokeRenderPass),this.hasSymbol_=this.renderPasses_.some(s=>s.symbolRenderPass),this.setHelper(r)}async generateBuffers(e,t){if(e.isEmpty())return null;const r=this.generateRenderInstructions_(e,t),[i,s,a]=await Promise.all([this.generateBuffersForType_(r.polygonInstructions,"Polygon",t),this.generateBuffersForType_(r.lineStringInstructions,"LineString",t),this.generateBuffersForType_(r.pointInstructions,"Point",t)]),o=wp(ti(),t);return{polygonBuffers:i,lineStringBuffers:s,pointBuffers:a,invertVerticesTransform:o}}generateRenderInstructions_(e,t){const r=this.hasFill_?$K(e.polygonBatch,new Float32Array(0),this.customAttributes_,t):null,i=this.hasStroke_?UK(e.lineStringBatch,new Float32Array(0),this.customAttributes_,t):null,s=this.hasSymbol_?zK(e.pointBatch,new Float32Array(0),this.customAttributes_,t):null;return{polygonInstructions:r,lineStringInstructions:i,pointInstructions:s}}generateBuffersForType_(e,t,r){if(e===null)return null;const i=JK++;let s;switch(t){case"Polygon":s=$T.GENERATE_POLYGON_BUFFERS;break;case"LineString":s=$T.GENERATE_LINE_STRING_BUFFERS;break;case"Point":s=$T.GENERATE_POINT_BUFFERS;break}const a={id:i,type:s,renderInstructions:e.buffer,renderInstructionsTransform:r,customAttributesSize:Gw(this.customAttributes_)},o=ZK();return o.postMessage(a,[e.buffer]),e=null,new Promise(l=>{const c=h=>{const f=h.data;if(f.id!==i||(o.removeEventListener("message",c),!this.helper_.getGL()))return;const m=new Bm(Dw,jT).fromArrayBuffer(f.indicesBuffer),y=new Bm(kp,jT).fromArrayBuffer(f.vertexAttributesBuffer),x=new Bm(kp,jT).fromArrayBuffer(f.instanceAttributesBuffer);this.helper_.flushBufferData(m),this.helper_.flushBufferData(y),this.helper_.flushBufferData(x),l([m,y,x])};o.addEventListener("message",c)})}render(e,t,r){for(const i of this.renderPasses_)i.fillRenderPass&&this.renderInternal_(e.polygonBuffers[0],e.polygonBuffers[1],e.polygonBuffers[2],i.fillRenderPass,t,r),i.strokeRenderPass&&this.renderInternal_(e.lineStringBuffers[0],e.lineStringBuffers[1],e.lineStringBuffers[2],i.strokeRenderPass,t,r),i.symbolRenderPass&&this.renderInternal_(e.pointBuffers[0],e.pointBuffers[1],e.pointBuffers[2],i.symbolRenderPass,t,r)}renderInternal_(e,t,r,i,s,a){const o=e.getSize();if(o===0)return;const l=i.instancedAttributesDesc.length;if(this.helper_.useProgram(i.program,s),this.helper_.bindBuffer(t),this.helper_.bindBuffer(e),this.helper_.enableAttributes(i.attributesDesc),this.helper_.bindBuffer(r),this.helper_.enableAttributesInstanced(i.instancedAttributesDesc),a(),l){const c=i.instancedAttributesDesc.reduce((f,m)=>f+(m.size||1),0),h=r.getSize()/c;this.helper_.drawElementsInstanced(0,o,h)}else this.helper_.drawElements(0,o)}setHelper(e,t=null){this.helper_=e;for(const r of this.renderPasses_)r.fillRenderPass&&(r.fillRenderPass.program=this.helper_.getProgram(r.fillRenderPass.fragmentShader,r.fillRenderPass.vertexShader)),r.strokeRenderPass&&(r.strokeRenderPass.program=this.helper_.getProgram(r.strokeRenderPass.fragmentShader,r.strokeRenderPass.vertexShader)),r.symbolRenderPass&&(r.symbolRenderPass.program=this.helper_.getProgram(r.symbolRenderPass.fragmentShader,r.symbolRenderPass.vertexShader));this.helper_.addUniforms(this.uniforms_),t&&(t.polygonBuffers&&(this.helper_.flushBufferData(t.polygonBuffers[0]),this.helper_.flushBufferData(t.polygonBuffers[1]),this.helper_.flushBufferData(t.polygonBuffers[2])),t.lineStringBuffers&&(this.helper_.flushBufferData(t.lineStringBuffers[0]),this.helper_.flushBufferData(t.lineStringBuffers[1]),this.helper_.flushBufferData(t.lineStringBuffers[2])),t.pointBuffers&&(this.helper_.flushBufferData(t.pointBuffers[0]),this.helper_.flushBufferData(t.pointBuffers[1]),this.helper_.flushBufferData(t.pointBuffers[2])))}}function eX(n,e){const t=Array.isArray(n)?n:[n];if("style"in t[0]){const r=[],i=t,s=[];for(const a of i){const o=Array.isArray(a.style)?a.style:[a.style];let l=a.filter;a.else&&s.length&&(l=["all",...s.map(h=>["!",h])],a.filter&&l.push(a.filter),l.length<3&&(l=l[1])),a.filter&&s.push(a.filter);const c=o.map(h=>oN(h,e,l));r.push(...c)}return r}return"builder"in t[0]?t:t.map(r=>oN(r,e,null))}const Wo=new Uint8Array(4);class tX{constructor(e,t){this.helper_=e;const r=e.getGL();this.texture_=r.createTexture(),this.framebuffer_=r.createFramebuffer(),this.depthbuffer_=r.createRenderbuffer(),this.size_=t||[1,1],this.data_=new Uint8Array(0),this.dataCacheDirty_=!0,this.updateSize_()}setSize(e){fc(e,this.size_)||(this.size_[0]=e[0],this.size_[1]=e[1],this.updateSize_())}getSize(){return this.size_}clearCachedData(){this.dataCacheDirty_=!0}readAll(){if(this.dataCacheDirty_){const e=this.size_,t=this.helper_.getGL();t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer_),t.readPixels(0,0,e[0],e[1],t.RGBA,t.UNSIGNED_BYTE,this.data_),this.dataCacheDirty_=!1}return this.data_}readPixel(e,t){if(e<0||t<0||e>this.size_[0]||t>=this.size_[1])return Wo[0]=0,Wo[1]=0,Wo[2]=0,Wo[3]=0,Wo;this.readAll();const r=Math.floor(e)+(this.size_[1]-Math.floor(t)-1)*this.size_[0];return Wo[0]=this.data_[r*4],Wo[1]=this.data_[r*4+1],Wo[2]=this.data_[r*4+2],Wo[3]=this.data_[r*4+3],Wo}getTexture(){return this.texture_}getFramebuffer(){return this.framebuffer_}getDepthbuffer(){return this.depthbuffer_}updateSize_(){const e=this.size_,t=this.helper_.getGL();this.texture_=this.helper_.createTexture(e,null,this.texture_),t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer_),t.viewport(0,0,e[0],e[1]),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.texture_,0),t.bindRenderbuffer(t.RENDERBUFFER,this.depthbuffer_),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,e[0],e[1]),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,this.depthbuffer_),this.data_=new Uint8Array(e[0]*e[1]*4)}}function nX(n,e){const t=n.viewState.projection,i=e.getSource().getWrapX()&&t.canWrapX(),s=t.getExtent(),a=n.extent,o=i?gn(s):null,l=i?Math.ceil((a[2]-s[2])/o)+1:1;return[i?Math.floor((a[0]-s[0])/o):0,l,o]}const If={...Gl,RENDER_EXTENT:"u_renderExtent",PATTERN_ORIGIN:"u_patternOrigin",GLOBAL_ALPHA:"u_globalAlpha"};class rX extends Vw{constructor(e,t){const r={[If.RENDER_EXTENT]:[0,0,0,0],[If.PATTERN_ORIGIN]:[0,0],[If.GLOBAL_ALPHA]:1};super(e,{uniforms:r,postProcesses:t.postProcesses}),this.hitDetectionEnabled_=!t.disableHitDetection,this.hitRenderTarget_,this.sourceRevision_=-1,this.previousExtent_=Us(),this.currentTransform_=ti(),this.tmpCoords_=[0,0],this.tmpTransform_=ti(),this.tmpMat4_=DA(),this.currentFrameStateTransform_=ti(),this.styleVariables_={},this.style_=[],this.styleRenderer_=null,this.buffers_=null,this.applyOptions_(t),this.batch_=new Y_,this.initialFeaturesAdded_=!1,this.sourceListenKeys_=null}addInitialFeatures_(e){const t=this.getLayer().getSource();let r;this.batch_.addFeatures(t.getFeatures(),r),this.sourceListenKeys_=[fn(t,rs.ADDFEATURE,this.handleSourceFeatureAdded_.bind(this,r)),fn(t,rs.CHANGEFEATURE,this.handleSourceFeatureChanged_.bind(this,r),this),fn(t,rs.REMOVEFEATURE,this.handleSourceFeatureDelete_,this),fn(t,rs.CLEAR,this.handleSourceFeatureClear_,this)]}applyOptions_(e){this.styleVariables_=e.variables,this.style_=e.style}createRenderers_(){this.buffers_=null,this.styleRenderer_=new QK(this.style_,this.styleVariables_,this.helper,this.hitDetectionEnabled_)}reset(e){this.applyOptions_(e),this.helper&&this.createRenderers_(),super.reset(e)}afterHelperCreated(){this.styleRenderer_?this.styleRenderer_.setHelper(this.helper,this.buffers_):this.createRenderers_(),this.hitDetectionEnabled_&&(this.hitRenderTarget_=new tX(this.helper))}handleSourceFeatureAdded_(e,t){const r=t.feature;this.batch_.addFeature(r,e)}handleSourceFeatureChanged_(e,t){const r=t.feature;this.batch_.changeFeature(r,e)}handleSourceFeatureDelete_(e){const t=e.feature;this.batch_.removeFeature(t)}handleSourceFeatureClear_(){this.batch_.clear()}applyUniforms_(e){zD(this.tmpTransform_,this.currentFrameStateTransform_),Sw(this.tmpTransform_,e),this.helper.setUniformMatrixValue(If.PROJECTION_MATRIX,K_(this.tmpMat4_,this.tmpTransform_)),wp(this.tmpTransform_,this.tmpTransform_),this.helper.setUniformMatrixValue(If.SCREEN_TO_WORLD_MATRIX,K_(this.tmpMat4_,this.tmpTransform_)),this.tmpCoords_[0]=0,this.tmpCoords_[1]=0,wp(this.tmpTransform_,e),kr(this.tmpTransform_,this.tmpCoords_),this.helper.setUniformFloatVec2(If.PATTERN_ORIGIN,this.tmpCoords_)}renderFrame(e){const t=this.helper.getGL();this.preRender(t,e);const[r,i,s]=nX(e,this.getLayer());this.helper.prepareDraw(e),this.renderWorlds(e,!1,r,i,s),this.helper.finalizeDraw(e,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent);const a=this.helper.getCanvas();return this.hitDetectionEnabled_&&(this.renderWorlds(e,!0,r,i,s),this.hitRenderTarget_.clearCachedData()),this.postRender(t,e),a}prepareFrameInternal(e){this.initialFeaturesAdded_||(this.addInitialFeatures_(e),this.initialFeaturesAdded_=!0);const t=this.getLayer(),r=t.getSource(),i=e.viewState,s=!e.viewHints[Jr.ANIMATING]&&!e.viewHints[Jr.INTERACTING],a=!rd(this.previousExtent_,e.extent),o=this.sourceRevision_<r.getRevision();if(o&&(this.sourceRevision_=r.getRevision()),s&&(a||o)){const l=i.projection,c=i.resolution,h=t instanceof Lw?t.getRenderBuffer():0,f=M0(e.extent,h*c);r.loadFeatures(f,c,l),this.ready=!1;const m=this.helper.makeProjectionTransform(e,ti());this.styleRenderer_.generateBuffers(this.batch_,m).then(y=>{this.buffers_&&this.disposeBuffers(this.buffers_),this.buffers_=y,this.ready=!0,this.getLayer().changed()}),this.previousExtent_=e.extent.slice()}return!0}renderWorlds(e,t,r,i,s){let a=r;t&&(this.hitRenderTarget_.setSize([Math.floor(e.size[0]/2),Math.floor(e.size[1]/2)]),this.helper.prepareDrawToRenderTarget(e,this.hitRenderTarget_,!0));do this.helper.makeProjectionTransform(e,this.currentFrameStateTransform_),UD(this.currentFrameStateTransform_,a*s,0),this.buffers_&&this.styleRenderer_.render(this.buffers_,e,()=>{this.applyUniforms_(this.buffers_.invertVerticesTransform),this.helper.applyHitDetectionUniform(t)});while(++a<i)}forEachFeatureAtCoordinate(e,t,r,i,s){if(bn(this.hitDetectionEnabled_,"`forEachFeatureAtCoordinate` cannot be used on a WebGL layer if the hit detection logic has been disabled using the `disableHitDetection: true` option."),!this.styleRenderer_||!this.hitDetectionEnabled_)return;const a=kr(t.coordinateToPixelTransform,e.slice()),o=this.hitRenderTarget_.readPixel(a[0]/2,a[1]/2),l=[o[0]/255,o[1]/255,o[2]/255,o[3]/255],c=BK(l),h=this.batch_.getFeatureFromRef(c);if(h)return i(h,this.getLayer(),null)}disposeBuffers(e){const t=r=>{for(const i of r)i&&this.helper.deleteBuffer(i)};e.pointBuffers&&t(e.pointBuffers),e.lineStringBuffers&&t(e.lineStringBuffers),e.polygonBuffers&&t(e.polygonBuffers)}disposeInternal(){this.buffers_&&this.disposeBuffers(this.buffers_),this.sourceListenKeys_&&(this.sourceListenKeys_.forEach(function(e){or(e)}),this.sourceListenKeys_=null),super.disposeInternal()}renderDeclutter(){}}const Fl={BLUR:"blur",GRADIENT:"gradient",RADIUS:"radius"},iX=["#00f","#0ff","#0f0","#ff0","#f00"];class sX extends Lw{constructor(e){e=e||{};const t=Object.assign({},e);delete t.gradient,delete t.radius,delete t.blur,delete t.weight,super(t),this.filter_=e.filter??!0,this.styleVariables_=e.variables||{},this.gradient_=null,this.addChangeListener(Fl.GRADIENT,this.handleGradientChanged_),this.setGradient(e.gradient?e.gradient:iX),this.setBlur(e.blur!==void 0?e.blur:15),this.setRadius(e.radius!==void 0?e.radius:8);const r=e.weight?e.weight:"weight";this.weight_=r,this.setRenderOrder(null)}getBlur(){return this.get(Fl.BLUR)}getGradient(){return this.get(Fl.GRADIENT)}getRadius(){return this.get(Fl.RADIUS)}handleGradientChanged_(){this.gradient_=aX(this.getGradient())}setBlur(e){const t=this.get(Fl.BLUR);if(this.set(Fl.BLUR,e),typeof e=="number"&&typeof t=="number"){this.changed();return}this.clearRenderer()}setGradient(e){this.set(Fl.GRADIENT,e)}setRadius(e){const t=this.get(Fl.RADIUS);if(this.set(Fl.RADIUS,e),typeof e=="number"&&typeof t=="number"){this.changed();return}this.clearRenderer()}setFilter(e){this.filter_=e,this.changed(),this.clearRenderer()}setWeight(e){this.weight_=e,this.changed(),this.clearRenderer()}createRenderer(){const e=new YF,t=$F(),r=Zt(t,this.filter_,Qr);let i=Zt(t,this.getRadius(),It),s=Zt(t,this.getBlur(),It);const a={};typeof this.getBlur()=="number"&&(s="a_blur",a.a_blur=()=>this.getBlur(),e.addUniform("a_blur","float")),typeof this.getRadius()=="number"&&(i="a_radius",a.a_radius=()=>this.getRadius(),e.addUniform("a_radius","float"));const o={};let l=null;if(typeof this.weight_=="string"||typeof this.weight_=="function"){const f=typeof this.weight_=="string"?m=>m.get(this.weight_):this.weight_;o.prop_weight={size:1,callback:m=>{const y=f(m);return y!==void 0?ur(y,0,1):1}},l="a_prop_weight",e.addAttribute("a_prop_weight","float")}else{const f=["clamp",this.weight_,0,1];l=Zt(t,f,It)}e.addFragmentShaderFunction(`float getBlurSlope() {
  float blur = max(1., ${s});
  float radius = ${i};
  return radius / blur;
}`).setSymbolSizeExpression(`vec2(${i} + ${s}) * 2.`).setSymbolColorExpression(`vec4(smoothstep(0., 1., (1. - length(coordsPx * 2. / v_quadSizePx)) * getBlurSlope()) * ${l})`).setStrokeColorExpression(`vec4(smoothstep(0., 1., (1. - length(currentRadiusPx * 2. / v_width)) * getBlurSlope()) * ${l})`).setStrokeWidthExpression(`(${i} + ${s}) * 2.`).setFillColorExpression(`vec4(${l})`).setFragmentDiscardExpression(`!${r}`),KF(e,t);const c=qF(t),h=XF(t,this.styleVariables_);return new rX(this,{className:this.getClassName(),variables:this.styleVariables_,style:{builder:e,attributes:{...c,...o},uniforms:{...h,...a}},disableHitDetection:!1,postProcesses:[{fragmentShader:`
            precision mediump float;

            uniform sampler2D u_image;
            uniform sampler2D u_gradientTexture;
            uniform float u_opacity;

            varying vec2 v_texCoord;

            void main() {
              vec4 color = texture2D(u_image, v_texCoord);
              gl_FragColor.a = color.a * u_opacity;
              gl_FragColor.rgb = texture2D(u_gradientTexture, vec2(0.5, color.a)).rgb;
              gl_FragColor.rgb *= gl_FragColor.a;
            }`,uniforms:{u_gradientTexture:()=>this.gradient_,u_opacity:()=>this.getOpacity()}}]})}updateStyleVariables(e){Object.assign(this.styleVariables_,e),this.changed()}renderDeclutter(){}}function aX(n){const r=Kr(1,256),i=r.createLinearGradient(0,0,1,256),s=1/(n.length-1);for(let a=0,o=n.length;a<o;++a)i.addColorStop(a*s,n[a]);return r.fillStyle=i,r.fillRect(0,0,1,256),r.canvas}class oX extends RA{constructor(e){super(e),this.image=null}getImage(){return this.image?this.image.getImage():null}prepareFrame(e){const t=e.layerStatesArray[e.layerIndex],r=e.pixelRatio,i=e.viewState,s=i.resolution,a=this.getLayer().getSource(),o=e.viewHints;let l=e.extent;if(t.extent!==void 0&&(l=Va(l,Oa(t.extent,i.projection))),!o[Jr.ANIMATING]&&!o[Jr.INTERACTING]&&!Ad(l))if(a){const c=i.projection,h=a.getImage(l,s,r,c);h&&(this.loadImage(h)?this.image=h:h.getState()===bt.EMPTY&&(this.image=null))}else this.image=null;return!!this.image}getData(e){const t=this.frameState;if(!t)return null;const r=this.getLayer(),i=kr(t.pixelToCoordinateTransform,e.slice()),s=r.getExtent();if(s&&!rc(s,i))return null;const a=this.image.getExtent(),o=this.image.getImage(),l=gn(a),c=Math.floor(o.width*((i[0]-a[0])/l));if(c<0||c>=o.width)return null;const h=ei(a),f=Math.floor(o.height*((a[3]-i[1])/h));return f<0||f>=o.height?null:this.getImageData(o,c,f)}renderFrame(e,t){const r=this.image,i=r.getExtent(),s=r.getResolution(),[a,o]=Array.isArray(s)?s:[s,s],l=r.getPixelRatio(),c=e.layerStatesArray[e.layerIndex],h=e.pixelRatio,f=e.viewState,m=f.center,y=f.resolution,x=h*a/(y*l),_=h*o/(y*l);this.prepareContainer(e,t);const w=this.context.canvas.width,S=this.context.canvas.height,b=this.getRenderContext(e);let R=!1,M=!0;if(c.extent){const P=Oa(c.extent,f.projection);M=Es(P,e.extent),R=M&&!lu(P,e.extent),R&&this.clipUnrotated(b,e,P)}const O=r.getImage(),G=$a(this.tempTransform,w/2,S/2,x,_,0,l*(i[0]-m[0])/a,l*(m[1]-i[3])/o);this.renderedResolution=o*h/l;const A=O.width*G[0],I=O.height*G[3];if(this.getLayer().getSource().getInterpolate()||(b.imageSmoothingEnabled=!1),this.preRender(b,e),M&&A>=.5&&I>=.5){const P=G[4],D=G[5],L=c.opacity;L!==1&&(b.save(),b.globalAlpha=L),b.drawImage(O,0,0,+O.width,+O.height,P,D,A,I),L!==1&&b.restore()}return this.postRender(this.context,e),R&&b.restore(),b.imageSmoothingEnabled=!0,this.container}}class lX extends Ay{constructor(e){e=e||{},super(e)}}class cX extends lX{constructor(e){super(e)}createRenderer(){return new oX(this)}getData(e){return super.getData(e)}}function HT(n,e,t){if(!(t in n))return n[t]=new Set([e]),!0;const r=n[t],i=r.has(e);return i||r.add(e),!i}function uX(n,e,t){const r=n[t];return r?r.delete(e):!1}function lN(n,e){const t=n.layerStatesArray[n.layerIndex];t.extent&&(e=Va(e,Oa(t.extent,n.viewState.projection)));const r=t.layer.getRenderSource();if(!r.getWrapX()){const i=r.getTileGridForProjection(n.viewState.projection).getExtent();i&&(e=Va(e,i))}return e}class hX extends RA{constructor(e,t){super(e),t=t||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=Us(),this.tempTileRange_=new jw(0,0,0,0),this.tempTileCoord_=F0(0,0,0);const r=t.cacheSize!==void 0?t.cacheSize:512;this.tileCache_=new vb(r),this.sourceTileCache_=null,this.maxStaleKeys=r*.5}getTileCache(){return this.tileCache_}getSourceTileCache(){return this.sourceTileCache_||(this.sourceTileCache_=new vb(512)),this.sourceTileCache_}getOrCreateTile(e,t,r,i){const s=this.tileCache_,o=this.getLayer().getSource(),l=i_(o,o.getKey(),e,t,r);let c;if(s.containsKey(l))c=s.get(l);else{const h=i.viewState.projection,f=o.getProjection();if(c=o.getTile(e,t,r,i.pixelRatio,h,!f||qh(f,h)?void 0:this.getSourceTileCache()),!c)return null;s.set(l,c)}return c}getTile(e,t,r,i){const s=this.getOrCreateTile(e,t,r,i);return s||null}getData(e){const t=this.frameState;if(!t)return null;const r=this.getLayer(),i=kr(t.pixelToCoordinateTransform,e.slice()),s=r.getExtent();if(s&&!rc(s,i))return null;const a=t.viewState,o=r.getRenderSource(),l=o.getTileGridForProjection(a.projection),c=o.getTilePixelRatio(t.pixelRatio);for(let h=l.getZForResolution(a.resolution);h>=l.getMinZoom();--h){const f=l.getTileCoordForCoordAndZ(i,h),m=this.getTile(h,f[1],f[2],t);if(!m||m.getState()!==Lt.LOADED)continue;const y=l.getOrigin(h),x=Ii(l.getTileSize(h)),_=l.getResolution(h);let w;if(m instanceof Fw||m instanceof VA)w=m.getImage();else if(m instanceof _b){if(w=Pp(m.getData()),!w)continue}else continue;const S=Math.floor(c*((i[0]-y[0])/_-f[1]*x[0])),b=Math.floor(c*((y[1]-i[1])/_-f[2]*x[1])),R=Math.round(c*o.getGutterForProjection(a.projection));return this.getImageData(w,S+R,b+R)}return null}prepareFrame(e){this.renderedProjection?e.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=e.viewState.projection):this.renderedProjection=e.viewState.projection;const t=this.getLayer().getSource();if(!t)return!1;const r=t.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==r&&(this.renderedSourceRevision_=r,this.renderedSourceKey_===t.getKey()&&(this.tileCache_.clear(),this.sourceTileCache_?.clear())):this.renderedSourceRevision_=r,!0}enqueueTilesForNextExtent(){return!0}enqueueTiles(e,t,r,i,s){const a=e.viewState,o=this.getLayer(),l=o.getRenderSource(),c=l.getTileGridForProjection(a.projection),h=Bt(l);h in e.wantedTiles||(e.wantedTiles[h]={});const f=e.wantedTiles[h],m=o.getMapInternal(),y=Math.max(r-s,c.getMinZoom(),c.getZForResolution(Math.min(o.getMaxResolution(),m?m.getView().getResolutionForZoom(Math.max(o.getMinZoom(),0)):c.getResolution(0)),l.zDirection)),x=a.rotation,_=x?nA(a.center,a.resolution,x,e.size):void 0;for(let w=r;w>=y;--w){const S=c.getTileRangeForExtentAndZ(t,w,this.tempTileRange_),b=c.getResolution(w);for(let R=S.minX;R<=S.maxX;++R)for(let M=S.minY;M<=S.maxY;++M){if(x&&!c.tileCoordIntersectsViewport([w,R,M],_))continue;const O=this.getTile(w,R,M,e);if(!O||!HT(i,O,w))continue;const A=O.getKey();if(f[A]=!0,O.getState()===Lt.IDLE&&!e.tileQueue.isKeyQueued(A)){const I=F0(w,R,M,this.tempTileCoord_);e.tileQueue.enqueue([O,h,c.getTileCoordCenter(I),b])}}}}findStaleTile_(e,t){const r=this.tileCache_,i=e[0],s=e[1],a=e[2],o=this.getStaleKeys();for(let l=0;l<o.length;++l){const c=i_(this.getLayer().getSource(),o[l],i,s,a);if(r.containsKey(c)){const h=r.peek(c);if(h.getState()===Lt.LOADED)return h.endTransition(Bt(this)),HT(t,h,i),!0}}return!1}findAltTiles_(e,t,r,i){const s=e.getTileRangeForTileCoordAndZ(t,r,this.tempTileRange_);if(!s)return!1;let a=!0;const o=this.tileCache_,l=this.getLayer().getRenderSource(),c=l.getKey();for(let h=s.minX;h<=s.maxX;++h)for(let f=s.minY;f<=s.maxY;++f){const m=i_(l,c,r,h,f);let y=!1;if(o.containsKey(m)){const x=o.peek(m);x.getState()===Lt.LOADED&&(HT(i,x,r),y=!0)}y||(a=!1)}return a}renderFrame(e,t){this.renderComplete=!0;const r=e.layerStatesArray[e.layerIndex],i=e.viewState,s=i.projection,a=i.resolution,o=i.center,l=e.pixelRatio,c=this.getLayer(),h=c.getSource(),f=h.getTileGridForProjection(s),m=f.getZForResolution(a,h.zDirection),y=f.getResolution(m),x=h.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==x&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=x):this.renderedSourceKey_=x;let _=e.extent;const w=h.getTilePixelRatio(l);this.prepareContainer(e,t);const S=this.context.canvas.width,b=this.context.canvas.height,R=r.extent&&Oa(r.extent);R&&(_=Va(_,Oa(r.extent)));const M=y*S/2/w,O=y*b/2/w,G=[o[0]-M,o[1]-O,o[0]+M,o[1]+O],A={};this.renderedTiles.length=0;const I=c.getPreload();if(e.nextExtent&&this.enqueueTilesForNextExtent()){const ce=f.getZForResolution(i.nextResolution,h.zDirection),Pe=lN(e,e.nextExtent);this.enqueueTiles(e,Pe,ce,A,I)}const P=lN(e,_);if(this.enqueueTiles(e,P,m,A,0),I>0&&setTimeout(()=>{this.enqueueTiles(e,P,m-1,A,I-1)},0),!(m in A))return this.container;const D=Bt(this),L=e.time;for(const ce of A[m]){const Pe=ce.getState();if(Pe===Lt.EMPTY)continue;const be=ce.tileCoord;if(Pe===Lt.LOADED&&ce.getAlpha(D,L)===1){ce.endTransition(D);continue}if(Pe!==Lt.ERROR&&(this.renderComplete=!1),this.findStaleTile_(be,A)){uX(A,ce,m),e.animate=!0;continue}if(this.findAltTiles_(f,be,m+1,A))continue;const Z=f.getMinZoom();for(let te=m-1;te>=Z&&!this.findAltTiles_(f,be,te,A);--te);}const U=y/a*l/w,j=this.getRenderContext(e);$a(this.tempTransform,S/2,b/2,U,U,0,-S/2,-b/2),r.extent&&this.clipUnrotated(j,e,R),h.getInterpolate()||(j.imageSmoothingEnabled=!1),this.preRender(j,e);const Ee=Object.keys(A).map(Number);Ee.sort(Xl);let ke;const Be=[],Me=[];for(let ce=Ee.length-1;ce>=0;--ce){const Pe=Ee[ce],be=h.getTilePixelSize(Pe,l,s),V=f.getResolution(Pe)/y,Z=be[0]*V*U,te=be[1]*V*U,ie=f.getTileCoordForCoordAndZ(Rd(G),Pe),ue=f.getTileCoordExtent(ie),Ve=kr(this.tempTransform,[w*(ue[0]-G[0])/y,w*(G[3]-ue[3])/y]),Ge=w*h.getGutterForProjection(s);for(const ye of A[Pe]){if(ye.getState()!==Lt.LOADED)continue;const pe=ye.tileCoord,Fe=ie[1]-pe[1],wt=Math.round(Ve[0]-(Fe-1)*Z),jt=ie[2]-pe[2],Dt=Math.round(Ve[1]-(jt-1)*te),Kt=Math.round(Ve[0]-Fe*Z),Qt=Math.round(Ve[1]-jt*te),ot=wt-Kt,tr=Dt-Qt,hn=Ee.length===1;let cn=!1;ke=[Kt,Qt,Kt+ot,Qt,Kt+ot,Qt+tr,Kt,Qt+tr];for(let sr=0,Ni=Be.length;sr<Ni;++sr)if(!hn&&Pe<Me[sr]){const Vn=Be[sr];Es([Kt,Qt,Kt+ot,Qt+tr],[Vn[0],Vn[3],Vn[4],Vn[7]])&&(cn||(j.save(),cn=!0),j.beginPath(),j.moveTo(ke[0],ke[1]),j.lineTo(ke[2],ke[3]),j.lineTo(ke[4],ke[5]),j.lineTo(ke[6],ke[7]),j.moveTo(Vn[6],Vn[7]),j.lineTo(Vn[4],Vn[5]),j.lineTo(Vn[2],Vn[3]),j.lineTo(Vn[0],Vn[1]),j.clip())}Be.push(ke),Me.push(Pe),this.drawTile(ye,e,Kt,Qt,ot,tr,Ge,hn),cn&&j.restore(),this.renderedTiles.unshift(ye),this.updateUsedTiles(e.usedTiles,h,ye)}}if(this.renderedResolution=y,this.extentChanged=!this.renderedExtent_||!rd(this.renderedExtent_,G),this.renderedExtent_=G,this.renderedPixelRatio=l,this.postRender(this.context,e),r.extent&&j.restore(),j.imageSmoothingEnabled=!0,this.renderComplete){const ce=(Pe,be)=>{const se=Bt(h),V=be.wantedTiles[se],Z=V?Object.keys(V).length:0;this.updateCacheSize(Z),this.tileCache_.expireCache(),this.sourceTileCache_?.expireCache()};e.postRenderFunctions.push(ce)}return this.container}updateCacheSize(e){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,e*2)}drawTile(e,t,r,i,s,a,o,l){let c;if(e instanceof _b){if(c=Pp(e.getData()),!c)throw new Error("Rendering array data is not yet supported")}else c=this.getTileImage(e);if(!c)return;const h=this.getRenderContext(t),f=Bt(this),m=t.layerStatesArray[t.layerIndex],y=m.opacity*(l?e.getAlpha(f,t.time):1),x=y!==h.globalAlpha;x&&(h.save(),h.globalAlpha=y),h.drawImage(c,o,o,c.width-2*o,c.height-2*o,r,i,s,a),x&&h.restore(),y!==m.opacity?t.animate=!0:l&&e.endTransition(f)}getImage(){const e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}updateUsedTiles(e,t,r){const i=Bt(t);i in e||(e[i]={}),e[i][r.getKey()]=!0}}const Rx={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class dX extends Ay{constructor(e){e=e||{};const t=Object.assign({},e),r=e.cacheSize;delete e.cacheSize,delete t.preload,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un,this.cacheSize_=r,this.setPreload(e.preload!==void 0?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(Rx.PRELOAD)}setPreload(e){this.set(Rx.PRELOAD,e)}getUseInterimTilesOnError(){return this.get(Rx.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(Rx.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}}class Sh extends dX{constructor(e){super(e)}createRenderer(){return new hX(this,{cacheSize:this.getCacheSize()})}}function Sb(n){return Array.isArray(n)?Math.min(...n):n}const Cf=[0,0,0],Kc=5;class JF{constructor(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,bn(MU(this.resolutions_,(i,s)=>s-i),"`resolutions` must be sorted in descending order");let t;if(!e.origins){for(let i=0,s=this.resolutions_.length-1;i<s;++i)if(!t)t=this.resolutions_[i]/this.resolutions_[i+1];else if(this.resolutions_[i]/this.resolutions_[i+1]!==t){t=void 0;break}}this.zoomFactor_=t,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,bn(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const r=e.extent;r!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=Rd(r)),bn(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,bn(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:LA,bn(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=r!==void 0?r:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map((i,s)=>{const a=new jw(Math.min(0,i[0]),Math.max(i[0]-1,-1),Math.min(0,i[1]),Math.max(i[1]-1,-1));if(r){const o=this.getTileRangeForExtentAndZ(r,s);a.minX=Math.max(o.minX,a.minX),a.maxX=Math.min(o.maxX,a.maxX),a.minY=Math.max(o.minY,a.minY),a.maxY=Math.min(o.maxY,a.maxY)}return a}):r&&this.calculateTileRanges_(r)}forEachTileCoord(e,t,r){const i=this.getTileRangeForExtentAndZ(e,t);for(let s=i.minX,a=i.maxX;s<=a;++s)for(let o=i.minY,l=i.maxY;o<=l;++o)r([t,s,o])}forEachTileCoordParentTileRange(e,t,r,i){let s,a,o,l=null,c=e[0]-1;for(this.zoomFactor_===2?(a=e[1],o=e[2]):l=this.getTileCoordExtent(e,i);c>=this.minZoom;){if(a!==void 0&&o!==void 0?(a=Math.floor(a/2),o=Math.floor(o/2),s=bf(a,a,o,o,r)):s=this.getTileRangeForExtentAndZ(l,c,r),t(c,s))return!0;--c}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,t,r){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){const s=e[1]*2,a=e[2]*2;return bf(s,s+1,a,a+1,t)}const i=this.getTileCoordExtent(e,r||this.tmpExtent_);return this.getTileRangeForExtentAndZ(i,e[0]+1,t)}return null}getTileRangeForTileCoordAndZ(e,t,r){if(t>this.maxZoom||t<this.minZoom)return null;const i=e[0],s=e[1],a=e[2];if(t===i)return bf(s,a,s,a,r);if(this.zoomFactor_){const l=Math.pow(this.zoomFactor_,t-i),c=Math.floor(s*l),h=Math.floor(a*l);if(t<i)return bf(c,c,h,h,r);const f=Math.floor(l*(s+1))-1,m=Math.floor(l*(a+1))-1;return bf(c,f,h,m,r)}const o=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(o,t,r)}getTileRangeForExtentAndZ(e,t,r){this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,Cf);const i=Cf[1],s=Cf[2];this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,Cf);const a=Cf[1],o=Cf[2];return bf(i,a,s,o,r)}getTileCoordCenter(e){const t=this.getOrigin(e[0]),r=this.getResolution(e[0]),i=Ii(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*i[0]*r,t[1]-(e[2]+.5)*i[1]*r]}getTileCoordExtent(e,t){const r=this.getOrigin(e[0]),i=this.getResolution(e[0]),s=Ii(this.getTileSize(e[0]),this.tmpSize_),a=r[0]+e[1]*s[0]*i,o=r[1]-(e[2]+1)*s[1]*i,l=a+s[0]*i,c=o+s[1]*i;return ku(a,o,l,c,t)}getTileCoordForCoordAndResolution(e,t,r){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,r)}getTileCoordForXYAndResolution_(e,t,r,i,s){const a=this.getZForResolution(r),o=r/this.getResolution(a),l=this.getOrigin(a),c=Ii(this.getTileSize(a),this.tmpSize_);let h=o*(e-l[0])/r/c[0],f=o*(l[1]-t)/r/c[1];return i?(h=cu(h,Kc)-1,f=cu(f,Kc)-1):(h=mx(h,Kc),f=mx(f,Kc)),F0(a,h,f,s)}getTileCoordForXYAndZ_(e,t,r,i,s){const a=this.getOrigin(r),o=this.getResolution(r),l=Ii(this.getTileSize(r),this.tmpSize_);let c=(e-a[0])/o/l[0],h=(a[1]-t)/o/l[1];return i?(c=cu(c,Kc)-1,h=cu(h,Kc)-1):(c=mx(c,Kc),h=mx(h,Kc)),F0(r,c,h,s)}getTileCoordForCoordAndZ(e,t,r){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,r)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,t){const r=pw(this.resolutions_,e,t||0);return ur(r,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,t){return XD(t,0,t.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){const t=this.resolutions_.length,r=new Array(t);for(let i=this.minZoom;i<t;++i)r[i]=this.getTileRangeForExtentAndZ(e,i);this.fullTileRanges_=r}}function QF(n){let e=n.getDefaultTileGrid();return e||(e=pX(n),n.setDefaultTileGrid(e)),e}function fX(n,e,t){const r=e[0],i=n.getTileCoordCenter(e),s=XA(t);if(!rc(s,i)){const a=gn(s),o=Math.ceil((s[0]-i[0])/a);return i[0]+=a*o,n.getTileCoordForCoordAndZ(i,r)}return e}function gX(n,e,t,r){r=r!==void 0?r:"top-left";const i=ej(n,e,t);return new JF({extent:n,origin:FU(n,r),resolutions:i,tileSize:t})}function mX(n){const e=n||{},t=e.extent||ir("EPSG:3857").getExtent(),r={extent:t,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:ej(t,e.maxZoom,e.tileSize,e.maxResolution)};return new JF(r)}function ej(n,e,t,r){e=e!==void 0?e:HH,t=Ii(t!==void 0?t:LA);const i=ei(n),s=gn(n);r=r>0?r:Math.max(s/t[0],i/t[1]);const a=e+1,o=new Array(a);for(let l=0;l<a;++l)o[l]=r/Math.pow(2,l);return o}function pX(n,e,t,r){const i=XA(n);return gX(i,e,t,r)}function XA(n){n=ir(n);let e=n.getExtent();if(!e){const t=180*N0.degrees/n.getMetersPerUnit();e=ku(-t,-t,t,t)}return e}function qA(n,e){const t=[];Object.keys(e).forEach(function(i){e[i]!==null&&e[i]!==void 0&&t.push(i+"="+encodeURIComponent(e[i]))});const r=t.join("&");return n=n.replace(/[?&]$/,""),n+=n.includes("?")?"&":"?",n+r}const yX=/\{z\}/g,xX=/\{x\}/g,_X=/\{y\}/g,vX=/\{-y\}/g;function wX(n,e,t,r,i){return n.replace(yX,e.toString()).replace(xX,t.toString()).replace(_X,r.toString()).replace(vX,function(){if(i===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(i-r).toString()})}function EX(n){const e=[];let t=/\{([a-z])-([a-z])\}/.exec(n);if(t){const r=t[1].charCodeAt(0),i=t[2].charCodeAt(0);let s;for(s=r;s<=i;++s)e.push(n.replace(t[0],String.fromCharCode(s)));return e}if(t=/\{(\d+)-(\d+)\}/.exec(n),t){const r=parseInt(t[2],10);for(let i=parseInt(t[1],10);i<=r;i++)e.push(n.replace(t[0],i.toString()));return e}return e.push(n),e}function TX(n,e){return(function(t,r,i){if(!t)return;let s;const a=t[0];if(e){const o=e.getFullTileRange(a);o&&(s=o.getHeight()-1)}return wX(n,a,t[1],t[2],s)})}function SX(n,e){const t=n.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=TX(n[i],e);return bX(r)}function bX(n){return n.length===1?n[0]:(function(e,t,r){if(!e)return;const i=UF(e),s=vu(i,n.length);return n[s](e,t,r)})}class RX extends bA{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=e.tilePixelRatio!==void 0?e.tilePixelRatio:1,this.tileGrid=e.tileGrid!==void 0?e.tileGrid:null;const t=[256,256];this.tileGrid&&Ii(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),t),this.tmpSize=[0,0],this.key_=e.key||Bt(this),this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}getGutterForProjection(e){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getResolutions(e){const t=e?this.getTileGridForProjection(e):this.tileGrid;return t?t.getResolutions():null}getTile(e,t,r,i,s,a){return Wt()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:QF(e)}getTilePixelRatio(e){return this.tilePixelRatio_}getTilePixelSize(e,t,r){const i=this.getTileGridForProjection(r),s=this.getTilePixelRatio(t),a=Ii(i.getTileSize(e),this.tmpSize);return s==1?a:LW(a,s,this.tmpSize)}getTileCoordForTileUrlFunction(e,t){const r=t!==void 0?t:this.getProjection(),i=t!==void 0?this.getTileGridForProjection(r):this.tileGrid||this.getTileGridForProjection(r);return this.getWrapX()&&r.isGlobal()&&(e=fX(i,e,r)),wK(e,i)?e:null}clear(){}refresh(){this.clear(),super.refresh()}}class AX extends pl{constructor(e,t){super(e),this.tile=t}}const KT={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class YA extends RX{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===YA.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){const t=e.target,r=Bt(t),i=t.getState();let s;i==Lt.LOADING?(this.tileLoadingKeys_[r]=!0,s=KT.TILELOADSTART):r in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[r],s=i==Lt.ERROR?KT.TILELOADERROR:i==Lt.LOADED?KT.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new AX(s,t))}setTileLoadFunction(e){this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,t){this.tileUrlFunction=e,typeof t<"u"?this.setKey(t):this.changed()}setUrl(e){const t=EX(e);this.urls=t,this.setUrls(t)}setUrls(e){this.urls=e;const t=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(SX(e,this.tileGrid),t):this.setKey(t)}tileUrlFunction(e,t,r){}}class tj extends YA{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:nj,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate!==void 0?e.interpolate:!0,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,this.tileClass=e.tileClass!==void 0?e.tileClass:Fw,this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(e){return this.getProjection()&&e&&!qh(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getTileGridForProjection(e){const t=this.getProjection();if(this.tileGrid&&(!t||qh(t,e)))return this.tileGrid;const r=Bt(e);return r in this.tileGridForProjection||(this.tileGridForProjection[r]=QF(e)),this.tileGridForProjection[r]}createTile_(e,t,r,i,s,a){const o=[e,t,r],l=this.getTileCoordForTileUrlFunction(o,s),c=l?this.tileUrlFunction(l,i,s):void 0,h=new this.tileClass(o,c!==void 0?Lt.IDLE:Lt.EMPTY,c!==void 0?c:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return h.key=a,h.addEventListener(Ht.CHANGE,this.handleTileChange.bind(this)),h}getTile(e,t,r,i,s,a){const o=this.getProjection();if(!o||!s||qh(o,s))return this.getTileInternal(e,t,r,i,o||s);const l=[e,t,r],c=this.getKey(),h=this.getTileGridForProjection(o),f=this.getTileGridForProjection(s),m=this.getTileCoordForTileUrlFunction(l,s),y=new VA(o,h,s,f,l,m,this.getTilePixelRatio(i),this.getGutter(),(x,_,w,S)=>this.getTileInternal(x,_,w,S,o,a),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return y.key=c,y}getTileInternal(e,t,r,i,s,a){const o=this.getKey(),l=i_(this,o,e,t,r);if(a&&a.containsKey(l))return a.get(l);const c=this.createTile_(e,t,r,i,s,o);return a?.set(l,c),c}setRenderReprojectionEdges(e){this.renderReprojectionEdges_!=e&&(this.renderReprojectionEdges_=e,this.changed())}setTileGridForProjection(e,t){const r=ir(e);if(r){const i=Bt(r);i in this.tileGridForProjection||(this.tileGridForProjection[i]=t)}}}function nj(n,e){if(ha){const t=n.getCrossOrigin();let r="same-origin",i="same-origin";t==="anonymous"||t===""?(r="cors",i="omit"):t==="use-credentials"&&(r="cors",i="include"),fetch(e,{mode:r,credentials:i}).then(s=>{if(!s.ok)throw new Error(`HTTP ${s.status}`);return s.blob()}).then(s=>createImageBitmap(s)).then(s=>{const a=n.getImage();a.width=s.width,a.height=s.height,a.getContext("2d").drawImage(s,0,0),s.close?.(),a.dispatchEvent(new Event("load"))}).catch(()=>{n.getImage().dispatchEvent(new Event("error"))});return}n.getImage().src=e}class Hf extends tj{constructor(e){e=e||{};const t=e.projection!==void 0?e.projection:"EPSG:3857",r=e.tileGrid!==void 0?e.tileGrid:mX({extent:XA(t),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:t,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:r,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0}getGutter(){return this.gutter_}}const IX="modulepreload",CX=function(n){return"/detectorapp-nl/"+n},cN={},yt=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){let l=function(c){return Promise.all(c.map(h=>Promise.resolve(h).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=a?.nonce||a?.getAttribute("nonce");i=l(t.map(c=>{if(c=CX(c),c in cN)return;cN[c]=!0;const h=c.endsWith(".css"),f=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${f}`))return;const m=document.createElement("link");if(m.rel=h?"stylesheet":IX,h||(m.as="script"),m.crossOrigin="",m.href=c,o&&m.setAttribute("nonce",o),document.head.appendChild(m),h)return new Promise((y,x)=>{m.addEventListener("load",y),m.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return i.then(a=>{for(const o of a||[])o.status==="rejected"&&s(o.reason);return e().catch(s)})};class kX extends rF{constructor(e,t,r,i,s,a,o){let l=e.getExtent();l&&e.canWrapX()&&(l=l.slice(),l[0]=-1/0,l[2]=1/0);let c=t.getExtent();c&&t.canWrapX()&&(c=c.slice(),c[0]=-1/0,c[2]=1/0);const h=c?Va(r,c):r,f=ul(h),m=q_(e,t,f,i),y=GF,x=new VF(e,t,h,l,m*y,i),_=x.calculateSourceExtent(),w=Ad(_)?null:a(_,m,s),S=w?bt.IDLE:bt.EMPTY,b=w?w.getPixelRatio():1;super(r,i,b,S),this.targetProj_=t,this.maxSourceExtent_=l,this.triangulation_=x,this.targetResolution_=i,this.targetExtent_=r,this.sourceImage_=w,this.sourcePixelRatio_=b,this.interpolate_=o,this.canvas_=null,this.sourceListenerKey_=null}disposeInternal(){this.state==bt.LOADING&&this.unlistenSource_(),super.disposeInternal()}getImage(){return this.canvas_}getProjection(){return this.targetProj_}reproject_(){const e=this.sourceImage_.getState();if(e==bt.LOADED){const t=gn(this.targetExtent_)/this.targetResolution_,r=ei(this.targetExtent_)/this.targetResolution_;this.canvas_=jF(t,r,this.sourcePixelRatio_,Sb(this.sourceImage_.getResolution()),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0,void 0,this.interpolate_,!0)}this.state=e,this.changed()}load(){if(this.state==bt.IDLE){this.state=bt.LOADING,this.changed();const e=this.sourceImage_.getState();e==bt.LOADED||e==bt.ERROR?this.reproject_():(this.sourceListenerKey_=fn(this.sourceImage_,Ht.CHANGE,t=>{const r=this.sourceImage_.getState();(r==bt.LOADED||r==bt.ERROR)&&(this.unlistenSource_(),this.reproject_())}),this.sourceImage_.load())}}unlistenSource_(){or(this.sourceListenerKey_),this.sourceListenerKey_=null}}const fu=4,XT={IMAGELOADSTART:"imageloadstart",IMAGELOADEND:"imageloadend",IMAGELOADERROR:"imageloaderror"};class PX extends pl{constructor(e,t){super(e),this.image=t}}class MX extends bA{constructor(e){super({attributions:e.attributions,projection:e.projection,state:e.state,interpolate:e.interpolate!==void 0?e.interpolate:!0}),this.on,this.once,this.un,this.loader=e.loader||null,this.resolutions_=e.resolutions!==void 0?e.resolutions:null,this.reprojectedImage_=null,this.reprojectedRevision_=0,this.image=null,this.wantedExtent_,this.wantedResolution_,this.static_=e.loader?e.loader.length===0:!1,this.wantedProjection_=null}getResolutions(){return this.resolutions_}setResolutions(e){this.resolutions_=e}findNearestResolution(e){const t=this.getResolutions();if(t){const r=pw(t,e,0);e=t[r]}return e}getImage(e,t,r,i){const s=this.getProjection();if(!s||!i||qh(s,i))return s&&(i=s),this.getImageInternal(e,t,r,i);if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&qh(this.reprojectedImage_.getProjection(),i)&&this.reprojectedImage_.getResolution()==t&&rd(this.reprojectedImage_.getExtent(),e))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new kX(s,i,e,t,r,(a,o,l)=>this.getImageInternal(a,o,l,s),this.getInterpolate()),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}getImageInternal(e,t,r,i){if(this.loader){const s=rj(e,t,r,1),a=this.findNearestResolution(t);if(this.image&&(this.static_||this.wantedProjection_===i&&(this.wantedExtent_&&lu(this.wantedExtent_,s)||lu(this.image.getExtent(),s))&&(this.wantedResolution_&&Sb(this.wantedResolution_)===a||Sb(this.image.getResolution())===a)))return this.image;this.wantedProjection_=i,this.wantedExtent_=s,this.wantedResolution_=a,this.image=new rF(s,a,r,this.loader),this.image.addEventListener(Ht.CHANGE,this.handleImageChange.bind(this))}return this.image}handleImageChange(e){const t=e.target;let r;switch(t.getState()){case bt.LOADING:this.loading=!0,r=XT.IMAGELOADSTART;break;case bt.LOADED:this.loading=!1,r=XT.IMAGELOADEND;break;case bt.ERROR:this.loading=!1,r=XT.IMAGELOADERROR;break;default:return}this.hasListener(r)&&this.dispatchEvent(new PX(r,t))}}function NX(n,e){n.getImage().src=e}function rj(n,e,t,r){const i=e/t,s=ul(n),a=cu(gn(n)/i,fu),o=cu(ei(n)/i,fu),l=cu((r-1)*a/2,fu),c=a+2*l,h=cu((r-1)*o/2,fu),f=o+2*h;return M_(s,i,0,[c,f])}function LX(n,e,t,r,i,s){const a=i.getCode().split(/:(?=\d+$)/).pop(),o=t/r,l=[N_(gn(e)/o,fu),N_(ei(e)/o,fu)];s.SIZE=l[0]+","+l[1],s.BBOX=e.join(","),s.BBOXSR=a,s.IMAGESR=a,s.DPI=Math.round(s.DPI?s.DPI*r:90*r);const c=n.replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage");return qA(c,s)}function OX(n){const e=n.load?n.load:sF,t=ir(n.projection||"EPSG:3857"),r=n.ratio??1.5,i=n.crossOrigin??null;return function(s,a,o){o=n.hidpi?o:1;const l={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};Object.assign(l,n.params),s=rj(s,a,o,r);const c=LX(n.url,s,a,o,t,l),h=new Image;return h.crossOrigin=i,e(h,c).then(f=>{const m=gn(s)/f.width*o;return{image:f,extent:s,resolution:m,pixelRatio:o}})}}class DX extends MX{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:e.interpolate,projection:e.projection,resolutions:e.resolutions}),this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.url_=e.url,this.imageLoadFunction_=e.imageLoadFunction!==void 0?e.imageLoadFunction:NX,this.params_=Object.assign({},e.params),this.imageSize_=[0,0],this.renderedRevision_=0,this.ratio_=e.ratio!==void 0?e.ratio:1.5,this.loaderProjection_=null}getParams(){return this.params_}getImageInternal(e,t,r,i){return this.url_===void 0?null:((!this.loader||this.loaderProjection_!==i)&&(this.loaderProjection_=i,this.loader=OX({crossOrigin:this.crossOrigin_,params:this.params_,projection:i,hidpi:this.hidpi_,url:this.url_,ratio:this.ratio_,load:(s,a)=>(this.image.setImage(s),this.imageLoadFunction_(this.image,a),sF(s))})),super.getImageInternal(e,t,r,i))}getImageLoadFunction(){return this.imageLoadFunction_}getUrl(){return this.url_}setImageLoadFunction(e){this.imageLoadFunction_=e,this.changed()}setUrl(e){e!=this.url_&&(this.url_=e,this.loader=null,this.changed())}setParams(e){this.params_=Object.assign({},e),this.changed()}updateParams(e){Object.assign(this.params_,e),this.changed()}changed(){this.image=null,super.changed()}}const bb="1.3.0";function FX(n,e,t,r,i){i.WIDTH=t[0],i.HEIGHT=t[1];const s=r.getAxisOrientation(),a=PD(i.VERSION,"1.3")>=0;i[a?"CRS":"SRS"]=r.getCode();const o=a&&s.startsWith("ne")?[e[1],e[0],e[3],e[2]]:e;return i.BBOX=o.join(","),qA(n,i)}function jX(n,e,t,r,i,s,a){s=Object.assign({REQUEST:"GetMap"},s);const o=e/t,l=[N_(gn(n)/o,fu),N_(ei(n)/o,fu)];if(t!=1)switch(a){case"geoserver":const h=90*t+.5|0;"FORMAT_OPTIONS"in s?s.FORMAT_OPTIONS+=";dpi:"+h:s.FORMAT_OPTIONS="dpi:"+h;break;case"mapserver":s.MAP_RESOLUTION=90*t;break;case"carmentaserver":case"qgis":s.DPI=90*t;break;default:throw new Error("Unknown `serverType` configured")}return FX(i,n,l,r,s)}function uN(n,e){return Object.assign({REQUEST:e,SERVICE:"WMS",VERSION:bb,FORMAT:"image/png",STYLES:"",TRANSPARENT:"TRUE"},n)}const VX='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.';class GX extends Hf{constructor(e){e=e||{};let t;e.attributions!==void 0?t=e.attributions:t=[VX];const r=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",i=e.url!==void 0?e.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:t,attributionsCollapsible:!1,cacheSize:e.cacheSize,crossOrigin:r,interpolate:e.interpolate,maxZoom:e.maxZoom!==void 0?e.maxZoom:19,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:(s,a)=>{const o=s.getImage();!ha&&o instanceof HTMLImageElement&&(o.referrerPolicy="origin-when-cross-origin"),(e.tileLoadFunction||nj)(s,a)},transition:e.transition,url:i,wrapX:e.wrapX,zDirection:e.zDirection})}}const J_=1/0;class BX{constructor(e,t){this.priorityFunction_=e,this.keyFunction_=t,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,og(this.queuedElements_)}dequeue(){const e=this.elements_,t=this.priorities_,r=e[0];e.length==1?(e.length=0,t.length=0):(e[0]=e.pop(),t[0]=t.pop(),this.siftUp_(0));const i=this.keyFunction_(r);return delete this.queuedElements_[i],r}enqueue(e){bn(!(this.keyFunction_(e)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const t=this.priorityFunction_(e);return t!=J_?(this.elements_.push(e),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(e){return e*2+1}getRightChildIndex_(e){return e*2+2}getParentIndex_(e){return e-1>>1}heapify_(){let e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)}isEmpty(){return this.elements_.length===0}isKeyQueued(e){return e in this.queuedElements_}isQueued(e){return this.isKeyQueued(this.keyFunction_(e))}siftUp_(e){const t=this.elements_,r=this.priorities_,i=t.length,s=t[e],a=r[e],o=e;for(;e<i>>1;){const l=this.getLeftChildIndex_(e),c=this.getRightChildIndex_(e),h=c<i&&r[c]<r[l]?c:l;t[e]=t[h],r[e]=r[h],e=h}t[e]=s,r[e]=a,this.siftDown_(o,e)}siftDown_(e,t){const r=this.elements_,i=this.priorities_,s=r[t],a=i[t];for(;t>e;){const o=this.getParentIndex_(t);if(i[o]>a)r[t]=r[o],i[t]=i[o],t=o;else break}r[t]=s,i[t]=a}reprioritize(){const e=this.priorityFunction_,t=this.elements_,r=this.priorities_;let i=0;const s=t.length;let a,o,l;for(o=0;o<s;++o)a=t[o],l=e(a),l==J_?delete this.queuedElements_[this.keyFunction_(a)]:(r[i]=l,t[i++]=a);t.length=i,r.length=i,this.heapify_()}}class zX extends BX{constructor(e,t){super(r=>e.apply(null,r),r=>r[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=t,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(e){const t=super.enqueue(e);return t&&e[0].addEventListener(Ht.CHANGE,this.boundHandleTileChange_),t}getTilesLoading(){return this.tilesLoading_}handleTileChange(e){const t=e.target,r=t.getState();if(r===Lt.LOADED||r===Lt.ERROR||r===Lt.EMPTY){r!==Lt.ERROR&&t.removeEventListener(Ht.CHANGE,this.boundHandleTileChange_);const i=t.getKey();i in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[i],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(e,t){let r=0;for(;this.tilesLoading_<e&&r<t&&this.getCount()>0;){const i=this.dequeue()[0],s=i.getKey();i.getState()===Lt.IDLE&&!(s in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++r,i.load())}}}function UX(n,e,t,r,i){if(!n||!(t in n.wantedTiles)||!n.wantedTiles[t][e.getKey()])return J_;const s=n.viewState.center,a=r[0]-s[0],o=r[1]-s[1];return 65536*Math.log(i)+Math.sqrt(a*a+o*o)/i}class $X extends tj{constructor(e){e=e||{};const t=Object.assign({},e.params);super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:e.tileClass,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0,this.params_=t,this.v13_=!0,this.serverType_=e.serverType,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.tmpExtent_=Us(),this.updateV13_(),this.setKey(this.getKeyForParams_())}getFeatureInfoUrl(e,t,r,i){const s=ir(r),a=this.getProjection()||s;let o=this.getTileGrid();o||(o=this.getTileGridForProjection(a));const l=wy(e,s,a),c=q_(a,s,e,t),h=o.getZForResolution(c,this.zDirection),f=o.getResolution(h),m=o.getTileCoordForCoordAndZ(l,h);if(o.getResolutions().length<=m[0])return;let y=o.getTileCoordExtent(m,this.tmpExtent_);const x=this.gutter_;x!==0&&(y=M0(y,f*x,y));const _={QUERY_LAYERS:this.params_.LAYERS};Object.assign(_,uN(this.params_,"GetFeatureInfo"),i);const w=Math.floor((l[0]-y[0])/f),S=Math.floor((y[3]-l[1])/f);return _[this.v13_?"I":"X"]=w,_[this.v13_?"J":"Y"]=S,this.getRequestUrl_(m,y,1,a||s,_)}getLegendUrl(e,t){if(this.urls[0]===void 0)return;const r={SERVICE:"WMS",VERSION:bb,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(t===void 0||t.LAYER===void 0){const i=this.params_.LAYERS;if(!(!Array.isArray(i)||i.length===1))return;r.LAYER=i}if(e!==void 0){const i=this.getProjection()?this.getProjection().getMetersPerUnit():1,s=28e-5;r.SCALE=e*i/s}return Object.assign(r,t),qA(this.urls[0],r)}getGutter(){return this.gutter_}getParams(){return this.params_}getRequestUrl_(e,t,r,i,s){const a=this.urls;if(!a)return;let o;if(a.length==1)o=a[0];else{const l=vu(UF(e),a.length);o=a[l]}return jX(t,(this.tileGrid||this.getTileGridForProjection(i)).getResolution(e[0]),r,i,o,s,this.serverType_)}getTilePixelRatio(e){return!this.hidpi_||this.serverType_===void 0?1:e}getKeyForParams_(){let e=0;const t=[];for(const r in this.params_)t[e++]=r+"-"+this.params_[r];return t.join("/")}setParams_(e){this.params_=e,this.updateV13_(),this.setKey(this.getKeyForParams_())}setParams(e){this.setParams_(Object.assign({},e))}updateParams(e){this.setParams_(Object.assign(this.params_,e))}updateV13_(){const e=this.params_.VERSION||bb;this.v13_=PD(e,"1.3")>=0}tileUrlFunction(e,t,r){let i=this.getTileGrid();if(i||(i=this.getTileGridForProjection(r)),i.getResolutions().length<=e[0])return;t!=1&&(!this.hidpi_||this.serverType_===void 0)&&(t=1);const s=i.getResolution(e[0]);let a=i.getTileCoordExtent(e,this.tmpExtent_);const o=this.gutter_;o!==0&&(a=M0(a,s*o,a));const l=Object.assign({},uN(this.params_,"GetMap"));return this.getRequestUrl_(e,a,t,r,l)}}class Kf extends pl{constructor(e,t,r){super(e),this.map=t,this.frameState=r!==void 0?r:null}}class Qc extends Kf{constructor(e,t,r,i,s,a){super(e,t,s),this.originalEvent=r,this.pixel_=null,this.coordinate_=null,this.dragging=i!==void 0?i:!1,this.activePointers=a}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(e){this.pixel_=e}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(e){this.coordinate_=e}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const Or={SINGLECLICK:"singleclick",CLICK:Ht.CLICK,DBLCLICK:Ht.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},Rb={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown"};class WX extends lg{constructor(e,t){super(e),this.map_=e,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=t===void 0?1:t,this.down_=null;const r=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=r,this.pointerdownListenerKey_=fn(r,Rb.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=fn(r,Rb.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(Ht.TOUCHMOVE,this.boundHandleTouchMove_,eF?{passive:!1}:!1)}emulateClick_(e){let t=new Qc(Or.CLICK,this.map_,e);this.dispatchEvent(t),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,t=new Qc(Or.DBLCLICK,this.map_,e),this.dispatchEvent(t)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const r=new Qc(Or.SINGLECLICK,this.map_,e);this.dispatchEvent(r)},250)}updateActivePointers_(e){const t=e,r=t.pointerId;if(t.type==Or.POINTERUP||t.type==Or.POINTERCANCEL){delete this.trackedTouches_[r];for(const i in this.trackedTouches_)if(this.trackedTouches_[i].target!==t.target){delete this.trackedTouches_[i];break}}else(t.type==Or.POINTERDOWN||t.type==Or.POINTERMOVE)&&(this.trackedTouches_[r]=t);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(e){this.updateActivePointers_(e);const t=new Qc(Or.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(t),this.emulateClicks_&&!t.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(or),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(e){return e.button===0}handlePointerDown_(e){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(e);const t=new Qc(Or.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);if(this.dispatchEvent(t),this.down_=new PointerEvent(e.type,e),Object.defineProperty(this.down_,"target",{writable:!1,value:e.target}),this.dragListenerKeys_.length===0){const r=this.map_.getOwnerDocument();this.dragListenerKeys_.push(fn(r,Or.POINTERMOVE,this.handlePointerMove_,this),fn(r,Or.POINTERUP,this.handlePointerUp_,this),fn(this.element_,Or.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==r&&this.dragListenerKeys_.push(fn(this.element_.getRootNode(),Or.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;const t=new Qc(Or.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(t)}}relayMoveEvent_(e){this.originalPointerMoveEvent_=e;const t=!!(this.down_&&this.isMoving_(e));this.dispatchEvent(new Qc(Or.POINTERMOVE,this.map_,e,t))}handleTouchMove_(e){const t=this.originalPointerMoveEvent_;(!t||t.defaultPrevented)&&(typeof e.cancelable!="boolean"||e.cancelable===!0)&&e.preventDefault()}isMoving_(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(or(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(Ht.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(or(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(or),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const eu={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},ns={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};class Bw extends yl{constructor(e){super();const t=e.element;t&&!e.target&&!t.style.pointerEvents&&(t.style.pointerEvents="auto"),this.element=t||null,this.target_=null,this.map_=null,this.listenerKeys=[],e.render&&(this.render=e.render),e.target&&this.setTarget(e.target)}disposeInternal(){this.element?.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(e){this.map_&&this.element?.remove();for(let t=0,r=this.listenerKeys.length;t<r;++t)or(this.listenerKeys[t]);if(this.listenerKeys.length=0,this.map_=e,e){const t=this.target_??e.getOverlayContainerStopEvent();this.element&&t.appendChild(this.element),this.render!==_p&&this.listenerKeys.push(fn(e,eu.POSTRENDER,this.render,this)),e.render()}}render(e){}setTarget(e){this.target_=typeof e=="string"?document.getElementById(e):e}}class HX extends Bw{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=e.collapsible!==void 0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=e.attributions;const t=e.className!==void 0?e.className:"ol-attribution",r=e.tipLabel!==void 0?e.tipLabel:"Attributions",i=e.expandClassName!==void 0?e.expandClassName:t+"-expand",s=e.collapseLabel!==void 0?e.collapseLabel:"",a=e.collapseClassName!==void 0?e.collapseClassName:t+"-collapse";typeof s=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=a):this.collapseLabel_=s;const o=e.label!==void 0?e.label:"i";typeof o=="string"?(this.label_=document.createElement("span"),this.label_.textContent=o,this.label_.className=i):this.label_=o;const l=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=r,this.toggleButton_.appendChild(l),this.toggleButton_.addEventListener(Ht.CLICK,this.handleClick_.bind(this),!1);const c=t+" "+Ty+" "+wA+(this.collapsed_&&this.collapsible_?" "+xM:"")+(this.collapsible_?"":" ol-uncollapsible"),h=this.element;h.className=c,h.appendChild(this.toggleButton_),h.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(e){const t=this.getMap().getAllLayers(),r=new Set(t.flatMap(i=>i.getAttributions(e)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(i=>r.add(i)):r.add(this.attributions_)),!this.overrideCollapsible_){const i=!t.some(s=>s.getSource()?.getAttributionsCollapsible()===!1);this.setCollapsible(i)}return Array.from(r)}async updateElement_(e){if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=await Promise.all(this.collectSourceAttributions_(e).map(i=>ED(()=>i))),r=t.length>0;if(this.renderedVisible_!=r&&(this.element.style.display=r?"":"none",this.renderedVisible_=r),!fc(t,this.renderedAttributions_)){z$(this.ulElement_);for(let i=0,s=t.length;i<s;++i){const a=document.createElement("li");a.innerHTML=t[i],this.ulElement_.appendChild(a)}this.renderedAttributions_=t}}handleClick_(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(xM),this.collapsed_?pM(this.collapseLabel_,this.label_):pM(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(e){this.userCollapsed_=e,!(!this.collapsible_||this.collapsed_===e)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(e){this.updateElement_(e.frameState)}}class KX extends Bw{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target});const t=e.className!==void 0?e.className:"ol-rotate",r=e.label!==void 0?e.label:"",i=e.compassClassName!==void 0?e.compassClassName:"ol-compass";this.label_=null,typeof r=="string"?(this.label_=document.createElement("span"),this.label_.className=i,this.label_.textContent=r):(this.label_=r,this.label_.classList.add(i));const s=e.tipLabel?e.tipLabel:"Reset rotation",a=document.createElement("button");a.className=t+"-reset",a.setAttribute("type","button"),a.title=s,a.appendChild(this.label_),a.addEventListener(Ht.CLICK,this.handleClick_.bind(this),!1);const o=t+" "+Ty+" "+wA,l=this.element;l.className=o,l.appendChild(a),this.callResetNorth_=e.resetNorth?e.resetNorth:void 0,this.duration_=e.duration!==void 0?e.duration:250,this.autoHide_=e.autoHide!==void 0?e.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(xx)}handleClick_(e){e.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const r=t.getRotation();r!==void 0&&(this.duration_>0&&r%(2*Math.PI)!==0?t.animate({rotation:0,duration:this.duration_,easing:cg}):t.setRotation(0))}render(e){const t=e.frameState;if(!t)return;const r=t.viewState.rotation;if(r!=this.rotation_){const i="rotate("+r+"rad)";if(this.autoHide_){const s=this.element.classList.contains(xx);!s&&r===0?this.element.classList.add(xx):s&&r!==0&&this.element.classList.remove(xx)}this.label_.style.transform=i}this.rotation_=r}}class XX extends Bw{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target});const t=e.className!==void 0?e.className:"ol-zoom",r=e.delta!==void 0?e.delta:1,i=e.zoomInClassName!==void 0?e.zoomInClassName:t+"-in",s=e.zoomOutClassName!==void 0?e.zoomOutClassName:t+"-out",a=e.zoomInLabel!==void 0?e.zoomInLabel:"+",o=e.zoomOutLabel!==void 0?e.zoomOutLabel:"",l=e.zoomInTipLabel!==void 0?e.zoomInTipLabel:"Zoom in",c=e.zoomOutTipLabel!==void 0?e.zoomOutTipLabel:"Zoom out",h=document.createElement("button");h.className=i,h.setAttribute("type","button"),h.title=l,h.appendChild(typeof a=="string"?document.createTextNode(a):a),h.addEventListener(Ht.CLICK,this.handleClick_.bind(this,r),!1);const f=document.createElement("button");f.className=s,f.setAttribute("type","button"),f.title=c,f.appendChild(typeof o=="string"?document.createTextNode(o):o),f.addEventListener(Ht.CLICK,this.handleClick_.bind(this,-r),!1);const m=t+" "+Ty+" "+wA,y=this.element;y.className=m,y.appendChild(h),y.appendChild(f),this.duration_=e.duration!==void 0?e.duration:250}handleClick_(e,t){t.preventDefault(),this.zoomByDelta_(e)}zoomByDelta_(e){const r=this.getMap().getView();if(!r)return;const i=r.getZoom();if(i!==void 0){const s=r.getConstrainedZoom(i+e);this.duration_>0?(r.getAnimating()&&r.cancelAnimations(),r.animate({zoom:s,duration:this.duration_,easing:cg})):r.setZoom(s)}}}function qX(n){n=n||{};const e=new La;return(n.zoom===void 0||n.zoom)&&e.push(new XX(n.zoomOptions)),(n.rotate===void 0||n.rotate)&&e.push(new KX(n.rotateOptions)),(n.attribution===void 0||n.attribution)&&e.push(new HX(n.attributionOptions)),e}class YX{constructor(e,t,r){this.decay_=e,this.minVelocity_=t,this.delay_=r,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(e,t){this.points_.push(e,t,Date.now())}end(){if(this.points_.length<6)return!1;const e=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[t+2]<e)return!1;let r=t-3;for(;r>0&&this.points_[r+2]>e;)r-=3;const i=this.points_[t+2]-this.points_[r+2];if(i<1e3/60)return!1;const s=this.points_[t]-this.points_[r],a=this.points_[t+1]-this.points_[r+1];return this.angle_=Math.atan2(a,s),this.initialVelocity_=Math.sqrt(s*s+a*a)/i,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}const hN={ACTIVE:"active"};class Iy extends yl{constructor(e){super(),this.on,this.once,this.un,e&&e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(hN.ACTIVE)}getMap(){return this.map_}handleEvent(e){return!0}setActive(e){this.set(hN.ACTIVE,e)}setMap(e){this.map_=e}}function ZX(n,e,t){const r=n.getCenterInternal();if(r){const i=[r[0]+e[0],r[1]+e[1]];n.animateInternal({duration:t!==void 0?t:250,easing:BH,center:n.getConstrainedCenter(i)})}}function ZA(n,e,t,r){const i=n.getZoom();if(i===void 0)return;const s=n.getConstrainedZoom(i+e),a=n.getResolutionForZoom(s);n.getAnimating()&&n.cancelAnimations(),n.animate({resolution:a,anchor:t,duration:r!==void 0?r:250,easing:cg})}class JX extends Iy{constructor(e){super(),e=e||{},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:250}handleEvent(e){let t=!1;if(e.type==Or.DBLCLICK){const r=e.originalEvent,i=e.map,s=e.coordinate,a=r.shiftKey?-this.delta_:this.delta_,o=i.getView();ZA(o,a,s,this.duration_),r.preventDefault(),t=!0}return!t}}function Ab(n){const e=arguments;return function(t){let r=!0;for(let i=0,s=e.length;i<s&&(r=r&&e[i](t),!!r);++i);return r}}const QX=function(n){const e=n.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},eq=function(n){const e=n.map.getTargetElement(),t=e.getRootNode(),r=n.map.getOwnerDocument().activeElement;return t instanceof ShadowRoot?t.host.contains(r):e.contains(r)},ij=function(n){const e=n.map.getTargetElement(),t=e.getRootNode();return(t instanceof ShadowRoot?t.host:e).hasAttribute("tabindex")?eq(n):!0},tq=xp,sj=function(n){const e=n.originalEvent;return"pointerId"in e&&e.button==0&&!(G$&&JD&&e.ctrlKey)},aj=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},nq=function(n){const e=n.originalEvent;return JD?e.metaKey:e.ctrlKey},rq=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},oj=function(n){const e=n.originalEvent,t=e.target.tagName;return t!=="INPUT"&&t!=="SELECT"&&t!=="TEXTAREA"&&!e.target.isContentEditable},qT=function(n){const e=n.originalEvent;return"pointerId"in e&&e.pointerType=="mouse"},iq=function(n){const e=n.originalEvent;return"pointerId"in e&&e.isPrimary&&e.button===0};class Cy extends Iy{constructor(e){e=e||{},super(e),e.handleDownEvent&&(this.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(this.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(this.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(this.handleUpEvent=e.handleUpEvent),e.stopDown&&(this.stopDown=e.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(e){return!1}handleDragEvent(e){}handleEvent(e){if(!e.originalEvent)return!0;let t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==Or.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==Or.POINTERUP){const r=this.handleUpEvent(e);this.handlingDownUpSequence=r&&this.targetPointers.length>0}}else if(e.type==Or.POINTERDOWN){const r=this.handleDownEvent(e);this.handlingDownUpSequence=r,t=this.stopDown(r)}else e.type==Or.POINTERMOVE&&this.handleMoveEvent(e);return!t}handleMoveEvent(e){}handleUpEvent(e){return!1}stopDown(e){return e}updateTrackedPointers_(e){e.activePointers&&(this.targetPointers=e.activePointers)}}function JA(n){const e=n.length;let t=0,r=0;for(let i=0;i<e;i++)t+=n[i].clientX,r+=n[i].clientY;return{clientX:t/e,clientY:r/e}}class sq extends Cy{constructor(e){super({stopDown:yw}),e=e||{},this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const t=e.condition?e.condition:Ab(aj,iq);this.condition_=e.onFocusOnly?Ab(ij,t):t,this.noKinetic_=!1}handleDragEvent(e){const t=e.map;this.panning_||(this.panning_=!0,t.getView().beginInteraction());const r=this.targetPointers,i=t.getEventPixel(JA(r));if(r.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(i[0],i[1]),this.lastCentroid){const s=[this.lastCentroid[0]-i[0],i[1]-this.lastCentroid[1]],o=e.map.getView();UU(s,o.getResolution()),rA(s,o.getRotation()),o.adjustCenterInternal(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=i,this.lastPointersCount_=r.length,e.originalEvent.preventDefault()}handleUpEvent(e){const t=e.map,r=t.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const i=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),a=r.getCenterInternal(),o=t.getPixelFromCoordinateInternal(a),l=t.getCoordinateFromPixelInternal([o[0]-i*Math.cos(s),o[1]-i*Math.sin(s)]);r.animateInternal({center:r.getConstrainedCenter(l),duration:500,easing:cg})}return this.panning_&&(this.panning_=!1,r.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(e){if(this.targetPointers.length>0&&this.condition_(e)){const r=e.map.getView();return this.lastCentroid=null,r.getAnimating()&&r.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class aq extends Cy{constructor(e){e=e||{},super({stopDown:yw}),this.condition_=e.condition?e.condition:QX,this.lastAngle_=void 0,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){if(!qT(e))return;const t=e.map,r=t.getView();if(r.getConstraints().rotation===NA)return;const i=t.getSize(),s=e.pixel,a=Math.atan2(i[1]/2-s[1],s[0]-i[0]/2);if(this.lastAngle_!==void 0){const o=a-this.lastAngle_;r.adjustRotationInternal(-o)}this.lastAngle_=a}handleUpEvent(e){return qT(e)?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){return qT(e)&&sj(e)&&this.condition_(e)?(e.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class oq extends py{constructor(e){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const e=this.startPixel_,t=this.endPixel_,r="px",i=this.element_.style;i.left=Math.min(e[0],t[0])+r,i.top=Math.min(e[1],t[1])+r,i.width=Math.abs(t[0]-e[0])+r,i.height=Math.abs(t[1]-e[1])+r}setMap(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(e,t){this.startPixel_=e,this.endPixel_=t,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const e=this.startPixel_,t=this.endPixel_,i=[e,[e[0],t[1]],t,[t[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);i[4]=i[0].slice(),this.geometry_?this.geometry_.setCoordinates([i]):this.geometry_=new Ha([i])}getGeometry(){return this.geometry_}}const kf={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class dm extends pl{constructor(e,t,r){super(e),this.coordinate=t,this.mapBrowserEvent=r}}class lq extends Cy{constructor(e){super(),this.on,this.once,this.un,e=e??{},this.box_=new oq(e.className||"ol-dragbox"),this.minArea_=e.minArea??64,e.onBoxEnd&&(this.onBoxEnd=e.onBoxEnd),this.startPixel_=null,this.condition_=e.condition??sj,this.boxEndCondition_=e.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(e,t,r){const i=r[0]-t[0],s=r[1]-t[1];return i*i+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(e){this.startPixel_&&(this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new dm(kf.BOXDRAG,e.coordinate,e)))}handleUpEvent(e){if(!this.startPixel_)return!1;const t=this.boxEndCondition_(e,this.startPixel_,e.pixel);return t&&this.onBoxEnd(e),this.dispatchEvent(new dm(t?kf.BOXEND:kf.BOXCANCEL,e.coordinate,e)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(e){return this.condition_(e)?(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new dm(kf.BOXSTART,e.coordinate,e)),!0):!1}onBoxEnd(e){}setActive(e){e||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new dm(kf.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(e)}setMap(e){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new dm(kf.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(e)}}class cq extends lq{constructor(e){e=e||{};const t=e.condition?e.condition:rq;super({condition:t,className:e.className||"ol-dragzoom",minArea:e.minArea}),this.duration_=e.duration!==void 0?e.duration:200,this.out_=e.out!==void 0?e.out:!1}onBoxEnd(e){const r=this.getMap().getView();let i=this.getGeometry();if(this.out_){const s=r.rotatedExtentForGeometry(i),a=r.getResolutionForExtentInternal(s),o=r.getResolution()/a;i=i.clone(),i.scale(o*o)}r.fitInternal(i,{duration:this.duration_,easing:cg})}}const vh={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class uq extends Iy{constructor(e){super(),e=e||{},this.defaultCondition_=function(t){return aj(t)&&oj(t)},this.condition_=e.condition!==void 0?e.condition:this.defaultCondition_,this.duration_=e.duration!==void 0?e.duration:100,this.pixelDelta_=e.pixelDelta!==void 0?e.pixelDelta:128}handleEvent(e){let t=!1;if(e.type==Ht.KEYDOWN){const r=e.originalEvent,i=r.key;if(this.condition_(e)&&(i==vh.DOWN||i==vh.LEFT||i==vh.RIGHT||i==vh.UP)){const a=e.map.getView(),o=a.getResolution()*this.pixelDelta_;let l=0,c=0;i==vh.DOWN?c=-o:i==vh.LEFT?l=-o:i==vh.RIGHT?l=o:c=o;const h=[l,c];rA(h,a.getRotation()),ZX(a,h,this.duration_),r.preventDefault(),t=!0}}return!t}}class hq extends Iy{constructor(e){super(),e=e||{},this.condition_=e.condition?e.condition:function(t){return!nq(t)&&oj(t)},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:100}handleEvent(e){let t=!1;if(e.type==Ht.KEYDOWN||e.type==Ht.KEYPRESS){const r=e.originalEvent,i=r.key;if(this.condition_(e)&&(i==="+"||i==="-")){const s=e.map,a=i==="+"?this.delta_:-this.delta_,o=s.getView();ZA(o,a,void 0,this.duration_),r.preventDefault(),t=!0}}return!t}}const dq=40,fq=300;class gq extends Iy{constructor(e){e=e||{},super(e),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=e.maxDelta!==void 0?e.maxDelta:1,this.duration_=e.duration!==void 0?e.duration:250,this.timeout_=e.timeout!==void 0?e.timeout:80,this.useAnchor_=e.useAnchor!==void 0?e.useAnchor:!0,this.constrainResolution_=e.constrainResolution!==void 0?e.constrainResolution:!1;const t=e.condition?e.condition:tq;this.condition_=e.onFocusOnly?Ab(ij,t):t,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const e=this.getMap();if(!e)return;e.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(e){if(!this.condition_(e)||e.type!==Ht.WHEEL)return!0;const r=e.map,i=e.originalEvent;i.preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.pixel);let s=i.deltaY;switch(i.deltaMode){case WheelEvent.DOM_DELTA_LINE:s*=dq;break;case WheelEvent.DOM_DELTA_PAGE:s*=fq;break}if(s===0)return!1;this.lastDelta_=s;const a=Date.now();this.startTime_===void 0&&(this.startTime_=a),(!this.mode_||a-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?"trackpad":"wheel");const o=r.getView();if(this.mode_==="trackpad"&&!(o.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(o.getAnimating()&&o.cancelAnimations(),o.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),o.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_?r.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=a,!1;this.totalDelta_+=s;const l=Math.max(this.timeout_-(a-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,r),l),!1}handleWheelZoom_(e){const t=e.getView();t.getAnimating()&&t.cancelAnimations();let r=-ur(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(t.getConstrainResolution()||this.constrainResolution_)&&(r=r?r>0?1:-1:0),ZA(t,r,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(e){this.useAnchor_=e,e||(this.lastAnchor_=null)}}class mq extends Cy{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=yw),super(t),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=e.threshold!==void 0?e.threshold:.3,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){let t=0;const r=this.targetPointers[0],i=this.targetPointers[1],s=Math.atan2(i.clientY-r.clientY,i.clientX-r.clientX);if(this.lastAngle_!==void 0){const l=s-this.lastAngle_;this.rotationDelta_+=l,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),t=l}this.lastAngle_=s;const a=e.map,o=a.getView();o.getConstraints().rotation!==NA&&(this.anchor_=a.getCoordinateFromPixelInternal(a.getEventPixel(JA(this.targetPointers))),this.rotating_&&(a.render(),o.adjustRotationInternal(t,this.anchor_)))}handleUpEvent(e){return this.targetPointers.length<2?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}class pq extends Cy{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=yw),super(t),this.anchor_=null,this.duration_=e.duration!==void 0?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(e){let t=1;const r=this.targetPointers[0],i=this.targetPointers[1],s=r.clientX-i.clientX,a=r.clientY-i.clientY,o=Math.sqrt(s*s+a*a);this.lastDistance_!==void 0&&(t=this.lastDistance_/o),this.lastDistance_=o;const l=e.map,c=l.getView();t!=1&&(this.lastScaleDelta_=t),this.anchor_=l.getCoordinateFromPixelInternal(l.getEventPixel(JA(this.targetPointers))),l.render(),c.adjustResolutionInternal(t,this.anchor_)}handleUpEvent(e){if(this.targetPointers.length<2){const r=e.map.getView(),i=this.lastScaleDelta_>1?1:-1;return r.endInteraction(this.duration_,i),!1}return!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}function yq(n){n=n||{};const e=new La,t=new YX(-.005,.05,100);return(n.altShiftDragRotate===void 0||n.altShiftDragRotate)&&e.push(new aq),(n.doubleClickZoom===void 0||n.doubleClickZoom)&&e.push(new JX({delta:n.zoomDelta,duration:n.zoomDuration})),(n.dragPan===void 0||n.dragPan)&&e.push(new sq({onFocusOnly:n.onFocusOnly,kinetic:t})),(n.pinchRotate===void 0||n.pinchRotate)&&e.push(new mq),(n.pinchZoom===void 0||n.pinchZoom)&&e.push(new pq({duration:n.zoomDuration})),(n.keyboard===void 0||n.keyboard)&&(e.push(new uq),e.push(new hq({delta:n.zoomDelta,duration:n.zoomDuration}))),(n.mouseWheelZoom===void 0||n.mouseWheelZoom)&&e.push(new gq({onFocusOnly:n.onFocusOnly,duration:n.zoomDuration})),(n.shiftDragZoom===void 0||n.shiftDragZoom)&&e.push(new cq({duration:n.zoomDuration})),e}class xq extends py{constructor(e){super(),this.map_=e}dispatchRenderEvent(e,t){Wt()}calculateMatrices2D(e){const t=e.viewState,r=e.coordinateToPixelTransform,i=e.pixelToCoordinateTransform;$a(r,e.size[0]/2,e.size[1]/2,1/t.resolution,-1/t.resolution,-t.rotation,-t.center[0],-t.center[1]),wp(i,r)}forEachFeatureAtCoordinate(e,t,r,i,s,a,o,l){let c;const h=t.viewState;function f(M,O,G,A){return s.call(a,O,M?G:null,A)}const m=h.projection,y=MD(e.slice(),m),x=[[0,0]];if(m.canWrapX()&&i){const M=m.getExtent(),O=gn(M);x.push([-O,0],[O,0])}const _=t.layerStatesArray,w=_.length,S=[],b=[];for(let M=0;M<x.length;M++)for(let O=w-1;O>=0;--O){const G=_[O],A=G.layer;if(A.hasRenderer()&&OA(G,h)&&o.call(l,A)){const I=A.getRenderer(),P=A.getSource();if(I&&P){const D=P.getWrapX()?y:e,L=f.bind(null,G.managed);b[0]=D[0]+x[M][0],b[1]=D[1]+x[M][1],c=I.forEachFeatureAtCoordinate(b,t,r,L,S)}if(c)return c}}if(S.length===0)return;const R=1/S.length;return S.forEach((M,O)=>M.distanceSq+=O*R),S.sort((M,O)=>M.distanceSq-O.distanceSq),S.some(M=>c=M.callback(M.feature,M.layer,M.geometry)),c}hasFeatureAtCoordinate(e,t,r,i,s,a){return this.forEachFeatureAtCoordinate(e,t,r,i,xp,this,s,a)!==void 0}getMap(){return this.map_}renderFrame(e){Wt()}scheduleExpireIconCache(e){Da.canExpireCache()&&e.postRenderFunctions.push(_q)}}function _q(n,e){Da.expire()}class vq extends xq{constructor(e){super(e),this.fontChangeListenerKey_=fn(Bf,P0.PROPERTYCHANGE,e.redrawText,e),this.element_=ha?tF():document.createElement("div");const t=this.element_.style;t.position="absolute",t.width="100%",t.height="100%",t.zIndex="0",this.element_.className=Ty+" ol-layers";const r=e.getViewport();r&&r.insertBefore(this.element_,r.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(e,t){const r=this.getMap();if(r.hasListener(e)){const i=new Gm(e,void 0,t);r.dispatchEvent(i)}}disposeInternal(){or(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(e){if(!e){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(e),this.dispatchRenderEvent(Si.PRECOMPOSE,e);const t=e.layerStatesArray.sort((c,h)=>c.zIndex-h.zIndex);t.some(c=>c.layer instanceof Lw&&c.layer.getDeclutter())&&(e.declutter={});const i=e.viewState;this.children_.length=0;const s=[];let a=null;for(let c=0,h=t.length;c<h;++c){const f=t[c];e.layerIndex=c;const m=f.layer,y=m.getSourceState();if(!OA(f,i)||y!="ready"&&y!="undefined"){m.unrender();continue}const x=m.render(e,a);x&&(x!==a&&(this.children_.push(x),a=x),s.push(f))}this.declutter(e,s),U$(this.element_,this.children_);const l=this.getMap().getTargetElement();if(hu(l)){const c=l.getContext("2d");for(const h of this.children_){const f=h.firstElementChild||h,m=h.style.backgroundColor;if(m&&(!hu(f)||f.width>0)&&(c.fillStyle=m,c.fillRect(0,0,l.width,l.height)),hu(f)&&f.width>0){const y=h.style.opacity||f.style.opacity;c.globalAlpha=y===""?1:Number(y);const x=f.style.transform;if(x)c.setTransform(...ub(x));else{const _=parseFloat(f.style.width)/f.width,w=parseFloat(f.style.height)/f.height;c.setTransform(_,0,0,w,0,0)}c.drawImage(f,0,0)}}c.globalAlpha=1,c.setTransform(1,0,0,1,0,0)}this.dispatchRenderEvent(Si.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}declutter(e,t){if(e.declutter){for(let r=t.length-1;r>=0;--r){const i=t[r],s=i.layer;s.getDeclutter()&&s.renderDeclutter(e,i)}t.forEach(r=>r.layer.renderDeferred(e))}}}function lj(n){if(n instanceof Ay){n.setMapInternal(null);return}n instanceof Ow&&n.getLayers().forEach(lj)}function cj(n,e){if(n instanceof Ay){n.setMapInternal(e);return}if(n instanceof Ow){const t=n.getLayers().getArray();for(let r=0,i=t.length;r<i;++r)cj(t[r],e)}}let wq=class extends yl{constructor(e){super(),e=e||{},this.on,this.once,this.un;const t=Eq(e);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=e.maxTilesLoading!==void 0?e.maxTilesLoading:16,this.pixelRatio_=e.pixelRatio!==void 0?e.pixelRatio:B$,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=ti(),this.pixelToCoordinateTransform_=ti(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,ha||(this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_)),this.mapBrowserEventHandler_=null,this.moveTolerance_=e.moveTolerance,this.keyboardEventTarget_=t.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,ha||(this.resizeObserver_=new ResizeObserver(()=>this.updateSize())),this.controls=t.controls||(ha?new La:qX()),this.interactions=t.interactions||(ha?new La:yq({onFocusOnly:!0})),this.overlays_=t.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new zX(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(ns.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(ns.VIEW,this.handleViewChanged_),this.addChangeListener(ns.SIZE,this.handleSizeChanged_),this.addChangeListener(ns.TARGET,this.handleTargetChanged_),this.setProperties(t.values);const r=this;e.view&&!(e.view instanceof Zo)&&e.view.then(function(i){r.setView(new Zo(i))}),this.controls.addEventListener(Os.ADD,i=>{i.element.setMap(this)}),this.controls.addEventListener(Os.REMOVE,i=>{i.element.setMap(null)}),this.interactions.addEventListener(Os.ADD,i=>{i.element.setMap(this)}),this.interactions.addEventListener(Os.REMOVE,i=>{i.element.setMap(null)}),this.overlays_.addEventListener(Os.ADD,i=>{this.addOverlayInternal_(i.element)}),this.overlays_.addEventListener(Os.REMOVE,i=>{const s=i.element.getId();s!==void 0&&delete this.overlayIdIndex_[s.toString()],i.element.setMap(null)}),this.controls.forEach(i=>{i.setMap(this)}),this.interactions.forEach(i=>{i.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(e){this.getControls().push(e)}addInteraction(e){this.getInteractions().push(e)}addLayer(e){this.getLayerGroup().getLayers().push(e)}handleLayerAdd_(e){cj(e.layer,this)}addOverlay(e){this.getOverlays().push(e)}addOverlayInternal_(e){const t=e.getId();t!==void 0&&(this.overlayIdIndex_[t.toString()]=e),e.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_?.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(e,t,r){if(!this.frameState_||!this.renderer_)return;const i=this.getCoordinateFromPixelInternal(e);r=r!==void 0?r:{};const s=r.hitTolerance!==void 0?r.hitTolerance:0,a=r.layerFilter!==void 0?r.layerFilter:xp,o=r.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(i,this.frameState_,s,o,t,null,a,null)}getFeaturesAtPixel(e,t){const r=[];return this.forEachFeatureAtPixel(e,function(i){r.push(i)},t),r}getAllLayers(){const e=[];function t(r){r.forEach(function(i){i instanceof Ow?t(i.getLayers()):e.push(i)})}return t(this.getLayers()),e}hasFeatureAtPixel(e,t){if(!this.frameState_||!this.renderer_)return!1;const r=this.getCoordinateFromPixelInternal(e);t=t!==void 0?t:{};const i=t.layerFilter!==void 0?t.layerFilter:xp,s=t.hitTolerance!==void 0?t.hitTolerance:0,a=t.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(r,this.frameState_,s,a,i,null)}getEventCoordinate(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}getEventCoordinateInternal(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}getEventPixel(e){const r=this.viewport_.getBoundingClientRect(),i=this.getSize(),s=r.width/i[0],a=r.height/i[1],o="changedTouches"in e?e.changedTouches[0]:e;return[(o.clientX-r.left)/s,(o.clientY-r.top)/a]}getTarget(){return this.get(ns.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(e){return cb(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}getCoordinateFromPixelInternal(e){const t=this.frameState_;return t?kr(t.pixelToCoordinateTransform,e.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(e){const t=this.overlayIdIndex_[e.toString()];return t!==void 0?t:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(ns.LAYERGROUP)}setLayers(e){const t=this.getLayerGroup();if(e instanceof La){t.setLayers(e);return}const r=t.getLayers();r.clear(),r.extend(e)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const e=this.getLayerGroup().getLayerStatesArray();for(let t=0,r=e.length;t<r;++t){const i=e[t];if(!i.visible)continue;const s=i.layer.getRenderer();if(s&&!s.ready)return!0;const a=i.layer.getSource();if(a&&a.loading)return!0}return!1}getPixelFromCoordinate(e){const t=Vl(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(t)}getPixelFromCoordinateInternal(e){const t=this.frameState_;return t?kr(t.coordinateToPixelTransform,e.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(ns.SIZE)}getView(){return this.get(ns.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const e=this.getTargetElement();return e?e.ownerDocument:document}getTilePriority(e,t,r,i){return UX(this.frameState_,e,t,r,i)}handleBrowserEvent(e,t){t=t||e.type;const r=new Qc(t,this,e);this.handleMapBrowserEvent(r)}handleMapBrowserEvent(e){if(!this.frameState_)return;const t=e.originalEvent,r=t.type;if(r===Rb.POINTERDOWN||r===Ht.WHEEL||r===Ht.KEYDOWN){const i=this.getOwnerDocument(),s=this.viewport_.getRootNode?this.viewport_.getRootNode():i,a=t.target,o=s instanceof ShadowRoot?s.host===a?s.host.ownerDocument:s:s===i?i.documentElement:s;if(this.overlayContainerStopEvent_.contains(a)||!o.contains(a))return}if(e.frameState=this.frameState_,this.dispatchEvent(e)!==!1){const i=this.getInteractions().getArray().slice();for(let s=i.length-1;s>=0;s--){const a=i[s];if(a.getMap()!==this||!a.getActive()||!this.getTargetElement())continue;if(!a.handleEvent(e)||e.propagationStopped)break}}}handlePostRender(){const e=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){let i=this.maxTilesLoading_,s=i;if(e){const a=e.viewHints;if(a[Jr.ANIMATING]||a[Jr.INTERACTING]){const o=Date.now()-e.time>8;i=o?0:8,s=o?0:2}}t.getTilesLoading()<i&&(t.reprioritize(),t.loadMoreTiles(i,s))}e&&this.renderer_&&!e.animate&&(this.renderComplete_?(this.hasListener(Si.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(Si.RENDERCOMPLETE,e),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new Kf(eu.LOADEND,this,e)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new Kf(eu.LOADSTART,this,e))));const r=this.postRenderFunctions_;if(e)for(let i=0,s=r.length;i<s;++i)r[i](this,e);r.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let r=0,i=this.targetChangeHandlerKeys_.length;r<i;++r)or(this.targetChangeHandlerKeys_[r]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(Ht.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(Ht.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_&&!hu(this.targetElement_)){this.resizeObserver_?.unobserve(this.targetElement_);const r=this.targetElement_.getRootNode();r instanceof ShadowRoot&&this.resizeObserver_.unobserve(r.host),this.setSize(void 0)}const e=this.getTarget(),t=typeof e=="string"?document.getElementById(e):e;if(this.targetElement_=t,!t)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{if(hu(t)||t.appendChild(this.viewport_),this.renderer_||(this.renderer_=new vq(this)),!hu(t)){this.mapBrowserEventHandler_=new WX(this,this.moveTolerance_);for(const i in Or)this.mapBrowserEventHandler_.addEventListener(Or[i],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(Ht.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(Ht.WHEEL,this.boundHandleBrowserEvent_,eF?{passive:!1}:!1);let r;if(this.keyboardEventTarget_)r=this.keyboardEventTarget_;else{const i=t.getRootNode();r=i instanceof ShadowRoot?i.host:t}if(this.targetChangeHandlerKeys_=[fn(r,Ht.KEYDOWN,this.handleBrowserEvent,this),fn(r,Ht.KEYPRESS,this.handleBrowserEvent,this)],t instanceof HTMLElement){const i=t.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.observe(i.host),this.resizeObserver_?.observe(t)}}this.updateSize()}}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(or(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(or(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const e=this.getView();e&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=fn(e,P0.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=fn(e,Ht.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(or),this.layerGroupPropertyListenerKeys_=null);const e=this.getLayerGroup();e&&(this.handleLayerAdd_(new nu("addlayer",e)),this.layerGroupPropertyListenerKeys_=[fn(e,P0.PROPERTYCHANGE,this.render,this),fn(e,Ht.CHANGE,this.render,this),fn(e,"addlayer",this.handleLayerAdd_,this),fn(e,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;const e=this.frameState_.layerStatesArray;for(let t=0,r=e.length;t<r;++t){const i=e[t].layer;i.hasRenderer()&&i.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(e){return this.getControls().remove(e)}removeInteraction(e){return this.getInteractions().remove(e)}removeLayer(e){return this.getLayerGroup().getLayers().remove(e)}handleLayerRemove_(e){lj(e.layer)}removeOverlay(e){return this.getOverlays().remove(e)}renderFrame_(e){const t=this.getSize(),r=this.getView(),i=this.frameState_;let s=null;if(t!==void 0&&kM(t)&&r&&r.isDef()){const a=r.getHints(this.frameState_?this.frameState_.viewHints:void 0),o=r.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:M_(o.center,o.resolution,o.rotation,t),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:t,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:o,viewHints:a,wantedTiles:{},mapId:Bt(this),renderTargets:{}},o.nextCenter&&o.nextResolution){const l=isNaN(o.nextRotation)?o.rotation:o.nextRotation;s.nextExtent=M_(o.nextCenter,o.nextResolution,l,t)}}this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),i&&(!this.previousExtent_||!Ad(this.previousExtent_)&&!rd(s.extent,this.previousExtent_))&&(this.dispatchEvent(new Kf(eu.MOVESTART,this,i)),this.previousExtent_=xy(this.previousExtent_)),this.previousExtent_&&!s.viewHints[Jr.ANIMATING]&&!s.viewHints[Jr.INTERACTING]&&!rd(s.extent,this.previousExtent_)&&(this.dispatchEvent(new Kf(eu.MOVEEND,this,s)),SD(s.extent,this.previousExtent_))),this.dispatchEvent(new Kf(eu.POSTRENDER,this,s)),this.renderComplete_=(this.hasListener(eu.LOADSTART)||this.hasListener(eu.LOADEND)||this.hasListener(Si.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(e){const t=this.getLayerGroup();t&&this.handleLayerRemove_(new nu("removelayer",t)),this.set(ns.LAYERGROUP,e)}setSize(e){this.set(ns.SIZE,e)}setTarget(e){this.set(ns.TARGET,e)}setView(e){if(!e||e instanceof Zo){this.set(ns.VIEW,e);return}this.set(ns.VIEW,new Zo);const t=this;e.then(function(r){t.setView(new Zo(r))})}updateSize(){const e=this.getTargetElement();let t;if(e){let i,s;if(hu(e))i=e.width,s=e.height;else{const a=getComputedStyle(e);i=e.offsetWidth-parseFloat(a.borderLeftWidth)-parseFloat(a.paddingLeft)-parseFloat(a.paddingRight)-parseFloat(a.borderRightWidth),s=e.offsetHeight-parseFloat(a.borderTopWidth)-parseFloat(a.paddingTop)-parseFloat(a.paddingBottom)-parseFloat(a.borderBottomWidth)}!isNaN(i)&&!isNaN(s)&&(t=[Math.max(0,i),Math.max(0,s)],!kM(t)&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&LD("No map visible because the map container's width or height are 0."))}const r=this.getSize();t&&(!r||!fc(t,r))&&(this.setSize(t),this.updateViewportSize_(t))}updateViewportSize_(e){const t=this.getView();t&&t.setViewportSize(e)}};function Eq(n){let e=null;n.keyboardEventTarget!==void 0&&(e=typeof n.keyboardEventTarget=="string"?document.getElementById(n.keyboardEventTarget):n.keyboardEventTarget);const t={},r=n.layers&&typeof n.layers.getLayers=="function"?n.layers:new Ow({layers:n.layers});t[ns.LAYERGROUP]=r,t[ns.TARGET]=n.target,t[ns.VIEW]=n.view instanceof Zo?n.view:new Zo;let i;n.controls!==void 0&&(Array.isArray(n.controls)?i=new La(n.controls.slice()):(bn(typeof n.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),i=n.controls));let s;n.interactions!==void 0&&(Array.isArray(n.interactions)?s=new La(n.interactions.slice()):(bn(typeof n.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),s=n.interactions));let a;return n.overlays!==void 0?Array.isArray(n.overlays)?a=new La(n.overlays.slice()):(bn(typeof n.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),a=n.overlays):a=new La,{controls:i,interactions:s,keyboardEventTarget:e,overlays:a,values:t}}const YT="units",Tq=[1,2,5],fm=25.4/.28;class Sq extends Bw{constructor(e){e=e||{};const t=document.createElement("div");t.style.pointerEvents="none",super({element:t,render:e.render,target:e.target}),this.on,this.once,this.un;const r=e.className!==void 0?e.className:e.bar?"ol-scale-bar":"ol-scale-line";this.innerElement_=document.createElement("div"),this.innerElement_.className=r+"-inner",this.element.className=r+" "+Ty,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=e.minWidth!==void 0?e.minWidth:64,this.maxWidth_=e.maxWidth,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",this.addChangeListener(YT,this.handleUnitsChanged_),this.setUnits(e.units||"metric"),this.scaleBar_=e.bar||!1,this.scaleBarSteps_=e.steps||4,this.scaleBarText_=e.text||!1,this.dpi_=e.dpi||void 0}getUnits(){return this.get(YT)}handleUnitsChanged_(){this.updateElement_()}setUnits(e){this.set(YT,e)}setDpi(e){this.dpi_=e}updateElement_(){const e=this.viewState_;if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=e.center,r=e.projection,i=this.getUnits(),s=i=="degrees"?"degrees":"m";let a=j_(r,e.resolution,t,s);const o=this.minWidth_*(this.dpi_||fm)/fm,l=this.maxWidth_!==void 0?this.maxWidth_*(this.dpi_||fm)/fm:void 0;let c=o*a,h="";if(i=="degrees"){const R=N0.degrees;c*=R,c<R/60?(h="",a*=3600):c<R?(h="",a*=60):h=""}else if(i=="imperial")c<.9144?(h="in",a/=.0254):c<1609.344?(h="ft",a/=.3048):(h="mi",a/=1609.344);else if(i=="nautical")a/=1852,h="NM";else if(i=="metric")c<1e-6?(h="nm",a*=1e9):c<.001?(h="m",a*=1e6):c<1?(h="mm",a*=1e3):c<1e3?h="m":(h="km",a/=1e3);else if(i=="us")c<.9144?(h="in",a*=39.37):c<1609.344?(h="ft",a/=.30480061):(h="mi",a/=1609.3472);else throw new Error("Invalid units");let f=3*Math.floor(Math.log(o*a)/Math.log(10)),m,y,x,_=0,w,S;for(;;){x=Math.floor(f/3);const R=Math.pow(10,x);if(m=Tq[(f%3+3)%3]*R,y=Math.round(m/a),isNaN(y)){this.element.style.display="none",this.renderedVisible_=!1;return}if(l!==void 0&&y>=l){m=_,y=w,x=S;break}else if(y>=o)break;_=m,w=y,S=x,++f}const b=this.scaleBar_?this.createScaleBar(y,m,h):m.toFixed(x<0?-x:0)+" "+h;this.renderedHTML_!=b&&(this.innerElement_.innerHTML=b,this.renderedHTML_=b),this.renderedWidth_!=y&&(this.innerElement_.style.width=y+"px",this.renderedWidth_=y),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}createScaleBar(e,t,r){const i=this.getScaleForResolution(),s=i<1?Math.round(1/i).toLocaleString()+" : 1":"1 : "+Math.round(i).toLocaleString(),a=this.scaleBarSteps_,o=e/a,l=[this.createMarker("absolute")];for(let h=0;h<a;++h){const f=h%2===0?"ol-scale-singlebar-odd":"ol-scale-singlebar-even";l.push(`<div><div class="ol-scale-singlebar ${f}" style="width: ${o}px;"></div>`+this.createMarker("relative")+(h%2===0||a===2?this.createStepText(h,e,!1,t,r):"")+"</div>")}return l.push(this.createStepText(a,e,!0,t,r)),(this.scaleBarText_?`<div class="ol-scale-text" style="width: ${e}px;">`+s+"</div>":"")+l.join("")}createMarker(e){return`<div class="ol-scale-step-marker" style="position: ${e}; top: ${e==="absolute"?3:-10}px;"></div>`}createStepText(e,t,r,i,s){const o=(e===0?0:Math.round(i/this.scaleBarSteps_*e*100)/100)+(e===0?"":" "+s),l=e===0?-3:t/this.scaleBarSteps_*-1,c=e===0?0:t/this.scaleBarSteps_*2;return`<div class="ol-scale-step-text" style="margin-left: ${l}px;text-align: ${e===0?"left":"center"};min-width: ${c}px;left: ${r?t+"px":"unset"};">`+o+"</div>"}getScaleForResolution(){const e=j_(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,"m"),t=this.dpi_||fm,r=1e3/25.4;return e*r*t}render(e){const t=e.frameState;t?this.viewState_=t.viewState:this.viewState_=null,this.updateElement_()}}const bq={},dN=n=>{let e;const t=new Set,r=(h,f)=>{const m=typeof h=="function"?h(e):h;if(!Object.is(m,e)){const y=e;e=f??(typeof m!="object"||m===null)?m:Object.assign({},e,m),t.forEach(x=>x(e,y))}},i=()=>e,l={setState:r,getState:i,getInitialState:()=>c,subscribe:h=>(t.add(h),()=>t.delete(h)),destroy:()=>{(bq?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},c=e=n(r,i,l);return l},Rq=n=>n?dN(n):dN;var ZT={exports:{}},JT={},QT={exports:{}},eS={};var fN;function Aq(){if(fN)return eS;fN=1;var n=my();function e(f,m){return f===m&&(f!==0||1/f===1/m)||f!==f&&m!==m}var t=typeof Object.is=="function"?Object.is:e,r=n.useState,i=n.useEffect,s=n.useLayoutEffect,a=n.useDebugValue;function o(f,m){var y=m(),x=r({inst:{value:y,getSnapshot:m}}),_=x[0].inst,w=x[1];return s(function(){_.value=y,_.getSnapshot=m,l(_)&&w({inst:_})},[f,y,m]),i(function(){return l(_)&&w({inst:_}),f(function(){l(_)&&w({inst:_})})},[f]),a(y),y}function l(f){var m=f.getSnapshot;f=f.value;try{var y=m();return!t(f,y)}catch{return!0}}function c(f,m){return m()}var h=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:o;return eS.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:h,eS}var gN;function Iq(){return gN||(gN=1,QT.exports=Aq()),QT.exports}var mN;function Cq(){if(mN)return JT;mN=1;var n=my(),e=Iq();function t(c,h){return c===h&&(c!==0||1/c===1/h)||c!==c&&h!==h}var r=typeof Object.is=="function"?Object.is:t,i=e.useSyncExternalStore,s=n.useRef,a=n.useEffect,o=n.useMemo,l=n.useDebugValue;return JT.useSyncExternalStoreWithSelector=function(c,h,f,m,y){var x=s(null);if(x.current===null){var _={hasValue:!1,value:null};x.current=_}else _=x.current;x=o(function(){function S(G){if(!b){if(b=!0,R=G,G=m(G),y!==void 0&&_.hasValue){var A=_.value;if(y(A,G))return M=A}return M=G}if(A=M,r(R,G))return A;var I=m(G);return y!==void 0&&y(A,I)?(R=G,A):(R=G,M=I)}var b=!1,R,M,O=f===void 0?null:f;return[function(){return S(h())},O===null?void 0:function(){return S(O())}]},[h,f,m,y]);var w=i(c,x[0],x[1]);return a(function(){_.hasValue=!0,_.value=w},[w]),l(w),w},JT}var pN;function kq(){return pN||(pN=1,ZT.exports=Cq()),ZT.exports}var Pq=kq();const Mq=QR(Pq),uj={},{useDebugValue:Nq}=CU,{useSyncExternalStoreWithSelector:Lq}=Mq;let yN=!1;const Oq=n=>n;function Dq(n,e=Oq,t){(uj?"production":void 0)!=="production"&&t&&!yN&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),yN=!0);const r=Lq(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return Nq(r),r}const Fq=n=>{(uj?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?Rq(n):n,t=(r,i)=>Dq(e,r,i);return Object.assign(t,e),t},ms=n=>Fq;var hj=Symbol.for("immer-nothing"),xN=Symbol.for("immer-draftable"),ga=Symbol.for("immer-state");function ho(n,...e){throw new Error(`[Immer] minified error nr: ${n}. Full error at: https://bit.ly/3cXEKWf`)}var Np=Object.getPrototypeOf;function j0(n){return!!n&&!!n[ga]}function od(n){return n?dj(n)||Array.isArray(n)||!!n[xN]||!!n.constructor?.[xN]||ky(n)||Uw(n):!1}var jq=Object.prototype.constructor.toString(),_N=new WeakMap;function dj(n){if(!n||typeof n!="object")return!1;const e=Object.getPrototypeOf(n);if(e===null||e===Object.prototype)return!0;const t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(t===Object)return!0;if(typeof t!="function")return!1;let r=_N.get(t);return r===void 0&&(r=Function.toString.call(t),_N.set(t,r)),r===jq}function Q_(n,e,t=!0){zw(n)===0?(t?Reflect.ownKeys(n):Object.keys(n)).forEach(i=>{e(i,n[i],n)}):n.forEach((r,i)=>e(i,r,n))}function zw(n){const e=n[ga];return e?e.type_:Array.isArray(n)?1:ky(n)?2:Uw(n)?3:0}function Ib(n,e){return zw(n)===2?n.has(e):Object.prototype.hasOwnProperty.call(n,e)}function fj(n,e,t){const r=zw(n);r===2?n.set(e,t):r===3?n.add(t):n[e]=t}function Vq(n,e){return n===e?n!==0||1/n===1/e:n!==n&&e!==e}function ky(n){return n instanceof Map}function Uw(n){return n instanceof Set}function bh(n){return n.copy_||n.base_}function Cb(n,e){if(ky(n))return new Map(n);if(Uw(n))return new Set(n);if(Array.isArray(n))return Array.prototype.slice.call(n);const t=dj(n);if(e===!0||e==="class_only"&&!t){const r=Object.getOwnPropertyDescriptors(n);delete r[ga];let i=Reflect.ownKeys(r);for(let s=0;s<i.length;s++){const a=i[s],o=r[a];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(r[a]={configurable:!0,writable:!0,enumerable:o.enumerable,value:n[a]})}return Object.create(Np(n),r)}else{const r=Np(n);if(r!==null&&t)return{...n};const i=Object.create(r);return Object.assign(i,n)}}function QA(n,e=!1){return $w(n)||j0(n)||!od(n)||(zw(n)>1&&Object.defineProperties(n,{set:Ax,add:Ax,clear:Ax,delete:Ax}),Object.freeze(n),e&&Object.values(n).forEach(t=>QA(t,!0))),n}function Gq(){ho(2)}var Ax={value:Gq};function $w(n){return n===null||typeof n!="object"?!0:Object.isFrozen(n)}var Bq={};function ld(n){const e=Bq[n];return e||ho(0,n),e}var Lp;function gj(){return Lp}function zq(n,e){return{drafts_:[],parent_:n,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function vN(n,e){e&&(ld("Patches"),n.patches_=[],n.inversePatches_=[],n.patchListener_=e)}function kb(n){Pb(n),n.drafts_.forEach(Uq),n.drafts_=null}function Pb(n){n===Lp&&(Lp=n.parent_)}function wN(n){return Lp=zq(Lp,n)}function Uq(n){const e=n[ga];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function EN(n,e){e.unfinalizedDrafts_=e.drafts_.length;const t=e.drafts_[0];return n!==void 0&&n!==t?(t[ga].modified_&&(kb(e),ho(4)),od(n)&&(n=ev(e,n),e.parent_||tv(e,n)),e.patches_&&ld("Patches").generateReplacementPatches_(t[ga].base_,n,e.patches_,e.inversePatches_)):n=ev(e,t,[]),kb(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),n!==hj?n:void 0}function ev(n,e,t){if($w(e))return e;const r=n.immer_.shouldUseStrictIteration(),i=e[ga];if(!i)return Q_(e,(s,a)=>TN(n,i,e,s,a,t),r),e;if(i.scope_!==n)return e;if(!i.modified_)return tv(n,i.base_,!0),i.base_;if(!i.finalized_){i.finalized_=!0,i.scope_.unfinalizedDrafts_--;const s=i.copy_;let a=s,o=!1;i.type_===3&&(a=new Set(s),s.clear(),o=!0),Q_(a,(l,c)=>TN(n,i,s,l,c,t,o),r),tv(n,s,!1),t&&n.patches_&&ld("Patches").generatePatches_(i,t,n.patches_,n.inversePatches_)}return i.copy_}function TN(n,e,t,r,i,s,a){if(i==null||typeof i!="object"&&!a)return;const o=$w(i);if(!(o&&!a)){if(j0(i)){const l=s&&e&&e.type_!==3&&!Ib(e.assigned_,r)?s.concat(r):void 0,c=ev(n,i,l);if(fj(t,r,c),j0(c))n.canAutoFreeze_=!1;else return}else a&&t.add(i);if(od(i)&&!o){if(!n.immer_.autoFreeze_&&n.unfinalizedDrafts_<1||e&&e.base_&&e.base_[r]===i&&o)return;ev(n,i),(!e||!e.scope_.parent_)&&typeof r!="symbol"&&(ky(t)?t.has(r):Object.prototype.propertyIsEnumerable.call(t,r))&&tv(n,i)}}}function tv(n,e,t=!1){!n.parent_&&n.immer_.autoFreeze_&&n.canAutoFreeze_&&QA(e,t)}function $q(n,e){const t=Array.isArray(n),r={type_:t?1:0,scope_:e?e.scope_:gj(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:n,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=r,s=eI;t&&(i=[r],s=Op);const{revoke:a,proxy:o}=Proxy.revocable(i,s);return r.draft_=o,r.revoke_=a,o}var eI={get(n,e){if(e===ga)return n;const t=bh(n);if(!Ib(t,e))return Wq(n,t,e);const r=t[e];return n.finalized_||!od(r)?r:r===tS(n.base_,e)?(nS(n),n.copy_[e]=Nb(r,n)):r},has(n,e){return e in bh(n)},ownKeys(n){return Reflect.ownKeys(bh(n))},set(n,e,t){const r=mj(bh(n),e);if(r?.set)return r.set.call(n.draft_,t),!0;if(!n.modified_){const i=tS(bh(n),e),s=i?.[ga];if(s&&s.base_===t)return n.copy_[e]=t,n.assigned_[e]=!1,!0;if(Vq(t,i)&&(t!==void 0||Ib(n.base_,e)))return!0;nS(n),Mb(n)}return n.copy_[e]===t&&(t!==void 0||e in n.copy_)||Number.isNaN(t)&&Number.isNaN(n.copy_[e])||(n.copy_[e]=t,n.assigned_[e]=!0),!0},deleteProperty(n,e){return tS(n.base_,e)!==void 0||e in n.base_?(n.assigned_[e]=!1,nS(n),Mb(n)):delete n.assigned_[e],n.copy_&&delete n.copy_[e],!0},getOwnPropertyDescriptor(n,e){const t=bh(n),r=Reflect.getOwnPropertyDescriptor(t,e);return r&&{writable:!0,configurable:n.type_!==1||e!=="length",enumerable:r.enumerable,value:t[e]}},defineProperty(){ho(11)},getPrototypeOf(n){return Np(n.base_)},setPrototypeOf(){ho(12)}},Op={};Q_(eI,(n,e)=>{Op[n]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Op.deleteProperty=function(n,e){return Op.set.call(this,n,e,void 0)};Op.set=function(n,e,t){return eI.set.call(this,n[0],e,t,n[0])};function tS(n,e){const t=n[ga];return(t?bh(t):n)[e]}function Wq(n,e,t){const r=mj(e,t);return r?"value"in r?r.value:r.get?.call(n.draft_):void 0}function mj(n,e){if(!(e in n))return;let t=Np(n);for(;t;){const r=Object.getOwnPropertyDescriptor(t,e);if(r)return r;t=Np(t)}}function Mb(n){n.modified_||(n.modified_=!0,n.parent_&&Mb(n.parent_))}function nS(n){n.copy_||(n.copy_=Cb(n.base_,n.scope_.immer_.useStrictShallowCopy_))}var Hq=class{constructor(n){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,t,r)=>{if(typeof e=="function"&&typeof t!="function"){const s=t;t=e;const a=this;return function(l=s,...c){return a.produce(l,h=>t.call(this,h,...c))}}typeof t!="function"&&ho(6),r!==void 0&&typeof r!="function"&&ho(7);let i;if(od(e)){const s=wN(this),a=Nb(e,void 0);let o=!0;try{i=t(a),o=!1}finally{o?kb(s):Pb(s)}return vN(s,r),EN(i,s)}else if(!e||typeof e!="object"){if(i=t(e),i===void 0&&(i=e),i===hj&&(i=void 0),this.autoFreeze_&&QA(i,!0),r){const s=[],a=[];ld("Patches").generateReplacementPatches_(e,i,s,a),r(s,a)}return i}else ho(1,e)},this.produceWithPatches=(e,t)=>{if(typeof e=="function")return(a,...o)=>this.produceWithPatches(a,l=>e(l,...o));let r,i;return[this.produce(e,t,(a,o)=>{r=a,i=o}),r,i]},typeof n?.autoFreeze=="boolean"&&this.setAutoFreeze(n.autoFreeze),typeof n?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(n.useStrictShallowCopy),typeof n?.useStrictIteration=="boolean"&&this.setUseStrictIteration(n.useStrictIteration)}createDraft(n){od(n)||ho(8),j0(n)&&(n=Kq(n));const e=wN(this),t=Nb(n,void 0);return t[ga].isManual_=!0,Pb(e),t}finishDraft(n,e){const t=n&&n[ga];(!t||!t.isManual_)&&ho(9);const{scope_:r}=t;return vN(r,e),EN(void 0,r)}setAutoFreeze(n){this.autoFreeze_=n}setUseStrictShallowCopy(n){this.useStrictShallowCopy_=n}setUseStrictIteration(n){this.useStrictIteration_=n}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(n,e){let t;for(t=e.length-1;t>=0;t--){const i=e[t];if(i.path.length===0&&i.op==="replace"){n=i.value;break}}t>-1&&(e=e.slice(t+1));const r=ld("Patches").applyPatches_;return j0(n)?r(n,e):this.produce(n,i=>r(i,e))}};function Nb(n,e){const t=ky(n)?ld("MapSet").proxyMap_(n,e):Uw(n)?ld("MapSet").proxySet_(n,e):$q(n,e);return(e?e.scope_:gj()).drafts_.push(t),t}function Kq(n){return j0(n)||ho(10,n),pj(n)}function pj(n){if(!od(n)||$w(n))return n;const e=n[ga];let t,r=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,t=Cb(n,e.scope_.immer_.useStrictShallowCopy_),r=e.scope_.immer_.shouldUseStrictIteration()}else t=Cb(n,!0);return Q_(t,(i,s)=>{fj(t,i,pj(s))},r),e&&(e.finalized_=!1),t}var Xq=new Hq,qq=Xq.produce;const Yq=n=>(e,t,r)=>(r.setState=(i,s,...a)=>{const o=typeof i=="function"?qq(i):i;return e(o,s,...a)},n(r.setState,t,r)),ug=Yq,ws=ms()(ug((n,e)=>({tracking:!1,position:null,heading:null,smoothHeading:null,accuracy:null,speed:null,headingSource:null,watchId:null,firstFix:!0,config:{smoothingFactor:.2,minRotationSpeed:8,centerOnUser:!0,animationDuration:100},startTracking:()=>{n(t=>{t.tracking=!0})},stopTracking:()=>{n(t=>{const{watchId:r}=e();r!==null&&navigator.geolocation.clearWatch(r),t.tracking=!1,t.speed=null,t.headingSource=null,t.watchId=null})},updatePosition:t=>{n(r=>{r.position={lat:t.coords.latitude,lng:t.coords.longitude},r.accuracy=t.coords.accuracy,r.speed=t.coords.speed;const i=15,s=.5;if(!(t.coords.accuracy!==null&&t.coords.accuracy<i)){r.headingSource=null;return}if(t.coords.heading!==null&&t.coords.speed!==null&&t.coords.speed>s){r.headingSource="gps";const o=t.coords.heading;e().updateHeading(o,"gps")}else r.headingSource="compass"})},updateHeading:(t,r="compass")=>{n(i=>{const{smoothHeading:s,config:a}=e();if(s===null){i.smoothHeading=t,i.heading=t;return}let o=t-s;o>180&&(o-=360),o<-180&&(o+=360);const l=r==="compass"?5:3;if(Math.abs(o)<l)return;const h=s+o*(r==="gps"?.5:.35);i.smoothHeading=(h+360)%360,i.heading=t})},setSmoothedHeading:t=>{n(r=>{r.smoothHeading=t,r.heading=t})},setWatchId:t=>{n(r=>{r.watchId=t})},resetFirstFix:()=>{n(t=>{t.firstFix=!1})}}))),Ww={"TMK 1850":{name:"TMK 1850",factory:async()=>null,immediateLoad:!0,tier:"premium"},"Bonnebladen 1900":{name:"Bonnebladen 1900",factory:async()=>null,immediateLoad:!0,tier:"premium"},"AHN 0.5m":{name:"AHN 0.5m",factory:async()=>{const{createAHNLayerOL:n}=await yt(async()=>{const{createAHNLayerOL:e}=await import("./pdokWMSLayers-BC51KmFD.js");return{createAHNLayerOL:e}},[]);return n()},immediateLoad:!0},Geomorfologie:{name:"Geomorfologie",factory:async()=>{const{createGeomorfologieLayerOL:n}=await yt(async()=>{const{createGeomorfologieLayerOL:e}=await import("./pdokWMSLayers-BC51KmFD.js");return{createGeomorfologieLayerOL:e}},[]);return n()},immediateLoad:!0},Bodemkaart:{name:"Bodemkaart",factory:async()=>{const{createBodemkaartLayerOL:n}=await yt(async()=>{const{createBodemkaartLayerOL:e}=await import("./pdokWMSLayers-BC51KmFD.js");return{createBodemkaartLayerOL:e}},[]);return n()},immediateLoad:!0},IKAW:{name:"IKAW",factory:async()=>{const{createIKAWLayerOL:n}=await yt(async()=>{const{createIKAWLayerOL:e}=await import("./pdokWMSLayers-BC51KmFD.js");return{createIKAWLayerOL:e}},[]);return n()},immediateLoad:!0},"FAMKE Steentijd":{name:"FAMKE Steentijd",factory:async()=>{const{createFAMKESteentijdLayerOL:n}=await yt(async()=>{const{createFAMKESteentijdLayerOL:e}=await import("./pdokWMSLayers-BC51KmFD.js");return{createFAMKESteentijdLayerOL:e}},[]);return n()},immediateLoad:!0},"FAMKE IJzertijd":{name:"FAMKE IJzertijd",factory:async()=>{const{createFAMKEIJzertijdLayerOL:n}=await yt(async()=>{const{createFAMKEIJzertijdLayerOL:e}=await import("./pdokWMSLayers-BC51KmFD.js");return{createFAMKEIJzertijdLayerOL:e}},[]);return n()},immediateLoad:!0},Essen:{name:"Essen",factory:async()=>{const{createEssenLayerOL:n}=await yt(async()=>{const{createEssenLayerOL:e}=await import("./pdokWMSLayers-BC51KmFD.js");return{createEssenLayerOL:e}},[]);return n()},immediateLoad:!0},Rijksmonumenten:{name:"Rijksmonumenten",factory:async()=>{const{createRijksmonumentenLayerOL:n}=await yt(async()=>{const{createRijksmonumentenLayerOL:e}=await import("./pdokWMSLayers-BC51KmFD.js");return{createRijksmonumentenLayerOL:e}},[]);return n()},immediateLoad:!0},"Archeo Onderzoeken":{name:"Archeo Onderzoeken",factory:async()=>{const{createArcheoOnderzoekenLayerOL:n}=await yt(async()=>{const{createArcheoOnderzoekenLayerOL:e}=await import("./pdokWMSLayers-BC51KmFD.js");return{createArcheoOnderzoekenLayerOL:e}},[]);return n()},immediateLoad:!0},Werelderfgoed:{name:"Werelderfgoed",factory:async()=>{const{createWerelderfgoedLayerOL:n}=await yt(async()=>{const{createWerelderfgoedLayerOL:e}=await import("./pdokWMSLayers-BC51KmFD.js");return{createWerelderfgoedLayerOL:e}},[]);return n()},immediateLoad:!0},Terpen:{name:"Terpen",factory:async()=>{const{createTerpenLayerOL:n}=await yt(async()=>{const{createTerpenLayerOL:e}=await import("./terpenOL-BbJ5kFgh.js");return{createTerpenLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},Verdedigingslinies:{name:"Verdedigingslinies",factory:async()=>{const{createLiniesLayerOL:n}=await yt(async()=>{const{createLiniesLayerOL:e}=await import("./verdedigingswerkenOL-KUxLMwnv.js");return{createLiniesLayerOL:e}},[]);return n()},immediateLoad:!0},Inundatiegebieden:{name:"Inundatiegebieden",factory:async()=>{const{createInundatiesLayerOL:n}=await yt(async()=>{const{createInundatiesLayerOL:e}=await import("./verdedigingswerkenOL-KUxLMwnv.js");return{createInundatiesLayerOL:e}},[]);return n()},immediateLoad:!0},"Militaire Objecten":{name:"Militaire Objecten",factory:async()=>{const{createMilitaireObjectenLayerOL:n}=await yt(async()=>{const{createMilitaireObjectenLayerOL:e}=await import("./verdedigingswerkenOL-KUxLMwnv.js");return{createMilitaireObjectenLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 800 n.Chr.":{name:"Paleokaart 800 n.Chr.",factory:async()=>{const{createPaleo800ncLayerOL:n}=await yt(async()=>{const{createPaleo800ncLayerOL:e}=await import("./paleokaartOL-CpYYRAhE.js");return{createPaleo800ncLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 100 n.Chr.":{name:"Paleokaart 100 n.Chr.",factory:async()=>{const{createPaleo100ncLayerOL:n}=await yt(async()=>{const{createPaleo100ncLayerOL:e}=await import("./paleokaartOL-CpYYRAhE.js");return{createPaleo100ncLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 500 v.Chr.":{name:"Paleokaart 500 v.Chr.",factory:async()=>{const{createPaleo500vcLayerOL:n}=await yt(async()=>{const{createPaleo500vcLayerOL:e}=await import("./paleokaartOL-CpYYRAhE.js");return{createPaleo500vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 1500 v.Chr.":{name:"Paleokaart 1500 v.Chr.",factory:async()=>{const{createPaleo1500vcLayerOL:n}=await yt(async()=>{const{createPaleo1500vcLayerOL:e}=await import("./paleokaartOL-CpYYRAhE.js");return{createPaleo1500vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 2750 v.Chr.":{name:"Paleokaart 2750 v.Chr.",factory:async()=>{const{createPaleo2750vcLayerOL:n}=await yt(async()=>{const{createPaleo2750vcLayerOL:e}=await import("./paleokaartOL-CpYYRAhE.js");return{createPaleo2750vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 5500 v.Chr.":{name:"Paleokaart 5500 v.Chr.",factory:async()=>{const{createPaleo5500vcLayerOL:n}=await yt(async()=>{const{createPaleo5500vcLayerOL:e}=await import("./paleokaartOL-CpYYRAhE.js");return{createPaleo5500vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 9000 v.Chr.":{name:"Paleokaart 9000 v.Chr.",factory:async()=>{const{createPaleo9000vcLayerOL:n}=await yt(async()=>{const{createPaleo9000vcLayerOL:e}=await import("./paleokaartOL-CpYYRAhE.js");return{createPaleo9000vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Religieus Erfgoed":{name:"Religieus Erfgoed",factory:async()=>{const{createReligieusErfgoedLayerOL:n}=await yt(async()=>{const{createReligieusErfgoedLayerOL:e}=await import("./religieusErfgoedOL-PAil3_4d.js");return{createReligieusErfgoedLayerOL:e}},[]);return n()},immediateLoad:!0},"AHN4 Hoogtekaart Kleur":{name:"AHN4 Hoogtekaart Kleur",factory:async()=>{const{createAHN4ColorElevationLayerOL:n}=await yt(async()=>{const{createAHN4ColorElevationLayerOL:e}=await import("./hillshadeLayers-DUJPzl9U.js");return{createAHN4ColorElevationLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},"AHN4 Hillshade NL":{name:"AHN4 Hillshade NL",factory:async()=>{const{createAHN4HillshadeLayerOL:n}=await yt(async()=>{const{createAHN4HillshadeLayerOL:e}=await import("./hillshadeLayers-DUJPzl9U.js");return{createAHN4HillshadeLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},"AHN4 Multi-Hillshade NL":{name:"AHN4 Multi-Hillshade NL",factory:async()=>{const{createAHN4MultiHillshadeLayerOL:n}=await yt(async()=>{const{createAHN4MultiHillshadeLayerOL:e}=await import("./hillshadeLayers-DUJPzl9U.js");return{createAHN4MultiHillshadeLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},"Hoogtekaart (WebGL)":{name:"Hoogtekaart (WebGL)",factory:async()=>{const{createWebGLHillshadeLayerOL:n}=await yt(async()=>{const{createWebGLHillshadeLayerOL:e}=await import("./ahnWebGLHillshade-C23IvfTE.js");return{createWebGLHillshadeLayerOL:e}},[]);return n()},immediateLoad:!0},Gewaspercelen:{name:"Gewaspercelen",factory:async()=>{const{createGewaspercelenLayerOL:n}=await yt(async()=>{const{createGewaspercelenLayerOL:e}=await import("./pdokWMSLayers-BC51KmFD.js");return{createGewaspercelenLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},"Kadastrale Grenzen":{name:"Kadastrale Grenzen",factory:async()=>{const{createKadastraleKaartLayerOL:n}=await yt(async()=>{const{createKadastraleKaartLayerOL:e}=await import("./pdokWMSLayers-BC51KmFD.js");return{createKadastraleKaartLayerOL:e}},[]);return n()},immediateLoad:!0},Scheepswrakken:{name:"Scheepswrakken",factory:async()=>{const{createScheepswrakkenLayerOL:n}=await yt(async()=>{const{createScheepswrakkenLayerOL:e}=await import("./pdokWMSLayers-BC51KmFD.js");return{createScheepswrakkenLayerOL:e}},[]);return n()},immediateLoad:!0},"Woonheuvels ZH":{name:"Woonheuvels ZH",factory:async()=>{const{createWoonheuvelsLayerOL:n}=await yt(async()=>{const{createWoonheuvelsLayerOL:e}=await import("./pdokWMSLayers-BC51KmFD.js");return{createWoonheuvelsLayerOL:e}},[]);return n()},immediateLoad:!0},"Romeinse Forten":{name:"Romeinse Forten",factory:async()=>{const{createRomeinseFortenLayerOL:n}=await yt(async()=>{const{createRomeinseFortenLayerOL:e}=await import("./romeinseFortenOL-UGzk1WGu.js");return{createRomeinseFortenLayerOL:e}},__vite__mapDeps([0,1]));return n()},immediateLoad:!1},"Romeinse Forten Lijnen":{name:"Romeinse Forten Lijnen",factory:async()=>{const{createRomeinseFortenLijnenLayerOL:n}=await yt(async()=>{const{createRomeinseFortenLijnenLayerOL:e}=await import("./romeinseFortenOL-UGzk1WGu.js");return{createRomeinseFortenLijnenLayerOL:e}},__vite__mapDeps([0,1]));return n()},immediateLoad:!1},Windmolens:{name:"Windmolens",factory:async()=>{const{createWindmolensLayerOL:n}=await yt(async()=>{const{createWindmolensLayerOL:e}=await import("./pdokWMSLayers-BC51KmFD.js");return{createWindmolensLayerOL:e}},[]);return n()},immediateLoad:!0},Erfgoedlijnen:{name:"Erfgoedlijnen",factory:async()=>{const{createErfgoedlijnenLayerOL:n}=await yt(async()=>{const{createErfgoedlijnenLayerOL:e}=await import("./pdokWMSLayers-BC51KmFD.js");return{createErfgoedlijnenLayerOL:e}},[]);return n()},immediateLoad:!0},"Oude Kernen":{name:"Oude Kernen",factory:async()=>{const{createOudeKernenLayerOL:n}=await yt(async()=>{const{createOudeKernenLayerOL:e}=await import("./pdokWMSLayers-BC51KmFD.js");return{createOudeKernenLayerOL:e}},[]);return n()},immediateLoad:!0},"Relictenkaart Punten":{name:"Relictenkaart Punten",factory:async()=>{const{createRelictenPuntenLayerOL:n}=await yt(async()=>{const{createRelictenPuntenLayerOL:e}=await import("./relictenGelderlandOL-oAFMf4IU.js");return{createRelictenPuntenLayerOL:e}},[]);return n()},immediateLoad:!1},"Relictenkaart Lijnen":{name:"Relictenkaart Lijnen",factory:async()=>{const{createRelictenkaartLijnenLayerOL:n}=await yt(async()=>{const{createRelictenkaartLijnenLayerOL:e}=await import("./pdokWMSLayers-BC51KmFD.js");return{createRelictenkaartLijnenLayerOL:e}},[]);return n()},immediateLoad:!0},"Relictenkaart Vlakken":{name:"Relictenkaart Vlakken",factory:async()=>{const{createRelictenkaartVlakkenLayerOL:n}=await yt(async()=>{const{createRelictenkaartVlakkenLayerOL:e}=await import("./pdokWMSLayers-BC51KmFD.js");return{createRelictenkaartVlakkenLayerOL:e}},[]);return n()},immediateLoad:!0},"Verdronken Dorpen":{name:"Verdronken Dorpen",factory:async()=>{const{createVerdronkenDorpenLayerOL:n}=await yt(async()=>{const{createVerdronkenDorpenLayerOL:e}=await import("./pdokWMSLayers-BC51KmFD.js");return{createVerdronkenDorpenLayerOL:e}},[]);return n()},immediateLoad:!0},"AMK Monumenten":{name:"AMK Monumenten",factory:async()=>{const{createAMKLayerOL:n}=await yt(async()=>{const{createAMKLayerOL:e}=await import("./amkOL-7RCfjzeD.js");return{createAMKLayerOL:e}},__vite__mapDeps([2,3]));return n()},immediateLoad:!1,tier:"premium"},"AMK Romeins":{name:"AMK Romeins",factory:async()=>{const{createAMKRomeinsLayerOL:n}=await yt(async()=>{const{createAMKRomeinsLayerOL:e}=await import("./amkOL-7RCfjzeD.js");return{createAMKRomeinsLayerOL:e}},__vite__mapDeps([2,3]));return n()},immediateLoad:!1,tier:"premium"},"AMK Steentijd":{name:"AMK Steentijd",factory:async()=>{const{createAMKSteentijdLayerOL:n}=await yt(async()=>{const{createAMKSteentijdLayerOL:e}=await import("./amkOL-7RCfjzeD.js");return{createAMKSteentijdLayerOL:e}},__vite__mapDeps([2,3]));return n()},immediateLoad:!1,tier:"premium"},"AMK Vroege ME":{name:"AMK Vroege ME",factory:async()=>{const{createAMKVroegeMELayerOL:n}=await yt(async()=>{const{createAMKVroegeMELayerOL:e}=await import("./amkOL-7RCfjzeD.js");return{createAMKVroegeMELayerOL:e}},__vite__mapDeps([2,3]));return n()},immediateLoad:!1,tier:"premium"},"AMK Late ME":{name:"AMK Late ME",factory:async()=>{const{createAMKLateMELayerOL:n}=await yt(async()=>{const{createAMKLateMELayerOL:e}=await import("./amkOL-7RCfjzeD.js");return{createAMKLateMELayerOL:e}},__vite__mapDeps([2,3]));return n()},immediateLoad:!1,tier:"premium"},"AMK Overig":{name:"AMK Overig",factory:async()=>{const{createAMKOverigLayerOL:n}=await yt(async()=>{const{createAMKOverigLayerOL:e}=await import("./amkOL-7RCfjzeD.js");return{createAMKOverigLayerOL:e}},__vite__mapDeps([2,3]));return n()},immediateLoad:!1,tier:"premium"},"Romeinse wegen (regio)":{name:"Romeinse wegen (regio)",factory:async()=>{const{createRomeinseWegenLayerOL:n}=await yt(async()=>{const{createRomeinseWegenLayerOL:e}=await import("./romeinsOL-FFPpumcd.js");return{createRomeinseWegenLayerOL:e}},__vite__mapDeps([4,3]));return n()},immediateLoad:!1},"Romeinse wegen (Wereld)":{name:"Romeinse wegen (Wereld)",factory:async()=>{const{createRomeinseWegenWereldLayerOL:n}=await yt(async()=>{const{createRomeinseWegenWereldLayerOL:e}=await import("./romeinsOL-FFPpumcd.js");return{createRomeinseWegenWereldLayerOL:e}},__vite__mapDeps([4,3]));return n()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},Kastelen:{name:"Kastelen",factory:async()=>{const{createKastelenLayerOL:n}=await yt(async()=>{const{createKastelenLayerOL:e}=await import("./kastelenOL-BTVxiKfb.js");return{createKastelenLayerOL:e}},__vite__mapDeps([5,1]));return n()},immediateLoad:!1},Runes:{name:"Runes",factory:async()=>{const{createRuinesLayerOL:n}=await yt(async()=>{const{createRuinesLayerOL:e}=await import("./ruinesOL-VoFRQq1p.js");return{createRuinesLayerOL:e}},__vite__mapDeps([6,1]));return n()},immediateLoad:!1},Veengebieden:{name:"Veengebieden",factory:async()=>{const{createVeengebiedenLayerOL:n}=await yt(async()=>{const{createVeengebiedenLayerOL:e}=await import("./veengebiedenOL-COD84Vlh.js");return{createVeengebiedenLayerOL:e}},[]);return n()},immediateLoad:!1},Hunebedden:{name:"Hunebedden",factory:async()=>{const{createHunebeddenLayerOL:n}=await yt(async()=>{const{createHunebeddenLayerOL:e}=await import("./hunebeddenOL-B3edVa4l.js");return{createHunebeddenLayerOL:e}},__vite__mapDeps([7,1]));return n()},immediateLoad:!1},"UIKAV Punten":{name:"UIKAV Punten",factory:async()=>{const{createUIKAVArcheoPuntenLayerOL:n}=await yt(async()=>{const{createUIKAVArcheoPuntenLayerOL:e}=await import("./uikavArcheoPuntenOL-Dxajkn-H.js");return{createUIKAVArcheoPuntenLayerOL:e}},__vite__mapDeps([8,3,1]));return n()},immediateLoad:!1,tier:"premium"},"UIKAV Vlakken":{name:"UIKAV Vlakken",factory:async()=>{const{createUIKAVVlakkenLayerOL:n}=await yt(async()=>{const{createUIKAVVlakkenLayerOL:e}=await import("./uikavVlakkenOL-BLcD1v0B.js");return{createUIKAVVlakkenLayerOL:e}},__vite__mapDeps([9,3]));return n()},immediateLoad:!1},"UIKAV Buffer":{name:"UIKAV Buffer",factory:async()=>{const{createUIKAVBufferlaagLayerOL:n}=await yt(async()=>{const{createUIKAVBufferlaagLayerOL:e}=await import("./uikavBufferlaagOL-e5zpYvuX.js");return{createUIKAVBufferlaagLayerOL:e}},__vite__mapDeps([10,3]));return n()},immediateLoad:!1},"UIKAV Expert":{name:"UIKAV Expert",factory:async()=>{const{createUIKAVExpertLayerOL:n}=await yt(async()=>{const{createUIKAVExpertLayerOL:e}=await import("./uikavExpertOL-JLd2zpZV.js");return{createUIKAVExpertLayerOL:e}},__vite__mapDeps([11,3]));return n()},immediateLoad:!1},"UIKAV Indeling":{name:"UIKAV Indeling",factory:async()=>{const{createUIKAVUiterwaardenLayerOL:n}=await yt(async()=>{const{createUIKAVUiterwaardenLayerOL:e}=await import("./uikavUiterwaardenOL-DNCZ0EAH.js");return{createUIKAVUiterwaardenLayerOL:e}},__vite__mapDeps([12,3]));return n()},immediateLoad:!1},Speeltuinen:{name:"Speeltuinen",factory:async()=>{const{createSpeeltuinenLayerOL:n}=await yt(async()=>{const{createSpeeltuinenLayerOL:e}=await import("./speeltuinenOL-CvibYSoW.js");return{createSpeeltuinenLayerOL:e}},__vite__mapDeps([13,3,1]));return n()},immediateLoad:!1},Musea:{name:"Musea",factory:async()=>{const{createMuseaLayerOL:n}=await yt(async()=>{const{createMuseaLayerOL:e}=await import("./museaOL-BM5sCYK_.js");return{createMuseaLayerOL:e}},__vite__mapDeps([14,3,1]));return n()},immediateLoad:!1},Strandjes:{name:"Strandjes",factory:async()=>{const{createStrandjesLayerOL:n}=await yt(async()=>{const{createStrandjesLayerOL:e}=await import("./strandjesOL-B2SZog1i.js");return{createStrandjesLayerOL:e}},__vite__mapDeps([15,3]));return n()},immediateLoad:!1},Parken:{name:"Parken",factory:async()=>{const{createParkenLayerOL:n}=await yt(async()=>{const{createParkenLayerOL:e}=await import("./parkenOL-DT0BrNxI.js");return{createParkenLayerOL:e}},__vite__mapDeps([16,3]));return n()},immediateLoad:!1},Kringloopwinkels:{name:"Kringloopwinkels",factory:async()=>{const{createKringloopwinkelsLayerOL:n}=await yt(async()=>{const{createKringloopwinkelsLayerOL:e}=await import("./kringloopwinkelsOL-CD8xGraP.js");return{createKringloopwinkelsLayerOL:e}},__vite__mapDeps([17,1]));return n()},immediateLoad:!1},Ruiterpaden:{name:"Ruiterpaden",factory:async()=>{const{createRuiterpadenLayerOL:n}=await yt(async()=>{const{createRuiterpadenLayerOL:e}=await import("./ruiterpadenOL-DIUmu4gO.js");return{createRuiterpadenLayerOL:e}},[]);return n()},immediateLoad:!1},Laarzenpaden:{name:"Laarzenpaden",factory:async()=>{const{createLaarzenpadenLayerOL:n}=await yt(async()=>{const{createLaarzenpadenLayerOL:e}=await import("./laarzenpadenOL-CT4NaOYF.js");return{createLaarzenpadenLayerOL:e}},[]);return n()},immediateLoad:!1},"Fossielen Nederland":{name:"Fossielen Nederland",factory:async()=>{const{createFossielenLayerOL:n}=await yt(async()=>{const{createFossielenLayerOL:e}=await import("./fossielenOL-kmWrsqWt.js");return{createFossielenLayerOL:e}},__vite__mapDeps([18,19,1]));return n()},immediateLoad:!1,tier:"premium"},"Fossielen Belgi":{name:"Fossielen Belgi",factory:async()=>{const{createFossielenBelgieLayerOL:n}=await yt(async()=>{const{createFossielenBelgieLayerOL:e}=await import("./fossielenBelgieOL-RieZM2EL.js");return{createFossielenBelgieLayerOL:e}},__vite__mapDeps([20,19,1]));return n()},immediateLoad:!1,tier:"premium",regions:["be"]},"Fossielen Duitsland":{name:"Fossielen Duitsland",factory:async()=>{const{createFossielenDuitslandLayerOL:n}=await yt(async()=>{const{createFossielenDuitslandLayerOL:e}=await import("./fossielenDuitslandOL-B2DzxtIY.js");return{createFossielenDuitslandLayerOL:e}},__vite__mapDeps([21,19,1]));return n()},immediateLoad:!1,tier:"premium",regions:["de"]},"Fossielen Frankrijk":{name:"Fossielen Frankrijk",factory:async()=>{const{createFossielenFrankrijkLayerOL:n}=await yt(async()=>{const{createFossielenFrankrijkLayerOL:e}=await import("./fossielenFrankrijkOL-DwwmLf2r.js");return{createFossielenFrankrijkLayerOL:e}},__vite__mapDeps([22,19,1]));return n()},immediateLoad:!1,tier:"premium",regions:["fr"]},"Fossiel Hotspots":{name:"Fossiel Hotspots",factory:async()=>{const{createFossielHotspotsLayerOL:n}=await yt(async()=>{const{createFossielHotspotsLayerOL:e}=await import("./fossielHotspotsOL-DG1vxe6i.js");return{createFossielHotspotsLayerOL:e}},[]);return n()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},"Mineralen Hotspots":{name:"Mineralen Hotspots",factory:async()=>{const{createMineralenHotspotsLayerOL:n}=await yt(async()=>{const{createMineralenHotspotsLayerOL:e}=await import("./mineralenHotspotsOL-BDBMBfIV.js");return{createMineralenHotspotsLayerOL:e}},[]);return n()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},Goudrivieren:{name:"Goudrivieren",factory:async()=>{const{createGoudrivierenLayerOL:n}=await yt(async()=>{const{createGoudrivierenLayerOL:e}=await import("./goudrivierenOL-7lJN0SHz.js");return{createGoudrivierenLayerOL:e}},[]);return n()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},Wandelroutes:{name:"Wandelroutes",factory:async()=>{const{createWandelroutesLayer:n}=await yt(async()=>{const{createWandelroutesLayer:e}=await import("./wandelroutesOL-C1OlFXoz.js");return{createWandelroutesLayer:e}},[]);return n()},immediateLoad:!1,tier:"free",regions:["nl","be"]},"WWII Bunkers":{name:"WWII Bunkers",factory:async()=>{const{createBunkersLayerOL:n}=await yt(async()=>{const{createBunkersLayerOL:e}=await import("./bunkersOL-BSnRqSk5.js");return{createBunkersLayerOL:e}},__vite__mapDeps([23,1]));return n()},immediateLoad:!1},Grafheuvels:{name:"Grafheuvels",factory:async()=>{const{createGrafheuvelsLayerOL:n}=await yt(async()=>{const{createGrafheuvelsLayerOL:e}=await import("./grafheuvelsOL-Bi9LFZuL.js");return{createGrafheuvelsLayerOL:e}},__vite__mapDeps([24,1]));return n()},immediateLoad:!1},Slagvelden:{name:"Slagvelden",factory:async()=>{const{createSlagveldenLayerOL:n}=await yt(async()=>{const{createSlagveldenLayerOL:e}=await import("./slagveldenOL-BTP7EZdH.js");return{createSlagveldenLayerOL:e}},__vite__mapDeps([25,1]));return n()},immediateLoad:!1},"Militaire Vliegvelden":{name:"Militaire Vliegvelden",factory:async()=>{const{createVliegveldenLayerOL:n}=await yt(async()=>{const{createVliegveldenLayerOL:e}=await import("./vliegveldenOL-np3MsZLt.js");return{createVliegveldenLayerOL:e}},[]);return n()},immediateLoad:!1}};function Zq(){return Object.values(Ww).filter(n=>n.immediateLoad)}const pi=ms()(ug((n,e)=>({map:null,rotation:0,rotationEnabled:!0,setMap:t=>{n(r=>{r.map=t})},setRotation:t=>{n(r=>{if(r.rotation=t,r.map&&r.rotationEnabled){const i=t*Math.PI/180;r.map.getView().setRotation(i)}})},enableRotation:()=>{n(t=>{t.rotationEnabled=!0})},disableRotation:()=>{n(t=>{t.rotationEnabled=!1,t.rotation=0,t.map&&t.map.getView().animate({rotation:0,duration:500})})}}))),Ri=ms()(ug((n,e)=>({visible:{"CartoDB (licht)":!0,OpenStreetMap:!1,Luchtfoto:!1,"Labels Overlay":!1,"TMK 1850":!1,"Bonnebladen 1900":!1,Hunebedden:!1,"FAMKE Steentijd":!1,"FAMKE IJzertijd":!1,Grafheuvels:!1,Terpen:!1,"AMK Monumenten":!1,"AMK Romeins":!1,"AMK Steentijd":!1,"AMK Vroege ME":!1,"AMK Late ME":!1,"AMK Overig":!1,"Archeo Onderzoeken":!1,"Romeinse wegen (regio)":!1,"Romeinse wegen (Wereld)":!1,Kastelen:!1,IKAW:!1,Essen:!1,Rijksmonumenten:!1,Werelderfgoed:!1,"WWII Bunkers":!1,Slagvelden:!1,"Militaire Vliegvelden":!1,Verdedigingslinies:!1,Inundatiegebieden:!1,"Militaire Objecten":!1,"Paleokaart 800 n.Chr.":!1,"Paleokaart 100 n.Chr.":!1,"Paleokaart 500 v.Chr.":!1,"Paleokaart 1500 v.Chr.":!1,"Paleokaart 2750 v.Chr.":!1,"Paleokaart 5500 v.Chr.":!1,"Paleokaart 9000 v.Chr.":!1,"Religieus Erfgoed":!1,"UIKAV Punten":!1,"UIKAV Vlakken":!1,"UIKAV Buffer":!1,"UIKAV Expert":!1,"UIKAV Indeling":!1,"Hoogtekaart (WebGL)":!1,"AHN4 Hoogtekaart Kleur":!1,"AHN4 Hillshade NL":!1,"AHN4 Multi-Hillshade NL":!1,"AHN 0.5m":!1,Veengebieden:!1,Geomorfologie:!1,Bodemkaart:!1,"Fossielen Nederland":!1,"Fossielen Belgi":!1,"Fossielen Duitsland":!1,"Fossielen Frankrijk":!1,Parken:!1,Speeltuinen:!1,Musea:!1,Strandjes:!1,Ruiterpaden:!1,Laarzenpaden:!1,Gewaspercelen:!1,"Kadastrale Grenzen":!1,Scheepswrakken:!1,"Woonheuvels ZH":!1,"Romeinse Forten":!1,Windmolens:!1,Erfgoedlijnen:!1,"Oude Kernen":!1,"Relictenkaart Punten":!1,"Relictenkaart Lijnen":!1,"Relictenkaart Vlakken":!1,"Verdronken Dorpen":!1,"Mijn Vondsten":!0},opacity:{"Hoogtekaart (WebGL)":.8,"AHN4 Hoogtekaart Kleur":.85,"AHN4 Hillshade NL":.7,"AHN4 Multi-Hillshade NL":.7,"AHN 0.5m":.7,"TMK 1850":.8,"Bonnebladen 1900":.8,Geomorfologie:.5,Bodemkaart:.6,Veengebieden:.6,IKAW:.5,"FAMKE Steentijd":.6,"FAMKE IJzertijd":.6,Essen:.6,Terpen:.7,"AMK Monumenten":.45,"AMK Romeins":.6,"AMK Steentijd":.6,"AMK Vroege ME":.6,"AMK Late ME":.6,"AMK Overig":.6,"Paleokaart 9000 v.Chr.":.7,"Paleokaart 5500 v.Chr.":.7,"Paleokaart 2750 v.Chr.":.7,"Paleokaart 1500 v.Chr.":.7,"Paleokaart 500 v.Chr.":.7,"Paleokaart 100 n.Chr.":.7,"Paleokaart 800 n.Chr.":.7,Verdedigingslinies:.7,Inundatiegebieden:.5,"Militaire Objecten":.8,"Religieus Erfgoed":.8,Gewaspercelen:.6,"Kadastrale Grenzen":.7,Erfgoedlijnen:.7,"Oude Kernen":.6,"Relictenkaart Vlakken":.5},loadingState:{},layers:{},toggleLayer:t=>{const r=e(),i=!r.visible[t];n(s=>{s.visible[t]=i}),i&&!r.layers[t]?e().loadLayer(t):r.layers[t]&&r.layers[t].setVisible(i)},setLayerVisibility:(t,r)=>{const i=e();n(s=>{s.visible[t]=r;const a=s.layers[t];a&&a.setVisible(r)}),r&&!i.layers[t]&&e().loadLayer(t)},setLayerOpacity:(t,r)=>{n(i=>{i.opacity[t]=r;const s=i.layers[t];s&&s.setOpacity(r)})},registerLayer:(t,r)=>{n(i=>{i.layers[t]=r,i.loadingState[t]="loaded",i.visible[t]!==void 0&&r.setVisible(i.visible[t]),i.opacity[t]!==void 0&&r.setOpacity(i.opacity[t])})},unregisterLayer:t=>{n(r=>{delete r.layers[t],delete r.loadingState[t]})},loadLayer:async t=>{const r=e();if(r.loadingState[t]==="loading"||r.layers[t])return;const i=Ww[t];if(!i){console.warn(` Layer "${t}" not found in registry`);return}const s=pi.getState().map;if(!s){console.warn(` Cannot load layer "${t}": map not initialized`);return}n(a=>{a.loadingState[t]="loading"}),console.log(` Loading layer: ${t}...`);try{const a=await i.factory();if(!a)throw new Error("Factory returned null");const o=e();a.setVisible(o.visible[t]??!1),o.opacity[t]!==void 0&&a.setOpacity(o.opacity[t]),s.addLayer(a),n(l=>{l.layers[t]=a,l.loadingState[t]="loaded"}),console.log(` Layer loaded: ${t}`)}catch(a){console.error(` Failed to load layer "${t}":`,a),n(o=>{o.loadingState[t]="error"})}}}))),wr=ms()(ug((n,e)=>({layerControlOpen:!1,legendOpen:!1,backgroundsPanelOpen:!1,themesPanelOpen:!1,settingsPanelOpen:!1,infoPanelOpen:!1,presetsPanelOpen:!1,vondstFormOpen:!1,vondstFormLocation:null,vondstFormPhoto:null,vondstDashboardOpen:!1,createLayerModalOpen:!1,addPointModalOpen:!1,addPointModalLayerId:null,addPointModalLocation:null,layerManagerModalOpen:!1,layerDashboardOpen:!1,layerDashboardLayerId:null,routeDashboardOpen:!1,collapsedCategories:new Set,closeAllPanels:()=>{n(t=>{t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1})},toggleLayerControl:()=>{n(t=>{t.layerControlOpen=!t.layerControlOpen})},toggleLegend:()=>{n(t=>{t.legendOpen=!t.legendOpen})},toggleBackgroundsPanel:()=>{n(t=>{const r=t.backgroundsPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,r||(t.backgroundsPanelOpen=!0)})},toggleThemesPanel:()=>{n(t=>{const r=t.themesPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,r||(t.themesPanelOpen=!0)})},toggleSettingsPanel:()=>{n(t=>{const r=t.settingsPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,r||(t.settingsPanelOpen=!0)})},toggleInfoPanel:()=>{n(t=>{const r=t.infoPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,r||(t.infoPanelOpen=!0)})},togglePresetsPanel:()=>{n(t=>{const r=t.presetsPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,r||(t.presetsPanelOpen=!0)})},toggleCategory:t=>{n(r=>{r.collapsedCategories.has(t)?r.collapsedCategories.delete(t):r.collapsedCategories.add(t)})},setLayerControlOpen:t=>{n(r=>{r.layerControlOpen=t})},setLegendOpen:t=>{n(r=>{r.legendOpen=t})},openVondstForm:(t,r)=>{n(i=>{i.backgroundsPanelOpen=!1,i.themesPanelOpen=!1,i.settingsPanelOpen=!1,i.infoPanelOpen=!1,i.presetsPanelOpen=!1,i.vondstFormOpen=!0,i.vondstFormLocation=t||null,i.vondstFormPhoto=r||null})},closeVondstForm:()=>{n(t=>{t.vondstFormOpen=!1,t.vondstFormLocation=null,t.vondstFormPhoto=null})},toggleVondstDashboard:()=>{n(t=>{const r=t.vondstDashboardOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,t.vondstDashboardOpen=!r})},openCreateLayerModal:()=>{n(t=>{t.createLayerModalOpen=!0})},closeCreateLayerModal:()=>{n(t=>{t.createLayerModalOpen=!1})},openAddPointModal:(t,r)=>{n(i=>{i.addPointModalOpen=!0,i.addPointModalLayerId=t,i.addPointModalLocation=r})},closeAddPointModal:()=>{n(t=>{t.addPointModalOpen=!1,t.addPointModalLayerId=null,t.addPointModalLocation=null})},openLayerManagerModal:()=>{n(t=>{t.layerManagerModalOpen=!0})},closeLayerManagerModal:()=>{n(t=>{t.layerManagerModalOpen=!1})},openLayerDashboard:t=>{n(r=>{r.layerDashboardOpen=!0,r.layerDashboardLayerId=t,r.layerManagerModalOpen=!1})},closeLayerDashboard:()=>{n(t=>{t.layerDashboardOpen=!1,t.layerDashboardLayerId=null})},toggleRouteDashboard:()=>{n(t=>{t.routeDashboardOpen=!t.routeDashboardOpen})}}))),Jq=()=>{};var SN={};const yj=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},Qq=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=n[t++],a=n[t++],o=n[t++],l=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=n[t++],a=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},xj={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const s=n[i],a=i+1<n.length,o=a?n[i+1]:0,l=i+2<n.length,c=l?n[i+2]:0,h=s>>2,f=(s&3)<<4|o>>4;let m=(o&15)<<2|c>>6,y=c&63;l||(y=64,a||(m=64)),r.push(t[h],t[f],t[m],t[y])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(yj(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):Qq(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const s=t[n.charAt(i++)],o=i<n.length?t[n.charAt(i)]:0;++i;const c=i<n.length?t[n.charAt(i)]:64;++i;const f=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||o==null||c==null||f==null)throw new eY;const m=s<<2|o>>4;if(r.push(m),c!==64){const y=o<<4&240|c>>2;if(r.push(y),f!==64){const x=c<<6&192|f;r.push(x)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class eY extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const tY=function(n){const e=yj(n);return xj.encodeByteArray(e,!0)},nv=function(n){return tY(n).replace(/\./g,"")},_j=function(n){try{return xj.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function vj(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const nY=()=>vj().__FIREBASE_DEFAULTS__,rY=()=>{if(typeof process>"u"||typeof SN>"u")return;const n=SN.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},iY=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&_j(n[1]);return e&&JSON.parse(e)},Hw=()=>{try{return Jq()||nY()||rY()||iY()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},wj=n=>Hw()?.emulatorHosts?.[n],Ej=n=>{const e=wj(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},Tj=()=>Hw()?.config,Sj=n=>Hw()?.[`_${n}`];class sY{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function Md(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function tI(n){return(await fetch(n,{credentials:"include"})).ok}function bj(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...n};return[nv(JSON.stringify(t)),nv(JSON.stringify(a)),""].join(".")}const zm={};function aY(){const n={prod:[],emulator:[]};for(const e of Object.keys(zm))zm[e]?n.emulator.push(e):n.prod.push(e);return n}function oY(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let bN=!1;function nI(n,e){if(typeof window>"u"||typeof document>"u"||!Md(window.location.host)||zm[n]===e||zm[n]||bN)return;zm[n]=e;function t(m){return`__firebase__banner__${m}`}const r="__firebase__banner",s=aY().prod.length>0;function a(){const m=document.getElementById(r);m&&m.remove()}function o(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function l(m,y){m.setAttribute("width","24"),m.setAttribute("id",y),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function c(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{bN=!0,a()},m}function h(m,y){m.setAttribute("id",y),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function f(){const m=oY(r),y=t("text"),x=document.getElementById(y)||document.createElement("span"),_=t("learnmore"),w=document.getElementById(_)||document.createElement("a"),S=t("preprendIcon"),b=document.getElementById(S)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const R=m.element;o(R),h(w,_);const M=c();l(b,S),R.append(b,x,w,M),document.body.appendChild(R)}s?(x.innerText="Preview backend disconnected.",b.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(b.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,x.innerText="Preview backend running in this workspace."),x.setAttribute("id",y)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}function mi(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function lY(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(mi())}function Rj(){const n=Hw()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function cY(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function uY(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function hY(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function dY(){const n=mi();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function Aj(){return!Rj()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Ij(){return!Rj()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function Cj(){try{return typeof indexedDB=="object"}catch{return!1}}function fY(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(t){e(t)}})}const gY="FirebaseError";class xl extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=gY,Object.setPrototypeOf(this,xl.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Py.prototype.create)}}class Py{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?mY(s,r):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new xl(i,o,r)}}function mY(n,e){return n.replace(pY,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const pY=/\{\$([^}]+)}/g;function yY(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function cd(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const s=n[i],a=e[i];if(RN(s)&&RN(a)){if(!cd(s,a))return!1}else if(s!==a)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function RN(n){return n!==null&&typeof n=="object"}function My(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function xY(n,e){const t=new _Y(n,e);return t.subscribe.bind(t)}class _Y{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");vY(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=rS),i.error===void 0&&(i.error=rS),i.complete===void 0&&(i.complete=rS);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function vY(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function rS(){}function Mi(n){return n&&n._delegate?n._delegate:n}class Pu{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Rh="[DEFAULT]";class wY{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new sY;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(TY(e))try{this.getOrInitializeService({instanceIdentifier:Rh})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Rh){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Rh){return this.instances.has(e)}getOptions(e=Rh){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);r===o&&a.resolve(i)}return i}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:EY(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Rh){return this.component?this.component.multipleInstances?e:Rh:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function EY(n){return n===Rh?void 0:n}function TY(n){return n.instantiationMode==="EAGER"}class SY{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new wY(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var yn;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(yn||(yn={}));const bY={debug:yn.DEBUG,verbose:yn.VERBOSE,info:yn.INFO,warn:yn.WARN,error:yn.ERROR,silent:yn.SILENT},RY=yn.INFO,AY={[yn.DEBUG]:"log",[yn.VERBOSE]:"log",[yn.INFO]:"info",[yn.WARN]:"warn",[yn.ERROR]:"error"},IY=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=AY[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class rI{constructor(e){this.name=e,this._logLevel=RY,this._logHandler=IY,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in yn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?bY[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,yn.DEBUG,...e),this._logHandler(this,yn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,yn.VERBOSE,...e),this._logHandler(this,yn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,yn.INFO,...e),this._logHandler(this,yn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,yn.WARN,...e),this._logHandler(this,yn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,yn.ERROR,...e),this._logHandler(this,yn.ERROR,...e)}}const CY=(n,e)=>e.some(t=>n instanceof t);let AN,IN;function kY(){return AN||(AN=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function PY(){return IN||(IN=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const kj=new WeakMap,Lb=new WeakMap,Pj=new WeakMap,iS=new WeakMap,iI=new WeakMap;function MY(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",a)},s=()=>{t(Eu(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&kj.set(t,n)}).catch(()=>{}),iI.set(e,n),e}function NY(n){if(Lb.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",a),n.removeEventListener("abort",a)},s=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",a),n.addEventListener("abort",a)});Lb.set(n,e)}let Ob={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Lb.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Pj.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Eu(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function LY(n){Ob=n(Ob)}function OY(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(sS(this),e,...t);return Pj.set(r,e.sort?e.sort():[e]),Eu(r)}:PY().includes(n)?function(...e){return n.apply(sS(this),e),Eu(kj.get(this))}:function(...e){return Eu(n.apply(sS(this),e))}}function DY(n){return typeof n=="function"?OY(n):(n instanceof IDBTransaction&&NY(n),CY(n,kY())?new Proxy(n,Ob):n)}function Eu(n){if(n instanceof IDBRequest)return MY(n);if(iS.has(n))return iS.get(n);const e=DY(n);return e!==n&&(iS.set(n,e),iI.set(e,n)),e}const sS=n=>iI.get(n);function FY(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){const a=indexedDB.open(n,e),o=Eu(a);return r&&a.addEventListener("upgradeneeded",l=>{r(Eu(a.result),l.oldVersion,l.newVersion,Eu(a.transaction),l)}),t&&a.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),o.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const jY=["get","getKey","getAll","getAllKeys","count"],VY=["put","add","delete","clear"],aS=new Map;function CN(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(aS.get(e))return aS.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=VY.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||jY.includes(t)))return;const s=async function(a,...o){const l=this.transaction(a,i?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(o.shift())),(await Promise.all([c[t](...o),i&&l.done]))[0]};return aS.set(e,s),s}LY(n=>({...n,get:(e,t,r)=>CN(e,t)||n.get(e,t,r),has:(e,t)=>!!CN(e,t)||n.has(e,t)}));class GY{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(BY(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function BY(n){return n.getComponent()?.type==="VERSION"}const Db="@firebase/app",kN="0.14.6";const sc=new rI("@firebase/app"),zY="@firebase/app-compat",UY="@firebase/analytics-compat",$Y="@firebase/analytics",WY="@firebase/app-check-compat",HY="@firebase/app-check",KY="@firebase/auth",XY="@firebase/auth-compat",qY="@firebase/database",YY="@firebase/data-connect",ZY="@firebase/database-compat",JY="@firebase/functions",QY="@firebase/functions-compat",eZ="@firebase/installations",tZ="@firebase/installations-compat",nZ="@firebase/messaging",rZ="@firebase/messaging-compat",iZ="@firebase/performance",sZ="@firebase/performance-compat",aZ="@firebase/remote-config",oZ="@firebase/remote-config-compat",lZ="@firebase/storage",cZ="@firebase/storage-compat",uZ="@firebase/firestore",hZ="@firebase/ai",dZ="@firebase/firestore-compat",fZ="firebase",gZ="12.6.0";const Fb="[DEFAULT]",mZ={[Db]:"fire-core",[zY]:"fire-core-compat",[$Y]:"fire-analytics",[UY]:"fire-analytics-compat",[HY]:"fire-app-check",[WY]:"fire-app-check-compat",[KY]:"fire-auth",[XY]:"fire-auth-compat",[qY]:"fire-rtdb",[YY]:"fire-data-connect",[ZY]:"fire-rtdb-compat",[JY]:"fire-fn",[QY]:"fire-fn-compat",[eZ]:"fire-iid",[tZ]:"fire-iid-compat",[nZ]:"fire-fcm",[rZ]:"fire-fcm-compat",[iZ]:"fire-perf",[sZ]:"fire-perf-compat",[aZ]:"fire-rc",[oZ]:"fire-rc-compat",[lZ]:"fire-gcs",[cZ]:"fire-gcs-compat",[uZ]:"fire-fst",[dZ]:"fire-fst-compat",[hZ]:"fire-vertex","fire-js":"fire-js",[fZ]:"fire-js-all"};const rv=new Map,pZ=new Map,jb=new Map;function PN(n,e){try{n.container.addComponent(e)}catch(t){sc.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function ud(n){const e=n.name;if(jb.has(e))return sc.debug(`There were multiple attempts to register component ${e}.`),!1;jb.set(e,n);for(const t of rv.values())PN(t,n);for(const t of pZ.values())PN(t,n);return!0}function Kw(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function ua(n){return n==null?!1:n.settings!==void 0}const yZ={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Tu=new Py("app","Firebase",yZ);class xZ{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Pu("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Tu.create("app-deleted",{appName:this._name})}}const Nd=gZ;function Mj(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:Fb,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw Tu.create("bad-app-name",{appName:String(i)});if(t||(t=Tj()),!t)throw Tu.create("no-options");const s=rv.get(i);if(s){if(cd(t,s.options)&&cd(r,s.config))return s;throw Tu.create("duplicate-app",{appName:i})}const a=new SY(i);for(const l of jb.values())a.addComponent(l);const o=new xZ(t,r,a);return rv.set(i,o),o}function sI(n=Fb){const e=rv.get(n);if(!e&&n===Fb&&Tj())return Mj();if(!e)throw Tu.create("no-app",{appName:n});return e}function nl(n,e,t){let r=mZ[n]??n;t&&(r+=`-${t}`);const i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){const a=[`Unable to register library "${r}" with version "${e}":`];i&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&a.push("and"),s&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),sc.warn(a.join(" "));return}ud(new Pu(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}const _Z="firebase-heartbeat-database",vZ=1,Dp="firebase-heartbeat-store";let oS=null;function Nj(){return oS||(oS=FY(_Z,vZ,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Dp)}catch(t){console.warn(t)}}}}).catch(n=>{throw Tu.create("idb-open",{originalErrorMessage:n.message})})),oS}async function wZ(n){try{const t=(await Nj()).transaction(Dp),r=await t.objectStore(Dp).get(Lj(n));return await t.done,r}catch(e){if(e instanceof xl)sc.warn(e.message);else{const t=Tu.create("idb-get",{originalErrorMessage:e?.message});sc.warn(t.message)}}}async function MN(n,e){try{const r=(await Nj()).transaction(Dp,"readwrite");await r.objectStore(Dp).put(e,Lj(n)),await r.done}catch(t){if(t instanceof xl)sc.warn(t.message);else{const r=Tu.create("idb-set",{originalErrorMessage:t?.message});sc.warn(r.message)}}}function Lj(n){return`${n.name}!${n.options.appId}`}const EZ=1024,TZ=30;class SZ{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new RZ(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=NN();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>TZ){const i=AZ(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){sc.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=NN(),{heartbeatsToSend:t,unsentEntries:r}=bZ(this._heartbeatsCache.heartbeats),i=nv(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return sc.warn(e),""}}}function NN(){return new Date().toISOString().substring(0,10)}function bZ(n,e=EZ){const t=[];let r=n.slice();for(const i of n){const s=t.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),LN(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),LN(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class RZ{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Cj()?fY().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await wZ(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return MN(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return MN(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function LN(n){return nv(JSON.stringify({version:2,heartbeats:n})).length}function AZ(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function IZ(n){ud(new Pu("platform-logger",e=>new GY(e),"PRIVATE")),ud(new Pu("heartbeat",e=>new SZ(e),"PRIVATE")),nl(Db,kN,n),nl(Db,kN,"esm2020"),nl("fire-js","")}IZ("");function Oj(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const CZ=Oj,Dj=new Py("auth","Firebase",Oj());const iv=new rI("@firebase/auth");function kZ(n,...e){iv.logLevel<=yn.WARN&&iv.warn(`Auth (${Nd}): ${n}`,...e)}function a_(n,...e){iv.logLevel<=yn.ERROR&&iv.error(`Auth (${Nd}): ${n}`,...e)}function hl(n,...e){throw oI(n,...e)}function wo(n,...e){return oI(n,...e)}function aI(n,e,t){const r={...CZ(),[e]:t};return new Py("auth","Firebase",r).create(e,{appName:n.name})}function Su(n){return aI(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function PZ(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&hl(n,"argument-error"),aI(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function oI(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return Dj.create(n,...e)}function Jt(n,e,...t){if(!n)throw oI(e,...t)}function Ul(n){const e="INTERNAL ASSERTION FAILED: "+n;throw a_(e),new Error(e)}function ac(n,e){n||Ul(e)}function Vb(){return typeof self<"u"&&self.location?.href||""}function MZ(){return ON()==="http:"||ON()==="https:"}function ON(){return typeof self<"u"&&self.location?.protocol||null}function NZ(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(MZ()||uY()||"connection"in navigator)?navigator.onLine:!0}function LZ(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class Ny{constructor(e,t){this.shortDelay=e,this.longDelay=t,ac(t>e,"Short delay should be less than long delay!"),this.isMobile=lY()||hY()}get(){return NZ()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function lI(n,e){ac(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class Fj{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ul("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ul("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ul("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const OZ={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const DZ=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],FZ=new Ny(3e4,6e4);function Xw(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function hg(n,e,t,r,i={}){return jj(n,i,async()=>{let s={},a={};r&&(e==="GET"?a=r:s={body:JSON.stringify(r)});const o=My({key:n.config.apiKey,...a}).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const c={method:e,headers:l,...s};return cY()||(c.referrerPolicy="no-referrer"),n.emulatorConfig&&Md(n.emulatorConfig.host)&&(c.credentials="include"),Fj.fetch()(await Gj(n,n.config.apiHost,t,o),c)})}async function jj(n,e,t){n._canInitEmulator=!1;const r={...OZ,...e};try{const i=new jZ(n),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw Ix(n,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const o=s.ok?a.errorMessage:a.error.message,[l,c]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ix(n,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw Ix(n,"email-already-in-use",a);if(l==="USER_DISABLED")throw Ix(n,"user-disabled",a);const h=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw aI(n,h,c);hl(n,h)}}catch(i){if(i instanceof xl)throw i;hl(n,"network-request-failed",{message:String(i)})}}async function Vj(n,e,t,r,i={}){const s=await hg(n,e,t,r,i);return"mfaPendingCredential"in s&&hl(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function Gj(n,e,t,r){const i=`${e}${t}?${r}`,s=n,a=s.config.emulator?lI(n.config,i):`${n.config.apiScheme}://${i}`;return DZ.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(a).toString():a}class jZ{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(wo(this.auth,"network-request-failed")),FZ.get())})}}function Ix(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=wo(n,e,r);return i.customData._tokenResponse=t,i}async function VZ(n,e){return hg(n,"POST","/v1/accounts:delete",e)}async function sv(n,e){return hg(n,"POST","/v1/accounts:lookup",e)}function Um(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function GZ(n,e=!1){const t=Mi(n),r=await t.getIdToken(e),i=cI(r);Jt(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s?.sign_in_provider;return{claims:i,token:r,authTime:Um(lS(i.auth_time)),issuedAtTime:Um(lS(i.iat)),expirationTime:Um(lS(i.exp)),signInProvider:a||null,signInSecondFactor:s?.sign_in_second_factor||null}}function lS(n){return Number(n)*1e3}function cI(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return a_("JWT malformed, contained fewer than 3 sections"),null;try{const i=_j(t);return i?JSON.parse(i):(a_("Failed to decode base64 JWT payload"),null)}catch(i){return a_("Caught error parsing JWT payload as JSON",i?.toString()),null}}function DN(n){const e=cI(n);return Jt(e,"internal-error"),Jt(typeof e.exp<"u","internal-error"),Jt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Fp(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof xl&&BZ(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function BZ({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class zZ{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Gb{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Um(this.lastLoginAt),this.creationTime=Um(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function av(n){const e=n.auth,t=await n.getIdToken(),r=await Fp(n,sv(e,{idToken:t}));Jt(r?.users.length,e,"internal-error");const i=r.users[0];n._notifyReloadListener(i);const s=i.providerUserInfo?.length?Bj(i.providerUserInfo):[],a=$Z(n.providerData,s),o=n.isAnonymous,l=!(n.email&&i.passwordHash)&&!a?.length,c=o?l:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new Gb(i.createdAt,i.lastLoginAt),isAnonymous:c};Object.assign(n,h)}async function UZ(n){const e=Mi(n);await av(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function $Z(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function Bj(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function WZ(n,e){const t=await jj(n,{},async()=>{const r=My({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,a=await Gj(n,i,"/v1/token",`key=${s}`),o=await n._getAdditionalHeaders();o["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:o,body:r};return n.emulatorConfig&&Md(n.emulatorConfig.host)&&(l.credentials="include"),Fj.fetch()(a,l)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function HZ(n,e){return hg(n,"POST","/v2/accounts:revokeToken",Xw(n,e))}class y0{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Jt(e.idToken,"internal-error"),Jt(typeof e.idToken<"u","internal-error"),Jt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):DN(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Jt(e.length!==0,"internal-error");const t=DN(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Jt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:s}=await WZ(e,t);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:s}=t,a=new y0;return r&&(Jt(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(Jt(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(Jt(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new y0,this.toJSON())}_performRefresh(){return Ul("not implemented")}}function Xc(n,e){Jt(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class po{constructor({uid:e,auth:t,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new zZ(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Gb(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await Fp(this,this.stsTokenManager.getToken(this.auth,e));return Jt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return GZ(this,e)}reload(){return UZ(this)}_assign(e){this!==e&&(Jt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new po({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Jt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await av(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ua(this.auth.app))return Promise.reject(Su(this.auth));const e=await this.getIdToken();return await Fp(this,VZ(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,i=t.email??void 0,s=t.phoneNumber??void 0,a=t.photoURL??void 0,o=t.tenantId??void 0,l=t._redirectEventId??void 0,c=t.createdAt??void 0,h=t.lastLoginAt??void 0,{uid:f,emailVerified:m,isAnonymous:y,providerData:x,stsTokenManager:_}=t;Jt(f&&_,e,"internal-error");const w=y0.fromJSON(this.name,_);Jt(typeof f=="string",e,"internal-error"),Xc(r,e.name),Xc(i,e.name),Jt(typeof m=="boolean",e,"internal-error"),Jt(typeof y=="boolean",e,"internal-error"),Xc(s,e.name),Xc(a,e.name),Xc(o,e.name),Xc(l,e.name),Xc(c,e.name),Xc(h,e.name);const S=new po({uid:f,auth:e,email:i,emailVerified:m,displayName:r,isAnonymous:y,photoURL:a,phoneNumber:s,tenantId:o,stsTokenManager:w,createdAt:c,lastLoginAt:h});return x&&Array.isArray(x)&&(S.providerData=x.map(b=>({...b}))),l&&(S._redirectEventId=l),S}static async _fromIdTokenResponse(e,t,r=!1){const i=new y0;i.updateFromServerResponse(t);const s=new po({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await av(s),s}static async _fromGetAccountInfoResponse(e,t,r){const i=t.users[0];Jt(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?Bj(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!s?.length,o=new y0;o.updateFromIdToken(r);const l=new po({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:a}),c={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Gb(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(l,c),l}}const FN=new Map;function $l(n){ac(n instanceof Function,"Expected a class definition");let e=FN.get(n);return e?(ac(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,FN.set(n,e),e)}class zj{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}zj.type="NONE";const jN=zj;function o_(n,e,t){return`firebase:${n}:${e}:${t}`}class x0{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=o_(this.userKey,i.apiKey,s),this.fullPersistenceKey=o_("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await sv(this.auth,{idToken:e}).catch(()=>{});return t?po._fromGetAccountInfoResponse(this.auth,t,e):null}return po._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new x0($l(jN),e,r);const i=(await Promise.all(t.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let s=i[0]||$l(jN);const a=o_(r,e.config.apiKey,e.name);let o=null;for(const c of t)try{const h=await c._get(a);if(h){let f;if(typeof h=="string"){const m=await sv(e,{idToken:h}).catch(()=>{});if(!m)break;f=await po._fromGetAccountInfoResponse(e,m,h)}else f=po._fromJSON(e,h);c!==s&&(o=f),s=c;break}}catch{}const l=i.filter(c=>c._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new x0(s,e,r):(s=l[0],o&&await s._set(a,o.toJSON()),await Promise.all(t.map(async c=>{if(c!==s)try{await c._remove(a)}catch{}})),new x0(s,e,r))}}function VN(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Hj(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Uj(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Xj(e))return"Blackberry";if(qj(e))return"Webos";if($j(e))return"Safari";if((e.includes("chrome/")||Wj(e))&&!e.includes("edge/"))return"Chrome";if(Kj(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function Uj(n=mi()){return/firefox\//i.test(n)}function $j(n=mi()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Wj(n=mi()){return/crios\//i.test(n)}function Hj(n=mi()){return/iemobile/i.test(n)}function Kj(n=mi()){return/android/i.test(n)}function Xj(n=mi()){return/blackberry/i.test(n)}function qj(n=mi()){return/webos/i.test(n)}function uI(n=mi()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function KZ(n=mi()){return uI(n)&&!!window.navigator?.standalone}function XZ(){return dY()&&document.documentMode===10}function Yj(n=mi()){return uI(n)||Kj(n)||qj(n)||Xj(n)||/windows phone/i.test(n)||Hj(n)}function Zj(n,e=[]){let t;switch(n){case"Browser":t=VN(mi());break;case"Worker":t=`${VN(mi())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Nd}/${r}`}class qZ{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=s=>new Promise((a,o)=>{try{const l=e(s);a(l)}catch(l){o(l)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function YZ(n,e={}){return hg(n,"GET","/v2/passwordPolicy",Xw(n,e))}const ZZ=6;class JZ{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??ZZ,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class QZ{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new GN(this),this.idTokenSubscription=new GN(this),this.beforeStateQueue=new qZ(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Dj,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=$l(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await x0.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await sv(this,{idToken:e}),r=await po._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(ua(this.app)){const s=this.app.settings.authIdToken;return s?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(a,a))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const s=this.redirectUser?._redirectEventId,a=r?._redirectEventId,o=await this.tryRedirectSignIn(e);(!s||s===a)&&o?.user&&(r=o.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(s){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Jt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await av(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=LZ()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ua(this.app))return Promise.reject(Su(this));const t=e?Mi(e):null;return t&&Jt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Jt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ua(this.app)?Promise.reject(Su(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ua(this.app)?Promise.reject(Su(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence($l(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await YZ(this),t=new JZ(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Py("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await HZ(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&$l(e)||this._popupRedirectResolver;Jt(t,this,"argument-error"),this.redirectPersistenceManager=await x0.create(this,[$l(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Jt(o,this,"internal-error"),o.then(()=>{a||s(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,r,i);return()=>{a=!0,l()}}else{const l=e.addObserver(t);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Jt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Zj(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(ua(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&kZ(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Ly(n){return Mi(n)}class GN{constructor(e){this.auth=e,this.observer=null,this.addObserver=xY(t=>this.observer=t)}get next(){return Jt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let hI={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function eJ(n){hI=n}function tJ(n){return hI.loadJS(n)}function nJ(){return hI.gapiScript}function rJ(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function iJ(n,e){const t=Kw(n,"auth");if(t.isInitialized()){const i=t.getImmediate(),s=t.getOptions();if(cd(s,e??{}))return i;hl(i,"already-initialized")}return t.initialize({options:e})}function sJ(n,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map($l);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function aJ(n,e,t){const r=Ly(n);Jt(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=Jj(e),{host:a,port:o}=oJ(e),l=o===null?"":`:${o}`,c={url:`${s}//${a}${l}/`},h=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){Jt(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Jt(cd(c,r.config.emulator)&&cd(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=c,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,Md(a)?(tI(`${s}//${a}${l}`),nI("Auth",!0)):lJ()}function Jj(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function oJ(n){const e=Jj(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:BN(r.substr(s.length+1))}}else{const[s,a]=r.split(":");return{host:s,port:BN(a)}}}function BN(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function lJ(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class Qj{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ul("not implemented")}_getIdTokenResponse(e){return Ul("not implemented")}_linkToIdToken(e,t){return Ul("not implemented")}_getReauthenticationResolver(e){return Ul("not implemented")}}async function _0(n,e){return Vj(n,"POST","/v1/accounts:signInWithIdp",Xw(n,e))}const cJ="http://localhost";class hd extends Qj{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new hd(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):hl("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...s}=t;if(!r||!i)return null;const a=new hd(r,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const t=this.buildRequest();return _0(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,_0(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,_0(e,t)}buildRequest(){const e={requestUri:cJ,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=My(t)}return e}}class dI{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Oy extends dI{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class iu extends Oy{constructor(){super("facebook.com")}static credential(e){return hd._fromParams({providerId:iu.PROVIDER_ID,signInMethod:iu.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return iu.credentialFromTaggedObject(e)}static credentialFromError(e){return iu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return iu.credential(e.oauthAccessToken)}catch{return null}}}iu.FACEBOOK_SIGN_IN_METHOD="facebook.com";iu.PROVIDER_ID="facebook.com";class fo extends Oy{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return hd._fromParams({providerId:fo.PROVIDER_ID,signInMethod:fo.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return fo.credentialFromTaggedObject(e)}static credentialFromError(e){return fo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return fo.credential(t,r)}catch{return null}}}fo.GOOGLE_SIGN_IN_METHOD="google.com";fo.PROVIDER_ID="google.com";class su extends Oy{constructor(){super("github.com")}static credential(e){return hd._fromParams({providerId:su.PROVIDER_ID,signInMethod:su.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return su.credentialFromTaggedObject(e)}static credentialFromError(e){return su.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return su.credential(e.oauthAccessToken)}catch{return null}}}su.GITHUB_SIGN_IN_METHOD="github.com";su.PROVIDER_ID="github.com";class au extends Oy{constructor(){super("twitter.com")}static credential(e,t){return hd._fromParams({providerId:au.PROVIDER_ID,signInMethod:au.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return au.credentialFromTaggedObject(e)}static credentialFromError(e){return au.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return au.credential(t,r)}catch{return null}}}au.TWITTER_SIGN_IN_METHOD="twitter.com";au.PROVIDER_ID="twitter.com";async function uJ(n,e){return Vj(n,"POST","/v1/accounts:signUp",Xw(n,e))}class Mu{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const s=await po._fromIdTokenResponse(e,r,i),a=zN(r);return new Mu({user:s,providerId:a,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=zN(r);return new Mu({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function zN(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}async function hJ(n){if(ua(n.app))return Promise.reject(Su(n));const e=Ly(n);if(await e._initializationPromise,e.currentUser?.isAnonymous)return new Mu({user:e.currentUser,providerId:null,operationType:"signIn"});const t=await uJ(e,{returnSecureToken:!0}),r=await Mu._fromIdTokenResponse(e,"signIn",t,!0);return await e._updateCurrentUser(r.user),r}class ov extends xl{constructor(e,t,r,i){super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,ov.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new ov(e,t,r,i)}}function e6(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?ov._fromErrorAndOperation(n,s,e,r):s})}async function dJ(n,e,t=!1){const r=await Fp(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Mu._forOperation(n,"link",r)}async function fJ(n,e,t=!1){const{auth:r}=n;if(ua(r.app))return Promise.reject(Su(r));const i="reauthenticate";try{const s=await Fp(n,e6(r,i,e,n),t);Jt(s.idToken,r,"internal-error");const a=cI(s.idToken);Jt(a,r,"internal-error");const{sub:o}=a;return Jt(n.uid===o,r,"user-mismatch"),Mu._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&hl(r,"user-mismatch"),s}}async function gJ(n,e,t=!1){if(ua(n.app))return Promise.reject(Su(n));const r="signIn",i=await e6(n,r,e),s=await Mu._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(s.user),s}function mJ(n,e,t,r){return Mi(n).onIdTokenChanged(e,t,r)}function pJ(n,e,t){return Mi(n).beforeAuthStateChanged(e,t)}function t6(n,e,t,r){return Mi(n).onAuthStateChanged(e,t,r)}function n6(n){return Mi(n).signOut()}const lv="__sak";class r6{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(lv,"1"),this.storage.removeItem(lv),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const yJ=1e3,xJ=10;class i6 extends r6{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Yj(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const r=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(r);!t&&this.localCache[r]===a||this.notifyListeners(r,a)},s=this.storage.getItem(r);XZ()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,xJ):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},yJ)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}i6.type="LOCAL";const _J=i6;class s6 extends r6{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}s6.type="SESSION";const a6=s6;function vJ(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class qw{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new qw(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:s}=t.data,a=this.handlersMap[i];if(!a?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const o=Array.from(a).map(async c=>c(t.origin,s)),l=await vJ(o);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}qw.receivers=[];function fI(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}class wJ{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((o,l)=>{const c=fI("",20);i.port1.start();const h=setTimeout(()=>{l(new Error("unsupported_event"))},r);a={messageChannel:i,onMessage(f){const m=f;if(m.data.eventId===c)switch(m.data.status){case"ack":clearTimeout(h),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),o(m.data.response);break;default:clearTimeout(h),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}function rl(){return window}function EJ(n){rl().location.href=n}function o6(){return typeof rl().WorkerGlobalScope<"u"&&typeof rl().importScripts=="function"}async function TJ(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function SJ(){return navigator?.serviceWorker?.controller||null}function bJ(){return o6()?self:null}const l6="firebaseLocalStorageDb",RJ=1,cv="firebaseLocalStorage",c6="fbase_key";class Dy{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Yw(n,e){return n.transaction([cv],e?"readwrite":"readonly").objectStore(cv)}function AJ(){const n=indexedDB.deleteDatabase(l6);return new Dy(n).toPromise()}function Bb(){const n=indexedDB.open(l6,RJ);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(cv,{keyPath:c6})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(cv)?e(r):(r.close(),await AJ(),e(await Bb()))})})}async function UN(n,e,t){const r=Yw(n,!0).put({[c6]:e,value:t});return new Dy(r).toPromise()}async function IJ(n,e){const t=Yw(n,!1).get(e),r=await new Dy(t).toPromise();return r===void 0?null:r.value}function $N(n,e){const t=Yw(n,!0).delete(e);return new Dy(t).toPromise()}const CJ=800,kJ=3;class u6{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Bb(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>kJ)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return o6()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=qw._getInstance(bJ()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await TJ(),!this.activeServiceWorker)return;this.sender=new wJ(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||SJ()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Bb();return await UN(e,lv,"1"),await $N(e,lv),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>UN(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>IJ(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>$N(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=Yw(i,!1).getAll();return new Dy(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),CJ)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}u6.type="LOCAL";const PJ=u6;new Ny(3e4,6e4);function h6(n,e){return e?$l(e):(Jt(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class gI extends Qj{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return _0(e,this._buildIdpRequest())}_linkToIdToken(e,t){return _0(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return _0(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function MJ(n){return gJ(n.auth,new gI(n),n.bypassAuthState)}function NJ(n){const{auth:e,user:t}=n;return Jt(t,e,"internal-error"),fJ(t,new gI(n),n.bypassAuthState)}async function LJ(n){const{auth:e,user:t}=n;return Jt(t,e,"internal-error"),dJ(t,new gI(n),n.bypassAuthState)}class d6{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:a,type:o}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return MJ;case"linkViaPopup":case"linkViaRedirect":return LJ;case"reauthViaPopup":case"reauthViaRedirect":return NJ;default:hl(this.auth,"internal-error")}}resolve(e){ac(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ac(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const OJ=new Ny(2e3,1e4);async function WN(n,e,t){if(ua(n.app))return Promise.reject(wo(n,"operation-not-supported-in-this-environment"));const r=Ly(n);PZ(n,e,dI);const i=h6(r,t);return new zh(r,"signInViaPopup",e,i).executeNotNull()}class zh extends d6{constructor(e,t,r,i,s){super(e,t,i,s),this.provider=r,this.authWindow=null,this.pollId=null,zh.currentPopupAction&&zh.currentPopupAction.cancel(),zh.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Jt(e,this.auth,"internal-error"),e}async onExecution(){ac(this.filter.length===1,"Popup operations only handle one event");const e=fI();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(wo(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(wo(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,zh.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(wo(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,OJ.get())};e()}}zh.currentPopupAction=null;const DJ="pendingRedirect",l_=new Map;class FJ extends d6{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=l_.get(this.auth._key());if(!e){try{const r=await jJ(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}l_.set(this.auth._key(),e)}return this.bypassAuthState||l_.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function jJ(n,e){const t=BJ(e),r=GJ(n);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}function VJ(n,e){l_.set(n._key(),e)}function GJ(n){return $l(n._redirectPersistence)}function BJ(n){return o_(DJ,n.config.apiKey,n.name)}async function zJ(n,e,t=!1){if(ua(n.app))return Promise.reject(Su(n));const r=Ly(n),i=h6(r,e),a=await new FJ(r,i,t).execute();return a&&!t&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}const UJ=600*1e3;class $J{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!WJ(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!f6(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(wo(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=UJ&&this.cachedEventUids.clear(),this.cachedEventUids.has(HN(e))}saveEventToCache(e){this.cachedEventUids.add(HN(e)),this.lastProcessedEventTime=Date.now()}}function HN(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function f6({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function WJ(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return f6(n);default:return!1}}async function HJ(n,e={}){return hg(n,"GET","/v1/projects",e)}const KJ=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,XJ=/^https?/;async function qJ(n){if(n.config.emulator)return;const{authorizedDomains:e}=await HJ(n);for(const t of e)try{if(YJ(t))return}catch{}hl(n,"unauthorized-domain")}function YJ(n){const e=Vb(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!XJ.test(t))return!1;if(KJ.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const ZJ=new Ny(3e4,6e4);function KN(){const n=rl().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function JJ(n){return new Promise((e,t)=>{function r(){KN(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{KN(),t(wo(n,"network-request-failed"))},timeout:ZJ.get()})}if(rl().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(rl().gapi?.load)r();else{const i=rJ("iframefcb");return rl()[i]=()=>{gapi.load?r():t(wo(n,"network-request-failed"))},tJ(`${nJ()}?onload=${i}`).catch(s=>t(s))}}).catch(e=>{throw c_=null,e})}let c_=null;function QJ(n){return c_=c_||JJ(n),c_}const eQ=new Ny(5e3,15e3),tQ="__/auth/iframe",nQ="emulator/auth/iframe",rQ={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},iQ=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function sQ(n){const e=n.config;Jt(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?lI(e,nQ):`https://${n.config.authDomain}/${tQ}`,r={apiKey:e.apiKey,appName:n.name,v:Nd},i=iQ.get(n.config.apiHost);i&&(r.eid=i);const s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${My(r).slice(1)}`}async function aQ(n){const e=await QJ(n),t=rl().gapi;return Jt(t,n,"internal-error"),e.open({where:document.body,url:sQ(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:rQ,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const a=wo(n,"network-request-failed"),o=rl().setTimeout(()=>{s(a)},eQ.get());function l(){rl().clearTimeout(o),i(r)}r.ping(l).then(l,()=>{s(a)})}))}const oQ={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},lQ=500,cQ=600,uQ="_blank",hQ="http://localhost";class XN{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function dQ(n,e,t,r=lQ,i=cQ){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let o="";const l={...oQ,width:r.toString(),height:i.toString(),top:s,left:a},c=mi().toLowerCase();t&&(o=Wj(c)?uQ:t),Uj(c)&&(e=e||hQ,l.scrollbars="yes");const h=Object.entries(l).reduce((m,[y,x])=>`${m}${y}=${x},`,"");if(KZ(c)&&o!=="_self")return fQ(e||"",o),new XN(null);const f=window.open(e||"",o,h);Jt(f,n,"popup-blocked");try{f.focus()}catch{}return new XN(f)}function fQ(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}const gQ="__/auth/handler",mQ="emulator/auth/handler",pQ=encodeURIComponent("fac");async function qN(n,e,t,r,i,s){Jt(n.config.authDomain,n,"auth-domain-config-required"),Jt(n.config.apiKey,n,"invalid-api-key");const a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Nd,eventId:i};if(e instanceof dI){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",yY(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,f]of Object.entries({}))a[h]=f}if(e instanceof Oy){const h=e.getScopes().filter(f=>f!=="");h.length>0&&(a.scopes=h.join(","))}n.tenantId&&(a.tid=n.tenantId);const o=a;for(const h of Object.keys(o))o[h]===void 0&&delete o[h];const l=await n._getAppCheckToken(),c=l?`#${pQ}=${encodeURIComponent(l)}`:"";return`${yQ(n)}?${My(o).slice(1)}${c}`}function yQ({config:n}){return n.emulator?lI(n,mQ):`https://${n.authDomain}/${gQ}`}const cS="webStorageSupport";class xQ{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=a6,this._completeRedirectFn=zJ,this._overrideRedirectResult=VJ}async _openPopup(e,t,r,i){ac(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const s=await qN(e,t,r,Vb(),i);return dQ(e,s,fI())}async _openRedirect(e,t,r,i){await this._originValidation(e);const s=await qN(e,t,r,Vb(),i);return EJ(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(ac(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await aQ(e),r=new $J(e);return t.register("authEvent",i=>(Jt(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(cS,{type:cS},i=>{const s=i?.[0]?.[cS];s!==void 0&&t(!!s),hl(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=qJ(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Yj()||$j()||uI()}}const _Q=xQ;var YN="@firebase/auth",ZN="1.12.0";class vQ{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Jt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function wQ(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function EQ(n){ud(new Pu("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=r.options;Jt(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:a,authDomain:o,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Zj(n)},c=new QZ(r,i,s,l);return sJ(c,t),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),ud(new Pu("auth-internal",e=>{const t=Ly(e.getProvider("auth").getImmediate());return(r=>new vQ(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),nl(YN,ZN,wQ(n)),nl(YN,ZN,"esm2020")}const TQ=300,SQ=Sj("authIdTokenMaxAge")||TQ;let JN=null;const bQ=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>SQ)return;const i=t?.token;JN!==i&&(JN=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function RQ(n=sI()){const e=Kw(n,"auth");if(e.isInitialized())return e.getImmediate();const t=iJ(n,{popupRedirectResolver:_Q,persistence:[PJ,_J,a6]}),r=Sj("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const a=bQ(s.toString());pJ(t,a,()=>a(t.currentUser)),mJ(t,o=>a(o))}}const i=wj("auth");return i&&aJ(t,`http://${i}`),t}function AQ(){return document.getElementsByTagName("head")?.[0]??document}eJ({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{const s=wo("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",AQ().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});EQ("Browser");var IQ="firebase",CQ="12.7.0";nl(IQ,CQ,"app");var QN=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var bu,g6;(function(){var n;function e(A,I){function P(){}P.prototype=I.prototype,A.F=I.prototype,A.prototype=new P,A.prototype.constructor=A,A.D=function(D,L,U){for(var j=Array(arguments.length-2),Ee=2;Ee<arguments.length;Ee++)j[Ee-2]=arguments[Ee];return I.prototype[L].apply(D,j)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(A,I,P){P||(P=0);const D=Array(16);if(typeof I=="string")for(var L=0;L<16;++L)D[L]=I.charCodeAt(P++)|I.charCodeAt(P++)<<8|I.charCodeAt(P++)<<16|I.charCodeAt(P++)<<24;else for(L=0;L<16;++L)D[L]=I[P++]|I[P++]<<8|I[P++]<<16|I[P++]<<24;I=A.g[0],P=A.g[1],L=A.g[2];let U=A.g[3],j;j=I+(U^P&(L^U))+D[0]+3614090360&4294967295,I=P+(j<<7&4294967295|j>>>25),j=U+(L^I&(P^L))+D[1]+3905402710&4294967295,U=I+(j<<12&4294967295|j>>>20),j=L+(P^U&(I^P))+D[2]+606105819&4294967295,L=U+(j<<17&4294967295|j>>>15),j=P+(I^L&(U^I))+D[3]+3250441966&4294967295,P=L+(j<<22&4294967295|j>>>10),j=I+(U^P&(L^U))+D[4]+4118548399&4294967295,I=P+(j<<7&4294967295|j>>>25),j=U+(L^I&(P^L))+D[5]+1200080426&4294967295,U=I+(j<<12&4294967295|j>>>20),j=L+(P^U&(I^P))+D[6]+2821735955&4294967295,L=U+(j<<17&4294967295|j>>>15),j=P+(I^L&(U^I))+D[7]+4249261313&4294967295,P=L+(j<<22&4294967295|j>>>10),j=I+(U^P&(L^U))+D[8]+1770035416&4294967295,I=P+(j<<7&4294967295|j>>>25),j=U+(L^I&(P^L))+D[9]+2336552879&4294967295,U=I+(j<<12&4294967295|j>>>20),j=L+(P^U&(I^P))+D[10]+4294925233&4294967295,L=U+(j<<17&4294967295|j>>>15),j=P+(I^L&(U^I))+D[11]+2304563134&4294967295,P=L+(j<<22&4294967295|j>>>10),j=I+(U^P&(L^U))+D[12]+1804603682&4294967295,I=P+(j<<7&4294967295|j>>>25),j=U+(L^I&(P^L))+D[13]+4254626195&4294967295,U=I+(j<<12&4294967295|j>>>20),j=L+(P^U&(I^P))+D[14]+2792965006&4294967295,L=U+(j<<17&4294967295|j>>>15),j=P+(I^L&(U^I))+D[15]+1236535329&4294967295,P=L+(j<<22&4294967295|j>>>10),j=I+(L^U&(P^L))+D[1]+4129170786&4294967295,I=P+(j<<5&4294967295|j>>>27),j=U+(P^L&(I^P))+D[6]+3225465664&4294967295,U=I+(j<<9&4294967295|j>>>23),j=L+(I^P&(U^I))+D[11]+643717713&4294967295,L=U+(j<<14&4294967295|j>>>18),j=P+(U^I&(L^U))+D[0]+3921069994&4294967295,P=L+(j<<20&4294967295|j>>>12),j=I+(L^U&(P^L))+D[5]+3593408605&4294967295,I=P+(j<<5&4294967295|j>>>27),j=U+(P^L&(I^P))+D[10]+38016083&4294967295,U=I+(j<<9&4294967295|j>>>23),j=L+(I^P&(U^I))+D[15]+3634488961&4294967295,L=U+(j<<14&4294967295|j>>>18),j=P+(U^I&(L^U))+D[4]+3889429448&4294967295,P=L+(j<<20&4294967295|j>>>12),j=I+(L^U&(P^L))+D[9]+568446438&4294967295,I=P+(j<<5&4294967295|j>>>27),j=U+(P^L&(I^P))+D[14]+3275163606&4294967295,U=I+(j<<9&4294967295|j>>>23),j=L+(I^P&(U^I))+D[3]+4107603335&4294967295,L=U+(j<<14&4294967295|j>>>18),j=P+(U^I&(L^U))+D[8]+1163531501&4294967295,P=L+(j<<20&4294967295|j>>>12),j=I+(L^U&(P^L))+D[13]+2850285829&4294967295,I=P+(j<<5&4294967295|j>>>27),j=U+(P^L&(I^P))+D[2]+4243563512&4294967295,U=I+(j<<9&4294967295|j>>>23),j=L+(I^P&(U^I))+D[7]+1735328473&4294967295,L=U+(j<<14&4294967295|j>>>18),j=P+(U^I&(L^U))+D[12]+2368359562&4294967295,P=L+(j<<20&4294967295|j>>>12),j=I+(P^L^U)+D[5]+4294588738&4294967295,I=P+(j<<4&4294967295|j>>>28),j=U+(I^P^L)+D[8]+2272392833&4294967295,U=I+(j<<11&4294967295|j>>>21),j=L+(U^I^P)+D[11]+1839030562&4294967295,L=U+(j<<16&4294967295|j>>>16),j=P+(L^U^I)+D[14]+4259657740&4294967295,P=L+(j<<23&4294967295|j>>>9),j=I+(P^L^U)+D[1]+2763975236&4294967295,I=P+(j<<4&4294967295|j>>>28),j=U+(I^P^L)+D[4]+1272893353&4294967295,U=I+(j<<11&4294967295|j>>>21),j=L+(U^I^P)+D[7]+4139469664&4294967295,L=U+(j<<16&4294967295|j>>>16),j=P+(L^U^I)+D[10]+3200236656&4294967295,P=L+(j<<23&4294967295|j>>>9),j=I+(P^L^U)+D[13]+681279174&4294967295,I=P+(j<<4&4294967295|j>>>28),j=U+(I^P^L)+D[0]+3936430074&4294967295,U=I+(j<<11&4294967295|j>>>21),j=L+(U^I^P)+D[3]+3572445317&4294967295,L=U+(j<<16&4294967295|j>>>16),j=P+(L^U^I)+D[6]+76029189&4294967295,P=L+(j<<23&4294967295|j>>>9),j=I+(P^L^U)+D[9]+3654602809&4294967295,I=P+(j<<4&4294967295|j>>>28),j=U+(I^P^L)+D[12]+3873151461&4294967295,U=I+(j<<11&4294967295|j>>>21),j=L+(U^I^P)+D[15]+530742520&4294967295,L=U+(j<<16&4294967295|j>>>16),j=P+(L^U^I)+D[2]+3299628645&4294967295,P=L+(j<<23&4294967295|j>>>9),j=I+(L^(P|~U))+D[0]+4096336452&4294967295,I=P+(j<<6&4294967295|j>>>26),j=U+(P^(I|~L))+D[7]+1126891415&4294967295,U=I+(j<<10&4294967295|j>>>22),j=L+(I^(U|~P))+D[14]+2878612391&4294967295,L=U+(j<<15&4294967295|j>>>17),j=P+(U^(L|~I))+D[5]+4237533241&4294967295,P=L+(j<<21&4294967295|j>>>11),j=I+(L^(P|~U))+D[12]+1700485571&4294967295,I=P+(j<<6&4294967295|j>>>26),j=U+(P^(I|~L))+D[3]+2399980690&4294967295,U=I+(j<<10&4294967295|j>>>22),j=L+(I^(U|~P))+D[10]+4293915773&4294967295,L=U+(j<<15&4294967295|j>>>17),j=P+(U^(L|~I))+D[1]+2240044497&4294967295,P=L+(j<<21&4294967295|j>>>11),j=I+(L^(P|~U))+D[8]+1873313359&4294967295,I=P+(j<<6&4294967295|j>>>26),j=U+(P^(I|~L))+D[15]+4264355552&4294967295,U=I+(j<<10&4294967295|j>>>22),j=L+(I^(U|~P))+D[6]+2734768916&4294967295,L=U+(j<<15&4294967295|j>>>17),j=P+(U^(L|~I))+D[13]+1309151649&4294967295,P=L+(j<<21&4294967295|j>>>11),j=I+(L^(P|~U))+D[4]+4149444226&4294967295,I=P+(j<<6&4294967295|j>>>26),j=U+(P^(I|~L))+D[11]+3174756917&4294967295,U=I+(j<<10&4294967295|j>>>22),j=L+(I^(U|~P))+D[2]+718787259&4294967295,L=U+(j<<15&4294967295|j>>>17),j=P+(U^(L|~I))+D[9]+3951481745&4294967295,A.g[0]=A.g[0]+I&4294967295,A.g[1]=A.g[1]+(L+(j<<21&4294967295|j>>>11))&4294967295,A.g[2]=A.g[2]+L&4294967295,A.g[3]=A.g[3]+U&4294967295}r.prototype.v=function(A,I){I===void 0&&(I=A.length);const P=I-this.blockSize,D=this.C;let L=this.h,U=0;for(;U<I;){if(L==0)for(;U<=P;)i(this,A,U),U+=this.blockSize;if(typeof A=="string"){for(;U<I;)if(D[L++]=A.charCodeAt(U++),L==this.blockSize){i(this,D),L=0;break}}else for(;U<I;)if(D[L++]=A[U++],L==this.blockSize){i(this,D),L=0;break}}this.h=L,this.o+=I},r.prototype.A=function(){var A=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);A[0]=128;for(var I=1;I<A.length-8;++I)A[I]=0;I=this.o*8;for(var P=A.length-8;P<A.length;++P)A[P]=I&255,I/=256;for(this.v(A),A=Array(16),I=0,P=0;P<4;++P)for(let D=0;D<32;D+=8)A[I++]=this.g[P]>>>D&255;return A};function s(A,I){var P=o;return Object.prototype.hasOwnProperty.call(P,A)?P[A]:P[A]=I(A)}function a(A,I){this.h=I;const P=[];let D=!0;for(let L=A.length-1;L>=0;L--){const U=A[L]|0;D&&U==I||(P[L]=U,D=!1)}this.g=P}var o={};function l(A){return-128<=A&&A<128?s(A,function(I){return new a([I|0],I<0?-1:0)}):new a([A|0],A<0?-1:0)}function c(A){if(isNaN(A)||!isFinite(A))return f;if(A<0)return w(c(-A));const I=[];let P=1;for(let D=0;A>=P;D++)I[D]=A/P|0,P*=4294967296;return new a(I,0)}function h(A,I){if(A.length==0)throw Error("number format error: empty string");if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(A.charAt(0)=="-")return w(h(A.substring(1),I));if(A.indexOf("-")>=0)throw Error('number format error: interior "-" character');const P=c(Math.pow(I,8));let D=f;for(let U=0;U<A.length;U+=8){var L=Math.min(8,A.length-U);const j=parseInt(A.substring(U,U+L),I);L<8?(L=c(Math.pow(I,L)),D=D.j(L).add(c(j))):(D=D.j(P),D=D.add(c(j)))}return D}var f=l(0),m=l(1),y=l(16777216);n=a.prototype,n.m=function(){if(_(this))return-w(this).m();let A=0,I=1;for(let P=0;P<this.g.length;P++){const D=this.i(P);A+=(D>=0?D:4294967296+D)*I,I*=4294967296}return A},n.toString=function(A){if(A=A||10,A<2||36<A)throw Error("radix out of range: "+A);if(x(this))return"0";if(_(this))return"-"+w(this).toString(A);const I=c(Math.pow(A,6));var P=this;let D="";for(;;){const L=M(P,I).g;P=S(P,L.j(I));let U=((P.g.length>0?P.g[0]:P.h)>>>0).toString(A);if(P=L,x(P))return U+D;for(;U.length<6;)U="0"+U;D=U+D}},n.i=function(A){return A<0?0:A<this.g.length?this.g[A]:this.h};function x(A){if(A.h!=0)return!1;for(let I=0;I<A.g.length;I++)if(A.g[I]!=0)return!1;return!0}function _(A){return A.h==-1}n.l=function(A){return A=S(this,A),_(A)?-1:x(A)?0:1};function w(A){const I=A.g.length,P=[];for(let D=0;D<I;D++)P[D]=~A.g[D];return new a(P,~A.h).add(m)}n.abs=function(){return _(this)?w(this):this},n.add=function(A){const I=Math.max(this.g.length,A.g.length),P=[];let D=0;for(let L=0;L<=I;L++){let U=D+(this.i(L)&65535)+(A.i(L)&65535),j=(U>>>16)+(this.i(L)>>>16)+(A.i(L)>>>16);D=j>>>16,U&=65535,j&=65535,P[L]=j<<16|U}return new a(P,P[P.length-1]&-2147483648?-1:0)};function S(A,I){return A.add(w(I))}n.j=function(A){if(x(this)||x(A))return f;if(_(this))return _(A)?w(this).j(w(A)):w(w(this).j(A));if(_(A))return w(this.j(w(A)));if(this.l(y)<0&&A.l(y)<0)return c(this.m()*A.m());const I=this.g.length+A.g.length,P=[];for(var D=0;D<2*I;D++)P[D]=0;for(D=0;D<this.g.length;D++)for(let L=0;L<A.g.length;L++){const U=this.i(D)>>>16,j=this.i(D)&65535,Ee=A.i(L)>>>16,ke=A.i(L)&65535;P[2*D+2*L]+=j*ke,b(P,2*D+2*L),P[2*D+2*L+1]+=U*ke,b(P,2*D+2*L+1),P[2*D+2*L+1]+=j*Ee,b(P,2*D+2*L+1),P[2*D+2*L+2]+=U*Ee,b(P,2*D+2*L+2)}for(A=0;A<I;A++)P[A]=P[2*A+1]<<16|P[2*A];for(A=I;A<2*I;A++)P[A]=0;return new a(P,0)};function b(A,I){for(;(A[I]&65535)!=A[I];)A[I+1]+=A[I]>>>16,A[I]&=65535,I++}function R(A,I){this.g=A,this.h=I}function M(A,I){if(x(I))throw Error("division by zero");if(x(A))return new R(f,f);if(_(A))return I=M(w(A),I),new R(w(I.g),w(I.h));if(_(I))return I=M(A,w(I)),new R(w(I.g),I.h);if(A.g.length>30){if(_(A)||_(I))throw Error("slowDivide_ only works with positive integers.");for(var P=m,D=I;D.l(A)<=0;)P=O(P),D=O(D);var L=G(P,1),U=G(D,1);for(D=G(D,2),P=G(P,2);!x(D);){var j=U.add(D);j.l(A)<=0&&(L=L.add(P),U=j),D=G(D,1),P=G(P,1)}return I=S(A,L.j(I)),new R(L,I)}for(L=f;A.l(I)>=0;){for(P=Math.max(1,Math.floor(A.m()/I.m())),D=Math.ceil(Math.log(P)/Math.LN2),D=D<=48?1:Math.pow(2,D-48),U=c(P),j=U.j(I);_(j)||j.l(A)>0;)P-=D,U=c(P),j=U.j(I);x(U)&&(U=m),L=L.add(U),A=S(A,j)}return new R(L,A)}n.B=function(A){return M(this,A).h},n.and=function(A){const I=Math.max(this.g.length,A.g.length),P=[];for(let D=0;D<I;D++)P[D]=this.i(D)&A.i(D);return new a(P,this.h&A.h)},n.or=function(A){const I=Math.max(this.g.length,A.g.length),P=[];for(let D=0;D<I;D++)P[D]=this.i(D)|A.i(D);return new a(P,this.h|A.h)},n.xor=function(A){const I=Math.max(this.g.length,A.g.length),P=[];for(let D=0;D<I;D++)P[D]=this.i(D)^A.i(D);return new a(P,this.h^A.h)};function O(A){const I=A.g.length+1,P=[];for(let D=0;D<I;D++)P[D]=A.i(D)<<1|A.i(D-1)>>>31;return new a(P,A.h)}function G(A,I){const P=I>>5;I%=32;const D=A.g.length-P,L=[];for(let U=0;U<D;U++)L[U]=I>0?A.i(U+P)>>>I|A.i(U+P+1)<<32-I:A.i(U+P);return new a(L,A.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,g6=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.B,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=c,a.fromString=h,bu=a}).apply(typeof QN<"u"?QN:typeof self<"u"?self:typeof window<"u"?window:{});var Cx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var m6,Rm,p6,u_,zb,y6,x6,_6;(function(){var n,e=Object.defineProperty;function t(v){v=[typeof globalThis=="object"&&globalThis,v,typeof window=="object"&&window,typeof self=="object"&&self,typeof Cx=="object"&&Cx];for(var k=0;k<v.length;++k){var F=v[k];if(F&&F.Math==Math)return F}throw Error("Cannot find global object")}var r=t(this);function i(v,k){if(k)e:{var F=r;v=v.split(".");for(var H=0;H<v.length-1;H++){var ge=v[H];if(!(ge in F))break e;F=F[ge]}v=v[v.length-1],H=F[v],k=k(H),k!=H&&k!=null&&e(F,v,{configurable:!0,writable:!0,value:k})}}i("Symbol.dispose",function(v){return v||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(v){return v||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(v){return v||function(k){var F=[],H;for(H in k)Object.prototype.hasOwnProperty.call(k,H)&&F.push([H,k[H]]);return F}});var s=s||{},a=this||self;function o(v){var k=typeof v;return k=="object"&&v!=null||k=="function"}function l(v,k,F){return v.call.apply(v.bind,arguments)}function c(v,k,F){return c=l,c.apply(null,arguments)}function h(v,k){var F=Array.prototype.slice.call(arguments,1);return function(){var H=F.slice();return H.push.apply(H,arguments),v.apply(this,H)}}function f(v,k){function F(){}F.prototype=k.prototype,v.Z=k.prototype,v.prototype=new F,v.prototype.constructor=v,v.Ob=function(H,ge,Ie){for(var lt=Array(arguments.length-2),rn=2;rn<arguments.length;rn++)lt[rn-2]=arguments[rn];return k.prototype[ge].apply(H,lt)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?v=>v&&AsyncContext.Snapshot.wrap(v):v=>v;function y(v){const k=v.length;if(k>0){const F=Array(k);for(let H=0;H<k;H++)F[H]=v[H];return F}return[]}function x(v,k){for(let H=1;H<arguments.length;H++){const ge=arguments[H];var F=typeof ge;if(F=F!="object"?F:ge?Array.isArray(ge)?"array":F:"null",F=="array"||F=="object"&&typeof ge.length=="number"){F=v.length||0;const Ie=ge.length||0;v.length=F+Ie;for(let lt=0;lt<Ie;lt++)v[F+lt]=ge[lt]}else v.push(ge)}}class _{constructor(k,F){this.i=k,this.j=F,this.h=0,this.g=null}get(){let k;return this.h>0?(this.h--,k=this.g,this.g=k.next,k.next=null):k=this.i(),k}}function w(v){a.setTimeout(()=>{throw v},0)}function S(){var v=A;let k=null;return v.g&&(k=v.g,v.g=v.g.next,v.g||(v.h=null),k.next=null),k}class b{constructor(){this.h=this.g=null}add(k,F){const H=R.get();H.set(k,F),this.h?this.h.next=H:this.g=H,this.h=H}}var R=new _(()=>new M,v=>v.reset());class M{constructor(){this.next=this.g=this.h=null}set(k,F){this.h=k,this.g=F,this.next=null}reset(){this.next=this.g=this.h=null}}let O,G=!1,A=new b,I=()=>{const v=Promise.resolve(void 0);O=()=>{v.then(P)}};function P(){for(var v;v=S();){try{v.h.call(v.g)}catch(F){w(F)}var k=R;k.j(v),k.h<100&&(k.h++,v.next=k.g,k.g=v)}G=!1}function D(){this.u=this.u,this.C=this.C}D.prototype.u=!1,D.prototype.dispose=function(){this.u||(this.u=!0,this.N())},D.prototype[Symbol.dispose]=function(){this.dispose()},D.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function L(v,k){this.type=v,this.g=this.target=k,this.defaultPrevented=!1}L.prototype.h=function(){this.defaultPrevented=!0};var U=(function(){if(!a.addEventListener||!Object.defineProperty)return!1;var v=!1,k=Object.defineProperty({},"passive",{get:function(){v=!0}});try{const F=()=>{};a.addEventListener("test",F,k),a.removeEventListener("test",F,k)}catch{}return v})();function j(v){return/^[\s\xa0]*$/.test(v)}function Ee(v,k){L.call(this,v?v.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,v&&this.init(v,k)}f(Ee,L),Ee.prototype.init=function(v,k){const F=this.type=v.type,H=v.changedTouches&&v.changedTouches.length?v.changedTouches[0]:null;this.target=v.target||v.srcElement,this.g=k,k=v.relatedTarget,k||(F=="mouseover"?k=v.fromElement:F=="mouseout"&&(k=v.toElement)),this.relatedTarget=k,H?(this.clientX=H.clientX!==void 0?H.clientX:H.pageX,this.clientY=H.clientY!==void 0?H.clientY:H.pageY,this.screenX=H.screenX||0,this.screenY=H.screenY||0):(this.clientX=v.clientX!==void 0?v.clientX:v.pageX,this.clientY=v.clientY!==void 0?v.clientY:v.pageY,this.screenX=v.screenX||0,this.screenY=v.screenY||0),this.button=v.button,this.key=v.key||"",this.ctrlKey=v.ctrlKey,this.altKey=v.altKey,this.shiftKey=v.shiftKey,this.metaKey=v.metaKey,this.pointerId=v.pointerId||0,this.pointerType=v.pointerType,this.state=v.state,this.i=v,v.defaultPrevented&&Ee.Z.h.call(this)},Ee.prototype.h=function(){Ee.Z.h.call(this);const v=this.i;v.preventDefault?v.preventDefault():v.returnValue=!1};var ke="closure_listenable_"+(Math.random()*1e6|0),Be=0;function Me(v,k,F,H,ge){this.listener=v,this.proxy=null,this.src=k,this.type=F,this.capture=!!H,this.ha=ge,this.key=++Be,this.da=this.fa=!1}function ce(v){v.da=!0,v.listener=null,v.proxy=null,v.src=null,v.ha=null}function Pe(v,k,F){for(const H in v)k.call(F,v[H],H,v)}function be(v,k){for(const F in v)k.call(void 0,v[F],F,v)}function se(v){const k={};for(const F in v)k[F]=v[F];return k}const V="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Z(v,k){let F,H;for(let ge=1;ge<arguments.length;ge++){H=arguments[ge];for(F in H)v[F]=H[F];for(let Ie=0;Ie<V.length;Ie++)F=V[Ie],Object.prototype.hasOwnProperty.call(H,F)&&(v[F]=H[F])}}function te(v){this.src=v,this.g={},this.h=0}te.prototype.add=function(v,k,F,H,ge){const Ie=v.toString();v=this.g[Ie],v||(v=this.g[Ie]=[],this.h++);const lt=ue(v,k,H,ge);return lt>-1?(k=v[lt],F||(k.fa=!1)):(k=new Me(k,this.src,Ie,!!H,ge),k.fa=F,v.push(k)),k};function ie(v,k){const F=k.type;if(F in v.g){var H=v.g[F],ge=Array.prototype.indexOf.call(H,k,void 0),Ie;(Ie=ge>=0)&&Array.prototype.splice.call(H,ge,1),Ie&&(ce(k),v.g[F].length==0&&(delete v.g[F],v.h--))}}function ue(v,k,F,H){for(let ge=0;ge<v.length;++ge){const Ie=v[ge];if(!Ie.da&&Ie.listener==k&&Ie.capture==!!F&&Ie.ha==H)return ge}return-1}var Ve="closure_lm_"+(Math.random()*1e6|0),Ge={};function ye(v,k,F,H,ge){if(Array.isArray(k)){for(let Ie=0;Ie<k.length;Ie++)ye(v,k[Ie],F,H,ge);return null}return F=tr(F),v&&v[ke]?v.J(k,F,o(H)?!!H.capture:!1,ge):pe(v,k,F,!1,H,ge)}function pe(v,k,F,H,ge,Ie){if(!k)throw Error("Invalid event type");const lt=o(ge)?!!ge.capture:!!ge;let rn=Qt(v);if(rn||(v[Ve]=rn=new te(v)),F=rn.add(k,F,H,lt,Ie),F.proxy)return F;if(H=Fe(),F.proxy=H,H.src=v,H.listener=F,v.addEventListener)U||(ge=lt),ge===void 0&&(ge=!1),v.addEventListener(k.toString(),H,ge);else if(v.attachEvent)v.attachEvent(Dt(k.toString()),H);else if(v.addListener&&v.removeListener)v.addListener(H);else throw Error("addEventListener and attachEvent are unavailable.");return F}function Fe(){function v(F){return k.call(v.src,v.listener,F)}const k=Kt;return v}function wt(v,k,F,H,ge){if(Array.isArray(k))for(var Ie=0;Ie<k.length;Ie++)wt(v,k[Ie],F,H,ge);else H=o(H)?!!H.capture:!!H,F=tr(F),v&&v[ke]?(v=v.i,Ie=String(k).toString(),Ie in v.g&&(k=v.g[Ie],F=ue(k,F,H,ge),F>-1&&(ce(k[F]),Array.prototype.splice.call(k,F,1),k.length==0&&(delete v.g[Ie],v.h--)))):v&&(v=Qt(v))&&(k=v.g[k.toString()],v=-1,k&&(v=ue(k,F,H,ge)),(F=v>-1?k[v]:null)&&jt(F))}function jt(v){if(typeof v!="number"&&v&&!v.da){var k=v.src;if(k&&k[ke])ie(k.i,v);else{var F=v.type,H=v.proxy;k.removeEventListener?k.removeEventListener(F,H,v.capture):k.detachEvent?k.detachEvent(Dt(F),H):k.addListener&&k.removeListener&&k.removeListener(H),(F=Qt(k))?(ie(F,v),F.h==0&&(F.src=null,k[Ve]=null)):ce(v)}}}function Dt(v){return v in Ge?Ge[v]:Ge[v]="on"+v}function Kt(v,k){if(v.da)v=!0;else{k=new Ee(k,this);const F=v.listener,H=v.ha||v.src;v.fa&&jt(v),v=F.call(H,k)}return v}function Qt(v){return v=v[Ve],v instanceof te?v:null}var ot="__closure_events_fn_"+(Math.random()*1e9>>>0);function tr(v){return typeof v=="function"?v:(v[ot]||(v[ot]=function(k){return v.handleEvent(k)}),v[ot])}function hn(){D.call(this),this.i=new te(this),this.M=this,this.G=null}f(hn,D),hn.prototype[ke]=!0,hn.prototype.removeEventListener=function(v,k,F,H){wt(this,v,k,F,H)};function cn(v,k){var F,H=v.G;if(H)for(F=[];H;H=H.G)F.push(H);if(v=v.M,H=k.type||k,typeof k=="string")k=new L(k,v);else if(k instanceof L)k.target=k.target||v;else{var ge=k;k=new L(H,v),Z(k,ge)}ge=!0;let Ie,lt;if(F)for(lt=F.length-1;lt>=0;lt--)Ie=k.g=F[lt],ge=sr(Ie,H,!0,k)&&ge;if(Ie=k.g=v,ge=sr(Ie,H,!0,k)&&ge,ge=sr(Ie,H,!1,k)&&ge,F)for(lt=0;lt<F.length;lt++)Ie=k.g=F[lt],ge=sr(Ie,H,!1,k)&&ge}hn.prototype.N=function(){if(hn.Z.N.call(this),this.i){var v=this.i;for(const k in v.g){const F=v.g[k];for(let H=0;H<F.length;H++)ce(F[H]);delete v.g[k],v.h--}}this.G=null},hn.prototype.J=function(v,k,F,H){return this.i.add(String(v),k,!1,F,H)},hn.prototype.K=function(v,k,F,H){return this.i.add(String(v),k,!0,F,H)};function sr(v,k,F,H){if(k=v.i.g[String(k)],!k)return!0;k=k.concat();let ge=!0;for(let Ie=0;Ie<k.length;++Ie){const lt=k[Ie];if(lt&&!lt.da&&lt.capture==F){const rn=lt.listener,zr=lt.ha||lt.src;lt.fa&&ie(v.i,lt),ge=rn.call(zr,H)!==!1&&ge}}return ge&&!H.defaultPrevented}function Ni(v,k){if(typeof v!="function")if(v&&typeof v.handleEvent=="function")v=c(v.handleEvent,v);else throw Error("Invalid listener argument");return Number(k)>2147483647?-1:a.setTimeout(v,k||0)}function Vn(v){v.g=Ni(()=>{v.g=null,v.i&&(v.i=!1,Vn(v))},v.l);const k=v.h;v.h=null,v.m.apply(null,k)}class Tr extends D{constructor(k,F){super(),this.m=k,this.l=F,this.h=null,this.i=!1,this.g=null}j(k){this.h=arguments,this.g?this.i=!0:Vn(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function oi(v){D.call(this),this.h=v,this.g={}}f(oi,D);var _t=[];function pn(v){Pe(v.g,function(k,F){this.g.hasOwnProperty(F)&&jt(k)},v),v.g={}}oi.prototype.N=function(){oi.Z.N.call(this),pn(this)},oi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Rn=a.JSON.stringify,Tt=a.JSON.parse,sn=class{stringify(v){return a.JSON.stringify(v,void 0)}parse(v){return a.JSON.parse(v,void 0)}};function Nt(){}function qi(){}var Nr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function li(){L.call(this,"d")}f(li,L);function nn(){L.call(this,"c")}f(nn,L);var Sr={},De=null;function xe(){return De=De||new hn}Sr.Ia="serverreachability";function _e(v){L.call(this,Sr.Ia,v)}f(_e,L);function Ft(v){const k=xe();cn(k,new _e(k))}Sr.STAT_EVENT="statevent";function N(v,k){L.call(this,Sr.STAT_EVENT,v),this.stat=k}f(N,L);function ut(v){const k=xe();cn(k,new N(k,v))}Sr.Ja="timingevent";function W(v,k){L.call(this,Sr.Ja,v),this.size=k}f(W,L);function re(v,k){if(typeof v!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){v()},k)}function ee(){this.g=!0}ee.prototype.ua=function(){this.g=!1};function ne(v,k,F,H,ge,Ie){v.info(function(){if(v.g)if(Ie){var lt="",rn=Ie.split("&");for(let Hn=0;Hn<rn.length;Hn++){var zr=rn[Hn].split("=");if(zr.length>1){const Xr=zr[0];zr=zr[1];const ea=Xr.split("_");lt=ea.length>=2&&ea[1]=="type"?lt+(Xr+"="+zr+"&"):lt+(Xr+"=redacted&")}}}else lt=null;else lt=Ie;return"XMLHTTP REQ ("+H+") [attempt "+ge+"]: "+k+`
`+F+`
`+lt})}function he(v,k,F,H,ge,Ie,lt){v.info(function(){return"XMLHTTP RESP ("+H+") [ attempt "+ge+"]: "+k+`
`+F+`
`+Ie+" "+lt})}function Ce(v,k,F,H){v.info(function(){return"XMLHTTP TEXT ("+k+"): "+He(v,F)+(H?" "+H:"")})}function je(v,k){v.info(function(){return"TIMEOUT: "+k})}ee.prototype.info=function(){};function He(v,k){if(!v.g)return k;if(!k)return null;try{const Ie=JSON.parse(k);if(Ie){for(v=0;v<Ie.length;v++)if(Array.isArray(Ie[v])){var F=Ie[v];if(!(F.length<2)){var H=F[1];if(Array.isArray(H)&&!(H.length<1)){var ge=H[0];if(ge!="noop"&&ge!="stop"&&ge!="close")for(let lt=1;lt<H.length;lt++)H[lt]=""}}}}return Rn(Ie)}catch{return k}}var Je={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Qe={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},xt;function St(){}f(St,Nt),St.prototype.g=function(){return new XMLHttpRequest},xt=new St;function An(v){return encodeURIComponent(String(v))}function B(v){var k=1;v=v.split(":");const F=[];for(;k>0&&v.length;)F.push(v.shift()),k--;return v.length&&F.push(v.join(":")),F}function Y(v,k,F,H){this.j=v,this.i=k,this.l=F,this.S=H||1,this.V=new oi(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new K}function K(){this.i=null,this.g="",this.h=!1}var q={},J={};function Q(v,k,F){v.M=1,v.A=wl(va(k)),v.u=F,v.R=!0,we(v,null)}function we(v,k){v.F=Date.now(),Re(v),v.B=va(v.A);var F=v.B,H=v.S;Array.isArray(H)||(H=[String(H)]),kg(F.i,"t",H),v.C=0,F=v.j.L,v.h=new K,v.g=y1(v.j,F?k:null,!v.u),v.P>0&&(v.O=new Tr(c(v.Y,v,v.g),v.P)),k=v.V,F=v.g,H=v.ba;var ge="readystatechange";Array.isArray(ge)||(ge&&(_t[0]=ge.toString()),ge=_t);for(let Ie=0;Ie<ge.length;Ie++){const lt=ye(F,ge[Ie],H||k.handleEvent,!1,k.h||k);if(!lt)break;k.g[lt.key]=lt}k=v.J?se(v.J):{},v.u?(v.v||(v.v="POST"),k["Content-Type"]="application/x-www-form-urlencoded",v.g.ea(v.B,v.v,v.u,k)):(v.v="GET",v.g.ea(v.B,v.v,null,k)),Ft(),ne(v.i,v.v,v.B,v.l,v.S,v.u)}Y.prototype.ba=function(v){v=v.target;const k=this.O;k&&Oo(v)==3?k.j():this.Y(v)},Y.prototype.Y=function(v){try{if(v==this.g)e:{const rn=Oo(this.g),zr=this.g.ya(),Hn=this.g.ca();if(!(rn<3)&&(rn!=3||this.g&&(this.h.h||this.g.la()||m1(this.g)))){this.K||rn!=4||zr==7||(zr==8||Hn<=0?Ft(3):Ft(2)),rt(this);var k=this.g.ca();this.X=k;var F=Le(this);if(this.o=k==200,he(this.i,this.v,this.B,this.l,this.S,rn,k),this.o){if(this.U&&!this.L){t:{if(this.g){var H,ge=this.g;if((H=ge.g?ge.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!j(H)){var Ie=H;break t}}Ie=null}if(v=Ie)Ce(this.i,this.l,v,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Ye(this,v);else{this.o=!1,this.m=3,ut(12),qe(this),pt(this);break e}}if(this.R){v=!0;let Xr;for(;!this.K&&this.C<F.length;)if(Xr=Se(this,F),Xr==J){rn==4&&(this.m=4,ut(14),v=!1),Ce(this.i,this.l,null,"[Incomplete Response]");break}else if(Xr==q){this.m=4,ut(15),Ce(this.i,this.l,F,"[Invalid Chunk]"),v=!1;break}else Ce(this.i,this.l,Xr,null),Ye(this,Xr);if(ve(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),rn!=4||F.length!=0||this.h.h||(this.m=1,ut(16),v=!1),this.o=this.o&&v,!v)Ce(this.i,this.l,F,"[Invalid Chunked Response]"),qe(this),pt(this);else if(F.length>0&&!this.W){this.W=!0;var lt=this.j;lt.g==this&&lt.aa&&!lt.P&&(lt.j.info("Great, no buffering proxy detected. Bytes received: "+F.length),sh(lt),lt.P=!0,ut(11))}}else Ce(this.i,this.l,F,null),Ye(this,F);rn==4&&qe(this),this.o&&!this.K&&(rn==4?Yd(this.j,this):(this.o=!1,Re(this)))}else Mg(this.g),k==400&&F.indexOf("Unknown SID")>0?(this.m=3,ut(12)):(this.m=0,ut(13)),qe(this),pt(this)}}}catch{}};function Le(v){if(!ve(v))return v.g.la();const k=m1(v.g);if(k==="")return"";let F="";const H=k.length,ge=Oo(v.g)==4;if(!v.h.i){if(typeof TextDecoder>"u")return qe(v),pt(v),"";v.h.i=new a.TextDecoder}for(let Ie=0;Ie<H;Ie++)v.h.h=!0,F+=v.h.i.decode(k[Ie],{stream:!(ge&&Ie==H-1)});return k.length=0,v.h.g+=F,v.C=0,v.h.g}function ve(v){return v.g?v.v=="GET"&&v.M!=2&&v.j.Aa:!1}function Se(v,k){var F=v.C,H=k.indexOf(`
`,F);return H==-1?J:(F=Number(k.substring(F,H)),isNaN(F)?q:(H+=1,H+F>k.length?J:(k=k.slice(H,H+F),v.C=H+F,k)))}Y.prototype.cancel=function(){this.K=!0,qe(this)};function Re(v){v.T=Date.now()+v.H,Xe(v,v.H)}function Xe(v,k){if(v.D!=null)throw Error("WatchDog timer not null");v.D=re(c(v.aa,v),k)}function rt(v){v.D&&(a.clearTimeout(v.D),v.D=null)}Y.prototype.aa=function(){this.D=null;const v=Date.now();v-this.T>=0?(je(this.i,this.B),this.M!=2&&(Ft(),ut(17)),qe(this),this.m=2,pt(this)):Xe(this,this.T-v)};function pt(v){v.j.I==0||v.K||Yd(v.j,v)}function qe(v){rt(v);var k=v.O;k&&typeof k.dispose=="function"&&k.dispose(),v.O=null,pn(v.V),v.g&&(k=v.g,v.g=null,k.abort(),k.dispose())}function Ye(v,k){try{var F=v.j;if(F.I!=0&&(F.g==v||Ya(F.h,v))){if(!v.L&&Ya(F.h,v)&&F.I==3){try{var H=F.Ba.g.parse(k)}catch{H=null}if(Array.isArray(H)&&H.length==3){var ge=H;if(ge[0]==0){e:if(!F.v){if(F.g)if(F.g.F+3e3<v.F)qd(F),Js(F);else break e;jo(F),ut(18)}}else F.xa=ge[1],0<F.xa-F.K&&ge[2]<37500&&F.F&&F.A==0&&!F.C&&(F.C=re(c(F.Va,F),6e3));pr(F.h)<=1&&F.ta&&(F.ta=void 0)}else Qs(F,11)}else if((v.L||F.g==v)&&qd(F),!j(k))for(ge=F.Ba.g.parse(k),k=0;k<ge.length;k++){let Hn=ge[k];const Xr=Hn[0];if(!(Xr<=F.K))if(F.K=Xr,Hn=Hn[1],F.I==2)if(Hn[0]=="c"){F.M=Hn[1],F.ba=Hn[2];const ea=Hn[3];ea!=null&&(F.ka=ea,F.j.info("VER="+F.ka));const Rl=Hn[4];Rl!=null&&(F.za=Rl,F.j.info("SVER="+F.za));const Vo=Hn[5];Vo!=null&&typeof Vo=="number"&&Vo>0&&(H=1.5*Vo,F.O=H,F.j.info("backChannelRequestTimeoutMs_="+H)),H=F;const Go=v.g;if(Go){const Qd=Go.g?Go.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Qd){var Ie=H.h;Ie.g||Qd.indexOf("spdy")==-1&&Qd.indexOf("quic")==-1&&Qd.indexOf("h2")==-1||(Ie.j=Ie.l,Ie.g=new Set,Ie.h&&(_a(Ie,Ie.h),Ie.h=null))}if(H.G){const Og=Go.g?Go.g.getResponseHeader("X-HTTP-Session-Id"):null;Og&&(H.wa=Og,Nn(H.J,H.G,Og))}}F.I=3,F.l&&F.l.ra(),F.aa&&(F.T=Date.now()-v.F,F.j.info("Handshake RTT: "+F.T+"ms")),H=F;var lt=v;if(H.na=Lg(H,H.L?H.ba:null,H.W),lt.L){Ys(H.h,lt);var rn=lt,zr=H.O;zr&&(rn.H=zr),rn.D&&(rt(rn),Re(rn)),H.g=lt}else Yi(H);F.i.length>0&&bl(F)}else Hn[0]!="stop"&&Hn[0]!="close"||Qs(F,7);else F.I==3&&(Hn[0]=="stop"||Hn[0]=="close"?Hn[0]=="stop"?Qs(F,7):Kd(F):Hn[0]!="noop"&&F.l&&F.l.qa(Hn),F.A=0)}}Ft(4)}catch{}}var Xt=class{constructor(v,k){this.g=v,this.map=k}};function Gn(v){this.l=v||10,a.PerformanceNavigationTiming?(v=a.performance.getEntriesByType("navigation"),v=v.length>0&&(v[0].nextHopProtocol=="hq"||v[0].nextHopProtocol=="h2")):v=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=v?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Wn(v){return v.h?!0:v.g?v.g.size>=v.j:!1}function pr(v){return v.h?1:v.g?v.g.size:0}function Ya(v,k){return v.h?v.h==k:v.g?v.g.has(k):!1}function _a(v,k){v.g?v.g.add(k):v.h=k}function Ys(v,k){v.h&&v.h==k?v.h=null:v.g&&v.g.has(k)&&v.g.delete(k)}Gn.prototype.cancel=function(){if(this.i=Br(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const v of this.g.values())v.cancel();this.g.clear()}};function Br(v){if(v.h!=null)return v.i.concat(v.h.G);if(v.g!=null&&v.g.size!==0){let k=v.i;for(const F of v.g.values())k=k.concat(F.G);return k}return y(v.i)}var Ec=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function br(v,k){if(v){v=v.split("&");for(let F=0;F<v.length;F++){const H=v[F].indexOf("=");let ge,Ie=null;H>=0?(ge=v[F].substring(0,H),Ie=v[F].substring(H+1)):ge=v[F],k(ge,Ie?decodeURIComponent(Ie.replace(/\+/g," ")):"")}}}function Co(v){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let k;v instanceof Co?(this.l=v.l,Qu(this,v.j),this.o=v.o,this.g=v.g,ko(this,v.u),this.h=v.h,Tc(this,Pg(v.i)),this.m=v.m):v&&(k=String(v).match(Ec))?(this.l=!1,Qu(this,k[1]||"",!0),this.o=eh(k[2]||""),this.g=eh(k[3]||"",!0),ko(this,k[4]),this.h=eh(k[5]||"",!0),Tc(this,k[6]||"",!0),this.m=eh(k[7]||"")):(this.l=!1,this.i=new vn(null,this.l))}Co.prototype.toString=function(){const v=[];var k=this.j;k&&v.push(th(k,bg,!0),":");var F=this.g;return(F||k=="file")&&(v.push("//"),(k=this.o)&&v.push(th(k,bg,!0),"@"),v.push(An(F).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),F=this.u,F!=null&&v.push(":",String(F))),(F=this.h)&&(this.g&&F.charAt(0)!="/"&&v.push("/"),v.push(th(F,F.charAt(0)=="/"?nh:Rg,!0))),(F=this.i.toString())&&v.push("?",F),(F=this.m)&&v.push("#",th(F,Ag)),v.join("")},Co.prototype.resolve=function(v){const k=va(this);let F=!!v.j;F?Qu(k,v.j):F=!!v.o,F?k.o=v.o:F=!!v.g,F?k.g=v.g:F=v.u!=null;var H=v.h;if(F)ko(k,v.u);else if(F=!!v.h){if(H.charAt(0)!="/")if(this.g&&!this.h)H="/"+H;else{var ge=k.h.lastIndexOf("/");ge!=-1&&(H=k.h.slice(0,ge+1)+H)}if(ge=H,ge==".."||ge==".")H="";else if(ge.indexOf("./")!=-1||ge.indexOf("/.")!=-1){H=ge.lastIndexOf("/",0)==0,ge=ge.split("/");const Ie=[];for(let lt=0;lt<ge.length;){const rn=ge[lt++];rn=="."?H&&lt==ge.length&&Ie.push(""):rn==".."?((Ie.length>1||Ie.length==1&&Ie[0]!="")&&Ie.pop(),H&&lt==ge.length&&Ie.push("")):(Ie.push(rn),H=!0)}H=Ie.join("/")}else H=ge}return F?k.h=H:F=v.i.toString()!=="",F?Tc(k,Pg(v.i)):F=!!v.m,F&&(k.m=v.m),k};function va(v){return new Co(v)}function Qu(v,k,F){v.j=F?eh(k,!0):k,v.j&&(v.j=v.j.replace(/:$/,""))}function ko(v,k){if(k){if(k=Number(k),isNaN(k)||k<0)throw Error("Bad port number "+k);v.u=k}else v.u=null}function Tc(v,k,F){k instanceof vn?(v.i=k,$d(v.i,v.l)):(F||(k=th(k,HE)),v.i=new vn(k,v.l))}function Nn(v,k,F){v.i.set(k,F)}function wl(v){return Nn(v,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),v}function eh(v,k){return v?k?decodeURI(v.replace(/%25/g,"%2525")):decodeURIComponent(v):""}function th(v,k,F){return typeof v=="string"?(v=encodeURI(v).replace(k,Sg),F&&(v=v.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),v):null}function Sg(v){return v=v.charCodeAt(0),"%"+(v>>4&15).toString(16)+(v&15).toString(16)}var bg=/[#\/\?@]/g,Rg=/[#\?:]/g,nh=/[#\?]/g,HE=/[#\?@]/g,Ag=/#/g;function vn(v,k){this.h=this.g=null,this.i=v||null,this.j=!!k}function Po(v){v.g||(v.g=new Map,v.h=0,v.i&&br(v.i,function(k,F){v.add(decodeURIComponent(k.replace(/\+/g," ")),F)}))}n=vn.prototype,n.add=function(v,k){Po(this),this.i=null,v=Mo(this,v);let F=this.g.get(v);return F||this.g.set(v,F=[]),F.push(k),this.h+=1,this};function Ig(v,k){Po(v),k=Mo(v,k),v.g.has(k)&&(v.i=null,v.h-=v.g.get(k).length,v.g.delete(k))}function Ud(v,k){return Po(v),k=Mo(v,k),v.g.has(k)}n.forEach=function(v,k){Po(this),this.g.forEach(function(F,H){F.forEach(function(ge){v.call(k,ge,H,this)},this)},this)};function Cg(v,k){Po(v);let F=[];if(typeof k=="string")Ud(v,k)&&(F=F.concat(v.g.get(Mo(v,k))));else for(v=Array.from(v.g.values()),k=0;k<v.length;k++)F=F.concat(v[k]);return F}n.set=function(v,k){return Po(this),this.i=null,v=Mo(this,v),Ud(this,v)&&(this.h-=this.g.get(v).length),this.g.set(v,[k]),this.h+=1,this},n.get=function(v,k){return v?(v=Cg(this,v),v.length>0?String(v[0]):k):k};function kg(v,k,F){Ig(v,k),F.length>0&&(v.i=null,v.g.set(Mo(v,k),y(F)),v.h+=F.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const v=[],k=Array.from(this.g.keys());for(let H=0;H<k.length;H++){var F=k[H];const ge=An(F);F=Cg(this,F);for(let Ie=0;Ie<F.length;Ie++){let lt=ge;F[Ie]!==""&&(lt+="="+An(F[Ie])),v.push(lt)}}return this.i=v.join("&")};function Pg(v){const k=new vn;return k.i=v.i,v.g&&(k.g=new Map(v.g),k.h=v.h),k}function Mo(v,k){return k=String(k),v.j&&(k=k.toLowerCase()),k}function $d(v,k){k&&!v.j&&(Po(v),v.i=null,v.g.forEach(function(F,H){const ge=H.toLowerCase();H!=ge&&(Ig(this,H),kg(this,ge,F))},v)),v.j=k}function No(v,k){const F=new ee;if(a.Image){const H=new Image;H.onload=h(Li,F,"TestLoadImage: loaded",!0,k,H),H.onerror=h(Li,F,"TestLoadImage: error",!1,k,H),H.onabort=h(Li,F,"TestLoadImage: abort",!1,k,H),H.ontimeout=h(Li,F,"TestLoadImage: timeout",!1,k,H),a.setTimeout(function(){H.ontimeout&&H.ontimeout()},1e4),H.src=v}else k(!1)}function Lo(v,k){const F=new ee,H=new AbortController,ge=setTimeout(()=>{H.abort(),Li(F,"TestPingServer: timeout",!1,k)},1e4);fetch(v,{signal:H.signal}).then(Ie=>{clearTimeout(ge),Ie.ok?Li(F,"TestPingServer: ok",!0,k):Li(F,"TestPingServer: server error",!1,k)}).catch(()=>{clearTimeout(ge),Li(F,"TestPingServer: error",!1,k)})}function Li(v,k,F,H,ge){try{ge&&(ge.onload=null,ge.onerror=null,ge.onabort=null,ge.ontimeout=null),H(F)}catch{}}function rh(){this.g=new sn}function El(v){this.i=v.Sb||null,this.h=v.ab||!1}f(El,Nt),El.prototype.g=function(){return new Zs(this.i,this.h)};function Zs(v,k){hn.call(this),this.H=v,this.o=k,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}f(Zs,hn),n=Zs.prototype,n.open=function(v,k){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=v,this.D=k,this.readyState=1,Za(this)},n.send=function(v){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const k={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};v&&(k.body=v),(this.H||a).fetch(new Request(this.D,k)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Sc(this)),this.readyState=0},n.Pa=function(v){if(this.g&&(this.l=v,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=v.headers,this.readyState=2,Za(this)),this.g&&(this.readyState=3,Za(this),this.g)))if(this.responseType==="arraybuffer")v.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in v){if(this.j=v.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;d1(this)}else v.text().then(this.Oa.bind(this),this.ga.bind(this))};function d1(v){v.j.read().then(v.Ma.bind(v)).catch(v.ga.bind(v))}n.Ma=function(v){if(this.g){if(this.o&&v.value)this.response.push(v.value);else if(!this.o){var k=v.value?v.value:new Uint8Array(0);(k=this.B.decode(k,{stream:!v.done}))&&(this.response=this.responseText+=k)}v.done?Sc(this):Za(this),this.readyState==3&&d1(this)}},n.Oa=function(v){this.g&&(this.response=this.responseText=v,Sc(this))},n.Na=function(v){this.g&&(this.response=v,Sc(this))},n.ga=function(){this.g&&Sc(this)};function Sc(v){v.readyState=4,v.l=null,v.j=null,v.B=null,Za(v)}n.setRequestHeader=function(v,k){this.A.append(v,k)},n.getResponseHeader=function(v){return this.h&&this.h.get(v.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const v=[],k=this.h.entries();for(var F=k.next();!F.done;)F=F.value,v.push(F[0]+": "+F[1]),F=k.next();return v.join(`\r
`)};function Za(v){v.onreadystatechange&&v.onreadystatechange.call(v)}Object.defineProperty(Zs.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(v){this.m=v?"include":"same-origin"}});function f1(v){let k="";return Pe(v,function(F,H){k+=H,k+=":",k+=F,k+=`\r
`}),k}function Wd(v,k,F){e:{for(H in F){var H=!1;break e}H=!0}H||(F=f1(F),typeof v=="string"?F!=null&&An(F):Nn(v,k,F))}function ar(v){hn.call(this),this.headers=new Map,this.L=v||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}f(ar,hn);var g1=/^https?$/i,KE=["POST","PUT"];n=ar.prototype,n.Fa=function(v){this.H=v},n.ea=function(v,k,F,H){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+v);k=k?k.toUpperCase():"GET",this.D=v,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():xt.g(),this.g.onreadystatechange=m(c(this.Ca,this));try{this.B=!0,this.g.open(k,String(v),!0),this.B=!1}catch(Ie){bc(this,Ie);return}if(v=F||"",F=new Map(this.headers),H)if(Object.getPrototypeOf(H)===Object.prototype)for(var ge in H)F.set(ge,H[ge]);else if(typeof H.keys=="function"&&typeof H.get=="function")for(const Ie of H.keys())F.set(Ie,H.get(Ie));else throw Error("Unknown input type for opt_headers: "+String(H));H=Array.from(F.keys()).find(Ie=>Ie.toLowerCase()=="content-type"),ge=a.FormData&&v instanceof a.FormData,!(Array.prototype.indexOf.call(KE,k,void 0)>=0)||H||ge||F.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Ie,lt]of F)this.g.setRequestHeader(Ie,lt);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(v),this.v=!1}catch(Ie){bc(this,Ie)}};function bc(v,k){v.h=!1,v.g&&(v.j=!0,v.g.abort(),v.j=!1),v.l=k,v.o=5,Rc(v),Sl(v)}function Rc(v){v.A||(v.A=!0,cn(v,"complete"),cn(v,"error"))}n.abort=function(v){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=v||7,cn(this,"complete"),cn(this,"abort"),Sl(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Sl(this,!0)),ar.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Tl(this):this.Xa())},n.Xa=function(){Tl(this)};function Tl(v){if(v.h&&typeof s<"u"){if(v.v&&Oo(v)==4)setTimeout(v.Ca.bind(v),0);else if(cn(v,"readystatechange"),Oo(v)==4){v.h=!1;try{const Ie=v.ca();e:switch(Ie){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var k=!0;break e;default:k=!1}var F;if(!(F=k)){var H;if(H=Ie===0){let lt=String(v.D).match(Ec)[1]||null;!lt&&a.self&&a.self.location&&(lt=a.self.location.protocol.slice(0,-1)),H=!g1.test(lt?lt.toLowerCase():"")}F=H}if(F)cn(v,"complete"),cn(v,"success");else{v.o=6;try{var ge=Oo(v)>2?v.g.statusText:""}catch{ge=""}v.l=ge+" ["+v.ca()+"]",Rc(v)}}finally{Sl(v)}}}}function Sl(v,k){if(v.g){v.m&&(clearTimeout(v.m),v.m=null);const F=v.g;v.g=null,k||cn(v,"ready");try{F.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Oo(v){return v.g?v.g.readyState:0}n.ca=function(){try{return Oo(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(v){if(this.g){var k=this.g.responseText;return v&&k.indexOf(v)==0&&(k=k.substring(v.length)),Tt(k)}};function m1(v){try{if(!v.g)return null;if("response"in v.g)return v.g.response;switch(v.F){case"":case"text":return v.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in v.g)return v.g.mozResponseArrayBuffer}return null}catch{return null}}function Mg(v){const k={};v=(v.g&&Oo(v)>=2&&v.g.getAllResponseHeaders()||"").split(`\r
`);for(let H=0;H<v.length;H++){if(j(v[H]))continue;var F=B(v[H]);const ge=F[0];if(F=F[1],typeof F!="string")continue;F=F.trim();const Ie=k[ge]||[];k[ge]=Ie,Ie.push(F)}be(k,function(H){return H.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Do(v,k,F){return F&&F.internalChannelParams&&F.internalChannelParams[v]||k}function Hd(v){this.za=0,this.i=[],this.j=new ee,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Do("failFast",!1,v),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Do("baseRetryDelayMs",5e3,v),this.Za=Do("retryDelaySeedMs",1e4,v),this.Ta=Do("forwardChannelMaxRetries",2,v),this.va=Do("forwardChannelRequestTimeoutMs",2e4,v),this.ma=v&&v.xmlHttpFactory||void 0,this.Ua=v&&v.Rb||void 0,this.Aa=v&&v.useFetchStreams||!1,this.O=void 0,this.L=v&&v.supportsCrossDomainXhr||!1,this.M="",this.h=new Gn(v&&v.concurrentRequestLimit),this.Ba=new rh,this.S=v&&v.fastHandshake||!1,this.R=v&&v.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=v&&v.Pb||!1,v&&v.ua&&this.j.ua(),v&&v.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&v&&v.detectBufferingProxy||!1,this.ia=void 0,v&&v.longPollingTimeout&&v.longPollingTimeout>0&&(this.ia=v.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Hd.prototype,n.ka=8,n.I=1,n.connect=function(v,k,F,H){ut(0),this.W=v,this.H=k||{},F&&H!==void 0&&(this.H.OSID=F,this.H.OAID=H),this.F=this.X,this.J=Lg(this,null,this.W),bl(this)};function Kd(v){if(Xd(v),v.I==3){var k=v.V++,F=va(v.J);if(Nn(F,"SID",v.M),Nn(F,"RID",k),Nn(F,"TYPE","terminate"),Fo(v,F),k=new Y(v,v.j,k),k.M=2,k.A=wl(va(F)),F=!1,a.navigator&&a.navigator.sendBeacon)try{F=a.navigator.sendBeacon(k.A.toString(),"")}catch{}!F&&a.Image&&(new Image().src=k.A,F=!0),F||(k.g=y1(k.j,null),k.g.ea(k.A)),k.F=Date.now(),Re(k)}ah(v)}function Js(v){v.g&&(sh(v),v.g.cancel(),v.g=null)}function Xd(v){Js(v),v.v&&(a.clearTimeout(v.v),v.v=null),qd(v),v.h.cancel(),v.m&&(typeof v.m=="number"&&a.clearTimeout(v.m),v.m=null)}function bl(v){if(!Wn(v.h)&&!v.m){v.m=!0;var k=v.Ea;O||I(),G||(O(),G=!0),A.add(k,v),v.D=0}}function p1(v,k){return pr(v.h)>=v.h.j-(v.m?1:0)?!1:v.m?(v.i=k.G.concat(v.i),!0):v.I==1||v.I==2||v.D>=(v.Sa?0:v.Ta)?!1:(v.m=re(c(v.Ea,v,k),Zd(v,v.D)),v.D++,!0)}n.Ea=function(v){if(this.m)if(this.m=null,this.I==1){if(!v){this.V=Math.floor(Math.random()*1e5),v=this.V++;const ge=new Y(this,this.j,v);let Ie=this.o;if(this.U&&(Ie?(Ie=se(Ie),Z(Ie,this.U)):Ie=this.U),this.u!==null||this.R||(ge.J=Ie,Ie=null),this.S)e:{for(var k=0,F=0;F<this.i.length;F++){t:{var H=this.i[F];if("__data__"in H.map&&(H=H.map.__data__,typeof H=="string")){H=H.length;break t}H=void 0}if(H===void 0)break;if(k+=H,k>4096){k=F;break e}if(k===4096||F===this.i.length-1){k=F+1;break e}}k=1e3}else k=1e3;k=Ng(this,ge,k),F=va(this.J),Nn(F,"RID",v),Nn(F,"CVER",22),this.G&&Nn(F,"X-HTTP-Session-Id",this.G),Fo(this,F),Ie&&(this.R?k="headers="+An(f1(Ie))+"&"+k:this.u&&Wd(F,this.u,Ie)),_a(this.h,ge),this.Ra&&Nn(F,"TYPE","init"),this.S?(Nn(F,"$req",k),Nn(F,"SID","null"),ge.U=!0,Q(ge,F,null)):Q(ge,F,k),this.I=2}}else this.I==3&&(v?ih(this,v):this.i.length==0||Wn(this.h)||ih(this))};function ih(v,k){var F;k?F=k.l:F=v.V++;const H=va(v.J);Nn(H,"SID",v.M),Nn(H,"RID",F),Nn(H,"AID",v.K),Fo(v,H),v.u&&v.o&&Wd(H,v.u,v.o),F=new Y(v,v.j,F,v.D+1),v.u===null&&(F.J=v.o),k&&(v.i=k.G.concat(v.i)),k=Ng(v,F,1e3),F.H=Math.round(v.va*.5)+Math.round(v.va*.5*Math.random()),_a(v.h,F),Q(F,H,k)}function Fo(v,k){v.H&&Pe(v.H,function(F,H){Nn(k,H,F)}),v.l&&Pe({},function(F,H){Nn(k,H,F)})}function Ng(v,k,F){F=Math.min(v.i.length,F);const H=v.l?c(v.l.Ka,v.l,v):null;e:{var ge=v.i;let rn=-1;for(;;){const zr=["count="+F];rn==-1?F>0?(rn=ge[0].g,zr.push("ofs="+rn)):rn=0:zr.push("ofs="+rn);let Hn=!0;for(let Xr=0;Xr<F;Xr++){var Ie=ge[Xr].g;const ea=ge[Xr].map;if(Ie-=rn,Ie<0)rn=Math.max(0,ge[Xr].g-100),Hn=!1;else try{Ie="req"+Ie+"_"||"";try{var lt=ea instanceof Map?ea:Object.entries(ea);for(const[Rl,Vo]of lt){let Go=Vo;o(Vo)&&(Go=Rn(Vo)),zr.push(Ie+Rl+"="+encodeURIComponent(Go))}}catch(Rl){throw zr.push(Ie+"type="+encodeURIComponent("_badmap")),Rl}}catch{H&&H(ea)}}if(Hn){lt=zr.join("&");break e}}lt=void 0}return v=v.i.splice(0,F),k.G=v,lt}function Yi(v){if(!v.g&&!v.v){v.Y=1;var k=v.Da;O||I(),G||(O(),G=!0),A.add(k,v),v.A=0}}function jo(v){return v.g||v.v||v.A>=3?!1:(v.Y++,v.v=re(c(v.Da,v),Zd(v,v.A)),v.A++,!0)}n.Da=function(){if(this.v=null,Ac(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var v=4*this.T;this.j.info("BP detection timer enabled: "+v),this.B=re(c(this.Wa,this),v)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,ut(10),Js(this),Ac(this))};function sh(v){v.B!=null&&(a.clearTimeout(v.B),v.B=null)}function Ac(v){v.g=new Y(v,v.j,"rpc",v.Y),v.u===null&&(v.g.J=v.o),v.g.P=0;var k=va(v.na);Nn(k,"RID","rpc"),Nn(k,"SID",v.M),Nn(k,"AID",v.K),Nn(k,"CI",v.F?"0":"1"),!v.F&&v.ia&&Nn(k,"TO",v.ia),Nn(k,"TYPE","xmlhttp"),Fo(v,k),v.u&&v.o&&Wd(k,v.u,v.o),v.O&&(v.g.H=v.O);var F=v.g;v=v.ba,F.M=1,F.A=wl(va(k)),F.u=null,F.R=!0,we(F,v)}n.Va=function(){this.C!=null&&(this.C=null,Js(this),jo(this),ut(19))};function qd(v){v.C!=null&&(a.clearTimeout(v.C),v.C=null)}function Yd(v,k){var F=null;if(v.g==k){qd(v),sh(v),v.g=null;var H=2}else if(Ya(v.h,k))F=k.G,Ys(v.h,k),H=1;else return;if(v.I!=0){if(k.o)if(H==1){F=k.u?k.u.length:0,k=Date.now()-k.F;var ge=v.D;H=xe(),cn(H,new W(H,F)),bl(v)}else Yi(v);else if(ge=k.m,ge==3||ge==0&&k.X>0||!(H==1&&p1(v,k)||H==2&&jo(v)))switch(F&&F.length>0&&(k=v.h,k.i=k.i.concat(F)),ge){case 1:Qs(v,5);break;case 4:Qs(v,10);break;case 3:Qs(v,6);break;default:Qs(v,2)}}}function Zd(v,k){let F=v.Qa+Math.floor(Math.random()*v.Za);return v.isActive()||(F*=2),F*k}function Qs(v,k){if(v.j.info("Error code "+k),k==2){var F=c(v.bb,v),H=v.Ua;const ge=!H;H=new Co(H||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Qu(H,"https"),wl(H),ge?No(H.toString(),F):Lo(H.toString(),F)}else ut(2);v.I=0,v.l&&v.l.pa(k),ah(v),Xd(v)}n.bb=function(v){v?(this.j.info("Successfully pinged google.com"),ut(2)):(this.j.info("Failed to ping google.com"),ut(1))};function ah(v){if(v.I=0,v.ja=[],v.l){const k=Br(v.h);(k.length!=0||v.i.length!=0)&&(x(v.ja,k),x(v.ja,v.i),v.h.i.length=0,y(v.i),v.i.length=0),v.l.oa()}}function Lg(v,k,F){var H=F instanceof Co?va(F):new Co(F);if(H.g!="")k&&(H.g=k+"."+H.g),ko(H,H.u);else{var ge=a.location;H=ge.protocol,k=k?k+"."+ge.hostname:ge.hostname,ge=+ge.port;const Ie=new Co(null);H&&Qu(Ie,H),k&&(Ie.g=k),ge&&ko(Ie,ge),F&&(Ie.h=F),H=Ie}return F=v.G,k=v.wa,F&&k&&Nn(H,F,k),Nn(H,"VER",v.ka),Fo(v,H),H}function y1(v,k,F){if(k&&!v.L)throw Error("Can't create secondary domain capable XhrIo object.");return k=v.Aa&&!v.ma?new ar(new El({ab:F})):new ar(v.ma),k.Fa(v.L),k}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function x1(){}n=x1.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Jd(){}Jd.prototype.g=function(v,k){return new Oi(v,k)};function Oi(v,k){hn.call(this),this.g=new Hd(k),this.l=v,this.h=k&&k.messageUrlParams||null,v=k&&k.messageHeaders||null,k&&k.clientProtocolHeaderRequired&&(v?v["X-Client-Protocol"]="webchannel":v={"X-Client-Protocol":"webchannel"}),this.g.o=v,v=k&&k.initMessageHeaders||null,k&&k.messageContentType&&(v?v["X-WebChannel-Content-Type"]=k.messageContentType:v={"X-WebChannel-Content-Type":k.messageContentType}),k&&k.sa&&(v?v["X-WebChannel-Client-Profile"]=k.sa:v={"X-WebChannel-Client-Profile":k.sa}),this.g.U=v,(v=k&&k.Qb)&&!j(v)&&(this.g.u=v),this.A=k&&k.supportsCrossDomainXhr||!1,this.v=k&&k.sendRawJson||!1,(k=k&&k.httpSessionIdParam)&&!j(k)&&(this.g.G=k,v=this.h,v!==null&&k in v&&(v=this.h,k in v&&delete v[k])),this.j=new Ic(this)}f(Oi,hn),Oi.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Oi.prototype.close=function(){Kd(this.g)},Oi.prototype.o=function(v){var k=this.g;if(typeof v=="string"){var F={};F.__data__=v,v=F}else this.v&&(F={},F.__data__=Rn(v),v=F);k.i.push(new Xt(k.Ya++,v)),k.I==3&&bl(k)},Oi.prototype.N=function(){this.g.l=null,delete this.j,Kd(this.g),delete this.g,Oi.Z.N.call(this)};function _1(v){li.call(this),v.__headers__&&(this.headers=v.__headers__,this.statusCode=v.__status__,delete v.__headers__,delete v.__status__);var k=v.__sm__;if(k){e:{for(const F in k){v=F;break e}v=void 0}(this.i=v)&&(v=this.i,k=k!==null&&v in k?k[v]:void 0),this.data=k}else this.data=v}f(_1,li);function v1(){nn.call(this),this.status=1}f(v1,nn);function Ic(v){this.g=v}f(Ic,x1),Ic.prototype.ra=function(){cn(this.g,"a")},Ic.prototype.qa=function(v){cn(this.g,new _1(v))},Ic.prototype.pa=function(v){cn(this.g,new v1)},Ic.prototype.oa=function(){cn(this.g,"b")},Jd.prototype.createWebChannel=Jd.prototype.g,Oi.prototype.send=Oi.prototype.o,Oi.prototype.open=Oi.prototype.m,Oi.prototype.close=Oi.prototype.close,_6=function(){return new Jd},x6=function(){return xe()},y6=Sr,zb={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Je.NO_ERROR=0,Je.TIMEOUT=8,Je.HTTP_ERROR=6,u_=Je,Qe.COMPLETE="complete",p6=Qe,qi.EventType=Nr,Nr.OPEN="a",Nr.CLOSE="b",Nr.ERROR="c",Nr.MESSAGE="d",hn.prototype.listen=hn.prototype.J,Rm=qi,ar.prototype.listenOnce=ar.prototype.K,ar.prototype.getLastError=ar.prototype.Ha,ar.prototype.getLastErrorCode=ar.prototype.ya,ar.prototype.getStatus=ar.prototype.ca,ar.prototype.getResponseJson=ar.prototype.La,ar.prototype.getResponseText=ar.prototype.la,ar.prototype.send=ar.prototype.ea,ar.prototype.setWithCredentials=ar.prototype.Fa,m6=ar}).apply(typeof Cx<"u"?Cx:typeof self<"u"?self:typeof window<"u"?window:{});const eL="@firebase/firestore",tL="4.9.3";let Ui=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Ui.UNAUTHENTICATED=new Ui(null),Ui.GOOGLE_CREDENTIALS=new Ui("google-credentials-uid"),Ui.FIRST_PARTY=new Ui("first-party-uid"),Ui.MOCK_USER=new Ui("mock-user");let dg="12.7.0";const dd=new rI("@firebase/firestore");function Xf(){return dd.logLevel}function et(n,...e){if(dd.logLevel<=yn.DEBUG){const t=e.map(mI);dd.debug(`Firestore (${dg}): ${n}`,...t)}}function Ts(n,...e){if(dd.logLevel<=yn.ERROR){const t=e.map(mI);dd.error(`Firestore (${dg}): ${n}`,...t)}}function fd(n,...e){if(dd.logLevel<=yn.WARN){const t=e.map(mI);dd.warn(`Firestore (${dg}): ${n}`,...t)}}function mI(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Ct(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,v6(n,r,t)}function v6(n,e,t){let r=`FIRESTORE (${dg}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Ts(r),new Error(r)}function Ot(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||v6(e,i,r)}function tn(n,e){return n}const Oe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ht extends xl{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class il{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class w6{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class kQ{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Ui.UNAUTHENTICATED)))}shutdown(){}}class PQ{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class MQ{constructor(e){this.t=e,this.currentUser=Ui.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ot(this.o===void 0,42304);let r=this.i;const i=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve();let s=new il;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new il,e.enqueueRetryable((()=>i(this.currentUser)))};const a=()=>{const l=s;e.enqueueRetryable((async()=>{await l.promise,await i(this.currentUser)}))},o=l=>{et("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit((l=>o(l))),setTimeout((()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(et("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new il)}}),0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(et("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ot(typeof r.accessToken=="string",31837,{l:r}),new w6(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ot(e===null||typeof e=="string",2055,{h:e}),new Ui(e)}}class NQ{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Ui.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class LQ{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new NQ(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Ui.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class nL{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class OQ{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ua(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Ot(this.o===void 0,3512);const r=s=>{s.error!=null&&et("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.m;return this.m=s.token,et("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable((()=>r(s)))};const i=s=>{et("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((s=>i(s))),setTimeout((()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):et("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new nL(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Ot(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new nL(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function DQ(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class pI{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=DQ(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%62))}return r}}function en(n,e){return n<e?-1:n>e?1:0}function Ub(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const i=n.charAt(r),s=e.charAt(r);if(i!==s)return uS(i)===uS(s)?en(i,s):uS(i)?1:-1}return en(n.length,e.length)}const FQ=55296,jQ=57343;function uS(n){const e=n.charCodeAt(0);return e>=FQ&&e<=jQ}function V0(n,e,t){return n.length===e.length&&n.every(((r,i)=>t(r,e[i])))}function E6(n){return n+"\0"}const rL="__name__";class qo{constructor(e,t,r){t===void 0?t=0:t>e.length&&Ct(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&Ct(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return qo.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof qo?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const s=qo.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return en(e.length,t.length)}static compareSegments(e,t){const r=qo.isNumericId(e),i=qo.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?qo.extractNumericId(e).compare(qo.extractNumericId(t)):Ub(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return bu.fromString(e.substring(4,e.length-2))}}class jn extends qo{construct(e,t,r){return new jn(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new ht(Oe.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((i=>i.length>0)))}return new jn(t)}static emptyPath(){return new jn([])}}const VQ=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Pr extends qo{construct(e,t,r){return new Pr(e,t,r)}static isValidIdentifier(e){return VQ.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Pr.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===rL}static keyField(){return new Pr([rL])}static fromServerFormat(e){const t=[];let r="",i=0;const s=()=>{if(r.length===0)throw new ht(Oe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let a=!1;for(;i<e.length;){const o=e[i];if(o==="\\"){if(i+1===e.length)throw new ht(Oe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new ht(Oe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else o==="`"?(a=!a,i++):o!=="."||a?(r+=o,i++):(s(),i++)}if(s(),a)throw new ht(Oe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Pr(t)}static emptyPath(){return new Pr([])}}class ft{constructor(e){this.path=e}static fromPath(e){return new ft(jn.fromString(e))}static fromName(e){return new ft(jn.fromString(e).popFirst(5))}static empty(){return new ft(jn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&jn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return jn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ft(new jn(e.slice()))}}function T6(n,e,t){if(!t)throw new ht(Oe.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function GQ(n,e,t,r){if(e===!0&&r===!0)throw new ht(Oe.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function iL(n){if(!ft.isDocumentKey(n))throw new ht(Oe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function sL(n){if(ft.isDocumentKey(n))throw new ht(Oe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function S6(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Zw(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Ct(12329,{type:typeof n})}function Ka(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new ht(Oe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Zw(n);throw new ht(Oe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function ni(n,e){const t={typeString:n};return e&&(t.value=e),t}function Fy(n,e){if(!S6(n))throw new ht(Oe.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const a=n[r];if(i&&typeof a!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&a!==s.value){t=`Expected '${r}' field to equal '${s.value}'`;break}}if(t)throw new ht(Oe.INVALID_ARGUMENT,t);return!0}const aL=-62135596800,oL=1e6;class qn{static now(){return qn.fromMillis(Date.now())}static fromDate(e){return qn.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*oL);return new qn(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ht(Oe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ht(Oe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<aL)throw new ht(Oe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ht(Oe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/oL}_compareTo(e){return this.seconds===e.seconds?en(this.nanoseconds,e.nanoseconds):en(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:qn._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Fy(e,qn._jsonSchema))return new qn(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-aL;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}qn._jsonSchemaVersion="firestore/timestamp/1.0",qn._jsonSchema={type:ni("string",qn._jsonSchemaVersion),seconds:ni("number"),nanoseconds:ni("number")};class Vt{static fromTimestamp(e){return new Vt(e)}static min(){return new Vt(new qn(0,0))}static max(){return new Vt(new qn(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const jp=-1;class uv{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function $b(n){return n.fields.find((e=>e.kind===2))}function Ah(n){return n.fields.filter((e=>e.kind!==2))}uv.UNKNOWN_ID=-1;class h_{constructor(e,t){this.fieldPath=e,this.kind=t}}class Vp{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Vp(0,ma.min())}}function BQ(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Vt.fromTimestamp(r===1e9?new qn(t+1,0):new qn(t,r));return new ma(i,ft.empty(),e)}function b6(n){return new ma(n.readTime,n.key,jp)}class ma{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new ma(Vt.min(),ft.empty(),jp)}static max(){return new ma(Vt.max(),ft.empty(),jp)}}function yI(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=ft.comparator(n.documentKey,e.documentKey),t!==0?t:en(n.largestBatchId,e.largestBatchId))}const R6="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class A6{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Ld(n){if(n.code!==Oe.FAILED_PRECONDITION||n.message!==R6)throw n;et("LocalStore","Unexpectedly lost primary lease")}class de{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ct(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new de(((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof de?t:de.resolve(t)}catch(t){return de.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):de.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):de.reject(t)}static resolve(e){return new de(((t,r)=>{t(e)}))}static reject(e){return new de(((t,r)=>{r(e)}))}static waitFor(e){return new de(((t,r)=>{let i=0,s=0,a=!1;e.forEach((o=>{++i,o.next((()=>{++s,a&&s===i&&t()}),(l=>r(l)))})),a=!0,s===i&&t()}))}static or(e){let t=de.resolve(!1);for(const r of e)t=t.next((i=>i?de.resolve(i):r()));return t}static forEach(e,t){const r=[];return e.forEach(((i,s)=>{r.push(t.call(this,i,s))})),this.waitFor(r)}static mapArray(e,t){return new de(((r,i)=>{const s=e.length,a=new Array(s);let o=0;for(let l=0;l<s;l++){const c=l;t(e[c]).next((h=>{a[c]=h,++o,o===s&&r(a)}),(h=>i(h)))}}))}static doWhile(e,t){return new de(((r,i)=>{const s=()=>{e()===!0?t().next((()=>{s()}),i):r()};s()}))}}const sa="SimpleDb";class Jw{static open(e,t,r,i){try{return new Jw(t,e.transaction(i,r))}catch(s){throw new $m(t,s)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new il,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new $m(e,t.error)):this.S.resolve()},this.transaction.onerror=r=>{const i=xI(r.target.error);this.S.reject(new $m(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(et(sa,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new UQ(t)}}class Ru{static delete(e){return et(sa,"Removing database:",e),Nh(vj().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!Cj())return!1;if(Ru.F())return!0;const e=mi(),t=Ru.M(e),r=0<t&&t<10,i=I6(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.N=r,this.B=null,Ru.M(mi())===12.2&&Ts("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(et(sa,"Opening database:",this.name),this.db=await new Promise(((t,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const a=s.target.result;t(a)},i.onblocked=()=>{r(new $m(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const a=s.target.error;a.name==="VersionError"?r(new ht(Oe.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):a.name==="InvalidStateError"?r(new ht(Oe.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a)):r(new $m(e,a))},i.onupgradeneeded=s=>{et(sa,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const a=s.target.result;this.N.k(a,i.transaction,s.oldVersion,this.version).next((()=>{et(sa,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,i){const s=t==="readonly";let a=0;for(;;){++a;try{this.db=await this.L(e);const o=Jw.open(this.db,e,s?"readonly":"readwrite",r),l=i(o).next((c=>(o.C(),c))).catch((c=>(o.abort(c),de.reject(c)))).toPromise();return l.catch((()=>{})),await o.D,l}catch(o){const l=o,c=l.name!=="FirebaseError"&&a<3;if(et(sa,"Transaction failed with error:",l.message,"Retrying:",c),this.close(),!c)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function I6(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class zQ{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Nh(this.U.delete())}}class $m extends ht{constructor(e,t){super(Oe.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Hu(n){return n.name==="IndexedDbTransactionError"}class UQ{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(et(sa,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(et(sa,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Nh(r)}add(e){return et(sa,"ADD",this.store.name,e,e),Nh(this.store.add(e))}get(e){return Nh(this.store.get(e)).next((t=>(t===void 0&&(t=null),et(sa,"GET",this.store.name,e,t),t)))}delete(e){return et(sa,"DELETE",this.store.name,e),Nh(this.store.delete(e))}count(){return et(sa,"COUNT",this.store.name),Nh(this.store.count())}J(e,t){const r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(r.range);return new de(((a,o)=>{s.onerror=l=>{o(l.target.error)},s.onsuccess=l=>{a(l.target.result)}}))}{const s=this.cursor(r),a=[];return this.H(s,((o,l)=>{a.push(l)})).next((()=>a))}}Y(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new de(((i,s)=>{r.onerror=a=>{s(a.target.error)},r.onsuccess=a=>{i(a.target.result)}}))}Z(e,t){et(sa,"DELETE ALL",this.store.name);const r=this.options(e,t);r.X=!1;const i=this.cursor(r);return this.H(i,((s,a,o)=>o.delete()))}ee(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.H(i,t)}te(e){const t=this.cursor({});return new de(((r,i)=>{t.onerror=s=>{const a=xI(s.target.error);i(a)},t.onsuccess=s=>{const a=s.target.result;a?e(a.primaryKey,a.value).next((o=>{o?a.continue():r()})):r()}}))}H(e,t){const r=[];return new de(((i,s)=>{e.onerror=a=>{s(a.target.error)},e.onsuccess=a=>{const o=a.target.result;if(!o)return void i();const l=new zQ(o),c=t(o.primaryKey,o.value,l);if(c instanceof de){const h=c.catch((f=>(l.done(),de.reject(f))));r.push(h)}l.isDone?i():l.G===null?o.continue():o.continue(l.G)}})).next((()=>de.waitFor(r)))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Nh(n){return new de(((e,t)=>{n.onsuccess=r=>{const i=r.target.result;e(i)},n.onerror=r=>{const i=xI(r.target.error);t(i)}}))}let lL=!1;function xI(n){const e=Ru.M(mi());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new ht("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return lL||(lL=!0,setTimeout((()=>{throw r}),0)),r}}return n}const Wm="IndexBackfiller";class $Q{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){et(Wm,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();et(Wm,`Documents written: ${t}`)}catch(t){Hu(t)?et(Wm,"Ignoring IndexedDB error during index backfill: ",t):await Ld(t)}await this.re(6e4)}))}}class WQ{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const r=new Set;let i=t,s=!0;return de.doWhile((()=>s===!0&&i>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((a=>{if(a!==null&&!r.has(a))return et(Wm,`Processing collection: ${a}`),this.oe(e,a,i).next((o=>{i-=o,r.add(a)}));s=!1})))).next((()=>t-i))}oe(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next((s=>{const a=s.changes;return this.localStore.indexManager.updateIndexEntries(e,a).next((()=>this._e(i,s))).next((o=>(et(Wm,`Updating offset: ${o}`),this.localStore.indexManager.updateCollectionGroup(e,t,o)))).next((()=>a.size))}))))}_e(e,t){let r=e;return t.changes.forEach(((i,s)=>{const a=b6(s);yI(a,r)>0&&(r=a)})),new ma(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}class ja{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}ja.ce=-1;const Yh=-1;function Qw(n){return n==null}function Gp(n){return n===0&&1/n==-1/0}function HQ(n){return typeof n=="number"&&Number.isInteger(n)&&!Gp(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const hv="";function us(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=cL(e)),e=KQ(n.get(t),e);return cL(e)}function KQ(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const s=n.charAt(i);switch(s){case"\0":t+="";break;case hv:t+="";break;default:t+=s}}return t}function cL(n){return n+hv+""}function Qo(n){const e=n.length;if(Ot(e>=2,64408,{path:n}),e===2)return Ot(n.charAt(0)===hv&&n.charAt(1)==="",56145,{path:n}),jn.emptyPath();const t=e-2,r=[];let i="";for(let s=0;s<e;){const a=n.indexOf(hv,s);switch((a<0||a>t)&&Ct(50515,{path:n}),n.charAt(a+1)){case"":const o=n.substring(s,a);let l;i.length===0?l=o:(i+=o,l=i,i=""),r.push(l);break;case"":i+=n.substring(s,a),i+="\0";break;case"":i+=n.substring(s,a+1);break;default:Ct(61167,{path:n})}s=a+2}return new jn(r)}const Ih="remoteDocuments",jy="owner",Pf="owner",Bp="mutationQueues",XQ="userId",co="mutations",uL="batchId",Uh="userMutationsIndex",hL=["userId","batchId"];function d_(n,e){return[n,us(e)]}function C6(n,e,t){return[n,us(e),t]}const qQ={},G0="documentMutations",dv="remoteDocumentsV14",YQ=["prefixPath","collectionGroup","readTime","documentId"],f_="documentKeyIndex",ZQ=["prefixPath","collectionGroup","documentId"],k6="collectionGroupIndex",JQ=["collectionGroup","readTime","prefixPath","documentId"],zp="remoteDocumentGlobal",Wb="remoteDocumentGlobalKey",B0="targets",P6="queryTargetsIndex",QQ=["canonicalId","targetId"],z0="targetDocuments",eee=["targetId","path"],_I="documentTargetsIndex",tee=["path","targetId"],fv="targetGlobalKey",Zh="targetGlobal",Up="collectionParents",nee=["collectionId","parent"],U0="clientMetadata",ree="clientId",eE="bundles",iee="bundleId",tE="namedQueries",see="name",vI="indexConfiguration",aee="indexId",Hb="collectionGroupIndex",oee="collectionGroup",Hm="indexState",lee=["indexId","uid"],M6="sequenceNumberIndex",cee=["uid","sequenceNumber"],Km="indexEntries",uee=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],N6="documentKeyIndex",hee=["indexId","uid","orderedDocumentKey"],nE="documentOverlays",dee=["userId","collectionPath","documentId"],Kb="collectionPathOverlayIndex",fee=["userId","collectionPath","largestBatchId"],L6="collectionGroupOverlayIndex",gee=["userId","collectionGroup","largestBatchId"],wI="globals",mee="name",O6=[Bp,co,G0,Ih,B0,jy,Zh,z0,U0,zp,Up,eE,tE],pee=[...O6,nE],D6=[Bp,co,G0,dv,B0,jy,Zh,z0,U0,zp,Up,eE,tE,nE],F6=D6,EI=[...F6,vI,Hm,Km],yee=EI,j6=[...EI,wI],xee=j6;class Xb extends A6{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function yi(n,e){const t=tn(n);return Ru.O(t.le,e)}function dL(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Ku(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function V6(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class Er{constructor(e,t){this.comparator=e,this.root=t||$i.EMPTY}insert(e,t){return new Er(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,$i.BLACK,null,null))}remove(e){return new Er(this.comparator,this.root.remove(e,this.comparator).copy(null,null,$i.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new kx(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new kx(this.root,e,this.comparator,!1)}getReverseIterator(){return new kx(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new kx(this.root,e,this.comparator,!0)}}class kx{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class $i{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??$i.RED,this.left=i??$i.EMPTY,this.right=s??$i.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new $i(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return $i.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return $i.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,$i.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,$i.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ct(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ct(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ct(27949);return e+(this.isRed()?0:1)}}$i.EMPTY=null,$i.RED=!0,$i.BLACK=!1;$i.EMPTY=new class{constructor(){this.size=0}get key(){throw Ct(57766)}get value(){throw Ct(16141)}get color(){throw Ct(16727)}get left(){throw Ct(29726)}get right(){throw Ct(36894)}copy(e,t,r,i,s){return this}insert(e,t,r){return new $i(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Qn{constructor(e){this.comparator=e,this.data=new Er(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new fL(this.data.getIterator())}getIteratorFrom(e){return new fL(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof Qn)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Qn(this.comparator);return t.data=e,t}}class fL{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Mf(n){return n.hasNext()?n.getNext():void 0}class Gs{constructor(e){this.fields=e,e.sort(Pr.comparator)}static empty(){return new Gs([])}unionWith(e){let t=new Qn(Pr.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Gs(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return V0(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}class G6 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class ii{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new G6("Invalid base64 string: "+s):s}})(e);return new ii(t)}static fromUint8Array(e){const t=(function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s})(e);return new ii(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return en(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ii.EMPTY_BYTE_STRING=new ii("");const _ee=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function oc(n){if(Ot(!!n,39018),typeof n=="string"){let e=0;const t=_ee.exec(n);if(Ot(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:xr(n.seconds),nanos:xr(n.nanos)}}function xr(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function lc(n){return typeof n=="string"?ii.fromBase64String(n):ii.fromUint8Array(n)}const B6="server_timestamp",z6="__type__",U6="__previous_value__",$6="__local_write_time__";function TI(n){return(n?.mapValue?.fields||{})[z6]?.stringValue===B6}function rE(n){const e=n.mapValue.fields[U6];return TI(e)?rE(e):e}function $p(n){const e=oc(n.mapValue.fields[$6].timestampValue);return new qn(e.seconds,e.nanos)}class vee{constructor(e,t,r,i,s,a,o,l,c,h){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=c,this.isUsingEmulator=h}}const gv="(default)";class gd{constructor(e,t){this.projectId=e,this.database=t||gv}static empty(){return new gd("","")}get isDefaultDatabase(){return this.database===gv}isEqual(e){return e instanceof gd&&e.projectId===this.projectId&&e.database===this.database}}const SI="__type__",W6="__max__",gu={mapValue:{fields:{__type__:{stringValue:W6}}}},bI="__vector__",$0="value",g_={nullValue:"NULL_VALUE"};function Nu(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?TI(n)?4:H6(n)?9007199254740991:iE(n)?10:11:Ct(28295,{value:n})}function dl(n,e){if(n===e)return!0;const t=Nu(n);if(t!==Nu(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return $p(n).isEqual($p(e));case 3:return(function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=oc(i.timestampValue),o=oc(s.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,s){return lc(i.bytesValue).isEqual(lc(s.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,s){return xr(i.geoPointValue.latitude)===xr(s.geoPointValue.latitude)&&xr(i.geoPointValue.longitude)===xr(s.geoPointValue.longitude)})(n,e);case 2:return(function(i,s){if("integerValue"in i&&"integerValue"in s)return xr(i.integerValue)===xr(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=xr(i.doubleValue),o=xr(s.doubleValue);return a===o?Gp(a)===Gp(o):isNaN(a)&&isNaN(o)}return!1})(n,e);case 9:return V0(n.arrayValue.values||[],e.arrayValue.values||[],dl);case 10:case 11:return(function(i,s){const a=i.mapValue.fields||{},o=s.mapValue.fields||{};if(dL(a)!==dL(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!dl(a[l],o[l])))return!1;return!0})(n,e);default:return Ct(52216,{left:n})}}function Wp(n,e){return(n.values||[]).find((t=>dl(t,e)))!==void 0}function Lu(n,e){if(n===e)return 0;const t=Nu(n),r=Nu(e);if(t!==r)return en(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return en(n.booleanValue,e.booleanValue);case 2:return(function(s,a){const o=xr(s.integerValue||s.doubleValue),l=xr(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1})(n,e);case 3:return gL(n.timestampValue,e.timestampValue);case 4:return gL($p(n),$p(e));case 5:return Ub(n.stringValue,e.stringValue);case 6:return(function(s,a){const o=lc(s),l=lc(a);return o.compareTo(l)})(n.bytesValue,e.bytesValue);case 7:return(function(s,a){const o=s.split("/"),l=a.split("/");for(let c=0;c<o.length&&c<l.length;c++){const h=en(o[c],l[c]);if(h!==0)return h}return en(o.length,l.length)})(n.referenceValue,e.referenceValue);case 8:return(function(s,a){const o=en(xr(s.latitude),xr(a.latitude));return o!==0?o:en(xr(s.longitude),xr(a.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return mL(n.arrayValue,e.arrayValue);case 10:return(function(s,a){const o=s.fields||{},l=a.fields||{},c=o[$0]?.arrayValue,h=l[$0]?.arrayValue,f=en(c?.values?.length||0,h?.values?.length||0);return f!==0?f:mL(c,h)})(n.mapValue,e.mapValue);case 11:return(function(s,a){if(s===gu.mapValue&&a===gu.mapValue)return 0;if(s===gu.mapValue)return 1;if(a===gu.mapValue)return-1;const o=s.fields||{},l=Object.keys(o),c=a.fields||{},h=Object.keys(c);l.sort(),h.sort();for(let f=0;f<l.length&&f<h.length;++f){const m=Ub(l[f],h[f]);if(m!==0)return m;const y=Lu(o[l[f]],c[h[f]]);if(y!==0)return y}return en(l.length,h.length)})(n.mapValue,e.mapValue);default:throw Ct(23264,{he:t})}}function gL(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return en(n,e);const t=oc(n),r=oc(e),i=en(t.seconds,r.seconds);return i!==0?i:en(t.nanos,r.nanos)}function mL(n,e){const t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const s=Lu(t[i],r[i]);if(s)return s}return en(t.length,r.length)}function W0(n){return qb(n)}function qb(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=oc(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return lc(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return ft.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(const s of t.values||[])i?i=!1:r+=",",r+=qb(s);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const a of r)s?s=!1:i+=",",i+=`${a}:${qb(t.fields[a])}`;return i+"}"})(n.mapValue):Ct(61005,{value:n})}function m_(n){switch(Nu(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=rE(n);return e?16+m_(e):16;case 5:return 2*n.stringValue.length;case 6:return lc(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((i,s)=>i+m_(s)),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return Ku(r.fields,((s,a)=>{i+=s.length+m_(a)})),i})(n.mapValue);default:throw Ct(13486,{value:n})}}function Hp(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Yb(n){return!!n&&"integerValue"in n}function Kp(n){return!!n&&"arrayValue"in n}function pL(n){return!!n&&"nullValue"in n}function yL(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function p_(n){return!!n&&"mapValue"in n}function iE(n){return(n?.mapValue?.fields||{})[SI]?.stringValue===bI}function Xm(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Ku(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=Xm(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Xm(n.arrayValue.values[t]);return e}return{...n}}function H6(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===W6}const K6={mapValue:{fields:{[SI]:{stringValue:bI},[$0]:{arrayValue:{}}}}};function wee(n){return"nullValue"in n?g_:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Hp(gd.empty(),ft.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?iE(n)?K6:{mapValue:{}}:Ct(35942,{value:n})}function Eee(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Hp(gd.empty(),ft.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?K6:"mapValue"in n?iE(n)?{mapValue:{}}:gu:Ct(61959,{value:n})}function xL(n,e){const t=Lu(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function _L(n,e){const t=Lu(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class os{constructor(e){this.value=e}static empty(){return new os({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!p_(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Xm(t)}setAll(e){let t=Pr.emptyPath(),r={},i=[];e.forEach(((a,o)=>{if(!t.isImmediateParentOf(o)){const l=this.getFieldsMap(t);this.applyChanges(l,r,i),r={},i=[],t=o.popLast()}a?r[o.lastSegment()]=Xm(a):i.push(o.lastSegment())}));const s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){const t=this.field(e.popLast());p_(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return dl(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];p_(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Ku(t,((i,s)=>e[i]=s));for(const i of r)delete e[i]}clone(){return new os(Xm(this.value))}}function X6(n){const e=[];return Ku(n.fields,((t,r)=>{const i=new Pr([t]);if(p_(r)){const s=X6(r.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)})),new Gs(e)}class Vr{constructor(e,t,r,i,s,a,o){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(e){return new Vr(e,0,Vt.min(),Vt.min(),Vt.min(),os.empty(),0)}static newFoundDocument(e,t,r,i){return new Vr(e,1,t,Vt.min(),r,i,0)}static newNoDocument(e,t){return new Vr(e,2,t,Vt.min(),Vt.min(),os.empty(),0)}static newUnknownDocument(e,t){return new Vr(e,3,t,Vt.min(),Vt.min(),os.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Vt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=os.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=os.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Vt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Vr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Vr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class H0{constructor(e,t){this.position=e,this.inclusive=t}}function vL(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const s=e[i],a=n.position[i];if(s.field.isKeyField()?r=ft.comparator(ft.fromName(a.referenceValue),t.key):r=Lu(a,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function wL(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!dl(n.position[t],e.position[t]))return!1;return!0}class mv{constructor(e,t="asc"){this.field=e,this.dir=t}}function Tee(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class q6{}class xn extends q6{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new See(e,t,r):t==="array-contains"?new Aee(e,r):t==="in"?new t8(e,r):t==="not-in"?new Iee(e,r):t==="array-contains-any"?new Cee(e,r):new xn(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new bee(e,r):new Ree(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Lu(t,this.value)):t!==null&&Nu(this.value)===Nu(t)&&this.matchesComparison(Lu(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ct(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Zn extends q6{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Zn(e,t)}matches(e){return K0(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function K0(n){return n.op==="and"}function Zb(n){return n.op==="or"}function RI(n){return Y6(n)&&K0(n)}function Y6(n){for(const e of n.filters)if(e instanceof Zn)return!1;return!0}function Jb(n){if(n instanceof xn)return n.field.canonicalString()+n.op.toString()+W0(n.value);if(RI(n))return n.filters.map((e=>Jb(e))).join(",");{const e=n.filters.map((t=>Jb(t))).join(",");return`${n.op}(${e})`}}function Z6(n,e){return n instanceof xn?(function(r,i){return i instanceof xn&&r.op===i.op&&r.field.isEqual(i.field)&&dl(r.value,i.value)})(n,e):n instanceof Zn?(function(r,i){return i instanceof Zn&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce(((s,a,o)=>s&&Z6(a,i.filters[o])),!0):!1})(n,e):void Ct(19439)}function J6(n,e){const t=n.filters.concat(e);return Zn.create(t,n.op)}function Q6(n){return n instanceof xn?(function(t){return`${t.field.canonicalString()} ${t.op} ${W0(t.value)}`})(n):n instanceof Zn?(function(t){return t.op.toString()+" {"+t.getFilters().map(Q6).join(" ,")+"}"})(n):"Filter"}class See extends xn{constructor(e,t,r){super(e,t,r),this.key=ft.fromName(r.referenceValue)}matches(e){const t=ft.comparator(e.key,this.key);return this.matchesComparison(t)}}class bee extends xn{constructor(e,t){super(e,"in",t),this.keys=e8("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class Ree extends xn{constructor(e,t){super(e,"not-in",t),this.keys=e8("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function e8(n,e){return(e.arrayValue?.values||[]).map((t=>ft.fromName(t.referenceValue)))}class Aee extends xn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Kp(t)&&Wp(t.arrayValue,this.value)}}class t8 extends xn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Wp(this.value.arrayValue,t)}}class Iee extends xn{constructor(e,t){super(e,"not-in",t)}matches(e){if(Wp(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Wp(this.value.arrayValue,t)}}class Cee extends xn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Kp(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>Wp(this.value.arrayValue,r)))}}class kee{constructor(e,t=null,r=[],i=[],s=null,a=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=a,this.endAt=o,this.Te=null}}function Qb(n,e=null,t=[],r=[],i=null,s=null,a=null){return new kee(n,e,t,r,i,s,a)}function md(n){const e=tn(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>Jb(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(s){return s.field.canonicalString()+s.dir})(r))).join(","),Qw(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>W0(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>W0(r))).join(",")),e.Te=t}return e.Te}function Vy(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!Tee(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Z6(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!wL(n.startAt,e.startAt)&&wL(n.endAt,e.endAt)}function pv(n){return ft.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function yv(n,e){return n.filters.filter((t=>t instanceof xn&&t.field.isEqual(e)))}function EL(n,e,t){let r=g_,i=!0;for(const s of yv(n,e)){let a=g_,o=!0;switch(s.op){case"<":case"<=":a=wee(s.value);break;case"==":case"in":case">=":a=s.value;break;case">":a=s.value,o=!1;break;case"!=":case"not-in":a=g_}xL({value:r,inclusive:i},{value:a,inclusive:o})<0&&(r=a,i=o)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const a=t.position[s];xL({value:r,inclusive:i},{value:a,inclusive:t.inclusive})<0&&(r=a,i=t.inclusive);break}}return{value:r,inclusive:i}}function TL(n,e,t){let r=gu,i=!0;for(const s of yv(n,e)){let a=gu,o=!0;switch(s.op){case">=":case">":a=Eee(s.value),o=!1;break;case"==":case"in":case"<=":a=s.value;break;case"<":a=s.value,o=!1;break;case"!=":case"not-in":a=gu}_L({value:r,inclusive:i},{value:a,inclusive:o})>0&&(r=a,i=o)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const a=t.position[s];_L({value:r,inclusive:i},{value:a,inclusive:t.inclusive})>0&&(r=a,i=t.inclusive);break}}return{value:r,inclusive:i}}class Gy{constructor(e,t=null,r=[],i=[],s=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function Pee(n,e,t,r,i,s,a,o){return new Gy(n,e,t,r,i,s,a,o)}function sE(n){return new Gy(n)}function SL(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function n8(n){return n.collectionGroup!==null}function qm(n){const e=tn(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),t.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new Qn(Pr.comparator);return a.filters.forEach((l=>{l.getFlattenedFilters().forEach((c=>{c.isInequality()&&(o=o.add(c.field))}))})),o})(e).forEach((s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new mv(s,r))})),t.has(Pr.keyField().canonicalString())||e.Ie.push(new mv(Pr.keyField(),r))}return e.Ie}function Ba(n){const e=tn(n);return e.Ee||(e.Ee=Mee(e,qm(n))),e.Ee}function Mee(n,e){if(n.limitType==="F")return Qb(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((i=>{const s=i.dir==="desc"?"asc":"desc";return new mv(i.field,s)}));const t=n.endAt?new H0(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new H0(n.startAt.position,n.startAt.inclusive):null;return Qb(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function eR(n,e){const t=n.filters.concat([e]);return new Gy(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function tR(n,e,t){return new Gy(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function aE(n,e){return Vy(Ba(n),Ba(e))&&n.limitType===e.limitType}function r8(n){return`${md(Ba(n))}|lt:${n.limitType}`}function qf(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((i=>Q6(i))).join(", ")}]`),Qw(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((i=>(function(a){return`${a.field.canonicalString()} (${a.dir})`})(i))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((i=>W0(i))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((i=>W0(i))).join(",")),`Target(${r})`})(Ba(n))}; limitType=${n.limitType})`}function By(n,e){return e.isFoundDocument()&&(function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):ft.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)})(n,e)&&(function(r,i){for(const s of qm(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(a,o,l){const c=vL(a,o,l);return a.inclusive?c<=0:c<0})(r.startAt,qm(r),i)||r.endAt&&!(function(a,o,l){const c=vL(a,o,l);return a.inclusive?c>=0:c>0})(r.endAt,qm(r),i))})(n,e)}function Nee(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function i8(n){return(e,t)=>{let r=!1;for(const i of qm(n)){const s=Lee(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function Lee(n,e,t){const r=n.field.isKeyField()?ft.comparator(e.key,t.key):(function(s,a,o){const l=a.data.field(s),c=o.data.field(s);return l!==null&&c!==null?Lu(l,c):Ct(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Ct(19790,{direction:n.dir})}}class pc{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Ku(this.inner,((t,r)=>{for(const[i,s]of r)e(i,s)}))}isEmpty(){return V6(this.inner)}size(){return this.innerSize}}const Oee=new Er(ft.comparator);function da(){return Oee}const s8=new Er(ft.comparator);function Am(...n){let e=s8;for(const t of n)e=e.insert(t.key,t);return e}function a8(n){let e=s8;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function el(){return Ym()}function o8(){return Ym()}function Ym(){return new pc((n=>n.toString()),((n,e)=>n.isEqual(e)))}const Dee=new Er(ft.comparator),Fee=new Qn(ft.comparator);function un(...n){let e=Fee;for(const t of n)e=e.add(t);return e}const jee=new Qn(en);function Vee(){return jee}function AI(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Gp(e)?"-0":e}}function l8(n){return{integerValue:""+n}}function Gee(n,e){return HQ(e)?l8(e):AI(n,e)}class oE{constructor(){this._=void 0}}function Bee(n,e,t){return n instanceof X0?(function(i,s){const a={fields:{[z6]:{stringValue:B6},[$6]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&TI(s)&&(s=rE(s)),s&&(a.fields[U6]=s),{mapValue:a}})(t,e):n instanceof q0?u8(n,e):n instanceof Y0?h8(n,e):(function(i,s){const a=c8(i,s),o=bL(a)+bL(i.Ae);return Yb(a)&&Yb(i.Ae)?l8(o):AI(i.serializer,o)})(n,e)}function zee(n,e,t){return n instanceof q0?u8(n,e):n instanceof Y0?h8(n,e):t}function c8(n,e){return n instanceof Xp?(function(r){return Yb(r)||(function(s){return!!s&&"doubleValue"in s})(r)})(e)?e:{integerValue:0}:null}class X0 extends oE{}class q0 extends oE{constructor(e){super(),this.elements=e}}function u8(n,e){const t=d8(e);for(const r of n.elements)t.some((i=>dl(i,r)))||t.push(r);return{arrayValue:{values:t}}}class Y0 extends oE{constructor(e){super(),this.elements=e}}function h8(n,e){let t=d8(e);for(const r of n.elements)t=t.filter((i=>!dl(i,r)));return{arrayValue:{values:t}}}class Xp extends oE{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function bL(n){return xr(n.integerValue||n.doubleValue)}function d8(n){return Kp(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class f8{constructor(e,t){this.field=e,this.transform=t}}function Uee(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof q0&&i instanceof q0||r instanceof Y0&&i instanceof Y0?V0(r.elements,i.elements,dl):r instanceof Xp&&i instanceof Xp?dl(r.Ae,i.Ae):r instanceof X0&&i instanceof X0})(n.transform,e.transform)}class $ee{constructor(e,t){this.version=e,this.transformResults=t}}class ls{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new ls}static exists(e){return new ls(void 0,e)}static updateTime(e){return new ls(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function y_(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class lE{}function g8(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new cE(n.key,ls.none()):new fg(n.key,n.data,ls.none());{const t=n.data,r=os.empty();let i=new Qn(Pr.comparator);for(let s of e.fields)if(!i.has(s)){let a=t.field(s);a===null&&s.length>1&&(s=s.popLast(),a=t.field(s)),a===null?r.delete(s):r.set(s,a),i=i.add(s)}return new yc(n.key,r,new Gs(i.toArray()),ls.none())}}function Wee(n,e,t){n instanceof fg?(function(i,s,a){const o=i.value.clone(),l=AL(i.fieldTransforms,s,a.transformResults);o.setAll(l),s.convertToFoundDocument(a.version,o).setHasCommittedMutations()})(n,e,t):n instanceof yc?(function(i,s,a){if(!y_(i.precondition,s))return void s.convertToUnknownDocument(a.version);const o=AL(i.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(m8(i)),l.setAll(o),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()})(n,e,t):(function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()})(0,e,t)}function Zm(n,e,t,r){return n instanceof fg?(function(s,a,o,l){if(!y_(s.precondition,a))return o;const c=s.value.clone(),h=IL(s.fieldTransforms,l,a);return c.setAll(h),a.convertToFoundDocument(a.version,c).setHasLocalMutations(),null})(n,e,t,r):n instanceof yc?(function(s,a,o,l){if(!y_(s.precondition,a))return o;const c=IL(s.fieldTransforms,l,a),h=a.data;return h.setAll(m8(s)),h.setAll(c),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map((f=>f.field)))})(n,e,t,r):(function(s,a,o){return y_(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o})(n,e,t)}function Hee(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),s=c8(r.transform,i||null);s!=null&&(t===null&&(t=os.empty()),t.set(r.field,s))}return t||null}function RL(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&V0(r,i,((s,a)=>Uee(s,a)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class fg extends lE{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class yc extends lE{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function m8(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function AL(n,e,t){const r=new Map;Ot(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let i=0;i<t.length;i++){const s=n[i],a=s.transform,o=e.data.field(s.field);r.set(s.field,zee(a,o,t[i]))}return r}function IL(n,e,t){const r=new Map;for(const i of n){const s=i.transform,a=t.data.field(i.field);r.set(i.field,Bee(s,a,e))}return r}class cE extends lE{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class p8 extends lE{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class II{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&Wee(s,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Zm(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Zm(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=o8();return this.mutations.forEach((i=>{const s=e.get(i.key),a=s.overlayedDocument;let o=this.applyToLocalView(a,s.mutatedFields);o=t.has(i.key)?null:o;const l=g8(a,o);l!==null&&r.set(i.key,l),a.isValidDocument()||a.convertToNoDocument(Vt.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),un())}isEqual(e){return this.batchId===e.batchId&&V0(this.mutations,e.mutations,((t,r)=>RL(t,r)))&&V0(this.baseMutations,e.baseMutations,((t,r)=>RL(t,r)))}}class CI{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Ot(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=(function(){return Dee})();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,r[a].version);return new CI(e,t,r,i)}}class kI{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class Kee{constructor(e,t){this.count=e,this.unchangedNames=t}}var Zr,wn;function Xee(n){switch(n){case Oe.OK:return Ct(64938);case Oe.CANCELLED:case Oe.UNKNOWN:case Oe.DEADLINE_EXCEEDED:case Oe.RESOURCE_EXHAUSTED:case Oe.INTERNAL:case Oe.UNAVAILABLE:case Oe.UNAUTHENTICATED:return!1;case Oe.INVALID_ARGUMENT:case Oe.NOT_FOUND:case Oe.ALREADY_EXISTS:case Oe.PERMISSION_DENIED:case Oe.FAILED_PRECONDITION:case Oe.ABORTED:case Oe.OUT_OF_RANGE:case Oe.UNIMPLEMENTED:case Oe.DATA_LOSS:return!0;default:return Ct(15467,{code:n})}}function y8(n){if(n===void 0)return Ts("GRPC error has no .code"),Oe.UNKNOWN;switch(n){case Zr.OK:return Oe.OK;case Zr.CANCELLED:return Oe.CANCELLED;case Zr.UNKNOWN:return Oe.UNKNOWN;case Zr.DEADLINE_EXCEEDED:return Oe.DEADLINE_EXCEEDED;case Zr.RESOURCE_EXHAUSTED:return Oe.RESOURCE_EXHAUSTED;case Zr.INTERNAL:return Oe.INTERNAL;case Zr.UNAVAILABLE:return Oe.UNAVAILABLE;case Zr.UNAUTHENTICATED:return Oe.UNAUTHENTICATED;case Zr.INVALID_ARGUMENT:return Oe.INVALID_ARGUMENT;case Zr.NOT_FOUND:return Oe.NOT_FOUND;case Zr.ALREADY_EXISTS:return Oe.ALREADY_EXISTS;case Zr.PERMISSION_DENIED:return Oe.PERMISSION_DENIED;case Zr.FAILED_PRECONDITION:return Oe.FAILED_PRECONDITION;case Zr.ABORTED:return Oe.ABORTED;case Zr.OUT_OF_RANGE:return Oe.OUT_OF_RANGE;case Zr.UNIMPLEMENTED:return Oe.UNIMPLEMENTED;case Zr.DATA_LOSS:return Oe.DATA_LOSS;default:return Ct(39323,{code:n})}}(wn=Zr||(Zr={}))[wn.OK=0]="OK",wn[wn.CANCELLED=1]="CANCELLED",wn[wn.UNKNOWN=2]="UNKNOWN",wn[wn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",wn[wn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",wn[wn.NOT_FOUND=5]="NOT_FOUND",wn[wn.ALREADY_EXISTS=6]="ALREADY_EXISTS",wn[wn.PERMISSION_DENIED=7]="PERMISSION_DENIED",wn[wn.UNAUTHENTICATED=16]="UNAUTHENTICATED",wn[wn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",wn[wn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",wn[wn.ABORTED=10]="ABORTED",wn[wn.OUT_OF_RANGE=11]="OUT_OF_RANGE",wn[wn.UNIMPLEMENTED=12]="UNIMPLEMENTED",wn[wn.INTERNAL=13]="INTERNAL",wn[wn.UNAVAILABLE=14]="UNAVAILABLE",wn[wn.DATA_LOSS=15]="DATA_LOSS";function qee(){return new TextEncoder}const Yee=new bu([4294967295,4294967295],0);function CL(n){const e=qee().encode(n),t=new g6;return t.update(e),new Uint8Array(t.digest())}function kL(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new bu([t,r],0),new bu([i,s],0)]}class PI{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Im(`Invalid padding: ${t}`);if(r<0)throw new Im(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Im(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Im(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=bu.fromNumber(this.ge)}ye(e,t,r){let i=e.add(t.multiply(bu.fromNumber(r)));return i.compare(Yee)===1&&(i=new bu([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=CL(e),[r,i]=kL(t);for(let s=0;s<this.hashCount;s++){const a=this.ye(r,i,s);if(!this.we(a))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new PI(s,i,t);return r.forEach((o=>a.insert(o))),a}insert(e){if(this.ge===0)return;const t=CL(e),[r,i]=kL(t);for(let s=0;s<this.hashCount;s++){const a=this.ye(r,i,s);this.Se(a)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class Im extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class uE{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,zy.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new uE(Vt.min(),i,new Er(en),da(),un())}}class zy{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new zy(r,t,un(),un(),un())}}class x_{constructor(e,t,r,i){this.be=e,this.removedTargetIds=t,this.key=r,this.De=i}}class x8{constructor(e,t){this.targetId=e,this.Ce=t}}class _8{constructor(e,t,r=ii.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class PL{constructor(){this.ve=0,this.Fe=ML(),this.Me=ii.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=un(),t=un(),r=un();return this.Fe.forEach(((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:Ct(38017,{changeType:s})}})),new zy(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=ML()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Ot(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class Zee{constructor(e){this.Ge=e,this.ze=new Map,this.je=da(),this.Je=Px(),this.He=Px(),this.Ye=new Er(en)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:Ct(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,i)=>{this.rt(i)&&t(i)}))}st(e){const t=e.targetId,r=e.Ce.count,i=this.ot(t);if(i){const s=i.target;if(pv(s))if(r===0){const a=new ft(s.path);this.et(t,a,Vr.newNoDocument(a,Vt.min()))}else Ot(r===1,20013,{expectedCount:r});else{const a=this._t(t);if(a!==r){const o=this.ut(e),l=o?this.ct(o,e,a):1;if(l!==0){this.it(t);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,c)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t;let a,o;try{a=lc(r).toUint8Array()}catch(l){if(l instanceof G6)return fd("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new PI(a,i,s)}catch(l){return fd(l instanceof Im?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.ge===0?null:o}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let i=0;return r.forEach((s=>{const a=this.Ge.ht(),o=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(o)||(this.et(t,s,null),i++)})),i}Tt(e){const t=new Map;this.ze.forEach(((s,a)=>{const o=this.ot(a);if(o){if(s.current&&pv(o.target)){const l=new ft(o.target.path);this.It(l).has(a)||this.Et(a,l)||this.et(a,l,Vr.newNoDocument(l,e))}s.Be&&(t.set(a,s.ke()),s.qe())}}));let r=un();this.He.forEach(((s,a)=>{let o=!0;a.forEachWhile((l=>{const c=this.ot(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)})),o&&(r=r.add(s))})),this.je.forEach(((s,a)=>a.setReadTime(e)));const i=new uE(e,t,this.Ye,this.je,r);return this.je=da(),this.Je=Px(),this.He=Px(),this.Ye=new Er(en),i}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,t)?i.Qe(t,1):i.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new PL,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Qn(en),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Qn(en),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||et("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new PL),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Px(){return new Er(ft.comparator)}function ML(){return new Er(ft.comparator)}const Jee={asc:"ASCENDING",desc:"DESCENDING"},Qee={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ete={and:"AND",or:"OR"};class tte{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function nR(n,e){return n.useProto3Json||Qw(e)?e:{value:e}}function Z0(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function v8(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function nte(n,e){return Z0(n,e.toTimestamp())}function bs(n){return Ot(!!n,49232),Vt.fromTimestamp((function(t){const r=oc(t);return new qn(r.seconds,r.nanos)})(n))}function MI(n,e){return rR(n,e).canonicalString()}function rR(n,e){const t=(function(i){return new jn(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function w8(n){const e=jn.fromString(n);return Ot(k8(e),10190,{key:e.toString()}),e}function xv(n,e){return MI(n.databaseId,e.path)}function Jh(n,e){const t=w8(e);if(t.get(1)!==n.databaseId.projectId)throw new ht(Oe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new ht(Oe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new ft(S8(t))}function E8(n,e){return MI(n.databaseId,e)}function T8(n){const e=w8(n);return e.length===4?jn.emptyPath():S8(e)}function iR(n){return new jn(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function S8(n){return Ot(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function NL(n,e,t){return{name:xv(n,e),fields:t.value.mapValue.fields}}function rte(n,e,t){const r=Jh(n,e.name),i=bs(e.updateTime),s=e.createTime?bs(e.createTime):Vt.min(),a=new os({mapValue:{fields:e.fields}}),o=Vr.newFoundDocument(r,i,s,a);return t&&o.setHasCommittedMutations(),t?o.setHasCommittedMutations():o}function ite(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Ct(39313,{state:c})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=(function(c,h){return c.useProto3Json?(Ot(h===void 0||typeof h=="string",58123),ii.fromBase64String(h||"")):(Ot(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),ii.fromUint8Array(h||new Uint8Array))})(n,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&(function(c){const h=c.code===void 0?Oe.UNKNOWN:y8(c.code);return new ht(h,c.message||"")})(a);t=new _8(r,i,s,o||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Jh(n,r.document.name),s=bs(r.document.updateTime),a=r.document.createTime?bs(r.document.createTime):Vt.min(),o=new os({mapValue:{fields:r.document.fields}}),l=Vr.newFoundDocument(i,s,a,o),c=r.targetIds||[],h=r.removedTargetIds||[];t=new x_(c,h,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Jh(n,r.document),s=r.readTime?bs(r.readTime):Vt.min(),a=Vr.newNoDocument(i,s),o=r.removedTargetIds||[];t=new x_([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Jh(n,r.document),s=r.removedTargetIds||[];t=new x_([],s,i,null)}else{if(!("filter"in e))return Ct(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,a=new Kee(i,s),o=r.targetId;t=new x8(o,a)}}return t}function _v(n,e){let t;if(e instanceof fg)t={update:NL(n,e.key,e.value)};else if(e instanceof cE)t={delete:xv(n,e.key)};else if(e instanceof yc)t={update:NL(n,e.key,e.data),updateMask:ute(e.fieldMask)};else{if(!(e instanceof p8))return Ct(16599,{Vt:e.type});t={verify:xv(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(s,a){const o=a.transform;if(o instanceof X0)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof q0)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof Y0)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Xp)return{fieldPath:a.field.canonicalString(),increment:o.Ae};throw Ct(20930,{transform:a.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(i,s){return s.updateTime!==void 0?{updateTime:nte(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Ct(27497)})(n,e.precondition)),t}function sR(n,e){const t=e.currentDocument?(function(s){return s.updateTime!==void 0?ls.updateTime(bs(s.updateTime)):s.exists!==void 0?ls.exists(s.exists):ls.none()})(e.currentDocument):ls.none(),r=e.updateTransforms?e.updateTransforms.map((i=>(function(a,o){let l=null;if("setToServerValue"in o)Ot(o.setToServerValue==="REQUEST_TIME",16630,{proto:o}),l=new X0;else if("appendMissingElements"in o){const h=o.appendMissingElements.values||[];l=new q0(h)}else if("removeAllFromArray"in o){const h=o.removeAllFromArray.values||[];l=new Y0(h)}else"increment"in o?l=new Xp(a,o.increment):Ct(16584,{proto:o});const c=Pr.fromServerFormat(o.fieldPath);return new f8(c,l)})(n,i))):[];if(e.update){e.update.name;const i=Jh(n,e.update.name),s=new os({mapValue:{fields:e.update.fields}});if(e.updateMask){const a=(function(l){const c=l.fieldPaths||[];return new Gs(c.map((h=>Pr.fromServerFormat(h))))})(e.updateMask);return new yc(i,s,a,t,r)}return new fg(i,s,t,r)}if(e.delete){const i=Jh(n,e.delete);return new cE(i,t)}if(e.verify){const i=Jh(n,e.verify);return new p8(i,t)}return Ct(1463,{proto:e})}function ste(n,e){return n&&n.length>0?(Ot(e!==void 0,14353),n.map((t=>(function(i,s){let a=i.updateTime?bs(i.updateTime):bs(s);return a.isEqual(Vt.min())&&(a=bs(s)),new $ee(a,i.transformResults||[])})(t,e)))):[]}function b8(n,e){return{documents:[E8(n,e.path)]}}function R8(n,e){const t={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=E8(n,i);const s=(function(c){if(c.length!==0)return C8(Zn.create(c,"and"))})(e.filters);s&&(t.structuredQuery.where=s);const a=(function(c){if(c.length!==0)return c.map((h=>(function(m){return{field:Yf(m.field),direction:ote(m.dir)}})(h)))})(e.orderBy);a&&(t.structuredQuery.orderBy=a);const o=nR(n,e.limit);return o!==null&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt=(function(c){return{before:c.inclusive,values:c.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(c){return{before:!c.inclusive,values:c.position}})(e.endAt)),{ft:t,parent:i}}function A8(n){let e=T8(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){Ot(r===1,65062);const h=t.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let s=[];t.where&&(s=(function(f){const m=I8(f);return m instanceof Zn&&RI(m)?m.getFilters():[m]})(t.where));let a=[];t.orderBy&&(a=(function(f){return f.map((m=>(function(x){return new mv(Zf(x.field),(function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(x.direction))})(m)))})(t.orderBy));let o=null;t.limit&&(o=(function(f){let m;return m=typeof f=="object"?f.value:f,Qw(m)?null:m})(t.limit));let l=null;t.startAt&&(l=(function(f){const m=!!f.before,y=f.values||[];return new H0(y,m)})(t.startAt));let c=null;return t.endAt&&(c=(function(f){const m=!f.before,y=f.values||[];return new H0(y,m)})(t.endAt)),Pee(e,i,a,s,o,"F",l,c)}function ate(n,e){const t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ct(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function I8(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Zf(t.unaryFilter.field);return xn.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Zf(t.unaryFilter.field);return xn.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Zf(t.unaryFilter.field);return xn.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Zf(t.unaryFilter.field);return xn.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ct(61313);default:return Ct(60726)}})(n):n.fieldFilter!==void 0?(function(t){return xn.create(Zf(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ct(58110);default:return Ct(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Zn.create(t.compositeFilter.filters.map((r=>I8(r))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Ct(1026)}})(t.compositeFilter.op))})(n):Ct(30097,{filter:n})}function ote(n){return Jee[n]}function lte(n){return Qee[n]}function cte(n){return ete[n]}function Yf(n){return{fieldPath:n.canonicalString()}}function Zf(n){return Pr.fromServerFormat(n.fieldPath)}function C8(n){return n instanceof xn?(function(t){if(t.op==="=="){if(yL(t.value))return{unaryFilter:{field:Yf(t.field),op:"IS_NAN"}};if(pL(t.value))return{unaryFilter:{field:Yf(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(yL(t.value))return{unaryFilter:{field:Yf(t.field),op:"IS_NOT_NAN"}};if(pL(t.value))return{unaryFilter:{field:Yf(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Yf(t.field),op:lte(t.op),value:t.value}}})(n):n instanceof Zn?(function(t){const r=t.getFilters().map((i=>C8(i)));return r.length===1?r[0]:{compositeFilter:{op:cte(t.op),filters:r}}})(n):Ct(54877,{filter:n})}function ute(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function k8(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class Wl{constructor(e,t,r,i,s=Vt.min(),a=Vt.min(),o=ii.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new Wl(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Wl(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Wl(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Wl(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class P8{constructor(e){this.yt=e}}function hte(n,e){let t;if(e.document)t=rte(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=ft.fromSegments(e.noDocument.path),i=yd(e.noDocument.readTime);t=Vr.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Ct(56709);{const r=ft.fromSegments(e.unknownDocument.path),i=yd(e.unknownDocument.version);t=Vr.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime((function(i){const s=new qn(i[0],i[1]);return Vt.fromTimestamp(s)})(e.readTime)),t}function LL(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:vv(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=(function(s,a){return{name:xv(s,a.key),fields:a.data.value.mapValue.fields,updateTime:Z0(s,a.version.toTimestamp()),createTime:Z0(s,a.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:pd(e.version)};else{if(!e.isUnknownDocument())return Ct(57904,{document:e});r.unknownDocument={path:t.path.toArray(),version:pd(e.version)}}return r}function vv(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function pd(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function yd(n){const e=new qn(n.seconds,n.nanoseconds);return Vt.fromTimestamp(e)}function Lh(n,e){const t=(e.baseMutations||[]).map((s=>sR(n.yt,s)));for(let s=0;s<e.mutations.length-1;++s){const a=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const o=e.mutations[s+1];a.updateTransforms=o.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map((s=>sR(n.yt,s))),i=qn.fromMillis(e.localWriteTimeMs);return new II(e.batchId,i,t,r)}function Cm(n){const e=yd(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?yd(n.lastLimboFreeSnapshotVersion):Vt.min();let r;return r=(function(s){return s.documents!==void 0})(n.query)?(function(s){const a=s.documents.length;return Ot(a===1,1966,{count:a}),Ba(sE(T8(s.documents[0])))})(n.query):(function(s){return Ba(A8(s))})(n.query),new Wl(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,ii.fromBase64String(n.resumeToken))}function M8(n,e){const t=pd(e.snapshotVersion),r=pd(e.lastLimboFreeSnapshotVersion);let i;i=pv(e.target)?b8(n.yt,e.target):R8(n.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:md(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function N8(n){const e=A8({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?tR(e,e.limit,"L"):e}function hS(n,e){return new kI(e.largestBatchId,sR(n.yt,e.overlayMutation))}function OL(n,e){const t=e.path.lastSegment();return[n,us(e.path.popLast()),t]}function DL(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:pd(r.readTime),documentKey:us(r.documentKey.path),largestBatchId:r.largestBatchId}}class dte{getBundleMetadata(e,t){return FL(e).get(t).next((r=>{if(r)return(function(s){return{id:s.bundleId,createTime:yd(s.createTime),version:s.version}})(r)}))}saveBundleMetadata(e,t){return FL(e).put((function(i){return{bundleId:i.id,createTime:pd(bs(i.createTime)),version:i.version}})(t))}getNamedQuery(e,t){return jL(e).get(t).next((r=>{if(r)return(function(s){return{name:s.name,query:N8(s.bundledQuery),readTime:yd(s.readTime)}})(r)}))}saveNamedQuery(e,t){return jL(e).put((function(i){return{name:i.name,readTime:pd(bs(i.readTime)),bundledQuery:i.bundledQuery}})(t))}}function FL(n){return yi(n,eE)}function jL(n){return yi(n,tE)}class hE{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const r=t.uid||"";return new hE(e,r)}getOverlay(e,t){return gm(e).get(OL(this.userId,t)).next((r=>r?hS(this.serializer,r):null))}getOverlays(e,t){const r=el();return de.forEach(t,(i=>this.getOverlay(e,i).next((s=>{s!==null&&r.set(i,s)})))).next((()=>r))}saveOverlays(e,t,r){const i=[];return r.forEach(((s,a)=>{const o=new kI(t,a);i.push(this.St(e,o))})),de.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach((a=>i.add(us(a.getCollectionPath()))));const s=[];return i.forEach((a=>{const o=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,r+1],!1,!0);s.push(gm(e).Z(Kb,o))})),de.waitFor(s)}getOverlaysForCollection(e,t,r){const i=el(),s=us(t),a=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return gm(e).J(Kb,a).next((o=>{for(const l of o){const c=hS(this.serializer,l);i.set(c.getKey(),c)}return i}))}getOverlaysForCollectionGroup(e,t,r,i){const s=el();let a;const o=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return gm(e).ee({index:L6,range:o},((l,c,h)=>{const f=hS(this.serializer,c);s.size()<i||f.largestBatchId===a?(s.set(f.getKey(),f),a=f.largestBatchId):h.done()})).next((()=>s))}St(e,t){return gm(e).put((function(i,s,a){const[o,l,c]=OL(s,a.mutation.key);return{userId:s,collectionPath:l,documentId:c,collectionGroup:a.mutation.key.getCollectionGroup(),largestBatchId:a.largestBatchId,overlayMutation:_v(i.yt,a.mutation)}})(this.serializer,this.userId,t))}}function gm(n){return yi(n,nE)}class fte{bt(e){return yi(e,wI)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const r=t?.value;return r?ii.fromUint8Array(r):ii.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class Oh{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(xr(e.integerValue));else if("doubleValue"in e){const r=xr(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),Gp(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),typeof r=="string"&&(r=oc(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(lc(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?H6(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):iE(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):Ct(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const r=e.fields||{};this.Ft(t,55);for(const i of Object.keys(r))this.Ot(i,t),this.Ct(r[i],t)}kt(e,t){const r=e.fields||{};this.Ft(t,53);const i=$0,s=r[i].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(xr(s)),this.Ot(i,t),this.Ct(r[i],t)}Qt(e,t){const r=e.values||[];this.Ft(t,50);for(const i of r)this.Ct(i,t)}Lt(e,t){this.Ft(t,37),ft.fromName(e).path.forEach((r=>{this.Ft(t,60),this.Ut(r,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}Oh.Kt=new Oh;const Nf=255;function gte(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function VL(n){const e=64-(function(r){let i=0;for(let s=0;s<8;++s){const a=gte(255&r[s]);if(i+=a,a!==8)break}return i})(n);return Math.ceil(e/8)}class mte{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Gt(r.value),r=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Jt(r.value),r=t.next();this.Ht()}Yt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const i=t.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Zt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const i=t.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Ht()}Xt(e){const t=this.en(e),r=VL(t);this.tn(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}nn(e){const t=this.en(e),r=VL(t);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}rn(){this.sn(Nf),this.sn(255)}_n(){this.an(Nf),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(s){const a=new DataView(new ArrayBuffer(8));return a.setFloat64(0,s,!1),new Uint8Array(a.buffer)})(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Nf?(this.sn(Nf),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Nf?(this.an(Nf),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class pte{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class yte{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class mm{constructor(){this.cn=new mte,this.ln=new pte(this.cn),this.hn=new yte(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class Dh{constructor(e,t,r,i){this.Tn=e,this.In=t,this.En=r,this.dn=i}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.dn,0),t!==e?r.set([0],this.dn.length):++r[r.length-1],new Dh(this.Tn,this.In,this.En,r)}Rn(e,t,r){return{indexId:this.Tn,uid:e,arrayValue:__(this.En),directionalValue:__(this.dn),orderedDocumentKey:__(t),documentKey:r.path.toArray()}}Vn(e,t,r){const i=this.Rn(e,t,r);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function qc(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=GL(n.En,e.En),t!==0?t:(t=GL(n.dn,e.dn),t!==0?t:ft.comparator(n.In,e.In)))}function GL(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}function __(n){return Ij()?(function(t){let r="";for(let i=0;i<t.length;i++)r+=String.fromCharCode(t[i]);return r})(n):n}function BL(n){return typeof n!="string"?n:(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(n)}class zL{constructor(e){this.mn=new Qn(((t,r)=>Pr.comparator(t.field,r.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const r=t;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(Ot(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=$b(e);if(t!==void 0&&!this.wn(t))return!1;const r=Ah(e);let i=new Set,s=0,a=0;for(;s<r.length&&this.wn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.mn.size>0){const o=this.mn.getIterator().getNext();if(!i.has(o.field.canonicalString())){const l=r[s];if(!this.Sn(o,l)||!this.bn(this.fn[a++],l))return!1}++s}for(;s<r.length;++s){const o=r[s];if(a>=this.fn.length||!this.bn(this.fn[a++],o))return!1}return!0}Dn(){if(this.pn)return null;let e=new Qn(Pr.comparator);const t=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new h_(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new h_(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new h_(r.field,r.dir==="asc"?0:1)));return new uv(uv.UNKNOWN_ID,this.collectionId,t,Vp.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function L8(n){if(Ot(n instanceof xn||n instanceof Zn,20012),n instanceof xn){if(n instanceof t8){const t=n.value.arrayValue?.values?.map((r=>xn.create(n.field,"==",r)))||[];return Zn.create(t,"or")}return n}const e=n.filters.map((t=>L8(t)));return Zn.create(e,n.op)}function xte(n){if(n.getFilters().length===0)return[];const e=lR(L8(n));return Ot(O8(e),7391),aR(e)||oR(e)?[e]:e.getFilters()}function aR(n){return n instanceof xn}function oR(n){return n instanceof Zn&&RI(n)}function O8(n){return aR(n)||oR(n)||(function(t){if(t instanceof Zn&&Zb(t)){for(const r of t.getFilters())if(!aR(r)&&!oR(r))return!1;return!0}return!1})(n)}function lR(n){if(Ot(n instanceof xn||n instanceof Zn,34018),n instanceof xn)return n;if(n.filters.length===1)return lR(n.filters[0]);const e=n.filters.map((r=>lR(r)));let t=Zn.create(e,n.op);return t=wv(t),O8(t)?t:(Ot(t instanceof Zn,64498),Ot(K0(t),40251),Ot(t.filters.length>1,57927),t.filters.reduce(((r,i)=>NI(r,i))))}function NI(n,e){let t;return Ot(n instanceof xn||n instanceof Zn,38388),Ot(e instanceof xn||e instanceof Zn,25473),t=n instanceof xn?e instanceof xn?(function(i,s){return Zn.create([i,s],"and")})(n,e):UL(n,e):e instanceof xn?UL(e,n):(function(i,s){if(Ot(i.filters.length>0&&s.filters.length>0,48005),K0(i)&&K0(s))return J6(i,s.getFilters());const a=Zb(i)?i:s,o=Zb(i)?s:i,l=a.filters.map((c=>NI(c,o)));return Zn.create(l,"or")})(n,e),wv(t)}function UL(n,e){if(K0(e))return J6(e,n.getFilters());{const t=e.filters.map((r=>NI(n,r)));return Zn.create(t,"or")}}function wv(n){if(Ot(n instanceof xn||n instanceof Zn,11850),n instanceof xn)return n;const e=n.getFilters();if(e.length===1)return wv(e[0]);if(Y6(n))return n;const t=e.map((i=>wv(i))),r=[];return t.forEach((i=>{i instanceof xn?r.push(i):i instanceof Zn&&(i.op===n.op?r.push(...i.filters):r.push(i))})),r.length===1?r[0]:Zn.create(r,n.op)}class _te{constructor(){this.Cn=new LI}addToCollectionParentIndex(e,t){return this.Cn.add(t),de.resolve()}getCollectionParents(e,t){return de.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return de.resolve()}deleteFieldIndex(e,t){return de.resolve()}deleteAllFieldIndexes(e){return de.resolve()}createTargetIndexes(e,t){return de.resolve()}getDocumentsMatchingTarget(e,t){return de.resolve(null)}getIndexType(e,t){return de.resolve(0)}getFieldIndexes(e,t){return de.resolve([])}getNextCollectionGroupToUpdate(e){return de.resolve(null)}getMinOffset(e,t){return de.resolve(ma.min())}getMinOffsetFromCollectionGroup(e,t){return de.resolve(ma.min())}updateCollectionGroup(e,t,r){return de.resolve()}updateIndexEntries(e,t){return de.resolve()}}class LI{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Qn(jn.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Qn(jn.comparator)).toArray()}}const $L="IndexedDbIndexManager",Mx=new Uint8Array(0);class vte{constructor(e,t){this.databaseId=t,this.vn=new LI,this.Fn=new pc((r=>md(r)),((r,i)=>Vy(r,i))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const s={collectionId:r,parent:us(i)};return WL(e).put(s)}return de.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[E6(t),""],!1,!0);return WL(e).J(i).next((s=>{for(const a of s){if(a.collectionId!==t)break;r.push(Qo(a.parent))}return r}))}addFieldIndex(e,t){const r=pm(e),i=(function(o){return{indexId:o.indexId,collectionGroup:o.collectionGroup,fields:o.fields.map((l=>[l.fieldPath.canonicalString(),l.kind]))}})(t);delete i.indexId;const s=r.add(i);if(t.indexState){const a=Of(e);return s.next((o=>{a.put(DL(o,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return s.next()}deleteFieldIndex(e,t){const r=pm(e),i=Of(e),s=Lf(e);return r.delete(t.indexId).next((()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=pm(e),r=Lf(e),i=Of(e);return t.Z().next((()=>r.Z())).next((()=>i.Z()))}createTargetIndexes(e,t){return de.forEach(this.Mn(t),(r=>this.getIndexType(e,r).next((i=>{if(i===0||i===1){const s=new zL(r).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))))}getDocumentsMatchingTarget(e,t){const r=Lf(e);let i=!0;const s=new Map;return de.forEach(this.Mn(t),(a=>this.xn(e,a).next((o=>{i&&(i=!!o),s.set(a,o)})))).next((()=>{if(i){let a=un();const o=[];return de.forEach(s,((l,c)=>{et($L,`Using index ${(function(R){return`id=${R.indexId}|cg=${R.collectionGroup}|f=${R.fields.map((M=>`${M.fieldPath}:${M.kind}`)).join(",")}`})(l)} to execute ${md(t)}`);const h=(function(R,M){const O=$b(M);if(O===void 0)return null;for(const G of yv(R,O.fieldPath))switch(G.op){case"array-contains-any":return G.value.arrayValue.values||[];case"array-contains":return[G.value]}return null})(c,l),f=(function(R,M){const O=new Map;for(const G of Ah(M))for(const A of yv(R,G.fieldPath))switch(A.op){case"==":case"in":O.set(G.fieldPath.canonicalString(),A.value);break;case"not-in":case"!=":return O.set(G.fieldPath.canonicalString(),A.value),Array.from(O.values())}return null})(c,l),m=(function(R,M){const O=[];let G=!0;for(const A of Ah(M)){const I=A.kind===0?EL(R,A.fieldPath,R.startAt):TL(R,A.fieldPath,R.startAt);O.push(I.value),G&&(G=I.inclusive)}return new H0(O,G)})(c,l),y=(function(R,M){const O=[];let G=!0;for(const A of Ah(M)){const I=A.kind===0?TL(R,A.fieldPath,R.endAt):EL(R,A.fieldPath,R.endAt);O.push(I.value),G&&(G=I.inclusive)}return new H0(O,G)})(c,l),x=this.On(l,c,m),_=this.On(l,c,y),w=this.Nn(l,c,f),S=this.Bn(l.indexId,h,x,m.inclusive,_,y.inclusive,w);return de.forEach(S,(b=>r.Y(b,t.limit).next((R=>{R.forEach((M=>{const O=ft.fromSegments(M.documentKey);a.has(O)||(a=a.add(O),o.push(O))}))}))))})).next((()=>o))}return de.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=xte(Zn.create(e.filters,"and")).map((r=>Qb(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,r,i,s,a,o){const l=(t!=null?t.length:1)*Math.max(r.length,s.length),c=l/(t!=null?t.length:1),h=[];for(let f=0;f<l;++f){const m=t?this.Ln(t[f/c]):Mx,y=this.kn(e,m,r[f%c],i),x=this.qn(e,m,s[f%c],a),_=o.map((w=>this.kn(e,m,w,!0)));h.push(...this.createRange(y,x,_))}return h}kn(e,t,r,i){const s=new Dh(e,ft.empty(),t,r);return i?s:s.An()}qn(e,t,r,i){const s=new Dh(e,ft.empty(),t,r);return i?s.An():s}xn(e,t){const r=new zL(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next((s=>{let a=null;for(const o of s)r.yn(o)&&(!a||o.fields.length>a.fields.length)&&(a=o);return a}))}getIndexType(e,t){let r=2;const i=this.Mn(t);return de.forEach(i,(s=>this.xn(e,s).next((a=>{a?r!==0&&a.fields.length<(function(l){let c=new Qn(Pr.comparator),h=!1;for(const f of l.filters)for(const m of f.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?h=!0:c=c.add(m.field));for(const f of l.orderBy)f.field.isKeyField()||(c=c.add(f.field));return c.size+(h?1:0)})(s)&&(r=1):r=0})))).next((()=>(function(a){return a.limit!==null})(t)&&i.length>1&&r===2?1:r))}Qn(e,t){const r=new mm;for(const i of Ah(e)){const s=t.data.field(i.fieldPath);if(s==null)return null;const a=r.Pn(i.kind);Oh.Kt.Dt(s,a)}return r.un()}Ln(e){const t=new mm;return Oh.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const r=new mm;return Oh.Kt.Dt(Hp(this.databaseId,t),r.Pn((function(s){const a=Ah(s);return a.length===0?0:a[a.length-1].kind})(e))),r.un()}Nn(e,t,r){if(r===null)return[];let i=[];i.push(new mm);let s=0;for(const a of Ah(e)){const o=r[s++];for(const l of i)if(this.Un(t,a.fieldPath)&&Kp(o))i=this.Kn(i,a,o);else{const c=l.Pn(a.kind);Oh.Kt.Dt(o,c)}}return this.Wn(i)}On(e,t,r){return this.Nn(e,t,r.position)}Wn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].un();return t}Kn(e,t,r){const i=[...e],s=[];for(const a of r.arrayValue.values||[])for(const o of i){const l=new mm;l.seed(o.un()),Oh.Kt.Dt(a,l.Pn(t.kind)),s.push(l)}return s}Un(e,t){return!!e.filters.find((r=>r instanceof xn&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in")))}getFieldIndexes(e,t){const r=pm(e),i=Of(e);return(t?r.J(Hb,IDBKeyRange.bound(t,t)):r.J()).next((s=>{const a=[];return de.forEach(s,(o=>i.get([o.indexId,this.uid]).next((l=>{a.push((function(h,f){const m=f?new Vp(f.sequenceNumber,new ma(yd(f.readTime),new ft(Qo(f.documentKey)),f.largestBatchId)):Vp.empty(),y=h.fields.map((([x,_])=>new h_(Pr.fromServerFormat(x),_)));return new uv(h.indexId,h.collectionGroup,y,m)})(o,l))})))).next((()=>a))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:en(r.collectionGroup,i.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,r){const i=pm(e),s=Of(e);return this.Gn(e).next((a=>i.J(Hb,IDBKeyRange.bound(t,t)).next((o=>de.forEach(o,(l=>s.put(DL(l.indexId,this.uid,a,r))))))))}updateIndexEntries(e,t){const r=new Map;return de.forEach(t,((i,s)=>{const a=r.get(i.collectionGroup);return(a?de.resolve(a):this.getFieldIndexes(e,i.collectionGroup)).next((o=>(r.set(i.collectionGroup,o),de.forEach(o,(l=>this.zn(e,i,l).next((c=>{const h=this.jn(s,l);return c.isEqual(h)?de.resolve():this.Jn(e,s,l,c,h)})))))))}))}Hn(e,t,r,i){return Lf(e).put(i.Rn(this.uid,this.$n(r,t.key),t.key))}Yn(e,t,r,i){return Lf(e).delete(i.Vn(this.uid,this.$n(r,t.key),t.key))}zn(e,t,r){const i=Lf(e);let s=new Qn(qc);return i.ee({index:N6,range:IDBKeyRange.only([r.indexId,this.uid,__(this.$n(r,t))])},((a,o)=>{s=s.add(new Dh(r.indexId,t,BL(o.arrayValue),BL(o.directionalValue)))})).next((()=>s))}jn(e,t){let r=new Qn(qc);const i=this.Qn(t,e);if(i==null)return r;const s=$b(t);if(s!=null){const a=e.data.field(s.fieldPath);if(Kp(a))for(const o of a.arrayValue.values||[])r=r.add(new Dh(t.indexId,e.key,this.Ln(o),i))}else r=r.add(new Dh(t.indexId,e.key,Mx,i));return r}Jn(e,t,r,i,s){et($L,"Updating index entries for document '%s'",t.key);const a=[];return(function(l,c,h,f,m){const y=l.getIterator(),x=c.getIterator();let _=Mf(y),w=Mf(x);for(;_||w;){let S=!1,b=!1;if(_&&w){const R=h(_,w);R<0?b=!0:R>0&&(S=!0)}else _!=null?b=!0:S=!0;S?(f(w),w=Mf(x)):b?(m(_),_=Mf(y)):(_=Mf(y),w=Mf(x))}})(i,s,qc,(o=>{a.push(this.Hn(e,t,r,o))}),(o=>{a.push(this.Yn(e,t,r,o))})),de.waitFor(a)}Gn(e){let t=1;return Of(e).ee({index:M6,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((r,i,s)=>{s.done(),t=i.sequenceNumber+1})).next((()=>t))}createRange(e,t,r){r=r.sort(((a,o)=>qc(a,o))).filter(((a,o,l)=>!o||qc(a,l[o-1])!==0));const i=[];i.push(e);for(const a of r){const o=qc(a,e),l=qc(a,t);if(o===0)i[0]=e.An();else if(o>0&&l<0)i.push(a),i.push(a.An());else if(l>0)break}i.push(t);const s=[];for(let a=0;a<i.length;a+=2){if(this.Zn(i[a],i[a+1]))return[];const o=i[a].Vn(this.uid,Mx,ft.empty()),l=i[a+1].Vn(this.uid,Mx,ft.empty());s.push(IDBKeyRange.bound(o,l))}return s}Zn(e,t){return qc(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(HL)}getMinOffset(e,t){return de.mapArray(this.Mn(t),(r=>this.xn(e,r).next((i=>i||Ct(44426))))).next(HL)}}function WL(n){return yi(n,Up)}function Lf(n){return yi(n,Km)}function pm(n){return yi(n,vI)}function Of(n){return yi(n,Hm)}function HL(n){Ot(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;yI(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new ma(e.readTime,e.documentKey,t)}const KL={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},D8=41943040;class ss{static withCacheSize(e){return new ss(e,ss.DEFAULT_COLLECTION_PERCENTILE,ss.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}function F8(n,e,t){const r=n.store(co),i=n.store(G0),s=[],a=IDBKeyRange.only(t.batchId);let o=0;const l=r.ee({range:a},((h,f,m)=>(o++,m.delete())));s.push(l.next((()=>{Ot(o===1,47070,{batchId:t.batchId})})));const c=[];for(const h of t.mutations){const f=C6(e,h.key.path,t.batchId);s.push(i.delete(f)),c.push(h.key)}return de.waitFor(s).next((()=>c))}function Ev(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Ct(14731);e=n.noDocument}return JSON.stringify(e).length}ss.DEFAULT_COLLECTION_PERCENTILE=10,ss.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ss.DEFAULT=new ss(D8,ss.DEFAULT_COLLECTION_PERCENTILE,ss.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ss.DISABLED=new ss(-1,0,0);class dE{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Xn={}}static wt(e,t,r,i){Ot(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new dE(s,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Yc(e).ee({index:Uh,range:r},((i,s,a)=>{t=!1,a.done()})).next((()=>t))}addMutationBatch(e,t,r,i){const s=Jf(e),a=Yc(e);return a.add({}).next((o=>{Ot(typeof o=="number",49019);const l=new II(o,t,r,i),c=(function(y,x,_){const w=_.baseMutations.map((b=>_v(y.yt,b))),S=_.mutations.map((b=>_v(y.yt,b)));return{userId:x,batchId:_.batchId,localWriteTimeMs:_.localWriteTime.toMillis(),baseMutations:w,mutations:S}})(this.serializer,this.userId,l),h=[];let f=new Qn(((m,y)=>en(m.canonicalString(),y.canonicalString())));for(const m of i){const y=C6(this.userId,m.key.path,o);f=f.add(m.key.path.popLast()),h.push(a.put(c)),h.push(s.put(y,qQ))}return f.forEach((m=>{h.push(this.indexManager.addToCollectionParentIndex(e,m))})),e.addOnCommittedListener((()=>{this.Xn[o]=l.keys()})),de.waitFor(h).next((()=>l))}))}lookupMutationBatch(e,t){return Yc(e).get(t).next((r=>r?(Ot(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:t}),Lh(this.serializer,r)):null))}er(e,t){return this.Xn[t]?de.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((r=>{if(r){const i=r.keys();return this.Xn[t]=i,i}return null}))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return Yc(e).ee({index:Uh,range:i},((a,o,l)=>{o.userId===this.userId&&(Ot(o.batchId>=r,47524,{tr:r}),s=Lh(this.serializer,o)),l.done()})).next((()=>s))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=Yh;return Yc(e).ee({index:Uh,range:t,reverse:!0},((i,s,a)=>{r=s.batchId,a.done()})).next((()=>r))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Yh],[this.userId,Number.POSITIVE_INFINITY]);return Yc(e).J(Uh,t).next((r=>r.map((i=>Lh(this.serializer,i)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=d_(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return Jf(e).ee({range:i},((a,o,l)=>{const[c,h,f]=a,m=Qo(h);if(c===this.userId&&t.path.isEqual(m))return Yc(e).get(f).next((y=>{if(!y)throw Ct(61480,{nr:a,batchId:f});Ot(y.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:y.userId,batchId:f}),s.push(Lh(this.serializer,y))}));l.done()})).next((()=>s))}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Qn(en);const i=[];return t.forEach((s=>{const a=d_(this.userId,s.path),o=IDBKeyRange.lowerBound(a),l=Jf(e).ee({range:o},((c,h,f)=>{const[m,y,x]=c,_=Qo(y);m===this.userId&&s.path.isEqual(_)?r=r.add(x):f.done()}));i.push(l)})),de.waitFor(i).next((()=>this.rr(e,r)))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,s=d_(this.userId,r),a=IDBKeyRange.lowerBound(s);let o=new Qn(en);return Jf(e).ee({range:a},((l,c,h)=>{const[f,m,y]=l,x=Qo(m);f===this.userId&&r.isPrefixOf(x)?x.length===i&&(o=o.add(y)):h.done()})).next((()=>this.rr(e,o)))}rr(e,t){const r=[],i=[];return t.forEach((s=>{i.push(Yc(e).get(s).next((a=>{if(a===null)throw Ct(35274,{batchId:s});Ot(a.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:a.userId,batchId:s}),r.push(Lh(this.serializer,a))})))})),de.waitFor(i).next((()=>r))}removeMutationBatch(e,t){return F8(e.le,this.userId,t).next((r=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),de.forEach(r,(i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return de.resolve();const r=IDBKeyRange.lowerBound((function(a){return[a]})(this.userId)),i=[];return Jf(e).ee({range:r},((s,a,o)=>{if(s[0]===this.userId){const l=Qo(s[1]);i.push(l)}else o.done()})).next((()=>{Ot(i.length===0,56720,{sr:i.map((s=>s.canonicalString()))})}))}))}containsKey(e,t){return j8(e,this.userId,t)}_r(e){return V8(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:Yh,lastStreamToken:""}))}}function j8(n,e,t){const r=d_(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r);let a=!1;return Jf(n).ee({range:s,X:!0},((o,l,c)=>{const[h,f,m]=o;h===e&&f===i&&(a=!0),c.done()})).next((()=>a))}function Yc(n){return yi(n,co)}function Jf(n){return yi(n,G0)}function V8(n){return yi(n,Bp)}class xd{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new xd(0)}static cr(){return new xd(-1)}}class wte{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const r=new xd(t.highestTargetId);return t.highestTargetId=r.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>Vt.fromTimestamp(new qn(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,r){return this.lr(e).next((i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.hr(e,i))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((r=>(r.targetCount+=1,this.Tr(t,r),this.hr(e,r))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>Df(e).delete(t.targetId))).next((()=>this.lr(e))).next((r=>(Ot(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r))))}removeTargets(e,t,r){let i=0;const s=[];return Df(e).ee(((a,o)=>{const l=Cm(o);l.sequenceNumber<=t&&r.get(l.targetId)===null&&(i++,s.push(this.removeTargetData(e,l)))})).next((()=>de.waitFor(s))).next((()=>i))}forEachTarget(e,t){return Df(e).ee(((r,i)=>{const s=Cm(i);t(s)}))}lr(e){return XL(e).get(fv).next((t=>(Ot(t!==null,2888),t)))}hr(e,t){return XL(e).put(fv,t)}Pr(e,t){return Df(e).put(M8(this.serializer,t))}Tr(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const r=md(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return Df(e).ee({range:i,index:P6},((a,o,l)=>{const c=Cm(o);Vy(t,c.target)&&(s=c,l.done())})).next((()=>s))}addMatchingKeys(e,t,r){const i=[],s=ou(e);return t.forEach((a=>{const o=us(a.path);i.push(s.put({targetId:r,path:o})),i.push(this.referenceDelegate.addReference(e,r,a))})),de.waitFor(i)}removeMatchingKeys(e,t,r){const i=ou(e);return de.forEach(t,(s=>{const a=us(s.path);return de.waitFor([i.delete([r,a]),this.referenceDelegate.removeReference(e,r,s)])}))}removeMatchingKeysForTargetId(e,t){const r=ou(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=ou(e);let s=un();return i.ee({range:r,X:!0},((a,o,l)=>{const c=Qo(a[1]),h=new ft(c);s=s.add(h)})).next((()=>s))}containsKey(e,t){const r=us(t.path),i=IDBKeyRange.bound([r],[E6(r)],!1,!0);let s=0;return ou(e).ee({index:_I,X:!0,range:i},(([a,o],l,c)=>{a!==0&&(s++,c.done())})).next((()=>s>0))}At(e,t){return Df(e).get(t).next((r=>r?Cm(r):null))}}function Df(n){return yi(n,B0)}function XL(n){return yi(n,Zh)}function ou(n){return yi(n,z0)}const qL="LruGarbageCollector",Ete=1048576;function YL([n,e],[t,r]){const i=en(n,t);return i===0?en(e,r):i}class Tte{constructor(e){this.Ir=e,this.buffer=new Qn(YL),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();YL(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class G8{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){et(qL,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Hu(t)?et(qL,"Ignoring IndexedDB error during garbage collection: ",t):await Ld(t)}await this.Vr(3e5)}))}}class Ste{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return de.resolve(ja.ce);const r=new Tte(t);return this.mr.forEachTarget(e,(i=>r.Ar(i.sequenceNumber))).next((()=>this.mr.pr(e,(i=>r.Ar(i))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(et("LruGarbageCollector","Garbage collection skipped; disabled"),de.resolve(KL)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(et("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),KL):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,i,s,a,o,l,c;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((f=>(f>this.params.maximumSequenceNumbersToCollect?(et("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),i=this.params.maximumSequenceNumbersToCollect):i=f,a=Date.now(),this.nthSequenceNumber(e,i)))).next((f=>(r=f,o=Date.now(),this.removeTargets(e,r,t)))).next((f=>(s=f,l=Date.now(),this.removeOrphanedDocuments(e,r)))).next((f=>(c=Date.now(),Xf()<=yn.DEBUG&&et("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-h}ms
	Determined least recently used ${i} in `+(o-a)+`ms
	Removed ${s} targets in `+(l-o)+`ms
	Removed ${f} documents in `+(c-l)+`ms
Total Duration: ${c-h}ms`),de.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:f}))))}}function B8(n,e){return new Ste(n,e)}class bte{constructor(e,t){this.db=e,this.garbageCollector=B8(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((r,i)=>t(i)))}addReference(e,t,r){return Nx(e,r)}removeReference(e,t,r){return Nx(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Nx(e,t)}br(e,t){return(function(i,s){let a=!1;return V8(i).te((o=>j8(i,o,s).next((l=>(l&&(a=!0),de.resolve(!l)))))).next((()=>a))})(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Sr(e,((a,o)=>{if(o<=t){const l=this.br(e,a).next((c=>{if(!c)return s++,r.getEntry(e,a).next((()=>(r.removeEntry(a,Vt.min()),ou(e).delete((function(f){return[0,us(f.path)]})(a)))))}));i.push(l)}})).next((()=>de.waitFor(i))).next((()=>r.apply(e))).next((()=>s))}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Nx(e,t)}Sr(e,t){const r=ou(e);let i,s=ja.ce;return r.ee({index:_I},(([a,o],{path:l,sequenceNumber:c})=>{a===0?(s!==ja.ce&&t(new ft(Qo(i)),s),s=c,i=l):s=ja.ce})).next((()=>{s!==ja.ce&&t(new ft(Qo(i)),s)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Nx(n,e){return ou(n).put((function(r,i){return{targetId:0,path:us(r.path),sequenceNumber:i}})(e,n.currentSequenceNumber))}class z8{constructor(){this.changes=new pc((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Vr.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?de.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Rte{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return wh(e).put(r)}removeEntry(e,t,r){return wh(e).delete((function(s,a){const o=s.path.toArray();return[o.slice(0,o.length-2),o[o.length-2],vv(a),o[o.length-1]]})(t,r))}updateMetadata(e,t){return this.getMetadata(e).next((r=>(r.byteSize+=t,this.Dr(e,r))))}getEntry(e,t){let r=Vr.newInvalidDocument(t);return wh(e).ee({index:f_,range:IDBKeyRange.only(ym(t))},((i,s)=>{r=this.Cr(t,s)})).next((()=>r))}vr(e,t){let r={size:0,document:Vr.newInvalidDocument(t)};return wh(e).ee({index:f_,range:IDBKeyRange.only(ym(t))},((i,s)=>{r={document:this.Cr(t,s),size:Ev(s)}})).next((()=>r))}getEntries(e,t){let r=da();return this.Fr(e,t,((i,s)=>{const a=this.Cr(i,s);r=r.insert(i,a)})).next((()=>r))}Mr(e,t){let r=da(),i=new Er(ft.comparator);return this.Fr(e,t,((s,a)=>{const o=this.Cr(s,a);r=r.insert(s,o),i=i.insert(s,Ev(a))})).next((()=>({documents:r,Or:i})))}Fr(e,t,r){if(t.isEmpty())return de.resolve();let i=new Qn(QL);t.forEach((l=>i=i.add(l)));const s=IDBKeyRange.bound(ym(i.first()),ym(i.last())),a=i.getIterator();let o=a.getNext();return wh(e).ee({index:f_,range:s},((l,c,h)=>{const f=ft.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;o&&QL(o,f)<0;)r(o,null),o=a.getNext();o&&o.isEqual(f)&&(r(o,c),o=a.hasNext()?a.getNext():null),o?h.j(ym(o)):h.done()})).next((()=>{for(;o;)r(o,null),o=a.hasNext()?a.getNext():null}))}getDocumentsMatchingQuery(e,t,r,i,s){const a=t.path,o=[a.popLast().toArray(),a.lastSegment(),vv(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[a.popLast().toArray(),a.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return wh(e).J(IDBKeyRange.bound(o,l,!0)).next((c=>{s?.incrementDocumentReadCount(c.length);let h=da();for(const f of c){const m=this.Cr(ft.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);m.isFoundDocument()&&(By(t,m)||i.has(m.key))&&(h=h.insert(m.key,m))}return h}))}getAllFromCollectionGroup(e,t,r,i){let s=da();const a=JL(t,r),o=JL(t,ma.max());return wh(e).ee({index:k6,range:IDBKeyRange.bound(a,o,!0)},((l,c,h)=>{const f=this.Cr(ft.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);s=s.insert(f.key,f),s.size===i&&h.done()})).next((()=>s))}newChangeBuffer(e){return new Ate(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return ZL(e).get(Wb).next((t=>(Ot(!!t,20021),t)))}Dr(e,t){return ZL(e).put(Wb,t)}Cr(e,t){if(t){const r=hte(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(Vt.min())))return r}return Vr.newInvalidDocument(e)}}function U8(n){return new Rte(n)}class Ate extends z8{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new pc((r=>r.toString()),((r,i)=>r.isEqual(i)))}applyChanges(e){const t=[];let r=0,i=new Qn(((s,a)=>en(s.canonicalString(),a.canonicalString())));return this.changes.forEach(((s,a)=>{const o=this.Br.get(s);if(t.push(this.Nr.removeEntry(e,s,o.readTime)),a.isValidDocument()){const l=LL(this.Nr.serializer,a);i=i.add(s.path.popLast());const c=Ev(l);r+=c-o.size,t.push(this.Nr.addEntry(e,s,l))}else if(r-=o.size,this.trackRemovals){const l=LL(this.Nr.serializer,a.convertToNoDocument(Vt.min()));t.push(this.Nr.addEntry(e,s,l))}})),i.forEach((s=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))})),t.push(this.Nr.updateMetadata(e,r)),de.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((r=>(this.Br.set(t,{size:r.size,readTime:r.document.readTime}),r.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:r,Or:i})=>(i.forEach(((s,a)=>{this.Br.set(s,{size:a,readTime:r.get(s).readTime})})),r)))}}function ZL(n){return yi(n,zp)}function wh(n){return yi(n,dv)}function ym(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function JL(n,e){const t=e.documentKey.path.toArray();return[n,vv(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function QL(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=en(t[s],r[s]),i)return i;return i=en(t.length,r.length),i||(i=en(t[t.length-2],r[r.length-2]),i||en(t[t.length-1],r[r.length-1]))}class Ite{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class $8{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(r=i,this.remoteDocumentCache.getEntry(e,t)))).next((i=>(r!==null&&Zm(r.mutation,i,Gs.empty(),qn.now()),i)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,un()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=un()){const i=el();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,r).next((s=>{let a=Am();return s.forEach(((o,l)=>{a=a.insert(o,l.overlayedDocument)})),a}))))}getOverlayedDocuments(e,t){const r=el();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,un())))}populateOverlays(e,t,r){const i=[];return r.forEach((s=>{t.has(s)||i.push(s)})),this.documentOverlayCache.getOverlays(e,i).next((s=>{s.forEach(((a,o)=>{t.set(a,o)}))}))}computeViews(e,t,r,i){let s=da();const a=Ym(),o=(function(){return Ym()})();return t.forEach(((l,c)=>{const h=r.get(c.key);i.has(c.key)&&(h===void 0||h.mutation instanceof yc)?s=s.insert(c.key,c):h!==void 0?(a.set(c.key,h.mutation.getFieldMask()),Zm(h.mutation,c,h.mutation.getFieldMask(),qn.now())):a.set(c.key,Gs.empty())})),this.recalculateAndSaveOverlays(e,s).next((l=>(l.forEach(((c,h)=>a.set(c,h))),t.forEach(((c,h)=>o.set(c,new Ite(h,a.get(c)??null)))),o)))}recalculateAndSaveOverlays(e,t){const r=Ym();let i=new Er(((a,o)=>a-o)),s=un();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((a=>{for(const o of a)o.keys().forEach((l=>{const c=t.get(l);if(c===null)return;let h=r.get(l)||Gs.empty();h=o.applyToLocalView(c,h),r.set(l,h);const f=(i.get(o.batchId)||un()).add(l);i=i.insert(o.batchId,f)}))})).next((()=>{const a=[],o=i.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),c=l.key,h=l.value,f=o8();h.forEach((m=>{if(!s.has(m)){const y=g8(t.get(m),r.get(m));y!==null&&f.set(m,y),s=s.add(m)}})),a.push(this.documentOverlayCache.saveOverlays(e,c,f))}return de.waitFor(a)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,i){return(function(a){return ft.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):n8(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next((s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):de.resolve(el());let o=jp,l=s;return a.next((c=>de.forEach(c,((h,f)=>(o<f.largestBatchId&&(o=f.largestBatchId),s.get(h)?de.resolve():this.remoteDocumentCache.getEntry(e,h).next((m=>{l=l.insert(h,m)}))))).next((()=>this.populateOverlays(e,c,s))).next((()=>this.computeViews(e,l,c,un()))).next((h=>({batchId:o,changes:a8(h)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ft(t)).next((r=>{let i=Am();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const s=t.collectionGroup;let a=Am();return this.indexManager.getCollectionParents(e,s).next((o=>de.forEach(o,(l=>{const c=(function(f,m){return new Gy(m,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)})(t,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,r,i).next((h=>{h.forEach(((f,m)=>{a=a.insert(f,m)}))}))})).next((()=>a))))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i)))).next((a=>{s.forEach(((l,c)=>{const h=c.getKey();a.get(h)===null&&(a=a.insert(h,Vr.newInvalidDocument(h)))}));let o=Am();return a.forEach(((l,c)=>{const h=s.get(l);h!==void 0&&Zm(h.mutation,c,Gs.empty(),qn.now()),By(t,c)&&(o=o.insert(l,c))})),o}))}}class Cte{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return de.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:bs(i.createTime)}})(t)),de.resolve()}getNamedQuery(e,t){return de.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(i){return{name:i.name,query:N8(i.bundledQuery),readTime:bs(i.readTime)}})(t)),de.resolve()}}class kte{constructor(){this.overlays=new Er(ft.comparator),this.qr=new Map}getOverlay(e,t){return de.resolve(this.overlays.get(t))}getOverlays(e,t){const r=el();return de.forEach(t,(i=>this.getOverlay(e,i).next((s=>{s!==null&&r.set(i,s)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((i,s)=>{this.St(e,t,s)})),de.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach((s=>this.overlays=this.overlays.remove(s))),this.qr.delete(r)),de.resolve()}getOverlaysForCollection(e,t,r){const i=el(),s=t.length+1,a=new ft(t.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,c=l.getKey();if(!t.isPrefixOf(c.path))break;c.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return de.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new Er(((c,h)=>c-h));const a=this.overlays.getIterator();for(;a.hasNext();){const c=a.getNext().value;if(c.getKey().getCollectionGroup()===t&&c.largestBatchId>r){let h=s.get(c.largestBatchId);h===null&&(h=el(),s=s.insert(c.largestBatchId,h)),h.set(c.getKey(),c)}}const o=el(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach(((c,h)=>o.set(c,h))),!(o.size()>=i)););return de.resolve(o)}St(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const a=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new kI(t,r));let s=this.qr.get(t);s===void 0&&(s=un(),this.qr.set(t,s)),this.qr.set(t,s.add(r.key))}}class Pte{constructor(){this.sessionToken=ii.EMPTY_BYTE_STRING}getSessionToken(e){return de.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,de.resolve()}}class OI{constructor(){this.Qr=new Qn(Ti.$r),this.Ur=new Qn(Ti.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new Ti(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Gr(new Ti(e,t))}zr(e,t){e.forEach((r=>this.removeReference(r,t)))}jr(e){const t=new ft(new jn([])),r=new Ti(t,e),i=new Ti(t,e+1),s=[];return this.Ur.forEachInRange([r,i],(a=>{this.Gr(a),s.push(a.key)})),s}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new ft(new jn([])),r=new Ti(t,e),i=new Ti(t,e+1);let s=un();return this.Ur.forEachInRange([r,i],(a=>{s=s.add(a.key)})),s}containsKey(e){const t=new Ti(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class Ti{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return ft.comparator(e.key,t.key)||en(e.Yr,t.Yr)}static Kr(e,t){return en(e.Yr,t.Yr)||ft.comparator(e.key,t.key)}}class Mte{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Qn(Ti.$r)}checkEmpty(e){return de.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new II(s,t,r,i);this.mutationQueue.push(a);for(const o of i)this.Zr=this.Zr.add(new Ti(o.key,s)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return de.resolve(a)}lookupMutationBatch(e,t){return de.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.ei(r),s=i<0?0:i;return de.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return de.resolve(this.mutationQueue.length===0?Yh:this.tr-1)}getAllMutationBatches(e){return de.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Ti(t,0),i=new Ti(t,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([r,i],(a=>{const o=this.Xr(a.Yr);s.push(o)})),de.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Qn(en);return t.forEach((i=>{const s=new Ti(i,0),a=new Ti(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,a],(o=>{r=r.add(o.Yr)}))})),de.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let s=r;ft.isDocumentKey(s)||(s=s.child(""));const a=new Ti(new ft(s),0);let o=new Qn(en);return this.Zr.forEachWhile((l=>{const c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===i&&(o=o.add(l.Yr)),!0)}),a),de.resolve(this.ti(o))}ti(e){const t=[];return e.forEach((r=>{const i=this.Xr(r);i!==null&&t.push(i)})),t}removeMutationBatch(e,t){Ot(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return de.forEach(t.mutations,(i=>{const s=new Ti(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,t){const r=new Ti(t,0),i=this.Zr.firstAfterOrEqual(r);return de.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,de.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Nte{constructor(e){this.ri=e,this.docs=(function(){return new Er(ft.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),s=i?i.size:0,a=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return de.resolve(r?r.document.mutableCopy():Vr.newInvalidDocument(t))}getEntries(e,t){let r=da();return t.forEach((i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Vr.newInvalidDocument(i))})),de.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=da();const a=t.path,o=new ft(a.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:c,value:{document:h}}=l.getNext();if(!a.isPrefixOf(c.path))break;c.path.length>a.length+1||yI(b6(h),r)<=0||(i.has(h.key)||By(t,h))&&(s=s.insert(h.key,h.mutableCopy()))}return de.resolve(s)}getAllFromCollectionGroup(e,t,r,i){Ct(9500)}ii(e,t){return de.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new Lte(this)}getSize(e){return de.resolve(this.size)}}class Lte extends z8{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,i)=>{i.isValidDocument()?t.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)})),de.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class Ote{constructor(e){this.persistence=e,this.si=new pc((t=>md(t)),Vy),this.lastRemoteSnapshotVersion=Vt.min(),this.highestTargetId=0,this.oi=0,this._i=new OI,this.targetCount=0,this.ai=xd.ur()}forEachTarget(e,t){return this.si.forEach(((r,i)=>t(i))),de.resolve()}getLastRemoteSnapshotVersion(e){return de.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return de.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),de.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),de.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new xd(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,de.resolve()}updateTargetData(e,t){return this.Pr(t),de.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,de.resolve()}removeTargets(e,t,r){let i=0;const s=[];return this.si.forEach(((a,o)=>{o.sequenceNumber<=t&&r.get(o.targetId)===null&&(this.si.delete(a),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)})),de.waitFor(s).next((()=>i))}getTargetCount(e){return de.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return de.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),de.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach((a=>{s.push(i.markPotentiallyOrphaned(e,a))})),de.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),de.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return de.resolve(r)}containsKey(e,t){return de.resolve(this._i.containsKey(t))}}class DI{constructor(e,t){this.ui={},this.overlays={},this.ci=new ja(0),this.li=!1,this.li=!0,this.hi=new Pte,this.referenceDelegate=e(this),this.Pi=new Ote(this),this.indexManager=new _te,this.remoteDocumentCache=(function(i){return new Nte(i)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new P8(t),this.Ii=new Cte(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new kte,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new Mte(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){et("MemoryPersistence","Starting transaction:",e);const i=new Dte(this.ci.next());return this.referenceDelegate.Ei(),r(i).next((s=>this.referenceDelegate.di(i).next((()=>s)))).toPromise().then((s=>(i.raiseOnCommittedEvent(),s)))}Ai(e,t){return de.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,t))))}}class Dte extends A6{constructor(e){super(),this.currentSequenceNumber=e}}class fE{constructor(e){this.persistence=e,this.Ri=new OI,this.Vi=null}static mi(e){return new fE(e)}get fi(){if(this.Vi)return this.Vi;throw Ct(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),de.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),de.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),de.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((i=>this.fi.add(i.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((i=>{i.forEach((s=>this.fi.add(s.toString())))})).next((()=>r.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return de.forEach(this.fi,(r=>{const i=ft.fromPath(r);return this.gi(e,i).next((s=>{s||t.removeEntry(i,Vt.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return de.or([()=>de.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Tv{constructor(e,t){this.persistence=e,this.pi=new pc((r=>us(r.path)),((r,i)=>r.isEqual(i))),this.garbageCollector=B8(this,t)}static mi(e,t){return new Tv(e,t)}Ei(){}di(e){return de.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}pr(e,t){return de.forEach(this.pi,((r,i)=>this.br(e,r,i).next((s=>s?de.resolve():t(i)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ii(e,(a=>this.br(e,a,t).next((o=>{o||(r++,s.removeEntry(a,Vt.min()))})))).next((()=>s.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),de.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),de.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),de.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),de.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=m_(e.data.value)),t}br(e,t,r){return de.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.pi.get(t);return de.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Fte{constructor(e){this.serializer=e}k(e,t,r,i){const s=new Jw("createOrUpgrade",t);r<1&&i>=1&&((function(l){l.createObjectStore(jy)})(e),(function(l){l.createObjectStore(Bp,{keyPath:XQ}),l.createObjectStore(co,{keyPath:uL,autoIncrement:!0}).createIndex(Uh,hL,{unique:!0}),l.createObjectStore(G0)})(e),e3(e),(function(l){l.createObjectStore(Ih)})(e));let a=de.resolve();return r<3&&i>=3&&(r!==0&&((function(l){l.deleteObjectStore(z0),l.deleteObjectStore(B0),l.deleteObjectStore(Zh)})(e),e3(e)),a=a.next((()=>(function(l){const c=l.store(Zh),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Vt.min().toTimestamp(),targetCount:0};return c.put(fv,h)})(s)))),r<4&&i>=4&&(r!==0&&(a=a.next((()=>(function(l,c){return c.store(co).J().next((f=>{l.deleteObjectStore(co),l.createObjectStore(co,{keyPath:uL,autoIncrement:!0}).createIndex(Uh,hL,{unique:!0});const m=c.store(co),y=f.map((x=>m.put(x)));return de.waitFor(y)}))})(e,s)))),a=a.next((()=>{(function(l){l.createObjectStore(U0,{keyPath:ree})})(e)}))),r<5&&i>=5&&(a=a.next((()=>this.yi(s)))),r<6&&i>=6&&(a=a.next((()=>((function(l){l.createObjectStore(zp)})(e),this.wi(s))))),r<7&&i>=7&&(a=a.next((()=>this.Si(s)))),r<8&&i>=8&&(a=a.next((()=>this.bi(e,s)))),r<9&&i>=9&&(a=a.next((()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)}))),r<10&&i>=10&&(a=a.next((()=>this.Di(s)))),r<11&&i>=11&&(a=a.next((()=>{(function(l){l.createObjectStore(eE,{keyPath:iee})})(e),(function(l){l.createObjectStore(tE,{keyPath:see})})(e)}))),r<12&&i>=12&&(a=a.next((()=>{(function(l){const c=l.createObjectStore(nE,{keyPath:dee});c.createIndex(Kb,fee,{unique:!1}),c.createIndex(L6,gee,{unique:!1})})(e)}))),r<13&&i>=13&&(a=a.next((()=>(function(l){const c=l.createObjectStore(dv,{keyPath:YQ});c.createIndex(f_,ZQ),c.createIndex(k6,JQ)})(e))).next((()=>this.Ci(e,s))).next((()=>e.deleteObjectStore(Ih)))),r<14&&i>=14&&(a=a.next((()=>this.Fi(e,s)))),r<15&&i>=15&&(a=a.next((()=>(function(l){l.createObjectStore(vI,{keyPath:aee,autoIncrement:!0}).createIndex(Hb,oee,{unique:!1}),l.createObjectStore(Hm,{keyPath:lee}).createIndex(M6,cee,{unique:!1}),l.createObjectStore(Km,{keyPath:uee}).createIndex(N6,hee,{unique:!1})})(e)))),r<16&&i>=16&&(a=a.next((()=>{t.objectStore(Hm).clear()})).next((()=>{t.objectStore(Km).clear()}))),r<17&&i>=17&&(a=a.next((()=>{(function(l){l.createObjectStore(wI,{keyPath:mee})})(e)}))),r<18&&i>=18&&Ij()&&(a=a.next((()=>{t.objectStore(Hm).clear()})).next((()=>{t.objectStore(Km).clear()}))),a}wi(e){let t=0;return e.store(Ih).ee(((r,i)=>{t+=Ev(i)})).next((()=>{const r={byteSize:t};return e.store(zp).put(Wb,r)}))}yi(e){const t=e.store(Bp),r=e.store(co);return t.J().next((i=>de.forEach(i,(s=>{const a=IDBKeyRange.bound([s.userId,Yh],[s.userId,s.lastAcknowledgedBatchId]);return r.J(Uh,a).next((o=>de.forEach(o,(l=>{Ot(l.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:l.batchId});const c=Lh(this.serializer,l);return F8(e,s.userId,c).next((()=>{}))}))))}))))}Si(e){const t=e.store(z0),r=e.store(Ih);return e.store(Zh).get(fv).next((i=>{const s=[];return r.ee(((a,o)=>{const l=new jn(a),c=(function(f){return[0,us(f)]})(l);s.push(t.get(c).next((h=>h?de.resolve():(f=>t.put({targetId:0,path:us(f),sequenceNumber:i.highestListenSequenceNumber}))(l))))})).next((()=>de.waitFor(s)))}))}bi(e,t){e.createObjectStore(Up,{keyPath:nee});const r=t.store(Up),i=new LI,s=a=>{if(i.add(a)){const o=a.lastSegment(),l=a.popLast();return r.put({collectionId:o,parent:us(l)})}};return t.store(Ih).ee({X:!0},((a,o)=>{const l=new jn(a);return s(l.popLast())})).next((()=>t.store(G0).ee({X:!0},(([a,o,l],c)=>{const h=Qo(o);return s(h.popLast())}))))}Di(e){const t=e.store(B0);return t.ee(((r,i)=>{const s=Cm(i),a=M8(this.serializer,s);return t.put(a)}))}Ci(e,t){const r=t.store(Ih),i=[];return r.ee(((s,a)=>{const o=t.store(dv),l=(function(f){return f.document?new ft(jn.fromString(f.document.name).popFirst(5)):f.noDocument?ft.fromSegments(f.noDocument.path):f.unknownDocument?ft.fromSegments(f.unknownDocument.path):Ct(36783)})(a).path.toArray(),c={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:a.readTime||[0,0],unknownDocument:a.unknownDocument,noDocument:a.noDocument,document:a.document,hasCommittedMutations:!!a.hasCommittedMutations};i.push(o.put(c))})).next((()=>de.waitFor(i)))}Fi(e,t){const r=t.store(co),i=U8(this.serializer),s=new DI(fE.mi,this.serializer.yt);return r.J().next((a=>{const o=new Map;return a.forEach((l=>{let c=o.get(l.userId)??un();Lh(this.serializer,l).keys().forEach((h=>c=c.add(h))),o.set(l.userId,c)})),de.forEach(o,((l,c)=>{const h=new Ui(c),f=hE.wt(this.serializer,h),m=s.getIndexManager(h),y=dE.wt(h,this.serializer,m,s.referenceDelegate);return new $8(i,y,f,m).recalculateAndSaveOverlaysForDocumentKeys(new Xb(t,ja.ce),l).next()}))}))}}function e3(n){n.createObjectStore(z0,{keyPath:eee}).createIndex(_I,tee,{unique:!0}),n.createObjectStore(B0,{keyPath:"targetId"}).createIndex(P6,QQ,{unique:!0}),n.createObjectStore(Zh)}const Zc="IndexedDbPersistence",dS=18e5,fS=5e3,gS="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",jte="main";class FI{constructor(e,t,r,i,s,a,o,l,c,h,f=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Mi=s,this.window=a,this.document=o,this.xi=c,this.Oi=h,this.Ni=f,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=m=>Promise.resolve(),!FI.v())throw new ht(Oe.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new bte(this,i),this.$i=t+jte,this.serializer=new P8(l),this.Ui=new Ru(this.$i,this.Ni,new Fte(this.serializer)),this.hi=new fte,this.Pi=new wte(this.referenceDelegate,this.serializer),this.remoteDocumentCache=U8(this.serializer),this.Ii=new dte,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,h===!1&&Ts(Zc,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ht(Oe.FAILED_PRECONDITION,gS);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new ja(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Lx(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(Hu(e))return et(Zc,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return et(Zc,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return xm(e).get(Pf).next((t=>de.resolve(this.es(t))))}ts(e){return Lx(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,dS)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const r=yi(t,U0);return r.J().next((i=>{const s=this.ss(i,dS),a=i.filter((o=>s.indexOf(o)===-1));return de.forEach(a,(o=>r.delete(o.clientId))).next((()=>a))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?de.resolve(!0):xm(e).get(Pf).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,fS)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new ht(Oe.FAILED_PRECONDITION,gS);return!1}}return!(!this.networkEnabled||!this.inForeground)||Lx(e).J().next((r=>this.ss(r,fS).find((i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,a=!this.inForeground&&i.inForeground,o=this.networkEnabled===i.networkEnabled;if(s||a&&o)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&et(Zc,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[jy,U0],(e=>{const t=new Xb(e,ja.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((r=>this.rs(r.updateTimeMs,t)&&!this.us(r.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>Lx(e).J().next((t=>this.ss(t,dS).map((r=>r.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return dE.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new vte(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return hE.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,r){et(Zc,"Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",s=(function(l){return l===18?xee:l===17?j6:l===16?yee:l===15?EI:l===14?F6:l===13?D6:l===12?pee:l===11?O6:void Ct(60245)})(this.Ni);let a;return this.Ui.runTransaction(e,i,s,(o=>(a=new Xb(o,this.ci?this.ci.next():ja.ce),t==="readwrite-primary"?this.Hi(a).next((l=>!!l||this.Yi(a))).next((l=>{if(!l)throw Ts(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new ht(Oe.FAILED_PRECONDITION,R6);return r(a)})).next((l=>this.Xi(a).next((()=>l)))):this.Is(a).next((()=>r(a)))))).then((o=>(a.raiseOnCommittedEvent(),o)))}Is(e){return xm(e).get(Pf).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,fS)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new ht(Oe.FAILED_PRECONDITION,gS)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return xm(e).put(Pf,t)}static v(){return Ru.v()}Zi(e){const t=xm(e);return t.get(Pf).next((r=>this.es(r)?(et(Zc,"Releasing primary lease."),t.delete(Pf)):de.resolve()))}rs(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(Ts(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;Aj()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const t=this.Ki?.getItem(this._s(e))!==null;return et(Zc,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return Ts(Zc,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){Ts("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function xm(n){return yi(n,jy)}function Lx(n){return yi(n,U0)}function Vte(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class jI{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=i}static As(e,t){let r=un(),i=un();for(const s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new jI(e,t.fromCache,r,i)}}class Gte{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class W8{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return Aj()?8:I6(mi())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,i){const s={result:null};return this.ys(e,t).next((a=>{s.result=a})).next((()=>{if(!s.result)return this.ws(e,t,i,r).next((a=>{s.result=a}))})).next((()=>{if(s.result)return;const a=new Gte;return this.Ss(e,t,a).next((o=>{if(s.result=o,this.Vs)return this.bs(e,t,a,o.size)}))})).next((()=>s.result))}bs(e,t,r,i){return r.documentReadCount<this.fs?(Xf()<=yn.DEBUG&&et("QueryEngine","SDK will not create cache indexes for query:",qf(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),de.resolve()):(Xf()<=yn.DEBUG&&et("QueryEngine","Query:",qf(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(Xf()<=yn.DEBUG&&et("QueryEngine","The SDK decides to create cache indexes for query:",qf(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ba(t))):de.resolve())}ys(e,t){if(SL(t))return de.resolve(null);let r=Ba(t);return this.indexManager.getIndexType(e,r).next((i=>i===0?null:(t.limit!==null&&i===1&&(t=tR(t,null,"F"),r=Ba(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((s=>{const a=un(...s);return this.ps.getDocuments(e,a).next((o=>this.indexManager.getMinOffset(e,r).next((l=>{const c=this.Ds(t,o);return this.Cs(t,c,a,l.readTime)?this.ys(e,tR(t,null,"F")):this.vs(e,c,t,l)}))))})))))}ws(e,t,r,i){return SL(t)||i.isEqual(Vt.min())?de.resolve(null):this.ps.getDocuments(e,r).next((s=>{const a=this.Ds(t,s);return this.Cs(t,a,r,i)?de.resolve(null):(Xf()<=yn.DEBUG&&et("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),qf(t)),this.vs(e,a,t,BQ(i,jp)).next((o=>o)))}))}Ds(e,t){let r=new Qn(i8(e));return t.forEach(((i,s)=>{By(e,s)&&(r=r.add(s))})),r}Cs(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,t,r){return Xf()<=yn.DEBUG&&et("QueryEngine","Using full collection scan to execute query:",qf(t)),this.ps.getDocumentsMatchingQuery(e,t,ma.min(),r)}vs(e,t,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next((s=>(t.forEach((a=>{s=s.insert(a.key,a)})),s)))}}const VI="LocalStore",Bte=3e8;class zte{constructor(e,t,r,i){this.persistence=e,this.Fs=t,this.serializer=i,this.Ms=new Er(en),this.xs=new pc((s=>md(s)),Vy),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new $8(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function H8(n,e,t,r){return new zte(n,e,t,r)}async function K8(n,e){const t=tn(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next((s=>(i=s,t.Bs(e),t.mutationQueue.getAllMutationBatches(r)))).next((s=>{const a=[],o=[];let l=un();for(const c of i){a.push(c.batchId);for(const h of c.mutations)l=l.add(h.key)}for(const c of s){o.push(c.batchId);for(const h of c.mutations)l=l.add(h.key)}return t.localDocuments.getDocuments(r,l).next((c=>({Ls:c,removedBatchIds:a,addedBatchIds:o})))}))}))}function Ute(n,e){const t=tn(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const i=e.batch.keys(),s=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(o,l,c,h){const f=c.batch,m=f.keys();let y=de.resolve();return m.forEach((x=>{y=y.next((()=>h.getEntry(l,x))).next((_=>{const w=c.docVersions.get(x);Ot(w!==null,48541),_.version.compareTo(w)<0&&(f.applyToRemoteDocument(_,c),_.isValidDocument()&&(_.setReadTime(c.commitVersion),h.addEntry(_)))}))})),y.next((()=>o.mutationQueue.removeMutationBatch(l,f)))})(t,r,e,s).next((()=>s.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(o){let l=un();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(l=l.add(o.batch.mutations[c].key));return l})(e)))).next((()=>t.localDocuments.getDocuments(r,i)))}))}function X8(n){const e=tn(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function $te(n,e){const t=tn(n),r=e.snapshotVersion;let i=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(s=>{const a=t.Ns.newChangeBuffer({trackRemovals:!0});i=t.Ms;const o=[];e.targetChanges.forEach(((h,f)=>{const m=i.get(f);if(!m)return;o.push(t.Pi.removeMatchingKeys(s,h.removedDocuments,f).next((()=>t.Pi.addMatchingKeys(s,h.addedDocuments,f))));let y=m.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(f)!==null?y=y.withResumeToken(ii.EMPTY_BYTE_STRING,Vt.min()).withLastLimboFreeSnapshotVersion(Vt.min()):h.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(h.resumeToken,r)),i=i.insert(f,y),(function(_,w,S){return _.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-_.snapshotVersion.toMicroseconds()>=Bte?!0:S.addedDocuments.size+S.modifiedDocuments.size+S.removedDocuments.size>0})(m,y,h)&&o.push(t.Pi.updateTargetData(s,y))}));let l=da(),c=un();if(e.documentUpdates.forEach((h=>{e.resolvedLimboDocuments.has(h)&&o.push(t.persistence.referenceDelegate.updateLimboDocument(s,h))})),o.push(Wte(s,a,e.documentUpdates).next((h=>{l=h.ks,c=h.qs}))),!r.isEqual(Vt.min())){const h=t.Pi.getLastRemoteSnapshotVersion(s).next((f=>t.Pi.setTargetsMetadata(s,s.currentSequenceNumber,r)));o.push(h)}return de.waitFor(o).next((()=>a.apply(s))).next((()=>t.localDocuments.getLocalViewOfDocuments(s,l,c))).next((()=>l))})).then((s=>(t.Ms=i,s)))}function Wte(n,e,t){let r=un(),i=un();return t.forEach((s=>r=r.add(s))),e.getEntries(n,r).next((s=>{let a=da();return t.forEach(((o,l)=>{const c=s.get(o);l.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(o)),l.isNoDocument()&&l.version.isEqual(Vt.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):et(VI,"Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",l.version)})),{ks:a,qs:i}}))}function Hte(n,e){const t=tn(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=Yh),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function Kte(n,e){const t=tn(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let i;return t.Pi.getTargetData(r,e).next((s=>s?(i=s,de.resolve(i)):t.Pi.allocateTargetId(r).next((a=>(i=new Wl(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,i).next((()=>i)))))))})).then((r=>{const i=t.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r}))}async function cR(n,e,t){const r=tn(n),i=r.Ms.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,(a=>r.persistence.referenceDelegate.removeTarget(a,i)))}catch(a){if(!Hu(a))throw a;et(VI,`Failed to update sequence numbers for target ${e}: ${a}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function t3(n,e,t){const r=tn(n);let i=Vt.min(),s=un();return r.persistence.runTransaction("Execute query","readwrite",(a=>(function(l,c,h){const f=tn(l),m=f.xs.get(h);return m!==void 0?de.resolve(f.Ms.get(m)):f.Pi.getTargetData(c,h)})(r,a,Ba(e)).next((o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(a,o.targetId).next((l=>{s=l}))})).next((()=>r.Fs.getDocumentsMatchingQuery(a,e,t?i:Vt.min(),t?s:un()))).next((o=>(Xte(r,Nee(e),o),{documents:o,Qs:s})))))}function Xte(n,e,t){let r=n.Os.get(e)||Vt.min();t.forEach(((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)})),n.Os.set(e,r)}class n3{constructor(){this.activeTargetIds=Vee()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class q8{constructor(){this.Mo=new n3,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new n3,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class qte{Oo(e){}shutdown(){}}const r3="ConnectivityMonitor";class i3{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){et(r3,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){et(r3,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Ox=null;function uR(){return Ox===null?Ox=(function(){return 268435456+Math.round(2147483648*Math.random())})():Ox++,"0x"+Ox.toString(16)}const mS="RestConnection",Yte={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Zte{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===gv?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,t,r,i,s){const a=uR(),o=this.zo(e,t.toUriEncodedString());et(mS,`Sending RPC '${e}' ${a}:`,o,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,i,s);const{host:c}=new URL(o),h=Md(c);return this.Jo(e,o,l,r,h).then((f=>(et(mS,`Received RPC '${e}' ${a}: `,f),f)),(f=>{throw fd(mS,`RPC '${e}' ${a} failed with error: `,f,"url: ",o,"request:",r),f}))}Ho(e,t,r,i,s,a){return this.Go(e,t,r,i,s)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+dg})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((i,s)=>e[s]=i)),r&&r.headers.forEach(((i,s)=>e[s]=i))}zo(e,t){const r=Yte[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}class Jte{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const ts="WebChannelConnection";class Qte extends Zte{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,i,s){const a=uR();return new Promise(((o,l)=>{const c=new m6;c.setWithCredentials(!0),c.listenOnce(p6.COMPLETE,(()=>{try{switch(c.getLastErrorCode()){case u_.NO_ERROR:const f=c.getResponseJson();et(ts,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(f)),o(f);break;case u_.TIMEOUT:et(ts,`RPC '${e}' ${a} timed out`),l(new ht(Oe.DEADLINE_EXCEEDED,"Request time out"));break;case u_.HTTP_ERROR:const m=c.getStatus();if(et(ts,`RPC '${e}' ${a} failed with status:`,m,"response text:",c.getResponseText()),m>0){let y=c.getResponseJson();Array.isArray(y)&&(y=y[0]);const x=y?.error;if(x&&x.status&&x.message){const _=(function(S){const b=S.toLowerCase().replace(/_/g,"-");return Object.values(Oe).indexOf(b)>=0?b:Oe.UNKNOWN})(x.status);l(new ht(_,x.message))}else l(new ht(Oe.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new ht(Oe.UNAVAILABLE,"Connection failed."));break;default:Ct(9055,{l_:e,streamId:a,h_:c.getLastErrorCode(),P_:c.getLastError()})}}finally{et(ts,`RPC '${e}' ${a} completed.`)}}));const h=JSON.stringify(i);et(ts,`RPC '${e}' ${a} sending request:`,i),c.send(t,"POST",h,r,15)}))}T_(e,t,r){const i=uR(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=_6(),o=x6(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;const h=s.join("");et(ts,`Creating RPC '${e}' stream ${i}: ${h}`,l);const f=a.createWebChannel(h,l);this.I_(f);let m=!1,y=!1;const x=new Jte({Yo:w=>{y?et(ts,`Not sending because RPC '${e}' stream ${i} is closed:`,w):(m||(et(ts,`Opening RPC '${e}' stream ${i} transport.`),f.open(),m=!0),et(ts,`RPC '${e}' stream ${i} sending:`,w),f.send(w))},Zo:()=>f.close()}),_=(w,S,b)=>{w.listen(S,(R=>{try{b(R)}catch(M){setTimeout((()=>{throw M}),0)}}))};return _(f,Rm.EventType.OPEN,(()=>{y||(et(ts,`RPC '${e}' stream ${i} transport opened.`),x.o_())})),_(f,Rm.EventType.CLOSE,(()=>{y||(y=!0,et(ts,`RPC '${e}' stream ${i} transport closed`),x.a_(),this.E_(f))})),_(f,Rm.EventType.ERROR,(w=>{y||(y=!0,fd(ts,`RPC '${e}' stream ${i} transport errored. Name:`,w.name,"Message:",w.message),x.a_(new ht(Oe.UNAVAILABLE,"The operation could not be completed")))})),_(f,Rm.EventType.MESSAGE,(w=>{if(!y){const S=w.data[0];Ot(!!S,16349);const b=S,R=b?.error||b[0]?.error;if(R){et(ts,`RPC '${e}' stream ${i} received error:`,R);const M=R.status;let O=(function(I){const P=Zr[I];if(P!==void 0)return y8(P)})(M),G=R.message;O===void 0&&(O=Oe.INTERNAL,G="Unknown error status: "+M+" with message "+R.message),y=!0,x.a_(new ht(O,G)),f.close()}else et(ts,`RPC '${e}' stream ${i} received:`,S),x.u_(S)}})),_(o,y6.STAT_EVENT,(w=>{w.stat===zb.PROXY?et(ts,`RPC '${e}' stream ${i} detected buffering proxy`):w.stat===zb.NOPROXY&&et(ts,`RPC '${e}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{x.__()}),0),x}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function ene(){return typeof window<"u"?window:null}function v_(){return typeof document<"u"?document:null}function gE(n){return new tte(n,!0)}class Y8{constructor(e,t,r=1e3,i=1.5,s=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=i,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-r);i>0&&et("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const s3="PersistentStream";class Z8{constructor(e,t,r,i,s,a,o,l){this.Mi=e,this.S_=r,this.b_=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Y8(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===Oe.RESOURCE_EXHAUSTED?(Ts(t.toString()),Ts("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===Oe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,i])=>{this.D_===t&&this.G_(r,i)}),(r=>{e((()=>{const i=new ht(Oe.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)}))}))}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((i=>{r((()=>this.z_(i)))})),this.stream.onMessage((i=>{r((()=>++this.F_==1?this.J_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return et(s3,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(et(s3,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class tne extends Z8{constructor(e,t,r,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=ite(this.serializer,e),r=(function(s){if(!("targetChange"in s))return Vt.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?Vt.min():a.readTime?bs(a.readTime):Vt.min()})(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=iR(this.serializer),t.addTarget=(function(s,a){let o;const l=a.target;if(o=pv(l)?{documents:b8(s,l)}:{query:R8(s,l).ft},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=v8(s,a.resumeToken);const c=nR(s,a.expectedCount);c!==null&&(o.expectedCount=c)}else if(a.snapshotVersion.compareTo(Vt.min())>0){o.readTime=Z0(s,a.snapshotVersion.toTimestamp());const c=nR(s,a.expectedCount);c!==null&&(o.expectedCount=c)}return o})(this.serializer,e);const r=ate(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=iR(this.serializer),t.removeTarget=e,this.q_(t)}}class nne extends Z8{constructor(e,t,r,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Ot(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ot(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ot(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=ste(e.writeResults,e.commitTime),r=bs(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=iR(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>_v(this.serializer,r)))};this.q_(t)}}class rne{}class ine extends rne{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new ht(Oe.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,a])=>this.connection.Go(e,rR(t,r),i,s,a))).catch((s=>{throw s.name==="FirebaseError"?(s.code===Oe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new ht(Oe.UNKNOWN,s.toString())}))}Ho(e,t,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,o])=>this.connection.Ho(e,rR(t,r),i,a,o,s))).catch((a=>{throw a.name==="FirebaseError"?(a.code===Oe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new ht(Oe.UNKNOWN,a.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class sne{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ts(t),this.aa=!1):et("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const _d="RemoteStore";class ane{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo((a=>{r.enqueueAndForget((async()=>{Od(this)&&(et(_d,"Restarting streams for network reachability change."),await(async function(l){const c=tn(l);c.Ea.add(4),await Uy(c),c.Ra.set("Unknown"),c.Ea.delete(4),await mE(c)})(this))}))})),this.Ra=new sne(r,i)}}async function mE(n){if(Od(n))for(const e of n.da)await e(!0)}async function Uy(n){for(const e of n.da)await e(!1)}function J8(n,e){const t=tn(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),UI(t)?zI(t):gg(t).O_()&&BI(t,e))}function GI(n,e){const t=tn(n),r=gg(t);t.Ia.delete(e),r.O_()&&Q8(t,e),t.Ia.size===0&&(r.O_()?r.L_():Od(t)&&t.Ra.set("Unknown"))}function BI(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Vt.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}gg(n).Y_(e)}function Q8(n,e){n.Va.Ue(e),gg(n).Z_(e)}function zI(n){n.Va=new Zee({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),gg(n).start(),n.Ra.ua()}function UI(n){return Od(n)&&!gg(n).x_()&&n.Ia.size>0}function Od(n){return tn(n).Ea.size===0}function e9(n){n.Va=void 0}async function one(n){n.Ra.set("Online")}async function lne(n){n.Ia.forEach(((e,t)=>{BI(n,e)}))}async function cne(n,e){e9(n),UI(n)?(n.Ra.ha(e),zI(n)):n.Ra.set("Unknown")}async function une(n,e,t){if(n.Ra.set("Online"),e instanceof _8&&e.state===2&&e.cause)try{await(async function(i,s){const a=s.cause;for(const o of s.targetIds)i.Ia.has(o)&&(await i.remoteSyncer.rejectListen(o,a),i.Ia.delete(o),i.Va.removeTarget(o))})(n,e)}catch(r){et(_d,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Sv(n,r)}else if(e instanceof x_?n.Va.Ze(e):e instanceof x8?n.Va.st(e):n.Va.tt(e),!t.isEqual(Vt.min()))try{const r=await X8(n.localStore);t.compareTo(r)>=0&&await(function(s,a){const o=s.Va.Tt(a);return o.targetChanges.forEach(((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const h=s.Ia.get(c);h&&s.Ia.set(c,h.withResumeToken(l.resumeToken,a))}})),o.targetMismatches.forEach(((l,c)=>{const h=s.Ia.get(l);if(!h)return;s.Ia.set(l,h.withResumeToken(ii.EMPTY_BYTE_STRING,h.snapshotVersion)),Q8(s,l);const f=new Wl(h.target,l,c,h.sequenceNumber);BI(s,f)})),s.remoteSyncer.applyRemoteEvent(o)})(n,t)}catch(r){et(_d,"Failed to raise snapshot:",r),await Sv(n,r)}}async function Sv(n,e,t){if(!Hu(e))throw e;n.Ea.add(1),await Uy(n),n.Ra.set("Offline"),t||(t=()=>X8(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{et(_d,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await mE(n)}))}function t9(n,e){return e().catch((t=>Sv(n,t,e)))}async function $y(n){const e=tn(n),t=Ou(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Yh;for(;hne(e);)try{const i=await Hte(e.localStore,r);if(i===null){e.Ta.length===0&&t.L_();break}r=i.batchId,dne(e,i)}catch(i){await Sv(e,i)}n9(e)&&r9(e)}function hne(n){return Od(n)&&n.Ta.length<10}function dne(n,e){n.Ta.push(e);const t=Ou(n);t.O_()&&t.X_&&t.ea(e.mutations)}function n9(n){return Od(n)&&!Ou(n).x_()&&n.Ta.length>0}function r9(n){Ou(n).start()}async function fne(n){Ou(n).ra()}async function gne(n){const e=Ou(n);for(const t of n.Ta)e.ea(t.mutations)}async function mne(n,e,t){const r=n.Ta.shift(),i=CI.from(r,e,t);await t9(n,(()=>n.remoteSyncer.applySuccessfulWrite(i))),await $y(n)}async function pne(n,e){e&&Ou(n).X_&&await(async function(r,i){if((function(a){return Xee(a)&&a!==Oe.ABORTED})(i.code)){const s=r.Ta.shift();Ou(r).B_(),await t9(r,(()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i))),await $y(r)}})(n,e),n9(n)&&r9(n)}async function a3(n,e){const t=tn(n);t.asyncQueue.verifyOperationInProgress(),et(_d,"RemoteStore received new credentials");const r=Od(t);t.Ea.add(3),await Uy(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await mE(t)}async function yne(n,e){const t=tn(n);e?(t.Ea.delete(2),await mE(t)):e||(t.Ea.add(2),await Uy(t),t.Ra.set("Unknown"))}function gg(n){return n.ma||(n.ma=(function(t,r,i){const s=tn(t);return s.sa(),new tne(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Xo:one.bind(null,n),t_:lne.bind(null,n),r_:cne.bind(null,n),H_:une.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),UI(n)?zI(n):n.Ra.set("Unknown")):(await n.ma.stop(),e9(n))}))),n.ma}function Ou(n){return n.fa||(n.fa=(function(t,r,i){const s=tn(t);return s.sa(),new nne(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:fne.bind(null,n),r_:pne.bind(null,n),ta:gne.bind(null,n),na:mne.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await $y(n)):(await n.fa.stop(),n.Ta.length>0&&(et(_d,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class $I{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new il,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((a=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){const a=Date.now()+r,o=new $I(e,t,a,i,s);return o.start(r),o}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ht(Oe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function WI(n,e){if(Ts("AsyncQueue",`${e}: ${n}`),Hu(n))return new ht(Oe.UNAVAILABLE,`${e}: ${n}`);throw n}class v0{static emptySet(e){return new v0(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||ft.comparator(t.key,r.key):(t,r)=>ft.comparator(t.key,r.key),this.keyedMap=Am(),this.sortedSet=new Er(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof v0)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new v0;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class o3{constructor(){this.ga=new Er(ft.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Ct(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class J0{constructor(e,t,r,i,s,a,o,l,c){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,t,r,i,s){const a=[];return t.forEach((o=>{a.push({type:0,doc:o})})),new J0(e,t,v0.emptySet(t),a,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&aE(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}class xne{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class _ne{constructor(){this.queries=l3(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const i=tn(t),s=i.queries;i.queries=l3(),s.forEach(((a,o)=>{for(const l of o.Sa)l.onError(r)}))})(this,new ht(Oe.ABORTED,"Firestore shutting down"))}}function l3(){return new pc((n=>r8(n)),aE)}async function i9(n,e){const t=tn(n);let r=3;const i=e.query;let s=t.queries.get(i);s?!s.ba()&&e.Da()&&(r=2):(s=new xne,r=e.Da()?0:1);try{switch(r){case 0:s.wa=await t.onListen(i,!0);break;case 1:s.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(a){const o=WI(a,`Initialization of query '${qf(e.query)}' failed`);return void e.onError(o)}t.queries.set(i,s),s.Sa.push(e),e.va(t.onlineState),s.wa&&e.Fa(s.wa)&&HI(t)}async function s9(n,e){const t=tn(n),r=e.query;let i=3;const s=t.queries.get(r);if(s){const a=s.Sa.indexOf(e);a>=0&&(s.Sa.splice(a,1),s.Sa.length===0?i=e.Da()?0:1:!s.ba()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function vne(n,e){const t=tn(n);let r=!1;for(const i of e){const s=i.query,a=t.queries.get(s);if(a){for(const o of a.Sa)o.Fa(i)&&(r=!0);a.wa=i}}r&&HI(t)}function wne(n,e,t){const r=tn(n),i=r.queries.get(e);if(i)for(const s of i.Sa)s.onError(t);r.queries.delete(e)}function HI(n){n.Ca.forEach((e=>{e.next()}))}var hR,c3;(c3=hR||(hR={})).Ma="default",c3.Cache="cache";class a9{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new J0(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=J0.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==hR.Cache}}class o9{constructor(e){this.key=e}}class l9{constructor(e){this.key=e}}class Ene{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=un(),this.mutatedKeys=un(),this.eu=i8(e),this.tu=new v0(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new o3,i=t?t.tu:this.tu;let s=t?t.mutatedKeys:this.mutatedKeys,a=i,o=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((h,f)=>{const m=i.get(h),y=By(this.query,f)?f:null,x=!!m&&this.mutatedKeys.has(m.key),_=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let w=!1;m&&y?m.data.isEqual(y.data)?x!==_&&(r.track({type:3,doc:y}),w=!0):this.su(m,y)||(r.track({type:2,doc:y}),w=!0,(l&&this.eu(y,l)>0||c&&this.eu(y,c)<0)&&(o=!0)):!m&&y?(r.track({type:0,doc:y}),w=!0):m&&!y&&(r.track({type:1,doc:m}),w=!0,(l||c)&&(o=!0)),w&&(y?(a=a.add(y),s=_?s.add(h):s.delete(h)):(a=a.delete(h),s=s.delete(h)))})),this.query.limit!==null)for(;a.size>this.query.limit;){const h=this.query.limitType==="F"?a.last():a.first();a=a.delete(h.key),s=s.delete(h.key),r.track({type:1,doc:h})}return{tu:a,iu:r,Cs:o,mutatedKeys:s}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort(((h,f)=>(function(y,x){const _=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ct(20277,{Rt:w})}};return _(y)-_(x)})(h.type,f.type)||this.eu(h.doc,f.doc))),this.ou(r),i=i??!1;const o=t&&!i?this._u():[],l=this.Xa.size===0&&this.current&&!i?1:0,c=l!==this.Za;return this.Za=l,a.length!==0||c?{snapshot:new J0(this.query,e.tu,s,a,e.mutatedKeys,l===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:o}:{au:o}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new o3,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=un(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const t=[];return e.forEach((r=>{this.Xa.has(r)||t.push(new l9(r))})),this.Xa.forEach((r=>{e.has(r)||t.push(new o9(r))})),t}cu(e){this.Ya=e.Qs,this.Xa=un();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return J0.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const KI="SyncEngine";class Tne{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class Sne{constructor(e){this.key=e,this.hu=!1}}class bne{constructor(e,t,r,i,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new pc((o=>r8(o)),aE),this.Iu=new Map,this.Eu=new Set,this.du=new Er(ft.comparator),this.Au=new Map,this.Ru=new OI,this.Vu={},this.mu=new Map,this.fu=xd.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function Rne(n,e,t=!0){const r=g9(n);let i;const s=r.Tu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await c9(r,e,t,!0),i}async function Ane(n,e){const t=g9(n);await c9(t,e,!0,!1)}async function c9(n,e,t,r){const i=await Kte(n.localStore,Ba(e)),s=i.targetId,a=n.sharedClientState.addLocalQueryTarget(s,t);let o;return r&&(o=await Ine(n,e,s,a==="current",i.resumeToken)),n.isPrimaryClient&&t&&J8(n.remoteStore,i),o}async function Ine(n,e,t,r,i){n.pu=(f,m,y)=>(async function(_,w,S,b){let R=w.view.ru(S);R.Cs&&(R=await t3(_.localStore,w.query,!1).then((({documents:A})=>w.view.ru(A,R))));const M=b&&b.targetChanges.get(w.targetId),O=b&&b.targetMismatches.get(w.targetId)!=null,G=w.view.applyChanges(R,_.isPrimaryClient,M,O);return h3(_,w.targetId,G.au),G.snapshot})(n,f,m,y);const s=await t3(n.localStore,e,!0),a=new Ene(e,s.Qs),o=a.ru(s.documents),l=zy.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),c=a.applyChanges(o,n.isPrimaryClient,l);h3(n,t,c.au);const h=new Tne(e,t,a);return n.Tu.set(e,h),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),c.snapshot}async function Cne(n,e,t){const r=tn(n),i=r.Tu.get(e),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter((a=>!aE(a,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await cR(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),t&&GI(r.remoteStore,i.targetId),dR(r,i.targetId)})).catch(Ld)):(dR(r,i.targetId),await cR(r.localStore,i.targetId,!0))}async function kne(n,e){const t=tn(n),r=t.Tu.get(e),i=t.Iu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),GI(t.remoteStore,r.targetId))}async function Pne(n,e,t){const r=m9(n);try{const i=await(function(a,o){const l=tn(a),c=qn.now(),h=o.reduce(((y,x)=>y.add(x.key)),un());let f,m;return l.persistence.runTransaction("Locally write mutations","readwrite",(y=>{let x=da(),_=un();return l.Ns.getEntries(y,h).next((w=>{x=w,x.forEach(((S,b)=>{b.isValidDocument()||(_=_.add(S))}))})).next((()=>l.localDocuments.getOverlayedDocuments(y,x))).next((w=>{f=w;const S=[];for(const b of o){const R=Hee(b,f.get(b.key).overlayedDocument);R!=null&&S.push(new yc(b.key,R,X6(R.value.mapValue),ls.exists(!0)))}return l.mutationQueue.addMutationBatch(y,c,S,o)})).next((w=>{m=w;const S=w.applyToLocalDocumentSet(f,_);return l.documentOverlayCache.saveOverlays(y,w.batchId,S)}))})).then((()=>({batchId:m.batchId,changes:a8(f)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(a,o,l){let c=a.Vu[a.currentUser.toKey()];c||(c=new Er(en)),c=c.insert(o,l),a.Vu[a.currentUser.toKey()]=c})(r,i.batchId,t),await Wy(r,i.changes),await $y(r.remoteStore)}catch(i){const s=WI(i,"Failed to persist write");t.reject(s)}}async function u9(n,e){const t=tn(n);try{const r=await $te(t.localStore,e);e.targetChanges.forEach(((i,s)=>{const a=t.Au.get(s);a&&(Ot(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?a.hu=!0:i.modifiedDocuments.size>0?Ot(a.hu,14607):i.removedDocuments.size>0&&(Ot(a.hu,42227),a.hu=!1))})),await Wy(t,r,e)}catch(r){await Ld(r)}}function u3(n,e,t){const r=tn(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.Tu.forEach(((s,a)=>{const o=a.view.va(e);o.snapshot&&i.push(o.snapshot)})),(function(a,o){const l=tn(a);l.onlineState=o;let c=!1;l.queries.forEach(((h,f)=>{for(const m of f.Sa)m.va(o)&&(c=!0)})),c&&HI(l)})(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function Mne(n,e,t){const r=tn(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Au.get(e),s=i&&i.key;if(s){let a=new Er(ft.comparator);a=a.insert(s,Vr.newNoDocument(s,Vt.min()));const o=un().add(s),l=new uE(Vt.min(),new Map,new Er(en),a,o);await u9(r,l),r.du=r.du.remove(s),r.Au.delete(e),XI(r)}else await cR(r.localStore,e,!1).then((()=>dR(r,e,t))).catch(Ld)}async function Nne(n,e){const t=tn(n),r=e.batch.batchId;try{const i=await Ute(t.localStore,e);d9(t,r,null),h9(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Wy(t,i)}catch(i){await Ld(i)}}async function Lne(n,e,t){const r=tn(n);try{const i=await(function(a,o){const l=tn(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",(c=>{let h;return l.mutationQueue.lookupMutationBatch(c,o).next((f=>(Ot(f!==null,37113),h=f.keys(),l.mutationQueue.removeMutationBatch(c,f)))).next((()=>l.mutationQueue.performConsistencyCheck(c))).next((()=>l.documentOverlayCache.removeOverlaysForBatchId(c,h,o))).next((()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,h))).next((()=>l.localDocuments.getDocuments(c,h)))}))})(r.localStore,e);d9(r,e,t),h9(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Wy(r,i)}catch(i){await Ld(i)}}function h9(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function d9(n,e,t){const r=tn(n);let i=r.Vu[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function dR(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((r=>{n.Ru.containsKey(r)||f9(n,r)}))}function f9(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(GI(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),XI(n))}function h3(n,e,t){for(const r of t)r instanceof o9?(n.Ru.addReference(r.key,e),One(n,r)):r instanceof l9?(et(KI,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||f9(n,r.key)):Ct(19791,{wu:r})}function One(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(et(KI,"New document in limbo: "+t),n.Eu.add(r),XI(n))}function XI(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new ft(jn.fromString(e)),r=n.fu.next();n.Au.set(r,new Sne(t)),n.du=n.du.insert(t,r),J8(n.remoteStore,new Wl(Ba(sE(t.path)),r,"TargetPurposeLimboResolution",ja.ce))}}async function Wy(n,e,t){const r=tn(n),i=[],s=[],a=[];r.Tu.isEmpty()||(r.Tu.forEach(((o,l)=>{a.push(r.pu(l,e,t).then((c=>{if((c||t)&&r.isPrimaryClient){const h=c?!c.fromCache:t?.targetChanges.get(l.targetId)?.current;r.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(c){i.push(c);const h=jI.As(l.targetId,c);s.push(h)}})))})),await Promise.all(a),r.Pu.H_(i),await(async function(l,c){const h=tn(l);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",(f=>de.forEach(c,(m=>de.forEach(m.Es,(y=>h.persistence.referenceDelegate.addReference(f,m.targetId,y))).next((()=>de.forEach(m.ds,(y=>h.persistence.referenceDelegate.removeReference(f,m.targetId,y)))))))))}catch(f){if(!Hu(f))throw f;et(VI,"Failed to update sequence numbers: "+f)}for(const f of c){const m=f.targetId;if(!f.fromCache){const y=h.Ms.get(m),x=y.snapshotVersion,_=y.withLastLimboFreeSnapshotVersion(x);h.Ms=h.Ms.insert(m,_)}}})(r.localStore,s))}async function Dne(n,e){const t=tn(n);if(!t.currentUser.isEqual(e)){et(KI,"User change. New user:",e.toKey());const r=await K8(t.localStore,e);t.currentUser=e,(function(s,a){s.mu.forEach((o=>{o.forEach((l=>{l.reject(new ht(Oe.CANCELLED,a))}))})),s.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Wy(t,r.Ls)}}function Fne(n,e){const t=tn(n),r=t.Au.get(e);if(r&&r.hu)return un().add(r.key);{let i=un();const s=t.Iu.get(e);if(!s)return i;for(const a of s){const o=t.Tu.get(a);i=i.unionWith(o.view.nu)}return i}}function g9(n){const e=tn(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=u9.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Fne.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Mne.bind(null,e),e.Pu.H_=vne.bind(null,e.eventManager),e.Pu.yu=wne.bind(null,e.eventManager),e}function m9(n){const e=tn(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Nne.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Lne.bind(null,e),e}class qp{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=gE(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return H8(this.persistence,new W8,e.initialUser,this.serializer)}Cu(e){return new DI(fE.mi,this.serializer)}Du(e){return new q8}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}qp.provider={build:()=>new qp};class jne extends qp{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Ot(this.persistence.referenceDelegate instanceof Tv,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new G8(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?ss.withCacheSize(this.cacheSizeBytes):ss.DEFAULT;return new DI((r=>Tv.mi(r,t)),this.serializer)}}class Vne extends qp{constructor(e,t,r){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await m9(this.xu.syncEngine),await $y(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return H8(this.persistence,new W8,e.initialUser,this.serializer)}Fu(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new G8(r,e.asyncQueue,t)}Mu(e,t){const r=new WQ(t,this.persistence);return new $Q(e.asyncQueue,r)}Cu(e){const t=Vte(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?ss.withCacheSize(this.cacheSizeBytes):ss.DEFAULT;return new FI(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,ene(),v_(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new q8}}class bv{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>u3(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=Dne.bind(null,this.syncEngine),await yne(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new _ne})()}createDatastore(e){const t=gE(e.databaseInfo.databaseId),r=(function(s){return new Qte(s)})(e.databaseInfo);return(function(s,a,o,l){return new ine(s,a,o,l)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,i,s,a,o){return new ane(r,i,s,a,o)})(this.localStore,this.datastore,e.asyncQueue,(t=>u3(this.syncEngine,t,0)),(function(){return i3.v()?new i3:new qte})())}createSyncEngine(e,t){return(function(i,s,a,o,l,c,h){const f=new bne(i,s,a,o,l,c);return h&&(f.gu=!0),f})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const r=tn(t);et(_d,"RemoteStore shutting down."),r.Ea.add(5),await Uy(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}bv.provider={build:()=>new bv};class p9{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Ts("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const Du="FirestoreClient";class Gne{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Ui.UNAUTHENTICATED,this.clientId=pI.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,(async a=>{et(Du,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(r,(a=>(et(Du,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new il;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=WI(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function pS(n,e){n.asyncQueue.verifyOperationInProgress(),et(Du,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async i=>{r.isEqual(i)||(await K8(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function d3(n,e){n.asyncQueue.verifyOperationInProgress();const t=await Bne(n);et(Du,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>a3(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,i)=>a3(e.remoteStore,i))),n._onlineComponents=e}async function Bne(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){et(Du,"Using user provided OfflineComponentProvider");try{await pS(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===Oe.FAILED_PRECONDITION||i.code===Oe.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;fd("Error using user provided cache. Falling back to memory cache: "+t),await pS(n,new qp)}}else et(Du,"Using default OfflineComponentProvider"),await pS(n,new jne(void 0));return n._offlineComponents}async function y9(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(et(Du,"Using user provided OnlineComponentProvider"),await d3(n,n._uninitializedComponentsProvider._online)):(et(Du,"Using default OnlineComponentProvider"),await d3(n,new bv))),n._onlineComponents}function zne(n){return y9(n).then((e=>e.syncEngine))}async function x9(n){const e=await y9(n),t=e.eventManager;return t.onListen=Rne.bind(null,e.syncEngine),t.onUnlisten=Cne.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=Ane.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=kne.bind(null,e.syncEngine),t}function Une(n,e,t={}){const r=new il;return n.asyncQueue.enqueueAndForget((async()=>(function(s,a,o,l,c){const h=new p9({next:m=>{h.Nu(),a.enqueueAndForget((()=>s9(s,f)));const y=m.docs.has(o);!y&&m.fromCache?c.reject(new ht(Oe.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&m.fromCache&&l&&l.source==="server"?c.reject(new ht(Oe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(m)},error:m=>c.reject(m)}),f=new a9(sE(o.path),h,{includeMetadataChanges:!0,qa:!0});return i9(s,f)})(await x9(n),n.asyncQueue,e,t,r))),r.promise}function $ne(n,e,t={}){const r=new il;return n.asyncQueue.enqueueAndForget((async()=>(function(s,a,o,l,c){const h=new p9({next:m=>{h.Nu(),a.enqueueAndForget((()=>s9(s,f))),m.fromCache&&l.source==="server"?c.reject(new ht(Oe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(m)},error:m=>c.reject(m)}),f=new a9(o,h,{includeMetadataChanges:!0,qa:!0});return i9(s,f)})(await x9(n),n.asyncQueue,e,t,r))),r.promise}function _9(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const f3=new Map;const v9="firestore.googleapis.com",g3=!0;class m3{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ht(Oe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=v9,this.ssl=g3}else this.host=e.host,this.ssl=e.ssl??g3;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=D8;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Ete)throw new ht(Oe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}GQ("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=_9(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new ht(Oe.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new ht(Oe.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new ht(Oe.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class pE{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new m3({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ht(Oe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ht(Oe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new m3(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new kQ;switch(r.type){case"firstParty":return new LQ(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ht(Oe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=f3.get(t);r&&(et("ComponentProvider","Removing Datastore"),f3.delete(t),r.terminate())})(this),Promise.resolve()}}function Wne(n,e,t,r={}){n=Ka(n,pE);const i=Md(e),s=n._getSettings(),a={...s,emulatorOptions:n._getEmulatorOptions()},o=`${e}:${t}`;i&&(tI(`https://${o}`),nI("Firestore",!0)),s.host!==v9&&s.host!==o&&fd("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...s,host:o,ssl:i,emulatorOptions:r};if(!cd(l,a)&&(n._setSettings(l),r.mockUserToken)){let c,h;if(typeof r.mockUserToken=="string")c=r.mockUserToken,h=Ui.MOCK_USER;else{c=bj(r.mockUserToken,n._app?.options.projectId);const f=r.mockUserToken.sub||r.mockUserToken.user_id;if(!f)throw new ht(Oe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new Ui(f)}n._authCredentials=new PQ(new w6(c,h))}}class mg{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new mg(this.firestore,e,this._query)}}class Hr{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Au(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Hr(this.firestore,e,this._key)}toJSON(){return{type:Hr._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(Fy(t,Hr._jsonSchema))return new Hr(e,r||null,new ft(jn.fromString(t.referencePath)))}}Hr._jsonSchemaVersion="firestore/documentReference/1.0",Hr._jsonSchema={type:ni("string",Hr._jsonSchemaVersion),referencePath:ni("string")};class Au extends mg{constructor(e,t,r){super(e,t,sE(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Hr(this.firestore,null,new ft(e))}withConverter(e){return new Au(this.firestore,e,this._path)}}function p3(n,e,...t){if(n=Mi(n),T6("collection","path",e),n instanceof pE){const r=jn.fromString(e,...t);return sL(r),new Au(n,null,r)}{if(!(n instanceof Hr||n instanceof Au))throw new ht(Oe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(jn.fromString(e,...t));return sL(r),new Au(n.firestore,null,r)}}function w0(n,e,...t){if(n=Mi(n),arguments.length===1&&(e=pI.newId()),T6("doc","path",e),n instanceof pE){const r=jn.fromString(e,...t);return iL(r),new Hr(n,null,new ft(r))}{if(!(n instanceof Hr||n instanceof Au))throw new ht(Oe.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(jn.fromString(e,...t));return iL(r),new Hr(n.firestore,n instanceof Au?n.converter:null,new ft(r))}}const y3="AsyncQueue";class x3{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Y8(this,"async_queue_retry"),this._c=()=>{const r=v_();r&&et(y3,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=v_();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=v_();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new il;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Hu(e))throw e;et(y3,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,Ts("INTERNAL UNHANDLED ERROR: ",_3(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const i=$I.createAndSchedule(this,e,t,r,(s=>this.hc(s)));return this.tc.push(i),i}uc(){this.nc&&Ct(47125,{Pc:_3(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function _3(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class Xu extends pE{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new x3,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new x3(e),this._firestoreClient=void 0,await e}}}function Hne(n,e){const t=typeof n=="object"?n:sI(),r=typeof n=="string"?n:gv,i=Kw(t,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=Ej("firestore");s&&Wne(i,...s)}return i}function qI(n){if(n._terminated)throw new ht(Oe.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||w9(n),n._firestoreClient}function w9(n){const e=n._freezeSettings(),t=(function(i,s,a,o){return new vee(i,s,a,o.host,o.ssl,o.experimentalForceLongPolling,o.experimentalAutoDetectLongPolling,_9(o.experimentalLongPollingOptions),o.useFetchStreams,o.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new Gne(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(i){const s=i?._online.build();return{_offline:i?._offline.build(s),_online:s}})(n._componentsProvider))}function Kne(n,e){fd("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return Xne(n,bv.provider,{build:r=>new Vne(r,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function Xne(n,e,t){if((n=Ka(n,Xu))._firestoreClient||n._terminated)throw new ht(Oe.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new ht(Oe.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},w9(n)}class Na{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Na(ii.fromBase64String(e))}catch(t){throw new ht(Oe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Na(ii.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Na._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Fy(e,Na._jsonSchema))return Na.fromBase64String(e.bytes)}}Na._jsonSchemaVersion="firestore/bytes/1.0",Na._jsonSchema={type:ni("string",Na._jsonSchemaVersion),bytes:ni("string")};class yE{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ht(Oe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Pr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class xE{constructor(e){this._methodName=e}}class sl{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ht(Oe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ht(Oe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return en(this._lat,e._lat)||en(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:sl._jsonSchemaVersion}}static fromJSON(e){if(Fy(e,sl._jsonSchema))return new sl(e.latitude,e.longitude)}}sl._jsonSchemaVersion="firestore/geoPoint/1.0",sl._jsonSchema={type:ni("string",sl._jsonSchemaVersion),latitude:ni("number"),longitude:ni("number")};class al{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:al._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Fy(e,al._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new al(e.vectorValues);throw new ht(Oe.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}al._jsonSchemaVersion="firestore/vectorValue/1.0",al._jsonSchema={type:ni("string",al._jsonSchemaVersion),vectorValues:ni("object")};const qne=/^__.*__$/;class Yne{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new yc(e,this.data,this.fieldMask,t,this.fieldTransforms):new fg(e,this.data,t,this.fieldTransforms)}}class E9{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new yc(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function T9(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ct(40011,{Ac:n})}}class YI{constructor(e,t,r,i,s,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new YI({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Rv(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(T9(this.Ac)&&qne.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class Zne{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||gE(e)}Cc(e,t,r,i=!1){return new YI({Ac:e,methodName:t,Dc:r,path:Pr.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function _E(n){const e=n._freezeSettings(),t=gE(n._databaseId);return new Zne(n._databaseId,!!e.ignoreUndefinedProperties,t)}function S9(n,e,t,r,i,s={}){const a=n.Cc(s.merge||s.mergeFields?2:0,e,t,i);JI("Data must be an object, but it was:",a,r);const o=b9(r,a);let l,c;if(s.merge)l=new Gs(a.fieldMask),c=a.fieldTransforms;else if(s.mergeFields){const h=[];for(const f of s.mergeFields){const m=fR(e,f,t);if(!a.contains(m))throw new ht(Oe.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);A9(h,m)||h.push(m)}l=new Gs(h),c=a.fieldTransforms.filter((f=>l.covers(f.field)))}else l=null,c=a.fieldTransforms;return new Yne(new os(o),l,c)}class vE extends xE{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof vE}}class ZI extends xE{_toFieldTransform(e){return new f8(e.path,new X0)}isEqual(e){return e instanceof ZI}}function Jne(n,e,t,r){const i=n.Cc(1,e,t);JI("Data must be an object, but it was:",i,r);const s=[],a=os.empty();Ku(r,((l,c)=>{const h=QI(e,l,t);c=Mi(c);const f=i.yc(h);if(c instanceof vE)s.push(h);else{const m=Hy(c,f);m!=null&&(s.push(h),a.set(h,m))}}));const o=new Gs(s);return new E9(a,o,i.fieldTransforms)}function Qne(n,e,t,r,i,s){const a=n.Cc(1,e,t),o=[fR(e,r,t)],l=[i];if(s.length%2!=0)throw new ht(Oe.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<s.length;m+=2)o.push(fR(e,s[m])),l.push(s[m+1]);const c=[],h=os.empty();for(let m=o.length-1;m>=0;--m)if(!A9(c,o[m])){const y=o[m];let x=l[m];x=Mi(x);const _=a.yc(y);if(x instanceof vE)c.push(y);else{const w=Hy(x,_);w!=null&&(c.push(y),h.set(y,w))}}const f=new Gs(c);return new E9(h,f,a.fieldTransforms)}function ere(n,e,t,r=!1){return Hy(t,n.Cc(r?4:3,e))}function Hy(n,e){if(R9(n=Mi(n)))return JI("Unsupported field value:",e,n),b9(n,e);if(n instanceof xE)return(function(r,i){if(!T9(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,i){const s=[];let a=0;for(const o of r){let l=Hy(o,i.wc(a));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),a++}return{arrayValue:{values:s}}})(n,e)}return(function(r,i){if((r=Mi(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Gee(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=qn.fromDate(r);return{timestampValue:Z0(i.serializer,s)}}if(r instanceof qn){const s=new qn(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Z0(i.serializer,s)}}if(r instanceof sl)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Na)return{bytesValue:v8(i.serializer,r._byteString)};if(r instanceof Hr){const s=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(s))throw i.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:MI(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof al)return(function(a,o){return{mapValue:{fields:{[SI]:{stringValue:bI},[$0]:{arrayValue:{values:a.toArray().map((c=>{if(typeof c!="number")throw o.Sc("VectorValues must only contain numeric values.");return AI(o.serializer,c)}))}}}}}})(r,i);throw i.Sc(`Unsupported field value: ${Zw(r)}`)})(n,e)}function b9(n,e){const t={};return V6(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ku(n,((r,i)=>{const s=Hy(i,e.mc(r));s!=null&&(t[r]=s)})),{mapValue:{fields:t}}}function R9(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof qn||n instanceof sl||n instanceof Na||n instanceof Hr||n instanceof xE||n instanceof al)}function JI(n,e,t){if(!R9(t)||!S6(t)){const r=Zw(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function fR(n,e,t){if((e=Mi(e))instanceof yE)return e._internalPath;if(typeof e=="string")return QI(n,e);throw Rv("Field path arguments must be of type string or ",n,!1,void 0,t)}const tre=new RegExp("[~\\*/\\[\\]]");function QI(n,e,t){if(e.search(tre)>=0)throw Rv(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new yE(...e.split("."))._internalPath}catch{throw Rv(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Rv(n,e,t,r,i){const s=r&&!r.isEmpty(),a=i!==void 0;let o=`Function ${e}() called with invalid data`;t&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${r}`),a&&(l+=` in document ${i}`),l+=")"),new ht(Oe.INVALID_ARGUMENT,o+n+l)}function A9(n,e){return n.some((t=>t.isEqual(e)))}class I9{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Hr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new nre(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(eC("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class nre extends I9{data(){return super.data()}}function eC(n,e){return typeof e=="string"?QI(n,e):e instanceof yE?e._internalPath:e._delegate._internalPath}function rre(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new ht(Oe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class tC{}class ire extends tC{}function sre(n,e,...t){let r=[];e instanceof tC&&r.push(e),r=r.concat(t),(function(s){const a=s.filter((l=>l instanceof nC)).length,o=s.filter((l=>l instanceof wE)).length;if(a>1||a>0&&o>0)throw new ht(Oe.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const i of r)n=i._apply(n);return n}class wE extends ire{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new wE(e,t,r)}_apply(e){const t=this._parse(e);return C9(e._query,t),new mg(e.firestore,e.converter,eR(e._query,t))}_parse(e){const t=_E(e.firestore);return(function(s,a,o,l,c,h,f){let m;if(c.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new ht(Oe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){w3(f,h);const x=[];for(const _ of f)x.push(v3(l,s,_));m={arrayValue:{values:x}}}else m=v3(l,s,f)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||w3(f,h),m=ere(o,a,f,h==="in"||h==="not-in");return xn.create(c,h,m)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function are(n,e,t){const r=e,i=eC("where",n);return wE._create(i,r,t)}class nC extends tC{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new nC(e,t)}_parse(e){const t=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return t.length===1?t[0]:Zn.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(i,s){let a=i;const o=s.getFlattenedFilters();for(const l of o)C9(a,l),a=eR(a,l)})(e._query,t),new mg(e.firestore,e.converter,eR(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function v3(n,e,t){if(typeof(t=Mi(t))=="string"){if(t==="")throw new ht(Oe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!n8(e)&&t.indexOf("/")!==-1)throw new ht(Oe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(jn.fromString(t));if(!ft.isDocumentKey(r))throw new ht(Oe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Hp(n,new ft(r))}if(t instanceof Hr)return Hp(n,t._key);throw new ht(Oe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Zw(t)}.`)}function w3(n,e){if(!Array.isArray(n)||n.length===0)throw new ht(Oe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function C9(n,e){const t=(function(i,s){for(const a of i)for(const o of a.getFlattenedFilters())if(s.indexOf(o.op)>=0)return o.op;return null})(n.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new ht(Oe.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ht(Oe.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class ore{convertValue(e,t="none"){switch(Nu(e)){case 0:return null;case 1:return e.booleanValue;case 2:return xr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(lc(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ct(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Ku(e,((i,s)=>{r[i]=this.convertValue(s,t)})),r}convertVectorValue(e){const t=e.fields?.[$0].arrayValue?.values?.map((r=>xr(r.doubleValue)));return new al(t)}convertGeoPoint(e){return new sl(xr(e.latitude),xr(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=rE(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp($p(e));default:return null}}convertTimestamp(e){const t=oc(e);return new qn(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=jn.fromString(e);Ot(k8(r),9688,{name:e});const i=new gd(r.get(1),r.get(3)),s=new ft(r.popFirst(5));return i.isEqual(t)||Ts(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function k9(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class km{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Qh extends I9{constructor(e,t,r,i,s,a){super(e,t,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new w_(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(eC("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ht(Oe.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Qh._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Qh._jsonSchemaVersion="firestore/documentSnapshot/1.0",Qh._jsonSchema={type:ni("string",Qh._jsonSchemaVersion),bundleSource:ni("string","DocumentSnapshot"),bundleName:ni("string"),bundle:ni("string")};class w_ extends Qh{data(e={}){return super.data(e)}}class E0{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new km(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new w_(this._firestore,this._userDataWriter,r.key,r,new km(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ht(Oe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map((o=>{const l=new w_(i._firestore,i._userDataWriter,o.doc.key,o.doc,new km(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}}))}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((o=>s||o.type!==3)).map((o=>{const l=new w_(i._firestore,i._userDataWriter,o.doc.key,o.doc,new km(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,h=-1;return o.type!==0&&(c=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),h=a.indexOf(o.doc.key)),{type:lre(o.type),doc:l,oldIndex:c,newIndex:h}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ht(Oe.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=E0._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=pI.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],i=[];return this.docs.forEach((s=>{s._document!==null&&(t.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function lre(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ct(61501,{type:n})}}function cre(n){n=Ka(n,Hr);const e=Ka(n.firestore,Xu);return Une(qI(e),n._key).then((t=>gre(e,n,t)))}E0._jsonSchemaVersion="firestore/querySnapshot/1.0",E0._jsonSchema={type:ni("string",E0._jsonSchemaVersion),bundleSource:ni("string","QuerySnapshot"),bundleName:ni("string"),bundle:ni("string")};class P9 extends ore{constructor(e){super(),this.firestore=e}convertBytes(e){return new Na(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Hr(this.firestore,null,t)}}function ure(n){n=Ka(n,mg);const e=Ka(n.firestore,Xu),t=qI(e),r=new P9(e);return rre(n._query),$ne(t,n._query).then((i=>new E0(e,r,n,i)))}function E3(n,e,t){n=Ka(n,Hr);const r=Ka(n.firestore,Xu),i=k9(n.converter,e,t);return EE(r,[S9(_E(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,ls.none())])}function hre(n,e,t,...r){n=Ka(n,Hr);const i=Ka(n.firestore,Xu),s=_E(i);let a;return a=typeof(e=Mi(e))=="string"||e instanceof yE?Qne(s,"updateDoc",n._key,e,t,r):Jne(s,"updateDoc",n._key,e),EE(i,[a.toMutation(n._key,ls.exists(!0))])}function dre(n){return EE(Ka(n.firestore,Xu),[new cE(n._key,ls.none())])}function fre(n,e){const t=Ka(n.firestore,Xu),r=w0(n),i=k9(n.converter,e);return EE(t,[S9(_E(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,ls.exists(!1))]).then((()=>r))}function EE(n,e){return(function(r,i){const s=new il;return r.asyncQueue.enqueueAndForget((async()=>Pne(await zne(r),i,s))),s.promise})(qI(n),e)}function gre(n,e,t){const r=t.docs.get(e._key),i=new P9(n);return new Qh(n,i,e._key,r,new km(t.hasPendingWrites,t.fromCache),e.converter)}function T3(){return new ZI("serverTimestamp")}(function(e,t=!0){(function(i){dg=i})(Nd),ud(new Pu("firestore",((r,{instanceIdentifier:i,options:s})=>{const a=r.getProvider("app").getImmediate(),o=new Xu(new MQ(r.getProvider("auth-internal")),new OQ(a,r.getProvider("app-check-internal")),(function(c,h){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new ht(Oe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new gd(c.options.projectId,h)})(a,i),a);return s={useFetchStreams:t,...s},o._setSettings(s),o}),"PUBLIC").setMultipleInstances(!0)),nl(eL,tL,e),nl(eL,tL,"esm2020")})();const M9="firebasestorage.googleapis.com",mre="storageBucket",pre=120*1e3,yre=600*1e3;class _l extends xl{constructor(e,t,r=0){super(yS(e),`Firebase Storage: ${t} (${yS(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,_l.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return yS(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var fl;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(fl||(fl={}));function yS(n){return"storage/"+n}function xre(){const n="An unknown error occurred, please check the error payload for server response.";return new _l(fl.UNKNOWN,n)}function _re(){return new _l(fl.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function vre(){return new _l(fl.CANCELED,"User canceled the upload/download.")}function wre(n){return new _l(fl.INVALID_URL,"Invalid URL '"+n+"'.")}function Ere(n){return new _l(fl.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function S3(n){return new _l(fl.INVALID_ARGUMENT,n)}function N9(){return new _l(fl.APP_DELETED,"The Firebase app was deleted.")}function Tre(n){return new _l(fl.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}class yo{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=yo.makeFromUrl(e,t)}catch{return new yo(e,"")}if(r.path==="")return r;throw Ere(e)}static makeFromUrl(e,t){let r=null;const i="([A-Za-z0-9.\\-_]+)";function s(M){M.path.charAt(M.path.length-1)==="/"&&(M.path_=M.path_.slice(0,-1))}const a="(/(.*))?$",o=new RegExp("^gs://"+i+a,"i"),l={bucket:1,path:3};function c(M){M.path_=decodeURIComponent(M.path)}const h="v[A-Za-z0-9_]+",f=t.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",y=new RegExp(`^https?://${f}/${h}/b/${i}/o${m}`,"i"),x={bucket:1,path:3},_=t===M9?"(?:storage.googleapis.com|storage.cloud.google.com)":t,w="([^?#]*)",S=new RegExp(`^https?://${_}/${i}/${w}`,"i"),R=[{regex:o,indices:l,postModify:s},{regex:y,indices:x,postModify:c},{regex:S,indices:{bucket:1,path:2},postModify:c}];for(let M=0;M<R.length;M++){const O=R[M],G=O.regex.exec(e);if(G){const A=G[O.indices.bucket];let I=G[O.indices.path];I||(I=""),r=new yo(A,I),O.postModify(r);break}}if(r==null)throw wre(e);return r}}class Sre{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function bre(n,e,t){let r=1,i=null,s=null,a=!1,o=0;function l(){return o===2}let c=!1;function h(...w){c||(c=!0,e.apply(null,w))}function f(w){i=setTimeout(()=>{i=null,n(y,l())},w)}function m(){s&&clearTimeout(s)}function y(w,...S){if(c){m();return}if(w){m(),h.call(null,w,...S);return}if(l()||a){m(),h.call(null,w,...S);return}r<64&&(r*=2);let R;o===1?(o=2,R=0):R=(r+Math.random())*1e3,f(R)}let x=!1;function _(w){x||(x=!0,m(),!c&&(i!==null?(w||(o=2),clearTimeout(i),f(0)):w||(o=1)))}return f(0),s=setTimeout(()=>{a=!0,_(!0)},t),_}function Rre(n){n(!1)}function Are(n){return n!==void 0}function b3(n,e,t,r){if(r<e)throw S3(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw S3(`Invalid value for '${n}'. Expected ${t} or less.`)}function Ire(n){const e=encodeURIComponent;let t="?";for(const r in n)if(n.hasOwnProperty(r)){const i=e(r)+"="+e(n[r]);t=t+i+"&"}return t=t.slice(0,-1),t}var Av;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(Av||(Av={}));function Cre(n,e){const t=n>=500&&n<600,i=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||i||s}class kre{constructor(e,t,r,i,s,a,o,l,c,h,f,m=!0,y=!1){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=a,this.callback_=o,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=h,this.connectionFactory_=f,this.retry=m,this.isUsingEmulator=y,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((x,_)=>{this.resolve_=x,this.reject_=_,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new Dx(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const a=o=>{const l=o.loaded,c=o.lengthComputable?o.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&s.addUploadProgressListener(a),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(a),this.pendingConnection_=null;const o=s.getErrorCode()===Av.NO_ERROR,l=s.getStatus();if(!o||Cre(l,this.additionalRetryCodes_)&&this.retry){const h=s.getErrorCode()===Av.ABORT;r(!1,new Dx(!1,null,h));return}const c=this.successCodes_.indexOf(l)!==-1;r(!0,new Dx(c,s))})},t=(r,i)=>{const s=this.resolve_,a=this.reject_,o=i.connection;if(i.wasSuccessCode)try{const l=this.callback_(o,o.getResponse());Are(l)?s(l):s()}catch(l){a(l)}else if(o!==null){const l=xre();l.serverResponse=o.getErrorText(),this.errorCallback_?a(this.errorCallback_(o,l)):a(l)}else if(i.canceled){const l=this.appDelete_?N9():vre();a(l)}else{const l=_re();a(l)}};this.canceled_?t(!1,new Dx(!1,null,!0)):this.backoffId_=bre(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&Rre(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Dx{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}function Pre(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function Mre(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function Nre(n,e){e&&(n["X-Firebase-GMPID"]=e)}function Lre(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function Ore(n,e,t,r,i,s,a=!0,o=!1){const l=Ire(n.urlParams),c=n.url+l,h=Object.assign({},n.headers);return Nre(h,e),Pre(h,t),Mre(h,s),Lre(h,r),new kre(c,n.method,h,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,a,o)}function Dre(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function Fre(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}class Iv{constructor(e,t){this._service=e,t instanceof yo?this._location=t:this._location=yo.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Iv(e,t)}get root(){const e=new yo(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Fre(this._location.path)}get storage(){return this._service}get parent(){const e=Dre(this._location.path);if(e===null)return null;const t=new yo(this._location.bucket,e);return new Iv(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw Tre(e)}}function R3(n,e){const t=e?.[mre];return t==null?null:yo.makeFromBucketSpec(t,n)}function jre(n,e,t,r={}){n.host=`${e}:${t}`;const i=Md(e);i&&(tI(`https://${n.host}/b`),nI("Storage",!0)),n._isUsingEmulator=!0,n._protocol=i?"https":"http";const{mockUserToken:s}=r;s&&(n._overrideAuthToken=typeof s=="string"?s:bj(s,n.app.options.projectId))}class Vre{constructor(e,t,r,i,s,a=!1){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._isUsingEmulator=a,this._bucket=null,this._host=M9,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=pre,this._maxUploadRetryTime=yre,this._requests=new Set,i!=null?this._bucket=yo.makeFromBucketSpec(i,this._host):this._bucket=R3(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=yo.makeFromBucketSpec(this._url,e):this._bucket=R3(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){b3("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){b3("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(ua(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Iv(this,e)}_makeRequest(e,t,r,i,s=!0){if(this._deleted)return new Sre(N9());{const a=Ore(e,this._appId,r,i,t,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,t){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,i).getPromise()}}const A3="@firebase/storage",I3="0.14.0";const L9="storage";function Gre(n=sI(),e){n=Mi(n);const r=Kw(n,L9).getImmediate({identifier:e}),i=Ej("storage");return i&&Bre(r,...i),r}function Bre(n,e,t,r={}){jre(n,e,t,r)}function zre(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new Vre(t,r,i,e,Nd)}function Ure(){ud(new Pu(L9,zre,"PUBLIC").setMultipleInstances(!0)),nl(A3,I3,""),nl(A3,I3,"esm2020")}Ure();const $re={apiKey:"AIzaSyBcLuKvUr5XqEJTwOf9I0hqJ1o9g3kOZ-g",authDomain:"detectorapp-nl.firebaseapp.com",projectId:"detectorapp-nl",storageBucket:"detectorapp-nl.firebasestorage.app",messagingSenderId:"110954177210",appId:"1:110954177210:web:d77c9ed262ad92bc431883"},rC=Mj($re),$h=RQ(rC),mu=Hne(rC);Gre(rC);Kne(mu).catch(n=>{n.code==="failed-precondition"?console.warn("Offline persistence failed: Multiple tabs open"):n.code==="unimplemented"&&console.warn("Offline persistence not available in this browser")});const Wre={};function Hre(n,e){let t;try{t=n()}catch{return}return{getItem:i=>{var s;const a=l=>l===null?null:JSON.parse(l,void 0),o=(s=t.getItem(i))!=null?s:null;return o instanceof Promise?o.then(a):a(o)},setItem:(i,s)=>t.setItem(i,JSON.stringify(s,void 0)),removeItem:i=>t.removeItem(i)}}const Yp=n=>e=>{try{const t=n(e);return t instanceof Promise?t:{then(r){return Yp(r)(t)},catch(r){return this}}}catch(t){return{then(r){return this},catch(r){return Yp(r)(t)}}}},Kre=(n,e)=>(t,r,i)=>{let s={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:w=>w,version:0,merge:(w,S)=>({...S,...w}),...e},a=!1;const o=new Set,l=new Set;let c;try{c=s.getStorage()}catch{}if(!c)return n((...w)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...w)},r,i);const h=Yp(s.serialize),f=()=>{const w=s.partialize({...r()});let S;const b=h({state:w,version:s.version}).then(R=>c.setItem(s.name,R)).catch(R=>{S=R});if(S)throw S;return b},m=i.setState;i.setState=(w,S)=>{m(w,S),f()};const y=n((...w)=>{t(...w),f()},r,i);let x;const _=()=>{var w;if(!c)return;a=!1,o.forEach(b=>b(r()));const S=((w=s.onRehydrateStorage)==null?void 0:w.call(s,r()))||void 0;return Yp(c.getItem.bind(c))(s.name).then(b=>{if(b)return s.deserialize(b)}).then(b=>{if(b)if(typeof b.version=="number"&&b.version!==s.version){if(s.migrate)return s.migrate(b.state,b.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return b.state}).then(b=>{var R;return x=s.merge(b,(R=r())!=null?R:y),t(x,!0),f()}).then(()=>{S?.(x,void 0),a=!0,l.forEach(b=>b(x))}).catch(b=>{S?.(void 0,b)})};return i.persist={setOptions:w=>{s={...s,...w},w.getStorage&&(c=w.getStorage())},clearStorage:()=>{c?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>_(),hasHydrated:()=>a,onHydrate:w=>(o.add(w),()=>{o.delete(w)}),onFinishHydration:w=>(l.add(w),()=>{l.delete(w)})},_(),x||y},Xre=(n,e)=>(t,r,i)=>{let s={storage:Hre(()=>localStorage),partialize:_=>_,version:0,merge:(_,w)=>({...w,..._}),...e},a=!1;const o=new Set,l=new Set;let c=s.storage;if(!c)return n((..._)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(..._)},r,i);const h=()=>{const _=s.partialize({...r()});return c.setItem(s.name,{state:_,version:s.version})},f=i.setState;i.setState=(_,w)=>{f(_,w),h()};const m=n((..._)=>{t(..._),h()},r,i);i.getInitialState=()=>m;let y;const x=()=>{var _,w;if(!c)return;a=!1,o.forEach(b=>{var R;return b((R=r())!=null?R:m)});const S=((w=s.onRehydrateStorage)==null?void 0:w.call(s,(_=r())!=null?_:m))||void 0;return Yp(c.getItem.bind(c))(s.name).then(b=>{if(b)if(typeof b.version=="number"&&b.version!==s.version){if(s.migrate)return[!0,s.migrate(b.state,b.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,b.state];return[!1,void 0]}).then(b=>{var R;const[M,O]=b;if(y=s.merge(O,(R=r())!=null?R:m),t(y,!0),M)return h()}).then(()=>{S?.(y,void 0),y=r(),a=!0,l.forEach(b=>b(y))}).catch(b=>{S?.(void 0,b)})};return i.persist={setOptions:_=>{s={...s,..._},_.storage&&(c=_.storage)},clearStorage:()=>{c?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>x(),hasHydrated:()=>a,onHydrate:_=>(o.add(_),()=>{o.delete(_)}),onFinishHydration:_=>(l.add(_),()=>{l.delete(_)})},s.skipHydration||x(),y||m},qre=(n,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((Wre?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),Kre(n,e)):Xre(n,e),vl=qre,Sn=ms()(vl(n=>({defaultBackground:"CartoDB (licht)",showScaleBar:!0,gpsAutoStart:!1,showAccuracyCircle:!0,hapticFeedback:!0,vondstenLocalOnly:!0,showVondstButton:!1,showRouteRecordButton:!1,showLocalVondsten:!0,showCustomPointLayers:!0,fontScale:100,layerPanelFontScale:100,presetPanelFontScale:100,menuFontScale:100,voiceFeedbackEnabled:!1,showStepCounter:!1,showFontSliders:!1,setDefaultBackground:e=>n({defaultBackground:e}),setShowScaleBar:e=>n({showScaleBar:e}),setGpsAutoStart:e=>n({gpsAutoStart:e}),setShowAccuracyCircle:e=>n({showAccuracyCircle:e}),setHapticFeedback:e=>n({hapticFeedback:e}),setVondstenLocalOnly:e=>n({vondstenLocalOnly:e}),setShowVondstButton:e=>n({showVondstButton:e}),setShowRouteRecordButton:e=>n({showRouteRecordButton:e}),setShowLocalVondsten:e=>n({showLocalVondsten:e}),setShowCustomPointLayers:e=>n({showCustomPointLayers:e}),setFontScale:e=>n({fontScale:e}),setLayerPanelFontScale:e=>n({layerPanelFontScale:e}),setPresetPanelFontScale:e=>n({presetPanelFontScale:e}),setMenuFontScale:e=>n({menuFontScale:e}),setVoiceFeedbackEnabled:e=>n({voiceFeedbackEnabled:e}),setShowStepCounter:e=>n({showStepCounter:e}),setShowFontSliders:e=>n({showFontSliders:e})}),{name:"detectorapp-settings",version:2,migrate:(n,e)=>e<2?{...n,showScaleBar:!0}:n})),TE=ms()(ug((n,e)=>({user:null,accessToken:null,loading:!1,error:null,initialized:!1,setUser:t=>{n(r=>{r.user=t,r.loading=!1})},setLoading:t=>{n(r=>{r.loading=t})},setError:t=>{n(r=>{r.error=t})},setAccessToken:t=>{n(r=>{r.accessToken=t})},signInWithGoogle:async()=>{n(t=>{t.loading=!0,t.error=null});try{const t=new fo;await WN($h,t)}catch(t){console.error("Google sign-in error:",t),n(r=>{r.error=t.message,r.loading=!1})}},connectGoogleFit:async()=>{n(t=>{t.loading=!0,t.error=null});try{const t=new fo;t.addScope("https://www.googleapis.com/auth/fitness.activity.read");const r=await WN($h,t),i=fo.credentialFromResult(r);return i?.accessToken?(n(s=>{s.accessToken=i.accessToken||null,s.loading=!1}),console.log(" Google Fit gekoppeld"),!0):(n(s=>{s.loading=!1}),!1)}catch(t){return console.error("Google Fit connect error:",t),n(r=>{r.error=t.message,r.loading=!1}),!1}},logout:async()=>{n(t=>{t.loading=!0});try{await n6($h),n(t=>{t.accessToken=null})}catch(t){console.error("Logout error:",t),n(r=>{r.error=t.message,r.loading=!1})}},initAuth:()=>{e().initialized||(n(t=>{t.initialized=!0}),t6($h,t=>{n(r=>{r.user=t,r.loading=!1}),t&&Sn.getState().setVondstenLocalOnly(!1)}))}})));ms()(ug((n,e)=>({vondsten:[],loading:!1,error:null,loadVondsten:async t=>{n(r=>{r.loading=!0});try{const r=sre(p3(mu,"vondsten"),are("userId","==",t)),s=(await ure(r)).docs.map(a=>({id:a.id,...a.data()}));n(a=>{a.vondsten=s,a.loading=!1})}catch(r){n(i=>{i.error=r.message,i.loading=!1})}},addVondst:async t=>{const r=new Date().toISOString(),i={...t,createdAt:r,updatedAt:r},s=await fre(p3(mu,"vondsten"),i);return n(a=>{a.vondsten.push({...i,id:s.id})}),s.id},updateVondst:async(t,r)=>{const i=w0(mu,"vondsten",t);await hre(i,{...r,updatedAt:new Date().toISOString()}),n(s=>{const a=s.vondsten.findIndex(o=>o.id===t);a!==-1&&(s.vondsten[a]={...s.vondsten[a],...r})})},deleteVondst:async t=>{await dre(w0(mu,"vondsten",t)),n(r=>{r.vondsten=r.vondsten.filter(i=>i.id!==t)})}})));const xS=[{id:"detectie",name:"Detectie",icon:"Compass",layers:["AMK Monumenten","Gewaspercelen"],baseLayer:"CartoDB (licht)",isBuiltIn:!1},{id:"steentijd",name:"Steentijd",icon:"Mountain",layers:["Hunebedden","Grafheuvels","Terpen","FAMKE Steentijd","AMK Steentijd","AHN4 Multi-Hillshade NL","Labels Overlay"],baseLayer:"Luchtfoto",isBuiltIn:!1},{id:"romeins-midvroeg",name:"Romeins - Mid vroeg",icon:"Layers",layers:["Romeinse wegen (regio)","Romeinse Forten","Romeinse Forten Lijnen","AMK Romeins","AMK Vroege ME","Gewaspercelen","Kadastrale Grenzen"],isBuiltIn:!1},{id:"midlaat-nieuwetijd",name:"Mid laat - Nieuwe tijd",icon:"Grid",layers:["AMK Late ME","Kastelen","Essen","Rijksmonumenten","Gewaspercelen","Kadastrale Grenzen","Oude Kernen"],isBuiltIn:!1},{id:"woii-militair",name:"WOII & Militair",icon:"Target",layers:["WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Inundatiegebieden","Militaire Objecten"],isBuiltIn:!1},{id:"analyse",name:"Terrein Analyse",icon:"Search",layers:["IKAW","Geomorfologie","Bodemkaart","Archeo Landschappen","AHN4 Multi-Hillshade NL","AHN4 Hoogtekaart Kleur"],isBuiltIn:!1}],C3=["Labels Overlay","TMK 1850","Bonnebladen 1900","Hunebedden","FAMKE Steentijd","Grafheuvels","Terpen","AMK Monumenten","AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig","Romeinse wegen (regio)","Romeinse wegen (Wereld)","Romeinse Forten","Romeinse Forten Lijnen","Kastelen","IKAW","Archeo Landschappen","Rijksmonumenten","Werelderfgoed","Religieus Erfgoed","Essen","WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Inundatiegebieden","Militaire Objecten","Paleokaart 800 n.Chr.","Paleokaart 100 n.Chr.","Paleokaart 500 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 9000 v.Chr.","UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling","AHN4 Hoogtekaart Kleur","AHN4 Hillshade NL","AHN4 Multi-Hillshade NL","AHN 0.5m","Veengebieden","Geomorfologie","Bodemkaart","Fossielen Nederland","Fossielen Belgi","Fossielen Duitsland","Fossielen Frankrijk","Parken","Speeltuinen","Musea","Strandjes","Kringloopwinkels","Gewaspercelen","Kadastrale Grenzen","Scheepswrakken","Woonheuvels ZH","Windmolens","Erfgoedlijnen","Oude Kernen","Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken","Verdronken Dorpen"],O9=ms()(vl((n,e)=>({presets:[...xS],applyPreset:t=>{const r=e().presets.find(s=>s.id===t);if(!r)return;const i=Ri.getState();C3.forEach(s=>i.setLayerVisibility(s,!1)),r.layers.forEach(s=>i.setLayerVisibility(s,!0)),r.baseLayer&&["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"].forEach(a=>{i.setLayerVisibility(a,a===r.baseLayer)}),console.log(` Preset toegepast: ${r.name}${r.baseLayer?` (${r.baseLayer})`:""}`)},createPreset:(t,r)=>{const i=Ri.getState(),s=Object.entries(i.visible).filter(([o,l])=>l&&C3.includes(o)).map(([o])=>o),a={id:`custom-${Date.now()}`,name:t,icon:r,layers:s,isBuiltIn:!1};n(o=>({presets:[...o.presets,a]})),console.log(` Preset aangemaakt: ${t} met ${s.length} lagen`)},updatePreset:(t,r)=>{n(i=>({presets:i.presets.map(s=>s.id===t?{...s,...r}:s)}))},deletePreset:t=>{n(r=>({presets:r.presets.filter(i=>i.id!==t||i.isBuiltIn)}))},resetToDefaults:()=>{n({presets:[...xS]})}}),{name:"detectorapp-presets",version:9,migrate:(n,e)=>e<9?{presets:[...xS]}:n})),k3=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899"],Ky=ms()(vl((n,e)=>({layers:[],addLayer:t=>{const r=crypto.randomUUID(),i=e().layers.length,s=k3[i%k3.length];return n(a=>({layers:[...a.layers,{...t,id:r,createdAt:new Date().toISOString(),color:t.color||s,visible:t.visible??!0,opacity:t.opacity??1}]})),r},removeLayer:t=>n(r=>({layers:r.layers.filter(i=>i.id!==t)})),updateLayer:(t,r)=>n(i=>({layers:i.layers.map(s=>s.id===t?{...s,...r}:s)})),toggleVisibility:t=>n(r=>({layers:r.layers.map(i=>i.id===t?{...i,visible:!i.visible}:i)})),setOpacity:(t,r)=>n(i=>({layers:i.layers.map(s=>s.id===t?{...s,opacity:r}:s)})),setColor:(t,r)=>n(i=>({layers:i.layers.map(s=>s.id===t?{...s,color:r}:s)})),clearAll:()=>n({layers:[]})}),{name:"detectorapp-custom-layers",version:1})),Yre=["CartoDB (licht)","OpenStreetMap","Luchtfoto","Labels Overlay","Mijn Vondsten"],iC=ms()(vl((n,e)=>({tier:"free",unlockedRegions:["nl"],devMode:!0,setTier:t=>n({tier:t}),unlockRegion:t=>n(r=>({unlockedRegions:r.unlockedRegions.includes(t)?r.unlockedRegions:[...r.unlockedRegions,t]})),lockRegion:t=>n(r=>({unlockedRegions:r.unlockedRegions.filter(i=>i!==t)})),setDevMode:t=>n({devMode:t}),isRegionUnlocked:t=>{const r=e();return r.devMode||r.tier==="pro"?!0:r.unlockedRegions.includes(t)},isLayerUnlocked:(t,r="free",i=["nl"])=>{const s=e();return s.devMode||Yre.includes(t)||r==="free"||s.tier==="pro"?!0:s.tier==="premium"?i.some(a=>s.unlockedRegions.includes(a)):!1},canAccessPremiumFeatures:()=>{const t=e();return t.devMode||t.tier!=="free"}}),{name:"detectorapp-subscription",version:1}));ms()(vl(n=>({parkingLocation:null,showParkingButton:!0,setParkingLocation:e=>n({parkingLocation:e}),clearParkingLocation:()=>n({parkingLocation:null}),setShowParkingButton:e=>n({showParkingButton:e})}),{name:"detectorapp-parking"}));function P3(){return new Date().toISOString().split("T")[0]}ms()(vl((n,e)=>({steps:0,distance:0,startTime:null,isActive:!1,todaySteps:0,todayDate:P3(),stepLength:.75,incrementStep:()=>{const t=e(),r=P3(),i=t.todayDate===r?t.todaySteps+1:1;n({steps:t.steps+1,distance:(t.steps+1)*t.stepLength,todaySteps:i,todayDate:r})},resetSession:()=>{n({steps:0,distance:0,startTime:null})},setActive:t=>{n({isActive:t,startTime:t?Date.now():e().startTime})},setStepLength:t=>{const r=e();n({stepLength:t,distance:r.steps*t})}}),{name:"step-counter-storage",partialize:n=>({todaySteps:n.todaySteps,todayDate:n.todayDate,stepLength:n.stepLength})}));const M3={sunAzimuth:315,sunElevation:45,verticalExaggeration:2,colorRamp:"terrain",minElevation:-5,maxElevation:50,showControls:!1};ms()(vl(n=>({...M3,setSunAzimuth:e=>n({sunAzimuth:e}),setSunElevation:e=>n({sunElevation:e}),setVerticalExaggeration:e=>n({verticalExaggeration:e}),setColorRamp:e=>n({colorRamp:e}),setMinElevation:e=>n({minElevation:e}),setMaxElevation:e=>n({maxElevation:e}),setShowControls:e=>n({showControls:e}),resetToDefaults:()=>n(M3)}),{name:"detectorapp-hillshade"}));function Zre({target:n,viewOptions:e}){const t=X.useRef(null),r=X.useRef(null),i=pi(a=>a.setMap),s=Sn(a=>a.showScaleBar);return X.useEffect(()=>{if(!t.current){const a={center:[5.1214,52.0907],zoom:8,rotation:0,minZoom:3,maxZoom:19,...e},o=new wq({target:n,controls:[],view:new Zo({center:Ir(a.center),zoom:a.zoom,rotation:a.rotation,minZoom:a.minZoom,maxZoom:a.maxZoom})});t.current=o,i(o),window.__olMap=o}return()=>{t.current&&(t.current.setTarget(void 0),i(null),window.__olMap=null)}},[n,e,i]),X.useEffect(()=>{const a=t.current;a&&(s?r.current||(r.current=new Sq({units:"metric",bar:!1,text:!0,minWidth:80}),a.addControl(r.current)):r.current&&(a.removeControl(r.current),r.current=null))},[s]),t.current}const N3=["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"];function Jre(){const n=X.useRef(null),e=X.useRef(!1);Zre({target:"map"});const t=pi(f=>f.map),r=Ri(f=>f.registerLayer),i=Ri(f=>f.setLayerVisibility),s=Sn(f=>f.defaultBackground);X.useEffect(()=>{if(!t){console.warn(" Map not initialized yet");return}console.log(" Initializing map layers...");const f=new Sh({properties:{title:"OpenStreetMap",type:"base"},visible:!1,source:new GX}),m=new Sh({properties:{title:"CartoDB (licht)",type:"base"},visible:!0,source:new Hf({url:"https://{a-d}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO"})}),y=new Sh({properties:{title:"Luchtfoto",type:"base"},visible:!1,source:new Hf({url:"https://service.pdok.nl/hwh/luchtfotorgb/wmts/v1_0/Actueel_orthoHR/EPSG:3857/{z}/{x}/{y}.jpeg",attributions:" Kadaster / PDOK Luchtfoto",maxZoom:19})}),x=new Sh({properties:{title:"Labels Overlay",type:"overlay"},visible:!1,source:new Hf({url:"https://{a-d}.basemaps.cartocdn.com/rastertiles/voyager_only_labels/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO",maxZoom:20}),zIndex:100}),_=new Sh({properties:{title:"TMK 1850",type:"base"},visible:!1,source:new Hf({url:"https://s.map5.nl/map/gast/tiles/tmk_1850/EPSG3857/{z}/{x}/{y}.png",attributions:" Kadaster / Map5.nl",crossOrigin:"anonymous",maxZoom:14})}),w=new Sh({properties:{title:"Bonnebladen 1900",type:"base"},visible:!1,source:new Hf({url:"https://s.map5.nl/map/gast/tiles/bonne_1900/EPSG3857/{z}/{x}/{y}.png",attributions:" Kadaster / Map5.nl",crossOrigin:"anonymous",maxZoom:14})});t.addLayer(f),t.addLayer(m),t.addLayer(y),t.addLayer(x),t.addLayer(_),t.addLayer(w),console.log(" Base layers added:",{osm:f.getVisible(),cartodb:m.getVisible(),satellite:y.getVisible()}),r("OpenStreetMap",f),r("CartoDB (licht)",m),r("Luchtfoto",y),r("Labels Overlay",x),r("TMK 1850",_),r("Bonnebladen 1900",w),t.updateSize(),console.log(" Map size:",t.getSize()),console.log(" Map center:",t.getView().getCenter()),console.log(" Map zoom:",t.getView().getZoom()),a()},[t,r]);async function a(){if(!t){console.error(" Cannot load layers: map is null");return}const f=Zq();console.log(` Loading ${f.length} immediate-load layers (WMS/Tile)...`);const m=await Promise.allSettled(f.map(async x=>{try{const _=await x.factory();return _?{name:x.name,layer:_}:null}catch(_){return console.warn(` Failed to create ${x.name}:`,_),null}}));let y=0;m.forEach(x=>{if(x.status==="fulfilled"&&x.value){const{name:_,layer:w}=x.value;t.addLayer(w),r(_,w),y++,console.log(`   ${_}`)}}),console.log(` Immediate layers loaded: ${y}/${f.length}`),console.log(` Total layers on map: ${t.getLayers().getLength()}`),console.log(" Vector layers will load on first toggle (lazy loading enabled)")}X.useEffect(()=>{if(!t||e.current)return;const f=setTimeout(()=>{const m=s||"CartoDB (licht)";N3.forEach(y=>{i(y,!1)}),N3.includes(m)?i(m,!0):i("CartoDB (licht)",!0),e.current=!0,console.log(` Default background: ${m}`)},100);return()=>clearTimeout(f)},[t,s,i]);const o=Sn(f=>f.gpsAutoStart),l=ws(f=>f.startTracking),c=X.useRef(!1);X.useEffect(()=>{if(!(!t||c.current)&&o){const f=setTimeout(()=>{l(),c.current=!0,console.log(" GPS autostart enabled - tracking started")},500);return()=>clearTimeout(f)}},[t,o,l]);const h={width:"100%",height:"100vh"};return g.jsx("div",{id:"map",ref:n,style:h})}const sC=X.createContext({});function aC(n){const e=X.useRef(null);return e.current===null&&(e.current=n()),e.current}const SE=X.createContext(null),oC=X.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});class Qre extends X.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=t.offsetHeight||0,r.width=t.offsetWidth||0,r.top=t.offsetTop,r.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function eie({children:n,isPresent:e}){const t=X.useId(),r=X.useRef(null),i=X.useRef({width:0,height:0,top:0,left:0}),{nonce:s}=X.useContext(oC);return X.useInsertionEffect(()=>{const{width:a,height:o,top:l,left:c}=i.current;if(e||!r.current||!a||!o)return;r.current.dataset.motionPopId=t;const h=document.createElement("style");return s&&(h.nonce=s),document.head.appendChild(h),h.sheet&&h.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${a}px !important;
            height: ${o}px !important;
            top: ${l}px !important;
            left: ${c}px !important;
          }
        `),()=>{document.head.removeChild(h)}},[e]),g.jsx(Qre,{isPresent:e,childRef:r,sizeRef:i,children:X.cloneElement(n,{ref:r})})}const tie=({children:n,initial:e,isPresent:t,onExitComplete:r,custom:i,presenceAffectsLayout:s,mode:a})=>{const o=aC(nie),l=X.useId(),c=X.useCallback(f=>{o.set(f,!0);for(const m of o.values())if(!m)return;r&&r()},[o,r]),h=X.useMemo(()=>({id:l,initial:e,isPresent:t,custom:i,onExitComplete:c,register:f=>(o.set(f,!1),()=>o.delete(f))}),s?[Math.random(),c]:[t,c]);return X.useMemo(()=>{o.forEach((f,m)=>o.set(m,!1))},[t]),X.useEffect(()=>{!t&&!o.size&&r&&r()},[t]),a==="popLayout"&&(n=g.jsx(eie,{isPresent:t,children:n})),g.jsx(SE.Provider,{value:h,children:n})};function nie(){return new Map}function D9(n=!0){const e=X.useContext(SE);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:r,register:i}=e,s=X.useId();X.useEffect(()=>{n&&i(s)},[n]);const a=X.useCallback(()=>n&&r&&r(s),[s,r,n]);return!t&&r?[!1,a]:[!0]}const Fx=n=>n.key||"";function L3(n){const e=[];return X.Children.forEach(n,t=>{X.isValidElement(t)&&e.push(t)}),e}const lC=typeof window<"u",F9=lC?X.useLayoutEffect:X.useEffect,$n=({children:n,custom:e,initial:t=!0,onExitComplete:r,presenceAffectsLayout:i=!0,mode:s="sync",propagate:a=!1})=>{const[o,l]=D9(a),c=X.useMemo(()=>L3(n),[n]),h=a&&!o?[]:c.map(Fx),f=X.useRef(!0),m=X.useRef(c),y=aC(()=>new Map),[x,_]=X.useState(c),[w,S]=X.useState(c);F9(()=>{f.current=!1,m.current=c;for(let M=0;M<w.length;M++){const O=Fx(w[M]);h.includes(O)?y.delete(O):y.get(O)!==!0&&y.set(O,!1)}},[w,h.length,h.join("-")]);const b=[];if(c!==x){let M=[...c];for(let O=0;O<w.length;O++){const G=w[O],A=Fx(G);h.includes(A)||(M.splice(O,0,G),b.push(G))}s==="wait"&&b.length&&(M=b),S(L3(M)),_(c);return}const{forceRender:R}=X.useContext(sC);return g.jsx(g.Fragment,{children:w.map(M=>{const O=Fx(M),G=a&&!o?!1:c===w||h.includes(O),A=()=>{if(y.has(O))y.set(O,!0);else return;let I=!0;y.forEach(P=>{P||(I=!1)}),I&&(R?.(),S(m.current),a&&l?.(),r&&r())};return g.jsx(tie,{isPresent:G,initial:!f.current||t?void 0:!1,custom:G?void 0:e,presenceAffectsLayout:i,mode:s,onExitComplete:G?void 0:A,children:M},O)})})},fa=n=>n;let j9=fa;function cC(n){let e;return()=>(e===void 0&&(e=n()),e)}const Q0=(n,e,t)=>{const r=e-n;return r===0?1:(t-n)/r},Jl=n=>n*1e3,Ql=n=>n/1e3,rie={useManualTiming:!1};function iie(n){let e=new Set,t=new Set,r=!1,i=!1;const s=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1};function o(c){s.has(c)&&(l.schedule(c),n()),c(a)}const l={schedule:(c,h=!1,f=!1)=>{const y=f&&r?e:t;return h&&s.add(c),y.has(c)||y.add(c),c},cancel:c=>{t.delete(c),s.delete(c)},process:c=>{if(a=c,r){i=!0;return}r=!0,[e,t]=[t,e],e.forEach(o),e.clear(),r=!1,i&&(i=!1,l.process(c))}};return l}const jx=["read","resolveKeyframes","update","preRender","render","postRender"],sie=40;function V9(n,e){let t=!1,r=!0;const i={delta:0,timestamp:0,isProcessing:!1},s=()=>t=!0,a=jx.reduce((S,b)=>(S[b]=iie(s),S),{}),{read:o,resolveKeyframes:l,update:c,preRender:h,render:f,postRender:m}=a,y=()=>{const S=performance.now();t=!1,i.delta=r?1e3/60:Math.max(Math.min(S-i.timestamp,sie),1),i.timestamp=S,i.isProcessing=!0,o.process(i),l.process(i),c.process(i),h.process(i),f.process(i),m.process(i),i.isProcessing=!1,t&&e&&(r=!1,n(y))},x=()=>{t=!0,r=!0,i.isProcessing||n(y)};return{schedule:jx.reduce((S,b)=>{const R=a[b];return S[b]=(M,O=!1,G=!1)=>(t||x(),R.schedule(M,O,G)),S},{}),cancel:S=>{for(let b=0;b<jx.length;b++)a[jx[b]].cancel(S)},state:i,steps:a}}const{schedule:gr,cancel:Fu,state:Bi,steps:_S}=V9(typeof requestAnimationFrame<"u"?requestAnimationFrame:fa,!0),G9=X.createContext({strict:!1}),O3={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},eg={};for(const n in O3)eg[n]={isEnabled:e=>O3[n].some(t=>!!e[t])};function aie(n){for(const e in n)eg[e]={...eg[e],...n[e]}}const oie=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Cv(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||oie.has(n)}let B9=n=>!Cv(n);function lie(n){n&&(B9=e=>e.startsWith("on")?!Cv(e):n(e))}try{lie(require("@emotion/is-prop-valid").default)}catch{}function cie(n,e,t){const r={};for(const i in n)i==="values"&&typeof n.values=="object"||(B9(i)||t===!0&&Cv(i)||!e&&!Cv(i)||n.draggable&&i.startsWith("onDrag"))&&(r[i]=n[i]);return r}function uie(n){if(typeof Proxy>"u")return n;const e=new Map,t=(...r)=>n(...r);return new Proxy(t,{get:(r,i)=>i==="create"?n:(e.has(i)||e.set(i,n(i)),e.get(i))})}const bE=X.createContext({});function Zp(n){return typeof n=="string"||Array.isArray(n)}function RE(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}const uC=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],hC=["initial",...uC];function AE(n){return RE(n.animate)||hC.some(e=>Zp(n[e]))}function z9(n){return!!(AE(n)||n.variants)}function hie(n,e){if(AE(n)){const{initial:t,animate:r}=n;return{initial:t===!1||Zp(t)?t:void 0,animate:Zp(r)?r:void 0}}return n.inherit!==!1?e:{}}function die(n){const{initial:e,animate:t}=hie(n,X.useContext(bE));return X.useMemo(()=>({initial:e,animate:t}),[D3(e),D3(t)])}function D3(n){return Array.isArray(n)?n.join(" "):n}const fie=Symbol.for("motionComponentSymbol");function i0(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function gie(n,e,t){return X.useCallback(r=>{r&&n.onMount&&n.onMount(r),e&&(r?e.mount(r):e.unmount()),t&&(typeof t=="function"?t(r):i0(t)&&(t.current=r))},[e])}const dC=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),mie="framerAppearId",U9="data-"+dC(mie),{schedule:fC}=V9(queueMicrotask,!1),$9=X.createContext({});function pie(n,e,t,r,i){var s,a;const{visualElement:o}=X.useContext(bE),l=X.useContext(G9),c=X.useContext(SE),h=X.useContext(oC).reducedMotion,f=X.useRef(null);r=r||l.renderer,!f.current&&r&&(f.current=r(n,{visualState:e,parent:o,props:t,presenceContext:c,blockInitialAnimation:c?c.initial===!1:!1,reducedMotionConfig:h}));const m=f.current,y=X.useContext($9);m&&!m.projection&&i&&(m.type==="html"||m.type==="svg")&&yie(f.current,t,i,y);const x=X.useRef(!1);X.useInsertionEffect(()=>{m&&x.current&&m.update(t,c)});const _=t[U9],w=X.useRef(!!_&&!(!((s=window.MotionHandoffIsComplete)===null||s===void 0)&&s.call(window,_))&&((a=window.MotionHasOptimisedAnimation)===null||a===void 0?void 0:a.call(window,_)));return F9(()=>{m&&(x.current=!0,window.MotionIsMounted=!0,m.updateFeatures(),fC.render(m.render),w.current&&m.animationState&&m.animationState.animateChanges())}),X.useEffect(()=>{m&&(!w.current&&m.animationState&&m.animationState.animateChanges(),w.current&&(queueMicrotask(()=>{var S;(S=window.MotionHandoffMarkAsComplete)===null||S===void 0||S.call(window,_)}),w.current=!1))}),m}function yie(n,e,t,r){const{layoutId:i,layout:s,drag:a,dragConstraints:o,layoutScroll:l,layoutRoot:c}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:W9(n.parent)),n.projection.setOptions({layoutId:i,layout:s,alwaysMeasureLayout:!!a||o&&i0(o),visualElement:n,animationType:typeof s=="string"?s:"both",initialPromotionConfig:r,layoutScroll:l,layoutRoot:c})}function W9(n){if(n)return n.options.allowProjection!==!1?n.projection:W9(n.parent)}function xie({preloadedFeatures:n,createVisualElement:e,useRender:t,useVisualState:r,Component:i}){var s,a;n&&aie(n);function o(c,h){let f;const m={...X.useContext(oC),...c,layoutId:_ie(c)},{isStatic:y}=m,x=die(c),_=r(c,y);if(!y&&lC){vie();const w=wie(m);f=w.MeasureLayout,x.visualElement=pie(i,_,m,e,w.ProjectionNode)}return g.jsxs(bE.Provider,{value:x,children:[f&&x.visualElement?g.jsx(f,{visualElement:x.visualElement,...m}):null,t(i,c,gie(_,x.visualElement,h),_,y,x.visualElement)]})}o.displayName=`motion.${typeof i=="string"?i:`create(${(a=(s=i.displayName)!==null&&s!==void 0?s:i.name)!==null&&a!==void 0?a:""})`}`;const l=X.forwardRef(o);return l[fie]=i,l}function _ie({layoutId:n}){const e=X.useContext(sC).id;return e&&n!==void 0?e+"-"+n:n}function vie(n,e){X.useContext(G9).strict}function wie(n){const{drag:e,layout:t}=eg;if(!e&&!t)return{};const r={...e,...t};return{MeasureLayout:e?.isEnabled(n)||t?.isEnabled(n)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}const Eie=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function gC(n){return typeof n!="string"||n.includes("-")?!1:!!(Eie.indexOf(n)>-1||/[A-Z]/u.test(n))}function F3(n){const e=[{},{}];return n?.values.forEach((t,r)=>{e[0][r]=t.get(),e[1][r]=t.getVelocity()}),e}function mC(n,e,t,r){if(typeof e=="function"){const[i,s]=F3(r);e=e(t!==void 0?t:n.custom,i,s)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[i,s]=F3(r);e=e(t!==void 0?t:n.custom,i,s)}return e}const gR=n=>Array.isArray(n),Tie=n=>!!(n&&typeof n=="object"&&n.mix&&n.toValue),Sie=n=>gR(n)?n[n.length-1]||0:n,cs=n=>!!(n&&n.getVelocity);function E_(n){const e=cs(n)?n.get():n;return Tie(e)?e.toValue():e}function bie({scrapeMotionValuesFromProps:n,createRenderState:e,onUpdate:t},r,i,s){const a={latestValues:Rie(r,i,s,n),renderState:e()};return t&&(a.onMount=o=>t({props:r,current:o,...a}),a.onUpdate=o=>t(o)),a}const H9=n=>(e,t)=>{const r=X.useContext(bE),i=X.useContext(SE),s=()=>bie(n,e,r,i);return t?s():aC(s)};function Rie(n,e,t,r){const i={},s=r(n,{});for(const m in s)i[m]=E_(s[m]);let{initial:a,animate:o}=n;const l=AE(n),c=z9(n);e&&c&&!l&&n.inherit!==!1&&(a===void 0&&(a=e.initial),o===void 0&&(o=e.animate));let h=t?t.initial===!1:!1;h=h||a===!1;const f=h?o:a;if(f&&typeof f!="boolean"&&!RE(f)){const m=Array.isArray(f)?f:[f];for(let y=0;y<m.length;y++){const x=mC(n,m[y]);if(x){const{transitionEnd:_,transition:w,...S}=x;for(const b in S){let R=S[b];if(Array.isArray(R)){const M=h?R.length-1:0;R=R[M]}R!==null&&(i[b]=R)}for(const b in _)i[b]=_[b]}}}return i}const pg=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Dd=new Set(pg),K9=n=>e=>typeof e=="string"&&e.startsWith(n),X9=K9("--"),Aie=K9("var(--"),pC=n=>Aie(n)?Iie.test(n.split("/*")[0].trim()):!1,Iie=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,q9=(n,e)=>e&&typeof n=="number"?e.transform(n):n,cc=(n,e,t)=>t>e?e:t<n?n:t,yg={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},Jp={...yg,transform:n=>cc(0,1,n)},Vx={...yg,default:1},Xy=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),tu=Xy("deg"),ol=Xy("%"),$t=Xy("px"),Cie=Xy("vh"),kie=Xy("vw"),j3={...ol,parse:n=>ol.parse(n)/100,transform:n=>ol.transform(n*100)},Pie={borderWidth:$t,borderTopWidth:$t,borderRightWidth:$t,borderBottomWidth:$t,borderLeftWidth:$t,borderRadius:$t,radius:$t,borderTopLeftRadius:$t,borderTopRightRadius:$t,borderBottomRightRadius:$t,borderBottomLeftRadius:$t,width:$t,maxWidth:$t,height:$t,maxHeight:$t,top:$t,right:$t,bottom:$t,left:$t,padding:$t,paddingTop:$t,paddingRight:$t,paddingBottom:$t,paddingLeft:$t,margin:$t,marginTop:$t,marginRight:$t,marginBottom:$t,marginLeft:$t,backgroundPositionX:$t,backgroundPositionY:$t},Mie={rotate:tu,rotateX:tu,rotateY:tu,rotateZ:tu,scale:Vx,scaleX:Vx,scaleY:Vx,scaleZ:Vx,skew:tu,skewX:tu,skewY:tu,distance:$t,translateX:$t,translateY:$t,translateZ:$t,x:$t,y:$t,z:$t,perspective:$t,transformPerspective:$t,opacity:Jp,originX:j3,originY:j3,originZ:$t},V3={...yg,transform:Math.round},yC={...Pie,...Mie,zIndex:V3,size:$t,fillOpacity:Jp,strokeOpacity:Jp,numOctaves:V3},Nie={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},Lie=pg.length;function Oie(n,e,t){let r="",i=!0;for(let s=0;s<Lie;s++){const a=pg[s],o=n[a];if(o===void 0)continue;let l=!0;if(typeof o=="number"?l=o===(a.startsWith("scale")?1:0):l=parseFloat(o)===0,!l||t){const c=q9(o,yC[a]);if(!l){i=!1;const h=Nie[a]||a;r+=`${h}(${c}) `}t&&(e[a]=c)}}return r=r.trim(),t?r=t(e,i?"":r):i&&(r="none"),r}function xC(n,e,t){const{style:r,vars:i,transformOrigin:s}=n;let a=!1,o=!1;for(const l in e){const c=e[l];if(Dd.has(l)){a=!0;continue}else if(X9(l)){i[l]=c;continue}else{const h=q9(c,yC[l]);l.startsWith("origin")?(o=!0,s[l]=h):r[l]=h}}if(e.transform||(a||t?r.transform=Oie(e,n.transform,t):r.transform&&(r.transform="none")),o){const{originX:l="50%",originY:c="50%",originZ:h=0}=s;r.transformOrigin=`${l} ${c} ${h}`}}const Die={offset:"stroke-dashoffset",array:"stroke-dasharray"},Fie={offset:"strokeDashoffset",array:"strokeDasharray"};function jie(n,e,t=1,r=0,i=!0){n.pathLength=1;const s=i?Die:Fie;n[s.offset]=$t.transform(-r);const a=$t.transform(e),o=$t.transform(t);n[s.array]=`${a} ${o}`}function G3(n,e,t){return typeof n=="string"?n:$t.transform(e+t*n)}function Vie(n,e,t){const r=G3(e,n.x,n.width),i=G3(t,n.y,n.height);return`${r} ${i}`}function _C(n,{attrX:e,attrY:t,attrScale:r,originX:i,originY:s,pathLength:a,pathSpacing:o=1,pathOffset:l=0,...c},h,f){if(xC(n,c,f),h){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:m,style:y,dimensions:x}=n;m.transform&&(x&&(y.transform=m.transform),delete m.transform),x&&(i!==void 0||s!==void 0||y.transform)&&(y.transformOrigin=Vie(x,i!==void 0?i:.5,s!==void 0?s:.5)),e!==void 0&&(m.x=e),t!==void 0&&(m.y=t),r!==void 0&&(m.scale=r),a!==void 0&&jie(m,a,o,l,!1)}const vC=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),Y9=()=>({...vC(),attrs:{}}),wC=n=>typeof n=="string"&&n.toLowerCase()==="svg";function Z9(n,{style:e,vars:t},r,i){Object.assign(n.style,e,i&&i.getProjectionStyles(r));for(const s in t)n.style.setProperty(s,t[s])}const J9=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function Q9(n,e,t,r){Z9(n,e,void 0,r);for(const i in e.attrs)n.setAttribute(J9.has(i)?i:dC(i),e.attrs[i])}const kv={};function Gie(n){Object.assign(kv,n)}function e7(n,{layout:e,layoutId:t}){return Dd.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!kv[n]||n==="opacity")}function EC(n,e,t){var r;const{style:i}=n,s={};for(const a in i)(cs(i[a])||e.style&&cs(e.style[a])||e7(a,n)||((r=t?.getValue(a))===null||r===void 0?void 0:r.liveStyle)!==void 0)&&(s[a]=i[a]);return s}function t7(n,e,t){const r=EC(n,e,t);for(const i in n)if(cs(n[i])||cs(e[i])){const s=pg.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;r[s]=n[i]}return r}function Bie(n,e){try{e.dimensions=typeof n.getBBox=="function"?n.getBBox():n.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const B3=["x","y","width","height","cx","cy","r"],zie={useVisualState:H9({scrapeMotionValuesFromProps:t7,createRenderState:Y9,onUpdate:({props:n,prevProps:e,current:t,renderState:r,latestValues:i})=>{if(!t)return;let s=!!n.drag;if(!s){for(const o in i)if(Dd.has(o)){s=!0;break}}if(!s)return;let a=!e;if(e)for(let o=0;o<B3.length;o++){const l=B3[o];n[l]!==e[l]&&(a=!0)}a&&gr.read(()=>{Bie(t,r),gr.render(()=>{_C(r,i,wC(t.tagName),n.transformTemplate),Q9(t,r)})})}})},Uie={useVisualState:H9({scrapeMotionValuesFromProps:EC,createRenderState:vC})};function n7(n,e,t){for(const r in e)!cs(e[r])&&!e7(r,t)&&(n[r]=e[r])}function $ie({transformTemplate:n},e){return X.useMemo(()=>{const t=vC();return xC(t,e,n),Object.assign({},t.vars,t.style)},[e])}function Wie(n,e){const t=n.style||{},r={};return n7(r,t,n),Object.assign(r,$ie(n,e)),r}function Hie(n,e){const t={},r=Wie(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=r,t}function Kie(n,e,t,r){const i=X.useMemo(()=>{const s=Y9();return _C(s,e,wC(r),n.transformTemplate),{...s.attrs,style:{...s.style}}},[e]);if(n.style){const s={};n7(s,n.style,n),i.style={...s,...i.style}}return i}function Xie(n=!1){return(t,r,i,{latestValues:s},a)=>{const l=(gC(t)?Kie:Hie)(r,s,a,t),c=cie(r,typeof t=="string",n),h=t!==X.Fragment?{...c,...l,ref:i}:{},{children:f}=r,m=X.useMemo(()=>cs(f)?f.get():f,[f]);return X.createElement(t,{...h,children:m})}}function qie(n,e){return function(r,{forwardMotionProps:i}={forwardMotionProps:!1}){const a={...gC(r)?zie:Uie,preloadedFeatures:n,useRender:Xie(i),createVisualElement:e,Component:r};return xie(a)}}function r7(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let r=0;r<t;r++)if(e[r]!==n[r])return!1;return!0}function IE(n,e,t){const r=n.getProps();return mC(r,e,t!==void 0?t:r.custom,n)}const Yie=cC(()=>window.ScrollTimeline!==void 0);class Zie{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,t){for(let r=0;r<this.animations.length;r++)this.animations[r][e]=t}attachTimeline(e,t){const r=this.animations.map(i=>{if(Yie()&&i.attachTimeline)return i.attachTimeline(e);if(typeof t=="function")return t(i)});return()=>{r.forEach((i,s)=>{i&&i(),this.animations[s].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let t=0;t<this.animations.length;t++)e=Math.max(e,this.animations[t].duration);return e}runAll(e){this.animations.forEach(t=>t[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class Jie extends Zie{then(e,t){return Promise.all(this.animations).then(e).catch(t)}}function TC(n,e){return n?n[e]||n.default||n:void 0}const mR=2e4;function i7(n){let e=0;const t=50;let r=n.next(e);for(;!r.done&&e<mR;)e+=t,r=n.next(e);return e>=mR?1/0:e}function SC(n){return typeof n=="function"}function z3(n,e){n.timeline=e,n.onfinish=null}const bC=n=>Array.isArray(n)&&typeof n[0]=="number",Qie={linearEasing:void 0};function ese(n,e){const t=cC(n);return()=>{var r;return(r=Qie[e])!==null&&r!==void 0?r:t()}}const Pv=ese(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),s7=(n,e,t=10)=>{let r="";const i=Math.max(Math.round(e/t),2);for(let s=0;s<i;s++)r+=n(Q0(0,i-1,s))+", ";return`linear(${r.substring(0,r.length-2)})`};function a7(n){return!!(typeof n=="function"&&Pv()||!n||typeof n=="string"&&(n in pR||Pv())||bC(n)||Array.isArray(n)&&n.every(a7))}const Pm=([n,e,t,r])=>`cubic-bezier(${n}, ${e}, ${t}, ${r})`,pR={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Pm([0,.65,.55,1]),circOut:Pm([.55,0,1,.45]),backIn:Pm([.31,.01,.66,-.59]),backOut:Pm([.33,1.53,.69,.99])};function o7(n,e){if(n)return typeof n=="function"&&Pv()?s7(n,e):bC(n)?Pm(n):Array.isArray(n)?n.map(t=>o7(t,e)||pR.easeOut):pR[n]}const oo={x:!1,y:!1};function l7(){return oo.x||oo.y}function tse(n,e,t){var r;if(n instanceof Element)return[n];if(typeof n=="string"){let i=document;const s=(r=void 0)!==null&&r!==void 0?r:i.querySelectorAll(n);return s?Array.from(s):[]}return Array.from(n)}function c7(n,e){const t=tse(n),r=new AbortController,i={passive:!0,...e,signal:r.signal};return[t,i,()=>r.abort()]}function U3(n){return e=>{e.pointerType==="touch"||l7()||n(e)}}function nse(n,e,t={}){const[r,i,s]=c7(n,t),a=U3(o=>{const{target:l}=o,c=e(o);if(typeof c!="function"||!l)return;const h=U3(f=>{c(f),l.removeEventListener("pointerleave",h)});l.addEventListener("pointerleave",h,i)});return r.forEach(o=>{o.addEventListener("pointerenter",a,i)}),s}const u7=(n,e)=>e?n===e?!0:u7(n,e.parentElement):!1,RC=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,rse=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function ise(n){return rse.has(n.tagName)||n.tabIndex!==-1}const Mm=new WeakSet;function $3(n){return e=>{e.key==="Enter"&&n(e)}}function vS(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const sse=(n,e)=>{const t=n.currentTarget;if(!t)return;const r=$3(()=>{if(Mm.has(t))return;vS(t,"down");const i=$3(()=>{vS(t,"up")}),s=()=>vS(t,"cancel");t.addEventListener("keyup",i,e),t.addEventListener("blur",s,e)});t.addEventListener("keydown",r,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",r),e)};function W3(n){return RC(n)&&!l7()}function ase(n,e,t={}){const[r,i,s]=c7(n,t),a=o=>{const l=o.currentTarget;if(!W3(o)||Mm.has(l))return;Mm.add(l);const c=e(o),h=(y,x)=>{window.removeEventListener("pointerup",f),window.removeEventListener("pointercancel",m),!(!W3(y)||!Mm.has(l))&&(Mm.delete(l),typeof c=="function"&&c(y,{success:x}))},f=y=>{h(y,t.useGlobalTarget||u7(l,y.target))},m=y=>{h(y,!1)};window.addEventListener("pointerup",f,i),window.addEventListener("pointercancel",m,i)};return r.forEach(o=>{!ise(o)&&o.getAttribute("tabindex")===null&&(o.tabIndex=0),(t.useGlobalTarget?window:o).addEventListener("pointerdown",a,i),o.addEventListener("focus",c=>sse(c,i),i)}),s}function ose(n){return n==="x"||n==="y"?oo[n]?null:(oo[n]=!0,()=>{oo[n]=!1}):oo.x||oo.y?null:(oo.x=oo.y=!0,()=>{oo.x=oo.y=!1})}const h7=new Set(["width","height","top","left","right","bottom",...pg]);let T_;function lse(){T_=void 0}const ll={now:()=>(T_===void 0&&ll.set(Bi.isProcessing||rie.useManualTiming?Bi.timestamp:performance.now()),T_),set:n=>{T_=n,queueMicrotask(lse)}};function AC(n,e){n.indexOf(e)===-1&&n.push(e)}function IC(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}class CC{constructor(){this.subscriptions=[]}add(e){return AC(this.subscriptions,e),()=>IC(this.subscriptions,e)}notify(e,t,r){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,t,r);else for(let s=0;s<i;s++){const a=this.subscriptions[s];a&&a(e,t,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function d7(n,e){return e?n*(1e3/e):0}const H3=30,cse=n=>!isNaN(parseFloat(n));class use{constructor(e,t={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(r,i=!0)=>{const s=ll.now();this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),i&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=ll.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=cse(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new CC);const r=this.events[e].add(t);return e==="change"?()=>{r(),gr.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e,t=!0){!t||!this.passiveEffect?this.updateAndNotify(e,t):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,t,r){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=ll.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>H3)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,H3);return d7(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Qp(n,e){return new use(n,e)}function hse(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,Qp(t))}function dse(n,e){const t=IE(n,e);let{transitionEnd:r={},transition:i={},...s}=t||{};s={...s,...r};for(const a in s){const o=Sie(s[a]);hse(n,a,o)}}function fse(n){return!!(cs(n)&&n.add)}function yR(n,e){const t=n.getValue("willChange");if(fse(t))return t.add(e)}function f7(n){return n.props[U9]}const g7=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,gse=1e-7,mse=12;function pse(n,e,t,r,i){let s,a,o=0;do a=e+(t-e)/2,s=g7(a,r,i)-n,s>0?t=a:e=a;while(Math.abs(s)>gse&&++o<mse);return a}function qy(n,e,t,r){if(n===e&&t===r)return fa;const i=s=>pse(s,0,1,n,t);return s=>s===0||s===1?s:g7(i(s),e,r)}const m7=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,p7=n=>e=>1-n(1-e),y7=qy(.33,1.53,.69,.99),kC=p7(y7),x7=m7(kC),_7=n=>(n*=2)<1?.5*kC(n):.5*(2-Math.pow(2,-10*(n-1))),PC=n=>1-Math.sin(Math.acos(n)),v7=p7(PC),w7=m7(PC),E7=n=>/^0[^.\s]+$/u.test(n);function yse(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||E7(n):!0}const Jm=n=>Math.round(n*1e5)/1e5,MC=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function xse(n){return n==null}const _se=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,NC=(n,e)=>t=>!!(typeof t=="string"&&_se.test(t)&&t.startsWith(n)||e&&!xse(t)&&Object.prototype.hasOwnProperty.call(t,e)),T7=(n,e,t)=>r=>{if(typeof r!="string")return r;const[i,s,a,o]=r.match(MC);return{[n]:parseFloat(i),[e]:parseFloat(s),[t]:parseFloat(a),alpha:o!==void 0?parseFloat(o):1}},vse=n=>cc(0,255,n),wS={...yg,transform:n=>Math.round(vse(n))},Wh={test:NC("rgb","red"),parse:T7("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:r=1})=>"rgba("+wS.transform(n)+", "+wS.transform(e)+", "+wS.transform(t)+", "+Jm(Jp.transform(r))+")"};function wse(n){let e="",t="",r="",i="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),r=n.substring(5,7),i=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),r=n.substring(3,4),i=n.substring(4,5),e+=e,t+=t,r+=r,i+=i),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}}const xR={test:NC("#"),parse:wse,transform:Wh.transform},s0={test:NC("hsl","hue"),parse:T7("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:r=1})=>"hsla("+Math.round(n)+", "+ol.transform(Jm(e))+", "+ol.transform(Jm(t))+", "+Jm(Jp.transform(r))+")"},is={test:n=>Wh.test(n)||xR.test(n)||s0.test(n),parse:n=>Wh.test(n)?Wh.parse(n):s0.test(n)?s0.parse(n):xR.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?Wh.transform(n):s0.transform(n)},Ese=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function Tse(n){var e,t;return isNaN(n)&&typeof n=="string"&&(((e=n.match(MC))===null||e===void 0?void 0:e.length)||0)+(((t=n.match(Ese))===null||t===void 0?void 0:t.length)||0)>0}const S7="number",b7="color",Sse="var",bse="var(",K3="${}",Rse=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function ey(n){const e=n.toString(),t=[],r={color:[],number:[],var:[]},i=[];let s=0;const o=e.replace(Rse,l=>(is.test(l)?(r.color.push(s),i.push(b7),t.push(is.parse(l))):l.startsWith(bse)?(r.var.push(s),i.push(Sse),t.push(l)):(r.number.push(s),i.push(S7),t.push(parseFloat(l))),++s,K3)).split(K3);return{values:t,split:o,indexes:r,types:i}}function R7(n){return ey(n).values}function A7(n){const{split:e,types:t}=ey(n),r=e.length;return i=>{let s="";for(let a=0;a<r;a++)if(s+=e[a],i[a]!==void 0){const o=t[a];o===S7?s+=Jm(i[a]):o===b7?s+=is.transform(i[a]):s+=i[a]}return s}}const Ase=n=>typeof n=="number"?0:n;function Ise(n){const e=R7(n);return A7(n)(e.map(Ase))}const ju={test:Tse,parse:R7,createTransformer:A7,getAnimatableNone:Ise},Cse=new Set(["brightness","contrast","saturate","opacity"]);function kse(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[r]=t.match(MC)||[];if(!r)return n;const i=t.replace(r,"");let s=Cse.has(e)?1:0;return r!==t&&(s*=100),e+"("+s+i+")"}const Pse=/\b([a-z-]*)\(.*?\)/gu,_R={...ju,getAnimatableNone:n=>{const e=n.match(Pse);return e?e.map(kse).join(" "):n}},Mse={...yC,color:is,backgroundColor:is,outlineColor:is,fill:is,stroke:is,borderColor:is,borderTopColor:is,borderRightColor:is,borderBottomColor:is,borderLeftColor:is,filter:_R,WebkitFilter:_R},LC=n=>Mse[n];function I7(n,e){let t=LC(n);return t!==_R&&(t=ju),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const Nse=new Set(["auto","none","0"]);function Lse(n,e,t){let r=0,i;for(;r<n.length&&!i;){const s=n[r];typeof s=="string"&&!Nse.has(s)&&ey(s).values.length&&(i=n[r]),r++}if(i&&t)for(const s of e)n[s]=I7(t,i)}const X3=n=>n===yg||n===$t,q3=(n,e)=>parseFloat(n.split(", ")[e]),Y3=(n,e)=>(t,{transform:r})=>{if(r==="none"||!r)return 0;const i=r.match(/^matrix3d\((.+)\)$/u);if(i)return q3(i[1],e);{const s=r.match(/^matrix\((.+)\)$/u);return s?q3(s[1],n):0}},Ose=new Set(["x","y","z"]),Dse=pg.filter(n=>!Ose.has(n));function Fse(n){const e=[];return Dse.forEach(t=>{const r=n.getValue(t);r!==void 0&&(e.push([t,r.get()]),r.set(t.startsWith("scale")?1:0))}),e}const tg={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:Y3(4,13),y:Y3(5,14)};tg.translateX=tg.x;tg.translateY=tg.y;const ed=new Set;let vR=!1,wR=!1;function C7(){if(wR){const n=Array.from(ed).filter(r=>r.needsMeasurement),e=new Set(n.map(r=>r.element)),t=new Map;e.forEach(r=>{const i=Fse(r);i.length&&(t.set(r,i),r.render())}),n.forEach(r=>r.measureInitialState()),e.forEach(r=>{r.render();const i=t.get(r);i&&i.forEach(([s,a])=>{var o;(o=r.getValue(s))===null||o===void 0||o.set(a)})}),n.forEach(r=>r.measureEndState()),n.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}wR=!1,vR=!1,ed.forEach(n=>n.complete()),ed.clear()}function k7(){ed.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(wR=!0)})}function jse(){k7(),C7()}class OC{constructor(e,t,r,i,s,a=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=r,this.motionValue=i,this.element=s,this.isAsync=a}scheduleResolve(){this.isScheduled=!0,this.isAsync?(ed.add(this),vR||(vR=!0,gr.read(k7),gr.resolveKeyframes(C7))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:r,motionValue:i}=this;for(let s=0;s<e.length;s++)if(e[s]===null)if(s===0){const a=i?.get(),o=e[e.length-1];if(a!==void 0)e[0]=a;else if(r&&t){const l=r.readValue(t,o);l!=null&&(e[0]=l)}e[0]===void 0&&(e[0]=o),i&&a===void 0&&i.set(e[0])}else e[s]=e[s-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),ed.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,ed.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const P7=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n),Vse=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Gse(n){const e=Vse.exec(n);if(!e)return[,];const[,t,r,i]=e;return[`--${t??r}`,i]}function M7(n,e,t=1){const[r,i]=Gse(n);if(!r)return;const s=window.getComputedStyle(e).getPropertyValue(r);if(s){const a=s.trim();return P7(a)?parseFloat(a):a}return pC(i)?M7(i,e,t+1):i}const N7=n=>e=>e.test(n),Bse={test:n=>n==="auto",parse:n=>n},L7=[yg,$t,ol,tu,kie,Cie,Bse],Z3=n=>L7.find(N7(n));class O7 extends OC{constructor(e,t,r,i,s){super(e,t,r,i,s,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:r}=this;if(!t||!t.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let c=e[l];if(typeof c=="string"&&(c=c.trim(),pC(c))){const h=M7(c,t.current);h!==void 0&&(e[l]=h),l===e.length-1&&(this.finalKeyframe=c)}}if(this.resolveNoneKeyframes(),!h7.has(r)||e.length!==2)return;const[i,s]=e,a=Z3(i),o=Z3(s);if(a!==o)if(X3(a)&&X3(o))for(let l=0;l<e.length;l++){const c=e[l];typeof c=="string"&&(e[l]=parseFloat(c))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,r=[];for(let i=0;i<e.length;i++)yse(e[i])&&r.push(i);r.length&&Lse(e,r,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:r}=this;if(!e||!e.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=tg[r](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const i=t[t.length-1];i!==void 0&&e.getValue(r,i).jump(i,!1)}measureEndState(){var e;const{element:t,name:r,unresolvedKeyframes:i}=this;if(!t||!t.current)return;const s=t.getValue(r);s&&s.jump(this.measuredOrigin,!1);const a=i.length-1,o=i[a];i[a]=tg[r](t.measureViewportBox(),window.getComputedStyle(t.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([l,c])=>{t.getValue(l).set(c)}),this.resolveNoneKeyframes()}}const J3=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(ju.test(n)||n==="0")&&!n.startsWith("url("));function zse(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function Use(n,e,t,r){const i=n[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const s=n[n.length-1],a=J3(i,e),o=J3(s,e);return!a||!o?!1:zse(n)||(t==="spring"||SC(t))&&r}const $se=n=>n!==null;function CE(n,{repeat:e,repeatType:t="loop"},r){const i=n.filter($se),s=e&&t!=="loop"&&e%2===1?0:i.length-1;return!s||r===void 0?i[s]:r}const Wse=40;class D7{constructor({autoplay:e=!0,delay:t=0,type:r="keyframes",repeat:i=0,repeatDelay:s=0,repeatType:a="loop",...o}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=ll.now(),this.options={autoplay:e,delay:t,type:r,repeat:i,repeatDelay:s,repeatType:a,...o},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>Wse?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&jse(),this._resolved}onKeyframesResolved(e,t){this.resolvedAt=ll.now(),this.hasAttemptedResolve=!0;const{name:r,type:i,velocity:s,delay:a,onComplete:o,onUpdate:l,isGenerator:c}=this.options;if(!c&&!Use(e,r,i,s))if(a)this.options.duration=0;else{l&&l(CE(e,this.options,t)),o&&o(),this.resolveFinishedPromise();return}const h=this.initPlayback(e,t);h!==!1&&(this._resolved={keyframes:e,finalKeyframe:t,...h},this.onPostResolved())}onPostResolved(){}then(e,t){return this.currentFinishedPromise.then(e,t)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const Mr=(n,e,t)=>n+(e-n)*t;function ES(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function Hse({hue:n,saturation:e,lightness:t,alpha:r}){n/=360,e/=100,t/=100;let i=0,s=0,a=0;if(!e)i=s=a=t;else{const o=t<.5?t*(1+e):t+e-t*e,l=2*t-o;i=ES(l,o,n+1/3),s=ES(l,o,n),a=ES(l,o,n-1/3)}return{red:Math.round(i*255),green:Math.round(s*255),blue:Math.round(a*255),alpha:r}}function Mv(n,e){return t=>t>0?e:n}const TS=(n,e,t)=>{const r=n*n,i=t*(e*e-r)+r;return i<0?0:Math.sqrt(i)},Kse=[xR,Wh,s0],Xse=n=>Kse.find(e=>e.test(n));function Q3(n){const e=Xse(n);if(!e)return!1;let t=e.parse(n);return e===s0&&(t=Hse(t)),t}const eO=(n,e)=>{const t=Q3(n),r=Q3(e);if(!t||!r)return Mv(n,e);const i={...t};return s=>(i.red=TS(t.red,r.red,s),i.green=TS(t.green,r.green,s),i.blue=TS(t.blue,r.blue,s),i.alpha=Mr(t.alpha,r.alpha,s),Wh.transform(i))},qse=(n,e)=>t=>e(n(t)),Yy=(...n)=>n.reduce(qse),ER=new Set(["none","hidden"]);function Yse(n,e){return ER.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function Zse(n,e){return t=>Mr(n,e,t)}function DC(n){return typeof n=="number"?Zse:typeof n=="string"?pC(n)?Mv:is.test(n)?eO:eae:Array.isArray(n)?F7:typeof n=="object"?is.test(n)?eO:Jse:Mv}function F7(n,e){const t=[...n],r=t.length,i=n.map((s,a)=>DC(s)(s,e[a]));return s=>{for(let a=0;a<r;a++)t[a]=i[a](s);return t}}function Jse(n,e){const t={...n,...e},r={};for(const i in t)n[i]!==void 0&&e[i]!==void 0&&(r[i]=DC(n[i])(n[i],e[i]));return i=>{for(const s in r)t[s]=r[s](i);return t}}function Qse(n,e){var t;const r=[],i={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const a=e.types[s],o=n.indexes[a][i[a]],l=(t=n.values[o])!==null&&t!==void 0?t:0;r[s]=l,i[a]++}return r}const eae=(n,e)=>{const t=ju.createTransformer(e),r=ey(n),i=ey(e);return r.indexes.var.length===i.indexes.var.length&&r.indexes.color.length===i.indexes.color.length&&r.indexes.number.length>=i.indexes.number.length?ER.has(n)&&!i.values.length||ER.has(e)&&!r.values.length?Yse(n,e):Yy(F7(Qse(r,i),i.values),t):Mv(n,e)};function j7(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?Mr(n,e,t):DC(n)(n,e)}const tae=5;function V7(n,e,t){const r=Math.max(e-tae,0);return d7(t-n(r),e-r)}const Fr={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},SS=.001;function nae({duration:n=Fr.duration,bounce:e=Fr.bounce,velocity:t=Fr.velocity,mass:r=Fr.mass}){let i,s,a=1-e;a=cc(Fr.minDamping,Fr.maxDamping,a),n=cc(Fr.minDuration,Fr.maxDuration,Ql(n)),a<1?(i=c=>{const h=c*a,f=h*n,m=h-t,y=TR(c,a),x=Math.exp(-f);return SS-m/y*x},s=c=>{const f=c*a*n,m=f*t+t,y=Math.pow(a,2)*Math.pow(c,2)*n,x=Math.exp(-f),_=TR(Math.pow(c,2),a);return(-i(c)+SS>0?-1:1)*((m-y)*x)/_}):(i=c=>{const h=Math.exp(-c*n),f=(c-t)*n+1;return-SS+h*f},s=c=>{const h=Math.exp(-c*n),f=(t-c)*(n*n);return h*f});const o=5/n,l=iae(i,s,o);if(n=Jl(n),isNaN(l))return{stiffness:Fr.stiffness,damping:Fr.damping,duration:n};{const c=Math.pow(l,2)*r;return{stiffness:c,damping:a*2*Math.sqrt(r*c),duration:n}}}const rae=12;function iae(n,e,t){let r=t;for(let i=1;i<rae;i++)r=r-n(r)/e(r);return r}function TR(n,e){return n*Math.sqrt(1-e*e)}const sae=["duration","bounce"],aae=["stiffness","damping","mass"];function tO(n,e){return e.some(t=>n[t]!==void 0)}function oae(n){let e={velocity:Fr.velocity,stiffness:Fr.stiffness,damping:Fr.damping,mass:Fr.mass,isResolvedFromDuration:!1,...n};if(!tO(n,aae)&&tO(n,sae))if(n.visualDuration){const t=n.visualDuration,r=2*Math.PI/(t*1.2),i=r*r,s=2*cc(.05,1,1-(n.bounce||0))*Math.sqrt(i);e={...e,mass:Fr.mass,stiffness:i,damping:s}}else{const t=nae(n);e={...e,...t,mass:Fr.mass},e.isResolvedFromDuration=!0}return e}function G7(n=Fr.visualDuration,e=Fr.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:r,restDelta:i}=t;const s=t.keyframes[0],a=t.keyframes[t.keyframes.length-1],o={done:!1,value:s},{stiffness:l,damping:c,mass:h,duration:f,velocity:m,isResolvedFromDuration:y}=oae({...t,velocity:-Ql(t.velocity||0)}),x=m||0,_=c/(2*Math.sqrt(l*h)),w=a-s,S=Ql(Math.sqrt(l/h)),b=Math.abs(w)<5;r||(r=b?Fr.restSpeed.granular:Fr.restSpeed.default),i||(i=b?Fr.restDelta.granular:Fr.restDelta.default);let R;if(_<1){const O=TR(S,_);R=G=>{const A=Math.exp(-_*S*G);return a-A*((x+_*S*w)/O*Math.sin(O*G)+w*Math.cos(O*G))}}else if(_===1)R=O=>a-Math.exp(-S*O)*(w+(x+S*w)*O);else{const O=S*Math.sqrt(_*_-1);R=G=>{const A=Math.exp(-_*S*G),I=Math.min(O*G,300);return a-A*((x+_*S*w)*Math.sinh(I)+O*w*Math.cosh(I))/O}}const M={calculatedDuration:y&&f||null,next:O=>{const G=R(O);if(y)o.done=O>=f;else{let A=0;_<1&&(A=O===0?Jl(x):V7(R,O,G));const I=Math.abs(A)<=r,P=Math.abs(a-G)<=i;o.done=I&&P}return o.value=o.done?a:G,o},toString:()=>{const O=Math.min(i7(M),mR),G=s7(A=>M.next(O*A).value,O,30);return O+"ms "+G}};return M}function nO({keyframes:n,velocity:e=0,power:t=.8,timeConstant:r=325,bounceDamping:i=10,bounceStiffness:s=500,modifyTarget:a,min:o,max:l,restDelta:c=.5,restSpeed:h}){const f=n[0],m={done:!1,value:f},y=I=>o!==void 0&&I<o||l!==void 0&&I>l,x=I=>o===void 0?l:l===void 0||Math.abs(o-I)<Math.abs(l-I)?o:l;let _=t*e;const w=f+_,S=a===void 0?w:a(w);S!==w&&(_=S-f);const b=I=>-_*Math.exp(-I/r),R=I=>S+b(I),M=I=>{const P=b(I),D=R(I);m.done=Math.abs(P)<=c,m.value=m.done?S:D};let O,G;const A=I=>{y(m.value)&&(O=I,G=G7({keyframes:[m.value,x(m.value)],velocity:V7(R,I,m.value),damping:i,stiffness:s,restDelta:c,restSpeed:h}))};return A(0),{calculatedDuration:null,next:I=>{let P=!1;return!G&&O===void 0&&(P=!0,M(I),A(I)),O!==void 0&&I>=O?G.next(I-O):(!P&&M(I),m)}}}const lae=qy(.42,0,1,1),cae=qy(0,0,.58,1),B7=qy(.42,0,.58,1),uae=n=>Array.isArray(n)&&typeof n[0]!="number",hae={linear:fa,easeIn:lae,easeInOut:B7,easeOut:cae,circIn:PC,circInOut:w7,circOut:v7,backIn:kC,backInOut:x7,backOut:y7,anticipate:_7},rO=n=>{if(bC(n)){j9(n.length===4);const[e,t,r,i]=n;return qy(e,t,r,i)}else if(typeof n=="string")return hae[n];return n};function dae(n,e,t){const r=[],i=t||j7,s=n.length-1;for(let a=0;a<s;a++){let o=i(n[a],n[a+1]);if(e){const l=Array.isArray(e)?e[a]||fa:e;o=Yy(l,o)}r.push(o)}return r}function fae(n,e,{clamp:t=!0,ease:r,mixer:i}={}){const s=n.length;if(j9(s===e.length),s===1)return()=>e[0];if(s===2&&e[0]===e[1])return()=>e[1];const a=n[0]===n[1];n[0]>n[s-1]&&(n=[...n].reverse(),e=[...e].reverse());const o=dae(e,r,i),l=o.length,c=h=>{if(a&&h<n[0])return e[0];let f=0;if(l>1)for(;f<n.length-2&&!(h<n[f+1]);f++);const m=Q0(n[f],n[f+1],h);return o[f](m)};return t?h=>c(cc(n[0],n[s-1],h)):c}function gae(n,e){const t=n[n.length-1];for(let r=1;r<=e;r++){const i=Q0(0,e,r);n.push(Mr(t,1,i))}}function mae(n){const e=[0];return gae(e,n.length-1),e}function pae(n,e){return n.map(t=>t*e)}function yae(n,e){return n.map(()=>e||B7).splice(0,n.length-1)}function Nv({duration:n=300,keyframes:e,times:t,ease:r="easeInOut"}){const i=uae(r)?r.map(rO):rO(r),s={done:!1,value:e[0]},a=pae(t&&t.length===e.length?t:mae(e),n),o=fae(a,e,{ease:Array.isArray(i)?i:yae(e,i)});return{calculatedDuration:n,next:l=>(s.value=o(l),s.done=l>=n,s)}}const xae=n=>{const e=({timestamp:t})=>n(t);return{start:()=>gr.update(e,!0),stop:()=>Fu(e),now:()=>Bi.isProcessing?Bi.timestamp:ll.now()}},_ae={decay:nO,inertia:nO,tween:Nv,keyframes:Nv,spring:G7},vae=n=>n/100;class FC extends D7{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:l}=this.options;l&&l()};const{name:t,motionValue:r,element:i,keyframes:s}=this.options,a=i?.KeyframeResolver||OC,o=(l,c)=>this.onKeyframesResolved(l,c);this.resolver=new a(s,o,t,r,i),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:t="keyframes",repeat:r=0,repeatDelay:i=0,repeatType:s,velocity:a=0}=this.options,o=SC(t)?t:_ae[t]||Nv;let l,c;o!==Nv&&typeof e[0]!="number"&&(l=Yy(vae,j7(e[0],e[1])),e=[0,100]);const h=o({...this.options,keyframes:e});s==="mirror"&&(c=o({...this.options,keyframes:[...e].reverse(),velocity:-a})),h.calculatedDuration===null&&(h.calculatedDuration=i7(h));const{calculatedDuration:f}=h,m=f+i,y=m*(r+1)-i;return{generator:h,mirroredGenerator:c,mapPercentToKeyframes:l,calculatedDuration:f,resolvedDuration:m,totalDuration:y}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,t=!1){const{resolved:r}=this;if(!r){const{keyframes:I}=this.options;return{done:!0,value:I[I.length-1]}}const{finalKeyframe:i,generator:s,mirroredGenerator:a,mapPercentToKeyframes:o,keyframes:l,calculatedDuration:c,totalDuration:h,resolvedDuration:f}=r;if(this.startTime===null)return s.next(0);const{delay:m,repeat:y,repeatType:x,repeatDelay:_,onUpdate:w}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-h/this.speed,this.startTime)),t?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const S=this.currentTime-m*(this.speed>=0?1:-1),b=this.speed>=0?S<0:S>h;this.currentTime=Math.max(S,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=h);let R=this.currentTime,M=s;if(y){const I=Math.min(this.currentTime,h)/f;let P=Math.floor(I),D=I%1;!D&&I>=1&&(D=1),D===1&&P--,P=Math.min(P,y+1),P%2&&(x==="reverse"?(D=1-D,_&&(D-=_/f)):x==="mirror"&&(M=a)),R=cc(0,1,D)*f}const O=b?{done:!1,value:l[0]}:M.next(R);o&&(O.value=o(O.value));let{done:G}=O;!b&&c!==null&&(G=this.speed>=0?this.currentTime>=h:this.currentTime<=0);const A=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&G);return A&&i!==void 0&&(O.value=CE(l,this.options,i)),w&&w(O.value),A&&this.finish(),O}get duration(){const{resolved:e}=this;return e?Ql(e.calculatedDuration):0}get time(){return Ql(this.currentTime)}set time(e){e=Jl(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=Ql(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=xae,onPlay:t,startTime:r}=this.options;this.driver||(this.driver=e(s=>this.tick(s))),t&&t();const i=this.driver.now();this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=i):this.startTime=r??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const wae=new Set(["opacity","clipPath","filter","transform"]);function Eae(n,e,t,{delay:r=0,duration:i=300,repeat:s=0,repeatType:a="loop",ease:o="easeInOut",times:l}={}){const c={[e]:t};l&&(c.offset=l);const h=o7(o,i);return Array.isArray(h)&&(c.easing=h),n.animate(c,{delay:r,duration:i,easing:Array.isArray(h)?"linear":h,fill:"both",iterations:s+1,direction:a==="reverse"?"alternate":"normal"})}const Tae=cC(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Lv=10,Sae=2e4;function bae(n){return SC(n.type)||n.type==="spring"||!a7(n.ease)}function Rae(n,e){const t=new FC({...e,keyframes:n,repeat:0,delay:0,isGenerator:!0});let r={done:!1,value:n[0]};const i=[];let s=0;for(;!r.done&&s<Sae;)r=t.sample(s),i.push(r.value),s+=Lv;return{times:void 0,keyframes:i,duration:s-Lv,ease:"linear"}}const z7={anticipate:_7,backInOut:x7,circInOut:w7};function Aae(n){return n in z7}class iO extends D7{constructor(e){super(e);const{name:t,motionValue:r,element:i,keyframes:s}=this.options;this.resolver=new O7(s,(a,o)=>this.onKeyframesResolved(a,o),t,r,i),this.resolver.scheduleResolve()}initPlayback(e,t){let{duration:r=300,times:i,ease:s,type:a,motionValue:o,name:l,startTime:c}=this.options;if(!o.owner||!o.owner.current)return!1;if(typeof s=="string"&&Pv()&&Aae(s)&&(s=z7[s]),bae(this.options)){const{onComplete:f,onUpdate:m,motionValue:y,element:x,..._}=this.options,w=Rae(e,_);e=w.keyframes,e.length===1&&(e[1]=e[0]),r=w.duration,i=w.times,s=w.ease,a="keyframes"}const h=Eae(o.owner.current,l,e,{...this.options,duration:r,times:i,ease:s});return h.startTime=c??this.calcStartTime(),this.pendingTimeline?(z3(h,this.pendingTimeline),this.pendingTimeline=void 0):h.onfinish=()=>{const{onComplete:f}=this.options;o.set(CE(e,this.options,t)),f&&f(),this.cancel(),this.resolveFinishedPromise()},{animation:h,duration:r,times:i,type:a,ease:s,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:t}=e;return Ql(t)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:t}=e;return Ql(t.currentTime||0)}set time(e){const{resolved:t}=this;if(!t)return;const{animation:r}=t;r.currentTime=Jl(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:t}=e;return t.playbackRate}set speed(e){const{resolved:t}=this;if(!t)return;const{animation:r}=t;r.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:t}=e;return t.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:t}=e;return t.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:t}=this;if(!t)return fa;const{animation:r}=t;z3(r,e)}return fa}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.playState==="finished"&&this.updateFinishedPromise(),t.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:t,keyframes:r,duration:i,type:s,ease:a,times:o}=e;if(t.playState==="idle"||t.playState==="finished")return;if(this.time){const{motionValue:c,onUpdate:h,onComplete:f,element:m,...y}=this.options,x=new FC({...y,keyframes:r,duration:i,type:s,ease:a,times:o,isGenerator:!0}),_=Jl(this.time);c.setWithVelocity(x.sample(_-Lv).value,x.sample(_).value,Lv)}const{onStop:l}=this.options;l&&l(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:t,name:r,repeatDelay:i,repeatType:s,damping:a,type:o}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:c}=t.owner.getProps();return Tae()&&r&&wae.has(r)&&!l&&!c&&!i&&s!=="mirror"&&a!==0&&o!=="inertia"}}const Iae={type:"spring",stiffness:500,damping:25,restSpeed:10},Cae=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),kae={type:"keyframes",duration:.8},Pae={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Mae=(n,{keyframes:e})=>e.length>2?kae:Dd.has(n)?n.startsWith("scale")?Cae(e[1]):Iae:Pae;function Nae({when:n,delay:e,delayChildren:t,staggerChildren:r,staggerDirection:i,repeat:s,repeatType:a,repeatDelay:o,from:l,elapsed:c,...h}){return!!Object.keys(h).length}const jC=(n,e,t,r={},i,s)=>a=>{const o=TC(r,n)||{},l=o.delay||r.delay||0;let{elapsed:c=0}=r;c=c-Jl(l);let h={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...o,delay:-c,onUpdate:m=>{e.set(m),o.onUpdate&&o.onUpdate(m)},onComplete:()=>{a(),o.onComplete&&o.onComplete()},name:n,motionValue:e,element:s?void 0:i};Nae(o)||(h={...h,...Mae(n,h)}),h.duration&&(h.duration=Jl(h.duration)),h.repeatDelay&&(h.repeatDelay=Jl(h.repeatDelay)),h.from!==void 0&&(h.keyframes[0]=h.from);let f=!1;if((h.type===!1||h.duration===0&&!h.repeatDelay)&&(h.duration=0,h.delay===0&&(f=!0)),f&&!s&&e.get()!==void 0){const m=CE(h.keyframes,o);if(m!==void 0)return gr.update(()=>{h.onUpdate(m),h.onComplete()}),new Jie([])}return!s&&iO.supports(h)?new iO(h):new FC(h)};function Lae({protectedKeys:n,needsAnimating:e},t){const r=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,r}function U7(n,e,{delay:t=0,transitionOverride:r,type:i}={}){var s;let{transition:a=n.getDefaultTransition(),transitionEnd:o,...l}=e;r&&(a=r);const c=[],h=i&&n.animationState&&n.animationState.getState()[i];for(const f in l){const m=n.getValue(f,(s=n.latestValues[f])!==null&&s!==void 0?s:null),y=l[f];if(y===void 0||h&&Lae(h,f))continue;const x={delay:t,...TC(a||{},f)};let _=!1;if(window.MotionHandoffAnimation){const S=f7(n);if(S){const b=window.MotionHandoffAnimation(S,f,gr);b!==null&&(x.startTime=b,_=!0)}}yR(n,f),m.start(jC(f,m,y,n.shouldReduceMotion&&h7.has(f)?{type:!1}:x,n,_));const w=m.animation;w&&c.push(w)}return o&&Promise.all(c).then(()=>{gr.update(()=>{o&&dse(n,o)})}),c}function SR(n,e,t={}){var r;const i=IE(n,e,t.type==="exit"?(r=n.presenceContext)===null||r===void 0?void 0:r.custom:void 0);let{transition:s=n.getDefaultTransition()||{}}=i||{};t.transitionOverride&&(s=t.transitionOverride);const a=i?()=>Promise.all(U7(n,i,t)):()=>Promise.resolve(),o=n.variantChildren&&n.variantChildren.size?(c=0)=>{const{delayChildren:h=0,staggerChildren:f,staggerDirection:m}=s;return Oae(n,e,h+c,f,m,t)}:()=>Promise.resolve(),{when:l}=s;if(l){const[c,h]=l==="beforeChildren"?[a,o]:[o,a];return c().then(()=>h())}else return Promise.all([a(),o(t.delay)])}function Oae(n,e,t=0,r=0,i=1,s){const a=[],o=(n.variantChildren.size-1)*r,l=i===1?(c=0)=>c*r:(c=0)=>o-c*r;return Array.from(n.variantChildren).sort(Dae).forEach((c,h)=>{c.notify("AnimationStart",e),a.push(SR(c,e,{...s,delay:t+l(h)}).then(()=>c.notify("AnimationComplete",e)))}),Promise.all(a)}function Dae(n,e){return n.sortNodePosition(e)}function Fae(n,e,t={}){n.notify("AnimationStart",e);let r;if(Array.isArray(e)){const i=e.map(s=>SR(n,s,t));r=Promise.all(i)}else if(typeof e=="string")r=SR(n,e,t);else{const i=typeof e=="function"?IE(n,e,t.custom):e;r=Promise.all(U7(n,i,t))}return r.then(()=>{n.notify("AnimationComplete",e)})}const jae=hC.length;function $7(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?$7(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<jae;t++){const r=hC[t],i=n.props[r];(Zp(i)||i===!1)&&(e[r]=i)}return e}const Vae=[...uC].reverse(),Gae=uC.length;function Bae(n){return e=>Promise.all(e.map(({animation:t,options:r})=>Fae(n,t,r)))}function zae(n){let e=Bae(n),t=sO(),r=!0;const i=l=>(c,h)=>{var f;const m=IE(n,h,l==="exit"?(f=n.presenceContext)===null||f===void 0?void 0:f.custom:void 0);if(m){const{transition:y,transitionEnd:x,..._}=m;c={...c,..._,...x}}return c};function s(l){e=l(n)}function a(l){const{props:c}=n,h=$7(n.parent)||{},f=[],m=new Set;let y={},x=1/0;for(let w=0;w<Gae;w++){const S=Vae[w],b=t[S],R=c[S]!==void 0?c[S]:h[S],M=Zp(R),O=S===l?b.isActive:null;O===!1&&(x=w);let G=R===h[S]&&R!==c[S]&&M;if(G&&r&&n.manuallyAnimateOnMount&&(G=!1),b.protectedKeys={...y},!b.isActive&&O===null||!R&&!b.prevProp||RE(R)||typeof R=="boolean")continue;const A=Uae(b.prevProp,R);let I=A||S===l&&b.isActive&&!G&&M||w>x&&M,P=!1;const D=Array.isArray(R)?R:[R];let L=D.reduce(i(S),{});O===!1&&(L={});const{prevResolvedValues:U={}}=b,j={...U,...L},Ee=Me=>{I=!0,m.has(Me)&&(P=!0,m.delete(Me)),b.needsAnimating[Me]=!0;const ce=n.getValue(Me);ce&&(ce.liveStyle=!1)};for(const Me in j){const ce=L[Me],Pe=U[Me];if(y.hasOwnProperty(Me))continue;let be=!1;gR(ce)&&gR(Pe)?be=!r7(ce,Pe):be=ce!==Pe,be?ce!=null?Ee(Me):m.add(Me):ce!==void 0&&m.has(Me)?Ee(Me):b.protectedKeys[Me]=!0}b.prevProp=R,b.prevResolvedValues=L,b.isActive&&(y={...y,...L}),r&&n.blockInitialAnimation&&(I=!1),I&&(!(G&&A)||P)&&f.push(...D.map(Me=>({animation:Me,options:{type:S}})))}if(m.size){const w={};m.forEach(S=>{const b=n.getBaseTarget(S),R=n.getValue(S);R&&(R.liveStyle=!0),w[S]=b??null}),f.push({animation:w})}let _=!!f.length;return r&&(c.initial===!1||c.initial===c.animate)&&!n.manuallyAnimateOnMount&&(_=!1),r=!1,_?e(f):Promise.resolve()}function o(l,c){var h;if(t[l].isActive===c)return Promise.resolve();(h=n.variantChildren)===null||h===void 0||h.forEach(m=>{var y;return(y=m.animationState)===null||y===void 0?void 0:y.setActive(l,c)}),t[l].isActive=c;const f=a(l);for(const m in t)t[m].protectedKeys={};return f}return{animateChanges:a,setActive:o,setAnimateFunction:s,getState:()=>t,reset:()=>{t=sO(),r=!0}}}function Uae(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!r7(e,n):!1}function Eh(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function sO(){return{animate:Eh(!0),whileInView:Eh(),whileHover:Eh(),whileTap:Eh(),whileDrag:Eh(),whileFocus:Eh(),exit:Eh()}}class qu{constructor(e){this.isMounted=!1,this.node=e}update(){}}class $ae extends qu{constructor(e){super(e),e.animationState||(e.animationState=zae(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();RE(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let Wae=0;class Hae extends qu{constructor(){super(...arguments),this.id=Wae++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const i=this.node.animationState.setActive("exit",!e);t&&!e&&i.then(()=>t(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const Kae={animation:{Feature:$ae},exit:{Feature:Hae}};function ty(n,e,t,r={passive:!0}){return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t)}function Zy(n){return{point:{x:n.pageX,y:n.pageY}}}const Xae=n=>e=>RC(e)&&n(e,Zy(e));function Qm(n,e,t,r){return ty(n,e,Xae(t),r)}const aO=(n,e)=>Math.abs(n-e);function qae(n,e){const t=aO(n.x,e.x),r=aO(n.y,e.y);return Math.sqrt(t**2+r**2)}class W7{constructor(e,t,{transformPagePoint:r,contextWindow:i,dragSnapToOrigin:s=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const f=RS(this.lastMoveEventInfo,this.history),m=this.startEvent!==null,y=qae(f.offset,{x:0,y:0})>=3;if(!m&&!y)return;const{point:x}=f,{timestamp:_}=Bi;this.history.push({...x,timestamp:_});const{onStart:w,onMove:S}=this.handlers;m||(w&&w(this.lastMoveEvent,f),this.startEvent=this.lastMoveEvent),S&&S(this.lastMoveEvent,f)},this.handlePointerMove=(f,m)=>{this.lastMoveEvent=f,this.lastMoveEventInfo=bS(m,this.transformPagePoint),gr.update(this.updatePoint,!0)},this.handlePointerUp=(f,m)=>{this.end();const{onEnd:y,onSessionEnd:x,resumeAnimation:_}=this.handlers;if(this.dragSnapToOrigin&&_&&_(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const w=RS(f.type==="pointercancel"?this.lastMoveEventInfo:bS(m,this.transformPagePoint),this.history);this.startEvent&&y&&y(f,w),x&&x(f,w)},!RC(e))return;this.dragSnapToOrigin=s,this.handlers=t,this.transformPagePoint=r,this.contextWindow=i||window;const a=Zy(e),o=bS(a,this.transformPagePoint),{point:l}=o,{timestamp:c}=Bi;this.history=[{...l,timestamp:c}];const{onSessionStart:h}=t;h&&h(e,RS(o,this.history)),this.removeListeners=Yy(Qm(this.contextWindow,"pointermove",this.handlePointerMove),Qm(this.contextWindow,"pointerup",this.handlePointerUp),Qm(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Fu(this.updatePoint)}}function bS(n,e){return e?{point:e(n.point)}:n}function oO(n,e){return{x:n.x-e.x,y:n.y-e.y}}function RS({point:n},e){return{point:n,delta:oO(n,H7(e)),offset:oO(n,Yae(e)),velocity:Zae(e,.1)}}function Yae(n){return n[0]}function H7(n){return n[n.length-1]}function Zae(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,r=null;const i=H7(n);for(;t>=0&&(r=n[t],!(i.timestamp-r.timestamp>Jl(e)));)t--;if(!r)return{x:0,y:0};const s=Ql(i.timestamp-r.timestamp);if(s===0)return{x:0,y:0};const a={x:(i.x-r.x)/s,y:(i.y-r.y)/s};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}const K7=1e-4,Jae=1-K7,Qae=1+K7,X7=.01,eoe=0-X7,toe=0+X7;function pa(n){return n.max-n.min}function noe(n,e,t){return Math.abs(n-e)<=t}function lO(n,e,t,r=.5){n.origin=r,n.originPoint=Mr(e.min,e.max,n.origin),n.scale=pa(t)/pa(e),n.translate=Mr(t.min,t.max,n.origin)-n.originPoint,(n.scale>=Jae&&n.scale<=Qae||isNaN(n.scale))&&(n.scale=1),(n.translate>=eoe&&n.translate<=toe||isNaN(n.translate))&&(n.translate=0)}function ep(n,e,t,r){lO(n.x,e.x,t.x,r?r.originX:void 0),lO(n.y,e.y,t.y,r?r.originY:void 0)}function cO(n,e,t){n.min=t.min+e.min,n.max=n.min+pa(e)}function roe(n,e,t){cO(n.x,e.x,t.x),cO(n.y,e.y,t.y)}function uO(n,e,t){n.min=e.min-t.min,n.max=n.min+pa(e)}function tp(n,e,t){uO(n.x,e.x,t.x),uO(n.y,e.y,t.y)}function ioe(n,{min:e,max:t},r){return e!==void 0&&n<e?n=r?Mr(e,n,r.min):Math.max(n,e):t!==void 0&&n>t&&(n=r?Mr(t,n,r.max):Math.min(n,t)),n}function hO(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function soe(n,{top:e,left:t,bottom:r,right:i}){return{x:hO(n.x,t,i),y:hO(n.y,e,r)}}function dO(n,e){let t=e.min-n.min,r=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,r]=[r,t]),{min:t,max:r}}function aoe(n,e){return{x:dO(n.x,e.x),y:dO(n.y,e.y)}}function ooe(n,e){let t=.5;const r=pa(n),i=pa(e);return i>r?t=Q0(e.min,e.max-r,n.min):r>i&&(t=Q0(n.min,n.max-i,e.min)),cc(0,1,t)}function loe(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const bR=.35;function coe(n=bR){return n===!1?n=0:n===!0&&(n=bR),{x:fO(n,"left","right"),y:fO(n,"top","bottom")}}function fO(n,e,t){return{min:gO(n,e),max:gO(n,t)}}function gO(n,e){return typeof n=="number"?n:n[e]||0}const mO=()=>({translate:0,scale:1,origin:0,originPoint:0}),a0=()=>({x:mO(),y:mO()}),pO=()=>({min:0,max:0}),$r=()=>({x:pO(),y:pO()});function ka(n){return[n("x"),n("y")]}function q7({top:n,left:e,right:t,bottom:r}){return{x:{min:e,max:t},y:{min:n,max:r}}}function uoe({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function hoe(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),r=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:r.y,right:r.x}}function AS(n){return n===void 0||n===1}function RR({scale:n,scaleX:e,scaleY:t}){return!AS(n)||!AS(e)||!AS(t)}function Ch(n){return RR(n)||Y7(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function Y7(n){return yO(n.x)||yO(n.y)}function yO(n){return n&&n!=="0%"}function Ov(n,e,t){const r=n-t,i=e*r;return t+i}function xO(n,e,t,r,i){return i!==void 0&&(n=Ov(n,i,r)),Ov(n,t,r)+e}function AR(n,e=0,t=1,r,i){n.min=xO(n.min,e,t,r,i),n.max=xO(n.max,e,t,r,i)}function Z7(n,{x:e,y:t}){AR(n.x,e.translate,e.scale,e.originPoint),AR(n.y,t.translate,t.scale,t.originPoint)}const _O=.999999999999,vO=1.0000000000001;function doe(n,e,t,r=!1){const i=t.length;if(!i)return;e.x=e.y=1;let s,a;for(let o=0;o<i;o++){s=t[o],a=s.projectionDelta;const{visualElement:l}=s.options;l&&l.props.style&&l.props.style.display==="contents"||(r&&s.options.layoutScroll&&s.scroll&&s!==s.root&&l0(n,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),a&&(e.x*=a.x.scale,e.y*=a.y.scale,Z7(n,a)),r&&Ch(s.latestValues)&&l0(n,s.latestValues))}e.x<vO&&e.x>_O&&(e.x=1),e.y<vO&&e.y>_O&&(e.y=1)}function o0(n,e){n.min=n.min+e,n.max=n.max+e}function wO(n,e,t,r,i=.5){const s=Mr(n.min,n.max,i);AR(n,e,t,s,r)}function l0(n,e){wO(n.x,e.x,e.scaleX,e.scale,e.originX),wO(n.y,e.y,e.scaleY,e.scale,e.originY)}function J7(n,e){return q7(hoe(n.getBoundingClientRect(),e))}function foe(n,e,t){const r=J7(n,t),{scroll:i}=e;return i&&(o0(r.x,i.offset.x),o0(r.y,i.offset.y)),r}const Q7=({current:n})=>n?n.ownerDocument.defaultView:null,goe=new WeakMap;class moe{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=$r(),this.visualElement=e}start(e,{snapToCursor:t=!1}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const i=h=>{const{dragSnapToOrigin:f}=this.getProps();f?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(Zy(h).point)},s=(h,f)=>{const{drag:m,dragPropagation:y,onDragStart:x}=this.getProps();if(m&&!y&&(this.openDragLock&&this.openDragLock(),this.openDragLock=ose(m),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),ka(w=>{let S=this.getAxisMotionValue(w).get()||0;if(ol.test(S)){const{projection:b}=this.visualElement;if(b&&b.layout){const R=b.layout.layoutBox[w];R&&(S=pa(R)*(parseFloat(S)/100))}}this.originPoint[w]=S}),x&&gr.postRender(()=>x(h,f)),yR(this.visualElement,"transform");const{animationState:_}=this.visualElement;_&&_.setActive("whileDrag",!0)},a=(h,f)=>{const{dragPropagation:m,dragDirectionLock:y,onDirectionLock:x,onDrag:_}=this.getProps();if(!m&&!this.openDragLock)return;const{offset:w}=f;if(y&&this.currentDirection===null){this.currentDirection=poe(w),this.currentDirection!==null&&x&&x(this.currentDirection);return}this.updateAxis("x",f.point,w),this.updateAxis("y",f.point,w),this.visualElement.render(),_&&_(h,f)},o=(h,f)=>this.stop(h,f),l=()=>ka(h=>{var f;return this.getAnimationState(h)==="paused"&&((f=this.getAxisMotionValue(h).animation)===null||f===void 0?void 0:f.play())}),{dragSnapToOrigin:c}=this.getProps();this.panSession=new W7(e,{onSessionStart:i,onStart:s,onMove:a,onSessionEnd:o,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:c,contextWindow:Q7(this.visualElement)})}stop(e,t){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:i}=t;this.startAnimation(i);const{onDragEnd:s}=this.getProps();s&&gr.postRender(()=>s(e,t))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,r){const{drag:i}=this.getProps();if(!r||!Gx(e,i,this.currentDirection))return;const s=this.getAxisMotionValue(e);let a=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(a=ioe(a,this.constraints[e],this.elastic[e])),s.set(a)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:r}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,s=this.constraints;t&&i0(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&i?this.constraints=soe(i.layoutBox,t):this.constraints=!1,this.elastic=coe(r),s!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&ka(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=loe(i.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!i0(e))return!1;const r=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const s=foe(r,i.root,this.visualElement.getTransformPagePoint());let a=aoe(i.layout.layoutBox,s);if(t){const o=t(uoe(a));this.hasMutatedConstraints=!!o,o&&(a=q7(o))}return a}startAnimation(e){const{drag:t,dragMomentum:r,dragElastic:i,dragTransition:s,dragSnapToOrigin:a,onDragTransitionEnd:o}=this.getProps(),l=this.constraints||{},c=ka(h=>{if(!Gx(h,t,this.currentDirection))return;let f=l&&l[h]||{};a&&(f={min:0,max:0});const m=i?200:1e6,y=i?40:1e7,x={type:"inertia",velocity:r?e[h]:0,bounceStiffness:m,bounceDamping:y,timeConstant:750,restDelta:1,restSpeed:10,...s,...f};return this.startAxisValueAnimation(h,x)});return Promise.all(c).then(o)}startAxisValueAnimation(e,t){const r=this.getAxisMotionValue(e);return yR(this.visualElement,e),r.start(jC(e,r,0,t,this.visualElement,!1))}stopAnimation(){ka(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){ka(e=>{var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.pause()})}getAnimationState(e){var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,r=this.visualElement.getProps(),i=r[t];return i||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){ka(t=>{const{drag:r}=this.getProps();if(!Gx(t,r,this.currentDirection))return;const{projection:i}=this.visualElement,s=this.getAxisMotionValue(t);if(i&&i.layout){const{min:a,max:o}=i.layout.layoutBox[t];s.set(e[t]-Mr(a,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:r}=this.visualElement;if(!i0(t)||!r||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};ka(a=>{const o=this.getAxisMotionValue(a);if(o&&this.constraints!==!1){const l=o.get();i[a]=ooe({min:l,max:l},this.constraints[a])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),ka(a=>{if(!Gx(a,e,null))return;const o=this.getAxisMotionValue(a),{min:l,max:c}=this.constraints[a];o.set(Mr(l,c,i[a]))})}addListeners(){if(!this.visualElement.current)return;goe.set(this.visualElement,this);const e=this.visualElement.current,t=Qm(e,"pointerdown",l=>{const{drag:c,dragListener:h=!0}=this.getProps();c&&h&&this.start(l)}),r=()=>{const{dragConstraints:l}=this.getProps();i0(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,s=i.addEventListener("measure",r);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),gr.read(r);const a=ty(window,"resize",()=>this.scalePositionWithinConstraints()),o=i.addEventListener("didUpdate",(({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(ka(h=>{const f=this.getAxisMotionValue(h);f&&(this.originPoint[h]+=l[h].translate,f.set(f.get()+l[h].translate))}),this.visualElement.render())}));return()=>{a(),t(),s(),o&&o()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:r=!1,dragPropagation:i=!1,dragConstraints:s=!1,dragElastic:a=bR,dragMomentum:o=!0}=e;return{...e,drag:t,dragDirectionLock:r,dragPropagation:i,dragConstraints:s,dragElastic:a,dragMomentum:o}}}function Gx(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function poe(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class yoe extends qu{constructor(e){super(e),this.removeGroupControls=fa,this.removeListeners=fa,this.controls=new moe(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||fa}unmount(){this.removeGroupControls(),this.removeListeners()}}const EO=n=>(e,t)=>{n&&gr.postRender(()=>n(e,t))};class xoe extends qu{constructor(){super(...arguments),this.removePointerDownListener=fa}onPointerDown(e){this.session=new W7(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:Q7(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:r,onPanEnd:i}=this.node.getProps();return{onSessionStart:EO(e),onStart:EO(t),onMove:r,onEnd:(s,a)=>{delete this.session,i&&gr.postRender(()=>i(s,a))}}}mount(){this.removePointerDownListener=Qm(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const S_={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function TO(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const _m={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if($t.test(n))n=parseFloat(n);else return n;const t=TO(n,e.target.x),r=TO(n,e.target.y);return`${t}% ${r}%`}},_oe={correct:(n,{treeScale:e,projectionDelta:t})=>{const r=n,i=ju.parse(n);if(i.length>5)return r;const s=ju.createTransformer(n),a=typeof i[0]!="number"?1:0,o=t.x.scale*e.x,l=t.y.scale*e.y;i[0+a]/=o,i[1+a]/=l;const c=Mr(o,l,.5);return typeof i[2+a]=="number"&&(i[2+a]/=c),typeof i[3+a]=="number"&&(i[3+a]/=c),s(i)}};class voe extends X.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r,layoutId:i}=this.props,{projection:s}=e;Gie(woe),s&&(t.group&&t.group.add(s),r&&r.register&&i&&r.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),S_.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:r,drag:i,isPresent:s}=this.props,a=r.projection;return a&&(a.isPresent=s,i||e.layoutDependency!==t||t===void 0?a.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?a.promote():a.relegate()||gr.postRender(()=>{const o=a.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),fC.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r}=this.props,{projection:i}=e;i&&(i.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(i),r&&r.deregister&&r.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function eV(n){const[e,t]=D9(),r=X.useContext(sC);return g.jsx(voe,{...n,layoutGroup:r,switchLayoutGroup:X.useContext($9),isPresent:e,safeToRemove:t})}const woe={borderRadius:{..._m,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:_m,borderTopRightRadius:_m,borderBottomLeftRadius:_m,borderBottomRightRadius:_m,boxShadow:_oe};function Eoe(n,e,t){const r=cs(n)?n:Qp(n);return r.start(jC("",r,e,t)),r.animation}function Toe(n){return n instanceof SVGElement&&n.tagName!=="svg"}const Soe=(n,e)=>n.depth-e.depth;class boe{constructor(){this.children=[],this.isDirty=!1}add(e){AC(this.children,e),this.isDirty=!0}remove(e){IC(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(Soe),this.isDirty=!1,this.children.forEach(e)}}function Roe(n,e){const t=ll.now(),r=({timestamp:i})=>{const s=i-t;s>=e&&(Fu(r),n(s-e))};return gr.read(r,!0),()=>Fu(r)}const tV=["TopLeft","TopRight","BottomLeft","BottomRight"],Aoe=tV.length,SO=n=>typeof n=="string"?parseFloat(n):n,bO=n=>typeof n=="number"||$t.test(n);function Ioe(n,e,t,r,i,s){i?(n.opacity=Mr(0,t.opacity!==void 0?t.opacity:1,Coe(r)),n.opacityExit=Mr(e.opacity!==void 0?e.opacity:1,0,koe(r))):s&&(n.opacity=Mr(e.opacity!==void 0?e.opacity:1,t.opacity!==void 0?t.opacity:1,r));for(let a=0;a<Aoe;a++){const o=`border${tV[a]}Radius`;let l=RO(e,o),c=RO(t,o);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||bO(l)===bO(c)?(n[o]=Math.max(Mr(SO(l),SO(c),r),0),(ol.test(c)||ol.test(l))&&(n[o]+="%")):n[o]=c}(e.rotate||t.rotate)&&(n.rotate=Mr(e.rotate||0,t.rotate||0,r))}function RO(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const Coe=nV(0,.5,v7),koe=nV(.5,.95,fa);function nV(n,e,t){return r=>r<n?0:r>e?1:t(Q0(n,e,r))}function AO(n,e){n.min=e.min,n.max=e.max}function Ia(n,e){AO(n.x,e.x),AO(n.y,e.y)}function IO(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function CO(n,e,t,r,i){return n-=e,n=Ov(n,1/t,r),i!==void 0&&(n=Ov(n,1/i,r)),n}function Poe(n,e=0,t=1,r=.5,i,s=n,a=n){if(ol.test(e)&&(e=parseFloat(e),e=Mr(a.min,a.max,e/100)-a.min),typeof e!="number")return;let o=Mr(s.min,s.max,r);n===s&&(o-=e),n.min=CO(n.min,e,t,o,i),n.max=CO(n.max,e,t,o,i)}function kO(n,e,[t,r,i],s,a){Poe(n,e[t],e[r],e[i],e.scale,s,a)}const Moe=["x","scaleX","originX"],Noe=["y","scaleY","originY"];function PO(n,e,t,r){kO(n.x,e,Moe,t?t.x:void 0,r?r.x:void 0),kO(n.y,e,Noe,t?t.y:void 0,r?r.y:void 0)}function MO(n){return n.translate===0&&n.scale===1}function rV(n){return MO(n.x)&&MO(n.y)}function NO(n,e){return n.min===e.min&&n.max===e.max}function Loe(n,e){return NO(n.x,e.x)&&NO(n.y,e.y)}function LO(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function iV(n,e){return LO(n.x,e.x)&&LO(n.y,e.y)}function OO(n){return pa(n.x)/pa(n.y)}function DO(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class Ooe{constructor(){this.members=[]}add(e){AC(this.members,e),e.scheduleRender()}remove(e){if(IC(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(i=>e===i);if(t===0)return!1;let r;for(let i=t;i>=0;i--){const s=this.members[i];if(s.isPresent!==!1){r=s;break}}return r?(this.promote(r),!0):!1}promote(e,t){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,t&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:r}=e;t.onExitComplete&&t.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function Doe(n,e,t){let r="";const i=n.x.translate/e.x,s=n.y.translate/e.y,a=t?.z||0;if((i||s||a)&&(r=`translate3d(${i}px, ${s}px, ${a}px) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:c,rotate:h,rotateX:f,rotateY:m,skewX:y,skewY:x}=t;c&&(r=`perspective(${c}px) ${r}`),h&&(r+=`rotate(${h}deg) `),f&&(r+=`rotateX(${f}deg) `),m&&(r+=`rotateY(${m}deg) `),y&&(r+=`skewX(${y}deg) `),x&&(r+=`skewY(${x}deg) `)}const o=n.x.scale*e.x,l=n.y.scale*e.y;return(o!==1||l!==1)&&(r+=`scale(${o}, ${l})`),r||"none"}const kh={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},Nm=typeof window<"u"&&window.MotionDebug!==void 0,IS=["","X","Y","Z"],Foe={visibility:"hidden"},FO=1e3;let joe=0;function CS(n,e,t,r){const{latestValues:i}=e;i[n]&&(t[n]=i[n],e.setStaticValue(n,0),r&&(r[n]=0))}function sV(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=f7(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:i,layoutId:s}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",gr,!(i||s))}const{parent:r}=n;r&&!r.hasCheckedOptimisedAppear&&sV(r)}function aV({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:r,resetTransform:i}){return class{constructor(a={},o=e?.()){this.id=joe++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Nm&&(kh.totalNodes=kh.resolvedTargetDeltas=kh.recalculatedProjection=0),this.nodes.forEach(Boe),this.nodes.forEach(Hoe),this.nodes.forEach(Koe),this.nodes.forEach(zoe),Nm&&window.MotionDebug.record(kh)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new boe)}addEventListener(a,o){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new CC),this.eventHandlers.get(a).add(o)}notifyListeners(a,...o){const l=this.eventHandlers.get(a);l&&l.notify(...o)}hasListeners(a){return this.eventHandlers.has(a)}mount(a,o=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=Toe(a),this.instance=a;const{layoutId:l,layout:c,visualElement:h}=this.options;if(h&&!h.current&&h.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),o&&(c||l)&&(this.isLayoutDirty=!0),n){let f;const m=()=>this.root.updateBlockedByResize=!1;n(a,()=>{this.root.updateBlockedByResize=!0,f&&f(),f=Roe(m,250),S_.hasAnimatedSinceResize&&(S_.hasAnimatedSinceResize=!1,this.nodes.forEach(VO))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&h&&(l||c)&&this.addEventListener("didUpdate",({delta:f,hasLayoutChanged:m,hasRelativeTargetChanged:y,layout:x})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const _=this.options.transition||h.getDefaultTransition()||Joe,{onLayoutAnimationStart:w,onLayoutAnimationComplete:S}=h.getProps(),b=!this.targetLayout||!iV(this.targetLayout,x)||y,R=!m&&y;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||R||m&&(b||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(f,R);const M={...TC(_,"layout"),onPlay:w,onComplete:S};(h.shouldReduceMotion||this.options.layoutRoot)&&(M.delay=0,M.type=!1),this.startAnimation(M)}else m||VO(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=x})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Fu(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Xoe),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&sV(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let h=0;h<this.path.length;h++){const f=this.path[h];f.shouldResetTransform=!0,f.updateScroll("snapshot"),f.options.layoutRoot&&f.willUpdate(!1)}const{layoutId:o,layout:l}=this.options;if(o===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(jO);return}this.isUpdating||this.nodes.forEach($oe),this.isUpdating=!1,this.nodes.forEach(Woe),this.nodes.forEach(Voe),this.nodes.forEach(Goe),this.clearAllSnapshots();const o=ll.now();Bi.delta=cc(0,1e3/60,o-Bi.timestamp),Bi.timestamp=o,Bi.isProcessing=!0,_S.update.process(Bi),_S.preRender.process(Bi),_S.render.process(Bi),Bi.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,fC.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(Uoe),this.sharedNodes.forEach(qoe)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,gr.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){gr.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=$r(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(o=!1),o){const l=r(this.instance);this.scroll={animationId:this.root.animationId,phase:a,isRoot:l,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!i)return;const a=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!rV(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,h=c!==this.prevTransformTemplateValue;a&&(o||Ch(this.latestValues)||h)&&(i(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const o=this.measurePageBox();let l=this.removeElementScroll(o);return a&&(l=this.removeTransform(l)),Qoe(l),{animationId:this.root.animationId,measuredBox:o,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var a;const{visualElement:o}=this.options;if(!o)return $r();const l=o.measureViewportBox();if(!(((a=this.scroll)===null||a===void 0?void 0:a.wasRoot)||this.path.some(ele))){const{scroll:h}=this.root;h&&(o0(l.x,h.offset.x),o0(l.y,h.offset.y))}return l}removeElementScroll(a){var o;const l=$r();if(Ia(l,a),!((o=this.scroll)===null||o===void 0)&&o.wasRoot)return l;for(let c=0;c<this.path.length;c++){const h=this.path[c],{scroll:f,options:m}=h;h!==this.root&&f&&m.layoutScroll&&(f.wasRoot&&Ia(l,a),o0(l.x,f.offset.x),o0(l.y,f.offset.y))}return l}applyTransform(a,o=!1){const l=$r();Ia(l,a);for(let c=0;c<this.path.length;c++){const h=this.path[c];!o&&h.options.layoutScroll&&h.scroll&&h!==h.root&&l0(l,{x:-h.scroll.offset.x,y:-h.scroll.offset.y}),Ch(h.latestValues)&&l0(l,h.latestValues)}return Ch(this.latestValues)&&l0(l,this.latestValues),l}removeTransform(a){const o=$r();Ia(o,a);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!Ch(c.latestValues))continue;RR(c.latestValues)&&c.updateSnapshot();const h=$r(),f=c.measurePageBox();Ia(h,f),PO(o,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,h)}return Ch(this.latestValues)&&PO(o,this.latestValues),o}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Bi.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var o;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==l;if(!(a||c&&this.isSharedProjectionDirty||this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:f,layoutId:m}=this.options;if(!(!this.layout||!(f||m))){if(this.resolvedRelativeTargetAt=Bi.timestamp,!this.targetDelta&&!this.relativeTarget){const y=this.getClosestProjectingParent();y&&y.layout&&this.animationProgress!==1?(this.relativeParent=y,this.forceRelativeParentToResolveTarget(),this.relativeTarget=$r(),this.relativeTargetOrigin=$r(),tp(this.relativeTargetOrigin,this.layout.layoutBox,y.layout.layoutBox),Ia(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=$r(),this.targetWithTransforms=$r()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),roe(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Ia(this.target,this.layout.layoutBox),Z7(this.target,this.targetDelta)):Ia(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const y=this.getClosestProjectingParent();y&&!!y.resumingFrom==!!this.resumingFrom&&!y.options.layoutScroll&&y.target&&this.animationProgress!==1?(this.relativeParent=y,this.forceRelativeParentToResolveTarget(),this.relativeTarget=$r(),this.relativeTargetOrigin=$r(),tp(this.relativeTargetOrigin,this.target,y.target),Ia(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Nm&&kh.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||RR(this.parent.latestValues)||Y7(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var a;const o=this.getLead(),l=!!this.resumingFrom||this!==o;let c=!0;if((this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty)&&(c=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===Bi.timestamp&&(c=!1),c)return;const{layout:h,layoutId:f}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(h||f))return;Ia(this.layoutCorrected,this.layout.layoutBox);const m=this.treeScale.x,y=this.treeScale.y;doe(this.layoutCorrected,this.treeScale,this.path,l),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=$r());const{target:x}=o;if(!x){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(IO(this.prevProjectionDelta.x,this.projectionDelta.x),IO(this.prevProjectionDelta.y,this.projectionDelta.y)),ep(this.projectionDelta,this.layoutCorrected,x,this.latestValues),(this.treeScale.x!==m||this.treeScale.y!==y||!DO(this.projectionDelta.x,this.prevProjectionDelta.x)||!DO(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",x)),Nm&&kh.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){var o;if((o=this.options.visualElement)===null||o===void 0||o.scheduleRender(),a){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=a0(),this.projectionDelta=a0(),this.projectionDeltaWithTransform=a0()}setAnimationOrigin(a,o=!1){const l=this.snapshot,c=l?l.latestValues:{},h={...this.latestValues},f=a0();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const m=$r(),y=l?l.source:void 0,x=this.layout?this.layout.source:void 0,_=y!==x,w=this.getStack(),S=!w||w.members.length<=1,b=!!(_&&!S&&this.options.crossfade===!0&&!this.path.some(Zoe));this.animationProgress=0;let R;this.mixTargetDelta=M=>{const O=M/1e3;GO(f.x,a.x,O),GO(f.y,a.y,O),this.setTargetDelta(f),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(tp(m,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Yoe(this.relativeTarget,this.relativeTargetOrigin,m,O),R&&Loe(this.relativeTarget,R)&&(this.isProjectionDirty=!1),R||(R=$r()),Ia(R,this.relativeTarget)),_&&(this.animationValues=h,Ioe(h,c,this.latestValues,O,b,S)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=O},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Fu(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=gr.update(()=>{S_.hasAnimatedSinceResize=!0,this.currentAnimation=Eoe(0,FO,{...a,onUpdate:o=>{this.mixTargetDelta(o),a.onUpdate&&a.onUpdate(o)},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(FO),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:o,target:l,layout:c,latestValues:h}=a;if(!(!o||!l||!c)){if(this!==a&&this.layout&&c&&oV(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||$r();const f=pa(this.layout.layoutBox.x);l.x.min=a.target.x.min,l.x.max=l.x.min+f;const m=pa(this.layout.layoutBox.y);l.y.min=a.target.y.min,l.y.max=l.y.min+m}Ia(o,l),l0(o,h),ep(this.projectionDeltaWithTransform,this.layoutCorrected,o,h)}}registerSharedNode(a,o){this.sharedNodes.has(a)||this.sharedNodes.set(a,new Ooe),this.sharedNodes.get(a).add(o);const c=o.options.initialPromotionConfig;o.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(o):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var a;const{layoutId:o}=this.options;return o?((a=this.getStack())===null||a===void 0?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:o}=this.options;return o?(a=this.getStack())===null||a===void 0?void 0:a.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:o,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),a&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetSkewAndRotation(){const{visualElement:a}=this.options;if(!a)return;let o=!1;const{latestValues:l}=a;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(o=!0),!o)return;const c={};l.z&&CS("z",a,c,this.animationValues);for(let h=0;h<IS.length;h++)CS(`rotate${IS[h]}`,a,c,this.animationValues),CS(`skew${IS[h]}`,a,c,this.animationValues);a.render();for(const h in c)a.setStaticValue(h,c[h]),this.animationValues&&(this.animationValues[h]=c[h]);a.scheduleRender()}getProjectionStyles(a){var o,l;if(!this.instance||this.isSVG)return;if(!this.isVisible)return Foe;const c={visibility:""},h=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,c.opacity="",c.pointerEvents=E_(a?.pointerEvents)||"",c.transform=h?h(this.latestValues,""):"none",c;const f=this.getLead();if(!this.projectionDelta||!this.layout||!f.target){const _={};return this.options.layoutId&&(_.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,_.pointerEvents=E_(a?.pointerEvents)||""),this.hasProjected&&!Ch(this.latestValues)&&(_.transform=h?h({},""):"none",this.hasProjected=!1),_}const m=f.animationValues||f.latestValues;this.applyTransformsToTarget(),c.transform=Doe(this.projectionDeltaWithTransform,this.treeScale,m),h&&(c.transform=h(m,c.transform));const{x:y,y:x}=this.projectionDelta;c.transformOrigin=`${y.origin*100}% ${x.origin*100}% 0`,f.animationValues?c.opacity=f===this?(l=(o=m.opacity)!==null&&o!==void 0?o:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:m.opacityExit:c.opacity=f===this?m.opacity!==void 0?m.opacity:"":m.opacityExit!==void 0?m.opacityExit:0;for(const _ in kv){if(m[_]===void 0)continue;const{correct:w,applyTo:S}=kv[_],b=c.transform==="none"?m[_]:w(m[_],f);if(S){const R=S.length;for(let M=0;M<R;M++)c[S[M]]=b}else c[_]=b}return this.options.layoutId&&(c.pointerEvents=f===this?E_(a?.pointerEvents)||"":"none"),c}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var o;return(o=a.currentAnimation)===null||o===void 0?void 0:o.stop()}),this.root.nodes.forEach(jO),this.root.sharedNodes.clear()}}}function Voe(n){n.updateLayout()}function Goe(n){var e;const t=((e=n.resumeFrom)===null||e===void 0?void 0:e.snapshot)||n.snapshot;if(n.isLead()&&n.layout&&t&&n.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:i}=n.layout,{animationType:s}=n.options,a=t.source!==n.layout.source;s==="size"?ka(f=>{const m=a?t.measuredBox[f]:t.layoutBox[f],y=pa(m);m.min=r[f].min,m.max=m.min+y}):oV(s,t.layoutBox,r)&&ka(f=>{const m=a?t.measuredBox[f]:t.layoutBox[f],y=pa(r[f]);m.max=m.min+y,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[f].max=n.relativeTarget[f].min+y)});const o=a0();ep(o,r,t.layoutBox);const l=a0();a?ep(l,n.applyTransform(i,!0),t.measuredBox):ep(l,r,t.layoutBox);const c=!rV(o);let h=!1;if(!n.resumeFrom){const f=n.getClosestProjectingParent();if(f&&!f.resumeFrom){const{snapshot:m,layout:y}=f;if(m&&y){const x=$r();tp(x,t.layoutBox,m.layoutBox);const _=$r();tp(_,r,y.layoutBox),iV(x,_)||(h=!0),f.options.layoutRoot&&(n.relativeTarget=_,n.relativeTargetOrigin=x,n.relativeParent=f)}}}n.notifyListeners("didUpdate",{layout:r,snapshot:t,delta:l,layoutDelta:o,hasLayoutChanged:c,hasRelativeTargetChanged:h})}else if(n.isLead()){const{onExitComplete:r}=n.options;r&&r()}n.options.transition=void 0}function Boe(n){Nm&&kh.totalNodes++,n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function zoe(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function Uoe(n){n.clearSnapshot()}function jO(n){n.clearMeasurements()}function $oe(n){n.isLayoutDirty=!1}function Woe(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function VO(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function Hoe(n){n.resolveTargetDelta()}function Koe(n){n.calcProjection()}function Xoe(n){n.resetSkewAndRotation()}function qoe(n){n.removeLeadSnapshot()}function GO(n,e,t){n.translate=Mr(e.translate,0,t),n.scale=Mr(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function BO(n,e,t,r){n.min=Mr(e.min,t.min,r),n.max=Mr(e.max,t.max,r)}function Yoe(n,e,t,r){BO(n.x,e.x,t.x,r),BO(n.y,e.y,t.y,r)}function Zoe(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const Joe={duration:.45,ease:[.4,0,.1,1]},zO=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),UO=zO("applewebkit/")&&!zO("chrome/")?Math.round:fa;function $O(n){n.min=UO(n.min),n.max=UO(n.max)}function Qoe(n){$O(n.x),$O(n.y)}function oV(n,e,t){return n==="position"||n==="preserve-aspect"&&!noe(OO(e),OO(t),.2)}function ele(n){var e;return n!==n.root&&((e=n.scroll)===null||e===void 0?void 0:e.wasRoot)}const tle=aV({attachResizeListener:(n,e)=>ty(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),kS={current:void 0},lV=aV({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!kS.current){const n=new tle({});n.mount(window),n.setOptions({layoutScroll:!0}),kS.current=n}return kS.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),nle={pan:{Feature:xoe},drag:{Feature:yoe,ProjectionNode:lV,MeasureLayout:eV}};function WO(n,e,t){const{props:r}=n;n.animationState&&r.whileHover&&n.animationState.setActive("whileHover",t==="Start");const i="onHover"+t,s=r[i];s&&gr.postRender(()=>s(e,Zy(e)))}class rle extends qu{mount(){const{current:e}=this.node;e&&(this.unmount=nse(e,t=>(WO(this.node,t,"Start"),r=>WO(this.node,r,"End"))))}unmount(){}}class ile extends qu{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Yy(ty(this.node.current,"focus",()=>this.onFocus()),ty(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function HO(n,e,t){const{props:r}=n;n.animationState&&r.whileTap&&n.animationState.setActive("whileTap",t==="Start");const i="onTap"+(t==="End"?"":t),s=r[i];s&&gr.postRender(()=>s(e,Zy(e)))}class sle extends qu{mount(){const{current:e}=this.node;e&&(this.unmount=ase(e,t=>(HO(this.node,t,"Start"),(r,{success:i})=>HO(this.node,r,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const IR=new WeakMap,PS=new WeakMap,ale=n=>{const e=IR.get(n.target);e&&e(n)},ole=n=>{n.forEach(ale)};function lle({root:n,...e}){const t=n||document;PS.has(t)||PS.set(t,{});const r=PS.get(t),i=JSON.stringify(e);return r[i]||(r[i]=new IntersectionObserver(ole,{root:n,...e})),r[i]}function cle(n,e,t){const r=lle(e);return IR.set(n,t),r.observe(n),()=>{IR.delete(n),r.unobserve(n)}}const ule={some:0,all:1};class hle extends qu{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:r,amount:i="some",once:s}=e,a={root:t?t.current:void 0,rootMargin:r,threshold:typeof i=="number"?i:ule[i]},o=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,s&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:h,onViewportLeave:f}=this.node.getProps(),m=c?h:f;m&&m(l)};return cle(this.node.current,a,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(dle(e,t))&&this.startObserver()}unmount(){}}function dle({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const fle={inView:{Feature:hle},tap:{Feature:sle},focus:{Feature:ile},hover:{Feature:rle}},gle={layout:{ProjectionNode:lV,MeasureLayout:eV}},CR={current:null},cV={current:!1};function mle(){if(cV.current=!0,!!lC)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>CR.current=n.matches;n.addListener(e),e()}else CR.current=!1}const ple=[...L7,is,ju],yle=n=>ple.find(N7(n)),KO=new WeakMap;function xle(n,e,t){for(const r in e){const i=e[r],s=t[r];if(cs(i))n.addValue(r,i);else if(cs(s))n.addValue(r,Qp(i,{owner:n}));else if(s!==i)if(n.hasValue(r)){const a=n.getValue(r);a.liveStyle===!0?a.jump(i):a.hasAnimated||a.set(i)}else{const a=n.getStaticValue(r);n.addValue(r,Qp(a!==void 0?a:i,{owner:n}))}}for(const r in t)e[r]===void 0&&n.removeValue(r);return e}const XO=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class _le{scrapeMotionValuesFromProps(e,t,r){return{}}constructor({parent:e,props:t,presenceContext:r,reducedMotionConfig:i,blockInitialAnimation:s,visualState:a},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=OC,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const y=ll.now();this.renderScheduledAt<y&&(this.renderScheduledAt=y,gr.render(this.render,!1,!0))};const{latestValues:l,renderState:c,onUpdate:h}=a;this.onUpdate=h,this.latestValues=l,this.baseTarget={...l},this.initialValues=t.initial?{...l}:{},this.renderState=c,this.parent=e,this.props=t,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=o,this.blockInitialAnimation=!!s,this.isControllingVariants=AE(t),this.isVariantNode=z9(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:f,...m}=this.scrapeMotionValuesFromProps(t,{},this);for(const y in m){const x=m[y];l[y]!==void 0&&cs(x)&&x.set(l[y],!1)}}mount(e){this.current=e,KO.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,r)=>this.bindToMotionValue(r,t)),cV.current||mle(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:CR.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){KO.delete(this.current),this.projection&&this.projection.unmount(),Fu(this.notifyUpdate),Fu(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const r=Dd.has(e),i=t.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&gr.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0)}),s=t.on("renderRequest",this.scheduleRender);let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{i(),s(),a&&a(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in eg){const t=eg[e];if(!t)continue;const{isEnabled:r,Feature:i}=t;if(!this.features[e]&&i&&r(this.props)&&(this.features[e]=new i(this)),this.features[e]){const s=this.features[e];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):$r()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let r=0;r<XO.length;r++){const i=XO[r];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const s="on"+i,a=e[s];a&&(this.propEventSubscriptions[i]=this.on(i,a))}this.prevMotionValues=xle(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const r=this.values.get(e);t!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&t!==void 0&&(r=Qp(t===null?void 0:t,{owner:this}),this.addValue(e,r)),r}readValue(e,t){var r;let i=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(r=this.getBaseTargetFromProps(this.props,e))!==null&&r!==void 0?r:this.readValueFromInstance(this.current,e,this.options);return i!=null&&(typeof i=="string"&&(P7(i)||E7(i))?i=parseFloat(i):!yle(i)&&ju.test(t)&&(i=I7(e,t)),this.setBaseTarget(e,cs(i)?i.get():i)),cs(i)?i.get():i}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;const{initial:r}=this.props;let i;if(typeof r=="string"||typeof r=="object"){const a=mC(this.props,r,(t=this.presenceContext)===null||t===void 0?void 0:t.custom);a&&(i=a[e])}if(r&&i!==void 0)return i;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!cs(s)?s:this.initialValues[e]!==void 0&&i===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new CC),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}}class uV extends _le{constructor(){super(...arguments),this.KeyframeResolver=O7}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:r}){delete t[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;cs(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function vle(n){return window.getComputedStyle(n)}class wle extends uV{constructor(){super(...arguments),this.type="html",this.renderInstance=Z9}readValueFromInstance(e,t){if(Dd.has(t)){const r=LC(t);return r&&r.default||0}else{const r=vle(e),i=(X9(t)?r.getPropertyValue(t):r[t])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:t}){return J7(e,t)}build(e,t,r){xC(e,t,r.transformTemplate)}scrapeMotionValuesFromProps(e,t,r){return EC(e,t,r)}}class Ele extends uV{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=$r}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(Dd.has(t)){const r=LC(t);return r&&r.default||0}return t=J9.has(t)?t:dC(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,r){return t7(e,t,r)}build(e,t,r){_C(e,t,this.isSVGTag,r.transformTemplate)}renderInstance(e,t,r,i){Q9(e,t,r,i)}mount(e){this.isSVGTag=wC(e.tagName),super.mount(e)}}const Tle=(n,e)=>gC(n)?new Ele(e):new wle(e,{allowProjection:n!==X.Fragment}),Sle=qie({...Kae,...fle,...nle,...gle},Tle),Rt=uie(Sle);const ble=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Rle=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),qO=n=>{const e=Rle(n);return e.charAt(0).toUpperCase()+e.slice(1)},hV=(...n)=>n.filter((e,t,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===t).join(" ").trim(),Ale=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var Ile={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Cle=X.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:i="",children:s,iconNode:a,...o},l)=>X.createElement("svg",{ref:l,...Ile,width:e,height:e,stroke:n,strokeWidth:r?Number(t)*24/Number(e):t,className:hV("lucide",i),...!s&&!Ale(o)&&{"aria-hidden":"true"},...o},[...a.map(([c,h])=>X.createElement(c,h)),...Array.isArray(s)?s:[s]]));const at=(n,e)=>{const t=X.forwardRef(({className:r,...i},s)=>X.createElement(Cle,{ref:s,iconNode:e,className:hV(`lucide-${ble(qO(n))}`,`lucide-${n}`,r),...i}));return t.displayName=qO(n),t};const kle=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h2",key:"tvwodi"}],["path",{d:"M20 8v11a2 2 0 0 1-2 2h-2",key:"1gkqxj"}],["path",{d:"m9 15 3-3 3 3",key:"1pd0qc"}],["path",{d:"M12 12v9",key:"192myk"}]],Ple=at("archive-restore",kle);const Mle=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],dV=at("archive",Mle);const Nle=[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Lle=at("ban",Nle);const Ole=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],Dle=at("book-open",Ole);const Fle=[["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M14 7a4 4 0 0 1 4 4v3a6 6 0 0 1-12 0v-3a4 4 0 0 1 4-4z",key:"uouzyp"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M21 21a4 4 0 0 0-3.81-4",key:"1b0z45"}],["path",{d:"M21 5a4 4 0 0 1-3.55 3.97",key:"5cxbf6"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M3 21a4 4 0 0 1 3.81-4",key:"1fjd4g"}],["path",{d:"M3 5a4 4 0 0 0 3.55 3.97",key:"1d7oge"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M9 7.13V6a3 3 0 1 1 6 0v1.13",key:"1vgav8"}]],fV=at("bug",Fle);const jle=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],VC=at("calendar",jle);const Vle=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],kE=at("camera",Vle);const Gle=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],gV=at("chart-column",Gle);const Ble=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],uc=at("check",Ble);const zle=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],PE=at("chevron-down",zle);const Ule=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],$le=at("chevron-left",Ule);const Wle=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Jy=at("chevron-right",Wle);const Hle=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],mV=at("chevron-up",Hle);const Kle=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],pV=at("circle-alert",Kle);const Xle=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],qle=at("circle-check-big",Xle);const Yle=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Dv=at("clock",Yle);const Zle=[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5.782 5.782A7 7 0 0 0 9 19h8.5a4.5 4.5 0 0 0 1.307-.193",key:"yfwify"}],["path",{d:"M21.532 16.5A4.5 4.5 0 0 0 17.5 10h-1.79A7.008 7.008 0 0 0 10 5.07",key:"jlfiyv"}]],Jle=at("cloud-off",Zle);const Qle=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]],kR=at("cloud",Qle);const ece=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],tce=at("code",ece);const nce=[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],rce=at("compass",nce);const ice=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"22",x2:"18",y1:"12",y2:"12",key:"l9bcsi"}],["line",{x1:"6",x2:"2",y1:"12",y2:"12",key:"13hhkx"}],["line",{x1:"12",x2:"12",y1:"6",y2:"2",key:"10w3f3"}],["line",{x1:"12",x2:"12",y1:"22",y2:"18",key:"15g9kq"}]],Fv=at("crosshair",ice);const sce=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],jv=at("download",sce);const ace=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],Iu=at("external-link",ace);const oce=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Vv=at("eye-off",oce);const lce=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Gv=at("eye",lce);const cce=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],GC=at("file-text",cce);const uce=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]],hce=at("flame",uce);const dce=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],fce=at("folder-open",dce);const gce=[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],mce=at("folder-plus",gce);const pce=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],yce=at("folder",pce);const xce=[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]],_ce=at("gauge",xce);const vce=[["path",{d:"M10.5 3 8 9l4 13 4-13-2.5-6",key:"b3dvk1"}],["path",{d:"M17 3a2 2 0 0 1 1.6.8l3 4a2 2 0 0 1 .013 2.382l-7.99 10.986a2 2 0 0 1-3.247 0l-7.99-10.986A2 2 0 0 1 2.4 7.8l2.998-3.997A2 2 0 0 1 7 3z",key:"7w4byz"}],["path",{d:"M2 9h20",key:"16fsjt"}]],wce=at("gem",vce);const Ece=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],Tce=at("globe",Ece);const Sce=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],yV=at("grid-3x3",Sce);const bce=[["path",{d:"M16 5h6",key:"1vod17"}],["path",{d:"M19 2v6",key:"4bpg5p"}],["path",{d:"M21 11.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7.5",key:"1ue2ih"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}]],Rce=at("image-plus",bce);const Ace=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],BC=at("info",Ace);const Ice=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],za=at("layers",Ice);const Cce=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],xV=at("list",Cce);const kce=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],zC=at("loader-circle",kce);const Pce=[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Mce=at("locate-fixed",Pce);const Nce=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],PR=at("lock",Nce);const Lce=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],UC=at("log-out",Lce);const Oce=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],ya=at("map-pin",Oce);const Dce=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],$C=at("map",Dce);const Fce=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],jce=at("menu",Fce);const Vce=[["path",{d:"M5 12h14",key:"1ays0h"}]],_V=at("minus",Vce);const Gce=[["path",{d:"m8 3 4 8 5-5 5 15H2L8 3z",key:"otkl63"}]],ng=at("mountain",Gce);const Bce=[["path",{d:"M12.586 12.586 19 19",key:"ea5xo7"}],["path",{d:"M3.688 3.037a.497.497 0 0 0-.651.651l6.5 15.999a.501.501 0 0 0 .947-.062l1.569-6.083a2 2 0 0 1 1.448-1.479l6.124-1.579a.5.5 0 0 0 .063-.947z",key:"277e5u"}]],zce=at("mouse-pointer",Bce);const Uce=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],WC=at("navigation",Uce);const $ce=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],Wce=at("pause",$ce);const Hce=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],YO=at("pen-line",Hce);const Kce=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Xce=at("pen",Kce);const qce=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],rg=at("pencil",qce);const Yce=[["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["path",{d:"m9 20 3-6 3 6",key:"se2kox"}],["path",{d:"m6 8 6 2 6-2",key:"4o3us4"}],["path",{d:"M12 10v4",key:"1kjpxc"}]],vV=at("person-standing",Yce);const Zce=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],Jce=at("play",Zce);const Qce=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Xa=at("plus",Qce);const eue=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],tue=at("rotate-ccw",eue);const nue=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],rue=at("rotate-cw",nue);const iue=[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]],Bv=at("route",iue);const sue=[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]],ny=at("ruler",sue);const aue=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],wV=at("save",aue);const oue=[["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"m19 8 3 8a5 5 0 0 1-6 0zV7",key:"zcdpyk"}],["path",{d:"M3 7h1a17 17 0 0 0 8-2 17 17 0 0 0 8 2h1",key:"1yorad"}],["path",{d:"m5 8 3 8a5 5 0 0 1-6 0zV7",key:"eua70x"}],["path",{d:"M7 21h10",key:"1b0cd5"}]],lue=at("scale",oue);const cue=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],MR=at("search",cue);const uue=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],NR=at("settings",uue);const hue=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],due=at("settings-2",hue);const fue=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],gue=at("share-2",fue);const mue=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],pue=at("shield",mue);const yue=[["path",{d:"M10 5H3",key:"1qgfaw"}],["path",{d:"M12 19H3",key:"yhmn1j"}],["path",{d:"M14 3v4",key:"1sua03"}],["path",{d:"M16 17v4",key:"1q0r14"}],["path",{d:"M21 12h-9",key:"1o4lsq"}],["path",{d:"M21 19h-5",key:"1rlt1p"}],["path",{d:"M21 5h-7",key:"1oszz2"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M8 12H3",key:"a7s4jb"}]],xue=at("sliders-horizontal",yue);const _ue=[["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M12 21v-9",key:"17s77i"}],["path",{d:"M12 8V3",key:"13r4qs"}],["path",{d:"M17 16h4",key:"h1uq16"}],["path",{d:"M19 12V3",key:"o1uvq1"}],["path",{d:"M19 21v-5",key:"qua636"}],["path",{d:"M3 14h4",key:"bcjad9"}],["path",{d:"M5 10V3",key:"cb8scm"}],["path",{d:"M5 21v-7",key:"1w1uti"}]],vue=at("sliders-vertical",_ue);const wue=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],Eue=at("smartphone",wue);const Tue=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],Sue=at("square",Tue);const bue=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],Rue=at("tag",bue);const Aue=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],Iue=at("target",Aue);const Cue=[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]],kue=at("timer",Cue);const Pue=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],xc=at("trash-2",Pue);const Mue=[["path",{d:"M13 8c0-2.76-2.46-5-5.5-5S2 5.24 2 8h2l1-1 1 1h4",key:"foxbe7"}],["path",{d:"M13 7.14A5.82 5.82 0 0 1 16.5 6c3.04 0 5.5 2.24 5.5 5h-3l-1-1-1 1h-3",key:"18arnh"}],["path",{d:"M5.89 9.71c-2.15 2.15-2.3 5.47-.35 7.43l4.24-4.25.7-.7.71-.71 2.12-2.12c-1.95-1.96-5.27-1.8-7.42.35",key:"ywahnh"}],["path",{d:"M11 15.5c.5 2.5-.17 4.5-1 6.5h4c2-5.5-.5-12-1-14",key:"ft0feo"}]],Nue=at("tree-palm",Mue);const Lue=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],Oue=at("trending-down",Lue);const Due=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],Fue=at("trending-up",Due);const jue=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],EV=at("type",jue);const Vue=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Qy=at("upload",Vue);const Gue=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],HC=at("user",Gue);const Bue=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],zue=at("volume-2",Bue);const Uue=[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]],$ue=at("waves",Uue);const Wue=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],si=at("x",Wue);function Hue(){const{tracking:n,startTracking:e,stopTracking:t,updatePosition:r,setWatchId:i,resetFirstFix:s}=ws(),a=X.useCallback(l=>{r(l)},[r]),o=X.useCallback(l=>{console.error("GPS error:",l),alert(`GPS fout: ${l.message}`),t()},[t]);return X.useEffect(()=>{if(!n)return;if(!navigator.geolocation){alert("Geolocation wordt niet ondersteund door deze browser"),t();return}const l=navigator.geolocation.watchPosition(a,o,{enableHighAccuracy:!0,maximumAge:1e3,timeout:15e3});return i(l),()=>{navigator.geolocation.clearWatch(l)}},[n,a,o,i,t]),{tracking:n,start:e,stop:t,toggle:()=>n?t():e()}}function Kue(){const{tracking:n,toggle:e}=Hue();return g.jsx(Rt.button,{className:`
        fixed bottom-2 right-2 z-[1000]
        w-11 h-11 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${n?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},animate:n?{scale:[1,1.02,1]}:{},transition:n?{scale:{duration:2,repeat:1/0,ease:"easeInOut"}}:{},"aria-label":n?"GPS tracking actief":"GPS tracking starten",title:n?"GPS tracking actief":"GPS tracking starten",children:g.jsx(Mce,{size:22,strokeWidth:2})})}const Xue="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48">
    <polygon points="24,6 38,38 24,30 10,38" fill="#4285F4" stroke="white" stroke-width="3" stroke-linejoin="round"/>
  </svg>`);function que(){const n=pi(y=>y.map),e=ws(y=>y.position),t=ws(y=>y.accuracy),r=ws(y=>y.tracking),i=ws(y=>y.smoothHeading),s=Sn(y=>y.showAccuracyCircle),a=ws(y=>y.firstFix),o=ws(y=>y.resetFirstFix),l=ws(y=>y.config.centerOnUser),c=X.useRef(null),h=X.useRef(null),f=X.useRef(null),m=X.useMemo(()=>y=>new mn({image:new by({src:Xue,scale:.9,rotation:y,rotateWithView:!1,anchor:[.5,.5]})}),[]);return X.useEffect(()=>{if(!n||!r&&!e)return;const y=Ir([5.1214,52.0907]);return c.current=new _r({geometry:new gi(y)}),c.current.setStyle(m(0)),h.current=new _r({geometry:new gi(y)}),f.current=new Wu({source:new gc({features:[h.current,c.current]}),zIndex:1e3}),n.addLayer(f.current),()=>{f.current&&n&&n.removeLayer(f.current)}},[n,r,e,m]),X.useEffect(()=>{if(!n||!e||!c.current||!h.current)return;const y=Ir([e.lng,e.lat]);if(c.current.getGeometry()?.setCoordinates(y),h.current.getGeometry()?.setCoordinates(y),s&&t){const x=n.getView().getResolution()||1,_=Math.min(t/x,80);h.current.setStyle(new mn({image:new $s({radius:_,fill:new rr({color:"rgba(66, 133, 244, 0.12)"})})}))}else h.current.setStyle(new mn({}));if(a&&r){n.getView().setCenter(y),n.getView().setZoom(17),o();return}r&&l&&!a&&n.getView().animate({center:y,duration:150})},[n,r,e,t,a,o,l,s]),X.useEffect(()=>{if(!c.current)return;const y=i!==null?i*Math.PI/180:0;c.current.setStyle(m(y))},[i,m]),null}function Yue(){const n=wr(t=>t.themesPanelOpen),e=wr(t=>t.toggleThemesPanel);return g.jsx(Rt.button,{className:`
        fixed bottom-[60px] right-2 z-[1000]
        w-11 h-11 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${n?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":n?"Kaartlagen sluiten":"Kaartlagen openen",title:"Kaartlagen",children:g.jsx($C,{size:22,strokeWidth:2})})}function Zue(){return g.jsx(Yue,{})}const Bx=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899"],ru=["Mineraal","Fossiel","Erfgoed","Monument","Overig"],uo="default-vondsten",TV={id:uo,name:"Mijn vondsten",color:"#f97316",categories:["Munt","Aardewerk","Gesp","Fibula","Ring","Speld","Sieraad","Gereedschap","Wapen","Anders"],points:[],visible:!0,archived:!1,createdAt:new Date().toISOString()},Jue=n=>n.some(t=>t.id===uo)?n:[{...TV,createdAt:new Date().toISOString()},...n],hs=ms()(vl((n,e)=>({layers:[{...TV}],colorIndex:0,addLayer:(t,r=ru)=>{const i=crypto.randomUUID(),s=Bx[e().colorIndex%Bx.length];return n(a=>({layers:[...a.layers,{id:i,name:t,color:s,categories:[...r],points:[],visible:!0,archived:!1,createdAt:new Date().toISOString()}],colorIndex:a.colorIndex+1})),i},removeLayer:t=>{n(r=>({layers:r.layers.filter(i=>i.id!==t)}))},updateLayer:(t,r)=>{n(i=>({layers:i.layers.map(s=>s.id===t?{...s,...r}:s)}))},toggleVisibility:t=>{n(r=>({layers:r.layers.map(i=>i.id===t?{...i,visible:!i.visible}:i)}))},toggleArchived:t=>{n(r=>({layers:r.layers.map(i=>i.id===t?{...i,archived:!i.archived,visible:i.archived?i.visible:!1}:i)}))},addPoint:(t,r)=>{const i={...r,status:r.status||"todo",id:crypto.randomUUID(),createdAt:new Date().toISOString()};n(s=>({layers:s.layers.map(a=>a.id===t?{...a,points:[...a.points,i]}:a)}))},removePoint:(t,r)=>{n(i=>({layers:i.layers.map(s=>s.id===t?{...s,points:s.points.filter(a=>a.id!==r)}:s)}))},updatePoint:(t,r,i)=>{n(s=>({layers:s.layers.map(a=>a.id===t?{...a,points:a.points.map(o=>o.id===r?{...o,...i}:o)}:a)}))},setPointStatus:(t,r,i)=>{n(s=>({layers:s.layers.map(a=>a.id===t?{...a,points:a.points.map(o=>o.id===r?{...o,status:i}:o)}:a)}))},addCategory:(t,r)=>{n(i=>({layers:i.layers.map(s=>s.id===t&&!s.categories.includes(r)?{...s,categories:[...s.categories,r]}:s)}))},removeCategory:(t,r)=>{n(i=>({layers:i.layers.map(s=>s.id===t?{...s,categories:s.categories.filter(a=>a!==r)}:s)}))},addPhotoToPoint:(t,r,i)=>{n(s=>({layers:s.layers.map(a=>a.id===t?{...a,points:a.points.map(o=>o.id===r?{...o,photos:[...o.photos||[],i]}:o)}:a)}))},removePhotoFromPoint:(t,r,i)=>{n(s=>({layers:s.layers.map(a=>a.id===t?{...a,points:a.points.map(o=>o.id===r?{...o,photos:(o.photos||[]).filter(l=>l.id!==i)}:o)}:a)}))},updatePhotoInPoint:(t,r,i,s)=>{n(a=>({layers:a.layers.map(o=>o.id===t?{...o,points:o.points.map(l=>l.id===r?{...l,photos:(l.photos||[]).map(c=>c.id===i?{...c,...s}:c)}:l)}:o)}))},exportLayerAsGeoJSON:t=>{const r=e().layers.find(l=>l.id===t);if(!r)return;const i={type:"FeatureCollection",properties:{name:r.name,color:r.color,categories:r.categories,createdAt:r.createdAt,exportedAt:new Date().toISOString()},features:r.points.map(l=>({type:"Feature",geometry:{type:"Point",coordinates:l.coordinates},properties:{id:l.id,name:l.name,category:l.category,notes:l.notes,url:l.url,status:l.status,sourceLayer:l.sourceLayer,sourceId:l.sourceId,photos:l.photos,createdAt:l.createdAt}}))},s=new Blob([JSON.stringify(i,null,2)],{type:"application/geo+json"}),a=URL.createObjectURL(s),o=document.createElement("a");o.href=a,o.download=`${r.name.replace(/[^a-zA-Z0-9]/g,"-")}-${new Date().toISOString().split("T")[0]}.geojson`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(a)},importLayerFromGeoJSON:t=>{try{const r=JSON.parse(t);if(r.type!=="FeatureCollection")return{success:!1,error:"Ongeldig GeoJSON formaat"};const i=r.properties||{},s=i.name||`Gemporteerd ${new Date().toLocaleDateString("nl-NL")}`,a=i.categories||ru,o=i.color||Bx[e().colorIndex%Bx.length],l=(r.features||[]).filter(h=>h.geometry?.type==="Point").map(h=>({id:h.properties?.id||crypto.randomUUID(),name:h.properties?.name||"Naamloos",category:h.properties?.category||"Overig",notes:h.properties?.notes||"",url:h.properties?.url,status:h.properties?.status||"todo",sourceLayer:h.properties?.sourceLayer,sourceId:h.properties?.sourceId,photos:h.properties?.photos,coordinates:h.geometry.coordinates,createdAt:h.properties?.createdAt||new Date().toISOString()})),c=crypto.randomUUID();return n(h=>({layers:[...h.layers,{id:c,name:s,color:o,categories:a,points:l,visible:!0,archived:!1,createdAt:new Date().toISOString()}],colorIndex:h.colorIndex+1})),{success:!0,layerId:c}}catch{return{success:!1,error:"Fout bij parsen van GeoJSON"}}},getLayer:t=>e().layers.find(r=>r.id===t),getActiveLayerCount:()=>e().layers.filter(t=>!t.archived).length,getArchivedLayerCount:()=>e().layers.filter(t=>t.archived).length,clearAll:()=>{n(t=>({layers:t.layers.map(r=>r.id===uo?{...r,points:[]}:r).filter(r=>r.id===uo),colorIndex:0}))}}),{name:"detectorapp-custom-point-layers",version:3,migrate:(n,e)=>{const t=n;return e<2?{...t,layers:Jue(t.layers||[])}:e<3?{...t,layers:(t.layers||[]).map(r=>r.id===uo?{...r,name:"Mijn vondsten"}:r)}:t}}));function ji({title:n,children:e,defaultExpanded:t=!0,layerNames:r}){const[i,s]=X.useState(t),a=Ri(w=>w.visible),o=Ri(w=>w.setLayerVisibility),l=iC(w=>w.isLayerUnlocked),c=w=>{const S=Ww[w],b=S?.tier??"free",R=S?.regions??["nl"];return l(w,b,R)},h=r?.filter(w=>c(w))||[],f=h.filter(w=>a[w]).length,m=h.length,y=m>0&&f===m,x=f>0&&f<m,_=w=>{if(w.stopPropagation(),!r||h.length===0)return;const S=!y;h.forEach(b=>{o(b,S)})};return g.jsxs("div",{className:"mb-0.5",children:[g.jsxs("div",{className:"flex items-center gap-1 py-1 px-1 hover:bg-blue-50 transition-colors",children:[g.jsxs("button",{onClick:w=>{w.stopPropagation(),s(!i)},className:"flex-1 flex items-center gap-1 bg-transparent border-0 outline-none text-left",style:{fontSize:"inherit"},children:[g.jsx(Rt.span,{animate:{rotate:i?90:0},transition:{duration:.15},className:"text-gray-400",children:g.jsx(Jy,{size:14})}),i?g.jsx(fce,{size:16,className:"text-blue-500"}):g.jsx(yce,{size:16,className:"text-blue-500"}),g.jsx("span",{className:"text-gray-700 font-medium",style:{fontSize:"1em"},children:n}),f>0&&g.jsx("span",{className:"ml-1 px-1.5 py-0.5 font-medium bg-blue-100 text-blue-600 rounded-full",style:{fontSize:"0.7em"},children:f})]}),r&&r.length>0&&g.jsx("button",{onClick:_,className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:y?"#3b82f6":x?"#93c5fd":"white",border:y?"2px solid #3b82f6":"2px solid #60a5fa",color:"white"},children:(y||x)&&g.jsx("svg",{width:"10",height:"10",viewBox:"0 0 10 10",children:g.jsx("path",{d:"M2 5 L4 7 L8 3",stroke:"currentColor",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),g.jsx($n,{initial:!1,children:i&&g.jsx(Rt.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.15},style:{overflow:"hidden"},className:"ml-5",children:e})})]})}function dt({name:n,type:e,hasOverlay:t}){const r=Ri(R=>R.visible[n]),i=Ri(R=>R.visible["Labels Overlay"]),s=Ri(R=>R.loadingState[n]),a=Ri(R=>R.toggleLayer),o=Ri(R=>R.setLayerVisibility),l=iC(R=>R.isLayerUnlocked),c=s==="loading",h=s==="error",f=Ww[n],m=f?.tier??"free",y=f?.regions??["nl"],_=!l(n,m,y),w=R=>{R.stopPropagation(),!(c||_)&&(e==="overlay"?a(n):["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"].forEach(O=>{o(O,O===n)}))},S=R=>{R.stopPropagation(),o("Labels Overlay",!i)},b=r??!1;return g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsxs("button",{onClick:w,disabled:c||_,className:`flex-1 flex items-center justify-between py-1 pl-3 pr-2 border-0 outline-none transition-colors text-left ${_?"opacity-50 cursor-not-allowed bg-gray-50":c?"opacity-70 cursor-wait bg-transparent":b?"bg-blue-50 hover:bg-blue-100":"bg-transparent hover:bg-blue-50"}`,style:{fontSize:"inherit"},title:_?"Premium laag - upgrade om te ontgrendelen":void 0,children:[g.jsxs("span",{className:`flex items-center gap-1 ${h?"text-red-500":_?"text-gray-400":"text-gray-600"}`,children:[n,h&&g.jsx(pV,{size:12,className:"text-red-500"}),_&&g.jsx(PR,{size:12,className:"text-amber-500"})]}),g.jsx("div",{className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:_?"#e5e7eb":c?"#93c5fd":b?"#3b82f6":"white",border:_?"2px solid #d1d5db":c?"2px solid #93c5fd":b?"2px solid #3b82f6":"2px solid #60a5fa",color:"white"},children:_?g.jsx(PR,{size:10,strokeWidth:3,className:"text-gray-400"}):c?g.jsx(zC,{size:10,strokeWidth:3,className:"animate-spin"}):b?g.jsx(uc,{size:12,strokeWidth:3}):null})]}),t&&b&&g.jsx("button",{onClick:S,className:`p-1 rounded transition-colors border-0 outline-none ${i?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-400 hover:bg-gray-200"}`,title:i?"Labels verbergen":"Labels tonen",children:g.jsx(Rue,{size:12})})]})}const Que=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899","#6b7280"];function SV({layer:n,compact:e=!1}){const{toggleVisibility:t,removeLayer:r,updateLayer:i,setColor:s}=Ky(),[a,o]=X.useState(!1),[l,c]=X.useState(!1),[h,f]=X.useState(n.name),[m,y]=X.useState(!1),x=X.useRef(null),_=X.useRef(null),w=n.features.features.length,S=[...new Set(n.features.features.map(A=>A.geometry?.type).filter(Boolean))];X.useEffect(()=>{l&&x.current&&(x.current.focus(),x.current.select())},[l]),X.useEffect(()=>{const A=I=>{_.current&&!_.current.contains(I.target)&&y(!1)};if(m)return document.addEventListener("mousedown",A),()=>document.removeEventListener("mousedown",A)},[m]);const b=()=>{a?r(n.id):(o(!0),setTimeout(()=>o(!1),3e3))},R=()=>{const A=h.trim();A&&A!==n.name&&i(n.id,{name:A}),c(!1)},M=()=>{f(n.name),c(!1)},O=A=>{A.key==="Enter"?R():A.key==="Escape"&&M()},G=A=>{s(n.id,A),y(!1)};return e?g.jsxs("div",{className:"flex items-center gap-1 py-0.5 px-1 hover:bg-blue-50 transition-colors rounded",children:[g.jsx("button",{onClick:()=>t(n.id),className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:n.visible?n.color:"white",border:`2px solid ${n.color}`},title:n.visible?"Verbergen":"Tonen",children:n.visible&&g.jsx("svg",{width:"10",height:"10",viewBox:"0 0 10 10",children:g.jsx("path",{d:"M2 5 L4 7 L8 3",stroke:"white",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})})}),g.jsx("span",{className:"text-gray-700 truncate flex-1 cursor-pointer",style:{fontSize:"0.9em"},onClick:()=>t(n.id),children:n.name}),g.jsx("span",{className:"text-[10px] text-gray-400 flex-shrink-0",children:w})]}):g.jsxs("div",{className:"flex items-center justify-between py-1.5 group",children:[g.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[g.jsxs("div",{className:"relative",ref:_,children:[g.jsx("button",{onClick:()=>y(!m),className:"w-5 h-5 rounded border-2 border-white shadow-sm flex-shrink-0 hover:scale-110 transition-transform",style:{backgroundColor:n.color},title:"Kleur wijzigen"}),m&&g.jsx("div",{className:"absolute top-6 left-0 z-50 bg-white rounded-lg shadow-lg border p-2 grid grid-cols-3 gap-1",children:Que.map(A=>g.jsx("button",{onClick:()=>G(A),className:`w-6 h-6 rounded border-2 transition-transform hover:scale-110 ${A===n.color?"border-gray-800 scale-110":"border-white"}`,style:{backgroundColor:A},title:A},A))})]}),g.jsx("div",{className:"flex-1 min-w-0",children:l?g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx("input",{ref:x,type:"text",value:h,onChange:A=>f(A.target.value),onKeyDown:O,className:"flex-1 text-sm px-1 py-0.5 border rounded min-w-0"}),g.jsx("button",{onClick:R,className:"p-0.5 text-green-600 hover:bg-green-50 rounded",title:"Opslaan",children:g.jsx(uc,{size:14})}),g.jsx("button",{onClick:M,className:"p-0.5 text-gray-400 hover:bg-gray-100 rounded",title:"Annuleren",children:g.jsx(si,{size:14})})]}):g.jsxs(g.Fragment,{children:[g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx("span",{className:"text-sm text-gray-700 truncate",children:n.name}),g.jsx("button",{onClick:()=>c(!0),className:"p-0.5 text-gray-400 hover:text-blue-500 opacity-0 group-hover:opacity-100 transition-opacity",title:"Naam wijzigen",children:g.jsx(rg,{size:12})})]}),g.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-400",children:[g.jsxs("span",{children:[w," ",w===1?"feature":"features"]}),S.length>0&&g.jsxs(g.Fragment,{children:[g.jsx("span",{className:"mx-0.5",children:""}),g.jsx("span",{children:S.join(", ")})]})]})]})})]}),g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx("button",{onClick:()=>t(n.id),className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:n.visible?n.color:"white",border:`2px solid ${n.visible?n.color:"#9ca3af"}`},title:n.visible?"Verbergen":"Tonen",children:n.visible&&g.jsx("svg",{width:"10",height:"10",viewBox:"0 0 10 10",children:g.jsx("path",{d:"M2 5 L4 7 L8 3",stroke:"white",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})})}),g.jsx("button",{onClick:b,className:`p-1 rounded transition-colors border-0 outline-none ${a?"text-white bg-red-500 hover:bg-red-600":"text-gray-400 hover:text-red-500 hover:bg-red-50"}`,title:a?"Klik nogmaals om te verwijderen":"Verwijderen",children:g.jsx(xc,{size:14})})]})]})}const ehe=[{name:"Rapa Nui - Moai Productie",url:"https://arcg.is/qu59O1",desc:"Paaseiland steengroeve in 3D"},{name:"Digital Giza - Piramides",url:"http://giza.fas.harvard.edu/giza3d/",desc:"Harvard 3D reconstructie"},{name:"Stonehenge 360",url:"https://www.english-heritage.org.uk/visit/places/stonehenge/history-and-stories/stonehenge360/",desc:"English Heritage virtuele tour"},{name:"Pompeii 3D Explorer",url:"https://www.cyark.org/projects/pompeii/3D-Explorer",desc:"CyArk LiDAR scans"},{name:"Virtual Angkor Wat",url:"https://www.virtualangkor.com/",desc:"3D reconstructie 1300 n.Chr."},{name:"Petra Virtuele Tour",url:"https://www.zamaniproject.org/site-jordan-petra.html",desc:"Zamani Project 3D"}],the=[{name:"CyArk (200+ sites)",url:"https://www.cyark.org/projects/",desc:"Wereldwijd erfgoed archief"},{name:"Google Open Heritage",url:"https://artsandculture.google.com/project/openheritage",desc:"26+ UNESCO sites in 3D"}];function nhe(){const{themesPanelOpen:n,toggleThemesPanel:e,toggleSettingsPanel:t}=wr(),{layers:r,toggleVisibility:i}=hs(),s=Ky(y=>y.layers),a=X.useRef(null),o=Sn(y=>y.layerPanelFontScale),l=Sn(y=>y.setLayerPanelFontScale),c=Sn(y=>y.showFontSliders),h=13*o/100,[f,m]=X.useState(!1);return X.useEffect(()=>{if(!n)return;const y=_=>{a.current&&!a.current.contains(_.target)&&e()},x=setTimeout(()=>{document.addEventListener("click",y)},100);return()=>{clearTimeout(x),document.removeEventListener("click",y)}},[n,e]),g.jsx($n,{children:n&&g.jsxs(Rt.div,{ref:a,className:"fixed top-2.5 right-2 z-[1101] bg-white rounded-lg shadow-lg overflow-hidden w-[300px] max-h-[calc(100vh-200px)] flex flex-col",initial:{opacity:0,x:10},animate:{opacity:1,x:0},exit:{opacity:0,x:10},transition:{duration:.15},children:[g.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-blue-500",style:{fontSize:`${h}px`},children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(za,{size:14,className:"text-white"}),g.jsx("span",{className:"font-medium text-white",children:"Kaartlagen"})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[c&&g.jsxs(g.Fragment,{children:[g.jsx("span",{className:"text-[10px] text-blue-200",children:"T"}),g.jsx("input",{type:"range",min:"80",max:"130",step:"10",value:o,onInput:y=>{l(parseInt(y.target.value))},onChange:y=>l(parseInt(y.target.value)),className:"w-20 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${o}%`}),g.jsx("span",{className:"text-xs text-blue-200",children:"T"})]}),g.jsx("button",{onClick:e,className:"p-0.5 rounded border-0 outline-none bg-blue-400/50 hover:bg-blue-400 transition-colors ml-1",children:g.jsx(si,{size:16,className:"text-white",strokeWidth:2.5})})]})]}),g.jsxs("div",{className:"p-2 overflow-y-auto flex-1",style:{fontSize:`${h}px`},children:[r.filter(y=>!y.archived).length>0&&g.jsxs("div",{className:"mb-2 pb-1 border-b border-gray-100",children:[g.jsx("div",{className:"flex items-center gap-1 py-0.5 px-1 mb-1",children:g.jsx("span",{className:"text-orange-600 font-medium",style:{fontSize:"0.9em"},children:"Mijn lagen"})}),r.filter(y=>!y.archived).map(y=>g.jsxs("button",{onClick:x=>{x.stopPropagation(),i(y.id)},className:`w-full flex items-center justify-between py-1 pl-3 pr-2 border-0 outline-none transition-colors text-left ${y.visible?"bg-orange-50 hover:bg-orange-100":"bg-transparent hover:bg-orange-50"}`,style:{fontSize:"inherit"},children:[g.jsxs("span",{className:"flex items-center gap-2 text-gray-600",children:[y.name,g.jsxs("span",{className:"text-xs text-gray-400",children:["(",y.points.length,")"]})]}),g.jsx("div",{className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:y.visible?"#f97316":"white",border:y.visible?"2px solid #f97316":"2px solid #fb923c",color:"white"},children:y.visible&&g.jsx(uc,{size:12,strokeWidth:3})})]},y.id))]}),s.length>0&&g.jsxs("div",{className:"mb-2 pb-1 border-b border-gray-100",children:[g.jsxs("div",{className:"flex items-center gap-1 py-0.5 px-1 mb-1",children:[g.jsx(Qy,{size:12,className:"text-cyan-600"}),g.jsx("span",{className:"text-cyan-600 font-medium",style:{fontSize:"0.9em"},children:"Gemporteerde lagen"})]}),s.map(y=>g.jsx(SV,{layer:y,compact:!0},y.id)),g.jsx("button",{onClick:()=>{e(),t()},className:"w-full text-left py-1 pl-3 text-xs text-cyan-500 hover:text-cyan-700 hover:bg-cyan-50 transition-colors",children:"+ Laag importeren..."})]}),g.jsxs("div",{className:"mb-2",children:[g.jsx("div",{className:"flex items-center gap-1 py-1 px-1 mb-1",children:g.jsx("span",{className:"text-blue-600 font-medium",style:{fontSize:"0.95em"},children:"Basislaag"})}),g.jsxs("div",{className:"space-y-0",children:[g.jsx(dt,{name:"CartoDB (licht)",type:"base"}),g.jsx(dt,{name:"OpenStreetMap",type:"base"}),g.jsx(dt,{name:"Luchtfoto",type:"base",hasOverlay:!0}),g.jsx(dt,{name:"TMK 1850",type:"base",hasOverlay:!0}),g.jsx(dt,{name:"Bonnebladen 1900",type:"base",hasOverlay:!0})]})]}),g.jsxs("div",{className:"mb-2",children:[g.jsx("div",{className:"flex items-center gap-1 py-1 px-1 mb-1 border-t border-gray-100 pt-2",children:g.jsx("span",{className:"text-blue-600 font-medium",style:{fontSize:"0.95em"},children:"Thema's"})}),g.jsxs(ji,{title:"Steentijd & Prehistorie",defaultExpanded:!1,layerNames:["Hunebedden","Grafheuvels","Terpen"],children:[g.jsx(dt,{name:"Hunebedden",type:"overlay"}),g.jsx(dt,{name:"Grafheuvels",type:"overlay"}),g.jsx(dt,{name:"Terpen",type:"overlay"})]}),g.jsxs(ji,{title:"Paleokaarten",defaultExpanded:!1,layerNames:["Paleokaart 9000 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 500 v.Chr.","Paleokaart 100 n.Chr.","Paleokaart 800 n.Chr."],children:[g.jsx(dt,{name:"Paleokaart 9000 v.Chr.",type:"overlay"}),g.jsx(dt,{name:"Paleokaart 5500 v.Chr.",type:"overlay"}),g.jsx(dt,{name:"Paleokaart 2750 v.Chr.",type:"overlay"}),g.jsx(dt,{name:"Paleokaart 1500 v.Chr.",type:"overlay"}),g.jsx(dt,{name:"Paleokaart 500 v.Chr.",type:"overlay"}),g.jsx(dt,{name:"Paleokaart 100 n.Chr.",type:"overlay"}),g.jsx(dt,{name:"Paleokaart 800 n.Chr.",type:"overlay"})]}),g.jsxs(ji,{title:"Archeologische lagen",defaultExpanded:!1,layerNames:["FAMKE Steentijd","FAMKE IJzertijd","AMK Monumenten","AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig","Archeo Onderzoeken","Romeinse wegen (regio)","Romeinse wegen (Wereld)","Romeinse Forten","Romeinse Forten Lijnen"],children:[g.jsx(dt,{name:"FAMKE Steentijd",type:"overlay"}),g.jsx(dt,{name:"FAMKE IJzertijd",type:"overlay"}),g.jsx(dt,{name:"AMK Monumenten",type:"overlay"}),g.jsxs(ji,{title:"AMK per periode",defaultExpanded:!1,layerNames:["AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig"],children:[g.jsx(dt,{name:"AMK Romeins",type:"overlay"}),g.jsx(dt,{name:"AMK Steentijd",type:"overlay"}),g.jsx(dt,{name:"AMK Vroege ME",type:"overlay"}),g.jsx(dt,{name:"AMK Late ME",type:"overlay"}),g.jsx(dt,{name:"AMK Overig",type:"overlay"})]}),g.jsx(dt,{name:"Archeo Onderzoeken",type:"overlay"}),g.jsxs(ji,{title:"Romeinse tijd",defaultExpanded:!1,layerNames:["Romeinse wegen (regio)","Romeinse wegen (Wereld)","Romeinse Forten","Romeinse Forten Lijnen"],children:[g.jsx(dt,{name:"Romeinse wegen (regio)",type:"overlay"}),g.jsx(dt,{name:"Romeinse wegen (Wereld)",type:"overlay"}),g.jsx(dt,{name:"Romeinse Forten",type:"overlay"}),g.jsx(dt,{name:"Romeinse Forten Lijnen",type:"overlay"})]})]}),g.jsxs(ji,{title:"Archeologische verwachtingen",defaultExpanded:!1,layerNames:["IKAW","UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling"],children:[g.jsx(dt,{name:"IKAW",type:"overlay"}),g.jsx(dt,{name:"UIKAV Punten",type:"overlay"}),g.jsx(dt,{name:"UIKAV Vlakken",type:"overlay"}),g.jsx(dt,{name:"UIKAV Expert",type:"overlay"}),g.jsx(dt,{name:"UIKAV Buffer",type:"overlay"}),g.jsx(dt,{name:"UIKAV Indeling",type:"overlay"})]}),g.jsxs(ji,{title:"Erfgoed & Monumenten",defaultExpanded:!1,layerNames:["Rijksmonumenten","Werelderfgoed","Religieus Erfgoed","Kastelen","Runes"],children:[g.jsx(dt,{name:"Rijksmonumenten",type:"overlay"}),g.jsx(dt,{name:"Werelderfgoed",type:"overlay"}),g.jsx(dt,{name:"Religieus Erfgoed",type:"overlay"}),g.jsx(dt,{name:"Kastelen",type:"overlay"}),g.jsx(dt,{name:"Runes",type:"overlay"})]}),g.jsxs(ji,{title:"WOII & Militair",defaultExpanded:!1,layerNames:["WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Militaire Objecten","Inundatiegebieden"],children:[g.jsx(dt,{name:"WWII Bunkers",type:"overlay"}),g.jsx(dt,{name:"Slagvelden",type:"overlay"}),g.jsx(dt,{name:"Militaire Vliegvelden",type:"overlay"}),g.jsx(dt,{name:"Verdedigingslinies",type:"overlay"}),g.jsx(dt,{name:"Militaire Objecten",type:"overlay"}),g.jsx(dt,{name:"Inundatiegebieden",type:"overlay"})]}),g.jsxs(ji,{title:"Hillshade & LiDAR",defaultExpanded:!1,layerNames:["Hoogtekaart (WebGL)","AHN4 Hoogtekaart Kleur","AHN4 Hillshade NL","AHN4 Multi-Hillshade NL","AHN 0.5m"],children:[g.jsx(dt,{name:"Hoogtekaart (WebGL)",type:"overlay"}),g.jsx(dt,{name:"AHN4 Hoogtekaart Kleur",type:"overlay"}),g.jsx(dt,{name:"AHN4 Hillshade NL",type:"overlay"}),g.jsx(dt,{name:"AHN4 Multi-Hillshade NL",type:"overlay"}),g.jsx(dt,{name:"AHN 0.5m",type:"overlay"})]}),g.jsxs(ji,{title:"Terrein & Bodem",defaultExpanded:!1,layerNames:["Veengebieden","Geomorfologie","Bodemkaart","Essen"],children:[g.jsx(dt,{name:"Veengebieden",type:"overlay"}),g.jsx(dt,{name:"Geomorfologie",type:"overlay"}),g.jsx(dt,{name:"Bodemkaart",type:"overlay"}),g.jsx(dt,{name:"Essen",type:"overlay"})]}),g.jsxs(ji,{title:"Percelen",defaultExpanded:!1,layerNames:["Gewaspercelen","Kadastrale Grenzen"],children:[g.jsx(dt,{name:"Gewaspercelen",type:"overlay"}),g.jsx(dt,{name:"Kadastrale Grenzen",type:"overlay"})]}),g.jsxs(ji,{title:"Provinciale Thema's",defaultExpanded:!1,layerNames:["Scheepswrakken","Woonheuvels ZH","Windmolens","Erfgoedlijnen","Oude Kernen","Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken","Verdronken Dorpen"],children:[g.jsxs(ji,{title:"Zuid-Holland",defaultExpanded:!1,layerNames:["Scheepswrakken","Woonheuvels ZH","Windmolens","Erfgoedlijnen","Oude Kernen"],children:[g.jsx(dt,{name:"Scheepswrakken",type:"overlay"}),g.jsx(dt,{name:"Woonheuvels ZH",type:"overlay"}),g.jsx(dt,{name:"Windmolens",type:"overlay"}),g.jsx(dt,{name:"Erfgoedlijnen",type:"overlay"}),g.jsx(dt,{name:"Oude Kernen",type:"overlay"})]}),g.jsxs(ji,{title:"Gelderland",defaultExpanded:!1,layerNames:["Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken"],children:[g.jsx(dt,{name:"Relictenkaart Punten",type:"overlay"}),g.jsx(dt,{name:"Relictenkaart Lijnen",type:"overlay"}),g.jsx(dt,{name:"Relictenkaart Vlakken",type:"overlay"})]}),g.jsx(ji,{title:"Zeeland",defaultExpanded:!1,layerNames:["Verdronken Dorpen"],children:g.jsx(dt,{name:"Verdronken Dorpen",type:"overlay"})})]}),g.jsxs(ji,{title:"Fossielen, Mineralen & Goud",defaultExpanded:!1,layerNames:["Fossiel Hotspots","Mineralen Hotspots","Goudrivieren","Fossielen Nederland","Fossielen Belgi","Fossielen Duitsland","Fossielen Frankrijk"],children:[g.jsx(dt,{name:"Fossiel Hotspots",type:"overlay"}),g.jsx(dt,{name:"Mineralen Hotspots",type:"overlay"}),g.jsx(dt,{name:"Goudrivieren",type:"overlay"}),g.jsx(dt,{name:"Fossielen Nederland",type:"overlay"}),g.jsx(dt,{name:"Fossielen Belgi",type:"overlay"}),g.jsx(dt,{name:"Fossielen Duitsland",type:"overlay"}),g.jsx(dt,{name:"Fossielen Frankrijk",type:"overlay"})]}),g.jsxs(ji,{title:"Recreatie",defaultExpanded:!1,layerNames:["Wandelroutes","Ruiterpaden","Laarzenpaden","Parken","Speeltuinen","Musea","Strandjes","Kringloopwinkels"],children:[g.jsx(dt,{name:"Wandelroutes",type:"overlay"}),g.jsx(dt,{name:"Ruiterpaden",type:"overlay"}),g.jsx(dt,{name:"Laarzenpaden",type:"overlay"}),g.jsx(dt,{name:"Parken",type:"overlay"}),g.jsx(dt,{name:"Speeltuinen",type:"overlay"}),g.jsx(dt,{name:"Musea",type:"overlay"}),g.jsx(dt,{name:"Strandjes",type:"overlay"}),g.jsx(dt,{name:"Kringloopwinkels",type:"overlay"})]}),g.jsxs("div",{className:"mb-2",children:[g.jsxs("button",{onClick:y=>{y.stopPropagation(),m(!f)},className:"w-full flex items-center gap-1 py-1 px-1 hover:bg-purple-50 rounded transition-colors border-0 outline-none bg-transparent",children:[f?g.jsx(PE,{size:14,className:"text-purple-500"}):g.jsx(Jy,{size:14,className:"text-purple-500"}),g.jsx(Tce,{size:12,className:"text-purple-500"}),g.jsx("span",{className:"text-purple-600 font-medium",style:{fontSize:"0.95em"},children:"Speciale Projecten"}),g.jsx(Iu,{size:10,className:"text-purple-400 ml-auto"})]}),f&&g.jsxs("div",{className:"mt-1",onClick:y=>y.stopPropagation(),children:[ehe.map(y=>g.jsxs("a",{href:y.url,target:"_blank",rel:"noopener noreferrer",onClick:x=>x.stopPropagation(),className:"w-full flex items-center justify-between py-1.5 pl-6 pr-2 hover:bg-purple-50 rounded transition-colors text-left",style:{fontSize:"inherit"},children:[g.jsxs("div",{className:"flex flex-col",children:[g.jsx("span",{className:"text-gray-700",children:y.name}),g.jsx("span",{className:"text-gray-400",style:{fontSize:"0.8em"},children:y.desc})]}),g.jsx(Iu,{size:12,className:"text-purple-400 flex-shrink-0 ml-2"})]},y.name)),g.jsx("div",{className:"border-t border-gray-200 my-1.5 mx-2"}),the.map(y=>g.jsxs("a",{href:y.url,target:"_blank",rel:"noopener noreferrer",onClick:x=>x.stopPropagation(),className:"w-full flex items-center justify-between py-1.5 pl-6 pr-2 hover:bg-purple-50 rounded transition-colors text-left",style:{fontSize:"inherit"},children:[g.jsxs("div",{className:"flex flex-col",children:[g.jsx("span",{className:"text-gray-700 font-medium",children:y.name}),g.jsx("span",{className:"text-gray-400",style:{fontSize:"0.8em"},children:y.desc})]}),g.jsx(Iu,{size:12,className:"text-purple-400 flex-shrink-0 ml-2"})]},y.name))]})]})]})]})]})})}function rhe(n){n("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),n("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),n("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs");for(var e=1;e<=60;++e)n("EPSG:"+(32600+e),"+proj=utm +zone="+e+" +datum=WGS84 +units=m"),n("EPSG:"+(32700+e),"+proj=utm +zone="+e+" +south +datum=WGS84 +units=m");n("EPSG:5041","+title=WGS 84 / UPS North (E,N) +proj=stere +lat_0=90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m"),n("EPSG:5042","+title=WGS 84 / UPS South (E,N) +proj=stere +lat_0=-90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m"),n.WGS84=n["EPSG:4326"],n["EPSG:3785"]=n["EPSG:3857"],n.GOOGLE=n["EPSG:3857"],n["EPSG:900913"]=n["EPSG:3857"],n["EPSG:102113"]=n["EPSG:3857"]}var vd=1,wd=2,T0=3,ihe=4,LR=5,ZO=6378137,she=6356752314e-3,JO=.0066943799901413165,np=484813681109536e-20,We=Math.PI/2,ahe=.16666666666666666,ohe=.04722222222222222,lhe=.022156084656084655,ct=1e-10,Dr=.017453292519943295,Bs=57.29577951308232,zn=Math.PI/4,ry=Math.PI*2,Wr=3.14159265359,qs={};qs.greenwich=0;qs.lisbon=-9.131906111111;qs.paris=2.337229166667;qs.bogota=-74.080916666667;qs.madrid=-3.687938888889;qs.rome=12.452333333333;qs.bern=7.439583333333;qs.jakarta=106.807719444444;qs.ferro=-17.666666666667;qs.brussels=4.367975;qs.stockholm=18.058277777778;qs.athens=23.7163375;qs.oslo=10.722916666667;const che={mm:{to_meter:.001},cm:{to_meter:.01},ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937},fath:{to_meter:1.8288},kmi:{to_meter:1852},"us-ch":{to_meter:20.1168402336805},"us-mi":{to_meter:1609.34721869444},km:{to_meter:1e3},"ind-ft":{to_meter:.30479841},"ind-yd":{to_meter:.91439523},mi:{to_meter:1609.344},yd:{to_meter:.9144},ch:{to_meter:20.1168},link:{to_meter:.201168},dm:{to_meter:.1},in:{to_meter:.0254},"ind-ch":{to_meter:20.11669506},"us-in":{to_meter:.025400050800101},"us-yd":{to_meter:.914401828803658}};var QO=/[\s_\-\/\(\)]/g;function Vu(n,e){if(n[e])return n[e];for(var t=Object.keys(n),r=e.toLowerCase().replace(QO,""),i=-1,s,a;++i<t.length;)if(s=t[i],a=s.toLowerCase().replace(QO,""),a===r)return n[s]}function OR(n){var e={},t=n.split("+").map(function(o){return o.trim()}).filter(function(o){return o}).reduce(function(o,l){var c=l.split("=");return c.push(!0),o[c[0].toLowerCase()]=c[1],o},{}),r,i,s,a={proj:"projName",datum:"datumCode",rf:function(o){e.rf=parseFloat(o)},lat_0:function(o){e.lat0=o*Dr},lat_1:function(o){e.lat1=o*Dr},lat_2:function(o){e.lat2=o*Dr},lat_ts:function(o){e.lat_ts=o*Dr},lon_0:function(o){e.long0=o*Dr},lon_1:function(o){e.long1=o*Dr},lon_2:function(o){e.long2=o*Dr},alpha:function(o){e.alpha=parseFloat(o)*Dr},gamma:function(o){e.rectified_grid_angle=parseFloat(o)*Dr},lonc:function(o){e.longc=o*Dr},x_0:function(o){e.x0=parseFloat(o)},y_0:function(o){e.y0=parseFloat(o)},k_0:function(o){e.k0=parseFloat(o)},k:function(o){e.k0=parseFloat(o)},a:function(o){e.a=parseFloat(o)},b:function(o){e.b=parseFloat(o)},r:function(o){e.a=e.b=parseFloat(o)},r_a:function(){e.R_A=!0},zone:function(o){e.zone=parseInt(o,10)},south:function(){e.utmSouth=!0},towgs84:function(o){e.datum_params=o.split(",").map(function(l){return parseFloat(l)})},to_meter:function(o){e.to_meter=parseFloat(o)},units:function(o){e.units=o;var l=Vu(che,o);l&&(e.to_meter=l.to_meter)},from_greenwich:function(o){e.from_greenwich=o*Dr},pm:function(o){var l=Vu(qs,o);e.from_greenwich=(l||parseFloat(o))*Dr},nadgrids:function(o){o==="@null"?e.datumCode="none":e.nadgrids=o},axis:function(o){var l="ewnsud";o.length===3&&l.indexOf(o.substr(0,1))!==-1&&l.indexOf(o.substr(1,1))!==-1&&l.indexOf(o.substr(2,1))!==-1&&(e.axis=o)},approx:function(){e.approx=!0},over:function(){e.over=!0}};for(r in t)i=t[r],r in a?(s=a[r],typeof s=="function"?s(i):e[s]=i):e[r]=i;return typeof e.datumCode=="string"&&e.datumCode!=="WGS84"&&(e.datumCode=e.datumCode.toLowerCase()),e.projStr=n,e}class bV{static getId(e){const t=e.find(r=>Array.isArray(r)&&r[0]==="ID");return t&&t.length>=3?{authority:t[1],code:parseInt(t[2],10)}:null}static convertUnit(e,t="unit"){if(!e||e.length<3)return{type:t,name:"unknown",conversion_factor:null};const r=e[1],i=parseFloat(e[2])||null,s=e.find(o=>Array.isArray(o)&&o[0]==="ID"),a=s?{authority:s[1],code:parseInt(s[2],10)}:null;return{type:t,name:r,conversion_factor:i,id:a}}static convertAxis(e){const t=e[1]||"Unknown";let r;const i=t.match(/^\((.)\)$/);if(i){const c=i[1].toUpperCase();if(c==="E")r="east";else if(c==="N")r="north";else if(c==="U")r="up";else throw new Error(`Unknown axis abbreviation: ${c}`)}else r=e[2]?e[2].toLowerCase():"unknown";const s=e.find(c=>Array.isArray(c)&&c[0]==="ORDER"),a=s?parseInt(s[1],10):null,o=e.find(c=>Array.isArray(c)&&(c[0]==="LENGTHUNIT"||c[0]==="ANGLEUNIT"||c[0]==="SCALEUNIT")),l=this.convertUnit(o);return{name:t,direction:r,unit:l,order:a}}static extractAxes(e){return e.filter(t=>Array.isArray(t)&&t[0]==="AXIS").map(t=>this.convertAxis(t)).sort((t,r)=>(t.order||0)-(r.order||0))}static convert(e,t={}){switch(e[0]){case"PROJCRS":t.type="ProjectedCRS",t.name=e[1],t.base_crs=e.find(m=>Array.isArray(m)&&m[0]==="BASEGEOGCRS")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="BASEGEOGCRS")):null,t.conversion=e.find(m=>Array.isArray(m)&&m[0]==="CONVERSION")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="CONVERSION")):null;const r=e.find(m=>Array.isArray(m)&&m[0]==="CS");r&&(t.coordinate_system={type:r[1],axis:this.extractAxes(e)});const i=e.find(m=>Array.isArray(m)&&m[0]==="LENGTHUNIT");if(i){const m=this.convertUnit(i);t.coordinate_system.unit=m}t.id=this.getId(e);break;case"BASEGEOGCRS":case"GEOGCRS":t.type="GeographicCRS",t.name=e[1];const s=e.find(m=>Array.isArray(m)&&(m[0]==="DATUM"||m[0]==="ENSEMBLE"));if(s){const m=this.convert(s);s[0]==="ENSEMBLE"?t.datum_ensemble=m:t.datum=m;const y=e.find(x=>Array.isArray(x)&&x[0]==="PRIMEM");y&&y[1]!=="Greenwich"&&(m.prime_meridian={name:y[1],longitude:parseFloat(y[2])})}t.coordinate_system={type:"ellipsoidal",axis:this.extractAxes(e)},t.id=this.getId(e);break;case"DATUM":t.type="GeodeticReferenceFrame",t.name=e[1],t.ellipsoid=e.find(m=>Array.isArray(m)&&m[0]==="ELLIPSOID")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="ELLIPSOID")):null;break;case"ENSEMBLE":t.type="DatumEnsemble",t.name=e[1],t.members=e.filter(m=>Array.isArray(m)&&m[0]==="MEMBER").map(m=>({type:"DatumEnsembleMember",name:m[1],id:this.getId(m)}));const a=e.find(m=>Array.isArray(m)&&m[0]==="ENSEMBLEACCURACY");a&&(t.accuracy=parseFloat(a[1]));const o=e.find(m=>Array.isArray(m)&&m[0]==="ELLIPSOID");o&&(t.ellipsoid=this.convert(o)),t.id=this.getId(e);break;case"ELLIPSOID":t.type="Ellipsoid",t.name=e[1],t.semi_major_axis=parseFloat(e[2]),t.inverse_flattening=parseFloat(e[3]),e.find(m=>Array.isArray(m)&&m[0]==="LENGTHUNIT")&&this.convert(e.find(m=>Array.isArray(m)&&m[0]==="LENGTHUNIT"),t);break;case"CONVERSION":t.type="Conversion",t.name=e[1],t.method=e.find(m=>Array.isArray(m)&&m[0]==="METHOD")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="METHOD")):null,t.parameters=e.filter(m=>Array.isArray(m)&&m[0]==="PARAMETER").map(m=>this.convert(m));break;case"METHOD":t.type="Method",t.name=e[1],t.id=this.getId(e);break;case"PARAMETER":t.type="Parameter",t.name=e[1],t.value=parseFloat(e[2]),t.unit=this.convertUnit(e.find(m=>Array.isArray(m)&&(m[0]==="LENGTHUNIT"||m[0]==="ANGLEUNIT"||m[0]==="SCALEUNIT"))),t.id=this.getId(e);break;case"BOUNDCRS":t.type="BoundCRS";const l=e.find(m=>Array.isArray(m)&&m[0]==="SOURCECRS");if(l){const m=l.find(y=>Array.isArray(y));t.source_crs=m?this.convert(m):null}const c=e.find(m=>Array.isArray(m)&&m[0]==="TARGETCRS");if(c){const m=c.find(y=>Array.isArray(y));t.target_crs=m?this.convert(m):null}const h=e.find(m=>Array.isArray(m)&&m[0]==="ABRIDGEDTRANSFORMATION");h?t.transformation=this.convert(h):t.transformation=null;break;case"ABRIDGEDTRANSFORMATION":if(t.type="Transformation",t.name=e[1],t.method=e.find(m=>Array.isArray(m)&&m[0]==="METHOD")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="METHOD")):null,t.parameters=e.filter(m=>Array.isArray(m)&&(m[0]==="PARAMETER"||m[0]==="PARAMETERFILE")).map(m=>{if(m[0]==="PARAMETER")return this.convert(m);if(m[0]==="PARAMETERFILE")return{name:m[1],value:m[2],id:{authority:"EPSG",code:8656}}}),t.parameters.length===7){const m=t.parameters[6];m.name==="Scale difference"&&(m.value=Math.round((m.value-1)*1e12)/1e6)}t.id=this.getId(e);break;case"AXIS":t.coordinate_system||(t.coordinate_system={type:"unspecified",axis:[]}),t.coordinate_system.axis.push(this.convertAxis(e));break;case"LENGTHUNIT":const f=this.convertUnit(e,"LinearUnit");t.coordinate_system&&t.coordinate_system.axis&&t.coordinate_system.axis.forEach(m=>{m.unit||(m.unit=f)}),f.conversion_factor&&f.conversion_factor!==1&&t.semi_major_axis&&(t.semi_major_axis={value:t.semi_major_axis,unit:f});break;default:t.keyword=e[0];break}return t}}class uhe extends bV{static convert(e,t={}){return super.convert(e,t),t.coordinate_system&&t.coordinate_system.subtype==="Cartesian"&&delete t.coordinate_system,t.usage&&delete t.usage,t}}class hhe extends bV{static convert(e,t={}){super.convert(e,t);const r=e.find(s=>Array.isArray(s)&&s[0]==="CS");r&&(t.coordinate_system={subtype:r[1],axis:this.extractAxes(e)});const i=e.find(s=>Array.isArray(s)&&s[0]==="USAGE");if(i){const s=i.find(l=>Array.isArray(l)&&l[0]==="SCOPE"),a=i.find(l=>Array.isArray(l)&&l[0]==="AREA"),o=i.find(l=>Array.isArray(l)&&l[0]==="BBOX");t.usage={},s&&(t.usage.scope=s[1]),a&&(t.usage.area=a[1]),o&&(t.usage.bbox=o.slice(1))}return t}}function dhe(n){return n.find(e=>Array.isArray(e)&&e[0]==="USAGE")?"2019":(n.find(e=>Array.isArray(e)&&e[0]==="CS")||n[0]==="BOUNDCRS"||n[0]==="PROJCRS"||n[0]==="GEOGCRS","2015")}function fhe(n){return(dhe(n)==="2019"?hhe:uhe).convert(n)}function ghe(n){const e=n.toUpperCase();return e.includes("PROJCRS")||e.includes("GEOGCRS")||e.includes("BOUNDCRS")||e.includes("VERTCRS")||e.includes("LENGTHUNIT")||e.includes("ANGLEUNIT")||e.includes("SCALEUNIT")?"WKT2":(e.includes("PROJCS")||e.includes("GEOGCS")||e.includes("LOCAL_CS")||e.includes("VERT_CS")||e.includes("UNIT"),"WKT1")}var iy=1,RV=2,AV=3,zv=4,IV=5,KC=-1,mhe=/\s/,phe=/[A-Za-z]/,yhe=/[A-Za-z84_]/,ME=/[,\]]/,CV=/[\d\.E\-\+]/;function _c(n){if(typeof n!="string")throw new Error("not a string");this.text=n.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=iy}_c.prototype.readCharicter=function(){var n=this.text[this.place++];if(this.state!==zv)for(;mhe.test(n);){if(this.place>=this.text.length)return;n=this.text[this.place++]}switch(this.state){case iy:return this.neutral(n);case RV:return this.keyword(n);case zv:return this.quoted(n);case IV:return this.afterquote(n);case AV:return this.number(n);case KC:return}};_c.prototype.afterquote=function(n){if(n==='"'){this.word+='"',this.state=zv;return}if(ME.test(n)){this.word=this.word.trim(),this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in afterquote yet, index '+this.place)};_c.prototype.afterItem=function(n){if(n===","){this.word!==null&&this.currentObject.push(this.word),this.word=null,this.state=iy;return}if(n==="]"){this.level--,this.word!==null&&(this.currentObject.push(this.word),this.word=null),this.state=iy,this.currentObject=this.stack.pop(),this.currentObject||(this.state=KC);return}};_c.prototype.number=function(n){if(CV.test(n)){this.word+=n;return}if(ME.test(n)){this.word=parseFloat(this.word),this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in number yet, index '+this.place)};_c.prototype.quoted=function(n){if(n==='"'){this.state=IV;return}this.word+=n};_c.prototype.keyword=function(n){if(yhe.test(n)){this.word+=n;return}if(n==="["){var e=[];e.push(this.word),this.level++,this.root===null?this.root=e:this.currentObject.push(e),this.stack.push(this.currentObject),this.currentObject=e,this.state=iy;return}if(ME.test(n)){this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in keyword yet, index '+this.place)};_c.prototype.neutral=function(n){if(phe.test(n)){this.word=n,this.state=RV;return}if(n==='"'){this.word="",this.state=zv;return}if(CV.test(n)){this.word=n,this.state=AV;return}if(ME.test(n)){this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in neutral yet, index '+this.place)};_c.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===KC)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function xhe(n){var e=new _c(n);return e.output()}function MS(n,e,t){Array.isArray(e)&&(t.unshift(e),e=null);var r=e?{}:n,i=t.reduce(function(s,a){return c0(a,s),s},r);e&&(n[e]=i)}function c0(n,e){if(!Array.isArray(n)){e[n]=!0;return}var t=n.shift();if(t==="PARAMETER"&&(t=n.shift()),n.length===1){if(Array.isArray(n[0])){e[t]={},c0(n[0],e[t]);return}e[t]=n[0];return}if(!n.length){e[t]=!0;return}if(t==="TOWGS84"){e[t]=n;return}if(t==="AXIS"){t in e||(e[t]=[]),e[t].push(n);return}Array.isArray(t)||(e[t]={});var r;switch(t){case"UNIT":case"PRIMEM":case"VERT_DATUM":e[t]={name:n[0].toLowerCase(),convert:n[1]},n.length===3&&c0(n[2],e[t]);return;case"SPHEROID":case"ELLIPSOID":e[t]={name:n[0],a:n[1],rf:n[2]},n.length===4&&c0(n[3],e[t]);return;case"EDATUM":case"ENGINEERINGDATUM":case"LOCAL_DATUM":case"DATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":n[0]=["name",n[0]],MS(e,t,n);return;case"COMPD_CS":case"COMPOUNDCRS":case"FITTED_CS":case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"ENGCRS":case"ENGINEERINGCRS":n[0]=["name",n[0]],MS(e,t,n),e[t].type=t;return;default:for(r=-1;++r<n.length;)if(!Array.isArray(n[r]))return c0(n,e[t]);return MS(e,t,n)}}var _he=.017453292519943295;function lo(n){return n*_he}function kV(n){const e=(n.projName||"").toLowerCase().replace(/_/g," ");!n.long0&&n.longc&&(e==="albers conic equal area"||e==="lambert azimuthal equal area")&&(n.long0=n.longc),!n.lat_ts&&n.lat1&&(e==="stereographic south pole"||e==="polar stereographic (variant b)")?(n.lat0=lo(n.lat1>0?90:-90),n.lat_ts=n.lat1,delete n.lat1):!n.lat_ts&&n.lat0&&(e==="polar stereographic"||e==="polar stereographic (variant a)")&&(n.lat_ts=n.lat0,n.lat0=lo(n.lat0>0?90:-90),delete n.lat1)}function e5(n){let e={units:null,to_meter:void 0};return typeof n=="string"?(e.units=n.toLowerCase(),e.units==="metre"&&(e.units="meter"),e.units==="meter"&&(e.to_meter=1)):n&&n.name&&(e.units=n.name.toLowerCase(),e.units==="metre"&&(e.units="meter"),e.to_meter=n.conversion_factor),e}function t5(n){return typeof n=="object"?n.value*n.unit.conversion_factor:n}function n5(n,e){n.ellipsoid.radius?(e.a=n.ellipsoid.radius,e.rf=0):(e.a=t5(n.ellipsoid.semi_major_axis),n.ellipsoid.inverse_flattening!==void 0?e.rf=n.ellipsoid.inverse_flattening:n.ellipsoid.semi_major_axis!==void 0&&n.ellipsoid.semi_minor_axis!==void 0&&(e.rf=e.a/(e.a-t5(n.ellipsoid.semi_minor_axis))))}function Uv(n,e={}){return!n||typeof n!="object"?n:n.type==="BoundCRS"?(Uv(n.source_crs,e),n.transformation&&(n.transformation.method&&n.transformation.method.name==="NTv2"?e.nadgrids=n.transformation.parameters[0].value:e.datum_params=n.transformation.parameters.map(t=>t.value)),e):(Object.keys(n).forEach(t=>{const r=n[t];if(r!==null)switch(t){case"name":if(e.srsCode)break;e.name=r,e.srsCode=r;break;case"type":r==="GeographicCRS"?e.projName="longlat":r==="ProjectedCRS"&&n.conversion&&n.conversion.method&&(e.projName=n.conversion.method.name);break;case"datum":case"datum_ensemble":r.ellipsoid&&(e.ellps=r.ellipsoid.name,n5(r,e)),r.prime_meridian&&(e.from_greenwich=r.prime_meridian.longitude*Math.PI/180);break;case"ellipsoid":e.ellps=r.name,n5(r,e);break;case"prime_meridian":e.long0=(r.longitude||0)*Math.PI/180;break;case"coordinate_system":if(r.axis){if(e.axis=r.axis.map(i=>{const s=i.direction;if(s==="east")return"e";if(s==="north")return"n";if(s==="west")return"w";if(s==="south")return"s";throw new Error(`Unknown axis direction: ${s}`)}).join("")+"u",r.unit){const{units:i,to_meter:s}=e5(r.unit);e.units=i,e.to_meter=s}else if(r.axis[0]&&r.axis[0].unit){const{units:i,to_meter:s}=e5(r.axis[0].unit);e.units=i,e.to_meter=s}}break;case"id":r.authority&&r.code&&(e.title=r.authority+":"+r.code);break;case"conversion":r.method&&r.method.name&&(e.projName=r.method.name),r.parameters&&r.parameters.forEach(i=>{const s=i.name.toLowerCase().replace(/\s+/g,"_"),a=i.value;i.unit&&i.unit.conversion_factor?e[s]=a*i.unit.conversion_factor:i.unit==="degree"?e[s]=a*Math.PI/180:e[s]=a});break;case"unit":r.name&&(e.units=r.name.toLowerCase(),e.units==="metre"&&(e.units="meter")),r.conversion_factor&&(e.to_meter=r.conversion_factor);break;case"base_crs":Uv(r,e),e.datumCode=r.id?r.id.authority+"_"+r.id.code:r.name;break}}),e.latitude_of_false_origin!==void 0&&(e.lat0=e.latitude_of_false_origin),e.longitude_of_false_origin!==void 0&&(e.long0=e.longitude_of_false_origin),e.latitude_of_standard_parallel!==void 0&&(e.lat0=e.latitude_of_standard_parallel,e.lat1=e.latitude_of_standard_parallel),e.latitude_of_1st_standard_parallel!==void 0&&(e.lat1=e.latitude_of_1st_standard_parallel),e.latitude_of_2nd_standard_parallel!==void 0&&(e.lat2=e.latitude_of_2nd_standard_parallel),e.latitude_of_projection_centre!==void 0&&(e.lat0=e.latitude_of_projection_centre),e.longitude_of_projection_centre!==void 0&&(e.longc=e.longitude_of_projection_centre),e.easting_at_false_origin!==void 0&&(e.x0=e.easting_at_false_origin),e.northing_at_false_origin!==void 0&&(e.y0=e.northing_at_false_origin),e.latitude_of_natural_origin!==void 0&&(e.lat0=e.latitude_of_natural_origin),e.longitude_of_natural_origin!==void 0&&(e.long0=e.longitude_of_natural_origin),e.longitude_of_origin!==void 0&&(e.long0=e.longitude_of_origin),e.false_easting!==void 0&&(e.x0=e.false_easting),e.easting_at_projection_centre&&(e.x0=e.easting_at_projection_centre),e.false_northing!==void 0&&(e.y0=e.false_northing),e.northing_at_projection_centre&&(e.y0=e.northing_at_projection_centre),e.standard_parallel_1!==void 0&&(e.lat1=e.standard_parallel_1),e.standard_parallel_2!==void 0&&(e.lat2=e.standard_parallel_2),e.scale_factor_at_natural_origin!==void 0&&(e.k0=e.scale_factor_at_natural_origin),e.scale_factor_at_projection_centre!==void 0&&(e.k0=e.scale_factor_at_projection_centre),e.scale_factor_on_pseudo_standard_parallel!==void 0&&(e.k0=e.scale_factor_on_pseudo_standard_parallel),e.azimuth!==void 0&&(e.alpha=e.azimuth),e.azimuth_at_projection_centre!==void 0&&(e.alpha=e.azimuth_at_projection_centre),e.angle_from_rectified_to_skew_grid&&(e.rectified_grid_angle=e.angle_from_rectified_to_skew_grid),kV(e),e)}var vhe=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function whe(n,e){var t=e[0],r=e[1];!(t in n)&&r in n&&(n[t]=n[r],e.length===3&&(n[t]=e[2](n[t])))}function PV(n){for(var e=Object.keys(n),t=0,r=e.length;t<r;++t){var i=e[t];vhe.indexOf(i)!==-1&&Ehe(n[i]),typeof n[i]=="object"&&PV(n[i])}}function Ehe(n){if(n.AUTHORITY){var e=Object.keys(n.AUTHORITY)[0];e&&e in n.AUTHORITY&&(n.title=e+":"+n.AUTHORITY[e])}if(n.type==="GEOGCS"?n.projName="longlat":n.type==="LOCAL_CS"?(n.projName="identity",n.local=!0):typeof n.PROJECTION=="object"?n.projName=Object.keys(n.PROJECTION)[0]:n.projName=n.PROJECTION,n.AXIS){for(var t="",r=0,i=n.AXIS.length;r<i;++r){var s=[n.AXIS[r][0].toLowerCase(),n.AXIS[r][1].toLowerCase()];s[0].indexOf("north")!==-1||(s[0]==="y"||s[0]==="lat")&&s[1]==="north"?t+="n":s[0].indexOf("south")!==-1||(s[0]==="y"||s[0]==="lat")&&s[1]==="south"?t+="s":s[0].indexOf("east")!==-1||(s[0]==="x"||s[0]==="lon")&&s[1]==="east"?t+="e":(s[0].indexOf("west")!==-1||(s[0]==="x"||s[0]==="lon")&&s[1]==="west")&&(t+="w")}t.length===2&&(t+="u"),t.length===3&&(n.axis=t)}n.UNIT&&(n.units=n.UNIT.name.toLowerCase(),n.units==="metre"&&(n.units="meter"),n.UNIT.convert&&(n.type==="GEOGCS"?n.DATUM&&n.DATUM.SPHEROID&&(n.to_meter=n.UNIT.convert*n.DATUM.SPHEROID.a):n.to_meter=n.UNIT.convert));var a=n.GEOGCS;n.type==="GEOGCS"&&(a=n),a&&(a.DATUM?n.datumCode=a.DATUM.name.toLowerCase():n.datumCode=a.name.toLowerCase(),n.datumCode.slice(0,2)==="d_"&&(n.datumCode=n.datumCode.slice(2)),n.datumCode==="new_zealand_1949"&&(n.datumCode="nzgd49"),(n.datumCode==="wgs_1984"||n.datumCode==="world_geodetic_system_1984")&&(n.PROJECTION==="Mercator_Auxiliary_Sphere"&&(n.sphere=!0),n.datumCode="wgs84"),n.datumCode==="belge_1972"&&(n.datumCode="rnb72"),a.DATUM&&a.DATUM.SPHEROID&&(n.ellps=a.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),n.ellps.toLowerCase().slice(0,13)==="international"&&(n.ellps="intl"),n.a=a.DATUM.SPHEROID.a,n.rf=parseFloat(a.DATUM.SPHEROID.rf,10)),a.DATUM&&a.DATUM.TOWGS84&&(n.datum_params=a.DATUM.TOWGS84),~n.datumCode.indexOf("osgb_1936")&&(n.datumCode="osgb36"),~n.datumCode.indexOf("osni_1952")&&(n.datumCode="osni52"),(~n.datumCode.indexOf("tm65")||~n.datumCode.indexOf("geodetic_datum_of_1965"))&&(n.datumCode="ire65"),n.datumCode==="ch1903+"&&(n.datumCode="ch1903"),~n.datumCode.indexOf("israel")&&(n.datumCode="isr93")),n.b&&!isFinite(n.b)&&(n.b=n.a),n.rectified_grid_angle&&(n.rectified_grid_angle=lo(n.rectified_grid_angle));function o(h){var f=n.to_meter||1;return h*f}var l=function(h){return whe(n,h)},c=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",lo],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",lo],["x0","false_easting",o],["y0","false_northing",o],["long0","central_meridian",lo],["lat0","latitude_of_origin",lo],["lat0","standard_parallel_1",lo],["lat1","standard_parallel_1",lo],["lat2","standard_parallel_2",lo],["azimuth","Azimuth"],["alpha","azimuth",lo],["srsCode","name"]];c.forEach(l),kV(n)}function $v(n){if(typeof n=="object")return Uv(n);const e=ghe(n);var t=xhe(n);if(e==="WKT2"){const s=fhe(t);return Uv(s)}var r=t[0],i={};return c0(t,i),PV(i),i[r]}function Gi(n){var e=this;if(arguments.length===2){var t=arguments[1];typeof t=="string"?t.charAt(0)==="+"?Gi[n]=OR(arguments[1]):Gi[n]=$v(arguments[1]):t&&typeof t=="object"&&!("projName"in t)?Gi[n]=$v(arguments[1]):(Gi[n]=t,t||delete Gi[n])}else if(arguments.length===1){if(Array.isArray(n))return n.map(function(r){return Array.isArray(r)?Gi.apply(e,r):Gi(r)});if(typeof n=="string"){if(n in Gi)return Gi[n]}else"EPSG"in n?Gi["EPSG:"+n.EPSG]=n:"ESRI"in n?Gi["ESRI:"+n.ESRI]=n:"IAU2000"in n?Gi["IAU2000:"+n.IAU2000]=n:console.log(n);return}}rhe(Gi);function The(n){return typeof n=="string"}function She(n){return n in Gi}function bhe(n){return n.indexOf("+")!==0&&n.indexOf("[")!==-1||typeof n=="object"&&!("srsCode"in n)}var Rhe=["3857","900913","3785","102113"];function Ahe(n){var e=Vu(n,"authority");if(e){var t=Vu(e,"epsg");return t&&Rhe.indexOf(t)>-1}}function Ihe(n){var e=Vu(n,"extension");if(e)return Vu(e,"proj4")}function Che(n){return n[0]==="+"}function khe(n){if(The(n)){if(She(n))return Gi[n];if(bhe(n)){var e=$v(n);if(Ahe(e))return Gi["EPSG:3857"];var t=Ihe(e);return t?OR(t):e}if(Che(n))return OR(n)}else return"projName"in n?n:$v(n)}function r5(n,e){n=n||{};var t,r;if(!e)return n;for(r in e)t=e[r],t!==void 0&&(n[r]=t);return n}function gl(n,e,t){var r=n*e;return t/Math.sqrt(1-r*r)}function e1(n){return n<0?-1:1}function mt(n,e){return e||Math.abs(n)<=Wr?n:n-e1(n)*ry}function Eo(n,e,t){var r=n*t,i=.5*n;return r=Math.pow((1-r)/(1+r),i),Math.tan(.5*(We-e))/r}function sy(n,e){for(var t=.5*n,r,i,s=We-2*Math.atan(e),a=0;a<=15;a++)if(r=n*Math.sin(s),i=We-2*Math.atan(e*Math.pow((1-r)/(1+r),t))-s,s+=i,Math.abs(i)<=1e-10)return s;return-9999}function Phe(){var n=this.b/this.a;this.es=1-n*n,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=gl(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function Mhe(n){var e=n.x,t=n.y;if(t*Bs>90&&t*Bs<-90&&e*Bs>180&&e*Bs<-180)return null;var r,i;if(Math.abs(Math.abs(t)-We)<=ct)return null;if(this.sphere)r=this.x0+this.a*this.k0*mt(e-this.long0,this.over),i=this.y0+this.a*this.k0*Math.log(Math.tan(zn+.5*t));else{var s=Math.sin(t),a=Eo(this.e,t,s);r=this.x0+this.a*this.k0*mt(e-this.long0,this.over),i=this.y0-this.a*this.k0*Math.log(a)}return n.x=r,n.y=i,n}function Nhe(n){var e=n.x-this.x0,t=n.y-this.y0,r,i;if(this.sphere)i=We-2*Math.atan(Math.exp(-t/(this.a*this.k0)));else{var s=Math.exp(-t/(this.a*this.k0));if(i=sy(this.e,s),i===-9999)return null}return r=mt(this.long0+e/(this.a*this.k0),this.over),n.x=r,n.y=i,n}var Lhe=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","Mercator_Variant_A","merc"];const Ohe={init:Phe,forward:Mhe,inverse:Nhe,names:Lhe};function Dhe(){}function i5(n){return n}var MV=["longlat","identity"];const Fhe={init:Dhe,forward:i5,inverse:i5,names:MV};var jhe=[Ohe,Fhe],Ph={},u0=[];function NV(n,e){var t=u0.length;return n.names?(u0[t]=n,n.names.forEach(function(r){Ph[r.toLowerCase()]=t}),this):(console.log(e),!0)}function LV(n){return n.replace(/[-\(\)\s]+/g," ").trim().replace(/ /g,"_")}function Vhe(n){if(!n)return!1;var e=n.toLowerCase();if(typeof Ph[e]<"u"&&u0[Ph[e]]||(e=LV(e),e in Ph&&u0[Ph[e]]))return u0[Ph[e]]}function Ghe(){jhe.forEach(NV)}const Bhe={start:Ghe,add:NV,get:Vhe};var OV={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563396e-3,b:635625691e-2,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340189e-3,b:6356034446e-3,ellipseName:"Modified Airy"},andrae:{a:637710443e-2,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397155e-3,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483865e-3,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:63782064e-1,b:63565838e-1,ellipseName:"Clarke 1866"},clrk80:{a:6378249145e-3,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk80ign:{a:63782492e-1,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"},clrk58:{a:6378293645208759e-9,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:63757387e-1,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:637813605e-2,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276345e-3,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304063e-3,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301243e-3,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295664e-3,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298556e-3,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:63781575e-1,b:63567722e-1,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:63567733205e-4,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:63558348467e-4,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"},WGS84:{a:6378137,rf:298.257223563,ellipseName:"WGS 84"},sphere:{a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}};const zhe=OV.WGS84;function Uhe(n,e,t,r){var i=n*n,s=e*e,a=(i-s)/i,o=0;r?(n*=1-a*(ahe+a*(ohe+a*lhe)),i=n*n,a=0):o=Math.sqrt(a);var l=(i-s)/s;return{es:a,e:o,ep2:l}}function $he(n,e,t,r,i){if(!n){var s=Vu(OV,r);s||(s=zhe),n=s.a,e=s.b,t=s.rf}return t&&!e&&(e=(1-1/t)*n),(t===0||Math.abs(n-e)<ct)&&(i=!0,e=n),{a:n,b:e,rf:t,sphere:i}}var b_={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},mgi:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Ordnance Survey of Great Britain 1936"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"},EPSG_5451:{towgs84:"6.41,-49.05,-11.28,1.5657,0.5242,6.9718,-5.7649"},IGNF_LURESG:{towgs84:"-192.986,13.673,-39.309,-0.4099,-2.9332,2.6881,0.43"},EPSG_4614:{towgs84:"-119.4248,-303.65872,-11.00061,1.164298,0.174458,1.096259,3.657065"},EPSG_4615:{towgs84:"-494.088,-312.129,279.877,-1.423,-1.013,1.59,-0.748"},ESRI_37241:{towgs84:"-76.822,257.457,-12.817,2.136,-0.033,-2.392,-0.031"},ESRI_37249:{towgs84:"-440.296,58.548,296.265,1.128,10.202,4.559,-0.438"},ESRI_37245:{towgs84:"-511.151,-181.269,139.609,1.05,2.703,1.798,3.071"},EPSG_4178:{towgs84:"24.9,-126.4,-93.2,-0.063,-0.247,-0.041,1.01"},EPSG_4622:{towgs84:"-472.29,-5.63,-304.12,0.4362,-0.8374,0.2563,1.8984"},EPSG_4625:{towgs84:"126.93,547.94,130.41,-2.7867,5.1612,-0.8584,13.8227"},EPSG_5252:{towgs84:"0.023,0.036,-0.068,0.00176,0.00912,-0.01136,0.00439"},EPSG_4314:{towgs84:"597.1,71.4,412.1,0.894,0.068,-1.563,7.58"},EPSG_4282:{towgs84:"-178.3,-316.7,-131.5,5.278,6.077,10.979,19.166"},EPSG_4231:{towgs84:"-83.11,-97.38,-117.22,0.0276,-0.2167,0.2147,0.1218"},EPSG_4274:{towgs84:"-230.994,102.591,25.199,0.633,-0.239,0.9,1.95"},EPSG_4134:{towgs84:"-180.624,-225.516,173.919,-0.81,-1.898,8.336,16.71006"},EPSG_4254:{towgs84:"18.38,192.45,96.82,0.056,-0.142,-0.2,-0.0013"},EPSG_4159:{towgs84:"-194.513,-63.978,-25.759,-3.4027,3.756,-3.352,-0.9175"},EPSG_4687:{towgs84:"0.072,-0.507,-0.245,0.0183,-0.0003,0.007,-0.0093"},EPSG_4227:{towgs84:"-83.58,-397.54,458.78,-17.595,-2.847,4.256,3.225"},EPSG_4746:{towgs84:"599.4,72.4,419.2,-0.062,-0.022,-2.723,6.46"},EPSG_4745:{towgs84:"612.4,77,440.2,-0.054,0.057,-2.797,2.55"},EPSG_6311:{towgs84:"8.846,-4.394,-1.122,-0.00237,-0.146528,0.130428,0.783926"},EPSG_4289:{towgs84:"565.7381,50.4018,465.2904,-1.91514,1.60363,-9.09546,4.07244"},EPSG_4230:{towgs84:"-68.863,-134.888,-111.49,-0.53,-0.14,0.57,-3.4"},EPSG_4154:{towgs84:"-123.02,-158.95,-168.47"},EPSG_4156:{towgs84:"570.8,85.7,462.8,4.998,1.587,5.261,3.56"},EPSG_4299:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4179:{towgs84:"33.4,-146.6,-76.3,-0.359,-0.053,0.844,-0.84"},EPSG_4313:{towgs84:"-106.8686,52.2978,-103.7239,0.3366,-0.457,1.8422,-1.2747"},EPSG_4194:{towgs84:"163.511,127.533,-159.789"},EPSG_4195:{towgs84:"105,326,-102.5"},EPSG_4196:{towgs84:"-45,417,-3.5"},EPSG_4611:{towgs84:"-162.619,-276.959,-161.764,0.067753,-2.243649,-1.158827,-1.094246"},EPSG_4633:{towgs84:"137.092,131.66,91.475,-1.9436,-11.5993,-4.3321,-7.4824"},EPSG_4641:{towgs84:"-408.809,366.856,-412.987,1.8842,-0.5308,2.1655,-121.0993"},EPSG_4643:{towgs84:"-480.26,-438.32,-643.429,16.3119,20.1721,-4.0349,-111.7002"},EPSG_4300:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4188:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4660:{towgs84:"982.6087,552.753,-540.873,32.39344,-153.25684,-96.2266,16.805"},EPSG_4662:{towgs84:"97.295,-263.247,310.882,-1.5999,0.8386,3.1409,13.3259"},EPSG_3906:{towgs84:"577.88891,165.22205,391.18289,4.9145,-0.94729,-13.05098,7.78664"},EPSG_4307:{towgs84:"-209.3622,-87.8162,404.6198,0.0046,3.4784,0.5805,-1.4547"},EPSG_6892:{towgs84:"-76.269,-16.683,68.562,-6.275,10.536,-4.286,-13.686"},EPSG_4690:{towgs84:"221.597,152.441,176.523,2.403,1.3893,0.884,11.4648"},EPSG_4691:{towgs84:"218.769,150.75,176.75,3.5231,2.0037,1.288,10.9817"},EPSG_4629:{towgs84:"72.51,345.411,79.241,-1.5862,-0.8826,-0.5495,1.3653"},EPSG_4630:{towgs84:"165.804,216.213,180.26,-0.6251,-0.4515,-0.0721,7.4111"},EPSG_4692:{towgs84:"217.109,86.452,23.711,0.0183,-0.0003,0.007,-0.0093"},EPSG_9333:{towgs84:"0,0,0,-8.393,0.749,-10.276,0"},EPSG_9059:{towgs84:"0,0,0"},EPSG_4312:{towgs84:"601.705,84.263,485.227,4.7354,1.3145,5.393,-2.3887"},EPSG_4123:{towgs84:"-96.062,-82.428,-121.753,4.801,0.345,-1.376,1.496"},EPSG_4309:{towgs84:"-124.45,183.74,44.64,-0.4384,0.5446,-0.9706,-2.1365"},ESRI_104106:{towgs84:"-283.088,-70.693,117.445,-1.157,0.059,-0.652,-4.058"},EPSG_4281:{towgs84:"-219.247,-73.802,269.529"},EPSG_4322:{towgs84:"0,0,4.5"},EPSG_4324:{towgs84:"0,0,1.9"},EPSG_4284:{towgs84:"43.822,-108.842,-119.585,1.455,-0.761,0.737,0.549"},EPSG_4277:{towgs84:"446.448,-125.157,542.06,0.15,0.247,0.842,-20.489"},EPSG_4207:{towgs84:"-282.1,-72.2,120,-1.529,0.145,-0.89,-4.46"},EPSG_4688:{towgs84:"347.175,1077.618,2623.677,33.9058,-70.6776,9.4013,186.0647"},EPSG_4689:{towgs84:"410.793,54.542,80.501,-2.5596,-2.3517,-0.6594,17.3218"},EPSG_4720:{towgs84:"0,0,4.5"},EPSG_4273:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},EPSG_4240:{towgs84:"204.64,834.74,293.8"},EPSG_4817:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},ESRI_104131:{towgs84:"426.62,142.62,460.09,4.98,4.49,-12.42,-17.1"},EPSG_4265:{towgs84:"-104.1,-49.1,-9.9,0.971,-2.917,0.714,-11.68"},EPSG_4263:{towgs84:"-111.92,-87.85,114.5,1.875,0.202,0.219,0.032"},EPSG_4298:{towgs84:"-689.5937,623.84046,-65.93566,-0.02331,1.17094,-0.80054,5.88536"},EPSG_4270:{towgs84:"-253.4392,-148.452,386.5267,0.15605,0.43,-0.1013,-0.0424"},EPSG_4229:{towgs84:"-121.8,98.1,-10.7"},EPSG_4220:{towgs84:"-55.5,-348,-229.2"},EPSG_4214:{towgs84:"12.646,-155.176,-80.863"},EPSG_4232:{towgs84:"-345,3,223"},EPSG_4238:{towgs84:"-1.977,-13.06,-9.993,0.364,0.254,0.689,-1.037"},EPSG_4168:{towgs84:"-170,33,326"},EPSG_4131:{towgs84:"199,931,318.9"},EPSG_4152:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_5228:{towgs84:"572.213,85.334,461.94,4.9732,1.529,5.2484,3.5378"},EPSG_8351:{towgs84:"485.021,169.465,483.839,7.786342,4.397554,4.102655,0"},EPSG_4683:{towgs84:"-127.62,-67.24,-47.04,-3.068,4.903,1.578,-1.06"},EPSG_4133:{towgs84:"0,0,0"},EPSG_7373:{towgs84:"0.819,-0.5762,-1.6446,-0.00378,-0.03317,0.00318,0.0693"},EPSG_9075:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9072:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9294:{towgs84:"1.16835,-1.42001,-2.24431,-0.00822,-0.05508,0.01818,0.23388"},EPSG_4212:{towgs84:"-267.434,173.496,181.814,-13.4704,8.7154,7.3926,14.7492"},EPSG_4191:{towgs84:"-44.183,-0.58,-38.489,2.3867,2.7072,-3.5196,-8.2703"},EPSG_4237:{towgs84:"52.684,-71.194,-13.975,-0.312,-0.1063,-0.3729,1.0191"},EPSG_4740:{towgs84:"-1.08,-0.27,-0.9"},EPSG_4124:{towgs84:"419.3836,99.3335,591.3451,0.850389,1.817277,-7.862238,-0.99496"},EPSG_5681:{towgs84:"584.9636,107.7175,413.8067,1.1155,0.2824,-3.1384,7.9922"},EPSG_4141:{towgs84:"23.772,17.49,17.859,-0.3132,-1.85274,1.67299,-5.4262"},EPSG_4204:{towgs84:"-85.645,-273.077,-79.708,2.289,-1.421,2.532,3.194"},EPSG_4319:{towgs84:"226.702,-193.337,-35.371,-2.229,-4.391,9.238,0.9798"},EPSG_4200:{towgs84:"24.82,-131.21,-82.66"},EPSG_4130:{towgs84:"0,0,0"},EPSG_4127:{towgs84:"-82.875,-57.097,-156.768,-2.158,1.524,-0.982,-0.359"},EPSG_4149:{towgs84:"674.374,15.056,405.346"},EPSG_4617:{towgs84:"-0.991,1.9072,0.5129,1.25033e-7,4.6785e-8,5.6529e-8,0"},EPSG_4663:{towgs84:"-210.502,-66.902,-48.476,2.094,-15.067,-5.817,0.485"},EPSG_4664:{towgs84:"-211.939,137.626,58.3,-0.089,0.251,0.079,0.384"},EPSG_4665:{towgs84:"-105.854,165.589,-38.312,-0.003,-0.026,0.024,-0.048"},EPSG_4666:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},EPSG_4756:{towgs84:"-192.873,-39.382,-111.202,-0.00205,-0.0005,0.00335,0.0188"},EPSG_4723:{towgs84:"-179.483,-69.379,-27.584,-7.862,8.163,6.042,-13.925"},EPSG_4726:{towgs84:"8.853,-52.644,180.304,-0.393,-2.323,2.96,-24.081"},EPSG_4267:{towgs84:"-8.0,160.0,176.0"},EPSG_5365:{towgs84:"-0.16959,0.35312,0.51846,0.03385,-0.16325,0.03446,0.03693"},EPSG_4218:{towgs84:"304.5,306.5,-318.1"},EPSG_4242:{towgs84:"-33.722,153.789,94.959,-8.581,-4.478,4.54,8.95"},EPSG_4216:{towgs84:"-292.295,248.758,429.447,4.9971,2.99,6.6906,1.0289"},ESRI_104105:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},ESRI_104129:{towgs84:"0,0,0"},EPSG_4673:{towgs84:"174.05,-25.49,112.57"},EPSG_4202:{towgs84:"-124,-60,154"},EPSG_4203:{towgs84:"-117.763,-51.51,139.061,0.292,0.443,0.277,-0.191"},EPSG_3819:{towgs84:"595.48,121.69,515.35,4.115,-2.9383,0.853,-3.408"},EPSG_8694:{towgs84:"-93.799,-132.737,-219.073,-1.844,0.648,-6.37,-0.169"},EPSG_4145:{towgs84:"275.57,676.78,229.6"},EPSG_4283:{towgs84:"61.55,-10.87,-40.19,39.4924,32.7221,32.8979,-9.994"},EPSG_4317:{towgs84:"2.3287,-147.0425,-92.0802,-0.3092483,0.32482185,0.49729934,5.68906266"},EPSG_4272:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993"},EPSG_4248:{towgs84:"-307.7,265.3,-363.5"},EPSG_5561:{towgs84:"24,-121,-76"},EPSG_5233:{towgs84:"-0.293,766.95,87.713,0.195704,1.695068,3.473016,-0.039338"},ESRI_104130:{towgs84:"-86,-98,-119"},ESRI_104102:{towgs84:"682,-203,480"},ESRI_37207:{towgs84:"7,-10,-26"},EPSG_4675:{towgs84:"59.935,118.4,-10.871"},ESRI_104109:{towgs84:"-89.121,-348.182,260.871"},ESRI_104112:{towgs84:"-185.583,-230.096,281.361"},ESRI_104113:{towgs84:"25.1,-275.6,222.6"},IGNF_WGS72G:{towgs84:"0,12,6"},IGNF_NTFG:{towgs84:"-168,-60,320"},IGNF_EFATE57G:{towgs84:"-127,-769,472"},IGNF_PGP50G:{towgs84:"324.8,153.6,172.1"},IGNF_REUN47G:{towgs84:"94,-948,-1262"},IGNF_CSG67G:{towgs84:"-186,230,110"},IGNF_GUAD48G:{towgs84:"-467,-16,-300"},IGNF_TAHI51G:{towgs84:"162,117,154"},IGNF_TAHAAG:{towgs84:"65,342,77"},IGNF_NUKU72G:{towgs84:"84,274,65"},IGNF_PETRELS72G:{towgs84:"365,194,166"},IGNF_WALL78G:{towgs84:"253,-133,-127"},IGNF_MAYO50G:{towgs84:"-382,-59,-262"},IGNF_TANNAG:{towgs84:"-139,-967,436"},IGNF_IGN72G:{towgs84:"-13,-348,292"},IGNF_ATIGG:{towgs84:"1118,23,66"},IGNF_FANGA84G:{towgs84:"150.57,158.33,118.32"},IGNF_RUSAT84G:{towgs84:"202.13,174.6,-15.74"},IGNF_KAUE70G:{towgs84:"126.74,300.1,-75.49"},IGNF_MOP90G:{towgs84:"-10.8,-1.8,12.77"},IGNF_MHPF67G:{towgs84:"338.08,212.58,-296.17"},IGNF_TAHI79G:{towgs84:"160.61,116.05,153.69"},IGNF_ANAA92G:{towgs84:"1.5,3.84,4.81"},IGNF_MARQUI72G:{towgs84:"330.91,-13.92,58.56"},IGNF_APAT86G:{towgs84:"143.6,197.82,74.05"},IGNF_TUBU69G:{towgs84:"237.17,171.61,-77.84"},IGNF_STPM50G:{towgs84:"11.363,424.148,373.13"},EPSG_4150:{towgs84:"674.374,15.056,405.346"},EPSG_4754:{towgs84:"-208.4058,-109.8777,-2.5764"},ESRI_104101:{towgs84:"374,150,588"},EPSG_4693:{towgs84:"0,-0.15,0.68"},EPSG_6207:{towgs84:"293.17,726.18,245.36"},EPSG_4153:{towgs84:"-133.63,-157.5,-158.62"},EPSG_4132:{towgs84:"-241.54,-163.64,396.06"},EPSG_4221:{towgs84:"-154.5,150.7,100.4"},EPSG_4266:{towgs84:"-80.7,-132.5,41.1"},EPSG_4193:{towgs84:"-70.9,-151.8,-41.4"},EPSG_5340:{towgs84:"-0.41,0.46,-0.35"},EPSG_4246:{towgs84:"-294.7,-200.1,525.5"},EPSG_4318:{towgs84:"-3.2,-5.7,2.8"},EPSG_4121:{towgs84:"-199.87,74.79,246.62"},EPSG_4223:{towgs84:"-260.1,5.5,432.2"},EPSG_4158:{towgs84:"-0.465,372.095,171.736"},EPSG_4285:{towgs84:"-128.16,-282.42,21.93"},EPSG_4613:{towgs84:"-404.78,685.68,45.47"},EPSG_4607:{towgs84:"195.671,332.517,274.607"},EPSG_4475:{towgs84:"-381.788,-57.501,-256.673"},EPSG_4208:{towgs84:"-157.84,308.54,-146.6"},EPSG_4743:{towgs84:"70.995,-335.916,262.898"},EPSG_4710:{towgs84:"-323.65,551.39,-491.22"},EPSG_7881:{towgs84:"-0.077,0.079,0.086"},EPSG_4682:{towgs84:"283.729,735.942,261.143"},EPSG_4739:{towgs84:"-156,-271,-189"},EPSG_4679:{towgs84:"-80.01,253.26,291.19"},EPSG_4750:{towgs84:"-56.263,16.136,-22.856"},EPSG_4644:{towgs84:"-10.18,-350.43,291.37"},EPSG_4695:{towgs84:"-103.746,-9.614,-255.95"},EPSG_4292:{towgs84:"-355,21,72"},EPSG_4302:{towgs84:"-61.702,284.488,472.052"},EPSG_4143:{towgs84:"-124.76,53,466.79"},EPSG_4606:{towgs84:"-153,153,307"},EPSG_4699:{towgs84:"-770.1,158.4,-498.2"},EPSG_4247:{towgs84:"-273.5,110.6,-357.9"},EPSG_4160:{towgs84:"8.88,184.86,106.69"},EPSG_4161:{towgs84:"-233.43,6.65,173.64"},EPSG_9251:{towgs84:"-9.5,122.9,138.2"},EPSG_9253:{towgs84:"-78.1,101.6,133.3"},EPSG_4297:{towgs84:"-198.383,-240.517,-107.909"},EPSG_4269:{towgs84:"0,0,0"},EPSG_4301:{towgs84:"-147,506,687"},EPSG_4618:{towgs84:"-59,-11,-52"},EPSG_4612:{towgs84:"0,0,0"},EPSG_4678:{towgs84:"44.585,-131.212,-39.544"},EPSG_4250:{towgs84:"-130,29,364"},EPSG_4144:{towgs84:"214,804,268"},EPSG_4147:{towgs84:"-17.51,-108.32,-62.39"},EPSG_4259:{towgs84:"-254.1,-5.36,-100.29"},EPSG_4164:{towgs84:"-76,-138,67"},EPSG_4211:{towgs84:"-378.873,676.002,-46.255"},EPSG_4182:{towgs84:"-422.651,-172.995,84.02"},EPSG_4224:{towgs84:"-143.87,243.37,-33.52"},EPSG_4225:{towgs84:"-205.57,168.77,-4.12"},EPSG_5527:{towgs84:"-67.35,3.88,-38.22"},EPSG_4752:{towgs84:"98,390,-22"},EPSG_4310:{towgs84:"-30,190,89"},EPSG_9248:{towgs84:"-192.26,65.72,132.08"},EPSG_4680:{towgs84:"124.5,-63.5,-281"},EPSG_4701:{towgs84:"-79.9,-158,-168.9"},EPSG_4706:{towgs84:"-146.21,112.63,4.05"},EPSG_4805:{towgs84:"682,-203,480"},EPSG_4201:{towgs84:"-165,-11,206"},EPSG_4210:{towgs84:"-157,-2,-299"},EPSG_4183:{towgs84:"-104,167,-38"},EPSG_4139:{towgs84:"11,72,-101"},EPSG_4668:{towgs84:"-86,-98,-119"},EPSG_4717:{towgs84:"-2,151,181"},EPSG_4732:{towgs84:"102,52,-38"},EPSG_4280:{towgs84:"-377,681,-50"},EPSG_4209:{towgs84:"-138,-105,-289"},EPSG_4261:{towgs84:"31,146,47"},EPSG_4658:{towgs84:"-73,46,-86"},EPSG_4721:{towgs84:"265.025,384.929,-194.046"},EPSG_4222:{towgs84:"-136,-108,-292"},EPSG_4601:{towgs84:"-255,-15,71"},EPSG_4602:{towgs84:"725,685,536"},EPSG_4603:{towgs84:"72,213.7,93"},EPSG_4605:{towgs84:"9,183,236"},EPSG_4621:{towgs84:"137,248,-430"},EPSG_4657:{towgs84:"-28,199,5"},EPSG_4316:{towgs84:"103.25,-100.4,-307.19"},EPSG_4642:{towgs84:"-13,-348,292"},EPSG_4698:{towgs84:"145,-187,103"},EPSG_4192:{towgs84:"-206.1,-174.7,-87.7"},EPSG_4311:{towgs84:"-265,120,-358"},EPSG_4135:{towgs84:"58,-283,-182"},ESRI_104138:{towgs84:"198,-226,-347"},EPSG_4245:{towgs84:"-11,851,5"},EPSG_4142:{towgs84:"-125,53,467"},EPSG_4213:{towgs84:"-106,-87,188"},EPSG_4253:{towgs84:"-133,-77,-51"},EPSG_4129:{towgs84:"-132,-110,-335"},EPSG_4713:{towgs84:"-77,-128,142"},EPSG_4239:{towgs84:"217,823,299"},EPSG_4146:{towgs84:"295,736,257"},EPSG_4155:{towgs84:"-83,37,124"},EPSG_4165:{towgs84:"-173,253,27"},EPSG_4672:{towgs84:"175,-38,113"},EPSG_4236:{towgs84:"-637,-549,-203"},EPSG_4251:{towgs84:"-90,40,88"},EPSG_4271:{towgs84:"-2,374,172"},EPSG_4175:{towgs84:"-88,4,101"},EPSG_4716:{towgs84:"298,-304,-375"},EPSG_4315:{towgs84:"-23,259,-9"},EPSG_4744:{towgs84:"-242.2,-144.9,370.3"},EPSG_4244:{towgs84:"-97,787,86"},EPSG_4293:{towgs84:"616,97,-251"},EPSG_4714:{towgs84:"-127,-769,472"},EPSG_4736:{towgs84:"260,12,-147"},EPSG_6883:{towgs84:"-235,-110,393"},EPSG_6894:{towgs84:"-63,176,185"},EPSG_4205:{towgs84:"-43,-163,45"},EPSG_4256:{towgs84:"41,-220,-134"},EPSG_4262:{towgs84:"639,405,60"},EPSG_4604:{towgs84:"174,359,365"},EPSG_4169:{towgs84:"-115,118,426"},EPSG_4620:{towgs84:"-106,-129,165"},EPSG_4184:{towgs84:"-203,141,53"},EPSG_4616:{towgs84:"-289,-124,60"},EPSG_9403:{towgs84:"-307,-92,127"},EPSG_4684:{towgs84:"-133,-321,50"},EPSG_4708:{towgs84:"-491,-22,435"},EPSG_4707:{towgs84:"114,-116,-333"},EPSG_4709:{towgs84:"145,75,-272"},EPSG_4712:{towgs84:"-205,107,53"},EPSG_4711:{towgs84:"124,-234,-25"},EPSG_4718:{towgs84:"230,-199,-752"},EPSG_4719:{towgs84:"211,147,111"},EPSG_4724:{towgs84:"208,-435,-229"},EPSG_4725:{towgs84:"189,-79,-202"},EPSG_4735:{towgs84:"647,1777,-1124"},EPSG_4722:{towgs84:"-794,119,-298"},EPSG_4728:{towgs84:"-307,-92,127"},EPSG_4734:{towgs84:"-632,438,-609"},EPSG_4727:{towgs84:"912,-58,1227"},EPSG_4729:{towgs84:"185,165,42"},EPSG_4730:{towgs84:"170,42,84"},EPSG_4733:{towgs84:"276,-57,149"},ESRI_37218:{towgs84:"230,-199,-752"},ESRI_37240:{towgs84:"-7,215,225"},ESRI_37221:{towgs84:"252,-209,-751"},ESRI_4305:{towgs84:"-123,-206,219"},ESRI_104139:{towgs84:"-73,-247,227"},EPSG_4748:{towgs84:"51,391,-36"},EPSG_4219:{towgs84:"-384,664,-48"},EPSG_4255:{towgs84:"-333,-222,114"},EPSG_4257:{towgs84:"-587.8,519.75,145.76"},EPSG_4646:{towgs84:"-963,510,-359"},EPSG_6881:{towgs84:"-24,-203,268"},EPSG_6882:{towgs84:"-183,-15,273"},EPSG_4715:{towgs84:"-104,-129,239"},IGNF_RGF93GDD:{towgs84:"0,0,0"},IGNF_RGM04GDD:{towgs84:"0,0,0"},IGNF_RGSPM06GDD:{towgs84:"0,0,0"},IGNF_RGTAAF07GDD:{towgs84:"0,0,0"},IGNF_RGFG95GDD:{towgs84:"0,0,0"},IGNF_RGNCG:{towgs84:"0,0,0"},IGNF_RGPFGDD:{towgs84:"0,0,0"},IGNF_ETRS89G:{towgs84:"0,0,0"},IGNF_RGR92GDD:{towgs84:"0,0,0"},EPSG_4173:{towgs84:"0,0,0"},EPSG_4180:{towgs84:"0,0,0"},EPSG_4619:{towgs84:"0,0,0"},EPSG_4667:{towgs84:"0,0,0"},EPSG_4075:{towgs84:"0,0,0"},EPSG_6706:{towgs84:"0,0,0"},EPSG_7798:{towgs84:"0,0,0"},EPSG_4661:{towgs84:"0,0,0"},EPSG_4669:{towgs84:"0,0,0"},EPSG_8685:{towgs84:"0,0,0"},EPSG_4151:{towgs84:"0,0,0"},EPSG_9702:{towgs84:"0,0,0"},EPSG_4758:{towgs84:"0,0,0"},EPSG_4761:{towgs84:"0,0,0"},EPSG_4765:{towgs84:"0,0,0"},EPSG_8997:{towgs84:"0,0,0"},EPSG_4023:{towgs84:"0,0,0"},EPSG_4670:{towgs84:"0,0,0"},EPSG_4694:{towgs84:"0,0,0"},EPSG_4148:{towgs84:"0,0,0"},EPSG_4163:{towgs84:"0,0,0"},EPSG_4167:{towgs84:"0,0,0"},EPSG_4189:{towgs84:"0,0,0"},EPSG_4190:{towgs84:"0,0,0"},EPSG_4176:{towgs84:"0,0,0"},EPSG_4659:{towgs84:"0,0,0"},EPSG_3824:{towgs84:"0,0,0"},EPSG_3889:{towgs84:"0,0,0"},EPSG_4046:{towgs84:"0,0,0"},EPSG_4081:{towgs84:"0,0,0"},EPSG_4558:{towgs84:"0,0,0"},EPSG_4483:{towgs84:"0,0,0"},EPSG_5013:{towgs84:"0,0,0"},EPSG_5264:{towgs84:"0,0,0"},EPSG_5324:{towgs84:"0,0,0"},EPSG_5354:{towgs84:"0,0,0"},EPSG_5371:{towgs84:"0,0,0"},EPSG_5373:{towgs84:"0,0,0"},EPSG_5381:{towgs84:"0,0,0"},EPSG_5393:{towgs84:"0,0,0"},EPSG_5489:{towgs84:"0,0,0"},EPSG_5593:{towgs84:"0,0,0"},EPSG_6135:{towgs84:"0,0,0"},EPSG_6365:{towgs84:"0,0,0"},EPSG_5246:{towgs84:"0,0,0"},EPSG_7886:{towgs84:"0,0,0"},EPSG_8431:{towgs84:"0,0,0"},EPSG_8427:{towgs84:"0,0,0"},EPSG_8699:{towgs84:"0,0,0"},EPSG_8818:{towgs84:"0,0,0"},EPSG_4757:{towgs84:"0,0,0"},EPSG_9140:{towgs84:"0,0,0"},EPSG_8086:{towgs84:"0,0,0"},EPSG_4686:{towgs84:"0,0,0"},EPSG_4737:{towgs84:"0,0,0"},EPSG_4702:{towgs84:"0,0,0"},EPSG_4747:{towgs84:"0,0,0"},EPSG_4749:{towgs84:"0,0,0"},EPSG_4674:{towgs84:"0,0,0"},EPSG_4755:{towgs84:"0,0,0"},EPSG_4759:{towgs84:"0,0,0"},EPSG_4762:{towgs84:"0,0,0"},EPSG_4763:{towgs84:"0,0,0"},EPSG_4764:{towgs84:"0,0,0"},EPSG_4166:{towgs84:"0,0,0"},EPSG_4170:{towgs84:"0,0,0"},EPSG_5546:{towgs84:"0,0,0"},EPSG_7844:{towgs84:"0,0,0"},EPSG_4818:{towgs84:"589,76,480"}};for(var Whe in b_){var NS=b_[Whe];NS.datumName&&(b_[NS.datumName]=NS)}function Hhe(n,e,t,r,i,s,a){var o={};return n===void 0||n==="none"?o.datum_type=LR:o.datum_type=ihe,e&&(o.datum_params=e.map(parseFloat),(o.datum_params[0]!==0||o.datum_params[1]!==0||o.datum_params[2]!==0)&&(o.datum_type=vd),o.datum_params.length>3&&(o.datum_params[3]!==0||o.datum_params[4]!==0||o.datum_params[5]!==0||o.datum_params[6]!==0)&&(o.datum_type=wd,o.datum_params[3]*=np,o.datum_params[4]*=np,o.datum_params[5]*=np,o.datum_params[6]=o.datum_params[6]/1e6+1)),a&&(o.datum_type=T0,o.grids=a),o.a=t,o.b=r,o.es=i,o.ep2=s,o}var XC={};function Khe(n,e,t){return e instanceof ArrayBuffer?Xhe(n,e,t):{ready:qhe(n,e)}}function Xhe(n,e,t){var r=!0;t!==void 0&&t.includeErrorFields===!1&&(r=!1);var i=new DataView(e),s=Jhe(i),a=Qhe(i,s),o=ede(i,a,s,r),l={header:a,subgrids:o};return XC[n]=l,l}async function qhe(n,e){for(var t=[],r=await e.getImageCount(),i=r-1;i>=0;i--){var s=await e.getImage(i),a=await s.readRasters(),o=a,l=[s.getWidth(),s.getHeight()],c=s.getBoundingBox().map(s5),h=[s.fileDirectory.ModelPixelScale[0],s.fileDirectory.ModelPixelScale[1]].map(s5),f=c[0]+(l[0]-1)*h[0],m=c[3]-(l[1]-1)*h[1],y=o[0],x=o[1],_=[];for(let b=l[1]-1;b>=0;b--)for(let R=l[0]-1;R>=0;R--){var w=b*l[0]+R;_.push([-pu(x[w]),pu(y[w])])}t.push({del:h,lim:l,ll:[-f,m],cvs:_})}var S={header:{nSubgrids:r},subgrids:t};return XC[n]=S,S}function Yhe(n){if(n===void 0)return null;var e=n.split(",");return e.map(Zhe)}function Zhe(n){if(n.length===0)return null;var e=n[0]==="@";return e&&(n=n.slice(1)),n==="null"?{name:"null",mandatory:!e,grid:null,isNull:!0}:{name:n,mandatory:!e,grid:XC[n]||null,isNull:!1}}function s5(n){return n*Math.PI/180}function pu(n){return n/3600*Math.PI/180}function Jhe(n){var e=n.getInt32(8,!1);return e===11?!1:(e=n.getInt32(8,!0),e!==11&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}function Qhe(n,e){return{nFields:n.getInt32(8,e),nSubgridFields:n.getInt32(24,e),nSubgrids:n.getInt32(40,e),shiftType:DR(n,56,64).trim(),fromSemiMajorAxis:n.getFloat64(120,e),fromSemiMinorAxis:n.getFloat64(136,e),toSemiMajorAxis:n.getFloat64(152,e),toSemiMinorAxis:n.getFloat64(168,e)}}function DR(n,e,t){return String.fromCharCode.apply(null,new Uint8Array(n.buffer.slice(e,t)))}function ede(n,e,t,r){for(var i=176,s=[],a=0;a<e.nSubgrids;a++){var o=nde(n,i,t),l=rde(n,i,o,t,r),c=Math.round(1+(o.upperLongitude-o.lowerLongitude)/o.longitudeInterval),h=Math.round(1+(o.upperLatitude-o.lowerLatitude)/o.latitudeInterval);s.push({ll:[pu(o.lowerLongitude),pu(o.lowerLatitude)],del:[pu(o.longitudeInterval),pu(o.latitudeInterval)],lim:[c,h],count:o.gridNodeCount,cvs:tde(l)});var f=16;r===!1&&(f=8),i+=176+o.gridNodeCount*f}return s}function tde(n){return n.map(function(e){return[pu(e.longitudeShift),pu(e.latitudeShift)]})}function nde(n,e,t){return{name:DR(n,e+8,e+16).trim(),parent:DR(n,e+24,e+24+8).trim(),lowerLatitude:n.getFloat64(e+72,t),upperLatitude:n.getFloat64(e+88,t),lowerLongitude:n.getFloat64(e+104,t),upperLongitude:n.getFloat64(e+120,t),latitudeInterval:n.getFloat64(e+136,t),longitudeInterval:n.getFloat64(e+152,t),gridNodeCount:n.getInt32(e+168,t)}}function rde(n,e,t,r,i){var s=e+176,a=16;i===!1&&(a=8);for(var o=[],l=0;l<t.gridNodeCount;l++){var c={latitudeShift:n.getFloat32(s+l*a,r),longitudeShift:n.getFloat32(s+l*a+4,r)};i!==!1&&(c.latitudeAccuracy=n.getFloat32(s+l*a+8,r),c.longitudeAccuracy=n.getFloat32(s+l*a+12,r)),o.push(c)}return o}function Ua(n,e){if(!(this instanceof Ua))return new Ua(n);this.forward=null,this.inverse=null,this.init=null,this.name,this.names=null,this.title,e=e||function(c){if(c)throw c};var t=khe(n);if(typeof t!="object"){e("Could not parse to valid json: "+n);return}var r=Ua.projections.get(t.projName);if(!r){e("Could not get projection name from: "+n);return}if(t.datumCode&&t.datumCode!=="none"){var i=Vu(b_,t.datumCode);i&&(t.datum_params=t.datum_params||(i.towgs84?i.towgs84.split(","):null),t.ellps=i.ellipse,t.datumName=i.datumName?i.datumName:t.datumCode)}t.k0=t.k0||1,t.axis=t.axis||"enu",t.ellps=t.ellps||"wgs84",t.lat1=t.lat1||t.lat0;var s=$he(t.a,t.b,t.rf,t.ellps,t.sphere),a=Uhe(s.a,s.b,s.rf,t.R_A),o=Yhe(t.nadgrids),l=t.datum||Hhe(t.datumCode,t.datum_params,s.a,s.b,a.es,a.ep2,o);r5(this,t),r5(this,r),this.a=s.a,this.b=s.b,this.rf=s.rf,this.sphere=s.sphere,this.es=a.es,this.e=a.e,this.ep2=a.ep2,this.datum=l,"init"in this&&typeof this.init=="function"&&this.init(),e(null,this)}Ua.projections=Bhe;Ua.projections.start();function ide(n,e){return n.datum_type!==e.datum_type||n.a!==e.a||Math.abs(n.es-e.es)>5e-11?!1:n.datum_type===vd?n.datum_params[0]===e.datum_params[0]&&n.datum_params[1]===e.datum_params[1]&&n.datum_params[2]===e.datum_params[2]:n.datum_type===wd?n.datum_params[0]===e.datum_params[0]&&n.datum_params[1]===e.datum_params[1]&&n.datum_params[2]===e.datum_params[2]&&n.datum_params[3]===e.datum_params[3]&&n.datum_params[4]===e.datum_params[4]&&n.datum_params[5]===e.datum_params[5]&&n.datum_params[6]===e.datum_params[6]:!0}function DV(n,e,t){var r=n.x,i=n.y,s=n.z?n.z:0,a,o,l,c;if(i<-We&&i>-1.001*We)i=-We;else if(i>We&&i<1.001*We)i=We;else{if(i<-We)return{x:-1/0,y:-1/0,z:n.z};if(i>We)return{x:1/0,y:1/0,z:n.z}}return r>Math.PI&&(r-=2*Math.PI),o=Math.sin(i),c=Math.cos(i),l=o*o,a=t/Math.sqrt(1-e*l),{x:(a+s)*c*Math.cos(r),y:(a+s)*c*Math.sin(r),z:(a*(1-e)+s)*o}}function FV(n,e,t,r){var i=1e-12,s=i*i,a=30,o,l,c,h,f,m,y,x,_,w,S,b,R,M=n.x,O=n.y,G=n.z?n.z:0,A,I,P;if(o=Math.sqrt(M*M+O*O),l=Math.sqrt(M*M+O*O+G*G),o/t<i){if(A=0,l/t<i)return I=We,P=-r,{x:n.x,y:n.y,z:n.z}}else A=Math.atan2(O,M);c=G/l,h=o/l,f=1/Math.sqrt(1-e*(2-e)*h*h),x=h*(1-e)*f,_=c*f,R=0;do R++,y=t/Math.sqrt(1-e*_*_),P=o*x+G*_-y*(1-e*_*_),m=e*y/(y+P),f=1/Math.sqrt(1-m*(2-m)*h*h),w=h*(1-m)*f,S=c*f,b=S*x-w*_,x=w,_=S;while(b*b>s&&R<a);return I=Math.atan(S/Math.abs(w)),{x:A,y:I,z:P}}function sde(n,e,t){if(e===vd)return{x:n.x+t[0],y:n.y+t[1],z:n.z+t[2]};if(e===wd){var r=t[0],i=t[1],s=t[2],a=t[3],o=t[4],l=t[5],c=t[6];return{x:c*(n.x-l*n.y+o*n.z)+r,y:c*(l*n.x+n.y-a*n.z)+i,z:c*(-o*n.x+a*n.y+n.z)+s}}}function ade(n,e,t){if(e===vd)return{x:n.x-t[0],y:n.y-t[1],z:n.z-t[2]};if(e===wd){var r=t[0],i=t[1],s=t[2],a=t[3],o=t[4],l=t[5],c=t[6],h=(n.x-r)/c,f=(n.y-i)/c,m=(n.z-s)/c;return{x:h+l*f-o*m,y:-l*h+f+a*m,z:o*h-a*f+m}}}function zx(n){return n===vd||n===wd}function ode(n,e,t){if(ide(n,e)||n.datum_type===LR||e.datum_type===LR)return t;var r=n.a,i=n.es;if(n.datum_type===T0){var s=a5(n,!1,t);if(s!==0)return;r=ZO,i=JO}var a=e.a,o=e.b,l=e.es;if(e.datum_type===T0&&(a=ZO,o=she,l=JO),i===l&&r===a&&!zx(n.datum_type)&&!zx(e.datum_type))return t;if(t=DV(t,i,r),zx(n.datum_type)&&(t=sde(t,n.datum_type,n.datum_params)),zx(e.datum_type)&&(t=ade(t,e.datum_type,e.datum_params)),t=FV(t,l,a,o),e.datum_type===T0){var c=a5(e,!0,t);if(c!==0)return}return t}function a5(n,e,t){if(n.grids===null||n.grids.length===0)return console.log("Grid shift grids not found"),-1;var r={x:-t.x,y:t.y},i={x:Number.NaN,y:Number.NaN},s=[];e:for(var a=0;a<n.grids.length;a++){var o=n.grids[a];if(s.push(o.name),o.isNull){i=r;break}if(o.grid===null){if(o.mandatory)return console.log("Unable to find mandatory grid '"+o.name+"'"),-1;continue}for(var l=o.grid.subgrids,c=0,h=l.length;c<h;c++){var f=l[c],m=(Math.abs(f.del[1])+Math.abs(f.del[0]))/1e4,y=f.ll[0]-m,x=f.ll[1]-m,_=f.ll[0]+(f.lim[0]-1)*f.del[0]+m,w=f.ll[1]+(f.lim[1]-1)*f.del[1]+m;if(!(x>r.y||y>r.x||w<r.y||_<r.x)&&(i=lde(r,e,f),!isNaN(i.x)))break e}}return isNaN(i.x)?(console.log("Failed to find a grid shift table for location '"+-r.x*Bs+" "+r.y*Bs+" tried: '"+s+"'"),-1):(t.x=-i.x,t.y=i.y,0)}function lde(n,e,t){var r={x:Number.NaN,y:Number.NaN};if(isNaN(n.x))return r;var i={x:n.x,y:n.y};i.x-=t.ll[0],i.y-=t.ll[1],i.x=mt(i.x-Math.PI)+Math.PI;var s=o5(i,t);if(e){if(isNaN(s.x))return r;s.x=i.x-s.x,s.y=i.y-s.y;var a=9,o=1e-12,l,c;do{if(c=o5(s,t),isNaN(c.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}l={x:i.x-(c.x+s.x),y:i.y-(c.y+s.y)},s.x+=l.x,s.y+=l.y}while(a--&&Math.abs(l.x)>o&&Math.abs(l.y)>o);if(a<0)return console.log("Inverse grid shift iterator failed to converge."),r;r.x=mt(s.x+t.ll[0]),r.y=s.y+t.ll[1]}else isNaN(s.x)||(r.x=n.x+s.x,r.y=n.y+s.y);return r}function o5(n,e){var t={x:n.x/e.del[0],y:n.y/e.del[1]},r={x:Math.floor(t.x),y:Math.floor(t.y)},i={x:t.x-1*r.x,y:t.y-1*r.y},s={x:Number.NaN,y:Number.NaN},a;if(r.x<0||r.x>=e.lim[0]||r.y<0||r.y>=e.lim[1])return s;a=r.y*e.lim[0]+r.x;var o={x:e.cvs[a][0],y:e.cvs[a][1]};a++;var l={x:e.cvs[a][0],y:e.cvs[a][1]};a+=e.lim[0];var c={x:e.cvs[a][0],y:e.cvs[a][1]};a--;var h={x:e.cvs[a][0],y:e.cvs[a][1]},f=i.x*i.y,m=i.x*(1-i.y),y=(1-i.x)*(1-i.y),x=(1-i.x)*i.y;return s.x=y*o.x+m*l.x+x*h.x+f*c.x,s.y=y*o.y+m*l.y+x*h.y+f*c.y,s}function l5(n,e,t){var r=t.x,i=t.y,s=t.z||0,a,o,l,c={};for(l=0;l<3;l++)if(!(e&&l===2&&t.z===void 0))switch(l===0?(a=r,"ew".indexOf(n.axis[l])!==-1?o="x":o="y"):l===1?(a=i,"ns".indexOf(n.axis[l])!==-1?o="y":o="x"):(a=s,o="z"),n.axis[l]){case"e":c[o]=a;break;case"w":c[o]=-a;break;case"n":c[o]=a;break;case"s":c[o]=-a;break;case"u":t[o]!==void 0&&(c.z=a);break;case"d":t[o]!==void 0&&(c.z=-a);break;default:return null}return c}function jV(n){var e={x:n[0],y:n[1]};return n.length>2&&(e.z=n[2]),n.length>3&&(e.m=n[3]),e}function cde(n){c5(n.x),c5(n.y)}function c5(n){if(typeof Number.isFinite=="function"){if(Number.isFinite(n))return;throw new TypeError("coordinates must be finite numbers")}if(typeof n!="number"||n!==n||!isFinite(n))throw new TypeError("coordinates must be finite numbers")}function ude(n,e){return(n.datum.datum_type===vd||n.datum.datum_type===wd||n.datum.datum_type===T0)&&e.datumCode!=="WGS84"||(e.datum.datum_type===vd||e.datum.datum_type===wd||e.datum.datum_type===T0)&&n.datumCode!=="WGS84"}function Wv(n,e,t,r){var i;Array.isArray(t)?t=jV(t):t={x:t.x,y:t.y,z:t.z,m:t.m};var s=t.z!==void 0;if(cde(t),n.datum&&e.datum&&ude(n,e)&&(i=new Ua("WGS84"),t=Wv(n,i,t,r),n=i),r&&n.axis!=="enu"&&(t=l5(n,!1,t)),n.projName==="longlat")t={x:t.x*Dr,y:t.y*Dr,z:t.z||0};else if(n.to_meter&&(t={x:t.x*n.to_meter,y:t.y*n.to_meter,z:t.z||0}),t=n.inverse(t),!t)return;if(n.from_greenwich&&(t.x+=n.from_greenwich),t=ode(n.datum,e.datum,t),!!t)return t=t,e.from_greenwich&&(t={x:t.x-e.from_greenwich,y:t.y,z:t.z||0}),e.projName==="longlat"?t={x:t.x*Bs,y:t.y*Bs,z:t.z||0}:(t=e.forward(t),e.to_meter&&(t={x:t.x/e.to_meter,y:t.y/e.to_meter,z:t.z||0})),r&&e.axis!=="enu"?l5(e,!0,t):(t&&!s&&delete t.z,t)}var u5=Ua("WGS84");function LS(n,e,t,r){var i,s,a;return Array.isArray(t)?(i=Wv(n,e,t,r)||{x:NaN,y:NaN},t.length>2?typeof n.name<"u"&&n.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"?typeof i.z=="number"?[i.x,i.y,i.z].concat(t.slice(3)):[i.x,i.y,t[2]].concat(t.slice(3)):[i.x,i.y].concat(t.slice(2)):[i.x,i.y]):(s=Wv(n,e,t,r),a=Object.keys(t),a.length===2||a.forEach(function(o){if(typeof n.name<"u"&&n.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"){if(o==="x"||o==="y"||o==="z")return}else if(o==="x"||o==="y")return;s[o]=t[o]}),s)}function Ux(n){return n instanceof Ua?n:typeof n=="object"&&"oProj"in n?n.oProj:Ua(n)}function hde(n,e,t){var r,i,s=!1,a;return typeof e>"u"?(i=Ux(n),r=u5,s=!0):(typeof e.x<"u"||Array.isArray(e))&&(t=e,i=Ux(n),r=u5,s=!0),r||(r=Ux(n)),i||(i=Ux(e)),t?LS(r,i,t):(a={forward:function(o,l){return LS(r,i,o,l)},inverse:function(o,l){return LS(i,r,o,l)}},s&&(a.oProj=i),a)}var h5=6,VV="AJSAJS",GV="AFAFAF",h0=65,Ns=73,Pa=79,Lm=86,Om=90;const dde={forward:BV,inverse:fde,toPoint:zV};function BV(n,e){return e=e||5,pde(gde({lat:n[1],lon:n[0]}),e)}function fde(n){var e=qC($V(n.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat,e.lon,e.lat]:[e.left,e.bottom,e.right,e.top]}function zV(n){var e=qC($V(n.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}function OS(n){return n*(Math.PI/180)}function d5(n){return 180*(n/Math.PI)}function gde(n){var e=n.lat,t=n.lon,r=6378137,i=.00669438,s=.9996,a,o,l,c,h,f,m,y=OS(e),x=OS(t),_,w;w=Math.floor((t+180)/6)+1,t===180&&(w=60),e>=56&&e<64&&t>=3&&t<12&&(w=32),e>=72&&e<84&&(t>=0&&t<9?w=31:t>=9&&t<21?w=33:t>=21&&t<33?w=35:t>=33&&t<42&&(w=37)),a=(w-1)*6-180+3,_=OS(a),o=i/(1-i),l=r/Math.sqrt(1-i*Math.sin(y)*Math.sin(y)),c=Math.tan(y)*Math.tan(y),h=o*Math.cos(y)*Math.cos(y),f=Math.cos(y)*(x-_),m=r*((1-i/4-3*i*i/64-5*i*i*i/256)*y-(3*i/8+3*i*i/32+45*i*i*i/1024)*Math.sin(2*y)+(15*i*i/256+45*i*i*i/1024)*Math.sin(4*y)-35*i*i*i/3072*Math.sin(6*y));var S=s*l*(f+(1-c+h)*f*f*f/6+(5-18*c+c*c+72*h-58*o)*f*f*f*f*f/120)+5e5,b=s*(m+l*Math.tan(y)*(f*f/2+(5-c+9*h+4*h*h)*f*f*f*f/24+(61-58*c+c*c+600*h-330*o)*f*f*f*f*f*f/720));return e<0&&(b+=1e7),{northing:Math.round(b),easting:Math.round(S),zoneNumber:w,zoneLetter:mde(e)}}function qC(n){var e=n.northing,t=n.easting,r=n.zoneLetter,i=n.zoneNumber;if(i<0||i>60)return null;var s=.9996,a=6378137,o=.00669438,l,c=(1-Math.sqrt(1-o))/(1+Math.sqrt(1-o)),h,f,m,y,x,_,w,S,b,R=t-5e5,M=e;r<"N"&&(M-=1e7),w=(i-1)*6-180+3,l=o/(1-o),_=M/s,S=_/(a*(1-o/4-3*o*o/64-5*o*o*o/256)),b=S+(3*c/2-27*c*c*c/32)*Math.sin(2*S)+(21*c*c/16-55*c*c*c*c/32)*Math.sin(4*S)+151*c*c*c/96*Math.sin(6*S),h=a/Math.sqrt(1-o*Math.sin(b)*Math.sin(b)),f=Math.tan(b)*Math.tan(b),m=l*Math.cos(b)*Math.cos(b),y=a*(1-o)/Math.pow(1-o*Math.sin(b)*Math.sin(b),1.5),x=R/(h*s);var O=b-h*Math.tan(b)/y*(x*x/2-(5+3*f+10*m-4*m*m-9*l)*x*x*x*x/24+(61+90*f+298*m+45*f*f-252*l-3*m*m)*x*x*x*x*x*x/720);O=d5(O);var G=(x-(1+2*f+m)*x*x*x/6+(5-2*m+28*f-3*m*m+8*l+24*f*f)*x*x*x*x*x/120)/Math.cos(b);G=w+d5(G);var A;if(n.accuracy){var I=qC({northing:n.northing+n.accuracy,easting:n.easting+n.accuracy,zoneLetter:n.zoneLetter,zoneNumber:n.zoneNumber});A={top:I.lat,right:I.lon,bottom:O,left:G}}else A={lat:O,lon:G};return A}function mde(n){var e="Z";return 84>=n&&n>=72?e="X":72>n&&n>=64?e="W":64>n&&n>=56?e="V":56>n&&n>=48?e="U":48>n&&n>=40?e="T":40>n&&n>=32?e="S":32>n&&n>=24?e="R":24>n&&n>=16?e="Q":16>n&&n>=8?e="P":8>n&&n>=0?e="N":0>n&&n>=-8?e="M":-8>n&&n>=-16?e="L":-16>n&&n>=-24?e="K":-24>n&&n>=-32?e="J":-32>n&&n>=-40?e="H":-40>n&&n>=-48?e="G":-48>n&&n>=-56?e="F":-56>n&&n>=-64?e="E":-64>n&&n>=-72?e="D":-72>n&&n>=-80&&(e="C"),e}function pde(n,e){var t="00000"+n.easting,r="00000"+n.northing;return n.zoneNumber+n.zoneLetter+yde(n.easting,n.northing,n.zoneNumber)+t.substr(t.length-5,e)+r.substr(r.length-5,e)}function yde(n,e,t){var r=UV(t),i=Math.floor(n/1e5),s=Math.floor(e/1e5)%20;return xde(i,s,r)}function UV(n){var e=n%h5;return e===0&&(e=h5),e}function xde(n,e,t){var r=t-1,i=VV.charCodeAt(r),s=GV.charCodeAt(r),a=i+n-1,o=s+e,l=!1;a>Om&&(a=a-Om+h0-1,l=!0),(a===Ns||i<Ns&&a>Ns||(a>Ns||i<Ns)&&l)&&a++,(a===Pa||i<Pa&&a>Pa||(a>Pa||i<Pa)&&l)&&(a++,a===Ns&&a++),a>Om&&(a=a-Om+h0-1),o>Lm?(o=o-Lm+h0-1,l=!0):l=!1,(o===Ns||s<Ns&&o>Ns||(o>Ns||s<Ns)&&l)&&o++,(o===Pa||s<Pa&&o>Pa||(o>Pa||s<Pa)&&l)&&(o++,o===Ns&&o++),o>Lm&&(o=o-Lm+h0-1);var c=String.fromCharCode(a)+String.fromCharCode(o);return c}function $V(n){if(n&&n.length===0)throw"MGRSPoint coverting from nothing";for(var e=n.length,t=null,r="",i,s=0;!/[A-Z]/.test(i=n.charAt(s));){if(s>=2)throw"MGRSPoint bad conversion from: "+n;r+=i,s++}var a=parseInt(r,10);if(s===0||s+3>e)throw"MGRSPoint bad conversion from: "+n;var o=n.charAt(s++);if(o<="A"||o==="B"||o==="Y"||o>="Z"||o==="I"||o==="O")throw"MGRSPoint zone letter "+o+" not handled: "+n;t=n.substring(s,s+=2);for(var l=UV(a),c=_de(t.charAt(0),l),h=vde(t.charAt(1),l);h<wde(o);)h+=2e6;var f=e-s;if(f%2!==0)throw`MGRSPoint has to have an even number 
of digits after the zone letter and two 100km letters - front 
half for easting meters, second half for 
northing meters`+n;var m=f/2,y=0,x=0,_,w,S,b,R;return m>0&&(_=1e5/Math.pow(10,m),w=n.substring(s,s+m),y=parseFloat(w)*_,S=n.substring(s+m),x=parseFloat(S)*_),b=y+c,R=x+h,{easting:b,northing:R,zoneLetter:o,zoneNumber:a,accuracy:_}}function _de(n,e){for(var t=VV.charCodeAt(e-1),r=1e5,i=!1;t!==n.charCodeAt(0);){if(t++,t===Ns&&t++,t===Pa&&t++,t>Om){if(i)throw"Bad character: "+n;t=h0,i=!0}r+=1e5}return r}function vde(n,e){if(n>"V")throw"MGRSPoint given invalid Northing "+n;for(var t=GV.charCodeAt(e-1),r=0,i=!1;t!==n.charCodeAt(0);){if(t++,t===Ns&&t++,t===Pa&&t++,t>Lm){if(i)throw"Bad character: "+n;t=h0,i=!0}r+=1e5}return r}function wde(n){var e;switch(n){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+n}function ig(n,e,t){if(!(this instanceof ig))return new ig(n,e,t);if(Array.isArray(n))this.x=n[0],this.y=n[1],this.z=n[2]||0;else if(typeof n=="object")this.x=n.x,this.y=n.y,this.z=n.z||0;else if(typeof n=="string"&&typeof e>"u"){var r=n.split(",");this.x=parseFloat(r[0]),this.y=parseFloat(r[1]),this.z=parseFloat(r[2])||0}else this.x=n,this.y=e,this.z=t||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}ig.fromMGRS=function(n){return new ig(zV(n))};ig.prototype.toMGRS=function(n){return BV([this.x,this.y],n)};var Ede=1,Tde=.25,f5=.046875,g5=.01953125,m5=.01068115234375,Sde=.75,bde=.46875,Rde=.013020833333333334,Ade=.007120768229166667,Ide=.3645833333333333,Cde=.005696614583333333,kde=.3076171875;function YC(n){var e=[];e[0]=Ede-n*(Tde+n*(f5+n*(g5+n*m5))),e[1]=n*(Sde-n*(f5+n*(g5+n*m5)));var t=n*n;return e[2]=t*(bde-n*(Rde+n*Ade)),t*=n,e[3]=t*(Ide-n*Cde),e[4]=t*n*kde,e}function xg(n,e,t,r){return t*=e,e*=e,r[0]*n-t*(r[1]+e*(r[2]+e*(r[3]+e*r[4])))}var Pde=20;function ZC(n,e,t){for(var r=1/(1-e),i=n,s=Pde;s;--s){var a=Math.sin(i),o=1-e*a*a;if(o=(xg(i,a,Math.cos(i),t)-n)*(o*Math.sqrt(o))*r,i-=o,Math.abs(o)<ct)return i}return i}function Mde(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.es&&(this.en=YC(this.es),this.ml0=xg(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))}function Nde(n){var e=n.x,t=n.y,r=mt(e-this.long0,this.over),i,s,a,o=Math.sin(t),l=Math.cos(t);if(this.es){var h=l*r,f=Math.pow(h,2),m=this.ep2*Math.pow(l,2),y=Math.pow(m,2),x=Math.abs(l)>ct?Math.tan(t):0,_=Math.pow(x,2),w=Math.pow(_,2);i=1-this.es*Math.pow(o,2),h=h/Math.sqrt(i);var S=xg(t,o,l,this.en);s=this.a*(this.k0*h*(1+f/6*(1-_+m+f/20*(5-18*_+w+14*m-58*_*m+f/42*(61+179*w-w*_-479*_)))))+this.x0,a=this.a*(this.k0*(S-this.ml0+o*r*h/2*(1+f/12*(5-_+9*m+4*y+f/30*(61+w-58*_+270*m-330*_*m+f/56*(1385+543*w-w*_-3111*_))))))+this.y0}else{var c=l*Math.sin(r);if(Math.abs(Math.abs(c)-1)<ct)return 93;if(s=.5*this.a*this.k0*Math.log((1+c)/(1-c))+this.x0,a=l*Math.cos(r)/Math.sqrt(1-Math.pow(c,2)),c=Math.abs(a),c>=1){if(c-1>ct)return 93;a=0}else a=Math.acos(a);t<0&&(a=-a),a=this.a*this.k0*(a-this.lat0)+this.y0}return n.x=s,n.y=a,n}function Lde(n){var e,t,r,i,s=(n.x-this.x0)*(1/this.a),a=(n.y-this.y0)*(1/this.a);if(this.es)if(e=this.ml0+a/this.k0,t=ZC(e,this.es,this.en),Math.abs(t)<We){var f=Math.sin(t),m=Math.cos(t),y=Math.abs(m)>ct?Math.tan(t):0,x=this.ep2*Math.pow(m,2),_=Math.pow(x,2),w=Math.pow(y,2),S=Math.pow(w,2);e=1-this.es*Math.pow(f,2);var b=s*Math.sqrt(e)/this.k0,R=Math.pow(b,2);e=e*y,r=t-e*R/(1-this.es)*.5*(1-R/12*(5+3*w-9*x*w+x-4*_-R/30*(61+90*w-252*x*w+45*S+46*x-R/56*(1385+3633*w+4095*S+1574*S*w)))),i=mt(this.long0+b*(1-R/6*(1+2*w+x-R/20*(5+28*w+24*S+8*x*w+6*x-R/42*(61+662*w+1320*S+720*S*w))))/m,this.over)}else r=We*e1(a),i=0;else{var o=Math.exp(s/this.k0),l=.5*(o-1/o),c=this.lat0+a/this.k0,h=Math.cos(c);e=Math.sqrt((1-Math.pow(h,2))/(1+Math.pow(l,2))),r=Math.asin(e),a<0&&(r=-r),l===0&&h===0?i=0:i=mt(Math.atan2(l,h)+this.long0,this.over)}return n.x=i,n.y=r,n}var Ode=["Fast_Transverse_Mercator","Fast Transverse Mercator"];const R_={init:Mde,forward:Nde,inverse:Lde,names:Ode};function WV(n){var e=Math.exp(n);return e=(e-1/e)/2,e}function Vs(n,e){n=Math.abs(n),e=Math.abs(e);var t=Math.max(n,e),r=Math.min(n,e)/(t||1);return t*Math.sqrt(1+Math.pow(r,2))}function Dde(n){var e=1+n,t=e-1;return t===0?n:n*Math.log(e)/t}function Fde(n){var e=Math.abs(n);return e=Dde(e*(1+e/(Vs(1,e)+1))),n<0?-e:e}function JC(n,e){for(var t=2*Math.cos(2*e),r=n.length-1,i=n[r],s=0,a;--r>=0;)a=-s+t*i+n[r],s=i,i=a;return e+a*Math.sin(2*e)}function jde(n,e){for(var t=2*Math.cos(e),r=n.length-1,i=n[r],s=0,a;--r>=0;)a=-s+t*i+n[r],s=i,i=a;return Math.sin(e)*a}function Vde(n){var e=Math.exp(n);return e=(e+1/e)/2,e}function HV(n,e,t){for(var r=Math.sin(e),i=Math.cos(e),s=WV(t),a=Vde(t),o=2*i*a,l=-2*r*s,c=n.length-1,h=n[c],f=0,m=0,y=0,x,_;--c>=0;)x=m,_=f,m=h,f=y,h=-x+o*m-l*f+n[c],y=-_+l*m+o*f;return o=r*a,l=i*s,[o*h-l*y,o*y+l*h]}function Gde(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(R_.init.apply(this),this.forward=R_.forward,this.inverse=R_.inverse),this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var n=this.es/(1+Math.sqrt(1-this.es)),e=n/(2-n),t=e;this.cgb[0]=e*(2+e*(-2/3+e*(-2+e*(116/45+e*(26/45+e*(-2854/675)))))),this.cbg[0]=e*(-2+e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725)))))),t=t*e,this.cgb[1]=t*(7/3+e*(-8/5+e*(-227/45+e*(2704/315+e*(2323/945))))),this.cbg[1]=t*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945))))),t=t*e,this.cgb[2]=t*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835)))),this.cbg[2]=t*(-26/15+e*(34/21+e*(8/5+e*(-12686/2835)))),t=t*e,this.cgb[3]=t*(4279/630+e*(-332/35+e*(-399572/14175))),this.cbg[3]=t*(1237/630+e*(-12/5+e*(-24832/14175))),t=t*e,this.cgb[4]=t*(4174/315+e*(-144838/6237)),this.cbg[4]=t*(-734/315+e*(109598/31185)),t=t*e,this.cgb[5]=t*(601676/22275),this.cbg[5]=t*(444337/155925),t=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+t*(1/4+t*(1/64+t/256))),this.utg[0]=e*(-.5+e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800)))))),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800)))))),this.utg[1]=t*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720))))),this.gtu[1]=t*(13/48+e*(-3/5+e*(557/1440+e*(281/630+e*(-1983433/1935360))))),t=t*e,this.utg[2]=t*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720)))),this.gtu[2]=t*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440)))),t=t*e,this.utg[3]=t*(-4397/161280+e*(11/504+e*(830251/7257600))),this.gtu[3]=t*(49561/161280+e*(-179/168+e*(6601661/7257600))),t=t*e,this.utg[4]=t*(-4583/161280+e*(108847/3991680)),this.gtu[4]=t*(34729/80640+e*(-3418889/1995840)),t=t*e,this.utg[5]=t*(-20648693/638668800),this.gtu[5]=t*(212378941/319334400);var r=JC(this.cbg,this.lat0);this.Zb=-this.Qn*(r+jde(this.gtu,2*r))}function Bde(n){var e=mt(n.x-this.long0,this.over),t=n.y;t=JC(this.cbg,t);var r=Math.sin(t),i=Math.cos(t),s=Math.sin(e),a=Math.cos(e);t=Math.atan2(r,a*i),e=Math.atan2(s*i,Vs(r,i*a)),e=Fde(Math.tan(e));var o=HV(this.gtu,2*t,2*e);t=t+o[0],e=e+o[1];var l,c;return Math.abs(e)<=2.623395162778?(l=this.a*(this.Qn*e)+this.x0,c=this.a*(this.Qn*t+this.Zb)+this.y0):(l=1/0,c=1/0),n.x=l,n.y=c,n}function zde(n){var e=(n.x-this.x0)*(1/this.a),t=(n.y-this.y0)*(1/this.a);t=(t-this.Zb)/this.Qn,e=e/this.Qn;var r,i;if(Math.abs(e)<=2.623395162778){var s=HV(this.utg,2*t,2*e);t=t+s[0],e=e+s[1],e=Math.atan(WV(e));var a=Math.sin(t),o=Math.cos(t),l=Math.sin(e),c=Math.cos(e);t=Math.atan2(a*c,Vs(l,c*o)),e=Math.atan2(l,c*o),r=mt(e+this.long0,this.over),i=JC(this.cgb,t)}else r=1/0,i=1/0;return n.x=r,n.y=i,n}var Ude=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"];const A_={init:Gde,forward:Bde,inverse:zde,names:Ude};function $de(n,e){if(n===void 0){if(n=Math.floor((mt(e)+Math.PI)*30/Math.PI)+1,n<0)return 0;if(n>60)return 60}return n}var Wde="etmerc";function Hde(){var n=$de(this.zone,this.long0);if(n===void 0)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(n)-183)*Dr,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,A_.init.apply(this),this.forward=A_.forward,this.inverse=A_.inverse}var Kde=["Universal Transverse Mercator System","utm"];const Xde={init:Hde,names:Kde,dependsOn:Wde};function QC(n,e){return Math.pow((1-n)/(1+n),e)}var qde=20;function Yde(){var n=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*n*n),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(n/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+zn)/(Math.pow(Math.tan(.5*this.lat0+zn),this.C)*QC(this.e*n,this.ratexp))}function Zde(n){var e=n.x,t=n.y;return n.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*t+zn),this.C)*QC(this.e*Math.sin(t),this.ratexp))-We,n.x=this.C*e,n}function Jde(n){for(var e=1e-14,t=n.x/this.C,r=n.y,i=Math.pow(Math.tan(.5*r+zn)/this.K,1/this.C),s=qde;s>0&&(r=2*Math.atan(i*QC(this.e*Math.sin(n.y),-.5*this.e))-We,!(Math.abs(r-n.y)<e));--s)n.y=r;return s?(n.x=t,n.y=r,n):null}const ek={init:Yde,forward:Zde,inverse:Jde};function Qde(){ek.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))}function efe(n){var e,t,r,i;return n.x=mt(n.x-this.long0,this.over),ek.forward.apply(this,[n]),e=Math.sin(n.y),t=Math.cos(n.y),r=Math.cos(n.x),i=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*t*r),n.x=i*t*Math.sin(n.x),n.y=i*(this.cosc0*e-this.sinc0*t*r),n.x=this.a*n.x+this.x0,n.y=this.a*n.y+this.y0,n}function tfe(n){var e,t,r,i,s;if(n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,n.x/=this.k0,n.y/=this.k0,s=Vs(n.x,n.y)){var a=2*Math.atan2(s,this.R2);e=Math.sin(a),t=Math.cos(a),i=Math.asin(t*this.sinc0+n.y*e*this.cosc0/s),r=Math.atan2(n.x*e,s*this.cosc0*t-n.y*this.sinc0*e)}else i=this.phic0,r=0;return n.x=r,n.y=i,ek.inverse.apply(this,[n]),n.x=mt(n.x+this.long0,this.over),n}var nfe=["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"];const rfe={init:Qde,forward:efe,inverse:tfe,names:nfe};function tk(n,e,t){return e*=t,Math.tan(.5*(We+n))*Math.pow((1-e)/(1+e),.5*t)}function ife(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=ct&&(this.k0=.5*(1+e1(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=ct&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=ct&&Math.abs(Math.cos(this.lat_ts))>ct&&(this.k0=.5*this.cons*gl(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/Eo(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=gl(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(tk(this.lat0,this.sinlat0,this.e))-We,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function sfe(n){var e=n.x,t=n.y,r=Math.sin(t),i=Math.cos(t),s,a,o,l,c,h,f=mt(e-this.long0,this.over);return Math.abs(Math.abs(e-this.long0)-Math.PI)<=ct&&Math.abs(t+this.lat0)<=ct?(n.x=NaN,n.y=NaN,n):this.sphere?(s=2*this.k0/(1+this.sinlat0*r+this.coslat0*i*Math.cos(f)),n.x=this.a*s*i*Math.sin(f)+this.x0,n.y=this.a*s*(this.coslat0*r-this.sinlat0*i*Math.cos(f))+this.y0,n):(a=2*Math.atan(tk(t,r,this.e))-We,l=Math.cos(a),o=Math.sin(a),Math.abs(this.coslat0)<=ct?(c=Eo(this.e,t*this.con,this.con*r),h=2*this.a*this.k0*c/this.cons,n.x=this.x0+h*Math.sin(e-this.long0),n.y=this.y0-this.con*h*Math.cos(e-this.long0),n):(Math.abs(this.sinlat0)<ct?(s=2*this.a*this.k0/(1+l*Math.cos(f)),n.y=s*o):(s=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*o+this.cosX0*l*Math.cos(f))),n.y=s*(this.cosX0*o-this.sinX0*l*Math.cos(f))+this.y0),n.x=s*l*Math.sin(f)+this.x0,n))}function afe(n){n.x-=this.x0,n.y-=this.y0;var e,t,r,i,s,a=Math.sqrt(n.x*n.x+n.y*n.y);if(this.sphere){var o=2*Math.atan(a/(2*this.a*this.k0));return e=this.long0,t=this.lat0,a<=ct?(n.x=e,n.y=t,n):(t=Math.asin(Math.cos(o)*this.sinlat0+n.y*Math.sin(o)*this.coslat0/a),Math.abs(this.coslat0)<ct?this.lat0>0?e=mt(this.long0+Math.atan2(n.x,-1*n.y),this.over):e=mt(this.long0+Math.atan2(n.x,n.y),this.over):e=mt(this.long0+Math.atan2(n.x*Math.sin(o),a*this.coslat0*Math.cos(o)-n.y*this.sinlat0*Math.sin(o)),this.over),n.x=e,n.y=t,n)}else if(Math.abs(this.coslat0)<=ct){if(a<=ct)return t=this.lat0,e=this.long0,n.x=e,n.y=t,n;n.x*=this.con,n.y*=this.con,r=a*this.cons/(2*this.a*this.k0),t=this.con*sy(this.e,r),e=this.con*mt(this.con*this.long0+Math.atan2(n.x,-1*n.y),this.over)}else i=2*Math.atan(a*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,a<=ct?s=this.X0:(s=Math.asin(Math.cos(i)*this.sinX0+n.y*Math.sin(i)*this.cosX0/a),e=mt(this.long0+Math.atan2(n.x*Math.sin(i),a*this.cosX0*Math.cos(i)-n.y*this.sinX0*Math.sin(i)),this.over)),t=-1*sy(this.e,Math.tan(.5*(We+s)));return n.x=e,n.y=t,n}var ofe=["stere","Stereographic_South_Pole","Polar_Stereographic_variant_A","Polar_Stereographic_variant_B","Polar_Stereographic"];const lfe={init:ife,forward:sfe,inverse:afe,names:ofe,ssfn_:tk};function cfe(){var n=this.lat0;this.lambda0=this.long0;var e=Math.sin(n),t=this.a,r=this.rf,i=1/r,s=2*i-Math.pow(i,2),a=this.e=Math.sqrt(s);this.R=this.k0*t*Math.sqrt(1-s)/(1-s*Math.pow(e,2)),this.alpha=Math.sqrt(1+s/(1-s)*Math.pow(Math.cos(n),4)),this.b0=Math.asin(e/this.alpha);var o=Math.log(Math.tan(Math.PI/4+this.b0/2)),l=Math.log(Math.tan(Math.PI/4+n/2)),c=Math.log((1+a*e)/(1-a*e));this.K=o-this.alpha*l+this.alpha*a/2*c}function ufe(n){var e=Math.log(Math.tan(Math.PI/4-n.y/2)),t=this.e/2*Math.log((1+this.e*Math.sin(n.y))/(1-this.e*Math.sin(n.y))),r=-this.alpha*(e+t)+this.K,i=2*(Math.atan(Math.exp(r))-Math.PI/4),s=this.alpha*(n.x-this.lambda0),a=Math.atan(Math.sin(s)/(Math.sin(this.b0)*Math.tan(i)+Math.cos(this.b0)*Math.cos(s))),o=Math.asin(Math.cos(this.b0)*Math.sin(i)-Math.sin(this.b0)*Math.cos(i)*Math.cos(s));return n.y=this.R/2*Math.log((1+Math.sin(o))/(1-Math.sin(o)))+this.y0,n.x=this.R*a+this.x0,n}function hfe(n){for(var e=n.x-this.x0,t=n.y-this.y0,r=e/this.R,i=2*(Math.atan(Math.exp(t/this.R))-Math.PI/4),s=Math.asin(Math.cos(this.b0)*Math.sin(i)+Math.sin(this.b0)*Math.cos(i)*Math.cos(r)),a=Math.atan(Math.sin(r)/(Math.cos(this.b0)*Math.cos(r)-Math.sin(this.b0)*Math.tan(i))),o=this.lambda0+a/this.alpha,l=0,c=s,h=-1e3,f=0;Math.abs(c-h)>1e-7;){if(++f>20)return;l=1/this.alpha*(Math.log(Math.tan(Math.PI/4+s/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(c))/2)),h=c,c=2*Math.atan(Math.exp(l))-Math.PI/2}return n.x=o,n.y=c,n}var dfe=["somerc"];const ffe={init:cfe,forward:ufe,inverse:hfe,names:dfe};var Qf=1e-7;function gfe(n){var e=["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"],t=typeof n.projName=="object"?Object.keys(n.projName)[0]:n.projName;return"no_uoff"in n||"no_off"in n||e.indexOf(t)!==-1||e.indexOf(LV(t))!==-1}function mfe(){var n,e,t,r,i,s,a,o,l,c,h=0,f,m=0,y=0,x=0,_=0,w=0,S=0;this.no_off=gfe(this),this.no_rot="no_rot"in this;var b=!1;"alpha"in this&&(b=!0);var R=!1;if("rectified_grid_angle"in this&&(R=!0),b&&(S=this.alpha),R&&(h=this.rectified_grid_angle),b||R)m=this.longc;else if(y=this.long1,_=this.lat1,x=this.long2,w=this.lat2,Math.abs(_-w)<=Qf||(n=Math.abs(_))<=Qf||Math.abs(n-We)<=Qf||Math.abs(Math.abs(this.lat0)-We)<=Qf||Math.abs(Math.abs(w)-We)<=Qf)throw new Error;var M=1-this.es;e=Math.sqrt(M),Math.abs(this.lat0)>ct?(o=Math.sin(this.lat0),t=Math.cos(this.lat0),n=1-this.es*o*o,this.B=t*t,this.B=Math.sqrt(1+this.es*this.B*this.B/M),this.A=this.B*this.k0*e/n,r=this.B*e/(t*Math.sqrt(n)),i=r*r-1,i<=0?i=0:(i=Math.sqrt(i),this.lat0<0&&(i=-i)),this.E=i+=r,this.E*=Math.pow(Eo(this.e,this.lat0,o),this.B)):(this.B=1/e,this.A=this.k0,this.E=r=i=1),b||R?(b?(f=Math.asin(Math.sin(S)/r),R||(h=S)):(f=h,S=Math.asin(r*Math.sin(f))),this.lam0=m-Math.asin(.5*(i-1/i)*Math.tan(f))/this.B):(s=Math.pow(Eo(this.e,_,Math.sin(_)),this.B),a=Math.pow(Eo(this.e,w,Math.sin(w)),this.B),i=this.E/s,l=(a-s)/(a+s),c=this.E*this.E,c=(c-a*s)/(c+a*s),n=y-x,n<-Math.PI?x-=ry:n>Math.PI&&(x+=ry),this.lam0=mt(.5*(y+x)-Math.atan(c*Math.tan(.5*this.B*(y-x))/l)/this.B,this.over),f=Math.atan(2*Math.sin(this.B*mt(y-this.lam0,this.over))/(i-1/i)),h=S=Math.asin(r*Math.sin(f))),this.singam=Math.sin(f),this.cosgam=Math.cos(f),this.sinrot=Math.sin(h),this.cosrot=Math.cos(h),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(r*r-1)/Math.cos(S))),this.lat0<0&&(this.u_0=-this.u_0)),i=.5*f,this.v_pole_n=this.ArB*Math.log(Math.tan(zn-i)),this.v_pole_s=this.ArB*Math.log(Math.tan(zn+i))}function pfe(n){var e={},t,r,i,s,a,o,l,c;if(n.x=n.x-this.lam0,Math.abs(Math.abs(n.y)-We)>ct){if(a=this.E/Math.pow(Eo(this.e,n.y,Math.sin(n.y)),this.B),o=1/a,t=.5*(a-o),r=.5*(a+o),s=Math.sin(this.B*n.x),i=(t*this.singam-s*this.cosgam)/r,Math.abs(Math.abs(i)-1)<ct)throw new Error;c=.5*this.ArB*Math.log((1-i)/(1+i)),o=Math.cos(this.B*n.x),Math.abs(o)<Qf?l=this.A*n.x:l=this.ArB*Math.atan2(t*this.cosgam+s*this.singam,o)}else c=n.y>0?this.v_pole_n:this.v_pole_s,l=this.ArB*n.y;return this.no_rot?(e.x=l,e.y=c):(l-=this.u_0,e.x=c*this.cosrot+l*this.sinrot,e.y=l*this.cosrot-c*this.sinrot),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e}function yfe(n){var e,t,r,i,s,a,o,l={};if(n.x=(n.x-this.x0)*(1/this.a),n.y=(n.y-this.y0)*(1/this.a),this.no_rot?(t=n.y,e=n.x):(t=n.x*this.cosrot-n.y*this.sinrot,e=n.y*this.cosrot+n.x*this.sinrot+this.u_0),r=Math.exp(-this.BrA*t),i=.5*(r-1/r),s=.5*(r+1/r),a=Math.sin(this.BrA*e),o=(a*this.cosgam+i*this.singam)/s,Math.abs(Math.abs(o)-1)<ct)l.x=0,l.y=o<0?-We:We;else{if(l.y=this.E/Math.sqrt((1+o)/(1-o)),l.y=sy(this.e,Math.pow(l.y,1/this.B)),l.y===1/0)throw new Error;l.x=-this.rB*Math.atan2(i*this.cosgam-a*this.singam,Math.cos(this.BrA*e))}return l.x+=this.lam0,l}var xfe=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Variant_B","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"];const _fe={init:mfe,forward:pfe,inverse:yfe,names:xfe};function vfe(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<ct)){var n=this.b/this.a;this.e=Math.sqrt(1-n*n);var e=Math.sin(this.lat1),t=Math.cos(this.lat1),r=gl(this.e,e,t),i=Eo(this.e,this.lat1,e),s=Math.sin(this.lat2),a=Math.cos(this.lat2),o=gl(this.e,s,a),l=Eo(this.e,this.lat2,s),c=Math.abs(Math.abs(this.lat0)-We)<ct?0:Eo(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>ct?this.ns=Math.log(r/o)/Math.log(i/l):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=r/(this.ns*Math.pow(i,this.ns)),this.rh=this.a*this.f0*Math.pow(c,this.ns),this.title||(this.title="Lambert Conformal Conic")}}function wfe(n){var e=n.x,t=n.y;Math.abs(2*Math.abs(t)-Math.PI)<=ct&&(t=e1(t)*(We-2*ct));var r=Math.abs(Math.abs(t)-We),i,s;if(r>ct)i=Eo(this.e,t,Math.sin(t)),s=this.a*this.f0*Math.pow(i,this.ns);else{if(r=t*this.ns,r<=0)return null;s=0}var a=this.ns*mt(e-this.long0,this.over);return n.x=this.k0*(s*Math.sin(a))+this.x0,n.y=this.k0*(this.rh-s*Math.cos(a))+this.y0,n}function Efe(n){var e,t,r,i,s,a=(n.x-this.x0)/this.k0,o=this.rh-(n.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(a*a+o*o),t=1):(e=-Math.sqrt(a*a+o*o),t=-1);var l=0;if(e!==0&&(l=Math.atan2(t*a,t*o)),e!==0||this.ns>0){if(t=1/this.ns,r=Math.pow(e/(this.a*this.f0),t),i=sy(this.e,r),i===-9999)return null}else i=-We;return s=mt(l/this.ns+this.long0,this.over),n.x=s,n.y=i,n}var Tfe=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"];const Sfe={init:vfe,forward:wfe,inverse:Efe,names:Tfe};function bfe(){this.a=6377397155e-3,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.7417649320975901-.308341501185665),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq}function Rfe(n){var e,t,r,i,s,a,o,l=n.x,c=n.y,h=mt(l-this.long0,this.over);return e=Math.pow((1+this.e*Math.sin(c))/(1-this.e*Math.sin(c)),this.alfa*this.e/2),t=2*(Math.atan(this.k*Math.pow(Math.tan(c/2+this.s45),this.alfa)/e)-this.s45),r=-h*this.alfa,i=Math.asin(Math.cos(this.ad)*Math.sin(t)+Math.sin(this.ad)*Math.cos(t)*Math.cos(r)),s=Math.asin(Math.cos(t)*Math.sin(r)/Math.cos(i)),a=this.n*s,o=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(i/2+this.s45),this.n),n.y=o*Math.cos(a)/1,n.x=o*Math.sin(a)/1,this.czech||(n.y*=-1,n.x*=-1),n}function Afe(n){var e,t,r,i,s,a,o,l,c=n.x;n.x=n.y,n.y=c,this.czech||(n.y*=-1,n.x*=-1),a=Math.sqrt(n.x*n.x+n.y*n.y),s=Math.atan2(n.y,n.x),i=s/Math.sin(this.s0),r=2*(Math.atan(Math.pow(this.ro0/a,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(r)-Math.sin(this.ad)*Math.cos(r)*Math.cos(i)),t=Math.asin(Math.cos(r)*Math.sin(i)/Math.cos(e)),n.x=this.long0-t/this.alfa,o=e,l=0;var h=0;do n.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(o))/(1-this.e*Math.sin(o)),this.e/2))-this.s45),Math.abs(o-n.y)<1e-10&&(l=1),o=n.y,h+=1;while(l===0&&h<15);return h>=15?null:n}var Ife=["Krovak","krovak"];const Cfe={init:bfe,forward:Rfe,inverse:Afe,names:Ife};function Ss(n,e,t,r,i){return n*i-e*Math.sin(2*i)+t*Math.sin(4*i)-r*Math.sin(6*i)}function t1(n){return 1-.25*n*(1+n/16*(3+1.25*n))}function n1(n){return .375*n*(1+.25*n*(1+.46875*n))}function r1(n){return .05859375*n*n*(1+.75*n)}function i1(n){return n*n*n*(35/3072)}function nk(n,e,t){var r=e*t;return n/Math.sqrt(1-r*r)}function Yu(n){return Math.abs(n)<We?n:n-e1(n)*Math.PI}function Hv(n,e,t,r,i){var s,a;s=n/e;for(var o=0;o<15;o++)if(a=(n-(e*s-t*Math.sin(2*s)+r*Math.sin(4*s)-i*Math.sin(6*s)))/(e-2*t*Math.cos(2*s)+4*r*Math.cos(4*s)-6*i*Math.cos(6*s)),s+=a,Math.abs(a)<=1e-10)return s;return NaN}function kfe(){this.sphere||(this.e0=t1(this.es),this.e1=n1(this.es),this.e2=r1(this.es),this.e3=i1(this.es),this.ml0=this.a*Ss(this.e0,this.e1,this.e2,this.e3,this.lat0))}function Pfe(n){var e,t,r=n.x,i=n.y;if(r=mt(r-this.long0,this.over),this.sphere)e=this.a*Math.asin(Math.cos(i)*Math.sin(r)),t=this.a*(Math.atan2(Math.tan(i),Math.cos(r))-this.lat0);else{var s=Math.sin(i),a=Math.cos(i),o=nk(this.a,this.e,s),l=Math.tan(i)*Math.tan(i),c=r*Math.cos(i),h=c*c,f=this.es*a*a/(1-this.es),m=this.a*Ss(this.e0,this.e1,this.e2,this.e3,i);e=o*c*(1-h*l*(1/6-(8-l+8*f)*h/120)),t=m-this.ml0+o*s/a*h*(.5+(5-l+6*f)*h/24)}return n.x=e+this.x0,n.y=t+this.y0,n}function Mfe(n){n.x-=this.x0,n.y-=this.y0;var e=n.x/this.a,t=n.y/this.a,r,i;if(this.sphere){var s=t+this.lat0;r=Math.asin(Math.sin(s)*Math.cos(e)),i=Math.atan2(Math.tan(e),Math.cos(s))}else{var a=this.ml0/this.a+t,o=Hv(a,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(o)-We)<=ct)return n.x=this.long0,n.y=We,t<0&&(n.y*=-1),n;var l=nk(this.a,this.e,Math.sin(o)),c=l*l*l/this.a/this.a*(1-this.es),h=Math.pow(Math.tan(o),2),f=e*this.a/l,m=f*f;r=o-l*Math.tan(o)/c*f*f*(.5-(1+3*h)*f*f/24),i=f*(1-m*(h/3+(1+3*h)*h*m/15))/Math.cos(o)}return n.x=mt(i+this.long0,this.over),n.y=Yu(r),n}var Nfe=["Cassini","Cassini_Soldner","cass"];const Lfe={init:kfe,forward:Pfe,inverse:Mfe,names:Nfe};function Cu(n,e){var t;return n>1e-7?(t=n*e,(1-n*n)*(e/(1-t*t)-.5/n*Math.log((1-t)/(1+t)))):2*e}var FR=1,jR=2,VR=3,I_=4;function Ofe(){var n=Math.abs(this.lat0);if(Math.abs(n-We)<ct?this.mode=this.lat0<0?FR:jR:Math.abs(n)<ct?this.mode=VR:this.mode=I_,this.es>0){var e;switch(this.qp=Cu(this.e,1),this.mmf=.5/(1-this.es),this.apa=$fe(this.es),this.mode){case jR:this.dd=1;break;case FR:this.dd=1;break;case VR:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case I_:this.rq=Math.sqrt(.5*this.qp),e=Math.sin(this.lat0),this.sinb1=Cu(this.e,e)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*e*e)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd;break}}else this.mode===I_&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function Dfe(n){var e,t,r,i,s,a,o,l,c,h,f=n.x,m=n.y;if(f=mt(f-this.long0,this.over),this.sphere){if(s=Math.sin(m),h=Math.cos(m),r=Math.cos(f),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(t=this.mode===this.EQUIT?1+h*r:1+this.sinph0*s+this.cosph0*h*r,t<=ct)return null;t=Math.sqrt(2/t),e=t*h*Math.sin(f),t*=this.mode===this.EQUIT?s:this.cosph0*s-this.sinph0*h*r}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(r=-r),Math.abs(m+this.lat0)<ct)return null;t=zn-m*.5,t=2*(this.mode===this.S_POLE?Math.cos(t):Math.sin(t)),e=t*Math.sin(f),t*=r}}else{switch(o=0,l=0,c=0,r=Math.cos(f),i=Math.sin(f),s=Math.sin(m),a=Cu(this.e,s),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(o=a/this.qp,l=Math.sqrt(1-o*o)),this.mode){case this.OBLIQ:c=1+this.sinb1*o+this.cosb1*l*r;break;case this.EQUIT:c=1+l*r;break;case this.N_POLE:c=We+m,a=this.qp-a;break;case this.S_POLE:c=m-We,a=this.qp+a;break}if(Math.abs(c)<ct)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:c=Math.sqrt(2/c),this.mode===this.OBLIQ?t=this.ymf*c*(this.cosb1*o-this.sinb1*l*r):t=(c=Math.sqrt(2/(1+l*r)))*o*this.ymf,e=this.xmf*c*l*i;break;case this.N_POLE:case this.S_POLE:a>=0?(e=(c=Math.sqrt(a))*i,t=r*(this.mode===this.S_POLE?c:-c)):e=t=0;break}}return n.x=this.a*e+this.x0,n.y=this.a*t+this.y0,n}function Ffe(n){n.x-=this.x0,n.y-=this.y0;var e=n.x/this.a,t=n.y/this.a,r,i,s,a,o,l,c;if(this.sphere){var h=0,f,m=0;if(f=Math.sqrt(e*e+t*t),i=f*.5,i>1)return null;switch(i=2*Math.asin(i),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(m=Math.sin(i),h=Math.cos(i)),this.mode){case this.EQUIT:i=Math.abs(f)<=ct?0:Math.asin(t*m/f),e*=m,t=h*f;break;case this.OBLIQ:i=Math.abs(f)<=ct?this.lat0:Math.asin(h*this.sinph0+t*m*this.cosph0/f),e*=m*this.cosph0,t=(h-Math.sin(i)*this.sinph0)*f;break;case this.N_POLE:t=-t,i=We-i;break;case this.S_POLE:i-=We;break}r=t===0&&(this.mode===this.EQUIT||this.mode===this.OBLIQ)?0:Math.atan2(e,t)}else{if(c=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(e/=this.dd,t*=this.dd,l=Math.sqrt(e*e+t*t),l<ct)return n.x=this.long0,n.y=this.lat0,n;a=2*Math.asin(.5*l/this.rq),s=Math.cos(a),e*=a=Math.sin(a),this.mode===this.OBLIQ?(c=s*this.sinb1+t*a*this.cosb1/l,o=this.qp*c,t=l*this.cosb1*s-t*this.sinb1*a):(c=t*a/l,o=this.qp*c,t=l*s)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(t=-t),o=e*e+t*t,!o)return n.x=this.long0,n.y=this.lat0,n;c=1-o/this.qp,this.mode===this.S_POLE&&(c=-c)}r=Math.atan2(e,t),i=Wfe(Math.asin(c),this.apa)}return n.x=mt(this.long0+r,this.over),n.y=i,n}var jfe=.3333333333333333,Vfe=.17222222222222222,Gfe=.10257936507936508,Bfe=.06388888888888888,zfe=.0664021164021164,Ufe=.016415012942191543;function $fe(n){var e,t=[];return t[0]=n*jfe,e=n*n,t[0]+=e*Vfe,t[1]=e*Bfe,e*=n,t[0]+=e*Gfe,t[1]+=e*zfe,t[2]=e*Ufe,t}function Wfe(n,e){var t=n+n;return n+e[0]*Math.sin(t)+e[1]*Math.sin(t+t)+e[2]*Math.sin(t+t+t)}var Hfe=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"];const Kfe={init:Ofe,forward:Dfe,inverse:Ffe,names:Hfe,S_POLE:FR,N_POLE:jR,EQUIT:VR,OBLIQ:I_};function Gu(n){return Math.abs(n)>1&&(n=n>1?1:-1),Math.asin(n)}function Xfe(){Math.abs(this.lat1+this.lat2)<ct||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=gl(this.e3,this.sin_po,this.cos_po),this.qs1=Cu(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=gl(this.e3,this.sin_po,this.cos_po),this.qs2=Cu(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=Cu(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>ct?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function qfe(n){var e=n.x,t=n.y;this.sin_phi=Math.sin(t),this.cos_phi=Math.cos(t);var r=Cu(this.e3,this.sin_phi),i=this.a*Math.sqrt(this.c-this.ns0*r)/this.ns0,s=this.ns0*mt(e-this.long0,this.over),a=i*Math.sin(s)+this.x0,o=this.rh-i*Math.cos(s)+this.y0;return n.x=a,n.y=o,n}function Yfe(n){var e,t,r,i,s,a;return n.x-=this.x0,n.y=this.rh-n.y+this.y0,this.ns0>=0?(e=Math.sqrt(n.x*n.x+n.y*n.y),r=1):(e=-Math.sqrt(n.x*n.x+n.y*n.y),r=-1),i=0,e!==0&&(i=Math.atan2(r*n.x,r*n.y)),r=e*this.ns0/this.a,this.sphere?a=Math.asin((this.c-r*r)/(2*this.ns0)):(t=(this.c-r*r)/this.ns0,a=this.phi1z(this.e3,t)),s=mt(i/this.ns0+this.long0,this.over),n.x=s,n.y=a,n}function Zfe(n,e){var t,r,i,s,a,o=Gu(.5*e);if(n<ct)return o;for(var l=n*n,c=1;c<=25;c++)if(t=Math.sin(o),r=Math.cos(o),i=n*t,s=1-i*i,a=.5*s*s/r*(e/(1-l)-t/s+.5/n*Math.log((1-i)/(1+i))),o=o+a,Math.abs(a)<=1e-7)return o;return null}var Jfe=["Albers_Conic_Equal_Area","Albers_Equal_Area","Albers","aea"];const Qfe={init:Xfe,forward:qfe,inverse:Yfe,names:Jfe,phi1z:Zfe};function e0e(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1}function t0e(n){var e,t,r,i,s,a,o,l,c=n.x,h=n.y;return r=mt(c-this.long0,this.over),e=Math.sin(h),t=Math.cos(h),i=Math.cos(r),a=this.sin_p14*e+this.cos_p14*t*i,s=1,a>0||Math.abs(a)<=ct?(o=this.x0+this.a*s*t*Math.sin(r)/a,l=this.y0+this.a*s*(this.cos_p14*e-this.sin_p14*t*i)/a):(o=this.x0+this.infinity_dist*t*Math.sin(r),l=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*t*i)),n.x=o,n.y=l,n}function n0e(n){var e,t,r,i,s,a;return n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,n.x/=this.k0,n.y/=this.k0,(e=Math.sqrt(n.x*n.x+n.y*n.y))?(i=Math.atan2(e,this.rc),t=Math.sin(i),r=Math.cos(i),a=Gu(r*this.sin_p14+n.y*t*this.cos_p14/e),s=Math.atan2(n.x*t,e*this.cos_p14*r-n.y*this.sin_p14*t),s=mt(this.long0+s,this.over)):(a=this.phic0,s=0),n.x=s,n.y=a,n}var r0e=["gnom"];const i0e={init:e0e,forward:t0e,inverse:n0e,names:r0e};function s0e(n,e){var t=1-(1-n*n)/(2*n)*Math.log((1-n)/(1+n));if(Math.abs(Math.abs(e)-t)<1e-6)return e<0?-1*We:We;for(var r=Math.asin(.5*e),i,s,a,o,l=0;l<30;l++)if(s=Math.sin(r),a=Math.cos(r),o=n*s,i=Math.pow(1-o*o,2)/(2*a)*(e/(1-n*n)-s/(1-o*o)+.5/n*Math.log((1-o)/(1+o))),r+=i,Math.abs(i)<=1e-10)return r;return NaN}function a0e(){this.sphere||(this.k0=gl(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))}function o0e(n){var e=n.x,t=n.y,r,i,s=mt(e-this.long0,this.over);if(this.sphere)r=this.x0+this.a*s*Math.cos(this.lat_ts),i=this.y0+this.a*Math.sin(t)/Math.cos(this.lat_ts);else{var a=Cu(this.e,Math.sin(t));r=this.x0+this.a*this.k0*s,i=this.y0+this.a*a*.5/this.k0}return n.x=r,n.y=i,n}function l0e(n){n.x-=this.x0,n.y-=this.y0;var e,t;return this.sphere?(e=mt(this.long0+n.x/this.a/Math.cos(this.lat_ts),this.over),t=Math.asin(n.y/this.a*Math.cos(this.lat_ts))):(t=s0e(this.e,2*n.y*this.k0/this.a),e=mt(this.long0+n.x/(this.a*this.k0),this.over)),n.x=e,n.y=t,n}var c0e=["cea"];const u0e={init:a0e,forward:o0e,inverse:l0e,names:c0e};function h0e(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)}function d0e(n){var e=n.x,t=n.y,r=mt(e-this.long0,this.over),i=Yu(t-this.lat0);return n.x=this.x0+this.a*r*this.rc,n.y=this.y0+this.a*i,n}function f0e(n){var e=n.x,t=n.y;return n.x=mt(this.long0+(e-this.x0)/(this.a*this.rc),this.over),n.y=Yu(this.lat0+(t-this.y0)/this.a),n}var g0e=["Equirectangular","Equidistant_Cylindrical","Equidistant_Cylindrical_Spherical","eqc"];const m0e={init:h0e,forward:d0e,inverse:f0e,names:g0e};var p5=20;function p0e(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=t1(this.es),this.e1=n1(this.es),this.e2=r1(this.es),this.e3=i1(this.es),this.ml0=this.a*Ss(this.e0,this.e1,this.e2,this.e3,this.lat0)}function y0e(n){var e=n.x,t=n.y,r,i,s,a=mt(e-this.long0,this.over);if(s=a*Math.sin(t),this.sphere)Math.abs(t)<=ct?(r=this.a*a,i=-1*this.a*this.lat0):(r=this.a*Math.sin(s)/Math.tan(t),i=this.a*(Yu(t-this.lat0)+(1-Math.cos(s))/Math.tan(t)));else if(Math.abs(t)<=ct)r=this.a*a,i=-1*this.ml0;else{var o=nk(this.a,this.e,Math.sin(t))/Math.tan(t);r=o*Math.sin(s),i=this.a*Ss(this.e0,this.e1,this.e2,this.e3,t)-this.ml0+o*(1-Math.cos(s))}return n.x=r+this.x0,n.y=i+this.y0,n}function x0e(n){var e,t,r,i,s,a,o,l,c;if(r=n.x-this.x0,i=n.y-this.y0,this.sphere)if(Math.abs(i+this.a*this.lat0)<=ct)e=mt(r/this.a+this.long0,this.over),t=0;else{a=this.lat0+i/this.a,o=r*r/this.a/this.a+a*a,l=a;var h;for(s=p5;s;--s)if(h=Math.tan(l),c=-1*(a*(l*h+1)-l-.5*(l*l+o)*h)/((l-a)/h-1),l+=c,Math.abs(c)<=ct){t=l;break}e=mt(this.long0+Math.asin(r*Math.tan(l)/this.a)/Math.sin(t),this.over)}else if(Math.abs(i+this.ml0)<=ct)t=0,e=mt(this.long0+r/this.a,this.over);else{a=(this.ml0+i)/this.a,o=r*r/this.a/this.a+a*a,l=a;var f,m,y,x,_;for(s=p5;s;--s)if(_=this.e*Math.sin(l),f=Math.sqrt(1-_*_)*Math.tan(l),m=this.a*Ss(this.e0,this.e1,this.e2,this.e3,l),y=this.e0-2*this.e1*Math.cos(2*l)+4*this.e2*Math.cos(4*l)-6*this.e3*Math.cos(6*l),x=m/this.a,c=(a*(f*x+1)-x-.5*f*(x*x+o))/(this.es*Math.sin(2*l)*(x*x+o-2*a*x)/(4*f)+(a-x)*(f*y-2/Math.sin(2*l))-y),l-=c,Math.abs(c)<=ct){t=l;break}f=Math.sqrt(1-this.es*Math.pow(Math.sin(t),2))*Math.tan(t),e=mt(this.long0+Math.asin(r*f/this.a)/Math.sin(t),this.over)}return n.x=e,n.y=t,n}var _0e=["Polyconic","American_Polyconic","poly"];const v0e={init:p0e,forward:y0e,inverse:x0e,names:_0e};function w0e(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function E0e(n){var e,t=n.x,r=n.y,i=r-this.lat0,s=t-this.long0,a=i/np*1e-5,o=s,l=1,c=0;for(e=1;e<=10;e++)l=l*a,c=c+this.A[e]*l;var h=c,f=o,m=1,y=0,x,_,w=0,S=0;for(e=1;e<=6;e++)x=m*h-y*f,_=y*h+m*f,m=x,y=_,w=w+this.B_re[e]*m-this.B_im[e]*y,S=S+this.B_im[e]*m+this.B_re[e]*y;return n.x=S*this.a+this.x0,n.y=w*this.a+this.y0,n}function T0e(n){var e,t=n.x,r=n.y,i=t-this.x0,s=r-this.y0,a=s/this.a,o=i/this.a,l=1,c=0,h,f,m=0,y=0;for(e=1;e<=6;e++)h=l*a-c*o,f=c*a+l*o,l=h,c=f,m=m+this.C_re[e]*l-this.C_im[e]*c,y=y+this.C_im[e]*l+this.C_re[e]*c;for(var x=0;x<this.iterations;x++){var _=m,w=y,S,b,R=a,M=o;for(e=2;e<=6;e++)S=_*m-w*y,b=w*m+_*y,_=S,w=b,R=R+(e-1)*(this.B_re[e]*_-this.B_im[e]*w),M=M+(e-1)*(this.B_im[e]*_+this.B_re[e]*w);_=1,w=0;var O=this.B_re[1],G=this.B_im[1];for(e=2;e<=6;e++)S=_*m-w*y,b=w*m+_*y,_=S,w=b,O=O+e*(this.B_re[e]*_-this.B_im[e]*w),G=G+e*(this.B_im[e]*_+this.B_re[e]*w);var A=O*O+G*G;m=(R*O+M*G)/A,y=(M*O-R*G)/A}var I=m,P=y,D=1,L=0;for(e=1;e<=9;e++)D=D*I,L=L+this.D[e]*D;var U=this.lat0+L*np*1e5,j=this.long0+P;return n.x=j,n.y=U,n}var S0e=["New_Zealand_Map_Grid","nzmg"];const b0e={init:w0e,forward:E0e,inverse:T0e,names:S0e};function R0e(){}function A0e(n){var e=n.x,t=n.y,r=mt(e-this.long0,this.over),i=this.x0+this.a*r,s=this.y0+this.a*Math.log(Math.tan(Math.PI/4+t/2.5))*1.25;return n.x=i,n.y=s,n}function I0e(n){n.x-=this.x0,n.y-=this.y0;var e=mt(this.long0+n.x/this.a,this.over),t=2.5*(Math.atan(Math.exp(.8*n.y/this.a))-Math.PI/4);return n.x=e,n.y=t,n}var C0e=["Miller_Cylindrical","mill"];const k0e={init:R0e,forward:A0e,inverse:I0e,names:C0e};var P0e=20;function M0e(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=YC(this.es)}function N0e(n){var e,t,r=n.x,i=n.y;if(r=mt(r-this.long0,this.over),this.sphere){if(!this.m)i=this.n!==1?Math.asin(this.n*Math.sin(i)):i;else for(var s=this.n*Math.sin(i),a=P0e;a;--a){var o=(this.m*i+Math.sin(i)-s)/(this.m+Math.cos(i));if(i-=o,Math.abs(o)<ct)break}e=this.a*this.C_x*r*(this.m+Math.cos(i)),t=this.a*this.C_y*i}else{var l=Math.sin(i),c=Math.cos(i);t=this.a*xg(i,l,c,this.en),e=this.a*r*c/Math.sqrt(1-this.es*l*l)}return n.x=e,n.y=t,n}function L0e(n){var e,t,r,i;return n.x-=this.x0,r=n.x/this.a,n.y-=this.y0,e=n.y/this.a,this.sphere?(e/=this.C_y,r=r/(this.C_x*(this.m+Math.cos(e))),this.m?e=Gu((this.m*e+Math.sin(e))/this.n):this.n!==1&&(e=Gu(Math.sin(e)/this.n)),r=mt(r+this.long0,this.over),e=Yu(e)):(e=ZC(n.y/this.a,this.es,this.en),i=Math.abs(e),i<We?(i=Math.sin(e),t=this.long0+n.x*Math.sqrt(1-this.es*i*i)/(this.a*Math.cos(e)),r=mt(t,this.over)):i-ct<We&&(r=this.long0)),n.x=r,n.y=e,n}var O0e=["Sinusoidal","sinu"];const D0e={init:M0e,forward:N0e,inverse:L0e,names:O0e};function F0e(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0}function j0e(n){for(var e=n.x,t=n.y,r=mt(e-this.long0,this.over),i=t,s=Math.PI*Math.sin(t);;){var a=-(i+Math.sin(i)-s)/(1+Math.cos(i));if(i+=a,Math.abs(a)<ct)break}i/=2,Math.PI/2-Math.abs(t)<ct&&(r=0);var o=.900316316158*this.a*r*Math.cos(i)+this.x0,l=1.4142135623731*this.a*Math.sin(i)+this.y0;return n.x=o,n.y=l,n}function V0e(n){var e,t;n.x-=this.x0,n.y-=this.y0,t=n.y/(1.4142135623731*this.a),Math.abs(t)>.999999999999&&(t=.999999999999),e=Math.asin(t);var r=mt(this.long0+n.x/(.900316316158*this.a*Math.cos(e)),this.over);r<-Math.PI&&(r=-Math.PI),r>Math.PI&&(r=Math.PI),t=(2*e+Math.sin(2*e))/Math.PI,Math.abs(t)>1&&(t=1);var i=Math.asin(t);return n.x=r,n.y=i,n}var G0e=["Mollweide","moll"];const B0e={init:F0e,forward:j0e,inverse:V0e,names:G0e};function z0e(){Math.abs(this.lat1+this.lat2)<ct||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=t1(this.es),this.e1=n1(this.es),this.e2=r1(this.es),this.e3=i1(this.es),this.sin_phi=Math.sin(this.lat1),this.cos_phi=Math.cos(this.lat1),this.ms1=gl(this.e,this.sin_phi,this.cos_phi),this.ml1=Ss(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<ct?this.ns=this.sin_phi:(this.sin_phi=Math.sin(this.lat2),this.cos_phi=Math.cos(this.lat2),this.ms2=gl(this.e,this.sin_phi,this.cos_phi),this.ml2=Ss(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=Ss(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))}function U0e(n){var e=n.x,t=n.y,r;if(this.sphere)r=this.a*(this.g-t);else{var i=Ss(this.e0,this.e1,this.e2,this.e3,t);r=this.a*(this.g-i)}var s=this.ns*mt(e-this.long0,this.over),a=this.x0+r*Math.sin(s),o=this.y0+this.rh-r*Math.cos(s);return n.x=a,n.y=o,n}function $0e(n){n.x-=this.x0,n.y=this.rh-n.y+this.y0;var e,t,r,i;this.ns>=0?(t=Math.sqrt(n.x*n.x+n.y*n.y),e=1):(t=-Math.sqrt(n.x*n.x+n.y*n.y),e=-1);var s=0;if(t!==0&&(s=Math.atan2(e*n.x,e*n.y)),this.sphere)return i=mt(this.long0+s/this.ns,this.over),r=Yu(this.g-t/this.a),n.x=i,n.y=r,n;var a=this.g-t/this.a;return r=Hv(a,this.e0,this.e1,this.e2,this.e3),i=mt(this.long0+s/this.ns,this.over),n.x=i,n.y=r,n}var W0e=["Equidistant_Conic","eqdc"];const H0e={init:z0e,forward:U0e,inverse:$0e,names:W0e};function K0e(){this.R=this.a}function X0e(n){var e=n.x,t=n.y,r=mt(e-this.long0,this.over),i,s;Math.abs(t)<=ct&&(i=this.x0+this.R*r,s=this.y0);var a=Gu(2*Math.abs(t/Math.PI));(Math.abs(r)<=ct||Math.abs(Math.abs(t)-We)<=ct)&&(i=this.x0,t>=0?s=this.y0+Math.PI*this.R*Math.tan(.5*a):s=this.y0+Math.PI*this.R*-Math.tan(.5*a));var o=.5*Math.abs(Math.PI/r-r/Math.PI),l=o*o,c=Math.sin(a),h=Math.cos(a),f=h/(c+h-1),m=f*f,y=f*(2/c-1),x=y*y,_=Math.PI*this.R*(o*(f-x)+Math.sqrt(l*(f-x)*(f-x)-(x+l)*(m-x)))/(x+l);r<0&&(_=-_),i=this.x0+_;var w=l+f;return _=Math.PI*this.R*(y*w-o*Math.sqrt((x+l)*(l+1)-w*w))/(x+l),t>=0?s=this.y0+_:s=this.y0-_,n.x=i,n.y=s,n}function q0e(n){var e,t,r,i,s,a,o,l,c,h,f,m,y;return n.x-=this.x0,n.y-=this.y0,f=Math.PI*this.R,r=n.x/f,i=n.y/f,s=r*r+i*i,a=-Math.abs(i)*(1+s),o=a-2*i*i+r*r,l=-2*a+1+2*i*i+s*s,y=i*i/l+(2*o*o*o/l/l/l-9*a*o/l/l)/27,c=(a-o*o/3/l)/l,h=2*Math.sqrt(-c/3),f=3*y/c/h,Math.abs(f)>1&&(f>=0?f=1:f=-1),m=Math.acos(f)/3,n.y>=0?t=(-h*Math.cos(m+Math.PI/3)-o/3/l)*Math.PI:t=-(-h*Math.cos(m+Math.PI/3)-o/3/l)*Math.PI,Math.abs(r)<ct?e=this.long0:e=mt(this.long0+Math.PI*(s-1+Math.sqrt(1+2*(r*r-i*i)+s*s))/2/r,this.over),n.x=e,n.y=t,n}var Y0e=["Van_der_Grinten_I","VanDerGrinten","Van_der_Grinten","vandg"];const Z0e={init:K0e,forward:X0e,inverse:q0e,names:Y0e};function J0e(n,e,t,r,i,s){const a=r-e,o=Math.atan((1-s)*Math.tan(n)),l=Math.atan((1-s)*Math.tan(t)),c=Math.sin(o),h=Math.cos(o),f=Math.sin(l),m=Math.cos(l);let y=a,x,_=100,w,S,b,R,M,O,G,A,I,P,D,L,U,j;do{if(w=Math.sin(y),S=Math.cos(y),b=Math.sqrt(m*w*(m*w)+(h*f-c*m*S)*(h*f-c*m*S)),b===0)return{azi1:0,s12:0};R=c*f+h*m*S,M=Math.atan2(b,R),O=h*m*w/b,G=1-O*O,A=G!==0?R-2*c*f/G:0,I=s/16*G*(4+s*(4-3*G)),x=y,y=a+(1-I)*s*O*(M+I*b*(A+I*R*(-1+2*A*A)))}while(Math.abs(y-x)>1e-12&&--_>0);return _===0?{azi1:NaN,s12:NaN}:(P=G*(i*i-i*(1-s)*(i*(1-s)))/(i*(1-s)*(i*(1-s))),D=1+P/16384*(4096+P*(-768+P*(320-175*P))),L=P/1024*(256+P*(-128+P*(74-47*P))),U=L*b*(A+L/4*(R*(-1+2*A*A)-L/6*A*(-3+4*b*b)*(-3+4*A*A))),j=i*(1-s)*D*(M-U),{azi1:Math.atan2(m*w,h*f-c*m*S),s12:j})}function Q0e(n,e,t,r,i,s){const a=Math.atan((1-s)*Math.tan(n)),o=Math.sin(a),l=Math.cos(a),c=Math.sin(t),h=Math.cos(t),f=Math.atan2(o,l*h),m=l*c,y=1-m*m,x=y*(i*i-i*(1-s)*(i*(1-s)))/(i*(1-s)*(i*(1-s))),_=1+x/16384*(4096+x*(-768+x*(320-175*x))),w=x/1024*(256+x*(-128+x*(74-47*x)));let S=r/(i*(1-s)*_),b,R=100,M,O,G,A;do M=Math.cos(2*f+S),O=Math.sin(S),G=Math.cos(S),A=w*O*(M+w/4*(G*(-1+2*M*M)-w/6*M*(-3+4*O*O)*(-3+4*M*M))),b=S,S=r/(i*(1-s)*_)+A;while(Math.abs(S-b)>1e-12&&--R>0);if(R===0)return{lat2:NaN,lon2:NaN};const I=o*O-l*G*h,P=Math.atan2(o*G+l*O*h,(1-s)*Math.sqrt(m*m+I*I)),D=Math.atan2(O*c,l*G-o*O*h),L=s/16*y*(4+s*(4-3*y)),U=D-(1-L)*s*m*(S+L*O*(M+L*G*(-1+2*M*M))),j=e+U;return{lat2:P,lon2:j}}function ege(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0),this.f=this.es/(1+Math.sqrt(1-this.es))}function tge(n){var e=n.x,t=n.y,r=Math.sin(n.y),i=Math.cos(n.y),s=mt(e-this.long0,this.over),a,o,l,c,h,f,m,y,x,_,w;return this.sphere?Math.abs(this.sin_p12-1)<=ct?(n.x=this.x0+this.a*(We-t)*Math.sin(s),n.y=this.y0-this.a*(We-t)*Math.cos(s),n):Math.abs(this.sin_p12+1)<=ct?(n.x=this.x0+this.a*(We+t)*Math.sin(s),n.y=this.y0+this.a*(We+t)*Math.cos(s),n):(x=this.sin_p12*r+this.cos_p12*i*Math.cos(s),m=Math.acos(x),y=m?m/Math.sin(m):1,n.x=this.x0+this.a*y*i*Math.sin(s),n.y=this.y0+this.a*y*(this.cos_p12*r-this.sin_p12*i*Math.cos(s)),n):(a=t1(this.es),o=n1(this.es),l=r1(this.es),c=i1(this.es),Math.abs(this.sin_p12-1)<=ct?(h=this.a*Ss(a,o,l,c,We),f=this.a*Ss(a,o,l,c,t),n.x=this.x0+(h-f)*Math.sin(s),n.y=this.y0-(h-f)*Math.cos(s),n):Math.abs(this.sin_p12+1)<=ct?(h=this.a*Ss(a,o,l,c,We),f=this.a*Ss(a,o,l,c,t),n.x=this.x0+(h+f)*Math.sin(s),n.y=this.y0+(h+f)*Math.cos(s),n):Math.abs(e)<ct&&Math.abs(t-this.lat0)<ct?(n.x=n.y=0,n):(_=J0e(this.lat0,this.long0,t,e,this.a,this.f),w=_.azi1,n.x=_.s12*Math.sin(w),n.y=_.s12*Math.cos(w),n))}function nge(n){n.x-=this.x0,n.y-=this.y0;var e,t,r,i,s,a,o,l,c,h,f,m,y,x,_,w;return this.sphere?(e=Math.sqrt(n.x*n.x+n.y*n.y),e>2*We*this.a?void 0:(t=e/this.a,r=Math.sin(t),i=Math.cos(t),s=this.long0,Math.abs(e)<=ct?a=this.lat0:(a=Gu(i*this.sin_p12+n.y*r*this.cos_p12/e),o=Math.abs(this.lat0)-We,Math.abs(o)<=ct?this.lat0>=0?s=mt(this.long0+Math.atan2(n.x,-n.y),this.over):s=mt(this.long0-Math.atan2(-n.x,n.y),this.over):s=mt(this.long0+Math.atan2(n.x*r,e*this.cos_p12*i-n.y*this.sin_p12*r),this.over)),n.x=s,n.y=a,n)):(l=t1(this.es),c=n1(this.es),h=r1(this.es),f=i1(this.es),Math.abs(this.sin_p12-1)<=ct?(m=this.a*Ss(l,c,h,f,We),e=Math.sqrt(n.x*n.x+n.y*n.y),y=m-e,a=Hv(y/this.a,l,c,h,f),s=mt(this.long0+Math.atan2(n.x,-1*n.y),this.over),n.x=s,n.y=a,n):Math.abs(this.sin_p12+1)<=ct?(m=this.a*Ss(l,c,h,f,We),e=Math.sqrt(n.x*n.x+n.y*n.y),y=e-m,a=Hv(y/this.a,l,c,h,f),s=mt(this.long0+Math.atan2(n.x,n.y),this.over),n.x=s,n.y=a,n):(x=Math.atan2(n.x,n.y),_=Math.sqrt(n.x*n.x+n.y*n.y),w=Q0e(this.lat0,this.long0,x,_,this.a,this.f),n.x=w.lon2,n.y=w.lat2,n))}var rge=["Azimuthal_Equidistant","aeqd"];const ige={init:ege,forward:tge,inverse:nge,names:rge};function sge(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)}function age(n){var e,t,r,i,s,a,o,l,c=n.x,h=n.y;return r=mt(c-this.long0,this.over),e=Math.sin(h),t=Math.cos(h),i=Math.cos(r),a=this.sin_p14*e+this.cos_p14*t*i,s=1,(a>0||Math.abs(a)<=ct)&&(o=this.a*s*t*Math.sin(r),l=this.y0+this.a*s*(this.cos_p14*e-this.sin_p14*t*i)),n.x=o,n.y=l,n}function oge(n){var e,t,r,i,s,a,o;return n.x-=this.x0,n.y-=this.y0,e=Math.sqrt(n.x*n.x+n.y*n.y),t=Gu(e/this.a),r=Math.sin(t),i=Math.cos(t),a=this.long0,Math.abs(e)<=ct?(o=this.lat0,n.x=a,n.y=o,n):(o=Gu(i*this.sin_p14+n.y*r*this.cos_p14/e),s=Math.abs(this.lat0)-We,Math.abs(s)<=ct?(this.lat0>=0?a=mt(this.long0+Math.atan2(n.x,-n.y),this.over):a=mt(this.long0-Math.atan2(-n.x,n.y),this.over),n.x=a,n.y=o,n):(a=mt(this.long0+Math.atan2(n.x*r,e*this.cos_p14*i-n.y*this.sin_p14*r),this.over),n.x=a,n.y=o,n))}var lge=["ortho"];const cge={init:sge,forward:age,inverse:oge,names:lge};var Cr={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},Un={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function uge(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=We-zn/2?this.face=Cr.TOP:this.lat0<=-(We-zn/2)?this.face=Cr.BOTTOM:Math.abs(this.long0)<=zn?this.face=Cr.FRONT:Math.abs(this.long0)<=We+zn?this.face=this.long0>0?Cr.RIGHT:Cr.LEFT:this.face=Cr.BACK,this.es!==0&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)}function hge(n){var e={x:0,y:0},t,r,i,s,a,o,l={value:0};if(n.x-=this.long0,this.es!==0?t=Math.atan(this.one_minus_f_squared*Math.tan(n.y)):t=n.y,r=n.x,this.face===Cr.TOP)s=We-t,r>=zn&&r<=We+zn?(l.value=Un.AREA_0,i=r-We):r>We+zn||r<=-(We+zn)?(l.value=Un.AREA_1,i=r>0?r-Wr:r+Wr):r>-(We+zn)&&r<=-zn?(l.value=Un.AREA_2,i=r+We):(l.value=Un.AREA_3,i=r);else if(this.face===Cr.BOTTOM)s=We+t,r>=zn&&r<=We+zn?(l.value=Un.AREA_0,i=-r+We):r<zn&&r>=-zn?(l.value=Un.AREA_1,i=-r):r<-zn&&r>=-(We+zn)?(l.value=Un.AREA_2,i=-r-We):(l.value=Un.AREA_3,i=r>0?-r+Wr:-r-Wr);else{var c,h,f,m,y,x,_;this.face===Cr.RIGHT?r=S0(r,+We):this.face===Cr.BACK?r=S0(r,+Wr):this.face===Cr.LEFT&&(r=S0(r,-We)),m=Math.sin(t),y=Math.cos(t),x=Math.sin(r),_=Math.cos(r),c=y*_,h=y*x,f=m,this.face===Cr.FRONT?(s=Math.acos(c),i=$x(s,f,h,l)):this.face===Cr.RIGHT?(s=Math.acos(h),i=$x(s,f,-c,l)):this.face===Cr.BACK?(s=Math.acos(-c),i=$x(s,f,-h,l)):this.face===Cr.LEFT?(s=Math.acos(-h),i=$x(s,f,c,l)):(s=i=0,l.value=Un.AREA_0)}return o=Math.atan(12/Wr*(i+Math.acos(Math.sin(i)*Math.cos(zn))-We)),a=Math.sqrt((1-Math.cos(s))/(Math.cos(o)*Math.cos(o))/(1-Math.cos(Math.atan(1/Math.cos(i))))),l.value===Un.AREA_1?o+=We:l.value===Un.AREA_2?o+=Wr:l.value===Un.AREA_3&&(o+=1.5*Wr),e.x=a*Math.cos(o),e.y=a*Math.sin(o),e.x=e.x*this.a+this.x0,e.y=e.y*this.a+this.y0,n.x=e.x,n.y=e.y,n}function dge(n){var e={lam:0,phi:0},t,r,i,s,a,o,l,c,h,f={value:0};if(n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,r=Math.atan(Math.sqrt(n.x*n.x+n.y*n.y)),t=Math.atan2(n.y,n.x),n.x>=0&&n.x>=Math.abs(n.y)?f.value=Un.AREA_0:n.y>=0&&n.y>=Math.abs(n.x)?(f.value=Un.AREA_1,t-=We):n.x<0&&-n.x>=Math.abs(n.y)?(f.value=Un.AREA_2,t=t<0?t+Wr:t-Wr):(f.value=Un.AREA_3,t+=We),h=Wr/12*Math.tan(t),a=Math.sin(h)/(Math.cos(h)-1/Math.sqrt(2)),o=Math.atan(a),i=Math.cos(t),s=Math.tan(r),l=1-i*i*s*s*(1-Math.cos(Math.atan(1/Math.cos(o)))),l<-1?l=-1:l>1&&(l=1),this.face===Cr.TOP)c=Math.acos(l),e.phi=We-c,f.value===Un.AREA_0?e.lam=o+We:f.value===Un.AREA_1?e.lam=o<0?o+Wr:o-Wr:f.value===Un.AREA_2?e.lam=o-We:e.lam=o;else if(this.face===Cr.BOTTOM)c=Math.acos(l),e.phi=c-We,f.value===Un.AREA_0?e.lam=-o+We:f.value===Un.AREA_1?e.lam=-o:f.value===Un.AREA_2?e.lam=-o-We:e.lam=o<0?-o-Wr:-o+Wr;else{var m,y,x;m=l,h=m*m,h>=1?x=0:x=Math.sqrt(1-h)*Math.sin(o),h+=x*x,h>=1?y=0:y=Math.sqrt(1-h),f.value===Un.AREA_1?(h=y,y=-x,x=h):f.value===Un.AREA_2?(y=-y,x=-x):f.value===Un.AREA_3&&(h=y,y=x,x=-h),this.face===Cr.RIGHT?(h=m,m=-y,y=h):this.face===Cr.BACK?(m=-m,y=-y):this.face===Cr.LEFT&&(h=m,m=y,y=-h),e.phi=Math.acos(-x)-We,e.lam=Math.atan2(y,m),this.face===Cr.RIGHT?e.lam=S0(e.lam,-We):this.face===Cr.BACK?e.lam=S0(e.lam,-Wr):this.face===Cr.LEFT&&(e.lam=S0(e.lam,+We))}if(this.es!==0){var _,w,S;_=e.phi<0?1:0,w=Math.tan(e.phi),S=this.b/Math.sqrt(w*w+this.one_minus_f_squared),e.phi=Math.atan(Math.sqrt(this.a*this.a-S*S)/(this.one_minus_f*S)),_&&(e.phi=-e.phi)}return e.lam+=this.long0,n.x=e.lam,n.y=e.phi,n}function $x(n,e,t,r){var i;return n<ct?(r.value=Un.AREA_0,i=0):(i=Math.atan2(e,t),Math.abs(i)<=zn?r.value=Un.AREA_0:i>zn&&i<=We+zn?(r.value=Un.AREA_1,i-=We):i>We+zn||i<=-(We+zn)?(r.value=Un.AREA_2,i=i>=0?i-Wr:i+Wr):(r.value=Un.AREA_3,i+=We)),i}function S0(n,e){var t=n+e;return t<-Wr?t+=ry:t>+Wr&&(t-=ry),t}var fge=["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"];const gge={init:uge,forward:hge,inverse:dge,names:fge};var GR=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-986701e-12],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,18736e-12],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,934959e-12],[.7986,-.00755338,-500009e-10,935324e-12],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],Dm=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-126793e-14,422642e-15],[.124,.0124,507171e-14,-160604e-14],[.186,.0123999,-190189e-13,600152e-14],[.248,.0124002,710039e-13,-224e-10],[.31,.0123992,-264997e-12,835986e-13],[.372,.0124029,988983e-12,-311994e-12],[.434,.0123893,-369093e-11,-435621e-12],[.4958,.0123198,-102252e-10,-345523e-12],[.5571,.0121916,-154081e-10,-582288e-12],[.6176,.0119938,-241424e-10,-525327e-12],[.6769,.011713,-320223e-10,-516405e-12],[.7346,.0113541,-397684e-10,-609052e-12],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-140374e-14],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],KV=.8487,XV=1.3523,qV=Bs/5,mge=1/qV,d0=18,Kv=function(n,e){return n[0]+e*(n[1]+e*(n[2]+e*n[3]))},pge=function(n,e){return n[1]+e*(2*n[2]+e*3*n[3])};function yge(n,e,t,r){for(var i=e;r;--r){var s=n(i);if(i-=s,Math.abs(s)<t)break}return i}function xge(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"}function _ge(n){var e=mt(n.x-this.long0,this.over),t=Math.abs(n.y),r=Math.floor(t*qV);r<0?r=0:r>=d0&&(r=d0-1),t=Bs*(t-mge*r);var i={x:Kv(GR[r],t)*e,y:Kv(Dm[r],t)};return n.y<0&&(i.y=-i.y),i.x=i.x*this.a*KV+this.x0,i.y=i.y*this.a*XV+this.y0,i}function vge(n){var e={x:(n.x-this.x0)/(this.a*KV),y:Math.abs(n.y-this.y0)/(this.a*XV)};if(e.y>=1)e.x/=GR[d0][0],e.y=n.y<0?-We:We;else{var t=Math.floor(e.y*d0);for(t<0?t=0:t>=d0&&(t=d0-1);;)if(Dm[t][0]>e.y)--t;else if(Dm[t+1][0]<=e.y)++t;else break;var r=Dm[t],i=5*(e.y-r[0])/(Dm[t+1][0]-r[0]);i=yge(function(s){return(Kv(r,s)-e.y)/pge(r,s)},i,ct,100),e.x/=Kv(GR[t],i),e.y=(5*t+i)*Dr,n.y<0&&(e.y=-e.y)}return e.x=mt(e.x+this.long0,this.over),e}var wge=["Robinson","robin"];const Ege={init:xge,forward:_ge,inverse:vge,names:wge};function Tge(){this.name="geocent"}function Sge(n){var e=DV(n,this.es,this.a);return e}function bge(n){var e=FV(n,this.es,this.a,this.b);return e}var Rge=["Geocentric","geocentric","geocent","Geocent"];const Age={init:Tge,forward:Sge,inverse:bge,names:Rge};var as={N_POLE:0,S_POLE:1,EQUIT:2,OBLIQ:3},vm={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};function Ige(){if(Object.keys(vm).forEach((function(t){if(typeof this[t]>"u")this[t]=vm[t].def;else{if(vm[t].num&&isNaN(this[t]))throw new Error("Invalid parameter value, must be numeric "+t+" = "+this[t]);vm[t].num&&(this[t]=parseFloat(this[t]))}vm[t].degrees&&(this[t]=this[t]*Dr)}).bind(this)),Math.abs(Math.abs(this.lat0)-We)<ct?this.mode=this.lat0<0?as.S_POLE:as.N_POLE:Math.abs(this.lat0)<ct?this.mode=as.EQUIT:(this.mode=as.OBLIQ,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var n=this.tilt,e=this.azi;this.cg=Math.cos(e),this.sg=Math.sin(e),this.cw=Math.cos(n),this.sw=Math.sin(n)}function Cge(n){n.x-=this.long0;var e=Math.sin(n.y),t=Math.cos(n.y),r=Math.cos(n.x),i,s;switch(this.mode){case as.OBLIQ:s=this.sinph0*e+this.cosph0*t*r;break;case as.EQUIT:s=t*r;break;case as.S_POLE:s=-e;break;case as.N_POLE:s=e;break}switch(s=this.pn1/(this.p-s),i=s*t*Math.sin(n.x),this.mode){case as.OBLIQ:s*=this.cosph0*e-this.sinph0*t*r;break;case as.EQUIT:s*=e;break;case as.N_POLE:s*=-(t*r);break;case as.S_POLE:s*=t*r;break}var a,o;return a=s*this.cg+i*this.sg,o=1/(a*this.sw*this.h1+this.cw),i=(i*this.cg-s*this.sg)*this.cw*o,s=a*o,n.x=i*this.a,n.y=s*this.a,n}function kge(n){n.x/=this.a,n.y/=this.a;var e={x:n.x,y:n.y},t,r,i;i=1/(this.pn1-n.y*this.sw),t=this.pn1*n.x*i,r=this.pn1*n.y*this.cw*i,n.x=t*this.cg+r*this.sg,n.y=r*this.cg-t*this.sg;var s=Vs(n.x,n.y);if(Math.abs(s)<ct)e.x=0,e.y=n.y;else{var a,o;switch(o=1-s*s*this.pfact,o=(this.p-Math.sqrt(o))/(this.pn1/s+s/this.pn1),a=Math.sqrt(1-o*o),this.mode){case as.OBLIQ:e.y=Math.asin(a*this.sinph0+n.y*o*this.cosph0/s),n.y=(a-this.sinph0*Math.sin(e.y))*s,n.x*=o*this.cosph0;break;case as.EQUIT:e.y=Math.asin(n.y*o/s),n.y=a*s,n.x*=o;break;case as.N_POLE:e.y=Math.asin(a),n.y=-n.y;break;case as.S_POLE:e.y=-Math.asin(a);break}e.x=Math.atan2(n.x,n.y)}return n.x=e.x+this.long0,n.y=e.y,n}var Pge=["Tilted_Perspective","tpers"];const Mge={init:Ige,forward:Cge,inverse:kge,names:Pge};function Nge(){if(this.flip_axis=this.sweep==="x"?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,this.es!==0){var n=1-this.es,e=1/n;this.radius_p=Math.sqrt(n),this.radius_p2=n,this.radius_p_inv2=e,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")}function Lge(n){var e=n.x,t=n.y,r,i,s,a;if(e=e-this.long0,this.shape==="ellipse"){t=Math.atan(this.radius_p2*Math.tan(t));var o=this.radius_p/Vs(this.radius_p*Math.cos(t),Math.sin(t));if(i=o*Math.cos(e)*Math.cos(t),s=o*Math.sin(e)*Math.cos(t),a=o*Math.sin(t),(this.radius_g-i)*i-s*s-a*a*this.radius_p_inv2<0)return n.x=Number.NaN,n.y=Number.NaN,n;r=this.radius_g-i,this.flip_axis?(n.x=this.radius_g_1*Math.atan(s/Vs(a,r)),n.y=this.radius_g_1*Math.atan(a/r)):(n.x=this.radius_g_1*Math.atan(s/r),n.y=this.radius_g_1*Math.atan(a/Vs(s,r)))}else this.shape==="sphere"&&(r=Math.cos(t),i=Math.cos(e)*r,s=Math.sin(e)*r,a=Math.sin(t),r=this.radius_g-i,this.flip_axis?(n.x=this.radius_g_1*Math.atan(s/Vs(a,r)),n.y=this.radius_g_1*Math.atan(a/r)):(n.x=this.radius_g_1*Math.atan(s/r),n.y=this.radius_g_1*Math.atan(a/Vs(s,r))));return n.x=n.x*this.a,n.y=n.y*this.a,n}function Oge(n){var e=-1,t=0,r=0,i,s,a,o;if(n.x=n.x/this.a,n.y=n.y/this.a,this.shape==="ellipse"){this.flip_axis?(r=Math.tan(n.y/this.radius_g_1),t=Math.tan(n.x/this.radius_g_1)*Vs(1,r)):(t=Math.tan(n.x/this.radius_g_1),r=Math.tan(n.y/this.radius_g_1)*Vs(1,t));var l=r/this.radius_p;if(i=t*t+l*l+e*e,s=2*this.radius_g*e,a=s*s-4*i*this.C,a<0)return n.x=Number.NaN,n.y=Number.NaN,n;o=(-s-Math.sqrt(a))/(2*i),e=this.radius_g+o*e,t*=o,r*=o,n.x=Math.atan2(t,e),n.y=Math.atan(r*Math.cos(n.x)/e),n.y=Math.atan(this.radius_p_inv2*Math.tan(n.y))}else if(this.shape==="sphere"){if(this.flip_axis?(r=Math.tan(n.y/this.radius_g_1),t=Math.tan(n.x/this.radius_g_1)*Math.sqrt(1+r*r)):(t=Math.tan(n.x/this.radius_g_1),r=Math.tan(n.y/this.radius_g_1)*Math.sqrt(1+t*t)),i=t*t+r*r+e*e,s=2*this.radius_g*e,a=s*s-4*i*this.C,a<0)return n.x=Number.NaN,n.y=Number.NaN,n;o=(-s-Math.sqrt(a))/(2*i),e=this.radius_g+o*e,t*=o,r*=o,n.x=Math.atan2(t,e),n.y=Math.atan(r*Math.cos(n.x)/e)}return n.x=n.x+this.long0,n}var Dge=["Geostationary Satellite View","Geostationary_Satellite","geos"];const Fge={init:Nge,forward:Lge,inverse:Oge,names:Dge};var rp=1.340264,ip=-.081106,sp=893e-6,ap=.003796,Xv=Math.sqrt(3)/2;function jge(){this.es=0,this.long0=this.long0!==void 0?this.long0:0,this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0}function Vge(n){var e=mt(n.x-this.long0,this.over),t=n.y,r=Math.asin(Xv*Math.sin(t)),i=r*r,s=i*i*i;return n.x=e*Math.cos(r)/(Xv*(rp+3*ip*i+s*(7*sp+9*ap*i))),n.y=r*(rp+ip*i+s*(sp+ap*i)),n.x=this.a*n.x+this.x0,n.y=this.a*n.y+this.y0,n}function Gge(n){n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a;var e=1e-9,t=12,r=n.y,i,s,a,o,l,c;for(c=0;c<t&&(i=r*r,s=i*i*i,a=r*(rp+ip*i+s*(sp+ap*i))-n.y,o=rp+3*ip*i+s*(7*sp+9*ap*i),r-=l=a/o,!(Math.abs(l)<e));++c);return i=r*r,s=i*i*i,n.x=Xv*n.x*(rp+3*ip*i+s*(7*sp+9*ap*i))/Math.cos(r),n.y=Math.asin(Math.sin(r)/Xv),n.x=mt(n.x+this.long0,this.over),n}var Bge=["eqearth","Equal Earth","Equal_Earth"];const zge={init:jge,forward:Vge,inverse:Gge,names:Bge};var ay=1e-10;function Uge(){var n;if(this.phi1=this.lat1,Math.abs(this.phi1)<ay)throw new Error;this.es?(this.en=YC(this.es),this.m1=xg(this.phi1,this.am1=Math.sin(this.phi1),n=Math.cos(this.phi1),this.en),this.am1=n/(Math.sqrt(1-this.es*this.am1*this.am1)*this.am1),this.inverse=Wge,this.forward=$ge):(Math.abs(this.phi1)+ay>=We?this.cphi1=0:this.cphi1=1/Math.tan(this.phi1),this.inverse=Kge,this.forward=Hge)}function $ge(n){var e=mt(n.x-(this.long0||0),this.over),t=n.y,r,i,s;return r=this.am1+this.m1-xg(t,i=Math.sin(t),s=Math.cos(t),this.en),i=s*e/(r*Math.sqrt(1-this.es*i*i)),n.x=r*Math.sin(i),n.y=this.am1-r*Math.cos(i),n.x=this.a*n.x+(this.x0||0),n.y=this.a*n.y+(this.y0||0),n}function Wge(n){n.x=(n.x-(this.x0||0))/this.a,n.y=(n.y-(this.y0||0))/this.a;var e,t,r,i;if(t=Vs(n.x,n.y=this.am1-n.y),i=ZC(this.am1+this.m1-t,this.es,this.en),(e=Math.abs(i))<We)e=Math.sin(i),r=t*Math.atan2(n.x,n.y)*Math.sqrt(1-this.es*e*e)/Math.cos(i);else if(Math.abs(e-We)<=ay)r=0;else throw new Error;return n.x=mt(r+(this.long0||0),this.over),n.y=Yu(i),n}function Hge(n){var e=mt(n.x-(this.long0||0),this.over),t=n.y,r,i;return i=this.cphi1+this.phi1-t,Math.abs(i)>ay?(n.x=i*Math.sin(r=e*Math.cos(t)/i),n.y=this.cphi1-i*Math.cos(r)):n.x=n.y=0,n.x=this.a*n.x+(this.x0||0),n.y=this.a*n.y+(this.y0||0),n}function Kge(n){n.x=(n.x-(this.x0||0))/this.a,n.y=(n.y-(this.y0||0))/this.a;var e,t,r=Vs(n.x,n.y=this.cphi1-n.y);if(t=this.cphi1+this.phi1-r,Math.abs(t)>We)throw new Error;return Math.abs(Math.abs(t)-We)<=ay?e=0:e=r*Math.atan2(n.x,n.y)/Math.cos(t),n.x=mt(e+(this.long0||0),this.over),n.y=Yu(t),n}var Xge=["bonne","Bonne (Werner lat_1=90)"];const qge={init:Uge,names:Xge},y5={OBLIQUE:{forward:eme,inverse:nme},TRANSVERSE:{forward:tme,inverse:rme}},qv={ROTATE:{o_alpha:"oAlpha",o_lon_c:"oLongC",o_lat_c:"oLatC"},NEW_POLE:{o_lat_p:"oLatP",o_lon_p:"oLongP"},NEW_EQUATOR:{o_lon_1:"oLong1",o_lat_1:"oLat1",o_lon_2:"oLong2",o_lat_2:"oLat2"}};function Yge(){if(this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.title=this.title||"General Oblique Transformation",this.isIdentity=MV.includes(this.o_proj),!this.o_proj)throw new Error("Missing parameter: o_proj");if(this.o_proj==="ob_tran")throw new Error("Invalid value for o_proj: "+this.o_proj);const n=this.projStr.replace("+proj=ob_tran","").replace("+o_proj=","+proj=").trim(),e=Ua(n);if(!e)throw new Error("Invalid parameter: o_proj. Unknown projection "+this.o_proj);e.long0=0,this.obliqueProjection=e;let t;const r=Object.keys(qv),i=o=>{if(typeof this[o]>"u")return;const l=parseFloat(this[o])*Dr;if(isNaN(l))throw new Error("Invalid value for "+o+": "+this[o]);return l};for(let o=0;o<r.length;o++){const l=r[o],c=qv[l],h=Object.entries(c);if(h.some(([m])=>typeof this[m]<"u")){t=c;for(let m=0;m<h.length;m++){const[y,x]=h[m],_=i(y);if(typeof _>"u")throw new Error("Missing parameter: "+y+".");this[x]=_}break}}if(!t)throw new Error("No valid parameters provided for ob_tran projection.");const{lamp:s,phip:a}=Qge(this,t);this.lamp=s,Math.abs(a)>ct?(this.cphip=Math.cos(a),this.sphip=Math.sin(a),this.projectionType=y5.OBLIQUE):this.projectionType=y5.TRANSVERSE}function Zge(n){return this.projectionType.forward(this,n)}function Jge(n){return this.projectionType.inverse(this,n)}function Qge(n,e){let t,r;if(e===qv.ROTATE){let i=n.oLongC,s=n.oLatC,a=n.oAlpha;if(Math.abs(Math.abs(s)-We)<=ct)throw new Error("Invalid value for o_lat_c: "+n.o_lat_c+" should be < 90");r=i+Math.atan2(-1*Math.cos(a),-1*Math.sin(a)*Math.sin(s)),t=Math.asin(Math.cos(s)*Math.sin(a))}else if(e===qv.NEW_POLE)r=n.oLongP,t=n.oLatP;else{let i=n.oLong1,s=n.oLat1,a=n.oLong2,o=n.oLat2,l=Math.abs(s);if(Math.abs(s)>We-ct)throw new Error("Invalid value for o_lat_1: "+n.o_lat_1+" should be < 90");if(Math.abs(o)>We-ct)throw new Error("Invalid value for o_lat_2: "+n.o_lat_2+" should be < 90");if(Math.abs(s-o)<ct)throw new Error("Invalid value for o_lat_1 and o_lat_2: o_lat_1 should be different from o_lat_2");if(l<ct)throw new Error("Invalid value for o_lat_1: o_lat_1 should be different from zero");r=Math.atan2(Math.cos(s)*Math.sin(o)*Math.cos(i)-Math.sin(s)*Math.cos(o)*Math.cos(a),Math.sin(s)*Math.cos(o)*Math.sin(a)-Math.cos(s)*Math.sin(o)*Math.sin(i)),t=Math.atan(-1*Math.cos(r-i)/Math.tan(s))}return{lamp:r,phip:t}}function eme(n,e){let{x:t,y:r}=e;t+=n.long0;const i=Math.cos(t),s=Math.sin(r),a=Math.cos(r);e.x=mt(Math.atan2(a*Math.sin(t),n.sphip*a*i+n.cphip*s)+n.lamp),e.y=Math.asin(n.sphip*s-n.cphip*a*i);const o=n.obliqueProjection.forward(e);return n.isIdentity&&(o.x*=Bs,o.y*=Bs),o}function tme(n,e){let{x:t,y:r}=e;t+=n.long0;const i=Math.cos(r),s=Math.cos(t);e.x=mt(Math.atan2(i*Math.sin(t),Math.sin(r))+n.lamp),e.y=Math.asin(-1*i*s);const a=n.obliqueProjection.forward(e);return n.isIdentity&&(a.x*=Bs,a.y*=Bs),a}function nme(n,e){n.isIdentity&&(e.x*=Dr,e.y*=Dr);const t=n.obliqueProjection.inverse(e);let{x:r,y:i}=t;if(r<Number.MAX_VALUE){r-=n.lamp;const s=Math.cos(r),a=Math.sin(i),o=Math.cos(i);e.x=Math.atan2(o*Math.sin(r),n.sphip*o*s-n.cphip*a),e.y=Math.asin(n.sphip*a+n.cphip*o*s)}return e.x=mt(e.x+n.long0),e}function rme(n,e){n.isIdentity&&(e.x*=Dr,e.y*=Dr);const t=n.obliqueProjection.inverse(e);let{x:r,y:i}=t;if(r<Number.MAX_VALUE){const s=Math.cos(i);r-=n.lamp,e.x=Math.atan2(s*Math.sin(r),-1*Math.sin(i)),e.y=Math.asin(s*Math.cos(r))}return e.x=mt(e.x+n.long0),e}var ime=["General Oblique Transformation","General_Oblique_Transformation","ob_tran"];const sme={init:Yge,forward:Zge,inverse:Jge,names:ime};function ame(n){n.Proj.projections.add(R_),n.Proj.projections.add(A_),n.Proj.projections.add(Xde),n.Proj.projections.add(rfe),n.Proj.projections.add(lfe),n.Proj.projections.add(ffe),n.Proj.projections.add(_fe),n.Proj.projections.add(Sfe),n.Proj.projections.add(Cfe),n.Proj.projections.add(Lfe),n.Proj.projections.add(Kfe),n.Proj.projections.add(Qfe),n.Proj.projections.add(i0e),n.Proj.projections.add(u0e),n.Proj.projections.add(m0e),n.Proj.projections.add(v0e),n.Proj.projections.add(b0e),n.Proj.projections.add(k0e),n.Proj.projections.add(D0e),n.Proj.projections.add(B0e),n.Proj.projections.add(H0e),n.Proj.projections.add(Z0e),n.Proj.projections.add(ige),n.Proj.projections.add(cge),n.Proj.projections.add(gge),n.Proj.projections.add(Ege),n.Proj.projections.add(Age),n.Proj.projections.add(Mge),n.Proj.projections.add(Fge),n.Proj.projections.add(zge),n.Proj.projections.add(qge),n.Proj.projections.add(sme)}const Tn=Object.assign(hde,{defaultDatum:"WGS84",Proj:Ua,WGS84:new Ua("WGS84"),Point:ig,toPoint:jV,defs:Gi,nadgrid:Khe,transform:Wv,mgrs:dde,version:"__VERSION__"});ame(Tn);class YV{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=_r,this.supportedMediaTypes=null}getReadOptions(e,t){if(t){let r=t.dataProjection?ir(t.dataProjection):this.readProjection(e);t.extent&&r&&r.getUnits()==="tile-pixels"&&(r=ir(r),r.setWorldExtent(t.extent)),t={dataProjection:r,featureProjection:t.featureProjection}}return this.adaptOptions(t)}adaptOptions(e){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},e)}getType(){return Wt()}readFeature(e,t){return Wt()}readFeatures(e,t){return Wt()}readGeometry(e,t){return Wt()}readProjection(e){return Wt()}writeFeature(e,t){return Wt()}writeFeatures(e,t){return Wt()}writeGeometry(e,t){return Wt()}}function Ro(n,e,t){const r=t?ir(t.featureProjection):null,i=t?ir(t.dataProjection):null;let s=n;if(r&&i&&!qh(r,i)){e&&(s=n.clone());const a=e?r:i,o=e?i:r;a.getUnits()==="tile-pixels"?s.transform(a,o):s.applyTransform(vp(a,o))}if(e&&t&&t.decimals!==void 0){const a=Math.pow(10,t.decimals),o=function(l){for(let c=0,h=l.length;c<h;++c)l[c]=Math.round(l[c]*a)/a;return l};s===n&&(s=n.clone()),s.applyTransform(o)}return s}const ome={Point:gi,LineString:bi,Polygon:Ha,MultiPoint:kd,MultiLineString:ic,MultiPolygon:ad};function lme(n,e,t){return Array.isArray(e[0])?(pF(n,0,e,t)||(n=n.slice(),pb(n,0,e,t)),n):(SA(n,0,e,t)||(n=n.slice(),U_(n,0,e,t)),n)}function ZV(n,e){const t=n.geometry;if(!t)return[];if(Array.isArray(t))return t.map(s=>ZV({...n,geometry:s})).flat();const r=t.type==="MultiPolygon"?"Polygon":t.type;if(r==="GeometryCollection"||r==="Circle")throw new Error("Unsupported geometry type: "+r);const i=t.layout.length;return Ro(new Fs(r,r==="Polygon"?lme(t.flatCoordinates,t.ends,i):t.flatCoordinates,t.ends?.flat(),i,n.properties||{},n.id).enableSimplifyTransformed(),!1,e)}function rk(n,e){if(!n)return null;if(Array.isArray(n)){const r=n.map(i=>rk(i,e));return new _o(r)}const t=ome[n.type];return Ro(new t(n.flatCoordinates,n.layout||"XY",n.ends),!1,e)}class cme extends YV{constructor(){super()}getType(){return"json"}readFeature(e,t){return this.readFeatureFromObject(Wx(e),this.getReadOptions(e,t))}readFeatures(e,t){return this.readFeaturesFromObject(Wx(e),this.getReadOptions(e,t))}readFeatureFromObject(e,t){return Wt()}readFeaturesFromObject(e,t){return Wt()}readGeometry(e,t){return this.readGeometryFromObject(Wx(e),this.getReadOptions(e,t))}readGeometryFromObject(e,t){return Wt()}readProjection(e){return this.readProjectionFromObject(Wx(e))}readProjectionFromObject(e){return Wt()}writeFeature(e,t){return JSON.stringify(this.writeFeatureObject(e,t))}writeFeatureObject(e,t){return Wt()}writeFeatures(e,t){return JSON.stringify(this.writeFeaturesObject(e,t))}writeFeaturesObject(e,t){return Wt()}writeGeometry(e,t){return JSON.stringify(this.writeGeometryObject(e,t))}writeGeometryObject(e,t){return Wt()}}function Wx(n){if(typeof n=="string"){const e=JSON.parse(n);return e||null}return n!==null?n:null}class ik extends cme{constructor(e){e=e||{},super(),this.dataProjection=ir(e.dataProjection?e.dataProjection:"EPSG:4326"),e.featureProjection&&(this.defaultFeatureProjection=ir(e.featureProjection)),e.featureClass&&(this.featureClass=e.featureClass),this.geometryName_=e.geometryName,this.extractGeometryName_=e.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(e,t){let r=null;e.type==="Feature"?r=e:r={type:"Feature",geometry:e,properties:null};const i=sk(r.geometry);if(this.featureClass===Fs)return ZV({geometry:i,id:r.id,properties:r.properties},t);const s=new _r;return this.geometryName_?s.setGeometryName(this.geometryName_):this.extractGeometryName_&&r.geometry_name&&s.setGeometryName(r.geometry_name),s.setGeometry(rk(i,t)),"id"in r&&s.setId(r.id),r.properties&&s.setProperties(r.properties,!0),s}readFeaturesFromObject(e,t){const r=e;let i=null;if(r.type==="FeatureCollection"){const s=e;i=[];const a=s.features;for(let o=0,l=a.length;o<l;++o){const c=this.readFeatureFromObject(a[o],t);c&&i.push(c)}}else i=[this.readFeatureFromObject(e,t)];return i.flat()}readGeometryFromObject(e,t){return ume(e,t)}readProjectionFromObject(e){const t=e.crs;let r;if(t)if(t.type=="name")r=ir(t.properties.name);else if(t.type==="EPSG")r=ir("EPSG:"+t.properties.code);else throw new Error("Unknown SRS type");else r=this.dataProjection;return r}writeFeatureObject(e,t){t=this.adaptOptions(t);const r={type:"Feature",geometry:null,properties:null},i=e.getId();if(i!==void 0&&(r.id=i),!e.hasProperties())return r;const s=e.getProperties(),a=e.getGeometry();return a&&(r.geometry=BR(a,t),delete s[e.getGeometryName()]),nd(s)||(r.properties=s),r}writeFeaturesObject(e,t){t=this.adaptOptions(t);const r=[];for(let i=0,s=e.length;i<s;++i)r.push(this.writeFeatureObject(e[i],t));return{type:"FeatureCollection",features:r}}writeGeometryObject(e,t){return BR(e,this.adaptOptions(t))}}function sk(n,e){if(!n)return null;let t;switch(n.type){case"Point":{t=dme(n);break}case"LineString":{t=fme(n);break}case"Polygon":{t=yme(n);break}case"MultiPoint":{t=mme(n);break}case"MultiLineString":{t=gme(n);break}case"MultiPolygon":{t=pme(n);break}case"GeometryCollection":{t=hme(n);break}default:throw new Error("Unsupported GeoJSON type: "+n.type)}return t}function ume(n,e){const t=sk(n);return rk(t,e)}function hme(n,e){return n.geometries.map(function(r){return sk(r)})}function dme(n){const e=n.coordinates;return{type:"Point",flatCoordinates:e,layout:Cd(e.length)}}function fme(n){const e=n.coordinates,t=e.flat();return{type:"LineString",flatCoordinates:t,ends:[t.length],layout:Cd(e[0]?.length||2)}}function gme(n){const e=n.coordinates,t=e[0]?.[0]?.length||2,r=[],i=Ey(r,0,e,t);return{type:"MultiLineString",flatCoordinates:r,ends:i,layout:Cd(t)}}function mme(n){const e=n.coordinates;return{type:"MultiPoint",flatCoordinates:e.flat(),layout:Cd(e[0]?.length||2)}}function pme(n){const e=n.coordinates,t=[],r=e[0]?.[0]?.[0].length||2,i=HD(t,0,e,r);return{type:"MultiPolygon",flatCoordinates:t,ends:i,layout:Cd(r)}}function yme(n){const e=n.coordinates,t=[],r=e[0]?.[0]?.length,i=Ey(t,0,e,r);return{type:"Polygon",flatCoordinates:t,ends:i,layout:Cd(r)}}function BR(n,e){n=Ro(n,!0,e);const t=n.getType();let r;switch(t){case"Point":{r=Tme(n);break}case"LineString":{r=_me(n);break}case"Polygon":{r=Sme(n,e);break}case"MultiPoint":{r=wme(n);break}case"MultiLineString":{r=vme(n);break}case"MultiPolygon":{r=Eme(n,e);break}case"GeometryCollection":{r=xme(n,e);break}case"Circle":{r={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+t)}return r}function xme(n,e){return e=Object.assign({},e),delete e.featureProjection,{type:"GeometryCollection",geometries:n.getGeometriesArray().map(function(r){return BR(r,e)})}}function _me(n,e){return{type:"LineString",coordinates:n.getCoordinates()}}function vme(n,e){return{type:"MultiLineString",coordinates:n.getCoordinates()}}function wme(n,e){return{type:"MultiPoint",coordinates:n.getCoordinates()}}function Eme(n,e){let t;return e&&(t=e.rightHanded),{type:"MultiPolygon",coordinates:n.getCoordinates(t)}}function Tme(n,e){return{type:"Point",coordinates:n.getCoordinates()}}function Sme(n,e){let t;return e&&(t=e.rightHanded),{type:"Polygon",coordinates:n.getCoordinates(t)}}const Yv="http://www.w3.org/2001/XMLSchema-instance";function Fd(n,e){return _g().createElementNS(n,e)}function Ao(n,e){return JV(n,e,[]).join("")}function JV(n,e,t){if(n.nodeType==Node.CDATA_SECTION_NODE||n.nodeType==Node.TEXT_NODE)t.push(n.nodeValue);else{let r;for(r=n.firstChild;r;r=r.nextSibling)JV(r,e,t)}return t}function Hl(n){return"documentElement"in n}function Kl(n){return new DOMParser().parseFromString(n,"application/xml")}function x5(n,e){return(function(t,r){const i=n.call(e??this,t,r);if(i!==void 0){const s=r[r.length-1];Bn(s,i)}})}function go(n,e){return(function(t,r){const i=n.call(e??this,t,r);i!==void 0&&r[r.length-1].push(i)})}function ak(n,e){return(function(t,r){const i=n.call(this,t,r);i!==void 0&&(r[r.length-1]=i)})}function ze(n,e,t){return(function(r,i){const s=n.call(this,r,i);if(s!==void 0){const a=i[i.length-1],o=e!==void 0?e:r.localName;a[o]=s}})}function tt(n,e){return(function(t,r,i){n.call(this,t,r,i),i[i.length-1].node.appendChild(t)})}function QV(n,e){let t,r;return function(i,s,a){if(t===void 0){t={};const o={};o[i.localName]=n,t[i.namespaceURI]=o,r=Io(i.localName)}eG(t,r,s,a)}}function Io(n,e){return(function(t,r,i){const a=r[r.length-1].node;let o=n;o===void 0&&(o=i);const l=a.namespaceURI;return Fd(l,o)})}const ds=Io();function Hs(n,e){const t=e.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=n[e[i]];return r}function gt(n,e,t){t=t!==void 0?t:{};let r,i;for(r=0,i=n.length;r<i;++r)t[n[r]]=e;return t}function Zu(n,e,t,r){let i;for(i=e.firstElementChild;i;i=i.nextElementSibling){const s=n[i.namespaceURI];if(s!==void 0){const a=s[i.localName];a!==void 0&&a.call(r,i,t)}}}function _n(n,e,t,r,i){return r.push(n),Zu(e,t,r,i),r.pop()}function eG(n,e,t,r,i,s){const a=(i!==void 0?i:t).length;let o,l;for(let c=0;c<a;++c)o=t[c],o!==void 0&&(l=e.call(s,o,r,i!==void 0?i[c]:void 0),l!==void 0&&n[l.namespaceURI][l.localName].call(s,l,o,r))}function lr(n,e,t,r,i,s,a){return i.push(n),eG(e,t,r,i,s,a),i.pop()}let DS;function bme(){return DS===void 0&&typeof XMLSerializer<"u"&&(DS=new XMLSerializer),DS}let FS;function _g(){return FS===void 0&&typeof document<"u"&&(FS=document.implementation.createDocument("","",null)),FS}class tG extends YV{constructor(){super(),this.xmlSerializer_=bme()}getType(){return"xml"}readFeature(e,t){if(!e)return null;if(typeof e=="string"){const r=Kl(e);return this.readFeatureFromDocument(r,t)}return Hl(e)?this.readFeatureFromDocument(e,t):this.readFeatureFromNode(e,t)}readFeatureFromDocument(e,t){const r=this.readFeaturesFromDocument(e,t);return r.length>0?r[0]:null}readFeatureFromNode(e,t){return null}readFeatures(e,t){if(!e)return[];if(typeof e=="string"){const r=Kl(e);return this.readFeaturesFromDocument(r,t)}return Hl(e)?this.readFeaturesFromDocument(e,t):this.readFeaturesFromNode(e,t)}readFeaturesFromDocument(e,t){const r=[];for(let i=e.firstChild;i;i=i.nextSibling)i.nodeType==Node.ELEMENT_NODE&&Bn(r,this.readFeaturesFromNode(i,t));return r}readFeaturesFromNode(e,t){return Wt()}readGeometry(e,t){if(!e)return null;if(typeof e=="string"){const r=Kl(e);return this.readGeometryFromDocument(r,t)}return Hl(e)?this.readGeometryFromDocument(e,t):this.readGeometryFromNode(e,t)}readGeometryFromDocument(e,t){return null}readGeometryFromNode(e,t){return null}readProjection(e){if(!e)return null;if(typeof e=="string"){const t=Kl(e);return this.readProjectionFromDocument(t)}return Hl(e)?this.readProjectionFromDocument(e):this.readProjectionFromNode(e)}readProjectionFromDocument(e){return this.dataProjection}readProjectionFromNode(e){return this.dataProjection}writeFeature(e,t){const r=this.writeFeatureNode(e,t);return this.xmlSerializer_.serializeToString(r)}writeFeatureNode(e,t){return null}writeFeatures(e,t){const r=this.writeFeaturesNode(e,t);return this.xmlSerializer_.serializeToString(r)}writeFeaturesNode(e,t){return null}writeGeometry(e,t){const r=this.writeGeometryNode(e,t);return this.xmlSerializer_.serializeToString(r)}writeGeometryNode(e,t){return null}}function Bu(n){const e=Ao(n,!1);return Rme(e)}function Rme(n){const e=/^\s*(true|1)|(false|0)\s*$/.exec(n);if(e)return e[1]!==void 0||!1}function NE(n){const e=Ao(n,!1),t=Date.parse(e);return isNaN(t)?void 0:t/1e3}function Mn(n){const e=Ao(n,!1);return Ame(e)}function Ame(n){const e=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(n);if(e)return parseFloat(e[1])}function oy(n){const e=Ao(n,!1);return Ime(e)}function Ime(n){const e=/^\s*(\d+)\s*$/.exec(n);if(e)return parseInt(e[1],10)}function ln(n){return Ao(n,!1).trim()}function sg(n,e){Fn(n,e?"1":"0")}function Cme(n,e){n.appendChild(_g().createCDATASection(e))}function kme(n,e){const t=new Date(e*1e3),r=t.getUTCFullYear()+"-"+om(t.getUTCMonth()+1,2)+"-"+om(t.getUTCDate(),2)+"T"+om(t.getUTCHours(),2)+":"+om(t.getUTCMinutes(),2)+":"+om(t.getUTCSeconds(),2)+"Z";n.appendChild(_g().createTextNode(r))}function Ls(n,e){const t=e.toPrecision();n.appendChild(_g().createTextNode(t))}function Zv(n,e){const t=e.toString();n.appendChild(_g().createTextNode(t))}const Pme=/^\s/,Mme=/\s$/,Nme=/(\n|\t|\r|<|&| {2})/;function Fn(n,e){typeof e=="string"&&(Pme.test(e)||Mme.test(e)||Nme.test(e))?e.split("]]>").forEach((t,r,i)=>{r<i.length-1&&(t+="]]"),r>0&&(t=">"+t),Cme(n,t)}):n.appendChild(_g().createTextNode(e))}const fr=[null,"http://www.topografix.com/GPX/1/0","http://www.topografix.com/GPX/1/1"],Lme="http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd",Ome={rte:nG,trk:rG,wpt:iG},Dme=gt(fr,{rte:go(nG),trk:go(rG),wpt:go(iG)}),Fme=gt(fr,{text:ze(ln,"linkText"),type:ze(ln,"linkType")}),jme=gt(fr,{name:ze(ln),email:hpe,link:s1}),Vme=gt(fr,{name:ze(ln),desc:ze(ln),author:ze(lpe),copyright:ze(cpe),link:s1,time:ze(NE),keywords:ze(ln),bounds:upe,extensions:LE}),Gme=gt(fr,{year:ze(oy),license:ze(ln)}),Bme=gt(fr,{rte:tt(mpe),trk:tt(ppe),wpt:tt(xpe)});class zme extends tG{constructor(e){super(),e=e||{},this.dataProjection=ir("EPSG:4326"),this.readExtensions_=e.readExtensions}handleReadExtensions_(e){e||(e=[]);for(let t=0,r=e.length;t<r;++t){const i=e[t];if(this.readExtensions_){const s=i.get("extensionsNode_")||null;this.readExtensions_(i,s)}i.set("extensionsNode_",void 0)}}readMetadata(e){return e?typeof e=="string"?this.readMetadataFromDocument(Kl(e)):Hl(e)?this.readMetadataFromDocument(e):this.readMetadataFromNode(e):null}readMetadataFromDocument(e){for(let t=e.firstChild;t;t=t.nextSibling)if(t.nodeType===Node.ELEMENT_NODE){const r=this.readMetadataFromNode(t);if(r)return r}return null}readMetadataFromNode(e){if(!fr.includes(e.namespaceURI))return null;for(let t=e.firstElementChild;t;t=t.nextElementSibling)if(fr.includes(t.namespaceURI)&&t.localName==="metadata")return _n({},Vme,t,[]);return null}readFeatureFromNode(e,t){if(!fr.includes(e.namespaceURI))return null;const r=Ome[e.localName];if(!r)return null;const i=r(e,[this.getReadOptions(e,t)]);return i?(this.handleReadExtensions_([i]),i):null}readFeaturesFromNode(e,t){if(!fr.includes(e.namespaceURI))return[];if(e.localName=="gpx"){const r=_n([],Dme,e,[this.getReadOptions(e,t)]);return r?(this.handleReadExtensions_(r),r):[]}return[]}writeFeaturesNode(e,t){t=this.adaptOptions(t);const r=Fd("http://www.topografix.com/GPX/1/1","gpx");return r.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xsi",Yv),r.setAttributeNS(Yv,"xsi:schemaLocation",Lme),r.setAttribute("version","1.1"),r.setAttribute("creator","OpenLayers"),lr({node:r},Bme,ope,e,[t]),r}}const Ume=gt(fr,{name:ze(ln),cmt:ze(ln),desc:ze(ln),src:ze(ln),link:s1,number:ze(oy),extensions:LE,type:ze(ln),rtept:dpe}),$me=gt(fr,{ele:ze(Mn),time:ze(NE)}),Wme=gt(fr,{name:ze(ln),cmt:ze(ln),desc:ze(ln),src:ze(ln),link:s1,number:ze(oy),type:ze(ln),extensions:LE,trkseg:gpe}),Hme=gt(fr,{trkpt:fpe}),Kme=gt(fr,{ele:ze(Mn),time:ze(NE)}),Xme=gt(fr,{ele:ze(Mn),time:ze(NE),magvar:ze(Mn),geoidheight:ze(Mn),name:ze(ln),cmt:ze(ln),desc:ze(ln),src:ze(ln),link:s1,sym:ze(ln),type:ze(ln),fix:ze(ln),sat:ze(oy),hdop:ze(Mn),vdop:ze(Mn),pdop:ze(Mn),ageofdgpsdata:ze(Mn),dgpsid:ze(oy),extensions:LE}),qme=["text","type"],Yme=gt(fr,{text:tt(Fn),type:tt(Fn)}),Zme=gt(fr,["name","cmt","desc","src","link","number","type","rtept"]),Jme=gt(fr,{name:tt(Fn),cmt:tt(Fn),desc:tt(Fn),src:tt(Fn),link:tt(ck),number:tt(Zv),type:tt(Fn),rtept:QV(tt(uk))}),Qme=gt(fr,["ele","time"]),epe=gt(fr,["name","cmt","desc","src","link","number","type","trkseg"]),tpe=gt(fr,{name:tt(Fn),cmt:tt(Fn),desc:tt(Fn),src:tt(Fn),link:tt(ck),number:tt(Zv),type:tt(Fn),trkseg:QV(tt(ype))}),npe=Io("trkpt"),rpe=gt(fr,{trkpt:tt(uk)}),ipe=gt(fr,["ele","time","magvar","geoidheight","name","cmt","desc","src","link","sym","type","fix","sat","hdop","vdop","pdop","ageofdgpsdata","dgpsid"]),spe=gt(fr,{ele:tt(Ls),time:tt(kme),magvar:tt(Ls),geoidheight:tt(Ls),name:tt(Fn),cmt:tt(Fn),desc:tt(Fn),src:tt(Fn),link:tt(ck),sym:tt(Fn),type:tt(Fn),fix:tt(Fn),sat:tt(Zv),hdop:tt(Ls),vdop:tt(Ls),pdop:tt(Ls),ageofdgpsdata:tt(Ls),dgpsid:tt(Zv)}),ape={Point:"wpt",LineString:"rte",MultiLineString:"trk"};function ope(n,e,t){const r=n.getGeometry();if(r){const i=ape[r.getType()];if(i){const s=e[e.length-1].node;return Fd(s.namespaceURI,i)}}}function ok(n,e,t,r){return n.push(parseFloat(t.getAttribute("lon")),parseFloat(t.getAttribute("lat"))),"ele"in r?(n.push(r.ele),delete r.ele,e.hasZ=!0):n.push(0),"time"in r?(n.push(r.time),delete r.time,e.hasM=!0):n.push(0),n}function lk(n,e,t){let r="XY",i=2;if(n.hasZ&&n.hasM?(r="XYZM",i=4):n.hasZ?(r="XYZ",i=3):n.hasM&&(r="XYM",i=3),i!==4){for(let s=0,a=e.length/4;s<a;s++)e[s*i]=e[s*4],e[s*i+1]=e[s*4+1],n.hasZ&&(e[s*i+2]=e[s*4+2]),n.hasM&&(e[s*i+2]=e[s*4+3]);if(e.length=e.length/4*i,t)for(let s=0,a=t.length;s<a;s++)t[s]=t[s]/4*i}return r}function lpe(n,e){const t=_n({},jme,n,e);if(t)return t}function cpe(n,e){const t=_n({},Gme,n,e);if(t){const r=n.getAttribute("author");return r!==null&&(t.author=r),t}}function upe(n,e){const t=e[e.length-1],r=n.getAttribute("minlat"),i=n.getAttribute("minlon"),s=n.getAttribute("maxlat"),a=n.getAttribute("maxlon");i!==null&&r!==null&&a!==null&&s!==null&&(t.bounds=[[parseFloat(i),parseFloat(r)],[parseFloat(a),parseFloat(s)]])}function hpe(n,e){const t=e[e.length-1],r=n.getAttribute("id"),i=n.getAttribute("domain");r!==null&&i!==null&&(t.email=`${r}@${i}`)}function s1(n,e){const t=e[e.length-1],r=n.getAttribute("href");r!==null&&(t.link=r),Zu(Fme,n,e)}function LE(n,e){const t=e[e.length-1];t.extensionsNode_=n}function dpe(n,e){const t=_n({},$me,n,e);if(t){const r=e[e.length-1],i=r.flatCoordinates,s=r.layoutOptions;ok(i,s,n,t)}}function fpe(n,e){const t=_n({},Kme,n,e);if(t){const r=e[e.length-1],i=r.flatCoordinates,s=r.layoutOptions;ok(i,s,n,t)}}function gpe(n,e){const t=e[e.length-1];Zu(Hme,n,e);const r=t.flatCoordinates;t.ends.push(r.length)}function nG(n,e){const t=e[0],r=_n({flatCoordinates:[],layoutOptions:{}},Ume,n,e);if(!r)return;const i=r.flatCoordinates;delete r.flatCoordinates;const s=r.layoutOptions;delete r.layoutOptions;const a=lk(s,i),o=new bi(i,a);Ro(o,!1,t);const l=new _r(o);return l.setProperties(r,!0),l}function rG(n,e){const t=e[0],r=_n({flatCoordinates:[],ends:[],layoutOptions:{}},Wme,n,e);if(!r)return;const i=r.flatCoordinates;delete r.flatCoordinates;const s=r.ends;delete r.ends;const a=r.layoutOptions;delete r.layoutOptions;const o=lk(a,i,s),l=new ic(i,o,s);Ro(l,!1,t);const c=new _r(l);return c.setProperties(r,!0),c}function iG(n,e){const t=e[0],r=_n({},Xme,n,e);if(!r)return;const i={},s=ok([],i,n,r),a=lk(i,s),o=new gi(s,a);Ro(o,!1,t);const l=new _r(o);return l.setProperties(r,!0),l}function ck(n,e,t){n.setAttribute("href",e);const i=t[t.length-1].properties,s=[i.linkText,i.linkType];lr({node:n},Yme,ds,s,t,qme)}function uk(n,e,t){const r=t[t.length-1],s=r.node.namespaceURI,a=r.properties;switch(n.setAttributeNS(null,"lat",String(e[1])),n.setAttributeNS(null,"lon",String(e[0])),r.geometryLayout){case"XYZM":e[3]!==0&&(a.time=e[3]);case"XYZ":e[2]!==0&&(a.ele=e[2]);break;case"XYM":e[2]!==0&&(a.time=e[2]);break}const l=n.nodeName=="rtept"?Qme[s]:ipe[s],c=Hs(a,l);lr({node:n,properties:a},spe,ds,c,t,l)}function mpe(n,e,t){const r=t[0],i=e.getProperties(),s={node:n};s.properties=i;const a=e.getGeometry();if(a.getType()=="LineString"){const h=Ro(a,!0,r);s.geometryLayout=h.getLayout(),i.rtept=h.getCoordinates()}const o=t[t.length-1].node,l=Zme[o.namespaceURI],c=Hs(i,l);lr(s,Jme,ds,c,t,l)}function ppe(n,e,t){const r=t[0],i=e.getProperties(),s={node:n};s.properties=i;const a=e.getGeometry();if(a.getType()=="MultiLineString"){const h=Ro(a,!0,r);i.trkseg=h.getLineStrings()}const o=t[t.length-1].node,l=epe[o.namespaceURI],c=Hs(i,l);lr(s,tpe,ds,c,t,l)}function ype(n,e,t){const r={node:n};r.geometryLayout=e.getLayout(),r.properties={},lr(r,rpe,npe,e.getCoordinates(),t)}function xpe(n,e,t){const r=t[0],i=t[t.length-1];i.properties=e.getProperties();const s=e.getGeometry();if(s.getType()=="Point"){const a=Ro(s,!0,r);i.geometryLayout=a.getLayout(),uk(n,a.getCoordinates(),t)}}const vc=["http://www.google.com/kml/ext/2.2"],Pt=[null,"http://earth.google.com/kml/2.0","http://earth.google.com/kml/2.1","http://earth.google.com/kml/2.2","http://www.opengis.net/kml/2.2"],_pe="http://www.opengis.net/kml/2.2 https://developers.google.com/kml/schema/kml22gx.xsd",_5={fraction:"fraction",pixels:"pixels",insetPixels:"pixels"},vpe=gt(Pt,{ExtendedData:_G,Region:vG,MultiGeometry:ze(pG,"geometry"),LineString:ze(gG,"geometry"),LinearRing:ze(mG,"geometry"),Point:ze(yG,"geometry"),Polygon:ze(xG,"geometry"),Style:ze(fk),StyleMap:rye,address:ze(ln),description:ze(ln),name:ze(ln),open:ze(Bu),phoneNumber:ze(ln),styleUrl:ze(cG),visibility:ze(Bu)},gt(vc,{MultiTrack:ze($pe,"geometry"),Track:ze(fG,"geometry")})),wpe=gt(Pt,{ExtendedData:_G,Region:vG,Link:mye,address:ze(ln),description:ze(ln),name:ze(ln),open:ze(Bu),phoneNumber:ze(ln),visibility:ze(Bu)}),Epe=gt(Pt,{href:ze(lG)}),Tpe=gt(Pt,{Altitude:ze(Mn),Longitude:ze(Mn),Latitude:ze(Mn),Tilt:ze(Mn),AltitudeMode:ze(ln),Heading:ze(Mn),Roll:ze(Mn)}),sG=gt(Pt,{LatLonAltBox:lye,Lod:uye}),Spe=gt(Pt,["Document","Placemark"]),bpe=gt(Pt,{Document:tt(Tye),Placemark:tt(TG)});let b0,C_=null,zR,op,lp,cp,Jv,UR=null,hk,$R=null,WR,Hh=null,v5=null,HR=null;function Qv(n){return 32/Math.min(n[0],n[1])}function Rpe(){b0=[255,255,255,1],C_=new rr({color:b0}),zR=[20,2],op="pixels",lp="pixels",cp=[64,64],Jv="https://maps.google.com/mapfiles/kml/pushpin/ylw-pushpin.png",UR=new by({anchor:zR,anchorOrigin:"bottom-left",anchorXUnits:op,anchorYUnits:lp,crossOrigin:"anonymous",rotation:0,scale:Qv(cp),size:cp,src:Jv}),hk="NO_IMAGE",$R=new Yn({color:b0,width:1}),WR=new Yn({color:[51,51,51,1],width:2}),Hh=new vo({font:"bold 16px Helvetica",fill:C_,stroke:WR,scale:.8}),v5=new mn({fill:C_,image:UR,text:Hh,stroke:$R,zIndex:0}),HR=[v5]}let Hx;function Ape(n){return n}class Ipe extends tG{constructor(e){super(),e=e||{},HR||Rpe(),this.dataProjection=ir("EPSG:4326"),this.defaultStyle_=e.defaultStyle?e.defaultStyle:HR,this.extractStyles_=e.extractStyles!==void 0?e.extractStyles:!0,this.writeStyles_=e.writeStyles!==void 0?e.writeStyles:!0,this.sharedStyles_={},this.showPointNames_=e.showPointNames!==void 0?e.showPointNames:!0,this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",this.iconUrlFunction_=e.iconUrlFunction?e.iconUrlFunction:Ape,this.supportedMediaTypes=["application/vnd.google-earth.kml+xml"]}readDocumentOrFolder_(e,t){const r=gt(Pt,{Document:x5(this.readDocumentOrFolder_,this),Folder:x5(this.readDocumentOrFolder_,this),Placemark:go(this.readPlacemark_,this),Style:this.readSharedStyle_.bind(this),StyleMap:this.readSharedStyleMap_.bind(this)}),i=_n([],r,e,t,this);if(i)return i}readPlacemark_(e,t){const r=_n({geometry:null},vpe,e,t,this);if(!r)return;const i=new _r,s=e.getAttribute("id");s!==null&&i.setId(s);const a=t[0],o=r.geometry;if(o&&Ro(o,!1,a),i.setGeometry(o),delete r.geometry,this.extractStyles_){const l=r.Style,c=r.styleUrl,h=kpe(l,c,this.defaultStyle_,this.sharedStyles_,this.showPointNames_);i.setStyle(h)}return delete r.Style,i.setProperties(r,!0),i}readSharedStyle_(e,t){const r=e.getAttribute("id");if(r!==null){const i=fk.call(this,e,t);if(i){let s,a=e.baseURI;(!a||a=="about:blank")&&(a=window.location.href),a?s=new URL("#"+r,a).href:s="#"+r,this.sharedStyles_[s]=i}}}readSharedStyleMap_(e,t){const r=e.getAttribute("id");if(r===null)return;const i=hG.call(this,e,t);if(!i)return;let s,a=e.baseURI;(!a||a=="about:blank")&&(a=window.location.href),a?s=new URL("#"+r,a).href:s="#"+r,this.sharedStyles_[s]=i}readFeatureFromNode(e,t){if(!Pt.includes(e.namespaceURI))return null;const r=this.readPlacemark_(e,[this.getReadOptions(e,t)]);return r||null}readFeaturesFromNode(e,t){if(!Pt.includes(e.namespaceURI))return[];let r;const i=e.localName;if(i=="Document"||i=="Folder")return r=this.readDocumentOrFolder_(e,[this.getReadOptions(e,t)]),r||[];if(i=="Placemark"){const s=this.readPlacemark_(e,[this.getReadOptions(e,t)]);return s?[s]:[]}if(i=="kml"){r=[];for(let s=e.firstElementChild;s;s=s.nextElementSibling){const a=this.readFeaturesFromNode(s,t);a&&Bn(r,a)}return r}return[]}readName(e){if(e){if(typeof e=="string"){const t=Kl(e);return this.readNameFromDocument(t)}return Hl(e)?this.readNameFromDocument(e):this.readNameFromNode(e)}}readNameFromDocument(e){for(let t=e.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE){const r=this.readNameFromNode(t);if(r)return r}}readNameFromNode(e){for(let t=e.firstElementChild;t;t=t.nextElementSibling)if(Pt.includes(t.namespaceURI)&&t.localName=="name")return ln(t);for(let t=e.firstElementChild;t;t=t.nextElementSibling){const r=t.localName;if(Pt.includes(t.namespaceURI)&&(r=="Document"||r=="Folder"||r=="Placemark"||r=="kml")){const i=this.readNameFromNode(t);if(i)return i}}}readNetworkLinks(e){const t=[];if(typeof e=="string"){const r=Kl(e);Bn(t,this.readNetworkLinksFromDocument(r))}else Hl(e)?Bn(t,this.readNetworkLinksFromDocument(e)):Bn(t,this.readNetworkLinksFromNode(e));return t}readNetworkLinksFromDocument(e){const t=[];for(let r=e.firstChild;r;r=r.nextSibling)r.nodeType==Node.ELEMENT_NODE&&Bn(t,this.readNetworkLinksFromNode(r));return t}readNetworkLinksFromNode(e){const t=[];for(let r=e.firstElementChild;r;r=r.nextElementSibling)if(Pt.includes(r.namespaceURI)&&r.localName=="NetworkLink"){const i=_n({},wpe,r,[]);t.push(i)}for(let r=e.firstElementChild;r;r=r.nextElementSibling){const i=r.localName;Pt.includes(r.namespaceURI)&&(i=="Document"||i=="Folder"||i=="kml")&&Bn(t,this.readNetworkLinksFromNode(r))}return t}readRegion(e){const t=[];if(typeof e=="string"){const r=Kl(e);Bn(t,this.readRegionFromDocument(r))}else Hl(e)?Bn(t,this.readRegionFromDocument(e)):Bn(t,this.readRegionFromNode(e));return t}readRegionFromDocument(e){const t=[];for(let r=e.firstChild;r;r=r.nextSibling)r.nodeType==Node.ELEMENT_NODE&&Bn(t,this.readRegionFromNode(r));return t}readRegionFromNode(e){const t=[];for(let r=e.firstElementChild;r;r=r.nextElementSibling)if(Pt.includes(r.namespaceURI)&&r.localName=="Region"){const i=_n({},sG,r,[]);t.push(i)}for(let r=e.firstElementChild;r;r=r.nextElementSibling){const i=r.localName;Pt.includes(r.namespaceURI)&&(i=="Document"||i=="Folder"||i=="kml")&&Bn(t,this.readRegionFromNode(r))}return t}readCamera(e){const t=[];if(typeof e=="string"){const r=Kl(e);Bn(t,this.readCameraFromDocument(r))}else Hl(e)?Bn(t,this.readCameraFromDocument(e)):Bn(t,this.readCameraFromNode(e));return t}readCameraFromDocument(e){const t=[];for(let r=e.firstChild;r;r=r.nextSibling)r.nodeType===Node.ELEMENT_NODE&&Bn(t,this.readCameraFromNode(r));return t}readCameraFromNode(e){const t=[];for(let r=e.firstElementChild;r;r=r.nextElementSibling)if(Pt.includes(r.namespaceURI)&&r.localName==="Camera"){const i=_n({},Tpe,r,[]);t.push(i)}for(let r=e.firstElementChild;r;r=r.nextElementSibling){const i=r.localName;Pt.includes(r.namespaceURI)&&(i==="Document"||i==="Folder"||i==="Placemark"||i==="kml")&&Bn(t,this.readCameraFromNode(r))}return t}writeFeaturesNode(e,t){t=this.adaptOptions(t);const r=Fd(Pt[4],"kml"),i="http://www.w3.org/2000/xmlns/";r.setAttributeNS(i,"xmlns:gx",vc[0]),r.setAttributeNS(i,"xmlns:xsi",Yv),r.setAttributeNS(Yv,"xsi:schemaLocation",_pe);const s={node:r},a={};e.length>1?a.Document=e:e.length==1&&(a.Placemark=e[0]);const o=Spe[r.namespaceURI],l=Hs(a,o);return lr(s,bpe,ds,l,[t],o,this),r}}function Cpe(n,e){const t=[0,0];let r="start";const i=n.getImage();if(i){const o=i.getSize();if(o&&o.length==2){const l=i.getScaleArray(),c=i.getAnchor();t[0]=l[0]*(o[0]-c[0]),t[1]=l[1]*(o[1]/2-c[1]),r="left"}}let s=n.getText();return s?(s=s.clone(),s.setFont(s.getFont()||Hh.getFont()),s.setScale(s.getScale()||Hh.getScale()),s.setFill(s.getFill()||Hh.getFill()),s.setStroke(s.getStroke()||WR)):s=Hh.clone(),s.setText(e),s.setOffsetX(t[0]),s.setOffsetY(t[1]),s.setTextAlign(r),new mn({image:i,text:s})}function kpe(n,e,t,r,i){return(function(s,a){let o=i,l="",c=[];if(o){const f=s.getGeometry();if(f)if(f instanceof _o)c=f.getGeometriesArrayRecursive().filter(function(m){const y=m.getType();return y==="Point"||y==="MultiPoint"}),o=c.length>0;else{const m=f.getType();o=m==="Point"||m==="MultiPoint"}}o&&(l=s.get("name"),o=o&&!!l,o&&/&[^&]+;/.test(l)&&(Hx||(Hx=document.createElement("textarea")),Hx.innerHTML=l,l=Hx.value));let h=t;if(n?h=n:e&&(h=aG(e,t,r)),o){const f=Cpe(h[0],l);if(c.length>0){f.setGeometry(new _o(c));const m=new mn({geometry:h[0].getGeometry(),image:null,fill:h[0].getFill(),stroke:h[0].getStroke(),text:null});return[f,m].concat(h.slice(1))}return f}return h})}function aG(n,e,t){return Array.isArray(n)?n:typeof n=="string"?aG(t[n],e,t):e}function OE(n){const e=Ao(n,!1),t=/^\s*#?\s*([0-9A-Fa-f]{8})\s*$/.exec(e);if(t){const r=t[1];return[parseInt(r.substr(6,2),16),parseInt(r.substr(4,2),16),parseInt(r.substr(2,2),16),parseInt(r.substr(0,2),16)/255]}}function oG(n){let e=Ao(n,!1);const t=[];e=e.replace(/\s*,\s*/g,",");const r=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?),([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s+|,|$)(?:([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s+|$))?\s*/i;let i;for(;i=r.exec(e);){const s=parseFloat(i[1]),a=parseFloat(i[2]),o=i[3]?parseFloat(i[3]):0;t.push(s,a,o),e=e.substr(i[0].length)}if(e==="")return t}function lG(n){const e=Ao(n,!1).trim();let t=n.baseURI;return(!t||t=="about:blank")&&(t=window.location.href),t?new URL(e,t).href:e}function cG(n){const e=Ao(n,!1).trim().replace(/^(?!.*#)/,"#");let t=n.baseURI;return(!t||t=="about:blank")&&(t=window.location.href),t?new URL(e,t).href:e}function Ppe(n){const e=n.getAttribute("xunits"),t=n.getAttribute("yunits");let r;return e!=="insetPixels"?t!=="insetPixels"?r="bottom-left":r="top-left":t!=="insetPixels"?r="bottom-right":r="top-right",{x:parseFloat(n.getAttribute("x")),xunits:_5[e],y:parseFloat(n.getAttribute("y")),yunits:_5[t],origin:r}}function uG(n){return Mn(n)}const Mpe=gt(Pt,{Pair:nye});function hG(n,e){return _n(void 0,Mpe,n,e,this)}const Npe=gt(Pt,{Icon:ze(Kpe),color:ze(OE),heading:ze(Mn),hotSpot:ze(Ppe),scale:ze(uG)});function Lpe(n,e){const t=_n({},Npe,n,e);if(!t)return;const r=e[e.length-1],i="Icon"in t?t.Icon:{},s=!("Icon"in t)||Object.keys(i).length>0;let a;const o=i.href;o?a=o:s&&(a=Jv);let l,c,h,f="bottom-left";const m=t.hotSpot;m?(l=[m.x,m.y],c=m.xunits,h=m.yunits,f=m.origin):/^https?:\/\/maps\.(?:google|gstatic)\.com\//.test(a)&&(a.includes("pushpin")?(l=zR,c=op,h=lp):a.includes("arrow-reverse")?(l=[54,42],c=op,h=lp):a.includes("paddle")&&(l=[32,1],c=op,h=lp));let y;const x=i.x,_=i.y;x!==void 0&&_!==void 0&&(y=[x,_]);let w;const S=i.w,b=i.h;S!==void 0&&b!==void 0&&(w=[S,b]);let R;const M=t.heading;M!==void 0&&(R=ql(M));const O=t.scale,G=t.color;if(s){a==Jv&&(w=cp);const A=new by({anchor:l,anchorOrigin:f,anchorXUnits:c,anchorYUnits:h,crossOrigin:this.crossOrigin_,offset:y,offsetOrigin:"bottom-left",rotation:R,scale:O,size:w,src:this.iconUrlFunction_(a),color:G}),I=A.getScaleArray()[0],P=A.getSize();if(P===null){const D=A.getImageState();if(D===bt.IDLE||D===bt.LOADING){const L=function(){const U=A.getImageState();if(!(U===bt.IDLE||U===bt.LOADING)){const j=A.getSize();if(j&&j.length==2){const Ee=Qv(j);A.setScale(I*Ee)}A.unlistenImageChange(L)}};A.listenImageChange(L),D===bt.IDLE&&A.load()}}else if(P.length==2){const D=Qv(P);A.setScale(I*D)}r.imageStyle=A}else r.imageStyle=hk}const Ope=gt(Pt,{color:ze(OE),scale:ze(uG)});function Dpe(n,e){const t=_n({},Ope,n,e);if(!t)return;const r=e[e.length-1],i=new vo({fill:new rr({color:"color"in t?t.color:b0}),scale:t.scale});r.textStyle=i}const Fpe=gt(Pt,{color:ze(OE),width:ze(Mn)});function jpe(n,e){const t=_n({},Fpe,n,e);if(!t)return;const r=e[e.length-1],i=new Yn({color:"color"in t?t.color:b0,width:"width"in t?t.width:1});r.strokeStyle=i}const Vpe=gt(Pt,{color:ze(OE),fill:ze(Bu),outline:ze(Bu)});function Gpe(n,e){const t=_n({},Vpe,n,e);if(!t)return;const r=e[e.length-1],i=new rr({color:"color"in t?t.color:b0});r.fillStyle=i;const s=t.fill;s!==void 0&&(r.fill=s);const a=t.outline;a!==void 0&&(r.outline=a)}const Bpe=gt(Pt,{coordinates:ak(oG)});function dG(n,e){return _n(null,Bpe,n,e)}function zpe(n,e){const r=e[e.length-1].coordinates,i=Ao(n,!1),a=/^\s*([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s*$/i.exec(i);if(a){const o=parseFloat(a[1]),l=parseFloat(a[2]),c=parseFloat(a[3]);r.push([o,l,c])}else r.push([])}const Upe=gt(vc,{Track:go(fG)});function $pe(n,e){const t=_n([],Upe,n,e);if(t)return new ic(t)}const Wpe=gt(Pt,{when:pye},gt(vc,{coord:zpe}));function fG(n,e){const t=_n({coordinates:[],whens:[]},Wpe,n,e);if(!t)return;const r=[],i=t.coordinates,s=t.whens;for(let a=0,o=Math.min(i.length,s.length);a<o;++a)i[a].length==3&&r.push(i[a][0],i[a][1],i[a][2],s[a]);return new bi(r,"XYZM")}const Hpe=gt(Pt,{href:ze(lG)},gt(vc,{x:ze(Mn),y:ze(Mn),w:ze(Mn),h:ze(Mn)}));function Kpe(n,e){const t=_n({},Hpe,n,e);return t||null}const Xpe=gt(Pt,{coordinates:ak(oG)});function dk(n,e){return _n(null,Xpe,n,e)}const DE=gt(Pt,{extrude:ze(Bu),tessellate:ze(Bu),altitudeMode:ze(ln)});function gG(n,e){const t=_n({},DE,n,e),r=dk(n,e);if(r){const i=new bi(r,"XYZ");return i.setProperties(t,!0),i}}function mG(n,e){const t=_n({},DE,n,e),r=dk(n,e);if(r){const i=new Ha(r,"XYZ",[r.length]);return i.setProperties(t,!0),i}}const qpe=gt(Pt,{LineString:go(gG),LinearRing:go(mG),MultiGeometry:go(pG),Point:go(yG),Polygon:go(xG)});function pG(n,e){const t=_n([],qpe,n,e);if(!t)return null;if(t.length===0)return new _o(t);let r,i=!0;const s=t[0].getType();let a;for(let o=1,l=t.length;o<l;++o)if(a=t[o],a.getType()!=s){i=!1;break}if(i){let o,l;if(s=="Point"){const c=t[0];o=c.getLayout(),l=c.getFlatCoordinates();for(let h=1,f=t.length;h<f;++h)a=t[h],Bn(l,a.getFlatCoordinates());r=new kd(l,o),jS(r,t)}else if(s=="LineString")r=new ic(t),jS(r,t);else if(s=="Polygon")r=new ad(t),jS(r,t);else if(s=="GeometryCollection"||s.startsWith("Multi"))r=new _o(t);else throw new Error("Unknown geometry type found")}else r=new _o(t);return r}function yG(n,e){const t=_n({},DE,n,e),r=dk(n,e);if(r){const i=new gi(r,"XYZ");return i.setProperties(t,!0),i}}const Ype=gt(Pt,{innerBoundaryIs:dye,outerBoundaryIs:gye});function xG(n,e){const t=_n({},DE,n,e),r=_n([null],Ype,n,e);if(r&&r[0]){const i=r[0],s=[i.length];for(let o=1,l=r.length;o<l;++o)Bn(i,r[o]),s.push(i.length);const a=new Ha(i,"XYZ",s);return a.setProperties(t,!0),a}}const Zpe=gt(Pt,{IconStyle:Lpe,LabelStyle:Dpe,LineStyle:jpe,PolyStyle:Gpe});function fk(n,e){const t=_n({},Zpe,n,e,this);if(!t)return null;let r="fillStyle"in t?t.fillStyle:C_;const i=t.fill;i!==void 0&&!i&&(r=null);let s;"imageStyle"in t?t.imageStyle!=hk&&(s=t.imageStyle):s=UR;const a="textStyle"in t?t.textStyle:Hh,o="strokeStyle"in t?t.strokeStyle:$R,l=t.outline;return l!==void 0&&!l?[new mn({geometry:function(c){const h=c.getGeometry(),f=h.getType();if(f==="GeometryCollection"){const m=h;return new _o(m.getGeometriesArrayRecursive().filter(function(y){const x=y.getType();return x!=="Polygon"&&x!=="MultiPolygon"}))}if(f!=="Polygon"&&f!=="MultiPolygon")return h},fill:r,image:s,stroke:o,text:a,zIndex:void 0}),new mn({geometry:function(c){const h=c.getGeometry(),f=h.getType();if(f==="GeometryCollection"){const m=h;return new _o(m.getGeometriesArrayRecursive().filter(function(y){const x=y.getType();return x==="Polygon"||x==="MultiPolygon"}))}if(f==="Polygon"||f==="MultiPolygon")return h},fill:r,stroke:null,zIndex:void 0})]:[new mn({fill:r,image:s,stroke:o,text:a,zIndex:void 0})]}function jS(n,e){const t=e.length,r=new Array(e.length),i=new Array(e.length),s=new Array(e.length);let a,o,l;a=!1,o=!1,l=!1;for(let c=0;c<t;++c){const h=e[c];r[c]=h.get("extrude"),i[c]=h.get("tessellate"),s[c]=h.get("altitudeMode"),a=a||r[c]!==void 0,o=o||i[c]!==void 0,l=l||s[c]}a&&n.set("extrude",r),o&&n.set("tessellate",i),l&&n.set("altitudeMode",s)}const Jpe=gt(Pt,{displayName:ze(ln),value:ze(ln)});function Qpe(n,e){const t=n.getAttribute("name");Zu(Jpe,n,e);const r=e[e.length-1];t&&r.displayName?r[t]={value:r.value,displayName:r.displayName,toString:function(){return r.value}}:t!==null?r[t]=r.value:r.displayName!==null&&(r[r.displayName]=r.value),delete r.value}const eye=gt(Pt,{Data:Qpe,SchemaData:sye});function _G(n,e){Zu(eye,n,e)}function vG(n,e){Zu(sG,n,e)}const tye=gt(Pt,{Style:ze(fk),key:ze(ln),styleUrl:ze(cG)});function nye(n,e){const t=_n({},tye,n,e,this);if(!t)return;const r=t.key;if(r&&r=="normal"){const i=t.styleUrl;i&&(e[e.length-1]=i);const s=t.Style;s&&(e[e.length-1]=s)}}function rye(n,e){const t=hG.call(this,n,e);if(!t)return;const r=e[e.length-1];if(Array.isArray(t))r.Style=t;else if(typeof t=="string")r.styleUrl=t;else throw new Error("`styleMapValue` has an unknown type")}const iye=gt(Pt,{SimpleData:aye});function sye(n,e){Zu(iye,n,e)}function aye(n,e){const t=n.getAttribute("name");if(t!==null){const r=ln(n),i=e[e.length-1];i[t]=r}}const oye=gt(Pt,{altitudeMode:ze(ln),minAltitude:ze(Mn),maxAltitude:ze(Mn),north:ze(Mn),south:ze(Mn),east:ze(Mn),west:ze(Mn)});function lye(n,e){const t=_n({},oye,n,e);if(!t)return;const r=e[e.length-1],i=[parseFloat(t.west),parseFloat(t.south),parseFloat(t.east),parseFloat(t.north)];r.extent=i,r.altitudeMode=t.altitudeMode,r.minAltitude=parseFloat(t.minAltitude),r.maxAltitude=parseFloat(t.maxAltitude)}const cye=gt(Pt,{minLodPixels:ze(Mn),maxLodPixels:ze(Mn),minFadeExtent:ze(Mn),maxFadeExtent:ze(Mn)});function uye(n,e){const t=_n({},cye,n,e);if(!t)return;const r=e[e.length-1];r.minLodPixels=parseFloat(t.minLodPixels),r.maxLodPixels=parseFloat(t.maxLodPixels),r.minFadeExtent=parseFloat(t.minFadeExtent),r.maxFadeExtent=parseFloat(t.maxFadeExtent)}const hye=gt(Pt,{LinearRing:go(dG)});function dye(n,e){const t=_n([],hye,n,e);t.length>0&&e[e.length-1].push(...t)}const fye=gt(Pt,{LinearRing:ak(dG)});function gye(n,e){const t=_n(void 0,fye,n,e);if(t){const r=e[e.length-1];r[0]=t}}function mye(n,e){Zu(Epe,n,e)}function pye(n,e){const r=e[e.length-1].whens,i=Ao(n,!1),s=Date.parse(i);r.push(isNaN(s)?0:s)}function FE(n,e){const t=Wa(e),i=[(t.length==4?t[3]:1)*255,t[2],t[1],t[0]];for(let s=0;s<4;++s){const a=Math.floor(i[s]).toString(16);i[s]=a.length==1?"0"+a:a}Fn(n,i.join(""))}function yye(n,e,t){const r=t[t.length-1],i=r.layout,s=r.stride;let a;if(i=="XY"||i=="XYM")a=2;else if(i=="XYZ"||i=="XYZM")a=3;else throw new Error("Invalid geometry layout");const o=e.length;let l="";if(o>0){l+=e[0];for(let c=1;c<a;++c)l+=","+e[c];for(let c=s;c<o;c+=s){l+=" "+e[c];for(let h=1;h<a;++h)l+=","+e[c+h]}}Fn(n,l)}const k_=gt(Pt,{Data:tt(xye),value:tt(vye),displayName:tt(_ye)});function xye(n,e,t){n.setAttribute("name",e.name);const r={node:n},i=e.value;typeof i=="object"?(i!==null&&i.displayName&&lr(r,k_,ds,[i.displayName],t,["displayName"]),i!==null&&i.value&&lr(r,k_,ds,[i.value],t,["value"])):lr(r,k_,ds,[i],t,["value"])}function _ye(n,e){Fn(n,e)}function vye(n,e){Fn(n,e)}const wye=gt(Pt,{Placemark:tt(TG)}),Eye=function(n,e,t){const r=e[e.length-1].node;return Fd(r.namespaceURI,"Placemark")};function Tye(n,e,t){lr({node:n},wye,Eye,e,t,void 0,this)}const Sye=Io("Data");function bye(n,e,t){const r={node:n},i=e.names,s=e.values,a=i.length;for(let o=0;o<a;o++)lr(r,k_,Sye,[{name:i[o],value:s[o]}],t)}const w5=gt(Pt,["href"],gt(vc,["x","y","w","h"])),E5=gt(Pt,{href:tt(Fn)},gt(vc,{x:tt(Ls),y:tt(Ls),w:tt(Ls),h:tt(Ls)})),Rye=function(n,e,t){return Fd(vc[0],"gx:"+t)};function Aye(n,e,t){const r={node:n},i=t[t.length-1].node;let s=w5[i.namespaceURI],a=Hs(e,s);lr(r,E5,ds,a,t,s),s=w5[vc[0]],a=Hs(e,s),lr(r,E5,Rye,a,t,s)}const Iye=gt(Pt,["scale","heading","Icon","color","hotSpot"]),Cye=gt(Pt,{Icon:tt(Aye),color:tt(FE),heading:tt(Ls),hotSpot:tt(n1e),scale:tt(bG)});function kye(n,e,t){const r={node:n},i={},s=e.getSrc(),a=e.getSize(),o=e.getImageSize(),l={href:s};if(a){l.w=a[0],l.h=a[1];const w=e.getAnchor(),S=e.getOrigin();if(S&&o&&S[0]!==0&&S[1]!==a[1]&&(l.x=S[0],l.y=o[1]-(S[1]+a[1])),w&&(w[0]!==a[0]/2||w[1]!==a[1]/2)){const b={x:w[0],xunits:"pixels",y:a[1]-w[1],yunits:"pixels"};i.hotSpot=b}}i.Icon=l;let c=e.getScaleArray()[0],h=a;if(h===null&&(h=cp),h.length==2){const w=Qv(h);c=c/w}c!==1&&(i.scale=c);const f=e.getRotation();f!==0&&(i.heading=f);const m=e.getColor();m&&(i.color=m);const y=t[t.length-1].node,x=Iye[y.namespaceURI],_=Hs(i,x);lr(r,Cye,ds,_,t,x)}const Pye=gt(Pt,["color","scale"]),Mye=gt(Pt,{color:tt(FE),scale:tt(bG)});function Nye(n,e,t){const r={node:n},i={},s=e.getFill();s&&(i.color=s.getColor());const a=e.getScale();a&&a!==1&&(i.scale=a);const o=t[t.length-1].node,l=Pye[o.namespaceURI],c=Hs(i,l);lr(r,Mye,ds,c,t,l)}const Lye=gt(Pt,["color","width"]),Oye=gt(Pt,{color:tt(FE),width:tt(Ls)});function Dye(n,e,t){const r={node:n},i={color:e.getColor(),width:Number(e.getWidth())||1},s=t[t.length-1].node,a=Lye[s.namespaceURI],o=Hs(i,a);lr(r,Oye,ds,o,t,a)}const Fye={Point:"Point",LineString:"LineString",LinearRing:"LinearRing",Polygon:"Polygon",MultiPoint:"MultiGeometry",MultiLineString:"MultiGeometry",MultiPolygon:"MultiGeometry",GeometryCollection:"MultiGeometry"},wG=function(n,e,t){if(n){const r=e[e.length-1].node;return Fd(r.namespaceURI,Fye[n.getType()])}},jye=Io("Point"),Vye=Io("LineString"),Gye=Io("LinearRing"),Bye=Io("Polygon"),zye=gt(Pt,{LineString:tt(R0),Point:tt(R0),Polygon:tt(SG),GeometryCollection:tt(EG)});function EG(n,e,t){const r={node:n},i=e.getType();let s=[],a;if(i==="GeometryCollection")e.getGeometriesArrayRecursive().forEach(function(o){const l=o.getType();if(l==="MultiPoint")s=s.concat(o.getPoints());else if(l==="MultiLineString")s=s.concat(o.getLineStrings());else if(l==="MultiPolygon")s=s.concat(o.getPolygons());else if(l==="Point"||l==="LineString"||l==="Polygon")s.push(o);else throw new Error("Unknown geometry type")}),a=wG;else if(i==="MultiPoint")s=e.getPoints(),a=jye;else if(i==="MultiLineString")s=e.getLineStrings(),a=Vye;else if(i==="MultiPolygon")s=e.getPolygons(),a=Bye;else throw new Error("Unknown geometry type");lr(r,zye,a,s,t)}const Uye=gt(Pt,{LinearRing:tt(R0)});function T5(n,e,t){lr({node:n},Uye,Gye,[e],t)}const VS=gt(Pt,{ExtendedData:tt(bye),MultiGeometry:tt(EG),LineString:tt(R0),LinearRing:tt(R0),Point:tt(R0),Polygon:tt(SG),Style:tt(t1e),address:tt(Fn),description:tt(Fn),name:tt(Fn),open:tt(sg),phoneNumber:tt(Fn),styleUrl:tt(Fn),visibility:tt(sg)}),$ye=gt(Pt,["name","open","visibility","address","phoneNumber","description","styleUrl","Style"]),Wye=Io("ExtendedData");function TG(n,e,t){const r={node:n};e.getId()&&n.setAttribute("id",e.getId());const i=e.getProperties(),s={address:1,description:1,name:1,open:1,phoneNumber:1,styleUrl:1,visibility:1};s[e.getGeometryName()]=1;const a=Object.keys(i||{}).sort().filter(function(y){return!s[y]}),o=e.getStyleFunction();if(o){const y=o(e,0);if(y){const x=Array.isArray(y)?y:[y];let _=x;if(e.getGeometry()&&(_=x.filter(function(w){const S=w.getGeometryFunction()(e);if(S){const b=S.getType();return b==="GeometryCollection"?S.getGeometriesArrayRecursive().filter(function(R){const M=R.getType();return M==="Point"||M==="MultiPoint"}).length:b==="Point"||b==="MultiPoint"}})),this.writeStyles_){let w=x,S=x;e.getGeometry()&&(w=x.filter(function(b){const R=b.getGeometryFunction()(e);if(R){const M=R.getType();return M==="GeometryCollection"?R.getGeometriesArrayRecursive().filter(function(O){const G=O.getType();return G==="LineString"||G==="MultiLineString"}).length:M==="LineString"||M==="MultiLineString"}}),S=x.filter(function(b){const R=b.getGeometryFunction()(e);if(R){const M=R.getType();return M==="GeometryCollection"?R.getGeometriesArrayRecursive().filter(function(O){const G=O.getType();return G==="Polygon"||G==="MultiPolygon"}).length:M==="Polygon"||M==="MultiPolygon"}})),i.Style={pointStyles:_,lineStyles:w,polyStyles:S}}if(_.length&&i.name===void 0){const w=_[0].getText();w&&(i.name=w.getText())}}}const l=t[t.length-1].node,c=$ye[l.namespaceURI],h=Hs(i,c);if(lr(r,VS,ds,h,t,c),a.length>0){const y=Hs(i,a);lr(r,VS,Wye,[{names:a,values:y}],t)}const f=t[0];let m=e.getGeometry();m&&(m=Ro(m,!0,f)),lr(r,VS,wG,[m],t)}const Hye=gt(Pt,["extrude","tessellate","altitudeMode","coordinates"]),Kye=gt(Pt,{extrude:tt(sg),tessellate:tt(sg),altitudeMode:tt(Fn),coordinates:tt(yye)});function R0(n,e,t){const r=e.getFlatCoordinates(),i={node:n};i.layout=e.getLayout(),i.stride=e.getStride();const s=e.getProperties();s.coordinates=r;const a=t[t.length-1].node,o=Hye[a.namespaceURI],l=Hs(s,o);lr(i,Kye,ds,l,t,o)}const Xye=gt(Pt,["color","fill","outline"]),S5=gt(Pt,{outerBoundaryIs:tt(T5),innerBoundaryIs:tt(T5)}),qye=Io("innerBoundaryIs"),Yye=Io("outerBoundaryIs");function SG(n,e,t){const r=e.getLinearRings(),i=r.shift(),s={node:n};lr(s,S5,qye,r,t),lr(s,S5,Yye,[i],t)}const Zye=gt(Pt,{color:tt(FE),fill:tt(sg),outline:tt(sg)});function Jye(n,e,t){const r={node:n},i=e.getFill(),s=e.getStroke(),a={color:i?i.getColor():void 0,fill:i?void 0:!1,outline:s?void 0:!1},o=t[t.length-1].node,l=Xye[o.namespaceURI],c=Hs(a,l);lr(r,Zye,ds,c,t,l)}function bG(n,e){Ls(n,Math.round(e*1e6)/1e6)}const Qye=gt(Pt,["IconStyle","LabelStyle","LineStyle","PolyStyle"]),e1e=gt(Pt,{IconStyle:tt(kye),LabelStyle:tt(Nye),LineStyle:tt(Dye),PolyStyle:tt(Jye)});function t1e(n,e,t){const r={node:n},i={};if(e.pointStyles.length){const l=e.pointStyles[0].getText();l&&(i.LabelStyle=l);const c=e.pointStyles[0].getImage();c&&typeof c.getSrc=="function"&&(i.IconStyle=c)}if(e.lineStyles.length){const l=e.lineStyles[0].getStroke();l&&(i.LineStyle=l)}if(e.polyStyles.length){const l=e.polyStyles[0].getStroke();l&&!i.LineStyle&&(i.LineStyle=l),i.PolyStyle=e.polyStyles[0]}const s=t[t.length-1].node,a=Qye[s.namespaceURI],o=Hs(i,a);lr(r,e1e,ds,o,t,a)}function n1e(n,e){n.setAttribute("x",String(e.x)),n.setAttribute("y",String(e.y)),n.setAttribute("xunits",e.xunits),n.setAttribute("yunits",e.yunits)}function RG(n){const e=Object.keys(n.defs),t=e.length;let r,i;for(r=0;r<t;++r){const s=e[r];if(!n_(s)){const a=n.defs(s);let o=a.units;!o&&a.projName==="longlat"&&(o="degrees"),F_(new ww({code:s,axisOrientation:a.axis,metersPerUnit:a.to_meter,units:o}))}}for(r=0;r<t;++r){const s=e[r],a=n_(s);for(i=0;i<t;++i){const o=e[i],l=n_(o);if(!r_(s,o))if(n.defs[s]===n.defs[o])ob([a,l]);else{const c=n(s,o);p$(a,l,hM(a,l,c.forward),hM(l,a,c.inverse))}}}}console.log(" parcelHighlight.ts v3.1 loaded - fixed pixelRatio for Android");Tn.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs");RG(Tn);let Kh=null,up=null,e0=null;function KR(n){Kh&&(n.removeLayer(Kh),Kh=null),up&&(n.removeLayer(up),up=null),e0=null}async function r1e(n,e){try{const t=En(e);console.log(` Click (3857): ${e[0].toFixed(0)}, ${e[1].toFixed(0)}`),console.log(` LonLat (WGS84): ${t[0].toFixed(5)}, ${t[1].toFixed(5)}`);const r=Tn("EPSG:4326","EPSG:28992",t);if(console.log(` RD (28992): ${r?r[0].toFixed(0)+", "+r[1].toFixed(0):"FAILED"}`),!r||r[0]<7e3||r[0]>3e5||r[1]<289e3||r[1]>629e3)return console.error(" Coordinate outside Netherlands or transformation failed:",r),!1;KR(n);const i=1,s=`${r[0]-i},${r[1]-i},${r[0]+i},${r[1]+i}`,a=Date.now(),o=`https://service.pdok.nl/rvo/brpgewaspercelen/wfs/v1_0?SERVICE=WFS&VERSION=2.0.0&REQUEST=GetFeature&TYPENAMES=brpgewaspercelen:BrpGewas&OUTPUTFORMAT=json&SRSNAME=EPSG:28992&BBOX=${s},EPSG:28992&_=${a}`;console.log(" WFS URL:",o);const l=new AbortController,c=setTimeout(()=>l.abort(),1e4),h=await fetch(o,{signal:l.signal});if(clearTimeout(c),!h.ok)return console.error("WFS request failed:",h.status),!1;const f=await h.json();if(console.log(" WFS RESPONSE:",JSON.stringify(f).substring(0,500)),!f.features||f.features.length===0)return console.log("No parcel found at location"),!1;const m=f.features[0];console.log(" PARCEL ID:",m.id||m.properties?.id||"geen ID"),console.log(" PARCEL BBOX:",JSON.stringify(m.bbox||"geen bbox"));const x=new ik().readFeature(m,{dataProjection:"EPSG:28992",featureProjection:"EPSG:3857"}),_=x.getGeometry();if(!_)return console.log("No geometry in parcel feature"),!1;const w=m.properties||{};console.log(` Parcel: ${w.category||"unknown"} - ${w.gewasnaam||w.gewas||"geen gewas"}`),console.log(` Geometry type: ${_.getType()}, extent: ${_.getExtent().map(P=>P.toFixed(0)).join(", ")}`);const S=_.getExtent(),b=S[2]-S[0],R=S[3]-S[1],M=Math.max(b,R)*.05,O=[S[0]-M,S[1]-M,S[2]+M,S[3]+M],G=Math.max(b,R)*.3,A=[S[0]-G,S[1]-G,S[2]+G,S[3]+G];e0=_,Kh=new cX({source:new DX({url:"https://ahn.arcgisonline.nl/arcgis/rest/services/Hoogtebestand/AHN4_DTM_50cm/ImageServer",params:{renderingRule:JSON.stringify({rasterFunction:"AHN - Color Ramp D"})},crossOrigin:"anonymous"}),extent:O,zIndex:998}),Kh.on("prerender",P=>{if(!e0)return;const D=P.context;if(!D)return;const L=P.frameState;if(!L)return;D.save(),D.beginPath(),(e0.getType()==="Polygon"?e0.getCoordinates()[0]:e0.getCoordinates()[0][0]).forEach((j,Ee)=>{const ke=n.getPixelFromCoordinate(j);if(!ke)return;const Be=L.pixelRatio,Me=ke[0]*Be,ce=ke[1]*Be;Ee===0?D.moveTo(Me,ce):D.lineTo(Me,ce)}),D.closePath(),D.clip()}),Kh.on("postrender",P=>{const D=P.context;D&&D.restore()}),n.addLayer(Kh);const I=new gc({features:[x]});return up=new Wu({source:I,style:new mn({fill:new rr({color:"rgba(0, 0, 0, 0)"}),stroke:new Yn({color:"#dc2626",width:3})}),zIndex:999}),n.addLayer(up),console.log(" Parcel height map displayed"),!0}catch(t){return console.error("Failed to show parcel height map:",t),!1}}var ew={};ew.version="0.18.5";var AG=1252,i1e=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],IG=function(n){i1e.indexOf(n)!=-1&&(AG=n)};function s1e(){IG(1252)}var ly=function(n){IG(n)};function a1e(){ly(1200),s1e()}var Kx=function(e){return String.fromCharCode(e)},b5=function(e){return String.fromCharCode(e)},tw,yu="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function cy(n){for(var e="",t=0,r=0,i=0,s=0,a=0,o=0,l=0,c=0;c<n.length;)t=n.charCodeAt(c++),s=t>>2,r=n.charCodeAt(c++),a=(t&3)<<4|r>>4,i=n.charCodeAt(c++),o=(r&15)<<2|i>>6,l=i&63,isNaN(r)?o=l=64:isNaN(i)&&(l=64),e+=yu.charAt(s)+yu.charAt(a)+yu.charAt(o)+yu.charAt(l);return e}function hc(n){var e="",t=0,r=0,i=0,s=0,a=0,o=0,l=0;n=n.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<n.length;)s=yu.indexOf(n.charAt(c++)),a=yu.indexOf(n.charAt(c++)),t=s<<2|a>>4,e+=String.fromCharCode(t),o=yu.indexOf(n.charAt(c++)),r=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(r)),l=yu.indexOf(n.charAt(c++)),i=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var Dn=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),wc=(function(){if(typeof Buffer<"u"){var n=!Buffer.from;if(!n)try{Buffer.from("foo","utf8")}catch{n=!0}return n?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}})();function Ed(n){return Dn?Buffer.alloc?Buffer.alloc(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}function R5(n){return Dn?Buffer.allocUnsafe?Buffer.allocUnsafe(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}var mo=function(e){return Dn?wc(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)&255})};function jE(n){if(typeof ArrayBuffer>"u")return mo(n);for(var e=new ArrayBuffer(n.length),t=new Uint8Array(e),r=0;r!=n.length;++r)t[r]=n.charCodeAt(r)&255;return e}function a1(n){if(Array.isArray(n))return n.map(function(r){return String.fromCharCode(r)}).join("");for(var e=[],t=0;t<n.length;++t)e[t]=String.fromCharCode(n[t]);return e.join("")}function o1e(n){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(n)}var Wi=Dn?function(n){return Buffer.concat(n.map(function(e){return Buffer.isBuffer(e)?e:wc(e)}))}:function(n){if(typeof Uint8Array<"u"){var e=0,t=0;for(e=0;e<n.length;++e)t+=n[e].length;var r=new Uint8Array(t),i=0;for(e=0,t=0;e<n.length;t+=i,++e)if(i=n[e].length,n[e]instanceof Uint8Array)r.set(n[e],t);else{if(typeof n[e]=="string")throw"wtf";r.set(new Uint8Array(n[e]),t)}return r}return[].concat.apply([],n.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function l1e(n){for(var e=[],t=0,r=n.length+250,i=Ed(n.length+255),s=0;s<n.length;++s){var a=n.charCodeAt(s);if(a<128)i[t++]=a;else if(a<2048)i[t++]=192|a>>6&31,i[t++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=n.charCodeAt(++s)&1023;i[t++]=240|a>>8&7,i[t++]=128|a>>2&63,i[t++]=128|o>>6&15|(a&3)<<4,i[t++]=128|o&63}else i[t++]=224|a>>12&15,i[t++]=128|a>>6&63,i[t++]=128|a&63;t>r&&(e.push(i.slice(0,t)),t=0,i=Ed(65535),r=65530)}return e.push(i.slice(0,t)),Wi(e)}var hp=/\u0000/g,Xx=/[\u0001-\u0006]/g;function A0(n){for(var e="",t=n.length-1;t>=0;)e+=n.charAt(t--);return e}function xo(n,e){var t=""+n;return t.length>=e?t:jr("0",e-t.length)+t}function gk(n,e){var t=""+n;return t.length>=e?t:jr(" ",e-t.length)+t}function nw(n,e){var t=""+n;return t.length>=e?t:t+jr(" ",e-t.length)}function c1e(n,e){var t=""+Math.round(n);return t.length>=e?t:jr("0",e-t.length)+t}function u1e(n,e){var t=""+n;return t.length>=e?t:jr("0",e-t.length)+t}var A5=Math.pow(2,32);function Ff(n,e){if(n>A5||n<-A5)return c1e(n,e);var t=Math.round(n);return u1e(t,e)}function rw(n,e){return e=e||0,n.length>=7+e&&(n.charCodeAt(e)|32)===103&&(n.charCodeAt(e+1)|32)===101&&(n.charCodeAt(e+2)|32)===110&&(n.charCodeAt(e+3)|32)===101&&(n.charCodeAt(e+4)|32)===114&&(n.charCodeAt(e+5)|32)===97&&(n.charCodeAt(e+6)|32)===108}var I5=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],GS=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function h1e(n){return n||(n={}),n[0]="General",n[1]="0",n[2]="0.00",n[3]="#,##0",n[4]="#,##0.00",n[9]="0%",n[10]="0.00%",n[11]="0.00E+00",n[12]="# ?/?",n[13]="# ??/??",n[14]="m/d/yy",n[15]="d-mmm-yy",n[16]="d-mmm",n[17]="mmm-yy",n[18]="h:mm AM/PM",n[19]="h:mm:ss AM/PM",n[20]="h:mm",n[21]="h:mm:ss",n[22]="m/d/yy h:mm",n[37]="#,##0 ;(#,##0)",n[38]="#,##0 ;[Red](#,##0)",n[39]="#,##0.00;(#,##0.00)",n[40]="#,##0.00;[Red](#,##0.00)",n[45]="mm:ss",n[46]="[h]:mm:ss",n[47]="mmss.0",n[48]="##0.0E+0",n[49]="@",n[56]='"/ "hh""mm""ss" "',n}var Gr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},C5={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},d1e={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function iw(n,e,t){for(var r=n<0?-1:1,i=n*r,s=0,a=1,o=0,l=1,c=0,h=0,f=Math.floor(i);c<e&&(f=Math.floor(i),o=f*a+s,h=f*c+l,!(i-f<5e-8));)i=1/(i-f),s=a,a=o,l=c,c=h;if(h>e&&(c>e?(h=l,o=s):(h=c,o=a)),!t)return[0,r*o,h];var m=Math.floor(r*o/h);return[m,r*o-m*h,h]}function qx(n,e,t){if(n>2958465||n<0)return null;var r=n|0,i=Math.floor(86400*(n-r)),s=0,a=[],o={D:r,T:i,u:86400*(n-r)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(r+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++r,++o.D)),r===60)a=t?[1317,10,29]:[1900,2,29],s=3;else if(r===0)a=t?[1317,8,29]:[1900,1,0],s=6;else{r>60&&--r;var l=new Date(1900,0,1);l.setDate(l.getDate()+r-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),r<60&&(s=(s+6)%7),t&&(s=_1e(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var CG=new Date(1899,11,31,0,0,0),f1e=CG.getTime(),g1e=new Date(1900,2,1,0,0,0);function kG(n,e){var t=n.getTime();return e?t-=1461*24*60*60*1e3:n>=g1e&&(t+=1440*60*1e3),(t-(f1e+(n.getTimezoneOffset()-CG.getTimezoneOffset())*6e4))/(1440*60*1e3)}function mk(n){return n.indexOf(".")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function m1e(n){return n.indexOf("E")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function p1e(n){var e=n<0?12:11,t=mk(n.toFixed(12));return t.length<=e||(t=n.toPrecision(10),t.length<=e)?t:n.toExponential(5)}function y1e(n){var e=mk(n.toFixed(11));return e.length>(n<0?12:11)||e==="0"||e==="-0"?n.toPrecision(6):e}function x1e(n){var e=Math.floor(Math.log(Math.abs(n))*Math.LOG10E),t;return e>=-4&&e<=-1?t=n.toPrecision(10+e):Math.abs(e)<=9?t=p1e(n):e===10?t=n.toFixed(10).substr(0,12):t=y1e(n),mk(m1e(t.toUpperCase()))}function XR(n,e){switch(typeof n){case"string":return n;case"boolean":return n?"TRUE":"FALSE";case"number":return(n|0)===n?n.toString(10):x1e(n);case"undefined":return"";case"object":if(n==null)return"";if(n instanceof Date)return zu(14,kG(n,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+n)}function _1e(n,e){e[0]-=581;var t=n.getDay();return n<60&&(t=(t+6)%7),t}function v1e(n,e,t,r){var i="",s=0,a=0,o=t.y,l,c=0;switch(n){case 98:o=t.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(e.length){case 1:case 2:l=t.m,c=e.length;break;case 3:return GS[t.m-1][1];case 5:return GS[t.m-1][0];default:return GS[t.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=t.d,c=e.length;break;case 3:return I5[t.q][0];default:return I5[t.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(t.H+11)%12,c=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=t.H,c=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=t.M,c=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return t.u===0&&(e=="s"||e=="ss")?xo(t.S,e.length):(r>=2?a=r===3?1e3:100:a=r===1?10:1,s=Math.round(a*(t.S+t.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(i=xo(s,2+r),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=t.D*24+t.H;break;case"[m]":case"[mm]":l=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":l=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+e}c=e.length===3?1:2;break;case 101:l=o,c=1;break}var h=c>0?xo(l,c):"";return h}function xu(n){var e=3;if(n.length<=e)return n;for(var t=n.length%e,r=n.substr(0,t);t!=n.length;t+=e)r+=(r.length>0?",":"")+n.substr(t,e);return r}var PG=/%/g;function w1e(n,e,t){var r=e.replace(PG,""),i=e.length-r.length;return ec(n,r,t*Math.pow(10,2*i))+jr("%",i)}function E1e(n,e,t){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return ec(n,e.substr(0,r),t/Math.pow(10,3*(e.length-r)))}function MG(n,e){var t,r=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+MG(n,-e);var i=n.indexOf(".");i===-1&&(i=n.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),t=(e/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),t.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(a-t.length+s):t+="E+"+(a-s);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,i)+"."+t.substr(2+i),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,h){return l+c+h.substr(0,(i+s)%i)+"."+h.substr(s)+"E"})}else t=e.toExponential(r);return n.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),n.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var NG=/# (\?+)( ?)\/( ?)(\d+)/;function T1e(n,e,t){var r=parseInt(n[4],10),i=Math.round(e*r),s=Math.floor(i/r),a=i-s*r,o=r;return t+(s===0?"":""+s)+" "+(a===0?jr(" ",n[1].length+1+n[4].length):gk(a,n[1].length)+n[2]+"/"+n[3]+xo(o,n[4].length))}function S1e(n,e,t){return t+(e===0?"":""+e)+jr(" ",n[1].length+2+n[4].length)}var LG=/^#*0*\.([0#]+)/,OG=/\).*[0#]/,DG=/\(###\) ###\\?-####/;function _s(n){for(var e="",t,r=0;r!=n.length;++r)switch(t=n.charCodeAt(r)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(t)}return e}function k5(n,e){var t=Math.pow(10,e);return""+Math.round(n*t)/t}function P5(n,e){var t=n-Math.floor(n),r=Math.pow(10,e);return e<(""+Math.round(t*r)).length?0:Math.round(t*r)}function b1e(n,e){return e<(""+Math.round((n-Math.floor(n))*Math.pow(10,e))).length?1:0}function R1e(n){return n<2147483647&&n>-2147483648?""+(n>=0?n|0:n-1|0):""+Math.floor(n)}function Ca(n,e,t){if(n.charCodeAt(0)===40&&!e.match(OG)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Ca("n",r,t):"("+Ca("n",r,-t)+")"}if(e.charCodeAt(e.length-1)===44)return E1e(n,e,t);if(e.indexOf("%")!==-1)return w1e(n,e,t);if(e.indexOf("E")!==-1)return MG(e,t);if(e.charCodeAt(0)===36)return"$"+Ca(n,e.substr(e.charAt(1)==" "?2:1),t);var i,s,a,o,l=Math.abs(t),c=t<0?"-":"";if(e.match(/^00+$/))return c+Ff(l,e.length);if(e.match(/^[#?]+$/))return i=Ff(t,0),i==="0"&&(i=""),i.length>e.length?i:_s(e.substr(0,e.length-i.length))+i;if(s=e.match(NG))return T1e(s,l,c);if(e.match(/^#+0+$/))return c+Ff(l,e.length-e.indexOf("0"));if(s=e.match(LG))return i=k5(t,s[1].length).replace(/^([^\.]+)$/,"$1."+_s(s[1])).replace(/\.$/,"."+_s(s[1])).replace(/\.(\d*)$/,function(x,_){return"."+_+jr("0",_s(s[1]).length-_.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+k5(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+xu(Ff(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Ca(n,e,-t):xu(""+(Math.floor(t)+b1e(t,s[1].length)))+"."+xo(P5(t,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return Ca(n,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=A0(Ca(n,e.replace(/[\\-]/g,""),t)),a=0,A0(A0(e.replace(/\\/g,"")).replace(/[0#]/g,function(x){return a<i.length?i.charAt(a++):x==="0"?"0":""}));if(e.match(DG))return i=Ca(n,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=iw(l,Math.pow(10,a)-1,!1),i=""+c,h=ec("n",s[1],o[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+s[2]+"/"+s[3],h=nw(o[2],a),h.length<s[4].length&&(h=_s(s[4].substr(s[4].length-h.length))+h),i+=h,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=iw(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?gk(o[1],a)+s[2]+"/"+s[3]+nw(o[2],a):jr(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=Ff(t,0),e.length<=i.length?i:_s(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var f=e.indexOf(".")-a,m=e.length-i.length-f;return _s(e.substr(0,f)+i+e.substr(e.length-m))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=P5(t,s[1].length),t<0?"-"+Ca(n,e,-t):xu(R1e(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?xo(0,3-x.length):"")+x})+"."+xo(a,s[1].length);switch(e){case"###,##0.00":return Ca(n,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var y=xu(Ff(l,0));return y!=="0"?c+y:"";case"###,###.00":return Ca(n,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return Ca(n,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function A1e(n,e,t){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return ec(n,e.substr(0,r),t/Math.pow(10,3*(e.length-r)))}function I1e(n,e,t){var r=e.replace(PG,""),i=e.length-r.length;return ec(n,r,t*Math.pow(10,2*i))+jr("%",i)}function FG(n,e){var t,r=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+FG(n,-e);var i=n.indexOf(".");i===-1&&(i=n.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),t=(e/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),!t.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(a-t.length+s):t+="E+"+(a-s),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,h){return l+c+h.substr(0,(i+s)%i)+"."+h.substr(s)+"E"})}else t=e.toExponential(r);return n.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),n.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Ho(n,e,t){if(n.charCodeAt(0)===40&&!e.match(OG)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Ho("n",r,t):"("+Ho("n",r,-t)+")"}if(e.charCodeAt(e.length-1)===44)return A1e(n,e,t);if(e.indexOf("%")!==-1)return I1e(n,e,t);if(e.indexOf("E")!==-1)return FG(e,t);if(e.charCodeAt(0)===36)return"$"+Ho(n,e.substr(e.charAt(1)==" "?2:1),t);var i,s,a,o,l=Math.abs(t),c=t<0?"-":"";if(e.match(/^00+$/))return c+xo(l,e.length);if(e.match(/^[#?]+$/))return i=""+t,t===0&&(i=""),i.length>e.length?i:_s(e.substr(0,e.length-i.length))+i;if(s=e.match(NG))return S1e(s,l,c);if(e.match(/^#+0+$/))return c+xo(l,e.length-e.indexOf("0"));if(s=e.match(LG))return i=(""+t).replace(/^([^\.]+)$/,"$1."+_s(s[1])).replace(/\.$/,"."+_s(s[1])),i=i.replace(/\.(\d*)$/,function(x,_){return"."+_+jr("0",_s(s[1]).length-_.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+xu(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Ho(n,e,-t):xu(""+t)+"."+jr("0",s[1].length);if(s=e.match(/^#,#*,#0/))return Ho(n,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=A0(Ho(n,e.replace(/[\\-]/g,""),t)),a=0,A0(A0(e.replace(/\\/g,"")).replace(/[0#]/g,function(x){return a<i.length?i.charAt(a++):x==="0"?"0":""}));if(e.match(DG))return i=Ho(n,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=iw(l,Math.pow(10,a)-1,!1),i=""+c,h=ec("n",s[1],o[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+s[2]+"/"+s[3],h=nw(o[2],a),h.length<s[4].length&&(h=_s(s[4].substr(s[4].length-h.length))+h),i+=h,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=iw(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?gk(o[1],a)+s[2]+"/"+s[3]+nw(o[2],a):jr(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+t,e.length<=i.length?i:_s(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var f=e.indexOf(".")-a,m=e.length-i.length-f;return _s(e.substr(0,f)+i+e.substr(e.length-m))}if(s=e.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Ho(n,e,-t):xu(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?xo(0,3-x.length):"")+x})+"."+xo(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var y=xu(""+l);return y!=="0"?c+y:"";default:if(e.match(/\.[0#?]*$/))return Ho(n,e.slice(0,e.lastIndexOf(".")),t)+_s(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function ec(n,e,t){return(t|0)===t?Ho(n,e,t):Ca(n,e,t)}function C1e(n){for(var e=[],t=!1,r=0,i=0;r<n.length;++r)switch(n.charCodeAt(r)){case 34:t=!t;break;case 95:case 42:case 92:++r;break;case 59:e[e.length]=n.substr(i,r-i),i=r+1}if(e[e.length]=n.substr(i),t===!0)throw new Error("Format |"+n+"| unterminated string ");return e}var jG=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function VG(n){for(var e=0,t="",r="";e<n.length;)switch(t=n.charAt(e)){case"G":rw(n,e)&&(e+=6),e++;break;case'"':for(;n.charCodeAt(++e)!==34&&e<n.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(n.charAt(e+1)==="1"||n.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(n.substr(e,3).toUpperCase()==="A/P"||n.substr(e,5).toUpperCase()==="AM/PM"||n.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(r=t;n.charAt(e++)!=="]"&&e<n.length;)r+=n.charAt(e);if(r.match(jG))return!0;break;case".":case"0":case"#":for(;e<n.length&&("0#?.,E+-%".indexOf(t=n.charAt(++e))>-1||t=="\\"&&n.charAt(e+1)=="-"&&"0#".indexOf(n.charAt(e+2))>-1););break;case"?":for(;n.charAt(++e)===t;);break;case"*":++e,(n.charAt(e)==" "||n.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<n.length&&"0123456789".indexOf(n.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function k1e(n,e,t,r){for(var i=[],s="",a=0,o="",l="t",c,h,f,m="H";a<n.length;)switch(o=n.charAt(a)){case"G":if(!rw(n,a))throw new Error("unrecognized character "+o+" in "+n);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(f=n.charCodeAt(++a))!==34&&a<n.length;)s+=String.fromCharCode(f);i[i.length]={t:"t",v:s},++a;break;case"\\":var y=n.charAt(++a),x=y==="("||y===")"?y:"t";i[i.length]={t:x,v:y},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:e},++a;break;case"B":case"b":if(n.charAt(a+1)==="1"||n.charAt(a+1)==="2"){if(c==null&&(c=qx(e,t,n.charAt(a+1)==="2"),c==null))return"";i[i.length]={t:"X",v:n.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||c==null&&(c=qx(e,t),c==null))return"";for(s=o;++a<n.length&&n.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=m),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var _={t:o,v:o};if(c==null&&(c=qx(e,t)),n.substr(a,3).toUpperCase()==="A/P"?(c!=null&&(_.v=c.H>=12?"P":"A"),_.t="T",m="h",a+=3):n.substr(a,5).toUpperCase()==="AM/PM"?(c!=null&&(_.v=c.H>=12?"PM":"AM"),_.t="T",a+=5,m="h"):n.substr(a,5).toUpperCase()==="/"?(c!=null&&(_.v=c.H>=12?"":""),_.t="T",a+=5,m="h"):(_.t="t",++a),c==null&&_.t==="T")return"";i[i.length]=_,l=o;break;case"[":for(s=o;n.charAt(a++)!=="]"&&a<n.length;)s+=n.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(jG)){if(c==null&&(c=qx(e,t),c==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",VG(n)||(i[i.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++a<n.length&&(o=n.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<n.length&&"0#?.,E+-%".indexOf(o=n.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;n.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(n.charAt(a)==" "||n.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:r===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<n.length&&"0123456789".indexOf(n.charAt(++a))>-1;)s+=n.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+n);i[i.length]={t:"t",v:o},++a;break}var w=0,S=0,b;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=m,l="h",w<1&&(w=1);break;case"s":(b=i[a].v.match(/\.0+$/))&&(S=Math.max(S,b[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&i[a].v.match(/[Hh]/)&&(w=1),w<2&&i[a].v.match(/[Mm]/)&&(w=2),w<3&&i[a].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var R="",M;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=v1e(i[a].t.charCodeAt(0),i[a].v,c,S),i[a].t="t";break;case"n":case"?":for(M=a+1;i[M]!=null&&((o=i[M].t)==="?"||o==="D"||(o===" "||o==="t")&&i[M+1]!=null&&(i[M+1].t==="?"||i[M+1].t==="t"&&i[M+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[M].v==="/"||i[M].v===" "&&i[M+1]!=null&&i[M+1].t=="?"));)i[a].v+=i[M].v,i[M]={v:"",t:";"},++M;R+=i[a].v,a=M-1;break;case"G":i[a].t="t",i[a].v=XR(e,t);break}var O="",G,A;if(R.length>0){R.charCodeAt(0)==40?(G=e<0&&R.charCodeAt(0)===45?-e:e,A=ec("n",R,G)):(G=e<0&&r>1?-e:e,A=ec("n",R,G),G<0&&i[0]&&i[0].t=="t"&&(A=A.substr(1),i[0].v="-"+i[0].v)),M=A.length-1;var I=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){I=a;break}var P=i.length;if(I===i.length&&A.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(M>=i[a].v.length-1?(M-=i[a].v.length,i[a].v=A.substr(M+1,i[a].v.length)):M<0?i[a].v="":(i[a].v=A.substr(0,M+1),M=-1),i[a].t="t",P=a);M>=0&&P<i.length&&(i[P].v=A.substr(0,M+1)+i[P].v)}else if(I!==i.length&&A.indexOf("E")===-1){for(M=A.indexOf(".")-1,a=I;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(h=i[a].v.indexOf(".")>-1&&a===I?i[a].v.indexOf(".")-1:i[a].v.length-1,O=i[a].v.substr(h+1);h>=0;--h)M>=0&&(i[a].v.charAt(h)==="0"||i[a].v.charAt(h)==="#")&&(O=A.charAt(M--)+O);i[a].v=O,i[a].t="t",P=a}for(M>=0&&P<i.length&&(i[P].v=A.substr(0,M+1)+i[P].v),M=A.indexOf(".")+1,a=I;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==I)){for(h=i[a].v.indexOf(".")>-1&&a===I?i[a].v.indexOf(".")+1:0,O=i[a].v.substr(0,h);h<i[a].v.length;++h)M<A.length&&(O+=A.charAt(M++));i[a].v=O,i[a].t="t",P=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(G=r>1&&e<0&&a>0&&i[a-1].v==="-"?-e:e,i[a].v=ec(i[a].t,i[a].v,G),i[a].t="t");var D="";for(a=0;a!==i.length;++a)i[a]!=null&&(D+=i[a].v);return D}var M5=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function N5(n,e){if(e==null)return!1;var t=parseFloat(e[2]);switch(e[1]){case"=":if(n==t)return!0;break;case">":if(n>t)return!0;break;case"<":if(n<t)return!0;break;case"<>":if(n!=t)return!0;break;case">=":if(n>=t)return!0;break;case"<=":if(n<=t)return!0;break}return!1}function P1e(n,e){var t=C1e(n),r=t.length,i=t[r-1].indexOf("@");if(r<4&&i>-1&&--r,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof e!="number")return[4,t.length===4||i>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=i>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=i>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=i>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var s=e>0?t[0]:e<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[r,s];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var a=t[0].match(M5),o=t[1].match(M5);return N5(e,a)?[r,t[0]]:N5(e,o)?[r,t[1]]:[r,t[a!=null&&o!=null?2:1]]}return[r,s]}function zu(n,e,t){t==null&&(t={});var r="";switch(typeof n){case"string":n=="m/d/yy"&&t.dateNF?r=t.dateNF:r=n;break;case"number":n==14&&t.dateNF?r=t.dateNF:r=(t.table!=null?t.table:Gr)[n],r==null&&(r=t.table&&t.table[C5[n]]||Gr[C5[n]]),r==null&&(r=d1e[n]||"General");break}if(rw(r,0))return XR(e,t);e instanceof Date&&(e=kG(e,t.date1904));var i=P1e(r,e);if(rw(i[1]))return XR(e,t);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return k1e(i[1],e,t,i[0])}function GG(n,e){if(typeof e!="number"){e=+e||-1;for(var t=0;t<392;++t){if(Gr[t]==null){e<0&&(e=t);continue}if(Gr[t]==n){e=t;break}}e<0&&(e=391)}return Gr[e]=n,e}function VE(n){for(var e=0;e!=392;++e)n[e]!==void 0&&GG(n[e],e)}function GE(){Gr=h1e()}var BG=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function M1e(n){var e=typeof n=="number"?Gr[n]:n;return e=e.replace(BG,"(\\d+)"),new RegExp("^"+e+"$")}function N1e(n,e,t){var r=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(e.match(BG)||[]).forEach(function(f,m){var y=parseInt(t[m+1],10);switch(f.toLowerCase().charAt(0)){case"y":r=y;break;case"d":s=y;break;case"h":a=y;break;case"s":l=y;break;case"m":a>=0?o=y:i=y;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var c=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var h=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?c:r==-1&&i==-1&&s==-1?h:c+"T"+h}var L1e=(function(){var n={};n.version="1.2.0";function e(){for(var A=0,I=new Array(256),P=0;P!=256;++P)A=P,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,I[P]=A;return typeof Int32Array<"u"?new Int32Array(I):I}var t=e();function r(A){var I=0,P=0,D=0,L=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(D=0;D!=256;++D)L[D]=A[D];for(D=0;D!=256;++D)for(P=A[D],I=256+D;I<4096;I+=256)P=L[I]=P>>>8^A[P&255];var U=[];for(D=1;D!=16;++D)U[D-1]=typeof Int32Array<"u"?L.subarray(D*256,D*256+256):L.slice(D*256,D*256+256);return U}var i=r(t),s=i[0],a=i[1],o=i[2],l=i[3],c=i[4],h=i[5],f=i[6],m=i[7],y=i[8],x=i[9],_=i[10],w=i[11],S=i[12],b=i[13],R=i[14];function M(A,I){for(var P=I^-1,D=0,L=A.length;D<L;)P=P>>>8^t[(P^A.charCodeAt(D++))&255];return~P}function O(A,I){for(var P=I^-1,D=A.length-15,L=0;L<D;)P=R[A[L++]^P&255]^b[A[L++]^P>>8&255]^S[A[L++]^P>>16&255]^w[A[L++]^P>>>24]^_[A[L++]]^x[A[L++]]^y[A[L++]]^m[A[L++]]^f[A[L++]]^h[A[L++]]^c[A[L++]]^l[A[L++]]^o[A[L++]]^a[A[L++]]^s[A[L++]]^t[A[L++]];for(D+=15;L<D;)P=P>>>8^t[(P^A[L++])&255];return~P}function G(A,I){for(var P=I^-1,D=0,L=A.length,U=0,j=0;D<L;)U=A.charCodeAt(D++),U<128?P=P>>>8^t[(P^U)&255]:U<2048?(P=P>>>8^t[(P^(192|U>>6&31))&255],P=P>>>8^t[(P^(128|U&63))&255]):U>=55296&&U<57344?(U=(U&1023)+64,j=A.charCodeAt(D++)&1023,P=P>>>8^t[(P^(240|U>>8&7))&255],P=P>>>8^t[(P^(128|U>>2&63))&255],P=P>>>8^t[(P^(128|j>>6&15|(U&3)<<4))&255],P=P>>>8^t[(P^(128|j&63))&255]):(P=P>>>8^t[(P^(224|U>>12&15))&255],P=P>>>8^t[(P^(128|U>>6&63))&255],P=P>>>8^t[(P^(128|U&63))&255]);return~P}return n.table=t,n.bstr=M,n.buf=O,n.str=G,n})(),nr=(function(){var e={};e.version="1.2.1";function t(B,Y){for(var K=B.split("/"),q=Y.split("/"),J=0,Q=0,we=Math.min(K.length,q.length);J<we;++J){if(Q=K[J].length-q[J].length)return Q;if(K[J]!=q[J])return K[J]<q[J]?-1:1}return K.length-q.length}function r(B){if(B.charAt(B.length-1)=="/")return B.slice(0,-1).indexOf("/")===-1?B:r(B.slice(0,-1));var Y=B.lastIndexOf("/");return Y===-1?B:B.slice(0,Y+1)}function i(B){if(B.charAt(B.length-1)=="/")return i(B.slice(0,-1));var Y=B.lastIndexOf("/");return Y===-1?B:B.slice(Y+1)}function s(B,Y){typeof Y=="string"&&(Y=new Date(Y));var K=Y.getHours();K=K<<6|Y.getMinutes(),K=K<<5|Y.getSeconds()>>>1,B.write_shift(2,K);var q=Y.getFullYear()-1980;q=q<<4|Y.getMonth()+1,q=q<<5|Y.getDate(),B.write_shift(2,q)}function a(B){var Y=B.read_shift(2)&65535,K=B.read_shift(2)&65535,q=new Date,J=K&31;K>>>=5;var Q=K&15;K>>>=4,q.setMilliseconds(0),q.setFullYear(K+1980),q.setMonth(Q-1),q.setDate(J);var we=Y&31;Y>>>=5;var Le=Y&63;return Y>>>=6,q.setHours(Y),q.setMinutes(Le),q.setSeconds(we<<1),q}function o(B){aa(B,0);for(var Y={},K=0;B.l<=B.length-4;){var q=B.read_shift(2),J=B.read_shift(2),Q=B.l+J,we={};switch(q){case 21589:K=B.read_shift(1),K&1&&(we.mtime=B.read_shift(4)),J>5&&(K&2&&(we.atime=B.read_shift(4)),K&4&&(we.ctime=B.read_shift(4))),we.mtime&&(we.mt=new Date(we.mtime*1e3));break}B.l=Q,Y[q]=we}return Y}var l;function c(){return l||(l={})}function h(B,Y){if(B[0]==80&&B[1]==75)return Ft(B,Y);if((B[0]|32)==109&&(B[1]|32)==105)return je(B,Y);if(B.length<512)throw new Error("CFB file size "+B.length+" < 512");var K=3,q=512,J=0,Q=0,we=0,Le=0,ve=0,Se=[],Re=B.slice(0,512);aa(Re,0);var Xe=f(Re);switch(K=Xe[0],K){case 3:q=512;break;case 4:q=4096;break;case 0:if(Xe[1]==0)return Ft(B,Y);default:throw new Error("Major Version: Expected 3 or 4 saw "+K)}q!==512&&(Re=B.slice(0,q),aa(Re,28));var rt=B.slice(0,q);m(Re,K);var pt=Re.read_shift(4,"i");if(K===3&&pt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+pt);Re.l+=4,we=Re.read_shift(4,"i"),Re.l+=4,Re.chk("00100000","Mini Stream Cutoff Size: "),Le=Re.read_shift(4,"i"),J=Re.read_shift(4,"i"),ve=Re.read_shift(4,"i"),Q=Re.read_shift(4,"i");for(var qe=-1,Ye=0;Ye<109&&(qe=Re.read_shift(4,"i"),!(qe<0));++Ye)Se[Ye]=qe;var Xt=y(B,q);w(ve,Q,Xt,q,Se);var Gn=b(Xt,we,Se,q);Gn[we].name="!Directory",J>0&&Le!==j&&(Gn[Le].name="!MiniFAT"),Gn[Se[0]].name="!FAT",Gn.fat_addrs=Se,Gn.ssz=q;var Wn={},pr=[],Ya=[],_a=[];R(we,Gn,Xt,pr,J,Wn,Ya,Le),x(Ya,_a,pr),pr.shift();var Ys={FileIndex:Ya,FullPaths:_a};return Y&&Y.raw&&(Ys.raw={header:rt,sectors:Xt}),Ys}function f(B){if(B[B.l]==80&&B[B.l+1]==75)return[0,0];B.chk(Ee,"Header Signature: "),B.l+=16;var Y=B.read_shift(2,"u");return[B.read_shift(2,"u"),Y]}function m(B,Y){var K=9;switch(B.l+=2,K=B.read_shift(2)){case 9:if(Y!=3)throw new Error("Sector Shift: Expected 9 saw "+K);break;case 12:if(Y!=4)throw new Error("Sector Shift: Expected 12 saw "+K);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+K)}B.chk("0600","Mini Sector Shift: "),B.chk("000000000000","Reserved: ")}function y(B,Y){for(var K=Math.ceil(B.length/Y)-1,q=[],J=1;J<K;++J)q[J-1]=B.slice(J*Y,(J+1)*Y);return q[K-1]=B.slice(K*Y),q}function x(B,Y,K){for(var q=0,J=0,Q=0,we=0,Le=0,ve=K.length,Se=[],Re=[];q<ve;++q)Se[q]=Re[q]=q,Y[q]=K[q];for(;Le<Re.length;++Le)q=Re[Le],J=B[q].L,Q=B[q].R,we=B[q].C,Se[q]===q&&(J!==-1&&Se[J]!==J&&(Se[q]=Se[J]),Q!==-1&&Se[Q]!==Q&&(Se[q]=Se[Q])),we!==-1&&(Se[we]=q),J!==-1&&q!=Se[q]&&(Se[J]=Se[q],Re.lastIndexOf(J)<Le&&Re.push(J)),Q!==-1&&q!=Se[q]&&(Se[Q]=Se[q],Re.lastIndexOf(Q)<Le&&Re.push(Q));for(q=1;q<ve;++q)Se[q]===q&&(Q!==-1&&Se[Q]!==Q?Se[q]=Se[Q]:J!==-1&&Se[J]!==J&&(Se[q]=Se[J]));for(q=1;q<ve;++q)if(B[q].type!==0){if(Le=q,Le!=Se[Le])do Le=Se[Le],Y[q]=Y[Le]+"/"+Y[q];while(Le!==0&&Se[Le]!==-1&&Le!=Se[Le]);Se[q]=-1}for(Y[0]+="/",q=1;q<ve;++q)B[q].type!==2&&(Y[q]+="/")}function _(B,Y,K){for(var q=B.start,J=B.size,Q=[],we=q;K&&J>0&&we>=0;)Q.push(Y.slice(we*U,we*U+U)),J-=U,we=Fh(K,we*4);return Q.length===0?Ne(0):Wi(Q).slice(0,B.size)}function w(B,Y,K,q,J){var Q=j;if(B===j){if(Y!==0)throw new Error("DIFAT chain shorter than expected")}else if(B!==-1){var we=K[B],Le=(q>>>2)-1;if(!we)return;for(var ve=0;ve<Le&&(Q=Fh(we,ve*4))!==j;++ve)J.push(Q);w(Fh(we,q-4),Y-1,K,q,J)}}function S(B,Y,K,q,J){var Q=[],we=[];J||(J=[]);var Le=q-1,ve=0,Se=0;for(ve=Y;ve>=0;){J[ve]=!0,Q[Q.length]=ve,we.push(B[ve]);var Re=K[Math.floor(ve*4/q)];if(Se=ve*4&Le,q<4+Se)throw new Error("FAT boundary crossed: "+ve+" 4 "+q);if(!B[Re])break;ve=Fh(B[Re],Se)}return{nodes:Q,data:B5([we])}}function b(B,Y,K,q){var J=B.length,Q=[],we=[],Le=[],ve=[],Se=q-1,Re=0,Xe=0,rt=0,pt=0;for(Re=0;Re<J;++Re)if(Le=[],rt=Re+Y,rt>=J&&(rt-=J),!we[rt]){ve=[];var qe=[];for(Xe=rt;Xe>=0;){qe[Xe]=!0,we[Xe]=!0,Le[Le.length]=Xe,ve.push(B[Xe]);var Ye=K[Math.floor(Xe*4/q)];if(pt=Xe*4&Se,q<4+pt)throw new Error("FAT boundary crossed: "+Xe+" 4 "+q);if(!B[Ye]||(Xe=Fh(B[Ye],pt),qe[Xe]))break}Q[rt]={nodes:Le,data:B5([ve])}}return Q}function R(B,Y,K,q,J,Q,we,Le){for(var ve=0,Se=q.length?2:0,Re=Y[B].data,Xe=0,rt=0,pt;Xe<Re.length;Xe+=128){var qe=Re.slice(Xe,Xe+128);aa(qe,64),rt=qe.read_shift(2),pt=vk(qe,0,rt-Se),q.push(pt);var Ye={name:pt,type:qe.read_shift(1),color:qe.read_shift(1),L:qe.read_shift(4,"i"),R:qe.read_shift(4,"i"),C:qe.read_shift(4,"i"),clsid:qe.read_shift(16),state:qe.read_shift(4,"i"),start:0,size:0},Xt=qe.read_shift(2)+qe.read_shift(2)+qe.read_shift(2)+qe.read_shift(2);Xt!==0&&(Ye.ct=M(qe,qe.l-8));var Gn=qe.read_shift(2)+qe.read_shift(2)+qe.read_shift(2)+qe.read_shift(2);Gn!==0&&(Ye.mt=M(qe,qe.l-8)),Ye.start=qe.read_shift(4,"i"),Ye.size=qe.read_shift(4,"i"),Ye.size<0&&Ye.start<0&&(Ye.size=Ye.type=0,Ye.start=j,Ye.name=""),Ye.type===5?(ve=Ye.start,J>0&&ve!==j&&(Y[ve].name="!StreamData")):Ye.size>=4096?(Ye.storage="fat",Y[Ye.start]===void 0&&(Y[Ye.start]=S(K,Ye.start,Y.fat_addrs,Y.ssz)),Y[Ye.start].name=Ye.name,Ye.content=Y[Ye.start].data.slice(0,Ye.size)):(Ye.storage="minifat",Ye.size<0?Ye.size=0:ve!==j&&Ye.start!==j&&Y[ve]&&(Ye.content=_(Ye,Y[ve].data,(Y[Le]||{}).data))),Ye.content&&aa(Ye.content,0),Q[pt]=Ye,we.push(Ye)}}function M(B,Y){return new Date((ca(B,Y+4)/1e7*Math.pow(2,32)+ca(B,Y)/1e7-11644473600)*1e3)}function O(B,Y){return c(),h(l.readFileSync(B),Y)}function G(B,Y){var K=Y&&Y.type;switch(K||Dn&&Buffer.isBuffer(B)&&(K="buffer"),K||"base64"){case"file":return O(B,Y);case"base64":return h(mo(hc(B)),Y);case"binary":return h(mo(B),Y)}return h(B,Y)}function A(B,Y){var K=Y||{},q=K.root||"Root Entry";if(B.FullPaths||(B.FullPaths=[]),B.FileIndex||(B.FileIndex=[]),B.FullPaths.length!==B.FileIndex.length)throw new Error("inconsistent CFB structure");B.FullPaths.length===0&&(B.FullPaths[0]=q+"/",B.FileIndex[0]={name:q,type:5}),K.CLSID&&(B.FileIndex[0].clsid=K.CLSID),I(B)}function I(B){var Y="Sh33tJ5";if(!nr.find(B,"/"+Y)){var K=Ne(4);K[0]=55,K[1]=K[3]=50,K[2]=54,B.FileIndex.push({name:Y,type:2,content:K,size:4,L:69,R:69,C:69}),B.FullPaths.push(B.FullPaths[0]+Y),P(B)}}function P(B,Y){A(B);for(var K=!1,q=!1,J=B.FullPaths.length-1;J>=0;--J){var Q=B.FileIndex[J];switch(Q.type){case 0:q?K=!0:(B.FileIndex.pop(),B.FullPaths.pop());break;case 1:case 2:case 5:q=!0,isNaN(Q.R*Q.L*Q.C)&&(K=!0),Q.R>-1&&Q.L>-1&&Q.R==Q.L&&(K=!0);break;default:K=!0;break}}if(!(!K&&!Y)){var we=new Date(1987,1,19),Le=0,ve=Object.create?Object.create(null):{},Se=[];for(J=0;J<B.FullPaths.length;++J)ve[B.FullPaths[J]]=!0,B.FileIndex[J].type!==0&&Se.push([B.FullPaths[J],B.FileIndex[J]]);for(J=0;J<Se.length;++J){var Re=r(Se[J][0]);q=ve[Re],q||(Se.push([Re,{name:i(Re).replace("/",""),type:1,clsid:Be,ct:we,mt:we,content:null}]),ve[Re]=!0)}for(Se.sort(function(pt,qe){return t(pt[0],qe[0])}),B.FullPaths=[],B.FileIndex=[],J=0;J<Se.length;++J)B.FullPaths[J]=Se[J][0],B.FileIndex[J]=Se[J][1];for(J=0;J<Se.length;++J){var Xe=B.FileIndex[J],rt=B.FullPaths[J];if(Xe.name=i(rt).replace("/",""),Xe.L=Xe.R=Xe.C=-(Xe.color=1),Xe.size=Xe.content?Xe.content.length:0,Xe.start=0,Xe.clsid=Xe.clsid||Be,J===0)Xe.C=Se.length>1?1:-1,Xe.size=0,Xe.type=5;else if(rt.slice(-1)=="/"){for(Le=J+1;Le<Se.length&&r(B.FullPaths[Le])!=rt;++Le);for(Xe.C=Le>=Se.length?-1:Le,Le=J+1;Le<Se.length&&r(B.FullPaths[Le])!=r(rt);++Le);Xe.R=Le>=Se.length?-1:Le,Xe.type=1}else r(B.FullPaths[J+1]||"")==r(rt)&&(Xe.R=J+1),Xe.type=2}}}function D(B,Y){var K=Y||{};if(K.fileType=="mad")return He(B,K);switch(P(B),K.fileType){case"zip":return ut(B,K)}var q=(function(pt){for(var qe=0,Ye=0,Xt=0;Xt<pt.FileIndex.length;++Xt){var Gn=pt.FileIndex[Xt];if(Gn.content){var Wn=Gn.content.length;Wn>0&&(Wn<4096?qe+=Wn+63>>6:Ye+=Wn+511>>9)}}for(var pr=pt.FullPaths.length+3>>2,Ya=qe+7>>3,_a=qe+127>>7,Ys=Ya+Ye+pr+_a,Br=Ys+127>>7,Ec=Br<=109?0:Math.ceil((Br-109)/127);Ys+Br+Ec+127>>7>Br;)Ec=++Br<=109?0:Math.ceil((Br-109)/127);var br=[1,Ec,Br,_a,pr,Ye,qe,0];return pt.FileIndex[0].size=qe<<6,br[7]=(pt.FileIndex[0].start=br[0]+br[1]+br[2]+br[3]+br[4]+br[5])+(br[6]+7>>3),br})(B),J=Ne(q[7]<<9),Q=0,we=0;{for(Q=0;Q<8;++Q)J.write_shift(1,ke[Q]);for(Q=0;Q<8;++Q)J.write_shift(2,0);for(J.write_shift(2,62),J.write_shift(2,3),J.write_shift(2,65534),J.write_shift(2,9),J.write_shift(2,6),Q=0;Q<3;++Q)J.write_shift(2,0);for(J.write_shift(4,0),J.write_shift(4,q[2]),J.write_shift(4,q[0]+q[1]+q[2]+q[3]-1),J.write_shift(4,0),J.write_shift(4,4096),J.write_shift(4,q[3]?q[0]+q[1]+q[2]-1:j),J.write_shift(4,q[3]),J.write_shift(-4,q[1]?q[0]-1:j),J.write_shift(4,q[1]),Q=0;Q<109;++Q)J.write_shift(-4,Q<q[2]?q[1]+Q:-1)}if(q[1])for(we=0;we<q[1];++we){for(;Q<236+we*127;++Q)J.write_shift(-4,Q<q[2]?q[1]+Q:-1);J.write_shift(-4,we===q[1]-1?j:we+1)}var Le=function(pt){for(we+=pt;Q<we-1;++Q)J.write_shift(-4,Q+1);pt&&(++Q,J.write_shift(-4,j))};for(we=Q=0,we+=q[1];Q<we;++Q)J.write_shift(-4,Me.DIFSECT);for(we+=q[2];Q<we;++Q)J.write_shift(-4,Me.FATSECT);Le(q[3]),Le(q[4]);for(var ve=0,Se=0,Re=B.FileIndex[0];ve<B.FileIndex.length;++ve)Re=B.FileIndex[ve],Re.content&&(Se=Re.content.length,!(Se<4096)&&(Re.start=we,Le(Se+511>>9)));for(Le(q[6]+7>>3);J.l&511;)J.write_shift(-4,Me.ENDOFCHAIN);for(we=Q=0,ve=0;ve<B.FileIndex.length;++ve)Re=B.FileIndex[ve],Re.content&&(Se=Re.content.length,!(!Se||Se>=4096)&&(Re.start=we,Le(Se+63>>6)));for(;J.l&511;)J.write_shift(-4,Me.ENDOFCHAIN);for(Q=0;Q<q[4]<<2;++Q){var Xe=B.FullPaths[Q];if(!Xe||Xe.length===0){for(ve=0;ve<17;++ve)J.write_shift(4,0);for(ve=0;ve<3;++ve)J.write_shift(4,-1);for(ve=0;ve<12;++ve)J.write_shift(4,0);continue}Re=B.FileIndex[Q],Q===0&&(Re.start=Re.size?Re.start-1:j);var rt=Q===0&&K.root||Re.name;if(Se=2*(rt.length+1),J.write_shift(64,rt,"utf16le"),J.write_shift(2,Se),J.write_shift(1,Re.type),J.write_shift(1,Re.color),J.write_shift(-4,Re.L),J.write_shift(-4,Re.R),J.write_shift(-4,Re.C),Re.clsid)J.write_shift(16,Re.clsid,"hex");else for(ve=0;ve<4;++ve)J.write_shift(4,0);J.write_shift(4,Re.state||0),J.write_shift(4,0),J.write_shift(4,0),J.write_shift(4,0),J.write_shift(4,0),J.write_shift(4,Re.start),J.write_shift(4,Re.size),J.write_shift(4,0)}for(Q=1;Q<B.FileIndex.length;++Q)if(Re=B.FileIndex[Q],Re.size>=4096)if(J.l=Re.start+1<<9,Dn&&Buffer.isBuffer(Re.content))Re.content.copy(J,J.l,0,Re.size),J.l+=Re.size+511&-512;else{for(ve=0;ve<Re.size;++ve)J.write_shift(1,Re.content[ve]);for(;ve&511;++ve)J.write_shift(1,0)}for(Q=1;Q<B.FileIndex.length;++Q)if(Re=B.FileIndex[Q],Re.size>0&&Re.size<4096)if(Dn&&Buffer.isBuffer(Re.content))Re.content.copy(J,J.l,0,Re.size),J.l+=Re.size+63&-64;else{for(ve=0;ve<Re.size;++ve)J.write_shift(1,Re.content[ve]);for(;ve&63;++ve)J.write_shift(1,0)}if(Dn)J.l=J.length;else for(;J.l<J.length;)J.write_shift(1,0);return J}function L(B,Y){var K=B.FullPaths.map(function(ve){return ve.toUpperCase()}),q=K.map(function(ve){var Se=ve.split("/");return Se[Se.length-(ve.slice(-1)=="/"?2:1)]}),J=!1;Y.charCodeAt(0)===47?(J=!0,Y=K[0].slice(0,-1)+Y):J=Y.indexOf("/")!==-1;var Q=Y.toUpperCase(),we=J===!0?K.indexOf(Q):q.indexOf(Q);if(we!==-1)return B.FileIndex[we];var Le=!Q.match(Xx);for(Q=Q.replace(hp,""),Le&&(Q=Q.replace(Xx,"!")),we=0;we<K.length;++we)if((Le?K[we].replace(Xx,"!"):K[we]).replace(hp,"")==Q||(Le?q[we].replace(Xx,"!"):q[we]).replace(hp,"")==Q)return B.FileIndex[we];return null}var U=64,j=-2,Ee="d0cf11e0a1b11ae1",ke=[208,207,17,224,161,177,26,225],Be="00000000000000000000000000000000",Me={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:j,FREESECT:-1,HEADER_SIGNATURE:Ee,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Be,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ce(B,Y,K){c();var q=D(B,K);l.writeFileSync(Y,q)}function Pe(B){for(var Y=new Array(B.length),K=0;K<B.length;++K)Y[K]=String.fromCharCode(B[K]);return Y.join("")}function be(B,Y){var K=D(B,Y);switch(Y&&Y.type||"buffer"){case"file":return c(),l.writeFileSync(Y.filename,K),K;case"binary":return typeof K=="string"?K:Pe(K);case"base64":return cy(typeof K=="string"?K:Pe(K));case"buffer":if(Dn)return Buffer.isBuffer(K)?K:wc(K);case"array":return typeof K=="string"?mo(K):K}return K}var se;function V(B){try{var Y=B.InflateRaw,K=new Y;if(K._processChunk(new Uint8Array([3,0]),K._finishFlushFlag),K.bytesRead)se=B;else throw new Error("zlib does not expose bytesRead")}catch(q){console.error("cannot use native zlib: "+(q.message||q))}}function Z(B,Y){if(!se)return xe(B,Y);var K=se.InflateRaw,q=new K,J=q._processChunk(B.slice(B.l),q._finishFlushFlag);return B.l+=q.bytesRead,J}function te(B){return se?se.deflateRawSync(B):sn(B)}var ie=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ue=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Ve=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ge(B){var Y=(B<<1|B<<11)&139536|(B<<5|B<<15)&558144;return(Y>>16|Y>>8|Y)&255}for(var ye=typeof Uint8Array<"u",pe=ye?new Uint8Array(256):[],Fe=0;Fe<256;++Fe)pe[Fe]=Ge(Fe);function wt(B,Y){var K=pe[B&255];return Y<=8?K>>>8-Y:(K=K<<8|pe[B>>8&255],Y<=16?K>>>16-Y:(K=K<<8|pe[B>>16&255],K>>>24-Y))}function jt(B,Y){var K=Y&7,q=Y>>>3;return(B[q]|(K<=6?0:B[q+1]<<8))>>>K&3}function Dt(B,Y){var K=Y&7,q=Y>>>3;return(B[q]|(K<=5?0:B[q+1]<<8))>>>K&7}function Kt(B,Y){var K=Y&7,q=Y>>>3;return(B[q]|(K<=4?0:B[q+1]<<8))>>>K&15}function Qt(B,Y){var K=Y&7,q=Y>>>3;return(B[q]|(K<=3?0:B[q+1]<<8))>>>K&31}function ot(B,Y){var K=Y&7,q=Y>>>3;return(B[q]|(K<=1?0:B[q+1]<<8))>>>K&127}function tr(B,Y,K){var q=Y&7,J=Y>>>3,Q=(1<<K)-1,we=B[J]>>>q;return K<8-q||(we|=B[J+1]<<8-q,K<16-q)||(we|=B[J+2]<<16-q,K<24-q)||(we|=B[J+3]<<24-q),we&Q}function hn(B,Y,K){var q=Y&7,J=Y>>>3;return q<=5?B[J]|=(K&7)<<q:(B[J]|=K<<q&255,B[J+1]=(K&7)>>8-q),Y+3}function cn(B,Y,K){var q=Y&7,J=Y>>>3;return K=(K&1)<<q,B[J]|=K,Y+1}function sr(B,Y,K){var q=Y&7,J=Y>>>3;return K<<=q,B[J]|=K&255,K>>>=8,B[J+1]=K,Y+8}function Ni(B,Y,K){var q=Y&7,J=Y>>>3;return K<<=q,B[J]|=K&255,K>>>=8,B[J+1]=K&255,B[J+2]=K>>>8,Y+16}function Vn(B,Y){var K=B.length,q=2*K>Y?2*K:Y+5,J=0;if(K>=Y)return B;if(Dn){var Q=R5(q);if(B.copy)B.copy(Q);else for(;J<B.length;++J)Q[J]=B[J];return Q}else if(ye){var we=new Uint8Array(q);if(we.set)we.set(B);else for(;J<K;++J)we[J]=B[J];return we}return B.length=q,B}function Tr(B){for(var Y=new Array(B),K=0;K<B;++K)Y[K]=0;return Y}function oi(B,Y,K){var q=1,J=0,Q=0,we=0,Le=0,ve=B.length,Se=ye?new Uint16Array(32):Tr(32);for(Q=0;Q<32;++Q)Se[Q]=0;for(Q=ve;Q<K;++Q)B[Q]=0;ve=B.length;var Re=ye?new Uint16Array(ve):Tr(ve);for(Q=0;Q<ve;++Q)Se[J=B[Q]]++,q<J&&(q=J),Re[Q]=0;for(Se[0]=0,Q=1;Q<=q;++Q)Se[Q+16]=Le=Le+Se[Q-1]<<1;for(Q=0;Q<ve;++Q)Le=B[Q],Le!=0&&(Re[Q]=Se[Le+16]++);var Xe=0;for(Q=0;Q<ve;++Q)if(Xe=B[Q],Xe!=0)for(Le=wt(Re[Q],q)>>q-Xe,we=(1<<q+4-Xe)-1;we>=0;--we)Y[Le|we<<Xe]=Xe&15|Q<<4;return q}var _t=ye?new Uint16Array(512):Tr(512),pn=ye?new Uint16Array(32):Tr(32);if(!ye){for(var Rn=0;Rn<512;++Rn)_t[Rn]=0;for(Rn=0;Rn<32;++Rn)pn[Rn]=0}(function(){for(var B=[],Y=0;Y<32;Y++)B.push(5);oi(B,pn,32);var K=[];for(Y=0;Y<=143;Y++)K.push(8);for(;Y<=255;Y++)K.push(9);for(;Y<=279;Y++)K.push(7);for(;Y<=287;Y++)K.push(8);oi(K,_t,288)})();var Tt=(function(){for(var Y=ye?new Uint8Array(32768):[],K=0,q=0;K<Ve.length-1;++K)for(;q<Ve[K+1];++q)Y[q]=K;for(;q<32768;++q)Y[q]=29;var J=ye?new Uint8Array(259):[];for(K=0,q=0;K<ue.length-1;++K)for(;q<ue[K+1];++q)J[q]=K;function Q(Le,ve){for(var Se=0;Se<Le.length;){var Re=Math.min(65535,Le.length-Se),Xe=Se+Re==Le.length;for(ve.write_shift(1,+Xe),ve.write_shift(2,Re),ve.write_shift(2,~Re&65535);Re-- >0;)ve[ve.l++]=Le[Se++]}return ve.l}function we(Le,ve){for(var Se=0,Re=0,Xe=ye?new Uint16Array(32768):[];Re<Le.length;){var rt=Math.min(65535,Le.length-Re);if(rt<10){for(Se=hn(ve,Se,+(Re+rt==Le.length)),Se&7&&(Se+=8-(Se&7)),ve.l=Se/8|0,ve.write_shift(2,rt),ve.write_shift(2,~rt&65535);rt-- >0;)ve[ve.l++]=Le[Re++];Se=ve.l*8;continue}Se=hn(ve,Se,+(Re+rt==Le.length)+2);for(var pt=0;rt-- >0;){var qe=Le[Re];pt=(pt<<5^qe)&32767;var Ye=-1,Xt=0;if((Ye=Xe[pt])&&(Ye|=Re&-32768,Ye>Re&&(Ye-=32768),Ye<Re))for(;Le[Ye+Xt]==Le[Re+Xt]&&Xt<250;)++Xt;if(Xt>2){qe=J[Xt],qe<=22?Se=sr(ve,Se,pe[qe+1]>>1)-1:(sr(ve,Se,3),Se+=5,sr(ve,Se,pe[qe-23]>>5),Se+=3);var Gn=qe<8?0:qe-4>>2;Gn>0&&(Ni(ve,Se,Xt-ue[qe]),Se+=Gn),qe=Y[Re-Ye],Se=sr(ve,Se,pe[qe]>>3),Se-=3;var Wn=qe<4?0:qe-2>>1;Wn>0&&(Ni(ve,Se,Re-Ye-Ve[qe]),Se+=Wn);for(var pr=0;pr<Xt;++pr)Xe[pt]=Re&32767,pt=(pt<<5^Le[Re])&32767,++Re;rt-=Xt-1}else qe<=143?qe=qe+48:Se=cn(ve,Se,1),Se=sr(ve,Se,pe[qe]),Xe[pt]=Re&32767,++Re}Se=sr(ve,Se,0)-1}return ve.l=(Se+7)/8|0,ve.l}return function(ve,Se){return ve.length<8?Q(ve,Se):we(ve,Se)}})();function sn(B){var Y=Ne(50+Math.floor(B.length*1.1)),K=Tt(B,Y);return Y.slice(0,K)}var Nt=ye?new Uint16Array(32768):Tr(32768),qi=ye?new Uint16Array(32768):Tr(32768),Nr=ye?new Uint16Array(128):Tr(128),li=1,nn=1;function Sr(B,Y){var K=Qt(B,Y)+257;Y+=5;var q=Qt(B,Y)+1;Y+=5;var J=Kt(B,Y)+4;Y+=4;for(var Q=0,we=ye?new Uint8Array(19):Tr(19),Le=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ve=1,Se=ye?new Uint8Array(8):Tr(8),Re=ye?new Uint8Array(8):Tr(8),Xe=we.length,rt=0;rt<J;++rt)we[ie[rt]]=Q=Dt(B,Y),ve<Q&&(ve=Q),Se[Q]++,Y+=3;var pt=0;for(Se[0]=0,rt=1;rt<=ve;++rt)Re[rt]=pt=pt+Se[rt-1]<<1;for(rt=0;rt<Xe;++rt)(pt=we[rt])!=0&&(Le[rt]=Re[pt]++);var qe=0;for(rt=0;rt<Xe;++rt)if(qe=we[rt],qe!=0){pt=pe[Le[rt]]>>8-qe;for(var Ye=(1<<7-qe)-1;Ye>=0;--Ye)Nr[pt|Ye<<qe]=qe&7|rt<<3}var Xt=[];for(ve=1;Xt.length<K+q;)switch(pt=Nr[ot(B,Y)],Y+=pt&7,pt>>>=3){case 16:for(Q=3+jt(B,Y),Y+=2,pt=Xt[Xt.length-1];Q-- >0;)Xt.push(pt);break;case 17:for(Q=3+Dt(B,Y),Y+=3;Q-- >0;)Xt.push(0);break;case 18:for(Q=11+ot(B,Y),Y+=7;Q-- >0;)Xt.push(0);break;default:Xt.push(pt),ve<pt&&(ve=pt);break}var Gn=Xt.slice(0,K),Wn=Xt.slice(K);for(rt=K;rt<286;++rt)Gn[rt]=0;for(rt=q;rt<30;++rt)Wn[rt]=0;return li=oi(Gn,Nt,286),nn=oi(Wn,qi,30),Y}function De(B,Y){if(B[0]==3&&!(B[1]&3))return[Ed(Y),2];for(var K=0,q=0,J=R5(Y||1<<18),Q=0,we=J.length>>>0,Le=0,ve=0;(q&1)==0;){if(q=Dt(B,K),K+=3,q>>>1)q>>1==1?(Le=9,ve=5):(K=Sr(B,K),Le=li,ve=nn);else{K&7&&(K+=8-(K&7));var Se=B[K>>>3]|B[(K>>>3)+1]<<8;if(K+=32,Se>0)for(!Y&&we<Q+Se&&(J=Vn(J,Q+Se),we=J.length);Se-- >0;)J[Q++]=B[K>>>3],K+=8;continue}for(;;){!Y&&we<Q+32767&&(J=Vn(J,Q+32767),we=J.length);var Re=tr(B,K,Le),Xe=q>>>1==1?_t[Re]:Nt[Re];if(K+=Xe&15,Xe>>>=4,(Xe>>>8&255)===0)J[Q++]=Xe;else{if(Xe==256)break;Xe-=257;var rt=Xe<8?0:Xe-4>>2;rt>5&&(rt=0);var pt=Q+ue[Xe];rt>0&&(pt+=tr(B,K,rt),K+=rt),Re=tr(B,K,ve),Xe=q>>>1==1?pn[Re]:qi[Re],K+=Xe&15,Xe>>>=4;var qe=Xe<4?0:Xe-2>>1,Ye=Ve[Xe];for(qe>0&&(Ye+=tr(B,K,qe),K+=qe),!Y&&we<pt&&(J=Vn(J,pt+100),we=J.length);Q<pt;)J[Q]=J[Q-Ye],++Q}}}return Y?[J,K+7>>>3]:[J.slice(0,Q),K+7>>>3]}function xe(B,Y){var K=B.slice(B.l||0),q=De(K,Y);return B.l+=q[1],q[0]}function _e(B,Y){if(B)typeof console<"u"&&console.error(Y);else throw new Error(Y)}function Ft(B,Y){var K=B;aa(K,0);var q=[],J=[],Q={FileIndex:q,FullPaths:J};A(Q,{root:Y.root});for(var we=K.length-4;(K[we]!=80||K[we+1]!=75||K[we+2]!=5||K[we+3]!=6)&&we>=0;)--we;K.l=we+4,K.l+=4;var Le=K.read_shift(2);K.l+=6;var ve=K.read_shift(4);for(K.l=ve,we=0;we<Le;++we){K.l+=20;var Se=K.read_shift(4),Re=K.read_shift(4),Xe=K.read_shift(2),rt=K.read_shift(2),pt=K.read_shift(2);K.l+=8;var qe=K.read_shift(4),Ye=o(K.slice(K.l+Xe,K.l+Xe+rt));K.l+=Xe+rt+pt;var Xt=K.l;K.l=qe+4,N(K,Se,Re,Q,Ye),K.l=Xt}return Q}function N(B,Y,K,q,J){B.l+=2;var Q=B.read_shift(2),we=B.read_shift(2),Le=a(B);if(Q&8257)throw new Error("Unsupported ZIP encryption");for(var ve=B.read_shift(4),Se=B.read_shift(4),Re=B.read_shift(4),Xe=B.read_shift(2),rt=B.read_shift(2),pt="",qe=0;qe<Xe;++qe)pt+=String.fromCharCode(B[B.l++]);if(rt){var Ye=o(B.slice(B.l,B.l+rt));(Ye[21589]||{}).mt&&(Le=Ye[21589].mt),((J||{})[21589]||{}).mt&&(Le=J[21589].mt)}B.l+=rt;var Xt=B.slice(B.l,B.l+Se);switch(we){case 8:Xt=Z(B,Re);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+we)}var Gn=!1;Q&8&&(ve=B.read_shift(4),ve==134695760&&(ve=B.read_shift(4),Gn=!0),Se=B.read_shift(4),Re=B.read_shift(4)),Se!=Y&&_e(Gn,"Bad compressed size: "+Y+" != "+Se),Re!=K&&_e(Gn,"Bad uncompressed size: "+K+" != "+Re),Qe(q,pt,Xt,{unsafe:!0,mt:Le})}function ut(B,Y){var K=Y||{},q=[],J=[],Q=Ne(1),we=K.compression?8:0,Le=0,ve=0,Se=0,Re=0,Xe=0,rt=B.FullPaths[0],pt=rt,qe=B.FileIndex[0],Ye=[],Xt=0;for(ve=1;ve<B.FullPaths.length;++ve)if(pt=B.FullPaths[ve].slice(rt.length),qe=B.FileIndex[ve],!(!qe.size||!qe.content||pt=="Sh33tJ5")){var Gn=Re,Wn=Ne(pt.length);for(Se=0;Se<pt.length;++Se)Wn.write_shift(1,pt.charCodeAt(Se)&127);Wn=Wn.slice(0,Wn.l),Ye[Xe]=L1e.buf(qe.content,0);var pr=qe.content;we==8&&(pr=te(pr)),Q=Ne(30),Q.write_shift(4,67324752),Q.write_shift(2,20),Q.write_shift(2,Le),Q.write_shift(2,we),qe.mt?s(Q,qe.mt):Q.write_shift(4,0),Q.write_shift(-4,Ye[Xe]),Q.write_shift(4,pr.length),Q.write_shift(4,qe.content.length),Q.write_shift(2,Wn.length),Q.write_shift(2,0),Re+=Q.length,q.push(Q),Re+=Wn.length,q.push(Wn),Re+=pr.length,q.push(pr),Q=Ne(46),Q.write_shift(4,33639248),Q.write_shift(2,0),Q.write_shift(2,20),Q.write_shift(2,Le),Q.write_shift(2,we),Q.write_shift(4,0),Q.write_shift(-4,Ye[Xe]),Q.write_shift(4,pr.length),Q.write_shift(4,qe.content.length),Q.write_shift(2,Wn.length),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(4,0),Q.write_shift(4,Gn),Xt+=Q.l,J.push(Q),Xt+=Wn.length,J.push(Wn),++Xe}return Q=Ne(22),Q.write_shift(4,101010256),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(2,Xe),Q.write_shift(2,Xe),Q.write_shift(4,Xt),Q.write_shift(4,Re),Q.write_shift(2,0),Wi([Wi(q),Wi(J),Q])}var W={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function re(B,Y){if(B.ctype)return B.ctype;var K=B.name||"",q=K.match(/\.([^\.]+)$/);return q&&W[q[1]]||Y&&(q=(K=Y).match(/[\.\\]([^\.\\])+$/),q&&W[q[1]])?W[q[1]]:"application/octet-stream"}function ee(B){for(var Y=cy(B),K=[],q=0;q<Y.length;q+=76)K.push(Y.slice(q,q+76));return K.join(`\r
`)+`\r
`}function ne(B){var Y=B.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Se){var Re=Se.charCodeAt(0).toString(16).toUpperCase();return"="+(Re.length==1?"0"+Re:Re)});Y=Y.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Y.charAt(0)==`
`&&(Y="=0D"+Y.slice(1)),Y=Y.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var K=[],q=Y.split(`\r
`),J=0;J<q.length;++J){var Q=q[J];if(Q.length==0){K.push("");continue}for(var we=0;we<Q.length;){var Le=76,ve=Q.slice(we,we+Le);ve.charAt(Le-1)=="="?Le--:ve.charAt(Le-2)=="="?Le-=2:ve.charAt(Le-3)=="="&&(Le-=3),ve=Q.slice(we,we+Le),we+=Le,we<Q.length&&(ve+="="),K.push(ve)}}return K.join(`\r
`)}function he(B){for(var Y=[],K=0;K<B.length;++K){for(var q=B[K];K<=B.length&&q.charAt(q.length-1)=="=";)q=q.slice(0,q.length-1)+B[++K];Y.push(q)}for(var J=0;J<Y.length;++J)Y[J]=Y[J].replace(/[=][0-9A-Fa-f]{2}/g,function(Q){return String.fromCharCode(parseInt(Q.slice(1),16))});return mo(Y.join(`\r
`))}function Ce(B,Y,K){for(var q="",J="",Q="",we,Le=0;Le<10;++Le){var ve=Y[Le];if(!ve||ve.match(/^\s*$/))break;var Se=ve.match(/^(.*?):\s*([^\s].*)$/);if(Se)switch(Se[1].toLowerCase()){case"content-location":q=Se[2].trim();break;case"content-type":Q=Se[2].trim();break;case"content-transfer-encoding":J=Se[2].trim();break}}switch(++Le,J.toLowerCase()){case"base64":we=mo(hc(Y.slice(Le).join("")));break;case"quoted-printable":we=he(Y.slice(Le));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+J)}var Re=Qe(B,q.slice(K.length),we,{unsafe:!0});Q&&(Re.ctype=Q)}function je(B,Y){if(Pe(B.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var K=Y&&Y.root||"",q=(Dn&&Buffer.isBuffer(B)?B.toString("binary"):Pe(B)).split(`\r
`),J=0,Q="";for(J=0;J<q.length;++J)if(Q=q[J],!!/^Content-Location:/i.test(Q)&&(Q=Q.slice(Q.indexOf("file")),K||(K=Q.slice(0,Q.lastIndexOf("/")+1)),Q.slice(0,K.length)!=K))for(;K.length>0&&(K=K.slice(0,K.length-1),K=K.slice(0,K.lastIndexOf("/")+1),Q.slice(0,K.length)!=K););var we=(q[1]||"").match(/boundary="(.*?)"/);if(!we)throw new Error("MAD cannot find boundary");var Le="--"+(we[1]||""),ve=[],Se=[],Re={FileIndex:ve,FullPaths:Se};A(Re);var Xe,rt=0;for(J=0;J<q.length;++J){var pt=q[J];pt!==Le&&pt!==Le+"--"||(rt++&&Ce(Re,q.slice(Xe,J),K),Xe=J)}return Re}function He(B,Y){var K=Y||{},q=K.boundary||"SheetJS";q="------="+q;for(var J=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+q.slice(2)+'"',"","",""],Q=B.FullPaths[0],we=Q,Le=B.FileIndex[0],ve=1;ve<B.FullPaths.length;++ve)if(we=B.FullPaths[ve].slice(Q.length),Le=B.FileIndex[ve],!(!Le.size||!Le.content||we=="Sh33tJ5")){we=we.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Xt){return"_x"+Xt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Xt){return"_u"+Xt.charCodeAt(0).toString(16)+"_"});for(var Se=Le.content,Re=Dn&&Buffer.isBuffer(Se)?Se.toString("binary"):Pe(Se),Xe=0,rt=Math.min(1024,Re.length),pt=0,qe=0;qe<=rt;++qe)(pt=Re.charCodeAt(qe))>=32&&pt<128&&++Xe;var Ye=Xe>=rt*4/5;J.push(q),J.push("Content-Location: "+(K.root||"file:///C:/SheetJS/")+we),J.push("Content-Transfer-Encoding: "+(Ye?"quoted-printable":"base64")),J.push("Content-Type: "+re(Le,we)),J.push(""),J.push(Ye?ne(Re):ee(Re))}return J.push(q+`--\r
`),J.join(`\r
`)}function Je(B){var Y={};return A(Y,B),Y}function Qe(B,Y,K,q){var J=q&&q.unsafe;J||A(B);var Q=!J&&nr.find(B,Y);if(!Q){var we=B.FullPaths[0];Y.slice(0,we.length)==we?we=Y:(we.slice(-1)!="/"&&(we+="/"),we=(we+Y).replace("//","/")),Q={name:i(Y),type:2},B.FileIndex.push(Q),B.FullPaths.push(we),J||nr.utils.cfb_gc(B)}return Q.content=K,Q.size=K?K.length:0,q&&(q.CLSID&&(Q.clsid=q.CLSID),q.mt&&(Q.mt=q.mt),q.ct&&(Q.ct=q.ct)),Q}function xt(B,Y){A(B);var K=nr.find(B,Y);if(K){for(var q=0;q<B.FileIndex.length;++q)if(B.FileIndex[q]==K)return B.FileIndex.splice(q,1),B.FullPaths.splice(q,1),!0}return!1}function St(B,Y,K){A(B);var q=nr.find(B,Y);if(q){for(var J=0;J<B.FileIndex.length;++J)if(B.FileIndex[J]==q)return B.FileIndex[J].name=i(K),B.FullPaths[J]=K,!0}return!1}function An(B){P(B,!0)}return e.find=L,e.read=G,e.parse=h,e.write=be,e.writeFile=ce,e.utils={cfb_new:Je,cfb_add:Qe,cfb_del:xt,cfb_mov:St,cfb_gc:An,ReadShift:fp,CheckField:sB,prep_blob:aa,bconcat:Wi,use_zlib:V,_deflateRaw:sn,_inflateRaw:xe,consts:Me},e})();function O1e(n){return typeof n=="string"?jE(n):Array.isArray(n)?o1e(n):n}function o1(n,e,t){if(typeof Deno<"u"){if(t&&typeof e=="string")switch(t){case"utf8":e=new TextEncoder(t).encode(e);break;case"binary":e=jE(e);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(n,e)}var r=t=="utf8"?hy(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(r,n);if(typeof Blob<"u"){var i=new Blob([O1e(r)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,n);if(typeof saveAs<"u")return saveAs(i,n);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:n,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=n,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(n);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=a1(e)),o.write(e),o.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+n)}function Xi(n){for(var e=Object.keys(n),t=[],r=0;r<e.length;++r)Object.prototype.hasOwnProperty.call(n,e[r])&&t.push(e[r]);return t}function L5(n,e){for(var t=[],r=Xi(n),i=0;i!==r.length;++i)t[n[r[i]][e]]==null&&(t[n[r[i]][e]]=r[i]);return t}function pk(n){for(var e=[],t=Xi(n),r=0;r!==t.length;++r)e[n[t[r]]]=t[r];return e}function BE(n){for(var e=[],t=Xi(n),r=0;r!==t.length;++r)e[n[t[r]]]=parseInt(t[r],10);return e}function D1e(n){for(var e=[],t=Xi(n),r=0;r!==t.length;++r)e[n[t[r]]]==null&&(e[n[t[r]]]=[]),e[n[t[r]]].push(t[r]);return e}var sw=new Date(1899,11,30,0,0,0);function Ks(n,e){var t=n.getTime(),r=sw.getTime()+(n.getTimezoneOffset()-sw.getTimezoneOffset())*6e4;return(t-r)/(1440*60*1e3)}var zG=new Date,F1e=sw.getTime()+(zG.getTimezoneOffset()-sw.getTimezoneOffset())*6e4,O5=zG.getTimezoneOffset();function UG(n){var e=new Date;return e.setTime(n*24*60*60*1e3+F1e),e.getTimezoneOffset()!==O5&&e.setTime(e.getTime()+(e.getTimezoneOffset()-O5)*6e4),e}var D5=new Date("2017-02-19T19:06:09.000Z"),$G=isNaN(D5.getFullYear())?new Date("2/19/17"):D5,j1e=$G.getFullYear()==2017;function Rs(n,e){var t=new Date(n);if(j1e)return e>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):e<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(n instanceof Date)return n;if($G.getFullYear()==1917&&!isNaN(t.getFullYear())){var r=t.getFullYear();return n.indexOf(""+r)>-1||t.setFullYear(t.getFullYear()+100),t}var i=n.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return n.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function zE(n,e){if(Dn&&Buffer.isBuffer(n))return n.toString("binary");if(typeof TextDecoder<"u")try{var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(n)&&(n=new Uint8Array(n)),new TextDecoder("latin1").decode(n).replace(/[]/g,function(s){return t[s]||s})}catch{}for(var r=[],i=0;i!=n.length;++i)r.push(String.fromCharCode(n[i]));return r.join("")}function Xs(n){if(typeof JSON<"u"&&!Array.isArray(n))return JSON.parse(JSON.stringify(n));if(typeof n!="object"||n==null)return n;if(n instanceof Date)return new Date(n.getTime());var e={};for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=Xs(n[t]));return e}function jr(n,e){for(var t="";t.length<e;)t+=n;return t}function tc(n){var e=Number(n);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(n))return e;var t=1,r=n.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(e=Number(r))||(r=r.replace(/[(](.*)[)]/,function(i,s){return t=-t,s}),!isNaN(e=Number(r)))?e/t:e}var V1e=["january","february","march","april","may","june","july","august","september","october","november","december"];function uy(n){var e=new Date(n),t=new Date(NaN),r=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return t;var a=n.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&V1e.indexOf(a)==-1)return t}else if(a.match(/[a-z]/))return t;return r<0||r>8099?t:(i>0||s>1)&&r!=101?e:n.match(/[^-0-9:,\/\\]/)?t:e}function on(n,e,t){if(n.FullPaths){if(typeof t=="string"){var r;return Dn?r=wc(t):r=l1e(t),nr.utils.cfb_add(n,e,r)}nr.utils.cfb_add(n,e,t)}else n.file(e,t)}function yk(){return nr.utils.cfb_new()}var ai=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,G1e={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},xk=pk(G1e),_k=/[&<>'"]/g,B1e=/[\u0000-\u0008\u000b-\u001f]/g;function Jn(n){var e=n+"";return e.replace(_k,function(t){return xk[t]}).replace(B1e,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function F5(n){return Jn(n).replace(/ /g,"_x0020_")}var WG=/[\u0000-\u001f]/g;function z1e(n){var e=n+"";return e.replace(_k,function(t){return xk[t]}).replace(/\n/g,"<br/>").replace(WG,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function U1e(n){var e=n+"";return e.replace(_k,function(t){return xk[t]}).replace(WG,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}function $1e(n){return n.replace(/(\r\n|[\r\n])/g,"&#10;")}function W1e(n){switch(n){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function BS(n){for(var e="",t=0,r=0,i=0,s=0,a=0,o=0;t<n.length;){if(r=n.charCodeAt(t++),r<128){e+=String.fromCharCode(r);continue}if(i=n.charCodeAt(t++),r>191&&r<224){a=(r&31)<<6,a|=i&63,e+=String.fromCharCode(a);continue}if(s=n.charCodeAt(t++),r<240){e+=String.fromCharCode((r&15)<<12|(i&63)<<6|s&63);continue}a=n.charCodeAt(t++),o=((r&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function j5(n){var e=Ed(2*n.length),t,r,i=1,s=0,a=0,o;for(r=0;r<n.length;r+=i)i=1,(o=n.charCodeAt(r))<128?t=o:o<224?(t=(o&31)*64+(n.charCodeAt(r+1)&63),i=2):o<240?(t=(o&15)*4096+(n.charCodeAt(r+1)&63)*64+(n.charCodeAt(r+2)&63),i=3):(i=4,t=(o&7)*262144+(n.charCodeAt(r+1)&63)*4096+(n.charCodeAt(r+2)&63)*64+(n.charCodeAt(r+3)&63),t-=65536,a=55296+(t>>>10&1023),t=56320+(t&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=t%256,e[s++]=t>>>8;return e.slice(0,s).toString("ucs2")}function V5(n){return wc(n,"binary").toString("utf8")}var Yx="foo bar baz",dp=Dn&&(V5(Yx)==BS(Yx)&&V5||j5(Yx)==BS(Yx)&&j5)||BS,hy=Dn?function(n){return wc(n,"utf8").toString("binary")}:function(n){for(var e=[],t=0,r=0,i=0;t<n.length;)switch(r=n.charCodeAt(t++),!0){case r<128:e.push(String.fromCharCode(r));break;case r<2048:e.push(String.fromCharCode(192+(r>>6))),e.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,i=n.charCodeAt(t++)-56320+(r<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(r>>12))),e.push(String.fromCharCode(128+(r>>6&63))),e.push(String.fromCharCode(128+(r&63)))}return e.join("")},H1e=(function(){var n=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var r=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<n.length;++i)r=r.replace(n[i][0],n[i][1]);return r}})(),HG=/(^\s|\s$|\n)/;function Hi(n,e){return"<"+n+(e.match(HG)?' xml:space="preserve"':"")+">"+e+"</"+n+">"}function dy(n){return Xi(n).map(function(e){return" "+e+'="'+n[e]+'"'}).join("")}function it(n,e,t){return"<"+n+(t!=null?dy(t):"")+(e!=null?(e.match(HG)?' xml:space="preserve"':"")+">"+e+"</"+n:"/")+">"}function qR(n,e){try{return n.toISOString().replace(/\.\d*/,"")}catch(t){if(e)throw t}return""}function K1e(n,e){switch(typeof n){case"string":var t=it("vt:lpwstr",Jn(n));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return it((n|0)==n?"vt:i4":"vt:r8",Jn(String(n)));case"boolean":return it("vt:bool",n?"true":"false")}if(n instanceof Date)return it("vt:filetime",qR(n));throw new Error("Unable to serialize "+n)}var Ai={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},vg=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],la={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function X1e(n,e){for(var t=1-2*(n[e+7]>>>7),r=((n[e+7]&127)<<4)+(n[e+6]>>>4&15),i=n[e+6]&15,s=5;s>=0;--s)i=i*256+n[e+s];return r==2047?i==0?t*(1/0):NaN:(r==0?r=-1022:(r-=1023,i+=Math.pow(2,52)),t*Math.pow(2,r-52)*i)}function q1e(n,e,t){var r=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,a=r?-e:e;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)n[t+o]=s&255;n[t+6]=(i&15)<<4|s&15,n[t+7]=i>>4|r}var G5=function(n){for(var e=[],t=10240,r=0;r<n[0].length;++r)if(n[0][r])for(var i=0,s=n[0][r].length;i<s;i+=t)e.push.apply(e,n[0][r].slice(i,i+t));return e},B5=Dn?function(n){return n[0].length>0&&Buffer.isBuffer(n[0][0])?Buffer.concat(n[0].map(function(e){return Buffer.isBuffer(e)?e:wc(e)})):G5(n)}:G5,z5=function(n,e,t){for(var r=[],i=e;i<t;i+=2)r.push(String.fromCharCode(Fm(n,i)));return r.join("").replace(hp,"")},vk=Dn?function(n,e,t){return Buffer.isBuffer(n)?n.toString("utf16le",e,t).replace(hp,""):z5(n,e,t)}:z5,U5=function(n,e,t){for(var r=[],i=e;i<e+t;++i)r.push(("0"+n[i].toString(16)).slice(-2));return r.join("")},KG=Dn?function(n,e,t){return Buffer.isBuffer(n)?n.toString("hex",e,e+t):U5(n,e,t)}:U5,$5=function(n,e,t){for(var r=[],i=e;i<t;i++)r.push(String.fromCharCode(t0(n,i)));return r.join("")},l1=Dn?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf8",t,r):$5(e,t,r)}:$5,XG=function(n,e){var t=ca(n,e);return t>0?l1(n,e+4,e+4+t-1):""},qG=XG,YG=function(n,e){var t=ca(n,e);return t>0?l1(n,e+4,e+4+t-1):""},ZG=YG,JG=function(n,e){var t=2*ca(n,e);return t>0?l1(n,e+4,e+4+t-1):""},QG=JG,eB=function(e,t){var r=ca(e,t);return r>0?vk(e,t+4,t+4+r):""},tB=eB,nB=function(n,e){var t=ca(n,e);return t>0?l1(n,e+4,e+4+t):""},rB=nB,iB=function(n,e){return X1e(n,e)},aw=iB,wk=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Dn&&(qG=function(e,t){if(!Buffer.isBuffer(e))return XG(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},ZG=function(e,t){if(!Buffer.isBuffer(e))return YG(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},QG=function(e,t){if(!Buffer.isBuffer(e))return JG(e,t);var r=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r-1)},tB=function(e,t){if(!Buffer.isBuffer(e))return eB(e,t);var r=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r)},rB=function(e,t){if(!Buffer.isBuffer(e))return nB(e,t);var r=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+r)},aw=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):iB(e,t)},wk=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var t0=function(n,e){return n[e]},Fm=function(n,e){return n[e+1]*256+n[e]},Y1e=function(n,e){var t=n[e+1]*256+n[e];return t<32768?t:(65535-t+1)*-1},ca=function(n,e){return n[e+3]*(1<<24)+(n[e+2]<<16)+(n[e+1]<<8)+n[e]},Fh=function(n,e){return n[e+3]<<24|n[e+2]<<16|n[e+1]<<8|n[e]},Z1e=function(n,e){return n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3]};function fp(n,e){var t="",r,i,s=[],a,o,l,c;switch(e){case"dbcs":if(c=this.l,Dn&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*n).toString("utf16le");else for(l=0;l<n;++l)t+=String.fromCharCode(Fm(this,c)),c+=2;n*=2;break;case"utf8":t=l1(this,this.l,this.l+n);break;case"utf16le":n*=2,t=vk(this,this.l,this.l+n);break;case"wstr":return fp.call(this,n,"dbcs");case"lpstr-ansi":t=qG(this,this.l),n=4+ca(this,this.l);break;case"lpstr-cp":t=ZG(this,this.l),n=4+ca(this,this.l);break;case"lpwstr":t=QG(this,this.l),n=4+2*ca(this,this.l);break;case"lpp4":n=4+ca(this,this.l),t=tB(this,this.l),n&2&&(n+=2);break;case"8lpp4":n=4+ca(this,this.l),t=rB(this,this.l),n&3&&(n+=4-(n&3));break;case"cstr":for(n=0,t="";(a=t0(this,this.l+n++))!==0;)s.push(Kx(a));t=s.join("");break;case"_wstr":for(n=0,t="";(a=Fm(this,this.l+n))!==0;)s.push(Kx(a)),n+=2;n+=2,t=s.join("");break;case"dbcs-cont":for(t="",c=this.l,l=0;l<n;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=t0(this,c),this.l=c+1,o=fp.call(this,n-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Kx(Fm(this,c))),c+=2}t=s.join(""),n*=2;break;case"cpstr":case"sbcs-cont":for(t="",c=this.l,l=0;l!=n;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=t0(this,c),this.l=c+1,o=fp.call(this,n-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Kx(t0(this,c))),c+=1}t=s.join("");break;default:switch(n){case 1:return r=t0(this,this.l),this.l++,r;case 2:return r=(e==="i"?Y1e:Fm)(this,this.l),this.l+=2,r;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(r=(n>0?Fh:Z1e)(this,this.l),this.l+=4,r):(i=ca(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return n==8?i=aw(this,this.l):i=aw([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;n=8;case 16:t=KG(this,this.l,n);break}}return this.l+=n,t}var J1e=function(n,e,t){n[t]=e&255,n[t+1]=e>>>8&255,n[t+2]=e>>>16&255,n[t+3]=e>>>24&255},Q1e=function(n,e,t){n[t]=e&255,n[t+1]=e>>8&255,n[t+2]=e>>16&255,n[t+3]=e>>24&255},exe=function(n,e,t){n[t]=e&255,n[t+1]=e>>>8&255};function txe(n,e,t){var r=0,i=0;if(t==="dbcs"){for(i=0;i!=e.length;++i)exe(this,e.charCodeAt(i),this.l+2*i);r=2*e.length}else if(t==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;r=e.length}else if(t==="hex"){for(;i<n;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(t==="utf16le"){var s=Math.min(this.l+n,this.length);for(i=0;i<Math.min(e.length,n);++i){var a=e.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(n){case 1:r=1,this[this.l]=e&255;break;case 2:r=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:r=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:r=4,J1e(this,e,this.l);break;case 8:if(r=8,t==="f"){q1e(this,e,this.l);break}case 16:break;case-4:r=4,Q1e(this,e,this.l);break}return this.l+=r,this}function sB(n,e){var t=KG(this,this.l,n.length>>1);if(t!==n)throw new Error(e+"Expected "+n+" saw "+t);this.l+=n.length>>1}function aa(n,e){n.l=e,n.read_shift=fp,n.chk=sB,n.write_shift=txe}function ml(n,e){n.l+=e}function Ne(n){var e=Ed(n);return aa(e,0),e}function zs(){var n=[],e=Dn?256:2048,t=function(c){var h=Ne(c);return aa(h,0),h},r=t(e),i=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&n.push(r),r=null)},s=function(c){return r&&c<r.length-r.l?r:(i(),r=t(Math.max(c+1,e)))},a=function(){return i(),Wi(n)},o=function(c){i(),r=c,r.l==null&&(r.l=r.length),s(e)};return{next:s,push:o,end:a,_bufs:n}}function Ue(n,e,t,r){var i=+e,s;if(!isNaN(i)){r||(r=X2e[i].p||(t||[]).length||0),s=1+(i>=128?1:0)+1,r>=128&&++s,r>=16384&&++s,r>=2097152&&++s;var a=n.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(r>=128)a.write_shift(1,(r&127)+128),r>>=7;else{a.write_shift(1,r);break}r>0&&wk(t)&&n.push(t)}}function gp(n,e,t){var r=Xs(n);if(e.s?(r.cRel&&(r.c+=e.s.c),r.rRel&&(r.r+=e.s.r)):(r.cRel&&(r.c+=e.c),r.rRel&&(r.r+=e.r)),!t||t.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function W5(n,e,t){var r=Xs(n);return r.s=gp(r.s,e.s,t),r.e=gp(r.e,e.s,t),r}function mp(n,e){if(n.cRel&&n.c<0)for(n=Xs(n);n.c<0;)n.c+=e>8?16384:256;if(n.rRel&&n.r<0)for(n=Xs(n);n.r<0;)n.r+=e>8?1048576:e>5?65536:16384;var t=er(n);return!n.cRel&&n.cRel!=null&&(t=ixe(t)),!n.rRel&&n.rRel!=null&&(t=nxe(t)),t}function zS(n,e){return n.s.r==0&&!n.s.rRel&&n.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!n.e.rRel?(n.s.cRel?"":"$")+fs(n.s.c)+":"+(n.e.cRel?"":"$")+fs(n.e.c):n.s.c==0&&!n.s.cRel&&n.e.c==(e.biff>=12?16383:255)&&!n.e.cRel?(n.s.rRel?"":"$")+Ki(n.s.r)+":"+(n.e.rRel?"":"$")+Ki(n.e.r):mp(n.s,e.biff)+":"+mp(n.e,e.biff)}function Ek(n){return parseInt(rxe(n),10)-1}function Ki(n){return""+(n+1)}function nxe(n){return n.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function rxe(n){return n.replace(/\$(\d+)$/,"$1")}function Tk(n){for(var e=sxe(n),t=0,r=0;r!==e.length;++r)t=26*t+e.charCodeAt(r)-64;return t-1}function fs(n){if(n<0)throw new Error("invalid column "+n);var e="";for(++n;n;n=Math.floor((n-1)/26))e=String.fromCharCode((n-1)%26+65)+e;return e}function ixe(n){return n.replace(/^([A-Z])/,"$$$1")}function sxe(n){return n.replace(/^\$([A-Z])/,"$1")}function axe(n){return n.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ki(n){for(var e=0,t=0,r=0;r<n.length;++r){var i=n.charCodeAt(r);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(t=26*t+(i-64))}return{c:t-1,r:e-1}}function er(n){for(var e=n.c+1,t="";e;e=(e-1)/26|0)t=String.fromCharCode((e-1)%26+65)+t;return t+(n.r+1)}function xa(n){var e=n.indexOf(":");return e==-1?{s:ki(n),e:ki(n)}:{s:ki(n.slice(0,e)),e:ki(n.slice(e+1))}}function ri(n,e){return typeof e>"u"||typeof e=="number"?ri(n.s,n.e):(typeof n!="string"&&(n=er(n)),typeof e!="string"&&(e=er(e)),n==e?n:n+":"+e)}function mr(n){var e={s:{c:0,r:0},e:{c:0,r:0}},t=0,r=0,i=0,s=n.length;for(t=0;r<s&&!((i=n.charCodeAt(r)-64)<1||i>26);++r)t=26*t+i;for(e.s.c=--t,t=0;r<s&&!((i=n.charCodeAt(r)-48)<0||i>9);++r)t=10*t+i;if(e.s.r=--t,r===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++r,t=0;r!=s&&!((i=n.charCodeAt(r)-64)<1||i>26);++r)t=26*t+i;for(e.e.c=--t,t=0;r!=s&&!((i=n.charCodeAt(r)-48)<0||i>9);++r)t=10*t+i;return e.e.r=--t,e}function H5(n,e){var t=n.t=="d"&&e instanceof Date;if(n.z!=null)try{return n.w=zu(n.z,t?Ks(e):e)}catch{}try{return n.w=zu((n.XF||{}).numFmtId||(t?14:0),t?Ks(e):e)}catch{return""+e}}function dc(n,e,t){return n==null||n.t==null||n.t=="z"?"":n.w!==void 0?n.w:(n.t=="d"&&!n.z&&t&&t.dateNF&&(n.z=t.dateNF),n.t=="e"?c1[n.v]||n.v:e==null?H5(n,n.v):H5(n,e))}function jd(n,e){var t=e&&e.sheet?e.sheet:"Sheet1",r={};return r[t]=n,{SheetNames:[t],Sheets:r}}function aB(n,e,t){var r=t||{},i=n?Array.isArray(n):r.dense,s=n||(i?[]:{}),a=0,o=0;if(s&&r.origin!=null){if(typeof r.origin=="number")a=r.origin;else{var l=typeof r.origin=="string"?ki(r.origin):r.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var h=mr(s["!ref"]);c.s.c=h.s.c,c.s.r=h.s.r,c.e.c=Math.max(c.e.c,h.e.c),c.e.r=Math.max(c.e.r,h.e.r),a==-1&&(c.e.r=a=h.e.r+1)}for(var f=0;f!=e.length;++f)if(e[f]){if(!Array.isArray(e[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=e[f].length;++m)if(!(typeof e[f][m]>"u")){var y={v:e[f][m]},x=a+f,_=o+m;if(c.s.r>x&&(c.s.r=x),c.s.c>_&&(c.s.c=_),c.e.r<x&&(c.e.r=x),c.e.c<_&&(c.e.c=_),e[f][m]&&typeof e[f][m]=="object"&&!Array.isArray(e[f][m])&&!(e[f][m]instanceof Date))y=e[f][m];else if(Array.isArray(y.v)&&(y.f=e[f][m][1],y.v=y.v[0]),y.v===null)if(y.f)y.t="n";else if(r.nullError)y.t="e",y.v=0;else if(r.sheetStubs)y.t="z";else continue;else typeof y.v=="number"?y.t="n":typeof y.v=="boolean"?y.t="b":y.v instanceof Date?(y.z=r.dateNF||Gr[14],r.cellDates?(y.t="d",y.w=zu(y.z,Ks(y.v))):(y.t="n",y.v=Ks(y.v),y.w=zu(y.z,y.v))):y.t="s";if(i)s[x]||(s[x]=[]),s[x][_]&&s[x][_].z&&(y.z=s[x][_].z),s[x][_]=y;else{var w=er({c:_,r:x});s[w]&&s[w].z&&(y.z=s[w].z),s[w]=y}}}return c.s.c<1e7&&(s["!ref"]=ri(c)),s}function wg(n,e){return aB(null,n,e)}function oxe(n){return n.read_shift(4,"i")}function To(n,e){return e||(e=Ne(4)),e.write_shift(4,n),e}function gs(n){var e=n.read_shift(4);return e===0?"":n.read_shift(e,"dbcs")}function Pi(n,e){var t=!1;return e==null&&(t=!0,e=Ne(4+2*n.length)),e.write_shift(4,n.length),n.length>0&&e.write_shift(0,n,"dbcs"),t?e.slice(0,e.l):e}function lxe(n){return{ich:n.read_shift(2),ifnt:n.read_shift(2)}}function cxe(n,e){return e||(e=Ne(4)),e.write_shift(2,0),e.write_shift(2,0),e}function Sk(n,e){var t=n.l,r=n.read_shift(1),i=gs(n),s=[],a={t:i,h:i};if((r&1)!==0){for(var o=n.read_shift(4),l=0;l!=o;++l)s.push(lxe(n));a.r=s}else a.r=[{ich:0,ifnt:0}];return n.l=t+e,a}function uxe(n,e){var t=!1;return e==null&&(t=!0,e=Ne(15+4*n.t.length)),e.write_shift(1,0),Pi(n.t,e),t?e.slice(0,e.l):e}var hxe=Sk;function dxe(n,e){var t=!1;return e==null&&(t=!0,e=Ne(23+4*n.t.length)),e.write_shift(1,1),Pi(n.t,e),e.write_shift(4,1),cxe({},e),t?e.slice(0,e.l):e}function qa(n){var e=n.read_shift(4),t=n.read_shift(2);return t+=n.read_shift(1)<<16,n.l++,{c:e,iStyleRef:t}}function Vd(n,e){return e==null&&(e=Ne(8)),e.write_shift(-4,n.c),e.write_shift(3,n.iStyleRef||n.s),e.write_shift(1,0),e}function Gd(n){var e=n.read_shift(2);return e+=n.read_shift(1)<<16,n.l++,{c:-1,iStyleRef:e}}function Bd(n,e){return e==null&&(e=Ne(4)),e.write_shift(3,n.iStyleRef||n.s),e.write_shift(1,0),e}var fxe=gs,oB=Pi;function bk(n){var e=n.read_shift(4);return e===0||e===4294967295?"":n.read_shift(e,"dbcs")}function ow(n,e){var t=!1;return e==null&&(t=!0,e=Ne(127)),e.write_shift(4,n.length>0?n.length:4294967295),n.length>0&&e.write_shift(0,n,"dbcs"),t?e.slice(0,e.l):e}var gxe=gs,YR=bk,Rk=ow;function lB(n){var e=n.slice(n.l,n.l+4),t=e[0]&1,r=e[0]&2;n.l+=4;var i=r===0?aw([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Fh(e,0)>>2;return t?i/100:i}function cB(n,e){e==null&&(e=Ne(4));var t=0,r=0,i=n*100;if(n==(n|0)&&n>=-536870912&&n<1<<29?r=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(r=1,t=1),r)e.write_shift(-4,((t?i:n)<<2)+(t+2));else throw new Error("unsupported RkNumber "+n)}function uB(n){var e={s:{},e:{}};return e.s.r=n.read_shift(4),e.e.r=n.read_shift(4),e.s.c=n.read_shift(4),e.e.c=n.read_shift(4),e}function mxe(n,e){return e||(e=Ne(16)),e.write_shift(4,n.s.r),e.write_shift(4,n.e.r),e.write_shift(4,n.s.c),e.write_shift(4,n.e.c),e}var zd=uB,Eg=mxe;function Tg(n){if(n.length-n.l<8)throw"XLS Xnum Buffer underflow";return n.read_shift(8,"f")}function Td(n,e){return(e||Ne(8)).write_shift(8,n,"f")}function pxe(n){var e={},t=n.read_shift(1),r=t>>>1,i=n.read_shift(1),s=n.read_shift(2,"i"),a=n.read_shift(1),o=n.read_shift(1),l=n.read_shift(1);switch(n.l++,r){case 0:e.auto=1;break;case 1:e.index=i;var c=bxe[i];c&&(e.rgb=rD(c));break;case 2:e.rgb=rD([a,o,l]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function lw(n,e){if(e||(e=Ne(8)),!n||n.auto)return e.write_shift(4,0),e.write_shift(4,0),e;n.index!=null?(e.write_shift(1,2),e.write_shift(1,n.index)):n.theme!=null?(e.write_shift(1,6),e.write_shift(1,n.theme)):(e.write_shift(1,5),e.write_shift(1,0));var t=n.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),e.write_shift(2,t),!n.rgb||n.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var r=n.rgb||"FFFFFF";typeof r=="number"&&(r=("000000"+r.toString(16)).slice(-6)),e.write_shift(1,parseInt(r.slice(0,2),16)),e.write_shift(1,parseInt(r.slice(2,4),16)),e.write_shift(1,parseInt(r.slice(4,6),16)),e.write_shift(1,255)}return e}function yxe(n){var e=n.read_shift(1);n.l++;var t={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return t}function xxe(n,e){e||(e=Ne(2));var t=(n.italic?2:0)|(n.strike?8:0)|(n.outline?16:0)|(n.shadow?32:0)|(n.condense?64:0)|(n.extend?128:0);return e.write_shift(1,t),e.write_shift(1,0),e}var hB=2,ia=3,Zx=11,cw=19,Jx=64,_xe=65,vxe=71,wxe=4108,Exe=4126,zi=80,K5={1:{n:"CodePage",t:hB},2:{n:"Category",t:zi},3:{n:"PresentationFormat",t:zi},4:{n:"ByteCount",t:ia},5:{n:"LineCount",t:ia},6:{n:"ParagraphCount",t:ia},7:{n:"SlideCount",t:ia},8:{n:"NoteCount",t:ia},9:{n:"HiddenCount",t:ia},10:{n:"MultimediaClipCount",t:ia},11:{n:"ScaleCrop",t:Zx},12:{n:"HeadingPairs",t:wxe},13:{n:"TitlesOfParts",t:Exe},14:{n:"Manager",t:zi},15:{n:"Company",t:zi},16:{n:"LinksUpToDate",t:Zx},17:{n:"CharacterCount",t:ia},19:{n:"SharedDoc",t:Zx},22:{n:"HyperlinksChanged",t:Zx},23:{n:"AppVersion",t:ia,p:"version"},24:{n:"DigSig",t:_xe},26:{n:"ContentType",t:zi},27:{n:"ContentStatus",t:zi},28:{n:"Language",t:zi},29:{n:"Version",t:zi},255:{},2147483648:{n:"Locale",t:cw},2147483651:{n:"Behavior",t:cw},1919054434:{}},X5={1:{n:"CodePage",t:hB},2:{n:"Title",t:zi},3:{n:"Subject",t:zi},4:{n:"Author",t:zi},5:{n:"Keywords",t:zi},6:{n:"Comments",t:zi},7:{n:"Template",t:zi},8:{n:"LastAuthor",t:zi},9:{n:"RevNumber",t:zi},10:{n:"EditTime",t:Jx},11:{n:"LastPrinted",t:Jx},12:{n:"CreatedDate",t:Jx},13:{n:"ModifiedDate",t:Jx},14:{n:"PageCount",t:ia},15:{n:"WordCount",t:ia},16:{n:"CharCount",t:ia},17:{n:"Thumbnail",t:vxe},18:{n:"Application",t:zi},19:{n:"DocSecurity",t:ia},255:{},2147483648:{n:"Locale",t:cw},2147483651:{n:"Behavior",t:cw},1919054434:{}};function Txe(n){return n.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var Sxe=Txe([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),bxe=Xs(Sxe),c1={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Rxe={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Qx={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function dB(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function fB(n,e){var t=D1e(Rxe),r=[],i;r[r.length]=ai,r[r.length]=it("Types",null,{xmlns:Ai.CT,"xmlns:xsd":Ai.xsd,"xmlns:xsi":Ai.xsi}),r=r.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return it("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){n[l]&&n[l].length>0&&(i=n[l][0],r[r.length]=it("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:Qx[l][e.bookType]||Qx[l].xlsx}))},a=function(l){(n[l]||[]).forEach(function(c){r[r.length]=it("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:Qx[l][e.bookType]||Qx[l].xlsx})})},o=function(l){(n[l]||[]).forEach(function(c){r[r.length]=it("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:t[l][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),r.length>2&&(r[r.length]="</Types>",r[1]=r[1].replace("/>",">")),r.join("")}var Pn={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function gB(n){var e=n.lastIndexOf("/");return n.slice(0,e+1)+"_rels/"+n.slice(e+1)+".rels"}function I0(n){var e=[ai,it("Relationships",null,{xmlns:Ai.RELS})];return Xi(n["!id"]).forEach(function(t){e[e.length]=it("Relationship",null,n["!id"][t])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Xn(n,e,t,r,i,s){if(i||(i={}),n["!id"]||(n["!id"]={}),n["!idx"]||(n["!idx"]=1),e<0)for(e=n["!idx"];n["!id"]["rId"+e];++e);if(n["!idx"]=e+1,i.Id="rId"+e,i.Type=r,i.Target=t,[Pn.HLINK,Pn.XPATH,Pn.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),n["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return n["!id"][i.Id]=i,n[("/"+i.Target).replace("//","/")]=i,e}function Axe(n){var e=[ai];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<n.length;++t)e.push('  <manifest:file-entry manifest:full-path="'+n[t][0]+'" manifest:media-type="'+n[t][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function q5(n,e,t){return['  <rdf:Description rdf:about="'+n+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function Ixe(n,e){return['  <rdf:Description rdf:about="'+n+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function Cxe(n){var e=[ai];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=n.length;++t)e.push(q5(n[t][0],n[t][1])),e.push(Ixe("",n[t][0]));return e.push(q5("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function mB(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+ew.version+"</meta:generator></office:meta></office:document-meta>"}var td=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function US(n,e,t,r,i){i[n]!=null||e==null||e===""||(i[n]=e,e=Jn(e),r[r.length]=t?it(n,e,t):Hi(n,e))}function pB(n,e){var t=e||{},r=[ai,it("cp:coreProperties",null,{"xmlns:cp":Ai.CORE_PROPS,"xmlns:dc":Ai.dc,"xmlns:dcterms":Ai.dcterms,"xmlns:dcmitype":Ai.dcmitype,"xmlns:xsi":Ai.xsi})],i={};if(!n&&!t.Props)return r.join("");n&&(n.CreatedDate!=null&&US("dcterms:created",typeof n.CreatedDate=="string"?n.CreatedDate:qR(n.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i),n.ModifiedDate!=null&&US("dcterms:modified",typeof n.ModifiedDate=="string"?n.ModifiedDate:qR(n.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i));for(var s=0;s!=td.length;++s){var a=td[s],o=t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:n?n[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&US(a[0],o,null,r,i)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var C0=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],yB=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function xB(n){var e=[],t=it;return n||(n={}),n.Application="SheetJS",e[e.length]=ai,e[e.length]=it("Properties",null,{xmlns:Ai.EXT_PROPS,"xmlns:vt":Ai.vt}),C0.forEach(function(r){if(n[r[1]]!==void 0){var i;switch(r[2]){case"string":i=Jn(String(n[r[1]]));break;case"bool":i=n[r[1]]?"true":"false";break}i!==void 0&&(e[e.length]=t(r[0],i))}}),e[e.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(n.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=t("TitlesOfParts",t("vt:vector",n.SheetNames.map(function(r){return"<vt:lpstr>"+Jn(r)+"</vt:lpstr>"}).join(""),{size:n.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}function _B(n){var e=[ai,it("Properties",null,{xmlns:Ai.CUST_PROPS,"xmlns:vt":Ai.vt})];if(!n)return e.join("");var t=1;return Xi(n).forEach(function(i){++t,e[e.length]=it("property",K1e(n[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:Jn(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var Y5={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function kxe(n,e){var t=[];return Xi(Y5).map(function(r){for(var i=0;i<td.length;++i)if(td[i][1]==r)return td[i];for(i=0;i<C0.length;++i)if(C0[i][1]==r)return C0[i];throw r}).forEach(function(r){if(n[r[1]]!=null){var i=e&&e.Props&&e.Props[r[1]]!=null?e.Props[r[1]]:n[r[1]];switch(r[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),t.push(Hi(Y5[r[1]]||r[1],i))}}),it("DocumentProperties",t.join(""),{xmlns:la.o})}function Pxe(n,e){var t=["Worksheets","SheetNames"],r="CustomDocumentProperties",i=[];return n&&Xi(n).forEach(function(s){if(Object.prototype.hasOwnProperty.call(n,s)){for(var a=0;a<td.length;++a)if(s==td[a][1])return;for(a=0;a<C0.length;++a)if(s==C0[a][1])return;for(a=0;a<t.length;++a)if(s==t[a])return;var o=n[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push(it(F5(s),o,{"dt:dt":l}))}}),e&&Xi(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(n&&Object.prototype.hasOwnProperty.call(n,s))){var a=e[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(it(F5(s),a,{"dt:dt":o}))}}),"<"+r+' xmlns="'+la.o+'">'+i.join("")+"</"+r+">"}function Mxe(n){var e=typeof n=="string"?new Date(Date.parse(n)):n,t=e.getTime()/1e3+11644473600,r=t%Math.pow(2,32),i=(t-r)/Math.pow(2,32);r*=1e7,i*=1e7;var s=r/Math.pow(2,32)|0;s>0&&(r=r%Math.pow(2,32),i+=s);var a=Ne(8);return a.write_shift(4,r),a.write_shift(4,i),a}function Z5(n,e){var t=Ne(4),r=Ne(4);switch(t.write_shift(4,n==80?31:n),n){case 3:r.write_shift(-4,e);break;case 5:r=Ne(8),r.write_shift(8,e,"f");break;case 11:r.write_shift(4,e?1:0);break;case 64:r=Mxe(e);break;case 31:case 80:for(r=Ne(4+2*(e.length+1)+(e.length%2?0:2)),r.write_shift(4,e.length+1),r.write_shift(0,e,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+e)}return Wi([t,r])}var vB=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Nxe(n){switch(typeof n){case"boolean":return 11;case"number":return(n|0)==n?3:5;case"string":return 31;case"object":if(n instanceof Date)return 64;break}return-1}function J5(n,e,t){var r=Ne(8),i=[],s=[],a=8,o=0,l=Ne(8),c=Ne(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),s.push(l),i.push(c),a+=8+l.length,!e){c=Ne(8),c.write_shift(4,0),i.unshift(c);var h=[Ne(4)];for(h[0].write_shift(4,n.length),o=0;o<n.length;++o){var f=n[o][0];for(l=Ne(8+2*(f.length+1)+(f.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,f.length+1),l.write_shift(0,f,"dbcs");l.l!=l.length;)l.write_shift(1,0);h.push(l)}l=Wi(h),s.unshift(l),a+=8+l.length}for(o=0;o<n.length;++o)if(!(e&&!e[n[o][0]])&&!(vB.indexOf(n[o][0])>-1||yB.indexOf(n[o][0])>-1)&&n[o][1]!=null){var m=n[o][1],y=0;if(e){y=+e[n[o][0]];var x=t[y];if(x.p=="version"&&typeof m=="string"){var _=m.split(".");m=(+_[0]<<16)+(+_[1]||0)}l=Z5(x.t,m)}else{var w=Nxe(m);w==-1&&(w=31,m=String(m)),l=Z5(w,m)}s.push(l),c=Ne(8),c.write_shift(4,e?y:2+o),i.push(c),a+=8+l.length}var S=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,S),S+=s[o].length;return r.write_shift(4,a),r.write_shift(4,s.length),Wi([r].concat(i).concat(s))}function Q5(n,e,t,r,i,s){var a=Ne(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,nr.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,i?68:48);var l=J5(n,t,r);if(o.push(l),i){var c=J5(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+l.length),o.push(c)}return Wi(o)}function Lxe(n,e){e||(e=Ne(n));for(var t=0;t<n;++t)e.write_shift(1,0);return e}function Oxe(n,e){return n.read_shift(e)===1}function vs(n,e){return e||(e=Ne(2)),e.write_shift(2,+!!n),e}function wB(n){return n.read_shift(2,"u")}function Ma(n,e){return e||(e=Ne(2)),e.write_shift(2,n),e}function EB(n,e,t){return t||(t=Ne(2)),t.write_shift(1,e=="e"?+n:+!!n),t.write_shift(1,e=="e"?1:0),t}function TB(n,e,t){var r=n.read_shift(t&&t.biff>=12?2:1),i="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var s=n.read_shift(1);s&&(i="dbcs-cont")}else t.biff==12&&(i="wstr");t.biff>=2&&t.biff<=5&&(i="cpstr");var a=r?n.read_shift(r,i):"";return a}function Dxe(n){var e=n.t||"",t=Ne(3);t.write_shift(2,e.length),t.write_shift(1,1);var r=Ne(2*e.length);r.write_shift(2*e.length,e,"utf16le");var i=[t,r];return Wi(i)}function Fxe(n,e,t){var r;if(t){if(t.biff>=2&&t.biff<=5)return n.read_shift(e,"cpstr");if(t.biff>=12)return n.read_shift(e,"dbcs-cont")}var i=n.read_shift(1);return i===0?r=n.read_shift(e,"sbcs-cont"):r=n.read_shift(e,"dbcs-cont"),r}function jxe(n,e,t){var r=n.read_shift(t&&t.biff==2?1:2);return r===0?(n.l++,""):Fxe(n,r,t)}function Vxe(n,e,t){if(t.biff>5)return jxe(n,e,t);var r=n.read_shift(1);return r===0?(n.l++,""):n.read_shift(r,t.biff<=4||!n.lens?"cpstr":"sbcs-cont")}function SB(n,e,t){return t||(t=Ne(3+2*n.length)),t.write_shift(2,n.length),t.write_shift(1,1),t.write_shift(31,n,"utf16le"),t}function eD(n,e){e||(e=Ne(6+n.length*2)),e.write_shift(4,1+n.length);for(var t=0;t<n.length;++t)e.write_shift(2,n.charCodeAt(t));return e.write_shift(2,0),e}function Gxe(n){var e=Ne(512),t=0,r=n.Target;r.slice(0,7)=="file://"&&(r=r.slice(7));var i=r.indexOf("#"),s=i>-1?31:23;switch(r.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(t=0;t<a.length;++t)e.write_shift(4,a[t]);if(s==28)r=r.slice(1),eD(r,e);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<a.length;++t)e.write_shift(1,parseInt(a[t],16));var o=i>-1?r.slice(0,i):r;for(e.write_shift(4,2*(o.length+1)),t=0;t<o.length;++t)e.write_shift(2,o.charCodeAt(t));e.write_shift(2,0),s&8&&eD(i>-1?r.slice(i+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<a.length;++t)e.write_shift(1,parseInt(a[t],16));for(var l=0;r.slice(l*3,l*3+3)=="../"||r.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,r.length-3*l+1),t=0;t<r.length-3*l;++t)e.write_shift(1,r.charCodeAt(t+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),t=0;t<6;++t)e.write_shift(4,0)}return e.slice(0,e.l)}function Sd(n,e,t,r){return r||(r=Ne(6)),r.write_shift(2,n),r.write_shift(2,e),r.write_shift(2,t||0),r}function Bxe(n,e,t){var r=t.biff>8?4:2,i=n.read_shift(r),s=n.read_shift(r,"i"),a=n.read_shift(r,"i");return[i,s,a]}function zxe(n){var e=n.read_shift(2),t=n.read_shift(2),r=n.read_shift(2),i=n.read_shift(2);return{s:{c:r,r:e},e:{c:i,r:t}}}function bB(n,e){return e||(e=Ne(8)),e.write_shift(2,n.s.r),e.write_shift(2,n.e.r),e.write_shift(2,n.s.c),e.write_shift(2,n.e.c),e}function Ak(n,e,t){var r=1536,i=16;switch(t.bookType){case"biff8":break;case"biff5":r=1280,i=8;break;case"biff4":r=4,i=6;break;case"biff3":r=3,i=6;break;case"biff2":r=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=Ne(i);return s.write_shift(2,r),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function Uxe(n,e){var t=!e||e.biff==8,r=Ne(t?112:54);for(r.write_shift(e.biff==8?2:1,7),t&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(t?0:536870912));r.l<r.length;)r.write_shift(1,t?0:32);return r}function $xe(n,e){var t=!e||e.biff>=8?2:1,r=Ne(8+t*n.name.length);r.write_shift(4,n.pos),r.write_shift(1,n.hs||0),r.write_shift(1,n.dt),r.write_shift(1,n.name.length),e.biff>=8&&r.write_shift(1,1),r.write_shift(t*n.name.length,n.name,e.biff<8?"sbcs":"utf16le");var i=r.slice(0,r.l);return i.l=r.l,i}function Wxe(n,e){var t=Ne(8);t.write_shift(4,n.Count),t.write_shift(4,n.Unique);for(var r=[],i=0;i<n.length;++i)r[i]=Dxe(n[i]);var s=Wi([t].concat(r));return s.parts=[t.length].concat(r.map(function(a){return a.length})),s}function Hxe(){var n=Ne(18);return n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,29280),n.write_shift(2,17600),n.write_shift(2,56),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,1),n.write_shift(2,500),n}function Kxe(n){var e=Ne(18),t=1718;return n&&n.RTL&&(t|=64),e.write_shift(2,t),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function Xxe(n,e){var t=n.name||"Arial",r=e&&e.biff==5,i=r?15+t.length:16+2*t.length,s=Ne(i);return s.write_shift(2,n.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,t.length),r||s.write_shift(1,1),s.write_shift((r?1:2)*t.length,t,r?"sbcs":"utf16le"),s}function qxe(n,e,t,r){var i=Ne(10);return Sd(n,e,r,i),i.write_shift(4,t),i}function Yxe(n,e,t,r,i){var s=!i||i.biff==8,a=Ne(8+ +s+(1+s)*t.length);return Sd(n,e,r,a),a.write_shift(2,t.length),s&&a.write_shift(1,1),a.write_shift((1+s)*t.length,t,s?"utf16le":"sbcs"),a}function Zxe(n,e,t,r){var i=t&&t.biff==5;r||(r=Ne(i?3+e.length:5+2*e.length)),r.write_shift(2,n),r.write_shift(i?1:2,e.length),i||r.write_shift(1,1),r.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=r.length>r.l?r.slice(0,r.l):r;return s.l==null&&(s.l=s.length),s}function Jxe(n,e){var t=e.biff==8||!e.biff?4:2,r=Ne(2*t+6);return r.write_shift(t,n.s.r),r.write_shift(t,n.e.r+1),r.write_shift(2,n.s.c),r.write_shift(2,n.e.c+1),r.write_shift(2,0),r}function tD(n,e,t,r){var i=t&&t.biff==5;r||(r=Ne(i?16:20)),r.write_shift(2,0),n.style?(r.write_shift(2,n.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,n.numFmtId||0),r.write_shift(2,e<<4));var s=0;return n.numFmtId>0&&i&&(s|=1024),r.write_shift(4,s),r.write_shift(4,0),i||r.write_shift(4,0),r.write_shift(2,0),r}function Qxe(n){var e=Ne(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function e_e(n,e,t,r,i,s){var a=Ne(8);return Sd(n,e,r,a),EB(t,s,a),a}function t_e(n,e,t,r){var i=Ne(14);return Sd(n,e,r,i),Td(t,i),i}function n_e(n,e,t){if(t.biff<8)return r_e(n,e,t);for(var r=[],i=n.l+e,s=n.read_shift(t.biff>8?4:2);s--!==0;)r.push(Bxe(n,t.biff>8?12:6,t));if(n.l!=i)throw new Error("Bad ExternSheet: "+n.l+" != "+i);return r}function r_e(n,e,t){n[n.l+1]==3&&n[n.l]++;var r=TB(n,e,t);return r.charCodeAt(0)==3?r.slice(1):r}function i_e(n){var e=Ne(2+n.length*8);e.write_shift(2,n.length);for(var t=0;t<n.length;++t)bB(n[t],e);return e}function s_e(n){var e=Ne(24),t=ki(n[0]);e.write_shift(2,t.r),e.write_shift(2,t.r),e.write_shift(2,t.c),e.write_shift(2,t.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(r[i],16));return Wi([e,Gxe(n[1])])}function a_e(n){var e=n[1].Tooltip,t=Ne(10+2*(e.length+1));t.write_shift(2,2048);var r=ki(n[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var i=0;i<e.length;++i)t.write_shift(2,e.charCodeAt(i));return t.write_shift(2,0),t}function o_e(n){return n||(n=Ne(4)),n.write_shift(2,1),n.write_shift(2,1),n}function l_e(n,e,t){if(!t.cellStyles)return ml(n,e);var r=t&&t.biff>=12?4:2,i=n.read_shift(r),s=n.read_shift(r),a=n.read_shift(r),o=n.read_shift(r),l=n.read_shift(2);r==2&&(n.l+=2);var c={s:i,e:s,w:a,ixfe:o,flags:l};return(t.biff>=5||!t.biff)&&(c.level=l>>8&7),c}function c_e(n,e){var t=Ne(12);t.write_shift(2,e),t.write_shift(2,e),t.write_shift(2,n.width*256),t.write_shift(2,0);var r=0;return n.hidden&&(r|=1),t.write_shift(1,r),r=n.level||0,t.write_shift(1,r),t.write_shift(2,0),t}function u_e(n){for(var e=Ne(2*n),t=0;t<n;++t)e.write_shift(2,t+1);return e}function h_e(n,e,t){var r=Ne(15);return h1(r,n,e),r.write_shift(8,t,"f"),r}function d_e(n,e,t){var r=Ne(9);return h1(r,n,e),r.write_shift(2,t),r}var f_e=(function(){var n={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=pk({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(o,l){var c=[],h=Ed(1);switch(l.type){case"base64":h=mo(hc(o));break;case"binary":h=mo(o);break;case"buffer":case"array":h=o;break}aa(h,0);var f=h.read_shift(1),m=!!(f&136),y=!1,x=!1;switch(f){case 2:break;case 3:break;case 48:y=!0,m=!0;break;case 49:y=!0,m=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var _=0,w=521;f==2&&(_=h.read_shift(2)),h.l+=3,f!=2&&(_=h.read_shift(4)),_>1048576&&(_=1e6),f!=2&&(w=h.read_shift(2));var S=h.read_shift(2),b=l.codepage||1252;f!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(b=n[h[h.l]]),h.l+=1,h.l+=2),x&&(h.l+=36);for(var R=[],M={},O=Math.min(h.length,f==2?521:w-10-(y?264:0)),G=x?32:11;h.l<O&&h[h.l]!=13;)switch(M={},M.name=tw.utils.decode(b,h.slice(h.l,h.l+G)).replace(/[\u0000\r\n].*$/g,""),h.l+=G,M.type=String.fromCharCode(h.read_shift(1)),f!=2&&!x&&(M.offset=h.read_shift(4)),M.len=h.read_shift(1),f==2&&(M.offset=h.read_shift(2)),M.dec=h.read_shift(1),M.name.length&&R.push(M),f!=2&&(h.l+=x?13:14),M.type){case"B":(!y||M.len!=8)&&l.WTF&&console.log("Skipping "+M.name+":"+M.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+M.name+":"+M.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+M.type)}if(h[h.l]!==13&&(h.l=w-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=w;var A=0,I=0;for(c[0]=[],I=0;I!=R.length;++I)c[0][I]=R[I].name;for(;_-- >0;){if(h[h.l]===42){h.l+=S;continue}for(++h.l,c[++A]=[],I=0,I=0;I!=R.length;++I){var P=h.slice(h.l,h.l+R[I].len);h.l+=R[I].len,aa(P,0);var D=tw.utils.decode(b,P);switch(R[I].type){case"C":D.trim().length&&(c[A][I]=D.replace(/\s+$/,""));break;case"D":D.length===8?c[A][I]=new Date(+D.slice(0,4),+D.slice(4,6)-1,+D.slice(6,8)):c[A][I]=D;break;case"F":c[A][I]=parseFloat(D.trim());break;case"+":case"I":c[A][I]=x?P.read_shift(-4,"i")^2147483648:P.read_shift(4,"i");break;case"L":switch(D.trim().toUpperCase()){case"Y":case"T":c[A][I]=!0;break;case"N":case"F":c[A][I]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+D+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));c[A][I]="##MEMO##"+(x?parseInt(D.trim(),10):P.read_shift(4));break;case"N":D=D.replace(/\u0000/g,"").trim(),D&&D!="."&&(c[A][I]=+D||0);break;case"@":c[A][I]=new Date(P.read_shift(-8,"f")-621356832e5);break;case"T":c[A][I]=new Date((P.read_shift(4)-2440588)*864e5+P.read_shift(4));break;case"Y":c[A][I]=P.read_shift(4,"i")/1e4+P.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[A][I]=-P.read_shift(-8,"f");break;case"B":if(y&&R[I].len==8){c[A][I]=P.read_shift(8,"f");break}case"G":case"P":P.l+=R[I].len;break;case"0":if(R[I].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+R[I].type)}}}if(f!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=R,c}function r(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var h=wg(t(o,c),c);return h["!cols"]=c.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete c.DBF,h}function i(o,l){try{return jd(r(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var c=l||{};if(+c.codepage>=0&&ly(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var h=zs(),f=gw(o,{header:1,raw:!0,cellDates:!0}),m=f[0],y=f.slice(1),x=o["!cols"]||[],_=0,w=0,S=0,b=1;for(_=0;_<m.length;++_){if(((x[_]||{}).DBF||{}).name){m[_]=x[_].DBF.name,++S;continue}if(m[_]!=null){if(++S,typeof m[_]=="number"&&(m[_]=m[_].toString(10)),typeof m[_]!="string")throw new Error("DBF Invalid column name "+m[_]+" |"+typeof m[_]+"|");if(m.indexOf(m[_])!==_){for(w=0;w<1024;++w)if(m.indexOf(m[_]+"_"+w)==-1){m[_]+="_"+w;break}}}}var R=mr(o["!ref"]),M=[],O=[],G=[];for(_=0;_<=R.e.c-R.s.c;++_){var A="",I="",P=0,D=[];for(w=0;w<y.length;++w)y[w][_]!=null&&D.push(y[w][_]);if(D.length==0||m[_]==null){M[_]="?";continue}for(w=0;w<D.length;++w){switch(typeof D[w]){case"number":I="B";break;case"string":I="C";break;case"boolean":I="L";break;case"object":I=D[w]instanceof Date?"D":"C";break;default:I="C"}P=Math.max(P,String(D[w]).length),A=A&&A!=I?"C":I}P>250&&(P=250),I=((x[_]||{}).DBF||{}).type,I=="C"&&x[_].DBF.len>P&&(P=x[_].DBF.len),A=="B"&&I=="N"&&(A="N",G[_]=x[_].DBF.dec,P=x[_].DBF.len),O[_]=A=="C"||I=="N"?P:s[A]||0,b+=O[_],M[_]=A}var L=h.next(32);for(L.write_shift(4,318902576),L.write_shift(4,y.length),L.write_shift(2,296+32*S),L.write_shift(2,b),_=0;_<4;++_)L.write_shift(4,0);for(L.write_shift(4,0|(+e[AG]||3)<<8),_=0,w=0;_<m.length;++_)if(m[_]!=null){var U=h.next(32),j=(m[_].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);U.write_shift(1,j,"sbcs"),U.write_shift(1,M[_]=="?"?"C":M[_],"sbcs"),U.write_shift(4,w),U.write_shift(1,O[_]||s[M[_]]||0),U.write_shift(1,G[_]||0),U.write_shift(1,2),U.write_shift(4,0),U.write_shift(1,0),U.write_shift(4,0),U.write_shift(4,0),w+=O[_]||s[M[_]]||0}var Ee=h.next(264);for(Ee.write_shift(4,13),_=0;_<65;++_)Ee.write_shift(4,0);for(_=0;_<y.length;++_){var ke=h.next(b);for(ke.write_shift(1,0),w=0;w<m.length;++w)if(m[w]!=null)switch(M[w]){case"L":ke.write_shift(1,y[_][w]==null?63:y[_][w]?84:70);break;case"B":ke.write_shift(8,y[_][w]||0,"f");break;case"N":var Be="0";for(typeof y[_][w]=="number"&&(Be=y[_][w].toFixed(G[w]||0)),S=0;S<O[w]-Be.length;++S)ke.write_shift(1,32);ke.write_shift(1,Be,"sbcs");break;case"D":y[_][w]?(ke.write_shift(4,("0000"+y[_][w].getFullYear()).slice(-4),"sbcs"),ke.write_shift(2,("00"+(y[_][w].getMonth()+1)).slice(-2),"sbcs"),ke.write_shift(2,("00"+y[_][w].getDate()).slice(-2),"sbcs")):ke.write_shift(8,"00000000","sbcs");break;case"C":var Me=String(y[_][w]!=null?y[_][w]:"").slice(0,O[w]);for(ke.write_shift(1,Me,"sbcs"),S=0;S<O[w]-Me.length;++S)ke.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:i,to_sheet:r,from_sheet:a}})(),g_e=(function(){var n={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Xi(n).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(m,y){var x=n[y];return typeof x=="number"?b5(x):x},r=function(m,y,x){var _=y.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return _==59?m:b5(_)};n["|"]=254;function i(m,y){switch(y.type){case"base64":return s(hc(m),y);case"binary":return s(m,y);case"buffer":return s(Dn&&Buffer.isBuffer(m)?m.toString("binary"):a1(m),y);case"array":return s(zE(m),y)}throw new Error("Unrecognized type "+y.type)}function s(m,y){var x=m.split(/[\n\r]+/),_=-1,w=-1,S=0,b=0,R=[],M=[],O=null,G={},A=[],I=[],P=[],D=0,L;for(+y.codepage>=0&&ly(+y.codepage);S!==x.length;++S){D=0;var U=x[S].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(e,t),j=U.replace(/;;/g,"\0").split(";").map(function(ie){return ie.replace(/\u0000/g,";")}),Ee=j[0],ke;if(U.length>0)switch(Ee){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":j[1].charAt(0)=="P"&&M.push(U.slice(3).replace(/;;/g,";"));break;case"C":var Be=!1,Me=!1,ce=!1,Pe=!1,be=-1,se=-1;for(b=1;b<j.length;++b)switch(j[b].charAt(0)){case"A":break;case"X":w=parseInt(j[b].slice(1))-1,Me=!0;break;case"Y":for(_=parseInt(j[b].slice(1))-1,Me||(w=0),L=R.length;L<=_;++L)R[L]=[];break;case"K":ke=j[b].slice(1),ke.charAt(0)==='"'?ke=ke.slice(1,ke.length-1):ke==="TRUE"?ke=!0:ke==="FALSE"?ke=!1:isNaN(tc(ke))?isNaN(uy(ke).getDate())||(ke=Rs(ke)):(ke=tc(ke),O!==null&&VG(O)&&(ke=UG(ke))),Be=!0;break;case"E":Pe=!0;var V=dve(j[b].slice(1),{r:_,c:w});R[_][w]=[R[_][w],V];break;case"S":ce=!0,R[_][w]=[R[_][w],"S5S"];break;case"G":break;case"R":be=parseInt(j[b].slice(1))-1;break;case"C":se=parseInt(j[b].slice(1))-1;break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+U)}if(Be&&(R[_][w]&&R[_][w].length==2?R[_][w][0]=ke:R[_][w]=ke,O=null),ce){if(Pe)throw new Error("SYLK shared formula cannot have own formula");var Z=be>-1&&R[be][se];if(!Z||!Z[1])throw new Error("SYLK shared formula cannot find base");R[_][w][1]=fve(Z[1],{r:_-be,c:w-se})}break;case"F":var te=0;for(b=1;b<j.length;++b)switch(j[b].charAt(0)){case"X":w=parseInt(j[b].slice(1))-1,++te;break;case"Y":for(_=parseInt(j[b].slice(1))-1,L=R.length;L<=_;++L)R[L]=[];break;case"M":D=parseInt(j[b].slice(1))/20;break;case"F":break;case"G":break;case"P":O=M[parseInt(j[b].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(P=j[b].slice(1).split(" "),L=parseInt(P[0],10);L<=parseInt(P[1],10);++L)D=parseInt(P[2],10),I[L-1]=D===0?{hidden:!0}:{wch:D},Ik(I[L-1]);break;case"C":w=parseInt(j[b].slice(1))-1,I[w]||(I[w]={});break;case"R":_=parseInt(j[b].slice(1))-1,A[_]||(A[_]={}),D>0?(A[_].hpt=D,A[_].hpx=kB(D)):D===0&&(A[_].hidden=!0);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+U)}te<1&&(O=null);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+U)}}return A.length>0&&(G["!rows"]=A),I.length>0&&(G["!cols"]=I),y&&y.sheetRows&&(R=R.slice(0,y.sheetRows)),[R,G]}function a(m,y){var x=i(m,y),_=x[0],w=x[1],S=wg(_,y);return Xi(w).forEach(function(b){S[b]=w[b]}),S}function o(m,y){return jd(a(m,y),y)}function l(m,y,x,_){var w="C;Y"+(x+1)+";X"+(_+1)+";K";switch(m.t){case"n":w+=m.v||0,m.f&&!m.F&&(w+=";E"+kk(m.f,{r:x,c:_}));break;case"b":w+=m.v?"TRUE":"FALSE";break;case"e":w+=m.w||m.v;break;case"d":w+='"'+(m.w||m.v)+'"';break;case"s":w+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function c(m,y){y.forEach(function(x,_){var w="F;W"+(_+1)+" "+(_+1)+" ";x.hidden?w+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=uw(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=hw(x.wpx)),typeof x.wch=="number"&&(w+=Math.round(x.wch))),w.charAt(w.length-1)!=" "&&m.push(w)})}function h(m,y){y.forEach(function(x,_){var w="F;";x.hidden?w+="M0;":x.hpt?w+="M"+20*x.hpt+";":x.hpx&&(w+="M"+20*dw(x.hpx)+";"),w.length>2&&m.push(w+"R"+(_+1))})}function f(m,y){var x=["ID;PWXL;N;E"],_=[],w=mr(m["!ref"]),S,b=Array.isArray(m),R=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),m["!cols"]&&c(x,m["!cols"]),m["!rows"]&&h(x,m["!rows"]),x.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var M=w.s.r;M<=w.e.r;++M)for(var O=w.s.c;O<=w.e.c;++O){var G=er({r:M,c:O});S=b?(m[M]||[])[O]:m[G],!(!S||S.v==null&&(!S.f||S.F))&&_.push(l(S,m,M,O))}return x.join(R)+R+_.join(R)+R+"E"+R}return{to_workbook:o,to_sheet:a,from_sheet:f}})(),m_e=(function(){function n(s,a){switch(a.type){case"base64":return e(hc(s),a);case"binary":return e(s,a);case"buffer":return e(Dn&&Buffer.isBuffer(s)?s.toString("binary"):a1(s),a);case"array":return e(zE(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var o=s.split(`
`),l=-1,c=-1,h=0,f=[];h!==o.length;++h){if(o[h].trim()==="BOT"){f[++l]=[],c=0;continue}if(!(l<0)){var m=o[h].trim().split(","),y=m[0],x=m[1];++h;for(var _=o[h]||"";(_.match(/["]/g)||[]).length&1&&h<o.length-1;)_+=`
`+o[++h];switch(_=_.trim(),+y){case-1:if(_==="BOT"){f[++l]=[],c=0;continue}else if(_!=="EOD")throw new Error("Unrecognized DIF special command "+_);break;case 0:_==="TRUE"?f[l][c]=!0:_==="FALSE"?f[l][c]=!1:isNaN(tc(x))?isNaN(uy(x).getDate())?f[l][c]=x:f[l][c]=Rs(x):f[l][c]=tc(x),++c;break;case 1:_=_.slice(1,_.length-1),_=_.replace(/""/g,'"'),_&&_.match(/^=".*"$/)&&(_=_.slice(2,-1)),f[l][c++]=_!==""?_:null;break}if(_==="EOD")break}}return a&&a.sheetRows&&(f=f.slice(0,a.sheetRows)),f}function t(s,a){return wg(n(s,a),a)}function r(s,a){return jd(t(s,a),a)}var i=(function(){var s=function(l,c,h,f,m){l.push(c),l.push(h+","+f),l.push('"'+m.replace(/"/g,'""')+'"')},a=function(l,c,h,f){l.push(c+","+h),l.push(c==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(l){var c=[],h=mr(l["!ref"]),f,m=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,h.e.r-h.s.r+1,""),s(c,"TUPLES",0,h.e.c-h.s.c+1,""),s(c,"DATA",0,0,"");for(var y=h.s.r;y<=h.e.r;++y){a(c,-1,0,"BOT");for(var x=h.s.c;x<=h.e.c;++x){var _=er({r:y,c:x});if(f=m?(l[y]||[])[x]:l[_],!f){a(c,1,0,"");continue}switch(f.t){case"n":var w=f.w;!w&&f.v!=null&&(w=f.v),w==null?f.f&&!f.F?a(c,1,0,"="+f.f):a(c,1,0,""):a(c,0,w,"V");break;case"b":a(c,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":a(c,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=zu(f.z||Gr[14],Ks(Rs(f.v)))),a(c,0,f.w,"V");break;default:a(c,1,0,"")}}}a(c,-1,0,"EOD");var S=`\r
`,b=c.join(S);return b}})();return{to_workbook:r,to_sheet:t,from_sheet:i}})(),RB=(function(){function n(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(f,m){for(var y=f.split(`
`),x=-1,_=-1,w=0,S=[];w!==y.length;++w){var b=y[w].trim().split(":");if(b[0]==="cell"){var R=ki(b[1]);if(S.length<=R.r)for(x=S.length;x<=R.r;++x)S[x]||(S[x]=[]);switch(x=R.r,_=R.c,b[2]){case"t":S[x][_]=n(b[3]);break;case"v":S[x][_]=+b[3];break;case"vtf":var M=b[b.length-1];case"vtc":switch(b[3]){case"nl":S[x][_]=!!+b[4];break;default:S[x][_]=+b[4];break}b[2]=="vtf"&&(S[x][_]=[S[x][_],M])}}}return m&&m.sheetRows&&(S=S.slice(0,m.sheetRows)),S}function r(f,m){return wg(t(f,m),m)}function i(f,m){return jd(r(f,m),m)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(f){if(!f||!f["!ref"])return"";for(var m=[],y=[],x,_="",w=xa(f["!ref"]),S=Array.isArray(f),b=w.s.r;b<=w.e.r;++b)for(var R=w.s.c;R<=w.e.c;++R)if(_=er({r:b,c:R}),x=S?(f[b]||[])[R]:f[_],!(!x||x.v==null||x.t==="z")){switch(y=["cell",_,"t"],x.t){case"s":case"str":y.push(e(x.v));break;case"n":x.f?(y[2]="vtf",y[3]="n",y[4]=x.v,y[5]=e(x.f)):(y[2]="v",y[3]=x.v);break;case"b":y[2]="vt"+(x.f?"f":"c"),y[3]="nl",y[4]=x.v?"1":"0",y[5]=e(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var M=Ks(Rs(x.v));y[2]="vtc",y[3]="nd",y[4]=""+M,y[5]=x.w||zu(x.z||Gr[14],M);break;case"e":continue}m.push(y.join(":"))}return m.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function h(f){return[s,a,o,a,c(f),l].join(`
`)}return{to_workbook:i,to_sheet:r,from_sheet:h}})(),p_e=(function(){function n(h,f,m,y,x){x.raw?f[m][y]=h:h===""||(h==="TRUE"?f[m][y]=!0:h==="FALSE"?f[m][y]=!1:isNaN(tc(h))?isNaN(uy(h).getDate())?f[m][y]=h:f[m][y]=Rs(h):f[m][y]=tc(h))}function e(h,f){var m=f||{},y=[];if(!h||h.length===0)return y;for(var x=h.split(/[\r\n]/),_=x.length-1;_>=0&&x[_].length===0;)--_;for(var w=10,S=0,b=0;b<=_;++b)S=x[b].indexOf(" "),S==-1?S=x[b].length:S++,w=Math.max(w,S);for(b=0;b<=_;++b){y[b]=[];var R=0;for(n(x[b].slice(0,w).trim(),y,b,R,m),R=1;R<=(x[b].length-w)/10+1;++R)n(x[b].slice(w+(R-1)*10,w+R*10).trim(),y,b,R,m)}return m.sheetRows&&(y=y.slice(0,m.sheetRows)),y}var t={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function i(h){for(var f={},m=!1,y=0,x=0;y<h.length;++y)(x=h.charCodeAt(y))==34?m=!m:!m&&x in t&&(f[x]=(f[x]||0)+1);x=[];for(y in f)Object.prototype.hasOwnProperty.call(f,y)&&x.push([f[y],y]);if(!x.length){f=r;for(y in f)Object.prototype.hasOwnProperty.call(f,y)&&x.push([f[y],y])}return x.sort(function(_,w){return _[0]-w[0]||r[_[1]]-r[w[1]]}),t[x.pop()[1]]||44}function s(h,f){var m=f||{},y="",x=m.dense?[]:{},_={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(y=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(y=h.charAt(4),h=h.slice(6)):y=i(h.slice(0,1024)):m&&m.FS?y=m.FS:y=i(h.slice(0,1024));var w=0,S=0,b=0,R=0,M=0,O=y.charCodeAt(0),G=!1,A=0,I=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var P=m.dateNF!=null?M1e(m.dateNF):null;function D(){var L=h.slice(R,M),U={};if(L.charAt(0)=='"'&&L.charAt(L.length-1)=='"'&&(L=L.slice(1,-1).replace(/""/g,'"')),L.length===0)U.t="z";else if(m.raw)U.t="s",U.v=L;else if(L.trim().length===0)U.t="s",U.v=L;else if(L.charCodeAt(0)==61)L.charCodeAt(1)==34&&L.charCodeAt(L.length-1)==34?(U.t="s",U.v=L.slice(2,-1).replace(/""/g,'"')):gve(L)?(U.t="n",U.f=L.slice(1)):(U.t="s",U.v=L);else if(L=="TRUE")U.t="b",U.v=!0;else if(L=="FALSE")U.t="b",U.v=!1;else if(!isNaN(b=tc(L)))U.t="n",m.cellText!==!1&&(U.w=L),U.v=b;else if(!isNaN(uy(L).getDate())||P&&L.match(P)){U.z=m.dateNF||Gr[14];var j=0;P&&L.match(P)&&(L=N1e(L,m.dateNF,L.match(P)||[]),j=1),m.cellDates?(U.t="d",U.v=Rs(L,j)):(U.t="n",U.v=Ks(Rs(L,j))),m.cellText!==!1&&(U.w=zu(U.z,U.v instanceof Date?Ks(U.v):U.v)),m.cellNF||delete U.z}else U.t="s",U.v=L;if(U.t=="z"||(m.dense?(x[w]||(x[w]=[]),x[w][S]=U):x[er({c:S,r:w})]=U),R=M+1,I=h.charCodeAt(R),_.e.c<S&&(_.e.c=S),_.e.r<w&&(_.e.r=w),A==O)++S;else if(S=0,++w,m.sheetRows&&m.sheetRows<=w)return!0}e:for(;M<h.length;++M)switch(A=h.charCodeAt(M)){case 34:I===34&&(G=!G);break;case O:case 10:case 13:if(!G&&D())break e;break}return M-R>0&&D(),x["!ref"]=ri(_),x}function a(h,f){return!(f&&f.PRN)||f.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?s(h,f):wg(e(h,f),f)}function o(h,f){var m="",y=f.type=="string"?[0,0,0,0]:ITe(h,f);switch(f.type){case"base64":m=hc(h);break;case"binary":m=h;break;case"buffer":f.codepage==65001?m=h.toString("utf8"):f.codepage&&typeof tw<"u"||(m=Dn&&Buffer.isBuffer(h)?h.toString("binary"):a1(h));break;case"array":m=zE(h);break;case"string":m=h;break;default:throw new Error("Unrecognized type "+f.type)}return y[0]==239&&y[1]==187&&y[2]==191?m=dp(m.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?m=dp(m):f.type=="binary"&&typeof tw<"u",m.slice(0,19)=="socialcalc:version:"?RB.to_sheet(f.type=="string"?m:dp(m),f):a(m,f)}function l(h,f){return jd(o(h,f),f)}function c(h){for(var f=[],m=mr(h["!ref"]),y,x=Array.isArray(h),_=m.s.r;_<=m.e.r;++_){for(var w=[],S=m.s.c;S<=m.e.c;++S){var b=er({r:_,c:S});if(y=x?(h[_]||[])[S]:h[b],!y||y.v==null){w.push("          ");continue}for(var R=(y.w||(dc(y),y.w)||"").slice(0,10);R.length<10;)R+=" ";w.push(R+(S===0?" ":""))}f.push(w.join(""))}return f.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}})(),nD=(function(){function n(V,Z,te){if(V){aa(V,V.l||0);for(var ie=te.Enum||be;V.l<V.length;){var ue=V.read_shift(2),Ve=ie[ue]||ie[65535],Ge=V.read_shift(2),ye=V.l+Ge,pe=Ve.f&&Ve.f(V,Ge,te);if(V.l=ye,Z(pe,Ve,ue))return}}}function e(V,Z){switch(Z.type){case"base64":return t(mo(hc(V)),Z);case"binary":return t(mo(V),Z);case"buffer":case"array":return t(V,Z)}throw"Unsupported type "+Z.type}function t(V,Z){if(!V)return V;var te=Z||{},ie=te.dense?[]:{},ue="Sheet1",Ve="",Ge=0,ye={},pe=[],Fe=[],wt={s:{r:0,c:0},e:{r:0,c:0}},jt=te.sheetRows||0;if(V[2]==0&&(V[3]==8||V[3]==9)&&V.length>=16&&V[14]==5&&V[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(V[2]==2)te.Enum=be,n(V,function(ot,tr,hn){switch(hn){case 0:te.vers=ot,ot>=4096&&(te.qpro=!0);break;case 6:wt=ot;break;case 204:ot&&(Ve=ot);break;case 222:Ve=ot;break;case 15:case 51:te.qpro||(ot[1].v=ot[1].v.slice(1));case 13:case 14:case 16:hn==14&&(ot[2]&112)==112&&(ot[2]&15)>1&&(ot[2]&15)<15&&(ot[1].z=te.dateNF||Gr[14],te.cellDates&&(ot[1].t="d",ot[1].v=UG(ot[1].v))),te.qpro&&ot[3]>Ge&&(ie["!ref"]=ri(wt),ye[ue]=ie,pe.push(ue),ie=te.dense?[]:{},wt={s:{r:0,c:0},e:{r:0,c:0}},Ge=ot[3],ue=Ve||"Sheet"+(Ge+1),Ve="");var cn=te.dense?(ie[ot[0].r]||[])[ot[0].c]:ie[er(ot[0])];if(cn){cn.t=ot[1].t,cn.v=ot[1].v,ot[1].z!=null&&(cn.z=ot[1].z),ot[1].f!=null&&(cn.f=ot[1].f);break}te.dense?(ie[ot[0].r]||(ie[ot[0].r]=[]),ie[ot[0].r][ot[0].c]=ot[1]):ie[er(ot[0])]=ot[1];break}},te);else if(V[2]==26||V[2]==14)te.Enum=se,V[2]==14&&(te.qpro=!0,V.l=0),n(V,function(ot,tr,hn){switch(hn){case 204:ue=ot;break;case 22:ot[1].v=ot[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ot[3]>Ge&&(ie["!ref"]=ri(wt),ye[ue]=ie,pe.push(ue),ie=te.dense?[]:{},wt={s:{r:0,c:0},e:{r:0,c:0}},Ge=ot[3],ue="Sheet"+(Ge+1)),jt>0&&ot[0].r>=jt)break;te.dense?(ie[ot[0].r]||(ie[ot[0].r]=[]),ie[ot[0].r][ot[0].c]=ot[1]):ie[er(ot[0])]=ot[1],wt.e.c<ot[0].c&&(wt.e.c=ot[0].c),wt.e.r<ot[0].r&&(wt.e.r=ot[0].r);break;case 27:ot[14e3]&&(Fe[ot[14e3][0]]=ot[14e3][1]);break;case 1537:Fe[ot[0]]=ot[1],ot[0]==Ge&&(ue=ot[1]);break}},te);else throw new Error("Unrecognized LOTUS BOF "+V[2]);if(ie["!ref"]=ri(wt),ye[Ve||ue]=ie,pe.push(Ve||ue),!Fe.length)return{SheetNames:pe,Sheets:ye};for(var Dt={},Kt=[],Qt=0;Qt<Fe.length;++Qt)ye[pe[Qt]]?(Kt.push(Fe[Qt]||pe[Qt]),Dt[Fe[Qt]]=ye[Fe[Qt]]||ye[pe[Qt]]):(Kt.push(Fe[Qt]),Dt[Fe[Qt]]={"!ref":"A1"});return{SheetNames:Kt,Sheets:Dt}}function r(V,Z){var te=Z||{};if(+te.codepage>=0&&ly(+te.codepage),te.type=="string")throw new Error("Cannot write WK1 to JS string");var ie=zs(),ue=mr(V["!ref"]),Ve=Array.isArray(V),Ge=[];st(ie,0,s(1030)),st(ie,6,l(ue));for(var ye=Math.min(ue.e.r,8191),pe=ue.s.r;pe<=ye;++pe)for(var Fe=Ki(pe),wt=ue.s.c;wt<=ue.e.c;++wt){pe===ue.s.r&&(Ge[wt]=fs(wt));var jt=Ge[wt]+Fe,Dt=Ve?(V[pe]||[])[wt]:V[jt];if(!(!Dt||Dt.t=="z"))if(Dt.t=="n")(Dt.v|0)==Dt.v&&Dt.v>=-32768&&Dt.v<=32767?st(ie,13,y(pe,wt,Dt.v)):st(ie,14,_(pe,wt,Dt.v));else{var Kt=dc(Dt);st(ie,15,f(pe,wt,Kt.slice(0,239)))}}return st(ie,1),ie.end()}function i(V,Z){var te=Z||{};if(+te.codepage>=0&&ly(+te.codepage),te.type=="string")throw new Error("Cannot write WK3 to JS string");var ie=zs();st(ie,0,a(V));for(var ue=0,Ve=0;ue<V.SheetNames.length;++ue)(V.Sheets[V.SheetNames[ue]]||{})["!ref"]&&st(ie,27,Pe(V.SheetNames[ue],Ve++));var Ge=0;for(ue=0;ue<V.SheetNames.length;++ue){var ye=V.Sheets[V.SheetNames[ue]];if(!(!ye||!ye["!ref"])){for(var pe=mr(ye["!ref"]),Fe=Array.isArray(ye),wt=[],jt=Math.min(pe.e.r,8191),Dt=pe.s.r;Dt<=jt;++Dt)for(var Kt=Ki(Dt),Qt=pe.s.c;Qt<=pe.e.c;++Qt){Dt===pe.s.r&&(wt[Qt]=fs(Qt));var ot=wt[Qt]+Kt,tr=Fe?(ye[Dt]||[])[Qt]:ye[ot];if(!(!tr||tr.t=="z"))if(tr.t=="n")st(ie,23,D(Dt,Qt,Ge,tr.v));else{var hn=dc(tr);st(ie,22,A(Dt,Qt,Ge,hn.slice(0,239)))}}++Ge}}return st(ie,1),ie.end()}function s(V){var Z=Ne(2);return Z.write_shift(2,V),Z}function a(V){var Z=Ne(26);Z.write_shift(2,4096),Z.write_shift(2,4),Z.write_shift(4,0);for(var te=0,ie=0,ue=0,Ve=0;Ve<V.SheetNames.length;++Ve){var Ge=V.SheetNames[Ve],ye=V.Sheets[Ge];if(!(!ye||!ye["!ref"])){++ue;var pe=xa(ye["!ref"]);te<pe.e.r&&(te=pe.e.r),ie<pe.e.c&&(ie=pe.e.c)}}return te>8191&&(te=8191),Z.write_shift(2,te),Z.write_shift(1,ue),Z.write_shift(1,ie),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(1,1),Z.write_shift(1,2),Z.write_shift(4,0),Z.write_shift(4,0),Z}function o(V,Z,te){var ie={s:{c:0,r:0},e:{c:0,r:0}};return Z==8&&te.qpro?(ie.s.c=V.read_shift(1),V.l++,ie.s.r=V.read_shift(2),ie.e.c=V.read_shift(1),V.l++,ie.e.r=V.read_shift(2),ie):(ie.s.c=V.read_shift(2),ie.s.r=V.read_shift(2),Z==12&&te.qpro&&(V.l+=2),ie.e.c=V.read_shift(2),ie.e.r=V.read_shift(2),Z==12&&te.qpro&&(V.l+=2),ie.s.c==65535&&(ie.s.c=ie.e.c=ie.s.r=ie.e.r=0),ie)}function l(V){var Z=Ne(8);return Z.write_shift(2,V.s.c),Z.write_shift(2,V.s.r),Z.write_shift(2,V.e.c),Z.write_shift(2,V.e.r),Z}function c(V,Z,te){var ie=[{c:0,r:0},{t:"n",v:0},0,0];return te.qpro&&te.vers!=20768?(ie[0].c=V.read_shift(1),ie[3]=V.read_shift(1),ie[0].r=V.read_shift(2),V.l+=2):(ie[2]=V.read_shift(1),ie[0].c=V.read_shift(2),ie[0].r=V.read_shift(2)),ie}function h(V,Z,te){var ie=V.l+Z,ue=c(V,Z,te);if(ue[1].t="s",te.vers==20768){V.l++;var Ve=V.read_shift(1);return ue[1].v=V.read_shift(Ve,"utf8"),ue}return te.qpro&&V.l++,ue[1].v=V.read_shift(ie-V.l,"cstr"),ue}function f(V,Z,te){var ie=Ne(7+te.length);ie.write_shift(1,255),ie.write_shift(2,Z),ie.write_shift(2,V),ie.write_shift(1,39);for(var ue=0;ue<ie.length;++ue){var Ve=te.charCodeAt(ue);ie.write_shift(1,Ve>=128?95:Ve)}return ie.write_shift(1,0),ie}function m(V,Z,te){var ie=c(V,Z,te);return ie[1].v=V.read_shift(2,"i"),ie}function y(V,Z,te){var ie=Ne(7);return ie.write_shift(1,255),ie.write_shift(2,Z),ie.write_shift(2,V),ie.write_shift(2,te,"i"),ie}function x(V,Z,te){var ie=c(V,Z,te);return ie[1].v=V.read_shift(8,"f"),ie}function _(V,Z,te){var ie=Ne(13);return ie.write_shift(1,255),ie.write_shift(2,Z),ie.write_shift(2,V),ie.write_shift(8,te,"f"),ie}function w(V,Z,te){var ie=V.l+Z,ue=c(V,Z,te);if(ue[1].v=V.read_shift(8,"f"),te.qpro)V.l=ie;else{var Ve=V.read_shift(2);M(V.slice(V.l,V.l+Ve),ue),V.l+=Ve}return ue}function S(V,Z,te){var ie=Z&32768;return Z&=-32769,Z=(ie?V:0)+(Z>=8192?Z-16384:Z),(ie?"":"$")+(te?fs(Z):Ki(Z))}var b={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},R=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function M(V,Z){aa(V,0);for(var te=[],ie=0,ue="",Ve="",Ge="",ye="";V.l<V.length;){var pe=V[V.l++];switch(pe){case 0:te.push(V.read_shift(8,"f"));break;case 1:Ve=S(Z[0].c,V.read_shift(2),!0),ue=S(Z[0].r,V.read_shift(2),!1),te.push(Ve+ue);break;case 2:{var Fe=S(Z[0].c,V.read_shift(2),!0),wt=S(Z[0].r,V.read_shift(2),!1);Ve=S(Z[0].c,V.read_shift(2),!0),ue=S(Z[0].r,V.read_shift(2),!1),te.push(Fe+wt+":"+Ve+ue)}break;case 3:if(V.l<V.length){console.error("WK1 premature formula end");return}break;case 4:te.push("("+te.pop()+")");break;case 5:te.push(V.read_shift(2));break;case 6:{for(var jt="";pe=V[V.l++];)jt+=String.fromCharCode(pe);te.push('"'+jt.replace(/"/g,'""')+'"')}break;case 8:te.push("-"+te.pop());break;case 23:te.push("+"+te.pop());break;case 22:te.push("NOT("+te.pop()+")");break;case 20:case 21:ye=te.pop(),Ge=te.pop(),te.push(["AND","OR"][pe-20]+"("+Ge+","+ye+")");break;default:if(pe<32&&R[pe])ye=te.pop(),Ge=te.pop(),te.push(Ge+R[pe]+ye);else if(b[pe]){if(ie=b[pe][1],ie==69&&(ie=V[V.l++]),ie>te.length){console.error("WK1 bad formula parse 0x"+pe.toString(16)+":|"+te.join("|")+"|");return}var Dt=te.slice(-ie);te.length-=ie,te.push(b[pe][0]+"("+Dt.join(",")+")")}else return pe<=7?console.error("WK1 invalid opcode "+pe.toString(16)):pe<=24?console.error("WK1 unsupported op "+pe.toString(16)):pe<=30?console.error("WK1 invalid opcode "+pe.toString(16)):pe<=115?console.error("WK1 unsupported function opcode "+pe.toString(16)):console.error("WK1 unrecognized opcode "+pe.toString(16))}}te.length==1?Z[1].f=""+te[0]:console.error("WK1 bad formula parse |"+te.join("|")+"|")}function O(V){var Z=[{c:0,r:0},{t:"n",v:0},0];return Z[0].r=V.read_shift(2),Z[3]=V[V.l++],Z[0].c=V[V.l++],Z}function G(V,Z){var te=O(V);return te[1].t="s",te[1].v=V.read_shift(Z-4,"cstr"),te}function A(V,Z,te,ie){var ue=Ne(6+ie.length);ue.write_shift(2,V),ue.write_shift(1,te),ue.write_shift(1,Z),ue.write_shift(1,39);for(var Ve=0;Ve<ie.length;++Ve){var Ge=ie.charCodeAt(Ve);ue.write_shift(1,Ge>=128?95:Ge)}return ue.write_shift(1,0),ue}function I(V,Z){var te=O(V);te[1].v=V.read_shift(2);var ie=te[1].v>>1;if(te[1].v&1)switch(ie&7){case 0:ie=(ie>>3)*5e3;break;case 1:ie=(ie>>3)*500;break;case 2:ie=(ie>>3)/20;break;case 3:ie=(ie>>3)/200;break;case 4:ie=(ie>>3)/2e3;break;case 5:ie=(ie>>3)/2e4;break;case 6:ie=(ie>>3)/16;break;case 7:ie=(ie>>3)/64;break}return te[1].v=ie,te}function P(V,Z){var te=O(V),ie=V.read_shift(4),ue=V.read_shift(4),Ve=V.read_shift(2);if(Ve==65535)return ie===0&&ue===3221225472?(te[1].t="e",te[1].v=15):ie===0&&ue===3489660928?(te[1].t="e",te[1].v=42):te[1].v=0,te;var Ge=Ve&32768;return Ve=(Ve&32767)-16446,te[1].v=(1-Ge*2)*(ue*Math.pow(2,Ve+32)+ie*Math.pow(2,Ve)),te}function D(V,Z,te,ie){var ue=Ne(14);if(ue.write_shift(2,V),ue.write_shift(1,te),ue.write_shift(1,Z),ie==0)return ue.write_shift(4,0),ue.write_shift(4,0),ue.write_shift(2,65535),ue;var Ve=0,Ge=0,ye=0,pe=0;return ie<0&&(Ve=1,ie=-ie),Ge=Math.log2(ie)|0,ie/=Math.pow(2,Ge-31),pe=ie>>>0,(pe&2147483648)==0&&(ie/=2,++Ge,pe=ie>>>0),ie-=pe,pe|=2147483648,pe>>>=0,ie*=Math.pow(2,32),ye=ie>>>0,ue.write_shift(4,ye),ue.write_shift(4,pe),Ge+=16383+(Ve?32768:0),ue.write_shift(2,Ge),ue}function L(V,Z){var te=P(V);return V.l+=Z-14,te}function U(V,Z){var te=O(V),ie=V.read_shift(4);return te[1].v=ie>>6,te}function j(V,Z){var te=O(V),ie=V.read_shift(8,"f");return te[1].v=ie,te}function Ee(V,Z){var te=j(V);return V.l+=Z-10,te}function ke(V,Z){return V[V.l+Z-1]==0?V.read_shift(Z,"cstr"):""}function Be(V,Z){var te=V[V.l++];te>Z-1&&(te=Z-1);for(var ie="";ie.length<te;)ie+=String.fromCharCode(V[V.l++]);return ie}function Me(V,Z,te){if(!(!te.qpro||Z<21)){var ie=V.read_shift(1);V.l+=17,V.l+=1,V.l+=2;var ue=V.read_shift(Z-21,"cstr");return[ie,ue]}}function ce(V,Z){for(var te={},ie=V.l+Z;V.l<ie;){var ue=V.read_shift(2);if(ue==14e3){for(te[ue]=[0,""],te[ue][0]=V.read_shift(2);V[V.l];)te[ue][1]+=String.fromCharCode(V[V.l]),V.l++;V.l++}}return te}function Pe(V,Z){var te=Ne(5+V.length);te.write_shift(2,14e3),te.write_shift(2,Z);for(var ie=0;ie<V.length;++ie){var ue=V.charCodeAt(ie);te[te.l++]=ue>127?95:ue}return te[te.l++]=0,te}var be={0:{n:"BOF",f:wB},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ke},222:{n:"SHEETNAMELP",f:Be},65535:{n:""}},se={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:G},23:{n:"NUMBER17",f:P},24:{n:"NUMBER18",f:I},25:{n:"FORMULA19",f:L},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ce},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:U},38:{n:"??"},39:{n:"NUMBER27",f:j},40:{n:"FORMULA28",f:Ee},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ke},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Me},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:i,to_workbook:e}})(),y_e=/^\s|\s$|[\t\n\r]/;function AB(n,e){if(!e.bookSST)return"";var t=[ai];t[t.length]=it("sst",null,{xmlns:vg[0],count:n.Count,uniqueCount:n.Unique});for(var r=0;r!=n.length;++r)if(n[r]!=null){var i=n[r],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(y_e)&&(s+=' xml:space="preserve"'),s+=">"+Jn(i.t)+"</t>"),s+="</si>",t[t.length]=s}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function x_e(n){return[n.read_shift(4),n.read_shift(4)]}function __e(n,e){return e||(e=Ne(8)),e.write_shift(4,n.Count),e.write_shift(4,n.Unique),e}var v_e=uxe;function w_e(n){var e=zs();Ue(e,159,__e(n));for(var t=0;t<n.length;++t)Ue(e,19,v_e(n[t]));return Ue(e,160),e.end()}function E_e(n){for(var e=[],t=n.split(""),r=0;r<t.length;++r)e[r]=t[r].charCodeAt(0);return e}function IB(n){var e=0,t,r=E_e(n),i=r.length+1,s,a,o,l,c;for(t=Ed(i),t[0]=r.length,s=1;s!=i;++s)t[s]=r[s-1];for(s=i-1;s>=0;--s)a=t[s],o=(e&16384)===0?0:1,l=e<<1&32767,c=o|l,e=c^a;return e^52811}var T_e=(function(){function n(i,s){switch(s.type){case"base64":return e(hc(i),s);case"binary":return e(i,s);case"buffer":return e(Dn&&Buffer.isBuffer(i)?i.toString("binary"):a1(i),s);case"array":return e(zE(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(h,f){Array.isArray(o)&&(o[f]=[]);for(var m=/\\\w+\b/g,y=0,x,_=-1;x=m.exec(h);){switch(x[0]){case"\\cell":var w=h.slice(y,m.lastIndex-x[0].length);if(w[0]==" "&&(w=w.slice(1)),++_,w.length){var S={v:w,t:"s"};Array.isArray(o)?o[f][_]=S:o[er({r:f,c:_})]=S}break}y=m.lastIndex}_>c.e.c&&(c.e.c=_)}),o["!ref"]=ri(c),o}function t(i,s){return jd(n(i,s),s)}function r(i){for(var s=["{\\rtf1\\ansi"],a=mr(i["!ref"]),o,l=Array.isArray(i),c=a.s.r;c<=a.e.r;++c){s.push("\\trowd\\trautofit1");for(var h=a.s.c;h<=a.e.c;++h)s.push("\\cellx"+(h+1));for(s.push("\\pard\\intbl"),h=a.s.c;h<=a.e.c;++h){var f=er({r:c,c:h});o=l?(i[c]||[])[h]:i[f],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(dc(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:t,to_sheet:n,from_sheet:r}})();function rD(n){for(var e=0,t=1;e!=3;++e)t=t*256+(n[e]>255?255:n[e]<0?0:n[e]);return t.toString(16).toUpperCase().slice(1)}var S_e=6,nc=S_e;function uw(n){return Math.floor((n+Math.round(128/nc)/256)*nc)}function hw(n){return Math.floor((n-5)/nc*100+.5)/100}function ZR(n){return Math.round((n*nc+5)/nc*256)/256}function Ik(n){n.width?(n.wpx=uw(n.width),n.wch=hw(n.wpx),n.MDW=nc):n.wpx?(n.wch=hw(n.wpx),n.width=ZR(n.wch),n.MDW=nc):typeof n.wch=="number"&&(n.width=ZR(n.wch),n.wpx=uw(n.width),n.MDW=nc),n.customWidth&&delete n.customWidth}var b_e=96,CB=b_e;function dw(n){return n*96/CB}function kB(n){return n*CB/96}function R_e(n){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var r=t[0];r<=t[1];++r)n[r]!=null&&(e[e.length]=it("numFmt",null,{numFmtId:r,formatCode:Jn(n[r])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=it("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function A_e(n){var e=[];return e[e.length]=it("cellXfs",null),n.forEach(function(t){e[e.length]=it("xf",null,t)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=it("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function PB(n,e){var t=[ai,it("styleSheet",null,{xmlns:vg[0],"xmlns:vt":Ai.vt})],r;return n.SSF&&(r=R_e(n.SSF))!=null&&(t[t.length]=r),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=A_e(e.cellXfs))&&(t[t.length]=r),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function I_e(n,e){var t=n.read_shift(2),r=gs(n);return[t,r]}function C_e(n,e,t){t||(t=Ne(6+4*e.length)),t.write_shift(2,n),Pi(e,t);var r=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),r}function k_e(n,e,t){var r={};r.sz=n.read_shift(2)/20;var i=yxe(n);i.fItalic&&(r.italic=1),i.fCondense&&(r.condense=1),i.fExtend&&(r.extend=1),i.fShadow&&(r.shadow=1),i.fOutline&&(r.outline=1),i.fStrikeout&&(r.strike=1);var s=n.read_shift(2);switch(s===700&&(r.bold=1),n.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var a=n.read_shift(1);a!=0&&(r.underline=a);var o=n.read_shift(1);o>0&&(r.family=o);var l=n.read_shift(1);switch(l>0&&(r.charset=l),n.l++,r.color=pxe(n),n.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=gs(n),r}function P_e(n,e){e||(e=Ne(153)),e.write_shift(2,n.sz*20),xxe(n,e),e.write_shift(2,n.bold?700:400);var t=0;n.vertAlign=="superscript"?t=1:n.vertAlign=="subscript"&&(t=2),e.write_shift(2,t),e.write_shift(1,n.underline||0),e.write_shift(1,n.family||0),e.write_shift(1,n.charset||0),e.write_shift(1,0),lw(n.color,e);var r=0;return r=2,e.write_shift(1,r),Pi(n.name,e),e.length>e.l?e.slice(0,e.l):e}var M_e=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],$S,N_e=ml;function iD(n,e){e||(e=Ne(84)),$S||($S=pk(M_e));var t=$S[n.patternType];t==null&&(t=40),e.write_shift(4,t);var r=0;if(t!=40)for(lw({auto:1},e),lw({auto:1},e);r<12;++r)e.write_shift(4,0);else{for(;r<4;++r)e.write_shift(4,0);for(;r<12;++r)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function L_e(n,e){var t=n.l+e,r=n.read_shift(2),i=n.read_shift(2);return n.l=t,{ixfe:r,numFmtId:i}}function MB(n,e,t){t||(t=Ne(16)),t.write_shift(2,e||0),t.write_shift(2,n.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var r=0;return t.write_shift(1,r),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function wm(n,e){return e||(e=Ne(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var O_e=ml;function D_e(n,e){return e||(e=Ne(51)),e.write_shift(1,0),wm(null,e),wm(null,e),wm(null,e),wm(null,e),wm(null,e),e.length>e.l?e.slice(0,e.l):e}function F_e(n,e){return e||(e=Ne(52)),e.write_shift(4,n.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),ow(n.name||"",e),e.length>e.l?e.slice(0,e.l):e}function j_e(n,e,t){var r=Ne(2052);return r.write_shift(4,n),ow(e,r),ow(t,r),r.length>r.l?r.slice(0,r.l):r}function V_e(n,e){if(e){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&++t}),t!=0&&(Ue(n,615,To(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&Ue(n,44,C_e(i,e[i]))}),Ue(n,616))}}function G_e(n){var e=1;Ue(n,611,To(e)),Ue(n,43,P_e({sz:12,color:{theme:1},name:"Calibri",family:2})),Ue(n,612)}function B_e(n){var e=2;Ue(n,603,To(e)),Ue(n,45,iD({patternType:"none"})),Ue(n,45,iD({patternType:"gray125"})),Ue(n,604)}function z_e(n){var e=1;Ue(n,613,To(e)),Ue(n,46,D_e()),Ue(n,614)}function U_e(n){var e=1;Ue(n,626,To(e)),Ue(n,47,MB({numFmtId:0},65535)),Ue(n,627)}function $_e(n,e){Ue(n,617,To(e.length)),e.forEach(function(t){Ue(n,47,MB(t,0))}),Ue(n,618)}function W_e(n){var e=1;Ue(n,619,To(e)),Ue(n,48,F_e({xfId:0,name:"Normal"})),Ue(n,620)}function H_e(n){var e=0;Ue(n,505,To(e)),Ue(n,506)}function K_e(n){var e=0;Ue(n,508,j_e(e,"TableStyleMedium9","PivotStyleMedium4")),Ue(n,509)}function X_e(n,e){var t=zs();return Ue(t,278),V_e(t,n.SSF),G_e(t),B_e(t),z_e(t),U_e(t),$_e(t,e.cellXfs),W_e(t),H_e(t),K_e(t),Ue(t,279),t.end()}function NB(n,e){if(e&&e.themeXLSX)return e.themeXLSX;if(n&&typeof n.raw=="string")return n.raw;var t=[ai];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function q_e(n,e){return{flags:n.read_shift(4),version:n.read_shift(4),name:gs(n)}}function Y_e(n){var e=Ne(12+2*n.name.length);return e.write_shift(4,n.flags),e.write_shift(4,n.version),Pi(n.name,e),e.slice(0,e.l)}function Z_e(n){for(var e=[],t=n.read_shift(4);t-- >0;)e.push([n.read_shift(4),n.read_shift(4)]);return e}function J_e(n){var e=Ne(4+8*n.length);e.write_shift(4,n.length);for(var t=0;t<n.length;++t)e.write_shift(4,n[t][0]),e.write_shift(4,n[t][1]);return e}function Q_e(n,e){var t=Ne(8+2*e.length);return t.write_shift(4,n),Pi(e,t),t.slice(0,t.l)}function eve(n){return n.l+=4,n.read_shift(4)!=0}function tve(n,e){var t=Ne(8);return t.write_shift(4,n),t.write_shift(4,1),t}function nve(){var n=zs();return Ue(n,332),Ue(n,334,To(1)),Ue(n,335,Y_e({name:"XLDAPR",version:12e4,flags:3496657072})),Ue(n,336),Ue(n,339,Q_e(1,"XLDAPR")),Ue(n,52),Ue(n,35,To(514)),Ue(n,4096,To(0)),Ue(n,4097,Ma(1)),Ue(n,36),Ue(n,53),Ue(n,340),Ue(n,337,tve(1)),Ue(n,51,J_e([[1,0]])),Ue(n,338),Ue(n,333),n.end()}function LB(){var n=[ai];return n.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),n.join("")}function rve(n){var e={};e.i=n.read_shift(4);var t={};t.r=n.read_shift(4),t.c=n.read_shift(4),e.r=er(t);var r=n.read_shift(1);return r&2&&(e.l="1"),r&8&&(e.a="1"),e}var f0=1024;function OB(n,e){for(var t=[21600,21600],r=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),i=[it("xml",null,{"xmlns:v":la.v,"xmlns:o":la.o,"xmlns:x":la.x,"xmlns:mv":la.mv}).replace(/\/>/,">"),it("o:shapelayout",it("o:idmap",null,{"v:ext":"edit",data:n}),{"v:ext":"edit"}),it("v:shapetype",[it("v:stroke",null,{joinstyle:"miter"}),it("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:r})];f0<n*1e3;)f0+=1e3;return e.forEach(function(s){var a=ki(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?it("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=it("v:fill",l,o),h={on:"t",obscured:"t"};++f0,i=i.concat(["<v:shape"+dy({id:"_x0000_s"+f0,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,it("v:shadow",null,h),it("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Hi("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),Hi("x:AutoFill","False"),Hi("x:Row",String(a.r)),Hi("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function DB(n){var e=[ai,it("comments",null,{xmlns:vg[0]})],t=[];return e.push("<authors>"),n.forEach(function(r){r[1].forEach(function(i){var s=Jn(i.a);t.indexOf(s)==-1&&(t.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&t.indexOf("tc="+i.ID)==-1&&(t.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),n.forEach(function(r){var i=0,s=[];if(r[1][0]&&r[1][0].T&&r[1][0].ID?i=t.indexOf("tc="+r[1][0].ID):r[1].forEach(function(l){l.a&&(i=t.indexOf(Jn(l.a))),s.push(l.t||"")}),e.push('<comment ref="'+r[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(Hi("t",Jn(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;e.push(Hi("t",Jn(a)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function ive(n,e,t){var r=[ai,it("ThreadedComments",null,{xmlns:Ai.TCMNT}).replace(/[\/]>/,">")];return n.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),r.push(it("threadedComment",Hi("text",a.t||""),l))})}),r.push("</ThreadedComments>"),r.join("")}function sve(n){var e=[ai,it("personList",null,{xmlns:Ai.TCMNT,"xmlns:x":vg[0]}).replace(/[\/]>/,">")];return n.forEach(function(t,r){e.push(it("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:t,providerId:"None"}))}),e.push("</personList>"),e.join("")}function ave(n){var e={};e.iauthor=n.read_shift(4);var t=zd(n);return e.rfx=t.s,e.ref=er(t.s),n.l+=16,e}function ove(n,e){return e==null&&(e=Ne(36)),e.write_shift(4,n[1].iauthor),Eg(n[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var lve=gs;function cve(n){return Pi(n.slice(0,54))}function uve(n){var e=zs(),t=[];return Ue(e,628),Ue(e,630),n.forEach(function(r){r[1].forEach(function(i){t.indexOf(i.a)>-1||(t.push(i.a.slice(0,54)),Ue(e,632,cve(i.a)))})}),Ue(e,631),Ue(e,633),n.forEach(function(r){r[1].forEach(function(i){i.iauthor=t.indexOf(i.a);var s={s:ki(r[0]),e:ki(r[0])};Ue(e,635,ove([s,i])),i.t&&i.t.length>0&&Ue(e,637,dxe(i)),Ue(e,636),delete i.iauthor})}),Ue(e,634),Ue(e,629),e.end()}function hve(n,e){e.FullPaths.forEach(function(t,r){if(r!=0){var i=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&nr.utils.cfb_add(n,i,e.FileIndex[r].content)}})}var FB=["xlsb","xlsm","xlam","biff8","xla"],dve=(function(){var n=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function t(r,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,h=a.length>0?parseInt(a,10)|0:0;return o?h+=e.c:--h,l?c+=e.r:--c,i+(o?"":"$")+fs(h)+(l?"":"$")+Ki(c)}return function(i,s){return e=s,i.replace(n,t)}})(),Ck=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,kk=(function(){return function(e,t){return e.replace(Ck,function(r,i,s,a,o,l){var c=Tk(a)-(s?0:t.c),h=Ek(l)-(o?0:t.r),f=h==0?"":o?h+1:"["+h+"]",m=c==0?"":s?c+1:"["+c+"]";return i+"R"+f+"C"+m})}})();function fve(n,e){return n.replace(Ck,function(t,r,i,s,a,o){return r+(i=="$"?i+s:fs(Tk(s)+e.c))+(a=="$"?a+o:Ki(Ek(o)+e.r))})}function gve(n){return n.length!=1}function Yr(n){n.l+=1}function Uu(n,e){var t=n.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function jB(n,e,t){var r=2;if(t){if(t.biff>=2&&t.biff<=5)return VB(n);t.biff==12&&(r=4)}var i=n.read_shift(r),s=n.read_shift(r),a=Uu(n),o=Uu(n);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function VB(n){var e=Uu(n),t=Uu(n),r=n.read_shift(1),i=n.read_shift(1);return{s:{r:e[0],c:r,cRel:e[1],rRel:e[2]},e:{r:t[0],c:i,cRel:t[1],rRel:t[2]}}}function mve(n,e,t){if(t.biff<8)return VB(n);var r=n.read_shift(t.biff==12?4:2),i=n.read_shift(t.biff==12?4:2),s=Uu(n),a=Uu(n);return{s:{r,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function GB(n,e,t){if(t&&t.biff>=2&&t.biff<=5)return pve(n);var r=n.read_shift(t&&t.biff==12?4:2),i=Uu(n);return{r,c:i[0],cRel:i[1],rRel:i[2]}}function pve(n){var e=Uu(n),t=n.read_shift(1);return{r:e[0],c:t,cRel:e[1],rRel:e[2]}}function yve(n){var e=n.read_shift(2),t=n.read_shift(2);return{r:e,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function xve(n,e,t){var r=t&&t.biff?t.biff:8;if(r>=2&&r<=5)return _ve(n);var i=n.read_shift(r>=12?4:2),s=n.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function _ve(n){var e=n.read_shift(2),t=n.read_shift(1),r=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,r==1&&e>=8192&&(e=e-16384),i==1&&t>=128&&(t=t-256),{r:e,c:t,cRel:i,rRel:r}}function vve(n,e,t){var r=(n[n.l++]&96)>>5,i=jB(n,t.biff>=2&&t.biff<=5?6:8,t);return[r,i]}function wve(n,e,t){var r=(n[n.l++]&96)>>5,i=n.read_shift(2,"i"),s=8;if(t)switch(t.biff){case 5:n.l+=12,s=6;break;case 12:s=12;break}var a=jB(n,s,t);return[r,i,a]}function Eve(n,e,t){var r=(n[n.l++]&96)>>5;return n.l+=t&&t.biff>8?12:t.biff<8?6:8,[r]}function Tve(n,e,t){var r=(n[n.l++]&96)>>5,i=n.read_shift(2),s=8;if(t)switch(t.biff){case 5:n.l+=12,s=6;break;case 12:s=12;break}return n.l+=s,[r,i]}function Sve(n,e,t){var r=(n[n.l++]&96)>>5,i=mve(n,e-1,t);return[r,i]}function bve(n,e,t){var r=(n[n.l++]&96)>>5;return n.l+=t.biff==2?6:t.biff==12?14:7,[r]}function sD(n){var e=n[n.l+1]&1,t=1;return n.l+=4,[e,t]}function Rve(n,e,t){n.l+=2;for(var r=n.read_shift(t&&t.biff==2?1:2),i=[],s=0;s<=r;++s)i.push(n.read_shift(t&&t.biff==2?1:2));return i}function Ave(n,e,t){var r=n[n.l+1]&255?1:0;return n.l+=2,[r,n.read_shift(t&&t.biff==2?1:2)]}function Ive(n,e,t){var r=n[n.l+1]&255?1:0;return n.l+=2,[r,n.read_shift(t&&t.biff==2?1:2)]}function Cve(n){var e=n[n.l+1]&255?1:0;return n.l+=2,[e,n.read_shift(2)]}function kve(n,e,t){var r=n[n.l+1]&255?1:0;return n.l+=t&&t.biff==2?3:4,[r]}function BB(n){var e=n.read_shift(1),t=n.read_shift(1);return[e,t]}function Pve(n){return n.read_shift(2),BB(n)}function Mve(n){return n.read_shift(2),BB(n)}function Nve(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=GB(n,0,t);return[r,i]}function Lve(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=xve(n,0,t);return[r,i]}function Ove(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=n.read_shift(2);t&&t.biff==5&&(n.l+=12);var s=GB(n,0,t);return[r,i,s]}function Dve(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=n.read_shift(t&&t.biff<=3?1:2);return[Dwe[i],$B[i],r]}function Fve(n,e,t){var r=n[n.l++],i=n.read_shift(1),s=t&&t.biff<=3?[r==88?-1:0,n.read_shift(1)]:jve(n);return[i,(s[0]===0?$B:Owe)[s[1]]]}function jve(n){return[n[n.l+1]>>7,n.read_shift(2)&32767]}function Vve(n,e,t){n.l+=t&&t.biff==2?3:4}function Gve(n,e,t){if(n.l++,t&&t.biff==12)return[n.read_shift(4,"i"),0];var r=n.read_shift(2),i=n.read_shift(t&&t.biff==2?1:2);return[r,i]}function Bve(n){return n.l++,c1[n.read_shift(1)]}function zve(n){return n.l++,n.read_shift(2)}function Uve(n){return n.l++,n.read_shift(1)!==0}function $ve(n){return n.l++,Tg(n)}function Wve(n,e,t){return n.l++,TB(n,e-1,t)}function Hve(n,e){var t=[n.read_shift(1)];if(e==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=Oxe(n,1)?"TRUE":"FALSE",e!=12&&(n.l+=7);break;case 37:case 16:t[1]=c1[n[n.l]],n.l+=e==12?4:8;break;case 0:n.l+=8;break;case 1:t[1]=Tg(n);break;case 2:t[1]=Vxe(n,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function Kve(n,e,t){for(var r=n.read_shift(t.biff==12?4:2),i=[],s=0;s!=r;++s)i.push((t.biff==12?zd:zxe)(n));return i}function Xve(n,e,t){var r=0,i=0;t.biff==12?(r=n.read_shift(4),i=n.read_shift(4)):(i=1+n.read_shift(1),r=1+n.read_shift(2)),t.biff>=2&&t.biff<8&&(--r,--i==0&&(i=256));for(var s=0,a=[];s!=r&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=Hve(n,t.biff);return a}function qve(n,e,t){var r=n.read_shift(1)>>>5&3,i=!t||t.biff>=8?4:2,s=n.read_shift(i);switch(t.biff){case 2:n.l+=5;break;case 3:case 4:n.l+=8;break;case 5:n.l+=12;break}return[r,0,s]}function Yve(n,e,t){if(t.biff==5)return Zve(n);var r=n.read_shift(1)>>>5&3,i=n.read_shift(2),s=n.read_shift(4);return[r,i,s]}function Zve(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2,"i");n.l+=8;var r=n.read_shift(2);return n.l+=12,[e,t,r]}function Jve(n,e,t){var r=n.read_shift(1)>>>5&3;n.l+=t&&t.biff==2?3:4;var i=n.read_shift(t&&t.biff==2?1:2);return[r,i]}function Qve(n,e,t){var r=n.read_shift(1)>>>5&3,i=n.read_shift(t&&t.biff==2?1:2);return[r,i]}function ewe(n,e,t){var r=n.read_shift(1)>>>5&3;return n.l+=4,t.biff<8&&n.l--,t.biff==12&&(n.l+=2),[r]}function twe(n,e,t){var r=(n[n.l++]&96)>>5,i=n.read_shift(2),s=4;if(t)switch(t.biff){case 5:s=15;break;case 12:s=6;break}return n.l+=s,[r,i]}var nwe=ml,rwe=ml,iwe=ml;function u1(n,e,t){return n.l+=2,[yve(n)]}function Pk(n){return n.l+=6,[]}var swe=u1,awe=Pk,owe=Pk,lwe=u1;function zB(n){return n.l+=2,[wB(n),n.read_shift(2)&1]}var cwe=u1,uwe=zB,hwe=Pk,dwe=u1,fwe=u1,gwe=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function mwe(n){n.l+=2;var e=n.read_shift(2),t=n.read_shift(2),r=n.read_shift(4),i=n.read_shift(2),s=n.read_shift(2),a=gwe[t>>2&31];return{ixti:e,coltype:t&3,rt:a,idx:r,c:i,C:s}}function pwe(n){return n.l+=2,[n.read_shift(4)]}function ywe(n,e,t){return n.l+=5,n.l+=2,n.l+=t.biff==2?1:4,["PTGSHEET"]}function xwe(n,e,t){return n.l+=t.biff==2?4:5,["PTGENDSHEET"]}function _we(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2);return[e,t]}function vwe(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2);return[e,t]}function wwe(n){return n.l+=4,[0,0]}var aD={1:{n:"PtgExp",f:Gve},2:{n:"PtgTbl",f:iwe},3:{n:"PtgAdd",f:Yr},4:{n:"PtgSub",f:Yr},5:{n:"PtgMul",f:Yr},6:{n:"PtgDiv",f:Yr},7:{n:"PtgPower",f:Yr},8:{n:"PtgConcat",f:Yr},9:{n:"PtgLt",f:Yr},10:{n:"PtgLe",f:Yr},11:{n:"PtgEq",f:Yr},12:{n:"PtgGe",f:Yr},13:{n:"PtgGt",f:Yr},14:{n:"PtgNe",f:Yr},15:{n:"PtgIsect",f:Yr},16:{n:"PtgUnion",f:Yr},17:{n:"PtgRange",f:Yr},18:{n:"PtgUplus",f:Yr},19:{n:"PtgUminus",f:Yr},20:{n:"PtgPercent",f:Yr},21:{n:"PtgParen",f:Yr},22:{n:"PtgMissArg",f:Yr},23:{n:"PtgStr",f:Wve},26:{n:"PtgSheet",f:ywe},27:{n:"PtgEndSheet",f:xwe},28:{n:"PtgErr",f:Bve},29:{n:"PtgBool",f:Uve},30:{n:"PtgInt",f:zve},31:{n:"PtgNum",f:$ve},32:{n:"PtgArray",f:bve},33:{n:"PtgFunc",f:Dve},34:{n:"PtgFuncVar",f:Fve},35:{n:"PtgName",f:qve},36:{n:"PtgRef",f:Nve},37:{n:"PtgArea",f:vve},38:{n:"PtgMemArea",f:Jve},39:{n:"PtgMemErr",f:nwe},40:{n:"PtgMemNoMem",f:rwe},41:{n:"PtgMemFunc",f:Qve},42:{n:"PtgRefErr",f:ewe},43:{n:"PtgAreaErr",f:Eve},44:{n:"PtgRefN",f:Lve},45:{n:"PtgAreaN",f:Sve},46:{n:"PtgMemAreaN",f:_we},47:{n:"PtgMemNoMemN",f:vwe},57:{n:"PtgNameX",f:Yve},58:{n:"PtgRef3d",f:Ove},59:{n:"PtgArea3d",f:wve},60:{n:"PtgRefErr3d",f:twe},61:{n:"PtgAreaErr3d",f:Tve},255:{}},Ewe={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Twe={1:{n:"PtgElfLel",f:zB},2:{n:"PtgElfRw",f:dwe},3:{n:"PtgElfCol",f:swe},6:{n:"PtgElfRwV",f:fwe},7:{n:"PtgElfColV",f:lwe},10:{n:"PtgElfRadical",f:cwe},11:{n:"PtgElfRadicalS",f:hwe},13:{n:"PtgElfColS",f:awe},15:{n:"PtgElfColSV",f:owe},16:{n:"PtgElfRadicalLel",f:uwe},25:{n:"PtgList",f:mwe},29:{n:"PtgSxName",f:pwe},255:{}},Swe={0:{n:"PtgAttrNoop",f:wwe},1:{n:"PtgAttrSemi",f:kve},2:{n:"PtgAttrIf",f:Ive},4:{n:"PtgAttrChoose",f:Rve},8:{n:"PtgAttrGoto",f:Ave},16:{n:"PtgAttrSum",f:Vve},32:{n:"PtgAttrBaxcel",f:sD},33:{n:"PtgAttrBaxcel",f:sD},64:{n:"PtgAttrSpace",f:Pve},65:{n:"PtgAttrSpaceSemi",f:Mve},128:{n:"PtgAttrIfError",f:Cve},255:{}};function bwe(n,e,t,r){if(r.biff<8)return ml(n,e);for(var i=n.l+e,s=[],a=0;a!==t.length;++a)switch(t[a][0]){case"PtgArray":t[a][1]=Xve(n,0,r),s.push(t[a][1]);break;case"PtgMemArea":t[a][2]=Kve(n,t[a][1],r),s.push(t[a][2]);break;case"PtgExp":r&&r.biff==12&&(t[a][1][1]=n.read_shift(4),s.push(t[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[a][0]}return e=i-n.l,e!==0&&s.push(ml(n,e)),s}function Rwe(n,e,t){for(var r=n.l+e,i,s,a=[];r!=n.l;)e=r-n.l,s=n[n.l],i=aD[s]||aD[Ewe[s]],(s===24||s===25)&&(i=(s===24?Twe:Swe)[n[n.l+1]]),!i||!i.f?ml(n,e):a.push([i.n,i.f(n,e,t)]);return a}function Awe(n){for(var e=[],t=0;t<n.length;++t){for(var r=n[t],i=[],s=0;s<r.length;++s){var a=r[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var Iwe={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Cwe(n,e){if(!n&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(n)?"'"+n+"'":n}function UB(n,e,t){if(!n)return"SH33TJSERR0";if(t.biff>8&&(!n.XTI||!n.XTI[e]))return n.SheetNames[e];if(!n.XTI)return"SH33TJSERR6";var r=n.XTI[e];if(t.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":n.XTI[e-1];if(!r)return"SH33TJSERR1";var i="";if(t.biff>8)switch(n[r[0]][0]){case 357:return i=r[1]==-1?"#REF":n.SheetNames[r[1]],r[1]==r[2]?i:i+":"+n.SheetNames[r[2]];case 358:return t.SID!=null?n.SheetNames[t.SID]:"SH33TJSSAME"+n[r[0]][0];case 355:default:return"SH33TJSSRC"+n[r[0]][0]}switch(n[r[0]][0][0]){case 1025:return i=r[1]==-1?"#REF":n.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?i:i+":"+n.SheetNames[r[2]];case 14849:return n[r[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return n[r[0]][0][3]?(i=r[1]==-1?"#REF":n[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?i:i+":"+n[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function oD(n,e,t){var r=UB(n,e,t);return r=="#REF"?r:Cwe(r,t)}function ag(n,e,t,r,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},o=[],l,c,h,f=0,m=0,y,x="";if(!n[0]||!n[0][0])return"";for(var _=-1,w="",S=0,b=n[0].length;S<b;++S){var R=n[0][S];switch(R[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),_>=0){switch(n[0][_][1][0]){case 0:w=jr(" ",n[0][_][1][1]);break;case 1:w=jr("\r",n[0][_][1][1]);break;default:if(w="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][_][1][0])}c=c+w,_=-1}o.push(c+Iwe[R[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=gp(R[1][1],a,i),o.push(mp(h,s));break;case"PtgRefN":h=t?gp(R[1][1],t,i):R[1][1],o.push(mp(h,s));break;case"PtgRef3d":f=R[1][1],h=gp(R[1][2],a,i),x=oD(r,f,i),o.push(x+"!"+mp(h,s));break;case"PtgFunc":case"PtgFuncVar":var M=R[1][0],O=R[1][1];M||(M=0),M&=127;var G=M==0?[]:o.slice(-M);o.length-=M,O==="User"&&(O=G.shift()),o.push(O+"("+G.join(",")+")");break;case"PtgBool":o.push(R[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(R[1]);break;case"PtgNum":o.push(String(R[1]));break;case"PtgStr":o.push('"'+R[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(R[1]);break;case"PtgAreaN":y=W5(R[1][1],t?{s:t}:a,i),o.push(zS(y,i));break;case"PtgArea":y=W5(R[1][1],a,i),o.push(zS(y,i));break;case"PtgArea3d":f=R[1][1],y=R[1][2],x=oD(r,f,i),o.push(x+"!"+zS(y,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=R[1][2];var A=(r.names||[])[m-1]||(r[0]||[])[m],I=A?A.Name:"SH33TJSNAME"+String(m);I&&I.slice(0,6)=="_xlfn."&&!i.xlfn&&(I=I.slice(6)),o.push(I);break;case"PtgNameX":var P=R[1][1];m=R[1][2];var D;if(i.biff<=5)P<0&&(P=-P),r[P]&&(D=r[P][m]);else{var L="";if(((r[P]||[])[0]||[])[0]==14849||(((r[P]||[])[0]||[])[0]==1025?r[P][m]&&r[P][m].itab>0&&(L=r.SheetNames[r[P][m].itab-1]+"!"):L=r.SheetNames[m-1]+"!"),r[P]&&r[P][m])L+=r[P][m].Name;else if(r[0]&&r[0][m])L+=r[0][m].Name;else{var U=(UB(r,P,i)||"").split(";;");U[m-1]?L=U[m-1]:L+="SH33TJSERRX"}o.push(L);break}D||(D={Name:"SH33TJSERRY"}),o.push(D.Name);break;case"PtgParen":var j="(",Ee=")";if(_>=0){switch(w="",n[0][_][1][0]){case 2:j=jr(" ",n[0][_][1][1])+j;break;case 3:j=jr("\r",n[0][_][1][1])+j;break;case 4:Ee=jr(" ",n[0][_][1][1])+Ee;break;case 5:Ee=jr("\r",n[0][_][1][1])+Ee;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][_][1][0])}_=-1}o.push(j+o.pop()+Ee);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":h={c:R[1][1],r:R[1][0]};var ke={c:t.c,r:t.r};if(r.sharedf[er(h)]){var Be=r.sharedf[er(h)];o.push(ag(Be,a,ke,r,i))}else{var Me=!1;for(l=0;l!=r.arrayf.length;++l)if(c=r.arrayf[l],!(h.c<c[0].s.c||h.c>c[0].e.c)&&!(h.r<c[0].s.r||h.r>c[0].e.r)){o.push(ag(c[1],a,ke,r,i)),Me=!0;break}Me||o.push(R[1])}break;case"PtgArray":o.push("{"+Awe(R[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":_=S;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+R[1].idx+"[#"+R[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(R));default:throw new Error("Unrecognized Formula Token: "+String(R))}var ce=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&_>=0&&ce.indexOf(n[0][S][0])==-1){R=n[0][_];var Pe=!0;switch(R[1][0]){case 4:Pe=!1;case 0:w=jr(" ",R[1][1]);break;case 5:Pe=!1;case 1:w=jr("\r",R[1][1]);break;default:if(w="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+R[1][0])}o.push((Pe?w:"")+o.pop()+(Pe?"":w)),_=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function kwe(n){if(n==null){var e=Ne(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof n=="number")return Td(n);return Td(0)}function Pwe(n,e,t,r,i){var s=Sd(e,t,i),a=kwe(n.v),o=Ne(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var c=Ne(n.bf.length),h=0;h<n.bf.length;++h)c[h]=n.bf[h];var f=Wi([s,a,o,c]);return f}function UE(n,e,t){var r=n.read_shift(4),i=Rwe(n,r,t),s=n.read_shift(4),a=s>0?bwe(n,s,i,t):null;return[i,a]}var Mwe=UE,$E=UE,Nwe=UE,Lwe=UE,Owe={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},$B={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Dwe={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Fwe(n){var e="of:="+n.replace(Ck,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function jwe(n){return n.replace(/\./,"!")}var pp=typeof Map<"u";function Mk(n,e,t){var r=0,i=n.length;if(t){if(pp?t.has(e):Object.prototype.hasOwnProperty.call(t,e)){for(var s=pp?t.get(e):t[e];r<s.length;++r)if(n[s[r]].t===e)return n.Count++,s[r]}}else for(;r<i;++r)if(n[r].t===e)return n.Count++,r;return n[i]={t:e},n.Count++,n.Unique++,t&&(pp?(t.has(e)||t.set(e,[]),t.get(e).push(i)):(Object.prototype.hasOwnProperty.call(t,e)||(t[e]=[]),t[e].push(i))),i}function WE(n,e){var t={min:n+1,max:n+1},r=-1;return e.MDW&&(nc=e.MDW),e.width!=null?t.customWidth=1:e.wpx!=null?r=hw(e.wpx):e.wch!=null&&(r=e.wch),r>-1?(t.width=ZR(r),t.customWidth=1):e.width!=null&&(t.width=e.width),e.hidden&&(t.hidden=!0),e.level!=null&&(t.outlineLevel=t.level=e.level),t}function WB(n,e){if(n){var t=[.7,.7,.75,.75,.3,.3];n.left==null&&(n.left=t[0]),n.right==null&&(n.right=t[1]),n.top==null&&(n.top=t[2]),n.bottom==null&&(n.bottom=t[3]),n.header==null&&(n.header=t[4]),n.footer==null&&(n.footer=t[5])}}function Ju(n,e,t){var r=t.revssf[e.z!=null?e.z:"General"],i=60,s=n.length;if(r==null&&t.ssf){for(;i<392;++i)if(t.ssf[i]==null){GG(e.z,i),t.ssf[i]=e.z,t.revssf[e.z]=r=i;break}}for(i=0;i!=s;++i)if(n[i].numFmtId===r)return i;return n[s]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function Vwe(n,e,t){if(n&&n["!ref"]){var r=mr(n["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+t+"): "+n["!ref"])}}function Gwe(n){if(n.length===0)return"";for(var e='<mergeCells count="'+n.length+'">',t=0;t!=n.length;++t)e+='<mergeCell ref="'+ri(n[t])+'"/>';return e+"</mergeCells>"}function Bwe(n,e,t,r,i){var s=!1,a={},o=null;if(r.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[t];try{e.Workbook&&(l=e.Workbook.Sheets[t].CodeName||l)}catch{}s=!0,a.codeName=hy(Jn(l))}if(n&&n["!outline"]){var c={summaryBelow:1,summaryRight:1};n["!outline"].above&&(c.summaryBelow=0),n["!outline"].left&&(c.summaryRight=0),o=(o||"")+it("outlinePr",null,c)}!s&&!o||(i[i.length]=it("sheetPr",o,a))}var zwe=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Uwe=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function $we(n){var e={sheet:1};return zwe.forEach(function(t){n[t]!=null&&n[t]&&(e[t]="1")}),Uwe.forEach(function(t){n[t]!=null&&!n[t]&&(e[t]="0")}),n.password&&(e.password=IB(n.password).toString(16).toUpperCase()),it("sheetProtection",null,e)}function Wwe(n){return WB(n),it("pageMargins",null,n)}function Hwe(n,e){for(var t=["<cols>"],r,i=0;i!=e.length;++i)(r=e[i])&&(t[t.length]=it("col",null,WE(i,r)));return t[t.length]="</cols>",t.join("")}function Kwe(n,e,t,r){var i=typeof n.ref=="string"?n.ref:ri(n.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var s=t.Workbook.Names,a=xa(i);a.s.r==a.e.r&&(a.e.r=xa(e["!ref"]).e.r,i=ri(a));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==r){l.Ref="'"+t.SheetNames[r]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+t.SheetNames[r]+"'!"+i}),it("autoFilter",null,{ref:i})}function Xwe(n,e,t,r){var i={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),it("sheetViews",it("sheetView",null,i),{})}function qwe(n,e,t,r){if(n.c&&t["!comments"].push([e,n.c]),n.v===void 0&&typeof n.f!="string"||n.t==="z"&&!n.f)return"";var i="",s=n.t,a=n.v;if(n.t!=="z")switch(n.t){case"b":i=n.v?"1":"0";break;case"n":i=""+n.v;break;case"e":i=c1[n.v];break;case"d":r&&r.cellDates?i=Rs(n.v,-1).toISOString():(n=Xs(n),n.t="n",i=""+(n.v=Ks(Rs(n.v)))),typeof n.z>"u"&&(n.z=Gr[14]);break;default:i=n.v;break}var o=Hi("v",Jn(i)),l={r:e},c=Ju(r.cellXfs,n,r);switch(c!==0&&(l.s=c),n.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(n.v==null){delete n.t;break}if(n.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){o=Hi("v",""+Mk(r.Strings,n.v,r.revStrings)),l.t="s";break}l.t="str";break}if(n.t!=s&&(n.t=s,n.v=a),typeof n.f=="string"&&n.f){var h=n.F&&n.F.slice(0,e.length)==e?{t:"array",ref:n.F}:null;o=it("f",Jn(n.f),h)+(n.v!=null?o:"")}return n.l&&t["!links"].push([e,n.l]),n.D&&(l.cm=1),it("c",o,l)}function Ywe(n,e,t,r){var i=[],s=[],a=mr(n["!ref"]),o="",l,c="",h=[],f=0,m=0,y=n["!rows"],x=Array.isArray(n),_={r:c},w,S=-1;for(m=a.s.c;m<=a.e.c;++m)h[m]=fs(m);for(f=a.s.r;f<=a.e.r;++f){for(s=[],c=Ki(f),m=a.s.c;m<=a.e.c;++m){l=h[m]+c;var b=x?(n[f]||[])[m]:n[l];b!==void 0&&(o=qwe(b,l,n,e))!=null&&s.push(o)}(s.length>0||y&&y[f])&&(_={r:c},y&&y[f]&&(w=y[f],w.hidden&&(_.hidden=1),S=-1,w.hpx?S=dw(w.hpx):w.hpt&&(S=w.hpt),S>-1&&(_.ht=S,_.customHeight=1),w.level&&(_.outlineLevel=w.level)),i[i.length]=it("row",s.join(""),_))}if(y)for(;f<y.length;++f)y&&y[f]&&(_={r:f+1},w=y[f],w.hidden&&(_.hidden=1),S=-1,w.hpx?S=dw(w.hpx):w.hpt&&(S=w.hpt),S>-1&&(_.ht=S,_.customHeight=1),w.level&&(_.outlineLevel=w.level),i[i.length]=it("row","",_));return i.join("")}function HB(n,e,t,r){var i=[ai,it("worksheet",null,{xmlns:vg[0],"xmlns:r":Ai.r})],s=t.SheetNames[n],a=0,o="",l=t.Sheets[s];l==null&&(l={});var c=l["!ref"]||"A1",h=mr(c);if(h.e.c>16383||h.e.r>1048575){if(e.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575),c=ri(h)}r||(r={}),l["!comments"]=[];var f=[];Bwe(l,t,n,e,i),i[i.length]=it("dimension",null,{ref:c}),i[i.length]=Xwe(l,e,n,t),e.sheetFormat&&(i[i.length]=it("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=Hwe(l,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=Ywe(l,e),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=$we(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=Kwe(l["!autofilter"],l,t,n)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=Gwe(l["!merges"]));var m=-1,y,x=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(_){_[1].Target&&(y={ref:_[0]},_[1].Target.charAt(0)!="#"&&(x=Xn(r,-1,Jn(_[1].Target).replace(/#.*$/,""),Pn.HLINK),y["r:id"]="rId"+x),(m=_[1].Target.indexOf("#"))>-1&&(y.location=Jn(_[1].Target.slice(m+1))),_[1].Tooltip&&(y.tooltip=Jn(_[1].Tooltip)),i[i.length]=it("hyperlink",null,y))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=Wwe(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=Hi("ignoredErrors",it("ignoredError",null,{numberStoredAsText:1,sqref:c}))),f.length>0&&(x=Xn(r,-1,"../drawings/drawing"+(n+1)+".xml",Pn.DRAW),i[i.length]=it("drawing",null,{"r:id":"rId"+x}),l["!drawing"]=f),l["!comments"].length>0&&(x=Xn(r,-1,"../drawings/vmlDrawing"+(n+1)+".vml",Pn.VML),i[i.length]=it("legacyDrawing",null,{"r:id":"rId"+x}),l["!legacy"]=x),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function Zwe(n,e){var t={},r=n.l+e;t.r=n.read_shift(4),n.l+=4;var i=n.read_shift(2);n.l+=1;var s=n.read_shift(1);return n.l=r,s&7&&(t.level=s&7),s&16&&(t.hidden=!0),s&32&&(t.hpt=i/20),t}function Jwe(n,e,t){var r=Ne(145),i=(t["!rows"]||[])[n]||{};r.write_shift(4,n),r.write_shift(4,0);var s=320;i.hpx?s=dw(i.hpx)*20:i.hpt&&(s=i.hpt*20),r.write_shift(2,s),r.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),r.write_shift(1,a),r.write_shift(1,0);var o=0,l=r.l;r.l+=4;for(var c={r:n,c:0},h=0;h<16;++h)if(!(e.s.c>h+1<<10||e.e.c<h<<10)){for(var f=-1,m=-1,y=h<<10;y<h+1<<10;++y){c.c=y;var x=Array.isArray(t)?(t[c.r]||[])[c.c]:t[er(c)];x&&(f<0&&(f=y),m=y)}f<0||(++o,r.write_shift(4,f),r.write_shift(4,m))}var _=r.l;return r.l=l,r.write_shift(4,o),r.l=_,r.length>r.l?r.slice(0,r.l):r}function Qwe(n,e,t,r){var i=Jwe(r,t,e);(i.length>17||(e["!rows"]||[])[r])&&Ue(n,0,i)}var eEe=zd,tEe=Eg;function nEe(){}function rEe(n,e){var t={},r=n[n.l];return++n.l,t.above=!(r&64),t.left=!(r&128),n.l+=18,t.name=fxe(n),t}function iEe(n,e,t){t==null&&(t=Ne(84+4*n.length));var r=192;e&&(e.above&&(r&=-65),e.left&&(r&=-129)),t.write_shift(1,r);for(var i=1;i<3;++i)t.write_shift(1,0);return lw({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),oB(n,t),t.slice(0,t.l)}function sEe(n){var e=qa(n);return[e]}function aEe(n,e,t){return t==null&&(t=Ne(8)),Vd(e,t)}function oEe(n){var e=Gd(n);return[e]}function lEe(n,e,t){return t==null&&(t=Ne(4)),Bd(e,t)}function cEe(n){var e=qa(n),t=n.read_shift(1);return[e,t,"b"]}function uEe(n,e,t){return t==null&&(t=Ne(9)),Vd(e,t),t.write_shift(1,n.v?1:0),t}function hEe(n){var e=Gd(n),t=n.read_shift(1);return[e,t,"b"]}function dEe(n,e,t){return t==null&&(t=Ne(5)),Bd(e,t),t.write_shift(1,n.v?1:0),t}function fEe(n){var e=qa(n),t=n.read_shift(1);return[e,t,"e"]}function gEe(n,e,t){return t==null&&(t=Ne(9)),Vd(e,t),t.write_shift(1,n.v),t}function mEe(n){var e=Gd(n),t=n.read_shift(1);return[e,t,"e"]}function pEe(n,e,t){return t==null&&(t=Ne(8)),Bd(e,t),t.write_shift(1,n.v),t.write_shift(2,0),t.write_shift(1,0),t}function yEe(n){var e=qa(n),t=n.read_shift(4);return[e,t,"s"]}function xEe(n,e,t){return t==null&&(t=Ne(12)),Vd(e,t),t.write_shift(4,e.v),t}function _Ee(n){var e=Gd(n),t=n.read_shift(4);return[e,t,"s"]}function vEe(n,e,t){return t==null&&(t=Ne(8)),Bd(e,t),t.write_shift(4,e.v),t}function wEe(n){var e=qa(n),t=Tg(n);return[e,t,"n"]}function EEe(n,e,t){return t==null&&(t=Ne(16)),Vd(e,t),Td(n.v,t),t}function TEe(n){var e=Gd(n),t=Tg(n);return[e,t,"n"]}function SEe(n,e,t){return t==null&&(t=Ne(12)),Bd(e,t),Td(n.v,t),t}function bEe(n){var e=qa(n),t=lB(n);return[e,t,"n"]}function REe(n,e,t){return t==null&&(t=Ne(12)),Vd(e,t),cB(n.v,t),t}function AEe(n){var e=Gd(n),t=lB(n);return[e,t,"n"]}function IEe(n,e,t){return t==null&&(t=Ne(8)),Bd(e,t),cB(n.v,t),t}function CEe(n){var e=qa(n),t=Sk(n);return[e,t,"is"]}function kEe(n){var e=qa(n),t=gs(n);return[e,t,"str"]}function PEe(n,e,t){return t==null&&(t=Ne(12+4*n.v.length)),Vd(e,t),Pi(n.v,t),t.length>t.l?t.slice(0,t.l):t}function MEe(n){var e=Gd(n),t=gs(n);return[e,t,"str"]}function NEe(n,e,t){return t==null&&(t=Ne(8+4*n.v.length)),Bd(e,t),Pi(n.v,t),t.length>t.l?t.slice(0,t.l):t}function LEe(n,e,t){var r=n.l+e,i=qa(n);i.r=t["!row"];var s=n.read_shift(1),a=[i,s,"b"];if(t.cellFormula){n.l+=2;var o=$E(n,r-n.l,t);a[3]=ag(o,null,i,t.supbooks,t)}else n.l=r;return a}function OEe(n,e,t){var r=n.l+e,i=qa(n);i.r=t["!row"];var s=n.read_shift(1),a=[i,s,"e"];if(t.cellFormula){n.l+=2;var o=$E(n,r-n.l,t);a[3]=ag(o,null,i,t.supbooks,t)}else n.l=r;return a}function DEe(n,e,t){var r=n.l+e,i=qa(n);i.r=t["!row"];var s=Tg(n),a=[i,s,"n"];if(t.cellFormula){n.l+=2;var o=$E(n,r-n.l,t);a[3]=ag(o,null,i,t.supbooks,t)}else n.l=r;return a}function FEe(n,e,t){var r=n.l+e,i=qa(n);i.r=t["!row"];var s=gs(n),a=[i,s,"str"];if(t.cellFormula){n.l+=2;var o=$E(n,r-n.l,t);a[3]=ag(o,null,i,t.supbooks,t)}else n.l=r;return a}var jEe=zd,VEe=Eg;function GEe(n,e){return e==null&&(e=Ne(4)),e.write_shift(4,n),e}function BEe(n,e){var t=n.l+e,r=zd(n),i=bk(n),s=gs(n),a=gs(n),o=gs(n);n.l=t;var l={rfx:r,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function zEe(n,e){var t=Ne(50+4*(n[1].Target.length+(n[1].Tooltip||"").length));Eg({s:ki(n[0]),e:ki(n[0])},t),Rk("rId"+e,t);var r=n[1].Target.indexOf("#"),i=r==-1?"":n[1].Target.slice(r+1);return Pi(i||"",t),Pi(n[1].Tooltip||"",t),Pi("",t),t.slice(0,t.l)}function UEe(){}function $Ee(n,e,t){var r=n.l+e,i=uB(n),s=n.read_shift(1),a=[i];if(a[2]=s,t.cellFormula){var o=Mwe(n,r-n.l,t);a[1]=o}else n.l=r;return a}function WEe(n,e,t){var r=n.l+e,i=zd(n),s=[i];if(t.cellFormula){var a=Lwe(n,r-n.l,t);s[1]=a,n.l=r}else n.l=r;return s}function HEe(n,e,t){t==null&&(t=Ne(18));var r=WE(n,e);t.write_shift(-4,n),t.write_shift(-4,n),t.write_shift(4,(r.width||10)*256),t.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof r.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),t.write_shift(2,i),t}var KB=["left","right","top","bottom","header","footer"];function KEe(n){var e={};return KB.forEach(function(t){e[t]=Tg(n)}),e}function XEe(n,e){return e==null&&(e=Ne(48)),WB(n),KB.forEach(function(t){Td(n[t],e)}),e}function qEe(n){var e=n.read_shift(2);return n.l+=28,{RTL:e&32}}function YEe(n,e,t){t==null&&(t=Ne(30));var r=924;return(((e||{}).Views||[])[0]||{}).RTL&&(r|=32),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function ZEe(n){var e=Ne(24);return e.write_shift(4,4),e.write_shift(4,1),Eg(n,e),e}function JEe(n,e){return e==null&&(e=Ne(66)),e.write_shift(2,n.password?IB(n.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?e.write_shift(4,n[t[0]]!=null&&!n[t[0]]?1:0):e.write_shift(4,n[t[0]]!=null&&n[t[0]]?0:1)}),e}function QEe(){}function e2e(){}function t2e(n,e,t,r,i,s,a){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=Xs(e),e.z=e.z||Gr[14],e.v=Ks(Rs(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var l={r:t,c:r};switch(l.s=Ju(i.cellXfs,e,i),e.l&&s["!links"].push([er(l),e.l]),e.c&&s["!comments"].push([er(l),e.c]),e.t){case"s":case"str":return i.bookSST?(o=Mk(i.Strings,e.v,i.revStrings),l.t="s",l.v=o,a?Ue(n,18,vEe(e,l)):Ue(n,7,xEe(e,l))):(l.t="str",a?Ue(n,17,NEe(e,l)):Ue(n,6,PEe(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?Ue(n,13,IEe(e,l)):Ue(n,2,REe(e,l)):a?Ue(n,16,SEe(e,l)):Ue(n,5,EEe(e,l)),!0;case"b":return l.t="b",a?Ue(n,15,dEe(e,l)):Ue(n,4,uEe(e,l)),!0;case"e":return l.t="e",a?Ue(n,14,pEe(e,l)):Ue(n,3,gEe(e,l)),!0}return a?Ue(n,12,lEe(e,l)):Ue(n,1,aEe(e,l)),!0}function n2e(n,e,t,r){var i=mr(e["!ref"]||"A1"),s,a="",o=[];Ue(n,145);var l=Array.isArray(e),c=i.e.r;e["!rows"]&&(c=Math.max(i.e.r,e["!rows"].length-1));for(var h=i.s.r;h<=c;++h){a=Ki(h),Qwe(n,e,i,h);var f=!1;if(h<=i.e.r)for(var m=i.s.c;m<=i.e.c;++m){h===i.s.r&&(o[m]=fs(m)),s=o[m]+a;var y=l?(e[h]||[])[m]:e[s];if(!y){f=!1;continue}f=t2e(n,y,h,m,r,e,f)}}Ue(n,146)}function r2e(n,e){!e||!e["!merges"]||(Ue(n,177,GEe(e["!merges"].length)),e["!merges"].forEach(function(t){Ue(n,176,VEe(t))}),Ue(n,178))}function i2e(n,e){!e||!e["!cols"]||(Ue(n,390),e["!cols"].forEach(function(t,r){t&&Ue(n,60,HEe(r,t))}),Ue(n,391))}function s2e(n,e){!e||!e["!ref"]||(Ue(n,648),Ue(n,649,ZEe(mr(e["!ref"]))),Ue(n,650))}function a2e(n,e,t){e["!links"].forEach(function(r){if(r[1].Target){var i=Xn(t,-1,r[1].Target.replace(/#.*$/,""),Pn.HLINK);Ue(n,494,zEe(r,i))}}),delete e["!links"]}function o2e(n,e,t,r){if(e["!comments"].length>0){var i=Xn(r,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Pn.VML);Ue(n,551,Rk("rId"+i)),e["!legacy"]=i}}function l2e(n,e,t,r){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:ri(i.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var a=t.Workbook.Names,o=xa(s);o.s.r==o.e.r&&(o.e.r=xa(e["!ref"]).e.r,s=ri(o));for(var l=0;l<a.length;++l){var c=a[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==r){c.Ref="'"+t.SheetNames[r]+"'!"+s;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+t.SheetNames[r]+"'!"+s}),Ue(n,161,Eg(mr(s))),Ue(n,162)}}function c2e(n,e,t){Ue(n,133),Ue(n,137,YEe(e,t)),Ue(n,138),Ue(n,134)}function u2e(n,e){e["!protect"]&&Ue(n,535,JEe(e["!protect"]))}function h2e(n,e,t,r){var i=zs(),s=t.SheetNames[n],a=t.Sheets[s]||{},o=s;try{t&&t.Workbook&&(o=t.Workbook.Sheets[n].CodeName||o)}catch{}var l=mr(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],Ue(i,129),(t.vbaraw||a["!outline"])&&Ue(i,147,iEe(o,a["!outline"])),Ue(i,148,tEe(l)),c2e(i,a,t.Workbook),i2e(i,a),n2e(i,a,n,e),u2e(i,a),l2e(i,a,t,n),r2e(i,a),a2e(i,a,r),a["!margins"]&&Ue(i,476,XEe(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&s2e(i,a),o2e(i,a,n,r),Ue(i,130),i.end()}function d2e(n,e){n.l+=10;var t=gs(n);return{name:t}}var f2e=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function g2e(n){return!n.Workbook||!n.Workbook.WBProps?"false":W1e(n.Workbook.WBProps.date1904)?"true":"false"}var m2e="][*?/\\".split("");function XB(n,e){if(n.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return m2e.forEach(function(r){if(n.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function p2e(n,e,t){n.forEach(function(r,i){XB(r);for(var s=0;s<i;++s)if(r==n[s])throw new Error("Duplicate Sheet Name: "+r);if(t){var a=e&&e[i]&&e[i].CodeName||r;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function y2e(n){if(!n||!n.SheetNames||!n.Sheets)throw new Error("Invalid Workbook");if(!n.SheetNames.length)throw new Error("Workbook is empty");var e=n.Workbook&&n.Workbook.Sheets||[];p2e(n.SheetNames,e,!!n.vbaraw);for(var t=0;t<n.SheetNames.length;++t)Vwe(n.Sheets[n.SheetNames[t]],n.SheetNames[t],t)}function qB(n){var e=[ai];e[e.length]=it("workbook",null,{xmlns:vg[0],"xmlns:r":Ai.r});var t=n.Workbook&&(n.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};n.Workbook&&n.Workbook.WBProps&&(f2e.forEach(function(o){n.Workbook.WBProps[o[0]]!=null&&n.Workbook.WBProps[o[0]]!=o[1]&&(r[o[0]]=n.Workbook.WBProps[o[0]])}),n.Workbook.WBProps.CodeName&&(r.codeName=n.Workbook.WBProps.CodeName,delete r.CodeName)),e[e.length]=it("workbookPr",null,r);var i=n.Workbook&&n.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=n.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==n.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=n.SheetNames.length;++s){var a={name:Jn(n.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=it("sheet",null,a)}return e[e.length]="</sheets>",t&&(e[e.length]="<definedNames>",n.Workbook&&n.Workbook.Names&&n.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(e[e.length]=it("definedName",Jn(o.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function x2e(n,e){var t={};return t.Hidden=n.read_shift(4),t.iTabID=n.read_shift(4),t.strRelID=YR(n),t.name=gs(n),t}function _2e(n,e){return e||(e=Ne(127)),e.write_shift(4,n.Hidden),e.write_shift(4,n.iTabID),Rk(n.strRelID,e),Pi(n.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function v2e(n,e){var t={},r=n.read_shift(4);t.defaultThemeVersion=n.read_shift(4);var i=e>8?gs(n):"";return i.length>0&&(t.CodeName=i),t.autoCompressPictures=!!(r&65536),t.backupFile=!!(r&64),t.checkCompatibility=!!(r&4096),t.date1904=!!(r&1),t.filterPrivacy=!!(r&8),t.hidePivotFieldList=!!(r&1024),t.promptedSolutions=!!(r&16),t.publishItems=!!(r&2048),t.refreshAllConnections=!!(r&262144),t.saveExternalLinkValues=!!(r&128),t.showBorderUnselectedTables=!!(r&4),t.showInkAnnotation=!!(r&32),t.showObjects=["all","placeholders","none"][r>>13&3],t.showPivotChartFilter=!!(r&32768),t.updateLinks=["userSet","never","always"][r>>8&3],t}function w2e(n,e){e||(e=Ne(72));var t=0;return n&&n.filterPrivacy&&(t|=8),e.write_shift(4,t),e.write_shift(4,0),oB(n&&n.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function E2e(n,e,t){var r=n.l+e;n.l+=4,n.l+=1;var i=n.read_shift(4),s=gxe(n),a=Nwe(n,0,t),o=bk(n);n.l=r;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function T2e(n,e){Ue(n,143);for(var t=0;t!=e.SheetNames.length;++t){var r=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[t]&&e.Workbook.Sheets[t].Hidden||0,i={Hidden:r,iTabID:t+1,strRelID:"rId"+(t+1),name:e.SheetNames[t]};Ue(n,156,_2e(i))}Ue(n,144)}function S2e(n,e){e||(e=Ne(127));for(var t=0;t!=4;++t)e.write_shift(4,0);return Pi("SheetJS",e),Pi(ew.version,e),Pi(ew.version,e),Pi("7262",e),e.length>e.l?e.slice(0,e.l):e}function b2e(n,e){e||(e=Ne(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,n),e.write_shift(4,n);var t=120;return e.write_shift(1,t),e.length>e.l?e.slice(0,e.l):e}function R2e(n,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var t=e.Workbook.Sheets,r=0,i=-1,s=-1;r<t.length;++r)!t[r]||!t[r].Hidden&&i==-1?i=r:t[r].Hidden==1&&s==-1&&(s=r);s>i||(Ue(n,135),Ue(n,158,b2e(i)),Ue(n,136))}}function A2e(n,e){var t=zs();return Ue(t,131),Ue(t,128,S2e()),Ue(t,153,w2e(n.Workbook&&n.Workbook.WBProps||null)),R2e(t,n),T2e(t,n),Ue(t,132),t.end()}function I2e(n,e,t){return(e.slice(-4)===".bin"?A2e:qB)(n)}function C2e(n,e,t,r,i){return(e.slice(-4)===".bin"?h2e:HB)(n,t,r,i)}function k2e(n,e,t){return(e.slice(-4)===".bin"?X_e:PB)(n,t)}function P2e(n,e,t){return(e.slice(-4)===".bin"?w_e:AB)(n,t)}function M2e(n,e,t){return(e.slice(-4)===".bin"?uve:DB)(n)}function N2e(n){return(n.slice(-4)===".bin"?nve:LB)()}function L2e(n,e){var t=[];return n.Props&&t.push(kxe(n.Props,e)),n.Custprops&&t.push(Pxe(n.Props,n.Custprops)),t.join("")}function O2e(){return""}function D2e(n,e){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(r,i){var s=[];s.push(it("NumberFormat",null,{"ss:Format":Jn(Gr[r.numFmtId])}));var a={"ss:ID":"s"+(21+i)};t.push(it("Style",s.join(""),a))}),it("Styles",t.join(""))}function YB(n){return it("NamedRange",null,{"ss:Name":n.Name,"ss:RefersTo":"="+kk(n.Ref,{r:0,c:0})})}function F2e(n){if(!((n||{}).Workbook||{}).Names)return"";for(var e=n.Workbook.Names,t=[],r=0;r<e.length;++r){var i=e[r];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||t.push(YB(i)))}return it("Names",t.join(""))}function j2e(n,e,t,r){if(!n||!((r||{}).Workbook||{}).Names)return"";for(var i=r.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==t&&(o.Name.match(/^_xlfn\./)||s.push(YB(o)))}return s.join("")}function V2e(n,e,t,r){if(!n)return"";var i=[];if(n["!margins"]&&(i.push("<PageSetup>"),n["!margins"].header&&i.push(it("Header",null,{"x:Margin":n["!margins"].header})),n["!margins"].footer&&i.push(it("Footer",null,{"x:Margin":n["!margins"].footer})),i.push(it("PageMargins",null,{"x:Bottom":n["!margins"].bottom||"0.75","x:Left":n["!margins"].left||"0.7","x:Right":n["!margins"].right||"0.7","x:Top":n["!margins"].top||"0.75"})),i.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[t])if(r.Workbook.Sheets[t].Hidden)i.push(it("Visible",r.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<t&&!(r.Workbook.Sheets[s]&&!r.Workbook.Sheets[s].Hidden);++s);s==t&&i.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),n["!protect"]&&(i.push(Hi("ProtectContents","True")),n["!protect"].objects&&i.push(Hi("ProtectObjects","True")),n["!protect"].scenarios&&i.push(Hi("ProtectScenarios","True")),n["!protect"].selectLockedCells!=null&&!n["!protect"].selectLockedCells?i.push(Hi("EnableSelection","NoSelection")):n["!protect"].selectUnlockedCells!=null&&!n["!protect"].selectUnlockedCells&&i.push(Hi("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){n["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":it("WorksheetOptions",i.join(""),{xmlns:la.x})}function G2e(n){return n.map(function(e){var t=$1e(e.t||""),r=it("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return it("Comment",r,{"ss:Author":e.a})}).join("")}function B2e(n,e,t,r,i,s,a){if(!n||n.v==null&&n.f==null)return"";var o={};if(n.f&&(o["ss:Formula"]="="+Jn(kk(n.f,a))),n.F&&n.F.slice(0,e.length)==e){var l=ki(n.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(n.l&&n.l.Target&&(o["ss:HRef"]=Jn(n.l.Target),n.l.Tooltip&&(o["x:HRefScreenTip"]=Jn(n.l.Tooltip))),t["!merges"])for(var c=t["!merges"],h=0;h!=c.length;++h)c[h].s.c!=a.c||c[h].s.r!=a.r||(c[h].e.c>c[h].s.c&&(o["ss:MergeAcross"]=c[h].e.c-c[h].s.c),c[h].e.r>c[h].s.r&&(o["ss:MergeDown"]=c[h].e.r-c[h].s.r));var f="",m="";switch(n.t){case"z":if(!r.sheetStubs)return"";break;case"n":f="Number",m=String(n.v);break;case"b":f="Boolean",m=n.v?"1":"0";break;case"e":f="Error",m=c1[n.v];break;case"d":f="DateTime",m=new Date(n.v).toISOString(),n.z==null&&(n.z=n.z||Gr[14]);break;case"s":f="String",m=U1e(n.v||"");break}var y=Ju(r.cellXfs,n,r);o["ss:StyleID"]="s"+(21+y),o["ss:Index"]=a.c+1;var x=n.v!=null?m:"",_=n.t=="z"?"":'<Data ss:Type="'+f+'">'+x+"</Data>";return(n.c||[]).length>0&&(_+=G2e(n.c)),it("Cell",_,o)}function z2e(n,e){var t='<Row ss:Index="'+(n+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=kB(e.hpt)),e.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(t+=' ss:Hidden="1"')),t+">"}function U2e(n,e,t,r){if(!n["!ref"])return"";var i=mr(n["!ref"]),s=n["!merges"]||[],a=0,o=[];n["!cols"]&&n["!cols"].forEach(function(w,S){Ik(w);var b=!!w.width,R=WE(S,w),M={"ss:Index":S+1};b&&(M["ss:Width"]=uw(R.width)),w.hidden&&(M["ss:Hidden"]="1"),o.push(it("Column",null,M))});for(var l=Array.isArray(n),c=i.s.r;c<=i.e.r;++c){for(var h=[z2e(c,(n["!rows"]||[])[c])],f=i.s.c;f<=i.e.c;++f){var m=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>f)&&!(s[a].s.r>c)&&!(s[a].e.c<f)&&!(s[a].e.r<c)){(s[a].s.c!=f||s[a].s.r!=c)&&(m=!0);break}if(!m){var y={r:c,c:f},x=er(y),_=l?(n[c]||[])[f]:n[x];h.push(B2e(_,x,n,e,t,r,y))}}h.push("</Row>"),h.length>2&&o.push(h.join(""))}return o.join("")}function $2e(n,e,t){var r=[],i=t.SheetNames[n],s=t.Sheets[i],a=s?j2e(s,e,n,t):"";return a.length>0&&r.push("<Names>"+a+"</Names>"),a=s?U2e(s,e,n,t):"",a.length>0&&r.push("<Table>"+a+"</Table>"),r.push(V2e(s,e,n,t)),r.join("")}function W2e(n,e){e||(e={}),n.SSF||(n.SSF=Xs(Gr)),n.SSF&&(GE(),VE(n.SSF),e.revssf=BE(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF,e.cellXfs=[],Ju(e.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(L2e(n,e)),t.push(O2e()),t.push(""),t.push("");for(var r=0;r<n.SheetNames.length;++r)t.push(it("Worksheet",$2e(r,e,n),{"ss:Name":Jn(n.SheetNames[r])}));return t[2]=D2e(n,e),t[3]=F2e(n),ai+it("Workbook",t.join(""),{xmlns:la.ss,"xmlns:o":la.o,"xmlns:x":la.x,"xmlns:ss":la.ss,"xmlns:dt":la.dt,"xmlns:html":la.html})}var WS={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function H2e(n,e){var t=[],r=[],i=[],s=0,a,o=L5(K5,"n"),l=L5(X5,"n");if(n.Props)for(a=Xi(n.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?t:Object.prototype.hasOwnProperty.call(l,a[s])?r:i).push([a[s],n.Props[a[s]]]);if(n.Custprops)for(a=Xi(n.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(n.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?t:Object.prototype.hasOwnProperty.call(l,a[s])?r:i).push([a[s],n.Custprops[a[s]]]);var c=[];for(s=0;s<i.length;++s)vB.indexOf(i[s][0])>-1||yB.indexOf(i[s][0])>-1||i[s][1]!=null&&c.push(i[s]);r.length&&nr.utils.cfb_add(e,"/SummaryInformation",Q5(r,WS.SI,l,X5)),(t.length||c.length)&&nr.utils.cfb_add(e,"/DocumentSummaryInformation",Q5(t,WS.DSI,o,K5,c.length?c:null,WS.UDI))}function K2e(n,e){var t=e||{},r=nr.utils.cfb_new({root:"R"}),i="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":i="/Workbook",t.biff=8;break;case"biff5":i="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return nr.utils.cfb_add(r,i,ZB(n,t)),t.biff==8&&(n.Props||n.Custprops)&&H2e(n,r),t.biff==8&&n.vbaraw&&hve(r,nr.read(n.vbaraw,{type:typeof n.vbaraw=="string"?"binary":"buffer"})),r}var X2e={0:{f:Zwe},1:{f:sEe},2:{f:bEe},3:{f:fEe},4:{f:cEe},5:{f:wEe},6:{f:kEe},7:{f:yEe},8:{f:FEe},9:{f:DEe},10:{f:LEe},11:{f:OEe},12:{f:oEe},13:{f:AEe},14:{f:mEe},15:{f:hEe},16:{f:TEe},17:{f:MEe},18:{f:_Ee},19:{f:Sk},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:E2e},40:{},42:{},43:{f:k_e},44:{f:I_e},45:{f:N_e},46:{f:O_e},47:{f:L_e},48:{},49:{f:oxe},50:{},51:{f:Z_e},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:l_e},62:{f:CEe},63:{f:rve},64:{f:QEe},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ml,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:qEe},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:rEe},148:{f:eEe,p:16},151:{f:UEe},152:{},153:{f:v2e},154:{},155:{},156:{f:x2e},157:{},158:{},159:{T:1,f:x_e},160:{T:-1},161:{T:1,f:zd},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:jEe},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:q_e},336:{T:-1},337:{f:eve,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:YR},357:{},358:{},359:{},360:{T:1},361:{},362:{f:n_e},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:$Ee},427:{f:WEe},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:KEe},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:nEe},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:BEe},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:YR},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:lve},633:{T:1},634:{T:-1},635:{T:1,f:ave},636:{T:-1},637:{f:hxe},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:d2e},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:e2e},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function st(n,e,t,r){var i=e;if(!isNaN(i)){var s=r||(t||[]).length||0,a=n.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&wk(t)&&n.push(t)}}function q2e(n,e,t,r){var i=(t||[]).length||0;if(i<=8224)return st(n,e,t,i);var s=e;if(!isNaN(s)){for(var a=t.parts||[],o=0,l=0,c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;var h=n.next(4);for(h.write_shift(2,s),h.write_shift(2,c),n.push(t.slice(l,l+c)),l+=c;l<i;){for(h=n.next(4),h.write_shift(2,60),c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;h.write_shift(2,c),n.push(t.slice(l,l+c)),l+=c}}}function h1(n,e,t){return n||(n=Ne(7)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,0),n.write_shift(1,0),n}function Y2e(n,e,t,r){var i=Ne(9);return h1(i,n,e),EB(t,r||"b",i),i}function Z2e(n,e,t){var r=Ne(8+2*t.length);return h1(r,n,e),r.write_shift(1,t.length),r.write_shift(t.length,t,"sbcs"),r.l<r.length?r.slice(0,r.l):r}function J2e(n,e,t,r){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?Ks(Rs(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?st(n,2,d_e(t,r,i)):st(n,3,h_e(t,r,i));return;case"b":case"e":st(n,5,Y2e(t,r,e.v,e.t));return;case"s":case"str":st(n,4,Z2e(t,r,(e.v||"").slice(0,255)));return}st(n,1,h1(null,t,r))}function Q2e(n,e,t,r){var i=Array.isArray(e),s=mr(e["!ref"]||"A1"),a,o="",l=[];if(s.e.c>255||s.e.r>16383){if(r.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=ri(s)}for(var c=s.s.r;c<=s.e.r;++c){o=Ki(c);for(var h=s.s.c;h<=s.e.c;++h){c===s.s.r&&(l[h]=fs(h)),a=l[h]+o;var f=i?(e[c]||[])[h]:e[a];f&&J2e(n,f,c,h)}}}function eTe(n,e){for(var t=e||{},r=zs(),i=0,s=0;s<n.SheetNames.length;++s)n.SheetNames[s]==t.sheet&&(i=s);if(i==0&&t.sheet&&n.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return st(r,t.biff==4?1033:t.biff==3?521:9,Ak(n,16,t)),Q2e(r,n.Sheets[n.SheetNames[i]],i,t),st(r,10),r.end()}function tTe(n,e,t){st(n,49,Xxe({sz:12,name:"Arial"},t))}function nTe(n,e,t){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&st(n,1054,Zxe(i,e[i],t))})}function rTe(n,e){var t=Ne(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),st(n,2151,t),t=Ne(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),bB(mr(e["!ref"]||"A1"),t),t.write_shift(4,4),st(n,2152,t)}function iTe(n,e){for(var t=0;t<16;++t)st(n,224,tD({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(r){st(n,224,tD(r,0,e))})}function sTe(n,e){for(var t=0;t<e["!links"].length;++t){var r=e["!links"][t];st(n,440,s_e(r)),r[1].Tooltip&&st(n,2048,a_e(r))}delete e["!links"]}function aTe(n,e){if(e){var t=0;e.forEach(function(r,i){++t<=256&&r&&st(n,125,c_e(WE(i,r),i))})}}function oTe(n,e,t,r,i){var s=16+Ju(i.cellXfs,e,i);if(e.v==null&&!e.bf){st(n,513,Sd(t,r,s));return}if(e.bf)st(n,6,Pwe(e,t,r,i,s));else switch(e.t){case"d":case"n":var a=e.t=="d"?Ks(Rs(e.v)):e.v;st(n,515,t_e(t,r,a,s));break;case"b":case"e":st(n,517,e_e(t,r,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var o=Mk(i.Strings,e.v,i.revStrings);st(n,253,qxe(t,r,o,s))}else st(n,516,Yxe(t,r,(e.v||"").slice(0,255),s,i));break;default:st(n,513,Sd(t,r,s))}}function lTe(n,e,t){var r=zs(),i=t.SheetNames[n],s=t.Sheets[i]||{},a=(t||{}).Workbook||{},o=(a.Sheets||[])[n]||{},l=Array.isArray(s),c=e.biff==8,h,f="",m=[],y=mr(s["!ref"]||"A1"),x=c?65536:16384;if(y.e.c>255||y.e.r>=x){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");y.e.c=Math.min(y.e.c,255),y.e.r=Math.min(y.e.c,x-1)}st(r,2057,Ak(t,16,e)),st(r,13,Ma(1)),st(r,12,Ma(100)),st(r,15,vs(!0)),st(r,17,vs(!1)),st(r,16,Td(.001)),st(r,95,vs(!0)),st(r,42,vs(!1)),st(r,43,vs(!1)),st(r,130,Ma(1)),st(r,128,Qxe()),st(r,131,vs(!1)),st(r,132,vs(!1)),c&&aTe(r,s["!cols"]),st(r,512,Jxe(y,e)),c&&(s["!links"]=[]);for(var _=y.s.r;_<=y.e.r;++_){f=Ki(_);for(var w=y.s.c;w<=y.e.c;++w){_===y.s.r&&(m[w]=fs(w)),h=m[w]+f;var S=l?(s[_]||[])[w]:s[h];S&&(oTe(r,S,_,w,e),c&&S.l&&s["!links"].push([h,S.l]))}}var b=o.CodeName||o.name||i;return c&&st(r,574,Kxe((a.Views||[])[0])),c&&(s["!merges"]||[]).length&&st(r,229,i_e(s["!merges"])),c&&sTe(r,s),st(r,442,SB(b)),c&&rTe(r,s),st(r,10),r.end()}function cTe(n,e,t){var r=zs(),i=(n||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=t.biff==8,l=t.biff==5;if(st(r,2057,Ak(n,5,t)),t.bookType=="xla"&&st(r,135),st(r,225,o?Ma(1200):null),st(r,193,Lxe(2)),l&&st(r,191),l&&st(r,192),st(r,226),st(r,92,Uxe("SheetJS",t)),st(r,66,Ma(o?1200:1252)),o&&st(r,353,Ma(0)),o&&st(r,448),st(r,317,u_e(n.SheetNames.length)),o&&n.vbaraw&&st(r,211),o&&n.vbaraw){var c=a.CodeName||"ThisWorkbook";st(r,442,SB(c))}st(r,156,Ma(17)),st(r,25,vs(!1)),st(r,18,vs(!1)),st(r,19,Ma(0)),o&&st(r,431,vs(!1)),o&&st(r,444,Ma(0)),st(r,61,Hxe()),st(r,64,vs(!1)),st(r,141,Ma(0)),st(r,34,vs(g2e(n)=="true")),st(r,14,vs(!0)),o&&st(r,439,vs(!1)),st(r,218,Ma(0)),tTe(r,n,t),nTe(r,n.SSF,t),iTe(r,t),o&&st(r,352,vs(!1));var h=r.end(),f=zs();o&&st(f,140,o_e()),o&&t.Strings&&q2e(f,252,Wxe(t.Strings)),st(f,10);var m=f.end(),y=zs(),x=0,_=0;for(_=0;_<n.SheetNames.length;++_)x+=(o?12:11)+(o?2:1)*n.SheetNames[_].length;var w=h.length+x+m.length;for(_=0;_<n.SheetNames.length;++_){var S=s[_]||{};st(y,133,$xe({pos:w,hs:S.Hidden||0,dt:0,name:n.SheetNames[_]},t)),w+=e[_].length}var b=y.end();if(x!=b.length)throw new Error("BS8 "+x+" != "+b.length);var R=[];return h.length&&R.push(h),b.length&&R.push(b),m.length&&R.push(m),Wi(R)}function uTe(n,e){var t=e||{},r=[];n&&!n.SSF&&(n.SSF=Xs(Gr)),n&&n.SSF&&(GE(),VE(n.SSF),t.revssf=BE(n.SSF),t.revssf[n.SSF[65535]]=0,t.ssf=n.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Nk(t),t.cellXfs=[],Ju(t.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={});for(var i=0;i<n.SheetNames.length;++i)r[r.length]=lTe(i,t,n);return r.unshift(cTe(n,r,t)),Wi(r)}function ZB(n,e){for(var t=0;t<=n.SheetNames.length;++t){var r=n.Sheets[n.SheetNames[t]];if(!(!r||!r["!ref"])){var i=xa(r["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+n.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return uTe(n,e);case 4:case 3:case 2:return eTe(n,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function hTe(n,e,t,r){for(var i=n["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>t||i[c].s.c>a)&&!(i[c].e.r<t||i[c].e.c<a)){if(i[c].s.r<t||i[c].s.c<a){o=-1;break}o=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(o<0)){var h=er({r:t,c:a}),f=r.dense?(n[t]||[])[a]:n[h],m=f&&f.v!=null&&(f.h||z1e(f.w||(dc(f),f.w)||""))||"",y={};o>1&&(y.rowspan=o),l>1&&(y.colspan=l),r.editable?m='<span contenteditable="true">'+m+"</span>":f&&(y["data-t"]=f&&f.t||"z",f.v!=null&&(y["data-v"]=f.v),f.z!=null&&(y["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+f.l.Target+'">'+m+"</a>")),y.id=(r.id||"sjs")+"-"+h,s.push(it("td",m,y))}}var x="<tr>";return x+s.join("")+"</tr>"}var dTe='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',fTe="</body></html>";function gTe(n,e,t){var r=[];return r.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function JB(n,e){var t=e||{},r=t.header!=null?t.header:dTe,i=t.footer!=null?t.footer:fTe,s=[r],a=xa(n["!ref"]);t.dense=Array.isArray(n),s.push(gTe(n,a,t));for(var o=a.s.r;o<=a.e.r;++o)s.push(hTe(n,a,o,t));return s.push("</table>"+i),s.join("")}function QB(n,e,t){var r=t||{},i=0,s=0;if(r.origin!=null)if(typeof r.origin=="number")i=r.origin;else{var a=typeof r.origin=="string"?ki(r.origin):r.origin;i=a.r,s=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(r.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:i,c:s}};if(n["!ref"]){var h=xa(n["!ref"]);c.s.r=Math.min(c.s.r,h.s.r),c.s.c=Math.min(c.s.c,h.s.c),c.e.r=Math.max(c.e.r,h.e.r),c.e.c=Math.max(c.e.c,h.e.c),i==-1&&(c.e.r=i=h.e.r+1)}var f=[],m=0,y=n["!rows"]||(n["!rows"]=[]),x=0,_=0,w=0,S=0,b=0,R=0;for(n["!cols"]||(n["!cols"]=[]);x<o.length&&_<l;++x){var M=o[x];if(lD(M)){if(r.display)continue;y[_]={hidden:!0}}var O=M.children;for(w=S=0;w<O.length;++w){var G=O[w];if(!(r.display&&lD(G))){var A=G.hasAttribute("data-v")?G.getAttribute("data-v"):G.hasAttribute("v")?G.getAttribute("v"):H1e(G.innerHTML),I=G.getAttribute("data-z")||G.getAttribute("z");for(m=0;m<f.length;++m){var P=f[m];P.s.c==S+s&&P.s.r<_+i&&_+i<=P.e.r&&(S=P.e.c+1-s,m=-1)}R=+G.getAttribute("colspan")||1,((b=+G.getAttribute("rowspan")||1)>1||R>1)&&f.push({s:{r:_+i,c:S+s},e:{r:_+i+(b||1)-1,c:S+s+(R||1)-1}});var D={t:"s",v:A},L=G.getAttribute("data-t")||G.getAttribute("t")||"";A!=null&&(A.length==0?D.t=L||"z":r.raw||A.trim().length==0||L=="s"||(A==="TRUE"?D={t:"b",v:!0}:A==="FALSE"?D={t:"b",v:!1}:isNaN(tc(A))?isNaN(uy(A).getDate())||(D={t:"d",v:Rs(A)},r.cellDates||(D={t:"n",v:Ks(D.v)}),D.z=r.dateNF||Gr[14]):D={t:"n",v:tc(A)})),D.z===void 0&&I!=null&&(D.z=I);var U="",j=G.getElementsByTagName("A");if(j&&j.length)for(var Ee=0;Ee<j.length&&!(j[Ee].hasAttribute("href")&&(U=j[Ee].getAttribute("href"),U.charAt(0)!="#"));++Ee);U&&U.charAt(0)!="#"&&(D.l={Target:U}),r.dense?(n[_+i]||(n[_+i]=[]),n[_+i][S+s]=D):n[er({c:S+s,r:_+i})]=D,c.e.c<S+s&&(c.e.c=S+s),S+=R}}++_}return f.length&&(n["!merges"]=(n["!merges"]||[]).concat(f)),c.e.r=Math.max(c.e.r,_-1+i),n["!ref"]=ri(c),_>=l&&(n["!fullref"]=ri((c.e.r=o.length-x+_-1+i,c))),n}function ez(n,e){var t=e||{},r=t.dense?[]:{};return QB(r,n,e)}function mTe(n,e){return jd(ez(n,e),e)}function lD(n){var e="",t=pTe(n);return t&&(e=t(n).getPropertyValue("display")),e||(e=n.style&&n.style.display),e==="none"}function pTe(n){return n.ownerDocument.defaultView&&typeof n.ownerDocument.defaultView.getComputedStyle=="function"?n.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var yTe=(function(){var n=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+dy({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+n+"</office:document-styles>";return function(){return ai+e}})(),cD=(function(){var n=function(s){return Jn(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,r=function(s,a,o){var l=[];l.push('      <table:table table:name="'+Jn(a.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,h=0,f=xa(s["!ref"]||"A1"),m=s["!merges"]||[],y=0,x=Array.isArray(s);if(s["!cols"])for(h=0;h<=f.e.c;++h)l.push("        <table:table-column"+(s["!cols"][h]?' table:style-name="co'+s["!cols"][h].ods+'"':"")+`></table:table-column>
`);var _="",w=s["!rows"]||[];for(c=0;c<f.s.r;++c)_=w[c]?' table:style-name="ro'+w[c].ods+'"':"",l.push("        <table:table-row"+_+`></table:table-row>
`);for(;c<=f.e.r;++c){for(_=w[c]?' table:style-name="ro'+w[c].ods+'"':"",l.push("        <table:table-row"+_+`>
`),h=0;h<f.s.c;++h)l.push(e);for(;h<=f.e.c;++h){var S=!1,b={},R="";for(y=0;y!=m.length;++y)if(!(m[y].s.c>h)&&!(m[y].s.r>c)&&!(m[y].e.c<h)&&!(m[y].e.r<c)){(m[y].s.c!=h||m[y].s.r!=c)&&(S=!0),b["table:number-columns-spanned"]=m[y].e.c-m[y].s.c+1,b["table:number-rows-spanned"]=m[y].e.r-m[y].s.r+1;break}if(S){l.push(t);continue}var M=er({r:c,c:h}),O=x?(s[c]||[])[h]:s[M];if(O&&O.f&&(b["table:formula"]=Jn(Fwe(O.f)),O.F&&O.F.slice(0,M.length)==M)){var G=xa(O.F);b["table:number-matrix-columns-spanned"]=G.e.c-G.s.c+1,b["table:number-matrix-rows-spanned"]=G.e.r-G.s.r+1}if(!O){l.push(e);continue}switch(O.t){case"b":R=O.v?"TRUE":"FALSE",b["office:value-type"]="boolean",b["office:boolean-value"]=O.v?"true":"false";break;case"n":R=O.w||String(O.v||0),b["office:value-type"]="float",b["office:value"]=O.v||0;break;case"s":case"str":R=O.v==null?"":O.v,b["office:value-type"]="string";break;case"d":R=O.w||Rs(O.v).toISOString(),b["office:value-type"]="date",b["office:date-value"]=Rs(O.v).toISOString(),b["table:style-name"]="ce1";break;default:l.push(e);continue}var A=n(R);if(O.l&&O.l.Target){var I=O.l.Target;I=I.charAt(0)=="#"?"#"+jwe(I.slice(1)):I,I.charAt(0)!="#"&&!I.match(/^\w+:/)&&(I="../"+I),A=it("text:a",A,{"xlink:href":I.replace(/&/g,"&amp;")})}l.push("          "+it("table:table-cell",it("text:p",A,{}),b)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var h=0;h<c["!cols"].length;++h)if(c["!cols"][h]){var f=c["!cols"][h];if(f.width==null&&f.wpx==null&&f.wch==null)continue;Ik(f),f.ods=o;var m=c["!cols"][h].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+m+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var h=0;h<c["!rows"].length;++h)if(c["!rows"][h]){c["!rows"][h].ods=l;var f=c["!rows"][h].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var l=[ai],c=dy({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),h=dy({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+c+h+`>
`),l.push(mB().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),i(l,a),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var f=0;f!=a.SheetNames.length;++f)l.push(r(a.Sheets[a.SheetNames[f]],a,f));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}})();function tz(n,e){if(e.bookType=="fods")return cD(n,e);var t=yk(),r="",i=[],s=[];return r="mimetype",on(t,r,"application/vnd.oasis.opendocument.spreadsheet"),r="content.xml",on(t,r,cD(n,e)),i.push([r,"text/xml"]),s.push([r,"ContentFile"]),r="styles.xml",on(t,r,yTe(n,e)),i.push([r,"text/xml"]),s.push([r,"StylesFile"]),r="meta.xml",on(t,r,ai+mB()),i.push([r,"text/xml"]),s.push([r,"MetadataFile"]),r="manifest.rdf",on(t,r,Cxe(s)),i.push([r,"application/rdf+xml"]),r="META-INF/manifest.xml",on(t,r,Axe(i)),t}function fw(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}function xTe(n){return typeof TextEncoder<"u"?new TextEncoder().encode(n):mo(hy(n))}function _Te(n,e){e:for(var t=0;t<=n.length-e.length;++t){for(var r=0;r<e.length;++r)if(n[t+r]!=e[r])continue e;return!0}return!1}function $u(n){var e=n.reduce(function(i,s){return i+s.length},0),t=new Uint8Array(e),r=0;return n.forEach(function(i){t.set(i,r),r+=i.length}),t}function vTe(n,e,t){var r=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,i=t/Math.pow(10,r-6176);n[e+15]|=r>>7,n[e+14]|=(r&127)<<1;for(var s=0;i>=1;++s,i/=256)n[e+s]=i&255;n[e+15]|=t>=0?0:128}function fy(n,e){var t=e?e[0]:0,r=n[t]&127;e:if(n[t++]>=128&&(r|=(n[t]&127)<<7,n[t++]<128||(r|=(n[t]&127)<<14,n[t++]<128)||(r|=(n[t]&127)<<21,n[t++]<128)||(r+=(n[t]&127)*Math.pow(2,28),++t,n[t++]<128)||(r+=(n[t]&127)*Math.pow(2,35),++t,n[t++]<128)||(r+=(n[t]&127)*Math.pow(2,42),++t,n[t++]<128)))break e;return e&&(e[0]=t),r}function Kn(n){var e=new Uint8Array(7);e[0]=n&127;var t=1;e:if(n>127){if(e[t-1]|=128,e[t]=n>>7&127,++t,n<=16383||(e[t-1]|=128,e[t]=n>>14&127,++t,n<=2097151)||(e[t-1]|=128,e[t]=n>>21&127,++t,n<=268435455)||(e[t-1]|=128,e[t]=n/256>>>21&127,++t,n<=34359738367)||(e[t-1]|=128,e[t]=n/65536>>>21&127,++t,n<=4398046511103))break e;e[t-1]|=128,e[t]=n/16777216>>>21&127,++t}return e.slice(0,t)}function k0(n){var e=0,t=n[e]&127;e:if(n[e++]>=128){if(t|=(n[e]&127)<<7,n[e++]<128||(t|=(n[e]&127)<<14,n[e++]<128)||(t|=(n[e]&127)<<21,n[e++]<128))break e;t|=(n[e]&127)<<28}return t}function hi(n){for(var e=[],t=[0];t[0]<n.length;){var r=t[0],i=fy(n,t),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=t[0];n[t[0]++]>=128;);o=n.slice(l,t[0])}break;case 5:a=4,o=n.slice(t[0],t[0]+a),t[0]+=a;break;case 1:a=8,o=n.slice(t[0],t[0]+a),t[0]+=a;break;case 2:a=fy(n,t),o=n.slice(t[0],t[0]+a),t[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(r))}var c={data:o,type:s};e[i]==null?e[i]=[c]:e[i].push(c)}return e}function Vi(n){var e=[];return n.forEach(function(t,r){t.forEach(function(i){i.data&&(e.push(Kn(r*8+i.type)),i.type==2&&e.push(Kn(i.data.length)),e.push(i.data))})}),$u(e)}function so(n){for(var e,t=[],r=[0];r[0]<n.length;){var i=fy(n,r),s=hi(n.slice(r[0],r[0]+i));r[0]+=i;var a={id:k0(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=hi(o.data),c=k0(l[3][0].data);a.messages.push({meta:l,data:n.slice(r[0],r[0]+c)}),r[0]+=c}),(e=s[3])!=null&&e[0]&&(a.merge=k0(s[3][0].data)>>>0>0),t.push(a)}return t}function jf(n){var e=[];return n.forEach(function(t){var r=[];r[1]=[{data:Kn(t.id),type:0}],r[2]=[],t.merge!=null&&(r[3]=[{data:Kn(+!!t.merge),type:0}]);var i=[];t.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:Kn(a.data.length)}],r[2].push({data:Vi(a.meta),type:2})});var s=Vi(r);e.push(Kn(s.length)),e.push(s),i.forEach(function(a){return e.push(a)})}),$u(e)}function wTe(n,e){if(n!=0)throw new Error("Unexpected Snappy chunk type ".concat(n));for(var t=[0],r=fy(e,t),i=[];t[0]<e.length;){var s=e[t[0]]&3;if(s==0){var a=e[t[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[t[0]],o>1&&(a|=e[t[0]+1]<<8),o>2&&(a|=e[t[0]+2]<<16),o>3&&(a|=e[t[0]+3]<<24),a>>>=0,a++,t[0]+=o}i.push(e.slice(t[0],t[0]+a)),t[0]+=a;continue}else{var l=0,c=0;if(s==1?(c=(e[t[0]]>>2&7)+4,l=(e[t[0]++]&224)<<3,l|=e[t[0]++]):(c=(e[t[0]++]>>2)+1,s==2?(l=e[t[0]]|e[t[0]+1]<<8,t[0]+=2):(l=(e[t[0]]|e[t[0]+1]<<8|e[t[0]+2]<<16|e[t[0]+3]<<24)>>>0,t[0]+=4)),i=[$u(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(i.push(i[0].slice(-l)),c-=l;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-l,-l+c))}}var h=$u(i);if(h.length!=r)throw new Error("Unexpected length: ".concat(h.length," != ").concat(r));return h}function ao(n){for(var e=[],t=0;t<n.length;){var r=n[t++],i=n[t]|n[t+1]<<8|n[t+2]<<16;t+=3,e.push(wTe(r,n.slice(t,t+i))),t+=i}if(t!==n.length)throw new Error("data is not a valid framed stream!");return $u(e)}function Vf(n){for(var e=[],t=0;t<n.length;){var r=Math.min(n.length-t,268435455),i=new Uint8Array(4);e.push(i);var s=Kn(r),a=s.length;e.push(s),r<=60?(a++,e.push(new Uint8Array([r-1<<2]))):r<=256?(a+=2,e.push(new Uint8Array([240,r-1&255]))):r<=65536?(a+=3,e.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(a+=4,e.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(a+=5,e.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),e.push(n.slice(t,t+r)),a+=r,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,t+=r}return $u(e)}function HS(n,e){var t=new Uint8Array(32),r=fw(t),i=12,s=0;switch(t[0]=5,n.t){case"n":t[1]=2,vTe(t,i,n.v),s|=1,i+=16;break;case"b":t[1]=6,r.setFloat64(i,n.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(n.v)==-1)throw new Error("Value ".concat(n.v," missing from SST!"));t[1]=3,r.setUint32(i,e.indexOf(n.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+n.t}return r.setUint32(8,s,!0),t.slice(0,i)}function KS(n,e){var t=new Uint8Array(32),r=fw(t),i=12,s=0;switch(t[0]=3,n.t){case"n":t[2]=2,r.setFloat64(i,n.v,!0),s|=32,i+=8;break;case"b":t[2]=6,r.setFloat64(i,n.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(n.v)==-1)throw new Error("Value ".concat(n.v," missing from SST!"));t[2]=3,r.setUint32(i,e.indexOf(n.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+n.t}return r.setUint32(4,s,!0),t.slice(0,i)}function Jc(n){var e=hi(n);return fy(e[1][0].data)}function ETe(n,e,t){var r,i,s,a;if(!((r=n[6])!=null&&r[0])||!((i=n[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=n[8])==null?void 0:s[0])==null?void 0:a.data)&&k0(n[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,c=fw(n[7][0].data),h=0,f=[],m=fw(n[4][0].data),y=0,x=[],_=0;_<e.length;++_){if(e[_]==null){c.setUint16(_*2,65535,!0),m.setUint16(_*2,65535);continue}c.setUint16(_*2,h,!0),m.setUint16(_*2,y,!0);var w,S;switch(typeof e[_]){case"string":w=HS({t:"s",v:e[_]},t),S=KS({t:"s",v:e[_]},t);break;case"number":w=HS({t:"n",v:e[_]},t),S=KS({t:"n",v:e[_]},t);break;case"boolean":w=HS({t:"b",v:e[_]},t),S=KS({t:"b",v:e[_]},t);break;default:throw new Error("Unsupported value "+e[_])}f.push(w),h+=w.length,x.push(S),y+=S.length,++l}for(n[2][0].data=Kn(l);_<n[7][0].data.length/2;++_)c.setUint16(_*2,65535,!0),m.setUint16(_*2,65535,!0);return n[6][0].data=$u(f),n[3][0].data=$u(x),l}function TTe(n,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=n.Sheets[n.SheetNames[0]];n.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=xa(t["!ref"]);r.s.r=r.s.c=0;var i=!1;r.e.c>9&&(i=!0,r.e.c=9),r.e.r>49&&(i=!0,r.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(ri(r)));var s=gw(t,{range:r,header:1}),a=["~Sh33tJ5~"];s.forEach(function(Z){return Z.forEach(function(te){typeof te=="string"&&a.push(te)})});var o={},l=[],c=nr.read(e.numbers,{type:"base64"});c.FileIndex.map(function(Z,te){return[Z,c.FullPaths[te]]}).forEach(function(Z){var te=Z[0],ie=Z[1];if(te.type==2&&te.name.match(/\.iwa/)){var ue=te.content,Ve=ao(ue),Ge=so(Ve);Ge.forEach(function(ye){l.push(ye.id),o[ye.id]={deps:[],location:ie,type:k0(ye.messages[0].meta[1][0].data)}})}}),l.sort(function(Z,te){return Z-te});var h=l.filter(function(Z){return Z>1}).map(function(Z){return[Z,Kn(Z)]});c.FileIndex.map(function(Z,te){return[Z,c.FullPaths[te]]}).forEach(function(Z){var te=Z[0];if(Z[1],!!te.name.match(/\.iwa/)){var ie=so(ao(te.content));ie.forEach(function(ue){ue.messages.forEach(function(Ve){h.forEach(function(Ge){ue.messages.some(function(ye){return k0(ye.meta[1][0].data)!=11006&&_Te(ye.data,Ge[1])})&&o[Ge[0]].deps.push(ue.id)})})})}});for(var f=nr.find(c,o[1].location),m=so(ao(f.content)),y,x=0;x<m.length;++x){var _=m[x];_.id==1&&(y=_)}var w=Jc(hi(y.messages[0].data)[1][0].data);for(f=nr.find(c,o[w].location),m=so(ao(f.content)),x=0;x<m.length;++x)_=m[x],_.id==w&&(y=_);for(w=Jc(hi(y.messages[0].data)[2][0].data),f=nr.find(c,o[w].location),m=so(ao(f.content)),x=0;x<m.length;++x)_=m[x],_.id==w&&(y=_);for(w=Jc(hi(y.messages[0].data)[2][0].data),f=nr.find(c,o[w].location),m=so(ao(f.content)),x=0;x<m.length;++x)_=m[x],_.id==w&&(y=_);var S=hi(y.messages[0].data);{S[6][0].data=Kn(r.e.r+1),S[7][0].data=Kn(r.e.c+1);var b=Jc(S[46][0].data),R=nr.find(c,o[b].location),M=so(ao(R.content));{for(var O=0;O<M.length&&M[O].id!=b;++O);if(M[O].id!=b)throw"Bad ColumnRowUIDMapArchive";var G=hi(M[O].messages[0].data);G[1]=[],G[2]=[],G[3]=[];for(var A=0;A<=r.e.c;++A){var I=[];I[1]=I[2]=[{type:0,data:Kn(A+420690)}],G[1].push({type:2,data:Vi(I)}),G[2].push({type:0,data:Kn(A)}),G[3].push({type:0,data:Kn(A)})}G[4]=[],G[5]=[],G[6]=[];for(var P=0;P<=r.e.r;++P)I=[],I[1]=I[2]=[{type:0,data:Kn(P+726270)}],G[4].push({type:2,data:Vi(I)}),G[5].push({type:0,data:Kn(P)}),G[6].push({type:0,data:Kn(P)});M[O].messages[0].data=Vi(G)}R.content=Vf(jf(M)),R.size=R.content.length,delete S[46];var D=hi(S[4][0].data);{D[7][0].data=Kn(r.e.r+1);var L=hi(D[1][0].data),U=Jc(L[2][0].data);R=nr.find(c,o[U].location),M=so(ao(R.content));{if(M[0].id!=U)throw"Bad HeaderStorageBucket";var j=hi(M[0].messages[0].data);for(P=0;P<s.length;++P){var Ee=hi(j[2][0].data);Ee[1][0].data=Kn(P),Ee[4][0].data=Kn(s[P].length),j[2][P]={type:j[2][0].type,data:Vi(Ee)}}M[0].messages[0].data=Vi(j)}R.content=Vf(jf(M)),R.size=R.content.length;var ke=Jc(D[2][0].data);R=nr.find(c,o[ke].location),M=so(ao(R.content));{if(M[0].id!=ke)throw"Bad HeaderStorageBucket";for(j=hi(M[0].messages[0].data),A=0;A<=r.e.c;++A)Ee=hi(j[2][0].data),Ee[1][0].data=Kn(A),Ee[4][0].data=Kn(r.e.r+1),j[2][A]={type:j[2][0].type,data:Vi(Ee)};M[0].messages[0].data=Vi(j)}R.content=Vf(jf(M)),R.size=R.content.length;var Be=Jc(D[4][0].data);(function(){for(var Z=nr.find(c,o[Be].location),te=so(ao(Z.content)),ie,ue=0;ue<te.length;++ue){var Ve=te[ue];Ve.id==Be&&(ie=Ve)}var Ge=hi(ie.messages[0].data);{Ge[3]=[];var ye=[];a.forEach(function(wt,jt){ye[1]=[{type:0,data:Kn(jt)}],ye[2]=[{type:0,data:Kn(1)}],ye[3]=[{type:2,data:xTe(wt)}],Ge[3].push({type:2,data:Vi(ye)})})}ie.messages[0].data=Vi(Ge);var pe=jf(te),Fe=Vf(pe);Z.content=Fe,Z.size=Z.content.length})();var Me=hi(D[3][0].data);{var ce=Me[1][0];delete Me[2];var Pe=hi(ce.data);{var be=Jc(Pe[2][0].data);(function(){for(var Z=nr.find(c,o[be].location),te=so(ao(Z.content)),ie,ue=0;ue<te.length;++ue){var Ve=te[ue];Ve.id==be&&(ie=Ve)}var Ge=hi(ie.messages[0].data);{delete Ge[6],delete Me[7];var ye=new Uint8Array(Ge[5][0].data);Ge[5]=[];for(var pe=0,Fe=0;Fe<=r.e.r;++Fe){var wt=hi(ye);pe+=ETe(wt,s[Fe],a),wt[1][0].data=Kn(Fe),Ge[5].push({data:Vi(wt),type:2})}Ge[1]=[{type:0,data:Kn(r.e.c+1)}],Ge[2]=[{type:0,data:Kn(r.e.r+1)}],Ge[3]=[{type:0,data:Kn(pe)}],Ge[4]=[{type:0,data:Kn(r.e.r+1)}]}ie.messages[0].data=Vi(Ge);var jt=jf(te),Dt=Vf(jt);Z.content=Dt,Z.size=Z.content.length})()}ce.data=Vi(Pe)}D[3][0].data=Vi(Me)}S[4][0].data=Vi(D)}y.messages[0].data=Vi(S);var se=jf(m),V=Vf(se);return f.content=V,f.size=f.content.length,c}function STe(n){return function(t){for(var r=0;r!=n.length;++r){var i=n[r];t[i[0]]===void 0&&(t[i[0]]=i[1]),i[2]==="n"&&(t[i[0]]=Number(t[i[0]]))}}}function Nk(n){STe([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(n)}function bTe(n,e){return e.bookType=="ods"?tz(n,e):e.bookType=="numbers"?TTe(n,e):e.bookType=="xlsb"?RTe(n,e):ATe(n,e)}function RTe(n,e){f0=1024,n&&!n.SSF&&(n.SSF=Xs(Gr)),n&&n.SSF&&(GE(),VE(n.SSF),e.revssf=BE(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,pp?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t=e.bookType=="xlsb"?"bin":"xml",r=FB.indexOf(e.bookType)>-1,i=dB();Nk(e=e||{});var s=yk(),a="",o=0;if(e.cellXfs=[],Ju(e.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),a="docProps/core.xml",on(s,a,pB(n.Props,e)),i.coreprops.push(a),Xn(e.rels,2,a,Pn.CORE_PROPS),a="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var l=[],c=0;c<n.SheetNames.length;++c)(n.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(n.SheetNames[c]);n.Props.SheetNames=l}for(n.Props.Worksheets=n.Props.SheetNames.length,on(s,a,xB(n.Props)),i.extprops.push(a),Xn(e.rels,3,a,Pn.EXT_PROPS),n.Custprops!==n.Props&&Xi(n.Custprops||{}).length>0&&(a="docProps/custom.xml",on(s,a,_B(n.Custprops)),i.custprops.push(a),Xn(e.rels,4,a,Pn.CUST_PROPS)),o=1;o<=n.SheetNames.length;++o){var h={"!id":{}},f=n.Sheets[n.SheetNames[o-1]],m=(f||{})["!type"]||"sheet";switch(m){case"chart":default:a="xl/worksheets/sheet"+o+"."+t,on(s,a,C2e(o-1,a,e,n,h)),i.sheets.push(a),Xn(e.wbrels,-1,"worksheets/sheet"+o+"."+t,Pn.WS[0])}if(f){var y=f["!comments"],x=!1,_="";y&&y.length>0&&(_="xl/comments"+o+"."+t,on(s,_,M2e(y,_)),i.comments.push(_),Xn(h,-1,"../comments"+o+"."+t,Pn.CMNT),x=!0),f["!legacy"]&&x&&on(s,"xl/drawings/vmlDrawing"+o+".vml",OB(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}h["!id"].rId1&&on(s,gB(a),I0(h))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+t,on(s,a,P2e(e.Strings,a,e)),i.strs.push(a),Xn(e.wbrels,-1,"sharedStrings."+t,Pn.SST)),a="xl/workbook."+t,on(s,a,I2e(n,a)),i.workbooks.push(a),Xn(e.rels,1,a,Pn.WB),a="xl/theme/theme1.xml",on(s,a,NB(n.Themes,e)),i.themes.push(a),Xn(e.wbrels,-1,"theme/theme1.xml",Pn.THEME),a="xl/styles."+t,on(s,a,k2e(n,a,e)),i.styles.push(a),Xn(e.wbrels,-1,"styles."+t,Pn.STY),n.vbaraw&&r&&(a="xl/vbaProject.bin",on(s,a,n.vbaraw),i.vba.push(a),Xn(e.wbrels,-1,"vbaProject.bin",Pn.VBA)),a="xl/metadata."+t,on(s,a,N2e(a)),i.metadata.push(a),Xn(e.wbrels,-1,"metadata."+t,Pn.XLMETA),on(s,"[Content_Types].xml",fB(i,e)),on(s,"_rels/.rels",I0(e.rels)),on(s,"xl/_rels/workbook."+t+".rels",I0(e.wbrels)),delete e.revssf,delete e.ssf,s}function ATe(n,e){f0=1024,n&&!n.SSF&&(n.SSF=Xs(Gr)),n&&n.SSF&&(GE(),VE(n.SSF),e.revssf=BE(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,pp?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t="xml",r=FB.indexOf(e.bookType)>-1,i=dB();Nk(e=e||{});var s=yk(),a="",o=0;if(e.cellXfs=[],Ju(e.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),a="docProps/core.xml",on(s,a,pB(n.Props,e)),i.coreprops.push(a),Xn(e.rels,2,a,Pn.CORE_PROPS),a="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var l=[],c=0;c<n.SheetNames.length;++c)(n.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(n.SheetNames[c]);n.Props.SheetNames=l}n.Props.Worksheets=n.Props.SheetNames.length,on(s,a,xB(n.Props)),i.extprops.push(a),Xn(e.rels,3,a,Pn.EXT_PROPS),n.Custprops!==n.Props&&Xi(n.Custprops||{}).length>0&&(a="docProps/custom.xml",on(s,a,_B(n.Custprops)),i.custprops.push(a),Xn(e.rels,4,a,Pn.CUST_PROPS));var h=["SheetJ5"];for(e.tcid=0,o=1;o<=n.SheetNames.length;++o){var f={"!id":{}},m=n.Sheets[n.SheetNames[o-1]],y=(m||{})["!type"]||"sheet";switch(y){case"chart":default:a="xl/worksheets/sheet"+o+"."+t,on(s,a,HB(o-1,e,n,f)),i.sheets.push(a),Xn(e.wbrels,-1,"worksheets/sheet"+o+"."+t,Pn.WS[0])}if(m){var x=m["!comments"],_=!1,w="";if(x&&x.length>0){var S=!1;x.forEach(function(b){b[1].forEach(function(R){R.T==!0&&(S=!0)})}),S&&(w="xl/threadedComments/threadedComment"+o+"."+t,on(s,w,ive(x,h,e)),i.threadedcomments.push(w),Xn(f,-1,"../threadedComments/threadedComment"+o+"."+t,Pn.TCMNT)),w="xl/comments"+o+"."+t,on(s,w,DB(x)),i.comments.push(w),Xn(f,-1,"../comments"+o+"."+t,Pn.CMNT),_=!0}m["!legacy"]&&_&&on(s,"xl/drawings/vmlDrawing"+o+".vml",OB(o,m["!comments"])),delete m["!comments"],delete m["!legacy"]}f["!id"].rId1&&on(s,gB(a),I0(f))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+t,on(s,a,AB(e.Strings,e)),i.strs.push(a),Xn(e.wbrels,-1,"sharedStrings."+t,Pn.SST)),a="xl/workbook."+t,on(s,a,qB(n)),i.workbooks.push(a),Xn(e.rels,1,a,Pn.WB),a="xl/theme/theme1.xml",on(s,a,NB(n.Themes,e)),i.themes.push(a),Xn(e.wbrels,-1,"theme/theme1.xml",Pn.THEME),a="xl/styles."+t,on(s,a,PB(n,e)),i.styles.push(a),Xn(e.wbrels,-1,"styles."+t,Pn.STY),n.vbaraw&&r&&(a="xl/vbaProject.bin",on(s,a,n.vbaraw),i.vba.push(a),Xn(e.wbrels,-1,"vbaProject.bin",Pn.VBA)),a="xl/metadata."+t,on(s,a,LB()),i.metadata.push(a),Xn(e.wbrels,-1,"metadata."+t,Pn.XLMETA),h.length>1&&(a="xl/persons/person.xml",on(s,a,sve(h)),i.people.push(a),Xn(e.wbrels,-1,"persons/person.xml",Pn.PEOPLE)),on(s,"[Content_Types].xml",fB(i,e)),on(s,"_rels/.rels",I0(e.rels)),on(s,"xl/_rels/workbook."+t+".rels",I0(e.wbrels)),delete e.revssf,delete e.ssf,s}function ITe(n,e){var t="";switch((e||{}).type||"base64"){case"buffer":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];case"base64":t=hc(n.slice(0,12));break;case"binary":t=n;break;case"array":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function nz(n,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return o1(e.file,nr.write(n,{type:Dn?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return nr.write(n,e)}function CTe(n,e){var t=Xs(e||{}),r=bTe(n,t);return kTe(r,t)}function kTe(n,e){var t={},r=Dn?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(t.compression="DEFLATE"),e.password)t.type=r;else switch(e.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":t.type=r;break;default:throw new Error("Unrecognized type "+e.type)}var i=n.FullPaths?nr.write(n,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!e.compression}):n.generate(t);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(jE(i))}return e.password&&typeof encrypt_agile<"u"?nz(encrypt_agile(i,e.password),e):e.type==="file"?o1(e.file,i):e.type=="string"?dp(i):i}function PTe(n,e){var t=e||{},r=K2e(n,t);return nz(r,t)}function Ko(n,e,t){t||(t="");var r=t+n;switch(e.type){case"base64":return cy(hy(r));case"binary":return hy(r);case"string":return n;case"file":return o1(e.file,r,"utf8");case"buffer":return Dn?wc(r,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(r):Ko(r,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function MTe(n,e){switch(e.type){case"base64":return cy(n);case"binary":return n;case"string":return n;case"file":return o1(e.file,n,"binary");case"buffer":return Dn?wc(n,"binary"):n.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function e_(n,e){switch(e.type){case"string":case"base64":case"binary":for(var t="",r=0;r<n.length;++r)t+=String.fromCharCode(n[r]);return e.type=="base64"?cy(t):e.type=="string"?dp(t):t;case"file":return o1(e.file,n);case"buffer":return n;default:throw new Error("Unrecognized type "+e.type)}}function rz(n,e){a1e(),y2e(n);var t=Xs(e||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var r=rz(n,t);return t.type="array",jE(r)}var i=0;if(t.sheet&&(typeof t.sheet=="number"?i=t.sheet:i=n.SheetNames.indexOf(t.sheet),!n.SheetNames[i]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return Ko(W2e(n,t),t);case"slk":case"sylk":return Ko(g_e.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"htm":case"html":return Ko(JB(n.Sheets[n.SheetNames[i]],t),t);case"txt":return MTe(iz(n.Sheets[n.SheetNames[i]],t),t);case"csv":return Ko(Lk(n.Sheets[n.SheetNames[i]],t),t,"\uFEFF");case"dif":return Ko(m_e.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"dbf":return e_(f_e.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"prn":return Ko(p_e.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"rtf":return Ko(T_e.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"eth":return Ko(RB.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"fods":return Ko(tz(n,t),t);case"wk1":return e_(nD.sheet_to_wk1(n.Sheets[n.SheetNames[i]],t),t);case"wk3":return e_(nD.book_to_wk3(n,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),e_(ZB(n,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),PTe(n,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return CTe(n,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function NTe(n){if(!n.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=n.file.slice(n.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(n.bookType=t.slice(1)),n.bookType=e[n.bookType]||n.bookType}}function LTe(n,e,t){var r={};return r.type="file",r.file=e,NTe(r),rz(n,r)}function OTe(n,e,t,r,i,s,a,o){var l=Ki(t),c=o.defval,h=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,m=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:t,enumerable:!1})}catch{m.__rowNum__=t}else m.__rowNum__=t;if(!a||n[t])for(var y=e.s.c;y<=e.e.c;++y){var x=a?n[t][y]:n[r[y]+l];if(x===void 0||x.t===void 0){if(c===void 0)continue;s[y]!=null&&(m[s[y]]=c);continue}var _=x.v;switch(x.t){case"z":if(_==null)break;continue;case"e":_=_==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(s[y]!=null){if(_==null)if(x.t=="e"&&_===null)m[s[y]]=null;else if(c!==void 0)m[s[y]]=c;else if(h&&_===null)m[s[y]]=null;else continue;else m[s[y]]=h&&(x.t!=="n"||x.t==="n"&&o.rawNumbers!==!1)?_:dc(x,_,o);_!=null&&(f=!1)}}return{row:m,isempty:f}}function gw(n,e){if(n==null||n["!ref"]==null)return[];var t={t:"n",v:0},r=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},h=c.range!=null?c.range:n["!ref"];switch(c.header===1?r=1:c.header==="A"?r=2:Array.isArray(c.header)?r=3:c.header==null&&(r=0),typeof h){case"string":l=mr(h);break;case"number":l=mr(n["!ref"]),l.s.r=h;break;default:l=h}r>0&&(i=0);var f=Ki(l.s.r),m=[],y=[],x=0,_=0,w=Array.isArray(n),S=l.s.r,b=0,R={};w&&!n[S]&&(n[S]=[]);var M=c.skipHidden&&n["!cols"]||[],O=c.skipHidden&&n["!rows"]||[];for(b=l.s.c;b<=l.e.c;++b)if(!(M[b]||{}).hidden)switch(m[b]=fs(b),t=w?n[S][b]:n[m[b]+f],r){case 1:s[b]=b-l.s.c;break;case 2:s[b]=m[b];break;case 3:s[b]=c.header[b-l.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),o=a=dc(t,null,c),_=R[a]||0,!_)R[a]=1;else{do o=a+"_"+_++;while(R[o]);R[a]=_,R[o]=1}s[b]=o}for(S=l.s.r+i;S<=l.e.r;++S)if(!(O[S]||{}).hidden){var G=OTe(n,l,S,m,r,s,w,c);(G.isempty===!1||(r===1?c.blankrows!==!1:c.blankrows))&&(y[x++]=G.row)}return y.length=x,y}var uD=/"/g;function DTe(n,e,t,r,i,s,a,o){for(var l=!0,c=[],h="",f=Ki(t),m=e.s.c;m<=e.e.c;++m)if(r[m]){var y=o.dense?(n[t]||[])[m]:n[r[m]+f];if(y==null)h="";else if(y.v!=null){l=!1,h=""+(o.rawNumbers&&y.t=="n"?y.v:dc(y,null,o));for(var x=0,_=0;x!==h.length;++x)if((_=h.charCodeAt(x))===i||_===s||_===34||o.forceQuotes){h='"'+h.replace(uD,'""')+'"';break}h=="ID"&&(h='"ID"')}else y.f!=null&&!y.F?(l=!1,h="="+y.f,h.indexOf(",")>=0&&(h='"'+h.replace(uD,'""')+'"')):h="";c.push(h)}return o.blankrows===!1&&l?null:c.join(a)}function Lk(n,e){var t=[],r=e??{};if(n==null||n["!ref"]==null)return"";var i=mr(n["!ref"]),s=r.FS!==void 0?r.FS:",",a=s.charCodeAt(0),o=r.RS!==void 0?r.RS:`
`,l=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),h="",f=[];r.dense=Array.isArray(n);for(var m=r.skipHidden&&n["!cols"]||[],y=r.skipHidden&&n["!rows"]||[],x=i.s.c;x<=i.e.c;++x)(m[x]||{}).hidden||(f[x]=fs(x));for(var _=0,w=i.s.r;w<=i.e.r;++w)(y[w]||{}).hidden||(h=DTe(n,i,w,f,a,l,s,r),h!=null&&(r.strip&&(h=h.replace(c,"")),(h||r.blankrows!==!1)&&t.push((_++?o:"")+h)));return delete r.dense,t.join("")}function iz(n,e){e||(e={}),e.FS="	",e.RS=`
`;var t=Lk(n,e);return t}function FTe(n){var e="",t,r="";if(n==null||n["!ref"]==null)return[];var i=mr(n["!ref"]),s="",a=[],o,l=[],c=Array.isArray(n);for(o=i.s.c;o<=i.e.c;++o)a[o]=fs(o);for(var h=i.s.r;h<=i.e.r;++h)for(s=Ki(h),o=i.s.c;o<=i.e.c;++o)if(e=a[o]+s,t=c?(n[h]||[])[o]:n[e],r="",t!==void 0){if(t.F!=null){if(e=t.F,!t.f)continue;r=t.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(t.f!=null)r=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)r=""+t.v;else if(t.t=="b")r=t.v?"TRUE":"FALSE";else if(t.w!==void 0)r="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?r="'"+t.v:r=""+t.v}}l[l.length]=e+"="+r}return l}function sz(n,e,t){var r=t||{},i=+!r.skipHeader,s=n||{},a=0,o=0;if(s&&r.origin!=null)if(typeof r.origin=="number")a=r.origin;else{var l=typeof r.origin=="string"?ki(r.origin):r.origin;a=l.r,o=l.c}var c,h={s:{c:0,r:0},e:{c:o,r:a+e.length-1+i}};if(s["!ref"]){var f=mr(s["!ref"]);h.e.c=Math.max(h.e.c,f.e.c),h.e.r=Math.max(h.e.r,f.e.r),a==-1&&(a=f.e.r+1,h.e.r=a+e.length-1+i)}else a==-1&&(a=0,h.e.r=e.length-1+i);var m=r.header||[],y=0;e.forEach(function(_,w){Xi(_).forEach(function(S){(y=m.indexOf(S))==-1&&(m[y=m.length]=S);var b=_[S],R="z",M="",O=er({c:o+y,r:a+w+i});c=gy(s,O),b&&typeof b=="object"&&!(b instanceof Date)?s[O]=b:(typeof b=="number"?R="n":typeof b=="boolean"?R="b":typeof b=="string"?R="s":b instanceof Date?(R="d",r.cellDates||(R="n",b=Ks(b)),M=r.dateNF||Gr[14]):b===null&&r.nullError&&(R="e",b=0),c?(c.t=R,c.v=b,delete c.w,delete c.R,M&&(c.z=M)):s[O]=c={t:R,v:b},M&&(c.z=M))})}),h.e.c=Math.max(h.e.c,o+m.length-1);var x=Ki(a);if(i)for(y=0;y<m.length;++y)s[fs(y+o)+x]={t:"s",v:m[y]};return s["!ref"]=ri(h),s}function jTe(n,e){return sz(null,n,e)}function gy(n,e,t){if(typeof e=="string"){if(Array.isArray(n)){var r=ki(e);return n[r.r]||(n[r.r]=[]),n[r.r][r.c]||(n[r.r][r.c]={t:"z"})}return n[e]||(n[e]={t:"z"})}return typeof e!="number"?gy(n,er(e)):gy(n,er({r:e,c:t||0}))}function VTe(n,e){if(typeof e=="number"){if(e>=0&&n.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var t=n.SheetNames.indexOf(e);if(t>-1)return t;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function GTe(){return{SheetNames:[],Sheets:{}}}function BTe(n,e,t,r){var i=1;if(!t)for(;i<=65535&&n.SheetNames.indexOf(t="Sheet"+i)!=-1;++i,t=void 0);if(!t||n.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&n.SheetNames.indexOf(t)>=0){var s=t.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||t;for(++i;i<=65535&&n.SheetNames.indexOf(t=a+i)!=-1;++i);}if(XB(t),n.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return n.SheetNames.push(t),n.Sheets[t]=e,t}function zTe(n,e,t){n.Workbook||(n.Workbook={}),n.Workbook.Sheets||(n.Workbook.Sheets=[]);var r=VTe(n,e);switch(n.Workbook.Sheets[r]||(n.Workbook.Sheets[r]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}n.Workbook.Sheets[r].Hidden=t}function UTe(n,e){return n.z=e,n}function az(n,e,t){return e?(n.l={Target:e},t&&(n.l.Tooltip=t)):delete n.l,n}function $Te(n,e,t){return az(n,"#"+e,t)}function WTe(n,e,t){n.c||(n.c=[]),n.c.push({t:e,a:t||"SheetJS"})}function HTe(n,e,t,r){for(var i=typeof e!="string"?e:mr(e),s=typeof e=="string"?e:ri(e),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=gy(n,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=t,r&&(l.D=!0))}return n}var XS={encode_col:fs,encode_row:Ki,encode_cell:er,encode_range:ri,decode_col:Tk,decode_row:Ek,split_cell:axe,decode_cell:ki,decode_range:xa,format_cell:dc,sheet_add_aoa:aB,sheet_add_json:sz,sheet_add_dom:QB,aoa_to_sheet:wg,json_to_sheet:jTe,table_to_sheet:ez,table_to_book:mTe,sheet_to_csv:Lk,sheet_to_txt:iz,sheet_to_json:gw,sheet_to_html:JB,sheet_to_formulae:FTe,sheet_to_row_object_array:gw,sheet_get_cell:gy,book_new:GTe,book_append_sheet:BTe,book_set_sheet_visibility:zTe,cell_set_number_format:UTe,cell_set_hyperlink:az,cell_set_internal_link:$Te,cell_add_comment:WTe,sheet_set_array_formula:HTe,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const cl=ms()(vl((n,e)=>({vondsten:[],addVondst:t=>n(r=>({vondsten:[...r.vondsten,{...t,id:crypto.randomUUID(),timestamp:new Date().toISOString()}]})),removeVondst:t=>n(r=>({vondsten:r.vondsten.filter(i=>i.id!==t)})),updateVondst:(t,r)=>n(i=>({vondsten:i.vondsten.map(s=>s.id===t?{...s,...r}:s)})),clearAll:()=>n({vondsten:[]}),exportAsGeoJSON:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const r={type:"FeatureCollection",features:t.map(o=>({type:"Feature",geometry:{type:"Point",coordinates:[o.location.lng,o.location.lat]},properties:{id:o.id,objectType:o.objectType,material:o.material,period:o.period,depth:o.depth,notes:o.notes,timestamp:o.timestamp,photoUrl:o.photoUrl,condition:o.condition,weight:o.weight,length:o.length}}))},i=new Blob([JSON.stringify(r,null,2)],{type:"application/json"}),s=URL.createObjectURL(i),a=document.createElement("a");a.href=s,a.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.geojson`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(s)},exportAsCSV:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const r=`ID,Latitude,Longitude,Datum,Type,Materiaal,Periode,Diepte (cm),Conditie,Gewicht (g),Lengte (mm),Notities,Foto URL
`,i=t.map(c=>{const h=new Date(c.timestamp).toLocaleDateString("nl-NL"),f=c.notes?`"${c.notes.replace(/"/g,'""')}"`:"";return`${c.id},${c.location.lat},${c.location.lng},${h},${c.objectType},${c.material},${c.period},${c.depth||""},${c.condition||""},${c.weight||""},${c.length||""},${f},${c.photoUrl||""}`}).join(`
`),s=r+i,a=new Blob([s],{type:"text/csv;charset=utf-8;"}),o=URL.createObjectURL(a),l=document.createElement("a");l.href=o,l.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(o)},exportAsExcel:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const r=t.map(o=>({ID:o.id,Latitude:o.location.lat,Longitude:o.location.lng,Datum:new Date(o.timestamp).toLocaleDateString("nl-NL"),Type:o.objectType,Materiaal:o.material,Periode:o.period,"Diepte (cm)":o.depth||"",Conditie:o.condition||"","Gewicht (g)":o.weight||"","Lengte (mm)":o.length||"",Notities:o.notes||"","Foto URL":o.photoUrl||""})),i=XS.json_to_sheet(r),s=XS.book_new();XS.book_append_sheet(s,i,"Vondsten");const a=[{wch:36},{wch:12},{wch:12},{wch:12},{wch:15},{wch:12},{wch:25},{wch:12},{wch:12},{wch:12},{wch:12},{wch:40},{wch:50}];i["!cols"]=a,LTe(s,`mijn-vondsten-${new Date().toISOString().split("T")[0]}.xlsx`)},exportAsGPX:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const r=t.map(l=>{const c=new Date(l.timestamp).toISOString();return`  <wpt lat="${l.location.lat}" lon="${l.location.lng}">
    <name>${l.objectType} - ${l.material}</name>
    <desc>${l.period}${l.depth?`, ${l.depth}cm diep`:""}${l.condition&&l.condition!=="Onbekend"?`, ${l.condition}`:""}${l.weight?`, ${l.weight}g`:""}${l.length?`, ${l.length}mm`:""}${l.notes?`. ${l.notes}`:""}</desc>
    <time>${c}</time>
    <sym>Pin</sym>
  </wpt>`}).join(`
`),i=`<?xml version="1.0" encoding="UTF-8"?>
<gpx version="1.1" creator="DetectorApp NL" xmlns="http://www.topografix.com/GPX/1/1">
  <metadata>
    <name>Mijn Vondsten</name>
    <desc>Geexporteerd uit DetectorApp NL</desc>
    <time>${new Date().toISOString()}</time>
  </metadata>
${r}
</gpx>`,s=new Blob([i],{type:"application/gpx+xml"}),a=URL.createObjectURL(s),o=document.createElement("a");o.href=a,o.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.gpx`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(a)},exportAsKML:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const i=`<?xml version="1.0" encoding="UTF-8"?>
<kml xmlns="http://www.opengis.net/kml/2.2">
  <Document>
    <name>Mijn Vondsten</name>
    <description>Geexporteerd uit DetectorApp NL</description>
${t.map(l=>{const c=new Date(l.timestamp).toLocaleDateString("nl-NL"),h=`<![CDATA[
            <b>Type:</b> ${l.objectType}<br/>
            <b>Materiaal:</b> ${l.material}<br/>
            <b>Periode:</b> ${l.period}<br/>
            ${l.depth?`<b>Diepte:</b> ${l.depth} cm<br/>`:""}
            ${l.condition&&l.condition!=="Onbekend"?`<b>Conditie:</b> ${l.condition}<br/>`:""}
            ${l.weight?`<b>Gewicht:</b> ${l.weight} gram<br/>`:""}
            ${l.length?`<b>Lengte:</b> ${l.length} mm<br/>`:""}
            <b>Datum:</b> ${c}<br/>
            ${l.notes?`<b>Notities:</b> ${l.notes}<br/>`:""}
            ${l.photoUrl?`<a href="${l.photoUrl}">Bekijk foto</a>`:""}
          ]]>`;return`    <Placemark>
      <name>${l.objectType} - ${l.material}</name>
      <description>${h}</description>
      <Point>
        <coordinates>${l.location.lng},${l.location.lat},0</coordinates>
      </Point>
    </Placemark>`}).join(`
`)}
  </Document>
</kml>`,s=new Blob([i],{type:"application/vnd.google-earth.kml+xml"}),a=URL.createObjectURL(s),o=document.createElement("a");o.href=a,o.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.kml`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(a)}}),{name:"detectorapp-local-vondsten"})),KTe={Fectio:{naam:"Fectio",latinNaam:"Fectio",type:"castellum",periode:"ca. 4 - 270 n.Chr.",beschrijving:"Groot Romeins castellum bij Bunnik/Vechten, aan de splitsing van Rijn en Vecht. Een van de belangrijkste legerbases in Nederland met ruimte voor 500 soldaten. Het fort had barakken, badhuis, hospitaal en pakhuizen. Buiten de muren woonden handelaren en soldatenfamilies in een vicus. Hier is een compleet Romeins schip gevonden (De Meern 1). Strategisch gelegen voor transport over de rivieren. Veel vondsten door natte bodem: leer, hout, textiel naast munten en militaria. Te bezoeken: Archeologisch Park Castellum Hoge Woerd met reconstructie en museum.",watWasHier:"Groot castellum met ruimte voor 500 soldaten, barakken, badhuis, hospitaal en pakhuizen. Buiten het fort een burgerdorp.",watTeZien:"Archeologisch Park Castellum Hoge Woerd toont de contouren. Museum met veel vondsten waaronder een Romeins schip.",verwachteVondsten:"Munten, fibulae, aardewerk, wapens, paardentuig, militaire uitrusting. Door natte bodem ook leer, hout en textiel.",betekenis:"Een van de belangrijkste forten aan de Limes. Knooppunt voor troepen- en goederentransport.",bronnen:["https://www.hogewoerd.nl","https://www.livius.org/articles/place/fectio-vechten/"]},Traiectum:{naam:"Traiectum",latinNaam:"Traiectum",type:"castellum",periode:"ca. 42 - 275 n.Chr.",beschrijving:'Romeins castellum onder het huidige Domplein in Utrecht. De naam betekent "doorwaadbare plaats" - hier splitsten Rijn en Vecht. Het fort (124x152m in laatste fase) bood plaats aan ca. 500 soldaten. Vijf bouwfases: eerst hout, na 200 n.Chr. steen met tufsteen uit de Eifel. Cohors II Hispanorum peditata (Spaanse infanterie) was hier uniek gelegerd 88-275 n.Chr. - hun dakpanstempels zijn nergens anders aan de Limes gevonden! Het fort werd verwoest tijdens de Bataafse Opstand (69 n.Chr.). DOMunder onder het Domplein toont de opgegraven resten. UNESCO Werelderfgoed sinds 2021.',watWasHier:"Castellum (500 soldaten) bij riviersplitsing. Cohors II Hispanorum gelegerd.",watTeZien:"DOMunder onder het Domplein: opgravingen te bezoeken. Principia en poorten blootgelegd.",verwachteVondsten:"Dakpannen met stempels, munten, aardewerk, tufsteen bouwmateriaal, militaria.",betekenis:"UNESCO Werelderfgoed. Oorsprong van de stad Utrecht.",bronnen:["https://www.livius.org/articles/place/traiectum-utrecht/","https://www.utrechtaltijd.nl/verhalen/castellum-traiectum-een-romeinse-legerbasis-in-het-hart-van-de-domstad/","https://www.romeinen.nl/locatie-overzicht/3447271878/domunder-castellum-traiectum"]},Laurum:{naam:"Laurum",latinNaam:"Laurum",type:"castellum",periode:"ca. 40 - 270 n.Chr.",beschrijving:"Romeins castellum in het huidige Woerden aan de Oude Rijn. Garnizoen van ca. 500 soldaten in houten barakken. Bijzonder vanwege de natte veenbodem: organisch materiaal bleef bewaard zoals houten schrijfplankjes met Latijnse teksten, leren schoenen en een Romeinse boot. Het fort werd meerdere keren herbouwd na overstromingen. De contouren zijn in het stratenpatroon herkenbaar. Buiten de muren lag een vicus (burgerdorp). Vondsten in Stadsmuseum Woerden, waaronder unieke houten voorwerpen die elders zijn vergaan.",watWasHier:"Castellum voor 500 soldaten met houten barakken, badhuis en pakhuizen. Vicus buiten de muren.",watTeZien:"Stadsmuseum Woerden met bijzondere vondsten. Fort-contouren in stratenpatroon herkenbaar.",verwachteVondsten:"Militaria, aardewerk, munten, schrijfplankjes. Door natte veengrond ook hout, leer en schoenen.",betekenis:"Toont Romeins bouwen in moeilijk veengebied. Unieke organische vondsten.",bronnen:["https://www.castellumwoerden.nl"]},"Castellum Praetorium Agrippinae":{naam:"Praetorium Agrippinae",latinNaam:"Praetorium Agrippinae",type:"castellum",periode:"ca. 40 - 275 n.Chr.",beschrijving:"Een van de best opgegraven Romeinse locaties van Nederland. Het castellum werd gesticht in de winter van 39/40 n.Chr. door keizer Caligula, vernoemd naar zijn moeder Vipsania Agrippina. Een opgegraven wijnvat bevatte wijn van de persoonlijke wijngaarden van de keizer! Er zijn 7 bouwfasen gevonden, 6 van hout en de laatste van steen - uniek compleet inzicht in Romeinse bouwtechnieken. Cohors III Gallorum equitata was hier gelegerd. Bij opgravingen (1941-1953) zijn door het grondwater veel organische vondsten bewaard: voedselresten, leer, touw. De vicus buiten het fort strekte zich 1 km uit met 700+ graven. Op het Castellumplein zijn de contouren in brons gemarkeerd.",watWasHier:"Castellum met 7 bouwfasen. Vicus (1 km) met 700+ graven. Detachement Cohors III Gallorum.",watTeZien:"Castellumplein met bronzen markeringen. Torenmuseum Valkenburg. Gereconstrueerde poort.",verwachteVondsten:"Militaria, organisch materiaal (voedsel, leer, touw), aardewerk, munten, inscripties.",betekenis:"Best gedocumenteerde Romeinse fort van Nederland. UNESCO Werelderfgoed.",bronnen:["https://www.livius.org/articles/place/praetorium-agrippinae-valkenburg-zh/","https://www.geschiedenisvanzuidholland.nl/zien-en-doen/locaties/praetorium-agrippinae-in-valkenburg/","https://oudvalkenburgzh.nl/torenmuseum-5/"]},"Castra Hunnerberg":{naam:"Castra Hunnerberg",latinNaam:"Castra",type:"legerkamp",periode:"ca. 16 v.Chr. - 104 n.Chr.",beschrijving:'Enorm Romeins legerkamp op de Hunnerberg bij Nijmegen - 42 hectare (80 voetbalvelden), ruimte voor 12.000 man. De enige plek in Nederland waar echte legioenen (geen hulptroepen) verbleven! Na de Bataafse Opstand (69 n.Chr.) vestigde Legio X Gemina Pia Fidelis zich hier - opgericht door Julius Caesar en het bekendste legioen van Nederland. De afkorting LXG is talloze keren gevonden op dakpannen en tegels. Bij opgravingen zijn ruim 1000 fragmenten militaire uitrusting en paardentuig gevonden. In 104 n.Chr. vertrok het legioen naar de Balkan - een ramp voor de economie. UNESCO Werelderfgoed sinds 2021, omschreven als "bakermat van de Nederduitse Limes".',watWasHier:"Legerkamp voor 12.000 man. Legio X Gemina (71-104 n.Chr.), opgericht door Julius Caesar.",watTeZien:"Museum Het Valkhof. Museum Kam in de Hunnerberg. Grafvelden in Nijmegen-Oost.",verwachteVondsten:"Legioenstempels LXG, militaria, paardentuig, dakpannen, munten, grafstenen.",betekenis:"UNESCO Werelderfgoed. Bakermat van de Limes. Enige legioenskamp in Nederland.",bronnen:["https://www.livius.org/articles/place/noviomagus-nijmegen-hunnerberg/","https://www.welkominnijmegen.nl/pages/geschiedenis/de-romeinen-in-nijmegen/de-legerkampen.php","https://mijngelderland.nl/inhoud/specials/archeokroniek/romeinse-militaire-uitrusting-en-paardentuig-van-de-hunerberg-te-nijmegen"]},"Castellum Kops Plateau":{naam:"Kops Plateau",latinNaam:"Oppidum Batavorum",type:"castellum",periode:"ca. 10 v.Chr. - 70 n.Chr.",beschrijving:"Vroege Romeinse basis op het Kops Plateau in Nijmegen, later de civiele hoofdstad van de Bataven: Oppidum Batavorum. Hier woonden Romeinen en Bataven samen - het eerste contactpunt tussen beide culturen. Verwoest tijdens de Bataafse Opstand van 69-70 n.Chr. onder leiding van Julius Civilis. Gemengde vondsten: Romeinse militaria n Keltisch-Bataafse voorwerpen. Vroege importaardewerk en munten van Augustus. Nu natuurgebied. Museum Het Valkhof toont de unieke vondsten van deze ontmoeting van culturen.",watWasHier:"Eerst Romeins kamp, later Bataafse hoofdstad. Romeinen en Bataven woonden samen.",watTeZien:"Kops Plateau is natuurgebied. Museum Het Valkhof toont de vondsten.",verwachteVondsten:"Vroege militaria, Keltisch-Bataafse voorwerpen, importaardewerk, munten van Augustus.",betekenis:"Eerste contactpunt Romeinen-Bataven. Begin van romanisering Nederland.",bronnen:["https://www.livius.org/articles/place/noviomagus-nijmegen-kops-plateau/"]},"Nijmegen, Valkhof":{naam:"Valkhof Nijmegen",latinNaam:"Valkhof",type:"versterking",periode:"ca. 270 - 400 n.Chr.",beschrijving:"Laat-Romeinse versterking op het Valkhof in Nijmegen, aan de Waaloever. Gebouwd toen het Rijk onder druk stond van Germaanse invallen. Strategische positie boven de rivier. Continuteit: Karel de Grote bouwde hier later zijn palts (koninklijke residentie). De Sint-Nicolaaskapel bevat mogelijk Karolingische elementen op Romeinse fundamenten. Typische laat-Romeinse vondsten: gordels met riemtongen, militaire gespen, munten van 3e-4e eeuwse keizers. Museum Het Valkhof toont de overgang van Romeinse tijd naar vroege middeleeuwen.",watWasHier:"Laat-Romeinse versterking boven de Waal. Later Karolingische palts.",watTeZien:"Valkhofpark met Sint-Nicolaaskapel. Museum Het Valkhof.",verwachteVondsten:"Laat-Romeinse munten, gordels, riemtongen, militaire gespen, 3e-4e eeuws aardewerk.",betekenis:"Toont overgang Romeinse tijd naar middeleeuwen. Nijmegen bleef machtscentrum.",bronnen:["https://www.museumhetvalkhof.nl"]},"Castellum Op de Hoge Woerd":{naam:"Hoge Woerd",latinNaam:"Castellum",type:"castellum",periode:"ca. 50 - 270 n.Chr.",beschrijving:"Romeins castellum in Leidsche Rijn (Utrecht), nu een voorbeeldig archeologisch park. Middelgroot fort met houten gebouwen en een burgerdorp (vicus) buiten de muren. Hier is een compleet Romeins schip gevonden: De Meern 1, een 25 meter lange vrachtboot. Door de natte kleigrond bleef veel organisch materiaal bewaard. Het park toont de reconstructie van het fort - je kunt over de originele fundamenten lopen. Modern museum met interactieve presentatie. Ideale plek om te zien hoe een Romeins fort eruitzag.",watWasHier:"Middelgroot castellum met houten gebouwen. Vicus buiten de muren. Compleet schip gevonden.",watTeZien:"Archeologisch Park Hoge Woerd: reconstructie fort, museum, originele fundamenten.",verwachteVondsten:"Militaria, scheepsonderdelen, aardewerk, munten. Door natte grond ook organisch materiaal.",betekenis:"Best gepresenteerde Romeinse fort in Nederland. Ideaal om fort-layout te begrijpen.",bronnen:["https://www.hogewoerd.nl"]},Lugdunum:{naam:"Lugdunum",latinNaam:"Lugdunum",type:"vlootbasis",periode:"ca. 40 - 270 n.Chr.",beschrijving:`Romeinse vlootbasis en versterkte graanopslagplaats bij de monding van de Rijn, het westelijkste punt van de gehele Limes. Hier stond mogelijk een enorme vuurtoren (ca. 60m hoog) naar model van de Pharos van Ostia - vissers noemden deze "Kalla's toren" (Caligula). Door de vele dakpannen van de Romeinse vloot wordt aangenomen dat dit een vlootbasis was. Het fort is door kustafslag in zee verdwenen. Bij stormen in 1520, 1552 en 1562 waren de runes van de "Brittenburg" zichtbaar op het strand; de laatst gedateerde vondst was 270 n.Chr. Het Rijksmuseum van Oudheden in Leiden toont vondsten. De beroemde kaart van Ortelius toont hoe het eruit zag.`,watWasHier:"Vlootbasis met vuurtoren bij Rijnmonding. Graanopslag voor Britannia.",watTeZien:"Fort verdwenen in zee. RMO Leiden toont vondsten en kaart van Ortelius.",verwachteVondsten:"Na stormen: munten, aardewerk, militaria. Fort zelf onbereikbaar in Noordzee.",betekenis:"Westelijk eindpunt van de Limes. Verbinding met Britannia.",bronnen:["https://www.livius.org/articles/place/lugdunum-katwijk/","https://nl.wikipedia.org/wiki/Lugdunum_(Katwijk)"]},"Vlootbasis Naaldwijk":{naam:"Vlootbasis Naaldwijk",type:"vlootbasis",periode:"1e - 2e eeuw n.Chr.",beschrijving:"Vermoedelijke basis van de Classis Germanica (Germaanse vloot) bij Naaldwijk in het Westland. De Romeinse vloot patrouilleerde langs de Noordzeekust en vervoerde troepen en goederen naar Britannia. Haven met dokken voor oorlogsschepen en transportboten. Mariniers (classiarii) waren hier gestationeerd. Het gebied is nu landbouwgrond, maar bij opgravingen zijn haven-structuren en scheepsgerelateerde vondsten gedaan. Ankers, scheepsonderdelen en specifieke mariniers-uitrusting. Toont het belang van zeemacht voor de Romeinse grensverdediging.",watWasHier:"Haven voor oorlogsschepen. Mariniers gestationeerd. Patrouilles langs Noordzeekust.",watTeZien:"Gebied is landbouwgrond. Vondsten in lokale musea.",verwachteVondsten:"Scheepsonderdelen, ankers, mariniers-uitrusting, importaardewerk.",betekenis:"Toont belang Romeinse vloot voor kustverdediging.",bronnen:[]},"Minifort Ockenburg":{naam:"Minifort Ockenburg",type:"minifort",periode:"ca. 150 - 180 n.Chr.",beschrijving:"Klein Romeins kustfort bij Ockenburg in Den Haag, op een oude strandwal. Bewaakte de kust tegen piraten en Germaanse invallen over zee. Ruimte voor slechts 20-30 soldaten - een wachtpost eerder dan een echt fort. Korte gebruiksperiode van ca. 30 jaar. Toont dat de Romeinen niet alleen de rivieren maar ook de Noordzeekust verdedigden. Het terrein is beschermd rijksmonument maar niet publiek toegankelijk. Vondsten in het Haags Historisch Museum: militaria, aardewerk en munten uit de 2e eeuw.",watWasHier:"Kleine kustwachtpost voor 20-30 soldaten op strandwal.",watTeZien:"Terrein beschermd maar niet toegankelijk. Haags Historisch Museum.",verwachteVondsten:"Kleine hoeveelheden militaria, aardewerk, munten 2e eeuw.",betekenis:"Toont Romeinse kustverdediging naast rivierforten.",bronnen:[]},"Castellum Ceuclum":{naam:"Ceuclum",latinNaam:"Ceuclum",type:"castellum",periode:"ca. 70 - 270 n.Chr.",beschrijving:"Romeins castellum bij Cuijk aan de Maas, waar de belangrijke weg naar het noorden de rivier kruiste. Het fort bewaakte een brug of veerpont. Garnizoen van hulptroepen. De naam Cuijk is afgeleid van Ceuclum. Bij de brug werden ritueel munten geofferd. Het fort lag op een strategisch punt waar de Maasroute de landweg kruiste. Vondsten wijzen op handel en militaire activiteit. Het Maasmuseum in Cuijk toont lokale Romeinse vondsten. Onder het centrum zijn bij bouwwerkzaamheden regelmatig resten gevonden.",watWasHier:"Castellum bij Maasbrug. Belangrijke rivierovergang en kruispunt.",watTeZien:"Maasmuseum Cuijk. Resten gevonden onder centrum.",verwachteVondsten:"Munten (geofferd bij brug), fibulae, aardewerk, bruggerelateerde vondsten.",betekenis:"Belangrijke schakel in wegennet langs de Maas.",bronnen:["https://www.livius.org/articles/place/ceuclum-cuijk/"]},"Castellum Meinerswijk":{naam:"Meinerswijk",type:"castellum",periode:"ca. 40 - 270 n.Chr.",beschrijving:"Romeins castellum in de uiterwaarden bij Arnhem-Meinerswijk aan de Rijn. Het fort bewaakt een strategisch punt waar de rivier goed te overzien was. Meerdere bouwfasen door overstromingen. In de uiterwaarden zijn bij erosie en opgravingen vondsten gedaan: militaria, aardewerk, munten en scheepsresten. Het gebied is nu natuurgebied Meinerswijk met wisselende waterstanden. Na hoog water kunnen vondsten aan de oppervlakte komen. Museum Arnhem toont Romeinse vondsten uit de regio.",watWasHier:"Castellum in uiterwaarden. Meerdere bouwfasen door overstromingen.",watTeZien:"Natuurgebied Meinerswijk. Museum Arnhem.",verwachteVondsten:"Militaria, aardewerk, munten, scheepsresten. Na hoog water aan oppervlakte.",betekenis:"Onderdeel fortenketen langs de Rijn.",bronnen:[]},Levefanum:{naam:"Levefanum",latinNaam:"Levefanum",type:"versterking",periode:"ca. 50 - 270 n.Chr.",beschrijving:"Romeinse versterking bij Wijk bij Duurstede, waar de Rijn splitste in de Lek en Kromme Rijn. Strategisch cruciaal punt voor controle over het scheepvaartverkeer. Waarschijnlijk ook een haven voor overslag van goederen. Op dezelfde plek ontstond later de Karolingische handelsstad Dorestad, een van de belangrijkste havens van vroegmiddeleeuws Europa. De continuteit toont het blijvende belang van deze locatie. Dorestad Museum vertelt het verhaal van Romeinse tijd tot Vikingaanvallen. Vondsten: munten, handelsaardewerk, militaria.",watWasHier:"Versterking bij riviersplitsing. Haven en overslagpunt. Later Dorestad.",watTeZien:"Dorestad Museum. Terrein bebouwd.",verwachteVondsten:"Munten, handelsaardewerk, militaria, scheepsgerelateerde vondsten.",betekenis:"Strategisch controlepunt waterwegen. Later belangrijke handelsstad Dorestad.",bronnen:[]},"Nigrum Pullum":{naam:"Nigrum Pullum",latinNaam:"Nigrum Pullum (Zwarte Poel)",type:"minifort",periode:"ca. 40 - 270 n.Chr.",beschrijving:"Romeins castellum bij Zwammerdam aan de Oude Rijn. Garnizoen van 100-150 soldaten met pakhuizen en haven voor riviertransport. Wereldberoemd door de vondst van 6 Romeinse schepen (1971-1974) in perfecte staat - bewaard door de natte veengrond. De Zwammerdamschepen zijn de best bewaarde Romeinse rivierschepen ter wereld en tonen uniek inzicht in Romeins transport en scheepsbouw. Vondsten: schepen, leren schoeisel, houten voorwerpen, aardewerk, munten, militaria. Te zien in Rijksmuseum van Oudheden, Leiden.",watWasHier:"Klein fort met pakhuizen en haven. Bij opgravingen werden 6 Romeinse schepen gevonden.",watTeZien:"De schepen zijn in het Rijksmuseum van Oudheden in Leiden. Het terrein zelf is niet te bezoeken.",verwachteVondsten:"Scheepsonderdelen, leren schoeisel, houten voorwerpen, aardewerk, munten, en door de natte veengrond organisch materiaal.",betekenis:"Wereldberoemd om de goed bewaarde Romeinse schepen. Toont transport over de Rijn.",bronnen:["https://www.rmo.nl/collectie/themas/zwammerdam"]},"Stenen wachttoren Vleuterweide":{naam:"Wachttoren Vleuterweide",type:"wachttoren",periode:"ca. 150 - 250 n.Chr.",beschrijving:"Bijzondere stenen wachttoren in Vleuterweide bij Utrecht - de meeste Romeinse wachttorens waren van hout. De stenen constructie wijst op permanentie en belang. Onderdeel van het signaleringssysteem langs de Limes: bij gevaar werden vuren aangestoken om forten te waarschuwen. De toren bood uitzicht over de omgeving en de rivier. Mogelijk woonden hier ook families van de soldaten. De fundamenten zijn gemarkeerd in de moderne woonwijk. Vondsten: bouwmateriaal (dakpannen, stenen), aardewerk, persoonlijke bezittingen. Centraal Museum Utrecht.",watWasHier:"Stenen wachttoren (ongebruikelijk). Signaalpost voor waarschuwingssysteem.",watTeZien:"Fundamenten gemarkeerd in wijk. Centraal Museum Utrecht.",verwachteVondsten:"Dakpannen met legioenstempels, aardewerk, persoonlijke bezittingen.",betekenis:"Een van weinige bekende stenen wachttorens. Toont variatie in bouwwijzen.",bronnen:[]},"Wachttoren Bunnik":{naam:"Wachttoren Bunnik",type:"wachttoren",periode:"ca. 50 - 270 n.Chr.",beschrijving:"Houten wachttoren bij Bunnik aan de Rijn, onderdeel van het signaleringssysteem langs de Limes. Elke paar kilometer stond een toren met uitzicht over de rivier. Bij nadering van vijanden werden vuren of rooksignalen gegeven, zodat binnen minuten alle forten gewaarschuwd waren. De torens waren meestal van hout op een aarden verhoging. Kleine bezetting van 4-8 soldaten. De exacte locatie is niet precies bekend doordat het gebied nu bebouwd is. Vondsten zijn schaars: wat aardewerk en militaria.",watWasHier:"Houten uitkijktoren voor signalering. Kleine bezetting van 4-8 soldaten.",watTeZien:"Exacte locatie onbekend. Gebied bebouwd.",verwachteVondsten:"Kleine hoeveelheden militaria en aardewerk.",betekenis:"Onderdeel signaleringssysteem langs Limes.",bronnen:[]},"Castellum Maastricht":{naam:"Castellum Maastricht",latinNaam:"Mosae Trajectum",type:"versterking",periode:"ca. 270 - 400 n.Chr.",beschrijving:'Laat-Romeinse versterking in het centrum van Maastricht bij de brug over de Maas. Mosae Trajectum betekent "Maasoversteek". Gebouwd in een periode dat het Rijk onder druk stond van Germaanse invallen. Het fort bewaakte de strategische rivierovergang. Continuteit van bewoning: Maastricht bleef bewoond tot op heden. Onder het Vrijthof en omgeving zijn Romeinse resten gevonden. Typische laat-Romeinse vondsten: gordels, riembeslag, munten 3e-4e eeuw, zwaar versterkte muren. Centre Ceramique vertelt de geschiedenis.',watWasHier:"Laat-Romeinse versterking bij Maasbrug. Verdediging tegen Germaanse invallen.",watTeZien:"Onder Vrijthof zijn resten. Centre Ceramique.",verwachteVondsten:"Laat-Romeinse munten, militaire gordelbeslag, riemtongen, 3e-4e eeuws aardewerk.",betekenis:"Toont continuteit - Maastricht ononderbroken bewoond sinds Romeinse tijd.",bronnen:["https://www.centreceramique.nl"]},Roompot:{naam:"Roompot Fort",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeins kustfort bij de Roompot in Zeeland dat de toegang tot de Oosterschelde bewaakte. Het fort beschermde schepen tegen piraterij en controleerde de vaarroute. Door zeespiegelstijging en kustafslag is het fort in de golven verdwenen. De exacte locatie ligt nu onder water. Soms spoelen na stormen vondsten aan op de stranden van Noord-Beveland en Walcheren: munten, aardewerk, metalen voorwerpen. Toont dat de Romeinen de gehele Zeeuwse delta controleerden, niet alleen de grote rivieren.",watWasHier:"Kustfort dat zeeroute bewaakte. Bescherming tegen piraterij.",watTeZien:"Fort verdwenen in zee. Soms vondsten op strand na stormen.",verwachteVondsten:"Na stormen: munten, aardewerk, metalen voorwerpen op Zeeuwse stranden.",betekenis:"Toont Romeinse controle over Zeeuwse wateren.",bronnen:[]},"Castellum Carvium":{naam:"Carvium",latinNaam:"Carvium",type:"castellum",periode:"ca. 40 - 270 n.Chr.",beschrijving:"Romeins castellum bij Herwen-Aerdt (bij Lobith) waar Rijn en Waal samenkwamen - een strategisch knooppunt van eerste orde. Het fort controleerde het rivierverkeer op beide grote stromen. Garnizoen van hulptroepen. In de uiterwaarden zijn bij erosie en opgravingen vondsten gedaan. Het gebied is nu natuurgebied de Gelderse Poort met dynamische rivierlandschap. Na hoog water kunnen vondsten aan oppervlakte komen. Museum Het Valkhof in Nijmegen toont vondsten uit de regio. Scheepsresten gevonden.",watWasHier:"Fort bij samenvloeiing Rijn en Waal. Controleerde twee grote rivieren.",watTeZien:"Natuurgebied Gelderse Poort. Museum Het Valkhof Nijmegen.",verwachteVondsten:"Militaria, aardewerk, munten, scheepsresten. Na hoog water aan oppervlakte.",betekenis:"Controleerde strategisch knooppunt waterwegen.",bronnen:[]},Matilo:{naam:"Matilo",latinNaam:"Matilo",type:"castellum",periode:"ca. 70 - 260 n.Chr.",beschrijving:'Romeins castellum bij Leiden-Roomburg, gebouwd na de Bataafse Opstand (69-70 n.Chr.) op een strategische plek aan de monding van het Kanaal van Corbulo. Het gigantische fort (80x120m) bood plaats aan ca. 500 soldaten en is een van de best bewaarde castella in Nederland. De archeologische resten liggen grotendeels intact onder Archeologisch Park Matilo. In het park staan 6 replica-wachttorens en een aarden wal die de omtrek van het fort visualiseert. Het fort werd tussen 240-260 n.Chr. opgeheven. De locatie Roomburg ("Romeinse burcht") verwijst naar de oorsprong. UNESCO Werelderfgoed sinds 2021.',watWasHier:"Groot castellum (500 soldaten) bij monding Kanaal van Corbulo. Vicus buiten de muren.",watTeZien:"Archeologisch Park Matilo met 6 wachttoren-replica's en aarden wal. Rijksmuseum van Oudheden.",verwachteVondsten:"Militaria, grafgiften, crematie-urnen, aardewerk, munten, fibulae.",betekenis:"UNESCO Werelderfgoed. Een van de best bewaarde castella van Nederland.",bronnen:["https://parkmatilo.nl/het-verhaal-van-matilo/","https://www.limeswerelderfgoed.nl/locaties/2016475046/archeologisch-park-matilo","https://www.romeinen.nl/locatie-overzicht/2016475046/archeologisch-park-matilo"]},Corbulo:{naam:"Forum Hadriani",latinNaam:"Forum Hadriani (Municipium Aelium Cananefatium)",type:"versterking",periode:"ca. 70 - 270 n.Chr.",beschrijving:"Forum Hadriani bij Voorburg was de noordelijkste Romeinse stad van het Europese continent en de enige stad met stadsrechten in Nederland. Gesticht rond 70 n.Chr. aan het Kanaal van Corbulo (34 km, verbinding Rijn-Maas). Keizer Hadrianus verleende in 121 n.Chr. marktrechten en gaf de stad zijn naam. Rond 150 n.Chr. kreeg het stadsrechten (Municipium). De stad had ca. 1000 inwoners, een stadsmuur met dubbele gracht, stenen gebouwen en tempels. Park Arentsburgh markeert de locatie. UNESCO Werelderfgoed sinds 2021. De eerste wetenschappelijke opgravingen (1827-1833) waren door Caspar Reuvens, de eerste hoogleraar archeologie ter wereld.",watWasHier:"Enige Romeinse stad met stadsrechten in Nederland. Ca. 1000 inwoners.",watTeZien:"Park Arentsburgh in Voorburg. Kanaal traceerbaar als de Vliet.",verwachteVondsten:"Stedelijke vondsten: bouwmateriaal, aardewerk, munten, inscripties, religieuze voorwerpen.",betekenis:"UNESCO Werelderfgoed. Noordelijkste Romeinse stad van Europa.",bronnen:["https://www.awlv.nl/forum-hadriani/de-stad-forum-hadriani/","https://www.romeinen.nl/weten/nederland-in-de-romeinse-tijd/zuid-holland/regio-voorburg","https://kennis.cultureelerfgoed.nl/index.php/Monumenten/508083"]},"Berg - Tomveld":{naam:"Berg-Tomveld",type:"villa",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeinse villa bij Berg in Zuid-Limburg, mogelijk tijdelijk militair gebruikt. Dit type gebouwen diende als landbouwbedrijf met luxe woondeel voor de eigenaar. De regio Zuid-Limburg was dicht bebouwd met villa's die graan en vee leverden aan het Romeinse leger. Vondsten wijzen op welvaart: mozaekvloeren, beschilderd pleisterwerk, hypocaustum (vloerverwarming). De locatie Tomveld verwijst mogelijk naar Romeinse grafheuvels (tumuli) in de buurt. Thermenmuseum Heerlen toont de villa-cultuur.",watWasHier:"Villa rustica met mogelijk militair gebruik. Landbouw voor legervoorraden.",watTeZien:"Locatie in agrarisch gebied. Thermenmuseum Heerlen.",verwachteVondsten:"Bouwmateriaal, dakpannen, aardewerk, munten, sieraden.",betekenis:"Toont Romeinse landbouweconomie in Zuid-Limburg.",bronnen:[]},"Berg - Trappenberg":{naam:"Berg-Trappenberg",type:"legerkamp",periode:"1e eeuw v.Chr. - 1e eeuw n.Chr.",beschrijving:"Vroeg-Romeins legerkamp bij Berg in Zuid-Limburg dat later werd omgebouwd tot villa of boerderij. Toont de transitie van militaire bezetting naar civiele bewoning. Het kamp dateert uit de veroveringsperiode toen Rome dit gebied inlijfde. Na pacificatie was een fort niet meer nodig en werd het terrein civiel benut. Vondsten: vroege Romeinse militaria naast later agrarisch materiaal. Zuid-Limburg was een grenszone voordat de Limes naar de Rijn verplaatste.",watWasHier:"Eerst legerkamp, later villa/boerderij. Overgang militair naar civiel.",watTeZien:"Locatie in landbouwgebied.",verwachteVondsten:"Vroege militaria, later agrarisch aardewerk, bouwmateriaal.",betekenis:"Toont Romeinse verovering en pacificatie van Zuid-Limburg.",bronnen:[]},"Castellum Blariacum":{naam:"Blariacum",latinNaam:"Blariacum",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Mogelijke locatie van het Romeinse castellum Blariacum bij Blerick (nu deel van Venlo). De naam leeft voort in de plaatsnaam. Het fort zou de Maasovergang hebben bewaakt op de route tussen Xanten en Maastricht. De exacte locatie is nooit definitief vastgesteld ondanks vele opgravingspogingen. Vondsten in de omgeving wijzen wel op Romeinse militaire aanwezigheid: militaria, munten, aardewerk. Het Limburgs Museum in Venlo toont de Romeinse geschiedenis van de regio.",watWasHier:"Vermoedelijk castellum bij Maasovergang. Exacte locatie onzeker.",watTeZien:"Locatie niet vastgesteld. Limburgs Museum Venlo.",verwachteVondsten:"Militaria, munten, aardewerk als aanwijzingen voor fortlocatie.",betekenis:"Plaatsnaam Blerick afgeleid van Blariacum. Schakel in Maasroute.",bronnen:[]},"Fortificatie Bodegraven":{naam:"Wachtpost Bodegraven",type:"wachttoren",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Waarschijnlijke Romeinse wachtpost bij Bodegraven aan de Oude Rijn. Onderdeel van het signaleringssysteem tussen de grotere forten zoals Nigrum Pullum en Laurum. De wachttorens stonden om de paar kilometer en konden met vuur- of rooksignalen waarschuwingen doorgeven. Kleine bezetting van 4-8 soldaten. De exacte locatie is niet precies bekend. Bij graafwerkzaamheden in Bodegraven zijn wel Romeinse scherven gevonden die op aanwezigheid wijzen.",watWasHier:"Kleine wachtpost voor signalering. 4-8 soldaten.",watTeZien:"Exacte locatie onbekend.",verwachteVondsten:"Aardewerk, kleine hoeveelheden militaria.",betekenis:"Onderdeel communicatiesysteem langs de Limes.",bronnen:[]},Caestert:{naam:"Caestert",type:"versterking",periode:"1e eeuw v.Chr.",beschrijving:"Mogelijk de locatie waar de Eburonen onder leiding van Ambiorix in 54 v.Chr. een Romeins legioen vernietigden - de zwaarste Romeinse nederlaag in de Lage Landen. Het plateau van Caestert bij Kanne (Belgisch Limburg) had een oppidum (versterkte nederzetting). Julius Caesar beschrijft de slag in zijn Gallische Oorlogen. De locatie is omstreden, maar Caestert is een sterke kandidaat. Symbolisch belangrijke plek voor de Belgische geschiedenis. De site is nu natuurgebied met grotten.",watWasHier:"Mogelijk slagveld Ambiorix-opstand 54 v.Chr. Oppidum (versterking).",watTeZien:"Plateau Caestert, natuurgebied met grotten.",verwachteVondsten:"Keltische en vroeg-Romeinse voorwerpen, mogelijk slagveldvondsten.",betekenis:"Mogelijke locatie grootste Romeinse nederlaag in de regio.",bronnen:[]},"Castellum Driel?":{naam:"Castellum Driel",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:'Mogelijke locatie van een Romeins castellum bij Driel in de Betuwe. Het bestaan en de exacte locatie zijn onzeker, vandaar het vraagteken. De Betuwe (Insula Batavorum - "Eiland der Bataven") was kerngebied van de Bataven, bondgenoten van Rome. Zij leverden beroemde hulptroepen aan het Romeinse leger. Een fort hier zou logisch zijn om het gebied te controleren. Vondsten in de omgeving wijzen op Romeinse aanwezigheid. Museum Het Valkhof Nijmegen toont de Bataafse cultuur.',watWasHier:"Mogelijk castellum in Bataafs kerngebied. Bestaan onzeker.",watTeZien:"Geen zichtbare resten. Museum Het Valkhof.",verwachteVondsten:"Romeinse en Bataafse voorwerpen indien locatie juist.",betekenis:"Zou Romeinse controle over Bataafs gebied tonen.",bronnen:[]},"Castellum Duiven - Loowaard":{naam:"Duiven-Loowaard",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeins castellum bij Duiven/Loowaard aan de Rijn, in de uiterwaarden tussen Arnhem en Zevenaar. Het fort bewaakte de rivierroute en de overgang naar het Bataafse gebied. De dynamische rivier heeft veel resten weggespoeld of diep begraven. Bij lage waterstanden en na erosie komen soms vondsten aan oppervlakte: munten, militaria, aardewerk. Het gebied is nu natuurgebied met grazende grote grazers. Museum Arnhem en Het Valkhof Nijmegen tonen vondsten uit de regio.",watWasHier:"Castellum aan de Rijn in uiterwaarden. Bewaakte rivierovergang.",watTeZien:"Natuurgebied. Na erosie mogelijk vondsten aan oppervlakte.",verwachteVondsten:"Militaria, munten, aardewerk na erosie of bij laag water.",betekenis:"Onderdeel fortenketen langs de Rijn.",bronnen:[]},"Castellum Grinnes":{naam:"Grinnes",latinNaam:"Grinnes",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeins castellum bij Rossum in de gemeente Maasdriel - waarschijnlijk het antieke Grinnes vermeld op de Peutingerkaart. Het fort lag aan de Waal en controleerde de rivierroute. Bij opgravingen zijn resten van het fort gevonden. De omgeving is rijk aan Romeinse vondsten: militaria, munten, aardewerk, bouwmateriaal. Het Museum voor de Bommelerwaard in Ammerzoden toont lokale vondsten. De naam Grinnes leeft niet voort in moderne plaatsnamen.",watWasHier:"Castellum aan de Waal. Vermeld op Peutingerkaart.",watTeZien:"Locatie opgegraven. Museum Bommelerwaard.",verwachteVondsten:"Militaria, munten, aardewerk, bouwmateriaal.",betekenis:"Verbinding antieke bronnen met archeologische locatie.",bronnen:[]},"Wachttoren Heumen":{naam:"Wachttoren Heumen",type:"wachttoren",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeinse wachttoren bij Heumen ten zuiden van Nijmegen. Onderdeel van het signaleringssysteem langs de Maas en verbindingswegen. De torens stonden op strategische punten met goed uitzicht. Bij nadering van vijanden werden signalen gegeven naar de grotere forten. Kleine bezetting van 4-8 soldaten die in de toren woonden. De exacte locatie is archeologisch vastgesteld. Vondsten: militaria, aardewerk, persoonlijke bezittingen.",watWasHier:"Signaleertoren met klein garnizoen. Uitzichtpunt.",watTeZien:"Locatie bekend maar geen zichtbare resten.",verwachteVondsten:"Militaria, aardewerk, kleine persoonlijke voorwerpen.",betekenis:"Onderdeel communicatienetwerk Romeins leger.",bronnen:[]},"Castellum Huissen?":{naam:"Castellum Huissen",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Mogelijke locatie van een Romeins castellum bij Huissen aan de Rijn. Het bestaan is niet zeker vastgesteld, vandaar het vraagteken. Huissen ligt op een logische plek tussen de bekende forten bij Arnhem en Zevenaar. Vondsten in de omgeving wijzen op Romeinse activiteit. De moderne bebouwing maakt onderzoek lastig. Als er een fort was, bewaakte het de rivierroute en mogelijk een oversteekplaats.",watWasHier:"Mogelijk castellum aan de Rijn. Bestaan onzeker.",watTeZien:"Geen resten zichtbaar. Gebied bebouwd.",verwachteVondsten:"Romeinse vondsten die fortaanwezigheid zouden bevestigen.",betekenis:"Zou gat in fortenketen opvullen indien bevestigd.",bronnen:[]},"Castellum Kessel-Lith":{naam:"Kessel-Lith",type:"castellum",periode:"3e - 4e eeuw n.Chr.",beschrijving:"Laat-Romeins castellum uit de 3e-4e eeuw bij Kessel-Lith aan de Maas. Gebouwd in een periode van Germaanse invallen toen de oude Limes niet meer te handhaven was. Dit type forten was compacter en zwaarder versterkt dan de vroege castella. De locatie bij een rivierovergang bleef strategisch. Typische laat-Romeinse vondsten: gordels met riemtongen, militaire gespen, munten van 3e-4e eeuwse keizers. Het fort toont de veranderde militaire strategie van het late Romeinse Rijk.",watWasHier:"Laat-Romeins fort, compacter en zwaarder versterkt.",watTeZien:"Locatie bekend, weinig zichtbaar.",verwachteVondsten:"Laat-Romeinse munten, gordelbeslag, riemtongen, 3e-4e eeuws aardewerk.",betekenis:"Toont Romeinse aanpassing aan nieuwe dreigingen.",bronnen:[]},Carvo:{naam:"Carvo",latinNaam:"Carvo",type:"versterking",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Mogelijke Romeinse versterking nabij Kesteren in de Betuwe. De naam komt voor op de Peutingerkaart. Kesteren lag in het hart van het Bataafse stamgebied. De Bataven waren belangrijke bondgenoten van Rome en leverden beroemde cavalerie-eenheden. Een versterking hier zou zowel bescherming als controle bieden. De exacte locatie is niet vastgesteld. Vondsten in de regio tonen intensief Romeins-Bataafs contact: import-aardewerk, wapens, paardentuig.",watWasHier:"Vermoedelijke versterking in Bataafs kerngebied.",watTeZien:"Locatie onbekend.",verwachteVondsten:"Gemengd Romeins-Bataafse voorwerpen, paardentuig.",betekenis:"Zou Romeinse aanwezigheid in Bataafs gebied tonen.",bronnen:[]},Mannaricium:{naam:"Mannaricium",latinNaam:"Mannaricium",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Vermoedelijke locatie van het Romeinse castellum Mannaricium bij Maurik aan de Rijn. De naam komt voor op de Peutingerkaart. Het fort zou de rivierroute hebben bewaakt tussen Levefanum (Wijk bij Duurstede) en forten stroomopwaarts. De moderne plaats Maurik zou afgeleid kunnen zijn van Mannaricium. Bij bouwwerkzaamheden zijn Romeinse vondsten gedaan die op een fort wijzen. De exacte contouren zijn niet bekend.",watWasHier:"Vermoedelijk castellum aan de Rijn. Vermeld op Peutingerkaart.",watTeZien:"Geen zichtbare resten. Gebied bebouwd.",verwachteVondsten:"Militaria, aardewerk, munten bij bouwwerkzaamheden.",betekenis:"Mogelijke herkomst plaatsnaam Maurik.",bronnen:[]},Oostvoorne:{naam:"Castellum Oostvoorne",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeins kustfort bij de monding van de Waal en Maas, nu verdwenen in zee door kustafslag. Het fort bewaakte de zeeroute en beschermde tegen piraterij. De kust lag in de Romeinse tijd kilometers verder westwaarts. Door zeespiegelstijging en erosie is het fort in de golven verdwenen. Na stormen spoelen soms vondsten aan op de stranden van Voorne-Putten: munten, aardewerk, metalen voorwerpen. De Brittenburg bij Katwijk was een soortgelijk lot beschoren.",watWasHier:"Kustfort bij riviermonding. Bewaking zeeroute.",watTeZien:"Fort verdwenen in zee. Soms strandvondsten na stormen.",verwachteVondsten:"Na stormen: munten, aardewerk, metalen op strand.",betekenis:"Toont voormalige kustlijn en Romeinse kustverdediging.",bronnen:[]},"Castellum Randwijk":{naam:"Castellum Randwijk",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Mogelijke locatie van een Romeins castellum bij Randwijk aan de Rijn in de Betuwe. Het bestaan en de exacte locatie zijn onzeker. De rivier heeft veel oude resten weggespoeld. Randwijk ligt tussen bekende fortlocaties wat een fort hier logisch zou maken. In de uiterwaarden zijn bij erosie Romeinse vondsten gedaan. Het dynamische rivierlandschap maakt onderzoek lastig maar kan ook vondsten blootleggen na hoog water.",watWasHier:"Mogelijk castellum. Bestaan en locatie onzeker.",watTeZien:"Geen zichtbare resten. Uiterwaarden.",verwachteVondsten:"Mogelijk vondsten na erosie of hoog water.",betekenis:"Zou gat in fortenketen opvullen indien bevestigd.",bronnen:[]},"Versterking Scheveningseweg":{naam:"Minifort Scheveningseweg",type:"minifort",periode:"2e eeuw n.Chr.",beschrijving:"Vermoede locatie van een klein Romeins kustfort bij de Scheveningseweg in Den Haag, vergelijkbaar met het nabije Minifort Ockenburg. Dit type miniforten bewaakte de kust tegen piraten en Germaanse raids over zee. Ruimte voor 20-30 soldaten. De exacte locatie is niet vastgesteld maar vondsten in de omgeving suggereren Romeinse militaire aanwezigheid. Het zou aantonen dat de gehele Noordzeekust werd bewaakt, niet alleen de riviermonding.",watWasHier:"Vermoedelijk klein kustfort zoals Ockenburg. 20-30 soldaten.",watTeZien:"Locatie niet vastgesteld.",verwachteVondsten:"Militaria, aardewerk 2e eeuw indien locatie gevonden.",betekenis:"Zou Romeinse kustverdediging Den Haag bevestigen.",bronnen:[]},"Tongeren - Sacramentstraat":{naam:"Atuatuca Tungrorum",latinNaam:"Atuatuca Tungrorum / Municipium Tungrorum",type:"legerkamp",periode:"ca. 10 v.Chr. - 400 n.Chr.",beschrijving:"Oudste stad van Belgi, gesticht ca. 10 v.Chr. Hoofdstad van de Civitas Tungrorum - met 150 hectare de grootste civitas van Noordwest-Europa! Strategisch gelegen op de weg Boulogne-Bavay-Keulen. Onder keizer Trajanus (2e eeuw) ommuurd met meer dan 4,5 km muren en tot 3 grachten - waarvan nog 1,5 km staat! Een 1e-eeuwse buste van Julius Caesar is een topstuk. Het Gallo-Romeins Museum (Europees Museum van het Jaar 2011) toont een schat aan vondsten: beelden, steles, sieraden, architectuurelementen. Ook de Romeinse muren, het tempelcomplex, het aquaduct van Beukenberg en tumuli zijn te bezoeken.",watWasHier:"Civitas-hoofdstad Tungri (150 ha). 4,5 km stadsmuur. Politiek en religieus centrum.",watTeZien:"Gallo-Romeins Museum. Romeinse muren (1,5 km). Tempelcomplex. Aquaduct Beukenberg. Tumuli.",verwachteVondsten:"Stadsaardewerk, bouwmateriaal, munten, inscripties, religieuze objecten.",betekenis:"Oudste stad van Belgi. Grootste civitas van Noordwest-Europa.",bronnen:["https://www.galloromeinsmuseum.be","https://www.canonvanvlaanderen.be/en/events/tongeren-a-roman-town/"]},"Valkenburg-Marktveld, mini-castellum":{naam:"Marktveld Valkenburg",type:"minifort",periode:"1e - 2e eeuw n.Chr.",beschrijving:"Klein Romeins castellum met wachttoren bij het Marktveld in Valkenburg (Zuid-Holland), nabij het grotere Praetorium Agrippinae. Dit type miniforten vulde de ruimtes tussen de grote castella op. Wachttoren voor signalering en kleine bezetting voor patrouilles. De combinatie van toren en klein fort was effectief voor grensbewaking. Bij opgravingen zijn de contouren vastgesteld. Vondsten in Archeologisch Steunpunt Valkenburg.",watWasHier:"Klein fort met wachttoren. Aanvulling op Praetorium Agrippinae.",watTeZien:"Archeologisch Steunpunt Valkenburg.",verwachteVondsten:"Militaria, aardewerk, kleine persoonlijke voorwerpen.",betekenis:"Toont gelaagdheid Romeinse grensverdediging.",bronnen:[]},"Wachttoren a":{naam:"Wachttoren Utrecht-West",type:"wachttoren",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Een van meerdere Romeinse wachttorens in de omgeving van Utrecht, onderdeel van het signaleringssysteem langs de Limes. De torens stonden om de 1-2 kilometer met zicht op elkaar. Bij nadering van vijanden werden vuur- of rooksignalen gegeven. Binnen minuten kon de hele grens gewaarschuwd zijn. Kleine houten constructie op aarden verhoging met bezetting van 4-8 soldaten. Vondsten zijn schaars door de kleine schaal.",watWasHier:"Houten signaleertoren. 4-8 soldaten.",watTeZien:"Geen zichtbare resten.",verwachteVondsten:"Kleine hoeveelheden aardewerk en militaria.",betekenis:"Onderdeel vroegwaarschuwingssysteem.",bronnen:[]},"Wachttoren b":{naam:"Wachttoren Utrecht-Oost",type:"wachttoren",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeinse wachttoren ten oosten van Utrecht, onderdeel van de keten signaleertorens langs de Rijn. Elke toren had zichtlijn naar de volgende. Dit systeem maakte snelle communicatie mogelijk in een tijd zonder telegraaf of telefoon. De soldaten woonden in of bij de toren en hielden permanent wacht. Bij gevaar werden brandende fakkels of rookpotten gebruikt. De locatie is archeologisch vastgesteld maar niet zichtbaar.",watWasHier:"Signaleertoren in torenketen. Permanente wacht.",watTeZien:"Geen zichtbare resten.",verwachteVondsten:"Aardewerk, militaria, persoonlijke bezittingen.",betekenis:"Onderdeel communicatienetwerk Limes.",bronnen:[]},"Wachttoren c":{naam:"Wachttoren Hoge Woerd",type:"wachttoren",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeinse wachttoren nabij Castellum Op de Hoge Woerd, onderdeel van het signaleringssysteem. Torens bij forten dienden als vooruitgeschoven posten en waarschuwingsplaatsen. De combinatie van fort met omringende torens was de standaard Romeinse grensverdediging. Het Archeologisch Park Hoge Woerd geeft een goed beeld van hoe dit systeem functioneerde. De toren zelf is niet gereconstrueerd maar de context is te begrijpen.",watWasHier:"Signaleertoren bij castellum. Vooruitgeschoven post.",watTeZien:"Archeologisch Park Hoge Woerd toont context.",verwachteVondsten:"Aardewerk, militaria.",betekenis:"Toont samenhang fort en torens.",bronnen:[]},"Zwammerdam-Rijksstraatweg":{naam:"Zwammerdam-Rijksstraatweg",type:"versterking",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Mogelijke militaire nederzetting aan de Rijksstraatweg in Zwammerdam, naast het bekende Nigrum Pullum fort. Mogelijk een vicus (burgerdorp) of aparte militaire faciliteit. Bij Zwammerdam werden de beroemde Romeinse schepen gevonden. De hele zone langs de Oude Rijn was dicht bezet met militaire en civiele structuren. Vondsten wijzen op intensieve Romeinse activiteit: aardewerk, munten, militaria en door de natte veenbodem ook organisch materiaal.",watWasHier:"Mogelijk vicus of militaire faciliteit nabij Nigrum Pullum.",watTeZien:"Geen zichtbare resten.",verwachteVondsten:"Aardewerk, munten, militaria, organisch materiaal.",betekenis:"Toont dichtheid Romeinse bewoning langs Oude Rijn.",bronnen:[]},"Kastell Aachen":{naam:"Aquae Granni",latinNaam:"Aquae Granni",type:"versterking",periode:"1e - 4e eeuw n.Chr.",beschrijving:'Romeinse kuuroord bij de hete bronnen (tot 75C!) gewijd aan Apollo en de Keltische geneesheer Grannos - "aan de wateren van Grannos". In de 1e eeuw uitgebouwd tot kurort voor de legioenen van Neder-Germani. Onder keizer Trajanus bouwden legioenen uit Xanten een aquaduct en thermen onder de huidige Dom. De Mnsterthermen hadden de indeling van een valetudinarium (Romeins hospitaal). Karel de Grote bouwde hier zijn Pfalz (793-813) en maakte Aken tot keizerlijke residentie - bewust als "vernieuwer van het Romeinse Rijk". De Dom (UNESCO 1978, eerste in Duitsland!) staat op Romeinse fundamenten. Karel stierf hier in 814.',watWasHier:"Kurort voor legioenen. Thermen. Later keizerlijke Pfalz van Karel de Grote.",watTeZien:"Dom (UNESCO). Centre Charlemagne. Thermen onder de stad.",verwachteVondsten:"Badhuisresten, inscripties, munten, Romeins en Karolingisch bouwmateriaal.",betekenis:"Ononderbroken bewoning van Romeinse tijd tot Karel de Grote. Eerste UNESCO-site Duitsland.",bronnen:["https://centre-charlemagne.eu/zeitreise/?lang=en","http://www.aquaegranni.de/","https://de.wikipedia.org/wiki/Aquae_Granni"]},Hazerswoude:{naam:"Hazerswoude-Rijndijk",type:"wachttoren",periode:"2e - 3e eeuw n.Chr.",beschrijving:"Bevestigde Romeinse wachtpost langs de Limesweg bij Hazerswoude-Rijndijk. Bij opgravingen in 2021-2023 door Vestigia BV en het Rijksmuseum van Oudheden zijn spectaculaire vondsten gedaan: resten van de houten Limesweg (eiken palen uit 124-125 n.Chr.), een Romeinse dam, en aanwijzingen voor een kleine wachtpost. Bijzondere vondsten: de eerste Romeinse mijlpaal in Nederland (2023), een muntschat met 22 zilveren munten (na 166 n.Chr.), aardewerk, mantelspelden, leren schoenzolen en ca. 40.000-50.000 objecten. De locatie ligt precies tussen Albaniana (Alphen) en Matilo (Leiden).",watWasHier:"Wachtpost langs de Limesweg. Houten wegdek uit 124-125 n.Chr.",watTeZien:"Opgravingen afgerond. Vondsten naar Rijksmuseum van Oudheden.",verwachteVondsten:"Militaria, munten, aardewerk. Gebied grotendeels onderzocht.",betekenis:"Eerste Romeinse mijlpaal in Nederland. Bevestigt trac Limesweg.",bronnen:["https://www.rmo.nl/onderzoek/opgravingsprojecten/hazerswoude/","https://www.vestigia.nl/opgraving-hazerswoude-in-samenwerking-met-het-rijksmuseum-van-oudheden-en-de-gemeente-alphen-aan-den-rijn/","https://romeinsalphen.nl/themas/romeinse-weg-hazerswoude-rijndijk"]},Albaniana:{naam:"Albaniana",latinNaam:"Albaniana",type:"castellum",periode:"41 - 275 n.Chr.",beschrijving:"Groot Romeins castellum bij Alphen aan den Rijn, een van de belangrijkste forten aan de Nederlandse Limes. Het fort werd gesticht in 41-42 n.Chr., kort na de dood van keizer Caligula. De locatie is nauwkeurig bekend: bij het Rijnplein en Theater Castellum aan de Castellumstraat. Het fort (80x120m) was beschermd door een omgrachte aarden wal. Bij opgravingen tussen 1950 en 2002 zijn uitgebreide resten gevonden. Door de natte bodem zijn veel houten structuren bewaard gebleven. Een bronzen maquette van het castellum staat op het Rijnplein.",watWasHier:"Castellum met vicus. Locatie bekend: Rijnplein/Castellumstraat.",watTeZien:"Bronzen maquette Rijnplein. Theater Castellum op fortlocatie. Archeon.",verwachteVondsten:"Munten, militaria, aardewerk, dakpannen, fibulae. Veel bij bouwwerkzaamheden.",betekenis:"Een van de hoofdforten aan de Limes. UNESCO Werelderfgoed.",bronnen:["https://www.hierisalphen.nl/home/ontdekken/romeinse-limes","https://www.romeinen.nl/weten/nederland-in-de-romeinse-tijd/zuid-holland/alphen-aan-den-rijn","https://archeologiehuiszuidholland.nl/zien-en-doen/het-archeologiehuis/fort-aan-de-rijn"]}},XTe={naam:"Romeins fort",type:"versterking",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeinse militaire versterking langs de Limes, de noordgrens van het Romeinse Rijk. Forten lagen om de 10-15 km langs de Rijn. Garnizoen van hulptroepen (auxilia) die de grens bewaakten tegen Germaanse invallen. Standaard rechthoekige plattegrond met houten of stenen muur, gracht, poorten en binnengebouwen (barakken, commandopost, graanopslagplaats, werkplaatsen). Buiten de muren vaak een vicus (burgerdorp) met handelaren en soldatenfamilies. Vondsten: munten, fibulae (mantelspelden), aardewerk, wapens, gereedschap. Onderdeel van UNESCO Werelderfgoed sinds 2021."},qTe={castellum:"Castellum (legerplaats)",wachttoren:"Wachttoren (signaalpost)",vlootbasis:"Vlootbasis (haven)",legerkamp:"Legerkamp (castra)",minifort:"Minifort (wachtpost)",versterking:"Versterking",villa:"Villa (militair gebruikt)"};Tn.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs");function YTe(n){if(!n)return n;const e={Mo:"ma",Tu:"di",We:"wo",Th:"do",Fr:"vr",Sa:"za",Su:"zo",Mon:"ma",Tue:"di",Wed:"wo",Thu:"do",Fri:"vr",Sat:"za",Sun:"zo",PH:"feestdagen",SH:"schoolvakantie"};let t=n;return Object.entries(e).forEach(([r,i])=>{t=t.replace(new RegExp(`\\b${r}\\b`,"gi"),i)}),t=t.replace(/\boff\b/gi,"gesloten").replace(/\bclosed\b/gi,"gesloten").replace(/\bopen\b/gi,"open"),t}async function ZTe(n){try{const e=En(n),t=Tn("EPSG:4326","EPSG:28992",e);if(t[0]<7e3||t[0]>3e5||t[1]<289e3||t[1]>629e3)return null;const r=1,s=`https://service.pdok.nl/rws/ahn/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=dtm_05m&QUERY_LAYERS=dtm_05m&INFO_FORMAT=application/json&CRS=EPSG:28992&BBOX=${`${t[0]-r},${t[1]-r},${t[0]+r},${t[1]+r}`}&WIDTH=1&HEIGHT=1&I=0&J=0`,o=await(await fetch(s)).json();if(o.features&&o.features.length>0){const l=o.features[0].properties,c=l?.value_list??l?.GRAY_INDEX??l?.value??l?.gray_index;if(c!=null){const h=typeof c=="number"?c:parseFloat(c);if(!isNaN(h))return h}}}catch(e){console.warn("AHN height query failed:",e)}return null}const JTe={ABG:"Alphen-Chaam",ACM:"Alkmaar",ALF:"Alfen",ALK:"Alkemade",AML:"Ameland",AMR:"Amerongen",AMS:"Amsterdam",ANL:"Anloo",APD:"Apeldoorn",ARN:"Arnhem",ASN:"Assen",AVW:"Avenhorn",BDA:"Breda",BLK:"Blokker",BRN:"Barneveld",DEL:"Delft",DHG:"Den Haag",DRD:"Dordrecht",EHV:"Eindhoven",EMN:"Emmen",EPE:"Epe",GNP:"Gennep",GRN:"Groningen",GRV:"Grave",GTB:"Giethoorn",HDK:"Harderwijk",HLM:"Haarlem",HLN:"Heiloo",HRL:"Harlingen",HTN:"Houten",LDN:"Leiden",LWR:"Leeuwarden",MST:"Maastricht",NKK:"Nijkerk",NMG:"Nijmegen",OTM:"Ootmarsum",RTD:"Rotterdam",SND:"Sneek",TBG:"Tilburg",UTR:"Utrecht",VLO:"Venlo",WGN:"Wageningen",ZWL:"Zwolle",ZTP:"Zutphen",444:"Houten",811:"Gouda",310:"Utrecht",344:"Amsterdam",363:"Rotterdam",518:"Den Haag",758:"Eindhoven",772:"Tilburg",855:"Breda",85:"Arnhem",268:"Nijmegen",14:"Groningen",80:"Leeuwarden",995:"Maastricht",106:"Enschede",153:"Zwolle",34:"Almere"},QTe={1:"Zeer lage trefkans op archeologische resten",2:"Lage trefkans op archeologische resten",3:"Middelhoge trefkans op archeologische resten",4:"Hoge trefkans op archeologische resten",5:"Lage trefkans (water)",6:"Middelhoge trefkans (water)",7:"Hoge trefkans (water)",8:"Water",9:"Niet gekarteerd"};function hD(n,e){const t=[],r=n.toLowerCase(),i=(e||"").toLowerCase();return r.includes("kalkhoudend")||i.endsWith("a")?t.push("Kalkhoudend = goede metaalconservering"):(r.includes("kalkarm")||r.includes("kalkloos"))&&t.push("Kalkarm = meer corrosie op metalen"),r.includes("poldervaag")?t.push("Poldervaaggrond = jonge rivierklei, ingepolderd gebied"):r.includes("enkeerdgrond")||r.includes("enk")?t.push("Enkeerdgrond = oude akkers met plaggenbemesting - archeologisch interessant!"):r.includes("podzol")?t.push("Podzolgrond = uitgeloogde zandgrond, vaak zuur"):(r.includes("veengrond")||r.includes("veen"))&&t.push("Veengrond = zuur, slechte metaalconservering (tenzij waterverzadigd)"),r.includes("zware klei")?t.push("Zware klei = moeilijk graven, goede conservering"):r.includes("lichte klei")||r.includes("zavel")?t.push("Zavel/lichte klei = redelijk te graven"):r.includes("zand")&&!r.includes("zavel")&&t.push("Zandgrond = makkelijk graven"),r.includes("rivierklei")||i.startsWith("r")?t.push("Rivierafzetting"):(r.includes("zeeklei")||i.startsWith("m"))&&t.push("Zeekleiafzetting"),t}function eSe(){const n=pi(_t=>_t.map),e=cl(_t=>_t.removeVondst),t=cl(_t=>_t.updateVondst),r=cl(_t=>_t.vondsten),{layers:i,addPoint:s,addLayer:a}=hs(),[o,l]=X.useState([]),[c,h]=X.useState(0),[f,m]=X.useState(!1),[y,x]=X.useState(null),[_,w]=X.useState(!1),[S,b]=X.useState(!1),[R,M]=X.useState(null),[O,G]=X.useState(null),[A,I]=X.useState(null),[P,D]=X.useState(null),[L,U]=X.useState(!1),[j,Ee]=X.useState(null),[ke,Be]=X.useState(null),[Me,ce]=X.useState(null),[Pe,be]=X.useState(!1),[se,V]=X.useState(""),[Z,te]=X.useState([]),ie=Z[c]||null,[ue,Ve]=X.useState(()=>{const _t=localStorage.getItem("popupTextScale");return _t?parseInt(_t):100}),[Ge,ye]=X.useState("half"),pe=_t=>{Ve(_t),localStorage.setItem("popupTextScale",_t.toString())},Fe=o[c]||"",wt=o.length>1,jt=_t=>{const pn=_t.match(/<strong[^>]*>(.*?)<\/strong>/);if(pn){const Rn=pn[1].replace(/<[^>]+>/g,""),Tt=_t.replace(pn[0],"").replace(/^(<br\s*\/?>)+/,"");return{title:Rn,contentWithoutTitle:Tt}}return{title:"",contentWithoutTitle:_t}},Dt=_t=>_t.replace(/class="([^"]*)"/g,(Rn,Tt)=>{if(Tt.includes("text-xs")){const sn=Tt.replace(/\btext-xs\b/g,"").trim();return sn?`style="font-size:0.857em" class="${sn}"`:'style="font-size:0.857em"'}if(Tt.includes("text-sm")){const sn=Tt.replace(/\btext-sm\b/g,"").trim();return sn?`class="${sn}"`:""}return Rn}).replace(/class=""/g,""),{title:Kt,contentWithoutTitle:Qt}=jt(Fe),ot=Dt(Qt),tr=Fe.includes("Landbouwperceel"),hn=Fe.includes("data-vondst-id="),cn=()=>{h(_t=>(_t-1+o.length)%o.length)},sr=()=>{h(_t=>(_t+1)%o.length)},Ni=async()=>{if(console.log(" HOOGTEKAART KNOP GEKLIKT"),console.log(" parcelCoordinate uit state:",y),!n||!y||S){console.log(" STOP - map:",!!n,"coord:",y,"loading:",S);return}console.log(` DOORGEVEN AAN showParcelHeightMap: [${y[0]}, ${y[1]}]`),b(!0);try{await r1e(n,y)&&w(!0)}catch(_t){console.error("Failed to load height map:",_t)}finally{b(!1)}},Vn=()=>{n&&(KR(n),w(!1))};X.useEffect(()=>{if(!n)return;const _t=Tt=>{let sn='<strong class="text-purple-800">AMK Monument</strong>';if(Tt.toponiem&&(sn+=`<br/><span class="text-sm font-semibold">${Tt.toponiem}</span>`),Tt.kwaliteitswaarde&&(sn+=`<br/><span class="text-sm text-purple-700">${Tt.kwaliteitswaarde}</span>`),Tt.omschrijving&&(sn+=`<br/><span class="text-xs text-gray-600 mt-1 block">${Tt.omschrijving}</span>`),Tt.txt_label){const Nt=Tt.txt_label.split(", ").slice(0,3).join(", ");sn+=`<br/><span class="text-xs text-gray-500 italic">${Nt}${Tt.txt_label.split(", ").length>3?"...":""}</span>`}return sn},pn=async(Tt,sn)=>{const Nt=[],qi=n.getLayers().getArray().filter(Nr=>Nr instanceof Sh&&Nr.getVisible()?Nr.getSource()instanceof $X:!1);for(const Nr of qi){const li=Nr.getSource();if(!li)continue;const nn=Nr.get("title")||"";if(nn.startsWith("Paleokaart"))continue;if(nn==="Archeo Landschappen"){try{const De=En(Tt),xe=Tn("EPSG:4326","EPSG:28992",De),_e=100,N=`https://services.rce.geovoorziening.nl/landschappenkaart/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=landschappenkaart_nl&QUERY_LAYERS=landschappenkaart_nl&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-_e},${xe[1]-_e},${xe[0]+_e},${xe[1]+_e}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const re=W.features[0].properties,ee=re.landschapsnaam||re.naam||"Archeologisch Landschap",ne=re.omschrijving||"";let he=`<strong class="text-green-800">${ee}</strong>`;ne&&(he+=`<br/><span class="text-sm text-gray-600">${ne}</span>`),he+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',he+='<div class="text-sm text-gray-700 mt-1">Een archeologisch landschap is een gebied waar het landschap nog sporen draagt van menselijke activiteit uit het verleden. Denk aan oude akkers, nederzettingen of verdedigingswerken.</div>',he+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',he+='<div class="text-sm text-gray-700 mt-1">Aardewerk, munten, gereedschap en andere voorwerpen van vroegere bewoners. De kans op vondsten hangt af van het type landschap.</div>',he+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',he+='<div class="text-sm text-gray-700 mt-1"><a href="https://www.cultureelerfgoed.nl/onderwerpen/bronnen-en-kaarten/overzicht/landschappenkaart" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">RCE Landschappenkaart</a></div>',he+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Landschapstypen_van_Nederland" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia: Landschapstypen</a></div>',Nt.push(he)}}catch(De){console.warn("Archeo Landschappen WMS query failed:",De)}continue}if(nn==="Essen"){try{const De=En(Tt),xe=Tn("EPSG:4326","EPSG:28992",De),_e=100,N=`https://services.rce.geovoorziening.nl/landschapsatlas/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=essen&QUERY_LAYERS=essen&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-_e},${xe[1]-_e},${xe[0]+_e},${xe[1]+_e}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const re=W.features[0].properties;let ee='<strong class="text-amber-800">Es (historisch akkercomplex)</strong>';(re.naam||re.Naam||re.NAME)&&(ee+=`<br/><span class="text-sm font-semibold text-amber-700">${re.naam||re.Naam||re.NAME}</span>`),(re.type||re.Type||re.TYPE)&&(ee+=`<br/><span class="text-xs text-gray-600">${re.type||re.Type||re.TYPE}</span>`),(re.omschrijving||re.Omschrijving)&&(ee+=`<br/><span class="text-xs text-gray-500">${re.omschrijving||re.Omschrijving}</span>`),ee+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is een es?</span></div>',ee+='<div class="text-sm text-gray-700 mt-1">Een es is een oud akkercomplex op hogere zandgronden. Eeuwenlang werden hier gewassen verbouwd. De bodem werd bemest met plaggen en mest, waardoor de grond donker en vruchtbaar werd.</div>',ee+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',ee+='<div class="text-sm text-gray-700 mt-1">Munten, gespen, knopen, aardewerk en soms bijzondere voorwerpen die door bemesting op het land terechtkwamen. Essen behoren tot de beste vindplaatsen voor metaaldetectie.</div>',ee+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Conservering</span></div>',ee+='<div class="text-sm text-gray-700 mt-1 italic">De zure zandgrond tast metaal aan. IJzer en koper zijn vaak slecht bewaard. Zilver en brons houden zich beter.</div>',ee+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',ee+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Es_(geografie)" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia: Es (geografie)</a></div>',Nt.push(ee)}}catch(De){console.warn("Essen WMS query failed:",De)}continue}if(nn==="FAMKE Steentijd"){try{const De=En(Tt),xe=Tn("EPSG:4326","EPSG:28992",De),_e=`https://geoportaal.fryslan.nl/arcgis/rest/services/Themas/cultuurhistorie/MapServer/2/query?geometry=${xe[0]},${xe[1]}&geometryType=esriGeometryPoint&spatialRel=esriSpatialRelIntersects&outFields=BESCHR,BESCHRTOELICHTING,BESCHRLINK&returnGeometry=false&f=json`,N=await(await fetch(_e)).json();if(N.features&&N.features.length>0){const ut=N.features[0].attributes;let W='<strong class="text-amber-800">FAMKE Steentijd-Bronstijd</strong>';W+='<br/><span class="text-sm text-gray-500">Friese verwachtingskaart</span>';const re=ut.BESCHR||"";re&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Advies</span></div>',W+=`<div class="text-sm text-amber-700 mt-1 font-medium">${re}</div>`);const ee=ut.BESCHRTOELICHTING||"";ee&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Toelichting</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${ee}</div>`);const ne=ut.BESCHRLINK||"";ne&&(W+=`<div class="mt-3"><a href="${ne}" target="_blank" rel="noopener noreferrer" class="text-sm text-blue-600 hover:underline">Meer informatie</a></div>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is FAMKE?</span></div>',W+='<div class="text-sm text-gray-700 mt-1">FAMKE is de Friese Archeologische Monumentenkaart Extra. Deze kaart toont waar in Friesland vondsten uit de steentijd en bronstijd te verwachten zijn.</div>',Nt.push(W)}}catch(De){console.warn("FAMKE Steentijd query failed:",De)}continue}if(nn==="FAMKE IJzertijd"){try{const De=En(Tt),xe=Tn("EPSG:4326","EPSG:28992",De),_e=`https://geoportaal.fryslan.nl/arcgis/rest/services/Themas/cultuurhistorie/MapServer/1/query?geometry=${xe[0]},${xe[1]}&geometryType=esriGeometryPoint&spatialRel=esriSpatialRelIntersects&outFields=BESCHR,BESCHRTOELICHTING,BESCHRLINK&returnGeometry=false&f=json`,N=await(await fetch(_e)).json();if(N.features&&N.features.length>0){const ut=N.features[0].attributes;let W='<strong class="text-orange-800">FAMKE IJzertijd-Middeleeuwen</strong>';W+='<br/><span class="text-sm text-gray-500">Friese verwachtingskaart</span>';const re=ut.BESCHR||"";re&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Advies</span></div>',W+=`<div class="text-sm text-orange-700 mt-1 font-medium">${re}</div>`);const ee=ut.BESCHRTOELICHTING||"";ee&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Toelichting</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${ee}</div>`);const ne=ut.BESCHRLINK||"";ne&&(W+=`<div class="mt-3"><a href="${ne}" target="_blank" rel="noopener noreferrer" class="text-sm text-blue-600 hover:underline">Meer informatie</a></div>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is FAMKE?</span></div>',W+='<div class="text-sm text-gray-700 mt-1">FAMKE is de Friese Archeologische Monumentenkaart Extra. Deze kaart toont waar in Friesland vondsten uit de ijzertijd tot en met de middeleeuwen te verwachten zijn.</div>',Nt.push(W)}}catch(De){console.warn("FAMKE IJzertijd query failed:",De)}continue}if(nn==="Archeo Onderzoeken"){try{const De=En(Tt),xe=Tn("EPSG:4326","EPSG:28992",De),_e=100,N=`https://data.geo.cultureelerfgoed.nl/openbaar/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=archeologische_onderzoeksmeldingen_openbaar_rd&QUERY_LAYERS=archeologische_onderzoeksmeldingen_openbaar_rd&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-_e},${xe[1]-_e},${xe[0]+_e},${xe[1]+_e}`}&FEATURE_COUNT=20`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0)for(const re of W.features){const ee=re.properties,ne=ee.type_onderzoek||"",he=ee.projectnaam||ee.project_naam||ee.naam||"",Ce=he&&he!=="-"&&he.trim()!==""&&!/^\d+$/.test(he.trim())?he:"",je=ee.gemeente||"",He=ee.uitvoerder||"",Je=ee.onderzoeksmeldingnummer||"",Qe=ee.adres||ee.straat||"";let xt="Archeologisch Onderzoek";Ce?xt=Ce:je&&Qe?xt=`${je} - ${Qe}`:je&&(xt=`Onderzoek ${je}`);let St=`<strong class="text-blue-800">${xt}</strong>`;if(ne&&(St+=`<br/><span class="text-sm font-semibold text-blue-700">${ne}</span>`),je&&!xt.includes(je)&&(St+=`<br/><span class="text-sm text-gray-700">${je}</span>`),Qe&&!xt.includes(Qe)&&(St+=`<br/><span class="text-sm text-gray-600">${Qe}</span>`),Je&&(St+=`<br/><span class="text-xs text-gray-500 font-mono">OM: ${Je}</span>`),He&&(St+=`<br/><span class="text-sm text-gray-700">Uitvoerder: ${He}</span>`),ee.startdatum||ee.einddatum){const Y=[ee.startdatum,ee.einddatum].filter(Boolean).join(" - ");St+=`<br/><span class="text-xs text-gray-600">Periode: ${Y}</span>`}const An=[];ee.periode_paleolithicum&&An.push("Paleolithicum"),ee.periode_mesolithicum&&An.push("Mesolithicum"),ee.periode_neolithicum&&An.push("Neolithicum"),ee.periode_bronstijd&&An.push("Bronstijd"),ee.periode_ijzertijd&&An.push("IJzertijd"),ee.periode_romeins&&An.push("Romeins"),ee.periode_middeleeuwen&&An.push("Middeleeuwen"),ee.periode_nieuwe_tijd&&An.push("Nieuwe tijd"),An.length>0&&(St+=`<br/><span class="text-sm text-purple-700">Datering: ${An.join(", ")}</span>`),St+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat betekent dit?</span></div>',ne.toLowerCase().includes("opgraving")?St+='<div class="text-sm text-gray-700 mt-1">Hier is een archeologische opgraving gedaan. Professionele archeologen hebben vondsten en sporen gedocumenteerd en geborgen.</div>':ne.toLowerCase().includes("bureauonderzoek")?St+='<div class="text-sm text-gray-700 mt-1">Een bureauonderzoek naar de archeologische verwachting op basis van historische bronnen en kaarten.</div>':ne.toLowerCase().includes("booronderzoek")?St+='<div class="text-sm text-gray-700 mt-1">Met boringen is onderzocht wat er in de grond zit. Vaak de eerste stap om te bepalen of er verder onderzoek nodig is.</div>':ne.toLowerCase().includes("proefsleuven")?St+='<div class="text-sm text-gray-700 mt-1">Proefsleuven zijn gegraven om te kijken of er archeologische sporen in de grond zitten.</div>':ne.toLowerCase().includes("begeleiding")?St+='<div class="text-sm text-gray-700 mt-1">Archeologische begeleiding bij graafwerk. Een archeoloog was aanwezig om te controleren of er vondsten naar boven kwamen.</div>':ne.toLowerCase().includes("inventariserend")||ne.toLowerCase().includes("karterend")?St+='<div class="text-sm text-gray-700 mt-1">Verkennend onderzoek om te bepalen of er archeologische resten in de grond kunnen zitten.</div>':St+='<div class="text-sm text-gray-700 mt-1">Op deze locatie is archeologisch onderzoek uitgevoerd. De resultaten zijn opgeslagen in het landelijke archief.</div>',St+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Interessant voor detectie?</span></div>',St+='<div class="text-sm text-gray-700 mt-1 italic">Onderzoekslocaties kunnen interessant zijn: archeologen vinden vaak niet alles. Maar check altijd eerst of je daar mag zoeken.</div>',St+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Rapport opzoeken</span></div>';let B="";if(Ce?B=Ce:He&&je?B=`${He} ${je}`:je&&(B=je),B){const Y=B.length>35?B.substring(0,35)+"...":B;St+=`<div class="text-sm text-gray-700 mt-1"><a href="https://archaeology.datastations.nl/dataverse/root?q=${encodeURIComponent(B)}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Zoek "${Y}" in DANS</a></div>`,St+=`<div class="text-sm text-gray-700 mt-1"><a href="https://scholar.google.nl/scholar?q=${encodeURIComponent(B+" archeologisch rapport")}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Zoek in Google Scholar</a></div>`}Je&&(St+=`<div class="text-sm text-gray-700 mt-1"><a href="https://archis.cultureelerfgoed.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Zoek OM ${Je} in ARCHIS</a> <span class="text-xs text-gray-400">(account nodig)</span></div>`),Nt.push(St)}}catch(De){console.warn("Archeo Onderzoeken WMS query failed:",De)}continue}if(nn==="IKAW"){try{const De=En(Tt),xe=Tn("EPSG:4326","EPSG:28992",De),_e=500,N=`https://services.rce.geovoorziening.nl/ikaw/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=IKAW3Indicatievekaartarcheologischewaarden2008&QUERY_LAYERS=IKAW3Indicatievekaartarcheologischewaarden2008&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-_e},${xe[1]-_e},${xe[0]+_e},${xe[1]+_e}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const re=W.features[0].properties,ee=Math.round(re.PALETTE_INDEX||re.palette_index||0),ne=QTe[ee]||`Trefkans onbekend (${ee})`;let he='<strong class="text-orange-800">IKAW Verwachtingskaart</strong>';he+='<br/><span class="text-sm text-gray-500">Kaart met kansen op archeologische vondsten</span>',he+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat betekent dit?</span></div>',he+=`<div class="text-sm text-orange-700 mt-1">${ne}</div>`;const je={1:{tekst:"De kans op archeologische vondsten is hier zeer klein. De grond is waarschijnlijk verstoord of te jong.",vondsten:"Niet veel te verwachten, maar verrassingen zijn altijd mogelijk.",kleur:"text-gray-600"},2:{tekst:"De kans op vondsten is laag, maar niet uitgesloten. Soms worden hier toch interessante objecten gevonden.",vondsten:"Af en toe losse vondsten uit verschillende periodes.",kleur:"text-yellow-600"},3:{tekst:"Dit is een interessant gebied met een redelijke kans op vondsten. Hier woonden of werkten mensen in het verleden.",vondsten:"Aardewerk, munten, metalen voorwerpen uit verschillende tijdperken.",kleur:"text-amber-600"},4:{tekst:"Dit is een zeer kansrijk gebied! Hier zijn waarschijnlijk resten van oude bewoning of activiteit. Let op: bij graafwerk kan een vergunning nodig zijn.",vondsten:"Grote kans op interessante vondsten: aardewerk, munten, sieraden, gereedschap.",kleur:"text-orange-600"},5:{tekst:"Dit is een waterbodem. Vondsten zijn hier moeilijker te bereiken maar kunnen goed bewaard zijn gebleven.",vondsten:"Scheepswrakken, verloren lading, gedumpte voorwerpen.",kleur:"text-blue-600"},6:{tekst:"Waterbodem met archeologische potentie. Hier kunnen interessante vondsten liggen die door het water goed bewaard zijn.",vondsten:"Scheepsresten, ankers, aardewerk, metalen voorwerpen.",kleur:"text-blue-600"},7:{tekst:"Waterbodem met hoge archeologische waarde. Hier zijn bekende vindplaatsen of scheepswrakken.",vondsten:"Belangrijke maritieme vondsten, beschermd gebied.",kleur:"text-blue-700"}}[ee];je&&(he+=`<div class="text-sm ${je.kleur} mt-1">${je.tekst}</div>`,he+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',he+=`<div class="text-sm text-gray-700 mt-1">${je.vondsten}</div>`),he+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is de IKAW?</span></div>',he+='<div class="text-sm text-gray-700 mt-1">De IKAW (Indicatieve Kaart Archeologische Waarden) toont de kans op archeologische vondsten in heel Nederland. De kaart is gemaakt door de Rijksdienst voor het Cultureel Erfgoed.</div>',Nt.push(he)}}catch(De){console.warn("IKAW WMS query failed:",De)}continue}if(nn==="Inundatiegebieden"){try{const De=En(Tt),xe=Tn("EPSG:4326","EPSG:28992",De),_e=100,N=`https://services.rce.geovoorziening.nl/liniesenstellingen/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=inundaties&QUERY_LAYERS=inundaties&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-_e},${xe[1]-_e},${xe[0]+_e},${xe[1]+_e}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const re=W.features[0].properties;let ee='<strong class="text-blue-800">Inundatiegebied</strong>';(re["linie-naam"]||re.linie_naam)&&(ee+=`<br/><span class="text-sm font-semibold text-blue-700">${re["linie-naam"]||re.linie_naam}</span>`),re.naam&&(ee+=`<br/><span class="text-sm text-gray-700">${re.naam}</span>`),re.periode&&(ee+=`<br/><span class="text-xs text-gray-500">${re.periode}</span>`),re.lin_period&&(ee+=`<br/><span class="text-xs text-gray-400">${re.lin_period}</span>`),Nt.push(ee)}}catch(De){console.warn("Inundatiegebieden WMS query failed:",De)}continue}if(nn==="Militaire Objecten"){try{const De=En(Tt),xe=Tn("EPSG:4326","EPSG:28992",De),_e=50,N=`https://services.rce.geovoorziening.nl/liniesenstellingen/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=objecten&QUERY_LAYERS=objecten&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-_e},${xe[1]-_e},${xe[0]+_e},${xe[1]+_e}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const re=W.features[0].properties,ee=re.obj_soort||"",ne=re.obj_naam||"",he=re.lin_period||"",Ce=re["linie-naam"]||re.linie_naam||"";let je=ee||"Militair Object",He="Dit is een historisch militair object uit de Nederlandse verdedigingsgeschiedenis.",Je="";const Qe=ee.toLowerCase();Qe.includes("fort")?(He="Een fort is een versterkte verdedigingspost, vaak met dikke muren en geschutsopstellingen. Forten maakten deel uit van grotere verdedigingslinies.",Je="Rond forten worden soms kogels, knopen van uniformen, muntjes of andere militaire voorwerpen gevonden."):Qe.includes("schans")?(He="Een schans is een kleinere versterking, vaak gemaakt van aarde en palissaden. Schansen werden gebruikt om strategische punten te verdedigen.",Je="Bij schansen kun je musketkogels, knopen en soms munten uit de 17e-18e eeuw tegenkomen."):Qe.includes("batterij")||Qe.includes("battery")?(He="Een batterij is een geschutsopstelling, vaak op een strategische plek om vijanden onder vuur te nemen.",Je="Bij batterijen worden soms kanonkogels of onderdelen van geschut gevonden."):Qe.includes("bunker")||Qe.includes("kazemat")?(He="Een bunker of kazemat is een versterkte betonnen schuilplaats. Veel werden gebouwd rond 1940 als onderdeel van verdedigingslinies.",Je="Bij bunkers worden soms militaire voorwerpen uit WOII gevonden, zoals knopen, gespen of munitieresten."):Qe.includes("sluis")||Qe.includes("inlaatwerk")?(He="Militaire sluizen en inlaatwerken werden gebruikt om land onder water te zetten (inunderen). Dit was een belangrijke verdedigingstactiek.",Je="Bij historische sluizen worden soms voorwerpen gevonden van soldaten die deze bewaakten."):Qe.includes("toren")||Qe.includes("wachttoren")?(He="Wachttorens werden gebruikt om de omgeving in de gaten te houden en vijandelijke bewegingen te signaleren.",Je="Bij torens worden soms persoonlijke voorwerpen van soldaten gevonden."):Qe.includes("kazerne")&&(He="Een kazerne is een gebouw waar soldaten gelegerd waren. Hier woonden, aten en oefenden de troepen.",Je="Rond kazernes worden regelmatig knopen, gespen en andere persoonlijke voorwerpen gevonden.");let xt=`<strong class="text-stone-800">${je}</strong>`;ne&&(xt+=`<br/><span class="text-sm font-semibold text-stone-700">${ne}</span>`),Ce&&(xt+=`<br/><span class="text-sm text-blue-600">${Ce}</span>`),he&&(xt+=`<br/><span class="text-xs text-gray-500">${he}</span>`),xt+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',xt+=`<div class="text-sm text-gray-700 mt-1">${He}</div>`,Je&&(xt+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',xt+=`<div class="text-sm text-gray-700 mt-1">${Je}</div>`),xt+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',xt+='<div class="text-sm text-gray-700 mt-1">',xt+='<a href="https://erfgoedenlocatie.nl/linies-en-stellingen" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">RCE Linies en Stellingen</a>',xt+="</div>",Nt.push(xt)}}catch(De){console.warn("Militaire Objecten WMS query failed:",De)}continue}if(nn==="Verdedigingslinies"){try{const De=En(Tt),xe=Tn("EPSG:4326","EPSG:28992",De),_e=100,N=`https://services.rce.geovoorziening.nl/liniesenstellingen/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=linies&QUERY_LAYERS=linies&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-_e},${xe[1]-_e},${xe[0]+_e},${xe[1]+_e}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const re=W.features[0].properties;let ee='<strong class="text-amber-800">Verdedigingslinie</strong>';const ne={"Hollandse Waterlinie":"Verdedigingsstelsel (1815-1940) dat gebruik maakte van inundaties om Holland te beschermen. UNESCO Werelderfgoed.","Nieuwe Hollandse Waterlinie":"Uitgebreide versie (1815-1940) met forten en inundatiegebieden van Muiden tot Gorinchem.","Stelling van Amsterdam":"Ringverdediging rond Amsterdam (1880-1920) met 42 forten. UNESCO Werelderfgoed.",Grebbelinie:"Verdedigingslinie langs de Grebbe (17e-20e eeuw). Zware gevechten in mei 1940.",IJssellinie:"Koude Oorlog verdediging (1950-1968) langs de IJssel tegen Sovjet-invasie.",Atlantikwall:"Duitse kustverdediging WOII (1942-1945) van Noorwegen tot Spanje.","Peel-Raamstelling":"Verdedigingslinie in Brabant/Limburg. Gevechten mei 1940.","Maas-Waalstelling":"Linie tussen Maas en Waal, onderdeel landsverdediging.",Zuiderwaterlinie:"Waterlinie in West-Brabant en Zeeland (17e-19e eeuw).","Staats-Spaanse Linies":"Vestingwerken uit de 80-jarige oorlog (1568-1648)."},he=re.naam||re.lin_naam||"";if(he){ee+=`<br/><span class="text-sm font-semibold text-amber-700">${he}</span>`;const Ce=Object.entries(ne).find(([je])=>he.toLowerCase().includes(je.toLowerCase())||je.toLowerCase().includes(he.toLowerCase()));Ce&&(ee+=`<br/><span class="text-sm text-gray-700">${Ce[1]}</span>`)}re.lin_period&&(ee+=`<br/><span class="text-xs text-purple-600">${re.lin_period}</span>`),re.status&&(ee+=`<br/><span class="text-xs text-gray-400">${re.status}</span>`),Nt.push(ee)}}catch(De){console.warn("Verdedigingslinies WMS query failed:",De)}continue}if(nn==="Rijksmonumenten"){try{const De=En(Tt),xe=Tn("EPSG:4326","EPSG:28992",De),_e=50,N=`https://data.geo.cultureelerfgoed.nl/openbaar/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=rijksmonumentpunten&QUERY_LAYERS=rijksmonumentpunten&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-_e},${xe[1]-_e},${xe[0]+_e},${xe[1]+_e}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const re=W.features[0].properties;let ee='<strong class="text-red-800">Rijksmonument</strong>';(re.cbsNaam||re.cbs_naam)&&(ee+=`<br/><span class="text-sm font-semibold">${re.cbsNaam||re.cbs_naam}</span>`),re.hoofdcategorie&&(ee+=`<br/><span class="text-sm text-red-700">${re.hoofdcategorie}</span>`),re.subcategorie&&(ee+=`<br/><span class="text-xs text-gray-600">${re.subcategorie}</span>`),re.rijksmonumentnummer&&(ee+=`<br/><span class="text-xs text-gray-500">Nr: ${re.rijksmonumentnummer}</span>`),(re.bouwjaar||re.oorspronkelijkebouwjaar)&&(ee+=`<br/><span class="text-xs text-gray-500">Bouwjaar: ${re.bouwjaar||re.oorspronkelijkebouwjaar}</span>`),ee+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',re.rijksmonumentnummer&&(ee+=`<div class="text-sm text-gray-700 mt-1"><a href="https://monumentenregister.cultureelerfgoed.nl/monumenten/${re.rijksmonumentnummer}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Bekijk in Monumentenregister</a></div>`),ee+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Rijksmonument" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia: Rijksmonument</a></div>',Nt.push(ee)}}catch(De){console.warn("Rijksmonumenten WMS query failed:",De)}continue}if(nn==="Werelderfgoed"){try{const De=En(Tt),xe=Tn("EPSG:4326","EPSG:28992",De),_e=500,N=`https://service.pdok.nl/rce/ps-ch/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=PS.ProtectedSite&QUERY_LAYERS=PS.ProtectedSite&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-_e},${xe[1]-_e},${xe[0]+_e},${xe[1]+_e}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const re=W.features[0].properties;let ee='<strong class="text-cyan-800">UNESCO Werelderfgoed</strong>';(re.siteName||re.naam)&&(ee+=`<br/><span class="text-sm font-semibold text-cyan-700">${re.siteName||re.naam}</span>`),re.siteDesignation&&(ee+=`<br/><span class="text-xs text-gray-600">${re.siteDesignation}</span>`),Nt.push(ee)}}catch(De){console.warn("Werelderfgoed WMS query failed:",De)}continue}if(nn==="Terpen"){try{const De=En(Tt),xe=Tn("EPSG:4326","EPSG:28992",De),_e=`https://geoportaal.fryslan.nl/arcgis/rest/services/ProvinciaalGeoRegister/PGR2/MapServer/66/query?geometry=${xe[0]},${xe[1]}&geometryType=esriGeometryPoint&spatialRel=esriSpatialRelIntersects&outFields=SOORT,SHAPE_Area&returnGeometry=false&f=json`,N=await(await fetch(_e)).json();if(N.features&&N.features.length>0){const ut=N.features[0].attributes,W=ut.SOORT||"Terp",re=ut.SHAPE_Area?Math.round(ut.SHAPE_Area):null;let ee="",ne="",he=!1;try{const xt=`https://service.pdok.nl/rce/ps-ch/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=PS.ProtectedSite&QUERY_LAYERS=PS.ProtectedSite&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-100},${xe[1]-100},${xe[0]+100},${xe[1]+100}`}`,An=await(await fetch(xt)).json();if(An.features&&An.features.length>0){const B=An.features[0].properties;ee=B.siteName||B.naam||"",ne=B.inspireId||B.monumentnummer||"",he=!0}}catch{}let Ce="";ee?(Ce=`<strong class="text-orange-800">${ee}</strong>`,Ce+=`<br/><span class="text-sm text-orange-600 font-medium">${W}</span>`):Ce=`<strong class="text-orange-800">${W}</strong>`,Ce+='<br/><span class="text-sm text-gray-600">Friese terp (woonheuvel)</span>';const He={terp:{uitleg:"Een kunstmatige woonheuvel waar mensen woonden om droge voeten te houden.",periode:"IJzertijd tot Middeleeuwen"},"afgegraven terp":{uitleg:"Deze terp is deels of geheel afgegraven voor de vruchtbare grond (terpaarde).",periode:"Oorspronkelijk IJzertijd-Middeleeuwen"},terprestant:{uitleg:"Hier lag ooit een terp, waarvan nu alleen nog resten over zijn.",periode:"IJzertijd tot Middeleeuwen"},"deels afgegraven terp":{uitleg:"Een deel van deze terp is afgegraven, een deel is nog intact.",periode:"IJzertijd tot Middeleeuwen"},"verhoogd kerkhof":{uitleg:"Een verhoogd kerkhof, vaak op een oude terplocatie gebouwd.",periode:"Middeleeuwen"},kerkterp:{uitleg:"Een terp met daarop een kerk, vaak het centrum van een terpdorp.",periode:"IJzertijd tot heden"}}[W.toLowerCase()]||{uitleg:"Een kunstmatige woonheuvel uit de tijd dat dit gebied vaak overstroomde.",periode:"IJzertijd tot Middeleeuwen"};if(Ce+=`<div class="mt-2 text-sm text-gray-700">${He.uitleg}</div>`,Ce+=`<br/><span class="text-sm text-gray-600">Periode: ${He.periode}</span>`,re&&re>100){const Je=(re/1e4).toFixed(1);Ce+=`<br/><span class="text-sm text-gray-500">Oppervlak: ${Je} hectare</span>`}if(he&&(Ce+='<div class="mt-2 p-2 bg-orange-100 rounded text-xs text-orange-800">',Ce+="<strong> Rijksmonument</strong> - Deze terp is wettelijk beschermd. Detecteren is niet toegestaan zonder vergunning.",ne&&(Ce+=`<br/>Monumentnummer: ${ne}`),Ce+="</div>"),Ce+='<div class="mt-2 p-2 bg-amber-50 rounded text-xs text-amber-800">',Ce+="<strong>Detectietip:</strong> ",W.toLowerCase().includes("afgegraven")?Ce+="Afgegraven terpen zijn interessant! Bij het afgraven kwam materiaal aan de oppervlakte. Zoek op akkers rond de oude terplocatie.":Ce+="Terpen zijn rijk aan vondsten: aardewerk, munten, fibulae, botten, gereedschap. De grond is vaak donker en vruchtbaar door eeuwenlange bewoning.",Ce+="</div>",Ce+='<div class="mt-3 space-y-1">',Ce+='<a href="https://www.terpenonderzoek.nl/" target="_blank" class="block text-blue-600 hover:underline text-sm">Terpenonderzoek.nl - Wetenschappelijk onderzoek</a>',Ce+='<a href="https://www.friesmuseum.nl/collectie/archeologie/" target="_blank" class="block text-blue-600 hover:underline text-sm">Fries Museum - Terpvondsten</a>',Ce+='<a href="https://nl.wikipedia.org/wiki/Terp" target="_blank" class="block text-blue-600 hover:underline text-sm">Wikipedia - Terpen</a>',ee){const Je=encodeURIComponent(ee+" terp friesland");Ce+=`<a href="https://www.google.com/search?q=${Je}" target="_blank" class="block text-blue-600 hover:underline text-sm">Zoek meer over ${ee}</a>`}Ce+="</div>",Nt.push(Ce)}}catch(De){console.warn("Terpen query failed:",De)}continue}if(nn==="Religieus Erfgoed"){try{const De=En(Tt),xe=Tn("EPSG:4326","EPSG:28992",De),_e=50,N=`https://services.rce.geovoorziening.nl/landschapsatlas_view/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=religieuserfgoed&QUERY_LAYERS=religieuserfgoed&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-_e},${xe[1]-_e},${xe[0]+_e},${xe[1]+_e}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const re=W.features[0].properties,ee=re.naam||re.NAAM||re.name||re.NAME||"Onbekend",ne=re.denominatie||re.DENOMINATIE||re.religie||"",he=re.type||re.TYPE||re.functie||"",Ce=re.bouwjaar||re.BOUWJAAR||re.jaar||"",je=re.gemeente||re.GEMEENTE||re.plaats||"";let He=`<strong class="text-purple-800">${ee}</strong>`;const Je=he.toLowerCase();let Qe="Een religieus gebouw of heilige plek.",xt="Munten van kerkgangers, knopen, gespen, religieuze voorwerpen";Je.includes("kerk")||Je.includes("church")?(Qe="Een kerk was het hart van de gemeenschap. Hier kwamen mensen samen voor diensten, maar ook voor belangrijke gebeurtenissen.",xt="Munten uit de collecte, knopen, gespen, pelgrimsinsignes, loden zegels"):Je.includes("kapel")||Je.includes("chapel")?(Qe="Een kapel is een klein gebedshuis, vaak bij een landgoed, langs een weg, of op een bijzondere plek.",xt="Devotionalia, munten, kruisjes, rozenkransen"):Je.includes("synagoge")?(Qe="Een synagoge is een Joods gebedshuis. Veel synagogen in Nederland zijn verwoest of herbestemd na de Tweede Wereldoorlog.",xt="Munten, knopen, kleine religieuze voorwerpen"):Je.includes("klooster")||Je.includes("monastery")?(Qe="Een klooster was een woon- en werkplek voor monniken of nonnen. Veel kloosters hadden eigen werkplaatsen en landerijen.",xt="Religieuze voorwerpen, zegels, gereedschap, aardewerk, middeleeuwse munten"):Je.includes("toren")||Je.includes("tower")?(Qe="Een kerktoren of klokkentoren. Soms is alleen de toren nog over van een verdwenen kerk.",xt="Munten, knopen, bouwmateriaal"):(Je.includes("begraafplaats")||Je.includes("cemetery"))&&(Qe="Een historische begraafplaats. Detecteren op begraafplaatsen is niet toegestaan zonder toestemming.",xt="Detecteren hier niet toegestaan"),ne&&(He+=`<br/><span class="text-sm text-purple-600">${ne}</span>`),he&&(He+=`<br/><span class="text-sm text-gray-600">${he}</span>`),Ce&&(He+=`<br/><span class="text-sm text-gray-500">Bouwjaar: ${Ce}</span>`),je&&(He+=`<br/><span class="text-xs text-gray-400">${je}</span>`),He+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',He+=`<div class="text-sm text-gray-700 mt-1">${Qe}</div>`,He+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',He+=`<div class="text-sm text-gray-700 mt-1">${xt}</div>`,He+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bezoeken</span></div>',Je.includes("begraafplaats")?He+='<div class="text-sm text-red-600 mt-1">Detecteren op begraafplaatsen is niet toegestaan. Respecteer de rust van de overledenen.</div>':He+='<div class="text-sm text-gray-700 mt-1">Veel kerken en religieuze gebouwen zijn beschermd monument. Vraag altijd toestemming voordat je gaat detecteren op het terrein.</div>',Nt.push(He)}}catch(De){console.warn("Religieus Erfgoed WMS query failed:",De)}continue}if(nn==="Gewaspercelen"){try{const De=En(Tt),xe=Tn("EPSG:4326","EPSG:28992",De),_e=50,Ft=`${xe[0]-_e},${xe[1]-_e},${xe[0]+_e},${xe[1]+_e}`,N=`https://service.pdok.nl/rvo/brpgewaspercelen/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=BrpGewas&QUERY_LAYERS=BrpGewas&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${Ft}`,ut=`https://service.pdok.nl/bzk/bro-bodemkaart/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=soilarea&QUERY_LAYERS=soilarea&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${Ft}`,[W,re]=await Promise.all([fetch(N),fetch(ut).catch(()=>null)]),ee=await W.json();if(ee.features&&ee.features.length>0){const ne=ee.features[0].properties;let he='<strong class="text-green-800">Landbouwperceel</strong>';if((ne.gewas||ne.gewasnaam)&&(he+=`<br/><span class="text-sm font-semibold text-green-700">${ne.gewas||ne.gewasnaam}</span>`),(ne.categorie||ne.category)&&(he+=`<br/><span class="text-xs text-gray-600">${ne.categorie||ne.category}</span>`),ne.oppervlakte&&(he+=`<br/><span class="text-xs text-gray-500">${ne.oppervlakte} ha</span>`),re)try{const Ce=await re.json();if(Ce.features&&Ce.features.length>0){const je=Ce.features[0].properties,He=je.first_soilname||je.soilname||je.bodemtype,Je=je.first_soilcode||je.soilcode||je.maparea_soilcode;if(He){he+=`<br/><span class="text-xs text-amber-700 font-medium">Grondsoort: ${He}</span>`;const Qe=hD(He,Je);Qe.length>0&&(he+=`<br/><span class="text-xs text-gray-500 italic">${Qe.join("  ")}</span>`)}}}catch{}Nt.push(he)}}catch(De){console.warn("BRP Gewaspercelen WMS query failed:",De)}continue}if(nn==="Kadastrale Grenzen"){try{const De=En(Tt),xe=Tn("EPSG:4326","EPSG:28992",De),_e=20,N=`https://service.pdok.nl/kadaster/kadastralekaart/wms/v5_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=Perceel&QUERY_LAYERS=Perceel&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-_e},${xe[1]-_e},${xe[0]+_e},${xe[1]+_e}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const re=W.features[0].properties,ee=re.kadastraleGemeenteWaarde||re.kadastrale_gemeente_waarde||re.kadastraleGemeente||JTe[String(re.kadastraleGemeenteCode)]||re.kadastraleGemeenteCode,ne=re.sectie||re.Sectie||"",he=re.perceelnummer||re.perceelNummer||re.Perceelnummer||"",Ce=re.kadastraleGrootteWaarde||re.kadastrale_grootte_waarde||re.kadastraleGrootte||re.oppervlakte,je=re.AKRKadastraleGemeenteCodeWaarde||re.akrKadastraleGemeenteCodeWaarde||"",He=[ee,ne,he].filter(Boolean).join(" "),Je=je&&ne&&he?`${je}-${ne}-${he}`:"";let Qe='<strong class="text-indigo-800">Kadastraal Perceel</strong>';if(He&&(Qe+=`<br/><span class="text-sm text-indigo-700">${He}</span>`),Je&&(Qe+=`<br/><span class="text-sm font-bold text-gray-800 font-mono">${Je}</span>`),Ce){const xt=typeof Ce=="number"?Ce:parseFloat(Ce);isNaN(xt)||(Qe+=`<br/><span class="text-xs text-gray-600">${xt.toLocaleString("nl-NL")} m</span>`)}Qe+='<br/><br/><span class="text-xs text-gray-600">Eigenaar opzoeken? Kopieer bovenstaande code, ga naar </span><a href="https://www.kadaster.nl/winkel" target="_blank" rel="noopener" class="text-xs text-blue-600 hover:underline">kadaster.nl/winkel</a><span class="text-xs text-gray-600"> en klik "Zoek op aanduiding"</span><span class="text-xs text-gray-400"> (betaalde dienst)</span>',Nt.push(Qe)}}catch(De){console.warn("Kadastrale Grenzen WMS query failed:",De)}continue}if(nn==="Scheepswrakken"){try{const De=En(Tt),xe=Tn("EPSG:4326","EPSG:28992",De),_e=100,N=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_SCHEEPSRESTANTEN&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_SCHEEPSRESTANTEN&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-_e},${xe[1]-_e},${xe[0]+_e},${xe[1]+_e}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const re=W.features[0].properties;let ne=`<strong class="text-cyan-800">${re.naam||re.NAAM||"Scheepswrak"}</strong>`;ne+='<br/><span class="text-sm text-gray-800">Historisch scheepswrak in Zuid-Holland</span>',ne+='<div class="mt-2 text-sm text-gray-700">',ne+="Op deze plek ligt een oud scheepswrak. Dit is een schip dat lang geleden is gezonken. ",ne+="In de bodem kunnen nog resten van het schip en de lading liggen.",ne+="</div>",(re.type||re.TYPE)&&(ne+=`<br/><span class="text-sm text-cyan-700">Type: ${re.type||re.TYPE}</span>`),(re.datering||re.DATERING)&&(ne+=`<br/><span class="text-sm text-gray-600">Periode: ${re.datering||re.DATERING}</span>`),(re.bron||re.BRON)&&(ne+=`<br/><span class="text-xs text-gray-500">Bron: ${re.bron||re.BRON}</span>`),ne+='<div class="mt-2 p-2 bg-cyan-50 rounded text-xs text-cyan-800">',ne+="<strong>Detectietip:</strong> Bij scheepswrakken kun je bijzondere vondsten doen zoals scheepsonderdelen, munten, gereedschap en lading. Let op: vaak is een vergunning nodig.",ne+="</div>",ne+='<div class="mt-2"><a href="https://www.zuid-holland.nl/onderwerpen/cultuur-erfgoed/" target="_blank" class="text-blue-600 hover:underline text-sm">Meer over erfgoed Zuid-Holland</a></div>',Nt.push(ne)}}catch(De){console.warn("Scheepswrakken WMS query failed:",De)}continue}if(nn==="Woonheuvels ZH"){try{const De=En(Tt),xe=Tn("EPSG:4326","EPSG:28992",De),_e=100,N=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_WOONHEUVEL&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_WOONHEUVEL&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-_e},${xe[1]-_e},${xe[0]+_e},${xe[1]+_e}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const re=W.features[0].properties;let ne=`<strong class="text-orange-800">${re.naam||re.NAAM||"Woonheuvel"}</strong>`;ne+='<br/><span class="text-sm text-gray-800">Historische woonheuvel (terp)</span>',ne+='<div class="mt-2 text-sm text-gray-700">',ne+="Een woonheuvel is een door mensen opgeworpen heuvel. Mensen woonden hierop om droge voeten te houden bij hoog water. ",ne+="Deze heuvels werden steeds hoger gemaakt. Je vindt ze vooral in laaggelegen gebieden.",ne+="</div>",(re.type||re.TYPE)&&(ne+=`<br/><span class="text-sm text-orange-700">Type: ${re.type||re.TYPE}</span>`),ne+='<div class="mt-2 p-2 bg-orange-50 rounded text-xs text-orange-800">',ne+="<strong>Detectietip:</strong> Woonheuvels zijn rijk aan vondsten! Denk aan aardewerk, munten, sieraden en huisraad uit de middeleeuwen. De grond bevat vaak veel materiaal.",ne+="</div>",ne+='<div class="mt-2"><a href="https://www.zuid-holland.nl/onderwerpen/cultuur-erfgoed/" target="_blank" class="text-blue-600 hover:underline text-sm">Meer over erfgoed Zuid-Holland</a></div>',Nt.push(ne)}}catch(De){console.warn("Woonheuvels WMS query failed:",De)}continue}if(nn==="Romeinse Forten"){try{const De=En(Tt),xe=Tn("EPSG:4326","EPSG:28992",De),_e=200,N=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_ROMEINSFORT&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_ROMEINSFORT&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-_e},${xe[1]-_e},${xe[0]+_e},${xe[1]+_e}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const re=W.features[0].properties;let ne=`<strong class="text-red-800">${re.naam||re.NAAM||"Romeins Fort"}</strong>`;ne+='<br/><span class="text-sm text-gray-800">Romeins militair fort (castellum)</span>',ne+='<div class="mt-2 text-sm text-gray-700">',ne+="Dit was een Romeins legerfort. De Romeinen bouwden deze forten langs de Rijn, de grens van hun rijk. ",ne+="Soldaten woonden hier en bewaakten de grens. Deze forten zijn ongeveer 2000 jaar oud.",ne+="</div>",(re.type||re.TYPE)&&(ne+=`<br/><span class="text-sm text-red-700">Type: ${re.type||re.TYPE}</span>`),(re.periode||re.PERIODE)&&(ne+=`<br/><span class="text-sm text-gray-600">Periode: ${re.periode||re.PERIODE}</span>`),ne+='<div class="mt-2 p-2 bg-red-50 rounded text-xs text-red-800">',ne+="<strong>Detectietip:</strong> Romeinse forten zijn toplocaties! Je kunt hier Romeinse munten, fibulae (mantelspelden), militaire uitrusting en aardewerk vinden. Vaak beschermd, check de regels!",ne+="</div>",ne+='<div class="mt-2"><a href="https://www.limesworld.nl/" target="_blank" class="text-blue-600 hover:underline text-sm">Meer over de Romeinse Limes</a></div>',Nt.push(ne)}}catch(De){console.warn("Romeinse Forten WMS query failed:",De)}continue}if(nn==="Windmolens"){try{const De=En(Tt),xe=Tn("EPSG:4326","EPSG:28992",De),_e=50,N=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_NEDERZETTING_WINDMOLENS&QUERY_LAYERS=CHS_2015_NEDERZETTING_WINDMOLENS&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-_e},${xe[1]-_e},${xe[0]+_e},${xe[1]+_e}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const re=W.features[0].properties;let ne=`<strong class="text-amber-800">${re.naam||re.NAAM||"Windmolen"}</strong>`;if(ne+='<br/><span class="text-sm text-gray-800">Historische windmolen</span>',ne+='<div class="mt-2 text-sm text-gray-700">',ne+="Windmolens gebruikten de kracht van de wind. Ze maalden graan tot meel of pompten water weg uit polders. ",ne+="Nederland heeft veel molens omdat we laaggelegen land droog moesten houden.",ne+="</div>",re.type||re.TYPE||re.functie||re.FUNCTIE){const he=re.functie||re.FUNCTIE||re.type||re.TYPE;ne+=`<br/><span class="text-sm text-amber-700">Functie: ${he}</span>`}(re.bouwjaar||re.BOUWJAAR)&&(ne+=`<br/><span class="text-sm text-gray-600">Bouwjaar: ${re.bouwjaar||re.BOUWJAAR}</span>`),ne+='<div class="mt-2 p-2 bg-amber-50 rounded text-xs text-amber-800">',ne+="<strong>Detectietip:</strong> Bij molens vind je vaak voorwerpen van de molenaar en bezoekers: munten, knopen, gereedschap. Ook de grond rond verdwenen molens kan interessant zijn.",ne+="</div>",ne+='<div class="mt-2"><a href="https://www.molendatabase.nl/" target="_blank" class="text-blue-600 hover:underline text-sm">Meer over Nederlandse molens</a></div>',Nt.push(ne)}}catch(De){console.warn("Windmolens WMS query failed:",De)}continue}if(nn==="Erfgoedlijnen"){try{const De=En(Tt),xe=Tn("EPSG:4326","EPSG:28992",De),_e=200,N=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_ERFGOEDLIJN_HOOFDSTRUCTUUR&QUERY_LAYERS=CHS_ERFGOEDLIJN_HOOFDSTRUCTUUR&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-_e},${xe[1]-_e},${xe[0]+_e},${xe[1]+_e}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const re=W.features[0].properties;let ne=`<strong class="text-purple-800">${re.naam||re.NAAM||re.erfgoedlijn||"Erfgoedlijn"}</strong>`;ne+='<br/><span class="text-sm text-gray-800">Historische lijn in het landschap</span>',ne+='<div class="mt-2 text-sm text-gray-700">',ne+="Een erfgoedlijn is een route of lijn met veel geschiedenis. Dit kunnen oude dijken, wegen, kanalen of verdedigingslinies zijn. ",ne+="Langs deze lijnen vind je vaak bijzondere plekken.",ne+="</div>",(re.type||re.TYPE)&&(ne+=`<br/><span class="text-sm text-purple-700">Type: ${re.type||re.TYPE}</span>`),(re.omschrijving||re.OMSCHRIJVING)&&(ne+=`<br/><span class="text-sm text-gray-600">${re.omschrijving||re.OMSCHRIJVING}</span>`),ne+='<div class="mt-2 p-2 bg-purple-50 rounded text-xs text-purple-800">',ne+="<strong>Detectietip:</strong> Erfgoedlijnen volgen oude routes waar mensen langskwamen. Denk aan munten, knopen, gespen en andere verloren voorwerpen. Dijken en wegen zijn vaak interessant.",ne+="</div>",ne+='<div class="mt-2"><a href="https://www.erfgoedlijnen.nl/" target="_blank" class="text-blue-600 hover:underline text-sm">Meer over Erfgoedlijnen</a></div>',Nt.push(ne)}}catch(De){console.warn("Erfgoedlijnen WMS query failed:",De)}continue}if(nn==="Oude Kernen"){try{const De=En(Tt),xe=Tn("EPSG:4326","EPSG:28992",De),_e=200,N=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_KERNEN&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_KERNEN&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-_e},${xe[1]-_e},${xe[0]+_e},${xe[1]+_e}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const re=W.features[0].properties;let ne=`<strong class="text-stone-800">${re.naam||re.NAAM||"Historische Kern"}</strong>`;ne+='<br/><span class="text-sm text-gray-800">Oude dorps- of stadskern</span>',ne+='<div class="mt-2 text-sm text-gray-700">',ne+="Dit is het oude centrum van een dorp of stad. Hier woonden en werkten mensen al honderden jaren geleden. ",ne+="De grond bevat vaak veel sporen van het verleden.",ne+="</div>",(re.type||re.TYPE)&&(ne+=`<br/><span class="text-sm text-stone-700">Type: ${re.type||re.TYPE}</span>`),(re.periode||re.PERIODE)&&(ne+=`<br/><span class="text-sm text-gray-600">Periode: ${re.periode||re.PERIODE}</span>`),ne+='<div class="mt-2 p-2 bg-stone-100 rounded text-xs text-stone-800">',ne+="<strong>Detectietip:</strong> Oude kernen zijn rijk aan vondsten! Munten, knopen, sieraden, gereedschap en huisraad. Let op: detecteren is vaak niet toegestaan in beschermde kernen.",ne+="</div>",ne+='<div class="mt-2"><a href="https://www.zuid-holland.nl/onderwerpen/cultuur-erfgoed/" target="_blank" class="text-blue-600 hover:underline text-sm">Meer over erfgoed Zuid-Holland</a></div>',Nt.push(ne)}}catch(De){console.warn("Oude Kernen WMS query failed:",De)}continue}if(nn==="Relictenkaart Punten"){try{const De=En(Tt),xe=Tn("EPSG:4326","EPSG:28992",De),_e=50,N=`https://geoserver.gelderland.nl/geoserver/ngr_a/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=ChAr_Relictenkaart_p&QUERY_LAYERS=ChAr_Relictenkaart_p&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-_e},${xe[1]-_e},${xe[0]+_e},${xe[1]+_e}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const re=W.features[0].properties,ee={KV:{naam:"Kasteel of Vesting",uitleg:"Een versterkt gebouw uit de middeleeuwen. Vaak zijn er nog resten in de grond."},K:{naam:"Kapel",uitleg:"Een klein kerkgebouw. Rond kapellen worden vaak religieuze voorwerpen gevonden."},KE:{naam:"Kerkhof",uitleg:"Historische begraafplaats. Respecteer deze plek en vraag altijd toestemming."},B:{naam:"Buitenhuis",uitleg:"Een landhuis van welgestelde families. Vaak met tuinen en bijgebouwen."},OB:{naam:"Oud Bebouwingsrelict",uitleg:"Resten van oude bebouwing. Hier stonden ooit huizen of boerderijen."},OV:{naam:"Oude Verkaveling",uitleg:"Historisch patroon van akkers en weilanden uit vroeger tijden."},NR:{naam:"Nijverheidsrelict",uitleg:"Plek waar vroeger ambacht of industrie was, zoals smederijen of molens."},GH:{naam:"Grafheuvel",uitleg:"Prehistorische begraafplaats. Beschermd monument - niet detecteren!"},BP:{naam:"Begraafplaats",uitleg:"Historische begraafplaats. Respecteer deze plek."},HH:{naam:"Havezate",uitleg:"Adellijk huis met landerijen. Interessant voor middeleeuwse vondsten."},RM:{naam:"Rosmolen",uitleg:"Molen aangedreven door paarden. Zeldzaam cultuurhistorisch object."},WM:{naam:"Windmolen",uitleg:"Historische windmolen. Vaak zijn funderingen nog zichtbaar."},PM:{naam:"Poldermolen",uitleg:"Molen voor waterbeheer. Belangrijk voor de waterhuishouding."},EK:{naam:"Eendenkooi",uitleg:"Plek om wilde eenden te vangen. Bijzonder cultuurlandschap."},SH:{naam:"Scholtenhoeve",uitleg:"Boerderij van een welgestelde boer. Vaak eeuwenoud."},SL:{naam:"Slot",uitleg:"Versterkt kasteel of adellijke woning."},MO:{naam:"Motte",uitleg:"Vroegmiddeleeuwse kasteelberg. Zeer interessant voor detectie."},BR:{naam:"Borg",uitleg:"Versterkte adellijke woning, typisch voor het noorden."}},ne=re.type?.replace(/[0-9]/g,"")||"",he=ee[ne]||{naam:re.type||"Cultuurhistorisch object",uitleg:"Een historisch relict in het Gelderse landschap."};let Ce=`<strong class="text-emerald-800">${he.naam}</strong>`;Ce+='<br/><span class="text-sm text-gray-800">Gelders cultuurhistorisch relict</span>',re.streek&&(Ce+=`<br/><span class="text-sm text-gray-600">Streek: ${re.streek}</span>`),Ce+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is dit?</span></div>',Ce+=`<div class="text-sm text-gray-700 mt-1">${he.uitleg}</div>`,Ce+='<div class="mt-3"><a href="https://www.gelderland.nl/erfgoed" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline text-sm">Meer over Gelders erfgoed</a></div>',Nt.push(Ce)}}catch(De){console.warn("Relictenkaart Punten WMS query failed:",De)}continue}if(nn==="Relictenkaart Lijnen"){try{const De=En(Tt),xe=Tn("EPSG:4326","EPSG:28992",De),_e=50,N=`https://geoserver.gelderland.nl/geoserver/ngr_a/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=ChAr_Relictenkaart_l&QUERY_LAYERS=ChAr_Relictenkaart_l&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-_e},${xe[1]-_e},${xe[0]+_e},${xe[1]+_e}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const re=W.features[0].properties,ne={1:{naam:"Sprengenbeek",uitleg:"Kunstmatig aangelegde beek voor waterkracht. Vaak bij papiermolens."},2:{naam:"Oude waterloop",uitleg:"Historische beek of rivier. Langs waterlopen vind je vaak oude bewoningssporen."},3:{naam:"Doorgaande weg",uitleg:"Eeuwenoude handelsroute. Langs deze wegen gingen reizigers en handelaren."},4:{naam:"Hessenweg",uitleg:"Historische handelsweg naar Duitsland. Gebruikt door marskramers en kooplieden."},5:{naam:"Oude weg",uitleg:"Historische route door het landschap. Vaak al eeuwen in gebruik."},6:{naam:"Historische grens",uitleg:"Oude eigendoms- of gebiedsgrens. Soms gemarkeerd met grenspalen."},7:{naam:"Trekpad",uitleg:"Pad langs een kanaal waar paarden schepen trokken."},8:{naam:"Jaagpad",uitleg:"Pad langs water voor scheepvaart met paardentractie."}}[re.klasse]||{naam:"Historisch lijnrelict",uitleg:"Een lijnvormig historisch element in het landschap."};let he=`<strong class="text-teal-800">${ne.naam}</strong>`;he+='<br/><span class="text-sm text-gray-800">Gelders lijnrelict</span>',he+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is dit?</span></div>',he+=`<div class="text-sm text-gray-700 mt-1">${ne.uitleg}</div>`,he+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Tip</span></div>',he+='<div class="text-sm text-gray-700 mt-1">Langs oude wegen en waterlopen worden vaak vondsten gedaan. Mensen verloren er munten en voorwerpen.</div>',Nt.push(he)}}catch(De){console.warn("Relictenkaart Lijnen WMS query failed:",De)}continue}if(nn==="Relictenkaart Vlakken"){try{const De=En(Tt),xe=Tn("EPSG:4326","EPSG:28992",De),_e=100,N=`https://geoserver.gelderland.nl/geoserver/ngr_a/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=ChAr_Relictenkaart_v&QUERY_LAYERS=ChAr_Relictenkaart_v&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-_e},${xe[1]-_e},${xe[0]+_e},${xe[1]+_e}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const re=W.features[0].properties,ne={1:{naam:"Oud agrarisch land",uitleg:"Gebied dat al voor 1850 als landbouwgrond werd gebruikt. Rijk aan geschiedenis."},2:{naam:"Jonge heideontginning",uitleg:"Heide die tussen 1850 en 1950 is ontgonnen voor landbouw."},3:{naam:"Open essencomplex",uitleg:"Historische akkers op hoge grond. Vaak eeuwenoud en rijk aan vondsten."},4:{naam:"Kampenlandschap",uitleg:"Landschap met kleine akkers omringd door houtwallen. Typisch voor Oost-Nederland."},5:{naam:"Heiderelict",uitleg:"Restant van het vroegere uitgestrekte heidelandschap. Vaak prehistorische vondsten."},6:{naam:"Oud bosrelict",uitleg:"Bos dat al in 1850 bestond. Oude bossen bevatten vaak cultuurhistorische resten."},7:{naam:"Stuifzandrelict",uitleg:"Overblijfsel van actief stuifzand. Vaak bij grafheuvels en prehistorische sites."},8:{naam:"Oud bouwland",uitleg:"Historische akkergrond. Boeren hebben hier eeuwenlang gewerkt."},9:{naam:"Historisch grasland",uitleg:"Oud weiland of hooiland. Vaak bij boerderijen en dorpen."},10:{naam:"Beekdal",uitleg:"Laagte langs een beek. Mensen woonden graag bij water."}}[re.klasse]||{naam:"Historisch landschap",uitleg:"Een waardevol cultuurlandschap in Gelderland."};let he=`<strong class="text-lime-800">${ne.naam}</strong>`;if(he+='<br/><span class="text-sm text-gray-800">Gelders landschapsrelict</span>',re.st_area_shape_){const Ce=(re.st_area_shape_/1e4).toFixed(1);he+=`<br/><span class="text-sm text-gray-600">${Ce} hectare</span>`}he+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is dit?</span></div>',he+=`<div class="text-sm text-gray-700 mt-1">${ne.uitleg}</div>`,Nt.push(he)}}catch(De){console.warn("Relictenkaart Vlakken WMS query failed:",De)}continue}if(nn==="Verdronken Dorpen"){try{const De=En(Tt),xe=Tn("EPSG:4326","EPSG:28992",De),_e=200,N=`https://opengeodata.zeeland.nl/geoserver/chs/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=geocmd_vrddrppnt&QUERY_LAYERS=geocmd_vrddrppnt&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${xe[0]-_e},${xe[1]-_e},${xe[0]+_e},${xe[1]+_e}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const re=W.features[0].properties;let ne=`<strong class="text-blue-800">${re.naam||re.NAAM||"Verdronken dorp"}</strong>`;ne+='<br/><span class="text-sm text-gray-800">Verdronken dorp in Zeeland</span>',ne+='<div class="mt-2 text-sm text-gray-700">',ne+="Dit dorp is lang geleden door de zee verzwolgen. Bij stormvloeden brak de zeedijk door en liep het land onder water. ",ne+="De mensen vluchtten, maar hun huizen en bezittingen bleven achter. In de bodem liggen nog resten van dit dorp.",ne+="</div>",(re.verdronken||re.VERDRONKEN||re.jaar||re.JAAR)&&(ne+=`<br/><span class="text-sm text-blue-700">Verdronken in: ${re.verdronken||re.VERDRONKEN||re.jaar||re.JAAR}</span>`),(re.gemeente||re.GEMEENTE)&&(ne+=`<br/><span class="text-sm text-gray-600">Gemeente: ${re.gemeente||re.GEMEENTE}</span>`),(re.bron||re.BRON)&&(ne+=`<br/><span class="text-xs text-gray-500">Bron: ${re.bron||re.BRON}</span>`),ne+='<div class="mt-2 p-2 bg-blue-50 rounded text-xs text-blue-800">',ne+="<strong>Detectietip:</strong> Verdronken dorpen bevatten veel vondsten! Aardewerk, munten, sieraden, gereedschap en huisraad. Bij laag water komen soms stukken vrij. Let op getijden en veiligheid!",ne+="</div>",ne+='<div class="mt-2"><a href="https://www.verdronkengeschiedenis.nl/" target="_blank" class="text-blue-600 hover:underline text-sm">Meer over verdronken dorpen</a></div>',Nt.push(ne)}}catch(De){console.warn("Verdronken Dorpen WMS query failed:",De)}continue}const Sr=li.getFeatureInfoUrl(Tt,sn,"EPSG:3857",{INFO_FORMAT:"application/json"});if(Sr)try{const xe=await(await fetch(Sr)).json();if(xe.features&&xe.features.length>0){const _e=xe.features[0].properties;if(nn==="AHN 0.5m"){let W='<strong class="text-blue-800">AHN Hoogtekaart</strong>';const re=_e.value_list??_e.GRAY_INDEX??_e.value??_e.gray_index??_e.dtm_05m??_e.DTM_05M??_e.hoogte??_e.HOOGTE??_e.elevation??_e.ELEVATION;if(re!=null&&!isNaN(Number(re))){const ee=typeof re=="number"?re.toFixed(2):Number(re).toFixed(2);W+=`<br/><span class="text-sm text-blue-700">Hoogte: ${ee} m NAP</span>`,Nt.push(W)}else{let ee=!1;const ne=["geometry","id","fid","gml_id","bbox"];for(const[he,Ce]of Object.entries(_e))!ne.includes(he.toLowerCase())&&Ce!==null&&Ce!==""&&(W+=`<br/><span class="text-xs text-gray-600">${he}: ${Ce}</span>`,ee=!0);ee&&Nt.push(W)}continue}if(nn==="Geomorfologie"){let W='<strong class="text-green-800">Geomorfologie</strong>',re=!1;const ee=_e.landform_subgroup_description,ne=_e.relief_klasse,he=_e.relief_subklasse,Ce=_e.genese_description,je=_e.active_process;if(ee&&(W+=`<br/><span class="text-sm text-green-700">${ee}</span>`,re=!0),ne){const He=he&&he!==ne?`${ne} (${he})`:ne;W+=`<br/><span class="text-xs text-gray-600">Relief: ${He}</span>`,re=!0}if(Ce&&(W+=`<br/><span class="text-xs text-gray-500">Ontstaan: ${Ce}</span>`,re=!0),je&&je!=="onbekend"&&(W+=`<br/><span class="text-xs text-gray-500">Actief proces: ${je}</span>`,re=!0),!re){const He=["geometry","id","fid","gml_id","bbox","fuuid","geom","collection_id"];for(const[Je,Qe]of Object.entries(_e))!He.includes(Je.toLowerCase())&&Qe!==null&&Qe!==""&&!Je.includes("validfrom")&&!Je.includes("validto")&&(W+=`<br/><span class="text-xs text-gray-600">${Je}: ${Qe}</span>`)}W+='<br/><a href="https://legendageomorfologie.wur.nl/" target="_blank" rel="noopener" class="text-xs text-blue-600 hover:underline">Meer over geomorfologie</a>',Nt.push(W);continue}let Ft=`<strong>${nn}</strong>`;const N=_e.first_soilname||_e.soilname,ut=_e.soilcode||_e.first_soilcode;if(N&&(Ft+=`<br/><span class="text-sm text-amber-700">${N}</span>`,nn==="Bodemkaart")){const W=hD(N,ut);W.length>0&&(Ft+=`<br/><span class="text-xs text-gray-500 italic">${W.join("  ")}</span>`)}if(_e.soilslope&&_e.soilslope!=="Niet opgenomen"&&(Ft+=`<br/><span class="text-xs text-gray-500">Helling: ${_e.soilslope}</span>`),!N){const W=["geometry","id","fid","gml_id","GRAY_INDEX","gray_index","value"];for(const[re,ee]of Object.entries(_e))!W.includes(re)&&ee&&ee!=="Niet opgenomen"&&(Ft+=`<br/><span class="text-xs text-gray-600">${re}: ${ee}</span>`)}Nt.push(Ft)}}catch(De){console.warn("WMS GetFeatureInfo failed:",De)}}return Nt},Rn=async Tt=>{const sn=[],Nt=[],qi=xe=>{if(!xe)return;const _e=xe.getType(),N=xe.clone().transform("EPSG:3857","EPSG:4326").getCoordinates();return{type:_e,coordinates:N}},Nr=ZTe(Tt.coordinate),li=[];n.forEachFeatureAtPixel(Tt.pixel,xe=>{li.push(xe)});for(const xe of li){const _e=xe.getProperties(),{geometry:Ft,...N}=_e;if(N.vondst){const ee=N.vondst,ne=`<strong>${ee.objectType}</strong>
            <div data-vondst-id="${ee.id}"></div>
            <br/><span class="text-sm text-gray-600"><strong>Materiaal:</strong> ${ee.material}</span>
            <br/><span class="text-sm text-gray-600"><strong>Periode:</strong> ${ee.period}</span>
            ${ee.depth?`<br/><span class="text-sm text-gray-600"><strong>Diepte:</strong> ${ee.depth} cm</span>`:""}
            ${ee.condition&&ee.condition!=="Onbekend"?`<br/><span class="text-sm text-gray-600"><strong>Conditie:</strong> ${ee.condition}</span>`:""}
            ${ee.weight?`<br/><span class="text-sm text-gray-600"><strong>Gewicht:</strong> ${ee.weight} gram</span>`:""}
            ${ee.notes?`<br/><span class="text-sm text-gray-600"><strong>Notities:</strong> ${ee.notes}</span>`:""}
            ${ee.photoUrl?`<br/><a href="${ee.photoUrl}" target="_blank" rel="noopener" class="text-blue-600 hover:underline text-sm"> Bekijk foto</a>`:""}
            <br/><span class="text-xs text-gray-400">${new Date(ee.timestamp).toLocaleDateString("nl-NL")}</span>`;sn.push(ne),Nt.push(null),M(ee.id);continue}if(N.layerType==="customPoint"&&N.customPoint){const ee=N.customPoint,ne=N.customLayerName||"Mijn Laag",he=N.customLayerColor||"#f97316";let Ce="";if(ee.popupContent?(Ce=`<div class="flex items-center gap-2 mb-2 pb-2 border-b border-gray-100">
              <span class="w-3 h-3 rounded-full flex-shrink-0" style="background-color: ${he}"></span>
              <span class="text-xs font-medium" style="color: ${he}">${ne}</span>
            </div>`,Ce+=ee.popupContent):(Ce=`<strong>${ee.name}</strong>`,Ce+=`<br/><span class="text-xs text-gray-500">${ne}</span>`,ee.category&&ee.category!=="Overig"&&(Ce+=`<br/><span class="text-sm text-gray-600"><strong>Categorie:</strong> ${ee.category}</span>`)),ee.photos&&ee.photos.length>0){Ce+='<div class="flex flex-wrap gap-1 my-2">';for(const je of ee.photos.slice(0,3)){const He=je.thumbnailUrl||je.thumbnailBase64;He&&(Ce+=`<img src="${He}" alt="Foto" class="w-16 h-16 object-cover rounded border border-gray-200" />`)}ee.photos.length>3&&(Ce+=`<span class="text-xs text-gray-400 self-end">+${ee.photos.length-3} meer</span>`),Ce+="</div>"}ee.notes&&!ee.popupContent&&(Ce+=`<br/><span class="text-sm text-gray-600 mt-1">${ee.notes}</span>`),ee.url&&(Ce+=`<br/><a href="${ee.url}" target="_blank" rel="noopener" class="text-blue-600 hover:underline text-sm">Meer info</a>`),Ce+=`<br/><span class="text-xs text-gray-400">${new Date(ee.createdAt).toLocaleDateString("nl-NL")}</span>`,sn.push(Ce),Nt.push(null);continue}if(N.layerType==="importedLayer"){const ee=N.layerName||"Gemporteerde laag",ne=N.layerColor||"#8b5cf6",he=["layerType","layerId","layerName","layerColor","featureIndex","geometry"],Ce=N.name||N.Name||N.naam||N.title||N.NAAM||N.NAME||N.label||N.description||"Feature";let je=`<strong style="color: ${ne}">${Ce}</strong>`;je+=`<br/><span class="text-xs text-gray-500">${ee}</span>`;const He=Object.entries(N).filter(([Je])=>!he.includes(Je)&&Je!=="name"&&Je!=="Name");if(He.length>0){je+='<div class="mt-2 space-y-1">';for(const[Je,Qe]of He)if(Qe!=null&&Qe!==""){const xt=Je.replace(/_/g," ").replace(/([a-z])([A-Z])/g,"$1 $2").replace(/^./,An=>An.toUpperCase());let St=String(Qe);St.length>200&&(St=St.substring(0,200)+"..."),St.startsWith("http://")||St.startsWith("https://")?je+=`<div class="text-sm"><span class="text-gray-500">${xt}:</span> <a href="${St}" target="_blank" rel="noopener" class="text-blue-600 hover:underline">Link</a></div>`:je+=`<div class="text-sm"><span class="text-gray-500">${xt}:</span> <span class="text-gray-700">${St}</span></div>`}je+="</div>"}sn.push(je),Nt.push({geometry:qi(Ft),properties:N,popupHtml:je});continue}if(N.kwaliteitswaarde&&N.kwaliteitswaarde.includes("archeologische waarde")){const ee=_t(N);sn.push(ee),Nt.push({geometry:qi(Ft),properties:N,popupHtml:ee});continue}if(N.layerType==="romeinsFort"||N.layerType==="romeinsFortLijn"){const ee=N.Name||N.name||"";N.description;const ne=KTe[ee]||null,he=ne||XTe;let Ce=`<strong class="text-red-800">${ne?he.naam:ee||"Romeins Fort"}</strong>`;if(Ce+=`<br/><span class="text-sm text-red-700">${qTe[he.type]||he.type}</span>`,Ce+=`<br/><span class="text-sm text-gray-500">${he.periode}</span>`,N.layerType==="romeinsFortLijn"&&(Ce+='<br/><span class="text-sm text-red-600"> Gereconstrueerde fortomtrek</span>'),Ce+=`<br/><span class="text-xs text-gray-600 mt-1 block">${he.beschrijving}</span>`,ne?.bronnen&&ne.bronnen.length>0){const je=ne.bronnen[0].replace(/^https?:\/\//,"").split("/")[0];Ce+=`<br/><a href="${ne.bronnen[0]}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline text-xs">${je}</a>`}sn.push(Ce),Nt.push({geometry:qi(Ft),properties:N,popupHtml:Ce});continue}let ut=N.name||N.Name||N.naam||N.title||N.NAAM||N.NAME||N.label||N.route_name||N.road_name;ut||(N.leisure==="playground"?ut="Speeltuin":N.leisure==="park"?ut="Park":N.leisure==="swimming_area"||N.sport==="swimming"?ut="Zwemplek":N.tourism==="museum"?ut="Museum":N.amenity==="cafe"||N.amenity==="restaurant"?ut=N.amenity==="cafe"?"Caf":"Restaurant":N.historic==="castle"?ut="Kasteel":ut="Info"),(N.bunker_type||N.name&&(N.name.toLowerCase().includes("bunker")||N.name.toLowerCase().includes("kazemat")||N.name.toLowerCase().includes("schuilplaats")))&&(ut="Bunker"),N.historic==="battlefield"&&(ut="Historisch slagveld");let W=`<strong>${ut}</strong>`;if(N.category&&(W+=`<br/><span class="text-sm text-gray-600">Categorie: ${N.category}</span>`),N.from_to&&N.from_to!==ut&&(W+=`<br/><span class="text-sm text-gray-600">${N.from_to}</span>`),N.route&&N.route!==ut&&(W+=`<br/><span class="text-sm text-gray-600">${N.route}</span>`),N.TOPONIEM&&(W+=`<br/><span class="text-sm font-semibold text-gray-800">${N.TOPONIEM}</span>`,N.PLAATS&&(W+=`<br/><span class="text-xs text-gray-500">${N.PLAATS}</span>`)),(N.AARD_VINDP||N.Aard_vindp)&&(W+=`<br/><span class="text-sm text-gray-700">Aard: ${N.AARD_VINDP||N.Aard_vindp}</span>`),N.BEGIN_PER&&N.EIND_PER&&(W+=`<br/><span class="text-sm text-purple-700">Periode: ${N.BEGIN_PER} - ${N.EIND_PER}</span>`),(N.AARD_OPM||N.Aard_opmer)&&(W+=`<br/><span class="text-xs text-gray-600 italic">${N.AARD_OPM||N.Aard_opmer}</span>`),N.Gemeente&&(W+=`<br/><span class="text-sm text-gray-600">Gemeente: ${N.Gemeente}</span>`),N.Bron&&(W+=`<br/><span class="text-xs text-gray-500">Bron: ${N.Bron}</span>`),N.Bron_besch&&(W+=`<br/><span class="text-xs text-gray-500">${N.Bron_besch}</span>`),N.Dat_st_z&&N.Dat_ei_z&&(W+=`<br/><span class="text-sm text-purple-700">Datering: ${N.Dat_st_z} - ${N.Dat_ei_z}</span>`),N.Begin&&N.Einde&&(W+=`<br/><span class="text-sm text-purple-700">Periode: ${N.Begin} - ${N.Einde}</span>`),N.Uiterwaard&&(W+=`<br/><span class="text-sm font-semibold">${N.Uiterwaard}</span>`),N.rivier&&(W+=`<br/><span class="text-sm text-blue-600">Rivier: ${N.rivier}</span>`),N.Beschrijvi&&(W+=`<br/><span class="text-sm text-gray-700">${N.Beschrijvi}</span>`),N.leisure==="park"){W=`<strong class="text-green-800">${N.name||"Park"}</strong>`,W+='<br/><span class="text-sm text-gray-800">Park</span>',N.description&&(W+=`<div class="mt-2 text-sm text-gray-700">${N.description}</div>`),N.area&&(W+=`<br/><span class="text-sm text-gray-600">Oppervlakte: ${N.area}</span>`);const ne=[];if(N.dog==="yes"&&ne.push("Honden toegestaan"),N.lit==="yes"&&ne.push("Verlicht"),N.bench==="yes"&&ne.push("Bankjes"),ne.length>0&&(W+=`<br/><span class="text-sm text-gray-600">${ne.join("  ")}</span>`),N.operator&&(W+=`<br/><span class="text-xs text-gray-500">Beheer: ${N.operator}</span>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Tip voor detectie</span></div>',W+='<div class="text-sm text-gray-700">Parken zijn populair bij detectoristen. Mensen verliezen hier munten en sieraden. Vraag eerst toestemming aan de gemeente of beheerder.</div>',N.website){const he=N.website.replace(/^https?:\/\//,"").split("/")[0];W+=`<div class="mt-2"><a href="${N.website}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline text-sm">${he}</a></div>`}}else N.leisure==="playground"&&(W=`<strong class="text-orange-800">${N.name||"Speeltuin"}</strong>`,W+='<br/><span class="text-sm text-gray-800">Speeltuin</span>',N.description&&(W+=`<div class="mt-2 text-sm text-gray-700">${N.description}</div>`));if(N.tourism==="museum"||N.museum){W=`<strong class="text-purple-800">${N.name||"Museum"}</strong>`,W+='<br/><span class="text-sm text-gray-800">Museum</span>';const ne=N.museum||N["museum:type"]||"";if(ne&&ne!=="yes"){const Ce={art:"Kunstmuseum",history:"Geschiedenismuseum",archaeology:"Archeologisch museum",science:"Wetenschapsmuseum",technology:"Techniekmuseum",nature:"Natuurmuseum",open_air:"Openluchtmuseum",local:"Streekmuseum",military:"Militair museum",railway:"Spoorwegmuseum",maritime:"Maritiem museum",children:"Kindermuseum"}[ne.toLowerCase()]||ne;W+=`<br/><span class="text-sm text-gray-700">${Ce}</span>`}if(N.description&&(W+=`<div class="mt-2 text-sm text-gray-700">${N.description}</div>`),N.opening_hours&&(W+='<div class="mt-2"><span class="text-sm font-semibold text-gray-800">Openingstijden:</span></div>',W+=`<div class="text-sm text-gray-700">${N.opening_hours}</div>`),N.fee){const he=N.fee==="yes"?"Toegangsprijs":N.fee==="no"?"Gratis toegang":N.fee;W+=`<br/><span class="text-sm text-gray-600">${he}</span>`}if(N["addr:street"]||N["addr:housenumber"]){const he=[N["addr:street"],N["addr:housenumber"]].filter(Boolean).join(" ");he&&(W+=`<br/><span class="text-xs text-gray-500">${he}</span>`)}if(N["addr:city"]&&(W+=`<br/><span class="text-xs text-gray-500">${N["addr:postcode"]||""} ${N["addr:city"]}</span>`),N.website||N.url){const he=N.website||N.url,Ce=he.replace(/^https?:\/\//,"").split("/")[0];W+=`<div class="mt-2"><a href="${he}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline text-sm">Bezoek ${Ce}</a></div>`}if(N.wikipedia){const he=N.wikipedia.split(":")[0]||"nl",Ce=N.wikipedia.split(":")[1]||N.wikipedia;W+=`<div class="text-sm"><a href="https://${he}.wikipedia.org/wiki/${encodeURIComponent(Ce)}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`}}if(N.leisure==="swimming_area"||N.sport==="swimming"||N.natural==="beach"){W=`<strong class="text-cyan-800">${N.name||"Zwemplek"}</strong>`;const ne=N.natural==="beach"?"Strand":N.leisure==="swimming_area"?"Zwemplek":"Zwemwater";W+=`<br/><span class="text-sm text-gray-800">${ne}</span>`,N.water&&(W+=`<br/><span class="text-sm text-gray-700">${{lake:"Meer",river:"Rivier",pond:"Vijver",reservoir:"Reservoir",canal:"Kanaal"}[N.water]||N.water}</span>`),N.supervised==="yes"&&(W+='<br/><span class="text-sm text-green-700">Met toezicht</span>'),N.changing_rooms==="yes"&&(W+='<br/><span class="text-sm text-gray-600">Kleedruimte aanwezig</span>'),N.description&&(W+=`<div class="mt-2 text-sm text-gray-700">${N.description}</div>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Tip voor detectie</span></div>',W+='<div class="text-sm text-gray-700">Zwemplekken kunnen interessant zijn voor detectie. Mensen verliezen hier sieraden en munten. Let op: niet overal is detecteren toegestaan.</div>'}if(N.osm_id&&N.address!==void 0&&(W+='<br/><span class="text-sm text-lime-700">Kringloopwinkel</span>',N.address&&(W+=`<br/><span class="text-xs text-gray-500">${N.address}</span>`),N.phone&&(W+=`<br/><span class="text-xs text-gray-600">${N.phone}</span>`)),N.site_type==="tumulus"){const ee=xe.getGeometry()?.getCoordinates();let ne="",he="";if(ee){const Ce=En(ee),je=Ce[0],He=Ce[1];je>5.5&&je<6.3&&He>52&&He<52.5?(ne="Veluwe",he="De Veluwe heeft de grootste concentratie grafheuvels van Nederland. Veel heuvels liggen in grafvelden met tientallen heuvels bij elkaar."):je>6.2&&je<7.1&&He>52.6&&He<53.3?(ne="Drenthe",he="Drenthe is beroemd om zijn prehistorische monumenten. Naast hunebedden liggen hier honderden grafheuvels uit de Bronstijd."):je>4.5&&je<6&&He>51.3&&He<51.9?(ne="Noord-Brabant",he="Op de Brabantse zandgronden liggen veel grafheuvels, vaak in kleine groepjes op hogere gronden."):je>5.5&&je<6.3&&He>50.7&&He<51.6?(ne="Limburg",he="De Limburgse heuvels en plateaus herbergen grafheuvels uit verschillende periodes, van Bronstijd tot Romeinse tijd."):je>5&&je<5.6&&He>52&&He<52.4&&(ne="Utrechtse Heuvelrug",he="De stuwwallen van de Utrechtse Heuvelrug en het Gooi waren al in de prehistorie bewoond. Grafheuvels markeren de laatste rustplaats van de vroege bewoners.")}W+='<br/><span class="text-sm text-amber-700">Grafheuvel uit de Bronstijd of IJzertijd</span>',ne&&(W+=`<br/><span class="text-sm text-gray-500">${ne}</span>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',W+='<div class="text-sm text-gray-700 mt-1">Een grafheuvel is een kunstmatige heuvel over een of meerdere graven. De meeste Nederlandse grafheuvels zijn 3000 tot 4000 jaar oud, uit de Bronstijd (2000-800 v.Chr.) of vroege IJzertijd.</div>',he&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Over deze regio</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${he}</div>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe herken je een grafheuvel?</span></div>',W+='<div class="text-sm text-gray-700 mt-1">Grafheuvels zijn vaak ronde, lage heuvels van 10-30 meter doorsnee en 1-3 meter hoog. Ze liggen meestal op zandgronden, vaak in groepjes (grafvelden). Let op de kenmerkende ronde vorm in het landschap.</div>',N.wikidata?(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer informatie</span></div>',W+=`<div class="text-sm text-gray-700 mt-1"><a href="https://www.wikidata.org/wiki/${N.wikidata}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Bekijk op Wikidata</a></div>`):(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer informatie</span></div>',W+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Grafheuvel" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Lees meer over grafheuvels op Wikipedia</a></div>')}if(N.historic==="castle"||N.castle_type){const ee={manor:{label:"Landhuis",uitleg:"Een landhuis of havezate was het woonhuis van een adellijke familie. Vaak met een landgoed eromheen.",vondsten:"Sieraden, gespen, munten, aardewerk van rijke bewoners"},stately:{label:"Statig huis",uitleg:"Een groot en deftig woonhuis, vaak van welgestelde families. Soms met kasteelachtige kenmerken.",vondsten:"Huishoudelijke voorwerpen, munten, knopen, aardewerk"},fortress:{label:"Fort/Vesting",uitleg:"Een versterkte militaire bouwwerk, gebouwd om een gebied te verdedigen.",vondsten:"Militaire voorwerpen, kogels, gespen, uniformonderdelen"},defensive:{label:"Verdedigingskasteel",uitleg:"Een kasteel gebouwd voor verdediging, met dikke muren, een gracht en torens.",vondsten:"Wapens, harnasonderdelen, pijlpunten, middeleeuwse munten"},palace:{label:"Paleis",uitleg:"Een groot en luxueus gebouw voor koningen, prinsen of zeer rijke families.",vondsten:"Luxe voorwerpen, sieraden, zegels, zeldzame munten"},castrum:{label:"Romeins fort",uitleg:"Een Romeins legerkamp of fort. Deze zijn bijna 2000 jaar oud!",vondsten:"Romeinse munten, fibulae, militaria, aardewerk"},citadel:{label:"Citadel",uitleg:"Een sterk versterkte kern binnen een stad, als laatste verdedigingslinie.",vondsten:"Militaire voorwerpen uit verschillende periodes"}},ne=N.castle_type?ee[N.castle_type]:null,he=ne?.label||"Kasteel";if(W+=`<br/><span class="text-sm text-purple-700">${he}</span>`,N.start_date&&(W+=`<br/><span class="text-xs text-gray-500">Bouwjaar: ${N.start_date}</span>`),N.heritage&&(W+='<br/><span class="text-sm text-amber-700">Rijksmonument</span>'),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',ne?W+=`<div class="text-sm text-gray-700 mt-1">${ne.uitleg}</div>`:W+='<div class="text-sm text-gray-700 mt-1">Een historisch kasteel of adellijk huis. Kastelen waren vaak het middelpunt van macht en rijkdom in een gebied.</div>',W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',ne?W+=`<div class="text-sm text-gray-700 mt-1">${ne.vondsten}</div>`:W+='<div class="text-sm text-gray-700 mt-1">Munten, sieraden, gespen, aardewerk en andere voorwerpen van de vroegere bewoners.</div>',N.wikipedia||N.website){if(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',N.wikipedia){const Ce=N.wikipedia.startsWith("http")?N.wikipedia:`https://nl.wikipedia.org/wiki/${N.wikipedia.replace(/^nl:/,"")}`;W+=`<div class="text-sm text-gray-700 mt-1"><a href="${Ce}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`}N.website&&(W+=`<div class="text-sm text-gray-700 mt-1"><a href="${N.website}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Website bezoeken</a></div>`)}}if(N.historic==="ruins"){const ee=N.ruins_type||"";let ne="Rune",he="Een rune is wat overblijft van een oud gebouw. Het kan een kerk, kasteel, molen of ander bouwwerk zijn geweest.",Ce="Baksteenfragmenten, aardewerk, metalen voorwerpen van vroegere bewoners of gebruikers";if(ee.toLowerCase().includes("church")||ee.toLowerCase().includes("kerk")?(ne="Kerkrune",he="De overblijfselen van een oude kerk. Vaak nog te herkennen aan de fundering of een paar muren.",Ce="Religieuze voorwerpen, munten van kerkgangers, knopen, gespen"):ee.toLowerCase().includes("castle")||ee.toLowerCase().includes("kasteel")?(ne="Kasteelrune",he="De resten van een middeleeuws kasteel. Soms is alleen de gracht of fundering nog zichtbaar.",Ce="Middeleeuwse munten, sieraden, harnasonderdelen, pijlpunten"):ee.toLowerCase().includes("mill")||ee.toLowerCase().includes("molen")?(ne="Molenrune",he="Wat rest van een oude molen. Vaak nog te zien aan de stenen fundering of de molenberg.",Ce="Gereedschap, munten, huishoudelijke voorwerpen"):ee.toLowerCase().includes("fort")&&(ne="Fortrune",he="De overblijfselen van een militair fort of verdedigingswerk.",Ce="Militaire voorwerpen, kogels, gespen, uniformonderdelen"),W+=`<br/><span class="text-sm text-amber-700">${ne}</span>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${he}</div>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${Ce}</div>`,N.description&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Beschrijving</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${N.description}</div>`),N.wikipedia){const je=N.wikipedia.startsWith("http")?N.wikipedia:`https://${N.wikipedia.split(":")[0]||"nl"}.wikipedia.org/wiki/${N.wikipedia.replace(/^[a-z]{2}:/,"")}`;W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">Lees meer op <a href="${je}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`}}if(N.bunker_type||N.name&&(N.name.toLowerCase().includes("bunker")||N.name.toLowerCase().includes("kazemat")||N.name.toLowerCase().includes("schuilplaats"))){const ee={munitions:"Munitiebunker",personnel_shelter:"Personeelsschuilplaats",personell_shelter:"Personeelsschuilplaats",command:"Commandobunker",gun_emplacement:"Geschutsbunker",mg_nest:"Mitrailleursnest",technical:"Technische bunker",storage:"Opslagbunker",tobruk:"Tobruk",kazemat:"Kazemat",Flak:"Luchtafweerstelling",hardened_aircraft_shelter:"Vliegtuigshelter",shelter:"Schuilkelder",observation:"Observatiebunker",anti_aircraft:"Luchtafweerstelling"},ne=N.name||"",he=N.bunker_type?ee[N.bunker_type]||N.bunker_type:"";ne&&ne!=="Bunker"&&(W+=`<br/><span class="text-sm font-semibold text-gray-700">${ne}</span>`),he&&he!==ne&&(W+=`<br/><span class="text-xs text-gray-500">${he}</span>`);const Ce=xe.getGeometry()?.getCoordinates();let je="",He="",Je="";if(Ce){const Qe=En(Ce),xt=Qe[0],St=Qe[1],An=xt<4.8||xt<5.2&&St>51.8&&St<53.5,B=xt>4.2&&xt<4.4&&St>52&&St<52.15,Y=xt>4.5&&xt<4.7&&St>52.4&&St<52.5,K=xt>4&&xt<4.2&&St>51.95&&St<52.05,q=xt<4.2&&St<51.6,J=xt>5.2&&xt<5.8&&St>51.9&&St<52.3;B?(je="Deze bunker maakt deel uit van de Atlantikwall bij Scheveningen. De Duitsers bouwden hier tijdens WOII zo'n 80 bunkers in de duinen. De muren zijn soms 3 meter dik beton. Voor deze bunkers moesten 138.000 mensen uit Den Haag en Scheveningen hun huis verlaten.",He="https://nl.wikipedia.org/wiki/Atlantikwall_Museum_Scheveningen",Je="Atlantikwall Museum Scheveningen"):Y?(je="Deze bunker hoort bij Festung IJmuiden, een van de zwaarst verdedigde punten van de Atlantikwall. De Duitsers bouwden hier bunkers om de haventoegang te beschermen. Er zijn nu rondleidingen door het Bunkermuseum.",He="https://www.bunkermuseum.nl/",Je="Bunkermuseum IJmuiden"):K?(je="Deze bunker maakt deel uit van de Atlantikwall bij Hoek van Holland. Dit was een strategisch punt voor de Duitsers vanwege de Nieuwe Waterweg. Veel bunkers zijn nog te bezoeken.",He="https://www.atlantikwallhoekvanholland.nl/",Je="Atlantikwall Hoek van Holland"):q?(je="Deze bunker hoort bij de Atlantikwall in Zeeland. De Duitsers verdedigden hier de Westerschelde en de kust. Bij Zoutelande en Westkapelle zijn veel bunkers bewaard gebleven.",He="https://www.bunkermuseumzoutelande.nl/",Je="Bunkermuseum Zoutelande"):An?(je="Deze bunker maakt deel uit van de Atlantikwall: de Duitse verdedigingslinie langs de hele kust van Europa. In Nederland bouwden de Duitsers duizenden bunkers tussen 1942 en 1944.",He="https://nl.wikipedia.org/wiki/Atlantikwall",Je="Atlantikwall (Wikipedia)"):J?(je="Deze bunker hoort mogelijk bij de Grebbelinie of de Nieuwe Hollandse Waterlinie. Dit waren Nederlandse verdedigingslinies die de Duitsers na 1940 versterkten met bunkers.",He="https://nl.wikipedia.org/wiki/Grebbelinie",Je="Grebbelinie (Wikipedia)"):(je="Een bunker uit de Tweede Wereldoorlog. De meeste bunkers in Nederland zijn gebouwd tussen 1940 en 1944, als onderdeel van de Duitse verdediging of langs bestaande Nederlandse linies.",He="https://nl.wikipedia.org/wiki/Atlantikwall",Je="WOII bunkers (Wikipedia)")}else je="Een bunker uit de Tweede Wereldoorlog.",He="https://nl.wikipedia.org/wiki/Atlantikwall",Je="WOII bunkers (Wikipedia)";W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${je}</div>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je vinden?</span></div>',W+='<div class="text-sm text-gray-700 mt-1">Bij bunkers worden soms voorwerpen gevonden zoals patronen, uniformknopen, gespen en persoonlijke spullen van soldaten.</div>',W+='<div class="mt-2 text-xs text-gray-500 italic">Let op: betreed nooit een bunker zonder toestemming. Raak munitieresten niet aan.</div>',W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bronnen</span></div>',W+='<div class="text-sm text-gray-700 mt-1">',W+=`<a href="${He}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">${Je}</a>`,N.website?W+=`<br/><a href="${N.website}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">TracesOfWar</a>`:W+='<br/><a href="https://www.tracesofwar.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">TracesOfWar</a>',W+="</div>"}if(N.historic==="battlefield"){const ee=N.name||"Onbekend slagveld",he={"Slag om Arnhem":{periode:"September 1944",samenvatting:"De Slag om Arnhem was onderdeel van Operatie Market Garden. Geallieerde parachutisten probeerden de brug over de Rijn te veroveren. Na negen dagen hevige gevechten moesten ze zich terugtrekken. Van de 10.000 Britse soldaten werden er 1.500 gedood en 6.500 krijgsgevangen gemaakt.",watZieJe:"Er zijn veel monumenten en infoborden. Het Airborne Museum in Oosterbeek vertelt het hele verhaal. Elk jaar in september is er een herdenking.",uitkomst:"De geallieerden verloren de slag. Nederland bleef nog tot mei 1945 bezet.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_om_Arnhem"},"Slag om de Sloedam":{periode:"1-2 november 1944",samenvatting:"Canadese soldaten vielen de Sloedam aan om Walcheren te bevrijden. De dam was smal en de Duitsers verdedigden fel. Veel soldaten sneuvelden bij deze bloedige aanval.",watZieJe:"Bij de dam staat een monument voor de gevallen Canadezen. Er zijn infoborden die de slag uitleggen.",uitkomst:"De Canadezen wonnen na zware verliezen. Dit opende de weg naar de bevrijding van Walcheren.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_om_de_Sloedam"},"Slag bij Heiligerlee (1568)":{periode:"23 mei 1568",samenvatting:"De eerste veldslag van de Tachtigjarige Oorlog. Lodewijk van Nassau versloeg het Spaanse leger. Zijn broer Adolf sneuvelde tijdens de strijd.",watZieJe:"In Heiligerlee staat het Slag bij Heiligerlee monument. Het klooster waar Adolf van Nassau begraven ligt is nog te bezoeken.",uitkomst:"De opstandelingen wonnen, maar dit was pas het begin van 80 jaar oorlog.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_bij_Heiligerlee_(1568)"},Overloon:{periode:"Oktober 1944",samenvatting:"Bij Overloon vochten Britten en Amerikanen tegen de Duitsers. Het was een van de zwaarste tankgevechten op Nederlandse bodem. Het dorp werd volledig verwoest.",watZieJe:"Het Oorlogsmuseum Overloon staat op het voormalige slagveld. Je kunt tanks, vliegtuigen en andere voertuigen zien.",uitkomst:"De geallieerden wonnen na wekenlange gevechten.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_om_Overloon"},"Slagveld Lanakerveld":{periode:"1568",samenvatting:"Onderdeel van de Nederlandse opstand tegen Spanje. Hier vonden gevechten plaats tijdens de beginjaren van de Tachtigjarige Oorlog.",watZieJe:"Het gebied is nu grotendeels landbouwgrond. Lokaal zijn er soms infoborden.",uitkomst:"Onderdeel van de lange strijd tegen de Spaanse overheersing.",wikiUrl:"https://nl.wikipedia.org/wiki/Tachtigjarige_Oorlog"},Blessebrugschans:{periode:"Diverse periodes",samenvatting:"Een historische schans die meerdere keren werd gebruikt in militaire conflicten.",watZieJe:"De resten van de schans zijn nog zichtbaar in het landschap.",uitkomst:"De schans speelde een rol in verschillende conflicten.",wikiUrl:"https://nl.wikipedia.org/wiki/Schans_(vestingwerk)"}}[ee];if(ee!=="Onbekend slagveld"&&ee!=="Historisch slagveld"&&(W+=`<br/><span class="text-sm font-semibold text-red-700">${ee}</span>`),he)W+=`<br/><span class="text-xs text-gray-500">${he.periode}</span>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat gebeurde hier?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${he.samenvatting}</div>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe liep het af?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${he.uitkomst}</div>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je zien?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${he.watZieJe}</div>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bronnen</span></div>',W+='<div class="text-sm text-gray-700 mt-1">',W+=`<a href="${he.wikiUrl}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a>`,ee.includes("Arnhem")&&(W+='<br/><a href="https://www.airbornemuseum.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Airborne Museum Oosterbeek</a>'),ee.includes("Overloon")&&(W+='<br/><a href="https://www.oorlogsmuseum.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Oorlogsmuseum Overloon</a>'),W+="</div>";else if(N.date&&(W+=`<br/><span class="text-xs text-gray-500">${N.date}</span>`),N.description?(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat gebeurde hier?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${N.description}</div>`):(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat gebeurde hier?</span></div>',W+='<div class="text-sm text-gray-700 mt-1">Op deze plek vonden historische gevechten plaats. Zoek lokaal naar infoborden of monumenten.</div>'),N.wikipedia){const Ce=N.wikipedia.startsWith("http")?N.wikipedia:`https://nl.wikipedia.org/wiki/${N.wikipedia.replace("nl:","")}`;W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bronnen</span></div>',W+=`<div class="text-sm text-gray-700 mt-1"><a href="${Ce}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`}}if(N.bron==="Paleobiology Database"){const ee=je=>{const He={Mollusca:"weekdieren zoals schelpen en slakken",Brachiopoda:"armpotigen, schelp-achtige dieren",Echinodermata:"stekelhuidigen zoals zee-egels en zeesterren",Chordata:"gewervelde dieren",Arthropoda:"geleedpotigen zoals kreeften en trilobieten",Cnidaria:"neteldieren zoals koralen en kwallen",Bryozoa:"mosdiertjes",Foraminifera:"eencellige schelpdieren",Plantae:"planten",Crinoidea:"zeelelies",Gastropoda:"slakken",Bivalvia:"tweekleppigen zoals mossels en oesters",Cephalopoda:"koppotigen zoals inktvissen en ammonieten",Trilobita:"trilobieten, uitgestorven kreeftachtigen",Mammalia:"zoogdieren",Reptilia:"reptielen",Pisces:"vissen",Amphibia:"amfibien"};for(const[Je,Qe]of Object.entries(He))if(je.toLowerCase().includes(Je.toLowerCase()))return Qe;return""},ne=je=>{const He={Cambrium:"541-485 miljoen jaar geleden",Ordovicium:"485-444 miljoen jaar geleden",Siluur:"444-419 miljoen jaar geleden",Devoon:"419-359 miljoen jaar geleden",Carboon:"359-299 miljoen jaar geleden",Perm:"299-252 miljoen jaar geleden",Trias:"252-201 miljoen jaar geleden",Jura:"201-145 miljoen jaar geleden",Krijt:"145-66 miljoen jaar geleden",Paleogeen:"66-23 miljoen jaar geleden",Neogeen:"23-2,6 miljoen jaar geleden",Kwartair:"2,6 miljoen jaar - nu",Pleistoceen:"2,6 miljoen - 11.700 jaar geleden",Holoceen:"11.700 jaar geleden - nu"};for(const[Je,Qe]of Object.entries(He))if(je.toLowerCase().includes(Je.toLowerCase()))return Qe;return""},he=je=>{const He={limestone:"kalksteen",sandstone:"zandsteen",shale:"schalie",clay:"klei",sand:"zand",gravel:"grind",marl:"mergel",chalk:"krijt",mudstone:"moddersteen",siltstone:"siltsteen"};let Je=je;for(const[Qe,xt]of Object.entries(He))Je=Je.replace(new RegExp(Qe,"gi"),xt);return Je},Ce=je=>{const He={marine:"zee",coastal:"kust",terrestrial:"land",fluvial:"rivier",lacustrine:"meer",reef:"rif",deltaic:"delta",shallow:"ondiep water",deep:"diep water"};let Je=je;for(const[Qe,xt]of Object.entries(He))Je=Je.replace(new RegExp(Qe,"gi"),xt);return Je};if(N.vindplaats&&(W+=`<br/><span class="text-xs text-gray-600">${N.vindplaats}</span>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is hier gevonden?</span></div>',N.taxonomie&&N.taxonomie!=="Onbekend"){const je=ee(N.taxonomie);je?(W+=`<div class="text-sm text-gray-700 mt-1">${je}</div>`,W+=`<div class="text-xs text-gray-500 italic">(${N.taxonomie})</div>`):W+=`<div class="text-sm text-gray-700 mt-1">${N.taxonomie}</div>`}if(N.aantal_fossielen){const je=parseInt(N.aantal_fossielen),He=je>100?"Veel fossielen gevonden op deze locatie.":je>10?"Meerdere fossielen gevonden op deze locatie.":`${N.aantal_fossielen} fossiel${je>1?"en":""} gevonden op deze locatie.`;W+=`<div class="text-sm text-gray-600 mt-1">${He}</div>`}if(N.periode&&N.periode!=="Onbekend"){W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wanneer leefden deze dieren?</span></div>';const je=ne(N.periode);W+=`<div class="text-sm text-gray-700 mt-1">${N.periode}</div>`,je&&(W+=`<div class="text-sm text-gray-600">${je}</div>`),N.ouderdom&&N.ouderdom!=="Onbekend"&&(W+=`<div class="text-sm text-gray-600">Ouderdom: ${N.ouderdom}</div>`)}(N.gesteente||N.formatie||N.milieu)&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">In wat voor gesteente?</span></div>',N.gesteente&&(W+=`<div class="text-sm text-gray-700 mt-1">${he(N.gesteente)}</div>`),N.formatie&&(W+=`<div class="text-sm text-gray-600">Formatie: ${N.formatie}</div>`,N.lid&&(W+=`<div class="text-sm text-gray-600 ml-3">Lid: ${N.lid}</div>`)),N.milieu&&(W+=`<div class="text-sm text-gray-600">Leefomgeving: ${Ce(N.milieu)}</div>`))}if(N.layerType==="fossielHotspot"){const ee=[];if(N.type&&ee.push(N.type),N.region&&ee.push(N.region),N.country){const ne={NL:"Nederland",BE:"Belgi",DE:"Duitsland",FR:"Frankrijk"};ee.push(ne[N.country]||N.country)}if(ee.length>0&&(W+=`<br/><span class="text-xs text-gray-600">${ee.join("  ")}</span>`),(N.finds||N.period)&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kan ik er vinden?</span></div>',N.finds&&(W+=`<div class="text-sm text-gray-700 mt-1">${N.finds}</div>`),N.period&&(W+=`<div class="text-sm text-gray-600 mt-1">Periode: ${N.period}</div>`),N.geology&&(W+=`<div class="text-sm text-gray-600 mt-1">Geologie: ${N.geology}</div>`)),N.access||N.tips){if(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe kom ik er?</span></div>',N.access){const he=N.access.toLowerCase().includes("verboden")||N.access.toLowerCase().includes("niet toegankelijk")?"text-red-600":"text-gray-700";W+=`<div class="text-sm ${he} mt-1">${N.access}</div>`}N.tips&&(W+=`<div class="text-sm text-gray-600 mt-1 italic">Tip: ${N.tips}</div>`)}}if(N.layerType==="mineralenHotspot"){const ee=[];if(N.region&&ee.push(N.region),N.country){const ne={NL:"Nederland",BE:"Belgi",DE:"Duitsland",FR:"Frankrijk"};ee.push(ne[N.country]||N.country)}if(ee.length>0&&(W+=`<br/><span class="text-xs text-gray-600">${ee.join("  ")}</span>`),N.minerals&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kan ik er vinden?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${N.minerals}</div>`,N.geology&&(W+=`<div class="text-sm text-gray-600 mt-1">Geologie: ${N.geology}</div>`)),N.access||N.tips){if(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe kom ik er?</span></div>',N.access){const he=N.access.toLowerCase().includes("verboden")||N.access.toLowerCase().includes("niet toegankelijk")||N.access.toLowerCase().includes("gesloten")?"text-red-600":"text-gray-700";W+=`<div class="text-sm ${he} mt-1">${N.access}</div>`}N.tips&&(W+=`<div class="text-sm text-gray-600 mt-1 italic">Tip: ${N.tips}</div>`)}}if(N.layerType==="goudrivier"){const ee=[];if(N.river&&ee.push(N.river),N.region&&ee.push(N.region),N.country){const ne={NL:"Nederland",BE:"Belgi",DE:"Duitsland",FR:"Frankrijk"};ee.push(ne[N.country]||N.country)}if(ee.length>0&&(W+=`<br/><span class="text-xs text-gray-600">${ee.join("  ")}</span>`),(N.goldType||N.origin)&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kan ik er vinden?</span></div>',N.goldType&&(W+=`<div class="text-sm text-gray-700 mt-1">${N.goldType}</div>`),N.origin&&(W+=`<div class="text-sm text-gray-600 mt-1">Herkomst: ${N.origin}</div>`)),N.legal||N.tips){if(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Mag ik hier zoeken?</span></div>',N.legal){const he=N.legal.includes("VERBODEN")?"text-red-600 font-semibold":"text-gray-700";W+=`<div class="text-sm ${he} mt-1">${N.legal}</div>`}N.tips&&(W+=`<div class="text-sm text-gray-600 mt-1 italic">Tip: ${N.tips}</div>`)}}if(N.layerType==="wandelroute"){const ee=[];if(N.region&&ee.push(N.region),N.country){const ne={NL:"Nederland",BE:"Belgi"};ee.push(ne[N.country]||N.country)}if(ee.length>0&&(W+=`<br/><span class="text-xs text-gray-600">${ee.join("  ")}</span>`),N.distance||N.duration){const ne=N.distance?`${N.distance} km`:"",he=N.duration?`${N.duration}`:"",Ce=[ne,he].filter(Boolean).join("  ");Ce&&(W+=`<br/><span class="text-sm text-green-700 font-medium">${Ce}</span>`)}(N.description||N.highlights)&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat ga je zien?</span></div>',N.description&&(W+=`<div class="text-sm text-gray-700 mt-1">${N.description}</div>`),N.highlights&&(W+=`<div class="text-sm text-gray-600 mt-1">Hoogtepunten: ${N.highlights}</div>`)),N.startAddress&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Waar begin ik?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${N.startAddress}</div>`),N.url&&(W+=`<div class="mt-3"><a href="${N.url}" target="_blank" class="text-sm text-blue-600 hover:underline">Bekijk route en download GPX</a></div>`)}if(N.layerType==="hunebed"){N.period&&(W+=`<br/><span class="text-sm text-purple-700">Periode: ${N.period}</span>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',N.description&&(W+=`<div class="text-sm text-gray-700 mt-1">${N.description}</div>`);const ee=[];if(N.stones){const ne=N.stones.toLowerCase(),he=ne.match(/(\d+)\s*dekst[^\s,]*/i),Ce=ne.match(/(\d+)\s*draagst[^\s,]*/i),je=ne.match(/(\d+)\s*sluitst[^\s,]*/i),He=ne.match(/(\d+)\s*poortst[^\s,]*/i),Je=ne.match(/(\d+)\s*gangdekst[^\s,]*/i),Qe=ne.match(/(\d+)\s*gangzijst[^\s,]*/i);he&&ee.push(`${he[1]} deksteen${parseInt(he[1])>1?"en":""} (de grote steen${parseInt(he[1])>1?"en":""} bovenop)`),Ce&&ee.push(`${Ce[1]} draagstenen (de stenen die de dekstenen dragen)`),je&&ee.push(`${je[1]} sluitsteen${parseInt(je[1])>1?"en":""} (afsluiting aan de korte zijden)`),He&&ee.push(`${He[1]} poortsteen${parseInt(He[1])>1?"en":""} (bij de ingang)`),Je&&ee.push(`${Je[1]} gangdeksteen${parseInt(Je[1])>1?"en":""} (boven de toegangsgang)`),Qe&&ee.push(`${Qe[1]} gangzijstenen (langs de toegangsgang)`)}if(N.length&&ee.push(`Een grafkamer van ${N.length} lang`),N.width&&ee.push(`${N.width}`),ee.length>0&&(W+='<div class="text-sm text-gray-700 mt-1">Het hunebed heeft:</div>',W+='<ul class="list-disc list-inside text-sm text-gray-700 mt-1 space-y-0.5">',ee.forEach(ne=>{W+=`<li>${ne}</li>`}),W+="</ul>"),N.notable){const ne=N.notable.toLowerCase();let he="Wat is hier bijzonder?";ne.includes("grootste")?he="Waarom is dit het grootste hunebed?":ne.includes("klein")||ne.includes("kindhunebed")?he="Waarom is dit hunebed zo klein?":ne.includes("cluster")||ne.includes("naast elkaar")?he="Waarom liggen hier meerdere hunebedden?":(ne.includes("enige")||ne.includes("westelijk")||ne.includes("noordelijk"))&&(he="Wat maakt deze locatie bijzonder?"),W+=`<div class="mt-3"><span class="text-sm font-semibold text-gray-800">${he}</span></div>`,W+=`<div class="text-sm text-gray-700 mt-1">${N.notable}</div>`}W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is de Trechterbeker cultuur?</span></div>',W+='<div class="text-sm text-gray-700 mt-1">De Trechterbeker cultuur is de naam voor de mensen die 5.000 jaar geleden in Nederland woonden. Ze maakten potten met een trechter-vorm. Daarom heten ze zo. Deze mensen bouwden de hunebedden als graven voor hun doden.</div>',N.finds&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is hier gevonden?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${N.finds}</div>`),N.museum&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Museum in de buurt</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${N.museum}</div>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bezoeken</span></div>',N.access?W+=`<div class="text-sm text-gray-700 mt-1">${N.access}</div>`:W+='<div class="text-sm text-gray-700 mt-1">Je kunt dit hunebed gratis bezoeken.</div>',N.wikipedia&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">Lees meer op <a href="${N.wikipedia}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`)}if((N.inventarisnummer||N.locatie_naam)&&(N.locatie_naam&&(W+=`<br/><span class="text-sm font-semibold">${N.locatie_naam}</span>`),N.inventarisnummer&&(W+=`<br/><span class="text-xs text-gray-500">CAI: ${N.inventarisnummer}</span>`),N.datering_tekst&&(W+=`<br/><span class="text-sm text-purple-700">${N.datering_tekst}</span>`)),(N.veensoort||N.dikte)&&(N.veensoort&&(W+=`<br/><span class="text-sm text-amber-700">${N.veensoort}</span>`),N.dikte&&(W+=`<br/><span class="text-xs text-gray-600">Dikte: ${N.dikte}</span>`)),N.nature&&N.debut){W+=`<br/><span class="text-sm text-purple-700">${N.nature}</span>`;const ee=N.debut===N.fin?N.debut:`${N.debut} - ${N.fin}`;ee&&(W+=`<br/><span class="text-sm text-gray-700">Periode: ${ee}</span>`),N.structure&&(W+=`<br/><span class="text-xs text-gray-600">${N.structure}</span>`),N.commune&&(W+=`<br/><span class="text-xs text-gray-500">${N.commune}</span>`),N.decouvert&&(W+=`<br/><span class="text-xs text-gray-400">Ontdekt: ${N.decouvert}</span>`),N.numero&&(W+=`<br/><span class="text-xs text-gray-400">${N.numero}</span>`)}if((N.NATURE_OPE||N.CODE_OPERA)&&(N.TITRE&&(W+=`<br/><span class="text-sm font-semibold">${N.TITRE}</span>`),N.NATURE_OPE&&(W+=`<br/><span class="text-sm text-amber-700">${N.NATURE_OPE}</span>`),N.AUTEUR&&(W+=`<br/><span class="text-xs text-gray-600">Auteur: ${N.AUTEUR}</span>`),N.DATE&&(W+=`<br/><span class="text-xs text-gray-500">Datum: ${N.DATE}</span>`),N.COMMUNE&&(W+=`<br/><span class="text-xs text-gray-500">${N.COMMUNE}</span>`)),N.type_protection&&(N.n_site||N.t_site)){const ee=N.type_protection==="Classe"?"text-red-700":"text-amber-700";W+=`<br/><span class="text-sm ${ee}">${N.type_protection}</span>`,N.n_site&&(W+=`<br/><span class="text-sm font-semibold">${N.n_site}</span>`),N.t_site&&(W+=`<br/><span class="text-xs text-gray-600">${N.t_site}</span>`),N.c_site&&(W+=`<br/><span class="text-xs text-gray-500">Code: ${N.c_site}</span>`),N.d_creation&&(W+=`<br/><span class="text-xs text-gray-400">Beschermd sinds: ${N.d_creation}</span>`)}if(N.type_protection&&N.cod_diren){const ee=N.type_protection==="Classe"?"text-red-700":"text-amber-700";if(W+=`<br/><span class="text-sm ${ee}">${N.type_protection}</span>`,N.proced&&(W+=`<br/><span class="text-xs text-gray-600">${N.proced}</span>`),N.d_proced&&(W+=`<br/><span class="text-xs text-gray-500">Date: ${N.d_proced}</span>`),N.comment){const ne=String(N.comment).slice(0,150);W+=`<br/><span class="text-xs text-gray-600 italic">${ne}${String(N.comment).length>150?"...":""}</span>`}}if(N.type_protection&&N.nomsite){const ee=N.type_protection==="Classe"?"text-red-700":"text-amber-700";if(W+=`<br/><span class="text-sm ${ee}">${N.type_protection}</span>`,N.caractere&&(W+=`<br/><span class="text-xs text-gray-600">${N.caractere}</span>`),N.datedecis&&(W+=`<br/><span class="text-xs text-gray-500">Date: ${N.datedecis}</span>`),N.descriptio){const ne=String(N.descriptio).slice(0,150);W+=`<br/><span class="text-xs text-gray-600 italic">${ne}${String(N.descriptio).length>150?"...":""}</span>`}}if(N.secteur&&N.style){if(W+=`<br/><span class="text-sm text-gray-700">${N.secteur}</span>`,N["sous-secteur"]&&(W+=`<br/><span class="text-xs text-gray-600">${N["sous-secteur"]}</span>`),N.description){const ee=String(N.description).slice(0,150);W+=`<br/><span class="text-xs text-gray-600 italic">${ee}${String(N.description).length>150?"...":""}</span>`}N.url&&(W+=`<br/><a href="${N.url}" target="_blank" class="text-xs text-blue-600 hover:underline">Meer info</a>`)}if(N.nature_operation||N.synthese){N.nature_operation&&(W+=`<br/><span class="text-sm text-red-700">${N.nature_operation}</span>`),N.responsable_operation&&(W+=`<br/><span class="text-xs text-gray-600">Responsable: ${N.responsable_operation}</span>`),N.date_operation&&(W+=`<br/><span class="text-xs text-gray-500">Datum: ${N.date_operation}</span>`);const ee=[];if(N.prehistoire==="Oui"&&ee.push("Prehistorie"),N.protohistoire==="Oui"&&ee.push("Protohistorie"),N.antiquite==="Oui"&&ee.push("Romeins"),N.moyen_age==="Oui"&&ee.push("Middeleeuwen"),N.temps_modernes==="Oui"&&ee.push("Moderne tijd"),ee.length>0&&(W+=`<br/><span class="text-sm text-purple-700">${ee.join(", ")}</span>`),N.adresse&&(W+=`<br/><span class="text-xs text-gray-500">${N.adresse}</span>`),N.synthese){const ne=String(N.synthese).slice(0,200);W+=`<br/><span class="text-xs text-gray-600 italic">${ne}${String(N.synthese).length>200?"...":""}</span>`}}if(N.operator&&(W+=`<br/><span class="text-sm text-gray-600">${N.operator}</span>`),N.opening_hours){const ee=YTe(String(N.opening_hours));W+=`<br/><span class="text-xs text-green-600">Open: ${ee}</span>`}if(N.website&&(W+=`<br/><a href="${N.website}" target="_blank" class="text-xs text-blue-600 underline">Website</a>`),N.addr_street){const ee=[N.addr_street,N.addr_housenumber,N.addr_postcode].filter(Boolean).join(" ");W+=`<br/><span class="text-xs text-gray-500">${ee}</span>`}const re=N.description||N.omschrijving||N.descr||N.info;re&&re!==ut&&(W+=`<br/><span class="text-sm text-gray-600">${re}</span>`),sn.push(W),Nt.push({geometry:qi(Ft),properties:N,popupHtml:W})}const nn=n.getView().getResolution()||1,Sr=await pn(Tt.coordinate,nn);sn.push(...Sr);for(const xe of Sr)Nt.push(null);const De=await Nr;if(sn.length===0&&De!==null){const xe=`<strong class="text-blue-800">Terrein</strong>
          <br/><div class="mt-2 pt-2 border-t border-gray-100 flex items-center gap-1">
            <span class="text-xs text-gray-400">Hoogte:</span>
            <span class="text-sm font-medium text-blue-600">${De.toFixed(2)} m NAP</span>
          </div>`;sn.push(xe),Nt.push(null)}if(sn.length>0&&De!==null&&(sn[0]+=`<br/><div class="mt-2 pt-2 border-t border-gray-100 flex items-center gap-1">
          <span class="text-xs text-gray-400">Hoogte:</span>
          <span class="text-sm font-medium text-blue-600">${De.toFixed(2)} m NAP</span>
        </div>`),sn.length>0){l(sn),te(Nt),h(0),console.log(` KLIK OPGESLAGEN: [${Tt.coordinate[0].toFixed(0)}, ${Tt.coordinate[1].toFixed(0)}]`),x(Tt.coordinate),w(!1),U(!1),be(!1),V(""),Ee(null);const xe=En(Tt.coordinate);Be(xe),I(`https://www.google.com/maps/dir/?api=1&destination=${xe[1]},${xe[0]}`),D(`https://www.google.com/maps/@?api=1&map_action=pano&viewpoint=${xe[1]},${xe[0]}`),m(!0)}};return n.on("click",Rn),()=>{n.un("click",Rn)}},[n]);const Tr=()=>{m(!1),ye("half"),n&&_&&(KR(n),w(!1))},oi=(_t,pn)=>{const Rn=pn.velocity.y,Tt=pn.offset.y;Ge==="half"?Tt<-50||Rn<-500?ye("full"):(Tt>100||Rn>500)&&Tr():(Tt>50||Rn>300)&&ye("half")};return g.jsx($n,{children:f&&g.jsxs(g.Fragment,{children:[g.jsx(Rt.div,{className:"fixed inset-0 z-[1500]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:Tr}),g.jsxs(Rt.div,{className:"fixed bottom-0 left-0 right-0 z-[1501] bg-white rounded-t-2xl shadow-2xl overflow-hidden flex flex-col",style:{fontSize:`${14*ue/100}px`,height:Ge==="full"?"90vh":"auto",maxHeight:Ge==="full"?"90vh":"50vh"},initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",damping:25,stiffness:300},drag:"y",dragConstraints:{top:0,bottom:0},dragElastic:.3,onDragEnd:oi,children:[g.jsx("div",{className:"flex justify-center pt-2 pb-1 cursor-grab active:cursor-grabbing",onClick:()=>ye(Ge==="half"?"full":"half"),children:g.jsx("div",{className:"w-10 h-1 bg-gray-300 rounded-full"})}),g.jsxs("div",{className:"flex items-center gap-2 px-3 pb-2 border-b border-gray-100",children:[wt&&g.jsxs("div",{className:"flex items-center gap-0.5 flex-shrink-0",children:[g.jsx("button",{onClick:cn,className:"p-1 text-blue-500 hover:text-blue-600 transition-colors border-0 outline-none bg-transparent","aria-label":"Vorige laag",children:g.jsx($le,{size:18})}),g.jsxs("span",{className:"text-gray-500 font-medium min-w-[32px] text-center",style:{fontSize:"0.857em"},children:[c+1,"/",o.length]}),g.jsx("button",{onClick:sr,className:"p-1 text-blue-500 hover:text-blue-600 transition-colors border-0 outline-none bg-transparent","aria-label":"Volgende laag",children:g.jsx(Jy,{size:18})})]}),g.jsx("span",{className:"flex-1 font-semibold text-gray-800 truncate",style:{fontSize:"1em"},children:Kt||"Info"}),ke&&g.jsxs("div",{className:"relative",children:[g.jsx("button",{onClick:()=>U(!L),className:`p-1.5 transition-colors flex-shrink-0 border-0 outline-none bg-transparent ${j?"text-green-500":"text-orange-500 hover:text-orange-600"}`,title:"Toevoegen aan mijn laag","aria-label":"Toevoegen aan mijn laag",children:j?g.jsx(uc,{size:18}):g.jsx(Xa,{size:18})}),L&&g.jsxs("div",{className:"absolute right-0 top-full mt-1 z-50 bg-white rounded-lg shadow-lg border border-gray-200 py-1 min-w-[180px] max-w-[220px]",children:[g.jsx("div",{className:"px-3 py-1 text-xs text-gray-400 font-medium",children:"Toevoegen aan:"}),g.jsx("div",{className:"max-h-[200px] overflow-y-auto",children:i.filter(_t=>!_t.archived).map(_t=>g.jsxs("button",{onClick:()=>{const pn=ie;s(_t.id,{name:Kt||"Punt",category:"Overig",notes:"",url:void 0,coordinates:[ke[0],ke[1]],sourceLayer:Kt,geometry:pn?.geometry,sourceProperties:pn?.properties,popupContent:pn?.popupHtml}),U(!1),Ee(_t.name),setTimeout(()=>Ee(null),2e3)},className:"w-full px-3 py-1.5 text-left text-sm text-gray-700 hover:bg-blue-50 border-0 outline-none bg-transparent flex items-center gap-2",children:[g.jsx("span",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{backgroundColor:_t.color}}),g.jsx("span",{className:"truncate",children:_t.name})]},_t.id))}),g.jsx("div",{className:"border-t border-gray-100 mt-1 pt-1",children:Pe?g.jsxs("div",{className:"px-2 py-1",children:[g.jsx("input",{type:"text",value:se,onChange:_t=>V(_t.target.value),placeholder:"Naam nieuwe laag...",className:"w-full px-2 py-1 text-sm border border-gray-200 rounded focus:outline-none focus:border-orange-400",autoFocus:!0,onKeyDown:_t=>{if(_t.key==="Enter"&&se.trim()){const pn=a(se.trim()),Rn=ie;s(pn,{name:Kt||"Punt",category:"Overig",notes:"",url:void 0,coordinates:[ke[0],ke[1]],sourceLayer:Kt,geometry:Rn?.geometry,sourceProperties:Rn?.properties,popupContent:Rn?.popupHtml}),U(!1),be(!1),V(""),Ee(se.trim()),setTimeout(()=>Ee(null),2e3)}else _t.key==="Escape"&&(be(!1),V(""))}}),g.jsxs("div",{className:"flex gap-1 mt-1",children:[g.jsx("button",{onClick:()=>{if(se.trim()){const _t=a(se.trim()),pn=ie;s(_t,{name:Kt||"Punt",category:"Overig",notes:"",url:void 0,coordinates:[ke[0],ke[1]],sourceLayer:Kt,geometry:pn?.geometry,sourceProperties:pn?.properties,popupContent:pn?.popupHtml}),U(!1),be(!1),V(""),Ee(se.trim()),setTimeout(()=>Ee(null),2e3)}},disabled:!se.trim(),className:"flex-1 px-2 py-1 text-xs bg-orange-500 text-white rounded disabled:opacity-50",children:"Toevoegen"}),g.jsx("button",{onClick:()=>{be(!1),V("")},className:"px-2 py-1 text-xs text-gray-500 hover:text-gray-700",children:"Annuleer"})]})]}):g.jsxs("button",{onClick:()=>be(!0),className:"w-full px-3 py-1.5 text-left text-sm text-orange-600 hover:bg-orange-50 border-0 outline-none bg-transparent flex items-center gap-2",children:[g.jsx(Xa,{size:14}),g.jsx("span",{children:"Nieuwe laag maken..."})]})})]})]}),P&&g.jsx("a",{href:P,target:"_blank",rel:"noopener noreferrer",className:"p-1.5 text-amber-500 hover:text-amber-600 transition-colors flex-shrink-0",title:"Open Street View","aria-label":"Open Street View",children:g.jsx(vV,{size:18})}),A&&g.jsx("a",{href:A,target:"_blank",rel:"noopener noreferrer",className:"p-1.5 text-blue-500 hover:text-blue-600 transition-colors flex-shrink-0",title:"Navigeer naar locatie","aria-label":"Open in Google Maps",children:g.jsx(Iu,{size:18})}),g.jsx("button",{onClick:Tr,className:"p-1.5 text-gray-400 hover:text-gray-600 transition-colors flex-shrink-0 border-0 outline-none bg-transparent","aria-label":"Sluiten",children:g.jsx(si,{size:18})})]}),g.jsx("div",{className:`px-4 py-3 overflow-y-auto select-text min-h-0 ${Ge==="full"?"flex-1":""}`,style:{userSelect:"text",WebkitUserSelect:"text"},dangerouslySetInnerHTML:{__html:ot}}),g.jsxs("div",{className:"px-4 py-2 border-t border-gray-100 flex items-center gap-2 flex-shrink-0",children:[g.jsx(EV,{size:14,className:"text-gray-400 flex-shrink-0"}),g.jsx("input",{type:"range",min:"80",max:"150",value:ue,onChange:_t=>pe(parseInt(_t.target.value)),className:"flex-1 h-1.5 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500"}),g.jsxs("span",{className:"text-gray-400 w-8 text-right",style:{fontSize:"0.857em"},children:[ue,"%"]})]}),hn&&R&&!O&&g.jsxs("div",{className:"px-4 pb-4 flex gap-2 flex-shrink-0",children:[g.jsxs("button",{onClick:()=>{const _t=r.find(pn=>pn.id===R);_t&&G(_t)},className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-white bg-blue-500 hover:bg-blue-600 rounded-lg transition-colors border-0 outline-none",children:[g.jsx(rg,{size:16}),g.jsx("span",{children:"Bewerken"})]}),g.jsxs("button",{onClick:()=>{e(R),m(!1),M(null)},className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-white bg-red-500 hover:bg-red-600 rounded-lg transition-colors border-0 outline-none",children:[g.jsx(xc,{size:16}),g.jsx("span",{children:"Verwijderen"})]})]}),O&&g.jsxs("div",{className:"px-4 pb-4 space-y-3 border-t border-gray-100 pt-3 flex-shrink-0 overflow-y-auto max-h-[40vh]",children:[g.jsx("div",{className:"text-sm font-medium text-blue-600",children:"Vondst bewerken"}),g.jsxs("div",{children:[g.jsx("label",{className:"text-xs text-gray-500",children:"Objecttype"}),g.jsx("input",{type:"text",value:O.objectType,onChange:_t=>G({...O,objectType:_t.target.value}),className:"w-full px-2 py-1 text-sm bg-gray-50 rounded border-0 outline-none focus:bg-blue-50"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"text-xs text-gray-500",children:"Materiaal"}),g.jsx("input",{type:"text",value:O.material,onChange:_t=>G({...O,material:_t.target.value}),className:"w-full px-2 py-1 text-sm bg-gray-50 rounded border-0 outline-none focus:bg-blue-50"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"text-xs text-gray-500",children:"Periode"}),g.jsx("input",{type:"text",value:O.period,onChange:_t=>G({...O,period:_t.target.value}),className:"w-full px-2 py-1 text-sm bg-gray-50 rounded border-0 outline-none focus:bg-blue-50"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"text-xs text-gray-500",children:"Notities"}),g.jsx("textarea",{value:O.notes,onChange:_t=>G({...O,notes:_t.target.value}),className:"w-full px-2 py-1 text-sm bg-gray-50 rounded border-0 outline-none focus:bg-blue-50 resize-none h-16"})]}),g.jsxs("div",{className:"flex gap-2",children:[g.jsx("button",{onClick:()=>G(null),className:"flex-1 px-3 py-2 text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors border-0 outline-none text-sm",children:"Annuleren"}),g.jsx("button",{onClick:()=>{t(O.id,{objectType:O.objectType,material:O.material,period:O.period,notes:O.notes}),G(null),m(!1)},className:"flex-1 px-3 py-2 text-white bg-blue-500 hover:bg-blue-600 rounded-lg transition-colors border-0 outline-none text-sm",children:"Opslaan"})]})]}),tr&&y&&g.jsx("div",{className:"px-4 pb-4 border-t border-gray-100",children:_?g.jsxs("button",{onClick:Vn,className:"w-full flex items-center justify-center gap-2 px-3 py-2 mt-3 text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors border-0 outline-none",children:[g.jsx(ng,{size:16}),g.jsx("span",{children:"Hoogtekaart verbergen"})]}):g.jsx("button",{onClick:Ni,disabled:S,className:`w-full flex items-center justify-center gap-2 px-3 py-2 mt-3 text-white rounded-lg transition-colors border-0 outline-none ${S?"bg-blue-400 cursor-wait":"bg-blue-500 hover:bg-blue-600"}`,children:S?g.jsxs(g.Fragment,{children:[g.jsx(zC,{size:16,className:"animate-spin"}),g.jsx("span",{children:"Laden..."})]}):g.jsxs(g.Fragment,{children:[g.jsx(ng,{size:16}),g.jsx("span",{children:"Hoogtekaart tonen"})]})})})]})]})})}const dD=1e-4;function tSe(n,e){return n.points.some(t=>{const r=Math.abs(t.coordinates[0]-e[0]),i=Math.abs(t.coordinates[1]-e[1]);return r<dD&&i<dD})}function nSe(){const n=pi(D=>D.map),e=wr(D=>D.openVondstForm),{openAddPointModal:t,openCreateLayerModal:r,openLayerManagerModal:i}=wr(),s=hs(D=>D.layers),[a,o]=X.useState(null),[l,c]=X.useState(!1),[h,f]=X.useState(!1),[m,y]=X.useState(!1),x=X.useRef(null),_=X.useRef(null);X.useEffect(()=>{if(!n){console.log(" LongPressMenu: map not ready");return}const D=n.getViewport();if(!D){console.log(" LongPressMenu: viewport not ready");return}console.log(" LongPressMenu: attached to viewport",D);const L=600,U=15,j=be=>{if(console.log(" Touch start, touches:",be.touches.length),be.touches.length!==1)return;const se=be.touches[0];_.current={x:se.clientX,y:se.clientY},console.log(" Starting long press timer at:",_.current),x.current&&clearTimeout(x.current),x.current=window.setTimeout(()=>{if(console.log(" Timer fired! startPos:",_.current),!_.current)return;const V=window.__olMap;if(!V){console.log(" Map not available (global)");return}const Z=D.getBoundingClientRect(),te=[_.current.x-Z.left,_.current.y-Z.top],ie=V.getCoordinateFromPixel(te);if(ie){const ue=En(ie);be.preventDefault(),o({pixel:[_.current.x,_.current.y],coordinate:ue}),c(!0),f(!1),setTimeout(()=>f(!0),300),"vibrate"in navigator&&navigator.vibrate(50),console.log(" Long press detected at:",ue)}},L)},Ee=be=>{if(!x.current||!_.current)return;const se=be.touches[0],V=se.clientX-_.current.x,Z=se.clientY-_.current.y,te=Math.sqrt(V*V+Z*Z);te>U&&(console.log(" Touch moved too much, cancelling. Distance:",te),clearTimeout(x.current),x.current=null)},ke=()=>{console.log(" Touch end, timer active:",!!x.current),x.current&&(console.log(" Cancelling timer on touch end"),clearTimeout(x.current),x.current=null),_.current=null},Be=be=>{l&&be.preventDefault()},Me=be=>{be.button===0&&(console.log(" Mouse down"),_.current={x:be.clientX,y:be.clientY},x.current&&clearTimeout(x.current),x.current=window.setTimeout(()=>{if(console.log(" Mouse timer fired!"),!_.current)return;const se=window.__olMap;if(console.log(" __olMap:",se),console.log(" __olMap constructor:",se?.constructor?.name),console.log(" has getCoordinateAtPixel:",typeof se?.getCoordinateAtPixel),!se){console.log(" Map not available (global)");return}const V=D.getBoundingClientRect(),Z=[_.current.x-V.left,_.current.y-V.top];console.log(" Pixel:",Z);const te=se.getCoordinateFromPixel(Z);if(console.log(" Coordinate:",te),te){const ie=En(te);o({pixel:[_.current.x,_.current.y],coordinate:ie}),c(!0),f(!1),setTimeout(()=>f(!0),300),console.log(" Long press (mouse) detected at:",ie)}},L))},ce=be=>{if(!x.current||!_.current)return;const se=be.clientX-_.current.x,V=be.clientY-_.current.y;Math.sqrt(se*se+V*V)>U&&(console.log(" Mouse moved, cancelling"),clearTimeout(x.current),x.current=null)},Pe=()=>{console.log(" Mouse up"),x.current&&(clearTimeout(x.current),x.current=null),_.current=null};return D.addEventListener("touchstart",j,{passive:!1}),D.addEventListener("touchmove",Ee,{passive:!0}),D.addEventListener("touchend",ke),D.addEventListener("touchcancel",ke),D.addEventListener("contextmenu",Be),D.addEventListener("mousedown",Me),D.addEventListener("mousemove",ce),D.addEventListener("mouseup",Pe),D.addEventListener("mouseleave",Pe),()=>{D.removeEventListener("touchstart",j),D.removeEventListener("touchmove",Ee),D.removeEventListener("touchend",ke),D.removeEventListener("touchcancel",ke),D.removeEventListener("contextmenu",Be),D.removeEventListener("mousedown",Me),D.removeEventListener("mousemove",ce),D.removeEventListener("mouseup",Pe),D.removeEventListener("mouseleave",Pe),x.current&&clearTimeout(x.current)}},[n,l]);const w=()=>{h&&(c(!1),o(null),f(!1),y(!1))},S=()=>{c(!1),o(null),f(!1),y(!1)},b=D=>{if(!a)return;const[L,U]=a.coordinate;t(D,{lat:U,lng:L}),S()},R=()=>{r(),S()},M=()=>{if(!a)return;const[D,L]=a.coordinate;e({lat:L,lng:D}),c(!1),o(null),f(!1)},O=()=>{if(!a)return;const[D,L]=a.coordinate,U=`https://www.google.com/maps?q=${L},${D}`;window.open(U,"_blank"),c(!1),o(null),f(!1)},G=()=>{if(!a)return;const[D,L]=a.coordinate,U=`https://www.google.com/maps?layer=c&cbll=${L},${D}`;window.open(U,"_blank"),S()},A=()=>{if(!a)return;const D=document.createElement("input");D.type="file",D.accept="image/*",D.capture="environment",D.onchange=async L=>{const U=L.target.files?.[0];if(!U)return;const[j,Ee]=a.coordinate;e({lat:Ee,lng:j},U)},D.click(),S()},I=()=>{i(),S()},P=D=>{const[L,U]=D;return`${U.toFixed(5)}N, ${L.toFixed(5)}E`};return g.jsx($n,{children:l&&a&&g.jsxs(g.Fragment,{children:[g.jsx(Rt.div,{className:"fixed inset-0 z-[1600]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:w}),g.jsxs(Rt.div,{className:"fixed z-[1601] bg-white rounded-xl shadow-md overflow-hidden min-w-[200px] border-0 outline-none",style:{left:Math.min(a.pixel[0],window.innerWidth-220),top:Math.min(a.pixel[1],window.innerHeight-240)},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.15},children:[g.jsx("div",{className:"px-4 py-3 bg-white border-b border-gray-100",children:g.jsxs("div",{className:"flex items-center gap-2 text-blue-600",children:[g.jsx(ya,{size:16}),g.jsx("span",{className:"text-xs font-mono",children:P(a.coordinate)})]})}),g.jsxs("div",{className:"bg-white",children:[g.jsxs("button",{onClick:M,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-orange-50 text-gray-700 bg-white border-0 outline-none",children:[g.jsx(Fv,{size:20,className:"text-orange-500"}),g.jsx("span",{className:"font-medium",children:"Vondst toevoegen"})]}),g.jsxs("button",{onClick:A,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-green-50 text-gray-700 bg-white border-0 outline-none",children:[g.jsx(kE,{size:20,className:"text-green-500"}),g.jsx("span",{className:"font-medium",children:"Foto maken"})]}),g.jsxs("div",{className:"relative",children:[g.jsxs("button",{onClick:()=>y(!m),className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-blue-50 text-gray-700 bg-white border-0 outline-none",children:[g.jsx(za,{size:20,className:"text-purple-500"}),g.jsx("span",{className:"font-medium flex-1 text-left",children:"Voeg toe aan laag..."}),g.jsx(Jy,{size:16,className:`text-gray-400 transition-transform ${m?"rotate-90":""}`})]}),g.jsx($n,{children:m&&g.jsx(Rt.div,{className:"bg-gray-50 border-t border-gray-100",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},children:s.length===0?g.jsxs("button",{onClick:R,className:"w-full px-4 py-2 pl-11 flex items-center gap-2 text-sm text-purple-600 hover:bg-purple-50 bg-transparent border-0 outline-none",children:[g.jsx(Xa,{size:14}),g.jsx("span",{children:"Maak eerst een laag aan"})]}):g.jsxs(g.Fragment,{children:[s.map(D=>{const L=a?tSe(D,a.coordinate):!1;return g.jsxs("button",{onClick:()=>!L&&b(D.id),className:`w-full px-4 py-2 pl-11 flex items-center gap-2 text-sm bg-transparent border-0 outline-none ${L?"text-gray-400 cursor-not-allowed":"text-gray-700 hover:bg-gray-100"}`,title:L?"Al toegevoegd aan deze laag":void 0,disabled:L,children:[L&&g.jsx(uc,{size:14,className:"text-green-500 flex-shrink-0"}),g.jsx("span",{className:"truncate",children:D.name}),g.jsx("span",{className:"text-xs text-gray-400 ml-auto",children:L?"al toegevoegd":`(${D.points.length})`})]},D.id)}),g.jsxs("button",{onClick:R,className:"w-full px-4 py-2 pl-11 flex items-center gap-2 text-sm text-purple-600 hover:bg-purple-50 bg-transparent border-0 outline-none border-t border-gray-200",children:[g.jsx(Xa,{size:14}),g.jsx("span",{children:"Nieuwe laag..."})]})]})})})]}),g.jsxs("button",{onClick:I,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-purple-50 text-gray-700 bg-white border-0 outline-none",children:[g.jsx(due,{size:20,className:"text-purple-500"}),g.jsx("span",{className:"font-medium",children:"Lagen beheren"})]}),g.jsxs("button",{onClick:O,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-blue-50 text-gray-700 bg-white border-0 outline-none",children:[g.jsx(Iu,{size:20,className:"text-blue-600"}),g.jsx("span",{className:"font-medium",children:"Open in Google Maps"})]}),g.jsxs("button",{onClick:G,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-yellow-50 text-gray-700 bg-white border-0 outline-none",children:[g.jsx(vV,{size:20,className:"text-yellow-600"}),g.jsx("span",{className:"font-medium",children:"Street View"})]})]}),g.jsx("div",{className:"bg-white",children:g.jsxs("button",{onClick:S,className:"w-full px-4 py-3 flex items-center justify-center gap-2 text-gray-500 hover:bg-blue-50 transition-colors bg-white border-0 outline-none",children:[g.jsx(si,{size:18}),g.jsx("span",{children:"Annuleren"})]})})]})]})})}const rSe={Compass:rce,TreePalm:Nue,Mountain:ng,Waves:$ue,Search:MR,Target:Iue,Layers:za,Grid:yV},iSe={Compass:"text-purple-600",Waves:"text-cyan-600",TreePalm:"text-green-600",Mountain:"text-stone-600",Search:"text-amber-600",Target:"text-red-600",Layers:"text-blue-600",Grid:"text-lime-600"},sSe={Compass:"hover:bg-purple-50",Waves:"hover:bg-cyan-50",TreePalm:"hover:bg-green-50",Mountain:"hover:bg-stone-50",Search:"hover:bg-amber-50",Target:"hover:bg-red-50",Layers:"hover:bg-blue-50",Grid:"hover:bg-lime-50"},fD=["Mijn Vondsten","Labels Overlay","TMK 1850","Bonnebladen 1900","Hunebedden","FAMKE Steentijd","FAMKE IJzertijd","Grafheuvels","Terpen","AMK Monumenten","AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig","Romeinse wegen (regio)","Romeinse wegen (Wereld)","Romeinse Forten","Romeinse Forten Lijnen","Kastelen","IKAW","Archeo Onderzoeken","Rijksmonumenten","Werelderfgoed","Religieus Erfgoed","Essen","Runes","WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Inundatiegebieden","Militaire Objecten","Paleokaart 800 n.Chr.","Paleokaart 100 n.Chr.","Paleokaart 500 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 9000 v.Chr.","UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling","Hoogtekaart (WebGL)","AHN4 Hoogtekaart Kleur","AHN4 Hillshade NL","AHN4 Multi-Hillshade NL","AHN 0.5m","Veengebieden","Geomorfologie","Bodemkaart","Fossiel Hotspots","Mineralen Hotspots","Goudrivieren","Fossielen Nederland","Fossielen Belgi","Fossielen Duitsland","Fossielen Frankrijk","Wandelroutes","Parken","Speeltuinen","Musea","Strandjes","Kringloopwinkels","Ruiterpaden","Laarzenpaden","Gewaspercelen","Kadastrale Grenzen","Scheepswrakken","Woonheuvels ZH","Windmolens","Erfgoedlijnen","Oude Kernen","Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken","Verdronken Dorpen"],aSe=["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"],oSe=[5.2913,52.1326],lSe=8;function cSe(){const n=Ri(L=>L.setLayerVisibility),e=ws(L=>L.stopTracking),t=pi(L=>L.map),{presetsPanelOpen:r,togglePresetsPanel:i,closeAllPanels:s}=wr(),{presets:a,applyPreset:o,updatePreset:l,createPreset:c,resetToDefaults:h}=O9(),f=Ri(L=>L.visible),m=Sn(L=>L.presetPanelFontScale),y=Sn(L=>L.setPresetPanelFontScale),x=Sn(L=>L.showFontSliders),_=12*m/100,[w,S]=X.useState(null),[b,R]=X.useState(!1),[M,O]=X.useState(""),G=()=>{s(),fD.forEach(L=>n(L,!1)),aSe.forEach(L=>{n(L,L==="CartoDB (licht)")}),e(),t&&t.getView().animate({center:Ir(oSe),zoom:lSe,duration:500}),console.log(" Reset: CartoDB, alle lagen uit, GPS uit, zoom naar Nederland")},A=L=>{o(L),s()},I=(L,U)=>{L.stopPropagation();const j=Object.entries(f).filter(([Ee,ke])=>ke&&fD.includes(Ee)).map(([Ee])=>Ee);l(U,{layers:j}),S(U),setTimeout(()=>S(null),2e3),console.log(" Lagen opgeslagen naar preset")},P=()=>{M.trim()&&(c(M.trim(),"Layers"),O(""),R(!1))},D=()=>{confirm("Alle presets terugzetten naar standaard? Dit verwijdert aangepaste presets.")&&h()};return g.jsxs(g.Fragment,{children:[g.jsx(Rt.button,{onClick:G,className:"fixed bottom-2 left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Reset - CartoDB, alle lagen uit, GPS uit",children:g.jsx(tue,{size:20,className:"text-gray-600"})}),g.jsx(Rt.button,{onClick:i,className:"fixed bottom-[60px] left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Presets",children:r?g.jsx(mV,{size:20,className:"text-blue-600"}):g.jsx(za,{size:20,className:"text-blue-600"})}),g.jsx($n,{children:r&&g.jsxs(g.Fragment,{children:[g.jsx(Rt.div,{className:"fixed inset-0 z-[800]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:i}),g.jsxs(Rt.div,{initial:{opacity:0,x:-10,scale:.95},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:-10,scale:.95},transition:{duration:.15},className:"fixed bottom-[60px] left-[56px] bg-white/95 rounded-xl shadow-lg overflow-hidden w-[240px] backdrop-blur-sm z-[801]",children:[g.jsxs("div",{className:"flex items-center justify-between gap-2 px-3 py-1.5 bg-blue-500",style:{fontSize:`${_}px`},children:[g.jsx("span",{className:"font-medium text-white",children:"Presets"}),x&&g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx("span",{className:"text-[9px] text-blue-200",children:"T"}),g.jsx("input",{type:"range",min:"80",max:"130",step:"10",value:m,onInput:L=>{y(parseInt(L.target.value))},onChange:L=>y(parseInt(L.target.value)),className:"w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${m}%`}),g.jsx("span",{className:"text-[11px] text-blue-200",children:"T"})]})]}),g.jsx("div",{className:"p-2 max-h-[300px] overflow-y-auto",children:a.map(L=>{const U=rSe[L.icon]||za,j=iSe[L.icon]||"text-blue-600",Ee=sSe[L.icon]||"hover:bg-blue-50",ke=w===L.id;return g.jsxs("button",{onClick:()=>A(L.id),className:`w-full h-8 flex items-center gap-2 px-2 ${Ee} rounded text-left transition-colors border-0 outline-none bg-transparent overflow-hidden ${ke?"bg-green-50":""}`,style:{fontSize:`${_}px`},children:[g.jsx(U,{size:14,className:`${j} flex-shrink-0`}),g.jsx("span",{className:"text-gray-700 truncate flex-1",children:L.name}),ke?g.jsx("span",{className:"ml-auto p-1 flex-shrink-0",children:g.jsx(uc,{size:14,className:"text-green-500"})}):g.jsx("span",{onClick:Be=>I(Be,L.id),className:"ml-auto p-1 hover:bg-gray-200 rounded transition-colors flex-shrink-0",title:"Huidige lagen opslaan naar deze preset",children:g.jsx(wV,{size:12,className:"text-gray-400 hover:text-blue-500"})})]},L.id)})}),g.jsx("div",{className:"border-t border-gray-200 p-2",children:b?g.jsxs("div",{className:"flex gap-1",children:[g.jsx("input",{type:"text",value:M,onChange:L=>O(L.target.value),onKeyDown:L=>{L.key==="Enter"&&P(),L.key==="Escape"&&R(!1)},placeholder:"Naam preset...",autoFocus:!0,className:"flex-1 px-2 py-1 text-sm rounded bg-gray-50 border-0 outline-none focus:ring-1 focus:ring-blue-400",style:{fontSize:`${_}px`}}),g.jsx("button",{onClick:P,disabled:!M.trim(),className:"px-2 py-1 bg-blue-500 text-white rounded text-sm disabled:opacity-50 border-0 outline-none",children:g.jsx(uc,{size:14})})]}):g.jsxs("div",{className:"flex gap-1",children:[g.jsxs("button",{onClick:()=>R(!0),className:"flex-1 flex items-center justify-center gap-1 px-2 py-1.5 text-sm text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",style:{fontSize:`${_}px`},children:[g.jsx(Xa,{size:14}),g.jsx("span",{children:"Nieuwe preset"})]}),g.jsx("button",{onClick:D,className:"p-1.5 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded transition-colors border-0 outline-none",title:"Presets terugzetten naar standaard",children:g.jsx(rue,{size:14})})]})})]})]})})]})}function uSe(){const n=pi(a=>a.map),[e,t]=X.useState(0),[r,i]=X.useState(!1);X.useEffect(()=>{if(!n)return;const a=n.getView(),o=()=>{const l=a.getRotation(),c=l*180/Math.PI;t(c),i(Math.abs(l)>.087)};return o(),a.on("change:rotation",o),()=>{a.un("change:rotation",o)}},[n]);const s=()=>{n&&n.getView().animate({rotation:0,duration:300})};return g.jsx($n,{children:r&&g.jsx(Rt.button,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.2},onClick:s,className:"fixed top-[60px] right-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",title:"Klik om noorden te herstellen",children:g.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",style:{transform:`rotate(${-e}deg)`},children:[g.jsx("path",{d:"M12 2 L14.5 12 L12 10 L9.5 12 Z",fill:"#EA4335"}),g.jsx("path",{d:"M12 22 L9.5 12 L12 14 L14.5 12 Z",fill:"white",stroke:"#9CA3AF",strokeWidth:"0.5"}),g.jsx("circle",{cx:"12",cy:"12",r:"2",fill:"#374151"})]})})})}const hSe=[{name:"AHN4 Hoogtekaart Kleur",color:"blue",default:.85},{name:"AHN4 Hillshade NL",color:"blue",default:.7},{name:"AHN4 Multi-Hillshade NL",color:"blue",default:.7},{name:"AHN 0.5m",color:"blue",default:.7},{name:"TMK 1850",color:"amber",default:.8},{name:"Bonnebladen 1900",color:"amber",default:.8},{name:"Geomorfologie",color:"green",default:.5},{name:"Bodemkaart",color:"amber",default:.6},{name:"Veengebieden",color:"amber",default:.6},{name:"IKAW",color:"orange",default:.5},{name:"Archeo Landschappen",color:"green",default:.5},{name:"Terpen",color:"orange",default:.7},{name:"Essen",color:"amber",default:.6},{name:"AMK Monumenten",color:"purple",default:.45},{name:"AMK Romeins",color:"red",default:.6},{name:"AMK Steentijd",color:"amber",default:.6},{name:"AMK Vroege ME",color:"green",default:.6},{name:"AMK Late ME",color:"blue",default:.6},{name:"AMK Overig",color:"purple",default:.6},{name:"Paleokaart 9000 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 5500 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 2750 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 1500 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 500 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 100 n.Chr.",color:"indigo",default:.7},{name:"Paleokaart 800 n.Chr.",color:"indigo",default:.7},{name:"Verdedigingslinies",color:"red",default:.7},{name:"Inundatiegebieden",color:"red",default:.5},{name:"Gewaspercelen",color:"green",default:.6},{name:"Erfgoedlijnen",color:"purple",default:.7},{name:"Oude Kernen",color:"orange",default:.6},{name:"Relictenkaart Vlakken",color:"green",default:.5}],dSe={blue:"accent-blue-500",amber:"accent-amber-500",red:"accent-red-500",indigo:"accent-indigo-500",green:"accent-green-500",orange:"accent-orange-500",purple:"accent-purple-500"};function fSe(){const[n,e]=X.useState(!1),[t,r]=X.useState(!1),i=Ri(h=>h.visible),s=Ri(h=>h.opacity),a=Ri(h=>h.setLayerOpacity),o=hSe.filter(h=>i[h.name]);if(o.length===0)return null;const l=t?o:o.slice(0,3),c=o.length>3;return g.jsxs("div",{className:"fixed bottom-[112px] right-2 z-[900]",children:[g.jsxs(Rt.button,{onClick:()=>e(!n),className:"w-11 h-11 bg-white/80 rounded-xl backdrop-blur-sm shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none hover:bg-white/90 transition-colors",whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":"Opacity sliders",title:n?"Sluit opacity sliders":"Open opacity sliders",children:[g.jsx(xue,{size:22,strokeWidth:2,className:"text-gray-500"}),o.length>0&&g.jsx("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-blue-500 text-white text-[10px] rounded-full flex items-center justify-center",children:o.length})]}),g.jsx($n,{children:n&&g.jsxs(g.Fragment,{children:[g.jsx(Rt.div,{className:"fixed inset-0 z-[-1]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>e(!1)}),g.jsxs(Rt.div,{initial:{opacity:0,x:20,scale:.9},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:20,scale:.9},transition:{duration:.2},className:"absolute bottom-0 right-14 bg-white/95 rounded-lg shadow-lg p-3 min-w-[220px] max-h-[60vh] overflow-y-auto",children:[g.jsx("div",{className:"text-xs font-semibold text-gray-500 mb-2 uppercase tracking-wide",children:"Transparantie"}),g.jsx("div",{className:"space-y-3",children:l.map(h=>{const f=s[h.name]??h.default;return g.jsxs("div",{children:[g.jsx("label",{className:"text-xs font-medium text-gray-700 mb-1 block truncate",title:h.name,children:h.name}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("input",{type:"range",min:"0",max:"100",value:f*100,onChange:m=>a(h.name,parseInt(m.target.value)/100),className:`flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer ${dSe[h.color]}`}),g.jsxs("span",{className:"text-xs text-gray-500 w-8 text-right select-none pointer-events-none",children:[Math.round(f*100),"%"]})]})]},h.name)})}),c&&g.jsx("button",{onClick:()=>r(!t),className:"w-full mt-3 pt-2 border-t border-gray-200 flex items-center justify-center gap-1 text-xs text-gray-500 hover:text-gray-700",children:t?g.jsxs(g.Fragment,{children:[g.jsx(mV,{size:14}),"Minder tonen"]}):g.jsxs(g.Fragment,{children:[g.jsx(PE,{size:14}),o.length-3," meer..."]})})]})]})})]})}function gSe(){const n=pi(R=>R.map),[e,t]=X.useState(!1),[r,i]=X.useState(""),[s,a]=X.useState([]),[o,l]=X.useState(!1),[c,h]=X.useState(!1),f=X.useRef(null),m=X.useRef(null),y=X.useRef();X.useEffect(()=>{e&&f.current&&f.current.focus()},[e]),X.useEffect(()=>{if(!e)return;const R=M=>{m.current&&!m.current.contains(M.target)&&x()};return document.addEventListener("mousedown",R),()=>document.removeEventListener("mousedown",R)},[e]),X.useEffect(()=>{if(!e)return;const R=M=>{M.key==="Escape"&&x()};return document.addEventListener("keydown",R),()=>document.removeEventListener("keydown",R)},[e]),X.useEffect(()=>{if(y.current&&clearTimeout(y.current),r.length<2){a([]);return}return y.current=window.setTimeout(async()=>{h(!0);try{const M=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/suggest?q=${encodeURIComponent(r)}&rows=7`)).json();M.response?.docs&&a(M.response.docs)}catch(R){console.error("Search error:",R),a([])}finally{h(!1)}},300),()=>{y.current&&clearTimeout(y.current)}},[r]);const x=()=>{t(!1),i(""),a([]),l(!1)},_=async R=>{try{const O=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/lookup?id=${encodeURIComponent(R)}`)).json();if(O.response?.docs?.[0]?.centroide_ll){const A=O.response.docs[0].centroide_ll.match(/POINT\(([^ ]+) ([^)]+)\)/);if(A)return{lng:parseFloat(A[1]),lat:parseFloat(A[2])}}}catch(M){console.error("Lookup error:",M)}return null},w=async R=>{if(!n)return;const M=await _(R.id);M&&n.getView().animate({center:Ir([M.lng,M.lat]),zoom:16,duration:1e3}),x()},S=async(R,M)=>{M.stopPropagation();const O=await _(R.id);if(O){const G=`https://www.google.com/maps?q=${O.lat},${O.lng}`;window.open(G,"_blank")}x()},b={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"};return e?g.jsxs("div",{ref:m,className:"fixed left-[52px] right-14 z-[850]",style:b,children:[g.jsxs(Rt.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"search-input-wrapper",children:[g.jsx(MR,{size:18,className:"search-icon"}),g.jsx("input",{ref:f,type:"text",value:r,onChange:R=>{i(R.target.value),l(!0)},onFocus:()=>l(!0),placeholder:"Zoek adres of plaats...",className:"search-input"}),g.jsx("button",{onClick:x,className:"search-clear",title:"Sluiten",children:g.jsx(si,{size:18})})]}),g.jsx($n,{children:o&&s.length>0&&g.jsx(Rt.ul,{className:"search-results",initial:{opacity:0,y:-8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},children:s.map(R=>g.jsxs("li",{className:"search-result-item",children:[g.jsx("div",{className:"search-result-content",onClick:()=>w(R),children:g.jsx("span",{className:"search-result-text",children:R.weergavenaam})}),g.jsx("button",{className:"search-navigate-btn",onClick:M=>S(R,M),title:"Open in Google Maps",children:g.jsx(Iu,{size:20})})]},R.id))})}),o&&c&&g.jsx("div",{className:"search-loading",children:"Zoeken..."})]}):g.jsx(Rt.button,{className:"fixed right-14 z-[800] w-11 h-11 flex items-center justify-center bg-white/90 hover:bg-white rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",style:b,onClick:()=>t(!0),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Zoeken",children:g.jsx(MR,{size:22,className:"text-gray-600"})})}function mSe(){const n=pi(r=>r.map),e=()=>{if(!n)return;const r=n.getView(),i=r.getZoom();i!==void 0&&r.animate({zoom:i+1,duration:200})},t=()=>{if(!n)return;const r=n.getView(),i=r.getZoom();i!==void 0&&r.animate({zoom:i-1,duration:200})};return g.jsxs("div",{className:"fixed top-2 left-2 z-[800] flex flex-col gap-1",children:[g.jsx(Rt.button,{className:"w-9 h-9 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},title:"Inzoomen",children:g.jsx(Xa,{size:18,className:"text-gray-600"})}),g.jsx(Rt.button,{className:"w-9 h-9 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",onClick:t,whileHover:{scale:1.05},whileTap:{scale:.95},title:"Uitzoomen",children:g.jsx(_V,{size:18,className:"text-gray-600"})})]})}const pSe="detector2024",JR="detectorapp-auth";function ySe({children:n}){const[e,t]=X.useState(!1),[r,i]=X.useState(""),[s,a]=X.useState(!1),[o,l]=X.useState(""),[c,h]=X.useState(!0);X.useEffect(()=>{localStorage.getItem(JR)==="authenticated"&&t(!0),h(!1)},[]);const f=m=>{m.preventDefault(),l(""),r===pSe?(localStorage.setItem(JR,"authenticated"),t(!0)):(l("Onjuist wachtwoord"),i(""))};return c?g.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-blue-600 to-blue-800 flex items-center justify-center",children:g.jsx("div",{className:"text-white text-lg",children:"Laden..."})}):e?g.jsx(g.Fragment,{children:n}):g.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-blue-600 to-blue-800 flex items-center justify-center p-4",children:g.jsxs(Rt.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-sm",children:[g.jsxs("div",{className:"text-center mb-6",children:[g.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:g.jsx(PR,{size:32,className:"text-blue-600"})}),g.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"DetectorApp"}),g.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Test versie - Toegang beveiligd"})]}),g.jsxs("form",{onSubmit:f,className:"space-y-4",children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Wachtwoord"}),g.jsxs("div",{className:"relative",children:[g.jsx("input",{type:s?"text":"password",value:r,onChange:m=>i(m.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none pr-12",placeholder:"Voer wachtwoord in",autoFocus:!0}),g.jsx("button",{type:"button",onClick:()=>a(!s),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:s?g.jsx(Vv,{size:20}):g.jsx(Gv,{size:20})})]})]}),o&&g.jsx(Rt.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-red-500 text-sm text-center",children:o}),g.jsx("button",{type:"submit",className:"w-full py-3 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors",children:"Inloggen"})]}),g.jsx("p",{className:"text-center text-xs text-gray-400 mt-6",children:"Alleen voor testers"})]})})}function xSe(){localStorage.removeItem(JR),window.location.reload()}function _Se({isOpen:n,onClose:e}){const t=cl(l=>l.vondsten),r={total:t.length,byType:{},byMaterial:{},byPeriod:{},byCondition:{},avgDepth:0,totalWeight:0,recent:t.slice(-5).reverse()};let i=0,s=0;t.forEach(l=>{r.byType[l.objectType]=(r.byType[l.objectType]||0)+1,r.byMaterial[l.material]=(r.byMaterial[l.material]||0)+1,r.byPeriod[l.period]=(r.byPeriod[l.period]||0)+1,l.condition&&(r.byCondition[l.condition]=(r.byCondition[l.condition]||0)+1),l.depth&&(i+=l.depth,s++),l.weight&&(r.totalWeight+=l.weight)}),r.avgDepth=s>0?Math.round(i/s):0;const a=l=>Object.entries(l).sort((c,h)=>h[1]-c[1]),o=l=>Math.max(...Object.values(l),1);return g.jsx($n,{children:n&&g.jsxs(g.Fragment,{children:[g.jsx(Rt.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),g.jsxs(Rt.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-md mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},children:[g.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(gV,{size:18}),g.jsx("span",{className:"font-medium",children:"Mijn Vondsten Dashboard"})]}),g.jsx("button",{onClick:e,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none",children:g.jsx(si,{size:18})})]}),g.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-5",children:t.length===0?g.jsxs("div",{className:"text-center py-8 text-gray-500",children:[g.jsx(ya,{size:48,className:"mx-auto mb-3 opacity-30"}),g.jsx("p",{className:"font-medium",children:"Nog geen vondsten"}),g.jsx("p",{className:"text-sm mt-1",children:"Voeg je eerste vondst toe via de oranje knop of long-press op de kaart"})]}):g.jsxs(g.Fragment,{children:[g.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[g.jsx(qS,{icon:g.jsx(ya,{size:20}),value:r.total,label:"Totaal",color:"bg-orange-100 text-orange-700"}),g.jsx(qS,{icon:g.jsx(ny,{size:20}),value:r.avgDepth>0?`${r.avgDepth}cm`:"-",label:"Gem. diepte",color:"bg-blue-100 text-blue-700"}),g.jsx(qS,{icon:g.jsx(lue,{size:20}),value:r.totalWeight>0?`${r.totalWeight.toFixed(1)}g`:"-",label:"Tot. gewicht",color:"bg-green-100 text-green-700"})]}),g.jsx(t_,{title:"Per Type",data:a(r.byType),max:o(r.byType),color:"bg-orange-500"}),g.jsx(t_,{title:"Per Periode",data:a(r.byPeriod),max:o(r.byPeriod),color:"bg-amber-500"}),g.jsx(t_,{title:"Per Materiaal",data:a(r.byMaterial),max:o(r.byMaterial),color:"bg-blue-500"}),Object.keys(r.byCondition).length>0&&g.jsx(t_,{title:"Per Conditie",data:a(r.byCondition),max:o(r.byCondition),color:"bg-green-500"}),g.jsxs("div",{children:[g.jsxs("h3",{className:"text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2",children:[g.jsx(VC,{size:14}),"Recente Vondsten"]}),g.jsx("div",{className:"space-y-2",children:r.recent.map(l=>g.jsxs("div",{className:"flex items-center justify-between py-2 px-3 bg-gray-50 rounded-lg",children:[g.jsxs("div",{children:[g.jsx("span",{className:"font-medium text-sm text-gray-800",children:l.objectType}),g.jsx("span",{className:"text-gray-400 mx-1",children:"-"}),g.jsx("span",{className:"text-sm text-gray-600",children:l.material})]}),g.jsx("span",{className:"text-xs text-gray-400",children:new Date(l.timestamp).toLocaleDateString("nl-NL")})]},l.id))})]})]})})]})]})})}function qS({icon:n,value:e,label:t,color:r}){return g.jsxs("div",{className:`rounded-lg p-3 ${r}`,children:[g.jsx("div",{className:"flex items-center gap-2 mb-1 opacity-70",children:n}),g.jsx("div",{className:"text-xl font-bold",children:e}),g.jsx("div",{className:"text-xs opacity-70",children:t})]})}function t_({title:n,data:e,max:t,color:r}){return e.length===0?null:g.jsxs("div",{children:[g.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:n}),g.jsx("div",{className:"space-y-1.5",children:e.slice(0,6).map(([i,s])=>g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("div",{className:"w-24 text-xs text-gray-600 truncate",title:i,children:i}),g.jsx("div",{className:"flex-1 h-4 bg-gray-100 rounded-full overflow-hidden",children:g.jsx(Rt.div,{className:`h-full ${r} rounded-full`,initial:{width:0},animate:{width:`${s/t*100}%`},transition:{duration:.5,ease:"easeOut"}})}),g.jsx("div",{className:"w-6 text-xs text-gray-600 text-right font-medium",children:s})]},i))})]})}function vSe(n){const{type:e,coordinates:t}=n,r=o=>Ir(o),i=o=>o.map(r),s=o=>o.map(i),a=o=>o.map(s);switch(e){case"Point":return new gi(r(t));case"LineString":return new bi(i(t));case"Polygon":return new Ha(s(t));case"MultiPoint":return new kd(i(t));case"MultiLineString":return new ic(s(t));case"MultiPolygon":return new ad(a(t));default:return console.warn(`Unsupported geometry type: ${e}`),null}}function wSe(n,e,t){const r=n.color,i=10,s=5,a=14;let o=i;if(t>50?o=s:t>10?o=Math.max(s,i-(t-10)/10):t<2&&(o=a),e==="Point"||e==="MultiPoint")return new mn({image:new $s({radius:o,fill:new rr({color:r}),stroke:new Yn({color:"#ffffff",width:2})})});if(e==="LineString"||e==="MultiLineString")return new mn({stroke:new Yn({color:r,width:3})});if(e==="Polygon"||e==="MultiPolygon"){const l=ESe(r,.3);return new mn({fill:new rr({color:l}),stroke:new Yn({color:r,width:2})})}return new mn({image:new $s({radius:o,fill:new rr({color:r}),stroke:new Yn({color:"#ffffff",width:2})})})}function ESe(n,e){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(n);if(t){const r=parseInt(t[1],16),i=parseInt(t[2],16),s=parseInt(t[3],16);return`rgba(${r}, ${i}, ${s}, ${e})`}return n}function TSe(){const n=pi(r=>r.map),e=Ky(r=>r.layers),t=X.useRef(new Map);return X.useEffect(()=>{if(!n)return;const r=new Set;e.forEach(i=>{r.add(i.id);const s=new gc;i.features.features.forEach((o,l)=>{if(!o.geometry)return;const c=vSe(o.geometry);if(!c)return;const h=new _r({geometry:c,...o.properties,layerType:"importedLayer",layerId:i.id,layerName:i.name,layerColor:i.color,featureIndex:l});h.setStyle((f,m)=>wSe(i,o.geometry.type,m)),s.addFeature(h)});const a=t.current.get(i.id);if(a)a.setSource(s),a.setVisible(i.visible),a.setOpacity(i.opacity);else{const o=new Wu({source:s,zIndex:900,visible:i.visible,opacity:i.opacity,properties:{title:i.name,customLayerId:i.id}});n.addLayer(o),t.current.set(i.id,o)}}),t.current.forEach((i,s)=>{r.has(s)||(n.removeLayer(i),t.current.delete(s))})},[n,e]),X.useEffect(()=>()=>{n&&(t.current.forEach(r=>{n.removeLayer(r)}),t.current.clear())},[n]),null}Tn.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs");RG(Tn);function SSe(n){if(!n||n.length<2)return"unknown";const[e,t]=n;return e>=7e3&&e<=3e5&&t>=289e3&&t<=629e3?"RD":Math.abs(e)<=180&&Math.abs(t)<=90?"WGS84":"unknown"}function bSe(n){const[e,t]=n;return Tn("EPSG:28992","EPSG:4326",[e,t])}function oz(n,e){return typeof n[0]=="number"?e(n):n.map(t=>oz(t,e))}function RSe(n){const e=n.coordinates;return!e||Array.isArray(e)&&e.length===0?null:n.type==="Point"?e:n.type==="LineString"||n.type==="MultiPoint"?e[0]:n.type==="Polygon"||n.type==="MultiLineString"?e[0]?.[0]:n.type==="MultiPolygon"?e[0]?.[0]?.[0]:null}async function ASe(n){const e=[],t=[];try{const r=await n.text(),i=JSON.parse(r);if(!i.type)return e.push('Ongeldig GeoJSON: geen "type" veld gevonden'),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:t,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}};let s=[];i.type==="FeatureCollection"?s=i.features||[]:i.type==="Feature"?s=[i]:i.type==="GeometryCollection"?s=(i.geometries||[]).map((c,h)=>({type:"Feature",geometry:c,properties:{id:h}})):s=[{type:"Feature",geometry:i,properties:{}}],s.length===0&&t.push("Geen features gevonden in bestand");let a="unknown",o=!1;if(s.length>0&&s[0].geometry){const c=RSe(s[0].geometry);c&&(a=SSe(c))}a==="RD"&&(t.push("Rijksdriehoek coordinaten gedetecteerd, worden omgezet naar WGS84"),o=!0,s=s.map(c=>{if(!c.geometry)return c;const h=oz(c.geometry.coordinates,bSe);return{...c,geometry:{...c.geometry,coordinates:h}}}),a="WGS84");const l=[...new Set(s.filter(c=>c.geometry).map(c=>c.geometry.type))];return{success:!0,features:{type:"FeatureCollection",features:s},errors:e,warnings:t,metadata:{featureCount:s.length,geometryTypes:l,coordinateSystem:a,transformed:o}}}catch(r){return e.push(`Fout bij parsen: ${r instanceof Error?r.message:"Onbekende fout"}`),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:t,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}async function ISe(n){const e=[],t=[];try{const r=await n.text(),s=new Ipe({extractStyles:!1}).readFeatures(r,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"});s.length===0&&t.push("Geen features gevonden in KML bestand");const l=new ik().writeFeaturesObject(s,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"}).features.map((h,f)=>{const m={...h.properties},y=m.name||m.Name||`Feature ${f+1}`,x=m.description||m.Description||"";return{type:"Feature",geometry:h.geometry,properties:{...m,name:y,description:x}}}),c=[...new Set(l.filter(h=>h.geometry).map(h=>h.geometry.type))];return{success:!0,features:{type:"FeatureCollection",features:l},errors:e,warnings:t,metadata:{featureCount:l.length,geometryTypes:c,coordinateSystem:"WGS84",transformed:!1}}}catch(r){return e.push(`Fout bij parsen KML: ${r instanceof Error?r.message:"Onbekende fout"}`),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:t,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}async function CSe(n){const e=[],t=[];try{const r=await n.text(),s=new zme().readFeatures(r,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"});s.length===0&&t.push("Geen features gevonden in GPX bestand");const l=new ik().writeFeaturesObject(s,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"}).features.map((h,f)=>{const m={...h.properties},y=m.name||m.Name||`Waypoint ${f+1}`,x=m.desc||m.description||"",_=m.time||null,w=m.ele||null;return{type:"Feature",geometry:h.geometry,properties:{...m,name:y,description:x,time:_,elevation:w}}}),c=[...new Set(l.filter(h=>h.geometry).map(h=>h.geometry.type))];return c.includes("LineString")&&t.push("GPX track routes worden als lijnen weergegeven"),{success:!0,features:{type:"FeatureCollection",features:l},errors:e,warnings:t,metadata:{featureCount:l.length,geometryTypes:c,coordinateSystem:"WGS84",transformed:!1}}}catch(r){return e.push(`Fout bij parsen GPX: ${r instanceof Error?r.message:"Onbekende fout"}`),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:t,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}function Ok(n){switch(n.split(".").pop()?.toLowerCase()){case"geojson":case"json":return"geojson";case"kml":case"kmz":return"kml";case"gpx":return"gpx";default:return"unsupported"}}function kSe(){return".geojson,.json,.kml,.gpx"}function Dk(){return"GeoJSON, KML (Google My Maps), GPX"}async function PSe(n){switch(Ok(n.name)){case"geojson":return ASe(n);case"kml":return ISe(n);case"gpx":return CSe(n);case"unsupported":default:return{success:!1,features:{type:"FeatureCollection",features:[]},errors:[`Niet-ondersteund bestandsformaat: ${n.name}. Ondersteunde formaten: ${Dk()}`],warnings:[],metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}function MSe(n){return n.size>10485760?{valid:!1,error:`Bestand te groot (${(n.size/1024/1024).toFixed(1)} MB). Maximum is 10 MB.`}:Ok(n.name)==="unsupported"?{valid:!1,error:`Niet-ondersteund bestandsformaat. Ondersteunde formaten: ${Dk()}`}:n.name.toLowerCase().endsWith(".kmz")?{valid:!1,error:"KMZ bestanden worden nog niet ondersteund. Pak het bestand uit en importeer het .kml bestand."}:{valid:!0}}function NSe({isOpen:n,onClose:e}){const t=Ky(I=>I.addLayer),r=X.useRef(null),[i,s]=X.useState("idle"),[a,o]=X.useState(null),[l,c]=X.useState(null),[h,f]=X.useState(""),[m,y]=X.useState(null),[x,_]=X.useState(!1),w=X.useCallback(()=>{s("idle"),o(null),c(null),f(""),y(null),r.current&&(r.current.value="")},[]),S=X.useCallback(()=>{w(),e()},[w,e]),b=X.useCallback(async I=>{const P=MSe(I);if(!P.valid){y(P.error||"Ongeldig bestand"),s("error");return}o(I),s("parsing"),y(null);const D=I.name.replace(/\.[^/.]+$/,"");f(D);try{const L=await PSe(I);if(!L.success){y(L.errors.join(`
`)),s("error");return}if(L.features.features.length===0){y("Geen features gevonden in het bestand"),s("error");return}c(L),s("preview")}catch(L){y(L instanceof Error?L.message:"Onbekende fout bij parsen"),s("error")}},[]),R=X.useCallback(I=>{const P=I.target.files?.[0];P&&b(P)},[b]),M=X.useCallback(I=>{I.preventDefault(),_(!0)},[]),O=X.useCallback(I=>{I.preventDefault(),_(!1)},[]),G=X.useCallback(I=>{I.preventDefault(),_(!1);const P=I.dataTransfer.files?.[0];P&&b(P)},[b]),A=X.useCallback(()=>{if(!l||!h.trim())return;const I=a?Ok(a.name):"geojson";t({name:h.trim(),type:I==="unsupported"?"geojson":I,features:l.features,visible:!0,opacity:1,color:"",sourceFileName:a?.name||"unknown"}),S()},[l,h,a,t,S]);return g.jsx($n,{children:n&&g.jsxs(g.Fragment,{children:[g.jsx(Rt.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:S}),g.jsxs(Rt.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-md mx-auto my-auto max-h-[80vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[g.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-purple-500 to-purple-600 text-white",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(Qy,{size:18}),g.jsx("span",{className:"font-medium",children:"Laag Importeren"})]}),g.jsx("button",{onClick:S,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none",children:g.jsx(si,{size:18})})]}),g.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[i==="idle"&&g.jsxs(g.Fragment,{children:[g.jsxs("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${x?"border-purple-500 bg-purple-50":"border-gray-300 hover:border-gray-400"}`,onDragOver:M,onDragLeave:O,onDrop:G,children:[g.jsx(GC,{size:40,className:"mx-auto text-gray-400 mb-3"}),g.jsx("p",{className:"text-gray-600 mb-2",children:"Sleep een bestand hierheen"}),g.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"of"}),g.jsx("button",{onClick:()=>r.current?.click(),className:"px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors border-0 outline-none",children:"Bestand kiezen"}),g.jsx("input",{ref:r,type:"file",accept:kSe(),onChange:R,className:"hidden"})]}),g.jsxs("div",{className:"text-xs text-gray-500 text-center",children:[g.jsx("p",{className:"font-medium",children:"Ondersteunde formaten:"}),g.jsx("p",{children:Dk()})]})]}),i==="parsing"&&g.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[g.jsx(zC,{size:40,className:"text-purple-500 animate-spin mb-4"}),g.jsx("p",{className:"text-gray-600",children:"Bestand verwerken..."}),g.jsx("p",{className:"text-gray-400 text-sm",children:a?.name})]}),i==="error"&&g.jsxs("div",{className:"space-y-4",children:[g.jsxs("div",{className:"flex items-start gap-3 p-4 bg-red-50 rounded-lg",children:[g.jsx(pV,{size:20,className:"text-red-500 flex-shrink-0 mt-0.5"}),g.jsxs("div",{children:[g.jsx("p",{className:"font-medium text-red-700",children:"Import mislukt"}),g.jsx("p",{className:"text-sm text-red-600 mt-1 whitespace-pre-wrap",children:m})]})]}),g.jsx("button",{onClick:w,className:"w-full px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors border-0 outline-none",children:"Opnieuw proberen"})]}),i==="preview"&&l&&g.jsxs("div",{className:"space-y-4",children:[g.jsxs("div",{className:"flex items-start gap-3 p-3 bg-green-50 rounded-lg",children:[g.jsx(qle,{size:20,className:"text-green-500 flex-shrink-0 mt-0.5"}),g.jsxs("div",{children:[g.jsx("p",{className:"font-medium text-green-700",children:"Bestand geladen"}),g.jsx("p",{className:"text-sm text-green-600",children:a?.name})]})]}),l.warnings.length>0&&g.jsxs("div",{className:"p-3 bg-amber-50 rounded-lg",children:[g.jsx("p",{className:"font-medium text-amber-700 text-sm",children:"Let op:"}),g.jsx("ul",{className:"text-sm text-amber-600 mt-1 list-disc list-inside",children:l.warnings.map((I,P)=>g.jsx("li",{children:I},P))})]}),g.jsx("div",{className:"p-3 bg-gray-50 rounded-lg text-sm",children:g.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[g.jsxs("div",{children:[g.jsx("span",{className:"text-gray-500",children:"Features:"}),g.jsx("span",{className:"ml-2 font-medium",children:l.metadata.featureCount})]}),g.jsxs("div",{children:[g.jsx("span",{className:"text-gray-500",children:"Types:"}),g.jsx("span",{className:"ml-2 font-medium",children:l.metadata.geometryTypes.join(", ")||"-"})]})]})}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Naam van de laag"}),g.jsx("input",{type:"text",value:h,onChange:I=>f(I.target.value),placeholder:"Bijv. Mijn locaties",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]})]}),i==="preview"&&g.jsxs("div",{className:"px-4 py-3 border-t border-gray-100 flex gap-2",children:[g.jsx("button",{onClick:w,className:"flex-1 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors border-0 outline-none",children:"Annuleren"}),g.jsx("button",{onClick:A,disabled:!h.trim(),className:"flex-1 px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors border-0 outline-none disabled:opacity-50 disabled:cursor-not-allowed",children:"Importeren"})]})]})]})})}function LSe(){const{user:n,loading:e,error:t,signInWithGoogle:r,logout:i,initAuth:s}=TE();return X.useEffect(()=>{s()},[s]),e?g.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-white rounded-lg text-gray-500",children:[g.jsx(kR,{size:16,className:"animate-pulse"}),g.jsx("span",{className:"text-sm",children:"Laden..."})]}):n?g.jsxs("div",{className:"flex items-center gap-3 px-3 py-2.5 bg-green-50 rounded-lg",children:[n.photoURL?g.jsx("img",{src:n.photoURL,alt:n.displayName||"User",className:"w-8 h-8 rounded-full border-2 border-green-200",referrerPolicy:"no-referrer"}):g.jsx("div",{className:"w-8 h-8 rounded-full bg-green-200 flex items-center justify-center",children:g.jsx(HC,{size:16,className:"text-green-600"})}),g.jsxs("div",{className:"flex-1 min-w-0",children:[g.jsx("div",{className:"text-sm font-medium text-green-800 truncate",children:n.displayName||n.email}),g.jsxs("div",{className:"text-xs text-green-600 flex items-center gap-1",children:[g.jsx(kR,{size:12}),"Cloud sync actief"]})]}),g.jsx("button",{onClick:i,className:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none bg-transparent",title:"Uitloggen",children:g.jsx(UC,{size:16})})]}):g.jsxs("div",{className:"space-y-2",children:[g.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-gray-50 rounded-lg text-gray-500",children:[g.jsx(Jle,{size:16}),g.jsx("span",{className:"text-sm",children:"Alleen lokale opslag"})]}),g.jsxs("button",{onClick:r,className:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-white hover:bg-blue-50 rounded-lg transition-colors border-0 outline-none",children:[g.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",children:[g.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),g.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),g.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),g.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),g.jsx("span",{className:"text-sm text-gray-700",children:"Inloggen met Google"})]}),t&&g.jsx("div",{className:"px-3 py-2 bg-red-50 text-red-700 text-xs rounded-lg",children:t})]})}const OSe="https://forms.gle/R5LCk11Bzu5XrkBj8";function DSe(){const{settingsPanelOpen:n,toggleSettingsPanel:e,vondstDashboardOpen:t,toggleVondstDashboard:r,openLayerManagerModal:i}=wr(),s=Sn(),{presets:a,createPreset:o,deletePreset:l,updatePreset:c}=O9(),h=cl(Z=>Z.vondsten),f=Ky(Z=>Z.layers),{layers:m,updateLayer:y}=hs(),{devMode:x,setDevMode:_,tier:w}=iC(),[S,b]=X.useState(""),[R,M]=X.useState(!1),[O,G]=X.useState(!1),[A,I]=X.useState(null),[P,D]=X.useState(""),[L,U]=X.useState(null),[j,Ee]=X.useState(""),[ke,Be]=X.useState("algemeen"),Me=14*s.fontScale/100,ce=()=>{S.trim()&&(o(S.trim(),"Layers"),b(""),M(!1))},Pe=(Z,te)=>{I(Z),D(te)},be=Z=>{P.trim()&&(c(Z,{name:P.trim()}),console.log(` Preset hernoemd naar "${P.trim()}"`)),I(null),D("")},se=()=>{I(null),D("")},V=[{id:"algemeen",label:"Algemeen",icon:g.jsx(vue,{size:14})},{id:"lagen",label:"Lagen",icon:g.jsx(za,{size:14})},{id:"vondsten",label:"Vondsten",icon:g.jsx(ya,{size:14})}];return g.jsxs(g.Fragment,{children:[g.jsx($n,{children:n&&g.jsxs(g.Fragment,{children:[g.jsx(Rt.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),g.jsxs(Rt.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-sm mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[g.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-blue-500",style:{fontSize:`${Me}px`},children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(NR,{size:18,className:"text-white"}),g.jsx("span",{className:"font-medium text-white",children:"Instellingen"})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[s.showFontSliders&&g.jsxs(g.Fragment,{children:[g.jsx("span",{className:"text-[10px] text-blue-200",children:"T"}),g.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:s.fontScale,onInput:Z=>{s.setFontScale(parseInt(Z.target.value))},onChange:Z=>s.setFontScale(parseInt(Z.target.value)),className:"w-20 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${s.fontScale}%`}),g.jsx("span",{className:"text-xs text-blue-200",children:"T"})]}),g.jsx("button",{onClick:e,className:"p-1 rounded bg-blue-400/50 hover:bg-blue-400 transition-colors border-0 outline-none ml-1",children:g.jsx(si,{size:18,className:"text-white",strokeWidth:2.5})})]})]}),g.jsx("div",{className:"flex border-b border-gray-200",children:V.map(Z=>g.jsxs("button",{onClick:()=>Be(Z.id),className:`flex-1 flex items-center justify-center gap-1.5 px-3 py-2.5 text-sm font-medium transition-colors border-0 outline-none ${ke===Z.id?"text-blue-600 border-b-2 border-blue-600 bg-blue-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[Z.icon,Z.label]},Z.id))}),g.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-5",style:{fontSize:`${Me}px`},children:[ke==="algemeen"&&g.jsxs(g.Fragment,{children:[g.jsx(jl,{title:"Account",icon:g.jsx(HC,{size:16}),children:g.jsx(LSe,{})}),g.jsxs(jl,{title:"Kaart",icon:g.jsx($C,{size:16}),children:[g.jsx(FSe,{label:"Standaard achtergrond",children:g.jsxs("select",{value:s.defaultBackground,onChange:Z=>s.setDefaultBackground(Z.target.value),className:"px-2 py-1 bg-gray-100 rounded border-0 outline-none",style:{fontSize:"0.9em"},children:[g.jsx("option",{value:"CartoDB (licht)",children:"Licht"}),g.jsx("option",{value:"OpenStreetMap",children:"OSM"}),g.jsx("option",{value:"Luchtfoto",children:"Luchtfoto"})]})}),g.jsx(Gf,{label:"Schaalbalk tonen",checked:s.showScaleBar,onChange:s.setShowScaleBar})]}),g.jsxs(jl,{title:"GPS",icon:g.jsx(WC,{size:16}),children:[g.jsx(Gf,{label:"GPS aan bij start",checked:s.gpsAutoStart,onChange:s.setGpsAutoStart}),g.jsx(Gf,{label:"Nauwkeurigheidscirkel",checked:s.showAccuracyCircle,onChange:s.setShowAccuracyCircle})]}),g.jsxs(jl,{title:"Feedback",icon:g.jsx(Eue,{size:16}),children:[g.jsx(Gf,{label:"Trillen bij acties",checked:s.hapticFeedback,onChange:s.setHapticFeedback}),g.jsx(Gf,{label:"Spraakfeedback vondsten",checked:s.voiceFeedbackEnabled,onChange:s.setVoiceFeedbackEnabled}),s.voiceFeedbackEnabled&&g.jsxs("p",{className:"text-gray-500 mt-1",style:{fontSize:"0.75em"},children:[g.jsx(zue,{size:12,className:"inline mr-1"}),"Spreekt vondst info uit bij toevoegen"]})]}),g.jsxs(jl,{title:"Development",icon:g.jsx(tce,{size:16}),children:[g.jsx(Gf,{label:"Dev Mode (alles ontgrendeld)",checked:x,onChange:_}),g.jsxs("p",{className:"text-gray-500 mt-1",style:{fontSize:"0.75em"},children:["Huidige tier: ",g.jsx("span",{className:"font-medium text-blue-600",children:w}),x&&g.jsx("span",{className:"text-green-600",children:" (alle lagen ontgrendeld)"})]})]})]}),ke==="lagen"&&g.jsxs(g.Fragment,{children:[g.jsx(jl,{title:"Mijn lagen",icon:g.jsx(za,{size:16}),isOwn:!0,children:g.jsxs("div",{className:"space-y-1",children:[m.filter(Z=>!Z.archived).length===0?g.jsx("p",{className:"text-gray-500 py-1",style:{fontSize:"0.75em"},children:"Nog geen eigen lagen aangemaakt."}):m.filter(Z=>!Z.archived).map(Z=>g.jsx("div",{className:"flex items-center gap-2 py-1.5 px-2 hover:bg-gray-50 rounded",children:L===Z.id?g.jsx("input",{type:"text",value:j,onChange:te=>Ee(te.target.value),onKeyDown:te=>{te.key==="Enter"?(j.trim()&&y(Z.id,{name:j.trim()}),U(null)):te.key==="Escape"&&U(null)},onBlur:()=>{j.trim()&&y(Z.id,{name:j.trim()}),U(null)},autoFocus:!0,className:"flex-1 px-1.5 py-0.5 text-sm bg-orange-50 rounded outline-none focus:ring-1 focus:ring-orange-400"}):g.jsxs(g.Fragment,{children:[g.jsx("span",{className:"flex-1 text-sm text-gray-700 truncate",children:Z.name}),g.jsxs("span",{className:"text-xs text-gray-400",children:[Z.points.length," punten"]}),g.jsx("button",{onClick:()=>{U(Z.id),Ee(Z.name)},className:"p-1 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none bg-transparent",title:"Naam bewerken",children:g.jsx(rg,{size:12})})]})},Z.id)),g.jsxs("button",{onClick:()=>{i(),e()},className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[g.jsx(NR,{size:14}),g.jsx("span",{children:"Lagen beheren"})]})]})}),g.jsx(jl,{title:"Lagen importeren",icon:g.jsx(Qy,{size:16}),children:g.jsxs("div",{className:"space-y-1",children:[f.length>0&&g.jsxs(g.Fragment,{children:[f.map(Z=>g.jsx(SV,{layer:Z},Z.id)),g.jsx("div",{className:"border-t border-gray-100 my-2"})]}),g.jsxs("button",{onClick:()=>G(!0),className:"flex items-center gap-2 px-2 py-1.5 text-cyan-600 hover:bg-cyan-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[g.jsx(Xa,{size:14}),g.jsx("span",{children:"Nieuwe laag importeren"})]}),g.jsx("p",{className:"text-gray-400 mt-1",style:{fontSize:"0.7em"},children:"GeoJSON, KML (Google My Maps), GPX"})]})}),g.jsx(jl,{title:"Presets",icon:g.jsx(za,{size:16}),children:g.jsxs("div",{className:"space-y-2",children:[a.map(Z=>g.jsx("div",{className:"flex items-center justify-between py-1",children:A===Z.id?g.jsxs("div",{className:"flex-1 flex items-center gap-1",children:[g.jsx("input",{type:"text",value:P,onChange:te=>D(te.target.value),onKeyDown:te=>{te.key==="Enter"&&be(Z.id),te.key==="Escape"&&se()},className:"flex-1 px-2 py-0.5 bg-blue-50 rounded border border-blue-300 outline-none",style:{fontSize:"0.9em"},autoFocus:!0}),g.jsx("button",{onClick:()=>be(Z.id),className:"px-2 py-0.5 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors border-0 outline-none",style:{fontSize:"0.7em"},children:"OK"}),g.jsx("button",{onClick:se,className:"px-2 py-0.5 bg-gray-200 text-gray-600 rounded hover:bg-gray-300 transition-colors border-0 outline-none",style:{fontSize:"0.7em"},children:""})]}):g.jsxs(g.Fragment,{children:[g.jsxs("div",{className:"flex-1 min-w-0",children:[g.jsxs("span",{className:"text-gray-600",style:{fontSize:"0.9em"},children:[Z.name,Z.isBuiltIn&&g.jsx("span",{className:"ml-1 text-gray-400",style:{fontSize:"0.7em"},children:"(standaard)"})]}),g.jsxs("span",{className:"ml-1 text-gray-400",style:{fontSize:"0.7em"},children:["(",Z.layers.length," lagen)"]})]}),!Z.isBuiltIn&&g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx("button",{onClick:()=>Pe(Z.id,Z.name),className:"p-1 text-blue-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",title:"Naam wijzigen",children:g.jsx(rg,{size:14})}),g.jsx("button",{onClick:()=>l(Z.id),className:"p-1 text-red-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors border-0 outline-none",title:"Verwijderen",children:g.jsx(xc,{size:14})})]})]})},Z.id)),R?g.jsxs("div",{className:"flex gap-2 mt-2",children:[g.jsx("input",{type:"text",value:S,onChange:Z=>b(Z.target.value),placeholder:"Naam nieuwe preset",className:"flex-1 px-2 py-1 bg-gray-100 rounded border-0 outline-none",style:{fontSize:"0.9em"},onKeyDown:Z=>Z.key==="Enter"&&ce(),autoFocus:!0}),g.jsx("button",{onClick:ce,className:"px-2 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors border-0 outline-none",style:{fontSize:"0.75em"},children:"Opslaan"}),g.jsx("button",{onClick:()=>M(!1),className:"px-2 py-1 bg-gray-200 text-gray-600 rounded hover:bg-gray-300 transition-colors border-0 outline-none",style:{fontSize:"0.75em"},children:"Annuleren"})]}):g.jsxs("button",{onClick:()=>M(!0),className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[g.jsx(Xa,{size:14}),g.jsx("span",{children:"Huidige lagen als preset opslaan"})]})]})})]}),ke==="vondsten"&&g.jsx(g.Fragment,{children:g.jsxs(jl,{title:"Vondsten",icon:g.jsx(ya,{size:16}),isOwn:!0,children:[g.jsx("p",{className:"text-gray-500 py-1",style:{fontSize:"0.75em"},children:"Vondsten worden altijd lokaal op dit apparaat opgeslagen."}),g.jsxs("button",{onClick:r,className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[g.jsx(gV,{size:14}),g.jsxs("span",{children:["Dashboard (",h.length," vondsten)"]})]}),g.jsx(jSe,{})]})})]}),g.jsxs("div",{className:"px-4 py-3 border-t border-gray-100 space-y-2",style:{fontSize:`${Me}px`},children:[g.jsxs("a",{href:OSe,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 w-full px-3 py-2 text-orange-600 hover:bg-orange-50 rounded-lg transition-colors border-0 outline-none",style:{fontSize:"0.9em"},children:[g.jsx(fV,{size:16}),g.jsx("span",{children:"Meld een bug"})]}),g.jsxs("button",{onClick:xSe,className:"flex items-center justify-center gap-2 w-full px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none",style:{fontSize:"0.9em"},children:[g.jsx(UC,{size:16}),g.jsx("span",{children:"Uitloggen"})]}),g.jsx("p",{className:"text-gray-400 text-center",style:{fontSize:"0.75em"},children:"Instellingen worden lokaal opgeslagen"})]})]})]})}),g.jsx(_Se,{isOpen:t,onClose:r}),g.jsx(NSe,{isOpen:O,onClose:()=>G(!1)})]})}function jl({title:n,icon:e,children:t,isOwn:r}){return g.jsxs("section",{children:[g.jsxs("div",{className:"flex items-center gap-2 mb-2 pb-1 border-b border-gray-100",children:[g.jsx("span",{className:r?"text-orange-600":"text-blue-600",children:e}),g.jsx("span",{className:`font-medium ${r?"text-orange-600":"text-gray-800"}`,style:{fontSize:"1em"},children:n})]}),g.jsx("div",{className:"space-y-2",children:t})]})}function FSe({label:n,children:e}){return g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsx("span",{className:"text-gray-600",style:{fontSize:"0.9em"},children:n}),e]})}function Gf({label:n,checked:e,onChange:t}){return g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsx("span",{className:"text-gray-600",style:{fontSize:"0.9em"},children:n}),g.jsx("button",{onClick:()=>t(!e),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${e?"bg-gradient-to-r from-blue-500 to-blue-600":"bg-gray-300"}`,children:g.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${e?"left-[22px]":"left-0.5"}`})})]})}function jSe(){const[n,e]=X.useState(!1),{vondsten:t,exportAsGeoJSON:r,exportAsCSV:i,exportAsExcel:s,exportAsGPX:a,exportAsKML:o}=cl(),l=[{label:"Excel (.xlsx)",action:s,desc:"Spreadsheet"},{label:"CSV",action:i,desc:"Comma-separated"},{label:"GeoJSON",action:r,desc:"GIS software"},{label:"GPX",action:a,desc:"GPS apparaten"},{label:"KML",action:o,desc:"Google Earth"}],c=h=>{h(),e(!1)};return t.length===0?g.jsxs("div",{className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-gray-400 bg-gray-100 rounded w-full cursor-not-allowed",style:{fontSize:"0.9em"},children:[g.jsx(jv,{size:14}),g.jsx("span",{children:"Geen vondsten om te exporteren"})]}):g.jsxs("div",{className:"relative mt-2",children:[g.jsxs("button",{onClick:()=>e(!n),className:"flex items-center justify-between gap-2 px-2 py-1.5 text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(jv,{size:14}),g.jsxs("span",{children:["Exporteer vondsten (",t.length,")"]})]}),g.jsx("span",{style:{fontSize:"0.8em"},children:""})]}),n&&g.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg z-10 overflow-hidden",children:l.map((h,f)=>g.jsxs("button",{onClick:()=>c(h.action),className:"w-full px-3 py-2 text-left hover:bg-blue-50 transition-colors border-0 outline-none flex justify-between items-center",style:{fontSize:"0.9em"},children:[g.jsx("span",{className:"text-gray-700",children:h.label}),g.jsx("span",{className:"text-gray-400",style:{fontSize:"0.8em"},children:h.desc})]},f))})]})}const mw="2.30.40";function VSe({size:n=18}){return g.jsxs("svg",{viewBox:"0 0 24 24",width:n,height:n,children:[g.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),g.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),g.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),g.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]})}function GSe(){const[n,e]=X.useState(!1),{user:t,loading:r,signInWithGoogle:i,logout:s}=TE(),{toggleInfoPanel:a,toggleSettingsPanel:o}=wr(),l=Sn(P=>P.menuFontScale),c=Sn(P=>P.setMenuFontScale),h=Sn(P=>P.showFontSliders),f=Sn(P=>P.setShowFontSliders),m=Sn(P=>P.showVondstButton),y=Sn(P=>P.setShowVondstButton),x=Sn(P=>P.showRouteRecordButton),_=Sn(P=>P.setShowRouteRecordButton),w=Sn(P=>P.showCustomPointLayers),S=Sn(P=>P.setShowCustomPointLayers),b={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"},R=()=>e(!1),M=()=>{R(),a()},O=()=>{R(),o()},G=()=>{R(),i()},A=()=>{R(),s()},I=13*l/100;return g.jsxs(g.Fragment,{children:[g.jsx(Rt.button,{className:`fixed right-2 z-[800] w-11 h-11 flex items-center justify-center rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm ${n?"bg-blue-500 hover:bg-blue-600":"bg-white/90 hover:bg-white"}`,style:b,onClick:()=>e(!n),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Menu",children:n?g.jsx(si,{size:22,className:"text-white"}):g.jsx(jce,{size:22,className:"text-gray-600"})}),g.jsx($n,{children:n&&g.jsxs(g.Fragment,{children:[g.jsx(Rt.div,{className:"fixed inset-0 z-[799]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:R}),g.jsxs(Rt.div,{initial:{opacity:0,y:-8,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-8,scale:.95},transition:{duration:.15},className:"fixed right-2 z-[801] w-64 bg-white rounded-xl shadow-lg overflow-hidden flex flex-col",style:{top:"calc(max(0.5rem, env(safe-area-inset-top, 0.5rem)) + 52px)",fontSize:`${I}px`},children:[g.jsxs("div",{className:"flex items-center justify-between gap-2 px-3 py-1.5 bg-blue-500",children:[g.jsx("span",{className:"font-medium text-white",style:{fontSize:`${I}px`},children:"Menu"}),h&&g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx("span",{className:"text-[9px] text-blue-200",children:"T"}),g.jsx("input",{type:"range",min:"80",max:"130",step:"10",value:l,onInput:P=>c(parseInt(P.target.value)),onChange:P=>c(parseInt(P.target.value)),className:"w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${l}%`}),g.jsx("span",{className:"text-[11px] text-blue-200",children:"T"})]})]}),r?g.jsx("div",{className:"px-3 py-4 flex items-center justify-center",children:g.jsx("div",{className:"w-5 h-5 border-2 border-gray-300 border-t-blue-500 rounded-full animate-spin"})}):t?g.jsx("div",{className:"px-3 py-3 border-b border-gray-100",children:g.jsxs("div",{className:"flex items-center gap-3",children:[t.photoURL?g.jsx("img",{src:t.photoURL,alt:t.displayName||"User",className:"w-8 h-8 rounded-full",referrerPolicy:"no-referrer"}):g.jsx("div",{className:"w-8 h-8 rounded-full bg-green-500 flex items-center justify-center",children:g.jsx(HC,{size:16,className:"text-white"})}),g.jsxs("div",{className:"flex-1 min-w-0",children:[g.jsx("div",{className:"font-medium text-gray-800 truncate",style:{fontSize:"0.85em"},children:t.displayName||"Gebruiker"}),g.jsx("div",{className:"text-green-600",style:{fontSize:"0.7em"},children:"Cloud sync actief"})]}),g.jsx("button",{onClick:A,className:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none bg-transparent",title:"Uitloggen",children:g.jsx(UC,{size:16})})]})}):g.jsxs("button",{onClick:G,className:"w-full px-3 py-3 flex items-center gap-3 hover:bg-blue-50 transition-colors border-0 outline-none bg-transparent",children:[g.jsx(VSe,{size:18}),g.jsx("span",{className:"text-gray-700",style:{fontSize:"0.9em"},children:"Inloggen met Google"})]}),g.jsx("div",{className:"py-1",children:g.jsxs("button",{onClick:M,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-blue-50",style:{fontSize:"0.95em"},children:[g.jsx(BC,{size:18,className:"text-blue-500"}),g.jsx("span",{children:"Info & handleiding"})]})}),g.jsxs("div",{className:"py-1 border-t border-gray-100",children:[g.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx(ya,{size:18,className:"text-orange-500"}),g.jsx("span",{className:"text-gray-700",style:{fontSize:"0.9em"},children:"Vondst knop"})]}),g.jsx("button",{onClick:()=>y(!m),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${m?"bg-gradient-to-r from-orange-500 to-orange-600":"bg-gray-300"}`,children:g.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${m?"left-[22px]":"left-0.5"}`})})]}),g.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx(Bv,{size:18,className:"text-green-500"}),g.jsx("span",{className:"text-gray-700",style:{fontSize:"0.9em"},children:"Route knop"})]}),g.jsx("button",{onClick:()=>_(!x),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${x?"bg-gradient-to-r from-green-500 to-green-600":"bg-gray-300"}`,children:g.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${x?"left-[22px]":"left-0.5"}`})})]}),g.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx(za,{size:18,className:"text-amber-500"}),g.jsx("span",{className:"text-gray-700",style:{fontSize:"0.9em"},children:"Mijn lagen"})]}),g.jsx("button",{onClick:()=>S(!w),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${w?"bg-gradient-to-r from-amber-500 to-amber-600":"bg-gray-300"}`,children:g.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${w?"left-[22px]":"left-0.5"}`})})]}),g.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx(EV,{size:18,className:"text-purple-500"}),g.jsx("span",{className:"text-gray-700",style:{fontSize:"0.9em"},children:"Tekstgrootte"})]}),g.jsx("button",{onClick:()=>f(!h),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${h?"bg-gradient-to-r from-purple-500 to-purple-600":"bg-gray-300"}`,children:g.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${h?"left-[22px]":"left-0.5"}`})})]})]}),g.jsx("div",{className:"mt-auto border-t border-gray-100",children:g.jsxs("button",{onClick:O,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-gray-50",style:{fontSize:"0.95em"},children:[g.jsx(NR,{size:18,className:"text-gray-500"}),g.jsx("span",{children:"Instellingen"})]})}),g.jsxs("div",{className:"px-3 py-1.5 bg-gray-50 text-center text-gray-400",style:{fontSize:"0.65em"},children:["DetectorApp NL v",mw]})]})]})})]})}const BSe="https://forms.gle/R5LCk11Bzu5XrkBj8";function zSe(){const{infoPanelOpen:n,toggleInfoPanel:e}=wr(),[t,r]=X.useState("info"),i=[{id:"info",label:"Info",icon:g.jsx(BC,{size:14})},{id:"functies",label:"Functies",icon:g.jsx(GC,{size:14})},{id:"handleiding",label:"Handleiding",icon:g.jsx(Dle,{size:14})}];return g.jsx($n,{children:n&&g.jsxs(g.Fragment,{children:[g.jsx(Rt.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),g.jsxs(Rt.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[g.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-blue-500",children:[g.jsxs("span",{className:"font-medium text-white",children:["DetectorApp NL v",mw]}),g.jsx("button",{onClick:e,className:"p-1 rounded bg-blue-400/50 hover:bg-blue-400 transition-colors border-0 outline-none",children:g.jsx(si,{size:18,className:"text-white",strokeWidth:2.5})})]}),g.jsx("div",{className:"flex border-b border-gray-200",children:i.map(s=>g.jsxs("button",{onClick:()=>r(s.id),className:`flex-1 flex items-center justify-center gap-1.5 px-3 py-2.5 text-sm font-medium transition-colors border-0 outline-none ${t===s.id?"text-blue-600 border-b-2 border-blue-600 bg-blue-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[s.icon,s.label]},s.id))}),g.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 text-sm",children:[t==="info"&&g.jsx(USe,{}),t==="functies"&&g.jsx($Se,{}),t==="handleiding"&&g.jsx(WSe,{}),g.jsxs("section",{className:"pt-2 border-t border-gray-200 space-y-2",children:[g.jsxs("a",{href:BSe,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 w-full px-3 py-2 text-orange-600 hover:bg-orange-50 rounded-lg transition-colors",children:[g.jsx(fV,{size:14}),g.jsx("span",{className:"text-sm",children:"Meld een bug of geef feedback"})]}),g.jsxs("p",{className:"text-xs text-gray-400 text-center",children:["DetectorApp NL v",mw," - Gratis en zonder tracking"]})]})]})]})]})})}function USe(){return g.jsxs(g.Fragment,{children:[g.jsxs("section",{children:[g.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Over deze app"}),g.jsx("p",{className:"text-gray-600",children:"DetectorApp NL is d gratis kaartapplicatie voor metaaldetectie, fossielen zoeken en archeologische verkenning in Nederland. Met 70+ kaartlagen, GPS tracking met richtingspijl, eigen lagen, cloud sync en uitgebreid vondstenbeheer."})]}),g.jsxs("section",{children:[g.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Databronnen & Licenties"}),g.jsxs("ul",{className:"space-y-2 text-gray-600",children:[g.jsxs("li",{children:[g.jsx("strong",{children:"RCE / Cultureelerfgoed.nl"})," (CC0/CC-BY)",g.jsx("br",{}),g.jsx("span",{className:"text-xs",children:"AMK Monumenten, Rijksmonumenten, Werelderfgoed, Paleokaarten, Religieus Erfgoed, Essen, Archeo Onderzoeken"})]}),g.jsxs("li",{children:[g.jsx("strong",{children:"PDOK / Kadaster"})," (CC0/CC-BY)",g.jsx("br",{}),g.jsx("span",{className:"text-xs",children:"Luchtfoto, AHN Hoogtekaarten, IKAW, Bodemkaart, Geomorfologie, Kadastrale Grenzen, Gewaspercelen"})]}),g.jsxs("li",{children:[g.jsx("strong",{children:"OpenStreetMap"})," (ODbL)",g.jsx("br",{}),g.jsx("span",{className:"text-xs",children:"Hunebedden, Grafheuvels, Bunkers, Kastelen, Terpen, Parken, Kringloopwinkels, Musea, Speeltuinen, Strandjes"})]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Itiner-E / Wetenschappelijk"})," (CC BY 4.0)",g.jsx("br",{}),g.jsx("span",{className:"text-xs",children:"Romeinse wegen - Brughmans, Paout, de Soto & Bjerregaard Vahlstrup"})]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Mindat.org"}),g.jsx("br",{}),g.jsx("span",{className:"text-xs",children:"Mineralen hotspots en vindplaatsen"})]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Paleontica / Fossielen data"}),g.jsx("br",{}),g.jsx("span",{className:"text-xs",children:"Fossiel hotspots en vindplaatsen"})]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Map5.nl / Kadaster"}),g.jsx("br",{}),g.jsx("span",{className:"text-xs",children:"Historische kaarten (TMK 1850, Bonnebladen 1900)"})]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Provinciale data"}),g.jsx("br",{}),g.jsx("span",{className:"text-xs",children:"Relictenkaart (Gelderland), Scheepswrakken (Zuid-Holland), Verdronken Dorpen (Zeeland)"})]}),g.jsxs("li",{children:[g.jsx("strong",{children:"UIKAV / Rijkswaterstaat"}),g.jsx("br",{}),g.jsx("span",{className:"text-xs",children:"Uiterwaarden archeologische data, Expert advies, Bufferlagen"})]})]})]}),g.jsxs("section",{children:[g.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Privacy & Opslag"}),g.jsxs("div",{className:"text-gray-600 space-y-2",children:[g.jsxs("p",{children:[g.jsx("strong",{children:"Volledig anoniem mogelijk:"})," Je kunt deze app gebruiken zonder enige registratie of login. Al je data blijft dan 100% op je eigen apparaat."]}),g.jsxs("p",{children:[g.jsx("strong",{children:"Geen tracking:"})," Deze app verzamelt geen analytics, cookies, gebruiksstatistieken of persoonlijke gegevens. Er is geen server die je gedrag registreert."]}),g.jsxs("p",{children:[g.jsx("strong",{children:"Locatiegegevens:"})," Je GPS-positie wordt alleen gebruikt om je locatie op de kaart te tonen. Deze wordt niet opgeslagen of gedeeld met derden."]})]})]}),g.jsxs("section",{children:[g.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Google Login - Wat betekent het?"}),g.jsxs("div",{className:"text-gray-600 space-y-2",children:[g.jsx("p",{className:"font-medium text-green-700",children:" Google login is volledig optioneel"}),g.jsx("p",{children:g.jsx("strong",{children:"Wat wordt gesynchroniseerd:"})}),g.jsxs("ul",{className:"list-disc list-inside ml-2 text-xs space-y-1",children:[g.jsx("li",{children:"Je eigen aangemaakte lagen (Mijn Lagen)"}),g.jsx("li",{children:"Je vondsten registraties"}),g.jsx("li",{children:"Je preset-instellingen"})]}),g.jsx("p",{children:g.jsx("strong",{children:"Wat NIET wordt gedeeld:"})}),g.jsxs("ul",{className:"list-disc list-inside ml-2 text-xs space-y-1",children:[g.jsx("li",{children:"Je GPS-locatie wordt niet opgeslagen in de cloud"}),g.jsx("li",{children:"Je zoekgeschiedenis wordt niet bewaard"}),g.jsx("li",{children:"Welke kaartlagen je bekijkt wordt niet geregistreerd"}),g.jsx("li",{children:"Niemand anders kan je data zien - alleen jij"})]}),g.jsxs("p",{children:[g.jsx("strong",{children:"Waarom inloggen?"})," Alleen voor synchronisatie tussen apparaten (telefoon/tablet/PC) en als backup voor je vondsten."]}),g.jsx("p",{className:"text-xs text-gray-500 italic",children:"Tip: Gebruik de app gerust zonder login als je privacy belangrijker vindt dan synchronisatie. Alle functies werken ook offline."})]})]}),g.jsxs("section",{children:[g.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Zonder login (anoniem)"}),g.jsxs("div",{className:"text-gray-600 space-y-2",children:[g.jsx("p",{className:"font-medium text-blue-700",children:" 95% van de functies werkt zonder login"}),g.jsx("p",{children:g.jsx("strong",{children:"Beschikbaar zonder login:"})}),g.jsxs("ul",{className:"list-disc list-inside ml-2 text-xs space-y-1",children:[g.jsx("li",{children:"Alle 70+ kaartlagen bekijken"}),g.jsx("li",{children:"GPS tracking en navigatie"}),g.jsx("li",{children:"Vondsten registreren (lokaal opgeslagen)"}),g.jsx("li",{children:"Eigen lagen aanmaken (lokaal opgeslagen)"}),g.jsx("li",{children:"Export naar Excel/CSV/GeoJSON/GPX/KML"}),g.jsx("li",{children:"Lagen importeren"}),g.jsx("li",{children:"Alle presets en instellingen"})]}),g.jsx("p",{children:g.jsx("strong",{children:"Alleen met login:"})}),g.jsxs("ul",{className:"list-disc list-inside ml-2 text-xs space-y-1",children:[g.jsx("li",{children:"Synchronisatie tussen apparaten"}),g.jsx("li",{children:"Cloud backup van je vondsten"})]})]})]})]})}function $Se(){return g.jsxs(g.Fragment,{children:[g.jsxs("section",{children:[g.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[g.jsx($C,{size:16,className:"text-blue-600"}),"Kaartlagen (70+)"]}),g.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[g.jsxs("li",{children:[g.jsx("strong",{children:"Basis:"})," CartoDB, OpenStreetMap, PDOK Luchtfoto"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Historisch:"})," TMK 1850, Bonnebladen 1900"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Hoogtekaarten:"})," AHN4 Hillshade, Multi-Hillshade, Hoogtekaart Kleur, AHN 0.5m"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Archeologie:"})," AMK Monumenten (per periode), Archeo Onderzoeken, IKAW, Essen"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Romeins:"})," Romeinse wegen, Romeinse Forten met historische info, Limesweg"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Prehistorie:"})," Hunebedden, Grafheuvels, Terpen, Paleokaarten (7 periodes)"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Militair:"})," WWII Bunkers, Slagvelden, Vliegvelden, Verdedigingslinies"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Erfgoed:"})," Rijksmonumenten, Kastelen, Runes, Religieus Erfgoed"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Terrein:"})," Veengebieden, Geomorfologie, Bodemkaart"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Percelen:"})," Gewaspercelen (met bouwplantoelichting), Kadastrale Grenzen"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Recreatie:"})," Parken, Musea, Kringloopwinkels, Strandjes, Wandelroutes"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Provinciaal:"})," Relictenkaart, Scheepswrakken, Verdronken Dorpen"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"UIKAV:"})," Uiterwaard data, Expert advies, Vlakken, Punten, Bufferlagen"]})]})]}),g.jsxs("section",{children:[g.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[g.jsx(wce,{size:16,className:"text-purple-600"}),"Mineralen & Fossielen"]}),g.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[g.jsxs("li",{children:[g.jsx("strong",{children:"Mineralen hotspots:"})," Vindplaatsen uit Mindat.org met mineralenlijst"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Goudrivieren:"})," Bekende locaties voor goud zoeken"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Fossiel hotspots:"})," Vindplaatsen met fossieltypen en periodes"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Premium lagen:"})," Gedetailleerde data (beschikbaar met account)"]})]})]}),g.jsxs("section",{children:[g.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[g.jsx(mce,{size:16,className:"text-orange-600"}),"Mijn Lagen"]}),g.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[g.jsxs("li",{children:[g.jsx("strong",{children:"Eigen lagen:"})," Maak lagen voor vakantie, projecten, etc."]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Toevoegen:"})," Tik op + in popup om monument/locatie aan laag toe te voegen"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Polygonen:"})," Hele monumentgebieden worden opgeslagen, niet alleen een punt"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Originele info:"})," Popup content blijft behouden"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Kleuren:"})," Elke laag krijgt eigen kleur (aanpasbaar)"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Import:"})," Laad GeoJSON, KML of GPX bestanden"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Export:"})," Exporteer lagen als GeoJSON"]})]})]}),g.jsxs("section",{children:[g.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[g.jsx(kR,{size:16,className:"text-green-600"}),"Google Cloud Sync"]}),g.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[g.jsxs("li",{children:[g.jsx("strong",{children:"Inloggen:"})," Via hamburger menu rechtsboven"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Synchronisatie:"})," Lagen en vondsten automatisch naar cloud"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Meerdere apparaten:"})," Altijd toegang tot je data"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Veilig:"})," Alleen jij hebt toegang tot je gegevens"]})]})]}),g.jsxs("section",{children:[g.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[g.jsx(WC,{size:16,className:"text-green-600"}),"GPS & Navigatie"]}),g.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[g.jsx("li",{children:"Live GPS tracking met nauwkeurigheidscirkel"}),g.jsx("li",{children:"Richtingspijl draait mee met je telefoon"}),g.jsx("li",{children:"Kaart handmatig draaien + kompasknop naar noorden"}),g.jsx("li",{children:"Schaalbalk onderaan (aan/uit in Instellingen)"}),g.jsx("li",{children:"Open locatie in Google Maps vanuit popup"}),g.jsx("li",{children:"Zoekbalk voor adressen en plaatsen"})]})]}),g.jsxs("section",{children:[g.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[g.jsx(ya,{size:16,className:"text-orange-600"}),"Vondsten"]}),g.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[g.jsx("li",{children:"Toevoegen via GPS locatie, long-press of handmatig"}),g.jsx("li",{children:"Velden: type, materiaal, periode, diepte, conditie, gewicht"}),g.jsx("li",{children:"Foto's toevoegen (link of upload)"}),g.jsx("li",{children:"Export: Excel, CSV, GeoJSON, GPX, KML"}),g.jsx("li",{children:"Dashboard met statistieken"}),g.jsx("li",{children:"Cloud sync met Google account"})]})]}),g.jsxs("section",{children:[g.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[g.jsx(za,{size:16,className:"text-purple-600"}),"Presets"]}),g.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[g.jsxs("li",{children:[g.jsx("strong",{children:"Standaard:"})," Detectie, Steentijd, Romeins, Middeleeuwen, WOII, Analyse, Fossielen, Mineralen"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Aanpasbaar:"})," Overschrijf preset met huidige lagen (diskette-icoon)"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Eigen presets:"})," Maak nieuwe via Instellingen"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Tekstgrootte:"})," Aanpasbaar per panel via slider"]})]})]}),g.jsxs("section",{children:[g.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[g.jsx(zce,{size:16,className:"text-cyan-600"}),"Perceelinformatie"]}),g.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[g.jsx("li",{children:"Kadastrale aanduiding (gemeente, sectie, nummer)"}),g.jsx("li",{children:"Oppervlakte in m en hectare"}),g.jsx("li",{children:"Gewas en bouwplan met uitleg"}),g.jsx("li",{children:"Bodemtype met beschrijving"}),g.jsx("li",{children:"AHN hoogte in meters NAP"}),g.jsx("li",{children:"Hoogtekaart per perceel (bergje-icoon)"}),g.jsx("li",{children:"Link naar eigenaar opzoeken (Kadaster)"})]})]}),g.jsxs("section",{children:[g.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[g.jsx(pue,{size:16,className:"text-red-600"}),"Monumenten & Erfgoed"]}),g.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[g.jsxs("li",{children:[g.jsx("strong",{children:"AMK:"})," Archeologische Monumenten per periode"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Romeinse Forten:"})," Uitgebreide historische info per fort"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Rijksmonumenten:"})," Met bescherming en historie"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Verdedigingswerken:"})," Linies, forten, schansen"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Popup info:"})," Directe uitleg over archeologische waarde"]})]})]})]})}function WSe(){return g.jsxs(g.Fragment,{children:[g.jsxs("section",{children:[g.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Eerste stappen"}),g.jsxs("ol",{className:"text-gray-600 space-y-2 text-xs list-decimal list-inside",children:[g.jsxs("li",{children:["Tik op de ",g.jsx("strong",{children:"GPS knop"})," (rechtsonder, oranje) om je locatie te zien"]}),g.jsxs("li",{children:["Kies een ",g.jsx("strong",{children:"preset"})," (linksonder, laagjes-icoon) voor een snelle start"]}),g.jsxs("li",{children:["Of open ",g.jsx("strong",{children:"Kaartlagen"})," om individuele lagen aan te zetten"]}),g.jsx("li",{children:"Tik op objecten op de kaart voor gedetailleerde informatie"})]})]}),g.jsxs("section",{children:[g.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Hamburger Menu"}),g.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[g.jsx("p",{children:"Rechtsboven vind je het menu met:"}),g.jsxs("ul",{className:"list-disc list-inside ml-2 space-y-1",children:[g.jsxs("li",{children:[g.jsx("strong",{children:"Google Login:"})," Synchroniseer je data naar de cloud"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Vondst toevoegen:"})," Registreer een nieuwe vondst"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Info & Handleiding:"})," Dit scherm"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Instellingen:"})," Presets, export, weergave"]})]})]})]}),g.jsxs("section",{children:[g.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"GPS & Navigatie"}),g.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[g.jsxs("p",{children:[g.jsx("strong",{children:"GPS knop (oranje):"})," Aan/uit toggle voor locatie tracking."]}),g.jsxs("p",{children:[g.jsx("strong",{children:"Richtingspijl:"})," Blauwe pijl toont de richting van je telefoon."]}),g.jsxs("p",{children:[g.jsx("strong",{children:"Kaart draaien:"})," Met twee vingers of via kompas."]}),g.jsxs("p",{children:[g.jsx("strong",{children:"Kompasknop:"})," Verschijnt rechtsboven als kaart gedraaid is. Tik om naar noorden te draaien."]}),g.jsxs("p",{children:[g.jsx("strong",{children:"Google Maps:"})," Vanuit elke popup kun je direct navigeren."]})]})]}),g.jsxs("section",{children:[g.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Locaties opslaan in Mijn Lagen"}),g.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[g.jsxs("p",{children:[g.jsx("strong",{children:"Stap 1:"})," Tik op een object op de kaart (monument, bunker, etc.)"]}),g.jsxs("p",{children:[g.jsx("strong",{children:"Stap 2:"})," Tik op de ",g.jsx("strong",{children:"oranje +"})," knop in de popup header"]}),g.jsxs("p",{children:[g.jsx("strong",{children:"Stap 3:"})," Kies een bestaande laag of maak een nieuwe aan"]}),g.jsxs("p",{children:[g.jsx("strong",{children:"Resultaat:"})," De locatie inclusief vorm (polygoon) en info wordt opgeslagen!"]}),g.jsx("p",{className:"text-gray-500 italic",children:"Tip: Maak lagen voor vakantiebestemmingen, projecten of interessante locaties."})]})]}),g.jsxs("section",{children:[g.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Vondst registreren"}),g.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[g.jsxs("p",{children:[g.jsx("strong",{children:"Via GPS:"})," Open menu  Vondst toevoegen. Je locatie wordt automatisch ingevuld."]}),g.jsxs("p",{children:[g.jsx("strong",{children:"Via long-press:"}),' Houd je vinger op de kaart  kies "Vondst toevoegen".']}),g.jsxs("p",{children:[g.jsx("strong",{children:"Handmatig:"}),' In het formulier  "Kies op kaart" voor exacte locatie.']}),g.jsxs("p",{children:[g.jsx("strong",{children:"Foto's:"})," Voeg foto-links toe of upload direct."]})]})]}),g.jsxs("section",{children:[g.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Presets gebruiken"}),g.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[g.jsxs("p",{children:[g.jsx("strong",{children:"Toepassen:"})," Linksonder  preset kiezen."]}),g.jsxs("p",{children:[g.jsx("strong",{children:"Aanpassen:"})," Zet gewenste lagen aan  tik diskette-icoon naast preset."]}),g.jsxs("p",{children:[g.jsx("strong",{children:"Nieuw maken:"}),' Instellingen  Presets  "Huidige lagen opslaan".']})]})]}),g.jsxs("section",{children:[g.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Cloud Sync instellen"}),g.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[g.jsxs("p",{children:[g.jsx("strong",{children:"Stap 1:"})," Open hamburger menu rechtsboven"]}),g.jsxs("p",{children:[g.jsx("strong",{children:"Stap 2:"}),' Tik op "Inloggen met Google"']}),g.jsxs("p",{children:[g.jsx("strong",{children:"Stap 3:"})," Kies je Google account"]}),g.jsxs("p",{children:[g.jsx("strong",{children:"Klaar!"})," Je lagen en vondsten worden automatisch gesynchroniseerd."]}),g.jsx("p",{className:"text-gray-500 italic",children:"Je data is veilig en alleen voor jou toegankelijk."})]})]}),g.jsxs("section",{children:[g.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Lagen importeren"}),g.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[g.jsxs("p",{children:[g.jsx("strong",{children:"Stap 1:"})," Ga naar Instellingen (hamburger menu)"]}),g.jsxs("p",{children:[g.jsx("strong",{children:"Stap 2:"}),' Scroll naar "Lagen importeren"']}),g.jsxs("p",{children:[g.jsx("strong",{children:"Stap 3:"})," Kies een GeoJSON, KML of GPX bestand"]}),g.jsxs("p",{children:[g.jsx("strong",{children:"Resultaat:"})," Nieuwe laag met je geimporteerde data!"]}),g.jsx("p",{className:"text-gray-500 italic",children:"Handig voor routes, waypoints of eigen datasets."})]})]}),g.jsxs("section",{children:[g.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Tips voor detectie"}),g.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs list-disc list-inside",children:[g.jsxs("li",{children:["Gebruik ",g.jsx("strong",{children:"AHN Hillshade"})," om relif te zien (grafheuvels, wallen)"]}),g.jsxs("li",{children:["Combineer ",g.jsx("strong",{children:"AMK"})," met ",g.jsx("strong",{children:"Gewaspercelen"})," voor slimme zoeklocaties"]}),g.jsxs("li",{children:["Check ",g.jsx("strong",{children:"IKAW"})," voor archeologische verwachting"]}),g.jsxs("li",{children:["Gebruik ",g.jsx("strong",{children:"historische kaarten"})," (TMK 1850) om oude structuren te vinden"]}),g.jsxs("li",{children:["Bekijk ",g.jsx("strong",{children:"Archeo Onderzoeken"})," voor eerdere vondsten in het gebied"]}),g.jsxs("li",{children:[g.jsx("strong",{children:"Bodemkaart"})," toont of grond geschikt is (popup legt uit)"]})]})]}),g.jsxs("section",{children:[g.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Tips voor fossielen"}),g.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs list-disc list-inside",children:[g.jsxs("li",{children:["Zet ",g.jsx("strong",{children:"Fossiel hotspots"})," aan voor bekende vindplaatsen"]}),g.jsxs("li",{children:["Bekijk ",g.jsx("strong",{children:"Paleokaarten"})," voor historische kustlijnen"]}),g.jsxs("li",{children:["Check ",g.jsx("strong",{children:"Geomorfologie"})," voor oude zeebodems en rivieren"]}),g.jsx("li",{children:"Popup toont welke fossielen op elke locatie gevonden zijn"})]})]}),g.jsxs("section",{children:[g.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Tips voor mineralen"}),g.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs list-disc list-inside",children:[g.jsxs("li",{children:["Zet ",g.jsx("strong",{children:"Mineralen hotspots"})," aan voor vindplaatsen"]}),g.jsxs("li",{children:["Bekijk ",g.jsx("strong",{children:"Goudrivieren"})," voor goudzoekmogelijkheden"]}),g.jsx("li",{children:"Popup toont welke mineralen op elke locatie voorkomen"}),g.jsx("li",{children:"Links naar Mindat.org voor gedetailleerde info"})]})]}),g.jsxs("section",{children:[g.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[g.jsx(Iu,{size:16,className:"text-blue-600"}),"Handige links"]}),g.jsxs("ul",{className:"text-gray-600 space-y-2 text-xs",children:[g.jsxs("li",{children:[g.jsx("a",{href:"https://legendageomorfologie.wur.nl/",target:"_blank",rel:"noopener",className:"text-blue-600 hover:underline font-medium",children:"Geomorfologie legenda (WUR)"}),g.jsx("br",{}),g.jsx("span",{className:"text-gray-500",children:"Uitgebreide uitleg over landvormen"})]}),g.jsxs("li",{children:[g.jsx("a",{href:"https://legenda-bodemkaart.bodemdata.nl/",target:"_blank",rel:"noopener",className:"text-blue-600 hover:underline font-medium",children:"Bodemkaart legenda (BRO)"}),g.jsx("br",{}),g.jsx("span",{className:"text-gray-500",children:"Volledige bodemclassificatie"})]}),g.jsxs("li",{children:[g.jsx("a",{href:"https://www.mindat.org/",target:"_blank",rel:"noopener",className:"text-blue-600 hover:underline font-medium",children:"Mindat.org - Mineralen database"}),g.jsx("br",{}),g.jsx("span",{className:"text-gray-500",children:"Wereldwijde mineralen informatie"})]}),g.jsxs("li",{children:[g.jsx("a",{href:"https://www.cultureelerfgoed.nl/",target:"_blank",rel:"noopener",className:"text-blue-600 hover:underline font-medium",children:"Rijksdienst voor Cultureel Erfgoed"}),g.jsx("br",{}),g.jsx("span",{className:"text-gray-500",children:"Officile monumenten informatie"})]})]})]})]})}function lz(n,e,t,r){const s=(r-e)*Math.PI/180,a=(t-n)*Math.PI/180,o=Math.sin(s/2)*Math.sin(s/2)+Math.cos(e*Math.PI/180)*Math.cos(r*Math.PI/180)*Math.sin(a/2)*Math.sin(a/2);return 6371e3*(2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o)))}function YS(n){let e=0;for(let t=1;t<n.length;t++)e+=lz(n[t-1].coordinates[0],n[t-1].coordinates[1],n[t].coordinates[0],n[t].coordinates[1]);return e}const So=ms()(vl((n,e)=>({state:"idle",currentPoints:[],startTime:null,pauseStartTime:null,totalPausedTime:0,savedRoutes:[],visibleRouteIds:new Set,heatmapEnabled:!1,gridEnabled:!1,gridCenter:null,gridSize:20,gridCount:10,gridColor:"rgba(139, 92, 246, 0.6)",autoPauseEnabled:!1,autoPauseSeconds:120,startRecording:()=>{n({state:"recording",currentPoints:[],startTime:Date.now(),pauseStartTime:null,totalPausedTime:0})},pauseRecording:()=>{const{state:t}=e();t==="recording"&&n({state:"paused",pauseStartTime:Date.now()})},resumeRecording:()=>{const{state:t,pauseStartTime:r,totalPausedTime:i}=e();if(t!=="paused"||!r)return;const s=Date.now()-r;n({state:"recording",pauseStartTime:null,totalPausedTime:i+s})},stopRecording:t=>{const{state:r,currentPoints:i,startTime:s,totalPausedTime:a,pauseStartTime:o}=e();if(r==="idle"||!s||i.length<2)return n({state:"idle",currentPoints:[],startTime:null,pauseStartTime:null,totalPausedTime:0}),null;const l=Date.now();let c=a;o&&(c+=l-o);const h=l-s-c,f=YS(i),m={id:crypto.randomUUID(),name:t||`Route ${new Date().toLocaleDateString("nl-NL")} ${new Date().toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"})}`,points:i,startTime:s,endTime:l,totalDistance:f,totalDuration:h,pausedDuration:c,createdAt:new Date().toISOString()};return n(y=>({state:"idle",currentPoints:[],startTime:null,pauseStartTime:null,totalPausedTime:0,savedRoutes:[m,...y.savedRoutes]})),m},cancelRecording:()=>{n({state:"idle",currentPoints:[],startTime:null,pauseStartTime:null,totalPausedTime:0})},addPoint:(t,r,i)=>{const{state:s,currentPoints:a}=e();if(s!=="recording")return;if(a.length>0){const l=a[a.length-1];if(lz(l.coordinates[0],l.coordinates[1],t,r)<2)return}const o={coordinates:[t,r],timestamp:Date.now(),accuracy:i};n({currentPoints:[...a,o]})},deleteRoute:t=>{n(r=>({savedRoutes:r.savedRoutes.filter(i=>i.id!==t)}))},renameRoute:(t,r)=>{n(i=>({savedRoutes:i.savedRoutes.map(s=>s.id===t?{...s,name:r}:s)}))},clearAllRoutes:()=>{n({savedRoutes:[],visibleRouteIds:new Set})},toggleRouteVisibility:t=>{n(r=>{const i=new Set(r.visibleRouteIds);return i.has(t)?i.delete(t):i.add(t),{visibleRouteIds:i}})},showRoute:t=>{n(r=>{const i=new Set(r.visibleRouteIds);return i.add(t),{visibleRouteIds:i}})},hideRoute:t=>{n(r=>{const i=new Set(r.visibleRouteIds);return i.delete(t),{visibleRouteIds:i}})},showAllRoutes:()=>{n(t=>({visibleRouteIds:new Set(t.savedRoutes.map(r=>r.id))}))},hideAllRoutes:()=>{n({visibleRouteIds:new Set})},toggleHeatmap:()=>{n(t=>({heatmapEnabled:!t.heatmapEnabled}))},setHeatmapEnabled:t=>{n({heatmapEnabled:t})},toggleGrid:()=>{n(t=>({gridEnabled:!t.gridEnabled}))},setGridEnabled:t=>{n({gridEnabled:t})},setGridCenter:t=>{n({gridCenter:t})},setGridSize:t=>{n({gridSize:t})},setGridCount:t=>{n({gridCount:t})},setGridColor:t=>{n({gridColor:t})},centerGridOnCurrentLocation:()=>{"geolocation"in navigator&&navigator.geolocation.getCurrentPosition(t=>{n({gridCenter:[t.coords.longitude,t.coords.latitude],gridEnabled:!0})},t=>{console.error("Could not get location:",t)})},setAutoPauseEnabled:t=>{n({autoPauseEnabled:t})},setAutoPauseSeconds:t=>{n({autoPauseSeconds:t})},importRouteFromGPX:(t,r)=>{try{const s=new DOMParser().parseFromString(t,"application/xml");if(s.querySelector("parsererror"))return{success:!1,error:"Ongeldig XML formaat"};const o=s.querySelectorAll("trkpt");if(o.length<2&&s.querySelectorAll("wpt").length<2)return{success:!1,error:"Geen route punten gevonden in GPX bestand"};const l=[];if((o.length>0?o:s.querySelectorAll("wpt")).forEach(w=>{const S=parseFloat(w.getAttribute("lat")||"0"),b=parseFloat(w.getAttribute("lon")||"0"),R=w.querySelector("time"),M=R?new Date(R.textContent||"").getTime():Date.now();!isNaN(S)&&!isNaN(b)&&l.push({coordinates:[b,S],timestamp:isNaN(M)?Date.now():M})}),l.length<2)return{success:!1,error:"Niet genoeg geldige punten in GPX bestand"};const h=s.querySelector("trk > name")?.textContent||s.querySelector("metadata > name")?.textContent||r||`Import ${new Date().toLocaleDateString("nl-NL")}`,f=YS(l),m=l[0].timestamp,y=l[l.length-1].timestamp,x=y-m,_={id:crypto.randomUUID(),name:h,points:l,startTime:m,endTime:y,totalDistance:f,totalDuration:x>0?x:0,pausedDuration:0,createdAt:new Date().toISOString()};return n(w=>({savedRoutes:[_,...w.savedRoutes]})),{success:!0,routeId:_.id}}catch(i){return console.error("GPX import error:",i),{success:!1,error:"Fout bij importeren van GPX bestand"}}},updateRouteNotes:(t,r)=>{n(i=>({savedRoutes:i.savedRoutes.map(s=>s.id===t?{...s,notes:r}:s)}))},addPhotoToRoute:(t,r)=>{const i={...r,id:crypto.randomUUID(),timestamp:new Date().toISOString()};n(s=>({savedRoutes:s.savedRoutes.map(a=>a.id===t?{...a,photos:[...a.photos||[],i]}:a)}))},removePhotoFromRoute:(t,r)=>{n(i=>({savedRoutes:i.savedRoutes.map(s=>s.id===t?{...s,photos:(s.photos||[]).filter(a=>a.id!==r)}:s)}))},getCurrentDistance:()=>{const{currentPoints:t}=e();return YS(t)},getCurrentDuration:()=>{const{state:t,startTime:r,totalPausedTime:i,pauseStartTime:s}=e();if(!r)return 0;const a=Date.now();let o=i;return t==="paused"&&s&&(o+=a-s),a-r-o},getAverageSpeed:()=>{const t=e().getCurrentDistance(),r=e().getCurrentDuration();return r===0?0:t/1e3/(r/36e5)}}),{name:"detectorapp-route-recording",version:2,partialize:n=>({savedRoutes:n.savedRoutes,visibleRouteIds:Array.from(n.visibleRouteIds),heatmapEnabled:n.heatmapEnabled,gridEnabled:n.gridEnabled,gridCenter:n.gridCenter,gridSize:n.gridSize,gridCount:n.gridCount,gridColor:n.gridColor,autoPauseEnabled:n.autoPauseEnabled,autoPauseSeconds:n.autoPauseSeconds}),merge:(n,e)=>({...e,...n,visibleRouteIds:new Set(n?.visibleRouteIds||[])})}));function cz(n){const e=`<?xml version="1.0" encoding="UTF-8"?>
<gpx version="1.1" creator="DetectorApp NL"
  xmlns="http://www.topografix.com/GPX/1/1"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd">
  <metadata>
    <name>${n.name}</name>
    <time>${new Date(n.startTime).toISOString()}</time>
  </metadata>
  <trk>
    <name>${n.name}</name>
    <trkseg>
${n.points.map(s=>`      <trkpt lat="${s.coordinates[1]}" lon="${s.coordinates[0]}">
        <time>${new Date(s.timestamp).toISOString()}</time>
      </trkpt>`).join(`
`)}
    </trkseg>
  </trk>
</gpx>`,t=new Blob([e],{type:"application/gpx+xml"}),r=URL.createObjectURL(t),i=document.createElement("a");i.href=r,i.download=`${n.name.replace(/[^a-zA-Z0-9]/g,"-")}.gpx`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(r)}let _u=null,yp=null;function uz(){if(typeof window>"u"||!("speechSynthesis"in window))return!1;_u=window.speechSynthesis;const n=()=>{const e=_u?.getVoices()||[];yp=e.find(t=>t.lang.startsWith("nl")||t.name.toLowerCase().includes("dutch")||t.name.toLowerCase().includes("nederland"))||null,!yp&&e.length>0&&(yp=e[0])};return n(),_u&&(_u.onvoiceschanged=n),!0}function HSe(n,e){if(!_u&&!uz()||!_u)return;_u.cancel();const t=new SpeechSynthesisUtterance(n);yp&&(t.voice=yp),t.lang="nl-NL",t.rate=e?.rate,t.pitch=e?.pitch??1,t.volume=e?.volume??1,_u.speak(t)}function KSe(n){const e=[];e.push(`${n.type} toegevoegd`),n.material&&n.material!=="Onbekend"&&e.push(`Materiaal: ${n.material}`),n.period&&n.period!=="Onbekend"&&e.push(`Periode: ${n.period}`),n.layerName&&n.layerName!=="Vondsten"&&e.push(`Opgeslagen in ${n.layerName}`);const t=e.join(". ");HSe(t,{rate:1.1})}uz();function ZS({label:n,value:e,onChange:t,options:r,required:i=!1,placeholder:s="Typ hier..."}){const[a,o]=X.useState(!1),[l,c]=X.useState(!1),[h,f]=X.useState(""),m=e&&!r.includes(e),y=()=>{c(!0),f(m?e:""),o(!1)},x=()=>{h.trim()&&t(h.trim()),c(!1)};return l?g.jsxs("div",{children:[g.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:[n,i&&g.jsx("span",{className:"text-orange-500 ml-0.5",children:"*"})]}),g.jsx("input",{type:"text",value:h,onChange:_=>f(_.target.value),onKeyDown:_=>{_.key==="Enter"&&(_.preventDefault(),x()),_.key==="Escape"&&c(!1)},onBlur:x,placeholder:s,autoFocus:!0,className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all",style:{border:"none",outline:"none"}})]}):g.jsxs("div",{className:"relative",children:[g.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:[n,i&&g.jsx("span",{className:"text-orange-500 ml-0.5",children:"*"})]}),g.jsxs("button",{type:"button",onClick:()=>o(!a),className:"w-full flex items-center justify-between px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors text-left",style:{border:"none",outline:"none"},children:[g.jsxs("span",{className:e?"":"text-gray-400",children:[e||"Selecteer...",m&&g.jsx(YO,{size:12,className:"inline ml-1 text-orange-500"})]}),g.jsx(PE,{size:16,className:`text-gray-400 transition-transform ${a?"rotate-180":""}`})]}),a&&g.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-white rounded-lg shadow-lg max-h-48 overflow-y-auto",children:[g.jsxs("button",{type:"button",onClick:y,className:"w-full px-3 py-2 text-left text-sm text-orange-600 hover:bg-orange-50 transition-colors flex items-center gap-2",style:{border:"none",outline:"none"},children:[g.jsx(YO,{size:12}),"Eigen invoer..."]}),g.jsx("div",{className:"border-t border-gray-100"}),r.map(_=>g.jsx("button",{type:"button",onClick:()=>{t(_),o(!1)},className:`w-full px-3 py-2 text-left text-sm transition-colors ${_===e?"bg-orange-50 text-orange-600":"text-gray-600 hover:bg-gray-50"}`,style:{border:"none",outline:"none"},children:_},_))]})]})}function hz({onClose:n,initialLocation:e}){const t=ws(Fe=>Fe.position),r=pi(Fe=>Fe.map),i=wr(Fe=>Fe.vondstFormPhoto),s=hs(Fe=>Fe.layers),a=hs(Fe=>Fe.addPoint),o=Sn(Fe=>Fe.voiceFeedbackEnabled),l=So(Fe=>Fe.state),c=So(Fe=>Fe.startTime);So(Fe=>Fe.savedRoutes);const h=()=>l==="idle"||!c?null:`Route ${new Date(c).toLocaleDateString("nl-NL")} ${new Date(c).toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"})}`,f=l==="recording"||l==="paused",m=h(),[y,x]=X.useState(""),[_,w]=X.useState(""),[S,b]=X.useState(""),[R,M]=X.useState(""),[O,G]=X.useState(!1),[A,I]=X.useState(void 0),[P,D]=X.useState(void 0),[L,U]=X.useState(uo),[j,Ee]=X.useState(i),[ke,Be]=X.useState(null);X.useEffect(()=>{if(j){const Fe=URL.createObjectURL(j);return Be(Fe),()=>URL.revokeObjectURL(Fe)}else Be(null)},[j]);const[Me,ce]=X.useState(e?"map-pick":t?"gps":"map-center"),[Pe,be]=X.useState(e||null),[se,V]=X.useState(!1),Z=()=>{if(Me==="gps"&&t)return{lat:t.lat,lng:t.lng};if(Me==="map-pick"&&Pe)return Pe;if(r){const Fe=r.getView().getCenter();if(Fe){const[wt,jt]=En(Fe);return{lat:jt,lng:wt}}}return null},te=Z();X.useEffect(()=>{if(!se||!r)return;const Fe=wt=>{const[jt,Dt]=En(wt.coordinate);be({lat:Dt,lng:jt}),ce("map-pick"),V(!1)};return r.on("click",Fe),()=>r.un("click",Fe)},[se,r]);const ie=()=>V(!0),ue=()=>{t&&(ce("gps"),be(null))},Ve=()=>{const Fe=document.createElement("input");Fe.type="file",Fe.accept="image/*",Fe.capture="environment",Fe.onchange=wt=>{const jt=wt.target.files?.[0];jt&&Ee(jt)},Fe.click()},Ge=()=>Ee(null),ye=async Fe=>{Fe.preventDefault();const wt=Z();if(!wt){alert("Geen locatie beschikbaar");return}if(!_){alert("Vul een naam/type in");return}G(!0);try{let jt=y||"";if(L===uo){const Kt=[];S&&Kt.push(`Materiaal: ${S}`),R&&Kt.push(`Periode: ${R}`),A&&Kt.push(`Gewicht: ${A}g`),P&&Kt.push(`Lengte: ${P}mm`),Kt.length>0&&(jt=Kt.join(" | ")+(y?` | ${y}`:""))}a(L,{coordinates:[wt.lng,wt.lat],name:_,category:L===uo?_:"Overig",notes:jt||"",...f&&c?{routeId:`recording-${c}`,routeName:m||void 0}:{}});const Dt=s.find(Kt=>Kt.id===L)?.name||"Vondsten";o&&KSe({type:_,material:S||void 0,period:R||void 0,layerName:Dt}),alert(`Toegevoegd aan ${Dt}! `),n()}catch(jt){alert("Fout bij opslaan: "+jt.message)}finally{G(!1)}},pe=X.useMemo(()=>s.map(Fe=>({id:Fe.id,name:Fe.name,color:Fe.color})),[s]);return se?g.jsx(Rt.div,{className:"fixed bottom-0 left-0 right-0 z-[2000] p-4",initial:{y:100},animate:{y:0},exit:{y:100},children:g.jsxs("div",{className:"bg-orange-500 text-white rounded-xl shadow-xl p-4 flex items-center justify-between max-w-md mx-auto",children:[g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx(Fv,{size:24,className:"animate-pulse"}),g.jsxs("div",{children:[g.jsx("div",{className:"font-medium",children:"Tik op de kaart"}),g.jsx("div",{className:"text-sm opacity-90",children:"om locatie te kiezen"})]})]}),g.jsx("button",{onClick:()=>V(!1),className:"px-4 py-2 bg-white/20 hover:bg-white/30 rounded-lg transition-colors border-0 outline-none",children:"Annuleren"})]})}):g.jsx(Rt.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:g.jsxs(Rt.div,{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full max-h-[90vh] overflow-hidden flex flex-col",initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},children:[g.jsxs("div",{className:"bg-gradient-to-r from-orange-500 to-orange-600 text-white px-5 py-4 flex justify-between items-center flex-shrink-0",children:[g.jsx("h2",{className:"text-lg font-semibold",children:"Nieuwe Vondst"}),g.jsx("button",{onClick:n,className:"w-8 h-8 flex items-center justify-center rounded-full hover:bg-white/20 transition-colors border-0 outline-none",children:g.jsx(si,{size:20})})]}),g.jsxs("form",{onSubmit:ye,className:"flex-1 overflow-y-auto",children:[g.jsxs("div",{className:"p-5 space-y-4",children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Foto"}),ke?g.jsxs("div",{className:"relative",children:[g.jsx("img",{src:ke,alt:"Vondst",className:"w-full h-40 object-cover rounded-xl"}),g.jsx("button",{type:"button",onClick:Ge,className:"absolute top-2 right-2 w-8 h-8 bg-red-500 text-white rounded-full flex items-center justify-center hover:bg-red-600 transition-colors border-0 outline-none shadow-lg",children:g.jsx(xc,{size:16})})]}):g.jsxs("button",{type:"button",onClick:Ve,className:"w-full h-32 bg-gray-50 rounded-xl flex flex-col items-center justify-center gap-2 hover:bg-gray-100 transition-colors text-gray-500 border-2 border-dashed border-gray-200",style:{outline:"none"},children:[g.jsx(kE,{size:32}),g.jsx("span",{className:"text-sm",children:"Maak een foto"})]})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Locatie"}),te&&g.jsxs("div",{className:"bg-orange-50 rounded-xl px-4 py-3 mb-2",children:[g.jsxs("div",{className:"text-sm text-orange-800 font-mono",children:[te.lat.toFixed(6),"N, ",te.lng.toFixed(6),"E"]}),g.jsx("div",{className:"text-xs text-orange-600 mt-1",children:Me==="gps"?" GPS locatie":Me==="map-pick"?" Gekozen op kaart":" Kaart midden"})]}),!te&&g.jsx("div",{className:"bg-red-50 rounded-xl px-4 py-3 mb-2",children:g.jsx("div",{className:"text-sm text-red-600",children:"Geen locatie beschikbaar"})}),g.jsxs("div",{className:"flex gap-2",children:[t&&Me!=="gps"&&g.jsxs("button",{type:"button",onClick:ue,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-sm bg-green-50 text-green-700 rounded-lg hover:bg-green-100 transition-colors border-0 outline-none",children:[g.jsx(WC,{size:16}),"GPS"]}),g.jsxs("button",{type:"button",onClick:ie,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-sm bg-blue-50 text-blue-700 rounded-lg hover:bg-blue-100 transition-colors border-0 outline-none",children:[g.jsx(Fv,{size:16}),"Kies op kaart"]})]})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Opslaan naar"}),g.jsx("div",{className:"flex flex-wrap gap-2",children:pe.map(Fe=>g.jsx("button",{type:"button",onClick:()=>U(Fe.id),className:`px-3 py-2 rounded-lg text-sm font-medium transition-all border-0 outline-none ${L===Fe.id?"bg-gray-800 text-white shadow-md":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:Fe.name},Fe.id))})]}),L===uo&&g.jsx(ZS,{label:"Type vondst",value:_,onChange:w,options:["Munt","Aardewerk","Gesp","Fibula","Ring","Speld","Sieraad","Gereedschap","Wapen","Anders"],required:!0,placeholder:"Typ type vondst..."}),L!==uo&&g.jsxs("div",{children:[g.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:["Naam",g.jsx("span",{className:"text-orange-500 ml-0.5",children:"*"})]}),g.jsx("input",{type:"text",value:_,onChange:Fe=>w(Fe.target.value),placeholder:"Naam van het punt...",className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all",style:{border:"none",outline:"none"}})]}),L===uo&&g.jsxs(g.Fragment,{children:[g.jsx(ZS,{label:"Materiaal",value:S,onChange:b,options:["Brons","IJzer","Zilver","Goud","Koper","Lood","Tin","Keramiek","Steen","Glas","Bot","Hout","Leer","Onbekend"],placeholder:"Typ materiaal..."}),g.jsx(ZS,{label:"Periode",value:R,onChange:M,options:["Steentijd","Bronstijd","IJzertijd","Romeins","Middeleeuws","Nieuwetijd","Modern","Onbekend"],placeholder:"Typ periode..."}),g.jsxs("div",{className:"flex gap-3",children:[g.jsxs("div",{className:"flex-1",children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Gewicht (g)"}),g.jsx("input",{type:"number",value:A??"",onChange:Fe=>I(Fe.target.value?parseFloat(Fe.target.value):void 0),className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all",style:{border:"none",outline:"none"},min:"0",step:"0.1"})]}),g.jsxs("div",{className:"flex-1",children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Lengte (mm)"}),g.jsx("input",{type:"number",value:P??"",onChange:Fe=>D(Fe.target.value?parseFloat(Fe.target.value):void 0),className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all",style:{border:"none",outline:"none"},min:"0",step:"0.1"})]})]})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Notities"}),g.jsx("textarea",{value:y,onChange:Fe=>x(Fe.target.value),className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all resize-none h-20",style:{border:"none",outline:"none"},placeholder:"Beschrijving, context, vindplaats details..."})]}),g.jsx("div",{className:"rounded-xl px-4 py-3 bg-orange-50",children:g.jsx("p",{className:"text-sm text-orange-700",children:' Opgeslagen in "Mijn Lagen" op dit apparaat'})})]}),g.jsxs("div",{className:"p-5 pt-0 flex gap-3",children:[g.jsx("button",{type:"button",onClick:n,className:"flex-1 px-4 py-3 bg-gray-100 text-gray-700 rounded-xl hover:bg-gray-200 transition-colors font-medium border-0 outline-none",children:"Annuleren"}),g.jsx("button",{type:"submit",disabled:O||!te||se||!_,className:"flex-1 px-4 py-3 bg-orange-500 text-white rounded-xl hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium border-0 outline-none",children:O?"Opslaan...":"Opslaan"})]})]})]})})}function XSe(){const{user:n,setUser:e,setLoading:t}=TE();return X.useEffect(()=>{const s=t6($h,a=>{e(a),t(!1)});return()=>s()},[e,t]),{user:n,loginAnonymous:async()=>{try{await hJ($h)}catch(s){console.error("Login failed:",s)}},logout:async()=>{try{await n6($h)}catch(s){console.error("Logout failed:",s)}},isAuthenticated:!!n}}function qSe(){const{isAuthenticated:n,loginAnonymous:e}=XSe(),t=Sn(c=>c.vondstenLocalOnly),r=Sn(c=>c.showVondstButton),i=wr(c=>c.vondstFormOpen),s=wr(c=>c.vondstFormLocation),a=wr(c=>c.openVondstForm),o=wr(c=>c.closeVondstForm);if(!r)return null;const l=()=>{if(t){a();return}if(!n){confirm("Je moet ingelogd zijn om vondsten in de cloud op te slaan. Anoniem inloggen?")&&e();return}a()};return g.jsxs(g.Fragment,{children:[g.jsx(Rt.button,{className:"fixed bottom-2 right-[60px] z-[1000] w-11 h-11 bg-orange-500 hover:bg-orange-600 text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},onClick:l,title:"Vondst toevoegen",children:g.jsx(ya,{size:22,strokeWidth:2})}),g.jsx($n,{children:i&&g.jsx(hz,{onClose:o,initialLocation:s||void 0})})]})}function YSe(){const n=Sn(pe=>pe.showRouteRecordButton),e=Sn(pe=>pe.showVondstButton),t=wr(pe=>pe.toggleRouteDashboard),{state:r,startRecording:i,pauseRecording:s,resumeRecording:a,stopRecording:o,cancelRecording:l,addPoint:c,getCurrentDistance:h,getCurrentDuration:f,getAverageSpeed:m,currentPoints:y,savedRoutes:x,autoPauseEnabled:_,autoPauseSeconds:w}=So(),[S,b]=X.useState(!1),[R,M]=X.useState(""),[O,G]=X.useState(!1),[A,I]=X.useState(!1),P=X.useRef(null),D=X.useRef(null),L=X.useRef(null),U=pe=>{const Fe=Math.floor(pe/1e3),wt=Math.floor(Fe/3600),jt=Math.floor(Fe%3600/60),Dt=Fe%60;return wt>0?`${wt}:${jt.toString().padStart(2,"0")}:${Dt.toString().padStart(2,"0")}`:`${jt}:${Dt.toString().padStart(2,"0")}`},j=pe=>pe<1e3?`${Math.round(pe)} m`:`${(pe/1e3).toFixed(2)} km`,Ee=pe=>`${pe.toFixed(1)} km/h`,ke=(pe,Fe,wt,jt)=>{const Kt=(jt-Fe)*Math.PI/180,Qt=(wt-pe)*Math.PI/180,ot=Math.sin(Kt/2)*Math.sin(Kt/2)+Math.cos(Fe*Math.PI/180)*Math.cos(jt*Math.PI/180)*Math.sin(Qt/2)*Math.sin(Qt/2);return 6371e3*(2*Math.atan2(Math.sqrt(ot),Math.sqrt(1-ot)))};if(X.useEffect(()=>(r==="recording"?(I(!1),"geolocation"in navigator&&P.current===null&&(P.current=navigator.geolocation.watchPosition(pe=>{const Fe=pe.coords.longitude,wt=pe.coords.latitude,jt=Date.now();c(Fe,wt,pe.coords.accuracy),_&&D.current?ke(D.current.lon,D.current.lat,Fe,wt)>3?(D.current={lon:Fe,lat:wt,time:jt},L.current&&(clearTimeout(L.current),L.current=null)):jt-D.current.time>=w*1e3&&(s(),I(!0),D.current=null):D.current={lon:Fe,lat:wt,time:jt}},pe=>{console.error("GPS error:",pe)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:1e3}))):(P.current!==null&&(navigator.geolocation.clearWatch(P.current),P.current=null),L.current&&(clearTimeout(L.current),L.current=null)),()=>{P.current!==null&&(navigator.geolocation.clearWatch(P.current),P.current=null),L.current&&(clearTimeout(L.current),L.current=null)}),[r,c,_,w,s]),!n)return null;const Be=e?"right-[114px]":"right-[60px]",Me=e?"right-[168px]":"right-[114px]",ce=()=>{i(),G(!0)},Pe=()=>{s()},be=()=>{a()},se=()=>{M(`Route ${new Date().toLocaleDateString("nl-NL")}`),b(!0)},V=()=>{const pe=o(R);b(!1),G(!1),M(""),pe&&confirm(`Route "${pe.name}" opgeslagen! (${j(pe.totalDistance)})

Direct exporteren als GPX?`)&&cz(pe)},Z=()=>{y.length>2&&!confirm("Weet je zeker dat je de opname wilt annuleren? De route wordt niet opgeslagen.")||(l(),b(!1),G(!1))},te=h(),ie=f(),ue=m(),Ve=pe=>{switch(pe){case"recording":return"bg-red-500 hover:bg-red-600";case"paused":return"bg-yellow-500 hover:bg-yellow-600";default:return"bg-purple-500 hover:bg-purple-600"}},Ge=pe=>{switch(pe){case"recording":return g.jsx(Wce,{size:22,strokeWidth:2});case"paused":return g.jsx(Jce,{size:22,strokeWidth:2});default:return g.jsx(Bv,{size:22,strokeWidth:2})}},ye=()=>{switch(r){case"idle":ce();break;case"recording":Pe();break;case"paused":be();break}};return g.jsxs(g.Fragment,{children:[g.jsxs(Rt.button,{className:`fixed bottom-2 ${Be} z-[1000] w-11 h-11 ${Ve(r)} text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none backdrop-blur-sm`,whileHover:{scale:1.05},whileTap:{scale:.95},onClick:ye,title:r==="idle"?"Route opnemen":r==="recording"?"Pauzeren":"Hervatten",children:[Ge(r),r==="recording"&&g.jsx(Rt.div,{className:"absolute inset-0 rounded-xl bg-red-400",animate:{opacity:[.5,0,.5]},transition:{duration:1.5,repeat:1/0}})]}),g.jsx($n,{children:r==="idle"&&x.length>0&&g.jsxs(Rt.button,{className:`fixed bottom-2 ${Me} z-[1000] w-11 h-11 bg-purple-400 hover:bg-purple-500 text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none`,initial:{opacity:0,scale:.8,x:20},animate:{opacity:1,scale:1,x:0},exit:{opacity:0,scale:.8,x:20},whileHover:{scale:1.05},whileTap:{scale:.95},onClick:t,title:`Mijn routes (${x.length})`,children:[g.jsx(xV,{size:18,strokeWidth:2}),g.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-white text-purple-600 text-xs font-bold rounded-full flex items-center justify-center shadow-sm",children:x.length})]})}),g.jsx($n,{children:(r==="recording"||r==="paused")&&g.jsx(Rt.button,{className:`fixed bottom-2 ${Me} z-[1000] w-11 h-11 bg-gray-700 hover:bg-gray-800 text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none`,initial:{opacity:0,scale:.8,x:20},animate:{opacity:1,scale:1,x:0},exit:{opacity:0,scale:.8,x:20},whileHover:{scale:1.05},whileTap:{scale:.95},onClick:se,title:"Stoppen en opslaan",children:g.jsx(Sue,{size:18,strokeWidth:2,fill:"currentColor"})})}),g.jsx($n,{children:O&&r!=="idle"&&g.jsxs(Rt.div,{className:"fixed bottom-16 right-2 z-[999] bg-white/95 backdrop-blur-sm rounded-xl shadow-lg p-3 min-w-[180px]",initial:{opacity:0,y:20,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.9},children:[g.jsxs("div",{className:"flex items-center justify-between mb-2",children:[g.jsx("span",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:r==="recording"?" Opname":A?" Auto-pauze":" Gepauzeerd"}),g.jsx("button",{onClick:()=>G(!1),className:"p-0.5 text-gray-400 hover:text-gray-600 border-0 outline-none bg-transparent",children:g.jsx(si,{size:14})})]}),g.jsxs("div",{className:"space-y-2",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(ny,{size:16,className:"text-purple-500"}),g.jsx("span",{className:"text-lg font-semibold text-gray-800",children:j(te)})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(Dv,{size:16,className:"text-blue-500"}),g.jsx(ZSe,{duration:ie,recordingState:r,formatTime:U})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(_ce,{size:16,className:"text-green-500"}),g.jsx("span",{className:"text-sm text-gray-600",children:Ee(ue)})]}),g.jsxs("div",{className:"text-xs text-gray-400 pt-1 border-t border-gray-100",children:[y.length," punten opgenomen"]})]})]})}),g.jsx($n,{children:S&&g.jsxs(g.Fragment,{children:[g.jsx(Rt.div,{className:"fixed inset-0 z-[1500] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>b(!1)}),g.jsxs(Rt.div,{className:"fixed left-4 right-4 top-1/2 z-[1501] bg-white rounded-xl shadow-2xl p-4 max-w-sm mx-auto",initial:{opacity:0,scale:.9,y:"-40%"},animate:{opacity:1,scale:1,y:"-50%"},exit:{opacity:0,scale:.9,y:"-40%"},children:[g.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Route opslaan"}),g.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 mb-4 space-y-1",children:[g.jsxs("div",{className:"flex justify-between text-sm",children:[g.jsx("span",{className:"text-gray-500",children:"Afstand:"}),g.jsx("span",{className:"font-medium",children:j(te)})]}),g.jsxs("div",{className:"flex justify-between text-sm",children:[g.jsx("span",{className:"text-gray-500",children:"Duur:"}),g.jsx("span",{className:"font-medium",children:U(ie)})]}),g.jsxs("div",{className:"flex justify-between text-sm",children:[g.jsx("span",{className:"text-gray-500",children:"Gem. snelheid:"}),g.jsx("span",{className:"font-medium",children:Ee(ue)})]}),g.jsxs("div",{className:"flex justify-between text-sm",children:[g.jsx("span",{className:"text-gray-500",children:"Punten:"}),g.jsx("span",{className:"font-medium",children:y.length})]})]}),g.jsxs("div",{className:"mb-4",children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Naam van de route"}),g.jsx("input",{type:"text",value:R,onChange:pe=>M(pe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Route naam...",autoFocus:!0})]}),g.jsxs("div",{className:"flex gap-2",children:[g.jsx("button",{onClick:Z,className:"flex-1 px-4 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none",children:"Annuleren"}),g.jsxs("button",{onClick:V,disabled:y.length<2,className:"flex-1 px-4 py-2 bg-purple-500 hover:bg-purple-600 disabled:bg-gray-300 text-white rounded-lg transition-colors border-0 outline-none flex items-center justify-center gap-2",children:[g.jsx(wV,{size:16}),"Opslaan"]})]}),y.length<2&&g.jsx("p",{className:"text-xs text-red-500 text-center mt-2",children:"Minimaal 2 punten nodig om op te slaan"})]})]})})]})}function ZSe({duration:n,recordingState:e,formatTime:t}){const[r,i]=X.useState(n);return X.useEffect(()=>{if(e!=="recording"){i(n);return}const s=setInterval(()=>{i(a=>a+1e3)},1e3);return()=>clearInterval(s)},[e,n]),X.useEffect(()=>{i(n)},[n]),g.jsx("span",{className:"text-lg font-semibold text-gray-800",children:t(r)})}function JSe(){const n=pi(s=>s.map),{currentPoints:e,state:t}=So(),r=X.useRef(null),i=X.useRef(null);return X.useEffect(()=>{if(!n)return;const s=new gc;i.current=s;const a=new Wu({source:s,zIndex:999,properties:{name:"route-recording-layer"}});return r.current=a,n.addLayer(a),()=>{r.current&&n&&n.removeLayer(r.current)}},[n]),X.useEffect(()=>{if(!i.current||(i.current.clear(),t==="idle"||e.length===0))return;const s=e.map(a=>Ir(a.coordinates));if(s.length>=2){const a=new _r({geometry:new bi(s)});a.setStyle(new mn({stroke:new Yn({color:t==="paused"?"rgba(234, 179, 8, 0.8)":"rgba(168, 85, 247, 0.8)",width:4,lineCap:"round",lineJoin:"round"})})),i.current.addFeature(a)}if(s.length>=1){const a=new _r({geometry:new gi(s[0])});a.setStyle(new mn({image:new $s({radius:8,fill:new rr({color:"rgba(34, 197, 94, 1)"}),stroke:new Yn({color:"white",width:2})})})),i.current.addFeature(a)}if(s.length>=1){const a=new _r({geometry:new gi(s[s.length-1])});a.setStyle(new mn({image:new $s({radius:6,fill:new rr({color:t==="paused"?"rgba(234, 179, 8, 1)":"rgba(168, 85, 247, 1)"}),stroke:new Yn({color:"white",width:2})})})),i.current.addFeature(a)}},[e,t]),null}const gD=["#a855f7","#3b82f6","#22c55e","#f97316","#ec4899","#14b8a6","#eab308","#8b5cf6"];function QSe(){const n=pi(s=>s.map),{savedRoutes:e,visibleRouteIds:t}=So(),r=X.useRef(null),i=X.useRef(null);return X.useEffect(()=>{if(!n)return;const s=new gc;i.current=s;const a=new Wu({source:s,zIndex:998,properties:{name:"saved-routes-layer"}});return r.current=a,n.addLayer(a),()=>{r.current&&n&&n.removeLayer(r.current)}},[n]),X.useEffect(()=>{if(!i.current)return;i.current.clear(),e.filter(a=>t.has(a.id)).forEach((a,o)=>{const l=gD[o%gD.length],c=a.points.map(_=>Ir(_.coordinates));if(c.length<2)return;const h=new _r({geometry:new bi(c),routeId:a.id,routeName:a.name});h.setStyle(new mn({stroke:new Yn({color:l,width:4,lineCap:"round",lineJoin:"round"})})),i.current.addFeature(h);const f=new _r({geometry:new gi(c[0]),routeId:a.id,type:"start"});f.setStyle(new mn({image:new $s({radius:8,fill:new rr({color:"#22c55e"}),stroke:new Yn({color:"white",width:2})}),text:new vo({text:"S",font:"bold 10px sans-serif",fill:new rr({color:"white"}),offsetY:1})})),i.current.addFeature(f);const m=new _r({geometry:new gi(c[c.length-1]),routeId:a.id,type:"end"});m.setStyle(new mn({image:new $s({radius:8,fill:new rr({color:"#ef4444"}),stroke:new Yn({color:"white",width:2})}),text:new vo({text:"E",font:"bold 10px sans-serif",fill:new rr({color:"white"}),offsetY:1})})),i.current.addFeature(m);const y=Math.floor(c.length/2),x=new _r({geometry:new gi(c[y]),routeId:a.id,type:"label"});x.setStyle(new mn({text:new vo({text:a.name,font:"12px sans-serif",fill:new rr({color:"#1f2937"}),stroke:new Yn({color:"white",width:3}),offsetY:-15})})),i.current.addFeature(x)})},[e,t]),null}function ebe(){const n=pi(a=>a.map),{savedRoutes:e,visibleRouteIds:t,heatmapEnabled:r}=So(),i=X.useRef(null),s=X.useRef(null);return X.useEffect(()=>{if(!n)return;const a=new gc;s.current=a;const o=new sX({source:a,blur:15,radius:10,weight:()=>1,gradient:["#00f","#0ff","#0f0","#ff0","#f00"],opacity:.6,zIndex:90});return i.current=o,n.addLayer(o),()=>{n&&i.current&&n.removeLayer(i.current)}},[n]),X.useEffect(()=>{if(!s.current||!i.current)return;if(s.current.clear(),!r){i.current.setVisible(!1);return}const a=e.filter(l=>t.has(l.id)),o=[];for(const l of a)for(const c of l.points){const h=new _r({geometry:new gi(Ir(c.coordinates))});o.push(h)}s.current.addFeatures(o),i.current.setVisible(o.length>0)},[e,t,r]),null}function tbe(n,e,t,r){const i=[],s=e/111e3,a=e/(111e3*Math.cos(n[1]*Math.PI/180)),o=Math.floor(t/2),l=n[0]-o*a,c=n[0]+o*a,h=n[1]-o*s,f=n[1]+o*s;for(let _=-o;_<=o;_++){const w=n[0]+_*a,S=[Ir([w,h]),Ir([w,f])],b=new _r({geometry:new bi(S),type:"grid-line"});b.setStyle(new mn({stroke:new Yn({color:r,width:_===0?2:1,lineDash:_===0?void 0:[5,5]})})),i.push(b)}for(let _=-o;_<=o;_++){const w=n[1]+_*s,S=[Ir([l,w]),Ir([c,w])],b=new _r({geometry:new bi(S),type:"grid-line"});b.setStyle(new mn({stroke:new Yn({color:r,width:_===0?2:1,lineDash:_===0?void 0:[5,5]})})),i.push(b)}const m="ABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let _=-o;_<o;_++)for(let w=-o;w<o;w++){const S=n[0]+(w+.5)*a,b=n[1]+(_+.5)*s,R=_+o,M=w+o;if(R>=0&&R<m.length){const O=`${m[R]}${M+1}`,G=new _r({geometry:new bi([Ir([S,b]),Ir([S,b])]),type:"grid-label"});G.setStyle(new mn({text:new vo({text:O,font:"12px sans-serif",fill:new rr({color:r}),stroke:new Yn({color:"rgba(255,255,255,0.8)",width:3})})})),i.push(G)}}const y=new _r({geometry:new bi([Ir([n[0]-a*.2,n[1]]),Ir([n[0]+a*.2,n[1]])]),type:"grid-center"});y.setStyle(new mn({stroke:new Yn({color:"#ef4444",width:3})})),i.push(y);const x=new _r({geometry:new bi([Ir([n[0],n[1]-s*.2]),Ir([n[0],n[1]+s*.2])]),type:"grid-center"});return x.setStyle(new mn({stroke:new Yn({color:"#ef4444",width:3})})),i.push(x),i}function nbe(){const n=pi(l=>l.map),{gridEnabled:e,gridCenter:t,gridSize:r,gridCount:i,gridColor:s}=So(),a=X.useRef(null),o=X.useRef(null);return X.useEffect(()=>{if(!n)return;const l=new gc;o.current=l;const c=new Wu({source:l,zIndex:85,properties:{name:"grid-overlay-layer"}});return a.current=c,n.addLayer(c),()=>{a.current&&n&&n.removeLayer(a.current)}},[n]),X.useEffect(()=>{if(!o.current||!a.current)return;if(o.current.clear(),!e||!t){a.current.setVisible(!1);return}const l=tbe(t,r,i,s);o.current.addFeatures(l),a.current.setVisible(!0)},[e,t,r,i,s]),null}function rbe(n){const e=[];let t=0;return n.points.forEach((r,i)=>{if(i>0){const o=n.points[i-1],l=6371e3,c=(r.coordinates[1]-o.coordinates[1])*Math.PI/180,h=(r.coordinates[0]-o.coordinates[0])*Math.PI/180,f=Math.sin(c/2)*Math.sin(c/2)+Math.cos(o.coordinates[1]*Math.PI/180)*Math.cos(r.coordinates[1]*Math.PI/180)*Math.sin(h/2)*Math.sin(h/2),m=2*Math.atan2(Math.sqrt(f),Math.sqrt(1-f));t+=l*m}const s=5,a=Math.sin(t/50)*2+Math.sin(t/120)*1.5+Math.sin(t/30+r.coordinates[0]*1e3)*.5;e.push({distance:t,elevation:Math.max(0,s+a)})}),e}function ibe({route:n,onClose:e}){const t=X.useRef(null),[r,i]=X.useState([]),[s,a]=X.useState({min:0,max:0,gain:0,loss:0});X.useEffect(()=>{const l=rbe(n);if(i(l),l.length>0){const c=l.map(x=>x.elevation),h=Math.min(...c),f=Math.max(...c);let m=0,y=0;for(let x=1;x<l.length;x++){const _=l[x].elevation-l[x-1].elevation;_>0?m+=_:y+=Math.abs(_)}a({min:h,max:f,gain:m,loss:y})}},[n]),X.useEffect(()=>{const l=t.current;if(!l||r.length<2)return;const c=l.getContext("2d");if(!c)return;const h=l.width,f=l.height,m={top:20,right:20,bottom:30,left:40};c.fillStyle="#f9fafb",c.fillRect(0,0,h,f);const y=Math.max(...r.map(O=>O.distance)),x=Math.min(...r.map(O=>O.elevation))-1,_=Math.max(...r.map(O=>O.elevation))+1,w=O=>m.left+O/y*(h-m.left-m.right),S=O=>f-m.bottom-(O-x)/(_-x)*(f-m.top-m.bottom);c.strokeStyle="#e5e7eb",c.lineWidth=1;const b=5;for(let O=0;O<=b;O++){const G=x+(_-x)*(O/b),A=S(G);c.beginPath(),c.moveTo(m.left,A),c.lineTo(h-m.right,A),c.stroke(),c.fillStyle="#9ca3af",c.font="10px sans-serif",c.textAlign="right",c.fillText(`${G.toFixed(1)}m`,m.left-5,A+3)}const R=5;for(let O=0;O<=R;O++){const G=y/R*O,A=w(G);c.fillStyle="#9ca3af",c.font="10px sans-serif",c.textAlign="center",c.fillText(G<1e3?`${Math.round(G)}m`:`${(G/1e3).toFixed(1)}km`,A,f-10)}c.beginPath(),c.moveTo(w(r[0].distance),f-m.bottom),r.forEach(O=>{c.lineTo(w(O.distance),S(O.elevation))}),c.lineTo(w(r[r.length-1].distance),f-m.bottom),c.closePath();const M=c.createLinearGradient(0,m.top,0,f-m.bottom);M.addColorStop(0,"rgba(139, 92, 246, 0.3)"),M.addColorStop(1,"rgba(139, 92, 246, 0.05)"),c.fillStyle=M,c.fill(),c.strokeStyle="#8b5cf6",c.lineWidth=2,c.lineJoin="round",c.lineCap="round",c.beginPath(),r.forEach((O,G)=>{const A=w(O.distance),I=S(O.elevation);G===0?c.moveTo(A,I):c.lineTo(A,I)}),c.stroke()},[r]);const o=l=>l<1e3?`${Math.round(l)} m`:`${(l/1e3).toFixed(2)} km`;return g.jsxs(Rt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},className:"fixed inset-4 z-[1700] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[70vh]",children:[g.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-purple-500 text-white",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(ng,{size:20}),g.jsx("span",{className:"font-medium",children:"Hoogteprofiel"})]}),g.jsx("button",{onClick:e,className:"p-1 rounded bg-purple-400/50 hover:bg-purple-400 transition-colors border-0 outline-none",children:g.jsx(si,{size:18})})]}),g.jsxs("div",{className:"px-4 py-2 bg-purple-50 border-b border-purple-100",children:[g.jsx("h3",{className:"font-medium text-gray-800 truncate",children:n.name}),g.jsx("p",{className:"text-xs text-gray-500",children:o(n.totalDistance)})]}),g.jsxs("div",{className:"grid grid-cols-4 gap-2 p-3 border-b border-gray-100",children:[g.jsxs("div",{className:"text-center",children:[g.jsx("div",{className:"flex items-center justify-center text-blue-500 mb-1",children:g.jsx(_V,{size:14})}),g.jsx("div",{className:"text-xs text-gray-500",children:"Min"}),g.jsxs("div",{className:"text-sm font-medium",children:[s.min.toFixed(1),"m"]})]}),g.jsxs("div",{className:"text-center",children:[g.jsx("div",{className:"flex items-center justify-center text-purple-500 mb-1",children:g.jsx(ng,{size:14})}),g.jsx("div",{className:"text-xs text-gray-500",children:"Max"}),g.jsxs("div",{className:"text-sm font-medium",children:[s.max.toFixed(1),"m"]})]}),g.jsxs("div",{className:"text-center",children:[g.jsx("div",{className:"flex items-center justify-center text-green-500 mb-1",children:g.jsx(Fue,{size:14})}),g.jsx("div",{className:"text-xs text-gray-500",children:"Stijging"}),g.jsxs("div",{className:"text-sm font-medium",children:[s.gain.toFixed(1),"m"]})]}),g.jsxs("div",{className:"text-center",children:[g.jsx("div",{className:"flex items-center justify-center text-red-500 mb-1",children:g.jsx(Oue,{size:14})}),g.jsx("div",{className:"text-xs text-gray-500",children:"Daling"}),g.jsxs("div",{className:"text-sm font-medium",children:[s.loss.toFixed(1),"m"]})]})]}),g.jsx("div",{className:"flex-1 p-3",children:g.jsx("canvas",{ref:t,width:350,height:200,className:"w-full h-full"})}),g.jsx("div",{className:"px-4 py-2 bg-yellow-50 border-t border-yellow-100",children:g.jsxs("p",{className:"text-xs text-yellow-700",children:[g.jsx("strong",{children:"Let op:"})," Dit zijn gesimuleerde hoogtewaarden. Koppeling met AHN-data komt binnenkort."]})})]})}const sbe=n=>n<1e3?`${Math.round(n)} m`:`${(n/1e3).toFixed(2)} km`,abe=n=>{const e=Math.floor(n/1e3),t=Math.floor(e/3600),r=Math.floor(e%3600/60);return t>0?`${t}u ${r}m`:`${r} min`},mD=n=>new Date(n).toLocaleDateString("nl-NL",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"});function obe({route:n,onClose:e}){const{updateRouteNotes:t,addPhotoToRoute:r,removePhotoFromRoute:i}=So(),[s,a]=X.useState(n.notes||""),[o,l]=X.useState("info"),c=X.useRef(null),h=()=>{t(n.id,s)},f=async x=>{const _=x.target.files?.[0];if(!_)return;const w=URL.createObjectURL(_);r(n.id,{url:w,caption:_.name}),c.current&&(c.current.value="")},m=x=>{confirm("Foto verwijderen?")&&i(n.id,x)},y=So(x=>x.savedRoutes.find(_=>_.id===n.id))||n;return g.jsxs(Rt.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[1700] flex items-center justify-center p-4",children:[g.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:e}),g.jsxs(Rt.div,{initial:{scale:.95,y:20},animate:{scale:1,y:0},exit:{scale:.95,y:20},className:"relative bg-white rounded-xl shadow-2xl overflow-hidden w-full max-w-md max-h-[85vh] flex flex-col",children:[g.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-purple-500 text-white",children:[g.jsxs("div",{className:"flex-1 min-w-0",children:[g.jsx("h3",{className:"font-medium truncate",children:y.name}),g.jsx("p",{className:"text-xs text-purple-200",children:mD(y.createdAt)})]}),g.jsx("button",{onClick:e,className:"p-1 rounded bg-purple-400/50 hover:bg-purple-400 transition-colors border-0 outline-none ml-2",children:g.jsx(si,{size:18})})]}),g.jsxs("div",{className:"flex border-b border-gray-200",children:[g.jsxs("button",{onClick:()=>l("info"),className:`flex-1 py-2 text-sm font-medium border-0 outline-none transition-colors ${o==="info"?"text-purple-600 border-b-2 border-purple-500":"text-gray-500 hover:text-gray-700"}`,children:[g.jsx(ya,{size:16,className:"inline mr-1"}),"Info"]}),g.jsxs("button",{onClick:()=>l("photos"),className:`flex-1 py-2 text-sm font-medium border-0 outline-none transition-colors ${o==="photos"?"text-purple-600 border-b-2 border-purple-500":"text-gray-500 hover:text-gray-700"}`,children:[g.jsx(kE,{size:16,className:"inline mr-1"}),"Foto's (",y.photos?.length||0,")"]}),g.jsxs("button",{onClick:()=>l("notes"),className:`flex-1 py-2 text-sm font-medium border-0 outline-none transition-colors ${o==="notes"?"text-purple-600 border-b-2 border-purple-500":"text-gray-500 hover:text-gray-700"}`,children:[g.jsx(GC,{size:16,className:"inline mr-1"}),"Notities"]})]}),g.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[o==="info"&&g.jsxs("div",{className:"space-y-4",children:[g.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[g.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[g.jsxs("div",{className:"flex items-center gap-2 text-purple-600 mb-1",children:[g.jsx(ny,{size:16}),g.jsx("span",{className:"text-xs text-gray-500",children:"Afstand"})]}),g.jsx("p",{className:"text-lg font-semibold",children:sbe(y.totalDistance)})]}),g.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[g.jsxs("div",{className:"flex items-center gap-2 text-blue-600 mb-1",children:[g.jsx(Dv,{size:16}),g.jsx("span",{className:"text-xs text-gray-500",children:"Duur"})]}),g.jsx("p",{className:"text-lg font-semibold",children:abe(y.totalDuration)})]})]}),g.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[g.jsxs("div",{className:"flex items-center gap-2 text-green-600 mb-1",children:[g.jsx(ya,{size:16}),g.jsx("span",{className:"text-xs text-gray-500",children:"Punten"})]}),g.jsxs("p",{className:"text-lg font-semibold",children:[y.points.length," GPS punten"]})]}),g.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[g.jsxs("div",{className:"flex items-center gap-2 text-orange-600 mb-1",children:[g.jsx(VC,{size:16}),g.jsx("span",{className:"text-xs text-gray-500",children:"Aangemaakt"})]}),g.jsx("p",{className:"text-sm",children:mD(y.createdAt)})]})]}),o==="photos"&&g.jsxs("div",{className:"space-y-4",children:[g.jsx("input",{ref:c,type:"file",accept:"image/*",onChange:f,className:"hidden"}),g.jsxs("button",{onClick:()=>c.current?.click(),className:"w-full py-8 border-2 border-dashed border-purple-300 rounded-lg text-purple-500 hover:bg-purple-50 transition-colors flex flex-col items-center gap-2",children:[g.jsx(Xa,{size:24}),g.jsx("span",{className:"text-sm",children:"Foto toevoegen"})]}),y.photos&&y.photos.length>0?g.jsx("div",{className:"grid grid-cols-2 gap-2",children:y.photos.map(x=>g.jsxs("div",{className:"relative aspect-square rounded-lg overflow-hidden bg-gray-100",children:[g.jsx("img",{src:x.url,alt:x.caption||"Route foto",className:"w-full h-full object-cover"}),g.jsx("button",{onClick:()=>m(x.id),className:"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full hover:bg-red-600 transition-colors border-0 outline-none",children:g.jsx(xc,{size:12})}),x.caption&&g.jsx("div",{className:"absolute bottom-0 left-0 right-0 px-2 py-1 bg-black/50 text-white text-xs truncate",children:x.caption})]},x.id))}):g.jsx("p",{className:"text-center text-gray-400 text-sm py-4",children:"Nog geen foto's toegevoegd"})]}),o==="notes"&&g.jsxs("div",{className:"space-y-4",children:[g.jsx("textarea",{value:s,onChange:x=>a(x.target.value),placeholder:"Voeg notities toe over deze route...",className:"w-full h-48 p-3 border border-gray-300 rounded-lg outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none"}),g.jsx("button",{onClick:h,className:"w-full px-4 py-2 bg-purple-500 hover:bg-purple-600 text-white rounded-lg transition-colors border-0 outline-none",children:"Notities opslaan"})]})]})]})]})}function lbe({route:n,size:e=80}){const t=X.useRef(null);return X.useEffect(()=>{const r=t.current;if(!r||n.points.length<2)return;const i=r.getContext("2d");if(!i)return;i.fillStyle="#f3f4f6",i.fillRect(0,0,e,e);const s=n.points.map(M=>M.coordinates[0]),a=n.points.map(M=>M.coordinates[1]),o=Math.min(...s),l=Math.max(...s),c=Math.min(...a),h=Math.max(...a),f=8,m=e-f*2,y=e-f*2,x=M=>l===o?e/2:f+(M-o)/(l-o)*m,_=M=>h===c?e/2:f+y-(M-c)/(h-c)*y;i.strokeStyle="#a855f7",i.lineWidth=2,i.lineCap="round",i.lineJoin="round",i.beginPath(),n.points.forEach((M,O)=>{const G=x(M.coordinates[0]),A=_(M.coordinates[1]);O===0?i.moveTo(G,A):i.lineTo(G,A)}),i.stroke();const w=x(n.points[0].coordinates[0]),S=_(n.points[0].coordinates[1]);i.fillStyle="#22c55e",i.beginPath(),i.arc(w,S,4,0,Math.PI*2),i.fill();const b=x(n.points[n.points.length-1].coordinates[0]),R=_(n.points[n.points.length-1].coordinates[1]);i.fillStyle="#ef4444",i.beginPath(),i.arc(b,R,4,0,Math.PI*2),i.fill()},[n,e]),n.points.length<2?g.jsx("div",{className:"bg-gray-100 rounded flex items-center justify-center text-gray-400",style:{width:e,height:e},children:g.jsx(ya,{size:20})}):g.jsx("canvas",{ref:t,width:e,height:e,className:"rounded"})}const JS=n=>n<1e3?`${Math.round(n)} m`:`${(n/1e3).toFixed(2)} km`,QS=n=>{const e=Math.floor(n/1e3),t=Math.floor(e/3600),r=Math.floor(e%3600/60);return t>0?`${t}u ${r}m`:`${r} min`},pD=n=>new Date(n).toLocaleDateString("nl-NL",{day:"numeric",month:"short",year:"numeric"});function cbe({isOpen:n,onClose:e,onViewRoute:t}){const{savedRoutes:r,deleteRoute:i,renameRoute:s,clearAllRoutes:a,visibleRouteIds:o,toggleRouteVisibility:l,showAllRoutes:c,hideAllRoutes:h,heatmapEnabled:f,toggleHeatmap:m,gridEnabled:y,toggleGrid:x,centerGridOnCurrentLocation:_,gridSize:w,setGridSize:S,autoPauseEnabled:b,setAutoPauseEnabled:R,autoPauseSeconds:M,setAutoPauseSeconds:O,importRouteFromGPX:G}=So(),[A,I]=X.useState(null),[P,D]=X.useState(""),[L,U]=X.useState(!1),[j,Ee]=X.useState(!1),[ke,Be]=X.useState(null),[Me,ce]=X.useState(null),Pe=X.useRef(null),be=async ye=>{const pe=` ${ye.name}

 Afstand: ${JS(ye.totalDistance)}
 Duur: ${QS(ye.totalDuration)}
 ${ye.points.length} GPS punten
 ${pD(ye.createdAt)}

Opgenomen met DetectorApp NL`;if(navigator.share)try{await navigator.share({title:ye.name,text:pe});return}catch(Fe){Fe.name!=="AbortError"&&console.error("Share failed:",Fe)}try{await navigator.clipboard.writeText(pe),alert("Route info gekopieerd naar klembord!")}catch{prompt("Kopieer de route info:",pe)}},se=async ye=>{const pe=ye.target.files?.[0];if(pe){try{const Fe=await pe.text(),wt=G(Fe,pe.name.replace(".gpx",""));wt.success?alert(`Route gemporteerd: ${pe.name}`):alert(`Import mislukt: ${wt.error}`)}catch{alert("Fout bij lezen van bestand")}Pe.current&&(Pe.current.value="")}},V=ye=>{I(ye.id),D(ye.name)},Z=ye=>{P.trim()&&s(ye,P.trim()),I(null),D("")},te=ye=>{confirm(`Weet je zeker dat je "${ye.name}" wilt verwijderen?`)&&i(ye.id)},ie=()=>{r.length!==0&&confirm(`Weet je zeker dat je alle ${r.length} routes wilt verwijderen? Dit kan niet ongedaan worden gemaakt.`)&&a()},ue=ye=>{l(ye);const pe=r.find(Fe=>Fe.id===ye);pe&&t&&t(pe)},Ve=r.reduce((ye,pe)=>ye+pe.totalDistance,0),Ge=r.reduce((ye,pe)=>ye+pe.totalDuration,0);return g.jsxs(g.Fragment,{children:[g.jsx($n,{children:n&&g.jsxs(g.Fragment,{children:[g.jsx(Rt.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),g.jsxs(Rt.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-md mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[g.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-purple-500 text-white",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(Bv,{size:20}),g.jsx("span",{className:"font-medium",children:"Mijn Routes"}),g.jsxs("span",{className:"text-purple-200 text-sm",children:["(",r.length,")"]})]}),g.jsx("button",{onClick:e,className:"p-1 rounded bg-purple-400/50 hover:bg-purple-400 transition-colors border-0 outline-none",children:g.jsx(si,{size:18})})]}),r.length>0&&g.jsxs("div",{className:"px-4 py-2 bg-purple-50 border-b border-purple-100 flex items-center justify-between text-sm",children:[g.jsxs("div",{className:"flex gap-4",children:[g.jsxs("div",{className:"flex items-center gap-1.5 text-purple-700",children:[g.jsx(ny,{size:14}),g.jsxs("span",{children:["Totaal: ",JS(Ve)]})]}),g.jsxs("div",{className:"flex items-center gap-1.5 text-purple-700",children:[g.jsx(Dv,{size:14}),g.jsx("span",{children:QS(Ge)})]})]}),g.jsxs("div",{className:"flex gap-1",children:[g.jsx("button",{onClick:()=>Ee(!j),className:`px-2 py-1 text-xs rounded transition-colors border-0 outline-none ${b?"bg-green-100 text-green-600":"text-purple-600 hover:bg-purple-100"}`,title:b?"Auto-pauze uit":"Auto-pauze aan",children:g.jsx(kue,{size:14})}),g.jsx("button",{onClick:()=>U(!L),className:`px-2 py-1 text-xs rounded transition-colors border-0 outline-none ${y?"bg-blue-100 text-blue-600":"text-purple-600 hover:bg-purple-100"}`,title:y?"Grid verbergen":"Grid tonen",children:g.jsx(yV,{size:14})}),g.jsx("button",{onClick:m,className:`px-2 py-1 text-xs rounded transition-colors border-0 outline-none ${f?"bg-orange-100 text-orange-600":"text-purple-600 hover:bg-purple-100"}`,title:f?"Heatmap verbergen":"Heatmap tonen",children:g.jsx(hce,{size:14})}),g.jsx("button",{onClick:c,className:"px-2 py-1 text-xs text-purple-600 hover:bg-purple-100 rounded transition-colors border-0 outline-none",title:"Alle tonen",children:g.jsx(Gv,{size:14})}),g.jsx("button",{onClick:h,className:"px-2 py-1 text-xs text-purple-600 hover:bg-purple-100 rounded transition-colors border-0 outline-none",title:"Alle verbergen",children:g.jsx(Vv,{size:14})})]})]}),g.jsx($n,{children:L&&g.jsx(Rt.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden border-b border-purple-100",children:g.jsxs("div",{className:"px-4 py-3 bg-blue-50 space-y-3",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsx("span",{className:"text-sm font-medium text-blue-800",children:"Grid Assistent"}),g.jsx("button",{onClick:x,className:`px-3 py-1 text-xs rounded-full transition-colors border-0 outline-none ${y?"bg-blue-500 text-white":"bg-blue-200 text-blue-700"}`,children:y?"Aan":"Uit"})]}),g.jsx("div",{className:"flex items-center gap-2",children:g.jsxs("button",{onClick:_,className:"flex-1 px-3 py-2 bg-blue-500 hover:bg-blue-600 text-white text-sm rounded-lg transition-colors border-0 outline-none flex items-center justify-center gap-2",children:[g.jsx(Fv,{size:14}),"Centreer op mijn locatie"]})}),g.jsxs("div",{className:"space-y-1",children:[g.jsxs("label",{className:"text-xs text-blue-700",children:["Celgrootte: ",w,"m"]}),g.jsx("input",{type:"range",min:"5",max:"50",step:"5",value:w,onChange:ye=>S(Number(ye.target.value)),className:"w-full h-2 bg-blue-200 rounded-lg appearance-none cursor-pointer"}),g.jsxs("div",{className:"flex justify-between text-xs text-blue-600",children:[g.jsx("span",{children:"5m"}),g.jsx("span",{children:"50m"})]})]}),g.jsx("p",{className:"text-xs text-blue-600",children:"Gebruik het grid om systematisch een veld af te zoeken. Elk vak heeft een label (A1, B2, etc.) voor referentie."})]})})}),g.jsx($n,{children:j&&g.jsx(Rt.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden border-b border-purple-100",children:g.jsxs("div",{className:"px-4 py-3 bg-green-50 space-y-3",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsx("span",{className:"text-sm font-medium text-green-800",children:"Auto-pauze"}),g.jsx("button",{onClick:()=>R(!b),className:`px-3 py-1 text-xs rounded-full transition-colors border-0 outline-none ${b?"bg-green-500 text-white":"bg-green-200 text-green-700"}`,children:b?"Aan":"Uit"})]}),g.jsxs("div",{className:"space-y-1",children:[g.jsxs("label",{className:"text-xs text-green-700",children:["Pauze na: ",M<60?`${M}s`:`${Math.floor(M/60)}m ${M%60}s`]}),g.jsx("input",{type:"range",min:"30",max:"300",step:"30",value:M,onChange:ye=>O(Number(ye.target.value)),className:"w-full h-2 bg-green-200 rounded-lg appearance-none cursor-pointer"}),g.jsxs("div",{className:"flex justify-between text-xs text-green-600",children:[g.jsx("span",{children:"30s"}),g.jsx("span",{children:"5min"})]})]}),g.jsxs("p",{className:"text-xs text-green-600",children:["De opname pauzeert automatisch als je langer dan ",M<60?`${M} seconden`:`${Math.floor(M/60)} minuten`," stilstaat. Ideaal voor pauzes tijdens het detecteren."]})]})})}),g.jsx("div",{className:"flex-1 overflow-y-auto p-3 space-y-2",children:r.length===0?g.jsxs("div",{className:"text-center py-12 text-gray-500",children:[g.jsx(Bv,{size:48,className:"mx-auto mb-3 text-gray-300"}),g.jsx("p",{className:"font-medium",children:"Nog geen routes"}),g.jsx("p",{className:"text-sm mt-1",children:"Start een opname om je eerste route vast te leggen"})]}):r.map(ye=>g.jsxs(Rt.div,{layout:!0,className:"bg-gray-50 rounded-lg p-3 flex gap-3",children:[g.jsx(lbe,{route:ye,size:70}),g.jsxs("div",{className:"flex-1 min-w-0",children:[A===ye.id?g.jsx("input",{type:"text",value:P,onChange:pe=>D(pe.target.value),onKeyDown:pe=>{pe.key==="Enter"&&Z(ye.id),pe.key==="Escape"&&I(null)},onBlur:()=>Z(ye.id),className:"w-full px-2 py-1 text-sm bg-white border border-purple-300 rounded outline-none focus:ring-2 focus:ring-purple-400",autoFocus:!0}):g.jsx("h3",{className:"font-medium text-gray-800 truncate",children:ye.name}),g.jsx("div",{className:"flex items-center gap-3 mt-1 text-xs text-gray-500",children:g.jsxs("span",{className:"flex items-center gap-1",children:[g.jsx(VC,{size:12}),pD(ye.createdAt)]})}),g.jsxs("div",{className:"flex items-center gap-3 mt-1 text-xs text-gray-600",children:[g.jsxs("span",{className:"flex items-center gap-1",children:[g.jsx(ny,{size:12}),JS(ye.totalDistance)]}),g.jsxs("span",{className:"flex items-center gap-1",children:[g.jsx(Dv,{size:12}),QS(ye.totalDuration)]}),g.jsxs("span",{children:[ye.points.length," punten"]})]})]}),g.jsxs("div",{className:"flex flex-col gap-1",children:[g.jsx("button",{onClick:()=>ue(ye.id),className:`p-1.5 rounded transition-colors border-0 outline-none ${o.has(ye.id)?"bg-purple-100 text-purple-600":"text-gray-400 hover:text-purple-600 hover:bg-purple-50"}`,title:o.has(ye.id)?"Verbergen op kaart":"Tonen op kaart",children:o.has(ye.id)?g.jsx(Gv,{size:16}):g.jsx(Vv,{size:16})}),g.jsx("button",{onClick:()=>V(ye),className:"p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",title:"Naam wijzigen",children:g.jsx(rg,{size:16})}),g.jsx("button",{onClick:()=>ce(ye),className:"p-1.5 text-gray-400 hover:text-cyan-600 hover:bg-cyan-50 rounded transition-colors border-0 outline-none",title:"Details & foto's",children:g.jsx(BC,{size:16})}),g.jsx("button",{onClick:()=>Be(ye),className:"p-1.5 text-gray-400 hover:text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none",title:"Hoogteprofiel",children:g.jsx(ng,{size:16})}),g.jsx("button",{onClick:()=>be(ye),className:"p-1.5 text-gray-400 hover:text-pink-600 hover:bg-pink-50 rounded transition-colors border-0 outline-none",title:"Delen",children:g.jsx(gue,{size:16})}),g.jsx("button",{onClick:()=>cz(ye),className:"p-1.5 text-gray-400 hover:text-green-600 hover:bg-green-50 rounded transition-colors border-0 outline-none",title:"Exporteer als GPX",children:g.jsx(jv,{size:16})}),g.jsx("button",{onClick:()=>te(ye),className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors border-0 outline-none",title:"Verwijderen",children:g.jsx(xc,{size:16})})]})]},ye.id))}),g.jsxs("div",{className:"px-4 py-3 border-t border-gray-100 space-y-2",children:[g.jsx("input",{ref:Pe,type:"file",accept:".gpx",onChange:se,className:"hidden"}),g.jsxs("button",{onClick:()=>Pe.current?.click(),className:"w-full px-3 py-2 text-purple-600 hover:bg-purple-50 rounded-lg transition-colors border-0 outline-none text-sm flex items-center justify-center gap-2",children:[g.jsx(Qy,{size:16}),"GPX bestand importeren"]}),r.length>0&&g.jsx("button",{onClick:ie,className:"w-full px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none text-sm",children:"Alle routes verwijderen"})]})]})]})}),g.jsx($n,{children:ke&&g.jsx(ibe,{route:ke,onClose:()=>Be(null)})}),g.jsx($n,{children:Me&&g.jsx(obe,{route:Me,onClose:()=>ce(null)})})]})}const yD={Munt:"#f59e0b",Aardewerk:"#a16207",Gesp:"#6b7280",Fibula:"#8b5cf6",Ring:"#ec4899",Speld:"#6366f1",Sieraad:"#f43f5e",Gereedschap:"#64748b",Wapen:"#ef4444",Anders:"#3b82f6"},ube={Munt:"M",Aardewerk:"A",Gesp:"G",Fibula:"F",Ring:"R",Speld:"S",Sieraad:"Si",Gereedschap:"Gr",Wapen:"W",Anders:"?"};function hbe(){const n=pi(i=>i.map),e=cl(i=>i.vondsten),t=Sn(i=>i.showLocalVondsten),r=X.useRef(null);return X.useEffect(()=>{if(!n)return;const i=new gc;return e.forEach(s=>{const a=new _r({geometry:new gi(Ir([s.location.lng,s.location.lat])),vondst:s}),o=yD[s.objectType]||yD.Anders,l=ube[s.objectType]||"?";a.setStyle((c,h)=>{let x=12;h>50?x=6:h>10?x=Math.max(6,12-(h-10)/10):h<2&&(x=14);const _=Math.max(8,Math.min(12,x-2));return new mn({image:new $s({radius:x,fill:new rr({color:o}),stroke:new Yn({color:"#ffffff",width:x>8?2:1})}),text:x>=8?new vo({text:l,font:`bold ${_}px sans-serif`,fill:new rr({color:"#ffffff"}),offsetY:1}):void 0})}),i.addFeature(a)}),r.current?r.current.setSource(i):(r.current=new Wu({source:i,zIndex:1e3,properties:{title:"Mijn Vondsten"}}),r.current.setVisible(t),n.addLayer(r.current)),()=>{r.current&&n&&(n.removeLayer(r.current),r.current=null)}},[n,e]),X.useEffect(()=>{r.current&&r.current.setVisible(t)},[t]),null}const dbe={Mineraal:"M",Fossiel:"F",Erfgoed:"E",Monument:"Mo",Overig:""};function fbe(n){const{type:e,coordinates:t}=n,r=s=>typeof s[0]=="number"?Ir(s):s.map(r),i=r(t);switch(e){case"Point":return new gi(i);case"LineString":return new bi(i);case"Polygon":return new Ha(i);case"MultiPoint":return new kd(i);case"MultiLineString":return new ic(i);case"MultiPolygon":return new ad(i);default:return new gi(Ir(t))}}function gbe(){const n=pi(i=>i.map),e=hs(i=>i.layers),t=Sn(i=>i.showCustomPointLayers),r=X.useRef(new Map);return X.useEffect(()=>{if(!n)return;const i=new Set(e.map(s=>s.id));return r.current.forEach((s,a)=>{i.has(a)||(n.removeLayer(s),r.current.delete(a))}),e.forEach(s=>{const a=new gc;s.points.forEach(l=>{let c;const h=l.geometry&&l.geometry.type!=="Point";l.geometry?c=fbe(l.geometry):c=new gi(Ir(l.coordinates));const f=new _r({geometry:c,layerType:"customPoint",customPoint:l,customLayerId:s.id,customLayerName:s.name,customLayerColor:s.color}),m=dbe[l.category]||l.category.charAt(0).toUpperCase();if(h){const y=l.geometry.type;f.setStyle(()=>y==="Polygon"||y==="MultiPolygon"?new mn({fill:new rr({color:s.color+"40"}),stroke:new Yn({color:s.color,width:2})}):y==="LineString"||y==="MultiLineString"?new mn({stroke:new Yn({color:s.color,width:3})}):new mn({image:new $s({radius:8,fill:new rr({color:s.color}),stroke:new Yn({color:"#ffffff",width:2})})}))}else f.setStyle((y,x)=>{let b=12;x>50?b=6:x>10?b=Math.max(6,12-(x-10)/10):x<2&&(b=14);const R=Math.max(8,Math.min(12,b-2));return new mn({image:new $s({radius:b,fill:new rr({color:s.color}),stroke:new Yn({color:"#ffffff",width:b>8?2:1})}),text:b>=8?new vo({text:m,font:`bold ${R}px sans-serif`,fill:new rr({color:"#ffffff"}),offsetY:1}):void 0})});a.addFeature(f)});const o=r.current.get(s.id);if(o)o.setSource(a),o.setVisible(t&&s.visible);else{const l=new Wu({source:a,zIndex:950,properties:{title:s.name,customPointLayerId:s.id},visible:t&&s.visible});n.addLayer(l),r.current.set(s.id,l)}}),()=>{r.current.forEach(s=>{n&&n.removeLayer(s)}),r.current.clear()}},[n,e,t]),null}function mbe(){const{createLayerModalOpen:n,closeCreateLayerModal:e}=wr(),{addLayer:t}=hs(),r=Sn(),[i,s]=X.useState(""),[a,o]=X.useState([...ru]),[l,c]=X.useState(""),h=14*r.fontScale/100,f=()=>{const w=l.trim();w&&!a.includes(w)&&(o([...a,w]),c(""))},m=w=>{o(a.filter(S=>S!==w))},y=w=>{a.includes(w)?o(a.filter(S=>S!==w)):o([...a,w])},x=()=>{i.trim()&&(t(i.trim(),a),s(""),o([...ru]),c(""),e())},_=()=>{s(""),o([...ru]),c(""),e()};return g.jsx($n,{children:n&&g.jsxs(g.Fragment,{children:[g.jsx(Rt.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:_}),g.jsxs(Rt.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-sm mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[g.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(za,{size:18}),g.jsx("span",{className:"font-medium",children:"Nieuwe laag"})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),g.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:r.fontScale,onChange:w=>r.setFontScale(parseInt(w.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${r.fontScale}%`}),g.jsx("span",{className:"text-xs opacity-70",children:"T"}),g.jsx("button",{onClick:_,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:g.jsx(si,{size:18})})]})]}),g.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",style:{fontSize:`${h}px`},children:[g.jsxs("div",{children:[g.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Naam van de laag"}),g.jsx("input",{type:"text",value:i,onChange:w=>s(w.target.value),placeholder:"bijv. Vakantie Frankrijk 2026",className:"w-full px-3 py-2 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"},autoFocus:!0})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block font-medium text-gray-700 mb-2",style:{fontSize:"0.9em"},children:"Categorien"}),g.jsx("div",{className:"flex flex-wrap gap-2",children:ru.map(w=>g.jsx("button",{onClick:()=>y(w),className:`px-3 py-1 rounded-full transition-colors border-0 outline-none ${a.includes(w)?"bg-orange-500 text-white":"bg-white text-gray-600 hover:bg-blue-50"}`,style:{fontSize:"0.9em"},children:w},w))})]}),a.filter(w=>!ru.includes(w)).length>0&&g.jsxs("div",{children:[g.jsx("label",{className:"block font-medium text-gray-700 mb-2",style:{fontSize:"0.9em"},children:"Eigen categorien"}),g.jsx("div",{className:"flex flex-wrap gap-2",children:a.filter(w=>!ru.includes(w)).map(w=>g.jsxs("div",{className:"flex items-center",children:[g.jsx("button",{onClick:()=>y(w),className:"px-3 py-1 rounded-l-full bg-orange-500 text-white hover:bg-orange-600 transition-colors border-0 outline-none",style:{fontSize:"0.9em"},children:w}),g.jsx("button",{onClick:()=>m(w),className:"px-2 py-1 rounded-r-full bg-orange-600 text-white hover:bg-orange-700 transition-colors border-0 outline-none",title:"Verwijder categorie",children:g.jsx(xc,{size:12})})]},w))})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Eigen categorie toevoegen"}),g.jsxs("div",{className:"flex gap-2",children:[g.jsx("input",{type:"text",value:l,onChange:w=>c(w.target.value),placeholder:"bijv. Grot, Bron, ...",className:"flex-1 px-3 py-2 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"},onKeyDown:w=>w.key==="Enter"&&f()}),g.jsx("button",{onClick:f,disabled:!l.trim(),className:"px-3 py-2 bg-white hover:bg-blue-50 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg transition-colors border-0 outline-none text-gray-600",children:g.jsx(Xa,{size:20})})]})]})]}),g.jsxs("div",{className:"p-4 flex gap-3",style:{fontSize:`${h}px`},children:[g.jsx("button",{onClick:_,className:"flex-1 px-4 py-2 bg-white hover:bg-blue-50 rounded-lg transition-colors border-0 outline-none text-gray-600",style:{fontSize:"1em"},children:"Annuleren"}),g.jsx("button",{onClick:x,disabled:!i.trim(),className:"flex-1 px-4 py-2 bg-orange-500 hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg transition-colors border-0 outline-none",style:{fontSize:"1em"},children:"Aanmaken"})]})]})]})})}const dz=200,pbe=.7;async function ybe(n,e=dz){return new Promise((t,r)=>{const i=new Image,s=document.createElement("canvas"),a=s.getContext("2d");i.onload=()=>{let o=i.width,l=i.height;o>l?o>e&&(l=Math.round(l*e/o),o=e):l>e&&(o=Math.round(o*e/l),l=e),s.width=o,s.height=l,a?.drawImage(i,0,0,o,l),s.toBlob(c=>{c?t(c):r(new Error("Failed to create blob from canvas"))},"image/jpeg",pbe)},i.onerror=()=>r(new Error("Failed to load image")),i.src=URL.createObjectURL(n)})}function xbe(n){return new Promise((e,t)=>{const r=new FileReader;r.onloadend=()=>{typeof r.result=="string"?e(r.result):t(new Error("Failed to convert blob to base64"))},r.onerror=()=>t(new Error("Failed to read blob")),r.readAsDataURL(n)})}async function _be(n){const e=await ybe(n,dz),t=await xbe(e);return{thumbnailBlob:e,thumbnailBase64:t}}function vbe(){return`photo_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}const eb=5;function wbe({photos:n,onAddPhoto:e,onRemovePhoto:t,disabled:r}){const i=X.useRef(null),s=X.useRef(null),a=async l=>{const c=l.target.files;if(!c||c.length===0)return;const h=eb-n.length,f=Array.from(c).slice(0,h);for(const m of f)try{const{thumbnailBase64:y}=await _be(m),x={id:vbe(),thumbnailBase64:y,createdAt:new Date().toISOString(),pendingUpload:!0};e(x)}catch(y){console.error("Failed to process image:",y)}l.target.value=""},o=n.length<eb;return g.jsxs("div",{className:"space-y-2",children:[g.jsxs("label",{className:"block font-medium text-gray-700",style:{fontSize:"0.9em"},children:["Foto's (",n.length,"/",eb,")"]}),g.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.map(l=>g.jsxs("div",{className:"relative w-16 h-16 rounded-lg overflow-hidden bg-gray-100 border border-gray-200",children:[g.jsx("img",{src:l.thumbnailUrl||l.thumbnailBase64,alt:"Foto",className:"w-full h-full object-cover"}),!r&&g.jsx("button",{type:"button",onClick:()=>t(l.id),className:"absolute top-0.5 right-0.5 w-5 h-5 bg-red-500 rounded-full flex items-center justify-center border-0 outline-none",children:g.jsx(si,{size:12,className:"text-white"})}),l.pendingUpload&&g.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-orange-500/80 text-white text-center py-0.5",style:{fontSize:"0.6em"},children:"Wacht..."})]},l.id)),o&&!r&&g.jsxs(g.Fragment,{children:[g.jsxs("button",{type:"button",onClick:()=>s.current?.click(),className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 hover:border-orange-400 hover:bg-orange-50 flex flex-col items-center justify-center gap-1 transition-colors bg-transparent outline-none",title:"Maak foto",children:[g.jsx(kE,{size:20,className:"text-gray-400"}),g.jsx("span",{className:"text-gray-400",style:{fontSize:"0.6em"},children:"Camera"})]}),g.jsxs("button",{type:"button",onClick:()=>i.current?.click(),className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 hover:border-orange-400 hover:bg-orange-50 flex flex-col items-center justify-center gap-1 transition-colors bg-transparent outline-none",title:"Kies foto",children:[g.jsx(Rce,{size:20,className:"text-gray-400"}),g.jsx("span",{className:"text-gray-400",style:{fontSize:"0.6em"},children:"Gallerij"})]})]})]}),g.jsx("input",{ref:s,type:"file",accept:"image/*",capture:"environment",onChange:a,className:"hidden"}),g.jsx("input",{ref:i,type:"file",accept:"image/*",multiple:!0,onChange:a,className:"hidden"})]})}function Ebe(){const{addPointModalOpen:n,addPointModalLayerId:e,addPointModalLocation:t,closeAddPointModal:r}=wr(),{addPoint:i,getLayer:s}=hs(),a=Sn(),[o,l]=X.useState(""),[c,h]=X.useState(""),[f,m]=X.useState(""),[y,x]=X.useState([]),_=e?s(e):null,w=14*a.fontScale/100,S=()=>{!o.trim()||!e||!t||(i(e,{name:o.trim(),category:"Overig",notes:c.trim(),url:f.trim()||void 0,coordinates:[t.lng,t.lat],photos:y.length>0?y:void 0}),l(""),h(""),m(""),x([]),r())},b=()=>{l(""),h(""),m(""),x([]),r()};return _?g.jsx($n,{children:n&&g.jsxs(g.Fragment,{children:[g.jsx(Rt.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:b}),g.jsxs(Rt.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-sm mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[g.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(ya,{size:18}),g.jsx("span",{className:"font-medium",children:"Punt toevoegen"})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),g.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:a.fontScale,onChange:R=>a.setFontScale(parseInt(R.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${a.fontScale}%`}),g.jsx("span",{className:"text-xs opacity-70",children:"T"}),g.jsx("button",{onClick:b,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:g.jsx(si,{size:18})})]})]}),g.jsx("div",{className:"px-4 py-1.5",children:g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:_.color}}),g.jsx("span",{className:"text-sm text-gray-600",children:_.name})]})}),g.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",style:{fontSize:`${w}px`},children:[g.jsxs("div",{children:[g.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Naam *"}),g.jsx("input",{type:"text",value:o,onChange:R=>l(R.target.value),className:"w-full px-3 py-1.5 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"},autoFocus:!0})]}),g.jsx(wbe,{photos:y,onAddPhoto:R=>x([...y,R]),onRemovePhoto:R=>x(y.filter(M=>M.id!==R))}),g.jsxs("div",{children:[g.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Notities"}),g.jsx("textarea",{value:c,onChange:R=>h(R.target.value),placeholder:"Beschrijving, tips, opmerkingen...",rows:2,className:"w-full px-3 py-1.5 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors resize-none",style:{fontSize:"1em"}})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Link"}),g.jsx("input",{type:"url",value:f,onChange:R=>m(R.target.value),placeholder:"https://...",className:"w-full px-3 py-1.5 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"}})]})]}),g.jsxs("div",{className:"p-3 flex gap-3",style:{fontSize:`${w}px`},children:[g.jsx("button",{onClick:b,className:"flex-1 px-4 py-1.5 bg-white hover:bg-blue-50 rounded-lg transition-colors border-0 outline-none text-gray-600",style:{fontSize:"1em"},children:"Annuleren"}),g.jsx("button",{onClick:S,disabled:!o.trim(),className:"flex-1 px-4 py-1.5 bg-orange-500 hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg transition-colors border-0 outline-none",style:{fontSize:"1em"},children:"Toevoegen"})]})]})]})}):null}function Tbe(){const{layerManagerModalOpen:n,closeLayerManagerModal:e,openCreateLayerModal:t,openLayerDashboard:r}=wr(),{layers:i,removeLayer:s,toggleVisibility:a,toggleArchived:o,exportLayerAsGeoJSON:l,importLayerFromGeoJSON:c}=hs(),h=Sn(),f=14*h.fontScale/100,[m,y]=X.useState(null),[x,_]=X.useState(null),[w,S]=X.useState(null),[b,R]=X.useState(!1),M=i.filter(j=>!j.archived),O=i.filter(j=>j.archived),G=b?O:M,A=j=>{x===j?(s(j),_(null)):(_(j),setTimeout(()=>_(null),3e3))},I=j=>{l(j)},P=async j=>{const Ee=j.target.files?.[0];if(Ee){try{const ke=await Ee.text(),Be=c(ke);Be.success||(S(Be.error||"Import mislukt"),setTimeout(()=>S(null),3e3))}catch{S("Kon bestand niet lezen"),setTimeout(()=>S(null),3e3)}j.target.value=""}},D=()=>{y(null),_(null),S(null),R(!1),e()},L=j=>{r(j)},U=()=>{D(),t()};return g.jsx($n,{children:n&&g.jsxs(g.Fragment,{children:[g.jsx(Rt.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:D}),g.jsxs(Rt.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[g.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(za,{size:18}),g.jsx("span",{className:"font-medium",children:"Mijn Lagen beheren"})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),g.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:h.fontScale,onChange:j=>h.setFontScale(parseInt(j.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${h.fontScale}%`}),g.jsx("span",{className:"text-xs opacity-70",children:"T"}),g.jsx("button",{onClick:D,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:g.jsx(si,{size:18})})]})]}),g.jsxs("div",{className:"flex border-b border-gray-100",children:[g.jsxs("button",{onClick:()=>R(!1),className:`flex-1 px-3 py-2 text-sm transition-colors border-0 outline-none ${b?"text-gray-500 hover:text-gray-700 hover:bg-gray-50":"text-orange-600 border-b-2 border-orange-500 bg-orange-50/50"}`,children:["Actief (",M.length,")"]}),g.jsxs("button",{onClick:()=>R(!0),className:`flex-1 px-3 py-2 text-sm transition-colors border-0 outline-none flex items-center justify-center gap-1 ${b?"text-orange-600 border-b-2 border-orange-500 bg-orange-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[g.jsx(dV,{size:14}),"Archief (",O.length,")"]})]}),g.jsxs("div",{className:"flex-1 overflow-y-auto",style:{fontSize:`${f}px`},children:[G.length===0?g.jsx("div",{className:"p-8 text-center text-gray-500",children:b?g.jsx("p",{style:{fontSize:"1em"},children:"Geen gearchiveerde lagen."}):g.jsxs(g.Fragment,{children:[g.jsx("p",{className:"mb-4",style:{fontSize:"1em"},children:"Je hebt nog geen eigen lagen."}),g.jsxs("button",{onClick:U,className:"px-4 py-2 bg-orange-500 hover:bg-orange-600 text-white rounded-lg transition-colors border-0 outline-none",style:{fontSize:"1em"},children:[g.jsx(Xa,{size:16,className:"inline mr-2"}),"Nieuwe laag aanmaken"]})]})}):g.jsx("div",{className:"divide-y divide-gray-100",children:G.map(j=>g.jsx(bbe,{layer:j,isExpanded:m===j.id,onToggleExpand:()=>y(m===j.id?null:j.id),onToggleVisibility:()=>a(j.id),onToggleArchived:()=>o(j.id),onOpenDashboard:()=>L(j.id),onExport:()=>I(j.id),onDelete:()=>A(j.id),confirmDelete:x===j.id,onRename:Ee=>hs.getState().updateLayer(j.id,{name:Ee}),onChangeColor:Ee=>hs.getState().updateLayer(j.id,{color:Ee})},j.id))}),w&&g.jsx("div",{className:"mx-4 my-2 p-3 bg-red-50 text-red-700 text-sm rounded-lg",children:w})]}),g.jsxs("div",{className:"p-4 flex gap-3",style:{fontSize:`${f}px`},children:[g.jsxs("label",{className:"flex-1 px-4 py-2 bg-white hover:bg-blue-50 rounded-lg transition-colors cursor-pointer flex items-center justify-center gap-2 border-0 outline-none text-gray-600",children:[g.jsx(Qy,{size:16}),g.jsx("span",{style:{fontSize:"1em"},children:"Importeren"}),g.jsx("input",{type:"file",accept:".geojson,.json",onChange:P,className:"hidden"})]}),g.jsxs("button",{onClick:U,className:"flex-1 px-4 py-2 bg-orange-500 hover:bg-orange-600 text-white rounded-lg transition-colors border-0 outline-none flex items-center justify-center gap-2",style:{fontSize:"1em"},children:[g.jsx(Xa,{size:16}),g.jsx("span",{children:"Nieuwe laag"})]})]})]})]})})}const Sbe=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899"];function bbe({layer:n,isExpanded:e,onToggleExpand:t,onToggleVisibility:r,onToggleArchived:i,onOpenDashboard:s,onExport:a,onDelete:o,confirmDelete:l,onRename:c,onChangeColor:h}){const[f,m]=X.useState(!1),[y,x]=X.useState(n.name),[_,w]=X.useState(!1),S=X.useRef(null);X.useEffect(()=>{f&&S.current&&(S.current.focus(),S.current.select())},[f]);const b=()=>{x(n.name),m(!0)},R=()=>{const I=y.trim();I&&I!==n.name&&c(I),m(!1)},M=()=>{x(n.name),m(!1)},O=I=>{I.key==="Enter"?R():I.key==="Escape"&&M()},G=n.points.filter(I=>I.status==="completed").length,A=n.points.length;return g.jsxs("div",{className:"bg-white",children:[g.jsxs("div",{className:"flex items-center gap-3 px-4 py-3",children:[g.jsx("button",{onClick:t,className:"p-1 text-gray-400 hover:text-gray-600 transition-colors border-0 outline-none bg-transparent",children:e?g.jsx(PE,{size:16}):g.jsx(Jy,{size:16})}),g.jsxs("div",{className:"relative",children:[g.jsx("button",{onClick:()=>w(!_),className:"w-5 h-5 rounded-full flex-shrink-0 border-2 border-white shadow-sm hover:scale-110 transition-transform cursor-pointer",style:{backgroundColor:n.color},title:"Kleur wijzigen"}),_&&g.jsx("div",{className:"absolute top-7 left-0 z-50 bg-white rounded-lg shadow-lg p-2 flex flex-wrap gap-1 w-24",children:Sbe.map(I=>g.jsx("button",{onClick:()=>{h(I),w(!1)},className:`w-5 h-5 rounded-full border-2 hover:scale-110 transition-transform ${I===n.color?"border-gray-800":"border-white"}`,style:{backgroundColor:I}},I))})]}),f?g.jsxs("div",{className:"flex-1 min-w-0 flex items-center gap-2",children:[g.jsx("input",{ref:S,type:"text",value:y,onChange:I=>x(I.target.value),onKeyDown:O,onBlur:R,className:"flex-1 px-2 py-1 text-gray-800 font-medium bg-orange-50 rounded outline-none focus:ring-2 focus:ring-orange-400"}),g.jsx("button",{onClick:R,className:"p-1 text-green-600 hover:bg-green-50 rounded transition-colors border-0 outline-none",title:"Opslaan",children:g.jsx(uc,{size:16})})]}):g.jsxs("button",{onClick:s,className:"flex-1 min-w-0 text-left border-0 outline-none bg-transparent hover:bg-orange-50 rounded px-2 py-1 -ml-2 transition-colors",title:"Bekijk dashboard",children:[g.jsx("div",{className:"font-medium text-gray-800 truncate hover:text-orange-600",children:n.name}),g.jsx("div",{className:"text-xs text-gray-500",children:A>0?g.jsxs("span",{className:G===A?"text-green-600":"",children:[G,"/",A," voltooid"]}):"Geen punten"})]}),!f&&g.jsx("button",{onClick:b,className:"p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",title:"Naam bewerken",children:g.jsx(rg,{size:16})}),g.jsx("button",{onClick:s,className:"p-2 text-orange-400 hover:text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none",title:"Open dashboard",children:g.jsx(xV,{size:18})}),!n.archived&&g.jsx("button",{onClick:r,className:`p-2 rounded transition-colors border-0 outline-none ${n.visible?"text-blue-500 hover:bg-blue-50":"text-gray-400 hover:bg-gray-100"}`,title:n.visible?"Verbergen":"Tonen",children:n.visible?g.jsx(Gv,{size:18}):g.jsx(Vv,{size:18})}),g.jsx("button",{onClick:i,className:`p-2 rounded transition-colors border-0 outline-none ${n.archived?"text-green-500 hover:text-green-600 hover:bg-green-50":"text-gray-400 hover:text-amber-600 hover:bg-amber-50"}`,title:n.archived?"Herstellen":"Archiveren",children:n.archived?g.jsx(Ple,{size:18}):g.jsx(dV,{size:18})}),g.jsx("button",{onClick:a,className:"p-2 text-gray-400 hover:text-green-600 hover:bg-green-50 rounded transition-colors border-0 outline-none",title:"Exporteren als GeoJSON",children:g.jsx(jv,{size:18})}),g.jsx("button",{onClick:o,className:`p-2 rounded transition-colors border-0 outline-none ${l?"text-white bg-red-500 hover:bg-red-600":"text-gray-400 hover:text-red-600 hover:bg-red-50"}`,title:l?"Klik nogmaals om te verwijderen":"Verwijderen",children:g.jsx(xc,{size:18})})]}),g.jsx($n,{children:e&&g.jsx(Rt.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:g.jsxs("div",{className:"px-4 pb-3 pl-12 space-y-2",children:[n.categories.length>0&&g.jsx("div",{className:"flex flex-wrap gap-1",children:n.categories.map(I=>g.jsx("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-600 text-xs rounded-full",children:I},I))}),n.points.length>0&&g.jsxs("div",{className:"text-xs text-gray-500 space-y-1 max-h-32 overflow-y-auto",children:[n.points.slice(0,5).map(I=>g.jsx("div",{className:"flex items-center gap-2",children:g.jsx("span",{className:`font-medium ${I.status==="completed"?"text-green-600 line-through":I.status==="skipped"?"text-gray-400 line-through":"text-gray-700"}`,children:I.name})},I.id)),n.points.length>5&&g.jsxs("div",{className:"text-gray-400",children:["...en ",n.points.length-5," meer"]})]}),g.jsxs("div",{className:"text-xs text-gray-400",children:["Aangemaakt: ",new Date(n.createdAt).toLocaleDateString("nl-NL")]})]})})})]})}function Rbe(){const{layerDashboardOpen:n,layerDashboardLayerId:e,closeLayerDashboard:t}=wr(),{getLayer:r,setPointStatus:i,updatePoint:s,removePoint:a}=hs(),o=Sn(),[l,c]=X.useState("all"),[h,f]=X.useState(null),[m,y]=X.useState(""),[x,_]=X.useState(null),w=e?r(e):null,S=14*o.fontScale/100;if(!w)return null;const b=w.points.filter(L=>l==="all"?!0:L.status===l),R=w.points.length,M=w.points.filter(L=>L.status==="completed").length,O=w.points.filter(L=>L.status==="todo").length,G=w.points.filter(L=>L.status==="skipped").length,A=(L,U)=>{i(w.id,L,U)},I=L=>{s(w.id,L,{notes:m}),f(null),y("")},P=L=>{x===L?(a(w.id,L),_(null)):(_(L),setTimeout(()=>_(null),3e3))},D=()=>{f(null),_(null),t()};return g.jsx($n,{children:n&&g.jsxs(g.Fragment,{children:[g.jsx(Rt.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:D}),g.jsxs(Rt.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[g.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("div",{className:"w-4 h-4 rounded-full border-2 border-white/50",style:{backgroundColor:w.color}}),g.jsx("span",{className:"font-medium truncate",children:w.name})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),g.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:o.fontScale,onChange:L=>o.setFontScale(parseInt(L.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${o.fontScale}%`}),g.jsx("span",{className:"text-xs opacity-70",children:"T"}),g.jsx("button",{onClick:D,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:g.jsx(si,{size:18})})]})]}),g.jsxs("div",{className:"px-4 py-2 bg-orange-50 flex items-center justify-between text-sm",children:[g.jsxs("span",{className:"text-orange-800 font-medium",children:[M,"/",R," voltooid"]}),g.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[g.jsxs("span",{className:"text-orange-600",children:[O," te doen"]}),G>0&&g.jsxs("span",{className:"text-gray-500",children:[G," overgeslagen"]})]})]}),g.jsx("div",{className:"flex border-b border-gray-100",children:["all","todo","completed","skipped"].map(L=>g.jsxs("button",{onClick:()=>c(L),className:`flex-1 px-3 py-2 text-sm transition-colors border-0 outline-none ${l===L?"text-orange-600 border-b-2 border-orange-500 bg-orange-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[L==="all"&&"Alles",L==="todo"&&"Te doen",L==="completed"&&"Voltooid",L==="skipped"&&"Overgeslagen"]},L))}),g.jsx("div",{className:"flex-1 overflow-y-auto",style:{fontSize:`${S}px`},children:b.length===0?g.jsx("div",{className:"p-8 text-center text-gray-500",children:g.jsx("p",{children:"Geen punten gevonden"})}):g.jsx("div",{className:"divide-y divide-gray-100",children:b.map(L=>g.jsx("div",{className:"p-3",children:g.jsxs("div",{className:"flex items-start gap-3",children:[g.jsxs("div",{className:"flex flex-col gap-1 pt-0.5",children:[g.jsx("button",{onClick:()=>A(L.id,L.status==="completed"?"todo":"completed"),className:`w-6 h-6 flex items-center justify-center rounded border-0 outline-none transition-colors ${L.status==="completed"?"bg-green-100 hover:bg-green-200":"bg-gray-100 hover:bg-green-100"}`,title:L.status==="completed"?"Markeer als te doen":"Markeer als voltooid",children:g.jsx(uc,{size:14,className:L.status==="completed"?"text-green-600":"text-gray-400"})}),g.jsx("button",{onClick:()=>A(L.id,L.status==="skipped"?"todo":"skipped"),className:`w-6 h-6 flex items-center justify-center rounded border-0 outline-none transition-colors ${L.status==="skipped"?"bg-gray-200 hover:bg-gray-300":"bg-gray-100 hover:bg-gray-200"}`,title:L.status==="skipped"?"Markeer als te doen":"Overslaan",children:g.jsx(Lle,{size:14,className:L.status==="skipped"?"text-gray-600":"text-gray-400"})})]}),L.photos&&L.photos.length>0&&g.jsxs("div",{className:"relative flex-shrink-0",children:[g.jsx("img",{src:L.photos[0].thumbnailUrl||L.photos[0].thumbnailBase64,alt:"Foto",className:"w-12 h-12 object-cover rounded border border-gray-200"}),L.photos.length>1&&g.jsxs("span",{className:"absolute -bottom-1 -right-1 bg-orange-500 text-white text-[9px] px-1 rounded-full",children:["+",L.photos.length-1]})]}),g.jsxs("div",{className:"flex-1 min-w-0",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("span",{className:`font-medium truncate ${L.status==="completed"?"text-green-700 line-through":L.status==="skipped"?"text-gray-400 line-through":"text-gray-800"}`,children:L.name}),L.sourceLayer&&g.jsxs("span",{className:"text-xs text-gray-400 truncate",children:["via ",L.sourceLayer]})]}),h===L.id?g.jsxs("div",{className:"mt-2",children:[g.jsx("textarea",{value:m,onChange:U=>y(U.target.value),placeholder:"Notities...",rows:2,className:"w-full px-2 py-1 bg-white rounded border-0 outline-none hover:bg-blue-50 transition-colors resize-none text-sm",autoFocus:!0}),g.jsxs("div",{className:"flex gap-2 mt-1",children:[g.jsx("button",{onClick:()=>I(L.id),className:"px-2 py-1 text-xs bg-orange-500 text-white rounded hover:bg-orange-600 border-0 outline-none",children:"Opslaan"}),g.jsx("button",{onClick:()=>{f(null),y("")},className:"px-2 py-1 text-xs bg-white text-gray-600 rounded hover:bg-blue-50 border-0 outline-none",children:"Annuleren"})]})]}):L.notes?g.jsx("p",{className:"text-sm text-gray-600 mt-1",children:L.notes}):null,L.url&&g.jsxs("a",{href:L.url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-xs text-blue-500 hover:text-blue-700 mt-1",children:[g.jsx(Iu,{size:12}),"Link"]})]}),g.jsxs("div",{className:"flex flex-col gap-1",children:[g.jsx("button",{onClick:()=>{f(L.id),y(L.notes)},className:"w-6 h-6 flex items-center justify-center text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded border-0 outline-none",title:"Notities bewerken",children:g.jsx(Xce,{size:14})}),g.jsx("button",{onClick:()=>{window.open(`https://www.google.com/maps/dir/?api=1&destination=${L.coordinates[1]},${L.coordinates[0]}`,"_blank")},className:"w-6 h-6 flex items-center justify-center text-blue-400 hover:text-blue-600 hover:bg-blue-50 rounded border-0 outline-none",title:"Navigeer naar",children:g.jsx(ya,{size:14})}),g.jsx("button",{onClick:()=>P(L.id),className:`w-6 h-6 flex items-center justify-center rounded border-0 outline-none ${x===L.id?"text-white bg-red-500 hover:bg-red-600":"text-gray-400 hover:text-red-600 hover:bg-red-50"}`,title:x===L.id?"Klik nogmaals":"Verwijderen",children:g.jsx(xc,{size:14})})]})]})},L.id))})})]})]})})}class xD{buffer=[];size;weights;constructor(e=8){this.size=e,this.weights=Array.from({length:e},(r,i)=>Math.pow(2,i));const t=this.weights.reduce((r,i)=>r+i,0);this.weights=this.weights.map(r=>r/t)}add(e){if(this.buffer.length>0){const t=this.buffer[this.buffer.length-1];let r=e-t;r>180&&(e-=360),r<-180&&(e+=360)}this.buffer.push(e),this.buffer.length>this.size&&this.buffer.shift()}getSmoothed(){if(this.buffer.length===0)return null;if(this.buffer.length===1)return this.normalizeHeading(this.buffer[0]);let e=0,t=0;const r=this.size-this.buffer.length;for(let i=0;i<this.buffer.length;i++){const s=this.weights[r+i];e+=this.buffer[i]*s,t+=s}return this.normalizeHeading(e/t)}normalizeHeading(e){return(e%360+360)%360}clear(){this.buffer=[]}}function Abe(){const n=ws(c=>c.tracking),e=ws(c=>c.headingSource);ws(c=>c.speed);const t=ws(c=>c.setSmoothedHeading),r=X.useRef(new xD(6)),i=X.useRef(new xD(10)),s=X.useRef(0),a=X.useRef(null),o=33,l=X.useCallback((c,h)=>{const f=performance.now();if(f-s.current<o)return;const m=h==="gps"?r.current:i.current;m.add(c);const y=m.getSmoothed();y!==null&&(s.current=f,t(y))},[t]);X.useEffect(()=>{if(!n)return;const c=f=>{f.coords.heading!==null&&f.coords.speed!==null&&f.coords.speed>.8&&f.coords.accuracy<20&&l(f.coords.heading,"gps")},h=navigator.geolocation.watchPosition(c,()=>{},{enableHighAccuracy:!0,maximumAge:500,timeout:1e4});return()=>navigator.geolocation.clearWatch(h)},[n,l]),X.useEffect(()=>{if(!n||e!=="compass")return;let c=0;const h=50,f=y=>{const x=performance.now();if(!(x-c<h)&&(c=x,y.alpha!==null)){const _=(360-y.alpha)%360;l(_,"compass")}},m=y=>{const x=performance.now();x-c<h||(c=x,y.webkitCompassHeading!==void 0&&l(y.webkitCompassHeading,"compass"))};return window.addEventListener("deviceorientationabsolute",f),window.addEventListener("deviceorientation",m),()=>{window.removeEventListener("deviceorientationabsolute",f),window.removeEventListener("deviceorientation",m)}},[n,e,l]),X.useEffect(()=>{n||(r.current.clear(),i.current.clear())},[n]),X.useEffect(()=>()=>{a.current&&cancelAnimationFrame(a.current)},[])}function Ibe(){const n=pi(i=>i.map),e=Ri(i=>i.setLayerOpacity),t=Ri(i=>i.visible),r=X.useRef(null);X.useEffect(()=>{if(!n)return;const i=()=>{const s=n.getView().getZoom();if(!s||r.current!==null&&Math.abs(s-r.current)<.5)return;r.current=s;const a=t["AHN 0.5m"],o=t["AHN4 Multi-Hillshade NL"];!a&&!o||(a&&(s>=18?e("AHN 0.5m",.85):s>=16?e("AHN 0.5m",.75):s>=14?e("AHN 0.5m",.65):e("AHN 0.5m",.55)),o&&(s>=18?e("AHN4 Multi-Hillshade NL",.8):s>=16?e("AHN4 Multi-Hillshade NL",.7):s>=14?e("AHN4 Multi-Hillshade NL",.6):e("AHN4 Multi-Hillshade NL",.5)))};return n.on("moveend",i),i(),()=>{n.un("moveend",i)}},[n,t,e])}const _D=2e3;function Cbe(){const n=TE(m=>m.user),{layers:e,clearAll:t}=hs(),{vondsten:r,clearAll:i}=cl(),s=X.useRef(null),a=X.useRef(!0),o=X.useRef(""),l=X.useRef(""),c=X.useCallback(async m=>{if(n)try{const y=w0(mu,"users",n.uid);await E3(y,{layers:m,layersUpdatedAt:T3()},{merge:!0}),console.log(" Lagen gesynchroniseerd naar cloud")}catch(y){console.error(" Fout bij synchroniseren lagen:",y)}},[n]),h=X.useCallback(async m=>{if(n)try{const y=w0(mu,"users",n.uid);await E3(y,{vondsten:m,vondstenUpdatedAt:T3()},{merge:!0}),console.log(" Vondsten gesynchroniseerd naar cloud")}catch(y){console.error(" Fout bij synchroniseren vondsten:",y)}},[n]),f=X.useCallback(async()=>{if(n)try{const m=w0(mu,"users",n.uid),y=await cre(m);if(y.exists()){const x=y.data();if(x.layers&&Array.isArray(x.layers)){const _=x.layers,w=hs.getState().layers,S=[..._],b=new Set(_.map(R=>R.id));w.forEach(R=>{b.has(R.id)||S.push(R)}),hs.setState({layers:S}),o.current=JSON.stringify(S),console.log(` ${_.length} lagen geladen uit cloud`)}if(x.vondsten&&Array.isArray(x.vondsten)){const _=x.vondsten,w=cl.getState().vondsten,S=[..._],b=new Set(_.map(R=>R.id));w.forEach(R=>{b.has(R.id)||S.push(R)}),cl.setState({vondsten:S}),l.current=JSON.stringify(S),console.log(` ${_.length} vondsten geladen uit cloud`)}}else console.log(" Geen cloud data gevonden, lokale data wordt gesynchroniseerd..."),await c(e),await h(r);a.current=!1}catch(m){console.error(" Fout bij laden uit cloud:",m),a.current=!1}},[n,e,r,c,h]);return X.useEffect(()=>{n?(a.current=!0,f()):(a.current=!0,o.current="",l.current="")},[n?.uid]),X.useEffect(()=>{if(!n||a.current)return;const m=JSON.stringify(e);if(m!==o.current)return s.current&&clearTimeout(s.current),s.current=setTimeout(()=>{o.current=m,c(e)},_D),()=>{s.current&&clearTimeout(s.current)}},[n,e,c]),X.useEffect(()=>{if(!n||a.current)return;const m=JSON.stringify(r);if(m!==l.current)return s.current&&clearTimeout(s.current),s.current=setTimeout(()=>{l.current=m,h(r)},_D),()=>{s.current&&clearTimeout(s.current)}},[n,r,h]),{isLoggedIn:!!n,syncLayersToCloud:c,syncVondstenToCloud:h}}function kbe(){Abe(),Ibe(),Cbe();const e=14*Sn(o=>o.fontScale)/100,t=wr(o=>o.vondstFormOpen),r=wr(o=>o.vondstFormLocation),i=wr(o=>o.closeVondstForm),s=wr(o=>o.routeDashboardOpen),a=wr(o=>o.toggleRouteDashboard);return g.jsx(ySe,{children:g.jsxs("div",{style:{fontSize:`${e}px`},children:[g.jsx(Jre,{}),g.jsx(que,{}),g.jsx(hbe,{}),g.jsx(TSe,{}),g.jsx(gbe,{}),g.jsx(JSe,{}),g.jsx(QSe,{}),g.jsx(ebe,{}),g.jsx(nbe,{}),g.jsx(eSe,{}),g.jsx(nSe,{}),g.jsx(gSe,{}),g.jsx(Kue,{}),g.jsx(qSe,{}),g.jsx(YSe,{}),g.jsx(mSe,{}),g.jsx(Zue,{}),g.jsx(nhe,{}),g.jsx(fSe,{}),g.jsx(GSe,{}),g.jsx(cSe,{}),g.jsx(zSe,{}),g.jsx(uSe,{}),g.jsx(DSe,{}),g.jsx(mbe,{}),g.jsx(Ebe,{}),g.jsx(Tbe,{}),g.jsx(Rbe,{}),g.jsx(cbe,{isOpen:s,onClose:a}),g.jsx($n,{children:t&&g.jsx(hz,{onClose:i,initialLocation:r||void 0})})]})})}console.log(`%c DetectorApp v${mw}`,"background: #4CAF50; color: white; padding: 4px 8px; border-radius: 4px; font-weight: bold;");IU.createRoot(document.getElementById("root")).render(g.jsx(kbe,{}));export{bK as A,dX as B,vr as C,_r as F,ik as G,cX as I,On as L,It as N,PK as P,mn as S,Sh as T,xs as U,gc as V,Lbe as W,Hf as X,$X as a,DX as b,Wu as c,Yn as d,Zt as e,gi as f,Mp as g,by as h,rr as i,vo as j,Ir as k,bi as l,$s as m,$F as n,Tn as p,RG as r,BA as u};
//# sourceMappingURL=index-CRofYUyJ.js.map
