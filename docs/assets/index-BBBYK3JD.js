const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/amkOL-D7xei8nL.js","assets/layerLoaderOL-DSj9Orsz.js","assets/romeinsOL-Cb34Bbrd.js","assets/kastelenOL-B_SHONZ6.js","assets/iconStyles-YeoZXvTb.js","assets/ruinesOL-GFxQkzLY.js","assets/hunebeddenOL-BwbZRhar.js","assets/uikavArcheoPuntenOL-B0Cr8DC9.js","assets/uikavVlakkenOL-BpU0Cv75.js","assets/uikavBufferlaagOL-DVc5nJOu.js","assets/uikavExpertOL-B-7ApSlm.js","assets/uikavUiterwaardenOL-DVNkBDPy.js","assets/speeltuinenOL-BSFdxmad.js","assets/museaOL-LwLTRsxn.js","assets/strandjesOL-CZsL_qJi.js","assets/parkenOL-DFd20PBd.js","assets/kringloopwinkelsOL-CJENjN6Y.js","assets/fossielenOL-d04eSUvk.js","assets/fossielUtils-Cqiofz_L.js","assets/fossielenBelgieOL-D_9Dtq6a.js","assets/fossielenDuitslandOL-8s82ByTi.js","assets/fossielenFrankrijkOL-BxLldItc.js","assets/bunkersOL-D-bCdWNe.js","assets/grafheuvelsOL-BegDphCB.js","assets/slagveldenOL-D6ktnLAK.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();function BI(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var m2={exports:{}},Pg={},p2={exports:{}},Jt={};var v4;function gB(){if(v4)return Jt;v4=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),a=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;function g(te){return te===null||typeof te!="object"?null:(te=f&&te[f]||te["@@iterator"],typeof te=="function"?te:null)}var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E=Object.assign,x={};function w(te,V,ie){this.props=te,this.context=V,this.refs=x,this.updater=ie||p}w.prototype.isReactComponent={},w.prototype.setState=function(te,V){if(typeof te!="object"&&typeof te!="function"&&te!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,te,V,"setState")},w.prototype.forceUpdate=function(te){this.updater.enqueueForceUpdate(this,te,"forceUpdate")};function T(){}T.prototype=w.prototype;function I(te,V,ie){this.props=te,this.context=V,this.refs=x,this.updater=ie||p}var P=I.prototype=new T;P.constructor=I,E(P,w.prototype),P.isPureReactComponent=!0;var N=Array.isArray,D=Object.prototype.hasOwnProperty,B={current:null},k={key:!0,ref:!0,__self:!0,__source:!0};function C(te,V,ie){var ne,ee={},fe=null,Oe=null;if(V!=null)for(ne in V.ref!==void 0&&(Oe=V.ref),V.key!==void 0&&(fe=""+V.key),V)D.call(V,ne)&&!k.hasOwnProperty(ne)&&(ee[ne]=V[ne]);var Se=arguments.length-2;if(Se===1)ee.children=ie;else if(1<Se){for(var Fe=Array(Se),je=0;je<Se;je++)Fe[je]=arguments[je+2];ee.children=Fe}if(te&&te.defaultProps)for(ne in Se=te.defaultProps,Se)ee[ne]===void 0&&(ee[ne]=Se[ne]);return{$$typeof:n,type:te,key:fe,ref:Oe,props:ee,_owner:B.current}}function M(te,V){return{$$typeof:n,type:te.type,key:V,ref:te.ref,props:te.props,_owner:te._owner}}function j(te){return typeof te=="object"&&te!==null&&te.$$typeof===n}function O(te){var V={"=":"=0",":":"=2"};return"$"+te.replace(/[=:]/g,function(ie){return V[ie]})}var W=/\/+/g;function F(te,V){return typeof te=="object"&&te!==null&&te.key!=null?O(""+te.key):V.toString(36)}function Te(te,V,ie,ne,ee){var fe=typeof te;(fe==="undefined"||fe==="boolean")&&(te=null);var Oe=!1;if(te===null)Oe=!0;else switch(fe){case"string":case"number":Oe=!0;break;case"object":switch(te.$$typeof){case n:case e:Oe=!0}}if(Oe)return Oe=te,ee=ee(Oe),te=ne===""?"."+F(Oe,0):ne,N(ee)?(ie="",te!=null&&(ie=te.replace(W,"$&/")+"/"),Te(ee,V,ie,"",function(je){return je})):ee!=null&&(j(ee)&&(ee=M(ee,ie+(!ee.key||Oe&&Oe.key===ee.key?"":(""+ee.key).replace(W,"$&/")+"/")+te)),V.push(ee)),1;if(Oe=0,ne=ne===""?".":ne+":",N(te))for(var Se=0;Se<te.length;Se++){fe=te[Se];var Fe=ne+F(fe,Se);Oe+=Te(fe,V,ie,Fe,ee)}else if(Fe=g(te),typeof Fe=="function")for(te=Fe.call(te),Se=0;!(fe=te.next()).done;)fe=fe.value,Fe=ne+F(fe,Se++),Oe+=Te(fe,V,ie,Fe,ee);else if(fe==="object")throw V=String(te),Error("Objects are not valid as a React child (found: "+(V==="[object Object]"?"object with keys {"+Object.keys(te).join(", ")+"}":V)+"). If you meant to render a collection of children, use an array instead.");return Oe}function Me(te,V,ie){if(te==null)return te;var ne=[],ee=0;return Te(te,ne,"","",function(fe){return V.call(ie,fe,ee++)}),ne}function Le(te){if(te._status===-1){var V=te._result;V=V(),V.then(function(ie){(te._status===0||te._status===-1)&&(te._status=1,te._result=ie)},function(ie){(te._status===0||te._status===-1)&&(te._status=2,te._result=ie)}),te._status===-1&&(te._status=0,te._result=V)}if(te._status===1)return te._result.default;throw te._result}var Re={current:null},ue={transition:null},be={ReactCurrentDispatcher:Re,ReactCurrentBatchConfig:ue,ReactCurrentOwner:B};function ce(){throw Error("act(...) is not supported in production builds of React.")}return Jt.Children={map:Me,forEach:function(te,V,ie){Me(te,function(){V.apply(this,arguments)},ie)},count:function(te){var V=0;return Me(te,function(){V++}),V},toArray:function(te){return Me(te,function(V){return V})||[]},only:function(te){if(!j(te))throw Error("React.Children.only expected to receive a single React element child.");return te}},Jt.Component=w,Jt.Fragment=t,Jt.Profiler=i,Jt.PureComponent=I,Jt.StrictMode=r,Jt.Suspense=l,Jt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=be,Jt.act=ce,Jt.cloneElement=function(te,V,ie){if(te==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+te+".");var ne=E({},te.props),ee=te.key,fe=te.ref,Oe=te._owner;if(V!=null){if(V.ref!==void 0&&(fe=V.ref,Oe=B.current),V.key!==void 0&&(ee=""+V.key),te.type&&te.type.defaultProps)var Se=te.type.defaultProps;for(Fe in V)D.call(V,Fe)&&!k.hasOwnProperty(Fe)&&(ne[Fe]=V[Fe]===void 0&&Se!==void 0?Se[Fe]:V[Fe])}var Fe=arguments.length-2;if(Fe===1)ne.children=ie;else if(1<Fe){Se=Array(Fe);for(var je=0;je<Fe;je++)Se[je]=arguments[je+2];ne.children=Se}return{$$typeof:n,type:te.type,key:ee,ref:fe,props:ne,_owner:Oe}},Jt.createContext=function(te){return te={$$typeof:a,_currentValue:te,_currentValue2:te,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},te.Provider={$$typeof:s,_context:te},te.Consumer=te},Jt.createElement=C,Jt.createFactory=function(te){var V=C.bind(null,te);return V.type=te,V},Jt.createRef=function(){return{current:null}},Jt.forwardRef=function(te){return{$$typeof:o,render:te}},Jt.isValidElement=j,Jt.lazy=function(te){return{$$typeof:h,_payload:{_status:-1,_result:te},_init:Le}},Jt.memo=function(te,V){return{$$typeof:u,type:te,compare:V===void 0?null:V}},Jt.startTransition=function(te){var V=ue.transition;ue.transition={};try{te()}finally{ue.transition=V}},Jt.unstable_act=ce,Jt.useCallback=function(te,V){return Re.current.useCallback(te,V)},Jt.useContext=function(te){return Re.current.useContext(te)},Jt.useDebugValue=function(){},Jt.useDeferredValue=function(te){return Re.current.useDeferredValue(te)},Jt.useEffect=function(te,V){return Re.current.useEffect(te,V)},Jt.useId=function(){return Re.current.useId()},Jt.useImperativeHandle=function(te,V,ie){return Re.current.useImperativeHandle(te,V,ie)},Jt.useInsertionEffect=function(te,V){return Re.current.useInsertionEffect(te,V)},Jt.useLayoutEffect=function(te,V){return Re.current.useLayoutEffect(te,V)},Jt.useMemo=function(te,V){return Re.current.useMemo(te,V)},Jt.useReducer=function(te,V,ie){return Re.current.useReducer(te,V,ie)},Jt.useRef=function(te){return Re.current.useRef(te)},Jt.useState=function(te){return Re.current.useState(te)},Jt.useSyncExternalStore=function(te,V,ie){return Re.current.useSyncExternalStore(te,V,ie)},Jt.useTransition=function(){return Re.current.useTransition()},Jt.version="18.3.1",Jt}var E4;function Lp(){return E4||(E4=1,p2.exports=gB()),p2.exports}var w4;function mB(){if(w4)return Pg;w4=1;var n=Lp(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,i=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function a(o,l,u){var h,f={},g=null,p=null;u!==void 0&&(g=""+u),l.key!==void 0&&(g=""+l.key),l.ref!==void 0&&(p=l.ref);for(h in l)r.call(l,h)&&!s.hasOwnProperty(h)&&(f[h]=l[h]);if(o&&o.defaultProps)for(h in l=o.defaultProps,l)f[h]===void 0&&(f[h]=l[h]);return{$$typeof:e,type:o,key:g,ref:p,props:f,_owner:i.current}}return Pg.Fragment=t,Pg.jsx=a,Pg.jsxs=a,Pg}var S4;function pB(){return S4||(S4=1,m2.exports=mB()),m2.exports}var y=pB(),Oy={},y2={exports:{}},us={},_2={exports:{}},x2={};var T4;function yB(){return T4||(T4=1,(function(n){function e(ue,be){var ce=ue.length;ue.push(be);e:for(;0<ce;){var te=ce-1>>>1,V=ue[te];if(0<i(V,be))ue[te]=be,ue[ce]=V,ce=te;else break e}}function t(ue){return ue.length===0?null:ue[0]}function r(ue){if(ue.length===0)return null;var be=ue[0],ce=ue.pop();if(ce!==be){ue[0]=ce;e:for(var te=0,V=ue.length,ie=V>>>1;te<ie;){var ne=2*(te+1)-1,ee=ue[ne],fe=ne+1,Oe=ue[fe];if(0>i(ee,ce))fe<V&&0>i(Oe,ee)?(ue[te]=Oe,ue[fe]=ce,te=fe):(ue[te]=ee,ue[ne]=ce,te=ne);else if(fe<V&&0>i(Oe,ce))ue[te]=Oe,ue[fe]=ce,te=fe;else break e}}return be}function i(ue,be){var ce=ue.sortIndex-be.sortIndex;return ce!==0?ce:ue.id-be.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();n.unstable_now=function(){return a.now()-o}}var l=[],u=[],h=1,f=null,g=3,p=!1,E=!1,x=!1,w=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function P(ue){for(var be=t(u);be!==null;){if(be.callback===null)r(u);else if(be.startTime<=ue)r(u),be.sortIndex=be.expirationTime,e(l,be);else break;be=t(u)}}function N(ue){if(x=!1,P(ue),!E)if(t(l)!==null)E=!0,Le(D);else{var be=t(u);be!==null&&Re(N,be.startTime-ue)}}function D(ue,be){E=!1,x&&(x=!1,T(C),C=-1),p=!0;var ce=g;try{for(P(be),f=t(l);f!==null&&(!(f.expirationTime>be)||ue&&!O());){var te=f.callback;if(typeof te=="function"){f.callback=null,g=f.priorityLevel;var V=te(f.expirationTime<=be);be=n.unstable_now(),typeof V=="function"?f.callback=V:f===t(l)&&r(l),P(be)}else r(l);f=t(l)}if(f!==null)var ie=!0;else{var ne=t(u);ne!==null&&Re(N,ne.startTime-be),ie=!1}return ie}finally{f=null,g=ce,p=!1}}var B=!1,k=null,C=-1,M=5,j=-1;function O(){return!(n.unstable_now()-j<M)}function W(){if(k!==null){var ue=n.unstable_now();j=ue;var be=!0;try{be=k(!0,ue)}finally{be?F():(B=!1,k=null)}}else B=!1}var F;if(typeof I=="function")F=function(){I(W)};else if(typeof MessageChannel<"u"){var Te=new MessageChannel,Me=Te.port2;Te.port1.onmessage=W,F=function(){Me.postMessage(null)}}else F=function(){w(W,0)};function Le(ue){k=ue,B||(B=!0,F())}function Re(ue,be){C=w(function(){ue(n.unstable_now())},be)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ue){ue.callback=null},n.unstable_continueExecution=function(){E||p||(E=!0,Le(D))},n.unstable_forceFrameRate=function(ue){0>ue||125<ue?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<ue?Math.floor(1e3/ue):5},n.unstable_getCurrentPriorityLevel=function(){return g},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(ue){switch(g){case 1:case 2:case 3:var be=3;break;default:be=g}var ce=g;g=be;try{return ue()}finally{g=ce}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(ue,be){switch(ue){case 1:case 2:case 3:case 4:case 5:break;default:ue=3}var ce=g;g=ue;try{return be()}finally{g=ce}},n.unstable_scheduleCallback=function(ue,be,ce){var te=n.unstable_now();switch(typeof ce=="object"&&ce!==null?(ce=ce.delay,ce=typeof ce=="number"&&0<ce?te+ce:te):ce=te,ue){case 1:var V=-1;break;case 2:V=250;break;case 5:V=1073741823;break;case 4:V=1e4;break;default:V=5e3}return V=ce+V,ue={id:h++,callback:be,priorityLevel:ue,startTime:ce,expirationTime:V,sortIndex:-1},ce>te?(ue.sortIndex=ce,e(u,ue),t(l)===null&&ue===t(u)&&(x?(T(C),C=-1):x=!0,Re(N,ce-te))):(ue.sortIndex=V,e(l,ue),E||p||(E=!0,Le(D))),ue},n.unstable_shouldYield=O,n.unstable_wrapCallback=function(ue){var be=g;return function(){var ce=g;g=be;try{return ue.apply(this,arguments)}finally{g=ce}}}})(x2)),x2}var I4;function _B(){return I4||(I4=1,_2.exports=yB()),_2.exports}var A4;function xB(){if(A4)return us;A4=1;var n=Lp(),e=_B();function t(c){for(var d="https://reactjs.org/docs/error-decoder.html?invariant="+c,m=1;m<arguments.length;m++)d+="&args[]="+encodeURIComponent(arguments[m]);return"Minified React error #"+c+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,i={};function s(c,d){a(c,d),a(c+"Capture",d)}function a(c,d){for(i[c]=d,c=0;c<d.length;c++)r.add(d[c])}var o=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),l=Object.prototype.hasOwnProperty,u=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},f={};function g(c){return l.call(f,c)?!0:l.call(h,c)?!1:u.test(c)?f[c]=!0:(h[c]=!0,!1)}function p(c,d,m,v){if(m!==null&&m.type===0)return!1;switch(typeof d){case"function":case"symbol":return!0;case"boolean":return v?!1:m!==null?!m.acceptsBooleans:(c=c.toLowerCase().slice(0,5),c!=="data-"&&c!=="aria-");default:return!1}}function E(c,d,m,v){if(d===null||typeof d>"u"||p(c,d,m,v))return!0;if(v)return!1;if(m!==null)switch(m.type){case 3:return!d;case 4:return d===!1;case 5:return isNaN(d);case 6:return isNaN(d)||1>d}return!1}function x(c,d,m,v,S,A,G){this.acceptsBooleans=d===2||d===3||d===4,this.attributeName=v,this.attributeNamespace=S,this.mustUseProperty=m,this.propertyName=c,this.type=d,this.sanitizeURL=A,this.removeEmptyString=G}var w={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(c){w[c]=new x(c,0,!1,c,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(c){var d=c[0];w[d]=new x(d,1,!1,c[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(c){w[c]=new x(c,2,!1,c.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(c){w[c]=new x(c,2,!1,c,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(c){w[c]=new x(c,3,!1,c.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(c){w[c]=new x(c,3,!0,c,null,!1,!1)}),["capture","download"].forEach(function(c){w[c]=new x(c,4,!1,c,null,!1,!1)}),["cols","rows","size","span"].forEach(function(c){w[c]=new x(c,6,!1,c,null,!1,!1)}),["rowSpan","start"].forEach(function(c){w[c]=new x(c,5,!1,c.toLowerCase(),null,!1,!1)});var T=/[\-:]([a-z])/g;function I(c){return c[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(c){var d=c.replace(T,I);w[d]=new x(d,1,!1,c,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(c){var d=c.replace(T,I);w[d]=new x(d,1,!1,c,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(c){var d=c.replace(T,I);w[d]=new x(d,1,!1,c,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(c){w[c]=new x(c,1,!1,c.toLowerCase(),null,!1,!1)}),w.xlinkHref=new x("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(c){w[c]=new x(c,1,!1,c.toLowerCase(),null,!0,!0)});function P(c,d,m,v){var S=w.hasOwnProperty(d)?w[d]:null;(S!==null?S.type!==0:v||!(2<d.length)||d[0]!=="o"&&d[0]!=="O"||d[1]!=="n"&&d[1]!=="N")&&(E(d,m,S,v)&&(m=null),v||S===null?g(d)&&(m===null?c.removeAttribute(d):c.setAttribute(d,""+m)):S.mustUseProperty?c[S.propertyName]=m===null?S.type===3?!1:"":m:(d=S.attributeName,v=S.attributeNamespace,m===null?c.removeAttribute(d):(S=S.type,m=S===3||S===4&&m===!0?"":""+m,v?c.setAttributeNS(v,d,m):c.setAttribute(d,m))))}var N=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,D=Symbol.for("react.element"),B=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),M=Symbol.for("react.profiler"),j=Symbol.for("react.provider"),O=Symbol.for("react.context"),W=Symbol.for("react.forward_ref"),F=Symbol.for("react.suspense"),Te=Symbol.for("react.suspense_list"),Me=Symbol.for("react.memo"),Le=Symbol.for("react.lazy"),Re=Symbol.for("react.offscreen"),ue=Symbol.iterator;function be(c){return c===null||typeof c!="object"?null:(c=ue&&c[ue]||c["@@iterator"],typeof c=="function"?c:null)}var ce=Object.assign,te;function V(c){if(te===void 0)try{throw Error()}catch(m){var d=m.stack.trim().match(/\n( *(at )?)/);te=d&&d[1]||""}return`
`+te+c}var ie=!1;function ne(c,d){if(!c||ie)return"";ie=!0;var m=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(d)if(d=function(){throw Error()},Object.defineProperty(d.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(d,[])}catch(Ee){var v=Ee}Reflect.construct(c,[],d)}else{try{d.call()}catch(Ee){v=Ee}c.call(d.prototype)}else{try{throw Error()}catch(Ee){v=Ee}c()}}catch(Ee){if(Ee&&v&&typeof Ee.stack=="string"){for(var S=Ee.stack.split(`
`),A=v.stack.split(`
`),G=S.length-1,J=A.length-1;1<=G&&0<=J&&S[G]!==A[J];)J--;for(;1<=G&&0<=J;G--,J--)if(S[G]!==A[J]){if(G!==1||J!==1)do if(G--,J--,0>J||S[G]!==A[J]){var ae=`
`+S[G].replace(" at new "," at ");return c.displayName&&ae.includes("<anonymous>")&&(ae=ae.replace("<anonymous>",c.displayName)),ae}while(1<=G&&0<=J);break}}}finally{ie=!1,Error.prepareStackTrace=m}return(c=c?c.displayName||c.name:"")?V(c):""}function ee(c){switch(c.tag){case 5:return V(c.type);case 16:return V("Lazy");case 13:return V("Suspense");case 19:return V("SuspenseList");case 0:case 2:case 15:return c=ne(c.type,!1),c;case 11:return c=ne(c.type.render,!1),c;case 1:return c=ne(c.type,!0),c;default:return""}}function fe(c){if(c==null)return null;if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c;switch(c){case k:return"Fragment";case B:return"Portal";case M:return"Profiler";case C:return"StrictMode";case F:return"Suspense";case Te:return"SuspenseList"}if(typeof c=="object")switch(c.$$typeof){case O:return(c.displayName||"Context")+".Consumer";case j:return(c._context.displayName||"Context")+".Provider";case W:var d=c.render;return c=c.displayName,c||(c=d.displayName||d.name||"",c=c!==""?"ForwardRef("+c+")":"ForwardRef"),c;case Me:return d=c.displayName||null,d!==null?d:fe(c.type)||"Memo";case Le:d=c._payload,c=c._init;try{return fe(c(d))}catch{}}return null}function Oe(c){var d=c.type;switch(c.tag){case 24:return"Cache";case 9:return(d.displayName||"Context")+".Consumer";case 10:return(d._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return c=d.render,c=c.displayName||c.name||"",d.displayName||(c!==""?"ForwardRef("+c+")":"ForwardRef");case 7:return"Fragment";case 5:return d;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return fe(d);case 8:return d===C?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof d=="function")return d.displayName||d.name||null;if(typeof d=="string")return d}return null}function Se(c){switch(typeof c){case"boolean":case"number":case"string":case"undefined":return c;case"object":return c;default:return""}}function Fe(c){var d=c.type;return(c=c.nodeName)&&c.toLowerCase()==="input"&&(d==="checkbox"||d==="radio")}function je(c){var d=Fe(c)?"checked":"value",m=Object.getOwnPropertyDescriptor(c.constructor.prototype,d),v=""+c[d];if(!c.hasOwnProperty(d)&&typeof m<"u"&&typeof m.get=="function"&&typeof m.set=="function"){var S=m.get,A=m.set;return Object.defineProperty(c,d,{configurable:!0,get:function(){return S.call(this)},set:function(G){v=""+G,A.call(this,G)}}),Object.defineProperty(c,d,{enumerable:m.enumerable}),{getValue:function(){return v},setValue:function(G){v=""+G},stopTracking:function(){c._valueTracker=null,delete c[d]}}}}function Qe(c){c._valueTracker||(c._valueTracker=je(c))}function gt(c){if(!c)return!1;var d=c._valueTracker;if(!d)return!0;var m=d.getValue(),v="";return c&&(v=Fe(c)?c.checked?"true":"false":c.value),c=v,c!==m?(d.setValue(c),!0):!1}function yt(c){if(c=c||(typeof document<"u"?document:void 0),typeof c>"u")return null;try{return c.activeElement||c.body}catch{return c.body}}function Lt(c,d){var m=d.checked;return ce({},d,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:m??c._wrapperState.initialChecked})}function nn(c,d){var m=d.defaultValue==null?"":d.defaultValue,v=d.checked!=null?d.checked:d.defaultChecked;m=Se(d.value!=null?d.value:m),c._wrapperState={initialChecked:v,initialValue:m,controlled:d.type==="checkbox"||d.type==="radio"?d.checked!=null:d.value!=null}}function Ut(c,d){d=d.checked,d!=null&&P(c,"checked",d,!1)}function De(c,d){Ut(c,d);var m=Se(d.value),v=d.type;if(m!=null)v==="number"?(m===0&&c.value===""||c.value!=m)&&(c.value=""+m):c.value!==""+m&&(c.value=""+m);else if(v==="submit"||v==="reset"){c.removeAttribute("value");return}d.hasOwnProperty("value")?Ie(c,d.type,m):d.hasOwnProperty("defaultValue")&&Ie(c,d.type,Se(d.defaultValue)),d.checked==null&&d.defaultChecked!=null&&(c.defaultChecked=!!d.defaultChecked)}function Xt(c,d,m){if(d.hasOwnProperty("value")||d.hasOwnProperty("defaultValue")){var v=d.type;if(!(v!=="submit"&&v!=="reset"||d.value!==void 0&&d.value!==null))return;d=""+c._wrapperState.initialValue,m||d===c.value||(c.value=d),c.defaultValue=d}m=c.name,m!==""&&(c.name=""),c.defaultChecked=!!c._wrapperState.initialChecked,m!==""&&(c.name=m)}function Ie(c,d,m){(d!=="number"||yt(c.ownerDocument)!==c)&&(m==null?c.defaultValue=""+c._wrapperState.initialValue:c.defaultValue!==""+m&&(c.defaultValue=""+m))}var me=Array.isArray;function R(c,d,m,v){if(c=c.options,d){d={};for(var S=0;S<m.length;S++)d["$"+m[S]]=!0;for(m=0;m<c.length;m++)S=d.hasOwnProperty("$"+c[m].value),c[m].selected!==S&&(c[m].selected=S),S&&v&&(c[m].defaultSelected=!0)}else{for(m=""+Se(m),d=null,S=0;S<c.length;S++){if(c[S].value===m){c[S].selected=!0,v&&(c[S].defaultSelected=!0);return}d!==null||c[S].disabled||(d=c[S])}d!==null&&(d.selected=!0)}}function Et(c,d){if(d.dangerouslySetInnerHTML!=null)throw Error(t(91));return ce({},d,{value:void 0,defaultValue:void 0,children:""+c._wrapperState.initialValue})}function X(c,d){var m=d.value;if(m==null){if(m=d.children,d=d.defaultValue,m!=null){if(d!=null)throw Error(t(92));if(me(m)){if(1<m.length)throw Error(t(93));m=m[0]}d=m}d==null&&(d=""),m=d}c._wrapperState={initialValue:Se(m)}}function Ot(c,d){var m=Se(d.value),v=Se(d.defaultValue);m!=null&&(m=""+m,m!==c.value&&(c.value=m),d.defaultValue==null&&c.defaultValue!==m&&(c.defaultValue=m)),v!=null&&(c.defaultValue=""+v)}function re(c){var d=c.textContent;d===c._wrapperState.initialValue&&d!==""&&d!==null&&(c.value=d)}function z(c){switch(c){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(c,d){return c==null||c==="http://www.w3.org/1999/xhtml"?z(d):c==="http://www.w3.org/2000/svg"&&d==="foreignObject"?"http://www.w3.org/1999/xhtml":c}var $e,Ae=(function(c){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(d,m,v,S){MSApp.execUnsafeLocalFunction(function(){return c(d,m,v,S)})}:c})(function(c,d){if(c.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in c)c.innerHTML=d;else{for($e=$e||document.createElement("div"),$e.innerHTML="<svg>"+d.valueOf().toString()+"</svg>",d=$e.firstChild;c.firstChild;)c.removeChild(c.firstChild);for(;d.firstChild;)c.appendChild(d.firstChild)}});function Ze(c,d){if(d){var m=c.firstChild;if(m&&m===c.lastChild&&m.nodeType===3){m.nodeValue=d;return}}c.textContent=d}var ht={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},vt=["Webkit","ms","Moz","O"];Object.keys(ht).forEach(function(c){vt.forEach(function(d){d=d+c.charAt(0).toUpperCase()+c.substring(1),ht[d]=ht[c]})});function wt(c,d,m){return d==null||typeof d=="boolean"||d===""?"":m||typeof d!="number"||d===0||ht.hasOwnProperty(c)&&ht[c]?(""+d).trim():d+"px"}function Rt(c,d){c=c.style;for(var m in d)if(d.hasOwnProperty(m)){var v=m.indexOf("--")===0,S=wt(m,d[m],v);m==="float"&&(m="cssFloat"),v?c.setProperty(m,S):c[m]=S}}var en=ce({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Fr(c,d){if(d){if(en[c]&&(d.children!=null||d.dangerouslySetInnerHTML!=null))throw Error(t(137,c));if(d.dangerouslySetInnerHTML!=null){if(d.children!=null)throw Error(t(60));if(typeof d.dangerouslySetInnerHTML!="object"||!("__html"in d.dangerouslySetInnerHTML))throw Error(t(61))}if(d.style!=null&&typeof d.style!="object")throw Error(t(62))}}function Rs(c,d){if(c.indexOf("-")===-1)return typeof d.is=="string";switch(c){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var $i=null;function Wi(c){return c=c.target||c.srcElement||window,c.correspondingUseElement&&(c=c.correspondingUseElement),c.nodeType===3?c.parentNode:c}var Ar=null,ci=null,Tn=null;function Cs(c){if(c=mg(c)){if(typeof Ar!="function")throw Error(t(280));var d=c.stateNode;d&&(d=q1(d),Ar(c.stateNode,c.type,d))}}function Ps(c){ci?Tn?Tn.push(c):Tn=[c]:ci=c}function nr(){if(ci){var c=ci,d=Tn;if(Tn=ci=null,Cs(c),d)for(c=0;c<d.length;c++)Cs(d[c])}}function rs(c,d){return c(d)}function jr(){}var rr=!1;function Vr(c,d,m){if(rr)return c(d,m);rr=!0;try{return rs(c,d,m)}finally{rr=!1,(ci!==null||Tn!==null)&&(jr(),nr())}}function Gr(c,d){var m=c.stateNode;if(m===null)return null;var v=q1(m);if(v===null)return null;m=v[d];e:switch(d){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(v=!v.disabled)||(c=c.type,v=!(c==="button"||c==="input"||c==="select"||c==="textarea")),c=!v;break e;default:c=!1}if(c)return null;if(m&&typeof m!="function")throw Error(t(231,d,typeof m));return m}var br=!1;if(o)try{var on={};Object.defineProperty(on,"passive",{get:function(){br=!0}}),window.addEventListener("test",on,on),window.removeEventListener("test",on,on)}catch{br=!1}function hr(c,d,m,v,S,A,G,J,ae){var Ee=Array.prototype.slice.call(arguments,3);try{d.apply(m,Ee)}catch(ze){this.onError(ze)}}var xr=!1,is=null,U=!1,q=null,K={onError:function(c){xr=!0,is=c}};function Y(c,d,m,v,S,A,G,J,ae){xr=!1,is=null,hr.apply(K,arguments)}function Z(c,d,m,v,S,A,G,J,ae){if(Y.apply(this,arguments),xr){if(xr){var Ee=is;xr=!1,is=null}else throw Error(t(198));U||(U=!0,q=Ee)}}function Q(c){var d=c,m=c;if(c.alternate)for(;d.return;)d=d.return;else{c=d;do d=c,(d.flags&4098)!==0&&(m=d.return),c=d.return;while(c)}return d.tag===3?m:null}function ye(c){if(c.tag===13){var d=c.memoizedState;if(d===null&&(c=c.alternate,c!==null&&(d=c.memoizedState)),d!==null)return d.dehydrated}return null}function Pe(c){if(Q(c)!==c)throw Error(t(188))}function pe(c){var d=c.alternate;if(!d){if(d=Q(c),d===null)throw Error(t(188));return d!==c?null:c}for(var m=c,v=d;;){var S=m.return;if(S===null)break;var A=S.alternate;if(A===null){if(v=S.return,v!==null){m=v;continue}break}if(S.child===A.child){for(A=S.child;A;){if(A===m)return Pe(S),c;if(A===v)return Pe(S),d;A=A.sibling}throw Error(t(188))}if(m.return!==v.return)m=S,v=A;else{for(var G=!1,J=S.child;J;){if(J===m){G=!0,m=S,v=A;break}if(J===v){G=!0,v=S,m=A;break}J=J.sibling}if(!G){for(J=A.child;J;){if(J===m){G=!0,m=A,v=S;break}if(J===v){G=!0,v=A,m=S;break}J=J.sibling}if(!G)throw Error(t(189))}}if(m.alternate!==v)throw Error(t(190))}if(m.tag!==3)throw Error(t(188));return m.stateNode.current===m?c:d}function xe(c){return c=pe(c),c!==null?ve(c):null}function ve(c){if(c.tag===5||c.tag===6)return c;for(c=c.child;c!==null;){var d=ve(c);if(d!==null)return d;c=c.sibling}return null}var We=e.unstable_scheduleCallback,et=e.unstable_cancelCallback,ut=e.unstable_shouldYield,He=e.unstable_requestPaint,Ke=e.unstable_now,jt=e.unstable_getCurrentPriorityLevel,In=e.unstable_ImmediatePriority,Pn=e.unstable_UserBlockingPriority,Qn=e.unstable_NormalPriority,Ra=e.unstable_LowPriority,na=e.unstable_IdlePriority,ks=null,vr=null;function ql(c){if(vr&&typeof vr.onCommitFiberRoot=="function")try{vr.onCommitFiberRoot(ks,c,void 0,(c.current.flags&128)===128)}catch{}}var ir=Math.clz32?Math.clz32:Ru,oo=Math.log,ra=Math.LN2;function Ru(c){return c>>>=0,c===0?32:31-(oo(c)/ra|0)|0}var lo=64,Zl=4194304;function xn(c){switch(c&-c){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return c&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return c}}function el(c,d){var m=c.pendingLanes;if(m===0)return 0;var v=0,S=c.suspendedLanes,A=c.pingedLanes,G=m&268435455;if(G!==0){var J=G&~S;J!==0?v=xn(J):(A&=G,A!==0&&(v=xn(A)))}else G=m&~S,G!==0?v=xn(G):A!==0&&(v=xn(A));if(v===0)return 0;if(d!==0&&d!==v&&(d&S)===0&&(S=v&-v,A=d&-d,S>=A||S===16&&(A&4194240)!==0))return d;if((v&4)!==0&&(v|=m&16),d=c.entangledLanes,d!==0)for(c=c.entanglements,d&=v;0<d;)m=31-ir(d),S=1<<m,v|=c[m],d&=~S;return v}function Cu(c,d){switch(c){case 1:case 2:case 4:return d+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Pu(c,d){for(var m=c.suspendedLanes,v=c.pingedLanes,S=c.expirationTimes,A=c.pendingLanes;0<A;){var G=31-ir(A),J=1<<G,ae=S[G];ae===-1?((J&m)===0||(J&v)!==0)&&(S[G]=Cu(J,d)):ae<=d&&(c.expiredLanes|=J),A&=~J}}function Y0(c){return c=c.pendingLanes&-1073741825,c!==0?c:c&1073741824?1073741824:0}function X0(){var c=lo;return lo<<=1,(lo&4194240)===0&&(lo=64),c}function q0(c){for(var d=[],m=0;31>m;m++)d.push(c);return d}function ku(c,d,m){c.pendingLanes|=d,d!==536870912&&(c.suspendedLanes=0,c.pingedLanes=0),c=c.eventTimes,d=31-ir(d),c[d]=m}function KE(c,d){var m=c.pendingLanes&~d;c.pendingLanes=d,c.suspendedLanes=0,c.pingedLanes=0,c.expiredLanes&=d,c.mutableReadLanes&=d,c.entangledLanes&=d,d=c.entanglements;var v=c.eventTimes;for(c=c.expirationTimes;0<m;){var S=31-ir(m),A=1<<S;d[S]=0,v[S]=-1,c[S]=-1,m&=~A}}function Z0(c,d){var m=c.entangledLanes|=d;for(c=c.entanglements;m;){var v=31-ir(m),S=1<<v;S&d|c[v]&d&&(c[v]|=d),m&=~S}}var ln=0;function co(c){return c&=-c,1<c?4<c?(c&268435455)!==0?16:536870912:4:1}var Q0,_d,J0,eg,tg,uo=!1,xd=[],ho=null,fo=null,ui=null,Mu=new Map,tl=new Map,Ms=[],L1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ql(c,d){switch(c){case"focusin":case"focusout":ho=null;break;case"dragenter":case"dragleave":fo=null;break;case"mouseover":case"mouseout":ui=null;break;case"pointerover":case"pointerout":Mu.delete(d.pointerId);break;case"gotpointercapture":case"lostpointercapture":tl.delete(d.pointerId)}}function Ca(c,d,m,v,S,A){return c===null||c.nativeEvent!==A?(c={blockedOn:d,domEventName:m,eventSystemFlags:v,nativeEvent:A,targetContainers:[S]},d!==null&&(d=mg(d),d!==null&&_d(d)),c):(c.eventSystemFlags|=v,d=c.targetContainers,S!==null&&d.indexOf(S)===-1&&d.push(S),c)}function O1(c,d,m,v,S){switch(d){case"focusin":return ho=Ca(ho,c,d,m,v,S),!0;case"dragenter":return fo=Ca(fo,c,d,m,v,S),!0;case"mouseover":return ui=Ca(ui,c,d,m,v,S),!0;case"pointerover":var A=S.pointerId;return Mu.set(A,Ca(Mu.get(A)||null,c,d,m,v,S)),!0;case"gotpointercapture":return A=S.pointerId,tl.set(A,Ca(tl.get(A)||null,c,d,m,v,S)),!0}return!1}function vd(c){var d=Du(c.target);if(d!==null){var m=Q(d);if(m!==null){if(d=m.tag,d===13){if(d=ye(m),d!==null){c.blockedOn=d,tg(c.priority,function(){J0(m)});return}}else if(d===3&&m.stateNode.current.memoizedState.isDehydrated){c.blockedOn=m.tag===3?m.stateNode.containerInfo:null;return}}}c.blockedOn=null}function Un(c){if(c.blockedOn!==null)return!1;for(var d=c.targetContainers;0<d.length;){var m=Ed(c.domEventName,c.eventSystemFlags,d[0],c.nativeEvent);if(m===null){m=c.nativeEvent;var v=new m.constructor(m.type,m);$i=v,m.target.dispatchEvent(v),$i=null}else return d=mg(m),d!==null&&_d(d),c.blockedOn=m,!1;d.shift()}return!0}function D1(c,d,m){Un(c)&&m.delete(d)}function YE(){uo=!1,ho!==null&&Un(ho)&&(ho=null),fo!==null&&Un(fo)&&(fo=null),ui!==null&&Un(ui)&&(ui=null),Mu.forEach(D1),tl.forEach(D1)}function Jl(c,d){c.blockedOn===d&&(c.blockedOn=null,uo||(uo=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,YE)))}function ec(c){function d(S){return Jl(S,c)}if(0<xd.length){Jl(xd[0],c);for(var m=1;m<xd.length;m++){var v=xd[m];v.blockedOn===c&&(v.blockedOn=null)}}for(ho!==null&&Jl(ho,c),fo!==null&&Jl(fo,c),ui!==null&&Jl(ui,c),Mu.forEach(d),tl.forEach(d),m=0;m<Ms.length;m++)v=Ms[m],v.blockedOn===c&&(v.blockedOn=null);for(;0<Ms.length&&(m=Ms[0],m.blockedOn===null);)vd(m),m.blockedOn===null&&Ms.shift()}var nl=N.ReactCurrentBatchConfig,rl=!0;function go(c,d,m,v){var S=ln,A=nl.transition;nl.transition=null;try{ln=1,ng(c,d,m,v)}finally{ln=S,nl.transition=A}}function F1(c,d,m,v){var S=ln,A=nl.transition;nl.transition=null;try{ln=4,ng(c,d,m,v)}finally{ln=S,nl.transition=A}}function ng(c,d,m,v){if(rl){var S=Ed(c,d,m,v);if(S===null)sw(c,d,v,mo,m),Ql(c,v);else if(O1(S,c,d,m,v))v.stopPropagation();else if(Ql(c,v),d&4&&-1<L1.indexOf(c)){for(;S!==null;){var A=mg(S);if(A!==null&&Q0(A),A=Ed(c,d,m,v),A===null&&sw(c,d,v,mo,m),A===S)break;S=A}S!==null&&v.stopPropagation()}else sw(c,d,v,null,m)}}var mo=null;function Ed(c,d,m,v){if(mo=null,c=Wi(v),c=Du(c),c!==null)if(d=Q(c),d===null)c=null;else if(m=d.tag,m===13){if(c=ye(d),c!==null)return c;c=null}else if(m===3){if(d.stateNode.current.memoizedState.isDehydrated)return d.tag===3?d.stateNode.containerInfo:null;c=null}else d!==c&&(c=null);return mo=c,null}function wd(c){switch(c){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(jt()){case In:return 1;case Pn:return 4;case Qn:case Ra:return 16;case na:return 536870912;default:return 16}default:return 16}}var Ns=null,Sd=null,il=null;function j1(){if(il)return il;var c,d=Sd,m=d.length,v,S="value"in Ns?Ns.value:Ns.textContent,A=S.length;for(c=0;c<m&&d[c]===S[c];c++);var G=m-c;for(v=1;v<=G&&d[m-v]===S[A-v];v++);return il=S.slice(c,1<v?1-v:void 0)}function Nu(c){var d=c.keyCode;return"charCode"in c?(c=c.charCode,c===0&&d===13&&(c=13)):c=d,c===10&&(c=13),32<=c||c===13?c:0}function po(){return!0}function rg(){return!1}function Ai(c){function d(m,v,S,A,G){this._reactName=m,this._targetInst=S,this.type=v,this.nativeEvent=A,this.target=G,this.currentTarget=null;for(var J in c)c.hasOwnProperty(J)&&(m=c[J],this[J]=m?m(A):A[J]);return this.isDefaultPrevented=(A.defaultPrevented!=null?A.defaultPrevented:A.returnValue===!1)?po:rg,this.isPropagationStopped=rg,this}return ce(d.prototype,{preventDefault:function(){this.defaultPrevented=!0;var m=this.nativeEvent;m&&(m.preventDefault?m.preventDefault():typeof m.returnValue!="unknown"&&(m.returnValue=!1),this.isDefaultPrevented=po)},stopPropagation:function(){var m=this.nativeEvent;m&&(m.stopPropagation?m.stopPropagation():typeof m.cancelBubble!="unknown"&&(m.cancelBubble=!0),this.isPropagationStopped=po)},persist:function(){},isPersistent:po}),d}var yo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(c){return c.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Lu=Ai(yo),tc=ce({},yo,{view:0,detail:0}),Td=Ai(tc),Id,Ad,Ls,Ou=ce({},tc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ht,button:0,buttons:0,relatedTarget:function(c){return c.relatedTarget===void 0?c.fromElement===c.srcElement?c.toElement:c.fromElement:c.relatedTarget},movementX:function(c){return"movementX"in c?c.movementX:(c!==Ls&&(Ls&&c.type==="mousemove"?(Id=c.screenX-Ls.screenX,Ad=c.screenY-Ls.screenY):Ad=Id=0,Ls=c),Id)},movementY:function(c){return"movementY"in c?c.movementY:Ad}}),ig=Ai(Ou),V1=ce({},Ou,{dataTransfer:0}),G1=Ai(V1),bd=ce({},tc,{relatedTarget:0}),hi=Ai(bd),B1=ce({},yo,{animationName:0,elapsedTime:0,pseudoElement:0}),U1=Ai(B1),nc=ce({},yo,{clipboardData:function(c){return"clipboardData"in c?c.clipboardData:window.clipboardData}}),_=Ai(nc),b=ce({},yo,{data:0}),L=Ai(b),H={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ge={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},we={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function rt(c){var d=this.nativeEvent;return d.getModifierState?d.getModifierState(c):(c=we[c])?!!d[c]:!1}function Ht(){return rt}var Er=ce({},tc,{key:function(c){if(c.key){var d=H[c.key]||c.key;if(d!=="Unidentified")return d}return c.type==="keypress"?(c=Nu(c),c===13?"Enter":String.fromCharCode(c)):c.type==="keydown"||c.type==="keyup"?ge[c.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ht,charCode:function(c){return c.type==="keypress"?Nu(c):0},keyCode:function(c){return c.type==="keydown"||c.type==="keyup"?c.keyCode:0},which:function(c){return c.type==="keypress"?Nu(c):c.type==="keydown"||c.type==="keyup"?c.keyCode:0}}),kn=Ai(Er),Rr=ce({},Ou,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Os=Ai(Rr),sl=ce({},tc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ht}),_o=Ai(sl),xo=ce({},yo,{propertyName:0,elapsedTime:0,pseudoElement:0}),Rd=Ai(xo),sg=ce({},Ou,{deltaX:function(c){return"deltaX"in c?c.deltaX:"wheelDeltaX"in c?-c.wheelDeltaX:0},deltaY:function(c){return"deltaY"in c?c.deltaY:"wheelDeltaY"in c?-c.wheelDeltaY:"wheelDelta"in c?-c.wheelDelta:0},deltaZ:0,deltaMode:0}),lG=Ai(sg),cG=[9,13,27,32],XE=o&&"CompositionEvent"in window,ag=null;o&&"documentMode"in document&&(ag=document.documentMode);var uG=o&&"TextEvent"in window&&!ag,dC=o&&(!XE||ag&&8<ag&&11>=ag),fC=" ",gC=!1;function mC(c,d){switch(c){case"keyup":return cG.indexOf(d.keyCode)!==-1;case"keydown":return d.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function pC(c){return c=c.detail,typeof c=="object"&&"data"in c?c.data:null}var Cd=!1;function hG(c,d){switch(c){case"compositionend":return pC(d);case"keypress":return d.which!==32?null:(gC=!0,fC);case"textInput":return c=d.data,c===fC&&gC?null:c;default:return null}}function dG(c,d){if(Cd)return c==="compositionend"||!XE&&mC(c,d)?(c=j1(),il=Sd=Ns=null,Cd=!1,c):null;switch(c){case"paste":return null;case"keypress":if(!(d.ctrlKey||d.altKey||d.metaKey)||d.ctrlKey&&d.altKey){if(d.char&&1<d.char.length)return d.char;if(d.which)return String.fromCharCode(d.which)}return null;case"compositionend":return dC&&d.locale!=="ko"?null:d.data;default:return null}}var fG={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function yC(c){var d=c&&c.nodeName&&c.nodeName.toLowerCase();return d==="input"?!!fG[c.type]:d==="textarea"}function _C(c,d,m,v){Ps(v),d=K1(d,"onChange"),0<d.length&&(m=new Lu("onChange","change",null,m,v),c.push({event:m,listeners:d}))}var og=null,lg=null;function gG(c){DC(c,0)}function z1(c){var d=Ld(c);if(gt(d))return c}function mG(c,d){if(c==="change")return d}var xC=!1;if(o){var qE;if(o){var ZE="oninput"in document;if(!ZE){var vC=document.createElement("div");vC.setAttribute("oninput","return;"),ZE=typeof vC.oninput=="function"}qE=ZE}else qE=!1;xC=qE&&(!document.documentMode||9<document.documentMode)}function EC(){og&&(og.detachEvent("onpropertychange",wC),lg=og=null)}function wC(c){if(c.propertyName==="value"&&z1(lg)){var d=[];_C(d,lg,c,Wi(c)),Vr(gG,d)}}function pG(c,d,m){c==="focusin"?(EC(),og=d,lg=m,og.attachEvent("onpropertychange",wC)):c==="focusout"&&EC()}function yG(c){if(c==="selectionchange"||c==="keyup"||c==="keydown")return z1(lg)}function _G(c,d){if(c==="click")return z1(d)}function xG(c,d){if(c==="input"||c==="change")return z1(d)}function vG(c,d){return c===d&&(c!==0||1/c===1/d)||c!==c&&d!==d}var Pa=typeof Object.is=="function"?Object.is:vG;function cg(c,d){if(Pa(c,d))return!0;if(typeof c!="object"||c===null||typeof d!="object"||d===null)return!1;var m=Object.keys(c),v=Object.keys(d);if(m.length!==v.length)return!1;for(v=0;v<m.length;v++){var S=m[v];if(!l.call(d,S)||!Pa(c[S],d[S]))return!1}return!0}function SC(c){for(;c&&c.firstChild;)c=c.firstChild;return c}function TC(c,d){var m=SC(c);c=0;for(var v;m;){if(m.nodeType===3){if(v=c+m.textContent.length,c<=d&&v>=d)return{node:m,offset:d-c};c=v}e:{for(;m;){if(m.nextSibling){m=m.nextSibling;break e}m=m.parentNode}m=void 0}m=SC(m)}}function IC(c,d){return c&&d?c===d?!0:c&&c.nodeType===3?!1:d&&d.nodeType===3?IC(c,d.parentNode):"contains"in c?c.contains(d):c.compareDocumentPosition?!!(c.compareDocumentPosition(d)&16):!1:!1}function AC(){for(var c=window,d=yt();d instanceof c.HTMLIFrameElement;){try{var m=typeof d.contentWindow.location.href=="string"}catch{m=!1}if(m)c=d.contentWindow;else break;d=yt(c.document)}return d}function QE(c){var d=c&&c.nodeName&&c.nodeName.toLowerCase();return d&&(d==="input"&&(c.type==="text"||c.type==="search"||c.type==="tel"||c.type==="url"||c.type==="password")||d==="textarea"||c.contentEditable==="true")}function EG(c){var d=AC(),m=c.focusedElem,v=c.selectionRange;if(d!==m&&m&&m.ownerDocument&&IC(m.ownerDocument.documentElement,m)){if(v!==null&&QE(m)){if(d=v.start,c=v.end,c===void 0&&(c=d),"selectionStart"in m)m.selectionStart=d,m.selectionEnd=Math.min(c,m.value.length);else if(c=(d=m.ownerDocument||document)&&d.defaultView||window,c.getSelection){c=c.getSelection();var S=m.textContent.length,A=Math.min(v.start,S);v=v.end===void 0?A:Math.min(v.end,S),!c.extend&&A>v&&(S=v,v=A,A=S),S=TC(m,A);var G=TC(m,v);S&&G&&(c.rangeCount!==1||c.anchorNode!==S.node||c.anchorOffset!==S.offset||c.focusNode!==G.node||c.focusOffset!==G.offset)&&(d=d.createRange(),d.setStart(S.node,S.offset),c.removeAllRanges(),A>v?(c.addRange(d),c.extend(G.node,G.offset)):(d.setEnd(G.node,G.offset),c.addRange(d)))}}for(d=[],c=m;c=c.parentNode;)c.nodeType===1&&d.push({element:c,left:c.scrollLeft,top:c.scrollTop});for(typeof m.focus=="function"&&m.focus(),m=0;m<d.length;m++)c=d[m],c.element.scrollLeft=c.left,c.element.scrollTop=c.top}}var wG=o&&"documentMode"in document&&11>=document.documentMode,Pd=null,JE=null,ug=null,ew=!1;function bC(c,d,m){var v=m.window===m?m.document:m.nodeType===9?m:m.ownerDocument;ew||Pd==null||Pd!==yt(v)||(v=Pd,"selectionStart"in v&&QE(v)?v={start:v.selectionStart,end:v.selectionEnd}:(v=(v.ownerDocument&&v.ownerDocument.defaultView||window).getSelection(),v={anchorNode:v.anchorNode,anchorOffset:v.anchorOffset,focusNode:v.focusNode,focusOffset:v.focusOffset}),ug&&cg(ug,v)||(ug=v,v=K1(JE,"onSelect"),0<v.length&&(d=new Lu("onSelect","select",null,d,m),c.push({event:d,listeners:v}),d.target=Pd)))}function $1(c,d){var m={};return m[c.toLowerCase()]=d.toLowerCase(),m["Webkit"+c]="webkit"+d,m["Moz"+c]="moz"+d,m}var kd={animationend:$1("Animation","AnimationEnd"),animationiteration:$1("Animation","AnimationIteration"),animationstart:$1("Animation","AnimationStart"),transitionend:$1("Transition","TransitionEnd")},tw={},RC={};o&&(RC=document.createElement("div").style,"AnimationEvent"in window||(delete kd.animationend.animation,delete kd.animationiteration.animation,delete kd.animationstart.animation),"TransitionEvent"in window||delete kd.transitionend.transition);function W1(c){if(tw[c])return tw[c];if(!kd[c])return c;var d=kd[c],m;for(m in d)if(d.hasOwnProperty(m)&&m in RC)return tw[c]=d[m];return c}var CC=W1("animationend"),PC=W1("animationiteration"),kC=W1("animationstart"),MC=W1("transitionend"),NC=new Map,LC="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function rc(c,d){NC.set(c,d),s(d,[c])}for(var nw=0;nw<LC.length;nw++){var rw=LC[nw],SG=rw.toLowerCase(),TG=rw[0].toUpperCase()+rw.slice(1);rc(SG,"on"+TG)}rc(CC,"onAnimationEnd"),rc(PC,"onAnimationIteration"),rc(kC,"onAnimationStart"),rc("dblclick","onDoubleClick"),rc("focusin","onFocus"),rc("focusout","onBlur"),rc(MC,"onTransitionEnd"),a("onMouseEnter",["mouseout","mouseover"]),a("onMouseLeave",["mouseout","mouseover"]),a("onPointerEnter",["pointerout","pointerover"]),a("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var hg="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),IG=new Set("cancel close invalid load scroll toggle".split(" ").concat(hg));function OC(c,d,m){var v=c.type||"unknown-event";c.currentTarget=m,Z(v,d,void 0,c),c.currentTarget=null}function DC(c,d){d=(d&4)!==0;for(var m=0;m<c.length;m++){var v=c[m],S=v.event;v=v.listeners;e:{var A=void 0;if(d)for(var G=v.length-1;0<=G;G--){var J=v[G],ae=J.instance,Ee=J.currentTarget;if(J=J.listener,ae!==A&&S.isPropagationStopped())break e;OC(S,J,Ee),A=ae}else for(G=0;G<v.length;G++){if(J=v[G],ae=J.instance,Ee=J.currentTarget,J=J.listener,ae!==A&&S.isPropagationStopped())break e;OC(S,J,Ee),A=ae}}}if(U)throw c=q,U=!1,q=null,c}function Hn(c,d){var m=d[hw];m===void 0&&(m=d[hw]=new Set);var v=c+"__bubble";m.has(v)||(FC(d,c,2,!1),m.add(v))}function iw(c,d,m){var v=0;d&&(v|=4),FC(m,c,v,d)}var H1="_reactListening"+Math.random().toString(36).slice(2);function dg(c){if(!c[H1]){c[H1]=!0,r.forEach(function(m){m!=="selectionchange"&&(IG.has(m)||iw(m,!1,c),iw(m,!0,c))});var d=c.nodeType===9?c:c.ownerDocument;d===null||d[H1]||(d[H1]=!0,iw("selectionchange",!1,d))}}function FC(c,d,m,v){switch(wd(d)){case 1:var S=go;break;case 4:S=F1;break;default:S=ng}m=S.bind(null,d,m,c),S=void 0,!br||d!=="touchstart"&&d!=="touchmove"&&d!=="wheel"||(S=!0),v?S!==void 0?c.addEventListener(d,m,{capture:!0,passive:S}):c.addEventListener(d,m,!0):S!==void 0?c.addEventListener(d,m,{passive:S}):c.addEventListener(d,m,!1)}function sw(c,d,m,v,S){var A=v;if((d&1)===0&&(d&2)===0&&v!==null)e:for(;;){if(v===null)return;var G=v.tag;if(G===3||G===4){var J=v.stateNode.containerInfo;if(J===S||J.nodeType===8&&J.parentNode===S)break;if(G===4)for(G=v.return;G!==null;){var ae=G.tag;if((ae===3||ae===4)&&(ae=G.stateNode.containerInfo,ae===S||ae.nodeType===8&&ae.parentNode===S))return;G=G.return}for(;J!==null;){if(G=Du(J),G===null)return;if(ae=G.tag,ae===5||ae===6){v=A=G;continue e}J=J.parentNode}}v=v.return}Vr(function(){var Ee=A,ze=Wi(m),Ye=[];e:{var Be=NC.get(c);if(Be!==void 0){var ft=Lu,_t=c;switch(c){case"keypress":if(Nu(m)===0)break e;case"keydown":case"keyup":ft=kn;break;case"focusin":_t="focus",ft=hi;break;case"focusout":_t="blur",ft=hi;break;case"beforeblur":case"afterblur":ft=hi;break;case"click":if(m.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ft=ig;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ft=G1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ft=_o;break;case CC:case PC:case kC:ft=U1;break;case MC:ft=Rd;break;case"scroll":ft=Td;break;case"wheel":ft=lG;break;case"copy":case"cut":case"paste":ft=_;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ft=Os}var St=(d&4)!==0,wr=!St&&c==="scroll",de=St?Be!==null?Be+"Capture":null:Be;St=[];for(var oe=Ee,_e;oe!==null;){_e=oe;var Je=_e.stateNode;if(_e.tag===5&&Je!==null&&(_e=Je,de!==null&&(Je=Gr(oe,de),Je!=null&&St.push(fg(oe,Je,_e)))),wr)break;oe=oe.return}0<St.length&&(Be=new ft(Be,_t,null,m,ze),Ye.push({event:Be,listeners:St}))}}if((d&7)===0){e:{if(Be=c==="mouseover"||c==="pointerover",ft=c==="mouseout"||c==="pointerout",Be&&m!==$i&&(_t=m.relatedTarget||m.fromElement)&&(Du(_t)||_t[al]))break e;if((ft||Be)&&(Be=ze.window===ze?ze:(Be=ze.ownerDocument)?Be.defaultView||Be.parentWindow:window,ft?(_t=m.relatedTarget||m.toElement,ft=Ee,_t=_t?Du(_t):null,_t!==null&&(wr=Q(_t),_t!==wr||_t.tag!==5&&_t.tag!==6)&&(_t=null)):(ft=null,_t=Ee),ft!==_t)){if(St=ig,Je="onMouseLeave",de="onMouseEnter",oe="mouse",(c==="pointerout"||c==="pointerover")&&(St=Os,Je="onPointerLeave",de="onPointerEnter",oe="pointer"),wr=ft==null?Be:Ld(ft),_e=_t==null?Be:Ld(_t),Be=new St(Je,oe+"leave",ft,m,ze),Be.target=wr,Be.relatedTarget=_e,Je=null,Du(ze)===Ee&&(St=new St(de,oe+"enter",_t,m,ze),St.target=_e,St.relatedTarget=wr,Je=St),wr=Je,ft&&_t)t:{for(St=ft,de=_t,oe=0,_e=St;_e;_e=Md(_e))oe++;for(_e=0,Je=de;Je;Je=Md(Je))_e++;for(;0<oe-_e;)St=Md(St),oe--;for(;0<_e-oe;)de=Md(de),_e--;for(;oe--;){if(St===de||de!==null&&St===de.alternate)break t;St=Md(St),de=Md(de)}St=null}else St=null;ft!==null&&jC(Ye,Be,ft,St,!1),_t!==null&&wr!==null&&jC(Ye,wr,_t,St,!0)}}e:{if(Be=Ee?Ld(Ee):window,ft=Be.nodeName&&Be.nodeName.toLowerCase(),ft==="select"||ft==="input"&&Be.type==="file")var At=mG;else if(yC(Be))if(xC)At=xG;else{At=yG;var Mt=pG}else(ft=Be.nodeName)&&ft.toLowerCase()==="input"&&(Be.type==="checkbox"||Be.type==="radio")&&(At=_G);if(At&&(At=At(c,Ee))){_C(Ye,At,m,ze);break e}Mt&&Mt(c,Be,Ee),c==="focusout"&&(Mt=Be._wrapperState)&&Mt.controlled&&Be.type==="number"&&Ie(Be,"number",Be.value)}switch(Mt=Ee?Ld(Ee):window,c){case"focusin":(yC(Mt)||Mt.contentEditable==="true")&&(Pd=Mt,JE=Ee,ug=null);break;case"focusout":ug=JE=Pd=null;break;case"mousedown":ew=!0;break;case"contextmenu":case"mouseup":case"dragend":ew=!1,bC(Ye,m,ze);break;case"selectionchange":if(wG)break;case"keydown":case"keyup":bC(Ye,m,ze)}var Nt;if(XE)e:{switch(c){case"compositionstart":var Vt="onCompositionStart";break e;case"compositionend":Vt="onCompositionEnd";break e;case"compositionupdate":Vt="onCompositionUpdate";break e}Vt=void 0}else Cd?mC(c,m)&&(Vt="onCompositionEnd"):c==="keydown"&&m.keyCode===229&&(Vt="onCompositionStart");Vt&&(dC&&m.locale!=="ko"&&(Cd||Vt!=="onCompositionStart"?Vt==="onCompositionEnd"&&Cd&&(Nt=j1()):(Ns=ze,Sd="value"in Ns?Ns.value:Ns.textContent,Cd=!0)),Mt=K1(Ee,Vt),0<Mt.length&&(Vt=new L(Vt,c,null,m,ze),Ye.push({event:Vt,listeners:Mt}),Nt?Vt.data=Nt:(Nt=pC(m),Nt!==null&&(Vt.data=Nt)))),(Nt=uG?hG(c,m):dG(c,m))&&(Ee=K1(Ee,"onBeforeInput"),0<Ee.length&&(ze=new L("onBeforeInput","beforeinput",null,m,ze),Ye.push({event:ze,listeners:Ee}),ze.data=Nt))}DC(Ye,d)})}function fg(c,d,m){return{instance:c,listener:d,currentTarget:m}}function K1(c,d){for(var m=d+"Capture",v=[];c!==null;){var S=c,A=S.stateNode;S.tag===5&&A!==null&&(S=A,A=Gr(c,m),A!=null&&v.unshift(fg(c,A,S)),A=Gr(c,d),A!=null&&v.push(fg(c,A,S))),c=c.return}return v}function Md(c){if(c===null)return null;do c=c.return;while(c&&c.tag!==5);return c||null}function jC(c,d,m,v,S){for(var A=d._reactName,G=[];m!==null&&m!==v;){var J=m,ae=J.alternate,Ee=J.stateNode;if(ae!==null&&ae===v)break;J.tag===5&&Ee!==null&&(J=Ee,S?(ae=Gr(m,A),ae!=null&&G.unshift(fg(m,ae,J))):S||(ae=Gr(m,A),ae!=null&&G.push(fg(m,ae,J)))),m=m.return}G.length!==0&&c.push({event:d,listeners:G})}var AG=/\r\n?/g,bG=/\u0000|\uFFFD/g;function VC(c){return(typeof c=="string"?c:""+c).replace(AG,`
`).replace(bG,"")}function Y1(c,d,m){if(d=VC(d),VC(c)!==d&&m)throw Error(t(425))}function X1(){}var aw=null,ow=null;function lw(c,d){return c==="textarea"||c==="noscript"||typeof d.children=="string"||typeof d.children=="number"||typeof d.dangerouslySetInnerHTML=="object"&&d.dangerouslySetInnerHTML!==null&&d.dangerouslySetInnerHTML.__html!=null}var cw=typeof setTimeout=="function"?setTimeout:void 0,RG=typeof clearTimeout=="function"?clearTimeout:void 0,GC=typeof Promise=="function"?Promise:void 0,CG=typeof queueMicrotask=="function"?queueMicrotask:typeof GC<"u"?function(c){return GC.resolve(null).then(c).catch(PG)}:cw;function PG(c){setTimeout(function(){throw c})}function uw(c,d){var m=d,v=0;do{var S=m.nextSibling;if(c.removeChild(m),S&&S.nodeType===8)if(m=S.data,m==="/$"){if(v===0){c.removeChild(S),ec(d);return}v--}else m!=="$"&&m!=="$?"&&m!=="$!"||v++;m=S}while(m);ec(d)}function ic(c){for(;c!=null;c=c.nextSibling){var d=c.nodeType;if(d===1||d===3)break;if(d===8){if(d=c.data,d==="$"||d==="$!"||d==="$?")break;if(d==="/$")return null}}return c}function BC(c){c=c.previousSibling;for(var d=0;c;){if(c.nodeType===8){var m=c.data;if(m==="$"||m==="$!"||m==="$?"){if(d===0)return c;d--}else m==="/$"&&d++}c=c.previousSibling}return null}var Nd=Math.random().toString(36).slice(2),vo="__reactFiber$"+Nd,gg="__reactProps$"+Nd,al="__reactContainer$"+Nd,hw="__reactEvents$"+Nd,kG="__reactListeners$"+Nd,MG="__reactHandles$"+Nd;function Du(c){var d=c[vo];if(d)return d;for(var m=c.parentNode;m;){if(d=m[al]||m[vo]){if(m=d.alternate,d.child!==null||m!==null&&m.child!==null)for(c=BC(c);c!==null;){if(m=c[vo])return m;c=BC(c)}return d}c=m,m=c.parentNode}return null}function mg(c){return c=c[vo]||c[al],!c||c.tag!==5&&c.tag!==6&&c.tag!==13&&c.tag!==3?null:c}function Ld(c){if(c.tag===5||c.tag===6)return c.stateNode;throw Error(t(33))}function q1(c){return c[gg]||null}var dw=[],Od=-1;function sc(c){return{current:c}}function Kn(c){0>Od||(c.current=dw[Od],dw[Od]=null,Od--)}function $n(c,d){Od++,dw[Od]=c.current,c.current=d}var ac={},bi=sc(ac),ss=sc(!1),Fu=ac;function Dd(c,d){var m=c.type.contextTypes;if(!m)return ac;var v=c.stateNode;if(v&&v.__reactInternalMemoizedUnmaskedChildContext===d)return v.__reactInternalMemoizedMaskedChildContext;var S={},A;for(A in m)S[A]=d[A];return v&&(c=c.stateNode,c.__reactInternalMemoizedUnmaskedChildContext=d,c.__reactInternalMemoizedMaskedChildContext=S),S}function as(c){return c=c.childContextTypes,c!=null}function Z1(){Kn(ss),Kn(bi)}function UC(c,d,m){if(bi.current!==ac)throw Error(t(168));$n(bi,d),$n(ss,m)}function zC(c,d,m){var v=c.stateNode;if(d=d.childContextTypes,typeof v.getChildContext!="function")return m;v=v.getChildContext();for(var S in v)if(!(S in d))throw Error(t(108,Oe(c)||"Unknown",S));return ce({},m,v)}function Q1(c){return c=(c=c.stateNode)&&c.__reactInternalMemoizedMergedChildContext||ac,Fu=bi.current,$n(bi,c),$n(ss,ss.current),!0}function $C(c,d,m){var v=c.stateNode;if(!v)throw Error(t(169));m?(c=zC(c,d,Fu),v.__reactInternalMemoizedMergedChildContext=c,Kn(ss),Kn(bi),$n(bi,c)):Kn(ss),$n(ss,m)}var ol=null,J1=!1,fw=!1;function WC(c){ol===null?ol=[c]:ol.push(c)}function NG(c){J1=!0,WC(c)}function oc(){if(!fw&&ol!==null){fw=!0;var c=0,d=ln;try{var m=ol;for(ln=1;c<m.length;c++){var v=m[c];do v=v(!0);while(v!==null)}ol=null,J1=!1}catch(S){throw ol!==null&&(ol=ol.slice(c+1)),We(In,oc),S}finally{ln=d,fw=!1}}return null}var Fd=[],jd=0,ey=null,ty=0,ia=[],sa=0,ju=null,ll=1,cl="";function Vu(c,d){Fd[jd++]=ty,Fd[jd++]=ey,ey=c,ty=d}function HC(c,d,m){ia[sa++]=ll,ia[sa++]=cl,ia[sa++]=ju,ju=c;var v=ll;c=cl;var S=32-ir(v)-1;v&=~(1<<S),m+=1;var A=32-ir(d)+S;if(30<A){var G=S-S%5;A=(v&(1<<G)-1).toString(32),v>>=G,S-=G,ll=1<<32-ir(d)+S|m<<S|v,cl=A+c}else ll=1<<A|m<<S|v,cl=c}function gw(c){c.return!==null&&(Vu(c,1),HC(c,1,0))}function mw(c){for(;c===ey;)ey=Fd[--jd],Fd[jd]=null,ty=Fd[--jd],Fd[jd]=null;for(;c===ju;)ju=ia[--sa],ia[sa]=null,cl=ia[--sa],ia[sa]=null,ll=ia[--sa],ia[sa]=null}var Ds=null,Fs=null,Jn=!1,ka=null;function KC(c,d){var m=ca(5,null,null,0);m.elementType="DELETED",m.stateNode=d,m.return=c,d=c.deletions,d===null?(c.deletions=[m],c.flags|=16):d.push(m)}function YC(c,d){switch(c.tag){case 5:var m=c.type;return d=d.nodeType!==1||m.toLowerCase()!==d.nodeName.toLowerCase()?null:d,d!==null?(c.stateNode=d,Ds=c,Fs=ic(d.firstChild),!0):!1;case 6:return d=c.pendingProps===""||d.nodeType!==3?null:d,d!==null?(c.stateNode=d,Ds=c,Fs=null,!0):!1;case 13:return d=d.nodeType!==8?null:d,d!==null?(m=ju!==null?{id:ll,overflow:cl}:null,c.memoizedState={dehydrated:d,treeContext:m,retryLane:1073741824},m=ca(18,null,null,0),m.stateNode=d,m.return=c,c.child=m,Ds=c,Fs=null,!0):!1;default:return!1}}function pw(c){return(c.mode&1)!==0&&(c.flags&128)===0}function yw(c){if(Jn){var d=Fs;if(d){var m=d;if(!YC(c,d)){if(pw(c))throw Error(t(418));d=ic(m.nextSibling);var v=Ds;d&&YC(c,d)?KC(v,m):(c.flags=c.flags&-4097|2,Jn=!1,Ds=c)}}else{if(pw(c))throw Error(t(418));c.flags=c.flags&-4097|2,Jn=!1,Ds=c}}}function XC(c){for(c=c.return;c!==null&&c.tag!==5&&c.tag!==3&&c.tag!==13;)c=c.return;Ds=c}function ny(c){if(c!==Ds)return!1;if(!Jn)return XC(c),Jn=!0,!1;var d;if((d=c.tag!==3)&&!(d=c.tag!==5)&&(d=c.type,d=d!=="head"&&d!=="body"&&!lw(c.type,c.memoizedProps)),d&&(d=Fs)){if(pw(c))throw qC(),Error(t(418));for(;d;)KC(c,d),d=ic(d.nextSibling)}if(XC(c),c.tag===13){if(c=c.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(t(317));e:{for(c=c.nextSibling,d=0;c;){if(c.nodeType===8){var m=c.data;if(m==="/$"){if(d===0){Fs=ic(c.nextSibling);break e}d--}else m!=="$"&&m!=="$!"&&m!=="$?"||d++}c=c.nextSibling}Fs=null}}else Fs=Ds?ic(c.stateNode.nextSibling):null;return!0}function qC(){for(var c=Fs;c;)c=ic(c.nextSibling)}function Vd(){Fs=Ds=null,Jn=!1}function _w(c){ka===null?ka=[c]:ka.push(c)}var LG=N.ReactCurrentBatchConfig;function pg(c,d,m){if(c=m.ref,c!==null&&typeof c!="function"&&typeof c!="object"){if(m._owner){if(m=m._owner,m){if(m.tag!==1)throw Error(t(309));var v=m.stateNode}if(!v)throw Error(t(147,c));var S=v,A=""+c;return d!==null&&d.ref!==null&&typeof d.ref=="function"&&d.ref._stringRef===A?d.ref:(d=function(G){var J=S.refs;G===null?delete J[A]:J[A]=G},d._stringRef=A,d)}if(typeof c!="string")throw Error(t(284));if(!m._owner)throw Error(t(290,c))}return c}function ry(c,d){throw c=Object.prototype.toString.call(d),Error(t(31,c==="[object Object]"?"object with keys {"+Object.keys(d).join(", ")+"}":c))}function ZC(c){var d=c._init;return d(c._payload)}function QC(c){function d(de,oe){if(c){var _e=de.deletions;_e===null?(de.deletions=[oe],de.flags|=16):_e.push(oe)}}function m(de,oe){if(!c)return null;for(;oe!==null;)d(de,oe),oe=oe.sibling;return null}function v(de,oe){for(de=new Map;oe!==null;)oe.key!==null?de.set(oe.key,oe):de.set(oe.index,oe),oe=oe.sibling;return de}function S(de,oe){return de=mc(de,oe),de.index=0,de.sibling=null,de}function A(de,oe,_e){return de.index=_e,c?(_e=de.alternate,_e!==null?(_e=_e.index,_e<oe?(de.flags|=2,oe):_e):(de.flags|=2,oe)):(de.flags|=1048576,oe)}function G(de){return c&&de.alternate===null&&(de.flags|=2),de}function J(de,oe,_e,Je){return oe===null||oe.tag!==6?(oe=c2(_e,de.mode,Je),oe.return=de,oe):(oe=S(oe,_e),oe.return=de,oe)}function ae(de,oe,_e,Je){var At=_e.type;return At===k?ze(de,oe,_e.props.children,Je,_e.key):oe!==null&&(oe.elementType===At||typeof At=="object"&&At!==null&&At.$$typeof===Le&&ZC(At)===oe.type)?(Je=S(oe,_e.props),Je.ref=pg(de,oe,_e),Je.return=de,Je):(Je=by(_e.type,_e.key,_e.props,null,de.mode,Je),Je.ref=pg(de,oe,_e),Je.return=de,Je)}function Ee(de,oe,_e,Je){return oe===null||oe.tag!==4||oe.stateNode.containerInfo!==_e.containerInfo||oe.stateNode.implementation!==_e.implementation?(oe=u2(_e,de.mode,Je),oe.return=de,oe):(oe=S(oe,_e.children||[]),oe.return=de,oe)}function ze(de,oe,_e,Je,At){return oe===null||oe.tag!==7?(oe=Ku(_e,de.mode,Je,At),oe.return=de,oe):(oe=S(oe,_e),oe.return=de,oe)}function Ye(de,oe,_e){if(typeof oe=="string"&&oe!==""||typeof oe=="number")return oe=c2(""+oe,de.mode,_e),oe.return=de,oe;if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case D:return _e=by(oe.type,oe.key,oe.props,null,de.mode,_e),_e.ref=pg(de,null,oe),_e.return=de,_e;case B:return oe=u2(oe,de.mode,_e),oe.return=de,oe;case Le:var Je=oe._init;return Ye(de,Je(oe._payload),_e)}if(me(oe)||be(oe))return oe=Ku(oe,de.mode,_e,null),oe.return=de,oe;ry(de,oe)}return null}function Be(de,oe,_e,Je){var At=oe!==null?oe.key:null;if(typeof _e=="string"&&_e!==""||typeof _e=="number")return At!==null?null:J(de,oe,""+_e,Je);if(typeof _e=="object"&&_e!==null){switch(_e.$$typeof){case D:return _e.key===At?ae(de,oe,_e,Je):null;case B:return _e.key===At?Ee(de,oe,_e,Je):null;case Le:return At=_e._init,Be(de,oe,At(_e._payload),Je)}if(me(_e)||be(_e))return At!==null?null:ze(de,oe,_e,Je,null);ry(de,_e)}return null}function ft(de,oe,_e,Je,At){if(typeof Je=="string"&&Je!==""||typeof Je=="number")return de=de.get(_e)||null,J(oe,de,""+Je,At);if(typeof Je=="object"&&Je!==null){switch(Je.$$typeof){case D:return de=de.get(Je.key===null?_e:Je.key)||null,ae(oe,de,Je,At);case B:return de=de.get(Je.key===null?_e:Je.key)||null,Ee(oe,de,Je,At);case Le:var Mt=Je._init;return ft(de,oe,_e,Mt(Je._payload),At)}if(me(Je)||be(Je))return de=de.get(_e)||null,ze(oe,de,Je,At,null);ry(oe,Je)}return null}function _t(de,oe,_e,Je){for(var At=null,Mt=null,Nt=oe,Vt=oe=0,Qr=null;Nt!==null&&Vt<_e.length;Vt++){Nt.index>Vt?(Qr=Nt,Nt=null):Qr=Nt.sibling;var mn=Be(de,Nt,_e[Vt],Je);if(mn===null){Nt===null&&(Nt=Qr);break}c&&Nt&&mn.alternate===null&&d(de,Nt),oe=A(mn,oe,Vt),Mt===null?At=mn:Mt.sibling=mn,Mt=mn,Nt=Qr}if(Vt===_e.length)return m(de,Nt),Jn&&Vu(de,Vt),At;if(Nt===null){for(;Vt<_e.length;Vt++)Nt=Ye(de,_e[Vt],Je),Nt!==null&&(oe=A(Nt,oe,Vt),Mt===null?At=Nt:Mt.sibling=Nt,Mt=Nt);return Jn&&Vu(de,Vt),At}for(Nt=v(de,Nt);Vt<_e.length;Vt++)Qr=ft(Nt,de,Vt,_e[Vt],Je),Qr!==null&&(c&&Qr.alternate!==null&&Nt.delete(Qr.key===null?Vt:Qr.key),oe=A(Qr,oe,Vt),Mt===null?At=Qr:Mt.sibling=Qr,Mt=Qr);return c&&Nt.forEach(function(pc){return d(de,pc)}),Jn&&Vu(de,Vt),At}function St(de,oe,_e,Je){var At=be(_e);if(typeof At!="function")throw Error(t(150));if(_e=At.call(_e),_e==null)throw Error(t(151));for(var Mt=At=null,Nt=oe,Vt=oe=0,Qr=null,mn=_e.next();Nt!==null&&!mn.done;Vt++,mn=_e.next()){Nt.index>Vt?(Qr=Nt,Nt=null):Qr=Nt.sibling;var pc=Be(de,Nt,mn.value,Je);if(pc===null){Nt===null&&(Nt=Qr);break}c&&Nt&&pc.alternate===null&&d(de,Nt),oe=A(pc,oe,Vt),Mt===null?At=pc:Mt.sibling=pc,Mt=pc,Nt=Qr}if(mn.done)return m(de,Nt),Jn&&Vu(de,Vt),At;if(Nt===null){for(;!mn.done;Vt++,mn=_e.next())mn=Ye(de,mn.value,Je),mn!==null&&(oe=A(mn,oe,Vt),Mt===null?At=mn:Mt.sibling=mn,Mt=mn);return Jn&&Vu(de,Vt),At}for(Nt=v(de,Nt);!mn.done;Vt++,mn=_e.next())mn=ft(Nt,de,Vt,mn.value,Je),mn!==null&&(c&&mn.alternate!==null&&Nt.delete(mn.key===null?Vt:mn.key),oe=A(mn,oe,Vt),Mt===null?At=mn:Mt.sibling=mn,Mt=mn);return c&&Nt.forEach(function(fB){return d(de,fB)}),Jn&&Vu(de,Vt),At}function wr(de,oe,_e,Je){if(typeof _e=="object"&&_e!==null&&_e.type===k&&_e.key===null&&(_e=_e.props.children),typeof _e=="object"&&_e!==null){switch(_e.$$typeof){case D:e:{for(var At=_e.key,Mt=oe;Mt!==null;){if(Mt.key===At){if(At=_e.type,At===k){if(Mt.tag===7){m(de,Mt.sibling),oe=S(Mt,_e.props.children),oe.return=de,de=oe;break e}}else if(Mt.elementType===At||typeof At=="object"&&At!==null&&At.$$typeof===Le&&ZC(At)===Mt.type){m(de,Mt.sibling),oe=S(Mt,_e.props),oe.ref=pg(de,Mt,_e),oe.return=de,de=oe;break e}m(de,Mt);break}else d(de,Mt);Mt=Mt.sibling}_e.type===k?(oe=Ku(_e.props.children,de.mode,Je,_e.key),oe.return=de,de=oe):(Je=by(_e.type,_e.key,_e.props,null,de.mode,Je),Je.ref=pg(de,oe,_e),Je.return=de,de=Je)}return G(de);case B:e:{for(Mt=_e.key;oe!==null;){if(oe.key===Mt)if(oe.tag===4&&oe.stateNode.containerInfo===_e.containerInfo&&oe.stateNode.implementation===_e.implementation){m(de,oe.sibling),oe=S(oe,_e.children||[]),oe.return=de,de=oe;break e}else{m(de,oe);break}else d(de,oe);oe=oe.sibling}oe=u2(_e,de.mode,Je),oe.return=de,de=oe}return G(de);case Le:return Mt=_e._init,wr(de,oe,Mt(_e._payload),Je)}if(me(_e))return _t(de,oe,_e,Je);if(be(_e))return St(de,oe,_e,Je);ry(de,_e)}return typeof _e=="string"&&_e!==""||typeof _e=="number"?(_e=""+_e,oe!==null&&oe.tag===6?(m(de,oe.sibling),oe=S(oe,_e),oe.return=de,de=oe):(m(de,oe),oe=c2(_e,de.mode,Je),oe.return=de,de=oe),G(de)):m(de,oe)}return wr}var Gd=QC(!0),JC=QC(!1),iy=sc(null),sy=null,Bd=null,xw=null;function vw(){xw=Bd=sy=null}function Ew(c){var d=iy.current;Kn(iy),c._currentValue=d}function ww(c,d,m){for(;c!==null;){var v=c.alternate;if((c.childLanes&d)!==d?(c.childLanes|=d,v!==null&&(v.childLanes|=d)):v!==null&&(v.childLanes&d)!==d&&(v.childLanes|=d),c===m)break;c=c.return}}function Ud(c,d){sy=c,xw=Bd=null,c=c.dependencies,c!==null&&c.firstContext!==null&&((c.lanes&d)!==0&&(os=!0),c.firstContext=null)}function aa(c){var d=c._currentValue;if(xw!==c)if(c={context:c,memoizedValue:d,next:null},Bd===null){if(sy===null)throw Error(t(308));Bd=c,sy.dependencies={lanes:0,firstContext:c}}else Bd=Bd.next=c;return d}var Gu=null;function Sw(c){Gu===null?Gu=[c]:Gu.push(c)}function eP(c,d,m,v){var S=d.interleaved;return S===null?(m.next=m,Sw(d)):(m.next=S.next,S.next=m),d.interleaved=m,ul(c,v)}function ul(c,d){c.lanes|=d;var m=c.alternate;for(m!==null&&(m.lanes|=d),m=c,c=c.return;c!==null;)c.childLanes|=d,m=c.alternate,m!==null&&(m.childLanes|=d),m=c,c=c.return;return m.tag===3?m.stateNode:null}var lc=!1;function Tw(c){c.updateQueue={baseState:c.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function tP(c,d){c=c.updateQueue,d.updateQueue===c&&(d.updateQueue={baseState:c.baseState,firstBaseUpdate:c.firstBaseUpdate,lastBaseUpdate:c.lastBaseUpdate,shared:c.shared,effects:c.effects})}function hl(c,d){return{eventTime:c,lane:d,tag:0,payload:null,callback:null,next:null}}function cc(c,d,m){var v=c.updateQueue;if(v===null)return null;if(v=v.shared,(dn&2)!==0){var S=v.pending;return S===null?d.next=d:(d.next=S.next,S.next=d),v.pending=d,ul(c,m)}return S=v.interleaved,S===null?(d.next=d,Sw(v)):(d.next=S.next,S.next=d),v.interleaved=d,ul(c,m)}function ay(c,d,m){if(d=d.updateQueue,d!==null&&(d=d.shared,(m&4194240)!==0)){var v=d.lanes;v&=c.pendingLanes,m|=v,d.lanes=m,Z0(c,m)}}function nP(c,d){var m=c.updateQueue,v=c.alternate;if(v!==null&&(v=v.updateQueue,m===v)){var S=null,A=null;if(m=m.firstBaseUpdate,m!==null){do{var G={eventTime:m.eventTime,lane:m.lane,tag:m.tag,payload:m.payload,callback:m.callback,next:null};A===null?S=A=G:A=A.next=G,m=m.next}while(m!==null);A===null?S=A=d:A=A.next=d}else S=A=d;m={baseState:v.baseState,firstBaseUpdate:S,lastBaseUpdate:A,shared:v.shared,effects:v.effects},c.updateQueue=m;return}c=m.lastBaseUpdate,c===null?m.firstBaseUpdate=d:c.next=d,m.lastBaseUpdate=d}function oy(c,d,m,v){var S=c.updateQueue;lc=!1;var A=S.firstBaseUpdate,G=S.lastBaseUpdate,J=S.shared.pending;if(J!==null){S.shared.pending=null;var ae=J,Ee=ae.next;ae.next=null,G===null?A=Ee:G.next=Ee,G=ae;var ze=c.alternate;ze!==null&&(ze=ze.updateQueue,J=ze.lastBaseUpdate,J!==G&&(J===null?ze.firstBaseUpdate=Ee:J.next=Ee,ze.lastBaseUpdate=ae))}if(A!==null){var Ye=S.baseState;G=0,ze=Ee=ae=null,J=A;do{var Be=J.lane,ft=J.eventTime;if((v&Be)===Be){ze!==null&&(ze=ze.next={eventTime:ft,lane:0,tag:J.tag,payload:J.payload,callback:J.callback,next:null});e:{var _t=c,St=J;switch(Be=d,ft=m,St.tag){case 1:if(_t=St.payload,typeof _t=="function"){Ye=_t.call(ft,Ye,Be);break e}Ye=_t;break e;case 3:_t.flags=_t.flags&-65537|128;case 0:if(_t=St.payload,Be=typeof _t=="function"?_t.call(ft,Ye,Be):_t,Be==null)break e;Ye=ce({},Ye,Be);break e;case 2:lc=!0}}J.callback!==null&&J.lane!==0&&(c.flags|=64,Be=S.effects,Be===null?S.effects=[J]:Be.push(J))}else ft={eventTime:ft,lane:Be,tag:J.tag,payload:J.payload,callback:J.callback,next:null},ze===null?(Ee=ze=ft,ae=Ye):ze=ze.next=ft,G|=Be;if(J=J.next,J===null){if(J=S.shared.pending,J===null)break;Be=J,J=Be.next,Be.next=null,S.lastBaseUpdate=Be,S.shared.pending=null}}while(!0);if(ze===null&&(ae=Ye),S.baseState=ae,S.firstBaseUpdate=Ee,S.lastBaseUpdate=ze,d=S.shared.interleaved,d!==null){S=d;do G|=S.lane,S=S.next;while(S!==d)}else A===null&&(S.shared.lanes=0);zu|=G,c.lanes=G,c.memoizedState=Ye}}function rP(c,d,m){if(c=d.effects,d.effects=null,c!==null)for(d=0;d<c.length;d++){var v=c[d],S=v.callback;if(S!==null){if(v.callback=null,v=m,typeof S!="function")throw Error(t(191,S));S.call(v)}}}var yg={},Eo=sc(yg),_g=sc(yg),xg=sc(yg);function Bu(c){if(c===yg)throw Error(t(174));return c}function Iw(c,d){switch($n(xg,d),$n(_g,c),$n(Eo,yg),c=d.nodeType,c){case 9:case 11:d=(d=d.documentElement)?d.namespaceURI:le(null,"");break;default:c=c===8?d.parentNode:d,d=c.namespaceURI||null,c=c.tagName,d=le(d,c)}Kn(Eo),$n(Eo,d)}function zd(){Kn(Eo),Kn(_g),Kn(xg)}function iP(c){Bu(xg.current);var d=Bu(Eo.current),m=le(d,c.type);d!==m&&($n(_g,c),$n(Eo,m))}function Aw(c){_g.current===c&&(Kn(Eo),Kn(_g))}var sr=sc(0);function ly(c){for(var d=c;d!==null;){if(d.tag===13){var m=d.memoizedState;if(m!==null&&(m=m.dehydrated,m===null||m.data==="$?"||m.data==="$!"))return d}else if(d.tag===19&&d.memoizedProps.revealOrder!==void 0){if((d.flags&128)!==0)return d}else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===c)break;for(;d.sibling===null;){if(d.return===null||d.return===c)return null;d=d.return}d.sibling.return=d.return,d=d.sibling}return null}var bw=[];function Rw(){for(var c=0;c<bw.length;c++)bw[c]._workInProgressVersionPrimary=null;bw.length=0}var cy=N.ReactCurrentDispatcher,Cw=N.ReactCurrentBatchConfig,Uu=0,ar=null,Br=null,qr=null,uy=!1,vg=!1,Eg=0,OG=0;function Ri(){throw Error(t(321))}function Pw(c,d){if(d===null)return!1;for(var m=0;m<d.length&&m<c.length;m++)if(!Pa(c[m],d[m]))return!1;return!0}function kw(c,d,m,v,S,A){if(Uu=A,ar=d,d.memoizedState=null,d.updateQueue=null,d.lanes=0,cy.current=c===null||c.memoizedState===null?VG:GG,c=m(v,S),vg){A=0;do{if(vg=!1,Eg=0,25<=A)throw Error(t(301));A+=1,qr=Br=null,d.updateQueue=null,cy.current=BG,c=m(v,S)}while(vg)}if(cy.current=fy,d=Br!==null&&Br.next!==null,Uu=0,qr=Br=ar=null,uy=!1,d)throw Error(t(300));return c}function Mw(){var c=Eg!==0;return Eg=0,c}function wo(){var c={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return qr===null?ar.memoizedState=qr=c:qr=qr.next=c,qr}function oa(){if(Br===null){var c=ar.alternate;c=c!==null?c.memoizedState:null}else c=Br.next;var d=qr===null?ar.memoizedState:qr.next;if(d!==null)qr=d,Br=c;else{if(c===null)throw Error(t(310));Br=c,c={memoizedState:Br.memoizedState,baseState:Br.baseState,baseQueue:Br.baseQueue,queue:Br.queue,next:null},qr===null?ar.memoizedState=qr=c:qr=qr.next=c}return qr}function wg(c,d){return typeof d=="function"?d(c):d}function Nw(c){var d=oa(),m=d.queue;if(m===null)throw Error(t(311));m.lastRenderedReducer=c;var v=Br,S=v.baseQueue,A=m.pending;if(A!==null){if(S!==null){var G=S.next;S.next=A.next,A.next=G}v.baseQueue=S=A,m.pending=null}if(S!==null){A=S.next,v=v.baseState;var J=G=null,ae=null,Ee=A;do{var ze=Ee.lane;if((Uu&ze)===ze)ae!==null&&(ae=ae.next={lane:0,action:Ee.action,hasEagerState:Ee.hasEagerState,eagerState:Ee.eagerState,next:null}),v=Ee.hasEagerState?Ee.eagerState:c(v,Ee.action);else{var Ye={lane:ze,action:Ee.action,hasEagerState:Ee.hasEagerState,eagerState:Ee.eagerState,next:null};ae===null?(J=ae=Ye,G=v):ae=ae.next=Ye,ar.lanes|=ze,zu|=ze}Ee=Ee.next}while(Ee!==null&&Ee!==A);ae===null?G=v:ae.next=J,Pa(v,d.memoizedState)||(os=!0),d.memoizedState=v,d.baseState=G,d.baseQueue=ae,m.lastRenderedState=v}if(c=m.interleaved,c!==null){S=c;do A=S.lane,ar.lanes|=A,zu|=A,S=S.next;while(S!==c)}else S===null&&(m.lanes=0);return[d.memoizedState,m.dispatch]}function Lw(c){var d=oa(),m=d.queue;if(m===null)throw Error(t(311));m.lastRenderedReducer=c;var v=m.dispatch,S=m.pending,A=d.memoizedState;if(S!==null){m.pending=null;var G=S=S.next;do A=c(A,G.action),G=G.next;while(G!==S);Pa(A,d.memoizedState)||(os=!0),d.memoizedState=A,d.baseQueue===null&&(d.baseState=A),m.lastRenderedState=A}return[A,v]}function sP(){}function aP(c,d){var m=ar,v=oa(),S=d(),A=!Pa(v.memoizedState,S);if(A&&(v.memoizedState=S,os=!0),v=v.queue,Ow(cP.bind(null,m,v,c),[c]),v.getSnapshot!==d||A||qr!==null&&qr.memoizedState.tag&1){if(m.flags|=2048,Sg(9,lP.bind(null,m,v,S,d),void 0,null),Zr===null)throw Error(t(349));(Uu&30)!==0||oP(m,d,S)}return S}function oP(c,d,m){c.flags|=16384,c={getSnapshot:d,value:m},d=ar.updateQueue,d===null?(d={lastEffect:null,stores:null},ar.updateQueue=d,d.stores=[c]):(m=d.stores,m===null?d.stores=[c]:m.push(c))}function lP(c,d,m,v){d.value=m,d.getSnapshot=v,uP(d)&&hP(c)}function cP(c,d,m){return m(function(){uP(d)&&hP(c)})}function uP(c){var d=c.getSnapshot;c=c.value;try{var m=d();return!Pa(c,m)}catch{return!0}}function hP(c){var d=ul(c,1);d!==null&&Oa(d,c,1,-1)}function dP(c){var d=wo();return typeof c=="function"&&(c=c()),d.memoizedState=d.baseState=c,c={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:wg,lastRenderedState:c},d.queue=c,c=c.dispatch=jG.bind(null,ar,c),[d.memoizedState,c]}function Sg(c,d,m,v){return c={tag:c,create:d,destroy:m,deps:v,next:null},d=ar.updateQueue,d===null?(d={lastEffect:null,stores:null},ar.updateQueue=d,d.lastEffect=c.next=c):(m=d.lastEffect,m===null?d.lastEffect=c.next=c:(v=m.next,m.next=c,c.next=v,d.lastEffect=c)),c}function fP(){return oa().memoizedState}function hy(c,d,m,v){var S=wo();ar.flags|=c,S.memoizedState=Sg(1|d,m,void 0,v===void 0?null:v)}function dy(c,d,m,v){var S=oa();v=v===void 0?null:v;var A=void 0;if(Br!==null){var G=Br.memoizedState;if(A=G.destroy,v!==null&&Pw(v,G.deps)){S.memoizedState=Sg(d,m,A,v);return}}ar.flags|=c,S.memoizedState=Sg(1|d,m,A,v)}function gP(c,d){return hy(8390656,8,c,d)}function Ow(c,d){return dy(2048,8,c,d)}function mP(c,d){return dy(4,2,c,d)}function pP(c,d){return dy(4,4,c,d)}function yP(c,d){if(typeof d=="function")return c=c(),d(c),function(){d(null)};if(d!=null)return c=c(),d.current=c,function(){d.current=null}}function _P(c,d,m){return m=m!=null?m.concat([c]):null,dy(4,4,yP.bind(null,d,c),m)}function Dw(){}function xP(c,d){var m=oa();d=d===void 0?null:d;var v=m.memoizedState;return v!==null&&d!==null&&Pw(d,v[1])?v[0]:(m.memoizedState=[c,d],c)}function vP(c,d){var m=oa();d=d===void 0?null:d;var v=m.memoizedState;return v!==null&&d!==null&&Pw(d,v[1])?v[0]:(c=c(),m.memoizedState=[c,d],c)}function EP(c,d,m){return(Uu&21)===0?(c.baseState&&(c.baseState=!1,os=!0),c.memoizedState=m):(Pa(m,d)||(m=X0(),ar.lanes|=m,zu|=m,c.baseState=!0),d)}function DG(c,d){var m=ln;ln=m!==0&&4>m?m:4,c(!0);var v=Cw.transition;Cw.transition={};try{c(!1),d()}finally{ln=m,Cw.transition=v}}function wP(){return oa().memoizedState}function FG(c,d,m){var v=fc(c);if(m={lane:v,action:m,hasEagerState:!1,eagerState:null,next:null},SP(c))TP(d,m);else if(m=eP(c,d,m,v),m!==null){var S=Ki();Oa(m,c,v,S),IP(m,d,v)}}function jG(c,d,m){var v=fc(c),S={lane:v,action:m,hasEagerState:!1,eagerState:null,next:null};if(SP(c))TP(d,S);else{var A=c.alternate;if(c.lanes===0&&(A===null||A.lanes===0)&&(A=d.lastRenderedReducer,A!==null))try{var G=d.lastRenderedState,J=A(G,m);if(S.hasEagerState=!0,S.eagerState=J,Pa(J,G)){var ae=d.interleaved;ae===null?(S.next=S,Sw(d)):(S.next=ae.next,ae.next=S),d.interleaved=S;return}}catch{}m=eP(c,d,S,v),m!==null&&(S=Ki(),Oa(m,c,v,S),IP(m,d,v))}}function SP(c){var d=c.alternate;return c===ar||d!==null&&d===ar}function TP(c,d){vg=uy=!0;var m=c.pending;m===null?d.next=d:(d.next=m.next,m.next=d),c.pending=d}function IP(c,d,m){if((m&4194240)!==0){var v=d.lanes;v&=c.pendingLanes,m|=v,d.lanes=m,Z0(c,m)}}var fy={readContext:aa,useCallback:Ri,useContext:Ri,useEffect:Ri,useImperativeHandle:Ri,useInsertionEffect:Ri,useLayoutEffect:Ri,useMemo:Ri,useReducer:Ri,useRef:Ri,useState:Ri,useDebugValue:Ri,useDeferredValue:Ri,useTransition:Ri,useMutableSource:Ri,useSyncExternalStore:Ri,useId:Ri,unstable_isNewReconciler:!1},VG={readContext:aa,useCallback:function(c,d){return wo().memoizedState=[c,d===void 0?null:d],c},useContext:aa,useEffect:gP,useImperativeHandle:function(c,d,m){return m=m!=null?m.concat([c]):null,hy(4194308,4,yP.bind(null,d,c),m)},useLayoutEffect:function(c,d){return hy(4194308,4,c,d)},useInsertionEffect:function(c,d){return hy(4,2,c,d)},useMemo:function(c,d){var m=wo();return d=d===void 0?null:d,c=c(),m.memoizedState=[c,d],c},useReducer:function(c,d,m){var v=wo();return d=m!==void 0?m(d):d,v.memoizedState=v.baseState=d,c={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:c,lastRenderedState:d},v.queue=c,c=c.dispatch=FG.bind(null,ar,c),[v.memoizedState,c]},useRef:function(c){var d=wo();return c={current:c},d.memoizedState=c},useState:dP,useDebugValue:Dw,useDeferredValue:function(c){return wo().memoizedState=c},useTransition:function(){var c=dP(!1),d=c[0];return c=DG.bind(null,c[1]),wo().memoizedState=c,[d,c]},useMutableSource:function(){},useSyncExternalStore:function(c,d,m){var v=ar,S=wo();if(Jn){if(m===void 0)throw Error(t(407));m=m()}else{if(m=d(),Zr===null)throw Error(t(349));(Uu&30)!==0||oP(v,d,m)}S.memoizedState=m;var A={value:m,getSnapshot:d};return S.queue=A,gP(cP.bind(null,v,A,c),[c]),v.flags|=2048,Sg(9,lP.bind(null,v,A,m,d),void 0,null),m},useId:function(){var c=wo(),d=Zr.identifierPrefix;if(Jn){var m=cl,v=ll;m=(v&~(1<<32-ir(v)-1)).toString(32)+m,d=":"+d+"R"+m,m=Eg++,0<m&&(d+="H"+m.toString(32)),d+=":"}else m=OG++,d=":"+d+"r"+m.toString(32)+":";return c.memoizedState=d},unstable_isNewReconciler:!1},GG={readContext:aa,useCallback:xP,useContext:aa,useEffect:Ow,useImperativeHandle:_P,useInsertionEffect:mP,useLayoutEffect:pP,useMemo:vP,useReducer:Nw,useRef:fP,useState:function(){return Nw(wg)},useDebugValue:Dw,useDeferredValue:function(c){var d=oa();return EP(d,Br.memoizedState,c)},useTransition:function(){var c=Nw(wg)[0],d=oa().memoizedState;return[c,d]},useMutableSource:sP,useSyncExternalStore:aP,useId:wP,unstable_isNewReconciler:!1},BG={readContext:aa,useCallback:xP,useContext:aa,useEffect:Ow,useImperativeHandle:_P,useInsertionEffect:mP,useLayoutEffect:pP,useMemo:vP,useReducer:Lw,useRef:fP,useState:function(){return Lw(wg)},useDebugValue:Dw,useDeferredValue:function(c){var d=oa();return Br===null?d.memoizedState=c:EP(d,Br.memoizedState,c)},useTransition:function(){var c=Lw(wg)[0],d=oa().memoizedState;return[c,d]},useMutableSource:sP,useSyncExternalStore:aP,useId:wP,unstable_isNewReconciler:!1};function Ma(c,d){if(c&&c.defaultProps){d=ce({},d),c=c.defaultProps;for(var m in c)d[m]===void 0&&(d[m]=c[m]);return d}return d}function Fw(c,d,m,v){d=c.memoizedState,m=m(v,d),m=m==null?d:ce({},d,m),c.memoizedState=m,c.lanes===0&&(c.updateQueue.baseState=m)}var gy={isMounted:function(c){return(c=c._reactInternals)?Q(c)===c:!1},enqueueSetState:function(c,d,m){c=c._reactInternals;var v=Ki(),S=fc(c),A=hl(v,S);A.payload=d,m!=null&&(A.callback=m),d=cc(c,A,S),d!==null&&(Oa(d,c,S,v),ay(d,c,S))},enqueueReplaceState:function(c,d,m){c=c._reactInternals;var v=Ki(),S=fc(c),A=hl(v,S);A.tag=1,A.payload=d,m!=null&&(A.callback=m),d=cc(c,A,S),d!==null&&(Oa(d,c,S,v),ay(d,c,S))},enqueueForceUpdate:function(c,d){c=c._reactInternals;var m=Ki(),v=fc(c),S=hl(m,v);S.tag=2,d!=null&&(S.callback=d),d=cc(c,S,v),d!==null&&(Oa(d,c,v,m),ay(d,c,v))}};function AP(c,d,m,v,S,A,G){return c=c.stateNode,typeof c.shouldComponentUpdate=="function"?c.shouldComponentUpdate(v,A,G):d.prototype&&d.prototype.isPureReactComponent?!cg(m,v)||!cg(S,A):!0}function bP(c,d,m){var v=!1,S=ac,A=d.contextType;return typeof A=="object"&&A!==null?A=aa(A):(S=as(d)?Fu:bi.current,v=d.contextTypes,A=(v=v!=null)?Dd(c,S):ac),d=new d(m,A),c.memoizedState=d.state!==null&&d.state!==void 0?d.state:null,d.updater=gy,c.stateNode=d,d._reactInternals=c,v&&(c=c.stateNode,c.__reactInternalMemoizedUnmaskedChildContext=S,c.__reactInternalMemoizedMaskedChildContext=A),d}function RP(c,d,m,v){c=d.state,typeof d.componentWillReceiveProps=="function"&&d.componentWillReceiveProps(m,v),typeof d.UNSAFE_componentWillReceiveProps=="function"&&d.UNSAFE_componentWillReceiveProps(m,v),d.state!==c&&gy.enqueueReplaceState(d,d.state,null)}function jw(c,d,m,v){var S=c.stateNode;S.props=m,S.state=c.memoizedState,S.refs={},Tw(c);var A=d.contextType;typeof A=="object"&&A!==null?S.context=aa(A):(A=as(d)?Fu:bi.current,S.context=Dd(c,A)),S.state=c.memoizedState,A=d.getDerivedStateFromProps,typeof A=="function"&&(Fw(c,d,A,m),S.state=c.memoizedState),typeof d.getDerivedStateFromProps=="function"||typeof S.getSnapshotBeforeUpdate=="function"||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(d=S.state,typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount(),d!==S.state&&gy.enqueueReplaceState(S,S.state,null),oy(c,m,S,v),S.state=c.memoizedState),typeof S.componentDidMount=="function"&&(c.flags|=4194308)}function $d(c,d){try{var m="",v=d;do m+=ee(v),v=v.return;while(v);var S=m}catch(A){S=`
Error generating stack: `+A.message+`
`+A.stack}return{value:c,source:d,stack:S,digest:null}}function Vw(c,d,m){return{value:c,source:null,stack:m??null,digest:d??null}}function Gw(c,d){try{console.error(d.value)}catch(m){setTimeout(function(){throw m})}}var UG=typeof WeakMap=="function"?WeakMap:Map;function CP(c,d,m){m=hl(-1,m),m.tag=3,m.payload={element:null};var v=d.value;return m.callback=function(){Ey||(Ey=!0,t2=v),Gw(c,d)},m}function PP(c,d,m){m=hl(-1,m),m.tag=3;var v=c.type.getDerivedStateFromError;if(typeof v=="function"){var S=d.value;m.payload=function(){return v(S)},m.callback=function(){Gw(c,d)}}var A=c.stateNode;return A!==null&&typeof A.componentDidCatch=="function"&&(m.callback=function(){Gw(c,d),typeof v!="function"&&(hc===null?hc=new Set([this]):hc.add(this));var G=d.stack;this.componentDidCatch(d.value,{componentStack:G!==null?G:""})}),m}function kP(c,d,m){var v=c.pingCache;if(v===null){v=c.pingCache=new UG;var S=new Set;v.set(d,S)}else S=v.get(d),S===void 0&&(S=new Set,v.set(d,S));S.has(m)||(S.add(m),c=nB.bind(null,c,d,m),d.then(c,c))}function MP(c){do{var d;if((d=c.tag===13)&&(d=c.memoizedState,d=d!==null?d.dehydrated!==null:!0),d)return c;c=c.return}while(c!==null);return null}function NP(c,d,m,v,S){return(c.mode&1)===0?(c===d?c.flags|=65536:(c.flags|=128,m.flags|=131072,m.flags&=-52805,m.tag===1&&(m.alternate===null?m.tag=17:(d=hl(-1,1),d.tag=2,cc(m,d,1))),m.lanes|=1),c):(c.flags|=65536,c.lanes=S,c)}var zG=N.ReactCurrentOwner,os=!1;function Hi(c,d,m,v){d.child=c===null?JC(d,null,m,v):Gd(d,c.child,m,v)}function LP(c,d,m,v,S){m=m.render;var A=d.ref;return Ud(d,S),v=kw(c,d,m,v,A,S),m=Mw(),c!==null&&!os?(d.updateQueue=c.updateQueue,d.flags&=-2053,c.lanes&=~S,dl(c,d,S)):(Jn&&m&&gw(d),d.flags|=1,Hi(c,d,v,S),d.child)}function OP(c,d,m,v,S){if(c===null){var A=m.type;return typeof A=="function"&&!l2(A)&&A.defaultProps===void 0&&m.compare===null&&m.defaultProps===void 0?(d.tag=15,d.type=A,DP(c,d,A,v,S)):(c=by(m.type,null,v,d,d.mode,S),c.ref=d.ref,c.return=d,d.child=c)}if(A=c.child,(c.lanes&S)===0){var G=A.memoizedProps;if(m=m.compare,m=m!==null?m:cg,m(G,v)&&c.ref===d.ref)return dl(c,d,S)}return d.flags|=1,c=mc(A,v),c.ref=d.ref,c.return=d,d.child=c}function DP(c,d,m,v,S){if(c!==null){var A=c.memoizedProps;if(cg(A,v)&&c.ref===d.ref)if(os=!1,d.pendingProps=v=A,(c.lanes&S)!==0)(c.flags&131072)!==0&&(os=!0);else return d.lanes=c.lanes,dl(c,d,S)}return Bw(c,d,m,v,S)}function FP(c,d,m){var v=d.pendingProps,S=v.children,A=c!==null?c.memoizedState:null;if(v.mode==="hidden")if((d.mode&1)===0)d.memoizedState={baseLanes:0,cachePool:null,transitions:null},$n(Hd,js),js|=m;else{if((m&1073741824)===0)return c=A!==null?A.baseLanes|m:m,d.lanes=d.childLanes=1073741824,d.memoizedState={baseLanes:c,cachePool:null,transitions:null},d.updateQueue=null,$n(Hd,js),js|=c,null;d.memoizedState={baseLanes:0,cachePool:null,transitions:null},v=A!==null?A.baseLanes:m,$n(Hd,js),js|=v}else A!==null?(v=A.baseLanes|m,d.memoizedState=null):v=m,$n(Hd,js),js|=v;return Hi(c,d,S,m),d.child}function jP(c,d){var m=d.ref;(c===null&&m!==null||c!==null&&c.ref!==m)&&(d.flags|=512,d.flags|=2097152)}function Bw(c,d,m,v,S){var A=as(m)?Fu:bi.current;return A=Dd(d,A),Ud(d,S),m=kw(c,d,m,v,A,S),v=Mw(),c!==null&&!os?(d.updateQueue=c.updateQueue,d.flags&=-2053,c.lanes&=~S,dl(c,d,S)):(Jn&&v&&gw(d),d.flags|=1,Hi(c,d,m,S),d.child)}function VP(c,d,m,v,S){if(as(m)){var A=!0;Q1(d)}else A=!1;if(Ud(d,S),d.stateNode===null)py(c,d),bP(d,m,v),jw(d,m,v,S),v=!0;else if(c===null){var G=d.stateNode,J=d.memoizedProps;G.props=J;var ae=G.context,Ee=m.contextType;typeof Ee=="object"&&Ee!==null?Ee=aa(Ee):(Ee=as(m)?Fu:bi.current,Ee=Dd(d,Ee));var ze=m.getDerivedStateFromProps,Ye=typeof ze=="function"||typeof G.getSnapshotBeforeUpdate=="function";Ye||typeof G.UNSAFE_componentWillReceiveProps!="function"&&typeof G.componentWillReceiveProps!="function"||(J!==v||ae!==Ee)&&RP(d,G,v,Ee),lc=!1;var Be=d.memoizedState;G.state=Be,oy(d,v,G,S),ae=d.memoizedState,J!==v||Be!==ae||ss.current||lc?(typeof ze=="function"&&(Fw(d,m,ze,v),ae=d.memoizedState),(J=lc||AP(d,m,J,v,Be,ae,Ee))?(Ye||typeof G.UNSAFE_componentWillMount!="function"&&typeof G.componentWillMount!="function"||(typeof G.componentWillMount=="function"&&G.componentWillMount(),typeof G.UNSAFE_componentWillMount=="function"&&G.UNSAFE_componentWillMount()),typeof G.componentDidMount=="function"&&(d.flags|=4194308)):(typeof G.componentDidMount=="function"&&(d.flags|=4194308),d.memoizedProps=v,d.memoizedState=ae),G.props=v,G.state=ae,G.context=Ee,v=J):(typeof G.componentDidMount=="function"&&(d.flags|=4194308),v=!1)}else{G=d.stateNode,tP(c,d),J=d.memoizedProps,Ee=d.type===d.elementType?J:Ma(d.type,J),G.props=Ee,Ye=d.pendingProps,Be=G.context,ae=m.contextType,typeof ae=="object"&&ae!==null?ae=aa(ae):(ae=as(m)?Fu:bi.current,ae=Dd(d,ae));var ft=m.getDerivedStateFromProps;(ze=typeof ft=="function"||typeof G.getSnapshotBeforeUpdate=="function")||typeof G.UNSAFE_componentWillReceiveProps!="function"&&typeof G.componentWillReceiveProps!="function"||(J!==Ye||Be!==ae)&&RP(d,G,v,ae),lc=!1,Be=d.memoizedState,G.state=Be,oy(d,v,G,S);var _t=d.memoizedState;J!==Ye||Be!==_t||ss.current||lc?(typeof ft=="function"&&(Fw(d,m,ft,v),_t=d.memoizedState),(Ee=lc||AP(d,m,Ee,v,Be,_t,ae)||!1)?(ze||typeof G.UNSAFE_componentWillUpdate!="function"&&typeof G.componentWillUpdate!="function"||(typeof G.componentWillUpdate=="function"&&G.componentWillUpdate(v,_t,ae),typeof G.UNSAFE_componentWillUpdate=="function"&&G.UNSAFE_componentWillUpdate(v,_t,ae)),typeof G.componentDidUpdate=="function"&&(d.flags|=4),typeof G.getSnapshotBeforeUpdate=="function"&&(d.flags|=1024)):(typeof G.componentDidUpdate!="function"||J===c.memoizedProps&&Be===c.memoizedState||(d.flags|=4),typeof G.getSnapshotBeforeUpdate!="function"||J===c.memoizedProps&&Be===c.memoizedState||(d.flags|=1024),d.memoizedProps=v,d.memoizedState=_t),G.props=v,G.state=_t,G.context=ae,v=Ee):(typeof G.componentDidUpdate!="function"||J===c.memoizedProps&&Be===c.memoizedState||(d.flags|=4),typeof G.getSnapshotBeforeUpdate!="function"||J===c.memoizedProps&&Be===c.memoizedState||(d.flags|=1024),v=!1)}return Uw(c,d,m,v,A,S)}function Uw(c,d,m,v,S,A){jP(c,d);var G=(d.flags&128)!==0;if(!v&&!G)return S&&$C(d,m,!1),dl(c,d,A);v=d.stateNode,zG.current=d;var J=G&&typeof m.getDerivedStateFromError!="function"?null:v.render();return d.flags|=1,c!==null&&G?(d.child=Gd(d,c.child,null,A),d.child=Gd(d,null,J,A)):Hi(c,d,J,A),d.memoizedState=v.state,S&&$C(d,m,!0),d.child}function GP(c){var d=c.stateNode;d.pendingContext?UC(c,d.pendingContext,d.pendingContext!==d.context):d.context&&UC(c,d.context,!1),Iw(c,d.containerInfo)}function BP(c,d,m,v,S){return Vd(),_w(S),d.flags|=256,Hi(c,d,m,v),d.child}var zw={dehydrated:null,treeContext:null,retryLane:0};function $w(c){return{baseLanes:c,cachePool:null,transitions:null}}function UP(c,d,m){var v=d.pendingProps,S=sr.current,A=!1,G=(d.flags&128)!==0,J;if((J=G)||(J=c!==null&&c.memoizedState===null?!1:(S&2)!==0),J?(A=!0,d.flags&=-129):(c===null||c.memoizedState!==null)&&(S|=1),$n(sr,S&1),c===null)return yw(d),c=d.memoizedState,c!==null&&(c=c.dehydrated,c!==null)?((d.mode&1)===0?d.lanes=1:c.data==="$!"?d.lanes=8:d.lanes=1073741824,null):(G=v.children,c=v.fallback,A?(v=d.mode,A=d.child,G={mode:"hidden",children:G},(v&1)===0&&A!==null?(A.childLanes=0,A.pendingProps=G):A=Ry(G,v,0,null),c=Ku(c,v,m,null),A.return=d,c.return=d,A.sibling=c,d.child=A,d.child.memoizedState=$w(m),d.memoizedState=zw,c):Ww(d,G));if(S=c.memoizedState,S!==null&&(J=S.dehydrated,J!==null))return $G(c,d,G,v,J,S,m);if(A){A=v.fallback,G=d.mode,S=c.child,J=S.sibling;var ae={mode:"hidden",children:v.children};return(G&1)===0&&d.child!==S?(v=d.child,v.childLanes=0,v.pendingProps=ae,d.deletions=null):(v=mc(S,ae),v.subtreeFlags=S.subtreeFlags&14680064),J!==null?A=mc(J,A):(A=Ku(A,G,m,null),A.flags|=2),A.return=d,v.return=d,v.sibling=A,d.child=v,v=A,A=d.child,G=c.child.memoizedState,G=G===null?$w(m):{baseLanes:G.baseLanes|m,cachePool:null,transitions:G.transitions},A.memoizedState=G,A.childLanes=c.childLanes&~m,d.memoizedState=zw,v}return A=c.child,c=A.sibling,v=mc(A,{mode:"visible",children:v.children}),(d.mode&1)===0&&(v.lanes=m),v.return=d,v.sibling=null,c!==null&&(m=d.deletions,m===null?(d.deletions=[c],d.flags|=16):m.push(c)),d.child=v,d.memoizedState=null,v}function Ww(c,d){return d=Ry({mode:"visible",children:d},c.mode,0,null),d.return=c,c.child=d}function my(c,d,m,v){return v!==null&&_w(v),Gd(d,c.child,null,m),c=Ww(d,d.pendingProps.children),c.flags|=2,d.memoizedState=null,c}function $G(c,d,m,v,S,A,G){if(m)return d.flags&256?(d.flags&=-257,v=Vw(Error(t(422))),my(c,d,G,v)):d.memoizedState!==null?(d.child=c.child,d.flags|=128,null):(A=v.fallback,S=d.mode,v=Ry({mode:"visible",children:v.children},S,0,null),A=Ku(A,S,G,null),A.flags|=2,v.return=d,A.return=d,v.sibling=A,d.child=v,(d.mode&1)!==0&&Gd(d,c.child,null,G),d.child.memoizedState=$w(G),d.memoizedState=zw,A);if((d.mode&1)===0)return my(c,d,G,null);if(S.data==="$!"){if(v=S.nextSibling&&S.nextSibling.dataset,v)var J=v.dgst;return v=J,A=Error(t(419)),v=Vw(A,v,void 0),my(c,d,G,v)}if(J=(G&c.childLanes)!==0,os||J){if(v=Zr,v!==null){switch(G&-G){case 4:S=2;break;case 16:S=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:S=32;break;case 536870912:S=268435456;break;default:S=0}S=(S&(v.suspendedLanes|G))!==0?0:S,S!==0&&S!==A.retryLane&&(A.retryLane=S,ul(c,S),Oa(v,c,S,-1))}return o2(),v=Vw(Error(t(421))),my(c,d,G,v)}return S.data==="$?"?(d.flags|=128,d.child=c.child,d=rB.bind(null,c),S._reactRetry=d,null):(c=A.treeContext,Fs=ic(S.nextSibling),Ds=d,Jn=!0,ka=null,c!==null&&(ia[sa++]=ll,ia[sa++]=cl,ia[sa++]=ju,ll=c.id,cl=c.overflow,ju=d),d=Ww(d,v.children),d.flags|=4096,d)}function zP(c,d,m){c.lanes|=d;var v=c.alternate;v!==null&&(v.lanes|=d),ww(c.return,d,m)}function Hw(c,d,m,v,S){var A=c.memoizedState;A===null?c.memoizedState={isBackwards:d,rendering:null,renderingStartTime:0,last:v,tail:m,tailMode:S}:(A.isBackwards=d,A.rendering=null,A.renderingStartTime=0,A.last=v,A.tail=m,A.tailMode=S)}function $P(c,d,m){var v=d.pendingProps,S=v.revealOrder,A=v.tail;if(Hi(c,d,v.children,m),v=sr.current,(v&2)!==0)v=v&1|2,d.flags|=128;else{if(c!==null&&(c.flags&128)!==0)e:for(c=d.child;c!==null;){if(c.tag===13)c.memoizedState!==null&&zP(c,m,d);else if(c.tag===19)zP(c,m,d);else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===d)break e;for(;c.sibling===null;){if(c.return===null||c.return===d)break e;c=c.return}c.sibling.return=c.return,c=c.sibling}v&=1}if($n(sr,v),(d.mode&1)===0)d.memoizedState=null;else switch(S){case"forwards":for(m=d.child,S=null;m!==null;)c=m.alternate,c!==null&&ly(c)===null&&(S=m),m=m.sibling;m=S,m===null?(S=d.child,d.child=null):(S=m.sibling,m.sibling=null),Hw(d,!1,S,m,A);break;case"backwards":for(m=null,S=d.child,d.child=null;S!==null;){if(c=S.alternate,c!==null&&ly(c)===null){d.child=S;break}c=S.sibling,S.sibling=m,m=S,S=c}Hw(d,!0,m,null,A);break;case"together":Hw(d,!1,null,null,void 0);break;default:d.memoizedState=null}return d.child}function py(c,d){(d.mode&1)===0&&c!==null&&(c.alternate=null,d.alternate=null,d.flags|=2)}function dl(c,d,m){if(c!==null&&(d.dependencies=c.dependencies),zu|=d.lanes,(m&d.childLanes)===0)return null;if(c!==null&&d.child!==c.child)throw Error(t(153));if(d.child!==null){for(c=d.child,m=mc(c,c.pendingProps),d.child=m,m.return=d;c.sibling!==null;)c=c.sibling,m=m.sibling=mc(c,c.pendingProps),m.return=d;m.sibling=null}return d.child}function WG(c,d,m){switch(d.tag){case 3:GP(d),Vd();break;case 5:iP(d);break;case 1:as(d.type)&&Q1(d);break;case 4:Iw(d,d.stateNode.containerInfo);break;case 10:var v=d.type._context,S=d.memoizedProps.value;$n(iy,v._currentValue),v._currentValue=S;break;case 13:if(v=d.memoizedState,v!==null)return v.dehydrated!==null?($n(sr,sr.current&1),d.flags|=128,null):(m&d.child.childLanes)!==0?UP(c,d,m):($n(sr,sr.current&1),c=dl(c,d,m),c!==null?c.sibling:null);$n(sr,sr.current&1);break;case 19:if(v=(m&d.childLanes)!==0,(c.flags&128)!==0){if(v)return $P(c,d,m);d.flags|=128}if(S=d.memoizedState,S!==null&&(S.rendering=null,S.tail=null,S.lastEffect=null),$n(sr,sr.current),v)break;return null;case 22:case 23:return d.lanes=0,FP(c,d,m)}return dl(c,d,m)}var WP,Kw,HP,KP;WP=function(c,d){for(var m=d.child;m!==null;){if(m.tag===5||m.tag===6)c.appendChild(m.stateNode);else if(m.tag!==4&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===d)break;for(;m.sibling===null;){if(m.return===null||m.return===d)return;m=m.return}m.sibling.return=m.return,m=m.sibling}},Kw=function(){},HP=function(c,d,m,v){var S=c.memoizedProps;if(S!==v){c=d.stateNode,Bu(Eo.current);var A=null;switch(m){case"input":S=Lt(c,S),v=Lt(c,v),A=[];break;case"select":S=ce({},S,{value:void 0}),v=ce({},v,{value:void 0}),A=[];break;case"textarea":S=Et(c,S),v=Et(c,v),A=[];break;default:typeof S.onClick!="function"&&typeof v.onClick=="function"&&(c.onclick=X1)}Fr(m,v);var G;m=null;for(Ee in S)if(!v.hasOwnProperty(Ee)&&S.hasOwnProperty(Ee)&&S[Ee]!=null)if(Ee==="style"){var J=S[Ee];for(G in J)J.hasOwnProperty(G)&&(m||(m={}),m[G]="")}else Ee!=="dangerouslySetInnerHTML"&&Ee!=="children"&&Ee!=="suppressContentEditableWarning"&&Ee!=="suppressHydrationWarning"&&Ee!=="autoFocus"&&(i.hasOwnProperty(Ee)?A||(A=[]):(A=A||[]).push(Ee,null));for(Ee in v){var ae=v[Ee];if(J=S?.[Ee],v.hasOwnProperty(Ee)&&ae!==J&&(ae!=null||J!=null))if(Ee==="style")if(J){for(G in J)!J.hasOwnProperty(G)||ae&&ae.hasOwnProperty(G)||(m||(m={}),m[G]="");for(G in ae)ae.hasOwnProperty(G)&&J[G]!==ae[G]&&(m||(m={}),m[G]=ae[G])}else m||(A||(A=[]),A.push(Ee,m)),m=ae;else Ee==="dangerouslySetInnerHTML"?(ae=ae?ae.__html:void 0,J=J?J.__html:void 0,ae!=null&&J!==ae&&(A=A||[]).push(Ee,ae)):Ee==="children"?typeof ae!="string"&&typeof ae!="number"||(A=A||[]).push(Ee,""+ae):Ee!=="suppressContentEditableWarning"&&Ee!=="suppressHydrationWarning"&&(i.hasOwnProperty(Ee)?(ae!=null&&Ee==="onScroll"&&Hn("scroll",c),A||J===ae||(A=[])):(A=A||[]).push(Ee,ae))}m&&(A=A||[]).push("style",m);var Ee=A;(d.updateQueue=Ee)&&(d.flags|=4)}},KP=function(c,d,m,v){m!==v&&(d.flags|=4)};function Tg(c,d){if(!Jn)switch(c.tailMode){case"hidden":d=c.tail;for(var m=null;d!==null;)d.alternate!==null&&(m=d),d=d.sibling;m===null?c.tail=null:m.sibling=null;break;case"collapsed":m=c.tail;for(var v=null;m!==null;)m.alternate!==null&&(v=m),m=m.sibling;v===null?d||c.tail===null?c.tail=null:c.tail.sibling=null:v.sibling=null}}function Ci(c){var d=c.alternate!==null&&c.alternate.child===c.child,m=0,v=0;if(d)for(var S=c.child;S!==null;)m|=S.lanes|S.childLanes,v|=S.subtreeFlags&14680064,v|=S.flags&14680064,S.return=c,S=S.sibling;else for(S=c.child;S!==null;)m|=S.lanes|S.childLanes,v|=S.subtreeFlags,v|=S.flags,S.return=c,S=S.sibling;return c.subtreeFlags|=v,c.childLanes=m,d}function HG(c,d,m){var v=d.pendingProps;switch(mw(d),d.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ci(d),null;case 1:return as(d.type)&&Z1(),Ci(d),null;case 3:return v=d.stateNode,zd(),Kn(ss),Kn(bi),Rw(),v.pendingContext&&(v.context=v.pendingContext,v.pendingContext=null),(c===null||c.child===null)&&(ny(d)?d.flags|=4:c===null||c.memoizedState.isDehydrated&&(d.flags&256)===0||(d.flags|=1024,ka!==null&&(i2(ka),ka=null))),Kw(c,d),Ci(d),null;case 5:Aw(d);var S=Bu(xg.current);if(m=d.type,c!==null&&d.stateNode!=null)HP(c,d,m,v,S),c.ref!==d.ref&&(d.flags|=512,d.flags|=2097152);else{if(!v){if(d.stateNode===null)throw Error(t(166));return Ci(d),null}if(c=Bu(Eo.current),ny(d)){v=d.stateNode,m=d.type;var A=d.memoizedProps;switch(v[vo]=d,v[gg]=A,c=(d.mode&1)!==0,m){case"dialog":Hn("cancel",v),Hn("close",v);break;case"iframe":case"object":case"embed":Hn("load",v);break;case"video":case"audio":for(S=0;S<hg.length;S++)Hn(hg[S],v);break;case"source":Hn("error",v);break;case"img":case"image":case"link":Hn("error",v),Hn("load",v);break;case"details":Hn("toggle",v);break;case"input":nn(v,A),Hn("invalid",v);break;case"select":v._wrapperState={wasMultiple:!!A.multiple},Hn("invalid",v);break;case"textarea":X(v,A),Hn("invalid",v)}Fr(m,A),S=null;for(var G in A)if(A.hasOwnProperty(G)){var J=A[G];G==="children"?typeof J=="string"?v.textContent!==J&&(A.suppressHydrationWarning!==!0&&Y1(v.textContent,J,c),S=["children",J]):typeof J=="number"&&v.textContent!==""+J&&(A.suppressHydrationWarning!==!0&&Y1(v.textContent,J,c),S=["children",""+J]):i.hasOwnProperty(G)&&J!=null&&G==="onScroll"&&Hn("scroll",v)}switch(m){case"input":Qe(v),Xt(v,A,!0);break;case"textarea":Qe(v),re(v);break;case"select":case"option":break;default:typeof A.onClick=="function"&&(v.onclick=X1)}v=S,d.updateQueue=v,v!==null&&(d.flags|=4)}else{G=S.nodeType===9?S:S.ownerDocument,c==="http://www.w3.org/1999/xhtml"&&(c=z(m)),c==="http://www.w3.org/1999/xhtml"?m==="script"?(c=G.createElement("div"),c.innerHTML="<script><\/script>",c=c.removeChild(c.firstChild)):typeof v.is=="string"?c=G.createElement(m,{is:v.is}):(c=G.createElement(m),m==="select"&&(G=c,v.multiple?G.multiple=!0:v.size&&(G.size=v.size))):c=G.createElementNS(c,m),c[vo]=d,c[gg]=v,WP(c,d,!1,!1),d.stateNode=c;e:{switch(G=Rs(m,v),m){case"dialog":Hn("cancel",c),Hn("close",c),S=v;break;case"iframe":case"object":case"embed":Hn("load",c),S=v;break;case"video":case"audio":for(S=0;S<hg.length;S++)Hn(hg[S],c);S=v;break;case"source":Hn("error",c),S=v;break;case"img":case"image":case"link":Hn("error",c),Hn("load",c),S=v;break;case"details":Hn("toggle",c),S=v;break;case"input":nn(c,v),S=Lt(c,v),Hn("invalid",c);break;case"option":S=v;break;case"select":c._wrapperState={wasMultiple:!!v.multiple},S=ce({},v,{value:void 0}),Hn("invalid",c);break;case"textarea":X(c,v),S=Et(c,v),Hn("invalid",c);break;default:S=v}Fr(m,S),J=S;for(A in J)if(J.hasOwnProperty(A)){var ae=J[A];A==="style"?Rt(c,ae):A==="dangerouslySetInnerHTML"?(ae=ae?ae.__html:void 0,ae!=null&&Ae(c,ae)):A==="children"?typeof ae=="string"?(m!=="textarea"||ae!=="")&&Ze(c,ae):typeof ae=="number"&&Ze(c,""+ae):A!=="suppressContentEditableWarning"&&A!=="suppressHydrationWarning"&&A!=="autoFocus"&&(i.hasOwnProperty(A)?ae!=null&&A==="onScroll"&&Hn("scroll",c):ae!=null&&P(c,A,ae,G))}switch(m){case"input":Qe(c),Xt(c,v,!1);break;case"textarea":Qe(c),re(c);break;case"option":v.value!=null&&c.setAttribute("value",""+Se(v.value));break;case"select":c.multiple=!!v.multiple,A=v.value,A!=null?R(c,!!v.multiple,A,!1):v.defaultValue!=null&&R(c,!!v.multiple,v.defaultValue,!0);break;default:typeof S.onClick=="function"&&(c.onclick=X1)}switch(m){case"button":case"input":case"select":case"textarea":v=!!v.autoFocus;break e;case"img":v=!0;break e;default:v=!1}}v&&(d.flags|=4)}d.ref!==null&&(d.flags|=512,d.flags|=2097152)}return Ci(d),null;case 6:if(c&&d.stateNode!=null)KP(c,d,c.memoizedProps,v);else{if(typeof v!="string"&&d.stateNode===null)throw Error(t(166));if(m=Bu(xg.current),Bu(Eo.current),ny(d)){if(v=d.stateNode,m=d.memoizedProps,v[vo]=d,(A=v.nodeValue!==m)&&(c=Ds,c!==null))switch(c.tag){case 3:Y1(v.nodeValue,m,(c.mode&1)!==0);break;case 5:c.memoizedProps.suppressHydrationWarning!==!0&&Y1(v.nodeValue,m,(c.mode&1)!==0)}A&&(d.flags|=4)}else v=(m.nodeType===9?m:m.ownerDocument).createTextNode(v),v[vo]=d,d.stateNode=v}return Ci(d),null;case 13:if(Kn(sr),v=d.memoizedState,c===null||c.memoizedState!==null&&c.memoizedState.dehydrated!==null){if(Jn&&Fs!==null&&(d.mode&1)!==0&&(d.flags&128)===0)qC(),Vd(),d.flags|=98560,A=!1;else if(A=ny(d),v!==null&&v.dehydrated!==null){if(c===null){if(!A)throw Error(t(318));if(A=d.memoizedState,A=A!==null?A.dehydrated:null,!A)throw Error(t(317));A[vo]=d}else Vd(),(d.flags&128)===0&&(d.memoizedState=null),d.flags|=4;Ci(d),A=!1}else ka!==null&&(i2(ka),ka=null),A=!0;if(!A)return d.flags&65536?d:null}return(d.flags&128)!==0?(d.lanes=m,d):(v=v!==null,v!==(c!==null&&c.memoizedState!==null)&&v&&(d.child.flags|=8192,(d.mode&1)!==0&&(c===null||(sr.current&1)!==0?Ur===0&&(Ur=3):o2())),d.updateQueue!==null&&(d.flags|=4),Ci(d),null);case 4:return zd(),Kw(c,d),c===null&&dg(d.stateNode.containerInfo),Ci(d),null;case 10:return Ew(d.type._context),Ci(d),null;case 17:return as(d.type)&&Z1(),Ci(d),null;case 19:if(Kn(sr),A=d.memoizedState,A===null)return Ci(d),null;if(v=(d.flags&128)!==0,G=A.rendering,G===null)if(v)Tg(A,!1);else{if(Ur!==0||c!==null&&(c.flags&128)!==0)for(c=d.child;c!==null;){if(G=ly(c),G!==null){for(d.flags|=128,Tg(A,!1),v=G.updateQueue,v!==null&&(d.updateQueue=v,d.flags|=4),d.subtreeFlags=0,v=m,m=d.child;m!==null;)A=m,c=v,A.flags&=14680066,G=A.alternate,G===null?(A.childLanes=0,A.lanes=c,A.child=null,A.subtreeFlags=0,A.memoizedProps=null,A.memoizedState=null,A.updateQueue=null,A.dependencies=null,A.stateNode=null):(A.childLanes=G.childLanes,A.lanes=G.lanes,A.child=G.child,A.subtreeFlags=0,A.deletions=null,A.memoizedProps=G.memoizedProps,A.memoizedState=G.memoizedState,A.updateQueue=G.updateQueue,A.type=G.type,c=G.dependencies,A.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),m=m.sibling;return $n(sr,sr.current&1|2),d.child}c=c.sibling}A.tail!==null&&Ke()>Kd&&(d.flags|=128,v=!0,Tg(A,!1),d.lanes=4194304)}else{if(!v)if(c=ly(G),c!==null){if(d.flags|=128,v=!0,m=c.updateQueue,m!==null&&(d.updateQueue=m,d.flags|=4),Tg(A,!0),A.tail===null&&A.tailMode==="hidden"&&!G.alternate&&!Jn)return Ci(d),null}else 2*Ke()-A.renderingStartTime>Kd&&m!==1073741824&&(d.flags|=128,v=!0,Tg(A,!1),d.lanes=4194304);A.isBackwards?(G.sibling=d.child,d.child=G):(m=A.last,m!==null?m.sibling=G:d.child=G,A.last=G)}return A.tail!==null?(d=A.tail,A.rendering=d,A.tail=d.sibling,A.renderingStartTime=Ke(),d.sibling=null,m=sr.current,$n(sr,v?m&1|2:m&1),d):(Ci(d),null);case 22:case 23:return a2(),v=d.memoizedState!==null,c!==null&&c.memoizedState!==null!==v&&(d.flags|=8192),v&&(d.mode&1)!==0?(js&1073741824)!==0&&(Ci(d),d.subtreeFlags&6&&(d.flags|=8192)):Ci(d),null;case 24:return null;case 25:return null}throw Error(t(156,d.tag))}function KG(c,d){switch(mw(d),d.tag){case 1:return as(d.type)&&Z1(),c=d.flags,c&65536?(d.flags=c&-65537|128,d):null;case 3:return zd(),Kn(ss),Kn(bi),Rw(),c=d.flags,(c&65536)!==0&&(c&128)===0?(d.flags=c&-65537|128,d):null;case 5:return Aw(d),null;case 13:if(Kn(sr),c=d.memoizedState,c!==null&&c.dehydrated!==null){if(d.alternate===null)throw Error(t(340));Vd()}return c=d.flags,c&65536?(d.flags=c&-65537|128,d):null;case 19:return Kn(sr),null;case 4:return zd(),null;case 10:return Ew(d.type._context),null;case 22:case 23:return a2(),null;case 24:return null;default:return null}}var yy=!1,Pi=!1,YG=typeof WeakSet=="function"?WeakSet:Set,mt=null;function Wd(c,d){var m=c.ref;if(m!==null)if(typeof m=="function")try{m(null)}catch(v){dr(c,d,v)}else m.current=null}function Yw(c,d,m){try{m()}catch(v){dr(c,d,v)}}var YP=!1;function XG(c,d){if(aw=rl,c=AC(),QE(c)){if("selectionStart"in c)var m={start:c.selectionStart,end:c.selectionEnd};else e:{m=(m=c.ownerDocument)&&m.defaultView||window;var v=m.getSelection&&m.getSelection();if(v&&v.rangeCount!==0){m=v.anchorNode;var S=v.anchorOffset,A=v.focusNode;v=v.focusOffset;try{m.nodeType,A.nodeType}catch{m=null;break e}var G=0,J=-1,ae=-1,Ee=0,ze=0,Ye=c,Be=null;t:for(;;){for(var ft;Ye!==m||S!==0&&Ye.nodeType!==3||(J=G+S),Ye!==A||v!==0&&Ye.nodeType!==3||(ae=G+v),Ye.nodeType===3&&(G+=Ye.nodeValue.length),(ft=Ye.firstChild)!==null;)Be=Ye,Ye=ft;for(;;){if(Ye===c)break t;if(Be===m&&++Ee===S&&(J=G),Be===A&&++ze===v&&(ae=G),(ft=Ye.nextSibling)!==null)break;Ye=Be,Be=Ye.parentNode}Ye=ft}m=J===-1||ae===-1?null:{start:J,end:ae}}else m=null}m=m||{start:0,end:0}}else m=null;for(ow={focusedElem:c,selectionRange:m},rl=!1,mt=d;mt!==null;)if(d=mt,c=d.child,(d.subtreeFlags&1028)!==0&&c!==null)c.return=d,mt=c;else for(;mt!==null;){d=mt;try{var _t=d.alternate;if((d.flags&1024)!==0)switch(d.tag){case 0:case 11:case 15:break;case 1:if(_t!==null){var St=_t.memoizedProps,wr=_t.memoizedState,de=d.stateNode,oe=de.getSnapshotBeforeUpdate(d.elementType===d.type?St:Ma(d.type,St),wr);de.__reactInternalSnapshotBeforeUpdate=oe}break;case 3:var _e=d.stateNode.containerInfo;_e.nodeType===1?_e.textContent="":_e.nodeType===9&&_e.documentElement&&_e.removeChild(_e.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Je){dr(d,d.return,Je)}if(c=d.sibling,c!==null){c.return=d.return,mt=c;break}mt=d.return}return _t=YP,YP=!1,_t}function Ig(c,d,m){var v=d.updateQueue;if(v=v!==null?v.lastEffect:null,v!==null){var S=v=v.next;do{if((S.tag&c)===c){var A=S.destroy;S.destroy=void 0,A!==void 0&&Yw(d,m,A)}S=S.next}while(S!==v)}}function _y(c,d){if(d=d.updateQueue,d=d!==null?d.lastEffect:null,d!==null){var m=d=d.next;do{if((m.tag&c)===c){var v=m.create;m.destroy=v()}m=m.next}while(m!==d)}}function Xw(c){var d=c.ref;if(d!==null){var m=c.stateNode;switch(c.tag){case 5:c=m;break;default:c=m}typeof d=="function"?d(c):d.current=c}}function XP(c){var d=c.alternate;d!==null&&(c.alternate=null,XP(d)),c.child=null,c.deletions=null,c.sibling=null,c.tag===5&&(d=c.stateNode,d!==null&&(delete d[vo],delete d[gg],delete d[hw],delete d[kG],delete d[MG])),c.stateNode=null,c.return=null,c.dependencies=null,c.memoizedProps=null,c.memoizedState=null,c.pendingProps=null,c.stateNode=null,c.updateQueue=null}function qP(c){return c.tag===5||c.tag===3||c.tag===4}function ZP(c){e:for(;;){for(;c.sibling===null;){if(c.return===null||qP(c.return))return null;c=c.return}for(c.sibling.return=c.return,c=c.sibling;c.tag!==5&&c.tag!==6&&c.tag!==18;){if(c.flags&2||c.child===null||c.tag===4)continue e;c.child.return=c,c=c.child}if(!(c.flags&2))return c.stateNode}}function qw(c,d,m){var v=c.tag;if(v===5||v===6)c=c.stateNode,d?m.nodeType===8?m.parentNode.insertBefore(c,d):m.insertBefore(c,d):(m.nodeType===8?(d=m.parentNode,d.insertBefore(c,m)):(d=m,d.appendChild(c)),m=m._reactRootContainer,m!=null||d.onclick!==null||(d.onclick=X1));else if(v!==4&&(c=c.child,c!==null))for(qw(c,d,m),c=c.sibling;c!==null;)qw(c,d,m),c=c.sibling}function Zw(c,d,m){var v=c.tag;if(v===5||v===6)c=c.stateNode,d?m.insertBefore(c,d):m.appendChild(c);else if(v!==4&&(c=c.child,c!==null))for(Zw(c,d,m),c=c.sibling;c!==null;)Zw(c,d,m),c=c.sibling}var di=null,Na=!1;function uc(c,d,m){for(m=m.child;m!==null;)QP(c,d,m),m=m.sibling}function QP(c,d,m){if(vr&&typeof vr.onCommitFiberUnmount=="function")try{vr.onCommitFiberUnmount(ks,m)}catch{}switch(m.tag){case 5:Pi||Wd(m,d);case 6:var v=di,S=Na;di=null,uc(c,d,m),di=v,Na=S,di!==null&&(Na?(c=di,m=m.stateNode,c.nodeType===8?c.parentNode.removeChild(m):c.removeChild(m)):di.removeChild(m.stateNode));break;case 18:di!==null&&(Na?(c=di,m=m.stateNode,c.nodeType===8?uw(c.parentNode,m):c.nodeType===1&&uw(c,m),ec(c)):uw(di,m.stateNode));break;case 4:v=di,S=Na,di=m.stateNode.containerInfo,Na=!0,uc(c,d,m),di=v,Na=S;break;case 0:case 11:case 14:case 15:if(!Pi&&(v=m.updateQueue,v!==null&&(v=v.lastEffect,v!==null))){S=v=v.next;do{var A=S,G=A.destroy;A=A.tag,G!==void 0&&((A&2)!==0||(A&4)!==0)&&Yw(m,d,G),S=S.next}while(S!==v)}uc(c,d,m);break;case 1:if(!Pi&&(Wd(m,d),v=m.stateNode,typeof v.componentWillUnmount=="function"))try{v.props=m.memoizedProps,v.state=m.memoizedState,v.componentWillUnmount()}catch(J){dr(m,d,J)}uc(c,d,m);break;case 21:uc(c,d,m);break;case 22:m.mode&1?(Pi=(v=Pi)||m.memoizedState!==null,uc(c,d,m),Pi=v):uc(c,d,m);break;default:uc(c,d,m)}}function JP(c){var d=c.updateQueue;if(d!==null){c.updateQueue=null;var m=c.stateNode;m===null&&(m=c.stateNode=new YG),d.forEach(function(v){var S=iB.bind(null,c,v);m.has(v)||(m.add(v),v.then(S,S))})}}function La(c,d){var m=d.deletions;if(m!==null)for(var v=0;v<m.length;v++){var S=m[v];try{var A=c,G=d,J=G;e:for(;J!==null;){switch(J.tag){case 5:di=J.stateNode,Na=!1;break e;case 3:di=J.stateNode.containerInfo,Na=!0;break e;case 4:di=J.stateNode.containerInfo,Na=!0;break e}J=J.return}if(di===null)throw Error(t(160));QP(A,G,S),di=null,Na=!1;var ae=S.alternate;ae!==null&&(ae.return=null),S.return=null}catch(Ee){dr(S,d,Ee)}}if(d.subtreeFlags&12854)for(d=d.child;d!==null;)e4(d,c),d=d.sibling}function e4(c,d){var m=c.alternate,v=c.flags;switch(c.tag){case 0:case 11:case 14:case 15:if(La(d,c),So(c),v&4){try{Ig(3,c,c.return),_y(3,c)}catch(St){dr(c,c.return,St)}try{Ig(5,c,c.return)}catch(St){dr(c,c.return,St)}}break;case 1:La(d,c),So(c),v&512&&m!==null&&Wd(m,m.return);break;case 5:if(La(d,c),So(c),v&512&&m!==null&&Wd(m,m.return),c.flags&32){var S=c.stateNode;try{Ze(S,"")}catch(St){dr(c,c.return,St)}}if(v&4&&(S=c.stateNode,S!=null)){var A=c.memoizedProps,G=m!==null?m.memoizedProps:A,J=c.type,ae=c.updateQueue;if(c.updateQueue=null,ae!==null)try{J==="input"&&A.type==="radio"&&A.name!=null&&Ut(S,A),Rs(J,G);var Ee=Rs(J,A);for(G=0;G<ae.length;G+=2){var ze=ae[G],Ye=ae[G+1];ze==="style"?Rt(S,Ye):ze==="dangerouslySetInnerHTML"?Ae(S,Ye):ze==="children"?Ze(S,Ye):P(S,ze,Ye,Ee)}switch(J){case"input":De(S,A);break;case"textarea":Ot(S,A);break;case"select":var Be=S._wrapperState.wasMultiple;S._wrapperState.wasMultiple=!!A.multiple;var ft=A.value;ft!=null?R(S,!!A.multiple,ft,!1):Be!==!!A.multiple&&(A.defaultValue!=null?R(S,!!A.multiple,A.defaultValue,!0):R(S,!!A.multiple,A.multiple?[]:"",!1))}S[gg]=A}catch(St){dr(c,c.return,St)}}break;case 6:if(La(d,c),So(c),v&4){if(c.stateNode===null)throw Error(t(162));S=c.stateNode,A=c.memoizedProps;try{S.nodeValue=A}catch(St){dr(c,c.return,St)}}break;case 3:if(La(d,c),So(c),v&4&&m!==null&&m.memoizedState.isDehydrated)try{ec(d.containerInfo)}catch(St){dr(c,c.return,St)}break;case 4:La(d,c),So(c);break;case 13:La(d,c),So(c),S=c.child,S.flags&8192&&(A=S.memoizedState!==null,S.stateNode.isHidden=A,!A||S.alternate!==null&&S.alternate.memoizedState!==null||(e2=Ke())),v&4&&JP(c);break;case 22:if(ze=m!==null&&m.memoizedState!==null,c.mode&1?(Pi=(Ee=Pi)||ze,La(d,c),Pi=Ee):La(d,c),So(c),v&8192){if(Ee=c.memoizedState!==null,(c.stateNode.isHidden=Ee)&&!ze&&(c.mode&1)!==0)for(mt=c,ze=c.child;ze!==null;){for(Ye=mt=ze;mt!==null;){switch(Be=mt,ft=Be.child,Be.tag){case 0:case 11:case 14:case 15:Ig(4,Be,Be.return);break;case 1:Wd(Be,Be.return);var _t=Be.stateNode;if(typeof _t.componentWillUnmount=="function"){v=Be,m=Be.return;try{d=v,_t.props=d.memoizedProps,_t.state=d.memoizedState,_t.componentWillUnmount()}catch(St){dr(v,m,St)}}break;case 5:Wd(Be,Be.return);break;case 22:if(Be.memoizedState!==null){r4(Ye);continue}}ft!==null?(ft.return=Be,mt=ft):r4(Ye)}ze=ze.sibling}e:for(ze=null,Ye=c;;){if(Ye.tag===5){if(ze===null){ze=Ye;try{S=Ye.stateNode,Ee?(A=S.style,typeof A.setProperty=="function"?A.setProperty("display","none","important"):A.display="none"):(J=Ye.stateNode,ae=Ye.memoizedProps.style,G=ae!=null&&ae.hasOwnProperty("display")?ae.display:null,J.style.display=wt("display",G))}catch(St){dr(c,c.return,St)}}}else if(Ye.tag===6){if(ze===null)try{Ye.stateNode.nodeValue=Ee?"":Ye.memoizedProps}catch(St){dr(c,c.return,St)}}else if((Ye.tag!==22&&Ye.tag!==23||Ye.memoizedState===null||Ye===c)&&Ye.child!==null){Ye.child.return=Ye,Ye=Ye.child;continue}if(Ye===c)break e;for(;Ye.sibling===null;){if(Ye.return===null||Ye.return===c)break e;ze===Ye&&(ze=null),Ye=Ye.return}ze===Ye&&(ze=null),Ye.sibling.return=Ye.return,Ye=Ye.sibling}}break;case 19:La(d,c),So(c),v&4&&JP(c);break;case 21:break;default:La(d,c),So(c)}}function So(c){var d=c.flags;if(d&2){try{e:{for(var m=c.return;m!==null;){if(qP(m)){var v=m;break e}m=m.return}throw Error(t(160))}switch(v.tag){case 5:var S=v.stateNode;v.flags&32&&(Ze(S,""),v.flags&=-33);var A=ZP(c);Zw(c,A,S);break;case 3:case 4:var G=v.stateNode.containerInfo,J=ZP(c);qw(c,J,G);break;default:throw Error(t(161))}}catch(ae){dr(c,c.return,ae)}c.flags&=-3}d&4096&&(c.flags&=-4097)}function qG(c,d,m){mt=c,t4(c)}function t4(c,d,m){for(var v=(c.mode&1)!==0;mt!==null;){var S=mt,A=S.child;if(S.tag===22&&v){var G=S.memoizedState!==null||yy;if(!G){var J=S.alternate,ae=J!==null&&J.memoizedState!==null||Pi;J=yy;var Ee=Pi;if(yy=G,(Pi=ae)&&!Ee)for(mt=S;mt!==null;)G=mt,ae=G.child,G.tag===22&&G.memoizedState!==null?i4(S):ae!==null?(ae.return=G,mt=ae):i4(S);for(;A!==null;)mt=A,t4(A),A=A.sibling;mt=S,yy=J,Pi=Ee}n4(c)}else(S.subtreeFlags&8772)!==0&&A!==null?(A.return=S,mt=A):n4(c)}}function n4(c){for(;mt!==null;){var d=mt;if((d.flags&8772)!==0){var m=d.alternate;try{if((d.flags&8772)!==0)switch(d.tag){case 0:case 11:case 15:Pi||_y(5,d);break;case 1:var v=d.stateNode;if(d.flags&4&&!Pi)if(m===null)v.componentDidMount();else{var S=d.elementType===d.type?m.memoizedProps:Ma(d.type,m.memoizedProps);v.componentDidUpdate(S,m.memoizedState,v.__reactInternalSnapshotBeforeUpdate)}var A=d.updateQueue;A!==null&&rP(d,A,v);break;case 3:var G=d.updateQueue;if(G!==null){if(m=null,d.child!==null)switch(d.child.tag){case 5:m=d.child.stateNode;break;case 1:m=d.child.stateNode}rP(d,G,m)}break;case 5:var J=d.stateNode;if(m===null&&d.flags&4){m=J;var ae=d.memoizedProps;switch(d.type){case"button":case"input":case"select":case"textarea":ae.autoFocus&&m.focus();break;case"img":ae.src&&(m.src=ae.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(d.memoizedState===null){var Ee=d.alternate;if(Ee!==null){var ze=Ee.memoizedState;if(ze!==null){var Ye=ze.dehydrated;Ye!==null&&ec(Ye)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Pi||d.flags&512&&Xw(d)}catch(Be){dr(d,d.return,Be)}}if(d===c){mt=null;break}if(m=d.sibling,m!==null){m.return=d.return,mt=m;break}mt=d.return}}function r4(c){for(;mt!==null;){var d=mt;if(d===c){mt=null;break}var m=d.sibling;if(m!==null){m.return=d.return,mt=m;break}mt=d.return}}function i4(c){for(;mt!==null;){var d=mt;try{switch(d.tag){case 0:case 11:case 15:var m=d.return;try{_y(4,d)}catch(ae){dr(d,m,ae)}break;case 1:var v=d.stateNode;if(typeof v.componentDidMount=="function"){var S=d.return;try{v.componentDidMount()}catch(ae){dr(d,S,ae)}}var A=d.return;try{Xw(d)}catch(ae){dr(d,A,ae)}break;case 5:var G=d.return;try{Xw(d)}catch(ae){dr(d,G,ae)}}}catch(ae){dr(d,d.return,ae)}if(d===c){mt=null;break}var J=d.sibling;if(J!==null){J.return=d.return,mt=J;break}mt=d.return}}var ZG=Math.ceil,xy=N.ReactCurrentDispatcher,Qw=N.ReactCurrentOwner,la=N.ReactCurrentBatchConfig,dn=0,Zr=null,Cr=null,fi=0,js=0,Hd=sc(0),Ur=0,Ag=null,zu=0,vy=0,Jw=0,bg=null,ls=null,e2=0,Kd=1/0,fl=null,Ey=!1,t2=null,hc=null,wy=!1,dc=null,Sy=0,Rg=0,n2=null,Ty=-1,Iy=0;function Ki(){return(dn&6)!==0?Ke():Ty!==-1?Ty:Ty=Ke()}function fc(c){return(c.mode&1)===0?1:(dn&2)!==0&&fi!==0?fi&-fi:LG.transition!==null?(Iy===0&&(Iy=X0()),Iy):(c=ln,c!==0||(c=window.event,c=c===void 0?16:wd(c.type)),c)}function Oa(c,d,m,v){if(50<Rg)throw Rg=0,n2=null,Error(t(185));ku(c,m,v),((dn&2)===0||c!==Zr)&&(c===Zr&&((dn&2)===0&&(vy|=m),Ur===4&&gc(c,fi)),cs(c,v),m===1&&dn===0&&(d.mode&1)===0&&(Kd=Ke()+500,J1&&oc()))}function cs(c,d){var m=c.callbackNode;Pu(c,d);var v=el(c,c===Zr?fi:0);if(v===0)m!==null&&et(m),c.callbackNode=null,c.callbackPriority=0;else if(d=v&-v,c.callbackPriority!==d){if(m!=null&&et(m),d===1)c.tag===0?NG(a4.bind(null,c)):WC(a4.bind(null,c)),CG(function(){(dn&6)===0&&oc()}),m=null;else{switch(co(v)){case 1:m=In;break;case 4:m=Pn;break;case 16:m=Qn;break;case 536870912:m=na;break;default:m=Qn}m=g4(m,s4.bind(null,c))}c.callbackPriority=d,c.callbackNode=m}}function s4(c,d){if(Ty=-1,Iy=0,(dn&6)!==0)throw Error(t(327));var m=c.callbackNode;if(Yd()&&c.callbackNode!==m)return null;var v=el(c,c===Zr?fi:0);if(v===0)return null;if((v&30)!==0||(v&c.expiredLanes)!==0||d)d=Ay(c,v);else{d=v;var S=dn;dn|=2;var A=l4();(Zr!==c||fi!==d)&&(fl=null,Kd=Ke()+500,Wu(c,d));do try{eB();break}catch(J){o4(c,J)}while(!0);vw(),xy.current=A,dn=S,Cr!==null?d=0:(Zr=null,fi=0,d=Ur)}if(d!==0){if(d===2&&(S=Y0(c),S!==0&&(v=S,d=r2(c,S))),d===1)throw m=Ag,Wu(c,0),gc(c,v),cs(c,Ke()),m;if(d===6)gc(c,v);else{if(S=c.current.alternate,(v&30)===0&&!QG(S)&&(d=Ay(c,v),d===2&&(A=Y0(c),A!==0&&(v=A,d=r2(c,A))),d===1))throw m=Ag,Wu(c,0),gc(c,v),cs(c,Ke()),m;switch(c.finishedWork=S,c.finishedLanes=v,d){case 0:case 1:throw Error(t(345));case 2:Hu(c,ls,fl);break;case 3:if(gc(c,v),(v&130023424)===v&&(d=e2+500-Ke(),10<d)){if(el(c,0)!==0)break;if(S=c.suspendedLanes,(S&v)!==v){Ki(),c.pingedLanes|=c.suspendedLanes&S;break}c.timeoutHandle=cw(Hu.bind(null,c,ls,fl),d);break}Hu(c,ls,fl);break;case 4:if(gc(c,v),(v&4194240)===v)break;for(d=c.eventTimes,S=-1;0<v;){var G=31-ir(v);A=1<<G,G=d[G],G>S&&(S=G),v&=~A}if(v=S,v=Ke()-v,v=(120>v?120:480>v?480:1080>v?1080:1920>v?1920:3e3>v?3e3:4320>v?4320:1960*ZG(v/1960))-v,10<v){c.timeoutHandle=cw(Hu.bind(null,c,ls,fl),v);break}Hu(c,ls,fl);break;case 5:Hu(c,ls,fl);break;default:throw Error(t(329))}}}return cs(c,Ke()),c.callbackNode===m?s4.bind(null,c):null}function r2(c,d){var m=bg;return c.current.memoizedState.isDehydrated&&(Wu(c,d).flags|=256),c=Ay(c,d),c!==2&&(d=ls,ls=m,d!==null&&i2(d)),c}function i2(c){ls===null?ls=c:ls.push.apply(ls,c)}function QG(c){for(var d=c;;){if(d.flags&16384){var m=d.updateQueue;if(m!==null&&(m=m.stores,m!==null))for(var v=0;v<m.length;v++){var S=m[v],A=S.getSnapshot;S=S.value;try{if(!Pa(A(),S))return!1}catch{return!1}}}if(m=d.child,d.subtreeFlags&16384&&m!==null)m.return=d,d=m;else{if(d===c)break;for(;d.sibling===null;){if(d.return===null||d.return===c)return!0;d=d.return}d.sibling.return=d.return,d=d.sibling}}return!0}function gc(c,d){for(d&=~Jw,d&=~vy,c.suspendedLanes|=d,c.pingedLanes&=~d,c=c.expirationTimes;0<d;){var m=31-ir(d),v=1<<m;c[m]=-1,d&=~v}}function a4(c){if((dn&6)!==0)throw Error(t(327));Yd();var d=el(c,0);if((d&1)===0)return cs(c,Ke()),null;var m=Ay(c,d);if(c.tag!==0&&m===2){var v=Y0(c);v!==0&&(d=v,m=r2(c,v))}if(m===1)throw m=Ag,Wu(c,0),gc(c,d),cs(c,Ke()),m;if(m===6)throw Error(t(345));return c.finishedWork=c.current.alternate,c.finishedLanes=d,Hu(c,ls,fl),cs(c,Ke()),null}function s2(c,d){var m=dn;dn|=1;try{return c(d)}finally{dn=m,dn===0&&(Kd=Ke()+500,J1&&oc())}}function $u(c){dc!==null&&dc.tag===0&&(dn&6)===0&&Yd();var d=dn;dn|=1;var m=la.transition,v=ln;try{if(la.transition=null,ln=1,c)return c()}finally{ln=v,la.transition=m,dn=d,(dn&6)===0&&oc()}}function a2(){js=Hd.current,Kn(Hd)}function Wu(c,d){c.finishedWork=null,c.finishedLanes=0;var m=c.timeoutHandle;if(m!==-1&&(c.timeoutHandle=-1,RG(m)),Cr!==null)for(m=Cr.return;m!==null;){var v=m;switch(mw(v),v.tag){case 1:v=v.type.childContextTypes,v!=null&&Z1();break;case 3:zd(),Kn(ss),Kn(bi),Rw();break;case 5:Aw(v);break;case 4:zd();break;case 13:Kn(sr);break;case 19:Kn(sr);break;case 10:Ew(v.type._context);break;case 22:case 23:a2()}m=m.return}if(Zr=c,Cr=c=mc(c.current,null),fi=js=d,Ur=0,Ag=null,Jw=vy=zu=0,ls=bg=null,Gu!==null){for(d=0;d<Gu.length;d++)if(m=Gu[d],v=m.interleaved,v!==null){m.interleaved=null;var S=v.next,A=m.pending;if(A!==null){var G=A.next;A.next=S,v.next=G}m.pending=v}Gu=null}return c}function o4(c,d){do{var m=Cr;try{if(vw(),cy.current=fy,uy){for(var v=ar.memoizedState;v!==null;){var S=v.queue;S!==null&&(S.pending=null),v=v.next}uy=!1}if(Uu=0,qr=Br=ar=null,vg=!1,Eg=0,Qw.current=null,m===null||m.return===null){Ur=1,Ag=d,Cr=null;break}e:{var A=c,G=m.return,J=m,ae=d;if(d=fi,J.flags|=32768,ae!==null&&typeof ae=="object"&&typeof ae.then=="function"){var Ee=ae,ze=J,Ye=ze.tag;if((ze.mode&1)===0&&(Ye===0||Ye===11||Ye===15)){var Be=ze.alternate;Be?(ze.updateQueue=Be.updateQueue,ze.memoizedState=Be.memoizedState,ze.lanes=Be.lanes):(ze.updateQueue=null,ze.memoizedState=null)}var ft=MP(G);if(ft!==null){ft.flags&=-257,NP(ft,G,J,A,d),ft.mode&1&&kP(A,Ee,d),d=ft,ae=Ee;var _t=d.updateQueue;if(_t===null){var St=new Set;St.add(ae),d.updateQueue=St}else _t.add(ae);break e}else{if((d&1)===0){kP(A,Ee,d),o2();break e}ae=Error(t(426))}}else if(Jn&&J.mode&1){var wr=MP(G);if(wr!==null){(wr.flags&65536)===0&&(wr.flags|=256),NP(wr,G,J,A,d),_w($d(ae,J));break e}}A=ae=$d(ae,J),Ur!==4&&(Ur=2),bg===null?bg=[A]:bg.push(A),A=G;do{switch(A.tag){case 3:A.flags|=65536,d&=-d,A.lanes|=d;var de=CP(A,ae,d);nP(A,de);break e;case 1:J=ae;var oe=A.type,_e=A.stateNode;if((A.flags&128)===0&&(typeof oe.getDerivedStateFromError=="function"||_e!==null&&typeof _e.componentDidCatch=="function"&&(hc===null||!hc.has(_e)))){A.flags|=65536,d&=-d,A.lanes|=d;var Je=PP(A,J,d);nP(A,Je);break e}}A=A.return}while(A!==null)}u4(m)}catch(At){d=At,Cr===m&&m!==null&&(Cr=m=m.return);continue}break}while(!0)}function l4(){var c=xy.current;return xy.current=fy,c===null?fy:c}function o2(){(Ur===0||Ur===3||Ur===2)&&(Ur=4),Zr===null||(zu&268435455)===0&&(vy&268435455)===0||gc(Zr,fi)}function Ay(c,d){var m=dn;dn|=2;var v=l4();(Zr!==c||fi!==d)&&(fl=null,Wu(c,d));do try{JG();break}catch(S){o4(c,S)}while(!0);if(vw(),dn=m,xy.current=v,Cr!==null)throw Error(t(261));return Zr=null,fi=0,Ur}function JG(){for(;Cr!==null;)c4(Cr)}function eB(){for(;Cr!==null&&!ut();)c4(Cr)}function c4(c){var d=f4(c.alternate,c,js);c.memoizedProps=c.pendingProps,d===null?u4(c):Cr=d,Qw.current=null}function u4(c){var d=c;do{var m=d.alternate;if(c=d.return,(d.flags&32768)===0){if(m=HG(m,d,js),m!==null){Cr=m;return}}else{if(m=KG(m,d),m!==null){m.flags&=32767,Cr=m;return}if(c!==null)c.flags|=32768,c.subtreeFlags=0,c.deletions=null;else{Ur=6,Cr=null;return}}if(d=d.sibling,d!==null){Cr=d;return}Cr=d=c}while(d!==null);Ur===0&&(Ur=5)}function Hu(c,d,m){var v=ln,S=la.transition;try{la.transition=null,ln=1,tB(c,d,m,v)}finally{la.transition=S,ln=v}return null}function tB(c,d,m,v){do Yd();while(dc!==null);if((dn&6)!==0)throw Error(t(327));m=c.finishedWork;var S=c.finishedLanes;if(m===null)return null;if(c.finishedWork=null,c.finishedLanes=0,m===c.current)throw Error(t(177));c.callbackNode=null,c.callbackPriority=0;var A=m.lanes|m.childLanes;if(KE(c,A),c===Zr&&(Cr=Zr=null,fi=0),(m.subtreeFlags&2064)===0&&(m.flags&2064)===0||wy||(wy=!0,g4(Qn,function(){return Yd(),null})),A=(m.flags&15990)!==0,(m.subtreeFlags&15990)!==0||A){A=la.transition,la.transition=null;var G=ln;ln=1;var J=dn;dn|=4,Qw.current=null,XG(c,m),e4(m,c),EG(ow),rl=!!aw,ow=aw=null,c.current=m,qG(m),He(),dn=J,ln=G,la.transition=A}else c.current=m;if(wy&&(wy=!1,dc=c,Sy=S),A=c.pendingLanes,A===0&&(hc=null),ql(m.stateNode),cs(c,Ke()),d!==null)for(v=c.onRecoverableError,m=0;m<d.length;m++)S=d[m],v(S.value,{componentStack:S.stack,digest:S.digest});if(Ey)throw Ey=!1,c=t2,t2=null,c;return(Sy&1)!==0&&c.tag!==0&&Yd(),A=c.pendingLanes,(A&1)!==0?c===n2?Rg++:(Rg=0,n2=c):Rg=0,oc(),null}function Yd(){if(dc!==null){var c=co(Sy),d=la.transition,m=ln;try{if(la.transition=null,ln=16>c?16:c,dc===null)var v=!1;else{if(c=dc,dc=null,Sy=0,(dn&6)!==0)throw Error(t(331));var S=dn;for(dn|=4,mt=c.current;mt!==null;){var A=mt,G=A.child;if((mt.flags&16)!==0){var J=A.deletions;if(J!==null){for(var ae=0;ae<J.length;ae++){var Ee=J[ae];for(mt=Ee;mt!==null;){var ze=mt;switch(ze.tag){case 0:case 11:case 15:Ig(8,ze,A)}var Ye=ze.child;if(Ye!==null)Ye.return=ze,mt=Ye;else for(;mt!==null;){ze=mt;var Be=ze.sibling,ft=ze.return;if(XP(ze),ze===Ee){mt=null;break}if(Be!==null){Be.return=ft,mt=Be;break}mt=ft}}}var _t=A.alternate;if(_t!==null){var St=_t.child;if(St!==null){_t.child=null;do{var wr=St.sibling;St.sibling=null,St=wr}while(St!==null)}}mt=A}}if((A.subtreeFlags&2064)!==0&&G!==null)G.return=A,mt=G;else e:for(;mt!==null;){if(A=mt,(A.flags&2048)!==0)switch(A.tag){case 0:case 11:case 15:Ig(9,A,A.return)}var de=A.sibling;if(de!==null){de.return=A.return,mt=de;break e}mt=A.return}}var oe=c.current;for(mt=oe;mt!==null;){G=mt;var _e=G.child;if((G.subtreeFlags&2064)!==0&&_e!==null)_e.return=G,mt=_e;else e:for(G=oe;mt!==null;){if(J=mt,(J.flags&2048)!==0)try{switch(J.tag){case 0:case 11:case 15:_y(9,J)}}catch(At){dr(J,J.return,At)}if(J===G){mt=null;break e}var Je=J.sibling;if(Je!==null){Je.return=J.return,mt=Je;break e}mt=J.return}}if(dn=S,oc(),vr&&typeof vr.onPostCommitFiberRoot=="function")try{vr.onPostCommitFiberRoot(ks,c)}catch{}v=!0}return v}finally{ln=m,la.transition=d}}return!1}function h4(c,d,m){d=$d(m,d),d=CP(c,d,1),c=cc(c,d,1),d=Ki(),c!==null&&(ku(c,1,d),cs(c,d))}function dr(c,d,m){if(c.tag===3)h4(c,c,m);else for(;d!==null;){if(d.tag===3){h4(d,c,m);break}else if(d.tag===1){var v=d.stateNode;if(typeof d.type.getDerivedStateFromError=="function"||typeof v.componentDidCatch=="function"&&(hc===null||!hc.has(v))){c=$d(m,c),c=PP(d,c,1),d=cc(d,c,1),c=Ki(),d!==null&&(ku(d,1,c),cs(d,c));break}}d=d.return}}function nB(c,d,m){var v=c.pingCache;v!==null&&v.delete(d),d=Ki(),c.pingedLanes|=c.suspendedLanes&m,Zr===c&&(fi&m)===m&&(Ur===4||Ur===3&&(fi&130023424)===fi&&500>Ke()-e2?Wu(c,0):Jw|=m),cs(c,d)}function d4(c,d){d===0&&((c.mode&1)===0?d=1:(d=Zl,Zl<<=1,(Zl&130023424)===0&&(Zl=4194304)));var m=Ki();c=ul(c,d),c!==null&&(ku(c,d,m),cs(c,m))}function rB(c){var d=c.memoizedState,m=0;d!==null&&(m=d.retryLane),d4(c,m)}function iB(c,d){var m=0;switch(c.tag){case 13:var v=c.stateNode,S=c.memoizedState;S!==null&&(m=S.retryLane);break;case 19:v=c.stateNode;break;default:throw Error(t(314))}v!==null&&v.delete(d),d4(c,m)}var f4;f4=function(c,d,m){if(c!==null)if(c.memoizedProps!==d.pendingProps||ss.current)os=!0;else{if((c.lanes&m)===0&&(d.flags&128)===0)return os=!1,WG(c,d,m);os=(c.flags&131072)!==0}else os=!1,Jn&&(d.flags&1048576)!==0&&HC(d,ty,d.index);switch(d.lanes=0,d.tag){case 2:var v=d.type;py(c,d),c=d.pendingProps;var S=Dd(d,bi.current);Ud(d,m),S=kw(null,d,v,c,S,m);var A=Mw();return d.flags|=1,typeof S=="object"&&S!==null&&typeof S.render=="function"&&S.$$typeof===void 0?(d.tag=1,d.memoizedState=null,d.updateQueue=null,as(v)?(A=!0,Q1(d)):A=!1,d.memoizedState=S.state!==null&&S.state!==void 0?S.state:null,Tw(d),S.updater=gy,d.stateNode=S,S._reactInternals=d,jw(d,v,c,m),d=Uw(null,d,v,!0,A,m)):(d.tag=0,Jn&&A&&gw(d),Hi(null,d,S,m),d=d.child),d;case 16:v=d.elementType;e:{switch(py(c,d),c=d.pendingProps,S=v._init,v=S(v._payload),d.type=v,S=d.tag=aB(v),c=Ma(v,c),S){case 0:d=Bw(null,d,v,c,m);break e;case 1:d=VP(null,d,v,c,m);break e;case 11:d=LP(null,d,v,c,m);break e;case 14:d=OP(null,d,v,Ma(v.type,c),m);break e}throw Error(t(306,v,""))}return d;case 0:return v=d.type,S=d.pendingProps,S=d.elementType===v?S:Ma(v,S),Bw(c,d,v,S,m);case 1:return v=d.type,S=d.pendingProps,S=d.elementType===v?S:Ma(v,S),VP(c,d,v,S,m);case 3:e:{if(GP(d),c===null)throw Error(t(387));v=d.pendingProps,A=d.memoizedState,S=A.element,tP(c,d),oy(d,v,null,m);var G=d.memoizedState;if(v=G.element,A.isDehydrated)if(A={element:v,isDehydrated:!1,cache:G.cache,pendingSuspenseBoundaries:G.pendingSuspenseBoundaries,transitions:G.transitions},d.updateQueue.baseState=A,d.memoizedState=A,d.flags&256){S=$d(Error(t(423)),d),d=BP(c,d,v,m,S);break e}else if(v!==S){S=$d(Error(t(424)),d),d=BP(c,d,v,m,S);break e}else for(Fs=ic(d.stateNode.containerInfo.firstChild),Ds=d,Jn=!0,ka=null,m=JC(d,null,v,m),d.child=m;m;)m.flags=m.flags&-3|4096,m=m.sibling;else{if(Vd(),v===S){d=dl(c,d,m);break e}Hi(c,d,v,m)}d=d.child}return d;case 5:return iP(d),c===null&&yw(d),v=d.type,S=d.pendingProps,A=c!==null?c.memoizedProps:null,G=S.children,lw(v,S)?G=null:A!==null&&lw(v,A)&&(d.flags|=32),jP(c,d),Hi(c,d,G,m),d.child;case 6:return c===null&&yw(d),null;case 13:return UP(c,d,m);case 4:return Iw(d,d.stateNode.containerInfo),v=d.pendingProps,c===null?d.child=Gd(d,null,v,m):Hi(c,d,v,m),d.child;case 11:return v=d.type,S=d.pendingProps,S=d.elementType===v?S:Ma(v,S),LP(c,d,v,S,m);case 7:return Hi(c,d,d.pendingProps,m),d.child;case 8:return Hi(c,d,d.pendingProps.children,m),d.child;case 12:return Hi(c,d,d.pendingProps.children,m),d.child;case 10:e:{if(v=d.type._context,S=d.pendingProps,A=d.memoizedProps,G=S.value,$n(iy,v._currentValue),v._currentValue=G,A!==null)if(Pa(A.value,G)){if(A.children===S.children&&!ss.current){d=dl(c,d,m);break e}}else for(A=d.child,A!==null&&(A.return=d);A!==null;){var J=A.dependencies;if(J!==null){G=A.child;for(var ae=J.firstContext;ae!==null;){if(ae.context===v){if(A.tag===1){ae=hl(-1,m&-m),ae.tag=2;var Ee=A.updateQueue;if(Ee!==null){Ee=Ee.shared;var ze=Ee.pending;ze===null?ae.next=ae:(ae.next=ze.next,ze.next=ae),Ee.pending=ae}}A.lanes|=m,ae=A.alternate,ae!==null&&(ae.lanes|=m),ww(A.return,m,d),J.lanes|=m;break}ae=ae.next}}else if(A.tag===10)G=A.type===d.type?null:A.child;else if(A.tag===18){if(G=A.return,G===null)throw Error(t(341));G.lanes|=m,J=G.alternate,J!==null&&(J.lanes|=m),ww(G,m,d),G=A.sibling}else G=A.child;if(G!==null)G.return=A;else for(G=A;G!==null;){if(G===d){G=null;break}if(A=G.sibling,A!==null){A.return=G.return,G=A;break}G=G.return}A=G}Hi(c,d,S.children,m),d=d.child}return d;case 9:return S=d.type,v=d.pendingProps.children,Ud(d,m),S=aa(S),v=v(S),d.flags|=1,Hi(c,d,v,m),d.child;case 14:return v=d.type,S=Ma(v,d.pendingProps),S=Ma(v.type,S),OP(c,d,v,S,m);case 15:return DP(c,d,d.type,d.pendingProps,m);case 17:return v=d.type,S=d.pendingProps,S=d.elementType===v?S:Ma(v,S),py(c,d),d.tag=1,as(v)?(c=!0,Q1(d)):c=!1,Ud(d,m),bP(d,v,S),jw(d,v,S,m),Uw(null,d,v,!0,c,m);case 19:return $P(c,d,m);case 22:return FP(c,d,m)}throw Error(t(156,d.tag))};function g4(c,d){return We(c,d)}function sB(c,d,m,v){this.tag=c,this.key=m,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=d,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=v,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ca(c,d,m,v){return new sB(c,d,m,v)}function l2(c){return c=c.prototype,!(!c||!c.isReactComponent)}function aB(c){if(typeof c=="function")return l2(c)?1:0;if(c!=null){if(c=c.$$typeof,c===W)return 11;if(c===Me)return 14}return 2}function mc(c,d){var m=c.alternate;return m===null?(m=ca(c.tag,d,c.key,c.mode),m.elementType=c.elementType,m.type=c.type,m.stateNode=c.stateNode,m.alternate=c,c.alternate=m):(m.pendingProps=d,m.type=c.type,m.flags=0,m.subtreeFlags=0,m.deletions=null),m.flags=c.flags&14680064,m.childLanes=c.childLanes,m.lanes=c.lanes,m.child=c.child,m.memoizedProps=c.memoizedProps,m.memoizedState=c.memoizedState,m.updateQueue=c.updateQueue,d=c.dependencies,m.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext},m.sibling=c.sibling,m.index=c.index,m.ref=c.ref,m}function by(c,d,m,v,S,A){var G=2;if(v=c,typeof c=="function")l2(c)&&(G=1);else if(typeof c=="string")G=5;else e:switch(c){case k:return Ku(m.children,S,A,d);case C:G=8,S|=8;break;case M:return c=ca(12,m,d,S|2),c.elementType=M,c.lanes=A,c;case F:return c=ca(13,m,d,S),c.elementType=F,c.lanes=A,c;case Te:return c=ca(19,m,d,S),c.elementType=Te,c.lanes=A,c;case Re:return Ry(m,S,A,d);default:if(typeof c=="object"&&c!==null)switch(c.$$typeof){case j:G=10;break e;case O:G=9;break e;case W:G=11;break e;case Me:G=14;break e;case Le:G=16,v=null;break e}throw Error(t(130,c==null?c:typeof c,""))}return d=ca(G,m,d,S),d.elementType=c,d.type=v,d.lanes=A,d}function Ku(c,d,m,v){return c=ca(7,c,v,d),c.lanes=m,c}function Ry(c,d,m,v){return c=ca(22,c,v,d),c.elementType=Re,c.lanes=m,c.stateNode={isHidden:!1},c}function c2(c,d,m){return c=ca(6,c,null,d),c.lanes=m,c}function u2(c,d,m){return d=ca(4,c.children!==null?c.children:[],c.key,d),d.lanes=m,d.stateNode={containerInfo:c.containerInfo,pendingChildren:null,implementation:c.implementation},d}function oB(c,d,m,v,S){this.tag=d,this.containerInfo=c,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=q0(0),this.expirationTimes=q0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=q0(0),this.identifierPrefix=v,this.onRecoverableError=S,this.mutableSourceEagerHydrationData=null}function h2(c,d,m,v,S,A,G,J,ae){return c=new oB(c,d,m,J,ae),d===1?(d=1,A===!0&&(d|=8)):d=0,A=ca(3,null,null,d),c.current=A,A.stateNode=c,A.memoizedState={element:v,isDehydrated:m,cache:null,transitions:null,pendingSuspenseBoundaries:null},Tw(A),c}function lB(c,d,m){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:B,key:v==null?null:""+v,children:c,containerInfo:d,implementation:m}}function m4(c){if(!c)return ac;c=c._reactInternals;e:{if(Q(c)!==c||c.tag!==1)throw Error(t(170));var d=c;do{switch(d.tag){case 3:d=d.stateNode.context;break e;case 1:if(as(d.type)){d=d.stateNode.__reactInternalMemoizedMergedChildContext;break e}}d=d.return}while(d!==null);throw Error(t(171))}if(c.tag===1){var m=c.type;if(as(m))return zC(c,m,d)}return d}function p4(c,d,m,v,S,A,G,J,ae){return c=h2(m,v,!0,c,S,A,G,J,ae),c.context=m4(null),m=c.current,v=Ki(),S=fc(m),A=hl(v,S),A.callback=d??null,cc(m,A,S),c.current.lanes=S,ku(c,S,v),cs(c,v),c}function Cy(c,d,m,v){var S=d.current,A=Ki(),G=fc(S);return m=m4(m),d.context===null?d.context=m:d.pendingContext=m,d=hl(A,G),d.payload={element:c},v=v===void 0?null:v,v!==null&&(d.callback=v),c=cc(S,d,G),c!==null&&(Oa(c,S,G,A),ay(c,S,G)),G}function Py(c){if(c=c.current,!c.child)return null;switch(c.child.tag){case 5:return c.child.stateNode;default:return c.child.stateNode}}function y4(c,d){if(c=c.memoizedState,c!==null&&c.dehydrated!==null){var m=c.retryLane;c.retryLane=m!==0&&m<d?m:d}}function d2(c,d){y4(c,d),(c=c.alternate)&&y4(c,d)}function cB(){return null}var _4=typeof reportError=="function"?reportError:function(c){console.error(c)};function f2(c){this._internalRoot=c}ky.prototype.render=f2.prototype.render=function(c){var d=this._internalRoot;if(d===null)throw Error(t(409));Cy(c,d,null,null)},ky.prototype.unmount=f2.prototype.unmount=function(){var c=this._internalRoot;if(c!==null){this._internalRoot=null;var d=c.containerInfo;$u(function(){Cy(null,c,null,null)}),d[al]=null}};function ky(c){this._internalRoot=c}ky.prototype.unstable_scheduleHydration=function(c){if(c){var d=eg();c={blockedOn:null,target:c,priority:d};for(var m=0;m<Ms.length&&d!==0&&d<Ms[m].priority;m++);Ms.splice(m,0,c),m===0&&vd(c)}};function g2(c){return!(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)}function My(c){return!(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11&&(c.nodeType!==8||c.nodeValue!==" react-mount-point-unstable "))}function x4(){}function uB(c,d,m,v,S){if(S){if(typeof v=="function"){var A=v;v=function(){var Ee=Py(G);A.call(Ee)}}var G=p4(d,v,c,0,null,!1,!1,"",x4);return c._reactRootContainer=G,c[al]=G.current,dg(c.nodeType===8?c.parentNode:c),$u(),G}for(;S=c.lastChild;)c.removeChild(S);if(typeof v=="function"){var J=v;v=function(){var Ee=Py(ae);J.call(Ee)}}var ae=h2(c,0,!1,null,null,!1,!1,"",x4);return c._reactRootContainer=ae,c[al]=ae.current,dg(c.nodeType===8?c.parentNode:c),$u(function(){Cy(d,ae,m,v)}),ae}function Ny(c,d,m,v,S){var A=m._reactRootContainer;if(A){var G=A;if(typeof S=="function"){var J=S;S=function(){var ae=Py(G);J.call(ae)}}Cy(d,G,c,S)}else G=uB(m,d,c,S,v);return Py(G)}Q0=function(c){switch(c.tag){case 3:var d=c.stateNode;if(d.current.memoizedState.isDehydrated){var m=xn(d.pendingLanes);m!==0&&(Z0(d,m|1),cs(d,Ke()),(dn&6)===0&&(Kd=Ke()+500,oc()))}break;case 13:$u(function(){var v=ul(c,1);if(v!==null){var S=Ki();Oa(v,c,1,S)}}),d2(c,1)}},_d=function(c){if(c.tag===13){var d=ul(c,134217728);if(d!==null){var m=Ki();Oa(d,c,134217728,m)}d2(c,134217728)}},J0=function(c){if(c.tag===13){var d=fc(c),m=ul(c,d);if(m!==null){var v=Ki();Oa(m,c,d,v)}d2(c,d)}},eg=function(){return ln},tg=function(c,d){var m=ln;try{return ln=c,d()}finally{ln=m}},Ar=function(c,d,m){switch(d){case"input":if(De(c,m),d=m.name,m.type==="radio"&&d!=null){for(m=c;m.parentNode;)m=m.parentNode;for(m=m.querySelectorAll("input[name="+JSON.stringify(""+d)+'][type="radio"]'),d=0;d<m.length;d++){var v=m[d];if(v!==c&&v.form===c.form){var S=q1(v);if(!S)throw Error(t(90));gt(v),De(v,S)}}}break;case"textarea":Ot(c,m);break;case"select":d=m.value,d!=null&&R(c,!!m.multiple,d,!1)}},rs=s2,jr=$u;var hB={usingClientEntryPoint:!1,Events:[mg,Ld,q1,Ps,nr,s2]},Cg={findFiberByHostInstance:Du,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},dB={bundleType:Cg.bundleType,version:Cg.version,rendererPackageName:Cg.rendererPackageName,rendererConfig:Cg.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:N.ReactCurrentDispatcher,findHostInstanceByFiber:function(c){return c=xe(c),c===null?null:c.stateNode},findFiberByHostInstance:Cg.findFiberByHostInstance||cB,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ly=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ly.isDisabled&&Ly.supportsFiber)try{ks=Ly.inject(dB),vr=Ly}catch{}}return us.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=hB,us.createPortal=function(c,d){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!g2(d))throw Error(t(200));return lB(c,d,null,m)},us.createRoot=function(c,d){if(!g2(c))throw Error(t(299));var m=!1,v="",S=_4;return d!=null&&(d.unstable_strictMode===!0&&(m=!0),d.identifierPrefix!==void 0&&(v=d.identifierPrefix),d.onRecoverableError!==void 0&&(S=d.onRecoverableError)),d=h2(c,1,!1,null,null,m,!1,v,S),c[al]=d.current,dg(c.nodeType===8?c.parentNode:c),new f2(d)},us.findDOMNode=function(c){if(c==null)return null;if(c.nodeType===1)return c;var d=c._reactInternals;if(d===void 0)throw typeof c.render=="function"?Error(t(188)):(c=Object.keys(c).join(","),Error(t(268,c)));return c=xe(d),c=c===null?null:c.stateNode,c},us.flushSync=function(c){return $u(c)},us.hydrate=function(c,d,m){if(!My(d))throw Error(t(200));return Ny(null,c,d,!0,m)},us.hydrateRoot=function(c,d,m){if(!g2(c))throw Error(t(405));var v=m!=null&&m.hydratedSources||null,S=!1,A="",G=_4;if(m!=null&&(m.unstable_strictMode===!0&&(S=!0),m.identifierPrefix!==void 0&&(A=m.identifierPrefix),m.onRecoverableError!==void 0&&(G=m.onRecoverableError)),d=p4(d,null,c,1,m??null,S,!1,A,G),c[al]=d.current,dg(c),v)for(c=0;c<v.length;c++)m=v[c],S=m._getVersion,S=S(m._source),d.mutableSourceEagerHydrationData==null?d.mutableSourceEagerHydrationData=[m,S]:d.mutableSourceEagerHydrationData.push(m,S);return new ky(d)},us.render=function(c,d,m){if(!My(d))throw Error(t(200));return Ny(null,c,d,!1,m)},us.unmountComponentAtNode=function(c){if(!My(c))throw Error(t(40));return c._reactRootContainer?($u(function(){Ny(null,null,c,!1,function(){c._reactRootContainer=null,c[al]=null})}),!0):!1},us.unstable_batchedUpdates=s2,us.unstable_renderSubtreeIntoContainer=function(c,d,m,v){if(!My(m))throw Error(t(200));if(c==null||c._reactInternals===void 0)throw Error(t(38));return Ny(c,d,m,!1,v)},us.version="18.3.1-next-f1338f8080-20240426",us}var b4;function vB(){if(b4)return y2.exports;b4=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),y2.exports=xB(),y2.exports}var R4;function EB(){if(R4)return Oy;R4=1;var n=vB();return Oy.createRoot=n.createRoot,Oy.hydrateRoot=n.hydrateRoot,Oy}var wB=EB();const SB=BI(wB);var se=Lp();const TB=BI(se),fs={ADD:"add",REMOVE:"remove"},t0={PROPERTYCHANGE:"propertychange"},zt={CHANGE:"change",ERROR:"error",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",TOUCHMOVE:"touchmove",WHEEL:"wheel"};class Av{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function IB(n,e,t){let r,i;t=t||Il;let s=0,a=n.length,o=!1;for(;s<a;)r=s+(a-s>>1),i=+t(n[r],e),i<0?s=r+1:(a=r,o=!i);return o?s:~s}function Il(n,e){return n>e?1:n<e?-1:0}function AB(n,e){return n<e?1:n>e?-1:0}function bv(n,e,t){if(n[0]<=e)return 0;const r=n.length;if(e<=n[r-1])return r-1;if(typeof t=="function"){for(let i=1;i<r;++i){const s=n[i];if(s===e)return i;if(s<e)return t(e,n[i-1],s)>0?i-1:i}return r-1}if(t>0){for(let i=1;i<r;++i)if(n[i]<e)return i-1;return r-1}if(t<0){for(let i=1;i<r;++i)if(n[i]<=e)return i;return r-1}for(let i=1;i<r;++i){if(n[i]==e)return i;if(n[i]<e)return n[i-1]-e<e-n[i]?i-1:i}return r-1}function bB(n,e,t){for(;e<t;){const r=n[e];n[e]=n[t],n[t]=r,++e,--t}}function An(n,e){const t=Array.isArray(e)?e:[e],r=t.length;for(let i=0;i<r;i++)n[n.length]=t[i]}function vu(n,e){const t=n.length;if(t!==e.length)return!1;for(let r=0;r<t;r++)if(n[r]!==e[r])return!1;return!0}function RB(n,e,t){const r=e||Il;return n.every(function(i,s){if(s===0)return!0;const a=r(n[s-1],i);return!(a>0||a===0)})}function Bm(){return!0}function Rv(){return!1}function Um(){}function DO(n){let e,t,r;return function(){const i=Array.prototype.slice.call(arguments);return(!t||this!==r||!vu(i,t))&&(r=this,t=i,e=n.apply(this,arguments)),e}}function FO(n){function e(){let t;try{t=n()}catch(r){return Promise.reject(r)}return t instanceof Promise?t:Promise.resolve(t)}return e()}function Op(n){for(const e in n)delete n[e]}function Ph(n){let e;for(e in n)return!1;return!e}class qo{constructor(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}let Dp=class extends Av{constructor(e){super(),this.eventTarget_=e,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(e,t){if(!e||!t)return;const r=this.listeners_||(this.listeners_={}),i=r[e]||(r[e]=[]);i.includes(t)||i.push(t)}dispatchEvent(e){const t=typeof e=="string",r=t?e:e.type,i=this.listeners_&&this.listeners_[r];if(!i)return;const s=t?new qo(e):e;s.target||(s.target=this.eventTarget_||this);const a=this.dispatching_||(this.dispatching_={}),o=this.pendingRemovals_||(this.pendingRemovals_={});r in a||(a[r]=0,o[r]=0),++a[r];let l;for(let u=0,h=i.length;u<h;++u)if("handleEvent"in i[u]?l=i[u].handleEvent(s):l=i[u].call(this,s),l===!1||s.propagationStopped){l=!1;break}if(--a[r]===0){let u=o[r];for(delete o[r];u--;)this.removeEventListener(r,Um);delete a[r]}return l}disposeInternal(){this.listeners_&&Op(this.listeners_)}getListeners(e){return this.listeners_&&this.listeners_[e]||void 0}hasListener(e){return this.listeners_?e?e in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(e,t){if(!this.listeners_)return;const r=this.listeners_[e];if(!r)return;const i=r.indexOf(t);i!==-1&&(this.pendingRemovals_&&e in this.pendingRemovals_?(r[i]=Um,++this.pendingRemovals_[e]):(r.splice(i,1),r.length===0&&delete this.listeners_[e]))}};function hn(n,e,t,r,i){if(i){const a=t;t=function(o){return n.removeEventListener(e,t),a.call(r??this,o)}}else r&&r!==n&&(t=t.bind(r));const s={target:n,type:e,listener:t};return n.addEventListener(e,t),s}function q_(n,e,t,r){return hn(n,e,t,r,!0)}function Wn(n){n&&n.target&&(n.target.removeEventListener(n.type,n.listener),Op(n))}class Fp extends Dp{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(zt.CHANGE)}getRevision(){return this.revision_}onInternal(e,t){if(Array.isArray(e)){const r=e.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=hn(this,e[s],t);return i}return hn(this,e,t)}onceInternal(e,t){let r;if(Array.isArray(e)){const i=e.length;r=new Array(i);for(let s=0;s<i;++s)r[s]=q_(this,e[s],t)}else r=q_(this,e,t);return t.ol_key=r,r}unInternal(e,t){const r=t.ol_key;if(r)CB(r);else if(Array.isArray(e))for(let i=0,s=e.length;i<s;++i)this.removeEventListener(e[i],t);else this.removeEventListener(e,t)}}Fp.prototype.on;Fp.prototype.once;Fp.prototype.un;function CB(n){if(Array.isArray(n))for(let e=0,t=n.length;e<t;++e)Wn(n[e]);else Wn(n)}function Ft(){throw new Error("Unimplemented abstract method.")}let PB=0;function _n(n){return n.ol_uid||(n.ol_uid=String(++PB))}class C4 extends qo{constructor(e,t,r){super(e),this.key=t,this.oldValue=r}}class Zo extends Fp{constructor(e){super(),this.on,this.once,this.un,_n(this),this.values_=null,e!==void 0&&this.setProperties(e)}get(e){let t;return this.values_&&this.values_.hasOwnProperty(e)&&(t=this.values_[e]),t}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(e,t){let r;r=`change:${e}`,this.hasListener(r)&&this.dispatchEvent(new C4(r,e,t)),r=t0.PROPERTYCHANGE,this.hasListener(r)&&this.dispatchEvent(new C4(r,e,t))}addChangeListener(e,t){this.addEventListener(`change:${e}`,t)}removeChangeListener(e,t){this.removeEventListener(`change:${e}`,t)}set(e,t,r){const i=this.values_||(this.values_={});if(r)i[e]=t;else{const s=i[e];i[e]=t,s!==t&&this.notify(e,s)}}setProperties(e,t){for(const r in e)this.set(r,e[r],t)}applyProperties(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}unset(e,t){if(this.values_&&e in this.values_){const r=this.values_[e];delete this.values_[e],Ph(this.values_)&&(this.values_=null),t||this.notify(e,r)}}}const P4={LENGTH:"length"};class Dy extends qo{constructor(e,t,r){super(e),this.element=t,this.index=r}}class ya extends Zo{constructor(e,t){if(super(),this.on,this.once,this.un,t=t||{},this.unique_=!!t.unique,this.array_=e??[],this.unique_)for(let r=1,i=this.array_.length;r<i;++r)this.assertUnique_(this.array_[r],r);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(e){for(let t=0,r=e.length;t<r;++t)this.push(e[t]);return this}forEach(e){const t=this.array_;for(let r=0,i=t.length;r<i;++r)e(t[r],r,t)}getArray(){return this.array_}item(e){return this.array_[e]}getLength(){return this.get(P4.LENGTH)}insertAt(e,t){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t),this.array_.splice(e,0,t),this.updateLength_(),this.dispatchEvent(new Dy(fs.ADD,t,e))}pop(){return this.removeAt(this.getLength()-1)}push(e){const t=this.getLength();return this.insertAt(t,e),this.getLength()}remove(e){const t=this.array_;for(let r=0,i=t.length;r<i;++r)if(t[r]===e)return this.removeAt(r)}removeAt(e){if(e<0||e>=this.getLength())return;const t=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new Dy(fs.REMOVE,t,e)),t}setAt(e,t){const r=this.getLength();if(e>=r){this.insertAt(e,t);return}if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t,e);const i=this.array_[e];this.array_[e]=t,this.dispatchEvent(new Dy(fs.REMOVE,i,e)),this.dispatchEvent(new Dy(fs.ADD,t,e))}updateLength_(){this.set(P4.LENGTH,this.array_.length)}assertUnique_(e,t){const r=this.array_;for(let i=0,s=r.length;i<s;++i)if(r[i]===e&&i!==t)throw new Error("Duplicate item added to a unique collection")}}function Cn(n,e){if(!n)throw new Error(e)}let eo=class jO extends Zo{constructor(e){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),e)if(typeof e.getSimplifiedGeometry=="function"){const t=e;this.setGeometry(t)}else{const t=e;this.setProperties(t)}}clone(){const e=new jO(this.hasProperties()?this.getProperties():null);e.setGeometryName(this.getGeometryName());const t=this.getGeometry();t&&e.setGeometry(t.clone());const r=this.getStyle();return r&&e.setStyle(r),e}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(Wn(this.geometryChangeKey_),this.geometryChangeKey_=null);const e=this.getGeometry();e&&(this.geometryChangeKey_=hn(e,zt.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(e){this.set(this.geometryName_,e)}setStyle(e){this.style_=e,this.styleFunction_=e?kB(e):void 0,this.changed()}setId(e){this.id_=e,this.changed()}setGeometryName(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}};function kB(n){if(typeof n=="function")return n;let e;return Array.isArray(n)?e=n:(Cn(typeof n.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[n]),function(){return e}}const ei={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function k4(n){const e=Zs();for(let t=0,r=n.length;t<r;++t)um(e,n[t]);return e}function zm(n,e,t){return t?(t[0]=n[0]-e,t[1]=n[1]-e,t[2]=n[2]+e,t[3]=n[3]+e,t):[n[0]-e,n[1]-e,n[2]+e,n[3]+e]}function VO(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n.slice()}function td(n,e,t){let r,i;return e<n[0]?r=n[0]-e:n[2]<e?r=e-n[2]:r=0,t<n[1]?i=n[1]-t:n[3]<t?i=t-n[3]:i=0,r*r+i*i}function kh(n,e){return UI(n,e[0],e[1])}function Fc(n,e){return n[0]<=e[0]&&e[2]<=n[2]&&n[1]<=e[1]&&e[3]<=n[3]}function UI(n,e,t){return n[0]<=e&&e<=n[2]&&n[1]<=t&&t<=n[3]}function KS(n,e){const t=n[0],r=n[1],i=n[2],s=n[3],a=e[0],o=e[1];let l=ei.UNKNOWN;return a<t?l=l|ei.LEFT:a>i&&(l=l|ei.RIGHT),o<r?l=l|ei.BELOW:o>s&&(l=l|ei.ABOVE),l===ei.UNKNOWN&&(l=ei.INTERSECTING),l}function Zs(){return[1/0,1/0,-1/0,-1/0]}function ru(n,e,t,r,i){return i?(i[0]=n,i[1]=e,i[2]=t,i[3]=r,i):[n,e,t,r]}function jp(n){return ru(1/0,1/0,-1/0,-1/0,n)}function GO(n,e){const t=n[0],r=n[1];return ru(t,r,t,r,e)}function zI(n,e,t,r,i){const s=jp(i);return UO(s,n,e,t,r)}function n0(n,e){return n[0]==e[0]&&n[2]==e[2]&&n[1]==e[1]&&n[3]==e[3]}function BO(n,e){return e[0]<n[0]&&(n[0]=e[0]),e[2]>n[2]&&(n[2]=e[2]),e[1]<n[1]&&(n[1]=e[1]),e[3]>n[3]&&(n[3]=e[3]),n}function um(n,e){e[0]<n[0]&&(n[0]=e[0]),e[0]>n[2]&&(n[2]=e[0]),e[1]<n[1]&&(n[1]=e[1]),e[1]>n[3]&&(n[3]=e[1])}function UO(n,e,t,r,i){for(;t<r;t+=i)MB(n,e[t],e[t+1]);return n}function MB(n,e,t){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}function zO(n,e){let t;return t=e(Cv(n)),t||(t=e(Pv(n)),t)||(t=e(kv(n)),t)||(t=e(nd(n)),t)?t:!1}function YS(n){let e=0;return C0(n)||(e=tn(n)*Mr(n)),e}function Cv(n){return[n[0],n[1]]}function Pv(n){return[n[2],n[1]]}function Bo(n){return[(n[0]+n[2])/2,(n[1]+n[3])/2]}function NB(n,e){let t;if(e==="bottom-left")t=Cv(n);else if(e==="bottom-right")t=Pv(n);else if(e==="top-left")t=nd(n);else if(e==="top-right")t=kv(n);else throw new Error("Invalid corner");return t}function Z_(n,e,t,r,i){const[s,a,o,l,u,h,f,g]=$O(n,e,t,r);return ru(Math.min(s,o,u,f),Math.min(a,l,h,g),Math.max(s,o,u,f),Math.max(a,l,h,g),i)}function $O(n,e,t,r){const i=e*r[0]/2,s=e*r[1]/2,a=Math.cos(t),o=Math.sin(t),l=i*a,u=i*o,h=s*a,f=s*o,g=n[0],p=n[1];return[g-l+f,p-u-h,g-l-f,p-u+h,g+l-f,p+u+h,g+l+f,p+u-h,g-l+f,p-u-h]}function Mr(n){return n[3]-n[1]}function Al(n,e,t){const r=t||Zs();return Qi(n,e)?(n[0]>e[0]?r[0]=n[0]:r[0]=e[0],n[1]>e[1]?r[1]=n[1]:r[1]=e[1],n[2]<e[2]?r[2]=n[2]:r[2]=e[2],n[3]<e[3]?r[3]=n[3]:r[3]=e[3]):jp(r),r}function nd(n){return[n[0],n[3]]}function kv(n){return[n[2],n[3]]}function tn(n){return n[2]-n[0]}function Qi(n,e){return n[0]<=e[2]&&n[2]>=e[0]&&n[1]<=e[3]&&n[3]>=e[1]}function C0(n){return n[2]<n[0]||n[3]<n[1]}function LB(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n}function OB(n,e,t){let r=!1;const i=KS(n,e),s=KS(n,t);if(i===ei.INTERSECTING||s===ei.INTERSECTING)r=!0;else{const a=n[0],o=n[1],l=n[2],u=n[3],h=e[0],f=e[1],g=t[0],p=t[1],E=(p-f)/(g-h);let x,w;s&ei.ABOVE&&!(i&ei.ABOVE)&&(x=g-(p-u)/E,r=x>=a&&x<=l),!r&&s&ei.RIGHT&&!(i&ei.RIGHT)&&(w=p-(g-l)*E,r=w>=o&&w<=u),!r&&s&ei.BELOW&&!(i&ei.BELOW)&&(x=g-(p-o)/E,r=x>=a&&x<=l),!r&&s&ei.LEFT&&!(i&ei.LEFT)&&(w=p-(g-a)*E,r=w>=o&&w<=u)}return r}function WO(n,e){const t=e.getExtent(),r=Bo(n);if(e.canWrapX()&&(r[0]<t[0]||r[0]>=t[2])){const i=tn(t),a=Math.floor((r[0]-t[0])/i)*i;n[0]-=a,n[2]-=a}return n}function HO(n,e,t){if(e.canWrapX()){const r=e.getExtent();if(!isFinite(n[0])||!isFinite(n[2]))return[[r[0],n[1],r[2],n[3]]];WO(n,e);const i=tn(r);if(tn(n)>i&&!t)return[[r[0],n[1],r[2],n[3]]];if(n[0]<r[0])return[[n[0]+i,n[1],r[2],n[3]],[r[0],n[1],n[2],n[3]]];if(n[2]>r[2])return[[n[0],n[1],r[2],n[3]],[r[0],n[1],n[2]-i,n[3]]]}return[n]}function Yn(n,e,t){return Math.min(Math.max(n,e),t)}function DB(n,e,t,r,i,s){const a=i-t,o=s-r;if(a!==0||o!==0){const l=((n-t)*a+(e-r)*o)/(a*a+o*o);l>1?(t=i,r=s):l>0&&(t+=a*l,r+=o*l)}return wh(n,e,t,r)}function wh(n,e,t,r){const i=t-n,s=r-e;return i*i+s*s}function FB(n){const e=n.length;for(let r=0;r<e;r++){let i=r,s=Math.abs(n[r][r]);for(let o=r+1;o<e;o++){const l=Math.abs(n[o][r]);l>s&&(s=l,i=o)}if(s===0)return null;const a=n[i];n[i]=n[r],n[r]=a;for(let o=r+1;o<e;o++){const l=-n[o][r]/n[r][r];for(let u=r;u<e+1;u++)r==u?n[o][u]=0:n[o][u]+=l*n[r][u]}}const t=new Array(e);for(let r=e-1;r>=0;r--){t[r]=n[r][e]/n[r][r];for(let i=r-1;i>=0;i--)n[i][e]-=n[i][r]*t[r]}return t}function M4(n){return n*180/Math.PI}function bl(n){return n*Math.PI/180}function Yc(n,e){const t=n%e;return t*e<0?t+e:t}function Us(n,e,t){return n+t*(e-n)}function Vp(n,e){const t=Math.pow(10,e);return Math.round(n*t)/t}function Q_(n,e){return Math.round(Vp(n,e))}function Fy(n,e){return Math.floor(Vp(n,e))}function jc(n,e){return Math.ceil(Vp(n,e))}function XS(n,e,t){if(n>=e&&n<t)return n;const r=t-e;return((n-e)%r+r)%r+e}function kg(n,e,t){const r=""+n;let i=r.indexOf(".");return i=i===-1?r.length:i,i>e?r:new Array(1+e-i).join("0")+r}function KO(n,e){const t=(""+n).split("."),r=(""+e).split(".");for(let i=0;i<Math.max(t.length,r.length);i++){const s=parseInt(t[i]||"0",10),a=parseInt(r[i]||"0",10);if(s>a)return 1;if(a>s)return-1}return 0}function jB(n,e){return n[0]+=+e[0],n[1]+=+e[1],n}function J_(n,e){let t=!0;for(let r=n.length-1;r>=0;--r)if(n[r]!=e[r]){t=!1;break}return t}function $I(n,e){const t=Math.cos(e),r=Math.sin(e),i=n[0]*t-n[1]*r,s=n[1]*t+n[0]*r;return n[0]=i,n[1]=s,n}function VB(n,e){return n[0]*=e,n[1]*=e,n}function YO(n,e){if(e.canWrapX()){const t=tn(e.getExtent()),r=XO(n,e,t);r&&(n[0]-=r*t)}return n}function XO(n,e,t){const r=e.getExtent();let i=0;return e.canWrapX()&&(n[0]<r[0]||n[0]>r[2])&&(t=t||tn(r),i=Math.floor((n[0]-r[0])/t)),i}function qO(...n){console.warn(...n)}const r0={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};let Mv=class{constructor(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||r0[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(e){this.defaultTileGrid_=e}setExtent(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)}setWorldExtent(e){this.worldExtent_=e}setGetPointResolution(e){this.getPointResolutionFunc_=e}getPointResolutionFunc(){return this.getPointResolutionFunc_}};const Gp=6378137,Af=Math.PI*Gp,GB=[-Af,-Af,Af,Af],BB=[-180,-85,180,85],jy=Gp*Math.log(Math.tan(Math.PI/2));class Xd extends Mv{constructor(e){super({code:e,units:"m",extent:GB,global:!0,worldExtent:BB,getPointResolution:function(t,r){return t/Math.cosh(r[1]/Gp)}})}}const N4=[new Xd("EPSG:3857"),new Xd("EPSG:102100"),new Xd("EPSG:102113"),new Xd("EPSG:900913"),new Xd("http://www.opengis.net/def/crs/EPSG/0/3857"),new Xd("http://www.opengis.net/gml/srs/epsg.xml#3857")];function UB(n,e,t,r){const i=n.length;t=t>1?t:2,r=r??t,e===void 0&&(t>2?e=n.slice():e=new Array(i));for(let s=0;s<i;s+=r){e[s]=Af*n[s]/180;let a=Gp*Math.log(Math.tan(Math.PI*(+n[s+1]+90)/360));a>jy?a=jy:a<-jy&&(a=-jy),e[s+1]=a}return e}function zB(n,e,t,r){const i=n.length;t=t>1?t:2,r=r??t,e===void 0&&(t>2?e=n.slice():e=new Array(i));for(let s=0;s<i;s+=r)e[s]=180*n[s]/Af,e[s+1]=360*Math.atan(Math.exp(n[s+1]/Gp))/Math.PI-90;return e}const $B=6378137,L4=[-180,-90,180,90],WB=Math.PI*$B/180;class Yu extends Mv{constructor(e,t){super({code:e,units:"degrees",extent:L4,axisOrientation:t,global:!0,metersPerUnit:WB,worldExtent:L4})}}const O4=[new Yu("CRS:84"),new Yu("EPSG:4326","neu"),new Yu("urn:ogc:def:crs:OGC:1.3:CRS84"),new Yu("urn:ogc:def:crs:OGC:2:84"),new Yu("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new Yu("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Yu("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let qS={};function w_(n){return qS[n]||qS[n.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function HB(n,e){qS[n]=e}let Ff={};function Mh(n,e,t){const r=n.getCode(),i=e.getCode();r in Ff||(Ff[r]={}),Ff[r][i]=t}function S_(n,e){return n in Ff&&e in Ff[n]?Ff[n][e]:null}const ex=.9996,Ea=.00669438,Nv=Ea*Ea,Lv=Nv*Ea,fh=Ea/(1-Ea),D4=Math.sqrt(1-Ea),i0=(1-D4)/(1+D4),ZO=i0*i0,WI=ZO*i0,HI=WI*i0,QO=HI*i0,JO=1-Ea/4-3*Nv/64-5*Lv/256,KB=3*Ea/8+3*Nv/32+45*Lv/1024,YB=15*Nv/256+45*Lv/1024,XB=35*Lv/3072,qB=3/2*i0-27/32*WI+269/512*QO,ZB=21/16*ZO-55/32*HI,QB=151/96*WI-417/128*QO,JB=1097/512*HI,tx=6378137;function eU(n,e,t){const r=n-5e5,a=(t.north?e:e-1e7)/ex/(tx*JO),o=a+qB*Math.sin(2*a)+ZB*Math.sin(4*a)+QB*Math.sin(6*a)+JB*Math.sin(8*a),l=Math.sin(o),u=l*l,h=Math.cos(o),f=l/h,g=f*f,p=g*g,E=1-Ea*u,x=Math.sqrt(1-Ea*u),w=tx/x,T=(1-Ea)/E,I=fh*h**2,P=I*I,N=r/(w*ex),D=N*N,B=D*N,k=B*N,C=k*N,M=C*N,j=o-f/T*(D/2-k/24*(5+3*g+10*I-4*P-9*fh))+M/720*(61+90*g+298*I+45*p-252*fh-3*P);let O=(N-B/6*(1+2*g+I)+C/120*(5-2*I+28*g-3*P+8*fh+24*p))/h;return O=XS(O+bl(e5(t.number)),-Math.PI,Math.PI),[M4(O),M4(j)]}const F4=-80,j4=84,tU=-180,nU=180;function rU(n,e,t){n=XS(n,tU,nU),e<F4?e=F4:e>j4&&(e=j4);const r=bl(e),i=Math.sin(r),s=Math.cos(r),a=i/s,o=a*a,l=o*o,u=bl(n),h=e5(t.number),f=bl(h),g=tx/Math.sqrt(1-Ea*i**2),p=fh*s**2,E=s*XS(u-f,-Math.PI,Math.PI),x=E*E,w=x*E,T=w*E,I=T*E,P=I*E,N=tx*(JO*r-KB*Math.sin(2*r)+YB*Math.sin(4*r)-XB*Math.sin(6*r)),D=ex*g*(E+w/6*(1-o+p)+I/120*(5-18*o+l+72*p-58*fh))+5e5;let B=ex*(N+g*a*(x/2+T/24*(5-o+9*p+4*p**2)+P/720*(61-58*o+l+600*p-330*fh)));return t.north||(B+=1e7),[D,B]}function e5(n){return(n-1)*6-180+3}const iU=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function t5(n){let e=0;for(const i of iU){const s=n.match(i);if(s){e=parseInt(s[1]);break}}if(!e)return null;let t=0,r=!1;return e>32700&&e<32761?t=e-32700:e>32600&&e<32661&&(r=!0,t=e-32600),t?{number:t,north:r}:null}function V4(n,e){return function(t,r,i,s){const a=t.length;i=i>1?i:2,s=s??i,r||(i>2?r=t.slice():r=new Array(a));for(let o=0;o<a;o+=s){const l=t[o],u=t[o+1],h=n(l,u,e);r[o]=h[0],r[o+1]=h[1]}return r}}function sU(n){return t5(n)?new Mv({code:n,units:"m"}):null}function aU(n){const e=t5(n.getCode());return e?{forward:V4(rU,e),inverse:V4(eU,e)}:null}const oU=63710088e-1;function G4(n,e,t){t=t||oU;const r=bl(n[1]),i=bl(e[1]),s=(i-r)/2,a=bl(e[0]-n[0])/2,o=Math.sin(s)*Math.sin(s)+Math.sin(a)*Math.sin(a)*Math.cos(r)*Math.cos(i);return 2*t*Math.atan2(Math.sqrt(o),Math.sqrt(1-o))}const lU=[aU],cU=[sU];let ZS=!0;function n5(n){ZS=!1}function KI(n,e){if(e!==void 0){for(let t=0,r=n.length;t<r;++t)e[t]=n[t];e=e}else e=n.slice();return e}function nx(n){HB(n.getCode(),n),Mh(n,n,KI)}function uU(n){n.forEach(nx)}function Bn(n){if(typeof n!="string")return n;const e=w_(n);if(e)return e;for(const t of cU){const r=t(n);if(r)return r}return null}function rx(n,e,t,r){n=Bn(n);let i;const s=n.getPointResolutionFunc();if(s){if(i=s(e,t),r&&r!==n.getUnits()){const a=n.getMetersPerUnit();a&&(i=i*a/r0[r])}}else{const a=n.getUnits();if(a=="degrees"&&!r||r=="degrees")i=e;else{const o=XI(n,Bn("EPSG:4326"));if(!o&&a!=="degrees")i=e*n.getMetersPerUnit();else{let u=[t[0]-e/2,t[1],t[0]+e/2,t[1],t[0],t[1]-e/2,t[0],t[1]+e/2];u=o(u,u,2);const h=G4(u.slice(0,2),u.slice(2,4)),f=G4(u.slice(4,6),u.slice(6,8));i=(h+f)/2}const l=r?r0[r]:n.getMetersPerUnit();l!==void 0&&(i/=l)}}return i}function QS(n){uU(n),n.forEach(function(e){n.forEach(function(t){e!==t&&Mh(e,t,KI)})})}function hU(n,e,t,r){n.forEach(function(i){e.forEach(function(s){Mh(i,s,t),Mh(s,i,r)})})}function YI(n,e){return n?typeof n=="string"?Bn(n):n:Bn(e)}function JS(n){return(function(e,t,r,i){const s=e.length;r=r!==void 0?r:2,i=i??r,t=t!==void 0?t:new Array(s);for(let a=0;a<s;a+=i){const o=n(e.slice(a,a+r)),l=o.length;for(let u=0,h=i;u<h;++u)t[a+u]=u>=l?e[a+u]:o[u]}return t})}function dU(n,e,t,r){const i=Bn(n),s=Bn(e);Mh(i,s,JS(t)),Mh(s,i,JS(r))}function Nh(n,e){return n5(),Bp(n,"EPSG:4326","EPSG:3857")}function fn(n,e){const t=Bp(n,"EPSG:3857","EPSG:4326"),r=t[0];return(r<-180||r>180)&&(t[0]=Yc(r+180,360)-180),t}function Sh(n,e){if(n===e)return!0;const t=n.getUnits()===e.getUnits();return(n.getCode()===e.getCode()||XI(n,e)===KI)&&t}function XI(n,e){const t=n.getCode(),r=e.getCode();let i=S_(t,r);if(i)return i;let s=null,a=null;for(const l of lU)s||(s=l(n)),a||(a=l(e));if(!s&&!a)return null;const o="EPSG:4326";if(a)if(s)i=v2(s.inverse,a.forward);else{const l=S_(t,o);l&&(i=v2(l,a.forward))}else{const l=S_(o,r);l&&(i=v2(s.inverse,l))}return i&&(nx(n),nx(e),Mh(n,e,i)),i}function v2(n,e){return function(t,r,i,s){return r=n(t,r,i,s),e(r,r,i,s)}}function $m(n,e){const t=Bn(n),r=Bn(e);return XI(t,r)}function Bp(n,e,t){const r=$m(e,t);if(!r){const i=Bn(e).getCode(),s=Bn(t).getCode();throw new Error(`No transform available between ${i} and ${s}`)}return r(n,void 0,n.length)}function eT(n,e){return n}function yl(n,e){return ZS&&!J_(n,[0,0])&&n[0]>=-180&&n[0]<=180&&n[1]>=-90&&n[1]<=90&&(ZS=!1,qO("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),n}function r5(n,e){return n}function Co(n,e){return n}function B4(n,e,t){return function(r){let i,s;if(n.canWrapX()){const a=n.getExtent(),o=tn(a);r=r.slice(0),s=XO(r,n,o),s&&(r[0]=r[0]-s*o),r[0]=Yn(r[0],a[0],a[2]),r[1]=Yn(r[1],a[1],a[3]),i=t(r)}else i=t(r);return s&&e.canWrapX()&&(i[0]+=s*tn(e.getExtent())),i}}function fU(){QS(N4),QS(O4),hU(O4,N4,UB,zB)}fU();new Array(6);function Xa(){return[1,0,0,1,0,0]}function gU(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n}function Wr(n,e){const t=e[0],r=e[1];return e[0]=n[0]*t+n[2]*r+n[4],e[1]=n[1]*t+n[3]*r+n[5],e}function Uo(n,e,t,r,i,s,a,o){const l=Math.sin(s),u=Math.cos(s);return n[0]=r*u,n[1]=i*l,n[2]=-r*l,n[3]=i*u,n[4]=a*r*u-o*r*l+e,n[5]=a*i*l+o*i*u+t,n}function i5(n,e){const t=mU(e);Cn(t!==0,"Transformation matrix cannot be inverted");const r=e[0],i=e[1],s=e[2],a=e[3],o=e[4],l=e[5];return n[0]=a/t,n[1]=-i/t,n[2]=-s/t,n[3]=r/t,n[4]=(s*l-a*o)/t,n[5]=-(r*l-i*o)/t,n}function mU(n){return n[0]*n[3]-n[1]*n[2]}const pU=[1e5,1e5,1e5,1e5,2,2];function yU(n){return"matrix("+n.join(", ")+")"}function tT(n){return n.substring(7,n.length-1).split(",").map(parseFloat)}function _U(n,e){const t=tT(n),r=tT(e);for(let i=0;i<6;++i)if(Math.round((t[i]-r[i])*pU[i])!==0)return!1;return!0}function Xc(n,e,t,r,i,s,a){s=s||[],a=a||2;let o=0;for(let l=e;l<t;l+=r){const u=n[l],h=n[l+1];s[o++]=i[0]*u+i[2]*h+i[4],s[o++]=i[1]*u+i[3]*h+i[5];for(let f=2;f<a;f++)s[o++]=n[l+f]}return s&&s.length!=o&&(s.length=o),s}function s5(n,e,t,r,i,s,a){a=a||[];const o=Math.cos(i),l=Math.sin(i),u=s[0],h=s[1];let f=0;for(let g=e;g<t;g+=r){const p=n[g]-u,E=n[g+1]-h;a[f++]=u+p*o-E*l,a[f++]=h+p*l+E*o;for(let x=g+2;x<g+r;++x)a[f++]=n[x]}return a&&a.length!=f&&(a.length=f),a}function xU(n,e,t,r,i,s,a,o){o=o||[];const l=a[0],u=a[1];let h=0;for(let f=e;f<t;f+=r){const g=n[f]-l,p=n[f+1]-u;o[h++]=l+i*g,o[h++]=u+s*p;for(let E=f+2;E<f+r;++E)o[h++]=n[E]}return o&&o.length!=h&&(o.length=h),o}function vU(n,e,t,r,i,s,a){a=a||[];let o=0;for(let l=e;l<t;l+=r){a[o++]=n[l]+i,a[o++]=n[l+1]+s;for(let u=l+2;u<l+r;++u)a[o++]=n[u]}return a&&a.length!=o&&(a.length=o),a}const U4=Xa(),EU=[NaN,NaN];class a5 extends Zo{constructor(){super(),this.extent_=Zs(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=DO((e,t,r)=>{if(!r)return this.getSimplifiedGeometry(t);const i=this.clone();return i.applyTransform(r),i.getSimplifiedGeometry(t)})}simplifyTransformed(e,t){return this.simplifyTransformedInternal(this.getRevision(),e,t)}clone(){return Ft()}closestPointXY(e,t,r,i){return Ft()}containsXY(e,t){return this.closestPointXY(e,t,EU,Number.MIN_VALUE)===0}getClosestPoint(e,t){return t=t||[NaN,NaN],this.closestPointXY(e[0],e[1],t,1/0),t}intersectsCoordinate(e){return this.containsXY(e[0],e[1])}computeExtent(e){return Ft()}getExtent(e){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&jp(t),this.extentRevision_=this.getRevision()}return LB(this.extent_,e)}rotate(e,t){Ft()}scale(e,t,r){Ft()}simplify(e){return this.getSimplifiedGeometry(e*e)}getSimplifiedGeometry(e){return Ft()}getType(){return Ft()}applyTransform(e){Ft()}intersectsExtent(e){return Ft()}translate(e,t){Ft()}transform(e,t){const r=Bn(e),i=r.getUnits()=="tile-pixels"?function(s,a,o){const l=r.getExtent(),u=r.getWorldExtent(),h=Mr(u)/Mr(l);Uo(U4,u[0],u[3],h,-h,0,0,0);const f=Xc(s,0,s.length,o,U4,a),g=$m(r,t);return g?g(f,f,o):f}:$m(r,t);return this.applyTransform(i),this}}class rd extends a5{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(e){return zI(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinates(){return Ft()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=this.getSimplifiedGeometryInternal(e);return t.getFlatCoordinates().length<this.flatCoordinates.length?t:(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getSimplifiedGeometryInternal(e){return this}getStride(){return this.stride}setFlatCoordinates(e,t){this.stride=z4(e),this.layout=e,this.flatCoordinates=t}setCoordinates(e,t){Ft()}setLayout(e,t,r){let i;if(e)i=z4(e);else{for(let s=0;s<r;++s){if(t.length===0){this.layout="XY",this.stride=2;return}t=t[0]}i=t.length,e=id(i)}this.layout=e,this.stride=i}applyTransform(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(e,t){const r=this.getFlatCoordinates();if(r){const i=this.getStride();s5(r,0,r.length,i,e,t,r),this.changed()}}scale(e,t,r){t===void 0&&(t=e),r||(r=Bo(this.getExtent()));const i=this.getFlatCoordinates();if(i){const s=this.getStride();xU(i,0,i.length,s,e,t,r,i),this.changed()}}translate(e,t){const r=this.getFlatCoordinates();if(r){const i=this.getStride();vU(r,0,r.length,i,e,t,r),this.changed()}}}function id(n){let e;return n==2?e="XY":n==3?e="XYZ":n==4&&(e="XYZM"),e}function z4(n){let e;return n=="XY"?e=2:n=="XYZ"||n=="XYM"?e=3:n=="XYZM"&&(e=4),e}function wU(n,e,t){const r=n.getFlatCoordinates();if(!r)return null;const i=n.getStride();return Xc(r,0,r.length,i,e,t)}function $4(n,e,t,r,i,s,a){const o=n[e],l=n[e+1],u=n[t]-o,h=n[t+1]-l;let f;if(u===0&&h===0)f=e;else{const g=((i-o)*u+(s-l)*h)/(u*u+h*h);if(g>1)f=t;else if(g>0){for(let p=0;p<r;++p)a[p]=Us(n[e+p],n[t+p],g);a.length=r;return}else f=e}for(let g=0;g<r;++g)a[g]=n[f+g];a.length=r}function qI(n,e,t,r,i){let s=n[e],a=n[e+1];for(e+=r;e<t;e+=r){const o=n[e],l=n[e+1],u=wh(s,a,o,l);u>i&&(i=u),s=o,a=l}return i}function ZI(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){const o=t[s];i=qI(n,e,o,r,i),e=o}return i}function SU(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){const o=t[s];i=ZI(n,e,o,r,i),e=o[o.length-1]}return i}function QI(n,e,t,r,i,s,a,o,l,u,h){if(e==t)return u;let f,g;if(i===0){if(g=wh(a,o,n[e],n[e+1]),g<u){for(f=0;f<r;++f)l[f]=n[e+f];return l.length=r,g}return u}h=h||[NaN,NaN];let p=e+r;for(;p<t;)if($4(n,p-r,p,r,a,o,h),g=wh(a,o,h[0],h[1]),g<u){for(u=g,f=0;f<r;++f)l[f]=h[f];l.length=r,p+=r}else p+=r*Math.max((Math.sqrt(g)-Math.sqrt(u))/i|0,1);if(s&&($4(n,t-r,e,r,a,o,h),g=wh(a,o,h[0],h[1]),g<u)){for(u=g,f=0;f<r;++f)l[f]=h[f];l.length=r}return u}function JI(n,e,t,r,i,s,a,o,l,u,h){h=h||[NaN,NaN];for(let f=0,g=t.length;f<g;++f){const p=t[f];u=QI(n,e,p,r,i,s,a,o,l,u,h),e=p}return u}function TU(n,e,t,r,i,s,a,o,l,u,h){h=h||[NaN,NaN];for(let f=0,g=t.length;f<g;++f){const p=t[f];u=JI(n,e,p,r,i,s,a,o,l,u,h),e=p[p.length-1]}return u}function IU(n,e,t,r){for(let i=0,s=t.length;i<s;++i)n[e++]=t[i];return e}function Ov(n,e,t,r){for(let i=0,s=t.length;i<s;++i){const a=t[i];for(let o=0;o<r;++o)n[e++]=a[o]}return e}function Up(n,e,t,r,i){i=i||[];let s=0;for(let a=0,o=t.length;a<o;++a){const l=Ov(n,e,t[a],r);i[s++]=l,e=l}return i.length=s,i}function o5(n,e,t,r,i){i=i||[];let s=0;for(let a=0,o=t.length;a<o;++a){const l=Up(n,e,t[a],r,i[s]);l.length===0&&(l[0]=e),i[s++]=l,e=l[l.length-1]}return i.length=s,i}function Vc(n,e,t,r,i){i=i!==void 0?i:[];let s=0;for(let a=e;a<t;a+=r)i[s++]=n.slice(a,a+r);return i.length=s,i}function Wm(n,e,t,r,i){i=i!==void 0?i:[];let s=0;for(let a=0,o=t.length;a<o;++a){const l=t[a];i[s++]=Vc(n,e,l,r,i[s]),e=l}return i.length=s,i}function nT(n,e,t,r,i){i=i!==void 0?i:[];let s=0;for(let a=0,o=t.length;a<o;++a){const l=t[a];i[s++]=l.length===1&&l[0]===e?[]:Wm(n,e,l,r,i[s]),e=l[l.length-1]}return i.length=s,i}function ix(n,e,t,r,i,s,a){let o,l;const u=(t-e)/r;if(u===1)o=e;else if(u===2)o=e,l=i;else if(u!==0){let h=n[e],f=n[e+1],g=0;const p=[0];for(let w=e+r;w<t;w+=r){const T=n[w],I=n[w+1];g+=Math.sqrt((T-h)*(T-h)+(I-f)*(I-f)),p.push(g),h=T,f=I}const E=i*g,x=IB(p,E);x<0?(l=(E-p[-x-2])/(p[-x-1]-p[-x-2]),o=e+(-x-2)*r):o=e+x*r}a=a>1?a:2,s=s||new Array(a);for(let h=0;h<a;++h)s[h]=o===void 0?NaN:l===void 0?n[o+h]:Us(n[o+h],n[o+r+h],l);return s}function rT(n,e,t,r,i,s){if(t==e)return null;let a;if(i<n[e+r-1])return s?(a=n.slice(e,e+r),a[r-1]=i,a):null;if(n[t-1]<i)return s?(a=n.slice(t-r,t),a[r-1]=i,a):null;if(i==n[e+r-1])return n.slice(e,e+r);let o=e/r,l=t/r;for(;o<l;){const g=o+l>>1;i<n[(g+1)*r-1]?l=g:o=g+1}const u=n[o*r-1];if(i==u)return n.slice((o-1)*r,(o-1)*r+r);const h=n[(o+1)*r-1],f=(i-u)/(h-u);a=[];for(let g=0;g<r-1;++g)a.push(Us(n[(o-1)*r+g],n[o*r+g],f));return a.push(i),a}function AU(n,e,t,r,i,s,a){if(a)return rT(n,e,t[t.length-1],r,i,s);let o;if(i<n[r-1])return s?(o=n.slice(0,r),o[r-1]=i,o):null;if(n[n.length-1]<i)return s?(o=n.slice(n.length-r),o[r-1]=i,o):null;for(let l=0,u=t.length;l<u;++l){const h=t[l];if(e!=h){if(i<n[e+r-1])return null;if(i<=n[h-1])return rT(n,e,h,r,i,!1);e=h}}return null}function bU(n,e,t,r,i){return!zO(i,function(a){return!gh(n,e,t,r,a[0],a[1])})}function gh(n,e,t,r,i,s){let a=0,o=n[t-r],l=n[t-r+1];for(;e<t;e+=r){const u=n[e],h=n[e+1];l<=s?h>s&&(u-o)*(s-l)-(i-o)*(h-l)>0&&a++:h<=s&&(u-o)*(s-l)-(i-o)*(h-l)<0&&a--,o=u,l=h}return a!==0}function eA(n,e,t,r,i,s){if(t.length===0||!gh(n,e,t[0],r,i,s))return!1;for(let a=1,o=t.length;a<o;++a)if(gh(n,t[a-1],t[a],r,i,s))return!1;return!0}function RU(n,e,t,r,i,s){if(t.length===0)return!1;for(let a=0,o=t.length;a<o;++a){const l=t[a];if(eA(n,e,l,r,i,s))return!0;e=l[l.length-1]}return!1}function l5(n,e,t,r,i){let s;for(e+=r;e<t;e+=r)if(s=i(n.slice(e-r,e),n.slice(e,e+r)),s)return s;return!1}function Dv(n,e,t,r,i,s){return s=s??UO(Zs(),n,e,t,r),Qi(i,s)?s[0]>=i[0]&&s[2]<=i[2]||s[1]>=i[1]&&s[3]<=i[3]?!0:l5(n,e,t,r,function(a,o){return OB(i,a,o)}):!1}function CU(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){if(Dv(n,e,t[s],r,i))return!0;e=t[s]}return!1}function c5(n,e,t,r,i){return!!(Dv(n,e,t,r,i)||gh(n,e,t,r,i[0],i[1])||gh(n,e,t,r,i[0],i[3])||gh(n,e,t,r,i[2],i[1])||gh(n,e,t,r,i[2],i[3]))}function u5(n,e,t,r,i){if(!c5(n,e,t[0],r,i))return!1;if(t.length===1)return!0;for(let s=1,a=t.length;s<a;++s)if(bU(n,t[s-1],t[s],r,i)&&!Dv(n,t[s-1],t[s],r,i))return!1;return!0}function PU(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){const o=t[s];if(u5(n,e,o,r,i))return!0;e=o[o.length-1]}return!1}function tA(n,e,t,r){let i=n[e],s=n[e+1],a=0;for(let o=e+r;o<t;o+=r){const l=n[o],u=n[o+1];a+=Math.sqrt((l-i)*(l-i)+(u-s)*(u-s)),i=l,s=u}return a}function Fv(n,e,t,r,i,s,a){const o=(t-e)/r;if(o<3){for(;e<t;e+=r)s[a++]=n[e],s[a++]=n[e+1];return a}const l=new Array(o);l[0]=1,l[o-1]=1;const u=[e,t-r];let h=0;for(;u.length>0;){const f=u.pop(),g=u.pop();let p=0;const E=n[g],x=n[g+1],w=n[f],T=n[f+1];for(let I=g+r;I<f;I+=r){const P=n[I],N=n[I+1],D=DB(P,N,E,x,w,T);D>p&&(h=I,p=D)}p>i&&(l[(h-e)/r]=1,g+r<h&&u.push(g,h),h+r<f&&u.push(h,f))}for(let f=0;f<o;++f)l[f]&&(s[a++]=n[e+f*r],s[a++]=n[e+f*r+1]);return a}function h5(n,e,t,r,i,s,a,o){for(let l=0,u=t.length;l<u;++l){const h=t[l];a=Fv(n,e,h,r,i,s,a),o.push(a),e=h}return a}function Qu(n,e){return e*Math.round(n/e)}function kU(n,e,t,r,i,s,a){if(e==t)return a;let o=Qu(n[e],i),l=Qu(n[e+1],i);e+=r,s[a++]=o,s[a++]=l;let u,h;do if(u=Qu(n[e],i),h=Qu(n[e+1],i),e+=r,e==t)return s[a++]=u,s[a++]=h,a;while(u==o&&h==l);for(;e<t;){const f=Qu(n[e],i),g=Qu(n[e+1],i);if(e+=r,f==u&&g==h)continue;const p=u-o,E=h-l,x=f-o,w=g-l;if(p*w==E*x&&(p<0&&x<p||p==x||p>0&&x>p)&&(E<0&&w<E||E==w||E>0&&w>E)){u=f,h=g;continue}s[a++]=u,s[a++]=h,o=u,l=h,u=f,h=g}return s[a++]=u,s[a++]=h,a}function nA(n,e,t,r,i,s,a,o){for(let l=0,u=t.length;l<u;++l){const h=t[l];a=kU(n,e,h,r,i,s,a),o.push(a),e=h}return a}function MU(n,e,t,r,i,s,a,o){for(let l=0,u=t.length;l<u;++l){const h=t[l],f=[];a=nA(n,e,h,r,i,s,a,f),o.push(f),e=h[h.length-1]}return a}class zo extends rd{constructor(e,t){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}appendCoordinate(e){An(this.flatCoordinates,e),this.changed()}clone(){const e=new zo(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,r,i){return i<td(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(qI(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),QI(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,e,t,r,i))}forEachSegment(e){return l5(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinateAtM(e,t){return this.layout!="XYM"&&this.layout!="XYZM"?null:(t=t!==void 0?t:!1,rT(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t))}getCoordinates(){return Vc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(e,t){return ix(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,this.stride)}getLength(){return tA(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(e){const t=[];return t.length=Fv(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new zo(t,"XY")}getType(){return"LineString"}intersectsExtent(e){return Dv(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,this.getExtent())}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Ov(this.flatCoordinates,0,e,this.stride),this.changed()}}let to=class d5 extends rd{constructor(e,t){super(),this.setCoordinates(e,t)}clone(){const e=new d5(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,r,i){const s=this.flatCoordinates,a=wh(e,t,s[0],s[1]);if(a<i){const o=this.stride;for(let l=0;l<o;++l)r[l]=s[l];return r.length=o,a}return i}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(e){return GO(this.flatCoordinates,e)}getType(){return"Point"}intersectsExtent(e){return UI(e,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(e,t){this.setLayout(t,e,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=IU(this.flatCoordinates,0,e,this.stride),this.changed()}};const _a={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},Lh=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",NU=Lh.includes("safari")&&!Lh.includes("chrom");NU&&(Lh.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(Lh));const LU=Lh.includes("webkit")&&!Lh.includes("edge"),f5=Lh.includes("macintosh"),OU=typeof devicePixelRatio<"u"?devicePixelRatio:1,Ks=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,rA=typeof Image<"u"&&Image.prototype.decode,g5=typeof createImageBitmap=="function",m5=(function(){let n=!1;try{const e=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return n})(),pt={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function Hr(n,e,t,r){let i;return t&&t.length?i=t.shift():Ks?i=new class extends OffscreenCanvas{style={}}(n??300,e??150):i=document.createElement("canvas"),n&&(i.width=n),e&&(i.height=e),i.getContext("2d",r)}let E2;function sx(){return E2||(E2=Hr(1,1)),E2}function jv(n){const e=n.canvas;e.width=1,e.height=1,n.clearRect(0,0,1,1)}function W4(n,e){const t=e.parentNode;t&&t.replaceChild(n,e)}function DU(n){for(;n.lastChild;)n.lastChild.remove()}function FU(n,e){const t=n.childNodes;for(let r=0;;++r){const i=t[r],s=e[r];if(!i&&!s)break;if(i!==s){if(!i){n.appendChild(s);continue}if(!s){n.removeChild(i),--r;continue}n.insertBefore(s,i)}}}function p5(){return new Proxy({childNodes:[],appendChild:function(e){return this.childNodes.push(e),e},remove:function(){},removeChild:function(e){const t=this.childNodes.indexOf(e);if(t===-1)throw new Error("Node to remove was not found");return this.childNodes.splice(t,1),e},insertBefore:function(e,t){const r=this.childNodes.indexOf(t);if(r===-1)throw new Error("Reference node not found");return this.childNodes.splice(r,0,e),e},style:{}},{get(e,t,r){return t==="firstElementChild"?e.childNodes.length>0?e.childNodes[0]:null:Reflect.get(e,t,r)}})}function Gc(n){return typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas}const iA=[NaN,NaN,NaN,0];let w2;function jU(){return w2||(w2=Hr(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),w2}const VU=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,GU=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,BU=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,UU=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function Vy(n,e){return n.endsWith("%")?Number(n.substring(0,n.length-1))/e:Number(n)}function hm(n){throw new Error('failed to parse "'+n+'" as color')}function y5(n){if(n.toLowerCase().startsWith("rgb")){const s=n.match(GU)||n.match(VU)||n.match(BU);if(s){const a=s[4],o=100/255;return[Yn(Vy(s[1],o)+.5|0,0,255),Yn(Vy(s[2],o)+.5|0,0,255),Yn(Vy(s[3],o)+.5|0,0,255),a!==void 0?Yn(Vy(a,100),0,1):1]}hm(n)}if(n.startsWith("#")){if(UU.test(n)){const s=n.substring(1),a=s.length<=4?1:2,o=[0,0,0,255];for(let l=0,u=s.length;l<u;l+=a){let h=parseInt(s.substring(l,l+a),16);a===1&&(h+=h<<4),o[l/a]=h}return o[3]=o[3]/255,o}hm(n)}const e=jU();e.fillStyle="#abcdef";let t=e.fillStyle;e.fillStyle=n,e.fillStyle===t&&(e.fillStyle="#fedcba",t=e.fillStyle,e.fillStyle=n,e.fillStyle===t&&hm(n));const r=e.fillStyle;if(r.startsWith("#")||r.startsWith("rgba"))return y5(r);e.clearRect(0,0,1,1),e.fillRect(0,0,1,1);const i=Array.from(e.getImageData(0,0,1,1).data);return i[3]=Vp(i[3]/255,3),i}function zU(n){return typeof n=="string"?n:aA(n)}const $U=1024,Mg={};let S2=0;function WU(n){if(n.length===4)return n;const e=n.slice();return e[3]=1,e}function T2(n){return n>.0031308?Math.pow(n,1/2.4)*269.025-14.025:n*3294.6}function I2(n){return n>.2068965?Math.pow(n,3):(n-4/29)*(108/841)}function A2(n){return n>10.314724?Math.pow((n+14.025)/269.025,2.4):n/3294.6}function b2(n){return n>.0088564?Math.pow(n,1/3):n/(108/841)+4/29}function H4(n){const e=A2(n[0]),t=A2(n[1]),r=A2(n[2]),i=b2(e*.222488403+t*.716873169+r*.06060791),s=500*(b2(e*.452247074+t*.399439023+r*.148375274)-i),a=200*(i-b2(e*.016863605+t*.117638439+r*.865350722)),o=Math.atan2(a,s)*(180/Math.PI);return[116*i-16,Math.sqrt(s*s+a*a),o<0?o+360:o,n[3]]}function HU(n){const e=(n[0]+16)/116,t=n[1],r=n[2]*Math.PI/180,i=I2(e),s=I2(e+t/500*Math.cos(r)),a=I2(e-t/200*Math.sin(r)),o=T2(s*3.021973625-i*1.617392459-a*.404875592),l=T2(s*-.943766287+i*1.916279586+a*.027607165),u=T2(s*.069407491-i*.22898585+a*1.159737864);return[Yn(o+.5|0,0,255),Yn(l+.5|0,0,255),Yn(u+.5|0,0,255),n[3]]}function sA(n){if(n==="none")return iA;if(Mg.hasOwnProperty(n))return Mg[n];if(S2>=$U){let t=0;for(const r in Mg)(t++&3)===0&&(delete Mg[r],--S2)}const e=y5(n);e.length!==4&&hm(n);for(const t of e)isNaN(t)&&hm(n);return Mg[n]=e,++S2,e}function Oh(n){return Array.isArray(n)?n:sA(n)}function aA(n){let e=n[0];e!=(e|0)&&(e=e+.5|0);let t=n[1];t!=(t|0)&&(t=t+.5|0);let r=n[2];r!=(r|0)&&(r=r+.5|0);const i=n[3]===void 0?1:Math.round(n[3]*1e3)/1e3;return"rgba("+e+","+t+","+r+","+i+")"}class _5 extends Dp{constructor(e,t,r,i){super(),this.extent=e,this.pixelRatio_=r,this.resolution=t,this.state=typeof i=="function"?pt.IDLE:i,this.image_=null,this.loader=typeof i=="function"?i:null}changed(){this.dispatchEvent(zt.CHANGE)}getExtent(){return this.extent}getImage(){return this.image_}getPixelRatio(){return this.pixelRatio_}getResolution(){return this.resolution}getState(){return this.state}load(){if(this.state==pt.IDLE&&this.loader){this.state=pt.LOADING,this.changed();const e=this.getResolution(),t=Array.isArray(e)?e[0]:e;FO(()=>this.loader(this.getExtent(),t,this.getPixelRatio())).then(r=>{"image"in r&&(this.image_=r.image),"extent"in r&&(this.extent=r.extent),"resolution"in r&&(this.resolution=r.resolution),"pixelRatio"in r&&(this.pixelRatio_=r.pixelRatio),(r instanceof HTMLImageElement||g5&&r instanceof ImageBitmap||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement)&&(this.image_=r),this.state=pt.LOADED}).catch(r=>{this.state=pt.ERROR,console.error(r)}).finally(()=>this.changed())}}setImage(e){this.image_=e}setResolution(e){this.resolution=e}}function KU(n,e,t){const r=n;let i=!0,s=!1,a=!1;const o=[q_(r,zt.LOAD,function(){a=!0,s||e()})];return r.src&&rA?(s=!0,r.decode().then(function(){i&&e()}).catch(function(l){i&&(a?e():t())})):o.push(q_(r,zt.ERROR,t)),function(){i=!1,o.forEach(Wn)}}function YU(n,e){return new Promise((t,r)=>{function i(){a(),t(n)}function s(){a(),r(new Error("Image load error"))}function a(){n.removeEventListener("load",i),n.removeEventListener("error",s)}n.addEventListener("load",i),n.addEventListener("error",s)})}function x5(n,e){return e&&(n.src=e),n.src&&rA?new Promise((t,r)=>n.decode().then(()=>t(n)).catch(i=>n.complete&&n.width?t(n):r(i))):YU(n)}function v5(n,e){return e&&(n.src=e),n.src&&rA&&g5?n.decode().then(()=>createImageBitmap(n)).catch(t=>{if(n.complete&&n.width)return n;throw t}):x5(n)}class XU{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let e=0;for(const t in this.cache_){const r=this.cache_[t];(e++&3)===0&&!r.hasListener()&&(delete this.cache_[t],delete this.patternCache_[t],--this.cacheSize_)}}}get(e,t,r){const i=R2(e,t,r);return i in this.cache_?this.cache_[i]:null}getPattern(e,t,r){const i=R2(e,t,r);return i in this.patternCache_?this.patternCache_[i]:null}set(e,t,r,i,s){const a=R2(e,t,r),o=a in this.cache_;this.cache_[a]=i,s&&(i.getImageState()===pt.IDLE&&i.load(),i.getImageState()===pt.LOADING?i.ready().then(()=>{this.patternCache_[a]=sx().createPattern(i.getImage(1),"repeat")}):this.patternCache_[a]=sx().createPattern(i.getImage(1),"repeat")),o||++this.cacheSize_}setSize(e){this.maxCacheSize_=e,this.expire()}}function R2(n,e,t){const r=t?Oh(t):"null";return e+":"+n+":"+r}const xa=new XU;let Ng=null;class E5 extends Dp{constructor(e,t,r,i,s){super(),this.hitDetectionImage_=null,this.image_=e,this.crossOrigin_=r,this.canvas_={},this.color_=s,this.imageState_=i===void 0?pt.IDLE:i,this.size_=e&&e.width&&e.height?[e.width,e.height]:null,this.src_=t,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===pt.LOADED){Ng||(Ng=Hr(1,1,void 0,{willReadFrequently:!0})),Ng.drawImage(this.image_,0,0);try{Ng.getImageData(0,0,1,1),this.tainted_=!1}catch{Ng=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(zt.CHANGE)}handleImageError_(){this.imageState_=pt.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=pt.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}getPixelRatio(e){return this.replaceColor_(e),this.canvas_[e]?e:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const e=this.size_[0],t=this.size_[1],r=Hr(e,t);r.fillRect(0,0,e,t),this.hitDetectionImage_=r.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===pt.IDLE){this.image_||this.initializeImage_(),this.imageState_=pt.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&x5(this.image_,this.src_).then(e=>{this.image_=e,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(e){if(!this.color_||this.canvas_[e]||this.imageState_!==pt.LOADED)return;const t=this.image_,r=Hr(Math.ceil(t.width*e),Math.ceil(t.height*e)),i=r.canvas;r.scale(e,e),r.drawImage(t,0,0),r.globalCompositeOperation="multiply",r.fillStyle=zU(this.color_),r.fillRect(0,0,i.width/e,i.height/e),r.globalCompositeOperation="destination-in",r.drawImage(t,0,0),this.canvas_[e]=i}ready(){return this.ready_||(this.ready_=new Promise(e=>{if(this.imageState_===pt.LOADED||this.imageState_===pt.ERROR)e();else{const t=()=>{(this.imageState_===pt.LOADED||this.imageState_===pt.ERROR)&&(this.removeEventListener(zt.CHANGE,t),e())};this.addEventListener(zt.CHANGE,t)}})),this.ready_}}function ax(n,e,t,r,i,s){let a=e===void 0?void 0:xa.get(e,t,i);return a||(a=new E5(n,n&&"src"in n?n.src||void 0:e,t,r,i),xa.set(e,t,i,a,s)),s&&a&&!xa.getPattern(e,t,i)&&xa.set(e,t,i,a,s),a}function Po(n){return n?Array.isArray(n)?aA(n):typeof n=="object"&&"src"in n?qU(n):n:null}function qU(n){if(!n.offset||!n.size)return xa.getPattern(n.src,"anonymous",n.color);const e=n.src+":"+n.offset,t=xa.getPattern(e,void 0,n.color);if(t)return t;const r=xa.get(n.src,"anonymous",null);if(r.getImageState()!==pt.LOADED)return null;const i=Hr(n.size[0],n.size[1]);return i.drawImage(r.getImage(1),n.offset[0],n.offset[1],n.size[0],n.size[1],0,0,n.size[0],n.size[1]),ax(i.canvas,e,void 0,pt.LOADED,n.color,!0),xa.getPattern(e,void 0,n.color)}class w5{drawCustom(e,t,r,i,s){}drawGeometry(e){}setStyle(e){}drawCircle(e,t,r){}drawFeature(e,t,r){}drawGeometryCollection(e,t,r){}drawLineString(e,t,r){}drawMultiLineString(e,t,r){}drawMultiPoint(e,t,r){}drawMultiPolygon(e,t,r){}drawPoint(e,t,r){}drawPolygon(e,t,r){}drawText(e,t,r){}setFillStrokeStyle(e,t){}setImageStyle(e,t){}setTextStyle(e,t){}}const Gy="ol-hidden",zp="ol-unselectable",oA="ol-control",K4="ol-collapsed",ZU=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),Y4=["style","variant","weight","size","lineHeight","family"],iT={normal:400,bold:700},sT=function(n){const e=n.match(ZU);if(!e)return null;const t={lineHeight:"normal",size:"1.2em",style:"normal",weight:"400",variant:"normal"};for(let r=0,i=Y4.length;r<i;++r){const s=e[r+1];s!==void 0&&(t[Y4[r]]=typeof s=="string"?s.trim():s)}return isNaN(Number(t.weight))&&t.weight in iT&&(t.weight=iT[t.weight]),t.families=t.family.split(/,\s?/).map(r=>r.trim().replace(/^['"]|['"]$/g,"")),t},S5="10px sans-serif",gs="#000",s0="round",Rl=[],Cl=0,a0="round",Hm=10,Km="#000",Ym="center",ox="middle",mh=[0,0,0,0],Xm=1,ff=new Zo;let Lg=null,X4;const aT={},QU=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"]);function JU(n,e,t){return`${n} ${e} 16px "${t}"`}const ez=(function(){let e,t;async function r(s){await t.ready;const a=await t.load(s);if(a.length===0)return!1;const o=sT(s),l=o.families[0].toLowerCase(),u=o.weight;return a.some(h=>{const f=h.family.replace(/^['"]|['"]$/g,"").toLowerCase(),g=iT[h.weight]||h.weight;return f===l&&h.style===o.style&&g==u})}async function i(){await t.ready;let s=!0;const a=ff.getProperties(),o=Object.keys(a).filter(l=>a[l]<100);for(let l=o.length-1;l>=0;--l){const u=o[l];let h=a[u];h<100&&(await r(u)?(Op(aT),ff.set(u,100)):(h+=10,ff.set(u,h,!0),h<100&&(s=!1)))}e=void 0,s||(e=setTimeout(i,100))}return async function(s){t||(t=Ks?self.fonts:document.fonts);const a=sT(s);if(!a)return;const o=a.families;let l=!1;for(const u of o){if(QU.has(u))continue;const h=JU(a.style,a.weight,u);ff.get(h)===void 0&&(ff.set(h,0,!0),l=!0)}l&&(clearTimeout(e),e=setTimeout(i,100))}})(),tz=(function(){let n;return function(e){let t=aT[e];if(t==null){if(Ks){const r=sT(e),i=T5(e,"g");t=(isNaN(Number(r.lineHeight))?1.2:Number(r.lineHeight))*(i.actualBoundingBoxAscent+i.actualBoundingBoxDescent)}else n||(n=document.createElement("div"),n.innerHTML="M",n.style.minHeight="0",n.style.maxHeight="none",n.style.height="auto",n.style.padding="0",n.style.border="none",n.style.position="absolute",n.style.display="block",n.style.left="-99999px"),n.style.font=e,document.body.appendChild(n),t=n.offsetHeight,document.body.removeChild(n);aT[e]=t}return t}})();function T5(n,e){return Lg||(Lg=Hr(1,1)),n!=X4&&(Lg.font=n,X4=Lg.font),Lg.measureText(e)}function I5(n,e){return T5(n,e).width}function q4(n,e,t){if(e in t)return t[e];const r=e.split(`
`).reduce((i,s)=>Math.max(i,I5(n,s)),0);return t[e]=r,r}function nz(n,e){const t=[],r=[],i=[];let s=0,a=0,o=0,l=0;for(let u=0,h=e.length;u<=h;u+=2){const f=e[u];if(f===`
`||u===h){s=Math.max(s,a),i.push(a),a=0,o+=l,l=0;continue}const g=e[u+1]||n.font,p=I5(g,f);t.push(p),a+=p;const E=tz(g);r.push(E),l=Math.max(l,E)}return{width:s,height:o,widths:t,heights:r,lineWidths:i}}function rz(n,e,t,r,i,s,a,o,l,u,h){n.save(),t!==1&&(n.globalAlpha===void 0?n.globalAlpha=f=>f.globalAlpha*=t:n.globalAlpha*=t),e&&n.transform.apply(n,e),r.contextInstructions?(n.translate(l,u),n.scale(h[0],h[1]),iz(r,n)):h[0]<0||h[1]<0?(n.translate(l,u),n.scale(h[0],h[1]),n.drawImage(r,i,s,a,o,0,0,a,o)):n.drawImage(r,i,s,a,o,l,u,a*h[0],o*h[1]),n.restore()}function iz(n,e){const t=n.contextInstructions;for(let r=0,i=t.length;r<i;r+=2)Array.isArray(t[r+1])?e[t[r]].apply(e,t[r+1]):e[t[r]]=t[r+1]}class sz extends w5{constructor(e,t,r,i,s,a,o){super(),this.context_=e,this.pixelRatio_=t,this.extent_=r,this.transform_=i,this.transformRotation_=i?Vp(Math.atan2(i[1],i[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=a,this.userTransform_=o,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=Xa()}drawImages_(e,t,r,i){if(!this.image_)return;const s=Xc(e,t,r,i,this.transform_,this.pixelCoordinates_),a=this.context_,o=this.tmpLocalTransform_,l=a.globalAlpha;this.imageOpacity_!=1&&(a.globalAlpha=l*this.imageOpacity_);let u=this.imageRotation_;this.transformRotation_===0&&(u-=this.viewRotation_),this.imageRotateWithView_&&(u+=this.viewRotation_);for(let h=0,f=s.length;h<f;h+=2){const g=s[h]-this.imageAnchorX_,p=s[h+1]-this.imageAnchorY_;if(u!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const E=g+this.imageAnchorX_,x=p+this.imageAnchorY_;Uo(o,E,x,1,1,u,-E,-x),a.save(),a.transform.apply(a,o),a.translate(E,x),a.scale(this.imageScale_[0],this.imageScale_[1]),a.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),a.restore()}else a.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,g,p,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(a.globalAlpha=l)}drawText_(e,t,r,i){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=Xc(e,t,r,i,this.transform_,this.pixelCoordinates_),a=this.context_;let o=this.textRotation_;for(this.transformRotation_===0&&(o-=this.viewRotation_),this.textRotateWithView_&&(o+=this.viewRotation_);t<r;t+=i){const l=s[t]+this.textOffsetX_,u=s[t+1]+this.textOffsetY_;o!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(a.save(),a.translate(l-this.textOffsetX_,u-this.textOffsetY_),a.rotate(o),a.translate(this.textOffsetX_,this.textOffsetY_),a.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&a.strokeText(this.text_,0,0),this.textFillState_&&a.fillText(this.text_,0,0),a.restore()):(this.textStrokeState_&&a.strokeText(this.text_,l,u),this.textFillState_&&a.fillText(this.text_,l,u))}}moveToLineTo_(e,t,r,i,s){const a=this.context_,o=Xc(e,t,r,i,this.transform_,this.pixelCoordinates_);a.moveTo(o[0],o[1]);let l=o.length;s&&(l-=2);for(let u=2;u<l;u+=2)a.lineTo(o[u],o[u+1]);return s&&a.closePath(),r}drawRings_(e,t,r,i){for(let s=0,a=r.length;s<a;++s)t=this.moveToLineTo_(e,t,r[s],i,!0);return t}drawCircle(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Qi(this.extent_,e.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=wU(e,this.transform_,this.pixelCoordinates_),r=t[2]-t[0],i=t[3]-t[1],s=Math.sqrt(r*r+i*i),a=this.context_;a.beginPath(),a.arc(t[0],t[1],s,0,2*Math.PI),this.fillState_&&a.fill(),this.strokeState_&&a.stroke()}this.text_!==""&&this.drawText_(e.getCenter(),0,2,2)}}setStyle(e){this.setFillStrokeStyle(e.getFill(),e.getStroke()),this.setImageStyle(e.getImage()),this.setTextStyle(e.getText())}setTransform(e){this.transform_=e}drawGeometry(e){switch(e.getType()){case"Point":this.drawPoint(e);break;case"LineString":this.drawLineString(e);break;case"Polygon":this.drawPolygon(e);break;case"MultiPoint":this.drawMultiPoint(e);break;case"MultiLineString":this.drawMultiLineString(e);break;case"MultiPolygon":this.drawMultiPolygon(e);break;case"GeometryCollection":this.drawGeometryCollection(e);break;case"Circle":this.drawCircle(e);break}}drawFeature(e,t){const r=t.getGeometryFunction()(e);r&&(this.setStyle(t),this.drawGeometry(r))}drawGeometryCollection(e){const t=e.getGeometriesArray();for(let r=0,i=t.length;r<i;++r)this.drawGeometry(t[r])}drawPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),r=e.getStride();this.image_&&this.drawImages_(t,0,t.length,r),this.text_!==""&&this.drawText_(t,0,t.length,r)}drawMultiPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),r=e.getStride();this.image_&&this.drawImages_(t,0,t.length,r),this.text_!==""&&this.drawText_(t,0,t.length,r)}drawLineString(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Qi(this.extent_,e.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const t=this.context_,r=e.getFlatCoordinates();t.beginPath(),this.moveToLineTo_(r,0,r.length,e.getStride(),!1),t.stroke()}if(this.text_!==""){const t=e.getFlatMidpoint();this.drawText_(t,0,2,2)}}}drawMultiLineString(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getExtent();if(Qi(this.extent_,t)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const r=this.context_,i=e.getFlatCoordinates();let s=0;const a=e.getEnds(),o=e.getStride();r.beginPath();for(let l=0,u=a.length;l<u;++l)s=this.moveToLineTo_(i,s,a[l],o,!1);r.stroke()}if(this.text_!==""){const r=e.getFlatMidpoints();this.drawText_(r,0,r.length,2)}}}drawPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Qi(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_;t.beginPath(),this.drawRings_(e.getOrientedFlatCoordinates(),0,e.getEnds(),e.getStride()),this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoint();this.drawText_(t,0,2,2)}}}drawMultiPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Qi(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_,r=e.getOrientedFlatCoordinates();let i=0;const s=e.getEndss(),a=e.getStride();t.beginPath();for(let o=0,l=s.length;o<l;++o){const u=s[o];i=this.drawRings_(r,i,u,a)}this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoints();this.drawText_(t,0,t.length,2)}}}setContextFillState_(e){const t=this.context_,r=this.contextFillState_;r?r.fillStyle!=e.fillStyle&&(r.fillStyle=e.fillStyle,t.fillStyle=e.fillStyle):(t.fillStyle=e.fillStyle,this.contextFillState_={fillStyle:e.fillStyle})}setContextStrokeState_(e){const t=this.context_,r=this.contextStrokeState_;r?(r.lineCap!=e.lineCap&&(r.lineCap=e.lineCap,t.lineCap=e.lineCap),vu(r.lineDash,e.lineDash)||t.setLineDash(r.lineDash=e.lineDash),r.lineDashOffset!=e.lineDashOffset&&(r.lineDashOffset=e.lineDashOffset,t.lineDashOffset=e.lineDashOffset),r.lineJoin!=e.lineJoin&&(r.lineJoin=e.lineJoin,t.lineJoin=e.lineJoin),r.lineWidth!=e.lineWidth&&(r.lineWidth=e.lineWidth,t.lineWidth=e.lineWidth),r.miterLimit!=e.miterLimit&&(r.miterLimit=e.miterLimit,t.miterLimit=e.miterLimit),r.strokeStyle!=e.strokeStyle&&(r.strokeStyle=e.strokeStyle,t.strokeStyle=e.strokeStyle)):(t.lineCap=e.lineCap,t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset,t.lineJoin=e.lineJoin,t.lineWidth=e.lineWidth,t.miterLimit=e.miterLimit,t.strokeStyle=e.strokeStyle,this.contextStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle})}setContextTextState_(e){const t=this.context_,r=this.contextTextState_,i=e.textAlign?e.textAlign:Ym;r?(r.font!=e.font&&(r.font=e.font,t.font=e.font),r.textAlign!=i&&(r.textAlign=i,t.textAlign=i),r.textBaseline!=e.textBaseline&&(r.textBaseline=e.textBaseline,t.textBaseline=e.textBaseline)):(t.font=e.font,t.textAlign=i,t.textBaseline=e.textBaseline,this.contextTextState_={font:e.font,textAlign:i,textBaseline:e.textBaseline})}setFillStrokeStyle(e,t){if(!e)this.fillState_=null;else{const r=e.getColor();this.fillState_={fillStyle:Po(r||gs)}}if(!t)this.strokeState_=null;else{const r=t.getColor(),i=t.getLineCap(),s=t.getLineDash(),a=t.getLineDashOffset(),o=t.getLineJoin(),l=t.getWidth(),u=t.getMiterLimit(),h=s||Rl;this.strokeState_={lineCap:i!==void 0?i:s0,lineDash:this.pixelRatio_===1?h:h.map(f=>f*this.pixelRatio_),lineDashOffset:(a||Cl)*this.pixelRatio_,lineJoin:o!==void 0?o:a0,lineWidth:(l!==void 0?l:Xm)*this.pixelRatio_,miterLimit:u!==void 0?u:Hm,strokeStyle:Po(r||Km)}}}setImageStyle(e){let t;if(!e||!(t=e.getSize())){this.image_=null;return}const r=e.getPixelRatio(this.pixelRatio_),i=e.getAnchor(),s=e.getOrigin();this.image_=e.getImage(this.pixelRatio_),this.imageAnchorX_=i[0]*r,this.imageAnchorY_=i[1]*r,this.imageHeight_=t[1]*r,this.imageOpacity_=e.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=e.getRotateWithView(),this.imageRotation_=e.getRotation();const a=e.getScaleArray();this.imageScale_=[a[0]*this.pixelRatio_/r,a[1]*this.pixelRatio_/r],this.imageWidth_=t[0]*r}setTextStyle(e){if(!e)this.text_="";else{const t=e.getFill();if(!t)this.textFillState_=null;else{const p=t.getColor();this.textFillState_={fillStyle:Po(p||gs)}}const r=e.getStroke();if(!r)this.textStrokeState_=null;else{const p=r.getColor(),E=r.getLineCap(),x=r.getLineDash(),w=r.getLineDashOffset(),T=r.getLineJoin(),I=r.getWidth(),P=r.getMiterLimit();this.textStrokeState_={lineCap:E!==void 0?E:s0,lineDash:x||Rl,lineDashOffset:w||Cl,lineJoin:T!==void 0?T:a0,lineWidth:I!==void 0?I:Xm,miterLimit:P!==void 0?P:Hm,strokeStyle:Po(p||Km)}}const i=e.getFont(),s=e.getOffsetX(),a=e.getOffsetY(),o=e.getRotateWithView(),l=e.getRotation(),u=e.getScaleArray(),h=e.getText(),f=e.getTextAlign(),g=e.getTextBaseline();this.textState_={font:i!==void 0?i:S5,textAlign:f!==void 0?f:Ym,textBaseline:g!==void 0?g:ox},this.text_=h!==void 0?Array.isArray(h)?h.reduce((p,E,x)=>p+=x%2?" ":E,""):h:"",this.textOffsetX_=s!==void 0?this.pixelRatio_*s:0,this.textOffsetY_=a!==void 0?this.pixelRatio_*a:0,this.textRotateWithView_=o!==void 0?o:!1,this.textRotation_=l!==void 0?l:0,this.textScale_=[this.pixelRatio_*u[0],this.pixelRatio_*u[1]]}}}const az=.5,A5={Point:gz,LineString:hz,Polygon:pz,MultiPoint:mz,MultiLineString:dz,MultiPolygon:fz,GeometryCollection:uz,Circle:lz};function oz(n,e){return parseInt(_n(n),10)-parseInt(_n(e),10)}function Z4(n,e){const t=b5(n,e);return t*t}function b5(n,e){return az*n/e}function lz(n,e,t,r,i){const s=t.getFill(),a=t.getStroke();if(s||a){const l=n.getBuilder(t.getZIndex(),"Circle");l.setFillStrokeStyle(s,a),l.drawCircle(e,r,i)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,r)}}function Q4(n,e,t,r,i,s,a,o){const l=[],u=t.getImage();if(u){let g=!0;const p=u.getImageState();p==pt.LOADED||p==pt.ERROR?g=!1:p==pt.IDLE&&u.load(),g&&l.push(u.ready())}const h=t.getFill();h&&h.loading()&&l.push(h.ready());const f=l.length>0;return f&&Promise.all(l).then(()=>i(null)),cz(n,e,t,r,s,a,o),f}function cz(n,e,t,r,i,s,a){const o=t.getGeometryFunction()(e);if(!o)return;const l=o.simplifyTransformed(r,i);if(t.getRenderer())R5(n,l,t,e,a);else{const h=A5[l.getType()];h(n,l,t,e,a,s)}}function R5(n,e,t,r,i){if(e.getType()=="GeometryCollection"){const a=e.getGeometries();for(let o=0,l=a.length;o<l;++o)R5(n,a[o],t,r,i);return}n.getBuilder(t.getZIndex(),"Default").drawCustom(e,r,t.getRenderer(),t.getHitDetectionRenderer(),i)}function uz(n,e,t,r,i,s){const a=e.getGeometriesArray();let o,l;for(o=0,l=a.length;o<l;++o){const u=A5[a[o].getType()];u(n,a[o],t,r,i,s)}}function hz(n,e,t,r,i){const s=t.getStroke();if(s){const o=n.getBuilder(t.getZIndex(),"LineString");o.setFillStrokeStyle(null,s),o.drawLineString(e,r,i)}const a=t.getText();if(a&&a.getText()){const o=n.getBuilder(t.getZIndex(),"Text");o.setTextStyle(a),o.drawText(e,r,i)}}function dz(n,e,t,r,i){const s=t.getStroke();if(s){const o=n.getBuilder(t.getZIndex(),"LineString");o.setFillStrokeStyle(null,s),o.drawMultiLineString(e,r,i)}const a=t.getText();if(a&&a.getText()){const o=n.getBuilder(t.getZIndex(),"Text");o.setTextStyle(a),o.drawText(e,r,i)}}function fz(n,e,t,r,i){const s=t.getFill(),a=t.getStroke();if(a||s){const l=n.getBuilder(t.getZIndex(),"Polygon");l.setFillStrokeStyle(s,a),l.drawMultiPolygon(e,r,i)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,r,i)}}function gz(n,e,t,r,i,s){const a=t.getImage(),o=t.getText(),l=o&&o.getText(),u=s&&a&&l?{}:void 0;if(a){if(a.getImageState()!=pt.LOADED)return;const h=n.getBuilder(t.getZIndex(),"Image");h.setImageStyle(a,u),h.drawPoint(e,r,i)}if(l){const h=n.getBuilder(t.getZIndex(),"Text");h.setTextStyle(o,u),h.drawText(e,r,i)}}function mz(n,e,t,r,i,s){const a=t.getImage(),o=a&&a.getOpacity()!==0,l=t.getText(),u=l&&l.getText(),h=s&&o&&u?{}:void 0;if(o){if(a.getImageState()!=pt.LOADED)return;const f=n.getBuilder(t.getZIndex(),"Image");f.setImageStyle(a,h),f.drawMultiPoint(e,r,i)}if(u){const f=n.getBuilder(t.getZIndex(),"Text");f.setTextStyle(l,h),f.drawText(e,r,i)}}function pz(n,e,t,r,i){const s=t.getFill(),a=t.getStroke();if(s||a){const l=n.getBuilder(t.getZIndex(),"Polygon");l.setFillStrokeStyle(s,a),l.drawPolygon(e,r,i)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,r,i)}}let yz=!1;function _z(n,e,t,r,i,s,a){const o=new XMLHttpRequest;o.open("GET",typeof n=="function"?n(t,r,i):n,!0),e.getType()=="arraybuffer"&&(o.responseType="arraybuffer"),o.withCredentials=yz,o.onload=function(l){if(!o.status||o.status>=200&&o.status<300){const u=e.getType();try{let h;u=="text"||u=="json"?h=o.responseText:u=="xml"?h=o.responseXML||o.responseText:u=="arraybuffer"&&(h=o.response),h?s(e.readFeatures(h,{extent:t,featureProjection:i}),e.readProjection(h)):a()}catch{a()}}else a()},o.onerror=a,o.send()}function J4(n,e){return function(t,r,i,s,a){_z(n,e,t,r,i,(o,l)=>{this.addFeatures(o),s!==void 0&&s(o)},()=>{this.changed(),a!==void 0&&a()})}}function xz(n,e){return[[-1/0,-1/0,1/0,1/0]]}function C5(n,e,t,r){const i=[];let s=Zs();for(let a=0,o=t.length;a<o;++a){const l=t[a];s=zI(n,e,l[0],r),i.push((s[0]+s[2])/2,(s[1]+s[3])/2),e=l[l.length-1]}return i}function lA(n,e,t,r,i,s,a){let o,l,u,h,f,g,p;const E=i[s+1],x=[];for(let I=0,P=t.length;I<P;++I){const N=t[I];for(h=n[N-r],g=n[N-r+1],o=e;o<N;o+=r)f=n[o],p=n[o+1],(E<=g&&p<=E||g<=E&&E<=p)&&(u=(E-g)/(p-g)*(f-h)+h,x.push(u)),h=f,g=p}let w=NaN,T=-1/0;for(x.sort(Il),h=x[0],o=1,l=x.length;o<l;++o){f=x[o];const I=Math.abs(f-h);I>T&&(u=(h+f)/2,eA(n,e,t,r,u,E)&&(w=u,T=I)),h=f}return isNaN(w)&&(w=i[s]),a?(a.push(w,E,T),a):[w,E,T]}function P5(n,e,t,r,i){let s=[];for(let a=0,o=t.length;a<o;++a){const l=t[a];s=lA(n,e,l,r,i,2*a,s),e=l[l.length-1]}return s}function vz(n,e,t,r){for(;e<t-r;){for(let i=0;i<r;++i){const s=n[e+i];n[e+i]=n[t-r+i],n[t-r+i]=s}e+=r,t-=r}}function cA(n,e,t,r){let i=0,s=n[t-r],a=n[t-r+1];for(;e<t;e+=r){const o=n[e],l=n[e+1];i+=(o-s)*(l+a),s=o,a=l}return i===0?void 0:i>0}function uA(n,e,t,r,i){i=i!==void 0?i:!1;for(let s=0,a=t.length;s<a;++s){const o=t[s],l=cA(n,e,o,r);if(s===0){if(i&&l||!i&&!l)return!1}else if(i&&!l||!i&&l)return!1;e=o}return!0}function k5(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){const o=t[s];if(!uA(n,e,o,r,i))return!1;o.length&&(e=o[o.length-1])}return!0}function lx(n,e,t,r,i){i=i!==void 0?i:!1;for(let s=0,a=t.length;s<a;++s){const o=t[s],l=cA(n,e,o,r);(s===0?i&&l||!i&&!l:i&&!l||!i&&l)&&vz(n,e,o,r),e=o}return e}function oT(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s)e=lx(n,e,t[s],r,i);return e}function Ez(n,e){const t=[];let r=0,i=0,s;for(let a=0,o=e.length;a<o;++a){const l=e[a],u=cA(n,r,l,2);if(s===void 0&&(s=u),u===s)t.push(e.slice(i,a+1));else{if(t.length===0)continue;t[t.length-1].push(e[i])}i=a+1,r=l}return t}class qa extends a5{constructor(e){super(),this.geometries_=e,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(Wn),this.changeEventsKeys_.length=0}listenGeometriesChange_(){const e=this.geometries_;for(let t=0,r=e.length;t<r;++t)this.changeEventsKeys_.push(hn(e[t],zt.CHANGE,this.changed,this))}clone(){const e=new qa(C2(this.geometries_));return e.applyProperties(this),e}closestPointXY(e,t,r,i){if(i<td(this.getExtent(),e,t))return i;const s=this.geometries_;for(let a=0,o=s.length;a<o;++a)i=s[a].closestPointXY(e,t,r,i);return i}containsXY(e,t){const r=this.geometries_;for(let i=0,s=r.length;i<s;++i)if(r[i].containsXY(e,t))return!0;return!1}computeExtent(e){jp(e);const t=this.geometries_;for(let r=0,i=t.length;r<i;++r)BO(e,t[r].getExtent());return e}getGeometries(){return C2(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let e=[];const t=this.geometries_;for(let r=0,i=t.length;r<i;++r)t[r].getType()===this.getType()?e=e.concat(t[r].getGeometriesArrayRecursive()):e.push(t[r]);return e}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=[],r=this.geometries_;let i=!1;for(let s=0,a=r.length;s<a;++s){const o=r[s],l=o.getSimplifiedGeometry(e);t.push(l),l!==o&&(i=!0)}return i?new qa(t):(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getType(){return"GeometryCollection"}intersectsExtent(e){const t=this.geometries_;for(let r=0,i=t.length;r<i;++r)if(t[r].intersectsExtent(e))return!0;return!1}isEmpty(){return this.geometries_.length===0}rotate(e,t){const r=this.geometries_;for(let i=0,s=r.length;i<s;++i)r[i].rotate(e,t);this.changed()}scale(e,t,r){r||(r=Bo(this.getExtent()));const i=this.geometries_;for(let s=0,a=i.length;s<a;++s)i[s].scale(e,t,r);this.changed()}setGeometries(e){this.setGeometriesArray(C2(e))}setGeometriesArray(e){this.unlistenGeometriesChange_(),this.geometries_=e,this.listenGeometriesChange_(),this.changed()}applyTransform(e){const t=this.geometries_;for(let r=0,i=t.length;r<i;++r)t[r].applyTransform(e);this.changed()}translate(e,t){const r=this.geometries_;for(let i=0,s=r.length;i<s;++i)r[i].translate(e,t);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function C2(n){return n.map(e=>e.clone())}function M5(n,e,t,r){let i=0;const s=n[t-r],a=n[t-r+1];let o=0,l=0;for(;e<t;e+=r){const u=n[e]-s,h=n[e+1]-a;i+=l*u-o*h,o=u,l=h}return i/2}function N5(n,e,t,r){let i=0;for(let s=0,a=t.length;s<a;++s){const o=t[s];i+=M5(n,e,o,r),e=o}return i}function wz(n,e,t,r){let i=0;for(let s=0,a=t.length;s<a;++s){const o=t[s];i+=N5(n,e,o,r),e=o[o.length-1]}return i}class qm extends rd{constructor(e,t){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}clone(){return new qm(this.flatCoordinates.slice(),this.layout)}closestPointXY(e,t,r,i){return i<td(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(qI(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),QI(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,t,r,i))}getArea(){return M5(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return Vc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(e){const t=[];return t.length=Fv(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new qm(t,"XY")}getType(){return"LinearRing"}intersectsExtent(e){return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Ov(this.flatCoordinates,0,e,this.stride),this.changed()}}class iu extends rd{constructor(e,t,r){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(e[0]))this.setCoordinates(e,t);else if(t!==void 0&&r)this.setFlatCoordinates(t,e),this.ends_=r;else{const i=e,s=[],a=[];for(let l=0,u=i.length;l<u;++l){const h=i[l];An(s,h.getFlatCoordinates()),a.push(s.length)}const o=i.length===0?this.getLayout():i[0].getLayout();this.setFlatCoordinates(o,s),this.ends_=a}}appendLineString(e){An(this.flatCoordinates,e.getFlatCoordinates().slice()),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new iu(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,r,i){return i<td(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(ZI(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),JI(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,e,t,r,i))}getCoordinateAtM(e,t,r){return this.layout!="XYM"&&this.layout!="XYZM"||this.flatCoordinates.length===0?null:(t=t!==void 0?t:!1,r=r!==void 0?r:!1,AU(this.flatCoordinates,0,this.ends_,this.stride,e,t,r))}getCoordinates(){return Wm(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(e){return e<0||this.ends_.length<=e?null:new zo(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLineStrings(){const e=this.flatCoordinates,t=this.ends_,r=this.layout,i=[];let s=0;for(let a=0,o=t.length;a<o;++a){const l=t[a],u=new zo(e.slice(s,l),r);i.push(u),s=l}return i}getLength(){const e=this.ends_;let t=0,r=0;for(let i=0,s=e.length;i<s;++i)r+=tA(this.flatCoordinates,t,e[i],this.stride),t=e[i];return r}getFlatMidpoints(){const e=[],t=this.flatCoordinates;let r=0;const i=this.ends_,s=this.stride;for(let a=0,o=i.length;a<o;++a){const l=i[a],u=ix(t,r,l,s,.5);An(e,u),r=l}return e}getSimplifiedGeometryInternal(e){const t=[],r=[];return t.length=h5(this.flatCoordinates,0,this.ends_,this.stride,e,t,0,r),new iu(t,"XY",r)}getType(){return"MultiLineString"}intersectsExtent(e){return CU(this.flatCoordinates,0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const r=Up(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=r.length===0?0:r[r.length-1],this.changed()}}class P0 extends rd{constructor(e,t){super(),t&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}appendPoint(e){An(this.flatCoordinates,e.getFlatCoordinates()),this.changed()}clone(){const e=new P0(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,r,i){if(i<td(this.getExtent(),e,t))return i;const s=this.flatCoordinates,a=this.stride;for(let o=0,l=s.length;o<l;o+=a){const u=wh(e,t,s[o],s[o+1]);if(u<i){i=u;for(let h=0;h<a;++h)r[h]=s[o+h];r.length=a}}return i}getCoordinates(){return Vc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(e){const t=this.flatCoordinates.length/this.stride;return e<0||t<=e?null:new to(this.flatCoordinates.slice(e*this.stride,(e+1)*this.stride),this.layout)}getPoints(){const e=this.flatCoordinates,t=this.layout,r=this.stride,i=[];for(let s=0,a=e.length;s<a;s+=r){const o=new to(e.slice(s,s+r),t);i.push(o)}return i}getType(){return"MultiPoint"}intersectsExtent(e){const t=this.flatCoordinates,r=this.stride;for(let i=0,s=t.length;i<s;i+=r){const a=t[i],o=t[i+1];if(UI(e,a,o))return!0}return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Ov(this.flatCoordinates,0,e,this.stride),this.changed()}}class no extends rd{constructor(e,t,r){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,t!==void 0&&r?(this.setFlatCoordinates(t,e),this.ends_=r):this.setCoordinates(e,t)}appendLinearRing(e){this.flatCoordinates?An(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new no(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,r,i){return i<td(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(ZI(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),JI(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,t,r,i))}containsXY(e,t){return eA(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,t)}getArea(){return N5(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),lx(t,0,this.ends_,this.stride,e)):t=this.flatCoordinates,Wm(t,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const e=Bo(this.getExtent());this.flatInteriorPoint_=lA(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new to(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(e){return e<0||this.ends_.length<=e?null:new qm(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLinearRings(){const e=this.layout,t=this.flatCoordinates,r=this.ends_,i=[];let s=0;for(let a=0,o=r.length;a<o;++a){const l=r[a],u=new qm(t.slice(s,l),e);i.push(u),s=l}return i}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;uA(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=lx(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],r=[];return t.length=nA(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(e),t,0,r),new no(t,"XY",r)}getType(){return"Polygon"}intersectsExtent(e){return u5(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const r=Up(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=r.length===0?0:r[r.length-1],this.changed()}}function ek(n){if(C0(n))throw new Error("Cannot create polygon from empty extent");const e=n[0],t=n[1],r=n[2],i=n[3],s=[e,t,e,i,r,i,r,t,e,t];return new no(s,"XY",[s.length])}class o0 extends rd{constructor(e,t,r){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!r&&!Array.isArray(e[0])){const i=e,s=[],a=[];for(let o=0,l=i.length;o<l;++o){const u=i[o],h=s.length,f=u.getEnds();for(let g=0,p=f.length;g<p;++g)f[g]+=h;An(s,u.getFlatCoordinates()),a.push(f)}t=i.length===0?this.getLayout():i[0].getLayout(),e=s,r=a}t!==void 0&&r?(this.setFlatCoordinates(t,e),this.endss_=r):this.setCoordinates(e,t)}appendPolygon(e){let t;if(!this.flatCoordinates)this.flatCoordinates=e.getFlatCoordinates().slice(),t=e.getEnds().slice(),this.endss_.push();else{const r=this.flatCoordinates.length;An(this.flatCoordinates,e.getFlatCoordinates()),t=e.getEnds().slice();for(let i=0,s=t.length;i<s;++i)t[i]+=r}this.endss_.push(t),this.changed()}clone(){const e=this.endss_.length,t=new Array(e);for(let i=0;i<e;++i)t[i]=this.endss_[i].slice();const r=new o0(this.flatCoordinates.slice(),this.layout,t);return r.applyProperties(this),r}closestPointXY(e,t,r,i){return i<td(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(SU(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),TU(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,e,t,r,i))}containsXY(e,t){return RU(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e,t)}getArea(){return wz(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),oT(t,0,this.endss_,this.stride,e)):t=this.flatCoordinates,nT(t,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const e=C5(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=P5(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new P0(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;k5(e,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=oT(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],r=[];return t.length=MU(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(e),t,0,r),new o0(t,"XY",r)}getPolygon(e){if(e<0||this.endss_.length<=e)return null;let t;if(e===0)t=0;else{const s=this.endss_[e-1];t=s[s.length-1]}const r=this.endss_[e].slice(),i=r[r.length-1];if(t!==0)for(let s=0,a=r.length;s<a;++s)r[s]-=t;return new no(this.flatCoordinates.slice(t,i),this.layout,r)}getPolygons(){const e=this.layout,t=this.flatCoordinates,r=this.endss_,i=[];let s=0;for(let a=0,o=r.length;a<o;++a){const l=r[a].slice(),u=l[l.length-1];if(s!==0)for(let f=0,g=l.length;f<g;++f)l[f]-=s;const h=new no(t.slice(s,u),e,l);i.push(h),s=u}return i}getType(){return"MultiPolygon"}intersectsExtent(e){return PU(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,3),this.flatCoordinates||(this.flatCoordinates=[]);const r=o5(this.flatCoordinates,0,e,this.stride,this.endss_);if(r.length===0)this.flatCoordinates.length=0;else{const i=r[r.length-1];this.flatCoordinates.length=i.length===0?0:i[i.length-1]}this.changed()}}const tk=Xa();class zs{constructor(e,t,r,i,s,a){this.styleFunction,this.extent_,this.id_=a,this.type_=e,this.flatCoordinates_=t,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=r||null,this.properties_=s,this.squaredTolerance_,this.stride_=i,this.simplifiedGeometry_}get(e){return this.properties_[e]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?GO(this.flatCoordinates_):zI(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const e=Bo(this.getExtent());this.flatInteriorPoints_=lA(this.flatCoordinates_,0,this.ends_,2,e,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const e=Ez(this.flatCoordinates_,this.ends_),t=C5(this.flatCoordinates_,0,e,2);this.flatInteriorPoints_=P5(this.flatCoordinates_,0,e,2,t)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=ix(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const e=this.flatCoordinates_;let t=0;const r=this.ends_;for(let i=0,s=r.length;i<s;++i){const a=r[i],o=ix(e,t,a,2,.5);An(this.flatMidpoints_,o),t=a}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(e){return this}simplifyTransformed(e,t){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(e){e=Bn(e);const t=e.getExtent(),r=e.getWorldExtent();if(t&&r){const i=Mr(r)/Mr(t);Uo(tk,r[0],r[3],i,-i,0,0,0),Xc(this.flatCoordinates_,0,this.flatCoordinates_.length,2,tk,this.flatCoordinates_)}}applyTransform(e){e(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new zs(this.type_,this.flatCoordinates_.slice(),this.ends_?.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=DO((e,t)=>{if(e===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),t&&this.simplifiedGeometry_.applyTransform(t);const r=this.simplifiedGeometry_.getFlatCoordinates();let i;switch(this.type_){case"LineString":r.length=Fv(r,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,e,r,0),i=[r.length];break;case"MultiLineString":i=[],r.length=h5(r,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,e,r,0,i);break;case"Polygon":i=[],r.length=nA(r,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(e),r,0,i);break}return i&&(this.simplifiedGeometry_=new zs(this.type_,r,i,2,this.properties_,this.id_)),this.squaredTolerance_=e,this.simplifiedGeometry_}),this}}zs.prototype.getFlatCoordinates=zs.prototype.getOrientedFlatCoordinates;function L5(n,e,t=0,r=n.length-1,i=Sz){for(;r>t;){if(r-t>600){const l=r-t+1,u=e-t+1,h=Math.log(l),f=.5*Math.exp(2*h/3),g=.5*Math.sqrt(h*f*(l-f)/l)*(u-l/2<0?-1:1),p=Math.max(t,Math.floor(e-u*f/l+g)),E=Math.min(r,Math.floor(e+(l-u)*f/l+g));L5(n,e,p,E,i)}const s=n[e];let a=t,o=r;for(Og(n,t,e),i(n[r],s)>0&&Og(n,t,r);a<o;){for(Og(n,a,o),a++,o--;i(n[a],s)<0;)a++;for(;i(n[o],s)>0;)o--}i(n[t],s)===0?Og(n,t,o):(o++,Og(n,o,r)),o<=e&&(t=o+1),e<=o&&(r=o-1)}}function Og(n,e,t){const r=n[e];n[e]=n[t],n[t]=r}function Sz(n,e){return n<e?-1:n>e?1:0}let O5=class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data;const r=[];if(!Uy(e,t))return r;const i=this.toBBox,s=[];for(;t;){for(let a=0;a<t.children.length;a++){const o=t.children[a],l=t.leaf?i(o):o;Uy(e,l)&&(t.leaf?r.push(o):k2(e,l)?this._all(o,r):s.push(o))}t=s.pop()}return r}collides(e){let t=this.data;if(!Uy(e,t))return!1;const r=[];for(;t;){for(let i=0;i<t.children.length;i++){const s=t.children[i],a=t.leaf?this.toBBox(s):s;if(Uy(e,a)){if(t.leaf||k2(e,a))return!0;r.push(s)}}t=r.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let r=0;r<e.length;r++)this.insert(e[r]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=t;else if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const r=this.data;this.data=t,t=r}this._insert(t,this.data.height-t.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=gf([]),this}remove(e,t){if(!e)return this;let r=this.data;const i=this.toBBox(e),s=[],a=[];let o,l,u;for(;r||s.length;){if(r||(r=s.pop(),l=s[s.length-1],o=a.pop(),u=!0),r.leaf){const h=Tz(e,r.children,t);if(h!==-1)return r.children.splice(h,1),s.push(r),this._condense(s),this}!u&&!r.leaf&&k2(r,i)?(s.push(r),a.push(o),o=0,l=r,r=r.children[0]):l?(o++,r=l.children[o],u=!1):r=null}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){const r=[];for(;e;)e.leaf?t.push(...e.children):r.push(...e.children),e=r.pop();return t}_build(e,t,r,i){const s=r-t+1;let a=this._maxEntries,o;if(s<=a)return o=gf(e.slice(t,r+1)),qd(o,this.toBBox),o;i||(i=Math.ceil(Math.log(s)/Math.log(a)),a=Math.ceil(s/Math.pow(a,i-1))),o=gf([]),o.leaf=!1,o.height=i;const l=Math.ceil(s/a),u=l*Math.ceil(Math.sqrt(a));nk(e,t,r,u,this.compareMinX);for(let h=t;h<=r;h+=u){const f=Math.min(h+u-1,r);nk(e,h,f,l,this.compareMinY);for(let g=h;g<=f;g+=l){const p=Math.min(g+l-1,f);o.children.push(this._build(e,g,p,i-1))}}return qd(o,this.toBBox),o}_chooseSubtree(e,t,r,i){for(;i.push(t),!(t.leaf||i.length-1===r);){let s=1/0,a=1/0,o;for(let l=0;l<t.children.length;l++){const u=t.children[l],h=P2(u),f=bz(e,u)-h;f<a?(a=f,s=h<s?h:s,o=u):f===a&&h<s&&(s=h,o=u)}t=o||t.children[0]}return t}_insert(e,t,r){const i=r?e:this.toBBox(e),s=[],a=this._chooseSubtree(i,this.data,t,s);for(a.children.push(e),Kg(a,i);t>=0&&s[t].children.length>this._maxEntries;)this._split(s,t),t--;this._adjustParentBBoxes(i,s,t)}_split(e,t){const r=e[t],i=r.children.length,s=this._minEntries;this._chooseSplitAxis(r,s,i);const a=this._chooseSplitIndex(r,s,i),o=gf(r.children.splice(a,r.children.length-a));o.height=r.height,o.leaf=r.leaf,qd(r,this.toBBox),qd(o,this.toBBox),t?e[t-1].children.push(o):this._splitRoot(r,o)}_splitRoot(e,t){this.data=gf([e,t]),this.data.height=e.height+1,this.data.leaf=!1,qd(this.data,this.toBBox)}_chooseSplitIndex(e,t,r){let i,s=1/0,a=1/0;for(let o=t;o<=r-t;o++){const l=Hg(e,0,o,this.toBBox),u=Hg(e,o,r,this.toBBox),h=Rz(l,u),f=P2(l)+P2(u);h<s?(s=h,i=o,a=f<a?f:a):h===s&&f<a&&(a=f,i=o)}return i||r-t}_chooseSplitAxis(e,t,r){const i=e.leaf?this.compareMinX:Iz,s=e.leaf?this.compareMinY:Az,a=this._allDistMargin(e,t,r,i),o=this._allDistMargin(e,t,r,s);a<o&&e.children.sort(i)}_allDistMargin(e,t,r,i){e.children.sort(i);const s=this.toBBox,a=Hg(e,0,t,s),o=Hg(e,r-t,r,s);let l=By(a)+By(o);for(let u=t;u<r-t;u++){const h=e.children[u];Kg(a,e.leaf?s(h):h),l+=By(a)}for(let u=r-t-1;u>=t;u--){const h=e.children[u];Kg(o,e.leaf?s(h):h),l+=By(o)}return l}_adjustParentBBoxes(e,t,r){for(let i=r;i>=0;i--)Kg(t[i],e)}_condense(e){for(let t=e.length-1,r;t>=0;t--)e[t].children.length===0?t>0?(r=e[t-1].children,r.splice(r.indexOf(e[t]),1)):this.clear():qd(e[t],this.toBBox)}};function Tz(n,e,t){if(!t)return e.indexOf(n);for(let r=0;r<e.length;r++)if(t(n,e[r]))return r;return-1}function qd(n,e){Hg(n,0,n.children.length,e,n)}function Hg(n,e,t,r,i){i||(i=gf(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(let s=e;s<t;s++){const a=n.children[s];Kg(i,n.leaf?r(a):a)}return i}function Kg(n,e){return n.minX=Math.min(n.minX,e.minX),n.minY=Math.min(n.minY,e.minY),n.maxX=Math.max(n.maxX,e.maxX),n.maxY=Math.max(n.maxY,e.maxY),n}function Iz(n,e){return n.minX-e.minX}function Az(n,e){return n.minY-e.minY}function P2(n){return(n.maxX-n.minX)*(n.maxY-n.minY)}function By(n){return n.maxX-n.minX+(n.maxY-n.minY)}function bz(n,e){return(Math.max(e.maxX,n.maxX)-Math.min(e.minX,n.minX))*(Math.max(e.maxY,n.maxY)-Math.min(e.minY,n.minY))}function Rz(n,e){const t=Math.max(n.minX,e.minX),r=Math.max(n.minY,e.minY),i=Math.min(n.maxX,e.maxX),s=Math.min(n.maxY,e.maxY);return Math.max(0,i-t)*Math.max(0,s-r)}function k2(n,e){return n.minX<=e.minX&&n.minY<=e.minY&&e.maxX<=n.maxX&&e.maxY<=n.maxY}function Uy(n,e){return e.minX<=n.maxX&&e.minY<=n.maxY&&e.maxX>=n.minX&&e.maxY>=n.minY}function gf(n){return{children:n,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function nk(n,e,t,r,i){const s=[e,t];for(;s.length;){if(t=s.pop(),e=s.pop(),t-e<=r)continue;const a=e+Math.ceil((t-e)/r/2)*r;L5(n,a,e,t,i),s.push(e,a,a,t)}}class rk{constructor(e){this.rbush_=new O5(e),this.items_={}}insert(e,t){const r={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:t};this.rbush_.insert(r),this.items_[_n(t)]=r}load(e,t){const r=new Array(t.length);for(let i=0,s=t.length;i<s;i++){const a=e[i],o=t[i],l={minX:a[0],minY:a[1],maxX:a[2],maxY:a[3],value:o};r[i]=l,this.items_[_n(o)]=l}this.rbush_.load(r)}remove(e){const t=_n(e),r=this.items_[t];return delete this.items_[t],this.rbush_.remove(r)!==null}update(e,t){const r=this.items_[_n(t)],i=[r.minX,r.minY,r.maxX,r.maxY];n0(i,e)||(this.remove(t),this.insert(e,t))}getAll(){return this.rbush_.all().map(function(t){return t.value})}getInExtent(e){const t={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this.rbush_.search(t).map(function(i){return i.value})}forEach(e){return this.forEach_(this.getAll(),e)}forEachInExtent(e,t){return this.forEach_(this.getInExtent(e),t)}forEach_(e,t){let r;for(let i=0,s=e.length;i<s;i++)if(r=t(e[i]),r)return r;return r}isEmpty(){return Ph(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(e){const t=this.rbush_.toJSON();return ru(t.minX,t.minY,t.maxX,t.maxY,e)}concat(e){this.rbush_.load(e.rbush_.all());for(const t in e.items_)this.items_[t]=e.items_[t]}}class hA extends Zo{constructor(e){super(),this.projection=Bn(e.projection),this.attributions_=ik(e.attributions),this.attributionsCollapsible_=e.attributionsCollapsible??!0,this.loading=!1,this.state_=e.state!==void 0?e.state:"ready",this.wrapX_=e.wrapX!==void 0?e.wrapX:!1,this.interpolate_=!!e.interpolate,this.viewResolver=null,this.viewRejector=null;const t=this;this.viewPromise_=new Promise(function(r,i){t.viewResolver=r,t.viewRejector=i})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(e){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(e){this.attributions_=ik(e),this.changed()}setState(e){this.state_=e,this.changed()}}function ik(n){return n?typeof n=="function"?n:(Array.isArray(n)||(n=[n]),e=>n):null}const ua={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};class yc extends qo{constructor(e,t,r){super(e),this.feature=t,this.features=r}}class $p extends hA{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:e.wrapX!==void 0?e.wrapX:!0}),this.on,this.once,this.un,this.loader_=Um,this.format_=e.format||null,this.overlaps_=e.overlaps===void 0?!0:e.overlaps,this.url_=e.url,e.loader!==void 0?this.loader_=e.loader:this.url_!==void 0&&(Cn(this.format_,"`format` must be set when `url` is set"),this.loader_=J4(this.url_,this.format_)),this.strategy_=e.strategy!==void 0?e.strategy:xz;const t=e.useSpatialIndex!==void 0?e.useSpatialIndex:!0;this.featuresRtree_=t?new rk:null,this.loadedExtentsRtree_=new rk,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let r,i;Array.isArray(e.features)?i=e.features:e.features&&(r=e.features,i=r.getArray()),!t&&r===void 0&&(r=new ya(i)),i!==void 0&&this.addFeaturesInternal(i),r!==void 0&&this.bindFeaturesCollection_(r)}addFeature(e){this.addFeatureInternal(e),this.changed()}addFeatureInternal(e){const t=_n(e);if(!this.addToIndex_(t,e)){this.featuresCollection_&&this.featuresCollection_.remove(e);return}this.setupChangeEvents_(t,e);const r=e.getGeometry();if(r){const i=r.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(i,e)}else this.nullGeometryFeatures_[t]=e;this.dispatchEvent(new yc(ua.ADDFEATURE,e))}setupChangeEvents_(e,t){t instanceof zs||(this.featureChangeKeys_[e]=[hn(t,zt.CHANGE,this.handleFeatureChange_,this),hn(t,t0.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(e,t){let r=!0;if(t.getId()!==void 0){const i=String(t.getId());if(!(i in this.idIndex_))this.idIndex_[i]=t;else if(t instanceof zs){const s=this.idIndex_[i];s instanceof zs?Array.isArray(s)?s.push(t):this.idIndex_[i]=[s,t]:r=!1}else r=!1}return r&&(Cn(!(e in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[e]=t),r}addFeatures(e){this.addFeaturesInternal(e),this.changed()}addFeaturesInternal(e){const t=[],r=[],i=[];for(let s=0,a=e.length;s<a;s++){const o=e[s],l=_n(o);this.addToIndex_(l,o)&&r.push(o)}for(let s=0,a=r.length;s<a;s++){const o=r[s],l=_n(o);this.setupChangeEvents_(l,o);const u=o.getGeometry();if(u){const h=u.getExtent();t.push(h),i.push(o)}else this.nullGeometryFeatures_[l]=o}if(this.featuresRtree_&&this.featuresRtree_.load(t,i),this.hasListener(ua.ADDFEATURE))for(let s=0,a=r.length;s<a;s++)this.dispatchEvent(new yc(ua.ADDFEATURE,r[s]))}bindFeaturesCollection_(e){let t=!1;this.addEventListener(ua.ADDFEATURE,function(r){t||(t=!0,e.push(r.feature),t=!1)}),this.addEventListener(ua.REMOVEFEATURE,function(r){t||(t=!0,e.remove(r.feature),t=!1)}),e.addEventListener(fs.ADD,r=>{t||(t=!0,this.addFeature(r.element),t=!1)}),e.addEventListener(fs.REMOVE,r=>{t||(t=!0,this.removeFeature(r.element),t=!1)}),this.featuresCollection_=e}clear(e){if(e){for(const r in this.featureChangeKeys_)this.featureChangeKeys_[r].forEach(Wn);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(r=>{this.removeFeatureInternal(r)});for(const r in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[r])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const t=new yc(ua.CLEAR);this.dispatchEvent(t),this.changed()}forEachFeature(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureAtCoordinateDirect(e,t){const r=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(r,function(i){const s=i.getGeometry();if(s instanceof zs||s.intersectsCoordinate(e))return t(i)})}forEachFeatureInExtent(e,t){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureIntersectingExtent(e,t){return this.forEachFeatureInExtent(e,function(r){const i=r.getGeometry();if(i instanceof zs||i.intersectsExtent(e)){const s=t(r);if(s)return s}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let e;return this.featuresCollection_?e=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(e=this.featuresRtree_.getAll(),Ph(this.nullGeometryFeatures_)||An(e,Object.values(this.nullGeometryFeatures_))),e}getFeaturesAtCoordinate(e){const t=[];return this.forEachFeatureAtCoordinateDirect(e,function(r){t.push(r)}),t}getFeaturesInExtent(e,t){if(this.featuresRtree_){if(!(t&&t.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(e);const i=HO(e,t);return[].concat(...i.map(s=>this.featuresRtree_.getInExtent(s)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(e,t){const r=e[0],i=e[1];let s=null;const a=[NaN,NaN];let o=1/0;const l=[-1/0,-1/0,1/0,1/0];return t=t||Bm,this.featuresRtree_.forEachInExtent(l,function(u){if(t(u)){const h=u.getGeometry(),f=o;if(o=h instanceof zs?0:h.closestPointXY(r,i,a,o),o<f){s=u;const g=Math.sqrt(o);l[0]=r-g,l[1]=i-g,l[2]=r+g,l[3]=i+g}}}),s}getExtent(e){return this.featuresRtree_.getExtent(e)}getFeatureById(e){const t=this.idIndex_[e.toString()];return t!==void 0?t:null}getFeatureByUid(e){const t=this.uidIndex_[e];return t!==void 0?t:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(e){const t=e.target,r=_n(t),i=t.getGeometry();if(!i)r in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(t),this.nullGeometryFeatures_[r]=t);else{const a=i.getExtent();r in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[r],this.featuresRtree_&&this.featuresRtree_.insert(a,t)):this.featuresRtree_&&this.featuresRtree_.update(a,t)}const s=t.getId();if(s!==void 0){const a=s.toString();this.idIndex_[a]!==t&&(this.removeFromIdIndex_(t),this.idIndex_[a]=t)}else this.removeFromIdIndex_(t),this.uidIndex_[r]=t;this.changed(),this.dispatchEvent(new yc(ua.CHANGEFEATURE,t))}hasFeature(e){const t=e.getId();return t!==void 0?t in this.idIndex_:_n(e)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&Ph(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(e,t,r){const i=this.loadedExtentsRtree_,s=this.strategy_(e,t,r);for(let a=0,o=s.length;a<o;++a){const l=s[a];i.forEachInExtent(l,function(h){return Fc(h.extent,l)})||(++this.loadingExtentsCount_,this.dispatchEvent(new yc(ua.FEATURESLOADSTART)),this.loader_.call(this,l,t,r,h=>{--this.loadingExtentsCount_,this.dispatchEvent(new yc(ua.FEATURESLOADEND,void 0,h))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new yc(ua.FEATURESLOADERROR))}),i.insert(l,{extent:l.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(e){const t=this.loadedExtentsRtree_,r=t.forEachInExtent(e,function(i){if(n0(i.extent,e))return i});r&&t.remove(r)}removeFeatures(e){let t=!1;for(let r=0,i=e.length;r<i;++r)t=this.removeFeatureInternal(e[r])||t;t&&this.changed()}removeFeature(e){if(!e)return;this.removeFeatureInternal(e)&&this.changed()}removeFeatureInternal(e){const t=_n(e);if(!(t in this.uidIndex_))return!1;t in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[t]:this.featuresRtree_&&this.featuresRtree_.remove(e),this.featureChangeKeys_[t]?.forEach(Wn),delete this.featureChangeKeys_[t];const i=e.getId();if(i!==void 0){const s=i.toString(),a=this.idIndex_[s];a===e?delete this.idIndex_[s]:Array.isArray(a)&&(a.splice(a.indexOf(e),1),a.length===1&&(this.idIndex_[s]=a[0]))}return delete this.uidIndex_[t],this.hasListener(ua.REMOVEFEATURE)&&this.dispatchEvent(new yc(ua.REMOVEFEATURE,e)),!0}removeFromIdIndex_(e){for(const t in this.idIndex_)if(this.idIndex_[t]===e){delete this.idIndex_[t];break}}setLoader(e){this.loader_=e}setUrl(e){Cn(this.format_,"`format` must be set when `url` is set"),this.url_=e,this.setLoader(J4(e,this.format_))}setOverlaps(e){this.overlaps_=e,this.changed()}}class oi{constructor(e){e=e||{},this.patternImage_=null,this.color_=null,e.color!==void 0&&this.setColor(e.color)}clone(){const e=this.getColor();return new oi({color:Array.isArray(e)?e.slice():e||void 0})}getColor(){return this.color_}setColor(e){if(e!==null&&typeof e=="object"&&"src"in e){const t=ax(null,e.src,"anonymous",void 0,e.offset?null:e.color?e.color:null,!(e.offset&&e.size));t.ready().then(()=>{this.patternImage_=null}),t.getImageState()===pt.IDLE&&t.load(),t.getImageState()===pt.LOADING&&(this.patternImage_=t)}this.color_=e}getKey(){const e=this.getColor();return e?e instanceof CanvasPattern||e instanceof CanvasGradient?_n(e):typeof e=="object"&&"src"in e?e.src+":"+e.offset:Oh(e).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}class _s{constructor(e){e=e||{},this.color_=e.color!==void 0?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=e.lineDash!==void 0?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}clone(){const e=this.getColor();return new _s({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(e){this.color_=e}setLineCap(e){this.lineCap_=e}setLineDash(e){this.lineDash_=e}setLineDashOffset(e){this.lineDashOffset_=e}setLineJoin(e){this.lineJoin_=e}setMiterLimit(e){this.miterLimit_=e}setWidth(e){this.width_=e}}function sk(n){return n[0]>0&&n[1]>0}function Cz(n,e,t){return t===void 0&&(t=[0,0]),t[0]=n[0]*e+.5|0,t[1]=n[1]*e+.5|0,t}function xs(n,e){return Array.isArray(n)?n:(e===void 0?e=[n,n]:(e[0]=n,e[1]=n),e)}class Vv{constructor(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=xs(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new Vv({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return Ft()}getImage(e){return Ft()}getHitDetectionImage(){return Ft()}getPixelRatio(e){return 1}getImageState(){return Ft()}getImageSize(){return Ft()}getOrigin(){return Ft()}getSize(){return Ft()}setDisplacement(e){this.displacement_=e}setOpacity(e){this.opacity_=e}setRotateWithView(e){this.rotateWithView_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=xs(e)}listenImageChange(e){Ft()}load(){Ft()}unlistenImageChange(e){Ft()}ready(){return Promise.resolve()}}class Gv extends Vv{constructor(e){super({opacity:1,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,rotation:e.rotation!==void 0?e.rotation:0,scale:e.scale!==void 0?e.scale:1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=e.fill!==void 0?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius=e.radius,this.radius2_=e.radius2,this.angle_=e.angle!==void 0?e.angle:0,this.stroke_=e.stroke!==void 0?e.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?pt.LOADING:pt.LOADED,this.imageState_===pt.LOADING&&this.ready().then(()=>this.imageState_=pt.LOADED),this.render()}clone(){const e=this.getScale(),t=new Gv({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}getAnchor(){const e=this.size_,t=this.getDisplacement(),r=this.getScaleArray();return[e[0]/2-t[0]/r[0],e[1]/2+t[1]/r[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(e){this.fill_=e,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(e){const t=this.fill_?.getKey(),r=`${e},${this.angle_},${this.radius},${this.radius2_},${this.points_},${t}`+Object.values(this.renderOptions_).join(",");let i=xa.get(r,null,null)?.getImage(1);if(!i){const s=this.renderOptions_,a=Math.ceil(s.size*e),o=Hr(a,a);this.draw_(s,o,e),i=o.canvas,xa.set(r,null,null,new E5(i,void 0,null,pt.LOADED,null))}return i}getPixelRatio(e){return e}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e,this.render()}listenImageChange(e){}load(){}unlistenImageChange(e){}calculateLineJoinSize_(e,t,r){if(t===0||this.points_===1/0||e!=="bevel"&&e!=="miter")return t;let i=this.radius,s=this.radius2_===void 0?i:this.radius2_;if(i<s){const B=i;i=s,s=B}const a=this.radius2_===void 0?this.points_:this.points_*2,o=2*Math.PI/a,l=s*Math.sin(o),u=Math.sqrt(s*s-l*l),h=i-u,f=Math.sqrt(l*l+h*h),g=f/l;if(e==="miter"&&g<=r)return g*t;const p=t/2/g,E=t/2*(h/f),w=Math.sqrt((i+p)*(i+p)+E*E)-i;if(this.radius2_===void 0||e==="bevel")return w*2;const T=i*Math.sin(o),I=Math.sqrt(i*i-T*T),P=s-I,D=Math.sqrt(T*T+P*P)/T;if(D<=r){const B=D*t/2-s-i;return 2*Math.max(w,B)}return w*2}createRenderOptions(){let e=s0,t=a0,r=0,i=null,s=0,a,o=0;this.stroke_&&(a=Po(this.stroke_.getColor()??Km),o=this.stroke_.getWidth()??Xm,i=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,t=this.stroke_.getLineJoin()??a0,e=this.stroke_.getLineCap()??s0,r=this.stroke_.getMiterLimit()??Hm);const l=this.calculateLineJoinSize_(t,o,r),u=Math.max(this.radius,this.radius2_||0),h=Math.ceil(2*u+l);return{strokeStyle:a,strokeWidth:o,size:h,lineCap:e,lineDash:i,lineDashOffset:s,lineJoin:t,miterLimit:r}}render(){this.renderOptions_=this.createRenderOptions();const e=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[e,e]}draw_(e,t,r){if(t.scale(r,r),t.translate(e.size/2,e.size/2),this.createPath_(t),this.fill_){let i=this.fill_.getColor();i===null&&(i=gs),t.fillStyle=Po(i),t.fill()}e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}createHitDetectionCanvas_(e){let t;if(this.fill_){let r=this.fill_.getColor(),i=0;typeof r=="string"&&(r=Oh(r)),r===null?i=1:Array.isArray(r)&&(i=r.length===4?r[3]:1),i===0&&(t=Hr(e.size,e.size),this.drawHitDetectionCanvas_(e,t))}return t?t.canvas:this.getImage(1)}createPath_(e){let t=this.points_;const r=this.radius;if(t===1/0)e.arc(0,0,r,0,2*Math.PI);else{const i=this.radius2_===void 0?r:this.radius2_;this.radius2_!==void 0&&(t*=2);const s=this.angle_-Math.PI/2,a=2*Math.PI/t;for(let o=0;o<t;o++){const l=s+o*a,u=o%2===0?r:i;e.lineTo(u*Math.cos(l),u*Math.sin(l))}e.closePath()}}drawHitDetectionCanvas_(e,t){t.translate(e.size/2,e.size/2),this.createPath_(t),t.fillStyle=gs,t.fill(),e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class Dl extends Gv{constructor(e){e=e||{radius:5},super({points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:e.scale!==void 0?e.scale:1,rotation:e.rotation!==void 0?e.rotation:0,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode})}clone(){const e=this.getScale(),t=new Dl({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}setRadius(e){this.radius=e,this.render()}}class ur{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=ak,e.geometry!==void 0&&this.setGeometry(e.geometry),this.fill_=e.fill!==void 0?e.fill:null,this.image_=e.image!==void 0?e.image:null,this.renderer_=e.renderer!==void 0?e.renderer:null,this.hitDetectionRenderer_=e.hitDetectionRenderer!==void 0?e.hitDetectionRenderer:null,this.stroke_=e.stroke!==void 0?e.stroke:null,this.text_=e.text!==void 0?e.text:null,this.zIndex_=e.zIndex}clone(){let e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new ur({geometry:e??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(e){this.renderer_=e}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(e){this.fill_=e}getImage(){return this.image_}setImage(e){this.image_=e}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e}getText(){return this.text_}setText(e){this.text_=e}getZIndex(){return this.zIndex_}setGeometry(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(t){return t.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=ak,this.geometry_=e}setZIndex(e){this.zIndex_=e}}function Pz(n){let e;if(typeof n=="function")e=n;else{let t;Array.isArray(n)?t=n:(Cn(typeof n.getZIndex=="function","Expected an `Style` or an array of `Style`"),t=[n]),e=function(){return t}}return e}let M2=null;function D5(n,e){if(!M2){const t=new oi({color:"rgba(255,255,255,0.4)"}),r=new _s({color:"#3399CC",width:1.25});M2=[new ur({image:new Dl({fill:t,stroke:r,radius:5}),fill:t,stroke:r})]}return M2}function ak(n){return n.getGeometry()}const kz="#333";class sd{constructor(e){e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.keepUpright_=e.keepUpright,this.scale_=e.scale,this.scaleArray_=xs(e.scale!==void 0?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=e.fill!==void 0?e.fill:new oi({color:kz}),this.maxAngle_=e.maxAngle!==void 0?e.maxAngle:Math.PI/4,this.placement_=e.placement!==void 0?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=e.stroke!==void 0?e.stroke:null,this.offsetX_=e.offsetX!==void 0?e.offsetX:0,this.offsetY_=e.offsetY!==void 0?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=e.padding===void 0?null:e.padding,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new sd({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()instanceof oi?this.getFill().clone():this.getFill(),stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(e){this.overflow_=e}setFont(e){this.font_=e}setMaxAngle(e){this.maxAngle_=e}setOffsetX(e){this.offsetX_=e}setOffsetY(e){this.offsetY_=e}setPlacement(e){this.placement_=e}setRepeat(e){this.repeat_=e}setRotateWithView(e){this.rotateWithView_=e}setKeepUpright(e){this.keepUpright_=e}setFill(e){this.fill_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=xs(e!==void 0?e:1)}setStroke(e){this.stroke_=e}setText(e){this.text_=e}setTextAlign(e){this.textAlign_=e}setJustify(e){this.justify_=e}setTextBaseline(e){this.textBaseline_=e}setBackgroundFill(e){this.backgroundFill_=e}setBackgroundStroke(e){this.backgroundStroke_=e}setPadding(e){this.padding_=e}}const ni={ANIMATING:0,INTERACTING:1},Pt={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},zy=[Pt.FILL],Bc=[Pt.STROKE],ph=[Pt.BEGIN_PATH],ok=[Pt.CLOSE_PATH];class Wp extends w5{constructor(e,t,r,i){super(),this.tolerance=e,this.maxExtent=t,this.pixelRatio=i,this.maxLineWidth=0,this.resolution=r,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(e){const t=this.pixelRatio;return t==1?e:e.map(function(r){return r*t})}appendFlatPointCoordinates(e,t){const r=this.getBufferedMaxExtent(),i=this.tmpCoordinate_,s=this.coordinates;let a=s.length;for(let o=0,l=e.length;o<l;o+=t)i[0]=e[o],i[1]=e[o+1],kh(r,i)&&(s[a++]=i[0],s[a++]=i[1]);return a}appendFlatLineCoordinates(e,t,r,i,s,a){const o=this.coordinates;let l=o.length;const u=this.getBufferedMaxExtent();a&&(t+=i);let h=e[t],f=e[t+1];const g=this.tmpCoordinate_;let p=!0,E,x,w;for(E=t+i;E<r;E+=i)g[0]=e[E],g[1]=e[E+1],w=KS(u,g),w!==x?(p&&(o[l++]=h,o[l++]=f,p=!1),o[l++]=g[0],o[l++]=g[1]):w===ei.INTERSECTING?(o[l++]=g[0],o[l++]=g[1],p=!1):p=!0,h=g[0],f=g[1],x=w;return(s&&p||E===t+i)&&(o[l++]=h,o[l++]=f),l}drawCustomCoordinates_(e,t,r,i,s){for(let a=0,o=r.length;a<o;++a){const l=r[a],u=this.appendFlatLineCoordinates(e,t,l,i,!1,!1);s.push(u),t=l}return t}drawCustom(e,t,r,i,s){this.beginGeometry(e,t,s);const a=e.getType(),o=e.getStride(),l=this.coordinates.length;let u,h,f,g,p;switch(a){case"MultiPolygon":u=e.getOrientedFlatCoordinates(),g=[];const E=e.getEndss();p=0;for(let x=0,w=E.length;x<w;++x){const T=[];p=this.drawCustomCoordinates_(u,p,E[x],o,T),g.push(T)}this.instructions.push([Pt.CUSTOM,l,g,e,r,nT,s]),this.hitDetectionInstructions.push([Pt.CUSTOM,l,g,e,i||r,nT,s]);break;case"Polygon":case"MultiLineString":f=[],u=a=="Polygon"?e.getOrientedFlatCoordinates():e.getFlatCoordinates(),p=this.drawCustomCoordinates_(u,0,e.getEnds(),o,f),this.instructions.push([Pt.CUSTOM,l,f,e,r,Wm,s]),this.hitDetectionInstructions.push([Pt.CUSTOM,l,f,e,i||r,Wm,s]);break;case"LineString":case"Circle":u=e.getFlatCoordinates(),h=this.appendFlatLineCoordinates(u,0,u.length,o,!1,!1),this.instructions.push([Pt.CUSTOM,l,h,e,r,Vc,s]),this.hitDetectionInstructions.push([Pt.CUSTOM,l,h,e,i||r,Vc,s]);break;case"MultiPoint":u=e.getFlatCoordinates(),h=this.appendFlatPointCoordinates(u,o),h>l&&(this.instructions.push([Pt.CUSTOM,l,h,e,r,Vc,s]),this.hitDetectionInstructions.push([Pt.CUSTOM,l,h,e,i||r,Vc,s]));break;case"Point":u=e.getFlatCoordinates(),this.coordinates.push(u[0],u[1]),h=this.coordinates.length,this.instructions.push([Pt.CUSTOM,l,h,e,r,void 0,s]),this.hitDetectionInstructions.push([Pt.CUSTOM,l,h,e,i||r,void 0,s]);break}this.endGeometry(t)}beginGeometry(e,t,r){this.beginGeometryInstruction1_=[Pt.BEGIN_GEOMETRY,t,0,e,r],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[Pt.BEGIN_GEOMETRY,t,0,e,r],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const e=this.hitDetectionInstructions;e.reverse();let t;const r=e.length;let i,s,a=-1;for(t=0;t<r;++t)i=e[t],s=i[0],s==Pt.END_GEOMETRY?a=t:s==Pt.BEGIN_GEOMETRY&&(i[2]=t,bB(this.hitDetectionInstructions,a,t),a=-1)}fillStyleToState(e,t={}){if(e){const r=e.getColor();t.fillPatternScale=r&&typeof r=="object"&&"src"in r?this.pixelRatio:1,t.fillStyle=Po(r||gs)}else t.fillStyle=void 0;return t}strokeStyleToState(e,t={}){if(e){const r=e.getColor();t.strokeStyle=Po(r||Km);const i=e.getLineCap();t.lineCap=i!==void 0?i:s0;const s=e.getLineDash();t.lineDash=s?s.slice():Rl;const a=e.getLineDashOffset();t.lineDashOffset=a||Cl;const o=e.getLineJoin();t.lineJoin=o!==void 0?o:a0;const l=e.getWidth();t.lineWidth=l!==void 0?l:Xm;const u=e.getMiterLimit();t.miterLimit=u!==void 0?u:Hm,t.lineWidth>this.maxLineWidth&&(this.maxLineWidth=t.lineWidth,this.bufferedMaxExtent_=null)}else t.strokeStyle=void 0,t.lineCap=void 0,t.lineDash=null,t.lineDashOffset=void 0,t.lineJoin=void 0,t.lineWidth=void 0,t.miterLimit=void 0;return t}setFillStrokeStyle(e,t){const r=this.state;this.fillStyleToState(e,r),this.strokeStyleToState(t,r)}createFill(e){const t=e.fillStyle,r=[Pt.SET_FILL_STYLE,t];return typeof t!="string"&&r.push(e.fillPatternScale),r}applyStroke(e){this.instructions.push(this.createStroke(e))}createStroke(e){return[Pt.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth*this.pixelRatio,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash?this.applyPixelRatio(e.lineDash):null,e.lineDashOffset*this.pixelRatio]}updateFillStyle(e,t){const r=e.fillStyle;(typeof r!="string"||e.currentFillStyle!=r)&&(this.instructions.push(t.call(this,e)),e.currentFillStyle=r)}updateStrokeStyle(e,t){const r=e.strokeStyle,i=e.lineCap,s=e.lineDash,a=e.lineDashOffset,o=e.lineJoin,l=e.lineWidth,u=e.miterLimit;(e.currentStrokeStyle!=r||e.currentLineCap!=i||s!=e.currentLineDash&&!vu(e.currentLineDash,s)||e.currentLineDashOffset!=a||e.currentLineJoin!=o||e.currentLineWidth!=l||e.currentMiterLimit!=u)&&(t.call(this,e),e.currentStrokeStyle=r,e.currentLineCap=i,e.currentLineDash=s,e.currentLineDashOffset=a,e.currentLineJoin=o,e.currentLineWidth=l,e.currentMiterLimit=u)}endGeometry(e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const t=[Pt.END_GEOMETRY,e];this.instructions.push(t),this.hitDetectionInstructions.push(t)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=VO(this.maxExtent),this.maxLineWidth>0)){const e=this.resolution*(this.maxLineWidth+1)/2;zm(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class Mz extends Wp{constructor(e,t,r,i){super(e,t,r,i),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(e,t,r){if(!this.image_||this.maxExtent&&!kh(this.maxExtent,e.getFlatCoordinates()))return;this.beginGeometry(e,t,r);const i=e.getFlatCoordinates(),s=e.getStride(),a=this.coordinates.length,o=this.appendFlatPointCoordinates(i,s);this.instructions.push([Pt.DRAW_IMAGE,a,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Pt.DRAW_IMAGE,a,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}drawMultiPoint(e,t,r){if(!this.image_)return;this.beginGeometry(e,t,r);const i=e.getFlatCoordinates(),s=[];for(let l=0,u=i.length;l<u;l+=e.getStride())(!this.maxExtent||kh(this.maxExtent,i.slice(l,l+2)))&&s.push(i[l],i[l+1]);const a=this.coordinates.length,o=this.appendFlatPointCoordinates(s,2);this.instructions.push([Pt.DRAW_IMAGE,a,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Pt.DRAW_IMAGE,a,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(e,t){const r=e.getAnchor(),i=e.getSize(),s=e.getOrigin();this.imagePixelRatio_=e.getPixelRatio(this.pixelRatio),this.anchorX_=r[0],this.anchorY_=r[1],this.hitDetectionImage_=e.getHitDetectionImage(),this.image_=e.getImage(this.pixelRatio),this.height_=i[1],this.opacity_=e.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=e.getRotateWithView(),this.rotation_=e.getRotation(),this.scale_=e.getScaleArray(),this.width_=i[0],this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}class Nz extends Wp{constructor(e,t,r,i){super(e,t,r,i)}drawFlatCoordinates_(e,t,r,i){const s=this.coordinates.length,a=this.appendFlatLineCoordinates(e,t,r,i,!1,!1),o=[Pt.MOVE_TO_LINE_TO,s,a];return this.instructions.push(o),this.hitDetectionInstructions.push(o),r}drawLineString(e,t,r){const i=this.state,s=i.strokeStyle,a=i.lineWidth;if(s===void 0||a===void 0)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(e,t,r),this.hitDetectionInstructions.push([Pt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Rl,Cl],ph);const o=e.getFlatCoordinates(),l=e.getStride();this.drawFlatCoordinates_(o,0,o.length,l),this.hitDetectionInstructions.push(Bc),this.endGeometry(t)}drawMultiLineString(e,t,r){const i=this.state,s=i.strokeStyle,a=i.lineWidth;if(s===void 0||a===void 0)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(e,t,r),this.hitDetectionInstructions.push([Pt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Rl,Cl],ph);const o=e.getEnds(),l=e.getFlatCoordinates(),u=e.getStride();let h=0;for(let f=0,g=o.length;f<g;++f)h=this.drawFlatCoordinates_(l,h,o[f],u);this.hitDetectionInstructions.push(Bc),this.endGeometry(t)}finish(){const e=this.state;return e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&this.instructions.push(Bc),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(e){e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(Bc),e.lastStroke=this.coordinates.length),e.lastStroke=0,super.applyStroke(e),this.instructions.push(ph)}}class lk extends Wp{constructor(e,t,r,i){super(e,t,r,i)}drawFlatCoordinatess_(e,t,r,i){const s=this.state,a=s.fillStyle!==void 0,o=s.strokeStyle!==void 0,l=r.length;this.instructions.push(ph),this.hitDetectionInstructions.push(ph);for(let u=0;u<l;++u){const h=r[u],f=this.coordinates.length,g=this.appendFlatLineCoordinates(e,t,h,i,!0,!o),p=[Pt.MOVE_TO_LINE_TO,f,g];this.instructions.push(p),this.hitDetectionInstructions.push(p),o&&(this.instructions.push(ok),this.hitDetectionInstructions.push(ok)),t=h}return a&&(this.instructions.push(zy),this.hitDetectionInstructions.push(zy)),o&&(this.instructions.push(Bc),this.hitDetectionInstructions.push(Bc)),t}drawCircle(e,t,r){const i=this.state,s=i.fillStyle,a=i.strokeStyle;if(s===void 0&&a===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([Pt.SET_FILL_STYLE,gs]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Pt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Rl,Cl]);const o=e.getFlatCoordinates(),l=e.getStride(),u=this.coordinates.length;this.appendFlatLineCoordinates(o,0,o.length,l,!1,!1);const h=[Pt.CIRCLE,u];this.instructions.push(ph,h),this.hitDetectionInstructions.push(ph,h),i.fillStyle!==void 0&&(this.instructions.push(zy),this.hitDetectionInstructions.push(zy)),i.strokeStyle!==void 0&&(this.instructions.push(Bc),this.hitDetectionInstructions.push(Bc)),this.endGeometry(t)}drawPolygon(e,t,r){const i=this.state,s=i.fillStyle,a=i.strokeStyle;if(s===void 0&&a===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([Pt.SET_FILL_STYLE,gs]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Pt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Rl,Cl]);const o=e.getEnds(),l=e.getOrientedFlatCoordinates(),u=e.getStride();this.drawFlatCoordinatess_(l,0,o,u),this.endGeometry(t)}drawMultiPolygon(e,t,r){const i=this.state,s=i.fillStyle,a=i.strokeStyle;if(s===void 0&&a===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([Pt.SET_FILL_STYLE,gs]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Pt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Rl,Cl]);const o=e.getEndss(),l=e.getOrientedFlatCoordinates(),u=e.getStride();let h=0;for(let f=0,g=o.length;f<g;++f)h=this.drawFlatCoordinatess_(l,h,o[f],u);this.endGeometry(t)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const e=this.tolerance;if(e!==0){const t=this.coordinates;for(let r=0,i=t.length;r<i;++r)t[r]=Qu(t[r],e)}return super.finish()}setFillStrokeStyles_(){const e=this.state;this.updateFillStyle(e,this.createFill),this.updateStrokeStyle(e,this.applyStroke)}}function Lz(n,e,t,r,i){const s=[];let a=t,o=0,l=e.slice(t,2);for(;o<n&&a+i<r;){const[u,h]=l.slice(-2),f=e[a+i],g=e[a+i+1],p=Math.sqrt((f-u)*(f-u)+(g-h)*(g-h));if(o+=p,o>=n){const E=(n-o+p)/p,x=Us(u,f,E),w=Us(h,g,E);l.push(x,w),s.push(l),l=[x,w],o==n&&(a+=i),o=0}else if(o<n)l.push(e[a+i],e[a+i+1]),a+=i;else{const E=p-o,x=Us(u,f,E/p),w=Us(h,g,E/p);l.push(x,w),s.push(l),l=[x,w],o=0,a+=i}}return o>0&&s.push(l),s}function Oz(n,e,t,r,i){let s=t,a=t,o=0,l=0,u=t,h,f,g,p,E,x,w,T,I,P;for(f=t;f<r;f+=i){const N=e[f],D=e[f+1];E!==void 0&&(I=N-E,P=D-x,p=Math.sqrt(I*I+P*P),w!==void 0&&(l+=g,h=Math.acos((w*I+T*P)/(g*p)),h>n&&(l>o&&(o=l,s=u,a=f),l=0,u=f-i)),g=p,w=I,T=P),E=N,x=D}return l+=p,l>o?[u,f]:[s,a]}const cx={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class Dz extends Wp{constructor(e,t,r,i){super(e,t,r,i),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[gs]={fillStyle:gs},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const e=super.finish();return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e}drawText(e,t,r){const i=this.textFillState_,s=this.textStrokeState_,a=this.textState_;if(this.text_===""||!a||!i&&!s)return;const o=this.coordinates;let l=o.length;const u=e.getType();let h=null,f=e.getStride();if(a.placement==="line"&&(u=="LineString"||u=="MultiLineString"||u=="Polygon"||u=="MultiPolygon")){if(!Qi(this.maxExtent,e.getExtent()))return;let g;if(h=e.getFlatCoordinates(),u=="LineString")g=[h.length];else if(u=="MultiLineString")g=e.getEnds();else if(u=="Polygon")g=e.getEnds().slice(0,1);else if(u=="MultiPolygon"){const w=e.getEndss();g=[];for(let T=0,I=w.length;T<I;++T)g.push(w[T][0])}this.beginGeometry(e,t,r);const p=a.repeat,E=p?void 0:a.textAlign;let x=0;for(let w=0,T=g.length;w<T;++w){let I;p?I=Lz(p*this.resolution,h,x,g[w],f):I=[h.slice(x,g[w])];for(let P=0,N=I.length;P<N;++P){const D=I[P];let B=0,k=D.length;if(E==null){const M=Oz(a.maxAngle,D,0,D.length,2);B=M[0],k=M[1]}for(let M=B;M<k;M+=f)o.push(D[M],D[M+1]);const C=o.length;x=g[w],this.drawChars_(l,C),l=C}}this.endGeometry(t)}else{let g=a.overflow?null:[];switch(u){case"Point":case"MultiPoint":h=e.getFlatCoordinates();break;case"LineString":h=e.getFlatMidpoint();break;case"Circle":h=e.getCenter();break;case"MultiLineString":h=e.getFlatMidpoints(),f=2;break;case"Polygon":h=e.getFlatInteriorPoint(),a.overflow||g.push(h[2]/this.resolution),f=3;break;case"MultiPolygon":const N=e.getFlatInteriorPoints();h=[];for(let D=0,B=N.length;D<B;D+=3)a.overflow||g.push(N[D+2]/this.resolution),h.push(N[D],N[D+1]);if(h.length===0)return;f=2;break}const p=this.appendFlatPointCoordinates(h,f);if(p===l)return;if(g&&(p-l)/2!==h.length/f){let N=l/2;g=g.filter((D,B)=>{const k=o[(N+B)*2]===h[B*f]&&o[(N+B)*2+1]===h[B*f+1];return k||--N,k})}this.saveTextStates_();const E=a.backgroundFill?this.createFill(this.fillStyleToState(a.backgroundFill)):null,x=a.backgroundStroke?this.createStroke(this.strokeStyleToState(a.backgroundStroke)):null;this.beginGeometry(e,t,r);let w=a.padding;if(w!=mh&&(a.scale[0]<0||a.scale[1]<0)){let N=a.padding[0],D=a.padding[1],B=a.padding[2],k=a.padding[3];a.scale[0]<0&&(D=-D,k=-k),a.scale[1]<0&&(N=-N,B=-B),w=[N,D,B,k]}const T=this.pixelRatio;this.instructions.push([Pt.DRAW_IMAGE,l,p,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,w==mh?mh:w.map(function(N){return N*T}),E,x,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,g]);const I=1/T,P=E?E.slice(0):null;P&&(P[1]=gs),this.hitDetectionInstructions.push([Pt.DRAW_IMAGE,l,p,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[I,I],NaN,this.declutterMode_,this.declutterImageWithText_,w,P,x,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?gs:this.fillKey_,this.textOffsetX_,this.textOffsetY_,g]),this.endGeometry(t)}}saveTextStates_(){const e=this.textStrokeState_,t=this.textState_,r=this.textFillState_,i=this.strokeKey_;e&&(i in this.strokeStates||(this.strokeStates[i]={strokeStyle:e.strokeStyle,lineCap:e.lineCap,lineDashOffset:e.lineDashOffset,lineWidth:e.lineWidth,lineJoin:e.lineJoin,miterLimit:e.miterLimit,lineDash:e.lineDash}));const s=this.textKey_;s in this.textStates||(this.textStates[s]={font:t.font,textAlign:t.textAlign||Ym,justify:t.justify,textBaseline:t.textBaseline||ox,scale:t.scale});const a=this.fillKey_;r&&(a in this.fillStates||(this.fillStates[a]={fillStyle:r.fillStyle}))}drawChars_(e,t){const r=this.textStrokeState_,i=this.textState_,s=this.strokeKey_,a=this.textKey_,o=this.fillKey_;this.saveTextStates_();const l=this.pixelRatio,u=cx[i.textBaseline],h=this.textOffsetY_*l,f=this.text_,g=r?r.lineWidth*Math.abs(i.scale[0])/2:0;this.instructions.push([Pt.DRAW_CHARS,e,t,u,i.overflow,o,i.maxAngle,l,h,s,g*l,f,a,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([Pt.DRAW_CHARS,e,t,u,i.overflow,o&&gs,i.maxAngle,l,h,s,g*l,f,a,1/l,this.declutterMode_,this.textKeepUpright_])}setTextStyle(e,t){let r,i,s;if(!e)this.text_="";else{const a=e.getFill();a?(i=this.textFillState_,i||(i={},this.textFillState_=i),i.fillStyle=Po(a.getColor()||gs)):(i=null,this.textFillState_=i);const o=e.getStroke();if(!o)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);const x=o.getLineDash(),w=o.getLineDashOffset(),T=o.getWidth(),I=o.getMiterLimit();s.lineCap=o.getLineCap()||s0,s.lineDash=x?x.slice():Rl,s.lineDashOffset=w===void 0?Cl:w,s.lineJoin=o.getLineJoin()||a0,s.lineWidth=T===void 0?Xm:T,s.miterLimit=I===void 0?Hm:I,s.strokeStyle=Po(o.getColor()||Km)}r=this.textState_;const l=e.getFont()||S5;ez(l);const u=e.getScaleArray();r.overflow=e.getOverflow(),r.font=l,r.maxAngle=e.getMaxAngle(),r.placement=e.getPlacement(),r.textAlign=e.getTextAlign(),r.repeat=e.getRepeat(),r.justify=e.getJustify(),r.textBaseline=e.getTextBaseline()||ox,r.backgroundFill=e.getBackgroundFill(),r.backgroundStroke=e.getBackgroundStroke(),r.padding=e.getPadding()||mh,r.scale=u===void 0?[1,1]:u;const h=e.getOffsetX(),f=e.getOffsetY(),g=e.getRotateWithView(),p=e.getKeepUpright(),E=e.getRotation();this.text_=e.getText()||"",this.textOffsetX_=h===void 0?0:h,this.textOffsetY_=f===void 0?0:f,this.textRotateWithView_=g===void 0?!1:g,this.textKeepUpright_=p===void 0?!0:p,this.textRotation_=E===void 0?0:E,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:_n(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=r.font+r.scale+(r.textAlign||"?")+(r.repeat||"?")+(r.justify||"?")+(r.textBaseline||"?"),this.fillKey_=i&&i.fillStyle?typeof i.fillStyle=="string"?i.fillStyle:"|"+_n(i.fillStyle):""}this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}const Fz={Circle:lk,Default:Wp,Image:Mz,LineString:Nz,Polygon:lk,Text:Dz};class jz{constructor(e,t,r,i){this.tolerance_=e,this.maxExtent_=t,this.pixelRatio_=i,this.resolution_=r,this.buildersByZIndex_={}}finish(){const e={};for(const t in this.buildersByZIndex_){e[t]=e[t]||{};const r=this.buildersByZIndex_[t];for(const i in r){const s=r[i].finish();e[t][i]=s}}return e}getBuilder(e,t){const r=e!==void 0?e.toString():"0";let i=this.buildersByZIndex_[r];i===void 0&&(i={},this.buildersByZIndex_[r]=i);let s=i[t];if(s===void 0){const a=Fz[t];s=new a(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),i[t]=s}return s}}function Vz(n,e,t,r,i,s,a,o,l,u,h,f,g=!0){let p=n[e],E=n[e+1],x=0,w=0,T=0,I=0;function P(){x=p,w=E,e+=r,p=n[e],E=n[e+1],I+=T,T=Math.sqrt((p-x)*(p-x)+(E-w)*(E-w))}do P();while(e<t-r&&I+T<s);let N=T===0?0:(s-I)/T;const D=Us(x,p,N),B=Us(w,E,N),k=e-r,C=I,M=s+o*l(u,i,h);for(;e<t-r&&I+T<M;)P();N=T===0?0:(M-I)/T;const j=Us(x,p,N),O=Us(w,E,N);let W=!1;if(g)if(f){const Re=[D,B,j,O];s5(Re,0,4,2,f,Re,Re),W=Re[0]>Re[2]}else W=D>j;const F=Math.PI,Te=[],Me=k+r===e;e=k,T=0,I=C,p=n[e],E=n[e+1];let Le;if(Me){P(),Le=Math.atan2(E-w,p-x),W&&(Le+=Le>0?-F:F);const Re=(j+D)/2,ue=(O+B)/2;return Te[0]=[Re,ue,(M-s)/2,Le,i],Te}i=i.replace(/\n/g," ");for(let Re=0,ue=i.length;Re<ue;){P();let be=Math.atan2(E-w,p-x);if(W&&(be+=be>0?-F:F),Le!==void 0){let ee=be-Le;if(ee+=ee>F?-2*F:ee<-F?2*F:0,Math.abs(ee)>a)return null}Le=be;const ce=Re;let te=0;for(;Re<ue;++Re){const ee=W?ue-Re-1:Re,fe=o*l(u,i[ee],h);if(e+r<t&&I+T<s+te+fe/2)break;te+=fe}if(Re===ce)continue;const V=W?i.substring(ue-ce,ue-Re):i.substring(ce,Re);N=T===0?0:(s+te/2-I)/T;const ie=Us(x,p,N),ne=Us(w,E,N);Te.push([ie,ne,te/2,be,V]),s+=te}return Te}class F5{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(sx(),{get:(e,t)=>{if(typeof sx()[t]=="function")return this.push_(t),this.pushMethodArgs_},set:(e,t,r)=>(this.push_(t,r),!0)})}push_(...e){const t=this.instructions_,r=this.zIndex+this.offset_;t[r]||(t[r]=[]),t[r].push(...e)}pushMethodArgs_=(...e)=>(this.push_(e),this);pushFunction(e){this.push_(e)}getContext(){return this.context_}draw(e){this.instructions_.forEach(t=>{for(let r=0,i=t.length;r<i;++r){const s=t[r];if(typeof s=="function"){s(e);continue}const a=t[++r];if(typeof e[s]=="function")e[s](...a);else{if(typeof a=="function"){e[s]=a(e);continue}e[s]=a}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const Zd=Zs(),_c=[],gl=[],ml=[],xc=[];function ck(n){return n[3].declutterBox}const uk=new RegExp("[-----]");function N2(n,e){return e==="start"?e=uk.test(n)?"right":"left":e==="end"&&(e=uk.test(n)?"left":"right"),cx[e]}function Gz(n,e,t){return t>0&&n.push(`
`,""),n.push(e,""),n}function Bz(n,e,t){return t%2===0&&(n+=e),n}class Uz{constructor(e,t,r,i,s){this.overlaps=r,this.pixelRatio=t,this.resolution=e,this.alignAndScaleFill_,this.instructions=i.instructions,this.coordinates=i.coordinates,this.coordinateCache_={},this.renderedTransform_=Xa(),this.hitDetectionInstructions=i.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=i.fillStates||{},this.strokeStates=i.strokeStates||{},this.textStates=i.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=s?new F5:null}getZIndexContext(){return this.zIndexContext_}createLabel(e,t,r,i){const s=e+t+r+i;if(this.labels_[s])return this.labels_[s];const a=i?this.strokeStates[i]:null,o=r?this.fillStates[r]:null,l=this.textStates[t],u=this.pixelRatio,h=[l.scale[0]*u,l.scale[1]*u],f=l.justify?cx[l.justify]:N2(Array.isArray(e)?e[0]:e,l.textAlign||Ym),g=i&&a.lineWidth?a.lineWidth:0,p=Array.isArray(e)?e:String(e).split(`
`).reduce(Gz,[]),{width:E,height:x,widths:w,heights:T,lineWidths:I}=nz(l,p),P=E+g,N=[],D=(P+2)*h[0],B=(x+g)*h[1],k={width:D<0?Math.floor(D):Math.ceil(D),height:B<0?Math.floor(B):Math.ceil(B),contextInstructions:N};(h[0]!=1||h[1]!=1)&&N.push("scale",h),i&&(N.push("strokeStyle",a.strokeStyle),N.push("lineWidth",g),N.push("lineCap",a.lineCap),N.push("lineJoin",a.lineJoin),N.push("miterLimit",a.miterLimit),N.push("setLineDash",[a.lineDash]),N.push("lineDashOffset",a.lineDashOffset)),r&&N.push("fillStyle",o.fillStyle),N.push("textBaseline","middle"),N.push("textAlign","center");const C=.5-f;let M=f*P+C*g;const j=[],O=[];let W=0,F=0,Te=0,Me=0,Le;for(let Re=0,ue=p.length;Re<ue;Re+=2){const be=p[Re];if(be===`
`){F+=W,W=0,M=f*P+C*g,++Me;continue}const ce=p[Re+1]||l.font;ce!==Le&&(i&&j.push("font",ce),r&&O.push("font",ce),Le=ce),W=Math.max(W,T[Te]);const te=[be,M+C*w[Te]+f*(w[Te]-I[Me]),.5*(g+W)+F];M+=w[Te],i&&j.push("strokeText",te),r&&O.push("fillText",te),++Te}return Array.prototype.push.apply(N,j),Array.prototype.push.apply(N,O),this.labels_[s]=k,k}replayTextBackground_(e,t,r,i,s,a,o){e.beginPath(),e.moveTo.apply(e,t),e.lineTo.apply(e,r),e.lineTo.apply(e,i),e.lineTo.apply(e,s),e.lineTo.apply(e,t),a&&(this.alignAndScaleFill_=a[2],e.fillStyle=a[1],this.fill_(e)),o&&(this.setStrokeStyle_(e,o),e.stroke())}calculateImageOrLabelDimensions_(e,t,r,i,s,a,o,l,u,h,f,g,p,E,x,w){o*=g[0],l*=g[1];let T=r-o,I=i-l;const P=s+u>e?e-u:s,N=a+h>t?t-h:a,D=E[3]+P*g[0]+E[1],B=E[0]+N*g[1]+E[2],k=T-E[3],C=I-E[0];(x||f!==0)&&(_c[0]=k,xc[0]=k,_c[1]=C,gl[1]=C,gl[0]=k+D,ml[0]=gl[0],ml[1]=C+B,xc[1]=ml[1]);let M;return f!==0?(M=Uo(Xa(),r,i,1,1,f,-r,-i),Wr(M,_c),Wr(M,gl),Wr(M,ml),Wr(M,xc),ru(Math.min(_c[0],gl[0],ml[0],xc[0]),Math.min(_c[1],gl[1],ml[1],xc[1]),Math.max(_c[0],gl[0],ml[0],xc[0]),Math.max(_c[1],gl[1],ml[1],xc[1]),Zd)):ru(Math.min(k,k+D),Math.min(C,C+B),Math.max(k,k+D),Math.max(C,C+B),Zd),p&&(T=Math.round(T),I=Math.round(I)),{drawImageX:T,drawImageY:I,drawImageW:P,drawImageH:N,originX:u,originY:h,declutterBox:{minX:Zd[0],minY:Zd[1],maxX:Zd[2],maxY:Zd[3],value:w},canvasTransform:M,scale:g}}replayImageOrLabel_(e,t,r,i,s,a,o){const l=!!(a||o),u=i.declutterBox,h=o?o[2]*i.scale[0]/2:0;return u.minX-h<=t[0]&&u.maxX+h>=0&&u.minY-h<=t[1]&&u.maxY+h>=0&&(l&&this.replayTextBackground_(e,_c,gl,ml,xc,a,o),rz(e,i.canvasTransform,s,r,i.originX,i.originY,i.drawImageW,i.drawImageH,i.drawImageX,i.drawImageY,i.scale)),!0}fill_(e){const t=this.alignAndScaleFill_;if(t){const r=Wr(this.renderedTransform_,[0,0]),i=512*this.pixelRatio;e.save(),e.translate(r[0]%i,r[1]%i),t!==1&&e.scale(t,t),e.rotate(this.viewRotation_)}e.fill(),t&&e.restore()}setStrokeStyle_(e,t){e.strokeStyle=t[1],t[1]&&(e.lineWidth=t[2],e.lineCap=t[3],e.lineJoin=t[4],e.miterLimit=t[5],e.lineDashOffset=t[7],e.setLineDash(t[6]))}drawLabelWithPointPlacement_(e,t,r,i){const s=this.textStates[t],a=this.createLabel(e,t,i,r),o=this.strokeStates[r],l=this.pixelRatio,u=N2(Array.isArray(e)?e[0]:e,s.textAlign||Ym),h=cx[s.textBaseline||ox],f=o&&o.lineWidth?o.lineWidth:0,g=a.width/l-2*s.scale[0],p=u*g+2*(.5-u)*f,E=h*a.height/l+2*(.5-h)*f;return{label:a,anchorX:p,anchorY:E}}execute_(e,t,r,i,s,a,o,l){const u=this.zIndexContext_;let h;this.pixelCoordinates_&&vu(r,this.renderedTransform_)?h=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),h=Xc(this.coordinates,0,this.coordinates.length,2,r,this.pixelCoordinates_),gU(this.renderedTransform_,r));let f=0;const g=i.length;let p=0,E,x,w,T,I,P,N,D,B,k,C,M,j,O=0,W=0;const F=this.coordinateCache_,Te=this.viewRotation_,Me=Math.round(Math.atan2(-r[1],r[0])*1e12)/1e12,Le={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:Te},Re=this.instructions!=i||this.overlaps?0:200;let ue,be,ce,te;for(;f<g;){const V=i[f];switch(V[0]){case Pt.BEGIN_GEOMETRY:ue=V[1],te=V[3],ue.getGeometry()?o!==void 0&&!Qi(o,te.getExtent())?f=V[2]+1:++f:f=V[2],u&&(u.zIndex=V[4]);break;case Pt.BEGIN_PATH:O>Re&&(this.fill_(e),O=0),W>Re&&(e.stroke(),W=0),!O&&!W&&(e.beginPath(),I=NaN,P=NaN),++f;break;case Pt.CIRCLE:p=V[1];const ne=h[p],ee=h[p+1],fe=h[p+2],Oe=h[p+3],Se=fe-ne,Fe=Oe-ee,je=Math.sqrt(Se*Se+Fe*Fe);e.moveTo(ne+je,ee),e.arc(ne,ee,je,0,2*Math.PI,!0),++f;break;case Pt.CLOSE_PATH:e.closePath(),++f;break;case Pt.CUSTOM:p=V[1],E=V[2];const Qe=V[3],gt=V[4],yt=V[5];Le.geometry=Qe,Le.feature=ue,f in F||(F[f]=[]);const Lt=F[f];yt?yt(h,p,E,2,Lt):(Lt[0]=h[p],Lt[1]=h[p+1],Lt.length=2),u&&(u.zIndex=V[6]),gt(Lt,Le),++f;break;case Pt.DRAW_IMAGE:p=V[1],E=V[2],B=V[3],x=V[4],w=V[5];let nn=V[6];const Ut=V[7],De=V[8],Xt=V[9],Ie=V[10];let me=V[11];const R=V[12];let Et=V[13];T=V[14]||"declutter";const X=V[15];if(!B&&V.length>=20){k=V[19],C=V[20],M=V[21],j=V[22];const nr=this.drawLabelWithPointPlacement_(k,C,M,j);B=nr.label,V[3]=B;const rs=V[23];x=(nr.anchorX-rs)*this.pixelRatio,V[4]=x;const jr=V[24];w=(nr.anchorY-jr)*this.pixelRatio,V[5]=w,nn=B.height,V[6]=nn,Et=B.width,V[13]=Et}let Ot;V.length>25&&(Ot=V[25]);let re,z,le;V.length>17?(re=V[16],z=V[17],le=V[18]):(re=mh,z=null,le=null),Ie&&Me?me+=Te:!Ie&&!Me&&(me-=Te);let $e=0;for(;p<E;p+=2){if(Ot&&Ot[$e++]<Et/this.pixelRatio)continue;const nr=this.calculateImageOrLabelDimensions_(B.width,B.height,h[p],h[p+1],Et,nn,x,w,De,Xt,me,R,s,re,!!z||!!le,ue),rs=[e,t,B,nr,Ut,z,le];if(l){let jr,rr,Vr;if(X){const on=E-p;if(!X[on]){X[on]={args:rs,declutterMode:T};continue}const hr=X[on];jr=hr.args,rr=hr.declutterMode,delete X[on],Vr=ck(jr)}let Gr,br;if(jr&&(rr!=="declutter"||!l.collides(Vr))&&(Gr=!0),(T!=="declutter"||!l.collides(nr.declutterBox))&&(br=!0),rr==="declutter"&&T==="declutter"){const on=Gr&&br;Gr=on,br=on}Gr&&(rr!=="none"&&l.insert(Vr),this.replayImageOrLabel_.apply(this,jr)),br&&(T!=="none"&&l.insert(nr.declutterBox),this.replayImageOrLabel_.apply(this,rs))}else this.replayImageOrLabel_.apply(this,rs)}++f;break;case Pt.DRAW_CHARS:const Ae=V[1],Ze=V[2],ht=V[3],vt=V[4];j=V[5];const wt=V[6],Rt=V[7],en=V[8];M=V[9];const Fr=V[10];k=V[11],Array.isArray(k)&&(k=k.reduce(Bz,"")),C=V[12];const Rs=[V[13],V[13]];T=V[14]||"declutter";const $i=V[15],Wi=this.textStates[C],Ar=Wi.font,ci=[Wi.scale[0]*Rt,Wi.scale[1]*Rt];let Tn;Ar in this.widths_?Tn=this.widths_[Ar]:(Tn={},this.widths_[Ar]=Tn);const Cs=tA(h,Ae,Ze,2),Ps=Math.abs(ci[0])*q4(Ar,k,Tn);if(vt||Ps<=Cs){const nr=this.textStates[C].textAlign,rs=(Cs-Ps)*N2(k,nr),jr=Vz(h,Ae,Ze,2,k,rs,wt,Math.abs(ci[0]),q4,Ar,Tn,Me?0:this.viewRotation_,$i);e:if(jr){const rr=[];let Vr,Gr,br,on,hr;if(M)for(Vr=0,Gr=jr.length;Vr<Gr;++Vr){hr=jr[Vr],br=hr[4],on=this.createLabel(br,C,"",M),x=hr[2]+(ci[0]<0?-Fr:Fr),w=ht*on.height+(.5-ht)*2*Fr*ci[1]/ci[0]-en;const xr=this.calculateImageOrLabelDimensions_(on.width,on.height,hr[0],hr[1],on.width,on.height,x,w,0,0,hr[3],Rs,!1,mh,!1,ue);if(l&&T==="declutter"&&l.collides(xr.declutterBox))break e;rr.push([e,t,on,xr,1,null,null])}if(j)for(Vr=0,Gr=jr.length;Vr<Gr;++Vr){hr=jr[Vr],br=hr[4],on=this.createLabel(br,C,j,""),x=hr[2],w=ht*on.height-en;const xr=this.calculateImageOrLabelDimensions_(on.width,on.height,hr[0],hr[1],on.width,on.height,x,w,0,0,hr[3],Rs,!1,mh,!1,ue);if(l&&T==="declutter"&&l.collides(xr.declutterBox))break e;rr.push([e,t,on,xr,1,null,null])}l&&T!=="none"&&l.load(rr.map(ck));for(let xr=0,is=rr.length;xr<is;++xr)this.replayImageOrLabel_.apply(this,rr[xr])}}++f;break;case Pt.END_GEOMETRY:if(a!==void 0){ue=V[1];const nr=a(ue,te,T);if(nr)return nr}++f;break;case Pt.FILL:Re?O++:this.fill_(e),++f;break;case Pt.MOVE_TO_LINE_TO:for(p=V[1],E=V[2],be=h[p],ce=h[p+1],e.moveTo(be,ce),I=be+.5|0,P=ce+.5|0,p+=2;p<E;p+=2)be=h[p],ce=h[p+1],N=be+.5|0,D=ce+.5|0,(p==E-2||N!==I||D!==P)&&(e.lineTo(be,ce),I=N,P=D);++f;break;case Pt.SET_FILL_STYLE:this.alignAndScaleFill_=V[2],O&&(this.fill_(e),O=0,W&&(e.stroke(),W=0)),e.fillStyle=V[1],++f;break;case Pt.SET_STROKE_STYLE:W&&(e.stroke(),W=0),this.setStrokeStyle_(e,V),++f;break;case Pt.STROKE:Re?W++:e.stroke(),++f;break;default:++f;break}}O&&this.fill_(e),W&&e.stroke()}execute(e,t,r,i,s,a){this.viewRotation_=i,this.execute_(e,t,r,this.instructions,s,void 0,void 0,a)}executeHitDetection(e,t,r,i,s){return this.viewRotation_=r,this.execute_(e,[e.canvas.width,e.canvas.height],t,this.hitDetectionInstructions,!0,i,s)}}const oh=["Polygon","Circle","LineString","Image","Text","Default"],j5=["Image","Text"],zz=oh.filter(n=>!j5.includes(n));class $z{constructor(e,t,r,i,s,a,o){this.maxExtent_=e,this.overlaps_=i,this.pixelRatio_=r,this.resolution_=t,this.renderBuffer_=a,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=Xa(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(s,o)}clip(e,t){const r=this.getClipCoords(t);e.beginPath(),e.moveTo(r[0],r[1]),e.lineTo(r[2],r[3]),e.lineTo(r[4],r[5]),e.lineTo(r[6],r[7]),e.clip()}createExecutors_(e,t){for(const r in e){let i=this.executorsByZIndex_[r];i===void 0&&(i={},this.executorsByZIndex_[r]=i);const s=e[r];for(const a in s){const o=s[a];i[a]=new Uz(this.resolution_,this.pixelRatio_,this.overlaps_,o,t)}}}hasExecutors(e){for(const t in this.executorsByZIndex_){const r=this.executorsByZIndex_[t];for(let i=0,s=e.length;i<s;++i)if(e[i]in r)return!0}return!1}forEachFeatureAtCoordinate(e,t,r,i,s,a){i=Math.round(i);const o=i*2+1,l=Uo(this.hitDetectionTransform_,i+.5,i+.5,1/t,-1/t,-r,-e[0],-e[1]),u=!this.hitDetectionContext_;u&&(this.hitDetectionContext_=Hr(o,o));const h=this.hitDetectionContext_;h.canvas.width!==o||h.canvas.height!==o?(h.canvas.width=o,h.canvas.height=o):u||h.clearRect(0,0,o,o);let f;this.renderBuffer_!==void 0&&(f=Zs(),um(f,e),zm(f,t*(this.renderBuffer_+i),f));const g=Wz(i);let p;function E(D,B,k){const C=h.getImageData(0,0,o,o).data;for(let M=0,j=g.length;M<j;M++)if(C[g[M]]>0){if(!a||k==="none"||p!=="Image"&&p!=="Text"||a.includes(D)){const O=(g[M]-3)/4,W=i-O%o,F=i-(O/o|0),Te=s(D,B,W*W+F*F);if(Te)return Te}h.clearRect(0,0,o,o);break}}const x=Object.keys(this.executorsByZIndex_).map(Number);x.sort(Il);let w,T,I,P,N;for(w=x.length-1;w>=0;--w){const D=x[w].toString();for(I=this.executorsByZIndex_[D],T=oh.length-1;T>=0;--T)if(p=oh[T],P=I[p],P!==void 0&&(N=P.executeHitDetection(h,l,r,E,f),N))return N}}getClipCoords(e){const t=this.maxExtent_;if(!t)return null;const r=t[0],i=t[1],s=t[2],a=t[3],o=[r,i,r,a,s,a,s,i];return Xc(o,0,8,2,e,o),o}isEmpty(){return Ph(this.executorsByZIndex_)}execute(e,t,r,i,s,a,o){const l=Object.keys(this.executorsByZIndex_).map(Number);l.sort(o?AB:Il),a=a||oh;const u=oh.length;for(let h=0,f=l.length;h<f;++h){const g=l[h].toString(),p=this.executorsByZIndex_[g];for(let E=0,x=a.length;E<x;++E){const w=a[E],T=p[w];if(T!==void 0){const I=o===null?void 0:T.getZIndexContext(),P=I?I.getContext():e,N=this.maxExtent_&&w!=="Image"&&w!=="Text";if(N&&(P.save(),this.clip(P,r)),!I||w==="Text"||w==="Image"?T.execute(P,t,r,i,s,o):I.pushFunction(D=>T.execute(D,t,r,i,s,o)),N&&P.restore(),I){I.offset();const D=l[h]*u+oh.indexOf(w);this.deferredZIndexContexts_[D]||(this.deferredZIndexContexts_[D]=[]),this.deferredZIndexContexts_[D].push(I)}}}}this.renderedContext_=e}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const e=this.deferredZIndexContexts_,t=Object.keys(e).map(Number).sort(Il);for(let r=0,i=t.length;r<i;++r)e[t[r]].forEach(s=>{s.draw(this.renderedContext_),s.clear()}),e[t[r]].length=0}}const L2={};function Wz(n){if(L2[n]!==void 0)return L2[n];const e=n*2+1,t=n*n,r=new Array(t+1);for(let s=0;s<=n;++s)for(let a=0;a<=n;++a){const o=s*s+a*a;if(o>t)break;let l=r[o];l||(l=[],r[o]=l),l.push(((n+s)*e+(n+a))*4+3),s>0&&l.push(((n-s)*e+(n+a))*4+3),a>0&&(l.push(((n+s)*e+(n-a))*4+3),s>0&&l.push(((n-s)*e+(n-a))*4+3))}const i=[];for(let s=0,a=r.length;s<a;++s)r[s]&&i.push(...r[s]);return L2[n]=i,i}function hk(n,e,t,r){return t!==void 0&&r!==void 0?[t/n,r/e]:t!==void 0?t/n:r!==void 0?r/e:1}let Hp=class V5 extends Vv{constructor(e){e=e||{};const t=e.opacity!==void 0?e.opacity:1,r=e.rotation!==void 0?e.rotation:0,i=e.scale!==void 0?e.scale:1,s=e.rotateWithView!==void 0?e.rotateWithView:!1;super({opacity:t,rotation:r,scale:i,displacement:e.displacement!==void 0?e.displacement:[0,0],rotateWithView:s,declutterMode:e.declutterMode}),this.anchor_=e.anchor!==void 0?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=e.anchorOrigin!==void 0?e.anchorOrigin:"top-left",this.anchorXUnits_=e.anchorXUnits!==void 0?e.anchorXUnits:"fraction",this.anchorYUnits_=e.anchorYUnits!==void 0?e.anchorYUnits:"fraction",this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null;const a=e.img!==void 0?e.img:null;let o=e.src;Cn(!(o!==void 0&&a),"`image` and `src` cannot be provided at the same time"),(o===void 0||o.length===0)&&a&&(o=a.src||_n(a)),Cn(o!==void 0&&o.length>0,"A defined and non-empty `src` or `image` must be provided"),Cn(!((e.width!==void 0||e.height!==void 0)&&e.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let l;if(e.src!==void 0?l=pt.IDLE:a!==void 0&&("complete"in a?a.complete?l=a.src?pt.LOADED:pt.IDLE:l=pt.LOADING:l=pt.LOADED),this.color_=e.color!==void 0?Oh(e.color):null,this.iconImage_=ax(a,o,this.crossOrigin_,l,this.color_),this.offset_=e.offset!==void 0?e.offset:[0,0],this.offsetOrigin_=e.offsetOrigin!==void 0?e.offsetOrigin:"top-left",this.origin_=null,this.size_=e.size!==void 0?e.size:null,this.initialOptions_,e.width!==void 0||e.height!==void 0){let u,h;if(e.size)[u,h]=e.size;else{const f=this.getImage(1);if(f.width&&f.height)u=f.width,h=f.height;else if(f instanceof HTMLImageElement){this.initialOptions_=e;const g=()=>{if(this.unlistenImageChange(g),!this.initialOptions_)return;const p=this.iconImage_.getSize();this.setScale(hk(p[0],p[1],e.width,e.height))};this.listenImageChange(g);return}}u!==void 0&&this.setScale(hk(u,h,e.width,e.height))}}clone(){let e,t,r;return this.initialOptions_?(t=this.initialOptions_.width,r=this.initialOptions_.height):(e=this.getScale(),e=Array.isArray(e)?e.slice():e),new V5({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:e,width:t,height:r,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let e=this.normalizedAnchor_;if(!e){e=this.anchor_;const i=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!i)return null;e=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(e[0]*=i[0]),this.anchorYUnits_=="fraction"&&(e[1]*=i[1])}if(this.anchorOrigin_!="top-left"){if(!i)return null;e===this.anchor_&&(e=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(e[0]=-e[0]+i[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(e[1]=-e[1]+i[1])}this.normalizedAnchor_=e}const t=this.getDisplacement(),r=this.getScaleArray();return[e[0]-t[0]/r[0],e[1]+t[1]/r[1]]}setAnchor(e){this.anchor_=e,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(e){return this.iconImage_.getImage(e)}getPixelRatio(e){return this.iconImage_.getPixelRatio(e)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let e=this.offset_;if(this.offsetOrigin_!="top-left"){const t=this.getSize(),r=this.iconImage_.getSize();if(!t||!r)return null;e=e.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(e[0]=r[0]-t[0]-e[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(e[1]=r[1]-t[1]-e[1])}return this.origin_=e,this.origin_}getSrc(){return this.iconImage_.getSrc()}setSrc(e){this.iconImage_=ax(null,e,this.crossOrigin_,pt.IDLE,this.color_)}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const e=this.getScaleArray();if(this.size_)return this.size_[0]*e[0];if(this.iconImage_.getImageState()==pt.LOADED)return this.iconImage_.getSize()[0]*e[0]}getHeight(){const e=this.getScaleArray();if(this.size_)return this.size_[1]*e[1];if(this.iconImage_.getImageState()==pt.LOADED)return this.iconImage_.getSize()[1]*e[1]}setScale(e){delete this.initialOptions_,super.setScale(e)}listenImageChange(e){this.iconImage_.addEventListener(zt.CHANGE,e)}load(){this.iconImage_.load()}unlistenImageChange(e){this.iconImage_.removeEventListener(zt.CHANGE,e)}ready(){return this.iconImage_.ready()}};const bo=.5;function Hz(n,e,t,r,i,s,a,o,l){const u=i,h=n[0]*bo,f=n[1]*bo,g=Hr(h,f);g.imageSmoothingEnabled=!1;const p=g.canvas,E=new sz(g,bo,i,null,a,o,null),x=t.length,w=Math.floor((256*256*256-1)/x),T={};for(let P=1;P<=x;++P){const N=t[P-1],D=N.getStyleFunction()||r;if(!D)continue;let B=D(N,s);if(!B)continue;Array.isArray(B)||(B=[B]);const C=(P*w).toString(16).padStart(7,"#00000");for(let M=0,j=B.length;M<j;++M){const O=B[M],W=O.getGeometryFunction()(N);if(!W||!Qi(u,W.getExtent()))continue;const F=O.clone(),Te=F.getFill();Te&&Te.setColor(C);const Me=F.getStroke();Me&&(Me.setColor(C),Me.setLineDash(null)),F.setText(void 0);const Le=O.getImage();if(Le){const ce=Le.getImageSize();if(!ce)continue;const te=Hr(ce[0],ce[1],void 0,{alpha:!1}),V=te.canvas;te.fillStyle=C,te.fillRect(0,0,V.width,V.height),F.setImage(new Hp({img:V,anchor:Le.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:Le.getOrigin(),opacity:1,size:Le.getSize(),scale:Le.getScale(),rotation:Le.getRotation(),rotateWithView:Le.getRotateWithView()}))}const Re=F.getZIndex()||0;let ue=T[Re];ue||(ue={},T[Re]=ue,ue.Polygon=[],ue.Circle=[],ue.LineString=[],ue.Point=[]);const be=W.getType();if(be==="GeometryCollection"){const ce=W.getGeometriesArrayRecursive();for(let te=0,V=ce.length;te<V;++te){const ie=ce[te];ue[ie.getType().replace("Multi","")].push(ie,F)}}else ue[be.replace("Multi","")].push(W,F)}}const I=Object.keys(T).map(Number).sort(Il);for(let P=0,N=I.length;P<N;++P){const D=T[I[P]];for(const B in D){const k=D[B];for(let C=0,M=k.length;C<M;C+=2){E.setStyle(k[C+1]);for(let j=0,O=e.length;j<O;++j)E.setTransform(e[j]),E.drawGeometry(k[C])}}}return g.getImageData(0,0,p.width,p.height)}function Kz(n,e,t){const r=[];if(t){const i=Math.floor(Math.round(n[0])*bo),s=Math.floor(Math.round(n[1])*bo),a=(Yn(i,0,t.width-1)+Yn(s,0,t.height-1)*t.width)*4,o=t.data[a],l=t.data[a+1],h=t.data[a+2]+256*(l+256*o),f=Math.floor((256*256*256-1)/e.length);h&&h%f===0&&r.push(e[h/f-1])}return r}class G5 extends qo{constructor(e,t,r,i){super(e),this.inversePixelTransform=t,this.frameState=r,this.context=i}}const Yz=5;class Xz extends Fp{constructor(e){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e,this.staleKeys_=new Array,this.maxStaleKeys=Yz}getStaleKeys(){return this.staleKeys_}prependStaleKey(e){this.staleKeys_.unshift(e),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(e){return Ft()}getData(e){return null}prepareFrame(e){return Ft()}renderFrame(e,t){return Ft()}forEachFeatureAtCoordinate(e,t,r,i,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(e){const t=e.target;(t.getState()===pt.LOADED||t.getState()===pt.ERROR)&&this.renderIfReadyAndVisible()}loadImage(e){let t=e.getState();return t!=pt.LOADED&&t!=pt.ERROR&&e.addEventListener(zt.CHANGE,this.boundHandleImageChange_),t==pt.IDLE&&(e.load(),t=e.getState()),t==pt.LOADED}renderIfReadyAndVisible(){const e=this.getLayer();e&&e.getVisible()&&e.getSourceState()==="ready"&&e.changed()}renderDeferred(e){}disposeInternal(){delete this.layer_,super.disposeInternal()}}const dk=[];let mf=null;function qz(){mf=Hr(1,1,void 0,{willReadFrequently:!0})}class dA extends Xz{constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=Xa(),this.pixelTransform=Xa(),this.inversePixelTransform=Xa(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(e,t,r){mf||qz(),mf.clearRect(0,0,1,1);let i;try{mf.drawImage(e,t,r,1,1,0,0,1,1),i=mf.getImageData(0,0,1,1).data}catch{return mf=null,null}return i}getBackground(e){let r=this.getLayer().getBackground();return typeof r=="function"&&(r=r(e.viewState.resolution)),r||void 0}useContainer(e,t,r){const i=this.getLayer().getClassName();let s,a;if(e&&e.className===i&&(!r||e&&e.style.backgroundColor&&vu(Oh(e.style.backgroundColor),Oh(r)))){const o=e.firstElementChild;Gc(o)&&(a=o.getContext("2d"))}if(a&&_U(a.canvas.style.transform,t)?(this.container=e,this.context=a,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){s=Ks?p5():document.createElement("div"),s.className=i;let o=s.style;o.position="absolute",o.width="100%",o.height="100%",a=Hr();const l=a.canvas;s.appendChild(l),o=l.style,o.position="absolute",o.left="0",o.transformOrigin="top left",this.container=s,this.context=a}!this.containerReused&&r&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=r)}clipUnrotated(e,t,r){const i=nd(r),s=kv(r),a=Pv(r),o=Cv(r);Wr(t.coordinateToPixelTransform,i),Wr(t.coordinateToPixelTransform,s),Wr(t.coordinateToPixelTransform,a),Wr(t.coordinateToPixelTransform,o);const l=this.inversePixelTransform;Wr(l,i),Wr(l,s),Wr(l,a),Wr(l,o),e.save(),e.beginPath(),e.moveTo(Math.round(i[0]),Math.round(i[1])),e.lineTo(Math.round(s[0]),Math.round(s[1])),e.lineTo(Math.round(a[0]),Math.round(a[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.clip()}prepareContainer(e,t){const r=e.extent,i=e.viewState.resolution,s=e.viewState.rotation,a=e.pixelRatio,o=Math.round(tn(r)/i*a),l=Math.round(Mr(r)/i*a);Uo(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/a,1/a,s,-o/2,-l/2),i5(this.inversePixelTransform,this.pixelTransform);const u=yU(this.pixelTransform);if(this.useContainer(t,u,this.getBackground(e)),!this.containerReused){const h=this.context.canvas;h.width!=o||h.height!=l?(h.width=o,h.height=l):this.context.clearRect(0,0,o,l),u!==h.style.transform&&(h.style.transform=u)}}dispatchRenderEvent_(e,t,r){const i=this.getLayer();if(i.hasListener(e)){const s=new G5(e,this.inversePixelTransform,r,t);i.dispatchEvent(s)}}preRender(e,t){this.frameState=t,!t.declutter&&this.dispatchRenderEvent_(_a.PRERENDER,e,t)}postRender(e,t){t.declutter||this.dispatchRenderEvent_(_a.POSTRENDER,e,t)}renderDeferredInternal(e){}getRenderContext(e){return e.declutter&&!this.deferredContext_&&(this.deferredContext_=new F5),e.declutter?this.deferredContext_.getContext():this.context}renderDeferred(e){e.declutter&&(this.dispatchRenderEvent_(_a.PRERENDER,this.context,e),e.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(e),this.dispatchRenderEvent_(_a.POSTRENDER,this.context,e))}getRenderTransform(e,t,r,i,s,a,o){const l=s/2,u=a/2,h=i/t,f=-h,g=-e[0]+o,p=-e[1];return Uo(this.tempTransform,l,u,h,f,-r,g,p)}disposeInternal(){delete this.frameState,super.disposeInternal()}}class Zz extends dA{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=Zs(),this.wrappedRenderedExtent_=Zs(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(e,t,r){const i=t.extent,s=t.viewState,a=s.center,o=s.resolution,l=s.projection,u=s.rotation,h=l.getExtent(),f=this.getLayer().getSource(),g=this.getLayer().getDeclutter(),p=t.pixelRatio,E=t.viewHints,x=!(E[ni.ANIMATING]||E[ni.INTERACTING]),w=this.context,T=Math.round(tn(i)/o*p),I=Math.round(Mr(i)/o*p),P=f.getWrapX()&&l.canWrapX(),N=P?tn(h):null,D=P?Math.ceil((i[2]-h[2])/N)+1:1;let B=P?Math.floor((i[0]-h[0])/N):0;do{let k=this.getRenderTransform(a,o,0,p,T,I,B*N);t.declutter&&(k=k.slice(0)),e.execute(w,[w.canvas.width,w.canvas.height],k,u,x,r===void 0?oh:r?j5:zz,r?g&&t.declutter[g]:void 0)}while(++B<D)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=Hr(this.context.canvas.width,this.context.canvas.height,dk))}resetDrawContext_(){if(this.opacity_!==1&&this.targetContext_){const e=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=e,jv(this.context),dk.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(e){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,e,!0)}renderDeferredInternal(e){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(e,t){const r=e.layerStatesArray[e.layerIndex];this.opacity_=r.opacity;const i=e.viewState;this.prepareContainer(e,t);const s=this.context,a=this.replayGroup_;let o=a&&!a.isEmpty();if(!o&&!(this.getLayer().hasListener(_a.PRERENDER)||this.getLayer().hasListener(_a.POSTRENDER)))return this.container;if(this.setDrawContext_(),this.preRender(s,e),i.projection,this.clipped_=!1,o&&r.extent&&this.clipping){const l=Co(r.extent);o=Qi(l,e.extent),this.clipped_=o&&!Fc(l,e.extent),this.clipped_&&this.clipUnrotated(s,e,l)}return o&&this.renderWorlds(a,e,this.getLayer().getDeclutter()?!1:void 0),!e.declutter&&this.clipped_&&s.restore(),this.postRender(s,e),this.renderedRotation_!==i.rotation&&(this.renderedRotation_=i.rotation,this.hitDetectionImageData_=null),e.declutter||this.resetDrawContext_(),this.container}getFeatures(e){return new Promise(t=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const r=this.frameState.size.slice(),i=this.renderedCenter_,s=this.renderedResolution_,a=this.renderedRotation_,o=this.renderedProjection_,l=this.wrappedRenderedExtent_,u=this.getLayer(),h=[],f=r[0]*bo,g=r[1]*bo;h.push(this.getRenderTransform(i,s,a,bo,f,g,0).slice());const p=u.getSource(),E=o.getExtent();if(p.getWrapX()&&o.canWrapX()&&!Fc(E,l)){let x=l[0];const w=tn(E);let T=0,I;for(;x<E[0];)--T,I=w*T,h.push(this.getRenderTransform(i,s,a,bo,f,g,I).slice()),x+=w;for(T=0,x=l[2];x>E[2];)++T,I=w*T,h.push(this.getRenderTransform(i,s,a,bo,f,g,I).slice()),x-=w}this.hitDetectionImageData_=Hz(r,h,this.renderedFeatures_,u.getStyleFunction(),l,s,a,Z4(s,this.renderedPixelRatio_))}t(Kz(e,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(e,t,r,i,s){if(!this.replayGroup_)return;const a=t.viewState.resolution,o=t.viewState.rotation,l=this.getLayer(),u={},h=function(g,p,E){const x=_n(g),w=u[x];if(w){if(w!==!0&&E<w.distanceSq){if(E===0)return u[x]=!0,s.splice(s.lastIndexOf(w),1),i(g,l,p);w.geometry=p,w.distanceSq=E}}else{if(E===0)return u[x]=!0,i(g,l,p);s.push(u[x]={feature:g,layer:l,geometry:p,distanceSq:E,callback:i})}},f=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(e,a,o,r,h,f?t.declutter?.[f]?.all().map(g=>g.value):null)}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}prepareFrame(e){const t=this.getLayer(),r=t.getSource();if(!r)return!1;const i=e.viewHints[ni.ANIMATING],s=e.viewHints[ni.INTERACTING],a=t.getUpdateWhileAnimating(),o=t.getUpdateWhileInteracting();if(this.ready&&!a&&i||!o&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const l=e.extent,u=e.viewState,h=u.projection,f=u.resolution,g=e.pixelRatio,p=t.getRevision(),E=t.getRenderBuffer();let x=t.getRenderOrder();x===void 0&&(x=oz);const w=u.center.slice(),T=zm(l,E*f),I=T.slice(),P=[T.slice()],N=h.getExtent();if(r.getWrapX()&&h.canWrapX()&&!Fc(N,e.extent)){const Te=tn(N),Me=Math.max(tn(T)/2,Te);T[0]=N[0]-Me,T[2]=N[2]+Me,YO(w,h);const Le=WO(P[0],h);Le[0]<N[0]&&Le[2]<N[2]?P.push([Le[0]+Te,Le[1],Le[2]+Te,Le[3]]):Le[0]>N[0]&&Le[2]>N[2]&&P.push([Le[0]-Te,Le[1],Le[2]-Te,Le[3]])}if(this.ready&&this.renderedResolution_==f&&this.renderedRevision_==p&&this.renderedRenderOrder_==x&&this.renderedFrameDeclutter_===!!e.declutter&&Fc(this.wrappedRenderedExtent_,T))return vu(this.renderedExtent_,I)||(this.hitDetectionImageData_=null,this.renderedExtent_=I),this.renderedCenter_=w,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const D=new jz(b5(f,g),T,f,g);let B;for(let Te=0,Me=P.length;Te<Me;++Te)r.loadFeatures(P[Te],f,h);const k=Z4(f,g);let C=!0;const M=(Te,Me)=>{let Le;const Re=Te.getStyleFunction()||t.getStyleFunction();if(Re&&(Le=Re(Te,f)),Le){const ue=this.renderFeature(Te,k,Le,D,B,this.getLayer().getDeclutter(),Me);C=C&&!ue}},j=r5(T),O=r.getFeaturesInExtent(j);x&&O.sort(x);for(let Te=0,Me=O.length;Te<Me;++Te)M(O[Te],Te);this.renderedFeatures_=O,this.ready=C;const W=D.finish(),F=new $z(T,f,g,r.getOverlaps(),W,t.getRenderBuffer(),!!e.declutter);return this.renderedResolution_=f,this.renderedRevision_=p,this.renderedRenderOrder_=x,this.renderedFrameDeclutter_=!!e.declutter,this.renderedExtent_=I,this.wrappedRenderedExtent_=T,this.renderedCenter_=w,this.renderedProjection_=h,this.renderedPixelRatio_=g,this.replayGroup_=F,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(e,t,r,i,s,a,o){if(!r)return!1;let l=!1;if(Array.isArray(r))for(let u=0,h=r.length;u<h;++u)l=Q4(i,e,r[u],t,this.boundHandleStyleImageChange_,s,a,o)||l;else l=Q4(i,e,r,t,this.boundHandleStyleImageChange_,s,a,o);return l}}let ad=0;const Zi=1<<ad++,cn=1<<ad++,ms=1<<ad++,Ua=1<<ad++,Dh=1<<ad++,Yg=1<<ad++,$y=Math.pow(2,ad)-1,fA={[Zi]:"boolean",[cn]:"number",[ms]:"string",[Ua]:"color",[Dh]:"number[]",[Yg]:"size"},Qz=Object.keys(fA).map(Number).sort(Il);function Jz(n){return n in fA}function Xg(n){const e=[];for(const t of Qz)qg(n,t)&&e.push(fA[t]);return e.length===0?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function qg(n,e){return(n&e)===e}function vc(n,e){return n===e}class $r{constructor(e,t){if(!Jz(e))throw new Error(`literal expressions must have a specific type, got ${Xg(e)}`);this.type=e,this.value=t}}class e${constructor(e,t,...r){this.type=e,this.operator=t,this.args=r}}function B5(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function wi(n,e,t){switch(typeof n){case"boolean":{if(vc(e,ms))return new $r(ms,n?"true":"false");if(!qg(e,Zi))throw new Error(`got a boolean, but expected ${Xg(e)}`);return new $r(Zi,n)}case"number":{if(vc(e,Yg))return new $r(Yg,xs(n));if(vc(e,Zi))return new $r(Zi,!!n);if(vc(e,ms))return new $r(ms,n.toString());if(!qg(e,cn))throw new Error(`got a number, but expected ${Xg(e)}`);return new $r(cn,n)}case"string":{if(vc(e,Ua))return new $r(Ua,sA(n));if(vc(e,Zi))return new $r(Zi,!!n);if(!qg(e,ms))throw new Error(`got a string, but expected ${Xg(e)}`);return new $r(ms,n)}}if(!Array.isArray(n))throw new Error("expression must be an array or a primitive value");if(n.length===0)throw new Error("empty expression");if(typeof n[0]=="string")return h$(n,e,t);for(const r of n)if(typeof r!="number")throw new Error("expected an array of numbers");if(vc(e,Yg)){if(n.length!==2)throw new Error(`expected an array of two values for a size, got ${n.length}`);return new $r(Yg,n)}if(vc(e,Ua)){if(n.length===3)return new $r(Ua,[...n,1]);if(n.length===4)return new $r(Ua,n);throw new Error(`expected an array of 3 or 4 values for a color, got ${n.length}`)}if(!qg(e,Dh))throw new Error(`got an array of numbers, but expected ${Xg(e)}`);return new $r(Dh,n)}const Ne={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},t$={[Ne.Get]:Gt(Yt(1,1/0),fk),[Ne.Var]:Gt(Yt(1,1),n$),[Ne.Has]:Gt(Yt(1,1/0),fk),[Ne.Id]:Gt(r$,Qd),[Ne.Concat]:Gt(Yt(2,1/0),vn(ms)),[Ne.GeometryType]:Gt(i$,Qd),[Ne.LineMetric]:Gt(Qd),[Ne.Resolution]:Gt(O2,Qd),[Ne.Zoom]:Gt(O2,Qd),[Ne.Time]:Gt(O2,Qd),[Ne.Any]:Gt(Yt(2,1/0),vn(Zi)),[Ne.All]:Gt(Yt(2,1/0),vn(Zi)),[Ne.Not]:Gt(Yt(1,1),vn(Zi)),[Ne.Equal]:Gt(Yt(2,2),vn($y)),[Ne.NotEqual]:Gt(Yt(2,2),vn($y)),[Ne.GreaterThan]:Gt(Yt(2,2),vn(cn)),[Ne.GreaterThanOrEqualTo]:Gt(Yt(2,2),vn(cn)),[Ne.LessThan]:Gt(Yt(2,2),vn(cn)),[Ne.LessThanOrEqualTo]:Gt(Yt(2,2),vn(cn)),[Ne.Multiply]:Gt(Yt(2,1/0),gk),[Ne.Coalesce]:Gt(Yt(2,1/0),gk),[Ne.Divide]:Gt(Yt(2,2),vn(cn)),[Ne.Add]:Gt(Yt(2,1/0),vn(cn)),[Ne.Subtract]:Gt(Yt(2,2),vn(cn)),[Ne.Clamp]:Gt(Yt(3,3),vn(cn)),[Ne.Mod]:Gt(Yt(2,2),vn(cn)),[Ne.Pow]:Gt(Yt(2,2),vn(cn)),[Ne.Abs]:Gt(Yt(1,1),vn(cn)),[Ne.Floor]:Gt(Yt(1,1),vn(cn)),[Ne.Ceil]:Gt(Yt(1,1),vn(cn)),[Ne.Round]:Gt(Yt(1,1),vn(cn)),[Ne.Sin]:Gt(Yt(1,1),vn(cn)),[Ne.Cos]:Gt(Yt(1,1),vn(cn)),[Ne.Atan]:Gt(Yt(1,2),vn(cn)),[Ne.Sqrt]:Gt(Yt(1,1),vn(cn)),[Ne.Match]:Gt(Yt(4,1/0),mk,a$),[Ne.Between]:Gt(Yt(3,3),vn(cn)),[Ne.Interpolate]:Gt(Yt(6,1/0),mk,o$),[Ne.Case]:Gt(Yt(3,1/0),s$,l$),[Ne.In]:Gt(Yt(2,2),c$),[Ne.Number]:Gt(Yt(1,1/0),vn($y)),[Ne.String]:Gt(Yt(1,1/0),vn($y)),[Ne.Array]:Gt(Yt(1,1/0),vn(cn)),[Ne.Color]:Gt(Yt(1,4),vn(cn)),[Ne.Band]:Gt(Yt(1,3),vn(cn)),[Ne.Palette]:Gt(Yt(2,2),u$),[Ne.ToString]:Gt(Yt(1,1),vn(Zi|cn|ms|Ua))};function fk(n,e,t){const r=n.length-1,i=new Array(r);for(let s=0;s<r;++s){const a=n[s+1];switch(typeof a){case"number":{i[s]=new $r(cn,a);break}case"string":{i[s]=new $r(ms,a);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${a}`)}s===0&&t.properties.add(String(a))}return i}function n$(n,e,t){const r=n[1];if(typeof r!="string")throw new Error("expected a string argument for var operation");return t.variables.add(r),[new $r(ms,r)]}function r$(n,e,t){t.featureId=!0}function i$(n,e,t){t.geometryType=!0}function O2(n,e,t){t.mapState=!0}function Qd(n,e,t){const r=n[0];if(n.length!==1)throw new Error(`expected no arguments for ${r} operation`);return[]}function Yt(n,e){return function(t,r,i){const s=t[0],a=t.length-1;if(n===e){if(a!==n){const o=n===1?"":"s";throw new Error(`expected ${n} argument${o} for ${s}, got ${a}`)}}else if(a<n||a>e){const o=e===1/0?`${n} or more`:`${n} to ${e}`;throw new Error(`expected ${o} arguments for ${s}, got ${a}`)}}}function gk(n,e,t){const r=n.length-1,i=new Array(r);for(let s=0;s<r;++s){const a=wi(n[s+1],e,t);i[s]=a}return i}function vn(n){return function(e,t,r){const i=e.length-1,s=new Array(i);for(let a=0;a<i;++a){const o=wi(e[a+1],n,r);s[a]=o}return s}}function s$(n,e,t){const r=n[0],i=n.length-1;if(i%2===0)throw new Error(`expected an odd number of arguments for ${r}, got ${i} instead`)}function mk(n,e,t){const r=n[0],i=n.length-1;if(i%2===1)throw new Error(`expected an even number of arguments for operation ${r}, got ${i} instead`)}function a$(n,e,t){const r=n.length-1,i=ms|cn|Zi,s=wi(n[1],i,t),a=wi(n[n.length-1],e,t),o=new Array(r-2);for(let l=0;l<r-2;l+=2){try{const u=wi(n[l+2],s.type,t);o[l]=u}catch(u){throw new Error(`failed to parse argument ${l+1} of match expression: ${u.message}`)}try{const u=wi(n[l+3],a.type,t);o[l+1]=u}catch(u){throw new Error(`failed to parse argument ${l+2} of match expression: ${u.message}`)}}return[s,...o,a]}function o$(n,e,t){const r=n[1];let i;switch(r[0]){case"linear":i=1;break;case"exponential":const l=r[1];if(typeof l!="number"||l<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(l)} instead`);i=l;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(r)}`)}const s=new $r(cn,i);let a;try{a=wi(n[2],cn,t)}catch(l){throw new Error(`failed to parse argument 1 in interpolate expression: ${l.message}`)}const o=new Array(n.length-3);for(let l=0;l<o.length;l+=2){try{const u=wi(n[l+3],cn,t);o[l]=u}catch(u){throw new Error(`failed to parse argument ${l+2} for interpolate expression: ${u.message}`)}try{const u=wi(n[l+4],e,t);o[l+1]=u}catch(u){throw new Error(`failed to parse argument ${l+3} for interpolate expression: ${u.message}`)}}return[s,a,...o]}function l$(n,e,t){const r=wi(n[n.length-1],e,t),i=new Array(n.length-1);for(let s=0;s<i.length-1;s+=2){try{const a=wi(n[s+1],Zi,t);i[s]=a}catch(a){throw new Error(`failed to parse argument ${s} of case expression: ${a.message}`)}try{const a=wi(n[s+2],r.type,t);i[s+1]=a}catch(a){throw new Error(`failed to parse argument ${s+1} of case expression: ${a.message}`)}}return i[i.length-1]=r,i}function c$(n,e,t){let r=n[2];if(!Array.isArray(r))throw new Error('the second argument for the "in" operator must be an array');let i;if(typeof r[0]=="string"){if(r[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(r[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');r=r[1],i=ms}else i=cn;const s=new Array(r.length);for(let o=0;o<s.length;o++)try{const l=wi(r[o],i,t);s[o]=l}catch(l){throw new Error(`failed to parse haystack item ${o} for "in" expression: ${l.message}`)}return[wi(n[1],i,t),...s]}function u$(n,e,t){let r;try{r=wi(n[1],cn,t)}catch(a){throw new Error(`failed to parse first argument in palette expression: ${a.message}`)}const i=n[2];if(!Array.isArray(i))throw new Error("the second argument of palette must be an array");const s=new Array(i.length);for(let a=0;a<s.length;a++){let o;try{o=wi(i[a],Ua,t)}catch(l){throw new Error(`failed to parse color at index ${a} in palette expression: ${l.message}`)}if(!(o instanceof $r))throw new Error(`the palette color at index ${a} must be a literal value`);s[a]=o}return[r,...s]}function Gt(...n){return function(e,t,r){const i=e[0];let s;for(let a=0;a<n.length;a++){const o=n[a](e,t,r);if(a==n.length-1){if(!o)throw new Error("expected last argument validator to return the parsed args");s=o}}return new e$(t,i,...s)}}function h$(n,e,t){const r=n[0],i=t$[r];if(!i)throw new Error(`unknown operator: ${r}`);return i(n,e,t)}function U5(n){if(!n)return"";const e=n.getType();switch(e){case"Point":case"LineString":case"Polygon":return e;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return e.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return U5(n.getGeometries()[0]);default:return""}}function z5(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function $l(n,e,t){const r=wi(n,e,t);return ro(r)}function ro(n,e){if(n instanceof $r){if(n.type===Ua&&typeof n.value=="string"){const r=sA(n.value);return function(){return r}}return function(){return n.value}}const t=n.operator;switch(t){case Ne.Number:case Ne.String:case Ne.Coalesce:return d$(n);case Ne.Get:case Ne.Var:case Ne.Has:return f$(n);case Ne.Id:return r=>r.featureId;case Ne.GeometryType:return r=>r.geometryType;case Ne.Concat:{const r=n.args.map(i=>ro(i));return i=>"".concat(...r.map(s=>s(i).toString()))}case Ne.Resolution:return r=>r.resolution;case Ne.Any:case Ne.All:case Ne.Between:case Ne.In:case Ne.Not:return m$(n);case Ne.Equal:case Ne.NotEqual:case Ne.LessThan:case Ne.LessThanOrEqualTo:case Ne.GreaterThan:case Ne.GreaterThanOrEqualTo:return g$(n);case Ne.Multiply:case Ne.Divide:case Ne.Add:case Ne.Subtract:case Ne.Clamp:case Ne.Mod:case Ne.Pow:case Ne.Abs:case Ne.Floor:case Ne.Ceil:case Ne.Round:case Ne.Sin:case Ne.Cos:case Ne.Atan:case Ne.Sqrt:return p$(n);case Ne.Case:return y$(n);case Ne.Match:return _$(n);case Ne.Interpolate:return x$(n);case Ne.ToString:return v$(n);default:throw new Error(`Unsupported operator ${t}`)}}function d$(n,e){const t=n.operator,r=n.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=ro(n.args[s]);switch(t){case Ne.Coalesce:return s=>{for(let a=0;a<r;++a){const o=i[a](s);if(typeof o<"u"&&o!==null)return o}throw new Error("Expected one of the values to be non-null")};case Ne.Number:case Ne.String:return s=>{for(let a=0;a<r;++a){const o=i[a](s);if(typeof o===t)return o}throw new Error(`Expected one of the values to be a ${t}`)};default:throw new Error(`Unsupported assertion operator ${t}`)}}function f$(n,e){const r=n.args[0].value;switch(n.operator){case Ne.Get:return i=>{const s=n.args;let a=i.properties[r];for(let o=1,l=s.length;o<l;++o){const h=s[o].value;a=a[h]}return a};case Ne.Var:return i=>i.variables[r];case Ne.Has:return i=>{const s=n.args;if(!(r in i.properties))return!1;let a=i.properties[r];for(let o=1,l=s.length;o<l;++o){const h=s[o].value;if(!a||!Object.hasOwn(a,h))return!1;a=a[h]}return!0};default:throw new Error(`Unsupported accessor operator ${n.operator}`)}}function g$(n,e){const t=n.operator,r=ro(n.args[0]),i=ro(n.args[1]);switch(t){case Ne.Equal:return s=>r(s)===i(s);case Ne.NotEqual:return s=>r(s)!==i(s);case Ne.LessThan:return s=>r(s)<i(s);case Ne.LessThanOrEqualTo:return s=>r(s)<=i(s);case Ne.GreaterThan:return s=>r(s)>i(s);case Ne.GreaterThanOrEqualTo:return s=>r(s)>=i(s);default:throw new Error(`Unsupported comparison operator ${t}`)}}function m$(n,e){const t=n.operator,r=n.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=ro(n.args[s]);switch(t){case Ne.Any:return s=>{for(let a=0;a<r;++a)if(i[a](s))return!0;return!1};case Ne.All:return s=>{for(let a=0;a<r;++a)if(!i[a](s))return!1;return!0};case Ne.Between:return s=>{const a=i[0](s),o=i[1](s),l=i[2](s);return a>=o&&a<=l};case Ne.In:return s=>{const a=i[0](s);for(let o=1;o<r;++o)if(a===i[o](s))return!0;return!1};case Ne.Not:return s=>!i[0](s);default:throw new Error(`Unsupported logical operator ${t}`)}}function p$(n,e){const t=n.operator,r=n.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=ro(n.args[s]);switch(t){case Ne.Multiply:return s=>{let a=1;for(let o=0;o<r;++o)a*=i[o](s);return a};case Ne.Divide:return s=>i[0](s)/i[1](s);case Ne.Add:return s=>{let a=0;for(let o=0;o<r;++o)a+=i[o](s);return a};case Ne.Subtract:return s=>i[0](s)-i[1](s);case Ne.Clamp:return s=>{const a=i[0](s),o=i[1](s);if(a<o)return o;const l=i[2](s);return a>l?l:a};case Ne.Mod:return s=>i[0](s)%i[1](s);case Ne.Pow:return s=>Math.pow(i[0](s),i[1](s));case Ne.Abs:return s=>Math.abs(i[0](s));case Ne.Floor:return s=>Math.floor(i[0](s));case Ne.Ceil:return s=>Math.ceil(i[0](s));case Ne.Round:return s=>Math.round(i[0](s));case Ne.Sin:return s=>Math.sin(i[0](s));case Ne.Cos:return s=>Math.cos(i[0](s));case Ne.Atan:return r===2?s=>Math.atan2(i[0](s),i[1](s)):s=>Math.atan(i[0](s));case Ne.Sqrt:return s=>Math.sqrt(i[0](s));default:throw new Error(`Unsupported numeric operator ${t}`)}}function y$(n,e){const t=n.args.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=ro(n.args[i]);return i=>{for(let s=0;s<t-1;s+=2)if(r[s](i))return r[s+1](i);return r[t-1](i)}}function _$(n,e){const t=n.args.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=ro(n.args[i]);return i=>{const s=r[0](i);for(let a=1;a<t-1;a+=2)if(s===r[a](i))return r[a+1](i);return r[t-1](i)}}function x$(n,e){const t=n.args.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=ro(n.args[i]);return i=>{const s=r[0](i),a=r[1](i);let o,l;for(let u=2;u<t;u+=2){const h=r[u](i);let f=r[u+1](i);const g=Array.isArray(f);if(g&&(f=WU(f)),h>=a)return u===2?f:g?E$(s,a,o,l,h,f):Zg(s,a,o,l,h,f);o=h,l=f}return l}}function v$(n,e){const t=n.operator,r=n.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=ro(n.args[s]);switch(t){case Ne.ToString:return s=>{const a=i[0](s);return n.args[0].type===Ua?aA(a):a.toString()};default:throw new Error(`Unsupported convert operator ${t}`)}}function Zg(n,e,t,r,i,s){const a=i-t;if(a===0)return r;const o=e-t,l=n===1?o/a:(Math.pow(n,o)-1)/(Math.pow(n,a)-1);return r+l*(s-r)}function E$(n,e,t,r,i,s){if(i-t===0)return r;const o=H4(r),l=H4(s);let u=l[2]-o[2];u>180?u-=360:u<-180&&(u+=360);const h=[Zg(n,e,t,o[0],i,l[0]),Zg(n,e,t,o[1],i,l[1]),o[2]+Zg(n,e,t,0,i,u),Zg(n,e,t,r[3],i,s[3])];return HU(h)}function w$(n){return!0}function S$(n){const e=B5(),t=T$(n,e),r=z5();return function(i,s){if(r.properties=i.getPropertiesInternal(),r.resolution=s,e.featureId){const a=i.getId();a!==void 0?r.featureId=a:r.featureId=null}return e.geometryType&&(r.geometryType=U5(i.getGeometry())),t(r)}}function pk(n){const e=B5(),t=n.length,r=new Array(t);for(let a=0;a<t;++a)r[a]=lT(n[a],e);const i=z5(),s=new Array(t);return function(a,o){if(i.properties=a.getPropertiesInternal(),i.resolution=o,e.featureId){const u=a.getId();u!==void 0?i.featureId=u:i.featureId=null}let l=0;for(let u=0;u<t;++u){const h=r[u](i);h&&(s[l]=h,l+=1)}return s.length=l,s}}function T$(n,e){const t=n.length,r=new Array(t);for(let i=0;i<t;++i){const s=n[i],a="filter"in s?$l(s.filter,Zi,e):w$;let o;if(Array.isArray(s.style)){const l=s.style.length;o=new Array(l);for(let u=0;u<l;++u)o[u]=lT(s.style[u],e)}else o=[lT(s.style,e)];r[i]={filter:a,styles:o}}return function(i){const s=[];let a=!1;for(let o=0;o<t;++o){const l=r[o].filter;if(l(i)&&!(n[o].else&&a)){a=!0;for(const u of r[o].styles){const h=u(i);h&&s.push(h)}}}return s}}function lT(n,e){const t=Zm(n,"",e),r=Qm(n,"",e),i=I$(n,e),s=A$(n,e),a=ps(n,"z-index",e);if(!t&&!r&&!i&&!s&&!Ph(n))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(n));const o=new ur;return function(l){let u=!0;if(t){const h=t(l);h&&(u=!1),o.setFill(h)}if(r){const h=r(l);h&&(u=!1),o.setStroke(h)}if(i){const h=i(l);h&&(u=!1),o.setText(h)}if(s){const h=s(l);h&&(u=!1),o.setImage(h)}return a&&o.setZIndex(a(l)),u?null:o}}function Zm(n,e,t){let r;if(e+"fill-pattern-src"in n)r=P$(n,e+"fill-",t);else{if(n[e+"fill-color"]==="none")return s=>null;r=gA(n,e+"fill-color",t)}if(!r)return null;const i=new oi;return function(s){const a=r(s);return a===iA?null:(i.setColor(a),i)}}function Qm(n,e,t){const r=ps(n,e+"stroke-width",t),i=gA(n,e+"stroke-color",t);if(!r&&!i)return null;const s=_l(n,e+"stroke-line-cap",t),a=_l(n,e+"stroke-line-join",t),o=$5(n,e+"stroke-line-dash",t),l=ps(n,e+"stroke-line-dash-offset",t),u=ps(n,e+"stroke-miter-limit",t),h=new _s;return function(f){if(i){const g=i(f);if(g===iA)return null;h.setColor(g)}if(r&&h.setWidth(r(f)),s){const g=s(f);if(g!=="butt"&&g!=="round"&&g!=="square")throw new Error("Expected butt, round, or square line cap");h.setLineCap(g)}if(a){const g=a(f);if(g!=="bevel"&&g!=="round"&&g!=="miter")throw new Error("Expected bevel, round, or miter line join");h.setLineJoin(g)}return o&&h.setLineDash(o(f)),l&&h.setLineDashOffset(l(f)),u&&h.setMiterLimit(u(f)),h}}function I$(n,e){const t="text-",r=_l(n,t+"value",e);if(!r)return null;const i=Zm(n,t,e),s=Zm(n,t+"background-",e),a=Qm(n,t,e),o=Qm(n,t+"background-",e),l=_l(n,t+"font",e),u=ps(n,t+"max-angle",e),h=ps(n,t+"offset-x",e),f=ps(n,t+"offset-y",e),g=jf(n,t+"overflow",e),p=_l(n,t+"placement",e),E=ps(n,t+"repeat",e),x=Bv(n,t+"scale",e),w=jf(n,t+"rotate-with-view",e),T=ps(n,t+"rotation",e),I=_l(n,t+"align",e),P=_l(n,t+"justify",e),N=_l(n,t+"baseline",e),D=jf(n,t+"keep-upright",e),B=$5(n,t+"padding",e),k=Uv(n,t+"declutter-mode"),C=new sd({declutterMode:k});return function(M){if(C.setText(r(M)),i&&C.setFill(i(M)),s&&C.setBackgroundFill(s(M)),a&&C.setStroke(a(M)),o&&C.setBackgroundStroke(o(M)),l&&C.setFont(l(M)),u&&C.setMaxAngle(u(M)),h&&C.setOffsetX(h(M)),f&&C.setOffsetY(f(M)),g&&C.setOverflow(g(M)),p){const j=p(M);if(j!=="point"&&j!=="line")throw new Error("Expected point or line for text-placement");C.setPlacement(j)}if(E&&C.setRepeat(E(M)),x&&C.setScale(x(M)),w&&C.setRotateWithView(w(M)),T&&C.setRotation(T(M)),I){const j=I(M);if(j!=="left"&&j!=="center"&&j!=="right"&&j!=="end"&&j!=="start")throw new Error("Expected left, right, center, start, or end for text-align");C.setTextAlign(j)}if(P){const j=P(M);if(j!=="left"&&j!=="right"&&j!=="center")throw new Error("Expected left, right, or center for text-justify");C.setJustify(j)}if(N){const j=N(M);if(j!=="bottom"&&j!=="top"&&j!=="middle"&&j!=="alphabetic"&&j!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");C.setTextBaseline(j)}return B&&C.setPadding(B(M)),D&&C.setKeepUpright(D(M)),C}}function A$(n,e){return"icon-src"in n?b$(n,e):"shape-points"in n?R$(n,e):"circle-radius"in n?C$(n,e):null}function b$(n,e){const t="icon-",r=t+"src",i=W5(n[r],r),s=ux(n,t+"anchor",e),a=Bv(n,t+"scale",e),o=ps(n,t+"opacity",e),l=ux(n,t+"displacement",e),u=ps(n,t+"rotation",e),h=jf(n,t+"rotate-with-view",e),f=_k(n,t+"anchor-origin"),g=xk(n,t+"anchor-x-units"),p=xk(n,t+"anchor-y-units"),E=L$(n,t+"color"),x=M$(n,t+"cross-origin"),w=N$(n,t+"offset"),T=_k(n,t+"offset-origin"),I=hx(n,t+"width"),P=hx(n,t+"height"),N=k$(n,t+"size"),D=Uv(n,t+"declutter-mode"),B=new Hp({src:i,anchorOrigin:f,anchorXUnits:g,anchorYUnits:p,color:E,crossOrigin:x,offset:w,offsetOrigin:T,height:P,width:I,size:N,declutterMode:D});return function(k){return o&&B.setOpacity(o(k)),l&&B.setDisplacement(l(k)),u&&B.setRotation(u(k)),h&&B.setRotateWithView(h(k)),a&&B.setScale(a(k)),s&&B.setAnchor(s(k)),B}}function R$(n,e){const t="shape-",r=t+"points",i=t+"radius",s=cT(n[r],r),a=cT(n[i],i),o=Zm(n,t,e),l=Qm(n,t,e),u=Bv(n,t+"scale",e),h=ux(n,t+"displacement",e),f=ps(n,t+"rotation",e),g=jf(n,t+"rotate-with-view",e),p=hx(n,t+"radius2"),E=hx(n,t+"angle"),x=Uv(n,t+"declutter-mode"),w=new Gv({points:s,radius:a,radius2:p,angle:E,declutterMode:x});return function(T){return o&&w.setFill(o(T)),l&&w.setStroke(l(T)),h&&w.setDisplacement(h(T)),f&&w.setRotation(f(T)),g&&w.setRotateWithView(g(T)),u&&w.setScale(u(T)),w}}function C$(n,e){const t="circle-",r=Zm(n,t,e),i=Qm(n,t,e),s=ps(n,t+"radius",e),a=Bv(n,t+"scale",e),o=ux(n,t+"displacement",e),l=ps(n,t+"rotation",e),u=jf(n,t+"rotate-with-view",e),h=Uv(n,t+"declutter-mode"),f=new Dl({radius:5,declutterMode:h});return function(g){return s&&f.setRadius(s(g)),r&&f.setFill(r(g)),i&&f.setStroke(i(g)),o&&f.setDisplacement(o(g)),l&&f.setRotation(l(g)),u&&f.setRotateWithView(u(g)),a&&f.setScale(a(g)),f}}function ps(n,e,t){if(!(e in n))return;const r=$l(n[e],cn,t);return function(i){return cT(r(i),e)}}function _l(n,e,t){if(!(e in n))return null;const r=$l(n[e],ms,t);return function(i){return W5(r(i),e)}}function P$(n,e,t){const r=_l(n,e+"pattern-src",t),i=yk(n,e+"pattern-offset",t),s=yk(n,e+"pattern-size",t),a=gA(n,e+"color",t);return function(o){return{src:r(o),offset:i&&i(o),size:s&&s(o),color:a&&a(o)}}}function jf(n,e,t){if(!(e in n))return null;const r=$l(n[e],Zi,t);return function(i){const s=r(i);if(typeof s!="boolean")throw new Error(`Expected a boolean for ${e}`);return s}}function gA(n,e,t){if(!(e in n))return null;const r=$l(n[e],Ua,t);return function(i){return H5(r(i),e)}}function $5(n,e,t){if(!(e in n))return null;const r=$l(n[e],Dh,t);return function(i){return Kp(r(i),e)}}function ux(n,e,t){if(!(e in n))return null;const r=$l(n[e],Dh,t);return function(i){const s=Kp(r(i),e);if(s.length!==2)throw new Error(`Expected two numbers for ${e}`);return s}}function yk(n,e,t){if(!(e in n))return null;const r=$l(n[e],Dh,t);return function(i){return K5(r(i),e)}}function Bv(n,e,t){if(!(e in n))return null;const r=$l(n[e],Dh|cn,t);return function(i){return O$(r(i),e)}}function hx(n,e){const t=n[e];if(t!==void 0){if(typeof t!="number")throw new Error(`Expected a number for ${e}`);return t}}function k$(n,e){const t=n[e];if(t!==void 0){if(typeof t=="number")return xs(t);if(!Array.isArray(t))throw new Error(`Expected a number or size array for ${e}`);if(t.length!==2||typeof t[0]!="number"||typeof t[1]!="number")throw new Error(`Expected a number or size array for ${e}`);return t}}function M$(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);return t}}function _k(n,e){const t=n[e];if(t!==void 0){if(t!=="bottom-left"&&t!=="bottom-right"&&t!=="top-left"&&t!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return t}}function xk(n,e){const t=n[e];if(t!==void 0){if(t!=="pixels"&&t!=="fraction")throw new Error(`Expected pixels or fraction for ${e}`);return t}}function N$(n,e){const t=n[e];if(t!==void 0)return Kp(t,e)}function Uv(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);if(t!=="declutter"&&t!=="obstacle"&&t!=="none")throw new Error(`Expected declutter, obstacle, or none for ${e}`);return t}}function L$(n,e){const t=n[e];if(t!==void 0)return H5(t,e)}function Kp(n,e){if(!Array.isArray(n))throw new Error(`Expected an array for ${e}`);const t=n.length;for(let r=0;r<t;++r)if(typeof n[r]!="number")throw new Error(`Expected an array of numbers for ${e}`);return n}function W5(n,e){if(typeof n!="string")throw new Error(`Expected a string for ${e}`);return n}function cT(n,e){if(typeof n!="number")throw new Error(`Expected a number for ${e}`);return n}function H5(n,e){if(typeof n=="string")return n;const t=Kp(n,e),r=t.length;if(r<3||r>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return t}function K5(n,e){const t=Kp(n,e);if(t.length!==2)throw new Error(`Expected an array of two numbers for ${e}`);return t}function O$(n,e){return typeof n=="number"?n:K5(n,e)}const Da={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function vk(n,e,t){return(function(r,i,s,a,o){if(!r)return;if(!i&&!e)return r;const l=e?0:s[0]*i,u=e?0:s[1]*i,h=o?o[0]:0,f=o?o[1]:0;let g=n[0]+l/2+h,p=n[2]-l/2+h,E=n[1]+u/2+f,x=n[3]-u/2+f;g>p&&(g=(p+g)/2,p=g),E>x&&(E=(x+E)/2,x=E);let w=Yn(r[0],g,p),T=Yn(r[1],E,x);if(a&&t&&i){const I=30*i;w+=-I*Math.log(1+Math.max(0,g-r[0])/I)+I*Math.log(1+Math.max(0,r[0]-p)/I),T+=-I*Math.log(1+Math.max(0,E-r[1])/I)+I*Math.log(1+Math.max(0,r[1]-x)/I)}return[w,T]})}function D$(n){return n}function Y5(n){return Math.pow(n,3)}function k0(n){return 1-Y5(1-n)}function F$(n){return 3*n*n-2*n*n*n}function j$(n){return n}function mA(n,e,t,r){const i=tn(e)/t[0],s=Mr(e)/t[1];return r?Math.min(n,Math.max(i,s)):Math.min(n,Math.min(i,s))}function pA(n,e,t){let r=Math.min(n,e);const i=50;return r*=Math.log(1+i*Math.max(0,n/e-1))/i+1,t&&(r=Math.max(r,t),r/=Math.log(1+i*Math.max(0,t/n-1))/i+1),Yn(r,t/2,e*2)}function V$(n,e,t,r){return e=e!==void 0?e:!0,(function(i,s,a,o){if(i!==void 0){const l=n[0],u=n[n.length-1],h=t?mA(l,t,a,r):l;if(o)return e?pA(i,h,u):Yn(i,u,h);const f=Math.min(h,i),g=Math.floor(bv(n,f,s));return n[g]>h&&g<n.length-1?n[g+1]:n[g]}})}function G$(n,e,t,r,i,s){return r=r!==void 0?r:!0,t=t!==void 0?t:0,(function(a,o,l,u){if(a!==void 0){const h=i?mA(e,i,l,s):e;if(u)return r?pA(a,h,t):Yn(a,t,h);const f=1e-9,g=Math.ceil(Math.log(e/h)/Math.log(n)-f),p=-o*(.5-f)+.5,E=Math.min(h,a),x=Math.floor(Math.log(e/E)/Math.log(n)+p),w=Math.max(g,x),T=e/Math.pow(n,w);return Yn(T,t,h)}})}function Ek(n,e,t,r,i){return t=t!==void 0?t:!0,(function(s,a,o,l){if(s!==void 0){const u=r?mA(n,r,o,i):n;return!t||!l?Yn(s,e,u):pA(s,u,e)}})}function yA(n){if(n!==void 0)return 0}function wk(n){if(n!==void 0)return n}function B$(n){const e=2*Math.PI/n;return(function(t,r){if(r)return t;if(t!==void 0)return t=Math.floor(t/e+.5)*e,t})}function U$(n){const e=bl(5);return(function(t,r){return r||t===void 0?t:Math.abs(t)<=e?0:t})}const z$=42,_A=256,D2=0;class Ro extends Zo{constructor(e){super(),this.on,this.once,this.un,e=Object.assign({},e),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=YI(e.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,e.projection&&n5(),e.center&&(e.center=yl(e.center,this.projection_)),e.extent&&(e.extent=Co(e.extent,this.projection_)),this.applyOptions_(e)}applyOptions_(e){const t=Object.assign({},e);for(const o in Da)delete t[o];this.setProperties(t,!0);const r=W$(e);this.maxResolution_=r.maxResolution,this.minResolution_=r.minResolution,this.zoomFactor_=r.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=r.minZoom;const i=$$(e),s=r.constraint,a=H$(e);this.constraints_={center:i,resolution:s,rotation:a},this.setRotation(e.rotation!==void 0?e.rotation:0),this.setCenterInternal(e.center!==void 0?e.center:null),e.resolution!==void 0?this.setResolution(e.resolution):e.zoom!==void 0&&this.setZoom(e.zoom)}get padding(){return this.padding_}set padding(e){let t=this.padding_;this.padding_=e;const r=this.getCenterInternal();if(r){const i=e||[0,0,0,0];t=t||[0,0,0,0];const s=this.getResolution(),a=s/2*(i[3]-t[3]+t[1]-i[1]),o=s/2*(i[0]-t[0]+t[2]-i[2]);this.setCenterInternal([r[0]+a,r[1]-o])}}getUpdatedOptions_(e){const t=this.getProperties();return t.resolution!==void 0?t.resolution=this.getResolution():t.zoom=this.getZoom(),t.center=this.getCenterInternal(),t.rotation=this.getRotation(),Object.assign({},t,e)}animate(e){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const t=new Array(arguments.length);for(let r=0;r<t.length;++r){let i=arguments[r];i.center&&(i=Object.assign({},i),i.center=yl(i.center,this.getProjection())),i.anchor&&(i=Object.assign({},i),i.anchor=yl(i.anchor,this.getProjection())),t[r]=i}this.animateInternal.apply(this,t)}animateInternal(e){let t=arguments.length,r;t>1&&typeof arguments[t-1]=="function"&&(r=arguments[t-1],--t);let i=0;for(;i<t&&!this.isDef();++i){const h=arguments[i];h.center&&this.setCenterInternal(h.center),h.zoom!==void 0?this.setZoom(h.zoom):h.resolution&&this.setResolution(h.resolution),h.rotation!==void 0&&this.setRotation(h.rotation)}if(i===t){r&&Wy(r,!0);return}let s=Date.now(),a=this.targetCenter_.slice(),o=this.targetResolution_,l=this.targetRotation_;const u=[];for(;i<t;++i){const h=arguments[i],f={start:s,complete:!1,anchor:h.anchor,duration:h.duration!==void 0?h.duration:1e3,easing:h.easing||F$,callback:r};if(h.center&&(f.sourceCenter=a,f.targetCenter=h.center.slice(),a=f.targetCenter),h.zoom!==void 0?(f.sourceResolution=o,f.targetResolution=this.getResolutionForZoom(h.zoom),o=f.targetResolution):h.resolution&&(f.sourceResolution=o,f.targetResolution=h.resolution,o=f.targetResolution),h.rotation!==void 0){f.sourceRotation=l;const g=Yc(h.rotation-l+Math.PI,2*Math.PI)-Math.PI;f.targetRotation=l+g,l=f.targetRotation}K$(f)?f.complete=!0:s+=f.duration,u.push(f)}this.animations_.push(u),this.setHint(ni.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[ni.ANIMATING]>0}getInteracting(){return this.hints_[ni.INTERACTING]>0}cancelAnimations(){this.setHint(ni.ANIMATING,-this.hints_[ni.ANIMATING]);let e;for(let t=0,r=this.animations_.length;t<r;++t){const i=this.animations_[t];if(i[0].callback&&Wy(i[0].callback,!1),!e)for(let s=0,a=i.length;s<a;++s){const o=i[s];if(!o.complete){e=o.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=e,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const e=Date.now();let t=!1;for(let r=this.animations_.length-1;r>=0;--r){const i=this.animations_[r];let s=!0;for(let a=0,o=i.length;a<o;++a){const l=i[a];if(l.complete)continue;const u=e-l.start;let h=l.duration>0?u/l.duration:1;h>=1?(l.complete=!0,h=1):s=!1;const f=l.easing(h);if(l.sourceCenter){const g=l.sourceCenter[0],p=l.sourceCenter[1],E=l.targetCenter[0],x=l.targetCenter[1];this.nextCenter_=l.targetCenter;const w=g+f*(E-g),T=p+f*(x-p);this.targetCenter_=[w,T]}if(l.sourceResolution&&l.targetResolution){const g=f===1?l.targetResolution:l.sourceResolution+f*(l.targetResolution-l.sourceResolution);if(l.anchor){const p=this.getViewportSize_(this.getRotation()),E=this.constraints_.resolution(g,0,p,!0);this.targetCenter_=this.calculateCenterZoom(E,l.anchor)}this.nextResolution_=l.targetResolution,this.targetResolution_=g,this.applyTargetState_(!0)}if(l.sourceRotation!==void 0&&l.targetRotation!==void 0){const g=f===1?Yc(l.targetRotation+Math.PI,2*Math.PI)-Math.PI:l.sourceRotation+f*(l.targetRotation-l.sourceRotation);if(l.anchor){const p=this.constraints_.rotation(g,!0);this.targetCenter_=this.calculateCenterRotate(p,l.anchor)}this.nextRotation_=l.targetRotation,this.targetRotation_=g}if(this.applyTargetState_(!0),t=!0,!l.complete)break}if(s){this.animations_[r]=null,this.setHint(ni.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const a=i[0].callback;a&&Wy(a,!0)}}this.animations_=this.animations_.filter(Boolean),t&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(e,t){let r;const i=this.getCenterInternal();return i!==void 0&&(r=[i[0]-t[0],i[1]-t[1]],$I(r,e-this.getRotation()),jB(r,t)),r}calculateCenterZoom(e,t){let r;const i=this.getCenterInternal(),s=this.getResolution();if(i!==void 0&&s!==void 0){const a=t[0]-e*(t[0]-i[0])/s,o=t[1]-e*(t[1]-i[1])/s;r=[a,o]}return r}getViewportSize_(e){const t=this.viewportSize_;if(e){const r=t[0],i=t[1];return[Math.abs(r*Math.cos(e))+Math.abs(i*Math.sin(e)),Math.abs(r*Math.sin(e))+Math.abs(i*Math.cos(e))]}return t}setViewportSize(e){this.viewportSize_=Array.isArray(e)?e.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const e=this.getCenterInternal();return e&&eT(e,this.getProjection())}getCenterInternal(){return this.get(Da.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(e){return e!==void 0?(e[0]=this.hints_[0],e[1]=this.hints_[1],e):this.hints_.slice()}calculateExtent(e){const t=this.calculateExtentInternal(e);return r5(t,this.getProjection())}calculateExtentInternal(e){e=e||this.getViewportSizeMinusPadding_();const t=this.getCenterInternal();Cn(t,"The view center is not defined");const r=this.getResolution();Cn(r!==void 0,"The view resolution is not defined");const i=this.getRotation();return Cn(i!==void 0,"The view rotation is not defined"),Z_(t,r,i,e)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))}setConstrainResolution(e){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:e}))}getProjection(){return this.projection_}getResolution(){return this.get(Da.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(e,t){return this.getResolutionForExtentInternal(Co(e,this.getProjection()),t)}getResolutionForExtentInternal(e,t){t=t||this.getViewportSizeMinusPadding_();const r=tn(e)/t[0],i=Mr(e)/t[1];return Math.max(r,i)}getResolutionForValueFunction(e){e=e||2;const t=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,i=Math.log(t/r)/Math.log(e);return(function(s){return t/Math.pow(e,s*i)})}getRotation(){return this.get(Da.ROTATION)}getValueForResolutionFunction(e){const t=Math.log(e||2),r=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,s=Math.log(r/i)/t;return(function(a){return Math.log(r/a)/t/s})}getViewportSizeMinusPadding_(e){let t=this.getViewportSize_(e);const r=this.padding_;return r&&(t=[t[0]-r[1]-r[3],t[1]-r[0]-r[2]]),t}getState(){const e=this.getProjection(),t=this.getResolution(),r=this.getRotation();let i=this.getCenterInternal();const s=this.padding_;if(s){const a=this.getViewportSizeMinusPadding_();i=F2(i,this.getViewportSize_(),[a[0]/2+s[3],a[1]/2+s[0]],t,r)}return{center:i.slice(0),projection:e!==void 0?e:null,resolution:t,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:r,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let e;const t=this.getResolution();return t!==void 0&&(e=this.getZoomForResolution(t)),e}getZoomForResolution(e){let t=this.minZoom_||0,r,i;if(this.resolutions_){const s=bv(this.resolutions_,e,1);t=s,r=this.resolutions_[s],s==this.resolutions_.length-1?i=2:i=r/this.resolutions_[s+1]}else r=this.maxResolution_,i=this.zoomFactor_;return t+Math.log(r/e)/Math.log(i)}getResolutionForZoom(e){if(this.resolutions_?.length){if(this.resolutions_.length===1)return this.resolutions_[0];const t=Yn(Math.floor(e),0,this.resolutions_.length-2),r=this.resolutions_[t]/this.resolutions_[t+1];return this.resolutions_[t]/Math.pow(r,Yn(e-t,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,e-this.minZoom_)}fit(e,t){let r;if(Cn(Array.isArray(e)||typeof e.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(e)){Cn(!C0(e),"Cannot fit empty extent provided as `geometry`");const i=Co(e,this.getProjection());r=ek(i)}else if(e.getType()==="Circle"){const i=Co(e.getExtent(),this.getProjection());r=ek(i),r.rotate(this.getRotation(),Bo(i))}else r=e;this.fitInternal(r,t)}rotatedExtentForGeometry(e){const t=this.getRotation(),r=Math.cos(t),i=Math.sin(-t),s=e.getFlatCoordinates(),a=e.getStride();let o=1/0,l=1/0,u=-1/0,h=-1/0;for(let f=0,g=s.length;f<g;f+=a){const p=s[f]*r-s[f+1]*i,E=s[f]*i+s[f+1]*r;o=Math.min(o,p),l=Math.min(l,E),u=Math.max(u,p),h=Math.max(h,E)}return[o,l,u,h]}fitInternal(e,t){t=t||{};let r=t.size;r||(r=this.getViewportSizeMinusPadding_());const i=t.padding!==void 0?t.padding:[0,0,0,0],s=t.nearest!==void 0?t.nearest:!1;let a;t.minResolution!==void 0?a=t.minResolution:t.maxZoom!==void 0?a=this.getResolutionForZoom(t.maxZoom):a=0;const o=this.rotatedExtentForGeometry(e);let l=this.getResolutionForExtentInternal(o,[r[0]-i[1]-i[3],r[1]-i[0]-i[2]]);l=isNaN(l)?a:Math.max(l,a),l=this.getConstrainedResolution(l,s?0:1);const u=this.getRotation(),h=Math.sin(u),f=Math.cos(u),g=Bo(o);g[0]+=(i[1]-i[3])/2*l,g[1]+=(i[0]-i[2])/2*l;const p=g[0]*f-g[1]*h,E=g[1]*f+g[0]*h,x=this.getConstrainedCenter([p,E],l),w=t.callback?t.callback:Um;t.duration!==void 0?this.animateInternal({resolution:l,center:x,duration:t.duration,easing:t.easing},w):(this.targetResolution_=l,this.targetCenter_=x,this.applyTargetState_(!1,!0),Wy(w,!0))}centerOn(e,t,r){this.centerOnInternal(yl(e,this.getProjection()),t,r)}centerOnInternal(e,t,r){this.setCenterInternal(F2(e,t,r,this.getResolution(),this.getRotation()))}calculateCenterShift(e,t,r,i){let s;const a=this.padding_;if(a&&e){const o=this.getViewportSizeMinusPadding_(-r),l=F2(e,i,[o[0]/2+a[3],o[1]/2+a[0]],t,r);s=[e[0]-l[0],e[1]-l[1]]}return s}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(e){const t=eT(this.targetCenter_,this.getProjection());this.setCenter([t[0]+e[0],t[1]+e[1]])}adjustCenterInternal(e){const t=this.targetCenter_;this.setCenterInternal([t[0]+e[0],t[1]+e[1]])}adjustResolution(e,t){t=t&&yl(t,this.getProjection()),this.adjustResolutionInternal(e,t)}adjustResolutionInternal(e,t){const r=this.getAnimating()||this.getInteracting(),i=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*e,0,i,r);t&&(this.targetCenter_=this.calculateCenterZoom(s,t)),this.targetResolution_*=e,this.applyTargetState_()}adjustZoom(e,t){this.adjustResolution(Math.pow(this.zoomFactor_,-e),t)}adjustRotation(e,t){t&&(t=yl(t,this.getProjection())),this.adjustRotationInternal(e,t)}adjustRotationInternal(e,t){const r=this.getAnimating()||this.getInteracting(),i=this.constraints_.rotation(this.targetRotation_+e,r);t&&(this.targetCenter_=this.calculateCenterRotate(i,t)),this.targetRotation_+=e,this.applyTargetState_()}setCenter(e){this.setCenterInternal(e&&yl(e,this.getProjection()))}setCenterInternal(e){this.targetCenter_=e,this.applyTargetState_()}setHint(e,t){return this.hints_[e]+=t,this.changed(),this.hints_[e]}setResolution(e){this.targetResolution_=e,this.applyTargetState_()}setRotation(e){this.targetRotation_=e,this.applyTargetState_()}setZoom(e){this.setResolution(this.getResolutionForZoom(e))}applyTargetState_(e,t){const r=this.getAnimating()||this.getInteracting()||t,i=this.constraints_.rotation(this.targetRotation_,r),s=this.getViewportSize_(i),a=this.constraints_.resolution(this.targetResolution_,0,s,r),o=this.constraints_.center(this.targetCenter_,a,s,r,this.calculateCenterShift(this.targetCenter_,a,i,s));this.get(Da.ROTATION)!==i&&this.set(Da.ROTATION,i),this.get(Da.RESOLUTION)!==a&&(this.set(Da.RESOLUTION,a),this.set("zoom",this.getZoom(),!0)),(!o||!this.get(Da.CENTER)||!J_(this.get(Da.CENTER),o))&&this.set(Da.CENTER,o),this.getAnimating()&&!e&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(e,t,r){e=e!==void 0?e:200;const i=t||0,s=this.constraints_.rotation(this.targetRotation_),a=this.getViewportSize_(s),o=this.constraints_.resolution(this.targetResolution_,i,a),l=this.constraints_.center(this.targetCenter_,o,a,!1,this.calculateCenterShift(this.targetCenter_,o,s,a));if(e===0&&!this.cancelAnchor_){this.targetResolution_=o,this.targetRotation_=s,this.targetCenter_=l,this.applyTargetState_();return}r=r||(e===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==o||this.getRotation()!==s||!this.getCenterInternal()||!J_(this.getCenterInternal(),l))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:l,resolution:o,duration:e,easing:k0,anchor:r}))}beginInteraction(){this.resolveConstraints(0),this.setHint(ni.INTERACTING,1)}endInteraction(e,t,r){r=r&&yl(r,this.getProjection()),this.endInteractionInternal(e,t,r)}endInteractionInternal(e,t,r){this.getInteracting()&&(this.setHint(ni.INTERACTING,-1),this.resolveConstraints(e,t,r))}getConstrainedCenter(e,t){const r=this.getViewportSize_(this.getRotation());return this.constraints_.center(e,t||this.getResolution(),r)}getConstrainedZoom(e,t){const r=this.getResolutionForZoom(e);return this.getZoomForResolution(this.getConstrainedResolution(r,t))}getConstrainedResolution(e,t){t=t||0;const r=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(e,t,r)}}function Wy(n,e){setTimeout(function(){n(e)},0)}function $$(n){if(n.extent!==void 0){const t=n.smoothExtentConstraint!==void 0?n.smoothExtentConstraint:!0;return vk(n.extent,n.constrainOnlyCenter,t)}const e=YI(n.projection,"EPSG:3857");if(n.multiWorld!==!0&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,vk(t,!1,!1)}return D$}function W$(n){let e,t,r,a=n.minZoom!==void 0?n.minZoom:D2,o=n.maxZoom!==void 0?n.maxZoom:28;const l=n.zoomFactor!==void 0?n.zoomFactor:2,u=n.multiWorld!==void 0?n.multiWorld:!1,h=n.smoothResolutionConstraint!==void 0?n.smoothResolutionConstraint:!0,f=n.showFullExtent!==void 0?n.showFullExtent:!1,g=YI(n.projection,"EPSG:3857"),p=g.getExtent();let E=n.constrainOnlyCenter,x=n.extent;if(!u&&!x&&g.isGlobal()&&(E=!1,x=p),n.resolutions!==void 0){const w=n.resolutions;t=w[a],r=w[o]!==void 0?w[o]:w[w.length-1],n.constrainResolution?e=V$(w,h,!E&&x,f):e=Ek(t,r,h,!E&&x,f)}else{const T=(p?Math.max(tn(p),Mr(p)):360*r0.degrees/g.getMetersPerUnit())/_A/Math.pow(2,D2),I=T/Math.pow(2,28-D2);t=n.maxResolution,t!==void 0?a=0:t=T/Math.pow(l,a),r=n.minResolution,r===void 0&&(n.maxZoom!==void 0?n.maxResolution!==void 0?r=t/Math.pow(l,o):r=T/Math.pow(l,o):r=I),o=a+Math.floor(Math.log(t/r)/Math.log(l)),r=t/Math.pow(l,o-a),n.constrainResolution?e=G$(l,t,r,h,!E&&x,f):e=Ek(t,r,h,!E&&x,f)}return{constraint:e,maxResolution:t,minResolution:r,minZoom:a,zoomFactor:l}}function H$(n){if(n.enableRotation!==void 0?n.enableRotation:!0){const t=n.constrainRotation;return t===void 0||t===!0?U$():t===!1?wk:typeof t=="number"?B$(t):wk}return yA}function K$(n){return!(n.sourceCenter&&n.targetCenter&&!J_(n.sourceCenter,n.targetCenter)||n.sourceResolution!==n.targetResolution||n.sourceRotation!==n.targetRotation)}function F2(n,e,t,r,i){const s=Math.cos(-i);let a=Math.sin(-i),o=n[0]*s-n[1]*a,l=n[1]*s+n[0]*a;o+=(e[0]/2-t[0])*r,l+=(t[1]-e[1]/2)*r,a=-a;const u=o*s-l*a,h=l*s+o*a;return[u,h]}const Mn={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class X5 extends Zo{constructor(e){super(),this.on,this.once,this.un,this.background_=e.background;const t=Object.assign({},e);typeof e.properties=="object"&&(delete t.properties,Object.assign(t,e.properties)),t[Mn.OPACITY]=e.opacity!==void 0?e.opacity:1,Cn(typeof t[Mn.OPACITY]=="number","Layer opacity must be a number"),t[Mn.VISIBLE]=e.visible!==void 0?e.visible:!0,t[Mn.Z_INDEX]=e.zIndex,t[Mn.MAX_RESOLUTION]=e.maxResolution!==void 0?e.maxResolution:1/0,t[Mn.MIN_RESOLUTION]=e.minResolution!==void 0?e.minResolution:0,t[Mn.MIN_ZOOM]=e.minZoom!==void 0?e.minZoom:-1/0,t[Mn.MAX_ZOOM]=e.maxZoom!==void 0?e.maxZoom:1/0,this.className_=t.className!==void 0?t.className:"ol-layer",delete t.className,this.setProperties(t),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(e){const t=this.state_||{layer:this,managed:e===void 0?!0:e},r=this.getZIndex();return t.opacity=Yn(Math.round(this.getOpacity()*100)/100,0,1),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=r===void 0&&!t.managed?1/0:r,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),t.minZoom=this.getMinZoom(),t.maxZoom=this.getMaxZoom(),this.state_=t,t}getLayersArray(e){return Ft()}getLayerStatesArray(e){return Ft()}getExtent(){return this.get(Mn.EXTENT)}getMaxResolution(){return this.get(Mn.MAX_RESOLUTION)}getMinResolution(){return this.get(Mn.MIN_RESOLUTION)}getMinZoom(){return this.get(Mn.MIN_ZOOM)}getMaxZoom(){return this.get(Mn.MAX_ZOOM)}getOpacity(){return this.get(Mn.OPACITY)}getSourceState(){return Ft()}getVisible(){return this.get(Mn.VISIBLE)}getZIndex(){return this.get(Mn.Z_INDEX)}setBackground(e){this.background_=e,this.changed()}setExtent(e){this.set(Mn.EXTENT,e)}setMaxResolution(e){this.set(Mn.MAX_RESOLUTION,e)}setMinResolution(e){this.set(Mn.MIN_RESOLUTION,e)}setMaxZoom(e){this.set(Mn.MAX_ZOOM,e)}setMinZoom(e){this.set(Mn.MIN_ZOOM,e)}setOpacity(e){Cn(typeof e=="number","Layer opacity must be a number"),this.set(Mn.OPACITY,e)}setVisible(e){this.set(Mn.VISIBLE,e)}setZIndex(e){this.set(Mn.Z_INDEX,e)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}class Yp extends X5{constructor(e){const t=Object.assign({},e);delete t.source,super(t),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,e.render&&(this.render=e.render),e.map&&this.setMap(e.map),this.addChangeListener(Mn.SOURCE,this.handleSourcePropertyChange_);const r=e.source?e.source:null;this.setSource(r)}getLayersArray(e){return e=e||[],e.push(this),e}getLayerStatesArray(e){return e=e||[],e.push(this.getLayerState()),e}getSource(){return this.get(Mn.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const e=this.getSource();return e?e.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(Wn(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const e=this.getSource();e&&(this.sourceChangeKey_=hn(e,zt.CHANGE,this.handleSourceChange_,this),e.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(e){return this.renderer_?this.renderer_.getFeatures(e):Promise.resolve([])}getData(e){return!this.renderer_||!this.rendered?null:this.renderer_.getData(e)}isVisible(e){let t;const r=this.getMapInternal();!e&&r&&(e=r.getView()),e instanceof Ro?t={viewState:e.getState(),extent:e.calculateExtent()}:t=e,!t.layerStatesArray&&r&&(t.layerStatesArray=r.getLayerGroup().getLayerStatesArray());let i;if(t.layerStatesArray){if(i=t.layerStatesArray.find(a=>a.layer===this),!i)return!1}else i=this.getLayerState();const s=this.getExtent();return xA(i,t.viewState)&&(!s||Qi(s,t.extent))}getAttributions(e){if(!this.isVisible(e))return[];const t=this.getSource()?.getAttributions();if(!t)return[];const r=e instanceof Ro?e.getViewStateAndExtent():e;let i=t(r);return Array.isArray(i)||(i=[i]),i}render(e,t){const r=this.getRenderer();return r.prepareFrame(e)?(this.rendered=!0,r.renderFrame(e,t)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(e,t){}renderDeferred(e){const t=this.getRenderer();t&&t.renderDeferred(e)}setMapInternal(e){e||this.unrender(),this.set(Mn.MAP,e)}getMapInternal(){return this.get(Mn.MAP)}setMap(e){this.mapPrecomposeKey_&&(Wn(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(Wn(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=hn(e,_a.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=hn(this,zt.CHANGE,e.render,e),this.changed())}handlePrecompose_(e){const t=e.frameState.layerStatesArray,r=this.getLayerState(!1);Cn(!t.some(i=>i.layer===r.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),t.push(r)}setSource(e){this.set(Mn.SOURCE,e)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}}function xA(n,e){if(!n.visible)return!1;const t=e.resolution;if(t<n.minResolution||t>=n.maxResolution)return!1;const r=e.zoom;return r>n.minZoom&&r<=n.maxZoom}const Sk={RENDER_ORDER:"renderOrder"};class q5 extends Yp{constructor(e){e=e||{};const t=Object.assign({},e);delete t.style,delete t.renderBuffer,delete t.updateWhileAnimating,delete t.updateWhileInteracting,super(t),this.declutter_=e.declutter?String(e.declutter):void 0,this.renderBuffer_=e.renderBuffer!==void 0?e.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(e.style),this.updateWhileAnimating_=e.updateWhileAnimating!==void 0?e.updateWhileAnimating:!1,this.updateWhileInteracting_=e.updateWhileInteracting!==void 0?e.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(e){return super.getFeatures(e)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(Sk.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(e,t){const r=this.getDeclutter();r in e.declutter||(e.declutter[r]=new O5(9)),this.getRenderer().renderDeclutter(e,t)}setRenderOrder(e){this.set(Sk.RENDER_ORDER,e)}setStyle(e){this.style_=e===void 0?D5:e;const t=Y$(e);this.styleFunction_=e===null?void 0:Pz(t),this.changed()}setDeclutter(e){this.declutter_=e?String(e):void 0,this.changed()}}function Y$(n){if(n===void 0)return D5;if(!n)return null;if(typeof n=="function"||n instanceof ur)return n;if(!Array.isArray(n))return pk([n]);if(n.length===0)return[];const e=n.length,t=n[0];if(t instanceof ur){const i=new Array(e);for(let s=0;s<e;++s){const a=n[s];if(!(a instanceof ur))throw new Error("Expected a list of style instances");i[s]=a}return i}if("style"in t){const i=new Array(e);for(let s=0;s<e;++s){const a=n[s];if(!("style"in a))throw new Error("Expected a list of rules with a style property");i[s]=a}return S$(i)}return pk(n)}class Xp extends q5{constructor(e){super(e)}createRenderer(){return new Zz(this)}}const Ec={ADDLAYER:"addlayer",REMOVELAYER:"removelayer"};class kc extends qo{constructor(e,t){super(e),this.layer=t}}const j2={LAYERS:"layers"};let zv=class Z5 extends X5{constructor(e){e=e||{};const t=Object.assign({},e);delete t.layers;let r=e.layers;super(t),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(j2.LAYERS,this.handleLayersChanged_),r?Array.isArray(r)?r=new ya(r.slice(),{unique:!0}):Cn(typeof r.getArray=="function","Expected `layers` to be an array or a `Collection`"):r=new ya(void 0,{unique:!0}),this.setLayers(r)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(Wn),this.layersListenerKeys_.length=0;const e=this.getLayers();this.layersListenerKeys_.push(hn(e,fs.ADD,this.handleLayersAdd_,this),hn(e,fs.REMOVE,this.handleLayersRemove_,this));for(const r in this.listenerKeys_)this.listenerKeys_[r].forEach(Wn);Op(this.listenerKeys_);const t=e.getArray();for(let r=0,i=t.length;r<i;r++){const s=t[r];this.registerLayerListeners_(s),this.dispatchEvent(new kc(Ec.ADDLAYER,s))}this.changed()}registerLayerListeners_(e){const t=[hn(e,t0.PROPERTYCHANGE,this.handleLayerChange_,this),hn(e,zt.CHANGE,this.handleLayerChange_,this)];e instanceof Z5&&t.push(hn(e,Ec.ADDLAYER,this.handleLayerGroupAdd_,this),hn(e,Ec.REMOVELAYER,this.handleLayerGroupRemove_,this)),this.listenerKeys_[_n(e)]=t}handleLayerGroupAdd_(e){this.dispatchEvent(new kc(Ec.ADDLAYER,e.layer))}handleLayerGroupRemove_(e){this.dispatchEvent(new kc(Ec.REMOVELAYER,e.layer))}handleLayersAdd_(e){const t=e.element;this.registerLayerListeners_(t),this.dispatchEvent(new kc(Ec.ADDLAYER,t)),this.changed()}handleLayersRemove_(e){const t=e.element,r=_n(t);this.listenerKeys_[r].forEach(Wn),delete this.listenerKeys_[r],this.dispatchEvent(new kc(Ec.REMOVELAYER,t)),this.changed()}getLayers(){return this.get(j2.LAYERS)}setLayers(e){const t=this.getLayers();if(t){const r=t.getArray();for(let i=0,s=r.length;i<s;++i)this.dispatchEvent(new kc(Ec.REMOVELAYER,r[i]))}this.set(j2.LAYERS,e)}getLayersArray(e){return e=e!==void 0?e:[],this.getLayers().forEach(function(t){t.getLayersArray(e)}),e}getLayerStatesArray(e){const t=e!==void 0?e:[],r=t.length;this.getLayers().forEach(function(a){a.getLayerStatesArray(t)});const i=this.getLayerState();let s=i.zIndex;!e&&i.zIndex===void 0&&(s=0);for(let a=r,o=t.length;a<o;a++){const l=t[a];l.opacity*=i.opacity,l.visible=l.visible&&i.visible,l.maxResolution=Math.min(l.maxResolution,i.maxResolution),l.minResolution=Math.max(l.minResolution,i.minResolution),l.minZoom=Math.max(l.minZoom,i.minZoom),l.maxZoom=Math.min(l.maxZoom,i.maxZoom),i.extent!==void 0&&(l.extent!==void 0?l.extent=Al(l.extent,i.extent):l.extent=i.extent),l.zIndex===void 0&&(l.zIndex=s)}return t}getSourceState(){return"ready"}};const kt={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};class vA extends Dp{constructor(e,t,r){super(),r=r||{},this.tileCoord=e,this.state=t,this.key="",this.transition_=r.transition===void 0?250:r.transition,this.transitionStarts_={},this.interpolate=!!r.interpolate}changed(){this.dispatchEvent(zt.CHANGE)}release(){this.setState(kt.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(e){if(this.state!==kt.EMPTY){if(this.state!==kt.ERROR&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()}}load(){Ft()}getAlpha(e,t){if(!this.transition_)return 1;let r=this.transitionStarts_[e];if(!r)r=t,this.transitionStarts_[e]=r;else if(r===-1)return 1;const i=t-r+1e3/60;return i>=this.transition_?1:Y5(i/this.transition_)}inTransition(e){return this.transition_?this.transitionStarts_[e]!==-1:!1}endTransition(e){this.transition_&&(this.transitionStarts_[e]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}function uT(n){return n instanceof Image||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageBitmap?n:null}const X$=new Error("disposed"),q$=[256,256];class Tk extends vA{constructor(e){const t=kt.IDLE;super(e.tileCoord,t,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null,this.controller_=e.controller||null}getSize(){if(this.size_)return this.size_;const e=uT(this.data_);return e?[e.width,e.height]:q$}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==kt.IDLE&&this.state!==kt.ERROR)return;this.state=kt.LOADING,this.changed();const e=this;this.loader_().then(function(t){e.data_=t,e.state=kt.LOADED,e.changed()}).catch(function(t){e.error_=t,e.state=kt.ERROR,e.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(X$),this.controller_=null),super.disposeInternal()}}class Q5 extends vA{constructor(e,t,r,i,s,a){super(e,t,a),this.crossOrigin_=i,this.src_=r,this.key=r,this.image_,Ks?this.image_=new OffscreenCanvas(1,1):(this.image_=new Image,i!==null&&(this.image_.crossOrigin=i)),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(e){this.image_=e,this.state=kt.LOADED,this.unlistenImage_(),this.changed()}getCrossOrigin(){return this.crossOrigin_}handleImageError_(){this.state=kt.ERROR,this.unlistenImage_(),this.image_=Z$(),this.changed()}handleImageLoad_(){if(Ks)this.state=kt.LOADED;else{const e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=kt.LOADED:this.state=kt.EMPTY}this.unlistenImage_(),this.changed()}load(){this.state==kt.ERROR&&(this.state=kt.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==kt.IDLE&&(this.state=kt.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=KU(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function Z$(){const n=Hr(1,1);return n.fillStyle="rgba(0,0,0,0)",n.fillRect(0,0,1,1),n.canvas}let V2;const Vf=[];function Ik(n,e,t,r,i){n.beginPath(),n.moveTo(0,0),n.lineTo(e,t),n.lineTo(r,i),n.closePath(),n.save(),n.clip(),n.fillRect(0,0,Math.max(e,r)+1,Math.max(t,i)),n.restore()}function G2(n,e){return Math.abs(n[e*4]-210)>2||Math.abs(n[e*4+3]-.75*255)>2}function Q$(){if(V2===void 0){const n=Hr(6,6,Vf);n.globalCompositeOperation="lighter",n.fillStyle="rgba(210, 0, 0, 0.75)",Ik(n,4,5,4,0),Ik(n,4,5,0,5);const e=n.getImageData(0,0,3,3).data;V2=G2(e,0)||G2(e,4)||G2(e,8),jv(n),Vf.push(n.canvas)}return V2}function dx(n,e,t,r){const i=Bp(t,e,n);let s=rx(e,r,t);const a=e.getMetersPerUnit();a!==void 0&&(s*=a);const o=n.getMetersPerUnit();o!==void 0&&(s/=o);const l=n.getExtent();if(!l||kh(l,i)){const u=rx(n,s,i)/s;isFinite(u)&&u>0&&(s/=u)}return s}function J$(n,e,t,r){const i=Bo(t);let s=dx(n,e,i,r);return(!isFinite(s)||s<=0)&&zO(t,function(a){return s=dx(n,e,a,r),isFinite(s)&&s>0}),s}function J5(n,e,t,r,i,s,a,o,l,u,h,f,g,p){const E=Hr(Math.round(t*n),Math.round(t*e),Vf);if(f||(E.imageSmoothingEnabled=!1),l.length===0)return E.canvas;E.scale(t,t);function x(D){return Math.round(D*t)/t}E.globalCompositeOperation="lighter";const w=Zs();l.forEach(function(D,B,k){BO(w,D.extent)});let T;const I=t/r,P=(f?1:1+Math.pow(2,-24))/I;(!g||l.length!==1||u!==0)&&(T=Hr(Math.round(tn(w)*I),Math.round(Mr(w)*I),Vf),f||(T.imageSmoothingEnabled=!1),l.forEach(function(D,B,k){if(D.image.width>0&&D.image.height>0){if(D.clipExtent){T.save();const W=(D.clipExtent[0]-w[0])*I,F=-(D.clipExtent[3]-w[3])*I,Te=tn(D.clipExtent)*I,Me=Mr(D.clipExtent)*I;T.rect(f?W:Math.round(W),f?F:Math.round(F),f?Te:Math.round(W+Te)-Math.round(W),f?Me:Math.round(F+Me)-Math.round(F)),T.clip()}const C=(D.extent[0]-w[0])*I,M=-(D.extent[3]-w[3])*I,j=tn(D.extent)*I,O=Mr(D.extent)*I;T.drawImage(D.image,u,u,D.image.width-2*u,D.image.height-2*u,f?C:Math.round(C),f?M:Math.round(M),f?j:Math.round(C+j)-Math.round(C),f?O:Math.round(M+O)-Math.round(M)),D.clipExtent&&T.restore()}}));const N=nd(a);return o.getTriangles().forEach(function(D,B,k){const C=D.source,M=D.target;let j=C[0][0],O=C[0][1],W=C[1][0],F=C[1][1],Te=C[2][0],Me=C[2][1];const Le=x((M[0][0]-N[0])/s),Re=x(-(M[0][1]-N[1])/s),ue=x((M[1][0]-N[0])/s),be=x(-(M[1][1]-N[1])/s),ce=x((M[2][0]-N[0])/s),te=x(-(M[2][1]-N[1])/s),V=j,ie=O;j=0,O=0,W-=V,F-=ie,Te-=V,Me-=ie;const ne=[[W,F,0,0,ue-Le],[Te,Me,0,0,ce-Le],[0,0,W,F,be-Re],[0,0,Te,Me,te-Re]],ee=FB(ne);if(!ee)return;if(E.save(),E.beginPath(),Q$()||!f){E.moveTo(ue,be);const Oe=4,Se=Le-ue,Fe=Re-be;for(let je=0;je<Oe;je++)E.lineTo(ue+x((je+1)*Se/Oe),be+x(je*Fe/(Oe-1))),je!=Oe-1&&E.lineTo(ue+x((je+1)*Se/Oe),be+x((je+1)*Fe/(Oe-1)));E.lineTo(ce,te)}else E.moveTo(ue,be),E.lineTo(Le,Re),E.lineTo(ce,te);E.clip(),E.transform(ee[0],ee[2],ee[1],ee[3],Le,Re),E.translate(w[0]-V,w[3]-ie);let fe;if(T)fe=T.canvas,E.scale(P,-P);else{const Oe=l[0],Se=Oe.extent;fe=Oe.image,E.scale(tn(Se)/fe.width,-Mr(Se)/fe.height)}E.drawImage(fe,0,0),E.restore()}),T&&(jv(T),Vf.push(T.canvas)),h&&(E.save(),E.globalCompositeOperation="source-over",E.strokeStyle="black",E.lineWidth=1,o.getTriangles().forEach(function(D,B,k){const C=D.target,M=(C[0][0]-N[0])/s,j=-(C[0][1]-N[1])/s,O=(C[1][0]-N[0])/s,W=-(C[1][1]-N[1])/s,F=(C[2][0]-N[0])/s,Te=-(C[2][1]-N[1])/s;E.beginPath(),E.moveTo(O,W),E.lineTo(M,j),E.lineTo(F,Te),E.closePath(),E.stroke()}),E.restore()),E.canvas}const eW=10,Ak=.25;class eD{constructor(e,t,r,i,s,a,o){this.sourceProj_=e,this.targetProj_=t;let l={};const u=o?JS(P=>Wr(o,Bp(P,this.targetProj_,this.sourceProj_))):$m(this.targetProj_,this.sourceProj_);this.transformInv_=function(P){const N=P[0]+"/"+P[1];return l[N]||(l[N]=u(P)),l[N]},this.maxSourceExtent_=i,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!i&&!!this.sourceProj_.getExtent()&&tn(i)>=tn(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?tn(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?tn(this.targetProj_.getExtent()):null;const h=nd(r),f=kv(r),g=Pv(r),p=Cv(r),E=this.transformInv_(h),x=this.transformInv_(f),w=this.transformInv_(g),T=this.transformInv_(p),I=eW+(a?Math.max(0,Math.ceil(Math.log2(YS(r)/(a*a*256*256)))):0);if(this.addQuad_(h,f,g,p,E,x,w,T,I),this.wrapsXInSource_){let P=1/0;this.triangles_.forEach(function(N,D,B){P=Math.min(P,N.source[0][0],N.source[1][0],N.source[2][0])}),this.triangles_.forEach(N=>{if(Math.max(N.source[0][0],N.source[1][0],N.source[2][0])-P>this.sourceWorldWidth_/2){const D=[[N.source[0][0],N.source[0][1]],[N.source[1][0],N.source[1][1]],[N.source[2][0],N.source[2][1]]];D[0][0]-P>this.sourceWorldWidth_/2&&(D[0][0]-=this.sourceWorldWidth_),D[1][0]-P>this.sourceWorldWidth_/2&&(D[1][0]-=this.sourceWorldWidth_),D[2][0]-P>this.sourceWorldWidth_/2&&(D[2][0]-=this.sourceWorldWidth_);const B=Math.min(D[0][0],D[1][0],D[2][0]);Math.max(D[0][0],D[1][0],D[2][0])-B<this.sourceWorldWidth_/2&&(N.source=D)}})}l={}}addTriangle_(e,t,r,i,s,a){this.triangles_.push({source:[i,s,a],target:[e,t,r]})}addQuad_(e,t,r,i,s,a,o,l,u){const h=k4([s,a,o,l]),f=this.sourceWorldWidth_?tn(h)/this.sourceWorldWidth_:null,g=this.sourceWorldWidth_,p=this.sourceProj_.canWrapX()&&f>.5&&f<1;let E=!1;if(u>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const w=k4([e,t,r,i]);E=tn(w)/this.targetWorldWidth_>Ak||E}!p&&this.sourceProj_.isGlobal()&&f&&(E=f>Ak||E)}if(!E&&this.maxSourceExtent_&&isFinite(h[0])&&isFinite(h[1])&&isFinite(h[2])&&isFinite(h[3])&&!Qi(h,this.maxSourceExtent_))return;let x=0;if(!E&&(!isFinite(s[0])||!isFinite(s[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(l[0])||!isFinite(l[1]))){if(u>0)E=!0;else if(x=(!isFinite(s[0])||!isFinite(s[1])?8:0)+(!isFinite(a[0])||!isFinite(a[1])?4:0)+(!isFinite(o[0])||!isFinite(o[1])?2:0)+(!isFinite(l[0])||!isFinite(l[1])?1:0),x!=1&&x!=2&&x!=4&&x!=8)return}if(u>0){if(!E){const w=[(e[0]+r[0])/2,(e[1]+r[1])/2],T=this.transformInv_(w);let I;p?I=(Yc(s[0],g)+Yc(o[0],g))/2-Yc(T[0],g):I=(s[0]+o[0])/2-T[0];const P=(s[1]+o[1])/2-T[1];E=I*I+P*P>this.errorThresholdSquared_}if(E){if(Math.abs(e[0]-r[0])<=Math.abs(e[1]-r[1])){const w=[(t[0]+r[0])/2,(t[1]+r[1])/2],T=this.transformInv_(w),I=[(i[0]+e[0])/2,(i[1]+e[1])/2],P=this.transformInv_(I);this.addQuad_(e,t,w,I,s,a,T,P,u-1),this.addQuad_(I,w,r,i,P,T,o,l,u-1)}else{const w=[(e[0]+t[0])/2,(e[1]+t[1])/2],T=this.transformInv_(w),I=[(r[0]+i[0])/2,(r[1]+i[1])/2],P=this.transformInv_(I);this.addQuad_(e,w,I,i,s,T,P,l,u-1),this.addQuad_(w,t,r,I,T,a,o,P,u-1)}return}}if(p){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(x&11)==0&&this.addTriangle_(e,r,i,s,o,l),(x&14)==0&&this.addTriangle_(e,r,t,s,o,a),x&&((x&13)==0&&this.addTriangle_(t,i,e,a,l,s),(x&7)==0&&this.addTriangle_(t,i,r,a,l,o))}calculateSourceExtent(){const e=Zs();return this.triangles_.forEach(function(t,r,i){const s=t.source;um(e,s[0]),um(e,s[1]),um(e,s[2])}),e}getTriangles(){return this.triangles_}}const tD=.5;class nD extends vA{constructor(e,t,r,i,s,a,o,l,u,h,f,g){super(s,kt.IDLE,g),this.renderEdges_=f!==void 0?f:!1,this.pixelRatio_=o,this.gutter_=l,this.canvas_=null,this.sourceTileGrid_=t,this.targetTileGrid_=i,this.wrappedTileCoord_=a||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=e.canWrapX()?e.getExtent():void 0;const p=i.getTileCoordExtent(this.wrappedTileCoord_),E=this.targetTileGrid_.getExtent();let x=this.sourceTileGrid_.getExtent();const w=E?Al(p,E):p;if(YS(w)===0){this.state=kt.EMPTY;return}const T=e.getExtent();T&&(x?x=Al(x,T):x=T);const I=i.getResolution(this.wrappedTileCoord_[0]),P=J$(e,r,w,I);if(!isFinite(P)||P<=0){this.state=kt.EMPTY;return}const N=h!==void 0?h:tD;if(this.triangulation_=new eD(e,r,w,x,P*N,I),this.triangulation_.getTriangles().length===0){this.state=kt.EMPTY;return}this.sourceZ_=t.getZForResolution(P);let D=this.triangulation_.calculateSourceExtent();if(x&&(e.canWrapX()?(D[1]=Yn(D[1],x[1],x[3]),D[3]=Yn(D[3],x[1],x[3])):D=Al(D,x)),!YS(D))this.state=kt.EMPTY;else{let B=0,k=0;e.canWrapX()&&(B=tn(T),k=Math.floor((D[0]-T[0])/B)),HO(D.slice(),e,!0).forEach(M=>{const j=t.getTileRangeForExtentAndZ(M,this.sourceZ_);for(let O=j.minX;O<=j.maxX;O++)for(let W=j.minY;W<=j.maxY;W++){const F=u(this.sourceZ_,O,W,o);if(F){const Te=k*B;this.sourceTiles_.push({tile:F,offset:Te})}}++k}),this.sourceTiles_.length===0&&(this.state=kt.EMPTY)}}getImage(){return this.canvas_}reproject_(){const e=[];if(this.sourceTiles_.forEach(t=>{const r=t.tile;if(r&&r.getState()==kt.LOADED){const i=this.sourceTileGrid_.getTileCoordExtent(r.tileCoord);i[0]+=t.offset,i[2]+=t.offset;const s=this.clipExtent_?.slice();s&&(s[0]+=t.offset,s[2]+=t.offset),e.push({extent:i,clipExtent:s,image:r.getImage()})}}),this.sourceTiles_.length=0,e.length===0)this.state=kt.ERROR;else{const t=this.wrappedTileCoord_[0],r=this.targetTileGrid_.getTileSize(t),i=typeof r=="number"?r:r[0],s=typeof r=="number"?r:r[1],a=this.targetTileGrid_.getResolution(t),o=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=J5(i,s,this.pixelRatio_,o,this.sourceTileGrid_.getExtent(),a,l,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=kt.LOADED}this.changed()}load(){if(this.state==kt.IDLE){this.state=kt.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:t})=>{const r=t.getState();if(r==kt.IDLE||r==kt.LOADING){e++;const i=hn(t,zt.CHANGE,s=>{const a=t.getState();(a==kt.LOADED||a==kt.ERROR||a==kt.EMPTY)&&(Wn(i),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(i)}}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:t},r,i){t.getState()==kt.IDLE&&t.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(Wn),this.sourcesListenerKeys_=null}release(){this.canvas_&&(jv(this.canvas_.getContext("2d")),Vf.push(this.canvas_),this.canvas_=null),super.release()}}class EA{constructor(e,t,r,i){this.minX=e,this.maxX=t,this.minY=r,this.maxY=i}contains(e){return this.containsXY(e[1],e[2])}containsTileRange(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}containsXY(e,t){return this.minX<=e&&e<=this.maxX&&this.minY<=t&&t<=this.maxY}equals(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}extend(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}}function Jd(n,e,t,r,i){return i!==void 0?(i.minX=n,i.maxX=e,i.minY=t,i.maxY=r,i):new EA(n,e,t,r)}class bk{constructor(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const e=this.pop();e instanceof Av&&e.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(e){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let t=this.oldest_;for(;t;)e(t.value_,t.key_,this),t=t.newer}get(e,t){const r=this.entries_[e];return Cn(r!==void 0,"Tried to get a value for a key that does not exist in the cache"),r===this.newest_||(r===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(r.newer.older=r.older,r.older.newer=r.newer),r.newer=null,r.older=this.newest_,this.newest_.newer=r,this.newest_=r),r.value_}remove(e){const t=this.entries_[e];return Cn(t!==void 0,"Tried to get a value for a key that does not exist in the cache"),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_}getCount(){return this.count_}getKeys(){const e=new Array(this.count_);let t=0,r;for(r=this.newest_;r;r=r.older)e[t++]=r.key_;return e}getValues(){const e=new Array(this.count_);let t=0,r;for(r=this.newest_;r;r=r.older)e[t++]=r.value_;return e}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){return this.entries_[e]?.value_}pop(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,t){this.get(e),this.entries_[e].value_=t}set(e,t){Cn(!(e in this.entries_),"Tried to set a value for a key that is used already");const r={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=r:this.oldest_=r,this.newest_=r,this.entries_[e]=r,++this.count_}setSize(e){this.highWaterMark=e}}function fx(n,e,t,r){return r!==void 0?(r[0]=n,r[1]=e,r[2]=t,r):[n,e,t]}function tW(n,e,t){return n+"/"+e+"/"+t}function T_(n,e,t,r,i){return`${_n(n)},${e},${tW(t,r,i)}`}function rD(n){return nW(n[0],n[1],n[2])}function nW(n,e,t){return(e<<n)+t}function rW(n,e){const t=n[0],r=n[1],i=n[2];if(e.getMinZoom()>t||t>e.getMaxZoom())return!1;const s=e.getFullTileRange(t);return s?s.containsXY(r,i):!0}class iW extends dA{constructor(e){super(e),this.image=null}getImage(){return this.image?this.image.getImage():null}prepareFrame(e){const t=e.layerStatesArray[e.layerIndex],r=e.pixelRatio,i=e.viewState,s=i.resolution,a=this.getLayer().getSource(),o=e.viewHints;let l=e.extent;if(t.extent!==void 0&&(l=Al(l,Co(t.extent,i.projection))),!o[ni.ANIMATING]&&!o[ni.INTERACTING]&&!C0(l))if(a){const u=i.projection,h=a.getImage(l,s,r,u);h&&(this.loadImage(h)?this.image=h:h.getState()===pt.EMPTY&&(this.image=null))}else this.image=null;return!!this.image}getData(e){const t=this.frameState;if(!t)return null;const r=this.getLayer(),i=Wr(t.pixelToCoordinateTransform,e.slice()),s=r.getExtent();if(s&&!kh(s,i))return null;const a=this.image.getExtent(),o=this.image.getImage(),l=tn(a),u=Math.floor(o.width*((i[0]-a[0])/l));if(u<0||u>=o.width)return null;const h=Mr(a),f=Math.floor(o.height*((a[3]-i[1])/h));return f<0||f>=o.height?null:this.getImageData(o,u,f)}renderFrame(e,t){const r=this.image,i=r.getExtent(),s=r.getResolution(),[a,o]=Array.isArray(s)?s:[s,s],l=r.getPixelRatio(),u=e.layerStatesArray[e.layerIndex],h=e.pixelRatio,f=e.viewState,g=f.center,p=f.resolution,E=h*a/(p*l),x=h*o/(p*l);this.prepareContainer(e,t);const w=this.context.canvas.width,T=this.context.canvas.height,I=this.getRenderContext(e);let P=!1,N=!0;if(u.extent){const M=Co(u.extent,f.projection);N=Qi(M,e.extent),P=N&&!Fc(M,e.extent),P&&this.clipUnrotated(I,e,M)}const D=r.getImage(),B=Uo(this.tempTransform,w/2,T/2,E,x,0,l*(i[0]-g[0])/a,l*(g[1]-i[3])/o);this.renderedResolution=o*h/l;const k=D.width*B[0],C=D.height*B[3];if(this.getLayer().getSource().getInterpolate()||(I.imageSmoothingEnabled=!1),this.preRender(I,e),N&&k>=.5&&C>=.5){const M=B[4],j=B[5],O=u.opacity;O!==1&&(I.save(),I.globalAlpha=O),I.drawImage(D,0,0,+D.width,+D.height,M,j,k,C),O!==1&&I.restore()}return this.postRender(this.context,e),P&&I.restore(),I.imageSmoothingEnabled=!0,this.container}}class sW extends Yp{constructor(e){e=e||{},super(e)}}class aW extends sW{constructor(e){super(e)}createRenderer(){return new iW(this)}getData(e){return super.getData(e)}}function B2(n,e,t){if(!(t in n))return n[t]=new Set([e]),!0;const r=n[t],i=r.has(e);return i||r.add(e),!i}function oW(n,e,t){const r=n[t];return r?r.delete(e):!1}function Rk(n,e){const t=n.layerStatesArray[n.layerIndex];t.extent&&(e=Al(e,Co(t.extent,n.viewState.projection)));const r=t.layer.getRenderSource();if(!r.getWrapX()){const i=r.getTileGridForProjection(n.viewState.projection).getExtent();i&&(e=Al(e,i))}return e}class lW extends dA{constructor(e,t){super(e),t=t||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=Zs(),this.tempTileRange_=new EA(0,0,0,0),this.tempTileCoord_=fx(0,0,0);const r=t.cacheSize!==void 0?t.cacheSize:512;this.tileCache_=new bk(r),this.sourceTileCache_=null,this.maxStaleKeys=r*.5}getTileCache(){return this.tileCache_}getSourceTileCache(){return this.sourceTileCache_||(this.sourceTileCache_=new bk(512)),this.sourceTileCache_}getOrCreateTile(e,t,r,i){const s=this.tileCache_,o=this.getLayer().getSource(),l=T_(o,o.getKey(),e,t,r);let u;if(s.containsKey(l))u=s.get(l);else{const h=i.viewState.projection,f=o.getProjection();if(u=o.getTile(e,t,r,i.pixelRatio,h,!f||Sh(f,h)?void 0:this.getSourceTileCache()),!u)return null;s.set(l,u)}return u}getTile(e,t,r,i){const s=this.getOrCreateTile(e,t,r,i);return s||null}getData(e){const t=this.frameState;if(!t)return null;const r=this.getLayer(),i=Wr(t.pixelToCoordinateTransform,e.slice()),s=r.getExtent();if(s&&!kh(s,i))return null;const a=t.viewState,o=r.getRenderSource(),l=o.getTileGridForProjection(a.projection),u=o.getTilePixelRatio(t.pixelRatio);for(let h=l.getZForResolution(a.resolution);h>=l.getMinZoom();--h){const f=l.getTileCoordForCoordAndZ(i,h),g=this.getTile(h,f[1],f[2],t);if(!g||g.getState()!==kt.LOADED)continue;const p=l.getOrigin(h),E=xs(l.getTileSize(h)),x=l.getResolution(h);let w;if(g instanceof Q5||g instanceof nD)w=g.getImage();else if(g instanceof Tk){if(w=uT(g.getData()),!w)continue}else continue;const T=Math.floor(u*((i[0]-p[0])/x-f[1]*E[0])),I=Math.floor(u*((p[1]-i[1])/x-f[2]*E[1])),P=Math.round(u*o.getGutterForProjection(a.projection));return this.getImageData(w,T+P,I+P)}return null}prepareFrame(e){this.renderedProjection?e.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=e.viewState.projection):this.renderedProjection=e.viewState.projection;const t=this.getLayer().getSource();if(!t)return!1;const r=t.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==r&&(this.renderedSourceRevision_=r,this.renderedSourceKey_===t.getKey()&&(this.tileCache_.clear(),this.sourceTileCache_?.clear())):this.renderedSourceRevision_=r,!0}enqueueTilesForNextExtent(){return!0}enqueueTiles(e,t,r,i,s){const a=e.viewState,o=this.getLayer(),l=o.getRenderSource(),u=l.getTileGridForProjection(a.projection),h=_n(l);h in e.wantedTiles||(e.wantedTiles[h]={});const f=e.wantedTiles[h],g=o.getMapInternal(),p=Math.max(r-s,u.getMinZoom(),u.getZForResolution(Math.min(o.getMaxResolution(),g?g.getView().getResolutionForZoom(Math.max(o.getMinZoom(),0)):u.getResolution(0)),l.zDirection)),E=a.rotation,x=E?$O(a.center,a.resolution,E,e.size):void 0;for(let w=r;w>=p;--w){const T=u.getTileRangeForExtentAndZ(t,w,this.tempTileRange_),I=u.getResolution(w);for(let P=T.minX;P<=T.maxX;++P)for(let N=T.minY;N<=T.maxY;++N){if(E&&!u.tileCoordIntersectsViewport([w,P,N],x))continue;const D=this.getTile(w,P,N,e);if(!D||!B2(i,D,w))continue;const k=D.getKey();if(f[k]=!0,D.getState()===kt.IDLE&&!e.tileQueue.isKeyQueued(k)){const C=fx(w,P,N,this.tempTileCoord_);e.tileQueue.enqueue([D,h,u.getTileCoordCenter(C),I])}}}}findStaleTile_(e,t){const r=this.tileCache_,i=e[0],s=e[1],a=e[2],o=this.getStaleKeys();for(let l=0;l<o.length;++l){const u=T_(this.getLayer().getSource(),o[l],i,s,a);if(r.containsKey(u)){const h=r.peek(u);if(h.getState()===kt.LOADED)return h.endTransition(_n(this)),B2(t,h,i),!0}}return!1}findAltTiles_(e,t,r,i){const s=e.getTileRangeForTileCoordAndZ(t,r,this.tempTileRange_);if(!s)return!1;let a=!0;const o=this.tileCache_,l=this.getLayer().getRenderSource(),u=l.getKey();for(let h=s.minX;h<=s.maxX;++h)for(let f=s.minY;f<=s.maxY;++f){const g=T_(l,u,r,h,f);let p=!1;if(o.containsKey(g)){const E=o.peek(g);E.getState()===kt.LOADED&&(B2(i,E,r),p=!0)}p||(a=!1)}return a}renderFrame(e,t){this.renderComplete=!0;const r=e.layerStatesArray[e.layerIndex],i=e.viewState,s=i.projection,a=i.resolution,o=i.center,l=e.pixelRatio,u=this.getLayer(),h=u.getSource(),f=h.getTileGridForProjection(s),g=f.getZForResolution(a,h.zDirection),p=f.getResolution(g),E=h.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==E&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=E):this.renderedSourceKey_=E;let x=e.extent;const w=h.getTilePixelRatio(l);this.prepareContainer(e,t);const T=this.context.canvas.width,I=this.context.canvas.height,P=r.extent&&Co(r.extent);P&&(x=Al(x,Co(r.extent)));const N=p*T/2/w,D=p*I/2/w,B=[o[0]-N,o[1]-D,o[0]+N,o[1]+D],k={};this.renderedTiles.length=0;const C=u.getPreload();if(e.nextExtent&&this.enqueueTilesForNextExtent()){const ue=f.getZForResolution(i.nextResolution,h.zDirection),be=Rk(e,e.nextExtent);this.enqueueTiles(e,be,ue,k,C)}const M=Rk(e,x);if(this.enqueueTiles(e,M,g,k,0),C>0&&setTimeout(()=>{this.enqueueTiles(e,M,g-1,k,C-1)},0),!(g in k))return this.container;const j=_n(this),O=e.time;for(const ue of k[g]){const be=ue.getState();if(be===kt.EMPTY)continue;const ce=ue.tileCoord;if(be===kt.LOADED&&ue.getAlpha(j,O)===1){ue.endTransition(j);continue}if(be!==kt.ERROR&&(this.renderComplete=!1),this.findStaleTile_(ce,k)){oW(k,ue,g),e.animate=!0;continue}if(this.findAltTiles_(f,ce,g+1,k))continue;const ie=f.getMinZoom();for(let ne=g-1;ne>=ie&&!this.findAltTiles_(f,ce,ne,k);--ne);}const W=p/a*l/w,F=this.getRenderContext(e);Uo(this.tempTransform,T/2,I/2,W,W,0,-T/2,-I/2),r.extent&&this.clipUnrotated(F,e,P),h.getInterpolate()||(F.imageSmoothingEnabled=!1),this.preRender(F,e);const Te=Object.keys(k).map(Number);Te.sort(Il);let Me;const Le=[],Re=[];for(let ue=Te.length-1;ue>=0;--ue){const be=Te[ue],ce=h.getTilePixelSize(be,l,s),V=f.getResolution(be)/p,ie=ce[0]*V*W,ne=ce[1]*V*W,ee=f.getTileCoordForCoordAndZ(nd(B),be),fe=f.getTileCoordExtent(ee),Oe=Wr(this.tempTransform,[w*(fe[0]-B[0])/p,w*(B[3]-fe[3])/p]),Se=w*h.getGutterForProjection(s);for(const Fe of k[be]){if(Fe.getState()!==kt.LOADED)continue;const je=Fe.tileCoord,Qe=ee[1]-je[1],gt=Math.round(Oe[0]-(Qe-1)*ie),yt=ee[2]-je[2],Lt=Math.round(Oe[1]-(yt-1)*ne),nn=Math.round(Oe[0]-Qe*ie),Ut=Math.round(Oe[1]-yt*ne),De=gt-nn,Xt=Lt-Ut,Ie=Te.length===1;let me=!1;Me=[nn,Ut,nn+De,Ut,nn+De,Ut+Xt,nn,Ut+Xt];for(let R=0,Et=Le.length;R<Et;++R)if(!Ie&&be<Re[R]){const X=Le[R];Qi([nn,Ut,nn+De,Ut+Xt],[X[0],X[3],X[4],X[7]])&&(me||(F.save(),me=!0),F.beginPath(),F.moveTo(Me[0],Me[1]),F.lineTo(Me[2],Me[3]),F.lineTo(Me[4],Me[5]),F.lineTo(Me[6],Me[7]),F.moveTo(X[6],X[7]),F.lineTo(X[4],X[5]),F.lineTo(X[2],X[3]),F.lineTo(X[0],X[1]),F.clip())}Le.push(Me),Re.push(be),this.drawTile(Fe,e,nn,Ut,De,Xt,Se,Ie),me&&F.restore(),this.renderedTiles.unshift(Fe),this.updateUsedTiles(e.usedTiles,h,Fe)}}if(this.renderedResolution=p,this.extentChanged=!this.renderedExtent_||!n0(this.renderedExtent_,B),this.renderedExtent_=B,this.renderedPixelRatio=l,this.postRender(this.context,e),r.extent&&F.restore(),F.imageSmoothingEnabled=!0,this.renderComplete){const ue=(be,ce)=>{const te=_n(h),V=ce.wantedTiles[te],ie=V?Object.keys(V).length:0;this.updateCacheSize(ie),this.tileCache_.expireCache(),this.sourceTileCache_?.expireCache()};e.postRenderFunctions.push(ue)}return this.container}updateCacheSize(e){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,e*2)}drawTile(e,t,r,i,s,a,o,l){let u;if(e instanceof Tk){if(u=uT(e.getData()),!u)throw new Error("Rendering array data is not yet supported")}else u=this.getTileImage(e);if(!u)return;const h=this.getRenderContext(t),f=_n(this),g=t.layerStatesArray[t.layerIndex],p=g.opacity*(l?e.getAlpha(f,t.time):1),E=p!==h.globalAlpha;E&&(h.save(),h.globalAlpha=p),h.drawImage(u,o,o,u.width-2*o,u.height-2*o,r,i,s,a),E&&h.restore(),p!==g.opacity?t.animate=!0:l&&e.endTransition(f)}getImage(){const e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}updateUsedTiles(e,t,r){const i=_n(t);i in e||(e[i]={}),e[i][r.getKey()]=!0}}const Hy={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class cW extends Yp{constructor(e){e=e||{};const t=Object.assign({},e),r=e.cacheSize;delete e.cacheSize,delete t.preload,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un,this.cacheSize_=r,this.setPreload(e.preload!==void 0?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(Hy.PRELOAD)}setPreload(e){this.set(Hy.PRELOAD,e)}getUseInterimTilesOnError(){return this.get(Hy.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(Hy.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}}class Ju extends cW{constructor(e){super(e)}createRenderer(){return new lW(this,{cacheSize:this.getCacheSize()})}}function hT(n){return Array.isArray(n)?Math.min(...n):n}const ef=[0,0,0],wc=5;class iD{constructor(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,Cn(RB(this.resolutions_,(i,s)=>s-i),"`resolutions` must be sorted in descending order");let t;if(!e.origins){for(let i=0,s=this.resolutions_.length-1;i<s;++i)if(!t)t=this.resolutions_[i]/this.resolutions_[i+1];else if(this.resolutions_[i]/this.resolutions_[i+1]!==t){t=void 0;break}}this.zoomFactor_=t,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,Cn(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const r=e.extent;r!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=nd(r)),Cn(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,Cn(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:_A,Cn(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=r!==void 0?r:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map((i,s)=>{const a=new EA(Math.min(0,i[0]),Math.max(i[0]-1,-1),Math.min(0,i[1]),Math.max(i[1]-1,-1));if(r){const o=this.getTileRangeForExtentAndZ(r,s);a.minX=Math.max(o.minX,a.minX),a.maxX=Math.min(o.maxX,a.maxX),a.minY=Math.max(o.minY,a.minY),a.maxY=Math.min(o.maxY,a.maxY)}return a}):r&&this.calculateTileRanges_(r)}forEachTileCoord(e,t,r){const i=this.getTileRangeForExtentAndZ(e,t);for(let s=i.minX,a=i.maxX;s<=a;++s)for(let o=i.minY,l=i.maxY;o<=l;++o)r([t,s,o])}forEachTileCoordParentTileRange(e,t,r,i){let s,a,o,l=null,u=e[0]-1;for(this.zoomFactor_===2?(a=e[1],o=e[2]):l=this.getTileCoordExtent(e,i);u>=this.minZoom;){if(a!==void 0&&o!==void 0?(a=Math.floor(a/2),o=Math.floor(o/2),s=Jd(a,a,o,o,r)):s=this.getTileRangeForExtentAndZ(l,u,r),t(u,s))return!0;--u}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,t,r){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){const s=e[1]*2,a=e[2]*2;return Jd(s,s+1,a,a+1,t)}const i=this.getTileCoordExtent(e,r||this.tmpExtent_);return this.getTileRangeForExtentAndZ(i,e[0]+1,t)}return null}getTileRangeForTileCoordAndZ(e,t,r){if(t>this.maxZoom||t<this.minZoom)return null;const i=e[0],s=e[1],a=e[2];if(t===i)return Jd(s,a,s,a,r);if(this.zoomFactor_){const l=Math.pow(this.zoomFactor_,t-i),u=Math.floor(s*l),h=Math.floor(a*l);if(t<i)return Jd(u,u,h,h,r);const f=Math.floor(l*(s+1))-1,g=Math.floor(l*(a+1))-1;return Jd(u,f,h,g,r)}const o=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(o,t,r)}getTileRangeForExtentAndZ(e,t,r){this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,ef);const i=ef[1],s=ef[2];this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,ef);const a=ef[1],o=ef[2];return Jd(i,a,s,o,r)}getTileCoordCenter(e){const t=this.getOrigin(e[0]),r=this.getResolution(e[0]),i=xs(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*i[0]*r,t[1]-(e[2]+.5)*i[1]*r]}getTileCoordExtent(e,t){const r=this.getOrigin(e[0]),i=this.getResolution(e[0]),s=xs(this.getTileSize(e[0]),this.tmpSize_),a=r[0]+e[1]*s[0]*i,o=r[1]-(e[2]+1)*s[1]*i,l=a+s[0]*i,u=o+s[1]*i;return ru(a,o,l,u,t)}getTileCoordForCoordAndResolution(e,t,r){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,r)}getTileCoordForXYAndResolution_(e,t,r,i,s){const a=this.getZForResolution(r),o=r/this.getResolution(a),l=this.getOrigin(a),u=xs(this.getTileSize(a),this.tmpSize_);let h=o*(e-l[0])/r/u[0],f=o*(l[1]-t)/r/u[1];return i?(h=jc(h,wc)-1,f=jc(f,wc)-1):(h=Fy(h,wc),f=Fy(f,wc)),fx(a,h,f,s)}getTileCoordForXYAndZ_(e,t,r,i,s){const a=this.getOrigin(r),o=this.getResolution(r),l=xs(this.getTileSize(r),this.tmpSize_);let u=(e-a[0])/o/l[0],h=(a[1]-t)/o/l[1];return i?(u=jc(u,wc)-1,h=jc(h,wc)-1):(u=Fy(u,wc),h=Fy(h,wc)),fx(r,u,h,s)}getTileCoordForCoordAndZ(e,t,r){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,r)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,t){const r=bv(this.resolutions_,e,t||0);return Yn(r,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,t){return c5(t,0,t.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){const t=this.resolutions_.length,r=new Array(t);for(let i=this.minZoom;i<t;++i)r[i]=this.getTileRangeForExtentAndZ(e,i);this.fullTileRanges_=r}}function sD(n){let e=n.getDefaultTileGrid();return e||(e=fW(n),n.setDefaultTileGrid(e)),e}function uW(n,e,t){const r=e[0],i=n.getTileCoordCenter(e),s=wA(t);if(!kh(s,i)){const a=tn(s),o=Math.ceil((s[0]-i[0])/a);return i[0]+=a*o,n.getTileCoordForCoordAndZ(i,r)}return e}function hW(n,e,t,r){r=r!==void 0?r:"top-left";const i=aD(n,e,t);return new iD({extent:n,origin:NB(n,r),resolutions:i,tileSize:t})}function dW(n){const e=n||{},t=e.extent||Bn("EPSG:3857").getExtent(),r={extent:t,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:aD(t,e.maxZoom,e.tileSize,e.maxResolution)};return new iD(r)}function aD(n,e,t,r){e=e!==void 0?e:z$,t=xs(t!==void 0?t:_A);const i=Mr(n),s=tn(n);r=r>0?r:Math.max(s/t[0],i/t[1]);const a=e+1,o=new Array(a);for(let l=0;l<a;++l)o[l]=r/Math.pow(2,l);return o}function fW(n,e,t,r){const i=wA(n);return hW(i,e,t,r)}function wA(n){n=Bn(n);let e=n.getExtent();if(!e){const t=180*r0.degrees/n.getMetersPerUnit();e=ru(-t,-t,t,t)}return e}function SA(n,e){const t=[];Object.keys(e).forEach(function(i){e[i]!==null&&e[i]!==void 0&&t.push(i+"="+encodeURIComponent(e[i]))});const r=t.join("&");return n=n.replace(/[?&]$/,""),n+=n.includes("?")?"&":"?",n+r}const gW=/\{z\}/g,mW=/\{x\}/g,pW=/\{y\}/g,yW=/\{-y\}/g;function _W(n,e,t,r,i){return n.replace(gW,e.toString()).replace(mW,t.toString()).replace(pW,r.toString()).replace(yW,function(){if(i===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(i-r).toString()})}function xW(n){const e=[];let t=/\{([a-z])-([a-z])\}/.exec(n);if(t){const r=t[1].charCodeAt(0),i=t[2].charCodeAt(0);let s;for(s=r;s<=i;++s)e.push(n.replace(t[0],String.fromCharCode(s)));return e}if(t=/\{(\d+)-(\d+)\}/.exec(n),t){const r=parseInt(t[2],10);for(let i=parseInt(t[1],10);i<=r;i++)e.push(n.replace(t[0],i.toString()));return e}return e.push(n),e}function vW(n,e){return(function(t,r,i){if(!t)return;let s;const a=t[0];if(e){const o=e.getFullTileRange(a);o&&(s=o.getHeight()-1)}return _W(n,a,t[1],t[2],s)})}function EW(n,e){const t=n.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=vW(n[i],e);return wW(r)}function wW(n){return n.length===1?n[0]:(function(e,t,r){if(!e)return;const i=rD(e),s=Yc(i,n.length);return n[s](e,t,r)})}class SW extends hA{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=e.tilePixelRatio!==void 0?e.tilePixelRatio:1,this.tileGrid=e.tileGrid!==void 0?e.tileGrid:null;const t=[256,256];this.tileGrid&&xs(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),t),this.tmpSize=[0,0],this.key_=e.key||_n(this),this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}getGutterForProjection(e){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getResolutions(e){const t=e?this.getTileGridForProjection(e):this.tileGrid;return t?t.getResolutions():null}getTile(e,t,r,i,s,a){return Ft()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:sD(e)}getTilePixelRatio(e){return this.tilePixelRatio_}getTilePixelSize(e,t,r){const i=this.getTileGridForProjection(r),s=this.getTilePixelRatio(t),a=xs(i.getTileSize(e),this.tmpSize);return s==1?a:Cz(a,s,this.tmpSize)}getTileCoordForTileUrlFunction(e,t){const r=t!==void 0?t:this.getProjection(),i=t!==void 0?this.getTileGridForProjection(r):this.tileGrid||this.getTileGridForProjection(r);return this.getWrapX()&&r.isGlobal()&&(e=uW(i,e,r)),rW(e,i)?e:null}clear(){}refresh(){this.clear(),super.refresh()}}class TW extends qo{constructor(e,t){super(e),this.tile=t}}const U2={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class TA extends SW{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===TA.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){const t=e.target,r=_n(t),i=t.getState();let s;i==kt.LOADING?(this.tileLoadingKeys_[r]=!0,s=U2.TILELOADSTART):r in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[r],s=i==kt.ERROR?U2.TILELOADERROR:i==kt.LOADED?U2.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new TW(s,t))}setTileLoadFunction(e){this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,t){this.tileUrlFunction=e,typeof t<"u"?this.setKey(t):this.changed()}setUrl(e){const t=xW(e);this.urls=t,this.setUrls(t)}setUrls(e){this.urls=e;const t=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(EW(e,this.tileGrid),t):this.setKey(t)}tileUrlFunction(e,t,r){}}class oD extends TA{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:lD,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate!==void 0?e.interpolate:!0,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,this.tileClass=e.tileClass!==void 0?e.tileClass:Q5,this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(e){return this.getProjection()&&e&&!Sh(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getTileGridForProjection(e){const t=this.getProjection();if(this.tileGrid&&(!t||Sh(t,e)))return this.tileGrid;const r=_n(e);return r in this.tileGridForProjection||(this.tileGridForProjection[r]=sD(e)),this.tileGridForProjection[r]}createTile_(e,t,r,i,s,a){const o=[e,t,r],l=this.getTileCoordForTileUrlFunction(o,s),u=l?this.tileUrlFunction(l,i,s):void 0,h=new this.tileClass(o,u!==void 0?kt.IDLE:kt.EMPTY,u!==void 0?u:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return h.key=a,h.addEventListener(zt.CHANGE,this.handleTileChange.bind(this)),h}getTile(e,t,r,i,s,a){const o=this.getProjection();if(!o||!s||Sh(o,s))return this.getTileInternal(e,t,r,i,o||s);const l=[e,t,r],u=this.getKey(),h=this.getTileGridForProjection(o),f=this.getTileGridForProjection(s),g=this.getTileCoordForTileUrlFunction(l,s),p=new nD(o,h,s,f,l,g,this.getTilePixelRatio(i),this.getGutter(),(E,x,w,T)=>this.getTileInternal(E,x,w,T,o,a),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return p.key=u,p}getTileInternal(e,t,r,i,s,a){const o=this.getKey(),l=T_(this,o,e,t,r);if(a&&a.containsKey(l))return a.get(l);const u=this.createTile_(e,t,r,i,s,o);return a?.set(l,u),u}setRenderReprojectionEdges(e){this.renderReprojectionEdges_!=e&&(this.renderReprojectionEdges_=e,this.changed())}setTileGridForProjection(e,t){const r=Bn(e);if(r){const i=_n(r);i in this.tileGridForProjection||(this.tileGridForProjection[i]=t)}}}function lD(n,e){if(Ks){const t=n.getCrossOrigin();let r="same-origin",i="same-origin";t==="anonymous"||t===""?(r="cors",i="omit"):t==="use-credentials"&&(r="cors",i="include"),fetch(e,{mode:r,credentials:i}).then(s=>{if(!s.ok)throw new Error(`HTTP ${s.status}`);return s.blob()}).then(s=>createImageBitmap(s)).then(s=>{const a=n.getImage();a.width=s.width,a.height=s.height,a.getContext("2d").drawImage(s,0,0),s.close?.(),a.dispatchEvent(new Event("load"))}).catch(()=>{n.getImage().dispatchEvent(new Event("error"))});return}n.getImage().src=e}class pf extends oD{constructor(e){e=e||{};const t=e.projection!==void 0?e.projection:"EPSG:3857",r=e.tileGrid!==void 0?e.tileGrid:dW({extent:wA(t),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:t,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:r,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0}getGutter(){return this.gutter_}}const IW="modulepreload",AW=function(n){return"/detectorapp-nl/"+n},Ck={},dt=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){let l=function(u){return Promise.all(u.map(h=>Promise.resolve(h).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=a?.nonce||a?.getAttribute("nonce");i=l(t.map(u=>{if(u=AW(u),u in Ck)return;Ck[u]=!0;const h=u.endsWith(".css"),f=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${f}`))return;const g=document.createElement("link");if(g.rel=h?"stylesheet":IW,h||(g.as="script"),g.crossOrigin="",g.href=u,o&&g.setAttribute("nonce",o),document.head.appendChild(g),h)return new Promise((p,E)=>{g.addEventListener("load",p),g.addEventListener("error",()=>E(new Error(`Unable to preload CSS for ${u}`)))})}))}function s(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return i.then(a=>{for(const o of a||[])o.status==="rejected"&&s(o.reason);return e().catch(s)})};class bW extends _5{constructor(e,t,r,i,s,a,o){let l=e.getExtent();l&&e.canWrapX()&&(l=l.slice(),l[0]=-1/0,l[2]=1/0);let u=t.getExtent();u&&t.canWrapX()&&(u=u.slice(),u[0]=-1/0,u[2]=1/0);const h=u?Al(r,u):r,f=Bo(h),g=dx(e,t,f,i),p=tD,E=new eD(e,t,h,l,g*p,i),x=E.calculateSourceExtent(),w=C0(x)?null:a(x,g,s),T=w?pt.IDLE:pt.EMPTY,I=w?w.getPixelRatio():1;super(r,i,I,T),this.targetProj_=t,this.maxSourceExtent_=l,this.triangulation_=E,this.targetResolution_=i,this.targetExtent_=r,this.sourceImage_=w,this.sourcePixelRatio_=I,this.interpolate_=o,this.canvas_=null,this.sourceListenerKey_=null}disposeInternal(){this.state==pt.LOADING&&this.unlistenSource_(),super.disposeInternal()}getImage(){return this.canvas_}getProjection(){return this.targetProj_}reproject_(){const e=this.sourceImage_.getState();if(e==pt.LOADED){const t=tn(this.targetExtent_)/this.targetResolution_,r=Mr(this.targetExtent_)/this.targetResolution_;this.canvas_=J5(t,r,this.sourcePixelRatio_,hT(this.sourceImage_.getResolution()),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0,void 0,this.interpolate_,!0)}this.state=e,this.changed()}load(){if(this.state==pt.IDLE){this.state=pt.LOADING,this.changed();const e=this.sourceImage_.getState();e==pt.LOADED||e==pt.ERROR?this.reproject_():(this.sourceListenerKey_=hn(this.sourceImage_,zt.CHANGE,t=>{const r=this.sourceImage_.getState();(r==pt.LOADED||r==pt.ERROR)&&(this.unlistenSource_(),this.reproject_())}),this.sourceImage_.load())}}unlistenSource_(){Wn(this.sourceListenerKey_),this.sourceListenerKey_=null}}const Uc=4,z2={IMAGELOADSTART:"imageloadstart",IMAGELOADEND:"imageloadend",IMAGELOADERROR:"imageloaderror"};class RW extends qo{constructor(e,t){super(e),this.image=t}}class CW extends hA{constructor(e){super({attributions:e.attributions,projection:e.projection,state:e.state,interpolate:e.interpolate!==void 0?e.interpolate:!0}),this.on,this.once,this.un,this.loader=e.loader||null,this.resolutions_=e.resolutions!==void 0?e.resolutions:null,this.reprojectedImage_=null,this.reprojectedRevision_=0,this.image=null,this.wantedExtent_,this.wantedResolution_,this.static_=e.loader?e.loader.length===0:!1,this.wantedProjection_=null}getResolutions(){return this.resolutions_}setResolutions(e){this.resolutions_=e}findNearestResolution(e){const t=this.getResolutions();if(t){const r=bv(t,e,0);e=t[r]}return e}getImage(e,t,r,i){const s=this.getProjection();if(!s||!i||Sh(s,i))return s&&(i=s),this.getImageInternal(e,t,r,i);if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&Sh(this.reprojectedImage_.getProjection(),i)&&this.reprojectedImage_.getResolution()==t&&n0(this.reprojectedImage_.getExtent(),e))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new bW(s,i,e,t,r,(a,o,l)=>this.getImageInternal(a,o,l,s),this.getInterpolate()),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}getImageInternal(e,t,r,i){if(this.loader){const s=cD(e,t,r,1),a=this.findNearestResolution(t);if(this.image&&(this.static_||this.wantedProjection_===i&&(this.wantedExtent_&&Fc(this.wantedExtent_,s)||Fc(this.image.getExtent(),s))&&(this.wantedResolution_&&hT(this.wantedResolution_)===a||hT(this.image.getResolution())===a)))return this.image;this.wantedProjection_=i,this.wantedExtent_=s,this.wantedResolution_=a,this.image=new _5(s,a,r,this.loader),this.image.addEventListener(zt.CHANGE,this.handleImageChange.bind(this))}return this.image}handleImageChange(e){const t=e.target;let r;switch(t.getState()){case pt.LOADING:this.loading=!0,r=z2.IMAGELOADSTART;break;case pt.LOADED:this.loading=!1,r=z2.IMAGELOADEND;break;case pt.ERROR:this.loading=!1,r=z2.IMAGELOADERROR;break;default:return}this.hasListener(r)&&this.dispatchEvent(new RW(r,t))}}function PW(n,e){n.getImage().src=e}function cD(n,e,t,r){const i=e/t,s=Bo(n),a=jc(tn(n)/i,Uc),o=jc(Mr(n)/i,Uc),l=jc((r-1)*a/2,Uc),u=a+2*l,h=jc((r-1)*o/2,Uc),f=o+2*h;return Z_(s,i,0,[u,f])}function kW(n,e,t,r,i,s){const a=i.getCode().split(/:(?=\d+$)/).pop(),o=t/r,l=[Q_(tn(e)/o,Uc),Q_(Mr(e)/o,Uc)];s.SIZE=l[0]+","+l[1],s.BBOX=e.join(","),s.BBOXSR=a,s.IMAGESR=a,s.DPI=Math.round(s.DPI?s.DPI*r:90*r);const u=n.replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage");return SA(u,s)}function MW(n){const e=n.load?n.load:v5,t=Bn(n.projection||"EPSG:3857"),r=n.ratio??1.5,i=n.crossOrigin??null;return function(s,a,o){o=n.hidpi?o:1;const l={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};Object.assign(l,n.params),s=cD(s,a,o,r);const u=kW(n.url,s,a,o,t,l),h=new Image;return h.crossOrigin=i,e(h,u).then(f=>{const g=tn(s)/f.width*o;return{image:f,extent:s,resolution:g,pixelRatio:o}})}}class NW extends CW{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:e.interpolate,projection:e.projection,resolutions:e.resolutions}),this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.url_=e.url,this.imageLoadFunction_=e.imageLoadFunction!==void 0?e.imageLoadFunction:PW,this.params_=Object.assign({},e.params),this.imageSize_=[0,0],this.renderedRevision_=0,this.ratio_=e.ratio!==void 0?e.ratio:1.5,this.loaderProjection_=null}getParams(){return this.params_}getImageInternal(e,t,r,i){return this.url_===void 0?null:((!this.loader||this.loaderProjection_!==i)&&(this.loaderProjection_=i,this.loader=MW({crossOrigin:this.crossOrigin_,params:this.params_,projection:i,hidpi:this.hidpi_,url:this.url_,ratio:this.ratio_,load:(s,a)=>(this.image.setImage(s),this.imageLoadFunction_(this.image,a),v5(s))})),super.getImageInternal(e,t,r,i))}getImageLoadFunction(){return this.imageLoadFunction_}getUrl(){return this.url_}setImageLoadFunction(e){this.imageLoadFunction_=e,this.changed()}setUrl(e){e!=this.url_&&(this.url_=e,this.loader=null,this.changed())}setParams(e){this.params_=Object.assign({},e),this.changed()}updateParams(e){Object.assign(this.params_,e),this.changed()}changed(){this.image=null,super.changed()}}const dT="1.3.0";function LW(n,e,t,r,i){i.WIDTH=t[0],i.HEIGHT=t[1];const s=r.getAxisOrientation(),a=KO(i.VERSION,"1.3")>=0;i[a?"CRS":"SRS"]=r.getCode();const o=a&&s.startsWith("ne")?[e[1],e[0],e[3],e[2]]:e;return i.BBOX=o.join(","),SA(n,i)}function OW(n,e,t,r,i,s,a){s=Object.assign({REQUEST:"GetMap"},s);const o=e/t,l=[Q_(tn(n)/o,Uc),Q_(Mr(n)/o,Uc)];if(t!=1)switch(a){case"geoserver":const h=90*t+.5|0;"FORMAT_OPTIONS"in s?s.FORMAT_OPTIONS+=";dpi:"+h:s.FORMAT_OPTIONS="dpi:"+h;break;case"mapserver":s.MAP_RESOLUTION=90*t;break;case"carmentaserver":case"qgis":s.DPI=90*t;break;default:throw new Error("Unknown `serverType` configured")}return LW(i,n,l,r,s)}function Pk(n,e){return Object.assign({REQUEST:e,SERVICE:"WMS",VERSION:dT,FORMAT:"image/png",STYLES:"",TRANSPARENT:"TRUE"},n)}const DW='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.';class FW extends pf{constructor(e){e=e||{};let t;e.attributions!==void 0?t=e.attributions:t=[DW];const r=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",i=e.url!==void 0?e.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:t,attributionsCollapsible:!1,cacheSize:e.cacheSize,crossOrigin:r,interpolate:e.interpolate,maxZoom:e.maxZoom!==void 0?e.maxZoom:19,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:(s,a)=>{const o=s.getImage();!Ks&&o instanceof HTMLImageElement&&(o.referrerPolicy="origin-when-cross-origin"),(e.tileLoadFunction||lD)(s,a)},transition:e.transition,url:i,wrapX:e.wrapX,zDirection:e.zDirection})}}const gx=1/0;class jW{constructor(e,t){this.priorityFunction_=e,this.keyFunction_=t,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,Op(this.queuedElements_)}dequeue(){const e=this.elements_,t=this.priorities_,r=e[0];e.length==1?(e.length=0,t.length=0):(e[0]=e.pop(),t[0]=t.pop(),this.siftUp_(0));const i=this.keyFunction_(r);return delete this.queuedElements_[i],r}enqueue(e){Cn(!(this.keyFunction_(e)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const t=this.priorityFunction_(e);return t!=gx?(this.elements_.push(e),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(e){return e*2+1}getRightChildIndex_(e){return e*2+2}getParentIndex_(e){return e-1>>1}heapify_(){let e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)}isEmpty(){return this.elements_.length===0}isKeyQueued(e){return e in this.queuedElements_}isQueued(e){return this.isKeyQueued(this.keyFunction_(e))}siftUp_(e){const t=this.elements_,r=this.priorities_,i=t.length,s=t[e],a=r[e],o=e;for(;e<i>>1;){const l=this.getLeftChildIndex_(e),u=this.getRightChildIndex_(e),h=u<i&&r[u]<r[l]?u:l;t[e]=t[h],r[e]=r[h],e=h}t[e]=s,r[e]=a,this.siftDown_(o,e)}siftDown_(e,t){const r=this.elements_,i=this.priorities_,s=r[t],a=i[t];for(;t>e;){const o=this.getParentIndex_(t);if(i[o]>a)r[t]=r[o],i[t]=i[o],t=o;else break}r[t]=s,i[t]=a}reprioritize(){const e=this.priorityFunction_,t=this.elements_,r=this.priorities_;let i=0;const s=t.length;let a,o,l;for(o=0;o<s;++o)a=t[o],l=e(a),l==gx?delete this.queuedElements_[this.keyFunction_(a)]:(r[i]=l,t[i++]=a);t.length=i,r.length=i,this.heapify_()}}class VW extends jW{constructor(e,t){super(r=>e.apply(null,r),r=>r[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=t,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(e){const t=super.enqueue(e);return t&&e[0].addEventListener(zt.CHANGE,this.boundHandleTileChange_),t}getTilesLoading(){return this.tilesLoading_}handleTileChange(e){const t=e.target,r=t.getState();if(r===kt.LOADED||r===kt.ERROR||r===kt.EMPTY){r!==kt.ERROR&&t.removeEventListener(zt.CHANGE,this.boundHandleTileChange_);const i=t.getKey();i in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[i],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(e,t){let r=0;for(;this.tilesLoading_<e&&r<t&&this.getCount()>0;){const i=this.dequeue()[0],s=i.getKey();i.getState()===kt.IDLE&&!(s in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++r,i.load())}}}function GW(n,e,t,r,i){if(!n||!(t in n.wantedTiles)||!n.wantedTiles[t][e.getKey()])return gx;const s=n.viewState.center,a=r[0]-s[0],o=r[1]-s[1];return 65536*Math.log(i)+Math.sqrt(a*a+o*o)/i}class BW extends oD{constructor(e){e=e||{};const t=Object.assign({},e.params);super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:e.tileClass,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0,this.params_=t,this.v13_=!0,this.serverType_=e.serverType,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.tmpExtent_=Zs(),this.updateV13_(),this.setKey(this.getKeyForParams_())}getFeatureInfoUrl(e,t,r,i){const s=Bn(r),a=this.getProjection()||s;let o=this.getTileGrid();o||(o=this.getTileGridForProjection(a));const l=Bp(e,s,a),u=dx(a,s,e,t),h=o.getZForResolution(u,this.zDirection),f=o.getResolution(h),g=o.getTileCoordForCoordAndZ(l,h);if(o.getResolutions().length<=g[0])return;let p=o.getTileCoordExtent(g,this.tmpExtent_);const E=this.gutter_;E!==0&&(p=zm(p,f*E,p));const x={QUERY_LAYERS:this.params_.LAYERS};Object.assign(x,Pk(this.params_,"GetFeatureInfo"),i);const w=Math.floor((l[0]-p[0])/f),T=Math.floor((p[3]-l[1])/f);return x[this.v13_?"I":"X"]=w,x[this.v13_?"J":"Y"]=T,this.getRequestUrl_(g,p,1,a||s,x)}getLegendUrl(e,t){if(this.urls[0]===void 0)return;const r={SERVICE:"WMS",VERSION:dT,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(t===void 0||t.LAYER===void 0){const i=this.params_.LAYERS;if(!(!Array.isArray(i)||i.length===1))return;r.LAYER=i}if(e!==void 0){const i=this.getProjection()?this.getProjection().getMetersPerUnit():1,s=28e-5;r.SCALE=e*i/s}return Object.assign(r,t),SA(this.urls[0],r)}getGutter(){return this.gutter_}getParams(){return this.params_}getRequestUrl_(e,t,r,i,s){const a=this.urls;if(!a)return;let o;if(a.length==1)o=a[0];else{const l=Yc(rD(e),a.length);o=a[l]}return OW(t,(this.tileGrid||this.getTileGridForProjection(i)).getResolution(e[0]),r,i,o,s,this.serverType_)}getTilePixelRatio(e){return!this.hidpi_||this.serverType_===void 0?1:e}getKeyForParams_(){let e=0;const t=[];for(const r in this.params_)t[e++]=r+"-"+this.params_[r];return t.join("/")}setParams_(e){this.params_=e,this.updateV13_(),this.setKey(this.getKeyForParams_())}setParams(e){this.setParams_(Object.assign({},e))}updateParams(e){this.setParams_(Object.assign(this.params_,e))}updateV13_(){const e=this.params_.VERSION||dT;this.v13_=KO(e,"1.3")>=0}tileUrlFunction(e,t,r){let i=this.getTileGrid();if(i||(i=this.getTileGridForProjection(r)),i.getResolutions().length<=e[0])return;t!=1&&(!this.hidpi_||this.serverType_===void 0)&&(t=1);const s=i.getResolution(e[0]);let a=i.getTileCoordExtent(e,this.tmpExtent_);const o=this.gutter_;o!==0&&(a=zm(a,s*o,a));const l=Object.assign({},Pk(this.params_,"GetMap"));return this.getRequestUrl_(e,a,t,r,l)}}class yf extends qo{constructor(e,t,r){super(e),this.map=t,this.frameState=r!==void 0?r:null}}class Rc extends yf{constructor(e,t,r,i,s,a){super(e,t,s),this.originalEvent=r,this.pixel_=null,this.coordinate_=null,this.dragging=i!==void 0?i:!1,this.activePointers=a}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(e){this.pixel_=e}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(e){this.coordinate_=e}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const fr={SINGLECLICK:"singleclick",CLICK:zt.CLICK,DBLCLICK:zt.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},fT={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown"};class UW extends Dp{constructor(e,t){super(e),this.map_=e,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=t===void 0?1:t,this.down_=null;const r=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=r,this.pointerdownListenerKey_=hn(r,fT.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=hn(r,fT.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(zt.TOUCHMOVE,this.boundHandleTouchMove_,m5?{passive:!1}:!1)}emulateClick_(e){let t=new Rc(fr.CLICK,this.map_,e);this.dispatchEvent(t),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,t=new Rc(fr.DBLCLICK,this.map_,e),this.dispatchEvent(t)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const r=new Rc(fr.SINGLECLICK,this.map_,e);this.dispatchEvent(r)},250)}updateActivePointers_(e){const t=e,r=t.pointerId;if(t.type==fr.POINTERUP||t.type==fr.POINTERCANCEL){delete this.trackedTouches_[r];for(const i in this.trackedTouches_)if(this.trackedTouches_[i].target!==t.target){delete this.trackedTouches_[i];break}}else(t.type==fr.POINTERDOWN||t.type==fr.POINTERMOVE)&&(this.trackedTouches_[r]=t);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(e){this.updateActivePointers_(e);const t=new Rc(fr.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(t),this.emulateClicks_&&!t.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(Wn),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(e){return e.button===0}handlePointerDown_(e){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(e);const t=new Rc(fr.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);if(this.dispatchEvent(t),this.down_=new PointerEvent(e.type,e),Object.defineProperty(this.down_,"target",{writable:!1,value:e.target}),this.dragListenerKeys_.length===0){const r=this.map_.getOwnerDocument();this.dragListenerKeys_.push(hn(r,fr.POINTERMOVE,this.handlePointerMove_,this),hn(r,fr.POINTERUP,this.handlePointerUp_,this),hn(this.element_,fr.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==r&&this.dragListenerKeys_.push(hn(this.element_.getRootNode(),fr.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;const t=new Rc(fr.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(t)}}relayMoveEvent_(e){this.originalPointerMoveEvent_=e;const t=!!(this.down_&&this.isMoving_(e));this.dispatchEvent(new Rc(fr.POINTERMOVE,this.map_,e,t))}handleTouchMove_(e){const t=this.originalPointerMoveEvent_;(!t||t.defaultPrevented)&&(typeof e.cancelable!="boolean"||e.cancelable===!0)&&e.preventDefault()}isMoving_(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(Wn(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(zt.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(Wn(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(Wn),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const Cc={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},Mi={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};class $v extends Zo{constructor(e){super();const t=e.element;t&&!e.target&&!t.style.pointerEvents&&(t.style.pointerEvents="auto"),this.element=t||null,this.target_=null,this.map_=null,this.listenerKeys=[],e.render&&(this.render=e.render),e.target&&this.setTarget(e.target)}disposeInternal(){this.element?.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(e){this.map_&&this.element?.remove();for(let t=0,r=this.listenerKeys.length;t<r;++t)Wn(this.listenerKeys[t]);if(this.listenerKeys.length=0,this.map_=e,e){const t=this.target_??e.getOverlayContainerStopEvent();this.element&&t.appendChild(this.element),this.render!==Um&&this.listenerKeys.push(hn(e,Cc.POSTRENDER,this.render,this)),e.render()}}render(e){}setTarget(e){this.target_=typeof e=="string"?document.getElementById(e):e}}class zW extends $v{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=e.collapsible!==void 0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=e.attributions;const t=e.className!==void 0?e.className:"ol-attribution",r=e.tipLabel!==void 0?e.tipLabel:"Attributions",i=e.expandClassName!==void 0?e.expandClassName:t+"-expand",s=e.collapseLabel!==void 0?e.collapseLabel:"",a=e.collapseClassName!==void 0?e.collapseClassName:t+"-collapse";typeof s=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=a):this.collapseLabel_=s;const o=e.label!==void 0?e.label:"i";typeof o=="string"?(this.label_=document.createElement("span"),this.label_.textContent=o,this.label_.className=i):this.label_=o;const l=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=r,this.toggleButton_.appendChild(l),this.toggleButton_.addEventListener(zt.CLICK,this.handleClick_.bind(this),!1);const u=t+" "+zp+" "+oA+(this.collapsed_&&this.collapsible_?" "+K4:"")+(this.collapsible_?"":" ol-uncollapsible"),h=this.element;h.className=u,h.appendChild(this.toggleButton_),h.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(e){const t=this.getMap().getAllLayers(),r=new Set(t.flatMap(i=>i.getAttributions(e)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(i=>r.add(i)):r.add(this.attributions_)),!this.overrideCollapsible_){const i=!t.some(s=>s.getSource()?.getAttributionsCollapsible()===!1);this.setCollapsible(i)}return Array.from(r)}async updateElement_(e){if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=await Promise.all(this.collectSourceAttributions_(e).map(i=>FO(()=>i))),r=t.length>0;if(this.renderedVisible_!=r&&(this.element.style.display=r?"":"none",this.renderedVisible_=r),!vu(t,this.renderedAttributions_)){DU(this.ulElement_);for(let i=0,s=t.length;i<s;++i){const a=document.createElement("li");a.innerHTML=t[i],this.ulElement_.appendChild(a)}this.renderedAttributions_=t}}handleClick_(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(K4),this.collapsed_?W4(this.collapseLabel_,this.label_):W4(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(e){this.userCollapsed_=e,!(!this.collapsible_||this.collapsed_===e)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(e){this.updateElement_(e.frameState)}}class $W extends $v{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target});const t=e.className!==void 0?e.className:"ol-rotate",r=e.label!==void 0?e.label:"",i=e.compassClassName!==void 0?e.compassClassName:"ol-compass";this.label_=null,typeof r=="string"?(this.label_=document.createElement("span"),this.label_.className=i,this.label_.textContent=r):(this.label_=r,this.label_.classList.add(i));const s=e.tipLabel?e.tipLabel:"Reset rotation",a=document.createElement("button");a.className=t+"-reset",a.setAttribute("type","button"),a.title=s,a.appendChild(this.label_),a.addEventListener(zt.CLICK,this.handleClick_.bind(this),!1);const o=t+" "+zp+" "+oA,l=this.element;l.className=o,l.appendChild(a),this.callResetNorth_=e.resetNorth?e.resetNorth:void 0,this.duration_=e.duration!==void 0?e.duration:250,this.autoHide_=e.autoHide!==void 0?e.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(Gy)}handleClick_(e){e.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const r=t.getRotation();r!==void 0&&(this.duration_>0&&r%(2*Math.PI)!==0?t.animate({rotation:0,duration:this.duration_,easing:k0}):t.setRotation(0))}render(e){const t=e.frameState;if(!t)return;const r=t.viewState.rotation;if(r!=this.rotation_){const i="rotate("+r+"rad)";if(this.autoHide_){const s=this.element.classList.contains(Gy);!s&&r===0?this.element.classList.add(Gy):s&&r!==0&&this.element.classList.remove(Gy)}this.label_.style.transform=i}this.rotation_=r}}class WW extends $v{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target});const t=e.className!==void 0?e.className:"ol-zoom",r=e.delta!==void 0?e.delta:1,i=e.zoomInClassName!==void 0?e.zoomInClassName:t+"-in",s=e.zoomOutClassName!==void 0?e.zoomOutClassName:t+"-out",a=e.zoomInLabel!==void 0?e.zoomInLabel:"+",o=e.zoomOutLabel!==void 0?e.zoomOutLabel:"",l=e.zoomInTipLabel!==void 0?e.zoomInTipLabel:"Zoom in",u=e.zoomOutTipLabel!==void 0?e.zoomOutTipLabel:"Zoom out",h=document.createElement("button");h.className=i,h.setAttribute("type","button"),h.title=l,h.appendChild(typeof a=="string"?document.createTextNode(a):a),h.addEventListener(zt.CLICK,this.handleClick_.bind(this,r),!1);const f=document.createElement("button");f.className=s,f.setAttribute("type","button"),f.title=u,f.appendChild(typeof o=="string"?document.createTextNode(o):o),f.addEventListener(zt.CLICK,this.handleClick_.bind(this,-r),!1);const g=t+" "+zp+" "+oA,p=this.element;p.className=g,p.appendChild(h),p.appendChild(f),this.duration_=e.duration!==void 0?e.duration:250}handleClick_(e,t){t.preventDefault(),this.zoomByDelta_(e)}zoomByDelta_(e){const r=this.getMap().getView();if(!r)return;const i=r.getZoom();if(i!==void 0){const s=r.getConstrainedZoom(i+e);this.duration_>0?(r.getAnimating()&&r.cancelAnimations(),r.animate({zoom:s,duration:this.duration_,easing:k0})):r.setZoom(s)}}}function HW(n){n=n||{};const e=new ya;return(n.zoom===void 0||n.zoom)&&e.push(new WW(n.zoomOptions)),(n.rotate===void 0||n.rotate)&&e.push(new $W(n.rotateOptions)),(n.attribution===void 0||n.attribution)&&e.push(new zW(n.attributionOptions)),e}class KW{constructor(e,t,r){this.decay_=e,this.minVelocity_=t,this.delay_=r,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(e,t){this.points_.push(e,t,Date.now())}end(){if(this.points_.length<6)return!1;const e=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[t+2]<e)return!1;let r=t-3;for(;r>0&&this.points_[r+2]>e;)r-=3;const i=this.points_[t+2]-this.points_[r+2];if(i<1e3/60)return!1;const s=this.points_[t]-this.points_[r],a=this.points_[t+1]-this.points_[r+1];return this.angle_=Math.atan2(a,s),this.initialVelocity_=Math.sqrt(s*s+a*a)/i,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}const kk={ACTIVE:"active"};class qp extends Zo{constructor(e){super(),this.on,this.once,this.un,e&&e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(kk.ACTIVE)}getMap(){return this.map_}handleEvent(e){return!0}setActive(e){this.set(kk.ACTIVE,e)}setMap(e){this.map_=e}}function YW(n,e,t){const r=n.getCenterInternal();if(r){const i=[r[0]+e[0],r[1]+e[1]];n.animateInternal({duration:t!==void 0?t:250,easing:j$,center:n.getConstrainedCenter(i)})}}function IA(n,e,t,r){const i=n.getZoom();if(i===void 0)return;const s=n.getConstrainedZoom(i+e),a=n.getResolutionForZoom(s);n.getAnimating()&&n.cancelAnimations(),n.animate({resolution:a,anchor:t,duration:r!==void 0?r:250,easing:k0})}class XW extends qp{constructor(e){super(),e=e||{},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:250}handleEvent(e){let t=!1;if(e.type==fr.DBLCLICK){const r=e.originalEvent,i=e.map,s=e.coordinate,a=r.shiftKey?-this.delta_:this.delta_,o=i.getView();IA(o,a,s,this.duration_),r.preventDefault(),t=!0}return!t}}function gT(n){const e=arguments;return function(t){let r=!0;for(let i=0,s=e.length;i<s&&(r=r&&e[i](t),!!r);++i);return r}}const qW=function(n){const e=n.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},ZW=function(n){const e=n.map.getTargetElement(),t=e.getRootNode(),r=n.map.getOwnerDocument().activeElement;return t instanceof ShadowRoot?t.host.contains(r):e.contains(r)},uD=function(n){const e=n.map.getTargetElement(),t=e.getRootNode();return(t instanceof ShadowRoot?t.host:e).hasAttribute("tabindex")?ZW(n):!0},QW=Bm,hD=function(n){const e=n.originalEvent;return"pointerId"in e&&e.button==0&&!(LU&&f5&&e.ctrlKey)},dD=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},JW=function(n){const e=n.originalEvent;return f5?e.metaKey:e.ctrlKey},eH=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},fD=function(n){const e=n.originalEvent,t=e.target.tagName;return t!=="INPUT"&&t!=="SELECT"&&t!=="TEXTAREA"&&!e.target.isContentEditable},$2=function(n){const e=n.originalEvent;return"pointerId"in e&&e.pointerType=="mouse"},tH=function(n){const e=n.originalEvent;return"pointerId"in e&&e.isPrimary&&e.button===0};class Zp extends qp{constructor(e){e=e||{},super(e),e.handleDownEvent&&(this.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(this.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(this.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(this.handleUpEvent=e.handleUpEvent),e.stopDown&&(this.stopDown=e.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(e){return!1}handleDragEvent(e){}handleEvent(e){if(!e.originalEvent)return!0;let t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==fr.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==fr.POINTERUP){const r=this.handleUpEvent(e);this.handlingDownUpSequence=r&&this.targetPointers.length>0}}else if(e.type==fr.POINTERDOWN){const r=this.handleDownEvent(e);this.handlingDownUpSequence=r,t=this.stopDown(r)}else e.type==fr.POINTERMOVE&&this.handleMoveEvent(e);return!t}handleMoveEvent(e){}handleUpEvent(e){return!1}stopDown(e){return e}updateTrackedPointers_(e){e.activePointers&&(this.targetPointers=e.activePointers)}}function AA(n){const e=n.length;let t=0,r=0;for(let i=0;i<e;i++)t+=n[i].clientX,r+=n[i].clientY;return{clientX:t/e,clientY:r/e}}class nH extends Zp{constructor(e){super({stopDown:Rv}),e=e||{},this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const t=e.condition?e.condition:gT(dD,tH);this.condition_=e.onFocusOnly?gT(uD,t):t,this.noKinetic_=!1}handleDragEvent(e){const t=e.map;this.panning_||(this.panning_=!0,t.getView().beginInteraction());const r=this.targetPointers,i=t.getEventPixel(AA(r));if(r.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(i[0],i[1]),this.lastCentroid){const s=[this.lastCentroid[0]-i[0],i[1]-this.lastCentroid[1]],o=e.map.getView();VB(s,o.getResolution()),$I(s,o.getRotation()),o.adjustCenterInternal(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=i,this.lastPointersCount_=r.length,e.originalEvent.preventDefault()}handleUpEvent(e){const t=e.map,r=t.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const i=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),a=r.getCenterInternal(),o=t.getPixelFromCoordinateInternal(a),l=t.getCoordinateFromPixelInternal([o[0]-i*Math.cos(s),o[1]-i*Math.sin(s)]);r.animateInternal({center:r.getConstrainedCenter(l),duration:500,easing:k0})}return this.panning_&&(this.panning_=!1,r.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(e){if(this.targetPointers.length>0&&this.condition_(e)){const r=e.map.getView();return this.lastCentroid=null,r.getAnimating()&&r.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class rH extends Zp{constructor(e){e=e||{},super({stopDown:Rv}),this.condition_=e.condition?e.condition:qW,this.lastAngle_=void 0,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){if(!$2(e))return;const t=e.map,r=t.getView();if(r.getConstraints().rotation===yA)return;const i=t.getSize(),s=e.pixel,a=Math.atan2(i[1]/2-s[1],s[0]-i[0]/2);if(this.lastAngle_!==void 0){const o=a-this.lastAngle_;r.adjustRotationInternal(-o)}this.lastAngle_=a}handleUpEvent(e){return $2(e)?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){return $2(e)&&hD(e)&&this.condition_(e)?(e.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class iH extends Av{constructor(e){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const e=this.startPixel_,t=this.endPixel_,r="px",i=this.element_.style;i.left=Math.min(e[0],t[0])+r,i.top=Math.min(e[1],t[1])+r,i.width=Math.abs(t[0]-e[0])+r,i.height=Math.abs(t[1]-e[1])+r}setMap(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(e,t){this.startPixel_=e,this.endPixel_=t,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const e=this.startPixel_,t=this.endPixel_,i=[e,[e[0],t[1]],t,[t[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);i[4]=i[0].slice(),this.geometry_?this.geometry_.setCoordinates([i]):this.geometry_=new no([i])}getGeometry(){return this.geometry_}}const tf={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class Dg extends qo{constructor(e,t,r){super(e),this.coordinate=t,this.mapBrowserEvent=r}}class sH extends Zp{constructor(e){super(),this.on,this.once,this.un,e=e??{},this.box_=new iH(e.className||"ol-dragbox"),this.minArea_=e.minArea??64,e.onBoxEnd&&(this.onBoxEnd=e.onBoxEnd),this.startPixel_=null,this.condition_=e.condition??hD,this.boxEndCondition_=e.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(e,t,r){const i=r[0]-t[0],s=r[1]-t[1];return i*i+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(e){this.startPixel_&&(this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new Dg(tf.BOXDRAG,e.coordinate,e)))}handleUpEvent(e){if(!this.startPixel_)return!1;const t=this.boxEndCondition_(e,this.startPixel_,e.pixel);return t&&this.onBoxEnd(e),this.dispatchEvent(new Dg(t?tf.BOXEND:tf.BOXCANCEL,e.coordinate,e)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(e){return this.condition_(e)?(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new Dg(tf.BOXSTART,e.coordinate,e)),!0):!1}onBoxEnd(e){}setActive(e){e||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Dg(tf.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(e)}setMap(e){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Dg(tf.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(e)}}class aH extends sH{constructor(e){e=e||{};const t=e.condition?e.condition:eH;super({condition:t,className:e.className||"ol-dragzoom",minArea:e.minArea}),this.duration_=e.duration!==void 0?e.duration:200,this.out_=e.out!==void 0?e.out:!1}onBoxEnd(e){const r=this.getMap().getView();let i=this.getGeometry();if(this.out_){const s=r.rotatedExtentForGeometry(i),a=r.getResolutionForExtentInternal(s),o=r.getResolution()/a;i=i.clone(),i.scale(o*o)}r.fitInternal(i,{duration:this.duration_,easing:k0})}}const Xu={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class oH extends qp{constructor(e){super(),e=e||{},this.defaultCondition_=function(t){return dD(t)&&fD(t)},this.condition_=e.condition!==void 0?e.condition:this.defaultCondition_,this.duration_=e.duration!==void 0?e.duration:100,this.pixelDelta_=e.pixelDelta!==void 0?e.pixelDelta:128}handleEvent(e){let t=!1;if(e.type==zt.KEYDOWN){const r=e.originalEvent,i=r.key;if(this.condition_(e)&&(i==Xu.DOWN||i==Xu.LEFT||i==Xu.RIGHT||i==Xu.UP)){const a=e.map.getView(),o=a.getResolution()*this.pixelDelta_;let l=0,u=0;i==Xu.DOWN?u=-o:i==Xu.LEFT?l=-o:i==Xu.RIGHT?l=o:u=o;const h=[l,u];$I(h,a.getRotation()),YW(a,h,this.duration_),r.preventDefault(),t=!0}}return!t}}class lH extends qp{constructor(e){super(),e=e||{},this.condition_=e.condition?e.condition:function(t){return!JW(t)&&fD(t)},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:100}handleEvent(e){let t=!1;if(e.type==zt.KEYDOWN||e.type==zt.KEYPRESS){const r=e.originalEvent,i=r.key;if(this.condition_(e)&&(i==="+"||i==="-")){const s=e.map,a=i==="+"?this.delta_:-this.delta_,o=s.getView();IA(o,a,void 0,this.duration_),r.preventDefault(),t=!0}}return!t}}const cH=40,uH=300;class hH extends qp{constructor(e){e=e||{},super(e),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=e.maxDelta!==void 0?e.maxDelta:1,this.duration_=e.duration!==void 0?e.duration:250,this.timeout_=e.timeout!==void 0?e.timeout:80,this.useAnchor_=e.useAnchor!==void 0?e.useAnchor:!0,this.constrainResolution_=e.constrainResolution!==void 0?e.constrainResolution:!1;const t=e.condition?e.condition:QW;this.condition_=e.onFocusOnly?gT(uD,t):t,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const e=this.getMap();if(!e)return;e.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(e){if(!this.condition_(e)||e.type!==zt.WHEEL)return!0;const r=e.map,i=e.originalEvent;i.preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.pixel);let s=i.deltaY;switch(i.deltaMode){case WheelEvent.DOM_DELTA_LINE:s*=cH;break;case WheelEvent.DOM_DELTA_PAGE:s*=uH;break}if(s===0)return!1;this.lastDelta_=s;const a=Date.now();this.startTime_===void 0&&(this.startTime_=a),(!this.mode_||a-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?"trackpad":"wheel");const o=r.getView();if(this.mode_==="trackpad"&&!(o.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(o.getAnimating()&&o.cancelAnimations(),o.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),o.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_?r.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=a,!1;this.totalDelta_+=s;const l=Math.max(this.timeout_-(a-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,r),l),!1}handleWheelZoom_(e){const t=e.getView();t.getAnimating()&&t.cancelAnimations();let r=-Yn(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(t.getConstrainResolution()||this.constrainResolution_)&&(r=r?r>0?1:-1:0),IA(t,r,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(e){this.useAnchor_=e,e||(this.lastAnchor_=null)}}class dH extends Zp{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=Rv),super(t),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=e.threshold!==void 0?e.threshold:.3,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){let t=0;const r=this.targetPointers[0],i=this.targetPointers[1],s=Math.atan2(i.clientY-r.clientY,i.clientX-r.clientX);if(this.lastAngle_!==void 0){const l=s-this.lastAngle_;this.rotationDelta_+=l,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),t=l}this.lastAngle_=s;const a=e.map,o=a.getView();o.getConstraints().rotation!==yA&&(this.anchor_=a.getCoordinateFromPixelInternal(a.getEventPixel(AA(this.targetPointers))),this.rotating_&&(a.render(),o.adjustRotationInternal(t,this.anchor_)))}handleUpEvent(e){return this.targetPointers.length<2?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}class fH extends Zp{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=Rv),super(t),this.anchor_=null,this.duration_=e.duration!==void 0?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(e){let t=1;const r=this.targetPointers[0],i=this.targetPointers[1],s=r.clientX-i.clientX,a=r.clientY-i.clientY,o=Math.sqrt(s*s+a*a);this.lastDistance_!==void 0&&(t=this.lastDistance_/o),this.lastDistance_=o;const l=e.map,u=l.getView();t!=1&&(this.lastScaleDelta_=t),this.anchor_=l.getCoordinateFromPixelInternal(l.getEventPixel(AA(this.targetPointers))),l.render(),u.adjustResolutionInternal(t,this.anchor_)}handleUpEvent(e){if(this.targetPointers.length<2){const r=e.map.getView(),i=this.lastScaleDelta_>1?1:-1;return r.endInteraction(this.duration_,i),!1}return!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}function gH(n){n=n||{};const e=new ya,t=new KW(-.005,.05,100);return(n.altShiftDragRotate===void 0||n.altShiftDragRotate)&&e.push(new rH),(n.doubleClickZoom===void 0||n.doubleClickZoom)&&e.push(new XW({delta:n.zoomDelta,duration:n.zoomDuration})),(n.dragPan===void 0||n.dragPan)&&e.push(new nH({onFocusOnly:n.onFocusOnly,kinetic:t})),(n.pinchRotate===void 0||n.pinchRotate)&&e.push(new dH),(n.pinchZoom===void 0||n.pinchZoom)&&e.push(new fH({duration:n.zoomDuration})),(n.keyboard===void 0||n.keyboard)&&(e.push(new oH),e.push(new lH({delta:n.zoomDelta,duration:n.zoomDuration}))),(n.mouseWheelZoom===void 0||n.mouseWheelZoom)&&e.push(new hH({onFocusOnly:n.onFocusOnly,duration:n.zoomDuration})),(n.shiftDragZoom===void 0||n.shiftDragZoom)&&e.push(new aH({duration:n.zoomDuration})),e}class mH extends Av{constructor(e){super(),this.map_=e}dispatchRenderEvent(e,t){Ft()}calculateMatrices2D(e){const t=e.viewState,r=e.coordinateToPixelTransform,i=e.pixelToCoordinateTransform;Uo(r,e.size[0]/2,e.size[1]/2,1/t.resolution,-1/t.resolution,-t.rotation,-t.center[0],-t.center[1]),i5(i,r)}forEachFeatureAtCoordinate(e,t,r,i,s,a,o,l){let u;const h=t.viewState;function f(N,D,B,k){return s.call(a,D,N?B:null,k)}const g=h.projection,p=YO(e.slice(),g),E=[[0,0]];if(g.canWrapX()&&i){const N=g.getExtent(),D=tn(N);E.push([-D,0],[D,0])}const x=t.layerStatesArray,w=x.length,T=[],I=[];for(let N=0;N<E.length;N++)for(let D=w-1;D>=0;--D){const B=x[D],k=B.layer;if(k.hasRenderer()&&xA(B,h)&&o.call(l,k)){const C=k.getRenderer(),M=k.getSource();if(C&&M){const j=M.getWrapX()?p:e,O=f.bind(null,B.managed);I[0]=j[0]+E[N][0],I[1]=j[1]+E[N][1],u=C.forEachFeatureAtCoordinate(I,t,r,O,T)}if(u)return u}}if(T.length===0)return;const P=1/T.length;return T.forEach((N,D)=>N.distanceSq+=D*P),T.sort((N,D)=>N.distanceSq-D.distanceSq),T.some(N=>u=N.callback(N.feature,N.layer,N.geometry)),u}hasFeatureAtCoordinate(e,t,r,i,s,a){return this.forEachFeatureAtCoordinate(e,t,r,i,Bm,this,s,a)!==void 0}getMap(){return this.map_}renderFrame(e){Ft()}scheduleExpireIconCache(e){xa.canExpireCache()&&e.postRenderFunctions.push(pH)}}function pH(n,e){xa.expire()}class yH extends mH{constructor(e){super(e),this.fontChangeListenerKey_=hn(ff,t0.PROPERTYCHANGE,e.redrawText,e),this.element_=Ks?p5():document.createElement("div");const t=this.element_.style;t.position="absolute",t.width="100%",t.height="100%",t.zIndex="0",this.element_.className=zp+" ol-layers";const r=e.getViewport();r&&r.insertBefore(this.element_,r.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(e,t){const r=this.getMap();if(r.hasListener(e)){const i=new G5(e,void 0,t);r.dispatchEvent(i)}}disposeInternal(){Wn(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(e){if(!e){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(e),this.dispatchRenderEvent(_a.PRECOMPOSE,e);const t=e.layerStatesArray.sort((u,h)=>u.zIndex-h.zIndex);t.some(u=>u.layer instanceof q5&&u.layer.getDeclutter())&&(e.declutter={});const i=e.viewState;this.children_.length=0;const s=[];let a=null;for(let u=0,h=t.length;u<h;++u){const f=t[u];e.layerIndex=u;const g=f.layer,p=g.getSourceState();if(!xA(f,i)||p!="ready"&&p!="undefined"){g.unrender();continue}const E=g.render(e,a);E&&(E!==a&&(this.children_.push(E),a=E),s.push(f))}this.declutter(e,s),FU(this.element_,this.children_);const l=this.getMap().getTargetElement();if(Gc(l)){const u=l.getContext("2d");for(const h of this.children_){const f=h.firstElementChild||h,g=h.style.backgroundColor;if(g&&(!Gc(f)||f.width>0)&&(u.fillStyle=g,u.fillRect(0,0,l.width,l.height)),Gc(f)&&f.width>0){const p=h.style.opacity||f.style.opacity;u.globalAlpha=p===""?1:Number(p);const E=f.style.transform;if(E)u.setTransform(...tT(E));else{const x=parseFloat(f.style.width)/f.width,w=parseFloat(f.style.height)/f.height;u.setTransform(x,0,0,w,0,0)}u.drawImage(f,0,0)}}u.globalAlpha=1,u.setTransform(1,0,0,1,0,0)}this.dispatchRenderEvent(_a.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}declutter(e,t){if(e.declutter){for(let r=t.length-1;r>=0;--r){const i=t[r],s=i.layer;s.getDeclutter()&&s.renderDeclutter(e,i)}t.forEach(r=>r.layer.renderDeferred(e))}}}function gD(n){if(n instanceof Yp){n.setMapInternal(null);return}n instanceof zv&&n.getLayers().forEach(gD)}function mD(n,e){if(n instanceof Yp){n.setMapInternal(e);return}if(n instanceof zv){const t=n.getLayers().getArray();for(let r=0,i=t.length;r<i;++r)mD(t[r],e)}}let _H=class extends Zo{constructor(e){super(),e=e||{},this.on,this.once,this.un;const t=xH(e);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=e.maxTilesLoading!==void 0?e.maxTilesLoading:16,this.pixelRatio_=e.pixelRatio!==void 0?e.pixelRatio:OU,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=Xa(),this.pixelToCoordinateTransform_=Xa(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,Ks||(this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_)),this.mapBrowserEventHandler_=null,this.moveTolerance_=e.moveTolerance,this.keyboardEventTarget_=t.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,Ks||(this.resizeObserver_=new ResizeObserver(()=>this.updateSize())),this.controls=t.controls||(Ks?new ya:HW()),this.interactions=t.interactions||(Ks?new ya:gH({onFocusOnly:!0})),this.overlays_=t.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new VW(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(Mi.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(Mi.VIEW,this.handleViewChanged_),this.addChangeListener(Mi.SIZE,this.handleSizeChanged_),this.addChangeListener(Mi.TARGET,this.handleTargetChanged_),this.setProperties(t.values);const r=this;e.view&&!(e.view instanceof Ro)&&e.view.then(function(i){r.setView(new Ro(i))}),this.controls.addEventListener(fs.ADD,i=>{i.element.setMap(this)}),this.controls.addEventListener(fs.REMOVE,i=>{i.element.setMap(null)}),this.interactions.addEventListener(fs.ADD,i=>{i.element.setMap(this)}),this.interactions.addEventListener(fs.REMOVE,i=>{i.element.setMap(null)}),this.overlays_.addEventListener(fs.ADD,i=>{this.addOverlayInternal_(i.element)}),this.overlays_.addEventListener(fs.REMOVE,i=>{const s=i.element.getId();s!==void 0&&delete this.overlayIdIndex_[s.toString()],i.element.setMap(null)}),this.controls.forEach(i=>{i.setMap(this)}),this.interactions.forEach(i=>{i.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(e){this.getControls().push(e)}addInteraction(e){this.getInteractions().push(e)}addLayer(e){this.getLayerGroup().getLayers().push(e)}handleLayerAdd_(e){mD(e.layer,this)}addOverlay(e){this.getOverlays().push(e)}addOverlayInternal_(e){const t=e.getId();t!==void 0&&(this.overlayIdIndex_[t.toString()]=e),e.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_?.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(e,t,r){if(!this.frameState_||!this.renderer_)return;const i=this.getCoordinateFromPixelInternal(e);r=r!==void 0?r:{};const s=r.hitTolerance!==void 0?r.hitTolerance:0,a=r.layerFilter!==void 0?r.layerFilter:Bm,o=r.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(i,this.frameState_,s,o,t,null,a,null)}getFeaturesAtPixel(e,t){const r=[];return this.forEachFeatureAtPixel(e,function(i){r.push(i)},t),r}getAllLayers(){const e=[];function t(r){r.forEach(function(i){i instanceof zv?t(i.getLayers()):e.push(i)})}return t(this.getLayers()),e}hasFeatureAtPixel(e,t){if(!this.frameState_||!this.renderer_)return!1;const r=this.getCoordinateFromPixelInternal(e);t=t!==void 0?t:{};const i=t.layerFilter!==void 0?t.layerFilter:Bm,s=t.hitTolerance!==void 0?t.hitTolerance:0,a=t.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(r,this.frameState_,s,a,i,null)}getEventCoordinate(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}getEventCoordinateInternal(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}getEventPixel(e){const r=this.viewport_.getBoundingClientRect(),i=this.getSize(),s=r.width/i[0],a=r.height/i[1],o="changedTouches"in e?e.changedTouches[0]:e;return[(o.clientX-r.left)/s,(o.clientY-r.top)/a]}getTarget(){return this.get(Mi.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(e){return eT(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}getCoordinateFromPixelInternal(e){const t=this.frameState_;return t?Wr(t.pixelToCoordinateTransform,e.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(e){const t=this.overlayIdIndex_[e.toString()];return t!==void 0?t:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(Mi.LAYERGROUP)}setLayers(e){const t=this.getLayerGroup();if(e instanceof ya){t.setLayers(e);return}const r=t.getLayers();r.clear(),r.extend(e)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const e=this.getLayerGroup().getLayerStatesArray();for(let t=0,r=e.length;t<r;++t){const i=e[t];if(!i.visible)continue;const s=i.layer.getRenderer();if(s&&!s.ready)return!0;const a=i.layer.getSource();if(a&&a.loading)return!0}return!1}getPixelFromCoordinate(e){const t=yl(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(t)}getPixelFromCoordinateInternal(e){const t=this.frameState_;return t?Wr(t.coordinateToPixelTransform,e.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(Mi.SIZE)}getView(){return this.get(Mi.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const e=this.getTargetElement();return e?e.ownerDocument:document}getTilePriority(e,t,r,i){return GW(this.frameState_,e,t,r,i)}handleBrowserEvent(e,t){t=t||e.type;const r=new Rc(t,this,e);this.handleMapBrowserEvent(r)}handleMapBrowserEvent(e){if(!this.frameState_)return;const t=e.originalEvent,r=t.type;if(r===fT.POINTERDOWN||r===zt.WHEEL||r===zt.KEYDOWN){const i=this.getOwnerDocument(),s=this.viewport_.getRootNode?this.viewport_.getRootNode():i,a=t.target,o=s instanceof ShadowRoot?s.host===a?s.host.ownerDocument:s:s===i?i.documentElement:s;if(this.overlayContainerStopEvent_.contains(a)||!o.contains(a))return}if(e.frameState=this.frameState_,this.dispatchEvent(e)!==!1){const i=this.getInteractions().getArray().slice();for(let s=i.length-1;s>=0;s--){const a=i[s];if(a.getMap()!==this||!a.getActive()||!this.getTargetElement())continue;if(!a.handleEvent(e)||e.propagationStopped)break}}}handlePostRender(){const e=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){let i=this.maxTilesLoading_,s=i;if(e){const a=e.viewHints;if(a[ni.ANIMATING]||a[ni.INTERACTING]){const o=Date.now()-e.time>8;i=o?0:8,s=o?0:2}}t.getTilesLoading()<i&&(t.reprioritize(),t.loadMoreTiles(i,s))}e&&this.renderer_&&!e.animate&&(this.renderComplete_?(this.hasListener(_a.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(_a.RENDERCOMPLETE,e),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new yf(Cc.LOADEND,this,e)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new yf(Cc.LOADSTART,this,e))));const r=this.postRenderFunctions_;if(e)for(let i=0,s=r.length;i<s;++i)r[i](this,e);r.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let r=0,i=this.targetChangeHandlerKeys_.length;r<i;++r)Wn(this.targetChangeHandlerKeys_[r]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(zt.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(zt.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_&&!Gc(this.targetElement_)){this.resizeObserver_?.unobserve(this.targetElement_);const r=this.targetElement_.getRootNode();r instanceof ShadowRoot&&this.resizeObserver_.unobserve(r.host),this.setSize(void 0)}const e=this.getTarget(),t=typeof e=="string"?document.getElementById(e):e;if(this.targetElement_=t,!t)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{if(Gc(t)||t.appendChild(this.viewport_),this.renderer_||(this.renderer_=new yH(this)),!Gc(t)){this.mapBrowserEventHandler_=new UW(this,this.moveTolerance_);for(const i in fr)this.mapBrowserEventHandler_.addEventListener(fr[i],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(zt.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(zt.WHEEL,this.boundHandleBrowserEvent_,m5?{passive:!1}:!1);let r;if(this.keyboardEventTarget_)r=this.keyboardEventTarget_;else{const i=t.getRootNode();r=i instanceof ShadowRoot?i.host:t}if(this.targetChangeHandlerKeys_=[hn(r,zt.KEYDOWN,this.handleBrowserEvent,this),hn(r,zt.KEYPRESS,this.handleBrowserEvent,this)],t instanceof HTMLElement){const i=t.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.observe(i.host),this.resizeObserver_?.observe(t)}}this.updateSize()}}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(Wn(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(Wn(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const e=this.getView();e&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=hn(e,t0.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=hn(e,zt.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(Wn),this.layerGroupPropertyListenerKeys_=null);const e=this.getLayerGroup();e&&(this.handleLayerAdd_(new kc("addlayer",e)),this.layerGroupPropertyListenerKeys_=[hn(e,t0.PROPERTYCHANGE,this.render,this),hn(e,zt.CHANGE,this.render,this),hn(e,"addlayer",this.handleLayerAdd_,this),hn(e,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;const e=this.frameState_.layerStatesArray;for(let t=0,r=e.length;t<r;++t){const i=e[t].layer;i.hasRenderer()&&i.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(e){return this.getControls().remove(e)}removeInteraction(e){return this.getInteractions().remove(e)}removeLayer(e){return this.getLayerGroup().getLayers().remove(e)}handleLayerRemove_(e){gD(e.layer)}removeOverlay(e){return this.getOverlays().remove(e)}renderFrame_(e){const t=this.getSize(),r=this.getView(),i=this.frameState_;let s=null;if(t!==void 0&&sk(t)&&r&&r.isDef()){const a=r.getHints(this.frameState_?this.frameState_.viewHints:void 0),o=r.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:Z_(o.center,o.resolution,o.rotation,t),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:t,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:o,viewHints:a,wantedTiles:{},mapId:_n(this),renderTargets:{}},o.nextCenter&&o.nextResolution){const l=isNaN(o.nextRotation)?o.rotation:o.nextRotation;s.nextExtent=Z_(o.nextCenter,o.nextResolution,l,t)}}this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),i&&(!this.previousExtent_||!C0(this.previousExtent_)&&!n0(s.extent,this.previousExtent_))&&(this.dispatchEvent(new yf(Cc.MOVESTART,this,i)),this.previousExtent_=jp(this.previousExtent_)),this.previousExtent_&&!s.viewHints[ni.ANIMATING]&&!s.viewHints[ni.INTERACTING]&&!n0(s.extent,this.previousExtent_)&&(this.dispatchEvent(new yf(Cc.MOVEEND,this,s)),VO(s.extent,this.previousExtent_))),this.dispatchEvent(new yf(Cc.POSTRENDER,this,s)),this.renderComplete_=(this.hasListener(Cc.LOADSTART)||this.hasListener(Cc.LOADEND)||this.hasListener(_a.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(e){const t=this.getLayerGroup();t&&this.handleLayerRemove_(new kc("removelayer",t)),this.set(Mi.LAYERGROUP,e)}setSize(e){this.set(Mi.SIZE,e)}setTarget(e){this.set(Mi.TARGET,e)}setView(e){if(!e||e instanceof Ro){this.set(Mi.VIEW,e);return}this.set(Mi.VIEW,new Ro);const t=this;e.then(function(r){t.setView(new Ro(r))})}updateSize(){const e=this.getTargetElement();let t;if(e){let i,s;if(Gc(e))i=e.width,s=e.height;else{const a=getComputedStyle(e);i=e.offsetWidth-parseFloat(a.borderLeftWidth)-parseFloat(a.paddingLeft)-parseFloat(a.paddingRight)-parseFloat(a.borderRightWidth),s=e.offsetHeight-parseFloat(a.borderTopWidth)-parseFloat(a.paddingTop)-parseFloat(a.paddingBottom)-parseFloat(a.borderBottomWidth)}!isNaN(i)&&!isNaN(s)&&(t=[Math.max(0,i),Math.max(0,s)],!sk(t)&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&qO("No map visible because the map container's width or height are 0."))}const r=this.getSize();t&&(!r||!vu(t,r))&&(this.setSize(t),this.updateViewportSize_(t))}updateViewportSize_(e){const t=this.getView();t&&t.setViewportSize(e)}};function xH(n){let e=null;n.keyboardEventTarget!==void 0&&(e=typeof n.keyboardEventTarget=="string"?document.getElementById(n.keyboardEventTarget):n.keyboardEventTarget);const t={},r=n.layers&&typeof n.layers.getLayers=="function"?n.layers:new zv({layers:n.layers});t[Mi.LAYERGROUP]=r,t[Mi.TARGET]=n.target,t[Mi.VIEW]=n.view instanceof Ro?n.view:new Ro;let i;n.controls!==void 0&&(Array.isArray(n.controls)?i=new ya(n.controls.slice()):(Cn(typeof n.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),i=n.controls));let s;n.interactions!==void 0&&(Array.isArray(n.interactions)?s=new ya(n.interactions.slice()):(Cn(typeof n.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),s=n.interactions));let a;return n.overlays!==void 0?Array.isArray(n.overlays)?a=new ya(n.overlays.slice()):(Cn(typeof n.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),a=n.overlays):a=new ya,{controls:i,interactions:s,keyboardEventTarget:e,overlays:a,values:t}}const W2="units",vH=[1,2,5],Fg=25.4/.28;class EH extends $v{constructor(e){e=e||{};const t=document.createElement("div");t.style.pointerEvents="none",super({element:t,render:e.render,target:e.target}),this.on,this.once,this.un;const r=e.className!==void 0?e.className:e.bar?"ol-scale-bar":"ol-scale-line";this.innerElement_=document.createElement("div"),this.innerElement_.className=r+"-inner",this.element.className=r+" "+zp,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=e.minWidth!==void 0?e.minWidth:64,this.maxWidth_=e.maxWidth,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",this.addChangeListener(W2,this.handleUnitsChanged_),this.setUnits(e.units||"metric"),this.scaleBar_=e.bar||!1,this.scaleBarSteps_=e.steps||4,this.scaleBarText_=e.text||!1,this.dpi_=e.dpi||void 0}getUnits(){return this.get(W2)}handleUnitsChanged_(){this.updateElement_()}setUnits(e){this.set(W2,e)}setDpi(e){this.dpi_=e}updateElement_(){const e=this.viewState_;if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=e.center,r=e.projection,i=this.getUnits(),s=i=="degrees"?"degrees":"m";let a=rx(r,e.resolution,t,s);const o=this.minWidth_*(this.dpi_||Fg)/Fg,l=this.maxWidth_!==void 0?this.maxWidth_*(this.dpi_||Fg)/Fg:void 0;let u=o*a,h="";if(i=="degrees"){const P=r0.degrees;u*=P,u<P/60?(h="",a*=3600):u<P?(h="",a*=60):h=""}else if(i=="imperial")u<.9144?(h="in",a/=.0254):u<1609.344?(h="ft",a/=.3048):(h="mi",a/=1609.344);else if(i=="nautical")a/=1852,h="NM";else if(i=="metric")u<1e-6?(h="nm",a*=1e9):u<.001?(h="m",a*=1e6):u<1?(h="mm",a*=1e3):u<1e3?h="m":(h="km",a/=1e3);else if(i=="us")u<.9144?(h="in",a*=39.37):u<1609.344?(h="ft",a/=.30480061):(h="mi",a/=1609.3472);else throw new Error("Invalid units");let f=3*Math.floor(Math.log(o*a)/Math.log(10)),g,p,E,x=0,w,T;for(;;){E=Math.floor(f/3);const P=Math.pow(10,E);if(g=vH[(f%3+3)%3]*P,p=Math.round(g/a),isNaN(p)){this.element.style.display="none",this.renderedVisible_=!1;return}if(l!==void 0&&p>=l){g=x,p=w,E=T;break}else if(p>=o)break;x=g,w=p,T=E,++f}const I=this.scaleBar_?this.createScaleBar(p,g,h):g.toFixed(E<0?-E:0)+" "+h;this.renderedHTML_!=I&&(this.innerElement_.innerHTML=I,this.renderedHTML_=I),this.renderedWidth_!=p&&(this.innerElement_.style.width=p+"px",this.renderedWidth_=p),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}createScaleBar(e,t,r){const i=this.getScaleForResolution(),s=i<1?Math.round(1/i).toLocaleString()+" : 1":"1 : "+Math.round(i).toLocaleString(),a=this.scaleBarSteps_,o=e/a,l=[this.createMarker("absolute")];for(let h=0;h<a;++h){const f=h%2===0?"ol-scale-singlebar-odd":"ol-scale-singlebar-even";l.push(`<div><div class="ol-scale-singlebar ${f}" style="width: ${o}px;"></div>`+this.createMarker("relative")+(h%2===0||a===2?this.createStepText(h,e,!1,t,r):"")+"</div>")}return l.push(this.createStepText(a,e,!0,t,r)),(this.scaleBarText_?`<div class="ol-scale-text" style="width: ${e}px;">`+s+"</div>":"")+l.join("")}createMarker(e){return`<div class="ol-scale-step-marker" style="position: ${e}; top: ${e==="absolute"?3:-10}px;"></div>`}createStepText(e,t,r,i,s){const o=(e===0?0:Math.round(i/this.scaleBarSteps_*e*100)/100)+(e===0?"":" "+s),l=e===0?-3:t/this.scaleBarSteps_*-1,u=e===0?0:t/this.scaleBarSteps_*2;return`<div class="ol-scale-step-text" style="margin-left: ${l}px;text-align: ${e===0?"left":"center"};min-width: ${u}px;left: ${r?t+"px":"unset"};">`+o+"</div>"}getScaleForResolution(){const e=rx(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,"m"),t=this.dpi_||Fg,r=1e3/25.4;return e*r*t}render(e){const t=e.frameState;t?this.viewState_=t.viewState:this.viewState_=null,this.updateElement_()}}const wH={},Mk=n=>{let e;const t=new Set,r=(h,f)=>{const g=typeof h=="function"?h(e):h;if(!Object.is(g,e)){const p=e;e=f??(typeof g!="object"||g===null)?g:Object.assign({},e,g),t.forEach(E=>E(e,p))}},i=()=>e,l={setState:r,getState:i,getInitialState:()=>u,subscribe:h=>(t.add(h),()=>t.delete(h)),destroy:()=>{(wH?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},u=e=n(r,i,l);return l},SH=n=>n?Mk(n):Mk;var H2={exports:{}},K2={},Y2={exports:{}},X2={};var Nk;function TH(){if(Nk)return X2;Nk=1;var n=Lp();function e(f,g){return f===g&&(f!==0||1/f===1/g)||f!==f&&g!==g}var t=typeof Object.is=="function"?Object.is:e,r=n.useState,i=n.useEffect,s=n.useLayoutEffect,a=n.useDebugValue;function o(f,g){var p=g(),E=r({inst:{value:p,getSnapshot:g}}),x=E[0].inst,w=E[1];return s(function(){x.value=p,x.getSnapshot=g,l(x)&&w({inst:x})},[f,p,g]),i(function(){return l(x)&&w({inst:x}),f(function(){l(x)&&w({inst:x})})},[f]),a(p),p}function l(f){var g=f.getSnapshot;f=f.value;try{var p=g();return!t(f,p)}catch{return!0}}function u(f,g){return g()}var h=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?u:o;return X2.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:h,X2}var Lk;function IH(){return Lk||(Lk=1,Y2.exports=TH()),Y2.exports}var Ok;function AH(){if(Ok)return K2;Ok=1;var n=Lp(),e=IH();function t(u,h){return u===h&&(u!==0||1/u===1/h)||u!==u&&h!==h}var r=typeof Object.is=="function"?Object.is:t,i=e.useSyncExternalStore,s=n.useRef,a=n.useEffect,o=n.useMemo,l=n.useDebugValue;return K2.useSyncExternalStoreWithSelector=function(u,h,f,g,p){var E=s(null);if(E.current===null){var x={hasValue:!1,value:null};E.current=x}else x=E.current;E=o(function(){function T(B){if(!I){if(I=!0,P=B,B=g(B),p!==void 0&&x.hasValue){var k=x.value;if(p(k,B))return N=k}return N=B}if(k=N,r(P,B))return k;var C=g(B);return p!==void 0&&p(k,C)?(P=B,k):(P=B,N=C)}var I=!1,P,N,D=f===void 0?null:f;return[function(){return T(h())},D===null?void 0:function(){return T(D())}]},[h,f,g,p]);var w=i(u,E[0],E[1]);return a(function(){x.hasValue=!0,x.value=w},[w]),l(w),w},K2}var Dk;function bH(){return Dk||(Dk=1,H2.exports=AH()),H2.exports}var RH=bH();const CH=BI(RH),pD={},{useDebugValue:PH}=TB,{useSyncExternalStoreWithSelector:kH}=CH;let Fk=!1;const MH=n=>n;function NH(n,e=MH,t){(pD?"production":void 0)!=="production"&&t&&!Fk&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),Fk=!0);const r=kH(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return PH(r),r}const LH=n=>{(pD?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?SH(n):n,t=(r,i)=>NH(e,r,i);return Object.assign(t,e),t},Ia=n=>LH;var yD=Symbol.for("immer-nothing"),jk=Symbol.for("immer-draftable"),Qs=Symbol.for("immer-state");function za(n,...e){throw new Error(`[Immer] minified error nr: ${n}. Full error at: https://bit.ly/3cXEKWf`)}var Jm=Object.getPrototypeOf;function l0(n){return!!n&&!!n[Qs]}function Fh(n){return n?_D(n)||Array.isArray(n)||!!n[jk]||!!n.constructor?.[jk]||Qp(n)||Hv(n):!1}var OH=Object.prototype.constructor.toString(),Vk=new WeakMap;function _D(n){if(!n||typeof n!="object")return!1;const e=Object.getPrototypeOf(n);if(e===null||e===Object.prototype)return!0;const t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(t===Object)return!0;if(typeof t!="function")return!1;let r=Vk.get(t);return r===void 0&&(r=Function.toString.call(t),Vk.set(t,r)),r===OH}function mx(n,e,t=!0){Wv(n)===0?(t?Reflect.ownKeys(n):Object.keys(n)).forEach(i=>{e(i,n[i],n)}):n.forEach((r,i)=>e(i,r,n))}function Wv(n){const e=n[Qs];return e?e.type_:Array.isArray(n)?1:Qp(n)?2:Hv(n)?3:0}function mT(n,e){return Wv(n)===2?n.has(e):Object.prototype.hasOwnProperty.call(n,e)}function xD(n,e,t){const r=Wv(n);r===2?n.set(e,t):r===3?n.add(t):n[e]=t}function DH(n,e){return n===e?n!==0||1/n===1/e:n!==n&&e!==e}function Qp(n){return n instanceof Map}function Hv(n){return n instanceof Set}function eh(n){return n.copy_||n.base_}function pT(n,e){if(Qp(n))return new Map(n);if(Hv(n))return new Set(n);if(Array.isArray(n))return Array.prototype.slice.call(n);const t=_D(n);if(e===!0||e==="class_only"&&!t){const r=Object.getOwnPropertyDescriptors(n);delete r[Qs];let i=Reflect.ownKeys(r);for(let s=0;s<i.length;s++){const a=i[s],o=r[a];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(r[a]={configurable:!0,writable:!0,enumerable:o.enumerable,value:n[a]})}return Object.create(Jm(n),r)}else{const r=Jm(n);if(r!==null&&t)return{...n};const i=Object.create(r);return Object.assign(i,n)}}function bA(n,e=!1){return Kv(n)||l0(n)||!Fh(n)||(Wv(n)>1&&Object.defineProperties(n,{set:Ky,add:Ky,clear:Ky,delete:Ky}),Object.freeze(n),e&&Object.values(n).forEach(t=>bA(t,!0))),n}function FH(){za(2)}var Ky={value:FH};function Kv(n){return n===null||typeof n!="object"?!0:Object.isFrozen(n)}var jH={};function jh(n){const e=jH[n];return e||za(0,n),e}var ep;function vD(){return ep}function VH(n,e){return{drafts_:[],parent_:n,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Gk(n,e){e&&(jh("Patches"),n.patches_=[],n.inversePatches_=[],n.patchListener_=e)}function yT(n){_T(n),n.drafts_.forEach(GH),n.drafts_=null}function _T(n){n===ep&&(ep=n.parent_)}function Bk(n){return ep=VH(ep,n)}function GH(n){const e=n[Qs];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function Uk(n,e){e.unfinalizedDrafts_=e.drafts_.length;const t=e.drafts_[0];return n!==void 0&&n!==t?(t[Qs].modified_&&(yT(e),za(4)),Fh(n)&&(n=px(e,n),e.parent_||yx(e,n)),e.patches_&&jh("Patches").generateReplacementPatches_(t[Qs].base_,n,e.patches_,e.inversePatches_)):n=px(e,t,[]),yT(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),n!==yD?n:void 0}function px(n,e,t){if(Kv(e))return e;const r=n.immer_.shouldUseStrictIteration(),i=e[Qs];if(!i)return mx(e,(s,a)=>zk(n,i,e,s,a,t),r),e;if(i.scope_!==n)return e;if(!i.modified_)return yx(n,i.base_,!0),i.base_;if(!i.finalized_){i.finalized_=!0,i.scope_.unfinalizedDrafts_--;const s=i.copy_;let a=s,o=!1;i.type_===3&&(a=new Set(s),s.clear(),o=!0),mx(a,(l,u)=>zk(n,i,s,l,u,t,o),r),yx(n,s,!1),t&&n.patches_&&jh("Patches").generatePatches_(i,t,n.patches_,n.inversePatches_)}return i.copy_}function zk(n,e,t,r,i,s,a){if(i==null||typeof i!="object"&&!a)return;const o=Kv(i);if(!(o&&!a)){if(l0(i)){const l=s&&e&&e.type_!==3&&!mT(e.assigned_,r)?s.concat(r):void 0,u=px(n,i,l);if(xD(t,r,u),l0(u))n.canAutoFreeze_=!1;else return}else a&&t.add(i);if(Fh(i)&&!o){if(!n.immer_.autoFreeze_&&n.unfinalizedDrafts_<1||e&&e.base_&&e.base_[r]===i&&o)return;px(n,i),(!e||!e.scope_.parent_)&&typeof r!="symbol"&&(Qp(t)?t.has(r):Object.prototype.propertyIsEnumerable.call(t,r))&&yx(n,i)}}}function yx(n,e,t=!1){!n.parent_&&n.immer_.autoFreeze_&&n.canAutoFreeze_&&bA(e,t)}function BH(n,e){const t=Array.isArray(n),r={type_:t?1:0,scope_:e?e.scope_:vD(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:n,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=r,s=RA;t&&(i=[r],s=tp);const{revoke:a,proxy:o}=Proxy.revocable(i,s);return r.draft_=o,r.revoke_=a,o}var RA={get(n,e){if(e===Qs)return n;const t=eh(n);if(!mT(t,e))return UH(n,t,e);const r=t[e];return n.finalized_||!Fh(r)?r:r===q2(n.base_,e)?(Z2(n),n.copy_[e]=vT(r,n)):r},has(n,e){return e in eh(n)},ownKeys(n){return Reflect.ownKeys(eh(n))},set(n,e,t){const r=ED(eh(n),e);if(r?.set)return r.set.call(n.draft_,t),!0;if(!n.modified_){const i=q2(eh(n),e),s=i?.[Qs];if(s&&s.base_===t)return n.copy_[e]=t,n.assigned_[e]=!1,!0;if(DH(t,i)&&(t!==void 0||mT(n.base_,e)))return!0;Z2(n),xT(n)}return n.copy_[e]===t&&(t!==void 0||e in n.copy_)||Number.isNaN(t)&&Number.isNaN(n.copy_[e])||(n.copy_[e]=t,n.assigned_[e]=!0),!0},deleteProperty(n,e){return q2(n.base_,e)!==void 0||e in n.base_?(n.assigned_[e]=!1,Z2(n),xT(n)):delete n.assigned_[e],n.copy_&&delete n.copy_[e],!0},getOwnPropertyDescriptor(n,e){const t=eh(n),r=Reflect.getOwnPropertyDescriptor(t,e);return r&&{writable:!0,configurable:n.type_!==1||e!=="length",enumerable:r.enumerable,value:t[e]}},defineProperty(){za(11)},getPrototypeOf(n){return Jm(n.base_)},setPrototypeOf(){za(12)}},tp={};mx(RA,(n,e)=>{tp[n]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});tp.deleteProperty=function(n,e){return tp.set.call(this,n,e,void 0)};tp.set=function(n,e,t){return RA.set.call(this,n[0],e,t,n[0])};function q2(n,e){const t=n[Qs];return(t?eh(t):n)[e]}function UH(n,e,t){const r=ED(e,t);return r?"value"in r?r.value:r.get?.call(n.draft_):void 0}function ED(n,e){if(!(e in n))return;let t=Jm(n);for(;t;){const r=Object.getOwnPropertyDescriptor(t,e);if(r)return r;t=Jm(t)}}function xT(n){n.modified_||(n.modified_=!0,n.parent_&&xT(n.parent_))}function Z2(n){n.copy_||(n.copy_=pT(n.base_,n.scope_.immer_.useStrictShallowCopy_))}var zH=class{constructor(n){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,t,r)=>{if(typeof e=="function"&&typeof t!="function"){const s=t;t=e;const a=this;return function(l=s,...u){return a.produce(l,h=>t.call(this,h,...u))}}typeof t!="function"&&za(6),r!==void 0&&typeof r!="function"&&za(7);let i;if(Fh(e)){const s=Bk(this),a=vT(e,void 0);let o=!0;try{i=t(a),o=!1}finally{o?yT(s):_T(s)}return Gk(s,r),Uk(i,s)}else if(!e||typeof e!="object"){if(i=t(e),i===void 0&&(i=e),i===yD&&(i=void 0),this.autoFreeze_&&bA(i,!0),r){const s=[],a=[];jh("Patches").generateReplacementPatches_(e,i,s,a),r(s,a)}return i}else za(1,e)},this.produceWithPatches=(e,t)=>{if(typeof e=="function")return(a,...o)=>this.produceWithPatches(a,l=>e(l,...o));let r,i;return[this.produce(e,t,(a,o)=>{r=a,i=o}),r,i]},typeof n?.autoFreeze=="boolean"&&this.setAutoFreeze(n.autoFreeze),typeof n?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(n.useStrictShallowCopy),typeof n?.useStrictIteration=="boolean"&&this.setUseStrictIteration(n.useStrictIteration)}createDraft(n){Fh(n)||za(8),l0(n)&&(n=$H(n));const e=Bk(this),t=vT(n,void 0);return t[Qs].isManual_=!0,_T(e),t}finishDraft(n,e){const t=n&&n[Qs];(!t||!t.isManual_)&&za(9);const{scope_:r}=t;return Gk(r,e),Uk(void 0,r)}setAutoFreeze(n){this.autoFreeze_=n}setUseStrictShallowCopy(n){this.useStrictShallowCopy_=n}setUseStrictIteration(n){this.useStrictIteration_=n}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(n,e){let t;for(t=e.length-1;t>=0;t--){const i=e[t];if(i.path.length===0&&i.op==="replace"){n=i.value;break}}t>-1&&(e=e.slice(t+1));const r=jh("Patches").applyPatches_;return l0(n)?r(n,e):this.produce(n,i=>r(i,e))}};function vT(n,e){const t=Qp(n)?jh("MapSet").proxyMap_(n,e):Hv(n)?jh("MapSet").proxySet_(n,e):BH(n,e);return(e?e.scope_:vD()).drafts_.push(t),t}function $H(n){return l0(n)||za(10,n),wD(n)}function wD(n){if(!Fh(n)||Kv(n))return n;const e=n[Qs];let t,r=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,t=pT(n,e.scope_.immer_.useStrictShallowCopy_),r=e.scope_.immer_.shouldUseStrictIteration()}else t=pT(n,!0);return mx(t,(i,s)=>{xD(t,i,wD(s))},r),e&&(e.finalized_=!1),t}var WH=new zH,HH=WH.produce;const KH=n=>(e,t,r)=>(r.setState=(i,s,...a)=>{const o=typeof i=="function"?HH(i):i;return e(o,s,...a)},n(r.setState,t,r)),M0=KH,qi=Ia()(M0((n,e)=>({tracking:!1,position:null,heading:null,smoothHeading:null,accuracy:null,speed:null,headingSource:null,watchId:null,firstFix:!0,config:{smoothingFactor:.2,minRotationSpeed:8,centerOnUser:!0,animationDuration:100},startTracking:()=>{n(t=>{t.tracking=!0})},stopTracking:()=>{n(t=>{const{watchId:r}=e();r!==null&&navigator.geolocation.clearWatch(r),t.tracking=!1,t.speed=null,t.headingSource=null,t.watchId=null})},updatePosition:t=>{n(r=>{r.position={lat:t.coords.latitude,lng:t.coords.longitude},r.accuracy=t.coords.accuracy,r.speed=t.coords.speed;const i=15,s=.5;if(!(t.coords.accuracy!==null&&t.coords.accuracy<i)){r.headingSource=null;return}if(t.coords.heading!==null&&t.coords.speed!==null&&t.coords.speed>s){r.headingSource="gps";const o=t.coords.heading;e().updateHeading(o,"gps")}else r.headingSource="compass"})},updateHeading:(t,r="compass")=>{n(i=>{const{smoothHeading:s,config:a}=e();if(s===null){i.smoothHeading=t,i.heading=t;return}let o=t-s;o>180&&(o-=360),o<-180&&(o+=360);const l=r==="compass"?5:3;if(Math.abs(o)<l)return;const h=s+o*(r==="gps"?.5:.35);i.smoothHeading=(h+360)%360,i.heading=t})},setSmoothedHeading:t=>{n(r=>{r.smoothHeading=t,r.heading=t})},setWatchId:t=>{n(r=>{r.watchId=t})},resetFirstFix:()=>{n(t=>{t.firstFix=!1})}}))),CA={"TMK 1850":{name:"TMK 1850",factory:async()=>null,immediateLoad:!0,tier:"premium"},"Bonnebladen 1900":{name:"Bonnebladen 1900",factory:async()=>null,immediateLoad:!0,tier:"premium"},"AHN 0.5m":{name:"AHN 0.5m",factory:async()=>{const{createAHNLayerOL:n}=await dt(async()=>{const{createAHNLayerOL:e}=await import("./pdokWMSLayers-B6YiIPxR.js");return{createAHNLayerOL:e}},[]);return n()},immediateLoad:!0},Geomorfologie:{name:"Geomorfologie",factory:async()=>{const{createGeomorfologieLayerOL:n}=await dt(async()=>{const{createGeomorfologieLayerOL:e}=await import("./pdokWMSLayers-B6YiIPxR.js");return{createGeomorfologieLayerOL:e}},[]);return n()},immediateLoad:!0},Bodemkaart:{name:"Bodemkaart",factory:async()=>{const{createBodemkaartLayerOL:n}=await dt(async()=>{const{createBodemkaartLayerOL:e}=await import("./pdokWMSLayers-B6YiIPxR.js");return{createBodemkaartLayerOL:e}},[]);return n()},immediateLoad:!0},IKAW:{name:"IKAW",factory:async()=>{const{createIKAWLayerOL:n}=await dt(async()=>{const{createIKAWLayerOL:e}=await import("./pdokWMSLayers-B6YiIPxR.js");return{createIKAWLayerOL:e}},[]);return n()},immediateLoad:!0},"FAMKE Steentijd":{name:"FAMKE Steentijd",factory:async()=>{const{createFAMKESteentijdLayerOL:n}=await dt(async()=>{const{createFAMKESteentijdLayerOL:e}=await import("./pdokWMSLayers-B6YiIPxR.js");return{createFAMKESteentijdLayerOL:e}},[]);return n()},immediateLoad:!0},"Archeo Landschappen":{name:"Archeo Landschappen",factory:async()=>{const{createArcheoLandschappenLayerOL:n}=await dt(async()=>{const{createArcheoLandschappenLayerOL:e}=await import("./pdokWMSLayers-B6YiIPxR.js");return{createArcheoLandschappenLayerOL:e}},[]);return n()},immediateLoad:!0},Essen:{name:"Essen",factory:async()=>{const{createEssenLayerOL:n}=await dt(async()=>{const{createEssenLayerOL:e}=await import("./pdokWMSLayers-B6YiIPxR.js");return{createEssenLayerOL:e}},[]);return n()},immediateLoad:!0},Rijksmonumenten:{name:"Rijksmonumenten",factory:async()=>{const{createRijksmonumentenLayerOL:n}=await dt(async()=>{const{createRijksmonumentenLayerOL:e}=await import("./pdokWMSLayers-B6YiIPxR.js");return{createRijksmonumentenLayerOL:e}},[]);return n()},immediateLoad:!0},"Archeo Onderzoeken":{name:"Archeo Onderzoeken",factory:async()=>{const{createArcheoOnderzoekenLayerOL:n}=await dt(async()=>{const{createArcheoOnderzoekenLayerOL:e}=await import("./pdokWMSLayers-B6YiIPxR.js");return{createArcheoOnderzoekenLayerOL:e}},[]);return n()},immediateLoad:!0},Werelderfgoed:{name:"Werelderfgoed",factory:async()=>{const{createWerelderfgoedLayerOL:n}=await dt(async()=>{const{createWerelderfgoedLayerOL:e}=await import("./pdokWMSLayers-B6YiIPxR.js");return{createWerelderfgoedLayerOL:e}},[]);return n()},immediateLoad:!0},Terpen:{name:"Terpen",factory:async()=>{const{createTerpenLayerOL:n}=await dt(async()=>{const{createTerpenLayerOL:e}=await import("./terpenOL-BdM83l-U.js");return{createTerpenLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},Verdedigingslinies:{name:"Verdedigingslinies",factory:async()=>{const{createLiniesLayerOL:n}=await dt(async()=>{const{createLiniesLayerOL:e}=await import("./verdedigingswerkenOL-Cy6eAcrj.js");return{createLiniesLayerOL:e}},[]);return n()},immediateLoad:!0},Inundatiegebieden:{name:"Inundatiegebieden",factory:async()=>{const{createInundatiesLayerOL:n}=await dt(async()=>{const{createInundatiesLayerOL:e}=await import("./verdedigingswerkenOL-Cy6eAcrj.js");return{createInundatiesLayerOL:e}},[]);return n()},immediateLoad:!0},"Militaire Objecten":{name:"Militaire Objecten",factory:async()=>{const{createMilitaireObjectenLayerOL:n}=await dt(async()=>{const{createMilitaireObjectenLayerOL:e}=await import("./verdedigingswerkenOL-Cy6eAcrj.js");return{createMilitaireObjectenLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 800 n.Chr.":{name:"Paleokaart 800 n.Chr.",factory:async()=>{const{createPaleo800ncLayerOL:n}=await dt(async()=>{const{createPaleo800ncLayerOL:e}=await import("./paleokaartOL-C4BK7CBy.js");return{createPaleo800ncLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 100 n.Chr.":{name:"Paleokaart 100 n.Chr.",factory:async()=>{const{createPaleo100ncLayerOL:n}=await dt(async()=>{const{createPaleo100ncLayerOL:e}=await import("./paleokaartOL-C4BK7CBy.js");return{createPaleo100ncLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 500 v.Chr.":{name:"Paleokaart 500 v.Chr.",factory:async()=>{const{createPaleo500vcLayerOL:n}=await dt(async()=>{const{createPaleo500vcLayerOL:e}=await import("./paleokaartOL-C4BK7CBy.js");return{createPaleo500vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 1500 v.Chr.":{name:"Paleokaart 1500 v.Chr.",factory:async()=>{const{createPaleo1500vcLayerOL:n}=await dt(async()=>{const{createPaleo1500vcLayerOL:e}=await import("./paleokaartOL-C4BK7CBy.js");return{createPaleo1500vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 2750 v.Chr.":{name:"Paleokaart 2750 v.Chr.",factory:async()=>{const{createPaleo2750vcLayerOL:n}=await dt(async()=>{const{createPaleo2750vcLayerOL:e}=await import("./paleokaartOL-C4BK7CBy.js");return{createPaleo2750vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 5500 v.Chr.":{name:"Paleokaart 5500 v.Chr.",factory:async()=>{const{createPaleo5500vcLayerOL:n}=await dt(async()=>{const{createPaleo5500vcLayerOL:e}=await import("./paleokaartOL-C4BK7CBy.js");return{createPaleo5500vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 9000 v.Chr.":{name:"Paleokaart 9000 v.Chr.",factory:async()=>{const{createPaleo9000vcLayerOL:n}=await dt(async()=>{const{createPaleo9000vcLayerOL:e}=await import("./paleokaartOL-C4BK7CBy.js");return{createPaleo9000vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Religieus Erfgoed":{name:"Religieus Erfgoed",factory:async()=>{const{createReligieusErfgoedLayerOL:n}=await dt(async()=>{const{createReligieusErfgoedLayerOL:e}=await import("./religieusErfgoedOL-Ds7HbU99.js");return{createReligieusErfgoedLayerOL:e}},[]);return n()},immediateLoad:!0},"AHN4 Hoogtekaart Kleur":{name:"AHN4 Hoogtekaart Kleur",factory:async()=>{const{createAHN4ColorElevationLayerOL:n}=await dt(async()=>{const{createAHN4ColorElevationLayerOL:e}=await import("./hillshadeLayers-CKSiyBTS.js");return{createAHN4ColorElevationLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},"AHN4 Hillshade NL":{name:"AHN4 Hillshade NL",factory:async()=>{const{createAHN4HillshadeLayerOL:n}=await dt(async()=>{const{createAHN4HillshadeLayerOL:e}=await import("./hillshadeLayers-CKSiyBTS.js");return{createAHN4HillshadeLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},"AHN4 Multi-Hillshade NL":{name:"AHN4 Multi-Hillshade NL",factory:async()=>{const{createAHN4MultiHillshadeLayerOL:n}=await dt(async()=>{const{createAHN4MultiHillshadeLayerOL:e}=await import("./hillshadeLayers-CKSiyBTS.js");return{createAHN4MultiHillshadeLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},Gewaspercelen:{name:"Gewaspercelen",factory:async()=>{const{createGewaspercelenLayerOL:n}=await dt(async()=>{const{createGewaspercelenLayerOL:e}=await import("./pdokWMSLayers-B6YiIPxR.js");return{createGewaspercelenLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},"Kadastrale Grenzen":{name:"Kadastrale Grenzen",factory:async()=>{const{createKadastraleKaartLayerOL:n}=await dt(async()=>{const{createKadastraleKaartLayerOL:e}=await import("./pdokWMSLayers-B6YiIPxR.js");return{createKadastraleKaartLayerOL:e}},[]);return n()},immediateLoad:!0},Scheepswrakken:{name:"Scheepswrakken",factory:async()=>{const{createScheepswrakkenLayerOL:n}=await dt(async()=>{const{createScheepswrakkenLayerOL:e}=await import("./pdokWMSLayers-B6YiIPxR.js");return{createScheepswrakkenLayerOL:e}},[]);return n()},immediateLoad:!0},"Woonheuvels ZH":{name:"Woonheuvels ZH",factory:async()=>{const{createWoonheuvelsLayerOL:n}=await dt(async()=>{const{createWoonheuvelsLayerOL:e}=await import("./pdokWMSLayers-B6YiIPxR.js");return{createWoonheuvelsLayerOL:e}},[]);return n()},immediateLoad:!0},"Romeinse Forten":{name:"Romeinse Forten",factory:async()=>{const{createRomeinseFortenLayerOL:n}=await dt(async()=>{const{createRomeinseFortenLayerOL:e}=await import("./pdokWMSLayers-B6YiIPxR.js");return{createRomeinseFortenLayerOL:e}},[]);return n()},immediateLoad:!0},Windmolens:{name:"Windmolens",factory:async()=>{const{createWindmolensLayerOL:n}=await dt(async()=>{const{createWindmolensLayerOL:e}=await import("./pdokWMSLayers-B6YiIPxR.js");return{createWindmolensLayerOL:e}},[]);return n()},immediateLoad:!0},Erfgoedlijnen:{name:"Erfgoedlijnen",factory:async()=>{const{createErfgoedlijnenLayerOL:n}=await dt(async()=>{const{createErfgoedlijnenLayerOL:e}=await import("./pdokWMSLayers-B6YiIPxR.js");return{createErfgoedlijnenLayerOL:e}},[]);return n()},immediateLoad:!0},"Oude Kernen":{name:"Oude Kernen",factory:async()=>{const{createOudeKernenLayerOL:n}=await dt(async()=>{const{createOudeKernenLayerOL:e}=await import("./pdokWMSLayers-B6YiIPxR.js");return{createOudeKernenLayerOL:e}},[]);return n()},immediateLoad:!0},"Relictenkaart Punten":{name:"Relictenkaart Punten",factory:async()=>{const{createRelictenkaartPuntenLayerOL:n}=await dt(async()=>{const{createRelictenkaartPuntenLayerOL:e}=await import("./pdokWMSLayers-B6YiIPxR.js");return{createRelictenkaartPuntenLayerOL:e}},[]);return n()},immediateLoad:!0},"Relictenkaart Lijnen":{name:"Relictenkaart Lijnen",factory:async()=>{const{createRelictenkaartLijnenLayerOL:n}=await dt(async()=>{const{createRelictenkaartLijnenLayerOL:e}=await import("./pdokWMSLayers-B6YiIPxR.js");return{createRelictenkaartLijnenLayerOL:e}},[]);return n()},immediateLoad:!0},"Relictenkaart Vlakken":{name:"Relictenkaart Vlakken",factory:async()=>{const{createRelictenkaartVlakkenLayerOL:n}=await dt(async()=>{const{createRelictenkaartVlakkenLayerOL:e}=await import("./pdokWMSLayers-B6YiIPxR.js");return{createRelictenkaartVlakkenLayerOL:e}},[]);return n()},immediateLoad:!0},"Verdronken Dorpen":{name:"Verdronken Dorpen",factory:async()=>{const{createVerdronkenDorpenLayerOL:n}=await dt(async()=>{const{createVerdronkenDorpenLayerOL:e}=await import("./pdokWMSLayers-B6YiIPxR.js");return{createVerdronkenDorpenLayerOL:e}},[]);return n()},immediateLoad:!0},"AMK Monumenten":{name:"AMK Monumenten",factory:async()=>{const{createAMKLayerOL:n}=await dt(async()=>{const{createAMKLayerOL:e}=await import("./amkOL-D7xei8nL.js");return{createAMKLayerOL:e}},__vite__mapDeps([0,1]));return n()},immediateLoad:!1,tier:"premium"},"AMK Romeins":{name:"AMK Romeins",factory:async()=>{const{createAMKRomeinsLayerOL:n}=await dt(async()=>{const{createAMKRomeinsLayerOL:e}=await import("./amkOL-D7xei8nL.js");return{createAMKRomeinsLayerOL:e}},__vite__mapDeps([0,1]));return n()},immediateLoad:!1,tier:"premium"},"AMK Steentijd":{name:"AMK Steentijd",factory:async()=>{const{createAMKSteentijdLayerOL:n}=await dt(async()=>{const{createAMKSteentijdLayerOL:e}=await import("./amkOL-D7xei8nL.js");return{createAMKSteentijdLayerOL:e}},__vite__mapDeps([0,1]));return n()},immediateLoad:!1,tier:"premium"},"AMK Vroege ME":{name:"AMK Vroege ME",factory:async()=>{const{createAMKVroegeMELayerOL:n}=await dt(async()=>{const{createAMKVroegeMELayerOL:e}=await import("./amkOL-D7xei8nL.js");return{createAMKVroegeMELayerOL:e}},__vite__mapDeps([0,1]));return n()},immediateLoad:!1,tier:"premium"},"AMK Late ME":{name:"AMK Late ME",factory:async()=>{const{createAMKLateMELayerOL:n}=await dt(async()=>{const{createAMKLateMELayerOL:e}=await import("./amkOL-D7xei8nL.js");return{createAMKLateMELayerOL:e}},__vite__mapDeps([0,1]));return n()},immediateLoad:!1,tier:"premium"},"AMK Overig":{name:"AMK Overig",factory:async()=>{const{createAMKOverigLayerOL:n}=await dt(async()=>{const{createAMKOverigLayerOL:e}=await import("./amkOL-D7xei8nL.js");return{createAMKOverigLayerOL:e}},__vite__mapDeps([0,1]));return n()},immediateLoad:!1,tier:"premium"},"Romeinse wegen (regio)":{name:"Romeinse wegen (regio)",factory:async()=>{const{createRomeinseWegenLayerOL:n}=await dt(async()=>{const{createRomeinseWegenLayerOL:e}=await import("./romeinsOL-Cb34Bbrd.js");return{createRomeinseWegenLayerOL:e}},__vite__mapDeps([2,1]));return n()},immediateLoad:!1},"Romeinse wegen (Wereld)":{name:"Romeinse wegen (Wereld)",factory:async()=>{const{createRomeinseWegenWereldLayerOL:n}=await dt(async()=>{const{createRomeinseWegenWereldLayerOL:e}=await import("./romeinsOL-Cb34Bbrd.js");return{createRomeinseWegenWereldLayerOL:e}},__vite__mapDeps([2,1]));return n()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},Kastelen:{name:"Kastelen",factory:async()=>{const{createKastelenLayerOL:n}=await dt(async()=>{const{createKastelenLayerOL:e}=await import("./kastelenOL-B_SHONZ6.js");return{createKastelenLayerOL:e}},__vite__mapDeps([3,4]));return n()},immediateLoad:!1},Runes:{name:"Runes",factory:async()=>{const{createRuinesLayerOL:n}=await dt(async()=>{const{createRuinesLayerOL:e}=await import("./ruinesOL-GFxQkzLY.js");return{createRuinesLayerOL:e}},__vite__mapDeps([5,4]));return n()},immediateLoad:!1},Veengebieden:{name:"Veengebieden",factory:async()=>{const{createVeengebiedenLayerOL:n}=await dt(async()=>{const{createVeengebiedenLayerOL:e}=await import("./veengebiedenOL-CzyRIREo.js");return{createVeengebiedenLayerOL:e}},[]);return n()},immediateLoad:!1},Hunebedden:{name:"Hunebedden",factory:async()=>{const{createHunebeddenLayerOL:n}=await dt(async()=>{const{createHunebeddenLayerOL:e}=await import("./hunebeddenOL-BwbZRhar.js");return{createHunebeddenLayerOL:e}},__vite__mapDeps([6,4]));return n()},immediateLoad:!1},"UIKAV Punten":{name:"UIKAV Punten",factory:async()=>{const{createUIKAVArcheoPuntenLayerOL:n}=await dt(async()=>{const{createUIKAVArcheoPuntenLayerOL:e}=await import("./uikavArcheoPuntenOL-B0Cr8DC9.js");return{createUIKAVArcheoPuntenLayerOL:e}},__vite__mapDeps([7,1,4]));return n()},immediateLoad:!1,tier:"premium"},"UIKAV Vlakken":{name:"UIKAV Vlakken",factory:async()=>{const{createUIKAVVlakkenLayerOL:n}=await dt(async()=>{const{createUIKAVVlakkenLayerOL:e}=await import("./uikavVlakkenOL-BpU0Cv75.js");return{createUIKAVVlakkenLayerOL:e}},__vite__mapDeps([8,1]));return n()},immediateLoad:!1},"UIKAV Buffer":{name:"UIKAV Buffer",factory:async()=>{const{createUIKAVBufferlaagLayerOL:n}=await dt(async()=>{const{createUIKAVBufferlaagLayerOL:e}=await import("./uikavBufferlaagOL-DVc5nJOu.js");return{createUIKAVBufferlaagLayerOL:e}},__vite__mapDeps([9,1]));return n()},immediateLoad:!1},"UIKAV Expert":{name:"UIKAV Expert",factory:async()=>{const{createUIKAVExpertLayerOL:n}=await dt(async()=>{const{createUIKAVExpertLayerOL:e}=await import("./uikavExpertOL-B-7ApSlm.js");return{createUIKAVExpertLayerOL:e}},__vite__mapDeps([10,1]));return n()},immediateLoad:!1},"UIKAV Indeling":{name:"UIKAV Indeling",factory:async()=>{const{createUIKAVUiterwaardenLayerOL:n}=await dt(async()=>{const{createUIKAVUiterwaardenLayerOL:e}=await import("./uikavUiterwaardenOL-DVNkBDPy.js");return{createUIKAVUiterwaardenLayerOL:e}},__vite__mapDeps([11,1]));return n()},immediateLoad:!1},Speeltuinen:{name:"Speeltuinen",factory:async()=>{const{createSpeeltuinenLayerOL:n}=await dt(async()=>{const{createSpeeltuinenLayerOL:e}=await import("./speeltuinenOL-BSFdxmad.js");return{createSpeeltuinenLayerOL:e}},__vite__mapDeps([12,1,4]));return n()},immediateLoad:!1},Musea:{name:"Musea",factory:async()=>{const{createMuseaLayerOL:n}=await dt(async()=>{const{createMuseaLayerOL:e}=await import("./museaOL-LwLTRsxn.js");return{createMuseaLayerOL:e}},__vite__mapDeps([13,1,4]));return n()},immediateLoad:!1},Strandjes:{name:"Strandjes",factory:async()=>{const{createStrandjesLayerOL:n}=await dt(async()=>{const{createStrandjesLayerOL:e}=await import("./strandjesOL-CZsL_qJi.js");return{createStrandjesLayerOL:e}},__vite__mapDeps([14,1]));return n()},immediateLoad:!1},Parken:{name:"Parken",factory:async()=>{const{createParkenLayerOL:n}=await dt(async()=>{const{createParkenLayerOL:e}=await import("./parkenOL-DFd20PBd.js");return{createParkenLayerOL:e}},__vite__mapDeps([15,1]));return n()},immediateLoad:!1},Kringloopwinkels:{name:"Kringloopwinkels",factory:async()=>{const{createKringloopwinkelsLayerOL:n}=await dt(async()=>{const{createKringloopwinkelsLayerOL:e}=await import("./kringloopwinkelsOL-CJENjN6Y.js");return{createKringloopwinkelsLayerOL:e}},__vite__mapDeps([16,4]));return n()},immediateLoad:!1},"Fossielen Nederland":{name:"Fossielen Nederland",factory:async()=>{const{createFossielenLayerOL:n}=await dt(async()=>{const{createFossielenLayerOL:e}=await import("./fossielenOL-d04eSUvk.js");return{createFossielenLayerOL:e}},__vite__mapDeps([17,18,4]));return n()},immediateLoad:!1,tier:"premium"},"Fossielen Belgi":{name:"Fossielen Belgi",factory:async()=>{const{createFossielenBelgieLayerOL:n}=await dt(async()=>{const{createFossielenBelgieLayerOL:e}=await import("./fossielenBelgieOL-D_9Dtq6a.js");return{createFossielenBelgieLayerOL:e}},__vite__mapDeps([19,18,4]));return n()},immediateLoad:!1,tier:"premium",regions:["be"]},"Fossielen Duitsland":{name:"Fossielen Duitsland",factory:async()=>{const{createFossielenDuitslandLayerOL:n}=await dt(async()=>{const{createFossielenDuitslandLayerOL:e}=await import("./fossielenDuitslandOL-8s82ByTi.js");return{createFossielenDuitslandLayerOL:e}},__vite__mapDeps([20,18,4]));return n()},immediateLoad:!1,tier:"premium",regions:["de"]},"Fossielen Frankrijk":{name:"Fossielen Frankrijk",factory:async()=>{const{createFossielenFrankrijkLayerOL:n}=await dt(async()=>{const{createFossielenFrankrijkLayerOL:e}=await import("./fossielenFrankrijkOL-BxLldItc.js");return{createFossielenFrankrijkLayerOL:e}},__vite__mapDeps([21,18,4]));return n()},immediateLoad:!1,tier:"premium",regions:["fr"]},"Fossiel Hotspots":{name:"Fossiel Hotspots",factory:async()=>{const{createFossielHotspotsLayerOL:n}=await dt(async()=>{const{createFossielHotspotsLayerOL:e}=await import("./fossielHotspotsOL-BuVpsoJj.js");return{createFossielHotspotsLayerOL:e}},[]);return n()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},"Mineralen Hotspots":{name:"Mineralen Hotspots",factory:async()=>{const{createMineralenHotspotsLayerOL:n}=await dt(async()=>{const{createMineralenHotspotsLayerOL:e}=await import("./mineralenHotspotsOL-DggbepSZ.js");return{createMineralenHotspotsLayerOL:e}},[]);return n()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},Goudrivieren:{name:"Goudrivieren",factory:async()=>{const{createGoudrivierenLayerOL:n}=await dt(async()=>{const{createGoudrivierenLayerOL:e}=await import("./goudrivierenOL-DoxGUZHb.js");return{createGoudrivierenLayerOL:e}},[]);return n()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},Wandelroutes:{name:"Wandelroutes",factory:async()=>{const{createWandelroutesLayer:n}=await dt(async()=>{const{createWandelroutesLayer:e}=await import("./wandelroutesOL-CnRnHOBK.js");return{createWandelroutesLayer:e}},[]);return n()},immediateLoad:!1,tier:"free",regions:["nl","be"]},"WWII Bunkers":{name:"WWII Bunkers",factory:async()=>{const{createBunkersLayerOL:n}=await dt(async()=>{const{createBunkersLayerOL:e}=await import("./bunkersOL-D-bCdWNe.js");return{createBunkersLayerOL:e}},__vite__mapDeps([22,4]));return n()},immediateLoad:!1},Grafheuvels:{name:"Grafheuvels",factory:async()=>{const{createGrafheuvelsLayerOL:n}=await dt(async()=>{const{createGrafheuvelsLayerOL:e}=await import("./grafheuvelsOL-BegDphCB.js");return{createGrafheuvelsLayerOL:e}},__vite__mapDeps([23,4]));return n()},immediateLoad:!1},Slagvelden:{name:"Slagvelden",factory:async()=>{const{createSlagveldenLayerOL:n}=await dt(async()=>{const{createSlagveldenLayerOL:e}=await import("./slagveldenOL-D6ktnLAK.js");return{createSlagveldenLayerOL:e}},__vite__mapDeps([24,4]));return n()},immediateLoad:!1},"Militaire Vliegvelden":{name:"Militaire Vliegvelden",factory:async()=>{const{createVliegveldenLayerOL:n}=await dt(async()=>{const{createVliegveldenLayerOL:e}=await import("./vliegveldenOL-B5tWHunf.js");return{createVliegveldenLayerOL:e}},[]);return n()},immediateLoad:!1}};function YH(){return Object.values(CA).filter(n=>n.immediateLoad)}const As=Ia()(M0((n,e)=>({map:null,rotation:0,rotationEnabled:!0,setMap:t=>{n(r=>{r.map=t})},setRotation:t=>{n(r=>{if(r.rotation=t,r.map&&r.rotationEnabled){const i=t*Math.PI/180;r.map.getView().setRotation(i)}})},enableRotation:()=>{n(t=>{t.rotationEnabled=!0})},disableRotation:()=>{n(t=>{t.rotationEnabled=!1,t.rotation=0,t.map&&t.map.getView().animate({rotation:0,duration:500})})}}))),ii=Ia()(M0((n,e)=>({visible:{"CartoDB (licht)":!0,OpenStreetMap:!1,Luchtfoto:!1,"Labels Overlay":!1,"TMK 1850":!1,"Bonnebladen 1900":!1,Hunebedden:!1,"FAMKE Steentijd":!1,Grafheuvels:!1,Terpen:!1,"AMK Monumenten":!1,"AMK Romeins":!1,"AMK Steentijd":!1,"AMK Vroege ME":!1,"AMK Late ME":!1,"AMK Overig":!1,"Romeinse wegen (regio)":!1,"Romeinse wegen (Wereld)":!1,Kastelen:!1,IKAW:!1,"Archeo Landschappen":!1,Essen:!1,Rijksmonumenten:!1,Werelderfgoed:!1,"WWII Bunkers":!1,Slagvelden:!1,"Militaire Vliegvelden":!1,Verdedigingslinies:!1,Inundatiegebieden:!1,"Militaire Objecten":!1,"Paleokaart 800 n.Chr.":!1,"Paleokaart 100 n.Chr.":!1,"Paleokaart 500 v.Chr.":!1,"Paleokaart 1500 v.Chr.":!1,"Paleokaart 2750 v.Chr.":!1,"Paleokaart 5500 v.Chr.":!1,"Paleokaart 9000 v.Chr.":!1,"Religieus Erfgoed":!1,"UIKAV Punten":!1,"UIKAV Vlakken":!1,"UIKAV Buffer":!1,"UIKAV Expert":!1,"UIKAV Indeling":!1,"AHN4 Hoogtekaart Kleur":!1,"AHN4 Hillshade NL":!1,"AHN4 Multi-Hillshade NL":!1,"AHN 0.5m":!1,Veengebieden:!1,Geomorfologie:!1,Bodemkaart:!1,"Fossielen Nederland":!1,"Fossielen Belgi":!1,"Fossielen Duitsland":!1,"Fossielen Frankrijk":!1,Parken:!1,Speeltuinen:!1,Musea:!1,Strandjes:!1,Gewaspercelen:!1,"Kadastrale Grenzen":!1,Scheepswrakken:!1,"Woonheuvels ZH":!1,"Romeinse Forten":!1,Windmolens:!1,Erfgoedlijnen:!1,"Oude Kernen":!1,"Relictenkaart Punten":!1,"Relictenkaart Lijnen":!1,"Relictenkaart Vlakken":!1,"Verdronken Dorpen":!1,"Mijn Vondsten":!0},opacity:{"AHN4 Hoogtekaart Kleur":.85,"AHN4 Hillshade NL":.7,"AHN4 Multi-Hillshade NL":.7,"AHN 0.5m":.7,"TMK 1850":.8,"Bonnebladen 1900":.8,Geomorfologie:.5,Bodemkaart:.6,Veengebieden:.6,IKAW:.5,"Archeo Landschappen":.5,Essen:.6,Terpen:.7,"Paleokaart 9000 v.Chr.":.7,"Paleokaart 5500 v.Chr.":.7,"Paleokaart 2750 v.Chr.":.7,"Paleokaart 1500 v.Chr.":.7,"Paleokaart 500 v.Chr.":.7,"Paleokaart 100 n.Chr.":.7,"Paleokaart 800 n.Chr.":.7,Verdedigingslinies:.7,Inundatiegebieden:.5,"Militaire Objecten":.8,"Religieus Erfgoed":.8,Gewaspercelen:.6,"Kadastrale Grenzen":.7,Erfgoedlijnen:.7,"Oude Kernen":.6,"Relictenkaart Vlakken":.5},loadingState:{},layers:{},toggleLayer:t=>{const r=e(),i=!r.visible[t];n(s=>{s.visible[t]=i}),i&&!r.layers[t]?e().loadLayer(t):r.layers[t]&&r.layers[t].setVisible(i)},setLayerVisibility:(t,r)=>{const i=e();n(s=>{s.visible[t]=r;const a=s.layers[t];a&&a.setVisible(r)}),r&&!i.layers[t]&&e().loadLayer(t)},setLayerOpacity:(t,r)=>{n(i=>{i.opacity[t]=r;const s=i.layers[t];s&&s.setOpacity(r)})},registerLayer:(t,r)=>{n(i=>{i.layers[t]=r,i.loadingState[t]="loaded",i.visible[t]!==void 0&&r.setVisible(i.visible[t]),i.opacity[t]!==void 0&&r.setOpacity(i.opacity[t])})},unregisterLayer:t=>{n(r=>{delete r.layers[t],delete r.loadingState[t]})},loadLayer:async t=>{const r=e();if(r.loadingState[t]==="loading"||r.layers[t])return;const i=CA[t];if(!i){console.warn(` Layer "${t}" not found in registry`);return}const s=As.getState().map;if(!s){console.warn(` Cannot load layer "${t}": map not initialized`);return}n(a=>{a.loadingState[t]="loading"}),console.log(` Loading layer: ${t}...`);try{const a=await i.factory();if(!a)throw new Error("Factory returned null");const o=e();a.setVisible(o.visible[t]??!1),o.opacity[t]!==void 0&&a.setOpacity(o.opacity[t]),s.addLayer(a),n(l=>{l.layers[t]=a,l.loadingState[t]="loaded"}),console.log(` Layer loaded: ${t}`)}catch(a){console.error(` Failed to load layer "${t}":`,a),n(o=>{o.loadingState[t]="error"})}}}))),Fi=Ia()(M0((n,e)=>({layerControlOpen:!1,legendOpen:!1,backgroundsPanelOpen:!1,themesPanelOpen:!1,settingsPanelOpen:!1,infoPanelOpen:!1,presetsPanelOpen:!1,vondstFormOpen:!1,vondstFormLocation:null,vondstDashboardOpen:!1,createLayerModalOpen:!1,addPointModalOpen:!1,addPointModalLayerId:null,addPointModalLocation:null,layerManagerModalOpen:!1,layerDashboardOpen:!1,layerDashboardLayerId:null,collapsedCategories:new Set,closeAllPanels:()=>{n(t=>{t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1})},toggleLayerControl:()=>{n(t=>{t.layerControlOpen=!t.layerControlOpen})},toggleLegend:()=>{n(t=>{t.legendOpen=!t.legendOpen})},toggleBackgroundsPanel:()=>{n(t=>{const r=t.backgroundsPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,r||(t.backgroundsPanelOpen=!0)})},toggleThemesPanel:()=>{n(t=>{const r=t.themesPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,r||(t.themesPanelOpen=!0)})},toggleSettingsPanel:()=>{n(t=>{const r=t.settingsPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,r||(t.settingsPanelOpen=!0)})},toggleInfoPanel:()=>{n(t=>{const r=t.infoPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,r||(t.infoPanelOpen=!0)})},togglePresetsPanel:()=>{n(t=>{const r=t.presetsPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,r||(t.presetsPanelOpen=!0)})},toggleCategory:t=>{n(r=>{r.collapsedCategories.has(t)?r.collapsedCategories.delete(t):r.collapsedCategories.add(t)})},setLayerControlOpen:t=>{n(r=>{r.layerControlOpen=t})},setLegendOpen:t=>{n(r=>{r.legendOpen=t})},openVondstForm:t=>{n(r=>{r.backgroundsPanelOpen=!1,r.themesPanelOpen=!1,r.settingsPanelOpen=!1,r.infoPanelOpen=!1,r.presetsPanelOpen=!1,r.vondstFormOpen=!0,r.vondstFormLocation=t||null})},closeVondstForm:()=>{n(t=>{t.vondstFormOpen=!1,t.vondstFormLocation=null})},toggleVondstDashboard:()=>{n(t=>{const r=t.vondstDashboardOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,t.vondstDashboardOpen=!r})},openCreateLayerModal:()=>{n(t=>{t.createLayerModalOpen=!0})},closeCreateLayerModal:()=>{n(t=>{t.createLayerModalOpen=!1})},openAddPointModal:(t,r)=>{n(i=>{i.addPointModalOpen=!0,i.addPointModalLayerId=t,i.addPointModalLocation=r})},closeAddPointModal:()=>{n(t=>{t.addPointModalOpen=!1,t.addPointModalLayerId=null,t.addPointModalLocation=null})},openLayerManagerModal:()=>{n(t=>{t.layerManagerModalOpen=!0})},closeLayerManagerModal:()=>{n(t=>{t.layerManagerModalOpen=!1})},openLayerDashboard:t=>{n(r=>{r.layerDashboardOpen=!0,r.layerDashboardLayerId=t,r.layerManagerModalOpen=!1})},closeLayerDashboard:()=>{n(t=>{t.layerDashboardOpen=!1,t.layerDashboardLayerId=null})}}))),XH=()=>{};var $k={};const SD=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},qH=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=n[t++],a=n[t++],o=n[t++],l=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=n[t++],a=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},TD={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const s=n[i],a=i+1<n.length,o=a?n[i+1]:0,l=i+2<n.length,u=l?n[i+2]:0,h=s>>2,f=(s&3)<<4|o>>4;let g=(o&15)<<2|u>>6,p=u&63;l||(p=64,a||(g=64)),r.push(t[h],t[f],t[g],t[p])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(SD(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):qH(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const s=t[n.charAt(i++)],o=i<n.length?t[n.charAt(i)]:0;++i;const u=i<n.length?t[n.charAt(i)]:64;++i;const f=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||o==null||u==null||f==null)throw new ZH;const g=s<<2|o>>4;if(r.push(g),u!==64){const p=o<<4&240|u>>2;if(r.push(p),f!==64){const E=u<<6&192|f;r.push(E)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class ZH extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const QH=function(n){const e=SD(n);return TD.encodeByteArray(e,!0)},_x=function(n){return QH(n).replace(/\./g,"")},ID=function(n){try{return TD.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function AD(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const JH=()=>AD().__FIREBASE_DEFAULTS__,eK=()=>{if(typeof process>"u"||typeof $k>"u")return;const n=$k.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},tK=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&ID(n[1]);return e&&JSON.parse(e)},Yv=()=>{try{return XH()||JH()||eK()||tK()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},bD=n=>Yv()?.emulatorHosts?.[n],RD=n=>{const e=bD(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},CD=()=>Yv()?.config,PD=n=>Yv()?.[`_${n}`];class nK{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function od(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function PA(n){return(await fetch(n,{credentials:"include"})).ok}function kD(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...n};return[_x(JSON.stringify(t)),_x(JSON.stringify(a)),""].join(".")}const dm={};function rK(){const n={prod:[],emulator:[]};for(const e of Object.keys(dm))dm[e]?n.emulator.push(e):n.prod.push(e);return n}function iK(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let Wk=!1;function kA(n,e){if(typeof window>"u"||typeof document>"u"||!od(window.location.host)||dm[n]===e||dm[n]||Wk)return;dm[n]=e;function t(g){return`__firebase__banner__${g}`}const r="__firebase__banner",s=rK().prod.length>0;function a(){const g=document.getElementById(r);g&&g.remove()}function o(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function l(g,p){g.setAttribute("width","24"),g.setAttribute("id",p),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function u(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{Wk=!0,a()},g}function h(g,p){g.setAttribute("id",p),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function f(){const g=iK(r),p=t("text"),E=document.getElementById(p)||document.createElement("span"),x=t("learnmore"),w=document.getElementById(x)||document.createElement("a"),T=t("preprendIcon"),I=document.getElementById(T)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const P=g.element;o(P),h(w,x);const N=u();l(I,T),P.append(I,E,w,N),document.body.appendChild(P)}s?(E.innerText="Preview backend disconnected.",I.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(I.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,E.innerText="Preview backend running in this workspace."),E.setAttribute("id",p)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}function Kr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function sK(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Kr())}function MD(){const n=Yv()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function aK(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function oK(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function lK(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function cK(){const n=Kr();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function ND(){return!MD()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function LD(){return!MD()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function OD(){try{return typeof indexedDB=="object"}catch{return!1}}function uK(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(t){e(t)}})}const hK="FirebaseError";class Qo extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=hK,Object.setPrototypeOf(this,Qo.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Jp.prototype.create)}}class Jp{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?dK(s,r):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new Qo(i,o,r)}}function dK(n,e){return n.replace(fK,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const fK=/\{\$([^}]+)}/g;function gK(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Vh(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const s=n[i],a=e[i];if(Hk(s)&&Hk(a)){if(!Vh(s,a))return!1}else if(s!==a)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function Hk(n){return n!==null&&typeof n=="object"}function e1(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function mK(n,e){const t=new pK(n,e);return t.subscribe.bind(t)}class pK{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");yK(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=Q2),i.error===void 0&&(i.error=Q2),i.complete===void 0&&(i.complete=Q2);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function yK(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Q2(){}function li(n){return n&&n._delegate?n._delegate:n}class su{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const th="[DEFAULT]";class _K{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new nK;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(vK(e))try{this.getOrInitializeService({instanceIdentifier:th})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=th){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=th){return this.instances.has(e)}getOptions(e=th){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);r===o&&a.resolve(i)}return i}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:xK(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=th){return this.component?this.component.multipleInstances?e:th:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function xK(n){return n===th?void 0:n}function vK(n){return n.instantiationMode==="EAGER"}class EK{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new _K(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var rn;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(rn||(rn={}));const wK={debug:rn.DEBUG,verbose:rn.VERBOSE,info:rn.INFO,warn:rn.WARN,error:rn.ERROR,silent:rn.SILENT},SK=rn.INFO,TK={[rn.DEBUG]:"log",[rn.VERBOSE]:"log",[rn.INFO]:"info",[rn.WARN]:"warn",[rn.ERROR]:"error"},IK=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=TK[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class MA{constructor(e){this.name=e,this._logLevel=SK,this._logHandler=IK,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in rn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?wK[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,rn.DEBUG,...e),this._logHandler(this,rn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,rn.VERBOSE,...e),this._logHandler(this,rn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,rn.INFO,...e),this._logHandler(this,rn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,rn.WARN,...e),this._logHandler(this,rn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,rn.ERROR,...e),this._logHandler(this,rn.ERROR,...e)}}const AK=(n,e)=>e.some(t=>n instanceof t);let Kk,Yk;function bK(){return Kk||(Kk=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function RK(){return Yk||(Yk=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const DD=new WeakMap,ET=new WeakMap,FD=new WeakMap,J2=new WeakMap,NA=new WeakMap;function CK(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",a)},s=()=>{t(qc(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&DD.set(t,n)}).catch(()=>{}),NA.set(e,n),e}function PK(n){if(ET.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",a),n.removeEventListener("abort",a)},s=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",a),n.addEventListener("abort",a)});ET.set(n,e)}let wT={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return ET.get(n);if(e==="objectStoreNames")return n.objectStoreNames||FD.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return qc(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function kK(n){wT=n(wT)}function MK(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(eS(this),e,...t);return FD.set(r,e.sort?e.sort():[e]),qc(r)}:RK().includes(n)?function(...e){return n.apply(eS(this),e),qc(DD.get(this))}:function(...e){return qc(n.apply(eS(this),e))}}function NK(n){return typeof n=="function"?MK(n):(n instanceof IDBTransaction&&PK(n),AK(n,bK())?new Proxy(n,wT):n)}function qc(n){if(n instanceof IDBRequest)return CK(n);if(J2.has(n))return J2.get(n);const e=NK(n);return e!==n&&(J2.set(n,e),NA.set(e,n)),e}const eS=n=>NA.get(n);function LK(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){const a=indexedDB.open(n,e),o=qc(a);return r&&a.addEventListener("upgradeneeded",l=>{r(qc(a.result),l.oldVersion,l.newVersion,qc(a.transaction),l)}),t&&a.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),o.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),o}const OK=["get","getKey","getAll","getAllKeys","count"],DK=["put","add","delete","clear"],tS=new Map;function Xk(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(tS.get(e))return tS.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=DK.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||OK.includes(t)))return;const s=async function(a,...o){const l=this.transaction(a,i?"readwrite":"readonly");let u=l.store;return r&&(u=u.index(o.shift())),(await Promise.all([u[t](...o),i&&l.done]))[0]};return tS.set(e,s),s}kK(n=>({...n,get:(e,t,r)=>Xk(e,t)||n.get(e,t,r),has:(e,t)=>!!Xk(e,t)||n.has(e,t)}));class FK{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(jK(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function jK(n){return n.getComponent()?.type==="VERSION"}const ST="@firebase/app",qk="0.14.6";const Fl=new MA("@firebase/app"),VK="@firebase/app-compat",GK="@firebase/analytics-compat",BK="@firebase/analytics",UK="@firebase/app-check-compat",zK="@firebase/app-check",$K="@firebase/auth",WK="@firebase/auth-compat",HK="@firebase/database",KK="@firebase/data-connect",YK="@firebase/database-compat",XK="@firebase/functions",qK="@firebase/functions-compat",ZK="@firebase/installations",QK="@firebase/installations-compat",JK="@firebase/messaging",eY="@firebase/messaging-compat",tY="@firebase/performance",nY="@firebase/performance-compat",rY="@firebase/remote-config",iY="@firebase/remote-config-compat",sY="@firebase/storage",aY="@firebase/storage-compat",oY="@firebase/firestore",lY="@firebase/ai",cY="@firebase/firestore-compat",uY="firebase",hY="12.6.0";const TT="[DEFAULT]",dY={[ST]:"fire-core",[VK]:"fire-core-compat",[BK]:"fire-analytics",[GK]:"fire-analytics-compat",[zK]:"fire-app-check",[UK]:"fire-app-check-compat",[$K]:"fire-auth",[WK]:"fire-auth-compat",[HK]:"fire-rtdb",[KK]:"fire-data-connect",[YK]:"fire-rtdb-compat",[XK]:"fire-fn",[qK]:"fire-fn-compat",[ZK]:"fire-iid",[QK]:"fire-iid-compat",[JK]:"fire-fcm",[eY]:"fire-fcm-compat",[tY]:"fire-perf",[nY]:"fire-perf-compat",[rY]:"fire-rc",[iY]:"fire-rc-compat",[sY]:"fire-gcs",[aY]:"fire-gcs-compat",[oY]:"fire-fst",[cY]:"fire-fst-compat",[lY]:"fire-vertex","fire-js":"fire-js",[uY]:"fire-js-all"};const xx=new Map,fY=new Map,IT=new Map;function Zk(n,e){try{n.container.addComponent(e)}catch(t){Fl.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Gh(n){const e=n.name;if(IT.has(e))return Fl.debug(`There were multiple attempts to register component ${e}.`),!1;IT.set(e,n);for(const t of xx.values())Zk(t,n);for(const t of fY.values())Zk(t,n);return!0}function Xv(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Hs(n){return n==null?!1:n.settings!==void 0}const gY={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Zc=new Jp("app","Firebase",gY);class mY{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new su("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Zc.create("app-deleted",{appName:this._name})}}const ld=hY;function jD(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:TT,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw Zc.create("bad-app-name",{appName:String(i)});if(t||(t=CD()),!t)throw Zc.create("no-options");const s=xx.get(i);if(s){if(Vh(t,s.options)&&Vh(r,s.config))return s;throw Zc.create("duplicate-app",{appName:i})}const a=new EK(i);for(const l of IT.values())a.addComponent(l);const o=new mY(t,r,a);return xx.set(i,o),o}function LA(n=TT){const e=xx.get(n);if(!e&&n===TT&&CD())return jD();if(!e)throw Zc.create("no-app",{appName:n});return e}function No(n,e,t){let r=dY[n]??n;t&&(r+=`-${t}`);const i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){const a=[`Unable to register library "${r}" with version "${e}":`];i&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&a.push("and"),s&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Fl.warn(a.join(" "));return}Gh(new su(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}const pY="firebase-heartbeat-database",yY=1,np="firebase-heartbeat-store";let nS=null;function VD(){return nS||(nS=LK(pY,yY,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(np)}catch(t){console.warn(t)}}}}).catch(n=>{throw Zc.create("idb-open",{originalErrorMessage:n.message})})),nS}async function _Y(n){try{const t=(await VD()).transaction(np),r=await t.objectStore(np).get(GD(n));return await t.done,r}catch(e){if(e instanceof Qo)Fl.warn(e.message);else{const t=Zc.create("idb-get",{originalErrorMessage:e?.message});Fl.warn(t.message)}}}async function Qk(n,e){try{const r=(await VD()).transaction(np,"readwrite");await r.objectStore(np).put(e,GD(n)),await r.done}catch(t){if(t instanceof Qo)Fl.warn(t.message);else{const r=Zc.create("idb-set",{originalErrorMessage:t?.message});Fl.warn(r.message)}}}function GD(n){return`${n.name}!${n.options.appId}`}const xY=1024,vY=30;class EY{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new SY(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Jk();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>vY){const i=TY(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Fl.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Jk(),{heartbeatsToSend:t,unsentEntries:r}=wY(this._heartbeatsCache.heartbeats),i=_x(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return Fl.warn(e),""}}}function Jk(){return new Date().toISOString().substring(0,10)}function wY(n,e=xY){const t=[];let r=n.slice();for(const i of n){const s=t.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),eM(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),eM(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class SY{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return OD()?uK().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await _Y(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Qk(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Qk(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function eM(n){return _x(JSON.stringify({version:2,heartbeats:n})).length}function TY(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function IY(n){Gh(new su("platform-logger",e=>new FK(e),"PRIVATE")),Gh(new su("heartbeat",e=>new EY(e),"PRIVATE")),No(ST,qk,n),No(ST,qk,"esm2020"),No("fire-js","")}IY("");function BD(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const AY=BD,UD=new Jp("auth","Firebase",BD());const vx=new MA("@firebase/auth");function bY(n,...e){vx.logLevel<=rn.WARN&&vx.warn(`Auth (${ld}): ${n}`,...e)}function I_(n,...e){vx.logLevel<=rn.ERROR&&vx.error(`Auth (${ld}): ${n}`,...e)}function $o(n,...e){throw DA(n,...e)}function Za(n,...e){return DA(n,...e)}function OA(n,e,t){const r={...AY(),[e]:t};return new Jp("auth","Firebase",r).create(e,{appName:n.name})}function Qc(n){return OA(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function RY(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&$o(n,"argument-error"),OA(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function DA(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return UD.create(n,...e)}function Bt(n,e,...t){if(!n)throw DA(e,...t)}function vl(n){const e="INTERNAL ASSERTION FAILED: "+n;throw I_(e),new Error(e)}function jl(n,e){n||vl(e)}function AT(){return typeof self<"u"&&self.location?.href||""}function CY(){return tM()==="http:"||tM()==="https:"}function tM(){return typeof self<"u"&&self.location?.protocol||null}function PY(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(CY()||oK()||"connection"in navigator)?navigator.onLine:!0}function kY(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class t1{constructor(e,t){this.shortDelay=e,this.longDelay=t,jl(t>e,"Short delay should be less than long delay!"),this.isMobile=sK()||lK()}get(){return PY()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function FA(n,e){jl(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class zD{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;vl("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;vl("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;vl("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const MY={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const NY=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],LY=new t1(3e4,6e4);function qv(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function N0(n,e,t,r,i={}){return $D(n,i,async()=>{let s={},a={};r&&(e==="GET"?a=r:s={body:JSON.stringify(r)});const o=e1({key:n.config.apiKey,...a}).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const u={method:e,headers:l,...s};return aK()||(u.referrerPolicy="no-referrer"),n.emulatorConfig&&od(n.emulatorConfig.host)&&(u.credentials="include"),zD.fetch()(await HD(n,n.config.apiHost,t,o),u)})}async function $D(n,e,t){n._canInitEmulator=!1;const r={...MY,...e};try{const i=new OY(n),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw Yy(n,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const o=s.ok?a.errorMessage:a.error.message,[l,u]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Yy(n,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw Yy(n,"email-already-in-use",a);if(l==="USER_DISABLED")throw Yy(n,"user-disabled",a);const h=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw OA(n,h,u);$o(n,h)}}catch(i){if(i instanceof Qo)throw i;$o(n,"network-request-failed",{message:String(i)})}}async function WD(n,e,t,r,i={}){const s=await N0(n,e,t,r,i);return"mfaPendingCredential"in s&&$o(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function HD(n,e,t,r){const i=`${e}${t}?${r}`,s=n,a=s.config.emulator?FA(n.config,i):`${n.config.apiScheme}://${i}`;return NY.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(a).toString():a}class OY{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Za(this.auth,"network-request-failed")),LY.get())})}}function Yy(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=Za(n,e,r);return i.customData._tokenResponse=t,i}async function DY(n,e){return N0(n,"POST","/v1/accounts:delete",e)}async function Ex(n,e){return N0(n,"POST","/v1/accounts:lookup",e)}function fm(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function FY(n,e=!1){const t=li(n),r=await t.getIdToken(e),i=jA(r);Bt(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s?.sign_in_provider;return{claims:i,token:r,authTime:fm(rS(i.auth_time)),issuedAtTime:fm(rS(i.iat)),expirationTime:fm(rS(i.exp)),signInProvider:a||null,signInSecondFactor:s?.sign_in_second_factor||null}}function rS(n){return Number(n)*1e3}function jA(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return I_("JWT malformed, contained fewer than 3 sections"),null;try{const i=ID(t);return i?JSON.parse(i):(I_("Failed to decode base64 JWT payload"),null)}catch(i){return I_("Caught error parsing JWT payload as JSON",i?.toString()),null}}function nM(n){const e=jA(n);return Bt(e,"internal-error"),Bt(typeof e.exp<"u","internal-error"),Bt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function rp(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Qo&&jY(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function jY({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class VY{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class bT{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=fm(this.lastLoginAt),this.creationTime=fm(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function wx(n){const e=n.auth,t=await n.getIdToken(),r=await rp(n,Ex(e,{idToken:t}));Bt(r?.users.length,e,"internal-error");const i=r.users[0];n._notifyReloadListener(i);const s=i.providerUserInfo?.length?KD(i.providerUserInfo):[],a=BY(n.providerData,s),o=n.isAnonymous,l=!(n.email&&i.passwordHash)&&!a?.length,u=o?l:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new bT(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(n,h)}async function GY(n){const e=li(n);await wx(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function BY(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function KD(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function UY(n,e){const t=await $D(n,{},async()=>{const r=e1({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,a=await HD(n,i,"/v1/token",`key=${s}`),o=await n._getAdditionalHeaders();o["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:o,body:r};return n.emulatorConfig&&od(n.emulatorConfig.host)&&(l.credentials="include"),zD.fetch()(a,l)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function zY(n,e){return N0(n,"POST","/v2/accounts:revokeToken",qv(n,e))}class Gf{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Bt(e.idToken,"internal-error"),Bt(typeof e.idToken<"u","internal-error"),Bt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):nM(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Bt(e.length!==0,"internal-error");const t=nM(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Bt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:s}=await UY(e,t);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:s}=t,a=new Gf;return r&&(Bt(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(Bt(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(Bt(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Gf,this.toJSON())}_performRefresh(){return vl("not implemented")}}function Sc(n,e){Bt(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Ha{constructor({uid:e,auth:t,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new VY(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new bT(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await rp(this,this.stsTokenManager.getToken(this.auth,e));return Bt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return FY(this,e)}reload(){return GY(this)}_assign(e){this!==e&&(Bt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Ha({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Bt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await wx(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Hs(this.auth.app))return Promise.reject(Qc(this.auth));const e=await this.getIdToken();return await rp(this,DY(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,i=t.email??void 0,s=t.phoneNumber??void 0,a=t.photoURL??void 0,o=t.tenantId??void 0,l=t._redirectEventId??void 0,u=t.createdAt??void 0,h=t.lastLoginAt??void 0,{uid:f,emailVerified:g,isAnonymous:p,providerData:E,stsTokenManager:x}=t;Bt(f&&x,e,"internal-error");const w=Gf.fromJSON(this.name,x);Bt(typeof f=="string",e,"internal-error"),Sc(r,e.name),Sc(i,e.name),Bt(typeof g=="boolean",e,"internal-error"),Bt(typeof p=="boolean",e,"internal-error"),Sc(s,e.name),Sc(a,e.name),Sc(o,e.name),Sc(l,e.name),Sc(u,e.name),Sc(h,e.name);const T=new Ha({uid:f,auth:e,email:i,emailVerified:g,displayName:r,isAnonymous:p,photoURL:a,phoneNumber:s,tenantId:o,stsTokenManager:w,createdAt:u,lastLoginAt:h});return E&&Array.isArray(E)&&(T.providerData=E.map(I=>({...I}))),l&&(T._redirectEventId=l),T}static async _fromIdTokenResponse(e,t,r=!1){const i=new Gf;i.updateFromServerResponse(t);const s=new Ha({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await wx(s),s}static async _fromGetAccountInfoResponse(e,t,r){const i=t.users[0];Bt(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?KD(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!s?.length,o=new Gf;o.updateFromIdToken(r);const l=new Ha({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:a}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new bT(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(l,u),l}}const rM=new Map;function El(n){jl(n instanceof Function,"Expected a class definition");let e=rM.get(n);return e?(jl(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,rM.set(n,e),e)}class YD{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}YD.type="NONE";const iM=YD;function A_(n,e,t){return`firebase:${n}:${e}:${t}`}class Bf{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=A_(this.userKey,i.apiKey,s),this.fullPersistenceKey=A_("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Ex(this.auth,{idToken:e}).catch(()=>{});return t?Ha._fromGetAccountInfoResponse(this.auth,t,e):null}return Ha._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Bf(El(iM),e,r);const i=(await Promise.all(t.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let s=i[0]||El(iM);const a=A_(r,e.config.apiKey,e.name);let o=null;for(const u of t)try{const h=await u._get(a);if(h){let f;if(typeof h=="string"){const g=await Ex(e,{idToken:h}).catch(()=>{});if(!g)break;f=await Ha._fromGetAccountInfoResponse(e,g,h)}else f=Ha._fromJSON(e,h);u!==s&&(o=f),s=u;break}}catch{}const l=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new Bf(s,e,r):(s=l[0],o&&await s._set(a,o.toJSON()),await Promise.all(t.map(async u=>{if(u!==s)try{await u._remove(a)}catch{}})),new Bf(s,e,r))}}function sM(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(QD(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(XD(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(e6(e))return"Blackberry";if(t6(e))return"Webos";if(qD(e))return"Safari";if((e.includes("chrome/")||ZD(e))&&!e.includes("edge/"))return"Chrome";if(JD(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function XD(n=Kr()){return/firefox\//i.test(n)}function qD(n=Kr()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function ZD(n=Kr()){return/crios\//i.test(n)}function QD(n=Kr()){return/iemobile/i.test(n)}function JD(n=Kr()){return/android/i.test(n)}function e6(n=Kr()){return/blackberry/i.test(n)}function t6(n=Kr()){return/webos/i.test(n)}function VA(n=Kr()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function $Y(n=Kr()){return VA(n)&&!!window.navigator?.standalone}function WY(){return cK()&&document.documentMode===10}function n6(n=Kr()){return VA(n)||JD(n)||t6(n)||e6(n)||/windows phone/i.test(n)||QD(n)}function r6(n,e=[]){let t;switch(n){case"Browser":t=sM(Kr());break;case"Worker":t=`${sM(Kr())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${ld}/${r}`}class HY{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=s=>new Promise((a,o)=>{try{const l=e(s);a(l)}catch(l){o(l)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function KY(n,e={}){return N0(n,"GET","/v2/passwordPolicy",qv(n,e))}const YY=6;class XY{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??YY,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class qY{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new aM(this),this.idTokenSubscription=new aM(this),this.beforeStateQueue=new HY(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=UD,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=El(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Bf.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Ex(this,{idToken:e}),r=await Ha._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Hs(this.app)){const s=this.app.settings.authIdToken;return s?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(a,a))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const s=this.redirectUser?._redirectEventId,a=r?._redirectEventId,o=await this.tryRedirectSignIn(e);(!s||s===a)&&o?.user&&(r=o.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(s){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Bt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await wx(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=kY()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Hs(this.app))return Promise.reject(Qc(this));const t=e?li(e):null;return t&&Bt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Bt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Hs(this.app)?Promise.reject(Qc(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Hs(this.app)?Promise.reject(Qc(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(El(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await KY(this),t=new XY(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Jp("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await zY(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&El(e)||this._popupRedirectResolver;Bt(t,this,"argument-error"),this.redirectPersistenceManager=await Bf.create(this,[El(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Bt(o,this,"internal-error"),o.then(()=>{a||s(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,r,i);return()=>{a=!0,l()}}else{const l=e.addObserver(t);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Bt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=r6(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(Hs(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&bY(`Error while retrieving App Check token: ${e.error}`),e?.token}}function n1(n){return li(n)}class aM{constructor(e){this.auth=e,this.observer=null,this.addObserver=mK(t=>this.observer=t)}get next(){return Bt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let GA={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function ZY(n){GA=n}function QY(n){return GA.loadJS(n)}function JY(){return GA.gapiScript}function eX(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function tX(n,e){const t=Xv(n,"auth");if(t.isInitialized()){const i=t.getImmediate(),s=t.getOptions();if(Vh(s,e??{}))return i;$o(i,"already-initialized")}return t.initialize({options:e})}function nX(n,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(El);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function rX(n,e,t){const r=n1(n);Bt(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=i6(e),{host:a,port:o}=iX(e),l=o===null?"":`:${o}`,u={url:`${s}//${a}${l}/`},h=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){Bt(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Bt(Vh(u,r.config.emulator)&&Vh(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=u,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,od(a)?(PA(`${s}//${a}${l}`),kA("Auth",!0)):sX()}function i6(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function iX(n){const e=i6(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:oM(r.substr(s.length+1))}}else{const[s,a]=r.split(":");return{host:s,port:oM(a)}}}function oM(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function sX(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class s6{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return vl("not implemented")}_getIdTokenResponse(e){return vl("not implemented")}_linkToIdToken(e,t){return vl("not implemented")}_getReauthenticationResolver(e){return vl("not implemented")}}async function Uf(n,e){return WD(n,"POST","/v1/accounts:signInWithIdp",qv(n,e))}const aX="http://localhost";class Bh extends s6{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Bh(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):$o("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...s}=t;if(!r||!i)return null;const a=new Bh(r,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const t=this.buildRequest();return Uf(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Uf(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Uf(e,t)}buildRequest(){const e={requestUri:aX,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=e1(t)}return e}}class BA{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class r1 extends BA{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Nc extends r1{constructor(){super("facebook.com")}static credential(e){return Bh._fromParams({providerId:Nc.PROVIDER_ID,signInMethod:Nc.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Nc.credentialFromTaggedObject(e)}static credentialFromError(e){return Nc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Nc.credential(e.oauthAccessToken)}catch{return null}}}Nc.FACEBOOK_SIGN_IN_METHOD="facebook.com";Nc.PROVIDER_ID="facebook.com";class xl extends r1{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Bh._fromParams({providerId:xl.PROVIDER_ID,signInMethod:xl.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return xl.credentialFromTaggedObject(e)}static credentialFromError(e){return xl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return xl.credential(t,r)}catch{return null}}}xl.GOOGLE_SIGN_IN_METHOD="google.com";xl.PROVIDER_ID="google.com";class Lc extends r1{constructor(){super("github.com")}static credential(e){return Bh._fromParams({providerId:Lc.PROVIDER_ID,signInMethod:Lc.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Lc.credentialFromTaggedObject(e)}static credentialFromError(e){return Lc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Lc.credential(e.oauthAccessToken)}catch{return null}}}Lc.GITHUB_SIGN_IN_METHOD="github.com";Lc.PROVIDER_ID="github.com";class Oc extends r1{constructor(){super("twitter.com")}static credential(e,t){return Bh._fromParams({providerId:Oc.PROVIDER_ID,signInMethod:Oc.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Oc.credentialFromTaggedObject(e)}static credentialFromError(e){return Oc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return Oc.credential(t,r)}catch{return null}}}Oc.TWITTER_SIGN_IN_METHOD="twitter.com";Oc.PROVIDER_ID="twitter.com";async function oX(n,e){return WD(n,"POST","/v1/accounts:signUp",qv(n,e))}class au{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const s=await Ha._fromIdTokenResponse(e,r,i),a=lM(r);return new au({user:s,providerId:a,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=lM(r);return new au({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function lM(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}async function lX(n){if(Hs(n.app))return Promise.reject(Qc(n));const e=n1(n);if(await e._initializationPromise,e.currentUser?.isAnonymous)return new au({user:e.currentUser,providerId:null,operationType:"signIn"});const t=await oX(e,{returnSecureToken:!0}),r=await au._fromIdTokenResponse(e,"signIn",t,!0);return await e._updateCurrentUser(r.user),r}class Sx extends Qo{constructor(e,t,r,i){super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,Sx.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new Sx(e,t,r,i)}}function a6(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Sx._fromErrorAndOperation(n,s,e,r):s})}async function cX(n,e,t=!1){const r=await rp(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return au._forOperation(n,"link",r)}async function uX(n,e,t=!1){const{auth:r}=n;if(Hs(r.app))return Promise.reject(Qc(r));const i="reauthenticate";try{const s=await rp(n,a6(r,i,e,n),t);Bt(s.idToken,r,"internal-error");const a=jA(s.idToken);Bt(a,r,"internal-error");const{sub:o}=a;return Bt(n.uid===o,r,"user-mismatch"),au._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&$o(r,"user-mismatch"),s}}async function hX(n,e,t=!1){if(Hs(n.app))return Promise.reject(Qc(n));const r="signIn",i=await a6(n,r,e),s=await au._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(s.user),s}function dX(n,e,t,r){return li(n).onIdTokenChanged(e,t,r)}function fX(n,e,t){return li(n).beforeAuthStateChanged(e,t)}function o6(n,e,t,r){return li(n).onAuthStateChanged(e,t,r)}function l6(n){return li(n).signOut()}const Tx="__sak";class c6{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Tx,"1"),this.storage.removeItem(Tx),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const gX=1e3,mX=10;class u6 extends c6{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=n6(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const r=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(r);!t&&this.localCache[r]===a||this.notifyListeners(r,a)},s=this.storage.getItem(r);WY()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,mX):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},gX)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}u6.type="LOCAL";const pX=u6;class h6 extends c6{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}h6.type="SESSION";const d6=h6;function yX(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class Zv{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new Zv(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:s}=t.data,a=this.handlersMap[i];if(!a?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const o=Array.from(a).map(async u=>u(t.origin,s)),l=await yX(o);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Zv.receivers=[];function UA(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}class _X{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((o,l)=>{const u=UA("",20);i.port1.start();const h=setTimeout(()=>{l(new Error("unsupported_event"))},r);a={messageChannel:i,onMessage(f){const g=f;if(g.data.eventId===u)switch(g.data.status){case"ack":clearTimeout(h),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),o(g.data.response);break;default:clearTimeout(h),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:u,data:t},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}function Lo(){return window}function xX(n){Lo().location.href=n}function f6(){return typeof Lo().WorkerGlobalScope<"u"&&typeof Lo().importScripts=="function"}async function vX(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function EX(){return navigator?.serviceWorker?.controller||null}function wX(){return f6()?self:null}const g6="firebaseLocalStorageDb",SX=1,Ix="firebaseLocalStorage",m6="fbase_key";class i1{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Qv(n,e){return n.transaction([Ix],e?"readwrite":"readonly").objectStore(Ix)}function TX(){const n=indexedDB.deleteDatabase(g6);return new i1(n).toPromise()}function RT(){const n=indexedDB.open(g6,SX);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(Ix,{keyPath:m6})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(Ix)?e(r):(r.close(),await TX(),e(await RT()))})})}async function cM(n,e,t){const r=Qv(n,!0).put({[m6]:e,value:t});return new i1(r).toPromise()}async function IX(n,e){const t=Qv(n,!1).get(e),r=await new i1(t).toPromise();return r===void 0?null:r.value}function uM(n,e){const t=Qv(n,!0).delete(e);return new i1(t).toPromise()}const AX=800,bX=3;class p6{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await RT(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>bX)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return f6()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Zv._getInstance(wX()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await vX(),!this.activeServiceWorker)return;this.sender=new _X(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||EX()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await RT();return await cM(e,Tx,"1"),await uM(e,Tx),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>cM(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>IX(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>uM(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=Qv(i,!1).getAll();return new i1(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),AX)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}p6.type="LOCAL";const RX=p6;new t1(3e4,6e4);function y6(n,e){return e?El(e):(Bt(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class zA extends s6{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Uf(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Uf(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Uf(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function CX(n){return hX(n.auth,new zA(n),n.bypassAuthState)}function PX(n){const{auth:e,user:t}=n;return Bt(t,e,"internal-error"),uX(t,new zA(n),n.bypassAuthState)}async function kX(n){const{auth:e,user:t}=n;return Bt(t,e,"internal-error"),cX(t,new zA(n),n.bypassAuthState)}class _6{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:a,type:o}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return CX;case"linkViaPopup":case"linkViaRedirect":return kX;case"reauthViaPopup":case"reauthViaRedirect":return PX;default:$o(this.auth,"internal-error")}}resolve(e){jl(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){jl(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const MX=new t1(2e3,1e4);async function NX(n,e,t){if(Hs(n.app))return Promise.reject(Za(n,"operation-not-supported-in-this-environment"));const r=n1(n);RY(n,e,BA);const i=y6(r,t);return new yh(r,"signInViaPopup",e,i).executeNotNull()}class yh extends _6{constructor(e,t,r,i,s){super(e,t,i,s),this.provider=r,this.authWindow=null,this.pollId=null,yh.currentPopupAction&&yh.currentPopupAction.cancel(),yh.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Bt(e,this.auth,"internal-error"),e}async onExecution(){jl(this.filter.length===1,"Popup operations only handle one event");const e=UA();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Za(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Za(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,yh.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Za(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,MX.get())};e()}}yh.currentPopupAction=null;const LX="pendingRedirect",b_=new Map;class OX extends _6{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=b_.get(this.auth._key());if(!e){try{const r=await DX(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}b_.set(this.auth._key(),e)}return this.bypassAuthState||b_.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function DX(n,e){const t=VX(e),r=jX(n);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}function FX(n,e){b_.set(n._key(),e)}function jX(n){return El(n._redirectPersistence)}function VX(n){return A_(LX,n.config.apiKey,n.name)}async function GX(n,e,t=!1){if(Hs(n.app))return Promise.reject(Qc(n));const r=n1(n),i=y6(r,e),a=await new OX(r,i,t).execute();return a&&!t&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}const BX=600*1e3;class UX{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!zX(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!x6(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Za(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=BX&&this.cachedEventUids.clear(),this.cachedEventUids.has(hM(e))}saveEventToCache(e){this.cachedEventUids.add(hM(e)),this.lastProcessedEventTime=Date.now()}}function hM(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function x6({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function zX(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return x6(n);default:return!1}}async function $X(n,e={}){return N0(n,"GET","/v1/projects",e)}const WX=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,HX=/^https?/;async function KX(n){if(n.config.emulator)return;const{authorizedDomains:e}=await $X(n);for(const t of e)try{if(YX(t))return}catch{}$o(n,"unauthorized-domain")}function YX(n){const e=AT(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!HX.test(t))return!1;if(WX.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const XX=new t1(3e4,6e4);function dM(){const n=Lo().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function qX(n){return new Promise((e,t)=>{function r(){dM(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{dM(),t(Za(n,"network-request-failed"))},timeout:XX.get()})}if(Lo().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Lo().gapi?.load)r();else{const i=eX("iframefcb");return Lo()[i]=()=>{gapi.load?r():t(Za(n,"network-request-failed"))},QY(`${JY()}?onload=${i}`).catch(s=>t(s))}}).catch(e=>{throw R_=null,e})}let R_=null;function ZX(n){return R_=R_||qX(n),R_}const QX=new t1(5e3,15e3),JX="__/auth/iframe",eq="emulator/auth/iframe",tq={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},nq=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function rq(n){const e=n.config;Bt(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?FA(e,eq):`https://${n.config.authDomain}/${JX}`,r={apiKey:e.apiKey,appName:n.name,v:ld},i=nq.get(n.config.apiHost);i&&(r.eid=i);const s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${e1(r).slice(1)}`}async function iq(n){const e=await ZX(n),t=Lo().gapi;return Bt(t,n,"internal-error"),e.open({where:document.body,url:rq(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:tq,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const a=Za(n,"network-request-failed"),o=Lo().setTimeout(()=>{s(a)},QX.get());function l(){Lo().clearTimeout(o),i(r)}r.ping(l).then(l,()=>{s(a)})}))}const sq={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},aq=500,oq=600,lq="_blank",cq="http://localhost";class fM{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function uq(n,e,t,r=aq,i=oq){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let o="";const l={...sq,width:r.toString(),height:i.toString(),top:s,left:a},u=Kr().toLowerCase();t&&(o=ZD(u)?lq:t),XD(u)&&(e=e||cq,l.scrollbars="yes");const h=Object.entries(l).reduce((g,[p,E])=>`${g}${p}=${E},`,"");if($Y(u)&&o!=="_self")return hq(e||"",o),new fM(null);const f=window.open(e||"",o,h);Bt(f,n,"popup-blocked");try{f.focus()}catch{}return new fM(f)}function hq(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}const dq="__/auth/handler",fq="emulator/auth/handler",gq=encodeURIComponent("fac");async function gM(n,e,t,r,i,s){Bt(n.config.authDomain,n,"auth-domain-config-required"),Bt(n.config.apiKey,n,"invalid-api-key");const a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:ld,eventId:i};if(e instanceof BA){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",gK(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,f]of Object.entries({}))a[h]=f}if(e instanceof r1){const h=e.getScopes().filter(f=>f!=="");h.length>0&&(a.scopes=h.join(","))}n.tenantId&&(a.tid=n.tenantId);const o=a;for(const h of Object.keys(o))o[h]===void 0&&delete o[h];const l=await n._getAppCheckToken(),u=l?`#${gq}=${encodeURIComponent(l)}`:"";return`${mq(n)}?${e1(o).slice(1)}${u}`}function mq({config:n}){return n.emulator?FA(n,fq):`https://${n.authDomain}/${dq}`}const iS="webStorageSupport";class pq{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=d6,this._completeRedirectFn=GX,this._overrideRedirectResult=FX}async _openPopup(e,t,r,i){jl(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const s=await gM(e,t,r,AT(),i);return uq(e,s,UA())}async _openRedirect(e,t,r,i){await this._originValidation(e);const s=await gM(e,t,r,AT(),i);return xX(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(jl(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await iq(e),r=new UX(e);return t.register("authEvent",i=>(Bt(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(iS,{type:iS},i=>{const s=i?.[0]?.[iS];s!==void 0&&t(!!s),$o(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=KX(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return n6()||qD()||VA()}}const yq=pq;var mM="@firebase/auth",pM="1.12.0";class _q{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Bt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function xq(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function vq(n){Gh(new su("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=r.options;Bt(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:a,authDomain:o,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:r6(n)},u=new qY(r,i,s,l);return nX(u,t),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Gh(new su("auth-internal",e=>{const t=n1(e.getProvider("auth").getImmediate());return(r=>new _q(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),No(mM,pM,xq(n)),No(mM,pM,"esm2020")}const Eq=300,wq=PD("authIdTokenMaxAge")||Eq;let yM=null;const Sq=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>wq)return;const i=t?.token;yM!==i&&(yM=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function Tq(n=LA()){const e=Xv(n,"auth");if(e.isInitialized())return e.getImmediate();const t=tX(n,{popupRedirectResolver:yq,persistence:[RX,pX,d6]}),r=PD("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const a=Sq(s.toString());fX(t,a,()=>a(t.currentUser)),dX(t,o=>a(o))}}const i=bD("auth");return i&&rX(t,`http://${i}`),t}function Iq(){return document.getElementsByTagName("head")?.[0]??document}ZY({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{const s=Za("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",Iq().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});vq("Browser");var Aq="firebase",bq="12.7.0";No(Aq,bq,"app");var _M=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Jc,v6;(function(){var n;function e(k,C){function M(){}M.prototype=C.prototype,k.F=C.prototype,k.prototype=new M,k.prototype.constructor=k,k.D=function(j,O,W){for(var F=Array(arguments.length-2),Te=2;Te<arguments.length;Te++)F[Te-2]=arguments[Te];return C.prototype[O].apply(j,F)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(k,C,M){M||(M=0);const j=Array(16);if(typeof C=="string")for(var O=0;O<16;++O)j[O]=C.charCodeAt(M++)|C.charCodeAt(M++)<<8|C.charCodeAt(M++)<<16|C.charCodeAt(M++)<<24;else for(O=0;O<16;++O)j[O]=C[M++]|C[M++]<<8|C[M++]<<16|C[M++]<<24;C=k.g[0],M=k.g[1],O=k.g[2];let W=k.g[3],F;F=C+(W^M&(O^W))+j[0]+3614090360&4294967295,C=M+(F<<7&4294967295|F>>>25),F=W+(O^C&(M^O))+j[1]+3905402710&4294967295,W=C+(F<<12&4294967295|F>>>20),F=O+(M^W&(C^M))+j[2]+606105819&4294967295,O=W+(F<<17&4294967295|F>>>15),F=M+(C^O&(W^C))+j[3]+3250441966&4294967295,M=O+(F<<22&4294967295|F>>>10),F=C+(W^M&(O^W))+j[4]+4118548399&4294967295,C=M+(F<<7&4294967295|F>>>25),F=W+(O^C&(M^O))+j[5]+1200080426&4294967295,W=C+(F<<12&4294967295|F>>>20),F=O+(M^W&(C^M))+j[6]+2821735955&4294967295,O=W+(F<<17&4294967295|F>>>15),F=M+(C^O&(W^C))+j[7]+4249261313&4294967295,M=O+(F<<22&4294967295|F>>>10),F=C+(W^M&(O^W))+j[8]+1770035416&4294967295,C=M+(F<<7&4294967295|F>>>25),F=W+(O^C&(M^O))+j[9]+2336552879&4294967295,W=C+(F<<12&4294967295|F>>>20),F=O+(M^W&(C^M))+j[10]+4294925233&4294967295,O=W+(F<<17&4294967295|F>>>15),F=M+(C^O&(W^C))+j[11]+2304563134&4294967295,M=O+(F<<22&4294967295|F>>>10),F=C+(W^M&(O^W))+j[12]+1804603682&4294967295,C=M+(F<<7&4294967295|F>>>25),F=W+(O^C&(M^O))+j[13]+4254626195&4294967295,W=C+(F<<12&4294967295|F>>>20),F=O+(M^W&(C^M))+j[14]+2792965006&4294967295,O=W+(F<<17&4294967295|F>>>15),F=M+(C^O&(W^C))+j[15]+1236535329&4294967295,M=O+(F<<22&4294967295|F>>>10),F=C+(O^W&(M^O))+j[1]+4129170786&4294967295,C=M+(F<<5&4294967295|F>>>27),F=W+(M^O&(C^M))+j[6]+3225465664&4294967295,W=C+(F<<9&4294967295|F>>>23),F=O+(C^M&(W^C))+j[11]+643717713&4294967295,O=W+(F<<14&4294967295|F>>>18),F=M+(W^C&(O^W))+j[0]+3921069994&4294967295,M=O+(F<<20&4294967295|F>>>12),F=C+(O^W&(M^O))+j[5]+3593408605&4294967295,C=M+(F<<5&4294967295|F>>>27),F=W+(M^O&(C^M))+j[10]+38016083&4294967295,W=C+(F<<9&4294967295|F>>>23),F=O+(C^M&(W^C))+j[15]+3634488961&4294967295,O=W+(F<<14&4294967295|F>>>18),F=M+(W^C&(O^W))+j[4]+3889429448&4294967295,M=O+(F<<20&4294967295|F>>>12),F=C+(O^W&(M^O))+j[9]+568446438&4294967295,C=M+(F<<5&4294967295|F>>>27),F=W+(M^O&(C^M))+j[14]+3275163606&4294967295,W=C+(F<<9&4294967295|F>>>23),F=O+(C^M&(W^C))+j[3]+4107603335&4294967295,O=W+(F<<14&4294967295|F>>>18),F=M+(W^C&(O^W))+j[8]+1163531501&4294967295,M=O+(F<<20&4294967295|F>>>12),F=C+(O^W&(M^O))+j[13]+2850285829&4294967295,C=M+(F<<5&4294967295|F>>>27),F=W+(M^O&(C^M))+j[2]+4243563512&4294967295,W=C+(F<<9&4294967295|F>>>23),F=O+(C^M&(W^C))+j[7]+1735328473&4294967295,O=W+(F<<14&4294967295|F>>>18),F=M+(W^C&(O^W))+j[12]+2368359562&4294967295,M=O+(F<<20&4294967295|F>>>12),F=C+(M^O^W)+j[5]+4294588738&4294967295,C=M+(F<<4&4294967295|F>>>28),F=W+(C^M^O)+j[8]+2272392833&4294967295,W=C+(F<<11&4294967295|F>>>21),F=O+(W^C^M)+j[11]+1839030562&4294967295,O=W+(F<<16&4294967295|F>>>16),F=M+(O^W^C)+j[14]+4259657740&4294967295,M=O+(F<<23&4294967295|F>>>9),F=C+(M^O^W)+j[1]+2763975236&4294967295,C=M+(F<<4&4294967295|F>>>28),F=W+(C^M^O)+j[4]+1272893353&4294967295,W=C+(F<<11&4294967295|F>>>21),F=O+(W^C^M)+j[7]+4139469664&4294967295,O=W+(F<<16&4294967295|F>>>16),F=M+(O^W^C)+j[10]+3200236656&4294967295,M=O+(F<<23&4294967295|F>>>9),F=C+(M^O^W)+j[13]+681279174&4294967295,C=M+(F<<4&4294967295|F>>>28),F=W+(C^M^O)+j[0]+3936430074&4294967295,W=C+(F<<11&4294967295|F>>>21),F=O+(W^C^M)+j[3]+3572445317&4294967295,O=W+(F<<16&4294967295|F>>>16),F=M+(O^W^C)+j[6]+76029189&4294967295,M=O+(F<<23&4294967295|F>>>9),F=C+(M^O^W)+j[9]+3654602809&4294967295,C=M+(F<<4&4294967295|F>>>28),F=W+(C^M^O)+j[12]+3873151461&4294967295,W=C+(F<<11&4294967295|F>>>21),F=O+(W^C^M)+j[15]+530742520&4294967295,O=W+(F<<16&4294967295|F>>>16),F=M+(O^W^C)+j[2]+3299628645&4294967295,M=O+(F<<23&4294967295|F>>>9),F=C+(O^(M|~W))+j[0]+4096336452&4294967295,C=M+(F<<6&4294967295|F>>>26),F=W+(M^(C|~O))+j[7]+1126891415&4294967295,W=C+(F<<10&4294967295|F>>>22),F=O+(C^(W|~M))+j[14]+2878612391&4294967295,O=W+(F<<15&4294967295|F>>>17),F=M+(W^(O|~C))+j[5]+4237533241&4294967295,M=O+(F<<21&4294967295|F>>>11),F=C+(O^(M|~W))+j[12]+1700485571&4294967295,C=M+(F<<6&4294967295|F>>>26),F=W+(M^(C|~O))+j[3]+2399980690&4294967295,W=C+(F<<10&4294967295|F>>>22),F=O+(C^(W|~M))+j[10]+4293915773&4294967295,O=W+(F<<15&4294967295|F>>>17),F=M+(W^(O|~C))+j[1]+2240044497&4294967295,M=O+(F<<21&4294967295|F>>>11),F=C+(O^(M|~W))+j[8]+1873313359&4294967295,C=M+(F<<6&4294967295|F>>>26),F=W+(M^(C|~O))+j[15]+4264355552&4294967295,W=C+(F<<10&4294967295|F>>>22),F=O+(C^(W|~M))+j[6]+2734768916&4294967295,O=W+(F<<15&4294967295|F>>>17),F=M+(W^(O|~C))+j[13]+1309151649&4294967295,M=O+(F<<21&4294967295|F>>>11),F=C+(O^(M|~W))+j[4]+4149444226&4294967295,C=M+(F<<6&4294967295|F>>>26),F=W+(M^(C|~O))+j[11]+3174756917&4294967295,W=C+(F<<10&4294967295|F>>>22),F=O+(C^(W|~M))+j[2]+718787259&4294967295,O=W+(F<<15&4294967295|F>>>17),F=M+(W^(O|~C))+j[9]+3951481745&4294967295,k.g[0]=k.g[0]+C&4294967295,k.g[1]=k.g[1]+(O+(F<<21&4294967295|F>>>11))&4294967295,k.g[2]=k.g[2]+O&4294967295,k.g[3]=k.g[3]+W&4294967295}r.prototype.v=function(k,C){C===void 0&&(C=k.length);const M=C-this.blockSize,j=this.C;let O=this.h,W=0;for(;W<C;){if(O==0)for(;W<=M;)i(this,k,W),W+=this.blockSize;if(typeof k=="string"){for(;W<C;)if(j[O++]=k.charCodeAt(W++),O==this.blockSize){i(this,j),O=0;break}}else for(;W<C;)if(j[O++]=k[W++],O==this.blockSize){i(this,j),O=0;break}}this.h=O,this.o+=C},r.prototype.A=function(){var k=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);k[0]=128;for(var C=1;C<k.length-8;++C)k[C]=0;C=this.o*8;for(var M=k.length-8;M<k.length;++M)k[M]=C&255,C/=256;for(this.v(k),k=Array(16),C=0,M=0;M<4;++M)for(let j=0;j<32;j+=8)k[C++]=this.g[M]>>>j&255;return k};function s(k,C){var M=o;return Object.prototype.hasOwnProperty.call(M,k)?M[k]:M[k]=C(k)}function a(k,C){this.h=C;const M=[];let j=!0;for(let O=k.length-1;O>=0;O--){const W=k[O]|0;j&&W==C||(M[O]=W,j=!1)}this.g=M}var o={};function l(k){return-128<=k&&k<128?s(k,function(C){return new a([C|0],C<0?-1:0)}):new a([k|0],k<0?-1:0)}function u(k){if(isNaN(k)||!isFinite(k))return f;if(k<0)return w(u(-k));const C=[];let M=1;for(let j=0;k>=M;j++)C[j]=k/M|0,M*=4294967296;return new a(C,0)}function h(k,C){if(k.length==0)throw Error("number format error: empty string");if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(k.charAt(0)=="-")return w(h(k.substring(1),C));if(k.indexOf("-")>=0)throw Error('number format error: interior "-" character');const M=u(Math.pow(C,8));let j=f;for(let W=0;W<k.length;W+=8){var O=Math.min(8,k.length-W);const F=parseInt(k.substring(W,W+O),C);O<8?(O=u(Math.pow(C,O)),j=j.j(O).add(u(F))):(j=j.j(M),j=j.add(u(F)))}return j}var f=l(0),g=l(1),p=l(16777216);n=a.prototype,n.m=function(){if(x(this))return-w(this).m();let k=0,C=1;for(let M=0;M<this.g.length;M++){const j=this.i(M);k+=(j>=0?j:4294967296+j)*C,C*=4294967296}return k},n.toString=function(k){if(k=k||10,k<2||36<k)throw Error("radix out of range: "+k);if(E(this))return"0";if(x(this))return"-"+w(this).toString(k);const C=u(Math.pow(k,6));var M=this;let j="";for(;;){const O=N(M,C).g;M=T(M,O.j(C));let W=((M.g.length>0?M.g[0]:M.h)>>>0).toString(k);if(M=O,E(M))return W+j;for(;W.length<6;)W="0"+W;j=W+j}},n.i=function(k){return k<0?0:k<this.g.length?this.g[k]:this.h};function E(k){if(k.h!=0)return!1;for(let C=0;C<k.g.length;C++)if(k.g[C]!=0)return!1;return!0}function x(k){return k.h==-1}n.l=function(k){return k=T(this,k),x(k)?-1:E(k)?0:1};function w(k){const C=k.g.length,M=[];for(let j=0;j<C;j++)M[j]=~k.g[j];return new a(M,~k.h).add(g)}n.abs=function(){return x(this)?w(this):this},n.add=function(k){const C=Math.max(this.g.length,k.g.length),M=[];let j=0;for(let O=0;O<=C;O++){let W=j+(this.i(O)&65535)+(k.i(O)&65535),F=(W>>>16)+(this.i(O)>>>16)+(k.i(O)>>>16);j=F>>>16,W&=65535,F&=65535,M[O]=F<<16|W}return new a(M,M[M.length-1]&-2147483648?-1:0)};function T(k,C){return k.add(w(C))}n.j=function(k){if(E(this)||E(k))return f;if(x(this))return x(k)?w(this).j(w(k)):w(w(this).j(k));if(x(k))return w(this.j(w(k)));if(this.l(p)<0&&k.l(p)<0)return u(this.m()*k.m());const C=this.g.length+k.g.length,M=[];for(var j=0;j<2*C;j++)M[j]=0;for(j=0;j<this.g.length;j++)for(let O=0;O<k.g.length;O++){const W=this.i(j)>>>16,F=this.i(j)&65535,Te=k.i(O)>>>16,Me=k.i(O)&65535;M[2*j+2*O]+=F*Me,I(M,2*j+2*O),M[2*j+2*O+1]+=W*Me,I(M,2*j+2*O+1),M[2*j+2*O+1]+=F*Te,I(M,2*j+2*O+1),M[2*j+2*O+2]+=W*Te,I(M,2*j+2*O+2)}for(k=0;k<C;k++)M[k]=M[2*k+1]<<16|M[2*k];for(k=C;k<2*C;k++)M[k]=0;return new a(M,0)};function I(k,C){for(;(k[C]&65535)!=k[C];)k[C+1]+=k[C]>>>16,k[C]&=65535,C++}function P(k,C){this.g=k,this.h=C}function N(k,C){if(E(C))throw Error("division by zero");if(E(k))return new P(f,f);if(x(k))return C=N(w(k),C),new P(w(C.g),w(C.h));if(x(C))return C=N(k,w(C)),new P(w(C.g),C.h);if(k.g.length>30){if(x(k)||x(C))throw Error("slowDivide_ only works with positive integers.");for(var M=g,j=C;j.l(k)<=0;)M=D(M),j=D(j);var O=B(M,1),W=B(j,1);for(j=B(j,2),M=B(M,2);!E(j);){var F=W.add(j);F.l(k)<=0&&(O=O.add(M),W=F),j=B(j,1),M=B(M,1)}return C=T(k,O.j(C)),new P(O,C)}for(O=f;k.l(C)>=0;){for(M=Math.max(1,Math.floor(k.m()/C.m())),j=Math.ceil(Math.log(M)/Math.LN2),j=j<=48?1:Math.pow(2,j-48),W=u(M),F=W.j(C);x(F)||F.l(k)>0;)M-=j,W=u(M),F=W.j(C);E(W)&&(W=g),O=O.add(W),k=T(k,F)}return new P(O,k)}n.B=function(k){return N(this,k).h},n.and=function(k){const C=Math.max(this.g.length,k.g.length),M=[];for(let j=0;j<C;j++)M[j]=this.i(j)&k.i(j);return new a(M,this.h&k.h)},n.or=function(k){const C=Math.max(this.g.length,k.g.length),M=[];for(let j=0;j<C;j++)M[j]=this.i(j)|k.i(j);return new a(M,this.h|k.h)},n.xor=function(k){const C=Math.max(this.g.length,k.g.length),M=[];for(let j=0;j<C;j++)M[j]=this.i(j)^k.i(j);return new a(M,this.h^k.h)};function D(k){const C=k.g.length+1,M=[];for(let j=0;j<C;j++)M[j]=k.i(j)<<1|k.i(j-1)>>>31;return new a(M,k.h)}function B(k,C){const M=C>>5;C%=32;const j=k.g.length-M,O=[];for(let W=0;W<j;W++)O[W]=C>0?k.i(W+M)>>>C|k.i(W+M+1)<<32-C:k.i(W+M);return new a(O,k.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,v6=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.B,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=u,a.fromString=h,Jc=a}).apply(typeof _M<"u"?_M:typeof self<"u"?self:typeof window<"u"?window:{});var Xy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var E6,Qg,w6,C_,CT,S6,T6,I6;(function(){var n,e=Object.defineProperty;function t(_){_=[typeof globalThis=="object"&&globalThis,_,typeof window=="object"&&window,typeof self=="object"&&self,typeof Xy=="object"&&Xy];for(var b=0;b<_.length;++b){var L=_[b];if(L&&L.Math==Math)return L}throw Error("Cannot find global object")}var r=t(this);function i(_,b){if(b)e:{var L=r;_=_.split(".");for(var H=0;H<_.length-1;H++){var ge=_[H];if(!(ge in L))break e;L=L[ge]}_=_[_.length-1],H=L[_],b=b(H),b!=H&&b!=null&&e(L,_,{configurable:!0,writable:!0,value:b})}}i("Symbol.dispose",function(_){return _||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(_){return _||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(_){return _||function(b){var L=[],H;for(H in b)Object.prototype.hasOwnProperty.call(b,H)&&L.push([H,b[H]]);return L}});var s=s||{},a=this||self;function o(_){var b=typeof _;return b=="object"&&_!=null||b=="function"}function l(_,b,L){return _.call.apply(_.bind,arguments)}function u(_,b,L){return u=l,u.apply(null,arguments)}function h(_,b){var L=Array.prototype.slice.call(arguments,1);return function(){var H=L.slice();return H.push.apply(H,arguments),_.apply(this,H)}}function f(_,b){function L(){}L.prototype=b.prototype,_.Z=b.prototype,_.prototype=new L,_.prototype.constructor=_,_.Ob=function(H,ge,we){for(var rt=Array(arguments.length-2),Ht=2;Ht<arguments.length;Ht++)rt[Ht-2]=arguments[Ht];return b.prototype[ge].apply(H,rt)}}var g=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?_=>_&&AsyncContext.Snapshot.wrap(_):_=>_;function p(_){const b=_.length;if(b>0){const L=Array(b);for(let H=0;H<b;H++)L[H]=_[H];return L}return[]}function E(_,b){for(let H=1;H<arguments.length;H++){const ge=arguments[H];var L=typeof ge;if(L=L!="object"?L:ge?Array.isArray(ge)?"array":L:"null",L=="array"||L=="object"&&typeof ge.length=="number"){L=_.length||0;const we=ge.length||0;_.length=L+we;for(let rt=0;rt<we;rt++)_[L+rt]=ge[rt]}else _.push(ge)}}class x{constructor(b,L){this.i=b,this.j=L,this.h=0,this.g=null}get(){let b;return this.h>0?(this.h--,b=this.g,this.g=b.next,b.next=null):b=this.i(),b}}function w(_){a.setTimeout(()=>{throw _},0)}function T(){var _=k;let b=null;return _.g&&(b=_.g,_.g=_.g.next,_.g||(_.h=null),b.next=null),b}class I{constructor(){this.h=this.g=null}add(b,L){const H=P.get();H.set(b,L),this.h?this.h.next=H:this.g=H,this.h=H}}var P=new x(()=>new N,_=>_.reset());class N{constructor(){this.next=this.g=this.h=null}set(b,L){this.h=b,this.g=L,this.next=null}reset(){this.next=this.g=this.h=null}}let D,B=!1,k=new I,C=()=>{const _=Promise.resolve(void 0);D=()=>{_.then(M)}};function M(){for(var _;_=T();){try{_.h.call(_.g)}catch(L){w(L)}var b=P;b.j(_),b.h<100&&(b.h++,_.next=b.g,b.g=_)}B=!1}function j(){this.u=this.u,this.C=this.C}j.prototype.u=!1,j.prototype.dispose=function(){this.u||(this.u=!0,this.N())},j.prototype[Symbol.dispose]=function(){this.dispose()},j.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function O(_,b){this.type=_,this.g=this.target=b,this.defaultPrevented=!1}O.prototype.h=function(){this.defaultPrevented=!0};var W=(function(){if(!a.addEventListener||!Object.defineProperty)return!1;var _=!1,b=Object.defineProperty({},"passive",{get:function(){_=!0}});try{const L=()=>{};a.addEventListener("test",L,b),a.removeEventListener("test",L,b)}catch{}return _})();function F(_){return/^[\s\xa0]*$/.test(_)}function Te(_,b){O.call(this,_?_.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,_&&this.init(_,b)}f(Te,O),Te.prototype.init=function(_,b){const L=this.type=_.type,H=_.changedTouches&&_.changedTouches.length?_.changedTouches[0]:null;this.target=_.target||_.srcElement,this.g=b,b=_.relatedTarget,b||(L=="mouseover"?b=_.fromElement:L=="mouseout"&&(b=_.toElement)),this.relatedTarget=b,H?(this.clientX=H.clientX!==void 0?H.clientX:H.pageX,this.clientY=H.clientY!==void 0?H.clientY:H.pageY,this.screenX=H.screenX||0,this.screenY=H.screenY||0):(this.clientX=_.clientX!==void 0?_.clientX:_.pageX,this.clientY=_.clientY!==void 0?_.clientY:_.pageY,this.screenX=_.screenX||0,this.screenY=_.screenY||0),this.button=_.button,this.key=_.key||"",this.ctrlKey=_.ctrlKey,this.altKey=_.altKey,this.shiftKey=_.shiftKey,this.metaKey=_.metaKey,this.pointerId=_.pointerId||0,this.pointerType=_.pointerType,this.state=_.state,this.i=_,_.defaultPrevented&&Te.Z.h.call(this)},Te.prototype.h=function(){Te.Z.h.call(this);const _=this.i;_.preventDefault?_.preventDefault():_.returnValue=!1};var Me="closure_listenable_"+(Math.random()*1e6|0),Le=0;function Re(_,b,L,H,ge){this.listener=_,this.proxy=null,this.src=b,this.type=L,this.capture=!!H,this.ha=ge,this.key=++Le,this.da=this.fa=!1}function ue(_){_.da=!0,_.listener=null,_.proxy=null,_.src=null,_.ha=null}function be(_,b,L){for(const H in _)b.call(L,_[H],H,_)}function ce(_,b){for(const L in _)b.call(void 0,_[L],L,_)}function te(_){const b={};for(const L in _)b[L]=_[L];return b}const V="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ie(_,b){let L,H;for(let ge=1;ge<arguments.length;ge++){H=arguments[ge];for(L in H)_[L]=H[L];for(let we=0;we<V.length;we++)L=V[we],Object.prototype.hasOwnProperty.call(H,L)&&(_[L]=H[L])}}function ne(_){this.src=_,this.g={},this.h=0}ne.prototype.add=function(_,b,L,H,ge){const we=_.toString();_=this.g[we],_||(_=this.g[we]=[],this.h++);const rt=fe(_,b,H,ge);return rt>-1?(b=_[rt],L||(b.fa=!1)):(b=new Re(b,this.src,we,!!H,ge),b.fa=L,_.push(b)),b};function ee(_,b){const L=b.type;if(L in _.g){var H=_.g[L],ge=Array.prototype.indexOf.call(H,b,void 0),we;(we=ge>=0)&&Array.prototype.splice.call(H,ge,1),we&&(ue(b),_.g[L].length==0&&(delete _.g[L],_.h--))}}function fe(_,b,L,H){for(let ge=0;ge<_.length;++ge){const we=_[ge];if(!we.da&&we.listener==b&&we.capture==!!L&&we.ha==H)return ge}return-1}var Oe="closure_lm_"+(Math.random()*1e6|0),Se={};function Fe(_,b,L,H,ge){if(Array.isArray(b)){for(let we=0;we<b.length;we++)Fe(_,b[we],L,H,ge);return null}return L=Xt(L),_&&_[Me]?_.J(b,L,o(H)?!!H.capture:!1,ge):je(_,b,L,!1,H,ge)}function je(_,b,L,H,ge,we){if(!b)throw Error("Invalid event type");const rt=o(ge)?!!ge.capture:!!ge;let Ht=Ut(_);if(Ht||(_[Oe]=Ht=new ne(_)),L=Ht.add(b,L,H,rt,we),L.proxy)return L;if(H=Qe(),L.proxy=H,H.src=_,H.listener=L,_.addEventListener)W||(ge=rt),ge===void 0&&(ge=!1),_.addEventListener(b.toString(),H,ge);else if(_.attachEvent)_.attachEvent(Lt(b.toString()),H);else if(_.addListener&&_.removeListener)_.addListener(H);else throw Error("addEventListener and attachEvent are unavailable.");return L}function Qe(){function _(L){return b.call(_.src,_.listener,L)}const b=nn;return _}function gt(_,b,L,H,ge){if(Array.isArray(b))for(var we=0;we<b.length;we++)gt(_,b[we],L,H,ge);else H=o(H)?!!H.capture:!!H,L=Xt(L),_&&_[Me]?(_=_.i,we=String(b).toString(),we in _.g&&(b=_.g[we],L=fe(b,L,H,ge),L>-1&&(ue(b[L]),Array.prototype.splice.call(b,L,1),b.length==0&&(delete _.g[we],_.h--)))):_&&(_=Ut(_))&&(b=_.g[b.toString()],_=-1,b&&(_=fe(b,L,H,ge)),(L=_>-1?b[_]:null)&&yt(L))}function yt(_){if(typeof _!="number"&&_&&!_.da){var b=_.src;if(b&&b[Me])ee(b.i,_);else{var L=_.type,H=_.proxy;b.removeEventListener?b.removeEventListener(L,H,_.capture):b.detachEvent?b.detachEvent(Lt(L),H):b.addListener&&b.removeListener&&b.removeListener(H),(L=Ut(b))?(ee(L,_),L.h==0&&(L.src=null,b[Oe]=null)):ue(_)}}}function Lt(_){return _ in Se?Se[_]:Se[_]="on"+_}function nn(_,b){if(_.da)_=!0;else{b=new Te(b,this);const L=_.listener,H=_.ha||_.src;_.fa&&yt(_),_=L.call(H,b)}return _}function Ut(_){return _=_[Oe],_ instanceof ne?_:null}var De="__closure_events_fn_"+(Math.random()*1e9>>>0);function Xt(_){return typeof _=="function"?_:(_[De]||(_[De]=function(b){return _.handleEvent(b)}),_[De])}function Ie(){j.call(this),this.i=new ne(this),this.M=this,this.G=null}f(Ie,j),Ie.prototype[Me]=!0,Ie.prototype.removeEventListener=function(_,b,L,H){gt(this,_,b,L,H)};function me(_,b){var L,H=_.G;if(H)for(L=[];H;H=H.G)L.push(H);if(_=_.M,H=b.type||b,typeof b=="string")b=new O(b,_);else if(b instanceof O)b.target=b.target||_;else{var ge=b;b=new O(H,_),ie(b,ge)}ge=!0;let we,rt;if(L)for(rt=L.length-1;rt>=0;rt--)we=b.g=L[rt],ge=R(we,H,!0,b)&&ge;if(we=b.g=_,ge=R(we,H,!0,b)&&ge,ge=R(we,H,!1,b)&&ge,L)for(rt=0;rt<L.length;rt++)we=b.g=L[rt],ge=R(we,H,!1,b)&&ge}Ie.prototype.N=function(){if(Ie.Z.N.call(this),this.i){var _=this.i;for(const b in _.g){const L=_.g[b];for(let H=0;H<L.length;H++)ue(L[H]);delete _.g[b],_.h--}}this.G=null},Ie.prototype.J=function(_,b,L,H){return this.i.add(String(_),b,!1,L,H)},Ie.prototype.K=function(_,b,L,H){return this.i.add(String(_),b,!0,L,H)};function R(_,b,L,H){if(b=_.i.g[String(b)],!b)return!0;b=b.concat();let ge=!0;for(let we=0;we<b.length;++we){const rt=b[we];if(rt&&!rt.da&&rt.capture==L){const Ht=rt.listener,Er=rt.ha||rt.src;rt.fa&&ee(_.i,rt),ge=Ht.call(Er,H)!==!1&&ge}}return ge&&!H.defaultPrevented}function Et(_,b){if(typeof _!="function")if(_&&typeof _.handleEvent=="function")_=u(_.handleEvent,_);else throw Error("Invalid listener argument");return Number(b)>2147483647?-1:a.setTimeout(_,b||0)}function X(_){_.g=Et(()=>{_.g=null,_.i&&(_.i=!1,X(_))},_.l);const b=_.h;_.h=null,_.m.apply(null,b)}class Ot extends j{constructor(b,L){super(),this.m=b,this.l=L,this.h=null,this.i=!1,this.g=null}j(b){this.h=arguments,this.g?this.i=!0:X(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function re(_){j.call(this),this.h=_,this.g={}}f(re,j);var z=[];function le(_){be(_.g,function(b,L){this.g.hasOwnProperty(L)&&yt(b)},_),_.g={}}re.prototype.N=function(){re.Z.N.call(this),le(this)},re.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var $e=a.JSON.stringify,Ae=a.JSON.parse,Ze=class{stringify(_){return a.JSON.stringify(_,void 0)}parse(_){return a.JSON.parse(_,void 0)}};function ht(){}function vt(){}var wt={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Rt(){O.call(this,"d")}f(Rt,O);function en(){O.call(this,"c")}f(en,O);var Fr={},Rs=null;function $i(){return Rs=Rs||new Ie}Fr.Ia="serverreachability";function Wi(_){O.call(this,Fr.Ia,_)}f(Wi,O);function Ar(_){const b=$i();me(b,new Wi(b))}Fr.STAT_EVENT="statevent";function ci(_,b){O.call(this,Fr.STAT_EVENT,_),this.stat=b}f(ci,O);function Tn(_){const b=$i();me(b,new ci(b,_))}Fr.Ja="timingevent";function Cs(_,b){O.call(this,Fr.Ja,_),this.size=b}f(Cs,O);function Ps(_,b){if(typeof _!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){_()},b)}function nr(){this.g=!0}nr.prototype.ua=function(){this.g=!1};function rs(_,b,L,H,ge,we){_.info(function(){if(_.g)if(we){var rt="",Ht=we.split("&");for(let kn=0;kn<Ht.length;kn++){var Er=Ht[kn].split("=");if(Er.length>1){const Rr=Er[0];Er=Er[1];const Os=Rr.split("_");rt=Os.length>=2&&Os[1]=="type"?rt+(Rr+"="+Er+"&"):rt+(Rr+"=redacted&")}}}else rt=null;else rt=we;return"XMLHTTP REQ ("+H+") [attempt "+ge+"]: "+b+`
`+L+`
`+rt})}function jr(_,b,L,H,ge,we,rt){_.info(function(){return"XMLHTTP RESP ("+H+") [ attempt "+ge+"]: "+b+`
`+L+`
`+we+" "+rt})}function rr(_,b,L,H){_.info(function(){return"XMLHTTP TEXT ("+b+"): "+Gr(_,L)+(H?" "+H:"")})}function Vr(_,b){_.info(function(){return"TIMEOUT: "+b})}nr.prototype.info=function(){};function Gr(_,b){if(!_.g)return b;if(!b)return null;try{const we=JSON.parse(b);if(we){for(_=0;_<we.length;_++)if(Array.isArray(we[_])){var L=we[_];if(!(L.length<2)){var H=L[1];if(Array.isArray(H)&&!(H.length<1)){var ge=H[0];if(ge!="noop"&&ge!="stop"&&ge!="close")for(let rt=1;rt<H.length;rt++)H[rt]=""}}}}return $e(we)}catch{return b}}var br={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},on={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},hr;function xr(){}f(xr,ht),xr.prototype.g=function(){return new XMLHttpRequest},hr=new xr;function is(_){return encodeURIComponent(String(_))}function U(_){var b=1;_=_.split(":");const L=[];for(;b>0&&_.length;)L.push(_.shift()),b--;return _.length&&L.push(_.join(":")),L}function q(_,b,L,H){this.j=_,this.i=b,this.l=L,this.S=H||1,this.V=new re(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new K}function K(){this.i=null,this.g="",this.h=!1}var Y={},Z={};function Q(_,b,L){_.M=1,_.A=el(ra(b)),_.u=L,_.R=!0,ye(_,null)}function ye(_,b){_.F=Date.now(),ve(_),_.B=ra(_.A);var L=_.B,H=_.S;Array.isArray(H)||(H=[String(H)]),eg(L.i,"t",H),_.C=0,L=_.j.L,_.h=new K,_.g=V1(_.j,L?b:null,!_.u),_.P>0&&(_.O=new Ot(u(_.Y,_,_.g),_.P)),b=_.V,L=_.g,H=_.ba;var ge="readystatechange";Array.isArray(ge)||(ge&&(z[0]=ge.toString()),ge=z);for(let we=0;we<ge.length;we++){const rt=Fe(L,ge[we],H||b.handleEvent,!1,b.h||b);if(!rt)break;b.g[rt.key]=rt}b=_.J?te(_.J):{},_.u?(_.v||(_.v="POST"),b["Content-Type"]="application/x-www-form-urlencoded",_.g.ea(_.B,_.v,_.u,b)):(_.v="GET",_.g.ea(_.B,_.v,null,b)),Ar(),rs(_.i,_.v,_.B,_.l,_.S,_.u)}q.prototype.ba=function(_){_=_.target;const b=this.O;b&&go(_)==3?b.j():this.Y(_)},q.prototype.Y=function(_){try{if(_==this.g)e:{const Ht=go(this.g),Er=this.g.ya(),kn=this.g.ca();if(!(Ht<3)&&(Ht!=3||this.g&&(this.h.h||this.g.la()||F1(this.g)))){this.K||Ht!=4||Er==7||(Er==8||kn<=0?Ar(3):Ar(2)),et(this);var b=this.g.ca();this.X=b;var L=Pe(this);if(this.o=b==200,jr(this.i,this.v,this.B,this.l,this.S,Ht,b),this.o){if(this.U&&!this.L){t:{if(this.g){var H,ge=this.g;if((H=ge.g?ge.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!F(H)){var we=H;break t}}we=null}if(_=we)rr(this.i,this.l,_,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Ke(this,_);else{this.o=!1,this.m=3,Tn(12),He(this),ut(this);break e}}if(this.R){_=!0;let Rr;for(;!this.K&&this.C<L.length;)if(Rr=xe(this,L),Rr==Z){Ht==4&&(this.m=4,Tn(14),_=!1),rr(this.i,this.l,null,"[Incomplete Response]");break}else if(Rr==Y){this.m=4,Tn(15),rr(this.i,this.l,L,"[Invalid Chunk]"),_=!1;break}else rr(this.i,this.l,Rr,null),Ke(this,Rr);if(pe(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ht!=4||L.length!=0||this.h.h||(this.m=1,Tn(16),_=!1),this.o=this.o&&_,!_)rr(this.i,this.l,L,"[Invalid Chunked Response]"),He(this),ut(this);else if(L.length>0&&!this.W){this.W=!0;var rt=this.j;rt.g==this&&rt.aa&&!rt.P&&(rt.j.info("Great, no buffering proxy detected. Bytes received: "+L.length),Lu(rt),rt.P=!0,Tn(11))}}else rr(this.i,this.l,L,null),Ke(this,L);Ht==4&&He(this),this.o&&!this.K&&(Ht==4?Id(this.j,this):(this.o=!1,ve(this)))}else ng(this.g),b==400&&L.indexOf("Unknown SID")>0?(this.m=3,Tn(12)):(this.m=0,Tn(13)),He(this),ut(this)}}}catch{}};function Pe(_){if(!pe(_))return _.g.la();const b=F1(_.g);if(b==="")return"";let L="";const H=b.length,ge=go(_.g)==4;if(!_.h.i){if(typeof TextDecoder>"u")return He(_),ut(_),"";_.h.i=new a.TextDecoder}for(let we=0;we<H;we++)_.h.h=!0,L+=_.h.i.decode(b[we],{stream:!(ge&&we==H-1)});return b.length=0,_.h.g+=L,_.C=0,_.h.g}function pe(_){return _.g?_.v=="GET"&&_.M!=2&&_.j.Aa:!1}function xe(_,b){var L=_.C,H=b.indexOf(`
`,L);return H==-1?Z:(L=Number(b.substring(L,H)),isNaN(L)?Y:(H+=1,H+L>b.length?Z:(b=b.slice(H,H+L),_.C=H+L,b)))}q.prototype.cancel=function(){this.K=!0,He(this)};function ve(_){_.T=Date.now()+_.H,We(_,_.H)}function We(_,b){if(_.D!=null)throw Error("WatchDog timer not null");_.D=Ps(u(_.aa,_),b)}function et(_){_.D&&(a.clearTimeout(_.D),_.D=null)}q.prototype.aa=function(){this.D=null;const _=Date.now();_-this.T>=0?(Vr(this.i,this.B),this.M!=2&&(Ar(),Tn(17)),He(this),this.m=2,ut(this)):We(this,this.T-_)};function ut(_){_.j.I==0||_.K||Id(_.j,_)}function He(_){et(_);var b=_.O;b&&typeof b.dispose=="function"&&b.dispose(),_.O=null,le(_.V),_.g&&(b=_.g,_.g=null,b.abort(),b.dispose())}function Ke(_,b){try{var L=_.j;if(L.I!=0&&(L.g==_||Ra(L.h,_))){if(!_.L&&Ra(L.h,_)&&L.I==3){try{var H=L.Ba.g.parse(b)}catch{H=null}if(Array.isArray(H)&&H.length==3){var ge=H;if(ge[0]==0){e:if(!L.v){if(L.g)if(L.g.F+3e3<_.F)Td(L),Ns(L);else break e;yo(L),Tn(18)}}else L.xa=ge[1],0<L.xa-L.K&&ge[2]<37500&&L.F&&L.A==0&&!L.C&&(L.C=Ps(u(L.Va,L),6e3));Qn(L.h)<=1&&L.ta&&(L.ta=void 0)}else Ls(L,11)}else if((_.L||L.g==_)&&Td(L),!F(b))for(ge=L.Ba.g.parse(b),b=0;b<ge.length;b++){let kn=ge[b];const Rr=kn[0];if(!(Rr<=L.K))if(L.K=Rr,kn=kn[1],L.I==2)if(kn[0]=="c"){L.M=kn[1],L.ba=kn[2];const Os=kn[3];Os!=null&&(L.ka=Os,L.j.info("VER="+L.ka));const sl=kn[4];sl!=null&&(L.za=sl,L.j.info("SVER="+L.za));const _o=kn[5];_o!=null&&typeof _o=="number"&&_o>0&&(H=1.5*_o,L.O=H,L.j.info("backChannelRequestTimeoutMs_="+H)),H=L;const xo=_.g;if(xo){const Rd=xo.g?xo.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Rd){var we=H.h;we.g||Rd.indexOf("spdy")==-1&&Rd.indexOf("quic")==-1&&Rd.indexOf("h2")==-1||(we.j=we.l,we.g=new Set,we.h&&(na(we,we.h),we.h=null))}if(H.G){const sg=xo.g?xo.g.getResponseHeader("X-HTTP-Session-Id"):null;sg&&(H.wa=sg,xn(H.J,H.G,sg))}}L.I=3,L.l&&L.l.ra(),L.aa&&(L.T=Date.now()-_.F,L.j.info("Handshake RTT: "+L.T+"ms")),H=L;var rt=_;if(H.na=ig(H,H.L?H.ba:null,H.W),rt.L){ks(H.h,rt);var Ht=rt,Er=H.O;Er&&(Ht.H=Er),Ht.D&&(et(Ht),ve(Ht)),H.g=rt}else Ai(H);L.i.length>0&&il(L)}else kn[0]!="stop"&&kn[0]!="close"||Ls(L,7);else L.I==3&&(kn[0]=="stop"||kn[0]=="close"?kn[0]=="stop"?Ls(L,7):wd(L):kn[0]!="noop"&&L.l&&L.l.qa(kn),L.A=0)}}Ar(4)}catch{}}var jt=class{constructor(_,b){this.g=_,this.map=b}};function In(_){this.l=_||10,a.PerformanceNavigationTiming?(_=a.performance.getEntriesByType("navigation"),_=_.length>0&&(_[0].nextHopProtocol=="hq"||_[0].nextHopProtocol=="h2")):_=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=_?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Pn(_){return _.h?!0:_.g?_.g.size>=_.j:!1}function Qn(_){return _.h?1:_.g?_.g.size:0}function Ra(_,b){return _.h?_.h==b:_.g?_.g.has(b):!1}function na(_,b){_.g?_.g.add(b):_.h=b}function ks(_,b){_.h&&_.h==b?_.h=null:_.g&&_.g.has(b)&&_.g.delete(b)}In.prototype.cancel=function(){if(this.i=vr(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const _ of this.g.values())_.cancel();this.g.clear()}};function vr(_){if(_.h!=null)return _.i.concat(_.h.G);if(_.g!=null&&_.g.size!==0){let b=_.i;for(const L of _.g.values())b=b.concat(L.G);return b}return p(_.i)}var ql=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ir(_,b){if(_){_=_.split("&");for(let L=0;L<_.length;L++){const H=_[L].indexOf("=");let ge,we=null;H>=0?(ge=_[L].substring(0,H),we=_[L].substring(H+1)):ge=_[L],b(ge,we?decodeURIComponent(we.replace(/\+/g," ")):"")}}}function oo(_){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let b;_ instanceof oo?(this.l=_.l,Ru(this,_.j),this.o=_.o,this.g=_.g,lo(this,_.u),this.h=_.h,Zl(this,tg(_.i)),this.m=_.m):_&&(b=String(_).match(ql))?(this.l=!1,Ru(this,b[1]||"",!0),this.o=Cu(b[2]||""),this.g=Cu(b[3]||"",!0),lo(this,b[4]),this.h=Cu(b[5]||"",!0),Zl(this,b[6]||"",!0),this.m=Cu(b[7]||"")):(this.l=!1,this.i=new ln(null,this.l))}oo.prototype.toString=function(){const _=[];var b=this.j;b&&_.push(Pu(b,X0,!0),":");var L=this.g;return(L||b=="file")&&(_.push("//"),(b=this.o)&&_.push(Pu(b,X0,!0),"@"),_.push(is(L).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),L=this.u,L!=null&&_.push(":",String(L))),(L=this.h)&&(this.g&&L.charAt(0)!="/"&&_.push("/"),_.push(Pu(L,L.charAt(0)=="/"?ku:q0,!0))),(L=this.i.toString())&&_.push("?",L),(L=this.m)&&_.push("#",Pu(L,Z0)),_.join("")},oo.prototype.resolve=function(_){const b=ra(this);let L=!!_.j;L?Ru(b,_.j):L=!!_.o,L?b.o=_.o:L=!!_.g,L?b.g=_.g:L=_.u!=null;var H=_.h;if(L)lo(b,_.u);else if(L=!!_.h){if(H.charAt(0)!="/")if(this.g&&!this.h)H="/"+H;else{var ge=b.h.lastIndexOf("/");ge!=-1&&(H=b.h.slice(0,ge+1)+H)}if(ge=H,ge==".."||ge==".")H="";else if(ge.indexOf("./")!=-1||ge.indexOf("/.")!=-1){H=ge.lastIndexOf("/",0)==0,ge=ge.split("/");const we=[];for(let rt=0;rt<ge.length;){const Ht=ge[rt++];Ht=="."?H&&rt==ge.length&&we.push(""):Ht==".."?((we.length>1||we.length==1&&we[0]!="")&&we.pop(),H&&rt==ge.length&&we.push("")):(we.push(Ht),H=!0)}H=we.join("/")}else H=ge}return L?b.h=H:L=_.i.toString()!=="",L?Zl(b,tg(_.i)):L=!!_.m,L&&(b.m=_.m),b};function ra(_){return new oo(_)}function Ru(_,b,L){_.j=L?Cu(b,!0):b,_.j&&(_.j=_.j.replace(/:$/,""))}function lo(_,b){if(b){if(b=Number(b),isNaN(b)||b<0)throw Error("Bad port number "+b);_.u=b}else _.u=null}function Zl(_,b,L){b instanceof ln?(_.i=b,xd(_.i,_.l)):(L||(b=Pu(b,KE)),_.i=new ln(b,_.l))}function xn(_,b,L){_.i.set(b,L)}function el(_){return xn(_,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),_}function Cu(_,b){return _?b?decodeURI(_.replace(/%25/g,"%2525")):decodeURIComponent(_):""}function Pu(_,b,L){return typeof _=="string"?(_=encodeURI(_).replace(b,Y0),L&&(_=_.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_):null}function Y0(_){return _=_.charCodeAt(0),"%"+(_>>4&15).toString(16)+(_&15).toString(16)}var X0=/[#\/\?@]/g,q0=/[#\?:]/g,ku=/[#\?]/g,KE=/[#\?@]/g,Z0=/#/g;function ln(_,b){this.h=this.g=null,this.i=_||null,this.j=!!b}function co(_){_.g||(_.g=new Map,_.h=0,_.i&&ir(_.i,function(b,L){_.add(decodeURIComponent(b.replace(/\+/g," ")),L)}))}n=ln.prototype,n.add=function(_,b){co(this),this.i=null,_=uo(this,_);let L=this.g.get(_);return L||this.g.set(_,L=[]),L.push(b),this.h+=1,this};function Q0(_,b){co(_),b=uo(_,b),_.g.has(b)&&(_.i=null,_.h-=_.g.get(b).length,_.g.delete(b))}function _d(_,b){return co(_),b=uo(_,b),_.g.has(b)}n.forEach=function(_,b){co(this),this.g.forEach(function(L,H){L.forEach(function(ge){_.call(b,ge,H,this)},this)},this)};function J0(_,b){co(_);let L=[];if(typeof b=="string")_d(_,b)&&(L=L.concat(_.g.get(uo(_,b))));else for(_=Array.from(_.g.values()),b=0;b<_.length;b++)L=L.concat(_[b]);return L}n.set=function(_,b){return co(this),this.i=null,_=uo(this,_),_d(this,_)&&(this.h-=this.g.get(_).length),this.g.set(_,[b]),this.h+=1,this},n.get=function(_,b){return _?(_=J0(this,_),_.length>0?String(_[0]):b):b};function eg(_,b,L){Q0(_,b),L.length>0&&(_.i=null,_.g.set(uo(_,b),p(L)),_.h+=L.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const _=[],b=Array.from(this.g.keys());for(let H=0;H<b.length;H++){var L=b[H];const ge=is(L);L=J0(this,L);for(let we=0;we<L.length;we++){let rt=ge;L[we]!==""&&(rt+="="+is(L[we])),_.push(rt)}}return this.i=_.join("&")};function tg(_){const b=new ln;return b.i=_.i,_.g&&(b.g=new Map(_.g),b.h=_.h),b}function uo(_,b){return b=String(b),_.j&&(b=b.toLowerCase()),b}function xd(_,b){b&&!_.j&&(co(_),_.i=null,_.g.forEach(function(L,H){const ge=H.toLowerCase();H!=ge&&(Q0(this,H),eg(this,ge,L))},_)),_.j=b}function ho(_,b){const L=new nr;if(a.Image){const H=new Image;H.onload=h(ui,L,"TestLoadImage: loaded",!0,b,H),H.onerror=h(ui,L,"TestLoadImage: error",!1,b,H),H.onabort=h(ui,L,"TestLoadImage: abort",!1,b,H),H.ontimeout=h(ui,L,"TestLoadImage: timeout",!1,b,H),a.setTimeout(function(){H.ontimeout&&H.ontimeout()},1e4),H.src=_}else b(!1)}function fo(_,b){const L=new nr,H=new AbortController,ge=setTimeout(()=>{H.abort(),ui(L,"TestPingServer: timeout",!1,b)},1e4);fetch(_,{signal:H.signal}).then(we=>{clearTimeout(ge),we.ok?ui(L,"TestPingServer: ok",!0,b):ui(L,"TestPingServer: server error",!1,b)}).catch(()=>{clearTimeout(ge),ui(L,"TestPingServer: error",!1,b)})}function ui(_,b,L,H,ge){try{ge&&(ge.onload=null,ge.onerror=null,ge.onabort=null,ge.ontimeout=null),H(L)}catch{}}function Mu(){this.g=new Ze}function tl(_){this.i=_.Sb||null,this.h=_.ab||!1}f(tl,ht),tl.prototype.g=function(){return new Ms(this.i,this.h)};function Ms(_,b){Ie.call(this),this.H=_,this.o=b,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}f(Ms,Ie),n=Ms.prototype,n.open=function(_,b){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=_,this.D=b,this.readyState=1,Ca(this)},n.send=function(_){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const b={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};_&&(b.body=_),(this.H||a).fetch(new Request(this.D,b)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Ql(this)),this.readyState=0},n.Pa=function(_){if(this.g&&(this.l=_,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=_.headers,this.readyState=2,Ca(this)),this.g&&(this.readyState=3,Ca(this),this.g)))if(this.responseType==="arraybuffer")_.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in _){if(this.j=_.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;L1(this)}else _.text().then(this.Oa.bind(this),this.ga.bind(this))};function L1(_){_.j.read().then(_.Ma.bind(_)).catch(_.ga.bind(_))}n.Ma=function(_){if(this.g){if(this.o&&_.value)this.response.push(_.value);else if(!this.o){var b=_.value?_.value:new Uint8Array(0);(b=this.B.decode(b,{stream:!_.done}))&&(this.response=this.responseText+=b)}_.done?Ql(this):Ca(this),this.readyState==3&&L1(this)}},n.Oa=function(_){this.g&&(this.response=this.responseText=_,Ql(this))},n.Na=function(_){this.g&&(this.response=_,Ql(this))},n.ga=function(){this.g&&Ql(this)};function Ql(_){_.readyState=4,_.l=null,_.j=null,_.B=null,Ca(_)}n.setRequestHeader=function(_,b){this.A.append(_,b)},n.getResponseHeader=function(_){return this.h&&this.h.get(_.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const _=[],b=this.h.entries();for(var L=b.next();!L.done;)L=L.value,_.push(L[0]+": "+L[1]),L=b.next();return _.join(`\r
`)};function Ca(_){_.onreadystatechange&&_.onreadystatechange.call(_)}Object.defineProperty(Ms.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(_){this.m=_?"include":"same-origin"}});function O1(_){let b="";return be(_,function(L,H){b+=H,b+=":",b+=L,b+=`\r
`}),b}function vd(_,b,L){e:{for(H in L){var H=!1;break e}H=!0}H||(L=O1(L),typeof _=="string"?L!=null&&is(L):xn(_,b,L))}function Un(_){Ie.call(this),this.headers=new Map,this.L=_||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}f(Un,Ie);var D1=/^https?$/i,YE=["POST","PUT"];n=Un.prototype,n.Fa=function(_){this.H=_},n.ea=function(_,b,L,H){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+_);b=b?b.toUpperCase():"GET",this.D=_,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():hr.g(),this.g.onreadystatechange=g(u(this.Ca,this));try{this.B=!0,this.g.open(b,String(_),!0),this.B=!1}catch(we){Jl(this,we);return}if(_=L||"",L=new Map(this.headers),H)if(Object.getPrototypeOf(H)===Object.prototype)for(var ge in H)L.set(ge,H[ge]);else if(typeof H.keys=="function"&&typeof H.get=="function")for(const we of H.keys())L.set(we,H.get(we));else throw Error("Unknown input type for opt_headers: "+String(H));H=Array.from(L.keys()).find(we=>we.toLowerCase()=="content-type"),ge=a.FormData&&_ instanceof a.FormData,!(Array.prototype.indexOf.call(YE,b,void 0)>=0)||H||ge||L.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[we,rt]of L)this.g.setRequestHeader(we,rt);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(_),this.v=!1}catch(we){Jl(this,we)}};function Jl(_,b){_.h=!1,_.g&&(_.j=!0,_.g.abort(),_.j=!1),_.l=b,_.o=5,ec(_),rl(_)}function ec(_){_.A||(_.A=!0,me(_,"complete"),me(_,"error"))}n.abort=function(_){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=_||7,me(this,"complete"),me(this,"abort"),rl(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),rl(this,!0)),Un.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?nl(this):this.Xa())},n.Xa=function(){nl(this)};function nl(_){if(_.h&&typeof s<"u"){if(_.v&&go(_)==4)setTimeout(_.Ca.bind(_),0);else if(me(_,"readystatechange"),go(_)==4){_.h=!1;try{const we=_.ca();e:switch(we){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break e;default:b=!1}var L;if(!(L=b)){var H;if(H=we===0){let rt=String(_.D).match(ql)[1]||null;!rt&&a.self&&a.self.location&&(rt=a.self.location.protocol.slice(0,-1)),H=!D1.test(rt?rt.toLowerCase():"")}L=H}if(L)me(_,"complete"),me(_,"success");else{_.o=6;try{var ge=go(_)>2?_.g.statusText:""}catch{ge=""}_.l=ge+" ["+_.ca()+"]",ec(_)}}finally{rl(_)}}}}function rl(_,b){if(_.g){_.m&&(clearTimeout(_.m),_.m=null);const L=_.g;_.g=null,b||me(_,"ready");try{L.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function go(_){return _.g?_.g.readyState:0}n.ca=function(){try{return go(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(_){if(this.g){var b=this.g.responseText;return _&&b.indexOf(_)==0&&(b=b.substring(_.length)),Ae(b)}};function F1(_){try{if(!_.g)return null;if("response"in _.g)return _.g.response;switch(_.F){case"":case"text":return _.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in _.g)return _.g.mozResponseArrayBuffer}return null}catch{return null}}function ng(_){const b={};_=(_.g&&go(_)>=2&&_.g.getAllResponseHeaders()||"").split(`\r
`);for(let H=0;H<_.length;H++){if(F(_[H]))continue;var L=U(_[H]);const ge=L[0];if(L=L[1],typeof L!="string")continue;L=L.trim();const we=b[ge]||[];b[ge]=we,we.push(L)}ce(b,function(H){return H.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function mo(_,b,L){return L&&L.internalChannelParams&&L.internalChannelParams[_]||b}function Ed(_){this.za=0,this.i=[],this.j=new nr,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=mo("failFast",!1,_),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=mo("baseRetryDelayMs",5e3,_),this.Za=mo("retryDelaySeedMs",1e4,_),this.Ta=mo("forwardChannelMaxRetries",2,_),this.va=mo("forwardChannelRequestTimeoutMs",2e4,_),this.ma=_&&_.xmlHttpFactory||void 0,this.Ua=_&&_.Rb||void 0,this.Aa=_&&_.useFetchStreams||!1,this.O=void 0,this.L=_&&_.supportsCrossDomainXhr||!1,this.M="",this.h=new In(_&&_.concurrentRequestLimit),this.Ba=new Mu,this.S=_&&_.fastHandshake||!1,this.R=_&&_.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=_&&_.Pb||!1,_&&_.ua&&this.j.ua(),_&&_.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&_&&_.detectBufferingProxy||!1,this.ia=void 0,_&&_.longPollingTimeout&&_.longPollingTimeout>0&&(this.ia=_.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Ed.prototype,n.ka=8,n.I=1,n.connect=function(_,b,L,H){Tn(0),this.W=_,this.H=b||{},L&&H!==void 0&&(this.H.OSID=L,this.H.OAID=H),this.F=this.X,this.J=ig(this,null,this.W),il(this)};function wd(_){if(Sd(_),_.I==3){var b=_.V++,L=ra(_.J);if(xn(L,"SID",_.M),xn(L,"RID",b),xn(L,"TYPE","terminate"),po(_,L),b=new q(_,_.j,b),b.M=2,b.A=el(ra(L)),L=!1,a.navigator&&a.navigator.sendBeacon)try{L=a.navigator.sendBeacon(b.A.toString(),"")}catch{}!L&&a.Image&&(new Image().src=b.A,L=!0),L||(b.g=V1(b.j,null),b.g.ea(b.A)),b.F=Date.now(),ve(b)}Ou(_)}function Ns(_){_.g&&(Lu(_),_.g.cancel(),_.g=null)}function Sd(_){Ns(_),_.v&&(a.clearTimeout(_.v),_.v=null),Td(_),_.h.cancel(),_.m&&(typeof _.m=="number"&&a.clearTimeout(_.m),_.m=null)}function il(_){if(!Pn(_.h)&&!_.m){_.m=!0;var b=_.Ea;D||C(),B||(D(),B=!0),k.add(b,_),_.D=0}}function j1(_,b){return Qn(_.h)>=_.h.j-(_.m?1:0)?!1:_.m?(_.i=b.G.concat(_.i),!0):_.I==1||_.I==2||_.D>=(_.Sa?0:_.Ta)?!1:(_.m=Ps(u(_.Ea,_,b),Ad(_,_.D)),_.D++,!0)}n.Ea=function(_){if(this.m)if(this.m=null,this.I==1){if(!_){this.V=Math.floor(Math.random()*1e5),_=this.V++;const ge=new q(this,this.j,_);let we=this.o;if(this.U&&(we?(we=te(we),ie(we,this.U)):we=this.U),this.u!==null||this.R||(ge.J=we,we=null),this.S)e:{for(var b=0,L=0;L<this.i.length;L++){t:{var H=this.i[L];if("__data__"in H.map&&(H=H.map.__data__,typeof H=="string")){H=H.length;break t}H=void 0}if(H===void 0)break;if(b+=H,b>4096){b=L;break e}if(b===4096||L===this.i.length-1){b=L+1;break e}}b=1e3}else b=1e3;b=rg(this,ge,b),L=ra(this.J),xn(L,"RID",_),xn(L,"CVER",22),this.G&&xn(L,"X-HTTP-Session-Id",this.G),po(this,L),we&&(this.R?b="headers="+is(O1(we))+"&"+b:this.u&&vd(L,this.u,we)),na(this.h,ge),this.Ra&&xn(L,"TYPE","init"),this.S?(xn(L,"$req",b),xn(L,"SID","null"),ge.U=!0,Q(ge,L,null)):Q(ge,L,b),this.I=2}}else this.I==3&&(_?Nu(this,_):this.i.length==0||Pn(this.h)||Nu(this))};function Nu(_,b){var L;b?L=b.l:L=_.V++;const H=ra(_.J);xn(H,"SID",_.M),xn(H,"RID",L),xn(H,"AID",_.K),po(_,H),_.u&&_.o&&vd(H,_.u,_.o),L=new q(_,_.j,L,_.D+1),_.u===null&&(L.J=_.o),b&&(_.i=b.G.concat(_.i)),b=rg(_,L,1e3),L.H=Math.round(_.va*.5)+Math.round(_.va*.5*Math.random()),na(_.h,L),Q(L,H,b)}function po(_,b){_.H&&be(_.H,function(L,H){xn(b,H,L)}),_.l&&be({},function(L,H){xn(b,H,L)})}function rg(_,b,L){L=Math.min(_.i.length,L);const H=_.l?u(_.l.Ka,_.l,_):null;e:{var ge=_.i;let Ht=-1;for(;;){const Er=["count="+L];Ht==-1?L>0?(Ht=ge[0].g,Er.push("ofs="+Ht)):Ht=0:Er.push("ofs="+Ht);let kn=!0;for(let Rr=0;Rr<L;Rr++){var we=ge[Rr].g;const Os=ge[Rr].map;if(we-=Ht,we<0)Ht=Math.max(0,ge[Rr].g-100),kn=!1;else try{we="req"+we+"_"||"";try{var rt=Os instanceof Map?Os:Object.entries(Os);for(const[sl,_o]of rt){let xo=_o;o(_o)&&(xo=$e(_o)),Er.push(we+sl+"="+encodeURIComponent(xo))}}catch(sl){throw Er.push(we+"type="+encodeURIComponent("_badmap")),sl}}catch{H&&H(Os)}}if(kn){rt=Er.join("&");break e}}rt=void 0}return _=_.i.splice(0,L),b.G=_,rt}function Ai(_){if(!_.g&&!_.v){_.Y=1;var b=_.Da;D||C(),B||(D(),B=!0),k.add(b,_),_.A=0}}function yo(_){return _.g||_.v||_.A>=3?!1:(_.Y++,_.v=Ps(u(_.Da,_),Ad(_,_.A)),_.A++,!0)}n.Da=function(){if(this.v=null,tc(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var _=4*this.T;this.j.info("BP detection timer enabled: "+_),this.B=Ps(u(this.Wa,this),_)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Tn(10),Ns(this),tc(this))};function Lu(_){_.B!=null&&(a.clearTimeout(_.B),_.B=null)}function tc(_){_.g=new q(_,_.j,"rpc",_.Y),_.u===null&&(_.g.J=_.o),_.g.P=0;var b=ra(_.na);xn(b,"RID","rpc"),xn(b,"SID",_.M),xn(b,"AID",_.K),xn(b,"CI",_.F?"0":"1"),!_.F&&_.ia&&xn(b,"TO",_.ia),xn(b,"TYPE","xmlhttp"),po(_,b),_.u&&_.o&&vd(b,_.u,_.o),_.O&&(_.g.H=_.O);var L=_.g;_=_.ba,L.M=1,L.A=el(ra(b)),L.u=null,L.R=!0,ye(L,_)}n.Va=function(){this.C!=null&&(this.C=null,Ns(this),yo(this),Tn(19))};function Td(_){_.C!=null&&(a.clearTimeout(_.C),_.C=null)}function Id(_,b){var L=null;if(_.g==b){Td(_),Lu(_),_.g=null;var H=2}else if(Ra(_.h,b))L=b.G,ks(_.h,b),H=1;else return;if(_.I!=0){if(b.o)if(H==1){L=b.u?b.u.length:0,b=Date.now()-b.F;var ge=_.D;H=$i(),me(H,new Cs(H,L)),il(_)}else Ai(_);else if(ge=b.m,ge==3||ge==0&&b.X>0||!(H==1&&j1(_,b)||H==2&&yo(_)))switch(L&&L.length>0&&(b=_.h,b.i=b.i.concat(L)),ge){case 1:Ls(_,5);break;case 4:Ls(_,10);break;case 3:Ls(_,6);break;default:Ls(_,2)}}}function Ad(_,b){let L=_.Qa+Math.floor(Math.random()*_.Za);return _.isActive()||(L*=2),L*b}function Ls(_,b){if(_.j.info("Error code "+b),b==2){var L=u(_.bb,_),H=_.Ua;const ge=!H;H=new oo(H||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Ru(H,"https"),el(H),ge?ho(H.toString(),L):fo(H.toString(),L)}else Tn(2);_.I=0,_.l&&_.l.pa(b),Ou(_),Sd(_)}n.bb=function(_){_?(this.j.info("Successfully pinged google.com"),Tn(2)):(this.j.info("Failed to ping google.com"),Tn(1))};function Ou(_){if(_.I=0,_.ja=[],_.l){const b=vr(_.h);(b.length!=0||_.i.length!=0)&&(E(_.ja,b),E(_.ja,_.i),_.h.i.length=0,p(_.i),_.i.length=0),_.l.oa()}}function ig(_,b,L){var H=L instanceof oo?ra(L):new oo(L);if(H.g!="")b&&(H.g=b+"."+H.g),lo(H,H.u);else{var ge=a.location;H=ge.protocol,b=b?b+"."+ge.hostname:ge.hostname,ge=+ge.port;const we=new oo(null);H&&Ru(we,H),b&&(we.g=b),ge&&lo(we,ge),L&&(we.h=L),H=we}return L=_.G,b=_.wa,L&&b&&xn(H,L,b),xn(H,"VER",_.ka),po(_,H),H}function V1(_,b,L){if(b&&!_.L)throw Error("Can't create secondary domain capable XhrIo object.");return b=_.Aa&&!_.ma?new Un(new tl({ab:L})):new Un(_.ma),b.Fa(_.L),b}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function G1(){}n=G1.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function bd(){}bd.prototype.g=function(_,b){return new hi(_,b)};function hi(_,b){Ie.call(this),this.g=new Ed(b),this.l=_,this.h=b&&b.messageUrlParams||null,_=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(_?_["X-Client-Protocol"]="webchannel":_={"X-Client-Protocol":"webchannel"}),this.g.o=_,_=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(_?_["X-WebChannel-Content-Type"]=b.messageContentType:_={"X-WebChannel-Content-Type":b.messageContentType}),b&&b.sa&&(_?_["X-WebChannel-Client-Profile"]=b.sa:_={"X-WebChannel-Client-Profile":b.sa}),this.g.U=_,(_=b&&b.Qb)&&!F(_)&&(this.g.u=_),this.A=b&&b.supportsCrossDomainXhr||!1,this.v=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!F(b)&&(this.g.G=b,_=this.h,_!==null&&b in _&&(_=this.h,b in _&&delete _[b])),this.j=new nc(this)}f(hi,Ie),hi.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},hi.prototype.close=function(){wd(this.g)},hi.prototype.o=function(_){var b=this.g;if(typeof _=="string"){var L={};L.__data__=_,_=L}else this.v&&(L={},L.__data__=$e(_),_=L);b.i.push(new jt(b.Ya++,_)),b.I==3&&il(b)},hi.prototype.N=function(){this.g.l=null,delete this.j,wd(this.g),delete this.g,hi.Z.N.call(this)};function B1(_){Rt.call(this),_.__headers__&&(this.headers=_.__headers__,this.statusCode=_.__status__,delete _.__headers__,delete _.__status__);var b=_.__sm__;if(b){e:{for(const L in b){_=L;break e}_=void 0}(this.i=_)&&(_=this.i,b=b!==null&&_ in b?b[_]:void 0),this.data=b}else this.data=_}f(B1,Rt);function U1(){en.call(this),this.status=1}f(U1,en);function nc(_){this.g=_}f(nc,G1),nc.prototype.ra=function(){me(this.g,"a")},nc.prototype.qa=function(_){me(this.g,new B1(_))},nc.prototype.pa=function(_){me(this.g,new U1)},nc.prototype.oa=function(){me(this.g,"b")},bd.prototype.createWebChannel=bd.prototype.g,hi.prototype.send=hi.prototype.o,hi.prototype.open=hi.prototype.m,hi.prototype.close=hi.prototype.close,I6=function(){return new bd},T6=function(){return $i()},S6=Fr,CT={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},br.NO_ERROR=0,br.TIMEOUT=8,br.HTTP_ERROR=6,C_=br,on.COMPLETE="complete",w6=on,vt.EventType=wt,wt.OPEN="a",wt.CLOSE="b",wt.ERROR="c",wt.MESSAGE="d",Ie.prototype.listen=Ie.prototype.J,Qg=vt,Un.prototype.listenOnce=Un.prototype.K,Un.prototype.getLastError=Un.prototype.Ha,Un.prototype.getLastErrorCode=Un.prototype.ya,Un.prototype.getStatus=Un.prototype.ca,Un.prototype.getResponseJson=Un.prototype.La,Un.prototype.getResponseText=Un.prototype.la,Un.prototype.send=Un.prototype.ea,Un.prototype.setWithCredentials=Un.prototype.Fa,E6=Un}).apply(typeof Xy<"u"?Xy:typeof self<"u"?self:typeof window<"u"?window:{});const xM="@firebase/firestore",vM="4.9.3";let _i=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};_i.UNAUTHENTICATED=new _i(null),_i.GOOGLE_CREDENTIALS=new _i("google-credentials-uid"),_i.FIRST_PARTY=new _i("first-party-uid"),_i.MOCK_USER=new _i("mock-user");let L0="12.7.0";const Uh=new MA("@firebase/firestore");function _f(){return Uh.logLevel}function Xe(n,...e){if(Uh.logLevel<=rn.DEBUG){const t=e.map($A);Uh.debug(`Firestore (${L0}): ${n}`,...t)}}function Ji(n,...e){if(Uh.logLevel<=rn.ERROR){const t=e.map($A);Uh.error(`Firestore (${L0}): ${n}`,...t)}}function zh(n,...e){if(Uh.logLevel<=rn.WARN){const t=e.map($A);Uh.warn(`Firestore (${L0}): ${n}`,...t)}}function $A(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function xt(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,A6(n,r,t)}function A6(n,e,t){let r=`FIRESTORE (${L0}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Ji(r),new Error(r)}function bt(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||A6(e,i,r)}function Wt(n,e){return n}const ke={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class st extends Qo{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Oo{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class b6{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Rq{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(_i.UNAUTHENTICATED)))}shutdown(){}}class Cq{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class Pq{constructor(e){this.t=e,this.currentUser=_i.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){bt(this.o===void 0,42304);let r=this.i;const i=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve();let s=new Oo;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Oo,e.enqueueRetryable((()=>i(this.currentUser)))};const a=()=>{const l=s;e.enqueueRetryable((async()=>{await l.promise,await i(this.currentUser)}))},o=l=>{Xe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit((l=>o(l))),setTimeout((()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(Xe("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Oo)}}),0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(Xe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(bt(typeof r.accessToken=="string",31837,{l:r}),new b6(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return bt(e===null||typeof e=="string",2055,{h:e}),new _i(e)}}class kq{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=_i.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Mq{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new kq(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(_i.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class EM{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Nq{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Hs(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){bt(this.o===void 0,3512);const r=s=>{s.error!=null&&Xe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.m;return this.m=s.token,Xe("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable((()=>r(s)))};const i=s=>{Xe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((s=>i(s))),setTimeout((()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):Xe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new EM(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(bt(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new EM(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function Lq(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class WA{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=Lq(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%62))}return r}}function $t(n,e){return n<e?-1:n>e?1:0}function PT(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const i=n.charAt(r),s=e.charAt(r);if(i!==s)return sS(i)===sS(s)?$t(i,s):sS(i)?1:-1}return $t(n.length,e.length)}const Oq=55296,Dq=57343;function sS(n){const e=n.charCodeAt(0);return e>=Oq&&e<=Dq}function c0(n,e,t){return n.length===e.length&&n.every(((r,i)=>t(r,e[i])))}function R6(n){return n+"\0"}const wM="__name__";class Ao{constructor(e,t,r){t===void 0?t=0:t>e.length&&xt(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&xt(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Ao.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ao?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const s=Ao.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return $t(e.length,t.length)}static compareSegments(e,t){const r=Ao.isNumericId(e),i=Ao.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?Ao.extractNumericId(e).compare(Ao.extractNumericId(t)):PT(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Jc.fromString(e.substring(4,e.length-2))}}class Sn extends Ao{construct(e,t,r){return new Sn(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new st(ke.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((i=>i.length>0)))}return new Sn(t)}static emptyPath(){return new Sn([])}}const Fq=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class lr extends Ao{construct(e,t,r){return new lr(e,t,r)}static isValidIdentifier(e){return Fq.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),lr.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===wM}static keyField(){return new lr([wM])}static fromServerFormat(e){const t=[];let r="",i=0;const s=()=>{if(r.length===0)throw new st(ke.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let a=!1;for(;i<e.length;){const o=e[i];if(o==="\\"){if(i+1===e.length)throw new st(ke.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new st(ke.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else o==="`"?(a=!a,i++):o!=="."||a?(r+=o,i++):(s(),i++)}if(s(),a)throw new st(ke.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new lr(t)}static emptyPath(){return new lr([])}}class ot{constructor(e){this.path=e}static fromPath(e){return new ot(Sn.fromString(e))}static fromName(e){return new ot(Sn.fromString(e).popFirst(5))}static empty(){return new ot(Sn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Sn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Sn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ot(new Sn(e.slice()))}}function C6(n,e,t){if(!t)throw new st(ke.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function jq(n,e,t,r){if(e===!0&&r===!0)throw new st(ke.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function SM(n){if(!ot.isDocumentKey(n))throw new st(ke.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function TM(n){if(ot.isDocumentKey(n))throw new st(ke.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function P6(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Jv(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":xt(12329,{type:typeof n})}function Ta(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new st(ke.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Jv(n);throw new st(ke.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Nr(n,e){const t={typeString:n};return e&&(t.value=e),t}function s1(n,e){if(!P6(n))throw new st(ke.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const a=n[r];if(i&&typeof a!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&a!==s.value){t=`Expected '${r}' field to equal '${s.value}'`;break}}if(t)throw new st(ke.INVALID_ARGUMENT,t);return!0}const IM=-62135596800,AM=1e6;class On{static now(){return On.fromMillis(Date.now())}static fromDate(e){return On.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*AM);return new On(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new st(ke.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new st(ke.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<IM)throw new st(ke.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new st(ke.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/AM}_compareTo(e){return this.seconds===e.seconds?$t(this.nanoseconds,e.nanoseconds):$t(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:On._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(s1(e,On._jsonSchema))return new On(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-IM;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}On._jsonSchemaVersion="firestore/timestamp/1.0",On._jsonSchema={type:Nr("string",On._jsonSchemaVersion),seconds:Nr("number"),nanoseconds:Nr("number")};class Ct{static fromTimestamp(e){return new Ct(e)}static min(){return new Ct(new On(0,0))}static max(){return new Ct(new On(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const ip=-1;class Ax{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function kT(n){return n.fields.find((e=>e.kind===2))}function nh(n){return n.fields.filter((e=>e.kind!==2))}Ax.UNKNOWN_ID=-1;class P_{constructor(e,t){this.fieldPath=e,this.kind=t}}class sp{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new sp(0,Js.min())}}function Vq(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Ct.fromTimestamp(r===1e9?new On(t+1,0):new On(t,r));return new Js(i,ot.empty(),e)}function k6(n){return new Js(n.readTime,n.key,ip)}class Js{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Js(Ct.min(),ot.empty(),ip)}static max(){return new Js(Ct.max(),ot.empty(),ip)}}function HA(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=ot.comparator(n.documentKey,e.documentKey),t!==0?t:$t(n.largestBatchId,e.largestBatchId))}const M6="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class N6{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function cd(n){if(n.code!==ke.FAILED_PRECONDITION||n.message!==M6)throw n;Xe("LocalStore","Unexpectedly lost primary lease")}class he{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&xt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new he(((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof he?t:he.resolve(t)}catch(t){return he.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):he.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):he.reject(t)}static resolve(e){return new he(((t,r)=>{t(e)}))}static reject(e){return new he(((t,r)=>{r(e)}))}static waitFor(e){return new he(((t,r)=>{let i=0,s=0,a=!1;e.forEach((o=>{++i,o.next((()=>{++s,a&&s===i&&t()}),(l=>r(l)))})),a=!0,s===i&&t()}))}static or(e){let t=he.resolve(!1);for(const r of e)t=t.next((i=>i?he.resolve(i):r()));return t}static forEach(e,t){const r=[];return e.forEach(((i,s)=>{r.push(t.call(this,i,s))})),this.waitFor(r)}static mapArray(e,t){return new he(((r,i)=>{const s=e.length,a=new Array(s);let o=0;for(let l=0;l<s;l++){const u=l;t(e[u]).next((h=>{a[u]=h,++o,o===s&&r(a)}),(h=>i(h)))}}))}static doWhile(e,t){return new he(((r,i)=>{const s=()=>{e()===!0?t().next((()=>{s()}),i):r()};s()}))}}const Gs="SimpleDb";class eE{static open(e,t,r,i){try{return new eE(t,e.transaction(i,r))}catch(s){throw new gm(t,s)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new Oo,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new gm(e,t.error)):this.S.resolve()},this.transaction.onerror=r=>{const i=KA(r.target.error);this.S.reject(new gm(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(Xe(Gs,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new Bq(t)}}class eu{static delete(e){return Xe(Gs,"Removing database:",e),lh(AD().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!OD())return!1;if(eu.F())return!0;const e=Kr(),t=eu.M(e),r=0<t&&t<10,i=L6(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.N=r,this.B=null,eu.M(Kr())===12.2&&Ji("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(Xe(Gs,"Opening database:",this.name),this.db=await new Promise(((t,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const a=s.target.result;t(a)},i.onblocked=()=>{r(new gm(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const a=s.target.error;a.name==="VersionError"?r(new st(ke.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):a.name==="InvalidStateError"?r(new st(ke.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a)):r(new gm(e,a))},i.onupgradeneeded=s=>{Xe(Gs,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const a=s.target.result;this.N.k(a,i.transaction,s.oldVersion,this.version).next((()=>{Xe(Gs,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,i){const s=t==="readonly";let a=0;for(;;){++a;try{this.db=await this.L(e);const o=eE.open(this.db,e,s?"readonly":"readwrite",r),l=i(o).next((u=>(o.C(),u))).catch((u=>(o.abort(u),he.reject(u)))).toPromise();return l.catch((()=>{})),await o.D,l}catch(o){const l=o,u=l.name!=="FirebaseError"&&a<3;if(Xe(Gs,"Transaction failed with error:",l.message,"Retrying:",u),this.close(),!u)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function L6(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class Gq{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return lh(this.U.delete())}}class gm extends st{constructor(e,t){super(ke.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Eu(n){return n.name==="IndexedDbTransactionError"}class Bq{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(Xe(Gs,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(Xe(Gs,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),lh(r)}add(e){return Xe(Gs,"ADD",this.store.name,e,e),lh(this.store.add(e))}get(e){return lh(this.store.get(e)).next((t=>(t===void 0&&(t=null),Xe(Gs,"GET",this.store.name,e,t),t)))}delete(e){return Xe(Gs,"DELETE",this.store.name,e),lh(this.store.delete(e))}count(){return Xe(Gs,"COUNT",this.store.name),lh(this.store.count())}J(e,t){const r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(r.range);return new he(((a,o)=>{s.onerror=l=>{o(l.target.error)},s.onsuccess=l=>{a(l.target.result)}}))}{const s=this.cursor(r),a=[];return this.H(s,((o,l)=>{a.push(l)})).next((()=>a))}}Y(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new he(((i,s)=>{r.onerror=a=>{s(a.target.error)},r.onsuccess=a=>{i(a.target.result)}}))}Z(e,t){Xe(Gs,"DELETE ALL",this.store.name);const r=this.options(e,t);r.X=!1;const i=this.cursor(r);return this.H(i,((s,a,o)=>o.delete()))}ee(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.H(i,t)}te(e){const t=this.cursor({});return new he(((r,i)=>{t.onerror=s=>{const a=KA(s.target.error);i(a)},t.onsuccess=s=>{const a=s.target.result;a?e(a.primaryKey,a.value).next((o=>{o?a.continue():r()})):r()}}))}H(e,t){const r=[];return new he(((i,s)=>{e.onerror=a=>{s(a.target.error)},e.onsuccess=a=>{const o=a.target.result;if(!o)return void i();const l=new Gq(o),u=t(o.primaryKey,o.value,l);if(u instanceof he){const h=u.catch((f=>(l.done(),he.reject(f))));r.push(h)}l.isDone?i():l.G===null?o.continue():o.continue(l.G)}})).next((()=>he.waitFor(r)))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function lh(n){return new he(((e,t)=>{n.onsuccess=r=>{const i=r.target.result;e(i)},n.onerror=r=>{const i=KA(r.target.error);t(i)}}))}let bM=!1;function KA(n){const e=eu.M(Kr());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new st("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return bM||(bM=!0,setTimeout((()=>{throw r}),0)),r}}return n}const mm="IndexBackfiller";class Uq{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){Xe(mm,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();Xe(mm,`Documents written: ${t}`)}catch(t){Eu(t)?Xe(mm,"Ignoring IndexedDB error during index backfill: ",t):await cd(t)}await this.re(6e4)}))}}class zq{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const r=new Set;let i=t,s=!0;return he.doWhile((()=>s===!0&&i>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((a=>{if(a!==null&&!r.has(a))return Xe(mm,`Processing collection: ${a}`),this.oe(e,a,i).next((o=>{i-=o,r.add(a)}));s=!1})))).next((()=>t-i))}oe(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next((s=>{const a=s.changes;return this.localStore.indexManager.updateIndexEntries(e,a).next((()=>this._e(i,s))).next((o=>(Xe(mm,`Updating offset: ${o}`),this.localStore.indexManager.updateCollectionGroup(e,t,o)))).next((()=>a.size))}))))}_e(e,t){let r=e;return t.changes.forEach(((i,s)=>{const a=k6(s);HA(a,r)>0&&(r=a)})),new Js(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}class va{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}va.ce=-1;const Th=-1;function tE(n){return n==null}function ap(n){return n===0&&1/n==-1/0}function $q(n){return typeof n=="number"&&Number.isInteger(n)&&!ap(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const bx="";function Gi(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=RM(e)),e=Wq(n.get(t),e);return RM(e)}function Wq(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const s=n.charAt(i);switch(s){case"\0":t+="";break;case bx:t+="";break;default:t+=s}}return t}function RM(n){return n+bx+""}function ko(n){const e=n.length;if(bt(e>=2,64408,{path:n}),e===2)return bt(n.charAt(0)===bx&&n.charAt(1)==="",56145,{path:n}),Sn.emptyPath();const t=e-2,r=[];let i="";for(let s=0;s<e;){const a=n.indexOf(bx,s);switch((a<0||a>t)&&xt(50515,{path:n}),n.charAt(a+1)){case"":const o=n.substring(s,a);let l;i.length===0?l=o:(i+=o,l=i,i=""),r.push(l);break;case"":i+=n.substring(s,a),i+="\0";break;case"":i+=n.substring(s,a+1);break;default:xt(61167,{path:n})}s=a+2}return new Sn(r)}const rh="remoteDocuments",a1="owner",nf="owner",op="mutationQueues",Hq="userId",Ba="mutations",CM="batchId",_h="userMutationsIndex",PM=["userId","batchId"];function k_(n,e){return[n,Gi(e)]}function O6(n,e,t){return[n,Gi(e),t]}const Kq={},u0="documentMutations",Rx="remoteDocumentsV14",Yq=["prefixPath","collectionGroup","readTime","documentId"],M_="documentKeyIndex",Xq=["prefixPath","collectionGroup","documentId"],D6="collectionGroupIndex",qq=["collectionGroup","readTime","prefixPath","documentId"],lp="remoteDocumentGlobal",MT="remoteDocumentGlobalKey",h0="targets",F6="queryTargetsIndex",Zq=["canonicalId","targetId"],d0="targetDocuments",Qq=["targetId","path"],YA="documentTargetsIndex",Jq=["path","targetId"],Cx="targetGlobalKey",Ih="targetGlobal",cp="collectionParents",eZ=["collectionId","parent"],f0="clientMetadata",tZ="clientId",nE="bundles",nZ="bundleId",rE="namedQueries",rZ="name",XA="indexConfiguration",iZ="indexId",NT="collectionGroupIndex",sZ="collectionGroup",pm="indexState",aZ=["indexId","uid"],j6="sequenceNumberIndex",oZ=["uid","sequenceNumber"],ym="indexEntries",lZ=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],V6="documentKeyIndex",cZ=["indexId","uid","orderedDocumentKey"],iE="documentOverlays",uZ=["userId","collectionPath","documentId"],LT="collectionPathOverlayIndex",hZ=["userId","collectionPath","largestBatchId"],G6="collectionGroupOverlayIndex",dZ=["userId","collectionGroup","largestBatchId"],qA="globals",fZ="name",B6=[op,Ba,u0,rh,h0,a1,Ih,d0,f0,lp,cp,nE,rE],gZ=[...B6,iE],U6=[op,Ba,u0,Rx,h0,a1,Ih,d0,f0,lp,cp,nE,rE,iE],z6=U6,ZA=[...z6,XA,pm,ym],mZ=ZA,$6=[...ZA,qA],pZ=$6;class OT extends N6{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function Xr(n,e){const t=Wt(n);return eu.O(t.le,e)}function kM(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function wu(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function W6(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class tr{constructor(e,t){this.comparator=e,this.root=t||xi.EMPTY}insert(e,t){return new tr(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,xi.BLACK,null,null))}remove(e){return new tr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,xi.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new qy(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new qy(this.root,e,this.comparator,!1)}getReverseIterator(){return new qy(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new qy(this.root,e,this.comparator,!0)}}class qy{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class xi{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??xi.RED,this.left=i??xi.EMPTY,this.right=s??xi.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new xi(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return xi.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return xi.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,xi.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,xi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw xt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw xt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw xt(27949);return e+(this.isRed()?0:1)}}xi.EMPTY=null,xi.RED=!0,xi.BLACK=!1;xi.EMPTY=new class{constructor(){this.size=0}get key(){throw xt(57766)}get value(){throw xt(16141)}get color(){throw xt(16727)}get left(){throw xt(29726)}get right(){throw xt(36894)}copy(e,t,r,i,s){return this}insert(e,t,r){return new xi(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class jn{constructor(e){this.comparator=e,this.data=new tr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new MM(this.data.getIterator())}getIteratorFrom(e){return new MM(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof jn)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new jn(this.comparator);return t.data=e,t}}class MM{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function rf(n){return n.hasNext()?n.getNext():void 0}class vs{constructor(e){this.fields=e,e.sort(lr.comparator)}static empty(){return new vs([])}unionWith(e){let t=new jn(lr.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new vs(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return c0(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}class H6 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Or{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new H6("Invalid base64 string: "+s):s}})(e);return new Or(t)}static fromUint8Array(e){const t=(function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s})(e);return new Or(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return $t(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Or.EMPTY_BYTE_STRING=new Or("");const yZ=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Vl(n){if(bt(!!n,39018),typeof n=="string"){let e=0;const t=yZ.exec(n);if(bt(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:er(n.seconds),nanos:er(n.nanos)}}function er(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Gl(n){return typeof n=="string"?Or.fromBase64String(n):Or.fromUint8Array(n)}const K6="server_timestamp",Y6="__type__",X6="__previous_value__",q6="__local_write_time__";function QA(n){return(n?.mapValue?.fields||{})[Y6]?.stringValue===K6}function sE(n){const e=n.mapValue.fields[X6];return QA(e)?sE(e):e}function up(n){const e=Vl(n.mapValue.fields[q6].timestampValue);return new On(e.seconds,e.nanos)}class _Z{constructor(e,t,r,i,s,a,o,l,u,h){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=u,this.isUsingEmulator=h}}const Px="(default)";class $h{constructor(e,t){this.projectId=e,this.database=t||Px}static empty(){return new $h("","")}get isDefaultDatabase(){return this.database===Px}isEqual(e){return e instanceof $h&&e.projectId===this.projectId&&e.database===this.database}}const JA="__type__",Z6="__max__",zc={mapValue:{fields:{__type__:{stringValue:Z6}}}},eb="__vector__",g0="value",N_={nullValue:"NULL_VALUE"};function ou(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?QA(n)?4:Q6(n)?9007199254740991:aE(n)?10:11:xt(28295,{value:n})}function Wo(n,e){if(n===e)return!0;const t=ou(n);if(t!==ou(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return up(n).isEqual(up(e));case 3:return(function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=Vl(i.timestampValue),o=Vl(s.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,s){return Gl(i.bytesValue).isEqual(Gl(s.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,s){return er(i.geoPointValue.latitude)===er(s.geoPointValue.latitude)&&er(i.geoPointValue.longitude)===er(s.geoPointValue.longitude)})(n,e);case 2:return(function(i,s){if("integerValue"in i&&"integerValue"in s)return er(i.integerValue)===er(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=er(i.doubleValue),o=er(s.doubleValue);return a===o?ap(a)===ap(o):isNaN(a)&&isNaN(o)}return!1})(n,e);case 9:return c0(n.arrayValue.values||[],e.arrayValue.values||[],Wo);case 10:case 11:return(function(i,s){const a=i.mapValue.fields||{},o=s.mapValue.fields||{};if(kM(a)!==kM(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!Wo(a[l],o[l])))return!1;return!0})(n,e);default:return xt(52216,{left:n})}}function hp(n,e){return(n.values||[]).find((t=>Wo(t,e)))!==void 0}function lu(n,e){if(n===e)return 0;const t=ou(n),r=ou(e);if(t!==r)return $t(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return $t(n.booleanValue,e.booleanValue);case 2:return(function(s,a){const o=er(s.integerValue||s.doubleValue),l=er(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1})(n,e);case 3:return NM(n.timestampValue,e.timestampValue);case 4:return NM(up(n),up(e));case 5:return PT(n.stringValue,e.stringValue);case 6:return(function(s,a){const o=Gl(s),l=Gl(a);return o.compareTo(l)})(n.bytesValue,e.bytesValue);case 7:return(function(s,a){const o=s.split("/"),l=a.split("/");for(let u=0;u<o.length&&u<l.length;u++){const h=$t(o[u],l[u]);if(h!==0)return h}return $t(o.length,l.length)})(n.referenceValue,e.referenceValue);case 8:return(function(s,a){const o=$t(er(s.latitude),er(a.latitude));return o!==0?o:$t(er(s.longitude),er(a.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return LM(n.arrayValue,e.arrayValue);case 10:return(function(s,a){const o=s.fields||{},l=a.fields||{},u=o[g0]?.arrayValue,h=l[g0]?.arrayValue,f=$t(u?.values?.length||0,h?.values?.length||0);return f!==0?f:LM(u,h)})(n.mapValue,e.mapValue);case 11:return(function(s,a){if(s===zc.mapValue&&a===zc.mapValue)return 0;if(s===zc.mapValue)return 1;if(a===zc.mapValue)return-1;const o=s.fields||{},l=Object.keys(o),u=a.fields||{},h=Object.keys(u);l.sort(),h.sort();for(let f=0;f<l.length&&f<h.length;++f){const g=PT(l[f],h[f]);if(g!==0)return g;const p=lu(o[l[f]],u[h[f]]);if(p!==0)return p}return $t(l.length,h.length)})(n.mapValue,e.mapValue);default:throw xt(23264,{he:t})}}function NM(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return $t(n,e);const t=Vl(n),r=Vl(e),i=$t(t.seconds,r.seconds);return i!==0?i:$t(t.nanos,r.nanos)}function LM(n,e){const t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const s=lu(t[i],r[i]);if(s)return s}return $t(t.length,r.length)}function m0(n){return DT(n)}function DT(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=Vl(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Gl(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return ot.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(const s of t.values||[])i?i=!1:r+=",",r+=DT(s);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const a of r)s?s=!1:i+=",",i+=`${a}:${DT(t.fields[a])}`;return i+"}"})(n.mapValue):xt(61005,{value:n})}function L_(n){switch(ou(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=sE(n);return e?16+L_(e):16;case 5:return 2*n.stringValue.length;case 6:return Gl(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((i,s)=>i+L_(s)),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return wu(r.fields,((s,a)=>{i+=s.length+L_(a)})),i})(n.mapValue);default:throw xt(13486,{value:n})}}function dp(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function FT(n){return!!n&&"integerValue"in n}function fp(n){return!!n&&"arrayValue"in n}function OM(n){return!!n&&"nullValue"in n}function DM(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function O_(n){return!!n&&"mapValue"in n}function aE(n){return(n?.mapValue?.fields||{})[JA]?.stringValue===eb}function _m(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return wu(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=_m(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=_m(n.arrayValue.values[t]);return e}return{...n}}function Q6(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===Z6}const J6={mapValue:{fields:{[JA]:{stringValue:eb},[g0]:{arrayValue:{}}}}};function xZ(n){return"nullValue"in n?N_:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?dp($h.empty(),ot.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?aE(n)?J6:{mapValue:{}}:xt(35942,{value:n})}function vZ(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?dp($h.empty(),ot.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?J6:"mapValue"in n?aE(n)?{mapValue:{}}:zc:xt(61959,{value:n})}function FM(n,e){const t=lu(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function jM(n,e){const t=lu(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class Di{constructor(e){this.value=e}static empty(){return new Di({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!O_(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=_m(t)}setAll(e){let t=lr.emptyPath(),r={},i=[];e.forEach(((a,o)=>{if(!t.isImmediateParentOf(o)){const l=this.getFieldsMap(t);this.applyChanges(l,r,i),r={},i=[],t=o.popLast()}a?r[o.lastSegment()]=_m(a):i.push(o.lastSegment())}));const s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){const t=this.field(e.popLast());O_(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Wo(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];O_(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){wu(t,((i,s)=>e[i]=s));for(const i of r)delete e[i]}clone(){return new Di(_m(this.value))}}function eF(n){const e=[];return wu(n.fields,((t,r)=>{const i=new lr([t]);if(O_(r)){const s=eF(r.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)})),new vs(e)}class yr{constructor(e,t,r,i,s,a,o){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(e){return new yr(e,0,Ct.min(),Ct.min(),Ct.min(),Di.empty(),0)}static newFoundDocument(e,t,r,i){return new yr(e,1,t,Ct.min(),r,i,0)}static newNoDocument(e,t){return new yr(e,2,t,Ct.min(),Ct.min(),Di.empty(),0)}static newUnknownDocument(e,t){return new yr(e,3,t,Ct.min(),Ct.min(),Di.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ct.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Di.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Di.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ct.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof yr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new yr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class p0{constructor(e,t){this.position=e,this.inclusive=t}}function VM(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const s=e[i],a=n.position[i];if(s.field.isKeyField()?r=ot.comparator(ot.fromName(a.referenceValue),t.key):r=lu(a,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function GM(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Wo(n.position[t],e.position[t]))return!1;return!0}class kx{constructor(e,t="asc"){this.field=e,this.dir=t}}function EZ(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class tF{}class sn extends tF{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new wZ(e,t,r):t==="array-contains"?new IZ(e,r):t==="in"?new oF(e,r):t==="not-in"?new AZ(e,r):t==="array-contains-any"?new bZ(e,r):new sn(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new SZ(e,r):new TZ(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(lu(t,this.value)):t!==null&&ou(this.value)===ou(t)&&this.matchesComparison(lu(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return xt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Dn extends tF{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Dn(e,t)}matches(e){return y0(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function y0(n){return n.op==="and"}function jT(n){return n.op==="or"}function tb(n){return nF(n)&&y0(n)}function nF(n){for(const e of n.filters)if(e instanceof Dn)return!1;return!0}function VT(n){if(n instanceof sn)return n.field.canonicalString()+n.op.toString()+m0(n.value);if(tb(n))return n.filters.map((e=>VT(e))).join(",");{const e=n.filters.map((t=>VT(t))).join(",");return`${n.op}(${e})`}}function rF(n,e){return n instanceof sn?(function(r,i){return i instanceof sn&&r.op===i.op&&r.field.isEqual(i.field)&&Wo(r.value,i.value)})(n,e):n instanceof Dn?(function(r,i){return i instanceof Dn&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce(((s,a,o)=>s&&rF(a,i.filters[o])),!0):!1})(n,e):void xt(19439)}function iF(n,e){const t=n.filters.concat(e);return Dn.create(t,n.op)}function sF(n){return n instanceof sn?(function(t){return`${t.field.canonicalString()} ${t.op} ${m0(t.value)}`})(n):n instanceof Dn?(function(t){return t.op.toString()+" {"+t.getFilters().map(sF).join(" ,")+"}"})(n):"Filter"}class wZ extends sn{constructor(e,t,r){super(e,t,r),this.key=ot.fromName(r.referenceValue)}matches(e){const t=ot.comparator(e.key,this.key);return this.matchesComparison(t)}}class SZ extends sn{constructor(e,t){super(e,"in",t),this.keys=aF("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class TZ extends sn{constructor(e,t){super(e,"not-in",t),this.keys=aF("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function aF(n,e){return(e.arrayValue?.values||[]).map((t=>ot.fromName(t.referenceValue)))}class IZ extends sn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return fp(t)&&hp(t.arrayValue,this.value)}}class oF extends sn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&hp(this.value.arrayValue,t)}}class AZ extends sn{constructor(e,t){super(e,"not-in",t)}matches(e){if(hp(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!hp(this.value.arrayValue,t)}}class bZ extends sn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!fp(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>hp(this.value.arrayValue,r)))}}class RZ{constructor(e,t=null,r=[],i=[],s=null,a=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=a,this.endAt=o,this.Te=null}}function GT(n,e=null,t=[],r=[],i=null,s=null,a=null){return new RZ(n,e,t,r,i,s,a)}function Wh(n){const e=Wt(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>VT(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(s){return s.field.canonicalString()+s.dir})(r))).join(","),tE(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>m0(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>m0(r))).join(",")),e.Te=t}return e.Te}function o1(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!EZ(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!rF(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!GM(n.startAt,e.startAt)&&GM(n.endAt,e.endAt)}function Mx(n){return ot.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Nx(n,e){return n.filters.filter((t=>t instanceof sn&&t.field.isEqual(e)))}function BM(n,e,t){let r=N_,i=!0;for(const s of Nx(n,e)){let a=N_,o=!0;switch(s.op){case"<":case"<=":a=xZ(s.value);break;case"==":case"in":case">=":a=s.value;break;case">":a=s.value,o=!1;break;case"!=":case"not-in":a=N_}FM({value:r,inclusive:i},{value:a,inclusive:o})<0&&(r=a,i=o)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const a=t.position[s];FM({value:r,inclusive:i},{value:a,inclusive:t.inclusive})<0&&(r=a,i=t.inclusive);break}}return{value:r,inclusive:i}}function UM(n,e,t){let r=zc,i=!0;for(const s of Nx(n,e)){let a=zc,o=!0;switch(s.op){case">=":case">":a=vZ(s.value),o=!1;break;case"==":case"in":case"<=":a=s.value;break;case"<":a=s.value,o=!1;break;case"!=":case"not-in":a=zc}jM({value:r,inclusive:i},{value:a,inclusive:o})>0&&(r=a,i=o)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const a=t.position[s];jM({value:r,inclusive:i},{value:a,inclusive:t.inclusive})>0&&(r=a,i=t.inclusive);break}}return{value:r,inclusive:i}}class l1{constructor(e,t=null,r=[],i=[],s=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function CZ(n,e,t,r,i,s,a,o){return new l1(n,e,t,r,i,s,a,o)}function oE(n){return new l1(n)}function zM(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function lF(n){return n.collectionGroup!==null}function xm(n){const e=Wt(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),t.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new jn(lr.comparator);return a.filters.forEach((l=>{l.getFlattenedFilters().forEach((u=>{u.isInequality()&&(o=o.add(u.field))}))})),o})(e).forEach((s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new kx(s,r))})),t.has(lr.keyField().canonicalString())||e.Ie.push(new kx(lr.keyField(),r))}return e.Ie}function wa(n){const e=Wt(n);return e.Ee||(e.Ee=PZ(e,xm(n))),e.Ee}function PZ(n,e){if(n.limitType==="F")return GT(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((i=>{const s=i.dir==="desc"?"asc":"desc";return new kx(i.field,s)}));const t=n.endAt?new p0(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new p0(n.startAt.position,n.startAt.inclusive):null;return GT(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function BT(n,e){const t=n.filters.concat([e]);return new l1(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function UT(n,e,t){return new l1(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function lE(n,e){return o1(wa(n),wa(e))&&n.limitType===e.limitType}function cF(n){return`${Wh(wa(n))}|lt:${n.limitType}`}function xf(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((i=>sF(i))).join(", ")}]`),tE(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((i=>(function(a){return`${a.field.canonicalString()} (${a.dir})`})(i))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((i=>m0(i))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((i=>m0(i))).join(",")),`Target(${r})`})(wa(n))}; limitType=${n.limitType})`}function c1(n,e){return e.isFoundDocument()&&(function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):ot.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)})(n,e)&&(function(r,i){for(const s of xm(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(a,o,l){const u=VM(a,o,l);return a.inclusive?u<=0:u<0})(r.startAt,xm(r),i)||r.endAt&&!(function(a,o,l){const u=VM(a,o,l);return a.inclusive?u>=0:u>0})(r.endAt,xm(r),i))})(n,e)}function kZ(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function uF(n){return(e,t)=>{let r=!1;for(const i of xm(n)){const s=MZ(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function MZ(n,e,t){const r=n.field.isKeyField()?ot.comparator(e.key,t.key):(function(s,a,o){const l=a.data.field(s),u=o.data.field(s);return l!==null&&u!==null?lu(l,u):xt(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return xt(19790,{direction:n.dir})}}class Wl{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){wu(this.inner,((t,r)=>{for(const[i,s]of r)e(i,s)}))}isEmpty(){return W6(this.inner)}size(){return this.innerSize}}const NZ=new tr(ot.comparator);function Ys(){return NZ}const hF=new tr(ot.comparator);function Jg(...n){let e=hF;for(const t of n)e=e.insert(t.key,t);return e}function dF(n){let e=hF;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function Mo(){return vm()}function fF(){return vm()}function vm(){return new Wl((n=>n.toString()),((n,e)=>n.isEqual(e)))}const LZ=new tr(ot.comparator),OZ=new jn(ot.comparator);function Qt(...n){let e=OZ;for(const t of n)e=e.add(t);return e}const DZ=new jn($t);function FZ(){return DZ}function nb(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ap(e)?"-0":e}}function gF(n){return{integerValue:""+n}}function jZ(n,e){return $q(e)?gF(e):nb(n,e)}class cE{constructor(){this._=void 0}}function VZ(n,e,t){return n instanceof _0?(function(i,s){const a={fields:{[Y6]:{stringValue:K6},[q6]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&QA(s)&&(s=sE(s)),s&&(a.fields[X6]=s),{mapValue:a}})(t,e):n instanceof x0?pF(n,e):n instanceof v0?yF(n,e):(function(i,s){const a=mF(i,s),o=$M(a)+$M(i.Ae);return FT(a)&&FT(i.Ae)?gF(o):nb(i.serializer,o)})(n,e)}function GZ(n,e,t){return n instanceof x0?pF(n,e):n instanceof v0?yF(n,e):t}function mF(n,e){return n instanceof gp?(function(r){return FT(r)||(function(s){return!!s&&"doubleValue"in s})(r)})(e)?e:{integerValue:0}:null}class _0 extends cE{}class x0 extends cE{constructor(e){super(),this.elements=e}}function pF(n,e){const t=_F(e);for(const r of n.elements)t.some((i=>Wo(i,r)))||t.push(r);return{arrayValue:{values:t}}}class v0 extends cE{constructor(e){super(),this.elements=e}}function yF(n,e){let t=_F(e);for(const r of n.elements)t=t.filter((i=>!Wo(i,r)));return{arrayValue:{values:t}}}class gp extends cE{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function $M(n){return er(n.integerValue||n.doubleValue)}function _F(n){return fp(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class xF{constructor(e,t){this.field=e,this.transform=t}}function BZ(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof x0&&i instanceof x0||r instanceof v0&&i instanceof v0?c0(r.elements,i.elements,Wo):r instanceof gp&&i instanceof gp?Wo(r.Ae,i.Ae):r instanceof _0&&i instanceof _0})(n.transform,e.transform)}class UZ{constructor(e,t){this.version=e,this.transformResults=t}}class ji{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new ji}static exists(e){return new ji(void 0,e)}static updateTime(e){return new ji(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function D_(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class uE{}function vF(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new hE(n.key,ji.none()):new O0(n.key,n.data,ji.none());{const t=n.data,r=Di.empty();let i=new jn(lr.comparator);for(let s of e.fields)if(!i.has(s)){let a=t.field(s);a===null&&s.length>1&&(s=s.popLast(),a=t.field(s)),a===null?r.delete(s):r.set(s,a),i=i.add(s)}return new Hl(n.key,r,new vs(i.toArray()),ji.none())}}function zZ(n,e,t){n instanceof O0?(function(i,s,a){const o=i.value.clone(),l=HM(i.fieldTransforms,s,a.transformResults);o.setAll(l),s.convertToFoundDocument(a.version,o).setHasCommittedMutations()})(n,e,t):n instanceof Hl?(function(i,s,a){if(!D_(i.precondition,s))return void s.convertToUnknownDocument(a.version);const o=HM(i.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(EF(i)),l.setAll(o),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()})(n,e,t):(function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()})(0,e,t)}function Em(n,e,t,r){return n instanceof O0?(function(s,a,o,l){if(!D_(s.precondition,a))return o;const u=s.value.clone(),h=KM(s.fieldTransforms,l,a);return u.setAll(h),a.convertToFoundDocument(a.version,u).setHasLocalMutations(),null})(n,e,t,r):n instanceof Hl?(function(s,a,o,l){if(!D_(s.precondition,a))return o;const u=KM(s.fieldTransforms,l,a),h=a.data;return h.setAll(EF(s)),h.setAll(u),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map((f=>f.field)))})(n,e,t,r):(function(s,a,o){return D_(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o})(n,e,t)}function $Z(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),s=mF(r.transform,i||null);s!=null&&(t===null&&(t=Di.empty()),t.set(r.field,s))}return t||null}function WM(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&c0(r,i,((s,a)=>BZ(s,a)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class O0 extends uE{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Hl extends uE{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function EF(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function HM(n,e,t){const r=new Map;bt(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let i=0;i<t.length;i++){const s=n[i],a=s.transform,o=e.data.field(s.field);r.set(s.field,GZ(a,o,t[i]))}return r}function KM(n,e,t){const r=new Map;for(const i of n){const s=i.transform,a=t.data.field(i.field);r.set(i.field,VZ(s,a,e))}return r}class hE extends uE{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class wF extends uE{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class rb{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&zZ(s,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Em(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Em(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=fF();return this.mutations.forEach((i=>{const s=e.get(i.key),a=s.overlayedDocument;let o=this.applyToLocalView(a,s.mutatedFields);o=t.has(i.key)?null:o;const l=vF(a,o);l!==null&&r.set(i.key,l),a.isValidDocument()||a.convertToNoDocument(Ct.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Qt())}isEqual(e){return this.batchId===e.batchId&&c0(this.mutations,e.mutations,((t,r)=>WM(t,r)))&&c0(this.baseMutations,e.baseMutations,((t,r)=>WM(t,r)))}}class ib{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){bt(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=(function(){return LZ})();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,r[a].version);return new ib(e,t,r,i)}}class sb{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class WZ{constructor(e,t){this.count=e,this.unchangedNames=t}}var kr,un;function HZ(n){switch(n){case ke.OK:return xt(64938);case ke.CANCELLED:case ke.UNKNOWN:case ke.DEADLINE_EXCEEDED:case ke.RESOURCE_EXHAUSTED:case ke.INTERNAL:case ke.UNAVAILABLE:case ke.UNAUTHENTICATED:return!1;case ke.INVALID_ARGUMENT:case ke.NOT_FOUND:case ke.ALREADY_EXISTS:case ke.PERMISSION_DENIED:case ke.FAILED_PRECONDITION:case ke.ABORTED:case ke.OUT_OF_RANGE:case ke.UNIMPLEMENTED:case ke.DATA_LOSS:return!0;default:return xt(15467,{code:n})}}function SF(n){if(n===void 0)return Ji("GRPC error has no .code"),ke.UNKNOWN;switch(n){case kr.OK:return ke.OK;case kr.CANCELLED:return ke.CANCELLED;case kr.UNKNOWN:return ke.UNKNOWN;case kr.DEADLINE_EXCEEDED:return ke.DEADLINE_EXCEEDED;case kr.RESOURCE_EXHAUSTED:return ke.RESOURCE_EXHAUSTED;case kr.INTERNAL:return ke.INTERNAL;case kr.UNAVAILABLE:return ke.UNAVAILABLE;case kr.UNAUTHENTICATED:return ke.UNAUTHENTICATED;case kr.INVALID_ARGUMENT:return ke.INVALID_ARGUMENT;case kr.NOT_FOUND:return ke.NOT_FOUND;case kr.ALREADY_EXISTS:return ke.ALREADY_EXISTS;case kr.PERMISSION_DENIED:return ke.PERMISSION_DENIED;case kr.FAILED_PRECONDITION:return ke.FAILED_PRECONDITION;case kr.ABORTED:return ke.ABORTED;case kr.OUT_OF_RANGE:return ke.OUT_OF_RANGE;case kr.UNIMPLEMENTED:return ke.UNIMPLEMENTED;case kr.DATA_LOSS:return ke.DATA_LOSS;default:return xt(39323,{code:n})}}(un=kr||(kr={}))[un.OK=0]="OK",un[un.CANCELLED=1]="CANCELLED",un[un.UNKNOWN=2]="UNKNOWN",un[un.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",un[un.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",un[un.NOT_FOUND=5]="NOT_FOUND",un[un.ALREADY_EXISTS=6]="ALREADY_EXISTS",un[un.PERMISSION_DENIED=7]="PERMISSION_DENIED",un[un.UNAUTHENTICATED=16]="UNAUTHENTICATED",un[un.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",un[un.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",un[un.ABORTED=10]="ABORTED",un[un.OUT_OF_RANGE=11]="OUT_OF_RANGE",un[un.UNIMPLEMENTED=12]="UNIMPLEMENTED",un[un.INTERNAL=13]="INTERNAL",un[un.UNAVAILABLE=14]="UNAVAILABLE",un[un.DATA_LOSS=15]="DATA_LOSS";function KZ(){return new TextEncoder}const YZ=new Jc([4294967295,4294967295],0);function YM(n){const e=KZ().encode(n),t=new v6;return t.update(e),new Uint8Array(t.digest())}function XM(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Jc([t,r],0),new Jc([i,s],0)]}class ab{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new em(`Invalid padding: ${t}`);if(r<0)throw new em(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new em(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new em(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Jc.fromNumber(this.ge)}ye(e,t,r){let i=e.add(t.multiply(Jc.fromNumber(r)));return i.compare(YZ)===1&&(i=new Jc([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=YM(e),[r,i]=XM(t);for(let s=0;s<this.hashCount;s++){const a=this.ye(r,i,s);if(!this.we(a))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new ab(s,i,t);return r.forEach((o=>a.insert(o))),a}insert(e){if(this.ge===0)return;const t=YM(e),[r,i]=XM(t);for(let s=0;s<this.hashCount;s++){const a=this.ye(r,i,s);this.Se(a)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class em extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class dE{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,u1.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new dE(Ct.min(),i,new tr($t),Ys(),Qt())}}class u1{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new u1(r,t,Qt(),Qt(),Qt())}}class F_{constructor(e,t,r,i){this.be=e,this.removedTargetIds=t,this.key=r,this.De=i}}class TF{constructor(e,t){this.targetId=e,this.Ce=t}}class IF{constructor(e,t,r=Or.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class qM{constructor(){this.ve=0,this.Fe=ZM(),this.Me=Or.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Qt(),t=Qt(),r=Qt();return this.Fe.forEach(((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:xt(38017,{changeType:s})}})),new u1(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=ZM()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,bt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class XZ{constructor(e){this.Ge=e,this.ze=new Map,this.je=Ys(),this.Je=Zy(),this.He=Zy(),this.Ye=new tr($t)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:xt(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,i)=>{this.rt(i)&&t(i)}))}st(e){const t=e.targetId,r=e.Ce.count,i=this.ot(t);if(i){const s=i.target;if(Mx(s))if(r===0){const a=new ot(s.path);this.et(t,a,yr.newNoDocument(a,Ct.min()))}else bt(r===1,20013,{expectedCount:r});else{const a=this._t(t);if(a!==r){const o=this.ut(e),l=o?this.ct(o,e,a):1;if(l!==0){this.it(t);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,u)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t;let a,o;try{a=Gl(r).toUint8Array()}catch(l){if(l instanceof H6)return zh("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new ab(a,i,s)}catch(l){return zh(l instanceof em?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.ge===0?null:o}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let i=0;return r.forEach((s=>{const a=this.Ge.ht(),o=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(o)||(this.et(t,s,null),i++)})),i}Tt(e){const t=new Map;this.ze.forEach(((s,a)=>{const o=this.ot(a);if(o){if(s.current&&Mx(o.target)){const l=new ot(o.target.path);this.It(l).has(a)||this.Et(a,l)||this.et(a,l,yr.newNoDocument(l,e))}s.Be&&(t.set(a,s.ke()),s.qe())}}));let r=Qt();this.He.forEach(((s,a)=>{let o=!0;a.forEachWhile((l=>{const u=this.ot(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)})),o&&(r=r.add(s))})),this.je.forEach(((s,a)=>a.setReadTime(e)));const i=new dE(e,t,this.Ye,this.je,r);return this.je=Ys(),this.Je=Zy(),this.He=Zy(),this.Ye=new tr($t),i}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,t)?i.Qe(t,1):i.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new qM,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new jn($t),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new jn($t),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Xe("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new qM),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Zy(){return new tr(ot.comparator)}function ZM(){return new tr(ot.comparator)}const qZ={asc:"ASCENDING",desc:"DESCENDING"},ZZ={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},QZ={and:"AND",or:"OR"};class JZ{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function zT(n,e){return n.useProto3Json||tE(e)?e:{value:e}}function E0(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function AF(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function eQ(n,e){return E0(n,e.toTimestamp())}function ts(n){return bt(!!n,49232),Ct.fromTimestamp((function(t){const r=Vl(t);return new On(r.seconds,r.nanos)})(n))}function ob(n,e){return $T(n,e).canonicalString()}function $T(n,e){const t=(function(i){return new Sn(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function bF(n){const e=Sn.fromString(n);return bt(DF(e),10190,{key:e.toString()}),e}function Lx(n,e){return ob(n.databaseId,e.path)}function Ah(n,e){const t=bF(e);if(t.get(1)!==n.databaseId.projectId)throw new st(ke.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new st(ke.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new ot(PF(t))}function RF(n,e){return ob(n.databaseId,e)}function CF(n){const e=bF(n);return e.length===4?Sn.emptyPath():PF(e)}function WT(n){return new Sn(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function PF(n){return bt(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function QM(n,e,t){return{name:Lx(n,e),fields:t.value.mapValue.fields}}function tQ(n,e,t){const r=Ah(n,e.name),i=ts(e.updateTime),s=e.createTime?ts(e.createTime):Ct.min(),a=new Di({mapValue:{fields:e.fields}}),o=yr.newFoundDocument(r,i,s,a);return t&&o.setHasCommittedMutations(),t?o.setHasCommittedMutations():o}function nQ(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:xt(39313,{state:u})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=(function(u,h){return u.useProto3Json?(bt(h===void 0||typeof h=="string",58123),Or.fromBase64String(h||"")):(bt(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),Or.fromUint8Array(h||new Uint8Array))})(n,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&(function(u){const h=u.code===void 0?ke.UNKNOWN:SF(u.code);return new st(h,u.message||"")})(a);t=new IF(r,i,s,o||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Ah(n,r.document.name),s=ts(r.document.updateTime),a=r.document.createTime?ts(r.document.createTime):Ct.min(),o=new Di({mapValue:{fields:r.document.fields}}),l=yr.newFoundDocument(i,s,a,o),u=r.targetIds||[],h=r.removedTargetIds||[];t=new F_(u,h,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Ah(n,r.document),s=r.readTime?ts(r.readTime):Ct.min(),a=yr.newNoDocument(i,s),o=r.removedTargetIds||[];t=new F_([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Ah(n,r.document),s=r.removedTargetIds||[];t=new F_([],s,i,null)}else{if(!("filter"in e))return xt(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,a=new WZ(i,s),o=r.targetId;t=new TF(o,a)}}return t}function Ox(n,e){let t;if(e instanceof O0)t={update:QM(n,e.key,e.value)};else if(e instanceof hE)t={delete:Lx(n,e.key)};else if(e instanceof Hl)t={update:QM(n,e.key,e.data),updateMask:lQ(e.fieldMask)};else{if(!(e instanceof wF))return xt(16599,{Vt:e.type});t={verify:Lx(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(s,a){const o=a.transform;if(o instanceof _0)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof x0)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof v0)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof gp)return{fieldPath:a.field.canonicalString(),increment:o.Ae};throw xt(20930,{transform:a.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(i,s){return s.updateTime!==void 0?{updateTime:eQ(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:xt(27497)})(n,e.precondition)),t}function HT(n,e){const t=e.currentDocument?(function(s){return s.updateTime!==void 0?ji.updateTime(ts(s.updateTime)):s.exists!==void 0?ji.exists(s.exists):ji.none()})(e.currentDocument):ji.none(),r=e.updateTransforms?e.updateTransforms.map((i=>(function(a,o){let l=null;if("setToServerValue"in o)bt(o.setToServerValue==="REQUEST_TIME",16630,{proto:o}),l=new _0;else if("appendMissingElements"in o){const h=o.appendMissingElements.values||[];l=new x0(h)}else if("removeAllFromArray"in o){const h=o.removeAllFromArray.values||[];l=new v0(h)}else"increment"in o?l=new gp(a,o.increment):xt(16584,{proto:o});const u=lr.fromServerFormat(o.fieldPath);return new xF(u,l)})(n,i))):[];if(e.update){e.update.name;const i=Ah(n,e.update.name),s=new Di({mapValue:{fields:e.update.fields}});if(e.updateMask){const a=(function(l){const u=l.fieldPaths||[];return new vs(u.map((h=>lr.fromServerFormat(h))))})(e.updateMask);return new Hl(i,s,a,t,r)}return new O0(i,s,t,r)}if(e.delete){const i=Ah(n,e.delete);return new hE(i,t)}if(e.verify){const i=Ah(n,e.verify);return new wF(i,t)}return xt(1463,{proto:e})}function rQ(n,e){return n&&n.length>0?(bt(e!==void 0,14353),n.map((t=>(function(i,s){let a=i.updateTime?ts(i.updateTime):ts(s);return a.isEqual(Ct.min())&&(a=ts(s)),new UZ(a,i.transformResults||[])})(t,e)))):[]}function kF(n,e){return{documents:[RF(n,e.path)]}}function MF(n,e){const t={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=RF(n,i);const s=(function(u){if(u.length!==0)return OF(Dn.create(u,"and"))})(e.filters);s&&(t.structuredQuery.where=s);const a=(function(u){if(u.length!==0)return u.map((h=>(function(g){return{field:vf(g.field),direction:sQ(g.dir)}})(h)))})(e.orderBy);a&&(t.structuredQuery.orderBy=a);const o=zT(n,e.limit);return o!==null&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt=(function(u){return{before:u.inclusive,values:u.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(u){return{before:!u.inclusive,values:u.position}})(e.endAt)),{ft:t,parent:i}}function NF(n){let e=CF(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){bt(r===1,65062);const h=t.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let s=[];t.where&&(s=(function(f){const g=LF(f);return g instanceof Dn&&tb(g)?g.getFilters():[g]})(t.where));let a=[];t.orderBy&&(a=(function(f){return f.map((g=>(function(E){return new kx(Ef(E.field),(function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(E.direction))})(g)))})(t.orderBy));let o=null;t.limit&&(o=(function(f){let g;return g=typeof f=="object"?f.value:f,tE(g)?null:g})(t.limit));let l=null;t.startAt&&(l=(function(f){const g=!!f.before,p=f.values||[];return new p0(p,g)})(t.startAt));let u=null;return t.endAt&&(u=(function(f){const g=!f.before,p=f.values||[];return new p0(p,g)})(t.endAt)),CZ(e,i,a,s,o,"F",l,u)}function iQ(n,e){const t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return xt(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function LF(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Ef(t.unaryFilter.field);return sn.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Ef(t.unaryFilter.field);return sn.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Ef(t.unaryFilter.field);return sn.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Ef(t.unaryFilter.field);return sn.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return xt(61313);default:return xt(60726)}})(n):n.fieldFilter!==void 0?(function(t){return sn.create(Ef(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return xt(58110);default:return xt(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Dn.create(t.compositeFilter.filters.map((r=>LF(r))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return xt(1026)}})(t.compositeFilter.op))})(n):xt(30097,{filter:n})}function sQ(n){return qZ[n]}function aQ(n){return ZZ[n]}function oQ(n){return QZ[n]}function vf(n){return{fieldPath:n.canonicalString()}}function Ef(n){return lr.fromServerFormat(n.fieldPath)}function OF(n){return n instanceof sn?(function(t){if(t.op==="=="){if(DM(t.value))return{unaryFilter:{field:vf(t.field),op:"IS_NAN"}};if(OM(t.value))return{unaryFilter:{field:vf(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(DM(t.value))return{unaryFilter:{field:vf(t.field),op:"IS_NOT_NAN"}};if(OM(t.value))return{unaryFilter:{field:vf(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:vf(t.field),op:aQ(t.op),value:t.value}}})(n):n instanceof Dn?(function(t){const r=t.getFilters().map((i=>OF(i)));return r.length===1?r[0]:{compositeFilter:{op:oQ(t.op),filters:r}}})(n):xt(54877,{filter:n})}function lQ(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function DF(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class wl{constructor(e,t,r,i,s=Ct.min(),a=Ct.min(),o=Or.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new wl(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new wl(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new wl(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new wl(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class FF{constructor(e){this.yt=e}}function cQ(n,e){let t;if(e.document)t=tQ(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=ot.fromSegments(e.noDocument.path),i=Kh(e.noDocument.readTime);t=yr.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return xt(56709);{const r=ot.fromSegments(e.unknownDocument.path),i=Kh(e.unknownDocument.version);t=yr.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime((function(i){const s=new On(i[0],i[1]);return Ct.fromTimestamp(s)})(e.readTime)),t}function JM(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Dx(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=(function(s,a){return{name:Lx(s,a.key),fields:a.data.value.mapValue.fields,updateTime:E0(s,a.version.toTimestamp()),createTime:E0(s,a.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Hh(e.version)};else{if(!e.isUnknownDocument())return xt(57904,{document:e});r.unknownDocument={path:t.path.toArray(),version:Hh(e.version)}}return r}function Dx(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Hh(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Kh(n){const e=new On(n.seconds,n.nanoseconds);return Ct.fromTimestamp(e)}function ch(n,e){const t=(e.baseMutations||[]).map((s=>HT(n.yt,s)));for(let s=0;s<e.mutations.length-1;++s){const a=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const o=e.mutations[s+1];a.updateTransforms=o.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map((s=>HT(n.yt,s))),i=On.fromMillis(e.localWriteTimeMs);return new rb(e.batchId,i,t,r)}function tm(n){const e=Kh(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Kh(n.lastLimboFreeSnapshotVersion):Ct.min();let r;return r=(function(s){return s.documents!==void 0})(n.query)?(function(s){const a=s.documents.length;return bt(a===1,1966,{count:a}),wa(oE(CF(s.documents[0])))})(n.query):(function(s){return wa(NF(s))})(n.query),new wl(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Or.fromBase64String(n.resumeToken))}function jF(n,e){const t=Hh(e.snapshotVersion),r=Hh(e.lastLimboFreeSnapshotVersion);let i;i=Mx(e.target)?kF(n.yt,e.target):MF(n.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Wh(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function VF(n){const e=NF({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?UT(e,e.limit,"L"):e}function aS(n,e){return new sb(e.largestBatchId,HT(n.yt,e.overlayMutation))}function e3(n,e){const t=e.path.lastSegment();return[n,Gi(e.path.popLast()),t]}function t3(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:Hh(r.readTime),documentKey:Gi(r.documentKey.path),largestBatchId:r.largestBatchId}}class uQ{getBundleMetadata(e,t){return n3(e).get(t).next((r=>{if(r)return(function(s){return{id:s.bundleId,createTime:Kh(s.createTime),version:s.version}})(r)}))}saveBundleMetadata(e,t){return n3(e).put((function(i){return{bundleId:i.id,createTime:Hh(ts(i.createTime)),version:i.version}})(t))}getNamedQuery(e,t){return r3(e).get(t).next((r=>{if(r)return(function(s){return{name:s.name,query:VF(s.bundledQuery),readTime:Kh(s.readTime)}})(r)}))}saveNamedQuery(e,t){return r3(e).put((function(i){return{name:i.name,readTime:Hh(ts(i.readTime)),bundledQuery:i.bundledQuery}})(t))}}function n3(n){return Xr(n,nE)}function r3(n){return Xr(n,rE)}class fE{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const r=t.uid||"";return new fE(e,r)}getOverlay(e,t){return jg(e).get(e3(this.userId,t)).next((r=>r?aS(this.serializer,r):null))}getOverlays(e,t){const r=Mo();return he.forEach(t,(i=>this.getOverlay(e,i).next((s=>{s!==null&&r.set(i,s)})))).next((()=>r))}saveOverlays(e,t,r){const i=[];return r.forEach(((s,a)=>{const o=new sb(t,a);i.push(this.St(e,o))})),he.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach((a=>i.add(Gi(a.getCollectionPath()))));const s=[];return i.forEach((a=>{const o=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,r+1],!1,!0);s.push(jg(e).Z(LT,o))})),he.waitFor(s)}getOverlaysForCollection(e,t,r){const i=Mo(),s=Gi(t),a=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return jg(e).J(LT,a).next((o=>{for(const l of o){const u=aS(this.serializer,l);i.set(u.getKey(),u)}return i}))}getOverlaysForCollectionGroup(e,t,r,i){const s=Mo();let a;const o=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return jg(e).ee({index:G6,range:o},((l,u,h)=>{const f=aS(this.serializer,u);s.size()<i||f.largestBatchId===a?(s.set(f.getKey(),f),a=f.largestBatchId):h.done()})).next((()=>s))}St(e,t){return jg(e).put((function(i,s,a){const[o,l,u]=e3(s,a.mutation.key);return{userId:s,collectionPath:l,documentId:u,collectionGroup:a.mutation.key.getCollectionGroup(),largestBatchId:a.largestBatchId,overlayMutation:Ox(i.yt,a.mutation)}})(this.serializer,this.userId,t))}}function jg(n){return Xr(n,iE)}class hQ{bt(e){return Xr(e,qA)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const r=t?.value;return r?Or.fromUint8Array(r):Or.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class uh{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(er(e.integerValue));else if("doubleValue"in e){const r=er(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),ap(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),typeof r=="string"&&(r=Vl(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Gl(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?Q6(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):aE(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):xt(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const r=e.fields||{};this.Ft(t,55);for(const i of Object.keys(r))this.Ot(i,t),this.Ct(r[i],t)}kt(e,t){const r=e.fields||{};this.Ft(t,53);const i=g0,s=r[i].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(er(s)),this.Ot(i,t),this.Ct(r[i],t)}Qt(e,t){const r=e.values||[];this.Ft(t,50);for(const i of r)this.Ct(i,t)}Lt(e,t){this.Ft(t,37),ot.fromName(e).path.forEach((r=>{this.Ft(t,60),this.Ut(r,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}uh.Kt=new uh;const sf=255;function dQ(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function i3(n){const e=64-(function(r){let i=0;for(let s=0;s<8;++s){const a=dQ(255&r[s]);if(i+=a,a!==8)break}return i})(n);return Math.ceil(e/8)}class fQ{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Gt(r.value),r=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Jt(r.value),r=t.next();this.Ht()}Yt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const i=t.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Zt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const i=t.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Ht()}Xt(e){const t=this.en(e),r=i3(t);this.tn(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}nn(e){const t=this.en(e),r=i3(t);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}rn(){this.sn(sf),this.sn(255)}_n(){this.an(sf),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(s){const a=new DataView(new ArrayBuffer(8));return a.setFloat64(0,s,!1),new Uint8Array(a.buffer)})(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===sf?(this.sn(sf),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===sf?(this.an(sf),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class gQ{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class mQ{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Vg{constructor(){this.cn=new fQ,this.ln=new gQ(this.cn),this.hn=new mQ(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class hh{constructor(e,t,r,i){this.Tn=e,this.In=t,this.En=r,this.dn=i}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.dn,0),t!==e?r.set([0],this.dn.length):++r[r.length-1],new hh(this.Tn,this.In,this.En,r)}Rn(e,t,r){return{indexId:this.Tn,uid:e,arrayValue:j_(this.En),directionalValue:j_(this.dn),orderedDocumentKey:j_(t),documentKey:r.path.toArray()}}Vn(e,t,r){const i=this.Rn(e,t,r);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function Tc(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=s3(n.En,e.En),t!==0?t:(t=s3(n.dn,e.dn),t!==0?t:ot.comparator(n.In,e.In)))}function s3(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}function j_(n){return LD()?(function(t){let r="";for(let i=0;i<t.length;i++)r+=String.fromCharCode(t[i]);return r})(n):n}function a3(n){return typeof n!="string"?n:(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(n)}class o3{constructor(e){this.mn=new jn(((t,r)=>lr.comparator(t.field,r.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const r=t;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(bt(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=kT(e);if(t!==void 0&&!this.wn(t))return!1;const r=nh(e);let i=new Set,s=0,a=0;for(;s<r.length&&this.wn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.mn.size>0){const o=this.mn.getIterator().getNext();if(!i.has(o.field.canonicalString())){const l=r[s];if(!this.Sn(o,l)||!this.bn(this.fn[a++],l))return!1}++s}for(;s<r.length;++s){const o=r[s];if(a>=this.fn.length||!this.bn(this.fn[a++],o))return!1}return!0}Dn(){if(this.pn)return null;let e=new jn(lr.comparator);const t=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new P_(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new P_(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new P_(r.field,r.dir==="asc"?0:1)));return new Ax(Ax.UNKNOWN_ID,this.collectionId,t,sp.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function GF(n){if(bt(n instanceof sn||n instanceof Dn,20012),n instanceof sn){if(n instanceof oF){const t=n.value.arrayValue?.values?.map((r=>sn.create(n.field,"==",r)))||[];return Dn.create(t,"or")}return n}const e=n.filters.map((t=>GF(t)));return Dn.create(e,n.op)}function pQ(n){if(n.getFilters().length===0)return[];const e=XT(GF(n));return bt(BF(e),7391),KT(e)||YT(e)?[e]:e.getFilters()}function KT(n){return n instanceof sn}function YT(n){return n instanceof Dn&&tb(n)}function BF(n){return KT(n)||YT(n)||(function(t){if(t instanceof Dn&&jT(t)){for(const r of t.getFilters())if(!KT(r)&&!YT(r))return!1;return!0}return!1})(n)}function XT(n){if(bt(n instanceof sn||n instanceof Dn,34018),n instanceof sn)return n;if(n.filters.length===1)return XT(n.filters[0]);const e=n.filters.map((r=>XT(r)));let t=Dn.create(e,n.op);return t=Fx(t),BF(t)?t:(bt(t instanceof Dn,64498),bt(y0(t),40251),bt(t.filters.length>1,57927),t.filters.reduce(((r,i)=>lb(r,i))))}function lb(n,e){let t;return bt(n instanceof sn||n instanceof Dn,38388),bt(e instanceof sn||e instanceof Dn,25473),t=n instanceof sn?e instanceof sn?(function(i,s){return Dn.create([i,s],"and")})(n,e):l3(n,e):e instanceof sn?l3(e,n):(function(i,s){if(bt(i.filters.length>0&&s.filters.length>0,48005),y0(i)&&y0(s))return iF(i,s.getFilters());const a=jT(i)?i:s,o=jT(i)?s:i,l=a.filters.map((u=>lb(u,o)));return Dn.create(l,"or")})(n,e),Fx(t)}function l3(n,e){if(y0(e))return iF(e,n.getFilters());{const t=e.filters.map((r=>lb(n,r)));return Dn.create(t,"or")}}function Fx(n){if(bt(n instanceof sn||n instanceof Dn,11850),n instanceof sn)return n;const e=n.getFilters();if(e.length===1)return Fx(e[0]);if(nF(n))return n;const t=e.map((i=>Fx(i))),r=[];return t.forEach((i=>{i instanceof sn?r.push(i):i instanceof Dn&&(i.op===n.op?r.push(...i.filters):r.push(i))})),r.length===1?r[0]:Dn.create(r,n.op)}class yQ{constructor(){this.Cn=new cb}addToCollectionParentIndex(e,t){return this.Cn.add(t),he.resolve()}getCollectionParents(e,t){return he.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return he.resolve()}deleteFieldIndex(e,t){return he.resolve()}deleteAllFieldIndexes(e){return he.resolve()}createTargetIndexes(e,t){return he.resolve()}getDocumentsMatchingTarget(e,t){return he.resolve(null)}getIndexType(e,t){return he.resolve(0)}getFieldIndexes(e,t){return he.resolve([])}getNextCollectionGroupToUpdate(e){return he.resolve(null)}getMinOffset(e,t){return he.resolve(Js.min())}getMinOffsetFromCollectionGroup(e,t){return he.resolve(Js.min())}updateCollectionGroup(e,t,r){return he.resolve()}updateIndexEntries(e,t){return he.resolve()}}class cb{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new jn(Sn.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new jn(Sn.comparator)).toArray()}}const c3="IndexedDbIndexManager",Qy=new Uint8Array(0);class _Q{constructor(e,t){this.databaseId=t,this.vn=new cb,this.Fn=new Wl((r=>Wh(r)),((r,i)=>o1(r,i))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const s={collectionId:r,parent:Gi(i)};return u3(e).put(s)}return he.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[R6(t),""],!1,!0);return u3(e).J(i).next((s=>{for(const a of s){if(a.collectionId!==t)break;r.push(ko(a.parent))}return r}))}addFieldIndex(e,t){const r=Gg(e),i=(function(o){return{indexId:o.indexId,collectionGroup:o.collectionGroup,fields:o.fields.map((l=>[l.fieldPath.canonicalString(),l.kind]))}})(t);delete i.indexId;const s=r.add(i);if(t.indexState){const a=of(e);return s.next((o=>{a.put(t3(o,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return s.next()}deleteFieldIndex(e,t){const r=Gg(e),i=of(e),s=af(e);return r.delete(t.indexId).next((()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=Gg(e),r=af(e),i=of(e);return t.Z().next((()=>r.Z())).next((()=>i.Z()))}createTargetIndexes(e,t){return he.forEach(this.Mn(t),(r=>this.getIndexType(e,r).next((i=>{if(i===0||i===1){const s=new o3(r).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))))}getDocumentsMatchingTarget(e,t){const r=af(e);let i=!0;const s=new Map;return he.forEach(this.Mn(t),(a=>this.xn(e,a).next((o=>{i&&(i=!!o),s.set(a,o)})))).next((()=>{if(i){let a=Qt();const o=[];return he.forEach(s,((l,u)=>{Xe(c3,`Using index ${(function(P){return`id=${P.indexId}|cg=${P.collectionGroup}|f=${P.fields.map((N=>`${N.fieldPath}:${N.kind}`)).join(",")}`})(l)} to execute ${Wh(t)}`);const h=(function(P,N){const D=kT(N);if(D===void 0)return null;for(const B of Nx(P,D.fieldPath))switch(B.op){case"array-contains-any":return B.value.arrayValue.values||[];case"array-contains":return[B.value]}return null})(u,l),f=(function(P,N){const D=new Map;for(const B of nh(N))for(const k of Nx(P,B.fieldPath))switch(k.op){case"==":case"in":D.set(B.fieldPath.canonicalString(),k.value);break;case"not-in":case"!=":return D.set(B.fieldPath.canonicalString(),k.value),Array.from(D.values())}return null})(u,l),g=(function(P,N){const D=[];let B=!0;for(const k of nh(N)){const C=k.kind===0?BM(P,k.fieldPath,P.startAt):UM(P,k.fieldPath,P.startAt);D.push(C.value),B&&(B=C.inclusive)}return new p0(D,B)})(u,l),p=(function(P,N){const D=[];let B=!0;for(const k of nh(N)){const C=k.kind===0?UM(P,k.fieldPath,P.endAt):BM(P,k.fieldPath,P.endAt);D.push(C.value),B&&(B=C.inclusive)}return new p0(D,B)})(u,l),E=this.On(l,u,g),x=this.On(l,u,p),w=this.Nn(l,u,f),T=this.Bn(l.indexId,h,E,g.inclusive,x,p.inclusive,w);return he.forEach(T,(I=>r.Y(I,t.limit).next((P=>{P.forEach((N=>{const D=ot.fromSegments(N.documentKey);a.has(D)||(a=a.add(D),o.push(D))}))}))))})).next((()=>o))}return he.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=pQ(Dn.create(e.filters,"and")).map((r=>GT(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,r,i,s,a,o){const l=(t!=null?t.length:1)*Math.max(r.length,s.length),u=l/(t!=null?t.length:1),h=[];for(let f=0;f<l;++f){const g=t?this.Ln(t[f/u]):Qy,p=this.kn(e,g,r[f%u],i),E=this.qn(e,g,s[f%u],a),x=o.map((w=>this.kn(e,g,w,!0)));h.push(...this.createRange(p,E,x))}return h}kn(e,t,r,i){const s=new hh(e,ot.empty(),t,r);return i?s:s.An()}qn(e,t,r,i){const s=new hh(e,ot.empty(),t,r);return i?s.An():s}xn(e,t){const r=new o3(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next((s=>{let a=null;for(const o of s)r.yn(o)&&(!a||o.fields.length>a.fields.length)&&(a=o);return a}))}getIndexType(e,t){let r=2;const i=this.Mn(t);return he.forEach(i,(s=>this.xn(e,s).next((a=>{a?r!==0&&a.fields.length<(function(l){let u=new jn(lr.comparator),h=!1;for(const f of l.filters)for(const g of f.getFlattenedFilters())g.field.isKeyField()||(g.op==="array-contains"||g.op==="array-contains-any"?h=!0:u=u.add(g.field));for(const f of l.orderBy)f.field.isKeyField()||(u=u.add(f.field));return u.size+(h?1:0)})(s)&&(r=1):r=0})))).next((()=>(function(a){return a.limit!==null})(t)&&i.length>1&&r===2?1:r))}Qn(e,t){const r=new Vg;for(const i of nh(e)){const s=t.data.field(i.fieldPath);if(s==null)return null;const a=r.Pn(i.kind);uh.Kt.Dt(s,a)}return r.un()}Ln(e){const t=new Vg;return uh.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const r=new Vg;return uh.Kt.Dt(dp(this.databaseId,t),r.Pn((function(s){const a=nh(s);return a.length===0?0:a[a.length-1].kind})(e))),r.un()}Nn(e,t,r){if(r===null)return[];let i=[];i.push(new Vg);let s=0;for(const a of nh(e)){const o=r[s++];for(const l of i)if(this.Un(t,a.fieldPath)&&fp(o))i=this.Kn(i,a,o);else{const u=l.Pn(a.kind);uh.Kt.Dt(o,u)}}return this.Wn(i)}On(e,t,r){return this.Nn(e,t,r.position)}Wn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].un();return t}Kn(e,t,r){const i=[...e],s=[];for(const a of r.arrayValue.values||[])for(const o of i){const l=new Vg;l.seed(o.un()),uh.Kt.Dt(a,l.Pn(t.kind)),s.push(l)}return s}Un(e,t){return!!e.filters.find((r=>r instanceof sn&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in")))}getFieldIndexes(e,t){const r=Gg(e),i=of(e);return(t?r.J(NT,IDBKeyRange.bound(t,t)):r.J()).next((s=>{const a=[];return he.forEach(s,(o=>i.get([o.indexId,this.uid]).next((l=>{a.push((function(h,f){const g=f?new sp(f.sequenceNumber,new Js(Kh(f.readTime),new ot(ko(f.documentKey)),f.largestBatchId)):sp.empty(),p=h.fields.map((([E,x])=>new P_(lr.fromServerFormat(E),x)));return new Ax(h.indexId,h.collectionGroup,p,g)})(o,l))})))).next((()=>a))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:$t(r.collectionGroup,i.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,r){const i=Gg(e),s=of(e);return this.Gn(e).next((a=>i.J(NT,IDBKeyRange.bound(t,t)).next((o=>he.forEach(o,(l=>s.put(t3(l.indexId,this.uid,a,r))))))))}updateIndexEntries(e,t){const r=new Map;return he.forEach(t,((i,s)=>{const a=r.get(i.collectionGroup);return(a?he.resolve(a):this.getFieldIndexes(e,i.collectionGroup)).next((o=>(r.set(i.collectionGroup,o),he.forEach(o,(l=>this.zn(e,i,l).next((u=>{const h=this.jn(s,l);return u.isEqual(h)?he.resolve():this.Jn(e,s,l,u,h)})))))))}))}Hn(e,t,r,i){return af(e).put(i.Rn(this.uid,this.$n(r,t.key),t.key))}Yn(e,t,r,i){return af(e).delete(i.Vn(this.uid,this.$n(r,t.key),t.key))}zn(e,t,r){const i=af(e);let s=new jn(Tc);return i.ee({index:V6,range:IDBKeyRange.only([r.indexId,this.uid,j_(this.$n(r,t))])},((a,o)=>{s=s.add(new hh(r.indexId,t,a3(o.arrayValue),a3(o.directionalValue)))})).next((()=>s))}jn(e,t){let r=new jn(Tc);const i=this.Qn(t,e);if(i==null)return r;const s=kT(t);if(s!=null){const a=e.data.field(s.fieldPath);if(fp(a))for(const o of a.arrayValue.values||[])r=r.add(new hh(t.indexId,e.key,this.Ln(o),i))}else r=r.add(new hh(t.indexId,e.key,Qy,i));return r}Jn(e,t,r,i,s){Xe(c3,"Updating index entries for document '%s'",t.key);const a=[];return(function(l,u,h,f,g){const p=l.getIterator(),E=u.getIterator();let x=rf(p),w=rf(E);for(;x||w;){let T=!1,I=!1;if(x&&w){const P=h(x,w);P<0?I=!0:P>0&&(T=!0)}else x!=null?I=!0:T=!0;T?(f(w),w=rf(E)):I?(g(x),x=rf(p)):(x=rf(p),w=rf(E))}})(i,s,Tc,(o=>{a.push(this.Hn(e,t,r,o))}),(o=>{a.push(this.Yn(e,t,r,o))})),he.waitFor(a)}Gn(e){let t=1;return of(e).ee({index:j6,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((r,i,s)=>{s.done(),t=i.sequenceNumber+1})).next((()=>t))}createRange(e,t,r){r=r.sort(((a,o)=>Tc(a,o))).filter(((a,o,l)=>!o||Tc(a,l[o-1])!==0));const i=[];i.push(e);for(const a of r){const o=Tc(a,e),l=Tc(a,t);if(o===0)i[0]=e.An();else if(o>0&&l<0)i.push(a),i.push(a.An());else if(l>0)break}i.push(t);const s=[];for(let a=0;a<i.length;a+=2){if(this.Zn(i[a],i[a+1]))return[];const o=i[a].Vn(this.uid,Qy,ot.empty()),l=i[a+1].Vn(this.uid,Qy,ot.empty());s.push(IDBKeyRange.bound(o,l))}return s}Zn(e,t){return Tc(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(h3)}getMinOffset(e,t){return he.mapArray(this.Mn(t),(r=>this.xn(e,r).next((i=>i||xt(44426))))).next(h3)}}function u3(n){return Xr(n,cp)}function af(n){return Xr(n,ym)}function Gg(n){return Xr(n,XA)}function of(n){return Xr(n,pm)}function h3(n){bt(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;HA(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new Js(e.readTime,e.documentKey,t)}const d3={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},UF=41943040;class Li{static withCacheSize(e){return new Li(e,Li.DEFAULT_COLLECTION_PERCENTILE,Li.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}function zF(n,e,t){const r=n.store(Ba),i=n.store(u0),s=[],a=IDBKeyRange.only(t.batchId);let o=0;const l=r.ee({range:a},((h,f,g)=>(o++,g.delete())));s.push(l.next((()=>{bt(o===1,47070,{batchId:t.batchId})})));const u=[];for(const h of t.mutations){const f=O6(e,h.key.path,t.batchId);s.push(i.delete(f)),u.push(h.key)}return he.waitFor(s).next((()=>u))}function jx(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw xt(14731);e=n.noDocument}return JSON.stringify(e).length}Li.DEFAULT_COLLECTION_PERCENTILE=10,Li.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Li.DEFAULT=new Li(UF,Li.DEFAULT_COLLECTION_PERCENTILE,Li.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Li.DISABLED=new Li(-1,0,0);class gE{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Xn={}}static wt(e,t,r,i){bt(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new gE(s,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ic(e).ee({index:_h,range:r},((i,s,a)=>{t=!1,a.done()})).next((()=>t))}addMutationBatch(e,t,r,i){const s=wf(e),a=Ic(e);return a.add({}).next((o=>{bt(typeof o=="number",49019);const l=new rb(o,t,r,i),u=(function(p,E,x){const w=x.baseMutations.map((I=>Ox(p.yt,I))),T=x.mutations.map((I=>Ox(p.yt,I)));return{userId:E,batchId:x.batchId,localWriteTimeMs:x.localWriteTime.toMillis(),baseMutations:w,mutations:T}})(this.serializer,this.userId,l),h=[];let f=new jn(((g,p)=>$t(g.canonicalString(),p.canonicalString())));for(const g of i){const p=O6(this.userId,g.key.path,o);f=f.add(g.key.path.popLast()),h.push(a.put(u)),h.push(s.put(p,Kq))}return f.forEach((g=>{h.push(this.indexManager.addToCollectionParentIndex(e,g))})),e.addOnCommittedListener((()=>{this.Xn[o]=l.keys()})),he.waitFor(h).next((()=>l))}))}lookupMutationBatch(e,t){return Ic(e).get(t).next((r=>r?(bt(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:t}),ch(this.serializer,r)):null))}er(e,t){return this.Xn[t]?he.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((r=>{if(r){const i=r.keys();return this.Xn[t]=i,i}return null}))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return Ic(e).ee({index:_h,range:i},((a,o,l)=>{o.userId===this.userId&&(bt(o.batchId>=r,47524,{tr:r}),s=ch(this.serializer,o)),l.done()})).next((()=>s))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=Th;return Ic(e).ee({index:_h,range:t,reverse:!0},((i,s,a)=>{r=s.batchId,a.done()})).next((()=>r))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Th],[this.userId,Number.POSITIVE_INFINITY]);return Ic(e).J(_h,t).next((r=>r.map((i=>ch(this.serializer,i)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=k_(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return wf(e).ee({range:i},((a,o,l)=>{const[u,h,f]=a,g=ko(h);if(u===this.userId&&t.path.isEqual(g))return Ic(e).get(f).next((p=>{if(!p)throw xt(61480,{nr:a,batchId:f});bt(p.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:p.userId,batchId:f}),s.push(ch(this.serializer,p))}));l.done()})).next((()=>s))}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new jn($t);const i=[];return t.forEach((s=>{const a=k_(this.userId,s.path),o=IDBKeyRange.lowerBound(a),l=wf(e).ee({range:o},((u,h,f)=>{const[g,p,E]=u,x=ko(p);g===this.userId&&s.path.isEqual(x)?r=r.add(E):f.done()}));i.push(l)})),he.waitFor(i).next((()=>this.rr(e,r)))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,s=k_(this.userId,r),a=IDBKeyRange.lowerBound(s);let o=new jn($t);return wf(e).ee({range:a},((l,u,h)=>{const[f,g,p]=l,E=ko(g);f===this.userId&&r.isPrefixOf(E)?E.length===i&&(o=o.add(p)):h.done()})).next((()=>this.rr(e,o)))}rr(e,t){const r=[],i=[];return t.forEach((s=>{i.push(Ic(e).get(s).next((a=>{if(a===null)throw xt(35274,{batchId:s});bt(a.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:a.userId,batchId:s}),r.push(ch(this.serializer,a))})))})),he.waitFor(i).next((()=>r))}removeMutationBatch(e,t){return zF(e.le,this.userId,t).next((r=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),he.forEach(r,(i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return he.resolve();const r=IDBKeyRange.lowerBound((function(a){return[a]})(this.userId)),i=[];return wf(e).ee({range:r},((s,a,o)=>{if(s[0]===this.userId){const l=ko(s[1]);i.push(l)}else o.done()})).next((()=>{bt(i.length===0,56720,{sr:i.map((s=>s.canonicalString()))})}))}))}containsKey(e,t){return $F(e,this.userId,t)}_r(e){return WF(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:Th,lastStreamToken:""}))}}function $F(n,e,t){const r=k_(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r);let a=!1;return wf(n).ee({range:s,X:!0},((o,l,u)=>{const[h,f,g]=o;h===e&&f===i&&(a=!0),u.done()})).next((()=>a))}function Ic(n){return Xr(n,Ba)}function wf(n){return Xr(n,u0)}function WF(n){return Xr(n,op)}class Yh{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Yh(0)}static cr(){return new Yh(-1)}}class xQ{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const r=new Yh(t.highestTargetId);return t.highestTargetId=r.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>Ct.fromTimestamp(new On(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,r){return this.lr(e).next((i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.hr(e,i))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((r=>(r.targetCount+=1,this.Tr(t,r),this.hr(e,r))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>lf(e).delete(t.targetId))).next((()=>this.lr(e))).next((r=>(bt(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r))))}removeTargets(e,t,r){let i=0;const s=[];return lf(e).ee(((a,o)=>{const l=tm(o);l.sequenceNumber<=t&&r.get(l.targetId)===null&&(i++,s.push(this.removeTargetData(e,l)))})).next((()=>he.waitFor(s))).next((()=>i))}forEachTarget(e,t){return lf(e).ee(((r,i)=>{const s=tm(i);t(s)}))}lr(e){return f3(e).get(Cx).next((t=>(bt(t!==null,2888),t)))}hr(e,t){return f3(e).put(Cx,t)}Pr(e,t){return lf(e).put(jF(this.serializer,t))}Tr(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const r=Wh(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return lf(e).ee({range:i,index:F6},((a,o,l)=>{const u=tm(o);o1(t,u.target)&&(s=u,l.done())})).next((()=>s))}addMatchingKeys(e,t,r){const i=[],s=Dc(e);return t.forEach((a=>{const o=Gi(a.path);i.push(s.put({targetId:r,path:o})),i.push(this.referenceDelegate.addReference(e,r,a))})),he.waitFor(i)}removeMatchingKeys(e,t,r){const i=Dc(e);return he.forEach(t,(s=>{const a=Gi(s.path);return he.waitFor([i.delete([r,a]),this.referenceDelegate.removeReference(e,r,s)])}))}removeMatchingKeysForTargetId(e,t){const r=Dc(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=Dc(e);let s=Qt();return i.ee({range:r,X:!0},((a,o,l)=>{const u=ko(a[1]),h=new ot(u);s=s.add(h)})).next((()=>s))}containsKey(e,t){const r=Gi(t.path),i=IDBKeyRange.bound([r],[R6(r)],!1,!0);let s=0;return Dc(e).ee({index:YA,X:!0,range:i},(([a,o],l,u)=>{a!==0&&(s++,u.done())})).next((()=>s>0))}At(e,t){return lf(e).get(t).next((r=>r?tm(r):null))}}function lf(n){return Xr(n,h0)}function f3(n){return Xr(n,Ih)}function Dc(n){return Xr(n,d0)}const g3="LruGarbageCollector",vQ=1048576;function m3([n,e],[t,r]){const i=$t(n,t);return i===0?$t(e,r):i}class EQ{constructor(e){this.Ir=e,this.buffer=new jn(m3),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();m3(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class HF{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Xe(g3,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Eu(t)?Xe(g3,"Ignoring IndexedDB error during garbage collection: ",t):await cd(t)}await this.Vr(3e5)}))}}class wQ{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return he.resolve(va.ce);const r=new EQ(t);return this.mr.forEachTarget(e,(i=>r.Ar(i.sequenceNumber))).next((()=>this.mr.pr(e,(i=>r.Ar(i))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Xe("LruGarbageCollector","Garbage collection skipped; disabled"),he.resolve(d3)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(Xe("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),d3):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,i,s,a,o,l,u;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((f=>(f>this.params.maximumSequenceNumbersToCollect?(Xe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),i=this.params.maximumSequenceNumbersToCollect):i=f,a=Date.now(),this.nthSequenceNumber(e,i)))).next((f=>(r=f,o=Date.now(),this.removeTargets(e,r,t)))).next((f=>(s=f,l=Date.now(),this.removeOrphanedDocuments(e,r)))).next((f=>(u=Date.now(),_f()<=rn.DEBUG&&Xe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-h}ms
	Determined least recently used ${i} in `+(o-a)+`ms
	Removed ${s} targets in `+(l-o)+`ms
	Removed ${f} documents in `+(u-l)+`ms
Total Duration: ${u-h}ms`),he.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:f}))))}}function KF(n,e){return new wQ(n,e)}class SQ{constructor(e,t){this.db=e,this.garbageCollector=KF(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((r,i)=>t(i)))}addReference(e,t,r){return Jy(e,r)}removeReference(e,t,r){return Jy(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Jy(e,t)}br(e,t){return(function(i,s){let a=!1;return WF(i).te((o=>$F(i,o,s).next((l=>(l&&(a=!0),he.resolve(!l)))))).next((()=>a))})(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Sr(e,((a,o)=>{if(o<=t){const l=this.br(e,a).next((u=>{if(!u)return s++,r.getEntry(e,a).next((()=>(r.removeEntry(a,Ct.min()),Dc(e).delete((function(f){return[0,Gi(f.path)]})(a)))))}));i.push(l)}})).next((()=>he.waitFor(i))).next((()=>r.apply(e))).next((()=>s))}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Jy(e,t)}Sr(e,t){const r=Dc(e);let i,s=va.ce;return r.ee({index:YA},(([a,o],{path:l,sequenceNumber:u})=>{a===0?(s!==va.ce&&t(new ot(ko(i)),s),s=u,i=l):s=va.ce})).next((()=>{s!==va.ce&&t(new ot(ko(i)),s)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Jy(n,e){return Dc(n).put((function(r,i){return{targetId:0,path:Gi(r.path),sequenceNumber:i}})(e,n.currentSequenceNumber))}class YF{constructor(){this.changes=new Wl((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,yr.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?he.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class TQ{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return qu(e).put(r)}removeEntry(e,t,r){return qu(e).delete((function(s,a){const o=s.path.toArray();return[o.slice(0,o.length-2),o[o.length-2],Dx(a),o[o.length-1]]})(t,r))}updateMetadata(e,t){return this.getMetadata(e).next((r=>(r.byteSize+=t,this.Dr(e,r))))}getEntry(e,t){let r=yr.newInvalidDocument(t);return qu(e).ee({index:M_,range:IDBKeyRange.only(Bg(t))},((i,s)=>{r=this.Cr(t,s)})).next((()=>r))}vr(e,t){let r={size:0,document:yr.newInvalidDocument(t)};return qu(e).ee({index:M_,range:IDBKeyRange.only(Bg(t))},((i,s)=>{r={document:this.Cr(t,s),size:jx(s)}})).next((()=>r))}getEntries(e,t){let r=Ys();return this.Fr(e,t,((i,s)=>{const a=this.Cr(i,s);r=r.insert(i,a)})).next((()=>r))}Mr(e,t){let r=Ys(),i=new tr(ot.comparator);return this.Fr(e,t,((s,a)=>{const o=this.Cr(s,a);r=r.insert(s,o),i=i.insert(s,jx(a))})).next((()=>({documents:r,Or:i})))}Fr(e,t,r){if(t.isEmpty())return he.resolve();let i=new jn(_3);t.forEach((l=>i=i.add(l)));const s=IDBKeyRange.bound(Bg(i.first()),Bg(i.last())),a=i.getIterator();let o=a.getNext();return qu(e).ee({index:M_,range:s},((l,u,h)=>{const f=ot.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;o&&_3(o,f)<0;)r(o,null),o=a.getNext();o&&o.isEqual(f)&&(r(o,u),o=a.hasNext()?a.getNext():null),o?h.j(Bg(o)):h.done()})).next((()=>{for(;o;)r(o,null),o=a.hasNext()?a.getNext():null}))}getDocumentsMatchingQuery(e,t,r,i,s){const a=t.path,o=[a.popLast().toArray(),a.lastSegment(),Dx(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[a.popLast().toArray(),a.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return qu(e).J(IDBKeyRange.bound(o,l,!0)).next((u=>{s?.incrementDocumentReadCount(u.length);let h=Ys();for(const f of u){const g=this.Cr(ot.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);g.isFoundDocument()&&(c1(t,g)||i.has(g.key))&&(h=h.insert(g.key,g))}return h}))}getAllFromCollectionGroup(e,t,r,i){let s=Ys();const a=y3(t,r),o=y3(t,Js.max());return qu(e).ee({index:D6,range:IDBKeyRange.bound(a,o,!0)},((l,u,h)=>{const f=this.Cr(ot.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);s=s.insert(f.key,f),s.size===i&&h.done()})).next((()=>s))}newChangeBuffer(e){return new IQ(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return p3(e).get(MT).next((t=>(bt(!!t,20021),t)))}Dr(e,t){return p3(e).put(MT,t)}Cr(e,t){if(t){const r=cQ(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(Ct.min())))return r}return yr.newInvalidDocument(e)}}function XF(n){return new TQ(n)}class IQ extends YF{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new Wl((r=>r.toString()),((r,i)=>r.isEqual(i)))}applyChanges(e){const t=[];let r=0,i=new jn(((s,a)=>$t(s.canonicalString(),a.canonicalString())));return this.changes.forEach(((s,a)=>{const o=this.Br.get(s);if(t.push(this.Nr.removeEntry(e,s,o.readTime)),a.isValidDocument()){const l=JM(this.Nr.serializer,a);i=i.add(s.path.popLast());const u=jx(l);r+=u-o.size,t.push(this.Nr.addEntry(e,s,l))}else if(r-=o.size,this.trackRemovals){const l=JM(this.Nr.serializer,a.convertToNoDocument(Ct.min()));t.push(this.Nr.addEntry(e,s,l))}})),i.forEach((s=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))})),t.push(this.Nr.updateMetadata(e,r)),he.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((r=>(this.Br.set(t,{size:r.size,readTime:r.document.readTime}),r.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:r,Or:i})=>(i.forEach(((s,a)=>{this.Br.set(s,{size:a,readTime:r.get(s).readTime})})),r)))}}function p3(n){return Xr(n,lp)}function qu(n){return Xr(n,Rx)}function Bg(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function y3(n,e){const t=e.documentKey.path.toArray();return[n,Dx(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function _3(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=$t(t[s],r[s]),i)return i;return i=$t(t.length,r.length),i||(i=$t(t[t.length-2],r[r.length-2]),i||$t(t[t.length-1],r[r.length-1]))}class AQ{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class qF{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(r=i,this.remoteDocumentCache.getEntry(e,t)))).next((i=>(r!==null&&Em(r.mutation,i,vs.empty(),On.now()),i)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,Qt()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=Qt()){const i=Mo();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,r).next((s=>{let a=Jg();return s.forEach(((o,l)=>{a=a.insert(o,l.overlayedDocument)})),a}))))}getOverlayedDocuments(e,t){const r=Mo();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,Qt())))}populateOverlays(e,t,r){const i=[];return r.forEach((s=>{t.has(s)||i.push(s)})),this.documentOverlayCache.getOverlays(e,i).next((s=>{s.forEach(((a,o)=>{t.set(a,o)}))}))}computeViews(e,t,r,i){let s=Ys();const a=vm(),o=(function(){return vm()})();return t.forEach(((l,u)=>{const h=r.get(u.key);i.has(u.key)&&(h===void 0||h.mutation instanceof Hl)?s=s.insert(u.key,u):h!==void 0?(a.set(u.key,h.mutation.getFieldMask()),Em(h.mutation,u,h.mutation.getFieldMask(),On.now())):a.set(u.key,vs.empty())})),this.recalculateAndSaveOverlays(e,s).next((l=>(l.forEach(((u,h)=>a.set(u,h))),t.forEach(((u,h)=>o.set(u,new AQ(h,a.get(u)??null)))),o)))}recalculateAndSaveOverlays(e,t){const r=vm();let i=new tr(((a,o)=>a-o)),s=Qt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((a=>{for(const o of a)o.keys().forEach((l=>{const u=t.get(l);if(u===null)return;let h=r.get(l)||vs.empty();h=o.applyToLocalView(u,h),r.set(l,h);const f=(i.get(o.batchId)||Qt()).add(l);i=i.insert(o.batchId,f)}))})).next((()=>{const a=[],o=i.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),u=l.key,h=l.value,f=fF();h.forEach((g=>{if(!s.has(g)){const p=vF(t.get(g),r.get(g));p!==null&&f.set(g,p),s=s.add(g)}})),a.push(this.documentOverlayCache.saveOverlays(e,u,f))}return he.waitFor(a)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,i){return(function(a){return ot.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):lF(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next((s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):he.resolve(Mo());let o=ip,l=s;return a.next((u=>he.forEach(u,((h,f)=>(o<f.largestBatchId&&(o=f.largestBatchId),s.get(h)?he.resolve():this.remoteDocumentCache.getEntry(e,h).next((g=>{l=l.insert(h,g)}))))).next((()=>this.populateOverlays(e,u,s))).next((()=>this.computeViews(e,l,u,Qt()))).next((h=>({batchId:o,changes:dF(h)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ot(t)).next((r=>{let i=Jg();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const s=t.collectionGroup;let a=Jg();return this.indexManager.getCollectionParents(e,s).next((o=>he.forEach(o,(l=>{const u=(function(f,g){return new l1(g,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)})(t,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next((h=>{h.forEach(((f,g)=>{a=a.insert(f,g)}))}))})).next((()=>a))))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i)))).next((a=>{s.forEach(((l,u)=>{const h=u.getKey();a.get(h)===null&&(a=a.insert(h,yr.newInvalidDocument(h)))}));let o=Jg();return a.forEach(((l,u)=>{const h=s.get(l);h!==void 0&&Em(h.mutation,u,vs.empty(),On.now()),c1(t,u)&&(o=o.insert(l,u))})),o}))}}class bQ{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return he.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:ts(i.createTime)}})(t)),he.resolve()}getNamedQuery(e,t){return he.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(i){return{name:i.name,query:VF(i.bundledQuery),readTime:ts(i.readTime)}})(t)),he.resolve()}}class RQ{constructor(){this.overlays=new tr(ot.comparator),this.qr=new Map}getOverlay(e,t){return he.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Mo();return he.forEach(t,(i=>this.getOverlay(e,i).next((s=>{s!==null&&r.set(i,s)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((i,s)=>{this.St(e,t,s)})),he.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach((s=>this.overlays=this.overlays.remove(s))),this.qr.delete(r)),he.resolve()}getOverlaysForCollection(e,t,r){const i=Mo(),s=t.length+1,a=new ot(t.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,u=l.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return he.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new tr(((u,h)=>u-h));const a=this.overlays.getIterator();for(;a.hasNext();){const u=a.getNext().value;if(u.getKey().getCollectionGroup()===t&&u.largestBatchId>r){let h=s.get(u.largestBatchId);h===null&&(h=Mo(),s=s.insert(u.largestBatchId,h)),h.set(u.getKey(),u)}}const o=Mo(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach(((u,h)=>o.set(u,h))),!(o.size()>=i)););return he.resolve(o)}St(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const a=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new sb(t,r));let s=this.qr.get(t);s===void 0&&(s=Qt(),this.qr.set(t,s)),this.qr.set(t,s.add(r.key))}}class CQ{constructor(){this.sessionToken=Or.EMPTY_BYTE_STRING}getSessionToken(e){return he.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,he.resolve()}}class ub{constructor(){this.Qr=new jn(ti.$r),this.Ur=new jn(ti.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new ti(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Gr(new ti(e,t))}zr(e,t){e.forEach((r=>this.removeReference(r,t)))}jr(e){const t=new ot(new Sn([])),r=new ti(t,e),i=new ti(t,e+1),s=[];return this.Ur.forEachInRange([r,i],(a=>{this.Gr(a),s.push(a.key)})),s}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new ot(new Sn([])),r=new ti(t,e),i=new ti(t,e+1);let s=Qt();return this.Ur.forEachInRange([r,i],(a=>{s=s.add(a.key)})),s}containsKey(e){const t=new ti(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class ti{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return ot.comparator(e.key,t.key)||$t(e.Yr,t.Yr)}static Kr(e,t){return $t(e.Yr,t.Yr)||ot.comparator(e.key,t.key)}}class PQ{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new jn(ti.$r)}checkEmpty(e){return he.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new rb(s,t,r,i);this.mutationQueue.push(a);for(const o of i)this.Zr=this.Zr.add(new ti(o.key,s)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return he.resolve(a)}lookupMutationBatch(e,t){return he.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.ei(r),s=i<0?0:i;return he.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return he.resolve(this.mutationQueue.length===0?Th:this.tr-1)}getAllMutationBatches(e){return he.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new ti(t,0),i=new ti(t,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([r,i],(a=>{const o=this.Xr(a.Yr);s.push(o)})),he.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new jn($t);return t.forEach((i=>{const s=new ti(i,0),a=new ti(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,a],(o=>{r=r.add(o.Yr)}))})),he.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let s=r;ot.isDocumentKey(s)||(s=s.child(""));const a=new ti(new ot(s),0);let o=new jn($t);return this.Zr.forEachWhile((l=>{const u=l.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(o=o.add(l.Yr)),!0)}),a),he.resolve(this.ti(o))}ti(e){const t=[];return e.forEach((r=>{const i=this.Xr(r);i!==null&&t.push(i)})),t}removeMutationBatch(e,t){bt(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return he.forEach(t.mutations,(i=>{const s=new ti(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,t){const r=new ti(t,0),i=this.Zr.firstAfterOrEqual(r);return he.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,he.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class kQ{constructor(e){this.ri=e,this.docs=(function(){return new tr(ot.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),s=i?i.size:0,a=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return he.resolve(r?r.document.mutableCopy():yr.newInvalidDocument(t))}getEntries(e,t){let r=Ys();return t.forEach((i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():yr.newInvalidDocument(i))})),he.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=Ys();const a=t.path,o=new ot(a.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:u,value:{document:h}}=l.getNext();if(!a.isPrefixOf(u.path))break;u.path.length>a.length+1||HA(k6(h),r)<=0||(i.has(h.key)||c1(t,h))&&(s=s.insert(h.key,h.mutableCopy()))}return he.resolve(s)}getAllFromCollectionGroup(e,t,r,i){xt(9500)}ii(e,t){return he.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new MQ(this)}getSize(e){return he.resolve(this.size)}}class MQ extends YF{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,i)=>{i.isValidDocument()?t.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)})),he.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class NQ{constructor(e){this.persistence=e,this.si=new Wl((t=>Wh(t)),o1),this.lastRemoteSnapshotVersion=Ct.min(),this.highestTargetId=0,this.oi=0,this._i=new ub,this.targetCount=0,this.ai=Yh.ur()}forEachTarget(e,t){return this.si.forEach(((r,i)=>t(i))),he.resolve()}getLastRemoteSnapshotVersion(e){return he.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return he.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),he.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),he.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Yh(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,he.resolve()}updateTargetData(e,t){return this.Pr(t),he.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,he.resolve()}removeTargets(e,t,r){let i=0;const s=[];return this.si.forEach(((a,o)=>{o.sequenceNumber<=t&&r.get(o.targetId)===null&&(this.si.delete(a),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)})),he.waitFor(s).next((()=>i))}getTargetCount(e){return he.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return he.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),he.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach((a=>{s.push(i.markPotentiallyOrphaned(e,a))})),he.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),he.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return he.resolve(r)}containsKey(e,t){return he.resolve(this._i.containsKey(t))}}class hb{constructor(e,t){this.ui={},this.overlays={},this.ci=new va(0),this.li=!1,this.li=!0,this.hi=new CQ,this.referenceDelegate=e(this),this.Pi=new NQ(this),this.indexManager=new yQ,this.remoteDocumentCache=(function(i){return new kQ(i)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new FF(t),this.Ii=new bQ(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new RQ,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new PQ(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){Xe("MemoryPersistence","Starting transaction:",e);const i=new LQ(this.ci.next());return this.referenceDelegate.Ei(),r(i).next((s=>this.referenceDelegate.di(i).next((()=>s)))).toPromise().then((s=>(i.raiseOnCommittedEvent(),s)))}Ai(e,t){return he.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,t))))}}class LQ extends N6{constructor(e){super(),this.currentSequenceNumber=e}}class mE{constructor(e){this.persistence=e,this.Ri=new ub,this.Vi=null}static mi(e){return new mE(e)}get fi(){if(this.Vi)return this.Vi;throw xt(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),he.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),he.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),he.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((i=>this.fi.add(i.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((i=>{i.forEach((s=>this.fi.add(s.toString())))})).next((()=>r.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return he.forEach(this.fi,(r=>{const i=ot.fromPath(r);return this.gi(e,i).next((s=>{s||t.removeEntry(i,Ct.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return he.or([()=>he.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Vx{constructor(e,t){this.persistence=e,this.pi=new Wl((r=>Gi(r.path)),((r,i)=>r.isEqual(i))),this.garbageCollector=KF(this,t)}static mi(e,t){return new Vx(e,t)}Ei(){}di(e){return he.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}pr(e,t){return he.forEach(this.pi,((r,i)=>this.br(e,r,i).next((s=>s?he.resolve():t(i)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ii(e,(a=>this.br(e,a,t).next((o=>{o||(r++,s.removeEntry(a,Ct.min()))})))).next((()=>s.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),he.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),he.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),he.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),he.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=L_(e.data.value)),t}br(e,t,r){return he.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.pi.get(t);return he.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class OQ{constructor(e){this.serializer=e}k(e,t,r,i){const s=new eE("createOrUpgrade",t);r<1&&i>=1&&((function(l){l.createObjectStore(a1)})(e),(function(l){l.createObjectStore(op,{keyPath:Hq}),l.createObjectStore(Ba,{keyPath:CM,autoIncrement:!0}).createIndex(_h,PM,{unique:!0}),l.createObjectStore(u0)})(e),x3(e),(function(l){l.createObjectStore(rh)})(e));let a=he.resolve();return r<3&&i>=3&&(r!==0&&((function(l){l.deleteObjectStore(d0),l.deleteObjectStore(h0),l.deleteObjectStore(Ih)})(e),x3(e)),a=a.next((()=>(function(l){const u=l.store(Ih),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Ct.min().toTimestamp(),targetCount:0};return u.put(Cx,h)})(s)))),r<4&&i>=4&&(r!==0&&(a=a.next((()=>(function(l,u){return u.store(Ba).J().next((f=>{l.deleteObjectStore(Ba),l.createObjectStore(Ba,{keyPath:CM,autoIncrement:!0}).createIndex(_h,PM,{unique:!0});const g=u.store(Ba),p=f.map((E=>g.put(E)));return he.waitFor(p)}))})(e,s)))),a=a.next((()=>{(function(l){l.createObjectStore(f0,{keyPath:tZ})})(e)}))),r<5&&i>=5&&(a=a.next((()=>this.yi(s)))),r<6&&i>=6&&(a=a.next((()=>((function(l){l.createObjectStore(lp)})(e),this.wi(s))))),r<7&&i>=7&&(a=a.next((()=>this.Si(s)))),r<8&&i>=8&&(a=a.next((()=>this.bi(e,s)))),r<9&&i>=9&&(a=a.next((()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)}))),r<10&&i>=10&&(a=a.next((()=>this.Di(s)))),r<11&&i>=11&&(a=a.next((()=>{(function(l){l.createObjectStore(nE,{keyPath:nZ})})(e),(function(l){l.createObjectStore(rE,{keyPath:rZ})})(e)}))),r<12&&i>=12&&(a=a.next((()=>{(function(l){const u=l.createObjectStore(iE,{keyPath:uZ});u.createIndex(LT,hZ,{unique:!1}),u.createIndex(G6,dZ,{unique:!1})})(e)}))),r<13&&i>=13&&(a=a.next((()=>(function(l){const u=l.createObjectStore(Rx,{keyPath:Yq});u.createIndex(M_,Xq),u.createIndex(D6,qq)})(e))).next((()=>this.Ci(e,s))).next((()=>e.deleteObjectStore(rh)))),r<14&&i>=14&&(a=a.next((()=>this.Fi(e,s)))),r<15&&i>=15&&(a=a.next((()=>(function(l){l.createObjectStore(XA,{keyPath:iZ,autoIncrement:!0}).createIndex(NT,sZ,{unique:!1}),l.createObjectStore(pm,{keyPath:aZ}).createIndex(j6,oZ,{unique:!1}),l.createObjectStore(ym,{keyPath:lZ}).createIndex(V6,cZ,{unique:!1})})(e)))),r<16&&i>=16&&(a=a.next((()=>{t.objectStore(pm).clear()})).next((()=>{t.objectStore(ym).clear()}))),r<17&&i>=17&&(a=a.next((()=>{(function(l){l.createObjectStore(qA,{keyPath:fZ})})(e)}))),r<18&&i>=18&&LD()&&(a=a.next((()=>{t.objectStore(pm).clear()})).next((()=>{t.objectStore(ym).clear()}))),a}wi(e){let t=0;return e.store(rh).ee(((r,i)=>{t+=jx(i)})).next((()=>{const r={byteSize:t};return e.store(lp).put(MT,r)}))}yi(e){const t=e.store(op),r=e.store(Ba);return t.J().next((i=>he.forEach(i,(s=>{const a=IDBKeyRange.bound([s.userId,Th],[s.userId,s.lastAcknowledgedBatchId]);return r.J(_h,a).next((o=>he.forEach(o,(l=>{bt(l.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:l.batchId});const u=ch(this.serializer,l);return zF(e,s.userId,u).next((()=>{}))}))))}))))}Si(e){const t=e.store(d0),r=e.store(rh);return e.store(Ih).get(Cx).next((i=>{const s=[];return r.ee(((a,o)=>{const l=new Sn(a),u=(function(f){return[0,Gi(f)]})(l);s.push(t.get(u).next((h=>h?he.resolve():(f=>t.put({targetId:0,path:Gi(f),sequenceNumber:i.highestListenSequenceNumber}))(l))))})).next((()=>he.waitFor(s)))}))}bi(e,t){e.createObjectStore(cp,{keyPath:eZ});const r=t.store(cp),i=new cb,s=a=>{if(i.add(a)){const o=a.lastSegment(),l=a.popLast();return r.put({collectionId:o,parent:Gi(l)})}};return t.store(rh).ee({X:!0},((a,o)=>{const l=new Sn(a);return s(l.popLast())})).next((()=>t.store(u0).ee({X:!0},(([a,o,l],u)=>{const h=ko(o);return s(h.popLast())}))))}Di(e){const t=e.store(h0);return t.ee(((r,i)=>{const s=tm(i),a=jF(this.serializer,s);return t.put(a)}))}Ci(e,t){const r=t.store(rh),i=[];return r.ee(((s,a)=>{const o=t.store(Rx),l=(function(f){return f.document?new ot(Sn.fromString(f.document.name).popFirst(5)):f.noDocument?ot.fromSegments(f.noDocument.path):f.unknownDocument?ot.fromSegments(f.unknownDocument.path):xt(36783)})(a).path.toArray(),u={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:a.readTime||[0,0],unknownDocument:a.unknownDocument,noDocument:a.noDocument,document:a.document,hasCommittedMutations:!!a.hasCommittedMutations};i.push(o.put(u))})).next((()=>he.waitFor(i)))}Fi(e,t){const r=t.store(Ba),i=XF(this.serializer),s=new hb(mE.mi,this.serializer.yt);return r.J().next((a=>{const o=new Map;return a.forEach((l=>{let u=o.get(l.userId)??Qt();ch(this.serializer,l).keys().forEach((h=>u=u.add(h))),o.set(l.userId,u)})),he.forEach(o,((l,u)=>{const h=new _i(u),f=fE.wt(this.serializer,h),g=s.getIndexManager(h),p=gE.wt(h,this.serializer,g,s.referenceDelegate);return new qF(i,p,f,g).recalculateAndSaveOverlaysForDocumentKeys(new OT(t,va.ce),l).next()}))}))}}function x3(n){n.createObjectStore(d0,{keyPath:Qq}).createIndex(YA,Jq,{unique:!0}),n.createObjectStore(h0,{keyPath:"targetId"}).createIndex(F6,Zq,{unique:!0}),n.createObjectStore(Ih)}const Ac="IndexedDbPersistence",oS=18e5,lS=5e3,cS="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",DQ="main";class db{constructor(e,t,r,i,s,a,o,l,u,h,f=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Mi=s,this.window=a,this.document=o,this.xi=u,this.Oi=h,this.Ni=f,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=g=>Promise.resolve(),!db.v())throw new st(ke.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new SQ(this,i),this.$i=t+DQ,this.serializer=new FF(l),this.Ui=new eu(this.$i,this.Ni,new OQ(this.serializer)),this.hi=new hQ,this.Pi=new xQ(this.referenceDelegate,this.serializer),this.remoteDocumentCache=XF(this.serializer),this.Ii=new uQ,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,h===!1&&Ji(Ac,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new st(ke.FAILED_PRECONDITION,cS);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new va(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>e_(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(Eu(e))return Xe(Ac,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Xe(Ac,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return Ug(e).get(nf).next((t=>he.resolve(this.es(t))))}ts(e){return e_(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,oS)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const r=Xr(t,f0);return r.J().next((i=>{const s=this.ss(i,oS),a=i.filter((o=>s.indexOf(o)===-1));return he.forEach(a,(o=>r.delete(o.clientId))).next((()=>a))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?he.resolve(!0):Ug(e).get(nf).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,lS)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new st(ke.FAILED_PRECONDITION,cS);return!1}}return!(!this.networkEnabled||!this.inForeground)||e_(e).J().next((r=>this.ss(r,lS).find((i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,a=!this.inForeground&&i.inForeground,o=this.networkEnabled===i.networkEnabled;if(s||a&&o)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&Xe(Ac,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[a1,f0],(e=>{const t=new OT(e,va.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((r=>this.rs(r.updateTimeMs,t)&&!this.us(r.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>e_(e).J().next((t=>this.ss(t,oS).map((r=>r.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return gE.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new _Q(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return fE.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,r){Xe(Ac,"Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",s=(function(l){return l===18?pZ:l===17?$6:l===16?mZ:l===15?ZA:l===14?z6:l===13?U6:l===12?gZ:l===11?B6:void xt(60245)})(this.Ni);let a;return this.Ui.runTransaction(e,i,s,(o=>(a=new OT(o,this.ci?this.ci.next():va.ce),t==="readwrite-primary"?this.Hi(a).next((l=>!!l||this.Yi(a))).next((l=>{if(!l)throw Ji(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new st(ke.FAILED_PRECONDITION,M6);return r(a)})).next((l=>this.Xi(a).next((()=>l)))):this.Is(a).next((()=>r(a)))))).then((o=>(a.raiseOnCommittedEvent(),o)))}Is(e){return Ug(e).get(nf).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,lS)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new st(ke.FAILED_PRECONDITION,cS)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Ug(e).put(nf,t)}static v(){return eu.v()}Zi(e){const t=Ug(e);return t.get(nf).next((r=>this.es(r)?(Xe(Ac,"Releasing primary lease."),t.delete(nf)):he.resolve()))}rs(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(Ji(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;ND()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const t=this.Ki?.getItem(this._s(e))!==null;return Xe(Ac,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return Ji(Ac,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){Ji("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Ug(n){return Xr(n,a1)}function e_(n){return Xr(n,f0)}function FQ(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class fb{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=i}static As(e,t){let r=Qt(),i=Qt();for(const s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new fb(e,t.fromCache,r,i)}}class jQ{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class ZF{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return ND()?8:L6(Kr())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,i){const s={result:null};return this.ys(e,t).next((a=>{s.result=a})).next((()=>{if(!s.result)return this.ws(e,t,i,r).next((a=>{s.result=a}))})).next((()=>{if(s.result)return;const a=new jQ;return this.Ss(e,t,a).next((o=>{if(s.result=o,this.Vs)return this.bs(e,t,a,o.size)}))})).next((()=>s.result))}bs(e,t,r,i){return r.documentReadCount<this.fs?(_f()<=rn.DEBUG&&Xe("QueryEngine","SDK will not create cache indexes for query:",xf(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),he.resolve()):(_f()<=rn.DEBUG&&Xe("QueryEngine","Query:",xf(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(_f()<=rn.DEBUG&&Xe("QueryEngine","The SDK decides to create cache indexes for query:",xf(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,wa(t))):he.resolve())}ys(e,t){if(zM(t))return he.resolve(null);let r=wa(t);return this.indexManager.getIndexType(e,r).next((i=>i===0?null:(t.limit!==null&&i===1&&(t=UT(t,null,"F"),r=wa(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((s=>{const a=Qt(...s);return this.ps.getDocuments(e,a).next((o=>this.indexManager.getMinOffset(e,r).next((l=>{const u=this.Ds(t,o);return this.Cs(t,u,a,l.readTime)?this.ys(e,UT(t,null,"F")):this.vs(e,u,t,l)}))))})))))}ws(e,t,r,i){return zM(t)||i.isEqual(Ct.min())?he.resolve(null):this.ps.getDocuments(e,r).next((s=>{const a=this.Ds(t,s);return this.Cs(t,a,r,i)?he.resolve(null):(_f()<=rn.DEBUG&&Xe("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),xf(t)),this.vs(e,a,t,Vq(i,ip)).next((o=>o)))}))}Ds(e,t){let r=new jn(uF(e));return t.forEach(((i,s)=>{c1(e,s)&&(r=r.add(s))})),r}Cs(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,t,r){return _f()<=rn.DEBUG&&Xe("QueryEngine","Using full collection scan to execute query:",xf(t)),this.ps.getDocumentsMatchingQuery(e,t,Js.min(),r)}vs(e,t,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next((s=>(t.forEach((a=>{s=s.insert(a.key,a)})),s)))}}const gb="LocalStore",VQ=3e8;class GQ{constructor(e,t,r,i){this.persistence=e,this.Fs=t,this.serializer=i,this.Ms=new tr($t),this.xs=new Wl((s=>Wh(s)),o1),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new qF(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function QF(n,e,t,r){return new GQ(n,e,t,r)}async function JF(n,e){const t=Wt(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next((s=>(i=s,t.Bs(e),t.mutationQueue.getAllMutationBatches(r)))).next((s=>{const a=[],o=[];let l=Qt();for(const u of i){a.push(u.batchId);for(const h of u.mutations)l=l.add(h.key)}for(const u of s){o.push(u.batchId);for(const h of u.mutations)l=l.add(h.key)}return t.localDocuments.getDocuments(r,l).next((u=>({Ls:u,removedBatchIds:a,addedBatchIds:o})))}))}))}function BQ(n,e){const t=Wt(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const i=e.batch.keys(),s=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(o,l,u,h){const f=u.batch,g=f.keys();let p=he.resolve();return g.forEach((E=>{p=p.next((()=>h.getEntry(l,E))).next((x=>{const w=u.docVersions.get(E);bt(w!==null,48541),x.version.compareTo(w)<0&&(f.applyToRemoteDocument(x,u),x.isValidDocument()&&(x.setReadTime(u.commitVersion),h.addEntry(x)))}))})),p.next((()=>o.mutationQueue.removeMutationBatch(l,f)))})(t,r,e,s).next((()=>s.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(o){let l=Qt();for(let u=0;u<o.mutationResults.length;++u)o.mutationResults[u].transformResults.length>0&&(l=l.add(o.batch.mutations[u].key));return l})(e)))).next((()=>t.localDocuments.getDocuments(r,i)))}))}function e8(n){const e=Wt(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function UQ(n,e){const t=Wt(n),r=e.snapshotVersion;let i=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(s=>{const a=t.Ns.newChangeBuffer({trackRemovals:!0});i=t.Ms;const o=[];e.targetChanges.forEach(((h,f)=>{const g=i.get(f);if(!g)return;o.push(t.Pi.removeMatchingKeys(s,h.removedDocuments,f).next((()=>t.Pi.addMatchingKeys(s,h.addedDocuments,f))));let p=g.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(f)!==null?p=p.withResumeToken(Or.EMPTY_BYTE_STRING,Ct.min()).withLastLimboFreeSnapshotVersion(Ct.min()):h.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(h.resumeToken,r)),i=i.insert(f,p),(function(x,w,T){return x.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=VQ?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0})(g,p,h)&&o.push(t.Pi.updateTargetData(s,p))}));let l=Ys(),u=Qt();if(e.documentUpdates.forEach((h=>{e.resolvedLimboDocuments.has(h)&&o.push(t.persistence.referenceDelegate.updateLimboDocument(s,h))})),o.push(zQ(s,a,e.documentUpdates).next((h=>{l=h.ks,u=h.qs}))),!r.isEqual(Ct.min())){const h=t.Pi.getLastRemoteSnapshotVersion(s).next((f=>t.Pi.setTargetsMetadata(s,s.currentSequenceNumber,r)));o.push(h)}return he.waitFor(o).next((()=>a.apply(s))).next((()=>t.localDocuments.getLocalViewOfDocuments(s,l,u))).next((()=>l))})).then((s=>(t.Ms=i,s)))}function zQ(n,e,t){let r=Qt(),i=Qt();return t.forEach((s=>r=r.add(s))),e.getEntries(n,r).next((s=>{let a=Ys();return t.forEach(((o,l)=>{const u=s.get(o);l.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(o)),l.isNoDocument()&&l.version.isEqual(Ct.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):Xe(gb,"Ignoring outdated watch update for ",o,". Current version:",u.version," Watch version:",l.version)})),{ks:a,qs:i}}))}function $Q(n,e){const t=Wt(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=Th),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function WQ(n,e){const t=Wt(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let i;return t.Pi.getTargetData(r,e).next((s=>s?(i=s,he.resolve(i)):t.Pi.allocateTargetId(r).next((a=>(i=new wl(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,i).next((()=>i)))))))})).then((r=>{const i=t.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r}))}async function qT(n,e,t){const r=Wt(n),i=r.Ms.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,(a=>r.persistence.referenceDelegate.removeTarget(a,i)))}catch(a){if(!Eu(a))throw a;Xe(gb,`Failed to update sequence numbers for target ${e}: ${a}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function v3(n,e,t){const r=Wt(n);let i=Ct.min(),s=Qt();return r.persistence.runTransaction("Execute query","readwrite",(a=>(function(l,u,h){const f=Wt(l),g=f.xs.get(h);return g!==void 0?he.resolve(f.Ms.get(g)):f.Pi.getTargetData(u,h)})(r,a,wa(e)).next((o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(a,o.targetId).next((l=>{s=l}))})).next((()=>r.Fs.getDocumentsMatchingQuery(a,e,t?i:Ct.min(),t?s:Qt()))).next((o=>(HQ(r,kZ(e),o),{documents:o,Qs:s})))))}function HQ(n,e,t){let r=n.Os.get(e)||Ct.min();t.forEach(((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)})),n.Os.set(e,r)}class E3{constructor(){this.activeTargetIds=FZ()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class t8{constructor(){this.Mo=new E3,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new E3,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class KQ{Oo(e){}shutdown(){}}const w3="ConnectivityMonitor";class S3{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Xe(w3,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Xe(w3,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let t_=null;function ZT(){return t_===null?t_=(function(){return 268435456+Math.round(2147483648*Math.random())})():t_++,"0x"+t_.toString(16)}const uS="RestConnection",YQ={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class XQ{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===Px?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,t,r,i,s){const a=ZT(),o=this.zo(e,t.toUriEncodedString());Xe(uS,`Sending RPC '${e}' ${a}:`,o,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,i,s);const{host:u}=new URL(o),h=od(u);return this.Jo(e,o,l,r,h).then((f=>(Xe(uS,`Received RPC '${e}' ${a}: `,f),f)),(f=>{throw zh(uS,`RPC '${e}' ${a} failed with error: `,f,"url: ",o,"request:",r),f}))}Ho(e,t,r,i,s,a){return this.Go(e,t,r,i,s)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+L0})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((i,s)=>e[s]=i)),r&&r.headers.forEach(((i,s)=>e[s]=i))}zo(e,t){const r=YQ[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}class qQ{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const ki="WebChannelConnection";class ZQ extends XQ{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,i,s){const a=ZT();return new Promise(((o,l)=>{const u=new E6;u.setWithCredentials(!0),u.listenOnce(w6.COMPLETE,(()=>{try{switch(u.getLastErrorCode()){case C_.NO_ERROR:const f=u.getResponseJson();Xe(ki,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(f)),o(f);break;case C_.TIMEOUT:Xe(ki,`RPC '${e}' ${a} timed out`),l(new st(ke.DEADLINE_EXCEEDED,"Request time out"));break;case C_.HTTP_ERROR:const g=u.getStatus();if(Xe(ki,`RPC '${e}' ${a} failed with status:`,g,"response text:",u.getResponseText()),g>0){let p=u.getResponseJson();Array.isArray(p)&&(p=p[0]);const E=p?.error;if(E&&E.status&&E.message){const x=(function(T){const I=T.toLowerCase().replace(/_/g,"-");return Object.values(ke).indexOf(I)>=0?I:ke.UNKNOWN})(E.status);l(new st(x,E.message))}else l(new st(ke.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new st(ke.UNAVAILABLE,"Connection failed."));break;default:xt(9055,{l_:e,streamId:a,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{Xe(ki,`RPC '${e}' ${a} completed.`)}}));const h=JSON.stringify(i);Xe(ki,`RPC '${e}' ${a} sending request:`,i),u.send(t,"POST",h,r,15)}))}T_(e,t,r){const i=ZT(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=I6(),o=T6(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;const h=s.join("");Xe(ki,`Creating RPC '${e}' stream ${i}: ${h}`,l);const f=a.createWebChannel(h,l);this.I_(f);let g=!1,p=!1;const E=new qQ({Yo:w=>{p?Xe(ki,`Not sending because RPC '${e}' stream ${i} is closed:`,w):(g||(Xe(ki,`Opening RPC '${e}' stream ${i} transport.`),f.open(),g=!0),Xe(ki,`RPC '${e}' stream ${i} sending:`,w),f.send(w))},Zo:()=>f.close()}),x=(w,T,I)=>{w.listen(T,(P=>{try{I(P)}catch(N){setTimeout((()=>{throw N}),0)}}))};return x(f,Qg.EventType.OPEN,(()=>{p||(Xe(ki,`RPC '${e}' stream ${i} transport opened.`),E.o_())})),x(f,Qg.EventType.CLOSE,(()=>{p||(p=!0,Xe(ki,`RPC '${e}' stream ${i} transport closed`),E.a_(),this.E_(f))})),x(f,Qg.EventType.ERROR,(w=>{p||(p=!0,zh(ki,`RPC '${e}' stream ${i} transport errored. Name:`,w.name,"Message:",w.message),E.a_(new st(ke.UNAVAILABLE,"The operation could not be completed")))})),x(f,Qg.EventType.MESSAGE,(w=>{if(!p){const T=w.data[0];bt(!!T,16349);const I=T,P=I?.error||I[0]?.error;if(P){Xe(ki,`RPC '${e}' stream ${i} received error:`,P);const N=P.status;let D=(function(C){const M=kr[C];if(M!==void 0)return SF(M)})(N),B=P.message;D===void 0&&(D=ke.INTERNAL,B="Unknown error status: "+N+" with message "+P.message),p=!0,E.a_(new st(D,B)),f.close()}else Xe(ki,`RPC '${e}' stream ${i} received:`,T),E.u_(T)}})),x(o,S6.STAT_EVENT,(w=>{w.stat===CT.PROXY?Xe(ki,`RPC '${e}' stream ${i} detected buffering proxy`):w.stat===CT.NOPROXY&&Xe(ki,`RPC '${e}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{E.__()}),0),E}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function QQ(){return typeof window<"u"?window:null}function V_(){return typeof document<"u"?document:null}function pE(n){return new JZ(n,!0)}class n8{constructor(e,t,r=1e3,i=1.5,s=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=i,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-r);i>0&&Xe("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const T3="PersistentStream";class r8{constructor(e,t,r,i,s,a,o,l){this.Mi=e,this.S_=r,this.b_=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new n8(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ke.RESOURCE_EXHAUSTED?(Ji(t.toString()),Ji("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ke.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,i])=>{this.D_===t&&this.G_(r,i)}),(r=>{e((()=>{const i=new st(ke.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)}))}))}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((i=>{r((()=>this.z_(i)))})),this.stream.onMessage((i=>{r((()=>++this.F_==1?this.J_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Xe(T3,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(Xe(T3,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class JQ extends r8{constructor(e,t,r,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=nQ(this.serializer,e),r=(function(s){if(!("targetChange"in s))return Ct.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?Ct.min():a.readTime?ts(a.readTime):Ct.min()})(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=WT(this.serializer),t.addTarget=(function(s,a){let o;const l=a.target;if(o=Mx(l)?{documents:kF(s,l)}:{query:MF(s,l).ft},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=AF(s,a.resumeToken);const u=zT(s,a.expectedCount);u!==null&&(o.expectedCount=u)}else if(a.snapshotVersion.compareTo(Ct.min())>0){o.readTime=E0(s,a.snapshotVersion.toTimestamp());const u=zT(s,a.expectedCount);u!==null&&(o.expectedCount=u)}return o})(this.serializer,e);const r=iQ(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=WT(this.serializer),t.removeTarget=e,this.q_(t)}}class eJ extends r8{constructor(e,t,r,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return bt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,bt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){bt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=rQ(e.writeResults,e.commitTime),r=ts(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=WT(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>Ox(this.serializer,r)))};this.q_(t)}}class tJ{}class nJ extends tJ{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new st(ke.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,a])=>this.connection.Go(e,$T(t,r),i,s,a))).catch((s=>{throw s.name==="FirebaseError"?(s.code===ke.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new st(ke.UNKNOWN,s.toString())}))}Ho(e,t,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,o])=>this.connection.Ho(e,$T(t,r),i,a,o,s))).catch((a=>{throw a.name==="FirebaseError"?(a.code===ke.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new st(ke.UNKNOWN,a.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class rJ{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ji(t),this.aa=!1):Xe("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Xh="RemoteStore";class iJ{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo((a=>{r.enqueueAndForget((async()=>{ud(this)&&(Xe(Xh,"Restarting streams for network reachability change."),await(async function(l){const u=Wt(l);u.Ea.add(4),await h1(u),u.Ra.set("Unknown"),u.Ea.delete(4),await yE(u)})(this))}))})),this.Ra=new rJ(r,i)}}async function yE(n){if(ud(n))for(const e of n.da)await e(!0)}async function h1(n){for(const e of n.da)await e(!1)}function i8(n,e){const t=Wt(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),_b(t)?yb(t):D0(t).O_()&&pb(t,e))}function mb(n,e){const t=Wt(n),r=D0(t);t.Ia.delete(e),r.O_()&&s8(t,e),t.Ia.size===0&&(r.O_()?r.L_():ud(t)&&t.Ra.set("Unknown"))}function pb(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ct.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}D0(n).Y_(e)}function s8(n,e){n.Va.Ue(e),D0(n).Z_(e)}function yb(n){n.Va=new XZ({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),D0(n).start(),n.Ra.ua()}function _b(n){return ud(n)&&!D0(n).x_()&&n.Ia.size>0}function ud(n){return Wt(n).Ea.size===0}function a8(n){n.Va=void 0}async function sJ(n){n.Ra.set("Online")}async function aJ(n){n.Ia.forEach(((e,t)=>{pb(n,e)}))}async function oJ(n,e){a8(n),_b(n)?(n.Ra.ha(e),yb(n)):n.Ra.set("Unknown")}async function lJ(n,e,t){if(n.Ra.set("Online"),e instanceof IF&&e.state===2&&e.cause)try{await(async function(i,s){const a=s.cause;for(const o of s.targetIds)i.Ia.has(o)&&(await i.remoteSyncer.rejectListen(o,a),i.Ia.delete(o),i.Va.removeTarget(o))})(n,e)}catch(r){Xe(Xh,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Gx(n,r)}else if(e instanceof F_?n.Va.Ze(e):e instanceof TF?n.Va.st(e):n.Va.tt(e),!t.isEqual(Ct.min()))try{const r=await e8(n.localStore);t.compareTo(r)>=0&&await(function(s,a){const o=s.Va.Tt(a);return o.targetChanges.forEach(((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const h=s.Ia.get(u);h&&s.Ia.set(u,h.withResumeToken(l.resumeToken,a))}})),o.targetMismatches.forEach(((l,u)=>{const h=s.Ia.get(l);if(!h)return;s.Ia.set(l,h.withResumeToken(Or.EMPTY_BYTE_STRING,h.snapshotVersion)),s8(s,l);const f=new wl(h.target,l,u,h.sequenceNumber);pb(s,f)})),s.remoteSyncer.applyRemoteEvent(o)})(n,t)}catch(r){Xe(Xh,"Failed to raise snapshot:",r),await Gx(n,r)}}async function Gx(n,e,t){if(!Eu(e))throw e;n.Ea.add(1),await h1(n),n.Ra.set("Offline"),t||(t=()=>e8(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{Xe(Xh,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await yE(n)}))}function o8(n,e){return e().catch((t=>Gx(n,t,e)))}async function d1(n){const e=Wt(n),t=cu(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Th;for(;cJ(e);)try{const i=await $Q(e.localStore,r);if(i===null){e.Ta.length===0&&t.L_();break}r=i.batchId,uJ(e,i)}catch(i){await Gx(e,i)}l8(e)&&c8(e)}function cJ(n){return ud(n)&&n.Ta.length<10}function uJ(n,e){n.Ta.push(e);const t=cu(n);t.O_()&&t.X_&&t.ea(e.mutations)}function l8(n){return ud(n)&&!cu(n).x_()&&n.Ta.length>0}function c8(n){cu(n).start()}async function hJ(n){cu(n).ra()}async function dJ(n){const e=cu(n);for(const t of n.Ta)e.ea(t.mutations)}async function fJ(n,e,t){const r=n.Ta.shift(),i=ib.from(r,e,t);await o8(n,(()=>n.remoteSyncer.applySuccessfulWrite(i))),await d1(n)}async function gJ(n,e){e&&cu(n).X_&&await(async function(r,i){if((function(a){return HZ(a)&&a!==ke.ABORTED})(i.code)){const s=r.Ta.shift();cu(r).B_(),await o8(r,(()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i))),await d1(r)}})(n,e),l8(n)&&c8(n)}async function I3(n,e){const t=Wt(n);t.asyncQueue.verifyOperationInProgress(),Xe(Xh,"RemoteStore received new credentials");const r=ud(t);t.Ea.add(3),await h1(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await yE(t)}async function mJ(n,e){const t=Wt(n);e?(t.Ea.delete(2),await yE(t)):e||(t.Ea.add(2),await h1(t),t.Ra.set("Unknown"))}function D0(n){return n.ma||(n.ma=(function(t,r,i){const s=Wt(t);return s.sa(),new JQ(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Xo:sJ.bind(null,n),t_:aJ.bind(null,n),r_:oJ.bind(null,n),H_:lJ.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),_b(n)?yb(n):n.Ra.set("Unknown")):(await n.ma.stop(),a8(n))}))),n.ma}function cu(n){return n.fa||(n.fa=(function(t,r,i){const s=Wt(t);return s.sa(),new eJ(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:hJ.bind(null,n),r_:gJ.bind(null,n),ta:dJ.bind(null,n),na:fJ.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await d1(n)):(await n.fa.stop(),n.Ta.length>0&&(Xe(Xh,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class xb{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Oo,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((a=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){const a=Date.now()+r,o=new xb(e,t,a,i,s);return o.start(r),o}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new st(ke.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function vb(n,e){if(Ji("AsyncQueue",`${e}: ${n}`),Eu(n))return new st(ke.UNAVAILABLE,`${e}: ${n}`);throw n}class zf{static emptySet(e){return new zf(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||ot.comparator(t.key,r.key):(t,r)=>ot.comparator(t.key,r.key),this.keyedMap=Jg(),this.sortedSet=new tr(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof zf)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new zf;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class A3{constructor(){this.ga=new tr(ot.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):xt(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class w0{constructor(e,t,r,i,s,a,o,l,u){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,t,r,i,s){const a=[];return t.forEach((o=>{a.push({type:0,doc:o})})),new w0(e,t,zf.emptySet(t),a,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&lE(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}class pJ{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class yJ{constructor(){this.queries=b3(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const i=Wt(t),s=i.queries;i.queries=b3(),s.forEach(((a,o)=>{for(const l of o.Sa)l.onError(r)}))})(this,new st(ke.ABORTED,"Firestore shutting down"))}}function b3(){return new Wl((n=>cF(n)),lE)}async function u8(n,e){const t=Wt(n);let r=3;const i=e.query;let s=t.queries.get(i);s?!s.ba()&&e.Da()&&(r=2):(s=new pJ,r=e.Da()?0:1);try{switch(r){case 0:s.wa=await t.onListen(i,!0);break;case 1:s.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(a){const o=vb(a,`Initialization of query '${xf(e.query)}' failed`);return void e.onError(o)}t.queries.set(i,s),s.Sa.push(e),e.va(t.onlineState),s.wa&&e.Fa(s.wa)&&Eb(t)}async function h8(n,e){const t=Wt(n),r=e.query;let i=3;const s=t.queries.get(r);if(s){const a=s.Sa.indexOf(e);a>=0&&(s.Sa.splice(a,1),s.Sa.length===0?i=e.Da()?0:1:!s.ba()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function _J(n,e){const t=Wt(n);let r=!1;for(const i of e){const s=i.query,a=t.queries.get(s);if(a){for(const o of a.Sa)o.Fa(i)&&(r=!0);a.wa=i}}r&&Eb(t)}function xJ(n,e,t){const r=Wt(n),i=r.queries.get(e);if(i)for(const s of i.Sa)s.onError(t);r.queries.delete(e)}function Eb(n){n.Ca.forEach((e=>{e.next()}))}var QT,R3;(R3=QT||(QT={})).Ma="default",R3.Cache="cache";class d8{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new w0(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=w0.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==QT.Cache}}class f8{constructor(e){this.key=e}}class g8{constructor(e){this.key=e}}class vJ{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Qt(),this.mutatedKeys=Qt(),this.eu=uF(e),this.tu=new zf(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new A3,i=t?t.tu:this.tu;let s=t?t.mutatedKeys:this.mutatedKeys,a=i,o=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((h,f)=>{const g=i.get(h),p=c1(this.query,f)?f:null,E=!!g&&this.mutatedKeys.has(g.key),x=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let w=!1;g&&p?g.data.isEqual(p.data)?E!==x&&(r.track({type:3,doc:p}),w=!0):this.su(g,p)||(r.track({type:2,doc:p}),w=!0,(l&&this.eu(p,l)>0||u&&this.eu(p,u)<0)&&(o=!0)):!g&&p?(r.track({type:0,doc:p}),w=!0):g&&!p&&(r.track({type:1,doc:g}),w=!0,(l||u)&&(o=!0)),w&&(p?(a=a.add(p),s=x?s.add(h):s.delete(h)):(a=a.delete(h),s=s.delete(h)))})),this.query.limit!==null)for(;a.size>this.query.limit;){const h=this.query.limitType==="F"?a.last():a.first();a=a.delete(h.key),s=s.delete(h.key),r.track({type:1,doc:h})}return{tu:a,iu:r,Cs:o,mutatedKeys:s}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort(((h,f)=>(function(p,E){const x=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return xt(20277,{Rt:w})}};return x(p)-x(E)})(h.type,f.type)||this.eu(h.doc,f.doc))),this.ou(r),i=i??!1;const o=t&&!i?this._u():[],l=this.Xa.size===0&&this.current&&!i?1:0,u=l!==this.Za;return this.Za=l,a.length!==0||u?{snapshot:new w0(this.query,e.tu,s,a,e.mutatedKeys,l===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:o}:{au:o}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new A3,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Qt(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const t=[];return e.forEach((r=>{this.Xa.has(r)||t.push(new g8(r))})),this.Xa.forEach((r=>{e.has(r)||t.push(new f8(r))})),t}cu(e){this.Ya=e.Qs,this.Xa=Qt();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return w0.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const wb="SyncEngine";class EJ{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class wJ{constructor(e){this.key=e,this.hu=!1}}class SJ{constructor(e,t,r,i,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new Wl((o=>cF(o)),lE),this.Iu=new Map,this.Eu=new Set,this.du=new tr(ot.comparator),this.Au=new Map,this.Ru=new ub,this.Vu={},this.mu=new Map,this.fu=Yh.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function TJ(n,e,t=!0){const r=v8(n);let i;const s=r.Tu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await m8(r,e,t,!0),i}async function IJ(n,e){const t=v8(n);await m8(t,e,!0,!1)}async function m8(n,e,t,r){const i=await WQ(n.localStore,wa(e)),s=i.targetId,a=n.sharedClientState.addLocalQueryTarget(s,t);let o;return r&&(o=await AJ(n,e,s,a==="current",i.resumeToken)),n.isPrimaryClient&&t&&i8(n.remoteStore,i),o}async function AJ(n,e,t,r,i){n.pu=(f,g,p)=>(async function(x,w,T,I){let P=w.view.ru(T);P.Cs&&(P=await v3(x.localStore,w.query,!1).then((({documents:k})=>w.view.ru(k,P))));const N=I&&I.targetChanges.get(w.targetId),D=I&&I.targetMismatches.get(w.targetId)!=null,B=w.view.applyChanges(P,x.isPrimaryClient,N,D);return P3(x,w.targetId,B.au),B.snapshot})(n,f,g,p);const s=await v3(n.localStore,e,!0),a=new vJ(e,s.Qs),o=a.ru(s.documents),l=u1.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),u=a.applyChanges(o,n.isPrimaryClient,l);P3(n,t,u.au);const h=new EJ(e,t,a);return n.Tu.set(e,h),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),u.snapshot}async function bJ(n,e,t){const r=Wt(n),i=r.Tu.get(e),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter((a=>!lE(a,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await qT(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),t&&mb(r.remoteStore,i.targetId),JT(r,i.targetId)})).catch(cd)):(JT(r,i.targetId),await qT(r.localStore,i.targetId,!0))}async function RJ(n,e){const t=Wt(n),r=t.Tu.get(e),i=t.Iu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),mb(t.remoteStore,r.targetId))}async function CJ(n,e,t){const r=E8(n);try{const i=await(function(a,o){const l=Wt(a),u=On.now(),h=o.reduce(((p,E)=>p.add(E.key)),Qt());let f,g;return l.persistence.runTransaction("Locally write mutations","readwrite",(p=>{let E=Ys(),x=Qt();return l.Ns.getEntries(p,h).next((w=>{E=w,E.forEach(((T,I)=>{I.isValidDocument()||(x=x.add(T))}))})).next((()=>l.localDocuments.getOverlayedDocuments(p,E))).next((w=>{f=w;const T=[];for(const I of o){const P=$Z(I,f.get(I.key).overlayedDocument);P!=null&&T.push(new Hl(I.key,P,eF(P.value.mapValue),ji.exists(!0)))}return l.mutationQueue.addMutationBatch(p,u,T,o)})).next((w=>{g=w;const T=w.applyToLocalDocumentSet(f,x);return l.documentOverlayCache.saveOverlays(p,w.batchId,T)}))})).then((()=>({batchId:g.batchId,changes:dF(f)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(a,o,l){let u=a.Vu[a.currentUser.toKey()];u||(u=new tr($t)),u=u.insert(o,l),a.Vu[a.currentUser.toKey()]=u})(r,i.batchId,t),await f1(r,i.changes),await d1(r.remoteStore)}catch(i){const s=vb(i,"Failed to persist write");t.reject(s)}}async function p8(n,e){const t=Wt(n);try{const r=await UQ(t.localStore,e);e.targetChanges.forEach(((i,s)=>{const a=t.Au.get(s);a&&(bt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?a.hu=!0:i.modifiedDocuments.size>0?bt(a.hu,14607):i.removedDocuments.size>0&&(bt(a.hu,42227),a.hu=!1))})),await f1(t,r,e)}catch(r){await cd(r)}}function C3(n,e,t){const r=Wt(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.Tu.forEach(((s,a)=>{const o=a.view.va(e);o.snapshot&&i.push(o.snapshot)})),(function(a,o){const l=Wt(a);l.onlineState=o;let u=!1;l.queries.forEach(((h,f)=>{for(const g of f.Sa)g.va(o)&&(u=!0)})),u&&Eb(l)})(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function PJ(n,e,t){const r=Wt(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Au.get(e),s=i&&i.key;if(s){let a=new tr(ot.comparator);a=a.insert(s,yr.newNoDocument(s,Ct.min()));const o=Qt().add(s),l=new dE(Ct.min(),new Map,new tr($t),a,o);await p8(r,l),r.du=r.du.remove(s),r.Au.delete(e),Sb(r)}else await qT(r.localStore,e,!1).then((()=>JT(r,e,t))).catch(cd)}async function kJ(n,e){const t=Wt(n),r=e.batch.batchId;try{const i=await BQ(t.localStore,e);_8(t,r,null),y8(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await f1(t,i)}catch(i){await cd(i)}}async function MJ(n,e,t){const r=Wt(n);try{const i=await(function(a,o){const l=Wt(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",(u=>{let h;return l.mutationQueue.lookupMutationBatch(u,o).next((f=>(bt(f!==null,37113),h=f.keys(),l.mutationQueue.removeMutationBatch(u,f)))).next((()=>l.mutationQueue.performConsistencyCheck(u))).next((()=>l.documentOverlayCache.removeOverlaysForBatchId(u,h,o))).next((()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,h))).next((()=>l.localDocuments.getDocuments(u,h)))}))})(r.localStore,e);_8(r,e,t),y8(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await f1(r,i)}catch(i){await cd(i)}}function y8(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function _8(n,e,t){const r=Wt(n);let i=r.Vu[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function JT(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((r=>{n.Ru.containsKey(r)||x8(n,r)}))}function x8(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(mb(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),Sb(n))}function P3(n,e,t){for(const r of t)r instanceof f8?(n.Ru.addReference(r.key,e),NJ(n,r)):r instanceof g8?(Xe(wb,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||x8(n,r.key)):xt(19791,{wu:r})}function NJ(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(Xe(wb,"New document in limbo: "+t),n.Eu.add(r),Sb(n))}function Sb(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new ot(Sn.fromString(e)),r=n.fu.next();n.Au.set(r,new wJ(t)),n.du=n.du.insert(t,r),i8(n.remoteStore,new wl(wa(oE(t.path)),r,"TargetPurposeLimboResolution",va.ce))}}async function f1(n,e,t){const r=Wt(n),i=[],s=[],a=[];r.Tu.isEmpty()||(r.Tu.forEach(((o,l)=>{a.push(r.pu(l,e,t).then((u=>{if((u||t)&&r.isPrimaryClient){const h=u?!u.fromCache:t?.targetChanges.get(l.targetId)?.current;r.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(u){i.push(u);const h=fb.As(l.targetId,u);s.push(h)}})))})),await Promise.all(a),r.Pu.H_(i),await(async function(l,u){const h=Wt(l);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",(f=>he.forEach(u,(g=>he.forEach(g.Es,(p=>h.persistence.referenceDelegate.addReference(f,g.targetId,p))).next((()=>he.forEach(g.ds,(p=>h.persistence.referenceDelegate.removeReference(f,g.targetId,p)))))))))}catch(f){if(!Eu(f))throw f;Xe(gb,"Failed to update sequence numbers: "+f)}for(const f of u){const g=f.targetId;if(!f.fromCache){const p=h.Ms.get(g),E=p.snapshotVersion,x=p.withLastLimboFreeSnapshotVersion(E);h.Ms=h.Ms.insert(g,x)}}})(r.localStore,s))}async function LJ(n,e){const t=Wt(n);if(!t.currentUser.isEqual(e)){Xe(wb,"User change. New user:",e.toKey());const r=await JF(t.localStore,e);t.currentUser=e,(function(s,a){s.mu.forEach((o=>{o.forEach((l=>{l.reject(new st(ke.CANCELLED,a))}))})),s.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await f1(t,r.Ls)}}function OJ(n,e){const t=Wt(n),r=t.Au.get(e);if(r&&r.hu)return Qt().add(r.key);{let i=Qt();const s=t.Iu.get(e);if(!s)return i;for(const a of s){const o=t.Tu.get(a);i=i.unionWith(o.view.nu)}return i}}function v8(n){const e=Wt(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=p8.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=OJ.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=PJ.bind(null,e),e.Pu.H_=_J.bind(null,e.eventManager),e.Pu.yu=xJ.bind(null,e.eventManager),e}function E8(n){const e=Wt(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=kJ.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=MJ.bind(null,e),e}class mp{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=pE(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return QF(this.persistence,new ZF,e.initialUser,this.serializer)}Cu(e){return new hb(mE.mi,this.serializer)}Du(e){return new t8}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}mp.provider={build:()=>new mp};class DJ extends mp{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){bt(this.persistence.referenceDelegate instanceof Vx,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new HF(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Li.withCacheSize(this.cacheSizeBytes):Li.DEFAULT;return new hb((r=>Vx.mi(r,t)),this.serializer)}}class FJ extends mp{constructor(e,t,r){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await E8(this.xu.syncEngine),await d1(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return QF(this.persistence,new ZF,e.initialUser,this.serializer)}Fu(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new HF(r,e.asyncQueue,t)}Mu(e,t){const r=new zq(t,this.persistence);return new Uq(e.asyncQueue,r)}Cu(e){const t=FQ(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Li.withCacheSize(this.cacheSizeBytes):Li.DEFAULT;return new db(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,QQ(),V_(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new t8}}class Bx{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>C3(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=LJ.bind(null,this.syncEngine),await mJ(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new yJ})()}createDatastore(e){const t=pE(e.databaseInfo.databaseId),r=(function(s){return new ZQ(s)})(e.databaseInfo);return(function(s,a,o,l){return new nJ(s,a,o,l)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,i,s,a,o){return new iJ(r,i,s,a,o)})(this.localStore,this.datastore,e.asyncQueue,(t=>C3(this.syncEngine,t,0)),(function(){return S3.v()?new S3:new KQ})())}createSyncEngine(e,t){return(function(i,s,a,o,l,u,h){const f=new SJ(i,s,a,o,l,u);return h&&(f.gu=!0),f})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const r=Wt(t);Xe(Xh,"RemoteStore shutting down."),r.Ea.add(5),await h1(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Bx.provider={build:()=>new Bx};class w8{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Ji("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const uu="FirestoreClient";class jJ{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=_i.UNAUTHENTICATED,this.clientId=WA.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,(async a=>{Xe(uu,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(r,(a=>(Xe(uu,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Oo;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=vb(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function hS(n,e){n.asyncQueue.verifyOperationInProgress(),Xe(uu,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async i=>{r.isEqual(i)||(await JF(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function k3(n,e){n.asyncQueue.verifyOperationInProgress();const t=await VJ(n);Xe(uu,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>I3(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,i)=>I3(e.remoteStore,i))),n._onlineComponents=e}async function VJ(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Xe(uu,"Using user provided OfflineComponentProvider");try{await hS(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===ke.FAILED_PRECONDITION||i.code===ke.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;zh("Error using user provided cache. Falling back to memory cache: "+t),await hS(n,new mp)}}else Xe(uu,"Using default OfflineComponentProvider"),await hS(n,new DJ(void 0));return n._offlineComponents}async function S8(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Xe(uu,"Using user provided OnlineComponentProvider"),await k3(n,n._uninitializedComponentsProvider._online)):(Xe(uu,"Using default OnlineComponentProvider"),await k3(n,new Bx))),n._onlineComponents}function GJ(n){return S8(n).then((e=>e.syncEngine))}async function T8(n){const e=await S8(n),t=e.eventManager;return t.onListen=TJ.bind(null,e.syncEngine),t.onUnlisten=bJ.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=IJ.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=RJ.bind(null,e.syncEngine),t}function BJ(n,e,t={}){const r=new Oo;return n.asyncQueue.enqueueAndForget((async()=>(function(s,a,o,l,u){const h=new w8({next:g=>{h.Nu(),a.enqueueAndForget((()=>h8(s,f)));const p=g.docs.has(o);!p&&g.fromCache?u.reject(new st(ke.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&g.fromCache&&l&&l.source==="server"?u.reject(new st(ke.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(g)},error:g=>u.reject(g)}),f=new d8(oE(o.path),h,{includeMetadataChanges:!0,qa:!0});return u8(s,f)})(await T8(n),n.asyncQueue,e,t,r))),r.promise}function UJ(n,e,t={}){const r=new Oo;return n.asyncQueue.enqueueAndForget((async()=>(function(s,a,o,l,u){const h=new w8({next:g=>{h.Nu(),a.enqueueAndForget((()=>h8(s,f))),g.fromCache&&l.source==="server"?u.reject(new st(ke.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(g)},error:g=>u.reject(g)}),f=new d8(o,h,{includeMetadataChanges:!0,qa:!0});return u8(s,f)})(await T8(n),n.asyncQueue,e,t,r))),r.promise}function I8(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const M3=new Map;const A8="firestore.googleapis.com",N3=!0;class L3{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new st(ke.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=A8,this.ssl=N3}else this.host=e.host,this.ssl=e.ssl??N3;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=UF;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<vQ)throw new st(ke.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}jq("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=I8(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new st(ke.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new st(ke.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new st(ke.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class _E{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new L3({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new st(ke.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new st(ke.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new L3(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new Rq;switch(r.type){case"firstParty":return new Mq(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new st(ke.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=M3.get(t);r&&(Xe("ComponentProvider","Removing Datastore"),M3.delete(t),r.terminate())})(this),Promise.resolve()}}function zJ(n,e,t,r={}){n=Ta(n,_E);const i=od(e),s=n._getSettings(),a={...s,emulatorOptions:n._getEmulatorOptions()},o=`${e}:${t}`;i&&(PA(`https://${o}`),kA("Firestore",!0)),s.host!==A8&&s.host!==o&&zh("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...s,host:o,ssl:i,emulatorOptions:r};if(!Vh(l,a)&&(n._setSettings(l),r.mockUserToken)){let u,h;if(typeof r.mockUserToken=="string")u=r.mockUserToken,h=_i.MOCK_USER;else{u=kD(r.mockUserToken,n._app?.options.projectId);const f=r.mockUserToken.sub||r.mockUserToken.user_id;if(!f)throw new st(ke.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new _i(f)}n._authCredentials=new Cq(new b6(u,h))}}class F0{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new F0(this.firestore,e,this._query)}}class Ir{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new tu(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ir(this.firestore,e,this._key)}toJSON(){return{type:Ir._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(s1(t,Ir._jsonSchema))return new Ir(e,r||null,new ot(Sn.fromString(t.referencePath)))}}Ir._jsonSchemaVersion="firestore/documentReference/1.0",Ir._jsonSchema={type:Nr("string",Ir._jsonSchemaVersion),referencePath:Nr("string")};class tu extends F0{constructor(e,t,r){super(e,t,oE(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ir(this.firestore,null,new ot(e))}withConverter(e){return new tu(this.firestore,e,this._path)}}function O3(n,e,...t){if(n=li(n),C6("collection","path",e),n instanceof _E){const r=Sn.fromString(e,...t);return TM(r),new tu(n,null,r)}{if(!(n instanceof Ir||n instanceof tu))throw new st(ke.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Sn.fromString(e,...t));return TM(r),new tu(n.firestore,null,r)}}function $f(n,e,...t){if(n=li(n),arguments.length===1&&(e=WA.newId()),C6("doc","path",e),n instanceof _E){const r=Sn.fromString(e,...t);return SM(r),new Ir(n,null,new ot(r))}{if(!(n instanceof Ir||n instanceof tu))throw new st(ke.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Sn.fromString(e,...t));return SM(r),new Ir(n.firestore,n instanceof tu?n.converter:null,new ot(r))}}const D3="AsyncQueue";class F3{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new n8(this,"async_queue_retry"),this._c=()=>{const r=V_();r&&Xe(D3,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=V_();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=V_();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Oo;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Eu(e))throw e;Xe(D3,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,Ji("INTERNAL UNHANDLED ERROR: ",j3(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const i=xb.createAndSchedule(this,e,t,r,(s=>this.hc(s)));return this.tc.push(i),i}uc(){this.nc&&xt(47125,{Pc:j3(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function j3(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class Su extends _E{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new F3,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new F3(e),this._firestoreClient=void 0,await e}}}function $J(n,e){const t=typeof n=="object"?n:LA(),r=typeof n=="string"?n:Px,i=Xv(t,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=RD("firestore");s&&zJ(i,...s)}return i}function Tb(n){if(n._terminated)throw new st(ke.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||b8(n),n._firestoreClient}function b8(n){const e=n._freezeSettings(),t=(function(i,s,a,o){return new _Z(i,s,a,o.host,o.ssl,o.experimentalForceLongPolling,o.experimentalAutoDetectLongPolling,I8(o.experimentalLongPollingOptions),o.useFetchStreams,o.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new jJ(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(i){const s=i?._online.build();return{_offline:i?._offline.build(s),_online:s}})(n._componentsProvider))}function WJ(n,e){zh("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return HJ(n,Bx.provider,{build:r=>new FJ(r,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function HJ(n,e,t){if((n=Ta(n,Su))._firestoreClient||n._terminated)throw new st(ke.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new st(ke.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},b8(n)}class pa{constructor(e){this._byteString=e}static fromBase64String(e){try{return new pa(Or.fromBase64String(e))}catch(t){throw new st(ke.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new pa(Or.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:pa._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(s1(e,pa._jsonSchema))return pa.fromBase64String(e.bytes)}}pa._jsonSchemaVersion="firestore/bytes/1.0",pa._jsonSchema={type:Nr("string",pa._jsonSchemaVersion),bytes:Nr("string")};class xE{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new st(ke.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new lr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class vE{constructor(e){this._methodName=e}}class Do{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new st(ke.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new st(ke.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return $t(this._lat,e._lat)||$t(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Do._jsonSchemaVersion}}static fromJSON(e){if(s1(e,Do._jsonSchema))return new Do(e.latitude,e.longitude)}}Do._jsonSchemaVersion="firestore/geoPoint/1.0",Do._jsonSchema={type:Nr("string",Do._jsonSchemaVersion),latitude:Nr("number"),longitude:Nr("number")};class Fo{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Fo._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(s1(e,Fo._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Fo(e.vectorValues);throw new st(ke.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Fo._jsonSchemaVersion="firestore/vectorValue/1.0",Fo._jsonSchema={type:Nr("string",Fo._jsonSchemaVersion),vectorValues:Nr("object")};const KJ=/^__.*__$/;class YJ{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Hl(e,this.data,this.fieldMask,t,this.fieldTransforms):new O0(e,this.data,t,this.fieldTransforms)}}class R8{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Hl(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function C8(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw xt(40011,{Ac:n})}}class Ib{constructor(e,t,r,i,s,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Ib({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Ux(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(C8(this.Ac)&&KJ.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class XJ{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||pE(e)}Cc(e,t,r,i=!1){return new Ib({Ac:e,methodName:t,Dc:r,path:lr.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function EE(n){const e=n._freezeSettings(),t=pE(n._databaseId);return new XJ(n._databaseId,!!e.ignoreUndefinedProperties,t)}function P8(n,e,t,r,i,s={}){const a=n.Cc(s.merge||s.mergeFields?2:0,e,t,i);bb("Data must be an object, but it was:",a,r);const o=k8(r,a);let l,u;if(s.merge)l=new vs(a.fieldMask),u=a.fieldTransforms;else if(s.mergeFields){const h=[];for(const f of s.mergeFields){const g=eI(e,f,t);if(!a.contains(g))throw new st(ke.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);N8(h,g)||h.push(g)}l=new vs(h),u=a.fieldTransforms.filter((f=>l.covers(f.field)))}else l=null,u=a.fieldTransforms;return new YJ(new Di(o),l,u)}class wE extends vE{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof wE}}class Ab extends vE{_toFieldTransform(e){return new xF(e.path,new _0)}isEqual(e){return e instanceof Ab}}function qJ(n,e,t,r){const i=n.Cc(1,e,t);bb("Data must be an object, but it was:",i,r);const s=[],a=Di.empty();wu(r,((l,u)=>{const h=Rb(e,l,t);u=li(u);const f=i.yc(h);if(u instanceof wE)s.push(h);else{const g=g1(u,f);g!=null&&(s.push(h),a.set(h,g))}}));const o=new vs(s);return new R8(a,o,i.fieldTransforms)}function ZJ(n,e,t,r,i,s){const a=n.Cc(1,e,t),o=[eI(e,r,t)],l=[i];if(s.length%2!=0)throw new st(ke.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<s.length;g+=2)o.push(eI(e,s[g])),l.push(s[g+1]);const u=[],h=Di.empty();for(let g=o.length-1;g>=0;--g)if(!N8(u,o[g])){const p=o[g];let E=l[g];E=li(E);const x=a.yc(p);if(E instanceof wE)u.push(p);else{const w=g1(E,x);w!=null&&(u.push(p),h.set(p,w))}}const f=new vs(u);return new R8(h,f,a.fieldTransforms)}function QJ(n,e,t,r=!1){return g1(t,n.Cc(r?4:3,e))}function g1(n,e){if(M8(n=li(n)))return bb("Unsupported field value:",e,n),k8(n,e);if(n instanceof vE)return(function(r,i){if(!C8(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,i){const s=[];let a=0;for(const o of r){let l=g1(o,i.wc(a));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),a++}return{arrayValue:{values:s}}})(n,e)}return(function(r,i){if((r=li(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return jZ(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=On.fromDate(r);return{timestampValue:E0(i.serializer,s)}}if(r instanceof On){const s=new On(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:E0(i.serializer,s)}}if(r instanceof Do)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof pa)return{bytesValue:AF(i.serializer,r._byteString)};if(r instanceof Ir){const s=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(s))throw i.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:ob(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Fo)return(function(a,o){return{mapValue:{fields:{[JA]:{stringValue:eb},[g0]:{arrayValue:{values:a.toArray().map((u=>{if(typeof u!="number")throw o.Sc("VectorValues must only contain numeric values.");return nb(o.serializer,u)}))}}}}}})(r,i);throw i.Sc(`Unsupported field value: ${Jv(r)}`)})(n,e)}function k8(n,e){const t={};return W6(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):wu(n,((r,i)=>{const s=g1(i,e.mc(r));s!=null&&(t[r]=s)})),{mapValue:{fields:t}}}function M8(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof On||n instanceof Do||n instanceof pa||n instanceof Ir||n instanceof vE||n instanceof Fo)}function bb(n,e,t){if(!M8(t)||!P6(t)){const r=Jv(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function eI(n,e,t){if((e=li(e))instanceof xE)return e._internalPath;if(typeof e=="string")return Rb(n,e);throw Ux("Field path arguments must be of type string or ",n,!1,void 0,t)}const JJ=new RegExp("[~\\*/\\[\\]]");function Rb(n,e,t){if(e.search(JJ)>=0)throw Ux(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new xE(...e.split("."))._internalPath}catch{throw Ux(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Ux(n,e,t,r,i){const s=r&&!r.isEmpty(),a=i!==void 0;let o=`Function ${e}() called with invalid data`;t&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${r}`),a&&(l+=` in document ${i}`),l+=")"),new st(ke.INVALID_ARGUMENT,o+n+l)}function N8(n,e){return n.some((t=>t.isEqual(e)))}class L8{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Ir(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new eee(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Cb("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class eee extends L8{data(){return super.data()}}function Cb(n,e){return typeof e=="string"?Rb(n,e):e instanceof xE?e._internalPath:e._delegate._internalPath}function tee(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new st(ke.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Pb{}class nee extends Pb{}function ree(n,e,...t){let r=[];e instanceof Pb&&r.push(e),r=r.concat(t),(function(s){const a=s.filter((l=>l instanceof kb)).length,o=s.filter((l=>l instanceof SE)).length;if(a>1||a>0&&o>0)throw new st(ke.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const i of r)n=i._apply(n);return n}class SE extends nee{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new SE(e,t,r)}_apply(e){const t=this._parse(e);return O8(e._query,t),new F0(e.firestore,e.converter,BT(e._query,t))}_parse(e){const t=EE(e.firestore);return(function(s,a,o,l,u,h,f){let g;if(u.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new st(ke.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){G3(f,h);const E=[];for(const x of f)E.push(V3(l,s,x));g={arrayValue:{values:E}}}else g=V3(l,s,f)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||G3(f,h),g=QJ(o,a,f,h==="in"||h==="not-in");return sn.create(u,h,g)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function iee(n,e,t){const r=e,i=Cb("where",n);return SE._create(i,r,t)}class kb extends Pb{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new kb(e,t)}_parse(e){const t=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return t.length===1?t[0]:Dn.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(i,s){let a=i;const o=s.getFlattenedFilters();for(const l of o)O8(a,l),a=BT(a,l)})(e._query,t),new F0(e.firestore,e.converter,BT(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function V3(n,e,t){if(typeof(t=li(t))=="string"){if(t==="")throw new st(ke.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!lF(e)&&t.indexOf("/")!==-1)throw new st(ke.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(Sn.fromString(t));if(!ot.isDocumentKey(r))throw new st(ke.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return dp(n,new ot(r))}if(t instanceof Ir)return dp(n,t._key);throw new st(ke.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Jv(t)}.`)}function G3(n,e){if(!Array.isArray(n)||n.length===0)throw new st(ke.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function O8(n,e){const t=(function(i,s){for(const a of i)for(const o of a.getFlattenedFilters())if(s.indexOf(o.op)>=0)return o.op;return null})(n.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new st(ke.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new st(ke.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class see{convertValue(e,t="none"){switch(ou(e)){case 0:return null;case 1:return e.booleanValue;case 2:return er(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Gl(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw xt(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return wu(e,((i,s)=>{r[i]=this.convertValue(s,t)})),r}convertVectorValue(e){const t=e.fields?.[g0].arrayValue?.values?.map((r=>er(r.doubleValue)));return new Fo(t)}convertGeoPoint(e){return new Do(er(e.latitude),er(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=sE(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(up(e));default:return null}}convertTimestamp(e){const t=Vl(e);return new On(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Sn.fromString(e);bt(DF(r),9688,{name:e});const i=new $h(r.get(1),r.get(3)),s=new ot(r.popFirst(5));return i.isEqual(t)||Ji(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function D8(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class nm{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class bh extends L8{constructor(e,t,r,i,s,a){super(e,t,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new G_(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Cb("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new st(ke.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=bh._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}bh._jsonSchemaVersion="firestore/documentSnapshot/1.0",bh._jsonSchema={type:Nr("string",bh._jsonSchemaVersion),bundleSource:Nr("string","DocumentSnapshot"),bundleName:Nr("string"),bundle:Nr("string")};class G_ extends bh{data(e={}){return super.data(e)}}class Wf{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new nm(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new G_(this._firestore,this._userDataWriter,r.key,r,new nm(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new st(ke.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map((o=>{const l=new G_(i._firestore,i._userDataWriter,o.doc.key,o.doc,new nm(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}}))}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((o=>s||o.type!==3)).map((o=>{const l=new G_(i._firestore,i._userDataWriter,o.doc.key,o.doc,new nm(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,h=-1;return o.type!==0&&(u=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),h=a.indexOf(o.doc.key)),{type:aee(o.type),doc:l,oldIndex:u,newIndex:h}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new st(ke.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Wf._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=WA.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],i=[];return this.docs.forEach((s=>{s._document!==null&&(t.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function aee(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return xt(61501,{type:n})}}function oee(n){n=Ta(n,Ir);const e=Ta(n.firestore,Su);return BJ(Tb(e),n._key).then((t=>dee(e,n,t)))}Wf._jsonSchemaVersion="firestore/querySnapshot/1.0",Wf._jsonSchema={type:Nr("string",Wf._jsonSchemaVersion),bundleSource:Nr("string","QuerySnapshot"),bundleName:Nr("string"),bundle:Nr("string")};class F8 extends see{constructor(e){super(),this.firestore=e}convertBytes(e){return new pa(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ir(this.firestore,null,t)}}function lee(n){n=Ta(n,F0);const e=Ta(n.firestore,Su),t=Tb(e),r=new F8(e);return tee(n._query),UJ(t,n._query).then((i=>new Wf(e,r,n,i)))}function B3(n,e,t){n=Ta(n,Ir);const r=Ta(n.firestore,Su),i=D8(n.converter,e,t);return TE(r,[P8(EE(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,ji.none())])}function cee(n,e,t,...r){n=Ta(n,Ir);const i=Ta(n.firestore,Su),s=EE(i);let a;return a=typeof(e=li(e))=="string"||e instanceof xE?ZJ(s,"updateDoc",n._key,e,t,r):qJ(s,"updateDoc",n._key,e),TE(i,[a.toMutation(n._key,ji.exists(!0))])}function uee(n){return TE(Ta(n.firestore,Su),[new hE(n._key,ji.none())])}function hee(n,e){const t=Ta(n.firestore,Su),r=$f(n),i=D8(n.converter,e);return TE(t,[P8(EE(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,ji.exists(!1))]).then((()=>r))}function TE(n,e){return(function(r,i){const s=new Oo;return r.asyncQueue.enqueueAndForget((async()=>CJ(await GJ(r),i,s))),s.promise})(Tb(n),e)}function dee(n,e,t){const r=t.docs.get(e._key),i=new F8(n);return new bh(n,i,e._key,r,new nm(t.hasPendingWrites,t.fromCache),e.converter)}function U3(){return new Ab("serverTimestamp")}(function(e,t=!0){(function(i){L0=i})(ld),Gh(new su("firestore",((r,{instanceIdentifier:i,options:s})=>{const a=r.getProvider("app").getImmediate(),o=new Su(new Pq(r.getProvider("auth-internal")),new Nq(a,r.getProvider("app-check-internal")),(function(u,h){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new st(ke.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new $h(u.options.projectId,h)})(a,i),a);return s={useFetchStreams:t,...s},o._setSettings(s),o}),"PUBLIC").setMultipleInstances(!0)),No(xM,vM,e),No(xM,vM,"esm2020")})();const j8="firebasestorage.googleapis.com",fee="storageBucket",gee=120*1e3,mee=600*1e3;class Jo extends Qo{constructor(e,t,r=0){super(dS(e),`Firebase Storage: ${t} (${dS(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Jo.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return dS(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Ho;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Ho||(Ho={}));function dS(n){return"storage/"+n}function pee(){const n="An unknown error occurred, please check the error payload for server response.";return new Jo(Ho.UNKNOWN,n)}function yee(){return new Jo(Ho.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function _ee(){return new Jo(Ho.CANCELED,"User canceled the upload/download.")}function xee(n){return new Jo(Ho.INVALID_URL,"Invalid URL '"+n+"'.")}function vee(n){return new Jo(Ho.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function z3(n){return new Jo(Ho.INVALID_ARGUMENT,n)}function V8(){return new Jo(Ho.APP_DELETED,"The Firebase app was deleted.")}function Eee(n){return new Jo(Ho.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}class Ka{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=Ka.makeFromUrl(e,t)}catch{return new Ka(e,"")}if(r.path==="")return r;throw vee(e)}static makeFromUrl(e,t){let r=null;const i="([A-Za-z0-9.\\-_]+)";function s(N){N.path.charAt(N.path.length-1)==="/"&&(N.path_=N.path_.slice(0,-1))}const a="(/(.*))?$",o=new RegExp("^gs://"+i+a,"i"),l={bucket:1,path:3};function u(N){N.path_=decodeURIComponent(N.path)}const h="v[A-Za-z0-9_]+",f=t.replace(/[.]/g,"\\."),g="(/([^?#]*).*)?$",p=new RegExp(`^https?://${f}/${h}/b/${i}/o${g}`,"i"),E={bucket:1,path:3},x=t===j8?"(?:storage.googleapis.com|storage.cloud.google.com)":t,w="([^?#]*)",T=new RegExp(`^https?://${x}/${i}/${w}`,"i"),P=[{regex:o,indices:l,postModify:s},{regex:p,indices:E,postModify:u},{regex:T,indices:{bucket:1,path:2},postModify:u}];for(let N=0;N<P.length;N++){const D=P[N],B=D.regex.exec(e);if(B){const k=B[D.indices.bucket];let C=B[D.indices.path];C||(C=""),r=new Ka(k,C),D.postModify(r);break}}if(r==null)throw xee(e);return r}}class wee{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function See(n,e,t){let r=1,i=null,s=null,a=!1,o=0;function l(){return o===2}let u=!1;function h(...w){u||(u=!0,e.apply(null,w))}function f(w){i=setTimeout(()=>{i=null,n(p,l())},w)}function g(){s&&clearTimeout(s)}function p(w,...T){if(u){g();return}if(w){g(),h.call(null,w,...T);return}if(l()||a){g(),h.call(null,w,...T);return}r<64&&(r*=2);let P;o===1?(o=2,P=0):P=(r+Math.random())*1e3,f(P)}let E=!1;function x(w){E||(E=!0,g(),!u&&(i!==null?(w||(o=2),clearTimeout(i),f(0)):w||(o=1)))}return f(0),s=setTimeout(()=>{a=!0,x(!0)},t),x}function Tee(n){n(!1)}function Iee(n){return n!==void 0}function $3(n,e,t,r){if(r<e)throw z3(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw z3(`Invalid value for '${n}'. Expected ${t} or less.`)}function Aee(n){const e=encodeURIComponent;let t="?";for(const r in n)if(n.hasOwnProperty(r)){const i=e(r)+"="+e(n[r]);t=t+i+"&"}return t=t.slice(0,-1),t}var zx;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(zx||(zx={}));function bee(n,e){const t=n>=500&&n<600,i=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||i||s}class Ree{constructor(e,t,r,i,s,a,o,l,u,h,f,g=!0,p=!1){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=a,this.callback_=o,this.errorCallback_=l,this.timeout_=u,this.progressCallback_=h,this.connectionFactory_=f,this.retry=g,this.isUsingEmulator=p,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((E,x)=>{this.resolve_=E,this.reject_=x,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new n_(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const a=o=>{const l=o.loaded,u=o.lengthComputable?o.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,u)};this.progressCallback_!==null&&s.addUploadProgressListener(a),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(a),this.pendingConnection_=null;const o=s.getErrorCode()===zx.NO_ERROR,l=s.getStatus();if(!o||bee(l,this.additionalRetryCodes_)&&this.retry){const h=s.getErrorCode()===zx.ABORT;r(!1,new n_(!1,null,h));return}const u=this.successCodes_.indexOf(l)!==-1;r(!0,new n_(u,s))})},t=(r,i)=>{const s=this.resolve_,a=this.reject_,o=i.connection;if(i.wasSuccessCode)try{const l=this.callback_(o,o.getResponse());Iee(l)?s(l):s()}catch(l){a(l)}else if(o!==null){const l=pee();l.serverResponse=o.getErrorText(),this.errorCallback_?a(this.errorCallback_(o,l)):a(l)}else if(i.canceled){const l=this.appDelete_?V8():_ee();a(l)}else{const l=yee();a(l)}};this.canceled_?t(!1,new n_(!1,null,!0)):this.backoffId_=See(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&Tee(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class n_{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}function Cee(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function Pee(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function kee(n,e){e&&(n["X-Firebase-GMPID"]=e)}function Mee(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function Nee(n,e,t,r,i,s,a=!0,o=!1){const l=Aee(n.urlParams),u=n.url+l,h=Object.assign({},n.headers);return kee(h,e),Cee(h,t),Pee(h,s),Mee(h,r),new Ree(u,n.method,h,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,a,o)}function Lee(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function Oee(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}class $x{constructor(e,t){this._service=e,t instanceof Ka?this._location=t:this._location=Ka.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new $x(e,t)}get root(){const e=new Ka(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Oee(this._location.path)}get storage(){return this._service}get parent(){const e=Lee(this._location.path);if(e===null)return null;const t=new Ka(this._location.bucket,e);return new $x(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw Eee(e)}}function W3(n,e){const t=e?.[fee];return t==null?null:Ka.makeFromBucketSpec(t,n)}function Dee(n,e,t,r={}){n.host=`${e}:${t}`;const i=od(e);i&&(PA(`https://${n.host}/b`),kA("Storage",!0)),n._isUsingEmulator=!0,n._protocol=i?"https":"http";const{mockUserToken:s}=r;s&&(n._overrideAuthToken=typeof s=="string"?s:kD(s,n.app.options.projectId))}class Fee{constructor(e,t,r,i,s,a=!1){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._isUsingEmulator=a,this._bucket=null,this._host=j8,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=gee,this._maxUploadRetryTime=mee,this._requests=new Set,i!=null?this._bucket=Ka.makeFromBucketSpec(i,this._host):this._bucket=W3(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Ka.makeFromBucketSpec(this._url,e):this._bucket=W3(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){$3("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){$3("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Hs(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new $x(this,e)}_makeRequest(e,t,r,i,s=!0){if(this._deleted)return new wee(V8());{const a=Nee(e,this._appId,r,i,t,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,t){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,i).getPromise()}}const H3="@firebase/storage",K3="0.14.0";const G8="storage";function jee(n=LA(),e){n=li(n);const r=Xv(n,G8).getImmediate({identifier:e}),i=RD("storage");return i&&Vee(r,...i),r}function Vee(n,e,t,r={}){Dee(n,e,t,r)}function Gee(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new Fee(t,r,i,e,ld)}function Bee(){Gh(new su(G8,Gee,"PUBLIC").setMultipleInstances(!0)),No(H3,K3,""),No(H3,K3,"esm2020")}Bee();const Uee={apiKey:"AIzaSyBcLuKvUr5XqEJTwOf9I0hqJ1o9g3kOZ-g",authDomain:"detectorapp-nl.firebaseapp.com",projectId:"detectorapp-nl",storageBucket:"detectorapp-nl.firebasestorage.app",messagingSenderId:"110954177210",appId:"1:110954177210:web:d77c9ed262ad92bc431883"},Mb=jD(Uee),Hf=Tq(Mb),$c=$J(Mb);jee(Mb);WJ($c).catch(n=>{n.code==="failed-precondition"?console.warn("Offline persistence failed: Multiple tabs open"):n.code==="unimplemented"&&console.warn("Offline persistence not available in this browser")});const m1=Ia()(M0((n,e)=>({user:null,loading:!0,error:null,initialized:!1,setUser:t=>{n(r=>{r.user=t,r.loading=!1})},setLoading:t=>{n(r=>{r.loading=t})},setError:t=>{n(r=>{r.error=t})},signInWithGoogle:async()=>{n(t=>{t.loading=!0,t.error=null});try{const t=new xl;await NX(Hf,t)}catch(t){console.error("Google sign-in error:",t),n(r=>{r.error=t.message,r.loading=!1})}},logout:async()=>{n(t=>{t.loading=!0});try{await l6(Hf)}catch(t){console.error("Logout error:",t),n(r=>{r.error=t.message,r.loading=!1})}},initAuth:()=>{e().initialized||(n(t=>{t.initialized=!0}),o6(Hf,t=>{n(r=>{r.user=t,r.loading=!1})}))}}))),zee=Ia()(M0((n,e)=>({vondsten:[],loading:!1,error:null,loadVondsten:async t=>{n(r=>{r.loading=!0});try{const r=ree(O3($c,"vondsten"),iee("userId","==",t)),s=(await lee(r)).docs.map(a=>({id:a.id,...a.data()}));n(a=>{a.vondsten=s,a.loading=!1})}catch(r){n(i=>{i.error=r.message,i.loading=!1})}},addVondst:async t=>{const r=new Date().toISOString(),i={...t,createdAt:r,updatedAt:r},s=await hee(O3($c,"vondsten"),i);return n(a=>{a.vondsten.push({...i,id:s.id})}),s.id},updateVondst:async(t,r)=>{const i=$f($c,"vondsten",t);await cee(i,{...r,updatedAt:new Date().toISOString()}),n(s=>{const a=s.vondsten.findIndex(o=>o.id===t);a!==-1&&(s.vondsten[a]={...s.vondsten[a],...r})})},deleteVondst:async t=>{await uee($f($c,"vondsten",t)),n(r=>{r.vondsten=r.vondsten.filter(i=>i.id!==t)})}}))),$ee={};function Wee(n,e){let t;try{t=n()}catch{return}return{getItem:i=>{var s;const a=l=>l===null?null:JSON.parse(l,void 0),o=(s=t.getItem(i))!=null?s:null;return o instanceof Promise?o.then(a):a(o)},setItem:(i,s)=>t.setItem(i,JSON.stringify(s,void 0)),removeItem:i=>t.removeItem(i)}}const pp=n=>e=>{try{const t=n(e);return t instanceof Promise?t:{then(r){return pp(r)(t)},catch(r){return this}}}catch(t){return{then(r){return this},catch(r){return pp(r)(t)}}}},Hee=(n,e)=>(t,r,i)=>{let s={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:w=>w,version:0,merge:(w,T)=>({...T,...w}),...e},a=!1;const o=new Set,l=new Set;let u;try{u=s.getStorage()}catch{}if(!u)return n((...w)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...w)},r,i);const h=pp(s.serialize),f=()=>{const w=s.partialize({...r()});let T;const I=h({state:w,version:s.version}).then(P=>u.setItem(s.name,P)).catch(P=>{T=P});if(T)throw T;return I},g=i.setState;i.setState=(w,T)=>{g(w,T),f()};const p=n((...w)=>{t(...w),f()},r,i);let E;const x=()=>{var w;if(!u)return;a=!1,o.forEach(I=>I(r()));const T=((w=s.onRehydrateStorage)==null?void 0:w.call(s,r()))||void 0;return pp(u.getItem.bind(u))(s.name).then(I=>{if(I)return s.deserialize(I)}).then(I=>{if(I)if(typeof I.version=="number"&&I.version!==s.version){if(s.migrate)return s.migrate(I.state,I.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return I.state}).then(I=>{var P;return E=s.merge(I,(P=r())!=null?P:p),t(E,!0),f()}).then(()=>{T?.(E,void 0),a=!0,l.forEach(I=>I(E))}).catch(I=>{T?.(void 0,I)})};return i.persist={setOptions:w=>{s={...s,...w},w.getStorage&&(u=w.getStorage())},clearStorage:()=>{u?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>x(),hasHydrated:()=>a,onHydrate:w=>(o.add(w),()=>{o.delete(w)}),onFinishHydration:w=>(l.add(w),()=>{l.delete(w)})},x(),E||p},Kee=(n,e)=>(t,r,i)=>{let s={storage:Wee(()=>localStorage),partialize:x=>x,version:0,merge:(x,w)=>({...w,...x}),...e},a=!1;const o=new Set,l=new Set;let u=s.storage;if(!u)return n((...x)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...x)},r,i);const h=()=>{const x=s.partialize({...r()});return u.setItem(s.name,{state:x,version:s.version})},f=i.setState;i.setState=(x,w)=>{f(x,w),h()};const g=n((...x)=>{t(...x),h()},r,i);i.getInitialState=()=>g;let p;const E=()=>{var x,w;if(!u)return;a=!1,o.forEach(I=>{var P;return I((P=r())!=null?P:g)});const T=((w=s.onRehydrateStorage)==null?void 0:w.call(s,(x=r())!=null?x:g))||void 0;return pp(u.getItem.bind(u))(s.name).then(I=>{if(I)if(typeof I.version=="number"&&I.version!==s.version){if(s.migrate)return[!0,s.migrate(I.state,I.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,I.state];return[!1,void 0]}).then(I=>{var P;const[N,D]=I;if(p=s.merge(D,(P=r())!=null?P:g),t(p,!0),N)return h()}).then(()=>{T?.(p,void 0),p=r(),a=!0,l.forEach(I=>I(p))}).catch(I=>{T?.(void 0,I)})};return i.persist={setOptions:x=>{s={...s,...x},x.storage&&(u=x.storage)},clearStorage:()=>{u?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>E(),hasHydrated:()=>a,onHydrate:x=>(o.add(x),()=>{o.delete(x)}),onFinishHydration:x=>(l.add(x),()=>{l.delete(x)})},s.skipHydration||E(),p||g},Yee=(n,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?(($ee?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),Hee(n,e)):Kee(n,e),j0=Yee,Ti=Ia()(j0(n=>({defaultBackground:"CartoDB (licht)",showScaleBar:!0,gpsAutoStart:!1,showAccuracyCircle:!0,hapticFeedback:!0,vondstenLocalOnly:!0,showVondstButton:!0,fontScale:100,layerPanelFontScale:100,presetPanelFontScale:100,setDefaultBackground:e=>n({defaultBackground:e}),setShowScaleBar:e=>n({showScaleBar:e}),setGpsAutoStart:e=>n({gpsAutoStart:e}),setShowAccuracyCircle:e=>n({showAccuracyCircle:e}),setHapticFeedback:e=>n({hapticFeedback:e}),setVondstenLocalOnly:e=>n({vondstenLocalOnly:e}),setShowVondstButton:e=>n({showVondstButton:e}),setFontScale:e=>n({fontScale:e}),setLayerPanelFontScale:e=>n({layerPanelFontScale:e}),setPresetPanelFontScale:e=>n({presetPanelFontScale:e})}),{name:"detectorapp-settings",version:2,migrate:(n,e)=>e<2?{...n,showScaleBar:!0}:n})),fS=[{id:"detectie",name:"Detectie",icon:"Compass",layers:["AMK Monumenten","Gewaspercelen","IKAW"],baseLayer:"CartoDB (licht)",isBuiltIn:!1},{id:"steentijd",name:"Steentijd",icon:"Mountain",layers:["Hunebedden","Grafheuvels","Terpen","FAMKE Steentijd","AMK Steentijd","AHN4 Multi-Hillshade NL","Labels Overlay"],baseLayer:"Luchtfoto",isBuiltIn:!1},{id:"romeins-midvroeg",name:"Romeins - Vroege ME",icon:"Layers",layers:["Romeinse wegen (regio)","Romeinse Forten","AMK Romeins","AMK Vroege ME","Gewaspercelen","Kadastrale Grenzen"],isBuiltIn:!1},{id:"midlaat-nieuwetijd",name:"Late ME - Nieuw",icon:"Grid",layers:["AMK Late ME","Kastelen","Essen","Rijksmonumenten","Kadastrale Grenzen","Oude Kernen"],isBuiltIn:!1},{id:"woii-militair",name:"WOII & Militair",icon:"Target",layers:["WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Inundatiegebieden","Militaire Objecten"],isBuiltIn:!1},{id:"analyse",name:"Terrein Analyse",icon:"Search",layers:["IKAW","Geomorfologie","Bodemkaart","Archeo Landschappen","AHN4 Multi-Hillshade NL","AHN4 Hoogtekaart Kleur"],isBuiltIn:!1}],Y3=["Labels Overlay","TMK 1850","Bonnebladen 1900","Hunebedden","FAMKE Steentijd","Grafheuvels","Terpen","AMK Monumenten","AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig","Romeinse wegen (regio)","Romeinse wegen (Wereld)","Kastelen","IKAW","Archeo Landschappen","Rijksmonumenten","Werelderfgoed","Religieus Erfgoed","Essen","WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Inundatiegebieden","Militaire Objecten","Paleokaart 800 n.Chr.","Paleokaart 100 n.Chr.","Paleokaart 500 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 9000 v.Chr.","UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling","AHN4 Hoogtekaart Kleur","AHN4 Hillshade NL","AHN4 Multi-Hillshade NL","AHN 0.5m","Veengebieden","Geomorfologie","Bodemkaart","Fossielen Nederland","Fossielen Belgi","Fossielen Duitsland","Fossielen Frankrijk","Parken","Speeltuinen","Musea","Strandjes","Kringloopwinkels","Gewaspercelen","Kadastrale Grenzen","Scheepswrakken","Woonheuvels ZH","Romeinse Forten","Windmolens","Erfgoedlijnen","Oude Kernen","Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken","Verdronken Dorpen"],B8=Ia()(j0((n,e)=>({presets:[...fS],applyPreset:t=>{const r=e().presets.find(s=>s.id===t);if(!r)return;const i=ii.getState();Y3.forEach(s=>i.setLayerVisibility(s,!1)),r.layers.forEach(s=>i.setLayerVisibility(s,!0)),r.baseLayer&&["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"].forEach(a=>{i.setLayerVisibility(a,a===r.baseLayer)}),console.log(` Preset toegepast: ${r.name}${r.baseLayer?` (${r.baseLayer})`:""}`)},createPreset:(t,r)=>{const i=ii.getState(),s=Object.entries(i.visible).filter(([o,l])=>l&&Y3.includes(o)).map(([o])=>o),a={id:`custom-${Date.now()}`,name:t,icon:r,layers:s,isBuiltIn:!1};n(o=>({presets:[...o.presets,a]})),console.log(` Preset aangemaakt: ${t} met ${s.length} lagen`)},updatePreset:(t,r)=>{n(i=>({presets:i.presets.map(s=>s.id===t?{...s,...r}:s)}))},deletePreset:t=>{n(r=>({presets:r.presets.filter(i=>i.id!==t||i.isBuiltIn)}))},resetToDefaults:()=>{n({presets:[...fS]})}}),{name:"detectorapp-presets",version:7,migrate:(n,e)=>e<7?{presets:[...fS]}:n})),X3=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899"],IE=Ia()(j0((n,e)=>({layers:[],addLayer:t=>{const r=crypto.randomUUID(),i=e().layers.length,s=X3[i%X3.length];return n(a=>({layers:[...a.layers,{...t,id:r,createdAt:new Date().toISOString(),color:t.color||s,visible:t.visible??!0,opacity:t.opacity??1}]})),r},removeLayer:t=>n(r=>({layers:r.layers.filter(i=>i.id!==t)})),updateLayer:(t,r)=>n(i=>({layers:i.layers.map(s=>s.id===t?{...s,...r}:s)})),toggleVisibility:t=>n(r=>({layers:r.layers.map(i=>i.id===t?{...i,visible:!i.visible}:i)})),setOpacity:(t,r)=>n(i=>({layers:i.layers.map(s=>s.id===t?{...s,opacity:r}:s)})),setColor:(t,r)=>n(i=>({layers:i.layers.map(s=>s.id===t?{...s,color:r}:s)})),clearAll:()=>n({layers:[]})}),{name:"detectorapp-custom-layers",version:1})),Xee=["CartoDB (licht)","OpenStreetMap","Luchtfoto","Labels Overlay","Mijn Vondsten"],U8=Ia()(j0((n,e)=>({tier:"free",unlockedRegions:["nl"],devMode:!0,setTier:t=>n({tier:t}),unlockRegion:t=>n(r=>({unlockedRegions:r.unlockedRegions.includes(t)?r.unlockedRegions:[...r.unlockedRegions,t]})),lockRegion:t=>n(r=>({unlockedRegions:r.unlockedRegions.filter(i=>i!==t)})),setDevMode:t=>n({devMode:t}),isRegionUnlocked:t=>{const r=e();return r.devMode||r.tier==="pro"?!0:r.unlockedRegions.includes(t)},isLayerUnlocked:(t,r="free",i=["nl"])=>{const s=e();return s.devMode||Xee.includes(t)||r==="free"||s.tier==="pro"?!0:s.tier==="premium"?i.some(a=>s.unlockedRegions.includes(a)):!1},canAccessPremiumFeatures:()=>{const t=e();return t.devMode||t.tier!=="free"}}),{name:"detectorapp-subscription",version:1}));function qee({target:n,viewOptions:e}){const t=se.useRef(null),r=se.useRef(null),i=As(a=>a.setMap),s=Ti(a=>a.showScaleBar);return se.useEffect(()=>{if(!t.current){const a={center:[5.1214,52.0907],zoom:8,rotation:0,minZoom:3,maxZoom:19,...e},o=new _H({target:n,controls:[],view:new Ro({center:Nh(a.center),zoom:a.zoom,rotation:a.rotation,minZoom:a.minZoom,maxZoom:a.maxZoom})});t.current=o,i(o),window.__olMap=o}return()=>{t.current&&(t.current.setTarget(void 0),i(null),window.__olMap=null)}},[n,e,i]),se.useEffect(()=>{const a=t.current;a&&(s?r.current||(r.current=new EH({units:"metric",bar:!1,text:!0,minWidth:80}),a.addControl(r.current)):r.current&&(a.removeControl(r.current),r.current=null))},[s]),t.current}const q3=["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"];function Zee(){const n=se.useRef(null),e=se.useRef(!1);qee({target:"map"});const t=As(f=>f.map),r=ii(f=>f.registerLayer),i=ii(f=>f.setLayerVisibility),s=Ti(f=>f.defaultBackground);se.useEffect(()=>{if(!t){console.warn(" Map not initialized yet");return}console.log(" Initializing map layers...");const f=new Ju({properties:{title:"OpenStreetMap",type:"base"},visible:!1,source:new FW}),g=new Ju({properties:{title:"CartoDB (licht)",type:"base"},visible:!0,source:new pf({url:"https://{a-d}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO"})}),p=new Ju({properties:{title:"Luchtfoto",type:"base"},visible:!1,source:new pf({url:"https://service.pdok.nl/hwh/luchtfotorgb/wmts/v1_0/Actueel_orthoHR/EPSG:3857/{z}/{x}/{y}.jpeg",attributions:" Kadaster / PDOK Luchtfoto",maxZoom:19})}),E=new Ju({properties:{title:"Labels Overlay",type:"overlay"},visible:!1,source:new pf({url:"https://{a-d}.basemaps.cartocdn.com/rastertiles/voyager_only_labels/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO",maxZoom:20}),zIndex:100}),x=new Ju({properties:{title:"TMK 1850",type:"base"},visible:!1,source:new pf({url:"https://s.map5.nl/map/gast/tiles/tmk_1850/EPSG3857/{z}/{x}/{y}.png",attributions:" Kadaster / Map5.nl",crossOrigin:"anonymous",maxZoom:14})}),w=new Ju({properties:{title:"Bonnebladen 1900",type:"base"},visible:!1,source:new pf({url:"https://s.map5.nl/map/gast/tiles/bonne_1900/EPSG3857/{z}/{x}/{y}.png",attributions:" Kadaster / Map5.nl",crossOrigin:"anonymous",maxZoom:14})});t.addLayer(f),t.addLayer(g),t.addLayer(p),t.addLayer(E),t.addLayer(x),t.addLayer(w),console.log(" Base layers added:",{osm:f.getVisible(),cartodb:g.getVisible(),satellite:p.getVisible()}),r("OpenStreetMap",f),r("CartoDB (licht)",g),r("Luchtfoto",p),r("Labels Overlay",E),r("TMK 1850",x),r("Bonnebladen 1900",w),t.updateSize(),console.log(" Map size:",t.getSize()),console.log(" Map center:",t.getView().getCenter()),console.log(" Map zoom:",t.getView().getZoom()),a()},[t,r]);async function a(){if(!t){console.error(" Cannot load layers: map is null");return}const f=YH();console.log(` Loading ${f.length} immediate-load layers (WMS/Tile)...`);const g=await Promise.allSettled(f.map(async E=>{try{const x=await E.factory();return x?{name:E.name,layer:x}:null}catch(x){return console.warn(` Failed to create ${E.name}:`,x),null}}));let p=0;g.forEach(E=>{if(E.status==="fulfilled"&&E.value){const{name:x,layer:w}=E.value;t.addLayer(w),r(x,w),p++,console.log(`   ${x}`)}}),console.log(` Immediate layers loaded: ${p}/${f.length}`),console.log(` Total layers on map: ${t.getLayers().getLength()}`),console.log(" Vector layers will load on first toggle (lazy loading enabled)")}se.useEffect(()=>{if(!t||e.current)return;const f=setTimeout(()=>{const g=s||"CartoDB (licht)";q3.forEach(p=>{i(p,!1)}),q3.includes(g)?i(g,!0):i("CartoDB (licht)",!0),e.current=!0,console.log(` Default background: ${g}`)},100);return()=>clearTimeout(f)},[t,s,i]);const o=Ti(f=>f.gpsAutoStart),l=qi(f=>f.startTracking),u=se.useRef(!1);se.useEffect(()=>{if(!(!t||u.current)&&o){const f=setTimeout(()=>{l(),u.current=!0,console.log(" GPS autostart enabled - tracking started")},500);return()=>clearTimeout(f)}},[t,o,l]);const h={width:"100%",height:"100vh"};return y.jsx("div",{id:"map",ref:n,style:h})}const Nb=se.createContext({});function Lb(n){const e=se.useRef(null);return e.current===null&&(e.current=n()),e.current}const AE=se.createContext(null),Ob=se.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});class Qee extends se.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=t.offsetHeight||0,r.width=t.offsetWidth||0,r.top=t.offsetTop,r.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function Jee({children:n,isPresent:e}){const t=se.useId(),r=se.useRef(null),i=se.useRef({width:0,height:0,top:0,left:0}),{nonce:s}=se.useContext(Ob);return se.useInsertionEffect(()=>{const{width:a,height:o,top:l,left:u}=i.current;if(e||!r.current||!a||!o)return;r.current.dataset.motionPopId=t;const h=document.createElement("style");return s&&(h.nonce=s),document.head.appendChild(h),h.sheet&&h.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${a}px !important;
            height: ${o}px !important;
            top: ${l}px !important;
            left: ${u}px !important;
          }
        `),()=>{document.head.removeChild(h)}},[e]),y.jsx(Qee,{isPresent:e,childRef:r,sizeRef:i,children:se.cloneElement(n,{ref:r})})}const ete=({children:n,initial:e,isPresent:t,onExitComplete:r,custom:i,presenceAffectsLayout:s,mode:a})=>{const o=Lb(tte),l=se.useId(),u=se.useCallback(f=>{o.set(f,!0);for(const g of o.values())if(!g)return;r&&r()},[o,r]),h=se.useMemo(()=>({id:l,initial:e,isPresent:t,custom:i,onExitComplete:u,register:f=>(o.set(f,!1),()=>o.delete(f))}),s?[Math.random(),u]:[t,u]);return se.useMemo(()=>{o.forEach((f,g)=>o.set(g,!1))},[t]),se.useEffect(()=>{!t&&!o.size&&r&&r()},[t]),a==="popLayout"&&(n=y.jsx(Jee,{isPresent:t,children:n})),y.jsx(AE.Provider,{value:h,children:n})};function tte(){return new Map}function z8(n=!0){const e=se.useContext(AE);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:r,register:i}=e,s=se.useId();se.useEffect(()=>{n&&i(s)},[n]);const a=se.useCallback(()=>n&&r&&r(s),[s,r,n]);return!t&&r?[!1,a]:[!0]}const r_=n=>n.key||"";function Z3(n){const e=[];return se.Children.forEach(n,t=>{se.isValidElement(t)&&e.push(t)}),e}const Db=typeof window<"u",$8=Db?se.useLayoutEffect:se.useEffect,Yr=({children:n,custom:e,initial:t=!0,onExitComplete:r,presenceAffectsLayout:i=!0,mode:s="sync",propagate:a=!1})=>{const[o,l]=z8(a),u=se.useMemo(()=>Z3(n),[n]),h=a&&!o?[]:u.map(r_),f=se.useRef(!0),g=se.useRef(u),p=Lb(()=>new Map),[E,x]=se.useState(u),[w,T]=se.useState(u);$8(()=>{f.current=!1,g.current=u;for(let N=0;N<w.length;N++){const D=r_(w[N]);h.includes(D)?p.delete(D):p.get(D)!==!0&&p.set(D,!1)}},[w,h.length,h.join("-")]);const I=[];if(u!==E){let N=[...u];for(let D=0;D<w.length;D++){const B=w[D],k=r_(B);h.includes(k)||(N.splice(D,0,B),I.push(B))}s==="wait"&&I.length&&(N=I),T(Z3(N)),x(u);return}const{forceRender:P}=se.useContext(Nb);return y.jsx(y.Fragment,{children:w.map(N=>{const D=r_(N),B=a&&!o?!1:u===w||h.includes(D),k=()=>{if(p.has(D))p.set(D,!0);else return;let C=!0;p.forEach(M=>{M||(C=!1)}),C&&(P?.(),T(g.current),a&&l?.(),r&&r())};return y.jsx(ete,{isPresent:B,initial:!f.current||t?void 0:!1,custom:B?void 0:e,presenceAffectsLayout:i,mode:s,onExitComplete:B?void 0:k,children:N},D)})})},Xs=n=>n;let W8=Xs;function Fb(n){let e;return()=>(e===void 0&&(e=n()),e)}const S0=(n,e,t)=>{const r=e-n;return r===0?1:(t-n)/r},Pl=n=>n*1e3,kl=n=>n/1e3,nte={useManualTiming:!1};function rte(n){let e=new Set,t=new Set,r=!1,i=!1;const s=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1};function o(u){s.has(u)&&(l.schedule(u),n()),u(a)}const l={schedule:(u,h=!1,f=!1)=>{const p=f&&r?e:t;return h&&s.add(u),p.has(u)||p.add(u),u},cancel:u=>{t.delete(u),s.delete(u)},process:u=>{if(a=u,r){i=!0;return}r=!0,[e,t]=[t,e],e.forEach(o),e.clear(),r=!1,i&&(i=!1,l.process(u))}};return l}const i_=["read","resolveKeyframes","update","preRender","render","postRender"],ite=40;function H8(n,e){let t=!1,r=!0;const i={delta:0,timestamp:0,isProcessing:!1},s=()=>t=!0,a=i_.reduce((T,I)=>(T[I]=rte(s),T),{}),{read:o,resolveKeyframes:l,update:u,preRender:h,render:f,postRender:g}=a,p=()=>{const T=performance.now();t=!1,i.delta=r?1e3/60:Math.max(Math.min(T-i.timestamp,ite),1),i.timestamp=T,i.isProcessing=!0,o.process(i),l.process(i),u.process(i),h.process(i),f.process(i),g.process(i),i.isProcessing=!1,t&&e&&(r=!1,n(p))},E=()=>{t=!0,r=!0,i.isProcessing||n(p)};return{schedule:i_.reduce((T,I)=>{const P=a[I];return T[I]=(N,D=!1,B=!1)=>(t||E(),P.schedule(N,D,B)),T},{}),cancel:T=>{for(let I=0;I<i_.length;I++)a[i_[I]].cancel(T)},state:i,steps:a}}const{schedule:qn,cancel:hu,state:pi,steps:gS}=H8(typeof requestAnimationFrame<"u"?requestAnimationFrame:Xs,!0),K8=se.createContext({strict:!1}),Q3={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},T0={};for(const n in Q3)T0[n]={isEnabled:e=>Q3[n].some(t=>!!e[t])};function ste(n){for(const e in n)T0[e]={...T0[e],...n[e]}}const ate=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Wx(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||ate.has(n)}let Y8=n=>!Wx(n);function ote(n){n&&(Y8=e=>e.startsWith("on")?!Wx(e):n(e))}try{ote(require("@emotion/is-prop-valid").default)}catch{}function lte(n,e,t){const r={};for(const i in n)i==="values"&&typeof n.values=="object"||(Y8(i)||t===!0&&Wx(i)||!e&&!Wx(i)||n.draggable&&i.startsWith("onDrag"))&&(r[i]=n[i]);return r}function cte(n){if(typeof Proxy>"u")return n;const e=new Map,t=(...r)=>n(...r);return new Proxy(t,{get:(r,i)=>i==="create"?n:(e.has(i)||e.set(i,n(i)),e.get(i))})}const bE=se.createContext({});function yp(n){return typeof n=="string"||Array.isArray(n)}function RE(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}const jb=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Vb=["initial",...jb];function CE(n){return RE(n.animate)||Vb.some(e=>yp(n[e]))}function X8(n){return!!(CE(n)||n.variants)}function ute(n,e){if(CE(n)){const{initial:t,animate:r}=n;return{initial:t===!1||yp(t)?t:void 0,animate:yp(r)?r:void 0}}return n.inherit!==!1?e:{}}function hte(n){const{initial:e,animate:t}=ute(n,se.useContext(bE));return se.useMemo(()=>({initial:e,animate:t}),[J3(e),J3(t)])}function J3(n){return Array.isArray(n)?n.join(" "):n}const dte=Symbol.for("motionComponentSymbol");function bf(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function fte(n,e,t){return se.useCallback(r=>{r&&n.onMount&&n.onMount(r),e&&(r?e.mount(r):e.unmount()),t&&(typeof t=="function"?t(r):bf(t)&&(t.current=r))},[e])}const Gb=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),gte="framerAppearId",q8="data-"+Gb(gte),{schedule:Bb}=H8(queueMicrotask,!1),Z8=se.createContext({});function mte(n,e,t,r,i){var s,a;const{visualElement:o}=se.useContext(bE),l=se.useContext(K8),u=se.useContext(AE),h=se.useContext(Ob).reducedMotion,f=se.useRef(null);r=r||l.renderer,!f.current&&r&&(f.current=r(n,{visualState:e,parent:o,props:t,presenceContext:u,blockInitialAnimation:u?u.initial===!1:!1,reducedMotionConfig:h}));const g=f.current,p=se.useContext(Z8);g&&!g.projection&&i&&(g.type==="html"||g.type==="svg")&&pte(f.current,t,i,p);const E=se.useRef(!1);se.useInsertionEffect(()=>{g&&E.current&&g.update(t,u)});const x=t[q8],w=se.useRef(!!x&&!(!((s=window.MotionHandoffIsComplete)===null||s===void 0)&&s.call(window,x))&&((a=window.MotionHasOptimisedAnimation)===null||a===void 0?void 0:a.call(window,x)));return $8(()=>{g&&(E.current=!0,window.MotionIsMounted=!0,g.updateFeatures(),Bb.render(g.render),w.current&&g.animationState&&g.animationState.animateChanges())}),se.useEffect(()=>{g&&(!w.current&&g.animationState&&g.animationState.animateChanges(),w.current&&(queueMicrotask(()=>{var T;(T=window.MotionHandoffMarkAsComplete)===null||T===void 0||T.call(window,x)}),w.current=!1))}),g}function pte(n,e,t,r){const{layoutId:i,layout:s,drag:a,dragConstraints:o,layoutScroll:l,layoutRoot:u}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:Q8(n.parent)),n.projection.setOptions({layoutId:i,layout:s,alwaysMeasureLayout:!!a||o&&bf(o),visualElement:n,animationType:typeof s=="string"?s:"both",initialPromotionConfig:r,layoutScroll:l,layoutRoot:u})}function Q8(n){if(n)return n.options.allowProjection!==!1?n.projection:Q8(n.parent)}function yte({preloadedFeatures:n,createVisualElement:e,useRender:t,useVisualState:r,Component:i}){var s,a;n&&ste(n);function o(u,h){let f;const g={...se.useContext(Ob),...u,layoutId:_te(u)},{isStatic:p}=g,E=hte(u),x=r(u,p);if(!p&&Db){xte();const w=vte(g);f=w.MeasureLayout,E.visualElement=mte(i,x,g,e,w.ProjectionNode)}return y.jsxs(bE.Provider,{value:E,children:[f&&E.visualElement?y.jsx(f,{visualElement:E.visualElement,...g}):null,t(i,u,fte(x,E.visualElement,h),x,p,E.visualElement)]})}o.displayName=`motion.${typeof i=="string"?i:`create(${(a=(s=i.displayName)!==null&&s!==void 0?s:i.name)!==null&&a!==void 0?a:""})`}`;const l=se.forwardRef(o);return l[dte]=i,l}function _te({layoutId:n}){const e=se.useContext(Nb).id;return e&&n!==void 0?e+"-"+n:n}function xte(n,e){se.useContext(K8).strict}function vte(n){const{drag:e,layout:t}=T0;if(!e&&!t)return{};const r={...e,...t};return{MeasureLayout:e?.isEnabled(n)||t?.isEnabled(n)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}const Ete=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Ub(n){return typeof n!="string"||n.includes("-")?!1:!!(Ete.indexOf(n)>-1||/[A-Z]/u.test(n))}function eN(n){const e=[{},{}];return n?.values.forEach((t,r)=>{e[0][r]=t.get(),e[1][r]=t.getVelocity()}),e}function zb(n,e,t,r){if(typeof e=="function"){const[i,s]=eN(r);e=e(t!==void 0?t:n.custom,i,s)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[i,s]=eN(r);e=e(t!==void 0?t:n.custom,i,s)}return e}const tI=n=>Array.isArray(n),wte=n=>!!(n&&typeof n=="object"&&n.mix&&n.toValue),Ste=n=>tI(n)?n[n.length-1]||0:n,Vi=n=>!!(n&&n.getVelocity);function B_(n){const e=Vi(n)?n.get():n;return wte(e)?e.toValue():e}function Tte({scrapeMotionValuesFromProps:n,createRenderState:e,onUpdate:t},r,i,s){const a={latestValues:Ite(r,i,s,n),renderState:e()};return t&&(a.onMount=o=>t({props:r,current:o,...a}),a.onUpdate=o=>t(o)),a}const J8=n=>(e,t)=>{const r=se.useContext(bE),i=se.useContext(AE),s=()=>Tte(n,e,r,i);return t?s():Lb(s)};function Ite(n,e,t,r){const i={},s=r(n,{});for(const g in s)i[g]=B_(s[g]);let{initial:a,animate:o}=n;const l=CE(n),u=X8(n);e&&u&&!l&&n.inherit!==!1&&(a===void 0&&(a=e.initial),o===void 0&&(o=e.animate));let h=t?t.initial===!1:!1;h=h||a===!1;const f=h?o:a;if(f&&typeof f!="boolean"&&!RE(f)){const g=Array.isArray(f)?f:[f];for(let p=0;p<g.length;p++){const E=zb(n,g[p]);if(E){const{transitionEnd:x,transition:w,...T}=E;for(const I in T){let P=T[I];if(Array.isArray(P)){const N=h?P.length-1:0;P=P[N]}P!==null&&(i[I]=P)}for(const I in x)i[I]=x[I]}}}return i}const V0=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],hd=new Set(V0),e9=n=>e=>typeof e=="string"&&e.startsWith(n),t9=e9("--"),Ate=e9("var(--"),$b=n=>Ate(n)?bte.test(n.split("/*")[0].trim()):!1,bte=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,n9=(n,e)=>e&&typeof n=="number"?e.transform(n):n,Bl=(n,e,t)=>t>e?e:t<n?n:t,G0={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},_p={...G0,transform:n=>Bl(0,1,n)},s_={...G0,default:1},p1=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),Pc=p1("deg"),jo=p1("%"),Dt=p1("px"),Rte=p1("vh"),Cte=p1("vw"),tN={...jo,parse:n=>jo.parse(n)/100,transform:n=>jo.transform(n*100)},Pte={borderWidth:Dt,borderTopWidth:Dt,borderRightWidth:Dt,borderBottomWidth:Dt,borderLeftWidth:Dt,borderRadius:Dt,radius:Dt,borderTopLeftRadius:Dt,borderTopRightRadius:Dt,borderBottomRightRadius:Dt,borderBottomLeftRadius:Dt,width:Dt,maxWidth:Dt,height:Dt,maxHeight:Dt,top:Dt,right:Dt,bottom:Dt,left:Dt,padding:Dt,paddingTop:Dt,paddingRight:Dt,paddingBottom:Dt,paddingLeft:Dt,margin:Dt,marginTop:Dt,marginRight:Dt,marginBottom:Dt,marginLeft:Dt,backgroundPositionX:Dt,backgroundPositionY:Dt},kte={rotate:Pc,rotateX:Pc,rotateY:Pc,rotateZ:Pc,scale:s_,scaleX:s_,scaleY:s_,scaleZ:s_,skew:Pc,skewX:Pc,skewY:Pc,distance:Dt,translateX:Dt,translateY:Dt,translateZ:Dt,x:Dt,y:Dt,z:Dt,perspective:Dt,transformPerspective:Dt,opacity:_p,originX:tN,originY:tN,originZ:Dt},nN={...G0,transform:Math.round},Wb={...Pte,...kte,zIndex:nN,size:Dt,fillOpacity:_p,strokeOpacity:_p,numOctaves:nN},Mte={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},Nte=V0.length;function Lte(n,e,t){let r="",i=!0;for(let s=0;s<Nte;s++){const a=V0[s],o=n[a];if(o===void 0)continue;let l=!0;if(typeof o=="number"?l=o===(a.startsWith("scale")?1:0):l=parseFloat(o)===0,!l||t){const u=n9(o,Wb[a]);if(!l){i=!1;const h=Mte[a]||a;r+=`${h}(${u}) `}t&&(e[a]=u)}}return r=r.trim(),t?r=t(e,i?"":r):i&&(r="none"),r}function Hb(n,e,t){const{style:r,vars:i,transformOrigin:s}=n;let a=!1,o=!1;for(const l in e){const u=e[l];if(hd.has(l)){a=!0;continue}else if(t9(l)){i[l]=u;continue}else{const h=n9(u,Wb[l]);l.startsWith("origin")?(o=!0,s[l]=h):r[l]=h}}if(e.transform||(a||t?r.transform=Lte(e,n.transform,t):r.transform&&(r.transform="none")),o){const{originX:l="50%",originY:u="50%",originZ:h=0}=s;r.transformOrigin=`${l} ${u} ${h}`}}const Ote={offset:"stroke-dashoffset",array:"stroke-dasharray"},Dte={offset:"strokeDashoffset",array:"strokeDasharray"};function Fte(n,e,t=1,r=0,i=!0){n.pathLength=1;const s=i?Ote:Dte;n[s.offset]=Dt.transform(-r);const a=Dt.transform(e),o=Dt.transform(t);n[s.array]=`${a} ${o}`}function rN(n,e,t){return typeof n=="string"?n:Dt.transform(e+t*n)}function jte(n,e,t){const r=rN(e,n.x,n.width),i=rN(t,n.y,n.height);return`${r} ${i}`}function Kb(n,{attrX:e,attrY:t,attrScale:r,originX:i,originY:s,pathLength:a,pathSpacing:o=1,pathOffset:l=0,...u},h,f){if(Hb(n,u,f),h){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:g,style:p,dimensions:E}=n;g.transform&&(E&&(p.transform=g.transform),delete g.transform),E&&(i!==void 0||s!==void 0||p.transform)&&(p.transformOrigin=jte(E,i!==void 0?i:.5,s!==void 0?s:.5)),e!==void 0&&(g.x=e),t!==void 0&&(g.y=t),r!==void 0&&(g.scale=r),a!==void 0&&Fte(g,a,o,l,!1)}const Yb=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),r9=()=>({...Yb(),attrs:{}}),Xb=n=>typeof n=="string"&&n.toLowerCase()==="svg";function i9(n,{style:e,vars:t},r,i){Object.assign(n.style,e,i&&i.getProjectionStyles(r));for(const s in t)n.style.setProperty(s,t[s])}const s9=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function a9(n,e,t,r){i9(n,e,void 0,r);for(const i in e.attrs)n.setAttribute(s9.has(i)?i:Gb(i),e.attrs[i])}const Hx={};function Vte(n){Object.assign(Hx,n)}function o9(n,{layout:e,layoutId:t}){return hd.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!Hx[n]||n==="opacity")}function qb(n,e,t){var r;const{style:i}=n,s={};for(const a in i)(Vi(i[a])||e.style&&Vi(e.style[a])||o9(a,n)||((r=t?.getValue(a))===null||r===void 0?void 0:r.liveStyle)!==void 0)&&(s[a]=i[a]);return s}function l9(n,e,t){const r=qb(n,e,t);for(const i in n)if(Vi(n[i])||Vi(e[i])){const s=V0.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;r[s]=n[i]}return r}function Gte(n,e){try{e.dimensions=typeof n.getBBox=="function"?n.getBBox():n.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const iN=["x","y","width","height","cx","cy","r"],Bte={useVisualState:J8({scrapeMotionValuesFromProps:l9,createRenderState:r9,onUpdate:({props:n,prevProps:e,current:t,renderState:r,latestValues:i})=>{if(!t)return;let s=!!n.drag;if(!s){for(const o in i)if(hd.has(o)){s=!0;break}}if(!s)return;let a=!e;if(e)for(let o=0;o<iN.length;o++){const l=iN[o];n[l]!==e[l]&&(a=!0)}a&&qn.read(()=>{Gte(t,r),qn.render(()=>{Kb(r,i,Xb(t.tagName),n.transformTemplate),a9(t,r)})})}})},Ute={useVisualState:J8({scrapeMotionValuesFromProps:qb,createRenderState:Yb})};function c9(n,e,t){for(const r in e)!Vi(e[r])&&!o9(r,t)&&(n[r]=e[r])}function zte({transformTemplate:n},e){return se.useMemo(()=>{const t=Yb();return Hb(t,e,n),Object.assign({},t.vars,t.style)},[e])}function $te(n,e){const t=n.style||{},r={};return c9(r,t,n),Object.assign(r,zte(n,e)),r}function Wte(n,e){const t={},r=$te(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=r,t}function Hte(n,e,t,r){const i=se.useMemo(()=>{const s=r9();return Kb(s,e,Xb(r),n.transformTemplate),{...s.attrs,style:{...s.style}}},[e]);if(n.style){const s={};c9(s,n.style,n),i.style={...s,...i.style}}return i}function Kte(n=!1){return(t,r,i,{latestValues:s},a)=>{const l=(Ub(t)?Hte:Wte)(r,s,a,t),u=lte(r,typeof t=="string",n),h=t!==se.Fragment?{...u,...l,ref:i}:{},{children:f}=r,g=se.useMemo(()=>Vi(f)?f.get():f,[f]);return se.createElement(t,{...h,children:g})}}function Yte(n,e){return function(r,{forwardMotionProps:i}={forwardMotionProps:!1}){const a={...Ub(r)?Bte:Ute,preloadedFeatures:n,useRender:Kte(i),createVisualElement:e,Component:r};return yte(a)}}function u9(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let r=0;r<t;r++)if(e[r]!==n[r])return!1;return!0}function PE(n,e,t){const r=n.getProps();return zb(r,e,t!==void 0?t:r.custom,n)}const Xte=Fb(()=>window.ScrollTimeline!==void 0);class qte{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,t){for(let r=0;r<this.animations.length;r++)this.animations[r][e]=t}attachTimeline(e,t){const r=this.animations.map(i=>{if(Xte()&&i.attachTimeline)return i.attachTimeline(e);if(typeof t=="function")return t(i)});return()=>{r.forEach((i,s)=>{i&&i(),this.animations[s].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let t=0;t<this.animations.length;t++)e=Math.max(e,this.animations[t].duration);return e}runAll(e){this.animations.forEach(t=>t[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class Zte extends qte{then(e,t){return Promise.all(this.animations).then(e).catch(t)}}function Zb(n,e){return n?n[e]||n.default||n:void 0}const nI=2e4;function h9(n){let e=0;const t=50;let r=n.next(e);for(;!r.done&&e<nI;)e+=t,r=n.next(e);return e>=nI?1/0:e}function Qb(n){return typeof n=="function"}function sN(n,e){n.timeline=e,n.onfinish=null}const Jb=n=>Array.isArray(n)&&typeof n[0]=="number",Qte={linearEasing:void 0};function Jte(n,e){const t=Fb(n);return()=>{var r;return(r=Qte[e])!==null&&r!==void 0?r:t()}}const Kx=Jte(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),d9=(n,e,t=10)=>{let r="";const i=Math.max(Math.round(e/t),2);for(let s=0;s<i;s++)r+=n(S0(0,i-1,s))+", ";return`linear(${r.substring(0,r.length-2)})`};function f9(n){return!!(typeof n=="function"&&Kx()||!n||typeof n=="string"&&(n in rI||Kx())||Jb(n)||Array.isArray(n)&&n.every(f9))}const rm=([n,e,t,r])=>`cubic-bezier(${n}, ${e}, ${t}, ${r})`,rI={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:rm([0,.65,.55,1]),circOut:rm([.55,0,1,.45]),backIn:rm([.31,.01,.66,-.59]),backOut:rm([.33,1.53,.69,.99])};function g9(n,e){if(n)return typeof n=="function"&&Kx()?d9(n,e):Jb(n)?rm(n):Array.isArray(n)?n.map(t=>g9(t,e)||rI.easeOut):rI[n]}const Va={x:!1,y:!1};function m9(){return Va.x||Va.y}function ene(n,e,t){var r;if(n instanceof Element)return[n];if(typeof n=="string"){let i=document;const s=(r=void 0)!==null&&r!==void 0?r:i.querySelectorAll(n);return s?Array.from(s):[]}return Array.from(n)}function p9(n,e){const t=ene(n),r=new AbortController,i={passive:!0,...e,signal:r.signal};return[t,i,()=>r.abort()]}function aN(n){return e=>{e.pointerType==="touch"||m9()||n(e)}}function tne(n,e,t={}){const[r,i,s]=p9(n,t),a=aN(o=>{const{target:l}=o,u=e(o);if(typeof u!="function"||!l)return;const h=aN(f=>{u(f),l.removeEventListener("pointerleave",h)});l.addEventListener("pointerleave",h,i)});return r.forEach(o=>{o.addEventListener("pointerenter",a,i)}),s}const y9=(n,e)=>e?n===e?!0:y9(n,e.parentElement):!1,eR=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,nne=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function rne(n){return nne.has(n.tagName)||n.tabIndex!==-1}const im=new WeakSet;function oN(n){return e=>{e.key==="Enter"&&n(e)}}function mS(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const ine=(n,e)=>{const t=n.currentTarget;if(!t)return;const r=oN(()=>{if(im.has(t))return;mS(t,"down");const i=oN(()=>{mS(t,"up")}),s=()=>mS(t,"cancel");t.addEventListener("keyup",i,e),t.addEventListener("blur",s,e)});t.addEventListener("keydown",r,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",r),e)};function lN(n){return eR(n)&&!m9()}function sne(n,e,t={}){const[r,i,s]=p9(n,t),a=o=>{const l=o.currentTarget;if(!lN(o)||im.has(l))return;im.add(l);const u=e(o),h=(p,E)=>{window.removeEventListener("pointerup",f),window.removeEventListener("pointercancel",g),!(!lN(p)||!im.has(l))&&(im.delete(l),typeof u=="function"&&u(p,{success:E}))},f=p=>{h(p,t.useGlobalTarget||y9(l,p.target))},g=p=>{h(p,!1)};window.addEventListener("pointerup",f,i),window.addEventListener("pointercancel",g,i)};return r.forEach(o=>{!rne(o)&&o.getAttribute("tabindex")===null&&(o.tabIndex=0),(t.useGlobalTarget?window:o).addEventListener("pointerdown",a,i),o.addEventListener("focus",u=>ine(u,i),i)}),s}function ane(n){return n==="x"||n==="y"?Va[n]?null:(Va[n]=!0,()=>{Va[n]=!1}):Va.x||Va.y?null:(Va.x=Va.y=!0,()=>{Va.x=Va.y=!1})}const _9=new Set(["width","height","top","left","right","bottom",...V0]);let U_;function one(){U_=void 0}const Vo={now:()=>(U_===void 0&&Vo.set(pi.isProcessing||nte.useManualTiming?pi.timestamp:performance.now()),U_),set:n=>{U_=n,queueMicrotask(one)}};function tR(n,e){n.indexOf(e)===-1&&n.push(e)}function nR(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}class rR{constructor(){this.subscriptions=[]}add(e){return tR(this.subscriptions,e),()=>nR(this.subscriptions,e)}notify(e,t,r){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,t,r);else for(let s=0;s<i;s++){const a=this.subscriptions[s];a&&a(e,t,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function x9(n,e){return e?n*(1e3/e):0}const cN=30,lne=n=>!isNaN(parseFloat(n));class cne{constructor(e,t={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(r,i=!0)=>{const s=Vo.now();this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),i&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=Vo.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=lne(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new rR);const r=this.events[e].add(t);return e==="change"?()=>{r(),qn.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e,t=!0){!t||!this.passiveEffect?this.updateAndNotify(e,t):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,t,r){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=Vo.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>cN)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,cN);return x9(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function xp(n,e){return new cne(n,e)}function une(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,xp(t))}function hne(n,e){const t=PE(n,e);let{transitionEnd:r={},transition:i={},...s}=t||{};s={...s,...r};for(const a in s){const o=Ste(s[a]);une(n,a,o)}}function dne(n){return!!(Vi(n)&&n.add)}function iI(n,e){const t=n.getValue("willChange");if(dne(t))return t.add(e)}function v9(n){return n.props[q8]}const E9=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,fne=1e-7,gne=12;function mne(n,e,t,r,i){let s,a,o=0;do a=e+(t-e)/2,s=E9(a,r,i)-n,s>0?t=a:e=a;while(Math.abs(s)>fne&&++o<gne);return a}function y1(n,e,t,r){if(n===e&&t===r)return Xs;const i=s=>mne(s,0,1,n,t);return s=>s===0||s===1?s:E9(i(s),e,r)}const w9=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,S9=n=>e=>1-n(1-e),T9=y1(.33,1.53,.69,.99),iR=S9(T9),I9=w9(iR),A9=n=>(n*=2)<1?.5*iR(n):.5*(2-Math.pow(2,-10*(n-1))),sR=n=>1-Math.sin(Math.acos(n)),b9=S9(sR),R9=w9(sR),C9=n=>/^0[^.\s]+$/u.test(n);function pne(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||C9(n):!0}const wm=n=>Math.round(n*1e5)/1e5,aR=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function yne(n){return n==null}const _ne=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,oR=(n,e)=>t=>!!(typeof t=="string"&&_ne.test(t)&&t.startsWith(n)||e&&!yne(t)&&Object.prototype.hasOwnProperty.call(t,e)),P9=(n,e,t)=>r=>{if(typeof r!="string")return r;const[i,s,a,o]=r.match(aR);return{[n]:parseFloat(i),[e]:parseFloat(s),[t]:parseFloat(a),alpha:o!==void 0?parseFloat(o):1}},xne=n=>Bl(0,255,n),pS={...G0,transform:n=>Math.round(xne(n))},xh={test:oR("rgb","red"),parse:P9("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:r=1})=>"rgba("+pS.transform(n)+", "+pS.transform(e)+", "+pS.transform(t)+", "+wm(_p.transform(r))+")"};function vne(n){let e="",t="",r="",i="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),r=n.substring(5,7),i=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),r=n.substring(3,4),i=n.substring(4,5),e+=e,t+=t,r+=r,i+=i),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}}const sI={test:oR("#"),parse:vne,transform:xh.transform},Rf={test:oR("hsl","hue"),parse:P9("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:r=1})=>"hsla("+Math.round(n)+", "+jo.transform(wm(e))+", "+jo.transform(wm(t))+", "+wm(_p.transform(r))+")"},Ni={test:n=>xh.test(n)||sI.test(n)||Rf.test(n),parse:n=>xh.test(n)?xh.parse(n):Rf.test(n)?Rf.parse(n):sI.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?xh.transform(n):Rf.transform(n)},Ene=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function wne(n){var e,t;return isNaN(n)&&typeof n=="string"&&(((e=n.match(aR))===null||e===void 0?void 0:e.length)||0)+(((t=n.match(Ene))===null||t===void 0?void 0:t.length)||0)>0}const k9="number",M9="color",Sne="var",Tne="var(",uN="${}",Ine=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function vp(n){const e=n.toString(),t=[],r={color:[],number:[],var:[]},i=[];let s=0;const o=e.replace(Ine,l=>(Ni.test(l)?(r.color.push(s),i.push(M9),t.push(Ni.parse(l))):l.startsWith(Tne)?(r.var.push(s),i.push(Sne),t.push(l)):(r.number.push(s),i.push(k9),t.push(parseFloat(l))),++s,uN)).split(uN);return{values:t,split:o,indexes:r,types:i}}function N9(n){return vp(n).values}function L9(n){const{split:e,types:t}=vp(n),r=e.length;return i=>{let s="";for(let a=0;a<r;a++)if(s+=e[a],i[a]!==void 0){const o=t[a];o===k9?s+=wm(i[a]):o===M9?s+=Ni.transform(i[a]):s+=i[a]}return s}}const Ane=n=>typeof n=="number"?0:n;function bne(n){const e=N9(n);return L9(n)(e.map(Ane))}const du={test:wne,parse:N9,createTransformer:L9,getAnimatableNone:bne},Rne=new Set(["brightness","contrast","saturate","opacity"]);function Cne(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[r]=t.match(aR)||[];if(!r)return n;const i=t.replace(r,"");let s=Rne.has(e)?1:0;return r!==t&&(s*=100),e+"("+s+i+")"}const Pne=/\b([a-z-]*)\(.*?\)/gu,aI={...du,getAnimatableNone:n=>{const e=n.match(Pne);return e?e.map(Cne).join(" "):n}},kne={...Wb,color:Ni,backgroundColor:Ni,outlineColor:Ni,fill:Ni,stroke:Ni,borderColor:Ni,borderTopColor:Ni,borderRightColor:Ni,borderBottomColor:Ni,borderLeftColor:Ni,filter:aI,WebkitFilter:aI},lR=n=>kne[n];function O9(n,e){let t=lR(n);return t!==aI&&(t=du),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const Mne=new Set(["auto","none","0"]);function Nne(n,e,t){let r=0,i;for(;r<n.length&&!i;){const s=n[r];typeof s=="string"&&!Mne.has(s)&&vp(s).values.length&&(i=n[r]),r++}if(i&&t)for(const s of e)n[s]=O9(t,i)}const hN=n=>n===G0||n===Dt,dN=(n,e)=>parseFloat(n.split(", ")[e]),fN=(n,e)=>(t,{transform:r})=>{if(r==="none"||!r)return 0;const i=r.match(/^matrix3d\((.+)\)$/u);if(i)return dN(i[1],e);{const s=r.match(/^matrix\((.+)\)$/u);return s?dN(s[1],n):0}},Lne=new Set(["x","y","z"]),One=V0.filter(n=>!Lne.has(n));function Dne(n){const e=[];return One.forEach(t=>{const r=n.getValue(t);r!==void 0&&(e.push([t,r.get()]),r.set(t.startsWith("scale")?1:0))}),e}const I0={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:fN(4,13),y:fN(5,14)};I0.translateX=I0.x;I0.translateY=I0.y;const Rh=new Set;let oI=!1,lI=!1;function D9(){if(lI){const n=Array.from(Rh).filter(r=>r.needsMeasurement),e=new Set(n.map(r=>r.element)),t=new Map;e.forEach(r=>{const i=Dne(r);i.length&&(t.set(r,i),r.render())}),n.forEach(r=>r.measureInitialState()),e.forEach(r=>{r.render();const i=t.get(r);i&&i.forEach(([s,a])=>{var o;(o=r.getValue(s))===null||o===void 0||o.set(a)})}),n.forEach(r=>r.measureEndState()),n.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}lI=!1,oI=!1,Rh.forEach(n=>n.complete()),Rh.clear()}function F9(){Rh.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(lI=!0)})}function Fne(){F9(),D9()}class cR{constructor(e,t,r,i,s,a=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=r,this.motionValue=i,this.element=s,this.isAsync=a}scheduleResolve(){this.isScheduled=!0,this.isAsync?(Rh.add(this),oI||(oI=!0,qn.read(F9),qn.resolveKeyframes(D9))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:r,motionValue:i}=this;for(let s=0;s<e.length;s++)if(e[s]===null)if(s===0){const a=i?.get(),o=e[e.length-1];if(a!==void 0)e[0]=a;else if(r&&t){const l=r.readValue(t,o);l!=null&&(e[0]=l)}e[0]===void 0&&(e[0]=o),i&&a===void 0&&i.set(e[0])}else e[s]=e[s-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),Rh.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,Rh.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const j9=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n),jne=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Vne(n){const e=jne.exec(n);if(!e)return[,];const[,t,r,i]=e;return[`--${t??r}`,i]}function V9(n,e,t=1){const[r,i]=Vne(n);if(!r)return;const s=window.getComputedStyle(e).getPropertyValue(r);if(s){const a=s.trim();return j9(a)?parseFloat(a):a}return $b(i)?V9(i,e,t+1):i}const G9=n=>e=>e.test(n),Gne={test:n=>n==="auto",parse:n=>n},B9=[G0,Dt,jo,Pc,Cte,Rte,Gne],gN=n=>B9.find(G9(n));class U9 extends cR{constructor(e,t,r,i,s){super(e,t,r,i,s,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:r}=this;if(!t||!t.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let u=e[l];if(typeof u=="string"&&(u=u.trim(),$b(u))){const h=V9(u,t.current);h!==void 0&&(e[l]=h),l===e.length-1&&(this.finalKeyframe=u)}}if(this.resolveNoneKeyframes(),!_9.has(r)||e.length!==2)return;const[i,s]=e,a=gN(i),o=gN(s);if(a!==o)if(hN(a)&&hN(o))for(let l=0;l<e.length;l++){const u=e[l];typeof u=="string"&&(e[l]=parseFloat(u))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,r=[];for(let i=0;i<e.length;i++)pne(e[i])&&r.push(i);r.length&&Nne(e,r,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:r}=this;if(!e||!e.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=I0[r](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const i=t[t.length-1];i!==void 0&&e.getValue(r,i).jump(i,!1)}measureEndState(){var e;const{element:t,name:r,unresolvedKeyframes:i}=this;if(!t||!t.current)return;const s=t.getValue(r);s&&s.jump(this.measuredOrigin,!1);const a=i.length-1,o=i[a];i[a]=I0[r](t.measureViewportBox(),window.getComputedStyle(t.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([l,u])=>{t.getValue(l).set(u)}),this.resolveNoneKeyframes()}}const mN=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(du.test(n)||n==="0")&&!n.startsWith("url("));function Bne(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function Une(n,e,t,r){const i=n[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const s=n[n.length-1],a=mN(i,e),o=mN(s,e);return!a||!o?!1:Bne(n)||(t==="spring"||Qb(t))&&r}const zne=n=>n!==null;function kE(n,{repeat:e,repeatType:t="loop"},r){const i=n.filter(zne),s=e&&t!=="loop"&&e%2===1?0:i.length-1;return!s||r===void 0?i[s]:r}const $ne=40;class z9{constructor({autoplay:e=!0,delay:t=0,type:r="keyframes",repeat:i=0,repeatDelay:s=0,repeatType:a="loop",...o}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=Vo.now(),this.options={autoplay:e,delay:t,type:r,repeat:i,repeatDelay:s,repeatType:a,...o},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>$ne?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&Fne(),this._resolved}onKeyframesResolved(e,t){this.resolvedAt=Vo.now(),this.hasAttemptedResolve=!0;const{name:r,type:i,velocity:s,delay:a,onComplete:o,onUpdate:l,isGenerator:u}=this.options;if(!u&&!Une(e,r,i,s))if(a)this.options.duration=0;else{l&&l(kE(e,this.options,t)),o&&o(),this.resolveFinishedPromise();return}const h=this.initPlayback(e,t);h!==!1&&(this._resolved={keyframes:e,finalKeyframe:t,...h},this.onPostResolved())}onPostResolved(){}then(e,t){return this.currentFinishedPromise.then(e,t)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const cr=(n,e,t)=>n+(e-n)*t;function yS(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function Wne({hue:n,saturation:e,lightness:t,alpha:r}){n/=360,e/=100,t/=100;let i=0,s=0,a=0;if(!e)i=s=a=t;else{const o=t<.5?t*(1+e):t+e-t*e,l=2*t-o;i=yS(l,o,n+1/3),s=yS(l,o,n),a=yS(l,o,n-1/3)}return{red:Math.round(i*255),green:Math.round(s*255),blue:Math.round(a*255),alpha:r}}function Yx(n,e){return t=>t>0?e:n}const _S=(n,e,t)=>{const r=n*n,i=t*(e*e-r)+r;return i<0?0:Math.sqrt(i)},Hne=[sI,xh,Rf],Kne=n=>Hne.find(e=>e.test(n));function pN(n){const e=Kne(n);if(!e)return!1;let t=e.parse(n);return e===Rf&&(t=Wne(t)),t}const yN=(n,e)=>{const t=pN(n),r=pN(e);if(!t||!r)return Yx(n,e);const i={...t};return s=>(i.red=_S(t.red,r.red,s),i.green=_S(t.green,r.green,s),i.blue=_S(t.blue,r.blue,s),i.alpha=cr(t.alpha,r.alpha,s),xh.transform(i))},Yne=(n,e)=>t=>e(n(t)),_1=(...n)=>n.reduce(Yne),cI=new Set(["none","hidden"]);function Xne(n,e){return cI.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function qne(n,e){return t=>cr(n,e,t)}function uR(n){return typeof n=="number"?qne:typeof n=="string"?$b(n)?Yx:Ni.test(n)?yN:Jne:Array.isArray(n)?$9:typeof n=="object"?Ni.test(n)?yN:Zne:Yx}function $9(n,e){const t=[...n],r=t.length,i=n.map((s,a)=>uR(s)(s,e[a]));return s=>{for(let a=0;a<r;a++)t[a]=i[a](s);return t}}function Zne(n,e){const t={...n,...e},r={};for(const i in t)n[i]!==void 0&&e[i]!==void 0&&(r[i]=uR(n[i])(n[i],e[i]));return i=>{for(const s in r)t[s]=r[s](i);return t}}function Qne(n,e){var t;const r=[],i={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const a=e.types[s],o=n.indexes[a][i[a]],l=(t=n.values[o])!==null&&t!==void 0?t:0;r[s]=l,i[a]++}return r}const Jne=(n,e)=>{const t=du.createTransformer(e),r=vp(n),i=vp(e);return r.indexes.var.length===i.indexes.var.length&&r.indexes.color.length===i.indexes.color.length&&r.indexes.number.length>=i.indexes.number.length?cI.has(n)&&!i.values.length||cI.has(e)&&!r.values.length?Xne(n,e):_1($9(Qne(r,i),i.values),t):Yx(n,e)};function W9(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?cr(n,e,t):uR(n)(n,e)}const ere=5;function H9(n,e,t){const r=Math.max(e-ere,0);return x9(t-n(r),e-r)}const mr={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},xS=.001;function tre({duration:n=mr.duration,bounce:e=mr.bounce,velocity:t=mr.velocity,mass:r=mr.mass}){let i,s,a=1-e;a=Bl(mr.minDamping,mr.maxDamping,a),n=Bl(mr.minDuration,mr.maxDuration,kl(n)),a<1?(i=u=>{const h=u*a,f=h*n,g=h-t,p=uI(u,a),E=Math.exp(-f);return xS-g/p*E},s=u=>{const f=u*a*n,g=f*t+t,p=Math.pow(a,2)*Math.pow(u,2)*n,E=Math.exp(-f),x=uI(Math.pow(u,2),a);return(-i(u)+xS>0?-1:1)*((g-p)*E)/x}):(i=u=>{const h=Math.exp(-u*n),f=(u-t)*n+1;return-xS+h*f},s=u=>{const h=Math.exp(-u*n),f=(t-u)*(n*n);return h*f});const o=5/n,l=rre(i,s,o);if(n=Pl(n),isNaN(l))return{stiffness:mr.stiffness,damping:mr.damping,duration:n};{const u=Math.pow(l,2)*r;return{stiffness:u,damping:a*2*Math.sqrt(r*u),duration:n}}}const nre=12;function rre(n,e,t){let r=t;for(let i=1;i<nre;i++)r=r-n(r)/e(r);return r}function uI(n,e){return n*Math.sqrt(1-e*e)}const ire=["duration","bounce"],sre=["stiffness","damping","mass"];function _N(n,e){return e.some(t=>n[t]!==void 0)}function are(n){let e={velocity:mr.velocity,stiffness:mr.stiffness,damping:mr.damping,mass:mr.mass,isResolvedFromDuration:!1,...n};if(!_N(n,sre)&&_N(n,ire))if(n.visualDuration){const t=n.visualDuration,r=2*Math.PI/(t*1.2),i=r*r,s=2*Bl(.05,1,1-(n.bounce||0))*Math.sqrt(i);e={...e,mass:mr.mass,stiffness:i,damping:s}}else{const t=tre(n);e={...e,...t,mass:mr.mass},e.isResolvedFromDuration=!0}return e}function K9(n=mr.visualDuration,e=mr.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:r,restDelta:i}=t;const s=t.keyframes[0],a=t.keyframes[t.keyframes.length-1],o={done:!1,value:s},{stiffness:l,damping:u,mass:h,duration:f,velocity:g,isResolvedFromDuration:p}=are({...t,velocity:-kl(t.velocity||0)}),E=g||0,x=u/(2*Math.sqrt(l*h)),w=a-s,T=kl(Math.sqrt(l/h)),I=Math.abs(w)<5;r||(r=I?mr.restSpeed.granular:mr.restSpeed.default),i||(i=I?mr.restDelta.granular:mr.restDelta.default);let P;if(x<1){const D=uI(T,x);P=B=>{const k=Math.exp(-x*T*B);return a-k*((E+x*T*w)/D*Math.sin(D*B)+w*Math.cos(D*B))}}else if(x===1)P=D=>a-Math.exp(-T*D)*(w+(E+T*w)*D);else{const D=T*Math.sqrt(x*x-1);P=B=>{const k=Math.exp(-x*T*B),C=Math.min(D*B,300);return a-k*((E+x*T*w)*Math.sinh(C)+D*w*Math.cosh(C))/D}}const N={calculatedDuration:p&&f||null,next:D=>{const B=P(D);if(p)o.done=D>=f;else{let k=0;x<1&&(k=D===0?Pl(E):H9(P,D,B));const C=Math.abs(k)<=r,M=Math.abs(a-B)<=i;o.done=C&&M}return o.value=o.done?a:B,o},toString:()=>{const D=Math.min(h9(N),nI),B=d9(k=>N.next(D*k).value,D,30);return D+"ms "+B}};return N}function xN({keyframes:n,velocity:e=0,power:t=.8,timeConstant:r=325,bounceDamping:i=10,bounceStiffness:s=500,modifyTarget:a,min:o,max:l,restDelta:u=.5,restSpeed:h}){const f=n[0],g={done:!1,value:f},p=C=>o!==void 0&&C<o||l!==void 0&&C>l,E=C=>o===void 0?l:l===void 0||Math.abs(o-C)<Math.abs(l-C)?o:l;let x=t*e;const w=f+x,T=a===void 0?w:a(w);T!==w&&(x=T-f);const I=C=>-x*Math.exp(-C/r),P=C=>T+I(C),N=C=>{const M=I(C),j=P(C);g.done=Math.abs(M)<=u,g.value=g.done?T:j};let D,B;const k=C=>{p(g.value)&&(D=C,B=K9({keyframes:[g.value,E(g.value)],velocity:H9(P,C,g.value),damping:i,stiffness:s,restDelta:u,restSpeed:h}))};return k(0),{calculatedDuration:null,next:C=>{let M=!1;return!B&&D===void 0&&(M=!0,N(C),k(C)),D!==void 0&&C>=D?B.next(C-D):(!M&&N(C),g)}}}const ore=y1(.42,0,1,1),lre=y1(0,0,.58,1),Y9=y1(.42,0,.58,1),cre=n=>Array.isArray(n)&&typeof n[0]!="number",ure={linear:Xs,easeIn:ore,easeInOut:Y9,easeOut:lre,circIn:sR,circInOut:R9,circOut:b9,backIn:iR,backInOut:I9,backOut:T9,anticipate:A9},vN=n=>{if(Jb(n)){W8(n.length===4);const[e,t,r,i]=n;return y1(e,t,r,i)}else if(typeof n=="string")return ure[n];return n};function hre(n,e,t){const r=[],i=t||W9,s=n.length-1;for(let a=0;a<s;a++){let o=i(n[a],n[a+1]);if(e){const l=Array.isArray(e)?e[a]||Xs:e;o=_1(l,o)}r.push(o)}return r}function dre(n,e,{clamp:t=!0,ease:r,mixer:i}={}){const s=n.length;if(W8(s===e.length),s===1)return()=>e[0];if(s===2&&e[0]===e[1])return()=>e[1];const a=n[0]===n[1];n[0]>n[s-1]&&(n=[...n].reverse(),e=[...e].reverse());const o=hre(e,r,i),l=o.length,u=h=>{if(a&&h<n[0])return e[0];let f=0;if(l>1)for(;f<n.length-2&&!(h<n[f+1]);f++);const g=S0(n[f],n[f+1],h);return o[f](g)};return t?h=>u(Bl(n[0],n[s-1],h)):u}function fre(n,e){const t=n[n.length-1];for(let r=1;r<=e;r++){const i=S0(0,e,r);n.push(cr(t,1,i))}}function gre(n){const e=[0];return fre(e,n.length-1),e}function mre(n,e){return n.map(t=>t*e)}function pre(n,e){return n.map(()=>e||Y9).splice(0,n.length-1)}function Xx({duration:n=300,keyframes:e,times:t,ease:r="easeInOut"}){const i=cre(r)?r.map(vN):vN(r),s={done:!1,value:e[0]},a=mre(t&&t.length===e.length?t:gre(e),n),o=dre(a,e,{ease:Array.isArray(i)?i:pre(e,i)});return{calculatedDuration:n,next:l=>(s.value=o(l),s.done=l>=n,s)}}const yre=n=>{const e=({timestamp:t})=>n(t);return{start:()=>qn.update(e,!0),stop:()=>hu(e),now:()=>pi.isProcessing?pi.timestamp:Vo.now()}},_re={decay:xN,inertia:xN,tween:Xx,keyframes:Xx,spring:K9},xre=n=>n/100;class hR extends z9{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:l}=this.options;l&&l()};const{name:t,motionValue:r,element:i,keyframes:s}=this.options,a=i?.KeyframeResolver||cR,o=(l,u)=>this.onKeyframesResolved(l,u);this.resolver=new a(s,o,t,r,i),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:t="keyframes",repeat:r=0,repeatDelay:i=0,repeatType:s,velocity:a=0}=this.options,o=Qb(t)?t:_re[t]||Xx;let l,u;o!==Xx&&typeof e[0]!="number"&&(l=_1(xre,W9(e[0],e[1])),e=[0,100]);const h=o({...this.options,keyframes:e});s==="mirror"&&(u=o({...this.options,keyframes:[...e].reverse(),velocity:-a})),h.calculatedDuration===null&&(h.calculatedDuration=h9(h));const{calculatedDuration:f}=h,g=f+i,p=g*(r+1)-i;return{generator:h,mirroredGenerator:u,mapPercentToKeyframes:l,calculatedDuration:f,resolvedDuration:g,totalDuration:p}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,t=!1){const{resolved:r}=this;if(!r){const{keyframes:C}=this.options;return{done:!0,value:C[C.length-1]}}const{finalKeyframe:i,generator:s,mirroredGenerator:a,mapPercentToKeyframes:o,keyframes:l,calculatedDuration:u,totalDuration:h,resolvedDuration:f}=r;if(this.startTime===null)return s.next(0);const{delay:g,repeat:p,repeatType:E,repeatDelay:x,onUpdate:w}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-h/this.speed,this.startTime)),t?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const T=this.currentTime-g*(this.speed>=0?1:-1),I=this.speed>=0?T<0:T>h;this.currentTime=Math.max(T,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=h);let P=this.currentTime,N=s;if(p){const C=Math.min(this.currentTime,h)/f;let M=Math.floor(C),j=C%1;!j&&C>=1&&(j=1),j===1&&M--,M=Math.min(M,p+1),M%2&&(E==="reverse"?(j=1-j,x&&(j-=x/f)):E==="mirror"&&(N=a)),P=Bl(0,1,j)*f}const D=I?{done:!1,value:l[0]}:N.next(P);o&&(D.value=o(D.value));let{done:B}=D;!I&&u!==null&&(B=this.speed>=0?this.currentTime>=h:this.currentTime<=0);const k=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&B);return k&&i!==void 0&&(D.value=kE(l,this.options,i)),w&&w(D.value),k&&this.finish(),D}get duration(){const{resolved:e}=this;return e?kl(e.calculatedDuration):0}get time(){return kl(this.currentTime)}set time(e){e=Pl(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=kl(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=yre,onPlay:t,startTime:r}=this.options;this.driver||(this.driver=e(s=>this.tick(s))),t&&t();const i=this.driver.now();this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=i):this.startTime=r??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const vre=new Set(["opacity","clipPath","filter","transform"]);function Ere(n,e,t,{delay:r=0,duration:i=300,repeat:s=0,repeatType:a="loop",ease:o="easeInOut",times:l}={}){const u={[e]:t};l&&(u.offset=l);const h=g9(o,i);return Array.isArray(h)&&(u.easing=h),n.animate(u,{delay:r,duration:i,easing:Array.isArray(h)?"linear":h,fill:"both",iterations:s+1,direction:a==="reverse"?"alternate":"normal"})}const wre=Fb(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),qx=10,Sre=2e4;function Tre(n){return Qb(n.type)||n.type==="spring"||!f9(n.ease)}function Ire(n,e){const t=new hR({...e,keyframes:n,repeat:0,delay:0,isGenerator:!0});let r={done:!1,value:n[0]};const i=[];let s=0;for(;!r.done&&s<Sre;)r=t.sample(s),i.push(r.value),s+=qx;return{times:void 0,keyframes:i,duration:s-qx,ease:"linear"}}const X9={anticipate:A9,backInOut:I9,circInOut:R9};function Are(n){return n in X9}class EN extends z9{constructor(e){super(e);const{name:t,motionValue:r,element:i,keyframes:s}=this.options;this.resolver=new U9(s,(a,o)=>this.onKeyframesResolved(a,o),t,r,i),this.resolver.scheduleResolve()}initPlayback(e,t){let{duration:r=300,times:i,ease:s,type:a,motionValue:o,name:l,startTime:u}=this.options;if(!o.owner||!o.owner.current)return!1;if(typeof s=="string"&&Kx()&&Are(s)&&(s=X9[s]),Tre(this.options)){const{onComplete:f,onUpdate:g,motionValue:p,element:E,...x}=this.options,w=Ire(e,x);e=w.keyframes,e.length===1&&(e[1]=e[0]),r=w.duration,i=w.times,s=w.ease,a="keyframes"}const h=Ere(o.owner.current,l,e,{...this.options,duration:r,times:i,ease:s});return h.startTime=u??this.calcStartTime(),this.pendingTimeline?(sN(h,this.pendingTimeline),this.pendingTimeline=void 0):h.onfinish=()=>{const{onComplete:f}=this.options;o.set(kE(e,this.options,t)),f&&f(),this.cancel(),this.resolveFinishedPromise()},{animation:h,duration:r,times:i,type:a,ease:s,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:t}=e;return kl(t)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:t}=e;return kl(t.currentTime||0)}set time(e){const{resolved:t}=this;if(!t)return;const{animation:r}=t;r.currentTime=Pl(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:t}=e;return t.playbackRate}set speed(e){const{resolved:t}=this;if(!t)return;const{animation:r}=t;r.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:t}=e;return t.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:t}=e;return t.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:t}=this;if(!t)return Xs;const{animation:r}=t;sN(r,e)}return Xs}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.playState==="finished"&&this.updateFinishedPromise(),t.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:t,keyframes:r,duration:i,type:s,ease:a,times:o}=e;if(t.playState==="idle"||t.playState==="finished")return;if(this.time){const{motionValue:u,onUpdate:h,onComplete:f,element:g,...p}=this.options,E=new hR({...p,keyframes:r,duration:i,type:s,ease:a,times:o,isGenerator:!0}),x=Pl(this.time);u.setWithVelocity(E.sample(x-qx).value,E.sample(x).value,qx)}const{onStop:l}=this.options;l&&l(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:t,name:r,repeatDelay:i,repeatType:s,damping:a,type:o}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:u}=t.owner.getProps();return wre()&&r&&vre.has(r)&&!l&&!u&&!i&&s!=="mirror"&&a!==0&&o!=="inertia"}}const bre={type:"spring",stiffness:500,damping:25,restSpeed:10},Rre=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),Cre={type:"keyframes",duration:.8},Pre={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},kre=(n,{keyframes:e})=>e.length>2?Cre:hd.has(n)?n.startsWith("scale")?Rre(e[1]):bre:Pre;function Mre({when:n,delay:e,delayChildren:t,staggerChildren:r,staggerDirection:i,repeat:s,repeatType:a,repeatDelay:o,from:l,elapsed:u,...h}){return!!Object.keys(h).length}const dR=(n,e,t,r={},i,s)=>a=>{const o=Zb(r,n)||{},l=o.delay||r.delay||0;let{elapsed:u=0}=r;u=u-Pl(l);let h={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...o,delay:-u,onUpdate:g=>{e.set(g),o.onUpdate&&o.onUpdate(g)},onComplete:()=>{a(),o.onComplete&&o.onComplete()},name:n,motionValue:e,element:s?void 0:i};Mre(o)||(h={...h,...kre(n,h)}),h.duration&&(h.duration=Pl(h.duration)),h.repeatDelay&&(h.repeatDelay=Pl(h.repeatDelay)),h.from!==void 0&&(h.keyframes[0]=h.from);let f=!1;if((h.type===!1||h.duration===0&&!h.repeatDelay)&&(h.duration=0,h.delay===0&&(f=!0)),f&&!s&&e.get()!==void 0){const g=kE(h.keyframes,o);if(g!==void 0)return qn.update(()=>{h.onUpdate(g),h.onComplete()}),new Zte([])}return!s&&EN.supports(h)?new EN(h):new hR(h)};function Nre({protectedKeys:n,needsAnimating:e},t){const r=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,r}function q9(n,e,{delay:t=0,transitionOverride:r,type:i}={}){var s;let{transition:a=n.getDefaultTransition(),transitionEnd:o,...l}=e;r&&(a=r);const u=[],h=i&&n.animationState&&n.animationState.getState()[i];for(const f in l){const g=n.getValue(f,(s=n.latestValues[f])!==null&&s!==void 0?s:null),p=l[f];if(p===void 0||h&&Nre(h,f))continue;const E={delay:t,...Zb(a||{},f)};let x=!1;if(window.MotionHandoffAnimation){const T=v9(n);if(T){const I=window.MotionHandoffAnimation(T,f,qn);I!==null&&(E.startTime=I,x=!0)}}iI(n,f),g.start(dR(f,g,p,n.shouldReduceMotion&&_9.has(f)?{type:!1}:E,n,x));const w=g.animation;w&&u.push(w)}return o&&Promise.all(u).then(()=>{qn.update(()=>{o&&hne(n,o)})}),u}function hI(n,e,t={}){var r;const i=PE(n,e,t.type==="exit"?(r=n.presenceContext)===null||r===void 0?void 0:r.custom:void 0);let{transition:s=n.getDefaultTransition()||{}}=i||{};t.transitionOverride&&(s=t.transitionOverride);const a=i?()=>Promise.all(q9(n,i,t)):()=>Promise.resolve(),o=n.variantChildren&&n.variantChildren.size?(u=0)=>{const{delayChildren:h=0,staggerChildren:f,staggerDirection:g}=s;return Lre(n,e,h+u,f,g,t)}:()=>Promise.resolve(),{when:l}=s;if(l){const[u,h]=l==="beforeChildren"?[a,o]:[o,a];return u().then(()=>h())}else return Promise.all([a(),o(t.delay)])}function Lre(n,e,t=0,r=0,i=1,s){const a=[],o=(n.variantChildren.size-1)*r,l=i===1?(u=0)=>u*r:(u=0)=>o-u*r;return Array.from(n.variantChildren).sort(Ore).forEach((u,h)=>{u.notify("AnimationStart",e),a.push(hI(u,e,{...s,delay:t+l(h)}).then(()=>u.notify("AnimationComplete",e)))}),Promise.all(a)}function Ore(n,e){return n.sortNodePosition(e)}function Dre(n,e,t={}){n.notify("AnimationStart",e);let r;if(Array.isArray(e)){const i=e.map(s=>hI(n,s,t));r=Promise.all(i)}else if(typeof e=="string")r=hI(n,e,t);else{const i=typeof e=="function"?PE(n,e,t.custom):e;r=Promise.all(q9(n,i,t))}return r.then(()=>{n.notify("AnimationComplete",e)})}const Fre=Vb.length;function Z9(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?Z9(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<Fre;t++){const r=Vb[t],i=n.props[r];(yp(i)||i===!1)&&(e[r]=i)}return e}const jre=[...jb].reverse(),Vre=jb.length;function Gre(n){return e=>Promise.all(e.map(({animation:t,options:r})=>Dre(n,t,r)))}function Bre(n){let e=Gre(n),t=wN(),r=!0;const i=l=>(u,h)=>{var f;const g=PE(n,h,l==="exit"?(f=n.presenceContext)===null||f===void 0?void 0:f.custom:void 0);if(g){const{transition:p,transitionEnd:E,...x}=g;u={...u,...x,...E}}return u};function s(l){e=l(n)}function a(l){const{props:u}=n,h=Z9(n.parent)||{},f=[],g=new Set;let p={},E=1/0;for(let w=0;w<Vre;w++){const T=jre[w],I=t[T],P=u[T]!==void 0?u[T]:h[T],N=yp(P),D=T===l?I.isActive:null;D===!1&&(E=w);let B=P===h[T]&&P!==u[T]&&N;if(B&&r&&n.manuallyAnimateOnMount&&(B=!1),I.protectedKeys={...p},!I.isActive&&D===null||!P&&!I.prevProp||RE(P)||typeof P=="boolean")continue;const k=Ure(I.prevProp,P);let C=k||T===l&&I.isActive&&!B&&N||w>E&&N,M=!1;const j=Array.isArray(P)?P:[P];let O=j.reduce(i(T),{});D===!1&&(O={});const{prevResolvedValues:W={}}=I,F={...W,...O},Te=Re=>{C=!0,g.has(Re)&&(M=!0,g.delete(Re)),I.needsAnimating[Re]=!0;const ue=n.getValue(Re);ue&&(ue.liveStyle=!1)};for(const Re in F){const ue=O[Re],be=W[Re];if(p.hasOwnProperty(Re))continue;let ce=!1;tI(ue)&&tI(be)?ce=!u9(ue,be):ce=ue!==be,ce?ue!=null?Te(Re):g.add(Re):ue!==void 0&&g.has(Re)?Te(Re):I.protectedKeys[Re]=!0}I.prevProp=P,I.prevResolvedValues=O,I.isActive&&(p={...p,...O}),r&&n.blockInitialAnimation&&(C=!1),C&&(!(B&&k)||M)&&f.push(...j.map(Re=>({animation:Re,options:{type:T}})))}if(g.size){const w={};g.forEach(T=>{const I=n.getBaseTarget(T),P=n.getValue(T);P&&(P.liveStyle=!0),w[T]=I??null}),f.push({animation:w})}let x=!!f.length;return r&&(u.initial===!1||u.initial===u.animate)&&!n.manuallyAnimateOnMount&&(x=!1),r=!1,x?e(f):Promise.resolve()}function o(l,u){var h;if(t[l].isActive===u)return Promise.resolve();(h=n.variantChildren)===null||h===void 0||h.forEach(g=>{var p;return(p=g.animationState)===null||p===void 0?void 0:p.setActive(l,u)}),t[l].isActive=u;const f=a(l);for(const g in t)t[g].protectedKeys={};return f}return{animateChanges:a,setActive:o,setAnimateFunction:s,getState:()=>t,reset:()=>{t=wN(),r=!0}}}function Ure(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!u9(e,n):!1}function Zu(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function wN(){return{animate:Zu(!0),whileInView:Zu(),whileHover:Zu(),whileTap:Zu(),whileDrag:Zu(),whileFocus:Zu(),exit:Zu()}}class Tu{constructor(e){this.isMounted=!1,this.node=e}update(){}}class zre extends Tu{constructor(e){super(e),e.animationState||(e.animationState=Bre(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();RE(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let $re=0;class Wre extends Tu{constructor(){super(...arguments),this.id=$re++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const i=this.node.animationState.setActive("exit",!e);t&&!e&&i.then(()=>t(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const Hre={animation:{Feature:zre},exit:{Feature:Wre}};function Ep(n,e,t,r={passive:!0}){return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t)}function x1(n){return{point:{x:n.pageX,y:n.pageY}}}const Kre=n=>e=>eR(e)&&n(e,x1(e));function Sm(n,e,t,r){return Ep(n,e,Kre(t),r)}const SN=(n,e)=>Math.abs(n-e);function Yre(n,e){const t=SN(n.x,e.x),r=SN(n.y,e.y);return Math.sqrt(t**2+r**2)}class Q9{constructor(e,t,{transformPagePoint:r,contextWindow:i,dragSnapToOrigin:s=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const f=ES(this.lastMoveEventInfo,this.history),g=this.startEvent!==null,p=Yre(f.offset,{x:0,y:0})>=3;if(!g&&!p)return;const{point:E}=f,{timestamp:x}=pi;this.history.push({...E,timestamp:x});const{onStart:w,onMove:T}=this.handlers;g||(w&&w(this.lastMoveEvent,f),this.startEvent=this.lastMoveEvent),T&&T(this.lastMoveEvent,f)},this.handlePointerMove=(f,g)=>{this.lastMoveEvent=f,this.lastMoveEventInfo=vS(g,this.transformPagePoint),qn.update(this.updatePoint,!0)},this.handlePointerUp=(f,g)=>{this.end();const{onEnd:p,onSessionEnd:E,resumeAnimation:x}=this.handlers;if(this.dragSnapToOrigin&&x&&x(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const w=ES(f.type==="pointercancel"?this.lastMoveEventInfo:vS(g,this.transformPagePoint),this.history);this.startEvent&&p&&p(f,w),E&&E(f,w)},!eR(e))return;this.dragSnapToOrigin=s,this.handlers=t,this.transformPagePoint=r,this.contextWindow=i||window;const a=x1(e),o=vS(a,this.transformPagePoint),{point:l}=o,{timestamp:u}=pi;this.history=[{...l,timestamp:u}];const{onSessionStart:h}=t;h&&h(e,ES(o,this.history)),this.removeListeners=_1(Sm(this.contextWindow,"pointermove",this.handlePointerMove),Sm(this.contextWindow,"pointerup",this.handlePointerUp),Sm(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),hu(this.updatePoint)}}function vS(n,e){return e?{point:e(n.point)}:n}function TN(n,e){return{x:n.x-e.x,y:n.y-e.y}}function ES({point:n},e){return{point:n,delta:TN(n,J9(e)),offset:TN(n,Xre(e)),velocity:qre(e,.1)}}function Xre(n){return n[0]}function J9(n){return n[n.length-1]}function qre(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,r=null;const i=J9(n);for(;t>=0&&(r=n[t],!(i.timestamp-r.timestamp>Pl(e)));)t--;if(!r)return{x:0,y:0};const s=kl(i.timestamp-r.timestamp);if(s===0)return{x:0,y:0};const a={x:(i.x-r.x)/s,y:(i.y-r.y)/s};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}const ej=1e-4,Zre=1-ej,Qre=1+ej,tj=.01,Jre=0-tj,eie=0+tj;function ea(n){return n.max-n.min}function tie(n,e,t){return Math.abs(n-e)<=t}function IN(n,e,t,r=.5){n.origin=r,n.originPoint=cr(e.min,e.max,n.origin),n.scale=ea(t)/ea(e),n.translate=cr(t.min,t.max,n.origin)-n.originPoint,(n.scale>=Zre&&n.scale<=Qre||isNaN(n.scale))&&(n.scale=1),(n.translate>=Jre&&n.translate<=eie||isNaN(n.translate))&&(n.translate=0)}function Tm(n,e,t,r){IN(n.x,e.x,t.x,r?r.originX:void 0),IN(n.y,e.y,t.y,r?r.originY:void 0)}function AN(n,e,t){n.min=t.min+e.min,n.max=n.min+ea(e)}function nie(n,e,t){AN(n.x,e.x,t.x),AN(n.y,e.y,t.y)}function bN(n,e,t){n.min=e.min-t.min,n.max=n.min+ea(e)}function Im(n,e,t){bN(n.x,e.x,t.x),bN(n.y,e.y,t.y)}function rie(n,{min:e,max:t},r){return e!==void 0&&n<e?n=r?cr(e,n,r.min):Math.max(n,e):t!==void 0&&n>t&&(n=r?cr(t,n,r.max):Math.min(n,t)),n}function RN(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function iie(n,{top:e,left:t,bottom:r,right:i}){return{x:RN(n.x,t,i),y:RN(n.y,e,r)}}function CN(n,e){let t=e.min-n.min,r=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,r]=[r,t]),{min:t,max:r}}function sie(n,e){return{x:CN(n.x,e.x),y:CN(n.y,e.y)}}function aie(n,e){let t=.5;const r=ea(n),i=ea(e);return i>r?t=S0(e.min,e.max-r,n.min):r>i&&(t=S0(n.min,n.max-i,e.min)),Bl(0,1,t)}function oie(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const dI=.35;function lie(n=dI){return n===!1?n=0:n===!0&&(n=dI),{x:PN(n,"left","right"),y:PN(n,"top","bottom")}}function PN(n,e,t){return{min:kN(n,e),max:kN(n,t)}}function kN(n,e){return typeof n=="number"?n:n[e]||0}const MN=()=>({translate:0,scale:1,origin:0,originPoint:0}),Cf=()=>({x:MN(),y:MN()}),NN=()=>({min:0,max:0}),Sr=()=>({x:NN(),y:NN()});function fa(n){return[n("x"),n("y")]}function nj({top:n,left:e,right:t,bottom:r}){return{x:{min:e,max:t},y:{min:n,max:r}}}function cie({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function uie(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),r=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:r.y,right:r.x}}function wS(n){return n===void 0||n===1}function fI({scale:n,scaleX:e,scaleY:t}){return!wS(n)||!wS(e)||!wS(t)}function ih(n){return fI(n)||rj(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function rj(n){return LN(n.x)||LN(n.y)}function LN(n){return n&&n!=="0%"}function Zx(n,e,t){const r=n-t,i=e*r;return t+i}function ON(n,e,t,r,i){return i!==void 0&&(n=Zx(n,i,r)),Zx(n,t,r)+e}function gI(n,e=0,t=1,r,i){n.min=ON(n.min,e,t,r,i),n.max=ON(n.max,e,t,r,i)}function ij(n,{x:e,y:t}){gI(n.x,e.translate,e.scale,e.originPoint),gI(n.y,t.translate,t.scale,t.originPoint)}const DN=.999999999999,FN=1.0000000000001;function hie(n,e,t,r=!1){const i=t.length;if(!i)return;e.x=e.y=1;let s,a;for(let o=0;o<i;o++){s=t[o],a=s.projectionDelta;const{visualElement:l}=s.options;l&&l.props.style&&l.props.style.display==="contents"||(r&&s.options.layoutScroll&&s.scroll&&s!==s.root&&kf(n,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),a&&(e.x*=a.x.scale,e.y*=a.y.scale,ij(n,a)),r&&ih(s.latestValues)&&kf(n,s.latestValues))}e.x<FN&&e.x>DN&&(e.x=1),e.y<FN&&e.y>DN&&(e.y=1)}function Pf(n,e){n.min=n.min+e,n.max=n.max+e}function jN(n,e,t,r,i=.5){const s=cr(n.min,n.max,i);gI(n,e,t,s,r)}function kf(n,e){jN(n.x,e.x,e.scaleX,e.scale,e.originX),jN(n.y,e.y,e.scaleY,e.scale,e.originY)}function sj(n,e){return nj(uie(n.getBoundingClientRect(),e))}function die(n,e,t){const r=sj(n,t),{scroll:i}=e;return i&&(Pf(r.x,i.offset.x),Pf(r.y,i.offset.y)),r}const aj=({current:n})=>n?n.ownerDocument.defaultView:null,fie=new WeakMap;class gie{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Sr(),this.visualElement=e}start(e,{snapToCursor:t=!1}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const i=h=>{const{dragSnapToOrigin:f}=this.getProps();f?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(x1(h).point)},s=(h,f)=>{const{drag:g,dragPropagation:p,onDragStart:E}=this.getProps();if(g&&!p&&(this.openDragLock&&this.openDragLock(),this.openDragLock=ane(g),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),fa(w=>{let T=this.getAxisMotionValue(w).get()||0;if(jo.test(T)){const{projection:I}=this.visualElement;if(I&&I.layout){const P=I.layout.layoutBox[w];P&&(T=ea(P)*(parseFloat(T)/100))}}this.originPoint[w]=T}),E&&qn.postRender(()=>E(h,f)),iI(this.visualElement,"transform");const{animationState:x}=this.visualElement;x&&x.setActive("whileDrag",!0)},a=(h,f)=>{const{dragPropagation:g,dragDirectionLock:p,onDirectionLock:E,onDrag:x}=this.getProps();if(!g&&!this.openDragLock)return;const{offset:w}=f;if(p&&this.currentDirection===null){this.currentDirection=mie(w),this.currentDirection!==null&&E&&E(this.currentDirection);return}this.updateAxis("x",f.point,w),this.updateAxis("y",f.point,w),this.visualElement.render(),x&&x(h,f)},o=(h,f)=>this.stop(h,f),l=()=>fa(h=>{var f;return this.getAnimationState(h)==="paused"&&((f=this.getAxisMotionValue(h).animation)===null||f===void 0?void 0:f.play())}),{dragSnapToOrigin:u}=this.getProps();this.panSession=new Q9(e,{onSessionStart:i,onStart:s,onMove:a,onSessionEnd:o,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,contextWindow:aj(this.visualElement)})}stop(e,t){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:i}=t;this.startAnimation(i);const{onDragEnd:s}=this.getProps();s&&qn.postRender(()=>s(e,t))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,r){const{drag:i}=this.getProps();if(!r||!a_(e,i,this.currentDirection))return;const s=this.getAxisMotionValue(e);let a=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(a=rie(a,this.constraints[e],this.elastic[e])),s.set(a)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:r}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,s=this.constraints;t&&bf(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&i?this.constraints=iie(i.layoutBox,t):this.constraints=!1,this.elastic=lie(r),s!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&fa(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=oie(i.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!bf(e))return!1;const r=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const s=die(r,i.root,this.visualElement.getTransformPagePoint());let a=sie(i.layout.layoutBox,s);if(t){const o=t(cie(a));this.hasMutatedConstraints=!!o,o&&(a=nj(o))}return a}startAnimation(e){const{drag:t,dragMomentum:r,dragElastic:i,dragTransition:s,dragSnapToOrigin:a,onDragTransitionEnd:o}=this.getProps(),l=this.constraints||{},u=fa(h=>{if(!a_(h,t,this.currentDirection))return;let f=l&&l[h]||{};a&&(f={min:0,max:0});const g=i?200:1e6,p=i?40:1e7,E={type:"inertia",velocity:r?e[h]:0,bounceStiffness:g,bounceDamping:p,timeConstant:750,restDelta:1,restSpeed:10,...s,...f};return this.startAxisValueAnimation(h,E)});return Promise.all(u).then(o)}startAxisValueAnimation(e,t){const r=this.getAxisMotionValue(e);return iI(this.visualElement,e),r.start(dR(e,r,0,t,this.visualElement,!1))}stopAnimation(){fa(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){fa(e=>{var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.pause()})}getAnimationState(e){var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,r=this.visualElement.getProps(),i=r[t];return i||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){fa(t=>{const{drag:r}=this.getProps();if(!a_(t,r,this.currentDirection))return;const{projection:i}=this.visualElement,s=this.getAxisMotionValue(t);if(i&&i.layout){const{min:a,max:o}=i.layout.layoutBox[t];s.set(e[t]-cr(a,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:r}=this.visualElement;if(!bf(t)||!r||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};fa(a=>{const o=this.getAxisMotionValue(a);if(o&&this.constraints!==!1){const l=o.get();i[a]=aie({min:l,max:l},this.constraints[a])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),fa(a=>{if(!a_(a,e,null))return;const o=this.getAxisMotionValue(a),{min:l,max:u}=this.constraints[a];o.set(cr(l,u,i[a]))})}addListeners(){if(!this.visualElement.current)return;fie.set(this.visualElement,this);const e=this.visualElement.current,t=Sm(e,"pointerdown",l=>{const{drag:u,dragListener:h=!0}=this.getProps();u&&h&&this.start(l)}),r=()=>{const{dragConstraints:l}=this.getProps();bf(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,s=i.addEventListener("measure",r);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),qn.read(r);const a=Ep(window,"resize",()=>this.scalePositionWithinConstraints()),o=i.addEventListener("didUpdate",(({delta:l,hasLayoutChanged:u})=>{this.isDragging&&u&&(fa(h=>{const f=this.getAxisMotionValue(h);f&&(this.originPoint[h]+=l[h].translate,f.set(f.get()+l[h].translate))}),this.visualElement.render())}));return()=>{a(),t(),s(),o&&o()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:r=!1,dragPropagation:i=!1,dragConstraints:s=!1,dragElastic:a=dI,dragMomentum:o=!0}=e;return{...e,drag:t,dragDirectionLock:r,dragPropagation:i,dragConstraints:s,dragElastic:a,dragMomentum:o}}}function a_(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function mie(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class pie extends Tu{constructor(e){super(e),this.removeGroupControls=Xs,this.removeListeners=Xs,this.controls=new gie(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Xs}unmount(){this.removeGroupControls(),this.removeListeners()}}const VN=n=>(e,t)=>{n&&qn.postRender(()=>n(e,t))};class yie extends Tu{constructor(){super(...arguments),this.removePointerDownListener=Xs}onPointerDown(e){this.session=new Q9(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:aj(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:r,onPanEnd:i}=this.node.getProps();return{onSessionStart:VN(e),onStart:VN(t),onMove:r,onEnd:(s,a)=>{delete this.session,i&&qn.postRender(()=>i(s,a))}}}mount(){this.removePointerDownListener=Sm(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const z_={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function GN(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const zg={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(Dt.test(n))n=parseFloat(n);else return n;const t=GN(n,e.target.x),r=GN(n,e.target.y);return`${t}% ${r}%`}},_ie={correct:(n,{treeScale:e,projectionDelta:t})=>{const r=n,i=du.parse(n);if(i.length>5)return r;const s=du.createTransformer(n),a=typeof i[0]!="number"?1:0,o=t.x.scale*e.x,l=t.y.scale*e.y;i[0+a]/=o,i[1+a]/=l;const u=cr(o,l,.5);return typeof i[2+a]=="number"&&(i[2+a]/=u),typeof i[3+a]=="number"&&(i[3+a]/=u),s(i)}};class xie extends se.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r,layoutId:i}=this.props,{projection:s}=e;Vte(vie),s&&(t.group&&t.group.add(s),r&&r.register&&i&&r.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),z_.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:r,drag:i,isPresent:s}=this.props,a=r.projection;return a&&(a.isPresent=s,i||e.layoutDependency!==t||t===void 0?a.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?a.promote():a.relegate()||qn.postRender(()=>{const o=a.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),Bb.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r}=this.props,{projection:i}=e;i&&(i.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(i),r&&r.deregister&&r.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function oj(n){const[e,t]=z8(),r=se.useContext(Nb);return y.jsx(xie,{...n,layoutGroup:r,switchLayoutGroup:se.useContext(Z8),isPresent:e,safeToRemove:t})}const vie={borderRadius:{...zg,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:zg,borderTopRightRadius:zg,borderBottomLeftRadius:zg,borderBottomRightRadius:zg,boxShadow:_ie};function Eie(n,e,t){const r=Vi(n)?n:xp(n);return r.start(dR("",r,e,t)),r.animation}function wie(n){return n instanceof SVGElement&&n.tagName!=="svg"}const Sie=(n,e)=>n.depth-e.depth;class Tie{constructor(){this.children=[],this.isDirty=!1}add(e){tR(this.children,e),this.isDirty=!0}remove(e){nR(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(Sie),this.isDirty=!1,this.children.forEach(e)}}function Iie(n,e){const t=Vo.now(),r=({timestamp:i})=>{const s=i-t;s>=e&&(hu(r),n(s-e))};return qn.read(r,!0),()=>hu(r)}const lj=["TopLeft","TopRight","BottomLeft","BottomRight"],Aie=lj.length,BN=n=>typeof n=="string"?parseFloat(n):n,UN=n=>typeof n=="number"||Dt.test(n);function bie(n,e,t,r,i,s){i?(n.opacity=cr(0,t.opacity!==void 0?t.opacity:1,Rie(r)),n.opacityExit=cr(e.opacity!==void 0?e.opacity:1,0,Cie(r))):s&&(n.opacity=cr(e.opacity!==void 0?e.opacity:1,t.opacity!==void 0?t.opacity:1,r));for(let a=0;a<Aie;a++){const o=`border${lj[a]}Radius`;let l=zN(e,o),u=zN(t,o);if(l===void 0&&u===void 0)continue;l||(l=0),u||(u=0),l===0||u===0||UN(l)===UN(u)?(n[o]=Math.max(cr(BN(l),BN(u),r),0),(jo.test(u)||jo.test(l))&&(n[o]+="%")):n[o]=u}(e.rotate||t.rotate)&&(n.rotate=cr(e.rotate||0,t.rotate||0,r))}function zN(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const Rie=cj(0,.5,b9),Cie=cj(.5,.95,Xs);function cj(n,e,t){return r=>r<n?0:r>e?1:t(S0(n,e,r))}function $N(n,e){n.min=e.min,n.max=e.max}function ha(n,e){$N(n.x,e.x),$N(n.y,e.y)}function WN(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function HN(n,e,t,r,i){return n-=e,n=Zx(n,1/t,r),i!==void 0&&(n=Zx(n,1/i,r)),n}function Pie(n,e=0,t=1,r=.5,i,s=n,a=n){if(jo.test(e)&&(e=parseFloat(e),e=cr(a.min,a.max,e/100)-a.min),typeof e!="number")return;let o=cr(s.min,s.max,r);n===s&&(o-=e),n.min=HN(n.min,e,t,o,i),n.max=HN(n.max,e,t,o,i)}function KN(n,e,[t,r,i],s,a){Pie(n,e[t],e[r],e[i],e.scale,s,a)}const kie=["x","scaleX","originX"],Mie=["y","scaleY","originY"];function YN(n,e,t,r){KN(n.x,e,kie,t?t.x:void 0,r?r.x:void 0),KN(n.y,e,Mie,t?t.y:void 0,r?r.y:void 0)}function XN(n){return n.translate===0&&n.scale===1}function uj(n){return XN(n.x)&&XN(n.y)}function qN(n,e){return n.min===e.min&&n.max===e.max}function Nie(n,e){return qN(n.x,e.x)&&qN(n.y,e.y)}function ZN(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function hj(n,e){return ZN(n.x,e.x)&&ZN(n.y,e.y)}function QN(n){return ea(n.x)/ea(n.y)}function JN(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class Lie{constructor(){this.members=[]}add(e){tR(this.members,e),e.scheduleRender()}remove(e){if(nR(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(i=>e===i);if(t===0)return!1;let r;for(let i=t;i>=0;i--){const s=this.members[i];if(s.isPresent!==!1){r=s;break}}return r?(this.promote(r),!0):!1}promote(e,t){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,t&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:r}=e;t.onExitComplete&&t.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function Oie(n,e,t){let r="";const i=n.x.translate/e.x,s=n.y.translate/e.y,a=t?.z||0;if((i||s||a)&&(r=`translate3d(${i}px, ${s}px, ${a}px) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:u,rotate:h,rotateX:f,rotateY:g,skewX:p,skewY:E}=t;u&&(r=`perspective(${u}px) ${r}`),h&&(r+=`rotate(${h}deg) `),f&&(r+=`rotateX(${f}deg) `),g&&(r+=`rotateY(${g}deg) `),p&&(r+=`skewX(${p}deg) `),E&&(r+=`skewY(${E}deg) `)}const o=n.x.scale*e.x,l=n.y.scale*e.y;return(o!==1||l!==1)&&(r+=`scale(${o}, ${l})`),r||"none"}const sh={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},sm=typeof window<"u"&&window.MotionDebug!==void 0,SS=["","X","Y","Z"],Die={visibility:"hidden"},eL=1e3;let Fie=0;function TS(n,e,t,r){const{latestValues:i}=e;i[n]&&(t[n]=i[n],e.setStaticValue(n,0),r&&(r[n]=0))}function dj(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=v9(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:i,layoutId:s}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",qn,!(i||s))}const{parent:r}=n;r&&!r.hasCheckedOptimisedAppear&&dj(r)}function fj({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:r,resetTransform:i}){return class{constructor(a={},o=e?.()){this.id=Fie++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,sm&&(sh.totalNodes=sh.resolvedTargetDeltas=sh.recalculatedProjection=0),this.nodes.forEach(Gie),this.nodes.forEach(Wie),this.nodes.forEach(Hie),this.nodes.forEach(Bie),sm&&window.MotionDebug.record(sh)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new Tie)}addEventListener(a,o){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new rR),this.eventHandlers.get(a).add(o)}notifyListeners(a,...o){const l=this.eventHandlers.get(a);l&&l.notify(...o)}hasListeners(a){return this.eventHandlers.has(a)}mount(a,o=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=wie(a),this.instance=a;const{layoutId:l,layout:u,visualElement:h}=this.options;if(h&&!h.current&&h.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),o&&(u||l)&&(this.isLayoutDirty=!0),n){let f;const g=()=>this.root.updateBlockedByResize=!1;n(a,()=>{this.root.updateBlockedByResize=!0,f&&f(),f=Iie(g,250),z_.hasAnimatedSinceResize&&(z_.hasAnimatedSinceResize=!1,this.nodes.forEach(nL))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&h&&(l||u)&&this.addEventListener("didUpdate",({delta:f,hasLayoutChanged:g,hasRelativeTargetChanged:p,layout:E})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const x=this.options.transition||h.getDefaultTransition()||Zie,{onLayoutAnimationStart:w,onLayoutAnimationComplete:T}=h.getProps(),I=!this.targetLayout||!hj(this.targetLayout,E)||p,P=!g&&p;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||P||g&&(I||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(f,P);const N={...Zb(x,"layout"),onPlay:w,onComplete:T};(h.shouldReduceMotion||this.options.layoutRoot)&&(N.delay=0,N.type=!1),this.startAnimation(N)}else g||nL(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=E})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,hu(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Kie),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&dj(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let h=0;h<this.path.length;h++){const f=this.path[h];f.shouldResetTransform=!0,f.updateScroll("snapshot"),f.options.layoutRoot&&f.willUpdate(!1)}const{layoutId:o,layout:l}=this.options;if(o===void 0&&!l)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(tL);return}this.isUpdating||this.nodes.forEach(zie),this.isUpdating=!1,this.nodes.forEach($ie),this.nodes.forEach(jie),this.nodes.forEach(Vie),this.clearAllSnapshots();const o=Vo.now();pi.delta=Bl(0,1e3/60,o-pi.timestamp),pi.timestamp=o,pi.isProcessing=!0,gS.update.process(pi),gS.preRender.process(pi),gS.render.process(pi),pi.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,Bb.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(Uie),this.sharedNodes.forEach(Yie)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,qn.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){qn.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Sr(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(o=!1),o){const l=r(this.instance);this.scroll={animationId:this.root.animationId,phase:a,isRoot:l,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!i)return;const a=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!uj(this.projectionDelta),l=this.getTransformTemplate(),u=l?l(this.latestValues,""):void 0,h=u!==this.prevTransformTemplateValue;a&&(o||ih(this.latestValues)||h)&&(i(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const o=this.measurePageBox();let l=this.removeElementScroll(o);return a&&(l=this.removeTransform(l)),Qie(l),{animationId:this.root.animationId,measuredBox:o,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var a;const{visualElement:o}=this.options;if(!o)return Sr();const l=o.measureViewportBox();if(!(((a=this.scroll)===null||a===void 0?void 0:a.wasRoot)||this.path.some(Jie))){const{scroll:h}=this.root;h&&(Pf(l.x,h.offset.x),Pf(l.y,h.offset.y))}return l}removeElementScroll(a){var o;const l=Sr();if(ha(l,a),!((o=this.scroll)===null||o===void 0)&&o.wasRoot)return l;for(let u=0;u<this.path.length;u++){const h=this.path[u],{scroll:f,options:g}=h;h!==this.root&&f&&g.layoutScroll&&(f.wasRoot&&ha(l,a),Pf(l.x,f.offset.x),Pf(l.y,f.offset.y))}return l}applyTransform(a,o=!1){const l=Sr();ha(l,a);for(let u=0;u<this.path.length;u++){const h=this.path[u];!o&&h.options.layoutScroll&&h.scroll&&h!==h.root&&kf(l,{x:-h.scroll.offset.x,y:-h.scroll.offset.y}),ih(h.latestValues)&&kf(l,h.latestValues)}return ih(this.latestValues)&&kf(l,this.latestValues),l}removeTransform(a){const o=Sr();ha(o,a);for(let l=0;l<this.path.length;l++){const u=this.path[l];if(!u.instance||!ih(u.latestValues))continue;fI(u.latestValues)&&u.updateSnapshot();const h=Sr(),f=u.measurePageBox();ha(h,f),YN(o,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,h)}return ih(this.latestValues)&&YN(o,this.latestValues),o}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==pi.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var o;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==l;if(!(a||u&&this.isSharedProjectionDirty||this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:f,layoutId:g}=this.options;if(!(!this.layout||!(f||g))){if(this.resolvedRelativeTargetAt=pi.timestamp,!this.targetDelta&&!this.relativeTarget){const p=this.getClosestProjectingParent();p&&p.layout&&this.animationProgress!==1?(this.relativeParent=p,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Sr(),this.relativeTargetOrigin=Sr(),Im(this.relativeTargetOrigin,this.layout.layoutBox,p.layout.layoutBox),ha(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Sr(),this.targetWithTransforms=Sr()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),nie(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):ha(this.target,this.layout.layoutBox),ij(this.target,this.targetDelta)):ha(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const p=this.getClosestProjectingParent();p&&!!p.resumingFrom==!!this.resumingFrom&&!p.options.layoutScroll&&p.target&&this.animationProgress!==1?(this.relativeParent=p,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Sr(),this.relativeTargetOrigin=Sr(),Im(this.relativeTargetOrigin,this.target,p.target),ha(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}sm&&sh.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||fI(this.parent.latestValues)||rj(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var a;const o=this.getLead(),l=!!this.resumingFrom||this!==o;let u=!0;if((this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty)&&(u=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===pi.timestamp&&(u=!1),u)return;const{layout:h,layoutId:f}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(h||f))return;ha(this.layoutCorrected,this.layout.layoutBox);const g=this.treeScale.x,p=this.treeScale.y;hie(this.layoutCorrected,this.treeScale,this.path,l),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=Sr());const{target:E}=o;if(!E){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(WN(this.prevProjectionDelta.x,this.projectionDelta.x),WN(this.prevProjectionDelta.y,this.projectionDelta.y)),Tm(this.projectionDelta,this.layoutCorrected,E,this.latestValues),(this.treeScale.x!==g||this.treeScale.y!==p||!JN(this.projectionDelta.x,this.prevProjectionDelta.x)||!JN(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",E)),sm&&sh.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){var o;if((o=this.options.visualElement)===null||o===void 0||o.scheduleRender(),a){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Cf(),this.projectionDelta=Cf(),this.projectionDeltaWithTransform=Cf()}setAnimationOrigin(a,o=!1){const l=this.snapshot,u=l?l.latestValues:{},h={...this.latestValues},f=Cf();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const g=Sr(),p=l?l.source:void 0,E=this.layout?this.layout.source:void 0,x=p!==E,w=this.getStack(),T=!w||w.members.length<=1,I=!!(x&&!T&&this.options.crossfade===!0&&!this.path.some(qie));this.animationProgress=0;let P;this.mixTargetDelta=N=>{const D=N/1e3;rL(f.x,a.x,D),rL(f.y,a.y,D),this.setTargetDelta(f),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Im(g,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Xie(this.relativeTarget,this.relativeTargetOrigin,g,D),P&&Nie(this.relativeTarget,P)&&(this.isProjectionDirty=!1),P||(P=Sr()),ha(P,this.relativeTarget)),x&&(this.animationValues=h,bie(h,u,this.latestValues,D,I,T)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=D},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(hu(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=qn.update(()=>{z_.hasAnimatedSinceResize=!0,this.currentAnimation=Eie(0,eL,{...a,onUpdate:o=>{this.mixTargetDelta(o),a.onUpdate&&a.onUpdate(o)},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(eL),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:o,target:l,layout:u,latestValues:h}=a;if(!(!o||!l||!u)){if(this!==a&&this.layout&&u&&gj(this.options.animationType,this.layout.layoutBox,u.layoutBox)){l=this.target||Sr();const f=ea(this.layout.layoutBox.x);l.x.min=a.target.x.min,l.x.max=l.x.min+f;const g=ea(this.layout.layoutBox.y);l.y.min=a.target.y.min,l.y.max=l.y.min+g}ha(o,l),kf(o,h),Tm(this.projectionDeltaWithTransform,this.layoutCorrected,o,h)}}registerSharedNode(a,o){this.sharedNodes.has(a)||this.sharedNodes.set(a,new Lie),this.sharedNodes.get(a).add(o);const u=o.options.initialPromotionConfig;o.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(o):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var a;const{layoutId:o}=this.options;return o?((a=this.getStack())===null||a===void 0?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:o}=this.options;return o?(a=this.getStack())===null||a===void 0?void 0:a.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:o,preserveFollowOpacity:l}={}){const u=this.getStack();u&&u.promote(this,l),a&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetSkewAndRotation(){const{visualElement:a}=this.options;if(!a)return;let o=!1;const{latestValues:l}=a;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(o=!0),!o)return;const u={};l.z&&TS("z",a,u,this.animationValues);for(let h=0;h<SS.length;h++)TS(`rotate${SS[h]}`,a,u,this.animationValues),TS(`skew${SS[h]}`,a,u,this.animationValues);a.render();for(const h in u)a.setStaticValue(h,u[h]),this.animationValues&&(this.animationValues[h]=u[h]);a.scheduleRender()}getProjectionStyles(a){var o,l;if(!this.instance||this.isSVG)return;if(!this.isVisible)return Die;const u={visibility:""},h=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,u.opacity="",u.pointerEvents=B_(a?.pointerEvents)||"",u.transform=h?h(this.latestValues,""):"none",u;const f=this.getLead();if(!this.projectionDelta||!this.layout||!f.target){const x={};return this.options.layoutId&&(x.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,x.pointerEvents=B_(a?.pointerEvents)||""),this.hasProjected&&!ih(this.latestValues)&&(x.transform=h?h({},""):"none",this.hasProjected=!1),x}const g=f.animationValues||f.latestValues;this.applyTransformsToTarget(),u.transform=Oie(this.projectionDeltaWithTransform,this.treeScale,g),h&&(u.transform=h(g,u.transform));const{x:p,y:E}=this.projectionDelta;u.transformOrigin=`${p.origin*100}% ${E.origin*100}% 0`,f.animationValues?u.opacity=f===this?(l=(o=g.opacity)!==null&&o!==void 0?o:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:g.opacityExit:u.opacity=f===this?g.opacity!==void 0?g.opacity:"":g.opacityExit!==void 0?g.opacityExit:0;for(const x in Hx){if(g[x]===void 0)continue;const{correct:w,applyTo:T}=Hx[x],I=u.transform==="none"?g[x]:w(g[x],f);if(T){const P=T.length;for(let N=0;N<P;N++)u[T[N]]=I}else u[x]=I}return this.options.layoutId&&(u.pointerEvents=f===this?B_(a?.pointerEvents)||"":"none"),u}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var o;return(o=a.currentAnimation)===null||o===void 0?void 0:o.stop()}),this.root.nodes.forEach(tL),this.root.sharedNodes.clear()}}}function jie(n){n.updateLayout()}function Vie(n){var e;const t=((e=n.resumeFrom)===null||e===void 0?void 0:e.snapshot)||n.snapshot;if(n.isLead()&&n.layout&&t&&n.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:i}=n.layout,{animationType:s}=n.options,a=t.source!==n.layout.source;s==="size"?fa(f=>{const g=a?t.measuredBox[f]:t.layoutBox[f],p=ea(g);g.min=r[f].min,g.max=g.min+p}):gj(s,t.layoutBox,r)&&fa(f=>{const g=a?t.measuredBox[f]:t.layoutBox[f],p=ea(r[f]);g.max=g.min+p,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[f].max=n.relativeTarget[f].min+p)});const o=Cf();Tm(o,r,t.layoutBox);const l=Cf();a?Tm(l,n.applyTransform(i,!0),t.measuredBox):Tm(l,r,t.layoutBox);const u=!uj(o);let h=!1;if(!n.resumeFrom){const f=n.getClosestProjectingParent();if(f&&!f.resumeFrom){const{snapshot:g,layout:p}=f;if(g&&p){const E=Sr();Im(E,t.layoutBox,g.layoutBox);const x=Sr();Im(x,r,p.layoutBox),hj(E,x)||(h=!0),f.options.layoutRoot&&(n.relativeTarget=x,n.relativeTargetOrigin=E,n.relativeParent=f)}}}n.notifyListeners("didUpdate",{layout:r,snapshot:t,delta:l,layoutDelta:o,hasLayoutChanged:u,hasRelativeTargetChanged:h})}else if(n.isLead()){const{onExitComplete:r}=n.options;r&&r()}n.options.transition=void 0}function Gie(n){sm&&sh.totalNodes++,n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function Bie(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function Uie(n){n.clearSnapshot()}function tL(n){n.clearMeasurements()}function zie(n){n.isLayoutDirty=!1}function $ie(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function nL(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function Wie(n){n.resolveTargetDelta()}function Hie(n){n.calcProjection()}function Kie(n){n.resetSkewAndRotation()}function Yie(n){n.removeLeadSnapshot()}function rL(n,e,t){n.translate=cr(e.translate,0,t),n.scale=cr(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function iL(n,e,t,r){n.min=cr(e.min,t.min,r),n.max=cr(e.max,t.max,r)}function Xie(n,e,t,r){iL(n.x,e.x,t.x,r),iL(n.y,e.y,t.y,r)}function qie(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const Zie={duration:.45,ease:[.4,0,.1,1]},sL=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),aL=sL("applewebkit/")&&!sL("chrome/")?Math.round:Xs;function oL(n){n.min=aL(n.min),n.max=aL(n.max)}function Qie(n){oL(n.x),oL(n.y)}function gj(n,e,t){return n==="position"||n==="preserve-aspect"&&!tie(QN(e),QN(t),.2)}function Jie(n){var e;return n!==n.root&&((e=n.scroll)===null||e===void 0?void 0:e.wasRoot)}const ese=fj({attachResizeListener:(n,e)=>Ep(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),IS={current:void 0},mj=fj({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!IS.current){const n=new ese({});n.mount(window),n.setOptions({layoutScroll:!0}),IS.current=n}return IS.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),tse={pan:{Feature:yie},drag:{Feature:pie,ProjectionNode:mj,MeasureLayout:oj}};function lL(n,e,t){const{props:r}=n;n.animationState&&r.whileHover&&n.animationState.setActive("whileHover",t==="Start");const i="onHover"+t,s=r[i];s&&qn.postRender(()=>s(e,x1(e)))}class nse extends Tu{mount(){const{current:e}=this.node;e&&(this.unmount=tne(e,t=>(lL(this.node,t,"Start"),r=>lL(this.node,r,"End"))))}unmount(){}}class rse extends Tu{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=_1(Ep(this.node.current,"focus",()=>this.onFocus()),Ep(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function cL(n,e,t){const{props:r}=n;n.animationState&&r.whileTap&&n.animationState.setActive("whileTap",t==="Start");const i="onTap"+(t==="End"?"":t),s=r[i];s&&qn.postRender(()=>s(e,x1(e)))}class ise extends Tu{mount(){const{current:e}=this.node;e&&(this.unmount=sne(e,t=>(cL(this.node,t,"Start"),(r,{success:i})=>cL(this.node,r,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const mI=new WeakMap,AS=new WeakMap,sse=n=>{const e=mI.get(n.target);e&&e(n)},ase=n=>{n.forEach(sse)};function ose({root:n,...e}){const t=n||document;AS.has(t)||AS.set(t,{});const r=AS.get(t),i=JSON.stringify(e);return r[i]||(r[i]=new IntersectionObserver(ase,{root:n,...e})),r[i]}function lse(n,e,t){const r=ose(e);return mI.set(n,t),r.observe(n),()=>{mI.delete(n),r.unobserve(n)}}const cse={some:0,all:1};class use extends Tu{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:r,amount:i="some",once:s}=e,a={root:t?t.current:void 0,rootMargin:r,threshold:typeof i=="number"?i:cse[i]},o=l=>{const{isIntersecting:u}=l;if(this.isInView===u||(this.isInView=u,s&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:h,onViewportLeave:f}=this.node.getProps(),g=u?h:f;g&&g(l)};return lse(this.node.current,a,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(hse(e,t))&&this.startObserver()}unmount(){}}function hse({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const dse={inView:{Feature:use},tap:{Feature:ise},focus:{Feature:rse},hover:{Feature:nse}},fse={layout:{ProjectionNode:mj,MeasureLayout:oj}},pI={current:null},pj={current:!1};function gse(){if(pj.current=!0,!!Db)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>pI.current=n.matches;n.addListener(e),e()}else pI.current=!1}const mse=[...B9,Ni,du],pse=n=>mse.find(G9(n)),uL=new WeakMap;function yse(n,e,t){for(const r in e){const i=e[r],s=t[r];if(Vi(i))n.addValue(r,i);else if(Vi(s))n.addValue(r,xp(i,{owner:n}));else if(s!==i)if(n.hasValue(r)){const a=n.getValue(r);a.liveStyle===!0?a.jump(i):a.hasAnimated||a.set(i)}else{const a=n.getStaticValue(r);n.addValue(r,xp(a!==void 0?a:i,{owner:n}))}}for(const r in t)e[r]===void 0&&n.removeValue(r);return e}const hL=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class _se{scrapeMotionValuesFromProps(e,t,r){return{}}constructor({parent:e,props:t,presenceContext:r,reducedMotionConfig:i,blockInitialAnimation:s,visualState:a},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=cR,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const p=Vo.now();this.renderScheduledAt<p&&(this.renderScheduledAt=p,qn.render(this.render,!1,!0))};const{latestValues:l,renderState:u,onUpdate:h}=a;this.onUpdate=h,this.latestValues=l,this.baseTarget={...l},this.initialValues=t.initial?{...l}:{},this.renderState=u,this.parent=e,this.props=t,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=o,this.blockInitialAnimation=!!s,this.isControllingVariants=CE(t),this.isVariantNode=X8(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:f,...g}=this.scrapeMotionValuesFromProps(t,{},this);for(const p in g){const E=g[p];l[p]!==void 0&&Vi(E)&&E.set(l[p],!1)}}mount(e){this.current=e,uL.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,r)=>this.bindToMotionValue(r,t)),pj.current||gse(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:pI.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){uL.delete(this.current),this.projection&&this.projection.unmount(),hu(this.notifyUpdate),hu(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const r=hd.has(e),i=t.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&qn.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0)}),s=t.on("renderRequest",this.scheduleRender);let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{i(),s(),a&&a(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in T0){const t=T0[e];if(!t)continue;const{isEnabled:r,Feature:i}=t;if(!this.features[e]&&i&&r(this.props)&&(this.features[e]=new i(this)),this.features[e]){const s=this.features[e];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Sr()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let r=0;r<hL.length;r++){const i=hL[r];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const s="on"+i,a=e[s];a&&(this.propEventSubscriptions[i]=this.on(i,a))}this.prevMotionValues=yse(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const r=this.values.get(e);t!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&t!==void 0&&(r=xp(t===null?void 0:t,{owner:this}),this.addValue(e,r)),r}readValue(e,t){var r;let i=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(r=this.getBaseTargetFromProps(this.props,e))!==null&&r!==void 0?r:this.readValueFromInstance(this.current,e,this.options);return i!=null&&(typeof i=="string"&&(j9(i)||C9(i))?i=parseFloat(i):!pse(i)&&du.test(t)&&(i=O9(e,t)),this.setBaseTarget(e,Vi(i)?i.get():i)),Vi(i)?i.get():i}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;const{initial:r}=this.props;let i;if(typeof r=="string"||typeof r=="object"){const a=zb(this.props,r,(t=this.presenceContext)===null||t===void 0?void 0:t.custom);a&&(i=a[e])}if(r&&i!==void 0)return i;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!Vi(s)?s:this.initialValues[e]!==void 0&&i===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new rR),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}}class yj extends _se{constructor(){super(...arguments),this.KeyframeResolver=U9}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:r}){delete t[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Vi(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function xse(n){return window.getComputedStyle(n)}class vse extends yj{constructor(){super(...arguments),this.type="html",this.renderInstance=i9}readValueFromInstance(e,t){if(hd.has(t)){const r=lR(t);return r&&r.default||0}else{const r=xse(e),i=(t9(t)?r.getPropertyValue(t):r[t])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:t}){return sj(e,t)}build(e,t,r){Hb(e,t,r.transformTemplate)}scrapeMotionValuesFromProps(e,t,r){return qb(e,t,r)}}class Ese extends yj{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Sr}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(hd.has(t)){const r=lR(t);return r&&r.default||0}return t=s9.has(t)?t:Gb(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,r){return l9(e,t,r)}build(e,t,r){Kb(e,t,this.isSVGTag,r.transformTemplate)}renderInstance(e,t,r,i){a9(e,t,r,i)}mount(e){this.isSVGTag=Xb(e.tagName),super.mount(e)}}const wse=(n,e)=>Ub(n)?new Ese(e):new vse(e,{allowProjection:n!==se.Fragment}),Sse=Yte({...Hre,...dse,...tse,...fse},wse),Kt=cte(Sse);const Tse=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Ise=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),dL=n=>{const e=Ise(n);return e.charAt(0).toUpperCase()+e.slice(1)},_j=(...n)=>n.filter((e,t,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===t).join(" ").trim(),Ase=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var bse={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Rse=se.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:i="",children:s,iconNode:a,...o},l)=>se.createElement("svg",{ref:l,...bse,width:e,height:e,stroke:n,strokeWidth:r?Number(t)*24/Number(e):t,className:_j("lucide",i),...!s&&!Ase(o)&&{"aria-hidden":"true"},...o},[...a.map(([u,h])=>se.createElement(u,h)),...Array.isArray(s)?s:[s]]));const It=(n,e)=>{const t=se.forwardRef(({className:r,...i},s)=>se.createElement(Rse,{ref:s,iconNode:e,className:_j(`lucide-${Tse(dL(n))}`,`lucide-${n}`,r),...i}));return t.displayName=dL(n),t};const Cse=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h2",key:"tvwodi"}],["path",{d:"M20 8v11a2 2 0 0 1-2 2h-2",key:"1gkqxj"}],["path",{d:"m9 15 3-3 3 3",key:"1pd0qc"}],["path",{d:"M12 12v9",key:"192myk"}]],Pse=It("archive-restore",Cse);const kse=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],xj=It("archive",kse);const Mse=[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Nse=It("ban",Mse);const Lse=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],Ose=It("book-open",Lse);const Dse=[["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M14 7a4 4 0 0 1 4 4v3a6 6 0 0 1-12 0v-3a4 4 0 0 1 4-4z",key:"uouzyp"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M21 21a4 4 0 0 0-3.81-4",key:"1b0z45"}],["path",{d:"M21 5a4 4 0 0 1-3.55 3.97",key:"5cxbf6"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M3 21a4 4 0 0 1 3.81-4",key:"1fjd4g"}],["path",{d:"M3 5a4 4 0 0 0 3.55 3.97",key:"1d7oge"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M9 7.13V6a3 3 0 1 1 6 0v1.13",key:"1vgav8"}]],vj=It("bug",Dse);const Fse=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],jse=It("calendar",Fse);const Vse=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],Ej=It("chart-column",Vse);const Gse=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],v1=It("check",Gse);const Bse=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],fR=It("chevron-down",Bse);const Use=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],zse=It("chevron-left",Use);const $se=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],ME=It("chevron-right",$se);const Wse=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],wj=It("chevron-up",Wse);const Hse=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Sj=It("circle-alert",Hse);const Kse=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Yse=It("circle-check-big",Kse);const Xse=[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5.782 5.782A7 7 0 0 0 9 19h8.5a4.5 4.5 0 0 0 1.307-.193",key:"yfwify"}],["path",{d:"M21.532 16.5A4.5 4.5 0 0 0 17.5 10h-1.79A7.008 7.008 0 0 0 10 5.07",key:"jlfiyv"}]],qse=It("cloud-off",Xse);const Zse=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]],fL=It("cloud",Zse);const Qse=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],Jse=It("code",Qse);const eae=[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],tae=It("compass",eae);const nae=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"22",x2:"18",y1:"12",y2:"12",key:"l9bcsi"}],["line",{x1:"6",x2:"2",y1:"12",y2:"12",key:"13hhkx"}],["line",{x1:"12",x2:"12",y1:"6",y2:"2",key:"10w3f3"}],["line",{x1:"12",x2:"12",y1:"22",y2:"18",key:"15g9kq"}]],gL=It("crosshair",nae);const rae=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],yI=It("download",rae);const iae=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],E1=It("external-link",iae);const sae=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],gR=It("eye-off",sae);const aae=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],mR=It("eye",aae);const oae=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],pR=It("file-text",oae);const lae=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],cae=It("folder-open",lae);const uae=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],hae=It("folder",uae);const dae=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],fae=It("grid-3x3",dae);const gae=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],mL=It("info",gae);const mae=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],Ko=It("layers",mae);const pae=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],yae=It("link",pae);const _ae=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],xae=It("list",_ae);const vae=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],yR=It("loader-circle",vae);const Eae=[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],wae=It("locate-fixed",Eae);const Sae=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],_I=It("lock",Sae);const Tae=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],_R=It("log-out",Tae);const Iae=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],fu=It("map-pin",Iae);const Aae=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],xR=It("map",Aae);const bae=[["path",{d:"M5 12h14",key:"1ays0h"}]],Rae=It("minus",bae);const Cae=[["path",{d:"m8 3 4 8 5-5 5 15H2L8 3z",key:"otkl63"}]],xI=It("mountain",Cae);const Pae=[["path",{d:"M12.586 12.586 19 19",key:"ea5xo7"}],["path",{d:"M3.688 3.037a.497.497 0 0 0-.651.651l6.5 15.999a.501.501 0 0 0 .947-.062l1.569-6.083a2 2 0 0 1 1.448-1.479l6.124-1.579a.5.5 0 0 0 .063-.947z",key:"277e5u"}]],kae=It("mouse-pointer",Pae);const Mae=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],vR=It("navigation",Mae);const Nae=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],pL=It("pen-line",Nae);const Lae=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Oae=It("pen",Lae);const Dae=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],vI=It("pencil",Dae);const Fae=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Go=It("plus",Fae);const jae=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],Vae=It("rotate-ccw",jae);const Gae=[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]],Bae=It("ruler",Gae);const Uae=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],zae=It("save",Uae);const $ae=[["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"m19 8 3 8a5 5 0 0 1-6 0zV7",key:"zcdpyk"}],["path",{d:"M3 7h1a17 17 0 0 0 8-2 17 17 0 0 0 8 2h1",key:"1yorad"}],["path",{d:"m5 8 3 8a5 5 0 0 1-6 0zV7",key:"eua70x"}],["path",{d:"M7 21h10",key:"1b0cd5"}]],Wae=It("scale",$ae);const Hae=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Tj=It("search",Hae);const Kae=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],EI=It("settings",Kae);const Yae=[["path",{d:"M10 5H3",key:"1qgfaw"}],["path",{d:"M12 19H3",key:"yhmn1j"}],["path",{d:"M14 3v4",key:"1sua03"}],["path",{d:"M16 17v4",key:"1q0r14"}],["path",{d:"M21 12h-9",key:"1o4lsq"}],["path",{d:"M21 19h-5",key:"1rlt1p"}],["path",{d:"M21 5h-7",key:"1oszz2"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M8 12H3",key:"a7s4jb"}]],Xae=It("sliders-horizontal",Yae);const qae=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],Zae=It("smartphone",qae);const Qae=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],Jae=It("target",Qae);const eoe=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],B0=It("trash-2",eoe);const toe=[["path",{d:"M13 8c0-2.76-2.46-5-5.5-5S2 5.24 2 8h2l1-1 1 1h4",key:"foxbe7"}],["path",{d:"M13 7.14A5.82 5.82 0 0 1 16.5 6c3.04 0 5.5 2.24 5.5 5h-3l-1-1-1 1h-3",key:"18arnh"}],["path",{d:"M5.89 9.71c-2.15 2.15-2.3 5.47-.35 7.43l4.24-4.25.7-.7.71-.71 2.12-2.12c-1.95-1.96-5.27-1.8-7.42.35",key:"ywahnh"}],["path",{d:"M11 15.5c.5 2.5-.17 4.5-1 6.5h4c2-5.5-.5-12-1-14",key:"ft0feo"}]],noe=It("tree-palm",toe);const roe=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],ioe=It("type",roe);const soe=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],ER=It("upload",soe);const aoe=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Qx=It("user",aoe);const ooe=[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]],loe=It("waves",ooe);const coe=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Aa=It("x",coe);function uoe(){const{tracking:n,startTracking:e,stopTracking:t,updatePosition:r,setWatchId:i,resetFirstFix:s}=qi(),a=se.useCallback(l=>{r(l)},[r]),o=se.useCallback(l=>{console.error("GPS error:",l),alert(`GPS fout: ${l.message}`),t()},[t]);return se.useEffect(()=>{if(!n)return;if(!navigator.geolocation){alert("Geolocation wordt niet ondersteund door deze browser"),t();return}const l=navigator.geolocation.watchPosition(a,o,{enableHighAccuracy:!0,maximumAge:1e3,timeout:15e3});return i(l),()=>{navigator.geolocation.clearWatch(l)}},[n,a,o,i,t]),{tracking:n,start:e,stop:t,toggle:()=>n?t():e()}}function hoe(){const{tracking:n,toggle:e}=uoe();return y.jsx(Kt.button,{className:`
        fixed bottom-2 right-2 z-[1000]
        w-11 h-11 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${n?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},animate:n?{scale:[1,1.02,1]}:{},transition:n?{scale:{duration:2,repeat:1/0,ease:"easeInOut"}}:{},"aria-label":n?"GPS tracking actief":"GPS tracking starten",title:n?"GPS tracking actief":"GPS tracking starten",children:y.jsx(wae,{size:22,strokeWidth:2})})}const doe="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48">
    <polygon points="24,6 38,38 24,30 10,38" fill="#4285F4" stroke="white" stroke-width="3" stroke-linejoin="round"/>
  </svg>`);function foe(){const n=As(p=>p.map),e=qi(p=>p.position),t=qi(p=>p.accuracy),r=qi(p=>p.tracking),i=qi(p=>p.smoothHeading),s=Ti(p=>p.showAccuracyCircle),a=qi(p=>p.firstFix),o=qi(p=>p.resetFirstFix),l=qi(p=>p.config.centerOnUser),u=se.useRef(null),h=se.useRef(null),f=se.useRef(null),g=se.useMemo(()=>p=>new ur({image:new Hp({src:doe,scale:.9,rotation:p,rotateWithView:!1,anchor:[.5,.5]})}),[]);return se.useEffect(()=>{if(!n||!r&&!e)return;const p=Nh([5.1214,52.0907]);return u.current=new eo({geometry:new to(p)}),u.current.setStyle(g(0)),h.current=new eo({geometry:new to(p)}),f.current=new Xp({source:new $p({features:[h.current,u.current]}),zIndex:1e3}),n.addLayer(f.current),()=>{f.current&&n&&n.removeLayer(f.current)}},[n,r,e,g]),se.useEffect(()=>{if(!n||!e||!u.current||!h.current)return;const p=Nh([e.lng,e.lat]);if(u.current.getGeometry()?.setCoordinates(p),h.current.getGeometry()?.setCoordinates(p),s&&t){const E=n.getView().getResolution()||1,x=Math.min(t/E,80);h.current.setStyle(new ur({image:new Dl({radius:x,fill:new oi({color:"rgba(66, 133, 244, 0.12)"})})}))}else h.current.setStyle(new ur({}));if(a&&r){n.getView().setCenter(p),n.getView().setZoom(17),o();return}r&&l&&!a&&n.getView().animate({center:p,duration:150})},[n,r,e,t,a,o,l,s]),se.useEffect(()=>{if(!u.current)return;const p=i!==null?i*Math.PI/180:0;u.current.setStyle(g(p))},[i,g]),null}function goe(){const n=Fi(t=>t.themesPanelOpen),e=Fi(t=>t.toggleThemesPanel);return y.jsx(Kt.button,{className:`
        fixed bottom-[60px] right-2 z-[1000]
        w-11 h-11 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${n?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":n?"Kaartlagen sluiten":"Kaartlagen openen",title:"Kaartlagen",children:y.jsx(xR,{size:22,strokeWidth:2})})}function moe(){return y.jsx(goe,{})}const o_=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899"],Mc=["Mineraal","Fossiel","Erfgoed","Monument","Overig"],qs=Ia()(j0((n,e)=>({layers:[],colorIndex:0,addLayer:(t,r=Mc)=>{const i=crypto.randomUUID(),s=o_[e().colorIndex%o_.length];return n(a=>({layers:[...a.layers,{id:i,name:t,color:s,categories:[...r],points:[],visible:!0,archived:!1,createdAt:new Date().toISOString()}],colorIndex:a.colorIndex+1})),i},removeLayer:t=>{n(r=>({layers:r.layers.filter(i=>i.id!==t)}))},updateLayer:(t,r)=>{n(i=>({layers:i.layers.map(s=>s.id===t?{...s,...r}:s)}))},toggleVisibility:t=>{n(r=>({layers:r.layers.map(i=>i.id===t?{...i,visible:!i.visible}:i)}))},toggleArchived:t=>{n(r=>({layers:r.layers.map(i=>i.id===t?{...i,archived:!i.archived,visible:i.archived?i.visible:!1}:i)}))},addPoint:(t,r)=>{const i={...r,status:r.status||"todo",id:crypto.randomUUID(),createdAt:new Date().toISOString()};n(s=>({layers:s.layers.map(a=>a.id===t?{...a,points:[...a.points,i]}:a)}))},removePoint:(t,r)=>{n(i=>({layers:i.layers.map(s=>s.id===t?{...s,points:s.points.filter(a=>a.id!==r)}:s)}))},updatePoint:(t,r,i)=>{n(s=>({layers:s.layers.map(a=>a.id===t?{...a,points:a.points.map(o=>o.id===r?{...o,...i}:o)}:a)}))},setPointStatus:(t,r,i)=>{n(s=>({layers:s.layers.map(a=>a.id===t?{...a,points:a.points.map(o=>o.id===r?{...o,status:i}:o)}:a)}))},addCategory:(t,r)=>{n(i=>({layers:i.layers.map(s=>s.id===t&&!s.categories.includes(r)?{...s,categories:[...s.categories,r]}:s)}))},removeCategory:(t,r)=>{n(i=>({layers:i.layers.map(s=>s.id===t?{...s,categories:s.categories.filter(a=>a!==r)}:s)}))},exportLayerAsGeoJSON:t=>{const r=e().layers.find(l=>l.id===t);if(!r)return;const i={type:"FeatureCollection",properties:{name:r.name,color:r.color,categories:r.categories,createdAt:r.createdAt,exportedAt:new Date().toISOString()},features:r.points.map(l=>({type:"Feature",geometry:{type:"Point",coordinates:l.coordinates},properties:{id:l.id,name:l.name,category:l.category,notes:l.notes,url:l.url,status:l.status,sourceLayer:l.sourceLayer,sourceId:l.sourceId,createdAt:l.createdAt}}))},s=new Blob([JSON.stringify(i,null,2)],{type:"application/geo+json"}),a=URL.createObjectURL(s),o=document.createElement("a");o.href=a,o.download=`${r.name.replace(/[^a-zA-Z0-9]/g,"-")}-${new Date().toISOString().split("T")[0]}.geojson`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(a)},importLayerFromGeoJSON:t=>{try{const r=JSON.parse(t);if(r.type!=="FeatureCollection")return{success:!1,error:"Ongeldig GeoJSON formaat"};const i=r.properties||{},s=i.name||`Gemporteerd ${new Date().toLocaleDateString("nl-NL")}`,a=i.categories||Mc,o=i.color||o_[e().colorIndex%o_.length],l=(r.features||[]).filter(h=>h.geometry?.type==="Point").map(h=>({id:h.properties?.id||crypto.randomUUID(),name:h.properties?.name||"Naamloos",category:h.properties?.category||"Overig",notes:h.properties?.notes||"",url:h.properties?.url,status:h.properties?.status||"todo",sourceLayer:h.properties?.sourceLayer,sourceId:h.properties?.sourceId,coordinates:h.geometry.coordinates,createdAt:h.properties?.createdAt||new Date().toISOString()})),u=crypto.randomUUID();return n(h=>({layers:[...h.layers,{id:u,name:s,color:o,categories:a,points:l,visible:!0,archived:!1,createdAt:new Date().toISOString()}],colorIndex:h.colorIndex+1})),{success:!0,layerId:u}}catch{return{success:!1,error:"Fout bij parsen van GeoJSON"}}},getLayer:t=>e().layers.find(r=>r.id===t),getActiveLayerCount:()=>e().layers.filter(t=>!t.archived).length,getArchivedLayerCount:()=>e().layers.filter(t=>t.archived).length,clearAll:()=>{n({layers:[],colorIndex:0})}}),{name:"detectorapp-custom-point-layers"}));function Jr({title:n,children:e,defaultExpanded:t=!0,layerNames:r}){const[i,s]=se.useState(t),a=ii(p=>p.visible),o=ii(p=>p.setLayerVisibility),l=r?.filter(p=>a[p]).length||0,u=r?.length||0,h=u>0&&l===u,f=l>0&&l<u,g=p=>{if(p.stopPropagation(),!r)return;const E=!h;r.forEach(x=>{o(x,E)})};return y.jsxs("div",{className:"mb-0.5",children:[y.jsxs("div",{className:"flex items-center gap-1 py-1 px-1 hover:bg-blue-50 transition-colors",children:[y.jsxs("button",{onClick:p=>{p.stopPropagation(),s(!i)},className:"flex-1 flex items-center gap-1 bg-transparent border-0 outline-none text-left",style:{fontSize:"inherit"},children:[y.jsx(Kt.span,{animate:{rotate:i?90:0},transition:{duration:.15},className:"text-gray-400",children:y.jsx(ME,{size:14})}),i?y.jsx(cae,{size:16,className:"text-blue-500"}):y.jsx(hae,{size:16,className:"text-blue-500"}),y.jsx("span",{className:"text-gray-700 font-medium",style:{fontSize:"1em"},children:n}),l>0&&y.jsx("span",{className:"ml-1 px-1.5 py-0.5 font-medium bg-blue-100 text-blue-600 rounded-full",style:{fontSize:"0.7em"},children:l})]}),r&&r.length>0&&y.jsx("button",{onClick:g,className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:h?"#3b82f6":f?"#93c5fd":"white",border:h?"2px solid #3b82f6":"2px solid #60a5fa",color:"white"},children:(h||f)&&y.jsx("svg",{width:"10",height:"10",viewBox:"0 0 10 10",children:y.jsx("path",{d:"M2 5 L4 7 L8 3",stroke:"currentColor",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),y.jsx(Yr,{initial:!1,children:i&&y.jsx(Kt.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.15},style:{overflow:"hidden"},className:"ml-5",children:e})})]})}function at({name:n,type:e}){const t=ii(w=>w.visible[n]),r=ii(w=>w.loadingState[n]),i=ii(w=>w.toggleLayer),s=ii(w=>w.setLayerVisibility),a=U8(w=>w.isLayerUnlocked),o=r==="loading",l=r==="error",u=CA[n],h=u?.tier??"free",f=u?.regions??["nl"],p=!a(n,h,f),E=w=>{w.stopPropagation(),!(o||p)&&(e==="overlay"?i(n):["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"].forEach(I=>{s(I,I===n)}))},x=t??!1;return y.jsxs("button",{onClick:E,disabled:o||p,className:`w-full flex items-center justify-between py-1 pl-3 pr-2 border-0 outline-none transition-colors text-left ${p?"opacity-50 cursor-not-allowed bg-gray-50":o?"opacity-70 cursor-wait bg-transparent":x?"bg-blue-50 hover:bg-blue-100":"bg-transparent hover:bg-blue-50"}`,style:{fontSize:"inherit"},title:p?"Premium laag - upgrade om te ontgrendelen":void 0,children:[y.jsxs("span",{className:`flex items-center gap-1 ${l?"text-red-500":p?"text-gray-400":"text-gray-600"}`,children:[n,l&&y.jsx(Sj,{size:12,className:"text-red-500"}),p&&y.jsx(_I,{size:12,className:"text-amber-500"})]}),y.jsx("div",{className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:p?"#e5e7eb":o?"#93c5fd":x?"#3b82f6":"white",border:p?"2px solid #d1d5db":o?"2px solid #93c5fd":x?"2px solid #3b82f6":"2px solid #60a5fa",color:"white"},children:p?y.jsx(_I,{size:10,strokeWidth:3,className:"text-gray-400"}):o?y.jsx(yR,{size:10,strokeWidth:3,className:"animate-spin"}):x?y.jsx(v1,{size:12,strokeWidth:3}):null})]})}function poe(){const{themesPanelOpen:n,toggleThemesPanel:e}=Fi(),{layers:t,toggleVisibility:r}=qs(),i=se.useRef(null),s=Ti(l=>l.layerPanelFontScale),a=Ti(l=>l.setLayerPanelFontScale),o=13*s/100;return se.useEffect(()=>{if(!n)return;const l=h=>{i.current&&!i.current.contains(h.target)&&e()},u=setTimeout(()=>{document.addEventListener("click",l)},100);return()=>{clearTimeout(u),document.removeEventListener("click",l)}},[n,e]),y.jsx(Yr,{children:n&&y.jsxs(Kt.div,{ref:i,className:"fixed top-2.5 right-2 z-[1101] bg-white rounded-lg shadow-lg overflow-hidden w-[300px] max-h-[calc(100vh-200px)] flex flex-col",initial:{opacity:0,x:10},animate:{opacity:1,x:0},exit:{opacity:0,x:10},transition:{duration:.15},children:[y.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-gradient-to-r from-blue-500 to-blue-600 text-white",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx(Ko,{size:14}),y.jsx("span",{className:"font-medium text-sm",children:"Kaartlagen"})]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),y.jsx("input",{type:"range",min:"80",max:"130",step:"10",value:s,onInput:l=>{a(parseInt(l.target.value))},onChange:l=>a(parseInt(l.target.value)),className:"header-slider w-20 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${s}%`}),y.jsx("span",{className:"text-xs opacity-70",children:"T"}),y.jsx("button",{onClick:e,className:"p-0.5 rounded border-0 outline-none hover:bg-white/20 transition-colors ml-1",children:y.jsx(Aa,{size:16})})]})]}),y.jsxs("div",{className:"p-2 overflow-y-auto flex-1",style:{fontSize:`${o}px`},children:[y.jsx("div",{className:"mb-2 pb-1 border-b border-gray-100",children:y.jsx(at,{name:"Mijn Vondsten",type:"overlay"})}),t.length>0&&y.jsx("div",{className:"mb-2 pb-1 border-b border-gray-100",children:t.map(l=>y.jsxs("button",{onClick:()=>r(l.id),className:`w-full flex items-center justify-between py-1 pl-3 pr-2 border-0 outline-none transition-colors text-left ${l.visible?"bg-blue-50 hover:bg-blue-100":"bg-transparent hover:bg-blue-50"}`,style:{fontSize:"inherit"},children:[y.jsxs("span",{className:"flex items-center gap-2 text-gray-600",children:[y.jsx("div",{className:"w-2.5 h-2.5 rounded-full flex-shrink-0",style:{backgroundColor:l.color}}),l.name,y.jsxs("span",{className:"text-xs text-gray-400",children:["(",l.points.length,")"]})]}),y.jsx("div",{className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:l.visible?"#3b82f6":"white",border:l.visible?"2px solid #3b82f6":"2px solid #60a5fa",color:"white"},children:l.visible&&y.jsx(v1,{size:12,strokeWidth:3})})]},l.id))}),y.jsxs(Jr,{title:"Achtergronden",defaultExpanded:!0,children:[y.jsx(at,{name:"CartoDB (licht)",type:"base"}),y.jsx(at,{name:"OpenStreetMap",type:"base"}),y.jsx(at,{name:"Luchtfoto",type:"base"}),y.jsx(at,{name:"Labels Overlay",type:"overlay"}),y.jsx(at,{name:"TMK 1850",type:"base"}),y.jsx(at,{name:"Bonnebladen 1900",type:"base"})]}),y.jsxs(Jr,{title:"Thema's",defaultExpanded:!0,children:[y.jsxs(Jr,{title:"Steentijd & Prehistorie",defaultExpanded:!1,layerNames:["Hunebedden","FAMKE Steentijd","Grafheuvels","Terpen","Paleokaart 9000 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 500 v.Chr.","Paleokaart 100 n.Chr.","Paleokaart 800 n.Chr."],children:[y.jsx(at,{name:"Hunebedden",type:"overlay"}),y.jsx(at,{name:"FAMKE Steentijd",type:"overlay"}),y.jsx(at,{name:"Grafheuvels",type:"overlay"}),y.jsx(at,{name:"Terpen",type:"overlay"}),y.jsxs(Jr,{title:"Paleokaarten (tijdreizen)",defaultExpanded:!1,layerNames:["Paleokaart 9000 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 500 v.Chr.","Paleokaart 100 n.Chr.","Paleokaart 800 n.Chr."],children:[y.jsx(at,{name:"Paleokaart 9000 v.Chr.",type:"overlay"}),y.jsx(at,{name:"Paleokaart 5500 v.Chr.",type:"overlay"}),y.jsx(at,{name:"Paleokaart 2750 v.Chr.",type:"overlay"}),y.jsx(at,{name:"Paleokaart 1500 v.Chr.",type:"overlay"}),y.jsx(at,{name:"Paleokaart 500 v.Chr.",type:"overlay"}),y.jsx(at,{name:"Paleokaart 100 n.Chr.",type:"overlay"}),y.jsx(at,{name:"Paleokaart 800 n.Chr.",type:"overlay"})]})]}),y.jsxs(Jr,{title:"Archeologische lagen",defaultExpanded:!1,layerNames:["AMK Monumenten","AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig","Romeinse wegen (regio)","Romeinse wegen (Wereld)","IKAW","Archeo Landschappen","UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling"],children:[y.jsx(at,{name:"AMK Monumenten",type:"overlay"}),y.jsxs(Jr,{title:"AMK per periode",defaultExpanded:!1,layerNames:["AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig"],children:[y.jsx(at,{name:"AMK Romeins",type:"overlay"}),y.jsx(at,{name:"AMK Steentijd",type:"overlay"}),y.jsx(at,{name:"AMK Vroege ME",type:"overlay"}),y.jsx(at,{name:"AMK Late ME",type:"overlay"}),y.jsx(at,{name:"AMK Overig",type:"overlay"})]}),y.jsx(at,{name:"Romeinse wegen (regio)",type:"overlay"}),y.jsx(at,{name:"Romeinse wegen (Wereld)",type:"overlay"}),y.jsx(at,{name:"IKAW",type:"overlay"}),y.jsx(at,{name:"Archeo Landschappen",type:"overlay"}),y.jsxs(Jr,{title:"Verwachtingen uiterwaarden",defaultExpanded:!1,layerNames:["UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling"],children:[y.jsx(at,{name:"UIKAV Punten",type:"overlay"}),y.jsx(at,{name:"UIKAV Vlakken",type:"overlay"}),y.jsx(at,{name:"UIKAV Expert",type:"overlay"}),y.jsx(at,{name:"UIKAV Buffer",type:"overlay"}),y.jsx(at,{name:"UIKAV Indeling",type:"overlay"})]})]}),y.jsxs(Jr,{title:"Erfgoed & Monumenten",defaultExpanded:!1,layerNames:["Rijksmonumenten","Werelderfgoed","Religieus Erfgoed","Kastelen","Runes"],children:[y.jsx(at,{name:"Rijksmonumenten",type:"overlay"}),y.jsx(at,{name:"Werelderfgoed",type:"overlay"}),y.jsx(at,{name:"Religieus Erfgoed",type:"overlay"}),y.jsx(at,{name:"Kastelen",type:"overlay"}),y.jsx(at,{name:"Runes",type:"overlay"})]}),y.jsxs(Jr,{title:"WOII & Militair",defaultExpanded:!1,layerNames:["WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Militaire Objecten","Inundatiegebieden"],children:[y.jsx(at,{name:"WWII Bunkers",type:"overlay"}),y.jsx(at,{name:"Slagvelden",type:"overlay"}),y.jsx(at,{name:"Militaire Vliegvelden",type:"overlay"}),y.jsx(at,{name:"Verdedigingslinies",type:"overlay"}),y.jsx(at,{name:"Militaire Objecten",type:"overlay"}),y.jsx(at,{name:"Inundatiegebieden",type:"overlay"})]}),y.jsxs(Jr,{title:"Hillshade & LiDAR",defaultExpanded:!1,layerNames:["AHN4 Hoogtekaart Kleur","AHN4 Hillshade NL","AHN4 Multi-Hillshade NL","AHN 0.5m"],children:[y.jsx(at,{name:"AHN4 Hoogtekaart Kleur",type:"overlay"}),y.jsx(at,{name:"AHN4 Hillshade NL",type:"overlay"}),y.jsx(at,{name:"AHN4 Multi-Hillshade NL",type:"overlay"}),y.jsx(at,{name:"AHN 0.5m",type:"overlay"})]}),y.jsxs(Jr,{title:"Terrein & Bodem",defaultExpanded:!1,layerNames:["Veengebieden","Geomorfologie","Bodemkaart","Essen"],children:[y.jsx(at,{name:"Veengebieden",type:"overlay"}),y.jsx(at,{name:"Geomorfologie",type:"overlay"}),y.jsx(at,{name:"Bodemkaart",type:"overlay"}),y.jsx(at,{name:"Essen",type:"overlay"})]}),y.jsxs(Jr,{title:"Percelen",defaultExpanded:!1,layerNames:["Gewaspercelen","Kadastrale Grenzen"],children:[y.jsx(at,{name:"Gewaspercelen",type:"overlay"}),y.jsx(at,{name:"Kadastrale Grenzen",type:"overlay"})]}),y.jsxs(Jr,{title:"Provinciale Thema's",defaultExpanded:!1,layerNames:["Scheepswrakken","Woonheuvels ZH","Romeinse Forten","Windmolens","Erfgoedlijnen","Oude Kernen","Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken","Verdronken Dorpen"],children:[y.jsxs(Jr,{title:"Zuid-Holland",defaultExpanded:!1,layerNames:["Scheepswrakken","Woonheuvels ZH","Romeinse Forten","Windmolens","Erfgoedlijnen","Oude Kernen"],children:[y.jsx(at,{name:"Scheepswrakken",type:"overlay"}),y.jsx(at,{name:"Woonheuvels ZH",type:"overlay"}),y.jsx(at,{name:"Romeinse Forten",type:"overlay"}),y.jsx(at,{name:"Windmolens",type:"overlay"}),y.jsx(at,{name:"Erfgoedlijnen",type:"overlay"}),y.jsx(at,{name:"Oude Kernen",type:"overlay"})]}),y.jsxs(Jr,{title:"Gelderland",defaultExpanded:!1,layerNames:["Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken"],children:[y.jsx(at,{name:"Relictenkaart Punten",type:"overlay"}),y.jsx(at,{name:"Relictenkaart Lijnen",type:"overlay"}),y.jsx(at,{name:"Relictenkaart Vlakken",type:"overlay"})]}),y.jsx(Jr,{title:"Zeeland",defaultExpanded:!1,layerNames:["Verdronken Dorpen"],children:y.jsx(at,{name:"Verdronken Dorpen",type:"overlay"})})]}),y.jsxs(Jr,{title:"Fossielen, Mineralen & Goud",defaultExpanded:!1,layerNames:["Fossiel Hotspots","Mineralen Hotspots","Goudrivieren","Fossielen Nederland","Fossielen Belgi","Fossielen Duitsland","Fossielen Frankrijk"],children:[y.jsx(at,{name:"Fossiel Hotspots",type:"overlay"}),y.jsx(at,{name:"Mineralen Hotspots",type:"overlay"}),y.jsx(at,{name:"Goudrivieren",type:"overlay"}),y.jsx(at,{name:"Fossielen Nederland",type:"overlay"}),y.jsx(at,{name:"Fossielen Belgi",type:"overlay"}),y.jsx(at,{name:"Fossielen Duitsland",type:"overlay"}),y.jsx(at,{name:"Fossielen Frankrijk",type:"overlay"})]}),y.jsxs(Jr,{title:"Recreatie",defaultExpanded:!1,layerNames:["Wandelroutes","Parken","Speeltuinen","Musea","Strandjes","Kringloopwinkels"],children:[y.jsx(at,{name:"Wandelroutes",type:"overlay"}),y.jsx(at,{name:"Parken",type:"overlay"}),y.jsx(at,{name:"Speeltuinen",type:"overlay"}),y.jsx(at,{name:"Musea",type:"overlay"}),y.jsx(at,{name:"Strandjes",type:"overlay"}),y.jsx(at,{name:"Kringloopwinkels",type:"overlay"})]})]})]})]})})}function yoe(n){n("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),n("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),n("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs");for(var e=1;e<=60;++e)n("EPSG:"+(32600+e),"+proj=utm +zone="+e+" +datum=WGS84 +units=m"),n("EPSG:"+(32700+e),"+proj=utm +zone="+e+" +south +datum=WGS84 +units=m");n("EPSG:5041","+title=WGS 84 / UPS North (E,N) +proj=stere +lat_0=90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m"),n("EPSG:5042","+title=WGS 84 / UPS South (E,N) +proj=stere +lat_0=-90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m"),n.WGS84=n["EPSG:4326"],n["EPSG:3785"]=n["EPSG:3857"],n.GOOGLE=n["EPSG:3857"],n["EPSG:900913"]=n["EPSG:3857"],n["EPSG:102113"]=n["EPSG:3857"]}var qh=1,Zh=2,Kf=3,_oe=4,wI=5,yL=6378137,xoe=6356752314e-3,_L=.0066943799901413165,Am=484813681109536e-20,Ue=Math.PI/2,voe=.16666666666666666,Eoe=.04722222222222222,woe=.022156084656084655,it=1e-10,gr=.017453292519943295,Es=57.29577951308232,bn=Math.PI/4,wp=Math.PI*2,Tr=3.14159265359,bs={};bs.greenwich=0;bs.lisbon=-9.131906111111;bs.paris=2.337229166667;bs.bogota=-74.080916666667;bs.madrid=-3.687938888889;bs.rome=12.452333333333;bs.bern=7.439583333333;bs.jakarta=106.807719444444;bs.ferro=-17.666666666667;bs.brussels=4.367975;bs.stockholm=18.058277777778;bs.athens=23.7163375;bs.oslo=10.722916666667;const Soe={mm:{to_meter:.001},cm:{to_meter:.01},ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937},fath:{to_meter:1.8288},kmi:{to_meter:1852},"us-ch":{to_meter:20.1168402336805},"us-mi":{to_meter:1609.34721869444},km:{to_meter:1e3},"ind-ft":{to_meter:.30479841},"ind-yd":{to_meter:.91439523},mi:{to_meter:1609.344},yd:{to_meter:.9144},ch:{to_meter:20.1168},link:{to_meter:.201168},dm:{to_meter:.1},in:{to_meter:.0254},"ind-ch":{to_meter:20.11669506},"us-in":{to_meter:.025400050800101},"us-yd":{to_meter:.914401828803658}};var xL=/[\s_\-\/\(\)]/g;function gu(n,e){if(n[e])return n[e];for(var t=Object.keys(n),r=e.toLowerCase().replace(xL,""),i=-1,s,a;++i<t.length;)if(s=t[i],a=s.toLowerCase().replace(xL,""),a===r)return n[s]}function SI(n){var e={},t=n.split("+").map(function(o){return o.trim()}).filter(function(o){return o}).reduce(function(o,l){var u=l.split("=");return u.push(!0),o[u[0].toLowerCase()]=u[1],o},{}),r,i,s,a={proj:"projName",datum:"datumCode",rf:function(o){e.rf=parseFloat(o)},lat_0:function(o){e.lat0=o*gr},lat_1:function(o){e.lat1=o*gr},lat_2:function(o){e.lat2=o*gr},lat_ts:function(o){e.lat_ts=o*gr},lon_0:function(o){e.long0=o*gr},lon_1:function(o){e.long1=o*gr},lon_2:function(o){e.long2=o*gr},alpha:function(o){e.alpha=parseFloat(o)*gr},gamma:function(o){e.rectified_grid_angle=parseFloat(o)*gr},lonc:function(o){e.longc=o*gr},x_0:function(o){e.x0=parseFloat(o)},y_0:function(o){e.y0=parseFloat(o)},k_0:function(o){e.k0=parseFloat(o)},k:function(o){e.k0=parseFloat(o)},a:function(o){e.a=parseFloat(o)},b:function(o){e.b=parseFloat(o)},r:function(o){e.a=e.b=parseFloat(o)},r_a:function(){e.R_A=!0},zone:function(o){e.zone=parseInt(o,10)},south:function(){e.utmSouth=!0},towgs84:function(o){e.datum_params=o.split(",").map(function(l){return parseFloat(l)})},to_meter:function(o){e.to_meter=parseFloat(o)},units:function(o){e.units=o;var l=gu(Soe,o);l&&(e.to_meter=l.to_meter)},from_greenwich:function(o){e.from_greenwich=o*gr},pm:function(o){var l=gu(bs,o);e.from_greenwich=(l||parseFloat(o))*gr},nadgrids:function(o){o==="@null"?e.datumCode="none":e.nadgrids=o},axis:function(o){var l="ewnsud";o.length===3&&l.indexOf(o.substr(0,1))!==-1&&l.indexOf(o.substr(1,1))!==-1&&l.indexOf(o.substr(2,1))!==-1&&(e.axis=o)},approx:function(){e.approx=!0},over:function(){e.over=!0}};for(r in t)i=t[r],r in a?(s=a[r],typeof s=="function"?s(i):e[s]=i):e[r]=i;return typeof e.datumCode=="string"&&e.datumCode!=="WGS84"&&(e.datumCode=e.datumCode.toLowerCase()),e.projStr=n,e}class Ij{static getId(e){const t=e.find(r=>Array.isArray(r)&&r[0]==="ID");return t&&t.length>=3?{authority:t[1],code:parseInt(t[2],10)}:null}static convertUnit(e,t="unit"){if(!e||e.length<3)return{type:t,name:"unknown",conversion_factor:null};const r=e[1],i=parseFloat(e[2])||null,s=e.find(o=>Array.isArray(o)&&o[0]==="ID"),a=s?{authority:s[1],code:parseInt(s[2],10)}:null;return{type:t,name:r,conversion_factor:i,id:a}}static convertAxis(e){const t=e[1]||"Unknown";let r;const i=t.match(/^\((.)\)$/);if(i){const u=i[1].toUpperCase();if(u==="E")r="east";else if(u==="N")r="north";else if(u==="U")r="up";else throw new Error(`Unknown axis abbreviation: ${u}`)}else r=e[2]?e[2].toLowerCase():"unknown";const s=e.find(u=>Array.isArray(u)&&u[0]==="ORDER"),a=s?parseInt(s[1],10):null,o=e.find(u=>Array.isArray(u)&&(u[0]==="LENGTHUNIT"||u[0]==="ANGLEUNIT"||u[0]==="SCALEUNIT")),l=this.convertUnit(o);return{name:t,direction:r,unit:l,order:a}}static extractAxes(e){return e.filter(t=>Array.isArray(t)&&t[0]==="AXIS").map(t=>this.convertAxis(t)).sort((t,r)=>(t.order||0)-(r.order||0))}static convert(e,t={}){switch(e[0]){case"PROJCRS":t.type="ProjectedCRS",t.name=e[1],t.base_crs=e.find(g=>Array.isArray(g)&&g[0]==="BASEGEOGCRS")?this.convert(e.find(g=>Array.isArray(g)&&g[0]==="BASEGEOGCRS")):null,t.conversion=e.find(g=>Array.isArray(g)&&g[0]==="CONVERSION")?this.convert(e.find(g=>Array.isArray(g)&&g[0]==="CONVERSION")):null;const r=e.find(g=>Array.isArray(g)&&g[0]==="CS");r&&(t.coordinate_system={type:r[1],axis:this.extractAxes(e)});const i=e.find(g=>Array.isArray(g)&&g[0]==="LENGTHUNIT");if(i){const g=this.convertUnit(i);t.coordinate_system.unit=g}t.id=this.getId(e);break;case"BASEGEOGCRS":case"GEOGCRS":t.type="GeographicCRS",t.name=e[1];const s=e.find(g=>Array.isArray(g)&&(g[0]==="DATUM"||g[0]==="ENSEMBLE"));if(s){const g=this.convert(s);s[0]==="ENSEMBLE"?t.datum_ensemble=g:t.datum=g;const p=e.find(E=>Array.isArray(E)&&E[0]==="PRIMEM");p&&p[1]!=="Greenwich"&&(g.prime_meridian={name:p[1],longitude:parseFloat(p[2])})}t.coordinate_system={type:"ellipsoidal",axis:this.extractAxes(e)},t.id=this.getId(e);break;case"DATUM":t.type="GeodeticReferenceFrame",t.name=e[1],t.ellipsoid=e.find(g=>Array.isArray(g)&&g[0]==="ELLIPSOID")?this.convert(e.find(g=>Array.isArray(g)&&g[0]==="ELLIPSOID")):null;break;case"ENSEMBLE":t.type="DatumEnsemble",t.name=e[1],t.members=e.filter(g=>Array.isArray(g)&&g[0]==="MEMBER").map(g=>({type:"DatumEnsembleMember",name:g[1],id:this.getId(g)}));const a=e.find(g=>Array.isArray(g)&&g[0]==="ENSEMBLEACCURACY");a&&(t.accuracy=parseFloat(a[1]));const o=e.find(g=>Array.isArray(g)&&g[0]==="ELLIPSOID");o&&(t.ellipsoid=this.convert(o)),t.id=this.getId(e);break;case"ELLIPSOID":t.type="Ellipsoid",t.name=e[1],t.semi_major_axis=parseFloat(e[2]),t.inverse_flattening=parseFloat(e[3]),e.find(g=>Array.isArray(g)&&g[0]==="LENGTHUNIT")&&this.convert(e.find(g=>Array.isArray(g)&&g[0]==="LENGTHUNIT"),t);break;case"CONVERSION":t.type="Conversion",t.name=e[1],t.method=e.find(g=>Array.isArray(g)&&g[0]==="METHOD")?this.convert(e.find(g=>Array.isArray(g)&&g[0]==="METHOD")):null,t.parameters=e.filter(g=>Array.isArray(g)&&g[0]==="PARAMETER").map(g=>this.convert(g));break;case"METHOD":t.type="Method",t.name=e[1],t.id=this.getId(e);break;case"PARAMETER":t.type="Parameter",t.name=e[1],t.value=parseFloat(e[2]),t.unit=this.convertUnit(e.find(g=>Array.isArray(g)&&(g[0]==="LENGTHUNIT"||g[0]==="ANGLEUNIT"||g[0]==="SCALEUNIT"))),t.id=this.getId(e);break;case"BOUNDCRS":t.type="BoundCRS";const l=e.find(g=>Array.isArray(g)&&g[0]==="SOURCECRS");if(l){const g=l.find(p=>Array.isArray(p));t.source_crs=g?this.convert(g):null}const u=e.find(g=>Array.isArray(g)&&g[0]==="TARGETCRS");if(u){const g=u.find(p=>Array.isArray(p));t.target_crs=g?this.convert(g):null}const h=e.find(g=>Array.isArray(g)&&g[0]==="ABRIDGEDTRANSFORMATION");h?t.transformation=this.convert(h):t.transformation=null;break;case"ABRIDGEDTRANSFORMATION":if(t.type="Transformation",t.name=e[1],t.method=e.find(g=>Array.isArray(g)&&g[0]==="METHOD")?this.convert(e.find(g=>Array.isArray(g)&&g[0]==="METHOD")):null,t.parameters=e.filter(g=>Array.isArray(g)&&(g[0]==="PARAMETER"||g[0]==="PARAMETERFILE")).map(g=>{if(g[0]==="PARAMETER")return this.convert(g);if(g[0]==="PARAMETERFILE")return{name:g[1],value:g[2],id:{authority:"EPSG",code:8656}}}),t.parameters.length===7){const g=t.parameters[6];g.name==="Scale difference"&&(g.value=Math.round((g.value-1)*1e12)/1e6)}t.id=this.getId(e);break;case"AXIS":t.coordinate_system||(t.coordinate_system={type:"unspecified",axis:[]}),t.coordinate_system.axis.push(this.convertAxis(e));break;case"LENGTHUNIT":const f=this.convertUnit(e,"LinearUnit");t.coordinate_system&&t.coordinate_system.axis&&t.coordinate_system.axis.forEach(g=>{g.unit||(g.unit=f)}),f.conversion_factor&&f.conversion_factor!==1&&t.semi_major_axis&&(t.semi_major_axis={value:t.semi_major_axis,unit:f});break;default:t.keyword=e[0];break}return t}}class Toe extends Ij{static convert(e,t={}){return super.convert(e,t),t.coordinate_system&&t.coordinate_system.subtype==="Cartesian"&&delete t.coordinate_system,t.usage&&delete t.usage,t}}class Ioe extends Ij{static convert(e,t={}){super.convert(e,t);const r=e.find(s=>Array.isArray(s)&&s[0]==="CS");r&&(t.coordinate_system={subtype:r[1],axis:this.extractAxes(e)});const i=e.find(s=>Array.isArray(s)&&s[0]==="USAGE");if(i){const s=i.find(l=>Array.isArray(l)&&l[0]==="SCOPE"),a=i.find(l=>Array.isArray(l)&&l[0]==="AREA"),o=i.find(l=>Array.isArray(l)&&l[0]==="BBOX");t.usage={},s&&(t.usage.scope=s[1]),a&&(t.usage.area=a[1]),o&&(t.usage.bbox=o.slice(1))}return t}}function Aoe(n){return n.find(e=>Array.isArray(e)&&e[0]==="USAGE")?"2019":(n.find(e=>Array.isArray(e)&&e[0]==="CS")||n[0]==="BOUNDCRS"||n[0]==="PROJCRS"||n[0]==="GEOGCRS","2015")}function boe(n){return(Aoe(n)==="2019"?Ioe:Toe).convert(n)}function Roe(n){const e=n.toUpperCase();return e.includes("PROJCRS")||e.includes("GEOGCRS")||e.includes("BOUNDCRS")||e.includes("VERTCRS")||e.includes("LENGTHUNIT")||e.includes("ANGLEUNIT")||e.includes("SCALEUNIT")?"WKT2":(e.includes("PROJCS")||e.includes("GEOGCS")||e.includes("LOCAL_CS")||e.includes("VERT_CS")||e.includes("UNIT"),"WKT1")}var Sp=1,Aj=2,bj=3,Jx=4,Rj=5,wR=-1,Coe=/\s/,Poe=/[A-Za-z]/,koe=/[A-Za-z84_]/,NE=/[,\]]/,Cj=/[\d\.E\-\+]/;function Kl(n){if(typeof n!="string")throw new Error("not a string");this.text=n.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=Sp}Kl.prototype.readCharicter=function(){var n=this.text[this.place++];if(this.state!==Jx)for(;Coe.test(n);){if(this.place>=this.text.length)return;n=this.text[this.place++]}switch(this.state){case Sp:return this.neutral(n);case Aj:return this.keyword(n);case Jx:return this.quoted(n);case Rj:return this.afterquote(n);case bj:return this.number(n);case wR:return}};Kl.prototype.afterquote=function(n){if(n==='"'){this.word+='"',this.state=Jx;return}if(NE.test(n)){this.word=this.word.trim(),this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in afterquote yet, index '+this.place)};Kl.prototype.afterItem=function(n){if(n===","){this.word!==null&&this.currentObject.push(this.word),this.word=null,this.state=Sp;return}if(n==="]"){this.level--,this.word!==null&&(this.currentObject.push(this.word),this.word=null),this.state=Sp,this.currentObject=this.stack.pop(),this.currentObject||(this.state=wR);return}};Kl.prototype.number=function(n){if(Cj.test(n)){this.word+=n;return}if(NE.test(n)){this.word=parseFloat(this.word),this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in number yet, index '+this.place)};Kl.prototype.quoted=function(n){if(n==='"'){this.state=Rj;return}this.word+=n};Kl.prototype.keyword=function(n){if(koe.test(n)){this.word+=n;return}if(n==="["){var e=[];e.push(this.word),this.level++,this.root===null?this.root=e:this.currentObject.push(e),this.stack.push(this.currentObject),this.currentObject=e,this.state=Sp;return}if(NE.test(n)){this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in keyword yet, index '+this.place)};Kl.prototype.neutral=function(n){if(Poe.test(n)){this.word=n,this.state=Aj;return}if(n==='"'){this.word="",this.state=Jx;return}if(Cj.test(n)){this.word=n,this.state=bj;return}if(NE.test(n)){this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in neutral yet, index '+this.place)};Kl.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===wR)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function Moe(n){var e=new Kl(n);return e.output()}function bS(n,e,t){Array.isArray(e)&&(t.unshift(e),e=null);var r=e?{}:n,i=t.reduce(function(s,a){return Mf(a,s),s},r);e&&(n[e]=i)}function Mf(n,e){if(!Array.isArray(n)){e[n]=!0;return}var t=n.shift();if(t==="PARAMETER"&&(t=n.shift()),n.length===1){if(Array.isArray(n[0])){e[t]={},Mf(n[0],e[t]);return}e[t]=n[0];return}if(!n.length){e[t]=!0;return}if(t==="TOWGS84"){e[t]=n;return}if(t==="AXIS"){t in e||(e[t]=[]),e[t].push(n);return}Array.isArray(t)||(e[t]={});var r;switch(t){case"UNIT":case"PRIMEM":case"VERT_DATUM":e[t]={name:n[0].toLowerCase(),convert:n[1]},n.length===3&&Mf(n[2],e[t]);return;case"SPHEROID":case"ELLIPSOID":e[t]={name:n[0],a:n[1],rf:n[2]},n.length===4&&Mf(n[3],e[t]);return;case"EDATUM":case"ENGINEERINGDATUM":case"LOCAL_DATUM":case"DATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":n[0]=["name",n[0]],bS(e,t,n);return;case"COMPD_CS":case"COMPOUNDCRS":case"FITTED_CS":case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"ENGCRS":case"ENGINEERINGCRS":n[0]=["name",n[0]],bS(e,t,n),e[t].type=t;return;default:for(r=-1;++r<n.length;)if(!Array.isArray(n[r]))return Mf(n,e[t]);return bS(e,t,n)}}var Noe=.017453292519943295;function Ga(n){return n*Noe}function Pj(n){const e=(n.projName||"").toLowerCase().replace(/_/g," ");!n.long0&&n.longc&&(e==="albers conic equal area"||e==="lambert azimuthal equal area")&&(n.long0=n.longc),!n.lat_ts&&n.lat1&&(e==="stereographic south pole"||e==="polar stereographic (variant b)")?(n.lat0=Ga(n.lat1>0?90:-90),n.lat_ts=n.lat1,delete n.lat1):!n.lat_ts&&n.lat0&&(e==="polar stereographic"||e==="polar stereographic (variant a)")&&(n.lat_ts=n.lat0,n.lat0=Ga(n.lat0>0?90:-90),delete n.lat1)}function vL(n){let e={units:null,to_meter:void 0};return typeof n=="string"?(e.units=n.toLowerCase(),e.units==="metre"&&(e.units="meter"),e.units==="meter"&&(e.to_meter=1)):n&&n.name&&(e.units=n.name.toLowerCase(),e.units==="metre"&&(e.units="meter"),e.to_meter=n.conversion_factor),e}function EL(n){return typeof n=="object"?n.value*n.unit.conversion_factor:n}function wL(n,e){n.ellipsoid.radius?(e.a=n.ellipsoid.radius,e.rf=0):(e.a=EL(n.ellipsoid.semi_major_axis),n.ellipsoid.inverse_flattening!==void 0?e.rf=n.ellipsoid.inverse_flattening:n.ellipsoid.semi_major_axis!==void 0&&n.ellipsoid.semi_minor_axis!==void 0&&(e.rf=e.a/(e.a-EL(n.ellipsoid.semi_minor_axis))))}function ev(n,e={}){return!n||typeof n!="object"?n:n.type==="BoundCRS"?(ev(n.source_crs,e),n.transformation&&(n.transformation.method&&n.transformation.method.name==="NTv2"?e.nadgrids=n.transformation.parameters[0].value:e.datum_params=n.transformation.parameters.map(t=>t.value)),e):(Object.keys(n).forEach(t=>{const r=n[t];if(r!==null)switch(t){case"name":if(e.srsCode)break;e.name=r,e.srsCode=r;break;case"type":r==="GeographicCRS"?e.projName="longlat":r==="ProjectedCRS"&&n.conversion&&n.conversion.method&&(e.projName=n.conversion.method.name);break;case"datum":case"datum_ensemble":r.ellipsoid&&(e.ellps=r.ellipsoid.name,wL(r,e)),r.prime_meridian&&(e.from_greenwich=r.prime_meridian.longitude*Math.PI/180);break;case"ellipsoid":e.ellps=r.name,wL(r,e);break;case"prime_meridian":e.long0=(r.longitude||0)*Math.PI/180;break;case"coordinate_system":if(r.axis){if(e.axis=r.axis.map(i=>{const s=i.direction;if(s==="east")return"e";if(s==="north")return"n";if(s==="west")return"w";if(s==="south")return"s";throw new Error(`Unknown axis direction: ${s}`)}).join("")+"u",r.unit){const{units:i,to_meter:s}=vL(r.unit);e.units=i,e.to_meter=s}else if(r.axis[0]&&r.axis[0].unit){const{units:i,to_meter:s}=vL(r.axis[0].unit);e.units=i,e.to_meter=s}}break;case"id":r.authority&&r.code&&(e.title=r.authority+":"+r.code);break;case"conversion":r.method&&r.method.name&&(e.projName=r.method.name),r.parameters&&r.parameters.forEach(i=>{const s=i.name.toLowerCase().replace(/\s+/g,"_"),a=i.value;i.unit&&i.unit.conversion_factor?e[s]=a*i.unit.conversion_factor:i.unit==="degree"?e[s]=a*Math.PI/180:e[s]=a});break;case"unit":r.name&&(e.units=r.name.toLowerCase(),e.units==="metre"&&(e.units="meter")),r.conversion_factor&&(e.to_meter=r.conversion_factor);break;case"base_crs":ev(r,e),e.datumCode=r.id?r.id.authority+"_"+r.id.code:r.name;break}}),e.latitude_of_false_origin!==void 0&&(e.lat0=e.latitude_of_false_origin),e.longitude_of_false_origin!==void 0&&(e.long0=e.longitude_of_false_origin),e.latitude_of_standard_parallel!==void 0&&(e.lat0=e.latitude_of_standard_parallel,e.lat1=e.latitude_of_standard_parallel),e.latitude_of_1st_standard_parallel!==void 0&&(e.lat1=e.latitude_of_1st_standard_parallel),e.latitude_of_2nd_standard_parallel!==void 0&&(e.lat2=e.latitude_of_2nd_standard_parallel),e.latitude_of_projection_centre!==void 0&&(e.lat0=e.latitude_of_projection_centre),e.longitude_of_projection_centre!==void 0&&(e.longc=e.longitude_of_projection_centre),e.easting_at_false_origin!==void 0&&(e.x0=e.easting_at_false_origin),e.northing_at_false_origin!==void 0&&(e.y0=e.northing_at_false_origin),e.latitude_of_natural_origin!==void 0&&(e.lat0=e.latitude_of_natural_origin),e.longitude_of_natural_origin!==void 0&&(e.long0=e.longitude_of_natural_origin),e.longitude_of_origin!==void 0&&(e.long0=e.longitude_of_origin),e.false_easting!==void 0&&(e.x0=e.false_easting),e.easting_at_projection_centre&&(e.x0=e.easting_at_projection_centre),e.false_northing!==void 0&&(e.y0=e.false_northing),e.northing_at_projection_centre&&(e.y0=e.northing_at_projection_centre),e.standard_parallel_1!==void 0&&(e.lat1=e.standard_parallel_1),e.standard_parallel_2!==void 0&&(e.lat2=e.standard_parallel_2),e.scale_factor_at_natural_origin!==void 0&&(e.k0=e.scale_factor_at_natural_origin),e.scale_factor_at_projection_centre!==void 0&&(e.k0=e.scale_factor_at_projection_centre),e.scale_factor_on_pseudo_standard_parallel!==void 0&&(e.k0=e.scale_factor_on_pseudo_standard_parallel),e.azimuth!==void 0&&(e.alpha=e.azimuth),e.azimuth_at_projection_centre!==void 0&&(e.alpha=e.azimuth_at_projection_centre),e.angle_from_rectified_to_skew_grid&&(e.rectified_grid_angle=e.angle_from_rectified_to_skew_grid),Pj(e),e)}var Loe=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function Ooe(n,e){var t=e[0],r=e[1];!(t in n)&&r in n&&(n[t]=n[r],e.length===3&&(n[t]=e[2](n[t])))}function kj(n){for(var e=Object.keys(n),t=0,r=e.length;t<r;++t){var i=e[t];Loe.indexOf(i)!==-1&&Doe(n[i]),typeof n[i]=="object"&&kj(n[i])}}function Doe(n){if(n.AUTHORITY){var e=Object.keys(n.AUTHORITY)[0];e&&e in n.AUTHORITY&&(n.title=e+":"+n.AUTHORITY[e])}if(n.type==="GEOGCS"?n.projName="longlat":n.type==="LOCAL_CS"?(n.projName="identity",n.local=!0):typeof n.PROJECTION=="object"?n.projName=Object.keys(n.PROJECTION)[0]:n.projName=n.PROJECTION,n.AXIS){for(var t="",r=0,i=n.AXIS.length;r<i;++r){var s=[n.AXIS[r][0].toLowerCase(),n.AXIS[r][1].toLowerCase()];s[0].indexOf("north")!==-1||(s[0]==="y"||s[0]==="lat")&&s[1]==="north"?t+="n":s[0].indexOf("south")!==-1||(s[0]==="y"||s[0]==="lat")&&s[1]==="south"?t+="s":s[0].indexOf("east")!==-1||(s[0]==="x"||s[0]==="lon")&&s[1]==="east"?t+="e":(s[0].indexOf("west")!==-1||(s[0]==="x"||s[0]==="lon")&&s[1]==="west")&&(t+="w")}t.length===2&&(t+="u"),t.length===3&&(n.axis=t)}n.UNIT&&(n.units=n.UNIT.name.toLowerCase(),n.units==="metre"&&(n.units="meter"),n.UNIT.convert&&(n.type==="GEOGCS"?n.DATUM&&n.DATUM.SPHEROID&&(n.to_meter=n.UNIT.convert*n.DATUM.SPHEROID.a):n.to_meter=n.UNIT.convert));var a=n.GEOGCS;n.type==="GEOGCS"&&(a=n),a&&(a.DATUM?n.datumCode=a.DATUM.name.toLowerCase():n.datumCode=a.name.toLowerCase(),n.datumCode.slice(0,2)==="d_"&&(n.datumCode=n.datumCode.slice(2)),n.datumCode==="new_zealand_1949"&&(n.datumCode="nzgd49"),(n.datumCode==="wgs_1984"||n.datumCode==="world_geodetic_system_1984")&&(n.PROJECTION==="Mercator_Auxiliary_Sphere"&&(n.sphere=!0),n.datumCode="wgs84"),n.datumCode==="belge_1972"&&(n.datumCode="rnb72"),a.DATUM&&a.DATUM.SPHEROID&&(n.ellps=a.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),n.ellps.toLowerCase().slice(0,13)==="international"&&(n.ellps="intl"),n.a=a.DATUM.SPHEROID.a,n.rf=parseFloat(a.DATUM.SPHEROID.rf,10)),a.DATUM&&a.DATUM.TOWGS84&&(n.datum_params=a.DATUM.TOWGS84),~n.datumCode.indexOf("osgb_1936")&&(n.datumCode="osgb36"),~n.datumCode.indexOf("osni_1952")&&(n.datumCode="osni52"),(~n.datumCode.indexOf("tm65")||~n.datumCode.indexOf("geodetic_datum_of_1965"))&&(n.datumCode="ire65"),n.datumCode==="ch1903+"&&(n.datumCode="ch1903"),~n.datumCode.indexOf("israel")&&(n.datumCode="isr93")),n.b&&!isFinite(n.b)&&(n.b=n.a),n.rectified_grid_angle&&(n.rectified_grid_angle=Ga(n.rectified_grid_angle));function o(h){var f=n.to_meter||1;return h*f}var l=function(h){return Ooe(n,h)},u=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",Ga],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",Ga],["x0","false_easting",o],["y0","false_northing",o],["long0","central_meridian",Ga],["lat0","latitude_of_origin",Ga],["lat0","standard_parallel_1",Ga],["lat1","standard_parallel_1",Ga],["lat2","standard_parallel_2",Ga],["azimuth","Azimuth"],["alpha","azimuth",Ga],["srsCode","name"]];u.forEach(l),Pj(n)}function tv(n){if(typeof n=="object")return ev(n);const e=Roe(n);var t=Moe(n);if(e==="WKT2"){const s=boe(t);return ev(s)}var r=t[0],i={};return Mf(t,i),kj(i),i[r]}function mi(n){var e=this;if(arguments.length===2){var t=arguments[1];typeof t=="string"?t.charAt(0)==="+"?mi[n]=SI(arguments[1]):mi[n]=tv(arguments[1]):t&&typeof t=="object"&&!("projName"in t)?mi[n]=tv(arguments[1]):(mi[n]=t,t||delete mi[n])}else if(arguments.length===1){if(Array.isArray(n))return n.map(function(r){return Array.isArray(r)?mi.apply(e,r):mi(r)});if(typeof n=="string"){if(n in mi)return mi[n]}else"EPSG"in n?mi["EPSG:"+n.EPSG]=n:"ESRI"in n?mi["ESRI:"+n.ESRI]=n:"IAU2000"in n?mi["IAU2000:"+n.IAU2000]=n:console.log(n);return}}yoe(mi);function Foe(n){return typeof n=="string"}function joe(n){return n in mi}function Voe(n){return n.indexOf("+")!==0&&n.indexOf("[")!==-1||typeof n=="object"&&!("srsCode"in n)}var Goe=["3857","900913","3785","102113"];function Boe(n){var e=gu(n,"authority");if(e){var t=gu(e,"epsg");return t&&Goe.indexOf(t)>-1}}function Uoe(n){var e=gu(n,"extension");if(e)return gu(e,"proj4")}function zoe(n){return n[0]==="+"}function $oe(n){if(Foe(n)){if(joe(n))return mi[n];if(Voe(n)){var e=tv(n);if(Boe(e))return mi["EPSG:3857"];var t=Uoe(e);return t?SI(t):e}if(zoe(n))return SI(n)}else return"projName"in n?n:tv(n)}function SL(n,e){n=n||{};var t,r;if(!e)return n;for(r in e)t=e[r],t!==void 0&&(n[r]=t);return n}function Yo(n,e,t){var r=n*e;return t/Math.sqrt(1-r*r)}function w1(n){return n<0?-1:1}function ct(n,e){return e||Math.abs(n)<=Tr?n:n-w1(n)*wp}function Qa(n,e,t){var r=n*t,i=.5*n;return r=Math.pow((1-r)/(1+r),i),Math.tan(.5*(Ue-e))/r}function Tp(n,e){for(var t=.5*n,r,i,s=Ue-2*Math.atan(e),a=0;a<=15;a++)if(r=n*Math.sin(s),i=Ue-2*Math.atan(e*Math.pow((1-r)/(1+r),t))-s,s+=i,Math.abs(i)<=1e-10)return s;return-9999}function Woe(){var n=this.b/this.a;this.es=1-n*n,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=Yo(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function Hoe(n){var e=n.x,t=n.y;if(t*Es>90&&t*Es<-90&&e*Es>180&&e*Es<-180)return null;var r,i;if(Math.abs(Math.abs(t)-Ue)<=it)return null;if(this.sphere)r=this.x0+this.a*this.k0*ct(e-this.long0,this.over),i=this.y0+this.a*this.k0*Math.log(Math.tan(bn+.5*t));else{var s=Math.sin(t),a=Qa(this.e,t,s);r=this.x0+this.a*this.k0*ct(e-this.long0,this.over),i=this.y0-this.a*this.k0*Math.log(a)}return n.x=r,n.y=i,n}function Koe(n){var e=n.x-this.x0,t=n.y-this.y0,r,i;if(this.sphere)i=Ue-2*Math.atan(Math.exp(-t/(this.a*this.k0)));else{var s=Math.exp(-t/(this.a*this.k0));if(i=Tp(this.e,s),i===-9999)return null}return r=ct(this.long0+e/(this.a*this.k0),this.over),n.x=r,n.y=i,n}var Yoe=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","Mercator_Variant_A","merc"];const Xoe={init:Woe,forward:Hoe,inverse:Koe,names:Yoe};function qoe(){}function TL(n){return n}var Mj=["longlat","identity"];const Zoe={init:qoe,forward:TL,inverse:TL,names:Mj};var Qoe=[Xoe,Zoe],ah={},Nf=[];function Nj(n,e){var t=Nf.length;return n.names?(Nf[t]=n,n.names.forEach(function(r){ah[r.toLowerCase()]=t}),this):(console.log(e),!0)}function Lj(n){return n.replace(/[-\(\)\s]+/g," ").trim().replace(/ /g,"_")}function Joe(n){if(!n)return!1;var e=n.toLowerCase();if(typeof ah[e]<"u"&&Nf[ah[e]]||(e=Lj(e),e in ah&&Nf[ah[e]]))return Nf[ah[e]]}function ele(){Qoe.forEach(Nj)}const tle={start:ele,add:Nj,get:Joe};var Oj={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563396e-3,b:635625691e-2,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340189e-3,b:6356034446e-3,ellipseName:"Modified Airy"},andrae:{a:637710443e-2,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397155e-3,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483865e-3,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:63782064e-1,b:63565838e-1,ellipseName:"Clarke 1866"},clrk80:{a:6378249145e-3,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk80ign:{a:63782492e-1,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"},clrk58:{a:6378293645208759e-9,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:63757387e-1,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:637813605e-2,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276345e-3,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304063e-3,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301243e-3,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295664e-3,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298556e-3,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:63781575e-1,b:63567722e-1,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:63567733205e-4,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:63558348467e-4,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"},WGS84:{a:6378137,rf:298.257223563,ellipseName:"WGS 84"},sphere:{a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}};const nle=Oj.WGS84;function rle(n,e,t,r){var i=n*n,s=e*e,a=(i-s)/i,o=0;r?(n*=1-a*(voe+a*(Eoe+a*woe)),i=n*n,a=0):o=Math.sqrt(a);var l=(i-s)/s;return{es:a,e:o,ep2:l}}function ile(n,e,t,r,i){if(!n){var s=gu(Oj,r);s||(s=nle),n=s.a,e=s.b,t=s.rf}return t&&!e&&(e=(1-1/t)*n),(t===0||Math.abs(n-e)<it)&&(i=!0,e=n),{a:n,b:e,rf:t,sphere:i}}var $_={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},mgi:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Ordnance Survey of Great Britain 1936"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"},EPSG_5451:{towgs84:"6.41,-49.05,-11.28,1.5657,0.5242,6.9718,-5.7649"},IGNF_LURESG:{towgs84:"-192.986,13.673,-39.309,-0.4099,-2.9332,2.6881,0.43"},EPSG_4614:{towgs84:"-119.4248,-303.65872,-11.00061,1.164298,0.174458,1.096259,3.657065"},EPSG_4615:{towgs84:"-494.088,-312.129,279.877,-1.423,-1.013,1.59,-0.748"},ESRI_37241:{towgs84:"-76.822,257.457,-12.817,2.136,-0.033,-2.392,-0.031"},ESRI_37249:{towgs84:"-440.296,58.548,296.265,1.128,10.202,4.559,-0.438"},ESRI_37245:{towgs84:"-511.151,-181.269,139.609,1.05,2.703,1.798,3.071"},EPSG_4178:{towgs84:"24.9,-126.4,-93.2,-0.063,-0.247,-0.041,1.01"},EPSG_4622:{towgs84:"-472.29,-5.63,-304.12,0.4362,-0.8374,0.2563,1.8984"},EPSG_4625:{towgs84:"126.93,547.94,130.41,-2.7867,5.1612,-0.8584,13.8227"},EPSG_5252:{towgs84:"0.023,0.036,-0.068,0.00176,0.00912,-0.01136,0.00439"},EPSG_4314:{towgs84:"597.1,71.4,412.1,0.894,0.068,-1.563,7.58"},EPSG_4282:{towgs84:"-178.3,-316.7,-131.5,5.278,6.077,10.979,19.166"},EPSG_4231:{towgs84:"-83.11,-97.38,-117.22,0.0276,-0.2167,0.2147,0.1218"},EPSG_4274:{towgs84:"-230.994,102.591,25.199,0.633,-0.239,0.9,1.95"},EPSG_4134:{towgs84:"-180.624,-225.516,173.919,-0.81,-1.898,8.336,16.71006"},EPSG_4254:{towgs84:"18.38,192.45,96.82,0.056,-0.142,-0.2,-0.0013"},EPSG_4159:{towgs84:"-194.513,-63.978,-25.759,-3.4027,3.756,-3.352,-0.9175"},EPSG_4687:{towgs84:"0.072,-0.507,-0.245,0.0183,-0.0003,0.007,-0.0093"},EPSG_4227:{towgs84:"-83.58,-397.54,458.78,-17.595,-2.847,4.256,3.225"},EPSG_4746:{towgs84:"599.4,72.4,419.2,-0.062,-0.022,-2.723,6.46"},EPSG_4745:{towgs84:"612.4,77,440.2,-0.054,0.057,-2.797,2.55"},EPSG_6311:{towgs84:"8.846,-4.394,-1.122,-0.00237,-0.146528,0.130428,0.783926"},EPSG_4289:{towgs84:"565.7381,50.4018,465.2904,-1.91514,1.60363,-9.09546,4.07244"},EPSG_4230:{towgs84:"-68.863,-134.888,-111.49,-0.53,-0.14,0.57,-3.4"},EPSG_4154:{towgs84:"-123.02,-158.95,-168.47"},EPSG_4156:{towgs84:"570.8,85.7,462.8,4.998,1.587,5.261,3.56"},EPSG_4299:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4179:{towgs84:"33.4,-146.6,-76.3,-0.359,-0.053,0.844,-0.84"},EPSG_4313:{towgs84:"-106.8686,52.2978,-103.7239,0.3366,-0.457,1.8422,-1.2747"},EPSG_4194:{towgs84:"163.511,127.533,-159.789"},EPSG_4195:{towgs84:"105,326,-102.5"},EPSG_4196:{towgs84:"-45,417,-3.5"},EPSG_4611:{towgs84:"-162.619,-276.959,-161.764,0.067753,-2.243649,-1.158827,-1.094246"},EPSG_4633:{towgs84:"137.092,131.66,91.475,-1.9436,-11.5993,-4.3321,-7.4824"},EPSG_4641:{towgs84:"-408.809,366.856,-412.987,1.8842,-0.5308,2.1655,-121.0993"},EPSG_4643:{towgs84:"-480.26,-438.32,-643.429,16.3119,20.1721,-4.0349,-111.7002"},EPSG_4300:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4188:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4660:{towgs84:"982.6087,552.753,-540.873,32.39344,-153.25684,-96.2266,16.805"},EPSG_4662:{towgs84:"97.295,-263.247,310.882,-1.5999,0.8386,3.1409,13.3259"},EPSG_3906:{towgs84:"577.88891,165.22205,391.18289,4.9145,-0.94729,-13.05098,7.78664"},EPSG_4307:{towgs84:"-209.3622,-87.8162,404.6198,0.0046,3.4784,0.5805,-1.4547"},EPSG_6892:{towgs84:"-76.269,-16.683,68.562,-6.275,10.536,-4.286,-13.686"},EPSG_4690:{towgs84:"221.597,152.441,176.523,2.403,1.3893,0.884,11.4648"},EPSG_4691:{towgs84:"218.769,150.75,176.75,3.5231,2.0037,1.288,10.9817"},EPSG_4629:{towgs84:"72.51,345.411,79.241,-1.5862,-0.8826,-0.5495,1.3653"},EPSG_4630:{towgs84:"165.804,216.213,180.26,-0.6251,-0.4515,-0.0721,7.4111"},EPSG_4692:{towgs84:"217.109,86.452,23.711,0.0183,-0.0003,0.007,-0.0093"},EPSG_9333:{towgs84:"0,0,0,-8.393,0.749,-10.276,0"},EPSG_9059:{towgs84:"0,0,0"},EPSG_4312:{towgs84:"601.705,84.263,485.227,4.7354,1.3145,5.393,-2.3887"},EPSG_4123:{towgs84:"-96.062,-82.428,-121.753,4.801,0.345,-1.376,1.496"},EPSG_4309:{towgs84:"-124.45,183.74,44.64,-0.4384,0.5446,-0.9706,-2.1365"},ESRI_104106:{towgs84:"-283.088,-70.693,117.445,-1.157,0.059,-0.652,-4.058"},EPSG_4281:{towgs84:"-219.247,-73.802,269.529"},EPSG_4322:{towgs84:"0,0,4.5"},EPSG_4324:{towgs84:"0,0,1.9"},EPSG_4284:{towgs84:"43.822,-108.842,-119.585,1.455,-0.761,0.737,0.549"},EPSG_4277:{towgs84:"446.448,-125.157,542.06,0.15,0.247,0.842,-20.489"},EPSG_4207:{towgs84:"-282.1,-72.2,120,-1.529,0.145,-0.89,-4.46"},EPSG_4688:{towgs84:"347.175,1077.618,2623.677,33.9058,-70.6776,9.4013,186.0647"},EPSG_4689:{towgs84:"410.793,54.542,80.501,-2.5596,-2.3517,-0.6594,17.3218"},EPSG_4720:{towgs84:"0,0,4.5"},EPSG_4273:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},EPSG_4240:{towgs84:"204.64,834.74,293.8"},EPSG_4817:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},ESRI_104131:{towgs84:"426.62,142.62,460.09,4.98,4.49,-12.42,-17.1"},EPSG_4265:{towgs84:"-104.1,-49.1,-9.9,0.971,-2.917,0.714,-11.68"},EPSG_4263:{towgs84:"-111.92,-87.85,114.5,1.875,0.202,0.219,0.032"},EPSG_4298:{towgs84:"-689.5937,623.84046,-65.93566,-0.02331,1.17094,-0.80054,5.88536"},EPSG_4270:{towgs84:"-253.4392,-148.452,386.5267,0.15605,0.43,-0.1013,-0.0424"},EPSG_4229:{towgs84:"-121.8,98.1,-10.7"},EPSG_4220:{towgs84:"-55.5,-348,-229.2"},EPSG_4214:{towgs84:"12.646,-155.176,-80.863"},EPSG_4232:{towgs84:"-345,3,223"},EPSG_4238:{towgs84:"-1.977,-13.06,-9.993,0.364,0.254,0.689,-1.037"},EPSG_4168:{towgs84:"-170,33,326"},EPSG_4131:{towgs84:"199,931,318.9"},EPSG_4152:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_5228:{towgs84:"572.213,85.334,461.94,4.9732,1.529,5.2484,3.5378"},EPSG_8351:{towgs84:"485.021,169.465,483.839,7.786342,4.397554,4.102655,0"},EPSG_4683:{towgs84:"-127.62,-67.24,-47.04,-3.068,4.903,1.578,-1.06"},EPSG_4133:{towgs84:"0,0,0"},EPSG_7373:{towgs84:"0.819,-0.5762,-1.6446,-0.00378,-0.03317,0.00318,0.0693"},EPSG_9075:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9072:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9294:{towgs84:"1.16835,-1.42001,-2.24431,-0.00822,-0.05508,0.01818,0.23388"},EPSG_4212:{towgs84:"-267.434,173.496,181.814,-13.4704,8.7154,7.3926,14.7492"},EPSG_4191:{towgs84:"-44.183,-0.58,-38.489,2.3867,2.7072,-3.5196,-8.2703"},EPSG_4237:{towgs84:"52.684,-71.194,-13.975,-0.312,-0.1063,-0.3729,1.0191"},EPSG_4740:{towgs84:"-1.08,-0.27,-0.9"},EPSG_4124:{towgs84:"419.3836,99.3335,591.3451,0.850389,1.817277,-7.862238,-0.99496"},EPSG_5681:{towgs84:"584.9636,107.7175,413.8067,1.1155,0.2824,-3.1384,7.9922"},EPSG_4141:{towgs84:"23.772,17.49,17.859,-0.3132,-1.85274,1.67299,-5.4262"},EPSG_4204:{towgs84:"-85.645,-273.077,-79.708,2.289,-1.421,2.532,3.194"},EPSG_4319:{towgs84:"226.702,-193.337,-35.371,-2.229,-4.391,9.238,0.9798"},EPSG_4200:{towgs84:"24.82,-131.21,-82.66"},EPSG_4130:{towgs84:"0,0,0"},EPSG_4127:{towgs84:"-82.875,-57.097,-156.768,-2.158,1.524,-0.982,-0.359"},EPSG_4149:{towgs84:"674.374,15.056,405.346"},EPSG_4617:{towgs84:"-0.991,1.9072,0.5129,1.25033e-7,4.6785e-8,5.6529e-8,0"},EPSG_4663:{towgs84:"-210.502,-66.902,-48.476,2.094,-15.067,-5.817,0.485"},EPSG_4664:{towgs84:"-211.939,137.626,58.3,-0.089,0.251,0.079,0.384"},EPSG_4665:{towgs84:"-105.854,165.589,-38.312,-0.003,-0.026,0.024,-0.048"},EPSG_4666:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},EPSG_4756:{towgs84:"-192.873,-39.382,-111.202,-0.00205,-0.0005,0.00335,0.0188"},EPSG_4723:{towgs84:"-179.483,-69.379,-27.584,-7.862,8.163,6.042,-13.925"},EPSG_4726:{towgs84:"8.853,-52.644,180.304,-0.393,-2.323,2.96,-24.081"},EPSG_4267:{towgs84:"-8.0,160.0,176.0"},EPSG_5365:{towgs84:"-0.16959,0.35312,0.51846,0.03385,-0.16325,0.03446,0.03693"},EPSG_4218:{towgs84:"304.5,306.5,-318.1"},EPSG_4242:{towgs84:"-33.722,153.789,94.959,-8.581,-4.478,4.54,8.95"},EPSG_4216:{towgs84:"-292.295,248.758,429.447,4.9971,2.99,6.6906,1.0289"},ESRI_104105:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},ESRI_104129:{towgs84:"0,0,0"},EPSG_4673:{towgs84:"174.05,-25.49,112.57"},EPSG_4202:{towgs84:"-124,-60,154"},EPSG_4203:{towgs84:"-117.763,-51.51,139.061,0.292,0.443,0.277,-0.191"},EPSG_3819:{towgs84:"595.48,121.69,515.35,4.115,-2.9383,0.853,-3.408"},EPSG_8694:{towgs84:"-93.799,-132.737,-219.073,-1.844,0.648,-6.37,-0.169"},EPSG_4145:{towgs84:"275.57,676.78,229.6"},EPSG_4283:{towgs84:"61.55,-10.87,-40.19,39.4924,32.7221,32.8979,-9.994"},EPSG_4317:{towgs84:"2.3287,-147.0425,-92.0802,-0.3092483,0.32482185,0.49729934,5.68906266"},EPSG_4272:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993"},EPSG_4248:{towgs84:"-307.7,265.3,-363.5"},EPSG_5561:{towgs84:"24,-121,-76"},EPSG_5233:{towgs84:"-0.293,766.95,87.713,0.195704,1.695068,3.473016,-0.039338"},ESRI_104130:{towgs84:"-86,-98,-119"},ESRI_104102:{towgs84:"682,-203,480"},ESRI_37207:{towgs84:"7,-10,-26"},EPSG_4675:{towgs84:"59.935,118.4,-10.871"},ESRI_104109:{towgs84:"-89.121,-348.182,260.871"},ESRI_104112:{towgs84:"-185.583,-230.096,281.361"},ESRI_104113:{towgs84:"25.1,-275.6,222.6"},IGNF_WGS72G:{towgs84:"0,12,6"},IGNF_NTFG:{towgs84:"-168,-60,320"},IGNF_EFATE57G:{towgs84:"-127,-769,472"},IGNF_PGP50G:{towgs84:"324.8,153.6,172.1"},IGNF_REUN47G:{towgs84:"94,-948,-1262"},IGNF_CSG67G:{towgs84:"-186,230,110"},IGNF_GUAD48G:{towgs84:"-467,-16,-300"},IGNF_TAHI51G:{towgs84:"162,117,154"},IGNF_TAHAAG:{towgs84:"65,342,77"},IGNF_NUKU72G:{towgs84:"84,274,65"},IGNF_PETRELS72G:{towgs84:"365,194,166"},IGNF_WALL78G:{towgs84:"253,-133,-127"},IGNF_MAYO50G:{towgs84:"-382,-59,-262"},IGNF_TANNAG:{towgs84:"-139,-967,436"},IGNF_IGN72G:{towgs84:"-13,-348,292"},IGNF_ATIGG:{towgs84:"1118,23,66"},IGNF_FANGA84G:{towgs84:"150.57,158.33,118.32"},IGNF_RUSAT84G:{towgs84:"202.13,174.6,-15.74"},IGNF_KAUE70G:{towgs84:"126.74,300.1,-75.49"},IGNF_MOP90G:{towgs84:"-10.8,-1.8,12.77"},IGNF_MHPF67G:{towgs84:"338.08,212.58,-296.17"},IGNF_TAHI79G:{towgs84:"160.61,116.05,153.69"},IGNF_ANAA92G:{towgs84:"1.5,3.84,4.81"},IGNF_MARQUI72G:{towgs84:"330.91,-13.92,58.56"},IGNF_APAT86G:{towgs84:"143.6,197.82,74.05"},IGNF_TUBU69G:{towgs84:"237.17,171.61,-77.84"},IGNF_STPM50G:{towgs84:"11.363,424.148,373.13"},EPSG_4150:{towgs84:"674.374,15.056,405.346"},EPSG_4754:{towgs84:"-208.4058,-109.8777,-2.5764"},ESRI_104101:{towgs84:"374,150,588"},EPSG_4693:{towgs84:"0,-0.15,0.68"},EPSG_6207:{towgs84:"293.17,726.18,245.36"},EPSG_4153:{towgs84:"-133.63,-157.5,-158.62"},EPSG_4132:{towgs84:"-241.54,-163.64,396.06"},EPSG_4221:{towgs84:"-154.5,150.7,100.4"},EPSG_4266:{towgs84:"-80.7,-132.5,41.1"},EPSG_4193:{towgs84:"-70.9,-151.8,-41.4"},EPSG_5340:{towgs84:"-0.41,0.46,-0.35"},EPSG_4246:{towgs84:"-294.7,-200.1,525.5"},EPSG_4318:{towgs84:"-3.2,-5.7,2.8"},EPSG_4121:{towgs84:"-199.87,74.79,246.62"},EPSG_4223:{towgs84:"-260.1,5.5,432.2"},EPSG_4158:{towgs84:"-0.465,372.095,171.736"},EPSG_4285:{towgs84:"-128.16,-282.42,21.93"},EPSG_4613:{towgs84:"-404.78,685.68,45.47"},EPSG_4607:{towgs84:"195.671,332.517,274.607"},EPSG_4475:{towgs84:"-381.788,-57.501,-256.673"},EPSG_4208:{towgs84:"-157.84,308.54,-146.6"},EPSG_4743:{towgs84:"70.995,-335.916,262.898"},EPSG_4710:{towgs84:"-323.65,551.39,-491.22"},EPSG_7881:{towgs84:"-0.077,0.079,0.086"},EPSG_4682:{towgs84:"283.729,735.942,261.143"},EPSG_4739:{towgs84:"-156,-271,-189"},EPSG_4679:{towgs84:"-80.01,253.26,291.19"},EPSG_4750:{towgs84:"-56.263,16.136,-22.856"},EPSG_4644:{towgs84:"-10.18,-350.43,291.37"},EPSG_4695:{towgs84:"-103.746,-9.614,-255.95"},EPSG_4292:{towgs84:"-355,21,72"},EPSG_4302:{towgs84:"-61.702,284.488,472.052"},EPSG_4143:{towgs84:"-124.76,53,466.79"},EPSG_4606:{towgs84:"-153,153,307"},EPSG_4699:{towgs84:"-770.1,158.4,-498.2"},EPSG_4247:{towgs84:"-273.5,110.6,-357.9"},EPSG_4160:{towgs84:"8.88,184.86,106.69"},EPSG_4161:{towgs84:"-233.43,6.65,173.64"},EPSG_9251:{towgs84:"-9.5,122.9,138.2"},EPSG_9253:{towgs84:"-78.1,101.6,133.3"},EPSG_4297:{towgs84:"-198.383,-240.517,-107.909"},EPSG_4269:{towgs84:"0,0,0"},EPSG_4301:{towgs84:"-147,506,687"},EPSG_4618:{towgs84:"-59,-11,-52"},EPSG_4612:{towgs84:"0,0,0"},EPSG_4678:{towgs84:"44.585,-131.212,-39.544"},EPSG_4250:{towgs84:"-130,29,364"},EPSG_4144:{towgs84:"214,804,268"},EPSG_4147:{towgs84:"-17.51,-108.32,-62.39"},EPSG_4259:{towgs84:"-254.1,-5.36,-100.29"},EPSG_4164:{towgs84:"-76,-138,67"},EPSG_4211:{towgs84:"-378.873,676.002,-46.255"},EPSG_4182:{towgs84:"-422.651,-172.995,84.02"},EPSG_4224:{towgs84:"-143.87,243.37,-33.52"},EPSG_4225:{towgs84:"-205.57,168.77,-4.12"},EPSG_5527:{towgs84:"-67.35,3.88,-38.22"},EPSG_4752:{towgs84:"98,390,-22"},EPSG_4310:{towgs84:"-30,190,89"},EPSG_9248:{towgs84:"-192.26,65.72,132.08"},EPSG_4680:{towgs84:"124.5,-63.5,-281"},EPSG_4701:{towgs84:"-79.9,-158,-168.9"},EPSG_4706:{towgs84:"-146.21,112.63,4.05"},EPSG_4805:{towgs84:"682,-203,480"},EPSG_4201:{towgs84:"-165,-11,206"},EPSG_4210:{towgs84:"-157,-2,-299"},EPSG_4183:{towgs84:"-104,167,-38"},EPSG_4139:{towgs84:"11,72,-101"},EPSG_4668:{towgs84:"-86,-98,-119"},EPSG_4717:{towgs84:"-2,151,181"},EPSG_4732:{towgs84:"102,52,-38"},EPSG_4280:{towgs84:"-377,681,-50"},EPSG_4209:{towgs84:"-138,-105,-289"},EPSG_4261:{towgs84:"31,146,47"},EPSG_4658:{towgs84:"-73,46,-86"},EPSG_4721:{towgs84:"265.025,384.929,-194.046"},EPSG_4222:{towgs84:"-136,-108,-292"},EPSG_4601:{towgs84:"-255,-15,71"},EPSG_4602:{towgs84:"725,685,536"},EPSG_4603:{towgs84:"72,213.7,93"},EPSG_4605:{towgs84:"9,183,236"},EPSG_4621:{towgs84:"137,248,-430"},EPSG_4657:{towgs84:"-28,199,5"},EPSG_4316:{towgs84:"103.25,-100.4,-307.19"},EPSG_4642:{towgs84:"-13,-348,292"},EPSG_4698:{towgs84:"145,-187,103"},EPSG_4192:{towgs84:"-206.1,-174.7,-87.7"},EPSG_4311:{towgs84:"-265,120,-358"},EPSG_4135:{towgs84:"58,-283,-182"},ESRI_104138:{towgs84:"198,-226,-347"},EPSG_4245:{towgs84:"-11,851,5"},EPSG_4142:{towgs84:"-125,53,467"},EPSG_4213:{towgs84:"-106,-87,188"},EPSG_4253:{towgs84:"-133,-77,-51"},EPSG_4129:{towgs84:"-132,-110,-335"},EPSG_4713:{towgs84:"-77,-128,142"},EPSG_4239:{towgs84:"217,823,299"},EPSG_4146:{towgs84:"295,736,257"},EPSG_4155:{towgs84:"-83,37,124"},EPSG_4165:{towgs84:"-173,253,27"},EPSG_4672:{towgs84:"175,-38,113"},EPSG_4236:{towgs84:"-637,-549,-203"},EPSG_4251:{towgs84:"-90,40,88"},EPSG_4271:{towgs84:"-2,374,172"},EPSG_4175:{towgs84:"-88,4,101"},EPSG_4716:{towgs84:"298,-304,-375"},EPSG_4315:{towgs84:"-23,259,-9"},EPSG_4744:{towgs84:"-242.2,-144.9,370.3"},EPSG_4244:{towgs84:"-97,787,86"},EPSG_4293:{towgs84:"616,97,-251"},EPSG_4714:{towgs84:"-127,-769,472"},EPSG_4736:{towgs84:"260,12,-147"},EPSG_6883:{towgs84:"-235,-110,393"},EPSG_6894:{towgs84:"-63,176,185"},EPSG_4205:{towgs84:"-43,-163,45"},EPSG_4256:{towgs84:"41,-220,-134"},EPSG_4262:{towgs84:"639,405,60"},EPSG_4604:{towgs84:"174,359,365"},EPSG_4169:{towgs84:"-115,118,426"},EPSG_4620:{towgs84:"-106,-129,165"},EPSG_4184:{towgs84:"-203,141,53"},EPSG_4616:{towgs84:"-289,-124,60"},EPSG_9403:{towgs84:"-307,-92,127"},EPSG_4684:{towgs84:"-133,-321,50"},EPSG_4708:{towgs84:"-491,-22,435"},EPSG_4707:{towgs84:"114,-116,-333"},EPSG_4709:{towgs84:"145,75,-272"},EPSG_4712:{towgs84:"-205,107,53"},EPSG_4711:{towgs84:"124,-234,-25"},EPSG_4718:{towgs84:"230,-199,-752"},EPSG_4719:{towgs84:"211,147,111"},EPSG_4724:{towgs84:"208,-435,-229"},EPSG_4725:{towgs84:"189,-79,-202"},EPSG_4735:{towgs84:"647,1777,-1124"},EPSG_4722:{towgs84:"-794,119,-298"},EPSG_4728:{towgs84:"-307,-92,127"},EPSG_4734:{towgs84:"-632,438,-609"},EPSG_4727:{towgs84:"912,-58,1227"},EPSG_4729:{towgs84:"185,165,42"},EPSG_4730:{towgs84:"170,42,84"},EPSG_4733:{towgs84:"276,-57,149"},ESRI_37218:{towgs84:"230,-199,-752"},ESRI_37240:{towgs84:"-7,215,225"},ESRI_37221:{towgs84:"252,-209,-751"},ESRI_4305:{towgs84:"-123,-206,219"},ESRI_104139:{towgs84:"-73,-247,227"},EPSG_4748:{towgs84:"51,391,-36"},EPSG_4219:{towgs84:"-384,664,-48"},EPSG_4255:{towgs84:"-333,-222,114"},EPSG_4257:{towgs84:"-587.8,519.75,145.76"},EPSG_4646:{towgs84:"-963,510,-359"},EPSG_6881:{towgs84:"-24,-203,268"},EPSG_6882:{towgs84:"-183,-15,273"},EPSG_4715:{towgs84:"-104,-129,239"},IGNF_RGF93GDD:{towgs84:"0,0,0"},IGNF_RGM04GDD:{towgs84:"0,0,0"},IGNF_RGSPM06GDD:{towgs84:"0,0,0"},IGNF_RGTAAF07GDD:{towgs84:"0,0,0"},IGNF_RGFG95GDD:{towgs84:"0,0,0"},IGNF_RGNCG:{towgs84:"0,0,0"},IGNF_RGPFGDD:{towgs84:"0,0,0"},IGNF_ETRS89G:{towgs84:"0,0,0"},IGNF_RGR92GDD:{towgs84:"0,0,0"},EPSG_4173:{towgs84:"0,0,0"},EPSG_4180:{towgs84:"0,0,0"},EPSG_4619:{towgs84:"0,0,0"},EPSG_4667:{towgs84:"0,0,0"},EPSG_4075:{towgs84:"0,0,0"},EPSG_6706:{towgs84:"0,0,0"},EPSG_7798:{towgs84:"0,0,0"},EPSG_4661:{towgs84:"0,0,0"},EPSG_4669:{towgs84:"0,0,0"},EPSG_8685:{towgs84:"0,0,0"},EPSG_4151:{towgs84:"0,0,0"},EPSG_9702:{towgs84:"0,0,0"},EPSG_4758:{towgs84:"0,0,0"},EPSG_4761:{towgs84:"0,0,0"},EPSG_4765:{towgs84:"0,0,0"},EPSG_8997:{towgs84:"0,0,0"},EPSG_4023:{towgs84:"0,0,0"},EPSG_4670:{towgs84:"0,0,0"},EPSG_4694:{towgs84:"0,0,0"},EPSG_4148:{towgs84:"0,0,0"},EPSG_4163:{towgs84:"0,0,0"},EPSG_4167:{towgs84:"0,0,0"},EPSG_4189:{towgs84:"0,0,0"},EPSG_4190:{towgs84:"0,0,0"},EPSG_4176:{towgs84:"0,0,0"},EPSG_4659:{towgs84:"0,0,0"},EPSG_3824:{towgs84:"0,0,0"},EPSG_3889:{towgs84:"0,0,0"},EPSG_4046:{towgs84:"0,0,0"},EPSG_4081:{towgs84:"0,0,0"},EPSG_4558:{towgs84:"0,0,0"},EPSG_4483:{towgs84:"0,0,0"},EPSG_5013:{towgs84:"0,0,0"},EPSG_5264:{towgs84:"0,0,0"},EPSG_5324:{towgs84:"0,0,0"},EPSG_5354:{towgs84:"0,0,0"},EPSG_5371:{towgs84:"0,0,0"},EPSG_5373:{towgs84:"0,0,0"},EPSG_5381:{towgs84:"0,0,0"},EPSG_5393:{towgs84:"0,0,0"},EPSG_5489:{towgs84:"0,0,0"},EPSG_5593:{towgs84:"0,0,0"},EPSG_6135:{towgs84:"0,0,0"},EPSG_6365:{towgs84:"0,0,0"},EPSG_5246:{towgs84:"0,0,0"},EPSG_7886:{towgs84:"0,0,0"},EPSG_8431:{towgs84:"0,0,0"},EPSG_8427:{towgs84:"0,0,0"},EPSG_8699:{towgs84:"0,0,0"},EPSG_8818:{towgs84:"0,0,0"},EPSG_4757:{towgs84:"0,0,0"},EPSG_9140:{towgs84:"0,0,0"},EPSG_8086:{towgs84:"0,0,0"},EPSG_4686:{towgs84:"0,0,0"},EPSG_4737:{towgs84:"0,0,0"},EPSG_4702:{towgs84:"0,0,0"},EPSG_4747:{towgs84:"0,0,0"},EPSG_4749:{towgs84:"0,0,0"},EPSG_4674:{towgs84:"0,0,0"},EPSG_4755:{towgs84:"0,0,0"},EPSG_4759:{towgs84:"0,0,0"},EPSG_4762:{towgs84:"0,0,0"},EPSG_4763:{towgs84:"0,0,0"},EPSG_4764:{towgs84:"0,0,0"},EPSG_4166:{towgs84:"0,0,0"},EPSG_4170:{towgs84:"0,0,0"},EPSG_5546:{towgs84:"0,0,0"},EPSG_7844:{towgs84:"0,0,0"},EPSG_4818:{towgs84:"589,76,480"}};for(var sle in $_){var RS=$_[sle];RS.datumName&&($_[RS.datumName]=RS)}function ale(n,e,t,r,i,s,a){var o={};return n===void 0||n==="none"?o.datum_type=wI:o.datum_type=_oe,e&&(o.datum_params=e.map(parseFloat),(o.datum_params[0]!==0||o.datum_params[1]!==0||o.datum_params[2]!==0)&&(o.datum_type=qh),o.datum_params.length>3&&(o.datum_params[3]!==0||o.datum_params[4]!==0||o.datum_params[5]!==0||o.datum_params[6]!==0)&&(o.datum_type=Zh,o.datum_params[3]*=Am,o.datum_params[4]*=Am,o.datum_params[5]*=Am,o.datum_params[6]=o.datum_params[6]/1e6+1)),a&&(o.datum_type=Kf,o.grids=a),o.a=t,o.b=r,o.es=i,o.ep2=s,o}var SR={};function ole(n,e,t){return e instanceof ArrayBuffer?lle(n,e,t):{ready:cle(n,e)}}function lle(n,e,t){var r=!0;t!==void 0&&t.includeErrorFields===!1&&(r=!1);var i=new DataView(e),s=dle(i),a=fle(i,s),o=gle(i,a,s,r),l={header:a,subgrids:o};return SR[n]=l,l}async function cle(n,e){for(var t=[],r=await e.getImageCount(),i=r-1;i>=0;i--){var s=await e.getImage(i),a=await s.readRasters(),o=a,l=[s.getWidth(),s.getHeight()],u=s.getBoundingBox().map(IL),h=[s.fileDirectory.ModelPixelScale[0],s.fileDirectory.ModelPixelScale[1]].map(IL),f=u[0]+(l[0]-1)*h[0],g=u[3]-(l[1]-1)*h[1],p=o[0],E=o[1],x=[];for(let I=l[1]-1;I>=0;I--)for(let P=l[0]-1;P>=0;P--){var w=I*l[0]+P;x.push([-Wc(E[w]),Wc(p[w])])}t.push({del:h,lim:l,ll:[-f,g],cvs:x})}var T={header:{nSubgrids:r},subgrids:t};return SR[n]=T,T}function ule(n){if(n===void 0)return null;var e=n.split(",");return e.map(hle)}function hle(n){if(n.length===0)return null;var e=n[0]==="@";return e&&(n=n.slice(1)),n==="null"?{name:"null",mandatory:!e,grid:null,isNull:!0}:{name:n,mandatory:!e,grid:SR[n]||null,isNull:!1}}function IL(n){return n*Math.PI/180}function Wc(n){return n/3600*Math.PI/180}function dle(n){var e=n.getInt32(8,!1);return e===11?!1:(e=n.getInt32(8,!0),e!==11&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}function fle(n,e){return{nFields:n.getInt32(8,e),nSubgridFields:n.getInt32(24,e),nSubgrids:n.getInt32(40,e),shiftType:TI(n,56,64).trim(),fromSemiMajorAxis:n.getFloat64(120,e),fromSemiMinorAxis:n.getFloat64(136,e),toSemiMajorAxis:n.getFloat64(152,e),toSemiMinorAxis:n.getFloat64(168,e)}}function TI(n,e,t){return String.fromCharCode.apply(null,new Uint8Array(n.buffer.slice(e,t)))}function gle(n,e,t,r){for(var i=176,s=[],a=0;a<e.nSubgrids;a++){var o=ple(n,i,t),l=yle(n,i,o,t,r),u=Math.round(1+(o.upperLongitude-o.lowerLongitude)/o.longitudeInterval),h=Math.round(1+(o.upperLatitude-o.lowerLatitude)/o.latitudeInterval);s.push({ll:[Wc(o.lowerLongitude),Wc(o.lowerLatitude)],del:[Wc(o.longitudeInterval),Wc(o.latitudeInterval)],lim:[u,h],count:o.gridNodeCount,cvs:mle(l)});var f=16;r===!1&&(f=8),i+=176+o.gridNodeCount*f}return s}function mle(n){return n.map(function(e){return[Wc(e.longitudeShift),Wc(e.latitudeShift)]})}function ple(n,e,t){return{name:TI(n,e+8,e+16).trim(),parent:TI(n,e+24,e+24+8).trim(),lowerLatitude:n.getFloat64(e+72,t),upperLatitude:n.getFloat64(e+88,t),lowerLongitude:n.getFloat64(e+104,t),upperLongitude:n.getFloat64(e+120,t),latitudeInterval:n.getFloat64(e+136,t),longitudeInterval:n.getFloat64(e+152,t),gridNodeCount:n.getInt32(e+168,t)}}function yle(n,e,t,r,i){var s=e+176,a=16;i===!1&&(a=8);for(var o=[],l=0;l<t.gridNodeCount;l++){var u={latitudeShift:n.getFloat32(s+l*a,r),longitudeShift:n.getFloat32(s+l*a+4,r)};i!==!1&&(u.latitudeAccuracy=n.getFloat32(s+l*a+8,r),u.longitudeAccuracy=n.getFloat32(s+l*a+12,r)),o.push(u)}return o}function Sa(n,e){if(!(this instanceof Sa))return new Sa(n);this.forward=null,this.inverse=null,this.init=null,this.name,this.names=null,this.title,e=e||function(u){if(u)throw u};var t=$oe(n);if(typeof t!="object"){e("Could not parse to valid json: "+n);return}var r=Sa.projections.get(t.projName);if(!r){e("Could not get projection name from: "+n);return}if(t.datumCode&&t.datumCode!=="none"){var i=gu($_,t.datumCode);i&&(t.datum_params=t.datum_params||(i.towgs84?i.towgs84.split(","):null),t.ellps=i.ellipse,t.datumName=i.datumName?i.datumName:t.datumCode)}t.k0=t.k0||1,t.axis=t.axis||"enu",t.ellps=t.ellps||"wgs84",t.lat1=t.lat1||t.lat0;var s=ile(t.a,t.b,t.rf,t.ellps,t.sphere),a=rle(s.a,s.b,s.rf,t.R_A),o=ule(t.nadgrids),l=t.datum||ale(t.datumCode,t.datum_params,s.a,s.b,a.es,a.ep2,o);SL(this,t),SL(this,r),this.a=s.a,this.b=s.b,this.rf=s.rf,this.sphere=s.sphere,this.es=a.es,this.e=a.e,this.ep2=a.ep2,this.datum=l,"init"in this&&typeof this.init=="function"&&this.init(),e(null,this)}Sa.projections=tle;Sa.projections.start();function _le(n,e){return n.datum_type!==e.datum_type||n.a!==e.a||Math.abs(n.es-e.es)>5e-11?!1:n.datum_type===qh?n.datum_params[0]===e.datum_params[0]&&n.datum_params[1]===e.datum_params[1]&&n.datum_params[2]===e.datum_params[2]:n.datum_type===Zh?n.datum_params[0]===e.datum_params[0]&&n.datum_params[1]===e.datum_params[1]&&n.datum_params[2]===e.datum_params[2]&&n.datum_params[3]===e.datum_params[3]&&n.datum_params[4]===e.datum_params[4]&&n.datum_params[5]===e.datum_params[5]&&n.datum_params[6]===e.datum_params[6]:!0}function Dj(n,e,t){var r=n.x,i=n.y,s=n.z?n.z:0,a,o,l,u;if(i<-Ue&&i>-1.001*Ue)i=-Ue;else if(i>Ue&&i<1.001*Ue)i=Ue;else{if(i<-Ue)return{x:-1/0,y:-1/0,z:n.z};if(i>Ue)return{x:1/0,y:1/0,z:n.z}}return r>Math.PI&&(r-=2*Math.PI),o=Math.sin(i),u=Math.cos(i),l=o*o,a=t/Math.sqrt(1-e*l),{x:(a+s)*u*Math.cos(r),y:(a+s)*u*Math.sin(r),z:(a*(1-e)+s)*o}}function Fj(n,e,t,r){var i=1e-12,s=i*i,a=30,o,l,u,h,f,g,p,E,x,w,T,I,P,N=n.x,D=n.y,B=n.z?n.z:0,k,C,M;if(o=Math.sqrt(N*N+D*D),l=Math.sqrt(N*N+D*D+B*B),o/t<i){if(k=0,l/t<i)return C=Ue,M=-r,{x:n.x,y:n.y,z:n.z}}else k=Math.atan2(D,N);u=B/l,h=o/l,f=1/Math.sqrt(1-e*(2-e)*h*h),E=h*(1-e)*f,x=u*f,P=0;do P++,p=t/Math.sqrt(1-e*x*x),M=o*E+B*x-p*(1-e*x*x),g=e*p/(p+M),f=1/Math.sqrt(1-g*(2-g)*h*h),w=h*(1-g)*f,T=u*f,I=T*E-w*x,E=w,x=T;while(I*I>s&&P<a);return C=Math.atan(T/Math.abs(w)),{x:k,y:C,z:M}}function xle(n,e,t){if(e===qh)return{x:n.x+t[0],y:n.y+t[1],z:n.z+t[2]};if(e===Zh){var r=t[0],i=t[1],s=t[2],a=t[3],o=t[4],l=t[5],u=t[6];return{x:u*(n.x-l*n.y+o*n.z)+r,y:u*(l*n.x+n.y-a*n.z)+i,z:u*(-o*n.x+a*n.y+n.z)+s}}}function vle(n,e,t){if(e===qh)return{x:n.x-t[0],y:n.y-t[1],z:n.z-t[2]};if(e===Zh){var r=t[0],i=t[1],s=t[2],a=t[3],o=t[4],l=t[5],u=t[6],h=(n.x-r)/u,f=(n.y-i)/u,g=(n.z-s)/u;return{x:h+l*f-o*g,y:-l*h+f+a*g,z:o*h-a*f+g}}}function l_(n){return n===qh||n===Zh}function Ele(n,e,t){if(_le(n,e)||n.datum_type===wI||e.datum_type===wI)return t;var r=n.a,i=n.es;if(n.datum_type===Kf){var s=AL(n,!1,t);if(s!==0)return;r=yL,i=_L}var a=e.a,o=e.b,l=e.es;if(e.datum_type===Kf&&(a=yL,o=xoe,l=_L),i===l&&r===a&&!l_(n.datum_type)&&!l_(e.datum_type))return t;if(t=Dj(t,i,r),l_(n.datum_type)&&(t=xle(t,n.datum_type,n.datum_params)),l_(e.datum_type)&&(t=vle(t,e.datum_type,e.datum_params)),t=Fj(t,l,a,o),e.datum_type===Kf){var u=AL(e,!0,t);if(u!==0)return}return t}function AL(n,e,t){if(n.grids===null||n.grids.length===0)return console.log("Grid shift grids not found"),-1;var r={x:-t.x,y:t.y},i={x:Number.NaN,y:Number.NaN},s=[];e:for(var a=0;a<n.grids.length;a++){var o=n.grids[a];if(s.push(o.name),o.isNull){i=r;break}if(o.grid===null){if(o.mandatory)return console.log("Unable to find mandatory grid '"+o.name+"'"),-1;continue}for(var l=o.grid.subgrids,u=0,h=l.length;u<h;u++){var f=l[u],g=(Math.abs(f.del[1])+Math.abs(f.del[0]))/1e4,p=f.ll[0]-g,E=f.ll[1]-g,x=f.ll[0]+(f.lim[0]-1)*f.del[0]+g,w=f.ll[1]+(f.lim[1]-1)*f.del[1]+g;if(!(E>r.y||p>r.x||w<r.y||x<r.x)&&(i=wle(r,e,f),!isNaN(i.x)))break e}}return isNaN(i.x)?(console.log("Failed to find a grid shift table for location '"+-r.x*Es+" "+r.y*Es+" tried: '"+s+"'"),-1):(t.x=-i.x,t.y=i.y,0)}function wle(n,e,t){var r={x:Number.NaN,y:Number.NaN};if(isNaN(n.x))return r;var i={x:n.x,y:n.y};i.x-=t.ll[0],i.y-=t.ll[1],i.x=ct(i.x-Math.PI)+Math.PI;var s=bL(i,t);if(e){if(isNaN(s.x))return r;s.x=i.x-s.x,s.y=i.y-s.y;var a=9,o=1e-12,l,u;do{if(u=bL(s,t),isNaN(u.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}l={x:i.x-(u.x+s.x),y:i.y-(u.y+s.y)},s.x+=l.x,s.y+=l.y}while(a--&&Math.abs(l.x)>o&&Math.abs(l.y)>o);if(a<0)return console.log("Inverse grid shift iterator failed to converge."),r;r.x=ct(s.x+t.ll[0]),r.y=s.y+t.ll[1]}else isNaN(s.x)||(r.x=n.x+s.x,r.y=n.y+s.y);return r}function bL(n,e){var t={x:n.x/e.del[0],y:n.y/e.del[1]},r={x:Math.floor(t.x),y:Math.floor(t.y)},i={x:t.x-1*r.x,y:t.y-1*r.y},s={x:Number.NaN,y:Number.NaN},a;if(r.x<0||r.x>=e.lim[0]||r.y<0||r.y>=e.lim[1])return s;a=r.y*e.lim[0]+r.x;var o={x:e.cvs[a][0],y:e.cvs[a][1]};a++;var l={x:e.cvs[a][0],y:e.cvs[a][1]};a+=e.lim[0];var u={x:e.cvs[a][0],y:e.cvs[a][1]};a--;var h={x:e.cvs[a][0],y:e.cvs[a][1]},f=i.x*i.y,g=i.x*(1-i.y),p=(1-i.x)*(1-i.y),E=(1-i.x)*i.y;return s.x=p*o.x+g*l.x+E*h.x+f*u.x,s.y=p*o.y+g*l.y+E*h.y+f*u.y,s}function RL(n,e,t){var r=t.x,i=t.y,s=t.z||0,a,o,l,u={};for(l=0;l<3;l++)if(!(e&&l===2&&t.z===void 0))switch(l===0?(a=r,"ew".indexOf(n.axis[l])!==-1?o="x":o="y"):l===1?(a=i,"ns".indexOf(n.axis[l])!==-1?o="y":o="x"):(a=s,o="z"),n.axis[l]){case"e":u[o]=a;break;case"w":u[o]=-a;break;case"n":u[o]=a;break;case"s":u[o]=-a;break;case"u":t[o]!==void 0&&(u.z=a);break;case"d":t[o]!==void 0&&(u.z=-a);break;default:return null}return u}function jj(n){var e={x:n[0],y:n[1]};return n.length>2&&(e.z=n[2]),n.length>3&&(e.m=n[3]),e}function Sle(n){CL(n.x),CL(n.y)}function CL(n){if(typeof Number.isFinite=="function"){if(Number.isFinite(n))return;throw new TypeError("coordinates must be finite numbers")}if(typeof n!="number"||n!==n||!isFinite(n))throw new TypeError("coordinates must be finite numbers")}function Tle(n,e){return(n.datum.datum_type===qh||n.datum.datum_type===Zh||n.datum.datum_type===Kf)&&e.datumCode!=="WGS84"||(e.datum.datum_type===qh||e.datum.datum_type===Zh||e.datum.datum_type===Kf)&&n.datumCode!=="WGS84"}function nv(n,e,t,r){var i;Array.isArray(t)?t=jj(t):t={x:t.x,y:t.y,z:t.z,m:t.m};var s=t.z!==void 0;if(Sle(t),n.datum&&e.datum&&Tle(n,e)&&(i=new Sa("WGS84"),t=nv(n,i,t,r),n=i),r&&n.axis!=="enu"&&(t=RL(n,!1,t)),n.projName==="longlat")t={x:t.x*gr,y:t.y*gr,z:t.z||0};else if(n.to_meter&&(t={x:t.x*n.to_meter,y:t.y*n.to_meter,z:t.z||0}),t=n.inverse(t),!t)return;if(n.from_greenwich&&(t.x+=n.from_greenwich),t=Ele(n.datum,e.datum,t),!!t)return t=t,e.from_greenwich&&(t={x:t.x-e.from_greenwich,y:t.y,z:t.z||0}),e.projName==="longlat"?t={x:t.x*Es,y:t.y*Es,z:t.z||0}:(t=e.forward(t),e.to_meter&&(t={x:t.x/e.to_meter,y:t.y/e.to_meter,z:t.z||0})),r&&e.axis!=="enu"?RL(e,!0,t):(t&&!s&&delete t.z,t)}var PL=Sa("WGS84");function CS(n,e,t,r){var i,s,a;return Array.isArray(t)?(i=nv(n,e,t,r)||{x:NaN,y:NaN},t.length>2?typeof n.name<"u"&&n.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"?typeof i.z=="number"?[i.x,i.y,i.z].concat(t.slice(3)):[i.x,i.y,t[2]].concat(t.slice(3)):[i.x,i.y].concat(t.slice(2)):[i.x,i.y]):(s=nv(n,e,t,r),a=Object.keys(t),a.length===2||a.forEach(function(o){if(typeof n.name<"u"&&n.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"){if(o==="x"||o==="y"||o==="z")return}else if(o==="x"||o==="y")return;s[o]=t[o]}),s)}function c_(n){return n instanceof Sa?n:typeof n=="object"&&"oProj"in n?n.oProj:Sa(n)}function Ile(n,e,t){var r,i,s=!1,a;return typeof e>"u"?(i=c_(n),r=PL,s=!0):(typeof e.x<"u"||Array.isArray(e))&&(t=e,i=c_(n),r=PL,s=!0),r||(r=c_(n)),i||(i=c_(e)),t?CS(r,i,t):(a={forward:function(o,l){return CS(r,i,o,l)},inverse:function(o,l){return CS(i,r,o,l)}},s&&(a.oProj=i),a)}var kL=6,Vj="AJSAJS",Gj="AFAFAF",Lf=65,hs=73,ga=79,am=86,om=90;const Ale={forward:Bj,inverse:ble,toPoint:Uj};function Bj(n,e){return e=e||5,Ple(Rle({lat:n[1],lon:n[0]}),e)}function ble(n){var e=TR($j(n.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat,e.lon,e.lat]:[e.left,e.bottom,e.right,e.top]}function Uj(n){var e=TR($j(n.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}function PS(n){return n*(Math.PI/180)}function ML(n){return 180*(n/Math.PI)}function Rle(n){var e=n.lat,t=n.lon,r=6378137,i=.00669438,s=.9996,a,o,l,u,h,f,g,p=PS(e),E=PS(t),x,w;w=Math.floor((t+180)/6)+1,t===180&&(w=60),e>=56&&e<64&&t>=3&&t<12&&(w=32),e>=72&&e<84&&(t>=0&&t<9?w=31:t>=9&&t<21?w=33:t>=21&&t<33?w=35:t>=33&&t<42&&(w=37)),a=(w-1)*6-180+3,x=PS(a),o=i/(1-i),l=r/Math.sqrt(1-i*Math.sin(p)*Math.sin(p)),u=Math.tan(p)*Math.tan(p),h=o*Math.cos(p)*Math.cos(p),f=Math.cos(p)*(E-x),g=r*((1-i/4-3*i*i/64-5*i*i*i/256)*p-(3*i/8+3*i*i/32+45*i*i*i/1024)*Math.sin(2*p)+(15*i*i/256+45*i*i*i/1024)*Math.sin(4*p)-35*i*i*i/3072*Math.sin(6*p));var T=s*l*(f+(1-u+h)*f*f*f/6+(5-18*u+u*u+72*h-58*o)*f*f*f*f*f/120)+5e5,I=s*(g+l*Math.tan(p)*(f*f/2+(5-u+9*h+4*h*h)*f*f*f*f/24+(61-58*u+u*u+600*h-330*o)*f*f*f*f*f*f/720));return e<0&&(I+=1e7),{northing:Math.round(I),easting:Math.round(T),zoneNumber:w,zoneLetter:Cle(e)}}function TR(n){var e=n.northing,t=n.easting,r=n.zoneLetter,i=n.zoneNumber;if(i<0||i>60)return null;var s=.9996,a=6378137,o=.00669438,l,u=(1-Math.sqrt(1-o))/(1+Math.sqrt(1-o)),h,f,g,p,E,x,w,T,I,P=t-5e5,N=e;r<"N"&&(N-=1e7),w=(i-1)*6-180+3,l=o/(1-o),x=N/s,T=x/(a*(1-o/4-3*o*o/64-5*o*o*o/256)),I=T+(3*u/2-27*u*u*u/32)*Math.sin(2*T)+(21*u*u/16-55*u*u*u*u/32)*Math.sin(4*T)+151*u*u*u/96*Math.sin(6*T),h=a/Math.sqrt(1-o*Math.sin(I)*Math.sin(I)),f=Math.tan(I)*Math.tan(I),g=l*Math.cos(I)*Math.cos(I),p=a*(1-o)/Math.pow(1-o*Math.sin(I)*Math.sin(I),1.5),E=P/(h*s);var D=I-h*Math.tan(I)/p*(E*E/2-(5+3*f+10*g-4*g*g-9*l)*E*E*E*E/24+(61+90*f+298*g+45*f*f-252*l-3*g*g)*E*E*E*E*E*E/720);D=ML(D);var B=(E-(1+2*f+g)*E*E*E/6+(5-2*g+28*f-3*g*g+8*l+24*f*f)*E*E*E*E*E/120)/Math.cos(I);B=w+ML(B);var k;if(n.accuracy){var C=TR({northing:n.northing+n.accuracy,easting:n.easting+n.accuracy,zoneLetter:n.zoneLetter,zoneNumber:n.zoneNumber});k={top:C.lat,right:C.lon,bottom:D,left:B}}else k={lat:D,lon:B};return k}function Cle(n){var e="Z";return 84>=n&&n>=72?e="X":72>n&&n>=64?e="W":64>n&&n>=56?e="V":56>n&&n>=48?e="U":48>n&&n>=40?e="T":40>n&&n>=32?e="S":32>n&&n>=24?e="R":24>n&&n>=16?e="Q":16>n&&n>=8?e="P":8>n&&n>=0?e="N":0>n&&n>=-8?e="M":-8>n&&n>=-16?e="L":-16>n&&n>=-24?e="K":-24>n&&n>=-32?e="J":-32>n&&n>=-40?e="H":-40>n&&n>=-48?e="G":-48>n&&n>=-56?e="F":-56>n&&n>=-64?e="E":-64>n&&n>=-72?e="D":-72>n&&n>=-80&&(e="C"),e}function Ple(n,e){var t="00000"+n.easting,r="00000"+n.northing;return n.zoneNumber+n.zoneLetter+kle(n.easting,n.northing,n.zoneNumber)+t.substr(t.length-5,e)+r.substr(r.length-5,e)}function kle(n,e,t){var r=zj(t),i=Math.floor(n/1e5),s=Math.floor(e/1e5)%20;return Mle(i,s,r)}function zj(n){var e=n%kL;return e===0&&(e=kL),e}function Mle(n,e,t){var r=t-1,i=Vj.charCodeAt(r),s=Gj.charCodeAt(r),a=i+n-1,o=s+e,l=!1;a>om&&(a=a-om+Lf-1,l=!0),(a===hs||i<hs&&a>hs||(a>hs||i<hs)&&l)&&a++,(a===ga||i<ga&&a>ga||(a>ga||i<ga)&&l)&&(a++,a===hs&&a++),a>om&&(a=a-om+Lf-1),o>am?(o=o-am+Lf-1,l=!0):l=!1,(o===hs||s<hs&&o>hs||(o>hs||s<hs)&&l)&&o++,(o===ga||s<ga&&o>ga||(o>ga||s<ga)&&l)&&(o++,o===hs&&o++),o>am&&(o=o-am+Lf-1);var u=String.fromCharCode(a)+String.fromCharCode(o);return u}function $j(n){if(n&&n.length===0)throw"MGRSPoint coverting from nothing";for(var e=n.length,t=null,r="",i,s=0;!/[A-Z]/.test(i=n.charAt(s));){if(s>=2)throw"MGRSPoint bad conversion from: "+n;r+=i,s++}var a=parseInt(r,10);if(s===0||s+3>e)throw"MGRSPoint bad conversion from: "+n;var o=n.charAt(s++);if(o<="A"||o==="B"||o==="Y"||o>="Z"||o==="I"||o==="O")throw"MGRSPoint zone letter "+o+" not handled: "+n;t=n.substring(s,s+=2);for(var l=zj(a),u=Nle(t.charAt(0),l),h=Lle(t.charAt(1),l);h<Ole(o);)h+=2e6;var f=e-s;if(f%2!==0)throw`MGRSPoint has to have an even number 
of digits after the zone letter and two 100km letters - front 
half for easting meters, second half for 
northing meters`+n;var g=f/2,p=0,E=0,x,w,T,I,P;return g>0&&(x=1e5/Math.pow(10,g),w=n.substring(s,s+g),p=parseFloat(w)*x,T=n.substring(s+g),E=parseFloat(T)*x),I=p+u,P=E+h,{easting:I,northing:P,zoneLetter:o,zoneNumber:a,accuracy:x}}function Nle(n,e){for(var t=Vj.charCodeAt(e-1),r=1e5,i=!1;t!==n.charCodeAt(0);){if(t++,t===hs&&t++,t===ga&&t++,t>om){if(i)throw"Bad character: "+n;t=Lf,i=!0}r+=1e5}return r}function Lle(n,e){if(n>"V")throw"MGRSPoint given invalid Northing "+n;for(var t=Gj.charCodeAt(e-1),r=0,i=!1;t!==n.charCodeAt(0);){if(t++,t===hs&&t++,t===ga&&t++,t>am){if(i)throw"Bad character: "+n;t=Lf,i=!0}r+=1e5}return r}function Ole(n){var e;switch(n){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+n}function A0(n,e,t){if(!(this instanceof A0))return new A0(n,e,t);if(Array.isArray(n))this.x=n[0],this.y=n[1],this.z=n[2]||0;else if(typeof n=="object")this.x=n.x,this.y=n.y,this.z=n.z||0;else if(typeof n=="string"&&typeof e>"u"){var r=n.split(",");this.x=parseFloat(r[0]),this.y=parseFloat(r[1]),this.z=parseFloat(r[2])||0}else this.x=n,this.y=e,this.z=t||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}A0.fromMGRS=function(n){return new A0(Uj(n))};A0.prototype.toMGRS=function(n){return Bj([this.x,this.y],n)};var Dle=1,Fle=.25,NL=.046875,LL=.01953125,OL=.01068115234375,jle=.75,Vle=.46875,Gle=.013020833333333334,Ble=.007120768229166667,Ule=.3645833333333333,zle=.005696614583333333,$le=.3076171875;function IR(n){var e=[];e[0]=Dle-n*(Fle+n*(NL+n*(LL+n*OL))),e[1]=n*(jle-n*(NL+n*(LL+n*OL)));var t=n*n;return e[2]=t*(Vle-n*(Gle+n*Ble)),t*=n,e[3]=t*(Ule-n*zle),e[4]=t*n*$le,e}function U0(n,e,t,r){return t*=e,e*=e,r[0]*n-t*(r[1]+e*(r[2]+e*(r[3]+e*r[4])))}var Wle=20;function AR(n,e,t){for(var r=1/(1-e),i=n,s=Wle;s;--s){var a=Math.sin(i),o=1-e*a*a;if(o=(U0(i,a,Math.cos(i),t)-n)*(o*Math.sqrt(o))*r,i-=o,Math.abs(o)<it)return i}return i}function Hle(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.es&&(this.en=IR(this.es),this.ml0=U0(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))}function Kle(n){var e=n.x,t=n.y,r=ct(e-this.long0,this.over),i,s,a,o=Math.sin(t),l=Math.cos(t);if(this.es){var h=l*r,f=Math.pow(h,2),g=this.ep2*Math.pow(l,2),p=Math.pow(g,2),E=Math.abs(l)>it?Math.tan(t):0,x=Math.pow(E,2),w=Math.pow(x,2);i=1-this.es*Math.pow(o,2),h=h/Math.sqrt(i);var T=U0(t,o,l,this.en);s=this.a*(this.k0*h*(1+f/6*(1-x+g+f/20*(5-18*x+w+14*g-58*x*g+f/42*(61+179*w-w*x-479*x)))))+this.x0,a=this.a*(this.k0*(T-this.ml0+o*r*h/2*(1+f/12*(5-x+9*g+4*p+f/30*(61+w-58*x+270*g-330*x*g+f/56*(1385+543*w-w*x-3111*x))))))+this.y0}else{var u=l*Math.sin(r);if(Math.abs(Math.abs(u)-1)<it)return 93;if(s=.5*this.a*this.k0*Math.log((1+u)/(1-u))+this.x0,a=l*Math.cos(r)/Math.sqrt(1-Math.pow(u,2)),u=Math.abs(a),u>=1){if(u-1>it)return 93;a=0}else a=Math.acos(a);t<0&&(a=-a),a=this.a*this.k0*(a-this.lat0)+this.y0}return n.x=s,n.y=a,n}function Yle(n){var e,t,r,i,s=(n.x-this.x0)*(1/this.a),a=(n.y-this.y0)*(1/this.a);if(this.es)if(e=this.ml0+a/this.k0,t=AR(e,this.es,this.en),Math.abs(t)<Ue){var f=Math.sin(t),g=Math.cos(t),p=Math.abs(g)>it?Math.tan(t):0,E=this.ep2*Math.pow(g,2),x=Math.pow(E,2),w=Math.pow(p,2),T=Math.pow(w,2);e=1-this.es*Math.pow(f,2);var I=s*Math.sqrt(e)/this.k0,P=Math.pow(I,2);e=e*p,r=t-e*P/(1-this.es)*.5*(1-P/12*(5+3*w-9*E*w+E-4*x-P/30*(61+90*w-252*E*w+45*T+46*E-P/56*(1385+3633*w+4095*T+1574*T*w)))),i=ct(this.long0+I*(1-P/6*(1+2*w+E-P/20*(5+28*w+24*T+8*E*w+6*E-P/42*(61+662*w+1320*T+720*T*w))))/g,this.over)}else r=Ue*w1(a),i=0;else{var o=Math.exp(s/this.k0),l=.5*(o-1/o),u=this.lat0+a/this.k0,h=Math.cos(u);e=Math.sqrt((1-Math.pow(h,2))/(1+Math.pow(l,2))),r=Math.asin(e),a<0&&(r=-r),l===0&&h===0?i=0:i=ct(Math.atan2(l,h)+this.long0,this.over)}return n.x=i,n.y=r,n}var Xle=["Fast_Transverse_Mercator","Fast Transverse Mercator"];const W_={init:Hle,forward:Kle,inverse:Yle,names:Xle};function Wj(n){var e=Math.exp(n);return e=(e-1/e)/2,e}function ys(n,e){n=Math.abs(n),e=Math.abs(e);var t=Math.max(n,e),r=Math.min(n,e)/(t||1);return t*Math.sqrt(1+Math.pow(r,2))}function qle(n){var e=1+n,t=e-1;return t===0?n:n*Math.log(e)/t}function Zle(n){var e=Math.abs(n);return e=qle(e*(1+e/(ys(1,e)+1))),n<0?-e:e}function bR(n,e){for(var t=2*Math.cos(2*e),r=n.length-1,i=n[r],s=0,a;--r>=0;)a=-s+t*i+n[r],s=i,i=a;return e+a*Math.sin(2*e)}function Qle(n,e){for(var t=2*Math.cos(e),r=n.length-1,i=n[r],s=0,a;--r>=0;)a=-s+t*i+n[r],s=i,i=a;return Math.sin(e)*a}function Jle(n){var e=Math.exp(n);return e=(e+1/e)/2,e}function Hj(n,e,t){for(var r=Math.sin(e),i=Math.cos(e),s=Wj(t),a=Jle(t),o=2*i*a,l=-2*r*s,u=n.length-1,h=n[u],f=0,g=0,p=0,E,x;--u>=0;)E=g,x=f,g=h,f=p,h=-E+o*g-l*f+n[u],p=-x+l*g+o*f;return o=r*a,l=i*s,[o*h-l*p,o*p+l*h]}function ece(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(W_.init.apply(this),this.forward=W_.forward,this.inverse=W_.inverse),this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var n=this.es/(1+Math.sqrt(1-this.es)),e=n/(2-n),t=e;this.cgb[0]=e*(2+e*(-2/3+e*(-2+e*(116/45+e*(26/45+e*(-2854/675)))))),this.cbg[0]=e*(-2+e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725)))))),t=t*e,this.cgb[1]=t*(7/3+e*(-8/5+e*(-227/45+e*(2704/315+e*(2323/945))))),this.cbg[1]=t*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945))))),t=t*e,this.cgb[2]=t*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835)))),this.cbg[2]=t*(-26/15+e*(34/21+e*(8/5+e*(-12686/2835)))),t=t*e,this.cgb[3]=t*(4279/630+e*(-332/35+e*(-399572/14175))),this.cbg[3]=t*(1237/630+e*(-12/5+e*(-24832/14175))),t=t*e,this.cgb[4]=t*(4174/315+e*(-144838/6237)),this.cbg[4]=t*(-734/315+e*(109598/31185)),t=t*e,this.cgb[5]=t*(601676/22275),this.cbg[5]=t*(444337/155925),t=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+t*(1/4+t*(1/64+t/256))),this.utg[0]=e*(-.5+e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800)))))),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800)))))),this.utg[1]=t*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720))))),this.gtu[1]=t*(13/48+e*(-3/5+e*(557/1440+e*(281/630+e*(-1983433/1935360))))),t=t*e,this.utg[2]=t*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720)))),this.gtu[2]=t*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440)))),t=t*e,this.utg[3]=t*(-4397/161280+e*(11/504+e*(830251/7257600))),this.gtu[3]=t*(49561/161280+e*(-179/168+e*(6601661/7257600))),t=t*e,this.utg[4]=t*(-4583/161280+e*(108847/3991680)),this.gtu[4]=t*(34729/80640+e*(-3418889/1995840)),t=t*e,this.utg[5]=t*(-20648693/638668800),this.gtu[5]=t*(212378941/319334400);var r=bR(this.cbg,this.lat0);this.Zb=-this.Qn*(r+Qle(this.gtu,2*r))}function tce(n){var e=ct(n.x-this.long0,this.over),t=n.y;t=bR(this.cbg,t);var r=Math.sin(t),i=Math.cos(t),s=Math.sin(e),a=Math.cos(e);t=Math.atan2(r,a*i),e=Math.atan2(s*i,ys(r,i*a)),e=Zle(Math.tan(e));var o=Hj(this.gtu,2*t,2*e);t=t+o[0],e=e+o[1];var l,u;return Math.abs(e)<=2.623395162778?(l=this.a*(this.Qn*e)+this.x0,u=this.a*(this.Qn*t+this.Zb)+this.y0):(l=1/0,u=1/0),n.x=l,n.y=u,n}function nce(n){var e=(n.x-this.x0)*(1/this.a),t=(n.y-this.y0)*(1/this.a);t=(t-this.Zb)/this.Qn,e=e/this.Qn;var r,i;if(Math.abs(e)<=2.623395162778){var s=Hj(this.utg,2*t,2*e);t=t+s[0],e=e+s[1],e=Math.atan(Wj(e));var a=Math.sin(t),o=Math.cos(t),l=Math.sin(e),u=Math.cos(e);t=Math.atan2(a*u,ys(l,u*o)),e=Math.atan2(l,u*o),r=ct(e+this.long0,this.over),i=bR(this.cgb,t)}else r=1/0,i=1/0;return n.x=r,n.y=i,n}var rce=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"];const H_={init:ece,forward:tce,inverse:nce,names:rce};function ice(n,e){if(n===void 0){if(n=Math.floor((ct(e)+Math.PI)*30/Math.PI)+1,n<0)return 0;if(n>60)return 60}return n}var sce="etmerc";function ace(){var n=ice(this.zone,this.long0);if(n===void 0)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(n)-183)*gr,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,H_.init.apply(this),this.forward=H_.forward,this.inverse=H_.inverse}var oce=["Universal Transverse Mercator System","utm"];const lce={init:ace,names:oce,dependsOn:sce};function RR(n,e){return Math.pow((1-n)/(1+n),e)}var cce=20;function uce(){var n=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*n*n),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(n/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+bn)/(Math.pow(Math.tan(.5*this.lat0+bn),this.C)*RR(this.e*n,this.ratexp))}function hce(n){var e=n.x,t=n.y;return n.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*t+bn),this.C)*RR(this.e*Math.sin(t),this.ratexp))-Ue,n.x=this.C*e,n}function dce(n){for(var e=1e-14,t=n.x/this.C,r=n.y,i=Math.pow(Math.tan(.5*r+bn)/this.K,1/this.C),s=cce;s>0&&(r=2*Math.atan(i*RR(this.e*Math.sin(n.y),-.5*this.e))-Ue,!(Math.abs(r-n.y)<e));--s)n.y=r;return s?(n.x=t,n.y=r,n):null}const CR={init:uce,forward:hce,inverse:dce};function fce(){CR.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))}function gce(n){var e,t,r,i;return n.x=ct(n.x-this.long0,this.over),CR.forward.apply(this,[n]),e=Math.sin(n.y),t=Math.cos(n.y),r=Math.cos(n.x),i=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*t*r),n.x=i*t*Math.sin(n.x),n.y=i*(this.cosc0*e-this.sinc0*t*r),n.x=this.a*n.x+this.x0,n.y=this.a*n.y+this.y0,n}function mce(n){var e,t,r,i,s;if(n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,n.x/=this.k0,n.y/=this.k0,s=ys(n.x,n.y)){var a=2*Math.atan2(s,this.R2);e=Math.sin(a),t=Math.cos(a),i=Math.asin(t*this.sinc0+n.y*e*this.cosc0/s),r=Math.atan2(n.x*e,s*this.cosc0*t-n.y*this.sinc0*e)}else i=this.phic0,r=0;return n.x=r,n.y=i,CR.inverse.apply(this,[n]),n.x=ct(n.x+this.long0,this.over),n}var pce=["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"];const yce={init:fce,forward:gce,inverse:mce,names:pce};function PR(n,e,t){return e*=t,Math.tan(.5*(Ue+n))*Math.pow((1-e)/(1+e),.5*t)}function _ce(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=it&&(this.k0=.5*(1+w1(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=it&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=it&&Math.abs(Math.cos(this.lat_ts))>it&&(this.k0=.5*this.cons*Yo(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/Qa(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=Yo(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(PR(this.lat0,this.sinlat0,this.e))-Ue,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function xce(n){var e=n.x,t=n.y,r=Math.sin(t),i=Math.cos(t),s,a,o,l,u,h,f=ct(e-this.long0,this.over);return Math.abs(Math.abs(e-this.long0)-Math.PI)<=it&&Math.abs(t+this.lat0)<=it?(n.x=NaN,n.y=NaN,n):this.sphere?(s=2*this.k0/(1+this.sinlat0*r+this.coslat0*i*Math.cos(f)),n.x=this.a*s*i*Math.sin(f)+this.x0,n.y=this.a*s*(this.coslat0*r-this.sinlat0*i*Math.cos(f))+this.y0,n):(a=2*Math.atan(PR(t,r,this.e))-Ue,l=Math.cos(a),o=Math.sin(a),Math.abs(this.coslat0)<=it?(u=Qa(this.e,t*this.con,this.con*r),h=2*this.a*this.k0*u/this.cons,n.x=this.x0+h*Math.sin(e-this.long0),n.y=this.y0-this.con*h*Math.cos(e-this.long0),n):(Math.abs(this.sinlat0)<it?(s=2*this.a*this.k0/(1+l*Math.cos(f)),n.y=s*o):(s=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*o+this.cosX0*l*Math.cos(f))),n.y=s*(this.cosX0*o-this.sinX0*l*Math.cos(f))+this.y0),n.x=s*l*Math.sin(f)+this.x0,n))}function vce(n){n.x-=this.x0,n.y-=this.y0;var e,t,r,i,s,a=Math.sqrt(n.x*n.x+n.y*n.y);if(this.sphere){var o=2*Math.atan(a/(2*this.a*this.k0));return e=this.long0,t=this.lat0,a<=it?(n.x=e,n.y=t,n):(t=Math.asin(Math.cos(o)*this.sinlat0+n.y*Math.sin(o)*this.coslat0/a),Math.abs(this.coslat0)<it?this.lat0>0?e=ct(this.long0+Math.atan2(n.x,-1*n.y),this.over):e=ct(this.long0+Math.atan2(n.x,n.y),this.over):e=ct(this.long0+Math.atan2(n.x*Math.sin(o),a*this.coslat0*Math.cos(o)-n.y*this.sinlat0*Math.sin(o)),this.over),n.x=e,n.y=t,n)}else if(Math.abs(this.coslat0)<=it){if(a<=it)return t=this.lat0,e=this.long0,n.x=e,n.y=t,n;n.x*=this.con,n.y*=this.con,r=a*this.cons/(2*this.a*this.k0),t=this.con*Tp(this.e,r),e=this.con*ct(this.con*this.long0+Math.atan2(n.x,-1*n.y),this.over)}else i=2*Math.atan(a*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,a<=it?s=this.X0:(s=Math.asin(Math.cos(i)*this.sinX0+n.y*Math.sin(i)*this.cosX0/a),e=ct(this.long0+Math.atan2(n.x*Math.sin(i),a*this.cosX0*Math.cos(i)-n.y*this.sinX0*Math.sin(i)),this.over)),t=-1*Tp(this.e,Math.tan(.5*(Ue+s)));return n.x=e,n.y=t,n}var Ece=["stere","Stereographic_South_Pole","Polar_Stereographic_variant_A","Polar_Stereographic_variant_B","Polar_Stereographic"];const wce={init:_ce,forward:xce,inverse:vce,names:Ece,ssfn_:PR};function Sce(){var n=this.lat0;this.lambda0=this.long0;var e=Math.sin(n),t=this.a,r=this.rf,i=1/r,s=2*i-Math.pow(i,2),a=this.e=Math.sqrt(s);this.R=this.k0*t*Math.sqrt(1-s)/(1-s*Math.pow(e,2)),this.alpha=Math.sqrt(1+s/(1-s)*Math.pow(Math.cos(n),4)),this.b0=Math.asin(e/this.alpha);var o=Math.log(Math.tan(Math.PI/4+this.b0/2)),l=Math.log(Math.tan(Math.PI/4+n/2)),u=Math.log((1+a*e)/(1-a*e));this.K=o-this.alpha*l+this.alpha*a/2*u}function Tce(n){var e=Math.log(Math.tan(Math.PI/4-n.y/2)),t=this.e/2*Math.log((1+this.e*Math.sin(n.y))/(1-this.e*Math.sin(n.y))),r=-this.alpha*(e+t)+this.K,i=2*(Math.atan(Math.exp(r))-Math.PI/4),s=this.alpha*(n.x-this.lambda0),a=Math.atan(Math.sin(s)/(Math.sin(this.b0)*Math.tan(i)+Math.cos(this.b0)*Math.cos(s))),o=Math.asin(Math.cos(this.b0)*Math.sin(i)-Math.sin(this.b0)*Math.cos(i)*Math.cos(s));return n.y=this.R/2*Math.log((1+Math.sin(o))/(1-Math.sin(o)))+this.y0,n.x=this.R*a+this.x0,n}function Ice(n){for(var e=n.x-this.x0,t=n.y-this.y0,r=e/this.R,i=2*(Math.atan(Math.exp(t/this.R))-Math.PI/4),s=Math.asin(Math.cos(this.b0)*Math.sin(i)+Math.sin(this.b0)*Math.cos(i)*Math.cos(r)),a=Math.atan(Math.sin(r)/(Math.cos(this.b0)*Math.cos(r)-Math.sin(this.b0)*Math.tan(i))),o=this.lambda0+a/this.alpha,l=0,u=s,h=-1e3,f=0;Math.abs(u-h)>1e-7;){if(++f>20)return;l=1/this.alpha*(Math.log(Math.tan(Math.PI/4+s/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(u))/2)),h=u,u=2*Math.atan(Math.exp(l))-Math.PI/2}return n.x=o,n.y=u,n}var Ace=["somerc"];const bce={init:Sce,forward:Tce,inverse:Ice,names:Ace};var Sf=1e-7;function Rce(n){var e=["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"],t=typeof n.projName=="object"?Object.keys(n.projName)[0]:n.projName;return"no_uoff"in n||"no_off"in n||e.indexOf(t)!==-1||e.indexOf(Lj(t))!==-1}function Cce(){var n,e,t,r,i,s,a,o,l,u,h=0,f,g=0,p=0,E=0,x=0,w=0,T=0;this.no_off=Rce(this),this.no_rot="no_rot"in this;var I=!1;"alpha"in this&&(I=!0);var P=!1;if("rectified_grid_angle"in this&&(P=!0),I&&(T=this.alpha),P&&(h=this.rectified_grid_angle),I||P)g=this.longc;else if(p=this.long1,x=this.lat1,E=this.long2,w=this.lat2,Math.abs(x-w)<=Sf||(n=Math.abs(x))<=Sf||Math.abs(n-Ue)<=Sf||Math.abs(Math.abs(this.lat0)-Ue)<=Sf||Math.abs(Math.abs(w)-Ue)<=Sf)throw new Error;var N=1-this.es;e=Math.sqrt(N),Math.abs(this.lat0)>it?(o=Math.sin(this.lat0),t=Math.cos(this.lat0),n=1-this.es*o*o,this.B=t*t,this.B=Math.sqrt(1+this.es*this.B*this.B/N),this.A=this.B*this.k0*e/n,r=this.B*e/(t*Math.sqrt(n)),i=r*r-1,i<=0?i=0:(i=Math.sqrt(i),this.lat0<0&&(i=-i)),this.E=i+=r,this.E*=Math.pow(Qa(this.e,this.lat0,o),this.B)):(this.B=1/e,this.A=this.k0,this.E=r=i=1),I||P?(I?(f=Math.asin(Math.sin(T)/r),P||(h=T)):(f=h,T=Math.asin(r*Math.sin(f))),this.lam0=g-Math.asin(.5*(i-1/i)*Math.tan(f))/this.B):(s=Math.pow(Qa(this.e,x,Math.sin(x)),this.B),a=Math.pow(Qa(this.e,w,Math.sin(w)),this.B),i=this.E/s,l=(a-s)/(a+s),u=this.E*this.E,u=(u-a*s)/(u+a*s),n=p-E,n<-Math.PI?E-=wp:n>Math.PI&&(E+=wp),this.lam0=ct(.5*(p+E)-Math.atan(u*Math.tan(.5*this.B*(p-E))/l)/this.B,this.over),f=Math.atan(2*Math.sin(this.B*ct(p-this.lam0,this.over))/(i-1/i)),h=T=Math.asin(r*Math.sin(f))),this.singam=Math.sin(f),this.cosgam=Math.cos(f),this.sinrot=Math.sin(h),this.cosrot=Math.cos(h),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(r*r-1)/Math.cos(T))),this.lat0<0&&(this.u_0=-this.u_0)),i=.5*f,this.v_pole_n=this.ArB*Math.log(Math.tan(bn-i)),this.v_pole_s=this.ArB*Math.log(Math.tan(bn+i))}function Pce(n){var e={},t,r,i,s,a,o,l,u;if(n.x=n.x-this.lam0,Math.abs(Math.abs(n.y)-Ue)>it){if(a=this.E/Math.pow(Qa(this.e,n.y,Math.sin(n.y)),this.B),o=1/a,t=.5*(a-o),r=.5*(a+o),s=Math.sin(this.B*n.x),i=(t*this.singam-s*this.cosgam)/r,Math.abs(Math.abs(i)-1)<it)throw new Error;u=.5*this.ArB*Math.log((1-i)/(1+i)),o=Math.cos(this.B*n.x),Math.abs(o)<Sf?l=this.A*n.x:l=this.ArB*Math.atan2(t*this.cosgam+s*this.singam,o)}else u=n.y>0?this.v_pole_n:this.v_pole_s,l=this.ArB*n.y;return this.no_rot?(e.x=l,e.y=u):(l-=this.u_0,e.x=u*this.cosrot+l*this.sinrot,e.y=l*this.cosrot-u*this.sinrot),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e}function kce(n){var e,t,r,i,s,a,o,l={};if(n.x=(n.x-this.x0)*(1/this.a),n.y=(n.y-this.y0)*(1/this.a),this.no_rot?(t=n.y,e=n.x):(t=n.x*this.cosrot-n.y*this.sinrot,e=n.y*this.cosrot+n.x*this.sinrot+this.u_0),r=Math.exp(-this.BrA*t),i=.5*(r-1/r),s=.5*(r+1/r),a=Math.sin(this.BrA*e),o=(a*this.cosgam+i*this.singam)/s,Math.abs(Math.abs(o)-1)<it)l.x=0,l.y=o<0?-Ue:Ue;else{if(l.y=this.E/Math.sqrt((1+o)/(1-o)),l.y=Tp(this.e,Math.pow(l.y,1/this.B)),l.y===1/0)throw new Error;l.x=-this.rB*Math.atan2(i*this.cosgam-a*this.singam,Math.cos(this.BrA*e))}return l.x+=this.lam0,l}var Mce=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Variant_B","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"];const Nce={init:Cce,forward:Pce,inverse:kce,names:Mce};function Lce(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<it)){var n=this.b/this.a;this.e=Math.sqrt(1-n*n);var e=Math.sin(this.lat1),t=Math.cos(this.lat1),r=Yo(this.e,e,t),i=Qa(this.e,this.lat1,e),s=Math.sin(this.lat2),a=Math.cos(this.lat2),o=Yo(this.e,s,a),l=Qa(this.e,this.lat2,s),u=Math.abs(Math.abs(this.lat0)-Ue)<it?0:Qa(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>it?this.ns=Math.log(r/o)/Math.log(i/l):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=r/(this.ns*Math.pow(i,this.ns)),this.rh=this.a*this.f0*Math.pow(u,this.ns),this.title||(this.title="Lambert Conformal Conic")}}function Oce(n){var e=n.x,t=n.y;Math.abs(2*Math.abs(t)-Math.PI)<=it&&(t=w1(t)*(Ue-2*it));var r=Math.abs(Math.abs(t)-Ue),i,s;if(r>it)i=Qa(this.e,t,Math.sin(t)),s=this.a*this.f0*Math.pow(i,this.ns);else{if(r=t*this.ns,r<=0)return null;s=0}var a=this.ns*ct(e-this.long0,this.over);return n.x=this.k0*(s*Math.sin(a))+this.x0,n.y=this.k0*(this.rh-s*Math.cos(a))+this.y0,n}function Dce(n){var e,t,r,i,s,a=(n.x-this.x0)/this.k0,o=this.rh-(n.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(a*a+o*o),t=1):(e=-Math.sqrt(a*a+o*o),t=-1);var l=0;if(e!==0&&(l=Math.atan2(t*a,t*o)),e!==0||this.ns>0){if(t=1/this.ns,r=Math.pow(e/(this.a*this.f0),t),i=Tp(this.e,r),i===-9999)return null}else i=-Ue;return s=ct(l/this.ns+this.long0,this.over),n.x=s,n.y=i,n}var Fce=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"];const jce={init:Lce,forward:Oce,inverse:Dce,names:Fce};function Vce(){this.a=6377397155e-3,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.7417649320975901-.308341501185665),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq}function Gce(n){var e,t,r,i,s,a,o,l=n.x,u=n.y,h=ct(l-this.long0,this.over);return e=Math.pow((1+this.e*Math.sin(u))/(1-this.e*Math.sin(u)),this.alfa*this.e/2),t=2*(Math.atan(this.k*Math.pow(Math.tan(u/2+this.s45),this.alfa)/e)-this.s45),r=-h*this.alfa,i=Math.asin(Math.cos(this.ad)*Math.sin(t)+Math.sin(this.ad)*Math.cos(t)*Math.cos(r)),s=Math.asin(Math.cos(t)*Math.sin(r)/Math.cos(i)),a=this.n*s,o=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(i/2+this.s45),this.n),n.y=o*Math.cos(a)/1,n.x=o*Math.sin(a)/1,this.czech||(n.y*=-1,n.x*=-1),n}function Bce(n){var e,t,r,i,s,a,o,l,u=n.x;n.x=n.y,n.y=u,this.czech||(n.y*=-1,n.x*=-1),a=Math.sqrt(n.x*n.x+n.y*n.y),s=Math.atan2(n.y,n.x),i=s/Math.sin(this.s0),r=2*(Math.atan(Math.pow(this.ro0/a,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(r)-Math.sin(this.ad)*Math.cos(r)*Math.cos(i)),t=Math.asin(Math.cos(r)*Math.sin(i)/Math.cos(e)),n.x=this.long0-t/this.alfa,o=e,l=0;var h=0;do n.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(o))/(1-this.e*Math.sin(o)),this.e/2))-this.s45),Math.abs(o-n.y)<1e-10&&(l=1),o=n.y,h+=1;while(l===0&&h<15);return h>=15?null:n}var Uce=["Krovak","krovak"];const zce={init:Vce,forward:Gce,inverse:Bce,names:Uce};function es(n,e,t,r,i){return n*i-e*Math.sin(2*i)+t*Math.sin(4*i)-r*Math.sin(6*i)}function S1(n){return 1-.25*n*(1+n/16*(3+1.25*n))}function T1(n){return .375*n*(1+.25*n*(1+.46875*n))}function I1(n){return .05859375*n*n*(1+.75*n)}function A1(n){return n*n*n*(35/3072)}function kR(n,e,t){var r=e*t;return n/Math.sqrt(1-r*r)}function Iu(n){return Math.abs(n)<Ue?n:n-w1(n)*Math.PI}function rv(n,e,t,r,i){var s,a;s=n/e;for(var o=0;o<15;o++)if(a=(n-(e*s-t*Math.sin(2*s)+r*Math.sin(4*s)-i*Math.sin(6*s)))/(e-2*t*Math.cos(2*s)+4*r*Math.cos(4*s)-6*i*Math.cos(6*s)),s+=a,Math.abs(a)<=1e-10)return s;return NaN}function $ce(){this.sphere||(this.e0=S1(this.es),this.e1=T1(this.es),this.e2=I1(this.es),this.e3=A1(this.es),this.ml0=this.a*es(this.e0,this.e1,this.e2,this.e3,this.lat0))}function Wce(n){var e,t,r=n.x,i=n.y;if(r=ct(r-this.long0,this.over),this.sphere)e=this.a*Math.asin(Math.cos(i)*Math.sin(r)),t=this.a*(Math.atan2(Math.tan(i),Math.cos(r))-this.lat0);else{var s=Math.sin(i),a=Math.cos(i),o=kR(this.a,this.e,s),l=Math.tan(i)*Math.tan(i),u=r*Math.cos(i),h=u*u,f=this.es*a*a/(1-this.es),g=this.a*es(this.e0,this.e1,this.e2,this.e3,i);e=o*u*(1-h*l*(1/6-(8-l+8*f)*h/120)),t=g-this.ml0+o*s/a*h*(.5+(5-l+6*f)*h/24)}return n.x=e+this.x0,n.y=t+this.y0,n}function Hce(n){n.x-=this.x0,n.y-=this.y0;var e=n.x/this.a,t=n.y/this.a,r,i;if(this.sphere){var s=t+this.lat0;r=Math.asin(Math.sin(s)*Math.cos(e)),i=Math.atan2(Math.tan(e),Math.cos(s))}else{var a=this.ml0/this.a+t,o=rv(a,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(o)-Ue)<=it)return n.x=this.long0,n.y=Ue,t<0&&(n.y*=-1),n;var l=kR(this.a,this.e,Math.sin(o)),u=l*l*l/this.a/this.a*(1-this.es),h=Math.pow(Math.tan(o),2),f=e*this.a/l,g=f*f;r=o-l*Math.tan(o)/u*f*f*(.5-(1+3*h)*f*f/24),i=f*(1-g*(h/3+(1+3*h)*h*g/15))/Math.cos(o)}return n.x=ct(i+this.long0,this.over),n.y=Iu(r),n}var Kce=["Cassini","Cassini_Soldner","cass"];const Yce={init:$ce,forward:Wce,inverse:Hce,names:Kce};function nu(n,e){var t;return n>1e-7?(t=n*e,(1-n*n)*(e/(1-t*t)-.5/n*Math.log((1-t)/(1+t)))):2*e}var II=1,AI=2,bI=3,K_=4;function Xce(){var n=Math.abs(this.lat0);if(Math.abs(n-Ue)<it?this.mode=this.lat0<0?II:AI:Math.abs(n)<it?this.mode=bI:this.mode=K_,this.es>0){var e;switch(this.qp=nu(this.e,1),this.mmf=.5/(1-this.es),this.apa=iue(this.es),this.mode){case AI:this.dd=1;break;case II:this.dd=1;break;case bI:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case K_:this.rq=Math.sqrt(.5*this.qp),e=Math.sin(this.lat0),this.sinb1=nu(this.e,e)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*e*e)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd;break}}else this.mode===K_&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function qce(n){var e,t,r,i,s,a,o,l,u,h,f=n.x,g=n.y;if(f=ct(f-this.long0,this.over),this.sphere){if(s=Math.sin(g),h=Math.cos(g),r=Math.cos(f),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(t=this.mode===this.EQUIT?1+h*r:1+this.sinph0*s+this.cosph0*h*r,t<=it)return null;t=Math.sqrt(2/t),e=t*h*Math.sin(f),t*=this.mode===this.EQUIT?s:this.cosph0*s-this.sinph0*h*r}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(r=-r),Math.abs(g+this.lat0)<it)return null;t=bn-g*.5,t=2*(this.mode===this.S_POLE?Math.cos(t):Math.sin(t)),e=t*Math.sin(f),t*=r}}else{switch(o=0,l=0,u=0,r=Math.cos(f),i=Math.sin(f),s=Math.sin(g),a=nu(this.e,s),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(o=a/this.qp,l=Math.sqrt(1-o*o)),this.mode){case this.OBLIQ:u=1+this.sinb1*o+this.cosb1*l*r;break;case this.EQUIT:u=1+l*r;break;case this.N_POLE:u=Ue+g,a=this.qp-a;break;case this.S_POLE:u=g-Ue,a=this.qp+a;break}if(Math.abs(u)<it)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:u=Math.sqrt(2/u),this.mode===this.OBLIQ?t=this.ymf*u*(this.cosb1*o-this.sinb1*l*r):t=(u=Math.sqrt(2/(1+l*r)))*o*this.ymf,e=this.xmf*u*l*i;break;case this.N_POLE:case this.S_POLE:a>=0?(e=(u=Math.sqrt(a))*i,t=r*(this.mode===this.S_POLE?u:-u)):e=t=0;break}}return n.x=this.a*e+this.x0,n.y=this.a*t+this.y0,n}function Zce(n){n.x-=this.x0,n.y-=this.y0;var e=n.x/this.a,t=n.y/this.a,r,i,s,a,o,l,u;if(this.sphere){var h=0,f,g=0;if(f=Math.sqrt(e*e+t*t),i=f*.5,i>1)return null;switch(i=2*Math.asin(i),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(g=Math.sin(i),h=Math.cos(i)),this.mode){case this.EQUIT:i=Math.abs(f)<=it?0:Math.asin(t*g/f),e*=g,t=h*f;break;case this.OBLIQ:i=Math.abs(f)<=it?this.lat0:Math.asin(h*this.sinph0+t*g*this.cosph0/f),e*=g*this.cosph0,t=(h-Math.sin(i)*this.sinph0)*f;break;case this.N_POLE:t=-t,i=Ue-i;break;case this.S_POLE:i-=Ue;break}r=t===0&&(this.mode===this.EQUIT||this.mode===this.OBLIQ)?0:Math.atan2(e,t)}else{if(u=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(e/=this.dd,t*=this.dd,l=Math.sqrt(e*e+t*t),l<it)return n.x=this.long0,n.y=this.lat0,n;a=2*Math.asin(.5*l/this.rq),s=Math.cos(a),e*=a=Math.sin(a),this.mode===this.OBLIQ?(u=s*this.sinb1+t*a*this.cosb1/l,o=this.qp*u,t=l*this.cosb1*s-t*this.sinb1*a):(u=t*a/l,o=this.qp*u,t=l*s)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(t=-t),o=e*e+t*t,!o)return n.x=this.long0,n.y=this.lat0,n;u=1-o/this.qp,this.mode===this.S_POLE&&(u=-u)}r=Math.atan2(e,t),i=sue(Math.asin(u),this.apa)}return n.x=ct(this.long0+r,this.over),n.y=i,n}var Qce=.3333333333333333,Jce=.17222222222222222,eue=.10257936507936508,tue=.06388888888888888,nue=.0664021164021164,rue=.016415012942191543;function iue(n){var e,t=[];return t[0]=n*Qce,e=n*n,t[0]+=e*Jce,t[1]=e*tue,e*=n,t[0]+=e*eue,t[1]+=e*nue,t[2]=e*rue,t}function sue(n,e){var t=n+n;return n+e[0]*Math.sin(t)+e[1]*Math.sin(t+t)+e[2]*Math.sin(t+t+t)}var aue=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"];const oue={init:Xce,forward:qce,inverse:Zce,names:aue,S_POLE:II,N_POLE:AI,EQUIT:bI,OBLIQ:K_};function mu(n){return Math.abs(n)>1&&(n=n>1?1:-1),Math.asin(n)}function lue(){Math.abs(this.lat1+this.lat2)<it||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=Yo(this.e3,this.sin_po,this.cos_po),this.qs1=nu(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=Yo(this.e3,this.sin_po,this.cos_po),this.qs2=nu(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=nu(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>it?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function cue(n){var e=n.x,t=n.y;this.sin_phi=Math.sin(t),this.cos_phi=Math.cos(t);var r=nu(this.e3,this.sin_phi),i=this.a*Math.sqrt(this.c-this.ns0*r)/this.ns0,s=this.ns0*ct(e-this.long0,this.over),a=i*Math.sin(s)+this.x0,o=this.rh-i*Math.cos(s)+this.y0;return n.x=a,n.y=o,n}function uue(n){var e,t,r,i,s,a;return n.x-=this.x0,n.y=this.rh-n.y+this.y0,this.ns0>=0?(e=Math.sqrt(n.x*n.x+n.y*n.y),r=1):(e=-Math.sqrt(n.x*n.x+n.y*n.y),r=-1),i=0,e!==0&&(i=Math.atan2(r*n.x,r*n.y)),r=e*this.ns0/this.a,this.sphere?a=Math.asin((this.c-r*r)/(2*this.ns0)):(t=(this.c-r*r)/this.ns0,a=this.phi1z(this.e3,t)),s=ct(i/this.ns0+this.long0,this.over),n.x=s,n.y=a,n}function hue(n,e){var t,r,i,s,a,o=mu(.5*e);if(n<it)return o;for(var l=n*n,u=1;u<=25;u++)if(t=Math.sin(o),r=Math.cos(o),i=n*t,s=1-i*i,a=.5*s*s/r*(e/(1-l)-t/s+.5/n*Math.log((1-i)/(1+i))),o=o+a,Math.abs(a)<=1e-7)return o;return null}var due=["Albers_Conic_Equal_Area","Albers_Equal_Area","Albers","aea"];const fue={init:lue,forward:cue,inverse:uue,names:due,phi1z:hue};function gue(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1}function mue(n){var e,t,r,i,s,a,o,l,u=n.x,h=n.y;return r=ct(u-this.long0,this.over),e=Math.sin(h),t=Math.cos(h),i=Math.cos(r),a=this.sin_p14*e+this.cos_p14*t*i,s=1,a>0||Math.abs(a)<=it?(o=this.x0+this.a*s*t*Math.sin(r)/a,l=this.y0+this.a*s*(this.cos_p14*e-this.sin_p14*t*i)/a):(o=this.x0+this.infinity_dist*t*Math.sin(r),l=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*t*i)),n.x=o,n.y=l,n}function pue(n){var e,t,r,i,s,a;return n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,n.x/=this.k0,n.y/=this.k0,(e=Math.sqrt(n.x*n.x+n.y*n.y))?(i=Math.atan2(e,this.rc),t=Math.sin(i),r=Math.cos(i),a=mu(r*this.sin_p14+n.y*t*this.cos_p14/e),s=Math.atan2(n.x*t,e*this.cos_p14*r-n.y*this.sin_p14*t),s=ct(this.long0+s,this.over)):(a=this.phic0,s=0),n.x=s,n.y=a,n}var yue=["gnom"];const _ue={init:gue,forward:mue,inverse:pue,names:yue};function xue(n,e){var t=1-(1-n*n)/(2*n)*Math.log((1-n)/(1+n));if(Math.abs(Math.abs(e)-t)<1e-6)return e<0?-1*Ue:Ue;for(var r=Math.asin(.5*e),i,s,a,o,l=0;l<30;l++)if(s=Math.sin(r),a=Math.cos(r),o=n*s,i=Math.pow(1-o*o,2)/(2*a)*(e/(1-n*n)-s/(1-o*o)+.5/n*Math.log((1-o)/(1+o))),r+=i,Math.abs(i)<=1e-10)return r;return NaN}function vue(){this.sphere||(this.k0=Yo(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))}function Eue(n){var e=n.x,t=n.y,r,i,s=ct(e-this.long0,this.over);if(this.sphere)r=this.x0+this.a*s*Math.cos(this.lat_ts),i=this.y0+this.a*Math.sin(t)/Math.cos(this.lat_ts);else{var a=nu(this.e,Math.sin(t));r=this.x0+this.a*this.k0*s,i=this.y0+this.a*a*.5/this.k0}return n.x=r,n.y=i,n}function wue(n){n.x-=this.x0,n.y-=this.y0;var e,t;return this.sphere?(e=ct(this.long0+n.x/this.a/Math.cos(this.lat_ts),this.over),t=Math.asin(n.y/this.a*Math.cos(this.lat_ts))):(t=xue(this.e,2*n.y*this.k0/this.a),e=ct(this.long0+n.x/(this.a*this.k0),this.over)),n.x=e,n.y=t,n}var Sue=["cea"];const Tue={init:vue,forward:Eue,inverse:wue,names:Sue};function Iue(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)}function Aue(n){var e=n.x,t=n.y,r=ct(e-this.long0,this.over),i=Iu(t-this.lat0);return n.x=this.x0+this.a*r*this.rc,n.y=this.y0+this.a*i,n}function bue(n){var e=n.x,t=n.y;return n.x=ct(this.long0+(e-this.x0)/(this.a*this.rc),this.over),n.y=Iu(this.lat0+(t-this.y0)/this.a),n}var Rue=["Equirectangular","Equidistant_Cylindrical","Equidistant_Cylindrical_Spherical","eqc"];const Cue={init:Iue,forward:Aue,inverse:bue,names:Rue};var DL=20;function Pue(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=S1(this.es),this.e1=T1(this.es),this.e2=I1(this.es),this.e3=A1(this.es),this.ml0=this.a*es(this.e0,this.e1,this.e2,this.e3,this.lat0)}function kue(n){var e=n.x,t=n.y,r,i,s,a=ct(e-this.long0,this.over);if(s=a*Math.sin(t),this.sphere)Math.abs(t)<=it?(r=this.a*a,i=-1*this.a*this.lat0):(r=this.a*Math.sin(s)/Math.tan(t),i=this.a*(Iu(t-this.lat0)+(1-Math.cos(s))/Math.tan(t)));else if(Math.abs(t)<=it)r=this.a*a,i=-1*this.ml0;else{var o=kR(this.a,this.e,Math.sin(t))/Math.tan(t);r=o*Math.sin(s),i=this.a*es(this.e0,this.e1,this.e2,this.e3,t)-this.ml0+o*(1-Math.cos(s))}return n.x=r+this.x0,n.y=i+this.y0,n}function Mue(n){var e,t,r,i,s,a,o,l,u;if(r=n.x-this.x0,i=n.y-this.y0,this.sphere)if(Math.abs(i+this.a*this.lat0)<=it)e=ct(r/this.a+this.long0,this.over),t=0;else{a=this.lat0+i/this.a,o=r*r/this.a/this.a+a*a,l=a;var h;for(s=DL;s;--s)if(h=Math.tan(l),u=-1*(a*(l*h+1)-l-.5*(l*l+o)*h)/((l-a)/h-1),l+=u,Math.abs(u)<=it){t=l;break}e=ct(this.long0+Math.asin(r*Math.tan(l)/this.a)/Math.sin(t),this.over)}else if(Math.abs(i+this.ml0)<=it)t=0,e=ct(this.long0+r/this.a,this.over);else{a=(this.ml0+i)/this.a,o=r*r/this.a/this.a+a*a,l=a;var f,g,p,E,x;for(s=DL;s;--s)if(x=this.e*Math.sin(l),f=Math.sqrt(1-x*x)*Math.tan(l),g=this.a*es(this.e0,this.e1,this.e2,this.e3,l),p=this.e0-2*this.e1*Math.cos(2*l)+4*this.e2*Math.cos(4*l)-6*this.e3*Math.cos(6*l),E=g/this.a,u=(a*(f*E+1)-E-.5*f*(E*E+o))/(this.es*Math.sin(2*l)*(E*E+o-2*a*E)/(4*f)+(a-E)*(f*p-2/Math.sin(2*l))-p),l-=u,Math.abs(u)<=it){t=l;break}f=Math.sqrt(1-this.es*Math.pow(Math.sin(t),2))*Math.tan(t),e=ct(this.long0+Math.asin(r*f/this.a)/Math.sin(t),this.over)}return n.x=e,n.y=t,n}var Nue=["Polyconic","American_Polyconic","poly"];const Lue={init:Pue,forward:kue,inverse:Mue,names:Nue};function Oue(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function Due(n){var e,t=n.x,r=n.y,i=r-this.lat0,s=t-this.long0,a=i/Am*1e-5,o=s,l=1,u=0;for(e=1;e<=10;e++)l=l*a,u=u+this.A[e]*l;var h=u,f=o,g=1,p=0,E,x,w=0,T=0;for(e=1;e<=6;e++)E=g*h-p*f,x=p*h+g*f,g=E,p=x,w=w+this.B_re[e]*g-this.B_im[e]*p,T=T+this.B_im[e]*g+this.B_re[e]*p;return n.x=T*this.a+this.x0,n.y=w*this.a+this.y0,n}function Fue(n){var e,t=n.x,r=n.y,i=t-this.x0,s=r-this.y0,a=s/this.a,o=i/this.a,l=1,u=0,h,f,g=0,p=0;for(e=1;e<=6;e++)h=l*a-u*o,f=u*a+l*o,l=h,u=f,g=g+this.C_re[e]*l-this.C_im[e]*u,p=p+this.C_im[e]*l+this.C_re[e]*u;for(var E=0;E<this.iterations;E++){var x=g,w=p,T,I,P=a,N=o;for(e=2;e<=6;e++)T=x*g-w*p,I=w*g+x*p,x=T,w=I,P=P+(e-1)*(this.B_re[e]*x-this.B_im[e]*w),N=N+(e-1)*(this.B_im[e]*x+this.B_re[e]*w);x=1,w=0;var D=this.B_re[1],B=this.B_im[1];for(e=2;e<=6;e++)T=x*g-w*p,I=w*g+x*p,x=T,w=I,D=D+e*(this.B_re[e]*x-this.B_im[e]*w),B=B+e*(this.B_im[e]*x+this.B_re[e]*w);var k=D*D+B*B;g=(P*D+N*B)/k,p=(N*D-P*B)/k}var C=g,M=p,j=1,O=0;for(e=1;e<=9;e++)j=j*C,O=O+this.D[e]*j;var W=this.lat0+O*Am*1e5,F=this.long0+M;return n.x=F,n.y=W,n}var jue=["New_Zealand_Map_Grid","nzmg"];const Vue={init:Oue,forward:Due,inverse:Fue,names:jue};function Gue(){}function Bue(n){var e=n.x,t=n.y,r=ct(e-this.long0,this.over),i=this.x0+this.a*r,s=this.y0+this.a*Math.log(Math.tan(Math.PI/4+t/2.5))*1.25;return n.x=i,n.y=s,n}function Uue(n){n.x-=this.x0,n.y-=this.y0;var e=ct(this.long0+n.x/this.a,this.over),t=2.5*(Math.atan(Math.exp(.8*n.y/this.a))-Math.PI/4);return n.x=e,n.y=t,n}var zue=["Miller_Cylindrical","mill"];const $ue={init:Gue,forward:Bue,inverse:Uue,names:zue};var Wue=20;function Hue(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=IR(this.es)}function Kue(n){var e,t,r=n.x,i=n.y;if(r=ct(r-this.long0,this.over),this.sphere){if(!this.m)i=this.n!==1?Math.asin(this.n*Math.sin(i)):i;else for(var s=this.n*Math.sin(i),a=Wue;a;--a){var o=(this.m*i+Math.sin(i)-s)/(this.m+Math.cos(i));if(i-=o,Math.abs(o)<it)break}e=this.a*this.C_x*r*(this.m+Math.cos(i)),t=this.a*this.C_y*i}else{var l=Math.sin(i),u=Math.cos(i);t=this.a*U0(i,l,u,this.en),e=this.a*r*u/Math.sqrt(1-this.es*l*l)}return n.x=e,n.y=t,n}function Yue(n){var e,t,r,i;return n.x-=this.x0,r=n.x/this.a,n.y-=this.y0,e=n.y/this.a,this.sphere?(e/=this.C_y,r=r/(this.C_x*(this.m+Math.cos(e))),this.m?e=mu((this.m*e+Math.sin(e))/this.n):this.n!==1&&(e=mu(Math.sin(e)/this.n)),r=ct(r+this.long0,this.over),e=Iu(e)):(e=AR(n.y/this.a,this.es,this.en),i=Math.abs(e),i<Ue?(i=Math.sin(e),t=this.long0+n.x*Math.sqrt(1-this.es*i*i)/(this.a*Math.cos(e)),r=ct(t,this.over)):i-it<Ue&&(r=this.long0)),n.x=r,n.y=e,n}var Xue=["Sinusoidal","sinu"];const que={init:Hue,forward:Kue,inverse:Yue,names:Xue};function Zue(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0}function Que(n){for(var e=n.x,t=n.y,r=ct(e-this.long0,this.over),i=t,s=Math.PI*Math.sin(t);;){var a=-(i+Math.sin(i)-s)/(1+Math.cos(i));if(i+=a,Math.abs(a)<it)break}i/=2,Math.PI/2-Math.abs(t)<it&&(r=0);var o=.900316316158*this.a*r*Math.cos(i)+this.x0,l=1.4142135623731*this.a*Math.sin(i)+this.y0;return n.x=o,n.y=l,n}function Jue(n){var e,t;n.x-=this.x0,n.y-=this.y0,t=n.y/(1.4142135623731*this.a),Math.abs(t)>.999999999999&&(t=.999999999999),e=Math.asin(t);var r=ct(this.long0+n.x/(.900316316158*this.a*Math.cos(e)),this.over);r<-Math.PI&&(r=-Math.PI),r>Math.PI&&(r=Math.PI),t=(2*e+Math.sin(2*e))/Math.PI,Math.abs(t)>1&&(t=1);var i=Math.asin(t);return n.x=r,n.y=i,n}var ehe=["Mollweide","moll"];const the={init:Zue,forward:Que,inverse:Jue,names:ehe};function nhe(){Math.abs(this.lat1+this.lat2)<it||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=S1(this.es),this.e1=T1(this.es),this.e2=I1(this.es),this.e3=A1(this.es),this.sin_phi=Math.sin(this.lat1),this.cos_phi=Math.cos(this.lat1),this.ms1=Yo(this.e,this.sin_phi,this.cos_phi),this.ml1=es(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<it?this.ns=this.sin_phi:(this.sin_phi=Math.sin(this.lat2),this.cos_phi=Math.cos(this.lat2),this.ms2=Yo(this.e,this.sin_phi,this.cos_phi),this.ml2=es(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=es(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))}function rhe(n){var e=n.x,t=n.y,r;if(this.sphere)r=this.a*(this.g-t);else{var i=es(this.e0,this.e1,this.e2,this.e3,t);r=this.a*(this.g-i)}var s=this.ns*ct(e-this.long0,this.over),a=this.x0+r*Math.sin(s),o=this.y0+this.rh-r*Math.cos(s);return n.x=a,n.y=o,n}function ihe(n){n.x-=this.x0,n.y=this.rh-n.y+this.y0;var e,t,r,i;this.ns>=0?(t=Math.sqrt(n.x*n.x+n.y*n.y),e=1):(t=-Math.sqrt(n.x*n.x+n.y*n.y),e=-1);var s=0;if(t!==0&&(s=Math.atan2(e*n.x,e*n.y)),this.sphere)return i=ct(this.long0+s/this.ns,this.over),r=Iu(this.g-t/this.a),n.x=i,n.y=r,n;var a=this.g-t/this.a;return r=rv(a,this.e0,this.e1,this.e2,this.e3),i=ct(this.long0+s/this.ns,this.over),n.x=i,n.y=r,n}var she=["Equidistant_Conic","eqdc"];const ahe={init:nhe,forward:rhe,inverse:ihe,names:she};function ohe(){this.R=this.a}function lhe(n){var e=n.x,t=n.y,r=ct(e-this.long0,this.over),i,s;Math.abs(t)<=it&&(i=this.x0+this.R*r,s=this.y0);var a=mu(2*Math.abs(t/Math.PI));(Math.abs(r)<=it||Math.abs(Math.abs(t)-Ue)<=it)&&(i=this.x0,t>=0?s=this.y0+Math.PI*this.R*Math.tan(.5*a):s=this.y0+Math.PI*this.R*-Math.tan(.5*a));var o=.5*Math.abs(Math.PI/r-r/Math.PI),l=o*o,u=Math.sin(a),h=Math.cos(a),f=h/(u+h-1),g=f*f,p=f*(2/u-1),E=p*p,x=Math.PI*this.R*(o*(f-E)+Math.sqrt(l*(f-E)*(f-E)-(E+l)*(g-E)))/(E+l);r<0&&(x=-x),i=this.x0+x;var w=l+f;return x=Math.PI*this.R*(p*w-o*Math.sqrt((E+l)*(l+1)-w*w))/(E+l),t>=0?s=this.y0+x:s=this.y0-x,n.x=i,n.y=s,n}function che(n){var e,t,r,i,s,a,o,l,u,h,f,g,p;return n.x-=this.x0,n.y-=this.y0,f=Math.PI*this.R,r=n.x/f,i=n.y/f,s=r*r+i*i,a=-Math.abs(i)*(1+s),o=a-2*i*i+r*r,l=-2*a+1+2*i*i+s*s,p=i*i/l+(2*o*o*o/l/l/l-9*a*o/l/l)/27,u=(a-o*o/3/l)/l,h=2*Math.sqrt(-u/3),f=3*p/u/h,Math.abs(f)>1&&(f>=0?f=1:f=-1),g=Math.acos(f)/3,n.y>=0?t=(-h*Math.cos(g+Math.PI/3)-o/3/l)*Math.PI:t=-(-h*Math.cos(g+Math.PI/3)-o/3/l)*Math.PI,Math.abs(r)<it?e=this.long0:e=ct(this.long0+Math.PI*(s-1+Math.sqrt(1+2*(r*r-i*i)+s*s))/2/r,this.over),n.x=e,n.y=t,n}var uhe=["Van_der_Grinten_I","VanDerGrinten","Van_der_Grinten","vandg"];const hhe={init:ohe,forward:lhe,inverse:che,names:uhe};function dhe(n,e,t,r,i,s){const a=r-e,o=Math.atan((1-s)*Math.tan(n)),l=Math.atan((1-s)*Math.tan(t)),u=Math.sin(o),h=Math.cos(o),f=Math.sin(l),g=Math.cos(l);let p=a,E,x=100,w,T,I,P,N,D,B,k,C,M,j,O,W,F;do{if(w=Math.sin(p),T=Math.cos(p),I=Math.sqrt(g*w*(g*w)+(h*f-u*g*T)*(h*f-u*g*T)),I===0)return{azi1:0,s12:0};P=u*f+h*g*T,N=Math.atan2(I,P),D=h*g*w/I,B=1-D*D,k=B!==0?P-2*u*f/B:0,C=s/16*B*(4+s*(4-3*B)),E=p,p=a+(1-C)*s*D*(N+C*I*(k+C*P*(-1+2*k*k)))}while(Math.abs(p-E)>1e-12&&--x>0);return x===0?{azi1:NaN,s12:NaN}:(M=B*(i*i-i*(1-s)*(i*(1-s)))/(i*(1-s)*(i*(1-s))),j=1+M/16384*(4096+M*(-768+M*(320-175*M))),O=M/1024*(256+M*(-128+M*(74-47*M))),W=O*I*(k+O/4*(P*(-1+2*k*k)-O/6*k*(-3+4*I*I)*(-3+4*k*k))),F=i*(1-s)*j*(N-W),{azi1:Math.atan2(g*w,h*f-u*g*T),s12:F})}function fhe(n,e,t,r,i,s){const a=Math.atan((1-s)*Math.tan(n)),o=Math.sin(a),l=Math.cos(a),u=Math.sin(t),h=Math.cos(t),f=Math.atan2(o,l*h),g=l*u,p=1-g*g,E=p*(i*i-i*(1-s)*(i*(1-s)))/(i*(1-s)*(i*(1-s))),x=1+E/16384*(4096+E*(-768+E*(320-175*E))),w=E/1024*(256+E*(-128+E*(74-47*E)));let T=r/(i*(1-s)*x),I,P=100,N,D,B,k;do N=Math.cos(2*f+T),D=Math.sin(T),B=Math.cos(T),k=w*D*(N+w/4*(B*(-1+2*N*N)-w/6*N*(-3+4*D*D)*(-3+4*N*N))),I=T,T=r/(i*(1-s)*x)+k;while(Math.abs(T-I)>1e-12&&--P>0);if(P===0)return{lat2:NaN,lon2:NaN};const C=o*D-l*B*h,M=Math.atan2(o*B+l*D*h,(1-s)*Math.sqrt(g*g+C*C)),j=Math.atan2(D*u,l*B-o*D*h),O=s/16*p*(4+s*(4-3*p)),W=j-(1-O)*s*g*(T+O*D*(N+O*B*(-1+2*N*N))),F=e+W;return{lat2:M,lon2:F}}function ghe(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0),this.f=this.es/(1+Math.sqrt(1-this.es))}function mhe(n){var e=n.x,t=n.y,r=Math.sin(n.y),i=Math.cos(n.y),s=ct(e-this.long0,this.over),a,o,l,u,h,f,g,p,E,x,w;return this.sphere?Math.abs(this.sin_p12-1)<=it?(n.x=this.x0+this.a*(Ue-t)*Math.sin(s),n.y=this.y0-this.a*(Ue-t)*Math.cos(s),n):Math.abs(this.sin_p12+1)<=it?(n.x=this.x0+this.a*(Ue+t)*Math.sin(s),n.y=this.y0+this.a*(Ue+t)*Math.cos(s),n):(E=this.sin_p12*r+this.cos_p12*i*Math.cos(s),g=Math.acos(E),p=g?g/Math.sin(g):1,n.x=this.x0+this.a*p*i*Math.sin(s),n.y=this.y0+this.a*p*(this.cos_p12*r-this.sin_p12*i*Math.cos(s)),n):(a=S1(this.es),o=T1(this.es),l=I1(this.es),u=A1(this.es),Math.abs(this.sin_p12-1)<=it?(h=this.a*es(a,o,l,u,Ue),f=this.a*es(a,o,l,u,t),n.x=this.x0+(h-f)*Math.sin(s),n.y=this.y0-(h-f)*Math.cos(s),n):Math.abs(this.sin_p12+1)<=it?(h=this.a*es(a,o,l,u,Ue),f=this.a*es(a,o,l,u,t),n.x=this.x0+(h+f)*Math.sin(s),n.y=this.y0+(h+f)*Math.cos(s),n):Math.abs(e)<it&&Math.abs(t-this.lat0)<it?(n.x=n.y=0,n):(x=dhe(this.lat0,this.long0,t,e,this.a,this.f),w=x.azi1,n.x=x.s12*Math.sin(w),n.y=x.s12*Math.cos(w),n))}function phe(n){n.x-=this.x0,n.y-=this.y0;var e,t,r,i,s,a,o,l,u,h,f,g,p,E,x,w;return this.sphere?(e=Math.sqrt(n.x*n.x+n.y*n.y),e>2*Ue*this.a?void 0:(t=e/this.a,r=Math.sin(t),i=Math.cos(t),s=this.long0,Math.abs(e)<=it?a=this.lat0:(a=mu(i*this.sin_p12+n.y*r*this.cos_p12/e),o=Math.abs(this.lat0)-Ue,Math.abs(o)<=it?this.lat0>=0?s=ct(this.long0+Math.atan2(n.x,-n.y),this.over):s=ct(this.long0-Math.atan2(-n.x,n.y),this.over):s=ct(this.long0+Math.atan2(n.x*r,e*this.cos_p12*i-n.y*this.sin_p12*r),this.over)),n.x=s,n.y=a,n)):(l=S1(this.es),u=T1(this.es),h=I1(this.es),f=A1(this.es),Math.abs(this.sin_p12-1)<=it?(g=this.a*es(l,u,h,f,Ue),e=Math.sqrt(n.x*n.x+n.y*n.y),p=g-e,a=rv(p/this.a,l,u,h,f),s=ct(this.long0+Math.atan2(n.x,-1*n.y),this.over),n.x=s,n.y=a,n):Math.abs(this.sin_p12+1)<=it?(g=this.a*es(l,u,h,f,Ue),e=Math.sqrt(n.x*n.x+n.y*n.y),p=e-g,a=rv(p/this.a,l,u,h,f),s=ct(this.long0+Math.atan2(n.x,n.y),this.over),n.x=s,n.y=a,n):(E=Math.atan2(n.x,n.y),x=Math.sqrt(n.x*n.x+n.y*n.y),w=fhe(this.lat0,this.long0,E,x,this.a,this.f),n.x=w.lon2,n.y=w.lat2,n))}var yhe=["Azimuthal_Equidistant","aeqd"];const _he={init:ghe,forward:mhe,inverse:phe,names:yhe};function xhe(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)}function vhe(n){var e,t,r,i,s,a,o,l,u=n.x,h=n.y;return r=ct(u-this.long0,this.over),e=Math.sin(h),t=Math.cos(h),i=Math.cos(r),a=this.sin_p14*e+this.cos_p14*t*i,s=1,(a>0||Math.abs(a)<=it)&&(o=this.a*s*t*Math.sin(r),l=this.y0+this.a*s*(this.cos_p14*e-this.sin_p14*t*i)),n.x=o,n.y=l,n}function Ehe(n){var e,t,r,i,s,a,o;return n.x-=this.x0,n.y-=this.y0,e=Math.sqrt(n.x*n.x+n.y*n.y),t=mu(e/this.a),r=Math.sin(t),i=Math.cos(t),a=this.long0,Math.abs(e)<=it?(o=this.lat0,n.x=a,n.y=o,n):(o=mu(i*this.sin_p14+n.y*r*this.cos_p14/e),s=Math.abs(this.lat0)-Ue,Math.abs(s)<=it?(this.lat0>=0?a=ct(this.long0+Math.atan2(n.x,-n.y),this.over):a=ct(this.long0-Math.atan2(-n.x,n.y),this.over),n.x=a,n.y=o,n):(a=ct(this.long0+Math.atan2(n.x*r,e*this.cos_p14*i-n.y*this.sin_p14*r),this.over),n.x=a,n.y=o,n))}var whe=["ortho"];const She={init:xhe,forward:vhe,inverse:Ehe,names:whe};var or={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},Rn={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function The(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=Ue-bn/2?this.face=or.TOP:this.lat0<=-(Ue-bn/2)?this.face=or.BOTTOM:Math.abs(this.long0)<=bn?this.face=or.FRONT:Math.abs(this.long0)<=Ue+bn?this.face=this.long0>0?or.RIGHT:or.LEFT:this.face=or.BACK,this.es!==0&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)}function Ihe(n){var e={x:0,y:0},t,r,i,s,a,o,l={value:0};if(n.x-=this.long0,this.es!==0?t=Math.atan(this.one_minus_f_squared*Math.tan(n.y)):t=n.y,r=n.x,this.face===or.TOP)s=Ue-t,r>=bn&&r<=Ue+bn?(l.value=Rn.AREA_0,i=r-Ue):r>Ue+bn||r<=-(Ue+bn)?(l.value=Rn.AREA_1,i=r>0?r-Tr:r+Tr):r>-(Ue+bn)&&r<=-bn?(l.value=Rn.AREA_2,i=r+Ue):(l.value=Rn.AREA_3,i=r);else if(this.face===or.BOTTOM)s=Ue+t,r>=bn&&r<=Ue+bn?(l.value=Rn.AREA_0,i=-r+Ue):r<bn&&r>=-bn?(l.value=Rn.AREA_1,i=-r):r<-bn&&r>=-(Ue+bn)?(l.value=Rn.AREA_2,i=-r-Ue):(l.value=Rn.AREA_3,i=r>0?-r+Tr:-r-Tr);else{var u,h,f,g,p,E,x;this.face===or.RIGHT?r=Yf(r,+Ue):this.face===or.BACK?r=Yf(r,+Tr):this.face===or.LEFT&&(r=Yf(r,-Ue)),g=Math.sin(t),p=Math.cos(t),E=Math.sin(r),x=Math.cos(r),u=p*x,h=p*E,f=g,this.face===or.FRONT?(s=Math.acos(u),i=u_(s,f,h,l)):this.face===or.RIGHT?(s=Math.acos(h),i=u_(s,f,-u,l)):this.face===or.BACK?(s=Math.acos(-u),i=u_(s,f,-h,l)):this.face===or.LEFT?(s=Math.acos(-h),i=u_(s,f,u,l)):(s=i=0,l.value=Rn.AREA_0)}return o=Math.atan(12/Tr*(i+Math.acos(Math.sin(i)*Math.cos(bn))-Ue)),a=Math.sqrt((1-Math.cos(s))/(Math.cos(o)*Math.cos(o))/(1-Math.cos(Math.atan(1/Math.cos(i))))),l.value===Rn.AREA_1?o+=Ue:l.value===Rn.AREA_2?o+=Tr:l.value===Rn.AREA_3&&(o+=1.5*Tr),e.x=a*Math.cos(o),e.y=a*Math.sin(o),e.x=e.x*this.a+this.x0,e.y=e.y*this.a+this.y0,n.x=e.x,n.y=e.y,n}function Ahe(n){var e={lam:0,phi:0},t,r,i,s,a,o,l,u,h,f={value:0};if(n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,r=Math.atan(Math.sqrt(n.x*n.x+n.y*n.y)),t=Math.atan2(n.y,n.x),n.x>=0&&n.x>=Math.abs(n.y)?f.value=Rn.AREA_0:n.y>=0&&n.y>=Math.abs(n.x)?(f.value=Rn.AREA_1,t-=Ue):n.x<0&&-n.x>=Math.abs(n.y)?(f.value=Rn.AREA_2,t=t<0?t+Tr:t-Tr):(f.value=Rn.AREA_3,t+=Ue),h=Tr/12*Math.tan(t),a=Math.sin(h)/(Math.cos(h)-1/Math.sqrt(2)),o=Math.atan(a),i=Math.cos(t),s=Math.tan(r),l=1-i*i*s*s*(1-Math.cos(Math.atan(1/Math.cos(o)))),l<-1?l=-1:l>1&&(l=1),this.face===or.TOP)u=Math.acos(l),e.phi=Ue-u,f.value===Rn.AREA_0?e.lam=o+Ue:f.value===Rn.AREA_1?e.lam=o<0?o+Tr:o-Tr:f.value===Rn.AREA_2?e.lam=o-Ue:e.lam=o;else if(this.face===or.BOTTOM)u=Math.acos(l),e.phi=u-Ue,f.value===Rn.AREA_0?e.lam=-o+Ue:f.value===Rn.AREA_1?e.lam=-o:f.value===Rn.AREA_2?e.lam=-o-Ue:e.lam=o<0?-o-Tr:-o+Tr;else{var g,p,E;g=l,h=g*g,h>=1?E=0:E=Math.sqrt(1-h)*Math.sin(o),h+=E*E,h>=1?p=0:p=Math.sqrt(1-h),f.value===Rn.AREA_1?(h=p,p=-E,E=h):f.value===Rn.AREA_2?(p=-p,E=-E):f.value===Rn.AREA_3&&(h=p,p=E,E=-h),this.face===or.RIGHT?(h=g,g=-p,p=h):this.face===or.BACK?(g=-g,p=-p):this.face===or.LEFT&&(h=g,g=p,p=-h),e.phi=Math.acos(-E)-Ue,e.lam=Math.atan2(p,g),this.face===or.RIGHT?e.lam=Yf(e.lam,-Ue):this.face===or.BACK?e.lam=Yf(e.lam,-Tr):this.face===or.LEFT&&(e.lam=Yf(e.lam,+Ue))}if(this.es!==0){var x,w,T;x=e.phi<0?1:0,w=Math.tan(e.phi),T=this.b/Math.sqrt(w*w+this.one_minus_f_squared),e.phi=Math.atan(Math.sqrt(this.a*this.a-T*T)/(this.one_minus_f*T)),x&&(e.phi=-e.phi)}return e.lam+=this.long0,n.x=e.lam,n.y=e.phi,n}function u_(n,e,t,r){var i;return n<it?(r.value=Rn.AREA_0,i=0):(i=Math.atan2(e,t),Math.abs(i)<=bn?r.value=Rn.AREA_0:i>bn&&i<=Ue+bn?(r.value=Rn.AREA_1,i-=Ue):i>Ue+bn||i<=-(Ue+bn)?(r.value=Rn.AREA_2,i=i>=0?i-Tr:i+Tr):(r.value=Rn.AREA_3,i+=Ue)),i}function Yf(n,e){var t=n+e;return t<-Tr?t+=wp:t>+Tr&&(t-=wp),t}var bhe=["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"];const Rhe={init:The,forward:Ihe,inverse:Ahe,names:bhe};var RI=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-986701e-12],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,18736e-12],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,934959e-12],[.7986,-.00755338,-500009e-10,935324e-12],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],lm=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-126793e-14,422642e-15],[.124,.0124,507171e-14,-160604e-14],[.186,.0123999,-190189e-13,600152e-14],[.248,.0124002,710039e-13,-224e-10],[.31,.0123992,-264997e-12,835986e-13],[.372,.0124029,988983e-12,-311994e-12],[.434,.0123893,-369093e-11,-435621e-12],[.4958,.0123198,-102252e-10,-345523e-12],[.5571,.0121916,-154081e-10,-582288e-12],[.6176,.0119938,-241424e-10,-525327e-12],[.6769,.011713,-320223e-10,-516405e-12],[.7346,.0113541,-397684e-10,-609052e-12],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-140374e-14],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],Kj=.8487,Yj=1.3523,Xj=Es/5,Che=1/Xj,Of=18,iv=function(n,e){return n[0]+e*(n[1]+e*(n[2]+e*n[3]))},Phe=function(n,e){return n[1]+e*(2*n[2]+e*3*n[3])};function khe(n,e,t,r){for(var i=e;r;--r){var s=n(i);if(i-=s,Math.abs(s)<t)break}return i}function Mhe(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"}function Nhe(n){var e=ct(n.x-this.long0,this.over),t=Math.abs(n.y),r=Math.floor(t*Xj);r<0?r=0:r>=Of&&(r=Of-1),t=Es*(t-Che*r);var i={x:iv(RI[r],t)*e,y:iv(lm[r],t)};return n.y<0&&(i.y=-i.y),i.x=i.x*this.a*Kj+this.x0,i.y=i.y*this.a*Yj+this.y0,i}function Lhe(n){var e={x:(n.x-this.x0)/(this.a*Kj),y:Math.abs(n.y-this.y0)/(this.a*Yj)};if(e.y>=1)e.x/=RI[Of][0],e.y=n.y<0?-Ue:Ue;else{var t=Math.floor(e.y*Of);for(t<0?t=0:t>=Of&&(t=Of-1);;)if(lm[t][0]>e.y)--t;else if(lm[t+1][0]<=e.y)++t;else break;var r=lm[t],i=5*(e.y-r[0])/(lm[t+1][0]-r[0]);i=khe(function(s){return(iv(r,s)-e.y)/Phe(r,s)},i,it,100),e.x/=iv(RI[t],i),e.y=(5*t+i)*gr,n.y<0&&(e.y=-e.y)}return e.x=ct(e.x+this.long0,this.over),e}var Ohe=["Robinson","robin"];const Dhe={init:Mhe,forward:Nhe,inverse:Lhe,names:Ohe};function Fhe(){this.name="geocent"}function jhe(n){var e=Dj(n,this.es,this.a);return e}function Vhe(n){var e=Fj(n,this.es,this.a,this.b);return e}var Ghe=["Geocentric","geocentric","geocent","Geocent"];const Bhe={init:Fhe,forward:jhe,inverse:Vhe,names:Ghe};var Oi={N_POLE:0,S_POLE:1,EQUIT:2,OBLIQ:3},$g={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};function Uhe(){if(Object.keys($g).forEach((function(t){if(typeof this[t]>"u")this[t]=$g[t].def;else{if($g[t].num&&isNaN(this[t]))throw new Error("Invalid parameter value, must be numeric "+t+" = "+this[t]);$g[t].num&&(this[t]=parseFloat(this[t]))}$g[t].degrees&&(this[t]=this[t]*gr)}).bind(this)),Math.abs(Math.abs(this.lat0)-Ue)<it?this.mode=this.lat0<0?Oi.S_POLE:Oi.N_POLE:Math.abs(this.lat0)<it?this.mode=Oi.EQUIT:(this.mode=Oi.OBLIQ,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var n=this.tilt,e=this.azi;this.cg=Math.cos(e),this.sg=Math.sin(e),this.cw=Math.cos(n),this.sw=Math.sin(n)}function zhe(n){n.x-=this.long0;var e=Math.sin(n.y),t=Math.cos(n.y),r=Math.cos(n.x),i,s;switch(this.mode){case Oi.OBLIQ:s=this.sinph0*e+this.cosph0*t*r;break;case Oi.EQUIT:s=t*r;break;case Oi.S_POLE:s=-e;break;case Oi.N_POLE:s=e;break}switch(s=this.pn1/(this.p-s),i=s*t*Math.sin(n.x),this.mode){case Oi.OBLIQ:s*=this.cosph0*e-this.sinph0*t*r;break;case Oi.EQUIT:s*=e;break;case Oi.N_POLE:s*=-(t*r);break;case Oi.S_POLE:s*=t*r;break}var a,o;return a=s*this.cg+i*this.sg,o=1/(a*this.sw*this.h1+this.cw),i=(i*this.cg-s*this.sg)*this.cw*o,s=a*o,n.x=i*this.a,n.y=s*this.a,n}function $he(n){n.x/=this.a,n.y/=this.a;var e={x:n.x,y:n.y},t,r,i;i=1/(this.pn1-n.y*this.sw),t=this.pn1*n.x*i,r=this.pn1*n.y*this.cw*i,n.x=t*this.cg+r*this.sg,n.y=r*this.cg-t*this.sg;var s=ys(n.x,n.y);if(Math.abs(s)<it)e.x=0,e.y=n.y;else{var a,o;switch(o=1-s*s*this.pfact,o=(this.p-Math.sqrt(o))/(this.pn1/s+s/this.pn1),a=Math.sqrt(1-o*o),this.mode){case Oi.OBLIQ:e.y=Math.asin(a*this.sinph0+n.y*o*this.cosph0/s),n.y=(a-this.sinph0*Math.sin(e.y))*s,n.x*=o*this.cosph0;break;case Oi.EQUIT:e.y=Math.asin(n.y*o/s),n.y=a*s,n.x*=o;break;case Oi.N_POLE:e.y=Math.asin(a),n.y=-n.y;break;case Oi.S_POLE:e.y=-Math.asin(a);break}e.x=Math.atan2(n.x,n.y)}return n.x=e.x+this.long0,n.y=e.y,n}var Whe=["Tilted_Perspective","tpers"];const Hhe={init:Uhe,forward:zhe,inverse:$he,names:Whe};function Khe(){if(this.flip_axis=this.sweep==="x"?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,this.es!==0){var n=1-this.es,e=1/n;this.radius_p=Math.sqrt(n),this.radius_p2=n,this.radius_p_inv2=e,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")}function Yhe(n){var e=n.x,t=n.y,r,i,s,a;if(e=e-this.long0,this.shape==="ellipse"){t=Math.atan(this.radius_p2*Math.tan(t));var o=this.radius_p/ys(this.radius_p*Math.cos(t),Math.sin(t));if(i=o*Math.cos(e)*Math.cos(t),s=o*Math.sin(e)*Math.cos(t),a=o*Math.sin(t),(this.radius_g-i)*i-s*s-a*a*this.radius_p_inv2<0)return n.x=Number.NaN,n.y=Number.NaN,n;r=this.radius_g-i,this.flip_axis?(n.x=this.radius_g_1*Math.atan(s/ys(a,r)),n.y=this.radius_g_1*Math.atan(a/r)):(n.x=this.radius_g_1*Math.atan(s/r),n.y=this.radius_g_1*Math.atan(a/ys(s,r)))}else this.shape==="sphere"&&(r=Math.cos(t),i=Math.cos(e)*r,s=Math.sin(e)*r,a=Math.sin(t),r=this.radius_g-i,this.flip_axis?(n.x=this.radius_g_1*Math.atan(s/ys(a,r)),n.y=this.radius_g_1*Math.atan(a/r)):(n.x=this.radius_g_1*Math.atan(s/r),n.y=this.radius_g_1*Math.atan(a/ys(s,r))));return n.x=n.x*this.a,n.y=n.y*this.a,n}function Xhe(n){var e=-1,t=0,r=0,i,s,a,o;if(n.x=n.x/this.a,n.y=n.y/this.a,this.shape==="ellipse"){this.flip_axis?(r=Math.tan(n.y/this.radius_g_1),t=Math.tan(n.x/this.radius_g_1)*ys(1,r)):(t=Math.tan(n.x/this.radius_g_1),r=Math.tan(n.y/this.radius_g_1)*ys(1,t));var l=r/this.radius_p;if(i=t*t+l*l+e*e,s=2*this.radius_g*e,a=s*s-4*i*this.C,a<0)return n.x=Number.NaN,n.y=Number.NaN,n;o=(-s-Math.sqrt(a))/(2*i),e=this.radius_g+o*e,t*=o,r*=o,n.x=Math.atan2(t,e),n.y=Math.atan(r*Math.cos(n.x)/e),n.y=Math.atan(this.radius_p_inv2*Math.tan(n.y))}else if(this.shape==="sphere"){if(this.flip_axis?(r=Math.tan(n.y/this.radius_g_1),t=Math.tan(n.x/this.radius_g_1)*Math.sqrt(1+r*r)):(t=Math.tan(n.x/this.radius_g_1),r=Math.tan(n.y/this.radius_g_1)*Math.sqrt(1+t*t)),i=t*t+r*r+e*e,s=2*this.radius_g*e,a=s*s-4*i*this.C,a<0)return n.x=Number.NaN,n.y=Number.NaN,n;o=(-s-Math.sqrt(a))/(2*i),e=this.radius_g+o*e,t*=o,r*=o,n.x=Math.atan2(t,e),n.y=Math.atan(r*Math.cos(n.x)/e)}return n.x=n.x+this.long0,n}var qhe=["Geostationary Satellite View","Geostationary_Satellite","geos"];const Zhe={init:Khe,forward:Yhe,inverse:Xhe,names:qhe};var bm=1.340264,Rm=-.081106,Cm=893e-6,Pm=.003796,sv=Math.sqrt(3)/2;function Qhe(){this.es=0,this.long0=this.long0!==void 0?this.long0:0,this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0}function Jhe(n){var e=ct(n.x-this.long0,this.over),t=n.y,r=Math.asin(sv*Math.sin(t)),i=r*r,s=i*i*i;return n.x=e*Math.cos(r)/(sv*(bm+3*Rm*i+s*(7*Cm+9*Pm*i))),n.y=r*(bm+Rm*i+s*(Cm+Pm*i)),n.x=this.a*n.x+this.x0,n.y=this.a*n.y+this.y0,n}function ede(n){n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a;var e=1e-9,t=12,r=n.y,i,s,a,o,l,u;for(u=0;u<t&&(i=r*r,s=i*i*i,a=r*(bm+Rm*i+s*(Cm+Pm*i))-n.y,o=bm+3*Rm*i+s*(7*Cm+9*Pm*i),r-=l=a/o,!(Math.abs(l)<e));++u);return i=r*r,s=i*i*i,n.x=sv*n.x*(bm+3*Rm*i+s*(7*Cm+9*Pm*i))/Math.cos(r),n.y=Math.asin(Math.sin(r)/sv),n.x=ct(n.x+this.long0,this.over),n}var tde=["eqearth","Equal Earth","Equal_Earth"];const nde={init:Qhe,forward:Jhe,inverse:ede,names:tde};var Ip=1e-10;function rde(){var n;if(this.phi1=this.lat1,Math.abs(this.phi1)<Ip)throw new Error;this.es?(this.en=IR(this.es),this.m1=U0(this.phi1,this.am1=Math.sin(this.phi1),n=Math.cos(this.phi1),this.en),this.am1=n/(Math.sqrt(1-this.es*this.am1*this.am1)*this.am1),this.inverse=sde,this.forward=ide):(Math.abs(this.phi1)+Ip>=Ue?this.cphi1=0:this.cphi1=1/Math.tan(this.phi1),this.inverse=ode,this.forward=ade)}function ide(n){var e=ct(n.x-(this.long0||0),this.over),t=n.y,r,i,s;return r=this.am1+this.m1-U0(t,i=Math.sin(t),s=Math.cos(t),this.en),i=s*e/(r*Math.sqrt(1-this.es*i*i)),n.x=r*Math.sin(i),n.y=this.am1-r*Math.cos(i),n.x=this.a*n.x+(this.x0||0),n.y=this.a*n.y+(this.y0||0),n}function sde(n){n.x=(n.x-(this.x0||0))/this.a,n.y=(n.y-(this.y0||0))/this.a;var e,t,r,i;if(t=ys(n.x,n.y=this.am1-n.y),i=AR(this.am1+this.m1-t,this.es,this.en),(e=Math.abs(i))<Ue)e=Math.sin(i),r=t*Math.atan2(n.x,n.y)*Math.sqrt(1-this.es*e*e)/Math.cos(i);else if(Math.abs(e-Ue)<=Ip)r=0;else throw new Error;return n.x=ct(r+(this.long0||0),this.over),n.y=Iu(i),n}function ade(n){var e=ct(n.x-(this.long0||0),this.over),t=n.y,r,i;return i=this.cphi1+this.phi1-t,Math.abs(i)>Ip?(n.x=i*Math.sin(r=e*Math.cos(t)/i),n.y=this.cphi1-i*Math.cos(r)):n.x=n.y=0,n.x=this.a*n.x+(this.x0||0),n.y=this.a*n.y+(this.y0||0),n}function ode(n){n.x=(n.x-(this.x0||0))/this.a,n.y=(n.y-(this.y0||0))/this.a;var e,t,r=ys(n.x,n.y=this.cphi1-n.y);if(t=this.cphi1+this.phi1-r,Math.abs(t)>Ue)throw new Error;return Math.abs(Math.abs(t)-Ue)<=Ip?e=0:e=r*Math.atan2(n.x,n.y)/Math.cos(t),n.x=ct(e+(this.long0||0),this.over),n.y=Iu(t),n}var lde=["bonne","Bonne (Werner lat_1=90)"];const cde={init:rde,names:lde},FL={OBLIQUE:{forward:gde,inverse:pde},TRANSVERSE:{forward:mde,inverse:yde}},av={ROTATE:{o_alpha:"oAlpha",o_lon_c:"oLongC",o_lat_c:"oLatC"},NEW_POLE:{o_lat_p:"oLatP",o_lon_p:"oLongP"},NEW_EQUATOR:{o_lon_1:"oLong1",o_lat_1:"oLat1",o_lon_2:"oLong2",o_lat_2:"oLat2"}};function ude(){if(this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.title=this.title||"General Oblique Transformation",this.isIdentity=Mj.includes(this.o_proj),!this.o_proj)throw new Error("Missing parameter: o_proj");if(this.o_proj==="ob_tran")throw new Error("Invalid value for o_proj: "+this.o_proj);const n=this.projStr.replace("+proj=ob_tran","").replace("+o_proj=","+proj=").trim(),e=Sa(n);if(!e)throw new Error("Invalid parameter: o_proj. Unknown projection "+this.o_proj);e.long0=0,this.obliqueProjection=e;let t;const r=Object.keys(av),i=o=>{if(typeof this[o]>"u")return;const l=parseFloat(this[o])*gr;if(isNaN(l))throw new Error("Invalid value for "+o+": "+this[o]);return l};for(let o=0;o<r.length;o++){const l=r[o],u=av[l],h=Object.entries(u);if(h.some(([g])=>typeof this[g]<"u")){t=u;for(let g=0;g<h.length;g++){const[p,E]=h[g],x=i(p);if(typeof x>"u")throw new Error("Missing parameter: "+p+".");this[E]=x}break}}if(!t)throw new Error("No valid parameters provided for ob_tran projection.");const{lamp:s,phip:a}=fde(this,t);this.lamp=s,Math.abs(a)>it?(this.cphip=Math.cos(a),this.sphip=Math.sin(a),this.projectionType=FL.OBLIQUE):this.projectionType=FL.TRANSVERSE}function hde(n){return this.projectionType.forward(this,n)}function dde(n){return this.projectionType.inverse(this,n)}function fde(n,e){let t,r;if(e===av.ROTATE){let i=n.oLongC,s=n.oLatC,a=n.oAlpha;if(Math.abs(Math.abs(s)-Ue)<=it)throw new Error("Invalid value for o_lat_c: "+n.o_lat_c+" should be < 90");r=i+Math.atan2(-1*Math.cos(a),-1*Math.sin(a)*Math.sin(s)),t=Math.asin(Math.cos(s)*Math.sin(a))}else if(e===av.NEW_POLE)r=n.oLongP,t=n.oLatP;else{let i=n.oLong1,s=n.oLat1,a=n.oLong2,o=n.oLat2,l=Math.abs(s);if(Math.abs(s)>Ue-it)throw new Error("Invalid value for o_lat_1: "+n.o_lat_1+" should be < 90");if(Math.abs(o)>Ue-it)throw new Error("Invalid value for o_lat_2: "+n.o_lat_2+" should be < 90");if(Math.abs(s-o)<it)throw new Error("Invalid value for o_lat_1 and o_lat_2: o_lat_1 should be different from o_lat_2");if(l<it)throw new Error("Invalid value for o_lat_1: o_lat_1 should be different from zero");r=Math.atan2(Math.cos(s)*Math.sin(o)*Math.cos(i)-Math.sin(s)*Math.cos(o)*Math.cos(a),Math.sin(s)*Math.cos(o)*Math.sin(a)-Math.cos(s)*Math.sin(o)*Math.sin(i)),t=Math.atan(-1*Math.cos(r-i)/Math.tan(s))}return{lamp:r,phip:t}}function gde(n,e){let{x:t,y:r}=e;t+=n.long0;const i=Math.cos(t),s=Math.sin(r),a=Math.cos(r);e.x=ct(Math.atan2(a*Math.sin(t),n.sphip*a*i+n.cphip*s)+n.lamp),e.y=Math.asin(n.sphip*s-n.cphip*a*i);const o=n.obliqueProjection.forward(e);return n.isIdentity&&(o.x*=Es,o.y*=Es),o}function mde(n,e){let{x:t,y:r}=e;t+=n.long0;const i=Math.cos(r),s=Math.cos(t);e.x=ct(Math.atan2(i*Math.sin(t),Math.sin(r))+n.lamp),e.y=Math.asin(-1*i*s);const a=n.obliqueProjection.forward(e);return n.isIdentity&&(a.x*=Es,a.y*=Es),a}function pde(n,e){n.isIdentity&&(e.x*=gr,e.y*=gr);const t=n.obliqueProjection.inverse(e);let{x:r,y:i}=t;if(r<Number.MAX_VALUE){r-=n.lamp;const s=Math.cos(r),a=Math.sin(i),o=Math.cos(i);e.x=Math.atan2(o*Math.sin(r),n.sphip*o*s-n.cphip*a),e.y=Math.asin(n.sphip*a+n.cphip*o*s)}return e.x=ct(e.x+n.long0),e}function yde(n,e){n.isIdentity&&(e.x*=gr,e.y*=gr);const t=n.obliqueProjection.inverse(e);let{x:r,y:i}=t;if(r<Number.MAX_VALUE){const s=Math.cos(i);r-=n.lamp,e.x=Math.atan2(s*Math.sin(r),-1*Math.sin(i)),e.y=Math.asin(s*Math.cos(r))}return e.x=ct(e.x+n.long0),e}var _de=["General Oblique Transformation","General_Oblique_Transformation","ob_tran"];const xde={init:ude,forward:hde,inverse:dde,names:_de};function vde(n){n.Proj.projections.add(W_),n.Proj.projections.add(H_),n.Proj.projections.add(lce),n.Proj.projections.add(yce),n.Proj.projections.add(wce),n.Proj.projections.add(bce),n.Proj.projections.add(Nce),n.Proj.projections.add(jce),n.Proj.projections.add(zce),n.Proj.projections.add(Yce),n.Proj.projections.add(oue),n.Proj.projections.add(fue),n.Proj.projections.add(_ue),n.Proj.projections.add(Tue),n.Proj.projections.add(Cue),n.Proj.projections.add(Lue),n.Proj.projections.add(Vue),n.Proj.projections.add($ue),n.Proj.projections.add(que),n.Proj.projections.add(the),n.Proj.projections.add(ahe),n.Proj.projections.add(hhe),n.Proj.projections.add(_he),n.Proj.projections.add(She),n.Proj.projections.add(Rhe),n.Proj.projections.add(Dhe),n.Proj.projections.add(Bhe),n.Proj.projections.add(Hhe),n.Proj.projections.add(Zhe),n.Proj.projections.add(nde),n.Proj.projections.add(cde),n.Proj.projections.add(xde)}const gn=Object.assign(Ile,{defaultDatum:"WGS84",Proj:Sa,WGS84:new Sa("WGS84"),Point:A0,toPoint:jj,defs:mi,nadgrid:ole,transform:nv,mgrs:Ale,version:"__VERSION__"});vde(gn);class qj{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=eo,this.supportedMediaTypes=null}getReadOptions(e,t){if(t){let r=t.dataProjection?Bn(t.dataProjection):this.readProjection(e);t.extent&&r&&r.getUnits()==="tile-pixels"&&(r=Bn(r),r.setWorldExtent(t.extent)),t={dataProjection:r,featureProjection:t.featureProjection}}return this.adaptOptions(t)}adaptOptions(e){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},e)}getType(){return Ft()}readFeature(e,t){return Ft()}readFeatures(e,t){return Ft()}readGeometry(e,t){return Ft()}readProjection(e){return Ft()}writeFeature(e,t){return Ft()}writeFeatures(e,t){return Ft()}writeGeometry(e,t){return Ft()}}function io(n,e,t){const r=t?Bn(t.featureProjection):null,i=t?Bn(t.dataProjection):null;let s=n;if(r&&i&&!Sh(r,i)){e&&(s=n.clone());const a=e?r:i,o=e?i:r;a.getUnits()==="tile-pixels"?s.transform(a,o):s.applyTransform($m(a,o))}if(e&&t&&t.decimals!==void 0){const a=Math.pow(10,t.decimals),o=function(l){for(let u=0,h=l.length;u<h;++u)l[u]=Math.round(l[u]*a)/a;return l};s===n&&(s=n.clone()),s.applyTransform(o)}return s}const Ede={Point:to,LineString:zo,Polygon:no,MultiPoint:P0,MultiLineString:iu,MultiPolygon:o0};function wde(n,e,t){return Array.isArray(e[0])?(k5(n,0,e,t)||(n=n.slice(),oT(n,0,e,t)),n):(uA(n,0,e,t)||(n=n.slice(),lx(n,0,e,t)),n)}function Zj(n,e){const t=n.geometry;if(!t)return[];if(Array.isArray(t))return t.map(s=>Zj({...n,geometry:s})).flat();const r=t.type==="MultiPolygon"?"Polygon":t.type;if(r==="GeometryCollection"||r==="Circle")throw new Error("Unsupported geometry type: "+r);const i=t.layout.length;return io(new zs(r,r==="Polygon"?wde(t.flatCoordinates,t.ends,i):t.flatCoordinates,t.ends?.flat(),i,n.properties||{},n.id).enableSimplifyTransformed(),!1,e)}function MR(n,e){if(!n)return null;if(Array.isArray(n)){const r=n.map(i=>MR(i,e));return new qa(r)}const t=Ede[n.type];return io(new t(n.flatCoordinates,n.layout||"XY",n.ends),!1,e)}class Sde extends qj{constructor(){super()}getType(){return"json"}readFeature(e,t){return this.readFeatureFromObject(h_(e),this.getReadOptions(e,t))}readFeatures(e,t){return this.readFeaturesFromObject(h_(e),this.getReadOptions(e,t))}readFeatureFromObject(e,t){return Ft()}readFeaturesFromObject(e,t){return Ft()}readGeometry(e,t){return this.readGeometryFromObject(h_(e),this.getReadOptions(e,t))}readGeometryFromObject(e,t){return Ft()}readProjection(e){return this.readProjectionFromObject(h_(e))}readProjectionFromObject(e){return Ft()}writeFeature(e,t){return JSON.stringify(this.writeFeatureObject(e,t))}writeFeatureObject(e,t){return Ft()}writeFeatures(e,t){return JSON.stringify(this.writeFeaturesObject(e,t))}writeFeaturesObject(e,t){return Ft()}writeGeometry(e,t){return JSON.stringify(this.writeGeometryObject(e,t))}writeGeometryObject(e,t){return Ft()}}function h_(n){if(typeof n=="string"){const e=JSON.parse(n);return e||null}return n!==null?n:null}class NR extends Sde{constructor(e){e=e||{},super(),this.dataProjection=Bn(e.dataProjection?e.dataProjection:"EPSG:4326"),e.featureProjection&&(this.defaultFeatureProjection=Bn(e.featureProjection)),e.featureClass&&(this.featureClass=e.featureClass),this.geometryName_=e.geometryName,this.extractGeometryName_=e.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(e,t){let r=null;e.type==="Feature"?r=e:r={type:"Feature",geometry:e,properties:null};const i=LR(r.geometry);if(this.featureClass===zs)return Zj({geometry:i,id:r.id,properties:r.properties},t);const s=new eo;return this.geometryName_?s.setGeometryName(this.geometryName_):this.extractGeometryName_&&r.geometry_name&&s.setGeometryName(r.geometry_name),s.setGeometry(MR(i,t)),"id"in r&&s.setId(r.id),r.properties&&s.setProperties(r.properties,!0),s}readFeaturesFromObject(e,t){const r=e;let i=null;if(r.type==="FeatureCollection"){const s=e;i=[];const a=s.features;for(let o=0,l=a.length;o<l;++o){const u=this.readFeatureFromObject(a[o],t);u&&i.push(u)}}else i=[this.readFeatureFromObject(e,t)];return i.flat()}readGeometryFromObject(e,t){return Tde(e,t)}readProjectionFromObject(e){const t=e.crs;let r;if(t)if(t.type=="name")r=Bn(t.properties.name);else if(t.type==="EPSG")r=Bn("EPSG:"+t.properties.code);else throw new Error("Unknown SRS type");else r=this.dataProjection;return r}writeFeatureObject(e,t){t=this.adaptOptions(t);const r={type:"Feature",geometry:null,properties:null},i=e.getId();if(i!==void 0&&(r.id=i),!e.hasProperties())return r;const s=e.getProperties(),a=e.getGeometry();return a&&(r.geometry=CI(a,t),delete s[e.getGeometryName()]),Ph(s)||(r.properties=s),r}writeFeaturesObject(e,t){t=this.adaptOptions(t);const r=[];for(let i=0,s=e.length;i<s;++i)r.push(this.writeFeatureObject(e[i],t));return{type:"FeatureCollection",features:r}}writeGeometryObject(e,t){return CI(e,this.adaptOptions(t))}}function LR(n,e){if(!n)return null;let t;switch(n.type){case"Point":{t=Ade(n);break}case"LineString":{t=bde(n);break}case"Polygon":{t=kde(n);break}case"MultiPoint":{t=Cde(n);break}case"MultiLineString":{t=Rde(n);break}case"MultiPolygon":{t=Pde(n);break}case"GeometryCollection":{t=Ide(n);break}default:throw new Error("Unsupported GeoJSON type: "+n.type)}return t}function Tde(n,e){const t=LR(n);return MR(t,e)}function Ide(n,e){return n.geometries.map(function(r){return LR(r)})}function Ade(n){const e=n.coordinates;return{type:"Point",flatCoordinates:e,layout:id(e.length)}}function bde(n){const e=n.coordinates,t=e.flat();return{type:"LineString",flatCoordinates:t,ends:[t.length],layout:id(e[0]?.length||2)}}function Rde(n){const e=n.coordinates,t=e[0]?.[0]?.length||2,r=[],i=Up(r,0,e,t);return{type:"MultiLineString",flatCoordinates:r,ends:i,layout:id(t)}}function Cde(n){const e=n.coordinates;return{type:"MultiPoint",flatCoordinates:e.flat(),layout:id(e[0]?.length||2)}}function Pde(n){const e=n.coordinates,t=[],r=e[0]?.[0]?.[0].length||2,i=o5(t,0,e,r);return{type:"MultiPolygon",flatCoordinates:t,ends:i,layout:id(r)}}function kde(n){const e=n.coordinates,t=[],r=e[0]?.[0]?.length,i=Up(t,0,e,r);return{type:"Polygon",flatCoordinates:t,ends:i,layout:id(r)}}function CI(n,e){n=io(n,!0,e);const t=n.getType();let r;switch(t){case"Point":{r=Fde(n);break}case"LineString":{r=Nde(n);break}case"Polygon":{r=jde(n,e);break}case"MultiPoint":{r=Ode(n);break}case"MultiLineString":{r=Lde(n);break}case"MultiPolygon":{r=Dde(n,e);break}case"GeometryCollection":{r=Mde(n,e);break}case"Circle":{r={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+t)}return r}function Mde(n,e){return e=Object.assign({},e),delete e.featureProjection,{type:"GeometryCollection",geometries:n.getGeometriesArray().map(function(r){return CI(r,e)})}}function Nde(n,e){return{type:"LineString",coordinates:n.getCoordinates()}}function Lde(n,e){return{type:"MultiLineString",coordinates:n.getCoordinates()}}function Ode(n,e){return{type:"MultiPoint",coordinates:n.getCoordinates()}}function Dde(n,e){let t;return e&&(t=e.rightHanded),{type:"MultiPolygon",coordinates:n.getCoordinates(t)}}function Fde(n,e){return{type:"Point",coordinates:n.getCoordinates()}}function jde(n,e){let t;return e&&(t=e.rightHanded),{type:"Polygon",coordinates:n.getCoordinates(t)}}const ov="http://www.w3.org/2001/XMLSchema-instance";function dd(n,e){return z0().createElementNS(n,e)}function so(n,e){return Qj(n,e,[]).join("")}function Qj(n,e,t){if(n.nodeType==Node.CDATA_SECTION_NODE||n.nodeType==Node.TEXT_NODE)t.push(n.nodeValue);else{let r;for(r=n.firstChild;r;r=r.nextSibling)Qj(r,e,t)}return t}function Sl(n){return"documentElement"in n}function Tl(n){return new DOMParser().parseFromString(n,"application/xml")}function jL(n,e){return(function(t,r){const i=n.call(e??this,t,r);if(i!==void 0){const s=r[r.length-1];An(s,i)}})}function $a(n,e){return(function(t,r){const i=n.call(e??this,t,r);i!==void 0&&r[r.length-1].push(i)})}function OR(n,e){return(function(t,r){const i=n.call(this,t,r);i!==void 0&&(r[r.length-1]=i)})}function Ve(n,e,t){return(function(r,i){const s=n.call(this,r,i);if(s!==void 0){const a=i[i.length-1],o=e!==void 0?e:r.localName;a[o]=s}})}function qe(n,e){return(function(t,r,i){n.call(this,t,r,i),i[i.length-1].node.appendChild(t)})}function Jj(n,e){let t,r;return function(i,s,a){if(t===void 0){t={};const o={};o[i.localName]=n,t[i.namespaceURI]=o,r=ao(i.localName)}e7(t,r,s,a)}}function ao(n,e){return(function(t,r,i){const a=r[r.length-1].node;let o=n;o===void 0&&(o=i);const l=a.namespaceURI;return dd(l,o)})}const Bi=ao();function Ss(n,e){const t=e.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=n[e[i]];return r}function lt(n,e,t){t=t!==void 0?t:{};let r,i;for(r=0,i=n.length;r<i;++r)t[n[r]]=e;return t}function Au(n,e,t,r){let i;for(i=e.firstElementChild;i;i=i.nextElementSibling){const s=n[i.namespaceURI];if(s!==void 0){const a=s[i.localName];a!==void 0&&a.call(r,i,t)}}}function an(n,e,t,r,i){return r.push(n),Au(e,t,r,i),r.pop()}function e7(n,e,t,r,i,s){const a=(i!==void 0?i:t).length;let o,l;for(let u=0;u<a;++u)o=t[u],o!==void 0&&(l=e.call(s,o,r,i!==void 0?i[u]:void 0),l!==void 0&&n[l.namespaceURI][l.localName].call(s,l,o,r))}function zn(n,e,t,r,i,s,a){return i.push(n),e7(e,t,r,i,s,a),i.pop()}let kS;function Vde(){return kS===void 0&&typeof XMLSerializer<"u"&&(kS=new XMLSerializer),kS}let MS;function z0(){return MS===void 0&&typeof document<"u"&&(MS=document.implementation.createDocument("","",null)),MS}class t7 extends qj{constructor(){super(),this.xmlSerializer_=Vde()}getType(){return"xml"}readFeature(e,t){if(!e)return null;if(typeof e=="string"){const r=Tl(e);return this.readFeatureFromDocument(r,t)}return Sl(e)?this.readFeatureFromDocument(e,t):this.readFeatureFromNode(e,t)}readFeatureFromDocument(e,t){const r=this.readFeaturesFromDocument(e,t);return r.length>0?r[0]:null}readFeatureFromNode(e,t){return null}readFeatures(e,t){if(!e)return[];if(typeof e=="string"){const r=Tl(e);return this.readFeaturesFromDocument(r,t)}return Sl(e)?this.readFeaturesFromDocument(e,t):this.readFeaturesFromNode(e,t)}readFeaturesFromDocument(e,t){const r=[];for(let i=e.firstChild;i;i=i.nextSibling)i.nodeType==Node.ELEMENT_NODE&&An(r,this.readFeaturesFromNode(i,t));return r}readFeaturesFromNode(e,t){return Ft()}readGeometry(e,t){if(!e)return null;if(typeof e=="string"){const r=Tl(e);return this.readGeometryFromDocument(r,t)}return Sl(e)?this.readGeometryFromDocument(e,t):this.readGeometryFromNode(e,t)}readGeometryFromDocument(e,t){return null}readGeometryFromNode(e,t){return null}readProjection(e){if(!e)return null;if(typeof e=="string"){const t=Tl(e);return this.readProjectionFromDocument(t)}return Sl(e)?this.readProjectionFromDocument(e):this.readProjectionFromNode(e)}readProjectionFromDocument(e){return this.dataProjection}readProjectionFromNode(e){return this.dataProjection}writeFeature(e,t){const r=this.writeFeatureNode(e,t);return this.xmlSerializer_.serializeToString(r)}writeFeatureNode(e,t){return null}writeFeatures(e,t){const r=this.writeFeaturesNode(e,t);return this.xmlSerializer_.serializeToString(r)}writeFeaturesNode(e,t){return null}writeGeometry(e,t){const r=this.writeGeometryNode(e,t);return this.xmlSerializer_.serializeToString(r)}writeGeometryNode(e,t){return null}}function pu(n){const e=so(n,!1);return Gde(e)}function Gde(n){const e=/^\s*(true|1)|(false|0)\s*$/.exec(n);if(e)return e[1]!==void 0||!1}function LE(n){const e=so(n,!1),t=Date.parse(e);return isNaN(t)?void 0:t/1e3}function yn(n){const e=so(n,!1);return Bde(e)}function Bde(n){const e=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(n);if(e)return parseFloat(e[1])}function Ap(n){const e=so(n,!1);return Ude(e)}function Ude(n){const e=/^\s*(\d+)\s*$/.exec(n);if(e)return parseInt(e[1],10)}function Zt(n){return so(n,!1).trim()}function b0(n,e){wn(n,e?"1":"0")}function zde(n,e){n.appendChild(z0().createCDATASection(e))}function $de(n,e){const t=new Date(e*1e3),r=t.getUTCFullYear()+"-"+kg(t.getUTCMonth()+1,2)+"-"+kg(t.getUTCDate(),2)+"T"+kg(t.getUTCHours(),2)+":"+kg(t.getUTCMinutes(),2)+":"+kg(t.getUTCSeconds(),2)+"Z";n.appendChild(z0().createTextNode(r))}function ds(n,e){const t=e.toPrecision();n.appendChild(z0().createTextNode(t))}function lv(n,e){const t=e.toString();n.appendChild(z0().createTextNode(t))}const Wde=/^\s/,Hde=/\s$/,Kde=/(\n|\t|\r|<|&| {2})/;function wn(n,e){typeof e=="string"&&(Wde.test(e)||Hde.test(e)||Kde.test(e))?e.split("]]>").forEach((t,r,i)=>{r<i.length-1&&(t+="]]"),r>0&&(t=">"+t),zde(n,t)}):n.appendChild(z0().createTextNode(e))}const Xn=[null,"http://www.topografix.com/GPX/1/0","http://www.topografix.com/GPX/1/1"],Yde="http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd",Xde={rte:n7,trk:r7,wpt:i7},qde=lt(Xn,{rte:$a(n7),trk:$a(r7),wpt:$a(i7)}),Zde=lt(Xn,{text:Ve(Zt,"linkText"),type:Ve(Zt,"linkType")}),Qde=lt(Xn,{name:Ve(Zt),email:Ife,link:b1}),Jde=lt(Xn,{name:Ve(Zt),desc:Ve(Zt),author:Ve(wfe),copyright:Ve(Sfe),link:b1,time:Ve(LE),keywords:Ve(Zt),bounds:Tfe,extensions:OE}),efe=lt(Xn,{year:Ve(Ap),license:Ve(Zt)}),tfe=lt(Xn,{rte:qe(Cfe),trk:qe(Pfe),wpt:qe(Mfe)});class nfe extends t7{constructor(e){super(),e=e||{},this.dataProjection=Bn("EPSG:4326"),this.readExtensions_=e.readExtensions}handleReadExtensions_(e){e||(e=[]);for(let t=0,r=e.length;t<r;++t){const i=e[t];if(this.readExtensions_){const s=i.get("extensionsNode_")||null;this.readExtensions_(i,s)}i.set("extensionsNode_",void 0)}}readMetadata(e){return e?typeof e=="string"?this.readMetadataFromDocument(Tl(e)):Sl(e)?this.readMetadataFromDocument(e):this.readMetadataFromNode(e):null}readMetadataFromDocument(e){for(let t=e.firstChild;t;t=t.nextSibling)if(t.nodeType===Node.ELEMENT_NODE){const r=this.readMetadataFromNode(t);if(r)return r}return null}readMetadataFromNode(e){if(!Xn.includes(e.namespaceURI))return null;for(let t=e.firstElementChild;t;t=t.nextElementSibling)if(Xn.includes(t.namespaceURI)&&t.localName==="metadata")return an({},Jde,t,[]);return null}readFeatureFromNode(e,t){if(!Xn.includes(e.namespaceURI))return null;const r=Xde[e.localName];if(!r)return null;const i=r(e,[this.getReadOptions(e,t)]);return i?(this.handleReadExtensions_([i]),i):null}readFeaturesFromNode(e,t){if(!Xn.includes(e.namespaceURI))return[];if(e.localName=="gpx"){const r=an([],qde,e,[this.getReadOptions(e,t)]);return r?(this.handleReadExtensions_(r),r):[]}return[]}writeFeaturesNode(e,t){t=this.adaptOptions(t);const r=dd("http://www.topografix.com/GPX/1/1","gpx");return r.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xsi",ov),r.setAttributeNS(ov,"xsi:schemaLocation",Yde),r.setAttribute("version","1.1"),r.setAttribute("creator","OpenLayers"),zn({node:r},tfe,Efe,e,[t]),r}}const rfe=lt(Xn,{name:Ve(Zt),cmt:Ve(Zt),desc:Ve(Zt),src:Ve(Zt),link:b1,number:Ve(Ap),extensions:OE,type:Ve(Zt),rtept:Afe}),ife=lt(Xn,{ele:Ve(yn),time:Ve(LE)}),sfe=lt(Xn,{name:Ve(Zt),cmt:Ve(Zt),desc:Ve(Zt),src:Ve(Zt),link:b1,number:Ve(Ap),type:Ve(Zt),extensions:OE,trkseg:Rfe}),afe=lt(Xn,{trkpt:bfe}),ofe=lt(Xn,{ele:Ve(yn),time:Ve(LE)}),lfe=lt(Xn,{ele:Ve(yn),time:Ve(LE),magvar:Ve(yn),geoidheight:Ve(yn),name:Ve(Zt),cmt:Ve(Zt),desc:Ve(Zt),src:Ve(Zt),link:b1,sym:Ve(Zt),type:Ve(Zt),fix:Ve(Zt),sat:Ve(Ap),hdop:Ve(yn),vdop:Ve(yn),pdop:Ve(yn),ageofdgpsdata:Ve(yn),dgpsid:Ve(Ap),extensions:OE}),cfe=["text","type"],ufe=lt(Xn,{text:qe(wn),type:qe(wn)}),hfe=lt(Xn,["name","cmt","desc","src","link","number","type","rtept"]),dfe=lt(Xn,{name:qe(wn),cmt:qe(wn),desc:qe(wn),src:qe(wn),link:qe(jR),number:qe(lv),type:qe(wn),rtept:Jj(qe(VR))}),ffe=lt(Xn,["ele","time"]),gfe=lt(Xn,["name","cmt","desc","src","link","number","type","trkseg"]),mfe=lt(Xn,{name:qe(wn),cmt:qe(wn),desc:qe(wn),src:qe(wn),link:qe(jR),number:qe(lv),type:qe(wn),trkseg:Jj(qe(kfe))}),pfe=ao("trkpt"),yfe=lt(Xn,{trkpt:qe(VR)}),_fe=lt(Xn,["ele","time","magvar","geoidheight","name","cmt","desc","src","link","sym","type","fix","sat","hdop","vdop","pdop","ageofdgpsdata","dgpsid"]),xfe=lt(Xn,{ele:qe(ds),time:qe($de),magvar:qe(ds),geoidheight:qe(ds),name:qe(wn),cmt:qe(wn),desc:qe(wn),src:qe(wn),link:qe(jR),sym:qe(wn),type:qe(wn),fix:qe(wn),sat:qe(lv),hdop:qe(ds),vdop:qe(ds),pdop:qe(ds),ageofdgpsdata:qe(ds),dgpsid:qe(lv)}),vfe={Point:"wpt",LineString:"rte",MultiLineString:"trk"};function Efe(n,e,t){const r=n.getGeometry();if(r){const i=vfe[r.getType()];if(i){const s=e[e.length-1].node;return dd(s.namespaceURI,i)}}}function DR(n,e,t,r){return n.push(parseFloat(t.getAttribute("lon")),parseFloat(t.getAttribute("lat"))),"ele"in r?(n.push(r.ele),delete r.ele,e.hasZ=!0):n.push(0),"time"in r?(n.push(r.time),delete r.time,e.hasM=!0):n.push(0),n}function FR(n,e,t){let r="XY",i=2;if(n.hasZ&&n.hasM?(r="XYZM",i=4):n.hasZ?(r="XYZ",i=3):n.hasM&&(r="XYM",i=3),i!==4){for(let s=0,a=e.length/4;s<a;s++)e[s*i]=e[s*4],e[s*i+1]=e[s*4+1],n.hasZ&&(e[s*i+2]=e[s*4+2]),n.hasM&&(e[s*i+2]=e[s*4+3]);if(e.length=e.length/4*i,t)for(let s=0,a=t.length;s<a;s++)t[s]=t[s]/4*i}return r}function wfe(n,e){const t=an({},Qde,n,e);if(t)return t}function Sfe(n,e){const t=an({},efe,n,e);if(t){const r=n.getAttribute("author");return r!==null&&(t.author=r),t}}function Tfe(n,e){const t=e[e.length-1],r=n.getAttribute("minlat"),i=n.getAttribute("minlon"),s=n.getAttribute("maxlat"),a=n.getAttribute("maxlon");i!==null&&r!==null&&a!==null&&s!==null&&(t.bounds=[[parseFloat(i),parseFloat(r)],[parseFloat(a),parseFloat(s)]])}function Ife(n,e){const t=e[e.length-1],r=n.getAttribute("id"),i=n.getAttribute("domain");r!==null&&i!==null&&(t.email=`${r}@${i}`)}function b1(n,e){const t=e[e.length-1],r=n.getAttribute("href");r!==null&&(t.link=r),Au(Zde,n,e)}function OE(n,e){const t=e[e.length-1];t.extensionsNode_=n}function Afe(n,e){const t=an({},ife,n,e);if(t){const r=e[e.length-1],i=r.flatCoordinates,s=r.layoutOptions;DR(i,s,n,t)}}function bfe(n,e){const t=an({},ofe,n,e);if(t){const r=e[e.length-1],i=r.flatCoordinates,s=r.layoutOptions;DR(i,s,n,t)}}function Rfe(n,e){const t=e[e.length-1];Au(afe,n,e);const r=t.flatCoordinates;t.ends.push(r.length)}function n7(n,e){const t=e[0],r=an({flatCoordinates:[],layoutOptions:{}},rfe,n,e);if(!r)return;const i=r.flatCoordinates;delete r.flatCoordinates;const s=r.layoutOptions;delete r.layoutOptions;const a=FR(s,i),o=new zo(i,a);io(o,!1,t);const l=new eo(o);return l.setProperties(r,!0),l}function r7(n,e){const t=e[0],r=an({flatCoordinates:[],ends:[],layoutOptions:{}},sfe,n,e);if(!r)return;const i=r.flatCoordinates;delete r.flatCoordinates;const s=r.ends;delete r.ends;const a=r.layoutOptions;delete r.layoutOptions;const o=FR(a,i,s),l=new iu(i,o,s);io(l,!1,t);const u=new eo(l);return u.setProperties(r,!0),u}function i7(n,e){const t=e[0],r=an({},lfe,n,e);if(!r)return;const i={},s=DR([],i,n,r),a=FR(i,s),o=new to(s,a);io(o,!1,t);const l=new eo(o);return l.setProperties(r,!0),l}function jR(n,e,t){n.setAttribute("href",e);const i=t[t.length-1].properties,s=[i.linkText,i.linkType];zn({node:n},ufe,Bi,s,t,cfe)}function VR(n,e,t){const r=t[t.length-1],s=r.node.namespaceURI,a=r.properties;switch(n.setAttributeNS(null,"lat",String(e[1])),n.setAttributeNS(null,"lon",String(e[0])),r.geometryLayout){case"XYZM":e[3]!==0&&(a.time=e[3]);case"XYZ":e[2]!==0&&(a.ele=e[2]);break;case"XYM":e[2]!==0&&(a.time=e[2]);break}const l=n.nodeName=="rtept"?ffe[s]:_fe[s],u=Ss(a,l);zn({node:n,properties:a},xfe,Bi,u,t,l)}function Cfe(n,e,t){const r=t[0],i=e.getProperties(),s={node:n};s.properties=i;const a=e.getGeometry();if(a.getType()=="LineString"){const h=io(a,!0,r);s.geometryLayout=h.getLayout(),i.rtept=h.getCoordinates()}const o=t[t.length-1].node,l=hfe[o.namespaceURI],u=Ss(i,l);zn(s,dfe,Bi,u,t,l)}function Pfe(n,e,t){const r=t[0],i=e.getProperties(),s={node:n};s.properties=i;const a=e.getGeometry();if(a.getType()=="MultiLineString"){const h=io(a,!0,r);i.trkseg=h.getLineStrings()}const o=t[t.length-1].node,l=gfe[o.namespaceURI],u=Ss(i,l);zn(s,mfe,Bi,u,t,l)}function kfe(n,e,t){const r={node:n};r.geometryLayout=e.getLayout(),r.properties={},zn(r,yfe,pfe,e.getCoordinates(),t)}function Mfe(n,e,t){const r=t[0],i=t[t.length-1];i.properties=e.getProperties();const s=e.getGeometry();if(s.getType()=="Point"){const a=io(s,!0,r);i.geometryLayout=a.getLayout(),VR(n,a.getCoordinates(),t)}}const Yl=["http://www.google.com/kml/ext/2.2"],Tt=[null,"http://earth.google.com/kml/2.0","http://earth.google.com/kml/2.1","http://earth.google.com/kml/2.2","http://www.opengis.net/kml/2.2"],Nfe="http://www.opengis.net/kml/2.2 https://developers.google.com/kml/schema/kml22gx.xsd",VL={fraction:"fraction",pixels:"pixels",insetPixels:"pixels"},Lfe=lt(Tt,{ExtendedData:x7,Region:v7,MultiGeometry:Ve(p7,"geometry"),LineString:Ve(g7,"geometry"),LinearRing:Ve(m7,"geometry"),Point:Ve(y7,"geometry"),Polygon:Ve(_7,"geometry"),Style:Ve(UR),StyleMap:y0e,address:Ve(Zt),description:Ve(Zt),name:Ve(Zt),open:Ve(pu),phoneNumber:Ve(Zt),styleUrl:Ve(c7),visibility:Ve(pu)},lt(Yl,{MultiTrack:Ve(i0e,"geometry"),Track:Ve(f7,"geometry")})),Ofe=lt(Tt,{ExtendedData:x7,Region:v7,Link:C0e,address:Ve(Zt),description:Ve(Zt),name:Ve(Zt),open:Ve(pu),phoneNumber:Ve(Zt),visibility:Ve(pu)}),Dfe=lt(Tt,{href:Ve(l7)}),Ffe=lt(Tt,{Altitude:Ve(yn),Longitude:Ve(yn),Latitude:Ve(yn),Tilt:Ve(yn),AltitudeMode:Ve(Zt),Heading:Ve(yn),Roll:Ve(yn)}),s7=lt(Tt,{LatLonAltBox:w0e,Lod:T0e}),jfe=lt(Tt,["Document","Placemark"]),Vfe=lt(Tt,{Document:qe(F0e),Placemark:qe(S7)});let Xf,Y_=null,PI,km,Mm,Nm,cv,kI=null,GR,MI=null,NI,vh=null,GL=null,LI=null;function uv(n){return 32/Math.min(n[0],n[1])}function Gfe(){Xf=[255,255,255,1],Y_=new oi({color:Xf}),PI=[20,2],km="pixels",Mm="pixels",Nm=[64,64],cv="https://maps.google.com/mapfiles/kml/pushpin/ylw-pushpin.png",kI=new Hp({anchor:PI,anchorOrigin:"bottom-left",anchorXUnits:km,anchorYUnits:Mm,crossOrigin:"anonymous",rotation:0,scale:uv(Nm),size:Nm,src:cv}),GR="NO_IMAGE",MI=new _s({color:Xf,width:1}),NI=new _s({color:[51,51,51,1],width:2}),vh=new sd({font:"bold 16px Helvetica",fill:Y_,stroke:NI,scale:.8}),GL=new ur({fill:Y_,image:kI,text:vh,stroke:MI,zIndex:0}),LI=[GL]}let d_;function Bfe(n){return n}class Ufe extends t7{constructor(e){super(),e=e||{},LI||Gfe(),this.dataProjection=Bn("EPSG:4326"),this.defaultStyle_=e.defaultStyle?e.defaultStyle:LI,this.extractStyles_=e.extractStyles!==void 0?e.extractStyles:!0,this.writeStyles_=e.writeStyles!==void 0?e.writeStyles:!0,this.sharedStyles_={},this.showPointNames_=e.showPointNames!==void 0?e.showPointNames:!0,this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",this.iconUrlFunction_=e.iconUrlFunction?e.iconUrlFunction:Bfe,this.supportedMediaTypes=["application/vnd.google-earth.kml+xml"]}readDocumentOrFolder_(e,t){const r=lt(Tt,{Document:jL(this.readDocumentOrFolder_,this),Folder:jL(this.readDocumentOrFolder_,this),Placemark:$a(this.readPlacemark_,this),Style:this.readSharedStyle_.bind(this),StyleMap:this.readSharedStyleMap_.bind(this)}),i=an([],r,e,t,this);if(i)return i}readPlacemark_(e,t){const r=an({geometry:null},Lfe,e,t,this);if(!r)return;const i=new eo,s=e.getAttribute("id");s!==null&&i.setId(s);const a=t[0],o=r.geometry;if(o&&io(o,!1,a),i.setGeometry(o),delete r.geometry,this.extractStyles_){const l=r.Style,u=r.styleUrl,h=$fe(l,u,this.defaultStyle_,this.sharedStyles_,this.showPointNames_);i.setStyle(h)}return delete r.Style,i.setProperties(r,!0),i}readSharedStyle_(e,t){const r=e.getAttribute("id");if(r!==null){const i=UR.call(this,e,t);if(i){let s,a=e.baseURI;(!a||a=="about:blank")&&(a=window.location.href),a?s=new URL("#"+r,a).href:s="#"+r,this.sharedStyles_[s]=i}}}readSharedStyleMap_(e,t){const r=e.getAttribute("id");if(r===null)return;const i=h7.call(this,e,t);if(!i)return;let s,a=e.baseURI;(!a||a=="about:blank")&&(a=window.location.href),a?s=new URL("#"+r,a).href:s="#"+r,this.sharedStyles_[s]=i}readFeatureFromNode(e,t){if(!Tt.includes(e.namespaceURI))return null;const r=this.readPlacemark_(e,[this.getReadOptions(e,t)]);return r||null}readFeaturesFromNode(e,t){if(!Tt.includes(e.namespaceURI))return[];let r;const i=e.localName;if(i=="Document"||i=="Folder")return r=this.readDocumentOrFolder_(e,[this.getReadOptions(e,t)]),r||[];if(i=="Placemark"){const s=this.readPlacemark_(e,[this.getReadOptions(e,t)]);return s?[s]:[]}if(i=="kml"){r=[];for(let s=e.firstElementChild;s;s=s.nextElementSibling){const a=this.readFeaturesFromNode(s,t);a&&An(r,a)}return r}return[]}readName(e){if(e){if(typeof e=="string"){const t=Tl(e);return this.readNameFromDocument(t)}return Sl(e)?this.readNameFromDocument(e):this.readNameFromNode(e)}}readNameFromDocument(e){for(let t=e.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE){const r=this.readNameFromNode(t);if(r)return r}}readNameFromNode(e){for(let t=e.firstElementChild;t;t=t.nextElementSibling)if(Tt.includes(t.namespaceURI)&&t.localName=="name")return Zt(t);for(let t=e.firstElementChild;t;t=t.nextElementSibling){const r=t.localName;if(Tt.includes(t.namespaceURI)&&(r=="Document"||r=="Folder"||r=="Placemark"||r=="kml")){const i=this.readNameFromNode(t);if(i)return i}}}readNetworkLinks(e){const t=[];if(typeof e=="string"){const r=Tl(e);An(t,this.readNetworkLinksFromDocument(r))}else Sl(e)?An(t,this.readNetworkLinksFromDocument(e)):An(t,this.readNetworkLinksFromNode(e));return t}readNetworkLinksFromDocument(e){const t=[];for(let r=e.firstChild;r;r=r.nextSibling)r.nodeType==Node.ELEMENT_NODE&&An(t,this.readNetworkLinksFromNode(r));return t}readNetworkLinksFromNode(e){const t=[];for(let r=e.firstElementChild;r;r=r.nextElementSibling)if(Tt.includes(r.namespaceURI)&&r.localName=="NetworkLink"){const i=an({},Ofe,r,[]);t.push(i)}for(let r=e.firstElementChild;r;r=r.nextElementSibling){const i=r.localName;Tt.includes(r.namespaceURI)&&(i=="Document"||i=="Folder"||i=="kml")&&An(t,this.readNetworkLinksFromNode(r))}return t}readRegion(e){const t=[];if(typeof e=="string"){const r=Tl(e);An(t,this.readRegionFromDocument(r))}else Sl(e)?An(t,this.readRegionFromDocument(e)):An(t,this.readRegionFromNode(e));return t}readRegionFromDocument(e){const t=[];for(let r=e.firstChild;r;r=r.nextSibling)r.nodeType==Node.ELEMENT_NODE&&An(t,this.readRegionFromNode(r));return t}readRegionFromNode(e){const t=[];for(let r=e.firstElementChild;r;r=r.nextElementSibling)if(Tt.includes(r.namespaceURI)&&r.localName=="Region"){const i=an({},s7,r,[]);t.push(i)}for(let r=e.firstElementChild;r;r=r.nextElementSibling){const i=r.localName;Tt.includes(r.namespaceURI)&&(i=="Document"||i=="Folder"||i=="kml")&&An(t,this.readRegionFromNode(r))}return t}readCamera(e){const t=[];if(typeof e=="string"){const r=Tl(e);An(t,this.readCameraFromDocument(r))}else Sl(e)?An(t,this.readCameraFromDocument(e)):An(t,this.readCameraFromNode(e));return t}readCameraFromDocument(e){const t=[];for(let r=e.firstChild;r;r=r.nextSibling)r.nodeType===Node.ELEMENT_NODE&&An(t,this.readCameraFromNode(r));return t}readCameraFromNode(e){const t=[];for(let r=e.firstElementChild;r;r=r.nextElementSibling)if(Tt.includes(r.namespaceURI)&&r.localName==="Camera"){const i=an({},Ffe,r,[]);t.push(i)}for(let r=e.firstElementChild;r;r=r.nextElementSibling){const i=r.localName;Tt.includes(r.namespaceURI)&&(i==="Document"||i==="Folder"||i==="Placemark"||i==="kml")&&An(t,this.readCameraFromNode(r))}return t}writeFeaturesNode(e,t){t=this.adaptOptions(t);const r=dd(Tt[4],"kml"),i="http://www.w3.org/2000/xmlns/";r.setAttributeNS(i,"xmlns:gx",Yl[0]),r.setAttributeNS(i,"xmlns:xsi",ov),r.setAttributeNS(ov,"xsi:schemaLocation",Nfe);const s={node:r},a={};e.length>1?a.Document=e:e.length==1&&(a.Placemark=e[0]);const o=jfe[r.namespaceURI],l=Ss(a,o);return zn(s,Vfe,Bi,l,[t],o,this),r}}function zfe(n,e){const t=[0,0];let r="start";const i=n.getImage();if(i){const o=i.getSize();if(o&&o.length==2){const l=i.getScaleArray(),u=i.getAnchor();t[0]=l[0]*(o[0]-u[0]),t[1]=l[1]*(o[1]/2-u[1]),r="left"}}let s=n.getText();return s?(s=s.clone(),s.setFont(s.getFont()||vh.getFont()),s.setScale(s.getScale()||vh.getScale()),s.setFill(s.getFill()||vh.getFill()),s.setStroke(s.getStroke()||NI)):s=vh.clone(),s.setText(e),s.setOffsetX(t[0]),s.setOffsetY(t[1]),s.setTextAlign(r),new ur({image:i,text:s})}function $fe(n,e,t,r,i){return(function(s,a){let o=i,l="",u=[];if(o){const f=s.getGeometry();if(f)if(f instanceof qa)u=f.getGeometriesArrayRecursive().filter(function(g){const p=g.getType();return p==="Point"||p==="MultiPoint"}),o=u.length>0;else{const g=f.getType();o=g==="Point"||g==="MultiPoint"}}o&&(l=s.get("name"),o=o&&!!l,o&&/&[^&]+;/.test(l)&&(d_||(d_=document.createElement("textarea")),d_.innerHTML=l,l=d_.value));let h=t;if(n?h=n:e&&(h=a7(e,t,r)),o){const f=zfe(h[0],l);if(u.length>0){f.setGeometry(new qa(u));const g=new ur({geometry:h[0].getGeometry(),image:null,fill:h[0].getFill(),stroke:h[0].getStroke(),text:null});return[f,g].concat(h.slice(1))}return f}return h})}function a7(n,e,t){return Array.isArray(n)?n:typeof n=="string"?a7(t[n],e,t):e}function DE(n){const e=so(n,!1),t=/^\s*#?\s*([0-9A-Fa-f]{8})\s*$/.exec(e);if(t){const r=t[1];return[parseInt(r.substr(6,2),16),parseInt(r.substr(4,2),16),parseInt(r.substr(2,2),16),parseInt(r.substr(0,2),16)/255]}}function o7(n){let e=so(n,!1);const t=[];e=e.replace(/\s*,\s*/g,",");const r=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?),([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s+|,|$)(?:([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s+|$))?\s*/i;let i;for(;i=r.exec(e);){const s=parseFloat(i[1]),a=parseFloat(i[2]),o=i[3]?parseFloat(i[3]):0;t.push(s,a,o),e=e.substr(i[0].length)}if(e==="")return t}function l7(n){const e=so(n,!1).trim();let t=n.baseURI;return(!t||t=="about:blank")&&(t=window.location.href),t?new URL(e,t).href:e}function c7(n){const e=so(n,!1).trim().replace(/^(?!.*#)/,"#");let t=n.baseURI;return(!t||t=="about:blank")&&(t=window.location.href),t?new URL(e,t).href:e}function Wfe(n){const e=n.getAttribute("xunits"),t=n.getAttribute("yunits");let r;return e!=="insetPixels"?t!=="insetPixels"?r="bottom-left":r="top-left":t!=="insetPixels"?r="bottom-right":r="top-right",{x:parseFloat(n.getAttribute("x")),xunits:VL[e],y:parseFloat(n.getAttribute("y")),yunits:VL[t],origin:r}}function u7(n){return yn(n)}const Hfe=lt(Tt,{Pair:p0e});function h7(n,e){return an(void 0,Hfe,n,e,this)}const Kfe=lt(Tt,{Icon:Ve(o0e),color:Ve(DE),heading:Ve(yn),hotSpot:Ve(Wfe),scale:Ve(u7)});function Yfe(n,e){const t=an({},Kfe,n,e);if(!t)return;const r=e[e.length-1],i="Icon"in t?t.Icon:{},s=!("Icon"in t)||Object.keys(i).length>0;let a;const o=i.href;o?a=o:s&&(a=cv);let l,u,h,f="bottom-left";const g=t.hotSpot;g?(l=[g.x,g.y],u=g.xunits,h=g.yunits,f=g.origin):/^https?:\/\/maps\.(?:google|gstatic)\.com\//.test(a)&&(a.includes("pushpin")?(l=PI,u=km,h=Mm):a.includes("arrow-reverse")?(l=[54,42],u=km,h=Mm):a.includes("paddle")&&(l=[32,1],u=km,h=Mm));let p;const E=i.x,x=i.y;E!==void 0&&x!==void 0&&(p=[E,x]);let w;const T=i.w,I=i.h;T!==void 0&&I!==void 0&&(w=[T,I]);let P;const N=t.heading;N!==void 0&&(P=bl(N));const D=t.scale,B=t.color;if(s){a==cv&&(w=Nm);const k=new Hp({anchor:l,anchorOrigin:f,anchorXUnits:u,anchorYUnits:h,crossOrigin:this.crossOrigin_,offset:p,offsetOrigin:"bottom-left",rotation:P,scale:D,size:w,src:this.iconUrlFunction_(a),color:B}),C=k.getScaleArray()[0],M=k.getSize();if(M===null){const j=k.getImageState();if(j===pt.IDLE||j===pt.LOADING){const O=function(){const W=k.getImageState();if(!(W===pt.IDLE||W===pt.LOADING)){const F=k.getSize();if(F&&F.length==2){const Te=uv(F);k.setScale(C*Te)}k.unlistenImageChange(O)}};k.listenImageChange(O),j===pt.IDLE&&k.load()}}else if(M.length==2){const j=uv(M);k.setScale(C*j)}r.imageStyle=k}else r.imageStyle=GR}const Xfe=lt(Tt,{color:Ve(DE),scale:Ve(u7)});function qfe(n,e){const t=an({},Xfe,n,e);if(!t)return;const r=e[e.length-1],i=new sd({fill:new oi({color:"color"in t?t.color:Xf}),scale:t.scale});r.textStyle=i}const Zfe=lt(Tt,{color:Ve(DE),width:Ve(yn)});function Qfe(n,e){const t=an({},Zfe,n,e);if(!t)return;const r=e[e.length-1],i=new _s({color:"color"in t?t.color:Xf,width:"width"in t?t.width:1});r.strokeStyle=i}const Jfe=lt(Tt,{color:Ve(DE),fill:Ve(pu),outline:Ve(pu)});function e0e(n,e){const t=an({},Jfe,n,e);if(!t)return;const r=e[e.length-1],i=new oi({color:"color"in t?t.color:Xf});r.fillStyle=i;const s=t.fill;s!==void 0&&(r.fill=s);const a=t.outline;a!==void 0&&(r.outline=a)}const t0e=lt(Tt,{coordinates:OR(o7)});function d7(n,e){return an(null,t0e,n,e)}function n0e(n,e){const r=e[e.length-1].coordinates,i=so(n,!1),a=/^\s*([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s*$/i.exec(i);if(a){const o=parseFloat(a[1]),l=parseFloat(a[2]),u=parseFloat(a[3]);r.push([o,l,u])}else r.push([])}const r0e=lt(Yl,{Track:$a(f7)});function i0e(n,e){const t=an([],r0e,n,e);if(t)return new iu(t)}const s0e=lt(Tt,{when:P0e},lt(Yl,{coord:n0e}));function f7(n,e){const t=an({coordinates:[],whens:[]},s0e,n,e);if(!t)return;const r=[],i=t.coordinates,s=t.whens;for(let a=0,o=Math.min(i.length,s.length);a<o;++a)i[a].length==3&&r.push(i[a][0],i[a][1],i[a][2],s[a]);return new zo(r,"XYZM")}const a0e=lt(Tt,{href:Ve(l7)},lt(Yl,{x:Ve(yn),y:Ve(yn),w:Ve(yn),h:Ve(yn)}));function o0e(n,e){const t=an({},a0e,n,e);return t||null}const l0e=lt(Tt,{coordinates:OR(o7)});function BR(n,e){return an(null,l0e,n,e)}const FE=lt(Tt,{extrude:Ve(pu),tessellate:Ve(pu),altitudeMode:Ve(Zt)});function g7(n,e){const t=an({},FE,n,e),r=BR(n,e);if(r){const i=new zo(r,"XYZ");return i.setProperties(t,!0),i}}function m7(n,e){const t=an({},FE,n,e),r=BR(n,e);if(r){const i=new no(r,"XYZ",[r.length]);return i.setProperties(t,!0),i}}const c0e=lt(Tt,{LineString:$a(g7),LinearRing:$a(m7),MultiGeometry:$a(p7),Point:$a(y7),Polygon:$a(_7)});function p7(n,e){const t=an([],c0e,n,e);if(!t)return null;if(t.length===0)return new qa(t);let r,i=!0;const s=t[0].getType();let a;for(let o=1,l=t.length;o<l;++o)if(a=t[o],a.getType()!=s){i=!1;break}if(i){let o,l;if(s=="Point"){const u=t[0];o=u.getLayout(),l=u.getFlatCoordinates();for(let h=1,f=t.length;h<f;++h)a=t[h],An(l,a.getFlatCoordinates());r=new P0(l,o),NS(r,t)}else if(s=="LineString")r=new iu(t),NS(r,t);else if(s=="Polygon")r=new o0(t),NS(r,t);else if(s=="GeometryCollection"||s.startsWith("Multi"))r=new qa(t);else throw new Error("Unknown geometry type found")}else r=new qa(t);return r}function y7(n,e){const t=an({},FE,n,e),r=BR(n,e);if(r){const i=new to(r,"XYZ");return i.setProperties(t,!0),i}}const u0e=lt(Tt,{innerBoundaryIs:A0e,outerBoundaryIs:R0e});function _7(n,e){const t=an({},FE,n,e),r=an([null],u0e,n,e);if(r&&r[0]){const i=r[0],s=[i.length];for(let o=1,l=r.length;o<l;++o)An(i,r[o]),s.push(i.length);const a=new no(i,"XYZ",s);return a.setProperties(t,!0),a}}const h0e=lt(Tt,{IconStyle:Yfe,LabelStyle:qfe,LineStyle:Qfe,PolyStyle:e0e});function UR(n,e){const t=an({},h0e,n,e,this);if(!t)return null;let r="fillStyle"in t?t.fillStyle:Y_;const i=t.fill;i!==void 0&&!i&&(r=null);let s;"imageStyle"in t?t.imageStyle!=GR&&(s=t.imageStyle):s=kI;const a="textStyle"in t?t.textStyle:vh,o="strokeStyle"in t?t.strokeStyle:MI,l=t.outline;return l!==void 0&&!l?[new ur({geometry:function(u){const h=u.getGeometry(),f=h.getType();if(f==="GeometryCollection"){const g=h;return new qa(g.getGeometriesArrayRecursive().filter(function(p){const E=p.getType();return E!=="Polygon"&&E!=="MultiPolygon"}))}if(f!=="Polygon"&&f!=="MultiPolygon")return h},fill:r,image:s,stroke:o,text:a,zIndex:void 0}),new ur({geometry:function(u){const h=u.getGeometry(),f=h.getType();if(f==="GeometryCollection"){const g=h;return new qa(g.getGeometriesArrayRecursive().filter(function(p){const E=p.getType();return E==="Polygon"||E==="MultiPolygon"}))}if(f==="Polygon"||f==="MultiPolygon")return h},fill:r,stroke:null,zIndex:void 0})]:[new ur({fill:r,image:s,stroke:o,text:a,zIndex:void 0})]}function NS(n,e){const t=e.length,r=new Array(e.length),i=new Array(e.length),s=new Array(e.length);let a,o,l;a=!1,o=!1,l=!1;for(let u=0;u<t;++u){const h=e[u];r[u]=h.get("extrude"),i[u]=h.get("tessellate"),s[u]=h.get("altitudeMode"),a=a||r[u]!==void 0,o=o||i[u]!==void 0,l=l||s[u]}a&&n.set("extrude",r),o&&n.set("tessellate",i),l&&n.set("altitudeMode",s)}const d0e=lt(Tt,{displayName:Ve(Zt),value:Ve(Zt)});function f0e(n,e){const t=n.getAttribute("name");Au(d0e,n,e);const r=e[e.length-1];t&&r.displayName?r[t]={value:r.value,displayName:r.displayName,toString:function(){return r.value}}:t!==null?r[t]=r.value:r.displayName!==null&&(r[r.displayName]=r.value),delete r.value}const g0e=lt(Tt,{Data:f0e,SchemaData:x0e});function x7(n,e){Au(g0e,n,e)}function v7(n,e){Au(s7,n,e)}const m0e=lt(Tt,{Style:Ve(UR),key:Ve(Zt),styleUrl:Ve(c7)});function p0e(n,e){const t=an({},m0e,n,e,this);if(!t)return;const r=t.key;if(r&&r=="normal"){const i=t.styleUrl;i&&(e[e.length-1]=i);const s=t.Style;s&&(e[e.length-1]=s)}}function y0e(n,e){const t=h7.call(this,n,e);if(!t)return;const r=e[e.length-1];if(Array.isArray(t))r.Style=t;else if(typeof t=="string")r.styleUrl=t;else throw new Error("`styleMapValue` has an unknown type")}const _0e=lt(Tt,{SimpleData:v0e});function x0e(n,e){Au(_0e,n,e)}function v0e(n,e){const t=n.getAttribute("name");if(t!==null){const r=Zt(n),i=e[e.length-1];i[t]=r}}const E0e=lt(Tt,{altitudeMode:Ve(Zt),minAltitude:Ve(yn),maxAltitude:Ve(yn),north:Ve(yn),south:Ve(yn),east:Ve(yn),west:Ve(yn)});function w0e(n,e){const t=an({},E0e,n,e);if(!t)return;const r=e[e.length-1],i=[parseFloat(t.west),parseFloat(t.south),parseFloat(t.east),parseFloat(t.north)];r.extent=i,r.altitudeMode=t.altitudeMode,r.minAltitude=parseFloat(t.minAltitude),r.maxAltitude=parseFloat(t.maxAltitude)}const S0e=lt(Tt,{minLodPixels:Ve(yn),maxLodPixels:Ve(yn),minFadeExtent:Ve(yn),maxFadeExtent:Ve(yn)});function T0e(n,e){const t=an({},S0e,n,e);if(!t)return;const r=e[e.length-1];r.minLodPixels=parseFloat(t.minLodPixels),r.maxLodPixels=parseFloat(t.maxLodPixels),r.minFadeExtent=parseFloat(t.minFadeExtent),r.maxFadeExtent=parseFloat(t.maxFadeExtent)}const I0e=lt(Tt,{LinearRing:$a(d7)});function A0e(n,e){const t=an([],I0e,n,e);t.length>0&&e[e.length-1].push(...t)}const b0e=lt(Tt,{LinearRing:OR(d7)});function R0e(n,e){const t=an(void 0,b0e,n,e);if(t){const r=e[e.length-1];r[0]=t}}function C0e(n,e){Au(Dfe,n,e)}function P0e(n,e){const r=e[e.length-1].whens,i=so(n,!1),s=Date.parse(i);r.push(isNaN(s)?0:s)}function jE(n,e){const t=Oh(e),i=[(t.length==4?t[3]:1)*255,t[2],t[1],t[0]];for(let s=0;s<4;++s){const a=Math.floor(i[s]).toString(16);i[s]=a.length==1?"0"+a:a}wn(n,i.join(""))}function k0e(n,e,t){const r=t[t.length-1],i=r.layout,s=r.stride;let a;if(i=="XY"||i=="XYM")a=2;else if(i=="XYZ"||i=="XYZM")a=3;else throw new Error("Invalid geometry layout");const o=e.length;let l="";if(o>0){l+=e[0];for(let u=1;u<a;++u)l+=","+e[u];for(let u=s;u<o;u+=s){l+=" "+e[u];for(let h=1;h<a;++h)l+=","+e[u+h]}}wn(n,l)}const X_=lt(Tt,{Data:qe(M0e),value:qe(L0e),displayName:qe(N0e)});function M0e(n,e,t){n.setAttribute("name",e.name);const r={node:n},i=e.value;typeof i=="object"?(i!==null&&i.displayName&&zn(r,X_,Bi,[i.displayName],t,["displayName"]),i!==null&&i.value&&zn(r,X_,Bi,[i.value],t,["value"])):zn(r,X_,Bi,[i],t,["value"])}function N0e(n,e){wn(n,e)}function L0e(n,e){wn(n,e)}const O0e=lt(Tt,{Placemark:qe(S7)}),D0e=function(n,e,t){const r=e[e.length-1].node;return dd(r.namespaceURI,"Placemark")};function F0e(n,e,t){zn({node:n},O0e,D0e,e,t,void 0,this)}const j0e=ao("Data");function V0e(n,e,t){const r={node:n},i=e.names,s=e.values,a=i.length;for(let o=0;o<a;o++)zn(r,X_,j0e,[{name:i[o],value:s[o]}],t)}const BL=lt(Tt,["href"],lt(Yl,["x","y","w","h"])),UL=lt(Tt,{href:qe(wn)},lt(Yl,{x:qe(ds),y:qe(ds),w:qe(ds),h:qe(ds)})),G0e=function(n,e,t){return dd(Yl[0],"gx:"+t)};function B0e(n,e,t){const r={node:n},i=t[t.length-1].node;let s=BL[i.namespaceURI],a=Ss(e,s);zn(r,UL,Bi,a,t,s),s=BL[Yl[0]],a=Ss(e,s),zn(r,UL,G0e,a,t,s)}const U0e=lt(Tt,["scale","heading","Icon","color","hotSpot"]),z0e=lt(Tt,{Icon:qe(B0e),color:qe(jE),heading:qe(ds),hotSpot:qe(pge),scale:qe(I7)});function $0e(n,e,t){const r={node:n},i={},s=e.getSrc(),a=e.getSize(),o=e.getImageSize(),l={href:s};if(a){l.w=a[0],l.h=a[1];const w=e.getAnchor(),T=e.getOrigin();if(T&&o&&T[0]!==0&&T[1]!==a[1]&&(l.x=T[0],l.y=o[1]-(T[1]+a[1])),w&&(w[0]!==a[0]/2||w[1]!==a[1]/2)){const I={x:w[0],xunits:"pixels",y:a[1]-w[1],yunits:"pixels"};i.hotSpot=I}}i.Icon=l;let u=e.getScaleArray()[0],h=a;if(h===null&&(h=Nm),h.length==2){const w=uv(h);u=u/w}u!==1&&(i.scale=u);const f=e.getRotation();f!==0&&(i.heading=f);const g=e.getColor();g&&(i.color=g);const p=t[t.length-1].node,E=U0e[p.namespaceURI],x=Ss(i,E);zn(r,z0e,Bi,x,t,E)}const W0e=lt(Tt,["color","scale"]),H0e=lt(Tt,{color:qe(jE),scale:qe(I7)});function K0e(n,e,t){const r={node:n},i={},s=e.getFill();s&&(i.color=s.getColor());const a=e.getScale();a&&a!==1&&(i.scale=a);const o=t[t.length-1].node,l=W0e[o.namespaceURI],u=Ss(i,l);zn(r,H0e,Bi,u,t,l)}const Y0e=lt(Tt,["color","width"]),X0e=lt(Tt,{color:qe(jE),width:qe(ds)});function q0e(n,e,t){const r={node:n},i={color:e.getColor(),width:Number(e.getWidth())||1},s=t[t.length-1].node,a=Y0e[s.namespaceURI],o=Ss(i,a);zn(r,X0e,Bi,o,t,a)}const Z0e={Point:"Point",LineString:"LineString",LinearRing:"LinearRing",Polygon:"Polygon",MultiPoint:"MultiGeometry",MultiLineString:"MultiGeometry",MultiPolygon:"MultiGeometry",GeometryCollection:"MultiGeometry"},E7=function(n,e,t){if(n){const r=e[e.length-1].node;return dd(r.namespaceURI,Z0e[n.getType()])}},Q0e=ao("Point"),J0e=ao("LineString"),ege=ao("LinearRing"),tge=ao("Polygon"),nge=lt(Tt,{LineString:qe(qf),Point:qe(qf),Polygon:qe(T7),GeometryCollection:qe(w7)});function w7(n,e,t){const r={node:n},i=e.getType();let s=[],a;if(i==="GeometryCollection")e.getGeometriesArrayRecursive().forEach(function(o){const l=o.getType();if(l==="MultiPoint")s=s.concat(o.getPoints());else if(l==="MultiLineString")s=s.concat(o.getLineStrings());else if(l==="MultiPolygon")s=s.concat(o.getPolygons());else if(l==="Point"||l==="LineString"||l==="Polygon")s.push(o);else throw new Error("Unknown geometry type")}),a=E7;else if(i==="MultiPoint")s=e.getPoints(),a=Q0e;else if(i==="MultiLineString")s=e.getLineStrings(),a=J0e;else if(i==="MultiPolygon")s=e.getPolygons(),a=tge;else throw new Error("Unknown geometry type");zn(r,nge,a,s,t)}const rge=lt(Tt,{LinearRing:qe(qf)});function zL(n,e,t){zn({node:n},rge,ege,[e],t)}const LS=lt(Tt,{ExtendedData:qe(V0e),MultiGeometry:qe(w7),LineString:qe(qf),LinearRing:qe(qf),Point:qe(qf),Polygon:qe(T7),Style:qe(mge),address:qe(wn),description:qe(wn),name:qe(wn),open:qe(b0),phoneNumber:qe(wn),styleUrl:qe(wn),visibility:qe(b0)}),ige=lt(Tt,["name","open","visibility","address","phoneNumber","description","styleUrl","Style"]),sge=ao("ExtendedData");function S7(n,e,t){const r={node:n};e.getId()&&n.setAttribute("id",e.getId());const i=e.getProperties(),s={address:1,description:1,name:1,open:1,phoneNumber:1,styleUrl:1,visibility:1};s[e.getGeometryName()]=1;const a=Object.keys(i||{}).sort().filter(function(p){return!s[p]}),o=e.getStyleFunction();if(o){const p=o(e,0);if(p){const E=Array.isArray(p)?p:[p];let x=E;if(e.getGeometry()&&(x=E.filter(function(w){const T=w.getGeometryFunction()(e);if(T){const I=T.getType();return I==="GeometryCollection"?T.getGeometriesArrayRecursive().filter(function(P){const N=P.getType();return N==="Point"||N==="MultiPoint"}).length:I==="Point"||I==="MultiPoint"}})),this.writeStyles_){let w=E,T=E;e.getGeometry()&&(w=E.filter(function(I){const P=I.getGeometryFunction()(e);if(P){const N=P.getType();return N==="GeometryCollection"?P.getGeometriesArrayRecursive().filter(function(D){const B=D.getType();return B==="LineString"||B==="MultiLineString"}).length:N==="LineString"||N==="MultiLineString"}}),T=E.filter(function(I){const P=I.getGeometryFunction()(e);if(P){const N=P.getType();return N==="GeometryCollection"?P.getGeometriesArrayRecursive().filter(function(D){const B=D.getType();return B==="Polygon"||B==="MultiPolygon"}).length:N==="Polygon"||N==="MultiPolygon"}})),i.Style={pointStyles:x,lineStyles:w,polyStyles:T}}if(x.length&&i.name===void 0){const w=x[0].getText();w&&(i.name=w.getText())}}}const l=t[t.length-1].node,u=ige[l.namespaceURI],h=Ss(i,u);if(zn(r,LS,Bi,h,t,u),a.length>0){const p=Ss(i,a);zn(r,LS,sge,[{names:a,values:p}],t)}const f=t[0];let g=e.getGeometry();g&&(g=io(g,!0,f)),zn(r,LS,E7,[g],t)}const age=lt(Tt,["extrude","tessellate","altitudeMode","coordinates"]),oge=lt(Tt,{extrude:qe(b0),tessellate:qe(b0),altitudeMode:qe(wn),coordinates:qe(k0e)});function qf(n,e,t){const r=e.getFlatCoordinates(),i={node:n};i.layout=e.getLayout(),i.stride=e.getStride();const s=e.getProperties();s.coordinates=r;const a=t[t.length-1].node,o=age[a.namespaceURI],l=Ss(s,o);zn(i,oge,Bi,l,t,o)}const lge=lt(Tt,["color","fill","outline"]),$L=lt(Tt,{outerBoundaryIs:qe(zL),innerBoundaryIs:qe(zL)}),cge=ao("innerBoundaryIs"),uge=ao("outerBoundaryIs");function T7(n,e,t){const r=e.getLinearRings(),i=r.shift(),s={node:n};zn(s,$L,cge,r,t),zn(s,$L,uge,[i],t)}const hge=lt(Tt,{color:qe(jE),fill:qe(b0),outline:qe(b0)});function dge(n,e,t){const r={node:n},i=e.getFill(),s=e.getStroke(),a={color:i?i.getColor():void 0,fill:i?void 0:!1,outline:s?void 0:!1},o=t[t.length-1].node,l=lge[o.namespaceURI],u=Ss(a,l);zn(r,hge,Bi,u,t,l)}function I7(n,e){ds(n,Math.round(e*1e6)/1e6)}const fge=lt(Tt,["IconStyle","LabelStyle","LineStyle","PolyStyle"]),gge=lt(Tt,{IconStyle:qe($0e),LabelStyle:qe(K0e),LineStyle:qe(q0e),PolyStyle:qe(dge)});function mge(n,e,t){const r={node:n},i={};if(e.pointStyles.length){const l=e.pointStyles[0].getText();l&&(i.LabelStyle=l);const u=e.pointStyles[0].getImage();u&&typeof u.getSrc=="function"&&(i.IconStyle=u)}if(e.lineStyles.length){const l=e.lineStyles[0].getStroke();l&&(i.LineStyle=l)}if(e.polyStyles.length){const l=e.polyStyles[0].getStroke();l&&!i.LineStyle&&(i.LineStyle=l),i.PolyStyle=e.polyStyles[0]}const s=t[t.length-1].node,a=fge[s.namespaceURI],o=Ss(i,a);zn(r,gge,Bi,o,t,a)}function pge(n,e){n.setAttribute("x",String(e.x)),n.setAttribute("y",String(e.y)),n.setAttribute("xunits",e.xunits),n.setAttribute("yunits",e.yunits)}function A7(n){const e=Object.keys(n.defs),t=e.length;let r,i;for(r=0;r<t;++r){const s=e[r];if(!w_(s)){const a=n.defs(s);let o=a.units;!o&&a.projName==="longlat"&&(o="degrees"),nx(new Mv({code:s,axisOrientation:a.axis,metersPerUnit:a.to_meter,units:o}))}}for(r=0;r<t;++r){const s=e[r],a=w_(s);for(i=0;i<t;++i){const o=e[i],l=w_(o);if(!S_(s,o))if(n.defs[s]===n.defs[o])QS([a,l]);else{const u=n(s,o);dU(a,l,B4(a,l,u.forward),B4(l,a,u.inverse))}}}}console.log(" parcelHighlight.ts v3.1 loaded - fixed pixelRatio for Android");gn.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs");A7(gn);let Eh=null,Lm=null,Tf=null;function OI(n){Eh&&(n.removeLayer(Eh),Eh=null),Lm&&(n.removeLayer(Lm),Lm=null),Tf=null}async function yge(n,e){try{const t=fn(e);console.log(` Click (3857): ${e[0].toFixed(0)}, ${e[1].toFixed(0)}`),console.log(` LonLat (WGS84): ${t[0].toFixed(5)}, ${t[1].toFixed(5)}`);const r=gn("EPSG:4326","EPSG:28992",t);if(console.log(` RD (28992): ${r?r[0].toFixed(0)+", "+r[1].toFixed(0):"FAILED"}`),!r||r[0]<7e3||r[0]>3e5||r[1]<289e3||r[1]>629e3)return console.error(" Coordinate outside Netherlands or transformation failed:",r),!1;OI(n);const i=1,s=`${r[0]-i},${r[1]-i},${r[0]+i},${r[1]+i}`,a=Date.now(),o=`https://service.pdok.nl/rvo/brpgewaspercelen/wfs/v1_0?SERVICE=WFS&VERSION=2.0.0&REQUEST=GetFeature&TYPENAMES=brpgewaspercelen:BrpGewas&OUTPUTFORMAT=json&SRSNAME=EPSG:28992&BBOX=${s},EPSG:28992&_=${a}`;console.log(" WFS URL:",o);const l=new AbortController,u=setTimeout(()=>l.abort(),1e4),h=await fetch(o,{signal:l.signal});if(clearTimeout(u),!h.ok)return console.error("WFS request failed:",h.status),!1;const f=await h.json();if(console.log(" WFS RESPONSE:",JSON.stringify(f).substring(0,500)),!f.features||f.features.length===0)return console.log("No parcel found at location"),!1;const g=f.features[0];console.log(" PARCEL ID:",g.id||g.properties?.id||"geen ID"),console.log(" PARCEL BBOX:",JSON.stringify(g.bbox||"geen bbox"));const E=new NR().readFeature(g,{dataProjection:"EPSG:28992",featureProjection:"EPSG:3857"}),x=E.getGeometry();if(!x)return console.log("No geometry in parcel feature"),!1;const w=g.properties||{};console.log(` Parcel: ${w.category||"unknown"} - ${w.gewasnaam||w.gewas||"geen gewas"}`),console.log(` Geometry type: ${x.getType()}, extent: ${x.getExtent().map(M=>M.toFixed(0)).join(", ")}`);const T=x.getExtent(),I=T[2]-T[0],P=T[3]-T[1],N=Math.max(I,P)*.05,D=[T[0]-N,T[1]-N,T[2]+N,T[3]+N],B=Math.max(I,P)*.3,k=[T[0]-B,T[1]-B,T[2]+B,T[3]+B];Tf=x,Eh=new aW({source:new NW({url:"https://ahn.arcgisonline.nl/arcgis/rest/services/Hoogtebestand/AHN4_DTM_50cm/ImageServer",params:{renderingRule:JSON.stringify({rasterFunction:"AHN - Color Ramp D"})},crossOrigin:"anonymous"}),extent:D,zIndex:998}),Eh.on("prerender",M=>{if(!Tf)return;const j=M.context;if(!j)return;const O=M.frameState;if(!O)return;j.save(),j.beginPath(),(Tf.getType()==="Polygon"?Tf.getCoordinates()[0]:Tf.getCoordinates()[0][0]).forEach((F,Te)=>{const Me=n.getPixelFromCoordinate(F);if(!Me)return;const Le=O.pixelRatio,Re=Me[0]*Le,ue=Me[1]*Le;Te===0?j.moveTo(Re,ue):j.lineTo(Re,ue)}),j.closePath(),j.clip()}),Eh.on("postrender",M=>{const j=M.context;j&&j.restore()}),n.addLayer(Eh);const C=new $p({features:[E]});return Lm=new Xp({source:C,style:new ur({fill:new oi({color:"rgba(0, 0, 0, 0)"}),stroke:new _s({color:"#dc2626",width:3})}),zIndex:999}),n.addLayer(Lm),console.log(" Parcel height map displayed"),!0}catch(t){return console.error("Failed to show parcel height map:",t),!1}}var hv={};hv.version="0.18.5";var b7=1252,_ge=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],R7=function(n){_ge.indexOf(n)!=-1&&(b7=n)};function xge(){R7(1252)}var bp=function(n){R7(n)};function vge(){bp(1200),xge()}var f_=function(e){return String.fromCharCode(e)},WL=function(e){return String.fromCharCode(e)},dv,Hc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Rp(n){for(var e="",t=0,r=0,i=0,s=0,a=0,o=0,l=0,u=0;u<n.length;)t=n.charCodeAt(u++),s=t>>2,r=n.charCodeAt(u++),a=(t&3)<<4|r>>4,i=n.charCodeAt(u++),o=(r&15)<<2|i>>6,l=i&63,isNaN(r)?o=l=64:isNaN(i)&&(l=64),e+=Hc.charAt(s)+Hc.charAt(a)+Hc.charAt(o)+Hc.charAt(l);return e}function Ul(n){var e="",t=0,r=0,i=0,s=0,a=0,o=0,l=0;n=n.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<n.length;)s=Hc.indexOf(n.charAt(u++)),a=Hc.indexOf(n.charAt(u++)),t=s<<2|a>>4,e+=String.fromCharCode(t),o=Hc.indexOf(n.charAt(u++)),r=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(r)),l=Hc.indexOf(n.charAt(u++)),i=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var En=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Xl=(function(){if(typeof Buffer<"u"){var n=!Buffer.from;if(!n)try{Buffer.from("foo","utf8")}catch{n=!0}return n?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}})();function Qh(n){return En?Buffer.alloc?Buffer.alloc(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}function HL(n){return En?Buffer.allocUnsafe?Buffer.allocUnsafe(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}var Wa=function(e){return En?Xl(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)&255})};function VE(n){if(typeof ArrayBuffer>"u")return Wa(n);for(var e=new ArrayBuffer(n.length),t=new Uint8Array(e),r=0;r!=n.length;++r)t[r]=n.charCodeAt(r)&255;return e}function R1(n){if(Array.isArray(n))return n.map(function(r){return String.fromCharCode(r)}).join("");for(var e=[],t=0;t<n.length;++t)e[t]=String.fromCharCode(n[t]);return e.join("")}function Ege(n){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(n)}var vi=En?function(n){return Buffer.concat(n.map(function(e){return Buffer.isBuffer(e)?e:Xl(e)}))}:function(n){if(typeof Uint8Array<"u"){var e=0,t=0;for(e=0;e<n.length;++e)t+=n[e].length;var r=new Uint8Array(t),i=0;for(e=0,t=0;e<n.length;t+=i,++e)if(i=n[e].length,n[e]instanceof Uint8Array)r.set(n[e],t);else{if(typeof n[e]=="string")throw"wtf";r.set(new Uint8Array(n[e]),t)}return r}return[].concat.apply([],n.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function wge(n){for(var e=[],t=0,r=n.length+250,i=Qh(n.length+255),s=0;s<n.length;++s){var a=n.charCodeAt(s);if(a<128)i[t++]=a;else if(a<2048)i[t++]=192|a>>6&31,i[t++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=n.charCodeAt(++s)&1023;i[t++]=240|a>>8&7,i[t++]=128|a>>2&63,i[t++]=128|o>>6&15|(a&3)<<4,i[t++]=128|o&63}else i[t++]=224|a>>12&15,i[t++]=128|a>>6&63,i[t++]=128|a&63;t>r&&(e.push(i.slice(0,t)),t=0,i=Qh(65535),r=65530)}return e.push(i.slice(0,t)),vi(e)}var Om=/\u0000/g,g_=/[\u0001-\u0006]/g;function Zf(n){for(var e="",t=n.length-1;t>=0;)e+=n.charAt(t--);return e}function Ya(n,e){var t=""+n;return t.length>=e?t:pr("0",e-t.length)+t}function zR(n,e){var t=""+n;return t.length>=e?t:pr(" ",e-t.length)+t}function fv(n,e){var t=""+n;return t.length>=e?t:t+pr(" ",e-t.length)}function Sge(n,e){var t=""+Math.round(n);return t.length>=e?t:pr("0",e-t.length)+t}function Tge(n,e){var t=""+n;return t.length>=e?t:pr("0",e-t.length)+t}var KL=Math.pow(2,32);function cf(n,e){if(n>KL||n<-KL)return Sge(n,e);var t=Math.round(n);return Tge(t,e)}function gv(n,e){return e=e||0,n.length>=7+e&&(n.charCodeAt(e)|32)===103&&(n.charCodeAt(e+1)|32)===101&&(n.charCodeAt(e+2)|32)===110&&(n.charCodeAt(e+3)|32)===101&&(n.charCodeAt(e+4)|32)===114&&(n.charCodeAt(e+5)|32)===97&&(n.charCodeAt(e+6)|32)===108}var YL=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],OS=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Ige(n){return n||(n={}),n[0]="General",n[1]="0",n[2]="0.00",n[3]="#,##0",n[4]="#,##0.00",n[9]="0%",n[10]="0.00%",n[11]="0.00E+00",n[12]="# ?/?",n[13]="# ??/??",n[14]="m/d/yy",n[15]="d-mmm-yy",n[16]="d-mmm",n[17]="mmm-yy",n[18]="h:mm AM/PM",n[19]="h:mm:ss AM/PM",n[20]="h:mm",n[21]="h:mm:ss",n[22]="m/d/yy h:mm",n[37]="#,##0 ;(#,##0)",n[38]="#,##0 ;[Red](#,##0)",n[39]="#,##0.00;(#,##0.00)",n[40]="#,##0.00;[Red](#,##0.00)",n[45]="mm:ss",n[46]="[h]:mm:ss",n[47]="mmss.0",n[48]="##0.0E+0",n[49]="@",n[56]='"/ "hh""mm""ss" "',n}var _r={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},XL={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Age={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function mv(n,e,t){for(var r=n<0?-1:1,i=n*r,s=0,a=1,o=0,l=1,u=0,h=0,f=Math.floor(i);u<e&&(f=Math.floor(i),o=f*a+s,h=f*u+l,!(i-f<5e-8));)i=1/(i-f),s=a,a=o,l=u,u=h;if(h>e&&(u>e?(h=l,o=s):(h=u,o=a)),!t)return[0,r*o,h];var g=Math.floor(r*o/h);return[g,r*o-g*h,h]}function m_(n,e,t){if(n>2958465||n<0)return null;var r=n|0,i=Math.floor(86400*(n-r)),s=0,a=[],o={D:r,T:i,u:86400*(n-r)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(r+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++r,++o.D)),r===60)a=t?[1317,10,29]:[1900,2,29],s=3;else if(r===0)a=t?[1317,8,29]:[1900,1,0],s=6;else{r>60&&--r;var l=new Date(1900,0,1);l.setDate(l.getDate()+r-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),r<60&&(s=(s+6)%7),t&&(s=Nge(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var C7=new Date(1899,11,31,0,0,0),bge=C7.getTime(),Rge=new Date(1900,2,1,0,0,0);function P7(n,e){var t=n.getTime();return e?t-=1461*24*60*60*1e3:n>=Rge&&(t+=1440*60*1e3),(t-(bge+(n.getTimezoneOffset()-C7.getTimezoneOffset())*6e4))/(1440*60*1e3)}function $R(n){return n.indexOf(".")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Cge(n){return n.indexOf("E")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Pge(n){var e=n<0?12:11,t=$R(n.toFixed(12));return t.length<=e||(t=n.toPrecision(10),t.length<=e)?t:n.toExponential(5)}function kge(n){var e=$R(n.toFixed(11));return e.length>(n<0?12:11)||e==="0"||e==="-0"?n.toPrecision(6):e}function Mge(n){var e=Math.floor(Math.log(Math.abs(n))*Math.LOG10E),t;return e>=-4&&e<=-1?t=n.toPrecision(10+e):Math.abs(e)<=9?t=Pge(n):e===10?t=n.toFixed(10).substr(0,12):t=kge(n),$R(Cge(t.toUpperCase()))}function DI(n,e){switch(typeof n){case"string":return n;case"boolean":return n?"TRUE":"FALSE";case"number":return(n|0)===n?n.toString(10):Mge(n);case"undefined":return"";case"object":if(n==null)return"";if(n instanceof Date)return yu(14,P7(n,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+n)}function Nge(n,e){e[0]-=581;var t=n.getDay();return n<60&&(t=(t+6)%7),t}function Lge(n,e,t,r){var i="",s=0,a=0,o=t.y,l,u=0;switch(n){case 98:o=t.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,u=2;break;default:l=o%1e4,u=4;break}break;case 109:switch(e.length){case 1:case 2:l=t.m,u=e.length;break;case 3:return OS[t.m-1][1];case 5:return OS[t.m-1][0];default:return OS[t.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=t.d,u=e.length;break;case 3:return YL[t.q][0];default:return YL[t.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(t.H+11)%12,u=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=t.H,u=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=t.M,u=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return t.u===0&&(e=="s"||e=="ss")?Ya(t.S,e.length):(r>=2?a=r===3?1e3:100:a=r===1?10:1,s=Math.round(a*(t.S+t.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(i=Ya(s,2+r),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=t.D*24+t.H;break;case"[m]":case"[mm]":l=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":l=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+e}u=e.length===3?1:2;break;case 101:l=o,u=1;break}var h=u>0?Ya(l,u):"";return h}function Kc(n){var e=3;if(n.length<=e)return n;for(var t=n.length%e,r=n.substr(0,t);t!=n.length;t+=e)r+=(r.length>0?",":"")+n.substr(t,e);return r}var k7=/%/g;function Oge(n,e,t){var r=e.replace(k7,""),i=e.length-r.length;return Ml(n,r,t*Math.pow(10,2*i))+pr("%",i)}function Dge(n,e,t){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return Ml(n,e.substr(0,r),t/Math.pow(10,3*(e.length-r)))}function M7(n,e){var t,r=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+M7(n,-e);var i=n.indexOf(".");i===-1&&(i=n.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),t=(e/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),t.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(a-t.length+s):t+="E+"+(a-s);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,i)+"."+t.substr(2+i),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,h){return l+u+h.substr(0,(i+s)%i)+"."+h.substr(s)+"E"})}else t=e.toExponential(r);return n.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),n.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var N7=/# (\?+)( ?)\/( ?)(\d+)/;function Fge(n,e,t){var r=parseInt(n[4],10),i=Math.round(e*r),s=Math.floor(i/r),a=i-s*r,o=r;return t+(s===0?"":""+s)+" "+(a===0?pr(" ",n[1].length+1+n[4].length):zR(a,n[1].length)+n[2]+"/"+n[3]+Ya(o,n[4].length))}function jge(n,e,t){return t+(e===0?"":""+e)+pr(" ",n[1].length+2+n[4].length)}var L7=/^#*0*\.([0#]+)/,O7=/\).*[0#]/,D7=/\(###\) ###\\?-####/;function Yi(n){for(var e="",t,r=0;r!=n.length;++r)switch(t=n.charCodeAt(r)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(t)}return e}function qL(n,e){var t=Math.pow(10,e);return""+Math.round(n*t)/t}function ZL(n,e){var t=n-Math.floor(n),r=Math.pow(10,e);return e<(""+Math.round(t*r)).length?0:Math.round(t*r)}function Vge(n,e){return e<(""+Math.round((n-Math.floor(n))*Math.pow(10,e))).length?1:0}function Gge(n){return n<2147483647&&n>-2147483648?""+(n>=0?n|0:n-1|0):""+Math.floor(n)}function da(n,e,t){if(n.charCodeAt(0)===40&&!e.match(O7)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?da("n",r,t):"("+da("n",r,-t)+")"}if(e.charCodeAt(e.length-1)===44)return Dge(n,e,t);if(e.indexOf("%")!==-1)return Oge(n,e,t);if(e.indexOf("E")!==-1)return M7(e,t);if(e.charCodeAt(0)===36)return"$"+da(n,e.substr(e.charAt(1)==" "?2:1),t);var i,s,a,o,l=Math.abs(t),u=t<0?"-":"";if(e.match(/^00+$/))return u+cf(l,e.length);if(e.match(/^[#?]+$/))return i=cf(t,0),i==="0"&&(i=""),i.length>e.length?i:Yi(e.substr(0,e.length-i.length))+i;if(s=e.match(N7))return Fge(s,l,u);if(e.match(/^#+0+$/))return u+cf(l,e.length-e.indexOf("0"));if(s=e.match(L7))return i=qL(t,s[1].length).replace(/^([^\.]+)$/,"$1."+Yi(s[1])).replace(/\.$/,"."+Yi(s[1])).replace(/\.(\d*)$/,function(E,x){return"."+x+pr("0",Yi(s[1]).length-x.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+qL(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+Kc(cf(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+da(n,e,-t):Kc(""+(Math.floor(t)+Vge(t,s[1].length)))+"."+Ya(ZL(t,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return da(n,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Zf(da(n,e.replace(/[\\-]/g,""),t)),a=0,Zf(Zf(e.replace(/\\/g,"")).replace(/[0#]/g,function(E){return a<i.length?i.charAt(a++):E==="0"?"0":""}));if(e.match(D7))return i=da(n,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=mv(l,Math.pow(10,a)-1,!1),i=""+u,h=Ml("n",s[1],o[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+s[2]+"/"+s[3],h=fv(o[2],a),h.length<s[4].length&&(h=Yi(s[4].substr(s[4].length-h.length))+h),i+=h,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=mv(l,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?zR(o[1],a)+s[2]+"/"+s[3]+fv(o[2],a):pr(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=cf(t,0),e.length<=i.length?i:Yi(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var f=e.indexOf(".")-a,g=e.length-i.length-f;return Yi(e.substr(0,f)+i+e.substr(e.length-g))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=ZL(t,s[1].length),t<0?"-"+da(n,e,-t):Kc(Gge(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(E){return"00,"+(E.length<3?Ya(0,3-E.length):"")+E})+"."+Ya(a,s[1].length);switch(e){case"###,##0.00":return da(n,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var p=Kc(cf(l,0));return p!=="0"?u+p:"";case"###,###.00":return da(n,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return da(n,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function Bge(n,e,t){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return Ml(n,e.substr(0,r),t/Math.pow(10,3*(e.length-r)))}function Uge(n,e,t){var r=e.replace(k7,""),i=e.length-r.length;return Ml(n,r,t*Math.pow(10,2*i))+pr("%",i)}function F7(n,e){var t,r=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+F7(n,-e);var i=n.indexOf(".");i===-1&&(i=n.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),t=(e/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),!t.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(a-t.length+s):t+="E+"+(a-s),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,h){return l+u+h.substr(0,(i+s)%i)+"."+h.substr(s)+"E"})}else t=e.toExponential(r);return n.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),n.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function To(n,e,t){if(n.charCodeAt(0)===40&&!e.match(O7)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?To("n",r,t):"("+To("n",r,-t)+")"}if(e.charCodeAt(e.length-1)===44)return Bge(n,e,t);if(e.indexOf("%")!==-1)return Uge(n,e,t);if(e.indexOf("E")!==-1)return F7(e,t);if(e.charCodeAt(0)===36)return"$"+To(n,e.substr(e.charAt(1)==" "?2:1),t);var i,s,a,o,l=Math.abs(t),u=t<0?"-":"";if(e.match(/^00+$/))return u+Ya(l,e.length);if(e.match(/^[#?]+$/))return i=""+t,t===0&&(i=""),i.length>e.length?i:Yi(e.substr(0,e.length-i.length))+i;if(s=e.match(N7))return jge(s,l,u);if(e.match(/^#+0+$/))return u+Ya(l,e.length-e.indexOf("0"));if(s=e.match(L7))return i=(""+t).replace(/^([^\.]+)$/,"$1."+Yi(s[1])).replace(/\.$/,"."+Yi(s[1])),i=i.replace(/\.(\d*)$/,function(E,x){return"."+x+pr("0",Yi(s[1]).length-x.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+Kc(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+To(n,e,-t):Kc(""+t)+"."+pr("0",s[1].length);if(s=e.match(/^#,#*,#0/))return To(n,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Zf(To(n,e.replace(/[\\-]/g,""),t)),a=0,Zf(Zf(e.replace(/\\/g,"")).replace(/[0#]/g,function(E){return a<i.length?i.charAt(a++):E==="0"?"0":""}));if(e.match(D7))return i=To(n,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=mv(l,Math.pow(10,a)-1,!1),i=""+u,h=Ml("n",s[1],o[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+s[2]+"/"+s[3],h=fv(o[2],a),h.length<s[4].length&&(h=Yi(s[4].substr(s[4].length-h.length))+h),i+=h,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=mv(l,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?zR(o[1],a)+s[2]+"/"+s[3]+fv(o[2],a):pr(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+t,e.length<=i.length?i:Yi(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var f=e.indexOf(".")-a,g=e.length-i.length-f;return Yi(e.substr(0,f)+i+e.substr(e.length-g))}if(s=e.match(/^00,000\.([#0]*0)$/))return t<0?"-"+To(n,e,-t):Kc(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(E){return"00,"+(E.length<3?Ya(0,3-E.length):"")+E})+"."+Ya(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var p=Kc(""+l);return p!=="0"?u+p:"";default:if(e.match(/\.[0#?]*$/))return To(n,e.slice(0,e.lastIndexOf(".")),t)+Yi(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Ml(n,e,t){return(t|0)===t?To(n,e,t):da(n,e,t)}function zge(n){for(var e=[],t=!1,r=0,i=0;r<n.length;++r)switch(n.charCodeAt(r)){case 34:t=!t;break;case 95:case 42:case 92:++r;break;case 59:e[e.length]=n.substr(i,r-i),i=r+1}if(e[e.length]=n.substr(i),t===!0)throw new Error("Format |"+n+"| unterminated string ");return e}var j7=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function V7(n){for(var e=0,t="",r="";e<n.length;)switch(t=n.charAt(e)){case"G":gv(n,e)&&(e+=6),e++;break;case'"':for(;n.charCodeAt(++e)!==34&&e<n.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(n.charAt(e+1)==="1"||n.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(n.substr(e,3).toUpperCase()==="A/P"||n.substr(e,5).toUpperCase()==="AM/PM"||n.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(r=t;n.charAt(e++)!=="]"&&e<n.length;)r+=n.charAt(e);if(r.match(j7))return!0;break;case".":case"0":case"#":for(;e<n.length&&("0#?.,E+-%".indexOf(t=n.charAt(++e))>-1||t=="\\"&&n.charAt(e+1)=="-"&&"0#".indexOf(n.charAt(e+2))>-1););break;case"?":for(;n.charAt(++e)===t;);break;case"*":++e,(n.charAt(e)==" "||n.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<n.length&&"0123456789".indexOf(n.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function $ge(n,e,t,r){for(var i=[],s="",a=0,o="",l="t",u,h,f,g="H";a<n.length;)switch(o=n.charAt(a)){case"G":if(!gv(n,a))throw new Error("unrecognized character "+o+" in "+n);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(f=n.charCodeAt(++a))!==34&&a<n.length;)s+=String.fromCharCode(f);i[i.length]={t:"t",v:s},++a;break;case"\\":var p=n.charAt(++a),E=p==="("||p===")"?p:"t";i[i.length]={t:E,v:p},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:e},++a;break;case"B":case"b":if(n.charAt(a+1)==="1"||n.charAt(a+1)==="2"){if(u==null&&(u=m_(e,t,n.charAt(a+1)==="2"),u==null))return"";i[i.length]={t:"X",v:n.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||u==null&&(u=m_(e,t),u==null))return"";for(s=o;++a<n.length&&n.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=g),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var x={t:o,v:o};if(u==null&&(u=m_(e,t)),n.substr(a,3).toUpperCase()==="A/P"?(u!=null&&(x.v=u.H>=12?"P":"A"),x.t="T",g="h",a+=3):n.substr(a,5).toUpperCase()==="AM/PM"?(u!=null&&(x.v=u.H>=12?"PM":"AM"),x.t="T",a+=5,g="h"):n.substr(a,5).toUpperCase()==="/"?(u!=null&&(x.v=u.H>=12?"":""),x.t="T",a+=5,g="h"):(x.t="t",++a),u==null&&x.t==="T")return"";i[i.length]=x,l=o;break;case"[":for(s=o;n.charAt(a++)!=="]"&&a<n.length;)s+=n.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(j7)){if(u==null&&(u=m_(e,t),u==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",V7(n)||(i[i.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=o;++a<n.length&&(o=n.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<n.length&&"0#?.,E+-%".indexOf(o=n.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;n.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(n.charAt(a)==" "||n.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:r===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<n.length&&"0123456789".indexOf(n.charAt(++a))>-1;)s+=n.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+n);i[i.length]={t:"t",v:o},++a;break}var w=0,T=0,I;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=g,l="h",w<1&&(w=1);break;case"s":(I=i[a].v.match(/\.0+$/))&&(T=Math.max(T,I[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&i[a].v.match(/[Hh]/)&&(w=1),w<2&&i[a].v.match(/[Mm]/)&&(w=2),w<3&&i[a].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var P="",N;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=Lge(i[a].t.charCodeAt(0),i[a].v,u,T),i[a].t="t";break;case"n":case"?":for(N=a+1;i[N]!=null&&((o=i[N].t)==="?"||o==="D"||(o===" "||o==="t")&&i[N+1]!=null&&(i[N+1].t==="?"||i[N+1].t==="t"&&i[N+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[N].v==="/"||i[N].v===" "&&i[N+1]!=null&&i[N+1].t=="?"));)i[a].v+=i[N].v,i[N]={v:"",t:";"},++N;P+=i[a].v,a=N-1;break;case"G":i[a].t="t",i[a].v=DI(e,t);break}var D="",B,k;if(P.length>0){P.charCodeAt(0)==40?(B=e<0&&P.charCodeAt(0)===45?-e:e,k=Ml("n",P,B)):(B=e<0&&r>1?-e:e,k=Ml("n",P,B),B<0&&i[0]&&i[0].t=="t"&&(k=k.substr(1),i[0].v="-"+i[0].v)),N=k.length-1;var C=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){C=a;break}var M=i.length;if(C===i.length&&k.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(N>=i[a].v.length-1?(N-=i[a].v.length,i[a].v=k.substr(N+1,i[a].v.length)):N<0?i[a].v="":(i[a].v=k.substr(0,N+1),N=-1),i[a].t="t",M=a);N>=0&&M<i.length&&(i[M].v=k.substr(0,N+1)+i[M].v)}else if(C!==i.length&&k.indexOf("E")===-1){for(N=k.indexOf(".")-1,a=C;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(h=i[a].v.indexOf(".")>-1&&a===C?i[a].v.indexOf(".")-1:i[a].v.length-1,D=i[a].v.substr(h+1);h>=0;--h)N>=0&&(i[a].v.charAt(h)==="0"||i[a].v.charAt(h)==="#")&&(D=k.charAt(N--)+D);i[a].v=D,i[a].t="t",M=a}for(N>=0&&M<i.length&&(i[M].v=k.substr(0,N+1)+i[M].v),N=k.indexOf(".")+1,a=C;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==C)){for(h=i[a].v.indexOf(".")>-1&&a===C?i[a].v.indexOf(".")+1:0,D=i[a].v.substr(0,h);h<i[a].v.length;++h)N<k.length&&(D+=k.charAt(N++));i[a].v=D,i[a].t="t",M=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(B=r>1&&e<0&&a>0&&i[a-1].v==="-"?-e:e,i[a].v=Ml(i[a].t,i[a].v,B),i[a].t="t");var j="";for(a=0;a!==i.length;++a)i[a]!=null&&(j+=i[a].v);return j}var QL=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function JL(n,e){if(e==null)return!1;var t=parseFloat(e[2]);switch(e[1]){case"=":if(n==t)return!0;break;case">":if(n>t)return!0;break;case"<":if(n<t)return!0;break;case"<>":if(n!=t)return!0;break;case">=":if(n>=t)return!0;break;case"<=":if(n<=t)return!0;break}return!1}function Wge(n,e){var t=zge(n),r=t.length,i=t[r-1].indexOf("@");if(r<4&&i>-1&&--r,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof e!="number")return[4,t.length===4||i>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=i>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=i>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=i>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var s=e>0?t[0]:e<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[r,s];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var a=t[0].match(QL),o=t[1].match(QL);return JL(e,a)?[r,t[0]]:JL(e,o)?[r,t[1]]:[r,t[a!=null&&o!=null?2:1]]}return[r,s]}function yu(n,e,t){t==null&&(t={});var r="";switch(typeof n){case"string":n=="m/d/yy"&&t.dateNF?r=t.dateNF:r=n;break;case"number":n==14&&t.dateNF?r=t.dateNF:r=(t.table!=null?t.table:_r)[n],r==null&&(r=t.table&&t.table[XL[n]]||_r[XL[n]]),r==null&&(r=Age[n]||"General");break}if(gv(r,0))return DI(e,t);e instanceof Date&&(e=P7(e,t.date1904));var i=Wge(r,e);if(gv(i[1]))return DI(e,t);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return $ge(i[1],e,t,i[0])}function G7(n,e){if(typeof e!="number"){e=+e||-1;for(var t=0;t<392;++t){if(_r[t]==null){e<0&&(e=t);continue}if(_r[t]==n){e=t;break}}e<0&&(e=391)}return _r[e]=n,e}function GE(n){for(var e=0;e!=392;++e)n[e]!==void 0&&G7(n[e],e)}function BE(){_r=Ige()}var B7=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Hge(n){var e=typeof n=="number"?_r[n]:n;return e=e.replace(B7,"(\\d+)"),new RegExp("^"+e+"$")}function Kge(n,e,t){var r=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(e.match(B7)||[]).forEach(function(f,g){var p=parseInt(t[g+1],10);switch(f.toLowerCase().charAt(0)){case"y":r=p;break;case"d":s=p;break;case"h":a=p;break;case"s":l=p;break;case"m":a>=0?o=p:i=p;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var u=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var h=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?u:r==-1&&i==-1&&s==-1?h:u+"T"+h}var Yge=(function(){var n={};n.version="1.2.0";function e(){for(var k=0,C=new Array(256),M=0;M!=256;++M)k=M,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,C[M]=k;return typeof Int32Array<"u"?new Int32Array(C):C}var t=e();function r(k){var C=0,M=0,j=0,O=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(j=0;j!=256;++j)O[j]=k[j];for(j=0;j!=256;++j)for(M=k[j],C=256+j;C<4096;C+=256)M=O[C]=M>>>8^k[M&255];var W=[];for(j=1;j!=16;++j)W[j-1]=typeof Int32Array<"u"?O.subarray(j*256,j*256+256):O.slice(j*256,j*256+256);return W}var i=r(t),s=i[0],a=i[1],o=i[2],l=i[3],u=i[4],h=i[5],f=i[6],g=i[7],p=i[8],E=i[9],x=i[10],w=i[11],T=i[12],I=i[13],P=i[14];function N(k,C){for(var M=C^-1,j=0,O=k.length;j<O;)M=M>>>8^t[(M^k.charCodeAt(j++))&255];return~M}function D(k,C){for(var M=C^-1,j=k.length-15,O=0;O<j;)M=P[k[O++]^M&255]^I[k[O++]^M>>8&255]^T[k[O++]^M>>16&255]^w[k[O++]^M>>>24]^x[k[O++]]^E[k[O++]]^p[k[O++]]^g[k[O++]]^f[k[O++]]^h[k[O++]]^u[k[O++]]^l[k[O++]]^o[k[O++]]^a[k[O++]]^s[k[O++]]^t[k[O++]];for(j+=15;O<j;)M=M>>>8^t[(M^k[O++])&255];return~M}function B(k,C){for(var M=C^-1,j=0,O=k.length,W=0,F=0;j<O;)W=k.charCodeAt(j++),W<128?M=M>>>8^t[(M^W)&255]:W<2048?(M=M>>>8^t[(M^(192|W>>6&31))&255],M=M>>>8^t[(M^(128|W&63))&255]):W>=55296&&W<57344?(W=(W&1023)+64,F=k.charCodeAt(j++)&1023,M=M>>>8^t[(M^(240|W>>8&7))&255],M=M>>>8^t[(M^(128|W>>2&63))&255],M=M>>>8^t[(M^(128|F>>6&15|(W&3)<<4))&255],M=M>>>8^t[(M^(128|F&63))&255]):(M=M>>>8^t[(M^(224|W>>12&15))&255],M=M>>>8^t[(M^(128|W>>6&63))&255],M=M>>>8^t[(M^(128|W&63))&255]);return~M}return n.table=t,n.bstr=N,n.buf=D,n.str=B,n})(),Gn=(function(){var e={};e.version="1.2.1";function t(U,q){for(var K=U.split("/"),Y=q.split("/"),Z=0,Q=0,ye=Math.min(K.length,Y.length);Z<ye;++Z){if(Q=K[Z].length-Y[Z].length)return Q;if(K[Z]!=Y[Z])return K[Z]<Y[Z]?-1:1}return K.length-Y.length}function r(U){if(U.charAt(U.length-1)=="/")return U.slice(0,-1).indexOf("/")===-1?U:r(U.slice(0,-1));var q=U.lastIndexOf("/");return q===-1?U:U.slice(0,q+1)}function i(U){if(U.charAt(U.length-1)=="/")return i(U.slice(0,-1));var q=U.lastIndexOf("/");return q===-1?U:U.slice(q+1)}function s(U,q){typeof q=="string"&&(q=new Date(q));var K=q.getHours();K=K<<6|q.getMinutes(),K=K<<5|q.getSeconds()>>>1,U.write_shift(2,K);var Y=q.getFullYear()-1980;Y=Y<<4|q.getMonth()+1,Y=Y<<5|q.getDate(),U.write_shift(2,Y)}function a(U){var q=U.read_shift(2)&65535,K=U.read_shift(2)&65535,Y=new Date,Z=K&31;K>>>=5;var Q=K&15;K>>>=4,Y.setMilliseconds(0),Y.setFullYear(K+1980),Y.setMonth(Q-1),Y.setDate(Z);var ye=q&31;q>>>=5;var Pe=q&63;return q>>>=6,Y.setHours(q),Y.setMinutes(Pe),Y.setSeconds(ye<<1),Y}function o(U){Bs(U,0);for(var q={},K=0;U.l<=U.length-4;){var Y=U.read_shift(2),Z=U.read_shift(2),Q=U.l+Z,ye={};switch(Y){case 21589:K=U.read_shift(1),K&1&&(ye.mtime=U.read_shift(4)),Z>5&&(K&2&&(ye.atime=U.read_shift(4)),K&4&&(ye.ctime=U.read_shift(4))),ye.mtime&&(ye.mt=new Date(ye.mtime*1e3));break}U.l=Q,q[Y]=ye}return q}var l;function u(){return l||(l={})}function h(U,q){if(U[0]==80&&U[1]==75)return Ar(U,q);if((U[0]|32)==109&&(U[1]|32)==105)return Vr(U,q);if(U.length<512)throw new Error("CFB file size "+U.length+" < 512");var K=3,Y=512,Z=0,Q=0,ye=0,Pe=0,pe=0,xe=[],ve=U.slice(0,512);Bs(ve,0);var We=f(ve);switch(K=We[0],K){case 3:Y=512;break;case 4:Y=4096;break;case 0:if(We[1]==0)return Ar(U,q);default:throw new Error("Major Version: Expected 3 or 4 saw "+K)}Y!==512&&(ve=U.slice(0,Y),Bs(ve,28));var et=U.slice(0,Y);g(ve,K);var ut=ve.read_shift(4,"i");if(K===3&&ut!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ut);ve.l+=4,ye=ve.read_shift(4,"i"),ve.l+=4,ve.chk("00100000","Mini Stream Cutoff Size: "),Pe=ve.read_shift(4,"i"),Z=ve.read_shift(4,"i"),pe=ve.read_shift(4,"i"),Q=ve.read_shift(4,"i");for(var He=-1,Ke=0;Ke<109&&(He=ve.read_shift(4,"i"),!(He<0));++Ke)xe[Ke]=He;var jt=p(U,Y);w(pe,Q,jt,Y,xe);var In=I(jt,ye,xe,Y);In[ye].name="!Directory",Z>0&&Pe!==F&&(In[Pe].name="!MiniFAT"),In[xe[0]].name="!FAT",In.fat_addrs=xe,In.ssz=Y;var Pn={},Qn=[],Ra=[],na=[];P(ye,In,jt,Qn,Z,Pn,Ra,Pe),E(Ra,na,Qn),Qn.shift();var ks={FileIndex:Ra,FullPaths:na};return q&&q.raw&&(ks.raw={header:et,sectors:jt}),ks}function f(U){if(U[U.l]==80&&U[U.l+1]==75)return[0,0];U.chk(Te,"Header Signature: "),U.l+=16;var q=U.read_shift(2,"u");return[U.read_shift(2,"u"),q]}function g(U,q){var K=9;switch(U.l+=2,K=U.read_shift(2)){case 9:if(q!=3)throw new Error("Sector Shift: Expected 9 saw "+K);break;case 12:if(q!=4)throw new Error("Sector Shift: Expected 12 saw "+K);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+K)}U.chk("0600","Mini Sector Shift: "),U.chk("000000000000","Reserved: ")}function p(U,q){for(var K=Math.ceil(U.length/q)-1,Y=[],Z=1;Z<K;++Z)Y[Z-1]=U.slice(Z*q,(Z+1)*q);return Y[K-1]=U.slice(K*q),Y}function E(U,q,K){for(var Y=0,Z=0,Q=0,ye=0,Pe=0,pe=K.length,xe=[],ve=[];Y<pe;++Y)xe[Y]=ve[Y]=Y,q[Y]=K[Y];for(;Pe<ve.length;++Pe)Y=ve[Pe],Z=U[Y].L,Q=U[Y].R,ye=U[Y].C,xe[Y]===Y&&(Z!==-1&&xe[Z]!==Z&&(xe[Y]=xe[Z]),Q!==-1&&xe[Q]!==Q&&(xe[Y]=xe[Q])),ye!==-1&&(xe[ye]=Y),Z!==-1&&Y!=xe[Y]&&(xe[Z]=xe[Y],ve.lastIndexOf(Z)<Pe&&ve.push(Z)),Q!==-1&&Y!=xe[Y]&&(xe[Q]=xe[Y],ve.lastIndexOf(Q)<Pe&&ve.push(Q));for(Y=1;Y<pe;++Y)xe[Y]===Y&&(Q!==-1&&xe[Q]!==Q?xe[Y]=xe[Q]:Z!==-1&&xe[Z]!==Z&&(xe[Y]=xe[Z]));for(Y=1;Y<pe;++Y)if(U[Y].type!==0){if(Pe=Y,Pe!=xe[Pe])do Pe=xe[Pe],q[Y]=q[Pe]+"/"+q[Y];while(Pe!==0&&xe[Pe]!==-1&&Pe!=xe[Pe]);xe[Y]=-1}for(q[0]+="/",Y=1;Y<pe;++Y)U[Y].type!==2&&(q[Y]+="/")}function x(U,q,K){for(var Y=U.start,Z=U.size,Q=[],ye=Y;K&&Z>0&&ye>=0;)Q.push(q.slice(ye*W,ye*W+W)),Z-=W,ye=dh(K,ye*4);return Q.length===0?Ce(0):vi(Q).slice(0,U.size)}function w(U,q,K,Y,Z){var Q=F;if(U===F){if(q!==0)throw new Error("DIFAT chain shorter than expected")}else if(U!==-1){var ye=K[U],Pe=(Y>>>2)-1;if(!ye)return;for(var pe=0;pe<Pe&&(Q=dh(ye,pe*4))!==F;++pe)Z.push(Q);w(dh(ye,Y-4),q-1,K,Y,Z)}}function T(U,q,K,Y,Z){var Q=[],ye=[];Z||(Z=[]);var Pe=Y-1,pe=0,xe=0;for(pe=q;pe>=0;){Z[pe]=!0,Q[Q.length]=pe,ye.push(U[pe]);var ve=K[Math.floor(pe*4/Y)];if(xe=pe*4&Pe,Y<4+xe)throw new Error("FAT boundary crossed: "+pe+" 4 "+Y);if(!U[ve])break;pe=dh(U[ve],xe)}return{nodes:Q,data:oO([ye])}}function I(U,q,K,Y){var Z=U.length,Q=[],ye=[],Pe=[],pe=[],xe=Y-1,ve=0,We=0,et=0,ut=0;for(ve=0;ve<Z;++ve)if(Pe=[],et=ve+q,et>=Z&&(et-=Z),!ye[et]){pe=[];var He=[];for(We=et;We>=0;){He[We]=!0,ye[We]=!0,Pe[Pe.length]=We,pe.push(U[We]);var Ke=K[Math.floor(We*4/Y)];if(ut=We*4&xe,Y<4+ut)throw new Error("FAT boundary crossed: "+We+" 4 "+Y);if(!U[Ke]||(We=dh(U[Ke],ut),He[We]))break}Q[et]={nodes:Pe,data:oO([pe])}}return Q}function P(U,q,K,Y,Z,Q,ye,Pe){for(var pe=0,xe=Y.length?2:0,ve=q[U].data,We=0,et=0,ut;We<ve.length;We+=128){var He=ve.slice(We,We+128);Bs(He,64),et=He.read_shift(2),ut=XR(He,0,et-xe),Y.push(ut);var Ke={name:ut,type:He.read_shift(1),color:He.read_shift(1),L:He.read_shift(4,"i"),R:He.read_shift(4,"i"),C:He.read_shift(4,"i"),clsid:He.read_shift(16),state:He.read_shift(4,"i"),start:0,size:0},jt=He.read_shift(2)+He.read_shift(2)+He.read_shift(2)+He.read_shift(2);jt!==0&&(Ke.ct=N(He,He.l-8));var In=He.read_shift(2)+He.read_shift(2)+He.read_shift(2)+He.read_shift(2);In!==0&&(Ke.mt=N(He,He.l-8)),Ke.start=He.read_shift(4,"i"),Ke.size=He.read_shift(4,"i"),Ke.size<0&&Ke.start<0&&(Ke.size=Ke.type=0,Ke.start=F,Ke.name=""),Ke.type===5?(pe=Ke.start,Z>0&&pe!==F&&(q[pe].name="!StreamData")):Ke.size>=4096?(Ke.storage="fat",q[Ke.start]===void 0&&(q[Ke.start]=T(K,Ke.start,q.fat_addrs,q.ssz)),q[Ke.start].name=Ke.name,Ke.content=q[Ke.start].data.slice(0,Ke.size)):(Ke.storage="minifat",Ke.size<0?Ke.size=0:pe!==F&&Ke.start!==F&&q[pe]&&(Ke.content=x(Ke,q[pe].data,(q[Pe]||{}).data))),Ke.content&&Bs(Ke.content,0),Q[ut]=Ke,ye.push(Ke)}}function N(U,q){return new Date((Ws(U,q+4)/1e7*Math.pow(2,32)+Ws(U,q)/1e7-11644473600)*1e3)}function D(U,q){return u(),h(l.readFileSync(U),q)}function B(U,q){var K=q&&q.type;switch(K||En&&Buffer.isBuffer(U)&&(K="buffer"),K||"base64"){case"file":return D(U,q);case"base64":return h(Wa(Ul(U)),q);case"binary":return h(Wa(U),q)}return h(U,q)}function k(U,q){var K=q||{},Y=K.root||"Root Entry";if(U.FullPaths||(U.FullPaths=[]),U.FileIndex||(U.FileIndex=[]),U.FullPaths.length!==U.FileIndex.length)throw new Error("inconsistent CFB structure");U.FullPaths.length===0&&(U.FullPaths[0]=Y+"/",U.FileIndex[0]={name:Y,type:5}),K.CLSID&&(U.FileIndex[0].clsid=K.CLSID),C(U)}function C(U){var q="Sh33tJ5";if(!Gn.find(U,"/"+q)){var K=Ce(4);K[0]=55,K[1]=K[3]=50,K[2]=54,U.FileIndex.push({name:q,type:2,content:K,size:4,L:69,R:69,C:69}),U.FullPaths.push(U.FullPaths[0]+q),M(U)}}function M(U,q){k(U);for(var K=!1,Y=!1,Z=U.FullPaths.length-1;Z>=0;--Z){var Q=U.FileIndex[Z];switch(Q.type){case 0:Y?K=!0:(U.FileIndex.pop(),U.FullPaths.pop());break;case 1:case 2:case 5:Y=!0,isNaN(Q.R*Q.L*Q.C)&&(K=!0),Q.R>-1&&Q.L>-1&&Q.R==Q.L&&(K=!0);break;default:K=!0;break}}if(!(!K&&!q)){var ye=new Date(1987,1,19),Pe=0,pe=Object.create?Object.create(null):{},xe=[];for(Z=0;Z<U.FullPaths.length;++Z)pe[U.FullPaths[Z]]=!0,U.FileIndex[Z].type!==0&&xe.push([U.FullPaths[Z],U.FileIndex[Z]]);for(Z=0;Z<xe.length;++Z){var ve=r(xe[Z][0]);Y=pe[ve],Y||(xe.push([ve,{name:i(ve).replace("/",""),type:1,clsid:Le,ct:ye,mt:ye,content:null}]),pe[ve]=!0)}for(xe.sort(function(ut,He){return t(ut[0],He[0])}),U.FullPaths=[],U.FileIndex=[],Z=0;Z<xe.length;++Z)U.FullPaths[Z]=xe[Z][0],U.FileIndex[Z]=xe[Z][1];for(Z=0;Z<xe.length;++Z){var We=U.FileIndex[Z],et=U.FullPaths[Z];if(We.name=i(et).replace("/",""),We.L=We.R=We.C=-(We.color=1),We.size=We.content?We.content.length:0,We.start=0,We.clsid=We.clsid||Le,Z===0)We.C=xe.length>1?1:-1,We.size=0,We.type=5;else if(et.slice(-1)=="/"){for(Pe=Z+1;Pe<xe.length&&r(U.FullPaths[Pe])!=et;++Pe);for(We.C=Pe>=xe.length?-1:Pe,Pe=Z+1;Pe<xe.length&&r(U.FullPaths[Pe])!=r(et);++Pe);We.R=Pe>=xe.length?-1:Pe,We.type=1}else r(U.FullPaths[Z+1]||"")==r(et)&&(We.R=Z+1),We.type=2}}}function j(U,q){var K=q||{};if(K.fileType=="mad")return Gr(U,K);switch(M(U),K.fileType){case"zip":return Tn(U,K)}var Y=(function(ut){for(var He=0,Ke=0,jt=0;jt<ut.FileIndex.length;++jt){var In=ut.FileIndex[jt];if(In.content){var Pn=In.content.length;Pn>0&&(Pn<4096?He+=Pn+63>>6:Ke+=Pn+511>>9)}}for(var Qn=ut.FullPaths.length+3>>2,Ra=He+7>>3,na=He+127>>7,ks=Ra+Ke+Qn+na,vr=ks+127>>7,ql=vr<=109?0:Math.ceil((vr-109)/127);ks+vr+ql+127>>7>vr;)ql=++vr<=109?0:Math.ceil((vr-109)/127);var ir=[1,ql,vr,na,Qn,Ke,He,0];return ut.FileIndex[0].size=He<<6,ir[7]=(ut.FileIndex[0].start=ir[0]+ir[1]+ir[2]+ir[3]+ir[4]+ir[5])+(ir[6]+7>>3),ir})(U),Z=Ce(Y[7]<<9),Q=0,ye=0;{for(Q=0;Q<8;++Q)Z.write_shift(1,Me[Q]);for(Q=0;Q<8;++Q)Z.write_shift(2,0);for(Z.write_shift(2,62),Z.write_shift(2,3),Z.write_shift(2,65534),Z.write_shift(2,9),Z.write_shift(2,6),Q=0;Q<3;++Q)Z.write_shift(2,0);for(Z.write_shift(4,0),Z.write_shift(4,Y[2]),Z.write_shift(4,Y[0]+Y[1]+Y[2]+Y[3]-1),Z.write_shift(4,0),Z.write_shift(4,4096),Z.write_shift(4,Y[3]?Y[0]+Y[1]+Y[2]-1:F),Z.write_shift(4,Y[3]),Z.write_shift(-4,Y[1]?Y[0]-1:F),Z.write_shift(4,Y[1]),Q=0;Q<109;++Q)Z.write_shift(-4,Q<Y[2]?Y[1]+Q:-1)}if(Y[1])for(ye=0;ye<Y[1];++ye){for(;Q<236+ye*127;++Q)Z.write_shift(-4,Q<Y[2]?Y[1]+Q:-1);Z.write_shift(-4,ye===Y[1]-1?F:ye+1)}var Pe=function(ut){for(ye+=ut;Q<ye-1;++Q)Z.write_shift(-4,Q+1);ut&&(++Q,Z.write_shift(-4,F))};for(ye=Q=0,ye+=Y[1];Q<ye;++Q)Z.write_shift(-4,Re.DIFSECT);for(ye+=Y[2];Q<ye;++Q)Z.write_shift(-4,Re.FATSECT);Pe(Y[3]),Pe(Y[4]);for(var pe=0,xe=0,ve=U.FileIndex[0];pe<U.FileIndex.length;++pe)ve=U.FileIndex[pe],ve.content&&(xe=ve.content.length,!(xe<4096)&&(ve.start=ye,Pe(xe+511>>9)));for(Pe(Y[6]+7>>3);Z.l&511;)Z.write_shift(-4,Re.ENDOFCHAIN);for(ye=Q=0,pe=0;pe<U.FileIndex.length;++pe)ve=U.FileIndex[pe],ve.content&&(xe=ve.content.length,!(!xe||xe>=4096)&&(ve.start=ye,Pe(xe+63>>6)));for(;Z.l&511;)Z.write_shift(-4,Re.ENDOFCHAIN);for(Q=0;Q<Y[4]<<2;++Q){var We=U.FullPaths[Q];if(!We||We.length===0){for(pe=0;pe<17;++pe)Z.write_shift(4,0);for(pe=0;pe<3;++pe)Z.write_shift(4,-1);for(pe=0;pe<12;++pe)Z.write_shift(4,0);continue}ve=U.FileIndex[Q],Q===0&&(ve.start=ve.size?ve.start-1:F);var et=Q===0&&K.root||ve.name;if(xe=2*(et.length+1),Z.write_shift(64,et,"utf16le"),Z.write_shift(2,xe),Z.write_shift(1,ve.type),Z.write_shift(1,ve.color),Z.write_shift(-4,ve.L),Z.write_shift(-4,ve.R),Z.write_shift(-4,ve.C),ve.clsid)Z.write_shift(16,ve.clsid,"hex");else for(pe=0;pe<4;++pe)Z.write_shift(4,0);Z.write_shift(4,ve.state||0),Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(4,ve.start),Z.write_shift(4,ve.size),Z.write_shift(4,0)}for(Q=1;Q<U.FileIndex.length;++Q)if(ve=U.FileIndex[Q],ve.size>=4096)if(Z.l=ve.start+1<<9,En&&Buffer.isBuffer(ve.content))ve.content.copy(Z,Z.l,0,ve.size),Z.l+=ve.size+511&-512;else{for(pe=0;pe<ve.size;++pe)Z.write_shift(1,ve.content[pe]);for(;pe&511;++pe)Z.write_shift(1,0)}for(Q=1;Q<U.FileIndex.length;++Q)if(ve=U.FileIndex[Q],ve.size>0&&ve.size<4096)if(En&&Buffer.isBuffer(ve.content))ve.content.copy(Z,Z.l,0,ve.size),Z.l+=ve.size+63&-64;else{for(pe=0;pe<ve.size;++pe)Z.write_shift(1,ve.content[pe]);for(;pe&63;++pe)Z.write_shift(1,0)}if(En)Z.l=Z.length;else for(;Z.l<Z.length;)Z.write_shift(1,0);return Z}function O(U,q){var K=U.FullPaths.map(function(pe){return pe.toUpperCase()}),Y=K.map(function(pe){var xe=pe.split("/");return xe[xe.length-(pe.slice(-1)=="/"?2:1)]}),Z=!1;q.charCodeAt(0)===47?(Z=!0,q=K[0].slice(0,-1)+q):Z=q.indexOf("/")!==-1;var Q=q.toUpperCase(),ye=Z===!0?K.indexOf(Q):Y.indexOf(Q);if(ye!==-1)return U.FileIndex[ye];var Pe=!Q.match(g_);for(Q=Q.replace(Om,""),Pe&&(Q=Q.replace(g_,"!")),ye=0;ye<K.length;++ye)if((Pe?K[ye].replace(g_,"!"):K[ye]).replace(Om,"")==Q||(Pe?Y[ye].replace(g_,"!"):Y[ye]).replace(Om,"")==Q)return U.FileIndex[ye];return null}var W=64,F=-2,Te="d0cf11e0a1b11ae1",Me=[208,207,17,224,161,177,26,225],Le="00000000000000000000000000000000",Re={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:F,FREESECT:-1,HEADER_SIGNATURE:Te,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Le,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ue(U,q,K){u();var Y=j(U,K);l.writeFileSync(q,Y)}function be(U){for(var q=new Array(U.length),K=0;K<U.length;++K)q[K]=String.fromCharCode(U[K]);return q.join("")}function ce(U,q){var K=j(U,q);switch(q&&q.type||"buffer"){case"file":return u(),l.writeFileSync(q.filename,K),K;case"binary":return typeof K=="string"?K:be(K);case"base64":return Rp(typeof K=="string"?K:be(K));case"buffer":if(En)return Buffer.isBuffer(K)?K:Xl(K);case"array":return typeof K=="string"?Wa(K):K}return K}var te;function V(U){try{var q=U.InflateRaw,K=new q;if(K._processChunk(new Uint8Array([3,0]),K._finishFlushFlag),K.bytesRead)te=U;else throw new Error("zlib does not expose bytesRead")}catch(Y){console.error("cannot use native zlib: "+(Y.message||Y))}}function ie(U,q){if(!te)return $i(U,q);var K=te.InflateRaw,Y=new K,Z=Y._processChunk(U.slice(U.l),Y._finishFlushFlag);return U.l+=Y.bytesRead,Z}function ne(U){return te?te.deflateRawSync(U):Ze(U)}var ee=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],fe=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Oe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Se(U){var q=(U<<1|U<<11)&139536|(U<<5|U<<15)&558144;return(q>>16|q>>8|q)&255}for(var Fe=typeof Uint8Array<"u",je=Fe?new Uint8Array(256):[],Qe=0;Qe<256;++Qe)je[Qe]=Se(Qe);function gt(U,q){var K=je[U&255];return q<=8?K>>>8-q:(K=K<<8|je[U>>8&255],q<=16?K>>>16-q:(K=K<<8|je[U>>16&255],K>>>24-q))}function yt(U,q){var K=q&7,Y=q>>>3;return(U[Y]|(K<=6?0:U[Y+1]<<8))>>>K&3}function Lt(U,q){var K=q&7,Y=q>>>3;return(U[Y]|(K<=5?0:U[Y+1]<<8))>>>K&7}function nn(U,q){var K=q&7,Y=q>>>3;return(U[Y]|(K<=4?0:U[Y+1]<<8))>>>K&15}function Ut(U,q){var K=q&7,Y=q>>>3;return(U[Y]|(K<=3?0:U[Y+1]<<8))>>>K&31}function De(U,q){var K=q&7,Y=q>>>3;return(U[Y]|(K<=1?0:U[Y+1]<<8))>>>K&127}function Xt(U,q,K){var Y=q&7,Z=q>>>3,Q=(1<<K)-1,ye=U[Z]>>>Y;return K<8-Y||(ye|=U[Z+1]<<8-Y,K<16-Y)||(ye|=U[Z+2]<<16-Y,K<24-Y)||(ye|=U[Z+3]<<24-Y),ye&Q}function Ie(U,q,K){var Y=q&7,Z=q>>>3;return Y<=5?U[Z]|=(K&7)<<Y:(U[Z]|=K<<Y&255,U[Z+1]=(K&7)>>8-Y),q+3}function me(U,q,K){var Y=q&7,Z=q>>>3;return K=(K&1)<<Y,U[Z]|=K,q+1}function R(U,q,K){var Y=q&7,Z=q>>>3;return K<<=Y,U[Z]|=K&255,K>>>=8,U[Z+1]=K,q+8}function Et(U,q,K){var Y=q&7,Z=q>>>3;return K<<=Y,U[Z]|=K&255,K>>>=8,U[Z+1]=K&255,U[Z+2]=K>>>8,q+16}function X(U,q){var K=U.length,Y=2*K>q?2*K:q+5,Z=0;if(K>=q)return U;if(En){var Q=HL(Y);if(U.copy)U.copy(Q);else for(;Z<U.length;++Z)Q[Z]=U[Z];return Q}else if(Fe){var ye=new Uint8Array(Y);if(ye.set)ye.set(U);else for(;Z<K;++Z)ye[Z]=U[Z];return ye}return U.length=Y,U}function Ot(U){for(var q=new Array(U),K=0;K<U;++K)q[K]=0;return q}function re(U,q,K){var Y=1,Z=0,Q=0,ye=0,Pe=0,pe=U.length,xe=Fe?new Uint16Array(32):Ot(32);for(Q=0;Q<32;++Q)xe[Q]=0;for(Q=pe;Q<K;++Q)U[Q]=0;pe=U.length;var ve=Fe?new Uint16Array(pe):Ot(pe);for(Q=0;Q<pe;++Q)xe[Z=U[Q]]++,Y<Z&&(Y=Z),ve[Q]=0;for(xe[0]=0,Q=1;Q<=Y;++Q)xe[Q+16]=Pe=Pe+xe[Q-1]<<1;for(Q=0;Q<pe;++Q)Pe=U[Q],Pe!=0&&(ve[Q]=xe[Pe+16]++);var We=0;for(Q=0;Q<pe;++Q)if(We=U[Q],We!=0)for(Pe=gt(ve[Q],Y)>>Y-We,ye=(1<<Y+4-We)-1;ye>=0;--ye)q[Pe|ye<<We]=We&15|Q<<4;return Y}var z=Fe?new Uint16Array(512):Ot(512),le=Fe?new Uint16Array(32):Ot(32);if(!Fe){for(var $e=0;$e<512;++$e)z[$e]=0;for($e=0;$e<32;++$e)le[$e]=0}(function(){for(var U=[],q=0;q<32;q++)U.push(5);re(U,le,32);var K=[];for(q=0;q<=143;q++)K.push(8);for(;q<=255;q++)K.push(9);for(;q<=279;q++)K.push(7);for(;q<=287;q++)K.push(8);re(K,z,288)})();var Ae=(function(){for(var q=Fe?new Uint8Array(32768):[],K=0,Y=0;K<Oe.length-1;++K)for(;Y<Oe[K+1];++Y)q[Y]=K;for(;Y<32768;++Y)q[Y]=29;var Z=Fe?new Uint8Array(259):[];for(K=0,Y=0;K<fe.length-1;++K)for(;Y<fe[K+1];++Y)Z[Y]=K;function Q(Pe,pe){for(var xe=0;xe<Pe.length;){var ve=Math.min(65535,Pe.length-xe),We=xe+ve==Pe.length;for(pe.write_shift(1,+We),pe.write_shift(2,ve),pe.write_shift(2,~ve&65535);ve-- >0;)pe[pe.l++]=Pe[xe++]}return pe.l}function ye(Pe,pe){for(var xe=0,ve=0,We=Fe?new Uint16Array(32768):[];ve<Pe.length;){var et=Math.min(65535,Pe.length-ve);if(et<10){for(xe=Ie(pe,xe,+(ve+et==Pe.length)),xe&7&&(xe+=8-(xe&7)),pe.l=xe/8|0,pe.write_shift(2,et),pe.write_shift(2,~et&65535);et-- >0;)pe[pe.l++]=Pe[ve++];xe=pe.l*8;continue}xe=Ie(pe,xe,+(ve+et==Pe.length)+2);for(var ut=0;et-- >0;){var He=Pe[ve];ut=(ut<<5^He)&32767;var Ke=-1,jt=0;if((Ke=We[ut])&&(Ke|=ve&-32768,Ke>ve&&(Ke-=32768),Ke<ve))for(;Pe[Ke+jt]==Pe[ve+jt]&&jt<250;)++jt;if(jt>2){He=Z[jt],He<=22?xe=R(pe,xe,je[He+1]>>1)-1:(R(pe,xe,3),xe+=5,R(pe,xe,je[He-23]>>5),xe+=3);var In=He<8?0:He-4>>2;In>0&&(Et(pe,xe,jt-fe[He]),xe+=In),He=q[ve-Ke],xe=R(pe,xe,je[He]>>3),xe-=3;var Pn=He<4?0:He-2>>1;Pn>0&&(Et(pe,xe,ve-Ke-Oe[He]),xe+=Pn);for(var Qn=0;Qn<jt;++Qn)We[ut]=ve&32767,ut=(ut<<5^Pe[ve])&32767,++ve;et-=jt-1}else He<=143?He=He+48:xe=me(pe,xe,1),xe=R(pe,xe,je[He]),We[ut]=ve&32767,++ve}xe=R(pe,xe,0)-1}return pe.l=(xe+7)/8|0,pe.l}return function(pe,xe){return pe.length<8?Q(pe,xe):ye(pe,xe)}})();function Ze(U){var q=Ce(50+Math.floor(U.length*1.1)),K=Ae(U,q);return q.slice(0,K)}var ht=Fe?new Uint16Array(32768):Ot(32768),vt=Fe?new Uint16Array(32768):Ot(32768),wt=Fe?new Uint16Array(128):Ot(128),Rt=1,en=1;function Fr(U,q){var K=Ut(U,q)+257;q+=5;var Y=Ut(U,q)+1;q+=5;var Z=nn(U,q)+4;q+=4;for(var Q=0,ye=Fe?new Uint8Array(19):Ot(19),Pe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],pe=1,xe=Fe?new Uint8Array(8):Ot(8),ve=Fe?new Uint8Array(8):Ot(8),We=ye.length,et=0;et<Z;++et)ye[ee[et]]=Q=Lt(U,q),pe<Q&&(pe=Q),xe[Q]++,q+=3;var ut=0;for(xe[0]=0,et=1;et<=pe;++et)ve[et]=ut=ut+xe[et-1]<<1;for(et=0;et<We;++et)(ut=ye[et])!=0&&(Pe[et]=ve[ut]++);var He=0;for(et=0;et<We;++et)if(He=ye[et],He!=0){ut=je[Pe[et]]>>8-He;for(var Ke=(1<<7-He)-1;Ke>=0;--Ke)wt[ut|Ke<<He]=He&7|et<<3}var jt=[];for(pe=1;jt.length<K+Y;)switch(ut=wt[De(U,q)],q+=ut&7,ut>>>=3){case 16:for(Q=3+yt(U,q),q+=2,ut=jt[jt.length-1];Q-- >0;)jt.push(ut);break;case 17:for(Q=3+Lt(U,q),q+=3;Q-- >0;)jt.push(0);break;case 18:for(Q=11+De(U,q),q+=7;Q-- >0;)jt.push(0);break;default:jt.push(ut),pe<ut&&(pe=ut);break}var In=jt.slice(0,K),Pn=jt.slice(K);for(et=K;et<286;++et)In[et]=0;for(et=Y;et<30;++et)Pn[et]=0;return Rt=re(In,ht,286),en=re(Pn,vt,30),q}function Rs(U,q){if(U[0]==3&&!(U[1]&3))return[Qh(q),2];for(var K=0,Y=0,Z=HL(q||1<<18),Q=0,ye=Z.length>>>0,Pe=0,pe=0;(Y&1)==0;){if(Y=Lt(U,K),K+=3,Y>>>1)Y>>1==1?(Pe=9,pe=5):(K=Fr(U,K),Pe=Rt,pe=en);else{K&7&&(K+=8-(K&7));var xe=U[K>>>3]|U[(K>>>3)+1]<<8;if(K+=32,xe>0)for(!q&&ye<Q+xe&&(Z=X(Z,Q+xe),ye=Z.length);xe-- >0;)Z[Q++]=U[K>>>3],K+=8;continue}for(;;){!q&&ye<Q+32767&&(Z=X(Z,Q+32767),ye=Z.length);var ve=Xt(U,K,Pe),We=Y>>>1==1?z[ve]:ht[ve];if(K+=We&15,We>>>=4,(We>>>8&255)===0)Z[Q++]=We;else{if(We==256)break;We-=257;var et=We<8?0:We-4>>2;et>5&&(et=0);var ut=Q+fe[We];et>0&&(ut+=Xt(U,K,et),K+=et),ve=Xt(U,K,pe),We=Y>>>1==1?le[ve]:vt[ve],K+=We&15,We>>>=4;var He=We<4?0:We-2>>1,Ke=Oe[We];for(He>0&&(Ke+=Xt(U,K,He),K+=He),!q&&ye<ut&&(Z=X(Z,ut+100),ye=Z.length);Q<ut;)Z[Q]=Z[Q-Ke],++Q}}}return q?[Z,K+7>>>3]:[Z.slice(0,Q),K+7>>>3]}function $i(U,q){var K=U.slice(U.l||0),Y=Rs(K,q);return U.l+=Y[1],Y[0]}function Wi(U,q){if(U)typeof console<"u"&&console.error(q);else throw new Error(q)}function Ar(U,q){var K=U;Bs(K,0);var Y=[],Z=[],Q={FileIndex:Y,FullPaths:Z};k(Q,{root:q.root});for(var ye=K.length-4;(K[ye]!=80||K[ye+1]!=75||K[ye+2]!=5||K[ye+3]!=6)&&ye>=0;)--ye;K.l=ye+4,K.l+=4;var Pe=K.read_shift(2);K.l+=6;var pe=K.read_shift(4);for(K.l=pe,ye=0;ye<Pe;++ye){K.l+=20;var xe=K.read_shift(4),ve=K.read_shift(4),We=K.read_shift(2),et=K.read_shift(2),ut=K.read_shift(2);K.l+=8;var He=K.read_shift(4),Ke=o(K.slice(K.l+We,K.l+We+et));K.l+=We+et+ut;var jt=K.l;K.l=He+4,ci(K,xe,ve,Q,Ke),K.l=jt}return Q}function ci(U,q,K,Y,Z){U.l+=2;var Q=U.read_shift(2),ye=U.read_shift(2),Pe=a(U);if(Q&8257)throw new Error("Unsupported ZIP encryption");for(var pe=U.read_shift(4),xe=U.read_shift(4),ve=U.read_shift(4),We=U.read_shift(2),et=U.read_shift(2),ut="",He=0;He<We;++He)ut+=String.fromCharCode(U[U.l++]);if(et){var Ke=o(U.slice(U.l,U.l+et));(Ke[21589]||{}).mt&&(Pe=Ke[21589].mt),((Z||{})[21589]||{}).mt&&(Pe=Z[21589].mt)}U.l+=et;var jt=U.slice(U.l,U.l+xe);switch(ye){case 8:jt=ie(U,ve);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ye)}var In=!1;Q&8&&(pe=U.read_shift(4),pe==134695760&&(pe=U.read_shift(4),In=!0),xe=U.read_shift(4),ve=U.read_shift(4)),xe!=q&&Wi(In,"Bad compressed size: "+q+" != "+xe),ve!=K&&Wi(In,"Bad uncompressed size: "+K+" != "+ve),on(Y,ut,jt,{unsafe:!0,mt:Pe})}function Tn(U,q){var K=q||{},Y=[],Z=[],Q=Ce(1),ye=K.compression?8:0,Pe=0,pe=0,xe=0,ve=0,We=0,et=U.FullPaths[0],ut=et,He=U.FileIndex[0],Ke=[],jt=0;for(pe=1;pe<U.FullPaths.length;++pe)if(ut=U.FullPaths[pe].slice(et.length),He=U.FileIndex[pe],!(!He.size||!He.content||ut=="Sh33tJ5")){var In=ve,Pn=Ce(ut.length);for(xe=0;xe<ut.length;++xe)Pn.write_shift(1,ut.charCodeAt(xe)&127);Pn=Pn.slice(0,Pn.l),Ke[We]=Yge.buf(He.content,0);var Qn=He.content;ye==8&&(Qn=ne(Qn)),Q=Ce(30),Q.write_shift(4,67324752),Q.write_shift(2,20),Q.write_shift(2,Pe),Q.write_shift(2,ye),He.mt?s(Q,He.mt):Q.write_shift(4,0),Q.write_shift(-4,Ke[We]),Q.write_shift(4,Qn.length),Q.write_shift(4,He.content.length),Q.write_shift(2,Pn.length),Q.write_shift(2,0),ve+=Q.length,Y.push(Q),ve+=Pn.length,Y.push(Pn),ve+=Qn.length,Y.push(Qn),Q=Ce(46),Q.write_shift(4,33639248),Q.write_shift(2,0),Q.write_shift(2,20),Q.write_shift(2,Pe),Q.write_shift(2,ye),Q.write_shift(4,0),Q.write_shift(-4,Ke[We]),Q.write_shift(4,Qn.length),Q.write_shift(4,He.content.length),Q.write_shift(2,Pn.length),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(4,0),Q.write_shift(4,In),jt+=Q.l,Z.push(Q),jt+=Pn.length,Z.push(Pn),++We}return Q=Ce(22),Q.write_shift(4,101010256),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(2,We),Q.write_shift(2,We),Q.write_shift(4,jt),Q.write_shift(4,ve),Q.write_shift(2,0),vi([vi(Y),vi(Z),Q])}var Cs={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ps(U,q){if(U.ctype)return U.ctype;var K=U.name||"",Y=K.match(/\.([^\.]+)$/);return Y&&Cs[Y[1]]||q&&(Y=(K=q).match(/[\.\\]([^\.\\])+$/),Y&&Cs[Y[1]])?Cs[Y[1]]:"application/octet-stream"}function nr(U){for(var q=Rp(U),K=[],Y=0;Y<q.length;Y+=76)K.push(q.slice(Y,Y+76));return K.join(`\r
`)+`\r
`}function rs(U){var q=U.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(xe){var ve=xe.charCodeAt(0).toString(16).toUpperCase();return"="+(ve.length==1?"0"+ve:ve)});q=q.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),q.charAt(0)==`
`&&(q="=0D"+q.slice(1)),q=q.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var K=[],Y=q.split(`\r
`),Z=0;Z<Y.length;++Z){var Q=Y[Z];if(Q.length==0){K.push("");continue}for(var ye=0;ye<Q.length;){var Pe=76,pe=Q.slice(ye,ye+Pe);pe.charAt(Pe-1)=="="?Pe--:pe.charAt(Pe-2)=="="?Pe-=2:pe.charAt(Pe-3)=="="&&(Pe-=3),pe=Q.slice(ye,ye+Pe),ye+=Pe,ye<Q.length&&(pe+="="),K.push(pe)}}return K.join(`\r
`)}function jr(U){for(var q=[],K=0;K<U.length;++K){for(var Y=U[K];K<=U.length&&Y.charAt(Y.length-1)=="=";)Y=Y.slice(0,Y.length-1)+U[++K];q.push(Y)}for(var Z=0;Z<q.length;++Z)q[Z]=q[Z].replace(/[=][0-9A-Fa-f]{2}/g,function(Q){return String.fromCharCode(parseInt(Q.slice(1),16))});return Wa(q.join(`\r
`))}function rr(U,q,K){for(var Y="",Z="",Q="",ye,Pe=0;Pe<10;++Pe){var pe=q[Pe];if(!pe||pe.match(/^\s*$/))break;var xe=pe.match(/^(.*?):\s*([^\s].*)$/);if(xe)switch(xe[1].toLowerCase()){case"content-location":Y=xe[2].trim();break;case"content-type":Q=xe[2].trim();break;case"content-transfer-encoding":Z=xe[2].trim();break}}switch(++Pe,Z.toLowerCase()){case"base64":ye=Wa(Ul(q.slice(Pe).join("")));break;case"quoted-printable":ye=jr(q.slice(Pe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Z)}var ve=on(U,Y.slice(K.length),ye,{unsafe:!0});Q&&(ve.ctype=Q)}function Vr(U,q){if(be(U.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var K=q&&q.root||"",Y=(En&&Buffer.isBuffer(U)?U.toString("binary"):be(U)).split(`\r
`),Z=0,Q="";for(Z=0;Z<Y.length;++Z)if(Q=Y[Z],!!/^Content-Location:/i.test(Q)&&(Q=Q.slice(Q.indexOf("file")),K||(K=Q.slice(0,Q.lastIndexOf("/")+1)),Q.slice(0,K.length)!=K))for(;K.length>0&&(K=K.slice(0,K.length-1),K=K.slice(0,K.lastIndexOf("/")+1),Q.slice(0,K.length)!=K););var ye=(Y[1]||"").match(/boundary="(.*?)"/);if(!ye)throw new Error("MAD cannot find boundary");var Pe="--"+(ye[1]||""),pe=[],xe=[],ve={FileIndex:pe,FullPaths:xe};k(ve);var We,et=0;for(Z=0;Z<Y.length;++Z){var ut=Y[Z];ut!==Pe&&ut!==Pe+"--"||(et++&&rr(ve,Y.slice(We,Z),K),We=Z)}return ve}function Gr(U,q){var K=q||{},Y=K.boundary||"SheetJS";Y="------="+Y;for(var Z=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Y.slice(2)+'"',"","",""],Q=U.FullPaths[0],ye=Q,Pe=U.FileIndex[0],pe=1;pe<U.FullPaths.length;++pe)if(ye=U.FullPaths[pe].slice(Q.length),Pe=U.FileIndex[pe],!(!Pe.size||!Pe.content||ye=="Sh33tJ5")){ye=ye.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(jt){return"_x"+jt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(jt){return"_u"+jt.charCodeAt(0).toString(16)+"_"});for(var xe=Pe.content,ve=En&&Buffer.isBuffer(xe)?xe.toString("binary"):be(xe),We=0,et=Math.min(1024,ve.length),ut=0,He=0;He<=et;++He)(ut=ve.charCodeAt(He))>=32&&ut<128&&++We;var Ke=We>=et*4/5;Z.push(Y),Z.push("Content-Location: "+(K.root||"file:///C:/SheetJS/")+ye),Z.push("Content-Transfer-Encoding: "+(Ke?"quoted-printable":"base64")),Z.push("Content-Type: "+Ps(Pe,ye)),Z.push(""),Z.push(Ke?rs(ve):nr(ve))}return Z.push(Y+`--\r
`),Z.join(`\r
`)}function br(U){var q={};return k(q,U),q}function on(U,q,K,Y){var Z=Y&&Y.unsafe;Z||k(U);var Q=!Z&&Gn.find(U,q);if(!Q){var ye=U.FullPaths[0];q.slice(0,ye.length)==ye?ye=q:(ye.slice(-1)!="/"&&(ye+="/"),ye=(ye+q).replace("//","/")),Q={name:i(q),type:2},U.FileIndex.push(Q),U.FullPaths.push(ye),Z||Gn.utils.cfb_gc(U)}return Q.content=K,Q.size=K?K.length:0,Y&&(Y.CLSID&&(Q.clsid=Y.CLSID),Y.mt&&(Q.mt=Y.mt),Y.ct&&(Q.ct=Y.ct)),Q}function hr(U,q){k(U);var K=Gn.find(U,q);if(K){for(var Y=0;Y<U.FileIndex.length;++Y)if(U.FileIndex[Y]==K)return U.FileIndex.splice(Y,1),U.FullPaths.splice(Y,1),!0}return!1}function xr(U,q,K){k(U);var Y=Gn.find(U,q);if(Y){for(var Z=0;Z<U.FileIndex.length;++Z)if(U.FileIndex[Z]==Y)return U.FileIndex[Z].name=i(K),U.FullPaths[Z]=K,!0}return!1}function is(U){M(U,!0)}return e.find=O,e.read=B,e.parse=h,e.write=ce,e.writeFile=ue,e.utils={cfb_new:br,cfb_add:on,cfb_del:hr,cfb_mov:xr,cfb_gc:is,ReadShift:Fm,CheckField:sV,prep_blob:Bs,bconcat:vi,use_zlib:V,_deflateRaw:Ze,_inflateRaw:$i,consts:Re},e})();function Xge(n){return typeof n=="string"?VE(n):Array.isArray(n)?Ege(n):n}function C1(n,e,t){if(typeof Deno<"u"){if(t&&typeof e=="string")switch(t){case"utf8":e=new TextEncoder(t).encode(e);break;case"binary":e=VE(e);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(n,e)}var r=t=="utf8"?Pp(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(r,n);if(typeof Blob<"u"){var i=new Blob([Xge(r)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,n);if(typeof saveAs<"u")return saveAs(i,n);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:n,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=n,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(n);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=R1(e)),o.write(e),o.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+n)}function Ii(n){for(var e=Object.keys(n),t=[],r=0;r<e.length;++r)Object.prototype.hasOwnProperty.call(n,e[r])&&t.push(e[r]);return t}function eO(n,e){for(var t=[],r=Ii(n),i=0;i!==r.length;++i)t[n[r[i]][e]]==null&&(t[n[r[i]][e]]=r[i]);return t}function WR(n){for(var e=[],t=Ii(n),r=0;r!==t.length;++r)e[n[t[r]]]=t[r];return e}function UE(n){for(var e=[],t=Ii(n),r=0;r!==t.length;++r)e[n[t[r]]]=parseInt(t[r],10);return e}function qge(n){for(var e=[],t=Ii(n),r=0;r!==t.length;++r)e[n[t[r]]]==null&&(e[n[t[r]]]=[]),e[n[t[r]]].push(t[r]);return e}var pv=new Date(1899,11,30,0,0,0);function Ts(n,e){var t=n.getTime(),r=pv.getTime()+(n.getTimezoneOffset()-pv.getTimezoneOffset())*6e4;return(t-r)/(1440*60*1e3)}var U7=new Date,Zge=pv.getTime()+(U7.getTimezoneOffset()-pv.getTimezoneOffset())*6e4,tO=U7.getTimezoneOffset();function z7(n){var e=new Date;return e.setTime(n*24*60*60*1e3+Zge),e.getTimezoneOffset()!==tO&&e.setTime(e.getTime()+(e.getTimezoneOffset()-tO)*6e4),e}var nO=new Date("2017-02-19T19:06:09.000Z"),$7=isNaN(nO.getFullYear())?new Date("2/19/17"):nO,Qge=$7.getFullYear()==2017;function ns(n,e){var t=new Date(n);if(Qge)return e>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):e<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(n instanceof Date)return n;if($7.getFullYear()==1917&&!isNaN(t.getFullYear())){var r=t.getFullYear();return n.indexOf(""+r)>-1||t.setFullYear(t.getFullYear()+100),t}var i=n.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return n.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function zE(n,e){if(En&&Buffer.isBuffer(n))return n.toString("binary");if(typeof TextDecoder<"u")try{var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(n)&&(n=new Uint8Array(n)),new TextDecoder("latin1").decode(n).replace(/[]/g,function(s){return t[s]||s})}catch{}for(var r=[],i=0;i!=n.length;++i)r.push(String.fromCharCode(n[i]));return r.join("")}function Is(n){if(typeof JSON<"u"&&!Array.isArray(n))return JSON.parse(JSON.stringify(n));if(typeof n!="object"||n==null)return n;if(n instanceof Date)return new Date(n.getTime());var e={};for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=Is(n[t]));return e}function pr(n,e){for(var t="";t.length<e;)t+=n;return t}function Nl(n){var e=Number(n);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(n))return e;var t=1,r=n.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(e=Number(r))||(r=r.replace(/[(](.*)[)]/,function(i,s){return t=-t,s}),!isNaN(e=Number(r)))?e/t:e}var Jge=["january","february","march","april","may","june","july","august","september","october","november","december"];function Cp(n){var e=new Date(n),t=new Date(NaN),r=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return t;var a=n.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&Jge.indexOf(a)==-1)return t}else if(a.match(/[a-z]/))return t;return r<0||r>8099?t:(i>0||s>1)&&r!=101?e:n.match(/[^-0-9:,\/\\]/)?t:e}function qt(n,e,t){if(n.FullPaths){if(typeof t=="string"){var r;return En?r=Xl(t):r=wge(t),Gn.utils.cfb_add(n,e,r)}Gn.utils.cfb_add(n,e,t)}else n.file(e,t)}function HR(){return Gn.utils.cfb_new()}var Dr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,eme={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},KR=WR(eme),YR=/[&<>'"]/g,tme=/[\u0000-\u0008\u000b-\u001f]/g;function Fn(n){var e=n+"";return e.replace(YR,function(t){return KR[t]}).replace(tme,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function rO(n){return Fn(n).replace(/ /g,"_x0020_")}var W7=/[\u0000-\u001f]/g;function nme(n){var e=n+"";return e.replace(YR,function(t){return KR[t]}).replace(/\n/g,"<br/>").replace(W7,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function rme(n){var e=n+"";return e.replace(YR,function(t){return KR[t]}).replace(W7,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}function ime(n){return n.replace(/(\r\n|[\r\n])/g,"&#10;")}function sme(n){switch(n){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function DS(n){for(var e="",t=0,r=0,i=0,s=0,a=0,o=0;t<n.length;){if(r=n.charCodeAt(t++),r<128){e+=String.fromCharCode(r);continue}if(i=n.charCodeAt(t++),r>191&&r<224){a=(r&31)<<6,a|=i&63,e+=String.fromCharCode(a);continue}if(s=n.charCodeAt(t++),r<240){e+=String.fromCharCode((r&15)<<12|(i&63)<<6|s&63);continue}a=n.charCodeAt(t++),o=((r&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function iO(n){var e=Qh(2*n.length),t,r,i=1,s=0,a=0,o;for(r=0;r<n.length;r+=i)i=1,(o=n.charCodeAt(r))<128?t=o:o<224?(t=(o&31)*64+(n.charCodeAt(r+1)&63),i=2):o<240?(t=(o&15)*4096+(n.charCodeAt(r+1)&63)*64+(n.charCodeAt(r+2)&63),i=3):(i=4,t=(o&7)*262144+(n.charCodeAt(r+1)&63)*4096+(n.charCodeAt(r+2)&63)*64+(n.charCodeAt(r+3)&63),t-=65536,a=55296+(t>>>10&1023),t=56320+(t&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=t%256,e[s++]=t>>>8;return e.slice(0,s).toString("ucs2")}function sO(n){return Xl(n,"binary").toString("utf8")}var p_="foo bar baz",Dm=En&&(sO(p_)==DS(p_)&&sO||iO(p_)==DS(p_)&&iO)||DS,Pp=En?function(n){return Xl(n,"utf8").toString("binary")}:function(n){for(var e=[],t=0,r=0,i=0;t<n.length;)switch(r=n.charCodeAt(t++),!0){case r<128:e.push(String.fromCharCode(r));break;case r<2048:e.push(String.fromCharCode(192+(r>>6))),e.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,i=n.charCodeAt(t++)-56320+(r<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(r>>12))),e.push(String.fromCharCode(128+(r>>6&63))),e.push(String.fromCharCode(128+(r&63)))}return e.join("")},ame=(function(){var n=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var r=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<n.length;++i)r=r.replace(n[i][0],n[i][1]);return r}})(),H7=/(^\s|\s$|\n)/;function Ei(n,e){return"<"+n+(e.match(H7)?' xml:space="preserve"':"")+">"+e+"</"+n+">"}function kp(n){return Ii(n).map(function(e){return" "+e+'="'+n[e]+'"'}).join("")}function tt(n,e,t){return"<"+n+(t!=null?kp(t):"")+(e!=null?(e.match(H7)?' xml:space="preserve"':"")+">"+e+"</"+n:"/")+">"}function FI(n,e){try{return n.toISOString().replace(/\.\d*/,"")}catch(t){if(e)throw t}return""}function ome(n,e){switch(typeof n){case"string":var t=tt("vt:lpwstr",Fn(n));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return tt((n|0)==n?"vt:i4":"vt:r8",Fn(String(n)));case"boolean":return tt("vt:bool",n?"true":"false")}if(n instanceof Date)return tt("vt:filetime",FI(n));throw new Error("Unable to serialize "+n)}var ri={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},$0=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],$s={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function lme(n,e){for(var t=1-2*(n[e+7]>>>7),r=((n[e+7]&127)<<4)+(n[e+6]>>>4&15),i=n[e+6]&15,s=5;s>=0;--s)i=i*256+n[e+s];return r==2047?i==0?t*(1/0):NaN:(r==0?r=-1022:(r-=1023,i+=Math.pow(2,52)),t*Math.pow(2,r-52)*i)}function cme(n,e,t){var r=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,a=r?-e:e;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)n[t+o]=s&255;n[t+6]=(i&15)<<4|s&15,n[t+7]=i>>4|r}var aO=function(n){for(var e=[],t=10240,r=0;r<n[0].length;++r)if(n[0][r])for(var i=0,s=n[0][r].length;i<s;i+=t)e.push.apply(e,n[0][r].slice(i,i+t));return e},oO=En?function(n){return n[0].length>0&&Buffer.isBuffer(n[0][0])?Buffer.concat(n[0].map(function(e){return Buffer.isBuffer(e)?e:Xl(e)})):aO(n)}:aO,lO=function(n,e,t){for(var r=[],i=e;i<t;i+=2)r.push(String.fromCharCode(cm(n,i)));return r.join("").replace(Om,"")},XR=En?function(n,e,t){return Buffer.isBuffer(n)?n.toString("utf16le",e,t).replace(Om,""):lO(n,e,t)}:lO,cO=function(n,e,t){for(var r=[],i=e;i<e+t;++i)r.push(("0"+n[i].toString(16)).slice(-2));return r.join("")},K7=En?function(n,e,t){return Buffer.isBuffer(n)?n.toString("hex",e,e+t):cO(n,e,t)}:cO,uO=function(n,e,t){for(var r=[],i=e;i<t;i++)r.push(String.fromCharCode(If(n,i)));return r.join("")},P1=En?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf8",t,r):uO(e,t,r)}:uO,Y7=function(n,e){var t=Ws(n,e);return t>0?P1(n,e+4,e+4+t-1):""},X7=Y7,q7=function(n,e){var t=Ws(n,e);return t>0?P1(n,e+4,e+4+t-1):""},Z7=q7,Q7=function(n,e){var t=2*Ws(n,e);return t>0?P1(n,e+4,e+4+t-1):""},J7=Q7,eV=function(e,t){var r=Ws(e,t);return r>0?XR(e,t+4,t+4+r):""},tV=eV,nV=function(n,e){var t=Ws(n,e);return t>0?P1(n,e+4,e+4+t):""},rV=nV,iV=function(n,e){return lme(n,e)},yv=iV,qR=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};En&&(X7=function(e,t){if(!Buffer.isBuffer(e))return Y7(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},Z7=function(e,t){if(!Buffer.isBuffer(e))return q7(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},J7=function(e,t){if(!Buffer.isBuffer(e))return Q7(e,t);var r=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r-1)},tV=function(e,t){if(!Buffer.isBuffer(e))return eV(e,t);var r=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r)},rV=function(e,t){if(!Buffer.isBuffer(e))return nV(e,t);var r=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+r)},yv=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):iV(e,t)},qR=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var If=function(n,e){return n[e]},cm=function(n,e){return n[e+1]*256+n[e]},ume=function(n,e){var t=n[e+1]*256+n[e];return t<32768?t:(65535-t+1)*-1},Ws=function(n,e){return n[e+3]*(1<<24)+(n[e+2]<<16)+(n[e+1]<<8)+n[e]},dh=function(n,e){return n[e+3]<<24|n[e+2]<<16|n[e+1]<<8|n[e]},hme=function(n,e){return n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3]};function Fm(n,e){var t="",r,i,s=[],a,o,l,u;switch(e){case"dbcs":if(u=this.l,En&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*n).toString("utf16le");else for(l=0;l<n;++l)t+=String.fromCharCode(cm(this,u)),u+=2;n*=2;break;case"utf8":t=P1(this,this.l,this.l+n);break;case"utf16le":n*=2,t=XR(this,this.l,this.l+n);break;case"wstr":return Fm.call(this,n,"dbcs");case"lpstr-ansi":t=X7(this,this.l),n=4+Ws(this,this.l);break;case"lpstr-cp":t=Z7(this,this.l),n=4+Ws(this,this.l);break;case"lpwstr":t=J7(this,this.l),n=4+2*Ws(this,this.l);break;case"lpp4":n=4+Ws(this,this.l),t=tV(this,this.l),n&2&&(n+=2);break;case"8lpp4":n=4+Ws(this,this.l),t=rV(this,this.l),n&3&&(n+=4-(n&3));break;case"cstr":for(n=0,t="";(a=If(this,this.l+n++))!==0;)s.push(f_(a));t=s.join("");break;case"_wstr":for(n=0,t="";(a=cm(this,this.l+n))!==0;)s.push(f_(a)),n+=2;n+=2,t=s.join("");break;case"dbcs-cont":for(t="",u=this.l,l=0;l<n;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return a=If(this,u),this.l=u+1,o=Fm.call(this,n-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(f_(cm(this,u))),u+=2}t=s.join(""),n*=2;break;case"cpstr":case"sbcs-cont":for(t="",u=this.l,l=0;l!=n;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return a=If(this,u),this.l=u+1,o=Fm.call(this,n-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(f_(If(this,u))),u+=1}t=s.join("");break;default:switch(n){case 1:return r=If(this,this.l),this.l++,r;case 2:return r=(e==="i"?ume:cm)(this,this.l),this.l+=2,r;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(r=(n>0?dh:hme)(this,this.l),this.l+=4,r):(i=Ws(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return n==8?i=yv(this,this.l):i=yv([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;n=8;case 16:t=K7(this,this.l,n);break}}return this.l+=n,t}var dme=function(n,e,t){n[t]=e&255,n[t+1]=e>>>8&255,n[t+2]=e>>>16&255,n[t+3]=e>>>24&255},fme=function(n,e,t){n[t]=e&255,n[t+1]=e>>8&255,n[t+2]=e>>16&255,n[t+3]=e>>24&255},gme=function(n,e,t){n[t]=e&255,n[t+1]=e>>>8&255};function mme(n,e,t){var r=0,i=0;if(t==="dbcs"){for(i=0;i!=e.length;++i)gme(this,e.charCodeAt(i),this.l+2*i);r=2*e.length}else if(t==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;r=e.length}else if(t==="hex"){for(;i<n;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(t==="utf16le"){var s=Math.min(this.l+n,this.length);for(i=0;i<Math.min(e.length,n);++i){var a=e.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(n){case 1:r=1,this[this.l]=e&255;break;case 2:r=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:r=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:r=4,dme(this,e,this.l);break;case 8:if(r=8,t==="f"){cme(this,e,this.l);break}case 16:break;case-4:r=4,fme(this,e,this.l);break}return this.l+=r,this}function sV(n,e){var t=K7(this,this.l,n.length>>1);if(t!==n)throw new Error(e+"Expected "+n+" saw "+t);this.l+=n.length>>1}function Bs(n,e){n.l=e,n.read_shift=Fm,n.chk=sV,n.write_shift=mme}function Xo(n,e){n.l+=e}function Ce(n){var e=Qh(n);return Bs(e,0),e}function ws(){var n=[],e=En?256:2048,t=function(u){var h=Ce(u);return Bs(h,0),h},r=t(e),i=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&n.push(r),r=null)},s=function(u){return r&&u<r.length-r.l?r:(i(),r=t(Math.max(u+1,e)))},a=function(){return i(),vi(n)},o=function(u){i(),r=u,r.l==null&&(r.l=r.length),s(e)};return{next:s,push:o,end:a,_bufs:n}}function Ge(n,e,t,r){var i=+e,s;if(!isNaN(i)){r||(r=lve[i].p||(t||[]).length||0),s=1+(i>=128?1:0)+1,r>=128&&++s,r>=16384&&++s,r>=2097152&&++s;var a=n.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(r>=128)a.write_shift(1,(r&127)+128),r>>=7;else{a.write_shift(1,r);break}r>0&&qR(t)&&n.push(t)}}function jm(n,e,t){var r=Is(n);if(e.s?(r.cRel&&(r.c+=e.s.c),r.rRel&&(r.r+=e.s.r)):(r.cRel&&(r.c+=e.c),r.rRel&&(r.r+=e.r)),!t||t.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function hO(n,e,t){var r=Is(n);return r.s=jm(r.s,e.s,t),r.e=jm(r.e,e.s,t),r}function Vm(n,e){if(n.cRel&&n.c<0)for(n=Is(n);n.c<0;)n.c+=e>8?16384:256;if(n.rRel&&n.r<0)for(n=Is(n);n.r<0;)n.r+=e>8?1048576:e>5?65536:16384;var t=Vn(n);return!n.cRel&&n.cRel!=null&&(t=_me(t)),!n.rRel&&n.rRel!=null&&(t=pme(t)),t}function FS(n,e){return n.s.r==0&&!n.s.rRel&&n.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!n.e.rRel?(n.s.cRel?"":"$")+Ui(n.s.c)+":"+(n.e.cRel?"":"$")+Ui(n.e.c):n.s.c==0&&!n.s.cRel&&n.e.c==(e.biff>=12?16383:255)&&!n.e.cRel?(n.s.rRel?"":"$")+Si(n.s.r)+":"+(n.e.rRel?"":"$")+Si(n.e.r):Vm(n.s,e.biff)+":"+Vm(n.e,e.biff)}function ZR(n){return parseInt(yme(n),10)-1}function Si(n){return""+(n+1)}function pme(n){return n.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function yme(n){return n.replace(/\$(\d+)$/,"$1")}function QR(n){for(var e=xme(n),t=0,r=0;r!==e.length;++r)t=26*t+e.charCodeAt(r)-64;return t-1}function Ui(n){if(n<0)throw new Error("invalid column "+n);var e="";for(++n;n;n=Math.floor((n-1)/26))e=String.fromCharCode((n-1)%26+65)+e;return e}function _me(n){return n.replace(/^([A-Z])/,"$$$1")}function xme(n){return n.replace(/^\$([A-Z])/,"$1")}function vme(n){return n.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function si(n){for(var e=0,t=0,r=0;r<n.length;++r){var i=n.charCodeAt(r);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(t=26*t+(i-64))}return{c:t-1,r:e-1}}function Vn(n){for(var e=n.c+1,t="";e;e=(e-1)/26|0)t=String.fromCharCode((e-1)%26+65)+t;return t+(n.r+1)}function ta(n){var e=n.indexOf(":");return e==-1?{s:si(n),e:si(n)}:{s:si(n.slice(0,e)),e:si(n.slice(e+1))}}function Lr(n,e){return typeof e>"u"||typeof e=="number"?Lr(n.s,n.e):(typeof n!="string"&&(n=Vn(n)),typeof e!="string"&&(e=Vn(e)),n==e?n:n+":"+e)}function Zn(n){var e={s:{c:0,r:0},e:{c:0,r:0}},t=0,r=0,i=0,s=n.length;for(t=0;r<s&&!((i=n.charCodeAt(r)-64)<1||i>26);++r)t=26*t+i;for(e.s.c=--t,t=0;r<s&&!((i=n.charCodeAt(r)-48)<0||i>9);++r)t=10*t+i;if(e.s.r=--t,r===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++r,t=0;r!=s&&!((i=n.charCodeAt(r)-64)<1||i>26);++r)t=26*t+i;for(e.e.c=--t,t=0;r!=s&&!((i=n.charCodeAt(r)-48)<0||i>9);++r)t=10*t+i;return e.e.r=--t,e}function dO(n,e){var t=n.t=="d"&&e instanceof Date;if(n.z!=null)try{return n.w=yu(n.z,t?Ts(e):e)}catch{}try{return n.w=yu((n.XF||{}).numFmtId||(t?14:0),t?Ts(e):e)}catch{return""+e}}function zl(n,e,t){return n==null||n.t==null||n.t=="z"?"":n.w!==void 0?n.w:(n.t=="d"&&!n.z&&t&&t.dateNF&&(n.z=t.dateNF),n.t=="e"?k1[n.v]||n.v:e==null?dO(n,n.v):dO(n,e))}function fd(n,e){var t=e&&e.sheet?e.sheet:"Sheet1",r={};return r[t]=n,{SheetNames:[t],Sheets:r}}function aV(n,e,t){var r=t||{},i=n?Array.isArray(n):r.dense,s=n||(i?[]:{}),a=0,o=0;if(s&&r.origin!=null){if(typeof r.origin=="number")a=r.origin;else{var l=typeof r.origin=="string"?si(r.origin):r.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var h=Zn(s["!ref"]);u.s.c=h.s.c,u.s.r=h.s.r,u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),a==-1&&(u.e.r=a=h.e.r+1)}for(var f=0;f!=e.length;++f)if(e[f]){if(!Array.isArray(e[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var g=0;g!=e[f].length;++g)if(!(typeof e[f][g]>"u")){var p={v:e[f][g]},E=a+f,x=o+g;if(u.s.r>E&&(u.s.r=E),u.s.c>x&&(u.s.c=x),u.e.r<E&&(u.e.r=E),u.e.c<x&&(u.e.c=x),e[f][g]&&typeof e[f][g]=="object"&&!Array.isArray(e[f][g])&&!(e[f][g]instanceof Date))p=e[f][g];else if(Array.isArray(p.v)&&(p.f=e[f][g][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(r.nullError)p.t="e",p.v=0;else if(r.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=r.dateNF||_r[14],r.cellDates?(p.t="d",p.w=yu(p.z,Ts(p.v))):(p.t="n",p.v=Ts(p.v),p.w=yu(p.z,p.v))):p.t="s";if(i)s[E]||(s[E]=[]),s[E][x]&&s[E][x].z&&(p.z=s[E][x].z),s[E][x]=p;else{var w=Vn({c:x,r:E});s[w]&&s[w].z&&(p.z=s[w].z),s[w]=p}}}return u.s.c<1e7&&(s["!ref"]=Lr(u)),s}function W0(n,e){return aV(null,n,e)}function Eme(n){return n.read_shift(4,"i")}function Ja(n,e){return e||(e=Ce(4)),e.write_shift(4,n),e}function zi(n){var e=n.read_shift(4);return e===0?"":n.read_shift(e,"dbcs")}function ai(n,e){var t=!1;return e==null&&(t=!0,e=Ce(4+2*n.length)),e.write_shift(4,n.length),n.length>0&&e.write_shift(0,n,"dbcs"),t?e.slice(0,e.l):e}function wme(n){return{ich:n.read_shift(2),ifnt:n.read_shift(2)}}function Sme(n,e){return e||(e=Ce(4)),e.write_shift(2,0),e.write_shift(2,0),e}function JR(n,e){var t=n.l,r=n.read_shift(1),i=zi(n),s=[],a={t:i,h:i};if((r&1)!==0){for(var o=n.read_shift(4),l=0;l!=o;++l)s.push(wme(n));a.r=s}else a.r=[{ich:0,ifnt:0}];return n.l=t+e,a}function Tme(n,e){var t=!1;return e==null&&(t=!0,e=Ce(15+4*n.t.length)),e.write_shift(1,0),ai(n.t,e),t?e.slice(0,e.l):e}var Ime=JR;function Ame(n,e){var t=!1;return e==null&&(t=!0,e=Ce(23+4*n.t.length)),e.write_shift(1,1),ai(n.t,e),e.write_shift(4,1),Sme({},e),t?e.slice(0,e.l):e}function ba(n){var e=n.read_shift(4),t=n.read_shift(2);return t+=n.read_shift(1)<<16,n.l++,{c:e,iStyleRef:t}}function gd(n,e){return e==null&&(e=Ce(8)),e.write_shift(-4,n.c),e.write_shift(3,n.iStyleRef||n.s),e.write_shift(1,0),e}function md(n){var e=n.read_shift(2);return e+=n.read_shift(1)<<16,n.l++,{c:-1,iStyleRef:e}}function pd(n,e){return e==null&&(e=Ce(4)),e.write_shift(3,n.iStyleRef||n.s),e.write_shift(1,0),e}var bme=zi,oV=ai;function eC(n){var e=n.read_shift(4);return e===0||e===4294967295?"":n.read_shift(e,"dbcs")}function _v(n,e){var t=!1;return e==null&&(t=!0,e=Ce(127)),e.write_shift(4,n.length>0?n.length:4294967295),n.length>0&&e.write_shift(0,n,"dbcs"),t?e.slice(0,e.l):e}var Rme=zi,jI=eC,tC=_v;function lV(n){var e=n.slice(n.l,n.l+4),t=e[0]&1,r=e[0]&2;n.l+=4;var i=r===0?yv([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):dh(e,0)>>2;return t?i/100:i}function cV(n,e){e==null&&(e=Ce(4));var t=0,r=0,i=n*100;if(n==(n|0)&&n>=-536870912&&n<1<<29?r=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(r=1,t=1),r)e.write_shift(-4,((t?i:n)<<2)+(t+2));else throw new Error("unsupported RkNumber "+n)}function uV(n){var e={s:{},e:{}};return e.s.r=n.read_shift(4),e.e.r=n.read_shift(4),e.s.c=n.read_shift(4),e.e.c=n.read_shift(4),e}function Cme(n,e){return e||(e=Ce(16)),e.write_shift(4,n.s.r),e.write_shift(4,n.e.r),e.write_shift(4,n.s.c),e.write_shift(4,n.e.c),e}var yd=uV,H0=Cme;function K0(n){if(n.length-n.l<8)throw"XLS Xnum Buffer underflow";return n.read_shift(8,"f")}function Jh(n,e){return(e||Ce(8)).write_shift(8,n,"f")}function Pme(n){var e={},t=n.read_shift(1),r=t>>>1,i=n.read_shift(1),s=n.read_shift(2,"i"),a=n.read_shift(1),o=n.read_shift(1),l=n.read_shift(1);switch(n.l++,r){case 0:e.auto=1;break;case 1:e.index=i;var u=Vme[i];u&&(e.rgb=SO(u));break;case 2:e.rgb=SO([a,o,l]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function xv(n,e){if(e||(e=Ce(8)),!n||n.auto)return e.write_shift(4,0),e.write_shift(4,0),e;n.index!=null?(e.write_shift(1,2),e.write_shift(1,n.index)):n.theme!=null?(e.write_shift(1,6),e.write_shift(1,n.theme)):(e.write_shift(1,5),e.write_shift(1,0));var t=n.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),e.write_shift(2,t),!n.rgb||n.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var r=n.rgb||"FFFFFF";typeof r=="number"&&(r=("000000"+r.toString(16)).slice(-6)),e.write_shift(1,parseInt(r.slice(0,2),16)),e.write_shift(1,parseInt(r.slice(2,4),16)),e.write_shift(1,parseInt(r.slice(4,6),16)),e.write_shift(1,255)}return e}function kme(n){var e=n.read_shift(1);n.l++;var t={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return t}function Mme(n,e){e||(e=Ce(2));var t=(n.italic?2:0)|(n.strike?8:0)|(n.outline?16:0)|(n.shadow?32:0)|(n.condense?64:0)|(n.extend?128:0);return e.write_shift(1,t),e.write_shift(1,0),e}var hV=2,Vs=3,y_=11,vv=19,__=64,Nme=65,Lme=71,Ome=4108,Dme=4126,yi=80,fO={1:{n:"CodePage",t:hV},2:{n:"Category",t:yi},3:{n:"PresentationFormat",t:yi},4:{n:"ByteCount",t:Vs},5:{n:"LineCount",t:Vs},6:{n:"ParagraphCount",t:Vs},7:{n:"SlideCount",t:Vs},8:{n:"NoteCount",t:Vs},9:{n:"HiddenCount",t:Vs},10:{n:"MultimediaClipCount",t:Vs},11:{n:"ScaleCrop",t:y_},12:{n:"HeadingPairs",t:Ome},13:{n:"TitlesOfParts",t:Dme},14:{n:"Manager",t:yi},15:{n:"Company",t:yi},16:{n:"LinksUpToDate",t:y_},17:{n:"CharacterCount",t:Vs},19:{n:"SharedDoc",t:y_},22:{n:"HyperlinksChanged",t:y_},23:{n:"AppVersion",t:Vs,p:"version"},24:{n:"DigSig",t:Nme},26:{n:"ContentType",t:yi},27:{n:"ContentStatus",t:yi},28:{n:"Language",t:yi},29:{n:"Version",t:yi},255:{},2147483648:{n:"Locale",t:vv},2147483651:{n:"Behavior",t:vv},1919054434:{}},gO={1:{n:"CodePage",t:hV},2:{n:"Title",t:yi},3:{n:"Subject",t:yi},4:{n:"Author",t:yi},5:{n:"Keywords",t:yi},6:{n:"Comments",t:yi},7:{n:"Template",t:yi},8:{n:"LastAuthor",t:yi},9:{n:"RevNumber",t:yi},10:{n:"EditTime",t:__},11:{n:"LastPrinted",t:__},12:{n:"CreatedDate",t:__},13:{n:"ModifiedDate",t:__},14:{n:"PageCount",t:Vs},15:{n:"WordCount",t:Vs},16:{n:"CharCount",t:Vs},17:{n:"Thumbnail",t:Lme},18:{n:"Application",t:yi},19:{n:"DocSecurity",t:Vs},255:{},2147483648:{n:"Locale",t:vv},2147483651:{n:"Behavior",t:vv},1919054434:{}};function Fme(n){return n.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var jme=Fme([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Vme=Is(jme),k1={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Gme={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},x_={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function dV(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function fV(n,e){var t=qge(Gme),r=[],i;r[r.length]=Dr,r[r.length]=tt("Types",null,{xmlns:ri.CT,"xmlns:xsd":ri.xsd,"xmlns:xsi":ri.xsi}),r=r.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return tt("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){n[l]&&n[l].length>0&&(i=n[l][0],r[r.length]=tt("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:x_[l][e.bookType]||x_[l].xlsx}))},a=function(l){(n[l]||[]).forEach(function(u){r[r.length]=tt("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:x_[l][e.bookType]||x_[l].xlsx})})},o=function(l){(n[l]||[]).forEach(function(u){r[r.length]=tt("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:t[l][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),r.length>2&&(r[r.length]="</Types>",r[1]=r[1].replace("/>",">")),r.join("")}var pn={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function gV(n){var e=n.lastIndexOf("/");return n.slice(0,e+1)+"_rels/"+n.slice(e+1)+".rels"}function Qf(n){var e=[Dr,tt("Relationships",null,{xmlns:ri.RELS})];return Ii(n["!id"]).forEach(function(t){e[e.length]=tt("Relationship",null,n["!id"][t])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Ln(n,e,t,r,i,s){if(i||(i={}),n["!id"]||(n["!id"]={}),n["!idx"]||(n["!idx"]=1),e<0)for(e=n["!idx"];n["!id"]["rId"+e];++e);if(n["!idx"]=e+1,i.Id="rId"+e,i.Type=r,i.Target=t,[pn.HLINK,pn.XPATH,pn.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),n["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return n["!id"][i.Id]=i,n[("/"+i.Target).replace("//","/")]=i,e}function Bme(n){var e=[Dr];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<n.length;++t)e.push('  <manifest:file-entry manifest:full-path="'+n[t][0]+'" manifest:media-type="'+n[t][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function mO(n,e,t){return['  <rdf:Description rdf:about="'+n+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function Ume(n,e){return['  <rdf:Description rdf:about="'+n+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function zme(n){var e=[Dr];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=n.length;++t)e.push(mO(n[t][0],n[t][1])),e.push(Ume("",n[t][0]));return e.push(mO("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function mV(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+hv.version+"</meta:generator></office:meta></office:document-meta>"}var Ch=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function jS(n,e,t,r,i){i[n]!=null||e==null||e===""||(i[n]=e,e=Fn(e),r[r.length]=t?tt(n,e,t):Ei(n,e))}function pV(n,e){var t=e||{},r=[Dr,tt("cp:coreProperties",null,{"xmlns:cp":ri.CORE_PROPS,"xmlns:dc":ri.dc,"xmlns:dcterms":ri.dcterms,"xmlns:dcmitype":ri.dcmitype,"xmlns:xsi":ri.xsi})],i={};if(!n&&!t.Props)return r.join("");n&&(n.CreatedDate!=null&&jS("dcterms:created",typeof n.CreatedDate=="string"?n.CreatedDate:FI(n.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i),n.ModifiedDate!=null&&jS("dcterms:modified",typeof n.ModifiedDate=="string"?n.ModifiedDate:FI(n.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i));for(var s=0;s!=Ch.length;++s){var a=Ch[s],o=t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:n?n[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&jS(a[0],o,null,r,i)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var Jf=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],yV=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function _V(n){var e=[],t=tt;return n||(n={}),n.Application="SheetJS",e[e.length]=Dr,e[e.length]=tt("Properties",null,{xmlns:ri.EXT_PROPS,"xmlns:vt":ri.vt}),Jf.forEach(function(r){if(n[r[1]]!==void 0){var i;switch(r[2]){case"string":i=Fn(String(n[r[1]]));break;case"bool":i=n[r[1]]?"true":"false";break}i!==void 0&&(e[e.length]=t(r[0],i))}}),e[e.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(n.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=t("TitlesOfParts",t("vt:vector",n.SheetNames.map(function(r){return"<vt:lpstr>"+Fn(r)+"</vt:lpstr>"}).join(""),{size:n.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}function xV(n){var e=[Dr,tt("Properties",null,{xmlns:ri.CUST_PROPS,"xmlns:vt":ri.vt})];if(!n)return e.join("");var t=1;return Ii(n).forEach(function(i){++t,e[e.length]=tt("property",ome(n[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:Fn(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var pO={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function $me(n,e){var t=[];return Ii(pO).map(function(r){for(var i=0;i<Ch.length;++i)if(Ch[i][1]==r)return Ch[i];for(i=0;i<Jf.length;++i)if(Jf[i][1]==r)return Jf[i];throw r}).forEach(function(r){if(n[r[1]]!=null){var i=e&&e.Props&&e.Props[r[1]]!=null?e.Props[r[1]]:n[r[1]];switch(r[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),t.push(Ei(pO[r[1]]||r[1],i))}}),tt("DocumentProperties",t.join(""),{xmlns:$s.o})}function Wme(n,e){var t=["Worksheets","SheetNames"],r="CustomDocumentProperties",i=[];return n&&Ii(n).forEach(function(s){if(Object.prototype.hasOwnProperty.call(n,s)){for(var a=0;a<Ch.length;++a)if(s==Ch[a][1])return;for(a=0;a<Jf.length;++a)if(s==Jf[a][1])return;for(a=0;a<t.length;++a)if(s==t[a])return;var o=n[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push(tt(rO(s),o,{"dt:dt":l}))}}),e&&Ii(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(n&&Object.prototype.hasOwnProperty.call(n,s))){var a=e[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(tt(rO(s),a,{"dt:dt":o}))}}),"<"+r+' xmlns="'+$s.o+'">'+i.join("")+"</"+r+">"}function Hme(n){var e=typeof n=="string"?new Date(Date.parse(n)):n,t=e.getTime()/1e3+11644473600,r=t%Math.pow(2,32),i=(t-r)/Math.pow(2,32);r*=1e7,i*=1e7;var s=r/Math.pow(2,32)|0;s>0&&(r=r%Math.pow(2,32),i+=s);var a=Ce(8);return a.write_shift(4,r),a.write_shift(4,i),a}function yO(n,e){var t=Ce(4),r=Ce(4);switch(t.write_shift(4,n==80?31:n),n){case 3:r.write_shift(-4,e);break;case 5:r=Ce(8),r.write_shift(8,e,"f");break;case 11:r.write_shift(4,e?1:0);break;case 64:r=Hme(e);break;case 31:case 80:for(r=Ce(4+2*(e.length+1)+(e.length%2?0:2)),r.write_shift(4,e.length+1),r.write_shift(0,e,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+e)}return vi([t,r])}var vV=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Kme(n){switch(typeof n){case"boolean":return 11;case"number":return(n|0)==n?3:5;case"string":return 31;case"object":if(n instanceof Date)return 64;break}return-1}function _O(n,e,t){var r=Ce(8),i=[],s=[],a=8,o=0,l=Ce(8),u=Ce(8);if(l.write_shift(4,2),l.write_shift(4,1200),u.write_shift(4,1),s.push(l),i.push(u),a+=8+l.length,!e){u=Ce(8),u.write_shift(4,0),i.unshift(u);var h=[Ce(4)];for(h[0].write_shift(4,n.length),o=0;o<n.length;++o){var f=n[o][0];for(l=Ce(8+2*(f.length+1)+(f.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,f.length+1),l.write_shift(0,f,"dbcs");l.l!=l.length;)l.write_shift(1,0);h.push(l)}l=vi(h),s.unshift(l),a+=8+l.length}for(o=0;o<n.length;++o)if(!(e&&!e[n[o][0]])&&!(vV.indexOf(n[o][0])>-1||yV.indexOf(n[o][0])>-1)&&n[o][1]!=null){var g=n[o][1],p=0;if(e){p=+e[n[o][0]];var E=t[p];if(E.p=="version"&&typeof g=="string"){var x=g.split(".");g=(+x[0]<<16)+(+x[1]||0)}l=yO(E.t,g)}else{var w=Kme(g);w==-1&&(w=31,g=String(g)),l=yO(w,g)}s.push(l),u=Ce(8),u.write_shift(4,e?p:2+o),i.push(u),a+=8+l.length}var T=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,T),T+=s[o].length;return r.write_shift(4,a),r.write_shift(4,s.length),vi([r].concat(i).concat(s))}function xO(n,e,t,r,i,s){var a=Ce(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,Gn.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,i?68:48);var l=_O(n,t,r);if(o.push(l),i){var u=_O(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+l.length),o.push(u)}return vi(o)}function Yme(n,e){e||(e=Ce(n));for(var t=0;t<n;++t)e.write_shift(1,0);return e}function Xme(n,e){return n.read_shift(e)===1}function Xi(n,e){return e||(e=Ce(2)),e.write_shift(2,+!!n),e}function EV(n){return n.read_shift(2,"u")}function ma(n,e){return e||(e=Ce(2)),e.write_shift(2,n),e}function wV(n,e,t){return t||(t=Ce(2)),t.write_shift(1,e=="e"?+n:+!!n),t.write_shift(1,e=="e"?1:0),t}function SV(n,e,t){var r=n.read_shift(t&&t.biff>=12?2:1),i="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var s=n.read_shift(1);s&&(i="dbcs-cont")}else t.biff==12&&(i="wstr");t.biff>=2&&t.biff<=5&&(i="cpstr");var a=r?n.read_shift(r,i):"";return a}function qme(n){var e=n.t||"",t=Ce(3);t.write_shift(2,e.length),t.write_shift(1,1);var r=Ce(2*e.length);r.write_shift(2*e.length,e,"utf16le");var i=[t,r];return vi(i)}function Zme(n,e,t){var r;if(t){if(t.biff>=2&&t.biff<=5)return n.read_shift(e,"cpstr");if(t.biff>=12)return n.read_shift(e,"dbcs-cont")}var i=n.read_shift(1);return i===0?r=n.read_shift(e,"sbcs-cont"):r=n.read_shift(e,"dbcs-cont"),r}function Qme(n,e,t){var r=n.read_shift(t&&t.biff==2?1:2);return r===0?(n.l++,""):Zme(n,r,t)}function Jme(n,e,t){if(t.biff>5)return Qme(n,e,t);var r=n.read_shift(1);return r===0?(n.l++,""):n.read_shift(r,t.biff<=4||!n.lens?"cpstr":"sbcs-cont")}function TV(n,e,t){return t||(t=Ce(3+2*n.length)),t.write_shift(2,n.length),t.write_shift(1,1),t.write_shift(31,n,"utf16le"),t}function vO(n,e){e||(e=Ce(6+n.length*2)),e.write_shift(4,1+n.length);for(var t=0;t<n.length;++t)e.write_shift(2,n.charCodeAt(t));return e.write_shift(2,0),e}function epe(n){var e=Ce(512),t=0,r=n.Target;r.slice(0,7)=="file://"&&(r=r.slice(7));var i=r.indexOf("#"),s=i>-1?31:23;switch(r.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(t=0;t<a.length;++t)e.write_shift(4,a[t]);if(s==28)r=r.slice(1),vO(r,e);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<a.length;++t)e.write_shift(1,parseInt(a[t],16));var o=i>-1?r.slice(0,i):r;for(e.write_shift(4,2*(o.length+1)),t=0;t<o.length;++t)e.write_shift(2,o.charCodeAt(t));e.write_shift(2,0),s&8&&vO(i>-1?r.slice(i+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<a.length;++t)e.write_shift(1,parseInt(a[t],16));for(var l=0;r.slice(l*3,l*3+3)=="../"||r.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,r.length-3*l+1),t=0;t<r.length-3*l;++t)e.write_shift(1,r.charCodeAt(t+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),t=0;t<6;++t)e.write_shift(4,0)}return e.slice(0,e.l)}function ed(n,e,t,r){return r||(r=Ce(6)),r.write_shift(2,n),r.write_shift(2,e),r.write_shift(2,t||0),r}function tpe(n,e,t){var r=t.biff>8?4:2,i=n.read_shift(r),s=n.read_shift(r,"i"),a=n.read_shift(r,"i");return[i,s,a]}function npe(n){var e=n.read_shift(2),t=n.read_shift(2),r=n.read_shift(2),i=n.read_shift(2);return{s:{c:r,r:e},e:{c:i,r:t}}}function IV(n,e){return e||(e=Ce(8)),e.write_shift(2,n.s.r),e.write_shift(2,n.e.r),e.write_shift(2,n.s.c),e.write_shift(2,n.e.c),e}function nC(n,e,t){var r=1536,i=16;switch(t.bookType){case"biff8":break;case"biff5":r=1280,i=8;break;case"biff4":r=4,i=6;break;case"biff3":r=3,i=6;break;case"biff2":r=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=Ce(i);return s.write_shift(2,r),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function rpe(n,e){var t=!e||e.biff==8,r=Ce(t?112:54);for(r.write_shift(e.biff==8?2:1,7),t&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(t?0:536870912));r.l<r.length;)r.write_shift(1,t?0:32);return r}function ipe(n,e){var t=!e||e.biff>=8?2:1,r=Ce(8+t*n.name.length);r.write_shift(4,n.pos),r.write_shift(1,n.hs||0),r.write_shift(1,n.dt),r.write_shift(1,n.name.length),e.biff>=8&&r.write_shift(1,1),r.write_shift(t*n.name.length,n.name,e.biff<8?"sbcs":"utf16le");var i=r.slice(0,r.l);return i.l=r.l,i}function spe(n,e){var t=Ce(8);t.write_shift(4,n.Count),t.write_shift(4,n.Unique);for(var r=[],i=0;i<n.length;++i)r[i]=qme(n[i]);var s=vi([t].concat(r));return s.parts=[t.length].concat(r.map(function(a){return a.length})),s}function ape(){var n=Ce(18);return n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,29280),n.write_shift(2,17600),n.write_shift(2,56),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,1),n.write_shift(2,500),n}function ope(n){var e=Ce(18),t=1718;return n&&n.RTL&&(t|=64),e.write_shift(2,t),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function lpe(n,e){var t=n.name||"Arial",r=e&&e.biff==5,i=r?15+t.length:16+2*t.length,s=Ce(i);return s.write_shift(2,n.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,t.length),r||s.write_shift(1,1),s.write_shift((r?1:2)*t.length,t,r?"sbcs":"utf16le"),s}function cpe(n,e,t,r){var i=Ce(10);return ed(n,e,r,i),i.write_shift(4,t),i}function upe(n,e,t,r,i){var s=!i||i.biff==8,a=Ce(8+ +s+(1+s)*t.length);return ed(n,e,r,a),a.write_shift(2,t.length),s&&a.write_shift(1,1),a.write_shift((1+s)*t.length,t,s?"utf16le":"sbcs"),a}function hpe(n,e,t,r){var i=t&&t.biff==5;r||(r=Ce(i?3+e.length:5+2*e.length)),r.write_shift(2,n),r.write_shift(i?1:2,e.length),i||r.write_shift(1,1),r.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=r.length>r.l?r.slice(0,r.l):r;return s.l==null&&(s.l=s.length),s}function dpe(n,e){var t=e.biff==8||!e.biff?4:2,r=Ce(2*t+6);return r.write_shift(t,n.s.r),r.write_shift(t,n.e.r+1),r.write_shift(2,n.s.c),r.write_shift(2,n.e.c+1),r.write_shift(2,0),r}function EO(n,e,t,r){var i=t&&t.biff==5;r||(r=Ce(i?16:20)),r.write_shift(2,0),n.style?(r.write_shift(2,n.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,n.numFmtId||0),r.write_shift(2,e<<4));var s=0;return n.numFmtId>0&&i&&(s|=1024),r.write_shift(4,s),r.write_shift(4,0),i||r.write_shift(4,0),r.write_shift(2,0),r}function fpe(n){var e=Ce(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function gpe(n,e,t,r,i,s){var a=Ce(8);return ed(n,e,r,a),wV(t,s,a),a}function mpe(n,e,t,r){var i=Ce(14);return ed(n,e,r,i),Jh(t,i),i}function ppe(n,e,t){if(t.biff<8)return ype(n,e,t);for(var r=[],i=n.l+e,s=n.read_shift(t.biff>8?4:2);s--!==0;)r.push(tpe(n,t.biff>8?12:6,t));if(n.l!=i)throw new Error("Bad ExternSheet: "+n.l+" != "+i);return r}function ype(n,e,t){n[n.l+1]==3&&n[n.l]++;var r=SV(n,e,t);return r.charCodeAt(0)==3?r.slice(1):r}function _pe(n){var e=Ce(2+n.length*8);e.write_shift(2,n.length);for(var t=0;t<n.length;++t)IV(n[t],e);return e}function xpe(n){var e=Ce(24),t=si(n[0]);e.write_shift(2,t.r),e.write_shift(2,t.r),e.write_shift(2,t.c),e.write_shift(2,t.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(r[i],16));return vi([e,epe(n[1])])}function vpe(n){var e=n[1].Tooltip,t=Ce(10+2*(e.length+1));t.write_shift(2,2048);var r=si(n[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var i=0;i<e.length;++i)t.write_shift(2,e.charCodeAt(i));return t.write_shift(2,0),t}function Epe(n){return n||(n=Ce(4)),n.write_shift(2,1),n.write_shift(2,1),n}function wpe(n,e,t){if(!t.cellStyles)return Xo(n,e);var r=t&&t.biff>=12?4:2,i=n.read_shift(r),s=n.read_shift(r),a=n.read_shift(r),o=n.read_shift(r),l=n.read_shift(2);r==2&&(n.l+=2);var u={s:i,e:s,w:a,ixfe:o,flags:l};return(t.biff>=5||!t.biff)&&(u.level=l>>8&7),u}function Spe(n,e){var t=Ce(12);t.write_shift(2,e),t.write_shift(2,e),t.write_shift(2,n.width*256),t.write_shift(2,0);var r=0;return n.hidden&&(r|=1),t.write_shift(1,r),r=n.level||0,t.write_shift(1,r),t.write_shift(2,0),t}function Tpe(n){for(var e=Ce(2*n),t=0;t<n;++t)e.write_shift(2,t+1);return e}function Ipe(n,e,t){var r=Ce(15);return N1(r,n,e),r.write_shift(8,t,"f"),r}function Ape(n,e,t){var r=Ce(9);return N1(r,n,e),r.write_shift(2,t),r}var bpe=(function(){var n={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=WR({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(o,l){var u=[],h=Qh(1);switch(l.type){case"base64":h=Wa(Ul(o));break;case"binary":h=Wa(o);break;case"buffer":case"array":h=o;break}Bs(h,0);var f=h.read_shift(1),g=!!(f&136),p=!1,E=!1;switch(f){case 2:break;case 3:break;case 48:p=!0,g=!0;break;case 49:p=!0,g=!0;break;case 131:break;case 139:break;case 140:E=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var x=0,w=521;f==2&&(x=h.read_shift(2)),h.l+=3,f!=2&&(x=h.read_shift(4)),x>1048576&&(x=1e6),f!=2&&(w=h.read_shift(2));var T=h.read_shift(2),I=l.codepage||1252;f!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(I=n[h[h.l]]),h.l+=1,h.l+=2),E&&(h.l+=36);for(var P=[],N={},D=Math.min(h.length,f==2?521:w-10-(p?264:0)),B=E?32:11;h.l<D&&h[h.l]!=13;)switch(N={},N.name=dv.utils.decode(I,h.slice(h.l,h.l+B)).replace(/[\u0000\r\n].*$/g,""),h.l+=B,N.type=String.fromCharCode(h.read_shift(1)),f!=2&&!E&&(N.offset=h.read_shift(4)),N.len=h.read_shift(1),f==2&&(N.offset=h.read_shift(2)),N.dec=h.read_shift(1),N.name.length&&P.push(N),f!=2&&(h.l+=E?13:14),N.type){case"B":(!p||N.len!=8)&&l.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+N.type)}if(h[h.l]!==13&&(h.l=w-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=w;var k=0,C=0;for(u[0]=[],C=0;C!=P.length;++C)u[0][C]=P[C].name;for(;x-- >0;){if(h[h.l]===42){h.l+=T;continue}for(++h.l,u[++k]=[],C=0,C=0;C!=P.length;++C){var M=h.slice(h.l,h.l+P[C].len);h.l+=P[C].len,Bs(M,0);var j=dv.utils.decode(I,M);switch(P[C].type){case"C":j.trim().length&&(u[k][C]=j.replace(/\s+$/,""));break;case"D":j.length===8?u[k][C]=new Date(+j.slice(0,4),+j.slice(4,6)-1,+j.slice(6,8)):u[k][C]=j;break;case"F":u[k][C]=parseFloat(j.trim());break;case"+":case"I":u[k][C]=E?M.read_shift(-4,"i")^2147483648:M.read_shift(4,"i");break;case"L":switch(j.trim().toUpperCase()){case"Y":case"T":u[k][C]=!0;break;case"N":case"F":u[k][C]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+j+"|")}break;case"M":if(!g)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[k][C]="##MEMO##"+(E?parseInt(j.trim(),10):M.read_shift(4));break;case"N":j=j.replace(/\u0000/g,"").trim(),j&&j!="."&&(u[k][C]=+j||0);break;case"@":u[k][C]=new Date(M.read_shift(-8,"f")-621356832e5);break;case"T":u[k][C]=new Date((M.read_shift(4)-2440588)*864e5+M.read_shift(4));break;case"Y":u[k][C]=M.read_shift(4,"i")/1e4+M.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[k][C]=-M.read_shift(-8,"f");break;case"B":if(p&&P[C].len==8){u[k][C]=M.read_shift(8,"f");break}case"G":case"P":M.l+=P[C].len;break;case"0":if(P[C].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+P[C].type)}}}if(f!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=P,u}function r(o,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var h=W0(t(o,u),u);return h["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,h}function i(o,l){try{return fd(r(o,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var u=l||{};if(+u.codepage>=0&&bp(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var h=ws(),f=Iv(o,{header:1,raw:!0,cellDates:!0}),g=f[0],p=f.slice(1),E=o["!cols"]||[],x=0,w=0,T=0,I=1;for(x=0;x<g.length;++x){if(((E[x]||{}).DBF||{}).name){g[x]=E[x].DBF.name,++T;continue}if(g[x]!=null){if(++T,typeof g[x]=="number"&&(g[x]=g[x].toString(10)),typeof g[x]!="string")throw new Error("DBF Invalid column name "+g[x]+" |"+typeof g[x]+"|");if(g.indexOf(g[x])!==x){for(w=0;w<1024;++w)if(g.indexOf(g[x]+"_"+w)==-1){g[x]+="_"+w;break}}}}var P=Zn(o["!ref"]),N=[],D=[],B=[];for(x=0;x<=P.e.c-P.s.c;++x){var k="",C="",M=0,j=[];for(w=0;w<p.length;++w)p[w][x]!=null&&j.push(p[w][x]);if(j.length==0||g[x]==null){N[x]="?";continue}for(w=0;w<j.length;++w){switch(typeof j[w]){case"number":C="B";break;case"string":C="C";break;case"boolean":C="L";break;case"object":C=j[w]instanceof Date?"D":"C";break;default:C="C"}M=Math.max(M,String(j[w]).length),k=k&&k!=C?"C":C}M>250&&(M=250),C=((E[x]||{}).DBF||{}).type,C=="C"&&E[x].DBF.len>M&&(M=E[x].DBF.len),k=="B"&&C=="N"&&(k="N",B[x]=E[x].DBF.dec,M=E[x].DBF.len),D[x]=k=="C"||C=="N"?M:s[k]||0,I+=D[x],N[x]=k}var O=h.next(32);for(O.write_shift(4,318902576),O.write_shift(4,p.length),O.write_shift(2,296+32*T),O.write_shift(2,I),x=0;x<4;++x)O.write_shift(4,0);for(O.write_shift(4,0|(+e[b7]||3)<<8),x=0,w=0;x<g.length;++x)if(g[x]!=null){var W=h.next(32),F=(g[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);W.write_shift(1,F,"sbcs"),W.write_shift(1,N[x]=="?"?"C":N[x],"sbcs"),W.write_shift(4,w),W.write_shift(1,D[x]||s[N[x]]||0),W.write_shift(1,B[x]||0),W.write_shift(1,2),W.write_shift(4,0),W.write_shift(1,0),W.write_shift(4,0),W.write_shift(4,0),w+=D[x]||s[N[x]]||0}var Te=h.next(264);for(Te.write_shift(4,13),x=0;x<65;++x)Te.write_shift(4,0);for(x=0;x<p.length;++x){var Me=h.next(I);for(Me.write_shift(1,0),w=0;w<g.length;++w)if(g[w]!=null)switch(N[w]){case"L":Me.write_shift(1,p[x][w]==null?63:p[x][w]?84:70);break;case"B":Me.write_shift(8,p[x][w]||0,"f");break;case"N":var Le="0";for(typeof p[x][w]=="number"&&(Le=p[x][w].toFixed(B[w]||0)),T=0;T<D[w]-Le.length;++T)Me.write_shift(1,32);Me.write_shift(1,Le,"sbcs");break;case"D":p[x][w]?(Me.write_shift(4,("0000"+p[x][w].getFullYear()).slice(-4),"sbcs"),Me.write_shift(2,("00"+(p[x][w].getMonth()+1)).slice(-2),"sbcs"),Me.write_shift(2,("00"+p[x][w].getDate()).slice(-2),"sbcs")):Me.write_shift(8,"00000000","sbcs");break;case"C":var Re=String(p[x][w]!=null?p[x][w]:"").slice(0,D[w]);for(Me.write_shift(1,Re,"sbcs"),T=0;T<D[w]-Re.length;++T)Me.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:i,to_sheet:r,from_sheet:a}})(),Rpe=(function(){var n={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Ii(n).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(g,p){var E=n[p];return typeof E=="number"?WL(E):E},r=function(g,p,E){var x=p.charCodeAt(0)-32<<4|E.charCodeAt(0)-48;return x==59?g:WL(x)};n["|"]=254;function i(g,p){switch(p.type){case"base64":return s(Ul(g),p);case"binary":return s(g,p);case"buffer":return s(En&&Buffer.isBuffer(g)?g.toString("binary"):R1(g),p);case"array":return s(zE(g),p)}throw new Error("Unrecognized type "+p.type)}function s(g,p){var E=g.split(/[\n\r]+/),x=-1,w=-1,T=0,I=0,P=[],N=[],D=null,B={},k=[],C=[],M=[],j=0,O;for(+p.codepage>=0&&bp(+p.codepage);T!==E.length;++T){j=0;var W=E[T].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(e,t),F=W.replace(/;;/g,"\0").split(";").map(function(ee){return ee.replace(/\u0000/g,";")}),Te=F[0],Me;if(W.length>0)switch(Te){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":F[1].charAt(0)=="P"&&N.push(W.slice(3).replace(/;;/g,";"));break;case"C":var Le=!1,Re=!1,ue=!1,be=!1,ce=-1,te=-1;for(I=1;I<F.length;++I)switch(F[I].charAt(0)){case"A":break;case"X":w=parseInt(F[I].slice(1))-1,Re=!0;break;case"Y":for(x=parseInt(F[I].slice(1))-1,Re||(w=0),O=P.length;O<=x;++O)P[O]=[];break;case"K":Me=F[I].slice(1),Me.charAt(0)==='"'?Me=Me.slice(1,Me.length-1):Me==="TRUE"?Me=!0:Me==="FALSE"?Me=!1:isNaN(Nl(Me))?isNaN(Cp(Me).getDate())||(Me=ns(Me)):(Me=Nl(Me),D!==null&&V7(D)&&(Me=z7(Me))),Le=!0;break;case"E":be=!0;var V=A1e(F[I].slice(1),{r:x,c:w});P[x][w]=[P[x][w],V];break;case"S":ue=!0,P[x][w]=[P[x][w],"S5S"];break;case"G":break;case"R":ce=parseInt(F[I].slice(1))-1;break;case"C":te=parseInt(F[I].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+W)}if(Le&&(P[x][w]&&P[x][w].length==2?P[x][w][0]=Me:P[x][w]=Me,D=null),ue){if(be)throw new Error("SYLK shared formula cannot have own formula");var ie=ce>-1&&P[ce][te];if(!ie||!ie[1])throw new Error("SYLK shared formula cannot find base");P[x][w][1]=b1e(ie[1],{r:x-ce,c:w-te})}break;case"F":var ne=0;for(I=1;I<F.length;++I)switch(F[I].charAt(0)){case"X":w=parseInt(F[I].slice(1))-1,++ne;break;case"Y":for(x=parseInt(F[I].slice(1))-1,O=P.length;O<=x;++O)P[O]=[];break;case"M":j=parseInt(F[I].slice(1))/20;break;case"F":break;case"G":break;case"P":D=N[parseInt(F[I].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(M=F[I].slice(1).split(" "),O=parseInt(M[0],10);O<=parseInt(M[1],10);++O)j=parseInt(M[2],10),C[O-1]=j===0?{hidden:!0}:{wch:j},rC(C[O-1]);break;case"C":w=parseInt(F[I].slice(1))-1,C[w]||(C[w]={});break;case"R":x=parseInt(F[I].slice(1))-1,k[x]||(k[x]={}),j>0?(k[x].hpt=j,k[x].hpx=PV(j)):j===0&&(k[x].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+W)}ne<1&&(D=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+W)}}return k.length>0&&(B["!rows"]=k),C.length>0&&(B["!cols"]=C),p&&p.sheetRows&&(P=P.slice(0,p.sheetRows)),[P,B]}function a(g,p){var E=i(g,p),x=E[0],w=E[1],T=W0(x,p);return Ii(w).forEach(function(I){T[I]=w[I]}),T}function o(g,p){return fd(a(g,p),p)}function l(g,p,E,x){var w="C;Y"+(E+1)+";X"+(x+1)+";K";switch(g.t){case"n":w+=g.v||0,g.f&&!g.F&&(w+=";E"+sC(g.f,{r:E,c:x}));break;case"b":w+=g.v?"TRUE":"FALSE";break;case"e":w+=g.w||g.v;break;case"d":w+='"'+(g.w||g.v)+'"';break;case"s":w+='"'+g.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function u(g,p){p.forEach(function(E,x){var w="F;W"+(x+1)+" "+(x+1)+" ";E.hidden?w+="0":(typeof E.width=="number"&&!E.wpx&&(E.wpx=Ev(E.width)),typeof E.wpx=="number"&&!E.wch&&(E.wch=wv(E.wpx)),typeof E.wch=="number"&&(w+=Math.round(E.wch))),w.charAt(w.length-1)!=" "&&g.push(w)})}function h(g,p){p.forEach(function(E,x){var w="F;";E.hidden?w+="M0;":E.hpt?w+="M"+20*E.hpt+";":E.hpx&&(w+="M"+20*Sv(E.hpx)+";"),w.length>2&&g.push(w+"R"+(x+1))})}function f(g,p){var E=["ID;PWXL;N;E"],x=[],w=Zn(g["!ref"]),T,I=Array.isArray(g),P=`\r
`;E.push("P;PGeneral"),E.push("F;P0;DG0G8;M255"),g["!cols"]&&u(E,g["!cols"]),g["!rows"]&&h(E,g["!rows"]),E.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var N=w.s.r;N<=w.e.r;++N)for(var D=w.s.c;D<=w.e.c;++D){var B=Vn({r:N,c:D});T=I?(g[N]||[])[D]:g[B],!(!T||T.v==null&&(!T.f||T.F))&&x.push(l(T,g,N,D))}return E.join(P)+P+x.join(P)+P+"E"+P}return{to_workbook:o,to_sheet:a,from_sheet:f}})(),Cpe=(function(){function n(s,a){switch(a.type){case"base64":return e(Ul(s),a);case"binary":return e(s,a);case"buffer":return e(En&&Buffer.isBuffer(s)?s.toString("binary"):R1(s),a);case"array":return e(zE(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var o=s.split(`
`),l=-1,u=-1,h=0,f=[];h!==o.length;++h){if(o[h].trim()==="BOT"){f[++l]=[],u=0;continue}if(!(l<0)){var g=o[h].trim().split(","),p=g[0],E=g[1];++h;for(var x=o[h]||"";(x.match(/["]/g)||[]).length&1&&h<o.length-1;)x+=`
`+o[++h];switch(x=x.trim(),+p){case-1:if(x==="BOT"){f[++l]=[],u=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?f[l][u]=!0:x==="FALSE"?f[l][u]=!1:isNaN(Nl(E))?isNaN(Cp(E).getDate())?f[l][u]=E:f[l][u]=ns(E):f[l][u]=Nl(E),++u;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),f[l][u++]=x!==""?x:null;break}if(x==="EOD")break}}return a&&a.sheetRows&&(f=f.slice(0,a.sheetRows)),f}function t(s,a){return W0(n(s,a),a)}function r(s,a){return fd(t(s,a),a)}var i=(function(){var s=function(l,u,h,f,g){l.push(u),l.push(h+","+f),l.push('"'+g.replace(/"/g,'""')+'"')},a=function(l,u,h,f){l.push(u+","+h),l.push(u==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(l){var u=[],h=Zn(l["!ref"]),f,g=Array.isArray(l);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,h.e.r-h.s.r+1,""),s(u,"TUPLES",0,h.e.c-h.s.c+1,""),s(u,"DATA",0,0,"");for(var p=h.s.r;p<=h.e.r;++p){a(u,-1,0,"BOT");for(var E=h.s.c;E<=h.e.c;++E){var x=Vn({r:p,c:E});if(f=g?(l[p]||[])[E]:l[x],!f){a(u,1,0,"");continue}switch(f.t){case"n":var w=f.w;!w&&f.v!=null&&(w=f.v),w==null?f.f&&!f.F?a(u,1,0,"="+f.f):a(u,1,0,""):a(u,0,w,"V");break;case"b":a(u,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":a(u,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=yu(f.z||_r[14],Ts(ns(f.v)))),a(u,0,f.w,"V");break;default:a(u,1,0,"")}}}a(u,-1,0,"EOD");var T=`\r
`,I=u.join(T);return I}})();return{to_workbook:r,to_sheet:t,from_sheet:i}})(),AV=(function(){function n(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(f,g){for(var p=f.split(`
`),E=-1,x=-1,w=0,T=[];w!==p.length;++w){var I=p[w].trim().split(":");if(I[0]==="cell"){var P=si(I[1]);if(T.length<=P.r)for(E=T.length;E<=P.r;++E)T[E]||(T[E]=[]);switch(E=P.r,x=P.c,I[2]){case"t":T[E][x]=n(I[3]);break;case"v":T[E][x]=+I[3];break;case"vtf":var N=I[I.length-1];case"vtc":switch(I[3]){case"nl":T[E][x]=!!+I[4];break;default:T[E][x]=+I[4];break}I[2]=="vtf"&&(T[E][x]=[T[E][x],N])}}}return g&&g.sheetRows&&(T=T.slice(0,g.sheetRows)),T}function r(f,g){return W0(t(f,g),g)}function i(f,g){return fd(r(f,g),g)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var g=[],p=[],E,x="",w=ta(f["!ref"]),T=Array.isArray(f),I=w.s.r;I<=w.e.r;++I)for(var P=w.s.c;P<=w.e.c;++P)if(x=Vn({r:I,c:P}),E=T?(f[I]||[])[P]:f[x],!(!E||E.v==null||E.t==="z")){switch(p=["cell",x,"t"],E.t){case"s":case"str":p.push(e(E.v));break;case"n":E.f?(p[2]="vtf",p[3]="n",p[4]=E.v,p[5]=e(E.f)):(p[2]="v",p[3]=E.v);break;case"b":p[2]="vt"+(E.f?"f":"c"),p[3]="nl",p[4]=E.v?"1":"0",p[5]=e(E.f||(E.v?"TRUE":"FALSE"));break;case"d":var N=Ts(ns(E.v));p[2]="vtc",p[3]="nd",p[4]=""+N,p[5]=E.w||yu(E.z||_r[14],N);break;case"e":continue}g.push(p.join(":"))}return g.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)}function h(f){return[s,a,o,a,u(f),l].join(`
`)}return{to_workbook:i,to_sheet:r,from_sheet:h}})(),Ppe=(function(){function n(h,f,g,p,E){E.raw?f[g][p]=h:h===""||(h==="TRUE"?f[g][p]=!0:h==="FALSE"?f[g][p]=!1:isNaN(Nl(h))?isNaN(Cp(h).getDate())?f[g][p]=h:f[g][p]=ns(h):f[g][p]=Nl(h))}function e(h,f){var g=f||{},p=[];if(!h||h.length===0)return p;for(var E=h.split(/[\r\n]/),x=E.length-1;x>=0&&E[x].length===0;)--x;for(var w=10,T=0,I=0;I<=x;++I)T=E[I].indexOf(" "),T==-1?T=E[I].length:T++,w=Math.max(w,T);for(I=0;I<=x;++I){p[I]=[];var P=0;for(n(E[I].slice(0,w).trim(),p,I,P,g),P=1;P<=(E[I].length-w)/10+1;++P)n(E[I].slice(w+(P-1)*10,w+P*10).trim(),p,I,P,g)}return g.sheetRows&&(p=p.slice(0,g.sheetRows)),p}var t={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function i(h){for(var f={},g=!1,p=0,E=0;p<h.length;++p)(E=h.charCodeAt(p))==34?g=!g:!g&&E in t&&(f[E]=(f[E]||0)+1);E=[];for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&E.push([f[p],p]);if(!E.length){f=r;for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&E.push([f[p],p])}return E.sort(function(x,w){return x[0]-w[0]||r[x[1]]-r[w[1]]}),t[E.pop()[1]]||44}function s(h,f){var g=f||{},p="",E=g.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(p=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(p=h.charAt(4),h=h.slice(6)):p=i(h.slice(0,1024)):g&&g.FS?p=g.FS:p=i(h.slice(0,1024));var w=0,T=0,I=0,P=0,N=0,D=p.charCodeAt(0),B=!1,k=0,C=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var M=g.dateNF!=null?Hge(g.dateNF):null;function j(){var O=h.slice(P,N),W={};if(O.charAt(0)=='"'&&O.charAt(O.length-1)=='"'&&(O=O.slice(1,-1).replace(/""/g,'"')),O.length===0)W.t="z";else if(g.raw)W.t="s",W.v=O;else if(O.trim().length===0)W.t="s",W.v=O;else if(O.charCodeAt(0)==61)O.charCodeAt(1)==34&&O.charCodeAt(O.length-1)==34?(W.t="s",W.v=O.slice(2,-1).replace(/""/g,'"')):R1e(O)?(W.t="n",W.f=O.slice(1)):(W.t="s",W.v=O);else if(O=="TRUE")W.t="b",W.v=!0;else if(O=="FALSE")W.t="b",W.v=!1;else if(!isNaN(I=Nl(O)))W.t="n",g.cellText!==!1&&(W.w=O),W.v=I;else if(!isNaN(Cp(O).getDate())||M&&O.match(M)){W.z=g.dateNF||_r[14];var F=0;M&&O.match(M)&&(O=Kge(O,g.dateNF,O.match(M)||[]),F=1),g.cellDates?(W.t="d",W.v=ns(O,F)):(W.t="n",W.v=Ts(ns(O,F))),g.cellText!==!1&&(W.w=yu(W.z,W.v instanceof Date?Ts(W.v):W.v)),g.cellNF||delete W.z}else W.t="s",W.v=O;if(W.t=="z"||(g.dense?(E[w]||(E[w]=[]),E[w][T]=W):E[Vn({c:T,r:w})]=W),P=N+1,C=h.charCodeAt(P),x.e.c<T&&(x.e.c=T),x.e.r<w&&(x.e.r=w),k==D)++T;else if(T=0,++w,g.sheetRows&&g.sheetRows<=w)return!0}e:for(;N<h.length;++N)switch(k=h.charCodeAt(N)){case 34:C===34&&(B=!B);break;case D:case 10:case 13:if(!B&&j())break e;break}return N-P>0&&j(),E["!ref"]=Lr(x),E}function a(h,f){return!(f&&f.PRN)||f.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?s(h,f):W0(e(h,f),f)}function o(h,f){var g="",p=f.type=="string"?[0,0,0,0]:Uve(h,f);switch(f.type){case"base64":g=Ul(h);break;case"binary":g=h;break;case"buffer":f.codepage==65001?g=h.toString("utf8"):f.codepage&&typeof dv<"u"||(g=En&&Buffer.isBuffer(h)?h.toString("binary"):R1(h));break;case"array":g=zE(h);break;case"string":g=h;break;default:throw new Error("Unrecognized type "+f.type)}return p[0]==239&&p[1]==187&&p[2]==191?g=Dm(g.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?g=Dm(g):f.type=="binary"&&typeof dv<"u",g.slice(0,19)=="socialcalc:version:"?AV.to_sheet(f.type=="string"?g:Dm(g),f):a(g,f)}function l(h,f){return fd(o(h,f),f)}function u(h){for(var f=[],g=Zn(h["!ref"]),p,E=Array.isArray(h),x=g.s.r;x<=g.e.r;++x){for(var w=[],T=g.s.c;T<=g.e.c;++T){var I=Vn({r:x,c:T});if(p=E?(h[x]||[])[T]:h[I],!p||p.v==null){w.push("          ");continue}for(var P=(p.w||(zl(p),p.w)||"").slice(0,10);P.length<10;)P+=" ";w.push(P+(T===0?" ":""))}f.push(w.join(""))}return f.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:u}})(),wO=(function(){function n(V,ie,ne){if(V){Bs(V,V.l||0);for(var ee=ne.Enum||ce;V.l<V.length;){var fe=V.read_shift(2),Oe=ee[fe]||ee[65535],Se=V.read_shift(2),Fe=V.l+Se,je=Oe.f&&Oe.f(V,Se,ne);if(V.l=Fe,ie(je,Oe,fe))return}}}function e(V,ie){switch(ie.type){case"base64":return t(Wa(Ul(V)),ie);case"binary":return t(Wa(V),ie);case"buffer":case"array":return t(V,ie)}throw"Unsupported type "+ie.type}function t(V,ie){if(!V)return V;var ne=ie||{},ee=ne.dense?[]:{},fe="Sheet1",Oe="",Se=0,Fe={},je=[],Qe=[],gt={s:{r:0,c:0},e:{r:0,c:0}},yt=ne.sheetRows||0;if(V[2]==0&&(V[3]==8||V[3]==9)&&V.length>=16&&V[14]==5&&V[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(V[2]==2)ne.Enum=ce,n(V,function(De,Xt,Ie){switch(Ie){case 0:ne.vers=De,De>=4096&&(ne.qpro=!0);break;case 6:gt=De;break;case 204:De&&(Oe=De);break;case 222:Oe=De;break;case 15:case 51:ne.qpro||(De[1].v=De[1].v.slice(1));case 13:case 14:case 16:Ie==14&&(De[2]&112)==112&&(De[2]&15)>1&&(De[2]&15)<15&&(De[1].z=ne.dateNF||_r[14],ne.cellDates&&(De[1].t="d",De[1].v=z7(De[1].v))),ne.qpro&&De[3]>Se&&(ee["!ref"]=Lr(gt),Fe[fe]=ee,je.push(fe),ee=ne.dense?[]:{},gt={s:{r:0,c:0},e:{r:0,c:0}},Se=De[3],fe=Oe||"Sheet"+(Se+1),Oe="");var me=ne.dense?(ee[De[0].r]||[])[De[0].c]:ee[Vn(De[0])];if(me){me.t=De[1].t,me.v=De[1].v,De[1].z!=null&&(me.z=De[1].z),De[1].f!=null&&(me.f=De[1].f);break}ne.dense?(ee[De[0].r]||(ee[De[0].r]=[]),ee[De[0].r][De[0].c]=De[1]):ee[Vn(De[0])]=De[1];break}},ne);else if(V[2]==26||V[2]==14)ne.Enum=te,V[2]==14&&(ne.qpro=!0,V.l=0),n(V,function(De,Xt,Ie){switch(Ie){case 204:fe=De;break;case 22:De[1].v=De[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(De[3]>Se&&(ee["!ref"]=Lr(gt),Fe[fe]=ee,je.push(fe),ee=ne.dense?[]:{},gt={s:{r:0,c:0},e:{r:0,c:0}},Se=De[3],fe="Sheet"+(Se+1)),yt>0&&De[0].r>=yt)break;ne.dense?(ee[De[0].r]||(ee[De[0].r]=[]),ee[De[0].r][De[0].c]=De[1]):ee[Vn(De[0])]=De[1],gt.e.c<De[0].c&&(gt.e.c=De[0].c),gt.e.r<De[0].r&&(gt.e.r=De[0].r);break;case 27:De[14e3]&&(Qe[De[14e3][0]]=De[14e3][1]);break;case 1537:Qe[De[0]]=De[1],De[0]==Se&&(fe=De[1]);break}},ne);else throw new Error("Unrecognized LOTUS BOF "+V[2]);if(ee["!ref"]=Lr(gt),Fe[Oe||fe]=ee,je.push(Oe||fe),!Qe.length)return{SheetNames:je,Sheets:Fe};for(var Lt={},nn=[],Ut=0;Ut<Qe.length;++Ut)Fe[je[Ut]]?(nn.push(Qe[Ut]||je[Ut]),Lt[Qe[Ut]]=Fe[Qe[Ut]]||Fe[je[Ut]]):(nn.push(Qe[Ut]),Lt[Qe[Ut]]={"!ref":"A1"});return{SheetNames:nn,Sheets:Lt}}function r(V,ie){var ne=ie||{};if(+ne.codepage>=0&&bp(+ne.codepage),ne.type=="string")throw new Error("Cannot write WK1 to JS string");var ee=ws(),fe=Zn(V["!ref"]),Oe=Array.isArray(V),Se=[];nt(ee,0,s(1030)),nt(ee,6,l(fe));for(var Fe=Math.min(fe.e.r,8191),je=fe.s.r;je<=Fe;++je)for(var Qe=Si(je),gt=fe.s.c;gt<=fe.e.c;++gt){je===fe.s.r&&(Se[gt]=Ui(gt));var yt=Se[gt]+Qe,Lt=Oe?(V[je]||[])[gt]:V[yt];if(!(!Lt||Lt.t=="z"))if(Lt.t=="n")(Lt.v|0)==Lt.v&&Lt.v>=-32768&&Lt.v<=32767?nt(ee,13,p(je,gt,Lt.v)):nt(ee,14,x(je,gt,Lt.v));else{var nn=zl(Lt);nt(ee,15,f(je,gt,nn.slice(0,239)))}}return nt(ee,1),ee.end()}function i(V,ie){var ne=ie||{};if(+ne.codepage>=0&&bp(+ne.codepage),ne.type=="string")throw new Error("Cannot write WK3 to JS string");var ee=ws();nt(ee,0,a(V));for(var fe=0,Oe=0;fe<V.SheetNames.length;++fe)(V.Sheets[V.SheetNames[fe]]||{})["!ref"]&&nt(ee,27,be(V.SheetNames[fe],Oe++));var Se=0;for(fe=0;fe<V.SheetNames.length;++fe){var Fe=V.Sheets[V.SheetNames[fe]];if(!(!Fe||!Fe["!ref"])){for(var je=Zn(Fe["!ref"]),Qe=Array.isArray(Fe),gt=[],yt=Math.min(je.e.r,8191),Lt=je.s.r;Lt<=yt;++Lt)for(var nn=Si(Lt),Ut=je.s.c;Ut<=je.e.c;++Ut){Lt===je.s.r&&(gt[Ut]=Ui(Ut));var De=gt[Ut]+nn,Xt=Qe?(Fe[Lt]||[])[Ut]:Fe[De];if(!(!Xt||Xt.t=="z"))if(Xt.t=="n")nt(ee,23,j(Lt,Ut,Se,Xt.v));else{var Ie=zl(Xt);nt(ee,22,k(Lt,Ut,Se,Ie.slice(0,239)))}}++Se}}return nt(ee,1),ee.end()}function s(V){var ie=Ce(2);return ie.write_shift(2,V),ie}function a(V){var ie=Ce(26);ie.write_shift(2,4096),ie.write_shift(2,4),ie.write_shift(4,0);for(var ne=0,ee=0,fe=0,Oe=0;Oe<V.SheetNames.length;++Oe){var Se=V.SheetNames[Oe],Fe=V.Sheets[Se];if(!(!Fe||!Fe["!ref"])){++fe;var je=ta(Fe["!ref"]);ne<je.e.r&&(ne=je.e.r),ee<je.e.c&&(ee=je.e.c)}}return ne>8191&&(ne=8191),ie.write_shift(2,ne),ie.write_shift(1,fe),ie.write_shift(1,ee),ie.write_shift(2,0),ie.write_shift(2,0),ie.write_shift(1,1),ie.write_shift(1,2),ie.write_shift(4,0),ie.write_shift(4,0),ie}function o(V,ie,ne){var ee={s:{c:0,r:0},e:{c:0,r:0}};return ie==8&&ne.qpro?(ee.s.c=V.read_shift(1),V.l++,ee.s.r=V.read_shift(2),ee.e.c=V.read_shift(1),V.l++,ee.e.r=V.read_shift(2),ee):(ee.s.c=V.read_shift(2),ee.s.r=V.read_shift(2),ie==12&&ne.qpro&&(V.l+=2),ee.e.c=V.read_shift(2),ee.e.r=V.read_shift(2),ie==12&&ne.qpro&&(V.l+=2),ee.s.c==65535&&(ee.s.c=ee.e.c=ee.s.r=ee.e.r=0),ee)}function l(V){var ie=Ce(8);return ie.write_shift(2,V.s.c),ie.write_shift(2,V.s.r),ie.write_shift(2,V.e.c),ie.write_shift(2,V.e.r),ie}function u(V,ie,ne){var ee=[{c:0,r:0},{t:"n",v:0},0,0];return ne.qpro&&ne.vers!=20768?(ee[0].c=V.read_shift(1),ee[3]=V.read_shift(1),ee[0].r=V.read_shift(2),V.l+=2):(ee[2]=V.read_shift(1),ee[0].c=V.read_shift(2),ee[0].r=V.read_shift(2)),ee}function h(V,ie,ne){var ee=V.l+ie,fe=u(V,ie,ne);if(fe[1].t="s",ne.vers==20768){V.l++;var Oe=V.read_shift(1);return fe[1].v=V.read_shift(Oe,"utf8"),fe}return ne.qpro&&V.l++,fe[1].v=V.read_shift(ee-V.l,"cstr"),fe}function f(V,ie,ne){var ee=Ce(7+ne.length);ee.write_shift(1,255),ee.write_shift(2,ie),ee.write_shift(2,V),ee.write_shift(1,39);for(var fe=0;fe<ee.length;++fe){var Oe=ne.charCodeAt(fe);ee.write_shift(1,Oe>=128?95:Oe)}return ee.write_shift(1,0),ee}function g(V,ie,ne){var ee=u(V,ie,ne);return ee[1].v=V.read_shift(2,"i"),ee}function p(V,ie,ne){var ee=Ce(7);return ee.write_shift(1,255),ee.write_shift(2,ie),ee.write_shift(2,V),ee.write_shift(2,ne,"i"),ee}function E(V,ie,ne){var ee=u(V,ie,ne);return ee[1].v=V.read_shift(8,"f"),ee}function x(V,ie,ne){var ee=Ce(13);return ee.write_shift(1,255),ee.write_shift(2,ie),ee.write_shift(2,V),ee.write_shift(8,ne,"f"),ee}function w(V,ie,ne){var ee=V.l+ie,fe=u(V,ie,ne);if(fe[1].v=V.read_shift(8,"f"),ne.qpro)V.l=ee;else{var Oe=V.read_shift(2);N(V.slice(V.l,V.l+Oe),fe),V.l+=Oe}return fe}function T(V,ie,ne){var ee=ie&32768;return ie&=-32769,ie=(ee?V:0)+(ie>=8192?ie-16384:ie),(ee?"":"$")+(ne?Ui(ie):Si(ie))}var I={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},P=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function N(V,ie){Bs(V,0);for(var ne=[],ee=0,fe="",Oe="",Se="",Fe="";V.l<V.length;){var je=V[V.l++];switch(je){case 0:ne.push(V.read_shift(8,"f"));break;case 1:Oe=T(ie[0].c,V.read_shift(2),!0),fe=T(ie[0].r,V.read_shift(2),!1),ne.push(Oe+fe);break;case 2:{var Qe=T(ie[0].c,V.read_shift(2),!0),gt=T(ie[0].r,V.read_shift(2),!1);Oe=T(ie[0].c,V.read_shift(2),!0),fe=T(ie[0].r,V.read_shift(2),!1),ne.push(Qe+gt+":"+Oe+fe)}break;case 3:if(V.l<V.length){console.error("WK1 premature formula end");return}break;case 4:ne.push("("+ne.pop()+")");break;case 5:ne.push(V.read_shift(2));break;case 6:{for(var yt="";je=V[V.l++];)yt+=String.fromCharCode(je);ne.push('"'+yt.replace(/"/g,'""')+'"')}break;case 8:ne.push("-"+ne.pop());break;case 23:ne.push("+"+ne.pop());break;case 22:ne.push("NOT("+ne.pop()+")");break;case 20:case 21:Fe=ne.pop(),Se=ne.pop(),ne.push(["AND","OR"][je-20]+"("+Se+","+Fe+")");break;default:if(je<32&&P[je])Fe=ne.pop(),Se=ne.pop(),ne.push(Se+P[je]+Fe);else if(I[je]){if(ee=I[je][1],ee==69&&(ee=V[V.l++]),ee>ne.length){console.error("WK1 bad formula parse 0x"+je.toString(16)+":|"+ne.join("|")+"|");return}var Lt=ne.slice(-ee);ne.length-=ee,ne.push(I[je][0]+"("+Lt.join(",")+")")}else return je<=7?console.error("WK1 invalid opcode "+je.toString(16)):je<=24?console.error("WK1 unsupported op "+je.toString(16)):je<=30?console.error("WK1 invalid opcode "+je.toString(16)):je<=115?console.error("WK1 unsupported function opcode "+je.toString(16)):console.error("WK1 unrecognized opcode "+je.toString(16))}}ne.length==1?ie[1].f=""+ne[0]:console.error("WK1 bad formula parse |"+ne.join("|")+"|")}function D(V){var ie=[{c:0,r:0},{t:"n",v:0},0];return ie[0].r=V.read_shift(2),ie[3]=V[V.l++],ie[0].c=V[V.l++],ie}function B(V,ie){var ne=D(V);return ne[1].t="s",ne[1].v=V.read_shift(ie-4,"cstr"),ne}function k(V,ie,ne,ee){var fe=Ce(6+ee.length);fe.write_shift(2,V),fe.write_shift(1,ne),fe.write_shift(1,ie),fe.write_shift(1,39);for(var Oe=0;Oe<ee.length;++Oe){var Se=ee.charCodeAt(Oe);fe.write_shift(1,Se>=128?95:Se)}return fe.write_shift(1,0),fe}function C(V,ie){var ne=D(V);ne[1].v=V.read_shift(2);var ee=ne[1].v>>1;if(ne[1].v&1)switch(ee&7){case 0:ee=(ee>>3)*5e3;break;case 1:ee=(ee>>3)*500;break;case 2:ee=(ee>>3)/20;break;case 3:ee=(ee>>3)/200;break;case 4:ee=(ee>>3)/2e3;break;case 5:ee=(ee>>3)/2e4;break;case 6:ee=(ee>>3)/16;break;case 7:ee=(ee>>3)/64;break}return ne[1].v=ee,ne}function M(V,ie){var ne=D(V),ee=V.read_shift(4),fe=V.read_shift(4),Oe=V.read_shift(2);if(Oe==65535)return ee===0&&fe===3221225472?(ne[1].t="e",ne[1].v=15):ee===0&&fe===3489660928?(ne[1].t="e",ne[1].v=42):ne[1].v=0,ne;var Se=Oe&32768;return Oe=(Oe&32767)-16446,ne[1].v=(1-Se*2)*(fe*Math.pow(2,Oe+32)+ee*Math.pow(2,Oe)),ne}function j(V,ie,ne,ee){var fe=Ce(14);if(fe.write_shift(2,V),fe.write_shift(1,ne),fe.write_shift(1,ie),ee==0)return fe.write_shift(4,0),fe.write_shift(4,0),fe.write_shift(2,65535),fe;var Oe=0,Se=0,Fe=0,je=0;return ee<0&&(Oe=1,ee=-ee),Se=Math.log2(ee)|0,ee/=Math.pow(2,Se-31),je=ee>>>0,(je&2147483648)==0&&(ee/=2,++Se,je=ee>>>0),ee-=je,je|=2147483648,je>>>=0,ee*=Math.pow(2,32),Fe=ee>>>0,fe.write_shift(4,Fe),fe.write_shift(4,je),Se+=16383+(Oe?32768:0),fe.write_shift(2,Se),fe}function O(V,ie){var ne=M(V);return V.l+=ie-14,ne}function W(V,ie){var ne=D(V),ee=V.read_shift(4);return ne[1].v=ee>>6,ne}function F(V,ie){var ne=D(V),ee=V.read_shift(8,"f");return ne[1].v=ee,ne}function Te(V,ie){var ne=F(V);return V.l+=ie-10,ne}function Me(V,ie){return V[V.l+ie-1]==0?V.read_shift(ie,"cstr"):""}function Le(V,ie){var ne=V[V.l++];ne>ie-1&&(ne=ie-1);for(var ee="";ee.length<ne;)ee+=String.fromCharCode(V[V.l++]);return ee}function Re(V,ie,ne){if(!(!ne.qpro||ie<21)){var ee=V.read_shift(1);V.l+=17,V.l+=1,V.l+=2;var fe=V.read_shift(ie-21,"cstr");return[ee,fe]}}function ue(V,ie){for(var ne={},ee=V.l+ie;V.l<ee;){var fe=V.read_shift(2);if(fe==14e3){for(ne[fe]=[0,""],ne[fe][0]=V.read_shift(2);V[V.l];)ne[fe][1]+=String.fromCharCode(V[V.l]),V.l++;V.l++}}return ne}function be(V,ie){var ne=Ce(5+V.length);ne.write_shift(2,14e3),ne.write_shift(2,ie);for(var ee=0;ee<V.length;++ee){var fe=V.charCodeAt(ee);ne[ne.l++]=fe>127?95:fe}return ne[ne.l++]=0,ne}var ce={0:{n:"BOF",f:EV},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:g},14:{n:"NUMBER",f:E},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Me},222:{n:"SHEETNAMELP",f:Le},65535:{n:""}},te={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:B},23:{n:"NUMBER17",f:M},24:{n:"NUMBER18",f:C},25:{n:"FORMULA19",f:O},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ue},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:W},38:{n:"??"},39:{n:"NUMBER27",f:F},40:{n:"FORMULA28",f:Te},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Me},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Re},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:i,to_workbook:e}})(),kpe=/^\s|\s$|[\t\n\r]/;function bV(n,e){if(!e.bookSST)return"";var t=[Dr];t[t.length]=tt("sst",null,{xmlns:$0[0],count:n.Count,uniqueCount:n.Unique});for(var r=0;r!=n.length;++r)if(n[r]!=null){var i=n[r],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(kpe)&&(s+=' xml:space="preserve"'),s+=">"+Fn(i.t)+"</t>"),s+="</si>",t[t.length]=s}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function Mpe(n){return[n.read_shift(4),n.read_shift(4)]}function Npe(n,e){return e||(e=Ce(8)),e.write_shift(4,n.Count),e.write_shift(4,n.Unique),e}var Lpe=Tme;function Ope(n){var e=ws();Ge(e,159,Npe(n));for(var t=0;t<n.length;++t)Ge(e,19,Lpe(n[t]));return Ge(e,160),e.end()}function Dpe(n){for(var e=[],t=n.split(""),r=0;r<t.length;++r)e[r]=t[r].charCodeAt(0);return e}function RV(n){var e=0,t,r=Dpe(n),i=r.length+1,s,a,o,l,u;for(t=Qh(i),t[0]=r.length,s=1;s!=i;++s)t[s]=r[s-1];for(s=i-1;s>=0;--s)a=t[s],o=(e&16384)===0?0:1,l=e<<1&32767,u=o|l,e=u^a;return e^52811}var Fpe=(function(){function n(i,s){switch(s.type){case"base64":return e(Ul(i),s);case"binary":return e(i,s);case"buffer":return e(En&&Buffer.isBuffer(i)?i.toString("binary"):R1(i),s);case"array":return e(zE(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(h,f){Array.isArray(o)&&(o[f]=[]);for(var g=/\\\w+\b/g,p=0,E,x=-1;E=g.exec(h);){switch(E[0]){case"\\cell":var w=h.slice(p,g.lastIndex-E[0].length);if(w[0]==" "&&(w=w.slice(1)),++x,w.length){var T={v:w,t:"s"};Array.isArray(o)?o[f][x]=T:o[Vn({r:f,c:x})]=T}break}p=g.lastIndex}x>u.e.c&&(u.e.c=x)}),o["!ref"]=Lr(u),o}function t(i,s){return fd(n(i,s),s)}function r(i){for(var s=["{\\rtf1\\ansi"],a=Zn(i["!ref"]),o,l=Array.isArray(i),u=a.s.r;u<=a.e.r;++u){s.push("\\trowd\\trautofit1");for(var h=a.s.c;h<=a.e.c;++h)s.push("\\cellx"+(h+1));for(s.push("\\pard\\intbl"),h=a.s.c;h<=a.e.c;++h){var f=Vn({r:u,c:h});o=l?(i[u]||[])[h]:i[f],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(zl(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:t,to_sheet:n,from_sheet:r}})();function SO(n){for(var e=0,t=1;e!=3;++e)t=t*256+(n[e]>255?255:n[e]<0?0:n[e]);return t.toString(16).toUpperCase().slice(1)}var jpe=6,Ll=jpe;function Ev(n){return Math.floor((n+Math.round(128/Ll)/256)*Ll)}function wv(n){return Math.floor((n-5)/Ll*100+.5)/100}function VI(n){return Math.round((n*Ll+5)/Ll*256)/256}function rC(n){n.width?(n.wpx=Ev(n.width),n.wch=wv(n.wpx),n.MDW=Ll):n.wpx?(n.wch=wv(n.wpx),n.width=VI(n.wch),n.MDW=Ll):typeof n.wch=="number"&&(n.width=VI(n.wch),n.wpx=Ev(n.width),n.MDW=Ll),n.customWidth&&delete n.customWidth}var Vpe=96,CV=Vpe;function Sv(n){return n*96/CV}function PV(n){return n*CV/96}function Gpe(n){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var r=t[0];r<=t[1];++r)n[r]!=null&&(e[e.length]=tt("numFmt",null,{numFmtId:r,formatCode:Fn(n[r])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=tt("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function Bpe(n){var e=[];return e[e.length]=tt("cellXfs",null),n.forEach(function(t){e[e.length]=tt("xf",null,t)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=tt("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function kV(n,e){var t=[Dr,tt("styleSheet",null,{xmlns:$0[0],"xmlns:vt":ri.vt})],r;return n.SSF&&(r=Gpe(n.SSF))!=null&&(t[t.length]=r),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=Bpe(e.cellXfs))&&(t[t.length]=r),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function Upe(n,e){var t=n.read_shift(2),r=zi(n);return[t,r]}function zpe(n,e,t){t||(t=Ce(6+4*e.length)),t.write_shift(2,n),ai(e,t);var r=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),r}function $pe(n,e,t){var r={};r.sz=n.read_shift(2)/20;var i=kme(n);i.fItalic&&(r.italic=1),i.fCondense&&(r.condense=1),i.fExtend&&(r.extend=1),i.fShadow&&(r.shadow=1),i.fOutline&&(r.outline=1),i.fStrikeout&&(r.strike=1);var s=n.read_shift(2);switch(s===700&&(r.bold=1),n.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var a=n.read_shift(1);a!=0&&(r.underline=a);var o=n.read_shift(1);o>0&&(r.family=o);var l=n.read_shift(1);switch(l>0&&(r.charset=l),n.l++,r.color=Pme(n),n.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=zi(n),r}function Wpe(n,e){e||(e=Ce(153)),e.write_shift(2,n.sz*20),Mme(n,e),e.write_shift(2,n.bold?700:400);var t=0;n.vertAlign=="superscript"?t=1:n.vertAlign=="subscript"&&(t=2),e.write_shift(2,t),e.write_shift(1,n.underline||0),e.write_shift(1,n.family||0),e.write_shift(1,n.charset||0),e.write_shift(1,0),xv(n.color,e);var r=0;return r=2,e.write_shift(1,r),ai(n.name,e),e.length>e.l?e.slice(0,e.l):e}var Hpe=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],VS,Kpe=Xo;function TO(n,e){e||(e=Ce(84)),VS||(VS=WR(Hpe));var t=VS[n.patternType];t==null&&(t=40),e.write_shift(4,t);var r=0;if(t!=40)for(xv({auto:1},e),xv({auto:1},e);r<12;++r)e.write_shift(4,0);else{for(;r<4;++r)e.write_shift(4,0);for(;r<12;++r)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function Ype(n,e){var t=n.l+e,r=n.read_shift(2),i=n.read_shift(2);return n.l=t,{ixfe:r,numFmtId:i}}function MV(n,e,t){t||(t=Ce(16)),t.write_shift(2,e||0),t.write_shift(2,n.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var r=0;return t.write_shift(1,r),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function Wg(n,e){return e||(e=Ce(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var Xpe=Xo;function qpe(n,e){return e||(e=Ce(51)),e.write_shift(1,0),Wg(null,e),Wg(null,e),Wg(null,e),Wg(null,e),Wg(null,e),e.length>e.l?e.slice(0,e.l):e}function Zpe(n,e){return e||(e=Ce(52)),e.write_shift(4,n.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),_v(n.name||"",e),e.length>e.l?e.slice(0,e.l):e}function Qpe(n,e,t){var r=Ce(2052);return r.write_shift(4,n),_v(e,r),_v(t,r),r.length>r.l?r.slice(0,r.l):r}function Jpe(n,e){if(e){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&++t}),t!=0&&(Ge(n,615,Ja(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&Ge(n,44,zpe(i,e[i]))}),Ge(n,616))}}function e1e(n){var e=1;Ge(n,611,Ja(e)),Ge(n,43,Wpe({sz:12,color:{theme:1},name:"Calibri",family:2})),Ge(n,612)}function t1e(n){var e=2;Ge(n,603,Ja(e)),Ge(n,45,TO({patternType:"none"})),Ge(n,45,TO({patternType:"gray125"})),Ge(n,604)}function n1e(n){var e=1;Ge(n,613,Ja(e)),Ge(n,46,qpe()),Ge(n,614)}function r1e(n){var e=1;Ge(n,626,Ja(e)),Ge(n,47,MV({numFmtId:0},65535)),Ge(n,627)}function i1e(n,e){Ge(n,617,Ja(e.length)),e.forEach(function(t){Ge(n,47,MV(t,0))}),Ge(n,618)}function s1e(n){var e=1;Ge(n,619,Ja(e)),Ge(n,48,Zpe({xfId:0,name:"Normal"})),Ge(n,620)}function a1e(n){var e=0;Ge(n,505,Ja(e)),Ge(n,506)}function o1e(n){var e=0;Ge(n,508,Qpe(e,"TableStyleMedium9","PivotStyleMedium4")),Ge(n,509)}function l1e(n,e){var t=ws();return Ge(t,278),Jpe(t,n.SSF),e1e(t),t1e(t),n1e(t),r1e(t),i1e(t,e.cellXfs),s1e(t),a1e(t),o1e(t),Ge(t,279),t.end()}function NV(n,e){if(e&&e.themeXLSX)return e.themeXLSX;if(n&&typeof n.raw=="string")return n.raw;var t=[Dr];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function c1e(n,e){return{flags:n.read_shift(4),version:n.read_shift(4),name:zi(n)}}function u1e(n){var e=Ce(12+2*n.name.length);return e.write_shift(4,n.flags),e.write_shift(4,n.version),ai(n.name,e),e.slice(0,e.l)}function h1e(n){for(var e=[],t=n.read_shift(4);t-- >0;)e.push([n.read_shift(4),n.read_shift(4)]);return e}function d1e(n){var e=Ce(4+8*n.length);e.write_shift(4,n.length);for(var t=0;t<n.length;++t)e.write_shift(4,n[t][0]),e.write_shift(4,n[t][1]);return e}function f1e(n,e){var t=Ce(8+2*e.length);return t.write_shift(4,n),ai(e,t),t.slice(0,t.l)}function g1e(n){return n.l+=4,n.read_shift(4)!=0}function m1e(n,e){var t=Ce(8);return t.write_shift(4,n),t.write_shift(4,1),t}function p1e(){var n=ws();return Ge(n,332),Ge(n,334,Ja(1)),Ge(n,335,u1e({name:"XLDAPR",version:12e4,flags:3496657072})),Ge(n,336),Ge(n,339,f1e(1,"XLDAPR")),Ge(n,52),Ge(n,35,Ja(514)),Ge(n,4096,Ja(0)),Ge(n,4097,ma(1)),Ge(n,36),Ge(n,53),Ge(n,340),Ge(n,337,m1e(1)),Ge(n,51,d1e([[1,0]])),Ge(n,338),Ge(n,333),n.end()}function LV(){var n=[Dr];return n.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),n.join("")}function y1e(n){var e={};e.i=n.read_shift(4);var t={};t.r=n.read_shift(4),t.c=n.read_shift(4),e.r=Vn(t);var r=n.read_shift(1);return r&2&&(e.l="1"),r&8&&(e.a="1"),e}var Df=1024;function OV(n,e){for(var t=[21600,21600],r=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),i=[tt("xml",null,{"xmlns:v":$s.v,"xmlns:o":$s.o,"xmlns:x":$s.x,"xmlns:mv":$s.mv}).replace(/\/>/,">"),tt("o:shapelayout",tt("o:idmap",null,{"v:ext":"edit",data:n}),{"v:ext":"edit"}),tt("v:shapetype",[tt("v:stroke",null,{joinstyle:"miter"}),tt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:r})];Df<n*1e3;)Df+=1e3;return e.forEach(function(s){var a=si(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?tt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=tt("v:fill",l,o),h={on:"t",obscured:"t"};++Df,i=i.concat(["<v:shape"+kp({id:"_x0000_s"+Df,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,tt("v:shadow",null,h),tt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Ei("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),Ei("x:AutoFill","False"),Ei("x:Row",String(a.r)),Ei("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function DV(n){var e=[Dr,tt("comments",null,{xmlns:$0[0]})],t=[];return e.push("<authors>"),n.forEach(function(r){r[1].forEach(function(i){var s=Fn(i.a);t.indexOf(s)==-1&&(t.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&t.indexOf("tc="+i.ID)==-1&&(t.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),n.forEach(function(r){var i=0,s=[];if(r[1][0]&&r[1][0].T&&r[1][0].ID?i=t.indexOf("tc="+r[1][0].ID):r[1].forEach(function(l){l.a&&(i=t.indexOf(Fn(l.a))),s.push(l.t||"")}),e.push('<comment ref="'+r[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(Ei("t",Fn(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;e.push(Ei("t",Fn(a)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function _1e(n,e,t){var r=[Dr,tt("ThreadedComments",null,{xmlns:ri.TCMNT}).replace(/[\/]>/,">")];return n.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),r.push(tt("threadedComment",Ei("text",a.t||""),l))})}),r.push("</ThreadedComments>"),r.join("")}function x1e(n){var e=[Dr,tt("personList",null,{xmlns:ri.TCMNT,"xmlns:x":$0[0]}).replace(/[\/]>/,">")];return n.forEach(function(t,r){e.push(tt("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:t,providerId:"None"}))}),e.push("</personList>"),e.join("")}function v1e(n){var e={};e.iauthor=n.read_shift(4);var t=yd(n);return e.rfx=t.s,e.ref=Vn(t.s),n.l+=16,e}function E1e(n,e){return e==null&&(e=Ce(36)),e.write_shift(4,n[1].iauthor),H0(n[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var w1e=zi;function S1e(n){return ai(n.slice(0,54))}function T1e(n){var e=ws(),t=[];return Ge(e,628),Ge(e,630),n.forEach(function(r){r[1].forEach(function(i){t.indexOf(i.a)>-1||(t.push(i.a.slice(0,54)),Ge(e,632,S1e(i.a)))})}),Ge(e,631),Ge(e,633),n.forEach(function(r){r[1].forEach(function(i){i.iauthor=t.indexOf(i.a);var s={s:si(r[0]),e:si(r[0])};Ge(e,635,E1e([s,i])),i.t&&i.t.length>0&&Ge(e,637,Ame(i)),Ge(e,636),delete i.iauthor})}),Ge(e,634),Ge(e,629),e.end()}function I1e(n,e){e.FullPaths.forEach(function(t,r){if(r!=0){var i=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Gn.utils.cfb_add(n,i,e.FileIndex[r].content)}})}var FV=["xlsb","xlsm","xlam","biff8","xla"],A1e=(function(){var n=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function t(r,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,h=a.length>0?parseInt(a,10)|0:0;return o?h+=e.c:--h,l?u+=e.r:--u,i+(o?"":"$")+Ui(h)+(l?"":"$")+Si(u)}return function(i,s){return e=s,i.replace(n,t)}})(),iC=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,sC=(function(){return function(e,t){return e.replace(iC,function(r,i,s,a,o,l){var u=QR(a)-(s?0:t.c),h=ZR(l)-(o?0:t.r),f=h==0?"":o?h+1:"["+h+"]",g=u==0?"":s?u+1:"["+u+"]";return i+"R"+f+"C"+g})}})();function b1e(n,e){return n.replace(iC,function(t,r,i,s,a,o){return r+(i=="$"?i+s:Ui(QR(s)+e.c))+(a=="$"?a+o:Si(ZR(o)+e.r))})}function R1e(n){return n.length!=1}function Pr(n){n.l+=1}function _u(n,e){var t=n.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function jV(n,e,t){var r=2;if(t){if(t.biff>=2&&t.biff<=5)return VV(n);t.biff==12&&(r=4)}var i=n.read_shift(r),s=n.read_shift(r),a=_u(n),o=_u(n);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function VV(n){var e=_u(n),t=_u(n),r=n.read_shift(1),i=n.read_shift(1);return{s:{r:e[0],c:r,cRel:e[1],rRel:e[2]},e:{r:t[0],c:i,cRel:t[1],rRel:t[2]}}}function C1e(n,e,t){if(t.biff<8)return VV(n);var r=n.read_shift(t.biff==12?4:2),i=n.read_shift(t.biff==12?4:2),s=_u(n),a=_u(n);return{s:{r,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function GV(n,e,t){if(t&&t.biff>=2&&t.biff<=5)return P1e(n);var r=n.read_shift(t&&t.biff==12?4:2),i=_u(n);return{r,c:i[0],cRel:i[1],rRel:i[2]}}function P1e(n){var e=_u(n),t=n.read_shift(1);return{r:e[0],c:t,cRel:e[1],rRel:e[2]}}function k1e(n){var e=n.read_shift(2),t=n.read_shift(2);return{r:e,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function M1e(n,e,t){var r=t&&t.biff?t.biff:8;if(r>=2&&r<=5)return N1e(n);var i=n.read_shift(r>=12?4:2),s=n.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function N1e(n){var e=n.read_shift(2),t=n.read_shift(1),r=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,r==1&&e>=8192&&(e=e-16384),i==1&&t>=128&&(t=t-256),{r:e,c:t,cRel:i,rRel:r}}function L1e(n,e,t){var r=(n[n.l++]&96)>>5,i=jV(n,t.biff>=2&&t.biff<=5?6:8,t);return[r,i]}function O1e(n,e,t){var r=(n[n.l++]&96)>>5,i=n.read_shift(2,"i"),s=8;if(t)switch(t.biff){case 5:n.l+=12,s=6;break;case 12:s=12;break}var a=jV(n,s,t);return[r,i,a]}function D1e(n,e,t){var r=(n[n.l++]&96)>>5;return n.l+=t&&t.biff>8?12:t.biff<8?6:8,[r]}function F1e(n,e,t){var r=(n[n.l++]&96)>>5,i=n.read_shift(2),s=8;if(t)switch(t.biff){case 5:n.l+=12,s=6;break;case 12:s=12;break}return n.l+=s,[r,i]}function j1e(n,e,t){var r=(n[n.l++]&96)>>5,i=C1e(n,e-1,t);return[r,i]}function V1e(n,e,t){var r=(n[n.l++]&96)>>5;return n.l+=t.biff==2?6:t.biff==12?14:7,[r]}function IO(n){var e=n[n.l+1]&1,t=1;return n.l+=4,[e,t]}function G1e(n,e,t){n.l+=2;for(var r=n.read_shift(t&&t.biff==2?1:2),i=[],s=0;s<=r;++s)i.push(n.read_shift(t&&t.biff==2?1:2));return i}function B1e(n,e,t){var r=n[n.l+1]&255?1:0;return n.l+=2,[r,n.read_shift(t&&t.biff==2?1:2)]}function U1e(n,e,t){var r=n[n.l+1]&255?1:0;return n.l+=2,[r,n.read_shift(t&&t.biff==2?1:2)]}function z1e(n){var e=n[n.l+1]&255?1:0;return n.l+=2,[e,n.read_shift(2)]}function $1e(n,e,t){var r=n[n.l+1]&255?1:0;return n.l+=t&&t.biff==2?3:4,[r]}function BV(n){var e=n.read_shift(1),t=n.read_shift(1);return[e,t]}function W1e(n){return n.read_shift(2),BV(n)}function H1e(n){return n.read_shift(2),BV(n)}function K1e(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=GV(n,0,t);return[r,i]}function Y1e(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=M1e(n,0,t);return[r,i]}function X1e(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=n.read_shift(2);t&&t.biff==5&&(n.l+=12);var s=GV(n,0,t);return[r,i,s]}function q1e(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=n.read_shift(t&&t.biff<=3?1:2);return[qye[i],$V[i],r]}function Z1e(n,e,t){var r=n[n.l++],i=n.read_shift(1),s=t&&t.biff<=3?[r==88?-1:0,n.read_shift(1)]:Q1e(n);return[i,(s[0]===0?$V:Xye)[s[1]]]}function Q1e(n){return[n[n.l+1]>>7,n.read_shift(2)&32767]}function J1e(n,e,t){n.l+=t&&t.biff==2?3:4}function eye(n,e,t){if(n.l++,t&&t.biff==12)return[n.read_shift(4,"i"),0];var r=n.read_shift(2),i=n.read_shift(t&&t.biff==2?1:2);return[r,i]}function tye(n){return n.l++,k1[n.read_shift(1)]}function nye(n){return n.l++,n.read_shift(2)}function rye(n){return n.l++,n.read_shift(1)!==0}function iye(n){return n.l++,K0(n)}function sye(n,e,t){return n.l++,SV(n,e-1,t)}function aye(n,e){var t=[n.read_shift(1)];if(e==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=Xme(n,1)?"TRUE":"FALSE",e!=12&&(n.l+=7);break;case 37:case 16:t[1]=k1[n[n.l]],n.l+=e==12?4:8;break;case 0:n.l+=8;break;case 1:t[1]=K0(n);break;case 2:t[1]=Jme(n,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function oye(n,e,t){for(var r=n.read_shift(t.biff==12?4:2),i=[],s=0;s!=r;++s)i.push((t.biff==12?yd:npe)(n));return i}function lye(n,e,t){var r=0,i=0;t.biff==12?(r=n.read_shift(4),i=n.read_shift(4)):(i=1+n.read_shift(1),r=1+n.read_shift(2)),t.biff>=2&&t.biff<8&&(--r,--i==0&&(i=256));for(var s=0,a=[];s!=r&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=aye(n,t.biff);return a}function cye(n,e,t){var r=n.read_shift(1)>>>5&3,i=!t||t.biff>=8?4:2,s=n.read_shift(i);switch(t.biff){case 2:n.l+=5;break;case 3:case 4:n.l+=8;break;case 5:n.l+=12;break}return[r,0,s]}function uye(n,e,t){if(t.biff==5)return hye(n);var r=n.read_shift(1)>>>5&3,i=n.read_shift(2),s=n.read_shift(4);return[r,i,s]}function hye(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2,"i");n.l+=8;var r=n.read_shift(2);return n.l+=12,[e,t,r]}function dye(n,e,t){var r=n.read_shift(1)>>>5&3;n.l+=t&&t.biff==2?3:4;var i=n.read_shift(t&&t.biff==2?1:2);return[r,i]}function fye(n,e,t){var r=n.read_shift(1)>>>5&3,i=n.read_shift(t&&t.biff==2?1:2);return[r,i]}function gye(n,e,t){var r=n.read_shift(1)>>>5&3;return n.l+=4,t.biff<8&&n.l--,t.biff==12&&(n.l+=2),[r]}function mye(n,e,t){var r=(n[n.l++]&96)>>5,i=n.read_shift(2),s=4;if(t)switch(t.biff){case 5:s=15;break;case 12:s=6;break}return n.l+=s,[r,i]}var pye=Xo,yye=Xo,_ye=Xo;function M1(n,e,t){return n.l+=2,[k1e(n)]}function aC(n){return n.l+=6,[]}var xye=M1,vye=aC,Eye=aC,wye=M1;function UV(n){return n.l+=2,[EV(n),n.read_shift(2)&1]}var Sye=M1,Tye=UV,Iye=aC,Aye=M1,bye=M1,Rye=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Cye(n){n.l+=2;var e=n.read_shift(2),t=n.read_shift(2),r=n.read_shift(4),i=n.read_shift(2),s=n.read_shift(2),a=Rye[t>>2&31];return{ixti:e,coltype:t&3,rt:a,idx:r,c:i,C:s}}function Pye(n){return n.l+=2,[n.read_shift(4)]}function kye(n,e,t){return n.l+=5,n.l+=2,n.l+=t.biff==2?1:4,["PTGSHEET"]}function Mye(n,e,t){return n.l+=t.biff==2?4:5,["PTGENDSHEET"]}function Nye(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2);return[e,t]}function Lye(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2);return[e,t]}function Oye(n){return n.l+=4,[0,0]}var AO={1:{n:"PtgExp",f:eye},2:{n:"PtgTbl",f:_ye},3:{n:"PtgAdd",f:Pr},4:{n:"PtgSub",f:Pr},5:{n:"PtgMul",f:Pr},6:{n:"PtgDiv",f:Pr},7:{n:"PtgPower",f:Pr},8:{n:"PtgConcat",f:Pr},9:{n:"PtgLt",f:Pr},10:{n:"PtgLe",f:Pr},11:{n:"PtgEq",f:Pr},12:{n:"PtgGe",f:Pr},13:{n:"PtgGt",f:Pr},14:{n:"PtgNe",f:Pr},15:{n:"PtgIsect",f:Pr},16:{n:"PtgUnion",f:Pr},17:{n:"PtgRange",f:Pr},18:{n:"PtgUplus",f:Pr},19:{n:"PtgUminus",f:Pr},20:{n:"PtgPercent",f:Pr},21:{n:"PtgParen",f:Pr},22:{n:"PtgMissArg",f:Pr},23:{n:"PtgStr",f:sye},26:{n:"PtgSheet",f:kye},27:{n:"PtgEndSheet",f:Mye},28:{n:"PtgErr",f:tye},29:{n:"PtgBool",f:rye},30:{n:"PtgInt",f:nye},31:{n:"PtgNum",f:iye},32:{n:"PtgArray",f:V1e},33:{n:"PtgFunc",f:q1e},34:{n:"PtgFuncVar",f:Z1e},35:{n:"PtgName",f:cye},36:{n:"PtgRef",f:K1e},37:{n:"PtgArea",f:L1e},38:{n:"PtgMemArea",f:dye},39:{n:"PtgMemErr",f:pye},40:{n:"PtgMemNoMem",f:yye},41:{n:"PtgMemFunc",f:fye},42:{n:"PtgRefErr",f:gye},43:{n:"PtgAreaErr",f:D1e},44:{n:"PtgRefN",f:Y1e},45:{n:"PtgAreaN",f:j1e},46:{n:"PtgMemAreaN",f:Nye},47:{n:"PtgMemNoMemN",f:Lye},57:{n:"PtgNameX",f:uye},58:{n:"PtgRef3d",f:X1e},59:{n:"PtgArea3d",f:O1e},60:{n:"PtgRefErr3d",f:mye},61:{n:"PtgAreaErr3d",f:F1e},255:{}},Dye={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Fye={1:{n:"PtgElfLel",f:UV},2:{n:"PtgElfRw",f:Aye},3:{n:"PtgElfCol",f:xye},6:{n:"PtgElfRwV",f:bye},7:{n:"PtgElfColV",f:wye},10:{n:"PtgElfRadical",f:Sye},11:{n:"PtgElfRadicalS",f:Iye},13:{n:"PtgElfColS",f:vye},15:{n:"PtgElfColSV",f:Eye},16:{n:"PtgElfRadicalLel",f:Tye},25:{n:"PtgList",f:Cye},29:{n:"PtgSxName",f:Pye},255:{}},jye={0:{n:"PtgAttrNoop",f:Oye},1:{n:"PtgAttrSemi",f:$1e},2:{n:"PtgAttrIf",f:U1e},4:{n:"PtgAttrChoose",f:G1e},8:{n:"PtgAttrGoto",f:B1e},16:{n:"PtgAttrSum",f:J1e},32:{n:"PtgAttrBaxcel",f:IO},33:{n:"PtgAttrBaxcel",f:IO},64:{n:"PtgAttrSpace",f:W1e},65:{n:"PtgAttrSpaceSemi",f:H1e},128:{n:"PtgAttrIfError",f:z1e},255:{}};function Vye(n,e,t,r){if(r.biff<8)return Xo(n,e);for(var i=n.l+e,s=[],a=0;a!==t.length;++a)switch(t[a][0]){case"PtgArray":t[a][1]=lye(n,0,r),s.push(t[a][1]);break;case"PtgMemArea":t[a][2]=oye(n,t[a][1],r),s.push(t[a][2]);break;case"PtgExp":r&&r.biff==12&&(t[a][1][1]=n.read_shift(4),s.push(t[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[a][0]}return e=i-n.l,e!==0&&s.push(Xo(n,e)),s}function Gye(n,e,t){for(var r=n.l+e,i,s,a=[];r!=n.l;)e=r-n.l,s=n[n.l],i=AO[s]||AO[Dye[s]],(s===24||s===25)&&(i=(s===24?Fye:jye)[n[n.l+1]]),!i||!i.f?Xo(n,e):a.push([i.n,i.f(n,e,t)]);return a}function Bye(n){for(var e=[],t=0;t<n.length;++t){for(var r=n[t],i=[],s=0;s<r.length;++s){var a=r[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var Uye={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function zye(n,e){if(!n&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(n)?"'"+n+"'":n}function zV(n,e,t){if(!n)return"SH33TJSERR0";if(t.biff>8&&(!n.XTI||!n.XTI[e]))return n.SheetNames[e];if(!n.XTI)return"SH33TJSERR6";var r=n.XTI[e];if(t.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":n.XTI[e-1];if(!r)return"SH33TJSERR1";var i="";if(t.biff>8)switch(n[r[0]][0]){case 357:return i=r[1]==-1?"#REF":n.SheetNames[r[1]],r[1]==r[2]?i:i+":"+n.SheetNames[r[2]];case 358:return t.SID!=null?n.SheetNames[t.SID]:"SH33TJSSAME"+n[r[0]][0];case 355:default:return"SH33TJSSRC"+n[r[0]][0]}switch(n[r[0]][0][0]){case 1025:return i=r[1]==-1?"#REF":n.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?i:i+":"+n.SheetNames[r[2]];case 14849:return n[r[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return n[r[0]][0][3]?(i=r[1]==-1?"#REF":n[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?i:i+":"+n[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function bO(n,e,t){var r=zV(n,e,t);return r=="#REF"?r:zye(r,t)}function R0(n,e,t,r,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},o=[],l,u,h,f=0,g=0,p,E="";if(!n[0]||!n[0][0])return"";for(var x=-1,w="",T=0,I=n[0].length;T<I;++T){var P=n[0][T];switch(P[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),u=o.pop(),x>=0){switch(n[0][x][1][0]){case 0:w=pr(" ",n[0][x][1][1]);break;case 1:w=pr("\r",n[0][x][1][1]);break;default:if(w="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][x][1][0])}u=u+w,x=-1}o.push(u+Uye[P[0]]+l);break;case"PtgIsect":l=o.pop(),u=o.pop(),o.push(u+" "+l);break;case"PtgUnion":l=o.pop(),u=o.pop(),o.push(u+","+l);break;case"PtgRange":l=o.pop(),u=o.pop(),o.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=jm(P[1][1],a,i),o.push(Vm(h,s));break;case"PtgRefN":h=t?jm(P[1][1],t,i):P[1][1],o.push(Vm(h,s));break;case"PtgRef3d":f=P[1][1],h=jm(P[1][2],a,i),E=bO(r,f,i),o.push(E+"!"+Vm(h,s));break;case"PtgFunc":case"PtgFuncVar":var N=P[1][0],D=P[1][1];N||(N=0),N&=127;var B=N==0?[]:o.slice(-N);o.length-=N,D==="User"&&(D=B.shift()),o.push(D+"("+B.join(",")+")");break;case"PtgBool":o.push(P[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(P[1]);break;case"PtgNum":o.push(String(P[1]));break;case"PtgStr":o.push('"'+P[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(P[1]);break;case"PtgAreaN":p=hO(P[1][1],t?{s:t}:a,i),o.push(FS(p,i));break;case"PtgArea":p=hO(P[1][1],a,i),o.push(FS(p,i));break;case"PtgArea3d":f=P[1][1],p=P[1][2],E=bO(r,f,i),o.push(E+"!"+FS(p,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":g=P[1][2];var k=(r.names||[])[g-1]||(r[0]||[])[g],C=k?k.Name:"SH33TJSNAME"+String(g);C&&C.slice(0,6)=="_xlfn."&&!i.xlfn&&(C=C.slice(6)),o.push(C);break;case"PtgNameX":var M=P[1][1];g=P[1][2];var j;if(i.biff<=5)M<0&&(M=-M),r[M]&&(j=r[M][g]);else{var O="";if(((r[M]||[])[0]||[])[0]==14849||(((r[M]||[])[0]||[])[0]==1025?r[M][g]&&r[M][g].itab>0&&(O=r.SheetNames[r[M][g].itab-1]+"!"):O=r.SheetNames[g-1]+"!"),r[M]&&r[M][g])O+=r[M][g].Name;else if(r[0]&&r[0][g])O+=r[0][g].Name;else{var W=(zV(r,M,i)||"").split(";;");W[g-1]?O=W[g-1]:O+="SH33TJSERRX"}o.push(O);break}j||(j={Name:"SH33TJSERRY"}),o.push(j.Name);break;case"PtgParen":var F="(",Te=")";if(x>=0){switch(w="",n[0][x][1][0]){case 2:F=pr(" ",n[0][x][1][1])+F;break;case 3:F=pr("\r",n[0][x][1][1])+F;break;case 4:Te=pr(" ",n[0][x][1][1])+Te;break;case 5:Te=pr("\r",n[0][x][1][1])+Te;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][x][1][0])}x=-1}o.push(F+o.pop()+Te);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":h={c:P[1][1],r:P[1][0]};var Me={c:t.c,r:t.r};if(r.sharedf[Vn(h)]){var Le=r.sharedf[Vn(h)];o.push(R0(Le,a,Me,r,i))}else{var Re=!1;for(l=0;l!=r.arrayf.length;++l)if(u=r.arrayf[l],!(h.c<u[0].s.c||h.c>u[0].e.c)&&!(h.r<u[0].s.r||h.r>u[0].e.r)){o.push(R0(u[1],a,Me,r,i)),Re=!0;break}Re||o.push(P[1])}break;case"PtgArray":o.push("{"+Bye(P[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=T;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+P[1].idx+"[#"+P[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(P));default:throw new Error("Unrecognized Formula Token: "+String(P))}var ue=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&x>=0&&ue.indexOf(n[0][T][0])==-1){P=n[0][x];var be=!0;switch(P[1][0]){case 4:be=!1;case 0:w=pr(" ",P[1][1]);break;case 5:be=!1;case 1:w=pr("\r",P[1][1]);break;default:if(w="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+P[1][0])}o.push((be?w:"")+o.pop()+(be?"":w)),x=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function $ye(n){if(n==null){var e=Ce(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof n=="number")return Jh(n);return Jh(0)}function Wye(n,e,t,r,i){var s=ed(e,t,i),a=$ye(n.v),o=Ce(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var u=Ce(n.bf.length),h=0;h<n.bf.length;++h)u[h]=n.bf[h];var f=vi([s,a,o,u]);return f}function $E(n,e,t){var r=n.read_shift(4),i=Gye(n,r,t),s=n.read_shift(4),a=s>0?Vye(n,s,i,t):null;return[i,a]}var Hye=$E,WE=$E,Kye=$E,Yye=$E,Xye={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},$V={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},qye={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Zye(n){var e="of:="+n.replace(iC,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function Qye(n){return n.replace(/\./,"!")}var Gm=typeof Map<"u";function oC(n,e,t){var r=0,i=n.length;if(t){if(Gm?t.has(e):Object.prototype.hasOwnProperty.call(t,e)){for(var s=Gm?t.get(e):t[e];r<s.length;++r)if(n[s[r]].t===e)return n.Count++,s[r]}}else for(;r<i;++r)if(n[r].t===e)return n.Count++,r;return n[i]={t:e},n.Count++,n.Unique++,t&&(Gm?(t.has(e)||t.set(e,[]),t.get(e).push(i)):(Object.prototype.hasOwnProperty.call(t,e)||(t[e]=[]),t[e].push(i))),i}function HE(n,e){var t={min:n+1,max:n+1},r=-1;return e.MDW&&(Ll=e.MDW),e.width!=null?t.customWidth=1:e.wpx!=null?r=wv(e.wpx):e.wch!=null&&(r=e.wch),r>-1?(t.width=VI(r),t.customWidth=1):e.width!=null&&(t.width=e.width),e.hidden&&(t.hidden=!0),e.level!=null&&(t.outlineLevel=t.level=e.level),t}function WV(n,e){if(n){var t=[.7,.7,.75,.75,.3,.3];n.left==null&&(n.left=t[0]),n.right==null&&(n.right=t[1]),n.top==null&&(n.top=t[2]),n.bottom==null&&(n.bottom=t[3]),n.header==null&&(n.header=t[4]),n.footer==null&&(n.footer=t[5])}}function bu(n,e,t){var r=t.revssf[e.z!=null?e.z:"General"],i=60,s=n.length;if(r==null&&t.ssf){for(;i<392;++i)if(t.ssf[i]==null){G7(e.z,i),t.ssf[i]=e.z,t.revssf[e.z]=r=i;break}}for(i=0;i!=s;++i)if(n[i].numFmtId===r)return i;return n[s]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function Jye(n,e,t){if(n&&n["!ref"]){var r=Zn(n["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+t+"): "+n["!ref"])}}function e_e(n){if(n.length===0)return"";for(var e='<mergeCells count="'+n.length+'">',t=0;t!=n.length;++t)e+='<mergeCell ref="'+Lr(n[t])+'"/>';return e+"</mergeCells>"}function t_e(n,e,t,r,i){var s=!1,a={},o=null;if(r.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[t];try{e.Workbook&&(l=e.Workbook.Sheets[t].CodeName||l)}catch{}s=!0,a.codeName=Pp(Fn(l))}if(n&&n["!outline"]){var u={summaryBelow:1,summaryRight:1};n["!outline"].above&&(u.summaryBelow=0),n["!outline"].left&&(u.summaryRight=0),o=(o||"")+tt("outlinePr",null,u)}!s&&!o||(i[i.length]=tt("sheetPr",o,a))}var n_e=["objects","scenarios","selectLockedCells","selectUnlockedCells"],r_e=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function i_e(n){var e={sheet:1};return n_e.forEach(function(t){n[t]!=null&&n[t]&&(e[t]="1")}),r_e.forEach(function(t){n[t]!=null&&!n[t]&&(e[t]="0")}),n.password&&(e.password=RV(n.password).toString(16).toUpperCase()),tt("sheetProtection",null,e)}function s_e(n){return WV(n),tt("pageMargins",null,n)}function a_e(n,e){for(var t=["<cols>"],r,i=0;i!=e.length;++i)(r=e[i])&&(t[t.length]=tt("col",null,HE(i,r)));return t[t.length]="</cols>",t.join("")}function o_e(n,e,t,r){var i=typeof n.ref=="string"?n.ref:Lr(n.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var s=t.Workbook.Names,a=ta(i);a.s.r==a.e.r&&(a.e.r=ta(e["!ref"]).e.r,i=Lr(a));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==r){l.Ref="'"+t.SheetNames[r]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+t.SheetNames[r]+"'!"+i}),tt("autoFilter",null,{ref:i})}function l_e(n,e,t,r){var i={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),tt("sheetViews",tt("sheetView",null,i),{})}function c_e(n,e,t,r){if(n.c&&t["!comments"].push([e,n.c]),n.v===void 0&&typeof n.f!="string"||n.t==="z"&&!n.f)return"";var i="",s=n.t,a=n.v;if(n.t!=="z")switch(n.t){case"b":i=n.v?"1":"0";break;case"n":i=""+n.v;break;case"e":i=k1[n.v];break;case"d":r&&r.cellDates?i=ns(n.v,-1).toISOString():(n=Is(n),n.t="n",i=""+(n.v=Ts(ns(n.v)))),typeof n.z>"u"&&(n.z=_r[14]);break;default:i=n.v;break}var o=Ei("v",Fn(i)),l={r:e},u=bu(r.cellXfs,n,r);switch(u!==0&&(l.s=u),n.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(n.v==null){delete n.t;break}if(n.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){o=Ei("v",""+oC(r.Strings,n.v,r.revStrings)),l.t="s";break}l.t="str";break}if(n.t!=s&&(n.t=s,n.v=a),typeof n.f=="string"&&n.f){var h=n.F&&n.F.slice(0,e.length)==e?{t:"array",ref:n.F}:null;o=tt("f",Fn(n.f),h)+(n.v!=null?o:"")}return n.l&&t["!links"].push([e,n.l]),n.D&&(l.cm=1),tt("c",o,l)}function u_e(n,e,t,r){var i=[],s=[],a=Zn(n["!ref"]),o="",l,u="",h=[],f=0,g=0,p=n["!rows"],E=Array.isArray(n),x={r:u},w,T=-1;for(g=a.s.c;g<=a.e.c;++g)h[g]=Ui(g);for(f=a.s.r;f<=a.e.r;++f){for(s=[],u=Si(f),g=a.s.c;g<=a.e.c;++g){l=h[g]+u;var I=E?(n[f]||[])[g]:n[l];I!==void 0&&(o=c_e(I,l,n,e))!=null&&s.push(o)}(s.length>0||p&&p[f])&&(x={r:u},p&&p[f]&&(w=p[f],w.hidden&&(x.hidden=1),T=-1,w.hpx?T=Sv(w.hpx):w.hpt&&(T=w.hpt),T>-1&&(x.ht=T,x.customHeight=1),w.level&&(x.outlineLevel=w.level)),i[i.length]=tt("row",s.join(""),x))}if(p)for(;f<p.length;++f)p&&p[f]&&(x={r:f+1},w=p[f],w.hidden&&(x.hidden=1),T=-1,w.hpx?T=Sv(w.hpx):w.hpt&&(T=w.hpt),T>-1&&(x.ht=T,x.customHeight=1),w.level&&(x.outlineLevel=w.level),i[i.length]=tt("row","",x));return i.join("")}function HV(n,e,t,r){var i=[Dr,tt("worksheet",null,{xmlns:$0[0],"xmlns:r":ri.r})],s=t.SheetNames[n],a=0,o="",l=t.Sheets[s];l==null&&(l={});var u=l["!ref"]||"A1",h=Zn(u);if(h.e.c>16383||h.e.r>1048575){if(e.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575),u=Lr(h)}r||(r={}),l["!comments"]=[];var f=[];t_e(l,t,n,e,i),i[i.length]=tt("dimension",null,{ref:u}),i[i.length]=l_e(l,e,n,t),e.sheetFormat&&(i[i.length]=tt("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=a_e(l,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=u_e(l,e),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=i_e(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=o_e(l["!autofilter"],l,t,n)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=e_e(l["!merges"]));var g=-1,p,E=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(x){x[1].Target&&(p={ref:x[0]},x[1].Target.charAt(0)!="#"&&(E=Ln(r,-1,Fn(x[1].Target).replace(/#.*$/,""),pn.HLINK),p["r:id"]="rId"+E),(g=x[1].Target.indexOf("#"))>-1&&(p.location=Fn(x[1].Target.slice(g+1))),x[1].Tooltip&&(p.tooltip=Fn(x[1].Tooltip)),i[i.length]=tt("hyperlink",null,p))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=s_e(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=Ei("ignoredErrors",tt("ignoredError",null,{numberStoredAsText:1,sqref:u}))),f.length>0&&(E=Ln(r,-1,"../drawings/drawing"+(n+1)+".xml",pn.DRAW),i[i.length]=tt("drawing",null,{"r:id":"rId"+E}),l["!drawing"]=f),l["!comments"].length>0&&(E=Ln(r,-1,"../drawings/vmlDrawing"+(n+1)+".vml",pn.VML),i[i.length]=tt("legacyDrawing",null,{"r:id":"rId"+E}),l["!legacy"]=E),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function h_e(n,e){var t={},r=n.l+e;t.r=n.read_shift(4),n.l+=4;var i=n.read_shift(2);n.l+=1;var s=n.read_shift(1);return n.l=r,s&7&&(t.level=s&7),s&16&&(t.hidden=!0),s&32&&(t.hpt=i/20),t}function d_e(n,e,t){var r=Ce(145),i=(t["!rows"]||[])[n]||{};r.write_shift(4,n),r.write_shift(4,0);var s=320;i.hpx?s=Sv(i.hpx)*20:i.hpt&&(s=i.hpt*20),r.write_shift(2,s),r.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),r.write_shift(1,a),r.write_shift(1,0);var o=0,l=r.l;r.l+=4;for(var u={r:n,c:0},h=0;h<16;++h)if(!(e.s.c>h+1<<10||e.e.c<h<<10)){for(var f=-1,g=-1,p=h<<10;p<h+1<<10;++p){u.c=p;var E=Array.isArray(t)?(t[u.r]||[])[u.c]:t[Vn(u)];E&&(f<0&&(f=p),g=p)}f<0||(++o,r.write_shift(4,f),r.write_shift(4,g))}var x=r.l;return r.l=l,r.write_shift(4,o),r.l=x,r.length>r.l?r.slice(0,r.l):r}function f_e(n,e,t,r){var i=d_e(r,t,e);(i.length>17||(e["!rows"]||[])[r])&&Ge(n,0,i)}var g_e=yd,m_e=H0;function p_e(){}function y_e(n,e){var t={},r=n[n.l];return++n.l,t.above=!(r&64),t.left=!(r&128),n.l+=18,t.name=bme(n),t}function __e(n,e,t){t==null&&(t=Ce(84+4*n.length));var r=192;e&&(e.above&&(r&=-65),e.left&&(r&=-129)),t.write_shift(1,r);for(var i=1;i<3;++i)t.write_shift(1,0);return xv({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),oV(n,t),t.slice(0,t.l)}function x_e(n){var e=ba(n);return[e]}function v_e(n,e,t){return t==null&&(t=Ce(8)),gd(e,t)}function E_e(n){var e=md(n);return[e]}function w_e(n,e,t){return t==null&&(t=Ce(4)),pd(e,t)}function S_e(n){var e=ba(n),t=n.read_shift(1);return[e,t,"b"]}function T_e(n,e,t){return t==null&&(t=Ce(9)),gd(e,t),t.write_shift(1,n.v?1:0),t}function I_e(n){var e=md(n),t=n.read_shift(1);return[e,t,"b"]}function A_e(n,e,t){return t==null&&(t=Ce(5)),pd(e,t),t.write_shift(1,n.v?1:0),t}function b_e(n){var e=ba(n),t=n.read_shift(1);return[e,t,"e"]}function R_e(n,e,t){return t==null&&(t=Ce(9)),gd(e,t),t.write_shift(1,n.v),t}function C_e(n){var e=md(n),t=n.read_shift(1);return[e,t,"e"]}function P_e(n,e,t){return t==null&&(t=Ce(8)),pd(e,t),t.write_shift(1,n.v),t.write_shift(2,0),t.write_shift(1,0),t}function k_e(n){var e=ba(n),t=n.read_shift(4);return[e,t,"s"]}function M_e(n,e,t){return t==null&&(t=Ce(12)),gd(e,t),t.write_shift(4,e.v),t}function N_e(n){var e=md(n),t=n.read_shift(4);return[e,t,"s"]}function L_e(n,e,t){return t==null&&(t=Ce(8)),pd(e,t),t.write_shift(4,e.v),t}function O_e(n){var e=ba(n),t=K0(n);return[e,t,"n"]}function D_e(n,e,t){return t==null&&(t=Ce(16)),gd(e,t),Jh(n.v,t),t}function F_e(n){var e=md(n),t=K0(n);return[e,t,"n"]}function j_e(n,e,t){return t==null&&(t=Ce(12)),pd(e,t),Jh(n.v,t),t}function V_e(n){var e=ba(n),t=lV(n);return[e,t,"n"]}function G_e(n,e,t){return t==null&&(t=Ce(12)),gd(e,t),cV(n.v,t),t}function B_e(n){var e=md(n),t=lV(n);return[e,t,"n"]}function U_e(n,e,t){return t==null&&(t=Ce(8)),pd(e,t),cV(n.v,t),t}function z_e(n){var e=ba(n),t=JR(n);return[e,t,"is"]}function $_e(n){var e=ba(n),t=zi(n);return[e,t,"str"]}function W_e(n,e,t){return t==null&&(t=Ce(12+4*n.v.length)),gd(e,t),ai(n.v,t),t.length>t.l?t.slice(0,t.l):t}function H_e(n){var e=md(n),t=zi(n);return[e,t,"str"]}function K_e(n,e,t){return t==null&&(t=Ce(8+4*n.v.length)),pd(e,t),ai(n.v,t),t.length>t.l?t.slice(0,t.l):t}function Y_e(n,e,t){var r=n.l+e,i=ba(n);i.r=t["!row"];var s=n.read_shift(1),a=[i,s,"b"];if(t.cellFormula){n.l+=2;var o=WE(n,r-n.l,t);a[3]=R0(o,null,i,t.supbooks,t)}else n.l=r;return a}function X_e(n,e,t){var r=n.l+e,i=ba(n);i.r=t["!row"];var s=n.read_shift(1),a=[i,s,"e"];if(t.cellFormula){n.l+=2;var o=WE(n,r-n.l,t);a[3]=R0(o,null,i,t.supbooks,t)}else n.l=r;return a}function q_e(n,e,t){var r=n.l+e,i=ba(n);i.r=t["!row"];var s=K0(n),a=[i,s,"n"];if(t.cellFormula){n.l+=2;var o=WE(n,r-n.l,t);a[3]=R0(o,null,i,t.supbooks,t)}else n.l=r;return a}function Z_e(n,e,t){var r=n.l+e,i=ba(n);i.r=t["!row"];var s=zi(n),a=[i,s,"str"];if(t.cellFormula){n.l+=2;var o=WE(n,r-n.l,t);a[3]=R0(o,null,i,t.supbooks,t)}else n.l=r;return a}var Q_e=yd,J_e=H0;function exe(n,e){return e==null&&(e=Ce(4)),e.write_shift(4,n),e}function txe(n,e){var t=n.l+e,r=yd(n),i=eC(n),s=zi(n),a=zi(n),o=zi(n);n.l=t;var l={rfx:r,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function nxe(n,e){var t=Ce(50+4*(n[1].Target.length+(n[1].Tooltip||"").length));H0({s:si(n[0]),e:si(n[0])},t),tC("rId"+e,t);var r=n[1].Target.indexOf("#"),i=r==-1?"":n[1].Target.slice(r+1);return ai(i||"",t),ai(n[1].Tooltip||"",t),ai("",t),t.slice(0,t.l)}function rxe(){}function ixe(n,e,t){var r=n.l+e,i=uV(n),s=n.read_shift(1),a=[i];if(a[2]=s,t.cellFormula){var o=Hye(n,r-n.l,t);a[1]=o}else n.l=r;return a}function sxe(n,e,t){var r=n.l+e,i=yd(n),s=[i];if(t.cellFormula){var a=Yye(n,r-n.l,t);s[1]=a,n.l=r}else n.l=r;return s}function axe(n,e,t){t==null&&(t=Ce(18));var r=HE(n,e);t.write_shift(-4,n),t.write_shift(-4,n),t.write_shift(4,(r.width||10)*256),t.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof r.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),t.write_shift(2,i),t}var KV=["left","right","top","bottom","header","footer"];function oxe(n){var e={};return KV.forEach(function(t){e[t]=K0(n)}),e}function lxe(n,e){return e==null&&(e=Ce(48)),WV(n),KV.forEach(function(t){Jh(n[t],e)}),e}function cxe(n){var e=n.read_shift(2);return n.l+=28,{RTL:e&32}}function uxe(n,e,t){t==null&&(t=Ce(30));var r=924;return(((e||{}).Views||[])[0]||{}).RTL&&(r|=32),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function hxe(n){var e=Ce(24);return e.write_shift(4,4),e.write_shift(4,1),H0(n,e),e}function dxe(n,e){return e==null&&(e=Ce(66)),e.write_shift(2,n.password?RV(n.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?e.write_shift(4,n[t[0]]!=null&&!n[t[0]]?1:0):e.write_shift(4,n[t[0]]!=null&&n[t[0]]?0:1)}),e}function fxe(){}function gxe(){}function mxe(n,e,t,r,i,s,a){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=Is(e),e.z=e.z||_r[14],e.v=Ts(ns(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var l={r:t,c:r};switch(l.s=bu(i.cellXfs,e,i),e.l&&s["!links"].push([Vn(l),e.l]),e.c&&s["!comments"].push([Vn(l),e.c]),e.t){case"s":case"str":return i.bookSST?(o=oC(i.Strings,e.v,i.revStrings),l.t="s",l.v=o,a?Ge(n,18,L_e(e,l)):Ge(n,7,M_e(e,l))):(l.t="str",a?Ge(n,17,K_e(e,l)):Ge(n,6,W_e(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?Ge(n,13,U_e(e,l)):Ge(n,2,G_e(e,l)):a?Ge(n,16,j_e(e,l)):Ge(n,5,D_e(e,l)),!0;case"b":return l.t="b",a?Ge(n,15,A_e(e,l)):Ge(n,4,T_e(e,l)),!0;case"e":return l.t="e",a?Ge(n,14,P_e(e,l)):Ge(n,3,R_e(e,l)),!0}return a?Ge(n,12,w_e(e,l)):Ge(n,1,v_e(e,l)),!0}function pxe(n,e,t,r){var i=Zn(e["!ref"]||"A1"),s,a="",o=[];Ge(n,145);var l=Array.isArray(e),u=i.e.r;e["!rows"]&&(u=Math.max(i.e.r,e["!rows"].length-1));for(var h=i.s.r;h<=u;++h){a=Si(h),f_e(n,e,i,h);var f=!1;if(h<=i.e.r)for(var g=i.s.c;g<=i.e.c;++g){h===i.s.r&&(o[g]=Ui(g)),s=o[g]+a;var p=l?(e[h]||[])[g]:e[s];if(!p){f=!1;continue}f=mxe(n,p,h,g,r,e,f)}}Ge(n,146)}function yxe(n,e){!e||!e["!merges"]||(Ge(n,177,exe(e["!merges"].length)),e["!merges"].forEach(function(t){Ge(n,176,J_e(t))}),Ge(n,178))}function _xe(n,e){!e||!e["!cols"]||(Ge(n,390),e["!cols"].forEach(function(t,r){t&&Ge(n,60,axe(r,t))}),Ge(n,391))}function xxe(n,e){!e||!e["!ref"]||(Ge(n,648),Ge(n,649,hxe(Zn(e["!ref"]))),Ge(n,650))}function vxe(n,e,t){e["!links"].forEach(function(r){if(r[1].Target){var i=Ln(t,-1,r[1].Target.replace(/#.*$/,""),pn.HLINK);Ge(n,494,nxe(r,i))}}),delete e["!links"]}function Exe(n,e,t,r){if(e["!comments"].length>0){var i=Ln(r,-1,"../drawings/vmlDrawing"+(t+1)+".vml",pn.VML);Ge(n,551,tC("rId"+i)),e["!legacy"]=i}}function wxe(n,e,t,r){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:Lr(i.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var a=t.Workbook.Names,o=ta(s);o.s.r==o.e.r&&(o.e.r=ta(e["!ref"]).e.r,s=Lr(o));for(var l=0;l<a.length;++l){var u=a[l];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==r){u.Ref="'"+t.SheetNames[r]+"'!"+s;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+t.SheetNames[r]+"'!"+s}),Ge(n,161,H0(Zn(s))),Ge(n,162)}}function Sxe(n,e,t){Ge(n,133),Ge(n,137,uxe(e,t)),Ge(n,138),Ge(n,134)}function Txe(n,e){e["!protect"]&&Ge(n,535,dxe(e["!protect"]))}function Ixe(n,e,t,r){var i=ws(),s=t.SheetNames[n],a=t.Sheets[s]||{},o=s;try{t&&t.Workbook&&(o=t.Workbook.Sheets[n].CodeName||o)}catch{}var l=Zn(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],Ge(i,129),(t.vbaraw||a["!outline"])&&Ge(i,147,__e(o,a["!outline"])),Ge(i,148,m_e(l)),Sxe(i,a,t.Workbook),_xe(i,a),pxe(i,a,n,e),Txe(i,a),wxe(i,a,t,n),yxe(i,a),vxe(i,a,r),a["!margins"]&&Ge(i,476,lxe(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&xxe(i,a),Exe(i,a,n,r),Ge(i,130),i.end()}function Axe(n,e){n.l+=10;var t=zi(n);return{name:t}}var bxe=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function Rxe(n){return!n.Workbook||!n.Workbook.WBProps?"false":sme(n.Workbook.WBProps.date1904)?"true":"false"}var Cxe="][*?/\\".split("");function YV(n,e){if(n.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return Cxe.forEach(function(r){if(n.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function Pxe(n,e,t){n.forEach(function(r,i){YV(r);for(var s=0;s<i;++s)if(r==n[s])throw new Error("Duplicate Sheet Name: "+r);if(t){var a=e&&e[i]&&e[i].CodeName||r;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function kxe(n){if(!n||!n.SheetNames||!n.Sheets)throw new Error("Invalid Workbook");if(!n.SheetNames.length)throw new Error("Workbook is empty");var e=n.Workbook&&n.Workbook.Sheets||[];Pxe(n.SheetNames,e,!!n.vbaraw);for(var t=0;t<n.SheetNames.length;++t)Jye(n.Sheets[n.SheetNames[t]],n.SheetNames[t],t)}function XV(n){var e=[Dr];e[e.length]=tt("workbook",null,{xmlns:$0[0],"xmlns:r":ri.r});var t=n.Workbook&&(n.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};n.Workbook&&n.Workbook.WBProps&&(bxe.forEach(function(o){n.Workbook.WBProps[o[0]]!=null&&n.Workbook.WBProps[o[0]]!=o[1]&&(r[o[0]]=n.Workbook.WBProps[o[0]])}),n.Workbook.WBProps.CodeName&&(r.codeName=n.Workbook.WBProps.CodeName,delete r.CodeName)),e[e.length]=tt("workbookPr",null,r);var i=n.Workbook&&n.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=n.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==n.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=n.SheetNames.length;++s){var a={name:Fn(n.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=tt("sheet",null,a)}return e[e.length]="</sheets>",t&&(e[e.length]="<definedNames>",n.Workbook&&n.Workbook.Names&&n.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(e[e.length]=tt("definedName",Fn(o.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function Mxe(n,e){var t={};return t.Hidden=n.read_shift(4),t.iTabID=n.read_shift(4),t.strRelID=jI(n),t.name=zi(n),t}function Nxe(n,e){return e||(e=Ce(127)),e.write_shift(4,n.Hidden),e.write_shift(4,n.iTabID),tC(n.strRelID,e),ai(n.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function Lxe(n,e){var t={},r=n.read_shift(4);t.defaultThemeVersion=n.read_shift(4);var i=e>8?zi(n):"";return i.length>0&&(t.CodeName=i),t.autoCompressPictures=!!(r&65536),t.backupFile=!!(r&64),t.checkCompatibility=!!(r&4096),t.date1904=!!(r&1),t.filterPrivacy=!!(r&8),t.hidePivotFieldList=!!(r&1024),t.promptedSolutions=!!(r&16),t.publishItems=!!(r&2048),t.refreshAllConnections=!!(r&262144),t.saveExternalLinkValues=!!(r&128),t.showBorderUnselectedTables=!!(r&4),t.showInkAnnotation=!!(r&32),t.showObjects=["all","placeholders","none"][r>>13&3],t.showPivotChartFilter=!!(r&32768),t.updateLinks=["userSet","never","always"][r>>8&3],t}function Oxe(n,e){e||(e=Ce(72));var t=0;return n&&n.filterPrivacy&&(t|=8),e.write_shift(4,t),e.write_shift(4,0),oV(n&&n.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function Dxe(n,e,t){var r=n.l+e;n.l+=4,n.l+=1;var i=n.read_shift(4),s=Rme(n),a=Kye(n,0,t),o=eC(n);n.l=r;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function Fxe(n,e){Ge(n,143);for(var t=0;t!=e.SheetNames.length;++t){var r=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[t]&&e.Workbook.Sheets[t].Hidden||0,i={Hidden:r,iTabID:t+1,strRelID:"rId"+(t+1),name:e.SheetNames[t]};Ge(n,156,Nxe(i))}Ge(n,144)}function jxe(n,e){e||(e=Ce(127));for(var t=0;t!=4;++t)e.write_shift(4,0);return ai("SheetJS",e),ai(hv.version,e),ai(hv.version,e),ai("7262",e),e.length>e.l?e.slice(0,e.l):e}function Vxe(n,e){e||(e=Ce(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,n),e.write_shift(4,n);var t=120;return e.write_shift(1,t),e.length>e.l?e.slice(0,e.l):e}function Gxe(n,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var t=e.Workbook.Sheets,r=0,i=-1,s=-1;r<t.length;++r)!t[r]||!t[r].Hidden&&i==-1?i=r:t[r].Hidden==1&&s==-1&&(s=r);s>i||(Ge(n,135),Ge(n,158,Vxe(i)),Ge(n,136))}}function Bxe(n,e){var t=ws();return Ge(t,131),Ge(t,128,jxe()),Ge(t,153,Oxe(n.Workbook&&n.Workbook.WBProps||null)),Gxe(t,n),Fxe(t,n),Ge(t,132),t.end()}function Uxe(n,e,t){return(e.slice(-4)===".bin"?Bxe:XV)(n)}function zxe(n,e,t,r,i){return(e.slice(-4)===".bin"?Ixe:HV)(n,t,r,i)}function $xe(n,e,t){return(e.slice(-4)===".bin"?l1e:kV)(n,t)}function Wxe(n,e,t){return(e.slice(-4)===".bin"?Ope:bV)(n,t)}function Hxe(n,e,t){return(e.slice(-4)===".bin"?T1e:DV)(n)}function Kxe(n){return(n.slice(-4)===".bin"?p1e:LV)()}function Yxe(n,e){var t=[];return n.Props&&t.push($me(n.Props,e)),n.Custprops&&t.push(Wme(n.Props,n.Custprops)),t.join("")}function Xxe(){return""}function qxe(n,e){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(r,i){var s=[];s.push(tt("NumberFormat",null,{"ss:Format":Fn(_r[r.numFmtId])}));var a={"ss:ID":"s"+(21+i)};t.push(tt("Style",s.join(""),a))}),tt("Styles",t.join(""))}function qV(n){return tt("NamedRange",null,{"ss:Name":n.Name,"ss:RefersTo":"="+sC(n.Ref,{r:0,c:0})})}function Zxe(n){if(!((n||{}).Workbook||{}).Names)return"";for(var e=n.Workbook.Names,t=[],r=0;r<e.length;++r){var i=e[r];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||t.push(qV(i)))}return tt("Names",t.join(""))}function Qxe(n,e,t,r){if(!n||!((r||{}).Workbook||{}).Names)return"";for(var i=r.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==t&&(o.Name.match(/^_xlfn\./)||s.push(qV(o)))}return s.join("")}function Jxe(n,e,t,r){if(!n)return"";var i=[];if(n["!margins"]&&(i.push("<PageSetup>"),n["!margins"].header&&i.push(tt("Header",null,{"x:Margin":n["!margins"].header})),n["!margins"].footer&&i.push(tt("Footer",null,{"x:Margin":n["!margins"].footer})),i.push(tt("PageMargins",null,{"x:Bottom":n["!margins"].bottom||"0.75","x:Left":n["!margins"].left||"0.7","x:Right":n["!margins"].right||"0.7","x:Top":n["!margins"].top||"0.75"})),i.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[t])if(r.Workbook.Sheets[t].Hidden)i.push(tt("Visible",r.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<t&&!(r.Workbook.Sheets[s]&&!r.Workbook.Sheets[s].Hidden);++s);s==t&&i.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),n["!protect"]&&(i.push(Ei("ProtectContents","True")),n["!protect"].objects&&i.push(Ei("ProtectObjects","True")),n["!protect"].scenarios&&i.push(Ei("ProtectScenarios","True")),n["!protect"].selectLockedCells!=null&&!n["!protect"].selectLockedCells?i.push(Ei("EnableSelection","NoSelection")):n["!protect"].selectUnlockedCells!=null&&!n["!protect"].selectUnlockedCells&&i.push(Ei("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){n["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":tt("WorksheetOptions",i.join(""),{xmlns:$s.x})}function eve(n){return n.map(function(e){var t=ime(e.t||""),r=tt("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return tt("Comment",r,{"ss:Author":e.a})}).join("")}function tve(n,e,t,r,i,s,a){if(!n||n.v==null&&n.f==null)return"";var o={};if(n.f&&(o["ss:Formula"]="="+Fn(sC(n.f,a))),n.F&&n.F.slice(0,e.length)==e){var l=si(n.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(n.l&&n.l.Target&&(o["ss:HRef"]=Fn(n.l.Target),n.l.Tooltip&&(o["x:HRefScreenTip"]=Fn(n.l.Tooltip))),t["!merges"])for(var u=t["!merges"],h=0;h!=u.length;++h)u[h].s.c!=a.c||u[h].s.r!=a.r||(u[h].e.c>u[h].s.c&&(o["ss:MergeAcross"]=u[h].e.c-u[h].s.c),u[h].e.r>u[h].s.r&&(o["ss:MergeDown"]=u[h].e.r-u[h].s.r));var f="",g="";switch(n.t){case"z":if(!r.sheetStubs)return"";break;case"n":f="Number",g=String(n.v);break;case"b":f="Boolean",g=n.v?"1":"0";break;case"e":f="Error",g=k1[n.v];break;case"d":f="DateTime",g=new Date(n.v).toISOString(),n.z==null&&(n.z=n.z||_r[14]);break;case"s":f="String",g=rme(n.v||"");break}var p=bu(r.cellXfs,n,r);o["ss:StyleID"]="s"+(21+p),o["ss:Index"]=a.c+1;var E=n.v!=null?g:"",x=n.t=="z"?"":'<Data ss:Type="'+f+'">'+E+"</Data>";return(n.c||[]).length>0&&(x+=eve(n.c)),tt("Cell",x,o)}function nve(n,e){var t='<Row ss:Index="'+(n+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=PV(e.hpt)),e.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(t+=' ss:Hidden="1"')),t+">"}function rve(n,e,t,r){if(!n["!ref"])return"";var i=Zn(n["!ref"]),s=n["!merges"]||[],a=0,o=[];n["!cols"]&&n["!cols"].forEach(function(w,T){rC(w);var I=!!w.width,P=HE(T,w),N={"ss:Index":T+1};I&&(N["ss:Width"]=Ev(P.width)),w.hidden&&(N["ss:Hidden"]="1"),o.push(tt("Column",null,N))});for(var l=Array.isArray(n),u=i.s.r;u<=i.e.r;++u){for(var h=[nve(u,(n["!rows"]||[])[u])],f=i.s.c;f<=i.e.c;++f){var g=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>f)&&!(s[a].s.r>u)&&!(s[a].e.c<f)&&!(s[a].e.r<u)){(s[a].s.c!=f||s[a].s.r!=u)&&(g=!0);break}if(!g){var p={r:u,c:f},E=Vn(p),x=l?(n[u]||[])[f]:n[E];h.push(tve(x,E,n,e,t,r,p))}}h.push("</Row>"),h.length>2&&o.push(h.join(""))}return o.join("")}function ive(n,e,t){var r=[],i=t.SheetNames[n],s=t.Sheets[i],a=s?Qxe(s,e,n,t):"";return a.length>0&&r.push("<Names>"+a+"</Names>"),a=s?rve(s,e,n,t):"",a.length>0&&r.push("<Table>"+a+"</Table>"),r.push(Jxe(s,e,n,t)),r.join("")}function sve(n,e){e||(e={}),n.SSF||(n.SSF=Is(_r)),n.SSF&&(BE(),GE(n.SSF),e.revssf=UE(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF,e.cellXfs=[],bu(e.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(Yxe(n,e)),t.push(Xxe()),t.push(""),t.push("");for(var r=0;r<n.SheetNames.length;++r)t.push(tt("Worksheet",ive(r,e,n),{"ss:Name":Fn(n.SheetNames[r])}));return t[2]=qxe(n,e),t[3]=Zxe(n),Dr+tt("Workbook",t.join(""),{xmlns:$s.ss,"xmlns:o":$s.o,"xmlns:x":$s.x,"xmlns:ss":$s.ss,"xmlns:dt":$s.dt,"xmlns:html":$s.html})}var GS={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function ave(n,e){var t=[],r=[],i=[],s=0,a,o=eO(fO,"n"),l=eO(gO,"n");if(n.Props)for(a=Ii(n.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?t:Object.prototype.hasOwnProperty.call(l,a[s])?r:i).push([a[s],n.Props[a[s]]]);if(n.Custprops)for(a=Ii(n.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(n.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?t:Object.prototype.hasOwnProperty.call(l,a[s])?r:i).push([a[s],n.Custprops[a[s]]]);var u=[];for(s=0;s<i.length;++s)vV.indexOf(i[s][0])>-1||yV.indexOf(i[s][0])>-1||i[s][1]!=null&&u.push(i[s]);r.length&&Gn.utils.cfb_add(e,"/SummaryInformation",xO(r,GS.SI,l,gO)),(t.length||u.length)&&Gn.utils.cfb_add(e,"/DocumentSummaryInformation",xO(t,GS.DSI,o,fO,u.length?u:null,GS.UDI))}function ove(n,e){var t=e||{},r=Gn.utils.cfb_new({root:"R"}),i="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":i="/Workbook",t.biff=8;break;case"biff5":i="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return Gn.utils.cfb_add(r,i,ZV(n,t)),t.biff==8&&(n.Props||n.Custprops)&&ave(n,r),t.biff==8&&n.vbaraw&&I1e(r,Gn.read(n.vbaraw,{type:typeof n.vbaraw=="string"?"binary":"buffer"})),r}var lve={0:{f:h_e},1:{f:x_e},2:{f:V_e},3:{f:b_e},4:{f:S_e},5:{f:O_e},6:{f:$_e},7:{f:k_e},8:{f:Z_e},9:{f:q_e},10:{f:Y_e},11:{f:X_e},12:{f:E_e},13:{f:B_e},14:{f:C_e},15:{f:I_e},16:{f:F_e},17:{f:H_e},18:{f:N_e},19:{f:JR},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Dxe},40:{},42:{},43:{f:$pe},44:{f:Upe},45:{f:Kpe},46:{f:Xpe},47:{f:Ype},48:{},49:{f:Eme},50:{},51:{f:h1e},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:wpe},62:{f:z_e},63:{f:y1e},64:{f:fxe},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Xo,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:cxe},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:y_e},148:{f:g_e,p:16},151:{f:rxe},152:{},153:{f:Lxe},154:{},155:{},156:{f:Mxe},157:{},158:{},159:{T:1,f:Mpe},160:{T:-1},161:{T:1,f:yd},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Q_e},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:c1e},336:{T:-1},337:{f:g1e,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:jI},357:{},358:{},359:{},360:{T:1},361:{},362:{f:ppe},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:ixe},427:{f:sxe},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:oxe},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:p_e},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:txe},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:jI},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:w1e},633:{T:1},634:{T:-1},635:{T:1,f:v1e},636:{T:-1},637:{f:Ime},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Axe},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:gxe},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function nt(n,e,t,r){var i=e;if(!isNaN(i)){var s=r||(t||[]).length||0,a=n.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&qR(t)&&n.push(t)}}function cve(n,e,t,r){var i=(t||[]).length||0;if(i<=8224)return nt(n,e,t,i);var s=e;if(!isNaN(s)){for(var a=t.parts||[],o=0,l=0,u=0;u+(a[o]||8224)<=8224;)u+=a[o]||8224,o++;var h=n.next(4);for(h.write_shift(2,s),h.write_shift(2,u),n.push(t.slice(l,l+u)),l+=u;l<i;){for(h=n.next(4),h.write_shift(2,60),u=0;u+(a[o]||8224)<=8224;)u+=a[o]||8224,o++;h.write_shift(2,u),n.push(t.slice(l,l+u)),l+=u}}}function N1(n,e,t){return n||(n=Ce(7)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,0),n.write_shift(1,0),n}function uve(n,e,t,r){var i=Ce(9);return N1(i,n,e),wV(t,r||"b",i),i}function hve(n,e,t){var r=Ce(8+2*t.length);return N1(r,n,e),r.write_shift(1,t.length),r.write_shift(t.length,t,"sbcs"),r.l<r.length?r.slice(0,r.l):r}function dve(n,e,t,r){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?Ts(ns(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?nt(n,2,Ape(t,r,i)):nt(n,3,Ipe(t,r,i));return;case"b":case"e":nt(n,5,uve(t,r,e.v,e.t));return;case"s":case"str":nt(n,4,hve(t,r,(e.v||"").slice(0,255)));return}nt(n,1,N1(null,t,r))}function fve(n,e,t,r){var i=Array.isArray(e),s=Zn(e["!ref"]||"A1"),a,o="",l=[];if(s.e.c>255||s.e.r>16383){if(r.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=Lr(s)}for(var u=s.s.r;u<=s.e.r;++u){o=Si(u);for(var h=s.s.c;h<=s.e.c;++h){u===s.s.r&&(l[h]=Ui(h)),a=l[h]+o;var f=i?(e[u]||[])[h]:e[a];f&&dve(n,f,u,h)}}}function gve(n,e){for(var t=e||{},r=ws(),i=0,s=0;s<n.SheetNames.length;++s)n.SheetNames[s]==t.sheet&&(i=s);if(i==0&&t.sheet&&n.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return nt(r,t.biff==4?1033:t.biff==3?521:9,nC(n,16,t)),fve(r,n.Sheets[n.SheetNames[i]],i,t),nt(r,10),r.end()}function mve(n,e,t){nt(n,49,lpe({sz:12,name:"Arial"},t))}function pve(n,e,t){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&nt(n,1054,hpe(i,e[i],t))})}function yve(n,e){var t=Ce(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),nt(n,2151,t),t=Ce(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),IV(Zn(e["!ref"]||"A1"),t),t.write_shift(4,4),nt(n,2152,t)}function _ve(n,e){for(var t=0;t<16;++t)nt(n,224,EO({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(r){nt(n,224,EO(r,0,e))})}function xve(n,e){for(var t=0;t<e["!links"].length;++t){var r=e["!links"][t];nt(n,440,xpe(r)),r[1].Tooltip&&nt(n,2048,vpe(r))}delete e["!links"]}function vve(n,e){if(e){var t=0;e.forEach(function(r,i){++t<=256&&r&&nt(n,125,Spe(HE(i,r),i))})}}function Eve(n,e,t,r,i){var s=16+bu(i.cellXfs,e,i);if(e.v==null&&!e.bf){nt(n,513,ed(t,r,s));return}if(e.bf)nt(n,6,Wye(e,t,r,i,s));else switch(e.t){case"d":case"n":var a=e.t=="d"?Ts(ns(e.v)):e.v;nt(n,515,mpe(t,r,a,s));break;case"b":case"e":nt(n,517,gpe(t,r,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var o=oC(i.Strings,e.v,i.revStrings);nt(n,253,cpe(t,r,o,s))}else nt(n,516,upe(t,r,(e.v||"").slice(0,255),s,i));break;default:nt(n,513,ed(t,r,s))}}function wve(n,e,t){var r=ws(),i=t.SheetNames[n],s=t.Sheets[i]||{},a=(t||{}).Workbook||{},o=(a.Sheets||[])[n]||{},l=Array.isArray(s),u=e.biff==8,h,f="",g=[],p=Zn(s["!ref"]||"A1"),E=u?65536:16384;if(p.e.c>255||p.e.r>=E){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,E-1)}nt(r,2057,nC(t,16,e)),nt(r,13,ma(1)),nt(r,12,ma(100)),nt(r,15,Xi(!0)),nt(r,17,Xi(!1)),nt(r,16,Jh(.001)),nt(r,95,Xi(!0)),nt(r,42,Xi(!1)),nt(r,43,Xi(!1)),nt(r,130,ma(1)),nt(r,128,fpe()),nt(r,131,Xi(!1)),nt(r,132,Xi(!1)),u&&vve(r,s["!cols"]),nt(r,512,dpe(p,e)),u&&(s["!links"]=[]);for(var x=p.s.r;x<=p.e.r;++x){f=Si(x);for(var w=p.s.c;w<=p.e.c;++w){x===p.s.r&&(g[w]=Ui(w)),h=g[w]+f;var T=l?(s[x]||[])[w]:s[h];T&&(Eve(r,T,x,w,e),u&&T.l&&s["!links"].push([h,T.l]))}}var I=o.CodeName||o.name||i;return u&&nt(r,574,ope((a.Views||[])[0])),u&&(s["!merges"]||[]).length&&nt(r,229,_pe(s["!merges"])),u&&xve(r,s),nt(r,442,TV(I)),u&&yve(r,s),nt(r,10),r.end()}function Sve(n,e,t){var r=ws(),i=(n||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=t.biff==8,l=t.biff==5;if(nt(r,2057,nC(n,5,t)),t.bookType=="xla"&&nt(r,135),nt(r,225,o?ma(1200):null),nt(r,193,Yme(2)),l&&nt(r,191),l&&nt(r,192),nt(r,226),nt(r,92,rpe("SheetJS",t)),nt(r,66,ma(o?1200:1252)),o&&nt(r,353,ma(0)),o&&nt(r,448),nt(r,317,Tpe(n.SheetNames.length)),o&&n.vbaraw&&nt(r,211),o&&n.vbaraw){var u=a.CodeName||"ThisWorkbook";nt(r,442,TV(u))}nt(r,156,ma(17)),nt(r,25,Xi(!1)),nt(r,18,Xi(!1)),nt(r,19,ma(0)),o&&nt(r,431,Xi(!1)),o&&nt(r,444,ma(0)),nt(r,61,ape()),nt(r,64,Xi(!1)),nt(r,141,ma(0)),nt(r,34,Xi(Rxe(n)=="true")),nt(r,14,Xi(!0)),o&&nt(r,439,Xi(!1)),nt(r,218,ma(0)),mve(r,n,t),pve(r,n.SSF,t),_ve(r,t),o&&nt(r,352,Xi(!1));var h=r.end(),f=ws();o&&nt(f,140,Epe()),o&&t.Strings&&cve(f,252,spe(t.Strings)),nt(f,10);var g=f.end(),p=ws(),E=0,x=0;for(x=0;x<n.SheetNames.length;++x)E+=(o?12:11)+(o?2:1)*n.SheetNames[x].length;var w=h.length+E+g.length;for(x=0;x<n.SheetNames.length;++x){var T=s[x]||{};nt(p,133,ipe({pos:w,hs:T.Hidden||0,dt:0,name:n.SheetNames[x]},t)),w+=e[x].length}var I=p.end();if(E!=I.length)throw new Error("BS8 "+E+" != "+I.length);var P=[];return h.length&&P.push(h),I.length&&P.push(I),g.length&&P.push(g),vi(P)}function Tve(n,e){var t=e||{},r=[];n&&!n.SSF&&(n.SSF=Is(_r)),n&&n.SSF&&(BE(),GE(n.SSF),t.revssf=UE(n.SSF),t.revssf[n.SSF[65535]]=0,t.ssf=n.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,lC(t),t.cellXfs=[],bu(t.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={});for(var i=0;i<n.SheetNames.length;++i)r[r.length]=wve(i,t,n);return r.unshift(Sve(n,r,t)),vi(r)}function ZV(n,e){for(var t=0;t<=n.SheetNames.length;++t){var r=n.Sheets[n.SheetNames[t]];if(!(!r||!r["!ref"])){var i=ta(r["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+n.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return Tve(n,e);case 4:case 3:case 2:return gve(n,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function Ive(n,e,t,r){for(var i=n["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,u=0;u<i.length;++u)if(!(i[u].s.r>t||i[u].s.c>a)&&!(i[u].e.r<t||i[u].e.c<a)){if(i[u].s.r<t||i[u].s.c<a){o=-1;break}o=i[u].e.r-i[u].s.r+1,l=i[u].e.c-i[u].s.c+1;break}if(!(o<0)){var h=Vn({r:t,c:a}),f=r.dense?(n[t]||[])[a]:n[h],g=f&&f.v!=null&&(f.h||nme(f.w||(zl(f),f.w)||""))||"",p={};o>1&&(p.rowspan=o),l>1&&(p.colspan=l),r.editable?g='<span contenteditable="true">'+g+"</span>":f&&(p["data-t"]=f&&f.t||"z",f.v!=null&&(p["data-v"]=f.v),f.z!=null&&(p["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(g='<a href="'+f.l.Target+'">'+g+"</a>")),p.id=(r.id||"sjs")+"-"+h,s.push(tt("td",g,p))}}var E="<tr>";return E+s.join("")+"</tr>"}var Ave='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',bve="</body></html>";function Rve(n,e,t){var r=[];return r.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function QV(n,e){var t=e||{},r=t.header!=null?t.header:Ave,i=t.footer!=null?t.footer:bve,s=[r],a=ta(n["!ref"]);t.dense=Array.isArray(n),s.push(Rve(n,a,t));for(var o=a.s.r;o<=a.e.r;++o)s.push(Ive(n,a,o,t));return s.push("</table>"+i),s.join("")}function JV(n,e,t){var r=t||{},i=0,s=0;if(r.origin!=null)if(typeof r.origin=="number")i=r.origin;else{var a=typeof r.origin=="string"?si(r.origin):r.origin;i=a.r,s=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(r.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:i,c:s}};if(n["!ref"]){var h=ta(n["!ref"]);u.s.r=Math.min(u.s.r,h.s.r),u.s.c=Math.min(u.s.c,h.s.c),u.e.r=Math.max(u.e.r,h.e.r),u.e.c=Math.max(u.e.c,h.e.c),i==-1&&(u.e.r=i=h.e.r+1)}var f=[],g=0,p=n["!rows"]||(n["!rows"]=[]),E=0,x=0,w=0,T=0,I=0,P=0;for(n["!cols"]||(n["!cols"]=[]);E<o.length&&x<l;++E){var N=o[E];if(RO(N)){if(r.display)continue;p[x]={hidden:!0}}var D=N.children;for(w=T=0;w<D.length;++w){var B=D[w];if(!(r.display&&RO(B))){var k=B.hasAttribute("data-v")?B.getAttribute("data-v"):B.hasAttribute("v")?B.getAttribute("v"):ame(B.innerHTML),C=B.getAttribute("data-z")||B.getAttribute("z");for(g=0;g<f.length;++g){var M=f[g];M.s.c==T+s&&M.s.r<x+i&&x+i<=M.e.r&&(T=M.e.c+1-s,g=-1)}P=+B.getAttribute("colspan")||1,((I=+B.getAttribute("rowspan")||1)>1||P>1)&&f.push({s:{r:x+i,c:T+s},e:{r:x+i+(I||1)-1,c:T+s+(P||1)-1}});var j={t:"s",v:k},O=B.getAttribute("data-t")||B.getAttribute("t")||"";k!=null&&(k.length==0?j.t=O||"z":r.raw||k.trim().length==0||O=="s"||(k==="TRUE"?j={t:"b",v:!0}:k==="FALSE"?j={t:"b",v:!1}:isNaN(Nl(k))?isNaN(Cp(k).getDate())||(j={t:"d",v:ns(k)},r.cellDates||(j={t:"n",v:Ts(j.v)}),j.z=r.dateNF||_r[14]):j={t:"n",v:Nl(k)})),j.z===void 0&&C!=null&&(j.z=C);var W="",F=B.getElementsByTagName("A");if(F&&F.length)for(var Te=0;Te<F.length&&!(F[Te].hasAttribute("href")&&(W=F[Te].getAttribute("href"),W.charAt(0)!="#"));++Te);W&&W.charAt(0)!="#"&&(j.l={Target:W}),r.dense?(n[x+i]||(n[x+i]=[]),n[x+i][T+s]=j):n[Vn({c:T+s,r:x+i})]=j,u.e.c<T+s&&(u.e.c=T+s),T+=P}}++x}return f.length&&(n["!merges"]=(n["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,x-1+i),n["!ref"]=Lr(u),x>=l&&(n["!fullref"]=Lr((u.e.r=o.length-E+x-1+i,u))),n}function eG(n,e){var t=e||{},r=t.dense?[]:{};return JV(r,n,e)}function Cve(n,e){return fd(eG(n,e),e)}function RO(n){var e="",t=Pve(n);return t&&(e=t(n).getPropertyValue("display")),e||(e=n.style&&n.style.display),e==="none"}function Pve(n){return n.ownerDocument.defaultView&&typeof n.ownerDocument.defaultView.getComputedStyle=="function"?n.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var kve=(function(){var n=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+kp({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+n+"</office:document-styles>";return function(){return Dr+e}})(),CO=(function(){var n=function(s){return Fn(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,r=function(s,a,o){var l=[];l.push('      <table:table table:name="'+Fn(a.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,h=0,f=ta(s["!ref"]||"A1"),g=s["!merges"]||[],p=0,E=Array.isArray(s);if(s["!cols"])for(h=0;h<=f.e.c;++h)l.push("        <table:table-column"+(s["!cols"][h]?' table:style-name="co'+s["!cols"][h].ods+'"':"")+`></table:table-column>
`);var x="",w=s["!rows"]||[];for(u=0;u<f.s.r;++u)x=w[u]?' table:style-name="ro'+w[u].ods+'"':"",l.push("        <table:table-row"+x+`></table:table-row>
`);for(;u<=f.e.r;++u){for(x=w[u]?' table:style-name="ro'+w[u].ods+'"':"",l.push("        <table:table-row"+x+`>
`),h=0;h<f.s.c;++h)l.push(e);for(;h<=f.e.c;++h){var T=!1,I={},P="";for(p=0;p!=g.length;++p)if(!(g[p].s.c>h)&&!(g[p].s.r>u)&&!(g[p].e.c<h)&&!(g[p].e.r<u)){(g[p].s.c!=h||g[p].s.r!=u)&&(T=!0),I["table:number-columns-spanned"]=g[p].e.c-g[p].s.c+1,I["table:number-rows-spanned"]=g[p].e.r-g[p].s.r+1;break}if(T){l.push(t);continue}var N=Vn({r:u,c:h}),D=E?(s[u]||[])[h]:s[N];if(D&&D.f&&(I["table:formula"]=Fn(Zye(D.f)),D.F&&D.F.slice(0,N.length)==N)){var B=ta(D.F);I["table:number-matrix-columns-spanned"]=B.e.c-B.s.c+1,I["table:number-matrix-rows-spanned"]=B.e.r-B.s.r+1}if(!D){l.push(e);continue}switch(D.t){case"b":P=D.v?"TRUE":"FALSE",I["office:value-type"]="boolean",I["office:boolean-value"]=D.v?"true":"false";break;case"n":P=D.w||String(D.v||0),I["office:value-type"]="float",I["office:value"]=D.v||0;break;case"s":case"str":P=D.v==null?"":D.v,I["office:value-type"]="string";break;case"d":P=D.w||ns(D.v).toISOString(),I["office:value-type"]="date",I["office:date-value"]=ns(D.v).toISOString(),I["table:style-name"]="ce1";break;default:l.push(e);continue}var k=n(P);if(D.l&&D.l.Target){var C=D.l.Target;C=C.charAt(0)=="#"?"#"+Qye(C.slice(1)):C,C.charAt(0)!="#"&&!C.match(/^\w+:/)&&(C="../"+C),k=tt("text:a",k,{"xlink:href":C.replace(/&/g,"&amp;")})}l.push("          "+tt("table:table-cell",tt("text:p",k,{}),I)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var h=0;h<u["!cols"].length;++h)if(u["!cols"][h]){var f=u["!cols"][h];if(f.width==null&&f.wpx==null&&f.wch==null)continue;rC(f),f.ods=o;var g=u["!cols"][h].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+g+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var h=0;h<u["!rows"].length;++h)if(u["!rows"][h]){u["!rows"][h].ods=l;var f=u["!rows"][h].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var l=[Dr],u=kp({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),h=kp({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+u+h+`>
`),l.push(mV().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+u+`>
`),i(l,a),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var f=0;f!=a.SheetNames.length;++f)l.push(r(a.Sheets[a.SheetNames[f]],a,f));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}})();function tG(n,e){if(e.bookType=="fods")return CO(n,e);var t=HR(),r="",i=[],s=[];return r="mimetype",qt(t,r,"application/vnd.oasis.opendocument.spreadsheet"),r="content.xml",qt(t,r,CO(n,e)),i.push([r,"text/xml"]),s.push([r,"ContentFile"]),r="styles.xml",qt(t,r,kve(n,e)),i.push([r,"text/xml"]),s.push([r,"StylesFile"]),r="meta.xml",qt(t,r,Dr+mV()),i.push([r,"text/xml"]),s.push([r,"MetadataFile"]),r="manifest.rdf",qt(t,r,zme(s)),i.push([r,"application/rdf+xml"]),r="META-INF/manifest.xml",qt(t,r,Bme(i)),t}function Tv(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}function Mve(n){return typeof TextEncoder<"u"?new TextEncoder().encode(n):Wa(Pp(n))}function Nve(n,e){e:for(var t=0;t<=n.length-e.length;++t){for(var r=0;r<e.length;++r)if(n[t+r]!=e[r])continue e;return!0}return!1}function xu(n){var e=n.reduce(function(i,s){return i+s.length},0),t=new Uint8Array(e),r=0;return n.forEach(function(i){t.set(i,r),r+=i.length}),t}function Lve(n,e,t){var r=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,i=t/Math.pow(10,r-6176);n[e+15]|=r>>7,n[e+14]|=(r&127)<<1;for(var s=0;i>=1;++s,i/=256)n[e+s]=i&255;n[e+15]|=t>=0?0:128}function Mp(n,e){var t=e?e[0]:0,r=n[t]&127;e:if(n[t++]>=128&&(r|=(n[t]&127)<<7,n[t++]<128||(r|=(n[t]&127)<<14,n[t++]<128)||(r|=(n[t]&127)<<21,n[t++]<128)||(r+=(n[t]&127)*Math.pow(2,28),++t,n[t++]<128)||(r+=(n[t]&127)*Math.pow(2,35),++t,n[t++]<128)||(r+=(n[t]&127)*Math.pow(2,42),++t,n[t++]<128)))break e;return e&&(e[0]=t),r}function Nn(n){var e=new Uint8Array(7);e[0]=n&127;var t=1;e:if(n>127){if(e[t-1]|=128,e[t]=n>>7&127,++t,n<=16383||(e[t-1]|=128,e[t]=n>>14&127,++t,n<=2097151)||(e[t-1]|=128,e[t]=n>>21&127,++t,n<=268435455)||(e[t-1]|=128,e[t]=n/256>>>21&127,++t,n<=34359738367)||(e[t-1]|=128,e[t]=n/65536>>>21&127,++t,n<=4398046511103))break e;e[t-1]|=128,e[t]=n/16777216>>>21&127,++t}return e.slice(0,t)}function e0(n){var e=0,t=n[e]&127;e:if(n[e++]>=128){if(t|=(n[e]&127)<<7,n[e++]<128||(t|=(n[e]&127)<<14,n[e++]<128)||(t|=(n[e]&127)<<21,n[e++]<128))break e;t|=(n[e]&127)<<28}return t}function zr(n){for(var e=[],t=[0];t[0]<n.length;){var r=t[0],i=Mp(n,t),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=t[0];n[t[0]++]>=128;);o=n.slice(l,t[0])}break;case 5:a=4,o=n.slice(t[0],t[0]+a),t[0]+=a;break;case 1:a=8,o=n.slice(t[0],t[0]+a),t[0]+=a;break;case 2:a=Mp(n,t),o=n.slice(t[0],t[0]+a),t[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(r))}var u={data:o,type:s};e[i]==null?e[i]=[u]:e[i].push(u)}return e}function gi(n){var e=[];return n.forEach(function(t,r){t.forEach(function(i){i.data&&(e.push(Nn(r*8+i.type)),i.type==2&&e.push(Nn(i.data.length)),e.push(i.data))})}),xu(e)}function Fa(n){for(var e,t=[],r=[0];r[0]<n.length;){var i=Mp(n,r),s=zr(n.slice(r[0],r[0]+i));r[0]+=i;var a={id:e0(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=zr(o.data),u=e0(l[3][0].data);a.messages.push({meta:l,data:n.slice(r[0],r[0]+u)}),r[0]+=u}),(e=s[3])!=null&&e[0]&&(a.merge=e0(s[3][0].data)>>>0>0),t.push(a)}return t}function uf(n){var e=[];return n.forEach(function(t){var r=[];r[1]=[{data:Nn(t.id),type:0}],r[2]=[],t.merge!=null&&(r[3]=[{data:Nn(+!!t.merge),type:0}]);var i=[];t.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:Nn(a.data.length)}],r[2].push({data:gi(a.meta),type:2})});var s=gi(r);e.push(Nn(s.length)),e.push(s),i.forEach(function(a){return e.push(a)})}),xu(e)}function Ove(n,e){if(n!=0)throw new Error("Unexpected Snappy chunk type ".concat(n));for(var t=[0],r=Mp(e,t),i=[];t[0]<e.length;){var s=e[t[0]]&3;if(s==0){var a=e[t[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[t[0]],o>1&&(a|=e[t[0]+1]<<8),o>2&&(a|=e[t[0]+2]<<16),o>3&&(a|=e[t[0]+3]<<24),a>>>=0,a++,t[0]+=o}i.push(e.slice(t[0],t[0]+a)),t[0]+=a;continue}else{var l=0,u=0;if(s==1?(u=(e[t[0]]>>2&7)+4,l=(e[t[0]++]&224)<<3,l|=e[t[0]++]):(u=(e[t[0]++]>>2)+1,s==2?(l=e[t[0]]|e[t[0]+1]<<8,t[0]+=2):(l=(e[t[0]]|e[t[0]+1]<<8|e[t[0]+2]<<16|e[t[0]+3]<<24)>>>0,t[0]+=4)),i=[xu(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(i.push(i[0].slice(-l)),u-=l;u>=i[i.length-1].length;)i.push(i[i.length-1]),u-=i[i.length-1].length;i.push(i[0].slice(-l,-l+u))}}var h=xu(i);if(h.length!=r)throw new Error("Unexpected length: ".concat(h.length," != ").concat(r));return h}function ja(n){for(var e=[],t=0;t<n.length;){var r=n[t++],i=n[t]|n[t+1]<<8|n[t+2]<<16;t+=3,e.push(Ove(r,n.slice(t,t+i))),t+=i}if(t!==n.length)throw new Error("data is not a valid framed stream!");return xu(e)}function hf(n){for(var e=[],t=0;t<n.length;){var r=Math.min(n.length-t,268435455),i=new Uint8Array(4);e.push(i);var s=Nn(r),a=s.length;e.push(s),r<=60?(a++,e.push(new Uint8Array([r-1<<2]))):r<=256?(a+=2,e.push(new Uint8Array([240,r-1&255]))):r<=65536?(a+=3,e.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(a+=4,e.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(a+=5,e.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),e.push(n.slice(t,t+r)),a+=r,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,t+=r}return xu(e)}function BS(n,e){var t=new Uint8Array(32),r=Tv(t),i=12,s=0;switch(t[0]=5,n.t){case"n":t[1]=2,Lve(t,i,n.v),s|=1,i+=16;break;case"b":t[1]=6,r.setFloat64(i,n.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(n.v)==-1)throw new Error("Value ".concat(n.v," missing from SST!"));t[1]=3,r.setUint32(i,e.indexOf(n.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+n.t}return r.setUint32(8,s,!0),t.slice(0,i)}function US(n,e){var t=new Uint8Array(32),r=Tv(t),i=12,s=0;switch(t[0]=3,n.t){case"n":t[2]=2,r.setFloat64(i,n.v,!0),s|=32,i+=8;break;case"b":t[2]=6,r.setFloat64(i,n.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(n.v)==-1)throw new Error("Value ".concat(n.v," missing from SST!"));t[2]=3,r.setUint32(i,e.indexOf(n.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+n.t}return r.setUint32(4,s,!0),t.slice(0,i)}function bc(n){var e=zr(n);return Mp(e[1][0].data)}function Dve(n,e,t){var r,i,s,a;if(!((r=n[6])!=null&&r[0])||!((i=n[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=n[8])==null?void 0:s[0])==null?void 0:a.data)&&e0(n[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,u=Tv(n[7][0].data),h=0,f=[],g=Tv(n[4][0].data),p=0,E=[],x=0;x<e.length;++x){if(e[x]==null){u.setUint16(x*2,65535,!0),g.setUint16(x*2,65535);continue}u.setUint16(x*2,h,!0),g.setUint16(x*2,p,!0);var w,T;switch(typeof e[x]){case"string":w=BS({t:"s",v:e[x]},t),T=US({t:"s",v:e[x]},t);break;case"number":w=BS({t:"n",v:e[x]},t),T=US({t:"n",v:e[x]},t);break;case"boolean":w=BS({t:"b",v:e[x]},t),T=US({t:"b",v:e[x]},t);break;default:throw new Error("Unsupported value "+e[x])}f.push(w),h+=w.length,E.push(T),p+=T.length,++l}for(n[2][0].data=Nn(l);x<n[7][0].data.length/2;++x)u.setUint16(x*2,65535,!0),g.setUint16(x*2,65535,!0);return n[6][0].data=xu(f),n[3][0].data=xu(E),l}function Fve(n,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=n.Sheets[n.SheetNames[0]];n.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=ta(t["!ref"]);r.s.r=r.s.c=0;var i=!1;r.e.c>9&&(i=!0,r.e.c=9),r.e.r>49&&(i=!0,r.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(Lr(r)));var s=Iv(t,{range:r,header:1}),a=["~Sh33tJ5~"];s.forEach(function(ie){return ie.forEach(function(ne){typeof ne=="string"&&a.push(ne)})});var o={},l=[],u=Gn.read(e.numbers,{type:"base64"});u.FileIndex.map(function(ie,ne){return[ie,u.FullPaths[ne]]}).forEach(function(ie){var ne=ie[0],ee=ie[1];if(ne.type==2&&ne.name.match(/\.iwa/)){var fe=ne.content,Oe=ja(fe),Se=Fa(Oe);Se.forEach(function(Fe){l.push(Fe.id),o[Fe.id]={deps:[],location:ee,type:e0(Fe.messages[0].meta[1][0].data)}})}}),l.sort(function(ie,ne){return ie-ne});var h=l.filter(function(ie){return ie>1}).map(function(ie){return[ie,Nn(ie)]});u.FileIndex.map(function(ie,ne){return[ie,u.FullPaths[ne]]}).forEach(function(ie){var ne=ie[0];if(ie[1],!!ne.name.match(/\.iwa/)){var ee=Fa(ja(ne.content));ee.forEach(function(fe){fe.messages.forEach(function(Oe){h.forEach(function(Se){fe.messages.some(function(Fe){return e0(Fe.meta[1][0].data)!=11006&&Nve(Fe.data,Se[1])})&&o[Se[0]].deps.push(fe.id)})})})}});for(var f=Gn.find(u,o[1].location),g=Fa(ja(f.content)),p,E=0;E<g.length;++E){var x=g[E];x.id==1&&(p=x)}var w=bc(zr(p.messages[0].data)[1][0].data);for(f=Gn.find(u,o[w].location),g=Fa(ja(f.content)),E=0;E<g.length;++E)x=g[E],x.id==w&&(p=x);for(w=bc(zr(p.messages[0].data)[2][0].data),f=Gn.find(u,o[w].location),g=Fa(ja(f.content)),E=0;E<g.length;++E)x=g[E],x.id==w&&(p=x);for(w=bc(zr(p.messages[0].data)[2][0].data),f=Gn.find(u,o[w].location),g=Fa(ja(f.content)),E=0;E<g.length;++E)x=g[E],x.id==w&&(p=x);var T=zr(p.messages[0].data);{T[6][0].data=Nn(r.e.r+1),T[7][0].data=Nn(r.e.c+1);var I=bc(T[46][0].data),P=Gn.find(u,o[I].location),N=Fa(ja(P.content));{for(var D=0;D<N.length&&N[D].id!=I;++D);if(N[D].id!=I)throw"Bad ColumnRowUIDMapArchive";var B=zr(N[D].messages[0].data);B[1]=[],B[2]=[],B[3]=[];for(var k=0;k<=r.e.c;++k){var C=[];C[1]=C[2]=[{type:0,data:Nn(k+420690)}],B[1].push({type:2,data:gi(C)}),B[2].push({type:0,data:Nn(k)}),B[3].push({type:0,data:Nn(k)})}B[4]=[],B[5]=[],B[6]=[];for(var M=0;M<=r.e.r;++M)C=[],C[1]=C[2]=[{type:0,data:Nn(M+726270)}],B[4].push({type:2,data:gi(C)}),B[5].push({type:0,data:Nn(M)}),B[6].push({type:0,data:Nn(M)});N[D].messages[0].data=gi(B)}P.content=hf(uf(N)),P.size=P.content.length,delete T[46];var j=zr(T[4][0].data);{j[7][0].data=Nn(r.e.r+1);var O=zr(j[1][0].data),W=bc(O[2][0].data);P=Gn.find(u,o[W].location),N=Fa(ja(P.content));{if(N[0].id!=W)throw"Bad HeaderStorageBucket";var F=zr(N[0].messages[0].data);for(M=0;M<s.length;++M){var Te=zr(F[2][0].data);Te[1][0].data=Nn(M),Te[4][0].data=Nn(s[M].length),F[2][M]={type:F[2][0].type,data:gi(Te)}}N[0].messages[0].data=gi(F)}P.content=hf(uf(N)),P.size=P.content.length;var Me=bc(j[2][0].data);P=Gn.find(u,o[Me].location),N=Fa(ja(P.content));{if(N[0].id!=Me)throw"Bad HeaderStorageBucket";for(F=zr(N[0].messages[0].data),k=0;k<=r.e.c;++k)Te=zr(F[2][0].data),Te[1][0].data=Nn(k),Te[4][0].data=Nn(r.e.r+1),F[2][k]={type:F[2][0].type,data:gi(Te)};N[0].messages[0].data=gi(F)}P.content=hf(uf(N)),P.size=P.content.length;var Le=bc(j[4][0].data);(function(){for(var ie=Gn.find(u,o[Le].location),ne=Fa(ja(ie.content)),ee,fe=0;fe<ne.length;++fe){var Oe=ne[fe];Oe.id==Le&&(ee=Oe)}var Se=zr(ee.messages[0].data);{Se[3]=[];var Fe=[];a.forEach(function(gt,yt){Fe[1]=[{type:0,data:Nn(yt)}],Fe[2]=[{type:0,data:Nn(1)}],Fe[3]=[{type:2,data:Mve(gt)}],Se[3].push({type:2,data:gi(Fe)})})}ee.messages[0].data=gi(Se);var je=uf(ne),Qe=hf(je);ie.content=Qe,ie.size=ie.content.length})();var Re=zr(j[3][0].data);{var ue=Re[1][0];delete Re[2];var be=zr(ue.data);{var ce=bc(be[2][0].data);(function(){for(var ie=Gn.find(u,o[ce].location),ne=Fa(ja(ie.content)),ee,fe=0;fe<ne.length;++fe){var Oe=ne[fe];Oe.id==ce&&(ee=Oe)}var Se=zr(ee.messages[0].data);{delete Se[6],delete Re[7];var Fe=new Uint8Array(Se[5][0].data);Se[5]=[];for(var je=0,Qe=0;Qe<=r.e.r;++Qe){var gt=zr(Fe);je+=Dve(gt,s[Qe],a),gt[1][0].data=Nn(Qe),Se[5].push({data:gi(gt),type:2})}Se[1]=[{type:0,data:Nn(r.e.c+1)}],Se[2]=[{type:0,data:Nn(r.e.r+1)}],Se[3]=[{type:0,data:Nn(je)}],Se[4]=[{type:0,data:Nn(r.e.r+1)}]}ee.messages[0].data=gi(Se);var yt=uf(ne),Lt=hf(yt);ie.content=Lt,ie.size=ie.content.length})()}ue.data=gi(be)}j[3][0].data=gi(Re)}T[4][0].data=gi(j)}p.messages[0].data=gi(T);var te=uf(g),V=hf(te);return f.content=V,f.size=f.content.length,u}function jve(n){return function(t){for(var r=0;r!=n.length;++r){var i=n[r];t[i[0]]===void 0&&(t[i[0]]=i[1]),i[2]==="n"&&(t[i[0]]=Number(t[i[0]]))}}}function lC(n){jve([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(n)}function Vve(n,e){return e.bookType=="ods"?tG(n,e):e.bookType=="numbers"?Fve(n,e):e.bookType=="xlsb"?Gve(n,e):Bve(n,e)}function Gve(n,e){Df=1024,n&&!n.SSF&&(n.SSF=Is(_r)),n&&n.SSF&&(BE(),GE(n.SSF),e.revssf=UE(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Gm?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t=e.bookType=="xlsb"?"bin":"xml",r=FV.indexOf(e.bookType)>-1,i=dV();lC(e=e||{});var s=HR(),a="",o=0;if(e.cellXfs=[],bu(e.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),a="docProps/core.xml",qt(s,a,pV(n.Props,e)),i.coreprops.push(a),Ln(e.rels,2,a,pn.CORE_PROPS),a="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var l=[],u=0;u<n.SheetNames.length;++u)(n.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(n.SheetNames[u]);n.Props.SheetNames=l}for(n.Props.Worksheets=n.Props.SheetNames.length,qt(s,a,_V(n.Props)),i.extprops.push(a),Ln(e.rels,3,a,pn.EXT_PROPS),n.Custprops!==n.Props&&Ii(n.Custprops||{}).length>0&&(a="docProps/custom.xml",qt(s,a,xV(n.Custprops)),i.custprops.push(a),Ln(e.rels,4,a,pn.CUST_PROPS)),o=1;o<=n.SheetNames.length;++o){var h={"!id":{}},f=n.Sheets[n.SheetNames[o-1]],g=(f||{})["!type"]||"sheet";switch(g){case"chart":default:a="xl/worksheets/sheet"+o+"."+t,qt(s,a,zxe(o-1,a,e,n,h)),i.sheets.push(a),Ln(e.wbrels,-1,"worksheets/sheet"+o+"."+t,pn.WS[0])}if(f){var p=f["!comments"],E=!1,x="";p&&p.length>0&&(x="xl/comments"+o+"."+t,qt(s,x,Hxe(p,x)),i.comments.push(x),Ln(h,-1,"../comments"+o+"."+t,pn.CMNT),E=!0),f["!legacy"]&&E&&qt(s,"xl/drawings/vmlDrawing"+o+".vml",OV(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}h["!id"].rId1&&qt(s,gV(a),Qf(h))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+t,qt(s,a,Wxe(e.Strings,a,e)),i.strs.push(a),Ln(e.wbrels,-1,"sharedStrings."+t,pn.SST)),a="xl/workbook."+t,qt(s,a,Uxe(n,a)),i.workbooks.push(a),Ln(e.rels,1,a,pn.WB),a="xl/theme/theme1.xml",qt(s,a,NV(n.Themes,e)),i.themes.push(a),Ln(e.wbrels,-1,"theme/theme1.xml",pn.THEME),a="xl/styles."+t,qt(s,a,$xe(n,a,e)),i.styles.push(a),Ln(e.wbrels,-1,"styles."+t,pn.STY),n.vbaraw&&r&&(a="xl/vbaProject.bin",qt(s,a,n.vbaraw),i.vba.push(a),Ln(e.wbrels,-1,"vbaProject.bin",pn.VBA)),a="xl/metadata."+t,qt(s,a,Kxe(a)),i.metadata.push(a),Ln(e.wbrels,-1,"metadata."+t,pn.XLMETA),qt(s,"[Content_Types].xml",fV(i,e)),qt(s,"_rels/.rels",Qf(e.rels)),qt(s,"xl/_rels/workbook."+t+".rels",Qf(e.wbrels)),delete e.revssf,delete e.ssf,s}function Bve(n,e){Df=1024,n&&!n.SSF&&(n.SSF=Is(_r)),n&&n.SSF&&(BE(),GE(n.SSF),e.revssf=UE(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Gm?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t="xml",r=FV.indexOf(e.bookType)>-1,i=dV();lC(e=e||{});var s=HR(),a="",o=0;if(e.cellXfs=[],bu(e.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),a="docProps/core.xml",qt(s,a,pV(n.Props,e)),i.coreprops.push(a),Ln(e.rels,2,a,pn.CORE_PROPS),a="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var l=[],u=0;u<n.SheetNames.length;++u)(n.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(n.SheetNames[u]);n.Props.SheetNames=l}n.Props.Worksheets=n.Props.SheetNames.length,qt(s,a,_V(n.Props)),i.extprops.push(a),Ln(e.rels,3,a,pn.EXT_PROPS),n.Custprops!==n.Props&&Ii(n.Custprops||{}).length>0&&(a="docProps/custom.xml",qt(s,a,xV(n.Custprops)),i.custprops.push(a),Ln(e.rels,4,a,pn.CUST_PROPS));var h=["SheetJ5"];for(e.tcid=0,o=1;o<=n.SheetNames.length;++o){var f={"!id":{}},g=n.Sheets[n.SheetNames[o-1]],p=(g||{})["!type"]||"sheet";switch(p){case"chart":default:a="xl/worksheets/sheet"+o+"."+t,qt(s,a,HV(o-1,e,n,f)),i.sheets.push(a),Ln(e.wbrels,-1,"worksheets/sheet"+o+"."+t,pn.WS[0])}if(g){var E=g["!comments"],x=!1,w="";if(E&&E.length>0){var T=!1;E.forEach(function(I){I[1].forEach(function(P){P.T==!0&&(T=!0)})}),T&&(w="xl/threadedComments/threadedComment"+o+"."+t,qt(s,w,_1e(E,h,e)),i.threadedcomments.push(w),Ln(f,-1,"../threadedComments/threadedComment"+o+"."+t,pn.TCMNT)),w="xl/comments"+o+"."+t,qt(s,w,DV(E)),i.comments.push(w),Ln(f,-1,"../comments"+o+"."+t,pn.CMNT),x=!0}g["!legacy"]&&x&&qt(s,"xl/drawings/vmlDrawing"+o+".vml",OV(o,g["!comments"])),delete g["!comments"],delete g["!legacy"]}f["!id"].rId1&&qt(s,gV(a),Qf(f))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+t,qt(s,a,bV(e.Strings,e)),i.strs.push(a),Ln(e.wbrels,-1,"sharedStrings."+t,pn.SST)),a="xl/workbook."+t,qt(s,a,XV(n)),i.workbooks.push(a),Ln(e.rels,1,a,pn.WB),a="xl/theme/theme1.xml",qt(s,a,NV(n.Themes,e)),i.themes.push(a),Ln(e.wbrels,-1,"theme/theme1.xml",pn.THEME),a="xl/styles."+t,qt(s,a,kV(n,e)),i.styles.push(a),Ln(e.wbrels,-1,"styles."+t,pn.STY),n.vbaraw&&r&&(a="xl/vbaProject.bin",qt(s,a,n.vbaraw),i.vba.push(a),Ln(e.wbrels,-1,"vbaProject.bin",pn.VBA)),a="xl/metadata."+t,qt(s,a,LV()),i.metadata.push(a),Ln(e.wbrels,-1,"metadata."+t,pn.XLMETA),h.length>1&&(a="xl/persons/person.xml",qt(s,a,x1e(h)),i.people.push(a),Ln(e.wbrels,-1,"persons/person.xml",pn.PEOPLE)),qt(s,"[Content_Types].xml",fV(i,e)),qt(s,"_rels/.rels",Qf(e.rels)),qt(s,"xl/_rels/workbook."+t+".rels",Qf(e.wbrels)),delete e.revssf,delete e.ssf,s}function Uve(n,e){var t="";switch((e||{}).type||"base64"){case"buffer":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];case"base64":t=Ul(n.slice(0,12));break;case"binary":t=n;break;case"array":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function nG(n,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return C1(e.file,Gn.write(n,{type:En?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Gn.write(n,e)}function zve(n,e){var t=Is(e||{}),r=Vve(n,t);return $ve(r,t)}function $ve(n,e){var t={},r=En?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(t.compression="DEFLATE"),e.password)t.type=r;else switch(e.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":t.type=r;break;default:throw new Error("Unrecognized type "+e.type)}var i=n.FullPaths?Gn.write(n,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!e.compression}):n.generate(t);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(VE(i))}return e.password&&typeof encrypt_agile<"u"?nG(encrypt_agile(i,e.password),e):e.type==="file"?C1(e.file,i):e.type=="string"?Dm(i):i}function Wve(n,e){var t=e||{},r=ove(n,t);return nG(r,t)}function Io(n,e,t){t||(t="");var r=t+n;switch(e.type){case"base64":return Rp(Pp(r));case"binary":return Pp(r);case"string":return n;case"file":return C1(e.file,r,"utf8");case"buffer":return En?Xl(r,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(r):Io(r,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Hve(n,e){switch(e.type){case"base64":return Rp(n);case"binary":return n;case"string":return n;case"file":return C1(e.file,n,"binary");case"buffer":return En?Xl(n,"binary"):n.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function v_(n,e){switch(e.type){case"string":case"base64":case"binary":for(var t="",r=0;r<n.length;++r)t+=String.fromCharCode(n[r]);return e.type=="base64"?Rp(t):e.type=="string"?Dm(t):t;case"file":return C1(e.file,n);case"buffer":return n;default:throw new Error("Unrecognized type "+e.type)}}function rG(n,e){vge(),kxe(n);var t=Is(e||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var r=rG(n,t);return t.type="array",VE(r)}var i=0;if(t.sheet&&(typeof t.sheet=="number"?i=t.sheet:i=n.SheetNames.indexOf(t.sheet),!n.SheetNames[i]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return Io(sve(n,t),t);case"slk":case"sylk":return Io(Rpe.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"htm":case"html":return Io(QV(n.Sheets[n.SheetNames[i]],t),t);case"txt":return Hve(iG(n.Sheets[n.SheetNames[i]],t),t);case"csv":return Io(cC(n.Sheets[n.SheetNames[i]],t),t,"\uFEFF");case"dif":return Io(Cpe.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"dbf":return v_(bpe.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"prn":return Io(Ppe.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"rtf":return Io(Fpe.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"eth":return Io(AV.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"fods":return Io(tG(n,t),t);case"wk1":return v_(wO.sheet_to_wk1(n.Sheets[n.SheetNames[i]],t),t);case"wk3":return v_(wO.book_to_wk3(n,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),v_(ZV(n,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),Wve(n,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return zve(n,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function Kve(n){if(!n.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=n.file.slice(n.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(n.bookType=t.slice(1)),n.bookType=e[n.bookType]||n.bookType}}function Yve(n,e,t){var r={};return r.type="file",r.file=e,Kve(r),rG(n,r)}function Xve(n,e,t,r,i,s,a,o){var l=Si(t),u=o.defval,h=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,g=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(g,"__rowNum__",{value:t,enumerable:!1})}catch{g.__rowNum__=t}else g.__rowNum__=t;if(!a||n[t])for(var p=e.s.c;p<=e.e.c;++p){var E=a?n[t][p]:n[r[p]+l];if(E===void 0||E.t===void 0){if(u===void 0)continue;s[p]!=null&&(g[s[p]]=u);continue}var x=E.v;switch(E.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+E.t)}if(s[p]!=null){if(x==null)if(E.t=="e"&&x===null)g[s[p]]=null;else if(u!==void 0)g[s[p]]=u;else if(h&&x===null)g[s[p]]=null;else continue;else g[s[p]]=h&&(E.t!=="n"||E.t==="n"&&o.rawNumbers!==!1)?x:zl(E,x,o);x!=null&&(f=!1)}}return{row:g,isempty:f}}function Iv(n,e){if(n==null||n["!ref"]==null)return[];var t={t:"n",v:0},r=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},u=e||{},h=u.range!=null?u.range:n["!ref"];switch(u.header===1?r=1:u.header==="A"?r=2:Array.isArray(u.header)?r=3:u.header==null&&(r=0),typeof h){case"string":l=Zn(h);break;case"number":l=Zn(n["!ref"]),l.s.r=h;break;default:l=h}r>0&&(i=0);var f=Si(l.s.r),g=[],p=[],E=0,x=0,w=Array.isArray(n),T=l.s.r,I=0,P={};w&&!n[T]&&(n[T]=[]);var N=u.skipHidden&&n["!cols"]||[],D=u.skipHidden&&n["!rows"]||[];for(I=l.s.c;I<=l.e.c;++I)if(!(N[I]||{}).hidden)switch(g[I]=Ui(I),t=w?n[T][I]:n[g[I]+f],r){case 1:s[I]=I-l.s.c;break;case 2:s[I]=g[I];break;case 3:s[I]=u.header[I-l.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),o=a=zl(t,null,u),x=P[a]||0,!x)P[a]=1;else{do o=a+"_"+x++;while(P[o]);P[a]=x,P[o]=1}s[I]=o}for(T=l.s.r+i;T<=l.e.r;++T)if(!(D[T]||{}).hidden){var B=Xve(n,l,T,g,r,s,w,u);(B.isempty===!1||(r===1?u.blankrows!==!1:u.blankrows))&&(p[E++]=B.row)}return p.length=E,p}var PO=/"/g;function qve(n,e,t,r,i,s,a,o){for(var l=!0,u=[],h="",f=Si(t),g=e.s.c;g<=e.e.c;++g)if(r[g]){var p=o.dense?(n[t]||[])[g]:n[r[g]+f];if(p==null)h="";else if(p.v!=null){l=!1,h=""+(o.rawNumbers&&p.t=="n"?p.v:zl(p,null,o));for(var E=0,x=0;E!==h.length;++E)if((x=h.charCodeAt(E))===i||x===s||x===34||o.forceQuotes){h='"'+h.replace(PO,'""')+'"';break}h=="ID"&&(h='"ID"')}else p.f!=null&&!p.F?(l=!1,h="="+p.f,h.indexOf(",")>=0&&(h='"'+h.replace(PO,'""')+'"')):h="";u.push(h)}return o.blankrows===!1&&l?null:u.join(a)}function cC(n,e){var t=[],r=e??{};if(n==null||n["!ref"]==null)return"";var i=Zn(n["!ref"]),s=r.FS!==void 0?r.FS:",",a=s.charCodeAt(0),o=r.RS!==void 0?r.RS:`
`,l=o.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),h="",f=[];r.dense=Array.isArray(n);for(var g=r.skipHidden&&n["!cols"]||[],p=r.skipHidden&&n["!rows"]||[],E=i.s.c;E<=i.e.c;++E)(g[E]||{}).hidden||(f[E]=Ui(E));for(var x=0,w=i.s.r;w<=i.e.r;++w)(p[w]||{}).hidden||(h=qve(n,i,w,f,a,l,s,r),h!=null&&(r.strip&&(h=h.replace(u,"")),(h||r.blankrows!==!1)&&t.push((x++?o:"")+h)));return delete r.dense,t.join("")}function iG(n,e){e||(e={}),e.FS="	",e.RS=`
`;var t=cC(n,e);return t}function Zve(n){var e="",t,r="";if(n==null||n["!ref"]==null)return[];var i=Zn(n["!ref"]),s="",a=[],o,l=[],u=Array.isArray(n);for(o=i.s.c;o<=i.e.c;++o)a[o]=Ui(o);for(var h=i.s.r;h<=i.e.r;++h)for(s=Si(h),o=i.s.c;o<=i.e.c;++o)if(e=a[o]+s,t=u?(n[h]||[])[o]:n[e],r="",t!==void 0){if(t.F!=null){if(e=t.F,!t.f)continue;r=t.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(t.f!=null)r=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)r=""+t.v;else if(t.t=="b")r=t.v?"TRUE":"FALSE";else if(t.w!==void 0)r="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?r="'"+t.v:r=""+t.v}}l[l.length]=e+"="+r}return l}function sG(n,e,t){var r=t||{},i=+!r.skipHeader,s=n||{},a=0,o=0;if(s&&r.origin!=null)if(typeof r.origin=="number")a=r.origin;else{var l=typeof r.origin=="string"?si(r.origin):r.origin;a=l.r,o=l.c}var u,h={s:{c:0,r:0},e:{c:o,r:a+e.length-1+i}};if(s["!ref"]){var f=Zn(s["!ref"]);h.e.c=Math.max(h.e.c,f.e.c),h.e.r=Math.max(h.e.r,f.e.r),a==-1&&(a=f.e.r+1,h.e.r=a+e.length-1+i)}else a==-1&&(a=0,h.e.r=e.length-1+i);var g=r.header||[],p=0;e.forEach(function(x,w){Ii(x).forEach(function(T){(p=g.indexOf(T))==-1&&(g[p=g.length]=T);var I=x[T],P="z",N="",D=Vn({c:o+p,r:a+w+i});u=Np(s,D),I&&typeof I=="object"&&!(I instanceof Date)?s[D]=I:(typeof I=="number"?P="n":typeof I=="boolean"?P="b":typeof I=="string"?P="s":I instanceof Date?(P="d",r.cellDates||(P="n",I=Ts(I)),N=r.dateNF||_r[14]):I===null&&r.nullError&&(P="e",I=0),u?(u.t=P,u.v=I,delete u.w,delete u.R,N&&(u.z=N)):s[D]=u={t:P,v:I},N&&(u.z=N))})}),h.e.c=Math.max(h.e.c,o+g.length-1);var E=Si(a);if(i)for(p=0;p<g.length;++p)s[Ui(p+o)+E]={t:"s",v:g[p]};return s["!ref"]=Lr(h),s}function Qve(n,e){return sG(null,n,e)}function Np(n,e,t){if(typeof e=="string"){if(Array.isArray(n)){var r=si(e);return n[r.r]||(n[r.r]=[]),n[r.r][r.c]||(n[r.r][r.c]={t:"z"})}return n[e]||(n[e]={t:"z"})}return typeof e!="number"?Np(n,Vn(e)):Np(n,Vn({r:e,c:t||0}))}function Jve(n,e){if(typeof e=="number"){if(e>=0&&n.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var t=n.SheetNames.indexOf(e);if(t>-1)return t;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function eEe(){return{SheetNames:[],Sheets:{}}}function tEe(n,e,t,r){var i=1;if(!t)for(;i<=65535&&n.SheetNames.indexOf(t="Sheet"+i)!=-1;++i,t=void 0);if(!t||n.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&n.SheetNames.indexOf(t)>=0){var s=t.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||t;for(++i;i<=65535&&n.SheetNames.indexOf(t=a+i)!=-1;++i);}if(YV(t),n.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return n.SheetNames.push(t),n.Sheets[t]=e,t}function nEe(n,e,t){n.Workbook||(n.Workbook={}),n.Workbook.Sheets||(n.Workbook.Sheets=[]);var r=Jve(n,e);switch(n.Workbook.Sheets[r]||(n.Workbook.Sheets[r]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}n.Workbook.Sheets[r].Hidden=t}function rEe(n,e){return n.z=e,n}function aG(n,e,t){return e?(n.l={Target:e},t&&(n.l.Tooltip=t)):delete n.l,n}function iEe(n,e,t){return aG(n,"#"+e,t)}function sEe(n,e,t){n.c||(n.c=[]),n.c.push({t:e,a:t||"SheetJS"})}function aEe(n,e,t,r){for(var i=typeof e!="string"?e:Zn(e),s=typeof e=="string"?e:Lr(e),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=Np(n,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=t,r&&(l.D=!0))}return n}var zS={encode_col:Ui,encode_row:Si,encode_cell:Vn,encode_range:Lr,decode_col:QR,decode_row:ZR,split_cell:vme,decode_cell:si,decode_range:ta,format_cell:zl,sheet_add_aoa:aV,sheet_add_json:sG,sheet_add_dom:JV,aoa_to_sheet:W0,json_to_sheet:Qve,table_to_sheet:eG,table_to_book:Cve,sheet_to_csv:cC,sheet_to_txt:iG,sheet_to_json:Iv,sheet_to_html:QV,sheet_to_formulae:Zve,sheet_to_row_object_array:Iv,sheet_get_cell:Np,book_new:eEe,book_append_sheet:tEe,book_set_sheet_visibility:nEe,cell_set_number_format:rEe,cell_set_hyperlink:aG,cell_set_internal_link:iEe,cell_add_comment:sEe,sheet_set_array_formula:aEe,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Ol=Ia()(j0((n,e)=>({vondsten:[],addVondst:t=>n(r=>({vondsten:[...r.vondsten,{...t,id:crypto.randomUUID(),timestamp:new Date().toISOString()}]})),removeVondst:t=>n(r=>({vondsten:r.vondsten.filter(i=>i.id!==t)})),updateVondst:(t,r)=>n(i=>({vondsten:i.vondsten.map(s=>s.id===t?{...s,...r}:s)})),clearAll:()=>n({vondsten:[]}),exportAsGeoJSON:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const r={type:"FeatureCollection",features:t.map(o=>({type:"Feature",geometry:{type:"Point",coordinates:[o.location.lng,o.location.lat]},properties:{id:o.id,objectType:o.objectType,material:o.material,period:o.period,depth:o.depth,notes:o.notes,timestamp:o.timestamp,photoUrl:o.photoUrl,condition:o.condition,weight:o.weight,length:o.length}}))},i=new Blob([JSON.stringify(r,null,2)],{type:"application/json"}),s=URL.createObjectURL(i),a=document.createElement("a");a.href=s,a.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.geojson`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(s)},exportAsCSV:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const r=`ID,Latitude,Longitude,Datum,Type,Materiaal,Periode,Diepte (cm),Conditie,Gewicht (g),Lengte (mm),Notities,Foto URL
`,i=t.map(u=>{const h=new Date(u.timestamp).toLocaleDateString("nl-NL"),f=u.notes?`"${u.notes.replace(/"/g,'""')}"`:"";return`${u.id},${u.location.lat},${u.location.lng},${h},${u.objectType},${u.material},${u.period},${u.depth||""},${u.condition||""},${u.weight||""},${u.length||""},${f},${u.photoUrl||""}`}).join(`
`),s=r+i,a=new Blob([s],{type:"text/csv;charset=utf-8;"}),o=URL.createObjectURL(a),l=document.createElement("a");l.href=o,l.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(o)},exportAsExcel:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const r=t.map(o=>({ID:o.id,Latitude:o.location.lat,Longitude:o.location.lng,Datum:new Date(o.timestamp).toLocaleDateString("nl-NL"),Type:o.objectType,Materiaal:o.material,Periode:o.period,"Diepte (cm)":o.depth||"",Conditie:o.condition||"","Gewicht (g)":o.weight||"","Lengte (mm)":o.length||"",Notities:o.notes||"","Foto URL":o.photoUrl||""})),i=zS.json_to_sheet(r),s=zS.book_new();zS.book_append_sheet(s,i,"Vondsten");const a=[{wch:36},{wch:12},{wch:12},{wch:12},{wch:15},{wch:12},{wch:25},{wch:12},{wch:12},{wch:12},{wch:12},{wch:40},{wch:50}];i["!cols"]=a,Yve(s,`mijn-vondsten-${new Date().toISOString().split("T")[0]}.xlsx`)},exportAsGPX:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const r=t.map(l=>{const u=new Date(l.timestamp).toISOString();return`  <wpt lat="${l.location.lat}" lon="${l.location.lng}">
    <name>${l.objectType} - ${l.material}</name>
    <desc>${l.period}${l.depth?`, ${l.depth}cm diep`:""}${l.condition&&l.condition!=="Onbekend"?`, ${l.condition}`:""}${l.weight?`, ${l.weight}g`:""}${l.length?`, ${l.length}mm`:""}${l.notes?`. ${l.notes}`:""}</desc>
    <time>${u}</time>
    <sym>Pin</sym>
  </wpt>`}).join(`
`),i=`<?xml version="1.0" encoding="UTF-8"?>
<gpx version="1.1" creator="DetectorApp NL" xmlns="http://www.topografix.com/GPX/1/1">
  <metadata>
    <name>Mijn Vondsten</name>
    <desc>Geexporteerd uit DetectorApp NL</desc>
    <time>${new Date().toISOString()}</time>
  </metadata>
${r}
</gpx>`,s=new Blob([i],{type:"application/gpx+xml"}),a=URL.createObjectURL(s),o=document.createElement("a");o.href=a,o.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.gpx`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(a)},exportAsKML:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const i=`<?xml version="1.0" encoding="UTF-8"?>
<kml xmlns="http://www.opengis.net/kml/2.2">
  <Document>
    <name>Mijn Vondsten</name>
    <description>Geexporteerd uit DetectorApp NL</description>
${t.map(l=>{const u=new Date(l.timestamp).toLocaleDateString("nl-NL"),h=`<![CDATA[
            <b>Type:</b> ${l.objectType}<br/>
            <b>Materiaal:</b> ${l.material}<br/>
            <b>Periode:</b> ${l.period}<br/>
            ${l.depth?`<b>Diepte:</b> ${l.depth} cm<br/>`:""}
            ${l.condition&&l.condition!=="Onbekend"?`<b>Conditie:</b> ${l.condition}<br/>`:""}
            ${l.weight?`<b>Gewicht:</b> ${l.weight} gram<br/>`:""}
            ${l.length?`<b>Lengte:</b> ${l.length} mm<br/>`:""}
            <b>Datum:</b> ${u}<br/>
            ${l.notes?`<b>Notities:</b> ${l.notes}<br/>`:""}
            ${l.photoUrl?`<a href="${l.photoUrl}">Bekijk foto</a>`:""}
          ]]>`;return`    <Placemark>
      <name>${l.objectType} - ${l.material}</name>
      <description>${h}</description>
      <Point>
        <coordinates>${l.location.lng},${l.location.lat},0</coordinates>
      </Point>
    </Placemark>`}).join(`
`)}
  </Document>
</kml>`,s=new Blob([i],{type:"application/vnd.google-earth.kml+xml"}),a=URL.createObjectURL(s),o=document.createElement("a");o.href=a,o.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.kml`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(a)}}),{name:"detectorapp-local-vondsten"}));gn.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs");function oEe(n){if(!n)return n;const e={Mo:"ma",Tu:"di",We:"wo",Th:"do",Fr:"vr",Sa:"za",Su:"zo",Mon:"ma",Tue:"di",Wed:"wo",Thu:"do",Fri:"vr",Sat:"za",Sun:"zo",PH:"feestdagen",SH:"schoolvakantie"};let t=n;return Object.entries(e).forEach(([r,i])=>{t=t.replace(new RegExp(`\\b${r}\\b`,"gi"),i)}),t=t.replace(/\boff\b/gi,"gesloten").replace(/\bclosed\b/gi,"gesloten").replace(/\bopen\b/gi,"open"),t}async function lEe(n){try{const e=fn(n),t=gn("EPSG:4326","EPSG:28992",e);if(t[0]<7e3||t[0]>3e5||t[1]<289e3||t[1]>629e3)return null;const r=1,s=`https://service.pdok.nl/rws/ahn/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=dtm_05m&QUERY_LAYERS=dtm_05m&INFO_FORMAT=application/json&CRS=EPSG:28992&BBOX=${`${t[0]-r},${t[1]-r},${t[0]+r},${t[1]+r}`}&WIDTH=1&HEIGHT=1&I=0&J=0`,o=await(await fetch(s)).json();if(o.features&&o.features.length>0){const l=o.features[0].properties,u=l?.value_list??l?.GRAY_INDEX??l?.value??l?.gray_index;if(u!=null){const h=typeof u=="number"?u:parseFloat(u);if(!isNaN(h))return h}}}catch(e){console.warn("AHN height query failed:",e)}return null}const cEe={ABG:"Alphen-Chaam",ACM:"Alkmaar",ALF:"Alfen",ALK:"Alkemade",AML:"Ameland",AMR:"Amerongen",AMS:"Amsterdam",ANL:"Anloo",APD:"Apeldoorn",ARN:"Arnhem",ASN:"Assen",AVW:"Avenhorn",BDA:"Breda",BLK:"Blokker",BRN:"Barneveld",DEL:"Delft",DHG:"Den Haag",DRD:"Dordrecht",EHV:"Eindhoven",EMN:"Emmen",EPE:"Epe",GNP:"Gennep",GRN:"Groningen",GRV:"Grave",GTB:"Giethoorn",HDK:"Harderwijk",HLM:"Haarlem",HLN:"Heiloo",HRL:"Harlingen",HTN:"Houten",LDN:"Leiden",LWR:"Leeuwarden",MST:"Maastricht",NKK:"Nijkerk",NMG:"Nijmegen",OTM:"Ootmarsum",RTD:"Rotterdam",SND:"Sneek",TBG:"Tilburg",UTR:"Utrecht",VLO:"Venlo",WGN:"Wageningen",ZWL:"Zwolle",ZTP:"Zutphen",444:"Houten",811:"Gouda",310:"Utrecht",344:"Amsterdam",363:"Rotterdam",518:"Den Haag",758:"Eindhoven",772:"Tilburg",855:"Breda",85:"Arnhem",268:"Nijmegen",14:"Groningen",80:"Leeuwarden",995:"Maastricht",106:"Enschede",153:"Zwolle",34:"Almere"},uEe={1:"Zeer lage trefkans op archeologische resten",2:"Lage trefkans op archeologische resten",3:"Middelhoge trefkans op archeologische resten",4:"Hoge trefkans op archeologische resten",5:"Lage trefkans (water)",6:"Middelhoge trefkans (water)",7:"Hoge trefkans (water)",8:"Water",9:"Niet gekarteerd"};function kO(n,e){const t=[],r=n.toLowerCase(),i=(e||"").toLowerCase();return r.includes("kalkhoudend")||i.endsWith("a")?t.push("Kalkhoudend = goede metaalconservering"):(r.includes("kalkarm")||r.includes("kalkloos"))&&t.push("Kalkarm = meer corrosie op metalen"),r.includes("poldervaag")?t.push("Poldervaaggrond = jonge rivierklei, ingepolderd gebied"):r.includes("enkeerdgrond")||r.includes("enk")?t.push("Enkeerdgrond = oude akkers met plaggenbemesting - archeologisch interessant!"):r.includes("podzol")?t.push("Podzolgrond = uitgeloogde zandgrond, vaak zuur"):(r.includes("veengrond")||r.includes("veen"))&&t.push("Veengrond = zuur, slechte metaalconservering (tenzij waterverzadigd)"),r.includes("zware klei")?t.push("Zware klei = moeilijk graven, goede conservering"):r.includes("lichte klei")||r.includes("zavel")?t.push("Zavel/lichte klei = redelijk te graven"):r.includes("zand")&&!r.includes("zavel")&&t.push("Zandgrond = makkelijk graven"),r.includes("rivierklei")||i.startsWith("r")?t.push("Rivierafzetting"):(r.includes("zeeklei")||i.startsWith("m"))&&t.push("Zeekleiafzetting"),t}function hEe(){const n=As(Se=>Se.map),e=Ol(Se=>Se.removeVondst),{layers:t,addPoint:r}=qs(),[i,s]=se.useState([]),[a,o]=se.useState(0),[l,u]=se.useState(!1),[h,f]=se.useState(null),[g,p]=se.useState(!1),[E,x]=se.useState(!1),[w,T]=se.useState(null),[I,P]=se.useState(null),[N,D]=se.useState(!1),[B,k]=se.useState(null),[C,M]=se.useState(null),[j,O]=se.useState(()=>{const Se=localStorage.getItem("popupTextScale");return Se?parseInt(Se):100}),W=Se=>{O(Se),localStorage.setItem("popupTextScale",Se.toString())},F=i[a]||"",Te=i.length>1,Me=Se=>{const Fe=Se.match(/<strong[^>]*>(.*?)<\/strong>/);if(Fe){const je=Fe[1].replace(/<[^>]+>/g,""),Qe=Se.replace(Fe[0],"").replace(/^(<br\s*\/?>)+/,"");return{title:je,contentWithoutTitle:Qe}}return{title:"",contentWithoutTitle:Se}},Le=Se=>Se.replace(/class="([^"]*)"/g,(je,Qe)=>{if(Qe.includes("text-xs")){const gt=Qe.replace(/\btext-xs\b/g,"").trim();return gt?`style="font-size:0.857em" class="${gt}"`:'style="font-size:0.857em"'}if(Qe.includes("text-sm")){const gt=Qe.replace(/\btext-sm\b/g,"").trim();return gt?`class="${gt}"`:""}return je}).replace(/class=""/g,""),{title:Re,contentWithoutTitle:ue}=Me(F),be=Le(ue),ce=F.includes("Landbouwperceel"),te=F.includes("data-vondst-id="),V=()=>{o(Se=>(Se-1+i.length)%i.length)},ie=()=>{o(Se=>(Se+1)%i.length)},ne=async()=>{if(console.log(" HOOGTEKAART KNOP GEKLIKT"),console.log(" parcelCoordinate uit state:",h),!n||!h||E){console.log(" STOP - map:",!!n,"coord:",h,"loading:",E);return}console.log(` DOORGEVEN AAN showParcelHeightMap: [${h[0]}, ${h[1]}]`),x(!0);try{await yge(n,h)&&p(!0)}catch(Se){console.error("Failed to load height map:",Se)}finally{x(!1)}},ee=()=>{n&&(OI(n),p(!1))};se.useEffect(()=>{if(!n)return;const Se=Qe=>{let gt='<strong class="text-purple-800">AMK Monument</strong>';if(Qe.toponiem&&(gt+=`<br/><span class="text-sm font-semibold">${Qe.toponiem}</span>`),Qe.kwaliteitswaarde&&(gt+=`<br/><span class="text-sm text-purple-700">${Qe.kwaliteitswaarde}</span>`),Qe.omschrijving&&(gt+=`<br/><span class="text-xs text-gray-600 mt-1 block">${Qe.omschrijving}</span>`),Qe.txt_label){const yt=Qe.txt_label.split(", ").slice(0,3).join(", ");gt+=`<br/><span class="text-xs text-gray-500 italic">${yt}${Qe.txt_label.split(", ").length>3?"...":""}</span>`}return gt},Fe=async(Qe,gt)=>{const yt=[],Lt=n.getLayers().getArray().filter(nn=>nn instanceof Ju&&nn.getVisible()?nn.getSource()instanceof BW:!1);for(const nn of Lt){const Ut=nn.getSource();if(!Ut)continue;const De=nn.get("title")||"";if(De==="Archeo Landschappen"){try{const Ie=fn(Qe),me=gn("EPSG:4326","EPSG:28992",Ie),R=100,X=`https://services.rce.geovoorziening.nl/landschappenkaart/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=landschappenkaart_nl&QUERY_LAYERS=landschappenkaart_nl&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${me[0]-R},${me[1]-R},${me[0]+R},${me[1]+R}`}`,re=await(await fetch(X)).json();if(re.features&&re.features.length>0){const z=re.features[0].properties,le=z.landschapsnaam||z.naam||"Archeologisch Landschap",$e=z.omschrijving||"";let Ae=`<strong class="text-green-800">${le}</strong>`;$e&&(Ae+=`<br/><span class="text-sm text-gray-600">${$e}</span>`),Ae+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',Ae+='<div class="text-sm text-gray-700 mt-1">Een archeologisch landschap is een gebied waar het landschap nog sporen draagt van menselijke activiteit uit het verleden. Denk aan oude akkers, nederzettingen of verdedigingswerken.</div>',Ae+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',Ae+='<div class="text-sm text-gray-700 mt-1">Aardewerk, munten, gereedschap en andere voorwerpen van vroegere bewoners. De kans op vondsten hangt af van het type landschap.</div>',Ae+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten</span></div>',Ae+='<div class="text-sm text-gray-700 mt-1">Bekijk de Rijksdienst voor het Cultureel Erfgoed (RCE) voor meer informatie over archeologische landschappen.</div>',yt.push(Ae)}}catch(Ie){console.warn("Archeo Landschappen WMS query failed:",Ie)}continue}if(De==="Essen"){try{const Ie=fn(Qe),me=gn("EPSG:4326","EPSG:28992",Ie),R=100,X=`https://services.rce.geovoorziening.nl/landschapsatlas/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=essen&QUERY_LAYERS=essen&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${me[0]-R},${me[1]-R},${me[0]+R},${me[1]+R}`}`,re=await(await fetch(X)).json();if(re.features&&re.features.length>0){const z=re.features[0].properties;let le='<strong class="text-amber-800">Es (historisch akkercomplex)</strong>';(z.naam||z.Naam||z.NAME)&&(le+=`<br/><span class="text-sm font-semibold text-amber-700">${z.naam||z.Naam||z.NAME}</span>`),(z.type||z.Type||z.TYPE)&&(le+=`<br/><span class="text-xs text-gray-600">${z.type||z.Type||z.TYPE}</span>`),(z.omschrijving||z.Omschrijving)&&(le+=`<br/><span class="text-xs text-gray-500">${z.omschrijving||z.Omschrijving}</span>`),yt.push(le)}}catch(Ie){console.warn("Essen WMS query failed:",Ie)}continue}if(De==="FAMKE Steentijd"){try{const Ie=fn(Qe),me=gn("EPSG:4326","EPSG:28992",Ie),R=100,X=`https://geoportaal.fryslan.nl/arcgis/services/Themas/cultuurhistorie/MapServer/WMSServer?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=FAMKE_Advies_steentijd-bronstijd3339&QUERY_LAYERS=FAMKE_Advies_steentijd-bronstijd3339&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${me[0]-R},${me[1]-R},${me[0]+R},${me[1]+R}`}`,re=await(await fetch(X)).json();if(re.features&&re.features.length>0){const z=re.features[0].properties;let le='<strong class="text-amber-800">FAMKE Steentijd-Bronstijd</strong>';le+='<br/><span class="text-sm text-gray-500">Friese verwachtingskaart voor oude vondsten</span>';const $e=z.advies||z.Advies||"";if($e){le+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat betekent dit?</span></div>',le+=`<div class="text-sm text-amber-700 mt-1">${$e}</div>`;const Ae=$e.toLowerCase();let Ze="",ht="text-gray-600",vt="";Ae.includes("karterend")?(Ze="Op deze plek verwachten archeologen vondsten uit de steentijd of bronstijd. Bij graafwerk moet er eerst onderzoek komen.",vt="Goede kans op oude vondsten (vuursteen, bijlen, aardewerk)",ht="text-amber-600"):Ae.includes("waarderend")?(Ze="Hier zijn mogelijk belangrijke vindplaatsen. Proefsleuven zijn nodig om te kijken wat er precies zit.",vt="Mogelijk interessante vondsten uit de prehistorie",ht="text-orange-600"):Ae.includes("geen")?(Ze="De kans op prehistorische vondsten is hier klein. De grond is waarschijnlijk te jong of te veel verstoord.",vt="Weinig kans op steentijd-vondsten",ht="text-green-600"):Ae.includes("quickscan")&&(Ze="Hier is eerst bureau-onderzoek nodig. Er kunnen vondsten zitten, maar dat is nog niet zeker.",vt="Onbekend, nader onderzoek nodig",ht="text-blue-600"),Ze&&(le+=`<div class="text-sm ${ht} mt-1">${Ze}</div>`),vt&&(le+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',le+=`<div class="text-sm text-gray-700 mt-1">${vt}</div>`),le+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is FAMKE?</span></div>',le+='<div class="text-sm text-gray-700 mt-1">FAMKE is de Friese Archeologische Monumentenkaart Extra. Deze kaart toont waar in Friesland vondsten uit de steentijd en bronstijd te verwachten zijn.</div>'}yt.push(le)}}catch(Ie){console.warn("FAMKE WMS query failed:",Ie)}continue}if(De==="Archeo Onderzoeken"){try{const Ie=fn(Qe),me=gn("EPSG:4326","EPSG:28992",Ie),R=100,X=`https://data.geo.cultureelerfgoed.nl/openbaar/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=archeologische_onderzoeksmeldingen_openbaar_rd&QUERY_LAYERS=archeologische_onderzoeksmeldingen_openbaar_rd&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${me[0]-R},${me[1]-R},${me[0]+R},${me[1]+R}`}`,re=await(await fetch(X)).json();if(re.features&&re.features.length>0){const z=re.features[0].properties;let le='<strong class="text-blue-800">Archeologisch Onderzoek</strong>';if(z.type_onderzoek&&(le+=`<br/><span class="text-sm font-semibold">${z.type_onderzoek}</span>`),z.onderzoeksmeldingnummer&&(le+=`<br/><span class="text-xs text-gray-500">Melding: ${z.onderzoeksmeldingnummer}</span>`),z.uitvoerder&&(le+=`<br/><span class="text-sm text-gray-700">Uitvoerder: ${z.uitvoerder}</span>`),z.startdatum||z.einddatum){const $e=[z.startdatum,z.einddatum].filter(Boolean).join(" - ");le+=`<br/><span class="text-xs text-gray-600">Periode: ${$e}</span>`}if(z.gemeente&&(le+=`<br/><span class="text-xs text-gray-500">${z.gemeente}</span>`),z.type_uri){const $e=z.type_uri.replace("type_uri:","").trim();$e.startsWith("http")&&(le+=`<br/><a href="${$e}" target="_blank" rel="noopener noreferrer" class="text-xs text-blue-600 hover:underline">Meer informatie</a>`)}for(const[$e,Ae]of Object.entries(z))if($e.toLowerCase().includes("uri")&&typeof Ae=="string"&&$e!=="type_uri"){const Ze=Ae.replace(/^[a-z_]+:/i,"").trim();Ze.startsWith("http")&&(le+=`<br/><a href="${Ze}" target="_blank" rel="noopener noreferrer" class="text-xs text-blue-600 hover:underline">${$e.replace("_uri","")}</a>`)}yt.push(le)}}catch(Ie){console.warn("Archeo Onderzoeken WMS query failed:",Ie)}continue}if(De==="IKAW"){try{const Ie=fn(Qe),me=gn("EPSG:4326","EPSG:28992",Ie),R=500,X=`https://services.rce.geovoorziening.nl/ikaw/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=IKAW3Indicatievekaartarcheologischewaarden2008&QUERY_LAYERS=IKAW3Indicatievekaartarcheologischewaarden2008&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${me[0]-R},${me[1]-R},${me[0]+R},${me[1]+R}`}`,re=await(await fetch(X)).json();if(re.features&&re.features.length>0){const z=re.features[0].properties,le=Math.round(z.PALETTE_INDEX||z.palette_index||0),$e=uEe[le]||`Trefkans onbekend (${le})`;let Ae='<strong class="text-orange-800">IKAW Verwachtingskaart</strong>';Ae+='<br/><span class="text-sm text-gray-500">Kaart met kansen op archeologische vondsten</span>',Ae+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat betekent dit?</span></div>',Ae+=`<div class="text-sm text-orange-700 mt-1">${$e}</div>`;const ht={1:{tekst:"De kans op archeologische vondsten is hier zeer klein. De grond is waarschijnlijk verstoord of te jong.",vondsten:"Niet veel te verwachten, maar verrassingen zijn altijd mogelijk.",kleur:"text-gray-600"},2:{tekst:"De kans op vondsten is laag, maar niet uitgesloten. Soms worden hier toch interessante objecten gevonden.",vondsten:"Af en toe losse vondsten uit verschillende periodes.",kleur:"text-yellow-600"},3:{tekst:"Dit is een interessant gebied met een redelijke kans op vondsten. Hier woonden of werkten mensen in het verleden.",vondsten:"Aardewerk, munten, metalen voorwerpen uit verschillende tijdperken.",kleur:"text-amber-600"},4:{tekst:"Dit is een zeer kansrijk gebied! Hier zijn waarschijnlijk resten van oude bewoning of activiteit. Let op: bij graafwerk kan een vergunning nodig zijn.",vondsten:"Grote kans op interessante vondsten: aardewerk, munten, sieraden, gereedschap.",kleur:"text-orange-600"},5:{tekst:"Dit is een waterbodem. Vondsten zijn hier moeilijker te bereiken maar kunnen goed bewaard zijn gebleven.",vondsten:"Scheepswrakken, verloren lading, gedumpte voorwerpen.",kleur:"text-blue-600"},6:{tekst:"Waterbodem met archeologische potentie. Hier kunnen interessante vondsten liggen die door het water goed bewaard zijn.",vondsten:"Scheepsresten, ankers, aardewerk, metalen voorwerpen.",kleur:"text-blue-600"},7:{tekst:"Waterbodem met hoge archeologische waarde. Hier zijn bekende vindplaatsen of scheepswrakken.",vondsten:"Belangrijke maritieme vondsten, beschermd gebied.",kleur:"text-blue-700"}}[le];ht&&(Ae+=`<div class="text-sm ${ht.kleur} mt-1">${ht.tekst}</div>`,Ae+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',Ae+=`<div class="text-sm text-gray-700 mt-1">${ht.vondsten}</div>`),Ae+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is de IKAW?</span></div>',Ae+='<div class="text-sm text-gray-700 mt-1">De IKAW (Indicatieve Kaart Archeologische Waarden) toont de kans op archeologische vondsten in heel Nederland. De kaart is gemaakt door de Rijksdienst voor het Cultureel Erfgoed.</div>',yt.push(Ae)}}catch(Ie){console.warn("IKAW WMS query failed:",Ie)}continue}if(De==="Inundatiegebieden"){try{const Ie=fn(Qe),me=gn("EPSG:4326","EPSG:28992",Ie),R=100,X=`https://services.rce.geovoorziening.nl/liniesenstellingen/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=inundaties&QUERY_LAYERS=inundaties&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${me[0]-R},${me[1]-R},${me[0]+R},${me[1]+R}`}`,re=await(await fetch(X)).json();if(re.features&&re.features.length>0){const z=re.features[0].properties;let le='<strong class="text-blue-800">Inundatiegebied</strong>';(z["linie-naam"]||z.linie_naam)&&(le+=`<br/><span class="text-sm font-semibold text-blue-700">${z["linie-naam"]||z.linie_naam}</span>`),z.naam&&(le+=`<br/><span class="text-sm text-gray-700">${z.naam}</span>`),z.periode&&(le+=`<br/><span class="text-xs text-gray-500">${z.periode}</span>`),z.lin_period&&(le+=`<br/><span class="text-xs text-gray-400">${z.lin_period}</span>`),yt.push(le)}}catch(Ie){console.warn("Inundatiegebieden WMS query failed:",Ie)}continue}if(De==="Militaire Objecten"){try{const Ie=fn(Qe),me=gn("EPSG:4326","EPSG:28992",Ie),R=50,X=`https://services.rce.geovoorziening.nl/liniesenstellingen/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=objecten&QUERY_LAYERS=objecten&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${me[0]-R},${me[1]-R},${me[0]+R},${me[1]+R}`}`,re=await(await fetch(X)).json();if(re.features&&re.features.length>0){const z=re.features[0].properties,le=z.obj_soort||"",$e=z.obj_naam||"",Ae=z.lin_period||"",Ze=z["linie-naam"]||z.linie_naam||"";let ht=le||"Militair Object",vt="Dit is een historisch militair object uit de Nederlandse verdedigingsgeschiedenis.",wt="";const Rt=le.toLowerCase();Rt.includes("fort")?(vt="Een fort is een versterkte verdedigingspost, vaak met dikke muren en geschutsopstellingen. Forten maakten deel uit van grotere verdedigingslinies.",wt="Rond forten worden soms kogels, knopen van uniformen, muntjes of andere militaire voorwerpen gevonden."):Rt.includes("schans")?(vt="Een schans is een kleinere versterking, vaak gemaakt van aarde en palissaden. Schansen werden gebruikt om strategische punten te verdedigen.",wt="Bij schansen kun je musketkogels, knopen en soms munten uit de 17e-18e eeuw tegenkomen."):Rt.includes("batterij")||Rt.includes("battery")?(vt="Een batterij is een geschutsopstelling, vaak op een strategische plek om vijanden onder vuur te nemen.",wt="Bij batterijen worden soms kanonkogels of onderdelen van geschut gevonden."):Rt.includes("bunker")||Rt.includes("kazemat")?(vt="Een bunker of kazemat is een versterkte betonnen schuilplaats. Veel werden gebouwd rond 1940 als onderdeel van verdedigingslinies.",wt="Bij bunkers worden soms militaire voorwerpen uit WOII gevonden, zoals knopen, gespen of munitieresten."):Rt.includes("sluis")||Rt.includes("inlaatwerk")?(vt="Militaire sluizen en inlaatwerken werden gebruikt om land onder water te zetten (inunderen). Dit was een belangrijke verdedigingstactiek.",wt="Bij historische sluizen worden soms voorwerpen gevonden van soldaten die deze bewaakten."):Rt.includes("toren")||Rt.includes("wachttoren")?(vt="Wachttorens werden gebruikt om de omgeving in de gaten te houden en vijandelijke bewegingen te signaleren.",wt="Bij torens worden soms persoonlijke voorwerpen van soldaten gevonden."):Rt.includes("kazerne")&&(vt="Een kazerne is een gebouw waar soldaten gelegerd waren. Hier woonden, aten en oefenden de troepen.",wt="Rond kazernes worden regelmatig knopen, gespen en andere persoonlijke voorwerpen gevonden.");let en=`<strong class="text-stone-800">${ht}</strong>`;$e&&(en+=`<br/><span class="text-sm font-semibold text-stone-700">${$e}</span>`),Ze&&(en+=`<br/><span class="text-sm text-blue-600">${Ze}</span>`),Ae&&(en+=`<br/><span class="text-xs text-gray-500">${Ae}</span>`),en+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',en+=`<div class="text-sm text-gray-700 mt-1">${vt}</div>`,wt&&(en+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',en+=`<div class="text-sm text-gray-700 mt-1">${wt}</div>`),en+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',en+='<div class="text-sm text-gray-700 mt-1">',en+='<a href="https://erfgoedenlocatie.nl/linies-en-stellingen" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">RCE Linies en Stellingen</a>',en+="</div>",yt.push(en)}}catch(Ie){console.warn("Militaire Objecten WMS query failed:",Ie)}continue}if(De==="Verdedigingslinies"){try{const Ie=fn(Qe),me=gn("EPSG:4326","EPSG:28992",Ie),R=100,X=`https://services.rce.geovoorziening.nl/liniesenstellingen/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=linies&QUERY_LAYERS=linies&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${me[0]-R},${me[1]-R},${me[0]+R},${me[1]+R}`}`,re=await(await fetch(X)).json();if(re.features&&re.features.length>0){const z=re.features[0].properties;let le='<strong class="text-amber-800">Verdedigingslinie</strong>';const $e={"Hollandse Waterlinie":"Verdedigingsstelsel (1815-1940) dat gebruik maakte van inundaties om Holland te beschermen. UNESCO Werelderfgoed.","Nieuwe Hollandse Waterlinie":"Uitgebreide versie (1815-1940) met forten en inundatiegebieden van Muiden tot Gorinchem.","Stelling van Amsterdam":"Ringverdediging rond Amsterdam (1880-1920) met 42 forten. UNESCO Werelderfgoed.",Grebbelinie:"Verdedigingslinie langs de Grebbe (17e-20e eeuw). Zware gevechten in mei 1940.",IJssellinie:"Koude Oorlog verdediging (1950-1968) langs de IJssel tegen Sovjet-invasie.",Atlantikwall:"Duitse kustverdediging WOII (1942-1945) van Noorwegen tot Spanje.","Peel-Raamstelling":"Verdedigingslinie in Brabant/Limburg. Gevechten mei 1940.","Maas-Waalstelling":"Linie tussen Maas en Waal, onderdeel landsverdediging.",Zuiderwaterlinie:"Waterlinie in West-Brabant en Zeeland (17e-19e eeuw).","Staats-Spaanse Linies":"Vestingwerken uit de 80-jarige oorlog (1568-1648)."},Ae=z.naam||z.lin_naam||"";if(Ae){le+=`<br/><span class="text-sm font-semibold text-amber-700">${Ae}</span>`;const Ze=Object.entries($e).find(([ht])=>Ae.toLowerCase().includes(ht.toLowerCase())||ht.toLowerCase().includes(Ae.toLowerCase()));Ze&&(le+=`<br/><span class="text-sm text-gray-700">${Ze[1]}</span>`)}z.lin_period&&(le+=`<br/><span class="text-xs text-purple-600">${z.lin_period}</span>`),z.status&&(le+=`<br/><span class="text-xs text-gray-400">${z.status}</span>`),yt.push(le)}}catch(Ie){console.warn("Verdedigingslinies WMS query failed:",Ie)}continue}if(De==="Rijksmonumenten"){try{const Ie=fn(Qe),me=gn("EPSG:4326","EPSG:28992",Ie),R=50,X=`https://data.geo.cultureelerfgoed.nl/openbaar/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=rijksmonumentpunten&QUERY_LAYERS=rijksmonumentpunten&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${me[0]-R},${me[1]-R},${me[0]+R},${me[1]+R}`}`,re=await(await fetch(X)).json();if(re.features&&re.features.length>0){const z=re.features[0].properties;let le='<strong class="text-red-800">Rijksmonument</strong>';(z.cbsNaam||z.cbs_naam)&&(le+=`<br/><span class="text-sm font-semibold">${z.cbsNaam||z.cbs_naam}</span>`),z.hoofdcategorie&&(le+=`<br/><span class="text-sm text-red-700">${z.hoofdcategorie}</span>`),z.subcategorie&&(le+=`<br/><span class="text-xs text-gray-600">${z.subcategorie}</span>`),z.rijksmonumentnummer&&(le+=`<br/><span class="text-xs text-gray-500">Nr: ${z.rijksmonumentnummer}</span>`),(z.bouwjaar||z.oorspronkelijkebouwjaar)&&(le+=`<br/><span class="text-xs text-gray-500">Bouwjaar: ${z.bouwjaar||z.oorspronkelijkebouwjaar}</span>`),yt.push(le)}}catch(Ie){console.warn("Rijksmonumenten WMS query failed:",Ie)}continue}if(De==="Werelderfgoed"){try{const Ie=fn(Qe),me=gn("EPSG:4326","EPSG:28992",Ie),R=500,X=`https://service.pdok.nl/rce/ps-ch/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=PS.ProtectedSite&QUERY_LAYERS=PS.ProtectedSite&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${me[0]-R},${me[1]-R},${me[0]+R},${me[1]+R}`}`,re=await(await fetch(X)).json();if(re.features&&re.features.length>0){const z=re.features[0].properties;let le='<strong class="text-cyan-800">UNESCO Werelderfgoed</strong>';(z.siteName||z.naam)&&(le+=`<br/><span class="text-sm font-semibold text-cyan-700">${z.siteName||z.naam}</span>`),z.siteDesignation&&(le+=`<br/><span class="text-xs text-gray-600">${z.siteDesignation}</span>`),yt.push(le)}}catch(Ie){console.warn("Werelderfgoed WMS query failed:",Ie)}continue}if(De==="Terpen"){try{const Ie=fn(Qe),me=gn("EPSG:4326","EPSG:28992",Ie),R=100,X=`https://geoportaal.fryslan.nl/arcgis/services/Themas/cultuurhistorie/MapServer/WMSServer?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=terpen3335&QUERY_LAYERS=terpen3335&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${me[0]-R},${me[1]-R},${me[0]+R},${me[1]+R}`}`,re=await(await fetch(X)).json();if(re.features&&re.features.length>0){const z=re.features[0].properties,le=z.naam||z.NAAM||z.Naam||"Terp",$e=z.plaats||z.PLAATS||z.Plaats||"";let Ae=`<strong class="text-orange-800">${le}</strong>`;$e&&(Ae+=`<br/><span class="text-sm text-gray-500">${$e}</span>`),Ae+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',Ae+='<div class="text-sm text-gray-700 mt-1">Een terp is een kunstmatige heuvel. Mensen bouwden deze heuvels om droog te wonen in het vlakke, natte land. Terpen zijn vaak meer dan 2000 jaar oud.</div>',Ae+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',Ae+='<div class="text-sm text-gray-700 mt-1">Op en rond terpen worden vaak vondsten gedaan:</div>',Ae+='<ul class="list-disc list-inside text-sm text-gray-700 mt-1 space-y-0.5">',Ae+="<li>Middeleeuws aardewerk en botten</li>",Ae+="<li>Munten uit verschillende periodes</li>",Ae+="<li>Metalen voorwerpen (gespen, fibulae, sieraden)</li>",Ae+="<li>Soms Romeinse of zelfs prehistorische vondsten</li>",Ae+="</ul>",Ae+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Waarom zijn terpen interessant?</span></div>',Ae+='<div class="text-sm text-gray-700 mt-1">Terpen waren vaak dorpskernen waar mensen eeuwenlang woonden. Door de ophoging bleven veel voorwerpen goed bewaard. Let op: sommige terpen zijn beschermd monument!</div>',Ae+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bezoeken</span></div>',Ae+='<div class="text-sm text-gray-700 mt-1">Veel terpen zijn nog zichtbaar in het landschap. Vraag altijd toestemming aan de grondeigenaar voordat je gaat detecteren.</div>',yt.push(Ae)}}catch(Ie){console.warn("Terpen WMS query failed:",Ie)}continue}if(De==="Religieus Erfgoed"){try{const Ie=fn(Qe),me=gn("EPSG:4326","EPSG:28992",Ie),R=50,X=`https://services.rce.geovoorziening.nl/landschapsatlas_view/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=religieuserfgoed&QUERY_LAYERS=religieuserfgoed&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${me[0]-R},${me[1]-R},${me[0]+R},${me[1]+R}`}`,re=await(await fetch(X)).json();if(re.features&&re.features.length>0){const z=re.features[0].properties,le=z.naam||z.NAAM||z.name||z.NAME||"Onbekend",$e=z.denominatie||z.DENOMINATIE||z.religie||"",Ae=z.type||z.TYPE||z.functie||"",Ze=z.bouwjaar||z.BOUWJAAR||z.jaar||"",ht=z.gemeente||z.GEMEENTE||z.plaats||"";let vt=`<strong class="text-purple-800">${le}</strong>`;const wt=Ae.toLowerCase();let Rt="Een religieus gebouw of heilige plek.",en="Munten van kerkgangers, knopen, gespen, religieuze voorwerpen";wt.includes("kerk")||wt.includes("church")?(Rt="Een kerk was het hart van de gemeenschap. Hier kwamen mensen samen voor diensten, maar ook voor belangrijke gebeurtenissen.",en="Munten uit de collecte, knopen, gespen, pelgrimsinsignes, loden zegels"):wt.includes("kapel")||wt.includes("chapel")?(Rt="Een kapel is een klein gebedshuis, vaak bij een landgoed, langs een weg, of op een bijzondere plek.",en="Devotionalia, munten, kruisjes, rozenkransen"):wt.includes("synagoge")?(Rt="Een synagoge is een Joods gebedshuis. Veel synagogen in Nederland zijn verwoest of herbestemd na de Tweede Wereldoorlog.",en="Munten, knopen, kleine religieuze voorwerpen"):wt.includes("klooster")||wt.includes("monastery")?(Rt="Een klooster was een woon- en werkplek voor monniken of nonnen. Veel kloosters hadden eigen werkplaatsen en landerijen.",en="Religieuze voorwerpen, zegels, gereedschap, aardewerk, middeleeuwse munten"):wt.includes("toren")||wt.includes("tower")?(Rt="Een kerktoren of klokkentoren. Soms is alleen de toren nog over van een verdwenen kerk.",en="Munten, knopen, bouwmateriaal"):(wt.includes("begraafplaats")||wt.includes("cemetery"))&&(Rt="Een historische begraafplaats. Detecteren op begraafplaatsen is niet toegestaan zonder toestemming.",en="Detecteren hier niet toegestaan"),$e&&(vt+=`<br/><span class="text-sm text-purple-600">${$e}</span>`),Ae&&(vt+=`<br/><span class="text-sm text-gray-600">${Ae}</span>`),Ze&&(vt+=`<br/><span class="text-sm text-gray-500">Bouwjaar: ${Ze}</span>`),ht&&(vt+=`<br/><span class="text-xs text-gray-400">${ht}</span>`),vt+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',vt+=`<div class="text-sm text-gray-700 mt-1">${Rt}</div>`,vt+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',vt+=`<div class="text-sm text-gray-700 mt-1">${en}</div>`,vt+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bezoeken</span></div>',wt.includes("begraafplaats")?vt+='<div class="text-sm text-red-600 mt-1">Detecteren op begraafplaatsen is niet toegestaan. Respecteer de rust van de overledenen.</div>':vt+='<div class="text-sm text-gray-700 mt-1">Veel kerken en religieuze gebouwen zijn beschermd monument. Vraag altijd toestemming voordat je gaat detecteren op het terrein.</div>',yt.push(vt)}}catch(Ie){console.warn("Religieus Erfgoed WMS query failed:",Ie)}continue}if(De==="Gewaspercelen"){try{const Ie=fn(Qe),me=gn("EPSG:4326","EPSG:28992",Ie),R=50,Et=`${me[0]-R},${me[1]-R},${me[0]+R},${me[1]+R}`,X=`https://service.pdok.nl/rvo/brpgewaspercelen/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=BrpGewas&QUERY_LAYERS=BrpGewas&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${Et}`,Ot=`https://service.pdok.nl/bzk/bro-bodemkaart/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=soilarea&QUERY_LAYERS=soilarea&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${Et}`,[re,z]=await Promise.all([fetch(X),fetch(Ot).catch(()=>null)]),le=await re.json();if(le.features&&le.features.length>0){const $e=le.features[0].properties;let Ae='<strong class="text-green-800">Landbouwperceel</strong>';if(($e.gewas||$e.gewasnaam)&&(Ae+=`<br/><span class="text-sm font-semibold text-green-700">${$e.gewas||$e.gewasnaam}</span>`),($e.categorie||$e.category)&&(Ae+=`<br/><span class="text-xs text-gray-600">${$e.categorie||$e.category}</span>`),$e.oppervlakte&&(Ae+=`<br/><span class="text-xs text-gray-500">${$e.oppervlakte} ha</span>`),z)try{const Ze=await z.json();if(Ze.features&&Ze.features.length>0){const ht=Ze.features[0].properties,vt=ht.first_soilname||ht.soilname||ht.bodemtype,wt=ht.first_soilcode||ht.soilcode||ht.maparea_soilcode;if(vt){Ae+=`<br/><span class="text-xs text-amber-700 font-medium">Grondsoort: ${vt}</span>`;const Rt=kO(vt,wt);Rt.length>0&&(Ae+=`<br/><span class="text-xs text-gray-500 italic">${Rt.join("  ")}</span>`)}}}catch{}yt.push(Ae)}}catch(Ie){console.warn("BRP Gewaspercelen WMS query failed:",Ie)}continue}if(De==="Kadastrale Grenzen"){try{const Ie=fn(Qe),me=gn("EPSG:4326","EPSG:28992",Ie),R=20,X=`https://service.pdok.nl/kadaster/kadastralekaart/wms/v5_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=Perceel&QUERY_LAYERS=Perceel&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${me[0]-R},${me[1]-R},${me[0]+R},${me[1]+R}`}`,re=await(await fetch(X)).json();if(re.features&&re.features.length>0){const z=re.features[0].properties,le=z.kadastraleGemeenteWaarde||z.kadastrale_gemeente_waarde||z.kadastraleGemeente||cEe[String(z.kadastraleGemeenteCode)]||z.kadastraleGemeenteCode,$e=z.sectie||z.Sectie||"",Ae=z.perceelnummer||z.perceelNummer||z.Perceelnummer||"",Ze=z.kadastraleGrootteWaarde||z.kadastrale_grootte_waarde||z.kadastraleGrootte||z.oppervlakte,ht=z.AKRKadastraleGemeenteCodeWaarde||z.akrKadastraleGemeenteCodeWaarde||"",vt=[le,$e,Ae].filter(Boolean).join(" "),wt=ht&&$e&&Ae?`${ht}-${$e}-${Ae}`:"";let Rt='<strong class="text-indigo-800">Kadastraal Perceel</strong>';if(vt&&(Rt+=`<br/><span class="text-sm text-indigo-700">${vt}</span>`),wt&&(Rt+=`<br/><span class="text-sm font-bold text-gray-800 font-mono">${wt}</span>`),Ze){const en=typeof Ze=="number"?Ze:parseFloat(Ze);isNaN(en)||(Rt+=`<br/><span class="text-xs text-gray-600">${en.toLocaleString("nl-NL")} m</span>`)}Rt+='<br/><br/><span class="text-xs text-gray-600">Eigenaar opzoeken? Kopieer bovenstaande code, ga naar </span><a href="https://www.kadaster.nl/winkel" target="_blank" rel="noopener" class="text-xs text-blue-600 hover:underline">kadaster.nl/winkel</a><span class="text-xs text-gray-600"> en klik "Zoek op aanduiding"</span><span class="text-xs text-gray-400"> (betaalde dienst)</span>',yt.push(Rt)}}catch(Ie){console.warn("Kadastrale Grenzen WMS query failed:",Ie)}continue}if(De==="Scheepswrakken"){try{const Ie=fn(Qe),me=gn("EPSG:4326","EPSG:28992",Ie),R=100,X=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_SCHEEPSRESTANTEN&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_SCHEEPSRESTANTEN&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${me[0]-R},${me[1]-R},${me[0]+R},${me[1]+R}`}`,re=await(await fetch(X)).json();if(re.features&&re.features.length>0){const z=re.features[0].properties;let le='<strong class="text-cyan-800">Scheepswrak</strong>';(z.naam||z.NAAM)&&(le+=`<br/><span class="text-sm font-semibold text-cyan-700">${z.naam||z.NAAM}</span>`),(z.type||z.TYPE)&&(le+=`<br/><span class="text-sm text-gray-700">${z.type||z.TYPE}</span>`),(z.datering||z.DATERING)&&(le+=`<br/><span class="text-xs text-gray-500">Datering: ${z.datering||z.DATERING}</span>`),(z.bron||z.BRON)&&(le+=`<br/><span class="text-xs text-gray-400">${z.bron||z.BRON}</span>`),yt.push(le)}}catch(Ie){console.warn("Scheepswrakken WMS query failed:",Ie)}continue}if(De==="Woonheuvels ZH"){try{const Ie=fn(Qe),me=gn("EPSG:4326","EPSG:28992",Ie),R=100,X=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_WOONHEUVEL&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_WOONHEUVEL&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${me[0]-R},${me[1]-R},${me[0]+R},${me[1]+R}`}`,re=await(await fetch(X)).json();if(re.features&&re.features.length>0){const z=re.features[0].properties;let le='<strong class="text-orange-800">Woonheuvel</strong>';(z.naam||z.NAAM)&&(le+=`<br/><span class="text-sm font-semibold text-orange-700">${z.naam||z.NAAM}</span>`),(z.type||z.TYPE)&&(le+=`<br/><span class="text-sm text-gray-700">${z.type||z.TYPE}</span>`),yt.push(le)}}catch(Ie){console.warn("Woonheuvels WMS query failed:",Ie)}continue}if(De==="Romeinse Forten"){try{const Ie=fn(Qe),me=gn("EPSG:4326","EPSG:28992",Ie),R=200,X=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_ROMEINSFORT&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_ROMEINSFORT&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${me[0]-R},${me[1]-R},${me[0]+R},${me[1]+R}`}`,re=await(await fetch(X)).json();if(re.features&&re.features.length>0){const z=re.features[0].properties;let le='<strong class="text-red-800">Romeins Fort</strong>';(z.naam||z.NAAM)&&(le+=`<br/><span class="text-sm font-semibold text-red-700">${z.naam||z.NAAM}</span>`),(z.type||z.TYPE)&&(le+=`<br/><span class="text-sm text-gray-700">${z.type||z.TYPE}</span>`),(z.periode||z.PERIODE)&&(le+=`<br/><span class="text-xs text-gray-500">${z.periode||z.PERIODE}</span>`),yt.push(le)}}catch(Ie){console.warn("Romeinse Forten WMS query failed:",Ie)}continue}if(De==="Windmolens"){try{const Ie=fn(Qe),me=gn("EPSG:4326","EPSG:28992",Ie),R=50,X=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_NEDERZETTING_WINDMOLENS&QUERY_LAYERS=CHS_2015_NEDERZETTING_WINDMOLENS&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${me[0]-R},${me[1]-R},${me[0]+R},${me[1]+R}`}`,re=await(await fetch(X)).json();if(re.features&&re.features.length>0){const z=re.features[0].properties;let le='<strong class="text-amber-800">Windmolen</strong>';(z.naam||z.NAAM)&&(le+=`<br/><span class="text-sm font-semibold text-amber-700">${z.naam||z.NAAM}</span>`),(z.type||z.TYPE||z.functie||z.FUNCTIE)&&(le+=`<br/><span class="text-sm text-gray-700">${z.type||z.TYPE||z.functie||z.FUNCTIE}</span>`),(z.bouwjaar||z.BOUWJAAR)&&(le+=`<br/><span class="text-xs text-gray-500">Bouwjaar: ${z.bouwjaar||z.BOUWJAAR}</span>`),yt.push(le)}}catch(Ie){console.warn("Windmolens WMS query failed:",Ie)}continue}if(De==="Erfgoedlijnen"){try{const Ie=fn(Qe),me=gn("EPSG:4326","EPSG:28992",Ie),R=200,X=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_ERFGOEDLIJN_HOOFDSTRUCTUUR&QUERY_LAYERS=CHS_ERFGOEDLIJN_HOOFDSTRUCTUUR&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${me[0]-R},${me[1]-R},${me[0]+R},${me[1]+R}`}`,re=await(await fetch(X)).json();if(re.features&&re.features.length>0){const z=re.features[0].properties;let le='<strong class="text-purple-800">Erfgoedlijn</strong>';(z.naam||z.NAAM||z.erfgoedlijn)&&(le+=`<br/><span class="text-sm font-semibold text-purple-700">${z.naam||z.NAAM||z.erfgoedlijn}</span>`),(z.type||z.TYPE)&&(le+=`<br/><span class="text-sm text-gray-700">${z.type||z.TYPE}</span>`),(z.omschrijving||z.OMSCHRIJVING)&&(le+=`<br/><span class="text-xs text-gray-500">${z.omschrijving||z.OMSCHRIJVING}</span>`),yt.push(le)}}catch(Ie){console.warn("Erfgoedlijnen WMS query failed:",Ie)}continue}if(De==="Oude Kernen"){try{const Ie=fn(Qe),me=gn("EPSG:4326","EPSG:28992",Ie),R=200,X=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_KERNEN&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_KERNEN&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${me[0]-R},${me[1]-R},${me[0]+R},${me[1]+R}`}`,re=await(await fetch(X)).json();if(re.features&&re.features.length>0){const z=re.features[0].properties;let le='<strong class="text-stone-800">Historische Kern</strong>';(z.naam||z.NAAM)&&(le+=`<br/><span class="text-sm font-semibold text-stone-700">${z.naam||z.NAAM}</span>`),(z.type||z.TYPE)&&(le+=`<br/><span class="text-sm text-gray-700">${z.type||z.TYPE}</span>`),(z.periode||z.PERIODE)&&(le+=`<br/><span class="text-xs text-gray-500">${z.periode||z.PERIODE}</span>`),yt.push(le)}}catch(Ie){console.warn("Oude Kernen WMS query failed:",Ie)}continue}if(De==="Relictenkaart Punten"){try{const Ie=fn(Qe),me=gn("EPSG:4326","EPSG:28992",Ie),R=50,X=`https://geoserver.gelderland.nl/geoserver/ngr_a/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=ChAr_Relictenkaart_p&QUERY_LAYERS=ChAr_Relictenkaart_p&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${me[0]-R},${me[1]-R},${me[0]+R},${me[1]+R}`}`,re=await(await fetch(X)).json();if(re.features&&re.features.length>0){const z=re.features[0].properties,le={KV:"Kasteel/Vesting",K:"Kapel",KE:"Kerkhof",B:"Buitenhuis",OB:"Oud Bebouwingsrelict",OV:"Oude Verkaveling",NR:"Nijverheidsrelict",GH:"Grafheuvel",BP:"Begraafplaats",HH:"Havezate",RM:"Rosmolen",WM:"Windmolen",PM:"Poldermolen",EK:"Eendenkooi",SH:"Scholtenhoeve"},$e=z.type?.replace(/[0-9]/g,"")||"",Ae=le[$e]||z.type||"Cultuurhistorisch object";let Ze='<strong class="text-emerald-800">Relict</strong>';Ze+=`<br/><span class="text-sm font-semibold text-emerald-700">${Ae}</span>`,z.type&&$e!==z.type&&(Ze+=`<br/><span class="text-xs text-gray-500">Code: ${z.type}</span>`),z.streek&&(Ze+=`<br/><span class="text-xs text-gray-400">Streek: ${z.streek}</span>`),yt.push(Ze)}}catch(Ie){console.warn("Relictenkaart Punten WMS query failed:",Ie)}continue}if(De==="Relictenkaart Lijnen"){try{const Ie=fn(Qe),me=gn("EPSG:4326","EPSG:28992",Ie),R=50,X=`https://geoserver.gelderland.nl/geoserver/ngr_a/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=ChAr_Relictenkaart_l&QUERY_LAYERS=ChAr_Relictenkaart_l&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${me[0]-R},${me[1]-R},${me[0]+R},${me[1]+R}`}`,re=await(await fetch(X)).json();if(re.features&&re.features.length>0){const z=re.features[0].properties,$e={1:"Sprengenbeek",2:"Oude waterloop",3:"Doorgaande weg",4:"Hessenweg",5:"Oude weg",6:"Historische grens",7:"Trekpad",8:"Jaagpad"}[z.klasse]||`Historisch lijnrelict (${z.klasse})`;let Ae='<strong class="text-teal-800">Lijnrelict</strong>';Ae+=`<br/><span class="text-sm font-semibold text-teal-700">${$e}</span>`,yt.push(Ae)}}catch(Ie){console.warn("Relictenkaart Lijnen WMS query failed:",Ie)}continue}if(De==="Relictenkaart Vlakken"){try{const Ie=fn(Qe),me=gn("EPSG:4326","EPSG:28992",Ie),R=100,X=`https://geoserver.gelderland.nl/geoserver/ngr_a/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=ChAr_Relictenkaart_v&QUERY_LAYERS=ChAr_Relictenkaart_v&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${me[0]-R},${me[1]-R},${me[0]+R},${me[1]+R}`}`,re=await(await fetch(X)).json();if(re.features&&re.features.length>0){const z=re.features[0].properties,$e={1:"Onveranderd agrarisch (voor 1850)",2:"Jonge heideontginning (1850-1950)",3:"Open essencomplex",4:"Kampenlandschap",5:"Heiderelict (1850)",6:"Bosrelict (1850)",7:"Stuifzandrelict",8:"Oud bouwland",9:"Historisch grasland",10:"Beekdal"}[z.klasse]||`Historisch landschap (${z.klasse})`;let Ae='<strong class="text-lime-800">Landschapsrelict</strong>';if(Ae+=`<br/><span class="text-sm font-semibold text-lime-700">${$e}</span>`,z.st_area_shape_){const Ze=(z.st_area_shape_/1e4).toFixed(1);Ae+=`<br/><span class="text-xs text-gray-500">${Ze} ha</span>`}yt.push(Ae)}}catch(Ie){console.warn("Relictenkaart Vlakken WMS query failed:",Ie)}continue}if(De==="Verdronken Dorpen"){try{const Ie=fn(Qe),me=gn("EPSG:4326","EPSG:28992",Ie),R=200,X=`https://opengeodata.zeeland.nl/geoserver/chs/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=geocmd_vrddrppnt&QUERY_LAYERS=geocmd_vrddrppnt&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${me[0]-R},${me[1]-R},${me[0]+R},${me[1]+R}`}`,re=await(await fetch(X)).json();if(re.features&&re.features.length>0){const z=re.features[0].properties;let le='<strong class="text-blue-800">Verdronken Dorp</strong>';(z.naam||z.NAAM)&&(le+=`<br/><span class="text-sm font-semibold text-blue-700">${z.naam||z.NAAM}</span>`),(z.verdronken||z.VERDRONKEN||z.jaar||z.JAAR)&&(le+=`<br/><span class="text-xs text-gray-600">Verdronken: ${z.verdronken||z.VERDRONKEN||z.jaar||z.JAAR}</span>`),(z.gemeente||z.GEMEENTE)&&(le+=`<br/><span class="text-xs text-gray-500">${z.gemeente||z.GEMEENTE}</span>`),(z.bron||z.BRON)&&(le+=`<br/><span class="text-xs text-gray-400">${z.bron||z.BRON}</span>`),yt.push(le)}}catch(Ie){console.warn("Verdronken Dorpen WMS query failed:",Ie)}continue}const Xt=Ut.getFeatureInfoUrl(Qe,gt,"EPSG:3857",{INFO_FORMAT:"application/json"});if(Xt)try{const me=await(await fetch(Xt)).json();if(me.features&&me.features.length>0){const R=me.features[0].properties;if(De==="AHN 0.5m"){let re='<strong class="text-blue-800">AHN Hoogtekaart</strong>';const z=R.value_list??R.GRAY_INDEX??R.value??R.gray_index??R.dtm_05m??R.DTM_05M??R.hoogte??R.HOOGTE??R.elevation??R.ELEVATION;if(z!=null&&!isNaN(Number(z))){const le=typeof z=="number"?z.toFixed(2):Number(z).toFixed(2);re+=`<br/><span class="text-sm text-blue-700">Hoogte: ${le} m NAP</span>`,yt.push(re)}else{let le=!1;const $e=["geometry","id","fid","gml_id","bbox"];for(const[Ae,Ze]of Object.entries(R))!$e.includes(Ae.toLowerCase())&&Ze!==null&&Ze!==""&&(re+=`<br/><span class="text-xs text-gray-600">${Ae}: ${Ze}</span>`,le=!0);le&&yt.push(re)}continue}if(De==="Geomorfologie"){let re='<strong class="text-green-800">Geomorfologie</strong>',z=!1;const le=R.landform_subgroup_description,$e=R.relief_klasse,Ae=R.relief_subklasse,Ze=R.genese_description,ht=R.active_process;if(le&&(re+=`<br/><span class="text-sm text-green-700">${le}</span>`,z=!0),$e){const vt=Ae&&Ae!==$e?`${$e} (${Ae})`:$e;re+=`<br/><span class="text-xs text-gray-600">Relief: ${vt}</span>`,z=!0}if(Ze&&(re+=`<br/><span class="text-xs text-gray-500">Ontstaan: ${Ze}</span>`,z=!0),ht&&ht!=="onbekend"&&(re+=`<br/><span class="text-xs text-gray-500">Actief proces: ${ht}</span>`,z=!0),!z){const vt=["geometry","id","fid","gml_id","bbox","fuuid","geom","collection_id"];for(const[wt,Rt]of Object.entries(R))!vt.includes(wt.toLowerCase())&&Rt!==null&&Rt!==""&&!wt.includes("validfrom")&&!wt.includes("validto")&&(re+=`<br/><span class="text-xs text-gray-600">${wt}: ${Rt}</span>`)}re+='<br/><a href="https://legendageomorfologie.wur.nl/" target="_blank" rel="noopener" class="text-xs text-blue-600 hover:underline">Meer over geomorfologie</a>',yt.push(re);continue}let Et=`<strong>${De}</strong>`;const X=R.first_soilname||R.soilname,Ot=R.soilcode||R.first_soilcode;if(X&&(Et+=`<br/><span class="text-sm text-amber-700">${X}</span>`,De==="Bodemkaart")){const re=kO(X,Ot);re.length>0&&(Et+=`<br/><span class="text-xs text-gray-500 italic">${re.join("  ")}</span>`)}if(R.soilslope&&R.soilslope!=="Niet opgenomen"&&(Et+=`<br/><span class="text-xs text-gray-500">Helling: ${R.soilslope}</span>`),!X){const re=["geometry","id","fid","gml_id","GRAY_INDEX","gray_index","value"];for(const[z,le]of Object.entries(R))!re.includes(z)&&le&&le!=="Niet opgenomen"&&(Et+=`<br/><span class="text-xs text-gray-600">${z}: ${le}</span>`)}yt.push(Et)}}catch(Ie){console.warn("WMS GetFeatureInfo failed:",Ie)}}return yt},je=async Qe=>{const gt=[],yt=lEe(Qe.coordinate),Lt=[];n.forEachFeatureAtPixel(Qe.pixel,Xt=>{Lt.push(Xt)});for(const Xt of Lt){const Ie=Xt.getProperties(),{geometry:me,...R}=Ie;if(R.vondst){const re=R.vondst,z=`<strong>${re.objectType}</strong>
            <div data-vondst-id="${re.id}"></div>
            <br/><span class="text-sm text-gray-600"><strong>Materiaal:</strong> ${re.material}</span>
            <br/><span class="text-sm text-gray-600"><strong>Periode:</strong> ${re.period}</span>
            ${re.depth?`<br/><span class="text-sm text-gray-600"><strong>Diepte:</strong> ${re.depth} cm</span>`:""}
            ${re.condition&&re.condition!=="Onbekend"?`<br/><span class="text-sm text-gray-600"><strong>Conditie:</strong> ${re.condition}</span>`:""}
            ${re.weight?`<br/><span class="text-sm text-gray-600"><strong>Gewicht:</strong> ${re.weight} gram</span>`:""}
            ${re.notes?`<br/><span class="text-sm text-gray-600"><strong>Notities:</strong> ${re.notes}</span>`:""}
            ${re.photoUrl?`<br/><a href="${re.photoUrl}" target="_blank" rel="noopener" class="text-blue-600 hover:underline text-sm"> Bekijk foto</a>`:""}
            <br/><span class="text-xs text-gray-400">${new Date(re.timestamp).toLocaleDateString("nl-NL")}</span>`;gt.push(z),T(re.id);continue}if(R.layerType==="customPoint"&&R.customPoint){const re=R.customPoint,z=R.customLayerName||"Mijn Laag";let le=`<strong>${re.name}</strong>`;le+=`<br/><span class="text-xs text-gray-500">${z}</span>`,re.category&&(le+=`<br/><span class="text-sm text-gray-600"><strong>Categorie:</strong> ${re.category}</span>`),re.notes&&(le+=`<br/><span class="text-sm text-gray-600 mt-1">${re.notes}</span>`),re.url&&(le+=`<br/><a href="${re.url}" target="_blank" rel="noopener" class="text-blue-600 hover:underline text-sm">Meer info</a>`),le+=`<br/><span class="text-xs text-gray-400">${new Date(re.createdAt).toLocaleDateString("nl-NL")}</span>`,gt.push(le);continue}if(R.kwaliteitswaarde&&R.kwaliteitswaarde.includes("archeologische waarde")){const re=Se(R);gt.push(re);continue}let Et=R.name||R.naam||R.title||R.NAAM||R.NAME||R.label||R.route_name||R.road_name;Et||(R.leisure==="playground"?Et="Speeltuin":R.leisure==="park"?Et="Park":R.leisure==="swimming_area"||R.sport==="swimming"?Et="Zwemplek":R.tourism==="museum"?Et="Museum":R.amenity==="cafe"||R.amenity==="restaurant"?Et=R.amenity==="cafe"?"Caf":"Restaurant":R.historic==="castle"?Et="Kasteel":Et="Info"),(R.bunker_type||R.name&&(R.name.toLowerCase().includes("bunker")||R.name.toLowerCase().includes("kazemat")||R.name.toLowerCase().includes("schuilplaats")))&&(Et="Bunker"),R.historic==="battlefield"&&(Et="Historisch slagveld");let X=`<strong>${Et}</strong>`;if(R.category&&(X+=`<br/><span class="text-sm text-gray-600">Categorie: ${R.category}</span>`),R.from_to&&R.from_to!==Et&&(X+=`<br/><span class="text-sm text-gray-600">${R.from_to}</span>`),R.route&&R.route!==Et&&(X+=`<br/><span class="text-sm text-gray-600">${R.route}</span>`),R.TOPONIEM&&(X+=`<br/><span class="text-sm font-semibold text-gray-800">${R.TOPONIEM}</span>`,R.PLAATS&&(X+=`<br/><span class="text-xs text-gray-500">${R.PLAATS}</span>`)),(R.AARD_VINDP||R.Aard_vindp)&&(X+=`<br/><span class="text-sm text-gray-700">Aard: ${R.AARD_VINDP||R.Aard_vindp}</span>`),R.BEGIN_PER&&R.EIND_PER&&(X+=`<br/><span class="text-sm text-purple-700">Periode: ${R.BEGIN_PER} - ${R.EIND_PER}</span>`),(R.AARD_OPM||R.Aard_opmer)&&(X+=`<br/><span class="text-xs text-gray-600 italic">${R.AARD_OPM||R.Aard_opmer}</span>`),R.Gemeente&&(X+=`<br/><span class="text-sm text-gray-600">Gemeente: ${R.Gemeente}</span>`),R.Bron&&(X+=`<br/><span class="text-xs text-gray-500">Bron: ${R.Bron}</span>`),R.Bron_besch&&(X+=`<br/><span class="text-xs text-gray-500">${R.Bron_besch}</span>`),R.Dat_st_z&&R.Dat_ei_z&&(X+=`<br/><span class="text-sm text-purple-700">Datering: ${R.Dat_st_z} - ${R.Dat_ei_z}</span>`),R.Begin&&R.Einde&&(X+=`<br/><span class="text-sm text-purple-700">Periode: ${R.Begin} - ${R.Einde}</span>`),R.Uiterwaard&&(X+=`<br/><span class="text-sm font-semibold">${R.Uiterwaard}</span>`),R.rivier&&(X+=`<br/><span class="text-sm text-blue-600">Rivier: ${R.rivier}</span>`),R.Beschrijvi&&(X+=`<br/><span class="text-sm text-gray-700">${R.Beschrijvi}</span>`),R.leisure&&R.name){const re=R.leisure==="playground"?"Speeltuin":R.leisure==="park"?"Park":R.leisure==="swimming_area"?"Zwemplek":null;re&&(X+=`<br/><span class="text-xs text-green-600">${re}</span>`)}if((R.tourism==="museum"||R.museum)&&R.name&&(X+='<br/><span class="text-xs text-purple-600">Museum</span>'),(R.leisure==="swimming_area"||R.sport==="swimming")&&R.name&&(X+='<br/><span class="text-xs text-cyan-600">Zwemplek</span>'),R.osm_id&&R.address!==void 0&&(X+='<br/><span class="text-xs text-lime-600">Kringloopwinkel</span>',R.address&&(X+=`<br/><span class="text-xs text-gray-500">${R.address}</span>`),R.phone&&(X+=`<br/><span class="text-xs text-gray-600">${R.phone}</span>`)),R.site_type==="tumulus"){const re=Xt.getGeometry()?.getCoordinates();let z="",le="";if(re){const $e=fn(re),Ae=$e[0],Ze=$e[1];Ae>5.5&&Ae<6.3&&Ze>52&&Ze<52.5?(z="Veluwe",le="De Veluwe heeft de grootste concentratie grafheuvels van Nederland. Veel heuvels liggen in grafvelden met tientallen heuvels bij elkaar."):Ae>6.2&&Ae<7.1&&Ze>52.6&&Ze<53.3?(z="Drenthe",le="Drenthe is beroemd om zijn prehistorische monumenten. Naast hunebedden liggen hier honderden grafheuvels uit de Bronstijd."):Ae>4.5&&Ae<6&&Ze>51.3&&Ze<51.9?(z="Noord-Brabant",le="Op de Brabantse zandgronden liggen veel grafheuvels, vaak in kleine groepjes op hogere gronden."):Ae>5.5&&Ae<6.3&&Ze>50.7&&Ze<51.6?(z="Limburg",le="De Limburgse heuvels en plateaus herbergen grafheuvels uit verschillende periodes, van Bronstijd tot Romeinse tijd."):Ae>5&&Ae<5.6&&Ze>52&&Ze<52.4&&(z="Utrechtse Heuvelrug",le="De stuwwallen van de Utrechtse Heuvelrug en het Gooi waren al in de prehistorie bewoond. Grafheuvels markeren de laatste rustplaats van de vroege bewoners.")}X+='<br/><span class="text-sm text-amber-700">Grafheuvel uit de Bronstijd of IJzertijd</span>',z&&(X+=`<br/><span class="text-sm text-gray-500">${z}</span>`),X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',X+='<div class="text-sm text-gray-700 mt-1">Een grafheuvel is een kunstmatige heuvel over een of meerdere graven. De meeste Nederlandse grafheuvels zijn 3000 tot 4000 jaar oud, uit de Bronstijd (2000-800 v.Chr.) of vroege IJzertijd.</div>',le&&(X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Over deze regio</span></div>',X+=`<div class="text-sm text-gray-700 mt-1">${le}</div>`),X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe herken je een grafheuvel?</span></div>',X+='<div class="text-sm text-gray-700 mt-1">Grafheuvels zijn vaak ronde, lage heuvels van 10-30 meter doorsnee en 1-3 meter hoog. Ze liggen meestal op zandgronden, vaak in groepjes (grafvelden). Let op de kenmerkende ronde vorm in het landschap.</div>',R.wikidata?(X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer informatie</span></div>',X+=`<div class="text-sm text-gray-700 mt-1"><a href="https://www.wikidata.org/wiki/${R.wikidata}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Bekijk op Wikidata</a></div>`):(X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer informatie</span></div>',X+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Grafheuvel" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Lees meer over grafheuvels op Wikipedia</a></div>')}if(R.historic==="castle"||R.castle_type){const re={manor:{label:"Landhuis",uitleg:"Een landhuis of havezate was het woonhuis van een adellijke familie. Vaak met een landgoed eromheen.",vondsten:"Sieraden, gespen, munten, aardewerk van rijke bewoners"},stately:{label:"Statig huis",uitleg:"Een groot en deftig woonhuis, vaak van welgestelde families. Soms met kasteelachtige kenmerken.",vondsten:"Huishoudelijke voorwerpen, munten, knopen, aardewerk"},fortress:{label:"Fort/Vesting",uitleg:"Een versterkte militaire bouwwerk, gebouwd om een gebied te verdedigen.",vondsten:"Militaire voorwerpen, kogels, gespen, uniformonderdelen"},defensive:{label:"Verdedigingskasteel",uitleg:"Een kasteel gebouwd voor verdediging, met dikke muren, een gracht en torens.",vondsten:"Wapens, harnasonderdelen, pijlpunten, middeleeuwse munten"},palace:{label:"Paleis",uitleg:"Een groot en luxueus gebouw voor koningen, prinsen of zeer rijke families.",vondsten:"Luxe voorwerpen, sieraden, zegels, zeldzame munten"},castrum:{label:"Romeins fort",uitleg:"Een Romeins legerkamp of fort. Deze zijn bijna 2000 jaar oud!",vondsten:"Romeinse munten, fibulae, militaria, aardewerk"},citadel:{label:"Citadel",uitleg:"Een sterk versterkte kern binnen een stad, als laatste verdedigingslinie.",vondsten:"Militaire voorwerpen uit verschillende periodes"}},z=R.castle_type?re[R.castle_type]:null,le=z?.label||"Kasteel";if(X+=`<br/><span class="text-sm text-purple-600">${le}</span>`,R.start_date&&(X+=`<br/><span class="text-sm text-gray-500">Bouwjaar: ${R.start_date}</span>`),R.heritage&&(X+='<br/><span class="text-sm text-amber-600">Rijksmonument</span>'),X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',z?X+=`<div class="text-sm text-gray-700 mt-1">${z.uitleg}</div>`:X+='<div class="text-sm text-gray-700 mt-1">Een historisch kasteel of adellijk huis. Kastelen waren vaak het middelpunt van macht en rijkdom in een gebied.</div>',X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',z?X+=`<div class="text-sm text-gray-700 mt-1">${z.vondsten}</div>`:X+='<div class="text-sm text-gray-700 mt-1">Munten, sieraden, gespen, aardewerk en andere voorwerpen van de vroegere bewoners.</div>',R.wikipedia||R.website){if(X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',R.wikipedia){const $e=R.wikipedia.startsWith("http")?R.wikipedia:`https://nl.wikipedia.org/wiki/${R.wikipedia.replace(/^nl:/,"")}`;X+=`<div class="text-sm text-gray-700 mt-1"><a href="${$e}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`}R.website&&(X+=`<div class="text-sm text-gray-700 mt-1"><a href="${R.website}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Website bezoeken</a></div>`)}}if(R.historic==="ruins"){const re=R.ruins_type||"";let z="Rune",le="Een rune is wat overblijft van een oud gebouw. Het kan een kerk, kasteel, molen of ander bouwwerk zijn geweest.",$e="Baksteenfragmenten, aardewerk, metalen voorwerpen van vroegere bewoners of gebruikers";if(re.toLowerCase().includes("church")||re.toLowerCase().includes("kerk")?(z="Kerkrune",le="De overblijfselen van een oude kerk. Vaak nog te herkennen aan de fundering of een paar muren.",$e="Religieuze voorwerpen, munten van kerkgangers, knopen, gespen"):re.toLowerCase().includes("castle")||re.toLowerCase().includes("kasteel")?(z="Kasteelrune",le="De resten van een middeleeuws kasteel. Soms is alleen de gracht of fundering nog zichtbaar.",$e="Middeleeuwse munten, sieraden, harnasonderdelen, pijlpunten"):re.toLowerCase().includes("mill")||re.toLowerCase().includes("molen")?(z="Molenrune",le="Wat rest van een oude molen. Vaak nog te zien aan de stenen fundering of de molenberg.",$e="Gereedschap, munten, huishoudelijke voorwerpen"):re.toLowerCase().includes("fort")&&(z="Fortrune",le="De overblijfselen van een militair fort of verdedigingswerk.",$e="Militaire voorwerpen, kogels, gespen, uniformonderdelen"),X+=`<br/><span class="text-sm text-gray-600">${z}</span>`,X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',X+=`<div class="text-sm text-gray-700 mt-1">${le}</div>`,X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',X+=`<div class="text-sm text-gray-700 mt-1">${$e}</div>`,R.description&&(X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Beschrijving</span></div>',X+=`<div class="text-sm text-gray-700 mt-1">${R.description}</div>`),R.wikipedia){const Ae=R.wikipedia.startsWith("http")?R.wikipedia:`https://${R.wikipedia.split(":")[0]||"nl"}.wikipedia.org/wiki/${R.wikipedia.replace(/^[a-z]{2}:/,"")}`;X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',X+=`<div class="text-sm text-gray-700 mt-1">Lees meer op <a href="${Ae}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`}}if(R.bunker_type||R.name&&(R.name.toLowerCase().includes("bunker")||R.name.toLowerCase().includes("kazemat")||R.name.toLowerCase().includes("schuilplaats"))){const re={munitions:"Munitiebunker",personnel_shelter:"Personeelsschuilplaats",personell_shelter:"Personeelsschuilplaats",command:"Commandobunker",gun_emplacement:"Geschutsbunker",mg_nest:"Mitrailleursnest",technical:"Technische bunker",storage:"Opslagbunker",tobruk:"Tobruk",kazemat:"Kazemat",Flak:"Luchtafweerstelling",hardened_aircraft_shelter:"Vliegtuigshelter",shelter:"Schuilkelder",observation:"Observatiebunker",anti_aircraft:"Luchtafweerstelling"},z=R.name||"",le=R.bunker_type?re[R.bunker_type]||R.bunker_type:"";z&&z!=="Bunker"&&(X+=`<br/><span class="text-sm font-semibold text-gray-700">${z}</span>`),le&&le!==z&&(X+=`<br/><span class="text-xs text-gray-500">${le}</span>`);const $e=Xt.getGeometry()?.getCoordinates();let Ae="",Ze="",ht="";if($e){const vt=fn($e),wt=vt[0],Rt=vt[1],en=wt<4.8||wt<5.2&&Rt>51.8&&Rt<53.5,Fr=wt>4.2&&wt<4.4&&Rt>52&&Rt<52.15,Rs=wt>4.5&&wt<4.7&&Rt>52.4&&Rt<52.5,$i=wt>4&&wt<4.2&&Rt>51.95&&Rt<52.05,Wi=wt<4.2&&Rt<51.6,Ar=wt>5.2&&wt<5.8&&Rt>51.9&&Rt<52.3;Fr?(Ae="Deze bunker maakt deel uit van de Atlantikwall bij Scheveningen. De Duitsers bouwden hier tijdens WOII zo'n 80 bunkers in de duinen. De muren zijn soms 3 meter dik beton. Voor deze bunkers moesten 138.000 mensen uit Den Haag en Scheveningen hun huis verlaten.",Ze="https://nl.wikipedia.org/wiki/Atlantikwall_Museum_Scheveningen",ht="Atlantikwall Museum Scheveningen"):Rs?(Ae="Deze bunker hoort bij Festung IJmuiden, een van de zwaarst verdedigde punten van de Atlantikwall. De Duitsers bouwden hier bunkers om de haventoegang te beschermen. Er zijn nu rondleidingen door het Bunkermuseum.",Ze="https://www.bunkermuseum.nl/",ht="Bunkermuseum IJmuiden"):$i?(Ae="Deze bunker maakt deel uit van de Atlantikwall bij Hoek van Holland. Dit was een strategisch punt voor de Duitsers vanwege de Nieuwe Waterweg. Veel bunkers zijn nog te bezoeken.",Ze="https://www.atlantikwallhoekvanholland.nl/",ht="Atlantikwall Hoek van Holland"):Wi?(Ae="Deze bunker hoort bij de Atlantikwall in Zeeland. De Duitsers verdedigden hier de Westerschelde en de kust. Bij Zoutelande en Westkapelle zijn veel bunkers bewaard gebleven.",Ze="https://www.bunkermuseumzoutelande.nl/",ht="Bunkermuseum Zoutelande"):en?(Ae="Deze bunker maakt deel uit van de Atlantikwall: de Duitse verdedigingslinie langs de hele kust van Europa. In Nederland bouwden de Duitsers duizenden bunkers tussen 1942 en 1944.",Ze="https://nl.wikipedia.org/wiki/Atlantikwall",ht="Atlantikwall (Wikipedia)"):Ar?(Ae="Deze bunker hoort mogelijk bij de Grebbelinie of de Nieuwe Hollandse Waterlinie. Dit waren Nederlandse verdedigingslinies die de Duitsers na 1940 versterkten met bunkers.",Ze="https://nl.wikipedia.org/wiki/Grebbelinie",ht="Grebbelinie (Wikipedia)"):(Ae="Een bunker uit de Tweede Wereldoorlog. De meeste bunkers in Nederland zijn gebouwd tussen 1940 en 1944, als onderdeel van de Duitse verdediging of langs bestaande Nederlandse linies.",Ze="https://nl.wikipedia.org/wiki/Atlantikwall",ht="WOII bunkers (Wikipedia)")}else Ae="Een bunker uit de Tweede Wereldoorlog.",Ze="https://nl.wikipedia.org/wiki/Atlantikwall",ht="WOII bunkers (Wikipedia)";X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',X+=`<div class="text-sm text-gray-700 mt-1">${Ae}</div>`,X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je vinden?</span></div>',X+='<div class="text-sm text-gray-700 mt-1">Bij bunkers worden soms voorwerpen gevonden zoals patronen, uniformknopen, gespen en persoonlijke spullen van soldaten.</div>',X+='<div class="mt-2 text-xs text-gray-500 italic">Let op: betreed nooit een bunker zonder toestemming. Raak munitieresten niet aan.</div>',X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bronnen</span></div>',X+='<div class="text-sm text-gray-700 mt-1">',X+=`<a href="${Ze}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">${ht}</a>`,R.website?X+=`<br/><a href="${R.website}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">TracesOfWar</a>`:X+='<br/><a href="https://www.tracesofwar.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">TracesOfWar</a>',X+="</div>"}if(R.historic==="battlefield"){const re=R.name||"Onbekend slagveld",le={"Slag om Arnhem":{periode:"September 1944",samenvatting:"De Slag om Arnhem was onderdeel van Operatie Market Garden. Geallieerde parachutisten probeerden de brug over de Rijn te veroveren. Na negen dagen hevige gevechten moesten ze zich terugtrekken. Van de 10.000 Britse soldaten werden er 1.500 gedood en 6.500 krijgsgevangen gemaakt.",watZieJe:"Er zijn veel monumenten en infoborden. Het Airborne Museum in Oosterbeek vertelt het hele verhaal. Elk jaar in september is er een herdenking.",uitkomst:"De geallieerden verloren de slag. Nederland bleef nog tot mei 1945 bezet.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_om_Arnhem"},"Slag om de Sloedam":{periode:"1-2 november 1944",samenvatting:"Canadese soldaten vielen de Sloedam aan om Walcheren te bevrijden. De dam was smal en de Duitsers verdedigden fel. Veel soldaten sneuvelden bij deze bloedige aanval.",watZieJe:"Bij de dam staat een monument voor de gevallen Canadezen. Er zijn infoborden die de slag uitleggen.",uitkomst:"De Canadezen wonnen na zware verliezen. Dit opende de weg naar de bevrijding van Walcheren.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_om_de_Sloedam"},"Slag bij Heiligerlee (1568)":{periode:"23 mei 1568",samenvatting:"De eerste veldslag van de Tachtigjarige Oorlog. Lodewijk van Nassau versloeg het Spaanse leger. Zijn broer Adolf sneuvelde tijdens de strijd.",watZieJe:"In Heiligerlee staat het Slag bij Heiligerlee monument. Het klooster waar Adolf van Nassau begraven ligt is nog te bezoeken.",uitkomst:"De opstandelingen wonnen, maar dit was pas het begin van 80 jaar oorlog.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_bij_Heiligerlee_(1568)"},Overloon:{periode:"Oktober 1944",samenvatting:"Bij Overloon vochten Britten en Amerikanen tegen de Duitsers. Het was een van de zwaarste tankgevechten op Nederlandse bodem. Het dorp werd volledig verwoest.",watZieJe:"Het Oorlogsmuseum Overloon staat op het voormalige slagveld. Je kunt tanks, vliegtuigen en andere voertuigen zien.",uitkomst:"De geallieerden wonnen na wekenlange gevechten.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_om_Overloon"},"Slagveld Lanakerveld":{periode:"1568",samenvatting:"Onderdeel van de Nederlandse opstand tegen Spanje. Hier vonden gevechten plaats tijdens de beginjaren van de Tachtigjarige Oorlog.",watZieJe:"Het gebied is nu grotendeels landbouwgrond. Lokaal zijn er soms infoborden.",uitkomst:"Onderdeel van de lange strijd tegen de Spaanse overheersing.",wikiUrl:"https://nl.wikipedia.org/wiki/Tachtigjarige_Oorlog"},Blessebrugschans:{periode:"Diverse periodes",samenvatting:"Een historische schans die meerdere keren werd gebruikt in militaire conflicten.",watZieJe:"De resten van de schans zijn nog zichtbaar in het landschap.",uitkomst:"De schans speelde een rol in verschillende conflicten.",wikiUrl:"https://nl.wikipedia.org/wiki/Schans_(vestingwerk)"}}[re];if(re!=="Onbekend slagveld"&&re!=="Historisch slagveld"&&(X+=`<br/><span class="text-sm font-semibold text-red-700">${re}</span>`),le)X+=`<br/><span class="text-xs text-gray-500">${le.periode}</span>`,X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat gebeurde hier?</span></div>',X+=`<div class="text-sm text-gray-700 mt-1">${le.samenvatting}</div>`,X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe liep het af?</span></div>',X+=`<div class="text-sm text-gray-700 mt-1">${le.uitkomst}</div>`,X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je zien?</span></div>',X+=`<div class="text-sm text-gray-700 mt-1">${le.watZieJe}</div>`,X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bronnen</span></div>',X+='<div class="text-sm text-gray-700 mt-1">',X+=`<a href="${le.wikiUrl}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a>`,re.includes("Arnhem")&&(X+='<br/><a href="https://www.airbornemuseum.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Airborne Museum Oosterbeek</a>'),re.includes("Overloon")&&(X+='<br/><a href="https://www.oorlogsmuseum.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Oorlogsmuseum Overloon</a>'),X+="</div>";else if(R.date&&(X+=`<br/><span class="text-xs text-gray-500">${R.date}</span>`),R.description?(X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat gebeurde hier?</span></div>',X+=`<div class="text-sm text-gray-700 mt-1">${R.description}</div>`):(X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat gebeurde hier?</span></div>',X+='<div class="text-sm text-gray-700 mt-1">Op deze plek vonden historische gevechten plaats. Zoek lokaal naar infoborden of monumenten.</div>'),R.wikipedia){const $e=R.wikipedia.startsWith("http")?R.wikipedia:`https://nl.wikipedia.org/wiki/${R.wikipedia.replace("nl:","")}`;X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bronnen</span></div>',X+=`<div class="text-sm text-gray-700 mt-1"><a href="${$e}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`}}if(R.bron==="Paleobiology Database"){const re=Ae=>{const Ze={Mollusca:"weekdieren zoals schelpen en slakken",Brachiopoda:"armpotigen, schelp-achtige dieren",Echinodermata:"stekelhuidigen zoals zee-egels en zeesterren",Chordata:"gewervelde dieren",Arthropoda:"geleedpotigen zoals kreeften en trilobieten",Cnidaria:"neteldieren zoals koralen en kwallen",Bryozoa:"mosdiertjes",Foraminifera:"eencellige schelpdieren",Plantae:"planten",Crinoidea:"zeelelies",Gastropoda:"slakken",Bivalvia:"tweekleppigen zoals mossels en oesters",Cephalopoda:"koppotigen zoals inktvissen en ammonieten",Trilobita:"trilobieten, uitgestorven kreeftachtigen",Mammalia:"zoogdieren",Reptilia:"reptielen",Pisces:"vissen",Amphibia:"amfibien"};for(const[ht,vt]of Object.entries(Ze))if(Ae.toLowerCase().includes(ht.toLowerCase()))return vt;return""},z=Ae=>{const Ze={Cambrium:"541-485 miljoen jaar geleden",Ordovicium:"485-444 miljoen jaar geleden",Siluur:"444-419 miljoen jaar geleden",Devoon:"419-359 miljoen jaar geleden",Carboon:"359-299 miljoen jaar geleden",Perm:"299-252 miljoen jaar geleden",Trias:"252-201 miljoen jaar geleden",Jura:"201-145 miljoen jaar geleden",Krijt:"145-66 miljoen jaar geleden",Paleogeen:"66-23 miljoen jaar geleden",Neogeen:"23-2,6 miljoen jaar geleden",Kwartair:"2,6 miljoen jaar - nu",Pleistoceen:"2,6 miljoen - 11.700 jaar geleden",Holoceen:"11.700 jaar geleden - nu"};for(const[ht,vt]of Object.entries(Ze))if(Ae.toLowerCase().includes(ht.toLowerCase()))return vt;return""},le=Ae=>{const Ze={limestone:"kalksteen",sandstone:"zandsteen",shale:"schalie",clay:"klei",sand:"zand",gravel:"grind",marl:"mergel",chalk:"krijt",mudstone:"moddersteen",siltstone:"siltsteen"};let ht=Ae;for(const[vt,wt]of Object.entries(Ze))ht=ht.replace(new RegExp(vt,"gi"),wt);return ht},$e=Ae=>{const Ze={marine:"zee",coastal:"kust",terrestrial:"land",fluvial:"rivier",lacustrine:"meer",reef:"rif",deltaic:"delta",shallow:"ondiep water",deep:"diep water"};let ht=Ae;for(const[vt,wt]of Object.entries(Ze))ht=ht.replace(new RegExp(vt,"gi"),wt);return ht};if(R.vindplaats&&(X+=`<br/><span class="text-xs text-gray-600">${R.vindplaats}</span>`),X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is hier gevonden?</span></div>',R.taxonomie&&R.taxonomie!=="Onbekend"){const Ae=re(R.taxonomie);Ae?(X+=`<div class="text-sm text-gray-700 mt-1">${Ae}</div>`,X+=`<div class="text-xs text-gray-500 italic">(${R.taxonomie})</div>`):X+=`<div class="text-sm text-gray-700 mt-1">${R.taxonomie}</div>`}if(R.aantal_fossielen){const Ae=parseInt(R.aantal_fossielen),Ze=Ae>100?"Veel fossielen gevonden op deze locatie.":Ae>10?"Meerdere fossielen gevonden op deze locatie.":`${R.aantal_fossielen} fossiel${Ae>1?"en":""} gevonden op deze locatie.`;X+=`<div class="text-sm text-gray-600 mt-1">${Ze}</div>`}if(R.periode&&R.periode!=="Onbekend"){X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wanneer leefden deze dieren?</span></div>';const Ae=z(R.periode);X+=`<div class="text-sm text-gray-700 mt-1">${R.periode}</div>`,Ae&&(X+=`<div class="text-sm text-gray-600">${Ae}</div>`),R.ouderdom&&R.ouderdom!=="Onbekend"&&(X+=`<div class="text-sm text-gray-600">Ouderdom: ${R.ouderdom}</div>`)}(R.gesteente||R.formatie||R.milieu)&&(X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">In wat voor gesteente?</span></div>',R.gesteente&&(X+=`<div class="text-sm text-gray-700 mt-1">${le(R.gesteente)}</div>`),R.formatie&&(X+=`<div class="text-sm text-gray-600">Formatie: ${R.formatie}</div>`,R.lid&&(X+=`<div class="text-sm text-gray-600 ml-3">Lid: ${R.lid}</div>`)),R.milieu&&(X+=`<div class="text-sm text-gray-600">Leefomgeving: ${$e(R.milieu)}</div>`))}if(R.layerType==="fossielHotspot"){const re=[];if(R.type&&re.push(R.type),R.region&&re.push(R.region),R.country){const z={NL:"Nederland",BE:"Belgi",DE:"Duitsland",FR:"Frankrijk"};re.push(z[R.country]||R.country)}if(re.length>0&&(X+=`<br/><span class="text-xs text-gray-600">${re.join("  ")}</span>`),(R.finds||R.period)&&(X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kan ik er vinden?</span></div>',R.finds&&(X+=`<div class="text-sm text-gray-700 mt-1">${R.finds}</div>`),R.period&&(X+=`<div class="text-sm text-gray-600 mt-1">Periode: ${R.period}</div>`),R.geology&&(X+=`<div class="text-sm text-gray-600 mt-1">Geologie: ${R.geology}</div>`)),R.access||R.tips){if(X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe kom ik er?</span></div>',R.access){const le=R.access.toLowerCase().includes("verboden")||R.access.toLowerCase().includes("niet toegankelijk")?"text-red-600":"text-gray-700";X+=`<div class="text-sm ${le} mt-1">${R.access}</div>`}R.tips&&(X+=`<div class="text-sm text-gray-600 mt-1 italic">Tip: ${R.tips}</div>`)}}if(R.layerType==="mineralenHotspot"){const re=[];if(R.region&&re.push(R.region),R.country){const z={NL:"Nederland",BE:"Belgi",DE:"Duitsland",FR:"Frankrijk"};re.push(z[R.country]||R.country)}if(re.length>0&&(X+=`<br/><span class="text-xs text-gray-600">${re.join("  ")}</span>`),R.minerals&&(X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kan ik er vinden?</span></div>',X+=`<div class="text-sm text-gray-700 mt-1">${R.minerals}</div>`,R.geology&&(X+=`<div class="text-sm text-gray-600 mt-1">Geologie: ${R.geology}</div>`)),R.access||R.tips){if(X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe kom ik er?</span></div>',R.access){const le=R.access.toLowerCase().includes("verboden")||R.access.toLowerCase().includes("niet toegankelijk")||R.access.toLowerCase().includes("gesloten")?"text-red-600":"text-gray-700";X+=`<div class="text-sm ${le} mt-1">${R.access}</div>`}R.tips&&(X+=`<div class="text-sm text-gray-600 mt-1 italic">Tip: ${R.tips}</div>`)}}if(R.layerType==="goudrivier"){const re=[];if(R.river&&re.push(R.river),R.region&&re.push(R.region),R.country){const z={NL:"Nederland",BE:"Belgi",DE:"Duitsland",FR:"Frankrijk"};re.push(z[R.country]||R.country)}if(re.length>0&&(X+=`<br/><span class="text-xs text-gray-600">${re.join("  ")}</span>`),(R.goldType||R.origin)&&(X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kan ik er vinden?</span></div>',R.goldType&&(X+=`<div class="text-sm text-gray-700 mt-1">${R.goldType}</div>`),R.origin&&(X+=`<div class="text-sm text-gray-600 mt-1">Herkomst: ${R.origin}</div>`)),R.legal||R.tips){if(X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Mag ik hier zoeken?</span></div>',R.legal){const le=R.legal.includes("VERBODEN")?"text-red-600 font-semibold":"text-gray-700";X+=`<div class="text-sm ${le} mt-1">${R.legal}</div>`}R.tips&&(X+=`<div class="text-sm text-gray-600 mt-1 italic">Tip: ${R.tips}</div>`)}}if(R.layerType==="wandelroute"){const re=[];if(R.region&&re.push(R.region),R.country){const z={NL:"Nederland",BE:"Belgi"};re.push(z[R.country]||R.country)}if(re.length>0&&(X+=`<br/><span class="text-xs text-gray-600">${re.join("  ")}</span>`),R.distance||R.duration){const z=R.distance?`${R.distance} km`:"",le=R.duration?`${R.duration}`:"",$e=[z,le].filter(Boolean).join("  ");$e&&(X+=`<br/><span class="text-sm text-green-700 font-medium">${$e}</span>`)}(R.description||R.highlights)&&(X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat ga je zien?</span></div>',R.description&&(X+=`<div class="text-sm text-gray-700 mt-1">${R.description}</div>`),R.highlights&&(X+=`<div class="text-sm text-gray-600 mt-1">Hoogtepunten: ${R.highlights}</div>`)),R.startAddress&&(X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Waar begin ik?</span></div>',X+=`<div class="text-sm text-gray-700 mt-1">${R.startAddress}</div>`),R.url&&(X+=`<div class="mt-3"><a href="${R.url}" target="_blank" class="text-sm text-blue-600 hover:underline">Bekijk route en download GPX</a></div>`)}if(R.layerType==="hunebed"){R.period&&(X+=`<br/><span class="text-sm text-purple-700">Periode: ${R.period}</span>`),X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',R.description&&(X+=`<div class="text-sm text-gray-700 mt-1">${R.description}</div>`);const re=[];if(R.stones){const z=R.stones.toLowerCase(),le=z.match(/(\d+)\s*dekst[^\s,]*/i),$e=z.match(/(\d+)\s*draagst[^\s,]*/i),Ae=z.match(/(\d+)\s*sluitst[^\s,]*/i),Ze=z.match(/(\d+)\s*poortst[^\s,]*/i),ht=z.match(/(\d+)\s*gangdekst[^\s,]*/i),vt=z.match(/(\d+)\s*gangzijst[^\s,]*/i);le&&re.push(`${le[1]} deksteen${parseInt(le[1])>1?"en":""} (de grote steen${parseInt(le[1])>1?"en":""} bovenop)`),$e&&re.push(`${$e[1]} draagstenen (de stenen die de dekstenen dragen)`),Ae&&re.push(`${Ae[1]} sluitsteen${parseInt(Ae[1])>1?"en":""} (afsluiting aan de korte zijden)`),Ze&&re.push(`${Ze[1]} poortsteen${parseInt(Ze[1])>1?"en":""} (bij de ingang)`),ht&&re.push(`${ht[1]} gangdeksteen${parseInt(ht[1])>1?"en":""} (boven de toegangsgang)`),vt&&re.push(`${vt[1]} gangzijstenen (langs de toegangsgang)`)}if(R.length&&re.push(`Een grafkamer van ${R.length} lang`),R.width&&re.push(`${R.width}`),re.length>0&&(X+='<div class="text-sm text-gray-700 mt-1">Het hunebed heeft:</div>',X+='<ul class="list-disc list-inside text-sm text-gray-700 mt-1 space-y-0.5">',re.forEach(z=>{X+=`<li>${z}</li>`}),X+="</ul>"),R.notable){const z=R.notable.toLowerCase();let le="Wat is hier bijzonder?";z.includes("grootste")?le="Waarom is dit het grootste hunebed?":z.includes("klein")||z.includes("kindhunebed")?le="Waarom is dit hunebed zo klein?":z.includes("cluster")||z.includes("naast elkaar")?le="Waarom liggen hier meerdere hunebedden?":(z.includes("enige")||z.includes("westelijk")||z.includes("noordelijk"))&&(le="Wat maakt deze locatie bijzonder?"),X+=`<div class="mt-3"><span class="text-sm font-semibold text-gray-800">${le}</span></div>`,X+=`<div class="text-sm text-gray-700 mt-1">${R.notable}</div>`}X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is de Trechterbeker cultuur?</span></div>',X+='<div class="text-sm text-gray-700 mt-1">De Trechterbeker cultuur is de naam voor de mensen die 5.000 jaar geleden in Nederland woonden. Ze maakten potten met een trechter-vorm. Daarom heten ze zo. Deze mensen bouwden de hunebedden als graven voor hun doden.</div>',R.finds&&(X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is hier gevonden?</span></div>',X+=`<div class="text-sm text-gray-700 mt-1">${R.finds}</div>`),R.museum&&(X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Museum in de buurt</span></div>',X+=`<div class="text-sm text-gray-700 mt-1">${R.museum}</div>`),X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bezoeken</span></div>',R.access?X+=`<div class="text-sm text-gray-700 mt-1">${R.access}</div>`:X+='<div class="text-sm text-gray-700 mt-1">Je kunt dit hunebed gratis bezoeken.</div>',R.wikipedia&&(X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',X+=`<div class="text-sm text-gray-700 mt-1">Lees meer op <a href="${R.wikipedia}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`)}if((R.inventarisnummer||R.locatie_naam)&&(R.locatie_naam&&(X+=`<br/><span class="text-sm font-semibold">${R.locatie_naam}</span>`),R.inventarisnummer&&(X+=`<br/><span class="text-xs text-gray-500">CAI: ${R.inventarisnummer}</span>`),R.datering_tekst&&(X+=`<br/><span class="text-sm text-purple-700">${R.datering_tekst}</span>`)),(R.veensoort||R.dikte)&&(R.veensoort&&(X+=`<br/><span class="text-sm text-amber-700">${R.veensoort}</span>`),R.dikte&&(X+=`<br/><span class="text-xs text-gray-600">Dikte: ${R.dikte}</span>`)),R.nature&&R.debut){X+=`<br/><span class="text-sm text-purple-700">${R.nature}</span>`;const re=R.debut===R.fin?R.debut:`${R.debut} - ${R.fin}`;re&&(X+=`<br/><span class="text-sm text-gray-700">Periode: ${re}</span>`),R.structure&&(X+=`<br/><span class="text-xs text-gray-600">${R.structure}</span>`),R.commune&&(X+=`<br/><span class="text-xs text-gray-500">${R.commune}</span>`),R.decouvert&&(X+=`<br/><span class="text-xs text-gray-400">Ontdekt: ${R.decouvert}</span>`),R.numero&&(X+=`<br/><span class="text-xs text-gray-400">${R.numero}</span>`)}if((R.NATURE_OPE||R.CODE_OPERA)&&(R.TITRE&&(X+=`<br/><span class="text-sm font-semibold">${R.TITRE}</span>`),R.NATURE_OPE&&(X+=`<br/><span class="text-sm text-amber-700">${R.NATURE_OPE}</span>`),R.AUTEUR&&(X+=`<br/><span class="text-xs text-gray-600">Auteur: ${R.AUTEUR}</span>`),R.DATE&&(X+=`<br/><span class="text-xs text-gray-500">Datum: ${R.DATE}</span>`),R.COMMUNE&&(X+=`<br/><span class="text-xs text-gray-500">${R.COMMUNE}</span>`)),R.type_protection&&(R.n_site||R.t_site)){const re=R.type_protection==="Classe"?"text-red-700":"text-amber-700";X+=`<br/><span class="text-sm ${re}">${R.type_protection}</span>`,R.n_site&&(X+=`<br/><span class="text-sm font-semibold">${R.n_site}</span>`),R.t_site&&(X+=`<br/><span class="text-xs text-gray-600">${R.t_site}</span>`),R.c_site&&(X+=`<br/><span class="text-xs text-gray-500">Code: ${R.c_site}</span>`),R.d_creation&&(X+=`<br/><span class="text-xs text-gray-400">Beschermd sinds: ${R.d_creation}</span>`)}if(R.type_protection&&R.cod_diren){const re=R.type_protection==="Classe"?"text-red-700":"text-amber-700";if(X+=`<br/><span class="text-sm ${re}">${R.type_protection}</span>`,R.proced&&(X+=`<br/><span class="text-xs text-gray-600">${R.proced}</span>`),R.d_proced&&(X+=`<br/><span class="text-xs text-gray-500">Date: ${R.d_proced}</span>`),R.comment){const z=String(R.comment).slice(0,150);X+=`<br/><span class="text-xs text-gray-600 italic">${z}${String(R.comment).length>150?"...":""}</span>`}}if(R.type_protection&&R.nomsite){const re=R.type_protection==="Classe"?"text-red-700":"text-amber-700";if(X+=`<br/><span class="text-sm ${re}">${R.type_protection}</span>`,R.caractere&&(X+=`<br/><span class="text-xs text-gray-600">${R.caractere}</span>`),R.datedecis&&(X+=`<br/><span class="text-xs text-gray-500">Date: ${R.datedecis}</span>`),R.descriptio){const z=String(R.descriptio).slice(0,150);X+=`<br/><span class="text-xs text-gray-600 italic">${z}${String(R.descriptio).length>150?"...":""}</span>`}}if(R.secteur&&R.style){if(X+=`<br/><span class="text-sm text-gray-700">${R.secteur}</span>`,R["sous-secteur"]&&(X+=`<br/><span class="text-xs text-gray-600">${R["sous-secteur"]}</span>`),R.description){const re=String(R.description).slice(0,150);X+=`<br/><span class="text-xs text-gray-600 italic">${re}${String(R.description).length>150?"...":""}</span>`}R.url&&(X+=`<br/><a href="${R.url}" target="_blank" class="text-xs text-blue-600 hover:underline">Meer info</a>`)}if(R.nature_operation||R.synthese){R.nature_operation&&(X+=`<br/><span class="text-sm text-red-700">${R.nature_operation}</span>`),R.responsable_operation&&(X+=`<br/><span class="text-xs text-gray-600">Responsable: ${R.responsable_operation}</span>`),R.date_operation&&(X+=`<br/><span class="text-xs text-gray-500">Datum: ${R.date_operation}</span>`);const re=[];if(R.prehistoire==="Oui"&&re.push("Prehistorie"),R.protohistoire==="Oui"&&re.push("Protohistorie"),R.antiquite==="Oui"&&re.push("Romeins"),R.moyen_age==="Oui"&&re.push("Middeleeuwen"),R.temps_modernes==="Oui"&&re.push("Moderne tijd"),re.length>0&&(X+=`<br/><span class="text-sm text-purple-700">${re.join(", ")}</span>`),R.adresse&&(X+=`<br/><span class="text-xs text-gray-500">${R.adresse}</span>`),R.synthese){const z=String(R.synthese).slice(0,200);X+=`<br/><span class="text-xs text-gray-600 italic">${z}${String(R.synthese).length>200?"...":""}</span>`}}if(R.operator&&(X+=`<br/><span class="text-sm text-gray-600">${R.operator}</span>`),R.opening_hours){const re=oEe(String(R.opening_hours));X+=`<br/><span class="text-xs text-green-600">Open: ${re}</span>`}if(R.website&&(X+=`<br/><a href="${R.website}" target="_blank" class="text-xs text-blue-600 underline">Website</a>`),R.addr_street){const re=[R.addr_street,R.addr_housenumber,R.addr_postcode].filter(Boolean).join(" ");X+=`<br/><span class="text-xs text-gray-500">${re}</span>`}const Ot=R.description||R.omschrijving||R.descr||R.info;Ot&&Ot!==Et&&(X+=`<br/><span class="text-sm text-gray-600">${Ot}</span>`),gt.push(X)}const nn=n.getView().getResolution()||1,Ut=await Fe(Qe.coordinate,nn);gt.push(...Ut);const De=await yt;if(gt.length===0&&De!==null){const Xt=`<strong class="text-blue-800">Terrein</strong>
          <br/><div class="mt-2 pt-2 border-t border-gray-100 flex items-center gap-1">
            <span class="text-xs text-gray-400">Hoogte:</span>
            <span class="text-sm font-medium text-blue-600">${De.toFixed(2)} m NAP</span>
          </div>`;gt.push(Xt)}if(gt.length>0&&De!==null&&(gt[0]+=`<br/><div class="mt-2 pt-2 border-t border-gray-100 flex items-center gap-1">
          <span class="text-xs text-gray-400">Hoogte:</span>
          <span class="text-sm font-medium text-blue-600">${De.toFixed(2)} m NAP</span>
        </div>`),gt.length>0){s(gt),o(0),console.log(` KLIK OPGESLAGEN: [${Qe.coordinate[0].toFixed(0)}, ${Qe.coordinate[1].toFixed(0)}]`),f(Qe.coordinate),p(!1),D(!1),k(null);const Xt=fn(Qe.coordinate);M(Xt),P(`https://www.google.com/maps/dir/?api=1&destination=${Xt[1]},${Xt[0]}`),u(!0)}};return n.on("click",je),()=>{n.un("click",je)}},[n]);const fe=()=>{u(!1),n&&g&&(OI(n),p(!1))},Oe=(Se,Fe)=>{Fe.offset.y>100&&fe()};return y.jsx(Yr,{children:l&&y.jsxs(y.Fragment,{children:[y.jsx(Kt.div,{className:"fixed inset-0 z-[1500]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:fe}),y.jsxs(Kt.div,{className:"fixed bottom-0 left-0 right-0 z-[1501] bg-white rounded-t-2xl shadow-2xl",style:{fontSize:`${14*j/100}px`},initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",damping:25,stiffness:300},drag:"y",dragConstraints:{top:0},dragElastic:.2,onDragEnd:Oe,children:[y.jsx("div",{className:"flex justify-center pt-2 pb-1",children:y.jsx("div",{className:"w-10 h-1 bg-gray-300 rounded-full"})}),y.jsxs("div",{className:"flex items-center gap-2 px-3 pb-2 border-b border-gray-100",children:[Te&&y.jsxs("div",{className:"flex items-center gap-0.5 flex-shrink-0",children:[y.jsx("button",{onClick:V,className:"p-1 text-blue-500 hover:text-blue-600 transition-colors border-0 outline-none bg-transparent","aria-label":"Vorige laag",children:y.jsx(zse,{size:18})}),y.jsxs("span",{className:"text-gray-500 font-medium min-w-[32px] text-center",style:{fontSize:"0.857em"},children:[a+1,"/",i.length]}),y.jsx("button",{onClick:ie,className:"p-1 text-blue-500 hover:text-blue-600 transition-colors border-0 outline-none bg-transparent","aria-label":"Volgende laag",children:y.jsx(ME,{size:18})})]}),y.jsx("span",{className:"flex-1 font-semibold text-gray-800 truncate",style:{fontSize:"1em"},children:Re||"Info"}),C&&t.filter(Se=>!Se.archived).length>0&&y.jsxs("div",{className:"relative",children:[y.jsx("button",{onClick:()=>D(!N),className:`p-1.5 transition-colors flex-shrink-0 border-0 outline-none bg-transparent ${B?"text-green-500":"text-orange-500 hover:text-orange-600"}`,title:"Toevoegen aan mijn laag","aria-label":"Toevoegen aan mijn laag",children:B?y.jsx(v1,{size:18}):y.jsx(Go,{size:18})}),N&&y.jsxs("div",{className:"absolute right-0 top-8 z-50 bg-white rounded-lg shadow-lg border border-gray-100 py-1 min-w-[180px]",children:[y.jsx("div",{className:"px-3 py-1.5 text-xs text-gray-400 font-medium",children:"Toevoegen aan:"}),t.filter(Se=>!Se.archived).map(Se=>y.jsxs("button",{onClick:()=>{r(Se.id,{name:Re||"Punt",category:"Overig",notes:"",url:void 0,coordinates:[C[0],C[1]],sourceLayer:Re}),D(!1),k(Se.name),setTimeout(()=>k(null),2e3)},className:"w-full px-3 py-1.5 text-left text-sm text-gray-700 hover:bg-orange-50 flex items-center gap-2",children:[y.jsx("div",{className:"w-2.5 h-2.5 rounded-full flex-shrink-0",style:{backgroundColor:Se.color}}),y.jsx("span",{className:"truncate",children:Se.name})]},Se.id))]})]}),I&&y.jsx("a",{href:I,target:"_blank",rel:"noopener noreferrer",className:"p-1.5 text-blue-500 hover:text-blue-600 transition-colors flex-shrink-0",title:"Open in Google Maps","aria-label":"Open in Google Maps",children:y.jsx(E1,{size:18})}),y.jsx("button",{onClick:fe,className:"p-1.5 text-gray-400 hover:text-gray-600 transition-colors flex-shrink-0 border-0 outline-none bg-transparent","aria-label":"Sluiten",children:y.jsx(Aa,{size:18})})]}),y.jsx("div",{className:"px-4 py-3 max-h-[45vh] overflow-y-auto select-text",style:{userSelect:"text",WebkitUserSelect:"text"},dangerouslySetInnerHTML:{__html:be}}),y.jsxs("div",{className:"px-4 py-2 border-t border-gray-100 flex items-center gap-2",children:[y.jsx(ioe,{size:14,className:"text-gray-400 flex-shrink-0"}),y.jsx("input",{type:"range",min:"80",max:"150",value:j,onChange:Se=>W(parseInt(Se.target.value)),className:"flex-1 h-1.5 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500"}),y.jsxs("span",{className:"text-gray-400 w-8 text-right",style:{fontSize:"0.857em"},children:[j,"%"]})]}),te&&w&&y.jsx("div",{className:"px-4 pb-4",children:y.jsxs("button",{onClick:()=>{e(w),u(!1),T(null)},className:"w-full flex items-center justify-center gap-2 px-3 py-2 text-white bg-red-500 hover:bg-red-600 rounded-lg transition-colors border-0 outline-none",children:[y.jsx(B0,{size:16}),y.jsx("span",{children:"Vondst verwijderen"})]})}),ce&&h&&y.jsx("div",{className:"px-4 pb-4 border-t border-gray-100",children:g?y.jsxs("button",{onClick:ee,className:"w-full flex items-center justify-center gap-2 px-3 py-2 mt-3 text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors border-0 outline-none",children:[y.jsx(xI,{size:16}),y.jsx("span",{children:"Hoogtekaart verbergen"})]}):y.jsx("button",{onClick:ne,disabled:E,className:`w-full flex items-center justify-center gap-2 px-3 py-2 mt-3 text-white rounded-lg transition-colors border-0 outline-none ${E?"bg-blue-400 cursor-wait":"bg-blue-500 hover:bg-blue-600"}`,children:E?y.jsxs(y.Fragment,{children:[y.jsx(yR,{size:16,className:"animate-spin"}),y.jsx("span",{children:"Laden..."})]}):y.jsxs(y.Fragment,{children:[y.jsx(xI,{size:16}),y.jsx("span",{children:"Hoogtekaart tonen"})]})})})]})]})})}function dEe(){const n=As(B=>B.map),e=Fi(B=>B.openVondstForm),{openAddPointModal:t,openCreateLayerModal:r}=Fi(),i=qs(B=>B.layers),[s,a]=se.useState(null),[o,l]=se.useState(!1),[u,h]=se.useState(!1),[f,g]=se.useState(!1),p=se.useRef(null),E=se.useRef(null);se.useEffect(()=>{if(!n){console.log(" LongPressMenu: map not ready");return}const B=n.getViewport();if(!B){console.log(" LongPressMenu: viewport not ready");return}console.log(" LongPressMenu: attached to viewport",B);const k=600,C=15,M=Le=>{if(console.log(" Touch start, touches:",Le.touches.length),Le.touches.length!==1)return;const Re=Le.touches[0];E.current={x:Re.clientX,y:Re.clientY},console.log(" Starting long press timer at:",E.current),p.current&&clearTimeout(p.current),p.current=window.setTimeout(()=>{if(console.log(" Timer fired! startPos:",E.current),!E.current)return;const ue=window.__olMap;if(!ue){console.log(" Map not available (global)");return}const be=B.getBoundingClientRect(),ce=[E.current.x-be.left,E.current.y-be.top],te=ue.getCoordinateFromPixel(ce);if(te){const V=fn(te);Le.preventDefault(),a({pixel:[E.current.x,E.current.y],coordinate:V}),l(!0),h(!1),setTimeout(()=>h(!0),300),"vibrate"in navigator&&navigator.vibrate(50),console.log(" Long press detected at:",V)}},k)},j=Le=>{if(!p.current||!E.current)return;const Re=Le.touches[0],ue=Re.clientX-E.current.x,be=Re.clientY-E.current.y,ce=Math.sqrt(ue*ue+be*be);ce>C&&(console.log(" Touch moved too much, cancelling. Distance:",ce),clearTimeout(p.current),p.current=null)},O=()=>{console.log(" Touch end, timer active:",!!p.current),p.current&&(console.log(" Cancelling timer on touch end"),clearTimeout(p.current),p.current=null),E.current=null},W=Le=>{o&&Le.preventDefault()},F=Le=>{Le.button===0&&(console.log(" Mouse down"),E.current={x:Le.clientX,y:Le.clientY},p.current&&clearTimeout(p.current),p.current=window.setTimeout(()=>{if(console.log(" Mouse timer fired!"),!E.current)return;const Re=window.__olMap;if(console.log(" __olMap:",Re),console.log(" __olMap constructor:",Re?.constructor?.name),console.log(" has getCoordinateAtPixel:",typeof Re?.getCoordinateAtPixel),!Re){console.log(" Map not available (global)");return}const ue=B.getBoundingClientRect(),be=[E.current.x-ue.left,E.current.y-ue.top];console.log(" Pixel:",be);const ce=Re.getCoordinateFromPixel(be);if(console.log(" Coordinate:",ce),ce){const te=fn(ce);a({pixel:[E.current.x,E.current.y],coordinate:te}),l(!0),h(!1),setTimeout(()=>h(!0),300),console.log(" Long press (mouse) detected at:",te)}},k))},Te=Le=>{if(!p.current||!E.current)return;const Re=Le.clientX-E.current.x,ue=Le.clientY-E.current.y;Math.sqrt(Re*Re+ue*ue)>C&&(console.log(" Mouse moved, cancelling"),clearTimeout(p.current),p.current=null)},Me=()=>{console.log(" Mouse up"),p.current&&(clearTimeout(p.current),p.current=null),E.current=null};return B.addEventListener("touchstart",M,{passive:!1}),B.addEventListener("touchmove",j,{passive:!0}),B.addEventListener("touchend",O),B.addEventListener("touchcancel",O),B.addEventListener("contextmenu",W),B.addEventListener("mousedown",F),B.addEventListener("mousemove",Te),B.addEventListener("mouseup",Me),B.addEventListener("mouseleave",Me),()=>{B.removeEventListener("touchstart",M),B.removeEventListener("touchmove",j),B.removeEventListener("touchend",O),B.removeEventListener("touchcancel",O),B.removeEventListener("contextmenu",W),B.removeEventListener("mousedown",F),B.removeEventListener("mousemove",Te),B.removeEventListener("mouseup",Me),B.removeEventListener("mouseleave",Me),p.current&&clearTimeout(p.current)}},[n,o]);const x=()=>{u&&(l(!1),a(null),h(!1),g(!1))},w=()=>{l(!1),a(null),h(!1),g(!1)},T=B=>{if(!s)return;const[k,C]=s.coordinate;t(B,{lat:C,lng:k}),w()},I=()=>{r(),w()},P=()=>{if(!s)return;const[B,k]=s.coordinate;e({lat:k,lng:B}),l(!1),a(null),h(!1)},N=()=>{if(!s)return;const[B,k]=s.coordinate,C=`https://www.google.com/maps?q=${k},${B}`;window.open(C,"_blank"),l(!1),a(null),h(!1)},D=B=>{const[k,C]=B;return`${C.toFixed(5)}N, ${k.toFixed(5)}E`};return y.jsx(Yr,{children:o&&s&&y.jsxs(y.Fragment,{children:[y.jsx(Kt.div,{className:"fixed inset-0 z-[1600]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:x}),y.jsxs(Kt.div,{className:"fixed z-[1601] bg-white rounded-xl shadow-md overflow-hidden min-w-[200px] border-0 outline-none",style:{left:Math.min(s.pixel[0],window.innerWidth-220),top:Math.min(s.pixel[1],window.innerHeight-240)},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.15},children:[y.jsx("div",{className:"px-4 py-3 bg-gradient-to-r from-blue-500 to-blue-600",children:y.jsxs("div",{className:"flex items-center gap-2 text-white",children:[y.jsx(fu,{size:16}),y.jsx("span",{className:"text-xs font-mono",children:D(s.coordinate)})]})}),y.jsxs("div",{className:"bg-white",children:[y.jsxs("button",{onClick:P,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-blue-50 text-gray-700 bg-white border-0 outline-none",children:[y.jsx(Go,{size:20,className:"text-blue-500"}),y.jsx("span",{className:"font-medium",children:"Vondst toevoegen"})]}),y.jsxs("div",{className:"relative",children:[y.jsxs("button",{onClick:()=>g(!f),className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-blue-50 text-gray-700 bg-white border-0 outline-none",children:[y.jsx(Ko,{size:20,className:"text-purple-500"}),y.jsx("span",{className:"font-medium flex-1 text-left",children:"Voeg toe aan laag..."}),y.jsx(ME,{size:16,className:`text-gray-400 transition-transform ${f?"rotate-90":""}`})]}),y.jsx(Yr,{children:f&&y.jsx(Kt.div,{className:"bg-gray-50 border-t border-gray-100",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},children:i.length===0?y.jsxs("button",{onClick:I,className:"w-full px-4 py-2 pl-11 flex items-center gap-2 text-sm text-purple-600 hover:bg-purple-50 bg-transparent border-0 outline-none",children:[y.jsx(Go,{size:14}),y.jsx("span",{children:"Maak eerst een laag aan"})]}):y.jsxs(y.Fragment,{children:[i.map(B=>y.jsxs("button",{onClick:()=>T(B.id),className:"w-full px-4 py-2 pl-11 flex items-center gap-2 text-sm text-gray-700 hover:bg-gray-100 bg-transparent border-0 outline-none",children:[y.jsx("div",{className:"w-3 h-3 rounded-full flex-shrink-0",style:{backgroundColor:B.color}}),y.jsx("span",{className:"truncate",children:B.name}),y.jsxs("span",{className:"text-xs text-gray-400 ml-auto",children:["(",B.points.length,")"]})]},B.id)),y.jsxs("button",{onClick:I,className:"w-full px-4 py-2 pl-11 flex items-center gap-2 text-sm text-purple-600 hover:bg-purple-50 bg-transparent border-0 outline-none border-t border-gray-200",children:[y.jsx(Go,{size:14}),y.jsx("span",{children:"Nieuwe laag..."})]})]})})})]}),y.jsxs("button",{onClick:N,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-blue-50 text-gray-700 bg-white border-0 outline-none",children:[y.jsx(E1,{size:20,className:"text-blue-600"}),y.jsx("span",{className:"font-medium",children:"Open in Google Maps"})]})]}),y.jsx("div",{className:"bg-white",children:y.jsxs("button",{onClick:w,className:"w-full px-4 py-3 flex items-center justify-center gap-2 text-gray-500 hover:bg-blue-50 transition-colors bg-white border-0 outline-none",children:[y.jsx(Aa,{size:18}),y.jsx("span",{children:"Annuleren"})]})})]})]})})}function fEe(){return y.jsx("div",{className:"fixed bottom-2 left-[60px] z-[800] h-6 flex items-center px-1.5 bg-white/70 backdrop-blur-sm rounded shadow-sm text-[10px] font-mono text-gray-500",children:"v2.22.5"})}function $S({className:n}){return y.jsxs("svg",{viewBox:"0 0 24 24",className:n,width:"24",height:"24",children:[y.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),y.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),y.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),y.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]})}function gEe(){const{user:n,loading:e,signInWithGoogle:t,logout:r}=m1(),[i,s]=se.useState(!1);return e?y.jsx("div",{className:"fixed top-2 right-14 z-[800]",children:y.jsx("div",{className:"w-11 h-11 flex items-center justify-center opacity-50",children:y.jsx($S,{})})}):y.jsxs("div",{className:"fixed top-2 right-14 z-[800]",children:[y.jsx("button",{onClick:()=>s(!i),className:"w-11 h-11 flex items-center justify-center border-0 outline-none bg-transparent transition-opacity hover:opacity-80",title:n?`Ingelogd als ${n.displayName||n.email}`:"Niet ingelogd - klik om in te loggen",children:n?n.photoURL?y.jsx("img",{src:n.photoURL,alt:n.displayName||"User",className:"w-9 h-9 rounded-full",referrerPolicy:"no-referrer"}):y.jsx("div",{className:"w-9 h-9 rounded-full bg-green-500 flex items-center justify-center",children:y.jsx(Qx,{size:18,className:"text-white"})}):y.jsx("div",{className:"opacity-60 hover:opacity-100 transition-opacity",children:y.jsx($S,{})})}),y.jsx(Yr,{children:i&&y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"fixed inset-0 z-[799]",onClick:()=>s(!1)}),y.jsx(Kt.div,{initial:{opacity:0,y:-8,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-8,scale:.95},className:"absolute top-11 right-0 z-[801] bg-white rounded-lg shadow-lg border border-gray-100 py-1 min-w-[200px]",children:n?y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"px-3 py-2 border-b border-gray-100",children:y.jsxs("div",{className:"flex items-center gap-2",children:[n.photoURL?y.jsx("img",{src:n.photoURL,alt:n.displayName||"User",className:"w-10 h-10 rounded-full",referrerPolicy:"no-referrer"}):y.jsx("div",{className:"w-10 h-10 rounded-full bg-green-500 flex items-center justify-center",children:y.jsx(Qx,{size:18,className:"text-white"})}),y.jsxs("div",{className:"flex-1 min-w-0",children:[y.jsx("div",{className:"text-sm font-medium text-gray-800 truncate",children:n.displayName||"Gebruiker"}),y.jsx("div",{className:"text-xs text-green-600",children:"Cloud sync actief"})]})]})}),y.jsxs("button",{onClick:()=>{r(),s(!1)},className:"w-full px-3 py-2 text-left text-sm text-gray-600 hover:bg-red-50 hover:text-red-600 flex items-center gap-2 border-0 outline-none bg-transparent",children:[y.jsx(_R,{size:14}),"Uitloggen"]})]}):y.jsxs(y.Fragment,{children:[y.jsxs("div",{className:"px-3 py-2 border-b border-gray-100",children:[y.jsx("div",{className:"text-sm text-gray-600",children:"Niet ingelogd"}),y.jsx("div",{className:"text-xs text-gray-400",children:"Data alleen lokaal opgeslagen"})]}),y.jsxs("button",{onClick:()=>{t(),s(!1)},className:"w-full px-3 py-2.5 text-left text-sm text-gray-700 hover:bg-blue-50 flex items-center gap-3 border-0 outline-none bg-transparent",children:[y.jsx($S,{}),y.jsx("span",{children:"Inloggen met Google"})]})]})})]})})]})}const mEe={Compass:tae,TreePalm:noe,Mountain:xI,Waves:loe,Search:Tj,Target:Jae,Layers:Ko,Grid:fae},pEe={Compass:"text-purple-600",Waves:"text-cyan-600",TreePalm:"text-green-600",Mountain:"text-stone-600",Search:"text-amber-600",Target:"text-red-600",Layers:"text-blue-600",Grid:"text-lime-600"},yEe={Compass:"hover:bg-purple-50",Waves:"hover:bg-cyan-50",TreePalm:"hover:bg-green-50",Mountain:"hover:bg-stone-50",Search:"hover:bg-amber-50",Target:"hover:bg-red-50",Layers:"hover:bg-blue-50",Grid:"hover:bg-lime-50"},MO=["Labels Overlay","TMK 1850","Bonnebladen 1900","Hunebedden","FAMKE Steentijd","Grafheuvels","Terpen","AMK Monumenten","AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig","Romeinse wegen (regio)","Romeinse wegen (Wereld)","Kastelen","IKAW","Archeo Landschappen","Rijksmonumenten","Werelderfgoed","Religieus Erfgoed","Essen","WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Inundatiegebieden","Militaire Objecten","Paleokaart 800 n.Chr.","Paleokaart 100 n.Chr.","Paleokaart 500 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 9000 v.Chr.","UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling","AHN4 Hoogtekaart Kleur","AHN4 Hillshade NL","AHN4 Multi-Hillshade NL","AHN 0.5m","Veengebieden","Geomorfologie","Bodemkaart","Fossielen Nederland","Fossielen Belgi","Fossielen Duitsland","Fossielen Frankrijk","Parken","Speeltuinen","Musea","Strandjes","Gewaspercelen","Kadastrale Grenzen","Scheepswrakken","Woonheuvels ZH","Romeinse Forten","Windmolens","Erfgoedlijnen","Oude Kernen","Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken","Verdronken Dorpen"],_Ee=["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"];function xEe(){const n=ii(w=>w.setLayerVisibility),e=qi(w=>w.stopTracking),{presetsPanelOpen:t,togglePresetsPanel:r,toggleSettingsPanel:i,closeAllPanels:s}=Fi(),{presets:a,applyPreset:o,updatePreset:l}=B8(),u=ii(w=>w.visible),h=Ti(w=>w.presetPanelFontScale),f=Ti(w=>w.setPresetPanelFontScale),g=12*h/100,p=()=>{s(),MO.forEach(w=>n(w,!1)),_Ee.forEach(w=>{n(w,w==="CartoDB (licht)")}),e(),console.log(" Reset: CartoDB (licht), alle lagen uit, GPS uit")},E=w=>{o(w),s()},x=(w,T)=>{w.stopPropagation();const I=Object.entries(u).filter(([P,N])=>N&&MO.includes(P)).map(([P])=>P);l(T,{layers:I}),console.log(" Lagen opgeslagen naar preset")};return y.jsxs(y.Fragment,{children:[y.jsx("button",{onClick:i,className:"fixed bottom-2 left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",title:"Instellingen",children:y.jsx(EI,{size:22,className:"text-gray-600"})}),y.jsx("button",{onClick:p,className:"fixed bottom-[60px] left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",title:"Reset - CartoDB, alle lagen uit, GPS uit",children:y.jsx(Vae,{size:22,className:"text-gray-600"})}),y.jsx("button",{onClick:r,className:"fixed bottom-[112px] left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",title:"Presets",children:t?y.jsx(wj,{size:22,className:"text-blue-600"}):y.jsx(Ko,{size:22,className:"text-blue-600"})}),y.jsx(Yr,{children:t&&y.jsxs(y.Fragment,{children:[y.jsx(Kt.div,{className:"fixed inset-0 z-[800]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:r}),y.jsxs(Kt.div,{initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.95},transition:{duration:.15},className:"fixed bottom-[112px] left-[56px] bg-white/95 rounded-xl shadow-lg overflow-hidden w-[220px] backdrop-blur-sm z-[801]",children:[y.jsxs("div",{className:"flex items-center justify-between gap-2 px-3 py-1.5 bg-gradient-to-r from-blue-500 to-blue-600 text-white",children:[y.jsx("span",{className:"text-xs font-medium",children:"Presets"}),y.jsxs("div",{className:"flex items-center gap-1",children:[y.jsx("span",{className:"text-[9px] opacity-70",children:"T"}),y.jsx("input",{type:"range",min:"80",max:"130",step:"10",value:h,onInput:w=>{f(parseInt(w.target.value))},onChange:w=>f(parseInt(w.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${h}%`}),y.jsx("span",{className:"text-[11px] opacity-70",children:"T"})]})]}),y.jsx("div",{className:"p-2",children:a.map(w=>{const T=mEe[w.icon]||Ko,I=pEe[w.icon]||"text-blue-600",P=yEe[w.icon]||"hover:bg-blue-50";return y.jsxs("button",{onClick:()=>E(w.id),className:`w-full h-8 flex items-center gap-2 px-2 ${P} rounded text-left transition-colors border-0 outline-none bg-transparent overflow-hidden`,style:{fontSize:`${g}px`},children:[y.jsx(T,{size:14,className:`${I} flex-shrink-0`}),y.jsx("span",{className:"text-gray-700 truncate",children:w.name}),y.jsx("span",{onClick:N=>x(N,w.id),className:"ml-auto p-1 hover:bg-gray-200 rounded transition-colors flex-shrink-0",title:"Huidige lagen opslaan naar deze preset",children:y.jsx(zae,{size:12,className:"text-gray-400 hover:text-blue-500"})})]},w.id)})})]})]})})]})}const vEe="https://forms.gle/R5LCk11Bzu5XrkBj8";function EEe(){const{infoPanelOpen:n,toggleInfoPanel:e}=Fi(),[t,r]=se.useState("info"),i=[{id:"info",label:"Info",icon:y.jsx(mL,{size:14})},{id:"functies",label:"Functies",icon:y.jsx(pR,{size:14})},{id:"handleiding",label:"Handleiding",icon:y.jsx(Ose,{size:14})}];return y.jsxs(y.Fragment,{children:[y.jsx("button",{onClick:e,className:"fixed top-2 right-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",title:"Info & Help",children:y.jsx(mL,{size:22,className:"text-gray-600"})}),y.jsx(Yr,{children:n&&y.jsxs(y.Fragment,{children:[y.jsx(Kt.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),y.jsxs(Kt.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[y.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white",children:[y.jsx("span",{className:"font-medium",children:"DetectorApp NL"}),y.jsx("button",{onClick:e,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none",children:y.jsx(Aa,{size:18})})]}),y.jsx("div",{className:"flex border-b border-gray-200",children:i.map(s=>y.jsxs("button",{onClick:()=>r(s.id),className:`flex-1 flex items-center justify-center gap-1.5 px-3 py-2.5 text-sm font-medium transition-colors border-0 outline-none ${t===s.id?"text-blue-600 border-b-2 border-blue-600 bg-blue-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[s.icon,s.label]},s.id))}),y.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 text-sm",children:[t==="info"&&y.jsx(wEe,{}),t==="functies"&&y.jsx(SEe,{}),t==="handleiding"&&y.jsx(TEe,{}),y.jsxs("section",{className:"pt-2 border-t border-gray-200 space-y-2",children:[y.jsxs("a",{href:vEe,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 w-full px-3 py-2 text-orange-600 hover:bg-orange-50 rounded-lg transition-colors",children:[y.jsx(vj,{size:14}),y.jsx("span",{className:"text-sm",children:"Meld een bug"})]}),y.jsx("p",{className:"text-xs text-gray-400 text-center",children:"DetectorApp NL v2.22.5"})]})]})]})]})})]})}function wEe(){return y.jsxs(y.Fragment,{children:[y.jsxs("section",{children:[y.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Over deze app"}),y.jsx("p",{className:"text-gray-600",children:"DetectorApp NL is d kaartapplicatie voor metaaldetectie en archeologische verkenning in Nederland. Met 60+ kaartlagen, GPS tracking met richtingspijl en vondstenbeheer."})]}),y.jsxs("section",{children:[y.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Databronnen & Licenties"}),y.jsxs("ul",{className:"space-y-2 text-gray-600",children:[y.jsxs("li",{children:[y.jsx("strong",{children:"RCE / Cultureelerfgoed.nl"})," (CC0/CC-BY)",y.jsx("br",{}),y.jsx("span",{className:"text-xs",children:"AMK, Rijksmonumenten, Werelderfgoed, Paleokaarten, Religieus Erfgoed, Essen"})]}),y.jsxs("li",{children:[y.jsx("strong",{children:"PDOK / Kadaster"})," (CC0/CC-BY)",y.jsx("br",{}),y.jsx("span",{className:"text-xs",children:"Luchtfoto, AHN, IKAW, Bodemkaart, Geomorfologie, Kadastrale Grenzen"})]}),y.jsxs("li",{children:[y.jsx("strong",{children:"OpenStreetMap"})," (ODbL)",y.jsx("br",{}),y.jsx("span",{className:"text-xs",children:"Hunebedden, Grafheuvels, Bunkers, Kastelen, Parken, Kringloopwinkels, Musea"})]}),y.jsxs("li",{children:[y.jsx("strong",{children:"Itiner-E"})," (CC BY 4.0)",y.jsx("br",{}),y.jsx("span",{className:"text-xs",children:"Romeinse wegen - Brughmans, Paout, de Soto & Bjerregaard Vahlstrup"})]}),y.jsxs("li",{children:[y.jsx("strong",{children:"CARTO"})," (CC BY 3.0)",y.jsx("br",{}),y.jsx("span",{className:"text-xs",children:"CartoDB basiskaart"})]}),y.jsxs("li",{children:[y.jsx("strong",{children:"Map5.nl / Kadaster"}),y.jsx("br",{}),y.jsx("span",{className:"text-xs",children:"Historische kaarten (TMK 1850, Bonnebladen 1900)"})]}),y.jsxs("li",{children:[y.jsx("strong",{children:"Provinciale data"}),y.jsx("br",{}),y.jsx("span",{className:"text-xs",children:"Relictenkaart (Gelderland), Scheepswrakken (Zuid-Holland), Verdronken Dorpen (Zeeland)"})]}),y.jsxs("li",{children:[y.jsx("strong",{children:"UIKAV / Rijkswaterstaat"}),y.jsx("br",{}),y.jsx("span",{className:"text-xs",children:"Uiterwaarden archeologische data"})]})]})]}),y.jsxs("section",{children:[y.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Privacy"}),y.jsxs("div",{className:"text-gray-600 space-y-2",children:[y.jsxs("p",{children:[y.jsx("strong",{children:"Locatiegegevens:"})," Alleen voor navigatie, niet opgeslagen of gedeeld."]}),y.jsxs("p",{children:[y.jsx("strong",{children:"Geen tracking:"})," Geen analytics of gebruiksstatistieken."]}),y.jsxs("p",{children:[y.jsx("strong",{children:"Lokale opslag:"})," Alle data blijft op je apparaat."]})]})]})]})}function SEe(){return y.jsxs(y.Fragment,{children:[y.jsxs("section",{children:[y.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[y.jsx(xR,{size:16,className:"text-blue-600"}),"Kaartlagen (60+)"]}),y.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[y.jsxs("li",{children:[y.jsx("strong",{children:"Basis:"})," CartoDB, OpenStreetMap, PDOK Luchtfoto"]}),y.jsxs("li",{children:[y.jsx("strong",{children:"Historisch:"})," TMK 1850, Bonnebladen 1900"]}),y.jsxs("li",{children:[y.jsx("strong",{children:"Hoogtekaarten:"})," AHN4 Hillshade, Multi-Hillshade, Hoogtekaart Kleur, AHN 0.5m"]}),y.jsxs("li",{children:[y.jsx("strong",{children:"Archeologie:"})," AMK Monumenten (per periode), Romeinse wegen, Kastelen, IKAW"]}),y.jsxs("li",{children:[y.jsx("strong",{children:"Prehistorie:"})," Hunebedden, Grafheuvels, Terpen, Paleokaarten (7 periodes)"]}),y.jsxs("li",{children:[y.jsx("strong",{children:"Militair:"})," WWII Bunkers, Slagvelden, Vliegvelden, Verdedigingslinies"]}),y.jsxs("li",{children:[y.jsx("strong",{children:"Terrein:"})," Veengebieden, Geomorfologie, Bodemkaart"]}),y.jsxs("li",{children:[y.jsx("strong",{children:"Percelen:"})," Gewaspercelen, Kadastrale Grenzen"]}),y.jsxs("li",{children:[y.jsx("strong",{children:"Recreatie:"})," Parken, Musea, Kringloopwinkels, Strandjes"]}),y.jsxs("li",{children:[y.jsx("strong",{children:"Provinciaal:"})," Relictenkaart, Scheepswrakken, Verdronken Dorpen"]})]})]}),y.jsxs("section",{children:[y.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[y.jsx(vR,{size:16,className:"text-green-600"}),"GPS Tracking"]}),y.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[y.jsx("li",{children:"Live GPS tracking met nauwkeurigheidscirkel"}),y.jsx("li",{children:"Richtingspijl draait mee met je telefoon (zoals Google Maps)"}),y.jsx("li",{children:"Kaart handmatig draaien + kompasknop om terug te draaien naar noorden"}),y.jsx("li",{children:"Schaalbalk onderaan (instelbaar in Instellingen)"}),y.jsx("li",{children:'Open locatie in Google Maps (long-press  "Open in Google Maps")'})]})]}),y.jsxs("section",{children:[y.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[y.jsx(fu,{size:16,className:"text-orange-600"}),"Vondsten"]}),y.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[y.jsx("li",{children:"Toevoegen via GPS, long-press of handmatig"}),y.jsx("li",{children:"Velden: type, materiaal, periode, diepte, conditie, gewicht, foto-link"}),y.jsx("li",{children:"Export: Excel, CSV, GeoJSON, GPX, KML"}),y.jsx("li",{children:"Dashboard met statistieken"}),y.jsx("li",{children:"Lokale opslag (geen account nodig)"})]})]}),y.jsxs("section",{children:[y.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[y.jsx(Ko,{size:16,className:"text-purple-600"}),"Presets"]}),y.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[y.jsx("li",{children:"Detectie, Steentijd, Romeins, Middeleeuwen, WOII, Analyse, Fossielen"}),y.jsx("li",{children:"Alle presets zijn aanpasbaar - klik op het diskette-icoon om huidige lagen op te slaan"}),y.jsx("li",{children:"Eigen presets aanmaken via Instellingen"}),y.jsx("li",{children:"Tekstgrootte per panel instelbaar via slider in header"})]})]}),y.jsxs("section",{children:[y.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[y.jsx(kae,{size:16,className:"text-cyan-600"}),"Perceelinformatie"]}),y.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[y.jsx("li",{children:'Zet "Kadastrale Grenzen" aan en tik op een perceel'}),y.jsx("li",{children:"Toont: kadastrale aanduiding (gemeente, sectie, nummer) + oppervlakte"}),y.jsx("li",{children:"Link naar eigenaar opzoeken (betaalde dienst)"}),y.jsx("li",{children:"Hoogtekaart per perceel (AHN4)"})]})]})]})}function TEe(){return y.jsxs(y.Fragment,{children:[y.jsxs("section",{children:[y.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Eerste stappen"}),y.jsxs("ol",{className:"text-gray-600 space-y-2 text-xs list-decimal list-inside",children:[y.jsxs("li",{children:["Tik op de ",y.jsx("strong",{children:"GPS knop"})," (rechtsonder) om je locatie te zien"]}),y.jsxs("li",{children:["Kies een ",y.jsx("strong",{children:"preset"})," (links, laagjes-icoon) of selecteer kaartlagen handmatig"]}),y.jsxs("li",{children:["Tik op de ",y.jsx("strong",{children:"Kaartlagen knop"})," voor alle beschikbare lagen"]})]})]}),y.jsxs("section",{children:[y.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"GPS knop"}),y.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[y.jsxs("p",{children:[y.jsx("strong",{children:"Uit (grijs icoon):"})," GPS tracking uit, geen locatie zichtbaar."]}),y.jsxs("p",{children:[y.jsx("strong",{children:"Aan (blauw icoon):"})," GPS tracking aan, je locatie en richting worden getoond."]}),y.jsxs("p",{children:[y.jsx("strong",{children:"Richtingspijl:"})," De blauwe pijl draait vloeiend mee met de richting van je telefoon."]}),y.jsxs("p",{children:[y.jsx("strong",{children:"Kompasknop:"})," Verschijnt rechtsboven als de kaart gedraaid is. Tik om terug naar noorden te draaien."]})]})]}),y.jsxs("section",{children:[y.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Vondst toevoegen"}),y.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[y.jsxs("p",{children:[y.jsx("strong",{children:"Methode 1 - GPS:"})," Tik op de oranje + knop rechtsonder. Je huidige locatie wordt automatisch ingevuld."]}),y.jsxs("p",{children:[y.jsx("strong",{children:"Methode 2 - Long-press:"}),' Houd je vinger lang op de kaart. Kies "Vondst toevoegen" in het menu.']}),y.jsxs("p",{children:[y.jsx("strong",{children:"Methode 3 - Handmatig:"}),' In het vondstenformulier, tik "Kies op kaart" en selecteer de exacte locatie.']})]})]}),y.jsxs("section",{children:[y.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Presets gebruiken"}),y.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[y.jsxs("p",{children:[y.jsx("strong",{children:"Toepassen:"})," Tik op het laagjes-icoon links en kies een preset."]}),y.jsxs("p",{children:[y.jsx("strong",{children:"Snel opslaan:"})," Zet de gewenste lagen aan en tik op het diskette-icoon naast een preset om die te overschrijven."]}),y.jsxs("p",{children:[y.jsx("strong",{children:"Nieuw aanmaken:"}),' Ga naar Instellingen  Presets  "Huidige lagen als preset opslaan".']}),y.jsxs("p",{children:[y.jsx("strong",{children:"Tekstgrootte:"})," Gebruik de slider in de header van het Presets/Kaartlagen panel."]})]})]}),y.jsxs("section",{children:[y.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Zoeken & Navigatie"}),y.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[y.jsxs("p",{children:[y.jsx("strong",{children:"Zoeken:"})," Gebruik de zoekbalk bovenaan om een adres te vinden."]}),y.jsxs("p",{children:[y.jsx("strong",{children:"Google Maps:"}),' Long-press op een locatie en kies "Open in Google Maps" om te navigeren.']}),y.jsxs("p",{children:[y.jsx("strong",{children:"Schaalbalk:"})," Onderaan de kaart - aan/uit in Instellingen."]})]})]}),y.jsxs("section",{children:[y.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Tips voor in het veld"}),y.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs list-disc list-inside",children:[y.jsxs("li",{children:["Gebruik ",y.jsx("strong",{children:"AHN Hillshade"})," om relif te zien (grafheuvels, wallen)"]}),y.jsxs("li",{children:["Combineer ",y.jsx("strong",{children:"AMK"})," met ",y.jsx("strong",{children:"Gewaspercelen"})," voor detectie"]}),y.jsxs("li",{children:["Check de ",y.jsx("strong",{children:"IKAW"})," voor archeologische verwachting"]}),y.jsxs("li",{children:["Gebruik ",y.jsx("strong",{children:"historische kaarten"})," om oude structuren te vinden"]}),y.jsxs("li",{children:["Zet ",y.jsx("strong",{children:"GPS tracking"})," aan om je route te volgen"]}),y.jsx("li",{children:"Tik op objecten (bunkers, musea, etc.) voor openingstijden en info"})]})]}),y.jsxs("section",{children:[y.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[y.jsx(E1,{size:16,className:"text-blue-600"}),"Meer informatie"]}),y.jsx("p",{className:"text-gray-600 text-xs mb-2",children:"Uitleg over grondsoorten wordt direct in de popup getoond bij Bodemkaart en Gewaspercelen."}),y.jsxs("ul",{className:"text-gray-600 space-y-2 text-xs",children:[y.jsxs("li",{children:[y.jsx("a",{href:"https://legendageomorfologie.wur.nl/",target:"_blank",rel:"noopener",className:"text-blue-600 hover:underline font-medium",children:"Geomorfologie legenda (WUR)"}),y.jsx("br",{}),y.jsx("span",{className:"text-gray-500",children:"Uitgebreide uitleg over landvormen"})]}),y.jsxs("li",{children:[y.jsx("a",{href:"https://legenda-bodemkaart.bodemdata.nl/",target:"_blank",rel:"noopener",className:"text-blue-600 hover:underline font-medium",children:"Bodemkaart legenda (BRO)"}),y.jsx("br",{}),y.jsx("span",{className:"text-gray-500",children:"Volledige bodemclassificatie"})]})]})]})]})}function IEe(){const n=As(a=>a.map),[e,t]=se.useState(0),[r,i]=se.useState(!1);se.useEffect(()=>{if(!n)return;const a=n.getView(),o=()=>{const l=a.getRotation(),u=l*180/Math.PI;t(u),i(Math.abs(l)>.087)};return o(),a.on("change:rotation",o),()=>{a.un("change:rotation",o)}},[n]);const s=()=>{n&&n.getView().animate({rotation:0,duration:300})};return y.jsx(Yr,{children:r&&y.jsx(Kt.button,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.2},onClick:s,className:"fixed top-[60px] right-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",title:"Klik om noorden te herstellen",children:y.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",style:{transform:`rotate(${-e}deg)`},children:[y.jsx("path",{d:"M12 2 L14.5 12 L12 10 L9.5 12 Z",fill:"#EA4335"}),y.jsx("path",{d:"M12 22 L9.5 12 L12 14 L14.5 12 Z",fill:"white",stroke:"#9CA3AF",strokeWidth:"0.5"}),y.jsx("circle",{cx:"12",cy:"12",r:"2",fill:"#374151"})]})})})}const AEe=[{name:"AHN4 Hoogtekaart Kleur",color:"blue",default:.85},{name:"AHN4 Hillshade NL",color:"blue",default:.7},{name:"AHN4 Multi-Hillshade NL",color:"blue",default:.7},{name:"AHN 0.5m",color:"blue",default:.7},{name:"TMK 1850",color:"amber",default:.8},{name:"Bonnebladen 1900",color:"amber",default:.8},{name:"Geomorfologie",color:"green",default:.5},{name:"Bodemkaart",color:"amber",default:.6},{name:"Veengebieden",color:"amber",default:.6},{name:"IKAW",color:"orange",default:.5},{name:"Archeo Landschappen",color:"green",default:.5},{name:"Terpen",color:"orange",default:.7},{name:"Essen",color:"amber",default:.6},{name:"Paleokaart 9000 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 5500 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 2750 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 1500 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 500 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 100 n.Chr.",color:"indigo",default:.7},{name:"Paleokaart 800 n.Chr.",color:"indigo",default:.7},{name:"Verdedigingslinies",color:"red",default:.7},{name:"Inundatiegebieden",color:"red",default:.5},{name:"Gewaspercelen",color:"green",default:.6},{name:"Kadastrale Grenzen",color:"purple",default:.7},{name:"Erfgoedlijnen",color:"purple",default:.7},{name:"Oude Kernen",color:"orange",default:.6},{name:"Relictenkaart Vlakken",color:"green",default:.5}],bEe={blue:"accent-blue-500",amber:"accent-amber-500",red:"accent-red-500",indigo:"accent-indigo-500",green:"accent-green-500",orange:"accent-orange-500",purple:"accent-purple-500"};function REe(){const[n,e]=se.useState(!1),[t,r]=se.useState(!1),i=ii(h=>h.visible),s=ii(h=>h.opacity),a=ii(h=>h.setLayerOpacity),o=AEe.filter(h=>i[h.name]);if(o.length===0)return null;const l=t?o:o.slice(0,3),u=o.length>3;return y.jsxs("div",{className:"fixed bottom-[112px] right-2 z-[900]",children:[y.jsxs(Kt.button,{onClick:()=>e(!n),className:"w-11 h-11 bg-white/80 rounded-xl backdrop-blur-sm shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none hover:bg-white/90 transition-colors",whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":"Opacity sliders",title:n?"Sluit opacity sliders":"Open opacity sliders",children:[y.jsx(Xae,{size:22,strokeWidth:2,className:"text-gray-500"}),o.length>0&&y.jsx("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-blue-500 text-white text-[10px] rounded-full flex items-center justify-center",children:o.length})]}),y.jsx(Yr,{children:n&&y.jsxs(y.Fragment,{children:[y.jsx(Kt.div,{className:"fixed inset-0 z-[-1]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>e(!1)}),y.jsxs(Kt.div,{initial:{opacity:0,x:20,scale:.9},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:20,scale:.9},transition:{duration:.2},className:"absolute bottom-0 right-14 bg-white/95 rounded-lg shadow-lg p-3 min-w-[220px] max-h-[60vh] overflow-y-auto",children:[y.jsx("div",{className:"text-xs font-semibold text-gray-500 mb-2 uppercase tracking-wide",children:"Transparantie"}),y.jsx("div",{className:"space-y-3",children:l.map(h=>{const f=s[h.name]??h.default;return y.jsxs("div",{children:[y.jsx("label",{className:"text-xs font-medium text-gray-700 mb-1 block truncate",title:h.name,children:h.name}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("input",{type:"range",min:"0",max:"100",value:f*100,onChange:g=>a(h.name,parseInt(g.target.value)/100),className:`flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer ${bEe[h.color]}`}),y.jsxs("span",{className:"text-xs text-gray-500 w-8 text-right select-none pointer-events-none",children:[Math.round(f*100),"%"]})]})]},h.name)})}),u&&y.jsx("button",{onClick:()=>r(!t),className:"w-full mt-3 pt-2 border-t border-gray-200 flex items-center justify-center gap-1 text-xs text-gray-500 hover:text-gray-700",children:t?y.jsxs(y.Fragment,{children:[y.jsx(wj,{size:14}),"Minder tonen"]}):y.jsxs(y.Fragment,{children:[y.jsx(fR,{size:14}),o.length-3," meer..."]})})]})]})})]})}function CEe(){const n=As(x=>x.map),[e,t]=se.useState(""),[r,i]=se.useState([]),[s,a]=se.useState(!1),[o,l]=se.useState(!1),u=se.useRef(null),h=se.useRef();se.useEffect(()=>{if(h.current&&clearTimeout(h.current),e.length<2){i([]);return}return h.current=window.setTimeout(async()=>{l(!0);try{const w=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/suggest?q=${encodeURIComponent(e)}&rows=7`)).json();w.response?.docs&&i(w.response.docs)}catch(x){console.error("Search error:",x),i([])}finally{l(!1)}},300),()=>{h.current&&clearTimeout(h.current)}},[e]);const f=async x=>{try{const T=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/lookup?id=${encodeURIComponent(x)}`)).json();if(T.response?.docs?.[0]?.centroide_ll){const P=T.response.docs[0].centroide_ll.match(/POINT\(([^ ]+) ([^)]+)\)/);if(P)return{lng:parseFloat(P[1]),lat:parseFloat(P[2])}}}catch(w){console.error("Lookup error:",w)}return null},g=async x=>{if(!n)return;const w=await f(x.id);w&&n.getView().animate({center:Nh([w.lng,w.lat]),zoom:16,duration:1e3}),t(""),i([]),a(!1)},p=async(x,w)=>{w.stopPropagation();const T=await f(x.id);if(T){const I=`https://www.google.com/maps?q=${T.lat},${T.lng}`;window.open(I,"_blank")}t(""),i([]),a(!1)},E=()=>{t(""),i([]),u.current?.focus()};return y.jsxs("div",{className:"search-box",children:[y.jsxs("div",{className:"search-input-wrapper",children:[y.jsx(Tj,{size:18,className:"search-icon"}),y.jsx("input",{ref:u,type:"text",value:e,onChange:x=>{t(x.target.value),a(!0)},onFocus:()=>a(!0),placeholder:"Zoek adres of plaats...",className:"search-input"}),e&&y.jsx("button",{onClick:E,className:"search-clear",children:y.jsx(Aa,{size:16})})]}),s&&r.length>0&&y.jsx("ul",{className:"search-results",children:r.map(x=>y.jsxs("li",{className:"search-result-item",children:[y.jsx("div",{className:"search-result-content",onClick:()=>g(x),children:y.jsx("span",{className:"search-result-text",children:x.weergavenaam})}),y.jsx("button",{className:"search-navigate-btn",onClick:w=>p(x,w),title:"Open in Google Maps",children:y.jsx(E1,{size:20})})]},x.id))}),s&&o&&y.jsx("div",{className:"search-loading",children:"Zoeken..."})]})}function PEe(){const n=As(r=>r.map),e=()=>{if(!n)return;const r=n.getView(),i=r.getZoom();i!==void 0&&r.animate({zoom:i+1,duration:200})},t=()=>{if(!n)return;const r=n.getView(),i=r.getZoom();i!==void 0&&r.animate({zoom:i-1,duration:200})};return y.jsxs("div",{className:"fixed top-2 left-2 z-[800] flex flex-col gap-1",children:[y.jsx(Kt.button,{className:"w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},title:"Inzoomen",children:y.jsx(Go,{size:22,className:"text-gray-600"})}),y.jsx(Kt.button,{className:"w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",onClick:t,whileHover:{scale:1.05},whileTap:{scale:.95},title:"Uitzoomen",children:y.jsx(Rae,{size:22,className:"text-gray-600"})})]})}const kEe="detector2024",GI="detectorapp-auth";function MEe({children:n}){const[e,t]=se.useState(!1),[r,i]=se.useState(""),[s,a]=se.useState(!1),[o,l]=se.useState(""),[u,h]=se.useState(!0);se.useEffect(()=>{localStorage.getItem(GI)==="authenticated"&&t(!0),h(!1)},[]);const f=g=>{g.preventDefault(),l(""),r===kEe?(localStorage.setItem(GI,"authenticated"),t(!0)):(l("Onjuist wachtwoord"),i(""))};return u?y.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-blue-600 to-blue-800 flex items-center justify-center",children:y.jsx("div",{className:"text-white text-lg",children:"Laden..."})}):e?y.jsx(y.Fragment,{children:n}):y.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-blue-600 to-blue-800 flex items-center justify-center p-4",children:y.jsxs(Kt.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-sm",children:[y.jsxs("div",{className:"text-center mb-6",children:[y.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:y.jsx(_I,{size:32,className:"text-blue-600"})}),y.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"DetectorApp"}),y.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Test versie - Toegang beveiligd"})]}),y.jsxs("form",{onSubmit:f,className:"space-y-4",children:[y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Wachtwoord"}),y.jsxs("div",{className:"relative",children:[y.jsx("input",{type:s?"text":"password",value:r,onChange:g=>i(g.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none pr-12",placeholder:"Voer wachtwoord in",autoFocus:!0}),y.jsx("button",{type:"button",onClick:()=>a(!s),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:s?y.jsx(gR,{size:20}):y.jsx(mR,{size:20})})]})]}),o&&y.jsx(Kt.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-red-500 text-sm text-center",children:o}),y.jsx("button",{type:"submit",className:"w-full py-3 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors",children:"Inloggen"})]}),y.jsx("p",{className:"text-center text-xs text-gray-400 mt-6",children:"Alleen voor testers"})]})})}function NEe(){localStorage.removeItem(GI),window.location.reload()}function LEe({isOpen:n,onClose:e}){const t=Ol(l=>l.vondsten),r={total:t.length,byType:{},byMaterial:{},byPeriod:{},byCondition:{},avgDepth:0,totalWeight:0,recent:t.slice(-5).reverse()};let i=0,s=0;t.forEach(l=>{r.byType[l.objectType]=(r.byType[l.objectType]||0)+1,r.byMaterial[l.material]=(r.byMaterial[l.material]||0)+1,r.byPeriod[l.period]=(r.byPeriod[l.period]||0)+1,l.condition&&(r.byCondition[l.condition]=(r.byCondition[l.condition]||0)+1),l.depth&&(i+=l.depth,s++),l.weight&&(r.totalWeight+=l.weight)}),r.avgDepth=s>0?Math.round(i/s):0;const a=l=>Object.entries(l).sort((u,h)=>h[1]-u[1]),o=l=>Math.max(...Object.values(l),1);return y.jsx(Yr,{children:n&&y.jsxs(y.Fragment,{children:[y.jsx(Kt.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),y.jsxs(Kt.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-md mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},children:[y.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx(Ej,{size:18}),y.jsx("span",{className:"font-medium",children:"Mijn Vondsten Dashboard"})]}),y.jsx("button",{onClick:e,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none",children:y.jsx(Aa,{size:18})})]}),y.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-5",children:t.length===0?y.jsxs("div",{className:"text-center py-8 text-gray-500",children:[y.jsx(fu,{size:48,className:"mx-auto mb-3 opacity-30"}),y.jsx("p",{className:"font-medium",children:"Nog geen vondsten"}),y.jsx("p",{className:"text-sm mt-1",children:"Voeg je eerste vondst toe via de oranje knop of long-press op de kaart"})]}):y.jsxs(y.Fragment,{children:[y.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[y.jsx(WS,{icon:y.jsx(fu,{size:20}),value:r.total,label:"Totaal",color:"bg-orange-100 text-orange-700"}),y.jsx(WS,{icon:y.jsx(Bae,{size:20}),value:r.avgDepth>0?`${r.avgDepth}cm`:"-",label:"Gem. diepte",color:"bg-blue-100 text-blue-700"}),y.jsx(WS,{icon:y.jsx(Wae,{size:20}),value:r.totalWeight>0?`${r.totalWeight.toFixed(1)}g`:"-",label:"Tot. gewicht",color:"bg-green-100 text-green-700"})]}),y.jsx(E_,{title:"Per Type",data:a(r.byType),max:o(r.byType),color:"bg-orange-500"}),y.jsx(E_,{title:"Per Periode",data:a(r.byPeriod),max:o(r.byPeriod),color:"bg-amber-500"}),y.jsx(E_,{title:"Per Materiaal",data:a(r.byMaterial),max:o(r.byMaterial),color:"bg-blue-500"}),Object.keys(r.byCondition).length>0&&y.jsx(E_,{title:"Per Conditie",data:a(r.byCondition),max:o(r.byCondition),color:"bg-green-500"}),y.jsxs("div",{children:[y.jsxs("h3",{className:"text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2",children:[y.jsx(jse,{size:14}),"Recente Vondsten"]}),y.jsx("div",{className:"space-y-2",children:r.recent.map(l=>y.jsxs("div",{className:"flex items-center justify-between py-2 px-3 bg-gray-50 rounded-lg",children:[y.jsxs("div",{children:[y.jsx("span",{className:"font-medium text-sm text-gray-800",children:l.objectType}),y.jsx("span",{className:"text-gray-400 mx-1",children:"-"}),y.jsx("span",{className:"text-sm text-gray-600",children:l.material})]}),y.jsx("span",{className:"text-xs text-gray-400",children:new Date(l.timestamp).toLocaleDateString("nl-NL")})]},l.id))})]})]})})]})]})})}function WS({icon:n,value:e,label:t,color:r}){return y.jsxs("div",{className:`rounded-lg p-3 ${r}`,children:[y.jsx("div",{className:"flex items-center gap-2 mb-1 opacity-70",children:n}),y.jsx("div",{className:"text-xl font-bold",children:e}),y.jsx("div",{className:"text-xs opacity-70",children:t})]})}function E_({title:n,data:e,max:t,color:r}){return e.length===0?null:y.jsxs("div",{children:[y.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:n}),y.jsx("div",{className:"space-y-1.5",children:e.slice(0,6).map(([i,s])=>y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("div",{className:"w-24 text-xs text-gray-600 truncate",title:i,children:i}),y.jsx("div",{className:"flex-1 h-4 bg-gray-100 rounded-full overflow-hidden",children:y.jsx(Kt.div,{className:`h-full ${r} rounded-full`,initial:{width:0},animate:{width:`${s/t*100}%`},transition:{duration:.5,ease:"easeOut"}})}),y.jsx("div",{className:"w-6 text-xs text-gray-600 text-right font-medium",children:s})]},i))})]})}function OEe(n){const{type:e,coordinates:t}=n,r=o=>Nh(o),i=o=>o.map(r),s=o=>o.map(i),a=o=>o.map(s);switch(e){case"Point":return new to(r(t));case"LineString":return new zo(i(t));case"Polygon":return new no(s(t));case"MultiPoint":return new P0(i(t));case"MultiLineString":return new iu(s(t));case"MultiPolygon":return new o0(a(t));default:return console.warn(`Unsupported geometry type: ${e}`),null}}function DEe(n,e,t){const r=n.color,i=10,s=5,a=14;let o=i;if(t>50?o=s:t>10?o=Math.max(s,i-(t-10)/10):t<2&&(o=a),e==="Point"||e==="MultiPoint")return new ur({image:new Dl({radius:o,fill:new oi({color:r}),stroke:new _s({color:"#ffffff",width:2})})});if(e==="LineString"||e==="MultiLineString")return new ur({stroke:new _s({color:r,width:3})});if(e==="Polygon"||e==="MultiPolygon"){const l=FEe(r,.3);return new ur({fill:new oi({color:l}),stroke:new _s({color:r,width:2})})}return new ur({image:new Dl({radius:o,fill:new oi({color:r}),stroke:new _s({color:"#ffffff",width:2})})})}function FEe(n,e){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(n);if(t){const r=parseInt(t[1],16),i=parseInt(t[2],16),s=parseInt(t[3],16);return`rgba(${r}, ${i}, ${s}, ${e})`}return n}function jEe(){const n=As(r=>r.map),e=IE(r=>r.layers),t=se.useRef(new Map);return se.useEffect(()=>{if(!n)return;const r=new Set;e.forEach(i=>{r.add(i.id);const s=new $p;i.features.features.forEach((o,l)=>{if(!o.geometry)return;const u=OEe(o.geometry);if(!u)return;const h=new eo({geometry:u,properties:o.properties,layerId:i.id,featureIndex:l});h.setStyle((f,g)=>DEe(i,o.geometry.type,g)),s.addFeature(h)});const a=t.current.get(i.id);if(a)a.setSource(s),a.setVisible(i.visible),a.setOpacity(i.opacity);else{const o=new Xp({source:s,zIndex:900,visible:i.visible,opacity:i.opacity,properties:{title:i.name,customLayerId:i.id}});n.addLayer(o),t.current.set(i.id,o)}}),t.current.forEach((i,s)=>{r.has(s)||(n.removeLayer(i),t.current.delete(s))})},[n,e]),se.useEffect(()=>()=>{n&&(t.current.forEach(r=>{n.removeLayer(r)}),t.current.clear())},[n]),null}gn.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs");A7(gn);function VEe(n){if(!n||n.length<2)return"unknown";const[e,t]=n;return e>=7e3&&e<=3e5&&t>=289e3&&t<=629e3?"RD":Math.abs(e)<=180&&Math.abs(t)<=90?"WGS84":"unknown"}function GEe(n){const[e,t]=n;return gn("EPSG:28992","EPSG:4326",[e,t])}function oG(n,e){return typeof n[0]=="number"?e(n):n.map(t=>oG(t,e))}function BEe(n){const e=n.coordinates;return!e||Array.isArray(e)&&e.length===0?null:n.type==="Point"?e:n.type==="LineString"||n.type==="MultiPoint"?e[0]:n.type==="Polygon"||n.type==="MultiLineString"?e[0]?.[0]:n.type==="MultiPolygon"?e[0]?.[0]?.[0]:null}async function UEe(n){const e=[],t=[];try{const r=await n.text(),i=JSON.parse(r);if(!i.type)return e.push('Ongeldig GeoJSON: geen "type" veld gevonden'),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:t,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}};let s=[];i.type==="FeatureCollection"?s=i.features||[]:i.type==="Feature"?s=[i]:i.type==="GeometryCollection"?s=(i.geometries||[]).map((u,h)=>({type:"Feature",geometry:u,properties:{id:h}})):s=[{type:"Feature",geometry:i,properties:{}}],s.length===0&&t.push("Geen features gevonden in bestand");let a="unknown",o=!1;if(s.length>0&&s[0].geometry){const u=BEe(s[0].geometry);u&&(a=VEe(u))}a==="RD"&&(t.push("Rijksdriehoek coordinaten gedetecteerd, worden omgezet naar WGS84"),o=!0,s=s.map(u=>{if(!u.geometry)return u;const h=oG(u.geometry.coordinates,GEe);return{...u,geometry:{...u.geometry,coordinates:h}}}),a="WGS84");const l=[...new Set(s.filter(u=>u.geometry).map(u=>u.geometry.type))];return{success:!0,features:{type:"FeatureCollection",features:s},errors:e,warnings:t,metadata:{featureCount:s.length,geometryTypes:l,coordinateSystem:a,transformed:o}}}catch(r){return e.push(`Fout bij parsen: ${r instanceof Error?r.message:"Onbekende fout"}`),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:t,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}async function zEe(n){const e=[],t=[];try{const r=await n.text(),s=new Ufe({extractStyles:!1}).readFeatures(r,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"});s.length===0&&t.push("Geen features gevonden in KML bestand");const l=new NR().writeFeaturesObject(s,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"}).features.map((h,f)=>{const g={...h.properties},p=g.name||g.Name||`Feature ${f+1}`,E=g.description||g.Description||"";return{type:"Feature",geometry:h.geometry,properties:{...g,name:p,description:E}}}),u=[...new Set(l.filter(h=>h.geometry).map(h=>h.geometry.type))];return{success:!0,features:{type:"FeatureCollection",features:l},errors:e,warnings:t,metadata:{featureCount:l.length,geometryTypes:u,coordinateSystem:"WGS84",transformed:!1}}}catch(r){return e.push(`Fout bij parsen KML: ${r instanceof Error?r.message:"Onbekende fout"}`),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:t,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}async function $Ee(n){const e=[],t=[];try{const r=await n.text(),s=new nfe().readFeatures(r,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"});s.length===0&&t.push("Geen features gevonden in GPX bestand");const l=new NR().writeFeaturesObject(s,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"}).features.map((h,f)=>{const g={...h.properties},p=g.name||g.Name||`Waypoint ${f+1}`,E=g.desc||g.description||"",x=g.time||null,w=g.ele||null;return{type:"Feature",geometry:h.geometry,properties:{...g,name:p,description:E,time:x,elevation:w}}}),u=[...new Set(l.filter(h=>h.geometry).map(h=>h.geometry.type))];return u.includes("LineString")&&t.push("GPX track routes worden als lijnen weergegeven"),{success:!0,features:{type:"FeatureCollection",features:l},errors:e,warnings:t,metadata:{featureCount:l.length,geometryTypes:u,coordinateSystem:"WGS84",transformed:!1}}}catch(r){return e.push(`Fout bij parsen GPX: ${r instanceof Error?r.message:"Onbekende fout"}`),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:t,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}function uC(n){switch(n.split(".").pop()?.toLowerCase()){case"geojson":case"json":return"geojson";case"kml":case"kmz":return"kml";case"gpx":return"gpx";default:return"unsupported"}}function WEe(){return".geojson,.json,.kml,.gpx"}function hC(){return"GeoJSON, KML (Google My Maps), GPX"}async function HEe(n){switch(uC(n.name)){case"geojson":return UEe(n);case"kml":return zEe(n);case"gpx":return $Ee(n);case"unsupported":default:return{success:!1,features:{type:"FeatureCollection",features:[]},errors:[`Niet-ondersteund bestandsformaat: ${n.name}. Ondersteunde formaten: ${hC()}`],warnings:[],metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}function KEe(n){return n.size>10485760?{valid:!1,error:`Bestand te groot (${(n.size/1024/1024).toFixed(1)} MB). Maximum is 10 MB.`}:uC(n.name)==="unsupported"?{valid:!1,error:`Niet-ondersteund bestandsformaat. Ondersteunde formaten: ${hC()}`}:n.name.toLowerCase().endsWith(".kmz")?{valid:!1,error:"KMZ bestanden worden nog niet ondersteund. Pak het bestand uit en importeer het .kml bestand."}:{valid:!0}}function YEe({isOpen:n,onClose:e}){const t=IE(C=>C.addLayer),r=se.useRef(null),[i,s]=se.useState("idle"),[a,o]=se.useState(null),[l,u]=se.useState(null),[h,f]=se.useState(""),[g,p]=se.useState(null),[E,x]=se.useState(!1),w=se.useCallback(()=>{s("idle"),o(null),u(null),f(""),p(null),r.current&&(r.current.value="")},[]),T=se.useCallback(()=>{w(),e()},[w,e]),I=se.useCallback(async C=>{const M=KEe(C);if(!M.valid){p(M.error||"Ongeldig bestand"),s("error");return}o(C),s("parsing"),p(null);const j=C.name.replace(/\.[^/.]+$/,"");f(j);try{const O=await HEe(C);if(!O.success){p(O.errors.join(`
`)),s("error");return}if(O.features.features.length===0){p("Geen features gevonden in het bestand"),s("error");return}u(O),s("preview")}catch(O){p(O instanceof Error?O.message:"Onbekende fout bij parsen"),s("error")}},[]),P=se.useCallback(C=>{const M=C.target.files?.[0];M&&I(M)},[I]),N=se.useCallback(C=>{C.preventDefault(),x(!0)},[]),D=se.useCallback(C=>{C.preventDefault(),x(!1)},[]),B=se.useCallback(C=>{C.preventDefault(),x(!1);const M=C.dataTransfer.files?.[0];M&&I(M)},[I]),k=se.useCallback(()=>{if(!l||!h.trim())return;const C=a?uC(a.name):"geojson";t({name:h.trim(),type:C==="unsupported"?"geojson":C,features:l.features,visible:!0,opacity:1,color:"",sourceFileName:a?.name||"unknown"}),T()},[l,h,a,t,T]);return y.jsx(Yr,{children:n&&y.jsxs(y.Fragment,{children:[y.jsx(Kt.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:T}),y.jsxs(Kt.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-md mx-auto my-auto max-h-[80vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[y.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-purple-500 to-purple-600 text-white",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx(ER,{size:18}),y.jsx("span",{className:"font-medium",children:"Laag Importeren"})]}),y.jsx("button",{onClick:T,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none",children:y.jsx(Aa,{size:18})})]}),y.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[i==="idle"&&y.jsxs(y.Fragment,{children:[y.jsxs("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${E?"border-purple-500 bg-purple-50":"border-gray-300 hover:border-gray-400"}`,onDragOver:N,onDragLeave:D,onDrop:B,children:[y.jsx(pR,{size:40,className:"mx-auto text-gray-400 mb-3"}),y.jsx("p",{className:"text-gray-600 mb-2",children:"Sleep een bestand hierheen"}),y.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"of"}),y.jsx("button",{onClick:()=>r.current?.click(),className:"px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors border-0 outline-none",children:"Bestand kiezen"}),y.jsx("input",{ref:r,type:"file",accept:WEe(),onChange:P,className:"hidden"})]}),y.jsxs("div",{className:"text-xs text-gray-500 text-center",children:[y.jsx("p",{className:"font-medium",children:"Ondersteunde formaten:"}),y.jsx("p",{children:hC()})]})]}),i==="parsing"&&y.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[y.jsx(yR,{size:40,className:"text-purple-500 animate-spin mb-4"}),y.jsx("p",{className:"text-gray-600",children:"Bestand verwerken..."}),y.jsx("p",{className:"text-gray-400 text-sm",children:a?.name})]}),i==="error"&&y.jsxs("div",{className:"space-y-4",children:[y.jsxs("div",{className:"flex items-start gap-3 p-4 bg-red-50 rounded-lg",children:[y.jsx(Sj,{size:20,className:"text-red-500 flex-shrink-0 mt-0.5"}),y.jsxs("div",{children:[y.jsx("p",{className:"font-medium text-red-700",children:"Import mislukt"}),y.jsx("p",{className:"text-sm text-red-600 mt-1 whitespace-pre-wrap",children:g})]})]}),y.jsx("button",{onClick:w,className:"w-full px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors border-0 outline-none",children:"Opnieuw proberen"})]}),i==="preview"&&l&&y.jsxs("div",{className:"space-y-4",children:[y.jsxs("div",{className:"flex items-start gap-3 p-3 bg-green-50 rounded-lg",children:[y.jsx(Yse,{size:20,className:"text-green-500 flex-shrink-0 mt-0.5"}),y.jsxs("div",{children:[y.jsx("p",{className:"font-medium text-green-700",children:"Bestand geladen"}),y.jsx("p",{className:"text-sm text-green-600",children:a?.name})]})]}),l.warnings.length>0&&y.jsxs("div",{className:"p-3 bg-amber-50 rounded-lg",children:[y.jsx("p",{className:"font-medium text-amber-700 text-sm",children:"Let op:"}),y.jsx("ul",{className:"text-sm text-amber-600 mt-1 list-disc list-inside",children:l.warnings.map((C,M)=>y.jsx("li",{children:C},M))})]}),y.jsx("div",{className:"p-3 bg-gray-50 rounded-lg text-sm",children:y.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[y.jsxs("div",{children:[y.jsx("span",{className:"text-gray-500",children:"Features:"}),y.jsx("span",{className:"ml-2 font-medium",children:l.metadata.featureCount})]}),y.jsxs("div",{children:[y.jsx("span",{className:"text-gray-500",children:"Types:"}),y.jsx("span",{className:"ml-2 font-medium",children:l.metadata.geometryTypes.join(", ")||"-"})]})]})}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Naam van de laag"}),y.jsx("input",{type:"text",value:h,onChange:C=>f(C.target.value),placeholder:"Bijv. Mijn locaties",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]})]}),i==="preview"&&y.jsxs("div",{className:"px-4 py-3 border-t border-gray-100 flex gap-2",children:[y.jsx("button",{onClick:w,className:"flex-1 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors border-0 outline-none",children:"Annuleren"}),y.jsx("button",{onClick:k,disabled:!h.trim(),className:"flex-1 px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors border-0 outline-none disabled:opacity-50 disabled:cursor-not-allowed",children:"Importeren"})]})]})]})})}function XEe({layer:n}){const{toggleVisibility:e,removeLayer:t}=IE(),[r,i]=se.useState(!1),s=n.features.features.length,a=[...new Set(n.features.features.map(l=>l.geometry?.type).filter(Boolean))],o=()=>{r?t(n.id):(i(!0),setTimeout(()=>i(!1),3e3))};return y.jsxs("div",{className:"flex items-center justify-between py-1.5 group",children:[y.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[y.jsx("div",{className:"w-3 h-3 rounded-full flex-shrink-0",style:{backgroundColor:n.color}}),y.jsxs("div",{className:"flex-1 min-w-0",children:[y.jsx("div",{className:"flex items-center gap-1",children:y.jsx("span",{className:"text-sm text-gray-700 truncate",children:n.name})}),y.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-400",children:[y.jsx(pR,{size:10}),y.jsxs("span",{children:[s," ",s===1?"feature":"features"]}),a.length>0&&y.jsxs(y.Fragment,{children:[y.jsx("span",{className:"mx-0.5",children:""}),y.jsx("span",{children:a.join(", ")})]})]})]})]}),y.jsxs("div",{className:"flex items-center gap-1",children:[y.jsx("button",{onClick:()=>e(n.id),className:`p-1 rounded transition-colors border-0 outline-none ${n.visible?"text-purple-500 hover:bg-purple-50":"text-gray-400 hover:bg-gray-100"}`,title:n.visible?"Verbergen":"Tonen",children:n.visible?y.jsx(mR,{size:14}):y.jsx(gR,{size:14})}),y.jsx("button",{onClick:o,className:`p-1 rounded transition-colors border-0 outline-none ${r?"text-white bg-red-500 hover:bg-red-600":"text-gray-400 hover:text-red-500 hover:bg-red-50"}`,title:r?"Klik nogmaals om te verwijderen":"Verwijderen",children:y.jsx(B0,{size:14})})]})]})}function qEe(){const{user:n,loading:e,error:t,signInWithGoogle:r,logout:i,initAuth:s}=m1();return se.useEffect(()=>{s()},[s]),e?y.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-white rounded-lg text-gray-500",children:[y.jsx(fL,{size:16,className:"animate-pulse"}),y.jsx("span",{className:"text-sm",children:"Laden..."})]}):n?y.jsxs("div",{className:"space-y-2",children:[y.jsxs("div",{className:"flex items-center gap-3 px-3 py-2.5 bg-green-50 rounded-lg",children:[n.photoURL?y.jsx("img",{src:n.photoURL,alt:n.displayName||"User",className:"w-10 h-10 rounded-full border-2 border-green-200",referrerPolicy:"no-referrer"}):y.jsx("div",{className:"w-10 h-10 rounded-full bg-green-200 flex items-center justify-center",children:y.jsx(Qx,{size:20,className:"text-green-600"})}),y.jsxs("div",{className:"flex-1 min-w-0",children:[y.jsx("div",{className:"text-sm font-medium text-green-800 truncate",children:n.displayName||n.email}),y.jsxs("div",{className:"text-xs text-green-600 flex items-center gap-1",children:[y.jsx(fL,{size:12}),"Cloud sync actief"]})]})]}),y.jsxs("button",{onClick:i,className:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-white hover:bg-red-50 rounded-lg transition-colors border-0 outline-none text-gray-600 hover:text-red-600",children:[y.jsx(_R,{size:16}),y.jsx("span",{className:"text-sm",children:"Uitloggen"})]})]}):y.jsxs("div",{className:"space-y-2",children:[y.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-gray-50 rounded-lg text-gray-500",children:[y.jsx(qse,{size:16}),y.jsx("span",{className:"text-sm",children:"Alleen lokale opslag"})]}),y.jsxs("button",{onClick:r,className:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-white hover:bg-blue-50 rounded-lg transition-colors border-0 outline-none",children:[y.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",children:[y.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),y.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),y.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),y.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),y.jsx("span",{className:"text-sm text-gray-700",children:"Inloggen met Google"})]}),t&&y.jsx("div",{className:"px-3 py-2 bg-red-50 text-red-700 text-xs rounded-lg",children:t})]})}const ZEe="https://forms.gle/R5LCk11Bzu5XrkBj8";function QEe(){const{settingsPanelOpen:n,toggleSettingsPanel:e,vondstDashboardOpen:t,toggleVondstDashboard:r,openLayerManagerModal:i}=Fi(),s=Ti(),{presets:a,createPreset:o,deletePreset:l,updatePreset:u}=B8(),h=Ol(ce=>ce.vondsten),f=IE(ce=>ce.layers),{layers:g,updateLayer:p}=qs(),{devMode:E,setDevMode:x,tier:w}=U8(),[T,I]=se.useState(""),[P,N]=se.useState(!1),[D,B]=se.useState(!1),[k,C]=se.useState(null),[M,j]=se.useState(""),[O,W]=se.useState(null),[F,Te]=se.useState(""),Me=14*s.fontScale/100,Le=()=>{T.trim()&&(o(T.trim(),"Layers"),I(""),N(!1))},Re=(ce,te)=>{C(ce),j(te)},ue=ce=>{M.trim()&&(u(ce,{name:M.trim()}),console.log(` Preset hernoemd naar "${M.trim()}"`)),C(null),j("")},be=()=>{C(null),j("")};return y.jsxs(y.Fragment,{children:[y.jsx(Yr,{children:n&&y.jsxs(y.Fragment,{children:[y.jsx(Kt.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),y.jsxs(Kt.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-sm mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[y.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx(EI,{size:18}),y.jsx("span",{className:"font-medium",children:"Instellingen"})]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),y.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:s.fontScale,onInput:ce=>{s.setFontScale(parseInt(ce.target.value))},onChange:ce=>s.setFontScale(parseInt(ce.target.value)),className:"header-slider w-20 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${s.fontScale}%`}),y.jsx("span",{className:"text-xs opacity-70",children:"T"}),y.jsx("button",{onClick:e,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:y.jsx(Aa,{size:18})})]})]}),y.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-5",style:{fontSize:`${Me}px`},children:[y.jsx(pl,{title:"Account",icon:y.jsx(Qx,{size:16}),children:y.jsx(qEe,{})}),y.jsxs(pl,{title:"Kaart",icon:y.jsx(xR,{size:16}),children:[y.jsx(JEe,{label:"Standaard achtergrond",children:y.jsxs("select",{value:s.defaultBackground,onChange:ce=>s.setDefaultBackground(ce.target.value),className:"px-2 py-1 bg-gray-100 rounded border-0 outline-none",style:{fontSize:"0.9em"},children:[y.jsx("option",{value:"CartoDB (licht)",children:"Licht"}),y.jsx("option",{value:"OpenStreetMap",children:"OSM"}),y.jsx("option",{value:"Luchtfoto",children:"Luchtfoto"})]})}),y.jsx(df,{label:"Schaalbalk tonen",checked:s.showScaleBar,onChange:s.setShowScaleBar})]}),y.jsxs(pl,{title:"GPS",icon:y.jsx(vR,{size:16}),children:[y.jsx(df,{label:"GPS aan bij start",checked:s.gpsAutoStart,onChange:s.setGpsAutoStart}),y.jsx(df,{label:"Nauwkeurigheidscirkel",checked:s.showAccuracyCircle,onChange:s.setShowAccuracyCircle})]}),y.jsx(pl,{title:"Feedback",icon:y.jsx(Zae,{size:16}),children:y.jsx(df,{label:"Trillen bij acties",checked:s.hapticFeedback,onChange:s.setHapticFeedback})}),y.jsxs(pl,{title:"Vondsten",icon:y.jsx(fu,{size:16}),children:[y.jsx(df,{label:"Vondsten knop tonen",checked:s.showVondstButton,onChange:s.setShowVondstButton}),y.jsx("p",{className:"text-gray-500 mt-1 py-1",style:{fontSize:"0.75em"},children:"Vondsten worden altijd lokaal op dit apparaat opgeslagen."}),y.jsxs("button",{onClick:r,className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[y.jsx(Ej,{size:14}),y.jsxs("span",{children:["Dashboard (",h.length," vondsten)"]})]}),y.jsx(ewe,{})]}),y.jsx(pl,{title:"Mijn Lagen",icon:y.jsx(Ko,{size:16}),children:y.jsxs("div",{className:"space-y-1",children:[g.filter(ce=>!ce.archived).length===0?y.jsx("p",{className:"text-gray-500 py-1",style:{fontSize:"0.75em"},children:"Nog geen eigen lagen aangemaakt."}):g.filter(ce=>!ce.archived).map(ce=>y.jsxs("div",{className:"flex items-center gap-2 py-1.5 px-2 hover:bg-gray-50 rounded",children:[y.jsx("div",{className:"w-3 h-3 rounded-full flex-shrink-0",style:{backgroundColor:ce.color}}),O===ce.id?y.jsx("input",{type:"text",value:F,onChange:te=>Te(te.target.value),onKeyDown:te=>{te.key==="Enter"?(F.trim()&&p(ce.id,{name:F.trim()}),W(null)):te.key==="Escape"&&W(null)},onBlur:()=>{F.trim()&&p(ce.id,{name:F.trim()}),W(null)},autoFocus:!0,className:"flex-1 px-1.5 py-0.5 text-sm bg-orange-50 rounded outline-none focus:ring-1 focus:ring-orange-400"}):y.jsxs(y.Fragment,{children:[y.jsx("span",{className:"flex-1 text-sm text-gray-700 truncate",children:ce.name}),y.jsxs("span",{className:"text-xs text-gray-400",children:[ce.points.length," punten"]}),y.jsx("button",{onClick:()=>{W(ce.id),Te(ce.name)},className:"p-1 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none bg-transparent",title:"Naam bewerken",children:y.jsx(vI,{size:12})})]})]},ce.id)),y.jsxs("button",{onClick:()=>{i(),e()},className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[y.jsx(EI,{size:14}),y.jsx("span",{children:"Lagen beheren"})]})]})}),y.jsx(pl,{title:"Eigen Lagen",icon:y.jsx(ER,{size:16}),children:y.jsxs("div",{className:"space-y-1",children:[f.length===0?y.jsx("p",{className:"text-gray-500 py-1",style:{fontSize:"0.75em"},children:"Nog geen eigen lagen gemporteerd."}):f.map(ce=>y.jsx(XEe,{layer:ce},ce.id)),y.jsxs("button",{onClick:()=>B(!0),className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-purple-600 hover:bg-purple-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[y.jsx(Go,{size:14}),y.jsx("span",{children:"Laag importeren"})]}),y.jsx("p",{className:"text-gray-400 mt-1",style:{fontSize:"0.7em"},children:"GeoJSON, KML (Google My Maps), GPX"})]})}),y.jsx(pl,{title:"Presets",icon:y.jsx(Ko,{size:16}),children:y.jsxs("div",{className:"space-y-2",children:[a.map(ce=>y.jsx("div",{className:"flex items-center justify-between py-1",children:k===ce.id?y.jsxs("div",{className:"flex-1 flex items-center gap-1",children:[y.jsx("input",{type:"text",value:M,onChange:te=>j(te.target.value),onKeyDown:te=>{te.key==="Enter"&&ue(ce.id),te.key==="Escape"&&be()},className:"flex-1 px-2 py-0.5 bg-blue-50 rounded border border-blue-300 outline-none",style:{fontSize:"0.9em"},autoFocus:!0}),y.jsx("button",{onClick:()=>ue(ce.id),className:"px-2 py-0.5 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors border-0 outline-none",style:{fontSize:"0.7em"},children:"OK"}),y.jsx("button",{onClick:be,className:"px-2 py-0.5 bg-gray-200 text-gray-600 rounded hover:bg-gray-300 transition-colors border-0 outline-none",style:{fontSize:"0.7em"},children:""})]}):y.jsxs(y.Fragment,{children:[y.jsxs("div",{className:"flex-1 min-w-0",children:[y.jsxs("span",{className:"text-gray-600",style:{fontSize:"0.9em"},children:[ce.name,ce.isBuiltIn&&y.jsx("span",{className:"ml-1 text-gray-400",style:{fontSize:"0.7em"},children:"(standaard)"})]}),y.jsxs("span",{className:"ml-1 text-gray-400",style:{fontSize:"0.7em"},children:["(",ce.layers.length," lagen)"]})]}),!ce.isBuiltIn&&y.jsxs("div",{className:"flex items-center gap-1",children:[y.jsx("button",{onClick:()=>Re(ce.id,ce.name),className:"p-1 text-blue-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",title:"Naam wijzigen",children:y.jsx(vI,{size:14})}),y.jsx("button",{onClick:()=>l(ce.id),className:"p-1 text-red-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors border-0 outline-none",title:"Verwijderen",children:y.jsx(B0,{size:14})})]})]})},ce.id)),P?y.jsxs("div",{className:"flex gap-2 mt-2",children:[y.jsx("input",{type:"text",value:T,onChange:ce=>I(ce.target.value),placeholder:"Naam nieuwe preset",className:"flex-1 px-2 py-1 bg-gray-100 rounded border-0 outline-none",style:{fontSize:"0.9em"},onKeyDown:ce=>ce.key==="Enter"&&Le(),autoFocus:!0}),y.jsx("button",{onClick:Le,className:"px-2 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors border-0 outline-none",style:{fontSize:"0.75em"},children:"Opslaan"}),y.jsx("button",{onClick:()=>N(!1),className:"px-2 py-1 bg-gray-200 text-gray-600 rounded hover:bg-gray-300 transition-colors border-0 outline-none",style:{fontSize:"0.75em"},children:"Annuleren"})]}):y.jsxs("button",{onClick:()=>N(!0),className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[y.jsx(Go,{size:14}),y.jsx("span",{children:"Huidige lagen als preset opslaan"})]})]})}),y.jsxs(pl,{title:"Development",icon:y.jsx(Jse,{size:16}),children:[y.jsx(df,{label:"Dev Mode (alles ontgrendeld)",checked:E,onChange:x}),y.jsxs("p",{className:"text-gray-500 mt-1",style:{fontSize:"0.75em"},children:["Huidige tier: ",y.jsx("span",{className:"font-medium text-blue-600",children:w}),E&&y.jsx("span",{className:"text-green-600",children:" (alle lagen ontgrendeld)"})]})]})]}),y.jsxs("div",{className:"px-4 py-3 border-t border-gray-100 space-y-2",style:{fontSize:`${Me}px`},children:[y.jsxs("a",{href:ZEe,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 w-full px-3 py-2 text-orange-600 hover:bg-orange-50 rounded-lg transition-colors border-0 outline-none",style:{fontSize:"0.9em"},children:[y.jsx(vj,{size:16}),y.jsx("span",{children:"Meld een bug"})]}),y.jsxs("button",{onClick:NEe,className:"flex items-center justify-center gap-2 w-full px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none",style:{fontSize:"0.9em"},children:[y.jsx(_R,{size:16}),y.jsx("span",{children:"Uitloggen"})]}),y.jsx("p",{className:"text-gray-400 text-center",style:{fontSize:"0.75em"},children:"Instellingen worden lokaal opgeslagen"})]})]})]})}),y.jsx(LEe,{isOpen:t,onClose:r}),y.jsx(YEe,{isOpen:D,onClose:()=>B(!1)})]})}function pl({title:n,icon:e,children:t}){return y.jsxs("section",{children:[y.jsxs("div",{className:"flex items-center gap-2 mb-2 pb-1 border-b border-gray-100",children:[y.jsx("span",{className:"text-blue-600",children:e}),y.jsx("span",{className:"font-medium text-gray-800",style:{fontSize:"1em"},children:n})]}),y.jsx("div",{className:"space-y-2",children:t})]})}function JEe({label:n,children:e}){return y.jsxs("div",{className:"flex items-center justify-between",children:[y.jsx("span",{className:"text-gray-600",style:{fontSize:"0.9em"},children:n}),e]})}function df({label:n,checked:e,onChange:t}){return y.jsxs("div",{className:"flex items-center justify-between",children:[y.jsx("span",{className:"text-gray-600",style:{fontSize:"0.9em"},children:n}),y.jsx("button",{onClick:()=>t(!e),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${e?"bg-gradient-to-r from-blue-500 to-blue-600":"bg-gray-300"}`,children:y.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${e?"left-[22px]":"left-0.5"}`})})]})}function ewe(){const[n,e]=se.useState(!1),{vondsten:t,exportAsGeoJSON:r,exportAsCSV:i,exportAsExcel:s,exportAsGPX:a,exportAsKML:o}=Ol(),l=[{label:"Excel (.xlsx)",action:s,desc:"Spreadsheet"},{label:"CSV",action:i,desc:"Comma-separated"},{label:"GeoJSON",action:r,desc:"GIS software"},{label:"GPX",action:a,desc:"GPS apparaten"},{label:"KML",action:o,desc:"Google Earth"}],u=h=>{h(),e(!1)};return t.length===0?y.jsxs("div",{className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-gray-400 bg-gray-100 rounded w-full cursor-not-allowed",style:{fontSize:"0.9em"},children:[y.jsx(yI,{size:14}),y.jsx("span",{children:"Geen vondsten om te exporteren"})]}):y.jsxs("div",{className:"relative mt-2",children:[y.jsxs("button",{onClick:()=>e(!n),className:"flex items-center justify-between gap-2 px-2 py-1.5 text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx(yI,{size:14}),y.jsxs("span",{children:["Exporteer vondsten (",t.length,")"]})]}),y.jsx("span",{style:{fontSize:"0.8em"},children:""})]}),n&&y.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg z-10 overflow-hidden",children:l.map((h,f)=>y.jsxs("button",{onClick:()=>u(h.action),className:"w-full px-3 py-2 text-left hover:bg-blue-50 transition-colors border-0 outline-none flex justify-between items-center",style:{fontSize:"0.9em"},children:[y.jsx("span",{className:"text-gray-700",children:h.label}),y.jsx("span",{className:"text-gray-400",style:{fontSize:"0.8em"},children:h.desc})]},f))})]})}function HS({value:n,onChange:e,options:t,label:r,required:i=!1,placeholder:s="Typ hier..."}){const[a,o]=se.useState(!1),[l,u]=se.useState(!1),[h,f]=se.useState(""),g=se.useRef(null),p=se.useRef(null),E=n&&n!=="-maak een keuze-"&&!t.includes(n);se.useEffect(()=>{if(!a)return;const P=N=>{g.current&&!g.current.contains(N.target)&&o(!1)};return document.addEventListener("click",P),()=>document.removeEventListener("click",P)},[a]),se.useEffect(()=>{l&&p.current&&p.current.focus()},[l]);const x=()=>{u(!0),f(E?n:""),o(!1)},w=()=>{h.trim()&&e(h.trim()),u(!1)},T=P=>{P.key==="Enter"?(P.preventDefault(),w()):P.key==="Escape"&&u(!1)},I=!n||n==="-maak een keuze-"?"-maak een keuze-":n;return l?y.jsxs("div",{ref:g,children:[y.jsxs("label",{className:"block text-sm text-gray-600 mb-1",children:[r,i&&" *"]}),y.jsx("div",{className:"flex gap-2",children:y.jsx("input",{ref:p,type:"text",value:h,onChange:P=>f(P.target.value),onKeyDown:T,onBlur:w,placeholder:s,className:"flex-1 px-3 py-1.5 bg-white rounded text-sm text-gray-600 hover:bg-blue-50 transition-colors",style:{border:"none",outline:"none"}})})]}):y.jsxs("div",{ref:g,className:"relative",children:[y.jsxs("label",{className:"block text-sm text-gray-600 mb-1",children:[r,i&&" *"]}),y.jsxs("button",{type:"button",onClick:()=>o(!a),className:"w-full flex items-center justify-between px-3 py-1.5 bg-white rounded text-sm text-gray-600 hover:bg-blue-50 transition-colors text-left",style:{border:"none",outline:"none"},children:[y.jsxs("span",{className:I==="-maak een keuze-"?"text-gray-400":"",children:[I,E&&y.jsx(pL,{size:12,className:"inline ml-1 text-orange-500"})]}),y.jsx(fR,{size:14,className:`text-gray-400 transition-transform ${a?"rotate-180":""}`})]}),a&&y.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-white rounded shadow-lg max-h-48 overflow-y-auto",children:[y.jsx("button",{type:"button",onClick:()=>{e("-maak een keuze-"),o(!1)},className:`w-full px-3 py-1.5 text-left text-sm transition-colors ${!n||n==="-maak een keuze-"?"bg-blue-50 text-blue-600":"text-gray-400 hover:bg-blue-50"}`,style:{border:"none",outline:"none"},children:"-maak een keuze-"}),y.jsxs("button",{type:"button",onClick:x,className:"w-full px-3 py-1.5 text-left text-sm text-orange-600 hover:bg-orange-50 transition-colors flex items-center gap-2",style:{border:"none",outline:"none"},children:[y.jsx(pL,{size:12}),"Vrije invoer"]}),y.jsx("div",{className:"border-t border-gray-100 my-1"}),t.map(P=>y.jsx("button",{type:"button",onClick:()=>{e(P),o(!1)},className:`w-full px-3 py-1.5 text-left text-sm transition-colors ${P===n?"bg-blue-50 text-blue-600":"text-gray-600 hover:bg-blue-50"}`,style:{border:"none",outline:"none"},children:P},P))]})]})}function twe({onClose:n,initialLocation:e}){const t=m1(ie=>ie.user),r=qi(ie=>ie.position),i=As(ie=>ie.map),s=zee(ie=>ie.addVondst),a=Ol(ie=>ie.addVondst),o=Ti(ie=>ie.vondstenLocalOnly),[l,u]=se.useState(""),[h,f]=se.useState(""),[g,p]=se.useState(""),[E,x]=se.useState(""),[w,T]=se.useState(!0),[I,P]=se.useState(!1),[N,D]=se.useState(""),[B,k]=se.useState(void 0),[C,M]=se.useState(void 0),[j,O]=se.useState(e?"map-pick":r?"gps":"map-center"),[W,F]=se.useState(e||null),[Te,Me]=se.useState(!1),Le=()=>{if(j==="gps"&&r)return{lat:r.lat,lng:r.lng};if(j==="map-pick"&&W)return W;if(i){const ie=i.getView().getCenter();if(ie){const[ne,ee]=fn(ie);return{lat:ee,lng:ne}}}return null},Re=Le();se.useEffect(()=>{if(!Te||!i)return;const ie=ne=>{const[ee,fe]=fn(ne.coordinate);F({lat:fe,lng:ee}),O("map-pick"),Me(!1)};return i.on("click",ie),()=>i.un("click",ie)},[Te,i]);const ue=()=>{Me(!0)},be=()=>{r&&(O("gps"),F(null))},ce=h&&h!=="-maak een keuze-",te=ie=>!ie||ie==="-maak een keuze-"?"":ie,V=async ie=>{ie.preventDefault();const ne=Le();if(!ne){alert("Geen locatie beschikbaar");return}if(!ce){alert("Kies een objecttype");return}if(!o&&!t){alert("Log in om vondsten in de cloud op te slaan");return}P(!0);try{if(o)a({location:{lat:ne.lat,lng:ne.lng},notes:l,objectType:te(h),material:te(g),period:te(E),photoUrl:N||void 0,weight:B,length:C}),alert("Vondst lokaal opgeslagen! ");else{const ee=te(h),fe=te(g),Oe=te(E);await s({userId:t.uid,location:{lat:ne.lat,lng:ne.lng,accuracy:j==="gps"?5:50},timestamp:new Date().toISOString(),photos:[],notes:l,objectType:ee,material:fe,period:Oe,tags:[Oe.toLowerCase(),ee.toLowerCase()].filter(Boolean),private:w}),alert("Vondst opgeslagen in cloud! ")}n()}catch(ee){alert("Fout bij opslaan: "+ee.message)}finally{P(!1)}};return Te?y.jsx(Kt.div,{className:"fixed bottom-0 left-0 right-0 z-[2000] p-4",initial:{y:100},animate:{y:0},exit:{y:100},children:y.jsxs("div",{className:"bg-orange-500 text-white rounded-lg shadow-xl p-4 flex items-center justify-between max-w-md mx-auto",children:[y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx(gL,{size:24,className:"animate-pulse"}),y.jsxs("div",{children:[y.jsx("div",{className:"font-medium",children:"Tik op de kaart"}),y.jsx("div",{className:"text-sm opacity-90",children:"om locatie te kiezen"})]})]}),y.jsx("button",{onClick:()=>Me(!1),className:"px-4 py-2 bg-white/20 hover:bg-white/30 rounded-lg transition-colors",children:"Annuleren"})]})}):y.jsx(Kt.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:y.jsxs(Kt.div,{className:"bg-white rounded-lg shadow-xl max-w-md w-full max-h-[90vh] overflow-y-auto",initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},children:[y.jsxs("div",{className:"sticky top-0 z-10 bg-gradient-to-r from-blue-500 to-blue-600 text-white px-4 py-3 flex justify-between items-center",children:[y.jsx("h2",{className:"text-lg font-semibold",children:"Nieuwe Vondst"}),y.jsx("button",{onClick:n,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none",children:""})]}),y.jsxs("form",{onSubmit:V,className:"p-4 space-y-3",children:[y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Locatie"}),y.jsxs("div",{className:"flex gap-2",children:[r&&j!=="gps"&&y.jsxs("button",{type:"button",onClick:be,className:"flex-1 flex items-center justify-center gap-1 px-3 py-1.5 text-xs bg-white text-green-700 rounded hover:bg-blue-50 transition-colors border-0 outline-none",children:[y.jsx(vR,{size:14}),y.jsx("span",{children:"GPS gebruiken"})]}),y.jsxs("button",{type:"button",onClick:ue,className:"flex-1 flex items-center justify-center gap-1 px-3 py-1.5 text-xs text-blue-700 rounded hover:bg-blue-50 transition-colors bg-white outline-none border-0",children:[y.jsx(gL,{size:14}),y.jsx("span",{children:"Kies op kaart"})]})]})]}),y.jsx(HS,{label:"Objecttype",value:h,onChange:f,options:["Munt","Aardewerk","Gesp","Fibula","Ring","Speld","Sieraad","Gereedschap","Wapen","Anders"],required:!0,placeholder:"Typ objecttype..."}),y.jsx(HS,{label:"Materiaal",value:g,onChange:p,options:["Brons","IJzer","Zilver","Goud","Keramiek","Steen","Glas","Onbekend"],placeholder:"Typ materiaal..."}),y.jsx(HS,{label:"Periode",value:E,onChange:x,options:["Romeins (12 v.Chr.-450 n.Chr.)","IJzertijd","Middeleeuws (450-1500)","Nieuwetijd (1500-1800)","Modern (1800+)","Onbekend"],placeholder:"Typ periode..."}),y.jsxs("div",{className:"flex gap-3",children:[y.jsxs("div",{className:"flex-1",children:[y.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Gewicht (g)"}),y.jsx("input",{type:"number",value:B??"",onChange:ie=>k(ie.target.value?parseFloat(ie.target.value):void 0),className:"w-full rounded px-3 py-1.5 bg-white outline-none text-sm text-gray-600 hover:bg-blue-50 transition-colors",style:{border:"none"},min:"0",step:"0.1"})]}),y.jsxs("div",{className:"flex-1",children:[y.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Lengte (mm)"}),y.jsx("input",{type:"number",value:C??"",onChange:ie=>M(ie.target.value?parseFloat(ie.target.value):void 0),className:"w-full rounded px-3 py-1.5 bg-white outline-none text-sm text-gray-600 hover:bg-blue-50 transition-colors",style:{border:"none"},min:"0",step:"0.1"})]})]}),y.jsxs("div",{children:[y.jsxs("label",{className:"block text-sm text-gray-600 mb-1 flex items-center gap-1",children:[y.jsx(yae,{size:12,className:"text-blue-500"}),"Foto link"]}),y.jsx("input",{type:"url",value:N,onChange:ie=>D(ie.target.value),className:"w-full rounded px-3 py-1.5 bg-white outline-none text-sm text-gray-600 hover:bg-blue-50 transition-colors",style:{border:"none"},placeholder:"Bijvoorbeeld https://photos.google.com/..."})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Notities"}),y.jsx("textarea",{value:l,onChange:ie=>u(ie.target.value),className:"w-full rounded px-3 py-1.5 h-16 bg-white outline-none text-sm text-gray-600 hover:bg-blue-50 transition-colors resize-none",style:{border:"none"},placeholder:"Beschrijving..."})]}),y.jsx("p",{className:"text-xs text-gray-400",children:"Vondsten worden lokaal opgeslagen op dit apparaat."}),y.jsxs("div",{className:"flex gap-2",children:[y.jsx("button",{type:"button",onClick:n,className:"flex-1 px-4 py-1.5 rounded hover:bg-blue-50 transition-colors bg-white outline-none text-sm text-gray-600",style:{border:"none"},children:"Annuleren"}),y.jsx("button",{type:"submit",disabled:I||!Re||Te||!ce,className:"flex-1 px-4 py-1.5 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50 outline-none text-sm",style:{border:"none"},children:I?"Opslaan...":"Opslaan"})]})]})]})})}function nwe(){const{user:n,setUser:e,setLoading:t}=m1();return se.useEffect(()=>{const s=o6(Hf,a=>{e(a),t(!1)});return()=>s()},[e,t]),{user:n,loginAnonymous:async()=>{try{await lX(Hf)}catch(s){console.error("Login failed:",s)}},logout:async()=>{try{await l6(Hf)}catch(s){console.error("Logout failed:",s)}},isAuthenticated:!!n}}function rwe(){const{isAuthenticated:n,loginAnonymous:e}=nwe(),t=Ti(u=>u.vondstenLocalOnly),r=Ti(u=>u.showVondstButton),i=Fi(u=>u.vondstFormOpen),s=Fi(u=>u.vondstFormLocation),a=Fi(u=>u.openVondstForm),o=Fi(u=>u.closeVondstForm);if(!r)return null;const l=()=>{if(t){a();return}if(!n){confirm("Je moet ingelogd zijn om vondsten in de cloud op te slaan. Anoniem inloggen?")&&e();return}a()};return y.jsxs(y.Fragment,{children:[y.jsx(Kt.button,{className:"fixed bottom-2 right-[60px] z-[1000] w-11 h-11 bg-orange-500 hover:bg-orange-600 text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},onClick:l,title:"Vondst toevoegen",children:y.jsx(fu,{size:22,strokeWidth:2})}),y.jsx(Yr,{children:i&&y.jsx(twe,{onClose:o,initialLocation:s||void 0})})]})}const NO={Munt:"#f59e0b",Aardewerk:"#a16207",Gesp:"#6b7280",Fibula:"#8b5cf6",Ring:"#ec4899",Speld:"#6366f1",Sieraad:"#f43f5e",Gereedschap:"#64748b",Wapen:"#ef4444",Anders:"#3b82f6"},iwe={Munt:"M",Aardewerk:"A",Gesp:"G",Fibula:"F",Ring:"R",Speld:"S",Sieraad:"Si",Gereedschap:"Gr",Wapen:"W",Anders:"?"};function swe(){const n=As(i=>i.map),e=Ol(i=>i.vondsten),t=ii(i=>i.visible["Mijn Vondsten"]),r=se.useRef(null);return se.useEffect(()=>{if(!n)return;const i=new $p;return e.forEach(s=>{const a=new eo({geometry:new to(Nh([s.location.lng,s.location.lat])),vondst:s}),o=NO[s.objectType]||NO.Anders,l=iwe[s.objectType]||"?";a.setStyle((u,h)=>{let E=12;h>50?E=6:h>10?E=Math.max(6,12-(h-10)/10):h<2&&(E=14);const x=Math.max(8,Math.min(12,E-2));return new ur({image:new Dl({radius:E,fill:new oi({color:o}),stroke:new _s({color:"#ffffff",width:E>8?2:1})}),text:E>=8?new sd({text:l,font:`bold ${x}px sans-serif`,fill:new oi({color:"#ffffff"}),offsetY:1}):void 0})}),i.addFeature(a)}),r.current?r.current.setSource(i):(r.current=new Xp({source:i,zIndex:1e3,properties:{title:"Mijn Vondsten"}}),r.current.setVisible(t),n.addLayer(r.current)),()=>{r.current&&n&&(n.removeLayer(r.current),r.current=null)}},[n,e]),se.useEffect(()=>{r.current&&r.current.setVisible(t)},[t]),null}const awe={Mineraal:"M",Fossiel:"F",Erfgoed:"E",Monument:"Mo",Overig:""};function owe(){const n=As(r=>r.map),e=qs(r=>r.layers),t=se.useRef(new Map);return se.useEffect(()=>{if(!n)return;const r=new Set(e.map(i=>i.id));return t.current.forEach((i,s)=>{r.has(s)||(n.removeLayer(i),t.current.delete(s))}),e.forEach(i=>{const s=new $p;i.points.forEach(o=>{const l=new eo({geometry:new to(Nh(o.coordinates)),layerType:"customPoint",customPoint:o,customLayerId:i.id,customLayerName:i.name,customLayerColor:i.color}),u=awe[o.category]||o.category.charAt(0).toUpperCase();l.setStyle((h,f)=>{let x=12;f>50?x=6:f>10?x=Math.max(6,12-(f-10)/10):f<2&&(x=14);const w=Math.max(8,Math.min(12,x-2));return new ur({image:new Dl({radius:x,fill:new oi({color:i.color}),stroke:new _s({color:"#ffffff",width:x>8?2:1})}),text:x>=8?new sd({text:u,font:`bold ${w}px sans-serif`,fill:new oi({color:"#ffffff"}),offsetY:1}):void 0})}),s.addFeature(l)});const a=t.current.get(i.id);if(a)a.setSource(s),a.setVisible(i.visible);else{const o=new Xp({source:s,zIndex:950,properties:{title:i.name,customPointLayerId:i.id},visible:i.visible});n.addLayer(o),t.current.set(i.id,o)}}),()=>{t.current.forEach(i=>{n&&n.removeLayer(i)}),t.current.clear()}},[n,e]),null}function lwe(){const{createLayerModalOpen:n,closeCreateLayerModal:e}=Fi(),{addLayer:t}=qs(),r=Ti(),[i,s]=se.useState(""),[a,o]=se.useState([...Mc]),[l,u]=se.useState(""),h=14*r.fontScale/100,f=()=>{const w=l.trim();w&&!a.includes(w)&&(o([...a,w]),u(""))},g=w=>{o(a.filter(T=>T!==w))},p=w=>{a.includes(w)?o(a.filter(T=>T!==w)):o([...a,w])},E=()=>{i.trim()&&(t(i.trim(),a),s(""),o([...Mc]),u(""),e())},x=()=>{s(""),o([...Mc]),u(""),e()};return y.jsx(Yr,{children:n&&y.jsxs(y.Fragment,{children:[y.jsx(Kt.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:x}),y.jsxs(Kt.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-sm mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[y.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx(Ko,{size:18}),y.jsx("span",{className:"font-medium",children:"Nieuwe laag"})]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),y.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:r.fontScale,onChange:w=>r.setFontScale(parseInt(w.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${r.fontScale}%`}),y.jsx("span",{className:"text-xs opacity-70",children:"T"}),y.jsx("button",{onClick:x,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:y.jsx(Aa,{size:18})})]})]}),y.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",style:{fontSize:`${h}px`},children:[y.jsxs("div",{children:[y.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Naam van de laag"}),y.jsx("input",{type:"text",value:i,onChange:w=>s(w.target.value),placeholder:"bijv. Vakantie Frankrijk 2026",className:"w-full px-3 py-2 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"},autoFocus:!0})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block font-medium text-gray-700 mb-2",style:{fontSize:"0.9em"},children:"Categorien"}),y.jsx("div",{className:"flex flex-wrap gap-2",children:Mc.map(w=>y.jsx("button",{onClick:()=>p(w),className:`px-3 py-1 rounded-full transition-colors border-0 outline-none ${a.includes(w)?"bg-orange-500 text-white":"bg-white text-gray-600 hover:bg-blue-50"}`,style:{fontSize:"0.9em"},children:w},w))})]}),a.filter(w=>!Mc.includes(w)).length>0&&y.jsxs("div",{children:[y.jsx("label",{className:"block font-medium text-gray-700 mb-2",style:{fontSize:"0.9em"},children:"Eigen categorien"}),y.jsx("div",{className:"flex flex-wrap gap-2",children:a.filter(w=>!Mc.includes(w)).map(w=>y.jsxs("button",{onClick:()=>g(w),className:"flex items-center gap-1 px-3 py-1 rounded-full bg-orange-500 text-white hover:bg-orange-600 transition-colors border-0 outline-none",style:{fontSize:"0.9em"},children:[w,y.jsx(B0,{size:12})]},w))})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Eigen categorie toevoegen"}),y.jsxs("div",{className:"flex gap-2",children:[y.jsx("input",{type:"text",value:l,onChange:w=>u(w.target.value),placeholder:"bijv. Grot, Bron, ...",className:"flex-1 px-3 py-2 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"},onKeyDown:w=>w.key==="Enter"&&f()}),y.jsx("button",{onClick:f,disabled:!l.trim(),className:"px-3 py-2 bg-white hover:bg-blue-50 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg transition-colors border-0 outline-none text-gray-600",children:y.jsx(Go,{size:20})})]})]})]}),y.jsxs("div",{className:"p-4 flex gap-3",style:{fontSize:`${h}px`},children:[y.jsx("button",{onClick:x,className:"flex-1 px-4 py-2 bg-white hover:bg-blue-50 rounded-lg transition-colors border-0 outline-none text-gray-600",style:{fontSize:"1em"},children:"Annuleren"}),y.jsx("button",{onClick:E,disabled:!i.trim(),className:"flex-1 px-4 py-2 bg-orange-500 hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg transition-colors border-0 outline-none",style:{fontSize:"1em"},children:"Aanmaken"})]})]})]})})}function cwe(){const{addPointModalOpen:n,addPointModalLayerId:e,addPointModalLocation:t,closeAddPointModal:r}=Fi(),{addPoint:i,getLayer:s}=qs(),a=Ti(),[o,l]=se.useState(""),[u,h]=se.useState(""),[f,g]=se.useState(""),p=e?s(e):null,E=14*a.fontScale/100,x=()=>{!o.trim()||!e||!t||(i(e,{name:o.trim(),category:"Overig",notes:u.trim(),url:f.trim()||void 0,coordinates:[t.lng,t.lat]}),l(""),h(""),g(""),r())},w=()=>{l(""),h(""),g(""),r()};return p?y.jsx(Yr,{children:n&&y.jsxs(y.Fragment,{children:[y.jsx(Kt.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:w}),y.jsxs(Kt.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-sm mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[y.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx(fu,{size:18}),y.jsx("span",{className:"font-medium",children:"Punt toevoegen"})]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),y.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:a.fontScale,onChange:T=>a.setFontScale(parseInt(T.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${a.fontScale}%`}),y.jsx("span",{className:"text-xs opacity-70",children:"T"}),y.jsx("button",{onClick:w,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:y.jsx(Aa,{size:18})})]})]}),y.jsx("div",{className:"px-4 py-1.5",children:y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:p.color}}),y.jsx("span",{className:"text-sm text-gray-600",children:p.name})]})}),y.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",style:{fontSize:`${E}px`},children:[y.jsxs("div",{children:[y.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Naam *"}),y.jsx("input",{type:"text",value:o,onChange:T=>l(T.target.value),className:"w-full px-3 py-1.5 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"},autoFocus:!0})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Notities"}),y.jsx("textarea",{value:u,onChange:T=>h(T.target.value),placeholder:"Beschrijving, tips, opmerkingen...",rows:2,className:"w-full px-3 py-1.5 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors resize-none",style:{fontSize:"1em"}})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Link"}),y.jsx("input",{type:"url",value:f,onChange:T=>g(T.target.value),placeholder:"https://...",className:"w-full px-3 py-1.5 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"}})]})]}),y.jsxs("div",{className:"p-3 flex gap-3",style:{fontSize:`${E}px`},children:[y.jsx("button",{onClick:w,className:"flex-1 px-4 py-1.5 bg-white hover:bg-blue-50 rounded-lg transition-colors border-0 outline-none text-gray-600",style:{fontSize:"1em"},children:"Annuleren"}),y.jsx("button",{onClick:x,disabled:!o.trim(),className:"flex-1 px-4 py-1.5 bg-orange-500 hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg transition-colors border-0 outline-none",style:{fontSize:"1em"},children:"Toevoegen"})]})]})]})}):null}function uwe(){const{layerManagerModalOpen:n,closeLayerManagerModal:e,openCreateLayerModal:t,openLayerDashboard:r}=Fi(),{layers:i,removeLayer:s,toggleVisibility:a,toggleArchived:o,exportLayerAsGeoJSON:l,importLayerFromGeoJSON:u}=qs(),h=Ti(),f=14*h.fontScale/100,[g,p]=se.useState(null),[E,x]=se.useState(null),[w,T]=se.useState(null),[I,P]=se.useState(!1),N=i.filter(F=>!F.archived),D=i.filter(F=>F.archived),B=I?D:N,k=F=>{E===F?(s(F),x(null)):(x(F),setTimeout(()=>x(null),3e3))},C=F=>{l(F)},M=async F=>{const Te=F.target.files?.[0];if(Te){try{const Me=await Te.text(),Le=u(Me);Le.success||(T(Le.error||"Import mislukt"),setTimeout(()=>T(null),3e3))}catch{T("Kon bestand niet lezen"),setTimeout(()=>T(null),3e3)}F.target.value=""}},j=()=>{p(null),x(null),T(null),P(!1),e()},O=F=>{r(F)},W=()=>{j(),t()};return y.jsx(Yr,{children:n&&y.jsxs(y.Fragment,{children:[y.jsx(Kt.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:j}),y.jsxs(Kt.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[y.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx(Ko,{size:18}),y.jsx("span",{className:"font-medium",children:"Mijn Lagen beheren"})]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),y.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:h.fontScale,onChange:F=>h.setFontScale(parseInt(F.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${h.fontScale}%`}),y.jsx("span",{className:"text-xs opacity-70",children:"T"}),y.jsx("button",{onClick:j,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:y.jsx(Aa,{size:18})})]})]}),y.jsxs("div",{className:"flex border-b border-gray-100",children:[y.jsxs("button",{onClick:()=>P(!1),className:`flex-1 px-3 py-2 text-sm transition-colors border-0 outline-none ${I?"text-gray-500 hover:text-gray-700 hover:bg-gray-50":"text-orange-600 border-b-2 border-orange-500 bg-orange-50/50"}`,children:["Actief (",N.length,")"]}),y.jsxs("button",{onClick:()=>P(!0),className:`flex-1 px-3 py-2 text-sm transition-colors border-0 outline-none flex items-center justify-center gap-1 ${I?"text-orange-600 border-b-2 border-orange-500 bg-orange-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[y.jsx(xj,{size:14}),"Archief (",D.length,")"]})]}),y.jsxs("div",{className:"flex-1 overflow-y-auto",style:{fontSize:`${f}px`},children:[B.length===0?y.jsx("div",{className:"p-8 text-center text-gray-500",children:I?y.jsx("p",{style:{fontSize:"1em"},children:"Geen gearchiveerde lagen."}):y.jsxs(y.Fragment,{children:[y.jsx("p",{className:"mb-4",style:{fontSize:"1em"},children:"Je hebt nog geen eigen lagen."}),y.jsxs("button",{onClick:W,className:"px-4 py-2 bg-orange-500 hover:bg-orange-600 text-white rounded-lg transition-colors border-0 outline-none",style:{fontSize:"1em"},children:[y.jsx(Go,{size:16,className:"inline mr-2"}),"Nieuwe laag aanmaken"]})]})}):y.jsx("div",{className:"divide-y divide-gray-100",children:B.map(F=>y.jsx(hwe,{layer:F,isExpanded:g===F.id,onToggleExpand:()=>p(g===F.id?null:F.id),onToggleVisibility:()=>a(F.id),onToggleArchived:()=>o(F.id),onOpenDashboard:()=>O(F.id),onExport:()=>C(F.id),onDelete:()=>k(F.id),confirmDelete:E===F.id,onRename:Te=>qs.getState().updateLayer(F.id,{name:Te})},F.id))}),w&&y.jsx("div",{className:"mx-4 my-2 p-3 bg-red-50 text-red-700 text-sm rounded-lg",children:w})]}),y.jsxs("div",{className:"p-4 flex gap-3",style:{fontSize:`${f}px`},children:[y.jsxs("label",{className:"flex-1 px-4 py-2 bg-white hover:bg-blue-50 rounded-lg transition-colors cursor-pointer flex items-center justify-center gap-2 border-0 outline-none text-gray-600",children:[y.jsx(ER,{size:16}),y.jsx("span",{style:{fontSize:"1em"},children:"Importeren"}),y.jsx("input",{type:"file",accept:".geojson,.json",onChange:M,className:"hidden"})]}),y.jsxs("button",{onClick:W,className:"flex-1 px-4 py-2 bg-orange-500 hover:bg-orange-600 text-white rounded-lg transition-colors border-0 outline-none flex items-center justify-center gap-2",style:{fontSize:"1em"},children:[y.jsx(Go,{size:16}),y.jsx("span",{children:"Nieuwe laag"})]})]})]})]})})}function hwe({layer:n,isExpanded:e,onToggleExpand:t,onToggleVisibility:r,onToggleArchived:i,onOpenDashboard:s,onExport:a,onDelete:o,confirmDelete:l,onRename:u}){const[h,f]=se.useState(!1),[g,p]=se.useState(n.name),E=se.useRef(null);se.useEffect(()=>{h&&E.current&&(E.current.focus(),E.current.select())},[h]);const x=()=>{p(n.name),f(!0)},w=()=>{const D=g.trim();D&&D!==n.name&&u(D),f(!1)},T=()=>{p(n.name),f(!1)},I=D=>{D.key==="Enter"?w():D.key==="Escape"&&T()},P=n.points.filter(D=>D.status==="completed").length,N=n.points.length;return y.jsxs("div",{className:"bg-white",children:[y.jsxs("div",{className:"flex items-center gap-3 px-4 py-3",children:[y.jsx("button",{onClick:t,className:"p-1 text-gray-400 hover:text-gray-600 transition-colors border-0 outline-none bg-transparent",children:e?y.jsx(fR,{size:16}):y.jsx(ME,{size:16})}),y.jsx("div",{className:"w-4 h-4 rounded-full flex-shrink-0",style:{backgroundColor:n.color}}),h?y.jsxs("div",{className:"flex-1 min-w-0 flex items-center gap-2",children:[y.jsx("input",{ref:E,type:"text",value:g,onChange:D=>p(D.target.value),onKeyDown:I,onBlur:w,className:"flex-1 px-2 py-1 text-gray-800 font-medium bg-orange-50 rounded outline-none focus:ring-2 focus:ring-orange-400"}),y.jsx("button",{onClick:w,className:"p-1 text-green-600 hover:bg-green-50 rounded transition-colors border-0 outline-none",title:"Opslaan",children:y.jsx(v1,{size:16})})]}):y.jsxs("button",{onClick:s,className:"flex-1 min-w-0 text-left border-0 outline-none bg-transparent hover:bg-orange-50 rounded px-2 py-1 -ml-2 transition-colors",title:"Bekijk dashboard",children:[y.jsx("div",{className:"font-medium text-gray-800 truncate hover:text-orange-600",children:n.name}),y.jsx("div",{className:"text-xs text-gray-500",children:N>0?y.jsxs("span",{className:P===N?"text-green-600":"",children:[P,"/",N," voltooid"]}):"Geen punten"})]}),!h&&y.jsx("button",{onClick:x,className:"p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",title:"Naam bewerken",children:y.jsx(vI,{size:16})}),y.jsx("button",{onClick:s,className:"p-2 text-orange-400 hover:text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none",title:"Open dashboard",children:y.jsx(xae,{size:18})}),!n.archived&&y.jsx("button",{onClick:r,className:`p-2 rounded transition-colors border-0 outline-none ${n.visible?"text-blue-500 hover:bg-blue-50":"text-gray-400 hover:bg-gray-100"}`,title:n.visible?"Verbergen":"Tonen",children:n.visible?y.jsx(mR,{size:18}):y.jsx(gR,{size:18})}),y.jsx("button",{onClick:i,className:`p-2 rounded transition-colors border-0 outline-none ${n.archived?"text-green-500 hover:text-green-600 hover:bg-green-50":"text-gray-400 hover:text-amber-600 hover:bg-amber-50"}`,title:n.archived?"Herstellen":"Archiveren",children:n.archived?y.jsx(Pse,{size:18}):y.jsx(xj,{size:18})}),y.jsx("button",{onClick:a,className:"p-2 text-gray-400 hover:text-green-600 hover:bg-green-50 rounded transition-colors border-0 outline-none",title:"Exporteren als GeoJSON",children:y.jsx(yI,{size:18})}),y.jsx("button",{onClick:o,className:`p-2 rounded transition-colors border-0 outline-none ${l?"text-white bg-red-500 hover:bg-red-600":"text-gray-400 hover:text-red-600 hover:bg-red-50"}`,title:l?"Klik nogmaals om te verwijderen":"Verwijderen",children:y.jsx(B0,{size:18})})]}),y.jsx(Yr,{children:e&&y.jsx(Kt.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:y.jsxs("div",{className:"px-4 pb-3 pl-12 space-y-2",children:[n.categories.length>0&&y.jsx("div",{className:"flex flex-wrap gap-1",children:n.categories.map(D=>y.jsx("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-600 text-xs rounded-full",children:D},D))}),n.points.length>0&&y.jsxs("div",{className:"text-xs text-gray-500 space-y-1 max-h-32 overflow-y-auto",children:[n.points.slice(0,5).map(D=>y.jsx("div",{className:"flex items-center gap-2",children:y.jsx("span",{className:`font-medium ${D.status==="completed"?"text-green-600 line-through":D.status==="skipped"?"text-gray-400 line-through":"text-gray-700"}`,children:D.name})},D.id)),n.points.length>5&&y.jsxs("div",{className:"text-gray-400",children:["...en ",n.points.length-5," meer"]})]}),y.jsxs("div",{className:"text-xs text-gray-400",children:["Aangemaakt: ",new Date(n.createdAt).toLocaleDateString("nl-NL")]})]})})})]})}function dwe(){const{layerDashboardOpen:n,layerDashboardLayerId:e,closeLayerDashboard:t}=Fi(),{getLayer:r,setPointStatus:i,updatePoint:s,removePoint:a}=qs(),o=Ti(),[l,u]=se.useState("all"),[h,f]=se.useState(null),[g,p]=se.useState(""),[E,x]=se.useState(null),w=e?r(e):null,T=14*o.fontScale/100;if(!w)return null;const I=w.points.filter(O=>l==="all"?!0:O.status===l),P=w.points.length,N=w.points.filter(O=>O.status==="completed").length,D=w.points.filter(O=>O.status==="todo").length,B=w.points.filter(O=>O.status==="skipped").length,k=(O,W)=>{i(w.id,O,W)},C=O=>{s(w.id,O,{notes:g}),f(null),p("")},M=O=>{E===O?(a(w.id,O),x(null)):(x(O),setTimeout(()=>x(null),3e3))},j=()=>{f(null),x(null),t()};return y.jsx(Yr,{children:n&&y.jsxs(y.Fragment,{children:[y.jsx(Kt.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:j}),y.jsxs(Kt.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[y.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("div",{className:"w-4 h-4 rounded-full border-2 border-white/50",style:{backgroundColor:w.color}}),y.jsx("span",{className:"font-medium truncate",children:w.name})]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),y.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:o.fontScale,onChange:O=>o.setFontScale(parseInt(O.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${o.fontScale}%`}),y.jsx("span",{className:"text-xs opacity-70",children:"T"}),y.jsx("button",{onClick:j,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:y.jsx(Aa,{size:18})})]})]}),y.jsxs("div",{className:"px-4 py-2 bg-orange-50 flex items-center justify-between text-sm",children:[y.jsxs("span",{className:"text-orange-800 font-medium",children:[N,"/",P," voltooid"]}),y.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[y.jsxs("span",{className:"text-orange-600",children:[D," te doen"]}),B>0&&y.jsxs("span",{className:"text-gray-500",children:[B," overgeslagen"]})]})]}),y.jsx("div",{className:"flex border-b border-gray-100",children:["all","todo","completed","skipped"].map(O=>y.jsxs("button",{onClick:()=>u(O),className:`flex-1 px-3 py-2 text-sm transition-colors border-0 outline-none ${l===O?"text-orange-600 border-b-2 border-orange-500 bg-orange-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[O==="all"&&"Alles",O==="todo"&&"Te doen",O==="completed"&&"Voltooid",O==="skipped"&&"Overgeslagen"]},O))}),y.jsx("div",{className:"flex-1 overflow-y-auto",style:{fontSize:`${T}px`},children:I.length===0?y.jsx("div",{className:"p-8 text-center text-gray-500",children:y.jsx("p",{children:"Geen punten gevonden"})}):y.jsx("div",{className:"divide-y divide-gray-100",children:I.map(O=>y.jsx("div",{className:"p-3",children:y.jsxs("div",{className:"flex items-start gap-3",children:[y.jsxs("div",{className:"flex flex-col gap-1 pt-0.5",children:[y.jsx("button",{onClick:()=>k(O.id,O.status==="completed"?"todo":"completed"),className:`w-6 h-6 flex items-center justify-center rounded border-0 outline-none transition-colors ${O.status==="completed"?"bg-green-100 hover:bg-green-200":"bg-gray-100 hover:bg-green-100"}`,title:O.status==="completed"?"Markeer als te doen":"Markeer als voltooid",children:y.jsx(v1,{size:14,className:O.status==="completed"?"text-green-600":"text-gray-400"})}),y.jsx("button",{onClick:()=>k(O.id,O.status==="skipped"?"todo":"skipped"),className:`w-6 h-6 flex items-center justify-center rounded border-0 outline-none transition-colors ${O.status==="skipped"?"bg-gray-200 hover:bg-gray-300":"bg-gray-100 hover:bg-gray-200"}`,title:O.status==="skipped"?"Markeer als te doen":"Overslaan",children:y.jsx(Nse,{size:14,className:O.status==="skipped"?"text-gray-600":"text-gray-400"})})]}),y.jsxs("div",{className:"flex-1 min-w-0",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("span",{className:`font-medium truncate ${O.status==="completed"?"text-green-700 line-through":O.status==="skipped"?"text-gray-400 line-through":"text-gray-800"}`,children:O.name}),O.sourceLayer&&y.jsxs("span",{className:"text-xs text-gray-400 truncate",children:["via ",O.sourceLayer]})]}),h===O.id?y.jsxs("div",{className:"mt-2",children:[y.jsx("textarea",{value:g,onChange:W=>p(W.target.value),placeholder:"Notities...",rows:2,className:"w-full px-2 py-1 bg-white rounded border-0 outline-none hover:bg-blue-50 transition-colors resize-none text-sm",autoFocus:!0}),y.jsxs("div",{className:"flex gap-2 mt-1",children:[y.jsx("button",{onClick:()=>C(O.id),className:"px-2 py-1 text-xs bg-orange-500 text-white rounded hover:bg-orange-600 border-0 outline-none",children:"Opslaan"}),y.jsx("button",{onClick:()=>{f(null),p("")},className:"px-2 py-1 text-xs bg-white text-gray-600 rounded hover:bg-blue-50 border-0 outline-none",children:"Annuleren"})]})]}):O.notes?y.jsx("p",{className:"text-sm text-gray-600 mt-1",children:O.notes}):null,O.url&&y.jsxs("a",{href:O.url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-xs text-blue-500 hover:text-blue-700 mt-1",children:[y.jsx(E1,{size:12}),"Link"]})]}),y.jsxs("div",{className:"flex flex-col gap-1",children:[y.jsx("button",{onClick:()=>{f(O.id),p(O.notes)},className:"w-6 h-6 flex items-center justify-center text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded border-0 outline-none",title:"Notities bewerken",children:y.jsx(Oae,{size:14})}),y.jsx("button",{onClick:()=>{window.open(`https://www.google.com/maps/dir/?api=1&destination=${O.coordinates[1]},${O.coordinates[0]}`,"_blank")},className:"w-6 h-6 flex items-center justify-center text-blue-400 hover:text-blue-600 hover:bg-blue-50 rounded border-0 outline-none",title:"Navigeer naar",children:y.jsx(fu,{size:14})}),y.jsx("button",{onClick:()=>M(O.id),className:`w-6 h-6 flex items-center justify-center rounded border-0 outline-none ${E===O.id?"text-white bg-red-500 hover:bg-red-600":"text-gray-400 hover:text-red-600 hover:bg-red-50"}`,title:E===O.id?"Klik nogmaals":"Verwijderen",children:y.jsx(B0,{size:14})})]})]})},O.id))})})]})]})})}class LO{buffer=[];size;weights;constructor(e=8){this.size=e,this.weights=Array.from({length:e},(r,i)=>Math.pow(2,i));const t=this.weights.reduce((r,i)=>r+i,0);this.weights=this.weights.map(r=>r/t)}add(e){if(this.buffer.length>0){const t=this.buffer[this.buffer.length-1];let r=e-t;r>180&&(e-=360),r<-180&&(e+=360)}this.buffer.push(e),this.buffer.length>this.size&&this.buffer.shift()}getSmoothed(){if(this.buffer.length===0)return null;if(this.buffer.length===1)return this.normalizeHeading(this.buffer[0]);let e=0,t=0;const r=this.size-this.buffer.length;for(let i=0;i<this.buffer.length;i++){const s=this.weights[r+i];e+=this.buffer[i]*s,t+=s}return this.normalizeHeading(e/t)}normalizeHeading(e){return(e%360+360)%360}clear(){this.buffer=[]}}function fwe(){const n=qi(u=>u.tracking),e=qi(u=>u.headingSource);qi(u=>u.speed);const t=qi(u=>u.setSmoothedHeading),r=se.useRef(new LO(6)),i=se.useRef(new LO(10)),s=se.useRef(0),a=se.useRef(null),o=33,l=se.useCallback((u,h)=>{const f=performance.now();if(f-s.current<o)return;const g=h==="gps"?r.current:i.current;g.add(u);const p=g.getSmoothed();p!==null&&(s.current=f,t(p))},[t]);se.useEffect(()=>{if(!n)return;const u=f=>{f.coords.heading!==null&&f.coords.speed!==null&&f.coords.speed>.8&&f.coords.accuracy<20&&l(f.coords.heading,"gps")},h=navigator.geolocation.watchPosition(u,()=>{},{enableHighAccuracy:!0,maximumAge:500,timeout:1e4});return()=>navigator.geolocation.clearWatch(h)},[n,l]),se.useEffect(()=>{if(!n||e!=="compass")return;let u=0;const h=50,f=p=>{const E=performance.now();if(!(E-u<h)&&(u=E,p.alpha!==null)){const x=(360-p.alpha)%360;l(x,"compass")}},g=p=>{const E=performance.now();E-u<h||(u=E,p.webkitCompassHeading!==void 0&&l(p.webkitCompassHeading,"compass"))};return window.addEventListener("deviceorientationabsolute",f),window.addEventListener("deviceorientation",g),()=>{window.removeEventListener("deviceorientationabsolute",f),window.removeEventListener("deviceorientation",g)}},[n,e,l]),se.useEffect(()=>{n||(r.current.clear(),i.current.clear())},[n]),se.useEffect(()=>()=>{a.current&&cancelAnimationFrame(a.current)},[])}function gwe(){const n=As(i=>i.map),e=ii(i=>i.setLayerOpacity),t=ii(i=>i.visible),r=se.useRef(null);se.useEffect(()=>{if(!n)return;const i=()=>{const s=n.getView().getZoom();if(!s||r.current!==null&&Math.abs(s-r.current)<.5)return;r.current=s;const a=t["AHN 0.5m"],o=t["AHN4 Multi-Hillshade NL"];!a&&!o||(a&&(s>=18?e("AHN 0.5m",.85):s>=16?e("AHN 0.5m",.75):s>=14?e("AHN 0.5m",.65):e("AHN 0.5m",.55)),o&&(s>=18?e("AHN4 Multi-Hillshade NL",.8):s>=16?e("AHN4 Multi-Hillshade NL",.7):s>=14?e("AHN4 Multi-Hillshade NL",.6):e("AHN4 Multi-Hillshade NL",.5)))};return n.on("moveend",i),i(),()=>{n.un("moveend",i)}},[n,t,e])}const OO=2e3;function mwe(){const n=m1(g=>g.user),{layers:e,clearAll:t}=qs(),{vondsten:r,clearAll:i}=Ol(),s=se.useRef(null),a=se.useRef(!0),o=se.useRef(""),l=se.useRef(""),u=se.useCallback(async g=>{if(n)try{const p=$f($c,"users",n.uid);await B3(p,{layers:g,layersUpdatedAt:U3()},{merge:!0}),console.log(" Lagen gesynchroniseerd naar cloud")}catch(p){console.error(" Fout bij synchroniseren lagen:",p)}},[n]),h=se.useCallback(async g=>{if(n)try{const p=$f($c,"users",n.uid);await B3(p,{vondsten:g,vondstenUpdatedAt:U3()},{merge:!0}),console.log(" Vondsten gesynchroniseerd naar cloud")}catch(p){console.error(" Fout bij synchroniseren vondsten:",p)}},[n]),f=se.useCallback(async()=>{if(n)try{const g=$f($c,"users",n.uid),p=await oee(g);if(p.exists()){const E=p.data();if(E.layers&&Array.isArray(E.layers)){const x=E.layers,w=qs.getState().layers,T=[...x],I=new Set(x.map(P=>P.id));w.forEach(P=>{I.has(P.id)||T.push(P)}),qs.setState({layers:T}),o.current=JSON.stringify(T),console.log(` ${x.length} lagen geladen uit cloud`)}if(E.vondsten&&Array.isArray(E.vondsten)){const x=E.vondsten,w=Ol.getState().vondsten,T=[...x],I=new Set(x.map(P=>P.id));w.forEach(P=>{I.has(P.id)||T.push(P)}),Ol.setState({vondsten:T}),l.current=JSON.stringify(T),console.log(` ${x.length} vondsten geladen uit cloud`)}}else console.log(" Geen cloud data gevonden, lokale data wordt gesynchroniseerd..."),await u(e),await h(r);a.current=!1}catch(g){console.error(" Fout bij laden uit cloud:",g),a.current=!1}},[n,e,r,u,h]);return se.useEffect(()=>{n?(a.current=!0,f()):(a.current=!0,o.current="",l.current="")},[n?.uid]),se.useEffect(()=>{if(!n||a.current)return;const g=JSON.stringify(e);if(g!==o.current)return s.current&&clearTimeout(s.current),s.current=setTimeout(()=>{o.current=g,u(e)},OO),()=>{s.current&&clearTimeout(s.current)}},[n,e,u]),se.useEffect(()=>{if(!n||a.current)return;const g=JSON.stringify(r);if(g!==l.current)return s.current&&clearTimeout(s.current),s.current=setTimeout(()=>{l.current=g,h(r)},OO),()=>{s.current&&clearTimeout(s.current)}},[n,r,h]),{isLoggedIn:!!n,syncLayersToCloud:u,syncVondstenToCloud:h}}function pwe(){fwe(),gwe(),mwe();const e=14*Ti(t=>t.fontScale)/100;return y.jsx(MEe,{children:y.jsxs("div",{style:{fontSize:`${e}px`},children:[y.jsx(Zee,{}),y.jsx(foe,{}),y.jsx(swe,{}),y.jsx(jEe,{}),y.jsx(owe,{}),y.jsx(hEe,{}),y.jsx(dEe,{}),y.jsx(CEe,{}),y.jsx(hoe,{}),y.jsx(PEe,{}),y.jsx(moe,{}),y.jsx(poe,{}),y.jsx(REe,{}),y.jsx(gEe,{}),y.jsx(fEe,{}),y.jsx(xEe,{}),y.jsx(rwe,{}),y.jsx(EEe,{}),y.jsx(IEe,{}),y.jsx(QEe,{}),y.jsx(lwe,{}),y.jsx(cwe,{}),y.jsx(uwe,{}),y.jsx(dwe,{})]})})}const ywe="2.22.5";console.log(`%c DetectorApp v${ywe}`,"background: #4CAF50; color: white; padding: 4px 8px; border-radius: 4px; font-weight: bold;");SB.createRoot(document.getElementById("root")).render(y.jsx(pwe,{}));export{Dl as C,oi as F,NR as G,aW as I,zo as L,to as P,ur as S,Ju as T,Xp as V,BW as a,NW as b,_s as c,$p as d,sd as e,eo as f,Nh as g,Hp as h,gn as p,A7 as r};
//# sourceMappingURL=index-BBBYK3JD.js.map
