const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/caiVlaanderenOL-FQQHFneP.js","assets/GeoJSON-C7etc6NX.js","assets/belgieErfgoedLayers-Bl4GEtDb.js","assets/frankrijkMonumentenOL-Bg7vx75P.js","assets/iconStyles-85kkWpN3.js","assets/inrapSitesFROL-D4BUPHvR.js","assets/archeoBretagneOL-CvTCNk69.js","assets/bretagneOperationsOL-D0rf4asp.js","assets/parisArcheoOL-BP5avWyA.js","assets/occitaniePatrimoineOL-Bj_1sFI-.js","assets/pacaPatrimoineOL-DlZfw0K5.js","assets/wikimaginotOL-CV_kGGWV.js","assets/normandiePatrimoineOL-B1AT3OHt.js","assets/amkOL-BHRXGoVd.js","assets/layerLoaderOL-DgnN2AZ1.js","assets/archisOL-CuZ44hyi.js","assets/romeinsOL-DL_NPOxn.js","assets/toestemmingenOL-3BJ7lO_n.js","assets/castellaPuntenOL-Cl_tS_vK.js","assets/castellaLijnenOL-CAhaXq9c.js","assets/oppidaOL-CEYwJQ2W.js","assets/kastelenOL-CV-Pke2S.js","assets/veengebiedenOL-CUZ2lvpU.js","assets/krommeRijnAardewerkOL-bw2pCOsj.js","assets/hunebeddenOL-B2JpHNnt.js","assets/euroevolOL-C6gUEJUm.js","assets/uikavArcheoPuntenOL-ESiDlRBw.js","assets/proj4-CWrqRc9L.js","assets/uikavVlakkenOL-CfC9lJyr.js","assets/uikavBufferlaagOL-gTu2vPn1.js","assets/uikavExpertOL-TqlSQsyu.js","assets/uikavUiterwaardenOL-C1PH1MPQ.js","assets/speeltuinenOL-Bazh29sr.js","assets/museaOL-CYAbdBv5.js","assets/strandjesOL-DGgTQWt5.js","assets/parkenOL-BjT30Wt6.js","assets/kringloopwinkelsOL-wQQZqqLV.js","assets/fossielenOL-JpOTWWwG.js","assets/fossielUtils-DOVYdJ0p.js","assets/fossielenBelgieOL-DNwEQAqb.js","assets/fossielenDuitslandOL-CVUOws08.js","assets/fossielenFrankrijkOL-CR9RTMpg.js","assets/viciOL-DnbPobHB.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();function Dw(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Gv={exports:{}},Pd={},jv={exports:{}},Qe={};var R2;function W3(){if(R2)return Qe;R2=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),o=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),g=Symbol.iterator;function m($){return $===null||typeof $!="object"?null:($=g&&$[g]||$["@@iterator"],typeof $=="function"?$:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,T={};function w($,K,Pe){this.props=$,this.context=K,this.refs=T,this.updater=Pe||v}w.prototype.isReactComponent={},w.prototype.setState=function($,K){if(typeof $!="object"&&typeof $!="function"&&$!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,$,K,"setState")},w.prototype.forceUpdate=function($){this.updater.enqueueForceUpdate(this,$,"forceUpdate")};function A(){}A.prototype=w.prototype;function P($,K,Pe){this.props=$,this.context=K,this.refs=T,this.updater=Pe||v}var M=P.prototype=new A;M.constructor=P,y(M,w.prototype),M.isPureReactComponent=!0;var k=Array.isArray,N=Object.prototype.hasOwnProperty,B={current:null},b={key:!0,ref:!0,__self:!0,__source:!0};function R($,K,Pe){var Ce,Me={},Ve=null,Ge=null;if(K!=null)for(Ce in K.ref!==void 0&&(Ge=K.ref),K.key!==void 0&&(Ve=""+K.key),K)N.call(K,Ce)&&!b.hasOwnProperty(Ce)&&(Me[Ce]=K[Ce]);var Ke=arguments.length-2;if(Ke===1)Me.children=Pe;else if(1<Ke){for(var Ye=Array(Ke),yt=0;yt<Ke;yt++)Ye[yt]=arguments[yt+2];Me.children=Ye}if($&&$.defaultProps)for(Ce in Ke=$.defaultProps,Ke)Me[Ce]===void 0&&(Me[Ce]=Ke[Ce]);return{$$typeof:n,type:$,key:Ve,ref:Ge,props:Me,_owner:B.current}}function L($,K){return{$$typeof:n,type:$.type,key:K,ref:$.ref,props:$.props,_owner:$._owner}}function V($){return typeof $=="object"&&$!==null&&$.$$typeof===n}function F($){var K={"=":"=0",":":"=2"};return"$"+$.replace(/[=:]/g,function(Pe){return K[Pe]})}var U=/\/+/g;function D($,K){return typeof $=="object"&&$!==null&&$.key!=null?F(""+$.key):K.toString(36)}function le($,K,Pe,Ce,Me){var Ve=typeof $;(Ve==="undefined"||Ve==="boolean")&&($=null);var Ge=!1;if($===null)Ge=!0;else switch(Ve){case"string":case"number":Ge=!0;break;case"object":switch($.$$typeof){case n:case e:Ge=!0}}if(Ge)return Ge=$,Me=Me(Ge),$=Ce===""?"."+D(Ge,0):Ce,k(Me)?(Pe="",$!=null&&(Pe=$.replace(U,"$&/")+"/"),le(Me,K,Pe,"",function(yt){return yt})):Me!=null&&(V(Me)&&(Me=L(Me,Pe+(!Me.key||Ge&&Ge.key===Me.key?"":(""+Me.key).replace(U,"$&/")+"/")+$)),K.push(Me)),1;if(Ge=0,Ce=Ce===""?".":Ce+":",k($))for(var Ke=0;Ke<$.length;Ke++){Ve=$[Ke];var Ye=Ce+D(Ve,Ke);Ge+=le(Ve,K,Pe,Ye,Me)}else if(Ye=m($),typeof Ye=="function")for($=Ye.call($),Ke=0;!(Ve=$.next()).done;)Ve=Ve.value,Ye=Ce+D(Ve,Ke++),Ge+=le(Ve,K,Pe,Ye,Me);else if(Ve==="object")throw K=String($),Error("Objects are not valid as a React child (found: "+(K==="[object Object]"?"object with keys {"+Object.keys($).join(", ")+"}":K)+"). If you meant to render a collection of children, use an array instead.");return Ge}function we($,K,Pe){if($==null)return $;var Ce=[],Me=0;return le($,Ce,"","",function(Ve){return K.call(Pe,Ve,Me++)}),Ce}function ye($){if($._status===-1){var K=$._result;K=K(),K.then(function(Pe){($._status===0||$._status===-1)&&($._status=1,$._result=Pe)},function(Pe){($._status===0||$._status===-1)&&($._status=2,$._result=Pe)}),$._status===-1&&($._status=0,$._result=K)}if($._status===1)return $._result.default;throw $._result}var de={current:null},J={transition:null},ae={ReactCurrentDispatcher:de,ReactCurrentBatchConfig:J,ReactCurrentOwner:B};function ie(){throw Error("act(...) is not supported in production builds of React.")}return Qe.Children={map:we,forEach:function($,K,Pe){we($,function(){K.apply(this,arguments)},Pe)},count:function($){var K=0;return we($,function(){K++}),K},toArray:function($){return we($,function(K){return K})||[]},only:function($){if(!V($))throw Error("React.Children.only expected to receive a single React element child.");return $}},Qe.Component=w,Qe.Fragment=t,Qe.Profiler=r,Qe.PureComponent=P,Qe.StrictMode=i,Qe.Suspense=u,Qe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ae,Qe.act=ie,Qe.cloneElement=function($,K,Pe){if($==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+$+".");var Ce=y({},$.props),Me=$.key,Ve=$.ref,Ge=$._owner;if(K!=null){if(K.ref!==void 0&&(Ve=K.ref,Ge=B.current),K.key!==void 0&&(Me=""+K.key),$.type&&$.type.defaultProps)var Ke=$.type.defaultProps;for(Ye in K)N.call(K,Ye)&&!b.hasOwnProperty(Ye)&&(Ce[Ye]=K[Ye]===void 0&&Ke!==void 0?Ke[Ye]:K[Ye])}var Ye=arguments.length-2;if(Ye===1)Ce.children=Pe;else if(1<Ye){Ke=Array(Ye);for(var yt=0;yt<Ye;yt++)Ke[yt]=arguments[yt+2];Ce.children=Ke}return{$$typeof:n,type:$.type,key:Me,ref:Ve,props:Ce,_owner:Ge}},Qe.createContext=function($){return $={$$typeof:o,_currentValue:$,_currentValue2:$,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},$.Provider={$$typeof:s,_context:$},$.Consumer=$},Qe.createElement=R,Qe.createFactory=function($){var K=R.bind(null,$);return K.type=$,K},Qe.createRef=function(){return{current:null}},Qe.forwardRef=function($){return{$$typeof:a,render:$}},Qe.isValidElement=V,Qe.lazy=function($){return{$$typeof:d,_payload:{_status:-1,_result:$},_init:ye}},Qe.memo=function($,K){return{$$typeof:h,type:$,compare:K===void 0?null:K}},Qe.startTransition=function($){var K=J.transition;J.transition={};try{$()}finally{J.transition=K}},Qe.unstable_act=ie,Qe.useCallback=function($,K){return de.current.useCallback($,K)},Qe.useContext=function($){return de.current.useContext($)},Qe.useDebugValue=function(){},Qe.useDeferredValue=function($){return de.current.useDeferredValue($)},Qe.useEffect=function($,K){return de.current.useEffect($,K)},Qe.useId=function(){return de.current.useId()},Qe.useImperativeHandle=function($,K,Pe){return de.current.useImperativeHandle($,K,Pe)},Qe.useInsertionEffect=function($,K){return de.current.useInsertionEffect($,K)},Qe.useLayoutEffect=function($,K){return de.current.useLayoutEffect($,K)},Qe.useMemo=function($,K){return de.current.useMemo($,K)},Qe.useReducer=function($,K,Pe){return de.current.useReducer($,K,Pe)},Qe.useRef=function($){return de.current.useRef($)},Qe.useState=function($){return de.current.useState($)},Qe.useSyncExternalStore=function($,K,Pe){return de.current.useSyncExternalStore($,K,Pe)},Qe.useTransition=function(){return de.current.useTransition()},Qe.version="18.3.1",Qe}var P2;function fg(){return P2||(P2=1,jv.exports=W3()),jv.exports}var C2;function K3(){if(C2)return Pd;C2=1;var n=fg(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,r=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(a,u,h){var d,g={},m=null,v=null;h!==void 0&&(m=""+h),u.key!==void 0&&(m=""+u.key),u.ref!==void 0&&(v=u.ref);for(d in u)i.call(u,d)&&!s.hasOwnProperty(d)&&(g[d]=u[d]);if(a&&a.defaultProps)for(d in u=a.defaultProps,u)g[d]===void 0&&(g[d]=u[d]);return{$$typeof:e,type:a,key:m,ref:v,props:g,_owner:r.current}}return Pd.Fragment=t,Pd.jsx=o,Pd.jsxs=o,Pd}var M2;function H3(){return M2||(M2=1,Gv.exports=K3()),Gv.exports}var G=H3(),ip={},Uv={exports:{}},wi={},Bv={exports:{}},zv={};var b2;function q3(){return b2||(b2=1,(function(n){function e(J,ae){var ie=J.length;J.push(ae);e:for(;0<ie;){var $=ie-1>>>1,K=J[$];if(0<r(K,ae))J[$]=ae,J[ie]=K,ie=$;else break e}}function t(J){return J.length===0?null:J[0]}function i(J){if(J.length===0)return null;var ae=J[0],ie=J.pop();if(ie!==ae){J[0]=ie;e:for(var $=0,K=J.length,Pe=K>>>1;$<Pe;){var Ce=2*($+1)-1,Me=J[Ce],Ve=Ce+1,Ge=J[Ve];if(0>r(Me,ie))Ve<K&&0>r(Ge,Me)?(J[$]=Ge,J[Ve]=ie,$=Ve):(J[$]=Me,J[Ce]=ie,$=Ce);else if(Ve<K&&0>r(Ge,ie))J[$]=Ge,J[Ve]=ie,$=Ve;else break e}}return ae}function r(J,ae){var ie=J.sortIndex-ae.sortIndex;return ie!==0?ie:J.id-ae.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var u=[],h=[],d=1,g=null,m=3,v=!1,y=!1,T=!1,w=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,P=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function M(J){for(var ae=t(h);ae!==null;){if(ae.callback===null)i(h);else if(ae.startTime<=J)i(h),ae.sortIndex=ae.expirationTime,e(u,ae);else break;ae=t(h)}}function k(J){if(T=!1,M(J),!y)if(t(u)!==null)y=!0,ye(N);else{var ae=t(h);ae!==null&&de(k,ae.startTime-J)}}function N(J,ae){y=!1,T&&(T=!1,A(R),R=-1),v=!0;var ie=m;try{for(M(ae),g=t(u);g!==null&&(!(g.expirationTime>ae)||J&&!F());){var $=g.callback;if(typeof $=="function"){g.callback=null,m=g.priorityLevel;var K=$(g.expirationTime<=ae);ae=n.unstable_now(),typeof K=="function"?g.callback=K:g===t(u)&&i(u),M(ae)}else i(u);g=t(u)}if(g!==null)var Pe=!0;else{var Ce=t(h);Ce!==null&&de(k,Ce.startTime-ae),Pe=!1}return Pe}finally{g=null,m=ie,v=!1}}var B=!1,b=null,R=-1,L=5,V=-1;function F(){return!(n.unstable_now()-V<L)}function U(){if(b!==null){var J=n.unstable_now();V=J;var ae=!0;try{ae=b(!0,J)}finally{ae?D():(B=!1,b=null)}}else B=!1}var D;if(typeof P=="function")D=function(){P(U)};else if(typeof MessageChannel<"u"){var le=new MessageChannel,we=le.port2;le.port1.onmessage=U,D=function(){we.postMessage(null)}}else D=function(){w(U,0)};function ye(J){b=J,B||(B=!0,D())}function de(J,ae){R=w(function(){J(n.unstable_now())},ae)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(J){J.callback=null},n.unstable_continueExecution=function(){y||v||(y=!0,ye(N))},n.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<J?Math.floor(1e3/J):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_getFirstCallbackNode=function(){return t(u)},n.unstable_next=function(J){switch(m){case 1:case 2:case 3:var ae=3;break;default:ae=m}var ie=m;m=ae;try{return J()}finally{m=ie}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(J,ae){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var ie=m;m=J;try{return ae()}finally{m=ie}},n.unstable_scheduleCallback=function(J,ae,ie){var $=n.unstable_now();switch(typeof ie=="object"&&ie!==null?(ie=ie.delay,ie=typeof ie=="number"&&0<ie?$+ie:$):ie=$,J){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=ie+K,J={id:d++,callback:ae,priorityLevel:J,startTime:ie,expirationTime:K,sortIndex:-1},ie>$?(J.sortIndex=ie,e(h,J),t(u)===null&&J===t(h)&&(T?(A(R),R=-1):T=!0,de(k,ie-$))):(J.sortIndex=K,e(u,J),y||v||(y=!0,ye(N))),J},n.unstable_shouldYield=F,n.unstable_wrapCallback=function(J){var ae=m;return function(){var ie=m;m=ae;try{return J.apply(this,arguments)}finally{m=ie}}}})(zv)),zv}var L2;function X3(){return L2||(L2=1,Bv.exports=q3()),Bv.exports}var k2;function Y3(){if(k2)return wi;k2=1;var n=fg(),e=X3();function t(l){for(var c="https://reactjs.org/docs/error-decoder.html?invariant="+l,f=1;f<arguments.length;f++)c+="&args[]="+encodeURIComponent(arguments[f]);return"Minified React error #"+l+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,r={};function s(l,c){o(l,c),o(l+"Capture",c)}function o(l,c){for(r[l]=c,l=0;l<c.length;l++)i.add(c[l])}var a=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},g={};function m(l){return u.call(g,l)?!0:u.call(d,l)?!1:h.test(l)?g[l]=!0:(d[l]=!0,!1)}function v(l,c,f,_){if(f!==null&&f.type===0)return!1;switch(typeof c){case"function":case"symbol":return!0;case"boolean":return _?!1:f!==null?!f.acceptsBooleans:(l=l.toLowerCase().slice(0,5),l!=="data-"&&l!=="aria-");default:return!1}}function y(l,c,f,_){if(c===null||typeof c>"u"||v(l,c,f,_))return!0;if(_)return!1;if(f!==null)switch(f.type){case 3:return!c;case 4:return c===!1;case 5:return isNaN(c);case 6:return isNaN(c)||1>c}return!1}function T(l,c,f,_,E,x,C){this.acceptsBooleans=c===2||c===3||c===4,this.attributeName=_,this.attributeNamespace=E,this.mustUseProperty=f,this.propertyName=l,this.type=c,this.sanitizeURL=x,this.removeEmptyString=C}var w={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(l){w[l]=new T(l,0,!1,l,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(l){var c=l[0];w[c]=new T(c,1,!1,l[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(l){w[l]=new T(l,2,!1,l.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(l){w[l]=new T(l,2,!1,l,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(l){w[l]=new T(l,3,!1,l.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(l){w[l]=new T(l,3,!0,l,null,!1,!1)}),["capture","download"].forEach(function(l){w[l]=new T(l,4,!1,l,null,!1,!1)}),["cols","rows","size","span"].forEach(function(l){w[l]=new T(l,6,!1,l,null,!1,!1)}),["rowSpan","start"].forEach(function(l){w[l]=new T(l,5,!1,l.toLowerCase(),null,!1,!1)});var A=/[\-:]([a-z])/g;function P(l){return l[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(l){var c=l.replace(A,P);w[c]=new T(c,1,!1,l,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(l){var c=l.replace(A,P);w[c]=new T(c,1,!1,l,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(l){var c=l.replace(A,P);w[c]=new T(c,1,!1,l,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(l){w[l]=new T(l,1,!1,l.toLowerCase(),null,!1,!1)}),w.xlinkHref=new T("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(l){w[l]=new T(l,1,!1,l.toLowerCase(),null,!0,!0)});function M(l,c,f,_){var E=w.hasOwnProperty(c)?w[c]:null;(E!==null?E.type!==0:_||!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(y(c,f,E,_)&&(f=null),_||E===null?m(c)&&(f===null?l.removeAttribute(c):l.setAttribute(c,""+f)):E.mustUseProperty?l[E.propertyName]=f===null?E.type===3?!1:"":f:(c=E.attributeName,_=E.attributeNamespace,f===null?l.removeAttribute(c):(E=E.type,f=E===3||E===4&&f===!0?"":""+f,_?l.setAttributeNS(_,c,f):l.setAttribute(c,f))))}var k=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,N=Symbol.for("react.element"),B=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),R=Symbol.for("react.strict_mode"),L=Symbol.for("react.profiler"),V=Symbol.for("react.provider"),F=Symbol.for("react.context"),U=Symbol.for("react.forward_ref"),D=Symbol.for("react.suspense"),le=Symbol.for("react.suspense_list"),we=Symbol.for("react.memo"),ye=Symbol.for("react.lazy"),de=Symbol.for("react.offscreen"),J=Symbol.iterator;function ae(l){return l===null||typeof l!="object"?null:(l=J&&l[J]||l["@@iterator"],typeof l=="function"?l:null)}var ie=Object.assign,$;function K(l){if($===void 0)try{throw Error()}catch(f){var c=f.stack.trim().match(/\n( *(at )?)/);$=c&&c[1]||""}return`
`+$+l}var Pe=!1;function Ce(l,c){if(!l||Pe)return"";Pe=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(c)if(c=function(){throw Error()},Object.defineProperty(c.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(c,[])}catch(Z){var _=Z}Reflect.construct(l,[],c)}else{try{c.call()}catch(Z){_=Z}l.call(c.prototype)}else{try{throw Error()}catch(Z){_=Z}l()}}catch(Z){if(Z&&_&&typeof Z.stack=="string"){for(var E=Z.stack.split(`
`),x=_.stack.split(`
`),C=E.length-1,j=x.length-1;1<=C&&0<=j&&E[C]!==x[j];)j--;for(;1<=C&&0<=j;C--,j--)if(E[C]!==x[j]){if(C!==1||j!==1)do if(C--,j--,0>j||E[C]!==x[j]){var z=`
`+E[C].replace(" at new "," at ");return l.displayName&&z.includes("<anonymous>")&&(z=z.replace("<anonymous>",l.displayName)),z}while(1<=C&&0<=j);break}}}finally{Pe=!1,Error.prepareStackTrace=f}return(l=l?l.displayName||l.name:"")?K(l):""}function Me(l){switch(l.tag){case 5:return K(l.type);case 16:return K("Lazy");case 13:return K("Suspense");case 19:return K("SuspenseList");case 0:case 2:case 15:return l=Ce(l.type,!1),l;case 11:return l=Ce(l.type.render,!1),l;case 1:return l=Ce(l.type,!0),l;default:return""}}function Ve(l){if(l==null)return null;if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case b:return"Fragment";case B:return"Portal";case L:return"Profiler";case R:return"StrictMode";case D:return"Suspense";case le:return"SuspenseList"}if(typeof l=="object")switch(l.$$typeof){case F:return(l.displayName||"Context")+".Consumer";case V:return(l._context.displayName||"Context")+".Provider";case U:var c=l.render;return l=l.displayName,l||(l=c.displayName||c.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case we:return c=l.displayName||null,c!==null?c:Ve(l.type)||"Memo";case ye:c=l._payload,l=l._init;try{return Ve(l(c))}catch{}}return null}function Ge(l){var c=l.type;switch(l.tag){case 24:return"Cache";case 9:return(c.displayName||"Context")+".Consumer";case 10:return(c._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return l=c.render,l=l.displayName||l.name||"",c.displayName||(l!==""?"ForwardRef("+l+")":"ForwardRef");case 7:return"Fragment";case 5:return c;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ve(c);case 8:return c===R?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c}return null}function Ke(l){switch(typeof l){case"boolean":case"number":case"string":case"undefined":return l;case"object":return l;default:return""}}function Ye(l){var c=l.type;return(l=l.nodeName)&&l.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function yt(l){var c=Ye(l)?"checked":"value",f=Object.getOwnPropertyDescriptor(l.constructor.prototype,c),_=""+l[c];if(!l.hasOwnProperty(c)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var E=f.get,x=f.set;return Object.defineProperty(l,c,{configurable:!0,get:function(){return E.call(this)},set:function(C){_=""+C,x.call(this,C)}}),Object.defineProperty(l,c,{enumerable:f.enumerable}),{getValue:function(){return _},setValue:function(C){_=""+C},stopTracking:function(){l._valueTracker=null,delete l[c]}}}}function Ar(l){l._valueTracker||(l._valueTracker=yt(l))}function js(l){if(!l)return!1;var c=l._valueTracker;if(!c)return!0;var f=c.getValue(),_="";return l&&(_=Ye(l)?l.checked?"true":"false":l.value),l=_,l!==f?(c.setValue(l),!0):!1}function fi(l){if(l=l||(typeof document<"u"?document:void 0),typeof l>"u")return null;try{return l.activeElement||l.body}catch{return l.body}}function gi(l,c){var f=c.checked;return ie({},c,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:f??l._wrapperState.initialChecked})}function Rn(l,c){var f=c.defaultValue==null?"":c.defaultValue,_=c.checked!=null?c.checked:c.defaultChecked;f=Ke(c.value!=null?c.value:f),l._wrapperState={initialChecked:_,initialValue:f,controlled:c.type==="checkbox"||c.type==="radio"?c.checked!=null:c.value!=null}}function Pn(l,c){c=c.checked,c!=null&&M(l,"checked",c,!1)}function mi(l,c){Pn(l,c);var f=Ke(c.value),_=c.type;if(f!=null)_==="number"?(f===0&&l.value===""||l.value!=f)&&(l.value=""+f):l.value!==""+f&&(l.value=""+f);else if(_==="submit"||_==="reset"){l.removeAttribute("value");return}c.hasOwnProperty("value")?Rt(l,c.type,f):c.hasOwnProperty("defaultValue")&&Rt(l,c.type,Ke(c.defaultValue)),c.checked==null&&c.defaultChecked!=null&&(l.defaultChecked=!!c.defaultChecked)}function er(l,c,f){if(c.hasOwnProperty("value")||c.hasOwnProperty("defaultValue")){var _=c.type;if(!(_!=="submit"&&_!=="reset"||c.value!==void 0&&c.value!==null))return;c=""+l._wrapperState.initialValue,f||c===l.value||(l.value=c),l.defaultValue=c}f=l.name,f!==""&&(l.name=""),l.defaultChecked=!!l._wrapperState.initialChecked,f!==""&&(l.name=f)}function Rt(l,c,f){(c!=="number"||fi(l.ownerDocument)!==l)&&(f==null?l.defaultValue=""+l._wrapperState.initialValue:l.defaultValue!==""+f&&(l.defaultValue=""+f))}var vt=Array.isArray;function yn(l,c,f,_){if(l=l.options,c){c={};for(var E=0;E<f.length;E++)c["$"+f[E]]=!0;for(f=0;f<l.length;f++)E=c.hasOwnProperty("$"+l[f].value),l[f].selected!==E&&(l[f].selected=E),E&&_&&(l[f].defaultSelected=!0)}else{for(f=""+Ke(f),c=null,E=0;E<l.length;E++){if(l[E].value===f){l[E].selected=!0,_&&(l[E].defaultSelected=!0);return}c!==null||l[E].disabled||(c=l[E])}c!==null&&(c.selected=!0)}}function tr(l,c){if(c.dangerouslySetInnerHTML!=null)throw Error(t(91));return ie({},c,{value:void 0,defaultValue:void 0,children:""+l._wrapperState.initialValue})}function Dt(l,c){var f=c.value;if(f==null){if(f=c.children,c=c.defaultValue,f!=null){if(c!=null)throw Error(t(92));if(vt(f)){if(1<f.length)throw Error(t(93));f=f[0]}c=f}c==null&&(c=""),f=c}l._wrapperState={initialValue:Ke(f)}}function bo(l,c){var f=Ke(c.value),_=Ke(c.defaultValue);f!=null&&(f=""+f,f!==l.value&&(l.value=f),c.defaultValue==null&&l.defaultValue!==f&&(l.defaultValue=f)),_!=null&&(l.defaultValue=""+_)}function nr(l){var c=l.textContent;c===l._wrapperState.initialValue&&c!==""&&c!==null&&(l.value=c)}function Qr(l){switch(l){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Rr(l,c){return l==null||l==="http://www.w3.org/1999/xhtml"?Qr(c):l==="http://www.w3.org/2000/svg"&&c==="foreignObject"?"http://www.w3.org/1999/xhtml":l}var Jr,Za=(function(l){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(c,f,_,E){MSApp.execUnsafeLocalFunction(function(){return l(c,f,_,E)})}:l})(function(l,c){if(l.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in l)l.innerHTML=c;else{for(Jr=Jr||document.createElement("div"),Jr.innerHTML="<svg>"+c.valueOf().toString()+"</svg>",c=Jr.firstChild;l.firstChild;)l.removeChild(l.firstChild);for(;c.firstChild;)l.appendChild(c.firstChild)}});function es(l,c){if(c){var f=l.firstChild;if(f&&f===l.lastChild&&f.nodeType===3){f.nodeValue=c;return}}l.textContent=c}var ir={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Cu=["Webkit","ms","Moz","O"];Object.keys(ir).forEach(function(l){Cu.forEach(function(c){c=c+l.charAt(0).toUpperCase()+l.substring(1),ir[c]=ir[l]})});function ts(l,c,f){return c==null||typeof c=="boolean"||c===""?"":f||typeof c!="number"||c===0||ir.hasOwnProperty(l)&&ir[l]?(""+c).trim():c+"px"}function Us(l,c){l=l.style;for(var f in c)if(c.hasOwnProperty(f)){var _=f.indexOf("--")===0,E=ts(f,c[f],_);f==="float"&&(f="cssFloat"),_?l.setProperty(f,E):l[f]=E}}var Lo=ie({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ii(l,c){if(c){if(Lo[l]&&(c.children!=null||c.dangerouslySetInnerHTML!=null))throw Error(t(137,l));if(c.dangerouslySetInnerHTML!=null){if(c.children!=null)throw Error(t(60));if(typeof c.dangerouslySetInnerHTML!="object"||!("__html"in c.dangerouslySetInnerHTML))throw Error(t(61))}if(c.style!=null&&typeof c.style!="object")throw Error(t(62))}}function Bs(l,c){if(l.indexOf("-")===-1)return typeof c.is=="string";switch(l){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ns=null;function is(l){return l=l.target||l.srcElement||window,l.correspondingUseElement&&(l=l.correspondingUseElement),l.nodeType===3?l.parentNode:l}var ri=null,si=null,It=null;function ko(l){if(l=fd(l)){if(typeof ri!="function")throw Error(t(280));var c=l.stateNode;c&&(c=ym(c),ri(l.stateNode,l.type,c))}}function Pr(l){si?It?It.push(l):It=[l]:si=l}function Yt(){if(si){var l=si,c=It;if(It=si=null,ko(l),c)for(l=0;l<c.length;l++)ko(c[l])}}function rr(l,c){return l(c)}function Cn(){}var Zt=!1;function Mn(l,c,f){if(Zt)return l(c,f);Zt=!0;try{return rr(l,c,f)}finally{Zt=!1,(si!==null||It!==null)&&(Cn(),Yt())}}function bn(l,c){var f=l.stateNode;if(f===null)return null;var _=ym(f);if(_===null)return null;f=_[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(_=!_.disabled)||(l=l.type,_=!(l==="button"||l==="input"||l==="select"||l==="textarea")),l=!_;break e;default:l=!1}if(l)return null;if(f&&typeof f!="function")throw Error(t(231,c,typeof f));return f}var vn=!1;if(a)try{var ct={};Object.defineProperty(ct,"passive",{get:function(){vn=!0}}),window.addEventListener("test",ct,ct),window.removeEventListener("test",ct,ct)}catch{vn=!1}function rn(l,c,f,_,E,x,C,j,z){var Z=Array.prototype.slice.call(arguments,3);try{c.apply(f,Z)}catch(oe){this.onError(oe)}}var cn=!1,sr=null,Mu=!1,or=null,Yg={onError:function(l){cn=!0,sr=l}};function Zg(l,c,f,_,E,x,C,j,z){cn=!1,sr=null,rn.apply(Yg,arguments)}function Uh(l,c,f,_,E,x,C,j,z){if(Zg.apply(this,arguments),cn){if(cn){var Z=sr;cn=!1,sr=null}else throw Error(t(198));Mu||(Mu=!0,or=Z)}}function Cr(l){var c=l,f=l;if(l.alternate)for(;c.return;)c=c.return;else{l=c;do c=l,(c.flags&4098)!==0&&(f=c.return),l=c.return;while(l)}return c.tag===3?f:null}function Bh(l){if(l.tag===13){var c=l.memoizedState;if(c===null&&(l=l.alternate,l!==null&&(c=l.memoizedState)),c!==null)return c.dehydrated}return null}function Qg(l){if(Cr(l)!==l)throw Error(t(188))}function Jg(l){var c=l.alternate;if(!c){if(c=Cr(l),c===null)throw Error(t(188));return c!==l?null:l}for(var f=l,_=c;;){var E=f.return;if(E===null)break;var x=E.alternate;if(x===null){if(_=E.return,_!==null){f=_;continue}break}if(E.child===x.child){for(x=E.child;x;){if(x===f)return Qg(E),l;if(x===_)return Qg(E),c;x=x.sibling}throw Error(t(188))}if(f.return!==_.return)f=E,_=x;else{for(var C=!1,j=E.child;j;){if(j===f){C=!0,f=E,_=x;break}if(j===_){C=!0,_=E,f=x;break}j=j.sibling}if(!C){for(j=x.child;j;){if(j===f){C=!0,f=x,_=E;break}if(j===_){C=!0,_=x,f=E;break}j=j.sibling}if(!C)throw Error(t(189))}}if(f.alternate!==_)throw Error(t(190))}if(f.tag!==3)throw Error(t(188));return f.stateNode.current===f?l:c}function em(l){return l=Jg(l),l!==null?Qa(l):null}function Qa(l){if(l.tag===5||l.tag===6)return l;for(l=l.child;l!==null;){var c=Qa(l);if(c!==null)return c;l=l.sibling}return null}var zh=e.unstable_scheduleCallback,bu=e.unstable_cancelCallback,Ja=e.unstable_shouldYield,zs=e.unstable_requestPaint,Ct=e.unstable_now,py=e.unstable_getCurrentPriorityLevel,Lu=e.unstable_ImmediatePriority,$h=e.unstable_UserBlockingPriority,el=e.unstable_NormalPriority,Wh=e.unstable_LowPriority,ku=e.unstable_IdlePriority,tl=null,Di=null;function tm(l){if(Di&&typeof Di.onCommitFiberRoot=="function")try{Di.onCommitFiberRoot(tl,l,void 0,(l.current.flags&128)===128)}catch{}}var Ni=Math.clz32?Math.clz32:nl,rs=Math.log,ar=Math.LN2;function nl(l){return l>>>=0,l===0?32:31-(rs(l)/ar|0)|0}var ss=64,Do=4194304;function ht(l){switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return l&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return l}}function $s(l,c){var f=l.pendingLanes;if(f===0)return 0;var _=0,E=l.suspendedLanes,x=l.pingedLanes,C=f&268435455;if(C!==0){var j=C&~E;j!==0?_=ht(j):(x&=C,x!==0&&(_=ht(x)))}else C=f&~E,C!==0?_=ht(C):x!==0&&(_=ht(x));if(_===0)return 0;if(c!==0&&c!==_&&(c&E)===0&&(E=_&-_,x=c&-c,E>=x||E===16&&(x&4194240)!==0))return c;if((_&4)!==0&&(_|=f&16),c=l.entangledLanes,c!==0)for(l=l.entanglements,c&=_;0<c;)f=31-Ni(c),E=1<<f,_|=l[f],c&=~E;return _}function il(l,c){switch(l){case 1:case 2:case 4:return c+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function rl(l,c){for(var f=l.suspendedLanes,_=l.pingedLanes,E=l.expirationTimes,x=l.pendingLanes;0<x;){var C=31-Ni(x),j=1<<C,z=E[C];z===-1?((j&f)===0||(j&_)!==0)&&(E[C]=il(j,c)):z<=c&&(l.expiredLanes|=j),x&=~j}}function Kh(l){return l=l.pendingLanes&-1073741825,l!==0?l:l&1073741824?1073741824:0}function Hh(){var l=ss;return ss<<=1,(ss&4194240)===0&&(ss=64),l}function qh(l){for(var c=[],f=0;31>f;f++)c.push(l);return c}function sl(l,c,f){l.pendingLanes|=c,c!==536870912&&(l.suspendedLanes=0,l.pingedLanes=0),l=l.eventTimes,c=31-Ni(c),l[c]=f}function _y(l,c){var f=l.pendingLanes&~c;l.pendingLanes=c,l.suspendedLanes=0,l.pingedLanes=0,l.expiredLanes&=c,l.mutableReadLanes&=c,l.entangledLanes&=c,c=l.entanglements;var _=l.eventTimes;for(l=l.expirationTimes;0<f;){var E=31-Ni(f),x=1<<E;c[E]=0,_[E]=-1,l[E]=-1,f&=~x}}function Xh(l,c){var f=l.entangledLanes|=c;for(l=l.entanglements;f;){var _=31-Ni(f),E=1<<_;E&c|l[_]&c&&(l[_]|=c),f&=~E}}var tt=0;function os(l){return l&=-l,1<l?4<l?(l&268435455)!==0?16:536870912:4:1}var Yh,Du,Zh,Qh,Jh,as=!1,Nu=[],ls=null,us=null,Ln=null,ol=new Map,Ws=new Map,Oi=[],nm="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function No(l,c){switch(l){case"focusin":case"focusout":ls=null;break;case"dragenter":case"dragleave":us=null;break;case"mouseover":case"mouseout":Ln=null;break;case"pointerover":case"pointerout":ol.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ws.delete(c.pointerId)}}function Mr(l,c,f,_,E,x){return l===null||l.nativeEvent!==x?(l={blockedOn:c,domEventName:f,eventSystemFlags:_,nativeEvent:x,targetContainers:[E]},c!==null&&(c=fd(c),c!==null&&Du(c)),l):(l.eventSystemFlags|=_,c=l.targetContainers,E!==null&&c.indexOf(E)===-1&&c.push(E),l)}function im(l,c,f,_,E){switch(c){case"focusin":return ls=Mr(ls,l,c,f,_,E),!0;case"dragenter":return us=Mr(us,l,c,f,_,E),!0;case"mouseover":return Ln=Mr(Ln,l,c,f,_,E),!0;case"pointerover":var x=E.pointerId;return ol.set(x,Mr(ol.get(x)||null,l,c,f,_,E)),!0;case"gotpointercapture":return x=E.pointerId,Ws.set(x,Mr(Ws.get(x)||null,l,c,f,_,E)),!0}return!1}function Ou(l){var c=cl(l.target);if(c!==null){var f=Cr(c);if(f!==null){if(c=f.tag,c===13){if(c=Bh(f),c!==null){l.blockedOn=c,Jh(l.priority,function(){Zh(f)});return}}else if(c===3&&f.stateNode.current.memoizedState.isDehydrated){l.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}l.blockedOn=null}function At(l){if(l.blockedOn!==null)return!1;for(var c=l.targetContainers;0<c.length;){var f=Vu(l.domEventName,l.eventSystemFlags,c[0],l.nativeEvent);if(f===null){f=l.nativeEvent;var _=new f.constructor(f.type,f);ns=_,f.target.dispatchEvent(_),ns=null}else return c=fd(f),c!==null&&Du(c),l.blockedOn=f,!1;c.shift()}return!0}function rm(l,c,f){At(l)&&f.delete(c)}function yy(){as=!1,ls!==null&&At(ls)&&(ls=null),us!==null&&At(us)&&(us=null),Ln!==null&&At(Ln)&&(Ln=null),ol.forEach(rm),Ws.forEach(rm)}function Oo(l,c){l.blockedOn===c&&(l.blockedOn=null,as||(as=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,yy)))}function Vo(l){function c(E){return Oo(E,l)}if(0<Nu.length){Oo(Nu[0],l);for(var f=1;f<Nu.length;f++){var _=Nu[f];_.blockedOn===l&&(_.blockedOn=null)}}for(ls!==null&&Oo(ls,l),us!==null&&Oo(us,l),Ln!==null&&Oo(Ln,l),ol.forEach(c),Ws.forEach(c),f=0;f<Oi.length;f++)_=Oi[f],_.blockedOn===l&&(_.blockedOn=null);for(;0<Oi.length&&(f=Oi[0],f.blockedOn===null);)Ou(f),f.blockedOn===null&&Oi.shift()}var Ks=k.ReactCurrentBatchConfig,Hs=!0;function cs(l,c,f,_){var E=tt,x=Ks.transition;Ks.transition=null;try{tt=1,ed(l,c,f,_)}finally{tt=E,Ks.transition=x}}function sm(l,c,f,_){var E=tt,x=Ks.transition;Ks.transition=null;try{tt=4,ed(l,c,f,_)}finally{tt=E,Ks.transition=x}}function ed(l,c,f,_){if(Hs){var E=Vu(l,c,f,_);if(E===null)Cy(l,c,_,hs,f),No(l,_);else if(im(E,l,c,f,_))_.stopPropagation();else if(No(l,_),c&4&&-1<nm.indexOf(l)){for(;E!==null;){var x=fd(E);if(x!==null&&Yh(x),x=Vu(l,c,f,_),x===null&&Cy(l,c,_,hs,f),x===E)break;E=x}E!==null&&_.stopPropagation()}else Cy(l,c,_,null,f)}}var hs=null;function Vu(l,c,f,_){if(hs=null,l=is(_),l=cl(l),l!==null)if(c=Cr(l),c===null)l=null;else if(f=c.tag,f===13){if(l=Bh(c),l!==null)return l;l=null}else if(f===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;l=null}else c!==l&&(l=null);return hs=l,null}function Fu(l){switch(l){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(py()){case Lu:return 1;case $h:return 4;case el:case Wh:return 16;case ku:return 536870912;default:return 16}default:return 16}}var Vi=null,Gu=null,qs=null;function om(){if(qs)return qs;var l,c=Gu,f=c.length,_,E="value"in Vi?Vi.value:Vi.textContent,x=E.length;for(l=0;l<f&&c[l]===E[l];l++);var C=f-l;for(_=1;_<=C&&c[f-_]===E[x-_];_++);return qs=E.slice(l,1<_?1-_:void 0)}function al(l){var c=l.keyCode;return"charCode"in l?(l=l.charCode,l===0&&c===13&&(l=13)):l=c,l===10&&(l=13),32<=l||l===13?l:0}function ds(){return!0}function td(){return!1}function Un(l){function c(f,_,E,x,C){this._reactName=f,this._targetInst=E,this.type=_,this.nativeEvent=x,this.target=C,this.currentTarget=null;for(var j in l)l.hasOwnProperty(j)&&(f=l[j],this[j]=f?f(x):x[j]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?ds:td,this.isPropagationStopped=td,this}return ie(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=ds)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=ds)},persist:function(){},isPersistent:ds}),c}var fs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(l){return l.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ll=Un(fs),Fo=ie({},fs,{view:0,detail:0}),ju=Un(Fo),Uu,Bu,Fi,ul=ie({},Fo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:He,button:0,buttons:0,relatedTarget:function(l){return l.relatedTarget===void 0?l.fromElement===l.srcElement?l.toElement:l.fromElement:l.relatedTarget},movementX:function(l){return"movementX"in l?l.movementX:(l!==Fi&&(Fi&&l.type==="mousemove"?(Uu=l.screenX-Fi.screenX,Bu=l.screenY-Fi.screenY):Bu=Uu=0,Fi=l),Uu)},movementY:function(l){return"movementY"in l?l.movementY:Bu}}),nd=Un(ul),am=ie({},ul,{dataTransfer:0}),lm=Un(am),zu=ie({},Fo,{relatedTarget:0}),kn=Un(zu),um=ie({},fs,{animationName:0,elapsedTime:0,pseudoElement:0}),cm=Un(um),Go=ie({},fs,{clipboardData:function(l){return"clipboardData"in l?l.clipboardData:window.clipboardData}}),p=Un(Go),S=ie({},fs,{data:0}),I=Un(S),O={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},X={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Q={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fe(l){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(l):(l=Q[l])?!!c[l]:!1}function He(){return fe}var Qt=ie({},Fo,{key:function(l){if(l.key){var c=O[l.key]||l.key;if(c!=="Unidentified")return c}return l.type==="keypress"?(l=al(l),l===13?"Enter":String.fromCharCode(l)):l.type==="keydown"||l.type==="keyup"?X[l.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:He,charCode:function(l){return l.type==="keypress"?al(l):0},keyCode:function(l){return l.type==="keydown"||l.type==="keyup"?l.keyCode:0},which:function(l){return l.type==="keypress"?al(l):l.type==="keydown"||l.type==="keyup"?l.keyCode:0}}),Et=Un(Qt),sn=ie({},ul,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Gi=Un(sn),Xs=ie({},Fo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:He}),gs=Un(Xs),ms=ie({},fs,{propertyName:0,elapsedTime:0,pseudoElement:0}),$u=Un(ms),id=ie({},ul,{deltaX:function(l){return"deltaX"in l?l.deltaX:"wheelDeltaX"in l?-l.wheelDeltaX:0},deltaY:function(l){return"deltaY"in l?l.deltaY:"wheelDeltaY"in l?-l.wheelDeltaY:"wheelDelta"in l?-l.wheelDelta:0},deltaZ:0,deltaMode:0}),GO=Un(id),jO=[9,13,27,32],vy=a&&"CompositionEvent"in window,rd=null;a&&"documentMode"in document&&(rd=document.documentMode);var UO=a&&"TextEvent"in window&&!rd,vT=a&&(!vy||rd&&8<rd&&11>=rd),ET=" ",wT=!1;function xT(l,c){switch(l){case"keyup":return jO.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ST(l){return l=l.detail,typeof l=="object"&&"data"in l?l.data:null}var Wu=!1;function BO(l,c){switch(l){case"compositionend":return ST(c);case"keypress":return c.which!==32?null:(wT=!0,ET);case"textInput":return l=c.data,l===ET&&wT?null:l;default:return null}}function zO(l,c){if(Wu)return l==="compositionend"||!vy&&xT(l,c)?(l=om(),qs=Gu=Vi=null,Wu=!1,l):null;switch(l){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return vT&&c.locale!=="ko"?null:c.data;default:return null}}var $O={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function TT(l){var c=l&&l.nodeName&&l.nodeName.toLowerCase();return c==="input"?!!$O[l.type]:c==="textarea"}function IT(l,c,f,_){Pr(_),c=mm(c,"onChange"),0<c.length&&(f=new ll("onChange","change",null,f,_),l.push({event:f,listeners:c}))}var sd=null,od=null;function WO(l){zT(l,0)}function hm(l){var c=Yu(l);if(js(c))return l}function KO(l,c){if(l==="change")return c}var AT=!1;if(a){var Ey;if(a){var wy="oninput"in document;if(!wy){var RT=document.createElement("div");RT.setAttribute("oninput","return;"),wy=typeof RT.oninput=="function"}Ey=wy}else Ey=!1;AT=Ey&&(!document.documentMode||9<document.documentMode)}function PT(){sd&&(sd.detachEvent("onpropertychange",CT),od=sd=null)}function CT(l){if(l.propertyName==="value"&&hm(od)){var c=[];IT(c,od,l,is(l)),Mn(WO,c)}}function HO(l,c,f){l==="focusin"?(PT(),sd=c,od=f,sd.attachEvent("onpropertychange",CT)):l==="focusout"&&PT()}function qO(l){if(l==="selectionchange"||l==="keyup"||l==="keydown")return hm(od)}function XO(l,c){if(l==="click")return hm(c)}function YO(l,c){if(l==="input"||l==="change")return hm(c)}function ZO(l,c){return l===c&&(l!==0||1/l===1/c)||l!==l&&c!==c}var br=typeof Object.is=="function"?Object.is:ZO;function ad(l,c){if(br(l,c))return!0;if(typeof l!="object"||l===null||typeof c!="object"||c===null)return!1;var f=Object.keys(l),_=Object.keys(c);if(f.length!==_.length)return!1;for(_=0;_<f.length;_++){var E=f[_];if(!u.call(c,E)||!br(l[E],c[E]))return!1}return!0}function MT(l){for(;l&&l.firstChild;)l=l.firstChild;return l}function bT(l,c){var f=MT(l);l=0;for(var _;f;){if(f.nodeType===3){if(_=l+f.textContent.length,l<=c&&_>=c)return{node:f,offset:c-l};l=_}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=MT(f)}}function LT(l,c){return l&&c?l===c?!0:l&&l.nodeType===3?!1:c&&c.nodeType===3?LT(l,c.parentNode):"contains"in l?l.contains(c):l.compareDocumentPosition?!!(l.compareDocumentPosition(c)&16):!1:!1}function kT(){for(var l=window,c=fi();c instanceof l.HTMLIFrameElement;){try{var f=typeof c.contentWindow.location.href=="string"}catch{f=!1}if(f)l=c.contentWindow;else break;c=fi(l.document)}return c}function xy(l){var c=l&&l.nodeName&&l.nodeName.toLowerCase();return c&&(c==="input"&&(l.type==="text"||l.type==="search"||l.type==="tel"||l.type==="url"||l.type==="password")||c==="textarea"||l.contentEditable==="true")}function QO(l){var c=kT(),f=l.focusedElem,_=l.selectionRange;if(c!==f&&f&&f.ownerDocument&&LT(f.ownerDocument.documentElement,f)){if(_!==null&&xy(f)){if(c=_.start,l=_.end,l===void 0&&(l=c),"selectionStart"in f)f.selectionStart=c,f.selectionEnd=Math.min(l,f.value.length);else if(l=(c=f.ownerDocument||document)&&c.defaultView||window,l.getSelection){l=l.getSelection();var E=f.textContent.length,x=Math.min(_.start,E);_=_.end===void 0?x:Math.min(_.end,E),!l.extend&&x>_&&(E=_,_=x,x=E),E=bT(f,x);var C=bT(f,_);E&&C&&(l.rangeCount!==1||l.anchorNode!==E.node||l.anchorOffset!==E.offset||l.focusNode!==C.node||l.focusOffset!==C.offset)&&(c=c.createRange(),c.setStart(E.node,E.offset),l.removeAllRanges(),x>_?(l.addRange(c),l.extend(C.node,C.offset)):(c.setEnd(C.node,C.offset),l.addRange(c)))}}for(c=[],l=f;l=l.parentNode;)l.nodeType===1&&c.push({element:l,left:l.scrollLeft,top:l.scrollTop});for(typeof f.focus=="function"&&f.focus(),f=0;f<c.length;f++)l=c[f],l.element.scrollLeft=l.left,l.element.scrollTop=l.top}}var JO=a&&"documentMode"in document&&11>=document.documentMode,Ku=null,Sy=null,ld=null,Ty=!1;function DT(l,c,f){var _=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;Ty||Ku==null||Ku!==fi(_)||(_=Ku,"selectionStart"in _&&xy(_)?_={start:_.selectionStart,end:_.selectionEnd}:(_=(_.ownerDocument&&_.ownerDocument.defaultView||window).getSelection(),_={anchorNode:_.anchorNode,anchorOffset:_.anchorOffset,focusNode:_.focusNode,focusOffset:_.focusOffset}),ld&&ad(ld,_)||(ld=_,_=mm(Sy,"onSelect"),0<_.length&&(c=new ll("onSelect","select",null,c,f),l.push({event:c,listeners:_}),c.target=Ku)))}function dm(l,c){var f={};return f[l.toLowerCase()]=c.toLowerCase(),f["Webkit"+l]="webkit"+c,f["Moz"+l]="moz"+c,f}var Hu={animationend:dm("Animation","AnimationEnd"),animationiteration:dm("Animation","AnimationIteration"),animationstart:dm("Animation","AnimationStart"),transitionend:dm("Transition","TransitionEnd")},Iy={},NT={};a&&(NT=document.createElement("div").style,"AnimationEvent"in window||(delete Hu.animationend.animation,delete Hu.animationiteration.animation,delete Hu.animationstart.animation),"TransitionEvent"in window||delete Hu.transitionend.transition);function fm(l){if(Iy[l])return Iy[l];if(!Hu[l])return l;var c=Hu[l],f;for(f in c)if(c.hasOwnProperty(f)&&f in NT)return Iy[l]=c[f];return l}var OT=fm("animationend"),VT=fm("animationiteration"),FT=fm("animationstart"),GT=fm("transitionend"),jT=new Map,UT="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function jo(l,c){jT.set(l,c),s(c,[l])}for(var Ay=0;Ay<UT.length;Ay++){var Ry=UT[Ay],e3=Ry.toLowerCase(),t3=Ry[0].toUpperCase()+Ry.slice(1);jo(e3,"on"+t3)}jo(OT,"onAnimationEnd"),jo(VT,"onAnimationIteration"),jo(FT,"onAnimationStart"),jo("dblclick","onDoubleClick"),jo("focusin","onFocus"),jo("focusout","onBlur"),jo(GT,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ud="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),n3=new Set("cancel close invalid load scroll toggle".split(" ").concat(ud));function BT(l,c,f){var _=l.type||"unknown-event";l.currentTarget=f,Uh(_,c,void 0,l),l.currentTarget=null}function zT(l,c){c=(c&4)!==0;for(var f=0;f<l.length;f++){var _=l[f],E=_.event;_=_.listeners;e:{var x=void 0;if(c)for(var C=_.length-1;0<=C;C--){var j=_[C],z=j.instance,Z=j.currentTarget;if(j=j.listener,z!==x&&E.isPropagationStopped())break e;BT(E,j,Z),x=z}else for(C=0;C<_.length;C++){if(j=_[C],z=j.instance,Z=j.currentTarget,j=j.listener,z!==x&&E.isPropagationStopped())break e;BT(E,j,Z),x=z}}}if(Mu)throw l=or,Mu=!1,or=null,l}function Mt(l,c){var f=c[Ny];f===void 0&&(f=c[Ny]=new Set);var _=l+"__bubble";f.has(_)||($T(c,l,2,!1),f.add(_))}function Py(l,c,f){var _=0;c&&(_|=4),$T(f,l,_,c)}var gm="_reactListening"+Math.random().toString(36).slice(2);function cd(l){if(!l[gm]){l[gm]=!0,i.forEach(function(f){f!=="selectionchange"&&(n3.has(f)||Py(f,!1,l),Py(f,!0,l))});var c=l.nodeType===9?l:l.ownerDocument;c===null||c[gm]||(c[gm]=!0,Py("selectionchange",!1,c))}}function $T(l,c,f,_){switch(Fu(c)){case 1:var E=cs;break;case 4:E=sm;break;default:E=ed}f=E.bind(null,c,f,l),E=void 0,!vn||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(E=!0),_?E!==void 0?l.addEventListener(c,f,{capture:!0,passive:E}):l.addEventListener(c,f,!0):E!==void 0?l.addEventListener(c,f,{passive:E}):l.addEventListener(c,f,!1)}function Cy(l,c,f,_,E){var x=_;if((c&1)===0&&(c&2)===0&&_!==null)e:for(;;){if(_===null)return;var C=_.tag;if(C===3||C===4){var j=_.stateNode.containerInfo;if(j===E||j.nodeType===8&&j.parentNode===E)break;if(C===4)for(C=_.return;C!==null;){var z=C.tag;if((z===3||z===4)&&(z=C.stateNode.containerInfo,z===E||z.nodeType===8&&z.parentNode===E))return;C=C.return}for(;j!==null;){if(C=cl(j),C===null)return;if(z=C.tag,z===5||z===6){_=x=C;continue e}j=j.parentNode}}_=_.return}Mn(function(){var Z=x,oe=is(f),ue=[];e:{var re=jT.get(l);if(re!==void 0){var ve=ll,Se=l;switch(l){case"keypress":if(al(f)===0)break e;case"keydown":case"keyup":ve=Et;break;case"focusin":Se="focus",ve=kn;break;case"focusout":Se="blur",ve=kn;break;case"beforeblur":case"afterblur":ve=kn;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ve=nd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ve=lm;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ve=gs;break;case OT:case VT:case FT:ve=cm;break;case GT:ve=$u;break;case"scroll":ve=ju;break;case"wheel":ve=GO;break;case"copy":case"cut":case"paste":ve=p;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ve=Gi}var Ae=(c&4)!==0,Jt=!Ae&&l==="scroll",q=Ae?re!==null?re+"Capture":null:re;Ae=[];for(var W=Z,Y;W!==null;){Y=W;var he=Y.stateNode;if(Y.tag===5&&he!==null&&(Y=he,q!==null&&(he=bn(W,q),he!=null&&Ae.push(hd(W,he,Y)))),Jt)break;W=W.return}0<Ae.length&&(re=new ve(re,Se,null,f,oe),ue.push({event:re,listeners:Ae}))}}if((c&7)===0){e:{if(re=l==="mouseover"||l==="pointerover",ve=l==="mouseout"||l==="pointerout",re&&f!==ns&&(Se=f.relatedTarget||f.fromElement)&&(cl(Se)||Se[Ys]))break e;if((ve||re)&&(re=oe.window===oe?oe:(re=oe.ownerDocument)?re.defaultView||re.parentWindow:window,ve?(Se=f.relatedTarget||f.toElement,ve=Z,Se=Se?cl(Se):null,Se!==null&&(Jt=Cr(Se),Se!==Jt||Se.tag!==5&&Se.tag!==6)&&(Se=null)):(ve=null,Se=Z),ve!==Se)){if(Ae=nd,he="onMouseLeave",q="onMouseEnter",W="mouse",(l==="pointerout"||l==="pointerover")&&(Ae=Gi,he="onPointerLeave",q="onPointerEnter",W="pointer"),Jt=ve==null?re:Yu(ve),Y=Se==null?re:Yu(Se),re=new Ae(he,W+"leave",ve,f,oe),re.target=Jt,re.relatedTarget=Y,he=null,cl(oe)===Z&&(Ae=new Ae(q,W+"enter",Se,f,oe),Ae.target=Y,Ae.relatedTarget=Jt,he=Ae),Jt=he,ve&&Se)t:{for(Ae=ve,q=Se,W=0,Y=Ae;Y;Y=qu(Y))W++;for(Y=0,he=q;he;he=qu(he))Y++;for(;0<W-Y;)Ae=qu(Ae),W--;for(;0<Y-W;)q=qu(q),Y--;for(;W--;){if(Ae===q||q!==null&&Ae===q.alternate)break t;Ae=qu(Ae),q=qu(q)}Ae=null}else Ae=null;ve!==null&&WT(ue,re,ve,Ae,!1),Se!==null&&Jt!==null&&WT(ue,Jt,Se,Ae,!0)}}e:{if(re=Z?Yu(Z):window,ve=re.nodeName&&re.nodeName.toLowerCase(),ve==="select"||ve==="input"&&re.type==="file")var Re=KO;else if(TT(re))if(AT)Re=YO;else{Re=qO;var Ne=HO}else(ve=re.nodeName)&&ve.toLowerCase()==="input"&&(re.type==="checkbox"||re.type==="radio")&&(Re=XO);if(Re&&(Re=Re(l,Z))){IT(ue,Re,f,oe);break e}Ne&&Ne(l,re,Z),l==="focusout"&&(Ne=re._wrapperState)&&Ne.controlled&&re.type==="number"&&Rt(re,"number",re.value)}switch(Ne=Z?Yu(Z):window,l){case"focusin":(TT(Ne)||Ne.contentEditable==="true")&&(Ku=Ne,Sy=Z,ld=null);break;case"focusout":ld=Sy=Ku=null;break;case"mousedown":Ty=!0;break;case"contextmenu":case"mouseup":case"dragend":Ty=!1,DT(ue,f,oe);break;case"selectionchange":if(JO)break;case"keydown":case"keyup":DT(ue,f,oe)}var Oe;if(vy)e:{switch(l){case"compositionstart":var je="onCompositionStart";break e;case"compositionend":je="onCompositionEnd";break e;case"compositionupdate":je="onCompositionUpdate";break e}je=void 0}else Wu?xT(l,f)&&(je="onCompositionEnd"):l==="keydown"&&f.keyCode===229&&(je="onCompositionStart");je&&(vT&&f.locale!=="ko"&&(Wu||je!=="onCompositionStart"?je==="onCompositionEnd"&&Wu&&(Oe=om()):(Vi=oe,Gu="value"in Vi?Vi.value:Vi.textContent,Wu=!0)),Ne=mm(Z,je),0<Ne.length&&(je=new I(je,l,null,f,oe),ue.push({event:je,listeners:Ne}),Oe?je.data=Oe:(Oe=ST(f),Oe!==null&&(je.data=Oe)))),(Oe=UO?BO(l,f):zO(l,f))&&(Z=mm(Z,"onBeforeInput"),0<Z.length&&(oe=new I("onBeforeInput","beforeinput",null,f,oe),ue.push({event:oe,listeners:Z}),oe.data=Oe))}zT(ue,c)})}function hd(l,c,f){return{instance:l,listener:c,currentTarget:f}}function mm(l,c){for(var f=c+"Capture",_=[];l!==null;){var E=l,x=E.stateNode;E.tag===5&&x!==null&&(E=x,x=bn(l,f),x!=null&&_.unshift(hd(l,x,E)),x=bn(l,c),x!=null&&_.push(hd(l,x,E))),l=l.return}return _}function qu(l){if(l===null)return null;do l=l.return;while(l&&l.tag!==5);return l||null}function WT(l,c,f,_,E){for(var x=c._reactName,C=[];f!==null&&f!==_;){var j=f,z=j.alternate,Z=j.stateNode;if(z!==null&&z===_)break;j.tag===5&&Z!==null&&(j=Z,E?(z=bn(f,x),z!=null&&C.unshift(hd(f,z,j))):E||(z=bn(f,x),z!=null&&C.push(hd(f,z,j)))),f=f.return}C.length!==0&&l.push({event:c,listeners:C})}var i3=/\r\n?/g,r3=/\u0000|\uFFFD/g;function KT(l){return(typeof l=="string"?l:""+l).replace(i3,`
`).replace(r3,"")}function pm(l,c,f){if(c=KT(c),KT(l)!==c&&f)throw Error(t(425))}function _m(){}var My=null,by=null;function Ly(l,c){return l==="textarea"||l==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var ky=typeof setTimeout=="function"?setTimeout:void 0,s3=typeof clearTimeout=="function"?clearTimeout:void 0,HT=typeof Promise=="function"?Promise:void 0,o3=typeof queueMicrotask=="function"?queueMicrotask:typeof HT<"u"?function(l){return HT.resolve(null).then(l).catch(a3)}:ky;function a3(l){setTimeout(function(){throw l})}function Dy(l,c){var f=c,_=0;do{var E=f.nextSibling;if(l.removeChild(f),E&&E.nodeType===8)if(f=E.data,f==="/$"){if(_===0){l.removeChild(E),Vo(c);return}_--}else f!=="$"&&f!=="$?"&&f!=="$!"||_++;f=E}while(f);Vo(c)}function Uo(l){for(;l!=null;l=l.nextSibling){var c=l.nodeType;if(c===1||c===3)break;if(c===8){if(c=l.data,c==="$"||c==="$!"||c==="$?")break;if(c==="/$")return null}}return l}function qT(l){l=l.previousSibling;for(var c=0;l;){if(l.nodeType===8){var f=l.data;if(f==="$"||f==="$!"||f==="$?"){if(c===0)return l;c--}else f==="/$"&&c++}l=l.previousSibling}return null}var Xu=Math.random().toString(36).slice(2),ps="__reactFiber$"+Xu,dd="__reactProps$"+Xu,Ys="__reactContainer$"+Xu,Ny="__reactEvents$"+Xu,l3="__reactListeners$"+Xu,u3="__reactHandles$"+Xu;function cl(l){var c=l[ps];if(c)return c;for(var f=l.parentNode;f;){if(c=f[Ys]||f[ps]){if(f=c.alternate,c.child!==null||f!==null&&f.child!==null)for(l=qT(l);l!==null;){if(f=l[ps])return f;l=qT(l)}return c}l=f,f=l.parentNode}return null}function fd(l){return l=l[ps]||l[Ys],!l||l.tag!==5&&l.tag!==6&&l.tag!==13&&l.tag!==3?null:l}function Yu(l){if(l.tag===5||l.tag===6)return l.stateNode;throw Error(t(33))}function ym(l){return l[dd]||null}var Oy=[],Zu=-1;function Bo(l){return{current:l}}function bt(l){0>Zu||(l.current=Oy[Zu],Oy[Zu]=null,Zu--)}function Pt(l,c){Zu++,Oy[Zu]=l.current,l.current=c}var zo={},Bn=Bo(zo),pi=Bo(!1),hl=zo;function Qu(l,c){var f=l.type.contextTypes;if(!f)return zo;var _=l.stateNode;if(_&&_.__reactInternalMemoizedUnmaskedChildContext===c)return _.__reactInternalMemoizedMaskedChildContext;var E={},x;for(x in f)E[x]=c[x];return _&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=c,l.__reactInternalMemoizedMaskedChildContext=E),E}function _i(l){return l=l.childContextTypes,l!=null}function vm(){bt(pi),bt(Bn)}function XT(l,c,f){if(Bn.current!==zo)throw Error(t(168));Pt(Bn,c),Pt(pi,f)}function YT(l,c,f){var _=l.stateNode;if(c=c.childContextTypes,typeof _.getChildContext!="function")return f;_=_.getChildContext();for(var E in _)if(!(E in c))throw Error(t(108,Ge(l)||"Unknown",E));return ie({},f,_)}function Em(l){return l=(l=l.stateNode)&&l.__reactInternalMemoizedMergedChildContext||zo,hl=Bn.current,Pt(Bn,l),Pt(pi,pi.current),!0}function ZT(l,c,f){var _=l.stateNode;if(!_)throw Error(t(169));f?(l=YT(l,c,hl),_.__reactInternalMemoizedMergedChildContext=l,bt(pi),bt(Bn),Pt(Bn,l)):bt(pi),Pt(pi,f)}var Zs=null,wm=!1,Vy=!1;function QT(l){Zs===null?Zs=[l]:Zs.push(l)}function c3(l){wm=!0,QT(l)}function $o(){if(!Vy&&Zs!==null){Vy=!0;var l=0,c=tt;try{var f=Zs;for(tt=1;l<f.length;l++){var _=f[l];do _=_(!0);while(_!==null)}Zs=null,wm=!1}catch(E){throw Zs!==null&&(Zs=Zs.slice(l+1)),zh(Lu,$o),E}finally{tt=c,Vy=!1}}return null}var Ju=[],ec=0,xm=null,Sm=0,lr=[],ur=0,dl=null,Qs=1,Js="";function fl(l,c){Ju[ec++]=Sm,Ju[ec++]=xm,xm=l,Sm=c}function JT(l,c,f){lr[ur++]=Qs,lr[ur++]=Js,lr[ur++]=dl,dl=l;var _=Qs;l=Js;var E=32-Ni(_)-1;_&=~(1<<E),f+=1;var x=32-Ni(c)+E;if(30<x){var C=E-E%5;x=(_&(1<<C)-1).toString(32),_>>=C,E-=C,Qs=1<<32-Ni(c)+E|f<<E|_,Js=x+l}else Qs=1<<x|f<<E|_,Js=l}function Fy(l){l.return!==null&&(fl(l,1),JT(l,1,0))}function Gy(l){for(;l===xm;)xm=Ju[--ec],Ju[ec]=null,Sm=Ju[--ec],Ju[ec]=null;for(;l===dl;)dl=lr[--ur],lr[ur]=null,Js=lr[--ur],lr[ur]=null,Qs=lr[--ur],lr[ur]=null}var ji=null,Ui=null,Nt=!1,Lr=null;function eI(l,c){var f=fr(5,null,null,0);f.elementType="DELETED",f.stateNode=c,f.return=l,c=l.deletions,c===null?(l.deletions=[f],l.flags|=16):c.push(f)}function tI(l,c){switch(l.tag){case 5:var f=l.type;return c=c.nodeType!==1||f.toLowerCase()!==c.nodeName.toLowerCase()?null:c,c!==null?(l.stateNode=c,ji=l,Ui=Uo(c.firstChild),!0):!1;case 6:return c=l.pendingProps===""||c.nodeType!==3?null:c,c!==null?(l.stateNode=c,ji=l,Ui=null,!0):!1;case 13:return c=c.nodeType!==8?null:c,c!==null?(f=dl!==null?{id:Qs,overflow:Js}:null,l.memoizedState={dehydrated:c,treeContext:f,retryLane:1073741824},f=fr(18,null,null,0),f.stateNode=c,f.return=l,l.child=f,ji=l,Ui=null,!0):!1;default:return!1}}function jy(l){return(l.mode&1)!==0&&(l.flags&128)===0}function Uy(l){if(Nt){var c=Ui;if(c){var f=c;if(!tI(l,c)){if(jy(l))throw Error(t(418));c=Uo(f.nextSibling);var _=ji;c&&tI(l,c)?eI(_,f):(l.flags=l.flags&-4097|2,Nt=!1,ji=l)}}else{if(jy(l))throw Error(t(418));l.flags=l.flags&-4097|2,Nt=!1,ji=l}}}function nI(l){for(l=l.return;l!==null&&l.tag!==5&&l.tag!==3&&l.tag!==13;)l=l.return;ji=l}function Tm(l){if(l!==ji)return!1;if(!Nt)return nI(l),Nt=!0,!1;var c;if((c=l.tag!==3)&&!(c=l.tag!==5)&&(c=l.type,c=c!=="head"&&c!=="body"&&!Ly(l.type,l.memoizedProps)),c&&(c=Ui)){if(jy(l))throw iI(),Error(t(418));for(;c;)eI(l,c),c=Uo(c.nextSibling)}if(nI(l),l.tag===13){if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(t(317));e:{for(l=l.nextSibling,c=0;l;){if(l.nodeType===8){var f=l.data;if(f==="/$"){if(c===0){Ui=Uo(l.nextSibling);break e}c--}else f!=="$"&&f!=="$!"&&f!=="$?"||c++}l=l.nextSibling}Ui=null}}else Ui=ji?Uo(l.stateNode.nextSibling):null;return!0}function iI(){for(var l=Ui;l;)l=Uo(l.nextSibling)}function tc(){Ui=ji=null,Nt=!1}function By(l){Lr===null?Lr=[l]:Lr.push(l)}var h3=k.ReactCurrentBatchConfig;function gd(l,c,f){if(l=f.ref,l!==null&&typeof l!="function"&&typeof l!="object"){if(f._owner){if(f=f._owner,f){if(f.tag!==1)throw Error(t(309));var _=f.stateNode}if(!_)throw Error(t(147,l));var E=_,x=""+l;return c!==null&&c.ref!==null&&typeof c.ref=="function"&&c.ref._stringRef===x?c.ref:(c=function(C){var j=E.refs;C===null?delete j[x]:j[x]=C},c._stringRef=x,c)}if(typeof l!="string")throw Error(t(284));if(!f._owner)throw Error(t(290,l))}return l}function Im(l,c){throw l=Object.prototype.toString.call(c),Error(t(31,l==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":l))}function rI(l){var c=l._init;return c(l._payload)}function sI(l){function c(q,W){if(l){var Y=q.deletions;Y===null?(q.deletions=[W],q.flags|=16):Y.push(W)}}function f(q,W){if(!l)return null;for(;W!==null;)c(q,W),W=W.sibling;return null}function _(q,W){for(q=new Map;W!==null;)W.key!==null?q.set(W.key,W):q.set(W.index,W),W=W.sibling;return q}function E(q,W){return q=Qo(q,W),q.index=0,q.sibling=null,q}function x(q,W,Y){return q.index=Y,l?(Y=q.alternate,Y!==null?(Y=Y.index,Y<W?(q.flags|=2,W):Y):(q.flags|=2,W)):(q.flags|=1048576,W)}function C(q){return l&&q.alternate===null&&(q.flags|=2),q}function j(q,W,Y,he){return W===null||W.tag!==6?(W=kv(Y,q.mode,he),W.return=q,W):(W=E(W,Y),W.return=q,W)}function z(q,W,Y,he){var Re=Y.type;return Re===b?oe(q,W,Y.props.children,he,Y.key):W!==null&&(W.elementType===Re||typeof Re=="object"&&Re!==null&&Re.$$typeof===ye&&rI(Re)===W.type)?(he=E(W,Y.props),he.ref=gd(q,W,Y),he.return=q,he):(he=Xm(Y.type,Y.key,Y.props,null,q.mode,he),he.ref=gd(q,W,Y),he.return=q,he)}function Z(q,W,Y,he){return W===null||W.tag!==4||W.stateNode.containerInfo!==Y.containerInfo||W.stateNode.implementation!==Y.implementation?(W=Dv(Y,q.mode,he),W.return=q,W):(W=E(W,Y.children||[]),W.return=q,W)}function oe(q,W,Y,he,Re){return W===null||W.tag!==7?(W=wl(Y,q.mode,he,Re),W.return=q,W):(W=E(W,Y),W.return=q,W)}function ue(q,W,Y){if(typeof W=="string"&&W!==""||typeof W=="number")return W=kv(""+W,q.mode,Y),W.return=q,W;if(typeof W=="object"&&W!==null){switch(W.$$typeof){case N:return Y=Xm(W.type,W.key,W.props,null,q.mode,Y),Y.ref=gd(q,null,W),Y.return=q,Y;case B:return W=Dv(W,q.mode,Y),W.return=q,W;case ye:var he=W._init;return ue(q,he(W._payload),Y)}if(vt(W)||ae(W))return W=wl(W,q.mode,Y,null),W.return=q,W;Im(q,W)}return null}function re(q,W,Y,he){var Re=W!==null?W.key:null;if(typeof Y=="string"&&Y!==""||typeof Y=="number")return Re!==null?null:j(q,W,""+Y,he);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case N:return Y.key===Re?z(q,W,Y,he):null;case B:return Y.key===Re?Z(q,W,Y,he):null;case ye:return Re=Y._init,re(q,W,Re(Y._payload),he)}if(vt(Y)||ae(Y))return Re!==null?null:oe(q,W,Y,he,null);Im(q,Y)}return null}function ve(q,W,Y,he,Re){if(typeof he=="string"&&he!==""||typeof he=="number")return q=q.get(Y)||null,j(W,q,""+he,Re);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case N:return q=q.get(he.key===null?Y:he.key)||null,z(W,q,he,Re);case B:return q=q.get(he.key===null?Y:he.key)||null,Z(W,q,he,Re);case ye:var Ne=he._init;return ve(q,W,Y,Ne(he._payload),Re)}if(vt(he)||ae(he))return q=q.get(Y)||null,oe(W,q,he,Re,null);Im(W,he)}return null}function Se(q,W,Y,he){for(var Re=null,Ne=null,Oe=W,je=W=0,xn=null;Oe!==null&&je<Y.length;je++){Oe.index>je?(xn=Oe,Oe=null):xn=Oe.sibling;var ot=re(q,Oe,Y[je],he);if(ot===null){Oe===null&&(Oe=xn);break}l&&Oe&&ot.alternate===null&&c(q,Oe),W=x(ot,W,je),Ne===null?Re=ot:Ne.sibling=ot,Ne=ot,Oe=xn}if(je===Y.length)return f(q,Oe),Nt&&fl(q,je),Re;if(Oe===null){for(;je<Y.length;je++)Oe=ue(q,Y[je],he),Oe!==null&&(W=x(Oe,W,je),Ne===null?Re=Oe:Ne.sibling=Oe,Ne=Oe);return Nt&&fl(q,je),Re}for(Oe=_(q,Oe);je<Y.length;je++)xn=ve(Oe,q,je,Y[je],he),xn!==null&&(l&&xn.alternate!==null&&Oe.delete(xn.key===null?je:xn.key),W=x(xn,W,je),Ne===null?Re=xn:Ne.sibling=xn,Ne=xn);return l&&Oe.forEach(function(Jo){return c(q,Jo)}),Nt&&fl(q,je),Re}function Ae(q,W,Y,he){var Re=ae(Y);if(typeof Re!="function")throw Error(t(150));if(Y=Re.call(Y),Y==null)throw Error(t(151));for(var Ne=Re=null,Oe=W,je=W=0,xn=null,ot=Y.next();Oe!==null&&!ot.done;je++,ot=Y.next()){Oe.index>je?(xn=Oe,Oe=null):xn=Oe.sibling;var Jo=re(q,Oe,ot.value,he);if(Jo===null){Oe===null&&(Oe=xn);break}l&&Oe&&Jo.alternate===null&&c(q,Oe),W=x(Jo,W,je),Ne===null?Re=Jo:Ne.sibling=Jo,Ne=Jo,Oe=xn}if(ot.done)return f(q,Oe),Nt&&fl(q,je),Re;if(Oe===null){for(;!ot.done;je++,ot=Y.next())ot=ue(q,ot.value,he),ot!==null&&(W=x(ot,W,je),Ne===null?Re=ot:Ne.sibling=ot,Ne=ot);return Nt&&fl(q,je),Re}for(Oe=_(q,Oe);!ot.done;je++,ot=Y.next())ot=ve(Oe,q,je,ot.value,he),ot!==null&&(l&&ot.alternate!==null&&Oe.delete(ot.key===null?je:ot.key),W=x(ot,W,je),Ne===null?Re=ot:Ne.sibling=ot,Ne=ot);return l&&Oe.forEach(function($3){return c(q,$3)}),Nt&&fl(q,je),Re}function Jt(q,W,Y,he){if(typeof Y=="object"&&Y!==null&&Y.type===b&&Y.key===null&&(Y=Y.props.children),typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case N:e:{for(var Re=Y.key,Ne=W;Ne!==null;){if(Ne.key===Re){if(Re=Y.type,Re===b){if(Ne.tag===7){f(q,Ne.sibling),W=E(Ne,Y.props.children),W.return=q,q=W;break e}}else if(Ne.elementType===Re||typeof Re=="object"&&Re!==null&&Re.$$typeof===ye&&rI(Re)===Ne.type){f(q,Ne.sibling),W=E(Ne,Y.props),W.ref=gd(q,Ne,Y),W.return=q,q=W;break e}f(q,Ne);break}else c(q,Ne);Ne=Ne.sibling}Y.type===b?(W=wl(Y.props.children,q.mode,he,Y.key),W.return=q,q=W):(he=Xm(Y.type,Y.key,Y.props,null,q.mode,he),he.ref=gd(q,W,Y),he.return=q,q=he)}return C(q);case B:e:{for(Ne=Y.key;W!==null;){if(W.key===Ne)if(W.tag===4&&W.stateNode.containerInfo===Y.containerInfo&&W.stateNode.implementation===Y.implementation){f(q,W.sibling),W=E(W,Y.children||[]),W.return=q,q=W;break e}else{f(q,W);break}else c(q,W);W=W.sibling}W=Dv(Y,q.mode,he),W.return=q,q=W}return C(q);case ye:return Ne=Y._init,Jt(q,W,Ne(Y._payload),he)}if(vt(Y))return Se(q,W,Y,he);if(ae(Y))return Ae(q,W,Y,he);Im(q,Y)}return typeof Y=="string"&&Y!==""||typeof Y=="number"?(Y=""+Y,W!==null&&W.tag===6?(f(q,W.sibling),W=E(W,Y),W.return=q,q=W):(f(q,W),W=kv(Y,q.mode,he),W.return=q,q=W),C(q)):f(q,W)}return Jt}var nc=sI(!0),oI=sI(!1),Am=Bo(null),Rm=null,ic=null,zy=null;function $y(){zy=ic=Rm=null}function Wy(l){var c=Am.current;bt(Am),l._currentValue=c}function Ky(l,c,f){for(;l!==null;){var _=l.alternate;if((l.childLanes&c)!==c?(l.childLanes|=c,_!==null&&(_.childLanes|=c)):_!==null&&(_.childLanes&c)!==c&&(_.childLanes|=c),l===f)break;l=l.return}}function rc(l,c){Rm=l,zy=ic=null,l=l.dependencies,l!==null&&l.firstContext!==null&&((l.lanes&c)!==0&&(yi=!0),l.firstContext=null)}function cr(l){var c=l._currentValue;if(zy!==l)if(l={context:l,memoizedValue:c,next:null},ic===null){if(Rm===null)throw Error(t(308));ic=l,Rm.dependencies={lanes:0,firstContext:l}}else ic=ic.next=l;return c}var gl=null;function Hy(l){gl===null?gl=[l]:gl.push(l)}function aI(l,c,f,_){var E=c.interleaved;return E===null?(f.next=f,Hy(c)):(f.next=E.next,E.next=f),c.interleaved=f,eo(l,_)}function eo(l,c){l.lanes|=c;var f=l.alternate;for(f!==null&&(f.lanes|=c),f=l,l=l.return;l!==null;)l.childLanes|=c,f=l.alternate,f!==null&&(f.childLanes|=c),f=l,l=l.return;return f.tag===3?f.stateNode:null}var Wo=!1;function qy(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function lI(l,c){l=l.updateQueue,c.updateQueue===l&&(c.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,effects:l.effects})}function to(l,c){return{eventTime:l,lane:c,tag:0,payload:null,callback:null,next:null}}function Ko(l,c,f){var _=l.updateQueue;if(_===null)return null;if(_=_.shared,(rt&2)!==0){var E=_.pending;return E===null?c.next=c:(c.next=E.next,E.next=c),_.pending=c,eo(l,f)}return E=_.interleaved,E===null?(c.next=c,Hy(_)):(c.next=E.next,E.next=c),_.interleaved=c,eo(l,f)}function Pm(l,c,f){if(c=c.updateQueue,c!==null&&(c=c.shared,(f&4194240)!==0)){var _=c.lanes;_&=l.pendingLanes,f|=_,c.lanes=f,Xh(l,f)}}function uI(l,c){var f=l.updateQueue,_=l.alternate;if(_!==null&&(_=_.updateQueue,f===_)){var E=null,x=null;if(f=f.firstBaseUpdate,f!==null){do{var C={eventTime:f.eventTime,lane:f.lane,tag:f.tag,payload:f.payload,callback:f.callback,next:null};x===null?E=x=C:x=x.next=C,f=f.next}while(f!==null);x===null?E=x=c:x=x.next=c}else E=x=c;f={baseState:_.baseState,firstBaseUpdate:E,lastBaseUpdate:x,shared:_.shared,effects:_.effects},l.updateQueue=f;return}l=f.lastBaseUpdate,l===null?f.firstBaseUpdate=c:l.next=c,f.lastBaseUpdate=c}function Cm(l,c,f,_){var E=l.updateQueue;Wo=!1;var x=E.firstBaseUpdate,C=E.lastBaseUpdate,j=E.shared.pending;if(j!==null){E.shared.pending=null;var z=j,Z=z.next;z.next=null,C===null?x=Z:C.next=Z,C=z;var oe=l.alternate;oe!==null&&(oe=oe.updateQueue,j=oe.lastBaseUpdate,j!==C&&(j===null?oe.firstBaseUpdate=Z:j.next=Z,oe.lastBaseUpdate=z))}if(x!==null){var ue=E.baseState;C=0,oe=Z=z=null,j=x;do{var re=j.lane,ve=j.eventTime;if((_&re)===re){oe!==null&&(oe=oe.next={eventTime:ve,lane:0,tag:j.tag,payload:j.payload,callback:j.callback,next:null});e:{var Se=l,Ae=j;switch(re=c,ve=f,Ae.tag){case 1:if(Se=Ae.payload,typeof Se=="function"){ue=Se.call(ve,ue,re);break e}ue=Se;break e;case 3:Se.flags=Se.flags&-65537|128;case 0:if(Se=Ae.payload,re=typeof Se=="function"?Se.call(ve,ue,re):Se,re==null)break e;ue=ie({},ue,re);break e;case 2:Wo=!0}}j.callback!==null&&j.lane!==0&&(l.flags|=64,re=E.effects,re===null?E.effects=[j]:re.push(j))}else ve={eventTime:ve,lane:re,tag:j.tag,payload:j.payload,callback:j.callback,next:null},oe===null?(Z=oe=ve,z=ue):oe=oe.next=ve,C|=re;if(j=j.next,j===null){if(j=E.shared.pending,j===null)break;re=j,j=re.next,re.next=null,E.lastBaseUpdate=re,E.shared.pending=null}}while(!0);if(oe===null&&(z=ue),E.baseState=z,E.firstBaseUpdate=Z,E.lastBaseUpdate=oe,c=E.shared.interleaved,c!==null){E=c;do C|=E.lane,E=E.next;while(E!==c)}else x===null&&(E.shared.lanes=0);_l|=C,l.lanes=C,l.memoizedState=ue}}function cI(l,c,f){if(l=c.effects,c.effects=null,l!==null)for(c=0;c<l.length;c++){var _=l[c],E=_.callback;if(E!==null){if(_.callback=null,_=f,typeof E!="function")throw Error(t(191,E));E.call(_)}}}var md={},_s=Bo(md),pd=Bo(md),_d=Bo(md);function ml(l){if(l===md)throw Error(t(174));return l}function Xy(l,c){switch(Pt(_d,c),Pt(pd,l),Pt(_s,md),l=c.nodeType,l){case 9:case 11:c=(c=c.documentElement)?c.namespaceURI:Rr(null,"");break;default:l=l===8?c.parentNode:c,c=l.namespaceURI||null,l=l.tagName,c=Rr(c,l)}bt(_s),Pt(_s,c)}function sc(){bt(_s),bt(pd),bt(_d)}function hI(l){ml(_d.current);var c=ml(_s.current),f=Rr(c,l.type);c!==f&&(Pt(pd,l),Pt(_s,f))}function Yy(l){pd.current===l&&(bt(_s),bt(pd))}var Gt=Bo(0);function Mm(l){for(var c=l;c!==null;){if(c.tag===13){var f=c.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||f.data==="$?"||f.data==="$!"))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===l)break;for(;c.sibling===null;){if(c.return===null||c.return===l)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var Zy=[];function Qy(){for(var l=0;l<Zy.length;l++)Zy[l]._workInProgressVersionPrimary=null;Zy.length=0}var bm=k.ReactCurrentDispatcher,Jy=k.ReactCurrentBatchConfig,pl=0,jt=null,hn=null,En=null,Lm=!1,yd=!1,vd=0,d3=0;function zn(){throw Error(t(321))}function ev(l,c){if(c===null)return!1;for(var f=0;f<c.length&&f<l.length;f++)if(!br(l[f],c[f]))return!1;return!0}function tv(l,c,f,_,E,x){if(pl=x,jt=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,bm.current=l===null||l.memoizedState===null?p3:_3,l=f(_,E),yd){x=0;do{if(yd=!1,vd=0,25<=x)throw Error(t(301));x+=1,En=hn=null,c.updateQueue=null,bm.current=y3,l=f(_,E)}while(yd)}if(bm.current=Nm,c=hn!==null&&hn.next!==null,pl=0,En=hn=jt=null,Lm=!1,c)throw Error(t(300));return l}function nv(){var l=vd!==0;return vd=0,l}function ys(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return En===null?jt.memoizedState=En=l:En=En.next=l,En}function hr(){if(hn===null){var l=jt.alternate;l=l!==null?l.memoizedState:null}else l=hn.next;var c=En===null?jt.memoizedState:En.next;if(c!==null)En=c,hn=l;else{if(l===null)throw Error(t(310));hn=l,l={memoizedState:hn.memoizedState,baseState:hn.baseState,baseQueue:hn.baseQueue,queue:hn.queue,next:null},En===null?jt.memoizedState=En=l:En=En.next=l}return En}function Ed(l,c){return typeof c=="function"?c(l):c}function iv(l){var c=hr(),f=c.queue;if(f===null)throw Error(t(311));f.lastRenderedReducer=l;var _=hn,E=_.baseQueue,x=f.pending;if(x!==null){if(E!==null){var C=E.next;E.next=x.next,x.next=C}_.baseQueue=E=x,f.pending=null}if(E!==null){x=E.next,_=_.baseState;var j=C=null,z=null,Z=x;do{var oe=Z.lane;if((pl&oe)===oe)z!==null&&(z=z.next={lane:0,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null}),_=Z.hasEagerState?Z.eagerState:l(_,Z.action);else{var ue={lane:oe,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null};z===null?(j=z=ue,C=_):z=z.next=ue,jt.lanes|=oe,_l|=oe}Z=Z.next}while(Z!==null&&Z!==x);z===null?C=_:z.next=j,br(_,c.memoizedState)||(yi=!0),c.memoizedState=_,c.baseState=C,c.baseQueue=z,f.lastRenderedState=_}if(l=f.interleaved,l!==null){E=l;do x=E.lane,jt.lanes|=x,_l|=x,E=E.next;while(E!==l)}else E===null&&(f.lanes=0);return[c.memoizedState,f.dispatch]}function rv(l){var c=hr(),f=c.queue;if(f===null)throw Error(t(311));f.lastRenderedReducer=l;var _=f.dispatch,E=f.pending,x=c.memoizedState;if(E!==null){f.pending=null;var C=E=E.next;do x=l(x,C.action),C=C.next;while(C!==E);br(x,c.memoizedState)||(yi=!0),c.memoizedState=x,c.baseQueue===null&&(c.baseState=x),f.lastRenderedState=x}return[x,_]}function dI(){}function fI(l,c){var f=jt,_=hr(),E=c(),x=!br(_.memoizedState,E);if(x&&(_.memoizedState=E,yi=!0),_=_.queue,sv(pI.bind(null,f,_,l),[l]),_.getSnapshot!==c||x||En!==null&&En.memoizedState.tag&1){if(f.flags|=2048,wd(9,mI.bind(null,f,_,E,c),void 0,null),wn===null)throw Error(t(349));(pl&30)!==0||gI(f,c,E)}return E}function gI(l,c,f){l.flags|=16384,l={getSnapshot:c,value:f},c=jt.updateQueue,c===null?(c={lastEffect:null,stores:null},jt.updateQueue=c,c.stores=[l]):(f=c.stores,f===null?c.stores=[l]:f.push(l))}function mI(l,c,f,_){c.value=f,c.getSnapshot=_,_I(c)&&yI(l)}function pI(l,c,f){return f(function(){_I(c)&&yI(l)})}function _I(l){var c=l.getSnapshot;l=l.value;try{var f=c();return!br(l,f)}catch{return!0}}function yI(l){var c=eo(l,1);c!==null&&Or(c,l,1,-1)}function vI(l){var c=ys();return typeof l=="function"&&(l=l()),c.memoizedState=c.baseState=l,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ed,lastRenderedState:l},c.queue=l,l=l.dispatch=m3.bind(null,jt,l),[c.memoizedState,l]}function wd(l,c,f,_){return l={tag:l,create:c,destroy:f,deps:_,next:null},c=jt.updateQueue,c===null?(c={lastEffect:null,stores:null},jt.updateQueue=c,c.lastEffect=l.next=l):(f=c.lastEffect,f===null?c.lastEffect=l.next=l:(_=f.next,f.next=l,l.next=_,c.lastEffect=l)),l}function EI(){return hr().memoizedState}function km(l,c,f,_){var E=ys();jt.flags|=l,E.memoizedState=wd(1|c,f,void 0,_===void 0?null:_)}function Dm(l,c,f,_){var E=hr();_=_===void 0?null:_;var x=void 0;if(hn!==null){var C=hn.memoizedState;if(x=C.destroy,_!==null&&ev(_,C.deps)){E.memoizedState=wd(c,f,x,_);return}}jt.flags|=l,E.memoizedState=wd(1|c,f,x,_)}function wI(l,c){return km(8390656,8,l,c)}function sv(l,c){return Dm(2048,8,l,c)}function xI(l,c){return Dm(4,2,l,c)}function SI(l,c){return Dm(4,4,l,c)}function TI(l,c){if(typeof c=="function")return l=l(),c(l),function(){c(null)};if(c!=null)return l=l(),c.current=l,function(){c.current=null}}function II(l,c,f){return f=f!=null?f.concat([l]):null,Dm(4,4,TI.bind(null,c,l),f)}function ov(){}function AI(l,c){var f=hr();c=c===void 0?null:c;var _=f.memoizedState;return _!==null&&c!==null&&ev(c,_[1])?_[0]:(f.memoizedState=[l,c],l)}function RI(l,c){var f=hr();c=c===void 0?null:c;var _=f.memoizedState;return _!==null&&c!==null&&ev(c,_[1])?_[0]:(l=l(),f.memoizedState=[l,c],l)}function PI(l,c,f){return(pl&21)===0?(l.baseState&&(l.baseState=!1,yi=!0),l.memoizedState=f):(br(f,c)||(f=Hh(),jt.lanes|=f,_l|=f,l.baseState=!0),c)}function f3(l,c){var f=tt;tt=f!==0&&4>f?f:4,l(!0);var _=Jy.transition;Jy.transition={};try{l(!1),c()}finally{tt=f,Jy.transition=_}}function CI(){return hr().memoizedState}function g3(l,c,f){var _=Yo(l);if(f={lane:_,action:f,hasEagerState:!1,eagerState:null,next:null},MI(l))bI(c,f);else if(f=aI(l,c,f,_),f!==null){var E=ai();Or(f,l,_,E),LI(f,c,_)}}function m3(l,c,f){var _=Yo(l),E={lane:_,action:f,hasEagerState:!1,eagerState:null,next:null};if(MI(l))bI(c,E);else{var x=l.alternate;if(l.lanes===0&&(x===null||x.lanes===0)&&(x=c.lastRenderedReducer,x!==null))try{var C=c.lastRenderedState,j=x(C,f);if(E.hasEagerState=!0,E.eagerState=j,br(j,C)){var z=c.interleaved;z===null?(E.next=E,Hy(c)):(E.next=z.next,z.next=E),c.interleaved=E;return}}catch{}f=aI(l,c,E,_),f!==null&&(E=ai(),Or(f,l,_,E),LI(f,c,_))}}function MI(l){var c=l.alternate;return l===jt||c!==null&&c===jt}function bI(l,c){yd=Lm=!0;var f=l.pending;f===null?c.next=c:(c.next=f.next,f.next=c),l.pending=c}function LI(l,c,f){if((f&4194240)!==0){var _=c.lanes;_&=l.pendingLanes,f|=_,c.lanes=f,Xh(l,f)}}var Nm={readContext:cr,useCallback:zn,useContext:zn,useEffect:zn,useImperativeHandle:zn,useInsertionEffect:zn,useLayoutEffect:zn,useMemo:zn,useReducer:zn,useRef:zn,useState:zn,useDebugValue:zn,useDeferredValue:zn,useTransition:zn,useMutableSource:zn,useSyncExternalStore:zn,useId:zn,unstable_isNewReconciler:!1},p3={readContext:cr,useCallback:function(l,c){return ys().memoizedState=[l,c===void 0?null:c],l},useContext:cr,useEffect:wI,useImperativeHandle:function(l,c,f){return f=f!=null?f.concat([l]):null,km(4194308,4,TI.bind(null,c,l),f)},useLayoutEffect:function(l,c){return km(4194308,4,l,c)},useInsertionEffect:function(l,c){return km(4,2,l,c)},useMemo:function(l,c){var f=ys();return c=c===void 0?null:c,l=l(),f.memoizedState=[l,c],l},useReducer:function(l,c,f){var _=ys();return c=f!==void 0?f(c):c,_.memoizedState=_.baseState=c,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:c},_.queue=l,l=l.dispatch=g3.bind(null,jt,l),[_.memoizedState,l]},useRef:function(l){var c=ys();return l={current:l},c.memoizedState=l},useState:vI,useDebugValue:ov,useDeferredValue:function(l){return ys().memoizedState=l},useTransition:function(){var l=vI(!1),c=l[0];return l=f3.bind(null,l[1]),ys().memoizedState=l,[c,l]},useMutableSource:function(){},useSyncExternalStore:function(l,c,f){var _=jt,E=ys();if(Nt){if(f===void 0)throw Error(t(407));f=f()}else{if(f=c(),wn===null)throw Error(t(349));(pl&30)!==0||gI(_,c,f)}E.memoizedState=f;var x={value:f,getSnapshot:c};return E.queue=x,wI(pI.bind(null,_,x,l),[l]),_.flags|=2048,wd(9,mI.bind(null,_,x,f,c),void 0,null),f},useId:function(){var l=ys(),c=wn.identifierPrefix;if(Nt){var f=Js,_=Qs;f=(_&~(1<<32-Ni(_)-1)).toString(32)+f,c=":"+c+"R"+f,f=vd++,0<f&&(c+="H"+f.toString(32)),c+=":"}else f=d3++,c=":"+c+"r"+f.toString(32)+":";return l.memoizedState=c},unstable_isNewReconciler:!1},_3={readContext:cr,useCallback:AI,useContext:cr,useEffect:sv,useImperativeHandle:II,useInsertionEffect:xI,useLayoutEffect:SI,useMemo:RI,useReducer:iv,useRef:EI,useState:function(){return iv(Ed)},useDebugValue:ov,useDeferredValue:function(l){var c=hr();return PI(c,hn.memoizedState,l)},useTransition:function(){var l=iv(Ed)[0],c=hr().memoizedState;return[l,c]},useMutableSource:dI,useSyncExternalStore:fI,useId:CI,unstable_isNewReconciler:!1},y3={readContext:cr,useCallback:AI,useContext:cr,useEffect:sv,useImperativeHandle:II,useInsertionEffect:xI,useLayoutEffect:SI,useMemo:RI,useReducer:rv,useRef:EI,useState:function(){return rv(Ed)},useDebugValue:ov,useDeferredValue:function(l){var c=hr();return hn===null?c.memoizedState=l:PI(c,hn.memoizedState,l)},useTransition:function(){var l=rv(Ed)[0],c=hr().memoizedState;return[l,c]},useMutableSource:dI,useSyncExternalStore:fI,useId:CI,unstable_isNewReconciler:!1};function kr(l,c){if(l&&l.defaultProps){c=ie({},c),l=l.defaultProps;for(var f in l)c[f]===void 0&&(c[f]=l[f]);return c}return c}function av(l,c,f,_){c=l.memoizedState,f=f(_,c),f=f==null?c:ie({},c,f),l.memoizedState=f,l.lanes===0&&(l.updateQueue.baseState=f)}var Om={isMounted:function(l){return(l=l._reactInternals)?Cr(l)===l:!1},enqueueSetState:function(l,c,f){l=l._reactInternals;var _=ai(),E=Yo(l),x=to(_,E);x.payload=c,f!=null&&(x.callback=f),c=Ko(l,x,E),c!==null&&(Or(c,l,E,_),Pm(c,l,E))},enqueueReplaceState:function(l,c,f){l=l._reactInternals;var _=ai(),E=Yo(l),x=to(_,E);x.tag=1,x.payload=c,f!=null&&(x.callback=f),c=Ko(l,x,E),c!==null&&(Or(c,l,E,_),Pm(c,l,E))},enqueueForceUpdate:function(l,c){l=l._reactInternals;var f=ai(),_=Yo(l),E=to(f,_);E.tag=2,c!=null&&(E.callback=c),c=Ko(l,E,_),c!==null&&(Or(c,l,_,f),Pm(c,l,_))}};function kI(l,c,f,_,E,x,C){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(_,x,C):c.prototype&&c.prototype.isPureReactComponent?!ad(f,_)||!ad(E,x):!0}function DI(l,c,f){var _=!1,E=zo,x=c.contextType;return typeof x=="object"&&x!==null?x=cr(x):(E=_i(c)?hl:Bn.current,_=c.contextTypes,x=(_=_!=null)?Qu(l,E):zo),c=new c(f,x),l.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=Om,l.stateNode=c,c._reactInternals=l,_&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=E,l.__reactInternalMemoizedMaskedChildContext=x),c}function NI(l,c,f,_){l=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(f,_),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(f,_),c.state!==l&&Om.enqueueReplaceState(c,c.state,null)}function lv(l,c,f,_){var E=l.stateNode;E.props=f,E.state=l.memoizedState,E.refs={},qy(l);var x=c.contextType;typeof x=="object"&&x!==null?E.context=cr(x):(x=_i(c)?hl:Bn.current,E.context=Qu(l,x)),E.state=l.memoizedState,x=c.getDerivedStateFromProps,typeof x=="function"&&(av(l,c,x,f),E.state=l.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof E.getSnapshotBeforeUpdate=="function"||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(c=E.state,typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount(),c!==E.state&&Om.enqueueReplaceState(E,E.state,null),Cm(l,f,E,_),E.state=l.memoizedState),typeof E.componentDidMount=="function"&&(l.flags|=4194308)}function oc(l,c){try{var f="",_=c;do f+=Me(_),_=_.return;while(_);var E=f}catch(x){E=`
Error generating stack: `+x.message+`
`+x.stack}return{value:l,source:c,stack:E,digest:null}}function uv(l,c,f){return{value:l,source:null,stack:f??null,digest:c??null}}function cv(l,c){try{console.error(c.value)}catch(f){setTimeout(function(){throw f})}}var v3=typeof WeakMap=="function"?WeakMap:Map;function OI(l,c,f){f=to(-1,f),f.tag=3,f.payload={element:null};var _=c.value;return f.callback=function(){zm||(zm=!0,Iv=_),cv(l,c)},f}function VI(l,c,f){f=to(-1,f),f.tag=3;var _=l.type.getDerivedStateFromError;if(typeof _=="function"){var E=c.value;f.payload=function(){return _(E)},f.callback=function(){cv(l,c)}}var x=l.stateNode;return x!==null&&typeof x.componentDidCatch=="function"&&(f.callback=function(){cv(l,c),typeof _!="function"&&(qo===null?qo=new Set([this]):qo.add(this));var C=c.stack;this.componentDidCatch(c.value,{componentStack:C!==null?C:""})}),f}function FI(l,c,f){var _=l.pingCache;if(_===null){_=l.pingCache=new v3;var E=new Set;_.set(c,E)}else E=_.get(c),E===void 0&&(E=new Set,_.set(c,E));E.has(f)||(E.add(f),l=k3.bind(null,l,c,f),c.then(l,l))}function GI(l){do{var c;if((c=l.tag===13)&&(c=l.memoizedState,c=c!==null?c.dehydrated!==null:!0),c)return l;l=l.return}while(l!==null);return null}function jI(l,c,f,_,E){return(l.mode&1)===0?(l===c?l.flags|=65536:(l.flags|=128,f.flags|=131072,f.flags&=-52805,f.tag===1&&(f.alternate===null?f.tag=17:(c=to(-1,1),c.tag=2,Ko(f,c,1))),f.lanes|=1),l):(l.flags|=65536,l.lanes=E,l)}var E3=k.ReactCurrentOwner,yi=!1;function oi(l,c,f,_){c.child=l===null?oI(c,null,f,_):nc(c,l.child,f,_)}function UI(l,c,f,_,E){f=f.render;var x=c.ref;return rc(c,E),_=tv(l,c,f,_,x,E),f=nv(),l!==null&&!yi?(c.updateQueue=l.updateQueue,c.flags&=-2053,l.lanes&=~E,no(l,c,E)):(Nt&&f&&Fy(c),c.flags|=1,oi(l,c,_,E),c.child)}function BI(l,c,f,_,E){if(l===null){var x=f.type;return typeof x=="function"&&!Lv(x)&&x.defaultProps===void 0&&f.compare===null&&f.defaultProps===void 0?(c.tag=15,c.type=x,zI(l,c,x,_,E)):(l=Xm(f.type,null,_,c,c.mode,E),l.ref=c.ref,l.return=c,c.child=l)}if(x=l.child,(l.lanes&E)===0){var C=x.memoizedProps;if(f=f.compare,f=f!==null?f:ad,f(C,_)&&l.ref===c.ref)return no(l,c,E)}return c.flags|=1,l=Qo(x,_),l.ref=c.ref,l.return=c,c.child=l}function zI(l,c,f,_,E){if(l!==null){var x=l.memoizedProps;if(ad(x,_)&&l.ref===c.ref)if(yi=!1,c.pendingProps=_=x,(l.lanes&E)!==0)(l.flags&131072)!==0&&(yi=!0);else return c.lanes=l.lanes,no(l,c,E)}return hv(l,c,f,_,E)}function $I(l,c,f){var _=c.pendingProps,E=_.children,x=l!==null?l.memoizedState:null;if(_.mode==="hidden")if((c.mode&1)===0)c.memoizedState={baseLanes:0,cachePool:null,transitions:null},Pt(lc,Bi),Bi|=f;else{if((f&1073741824)===0)return l=x!==null?x.baseLanes|f:f,c.lanes=c.childLanes=1073741824,c.memoizedState={baseLanes:l,cachePool:null,transitions:null},c.updateQueue=null,Pt(lc,Bi),Bi|=l,null;c.memoizedState={baseLanes:0,cachePool:null,transitions:null},_=x!==null?x.baseLanes:f,Pt(lc,Bi),Bi|=_}else x!==null?(_=x.baseLanes|f,c.memoizedState=null):_=f,Pt(lc,Bi),Bi|=_;return oi(l,c,E,f),c.child}function WI(l,c){var f=c.ref;(l===null&&f!==null||l!==null&&l.ref!==f)&&(c.flags|=512,c.flags|=2097152)}function hv(l,c,f,_,E){var x=_i(f)?hl:Bn.current;return x=Qu(c,x),rc(c,E),f=tv(l,c,f,_,x,E),_=nv(),l!==null&&!yi?(c.updateQueue=l.updateQueue,c.flags&=-2053,l.lanes&=~E,no(l,c,E)):(Nt&&_&&Fy(c),c.flags|=1,oi(l,c,f,E),c.child)}function KI(l,c,f,_,E){if(_i(f)){var x=!0;Em(c)}else x=!1;if(rc(c,E),c.stateNode===null)Fm(l,c),DI(c,f,_),lv(c,f,_,E),_=!0;else if(l===null){var C=c.stateNode,j=c.memoizedProps;C.props=j;var z=C.context,Z=f.contextType;typeof Z=="object"&&Z!==null?Z=cr(Z):(Z=_i(f)?hl:Bn.current,Z=Qu(c,Z));var oe=f.getDerivedStateFromProps,ue=typeof oe=="function"||typeof C.getSnapshotBeforeUpdate=="function";ue||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(j!==_||z!==Z)&&NI(c,C,_,Z),Wo=!1;var re=c.memoizedState;C.state=re,Cm(c,_,C,E),z=c.memoizedState,j!==_||re!==z||pi.current||Wo?(typeof oe=="function"&&(av(c,f,oe,_),z=c.memoizedState),(j=Wo||kI(c,f,j,_,re,z,Z))?(ue||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount()),typeof C.componentDidMount=="function"&&(c.flags|=4194308)):(typeof C.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=_,c.memoizedState=z),C.props=_,C.state=z,C.context=Z,_=j):(typeof C.componentDidMount=="function"&&(c.flags|=4194308),_=!1)}else{C=c.stateNode,lI(l,c),j=c.memoizedProps,Z=c.type===c.elementType?j:kr(c.type,j),C.props=Z,ue=c.pendingProps,re=C.context,z=f.contextType,typeof z=="object"&&z!==null?z=cr(z):(z=_i(f)?hl:Bn.current,z=Qu(c,z));var ve=f.getDerivedStateFromProps;(oe=typeof ve=="function"||typeof C.getSnapshotBeforeUpdate=="function")||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(j!==ue||re!==z)&&NI(c,C,_,z),Wo=!1,re=c.memoizedState,C.state=re,Cm(c,_,C,E);var Se=c.memoizedState;j!==ue||re!==Se||pi.current||Wo?(typeof ve=="function"&&(av(c,f,ve,_),Se=c.memoizedState),(Z=Wo||kI(c,f,Z,_,re,Se,z)||!1)?(oe||typeof C.UNSAFE_componentWillUpdate!="function"&&typeof C.componentWillUpdate!="function"||(typeof C.componentWillUpdate=="function"&&C.componentWillUpdate(_,Se,z),typeof C.UNSAFE_componentWillUpdate=="function"&&C.UNSAFE_componentWillUpdate(_,Se,z)),typeof C.componentDidUpdate=="function"&&(c.flags|=4),typeof C.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof C.componentDidUpdate!="function"||j===l.memoizedProps&&re===l.memoizedState||(c.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||j===l.memoizedProps&&re===l.memoizedState||(c.flags|=1024),c.memoizedProps=_,c.memoizedState=Se),C.props=_,C.state=Se,C.context=z,_=Z):(typeof C.componentDidUpdate!="function"||j===l.memoizedProps&&re===l.memoizedState||(c.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||j===l.memoizedProps&&re===l.memoizedState||(c.flags|=1024),_=!1)}return dv(l,c,f,_,x,E)}function dv(l,c,f,_,E,x){WI(l,c);var C=(c.flags&128)!==0;if(!_&&!C)return E&&ZT(c,f,!1),no(l,c,x);_=c.stateNode,E3.current=c;var j=C&&typeof f.getDerivedStateFromError!="function"?null:_.render();return c.flags|=1,l!==null&&C?(c.child=nc(c,l.child,null,x),c.child=nc(c,null,j,x)):oi(l,c,j,x),c.memoizedState=_.state,E&&ZT(c,f,!0),c.child}function HI(l){var c=l.stateNode;c.pendingContext?XT(l,c.pendingContext,c.pendingContext!==c.context):c.context&&XT(l,c.context,!1),Xy(l,c.containerInfo)}function qI(l,c,f,_,E){return tc(),By(E),c.flags|=256,oi(l,c,f,_),c.child}var fv={dehydrated:null,treeContext:null,retryLane:0};function gv(l){return{baseLanes:l,cachePool:null,transitions:null}}function XI(l,c,f){var _=c.pendingProps,E=Gt.current,x=!1,C=(c.flags&128)!==0,j;if((j=C)||(j=l!==null&&l.memoizedState===null?!1:(E&2)!==0),j?(x=!0,c.flags&=-129):(l===null||l.memoizedState!==null)&&(E|=1),Pt(Gt,E&1),l===null)return Uy(c),l=c.memoizedState,l!==null&&(l=l.dehydrated,l!==null)?((c.mode&1)===0?c.lanes=1:l.data==="$!"?c.lanes=8:c.lanes=1073741824,null):(C=_.children,l=_.fallback,x?(_=c.mode,x=c.child,C={mode:"hidden",children:C},(_&1)===0&&x!==null?(x.childLanes=0,x.pendingProps=C):x=Ym(C,_,0,null),l=wl(l,_,f,null),x.return=c,l.return=c,x.sibling=l,c.child=x,c.child.memoizedState=gv(f),c.memoizedState=fv,l):mv(c,C));if(E=l.memoizedState,E!==null&&(j=E.dehydrated,j!==null))return w3(l,c,C,_,j,E,f);if(x){x=_.fallback,C=c.mode,E=l.child,j=E.sibling;var z={mode:"hidden",children:_.children};return(C&1)===0&&c.child!==E?(_=c.child,_.childLanes=0,_.pendingProps=z,c.deletions=null):(_=Qo(E,z),_.subtreeFlags=E.subtreeFlags&14680064),j!==null?x=Qo(j,x):(x=wl(x,C,f,null),x.flags|=2),x.return=c,_.return=c,_.sibling=x,c.child=_,_=x,x=c.child,C=l.child.memoizedState,C=C===null?gv(f):{baseLanes:C.baseLanes|f,cachePool:null,transitions:C.transitions},x.memoizedState=C,x.childLanes=l.childLanes&~f,c.memoizedState=fv,_}return x=l.child,l=x.sibling,_=Qo(x,{mode:"visible",children:_.children}),(c.mode&1)===0&&(_.lanes=f),_.return=c,_.sibling=null,l!==null&&(f=c.deletions,f===null?(c.deletions=[l],c.flags|=16):f.push(l)),c.child=_,c.memoizedState=null,_}function mv(l,c){return c=Ym({mode:"visible",children:c},l.mode,0,null),c.return=l,l.child=c}function Vm(l,c,f,_){return _!==null&&By(_),nc(c,l.child,null,f),l=mv(c,c.pendingProps.children),l.flags|=2,c.memoizedState=null,l}function w3(l,c,f,_,E,x,C){if(f)return c.flags&256?(c.flags&=-257,_=uv(Error(t(422))),Vm(l,c,C,_)):c.memoizedState!==null?(c.child=l.child,c.flags|=128,null):(x=_.fallback,E=c.mode,_=Ym({mode:"visible",children:_.children},E,0,null),x=wl(x,E,C,null),x.flags|=2,_.return=c,x.return=c,_.sibling=x,c.child=_,(c.mode&1)!==0&&nc(c,l.child,null,C),c.child.memoizedState=gv(C),c.memoizedState=fv,x);if((c.mode&1)===0)return Vm(l,c,C,null);if(E.data==="$!"){if(_=E.nextSibling&&E.nextSibling.dataset,_)var j=_.dgst;return _=j,x=Error(t(419)),_=uv(x,_,void 0),Vm(l,c,C,_)}if(j=(C&l.childLanes)!==0,yi||j){if(_=wn,_!==null){switch(C&-C){case 4:E=2;break;case 16:E=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:E=32;break;case 536870912:E=268435456;break;default:E=0}E=(E&(_.suspendedLanes|C))!==0?0:E,E!==0&&E!==x.retryLane&&(x.retryLane=E,eo(l,E),Or(_,l,E,-1))}return bv(),_=uv(Error(t(421))),Vm(l,c,C,_)}return E.data==="$?"?(c.flags|=128,c.child=l.child,c=D3.bind(null,l),E._reactRetry=c,null):(l=x.treeContext,Ui=Uo(E.nextSibling),ji=c,Nt=!0,Lr=null,l!==null&&(lr[ur++]=Qs,lr[ur++]=Js,lr[ur++]=dl,Qs=l.id,Js=l.overflow,dl=c),c=mv(c,_.children),c.flags|=4096,c)}function YI(l,c,f){l.lanes|=c;var _=l.alternate;_!==null&&(_.lanes|=c),Ky(l.return,c,f)}function pv(l,c,f,_,E){var x=l.memoizedState;x===null?l.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:_,tail:f,tailMode:E}:(x.isBackwards=c,x.rendering=null,x.renderingStartTime=0,x.last=_,x.tail=f,x.tailMode=E)}function ZI(l,c,f){var _=c.pendingProps,E=_.revealOrder,x=_.tail;if(oi(l,c,_.children,f),_=Gt.current,(_&2)!==0)_=_&1|2,c.flags|=128;else{if(l!==null&&(l.flags&128)!==0)e:for(l=c.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&YI(l,f,c);else if(l.tag===19)YI(l,f,c);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===c)break e;for(;l.sibling===null;){if(l.return===null||l.return===c)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}_&=1}if(Pt(Gt,_),(c.mode&1)===0)c.memoizedState=null;else switch(E){case"forwards":for(f=c.child,E=null;f!==null;)l=f.alternate,l!==null&&Mm(l)===null&&(E=f),f=f.sibling;f=E,f===null?(E=c.child,c.child=null):(E=f.sibling,f.sibling=null),pv(c,!1,E,f,x);break;case"backwards":for(f=null,E=c.child,c.child=null;E!==null;){if(l=E.alternate,l!==null&&Mm(l)===null){c.child=E;break}l=E.sibling,E.sibling=f,f=E,E=l}pv(c,!0,f,null,x);break;case"together":pv(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function Fm(l,c){(c.mode&1)===0&&l!==null&&(l.alternate=null,c.alternate=null,c.flags|=2)}function no(l,c,f){if(l!==null&&(c.dependencies=l.dependencies),_l|=c.lanes,(f&c.childLanes)===0)return null;if(l!==null&&c.child!==l.child)throw Error(t(153));if(c.child!==null){for(l=c.child,f=Qo(l,l.pendingProps),c.child=f,f.return=c;l.sibling!==null;)l=l.sibling,f=f.sibling=Qo(l,l.pendingProps),f.return=c;f.sibling=null}return c.child}function x3(l,c,f){switch(c.tag){case 3:HI(c),tc();break;case 5:hI(c);break;case 1:_i(c.type)&&Em(c);break;case 4:Xy(c,c.stateNode.containerInfo);break;case 10:var _=c.type._context,E=c.memoizedProps.value;Pt(Am,_._currentValue),_._currentValue=E;break;case 13:if(_=c.memoizedState,_!==null)return _.dehydrated!==null?(Pt(Gt,Gt.current&1),c.flags|=128,null):(f&c.child.childLanes)!==0?XI(l,c,f):(Pt(Gt,Gt.current&1),l=no(l,c,f),l!==null?l.sibling:null);Pt(Gt,Gt.current&1);break;case 19:if(_=(f&c.childLanes)!==0,(l.flags&128)!==0){if(_)return ZI(l,c,f);c.flags|=128}if(E=c.memoizedState,E!==null&&(E.rendering=null,E.tail=null,E.lastEffect=null),Pt(Gt,Gt.current),_)break;return null;case 22:case 23:return c.lanes=0,$I(l,c,f)}return no(l,c,f)}var QI,_v,JI,e2;QI=function(l,c){for(var f=c.child;f!==null;){if(f.tag===5||f.tag===6)l.appendChild(f.stateNode);else if(f.tag!==4&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===c)break;for(;f.sibling===null;){if(f.return===null||f.return===c)return;f=f.return}f.sibling.return=f.return,f=f.sibling}},_v=function(){},JI=function(l,c,f,_){var E=l.memoizedProps;if(E!==_){l=c.stateNode,ml(_s.current);var x=null;switch(f){case"input":E=gi(l,E),_=gi(l,_),x=[];break;case"select":E=ie({},E,{value:void 0}),_=ie({},_,{value:void 0}),x=[];break;case"textarea":E=tr(l,E),_=tr(l,_),x=[];break;default:typeof E.onClick!="function"&&typeof _.onClick=="function"&&(l.onclick=_m)}ii(f,_);var C;f=null;for(Z in E)if(!_.hasOwnProperty(Z)&&E.hasOwnProperty(Z)&&E[Z]!=null)if(Z==="style"){var j=E[Z];for(C in j)j.hasOwnProperty(C)&&(f||(f={}),f[C]="")}else Z!=="dangerouslySetInnerHTML"&&Z!=="children"&&Z!=="suppressContentEditableWarning"&&Z!=="suppressHydrationWarning"&&Z!=="autoFocus"&&(r.hasOwnProperty(Z)?x||(x=[]):(x=x||[]).push(Z,null));for(Z in _){var z=_[Z];if(j=E?.[Z],_.hasOwnProperty(Z)&&z!==j&&(z!=null||j!=null))if(Z==="style")if(j){for(C in j)!j.hasOwnProperty(C)||z&&z.hasOwnProperty(C)||(f||(f={}),f[C]="");for(C in z)z.hasOwnProperty(C)&&j[C]!==z[C]&&(f||(f={}),f[C]=z[C])}else f||(x||(x=[]),x.push(Z,f)),f=z;else Z==="dangerouslySetInnerHTML"?(z=z?z.__html:void 0,j=j?j.__html:void 0,z!=null&&j!==z&&(x=x||[]).push(Z,z)):Z==="children"?typeof z!="string"&&typeof z!="number"||(x=x||[]).push(Z,""+z):Z!=="suppressContentEditableWarning"&&Z!=="suppressHydrationWarning"&&(r.hasOwnProperty(Z)?(z!=null&&Z==="onScroll"&&Mt("scroll",l),x||j===z||(x=[])):(x=x||[]).push(Z,z))}f&&(x=x||[]).push("style",f);var Z=x;(c.updateQueue=Z)&&(c.flags|=4)}},e2=function(l,c,f,_){f!==_&&(c.flags|=4)};function xd(l,c){if(!Nt)switch(l.tailMode){case"hidden":c=l.tail;for(var f=null;c!==null;)c.alternate!==null&&(f=c),c=c.sibling;f===null?l.tail=null:f.sibling=null;break;case"collapsed":f=l.tail;for(var _=null;f!==null;)f.alternate!==null&&(_=f),f=f.sibling;_===null?c||l.tail===null?l.tail=null:l.tail.sibling=null:_.sibling=null}}function $n(l){var c=l.alternate!==null&&l.alternate.child===l.child,f=0,_=0;if(c)for(var E=l.child;E!==null;)f|=E.lanes|E.childLanes,_|=E.subtreeFlags&14680064,_|=E.flags&14680064,E.return=l,E=E.sibling;else for(E=l.child;E!==null;)f|=E.lanes|E.childLanes,_|=E.subtreeFlags,_|=E.flags,E.return=l,E=E.sibling;return l.subtreeFlags|=_,l.childLanes=f,c}function S3(l,c,f){var _=c.pendingProps;switch(Gy(c),c.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return $n(c),null;case 1:return _i(c.type)&&vm(),$n(c),null;case 3:return _=c.stateNode,sc(),bt(pi),bt(Bn),Qy(),_.pendingContext&&(_.context=_.pendingContext,_.pendingContext=null),(l===null||l.child===null)&&(Tm(c)?c.flags|=4:l===null||l.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,Lr!==null&&(Pv(Lr),Lr=null))),_v(l,c),$n(c),null;case 5:Yy(c);var E=ml(_d.current);if(f=c.type,l!==null&&c.stateNode!=null)JI(l,c,f,_,E),l.ref!==c.ref&&(c.flags|=512,c.flags|=2097152);else{if(!_){if(c.stateNode===null)throw Error(t(166));return $n(c),null}if(l=ml(_s.current),Tm(c)){_=c.stateNode,f=c.type;var x=c.memoizedProps;switch(_[ps]=c,_[dd]=x,l=(c.mode&1)!==0,f){case"dialog":Mt("cancel",_),Mt("close",_);break;case"iframe":case"object":case"embed":Mt("load",_);break;case"video":case"audio":for(E=0;E<ud.length;E++)Mt(ud[E],_);break;case"source":Mt("error",_);break;case"img":case"image":case"link":Mt("error",_),Mt("load",_);break;case"details":Mt("toggle",_);break;case"input":Rn(_,x),Mt("invalid",_);break;case"select":_._wrapperState={wasMultiple:!!x.multiple},Mt("invalid",_);break;case"textarea":Dt(_,x),Mt("invalid",_)}ii(f,x),E=null;for(var C in x)if(x.hasOwnProperty(C)){var j=x[C];C==="children"?typeof j=="string"?_.textContent!==j&&(x.suppressHydrationWarning!==!0&&pm(_.textContent,j,l),E=["children",j]):typeof j=="number"&&_.textContent!==""+j&&(x.suppressHydrationWarning!==!0&&pm(_.textContent,j,l),E=["children",""+j]):r.hasOwnProperty(C)&&j!=null&&C==="onScroll"&&Mt("scroll",_)}switch(f){case"input":Ar(_),er(_,x,!0);break;case"textarea":Ar(_),nr(_);break;case"select":case"option":break;default:typeof x.onClick=="function"&&(_.onclick=_m)}_=E,c.updateQueue=_,_!==null&&(c.flags|=4)}else{C=E.nodeType===9?E:E.ownerDocument,l==="http://www.w3.org/1999/xhtml"&&(l=Qr(f)),l==="http://www.w3.org/1999/xhtml"?f==="script"?(l=C.createElement("div"),l.innerHTML="<script><\/script>",l=l.removeChild(l.firstChild)):typeof _.is=="string"?l=C.createElement(f,{is:_.is}):(l=C.createElement(f),f==="select"&&(C=l,_.multiple?C.multiple=!0:_.size&&(C.size=_.size))):l=C.createElementNS(l,f),l[ps]=c,l[dd]=_,QI(l,c,!1,!1),c.stateNode=l;e:{switch(C=Bs(f,_),f){case"dialog":Mt("cancel",l),Mt("close",l),E=_;break;case"iframe":case"object":case"embed":Mt("load",l),E=_;break;case"video":case"audio":for(E=0;E<ud.length;E++)Mt(ud[E],l);E=_;break;case"source":Mt("error",l),E=_;break;case"img":case"image":case"link":Mt("error",l),Mt("load",l),E=_;break;case"details":Mt("toggle",l),E=_;break;case"input":Rn(l,_),E=gi(l,_),Mt("invalid",l);break;case"option":E=_;break;case"select":l._wrapperState={wasMultiple:!!_.multiple},E=ie({},_,{value:void 0}),Mt("invalid",l);break;case"textarea":Dt(l,_),E=tr(l,_),Mt("invalid",l);break;default:E=_}ii(f,E),j=E;for(x in j)if(j.hasOwnProperty(x)){var z=j[x];x==="style"?Us(l,z):x==="dangerouslySetInnerHTML"?(z=z?z.__html:void 0,z!=null&&Za(l,z)):x==="children"?typeof z=="string"?(f!=="textarea"||z!=="")&&es(l,z):typeof z=="number"&&es(l,""+z):x!=="suppressContentEditableWarning"&&x!=="suppressHydrationWarning"&&x!=="autoFocus"&&(r.hasOwnProperty(x)?z!=null&&x==="onScroll"&&Mt("scroll",l):z!=null&&M(l,x,z,C))}switch(f){case"input":Ar(l),er(l,_,!1);break;case"textarea":Ar(l),nr(l);break;case"option":_.value!=null&&l.setAttribute("value",""+Ke(_.value));break;case"select":l.multiple=!!_.multiple,x=_.value,x!=null?yn(l,!!_.multiple,x,!1):_.defaultValue!=null&&yn(l,!!_.multiple,_.defaultValue,!0);break;default:typeof E.onClick=="function"&&(l.onclick=_m)}switch(f){case"button":case"input":case"select":case"textarea":_=!!_.autoFocus;break e;case"img":_=!0;break e;default:_=!1}}_&&(c.flags|=4)}c.ref!==null&&(c.flags|=512,c.flags|=2097152)}return $n(c),null;case 6:if(l&&c.stateNode!=null)e2(l,c,l.memoizedProps,_);else{if(typeof _!="string"&&c.stateNode===null)throw Error(t(166));if(f=ml(_d.current),ml(_s.current),Tm(c)){if(_=c.stateNode,f=c.memoizedProps,_[ps]=c,(x=_.nodeValue!==f)&&(l=ji,l!==null))switch(l.tag){case 3:pm(_.nodeValue,f,(l.mode&1)!==0);break;case 5:l.memoizedProps.suppressHydrationWarning!==!0&&pm(_.nodeValue,f,(l.mode&1)!==0)}x&&(c.flags|=4)}else _=(f.nodeType===9?f:f.ownerDocument).createTextNode(_),_[ps]=c,c.stateNode=_}return $n(c),null;case 13:if(bt(Gt),_=c.memoizedState,l===null||l.memoizedState!==null&&l.memoizedState.dehydrated!==null){if(Nt&&Ui!==null&&(c.mode&1)!==0&&(c.flags&128)===0)iI(),tc(),c.flags|=98560,x=!1;else if(x=Tm(c),_!==null&&_.dehydrated!==null){if(l===null){if(!x)throw Error(t(318));if(x=c.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(t(317));x[ps]=c}else tc(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;$n(c),x=!1}else Lr!==null&&(Pv(Lr),Lr=null),x=!0;if(!x)return c.flags&65536?c:null}return(c.flags&128)!==0?(c.lanes=f,c):(_=_!==null,_!==(l!==null&&l.memoizedState!==null)&&_&&(c.child.flags|=8192,(c.mode&1)!==0&&(l===null||(Gt.current&1)!==0?dn===0&&(dn=3):bv())),c.updateQueue!==null&&(c.flags|=4),$n(c),null);case 4:return sc(),_v(l,c),l===null&&cd(c.stateNode.containerInfo),$n(c),null;case 10:return Wy(c.type._context),$n(c),null;case 17:return _i(c.type)&&vm(),$n(c),null;case 19:if(bt(Gt),x=c.memoizedState,x===null)return $n(c),null;if(_=(c.flags&128)!==0,C=x.rendering,C===null)if(_)xd(x,!1);else{if(dn!==0||l!==null&&(l.flags&128)!==0)for(l=c.child;l!==null;){if(C=Mm(l),C!==null){for(c.flags|=128,xd(x,!1),_=C.updateQueue,_!==null&&(c.updateQueue=_,c.flags|=4),c.subtreeFlags=0,_=f,f=c.child;f!==null;)x=f,l=_,x.flags&=14680066,C=x.alternate,C===null?(x.childLanes=0,x.lanes=l,x.child=null,x.subtreeFlags=0,x.memoizedProps=null,x.memoizedState=null,x.updateQueue=null,x.dependencies=null,x.stateNode=null):(x.childLanes=C.childLanes,x.lanes=C.lanes,x.child=C.child,x.subtreeFlags=0,x.deletions=null,x.memoizedProps=C.memoizedProps,x.memoizedState=C.memoizedState,x.updateQueue=C.updateQueue,x.type=C.type,l=C.dependencies,x.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),f=f.sibling;return Pt(Gt,Gt.current&1|2),c.child}l=l.sibling}x.tail!==null&&Ct()>uc&&(c.flags|=128,_=!0,xd(x,!1),c.lanes=4194304)}else{if(!_)if(l=Mm(C),l!==null){if(c.flags|=128,_=!0,f=l.updateQueue,f!==null&&(c.updateQueue=f,c.flags|=4),xd(x,!0),x.tail===null&&x.tailMode==="hidden"&&!C.alternate&&!Nt)return $n(c),null}else 2*Ct()-x.renderingStartTime>uc&&f!==1073741824&&(c.flags|=128,_=!0,xd(x,!1),c.lanes=4194304);x.isBackwards?(C.sibling=c.child,c.child=C):(f=x.last,f!==null?f.sibling=C:c.child=C,x.last=C)}return x.tail!==null?(c=x.tail,x.rendering=c,x.tail=c.sibling,x.renderingStartTime=Ct(),c.sibling=null,f=Gt.current,Pt(Gt,_?f&1|2:f&1),c):($n(c),null);case 22:case 23:return Mv(),_=c.memoizedState!==null,l!==null&&l.memoizedState!==null!==_&&(c.flags|=8192),_&&(c.mode&1)!==0?(Bi&1073741824)!==0&&($n(c),c.subtreeFlags&6&&(c.flags|=8192)):$n(c),null;case 24:return null;case 25:return null}throw Error(t(156,c.tag))}function T3(l,c){switch(Gy(c),c.tag){case 1:return _i(c.type)&&vm(),l=c.flags,l&65536?(c.flags=l&-65537|128,c):null;case 3:return sc(),bt(pi),bt(Bn),Qy(),l=c.flags,(l&65536)!==0&&(l&128)===0?(c.flags=l&-65537|128,c):null;case 5:return Yy(c),null;case 13:if(bt(Gt),l=c.memoizedState,l!==null&&l.dehydrated!==null){if(c.alternate===null)throw Error(t(340));tc()}return l=c.flags,l&65536?(c.flags=l&-65537|128,c):null;case 19:return bt(Gt),null;case 4:return sc(),null;case 10:return Wy(c.type._context),null;case 22:case 23:return Mv(),null;case 24:return null;default:return null}}var Gm=!1,Wn=!1,I3=typeof WeakSet=="function"?WeakSet:Set,xe=null;function ac(l,c){var f=l.ref;if(f!==null)if(typeof f=="function")try{f(null)}catch(_){Wt(l,c,_)}else f.current=null}function yv(l,c,f){try{f()}catch(_){Wt(l,c,_)}}var t2=!1;function A3(l,c){if(My=Hs,l=kT(),xy(l)){if("selectionStart"in l)var f={start:l.selectionStart,end:l.selectionEnd};else e:{f=(f=l.ownerDocument)&&f.defaultView||window;var _=f.getSelection&&f.getSelection();if(_&&_.rangeCount!==0){f=_.anchorNode;var E=_.anchorOffset,x=_.focusNode;_=_.focusOffset;try{f.nodeType,x.nodeType}catch{f=null;break e}var C=0,j=-1,z=-1,Z=0,oe=0,ue=l,re=null;t:for(;;){for(var ve;ue!==f||E!==0&&ue.nodeType!==3||(j=C+E),ue!==x||_!==0&&ue.nodeType!==3||(z=C+_),ue.nodeType===3&&(C+=ue.nodeValue.length),(ve=ue.firstChild)!==null;)re=ue,ue=ve;for(;;){if(ue===l)break t;if(re===f&&++Z===E&&(j=C),re===x&&++oe===_&&(z=C),(ve=ue.nextSibling)!==null)break;ue=re,re=ue.parentNode}ue=ve}f=j===-1||z===-1?null:{start:j,end:z}}else f=null}f=f||{start:0,end:0}}else f=null;for(by={focusedElem:l,selectionRange:f},Hs=!1,xe=c;xe!==null;)if(c=xe,l=c.child,(c.subtreeFlags&1028)!==0&&l!==null)l.return=c,xe=l;else for(;xe!==null;){c=xe;try{var Se=c.alternate;if((c.flags&1024)!==0)switch(c.tag){case 0:case 11:case 15:break;case 1:if(Se!==null){var Ae=Se.memoizedProps,Jt=Se.memoizedState,q=c.stateNode,W=q.getSnapshotBeforeUpdate(c.elementType===c.type?Ae:kr(c.type,Ae),Jt);q.__reactInternalSnapshotBeforeUpdate=W}break;case 3:var Y=c.stateNode.containerInfo;Y.nodeType===1?Y.textContent="":Y.nodeType===9&&Y.documentElement&&Y.removeChild(Y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(he){Wt(c,c.return,he)}if(l=c.sibling,l!==null){l.return=c.return,xe=l;break}xe=c.return}return Se=t2,t2=!1,Se}function Sd(l,c,f){var _=c.updateQueue;if(_=_!==null?_.lastEffect:null,_!==null){var E=_=_.next;do{if((E.tag&l)===l){var x=E.destroy;E.destroy=void 0,x!==void 0&&yv(c,f,x)}E=E.next}while(E!==_)}}function jm(l,c){if(c=c.updateQueue,c=c!==null?c.lastEffect:null,c!==null){var f=c=c.next;do{if((f.tag&l)===l){var _=f.create;f.destroy=_()}f=f.next}while(f!==c)}}function vv(l){var c=l.ref;if(c!==null){var f=l.stateNode;switch(l.tag){case 5:l=f;break;default:l=f}typeof c=="function"?c(l):c.current=l}}function n2(l){var c=l.alternate;c!==null&&(l.alternate=null,n2(c)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(c=l.stateNode,c!==null&&(delete c[ps],delete c[dd],delete c[Ny],delete c[l3],delete c[u3])),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}function i2(l){return l.tag===5||l.tag===3||l.tag===4}function r2(l){e:for(;;){for(;l.sibling===null;){if(l.return===null||i2(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(l.flags&2||l.child===null||l.tag===4)continue e;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function Ev(l,c,f){var _=l.tag;if(_===5||_===6)l=l.stateNode,c?f.nodeType===8?f.parentNode.insertBefore(l,c):f.insertBefore(l,c):(f.nodeType===8?(c=f.parentNode,c.insertBefore(l,f)):(c=f,c.appendChild(l)),f=f._reactRootContainer,f!=null||c.onclick!==null||(c.onclick=_m));else if(_!==4&&(l=l.child,l!==null))for(Ev(l,c,f),l=l.sibling;l!==null;)Ev(l,c,f),l=l.sibling}function wv(l,c,f){var _=l.tag;if(_===5||_===6)l=l.stateNode,c?f.insertBefore(l,c):f.appendChild(l);else if(_!==4&&(l=l.child,l!==null))for(wv(l,c,f),l=l.sibling;l!==null;)wv(l,c,f),l=l.sibling}var Dn=null,Dr=!1;function Ho(l,c,f){for(f=f.child;f!==null;)s2(l,c,f),f=f.sibling}function s2(l,c,f){if(Di&&typeof Di.onCommitFiberUnmount=="function")try{Di.onCommitFiberUnmount(tl,f)}catch{}switch(f.tag){case 5:Wn||ac(f,c);case 6:var _=Dn,E=Dr;Dn=null,Ho(l,c,f),Dn=_,Dr=E,Dn!==null&&(Dr?(l=Dn,f=f.stateNode,l.nodeType===8?l.parentNode.removeChild(f):l.removeChild(f)):Dn.removeChild(f.stateNode));break;case 18:Dn!==null&&(Dr?(l=Dn,f=f.stateNode,l.nodeType===8?Dy(l.parentNode,f):l.nodeType===1&&Dy(l,f),Vo(l)):Dy(Dn,f.stateNode));break;case 4:_=Dn,E=Dr,Dn=f.stateNode.containerInfo,Dr=!0,Ho(l,c,f),Dn=_,Dr=E;break;case 0:case 11:case 14:case 15:if(!Wn&&(_=f.updateQueue,_!==null&&(_=_.lastEffect,_!==null))){E=_=_.next;do{var x=E,C=x.destroy;x=x.tag,C!==void 0&&((x&2)!==0||(x&4)!==0)&&yv(f,c,C),E=E.next}while(E!==_)}Ho(l,c,f);break;case 1:if(!Wn&&(ac(f,c),_=f.stateNode,typeof _.componentWillUnmount=="function"))try{_.props=f.memoizedProps,_.state=f.memoizedState,_.componentWillUnmount()}catch(j){Wt(f,c,j)}Ho(l,c,f);break;case 21:Ho(l,c,f);break;case 22:f.mode&1?(Wn=(_=Wn)||f.memoizedState!==null,Ho(l,c,f),Wn=_):Ho(l,c,f);break;default:Ho(l,c,f)}}function o2(l){var c=l.updateQueue;if(c!==null){l.updateQueue=null;var f=l.stateNode;f===null&&(f=l.stateNode=new I3),c.forEach(function(_){var E=N3.bind(null,l,_);f.has(_)||(f.add(_),_.then(E,E))})}}function Nr(l,c){var f=c.deletions;if(f!==null)for(var _=0;_<f.length;_++){var E=f[_];try{var x=l,C=c,j=C;e:for(;j!==null;){switch(j.tag){case 5:Dn=j.stateNode,Dr=!1;break e;case 3:Dn=j.stateNode.containerInfo,Dr=!0;break e;case 4:Dn=j.stateNode.containerInfo,Dr=!0;break e}j=j.return}if(Dn===null)throw Error(t(160));s2(x,C,E),Dn=null,Dr=!1;var z=E.alternate;z!==null&&(z.return=null),E.return=null}catch(Z){Wt(E,c,Z)}}if(c.subtreeFlags&12854)for(c=c.child;c!==null;)a2(c,l),c=c.sibling}function a2(l,c){var f=l.alternate,_=l.flags;switch(l.tag){case 0:case 11:case 14:case 15:if(Nr(c,l),vs(l),_&4){try{Sd(3,l,l.return),jm(3,l)}catch(Ae){Wt(l,l.return,Ae)}try{Sd(5,l,l.return)}catch(Ae){Wt(l,l.return,Ae)}}break;case 1:Nr(c,l),vs(l),_&512&&f!==null&&ac(f,f.return);break;case 5:if(Nr(c,l),vs(l),_&512&&f!==null&&ac(f,f.return),l.flags&32){var E=l.stateNode;try{es(E,"")}catch(Ae){Wt(l,l.return,Ae)}}if(_&4&&(E=l.stateNode,E!=null)){var x=l.memoizedProps,C=f!==null?f.memoizedProps:x,j=l.type,z=l.updateQueue;if(l.updateQueue=null,z!==null)try{j==="input"&&x.type==="radio"&&x.name!=null&&Pn(E,x),Bs(j,C);var Z=Bs(j,x);for(C=0;C<z.length;C+=2){var oe=z[C],ue=z[C+1];oe==="style"?Us(E,ue):oe==="dangerouslySetInnerHTML"?Za(E,ue):oe==="children"?es(E,ue):M(E,oe,ue,Z)}switch(j){case"input":mi(E,x);break;case"textarea":bo(E,x);break;case"select":var re=E._wrapperState.wasMultiple;E._wrapperState.wasMultiple=!!x.multiple;var ve=x.value;ve!=null?yn(E,!!x.multiple,ve,!1):re!==!!x.multiple&&(x.defaultValue!=null?yn(E,!!x.multiple,x.defaultValue,!0):yn(E,!!x.multiple,x.multiple?[]:"",!1))}E[dd]=x}catch(Ae){Wt(l,l.return,Ae)}}break;case 6:if(Nr(c,l),vs(l),_&4){if(l.stateNode===null)throw Error(t(162));E=l.stateNode,x=l.memoizedProps;try{E.nodeValue=x}catch(Ae){Wt(l,l.return,Ae)}}break;case 3:if(Nr(c,l),vs(l),_&4&&f!==null&&f.memoizedState.isDehydrated)try{Vo(c.containerInfo)}catch(Ae){Wt(l,l.return,Ae)}break;case 4:Nr(c,l),vs(l);break;case 13:Nr(c,l),vs(l),E=l.child,E.flags&8192&&(x=E.memoizedState!==null,E.stateNode.isHidden=x,!x||E.alternate!==null&&E.alternate.memoizedState!==null||(Tv=Ct())),_&4&&o2(l);break;case 22:if(oe=f!==null&&f.memoizedState!==null,l.mode&1?(Wn=(Z=Wn)||oe,Nr(c,l),Wn=Z):Nr(c,l),vs(l),_&8192){if(Z=l.memoizedState!==null,(l.stateNode.isHidden=Z)&&!oe&&(l.mode&1)!==0)for(xe=l,oe=l.child;oe!==null;){for(ue=xe=oe;xe!==null;){switch(re=xe,ve=re.child,re.tag){case 0:case 11:case 14:case 15:Sd(4,re,re.return);break;case 1:ac(re,re.return);var Se=re.stateNode;if(typeof Se.componentWillUnmount=="function"){_=re,f=re.return;try{c=_,Se.props=c.memoizedProps,Se.state=c.memoizedState,Se.componentWillUnmount()}catch(Ae){Wt(_,f,Ae)}}break;case 5:ac(re,re.return);break;case 22:if(re.memoizedState!==null){c2(ue);continue}}ve!==null?(ve.return=re,xe=ve):c2(ue)}oe=oe.sibling}e:for(oe=null,ue=l;;){if(ue.tag===5){if(oe===null){oe=ue;try{E=ue.stateNode,Z?(x=E.style,typeof x.setProperty=="function"?x.setProperty("display","none","important"):x.display="none"):(j=ue.stateNode,z=ue.memoizedProps.style,C=z!=null&&z.hasOwnProperty("display")?z.display:null,j.style.display=ts("display",C))}catch(Ae){Wt(l,l.return,Ae)}}}else if(ue.tag===6){if(oe===null)try{ue.stateNode.nodeValue=Z?"":ue.memoizedProps}catch(Ae){Wt(l,l.return,Ae)}}else if((ue.tag!==22&&ue.tag!==23||ue.memoizedState===null||ue===l)&&ue.child!==null){ue.child.return=ue,ue=ue.child;continue}if(ue===l)break e;for(;ue.sibling===null;){if(ue.return===null||ue.return===l)break e;oe===ue&&(oe=null),ue=ue.return}oe===ue&&(oe=null),ue.sibling.return=ue.return,ue=ue.sibling}}break;case 19:Nr(c,l),vs(l),_&4&&o2(l);break;case 21:break;default:Nr(c,l),vs(l)}}function vs(l){var c=l.flags;if(c&2){try{e:{for(var f=l.return;f!==null;){if(i2(f)){var _=f;break e}f=f.return}throw Error(t(160))}switch(_.tag){case 5:var E=_.stateNode;_.flags&32&&(es(E,""),_.flags&=-33);var x=r2(l);wv(l,x,E);break;case 3:case 4:var C=_.stateNode.containerInfo,j=r2(l);Ev(l,j,C);break;default:throw Error(t(161))}}catch(z){Wt(l,l.return,z)}l.flags&=-3}c&4096&&(l.flags&=-4097)}function R3(l,c,f){xe=l,l2(l)}function l2(l,c,f){for(var _=(l.mode&1)!==0;xe!==null;){var E=xe,x=E.child;if(E.tag===22&&_){var C=E.memoizedState!==null||Gm;if(!C){var j=E.alternate,z=j!==null&&j.memoizedState!==null||Wn;j=Gm;var Z=Wn;if(Gm=C,(Wn=z)&&!Z)for(xe=E;xe!==null;)C=xe,z=C.child,C.tag===22&&C.memoizedState!==null?h2(E):z!==null?(z.return=C,xe=z):h2(E);for(;x!==null;)xe=x,l2(x),x=x.sibling;xe=E,Gm=j,Wn=Z}u2(l)}else(E.subtreeFlags&8772)!==0&&x!==null?(x.return=E,xe=x):u2(l)}}function u2(l){for(;xe!==null;){var c=xe;if((c.flags&8772)!==0){var f=c.alternate;try{if((c.flags&8772)!==0)switch(c.tag){case 0:case 11:case 15:Wn||jm(5,c);break;case 1:var _=c.stateNode;if(c.flags&4&&!Wn)if(f===null)_.componentDidMount();else{var E=c.elementType===c.type?f.memoizedProps:kr(c.type,f.memoizedProps);_.componentDidUpdate(E,f.memoizedState,_.__reactInternalSnapshotBeforeUpdate)}var x=c.updateQueue;x!==null&&cI(c,x,_);break;case 3:var C=c.updateQueue;if(C!==null){if(f=null,c.child!==null)switch(c.child.tag){case 5:f=c.child.stateNode;break;case 1:f=c.child.stateNode}cI(c,C,f)}break;case 5:var j=c.stateNode;if(f===null&&c.flags&4){f=j;var z=c.memoizedProps;switch(c.type){case"button":case"input":case"select":case"textarea":z.autoFocus&&f.focus();break;case"img":z.src&&(f.src=z.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(c.memoizedState===null){var Z=c.alternate;if(Z!==null){var oe=Z.memoizedState;if(oe!==null){var ue=oe.dehydrated;ue!==null&&Vo(ue)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Wn||c.flags&512&&vv(c)}catch(re){Wt(c,c.return,re)}}if(c===l){xe=null;break}if(f=c.sibling,f!==null){f.return=c.return,xe=f;break}xe=c.return}}function c2(l){for(;xe!==null;){var c=xe;if(c===l){xe=null;break}var f=c.sibling;if(f!==null){f.return=c.return,xe=f;break}xe=c.return}}function h2(l){for(;xe!==null;){var c=xe;try{switch(c.tag){case 0:case 11:case 15:var f=c.return;try{jm(4,c)}catch(z){Wt(c,f,z)}break;case 1:var _=c.stateNode;if(typeof _.componentDidMount=="function"){var E=c.return;try{_.componentDidMount()}catch(z){Wt(c,E,z)}}var x=c.return;try{vv(c)}catch(z){Wt(c,x,z)}break;case 5:var C=c.return;try{vv(c)}catch(z){Wt(c,C,z)}}}catch(z){Wt(c,c.return,z)}if(c===l){xe=null;break}var j=c.sibling;if(j!==null){j.return=c.return,xe=j;break}xe=c.return}}var P3=Math.ceil,Um=k.ReactCurrentDispatcher,xv=k.ReactCurrentOwner,dr=k.ReactCurrentBatchConfig,rt=0,wn=null,on=null,Nn=0,Bi=0,lc=Bo(0),dn=0,Td=null,_l=0,Bm=0,Sv=0,Id=null,vi=null,Tv=0,uc=1/0,io=null,zm=!1,Iv=null,qo=null,$m=!1,Xo=null,Wm=0,Ad=0,Av=null,Km=-1,Hm=0;function ai(){return(rt&6)!==0?Ct():Km!==-1?Km:Km=Ct()}function Yo(l){return(l.mode&1)===0?1:(rt&2)!==0&&Nn!==0?Nn&-Nn:h3.transition!==null?(Hm===0&&(Hm=Hh()),Hm):(l=tt,l!==0||(l=window.event,l=l===void 0?16:Fu(l.type)),l)}function Or(l,c,f,_){if(50<Ad)throw Ad=0,Av=null,Error(t(185));sl(l,f,_),((rt&2)===0||l!==wn)&&(l===wn&&((rt&2)===0&&(Bm|=f),dn===4&&Zo(l,Nn)),Ei(l,_),f===1&&rt===0&&(c.mode&1)===0&&(uc=Ct()+500,wm&&$o()))}function Ei(l,c){var f=l.callbackNode;rl(l,c);var _=$s(l,l===wn?Nn:0);if(_===0)f!==null&&bu(f),l.callbackNode=null,l.callbackPriority=0;else if(c=_&-_,l.callbackPriority!==c){if(f!=null&&bu(f),c===1)l.tag===0?c3(f2.bind(null,l)):QT(f2.bind(null,l)),o3(function(){(rt&6)===0&&$o()}),f=null;else{switch(os(_)){case 1:f=Lu;break;case 4:f=$h;break;case 16:f=el;break;case 536870912:f=ku;break;default:f=el}f=w2(f,d2.bind(null,l))}l.callbackPriority=c,l.callbackNode=f}}function d2(l,c){if(Km=-1,Hm=0,(rt&6)!==0)throw Error(t(327));var f=l.callbackNode;if(cc()&&l.callbackNode!==f)return null;var _=$s(l,l===wn?Nn:0);if(_===0)return null;if((_&30)!==0||(_&l.expiredLanes)!==0||c)c=qm(l,_);else{c=_;var E=rt;rt|=2;var x=m2();(wn!==l||Nn!==c)&&(io=null,uc=Ct()+500,vl(l,c));do try{b3();break}catch(j){g2(l,j)}while(!0);$y(),Um.current=x,rt=E,on!==null?c=0:(wn=null,Nn=0,c=dn)}if(c!==0){if(c===2&&(E=Kh(l),E!==0&&(_=E,c=Rv(l,E))),c===1)throw f=Td,vl(l,0),Zo(l,_),Ei(l,Ct()),f;if(c===6)Zo(l,_);else{if(E=l.current.alternate,(_&30)===0&&!C3(E)&&(c=qm(l,_),c===2&&(x=Kh(l),x!==0&&(_=x,c=Rv(l,x))),c===1))throw f=Td,vl(l,0),Zo(l,_),Ei(l,Ct()),f;switch(l.finishedWork=E,l.finishedLanes=_,c){case 0:case 1:throw Error(t(345));case 2:El(l,vi,io);break;case 3:if(Zo(l,_),(_&130023424)===_&&(c=Tv+500-Ct(),10<c)){if($s(l,0)!==0)break;if(E=l.suspendedLanes,(E&_)!==_){ai(),l.pingedLanes|=l.suspendedLanes&E;break}l.timeoutHandle=ky(El.bind(null,l,vi,io),c);break}El(l,vi,io);break;case 4:if(Zo(l,_),(_&4194240)===_)break;for(c=l.eventTimes,E=-1;0<_;){var C=31-Ni(_);x=1<<C,C=c[C],C>E&&(E=C),_&=~x}if(_=E,_=Ct()-_,_=(120>_?120:480>_?480:1080>_?1080:1920>_?1920:3e3>_?3e3:4320>_?4320:1960*P3(_/1960))-_,10<_){l.timeoutHandle=ky(El.bind(null,l,vi,io),_);break}El(l,vi,io);break;case 5:El(l,vi,io);break;default:throw Error(t(329))}}}return Ei(l,Ct()),l.callbackNode===f?d2.bind(null,l):null}function Rv(l,c){var f=Id;return l.current.memoizedState.isDehydrated&&(vl(l,c).flags|=256),l=qm(l,c),l!==2&&(c=vi,vi=f,c!==null&&Pv(c)),l}function Pv(l){vi===null?vi=l:vi.push.apply(vi,l)}function C3(l){for(var c=l;;){if(c.flags&16384){var f=c.updateQueue;if(f!==null&&(f=f.stores,f!==null))for(var _=0;_<f.length;_++){var E=f[_],x=E.getSnapshot;E=E.value;try{if(!br(x(),E))return!1}catch{return!1}}}if(f=c.child,c.subtreeFlags&16384&&f!==null)f.return=c,c=f;else{if(c===l)break;for(;c.sibling===null;){if(c.return===null||c.return===l)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function Zo(l,c){for(c&=~Sv,c&=~Bm,l.suspendedLanes|=c,l.pingedLanes&=~c,l=l.expirationTimes;0<c;){var f=31-Ni(c),_=1<<f;l[f]=-1,c&=~_}}function f2(l){if((rt&6)!==0)throw Error(t(327));cc();var c=$s(l,0);if((c&1)===0)return Ei(l,Ct()),null;var f=qm(l,c);if(l.tag!==0&&f===2){var _=Kh(l);_!==0&&(c=_,f=Rv(l,_))}if(f===1)throw f=Td,vl(l,0),Zo(l,c),Ei(l,Ct()),f;if(f===6)throw Error(t(345));return l.finishedWork=l.current.alternate,l.finishedLanes=c,El(l,vi,io),Ei(l,Ct()),null}function Cv(l,c){var f=rt;rt|=1;try{return l(c)}finally{rt=f,rt===0&&(uc=Ct()+500,wm&&$o())}}function yl(l){Xo!==null&&Xo.tag===0&&(rt&6)===0&&cc();var c=rt;rt|=1;var f=dr.transition,_=tt;try{if(dr.transition=null,tt=1,l)return l()}finally{tt=_,dr.transition=f,rt=c,(rt&6)===0&&$o()}}function Mv(){Bi=lc.current,bt(lc)}function vl(l,c){l.finishedWork=null,l.finishedLanes=0;var f=l.timeoutHandle;if(f!==-1&&(l.timeoutHandle=-1,s3(f)),on!==null)for(f=on.return;f!==null;){var _=f;switch(Gy(_),_.tag){case 1:_=_.type.childContextTypes,_!=null&&vm();break;case 3:sc(),bt(pi),bt(Bn),Qy();break;case 5:Yy(_);break;case 4:sc();break;case 13:bt(Gt);break;case 19:bt(Gt);break;case 10:Wy(_.type._context);break;case 22:case 23:Mv()}f=f.return}if(wn=l,on=l=Qo(l.current,null),Nn=Bi=c,dn=0,Td=null,Sv=Bm=_l=0,vi=Id=null,gl!==null){for(c=0;c<gl.length;c++)if(f=gl[c],_=f.interleaved,_!==null){f.interleaved=null;var E=_.next,x=f.pending;if(x!==null){var C=x.next;x.next=E,_.next=C}f.pending=_}gl=null}return l}function g2(l,c){do{var f=on;try{if($y(),bm.current=Nm,Lm){for(var _=jt.memoizedState;_!==null;){var E=_.queue;E!==null&&(E.pending=null),_=_.next}Lm=!1}if(pl=0,En=hn=jt=null,yd=!1,vd=0,xv.current=null,f===null||f.return===null){dn=1,Td=c,on=null;break}e:{var x=l,C=f.return,j=f,z=c;if(c=Nn,j.flags|=32768,z!==null&&typeof z=="object"&&typeof z.then=="function"){var Z=z,oe=j,ue=oe.tag;if((oe.mode&1)===0&&(ue===0||ue===11||ue===15)){var re=oe.alternate;re?(oe.updateQueue=re.updateQueue,oe.memoizedState=re.memoizedState,oe.lanes=re.lanes):(oe.updateQueue=null,oe.memoizedState=null)}var ve=GI(C);if(ve!==null){ve.flags&=-257,jI(ve,C,j,x,c),ve.mode&1&&FI(x,Z,c),c=ve,z=Z;var Se=c.updateQueue;if(Se===null){var Ae=new Set;Ae.add(z),c.updateQueue=Ae}else Se.add(z);break e}else{if((c&1)===0){FI(x,Z,c),bv();break e}z=Error(t(426))}}else if(Nt&&j.mode&1){var Jt=GI(C);if(Jt!==null){(Jt.flags&65536)===0&&(Jt.flags|=256),jI(Jt,C,j,x,c),By(oc(z,j));break e}}x=z=oc(z,j),dn!==4&&(dn=2),Id===null?Id=[x]:Id.push(x),x=C;do{switch(x.tag){case 3:x.flags|=65536,c&=-c,x.lanes|=c;var q=OI(x,z,c);uI(x,q);break e;case 1:j=z;var W=x.type,Y=x.stateNode;if((x.flags&128)===0&&(typeof W.getDerivedStateFromError=="function"||Y!==null&&typeof Y.componentDidCatch=="function"&&(qo===null||!qo.has(Y)))){x.flags|=65536,c&=-c,x.lanes|=c;var he=VI(x,j,c);uI(x,he);break e}}x=x.return}while(x!==null)}_2(f)}catch(Re){c=Re,on===f&&f!==null&&(on=f=f.return);continue}break}while(!0)}function m2(){var l=Um.current;return Um.current=Nm,l===null?Nm:l}function bv(){(dn===0||dn===3||dn===2)&&(dn=4),wn===null||(_l&268435455)===0&&(Bm&268435455)===0||Zo(wn,Nn)}function qm(l,c){var f=rt;rt|=2;var _=m2();(wn!==l||Nn!==c)&&(io=null,vl(l,c));do try{M3();break}catch(E){g2(l,E)}while(!0);if($y(),rt=f,Um.current=_,on!==null)throw Error(t(261));return wn=null,Nn=0,dn}function M3(){for(;on!==null;)p2(on)}function b3(){for(;on!==null&&!Ja();)p2(on)}function p2(l){var c=E2(l.alternate,l,Bi);l.memoizedProps=l.pendingProps,c===null?_2(l):on=c,xv.current=null}function _2(l){var c=l;do{var f=c.alternate;if(l=c.return,(c.flags&32768)===0){if(f=S3(f,c,Bi),f!==null){on=f;return}}else{if(f=T3(f,c),f!==null){f.flags&=32767,on=f;return}if(l!==null)l.flags|=32768,l.subtreeFlags=0,l.deletions=null;else{dn=6,on=null;return}}if(c=c.sibling,c!==null){on=c;return}on=c=l}while(c!==null);dn===0&&(dn=5)}function El(l,c,f){var _=tt,E=dr.transition;try{dr.transition=null,tt=1,L3(l,c,f,_)}finally{dr.transition=E,tt=_}return null}function L3(l,c,f,_){do cc();while(Xo!==null);if((rt&6)!==0)throw Error(t(327));f=l.finishedWork;var E=l.finishedLanes;if(f===null)return null;if(l.finishedWork=null,l.finishedLanes=0,f===l.current)throw Error(t(177));l.callbackNode=null,l.callbackPriority=0;var x=f.lanes|f.childLanes;if(_y(l,x),l===wn&&(on=wn=null,Nn=0),(f.subtreeFlags&2064)===0&&(f.flags&2064)===0||$m||($m=!0,w2(el,function(){return cc(),null})),x=(f.flags&15990)!==0,(f.subtreeFlags&15990)!==0||x){x=dr.transition,dr.transition=null;var C=tt;tt=1;var j=rt;rt|=4,xv.current=null,A3(l,f),a2(f,l),QO(by),Hs=!!My,by=My=null,l.current=f,R3(f),zs(),rt=j,tt=C,dr.transition=x}else l.current=f;if($m&&($m=!1,Xo=l,Wm=E),x=l.pendingLanes,x===0&&(qo=null),tm(f.stateNode),Ei(l,Ct()),c!==null)for(_=l.onRecoverableError,f=0;f<c.length;f++)E=c[f],_(E.value,{componentStack:E.stack,digest:E.digest});if(zm)throw zm=!1,l=Iv,Iv=null,l;return(Wm&1)!==0&&l.tag!==0&&cc(),x=l.pendingLanes,(x&1)!==0?l===Av?Ad++:(Ad=0,Av=l):Ad=0,$o(),null}function cc(){if(Xo!==null){var l=os(Wm),c=dr.transition,f=tt;try{if(dr.transition=null,tt=16>l?16:l,Xo===null)var _=!1;else{if(l=Xo,Xo=null,Wm=0,(rt&6)!==0)throw Error(t(331));var E=rt;for(rt|=4,xe=l.current;xe!==null;){var x=xe,C=x.child;if((xe.flags&16)!==0){var j=x.deletions;if(j!==null){for(var z=0;z<j.length;z++){var Z=j[z];for(xe=Z;xe!==null;){var oe=xe;switch(oe.tag){case 0:case 11:case 15:Sd(8,oe,x)}var ue=oe.child;if(ue!==null)ue.return=oe,xe=ue;else for(;xe!==null;){oe=xe;var re=oe.sibling,ve=oe.return;if(n2(oe),oe===Z){xe=null;break}if(re!==null){re.return=ve,xe=re;break}xe=ve}}}var Se=x.alternate;if(Se!==null){var Ae=Se.child;if(Ae!==null){Se.child=null;do{var Jt=Ae.sibling;Ae.sibling=null,Ae=Jt}while(Ae!==null)}}xe=x}}if((x.subtreeFlags&2064)!==0&&C!==null)C.return=x,xe=C;else e:for(;xe!==null;){if(x=xe,(x.flags&2048)!==0)switch(x.tag){case 0:case 11:case 15:Sd(9,x,x.return)}var q=x.sibling;if(q!==null){q.return=x.return,xe=q;break e}xe=x.return}}var W=l.current;for(xe=W;xe!==null;){C=xe;var Y=C.child;if((C.subtreeFlags&2064)!==0&&Y!==null)Y.return=C,xe=Y;else e:for(C=W;xe!==null;){if(j=xe,(j.flags&2048)!==0)try{switch(j.tag){case 0:case 11:case 15:jm(9,j)}}catch(Re){Wt(j,j.return,Re)}if(j===C){xe=null;break e}var he=j.sibling;if(he!==null){he.return=j.return,xe=he;break e}xe=j.return}}if(rt=E,$o(),Di&&typeof Di.onPostCommitFiberRoot=="function")try{Di.onPostCommitFiberRoot(tl,l)}catch{}_=!0}return _}finally{tt=f,dr.transition=c}}return!1}function y2(l,c,f){c=oc(f,c),c=OI(l,c,1),l=Ko(l,c,1),c=ai(),l!==null&&(sl(l,1,c),Ei(l,c))}function Wt(l,c,f){if(l.tag===3)y2(l,l,f);else for(;c!==null;){if(c.tag===3){y2(c,l,f);break}else if(c.tag===1){var _=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof _.componentDidCatch=="function"&&(qo===null||!qo.has(_))){l=oc(f,l),l=VI(c,l,1),c=Ko(c,l,1),l=ai(),c!==null&&(sl(c,1,l),Ei(c,l));break}}c=c.return}}function k3(l,c,f){var _=l.pingCache;_!==null&&_.delete(c),c=ai(),l.pingedLanes|=l.suspendedLanes&f,wn===l&&(Nn&f)===f&&(dn===4||dn===3&&(Nn&130023424)===Nn&&500>Ct()-Tv?vl(l,0):Sv|=f),Ei(l,c)}function v2(l,c){c===0&&((l.mode&1)===0?c=1:(c=Do,Do<<=1,(Do&130023424)===0&&(Do=4194304)));var f=ai();l=eo(l,c),l!==null&&(sl(l,c,f),Ei(l,f))}function D3(l){var c=l.memoizedState,f=0;c!==null&&(f=c.retryLane),v2(l,f)}function N3(l,c){var f=0;switch(l.tag){case 13:var _=l.stateNode,E=l.memoizedState;E!==null&&(f=E.retryLane);break;case 19:_=l.stateNode;break;default:throw Error(t(314))}_!==null&&_.delete(c),v2(l,f)}var E2;E2=function(l,c,f){if(l!==null)if(l.memoizedProps!==c.pendingProps||pi.current)yi=!0;else{if((l.lanes&f)===0&&(c.flags&128)===0)return yi=!1,x3(l,c,f);yi=(l.flags&131072)!==0}else yi=!1,Nt&&(c.flags&1048576)!==0&&JT(c,Sm,c.index);switch(c.lanes=0,c.tag){case 2:var _=c.type;Fm(l,c),l=c.pendingProps;var E=Qu(c,Bn.current);rc(c,f),E=tv(null,c,_,l,E,f);var x=nv();return c.flags|=1,typeof E=="object"&&E!==null&&typeof E.render=="function"&&E.$$typeof===void 0?(c.tag=1,c.memoizedState=null,c.updateQueue=null,_i(_)?(x=!0,Em(c)):x=!1,c.memoizedState=E.state!==null&&E.state!==void 0?E.state:null,qy(c),E.updater=Om,c.stateNode=E,E._reactInternals=c,lv(c,_,l,f),c=dv(null,c,_,!0,x,f)):(c.tag=0,Nt&&x&&Fy(c),oi(null,c,E,f),c=c.child),c;case 16:_=c.elementType;e:{switch(Fm(l,c),l=c.pendingProps,E=_._init,_=E(_._payload),c.type=_,E=c.tag=V3(_),l=kr(_,l),E){case 0:c=hv(null,c,_,l,f);break e;case 1:c=KI(null,c,_,l,f);break e;case 11:c=UI(null,c,_,l,f);break e;case 14:c=BI(null,c,_,kr(_.type,l),f);break e}throw Error(t(306,_,""))}return c;case 0:return _=c.type,E=c.pendingProps,E=c.elementType===_?E:kr(_,E),hv(l,c,_,E,f);case 1:return _=c.type,E=c.pendingProps,E=c.elementType===_?E:kr(_,E),KI(l,c,_,E,f);case 3:e:{if(HI(c),l===null)throw Error(t(387));_=c.pendingProps,x=c.memoizedState,E=x.element,lI(l,c),Cm(c,_,null,f);var C=c.memoizedState;if(_=C.element,x.isDehydrated)if(x={element:_,isDehydrated:!1,cache:C.cache,pendingSuspenseBoundaries:C.pendingSuspenseBoundaries,transitions:C.transitions},c.updateQueue.baseState=x,c.memoizedState=x,c.flags&256){E=oc(Error(t(423)),c),c=qI(l,c,_,f,E);break e}else if(_!==E){E=oc(Error(t(424)),c),c=qI(l,c,_,f,E);break e}else for(Ui=Uo(c.stateNode.containerInfo.firstChild),ji=c,Nt=!0,Lr=null,f=oI(c,null,_,f),c.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling;else{if(tc(),_===E){c=no(l,c,f);break e}oi(l,c,_,f)}c=c.child}return c;case 5:return hI(c),l===null&&Uy(c),_=c.type,E=c.pendingProps,x=l!==null?l.memoizedProps:null,C=E.children,Ly(_,E)?C=null:x!==null&&Ly(_,x)&&(c.flags|=32),WI(l,c),oi(l,c,C,f),c.child;case 6:return l===null&&Uy(c),null;case 13:return XI(l,c,f);case 4:return Xy(c,c.stateNode.containerInfo),_=c.pendingProps,l===null?c.child=nc(c,null,_,f):oi(l,c,_,f),c.child;case 11:return _=c.type,E=c.pendingProps,E=c.elementType===_?E:kr(_,E),UI(l,c,_,E,f);case 7:return oi(l,c,c.pendingProps,f),c.child;case 8:return oi(l,c,c.pendingProps.children,f),c.child;case 12:return oi(l,c,c.pendingProps.children,f),c.child;case 10:e:{if(_=c.type._context,E=c.pendingProps,x=c.memoizedProps,C=E.value,Pt(Am,_._currentValue),_._currentValue=C,x!==null)if(br(x.value,C)){if(x.children===E.children&&!pi.current){c=no(l,c,f);break e}}else for(x=c.child,x!==null&&(x.return=c);x!==null;){var j=x.dependencies;if(j!==null){C=x.child;for(var z=j.firstContext;z!==null;){if(z.context===_){if(x.tag===1){z=to(-1,f&-f),z.tag=2;var Z=x.updateQueue;if(Z!==null){Z=Z.shared;var oe=Z.pending;oe===null?z.next=z:(z.next=oe.next,oe.next=z),Z.pending=z}}x.lanes|=f,z=x.alternate,z!==null&&(z.lanes|=f),Ky(x.return,f,c),j.lanes|=f;break}z=z.next}}else if(x.tag===10)C=x.type===c.type?null:x.child;else if(x.tag===18){if(C=x.return,C===null)throw Error(t(341));C.lanes|=f,j=C.alternate,j!==null&&(j.lanes|=f),Ky(C,f,c),C=x.sibling}else C=x.child;if(C!==null)C.return=x;else for(C=x;C!==null;){if(C===c){C=null;break}if(x=C.sibling,x!==null){x.return=C.return,C=x;break}C=C.return}x=C}oi(l,c,E.children,f),c=c.child}return c;case 9:return E=c.type,_=c.pendingProps.children,rc(c,f),E=cr(E),_=_(E),c.flags|=1,oi(l,c,_,f),c.child;case 14:return _=c.type,E=kr(_,c.pendingProps),E=kr(_.type,E),BI(l,c,_,E,f);case 15:return zI(l,c,c.type,c.pendingProps,f);case 17:return _=c.type,E=c.pendingProps,E=c.elementType===_?E:kr(_,E),Fm(l,c),c.tag=1,_i(_)?(l=!0,Em(c)):l=!1,rc(c,f),DI(c,_,E),lv(c,_,E,f),dv(null,c,_,!0,l,f);case 19:return ZI(l,c,f);case 22:return $I(l,c,f)}throw Error(t(156,c.tag))};function w2(l,c){return zh(l,c)}function O3(l,c,f,_){this.tag=l,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=_,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function fr(l,c,f,_){return new O3(l,c,f,_)}function Lv(l){return l=l.prototype,!(!l||!l.isReactComponent)}function V3(l){if(typeof l=="function")return Lv(l)?1:0;if(l!=null){if(l=l.$$typeof,l===U)return 11;if(l===we)return 14}return 2}function Qo(l,c){var f=l.alternate;return f===null?(f=fr(l.tag,c,l.key,l.mode),f.elementType=l.elementType,f.type=l.type,f.stateNode=l.stateNode,f.alternate=l,l.alternate=f):(f.pendingProps=c,f.type=l.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=l.flags&14680064,f.childLanes=l.childLanes,f.lanes=l.lanes,f.child=l.child,f.memoizedProps=l.memoizedProps,f.memoizedState=l.memoizedState,f.updateQueue=l.updateQueue,c=l.dependencies,f.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},f.sibling=l.sibling,f.index=l.index,f.ref=l.ref,f}function Xm(l,c,f,_,E,x){var C=2;if(_=l,typeof l=="function")Lv(l)&&(C=1);else if(typeof l=="string")C=5;else e:switch(l){case b:return wl(f.children,E,x,c);case R:C=8,E|=8;break;case L:return l=fr(12,f,c,E|2),l.elementType=L,l.lanes=x,l;case D:return l=fr(13,f,c,E),l.elementType=D,l.lanes=x,l;case le:return l=fr(19,f,c,E),l.elementType=le,l.lanes=x,l;case de:return Ym(f,E,x,c);default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case V:C=10;break e;case F:C=9;break e;case U:C=11;break e;case we:C=14;break e;case ye:C=16,_=null;break e}throw Error(t(130,l==null?l:typeof l,""))}return c=fr(C,f,c,E),c.elementType=l,c.type=_,c.lanes=x,c}function wl(l,c,f,_){return l=fr(7,l,_,c),l.lanes=f,l}function Ym(l,c,f,_){return l=fr(22,l,_,c),l.elementType=de,l.lanes=f,l.stateNode={isHidden:!1},l}function kv(l,c,f){return l=fr(6,l,null,c),l.lanes=f,l}function Dv(l,c,f){return c=fr(4,l.children!==null?l.children:[],l.key,c),c.lanes=f,c.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},c}function F3(l,c,f,_,E){this.tag=c,this.containerInfo=l,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=qh(0),this.expirationTimes=qh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=qh(0),this.identifierPrefix=_,this.onRecoverableError=E,this.mutableSourceEagerHydrationData=null}function Nv(l,c,f,_,E,x,C,j,z){return l=new F3(l,c,f,j,z),c===1?(c=1,x===!0&&(c|=8)):c=0,x=fr(3,null,null,c),l.current=x,x.stateNode=l,x.memoizedState={element:_,isDehydrated:f,cache:null,transitions:null,pendingSuspenseBoundaries:null},qy(x),l}function G3(l,c,f){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:B,key:_==null?null:""+_,children:l,containerInfo:c,implementation:f}}function x2(l){if(!l)return zo;l=l._reactInternals;e:{if(Cr(l)!==l||l.tag!==1)throw Error(t(170));var c=l;do{switch(c.tag){case 3:c=c.stateNode.context;break e;case 1:if(_i(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break e}}c=c.return}while(c!==null);throw Error(t(171))}if(l.tag===1){var f=l.type;if(_i(f))return YT(l,f,c)}return c}function S2(l,c,f,_,E,x,C,j,z){return l=Nv(f,_,!0,l,E,x,C,j,z),l.context=x2(null),f=l.current,_=ai(),E=Yo(f),x=to(_,E),x.callback=c??null,Ko(f,x,E),l.current.lanes=E,sl(l,E,_),Ei(l,_),l}function Zm(l,c,f,_){var E=c.current,x=ai(),C=Yo(E);return f=x2(f),c.context===null?c.context=f:c.pendingContext=f,c=to(x,C),c.payload={element:l},_=_===void 0?null:_,_!==null&&(c.callback=_),l=Ko(E,c,C),l!==null&&(Or(l,E,C,x),Pm(l,E,C)),C}function Qm(l){if(l=l.current,!l.child)return null;switch(l.child.tag){case 5:return l.child.stateNode;default:return l.child.stateNode}}function T2(l,c){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var f=l.retryLane;l.retryLane=f!==0&&f<c?f:c}}function Ov(l,c){T2(l,c),(l=l.alternate)&&T2(l,c)}function j3(){return null}var I2=typeof reportError=="function"?reportError:function(l){console.error(l)};function Vv(l){this._internalRoot=l}Jm.prototype.render=Vv.prototype.render=function(l){var c=this._internalRoot;if(c===null)throw Error(t(409));Zm(l,c,null,null)},Jm.prototype.unmount=Vv.prototype.unmount=function(){var l=this._internalRoot;if(l!==null){this._internalRoot=null;var c=l.containerInfo;yl(function(){Zm(null,l,null,null)}),c[Ys]=null}};function Jm(l){this._internalRoot=l}Jm.prototype.unstable_scheduleHydration=function(l){if(l){var c=Qh();l={blockedOn:null,target:l,priority:c};for(var f=0;f<Oi.length&&c!==0&&c<Oi[f].priority;f++);Oi.splice(f,0,l),f===0&&Ou(l)}};function Fv(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11)}function ep(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11&&(l.nodeType!==8||l.nodeValue!==" react-mount-point-unstable "))}function A2(){}function U3(l,c,f,_,E){if(E){if(typeof _=="function"){var x=_;_=function(){var Z=Qm(C);x.call(Z)}}var C=S2(c,_,l,0,null,!1,!1,"",A2);return l._reactRootContainer=C,l[Ys]=C.current,cd(l.nodeType===8?l.parentNode:l),yl(),C}for(;E=l.lastChild;)l.removeChild(E);if(typeof _=="function"){var j=_;_=function(){var Z=Qm(z);j.call(Z)}}var z=Nv(l,0,!1,null,null,!1,!1,"",A2);return l._reactRootContainer=z,l[Ys]=z.current,cd(l.nodeType===8?l.parentNode:l),yl(function(){Zm(c,z,f,_)}),z}function tp(l,c,f,_,E){var x=f._reactRootContainer;if(x){var C=x;if(typeof E=="function"){var j=E;E=function(){var z=Qm(C);j.call(z)}}Zm(c,C,l,E)}else C=U3(f,c,l,E,_);return Qm(C)}Yh=function(l){switch(l.tag){case 3:var c=l.stateNode;if(c.current.memoizedState.isDehydrated){var f=ht(c.pendingLanes);f!==0&&(Xh(c,f|1),Ei(c,Ct()),(rt&6)===0&&(uc=Ct()+500,$o()))}break;case 13:yl(function(){var _=eo(l,1);if(_!==null){var E=ai();Or(_,l,1,E)}}),Ov(l,1)}},Du=function(l){if(l.tag===13){var c=eo(l,134217728);if(c!==null){var f=ai();Or(c,l,134217728,f)}Ov(l,134217728)}},Zh=function(l){if(l.tag===13){var c=Yo(l),f=eo(l,c);if(f!==null){var _=ai();Or(f,l,c,_)}Ov(l,c)}},Qh=function(){return tt},Jh=function(l,c){var f=tt;try{return tt=l,c()}finally{tt=f}},ri=function(l,c,f){switch(c){case"input":if(mi(l,f),c=f.name,f.type==="radio"&&c!=null){for(f=l;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll("input[name="+JSON.stringify(""+c)+'][type="radio"]'),c=0;c<f.length;c++){var _=f[c];if(_!==l&&_.form===l.form){var E=ym(_);if(!E)throw Error(t(90));js(_),mi(_,E)}}}break;case"textarea":bo(l,f);break;case"select":c=f.value,c!=null&&yn(l,!!f.multiple,c,!1)}},rr=Cv,Cn=yl;var B3={usingClientEntryPoint:!1,Events:[fd,Yu,ym,Pr,Yt,Cv]},Rd={findFiberByHostInstance:cl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},z3={bundleType:Rd.bundleType,version:Rd.version,rendererPackageName:Rd.rendererPackageName,rendererConfig:Rd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:k.ReactCurrentDispatcher,findHostInstanceByFiber:function(l){return l=em(l),l===null?null:l.stateNode},findFiberByHostInstance:Rd.findFiberByHostInstance||j3,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var np=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!np.isDisabled&&np.supportsFiber)try{tl=np.inject(z3),Di=np}catch{}}return wi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=B3,wi.createPortal=function(l,c){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Fv(c))throw Error(t(200));return G3(l,c,null,f)},wi.createRoot=function(l,c){if(!Fv(l))throw Error(t(299));var f=!1,_="",E=I2;return c!=null&&(c.unstable_strictMode===!0&&(f=!0),c.identifierPrefix!==void 0&&(_=c.identifierPrefix),c.onRecoverableError!==void 0&&(E=c.onRecoverableError)),c=Nv(l,1,!1,null,null,f,!1,_,E),l[Ys]=c.current,cd(l.nodeType===8?l.parentNode:l),new Vv(c)},wi.findDOMNode=function(l){if(l==null)return null;if(l.nodeType===1)return l;var c=l._reactInternals;if(c===void 0)throw typeof l.render=="function"?Error(t(188)):(l=Object.keys(l).join(","),Error(t(268,l)));return l=em(c),l=l===null?null:l.stateNode,l},wi.flushSync=function(l){return yl(l)},wi.hydrate=function(l,c,f){if(!ep(c))throw Error(t(200));return tp(null,l,c,!0,f)},wi.hydrateRoot=function(l,c,f){if(!Fv(l))throw Error(t(405));var _=f!=null&&f.hydratedSources||null,E=!1,x="",C=I2;if(f!=null&&(f.unstable_strictMode===!0&&(E=!0),f.identifierPrefix!==void 0&&(x=f.identifierPrefix),f.onRecoverableError!==void 0&&(C=f.onRecoverableError)),c=S2(c,null,l,1,f??null,E,!1,x,C),l[Ys]=c.current,cd(l),_)for(l=0;l<_.length;l++)f=_[l],E=f._getVersion,E=E(f._source),c.mutableSourceEagerHydrationData==null?c.mutableSourceEagerHydrationData=[f,E]:c.mutableSourceEagerHydrationData.push(f,E);return new Jm(c)},wi.render=function(l,c,f){if(!ep(c))throw Error(t(200));return tp(null,l,c,!1,f)},wi.unmountComponentAtNode=function(l){if(!ep(l))throw Error(t(40));return l._reactRootContainer?(yl(function(){tp(null,null,l,!1,function(){l._reactRootContainer=null,l[Ys]=null})}),!0):!1},wi.unstable_batchedUpdates=Cv,wi.unstable_renderSubtreeIntoContainer=function(l,c,f,_){if(!ep(f))throw Error(t(200));if(l==null||l._reactInternals===void 0)throw Error(t(38));return tp(l,c,f,!1,_)},wi.version="18.3.1-next-f1338f8080-20240426",wi}var D2;function Z3(){if(D2)return Uv.exports;D2=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Uv.exports=Y3(),Uv.exports}var N2;function Q3(){if(N2)return ip;N2=1;var n=Z3();return ip.createRoot=n.createRoot,ip.hydrateRoot=n.hydrateRoot,ip}var J3=Q3();const e5=Dw(J3);var ne=fg();const t5=Dw(ne),Si={ADD:"add",REMOVE:"remove"},sh={PROPERTYCHANGE:"propertychange"},qe={CHANGE:"change",ERROR:"error",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",TOUCHMOVE:"touchmove",WHEEL:"wheel"};class f0{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function n5(n,e,t){let i,r;t=t||fo;let s=0,o=n.length,a=!1;for(;s<o;)i=s+(o-s>>1),r=+t(n[i],e),r<0?s=i+1:(o=i,a=!r);return a?s:~s}function fo(n,e){return n>e?1:n<e?-1:0}function i5(n,e){return n<e?1:n>e?-1:0}function Nw(n,e,t){if(n[0]<=e)return 0;const i=n.length;if(e<=n[i-1])return i-1;if(typeof t=="function"){for(let r=1;r<i;++r){const s=n[r];if(s===e)return r;if(s<e)return t(e,n[r-1],s)>0?r-1:r}return i-1}if(t>0){for(let r=1;r<i;++r)if(n[r]<e)return r-1;return i-1}if(t<0){for(let r=1;r<i;++r)if(n[r]<=e)return r;return i-1}for(let r=1;r<i;++r){if(n[r]==e)return r;if(n[r]<e)return n[r-1]-e<e-n[r]?r-1:r}return i-1}function r5(n,e,t){for(;e<t;){const i=n[e];n[e]=n[t],n[t]=i,++e,--t}}function g0(n,e){const t=Array.isArray(e)?e:[e],i=t.length;for(let r=0;r<i;r++)n[n.length]=t[r]}function Wa(n,e){const t=n.length;if(t!==e.length)return!1;for(let i=0;i<t;i++)if(n[i]!==e[i])return!1;return!0}function s5(n,e,t){const i=e||fo;return n.every(function(r,s){if(s===0)return!0;const o=i(n[s-1],r);return!(o>0||o===0)})}function Cf(){return!0}function m0(){return!1}function Mf(){}function BM(n){let e,t,i;return function(){const r=Array.prototype.slice.call(arguments);return(!t||this!==i||!Wa(r,t))&&(i=this,t=r,e=n.apply(this,arguments)),e}}function zM(n){function e(){let t;try{t=n()}catch(i){return Promise.reject(i)}return t instanceof Promise?t:Promise.resolve(t)}return e()}function gg(n){for(const e in n)delete n[e]}function oh(n){let e;for(e in n)return!1;return!e}class Ao{constructor(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}class mg extends f0{constructor(e){super(),this.eventTarget_=e,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(e,t){if(!e||!t)return;const i=this.listeners_||(this.listeners_={}),r=i[e]||(i[e]=[]);r.includes(t)||r.push(t)}dispatchEvent(e){const t=typeof e=="string",i=t?e:e.type,r=this.listeners_&&this.listeners_[i];if(!r)return;const s=t?new Ao(e):e;s.target||(s.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),a=this.pendingRemovals_||(this.pendingRemovals_={});i in o||(o[i]=0,a[i]=0),++o[i];let u;for(let h=0,d=r.length;h<d;++h)if("handleEvent"in r[h]?u=r[h].handleEvent(s):u=r[h].call(this,s),u===!1||s.propagationStopped){u=!1;break}if(--o[i]===0){let h=a[i];for(delete a[i];h--;)this.removeEventListener(i,Mf);delete o[i]}return u}disposeInternal(){this.listeners_&&gg(this.listeners_)}getListeners(e){return this.listeners_&&this.listeners_[e]||void 0}hasListener(e){return this.listeners_?e?e in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(e,t){if(!this.listeners_)return;const i=this.listeners_[e];if(!i)return;const r=i.indexOf(t);r!==-1&&(this.pendingRemovals_&&e in this.pendingRemovals_?(i[r]=Mf,++this.pendingRemovals_[e]):(i.splice(r,1),i.length===0&&delete this.listeners_[e]))}}function lt(n,e,t,i,r){if(r){const o=t;t=function(a){return n.removeEventListener(e,t),o.call(i??this,a)}}else i&&i!==n&&(t=t.bind(i));const s={target:n,type:e,listener:t};return n.addEventListener(e,t),s}function s_(n,e,t,i){return lt(n,e,t,i,!0)}function Vt(n){n&&n.target&&(n.target.removeEventListener(n.type,n.listener),gg(n))}class pg extends mg{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(qe.CHANGE)}getRevision(){return this.revision_}onInternal(e,t){if(Array.isArray(e)){const i=e.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=lt(this,e[s],t);return r}return lt(this,e,t)}onceInternal(e,t){let i;if(Array.isArray(e)){const r=e.length;i=new Array(r);for(let s=0;s<r;++s)i[s]=s_(this,e[s],t)}else i=s_(this,e,t);return t.ol_key=i,i}unInternal(e,t){const i=t.ol_key;if(i)o5(i);else if(Array.isArray(e))for(let r=0,s=e.length;r<s;++r)this.removeEventListener(e[r],t);else this.removeEventListener(e,t)}}pg.prototype.on;pg.prototype.once;pg.prototype.un;function o5(n){if(Array.isArray(n))for(let e=0,t=n.length;e<t;++e)Vt(n[e]);else Vt(n)}function at(){throw new Error("Unimplemented abstract method.")}let a5=0;function ut(n){return n.ol_uid||(n.ol_uid=String(++a5))}class O2 extends Ao{constructor(e,t,i){super(e),this.key=t,this.oldValue=i}}class Vs extends pg{constructor(e){super(),this.on,this.once,this.un,ut(this),this.values_=null,e!==void 0&&this.setProperties(e)}get(e){let t;return this.values_&&this.values_.hasOwnProperty(e)&&(t=this.values_[e]),t}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(e,t){let i;i=`change:${e}`,this.hasListener(i)&&this.dispatchEvent(new O2(i,e,t)),i=sh.PROPERTYCHANGE,this.hasListener(i)&&this.dispatchEvent(new O2(i,e,t))}addChangeListener(e,t){this.addEventListener(`change:${e}`,t)}removeChangeListener(e,t){this.removeEventListener(`change:${e}`,t)}set(e,t,i){const r=this.values_||(this.values_={});if(i)r[e]=t;else{const s=r[e];r[e]=t,s!==t&&this.notify(e,s)}}setProperties(e,t){for(const i in e)this.set(i,e[i],t)}applyProperties(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}unset(e,t){if(this.values_&&e in this.values_){const i=this.values_[e];delete this.values_[e],oh(this.values_)&&(this.values_=null),t||this.notify(e,i)}}}const V2={LENGTH:"length"};class rp extends Ao{constructor(e,t,i){super(e),this.element=t,this.index=i}}class vr extends Vs{constructor(e,t){if(super(),this.on,this.once,this.un,t=t||{},this.unique_=!!t.unique,this.array_=e??[],this.unique_)for(let i=1,r=this.array_.length;i<r;++i)this.assertUnique_(this.array_[i],i);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(e){for(let t=0,i=e.length;t<i;++t)this.push(e[t]);return this}forEach(e){const t=this.array_;for(let i=0,r=t.length;i<r;++i)e(t[i],i,t)}getArray(){return this.array_}item(e){return this.array_[e]}getLength(){return this.get(V2.LENGTH)}insertAt(e,t){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t),this.array_.splice(e,0,t),this.updateLength_(),this.dispatchEvent(new rp(Si.ADD,t,e))}pop(){return this.removeAt(this.getLength()-1)}push(e){const t=this.getLength();return this.insertAt(t,e),this.getLength()}remove(e){const t=this.array_;for(let i=0,r=t.length;i<r;++i)if(t[i]===e)return this.removeAt(i)}removeAt(e){if(e<0||e>=this.getLength())return;const t=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new rp(Si.REMOVE,t,e)),t}setAt(e,t){const i=this.getLength();if(e>=i){this.insertAt(e,t);return}if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t,e);const r=this.array_[e];this.array_[e]=t,this.dispatchEvent(new rp(Si.REMOVE,r,e)),this.dispatchEvent(new rp(Si.ADD,t,e))}updateLength_(){this.set(V2.LENGTH,this.array_.length)}assertUnique_(e,t){const i=this.array_;for(let r=0,s=i.length;r<s;++r)if(i[r]===e&&r!==t)throw new Error("Duplicate item added to a unique collection")}}function pt(n,e){if(!n)throw new Error(e)}let af=class $M extends Vs{constructor(e){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),e)if(typeof e.getSimplifiedGeometry=="function"){const t=e;this.setGeometry(t)}else{const t=e;this.setProperties(t)}}clone(){const e=new $M(this.hasProperties()?this.getProperties():null);e.setGeometryName(this.getGeometryName());const t=this.getGeometry();t&&e.setGeometry(t.clone());const i=this.getStyle();return i&&e.setStyle(i),e}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(Vt(this.geometryChangeKey_),this.geometryChangeKey_=null);const e=this.getGeometry();e&&(this.geometryChangeKey_=lt(e,qe.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(e){this.set(this.geometryName_,e)}setStyle(e){this.style_=e,this.styleFunction_=e?l5(e):void 0,this.changed()}setId(e){this.id_=e,this.changed()}setGeometryName(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}};function l5(n){if(typeof n=="function")return n;let e;return Array.isArray(n)?e=n:(pt(typeof n.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[n]),function(){return e}}const Sn={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function F2(n){const e=Xi();for(let t=0,i=n.length;t<i;++t)lf(e,n[t]);return e}function bf(n,e,t){return t?(t[0]=n[0]-e,t[1]=n[1]-e,t[2]=n[2]+e,t[3]=n[3]+e,t):[n[0]-e,n[1]-e,n[2]+e,n[3]+e]}function WM(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n.slice()}function Ow(n,e,t){let i,r;return e<n[0]?i=n[0]-e:n[2]<e?i=e-n[2]:i=0,t<n[1]?r=n[1]-t:n[3]<t?r=t-n[3]:r=0,i*i+r*r}function ah(n,e){return KM(n,e[0],e[1])}function Ud(n,e){return n[0]<=e[0]&&e[2]<=n[2]&&n[1]<=e[1]&&e[3]<=n[3]}function KM(n,e,t){return n[0]<=e&&e<=n[2]&&n[1]<=t&&t<=n[3]}function Q1(n,e){const t=n[0],i=n[1],r=n[2],s=n[3],o=e[0],a=e[1];let u=Sn.UNKNOWN;return o<t?u=u|Sn.LEFT:o>r&&(u=u|Sn.RIGHT),a<i?u=u|Sn.BELOW:a>s&&(u=u|Sn.ABOVE),u===Sn.UNKNOWN&&(u=Sn.INTERSECTING),u}function Xi(){return[1/0,1/0,-1/0,-1/0]}function Da(n,e,t,i,r){return r?(r[0]=n,r[1]=e,r[2]=t,r[3]=i,r):[n,e,t,i]}function p0(n){return Da(1/0,1/0,-1/0,-1/0,n)}function HM(n,e){const t=n[0],i=n[1];return Da(t,i,t,i,e)}function Vw(n,e,t,i,r){const s=p0(r);return qM(s,n,e,t,i)}function Lf(n,e){return n[0]==e[0]&&n[2]==e[2]&&n[1]==e[1]&&n[3]==e[3]}function u5(n,e){return e[0]<n[0]&&(n[0]=e[0]),e[2]>n[2]&&(n[2]=e[2]),e[1]<n[1]&&(n[1]=e[1]),e[3]>n[3]&&(n[3]=e[3]),n}function lf(n,e){e[0]<n[0]&&(n[0]=e[0]),e[0]>n[2]&&(n[2]=e[0]),e[1]<n[1]&&(n[1]=e[1]),e[1]>n[3]&&(n[3]=e[1])}function qM(n,e,t,i,r){for(;t<i;t+=r)c5(n,e[t],e[t+1]);return n}function c5(n,e,t){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}function XM(n,e){let t;return t=e(_0(n)),t||(t=e(y0(n)),t)||(t=e(v0(n)),t)||(t=e(Ka(n)),t)?t:!1}function J1(n){let e=0;return E0(n)||(e=st(n)*Jn(n)),e}function _0(n){return[n[0],n[1]]}function y0(n){return[n[2],n[1]]}function Jl(n){return[(n[0]+n[2])/2,(n[1]+n[3])/2]}function h5(n,e){let t;if(e==="bottom-left")t=_0(n);else if(e==="bottom-right")t=y0(n);else if(e==="top-left")t=Ka(n);else if(e==="top-right")t=v0(n);else throw new Error("Invalid corner");return t}function eE(n,e,t,i,r){const[s,o,a,u,h,d,g,m]=YM(n,e,t,i);return Da(Math.min(s,a,h,g),Math.min(o,u,d,m),Math.max(s,a,h,g),Math.max(o,u,d,m),r)}function YM(n,e,t,i){const r=e*i[0]/2,s=e*i[1]/2,o=Math.cos(t),a=Math.sin(t),u=r*o,h=r*a,d=s*o,g=s*a,m=n[0],v=n[1];return[m-u+g,v-h-d,m-u-g,v-h+d,m+u-g,v+h+d,m+u+g,v+h-d,m-u+g,v-h-d]}function Jn(n){return n[3]-n[1]}function Hl(n,e,t){const i=t||Xi();return Ai(n,e)?(n[0]>e[0]?i[0]=n[0]:i[0]=e[0],n[1]>e[1]?i[1]=n[1]:i[1]=e[1],n[2]<e[2]?i[2]=n[2]:i[2]=e[2],n[3]<e[3]?i[3]=n[3]:i[3]=e[3]):p0(i),i}function Ka(n){return[n[0],n[3]]}function v0(n){return[n[2],n[3]]}function st(n){return n[2]-n[0]}function Ai(n,e){return n[0]<=e[2]&&n[2]>=e[0]&&n[1]<=e[3]&&n[3]>=e[1]}function E0(n){return n[2]<n[0]||n[3]<n[1]}function d5(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n}function f5(n,e,t){let i=!1;const r=Q1(n,e),s=Q1(n,t);if(r===Sn.INTERSECTING||s===Sn.INTERSECTING)i=!0;else{const o=n[0],a=n[1],u=n[2],h=n[3],d=e[0],g=e[1],m=t[0],v=t[1],y=(v-g)/(m-d);let T,w;s&Sn.ABOVE&&!(r&Sn.ABOVE)&&(T=m-(v-h)/y,i=T>=o&&T<=u),!i&&s&Sn.RIGHT&&!(r&Sn.RIGHT)&&(w=v-(m-u)*y,i=w>=a&&w<=h),!i&&s&Sn.BELOW&&!(r&Sn.BELOW)&&(T=m-(v-a)/y,i=T>=o&&T<=u),!i&&s&Sn.LEFT&&!(r&Sn.LEFT)&&(w=v-(m-o)*y,i=w>=a&&w<=h)}return i}function ZM(n,e){const t=e.getExtent(),i=Jl(n);if(e.canWrapX()&&(i[0]<t[0]||i[0]>=t[2])){const r=st(t),o=Math.floor((i[0]-t[0])/r)*r;n[0]-=o,n[2]-=o}return n}function QM(n,e,t){if(e.canWrapX()){const i=e.getExtent();if(!isFinite(n[0])||!isFinite(n[2]))return[[i[0],n[1],i[2],n[3]]];ZM(n,e);const r=st(i);if(st(n)>r&&!t)return[[i[0],n[1],i[2],n[3]]];if(n[0]<i[0])return[[n[0]+r,n[1],i[2],n[3]],[i[0],n[1],n[2],n[3]]];if(n[2]>i[2])return[[n[0],n[1],i[2],n[3]],[i[0],n[1],n[2]-r,n[3]]]}return[n]}function Lt(n,e,t){return Math.min(Math.max(n,e),t)}function g5(n,e,t,i,r,s){const o=r-t,a=s-i;if(o!==0||a!==0){const u=((n-t)*o+(e-i)*a)/(o*o+a*a);u>1?(t=r,i=s):u>0&&(t+=o*u,i+=a*u)}return Hc(n,e,t,i)}function Hc(n,e,t,i){const r=t-n,s=i-e;return r*r+s*s}function m5(n){const e=n.length;for(let i=0;i<e;i++){let r=i,s=Math.abs(n[i][i]);for(let a=i+1;a<e;a++){const u=Math.abs(n[a][i]);u>s&&(s=u,r=a)}if(s===0)return null;const o=n[r];n[r]=n[i],n[i]=o;for(let a=i+1;a<e;a++){const u=-n[a][i]/n[i][i];for(let h=i;h<e+1;h++)i==h?n[a][h]=0:n[a][h]+=u*n[i][h]}}const t=new Array(e);for(let i=e-1;i>=0;i--){t[i]=n[i][e]/n[i][i];for(let r=i-1;r>=0;r--)n[r][e]-=n[r][i]*t[i]}return t}function G2(n){return n*180/Math.PI}function Ta(n){return n*Math.PI/180}function Ia(n,e){const t=n%e;return t*e<0?t+e:t}function $i(n,e,t){return n+t*(e-n)}function _g(n,e){const t=Math.pow(10,e);return Math.round(n*t)/t}function j2(n,e){return Math.round(_g(n,e))}function sp(n,e){return Math.floor(_g(n,e))}function op(n,e){return Math.ceil(_g(n,e))}function tE(n,e,t){if(n>=e&&n<t)return n;const i=t-e;return((n-e)%i+i)%i+e}function JM(n,e){const t=(""+n).split("."),i=(""+e).split(".");for(let r=0;r<Math.max(t.length,i.length);r++){const s=parseInt(t[r]||"0",10),o=parseInt(i[r]||"0",10);if(s>o)return 1;if(o>s)return-1}return 0}function p5(n,e){return n[0]+=+e[0],n[1]+=+e[1],n}function o_(n,e){let t=!0;for(let i=n.length-1;i>=0;--i)if(n[i]!=e[i]){t=!1;break}return t}function Fw(n,e){const t=Math.cos(e),i=Math.sin(e),r=n[0]*t-n[1]*i,s=n[1]*t+n[0]*i;return n[0]=r,n[1]=s,n}function _5(n,e){return n[0]*=e,n[1]*=e,n}function eb(n,e){if(e.canWrapX()){const t=st(e.getExtent()),i=tb(n,e,t);i&&(n[0]-=i*t)}return n}function tb(n,e,t){const i=e.getExtent();let r=0;return e.canWrapX()&&(n[0]<i[0]||n[0]>i[2])&&(t=t||st(i),r=Math.floor((n[0]-i[0])/t)),r}function nb(...n){console.warn(...n)}const Gw={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};let jw=class{constructor(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||Gw[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(e){this.defaultTileGrid_=e}setExtent(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)}setWorldExtent(e){this.worldExtent_=e}setGetPointResolution(e){this.getPointResolutionFunc_=e}getPointResolutionFunc(){return this.getPointResolutionFunc_}};const yg=6378137,Dc=Math.PI*yg,y5=[-Dc,-Dc,Dc,Dc],v5=[-180,-85,180,85],ap=yg*Math.log(Math.tan(Math.PI/2));class hc extends jw{constructor(e){super({code:e,units:"m",extent:y5,global:!0,worldExtent:v5,getPointResolution:function(t,i){return t/Math.cosh(i[1]/yg)}})}}const U2=[new hc("EPSG:3857"),new hc("EPSG:102100"),new hc("EPSG:102113"),new hc("EPSG:900913"),new hc("http://www.opengis.net/def/crs/EPSG/0/3857"),new hc("http://www.opengis.net/gml/srs/epsg.xml#3857")];function E5(n,e,t,i){const r=n.length;t=t>1?t:2,i=i??t,e===void 0&&(t>2?e=n.slice():e=new Array(r));for(let s=0;s<r;s+=i){e[s]=Dc*n[s]/180;let o=yg*Math.log(Math.tan(Math.PI*(+n[s+1]+90)/360));o>ap?o=ap:o<-ap&&(o=-ap),e[s+1]=o}return e}function w5(n,e,t,i){const r=n.length;t=t>1?t:2,i=i??t,e===void 0&&(t>2?e=n.slice():e=new Array(r));for(let s=0;s<r;s+=i)e[s]=180*n[s]/Dc,e[s+1]=360*Math.atan(Math.exp(n[s+1]/yg))/Math.PI-90;return e}const x5=6378137,B2=[-180,-90,180,90],S5=Math.PI*x5/180;class xl extends jw{constructor(e,t){super({code:e,units:"degrees",extent:B2,axisOrientation:t,global:!0,metersPerUnit:S5,worldExtent:B2})}}const z2=[new xl("CRS:84"),new xl("EPSG:4326","neu"),new xl("urn:ogc:def:crs:OGC:1.3:CRS84"),new xl("urn:ogc:def:crs:OGC:2:84"),new xl("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new xl("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new xl("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let nE={};function T5(n){return nE[n]||nE[n.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function I5(n,e){nE[n]=e}let qc={};function eu(n,e,t){const i=n.getCode(),r=e.getCode();i in qc||(qc[i]={}),qc[i][r]=t}function $v(n,e){return n in qc&&e in qc[n]?qc[n][e]:null}const a_=.9996,Sr=.00669438,w0=Sr*Sr,x0=w0*Sr,jl=Sr/(1-Sr),$2=Math.sqrt(1-Sr),lh=(1-$2)/(1+$2),ib=lh*lh,Uw=ib*lh,Bw=Uw*lh,rb=Bw*lh,sb=1-Sr/4-3*w0/64-5*x0/256,A5=3*Sr/8+3*w0/32+45*x0/1024,R5=15*w0/256+45*x0/1024,P5=35*x0/3072,C5=3/2*lh-27/32*Uw+269/512*rb,M5=21/16*ib-55/32*Bw,b5=151/96*Uw-417/128*rb,L5=1097/512*Bw,l_=6378137;function k5(n,e,t){const i=n-5e5,o=(t.north?e:e-1e7)/a_/(l_*sb),a=o+C5*Math.sin(2*o)+M5*Math.sin(4*o)+b5*Math.sin(6*o)+L5*Math.sin(8*o),u=Math.sin(a),h=u*u,d=Math.cos(a),g=u/d,m=g*g,v=m*m,y=1-Sr*h,T=Math.sqrt(1-Sr*h),w=l_/T,A=(1-Sr)/y,P=jl*d**2,M=P*P,k=i/(w*a_),N=k*k,B=N*k,b=B*k,R=b*k,L=R*k,V=a-g/A*(N/2-b/24*(5+3*m+10*P-4*M-9*jl))+L/720*(61+90*m+298*P+45*v-252*jl-3*M);let F=(k-B/6*(1+2*m+P)+R/120*(5-2*P+28*m-3*M+8*jl+24*v))/d;return F=tE(F+Ta(ob(t.number)),-Math.PI,Math.PI),[G2(F),G2(V)]}const W2=-80,K2=84,D5=-180,N5=180;function O5(n,e,t){n=tE(n,D5,N5),e<W2?e=W2:e>K2&&(e=K2);const i=Ta(e),r=Math.sin(i),s=Math.cos(i),o=r/s,a=o*o,u=a*a,h=Ta(n),d=ob(t.number),g=Ta(d),m=l_/Math.sqrt(1-Sr*r**2),v=jl*s**2,y=s*tE(h-g,-Math.PI,Math.PI),T=y*y,w=T*y,A=w*y,P=A*y,M=P*y,k=l_*(sb*i-A5*Math.sin(2*i)+R5*Math.sin(4*i)-P5*Math.sin(6*i)),N=a_*m*(y+w/6*(1-a+v)+P/120*(5-18*a+u+72*v-58*jl))+5e5;let B=a_*(k+m*o*(T/2+A/24*(5-a+9*v+4*v**2)+M/720*(61-58*a+u+600*v-330*jl)));return t.north||(B+=1e7),[N,B]}function ob(n){return(n-1)*6-180+3}const V5=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function ab(n){let e=0;for(const r of V5){const s=n.match(r);if(s){e=parseInt(s[1]);break}}if(!e)return null;let t=0,i=!1;return e>32700&&e<32761?t=e-32700:e>32600&&e<32661&&(i=!0,t=e-32600),t?{number:t,north:i}:null}function H2(n,e){return function(t,i,r,s){const o=t.length;r=r>1?r:2,s=s??r,i||(r>2?i=t.slice():i=new Array(o));for(let a=0;a<o;a+=s){const u=t[a],h=t[a+1],d=n(u,h,e);i[a]=d[0],i[a+1]=d[1]}return i}}function F5(n){return ab(n)?new jw({code:n,units:"m"}):null}function G5(n){const e=ab(n.getCode());return e?{forward:H2(O5,e),inverse:H2(k5,e)}:null}const j5=63710088e-1;function q2(n,e,t){t=t||j5;const i=Ta(n[1]),r=Ta(e[1]),s=(r-i)/2,o=Ta(e[0]-n[0])/2,a=Math.sin(s)*Math.sin(s)+Math.sin(o)*Math.sin(o)*Math.cos(i)*Math.cos(r);return 2*t*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}const U5=[G5],B5=[F5];let iE=!0;function lb(n){iE=!1}function zw(n,e){if(e!==void 0){for(let t=0,i=n.length;t<i;++t)e[t]=n[t];e=e}else e=n.slice();return e}function rE(n){I5(n.getCode(),n),eu(n,n,zw)}function z5(n){n.forEach(rE)}function An(n){if(typeof n!="string")return n;const e=T5(n);if(e)return e;for(const t of B5){const i=t(n);if(i)return i}return null}function X2(n,e,t,i){n=An(n);let r;const s=n.getPointResolutionFunc();if(s)r=s(e,t);else{const o=n.getUnits();if(o=="degrees"&&!i||i=="degrees")r=e;else{const a=Ww(n,An("EPSG:4326"));if(!a&&o!=="degrees")r=e*n.getMetersPerUnit();else{let h=[t[0]-e/2,t[1],t[0]+e/2,t[1],t[0],t[1]-e/2,t[0],t[1]+e/2];h=a(h,h,2);const d=q2(h.slice(0,2),h.slice(2,4)),g=q2(h.slice(4,6),h.slice(6,8));r=(d+g)/2}const u=n.getMetersPerUnit();u!==void 0&&(r/=u)}}return r}function Y2(n){z5(n),n.forEach(function(e){n.forEach(function(t){e!==t&&eu(e,t,zw)})})}function $5(n,e,t,i){n.forEach(function(r){e.forEach(function(s){eu(r,s,t),eu(s,r,i)})})}function $w(n,e){return n?typeof n=="string"?An(n):n:An(e)}function sE(n){return(function(e,t,i,r){const s=e.length;i=i!==void 0?i:2,r=r??i,t=t!==void 0?t:new Array(s);for(let o=0;o<s;o+=r){const a=n(e.slice(o,o+i)),u=a.length;for(let h=0,d=r;h<d;++h)t[o+h]=h>=u?e[o+h]:a[h]}return t})}function Ane(n,e,t,i){const r=An(n),s=An(e);eu(r,s,sE(t)),eu(s,r,sE(i))}function Aa(n,e){return lb(),vg(n,"EPSG:4326","EPSG:3857")}function Nc(n,e){const t=vg(n,"EPSG:3857","EPSG:4326"),i=t[0];return(i<-180||i>180)&&(t[0]=Ia(i+180,360)-180),t}function Dp(n,e){if(n===e)return!0;const t=n.getUnits()===e.getUnits();return(n.getCode()===e.getCode()||Ww(n,e)===zw)&&t}function Ww(n,e){const t=n.getCode(),i=e.getCode();let r=$v(t,i);if(r)return r;let s=null,o=null;for(const u of U5)s||(s=u(n)),o||(o=u(e));if(!s&&!o)return null;const a="EPSG:4326";if(o)if(s)r=Wv(s.inverse,o.forward);else{const u=$v(t,a);u&&(r=Wv(u,o.forward))}else{const u=$v(a,i);u&&(r=Wv(s.inverse,u))}return r&&(rE(n),rE(e),eu(n,e,r)),r}function Wv(n,e){return function(t,i,r,s){return i=n(t,i,r,s),e(i,i,r,s)}}function u_(n,e){const t=An(n),i=An(e);return Ww(t,i)}function vg(n,e,t){const i=u_(e,t);if(!i){const r=An(e).getCode(),s=An(t).getCode();throw new Error(`No transform available between ${r} and ${s}`)}return i(n,void 0,n.length)}function oE(n,e){return n}function oo(n,e){return iE&&!o_(n,[0,0])&&n[0]>=-180&&n[0]<=180&&n[1]>=-90&&n[1]<=90&&(iE=!1,nb("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),n}function ub(n,e){return n}function va(n,e){return n}function Rne(n,e,t){return function(i){let r,s;if(n.canWrapX()){const o=n.getExtent(),a=st(o);i=i.slice(0),s=tb(i,n,a),s&&(i[0]=i[0]-s*a),i[0]=Lt(i[0],o[0],o[2]),i[1]=Lt(i[1],o[1],o[3]),r=t(i)}else r=t(i);return s&&e.canWrapX()&&(r[0]+=s*st(e.getExtent())),r}}function W5(){Y2(U2),Y2(z2),$5(z2,U2,E5,w5)}W5();new Array(6);function Xr(){return[1,0,0,1,0,0]}function K5(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n}function In(n,e){const t=e[0],i=e[1];return e[0]=n[0]*t+n[2]*i+n[4],e[1]=n[1]*t+n[3]*i+n[5],e}function vo(n,e,t,i,r,s,o,a){const u=Math.sin(s),h=Math.cos(s);return n[0]=i*h,n[1]=r*u,n[2]=-i*u,n[3]=r*h,n[4]=o*i*h-a*i*u+e,n[5]=o*r*u+a*r*h+t,n}function cb(n,e){const t=H5(e);pt(t!==0,"Transformation matrix cannot be inverted");const i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],u=e[5];return n[0]=o/t,n[1]=-r/t,n[2]=-s/t,n[3]=i/t,n[4]=(s*u-o*a)/t,n[5]=-(i*u-r*a)/t,n}function H5(n){return n[0]*n[3]-n[1]*n[2]}const q5=[1e5,1e5,1e5,1e5,2,2];function X5(n){return"matrix("+n.join(", ")+")"}function aE(n){return n.substring(7,n.length-1).split(",").map(parseFloat)}function Y5(n,e){const t=aE(n),i=aE(e);for(let r=0;r<6;++r)if(Math.round((t[r]-i[r])*q5[r])!==0)return!1;return!0}function Ra(n,e,t,i,r,s,o){s=s||[],o=o||2;let a=0;for(let u=e;u<t;u+=i){const h=n[u],d=n[u+1];s[a++]=r[0]*h+r[2]*d+r[4],s[a++]=r[1]*h+r[3]*d+r[5];for(let g=2;g<o;g++)s[a++]=n[u+g]}return s&&s.length!=a&&(s.length=a),s}function hb(n,e,t,i,r,s,o){o=o||[];const a=Math.cos(r),u=Math.sin(r),h=s[0],d=s[1];let g=0;for(let m=e;m<t;m+=i){const v=n[m]-h,y=n[m+1]-d;o[g++]=h+v*a-y*u,o[g++]=d+v*u+y*a;for(let T=m+2;T<m+i;++T)o[g++]=n[T]}return o&&o.length!=g&&(o.length=g),o}function Z5(n,e,t,i,r,s,o,a){a=a||[];const u=o[0],h=o[1];let d=0;for(let g=e;g<t;g+=i){const m=n[g]-u,v=n[g+1]-h;a[d++]=u+r*m,a[d++]=h+s*v;for(let y=g+2;y<g+i;++y)a[d++]=n[y]}return a&&a.length!=d&&(a.length=d),a}function Q5(n,e,t,i,r,s,o){o=o||[];let a=0;for(let u=e;u<t;u+=i){o[a++]=n[u]+r,o[a++]=n[u+1]+s;for(let h=u+2;h<u+i;++h)o[a++]=n[h]}return o&&o.length!=a&&(o.length=a),o}const Z2=Xr(),J5=[NaN,NaN];class e6 extends Vs{constructor(){super(),this.extent_=Xi(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=BM((e,t,i)=>{if(!i)return this.getSimplifiedGeometry(t);const r=this.clone();return r.applyTransform(i),r.getSimplifiedGeometry(t)})}simplifyTransformed(e,t){return this.simplifyTransformedInternal(this.getRevision(),e,t)}clone(){return at()}closestPointXY(e,t,i,r){return at()}containsXY(e,t){return this.closestPointXY(e,t,J5,Number.MIN_VALUE)===0}getClosestPoint(e,t){return t=t||[NaN,NaN],this.closestPointXY(e[0],e[1],t,1/0),t}intersectsCoordinate(e){return this.containsXY(e[0],e[1])}computeExtent(e){return at()}getExtent(e){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&p0(t),this.extentRevision_=this.getRevision()}return d5(this.extent_,e)}rotate(e,t){at()}scale(e,t,i){at()}simplify(e){return this.getSimplifiedGeometry(e*e)}getSimplifiedGeometry(e){return at()}getType(){return at()}applyTransform(e){at()}intersectsExtent(e){return at()}translate(e,t){at()}transform(e,t){const i=An(e),r=i.getUnits()=="tile-pixels"?function(s,o,a){const u=i.getExtent(),h=i.getWorldExtent(),d=Jn(h)/Jn(u);vo(Z2,h[0],h[3],d,-d,0,0,0);const g=Ra(s,0,s.length,a,Z2,o),m=u_(i,t);return m?m(g,g,a):g}:u_(i,t);return this.applyTransform(r),this}}class S0 extends e6{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(e){return Vw(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinates(){return at()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=this.getSimplifiedGeometryInternal(e);return t.getFlatCoordinates().length<this.flatCoordinates.length?t:(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getSimplifiedGeometryInternal(e){return this}getStride(){return this.stride}setFlatCoordinates(e,t){this.stride=Q2(e),this.layout=e,this.flatCoordinates=t}setCoordinates(e,t){at()}setLayout(e,t,i){let r;if(e)r=Q2(e);else{for(let s=0;s<i;++s){if(t.length===0){this.layout="XY",this.stride=2;return}t=t[0]}r=t.length,e=t6(r)}this.layout=e,this.stride=r}applyTransform(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(e,t){const i=this.getFlatCoordinates();if(i){const r=this.getStride();hb(i,0,i.length,r,e,t,i),this.changed()}}scale(e,t,i){t===void 0&&(t=e),i||(i=Jl(this.getExtent()));const r=this.getFlatCoordinates();if(r){const s=this.getStride();Z5(r,0,r.length,s,e,t,i,r),this.changed()}}translate(e,t){const i=this.getFlatCoordinates();if(i){const r=this.getStride();Q5(i,0,i.length,r,e,t,i),this.changed()}}}function t6(n){let e;return n==2?e="XY":n==3?e="XYZ":n==4&&(e="XYZM"),e}function Q2(n){let e;return n=="XY"?e=2:n=="XYZ"||n=="XYM"?e=3:n=="XYZM"&&(e=4),e}function n6(n,e,t){const i=n.getFlatCoordinates();if(!i)return null;const r=n.getStride();return Ra(i,0,i.length,r,e,t)}function J2(n,e,t,i,r,s,o){const a=n[e],u=n[e+1],h=n[t]-a,d=n[t+1]-u;let g;if(h===0&&d===0)g=e;else{const m=((r-a)*h+(s-u)*d)/(h*h+d*d);if(m>1)g=t;else if(m>0){for(let v=0;v<i;++v)o[v]=$i(n[e+v],n[t+v],m);o.length=i;return}else g=e}for(let m=0;m<i;++m)o[m]=n[g+m];o.length=i}function Kw(n,e,t,i,r){let s=n[e],o=n[e+1];for(e+=i;e<t;e+=i){const a=n[e],u=n[e+1],h=Hc(s,o,a,u);h>r&&(r=h),s=a,o=u}return r}function db(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const a=t[s];r=Kw(n,e,a,i,r),e=a}return r}function Pne(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const a=t[s];r=db(n,e,a,i,r),e=a[a.length-1]}return r}function Hw(n,e,t,i,r,s,o,a,u,h,d){if(e==t)return h;let g,m;if(r===0){if(m=Hc(o,a,n[e],n[e+1]),m<h){for(g=0;g<i;++g)u[g]=n[e+g];return u.length=i,m}return h}d=d||[NaN,NaN];let v=e+i;for(;v<t;)if(J2(n,v-i,v,i,o,a,d),m=Hc(o,a,d[0],d[1]),m<h){for(h=m,g=0;g<i;++g)u[g]=d[g];u.length=i,v+=i}else v+=i*Math.max((Math.sqrt(m)-Math.sqrt(h))/r|0,1);if(s&&(J2(n,t-i,e,i,o,a,d),m=Hc(o,a,d[0],d[1]),m<h)){for(h=m,g=0;g<i;++g)u[g]=d[g];u.length=i}return h}function fb(n,e,t,i,r,s,o,a,u,h,d){d=d||[NaN,NaN];for(let g=0,m=t.length;g<m;++g){const v=t[g];h=Hw(n,e,v,i,r,s,o,a,u,h,d),e=v}return h}function Cne(n,e,t,i,r,s,o,a,u,h,d){d=d||[NaN,NaN];for(let g=0,m=t.length;g<m;++g){const v=t[g];h=fb(n,e,v,i,r,s,o,a,u,h,d),e=v[v.length-1]}return h}function i6(n,e,t,i){for(let r=0,s=t.length;r<s;++r)n[e++]=t[r];return e}function qw(n,e,t,i){for(let r=0,s=t.length;r<s;++r){const o=t[r];for(let a=0;a<i;++a)n[e++]=o[a]}return e}function gb(n,e,t,i,r){r=r||[];let s=0;for(let o=0,a=t.length;o<a;++o){const u=qw(n,e,t[o],i);r[s++]=u,e=u}return r.length=s,r}function Mne(n,e,t,i,r){r=r||[];let s=0;for(let o=0,a=t.length;o<a;++o){const u=gb(n,e,t[o],i,r[s]);u.length===0&&(u[0]=e),r[s++]=u,e=u[u.length-1]}return r.length=s,r}function Ul(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=e;o<t;o+=i)r[s++]=n.slice(o,o+i);return r.length=s,r}function c_(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,a=t.length;o<a;++o){const u=t[o];r[s++]=Ul(n,e,u,i,r[s]),e=u}return r.length=s,r}function eA(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,a=t.length;o<a;++o){const u=t[o];r[s++]=u.length===1&&u[0]===e?[]:c_(n,e,u,i,r[s]),e=u[u.length-1]}return r.length=s,r}function lE(n,e,t,i,r,s,o){let a,u;const h=(t-e)/i;if(h===1)a=e;else if(h===2)a=e,u=r;else if(h!==0){let d=n[e],g=n[e+1],m=0;const v=[0];for(let w=e+i;w<t;w+=i){const A=n[w],P=n[w+1];m+=Math.sqrt((A-d)*(A-d)+(P-g)*(P-g)),v.push(m),d=A,g=P}const y=r*m,T=n5(v,y);T<0?(u=(y-v[-T-2])/(v[-T-1]-v[-T-2]),a=e+(-T-2)*i):a=e+T*i}o=o>1?o:2,s=s||new Array(o);for(let d=0;d<o;++d)s[d]=a===void 0?NaN:u===void 0?n[a+d]:$i(n[a+d],n[a+i+d],u);return s}function uE(n,e,t,i,r,s){if(t==e)return null;let o;if(r<n[e+i-1])return s?(o=n.slice(e,e+i),o[i-1]=r,o):null;if(n[t-1]<r)return s?(o=n.slice(t-i,t),o[i-1]=r,o):null;if(r==n[e+i-1])return n.slice(e,e+i);let a=e/i,u=t/i;for(;a<u;){const m=a+u>>1;r<n[(m+1)*i-1]?u=m:a=m+1}const h=n[a*i-1];if(r==h)return n.slice((a-1)*i,(a-1)*i+i);const d=n[(a+1)*i-1],g=(r-h)/(d-h);o=[];for(let m=0;m<i-1;++m)o.push($i(n[(a-1)*i+m],n[a*i+m],g));return o.push(r),o}function bne(n,e,t,i,r,s,o){if(o)return uE(n,e,t[t.length-1],i,r,s);let a;if(r<n[i-1])return s?(a=n.slice(0,i),a[i-1]=r,a):null;if(n[n.length-1]<r)return s?(a=n.slice(n.length-i),a[i-1]=r,a):null;for(let u=0,h=t.length;u<h;++u){const d=t[u];if(e!=d){if(r<n[e+i-1])return null;if(r<=n[d-1])return uE(n,e,d,i,r,!1);e=d}}return null}function r6(n,e,t,i,r){return!XM(r,function(o){return!Bl(n,e,t,i,o[0],o[1])})}function Bl(n,e,t,i,r,s){let o=0,a=n[t-i],u=n[t-i+1];for(;e<t;e+=i){const h=n[e],d=n[e+1];u<=s?d>s&&(h-a)*(s-u)-(r-a)*(d-u)>0&&o++:d<=s&&(h-a)*(s-u)-(r-a)*(d-u)<0&&o--,a=h,u=d}return o!==0}function Xw(n,e,t,i,r,s){if(t.length===0||!Bl(n,e,t[0],i,r,s))return!1;for(let o=1,a=t.length;o<a;++o)if(Bl(n,t[o-1],t[o],i,r,s))return!1;return!0}function Lne(n,e,t,i,r,s){if(t.length===0)return!1;for(let o=0,a=t.length;o<a;++o){const u=t[o];if(Xw(n,e,u,i,r,s))return!0;e=u[u.length-1]}return!1}function mb(n,e,t,i,r){let s;for(e+=i;e<t;e+=i)if(s=r(n.slice(e-i,e),n.slice(e,e+i)),s)return s;return!1}function T0(n,e,t,i,r,s){return s=s??qM(Xi(),n,e,t,i),Ai(r,s)?s[0]>=r[0]&&s[2]<=r[2]||s[1]>=r[1]&&s[3]<=r[3]?!0:mb(n,e,t,i,function(o,a){return f5(r,o,a)}):!1}function kne(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){if(T0(n,e,t[s],i,r))return!0;e=t[s]}return!1}function pb(n,e,t,i,r){return!!(T0(n,e,t,i,r)||Bl(n,e,t,i,r[0],r[1])||Bl(n,e,t,i,r[0],r[3])||Bl(n,e,t,i,r[2],r[1])||Bl(n,e,t,i,r[2],r[3]))}function _b(n,e,t,i,r){if(!pb(n,e,t[0],i,r))return!1;if(t.length===1)return!0;for(let s=1,o=t.length;s<o;++s)if(r6(n,t[s-1],t[s],i,r)&&!T0(n,t[s-1],t[s],i,r))return!1;return!0}function Dne(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const a=t[s];if(_b(n,e,a,i,r))return!0;e=a[a.length-1]}return!1}function yb(n,e,t,i){let r=n[e],s=n[e+1],o=0;for(let a=e+i;a<t;a+=i){const u=n[a],h=n[a+1];o+=Math.sqrt((u-r)*(u-r)+(h-s)*(h-s)),r=u,s=h}return o}function I0(n,e,t,i,r,s,o){const a=(t-e)/i;if(a<3){for(;e<t;e+=i)s[o++]=n[e],s[o++]=n[e+1];return o}const u=new Array(a);u[0]=1,u[a-1]=1;const h=[e,t-i];let d=0;for(;h.length>0;){const g=h.pop(),m=h.pop();let v=0;const y=n[m],T=n[m+1],w=n[g],A=n[g+1];for(let P=m+i;P<g;P+=i){const M=n[P],k=n[P+1],N=g5(M,k,y,T,w,A);N>v&&(d=P,v=N)}v>r&&(u[(d-e)/i]=1,m+i<d&&h.push(m,d),d+i<g&&h.push(d,g))}for(let g=0;g<a;++g)u[g]&&(s[o++]=n[e+g*i],s[o++]=n[e+g*i+1]);return o}function s6(n,e,t,i,r,s,o,a){for(let u=0,h=t.length;u<h;++u){const d=t[u];o=I0(n,e,d,i,r,s,o),a.push(o),e=d}return o}function Al(n,e){return e*Math.round(n/e)}function o6(n,e,t,i,r,s,o){if(e==t)return o;let a=Al(n[e],r),u=Al(n[e+1],r);e+=i,s[o++]=a,s[o++]=u;let h,d;do if(h=Al(n[e],r),d=Al(n[e+1],r),e+=i,e==t)return s[o++]=h,s[o++]=d,o;while(h==a&&d==u);for(;e<t;){const g=Al(n[e],r),m=Al(n[e+1],r);if(e+=i,g==h&&m==d)continue;const v=h-a,y=d-u,T=g-a,w=m-u;if(v*w==y*T&&(v<0&&T<v||v==T||v>0&&T>v)&&(y<0&&w<y||y==w||y>0&&w>y)){h=g,d=m;continue}s[o++]=h,s[o++]=d,a=h,u=d,h=g,d=m}return s[o++]=h,s[o++]=d,o}function Yw(n,e,t,i,r,s,o,a){for(let u=0,h=t.length;u<h;++u){const d=t[u];o=o6(n,e,d,i,r,s,o),a.push(o),e=d}return o}function Nne(n,e,t,i,r,s,o,a){for(let u=0,h=t.length;u<h;++u){const d=t[u],g=[];o=Yw(n,e,d,i,r,s,o,g),a.push(g),e=d[d.length-1]}return o}class h_ extends S0{constructor(e,t){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}appendCoordinate(e){g0(this.flatCoordinates,e),this.changed()}clone(){const e=new h_(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,i,r){return r<Ow(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Kw(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Hw(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,e,t,i,r))}forEachSegment(e){return mb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinateAtM(e,t){return this.layout!="XYM"&&this.layout!="XYZM"?null:(t=t!==void 0?t:!1,uE(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t))}getCoordinates(){return Ul(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(e,t){return lE(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,this.stride)}getLength(){return yb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(e){const t=[];return t.length=I0(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new h_(t,"XY")}getType(){return"LineString"}intersectsExtent(e){return T0(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,this.getExtent())}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=qw(this.flatCoordinates,0,e,this.stride),this.changed()}}let d_=class vb extends S0{constructor(e,t){super(),this.setCoordinates(e,t)}clone(){const e=new vb(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,i,r){const s=this.flatCoordinates,o=Hc(e,t,s[0],s[1]);if(o<r){const a=this.stride;for(let u=0;u<a;++u)i[u]=s[u];return i.length=a,o}return r}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(e){return HM(this.flatCoordinates,e)}getType(){return"Point"}intersectsExtent(e){return KM(e,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(e,t){this.setLayout(t,e,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=i6(this.flatCoordinates,0,e,this.stride),this.changed()}};const Er={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},tu=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",a6=tu.includes("safari")&&!tu.includes("chrom");a6&&(tu.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(tu));const l6=tu.includes("webkit")&&!tu.includes("edge"),Eb=tu.includes("macintosh"),u6=typeof devicePixelRatio<"u"?devicePixelRatio:1,Wi=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,Zw=typeof Image<"u"&&Image.prototype.decode,wb=typeof createImageBitmap=="function",xb=(function(){let n=!1;try{const e=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return n})(),ze={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function mn(n,e,t,i){let r;return t&&t.length?r=t.shift():Wi?r=new class extends OffscreenCanvas{style={}}(n??300,e??150):r=document.createElement("canvas"),n&&(r.width=n),e&&(r.height=e),r.getContext("2d",i)}let Kv;function f_(){return Kv||(Kv=mn(1,1)),Kv}function A0(n){const e=n.canvas;e.width=1,e.height=1,n.clearRect(0,0,1,1)}function tA(n,e){const t=e.parentNode;t&&t.replaceChild(n,e)}function c6(n){for(;n.lastChild;)n.lastChild.remove()}function h6(n,e){const t=n.childNodes;for(let i=0;;++i){const r=t[i],s=e[i];if(!r&&!s)break;if(r!==s){if(!r){n.appendChild(s);continue}if(!s){n.removeChild(r),--i;continue}n.insertBefore(s,r)}}}function Sb(){return new Proxy({childNodes:[],appendChild:function(e){return this.childNodes.push(e),e},remove:function(){},removeChild:function(e){const t=this.childNodes.indexOf(e);if(t===-1)throw new Error("Node to remove was not found");return this.childNodes.splice(t,1),e},insertBefore:function(e,t){const i=this.childNodes.indexOf(t);if(i===-1)throw new Error("Reference node not found");return this.childNodes.splice(i,0,e),e},style:{}},{get(e,t,i){return t==="firstElementChild"?e.childNodes.length>0?e.childNodes[0]:null:Reflect.get(e,t,i)}})}function Ea(n){return typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas}const Qw=[NaN,NaN,NaN,0];let Hv;function d6(){return Hv||(Hv=mn(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),Hv}const f6=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,g6=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,m6=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,p6=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function lp(n,e){return n.endsWith("%")?Number(n.substring(0,n.length-1))/e:Number(n)}function uf(n){throw new Error('failed to parse "'+n+'" as color')}function Tb(n){if(n.toLowerCase().startsWith("rgb")){const s=n.match(g6)||n.match(f6)||n.match(m6);if(s){const o=s[4],a=100/255;return[Lt(lp(s[1],a)+.5|0,0,255),Lt(lp(s[2],a)+.5|0,0,255),Lt(lp(s[3],a)+.5|0,0,255),o!==void 0?Lt(lp(o,100),0,1):1]}uf(n)}if(n.startsWith("#")){if(p6.test(n)){const s=n.substring(1),o=s.length<=4?1:2,a=[0,0,0,255];for(let u=0,h=s.length;u<h;u+=o){let d=parseInt(s.substring(u,u+o),16);o===1&&(d+=d<<4),a[u/o]=d}return a[3]=a[3]/255,a}uf(n)}const e=d6();e.fillStyle="#abcdef";let t=e.fillStyle;e.fillStyle=n,e.fillStyle===t&&(e.fillStyle="#fedcba",t=e.fillStyle,e.fillStyle=n,e.fillStyle===t&&uf(n));const i=e.fillStyle;if(i.startsWith("#")||i.startsWith("rgba"))return Tb(i);e.clearRect(0,0,1,1),e.fillRect(0,0,1,1);const r=Array.from(e.getImageData(0,0,1,1).data);return r[3]=_g(r[3]/255,3),r}function _6(n){return typeof n=="string"?n:ex(n)}const y6=1024,Cd={};let qv=0;function v6(n){if(n.length===4)return n;const e=n.slice();return e[3]=1,e}function Xv(n){return n>.0031308?Math.pow(n,1/2.4)*269.025-14.025:n*3294.6}function Yv(n){return n>.2068965?Math.pow(n,3):(n-4/29)*(108/841)}function Zv(n){return n>10.314724?Math.pow((n+14.025)/269.025,2.4):n/3294.6}function Qv(n){return n>.0088564?Math.pow(n,1/3):n/(108/841)+4/29}function nA(n){const e=Zv(n[0]),t=Zv(n[1]),i=Zv(n[2]),r=Qv(e*.222488403+t*.716873169+i*.06060791),s=500*(Qv(e*.452247074+t*.399439023+i*.148375274)-r),o=200*(r-Qv(e*.016863605+t*.117638439+i*.865350722)),a=Math.atan2(o,s)*(180/Math.PI);return[116*r-16,Math.sqrt(s*s+o*o),a<0?a+360:a,n[3]]}function E6(n){const e=(n[0]+16)/116,t=n[1],i=n[2]*Math.PI/180,r=Yv(e),s=Yv(e+t/500*Math.cos(i)),o=Yv(e-t/200*Math.sin(i)),a=Xv(s*3.021973625-r*1.617392459-o*.404875592),u=Xv(s*-.943766287+r*1.916279586+o*.027607165),h=Xv(s*.069407491-r*.22898585+o*1.159737864);return[Lt(a+.5|0,0,255),Lt(u+.5|0,0,255),Lt(h+.5|0,0,255),n[3]]}function Jw(n){if(n==="none")return Qw;if(Cd.hasOwnProperty(n))return Cd[n];if(qv>=y6){let t=0;for(const i in Cd)(t++&3)===0&&(delete Cd[i],--qv)}const e=Tb(n);e.length!==4&&uf(n);for(const t of e)isNaN(t)&&uf(n);return Cd[n]=e,++qv,e}function uh(n){return Array.isArray(n)?n:Jw(n)}function ex(n){let e=n[0];e!=(e|0)&&(e=e+.5|0);let t=n[1];t!=(t|0)&&(t=t+.5|0);let i=n[2];i!=(i|0)&&(i=i+.5|0);const r=n[3]===void 0?1:Math.round(n[3]*1e3)/1e3;return"rgba("+e+","+t+","+i+","+r+")"}class One extends mg{constructor(e,t,i,r){super(),this.extent=e,this.pixelRatio_=i,this.resolution=t,this.state=typeof r=="function"?ze.IDLE:r,this.image_=null,this.loader=typeof r=="function"?r:null}changed(){this.dispatchEvent(qe.CHANGE)}getExtent(){return this.extent}getImage(){return this.image_}getPixelRatio(){return this.pixelRatio_}getResolution(){return this.resolution}getState(){return this.state}load(){if(this.state==ze.IDLE&&this.loader){this.state=ze.LOADING,this.changed();const e=this.getResolution(),t=Array.isArray(e)?e[0]:e;zM(()=>this.loader(this.getExtent(),t,this.getPixelRatio())).then(i=>{"image"in i&&(this.image_=i.image),"extent"in i&&(this.extent=i.extent),"resolution"in i&&(this.resolution=i.resolution),"pixelRatio"in i&&(this.pixelRatio_=i.pixelRatio),(i instanceof HTMLImageElement||wb&&i instanceof ImageBitmap||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement)&&(this.image_=i),this.state=ze.LOADED}).catch(i=>{this.state=ze.ERROR,console.error(i)}).finally(()=>this.changed())}}setImage(e){this.image_=e}setResolution(e){this.resolution=e}}function w6(n,e,t){const i=n;let r=!0,s=!1,o=!1;const a=[s_(i,qe.LOAD,function(){o=!0,s||e()})];return i.src&&Zw?(s=!0,i.decode().then(function(){r&&e()}).catch(function(u){r&&(o?e():t())})):a.push(s_(i,qe.ERROR,t)),function(){r=!1,a.forEach(Vt)}}function x6(n,e){return new Promise((t,i)=>{function r(){o(),t(n)}function s(){o(),i(new Error("Image load error"))}function o(){n.removeEventListener("load",r),n.removeEventListener("error",s)}n.addEventListener("load",r),n.addEventListener("error",s)})}function Ib(n,e){return e&&(n.src=e),n.src&&Zw?new Promise((t,i)=>n.decode().then(()=>t(n)).catch(r=>n.complete&&n.width?t(n):i(r))):x6(n)}function Vne(n,e){return e&&(n.src=e),n.src&&Zw&&wb?n.decode().then(()=>createImageBitmap(n)).catch(t=>{if(n.complete&&n.width)return n;throw t}):Ib(n)}class S6{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let e=0;for(const t in this.cache_){const i=this.cache_[t];(e++&3)===0&&!i.hasListener()&&(delete this.cache_[t],delete this.patternCache_[t],--this.cacheSize_)}}}get(e,t,i){const r=Jv(e,t,i);return r in this.cache_?this.cache_[r]:null}getPattern(e,t,i){const r=Jv(e,t,i);return r in this.patternCache_?this.patternCache_[r]:null}set(e,t,i,r,s){const o=Jv(e,t,i),a=o in this.cache_;this.cache_[o]=r,s&&(r.getImageState()===ze.IDLE&&r.load(),r.getImageState()===ze.LOADING?r.ready().then(()=>{this.patternCache_[o]=f_().createPattern(r.getImage(1),"repeat")}):this.patternCache_[o]=f_().createPattern(r.getImage(1),"repeat")),a||++this.cacheSize_}setSize(e){this.maxCacheSize_=e,this.expire()}}function Jv(n,e,t){const i=t?uh(t):"null";return e+":"+n+":"+i}const wr=new S6;let Md=null;class Ab extends mg{constructor(e,t,i,r,s){super(),this.hitDetectionImage_=null,this.image_=e,this.crossOrigin_=i,this.canvas_={},this.color_=s,this.imageState_=r===void 0?ze.IDLE:r,this.size_=e&&e.width&&e.height?[e.width,e.height]:null,this.src_=t,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===ze.LOADED){Md||(Md=mn(1,1,void 0,{willReadFrequently:!0})),Md.drawImage(this.image_,0,0);try{Md.getImageData(0,0,1,1),this.tainted_=!1}catch{Md=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(qe.CHANGE)}handleImageError_(){this.imageState_=ze.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=ze.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}getPixelRatio(e){return this.replaceColor_(e),this.canvas_[e]?e:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const e=this.size_[0],t=this.size_[1],i=mn(e,t);i.fillRect(0,0,e,t),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===ze.IDLE){this.image_||this.initializeImage_(),this.imageState_=ze.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&Ib(this.image_,this.src_).then(e=>{this.image_=e,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(e){if(!this.color_||this.canvas_[e]||this.imageState_!==ze.LOADED)return;const t=this.image_,i=mn(Math.ceil(t.width*e),Math.ceil(t.height*e)),r=i.canvas;i.scale(e,e),i.drawImage(t,0,0),i.globalCompositeOperation="multiply",i.fillStyle=_6(this.color_),i.fillRect(0,0,r.width/e,r.height/e),i.globalCompositeOperation="destination-in",i.drawImage(t,0,0),this.canvas_[e]=r}ready(){return this.ready_||(this.ready_=new Promise(e=>{if(this.imageState_===ze.LOADED||this.imageState_===ze.ERROR)e();else{const t=()=>{(this.imageState_===ze.LOADED||this.imageState_===ze.ERROR)&&(this.removeEventListener(qe.CHANGE,t),e())};this.addEventListener(qe.CHANGE,t)}})),this.ready_}}function g_(n,e,t,i,r,s){let o=e===void 0?void 0:wr.get(e,t,r);return o||(o=new Ab(n,n&&"src"in n?n.src||void 0:e,t,i,r),wr.set(e,t,r,o,s)),s&&o&&!wr.getPattern(e,t,r)&&wr.set(e,t,r,o,s),o}function Ts(n){return n?Array.isArray(n)?ex(n):typeof n=="object"&&"src"in n?T6(n):n:null}function T6(n){if(!n.offset||!n.size)return wr.getPattern(n.src,"anonymous",n.color);const e=n.src+":"+n.offset,t=wr.getPattern(e,void 0,n.color);if(t)return t;const i=wr.get(n.src,"anonymous",null);if(i.getImageState()!==ze.LOADED)return null;const r=mn(n.size[0],n.size[1]);return r.drawImage(i.getImage(1),n.offset[0],n.offset[1],n.size[0],n.size[1],0,0,n.size[0],n.size[1]),g_(r.canvas,e,void 0,ze.LOADED,n.color,!0),wr.getPattern(e,void 0,n.color)}class Rb{drawCustom(e,t,i,r,s){}drawGeometry(e){}setStyle(e){}drawCircle(e,t,i){}drawFeature(e,t,i){}drawGeometryCollection(e,t,i){}drawLineString(e,t,i){}drawMultiLineString(e,t,i){}drawMultiPoint(e,t,i){}drawMultiPolygon(e,t,i){}drawPoint(e,t,i){}drawPolygon(e,t,i){}drawText(e,t,i){}setFillStrokeStyle(e,t){}setImageStyle(e,t){}setTextStyle(e,t){}}const up="ol-hidden",R0="ol-unselectable",tx="ol-control",iA="ol-collapsed",I6=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),rA=["style","variant","weight","size","lineHeight","family"],cE={normal:400,bold:700},hE=function(n){const e=n.match(I6);if(!e)return null;const t={lineHeight:"normal",size:"1.2em",style:"normal",weight:"400",variant:"normal"};for(let i=0,r=rA.length;i<r;++i){const s=e[i+1];s!==void 0&&(t[rA[i]]=typeof s=="string"?s.trim():s)}return isNaN(Number(t.weight))&&t.weight in cE&&(t.weight=cE[t.weight]),t.families=t.family.split(/,\s?/).map(i=>i.trim().replace(/^['"]|['"]$/g,"")),t},Pb="10px sans-serif",Ti="#000",ch="round",go=[],mo=0,hh="round",kf=10,Df="#000",Nf="center",m_="middle",zl=[0,0,0,0],Of=1,Tc=new Vs;let bd=null,sA;const dE={},A6=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"]);function R6(n,e,t){return`${n} ${e} 16px "${t}"`}const P6=(function(){let e,t;async function i(s){await t.ready;const o=await t.load(s);if(o.length===0)return!1;const a=hE(s),u=a.families[0].toLowerCase(),h=a.weight;return o.some(d=>{const g=d.family.replace(/^['"]|['"]$/g,"").toLowerCase(),m=cE[d.weight]||d.weight;return g===u&&d.style===a.style&&m==h})}async function r(){await t.ready;let s=!0;const o=Tc.getProperties(),a=Object.keys(o).filter(u=>o[u]<100);for(let u=a.length-1;u>=0;--u){const h=a[u];let d=o[h];d<100&&(await i(h)?(gg(dE),Tc.set(h,100)):(d+=10,Tc.set(h,d,!0),d<100&&(s=!1)))}e=void 0,s||(e=setTimeout(r,100))}return async function(s){t||(t=Wi?self.fonts:document.fonts);const o=hE(s);if(!o)return;const a=o.families;let u=!1;for(const h of a){if(A6.has(h))continue;const d=R6(o.style,o.weight,h);Tc.get(d)===void 0&&(Tc.set(d,0,!0),u=!0)}u&&(clearTimeout(e),e=setTimeout(r,100))}})(),C6=(function(){let n;return function(e){let t=dE[e];if(t==null){if(Wi){const i=hE(e),r=Cb(e,"g");t=(isNaN(Number(i.lineHeight))?1.2:Number(i.lineHeight))*(r.actualBoundingBoxAscent+r.actualBoundingBoxDescent)}else n||(n=document.createElement("div"),n.innerHTML="M",n.style.minHeight="0",n.style.maxHeight="none",n.style.height="auto",n.style.padding="0",n.style.border="none",n.style.position="absolute",n.style.display="block",n.style.left="-99999px"),n.style.font=e,document.body.appendChild(n),t=n.offsetHeight,document.body.removeChild(n);dE[e]=t}return t}})();function Cb(n,e){return bd||(bd=mn(1,1)),n!=sA&&(bd.font=n,sA=bd.font),bd.measureText(e)}function Mb(n,e){return Cb(n,e).width}function oA(n,e,t){if(e in t)return t[e];const i=e.split(`
`).reduce((r,s)=>Math.max(r,Mb(n,s)),0);return t[e]=i,i}function M6(n,e){const t=[],i=[],r=[];let s=0,o=0,a=0,u=0;for(let h=0,d=e.length;h<=d;h+=2){const g=e[h];if(g===`
`||h===d){s=Math.max(s,o),r.push(o),o=0,a+=u,u=0;continue}const m=e[h+1]||n.font,v=Mb(m,g);t.push(v),o+=v;const y=C6(m);i.push(y),u=Math.max(u,y)}return{width:s,height:a,widths:t,heights:i,lineWidths:r}}function b6(n,e,t,i,r,s,o,a,u,h,d){n.save(),t!==1&&(n.globalAlpha===void 0?n.globalAlpha=g=>g.globalAlpha*=t:n.globalAlpha*=t),e&&n.transform.apply(n,e),i.contextInstructions?(n.translate(u,h),n.scale(d[0],d[1]),L6(i,n)):d[0]<0||d[1]<0?(n.translate(u,h),n.scale(d[0],d[1]),n.drawImage(i,r,s,o,a,0,0,o,a)):n.drawImage(i,r,s,o,a,u,h,o*d[0],a*d[1]),n.restore()}function L6(n,e){const t=n.contextInstructions;for(let i=0,r=t.length;i<r;i+=2)Array.isArray(t[i+1])?e[t[i]].apply(e,t[i+1]):e[t[i]]=t[i+1]}class k6 extends Rb{constructor(e,t,i,r,s,o,a){super(),this.context_=e,this.pixelRatio_=t,this.extent_=i,this.transform_=r,this.transformRotation_=r?_g(Math.atan2(r[1],r[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=o,this.userTransform_=a,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=Xr()}drawImages_(e,t,i,r){if(!this.image_)return;const s=Ra(e,t,i,r,this.transform_,this.pixelCoordinates_),o=this.context_,a=this.tmpLocalTransform_,u=o.globalAlpha;this.imageOpacity_!=1&&(o.globalAlpha=u*this.imageOpacity_);let h=this.imageRotation_;this.transformRotation_===0&&(h-=this.viewRotation_),this.imageRotateWithView_&&(h+=this.viewRotation_);for(let d=0,g=s.length;d<g;d+=2){const m=s[d]-this.imageAnchorX_,v=s[d+1]-this.imageAnchorY_;if(h!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const y=m+this.imageAnchorX_,T=v+this.imageAnchorY_;vo(a,y,T,1,1,h,-y,-T),o.save(),o.transform.apply(o,a),o.translate(y,T),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.restore()}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,m,v,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(o.globalAlpha=u)}drawText_(e,t,i,r){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=Ra(e,t,i,r,this.transform_,this.pixelCoordinates_),o=this.context_;let a=this.textRotation_;for(this.transformRotation_===0&&(a-=this.viewRotation_),this.textRotateWithView_&&(a+=this.viewRotation_);t<i;t+=r){const u=s[t]+this.textOffsetX_,h=s[t+1]+this.textOffsetY_;a!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(o.save(),o.translate(u-this.textOffsetX_,h-this.textOffsetY_),o.rotate(a),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.restore()):(this.textStrokeState_&&o.strokeText(this.text_,u,h),this.textFillState_&&o.fillText(this.text_,u,h))}}moveToLineTo_(e,t,i,r,s){const o=this.context_,a=Ra(e,t,i,r,this.transform_,this.pixelCoordinates_);o.moveTo(a[0],a[1]);let u=a.length;s&&(u-=2);for(let h=2;h<u;h+=2)o.lineTo(a[h],a[h+1]);return s&&o.closePath(),i}drawRings_(e,t,i,r){for(let s=0,o=i.length;s<o;++s)t=this.moveToLineTo_(e,t,i[s],r,!0);return t}drawCircle(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Ai(this.extent_,e.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=n6(e,this.transform_,this.pixelCoordinates_),i=t[2]-t[0],r=t[3]-t[1],s=Math.sqrt(i*i+r*r),o=this.context_;o.beginPath(),o.arc(t[0],t[1],s,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}this.text_!==""&&this.drawText_(e.getCenter(),0,2,2)}}setStyle(e){this.setFillStrokeStyle(e.getFill(),e.getStroke()),this.setImageStyle(e.getImage()),this.setTextStyle(e.getText())}setTransform(e){this.transform_=e}drawGeometry(e){switch(e.getType()){case"Point":this.drawPoint(e);break;case"LineString":this.drawLineString(e);break;case"Polygon":this.drawPolygon(e);break;case"MultiPoint":this.drawMultiPoint(e);break;case"MultiLineString":this.drawMultiLineString(e);break;case"MultiPolygon":this.drawMultiPolygon(e);break;case"GeometryCollection":this.drawGeometryCollection(e);break;case"Circle":this.drawCircle(e);break}}drawFeature(e,t){const i=t.getGeometryFunction()(e);i&&(this.setStyle(t),this.drawGeometry(i))}drawGeometryCollection(e){const t=e.getGeometriesArray();for(let i=0,r=t.length;i<r;++i)this.drawGeometry(t[i])}drawPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(t,0,t.length,i),this.text_!==""&&this.drawText_(t,0,t.length,i)}drawMultiPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(t,0,t.length,i),this.text_!==""&&this.drawText_(t,0,t.length,i)}drawLineString(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Ai(this.extent_,e.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const t=this.context_,i=e.getFlatCoordinates();t.beginPath(),this.moveToLineTo_(i,0,i.length,e.getStride(),!1),t.stroke()}if(this.text_!==""){const t=e.getFlatMidpoint();this.drawText_(t,0,2,2)}}}drawMultiLineString(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getExtent();if(Ai(this.extent_,t)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const i=this.context_,r=e.getFlatCoordinates();let s=0;const o=e.getEnds(),a=e.getStride();i.beginPath();for(let u=0,h=o.length;u<h;++u)s=this.moveToLineTo_(r,s,o[u],a,!1);i.stroke()}if(this.text_!==""){const i=e.getFlatMidpoints();this.drawText_(i,0,i.length,2)}}}drawPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Ai(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_;t.beginPath(),this.drawRings_(e.getOrientedFlatCoordinates(),0,e.getEnds(),e.getStride()),this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoint();this.drawText_(t,0,2,2)}}}drawMultiPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Ai(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_,i=e.getOrientedFlatCoordinates();let r=0;const s=e.getEndss(),o=e.getStride();t.beginPath();for(let a=0,u=s.length;a<u;++a){const h=s[a];r=this.drawRings_(i,r,h,o)}this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoints();this.drawText_(t,0,t.length,2)}}}setContextFillState_(e){const t=this.context_,i=this.contextFillState_;i?i.fillStyle!=e.fillStyle&&(i.fillStyle=e.fillStyle,t.fillStyle=e.fillStyle):(t.fillStyle=e.fillStyle,this.contextFillState_={fillStyle:e.fillStyle})}setContextStrokeState_(e){const t=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=e.lineCap&&(i.lineCap=e.lineCap,t.lineCap=e.lineCap),Wa(i.lineDash,e.lineDash)||t.setLineDash(i.lineDash=e.lineDash),i.lineDashOffset!=e.lineDashOffset&&(i.lineDashOffset=e.lineDashOffset,t.lineDashOffset=e.lineDashOffset),i.lineJoin!=e.lineJoin&&(i.lineJoin=e.lineJoin,t.lineJoin=e.lineJoin),i.lineWidth!=e.lineWidth&&(i.lineWidth=e.lineWidth,t.lineWidth=e.lineWidth),i.miterLimit!=e.miterLimit&&(i.miterLimit=e.miterLimit,t.miterLimit=e.miterLimit),i.strokeStyle!=e.strokeStyle&&(i.strokeStyle=e.strokeStyle,t.strokeStyle=e.strokeStyle)):(t.lineCap=e.lineCap,t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset,t.lineJoin=e.lineJoin,t.lineWidth=e.lineWidth,t.miterLimit=e.miterLimit,t.strokeStyle=e.strokeStyle,this.contextStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle})}setContextTextState_(e){const t=this.context_,i=this.contextTextState_,r=e.textAlign?e.textAlign:Nf;i?(i.font!=e.font&&(i.font=e.font,t.font=e.font),i.textAlign!=r&&(i.textAlign=r,t.textAlign=r),i.textBaseline!=e.textBaseline&&(i.textBaseline=e.textBaseline,t.textBaseline=e.textBaseline)):(t.font=e.font,t.textAlign=r,t.textBaseline=e.textBaseline,this.contextTextState_={font:e.font,textAlign:r,textBaseline:e.textBaseline})}setFillStrokeStyle(e,t){if(!e)this.fillState_=null;else{const i=e.getColor();this.fillState_={fillStyle:Ts(i||Ti)}}if(!t)this.strokeState_=null;else{const i=t.getColor(),r=t.getLineCap(),s=t.getLineDash(),o=t.getLineDashOffset(),a=t.getLineJoin(),u=t.getWidth(),h=t.getMiterLimit(),d=s||go;this.strokeState_={lineCap:r!==void 0?r:ch,lineDash:this.pixelRatio_===1?d:d.map(g=>g*this.pixelRatio_),lineDashOffset:(o||mo)*this.pixelRatio_,lineJoin:a!==void 0?a:hh,lineWidth:(u!==void 0?u:Of)*this.pixelRatio_,miterLimit:h!==void 0?h:kf,strokeStyle:Ts(i||Df)}}}setImageStyle(e){let t;if(!e||!(t=e.getSize())){this.image_=null;return}const i=e.getPixelRatio(this.pixelRatio_),r=e.getAnchor(),s=e.getOrigin();this.image_=e.getImage(this.pixelRatio_),this.imageAnchorX_=r[0]*i,this.imageAnchorY_=r[1]*i,this.imageHeight_=t[1]*i,this.imageOpacity_=e.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=e.getRotateWithView(),this.imageRotation_=e.getRotation();const o=e.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/i,o[1]*this.pixelRatio_/i],this.imageWidth_=t[0]*i}setTextStyle(e){if(!e)this.text_="";else{const t=e.getFill();if(!t)this.textFillState_=null;else{const v=t.getColor();this.textFillState_={fillStyle:Ts(v||Ti)}}const i=e.getStroke();if(!i)this.textStrokeState_=null;else{const v=i.getColor(),y=i.getLineCap(),T=i.getLineDash(),w=i.getLineDashOffset(),A=i.getLineJoin(),P=i.getWidth(),M=i.getMiterLimit();this.textStrokeState_={lineCap:y!==void 0?y:ch,lineDash:T||go,lineDashOffset:w||mo,lineJoin:A!==void 0?A:hh,lineWidth:P!==void 0?P:Of,miterLimit:M!==void 0?M:kf,strokeStyle:Ts(v||Df)}}const r=e.getFont(),s=e.getOffsetX(),o=e.getOffsetY(),a=e.getRotateWithView(),u=e.getRotation(),h=e.getScaleArray(),d=e.getText(),g=e.getTextAlign(),m=e.getTextBaseline();this.textState_={font:r!==void 0?r:Pb,textAlign:g!==void 0?g:Nf,textBaseline:m!==void 0?m:m_},this.text_=d!==void 0?Array.isArray(d)?d.reduce((v,y,T)=>v+=T%2?" ":y,""):d:"",this.textOffsetX_=s!==void 0?this.pixelRatio_*s:0,this.textOffsetY_=o!==void 0?this.pixelRatio_*o:0,this.textRotateWithView_=a!==void 0?a:!1,this.textRotation_=u!==void 0?u:0,this.textScale_=[this.pixelRatio_*h[0],this.pixelRatio_*h[1]]}}}const D6=.5,bb={Point:B6,LineString:G6,Polygon:$6,MultiPoint:z6,MultiLineString:j6,MultiPolygon:U6,GeometryCollection:F6,Circle:O6};function N6(n,e){return parseInt(ut(n),10)-parseInt(ut(e),10)}function aA(n,e){const t=Lb(n,e);return t*t}function Lb(n,e){return D6*n/e}function O6(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(s||o){const u=n.getBuilder(t.getZIndex(),"Circle");u.setFillStrokeStyle(s,o),u.drawCircle(e,i,r)}const a=t.getText();if(a&&a.getText()){const u=n.getBuilder(t.getZIndex(),"Text");u.setTextStyle(a),u.drawText(e,i)}}function lA(n,e,t,i,r,s,o,a){const u=[],h=t.getImage();if(h){let m=!0;const v=h.getImageState();v==ze.LOADED||v==ze.ERROR?m=!1:v==ze.IDLE&&h.load(),m&&u.push(h.ready())}const d=t.getFill();d&&d.loading()&&u.push(d.ready());const g=u.length>0;return g&&Promise.all(u).then(()=>r(null)),V6(n,e,t,i,s,o,a),g}function V6(n,e,t,i,r,s,o){const a=t.getGeometryFunction()(e);if(!a)return;const u=a.simplifyTransformed(i,r);if(t.getRenderer())kb(n,u,t,e,o);else{const d=bb[u.getType()];d(n,u,t,e,o,s)}}function kb(n,e,t,i,r){if(e.getType()=="GeometryCollection"){const o=e.getGeometries();for(let a=0,u=o.length;a<u;++a)kb(n,o[a],t,i,r);return}n.getBuilder(t.getZIndex(),"Default").drawCustom(e,i,t.getRenderer(),t.getHitDetectionRenderer(),r)}function F6(n,e,t,i,r,s){const o=e.getGeometriesArray();let a,u;for(a=0,u=o.length;a<u;++a){const h=bb[o[a].getType()];h(n,o[a],t,i,r,s)}}function G6(n,e,t,i,r){const s=t.getStroke();if(s){const a=n.getBuilder(t.getZIndex(),"LineString");a.setFillStrokeStyle(null,s),a.drawLineString(e,i,r)}const o=t.getText();if(o&&o.getText()){const a=n.getBuilder(t.getZIndex(),"Text");a.setTextStyle(o),a.drawText(e,i,r)}}function j6(n,e,t,i,r){const s=t.getStroke();if(s){const a=n.getBuilder(t.getZIndex(),"LineString");a.setFillStrokeStyle(null,s),a.drawMultiLineString(e,i,r)}const o=t.getText();if(o&&o.getText()){const a=n.getBuilder(t.getZIndex(),"Text");a.setTextStyle(o),a.drawText(e,i,r)}}function U6(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(o||s){const u=n.getBuilder(t.getZIndex(),"Polygon");u.setFillStrokeStyle(s,o),u.drawMultiPolygon(e,i,r)}const a=t.getText();if(a&&a.getText()){const u=n.getBuilder(t.getZIndex(),"Text");u.setTextStyle(a),u.drawText(e,i,r)}}function B6(n,e,t,i,r,s){const o=t.getImage(),a=t.getText(),u=a&&a.getText(),h=s&&o&&u?{}:void 0;if(o){if(o.getImageState()!=ze.LOADED)return;const d=n.getBuilder(t.getZIndex(),"Image");d.setImageStyle(o,h),d.drawPoint(e,i,r)}if(u){const d=n.getBuilder(t.getZIndex(),"Text");d.setTextStyle(a,h),d.drawText(e,i,r)}}function z6(n,e,t,i,r,s){const o=t.getImage(),a=o&&o.getOpacity()!==0,u=t.getText(),h=u&&u.getText(),d=s&&a&&h?{}:void 0;if(a){if(o.getImageState()!=ze.LOADED)return;const g=n.getBuilder(t.getZIndex(),"Image");g.setImageStyle(o,d),g.drawMultiPoint(e,i,r)}if(h){const g=n.getBuilder(t.getZIndex(),"Text");g.setTextStyle(u,d),g.drawText(e,i,r)}}function $6(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(s||o){const u=n.getBuilder(t.getZIndex(),"Polygon");u.setFillStrokeStyle(s,o),u.drawPolygon(e,i,r)}const a=t.getText();if(a&&a.getText()){const u=n.getBuilder(t.getZIndex(),"Text");u.setTextStyle(a),u.drawText(e,i,r)}}let W6=!1;function K6(n,e,t,i,r,s,o){const a=new XMLHttpRequest;a.open("GET",typeof n=="function"?n(t,i,r):n,!0),e.getType()=="arraybuffer"&&(a.responseType="arraybuffer"),a.withCredentials=W6,a.onload=function(u){if(!a.status||a.status>=200&&a.status<300){const h=e.getType();try{let d;h=="text"||h=="json"?d=a.responseText:h=="xml"?d=a.responseXML||a.responseText:h=="arraybuffer"&&(d=a.response),d?s(e.readFeatures(d,{extent:t,featureProjection:r}),e.readProjection(d)):o()}catch{o()}}else o()},a.onerror=o,a.send()}function uA(n,e){return function(t,i,r,s,o){K6(n,e,t,i,r,(a,u)=>{this.addFeatures(a),s!==void 0&&s(a)},()=>{this.changed(),o!==void 0&&o()})}}function H6(n,e){return[[-1/0,-1/0,1/0,1/0]]}function q6(n,e,t,i){const r=[];let s=Xi();for(let o=0,a=t.length;o<a;++o){const u=t[o];s=Vw(n,e,u[0],i),r.push((s[0]+s[2])/2,(s[1]+s[3])/2),e=u[u.length-1]}return r}function nx(n,e,t,i,r,s,o){let a,u,h,d,g,m,v;const y=r[s+1],T=[];for(let P=0,M=t.length;P<M;++P){const k=t[P];for(d=n[k-i],m=n[k-i+1],a=e;a<k;a+=i)g=n[a],v=n[a+1],(y<=m&&v<=y||m<=y&&y<=v)&&(h=(y-m)/(v-m)*(g-d)+d,T.push(h)),d=g,m=v}let w=NaN,A=-1/0;for(T.sort(fo),d=T[0],a=1,u=T.length;a<u;++a){g=T[a];const P=Math.abs(g-d);P>A&&(h=(d+g)/2,Xw(n,e,t,i,h,y)&&(w=h,A=P)),d=g}return isNaN(w)&&(w=r[s]),o?(o.push(w,y,A),o):[w,y,A]}function X6(n,e,t,i,r){let s=[];for(let o=0,a=t.length;o<a;++o){const u=t[o];s=nx(n,e,u,i,r,2*o,s),e=u[u.length-1]}return s}function Y6(n,e,t,i){for(;e<t-i;){for(let r=0;r<i;++r){const s=n[e+r];n[e+r]=n[t-i+r],n[t-i+r]=s}e+=i,t-=i}}function ix(n,e,t,i){let r=0,s=n[t-i],o=n[t-i+1];for(;e<t;e+=i){const a=n[e],u=n[e+1];r+=(a-s)*(u+o),s=a,o=u}return r===0?void 0:r>0}function Db(n,e,t,i,r){r=r!==void 0?r:!1;for(let s=0,o=t.length;s<o;++s){const a=t[s],u=ix(n,e,a,i);if(s===0){if(r&&u||!r&&!u)return!1}else if(r&&!u||!r&&u)return!1;e=a}return!0}function Fne(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const a=t[s];if(!Db(n,e,a,i,r))return!1;a.length&&(e=a[a.length-1])}return!0}function fE(n,e,t,i,r){r=r!==void 0?r:!1;for(let s=0,o=t.length;s<o;++s){const a=t[s],u=ix(n,e,a,i);(s===0?r&&u||!r&&!u:r&&!u||!r&&u)&&Y6(n,e,a,i),e=a}return e}function Gne(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s)e=fE(n,e,t[s],i,r);return e}function Z6(n,e){const t=[];let i=0,r=0,s;for(let o=0,a=e.length;o<a;++o){const u=e[o],h=ix(n,i,u,2);if(s===void 0&&(s=h),h===s)t.push(e.slice(r,o+1));else{if(t.length===0)continue;t[t.length-1].push(e[r])}r=o+1,i=u}return t}function Nb(n,e,t,i){let r=0;const s=n[t-i],o=n[t-i+1];let a=0,u=0;for(;e<t;e+=i){const h=n[e]-s,d=n[e+1]-o;r+=u*h-a*d,a=h,u=d}return r/2}function Ob(n,e,t,i){let r=0;for(let s=0,o=t.length;s<o;++s){const a=t[s];r+=Nb(n,e,a,i),e=a}return r}function jne(n,e,t,i){let r=0;for(let s=0,o=t.length;s<o;++s){const a=t[s];r+=Ob(n,e,a,i),e=a[a.length-1]}return r}class Vf extends S0{constructor(e,t){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}clone(){return new Vf(this.flatCoordinates.slice(),this.layout)}closestPointXY(e,t,i,r){return r<Ow(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Kw(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Hw(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,t,i,r))}getArea(){return Nb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return Ul(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(e){const t=[];return t.length=I0(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new Vf(t,"XY")}getType(){return"LinearRing"}intersectsExtent(e){return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=qw(this.flatCoordinates,0,e,this.stride),this.changed()}}class nu extends S0{constructor(e,t,i){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,t!==void 0&&i?(this.setFlatCoordinates(t,e),this.ends_=i):this.setCoordinates(e,t)}appendLinearRing(e){this.flatCoordinates?g0(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new nu(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,i,r){return r<Ow(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(db(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),fb(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,t,i,r))}containsXY(e,t){return Xw(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,t)}getArea(){return Ob(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),fE(t,0,this.ends_,this.stride,e)):t=this.flatCoordinates,c_(t,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const e=Jl(this.getExtent());this.flatInteriorPoint_=nx(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new d_(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(e){return e<0||this.ends_.length<=e?null:new Vf(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLinearRings(){const e=this.layout,t=this.flatCoordinates,i=this.ends_,r=[];let s=0;for(let o=0,a=i.length;o<a;++o){const u=i[o],h=new Vf(t.slice(s,u),e);r.push(h),s=u}return r}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;Db(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=fE(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],i=[];return t.length=Yw(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(e),t,0,i),new nu(t,"XY",i)}getType(){return"Polygon"}intersectsExtent(e){return _b(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=gb(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}}function cA(n){if(E0(n))throw new Error("Cannot create polygon from empty extent");const e=n[0],t=n[1],i=n[2],r=n[3],s=[e,t,e,r,i,r,i,t,e,t];return new nu(s,"XY",[s.length])}const hA=Xr();class Ur{constructor(e,t,i,r,s,o){this.styleFunction,this.extent_,this.id_=o,this.type_=e,this.flatCoordinates_=t,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=i||null,this.properties_=s,this.squaredTolerance_,this.stride_=r,this.simplifiedGeometry_}get(e){return this.properties_[e]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?HM(this.flatCoordinates_):Vw(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const e=Jl(this.getExtent());this.flatInteriorPoints_=nx(this.flatCoordinates_,0,this.ends_,2,e,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const e=Z6(this.flatCoordinates_,this.ends_),t=q6(this.flatCoordinates_,0,e,2);this.flatInteriorPoints_=X6(this.flatCoordinates_,0,e,2,t)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=lE(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const e=this.flatCoordinates_;let t=0;const i=this.ends_;for(let r=0,s=i.length;r<s;++r){const o=i[r],a=lE(e,t,o,2,.5);g0(this.flatMidpoints_,a),t=o}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(e){return this}simplifyTransformed(e,t){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(e){e=An(e);const t=e.getExtent(),i=e.getWorldExtent();if(t&&i){const r=Jn(i)/Jn(t);vo(hA,i[0],i[3],r,-r,0,0,0),Ra(this.flatCoordinates_,0,this.flatCoordinates_.length,2,hA,this.flatCoordinates_)}}applyTransform(e){e(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new Ur(this.type_,this.flatCoordinates_.slice(),this.ends_?.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=BM((e,t)=>{if(e===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),t&&this.simplifiedGeometry_.applyTransform(t);const i=this.simplifiedGeometry_.getFlatCoordinates();let r;switch(this.type_){case"LineString":i.length=I0(i,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,e,i,0),r=[i.length];break;case"MultiLineString":r=[],i.length=s6(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,e,i,0,r);break;case"Polygon":r=[],i.length=Yw(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(e),i,0,r);break}return r&&(this.simplifiedGeometry_=new Ur(this.type_,i,r,2,this.properties_,this.id_)),this.squaredTolerance_=e,this.simplifiedGeometry_}),this}}Ur.prototype.getFlatCoordinates=Ur.prototype.getOrientedFlatCoordinates;function Vb(n,e,t=0,i=n.length-1,r=Q6){for(;i>t;){if(i-t>600){const u=i-t+1,h=e-t+1,d=Math.log(u),g=.5*Math.exp(2*d/3),m=.5*Math.sqrt(d*g*(u-g)/u)*(h-u/2<0?-1:1),v=Math.max(t,Math.floor(e-h*g/u+m)),y=Math.min(i,Math.floor(e+(u-h)*g/u+m));Vb(n,e,v,y,r)}const s=n[e];let o=t,a=i;for(Ld(n,t,e),r(n[i],s)>0&&Ld(n,t,i);o<a;){for(Ld(n,o,a),o++,a--;r(n[o],s)<0;)o++;for(;r(n[a],s)>0;)a--}r(n[t],s)===0?Ld(n,t,a):(a++,Ld(n,a,i)),a<=e&&(t=a+1),e<=a&&(i=a-1)}}function Ld(n,e,t){const i=n[e];n[e]=n[t],n[t]=i}function Q6(n,e){return n<e?-1:n>e?1:0}let Fb=class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data;const i=[];if(!hp(e,t))return i;const r=this.toBBox,s=[];for(;t;){for(let o=0;o<t.children.length;o++){const a=t.children[o],u=t.leaf?r(a):a;hp(e,u)&&(t.leaf?i.push(a):t1(e,u)?this._all(a,i):s.push(a))}t=s.pop()}return i}collides(e){let t=this.data;if(!hp(e,t))return!1;const i=[];for(;t;){for(let r=0;r<t.children.length;r++){const s=t.children[r],o=t.leaf?this.toBBox(s):s;if(hp(e,o)){if(t.leaf||t1(e,o))return!0;i.push(s)}}t=i.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let i=0;i<e.length;i++)this.insert(e[i]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=t;else if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const i=this.data;this.data=t,t=i}this._insert(t,this.data.height-t.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=Ic([]),this}remove(e,t){if(!e)return this;let i=this.data;const r=this.toBBox(e),s=[],o=[];let a,u,h;for(;i||s.length;){if(i||(i=s.pop(),u=s[s.length-1],a=o.pop(),h=!0),i.leaf){const d=J6(e,i.children,t);if(d!==-1)return i.children.splice(d,1),s.push(i),this._condense(s),this}!h&&!i.leaf&&t1(i,r)?(s.push(i),o.push(a),a=0,u=i,i=i.children[0]):u?(a++,i=u.children[a],h=!1):i=null}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){const i=[];for(;e;)e.leaf?t.push(...e.children):i.push(...e.children),e=i.pop();return t}_build(e,t,i,r){const s=i-t+1;let o=this._maxEntries,a;if(s<=o)return a=Ic(e.slice(t,i+1)),dc(a,this.toBBox),a;r||(r=Math.ceil(Math.log(s)/Math.log(o)),o=Math.ceil(s/Math.pow(o,r-1))),a=Ic([]),a.leaf=!1,a.height=r;const u=Math.ceil(s/o),h=u*Math.ceil(Math.sqrt(o));dA(e,t,i,h,this.compareMinX);for(let d=t;d<=i;d+=h){const g=Math.min(d+h-1,i);dA(e,d,g,u,this.compareMinY);for(let m=d;m<=g;m+=u){const v=Math.min(m+u-1,g);a.children.push(this._build(e,m,v,r-1))}}return dc(a,this.toBBox),a}_chooseSubtree(e,t,i,r){for(;r.push(t),!(t.leaf||r.length-1===i);){let s=1/0,o=1/0,a;for(let u=0;u<t.children.length;u++){const h=t.children[u],d=e1(h),g=nV(e,h)-d;g<o?(o=g,s=d<s?d:s,a=h):g===o&&d<s&&(s=d,a=h)}t=a||t.children[0]}return t}_insert(e,t,i){const r=i?e:this.toBBox(e),s=[],o=this._chooseSubtree(r,this.data,t,s);for(o.children.push(e),zd(o,r);t>=0&&s[t].children.length>this._maxEntries;)this._split(s,t),t--;this._adjustParentBBoxes(r,s,t)}_split(e,t){const i=e[t],r=i.children.length,s=this._minEntries;this._chooseSplitAxis(i,s,r);const o=this._chooseSplitIndex(i,s,r),a=Ic(i.children.splice(o,i.children.length-o));a.height=i.height,a.leaf=i.leaf,dc(i,this.toBBox),dc(a,this.toBBox),t?e[t-1].children.push(a):this._splitRoot(i,a)}_splitRoot(e,t){this.data=Ic([e,t]),this.data.height=e.height+1,this.data.leaf=!1,dc(this.data,this.toBBox)}_chooseSplitIndex(e,t,i){let r,s=1/0,o=1/0;for(let a=t;a<=i-t;a++){const u=Bd(e,0,a,this.toBBox),h=Bd(e,a,i,this.toBBox),d=iV(u,h),g=e1(u)+e1(h);d<s?(s=d,r=a,o=g<o?g:o):d===s&&g<o&&(o=g,r=a)}return r||i-t}_chooseSplitAxis(e,t,i){const r=e.leaf?this.compareMinX:eV,s=e.leaf?this.compareMinY:tV,o=this._allDistMargin(e,t,i,r),a=this._allDistMargin(e,t,i,s);o<a&&e.children.sort(r)}_allDistMargin(e,t,i,r){e.children.sort(r);const s=this.toBBox,o=Bd(e,0,t,s),a=Bd(e,i-t,i,s);let u=cp(o)+cp(a);for(let h=t;h<i-t;h++){const d=e.children[h];zd(o,e.leaf?s(d):d),u+=cp(o)}for(let h=i-t-1;h>=t;h--){const d=e.children[h];zd(a,e.leaf?s(d):d),u+=cp(a)}return u}_adjustParentBBoxes(e,t,i){for(let r=i;r>=0;r--)zd(t[r],e)}_condense(e){for(let t=e.length-1,i;t>=0;t--)e[t].children.length===0?t>0?(i=e[t-1].children,i.splice(i.indexOf(e[t]),1)):this.clear():dc(e[t],this.toBBox)}};function J6(n,e,t){if(!t)return e.indexOf(n);for(let i=0;i<e.length;i++)if(t(n,e[i]))return i;return-1}function dc(n,e){Bd(n,0,n.children.length,e,n)}function Bd(n,e,t,i,r){r||(r=Ic(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(let s=e;s<t;s++){const o=n.children[s];zd(r,n.leaf?i(o):o)}return r}function zd(n,e){return n.minX=Math.min(n.minX,e.minX),n.minY=Math.min(n.minY,e.minY),n.maxX=Math.max(n.maxX,e.maxX),n.maxY=Math.max(n.maxY,e.maxY),n}function eV(n,e){return n.minX-e.minX}function tV(n,e){return n.minY-e.minY}function e1(n){return(n.maxX-n.minX)*(n.maxY-n.minY)}function cp(n){return n.maxX-n.minX+(n.maxY-n.minY)}function nV(n,e){return(Math.max(e.maxX,n.maxX)-Math.min(e.minX,n.minX))*(Math.max(e.maxY,n.maxY)-Math.min(e.minY,n.minY))}function iV(n,e){const t=Math.max(n.minX,e.minX),i=Math.max(n.minY,e.minY),r=Math.min(n.maxX,e.maxX),s=Math.min(n.maxY,e.maxY);return Math.max(0,r-t)*Math.max(0,s-i)}function t1(n,e){return n.minX<=e.minX&&n.minY<=e.minY&&e.maxX<=n.maxX&&e.maxY<=n.maxY}function hp(n,e){return e.minX<=n.maxX&&e.minY<=n.maxY&&e.maxX>=n.minX&&e.maxY>=n.minY}function Ic(n){return{children:n,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function dA(n,e,t,i,r){const s=[e,t];for(;s.length;){if(t=s.pop(),e=s.pop(),t-e<=i)continue;const o=e+Math.ceil((t-e)/i/2)*i;Vb(n,o,e,t,r),s.push(e,o,o,t)}}class fA{constructor(e){this.rbush_=new Fb(e),this.items_={}}insert(e,t){const i={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:t};this.rbush_.insert(i),this.items_[ut(t)]=i}load(e,t){const i=new Array(t.length);for(let r=0,s=t.length;r<s;r++){const o=e[r],a=t[r],u={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:a};i[r]=u,this.items_[ut(a)]=u}this.rbush_.load(i)}remove(e){const t=ut(e),i=this.items_[t];return delete this.items_[t],this.rbush_.remove(i)!==null}update(e,t){const i=this.items_[ut(t)],r=[i.minX,i.minY,i.maxX,i.maxY];Lf(r,e)||(this.remove(t),this.insert(e,t))}getAll(){return this.rbush_.all().map(function(t){return t.value})}getInExtent(e){const t={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this.rbush_.search(t).map(function(r){return r.value})}forEach(e){return this.forEach_(this.getAll(),e)}forEachInExtent(e,t){return this.forEach_(this.getInExtent(e),t)}forEach_(e,t){let i;for(let r=0,s=e.length;r<s;r++)if(i=t(e[r]),i)return i;return i}isEmpty(){return oh(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(e){const t=this.rbush_.toJSON();return Da(t.minX,t.minY,t.maxX,t.maxY,e)}concat(e){this.rbush_.load(e.rbush_.all());for(const t in e.items_)this.items_[t]=e.items_[t]}}class Gb extends Vs{constructor(e){super(),this.projection=An(e.projection),this.attributions_=gA(e.attributions),this.attributionsCollapsible_=e.attributionsCollapsible??!0,this.loading=!1,this.state_=e.state!==void 0?e.state:"ready",this.wrapX_=e.wrapX!==void 0?e.wrapX:!1,this.interpolate_=!!e.interpolate,this.viewResolver=null,this.viewRejector=null;const t=this;this.viewPromise_=new Promise(function(i,r){t.viewResolver=i,t.viewRejector=r})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(e){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(e){this.attributions_=gA(e),this.changed()}setState(e){this.state_=e,this.changed()}}function gA(n){return n?typeof n=="function"?n:(Array.isArray(n)||(n=[n]),e=>n):null}const gr={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};class ea extends Ao{constructor(e,t,i){super(e),this.feature=t,this.features=i}}class jb extends Gb{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:e.wrapX!==void 0?e.wrapX:!0}),this.on,this.once,this.un,this.loader_=Mf,this.format_=e.format||null,this.overlaps_=e.overlaps===void 0?!0:e.overlaps,this.url_=e.url,e.loader!==void 0?this.loader_=e.loader:this.url_!==void 0&&(pt(this.format_,"`format` must be set when `url` is set"),this.loader_=uA(this.url_,this.format_)),this.strategy_=e.strategy!==void 0?e.strategy:H6;const t=e.useSpatialIndex!==void 0?e.useSpatialIndex:!0;this.featuresRtree_=t?new fA:null,this.loadedExtentsRtree_=new fA,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let i,r;Array.isArray(e.features)?r=e.features:e.features&&(i=e.features,r=i.getArray()),!t&&i===void 0&&(i=new vr(r)),r!==void 0&&this.addFeaturesInternal(r),i!==void 0&&this.bindFeaturesCollection_(i)}addFeature(e){this.addFeatureInternal(e),this.changed()}addFeatureInternal(e){const t=ut(e);if(!this.addToIndex_(t,e)){this.featuresCollection_&&this.featuresCollection_.remove(e);return}this.setupChangeEvents_(t,e);const i=e.getGeometry();if(i){const r=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(r,e)}else this.nullGeometryFeatures_[t]=e;this.dispatchEvent(new ea(gr.ADDFEATURE,e))}setupChangeEvents_(e,t){t instanceof Ur||(this.featureChangeKeys_[e]=[lt(t,qe.CHANGE,this.handleFeatureChange_,this),lt(t,sh.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(e,t){let i=!0;if(t.getId()!==void 0){const r=String(t.getId());if(!(r in this.idIndex_))this.idIndex_[r]=t;else if(t instanceof Ur){const s=this.idIndex_[r];s instanceof Ur?Array.isArray(s)?s.push(t):this.idIndex_[r]=[s,t]:i=!1}else i=!1}return i&&(pt(!(e in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[e]=t),i}addFeatures(e){this.addFeaturesInternal(e),this.changed()}addFeaturesInternal(e){const t=[],i=[],r=[];for(let s=0,o=e.length;s<o;s++){const a=e[s],u=ut(a);this.addToIndex_(u,a)&&i.push(a)}for(let s=0,o=i.length;s<o;s++){const a=i[s],u=ut(a);this.setupChangeEvents_(u,a);const h=a.getGeometry();if(h){const d=h.getExtent();t.push(d),r.push(a)}else this.nullGeometryFeatures_[u]=a}if(this.featuresRtree_&&this.featuresRtree_.load(t,r),this.hasListener(gr.ADDFEATURE))for(let s=0,o=i.length;s<o;s++)this.dispatchEvent(new ea(gr.ADDFEATURE,i[s]))}bindFeaturesCollection_(e){let t=!1;this.addEventListener(gr.ADDFEATURE,function(i){t||(t=!0,e.push(i.feature),t=!1)}),this.addEventListener(gr.REMOVEFEATURE,function(i){t||(t=!0,e.remove(i.feature),t=!1)}),e.addEventListener(Si.ADD,i=>{t||(t=!0,this.addFeature(i.element),t=!1)}),e.addEventListener(Si.REMOVE,i=>{t||(t=!0,this.removeFeature(i.element),t=!1)}),this.featuresCollection_=e}clear(e){if(e){for(const i in this.featureChangeKeys_)this.featureChangeKeys_[i].forEach(Vt);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(i=>{this.removeFeatureInternal(i)});for(const i in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[i])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const t=new ea(gr.CLEAR);this.dispatchEvent(t),this.changed()}forEachFeature(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureAtCoordinateDirect(e,t){const i=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(i,function(r){const s=r.getGeometry();if(s instanceof Ur||s.intersectsCoordinate(e))return t(r)})}forEachFeatureInExtent(e,t){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureIntersectingExtent(e,t){return this.forEachFeatureInExtent(e,function(i){const r=i.getGeometry();if(r instanceof Ur||r.intersectsExtent(e)){const s=t(i);if(s)return s}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let e;return this.featuresCollection_?e=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(e=this.featuresRtree_.getAll(),oh(this.nullGeometryFeatures_)||g0(e,Object.values(this.nullGeometryFeatures_))),e}getFeaturesAtCoordinate(e){const t=[];return this.forEachFeatureAtCoordinateDirect(e,function(i){t.push(i)}),t}getFeaturesInExtent(e,t){if(this.featuresRtree_){if(!(t&&t.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(e);const r=QM(e,t);return[].concat(...r.map(s=>this.featuresRtree_.getInExtent(s)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(e,t){const i=e[0],r=e[1];let s=null;const o=[NaN,NaN];let a=1/0;const u=[-1/0,-1/0,1/0,1/0];return t=t||Cf,this.featuresRtree_.forEachInExtent(u,function(h){if(t(h)){const d=h.getGeometry(),g=a;if(a=d instanceof Ur?0:d.closestPointXY(i,r,o,a),a<g){s=h;const m=Math.sqrt(a);u[0]=i-m,u[1]=r-m,u[2]=i+m,u[3]=r+m}}}),s}getExtent(e){return this.featuresRtree_.getExtent(e)}getFeatureById(e){const t=this.idIndex_[e.toString()];return t!==void 0?t:null}getFeatureByUid(e){const t=this.uidIndex_[e];return t!==void 0?t:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(e){const t=e.target,i=ut(t),r=t.getGeometry();if(!r)i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(t),this.nullGeometryFeatures_[i]=t);else{const o=r.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(o,t)):this.featuresRtree_&&this.featuresRtree_.update(o,t)}const s=t.getId();if(s!==void 0){const o=s.toString();this.idIndex_[o]!==t&&(this.removeFromIdIndex_(t),this.idIndex_[o]=t)}else this.removeFromIdIndex_(t),this.uidIndex_[i]=t;this.changed(),this.dispatchEvent(new ea(gr.CHANGEFEATURE,t))}hasFeature(e){const t=e.getId();return t!==void 0?t in this.idIndex_:ut(e)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&oh(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(e,t,i){const r=this.loadedExtentsRtree_,s=this.strategy_(e,t,i);for(let o=0,a=s.length;o<a;++o){const u=s[o];r.forEachInExtent(u,function(d){return Ud(d.extent,u)})||(++this.loadingExtentsCount_,this.dispatchEvent(new ea(gr.FEATURESLOADSTART)),this.loader_.call(this,u,t,i,d=>{--this.loadingExtentsCount_,this.dispatchEvent(new ea(gr.FEATURESLOADEND,void 0,d))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new ea(gr.FEATURESLOADERROR))}),r.insert(u,{extent:u.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(e){const t=this.loadedExtentsRtree_,i=t.forEachInExtent(e,function(r){if(Lf(r.extent,e))return r});i&&t.remove(i)}removeFeatures(e){let t=!1;for(let i=0,r=e.length;i<r;++i)t=this.removeFeatureInternal(e[i])||t;t&&this.changed()}removeFeature(e){if(!e)return;this.removeFeatureInternal(e)&&this.changed()}removeFeatureInternal(e){const t=ut(e);if(!(t in this.uidIndex_))return!1;t in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[t]:this.featuresRtree_&&this.featuresRtree_.remove(e),this.featureChangeKeys_[t]?.forEach(Vt),delete this.featureChangeKeys_[t];const r=e.getId();if(r!==void 0){const s=r.toString(),o=this.idIndex_[s];o===e?delete this.idIndex_[s]:Array.isArray(o)&&(o.splice(o.indexOf(e),1),o.length===1&&(this.idIndex_[s]=o[0]))}return delete this.uidIndex_[t],this.hasListener(gr.REMOVEFEATURE)&&this.dispatchEvent(new ea(gr.REMOVEFEATURE,e)),!0}removeFromIdIndex_(e){for(const t in this.idIndex_)if(this.idIndex_[t]===e){delete this.idIndex_[t];break}}setLoader(e){this.loader_=e}setUrl(e){pt(this.format_,"`format` must be set when `url` is set"),this.url_=e,this.setLoader(uA(e,this.format_))}setOverlaps(e){this.overlaps_=e,this.changed()}}class Wr{constructor(e){e=e||{},this.patternImage_=null,this.color_=null,e.color!==void 0&&this.setColor(e.color)}clone(){const e=this.getColor();return new Wr({color:Array.isArray(e)?e.slice():e||void 0})}getColor(){return this.color_}setColor(e){if(e!==null&&typeof e=="object"&&"src"in e){const t=g_(null,e.src,"anonymous",void 0,e.offset?null:e.color?e.color:null,!(e.offset&&e.size));t.ready().then(()=>{this.patternImage_=null}),t.getImageState()===ze.IDLE&&t.load(),t.getImageState()===ze.LOADING&&(this.patternImage_=t)}this.color_=e}getKey(){const e=this.getColor();return e?e instanceof CanvasPattern||e instanceof CanvasGradient?ut(e):typeof e=="object"&&"src"in e?e.src+":"+e.offset:uh(e).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}class Kr{constructor(e){e=e||{},this.color_=e.color!==void 0?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=e.lineDash!==void 0?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}clone(){const e=this.getColor();return new Kr({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(e){this.color_=e}setLineCap(e){this.lineCap_=e}setLineDash(e){this.lineDash_=e}setLineDashOffset(e){this.lineDashOffset_=e}setLineJoin(e){this.lineJoin_=e}setMiterLimit(e){this.miterLimit_=e}setWidth(e){this.width_=e}}function mA(n){return n[0]>0&&n[1]>0}function rV(n,e,t){return t===void 0&&(t=[0,0]),t[0]=n[0]*e+.5|0,t[1]=n[1]*e+.5|0,t}function Ci(n,e){return Array.isArray(n)?n:(e===void 0?e=[n,n]:(e[0]=n,e[1]=n),e)}class P0{constructor(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=Ci(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new P0({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return at()}getImage(e){return at()}getHitDetectionImage(){return at()}getPixelRatio(e){return 1}getImageState(){return at()}getImageSize(){return at()}getOrigin(){return at()}getSize(){return at()}setDisplacement(e){this.displacement_=e}setOpacity(e){this.opacity_=e}setRotateWithView(e){this.rotateWithView_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=Ci(e)}listenImageChange(e){at()}load(){at()}unlistenImageChange(e){at()}ready(){return Promise.resolve()}}class C0 extends P0{constructor(e){super({opacity:1,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,rotation:e.rotation!==void 0?e.rotation:0,scale:e.scale!==void 0?e.scale:1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=e.fill!==void 0?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius=e.radius,this.radius2_=e.radius2,this.angle_=e.angle!==void 0?e.angle:0,this.stroke_=e.stroke!==void 0?e.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?ze.LOADING:ze.LOADED,this.imageState_===ze.LOADING&&this.ready().then(()=>this.imageState_=ze.LOADED),this.render()}clone(){const e=this.getScale(),t=new C0({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}getAnchor(){const e=this.size_,t=this.getDisplacement(),i=this.getScaleArray();return[e[0]/2-t[0]/i[0],e[1]/2+t[1]/i[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(e){this.fill_=e,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(e){const t=this.fill_?.getKey(),i=`${e},${this.angle_},${this.radius},${this.radius2_},${this.points_},${t}`+Object.values(this.renderOptions_).join(",");let r=wr.get(i,null,null)?.getImage(1);if(!r){const s=this.renderOptions_,o=Math.ceil(s.size*e),a=mn(o,o);this.draw_(s,a,e),r=a.canvas,wr.set(i,null,null,new Ab(r,void 0,null,ze.LOADED,null))}return r}getPixelRatio(e){return e}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e,this.render()}listenImageChange(e){}load(){}unlistenImageChange(e){}calculateLineJoinSize_(e,t,i){if(t===0||this.points_===1/0||e!=="bevel"&&e!=="miter")return t;let r=this.radius,s=this.radius2_===void 0?r:this.radius2_;if(r<s){const B=r;r=s,s=B}const o=this.radius2_===void 0?this.points_:this.points_*2,a=2*Math.PI/o,u=s*Math.sin(a),h=Math.sqrt(s*s-u*u),d=r-h,g=Math.sqrt(u*u+d*d),m=g/u;if(e==="miter"&&m<=i)return m*t;const v=t/2/m,y=t/2*(d/g),w=Math.sqrt((r+v)*(r+v)+y*y)-r;if(this.radius2_===void 0||e==="bevel")return w*2;const A=r*Math.sin(a),P=Math.sqrt(r*r-A*A),M=s-P,N=Math.sqrt(A*A+M*M)/A;if(N<=i){const B=N*t/2-s-r;return 2*Math.max(w,B)}return w*2}createRenderOptions(){let e=ch,t=hh,i=0,r=null,s=0,o,a=0;this.stroke_&&(o=Ts(this.stroke_.getColor()??Df),a=this.stroke_.getWidth()??Of,r=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,t=this.stroke_.getLineJoin()??hh,e=this.stroke_.getLineCap()??ch,i=this.stroke_.getMiterLimit()??kf);const u=this.calculateLineJoinSize_(t,a,i),h=Math.max(this.radius,this.radius2_||0),d=Math.ceil(2*h+u);return{strokeStyle:o,strokeWidth:a,size:d,lineCap:e,lineDash:r,lineDashOffset:s,lineJoin:t,miterLimit:i}}render(){this.renderOptions_=this.createRenderOptions();const e=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[e,e]}draw_(e,t,i){if(t.scale(i,i),t.translate(e.size/2,e.size/2),this.createPath_(t),this.fill_){let r=this.fill_.getColor();r===null&&(r=Ti),t.fillStyle=Ts(r),t.fill()}e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}createHitDetectionCanvas_(e){let t;if(this.fill_){let i=this.fill_.getColor(),r=0;typeof i=="string"&&(i=uh(i)),i===null?r=1:Array.isArray(i)&&(r=i.length===4?i[3]:1),r===0&&(t=mn(e.size,e.size),this.drawHitDetectionCanvas_(e,t))}return t?t.canvas:this.getImage(1)}createPath_(e){let t=this.points_;const i=this.radius;if(t===1/0)e.arc(0,0,i,0,2*Math.PI);else{const r=this.radius2_===void 0?i:this.radius2_;this.radius2_!==void 0&&(t*=2);const s=this.angle_-Math.PI/2,o=2*Math.PI/t;for(let a=0;a<t;a++){const u=s+a*o,h=a%2===0?i:r;e.lineTo(h*Math.cos(u),h*Math.sin(u))}e.closePath()}}drawHitDetectionCanvas_(e,t){t.translate(e.size/2,e.size/2),this.createPath_(t),t.fillStyle=Ti,t.fill(),e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class iu extends C0{constructor(e){e=e||{radius:5},super({points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:e.scale!==void 0?e.scale:1,rotation:e.rotation!==void 0?e.rotation:0,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode})}clone(){const e=this.getScale(),t=new iu({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}setRadius(e){this.radius=e,this.render()}}class Mi{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=pA,e.geometry!==void 0&&this.setGeometry(e.geometry),this.fill_=e.fill!==void 0?e.fill:null,this.image_=e.image!==void 0?e.image:null,this.renderer_=e.renderer!==void 0?e.renderer:null,this.hitDetectionRenderer_=e.hitDetectionRenderer!==void 0?e.hitDetectionRenderer:null,this.stroke_=e.stroke!==void 0?e.stroke:null,this.text_=e.text!==void 0?e.text:null,this.zIndex_=e.zIndex}clone(){let e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new Mi({geometry:e??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(e){this.renderer_=e}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(e){this.fill_=e}getImage(){return this.image_}setImage(e){this.image_=e}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e}getText(){return this.text_}setText(e){this.text_=e}getZIndex(){return this.zIndex_}setGeometry(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(t){return t.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=pA,this.geometry_=e}setZIndex(e){this.zIndex_=e}}function sV(n){let e;if(typeof n=="function")e=n;else{let t;Array.isArray(n)?t=n:(pt(typeof n.getZIndex=="function","Expected an `Style` or an array of `Style`"),t=[n]),e=function(){return t}}return e}let n1=null;function Ub(n,e){if(!n1){const t=new Wr({color:"rgba(255,255,255,0.4)"}),i=new Kr({color:"#3399CC",width:1.25});n1=[new Mi({image:new iu({fill:t,stroke:i,radius:5}),fill:t,stroke:i})]}return n1}function pA(n){return n.getGeometry()}const oV="#333";class rx{constructor(e){e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.keepUpright_=e.keepUpright,this.scale_=e.scale,this.scaleArray_=Ci(e.scale!==void 0?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=e.fill!==void 0?e.fill:new Wr({color:oV}),this.maxAngle_=e.maxAngle!==void 0?e.maxAngle:Math.PI/4,this.placement_=e.placement!==void 0?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=e.stroke!==void 0?e.stroke:null,this.offsetX_=e.offsetX!==void 0?e.offsetX:0,this.offsetY_=e.offsetY!==void 0?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=e.padding===void 0?null:e.padding,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new rx({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()instanceof Wr?this.getFill().clone():this.getFill(),stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(e){this.overflow_=e}setFont(e){this.font_=e}setMaxAngle(e){this.maxAngle_=e}setOffsetX(e){this.offsetX_=e}setOffsetY(e){this.offsetY_=e}setPlacement(e){this.placement_=e}setRepeat(e){this.repeat_=e}setRotateWithView(e){this.rotateWithView_=e}setKeepUpright(e){this.keepUpright_=e}setFill(e){this.fill_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=Ci(e!==void 0?e:1)}setStroke(e){this.stroke_=e}setText(e){this.text_=e}setTextAlign(e){this.textAlign_=e}setJustify(e){this.justify_=e}setTextBaseline(e){this.textBaseline_=e}setBackgroundFill(e){this.backgroundFill_=e}setBackgroundStroke(e){this.backgroundStroke_=e}setPadding(e){this.padding_=e}}const Xn={ANIMATING:0,INTERACTING:1},ke={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},dp=[ke.FILL],wa=[ke.STROKE],$l=[ke.BEGIN_PATH],_A=[ke.CLOSE_PATH];class Eg extends Rb{constructor(e,t,i,r){super(),this.tolerance=e,this.maxExtent=t,this.pixelRatio=r,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(e){const t=this.pixelRatio;return t==1?e:e.map(function(i){return i*t})}appendFlatPointCoordinates(e,t){const i=this.getBufferedMaxExtent(),r=this.tmpCoordinate_,s=this.coordinates;let o=s.length;for(let a=0,u=e.length;a<u;a+=t)r[0]=e[a],r[1]=e[a+1],ah(i,r)&&(s[o++]=r[0],s[o++]=r[1]);return o}appendFlatLineCoordinates(e,t,i,r,s,o){const a=this.coordinates;let u=a.length;const h=this.getBufferedMaxExtent();o&&(t+=r);let d=e[t],g=e[t+1];const m=this.tmpCoordinate_;let v=!0,y,T,w;for(y=t+r;y<i;y+=r)m[0]=e[y],m[1]=e[y+1],w=Q1(h,m),w!==T?(v&&(a[u++]=d,a[u++]=g,v=!1),a[u++]=m[0],a[u++]=m[1]):w===Sn.INTERSECTING?(a[u++]=m[0],a[u++]=m[1],v=!1):v=!0,d=m[0],g=m[1],T=w;return(s&&v||y===t+r)&&(a[u++]=d,a[u++]=g),u}drawCustomCoordinates_(e,t,i,r,s){for(let o=0,a=i.length;o<a;++o){const u=i[o],h=this.appendFlatLineCoordinates(e,t,u,r,!1,!1);s.push(h),t=u}return t}drawCustom(e,t,i,r,s){this.beginGeometry(e,t,s);const o=e.getType(),a=e.getStride(),u=this.coordinates.length;let h,d,g,m,v;switch(o){case"MultiPolygon":h=e.getOrientedFlatCoordinates(),m=[];const y=e.getEndss();v=0;for(let T=0,w=y.length;T<w;++T){const A=[];v=this.drawCustomCoordinates_(h,v,y[T],a,A),m.push(A)}this.instructions.push([ke.CUSTOM,u,m,e,i,eA,s]),this.hitDetectionInstructions.push([ke.CUSTOM,u,m,e,r||i,eA,s]);break;case"Polygon":case"MultiLineString":g=[],h=o=="Polygon"?e.getOrientedFlatCoordinates():e.getFlatCoordinates(),v=this.drawCustomCoordinates_(h,0,e.getEnds(),a,g),this.instructions.push([ke.CUSTOM,u,g,e,i,c_,s]),this.hitDetectionInstructions.push([ke.CUSTOM,u,g,e,r||i,c_,s]);break;case"LineString":case"Circle":h=e.getFlatCoordinates(),d=this.appendFlatLineCoordinates(h,0,h.length,a,!1,!1),this.instructions.push([ke.CUSTOM,u,d,e,i,Ul,s]),this.hitDetectionInstructions.push([ke.CUSTOM,u,d,e,r||i,Ul,s]);break;case"MultiPoint":h=e.getFlatCoordinates(),d=this.appendFlatPointCoordinates(h,a),d>u&&(this.instructions.push([ke.CUSTOM,u,d,e,i,Ul,s]),this.hitDetectionInstructions.push([ke.CUSTOM,u,d,e,r||i,Ul,s]));break;case"Point":h=e.getFlatCoordinates(),this.coordinates.push(h[0],h[1]),d=this.coordinates.length,this.instructions.push([ke.CUSTOM,u,d,e,i,void 0,s]),this.hitDetectionInstructions.push([ke.CUSTOM,u,d,e,r||i,void 0,s]);break}this.endGeometry(t)}beginGeometry(e,t,i){this.beginGeometryInstruction1_=[ke.BEGIN_GEOMETRY,t,0,e,i],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[ke.BEGIN_GEOMETRY,t,0,e,i],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const e=this.hitDetectionInstructions;e.reverse();let t;const i=e.length;let r,s,o=-1;for(t=0;t<i;++t)r=e[t],s=r[0],s==ke.END_GEOMETRY?o=t:s==ke.BEGIN_GEOMETRY&&(r[2]=t,r5(this.hitDetectionInstructions,o,t),o=-1)}fillStyleToState(e,t={}){if(e){const i=e.getColor();t.fillPatternScale=i&&typeof i=="object"&&"src"in i?this.pixelRatio:1,t.fillStyle=Ts(i||Ti)}else t.fillStyle=void 0;return t}strokeStyleToState(e,t={}){if(e){const i=e.getColor();t.strokeStyle=Ts(i||Df);const r=e.getLineCap();t.lineCap=r!==void 0?r:ch;const s=e.getLineDash();t.lineDash=s?s.slice():go;const o=e.getLineDashOffset();t.lineDashOffset=o||mo;const a=e.getLineJoin();t.lineJoin=a!==void 0?a:hh;const u=e.getWidth();t.lineWidth=u!==void 0?u:Of;const h=e.getMiterLimit();t.miterLimit=h!==void 0?h:kf,t.lineWidth>this.maxLineWidth&&(this.maxLineWidth=t.lineWidth,this.bufferedMaxExtent_=null)}else t.strokeStyle=void 0,t.lineCap=void 0,t.lineDash=null,t.lineDashOffset=void 0,t.lineJoin=void 0,t.lineWidth=void 0,t.miterLimit=void 0;return t}setFillStrokeStyle(e,t){const i=this.state;this.fillStyleToState(e,i),this.strokeStyleToState(t,i)}createFill(e){const t=e.fillStyle,i=[ke.SET_FILL_STYLE,t];return typeof t!="string"&&i.push(e.fillPatternScale),i}applyStroke(e){this.instructions.push(this.createStroke(e))}createStroke(e){return[ke.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth*this.pixelRatio,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash?this.applyPixelRatio(e.lineDash):null,e.lineDashOffset*this.pixelRatio]}updateFillStyle(e,t){const i=e.fillStyle;(typeof i!="string"||e.currentFillStyle!=i)&&(this.instructions.push(t.call(this,e)),e.currentFillStyle=i)}updateStrokeStyle(e,t){const i=e.strokeStyle,r=e.lineCap,s=e.lineDash,o=e.lineDashOffset,a=e.lineJoin,u=e.lineWidth,h=e.miterLimit;(e.currentStrokeStyle!=i||e.currentLineCap!=r||s!=e.currentLineDash&&!Wa(e.currentLineDash,s)||e.currentLineDashOffset!=o||e.currentLineJoin!=a||e.currentLineWidth!=u||e.currentMiterLimit!=h)&&(t.call(this,e),e.currentStrokeStyle=i,e.currentLineCap=r,e.currentLineDash=s,e.currentLineDashOffset=o,e.currentLineJoin=a,e.currentLineWidth=u,e.currentMiterLimit=h)}endGeometry(e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const t=[ke.END_GEOMETRY,e];this.instructions.push(t),this.hitDetectionInstructions.push(t)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=WM(this.maxExtent),this.maxLineWidth>0)){const e=this.resolution*(this.maxLineWidth+1)/2;bf(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class aV extends Eg{constructor(e,t,i,r){super(e,t,i,r),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(e,t,i){if(!this.image_||this.maxExtent&&!ah(this.maxExtent,e.getFlatCoordinates()))return;this.beginGeometry(e,t,i);const r=e.getFlatCoordinates(),s=e.getStride(),o=this.coordinates.length,a=this.appendFlatPointCoordinates(r,s);this.instructions.push([ke.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([ke.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}drawMultiPoint(e,t,i){if(!this.image_)return;this.beginGeometry(e,t,i);const r=e.getFlatCoordinates(),s=[];for(let u=0,h=r.length;u<h;u+=e.getStride())(!this.maxExtent||ah(this.maxExtent,r.slice(u,u+2)))&&s.push(r[u],r[u+1]);const o=this.coordinates.length,a=this.appendFlatPointCoordinates(s,2);this.instructions.push([ke.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([ke.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(e,t){const i=e.getAnchor(),r=e.getSize(),s=e.getOrigin();this.imagePixelRatio_=e.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=e.getHitDetectionImage(),this.image_=e.getImage(this.pixelRatio),this.height_=r[1],this.opacity_=e.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=e.getRotateWithView(),this.rotation_=e.getRotation(),this.scale_=e.getScaleArray(),this.width_=r[0],this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}class lV extends Eg{constructor(e,t,i,r){super(e,t,i,r)}drawFlatCoordinates_(e,t,i,r){const s=this.coordinates.length,o=this.appendFlatLineCoordinates(e,t,i,r,!1,!1),a=[ke.MOVE_TO_LINE_TO,s,o];return this.instructions.push(a),this.hitDetectionInstructions.push(a),i}drawLineString(e,t,i){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(e,t,i),this.hitDetectionInstructions.push([ke.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,go,mo],$l);const a=e.getFlatCoordinates(),u=e.getStride();this.drawFlatCoordinates_(a,0,a.length,u),this.hitDetectionInstructions.push(wa),this.endGeometry(t)}drawMultiLineString(e,t,i){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(e,t,i),this.hitDetectionInstructions.push([ke.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,go,mo],$l);const a=e.getEnds(),u=e.getFlatCoordinates(),h=e.getStride();let d=0;for(let g=0,m=a.length;g<m;++g)d=this.drawFlatCoordinates_(u,d,a[g],h);this.hitDetectionInstructions.push(wa),this.endGeometry(t)}finish(){const e=this.state;return e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&this.instructions.push(wa),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(e){e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(wa),e.lastStroke=this.coordinates.length),e.lastStroke=0,super.applyStroke(e),this.instructions.push($l)}}class yA extends Eg{constructor(e,t,i,r){super(e,t,i,r)}drawFlatCoordinatess_(e,t,i,r){const s=this.state,o=s.fillStyle!==void 0,a=s.strokeStyle!==void 0,u=i.length;this.instructions.push($l),this.hitDetectionInstructions.push($l);for(let h=0;h<u;++h){const d=i[h],g=this.coordinates.length,m=this.appendFlatLineCoordinates(e,t,d,r,!0,!a),v=[ke.MOVE_TO_LINE_TO,g,m];this.instructions.push(v),this.hitDetectionInstructions.push(v),a&&(this.instructions.push(_A),this.hitDetectionInstructions.push(_A)),t=d}return o&&(this.instructions.push(dp),this.hitDetectionInstructions.push(dp)),a&&(this.instructions.push(wa),this.hitDetectionInstructions.push(wa)),t}drawCircle(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([ke.SET_FILL_STYLE,Ti]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([ke.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,go,mo]);const a=e.getFlatCoordinates(),u=e.getStride(),h=this.coordinates.length;this.appendFlatLineCoordinates(a,0,a.length,u,!1,!1);const d=[ke.CIRCLE,h];this.instructions.push($l,d),this.hitDetectionInstructions.push($l,d),r.fillStyle!==void 0&&(this.instructions.push(dp),this.hitDetectionInstructions.push(dp)),r.strokeStyle!==void 0&&(this.instructions.push(wa),this.hitDetectionInstructions.push(wa)),this.endGeometry(t)}drawPolygon(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([ke.SET_FILL_STYLE,Ti]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([ke.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,go,mo]);const a=e.getEnds(),u=e.getOrientedFlatCoordinates(),h=e.getStride();this.drawFlatCoordinatess_(u,0,a,h),this.endGeometry(t)}drawMultiPolygon(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([ke.SET_FILL_STYLE,Ti]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([ke.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,go,mo]);const a=e.getEndss(),u=e.getOrientedFlatCoordinates(),h=e.getStride();let d=0;for(let g=0,m=a.length;g<m;++g)d=this.drawFlatCoordinatess_(u,d,a[g],h);this.endGeometry(t)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const e=this.tolerance;if(e!==0){const t=this.coordinates;for(let i=0,r=t.length;i<r;++i)t[i]=Al(t[i],e)}return super.finish()}setFillStrokeStyles_(){const e=this.state;this.updateFillStyle(e,this.createFill),this.updateStrokeStyle(e,this.applyStroke)}}function uV(n,e,t,i,r){const s=[];let o=t,a=0,u=e.slice(t,2);for(;a<n&&o+r<i;){const[h,d]=u.slice(-2),g=e[o+r],m=e[o+r+1],v=Math.sqrt((g-h)*(g-h)+(m-d)*(m-d));if(a+=v,a>=n){const y=(n-a+v)/v,T=$i(h,g,y),w=$i(d,m,y);u.push(T,w),s.push(u),u=[T,w],a==n&&(o+=r),a=0}else if(a<n)u.push(e[o+r],e[o+r+1]),o+=r;else{const y=v-a,T=$i(h,g,y/v),w=$i(d,m,y/v);u.push(T,w),s.push(u),u=[T,w],a=0,o+=r}}return a>0&&s.push(u),s}function cV(n,e,t,i,r){let s=t,o=t,a=0,u=0,h=t,d,g,m,v,y,T,w,A,P,M;for(g=t;g<i;g+=r){const k=e[g],N=e[g+1];y!==void 0&&(P=k-y,M=N-T,v=Math.sqrt(P*P+M*M),w!==void 0&&(u+=m,d=Math.acos((w*P+A*M)/(m*v)),d>n&&(u>a&&(a=u,s=h,o=g),u=0,h=g-r)),m=v,w=P,A=M),y=k,T=N}return u+=v,u>a?[h,g]:[s,o]}const p_={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class hV extends Eg{constructor(e,t,i,r){super(e,t,i,r),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[Ti]={fillStyle:Ti},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const e=super.finish();return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e}drawText(e,t,i){const r=this.textFillState_,s=this.textStrokeState_,o=this.textState_;if(this.text_===""||!o||!r&&!s)return;const a=this.coordinates;let u=a.length;const h=e.getType();let d=null,g=e.getStride();if(o.placement==="line"&&(h=="LineString"||h=="MultiLineString"||h=="Polygon"||h=="MultiPolygon")){if(!Ai(this.maxExtent,e.getExtent()))return;let m;if(d=e.getFlatCoordinates(),h=="LineString")m=[d.length];else if(h=="MultiLineString")m=e.getEnds();else if(h=="Polygon")m=e.getEnds().slice(0,1);else if(h=="MultiPolygon"){const w=e.getEndss();m=[];for(let A=0,P=w.length;A<P;++A)m.push(w[A][0])}this.beginGeometry(e,t,i);const v=o.repeat,y=v?void 0:o.textAlign;let T=0;for(let w=0,A=m.length;w<A;++w){let P;v?P=uV(v*this.resolution,d,T,m[w],g):P=[d.slice(T,m[w])];for(let M=0,k=P.length;M<k;++M){const N=P[M];let B=0,b=N.length;if(y==null){const L=cV(o.maxAngle,N,0,N.length,2);B=L[0],b=L[1]}for(let L=B;L<b;L+=g)a.push(N[L],N[L+1]);const R=a.length;T=m[w],this.drawChars_(u,R),u=R}}this.endGeometry(t)}else{let m=o.overflow?null:[];switch(h){case"Point":case"MultiPoint":d=e.getFlatCoordinates();break;case"LineString":d=e.getFlatMidpoint();break;case"Circle":d=e.getCenter();break;case"MultiLineString":d=e.getFlatMidpoints(),g=2;break;case"Polygon":d=e.getFlatInteriorPoint(),o.overflow||m.push(d[2]/this.resolution),g=3;break;case"MultiPolygon":const k=e.getFlatInteriorPoints();d=[];for(let N=0,B=k.length;N<B;N+=3)o.overflow||m.push(k[N+2]/this.resolution),d.push(k[N],k[N+1]);if(d.length===0)return;g=2;break}const v=this.appendFlatPointCoordinates(d,g);if(v===u)return;if(m&&(v-u)/2!==d.length/g){let k=u/2;m=m.filter((N,B)=>{const b=a[(k+B)*2]===d[B*g]&&a[(k+B)*2+1]===d[B*g+1];return b||--k,b})}this.saveTextStates_();const y=o.backgroundFill?this.createFill(this.fillStyleToState(o.backgroundFill)):null,T=o.backgroundStroke?this.createStroke(this.strokeStyleToState(o.backgroundStroke)):null;this.beginGeometry(e,t,i);let w=o.padding;if(w!=zl&&(o.scale[0]<0||o.scale[1]<0)){let k=o.padding[0],N=o.padding[1],B=o.padding[2],b=o.padding[3];o.scale[0]<0&&(N=-N,b=-b),o.scale[1]<0&&(k=-k,B=-B),w=[k,N,B,b]}const A=this.pixelRatio;this.instructions.push([ke.DRAW_IMAGE,u,v,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,w==zl?zl:w.map(function(k){return k*A}),y,T,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,m]);const P=1/A,M=y?y.slice(0):null;M&&(M[1]=Ti),this.hitDetectionInstructions.push([ke.DRAW_IMAGE,u,v,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[P,P],NaN,this.declutterMode_,this.declutterImageWithText_,w,M,T,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?Ti:this.fillKey_,this.textOffsetX_,this.textOffsetY_,m]),this.endGeometry(t)}}saveTextStates_(){const e=this.textStrokeState_,t=this.textState_,i=this.textFillState_,r=this.strokeKey_;e&&(r in this.strokeStates||(this.strokeStates[r]={strokeStyle:e.strokeStyle,lineCap:e.lineCap,lineDashOffset:e.lineDashOffset,lineWidth:e.lineWidth,lineJoin:e.lineJoin,miterLimit:e.miterLimit,lineDash:e.lineDash}));const s=this.textKey_;s in this.textStates||(this.textStates[s]={font:t.font,textAlign:t.textAlign||Nf,justify:t.justify,textBaseline:t.textBaseline||m_,scale:t.scale});const o=this.fillKey_;i&&(o in this.fillStates||(this.fillStates[o]={fillStyle:i.fillStyle}))}drawChars_(e,t){const i=this.textStrokeState_,r=this.textState_,s=this.strokeKey_,o=this.textKey_,a=this.fillKey_;this.saveTextStates_();const u=this.pixelRatio,h=p_[r.textBaseline],d=this.textOffsetY_*u,g=this.text_,m=i?i.lineWidth*Math.abs(r.scale[0])/2:0;this.instructions.push([ke.DRAW_CHARS,e,t,h,r.overflow,a,r.maxAngle,u,d,s,m*u,g,o,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([ke.DRAW_CHARS,e,t,h,r.overflow,a&&Ti,r.maxAngle,u,d,s,m*u,g,o,1/u,this.declutterMode_,this.textKeepUpright_])}setTextStyle(e,t){let i,r,s;if(!e)this.text_="";else{const o=e.getFill();o?(r=this.textFillState_,r||(r={},this.textFillState_=r),r.fillStyle=Ts(o.getColor()||Ti)):(r=null,this.textFillState_=r);const a=e.getStroke();if(!a)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);const T=a.getLineDash(),w=a.getLineDashOffset(),A=a.getWidth(),P=a.getMiterLimit();s.lineCap=a.getLineCap()||ch,s.lineDash=T?T.slice():go,s.lineDashOffset=w===void 0?mo:w,s.lineJoin=a.getLineJoin()||hh,s.lineWidth=A===void 0?Of:A,s.miterLimit=P===void 0?kf:P,s.strokeStyle=Ts(a.getColor()||Df)}i=this.textState_;const u=e.getFont()||Pb;P6(u);const h=e.getScaleArray();i.overflow=e.getOverflow(),i.font=u,i.maxAngle=e.getMaxAngle(),i.placement=e.getPlacement(),i.textAlign=e.getTextAlign(),i.repeat=e.getRepeat(),i.justify=e.getJustify(),i.textBaseline=e.getTextBaseline()||m_,i.backgroundFill=e.getBackgroundFill(),i.backgroundStroke=e.getBackgroundStroke(),i.padding=e.getPadding()||zl,i.scale=h===void 0?[1,1]:h;const d=e.getOffsetX(),g=e.getOffsetY(),m=e.getRotateWithView(),v=e.getKeepUpright(),y=e.getRotation();this.text_=e.getText()||"",this.textOffsetX_=d===void 0?0:d,this.textOffsetY_=g===void 0?0:g,this.textRotateWithView_=m===void 0?!1:m,this.textKeepUpright_=v===void 0?!0:v,this.textRotation_=y===void 0?0:y,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:ut(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=r&&r.fillStyle?typeof r.fillStyle=="string"?r.fillStyle:"|"+ut(r.fillStyle):""}this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}const dV={Circle:yA,Default:Eg,Image:aV,LineString:lV,Polygon:yA,Text:hV};class fV{constructor(e,t,i,r){this.tolerance_=e,this.maxExtent_=t,this.pixelRatio_=r,this.resolution_=i,this.buildersByZIndex_={}}finish(){const e={};for(const t in this.buildersByZIndex_){e[t]=e[t]||{};const i=this.buildersByZIndex_[t];for(const r in i){const s=i[r].finish();e[t][r]=s}}return e}getBuilder(e,t){const i=e!==void 0?e.toString():"0";let r=this.buildersByZIndex_[i];r===void 0&&(r={},this.buildersByZIndex_[i]=r);let s=r[t];if(s===void 0){const o=dV[t];s=new o(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),r[t]=s}return s}}function gV(n,e,t,i,r,s,o,a,u,h,d,g,m=!0){let v=n[e],y=n[e+1],T=0,w=0,A=0,P=0;function M(){T=v,w=y,e+=i,v=n[e],y=n[e+1],P+=A,A=Math.sqrt((v-T)*(v-T)+(y-w)*(y-w))}do M();while(e<t-i&&P+A<s);let k=A===0?0:(s-P)/A;const N=$i(T,v,k),B=$i(w,y,k),b=e-i,R=P,L=s+a*u(h,r,d);for(;e<t-i&&P+A<L;)M();k=A===0?0:(L-P)/A;const V=$i(T,v,k),F=$i(w,y,k);let U=!1;if(m)if(g){const de=[N,B,V,F];hb(de,0,4,2,g,de,de),U=de[0]>de[2]}else U=N>V;const D=Math.PI,le=[],we=b+i===e;e=b,A=0,P=R,v=n[e],y=n[e+1];let ye;if(we){M(),ye=Math.atan2(y-w,v-T),U&&(ye+=ye>0?-D:D);const de=(V+N)/2,J=(F+B)/2;return le[0]=[de,J,(L-s)/2,ye,r],le}r=r.replace(/\n/g," ");for(let de=0,J=r.length;de<J;){M();let ae=Math.atan2(y-w,v-T);if(U&&(ae+=ae>0?-D:D),ye!==void 0){let Me=ae-ye;if(Me+=Me>D?-2*D:Me<-D?2*D:0,Math.abs(Me)>o)return null}ye=ae;const ie=de;let $=0;for(;de<J;++de){const Me=U?J-de-1:de,Ve=a*u(h,r[Me],d);if(e+i<t&&P+A<s+$+Ve/2)break;$+=Ve}if(de===ie)continue;const K=U?r.substring(J-ie,J-de):r.substring(ie,de);k=A===0?0:(s+$/2-P)/A;const Pe=$i(T,v,k),Ce=$i(w,y,k);le.push([Pe,Ce,$/2,ae,K]),s+=$}return le}class Bb{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(f_(),{get:(e,t)=>{if(typeof f_()[t]=="function")return this.push_(t),this.pushMethodArgs_},set:(e,t,i)=>(this.push_(t,i),!0)})}push_(...e){const t=this.instructions_,i=this.zIndex+this.offset_;t[i]||(t[i]=[]),t[i].push(...e)}pushMethodArgs_=(...e)=>(this.push_(e),this);pushFunction(e){this.push_(e)}getContext(){return this.context_}draw(e){this.instructions_.forEach(t=>{for(let i=0,r=t.length;i<r;++i){const s=t[i];if(typeof s=="function"){s(e);continue}const o=t[++i];if(typeof e[s]=="function")e[s](...o);else{if(typeof o=="function"){e[s]=o(e);continue}e[s]=o}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const fc=Xi(),ta=[],ro=[],so=[],na=[];function vA(n){return n[3].declutterBox}const EA=new RegExp("[-----]");function i1(n,e){return e==="start"?e=EA.test(n)?"right":"left":e==="end"&&(e=EA.test(n)?"left":"right"),p_[e]}function mV(n,e,t){return t>0&&n.push(`
`,""),n.push(e,""),n}function pV(n,e,t){return t%2===0&&(n+=e),n}class _V{constructor(e,t,i,r,s){this.overlaps=i,this.pixelRatio=t,this.resolution=e,this.alignAndScaleFill_,this.instructions=r.instructions,this.coordinates=r.coordinates,this.coordinateCache_={},this.renderedTransform_=Xr(),this.hitDetectionInstructions=r.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=r.fillStates||{},this.strokeStates=r.strokeStates||{},this.textStates=r.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=s?new Bb:null}getZIndexContext(){return this.zIndexContext_}createLabel(e,t,i,r){const s=e+t+i+r;if(this.labels_[s])return this.labels_[s];const o=r?this.strokeStates[r]:null,a=i?this.fillStates[i]:null,u=this.textStates[t],h=this.pixelRatio,d=[u.scale[0]*h,u.scale[1]*h],g=u.justify?p_[u.justify]:i1(Array.isArray(e)?e[0]:e,u.textAlign||Nf),m=r&&o.lineWidth?o.lineWidth:0,v=Array.isArray(e)?e:String(e).split(`
`).reduce(mV,[]),{width:y,height:T,widths:w,heights:A,lineWidths:P}=M6(u,v),M=y+m,k=[],N=(M+2)*d[0],B=(T+m)*d[1],b={width:N<0?Math.floor(N):Math.ceil(N),height:B<0?Math.floor(B):Math.ceil(B),contextInstructions:k};(d[0]!=1||d[1]!=1)&&k.push("scale",d),r&&(k.push("strokeStyle",o.strokeStyle),k.push("lineWidth",m),k.push("lineCap",o.lineCap),k.push("lineJoin",o.lineJoin),k.push("miterLimit",o.miterLimit),k.push("setLineDash",[o.lineDash]),k.push("lineDashOffset",o.lineDashOffset)),i&&k.push("fillStyle",a.fillStyle),k.push("textBaseline","middle"),k.push("textAlign","center");const R=.5-g;let L=g*M+R*m;const V=[],F=[];let U=0,D=0,le=0,we=0,ye;for(let de=0,J=v.length;de<J;de+=2){const ae=v[de];if(ae===`
`){D+=U,U=0,L=g*M+R*m,++we;continue}const ie=v[de+1]||u.font;ie!==ye&&(r&&V.push("font",ie),i&&F.push("font",ie),ye=ie),U=Math.max(U,A[le]);const $=[ae,L+R*w[le]+g*(w[le]-P[we]),.5*(m+U)+D];L+=w[le],r&&V.push("strokeText",$),i&&F.push("fillText",$),++le}return Array.prototype.push.apply(k,V),Array.prototype.push.apply(k,F),this.labels_[s]=b,b}replayTextBackground_(e,t,i,r,s,o,a){e.beginPath(),e.moveTo.apply(e,t),e.lineTo.apply(e,i),e.lineTo.apply(e,r),e.lineTo.apply(e,s),e.lineTo.apply(e,t),o&&(this.alignAndScaleFill_=o[2],e.fillStyle=o[1],this.fill_(e)),a&&(this.setStrokeStyle_(e,a),e.stroke())}calculateImageOrLabelDimensions_(e,t,i,r,s,o,a,u,h,d,g,m,v,y,T,w){a*=m[0],u*=m[1];let A=i-a,P=r-u;const M=s+h>e?e-h:s,k=o+d>t?t-d:o,N=y[3]+M*m[0]+y[1],B=y[0]+k*m[1]+y[2],b=A-y[3],R=P-y[0];(T||g!==0)&&(ta[0]=b,na[0]=b,ta[1]=R,ro[1]=R,ro[0]=b+N,so[0]=ro[0],so[1]=R+B,na[1]=so[1]);let L;return g!==0?(L=vo(Xr(),i,r,1,1,g,-i,-r),In(L,ta),In(L,ro),In(L,so),In(L,na),Da(Math.min(ta[0],ro[0],so[0],na[0]),Math.min(ta[1],ro[1],so[1],na[1]),Math.max(ta[0],ro[0],so[0],na[0]),Math.max(ta[1],ro[1],so[1],na[1]),fc)):Da(Math.min(b,b+N),Math.min(R,R+B),Math.max(b,b+N),Math.max(R,R+B),fc),v&&(A=Math.round(A),P=Math.round(P)),{drawImageX:A,drawImageY:P,drawImageW:M,drawImageH:k,originX:h,originY:d,declutterBox:{minX:fc[0],minY:fc[1],maxX:fc[2],maxY:fc[3],value:w},canvasTransform:L,scale:m}}replayImageOrLabel_(e,t,i,r,s,o,a){const u=!!(o||a),h=r.declutterBox,d=a?a[2]*r.scale[0]/2:0;return h.minX-d<=t[0]&&h.maxX+d>=0&&h.minY-d<=t[1]&&h.maxY+d>=0&&(u&&this.replayTextBackground_(e,ta,ro,so,na,o,a),b6(e,r.canvasTransform,s,i,r.originX,r.originY,r.drawImageW,r.drawImageH,r.drawImageX,r.drawImageY,r.scale)),!0}fill_(e){const t=this.alignAndScaleFill_;if(t){const i=In(this.renderedTransform_,[0,0]),r=512*this.pixelRatio;e.save(),e.translate(i[0]%r,i[1]%r),t!==1&&e.scale(t,t),e.rotate(this.viewRotation_)}e.fill(),t&&e.restore()}setStrokeStyle_(e,t){e.strokeStyle=t[1],t[1]&&(e.lineWidth=t[2],e.lineCap=t[3],e.lineJoin=t[4],e.miterLimit=t[5],e.lineDashOffset=t[7],e.setLineDash(t[6]))}drawLabelWithPointPlacement_(e,t,i,r){const s=this.textStates[t],o=this.createLabel(e,t,r,i),a=this.strokeStates[i],u=this.pixelRatio,h=i1(Array.isArray(e)?e[0]:e,s.textAlign||Nf),d=p_[s.textBaseline||m_],g=a&&a.lineWidth?a.lineWidth:0,m=o.width/u-2*s.scale[0],v=h*m+2*(.5-h)*g,y=d*o.height/u+2*(.5-d)*g;return{label:o,anchorX:v,anchorY:y}}execute_(e,t,i,r,s,o,a,u){const h=this.zIndexContext_;let d;this.pixelCoordinates_&&Wa(i,this.renderedTransform_)?d=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),d=Ra(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),K5(this.renderedTransform_,i));let g=0;const m=r.length;let v=0,y,T,w,A,P,M,k,N,B,b,R,L,V,F=0,U=0;const D=this.coordinateCache_,le=this.viewRotation_,we=Math.round(Math.atan2(-i[1],i[0])*1e12)/1e12,ye={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:le},de=this.instructions!=r||this.overlaps?0:200;let J,ae,ie,$;for(;g<m;){const K=r[g];switch(K[0]){case ke.BEGIN_GEOMETRY:J=K[1],$=K[3],J.getGeometry()?a!==void 0&&!Ai(a,$.getExtent())?g=K[2]+1:++g:g=K[2],h&&(h.zIndex=K[4]);break;case ke.BEGIN_PATH:F>de&&(this.fill_(e),F=0),U>de&&(e.stroke(),U=0),!F&&!U&&(e.beginPath(),P=NaN,M=NaN),++g;break;case ke.CIRCLE:v=K[1];const Ce=d[v],Me=d[v+1],Ve=d[v+2],Ge=d[v+3],Ke=Ve-Ce,Ye=Ge-Me,yt=Math.sqrt(Ke*Ke+Ye*Ye);e.moveTo(Ce+yt,Me),e.arc(Ce,Me,yt,0,2*Math.PI,!0),++g;break;case ke.CLOSE_PATH:e.closePath(),++g;break;case ke.CUSTOM:v=K[1],y=K[2];const Ar=K[3],js=K[4],fi=K[5];ye.geometry=Ar,ye.feature=J,g in D||(D[g]=[]);const gi=D[g];fi?fi(d,v,y,2,gi):(gi[0]=d[v],gi[1]=d[v+1],gi.length=2),h&&(h.zIndex=K[6]),js(gi,ye),++g;break;case ke.DRAW_IMAGE:v=K[1],y=K[2],B=K[3],T=K[4],w=K[5];let Rn=K[6];const Pn=K[7],mi=K[8],er=K[9],Rt=K[10];let vt=K[11];const yn=K[12];let tr=K[13];A=K[14]||"declutter";const Dt=K[15];if(!B&&K.length>=20){b=K[19],R=K[20],L=K[21],V=K[22];const Yt=this.drawLabelWithPointPlacement_(b,R,L,V);B=Yt.label,K[3]=B;const rr=K[23];T=(Yt.anchorX-rr)*this.pixelRatio,K[4]=T;const Cn=K[24];w=(Yt.anchorY-Cn)*this.pixelRatio,K[5]=w,Rn=B.height,K[6]=Rn,tr=B.width,K[13]=tr}let bo;K.length>25&&(bo=K[25]);let nr,Qr,Rr;K.length>17?(nr=K[16],Qr=K[17],Rr=K[18]):(nr=zl,Qr=null,Rr=null),Rt&&we?vt+=le:!Rt&&!we&&(vt-=le);let Jr=0;for(;v<y;v+=2){if(bo&&bo[Jr++]<tr/this.pixelRatio)continue;const Yt=this.calculateImageOrLabelDimensions_(B.width,B.height,d[v],d[v+1],tr,Rn,T,w,mi,er,vt,yn,s,nr,!!Qr||!!Rr,J),rr=[e,t,B,Yt,Pn,Qr,Rr];if(u){let Cn,Zt,Mn;if(Dt){const ct=y-v;if(!Dt[ct]){Dt[ct]={args:rr,declutterMode:A};continue}const rn=Dt[ct];Cn=rn.args,Zt=rn.declutterMode,delete Dt[ct],Mn=vA(Cn)}let bn,vn;if(Cn&&(Zt!=="declutter"||!u.collides(Mn))&&(bn=!0),(A!=="declutter"||!u.collides(Yt.declutterBox))&&(vn=!0),Zt==="declutter"&&A==="declutter"){const ct=bn&&vn;bn=ct,vn=ct}bn&&(Zt!=="none"&&u.insert(Mn),this.replayImageOrLabel_.apply(this,Cn)),vn&&(A!=="none"&&u.insert(Yt.declutterBox),this.replayImageOrLabel_.apply(this,rr))}else this.replayImageOrLabel_.apply(this,rr)}++g;break;case ke.DRAW_CHARS:const Za=K[1],es=K[2],ir=K[3],Cu=K[4];V=K[5];const ts=K[6],Us=K[7],Lo=K[8];L=K[9];const ii=K[10];b=K[11],Array.isArray(b)&&(b=b.reduce(pV,"")),R=K[12];const Bs=[K[13],K[13]];A=K[14]||"declutter";const ns=K[15],is=this.textStates[R],ri=is.font,si=[is.scale[0]*Us,is.scale[1]*Us];let It;ri in this.widths_?It=this.widths_[ri]:(It={},this.widths_[ri]=It);const ko=yb(d,Za,es,2),Pr=Math.abs(si[0])*oA(ri,b,It);if(Cu||Pr<=ko){const Yt=this.textStates[R].textAlign,rr=(ko-Pr)*i1(b,Yt),Cn=gV(d,Za,es,2,b,rr,ts,Math.abs(si[0]),oA,ri,It,we?0:this.viewRotation_,ns);e:if(Cn){const Zt=[];let Mn,bn,vn,ct,rn;if(L)for(Mn=0,bn=Cn.length;Mn<bn;++Mn){rn=Cn[Mn],vn=rn[4],ct=this.createLabel(vn,R,"",L),T=rn[2]+(si[0]<0?-ii:ii),w=ir*ct.height+(.5-ir)*2*ii*si[1]/si[0]-Lo;const cn=this.calculateImageOrLabelDimensions_(ct.width,ct.height,rn[0],rn[1],ct.width,ct.height,T,w,0,0,rn[3],Bs,!1,zl,!1,J);if(u&&A==="declutter"&&u.collides(cn.declutterBox))break e;Zt.push([e,t,ct,cn,1,null,null])}if(V)for(Mn=0,bn=Cn.length;Mn<bn;++Mn){rn=Cn[Mn],vn=rn[4],ct=this.createLabel(vn,R,V,""),T=rn[2],w=ir*ct.height-Lo;const cn=this.calculateImageOrLabelDimensions_(ct.width,ct.height,rn[0],rn[1],ct.width,ct.height,T,w,0,0,rn[3],Bs,!1,zl,!1,J);if(u&&A==="declutter"&&u.collides(cn.declutterBox))break e;Zt.push([e,t,ct,cn,1,null,null])}u&&A!=="none"&&u.load(Zt.map(vA));for(let cn=0,sr=Zt.length;cn<sr;++cn)this.replayImageOrLabel_.apply(this,Zt[cn])}}++g;break;case ke.END_GEOMETRY:if(o!==void 0){J=K[1];const Yt=o(J,$,A);if(Yt)return Yt}++g;break;case ke.FILL:de?F++:this.fill_(e),++g;break;case ke.MOVE_TO_LINE_TO:for(v=K[1],y=K[2],ae=d[v],ie=d[v+1],e.moveTo(ae,ie),P=ae+.5|0,M=ie+.5|0,v+=2;v<y;v+=2)ae=d[v],ie=d[v+1],k=ae+.5|0,N=ie+.5|0,(v==y-2||k!==P||N!==M)&&(e.lineTo(ae,ie),P=k,M=N);++g;break;case ke.SET_FILL_STYLE:this.alignAndScaleFill_=K[2],F&&(this.fill_(e),F=0,U&&(e.stroke(),U=0)),e.fillStyle=K[1],++g;break;case ke.SET_STROKE_STYLE:U&&(e.stroke(),U=0),this.setStrokeStyle_(e,K),++g;break;case ke.STROKE:de?U++:e.stroke(),++g;break;default:++g;break}}F&&this.fill_(e),U&&e.stroke()}execute(e,t,i,r,s,o){this.viewRotation_=r,this.execute_(e,t,i,this.instructions,s,void 0,void 0,o)}executeHitDetection(e,t,i,r,s){return this.viewRotation_=i,this.execute_(e,[e.canvas.width,e.canvas.height],t,this.hitDetectionInstructions,!0,r,s)}}const Nl=["Polygon","Circle","LineString","Image","Text","Default"],zb=["Image","Text"],yV=Nl.filter(n=>!zb.includes(n));class vV{constructor(e,t,i,r,s,o,a){this.maxExtent_=e,this.overlaps_=r,this.pixelRatio_=i,this.resolution_=t,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=Xr(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(s,a)}clip(e,t){const i=this.getClipCoords(t);e.beginPath(),e.moveTo(i[0],i[1]),e.lineTo(i[2],i[3]),e.lineTo(i[4],i[5]),e.lineTo(i[6],i[7]),e.clip()}createExecutors_(e,t){for(const i in e){let r=this.executorsByZIndex_[i];r===void 0&&(r={},this.executorsByZIndex_[i]=r);const s=e[i];for(const o in s){const a=s[o];r[o]=new _V(this.resolution_,this.pixelRatio_,this.overlaps_,a,t)}}}hasExecutors(e){for(const t in this.executorsByZIndex_){const i=this.executorsByZIndex_[t];for(let r=0,s=e.length;r<s;++r)if(e[r]in i)return!0}return!1}forEachFeatureAtCoordinate(e,t,i,r,s,o){r=Math.round(r);const a=r*2+1,u=vo(this.hitDetectionTransform_,r+.5,r+.5,1/t,-1/t,-i,-e[0],-e[1]),h=!this.hitDetectionContext_;h&&(this.hitDetectionContext_=mn(a,a));const d=this.hitDetectionContext_;d.canvas.width!==a||d.canvas.height!==a?(d.canvas.width=a,d.canvas.height=a):h||d.clearRect(0,0,a,a);let g;this.renderBuffer_!==void 0&&(g=Xi(),lf(g,e),bf(g,t*(this.renderBuffer_+r),g));const m=EV(r);let v;function y(N,B,b){const R=d.getImageData(0,0,a,a).data;for(let L=0,V=m.length;L<V;L++)if(R[m[L]]>0){if(!o||b==="none"||v!=="Image"&&v!=="Text"||o.includes(N)){const F=(m[L]-3)/4,U=r-F%a,D=r-(F/a|0),le=s(N,B,U*U+D*D);if(le)return le}d.clearRect(0,0,a,a);break}}const T=Object.keys(this.executorsByZIndex_).map(Number);T.sort(fo);let w,A,P,M,k;for(w=T.length-1;w>=0;--w){const N=T[w].toString();for(P=this.executorsByZIndex_[N],A=Nl.length-1;A>=0;--A)if(v=Nl[A],M=P[v],M!==void 0&&(k=M.executeHitDetection(d,u,i,y,g),k))return k}}getClipCoords(e){const t=this.maxExtent_;if(!t)return null;const i=t[0],r=t[1],s=t[2],o=t[3],a=[i,r,i,o,s,o,s,r];return Ra(a,0,8,2,e,a),a}isEmpty(){return oh(this.executorsByZIndex_)}execute(e,t,i,r,s,o,a){const u=Object.keys(this.executorsByZIndex_).map(Number);u.sort(a?i5:fo),o=o||Nl;const h=Nl.length;for(let d=0,g=u.length;d<g;++d){const m=u[d].toString(),v=this.executorsByZIndex_[m];for(let y=0,T=o.length;y<T;++y){const w=o[y],A=v[w];if(A!==void 0){const P=a===null?void 0:A.getZIndexContext(),M=P?P.getContext():e,k=this.maxExtent_&&w!=="Image"&&w!=="Text";if(k&&(M.save(),this.clip(M,i)),!P||w==="Text"||w==="Image"?A.execute(M,t,i,r,s,a):P.pushFunction(N=>A.execute(N,t,i,r,s,a)),k&&M.restore(),P){P.offset();const N=u[d]*h+Nl.indexOf(w);this.deferredZIndexContexts_[N]||(this.deferredZIndexContexts_[N]=[]),this.deferredZIndexContexts_[N].push(P)}}}}this.renderedContext_=e}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const e=this.deferredZIndexContexts_,t=Object.keys(e).map(Number).sort(fo);for(let i=0,r=t.length;i<r;++i)e[t[i]].forEach(s=>{s.draw(this.renderedContext_),s.clear()}),e[t[i]].length=0}}const r1={};function EV(n){if(r1[n]!==void 0)return r1[n];const e=n*2+1,t=n*n,i=new Array(t+1);for(let s=0;s<=n;++s)for(let o=0;o<=n;++o){const a=s*s+o*o;if(a>t)break;let u=i[a];u||(u=[],i[a]=u),u.push(((n+s)*e+(n+o))*4+3),s>0&&u.push(((n-s)*e+(n+o))*4+3),o>0&&(u.push(((n+s)*e+(n-o))*4+3),s>0&&u.push(((n-s)*e+(n-o))*4+3))}const r=[];for(let s=0,o=i.length;s<o;++s)i[s]&&r.push(...i[s]);return r1[n]=r,r}function wA(n,e,t,i){return t!==void 0&&i!==void 0?[t/n,i/e]:t!==void 0?t/n:i!==void 0?i/e:1}let $b=class Wb extends P0{constructor(e){e=e||{};const t=e.opacity!==void 0?e.opacity:1,i=e.rotation!==void 0?e.rotation:0,r=e.scale!==void 0?e.scale:1,s=e.rotateWithView!==void 0?e.rotateWithView:!1;super({opacity:t,rotation:i,scale:r,displacement:e.displacement!==void 0?e.displacement:[0,0],rotateWithView:s,declutterMode:e.declutterMode}),this.anchor_=e.anchor!==void 0?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=e.anchorOrigin!==void 0?e.anchorOrigin:"top-left",this.anchorXUnits_=e.anchorXUnits!==void 0?e.anchorXUnits:"fraction",this.anchorYUnits_=e.anchorYUnits!==void 0?e.anchorYUnits:"fraction",this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null;const o=e.img!==void 0?e.img:null;let a=e.src;pt(!(a!==void 0&&o),"`image` and `src` cannot be provided at the same time"),(a===void 0||a.length===0)&&o&&(a=o.src||ut(o)),pt(a!==void 0&&a.length>0,"A defined and non-empty `src` or `image` must be provided"),pt(!((e.width!==void 0||e.height!==void 0)&&e.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let u;if(e.src!==void 0?u=ze.IDLE:o!==void 0&&("complete"in o?o.complete?u=o.src?ze.LOADED:ze.IDLE:u=ze.LOADING:u=ze.LOADED),this.color_=e.color!==void 0?uh(e.color):null,this.iconImage_=g_(o,a,this.crossOrigin_,u,this.color_),this.offset_=e.offset!==void 0?e.offset:[0,0],this.offsetOrigin_=e.offsetOrigin!==void 0?e.offsetOrigin:"top-left",this.origin_=null,this.size_=e.size!==void 0?e.size:null,this.initialOptions_,e.width!==void 0||e.height!==void 0){let h,d;if(e.size)[h,d]=e.size;else{const g=this.getImage(1);if(g.width&&g.height)h=g.width,d=g.height;else if(g instanceof HTMLImageElement){this.initialOptions_=e;const m=()=>{if(this.unlistenImageChange(m),!this.initialOptions_)return;const v=this.iconImage_.getSize();this.setScale(wA(v[0],v[1],e.width,e.height))};this.listenImageChange(m);return}}h!==void 0&&this.setScale(wA(h,d,e.width,e.height))}}clone(){let e,t,i;return this.initialOptions_?(t=this.initialOptions_.width,i=this.initialOptions_.height):(e=this.getScale(),e=Array.isArray(e)?e.slice():e),new Wb({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:e,width:t,height:i,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let e=this.normalizedAnchor_;if(!e){e=this.anchor_;const r=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!r)return null;e=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(e[0]*=r[0]),this.anchorYUnits_=="fraction"&&(e[1]*=r[1])}if(this.anchorOrigin_!="top-left"){if(!r)return null;e===this.anchor_&&(e=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(e[0]=-e[0]+r[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(e[1]=-e[1]+r[1])}this.normalizedAnchor_=e}const t=this.getDisplacement(),i=this.getScaleArray();return[e[0]-t[0]/i[0],e[1]+t[1]/i[1]]}setAnchor(e){this.anchor_=e,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(e){return this.iconImage_.getImage(e)}getPixelRatio(e){return this.iconImage_.getPixelRatio(e)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let e=this.offset_;if(this.offsetOrigin_!="top-left"){const t=this.getSize(),i=this.iconImage_.getSize();if(!t||!i)return null;e=e.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(e[0]=i[0]-t[0]-e[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(e[1]=i[1]-t[1]-e[1])}return this.origin_=e,this.origin_}getSrc(){return this.iconImage_.getSrc()}setSrc(e){this.iconImage_=g_(null,e,this.crossOrigin_,ze.IDLE,this.color_)}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const e=this.getScaleArray();if(this.size_)return this.size_[0]*e[0];if(this.iconImage_.getImageState()==ze.LOADED)return this.iconImage_.getSize()[0]*e[0]}getHeight(){const e=this.getScaleArray();if(this.size_)return this.size_[1]*e[1];if(this.iconImage_.getImageState()==ze.LOADED)return this.iconImage_.getSize()[1]*e[1]}setScale(e){delete this.initialOptions_,super.setScale(e)}listenImageChange(e){this.iconImage_.addEventListener(qe.CHANGE,e)}load(){this.iconImage_.load()}unlistenImageChange(e){this.iconImage_.removeEventListener(qe.CHANGE,e)}ready(){return this.iconImage_.ready()}};const xs=.5;function wV(n,e,t,i,r,s,o,a,u){const h=r,d=n[0]*xs,g=n[1]*xs,m=mn(d,g);m.imageSmoothingEnabled=!1;const v=m.canvas,y=new k6(m,xs,r,null,o,a,null),T=t.length,w=Math.floor((256*256*256-1)/T),A={};for(let M=1;M<=T;++M){const k=t[M-1],N=k.getStyleFunction()||i;if(!N)continue;let B=N(k,s);if(!B)continue;Array.isArray(B)||(B=[B]);const R=(M*w).toString(16).padStart(7,"#00000");for(let L=0,V=B.length;L<V;++L){const F=B[L],U=F.getGeometryFunction()(k);if(!U||!Ai(h,U.getExtent()))continue;const D=F.clone(),le=D.getFill();le&&le.setColor(R);const we=D.getStroke();we&&(we.setColor(R),we.setLineDash(null)),D.setText(void 0);const ye=F.getImage();if(ye){const ie=ye.getImageSize();if(!ie)continue;const $=mn(ie[0],ie[1],void 0,{alpha:!1}),K=$.canvas;$.fillStyle=R,$.fillRect(0,0,K.width,K.height),D.setImage(new $b({img:K,anchor:ye.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:ye.getOrigin(),opacity:1,size:ye.getSize(),scale:ye.getScale(),rotation:ye.getRotation(),rotateWithView:ye.getRotateWithView()}))}const de=D.getZIndex()||0;let J=A[de];J||(J={},A[de]=J,J.Polygon=[],J.Circle=[],J.LineString=[],J.Point=[]);const ae=U.getType();if(ae==="GeometryCollection"){const ie=U.getGeometriesArrayRecursive();for(let $=0,K=ie.length;$<K;++$){const Pe=ie[$];J[Pe.getType().replace("Multi","")].push(Pe,D)}}else J[ae.replace("Multi","")].push(U,D)}}const P=Object.keys(A).map(Number).sort(fo);for(let M=0,k=P.length;M<k;++M){const N=A[P[M]];for(const B in N){const b=N[B];for(let R=0,L=b.length;R<L;R+=2){y.setStyle(b[R+1]);for(let V=0,F=e.length;V<F;++V)y.setTransform(e[V]),y.drawGeometry(b[R])}}}return m.getImageData(0,0,v.width,v.height)}function xV(n,e,t){const i=[];if(t){const r=Math.floor(Math.round(n[0])*xs),s=Math.floor(Math.round(n[1])*xs),o=(Lt(r,0,t.width-1)+Lt(s,0,t.height-1)*t.width)*4,a=t.data[o],u=t.data[o+1],d=t.data[o+2]+256*(u+256*a),g=Math.floor((256*256*256-1)/e.length);d&&d%g===0&&i.push(e[d/g-1])}return i}class Kb extends Ao{constructor(e,t,i,r){super(e),this.inversePixelTransform=t,this.frameState=i,this.context=r}}const SV=5;class TV extends pg{constructor(e){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e,this.staleKeys_=new Array,this.maxStaleKeys=SV}getStaleKeys(){return this.staleKeys_}prependStaleKey(e){this.staleKeys_.unshift(e),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(e){return at()}getData(e){return null}prepareFrame(e){return at()}renderFrame(e,t){return at()}forEachFeatureAtCoordinate(e,t,i,r,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(e){const t=e.target;(t.getState()===ze.LOADED||t.getState()===ze.ERROR)&&this.renderIfReadyAndVisible()}loadImage(e){let t=e.getState();return t!=ze.LOADED&&t!=ze.ERROR&&e.addEventListener(qe.CHANGE,this.boundHandleImageChange_),t==ze.IDLE&&(e.load(),t=e.getState()),t==ze.LOADED}renderIfReadyAndVisible(){const e=this.getLayer();e&&e.getVisible()&&e.getSourceState()==="ready"&&e.changed()}renderDeferred(e){}disposeInternal(){delete this.layer_,super.disposeInternal()}}const xA=[];let Ac=null;function IV(){Ac=mn(1,1,void 0,{willReadFrequently:!0})}class Hb extends TV{constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=Xr(),this.pixelTransform=Xr(),this.inversePixelTransform=Xr(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(e,t,i){Ac||IV(),Ac.clearRect(0,0,1,1);let r;try{Ac.drawImage(e,t,i,1,1,0,0,1,1),r=Ac.getImageData(0,0,1,1).data}catch{return Ac=null,null}return r}getBackground(e){let i=this.getLayer().getBackground();return typeof i=="function"&&(i=i(e.viewState.resolution)),i||void 0}useContainer(e,t,i){const r=this.getLayer().getClassName();let s,o;if(e&&e.className===r&&(!i||e&&e.style.backgroundColor&&Wa(uh(e.style.backgroundColor),uh(i)))){const a=e.firstElementChild;Ea(a)&&(o=a.getContext("2d"))}if(o&&Y5(o.canvas.style.transform,t)?(this.container=e,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){s=Wi?Sb():document.createElement("div"),s.className=r;let a=s.style;a.position="absolute",a.width="100%",a.height="100%",o=mn();const u=o.canvas;s.appendChild(u),a=u.style,a.position="absolute",a.left="0",a.transformOrigin="top left",this.container=s,this.context=o}!this.containerReused&&i&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=i)}clipUnrotated(e,t,i){const r=Ka(i),s=v0(i),o=y0(i),a=_0(i);In(t.coordinateToPixelTransform,r),In(t.coordinateToPixelTransform,s),In(t.coordinateToPixelTransform,o),In(t.coordinateToPixelTransform,a);const u=this.inversePixelTransform;In(u,r),In(u,s),In(u,o),In(u,a),e.save(),e.beginPath(),e.moveTo(Math.round(r[0]),Math.round(r[1])),e.lineTo(Math.round(s[0]),Math.round(s[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.lineTo(Math.round(a[0]),Math.round(a[1])),e.clip()}prepareContainer(e,t){const i=e.extent,r=e.viewState.resolution,s=e.viewState.rotation,o=e.pixelRatio,a=Math.round(st(i)/r*o),u=Math.round(Jn(i)/r*o);vo(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/o,1/o,s,-a/2,-u/2),cb(this.inversePixelTransform,this.pixelTransform);const h=X5(this.pixelTransform);if(this.useContainer(t,h,this.getBackground(e)),!this.containerReused){const d=this.context.canvas;d.width!=a||d.height!=u?(d.width=a,d.height=u):this.context.clearRect(0,0,a,u),h!==d.style.transform&&(d.style.transform=h)}}dispatchRenderEvent_(e,t,i){const r=this.getLayer();if(r.hasListener(e)){const s=new Kb(e,this.inversePixelTransform,i,t);r.dispatchEvent(s)}}preRender(e,t){this.frameState=t,!t.declutter&&this.dispatchRenderEvent_(Er.PRERENDER,e,t)}postRender(e,t){t.declutter||this.dispatchRenderEvent_(Er.POSTRENDER,e,t)}renderDeferredInternal(e){}getRenderContext(e){return e.declutter&&!this.deferredContext_&&(this.deferredContext_=new Bb),e.declutter?this.deferredContext_.getContext():this.context}renderDeferred(e){e.declutter&&(this.dispatchRenderEvent_(Er.PRERENDER,this.context,e),e.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(e),this.dispatchRenderEvent_(Er.POSTRENDER,this.context,e))}getRenderTransform(e,t,i,r,s,o,a){const u=s/2,h=o/2,d=r/t,g=-d,m=-e[0]+a,v=-e[1];return vo(this.tempTransform,u,h,d,g,-i,m,v)}disposeInternal(){delete this.frameState,super.disposeInternal()}}class AV extends Hb{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=Xi(),this.wrappedRenderedExtent_=Xi(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(e,t,i){const r=t.extent,s=t.viewState,o=s.center,a=s.resolution,u=s.projection,h=s.rotation,d=u.getExtent(),g=this.getLayer().getSource(),m=this.getLayer().getDeclutter(),v=t.pixelRatio,y=t.viewHints,T=!(y[Xn.ANIMATING]||y[Xn.INTERACTING]),w=this.context,A=Math.round(st(r)/a*v),P=Math.round(Jn(r)/a*v),M=g.getWrapX()&&u.canWrapX(),k=M?st(d):null,N=M?Math.ceil((r[2]-d[2])/k)+1:1;let B=M?Math.floor((r[0]-d[0])/k):0;do{let b=this.getRenderTransform(o,a,0,v,A,P,B*k);t.declutter&&(b=b.slice(0)),e.execute(w,[w.canvas.width,w.canvas.height],b,h,T,i===void 0?Nl:i?zb:yV,i?m&&t.declutter[m]:void 0)}while(++B<N)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=mn(this.context.canvas.width,this.context.canvas.height,xA))}resetDrawContext_(){if(this.opacity_!==1&&this.targetContext_){const e=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=e,A0(this.context),xA.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(e){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,e,!0)}renderDeferredInternal(e){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(e,t){const i=e.layerStatesArray[e.layerIndex];this.opacity_=i.opacity;const r=e.viewState;this.prepareContainer(e,t);const s=this.context,o=this.replayGroup_;let a=o&&!o.isEmpty();if(!a&&!(this.getLayer().hasListener(Er.PRERENDER)||this.getLayer().hasListener(Er.POSTRENDER)))return this.container;if(this.setDrawContext_(),this.preRender(s,e),r.projection,this.clipped_=!1,a&&i.extent&&this.clipping){const u=va(i.extent);a=Ai(u,e.extent),this.clipped_=a&&!Ud(u,e.extent),this.clipped_&&this.clipUnrotated(s,e,u)}return a&&this.renderWorlds(o,e,this.getLayer().getDeclutter()?!1:void 0),!e.declutter&&this.clipped_&&s.restore(),this.postRender(s,e),this.renderedRotation_!==r.rotation&&(this.renderedRotation_=r.rotation,this.hitDetectionImageData_=null),e.declutter||this.resetDrawContext_(),this.container}getFeatures(e){return new Promise(t=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const i=this.frameState.size.slice(),r=this.renderedCenter_,s=this.renderedResolution_,o=this.renderedRotation_,a=this.renderedProjection_,u=this.wrappedRenderedExtent_,h=this.getLayer(),d=[],g=i[0]*xs,m=i[1]*xs;d.push(this.getRenderTransform(r,s,o,xs,g,m,0).slice());const v=h.getSource(),y=a.getExtent();if(v.getWrapX()&&a.canWrapX()&&!Ud(y,u)){let T=u[0];const w=st(y);let A=0,P;for(;T<y[0];)--A,P=w*A,d.push(this.getRenderTransform(r,s,o,xs,g,m,P).slice()),T+=w;for(A=0,T=u[2];T>y[2];)++A,P=w*A,d.push(this.getRenderTransform(r,s,o,xs,g,m,P).slice()),T-=w}this.hitDetectionImageData_=wV(i,d,this.renderedFeatures_,h.getStyleFunction(),u,s,o,aA(s,this.renderedPixelRatio_))}t(xV(e,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(e,t,i,r,s){if(!this.replayGroup_)return;const o=t.viewState.resolution,a=t.viewState.rotation,u=this.getLayer(),h={},d=function(m,v,y){const T=ut(m),w=h[T];if(w){if(w!==!0&&y<w.distanceSq){if(y===0)return h[T]=!0,s.splice(s.lastIndexOf(w),1),r(m,u,v);w.geometry=v,w.distanceSq=y}}else{if(y===0)return h[T]=!0,r(m,u,v);s.push(h[T]={feature:m,layer:u,geometry:v,distanceSq:y,callback:r})}},g=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(e,o,a,i,d,g?t.declutter?.[g]?.all().map(m=>m.value):null)}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}prepareFrame(e){const t=this.getLayer(),i=t.getSource();if(!i)return!1;const r=e.viewHints[Xn.ANIMATING],s=e.viewHints[Xn.INTERACTING],o=t.getUpdateWhileAnimating(),a=t.getUpdateWhileInteracting();if(this.ready&&!o&&r||!a&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const u=e.extent,h=e.viewState,d=h.projection,g=h.resolution,m=e.pixelRatio,v=t.getRevision(),y=t.getRenderBuffer();let T=t.getRenderOrder();T===void 0&&(T=N6);const w=h.center.slice(),A=bf(u,y*g),P=A.slice(),M=[A.slice()],k=d.getExtent();if(i.getWrapX()&&d.canWrapX()&&!Ud(k,e.extent)){const le=st(k),we=Math.max(st(A)/2,le);A[0]=k[0]-we,A[2]=k[2]+we,eb(w,d);const ye=ZM(M[0],d);ye[0]<k[0]&&ye[2]<k[2]?M.push([ye[0]+le,ye[1],ye[2]+le,ye[3]]):ye[0]>k[0]&&ye[2]>k[2]&&M.push([ye[0]-le,ye[1],ye[2]-le,ye[3]])}if(this.ready&&this.renderedResolution_==g&&this.renderedRevision_==v&&this.renderedRenderOrder_==T&&this.renderedFrameDeclutter_===!!e.declutter&&Ud(this.wrappedRenderedExtent_,A))return Wa(this.renderedExtent_,P)||(this.hitDetectionImageData_=null,this.renderedExtent_=P),this.renderedCenter_=w,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const N=new fV(Lb(g,m),A,g,m);let B;for(let le=0,we=M.length;le<we;++le)i.loadFeatures(M[le],g,d);const b=aA(g,m);let R=!0;const L=(le,we)=>{let ye;const de=le.getStyleFunction()||t.getStyleFunction();if(de&&(ye=de(le,g)),ye){const J=this.renderFeature(le,b,ye,N,B,this.getLayer().getDeclutter(),we);R=R&&!J}},V=ub(A),F=i.getFeaturesInExtent(V);T&&F.sort(T);for(let le=0,we=F.length;le<we;++le)L(F[le],le);this.renderedFeatures_=F,this.ready=R;const U=N.finish(),D=new vV(A,g,m,i.getOverlaps(),U,t.getRenderBuffer(),!!e.declutter);return this.renderedResolution_=g,this.renderedRevision_=v,this.renderedRenderOrder_=T,this.renderedFrameDeclutter_=!!e.declutter,this.renderedExtent_=P,this.wrappedRenderedExtent_=A,this.renderedCenter_=w,this.renderedProjection_=d,this.renderedPixelRatio_=m,this.replayGroup_=D,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(e,t,i,r,s,o,a){if(!i)return!1;let u=!1;if(Array.isArray(i))for(let h=0,d=i.length;h<d;++h)u=lA(r,e,i[h],t,this.boundHandleStyleImageChange_,s,o,a)||u;else u=lA(r,e,i,t,this.boundHandleStyleImageChange_,s,o,a);return u}}let Eu=0;const li=1<<Eu++,nt=1<<Eu++,Ii=1<<Eu++,Br=1<<Eu++,ru=1<<Eu++,$d=1<<Eu++,fp=Math.pow(2,Eu)-1,sx={[li]:"boolean",[nt]:"number",[Ii]:"string",[Br]:"color",[ru]:"number[]",[$d]:"size"},RV=Object.keys(sx).map(Number).sort(fo);function PV(n){return n in sx}function Wd(n){const e=[];for(const t of RV)Kd(n,t)&&e.push(sx[t]);return e.length===0?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function Kd(n,e){return(n&e)===e}function ia(n,e){return n===e}class fn{constructor(e,t){if(!PV(e))throw new Error(`literal expressions must have a specific type, got ${Wd(e)}`);this.type=e,this.value=t}}class CV{constructor(e,t,...i){this.type=e,this.operator=t,this.args=i}}function qb(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function jn(n,e,t){switch(typeof n){case"boolean":{if(ia(e,Ii))return new fn(Ii,n?"true":"false");if(!Kd(e,li))throw new Error(`got a boolean, but expected ${Wd(e)}`);return new fn(li,n)}case"number":{if(ia(e,$d))return new fn($d,Ci(n));if(ia(e,li))return new fn(li,!!n);if(ia(e,Ii))return new fn(Ii,n.toString());if(!Kd(e,nt))throw new Error(`got a number, but expected ${Wd(e)}`);return new fn(nt,n)}case"string":{if(ia(e,Br))return new fn(Br,Jw(n));if(ia(e,li))return new fn(li,!!n);if(!Kd(e,Ii))throw new Error(`got a string, but expected ${Wd(e)}`);return new fn(Ii,n)}}if(!Array.isArray(n))throw new Error("expression must be an array or a primitive value");if(n.length===0)throw new Error("empty expression");if(typeof n[0]=="string")return jV(n,e,t);for(const i of n)if(typeof i!="number")throw new Error("expected an array of numbers");if(ia(e,$d)){if(n.length!==2)throw new Error(`expected an array of two values for a size, got ${n.length}`);return new fn($d,n)}if(ia(e,Br)){if(n.length===3)return new fn(Br,[...n,1]);if(n.length===4)return new fn(Br,n);throw new Error(`expected an array of 3 or 4 values for a color, got ${n.length}`)}if(!Kd(e,ru))throw new Error(`got an array of numbers, but expected ${Wd(e)}`);return new fn(ru,n)}const te={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},MV={[te.Get]:Ue(Xe(1,1/0),SA),[te.Var]:Ue(Xe(1,1),bV),[te.Has]:Ue(Xe(1,1/0),SA),[te.Id]:Ue(LV,gc),[te.Concat]:Ue(Xe(2,1/0),dt(Ii)),[te.GeometryType]:Ue(kV,gc),[te.LineMetric]:Ue(gc),[te.Resolution]:Ue(s1,gc),[te.Zoom]:Ue(s1,gc),[te.Time]:Ue(s1,gc),[te.Any]:Ue(Xe(2,1/0),dt(li)),[te.All]:Ue(Xe(2,1/0),dt(li)),[te.Not]:Ue(Xe(1,1),dt(li)),[te.Equal]:Ue(Xe(2,2),dt(fp)),[te.NotEqual]:Ue(Xe(2,2),dt(fp)),[te.GreaterThan]:Ue(Xe(2,2),dt(nt)),[te.GreaterThanOrEqualTo]:Ue(Xe(2,2),dt(nt)),[te.LessThan]:Ue(Xe(2,2),dt(nt)),[te.LessThanOrEqualTo]:Ue(Xe(2,2),dt(nt)),[te.Multiply]:Ue(Xe(2,1/0),TA),[te.Coalesce]:Ue(Xe(2,1/0),TA),[te.Divide]:Ue(Xe(2,2),dt(nt)),[te.Add]:Ue(Xe(2,1/0),dt(nt)),[te.Subtract]:Ue(Xe(2,2),dt(nt)),[te.Clamp]:Ue(Xe(3,3),dt(nt)),[te.Mod]:Ue(Xe(2,2),dt(nt)),[te.Pow]:Ue(Xe(2,2),dt(nt)),[te.Abs]:Ue(Xe(1,1),dt(nt)),[te.Floor]:Ue(Xe(1,1),dt(nt)),[te.Ceil]:Ue(Xe(1,1),dt(nt)),[te.Round]:Ue(Xe(1,1),dt(nt)),[te.Sin]:Ue(Xe(1,1),dt(nt)),[te.Cos]:Ue(Xe(1,1),dt(nt)),[te.Atan]:Ue(Xe(1,2),dt(nt)),[te.Sqrt]:Ue(Xe(1,1),dt(nt)),[te.Match]:Ue(Xe(4,1/0),IA,NV),[te.Between]:Ue(Xe(3,3),dt(nt)),[te.Interpolate]:Ue(Xe(6,1/0),IA,OV),[te.Case]:Ue(Xe(3,1/0),DV,VV),[te.In]:Ue(Xe(2,2),FV),[te.Number]:Ue(Xe(1,1/0),dt(fp)),[te.String]:Ue(Xe(1,1/0),dt(fp)),[te.Array]:Ue(Xe(1,1/0),dt(nt)),[te.Color]:Ue(Xe(1,4),dt(nt)),[te.Band]:Ue(Xe(1,3),dt(nt)),[te.Palette]:Ue(Xe(2,2),GV),[te.ToString]:Ue(Xe(1,1),dt(li|nt|Ii|Br))};function SA(n,e,t){const i=n.length-1,r=new Array(i);for(let s=0;s<i;++s){const o=n[s+1];switch(typeof o){case"number":{r[s]=new fn(nt,o);break}case"string":{r[s]=new fn(Ii,o);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${o}`)}s===0&&t.properties.add(String(o))}return r}function bV(n,e,t){const i=n[1];if(typeof i!="string")throw new Error("expected a string argument for var operation");return t.variables.add(i),[new fn(Ii,i)]}function LV(n,e,t){t.featureId=!0}function kV(n,e,t){t.geometryType=!0}function s1(n,e,t){t.mapState=!0}function gc(n,e,t){const i=n[0];if(n.length!==1)throw new Error(`expected no arguments for ${i} operation`);return[]}function Xe(n,e){return function(t,i,r){const s=t[0],o=t.length-1;if(n===e){if(o!==n){const a=n===1?"":"s";throw new Error(`expected ${n} argument${a} for ${s}, got ${o}`)}}else if(o<n||o>e){const a=e===1/0?`${n} or more`:`${n} to ${e}`;throw new Error(`expected ${a} arguments for ${s}, got ${o}`)}}}function TA(n,e,t){const i=n.length-1,r=new Array(i);for(let s=0;s<i;++s){const o=jn(n[s+1],e,t);r[s]=o}return r}function dt(n){return function(e,t,i){const r=e.length-1,s=new Array(r);for(let o=0;o<r;++o){const a=jn(e[o+1],n,i);s[o]=a}return s}}function DV(n,e,t){const i=n[0],r=n.length-1;if(r%2===0)throw new Error(`expected an odd number of arguments for ${i}, got ${r} instead`)}function IA(n,e,t){const i=n[0],r=n.length-1;if(r%2===1)throw new Error(`expected an even number of arguments for operation ${i}, got ${r} instead`)}function NV(n,e,t){const i=n.length-1,r=Ii|nt|li,s=jn(n[1],r,t),o=jn(n[n.length-1],e,t),a=new Array(i-2);for(let u=0;u<i-2;u+=2){try{const h=jn(n[u+2],s.type,t);a[u]=h}catch(h){throw new Error(`failed to parse argument ${u+1} of match expression: ${h.message}`)}try{const h=jn(n[u+3],o.type,t);a[u+1]=h}catch(h){throw new Error(`failed to parse argument ${u+2} of match expression: ${h.message}`)}}return[s,...a,o]}function OV(n,e,t){const i=n[1];let r;switch(i[0]){case"linear":r=1;break;case"exponential":const u=i[1];if(typeof u!="number"||u<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(u)} instead`);r=u;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(i)}`)}const s=new fn(nt,r);let o;try{o=jn(n[2],nt,t)}catch(u){throw new Error(`failed to parse argument 1 in interpolate expression: ${u.message}`)}const a=new Array(n.length-3);for(let u=0;u<a.length;u+=2){try{const h=jn(n[u+3],nt,t);a[u]=h}catch(h){throw new Error(`failed to parse argument ${u+2} for interpolate expression: ${h.message}`)}try{const h=jn(n[u+4],e,t);a[u+1]=h}catch(h){throw new Error(`failed to parse argument ${u+3} for interpolate expression: ${h.message}`)}}return[s,o,...a]}function VV(n,e,t){const i=jn(n[n.length-1],e,t),r=new Array(n.length-1);for(let s=0;s<r.length-1;s+=2){try{const o=jn(n[s+1],li,t);r[s]=o}catch(o){throw new Error(`failed to parse argument ${s} of case expression: ${o.message}`)}try{const o=jn(n[s+2],i.type,t);r[s+1]=o}catch(o){throw new Error(`failed to parse argument ${s+1} of case expression: ${o.message}`)}}return r[r.length-1]=i,r}function FV(n,e,t){let i=n[2];if(!Array.isArray(i))throw new Error('the second argument for the "in" operator must be an array');let r;if(typeof i[0]=="string"){if(i[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(i[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');i=i[1],r=Ii}else r=nt;const s=new Array(i.length);for(let a=0;a<s.length;a++)try{const u=jn(i[a],r,t);s[a]=u}catch(u){throw new Error(`failed to parse haystack item ${a} for "in" expression: ${u.message}`)}return[jn(n[1],r,t),...s]}function GV(n,e,t){let i;try{i=jn(n[1],nt,t)}catch(o){throw new Error(`failed to parse first argument in palette expression: ${o.message}`)}const r=n[2];if(!Array.isArray(r))throw new Error("the second argument of palette must be an array");const s=new Array(r.length);for(let o=0;o<s.length;o++){let a;try{a=jn(r[o],Br,t)}catch(u){throw new Error(`failed to parse color at index ${o} in palette expression: ${u.message}`)}if(!(a instanceof fn))throw new Error(`the palette color at index ${o} must be a literal value`);s[o]=a}return[i,...s]}function Ue(...n){return function(e,t,i){const r=e[0];let s;for(let o=0;o<n.length;o++){const a=n[o](e,t,i);if(o==n.length-1){if(!a)throw new Error("expected last argument validator to return the parsed args");s=a}}return new CV(t,r,...s)}}function jV(n,e,t){const i=n[0],r=MV[i];if(!r)throw new Error(`unknown operator: ${i}`);return r(n,e,t)}function Xb(n){if(!n)return"";const e=n.getType();switch(e){case"Point":case"LineString":case"Polygon":return e;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return e.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return Xb(n.getGeometries()[0]);default:return""}}function Yb(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function Ro(n,e,t){const i=jn(n,e,t);return Zr(i)}function Zr(n,e){if(n instanceof fn){if(n.type===Br&&typeof n.value=="string"){const i=Jw(n.value);return function(){return i}}return function(){return n.value}}const t=n.operator;switch(t){case te.Number:case te.String:case te.Coalesce:return UV(n);case te.Get:case te.Var:case te.Has:return BV(n);case te.Id:return i=>i.featureId;case te.GeometryType:return i=>i.geometryType;case te.Concat:{const i=n.args.map(r=>Zr(r));return r=>"".concat(...i.map(s=>s(r).toString()))}case te.Resolution:return i=>i.resolution;case te.Any:case te.All:case te.Between:case te.In:case te.Not:return $V(n);case te.Equal:case te.NotEqual:case te.LessThan:case te.LessThanOrEqualTo:case te.GreaterThan:case te.GreaterThanOrEqualTo:return zV(n);case te.Multiply:case te.Divide:case te.Add:case te.Subtract:case te.Clamp:case te.Mod:case te.Pow:case te.Abs:case te.Floor:case te.Ceil:case te.Round:case te.Sin:case te.Cos:case te.Atan:case te.Sqrt:return WV(n);case te.Case:return KV(n);case te.Match:return HV(n);case te.Interpolate:return qV(n);case te.ToString:return XV(n);default:throw new Error(`Unsupported operator ${t}`)}}function UV(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Zr(n.args[s]);switch(t){case te.Coalesce:return s=>{for(let o=0;o<i;++o){const a=r[o](s);if(typeof a<"u"&&a!==null)return a}throw new Error("Expected one of the values to be non-null")};case te.Number:case te.String:return s=>{for(let o=0;o<i;++o){const a=r[o](s);if(typeof a===t)return a}throw new Error(`Expected one of the values to be a ${t}`)};default:throw new Error(`Unsupported assertion operator ${t}`)}}function BV(n,e){const i=n.args[0].value;switch(n.operator){case te.Get:return r=>{const s=n.args;let o=r.properties[i];for(let a=1,u=s.length;a<u;++a){const d=s[a].value;o=o[d]}return o};case te.Var:return r=>r.variables[i];case te.Has:return r=>{const s=n.args;if(!(i in r.properties))return!1;let o=r.properties[i];for(let a=1,u=s.length;a<u;++a){const d=s[a].value;if(!o||!Object.hasOwn(o,d))return!1;o=o[d]}return!0};default:throw new Error(`Unsupported accessor operator ${n.operator}`)}}function zV(n,e){const t=n.operator,i=Zr(n.args[0]),r=Zr(n.args[1]);switch(t){case te.Equal:return s=>i(s)===r(s);case te.NotEqual:return s=>i(s)!==r(s);case te.LessThan:return s=>i(s)<r(s);case te.LessThanOrEqualTo:return s=>i(s)<=r(s);case te.GreaterThan:return s=>i(s)>r(s);case te.GreaterThanOrEqualTo:return s=>i(s)>=r(s);default:throw new Error(`Unsupported comparison operator ${t}`)}}function $V(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Zr(n.args[s]);switch(t){case te.Any:return s=>{for(let o=0;o<i;++o)if(r[o](s))return!0;return!1};case te.All:return s=>{for(let o=0;o<i;++o)if(!r[o](s))return!1;return!0};case te.Between:return s=>{const o=r[0](s),a=r[1](s),u=r[2](s);return o>=a&&o<=u};case te.In:return s=>{const o=r[0](s);for(let a=1;a<i;++a)if(o===r[a](s))return!0;return!1};case te.Not:return s=>!r[0](s);default:throw new Error(`Unsupported logical operator ${t}`)}}function WV(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Zr(n.args[s]);switch(t){case te.Multiply:return s=>{let o=1;for(let a=0;a<i;++a)o*=r[a](s);return o};case te.Divide:return s=>r[0](s)/r[1](s);case te.Add:return s=>{let o=0;for(let a=0;a<i;++a)o+=r[a](s);return o};case te.Subtract:return s=>r[0](s)-r[1](s);case te.Clamp:return s=>{const o=r[0](s),a=r[1](s);if(o<a)return a;const u=r[2](s);return o>u?u:o};case te.Mod:return s=>r[0](s)%r[1](s);case te.Pow:return s=>Math.pow(r[0](s),r[1](s));case te.Abs:return s=>Math.abs(r[0](s));case te.Floor:return s=>Math.floor(r[0](s));case te.Ceil:return s=>Math.ceil(r[0](s));case te.Round:return s=>Math.round(r[0](s));case te.Sin:return s=>Math.sin(r[0](s));case te.Cos:return s=>Math.cos(r[0](s));case te.Atan:return i===2?s=>Math.atan2(r[0](s),r[1](s)):s=>Math.atan(r[0](s));case te.Sqrt:return s=>Math.sqrt(r[0](s));default:throw new Error(`Unsupported numeric operator ${t}`)}}function KV(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=Zr(n.args[r]);return r=>{for(let s=0;s<t-1;s+=2)if(i[s](r))return i[s+1](r);return i[t-1](r)}}function HV(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=Zr(n.args[r]);return r=>{const s=i[0](r);for(let o=1;o<t-1;o+=2)if(s===i[o](r))return i[o+1](r);return i[t-1](r)}}function qV(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=Zr(n.args[r]);return r=>{const s=i[0](r),o=i[1](r);let a,u;for(let h=2;h<t;h+=2){const d=i[h](r);let g=i[h+1](r);const m=Array.isArray(g);if(m&&(g=v6(g)),d>=o)return h===2?g:m?YV(s,o,a,u,d,g):Hd(s,o,a,u,d,g);a=d,u=g}return u}}function XV(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Zr(n.args[s]);switch(t){case te.ToString:return s=>{const o=r[0](s);return n.args[0].type===Br?ex(o):o.toString()};default:throw new Error(`Unsupported convert operator ${t}`)}}function Hd(n,e,t,i,r,s){const o=r-t;if(o===0)return i;const a=e-t,u=n===1?a/o:(Math.pow(n,a)-1)/(Math.pow(n,o)-1);return i+u*(s-i)}function YV(n,e,t,i,r,s){if(r-t===0)return i;const a=nA(i),u=nA(s);let h=u[2]-a[2];h>180?h-=360:h<-180&&(h+=360);const d=[Hd(n,e,t,a[0],r,u[0]),Hd(n,e,t,a[1],r,u[1]),a[2]+Hd(n,e,t,0,r,h),Hd(n,e,t,i[3],r,s[3])];return E6(d)}function ZV(n){return!0}function QV(n){const e=qb(),t=JV(n,e),i=Yb();return function(r,s){if(i.properties=r.getPropertiesInternal(),i.resolution=s,e.featureId){const o=r.getId();o!==void 0?i.featureId=o:i.featureId=null}return e.geometryType&&(i.geometryType=Xb(r.getGeometry())),t(i)}}function AA(n){const e=qb(),t=n.length,i=new Array(t);for(let o=0;o<t;++o)i[o]=gE(n[o],e);const r=Yb(),s=new Array(t);return function(o,a){if(r.properties=o.getPropertiesInternal(),r.resolution=a,e.featureId){const h=o.getId();h!==void 0?r.featureId=h:r.featureId=null}let u=0;for(let h=0;h<t;++h){const d=i[h](r);d&&(s[u]=d,u+=1)}return s.length=u,s}}function JV(n,e){const t=n.length,i=new Array(t);for(let r=0;r<t;++r){const s=n[r],o="filter"in s?Ro(s.filter,li,e):ZV;let a;if(Array.isArray(s.style)){const u=s.style.length;a=new Array(u);for(let h=0;h<u;++h)a[h]=gE(s.style[h],e)}else a=[gE(s.style,e)];i[r]={filter:o,styles:a}}return function(r){const s=[];let o=!1;for(let a=0;a<t;++a){const u=i[a].filter;if(u(r)&&!(n[a].else&&o)){o=!0;for(const h of i[a].styles){const d=h(r);d&&s.push(d)}}}return s}}function gE(n,e){const t=Ff(n,"",e),i=Gf(n,"",e),r=e8(n,e),s=t8(n,e),o=Ri(n,"z-index",e);if(!t&&!i&&!r&&!s&&!oh(n))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(n));const a=new Mi;return function(u){let h=!0;if(t){const d=t(u);d&&(h=!1),a.setFill(d)}if(i){const d=i(u);d&&(h=!1),a.setStroke(d)}if(r){const d=r(u);d&&(h=!1),a.setText(d)}if(s){const d=s(u);d&&(h=!1),a.setImage(d)}return o&&a.setZIndex(o(u)),h?null:a}}function Ff(n,e,t){let i;if(e+"fill-pattern-src"in n)i=s8(n,e+"fill-",t);else{if(n[e+"fill-color"]==="none")return s=>null;i=ox(n,e+"fill-color",t)}if(!i)return null;const r=new Wr;return function(s){const o=i(s);return o===Qw?null:(r.setColor(o),r)}}function Gf(n,e,t){const i=Ri(n,e+"stroke-width",t),r=ox(n,e+"stroke-color",t);if(!i&&!r)return null;const s=ao(n,e+"stroke-line-cap",t),o=ao(n,e+"stroke-line-join",t),a=Zb(n,e+"stroke-line-dash",t),u=Ri(n,e+"stroke-line-dash-offset",t),h=Ri(n,e+"stroke-miter-limit",t),d=new Kr;return function(g){if(r){const m=r(g);if(m===Qw)return null;d.setColor(m)}if(i&&d.setWidth(i(g)),s){const m=s(g);if(m!=="butt"&&m!=="round"&&m!=="square")throw new Error("Expected butt, round, or square line cap");d.setLineCap(m)}if(o){const m=o(g);if(m!=="bevel"&&m!=="round"&&m!=="miter")throw new Error("Expected bevel, round, or miter line join");d.setLineJoin(m)}return a&&d.setLineDash(a(g)),u&&d.setLineDashOffset(u(g)),h&&d.setMiterLimit(h(g)),d}}function e8(n,e){const t="text-",i=ao(n,t+"value",e);if(!i)return null;const r=Ff(n,t,e),s=Ff(n,t+"background-",e),o=Gf(n,t,e),a=Gf(n,t+"background-",e),u=ao(n,t+"font",e),h=Ri(n,t+"max-angle",e),d=Ri(n,t+"offset-x",e),g=Ri(n,t+"offset-y",e),m=Xc(n,t+"overflow",e),v=ao(n,t+"placement",e),y=Ri(n,t+"repeat",e),T=M0(n,t+"scale",e),w=Xc(n,t+"rotate-with-view",e),A=Ri(n,t+"rotation",e),P=ao(n,t+"align",e),M=ao(n,t+"justify",e),k=ao(n,t+"baseline",e),N=Xc(n,t+"keep-upright",e),B=Zb(n,t+"padding",e),b=b0(n,t+"declutter-mode"),R=new rx({declutterMode:b});return function(L){if(R.setText(i(L)),r&&R.setFill(r(L)),s&&R.setBackgroundFill(s(L)),o&&R.setStroke(o(L)),a&&R.setBackgroundStroke(a(L)),u&&R.setFont(u(L)),h&&R.setMaxAngle(h(L)),d&&R.setOffsetX(d(L)),g&&R.setOffsetY(g(L)),m&&R.setOverflow(m(L)),v){const V=v(L);if(V!=="point"&&V!=="line")throw new Error("Expected point or line for text-placement");R.setPlacement(V)}if(y&&R.setRepeat(y(L)),T&&R.setScale(T(L)),w&&R.setRotateWithView(w(L)),A&&R.setRotation(A(L)),P){const V=P(L);if(V!=="left"&&V!=="center"&&V!=="right"&&V!=="end"&&V!=="start")throw new Error("Expected left, right, center, start, or end for text-align");R.setTextAlign(V)}if(M){const V=M(L);if(V!=="left"&&V!=="right"&&V!=="center")throw new Error("Expected left, right, or center for text-justify");R.setJustify(V)}if(k){const V=k(L);if(V!=="bottom"&&V!=="top"&&V!=="middle"&&V!=="alphabetic"&&V!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");R.setTextBaseline(V)}return B&&R.setPadding(B(L)),N&&R.setKeepUpright(N(L)),R}}function t8(n,e){return"icon-src"in n?n8(n,e):"shape-points"in n?i8(n,e):"circle-radius"in n?r8(n,e):null}function n8(n,e){const t="icon-",i=t+"src",r=Qb(n[i],i),s=__(n,t+"anchor",e),o=M0(n,t+"scale",e),a=Ri(n,t+"opacity",e),u=__(n,t+"displacement",e),h=Ri(n,t+"rotation",e),d=Xc(n,t+"rotate-with-view",e),g=PA(n,t+"anchor-origin"),m=CA(n,t+"anchor-x-units"),v=CA(n,t+"anchor-y-units"),y=u8(n,t+"color"),T=a8(n,t+"cross-origin"),w=l8(n,t+"offset"),A=PA(n,t+"offset-origin"),P=y_(n,t+"width"),M=y_(n,t+"height"),k=o8(n,t+"size"),N=b0(n,t+"declutter-mode"),B=new $b({src:r,anchorOrigin:g,anchorXUnits:m,anchorYUnits:v,color:y,crossOrigin:T,offset:w,offsetOrigin:A,height:M,width:P,size:k,declutterMode:N});return function(b){return a&&B.setOpacity(a(b)),u&&B.setDisplacement(u(b)),h&&B.setRotation(h(b)),d&&B.setRotateWithView(d(b)),o&&B.setScale(o(b)),s&&B.setAnchor(s(b)),B}}function i8(n,e){const t="shape-",i=t+"points",r=t+"radius",s=mE(n[i],i),o=mE(n[r],r),a=Ff(n,t,e),u=Gf(n,t,e),h=M0(n,t+"scale",e),d=__(n,t+"displacement",e),g=Ri(n,t+"rotation",e),m=Xc(n,t+"rotate-with-view",e),v=y_(n,t+"radius2"),y=y_(n,t+"angle"),T=b0(n,t+"declutter-mode"),w=new C0({points:s,radius:o,radius2:v,angle:y,declutterMode:T});return function(A){return a&&w.setFill(a(A)),u&&w.setStroke(u(A)),d&&w.setDisplacement(d(A)),g&&w.setRotation(g(A)),m&&w.setRotateWithView(m(A)),h&&w.setScale(h(A)),w}}function r8(n,e){const t="circle-",i=Ff(n,t,e),r=Gf(n,t,e),s=Ri(n,t+"radius",e),o=M0(n,t+"scale",e),a=__(n,t+"displacement",e),u=Ri(n,t+"rotation",e),h=Xc(n,t+"rotate-with-view",e),d=b0(n,t+"declutter-mode"),g=new iu({radius:5,declutterMode:d});return function(m){return s&&g.setRadius(s(m)),i&&g.setFill(i(m)),r&&g.setStroke(r(m)),a&&g.setDisplacement(a(m)),u&&g.setRotation(u(m)),h&&g.setRotateWithView(h(m)),o&&g.setScale(o(m)),g}}function Ri(n,e,t){if(!(e in n))return;const i=Ro(n[e],nt,t);return function(r){return mE(i(r),e)}}function ao(n,e,t){if(!(e in n))return null;const i=Ro(n[e],Ii,t);return function(r){return Qb(i(r),e)}}function s8(n,e,t){const i=ao(n,e+"pattern-src",t),r=RA(n,e+"pattern-offset",t),s=RA(n,e+"pattern-size",t),o=ox(n,e+"color",t);return function(a){return{src:i(a),offset:r&&r(a),size:s&&s(a),color:o&&o(a)}}}function Xc(n,e,t){if(!(e in n))return null;const i=Ro(n[e],li,t);return function(r){const s=i(r);if(typeof s!="boolean")throw new Error(`Expected a boolean for ${e}`);return s}}function ox(n,e,t){if(!(e in n))return null;const i=Ro(n[e],Br,t);return function(r){return Jb(i(r),e)}}function Zb(n,e,t){if(!(e in n))return null;const i=Ro(n[e],ru,t);return function(r){return wg(i(r),e)}}function __(n,e,t){if(!(e in n))return null;const i=Ro(n[e],ru,t);return function(r){const s=wg(i(r),e);if(s.length!==2)throw new Error(`Expected two numbers for ${e}`);return s}}function RA(n,e,t){if(!(e in n))return null;const i=Ro(n[e],ru,t);return function(r){return e4(i(r),e)}}function M0(n,e,t){if(!(e in n))return null;const i=Ro(n[e],ru|nt,t);return function(r){return c8(i(r),e)}}function y_(n,e){const t=n[e];if(t!==void 0){if(typeof t!="number")throw new Error(`Expected a number for ${e}`);return t}}function o8(n,e){const t=n[e];if(t!==void 0){if(typeof t=="number")return Ci(t);if(!Array.isArray(t))throw new Error(`Expected a number or size array for ${e}`);if(t.length!==2||typeof t[0]!="number"||typeof t[1]!="number")throw new Error(`Expected a number or size array for ${e}`);return t}}function a8(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);return t}}function PA(n,e){const t=n[e];if(t!==void 0){if(t!=="bottom-left"&&t!=="bottom-right"&&t!=="top-left"&&t!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return t}}function CA(n,e){const t=n[e];if(t!==void 0){if(t!=="pixels"&&t!=="fraction")throw new Error(`Expected pixels or fraction for ${e}`);return t}}function l8(n,e){const t=n[e];if(t!==void 0)return wg(t,e)}function b0(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);if(t!=="declutter"&&t!=="obstacle"&&t!=="none")throw new Error(`Expected declutter, obstacle, or none for ${e}`);return t}}function u8(n,e){const t=n[e];if(t!==void 0)return Jb(t,e)}function wg(n,e){if(!Array.isArray(n))throw new Error(`Expected an array for ${e}`);const t=n.length;for(let i=0;i<t;++i)if(typeof n[i]!="number")throw new Error(`Expected an array of numbers for ${e}`);return n}function Qb(n,e){if(typeof n!="string")throw new Error(`Expected a string for ${e}`);return n}function mE(n,e){if(typeof n!="number")throw new Error(`Expected a number for ${e}`);return n}function Jb(n,e){if(typeof n=="string")return n;const t=wg(n,e),i=t.length;if(i<3||i>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return t}function e4(n,e){const t=wg(n,e);if(t.length!==2)throw new Error(`Expected an array of two numbers for ${e}`);return t}function c8(n,e){return typeof n=="number"?n:e4(n,e)}const Vr={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function MA(n,e,t){return(function(i,r,s,o,a){if(!i)return;if(!r&&!e)return i;const u=e?0:s[0]*r,h=e?0:s[1]*r,d=a?a[0]:0,g=a?a[1]:0;let m=n[0]+u/2+d,v=n[2]-u/2+d,y=n[1]+h/2+g,T=n[3]-h/2+g;m>v&&(m=(v+m)/2,v=m),y>T&&(y=(T+y)/2,T=y);let w=Lt(i[0],m,v),A=Lt(i[1],y,T);if(o&&t&&r){const P=30*r;w+=-P*Math.log(1+Math.max(0,m-i[0])/P)+P*Math.log(1+Math.max(0,i[0]-v)/P),A+=-P*Math.log(1+Math.max(0,y-i[1])/P)+P*Math.log(1+Math.max(0,i[1]-T)/P)}return[w,A]})}function h8(n){return n}function t4(n){return Math.pow(n,3)}function bh(n){return 1-t4(1-n)}function d8(n){return 3*n*n-2*n*n*n}function f8(n){return n}function ax(n,e,t,i){const r=st(e)/t[0],s=Jn(e)/t[1];return i?Math.min(n,Math.max(r,s)):Math.min(n,Math.min(r,s))}function lx(n,e,t){let i=Math.min(n,e);const r=50;return i*=Math.log(1+r*Math.max(0,n/e-1))/r+1,t&&(i=Math.max(i,t),i/=Math.log(1+r*Math.max(0,t/n-1))/r+1),Lt(i,t/2,e*2)}function g8(n,e,t,i){return e=e!==void 0?e:!0,(function(r,s,o,a){if(r!==void 0){const u=n[0],h=n[n.length-1],d=t?ax(u,t,o,i):u;if(a)return e?lx(r,d,h):Lt(r,h,d);const g=Math.min(d,r),m=Math.floor(Nw(n,g,s));return n[m]>d&&m<n.length-1?n[m+1]:n[m]}})}function m8(n,e,t,i,r,s){return i=i!==void 0?i:!0,t=t!==void 0?t:0,(function(o,a,u,h){if(o!==void 0){const d=r?ax(e,r,u,s):e;if(h)return i?lx(o,d,t):Lt(o,t,d);const g=1e-9,m=Math.ceil(Math.log(e/d)/Math.log(n)-g),v=-a*(.5-g)+.5,y=Math.min(d,o),T=Math.floor(Math.log(e/y)/Math.log(n)+v),w=Math.max(m,T),A=e/Math.pow(n,w);return Lt(A,t,d)}})}function bA(n,e,t,i,r){return t=t!==void 0?t:!0,(function(s,o,a,u){if(s!==void 0){const h=i?ax(n,i,a,r):n;return!t||!u?Lt(s,e,h):lx(s,h,e)}})}function ux(n){if(n!==void 0)return 0}function LA(n){if(n!==void 0)return n}function p8(n){const e=2*Math.PI/n;return(function(t,i){if(i)return t;if(t!==void 0)return t=Math.floor(t/e+.5)*e,t})}function _8(n){const e=Ta(5);return(function(t,i){return i||t===void 0?t:Math.abs(t)<=e?0:t})}const y8=42,cx=256,o1=0;class Ss extends Vs{constructor(e){super(),this.on,this.once,this.un,e=Object.assign({},e),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=$w(e.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,e.projection&&lb(),e.center&&(e.center=oo(e.center,this.projection_)),e.extent&&(e.extent=va(e.extent,this.projection_)),this.applyOptions_(e)}applyOptions_(e){const t=Object.assign({},e);for(const a in Vr)delete t[a];this.setProperties(t,!0);const i=E8(e);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=i.minZoom;const r=v8(e),s=i.constraint,o=w8(e);this.constraints_={center:r,resolution:s,rotation:o},this.setRotation(e.rotation!==void 0?e.rotation:0),this.setCenterInternal(e.center!==void 0?e.center:null),e.resolution!==void 0?this.setResolution(e.resolution):e.zoom!==void 0&&this.setZoom(e.zoom)}get padding(){return this.padding_}set padding(e){let t=this.padding_;this.padding_=e;const i=this.getCenterInternal();if(i){const r=e||[0,0,0,0];t=t||[0,0,0,0];const s=this.getResolution(),o=s/2*(r[3]-t[3]+t[1]-r[1]),a=s/2*(r[0]-t[0]+t[2]-r[2]);this.setCenterInternal([i[0]+o,i[1]-a])}}getUpdatedOptions_(e){const t=this.getProperties();return t.resolution!==void 0?t.resolution=this.getResolution():t.zoom=this.getZoom(),t.center=this.getCenterInternal(),t.rotation=this.getRotation(),Object.assign({},t,e)}animate(e){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const t=new Array(arguments.length);for(let i=0;i<t.length;++i){let r=arguments[i];r.center&&(r=Object.assign({},r),r.center=oo(r.center,this.getProjection())),r.anchor&&(r=Object.assign({},r),r.anchor=oo(r.anchor,this.getProjection())),t[i]=r}this.animateInternal.apply(this,t)}animateInternal(e){let t=arguments.length,i;t>1&&typeof arguments[t-1]=="function"&&(i=arguments[t-1],--t);let r=0;for(;r<t&&!this.isDef();++r){const d=arguments[r];d.center&&this.setCenterInternal(d.center),d.zoom!==void 0?this.setZoom(d.zoom):d.resolution&&this.setResolution(d.resolution),d.rotation!==void 0&&this.setRotation(d.rotation)}if(r===t){i&&gp(i,!0);return}let s=Date.now(),o=this.targetCenter_.slice(),a=this.targetResolution_,u=this.targetRotation_;const h=[];for(;r<t;++r){const d=arguments[r],g={start:s,complete:!1,anchor:d.anchor,duration:d.duration!==void 0?d.duration:1e3,easing:d.easing||d8,callback:i};if(d.center&&(g.sourceCenter=o,g.targetCenter=d.center.slice(),o=g.targetCenter),d.zoom!==void 0?(g.sourceResolution=a,g.targetResolution=this.getResolutionForZoom(d.zoom),a=g.targetResolution):d.resolution&&(g.sourceResolution=a,g.targetResolution=d.resolution,a=g.targetResolution),d.rotation!==void 0){g.sourceRotation=u;const m=Ia(d.rotation-u+Math.PI,2*Math.PI)-Math.PI;g.targetRotation=u+m,u=g.targetRotation}x8(g)?g.complete=!0:s+=g.duration,h.push(g)}this.animations_.push(h),this.setHint(Xn.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[Xn.ANIMATING]>0}getInteracting(){return this.hints_[Xn.INTERACTING]>0}cancelAnimations(){this.setHint(Xn.ANIMATING,-this.hints_[Xn.ANIMATING]);let e;for(let t=0,i=this.animations_.length;t<i;++t){const r=this.animations_[t];if(r[0].callback&&gp(r[0].callback,!1),!e)for(let s=0,o=r.length;s<o;++s){const a=r[s];if(!a.complete){e=a.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=e,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const e=Date.now();let t=!1;for(let i=this.animations_.length-1;i>=0;--i){const r=this.animations_[i];let s=!0;for(let o=0,a=r.length;o<a;++o){const u=r[o];if(u.complete)continue;const h=e-u.start;let d=u.duration>0?h/u.duration:1;d>=1?(u.complete=!0,d=1):s=!1;const g=u.easing(d);if(u.sourceCenter){const m=u.sourceCenter[0],v=u.sourceCenter[1],y=u.targetCenter[0],T=u.targetCenter[1];this.nextCenter_=u.targetCenter;const w=m+g*(y-m),A=v+g*(T-v);this.targetCenter_=[w,A]}if(u.sourceResolution&&u.targetResolution){const m=g===1?u.targetResolution:u.sourceResolution+g*(u.targetResolution-u.sourceResolution);if(u.anchor){const v=this.getViewportSize_(this.getRotation()),y=this.constraints_.resolution(m,0,v,!0);this.targetCenter_=this.calculateCenterZoom(y,u.anchor)}this.nextResolution_=u.targetResolution,this.targetResolution_=m,this.applyTargetState_(!0)}if(u.sourceRotation!==void 0&&u.targetRotation!==void 0){const m=g===1?Ia(u.targetRotation+Math.PI,2*Math.PI)-Math.PI:u.sourceRotation+g*(u.targetRotation-u.sourceRotation);if(u.anchor){const v=this.constraints_.rotation(m,!0);this.targetCenter_=this.calculateCenterRotate(v,u.anchor)}this.nextRotation_=u.targetRotation,this.targetRotation_=m}if(this.applyTargetState_(!0),t=!0,!u.complete)break}if(s){this.animations_[i]=null,this.setHint(Xn.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const o=r[0].callback;o&&gp(o,!0)}}this.animations_=this.animations_.filter(Boolean),t&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(e,t){let i;const r=this.getCenterInternal();return r!==void 0&&(i=[r[0]-t[0],r[1]-t[1]],Fw(i,e-this.getRotation()),p5(i,t)),i}calculateCenterZoom(e,t){let i;const r=this.getCenterInternal(),s=this.getResolution();if(r!==void 0&&s!==void 0){const o=t[0]-e*(t[0]-r[0])/s,a=t[1]-e*(t[1]-r[1])/s;i=[o,a]}return i}getViewportSize_(e){const t=this.viewportSize_;if(e){const i=t[0],r=t[1];return[Math.abs(i*Math.cos(e))+Math.abs(r*Math.sin(e)),Math.abs(i*Math.sin(e))+Math.abs(r*Math.cos(e))]}return t}setViewportSize(e){this.viewportSize_=Array.isArray(e)?e.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const e=this.getCenterInternal();return e&&oE(e,this.getProjection())}getCenterInternal(){return this.get(Vr.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(e){return e!==void 0?(e[0]=this.hints_[0],e[1]=this.hints_[1],e):this.hints_.slice()}calculateExtent(e){const t=this.calculateExtentInternal(e);return ub(t,this.getProjection())}calculateExtentInternal(e){e=e||this.getViewportSizeMinusPadding_();const t=this.getCenterInternal();pt(t,"The view center is not defined");const i=this.getResolution();pt(i!==void 0,"The view resolution is not defined");const r=this.getRotation();return pt(r!==void 0,"The view rotation is not defined"),eE(t,i,r,e)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))}setConstrainResolution(e){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:e}))}getProjection(){return this.projection_}getResolution(){return this.get(Vr.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(e,t){return this.getResolutionForExtentInternal(va(e,this.getProjection()),t)}getResolutionForExtentInternal(e,t){t=t||this.getViewportSizeMinusPadding_();const i=st(e)/t[0],r=Jn(e)/t[1];return Math.max(i,r)}getResolutionForValueFunction(e){e=e||2;const t=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,r=Math.log(t/i)/Math.log(e);return(function(s){return t/Math.pow(e,s*r)})}getRotation(){return this.get(Vr.ROTATION)}getValueForResolutionFunction(e){const t=Math.log(e||2),i=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,s=Math.log(i/r)/t;return(function(o){return Math.log(i/o)/t/s})}getViewportSizeMinusPadding_(e){let t=this.getViewportSize_(e);const i=this.padding_;return i&&(t=[t[0]-i[1]-i[3],t[1]-i[0]-i[2]]),t}getState(){const e=this.getProjection(),t=this.getResolution(),i=this.getRotation();let r=this.getCenterInternal();const s=this.padding_;if(s){const o=this.getViewportSizeMinusPadding_();r=a1(r,this.getViewportSize_(),[o[0]/2+s[3],o[1]/2+s[0]],t,i)}return{center:r.slice(0),projection:e!==void 0?e:null,resolution:t,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let e;const t=this.getResolution();return t!==void 0&&(e=this.getZoomForResolution(t)),e}getZoomForResolution(e){let t=this.minZoom_||0,i,r;if(this.resolutions_){const s=Nw(this.resolutions_,e,1);t=s,i=this.resolutions_[s],s==this.resolutions_.length-1?r=2:r=i/this.resolutions_[s+1]}else i=this.maxResolution_,r=this.zoomFactor_;return t+Math.log(i/e)/Math.log(r)}getResolutionForZoom(e){if(this.resolutions_?.length){if(this.resolutions_.length===1)return this.resolutions_[0];const t=Lt(Math.floor(e),0,this.resolutions_.length-2),i=this.resolutions_[t]/this.resolutions_[t+1];return this.resolutions_[t]/Math.pow(i,Lt(e-t,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,e-this.minZoom_)}fit(e,t){let i;if(pt(Array.isArray(e)||typeof e.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(e)){pt(!E0(e),"Cannot fit empty extent provided as `geometry`");const r=va(e,this.getProjection());i=cA(r)}else if(e.getType()==="Circle"){const r=va(e.getExtent(),this.getProjection());i=cA(r),i.rotate(this.getRotation(),Jl(r))}else i=e;this.fitInternal(i,t)}rotatedExtentForGeometry(e){const t=this.getRotation(),i=Math.cos(t),r=Math.sin(-t),s=e.getFlatCoordinates(),o=e.getStride();let a=1/0,u=1/0,h=-1/0,d=-1/0;for(let g=0,m=s.length;g<m;g+=o){const v=s[g]*i-s[g+1]*r,y=s[g]*r+s[g+1]*i;a=Math.min(a,v),u=Math.min(u,y),h=Math.max(h,v),d=Math.max(d,y)}return[a,u,h,d]}fitInternal(e,t){t=t||{};let i=t.size;i||(i=this.getViewportSizeMinusPadding_());const r=t.padding!==void 0?t.padding:[0,0,0,0],s=t.nearest!==void 0?t.nearest:!1;let o;t.minResolution!==void 0?o=t.minResolution:t.maxZoom!==void 0?o=this.getResolutionForZoom(t.maxZoom):o=0;const a=this.rotatedExtentForGeometry(e);let u=this.getResolutionForExtentInternal(a,[i[0]-r[1]-r[3],i[1]-r[0]-r[2]]);u=isNaN(u)?o:Math.max(u,o),u=this.getConstrainedResolution(u,s?0:1);const h=this.getRotation(),d=Math.sin(h),g=Math.cos(h),m=Jl(a);m[0]+=(r[1]-r[3])/2*u,m[1]+=(r[0]-r[2])/2*u;const v=m[0]*g-m[1]*d,y=m[1]*g+m[0]*d,T=this.getConstrainedCenter([v,y],u),w=t.callback?t.callback:Mf;t.duration!==void 0?this.animateInternal({resolution:u,center:T,duration:t.duration,easing:t.easing},w):(this.targetResolution_=u,this.targetCenter_=T,this.applyTargetState_(!1,!0),gp(w,!0))}centerOn(e,t,i){this.centerOnInternal(oo(e,this.getProjection()),t,i)}centerOnInternal(e,t,i){this.setCenterInternal(a1(e,t,i,this.getResolution(),this.getRotation()))}calculateCenterShift(e,t,i,r){let s;const o=this.padding_;if(o&&e){const a=this.getViewportSizeMinusPadding_(-i),u=a1(e,r,[a[0]/2+o[3],a[1]/2+o[0]],t,i);s=[e[0]-u[0],e[1]-u[1]]}return s}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(e){const t=oE(this.targetCenter_,this.getProjection());this.setCenter([t[0]+e[0],t[1]+e[1]])}adjustCenterInternal(e){const t=this.targetCenter_;this.setCenterInternal([t[0]+e[0],t[1]+e[1]])}adjustResolution(e,t){t=t&&oo(t,this.getProjection()),this.adjustResolutionInternal(e,t)}adjustResolutionInternal(e,t){const i=this.getAnimating()||this.getInteracting(),r=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*e,0,r,i);t&&(this.targetCenter_=this.calculateCenterZoom(s,t)),this.targetResolution_*=e,this.applyTargetState_()}adjustZoom(e,t){this.adjustResolution(Math.pow(this.zoomFactor_,-e),t)}adjustRotation(e,t){t&&(t=oo(t,this.getProjection())),this.adjustRotationInternal(e,t)}adjustRotationInternal(e,t){const i=this.getAnimating()||this.getInteracting(),r=this.constraints_.rotation(this.targetRotation_+e,i);t&&(this.targetCenter_=this.calculateCenterRotate(r,t)),this.targetRotation_+=e,this.applyTargetState_()}setCenter(e){this.setCenterInternal(e&&oo(e,this.getProjection()))}setCenterInternal(e){this.targetCenter_=e,this.applyTargetState_()}setHint(e,t){return this.hints_[e]+=t,this.changed(),this.hints_[e]}setResolution(e){this.targetResolution_=e,this.applyTargetState_()}setRotation(e){this.targetRotation_=e,this.applyTargetState_()}setZoom(e){this.setResolution(this.getResolutionForZoom(e))}applyTargetState_(e,t){const i=this.getAnimating()||this.getInteracting()||t,r=this.constraints_.rotation(this.targetRotation_,i),s=this.getViewportSize_(r),o=this.constraints_.resolution(this.targetResolution_,0,s,i),a=this.constraints_.center(this.targetCenter_,o,s,i,this.calculateCenterShift(this.targetCenter_,o,r,s));this.get(Vr.ROTATION)!==r&&this.set(Vr.ROTATION,r),this.get(Vr.RESOLUTION)!==o&&(this.set(Vr.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),(!a||!this.get(Vr.CENTER)||!o_(this.get(Vr.CENTER),a))&&this.set(Vr.CENTER,a),this.getAnimating()&&!e&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(e,t,i){e=e!==void 0?e:200;const r=t||0,s=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(s),a=this.constraints_.resolution(this.targetResolution_,r,o),u=this.constraints_.center(this.targetCenter_,a,o,!1,this.calculateCenterShift(this.targetCenter_,a,s,o));if(e===0&&!this.cancelAnchor_){this.targetResolution_=a,this.targetRotation_=s,this.targetCenter_=u,this.applyTargetState_();return}i=i||(e===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==a||this.getRotation()!==s||!this.getCenterInternal()||!o_(this.getCenterInternal(),u))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:u,resolution:a,duration:e,easing:bh,anchor:i}))}beginInteraction(){this.resolveConstraints(0),this.setHint(Xn.INTERACTING,1)}endInteraction(e,t,i){i=i&&oo(i,this.getProjection()),this.endInteractionInternal(e,t,i)}endInteractionInternal(e,t,i){this.getInteracting()&&(this.setHint(Xn.INTERACTING,-1),this.resolveConstraints(e,t,i))}getConstrainedCenter(e,t){const i=this.getViewportSize_(this.getRotation());return this.constraints_.center(e,t||this.getResolution(),i)}getConstrainedZoom(e,t){const i=this.getResolutionForZoom(e);return this.getZoomForResolution(this.getConstrainedResolution(i,t))}getConstrainedResolution(e,t){t=t||0;const i=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(e,t,i)}}function gp(n,e){setTimeout(function(){n(e)},0)}function v8(n){if(n.extent!==void 0){const t=n.smoothExtentConstraint!==void 0?n.smoothExtentConstraint:!0;return MA(n.extent,n.constrainOnlyCenter,t)}const e=$w(n.projection,"EPSG:3857");if(n.multiWorld!==!0&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,MA(t,!1,!1)}return h8}function E8(n){let e,t,i,o=n.minZoom!==void 0?n.minZoom:o1,a=n.maxZoom!==void 0?n.maxZoom:28;const u=n.zoomFactor!==void 0?n.zoomFactor:2,h=n.multiWorld!==void 0?n.multiWorld:!1,d=n.smoothResolutionConstraint!==void 0?n.smoothResolutionConstraint:!0,g=n.showFullExtent!==void 0?n.showFullExtent:!1,m=$w(n.projection,"EPSG:3857"),v=m.getExtent();let y=n.constrainOnlyCenter,T=n.extent;if(!h&&!T&&m.isGlobal()&&(y=!1,T=v),n.resolutions!==void 0){const w=n.resolutions;t=w[o],i=w[a]!==void 0?w[a]:w[w.length-1],n.constrainResolution?e=g8(w,d,!y&&T,g):e=bA(t,i,d,!y&&T,g)}else{const A=(v?Math.max(st(v),Jn(v)):360*Gw.degrees/m.getMetersPerUnit())/cx/Math.pow(2,o1),P=A/Math.pow(2,28-o1);t=n.maxResolution,t!==void 0?o=0:t=A/Math.pow(u,o),i=n.minResolution,i===void 0&&(n.maxZoom!==void 0?n.maxResolution!==void 0?i=t/Math.pow(u,a):i=A/Math.pow(u,a):i=P),a=o+Math.floor(Math.log(t/i)/Math.log(u)),i=t/Math.pow(u,a-o),n.constrainResolution?e=m8(u,t,i,d,!y&&T,g):e=bA(t,i,d,!y&&T,g)}return{constraint:e,maxResolution:t,minResolution:i,minZoom:o,zoomFactor:u}}function w8(n){if(n.enableRotation!==void 0?n.enableRotation:!0){const t=n.constrainRotation;return t===void 0||t===!0?_8():t===!1?LA:typeof t=="number"?p8(t):LA}return ux}function x8(n){return!(n.sourceCenter&&n.targetCenter&&!o_(n.sourceCenter,n.targetCenter)||n.sourceResolution!==n.targetResolution||n.sourceRotation!==n.targetRotation)}function a1(n,e,t,i,r){const s=Math.cos(-r);let o=Math.sin(-r),a=n[0]*s-n[1]*o,u=n[1]*s+n[0]*o;a+=(e[0]/2-t[0])*i,u+=(t[1]-e[1]/2)*i,o=-o;const h=a*s-u*o,d=u*s+a*o;return[h,d]}const wt={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class n4 extends Vs{constructor(e){super(),this.on,this.once,this.un,this.background_=e.background;const t=Object.assign({},e);typeof e.properties=="object"&&(delete t.properties,Object.assign(t,e.properties)),t[wt.OPACITY]=e.opacity!==void 0?e.opacity:1,pt(typeof t[wt.OPACITY]=="number","Layer opacity must be a number"),t[wt.VISIBLE]=e.visible!==void 0?e.visible:!0,t[wt.Z_INDEX]=e.zIndex,t[wt.MAX_RESOLUTION]=e.maxResolution!==void 0?e.maxResolution:1/0,t[wt.MIN_RESOLUTION]=e.minResolution!==void 0?e.minResolution:0,t[wt.MIN_ZOOM]=e.minZoom!==void 0?e.minZoom:-1/0,t[wt.MAX_ZOOM]=e.maxZoom!==void 0?e.maxZoom:1/0,this.className_=t.className!==void 0?t.className:"ol-layer",delete t.className,this.setProperties(t),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(e){const t=this.state_||{layer:this,managed:e===void 0?!0:e},i=this.getZIndex();return t.opacity=Lt(Math.round(this.getOpacity()*100)/100,0,1),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=i===void 0&&!t.managed?1/0:i,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),t.minZoom=this.getMinZoom(),t.maxZoom=this.getMaxZoom(),this.state_=t,t}getLayersArray(e){return at()}getLayerStatesArray(e){return at()}getExtent(){return this.get(wt.EXTENT)}getMaxResolution(){return this.get(wt.MAX_RESOLUTION)}getMinResolution(){return this.get(wt.MIN_RESOLUTION)}getMinZoom(){return this.get(wt.MIN_ZOOM)}getMaxZoom(){return this.get(wt.MAX_ZOOM)}getOpacity(){return this.get(wt.OPACITY)}getSourceState(){return at()}getVisible(){return this.get(wt.VISIBLE)}getZIndex(){return this.get(wt.Z_INDEX)}setBackground(e){this.background_=e,this.changed()}setExtent(e){this.set(wt.EXTENT,e)}setMaxResolution(e){this.set(wt.MAX_RESOLUTION,e)}setMinResolution(e){this.set(wt.MIN_RESOLUTION,e)}setMaxZoom(e){this.set(wt.MAX_ZOOM,e)}setMinZoom(e){this.set(wt.MIN_ZOOM,e)}setOpacity(e){pt(typeof e=="number","Layer opacity must be a number"),this.set(wt.OPACITY,e)}setVisible(e){this.set(wt.VISIBLE,e)}setZIndex(e){this.set(wt.Z_INDEX,e)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}class L0 extends n4{constructor(e){const t=Object.assign({},e);delete t.source,super(t),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,e.render&&(this.render=e.render),e.map&&this.setMap(e.map),this.addChangeListener(wt.SOURCE,this.handleSourcePropertyChange_);const i=e.source?e.source:null;this.setSource(i)}getLayersArray(e){return e=e||[],e.push(this),e}getLayerStatesArray(e){return e=e||[],e.push(this.getLayerState()),e}getSource(){return this.get(wt.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const e=this.getSource();return e?e.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(Vt(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const e=this.getSource();e&&(this.sourceChangeKey_=lt(e,qe.CHANGE,this.handleSourceChange_,this),e.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(e){return this.renderer_?this.renderer_.getFeatures(e):Promise.resolve([])}getData(e){return!this.renderer_||!this.rendered?null:this.renderer_.getData(e)}isVisible(e){let t;const i=this.getMapInternal();!e&&i&&(e=i.getView()),e instanceof Ss?t={viewState:e.getState(),extent:e.calculateExtent()}:t=e,!t.layerStatesArray&&i&&(t.layerStatesArray=i.getLayerGroup().getLayerStatesArray());let r;if(t.layerStatesArray){if(r=t.layerStatesArray.find(o=>o.layer===this),!r)return!1}else r=this.getLayerState();const s=this.getExtent();return hx(r,t.viewState)&&(!s||Ai(s,t.extent))}getAttributions(e){if(!this.isVisible(e))return[];const t=this.getSource()?.getAttributions();if(!t)return[];const i=e instanceof Ss?e.getViewStateAndExtent():e;let r=t(i);return Array.isArray(r)||(r=[r]),r}render(e,t){const i=this.getRenderer();return i.prepareFrame(e)?(this.rendered=!0,i.renderFrame(e,t)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(e,t){}renderDeferred(e){const t=this.getRenderer();t&&t.renderDeferred(e)}setMapInternal(e){e||this.unrender(),this.set(wt.MAP,e)}getMapInternal(){return this.get(wt.MAP)}setMap(e){this.mapPrecomposeKey_&&(Vt(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(Vt(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=lt(e,Er.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=lt(this,qe.CHANGE,e.render,e),this.changed())}handlePrecompose_(e){const t=e.frameState.layerStatesArray,i=this.getLayerState(!1);pt(!t.some(r=>r.layer===i.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),t.push(i)}setSource(e){this.set(wt.SOURCE,e)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}}function hx(n,e){if(!n.visible)return!1;const t=e.resolution;if(t<n.minResolution||t>=n.maxResolution)return!1;const i=e.zoom;return i>n.minZoom&&i<=n.maxZoom}const kA={RENDER_ORDER:"renderOrder"};class i4 extends L0{constructor(e){e=e||{};const t=Object.assign({},e);delete t.style,delete t.renderBuffer,delete t.updateWhileAnimating,delete t.updateWhileInteracting,super(t),this.declutter_=e.declutter?String(e.declutter):void 0,this.renderBuffer_=e.renderBuffer!==void 0?e.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(e.style),this.updateWhileAnimating_=e.updateWhileAnimating!==void 0?e.updateWhileAnimating:!1,this.updateWhileInteracting_=e.updateWhileInteracting!==void 0?e.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(e){return super.getFeatures(e)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(kA.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(e,t){const i=this.getDeclutter();i in e.declutter||(e.declutter[i]=new Fb(9)),this.getRenderer().renderDeclutter(e,t)}setRenderOrder(e){this.set(kA.RENDER_ORDER,e)}setStyle(e){this.style_=e===void 0?Ub:e;const t=S8(e);this.styleFunction_=e===null?void 0:sV(t),this.changed()}setDeclutter(e){this.declutter_=e?String(e):void 0,this.changed()}}function S8(n){if(n===void 0)return Ub;if(!n)return null;if(typeof n=="function"||n instanceof Mi)return n;if(!Array.isArray(n))return AA([n]);if(n.length===0)return[];const e=n.length,t=n[0];if(t instanceof Mi){const r=new Array(e);for(let s=0;s<e;++s){const o=n[s];if(!(o instanceof Mi))throw new Error("Expected a list of style instances");r[s]=o}return r}if("style"in t){const r=new Array(e);for(let s=0;s<e;++s){const o=n[s];if(!("style"in o))throw new Error("Expected a list of rules with a style property");r[s]=o}return QV(r)}return AA(n)}class r4 extends i4{constructor(e){super(e)}createRenderer(){return new AV(this)}}const ra={ADDLAYER:"addlayer",REMOVELAYER:"removelayer"};class fa extends Ao{constructor(e,t){super(e),this.layer=t}}const l1={LAYERS:"layers"};let k0=class s4 extends n4{constructor(e){e=e||{};const t=Object.assign({},e);delete t.layers;let i=e.layers;super(t),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(l1.LAYERS,this.handleLayersChanged_),i?Array.isArray(i)?i=new vr(i.slice(),{unique:!0}):pt(typeof i.getArray=="function","Expected `layers` to be an array or a `Collection`"):i=new vr(void 0,{unique:!0}),this.setLayers(i)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(Vt),this.layersListenerKeys_.length=0;const e=this.getLayers();this.layersListenerKeys_.push(lt(e,Si.ADD,this.handleLayersAdd_,this),lt(e,Si.REMOVE,this.handleLayersRemove_,this));for(const i in this.listenerKeys_)this.listenerKeys_[i].forEach(Vt);gg(this.listenerKeys_);const t=e.getArray();for(let i=0,r=t.length;i<r;i++){const s=t[i];this.registerLayerListeners_(s),this.dispatchEvent(new fa(ra.ADDLAYER,s))}this.changed()}registerLayerListeners_(e){const t=[lt(e,sh.PROPERTYCHANGE,this.handleLayerChange_,this),lt(e,qe.CHANGE,this.handleLayerChange_,this)];e instanceof s4&&t.push(lt(e,ra.ADDLAYER,this.handleLayerGroupAdd_,this),lt(e,ra.REMOVELAYER,this.handleLayerGroupRemove_,this)),this.listenerKeys_[ut(e)]=t}handleLayerGroupAdd_(e){this.dispatchEvent(new fa(ra.ADDLAYER,e.layer))}handleLayerGroupRemove_(e){this.dispatchEvent(new fa(ra.REMOVELAYER,e.layer))}handleLayersAdd_(e){const t=e.element;this.registerLayerListeners_(t),this.dispatchEvent(new fa(ra.ADDLAYER,t)),this.changed()}handleLayersRemove_(e){const t=e.element,i=ut(t);this.listenerKeys_[i].forEach(Vt),delete this.listenerKeys_[i],this.dispatchEvent(new fa(ra.REMOVELAYER,t)),this.changed()}getLayers(){return this.get(l1.LAYERS)}setLayers(e){const t=this.getLayers();if(t){const i=t.getArray();for(let r=0,s=i.length;r<s;++r)this.dispatchEvent(new fa(ra.REMOVELAYER,i[r]))}this.set(l1.LAYERS,e)}getLayersArray(e){return e=e!==void 0?e:[],this.getLayers().forEach(function(t){t.getLayersArray(e)}),e}getLayerStatesArray(e){const t=e!==void 0?e:[],i=t.length;this.getLayers().forEach(function(o){o.getLayerStatesArray(t)});const r=this.getLayerState();let s=r.zIndex;!e&&r.zIndex===void 0&&(s=0);for(let o=i,a=t.length;o<a;o++){const u=t[o];u.opacity*=r.opacity,u.visible=u.visible&&r.visible,u.maxResolution=Math.min(u.maxResolution,r.maxResolution),u.minResolution=Math.max(u.minResolution,r.minResolution),u.minZoom=Math.max(u.minZoom,r.minZoom),u.maxZoom=Math.min(u.maxZoom,r.maxZoom),r.extent!==void 0&&(u.extent!==void 0?u.extent=Hl(u.extent,r.extent):u.extent=r.extent),u.zIndex===void 0&&(u.zIndex=s)}return t}getSourceState(){return"ready"}};const De={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};class dx extends mg{constructor(e,t,i){super(),i=i||{},this.tileCoord=e,this.state=t,this.key="",this.transition_=i.transition===void 0?250:i.transition,this.transitionStarts_={},this.interpolate=!!i.interpolate}changed(){this.dispatchEvent(qe.CHANGE)}release(){this.setState(De.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(e){if(this.state!==De.EMPTY){if(this.state!==De.ERROR&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()}}load(){at()}getAlpha(e,t){if(!this.transition_)return 1;let i=this.transitionStarts_[e];if(!i)i=t,this.transitionStarts_[e]=i;else if(i===-1)return 1;const r=t-i+1e3/60;return r>=this.transition_?1:t4(r/this.transition_)}inTransition(e){return this.transition_?this.transitionStarts_[e]!==-1:!1}endTransition(e){this.transition_&&(this.transitionStarts_[e]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}function pE(n){return n instanceof Image||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageBitmap?n:null}const T8=new Error("disposed"),I8=[256,256];class DA extends dx{constructor(e){const t=De.IDLE;super(e.tileCoord,t,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null,this.controller_=e.controller||null}getSize(){if(this.size_)return this.size_;const e=pE(this.data_);return e?[e.width,e.height]:I8}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==De.IDLE&&this.state!==De.ERROR)return;this.state=De.LOADING,this.changed();const e=this;this.loader_().then(function(t){e.data_=t,e.state=De.LOADED,e.changed()}).catch(function(t){e.error_=t,e.state=De.ERROR,e.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(T8),this.controller_=null),super.disposeInternal()}}class o4 extends dx{constructor(e,t,i,r,s,o){super(e,t,o),this.crossOrigin_=r,this.src_=i,this.key=i,this.image_,Wi?this.image_=new OffscreenCanvas(1,1):(this.image_=new Image,r!==null&&(this.image_.crossOrigin=r)),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(e){this.image_=e,this.state=De.LOADED,this.unlistenImage_(),this.changed()}getCrossOrigin(){return this.crossOrigin_}handleImageError_(){this.state=De.ERROR,this.unlistenImage_(),this.image_=A8(),this.changed()}handleImageLoad_(){if(Wi)this.state=De.LOADED;else{const e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=De.LOADED:this.state=De.EMPTY}this.unlistenImage_(),this.changed()}load(){this.state==De.ERROR&&(this.state=De.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==De.IDLE&&(this.state=De.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=w6(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function A8(){const n=mn(1,1);return n.fillStyle="rgba(0,0,0,0)",n.fillRect(0,0,1,1),n.canvas}let u1;const Yc=[];function NA(n,e,t,i,r){n.beginPath(),n.moveTo(0,0),n.lineTo(e,t),n.lineTo(i,r),n.closePath(),n.save(),n.clip(),n.fillRect(0,0,Math.max(e,i)+1,Math.max(t,r)),n.restore()}function c1(n,e){return Math.abs(n[e*4]-210)>2||Math.abs(n[e*4+3]-.75*255)>2}function R8(){if(u1===void 0){const n=mn(6,6,Yc);n.globalCompositeOperation="lighter",n.fillStyle="rgba(210, 0, 0, 0.75)",NA(n,4,5,4,0),NA(n,4,5,0,5);const e=n.getImageData(0,0,3,3).data;u1=c1(e,0)||c1(e,4)||c1(e,8),A0(n),Yc.push(n.canvas)}return u1}function _E(n,e,t,i){const r=vg(t,e,n);let s=X2(e,i,t);const o=e.getMetersPerUnit();o!==void 0&&(s*=o);const a=n.getMetersPerUnit();a!==void 0&&(s/=a);const u=n.getExtent();if(!u||ah(u,r)){const h=X2(n,s,r)/s;isFinite(h)&&h>0&&(s/=h)}return s}function P8(n,e,t,i){const r=Jl(t);let s=_E(n,e,r,i);return(!isFinite(s)||s<=0)&&XM(t,function(o){return s=_E(n,e,o,i),isFinite(s)&&s>0}),s}function C8(n,e,t,i,r,s,o,a,u,h,d,g,m,v){const y=mn(Math.round(t*n),Math.round(t*e),Yc);if(g||(y.imageSmoothingEnabled=!1),u.length===0)return y.canvas;y.scale(t,t);function T(N){return Math.round(N*t)/t}y.globalCompositeOperation="lighter";const w=Xi();u.forEach(function(N,B,b){u5(w,N.extent)});let A;const P=t/i,M=(g?1:1+Math.pow(2,-24))/P;(!m||u.length!==1||h!==0)&&(A=mn(Math.round(st(w)*P),Math.round(Jn(w)*P),Yc),g||(A.imageSmoothingEnabled=!1),u.forEach(function(N,B,b){if(N.image.width>0&&N.image.height>0){if(N.clipExtent){A.save();const U=(N.clipExtent[0]-w[0])*P,D=-(N.clipExtent[3]-w[3])*P,le=st(N.clipExtent)*P,we=Jn(N.clipExtent)*P;A.rect(g?U:Math.round(U),g?D:Math.round(D),g?le:Math.round(U+le)-Math.round(U),g?we:Math.round(D+we)-Math.round(D)),A.clip()}const R=(N.extent[0]-w[0])*P,L=-(N.extent[3]-w[3])*P,V=st(N.extent)*P,F=Jn(N.extent)*P;A.drawImage(N.image,h,h,N.image.width-2*h,N.image.height-2*h,g?R:Math.round(R),g?L:Math.round(L),g?V:Math.round(R+V)-Math.round(R),g?F:Math.round(L+F)-Math.round(L)),N.clipExtent&&A.restore()}}));const k=Ka(o);return a.getTriangles().forEach(function(N,B,b){const R=N.source,L=N.target;let V=R[0][0],F=R[0][1],U=R[1][0],D=R[1][1],le=R[2][0],we=R[2][1];const ye=T((L[0][0]-k[0])/s),de=T(-(L[0][1]-k[1])/s),J=T((L[1][0]-k[0])/s),ae=T(-(L[1][1]-k[1])/s),ie=T((L[2][0]-k[0])/s),$=T(-(L[2][1]-k[1])/s),K=V,Pe=F;V=0,F=0,U-=K,D-=Pe,le-=K,we-=Pe;const Ce=[[U,D,0,0,J-ye],[le,we,0,0,ie-ye],[0,0,U,D,ae-de],[0,0,le,we,$-de]],Me=m5(Ce);if(!Me)return;if(y.save(),y.beginPath(),R8()||!g){y.moveTo(J,ae);const Ge=4,Ke=ye-J,Ye=de-ae;for(let yt=0;yt<Ge;yt++)y.lineTo(J+T((yt+1)*Ke/Ge),ae+T(yt*Ye/(Ge-1))),yt!=Ge-1&&y.lineTo(J+T((yt+1)*Ke/Ge),ae+T((yt+1)*Ye/(Ge-1)));y.lineTo(ie,$)}else y.moveTo(J,ae),y.lineTo(ye,de),y.lineTo(ie,$);y.clip(),y.transform(Me[0],Me[2],Me[1],Me[3],ye,de),y.translate(w[0]-K,w[3]-Pe);let Ve;if(A)Ve=A.canvas,y.scale(M,-M);else{const Ge=u[0],Ke=Ge.extent;Ve=Ge.image,y.scale(st(Ke)/Ve.width,-Jn(Ke)/Ve.height)}y.drawImage(Ve,0,0),y.restore()}),A&&(A0(A),Yc.push(A.canvas)),d&&(y.save(),y.globalCompositeOperation="source-over",y.strokeStyle="black",y.lineWidth=1,a.getTriangles().forEach(function(N,B,b){const R=N.target,L=(R[0][0]-k[0])/s,V=-(R[0][1]-k[1])/s,F=(R[1][0]-k[0])/s,U=-(R[1][1]-k[1])/s,D=(R[2][0]-k[0])/s,le=-(R[2][1]-k[1])/s;y.beginPath(),y.moveTo(F,U),y.lineTo(L,V),y.lineTo(D,le),y.closePath(),y.stroke()}),y.restore()),y.canvas}const M8=10,OA=.25;class b8{constructor(e,t,i,r,s,o,a){this.sourceProj_=e,this.targetProj_=t;let u={};const h=a?sE(M=>In(a,vg(M,this.targetProj_,this.sourceProj_))):u_(this.targetProj_,this.sourceProj_);this.transformInv_=function(M){const k=M[0]+"/"+M[1];return u[k]||(u[k]=h(M)),u[k]},this.maxSourceExtent_=r,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!r&&!!this.sourceProj_.getExtent()&&st(r)>=st(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?st(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?st(this.targetProj_.getExtent()):null;const d=Ka(i),g=v0(i),m=y0(i),v=_0(i),y=this.transformInv_(d),T=this.transformInv_(g),w=this.transformInv_(m),A=this.transformInv_(v),P=M8+(o?Math.max(0,Math.ceil(Math.log2(J1(i)/(o*o*256*256)))):0);if(this.addQuad_(d,g,m,v,y,T,w,A,P),this.wrapsXInSource_){let M=1/0;this.triangles_.forEach(function(k,N,B){M=Math.min(M,k.source[0][0],k.source[1][0],k.source[2][0])}),this.triangles_.forEach(k=>{if(Math.max(k.source[0][0],k.source[1][0],k.source[2][0])-M>this.sourceWorldWidth_/2){const N=[[k.source[0][0],k.source[0][1]],[k.source[1][0],k.source[1][1]],[k.source[2][0],k.source[2][1]]];N[0][0]-M>this.sourceWorldWidth_/2&&(N[0][0]-=this.sourceWorldWidth_),N[1][0]-M>this.sourceWorldWidth_/2&&(N[1][0]-=this.sourceWorldWidth_),N[2][0]-M>this.sourceWorldWidth_/2&&(N[2][0]-=this.sourceWorldWidth_);const B=Math.min(N[0][0],N[1][0],N[2][0]);Math.max(N[0][0],N[1][0],N[2][0])-B<this.sourceWorldWidth_/2&&(k.source=N)}})}u={}}addTriangle_(e,t,i,r,s,o){this.triangles_.push({source:[r,s,o],target:[e,t,i]})}addQuad_(e,t,i,r,s,o,a,u,h){const d=F2([s,o,a,u]),g=this.sourceWorldWidth_?st(d)/this.sourceWorldWidth_:null,m=this.sourceWorldWidth_,v=this.sourceProj_.canWrapX()&&g>.5&&g<1;let y=!1;if(h>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const w=F2([e,t,i,r]);y=st(w)/this.targetWorldWidth_>OA||y}!v&&this.sourceProj_.isGlobal()&&g&&(y=g>OA||y)}if(!y&&this.maxSourceExtent_&&isFinite(d[0])&&isFinite(d[1])&&isFinite(d[2])&&isFinite(d[3])&&!Ai(d,this.maxSourceExtent_))return;let T=0;if(!y&&(!isFinite(s[0])||!isFinite(s[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(u[0])||!isFinite(u[1]))){if(h>0)y=!0;else if(T=(!isFinite(s[0])||!isFinite(s[1])?8:0)+(!isFinite(o[0])||!isFinite(o[1])?4:0)+(!isFinite(a[0])||!isFinite(a[1])?2:0)+(!isFinite(u[0])||!isFinite(u[1])?1:0),T!=1&&T!=2&&T!=4&&T!=8)return}if(h>0){if(!y){const w=[(e[0]+i[0])/2,(e[1]+i[1])/2],A=this.transformInv_(w);let P;v?P=(Ia(s[0],m)+Ia(a[0],m))/2-Ia(A[0],m):P=(s[0]+a[0])/2-A[0];const M=(s[1]+a[1])/2-A[1];y=P*P+M*M>this.errorThresholdSquared_}if(y){if(Math.abs(e[0]-i[0])<=Math.abs(e[1]-i[1])){const w=[(t[0]+i[0])/2,(t[1]+i[1])/2],A=this.transformInv_(w),P=[(r[0]+e[0])/2,(r[1]+e[1])/2],M=this.transformInv_(P);this.addQuad_(e,t,w,P,s,o,A,M,h-1),this.addQuad_(P,w,i,r,M,A,a,u,h-1)}else{const w=[(e[0]+t[0])/2,(e[1]+t[1])/2],A=this.transformInv_(w),P=[(i[0]+r[0])/2,(i[1]+r[1])/2],M=this.transformInv_(P);this.addQuad_(e,w,P,r,s,A,M,u,h-1),this.addQuad_(w,t,i,P,A,o,a,M,h-1)}return}}if(v){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(T&11)==0&&this.addTriangle_(e,i,r,s,a,u),(T&14)==0&&this.addTriangle_(e,i,t,s,a,o),T&&((T&13)==0&&this.addTriangle_(t,r,e,o,u,s),(T&7)==0&&this.addTriangle_(t,r,i,o,u,a))}calculateSourceExtent(){const e=Xi();return this.triangles_.forEach(function(t,i,r){const s=t.source;lf(e,s[0]),lf(e,s[1]),lf(e,s[2])}),e}getTriangles(){return this.triangles_}}const L8=.5;class a4 extends dx{constructor(e,t,i,r,s,o,a,u,h,d,g,m){super(s,De.IDLE,m),this.renderEdges_=g!==void 0?g:!1,this.pixelRatio_=a,this.gutter_=u,this.canvas_=null,this.sourceTileGrid_=t,this.targetTileGrid_=r,this.wrappedTileCoord_=o||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=e.canWrapX()?e.getExtent():void 0;const v=r.getTileCoordExtent(this.wrappedTileCoord_),y=this.targetTileGrid_.getExtent();let T=this.sourceTileGrid_.getExtent();const w=y?Hl(v,y):v;if(J1(w)===0){this.state=De.EMPTY;return}const A=e.getExtent();A&&(T?T=Hl(T,A):T=A);const P=r.getResolution(this.wrappedTileCoord_[0]),M=P8(e,i,w,P);if(!isFinite(M)||M<=0){this.state=De.EMPTY;return}const k=d!==void 0?d:L8;if(this.triangulation_=new b8(e,i,w,T,M*k,P),this.triangulation_.getTriangles().length===0){this.state=De.EMPTY;return}this.sourceZ_=t.getZForResolution(M);let N=this.triangulation_.calculateSourceExtent();if(T&&(e.canWrapX()?(N[1]=Lt(N[1],T[1],T[3]),N[3]=Lt(N[3],T[1],T[3])):N=Hl(N,T)),!J1(N))this.state=De.EMPTY;else{let B=0,b=0;e.canWrapX()&&(B=st(A),b=Math.floor((N[0]-A[0])/B)),QM(N.slice(),e,!0).forEach(L=>{const V=t.getTileRangeForExtentAndZ(L,this.sourceZ_);for(let F=V.minX;F<=V.maxX;F++)for(let U=V.minY;U<=V.maxY;U++){const D=h(this.sourceZ_,F,U,a);if(D){const le=b*B;this.sourceTiles_.push({tile:D,offset:le})}}++b}),this.sourceTiles_.length===0&&(this.state=De.EMPTY)}}getImage(){return this.canvas_}reproject_(){const e=[];if(this.sourceTiles_.forEach(t=>{const i=t.tile;if(i&&i.getState()==De.LOADED){const r=this.sourceTileGrid_.getTileCoordExtent(i.tileCoord);r[0]+=t.offset,r[2]+=t.offset;const s=this.clipExtent_?.slice();s&&(s[0]+=t.offset,s[2]+=t.offset),e.push({extent:r,clipExtent:s,image:i.getImage()})}}),this.sourceTiles_.length=0,e.length===0)this.state=De.ERROR;else{const t=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(t),r=typeof i=="number"?i:i[0],s=typeof i=="number"?i:i[1],o=this.targetTileGrid_.getResolution(t),a=this.sourceTileGrid_.getResolution(this.sourceZ_),u=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=C8(r,s,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),o,u,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=De.LOADED}this.changed()}load(){if(this.state==De.IDLE){this.state=De.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:t})=>{const i=t.getState();if(i==De.IDLE||i==De.LOADING){e++;const r=lt(t,qe.CHANGE,s=>{const o=t.getState();(o==De.LOADED||o==De.ERROR||o==De.EMPTY)&&(Vt(r),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(r)}}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:t},i,r){t.getState()==De.IDLE&&t.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(Vt),this.sourcesListenerKeys_=null}release(){this.canvas_&&(A0(this.canvas_.getContext("2d")),Yc.push(this.canvas_),this.canvas_=null),super.release()}}class fx{constructor(e,t,i,r){this.minX=e,this.maxX=t,this.minY=i,this.maxY=r}contains(e){return this.containsXY(e[1],e[2])}containsTileRange(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}containsXY(e,t){return this.minX<=e&&e<=this.maxX&&this.minY<=t&&t<=this.maxY}equals(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}extend(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}}function mc(n,e,t,i,r){return r!==void 0?(r.minX=n,r.maxX=e,r.minY=t,r.maxY=i,r):new fx(n,e,t,i)}class VA{constructor(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const e=this.pop();e instanceof f0&&e.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(e){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let t=this.oldest_;for(;t;)e(t.value_,t.key_,this),t=t.newer}get(e,t){const i=this.entries_[e];return pt(i!==void 0,"Tried to get a value for a key that does not exist in the cache"),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_}remove(e){const t=this.entries_[e];return pt(t!==void 0,"Tried to get a value for a key that does not exist in the cache"),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_}getCount(){return this.count_}getKeys(){const e=new Array(this.count_);let t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.key_;return e}getValues(){const e=new Array(this.count_);let t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.value_;return e}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){return this.entries_[e]?.value_}pop(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,t){this.get(e),this.entries_[e].value_=t}set(e,t){pt(!(e in this.entries_),"Tried to set a value for a key that is used already");const i={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[e]=i,++this.count_}setSize(e){this.highWaterMark=e}}function v_(n,e,t,i){return i!==void 0?(i[0]=n,i[1]=e,i[2]=t,i):[n,e,t]}function k8(n,e,t){return n+"/"+e+"/"+t}function Np(n,e,t,i,r){return`${ut(n)},${e},${k8(t,i,r)}`}function l4(n){return D8(n[0],n[1],n[2])}function D8(n,e,t){return(e<<n)+t}function N8(n,e){const t=n[0],i=n[1],r=n[2];if(e.getMinZoom()>t||t>e.getMaxZoom())return!1;const s=e.getFullTileRange(t);return s?s.containsXY(i,r):!0}function h1(n,e,t){if(!(t in n))return n[t]=new Set([e]),!0;const i=n[t],r=i.has(e);return r||i.add(e),!r}function O8(n,e,t){const i=n[t];return i?i.delete(e):!1}function FA(n,e){const t=n.layerStatesArray[n.layerIndex];t.extent&&(e=Hl(e,va(t.extent,n.viewState.projection)));const i=t.layer.getRenderSource();if(!i.getWrapX()){const r=i.getTileGridForProjection(n.viewState.projection).getExtent();r&&(e=Hl(e,r))}return e}class V8 extends Hb{constructor(e,t){super(e),t=t||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=Xi(),this.tempTileRange_=new fx(0,0,0,0),this.tempTileCoord_=v_(0,0,0);const i=t.cacheSize!==void 0?t.cacheSize:512;this.tileCache_=new VA(i),this.sourceTileCache_=null,this.maxStaleKeys=i*.5}getTileCache(){return this.tileCache_}getSourceTileCache(){return this.sourceTileCache_||(this.sourceTileCache_=new VA(512)),this.sourceTileCache_}getOrCreateTile(e,t,i,r){const s=this.tileCache_,a=this.getLayer().getSource(),u=Np(a,a.getKey(),e,t,i);let h;if(s.containsKey(u))h=s.get(u);else{const d=r.viewState.projection,g=a.getProjection();if(h=a.getTile(e,t,i,r.pixelRatio,d,!g||Dp(g,d)?void 0:this.getSourceTileCache()),!h)return null;s.set(u,h)}return h}getTile(e,t,i,r){const s=this.getOrCreateTile(e,t,i,r);return s||null}getData(e){const t=this.frameState;if(!t)return null;const i=this.getLayer(),r=In(t.pixelToCoordinateTransform,e.slice()),s=i.getExtent();if(s&&!ah(s,r))return null;const o=t.viewState,a=i.getRenderSource(),u=a.getTileGridForProjection(o.projection),h=a.getTilePixelRatio(t.pixelRatio);for(let d=u.getZForResolution(o.resolution);d>=u.getMinZoom();--d){const g=u.getTileCoordForCoordAndZ(r,d),m=this.getTile(d,g[1],g[2],t);if(!m||m.getState()!==De.LOADED)continue;const v=u.getOrigin(d),y=Ci(u.getTileSize(d)),T=u.getResolution(d);let w;if(m instanceof o4||m instanceof a4)w=m.getImage();else if(m instanceof DA){if(w=pE(m.getData()),!w)continue}else continue;const A=Math.floor(h*((r[0]-v[0])/T-g[1]*y[0])),P=Math.floor(h*((v[1]-r[1])/T-g[2]*y[1])),M=Math.round(h*a.getGutterForProjection(o.projection));return this.getImageData(w,A+M,P+M)}return null}prepareFrame(e){this.renderedProjection?e.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=e.viewState.projection):this.renderedProjection=e.viewState.projection;const t=this.getLayer().getSource();if(!t)return!1;const i=t.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==i&&(this.renderedSourceRevision_=i,this.renderedSourceKey_===t.getKey()&&(this.tileCache_.clear(),this.sourceTileCache_?.clear())):this.renderedSourceRevision_=i,!0}enqueueTilesForNextExtent(){return!0}enqueueTiles(e,t,i,r,s){const o=e.viewState,a=this.getLayer(),u=a.getRenderSource(),h=u.getTileGridForProjection(o.projection),d=ut(u);d in e.wantedTiles||(e.wantedTiles[d]={});const g=e.wantedTiles[d],m=a.getMapInternal(),v=Math.max(i-s,h.getMinZoom(),h.getZForResolution(Math.min(a.getMaxResolution(),m?m.getView().getResolutionForZoom(Math.max(a.getMinZoom(),0)):h.getResolution(0)),u.zDirection)),y=o.rotation,T=y?YM(o.center,o.resolution,y,e.size):void 0;for(let w=i;w>=v;--w){const A=h.getTileRangeForExtentAndZ(t,w,this.tempTileRange_),P=h.getResolution(w);for(let M=A.minX;M<=A.maxX;++M)for(let k=A.minY;k<=A.maxY;++k){if(y&&!h.tileCoordIntersectsViewport([w,M,k],T))continue;const N=this.getTile(w,M,k,e);if(!N||!h1(r,N,w))continue;const b=N.getKey();if(g[b]=!0,N.getState()===De.IDLE&&!e.tileQueue.isKeyQueued(b)){const R=v_(w,M,k,this.tempTileCoord_);e.tileQueue.enqueue([N,d,h.getTileCoordCenter(R),P])}}}}findStaleTile_(e,t){const i=this.tileCache_,r=e[0],s=e[1],o=e[2],a=this.getStaleKeys();for(let u=0;u<a.length;++u){const h=Np(this.getLayer().getSource(),a[u],r,s,o);if(i.containsKey(h)){const d=i.peek(h);if(d.getState()===De.LOADED)return d.endTransition(ut(this)),h1(t,d,r),!0}}return!1}findAltTiles_(e,t,i,r){const s=e.getTileRangeForTileCoordAndZ(t,i,this.tempTileRange_);if(!s)return!1;let o=!0;const a=this.tileCache_,u=this.getLayer().getRenderSource(),h=u.getKey();for(let d=s.minX;d<=s.maxX;++d)for(let g=s.minY;g<=s.maxY;++g){const m=Np(u,h,i,d,g);let v=!1;if(a.containsKey(m)){const y=a.peek(m);y.getState()===De.LOADED&&(h1(r,y,i),v=!0)}v||(o=!1)}return o}renderFrame(e,t){this.renderComplete=!0;const i=e.layerStatesArray[e.layerIndex],r=e.viewState,s=r.projection,o=r.resolution,a=r.center,u=e.pixelRatio,h=this.getLayer(),d=h.getSource(),g=d.getTileGridForProjection(s),m=g.getZForResolution(o,d.zDirection),v=g.getResolution(m),y=d.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==y&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=y):this.renderedSourceKey_=y;let T=e.extent;const w=d.getTilePixelRatio(u);this.prepareContainer(e,t);const A=this.context.canvas.width,P=this.context.canvas.height,M=i.extent&&va(i.extent);M&&(T=Hl(T,va(i.extent)));const k=v*A/2/w,N=v*P/2/w,B=[a[0]-k,a[1]-N,a[0]+k,a[1]+N],b={};this.renderedTiles.length=0;const R=h.getPreload();if(e.nextExtent&&this.enqueueTilesForNextExtent()){const J=g.getZForResolution(r.nextResolution,d.zDirection),ae=FA(e,e.nextExtent);this.enqueueTiles(e,ae,J,b,R)}const L=FA(e,T);if(this.enqueueTiles(e,L,m,b,0),R>0&&setTimeout(()=>{this.enqueueTiles(e,L,m-1,b,R-1)},0),!(m in b))return this.container;const V=ut(this),F=e.time;for(const J of b[m]){const ae=J.getState();if(ae===De.EMPTY)continue;const ie=J.tileCoord;if(ae===De.LOADED&&J.getAlpha(V,F)===1){J.endTransition(V);continue}if(ae!==De.ERROR&&(this.renderComplete=!1),this.findStaleTile_(ie,b)){O8(b,J,m),e.animate=!0;continue}if(this.findAltTiles_(g,ie,m+1,b))continue;const Pe=g.getMinZoom();for(let Ce=m-1;Ce>=Pe&&!this.findAltTiles_(g,ie,Ce,b);--Ce);}const U=v/o*u/w,D=this.getRenderContext(e);vo(this.tempTransform,A/2,P/2,U,U,0,-A/2,-P/2),i.extent&&this.clipUnrotated(D,e,M),d.getInterpolate()||(D.imageSmoothingEnabled=!1),this.preRender(D,e);const le=Object.keys(b).map(Number);le.sort(fo);let we;const ye=[],de=[];for(let J=le.length-1;J>=0;--J){const ae=le[J],ie=d.getTilePixelSize(ae,u,s),K=g.getResolution(ae)/v,Pe=ie[0]*K*U,Ce=ie[1]*K*U,Me=g.getTileCoordForCoordAndZ(Ka(B),ae),Ve=g.getTileCoordExtent(Me),Ge=In(this.tempTransform,[w*(Ve[0]-B[0])/v,w*(B[3]-Ve[3])/v]),Ke=w*d.getGutterForProjection(s);for(const Ye of b[ae]){if(Ye.getState()!==De.LOADED)continue;const yt=Ye.tileCoord,Ar=Me[1]-yt[1],js=Math.round(Ge[0]-(Ar-1)*Pe),fi=Me[2]-yt[2],gi=Math.round(Ge[1]-(fi-1)*Ce),Rn=Math.round(Ge[0]-Ar*Pe),Pn=Math.round(Ge[1]-fi*Ce),mi=js-Rn,er=gi-Pn,Rt=le.length===1;let vt=!1;we=[Rn,Pn,Rn+mi,Pn,Rn+mi,Pn+er,Rn,Pn+er];for(let yn=0,tr=ye.length;yn<tr;++yn)if(!Rt&&ae<de[yn]){const Dt=ye[yn];Ai([Rn,Pn,Rn+mi,Pn+er],[Dt[0],Dt[3],Dt[4],Dt[7]])&&(vt||(D.save(),vt=!0),D.beginPath(),D.moveTo(we[0],we[1]),D.lineTo(we[2],we[3]),D.lineTo(we[4],we[5]),D.lineTo(we[6],we[7]),D.moveTo(Dt[6],Dt[7]),D.lineTo(Dt[4],Dt[5]),D.lineTo(Dt[2],Dt[3]),D.lineTo(Dt[0],Dt[1]),D.clip())}ye.push(we),de.push(ae),this.drawTile(Ye,e,Rn,Pn,mi,er,Ke,Rt),vt&&D.restore(),this.renderedTiles.unshift(Ye),this.updateUsedTiles(e.usedTiles,d,Ye)}}if(this.renderedResolution=v,this.extentChanged=!this.renderedExtent_||!Lf(this.renderedExtent_,B),this.renderedExtent_=B,this.renderedPixelRatio=u,this.postRender(this.context,e),i.extent&&D.restore(),D.imageSmoothingEnabled=!0,this.renderComplete){const J=(ae,ie)=>{const $=ut(d),K=ie.wantedTiles[$],Pe=K?Object.keys(K).length:0;this.updateCacheSize(Pe),this.tileCache_.expireCache(),this.sourceTileCache_?.expireCache()};e.postRenderFunctions.push(J)}return this.container}updateCacheSize(e){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,e*2)}drawTile(e,t,i,r,s,o,a,u){let h;if(e instanceof DA){if(h=pE(e.getData()),!h)throw new Error("Rendering array data is not yet supported")}else h=this.getTileImage(e);if(!h)return;const d=this.getRenderContext(t),g=ut(this),m=t.layerStatesArray[t.layerIndex],v=m.opacity*(u?e.getAlpha(g,t.time):1),y=v!==d.globalAlpha;y&&(d.save(),d.globalAlpha=v),d.drawImage(h,a,a,h.width-2*a,h.height-2*a,i,r,s,o),y&&d.restore(),v!==m.opacity?t.animate=!0:u&&e.endTransition(g)}getImage(){const e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}updateUsedTiles(e,t,i){const r=ut(t);r in e||(e[r]={}),e[r][i.getKey()]=!0}}const mp={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class F8 extends L0{constructor(e){e=e||{};const t=Object.assign({},e),i=e.cacheSize;delete e.cacheSize,delete t.preload,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un,this.cacheSize_=i,this.setPreload(e.preload!==void 0?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(mp.PRELOAD)}setPreload(e){this.set(mp.PRELOAD,e)}getUseInterimTilesOnError(){return this.get(mp.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(mp.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}}class Rl extends F8{constructor(e){super(e)}createRenderer(){return new V8(this,{cacheSize:this.getCacheSize()})}}const pc=[0,0,0],sa=5;class gx{constructor(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,pt(s5(this.resolutions_,(r,s)=>s-r),"`resolutions` must be sorted in descending order");let t;if(!e.origins){for(let r=0,s=this.resolutions_.length-1;r<s;++r)if(!t)t=this.resolutions_[r]/this.resolutions_[r+1];else if(this.resolutions_[r]/this.resolutions_[r+1]!==t){t=void 0;break}}this.zoomFactor_=t,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,pt(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const i=e.extent;i!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=Ka(i)),pt(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,pt(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:cx,pt(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=i!==void 0?i:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map((r,s)=>{const o=new fx(Math.min(0,r[0]),Math.max(r[0]-1,-1),Math.min(0,r[1]),Math.max(r[1]-1,-1));if(i){const a=this.getTileRangeForExtentAndZ(i,s);o.minX=Math.max(a.minX,o.minX),o.maxX=Math.min(a.maxX,o.maxX),o.minY=Math.max(a.minY,o.minY),o.maxY=Math.min(a.maxY,o.maxY)}return o}):i&&this.calculateTileRanges_(i)}forEachTileCoord(e,t,i){const r=this.getTileRangeForExtentAndZ(e,t);for(let s=r.minX,o=r.maxX;s<=o;++s)for(let a=r.minY,u=r.maxY;a<=u;++a)i([t,s,a])}forEachTileCoordParentTileRange(e,t,i,r){let s,o,a,u=null,h=e[0]-1;for(this.zoomFactor_===2?(o=e[1],a=e[2]):u=this.getTileCoordExtent(e,r);h>=this.minZoom;){if(o!==void 0&&a!==void 0?(o=Math.floor(o/2),a=Math.floor(a/2),s=mc(o,o,a,a,i)):s=this.getTileRangeForExtentAndZ(u,h,i),t(h,s))return!0;--h}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,t,i){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){const s=e[1]*2,o=e[2]*2;return mc(s,s+1,o,o+1,t)}const r=this.getTileCoordExtent(e,i||this.tmpExtent_);return this.getTileRangeForExtentAndZ(r,e[0]+1,t)}return null}getTileRangeForTileCoordAndZ(e,t,i){if(t>this.maxZoom||t<this.minZoom)return null;const r=e[0],s=e[1],o=e[2];if(t===r)return mc(s,o,s,o,i);if(this.zoomFactor_){const u=Math.pow(this.zoomFactor_,t-r),h=Math.floor(s*u),d=Math.floor(o*u);if(t<r)return mc(h,h,d,d,i);const g=Math.floor(u*(s+1))-1,m=Math.floor(u*(o+1))-1;return mc(h,g,d,m,i)}const a=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(a,t,i)}getTileRangeForExtentAndZ(e,t,i){this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,pc);const r=pc[1],s=pc[2];this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,pc);const o=pc[1],a=pc[2];return mc(r,o,s,a,i)}getTileCoordCenter(e){const t=this.getOrigin(e[0]),i=this.getResolution(e[0]),r=Ci(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*r[0]*i,t[1]-(e[2]+.5)*r[1]*i]}getTileCoordExtent(e,t){const i=this.getOrigin(e[0]),r=this.getResolution(e[0]),s=Ci(this.getTileSize(e[0]),this.tmpSize_),o=i[0]+e[1]*s[0]*r,a=i[1]-(e[2]+1)*s[1]*r,u=o+s[0]*r,h=a+s[1]*r;return Da(o,a,u,h,t)}getTileCoordForCoordAndResolution(e,t,i){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,i)}getTileCoordForXYAndResolution_(e,t,i,r,s){const o=this.getZForResolution(i),a=i/this.getResolution(o),u=this.getOrigin(o),h=Ci(this.getTileSize(o),this.tmpSize_);let d=a*(e-u[0])/i/h[0],g=a*(u[1]-t)/i/h[1];return r?(d=op(d,sa)-1,g=op(g,sa)-1):(d=sp(d,sa),g=sp(g,sa)),v_(o,d,g,s)}getTileCoordForXYAndZ_(e,t,i,r,s){const o=this.getOrigin(i),a=this.getResolution(i),u=Ci(this.getTileSize(i),this.tmpSize_);let h=(e-o[0])/a/u[0],d=(o[1]-t)/a/u[1];return r?(h=op(h,sa)-1,d=op(d,sa)-1):(h=sp(h,sa),d=sp(d,sa)),v_(i,h,d,s)}getTileCoordForCoordAndZ(e,t,i){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,i)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,t){const i=Nw(this.resolutions_,e,t||0);return Lt(i,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,t){return pb(t,0,t.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){const t=this.resolutions_.length,i=new Array(t);for(let r=this.minZoom;r<t;++r)i[r]=this.getTileRangeForExtentAndZ(e,r);this.fullTileRanges_=i}}class G8 extends gx{constructor(e){super({extent:e.extent,origin:e.origin,origins:e.origins,resolutions:e.resolutions,tileSize:e.tileSize,tileSizes:e.tileSizes,sizes:e.sizes}),this.matrixIds_=e.matrixIds}getMatrixId(e){return this.matrixIds_[e]}getMatrixIds(){return this.matrixIds_}}function u4(n){let e=n.getDefaultTileGrid();return e||(e=z8(n),n.setDefaultTileGrid(e)),e}function j8(n,e,t){const i=e[0],r=n.getTileCoordCenter(e),s=mx(t);if(!ah(s,r)){const o=st(s),a=Math.ceil((s[0]-r[0])/o);return r[0]+=o*a,n.getTileCoordForCoordAndZ(r,i)}return e}function U8(n,e,t,i){i=i!==void 0?i:"top-left";const r=c4(n,e,t);return new gx({extent:n,origin:h5(n,i),resolutions:r,tileSize:t})}function B8(n){const e=n||{},t=e.extent||An("EPSG:3857").getExtent(),i={extent:t,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:c4(t,e.maxZoom,e.tileSize,e.maxResolution)};return new gx(i)}function c4(n,e,t,i){e=e!==void 0?e:y8,t=Ci(t!==void 0?t:cx);const r=Jn(n),s=st(n);i=i>0?i:Math.max(s/t[0],r/t[1]);const o=e+1,a=new Array(o);for(let u=0;u<o;++u)a[u]=i/Math.pow(2,u);return a}function z8(n,e,t,i){const r=mx(n);return U8(r,e,t,i)}function mx(n){n=An(n);let e=n.getExtent();if(!e){const t=180*Gw.degrees/n.getMetersPerUnit();e=Da(-t,-t,t,t)}return e}function E_(n,e){const t=[];Object.keys(e).forEach(function(r){e[r]!==null&&e[r]!==void 0&&t.push(r+"="+encodeURIComponent(e[r]))});const i=t.join("&");return n=n.replace(/[?&]$/,""),n+=n.includes("?")?"&":"?",n+i}const $8=/\{z\}/g,W8=/\{x\}/g,K8=/\{y\}/g,H8=/\{-y\}/g;function q8(n,e,t,i,r){return n.replace($8,e.toString()).replace(W8,t.toString()).replace(K8,i.toString()).replace(H8,function(){if(r===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(r-i).toString()})}function h4(n){const e=[];let t=/\{([a-z])-([a-z])\}/.exec(n);if(t){const i=t[1].charCodeAt(0),r=t[2].charCodeAt(0);let s;for(s=i;s<=r;++s)e.push(n.replace(t[0],String.fromCharCode(s)));return e}if(t=/\{(\d+)-(\d+)\}/.exec(n),t){const i=parseInt(t[2],10);for(let r=parseInt(t[1],10);r<=i;r++)e.push(n.replace(t[0],r.toString()));return e}return e.push(n),e}function X8(n,e){return(function(t,i,r){if(!t)return;let s;const o=t[0];if(e){const a=e.getFullTileRange(o);a&&(s=a.getHeight()-1)}return q8(n,o,t[1],t[2],s)})}function Y8(n,e){const t=n.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=X8(n[r],e);return yE(i)}function yE(n){return n.length===1?n[0]:(function(e,t,i){if(!e)return;const r=l4(e),s=Ia(r,n.length);return n[s](e,t,i)})}class Z8 extends Gb{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=e.tilePixelRatio!==void 0?e.tilePixelRatio:1,this.tileGrid=e.tileGrid!==void 0?e.tileGrid:null;const t=[256,256];this.tileGrid&&Ci(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),t),this.tmpSize=[0,0],this.key_=e.key||ut(this),this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}getGutterForProjection(e){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getResolutions(e){const t=e?this.getTileGridForProjection(e):this.tileGrid;return t?t.getResolutions():null}getTile(e,t,i,r,s,o){return at()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:u4(e)}getTilePixelRatio(e){return this.tilePixelRatio_}getTilePixelSize(e,t,i){const r=this.getTileGridForProjection(i),s=this.getTilePixelRatio(t),o=Ci(r.getTileSize(e),this.tmpSize);return s==1?o:rV(o,s,this.tmpSize)}getTileCoordForTileUrlFunction(e,t){const i=t!==void 0?t:this.getProjection(),r=t!==void 0?this.getTileGridForProjection(i):this.tileGrid||this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(e=j8(r,e,i)),N8(e,r)?e:null}clear(){}refresh(){this.clear(),super.refresh()}}class Q8 extends Ao{constructor(e,t){super(e),this.tile=t}}const d1={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class px extends Z8{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===px.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){const t=e.target,i=ut(t),r=t.getState();let s;r==De.LOADING?(this.tileLoadingKeys_[i]=!0,s=d1.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],s=r==De.ERROR?d1.TILELOADERROR:r==De.LOADED?d1.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new Q8(s,t))}setTileLoadFunction(e){this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,t){this.tileUrlFunction=e,typeof t<"u"?this.setKey(t):this.changed()}setUrl(e){const t=h4(e);this.urls=t,this.setUrls(t)}setUrls(e){this.urls=e;const t=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(Y8(e,this.tileGrid),t):this.setKey(t)}tileUrlFunction(e,t,i){}}class _x extends px{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:d4,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate!==void 0?e.interpolate:!0,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,this.tileClass=e.tileClass!==void 0?e.tileClass:o4,this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(e){return this.getProjection()&&e&&!Dp(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getTileGridForProjection(e){const t=this.getProjection();if(this.tileGrid&&(!t||Dp(t,e)))return this.tileGrid;const i=ut(e);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=u4(e)),this.tileGridForProjection[i]}createTile_(e,t,i,r,s,o){const a=[e,t,i],u=this.getTileCoordForTileUrlFunction(a,s),h=u?this.tileUrlFunction(u,r,s):void 0,d=new this.tileClass(a,h!==void 0?De.IDLE:De.EMPTY,h!==void 0?h:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return d.key=o,d.addEventListener(qe.CHANGE,this.handleTileChange.bind(this)),d}getTile(e,t,i,r,s,o){const a=this.getProjection();if(!a||!s||Dp(a,s))return this.getTileInternal(e,t,i,r,a||s);const u=[e,t,i],h=this.getKey(),d=this.getTileGridForProjection(a),g=this.getTileGridForProjection(s),m=this.getTileCoordForTileUrlFunction(u,s),v=new a4(a,d,s,g,u,m,this.getTilePixelRatio(r),this.getGutter(),(y,T,w,A)=>this.getTileInternal(y,T,w,A,a,o),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return v.key=h,v}getTileInternal(e,t,i,r,s,o){const a=this.getKey(),u=Np(this,a,e,t,i);if(o&&o.containsKey(u))return o.get(u);const h=this.createTile_(e,t,i,r,s,a);return o?.set(u,h),h}setRenderReprojectionEdges(e){this.renderReprojectionEdges_!=e&&(this.renderReprojectionEdges_=e,this.changed())}setTileGridForProjection(e,t){const i=An(e);if(i){const r=ut(i);r in this.tileGridForProjection||(this.tileGridForProjection[r]=t)}}}function d4(n,e){if(Wi){const t=n.getCrossOrigin();let i="same-origin",r="same-origin";t==="anonymous"||t===""?(i="cors",r="omit"):t==="use-credentials"&&(i="cors",r="include"),fetch(e,{mode:i,credentials:r}).then(s=>{if(!s.ok)throw new Error(`HTTP ${s.status}`);return s.blob()}).then(s=>createImageBitmap(s)).then(s=>{const o=n.getImage();o.width=s.width,o.height=s.height,o.getContext("2d").drawImage(s,0,0),s.close?.(),o.dispatchEvent(new Event("load"))}).catch(()=>{n.getImage().dispatchEvent(new Event("error"))});return}n.getImage().src=e}class qd extends _x{constructor(e){e=e||{};const t=e.projection!==void 0?e.projection:"EPSG:3857",i=e.tileGrid!==void 0?e.tileGrid:B8({extent:mx(t),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:t,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:i,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0}getGutter(){return this.gutter_}}const J8="modulepreload",eF=function(n){return"/detectorapp-nl/"+n},GA={},Te=function(e,t,i){let r=Promise.resolve();if(t&&t.length>0){let u=function(h){return Promise.all(h.map(d=>Promise.resolve(d).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=o?.nonce||o?.getAttribute("nonce");r=u(t.map(h=>{if(h=eF(h),h in GA)return;GA[h]=!0;const d=h.endsWith(".css"),g=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${g}`))return;const m=document.createElement("link");if(m.rel=d?"stylesheet":J8,d||(m.as="script"),m.crossOrigin="",m.href=h,a&&m.setAttribute("nonce",a),document.head.appendChild(m),d)return new Promise((v,y)=>{m.addEventListener("load",v),m.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${h}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return r.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})},jA=4,vE="1.3.0";function tF(n,e,t,i,r){r.WIDTH=t[0],r.HEIGHT=t[1];const s=i.getAxisOrientation(),o=JM(r.VERSION,"1.3")>=0;r[o?"CRS":"SRS"]=i.getCode();const a=o&&s.startsWith("ne")?[e[1],e[0],e[3],e[2]]:e;return r.BBOX=a.join(","),E_(n,r)}function nF(n,e,t,i,r,s,o){s=Object.assign({REQUEST:"GetMap"},s);const a=e/t,u=[j2(st(n)/a,jA),j2(Jn(n)/a,jA)];if(t!=1)switch(o){case"geoserver":const d=90*t+.5|0;"FORMAT_OPTIONS"in s?s.FORMAT_OPTIONS+=";dpi:"+d:s.FORMAT_OPTIONS="dpi:"+d;break;case"mapserver":s.MAP_RESOLUTION=90*t;break;case"carmentaserver":case"qgis":s.DPI=90*t;break;default:throw new Error("Unknown `serverType` configured")}return tF(r,n,u,i,s)}function UA(n,e){return Object.assign({REQUEST:e,SERVICE:"WMS",VERSION:vE,FORMAT:"image/png",STYLES:"",TRANSPARENT:"TRUE"},n)}const iF='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.';class rF extends qd{constructor(e){e=e||{};let t;e.attributions!==void 0?t=e.attributions:t=[iF];const i=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",r=e.url!==void 0?e.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:t,attributionsCollapsible:!1,cacheSize:e.cacheSize,crossOrigin:i,interpolate:e.interpolate,maxZoom:e.maxZoom!==void 0?e.maxZoom:19,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:(s,o)=>{const a=s.getImage();!Wi&&a instanceof HTMLImageElement&&(a.referrerPolicy="origin-when-cross-origin"),(e.tileLoadFunction||d4)(s,o)},transition:e.transition,url:r,wrapX:e.wrapX,zDirection:e.zDirection})}}const w_=1/0;class sF{constructor(e,t){this.priorityFunction_=e,this.keyFunction_=t,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,gg(this.queuedElements_)}dequeue(){const e=this.elements_,t=this.priorities_,i=e[0];e.length==1?(e.length=0,t.length=0):(e[0]=e.pop(),t[0]=t.pop(),this.siftUp_(0));const r=this.keyFunction_(i);return delete this.queuedElements_[r],i}enqueue(e){pt(!(this.keyFunction_(e)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const t=this.priorityFunction_(e);return t!=w_?(this.elements_.push(e),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(e){return e*2+1}getRightChildIndex_(e){return e*2+2}getParentIndex_(e){return e-1>>1}heapify_(){let e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)}isEmpty(){return this.elements_.length===0}isKeyQueued(e){return e in this.queuedElements_}isQueued(e){return this.isKeyQueued(this.keyFunction_(e))}siftUp_(e){const t=this.elements_,i=this.priorities_,r=t.length,s=t[e],o=i[e],a=e;for(;e<r>>1;){const u=this.getLeftChildIndex_(e),h=this.getRightChildIndex_(e),d=h<r&&i[h]<i[u]?h:u;t[e]=t[d],i[e]=i[d],e=d}t[e]=s,i[e]=o,this.siftDown_(a,e)}siftDown_(e,t){const i=this.elements_,r=this.priorities_,s=i[t],o=r[t];for(;t>e;){const a=this.getParentIndex_(t);if(r[a]>o)i[t]=i[a],r[t]=r[a],t=a;else break}i[t]=s,r[t]=o}reprioritize(){const e=this.priorityFunction_,t=this.elements_,i=this.priorities_;let r=0;const s=t.length;let o,a,u;for(a=0;a<s;++a)o=t[a],u=e(o),u==w_?delete this.queuedElements_[this.keyFunction_(o)]:(i[r]=u,t[r++]=o);t.length=r,i.length=r,this.heapify_()}}class oF extends sF{constructor(e,t){super(i=>e.apply(null,i),i=>i[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=t,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(e){const t=super.enqueue(e);return t&&e[0].addEventListener(qe.CHANGE,this.boundHandleTileChange_),t}getTilesLoading(){return this.tilesLoading_}handleTileChange(e){const t=e.target,i=t.getState();if(i===De.LOADED||i===De.ERROR||i===De.EMPTY){i!==De.ERROR&&t.removeEventListener(qe.CHANGE,this.boundHandleTileChange_);const r=t.getKey();r in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[r],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(e,t){let i=0;for(;this.tilesLoading_<e&&i<t&&this.getCount()>0;){const r=this.dequeue()[0],s=r.getKey();r.getState()===De.IDLE&&!(s in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++i,r.load())}}}function aF(n,e,t,i,r){if(!n||!(t in n.wantedTiles)||!n.wantedTiles[t][e.getKey()])return w_;const s=n.viewState.center,o=i[0]-s[0],a=i[1]-s[1];return 65536*Math.log(r)+Math.sqrt(o*o+a*a)/r}class lF extends _x{constructor(e){e=e||{};const t=Object.assign({},e.params);super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:e.tileClass,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0,this.params_=t,this.v13_=!0,this.serverType_=e.serverType,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.tmpExtent_=Xi(),this.updateV13_(),this.setKey(this.getKeyForParams_())}getFeatureInfoUrl(e,t,i,r){const s=An(i),o=this.getProjection()||s;let a=this.getTileGrid();a||(a=this.getTileGridForProjection(o));const u=vg(e,s,o),h=_E(o,s,e,t),d=a.getZForResolution(h,this.zDirection),g=a.getResolution(d),m=a.getTileCoordForCoordAndZ(u,d);if(a.getResolutions().length<=m[0])return;let v=a.getTileCoordExtent(m,this.tmpExtent_);const y=this.gutter_;y!==0&&(v=bf(v,g*y,v));const T={QUERY_LAYERS:this.params_.LAYERS};Object.assign(T,UA(this.params_,"GetFeatureInfo"),r);const w=Math.floor((u[0]-v[0])/g),A=Math.floor((v[3]-u[1])/g);return T[this.v13_?"I":"X"]=w,T[this.v13_?"J":"Y"]=A,this.getRequestUrl_(m,v,1,o||s,T)}getLegendUrl(e,t){if(this.urls[0]===void 0)return;const i={SERVICE:"WMS",VERSION:vE,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(t===void 0||t.LAYER===void 0){const r=this.params_.LAYERS;if(!(!Array.isArray(r)||r.length===1))return;i.LAYER=r}if(e!==void 0){const r=this.getProjection()?this.getProjection().getMetersPerUnit():1,s=28e-5;i.SCALE=e*r/s}return Object.assign(i,t),E_(this.urls[0],i)}getGutter(){return this.gutter_}getParams(){return this.params_}getRequestUrl_(e,t,i,r,s){const o=this.urls;if(!o)return;let a;if(o.length==1)a=o[0];else{const u=Ia(l4(e),o.length);a=o[u]}return nF(t,(this.tileGrid||this.getTileGridForProjection(r)).getResolution(e[0]),i,r,a,s,this.serverType_)}getTilePixelRatio(e){return!this.hidpi_||this.serverType_===void 0?1:e}getKeyForParams_(){let e=0;const t=[];for(const i in this.params_)t[e++]=i+"-"+this.params_[i];return t.join("/")}setParams_(e){this.params_=e,this.updateV13_(),this.setKey(this.getKeyForParams_())}setParams(e){this.setParams_(Object.assign({},e))}updateParams(e){this.setParams_(Object.assign(this.params_,e))}updateV13_(){const e=this.params_.VERSION||vE;this.v13_=JM(e,"1.3")>=0}tileUrlFunction(e,t,i){let r=this.getTileGrid();if(r||(r=this.getTileGridForProjection(i)),r.getResolutions().length<=e[0])return;t!=1&&(!this.hidpi_||this.serverType_===void 0)&&(t=1);const s=r.getResolution(e[0]);let o=r.getTileCoordExtent(e,this.tmpExtent_);const a=this.gutter_;a!==0&&(o=bf(o,s*a,o));const u=Object.assign({},UA(this.params_,"GetMap"));return this.getRequestUrl_(e,o,t,i,u)}}class uF extends _x{constructor(e){const t=e.requestEncoding!==void 0?e.requestEncoding:"KVP",i=e.tileGrid;let r=e.urls;r===void 0&&e.url!==void 0&&(r=h4(e.url)),super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:e.tileClass,tileGrid:i,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,urls:r,wrapX:e.wrapX!==void 0?e.wrapX:!1,transition:e.transition,zDirection:e.zDirection}),this.version_=e.version!==void 0?e.version:"1.0.0",this.format_=e.format!==void 0?e.format:"image/jpeg",this.dimensions_=e.dimensions!==void 0?e.dimensions:{},this.layer_=e.layer,this.matrixSet_=e.matrixSet,this.style_=e.style,this.requestEncoding_=t,this.setKey(this.getKeyForDimensions_()),r&&r.length>0&&(this.tileUrlFunction=yE(r.map(this.createFromWMTSTemplate.bind(this))))}setUrls(e){this.urls=e;const t=e.join(`
`);this.setTileUrlFunction(yE(e.map(this.createFromWMTSTemplate.bind(this))),t)}getDimensions(){return this.dimensions_}getFormat(){return this.format_}getLayer(){return this.layer_}getMatrixSet(){return this.matrixSet_}getRequestEncoding(){return this.requestEncoding_}getStyle(){return this.style_}getVersion(){return this.version_}getKeyForDimensions_(){const e=this.urls?this.urls.slice(0):[];for(const t in this.dimensions_)e.push(t+"-"+this.dimensions_[t]);return e.join("/")}updateDimensions(e){Object.assign(this.dimensions_,e),this.setKey(this.getKeyForDimensions_())}createFromWMTSTemplate(e){const t=this.requestEncoding_,i={layer:this.layer_,style:this.style_,tilematrixset:this.matrixSet_};t=="KVP"&&Object.assign(i,{Service:"WMTS",Request:"GetTile",Version:this.version_,Format:this.format_}),e=t=="KVP"?E_(e,i):e.replace(/\{(\w+?)\}/g,function(o,a){return a.toLowerCase()in i?i[a.toLowerCase()]:o});const r=this.tileGrid,s=this.dimensions_;return(function(o,a,u){if(!o)return;const h={TileMatrix:r.getMatrixId(o[0]),TileCol:o[1],TileRow:o[2]};Object.assign(h,s);let d=e;return t=="KVP"?d=E_(d,h):d=d.replace(/\{(\w+?)\}/g,function(g,m){return encodeURIComponent(h[m])}),d})}}class Rc extends Ao{constructor(e,t,i){super(e),this.map=t,this.frameState=i!==void 0?i:null}}class ca extends Rc{constructor(e,t,i,r,s,o){super(e,t,s),this.originalEvent=i,this.pixel_=null,this.coordinate_=null,this.dragging=r!==void 0?r:!1,this.activePointers=o}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(e){this.pixel_=e}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(e){this.coordinate_=e}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const Kt={SINGLECLICK:"singleclick",CLICK:qe.CLICK,DBLCLICK:qe.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},EE={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown"};class cF extends mg{constructor(e,t){super(e),this.map_=e,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=t===void 0?1:t,this.down_=null;const i=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=i,this.pointerdownListenerKey_=lt(i,EE.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=lt(i,EE.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(qe.TOUCHMOVE,this.boundHandleTouchMove_,xb?{passive:!1}:!1)}emulateClick_(e){let t=new ca(Kt.CLICK,this.map_,e);this.dispatchEvent(t),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,t=new ca(Kt.DBLCLICK,this.map_,e),this.dispatchEvent(t)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const i=new ca(Kt.SINGLECLICK,this.map_,e);this.dispatchEvent(i)},250)}updateActivePointers_(e){const t=e,i=t.pointerId;if(t.type==Kt.POINTERUP||t.type==Kt.POINTERCANCEL){delete this.trackedTouches_[i];for(const r in this.trackedTouches_)if(this.trackedTouches_[r].target!==t.target){delete this.trackedTouches_[r];break}}else(t.type==Kt.POINTERDOWN||t.type==Kt.POINTERMOVE)&&(this.trackedTouches_[i]=t);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(e){this.updateActivePointers_(e);const t=new ca(Kt.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(t),this.emulateClicks_&&!t.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(Vt),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(e){return e.button===0}handlePointerDown_(e){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(e);const t=new ca(Kt.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);if(this.dispatchEvent(t),this.down_=new PointerEvent(e.type,e),Object.defineProperty(this.down_,"target",{writable:!1,value:e.target}),this.dragListenerKeys_.length===0){const i=this.map_.getOwnerDocument();this.dragListenerKeys_.push(lt(i,Kt.POINTERMOVE,this.handlePointerMove_,this),lt(i,Kt.POINTERUP,this.handlePointerUp_,this),lt(this.element_,Kt.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==i&&this.dragListenerKeys_.push(lt(this.element_.getRootNode(),Kt.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;const t=new ca(Kt.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(t)}}relayMoveEvent_(e){this.originalPointerMoveEvent_=e;const t=!!(this.down_&&this.isMoving_(e));this.dispatchEvent(new ca(Kt.POINTERMOVE,this.map_,e,t))}handleTouchMove_(e){const t=this.originalPointerMoveEvent_;(!t||t.defaultPrevented)&&(typeof e.cancelable!="boolean"||e.cancelable===!0)&&e.preventDefault()}isMoving_(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(Vt(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(qe.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(Vt(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(Vt),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const ha={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},Hn={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};class yx extends Vs{constructor(e){super();const t=e.element;t&&!e.target&&!t.style.pointerEvents&&(t.style.pointerEvents="auto"),this.element=t||null,this.target_=null,this.map_=null,this.listenerKeys=[],e.render&&(this.render=e.render),e.target&&this.setTarget(e.target)}disposeInternal(){this.element?.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(e){this.map_&&this.element?.remove();for(let t=0,i=this.listenerKeys.length;t<i;++t)Vt(this.listenerKeys[t]);if(this.listenerKeys.length=0,this.map_=e,e){const t=this.target_??e.getOverlayContainerStopEvent();this.element&&t.appendChild(this.element),this.render!==Mf&&this.listenerKeys.push(lt(e,ha.POSTRENDER,this.render,this)),e.render()}}render(e){}setTarget(e){this.target_=typeof e=="string"?document.getElementById(e):e}}class hF extends yx{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=e.collapsible!==void 0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=e.attributions;const t=e.className!==void 0?e.className:"ol-attribution",i=e.tipLabel!==void 0?e.tipLabel:"Attributions",r=e.expandClassName!==void 0?e.expandClassName:t+"-expand",s=e.collapseLabel!==void 0?e.collapseLabel:"",o=e.collapseClassName!==void 0?e.collapseClassName:t+"-collapse";typeof s=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=o):this.collapseLabel_=s;const a=e.label!==void 0?e.label:"i";typeof a=="string"?(this.label_=document.createElement("span"),this.label_.textContent=a,this.label_.className=r):this.label_=a;const u=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=i,this.toggleButton_.appendChild(u),this.toggleButton_.addEventListener(qe.CLICK,this.handleClick_.bind(this),!1);const h=t+" "+R0+" "+tx+(this.collapsed_&&this.collapsible_?" "+iA:"")+(this.collapsible_?"":" ol-uncollapsible"),d=this.element;d.className=h,d.appendChild(this.toggleButton_),d.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(e){const t=this.getMap().getAllLayers(),i=new Set(t.flatMap(r=>r.getAttributions(e)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(r=>i.add(r)):i.add(this.attributions_)),!this.overrideCollapsible_){const r=!t.some(s=>s.getSource()?.getAttributionsCollapsible()===!1);this.setCollapsible(r)}return Array.from(i)}async updateElement_(e){if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=await Promise.all(this.collectSourceAttributions_(e).map(r=>zM(()=>r))),i=t.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!Wa(t,this.renderedAttributions_)){c6(this.ulElement_);for(let r=0,s=t.length;r<s;++r){const o=document.createElement("li");o.innerHTML=t[r],this.ulElement_.appendChild(o)}this.renderedAttributions_=t}}handleClick_(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(iA),this.collapsed_?tA(this.collapseLabel_,this.label_):tA(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(e){this.userCollapsed_=e,!(!this.collapsible_||this.collapsed_===e)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(e){this.updateElement_(e.frameState)}}class dF extends yx{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target});const t=e.className!==void 0?e.className:"ol-rotate",i=e.label!==void 0?e.label:"",r=e.compassClassName!==void 0?e.compassClassName:"ol-compass";this.label_=null,typeof i=="string"?(this.label_=document.createElement("span"),this.label_.className=r,this.label_.textContent=i):(this.label_=i,this.label_.classList.add(r));const s=e.tipLabel?e.tipLabel:"Reset rotation",o=document.createElement("button");o.className=t+"-reset",o.setAttribute("type","button"),o.title=s,o.appendChild(this.label_),o.addEventListener(qe.CLICK,this.handleClick_.bind(this),!1);const a=t+" "+R0+" "+tx,u=this.element;u.className=a,u.appendChild(o),this.callResetNorth_=e.resetNorth?e.resetNorth:void 0,this.duration_=e.duration!==void 0?e.duration:250,this.autoHide_=e.autoHide!==void 0?e.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(up)}handleClick_(e){e.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const i=t.getRotation();i!==void 0&&(this.duration_>0&&i%(2*Math.PI)!==0?t.animate({rotation:0,duration:this.duration_,easing:bh}):t.setRotation(0))}render(e){const t=e.frameState;if(!t)return;const i=t.viewState.rotation;if(i!=this.rotation_){const r="rotate("+i+"rad)";if(this.autoHide_){const s=this.element.classList.contains(up);!s&&i===0?this.element.classList.add(up):s&&i!==0&&this.element.classList.remove(up)}this.label_.style.transform=r}this.rotation_=i}}class fF extends yx{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target});const t=e.className!==void 0?e.className:"ol-zoom",i=e.delta!==void 0?e.delta:1,r=e.zoomInClassName!==void 0?e.zoomInClassName:t+"-in",s=e.zoomOutClassName!==void 0?e.zoomOutClassName:t+"-out",o=e.zoomInLabel!==void 0?e.zoomInLabel:"+",a=e.zoomOutLabel!==void 0?e.zoomOutLabel:"",u=e.zoomInTipLabel!==void 0?e.zoomInTipLabel:"Zoom in",h=e.zoomOutTipLabel!==void 0?e.zoomOutTipLabel:"Zoom out",d=document.createElement("button");d.className=r,d.setAttribute("type","button"),d.title=u,d.appendChild(typeof o=="string"?document.createTextNode(o):o),d.addEventListener(qe.CLICK,this.handleClick_.bind(this,i),!1);const g=document.createElement("button");g.className=s,g.setAttribute("type","button"),g.title=h,g.appendChild(typeof a=="string"?document.createTextNode(a):a),g.addEventListener(qe.CLICK,this.handleClick_.bind(this,-i),!1);const m=t+" "+R0+" "+tx,v=this.element;v.className=m,v.appendChild(d),v.appendChild(g),this.duration_=e.duration!==void 0?e.duration:250}handleClick_(e,t){t.preventDefault(),this.zoomByDelta_(e)}zoomByDelta_(e){const i=this.getMap().getView();if(!i)return;const r=i.getZoom();if(r!==void 0){const s=i.getConstrainedZoom(r+e);this.duration_>0?(i.getAnimating()&&i.cancelAnimations(),i.animate({zoom:s,duration:this.duration_,easing:bh})):i.setZoom(s)}}}function gF(n){n=n||{};const e=new vr;return(n.zoom===void 0||n.zoom)&&e.push(new fF(n.zoomOptions)),(n.rotate===void 0||n.rotate)&&e.push(new dF(n.rotateOptions)),(n.attribution===void 0||n.attribution)&&e.push(new hF(n.attributionOptions)),e}class mF{constructor(e,t,i){this.decay_=e,this.minVelocity_=t,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(e,t){this.points_.push(e,t,Date.now())}end(){if(this.points_.length<6)return!1;const e=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[t+2]<e)return!1;let i=t-3;for(;i>0&&this.points_[i+2]>e;)i-=3;const r=this.points_[t+2]-this.points_[i+2];if(r<1e3/60)return!1;const s=this.points_[t]-this.points_[i],o=this.points_[t+1]-this.points_[i+1];return this.angle_=Math.atan2(o,s),this.initialVelocity_=Math.sqrt(s*s+o*o)/r,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}const BA={ACTIVE:"active"};class xg extends Vs{constructor(e){super(),this.on,this.once,this.un,e&&e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(BA.ACTIVE)}getMap(){return this.map_}handleEvent(e){return!0}setActive(e){this.set(BA.ACTIVE,e)}setMap(e){this.map_=e}}function pF(n,e,t){const i=n.getCenterInternal();if(i){const r=[i[0]+e[0],i[1]+e[1]];n.animateInternal({duration:t!==void 0?t:250,easing:f8,center:n.getConstrainedCenter(r)})}}function vx(n,e,t,i){const r=n.getZoom();if(r===void 0)return;const s=n.getConstrainedZoom(r+e),o=n.getResolutionForZoom(s);n.getAnimating()&&n.cancelAnimations(),n.animate({resolution:o,anchor:t,duration:i!==void 0?i:250,easing:bh})}class _F extends xg{constructor(e){super(),e=e||{},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:250}handleEvent(e){let t=!1;if(e.type==Kt.DBLCLICK){const i=e.originalEvent,r=e.map,s=e.coordinate,o=i.shiftKey?-this.delta_:this.delta_,a=r.getView();vx(a,o,s,this.duration_),i.preventDefault(),t=!0}return!t}}function wE(n){const e=arguments;return function(t){let i=!0;for(let r=0,s=e.length;r<s&&(i=i&&e[r](t),!!i);++r);return i}}const yF=function(n){const e=n.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},vF=function(n){const e=n.map.getTargetElement(),t=e.getRootNode(),i=n.map.getOwnerDocument().activeElement;return t instanceof ShadowRoot?t.host.contains(i):e.contains(i)},f4=function(n){const e=n.map.getTargetElement(),t=e.getRootNode();return(t instanceof ShadowRoot?t.host:e).hasAttribute("tabindex")?vF(n):!0},EF=Cf,g4=function(n){const e=n.originalEvent;return"pointerId"in e&&e.button==0&&!(l6&&Eb&&e.ctrlKey)},m4=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},wF=function(n){const e=n.originalEvent;return Eb?e.metaKey:e.ctrlKey},xF=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},p4=function(n){const e=n.originalEvent,t=e.target.tagName;return t!=="INPUT"&&t!=="SELECT"&&t!=="TEXTAREA"&&!e.target.isContentEditable},f1=function(n){const e=n.originalEvent;return"pointerId"in e&&e.pointerType=="mouse"},SF=function(n){const e=n.originalEvent;return"pointerId"in e&&e.isPrimary&&e.button===0};class Sg extends xg{constructor(e){e=e||{},super(e),e.handleDownEvent&&(this.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(this.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(this.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(this.handleUpEvent=e.handleUpEvent),e.stopDown&&(this.stopDown=e.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(e){return!1}handleDragEvent(e){}handleEvent(e){if(!e.originalEvent)return!0;let t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==Kt.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==Kt.POINTERUP){const i=this.handleUpEvent(e);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(e.type==Kt.POINTERDOWN){const i=this.handleDownEvent(e);this.handlingDownUpSequence=i,t=this.stopDown(i)}else e.type==Kt.POINTERMOVE&&this.handleMoveEvent(e);return!t}handleMoveEvent(e){}handleUpEvent(e){return!1}stopDown(e){return e}updateTrackedPointers_(e){e.activePointers&&(this.targetPointers=e.activePointers)}}function Ex(n){const e=n.length;let t=0,i=0;for(let r=0;r<e;r++)t+=n[r].clientX,i+=n[r].clientY;return{clientX:t/e,clientY:i/e}}class TF extends Sg{constructor(e){super({stopDown:m0}),e=e||{},this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const t=e.condition?e.condition:wE(m4,SF);this.condition_=e.onFocusOnly?wE(f4,t):t,this.noKinetic_=!1}handleDragEvent(e){const t=e.map;this.panning_||(this.panning_=!0,t.getView().beginInteraction());const i=this.targetPointers,r=t.getEventPixel(Ex(i));if(i.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(r[0],r[1]),this.lastCentroid){const s=[this.lastCentroid[0]-r[0],r[1]-this.lastCentroid[1]],a=e.map.getView();_5(s,a.getResolution()),Fw(s,a.getRotation()),a.adjustCenterInternal(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=r,this.lastPointersCount_=i.length,e.originalEvent.preventDefault()}handleUpEvent(e){const t=e.map,i=t.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const r=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),o=i.getCenterInternal(),a=t.getPixelFromCoordinateInternal(o),u=t.getCoordinateFromPixelInternal([a[0]-r*Math.cos(s),a[1]-r*Math.sin(s)]);i.animateInternal({center:i.getConstrainedCenter(u),duration:500,easing:bh})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(e){if(this.targetPointers.length>0&&this.condition_(e)){const i=e.map.getView();return this.lastCentroid=null,i.getAnimating()&&i.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class IF extends Sg{constructor(e){e=e||{},super({stopDown:m0}),this.condition_=e.condition?e.condition:yF,this.lastAngle_=void 0,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){if(!f1(e))return;const t=e.map,i=t.getView();if(i.getConstraints().rotation===ux)return;const r=t.getSize(),s=e.pixel,o=Math.atan2(r[1]/2-s[1],s[0]-r[0]/2);if(this.lastAngle_!==void 0){const a=o-this.lastAngle_;i.adjustRotationInternal(-a)}this.lastAngle_=o}handleUpEvent(e){return f1(e)?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){return f1(e)&&g4(e)&&this.condition_(e)?(e.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class AF extends f0{constructor(e){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const e=this.startPixel_,t=this.endPixel_,i="px",r=this.element_.style;r.left=Math.min(e[0],t[0])+i,r.top=Math.min(e[1],t[1])+i,r.width=Math.abs(t[0]-e[0])+i,r.height=Math.abs(t[1]-e[1])+i}setMap(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(e,t){this.startPixel_=e,this.endPixel_=t,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const e=this.startPixel_,t=this.endPixel_,r=[e,[e[0],t[1]],t,[t[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);r[4]=r[0].slice(),this.geometry_?this.geometry_.setCoordinates([r]):this.geometry_=new nu([r])}getGeometry(){return this.geometry_}}const _c={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class kd extends Ao{constructor(e,t,i){super(e),this.coordinate=t,this.mapBrowserEvent=i}}class RF extends Sg{constructor(e){super(),this.on,this.once,this.un,e=e??{},this.box_=new AF(e.className||"ol-dragbox"),this.minArea_=e.minArea??64,e.onBoxEnd&&(this.onBoxEnd=e.onBoxEnd),this.startPixel_=null,this.condition_=e.condition??g4,this.boxEndCondition_=e.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(e,t,i){const r=i[0]-t[0],s=i[1]-t[1];return r*r+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(e){this.startPixel_&&(this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new kd(_c.BOXDRAG,e.coordinate,e)))}handleUpEvent(e){if(!this.startPixel_)return!1;const t=this.boxEndCondition_(e,this.startPixel_,e.pixel);return t&&this.onBoxEnd(e),this.dispatchEvent(new kd(t?_c.BOXEND:_c.BOXCANCEL,e.coordinate,e)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(e){return this.condition_(e)?(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new kd(_c.BOXSTART,e.coordinate,e)),!0):!1}onBoxEnd(e){}setActive(e){e||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new kd(_c.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(e)}setMap(e){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new kd(_c.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(e)}}class PF extends RF{constructor(e){e=e||{};const t=e.condition?e.condition:xF;super({condition:t,className:e.className||"ol-dragzoom",minArea:e.minArea}),this.duration_=e.duration!==void 0?e.duration:200,this.out_=e.out!==void 0?e.out:!1}onBoxEnd(e){const i=this.getMap().getView();let r=this.getGeometry();if(this.out_){const s=i.rotatedExtentForGeometry(r),o=i.getResolutionForExtentInternal(s),a=i.getResolution()/o;r=r.clone(),r.scale(a*a)}i.fitInternal(r,{duration:this.duration_,easing:bh})}}const Sl={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class CF extends xg{constructor(e){super(),e=e||{},this.defaultCondition_=function(t){return m4(t)&&p4(t)},this.condition_=e.condition!==void 0?e.condition:this.defaultCondition_,this.duration_=e.duration!==void 0?e.duration:100,this.pixelDelta_=e.pixelDelta!==void 0?e.pixelDelta:128}handleEvent(e){let t=!1;if(e.type==qe.KEYDOWN){const i=e.originalEvent,r=i.key;if(this.condition_(e)&&(r==Sl.DOWN||r==Sl.LEFT||r==Sl.RIGHT||r==Sl.UP)){const o=e.map.getView(),a=o.getResolution()*this.pixelDelta_;let u=0,h=0;r==Sl.DOWN?h=-a:r==Sl.LEFT?u=-a:r==Sl.RIGHT?u=a:h=a;const d=[u,h];Fw(d,o.getRotation()),pF(o,d,this.duration_),i.preventDefault(),t=!0}}return!t}}class MF extends xg{constructor(e){super(),e=e||{},this.condition_=e.condition?e.condition:function(t){return!wF(t)&&p4(t)},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:100}handleEvent(e){let t=!1;if(e.type==qe.KEYDOWN||e.type==qe.KEYPRESS){const i=e.originalEvent,r=i.key;if(this.condition_(e)&&(r==="+"||r==="-")){const s=e.map,o=r==="+"?this.delta_:-this.delta_,a=s.getView();vx(a,o,void 0,this.duration_),i.preventDefault(),t=!0}}return!t}}const bF=40,LF=300;class kF extends xg{constructor(e){e=e||{},super(e),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=e.maxDelta!==void 0?e.maxDelta:1,this.duration_=e.duration!==void 0?e.duration:250,this.timeout_=e.timeout!==void 0?e.timeout:80,this.useAnchor_=e.useAnchor!==void 0?e.useAnchor:!0,this.constrainResolution_=e.constrainResolution!==void 0?e.constrainResolution:!1;const t=e.condition?e.condition:EF;this.condition_=e.onFocusOnly?wE(f4,t):t,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const e=this.getMap();if(!e)return;e.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(e){if(!this.condition_(e)||e.type!==qe.WHEEL)return!0;const i=e.map,r=e.originalEvent;r.preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.pixel);let s=r.deltaY;switch(r.deltaMode){case WheelEvent.DOM_DELTA_LINE:s*=bF;break;case WheelEvent.DOM_DELTA_PAGE:s*=LF;break}if(s===0)return!1;this.lastDelta_=s;const o=Date.now();this.startTime_===void 0&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?"trackpad":"wheel");const a=i.getView();if(this.mode_==="trackpad"&&!(a.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(a.getAnimating()&&a.cancelAnimations(),a.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),a.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_?i.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=o,!1;this.totalDelta_+=s;const u=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,i),u),!1}handleWheelZoom_(e){const t=e.getView();t.getAnimating()&&t.cancelAnimations();let i=-Lt(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(t.getConstrainResolution()||this.constrainResolution_)&&(i=i?i>0?1:-1:0),vx(t,i,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(e){this.useAnchor_=e,e||(this.lastAnchor_=null)}}class DF extends Sg{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=m0),super(t),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=e.threshold!==void 0?e.threshold:.3,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){let t=0;const i=this.targetPointers[0],r=this.targetPointers[1],s=Math.atan2(r.clientY-i.clientY,r.clientX-i.clientX);if(this.lastAngle_!==void 0){const u=s-this.lastAngle_;this.rotationDelta_+=u,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),t=u}this.lastAngle_=s;const o=e.map,a=o.getView();a.getConstraints().rotation!==ux&&(this.anchor_=o.getCoordinateFromPixelInternal(o.getEventPixel(Ex(this.targetPointers))),this.rotating_&&(o.render(),a.adjustRotationInternal(t,this.anchor_)))}handleUpEvent(e){return this.targetPointers.length<2?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}class NF extends Sg{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=m0),super(t),this.anchor_=null,this.duration_=e.duration!==void 0?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(e){let t=1;const i=this.targetPointers[0],r=this.targetPointers[1],s=i.clientX-r.clientX,o=i.clientY-r.clientY,a=Math.sqrt(s*s+o*o);this.lastDistance_!==void 0&&(t=this.lastDistance_/a),this.lastDistance_=a;const u=e.map,h=u.getView();t!=1&&(this.lastScaleDelta_=t),this.anchor_=u.getCoordinateFromPixelInternal(u.getEventPixel(Ex(this.targetPointers))),u.render(),h.adjustResolutionInternal(t,this.anchor_)}handleUpEvent(e){if(this.targetPointers.length<2){const i=e.map.getView(),r=this.lastScaleDelta_>1?1:-1;return i.endInteraction(this.duration_,r),!1}return!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}function OF(n){n=n||{};const e=new vr,t=new mF(-.005,.05,100);return(n.altShiftDragRotate===void 0||n.altShiftDragRotate)&&e.push(new IF),(n.doubleClickZoom===void 0||n.doubleClickZoom)&&e.push(new _F({delta:n.zoomDelta,duration:n.zoomDuration})),(n.dragPan===void 0||n.dragPan)&&e.push(new TF({onFocusOnly:n.onFocusOnly,kinetic:t})),(n.pinchRotate===void 0||n.pinchRotate)&&e.push(new DF),(n.pinchZoom===void 0||n.pinchZoom)&&e.push(new NF({duration:n.zoomDuration})),(n.keyboard===void 0||n.keyboard)&&(e.push(new CF),e.push(new MF({delta:n.zoomDelta,duration:n.zoomDuration}))),(n.mouseWheelZoom===void 0||n.mouseWheelZoom)&&e.push(new kF({onFocusOnly:n.onFocusOnly,duration:n.zoomDuration})),(n.shiftDragZoom===void 0||n.shiftDragZoom)&&e.push(new PF({duration:n.zoomDuration})),e}class VF extends f0{constructor(e){super(),this.map_=e}dispatchRenderEvent(e,t){at()}calculateMatrices2D(e){const t=e.viewState,i=e.coordinateToPixelTransform,r=e.pixelToCoordinateTransform;vo(i,e.size[0]/2,e.size[1]/2,1/t.resolution,-1/t.resolution,-t.rotation,-t.center[0],-t.center[1]),cb(r,i)}forEachFeatureAtCoordinate(e,t,i,r,s,o,a,u){let h;const d=t.viewState;function g(k,N,B,b){return s.call(o,N,k?B:null,b)}const m=d.projection,v=eb(e.slice(),m),y=[[0,0]];if(m.canWrapX()&&r){const k=m.getExtent(),N=st(k);y.push([-N,0],[N,0])}const T=t.layerStatesArray,w=T.length,A=[],P=[];for(let k=0;k<y.length;k++)for(let N=w-1;N>=0;--N){const B=T[N],b=B.layer;if(b.hasRenderer()&&hx(B,d)&&a.call(u,b)){const R=b.getRenderer(),L=b.getSource();if(R&&L){const V=L.getWrapX()?v:e,F=g.bind(null,B.managed);P[0]=V[0]+y[k][0],P[1]=V[1]+y[k][1],h=R.forEachFeatureAtCoordinate(P,t,i,F,A)}if(h)return h}}if(A.length===0)return;const M=1/A.length;return A.forEach((k,N)=>k.distanceSq+=N*M),A.sort((k,N)=>k.distanceSq-N.distanceSq),A.some(k=>h=k.callback(k.feature,k.layer,k.geometry)),h}hasFeatureAtCoordinate(e,t,i,r,s,o){return this.forEachFeatureAtCoordinate(e,t,i,r,Cf,this,s,o)!==void 0}getMap(){return this.map_}renderFrame(e){at()}scheduleExpireIconCache(e){wr.canExpireCache()&&e.postRenderFunctions.push(FF)}}function FF(n,e){wr.expire()}class GF extends VF{constructor(e){super(e),this.fontChangeListenerKey_=lt(Tc,sh.PROPERTYCHANGE,e.redrawText,e),this.element_=Wi?Sb():document.createElement("div");const t=this.element_.style;t.position="absolute",t.width="100%",t.height="100%",t.zIndex="0",this.element_.className=R0+" ol-layers";const i=e.getViewport();i&&i.insertBefore(this.element_,i.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(e,t){const i=this.getMap();if(i.hasListener(e)){const r=new Kb(e,void 0,t);i.dispatchEvent(r)}}disposeInternal(){Vt(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(e){if(!e){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(e),this.dispatchRenderEvent(Er.PRECOMPOSE,e);const t=e.layerStatesArray.sort((h,d)=>h.zIndex-d.zIndex);t.some(h=>h.layer instanceof i4&&h.layer.getDeclutter())&&(e.declutter={});const r=e.viewState;this.children_.length=0;const s=[];let o=null;for(let h=0,d=t.length;h<d;++h){const g=t[h];e.layerIndex=h;const m=g.layer,v=m.getSourceState();if(!hx(g,r)||v!="ready"&&v!="undefined"){m.unrender();continue}const y=m.render(e,o);y&&(y!==o&&(this.children_.push(y),o=y),s.push(g))}this.declutter(e,s),h6(this.element_,this.children_);const u=this.getMap().getTargetElement();if(Ea(u)){const h=u.getContext("2d");for(const d of this.children_){const g=d.firstElementChild||d,m=d.style.backgroundColor;if(m&&(!Ea(g)||g.width>0)&&(h.fillStyle=m,h.fillRect(0,0,u.width,u.height)),Ea(g)&&g.width>0){const v=d.style.opacity||g.style.opacity;h.globalAlpha=v===""?1:Number(v);const y=g.style.transform;if(y)h.setTransform(...aE(y));else{const T=parseFloat(g.style.width)/g.width,w=parseFloat(g.style.height)/g.height;h.setTransform(T,0,0,w,0,0)}h.drawImage(g,0,0)}}h.globalAlpha=1,h.setTransform(1,0,0,1,0,0)}this.dispatchRenderEvent(Er.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}declutter(e,t){if(e.declutter){for(let i=t.length-1;i>=0;--i){const r=t[i],s=r.layer;s.getDeclutter()&&s.renderDeclutter(e,r)}t.forEach(i=>i.layer.renderDeferred(e))}}}function _4(n){if(n instanceof L0){n.setMapInternal(null);return}n instanceof k0&&n.getLayers().forEach(_4)}function y4(n,e){if(n instanceof L0){n.setMapInternal(e);return}if(n instanceof k0){const t=n.getLayers().getArray();for(let i=0,r=t.length;i<r;++i)y4(t[i],e)}}let jF=class extends Vs{constructor(e){super(),e=e||{},this.on,this.once,this.un;const t=UF(e);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=e.maxTilesLoading!==void 0?e.maxTilesLoading:16,this.pixelRatio_=e.pixelRatio!==void 0?e.pixelRatio:u6,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=Xr(),this.pixelToCoordinateTransform_=Xr(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,Wi||(this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_)),this.mapBrowserEventHandler_=null,this.moveTolerance_=e.moveTolerance,this.keyboardEventTarget_=t.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,Wi||(this.resizeObserver_=new ResizeObserver(()=>this.updateSize())),this.controls=t.controls||(Wi?new vr:gF()),this.interactions=t.interactions||(Wi?new vr:OF({onFocusOnly:!0})),this.overlays_=t.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new oF(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(Hn.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(Hn.VIEW,this.handleViewChanged_),this.addChangeListener(Hn.SIZE,this.handleSizeChanged_),this.addChangeListener(Hn.TARGET,this.handleTargetChanged_),this.setProperties(t.values);const i=this;e.view&&!(e.view instanceof Ss)&&e.view.then(function(r){i.setView(new Ss(r))}),this.controls.addEventListener(Si.ADD,r=>{r.element.setMap(this)}),this.controls.addEventListener(Si.REMOVE,r=>{r.element.setMap(null)}),this.interactions.addEventListener(Si.ADD,r=>{r.element.setMap(this)}),this.interactions.addEventListener(Si.REMOVE,r=>{r.element.setMap(null)}),this.overlays_.addEventListener(Si.ADD,r=>{this.addOverlayInternal_(r.element)}),this.overlays_.addEventListener(Si.REMOVE,r=>{const s=r.element.getId();s!==void 0&&delete this.overlayIdIndex_[s.toString()],r.element.setMap(null)}),this.controls.forEach(r=>{r.setMap(this)}),this.interactions.forEach(r=>{r.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(e){this.getControls().push(e)}addInteraction(e){this.getInteractions().push(e)}addLayer(e){this.getLayerGroup().getLayers().push(e)}handleLayerAdd_(e){y4(e.layer,this)}addOverlay(e){this.getOverlays().push(e)}addOverlayInternal_(e){const t=e.getId();t!==void 0&&(this.overlayIdIndex_[t.toString()]=e),e.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_?.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(e,t,i){if(!this.frameState_||!this.renderer_)return;const r=this.getCoordinateFromPixelInternal(e);i=i!==void 0?i:{};const s=i.hitTolerance!==void 0?i.hitTolerance:0,o=i.layerFilter!==void 0?i.layerFilter:Cf,a=i.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(r,this.frameState_,s,a,t,null,o,null)}getFeaturesAtPixel(e,t){const i=[];return this.forEachFeatureAtPixel(e,function(r){i.push(r)},t),i}getAllLayers(){const e=[];function t(i){i.forEach(function(r){r instanceof k0?t(r.getLayers()):e.push(r)})}return t(this.getLayers()),e}hasFeatureAtPixel(e,t){if(!this.frameState_||!this.renderer_)return!1;const i=this.getCoordinateFromPixelInternal(e);t=t!==void 0?t:{};const r=t.layerFilter!==void 0?t.layerFilter:Cf,s=t.hitTolerance!==void 0?t.hitTolerance:0,o=t.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,s,o,r,null)}getEventCoordinate(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}getEventCoordinateInternal(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}getEventPixel(e){const i=this.viewport_.getBoundingClientRect(),r=this.getSize(),s=i.width/r[0],o=i.height/r[1],a="changedTouches"in e?e.changedTouches[0]:e;return[(a.clientX-i.left)/s,(a.clientY-i.top)/o]}getTarget(){return this.get(Hn.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(e){return oE(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}getCoordinateFromPixelInternal(e){const t=this.frameState_;return t?In(t.pixelToCoordinateTransform,e.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(e){const t=this.overlayIdIndex_[e.toString()];return t!==void 0?t:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(Hn.LAYERGROUP)}setLayers(e){const t=this.getLayerGroup();if(e instanceof vr){t.setLayers(e);return}const i=t.getLayers();i.clear(),i.extend(e)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const e=this.getLayerGroup().getLayerStatesArray();for(let t=0,i=e.length;t<i;++t){const r=e[t];if(!r.visible)continue;const s=r.layer.getRenderer();if(s&&!s.ready)return!0;const o=r.layer.getSource();if(o&&o.loading)return!0}return!1}getPixelFromCoordinate(e){const t=oo(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(t)}getPixelFromCoordinateInternal(e){const t=this.frameState_;return t?In(t.coordinateToPixelTransform,e.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(Hn.SIZE)}getView(){return this.get(Hn.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const e=this.getTargetElement();return e?e.ownerDocument:document}getTilePriority(e,t,i,r){return aF(this.frameState_,e,t,i,r)}handleBrowserEvent(e,t){t=t||e.type;const i=new ca(t,this,e);this.handleMapBrowserEvent(i)}handleMapBrowserEvent(e){if(!this.frameState_)return;const t=e.originalEvent,i=t.type;if(i===EE.POINTERDOWN||i===qe.WHEEL||i===qe.KEYDOWN){const r=this.getOwnerDocument(),s=this.viewport_.getRootNode?this.viewport_.getRootNode():r,o=t.target,a=s instanceof ShadowRoot?s.host===o?s.host.ownerDocument:s:s===r?r.documentElement:s;if(this.overlayContainerStopEvent_.contains(o)||!a.contains(o))return}if(e.frameState=this.frameState_,this.dispatchEvent(e)!==!1){const r=this.getInteractions().getArray().slice();for(let s=r.length-1;s>=0;s--){const o=r[s];if(o.getMap()!==this||!o.getActive()||!this.getTargetElement())continue;if(!o.handleEvent(e)||e.propagationStopped)break}}}handlePostRender(){const e=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){let r=this.maxTilesLoading_,s=r;if(e){const o=e.viewHints;if(o[Xn.ANIMATING]||o[Xn.INTERACTING]){const a=Date.now()-e.time>8;r=a?0:8,s=a?0:2}}t.getTilesLoading()<r&&(t.reprioritize(),t.loadMoreTiles(r,s))}e&&this.renderer_&&!e.animate&&(this.renderComplete_?(this.hasListener(Er.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(Er.RENDERCOMPLETE,e),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new Rc(ha.LOADEND,this,e)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new Rc(ha.LOADSTART,this,e))));const i=this.postRenderFunctions_;if(e)for(let r=0,s=i.length;r<s;++r)i[r](this,e);i.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let i=0,r=this.targetChangeHandlerKeys_.length;i<r;++i)Vt(this.targetChangeHandlerKeys_[i]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(qe.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(qe.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_&&!Ea(this.targetElement_)){this.resizeObserver_?.unobserve(this.targetElement_);const i=this.targetElement_.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.unobserve(i.host),this.setSize(void 0)}const e=this.getTarget(),t=typeof e=="string"?document.getElementById(e):e;if(this.targetElement_=t,!t)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{if(Ea(t)||t.appendChild(this.viewport_),this.renderer_||(this.renderer_=new GF(this)),!Ea(t)){this.mapBrowserEventHandler_=new cF(this,this.moveTolerance_);for(const r in Kt)this.mapBrowserEventHandler_.addEventListener(Kt[r],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(qe.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(qe.WHEEL,this.boundHandleBrowserEvent_,xb?{passive:!1}:!1);let i;if(this.keyboardEventTarget_)i=this.keyboardEventTarget_;else{const r=t.getRootNode();i=r instanceof ShadowRoot?r.host:t}if(this.targetChangeHandlerKeys_=[lt(i,qe.KEYDOWN,this.handleBrowserEvent,this),lt(i,qe.KEYPRESS,this.handleBrowserEvent,this)],t instanceof HTMLElement){const r=t.getRootNode();r instanceof ShadowRoot&&this.resizeObserver_.observe(r.host),this.resizeObserver_?.observe(t)}}this.updateSize()}}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(Vt(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(Vt(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const e=this.getView();e&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=lt(e,sh.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=lt(e,qe.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(Vt),this.layerGroupPropertyListenerKeys_=null);const e=this.getLayerGroup();e&&(this.handleLayerAdd_(new fa("addlayer",e)),this.layerGroupPropertyListenerKeys_=[lt(e,sh.PROPERTYCHANGE,this.render,this),lt(e,qe.CHANGE,this.render,this),lt(e,"addlayer",this.handleLayerAdd_,this),lt(e,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;const e=this.frameState_.layerStatesArray;for(let t=0,i=e.length;t<i;++t){const r=e[t].layer;r.hasRenderer()&&r.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(e){return this.getControls().remove(e)}removeInteraction(e){return this.getInteractions().remove(e)}removeLayer(e){return this.getLayerGroup().getLayers().remove(e)}handleLayerRemove_(e){_4(e.layer)}removeOverlay(e){return this.getOverlays().remove(e)}renderFrame_(e){const t=this.getSize(),i=this.getView(),r=this.frameState_;let s=null;if(t!==void 0&&mA(t)&&i&&i.isDef()){const o=i.getHints(this.frameState_?this.frameState_.viewHints:void 0),a=i.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:eE(a.center,a.resolution,a.rotation,t),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:t,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:a,viewHints:o,wantedTiles:{},mapId:ut(this),renderTargets:{}},a.nextCenter&&a.nextResolution){const u=isNaN(a.nextRotation)?a.rotation:a.nextRotation;s.nextExtent=eE(a.nextCenter,a.nextResolution,u,t)}}this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),r&&(!this.previousExtent_||!E0(this.previousExtent_)&&!Lf(s.extent,this.previousExtent_))&&(this.dispatchEvent(new Rc(ha.MOVESTART,this,r)),this.previousExtent_=p0(this.previousExtent_)),this.previousExtent_&&!s.viewHints[Xn.ANIMATING]&&!s.viewHints[Xn.INTERACTING]&&!Lf(s.extent,this.previousExtent_)&&(this.dispatchEvent(new Rc(ha.MOVEEND,this,s)),WM(s.extent,this.previousExtent_))),this.dispatchEvent(new Rc(ha.POSTRENDER,this,s)),this.renderComplete_=(this.hasListener(ha.LOADSTART)||this.hasListener(ha.LOADEND)||this.hasListener(Er.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(e){const t=this.getLayerGroup();t&&this.handleLayerRemove_(new fa("removelayer",t)),this.set(Hn.LAYERGROUP,e)}setSize(e){this.set(Hn.SIZE,e)}setTarget(e){this.set(Hn.TARGET,e)}setView(e){if(!e||e instanceof Ss){this.set(Hn.VIEW,e);return}this.set(Hn.VIEW,new Ss);const t=this;e.then(function(i){t.setView(new Ss(i))})}updateSize(){const e=this.getTargetElement();let t;if(e){let r,s;if(Ea(e))r=e.width,s=e.height;else{const o=getComputedStyle(e);r=e.offsetWidth-parseFloat(o.borderLeftWidth)-parseFloat(o.paddingLeft)-parseFloat(o.paddingRight)-parseFloat(o.borderRightWidth),s=e.offsetHeight-parseFloat(o.borderTopWidth)-parseFloat(o.paddingTop)-parseFloat(o.paddingBottom)-parseFloat(o.borderBottomWidth)}!isNaN(r)&&!isNaN(s)&&(t=[Math.max(0,r),Math.max(0,s)],!mA(t)&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&nb("No map visible because the map container's width or height are 0."))}const i=this.getSize();t&&(!i||!Wa(t,i))&&(this.setSize(t),this.updateViewportSize_(t))}updateViewportSize_(e){const t=this.getView();t&&t.setViewportSize(e)}};function UF(n){let e=null;n.keyboardEventTarget!==void 0&&(e=typeof n.keyboardEventTarget=="string"?document.getElementById(n.keyboardEventTarget):n.keyboardEventTarget);const t={},i=n.layers&&typeof n.layers.getLayers=="function"?n.layers:new k0({layers:n.layers});t[Hn.LAYERGROUP]=i,t[Hn.TARGET]=n.target,t[Hn.VIEW]=n.view instanceof Ss?n.view:new Ss;let r;n.controls!==void 0&&(Array.isArray(n.controls)?r=new vr(n.controls.slice()):(pt(typeof n.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),r=n.controls));let s;n.interactions!==void 0&&(Array.isArray(n.interactions)?s=new vr(n.interactions.slice()):(pt(typeof n.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),s=n.interactions));let o;return n.overlays!==void 0?Array.isArray(n.overlays)?o=new vr(n.overlays.slice()):(pt(typeof n.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),o=n.overlays):o=new vr,{controls:r,interactions:s,keyboardEventTarget:e,overlays:o,values:t}}const BF={},zA=n=>{let e;const t=new Set,i=(d,g)=>{const m=typeof d=="function"?d(e):d;if(!Object.is(m,e)){const v=e;e=g??(typeof m!="object"||m===null)?m:Object.assign({},e,m),t.forEach(y=>y(e,v))}},r=()=>e,u={setState:i,getState:r,getInitialState:()=>h,subscribe:d=>(t.add(d),()=>t.delete(d)),destroy:()=>{(BF?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},h=e=n(i,r,u);return u},zF=n=>n?zA(n):zA;var g1={exports:{}},m1={},p1={exports:{}},_1={};var $A;function $F(){if($A)return _1;$A=1;var n=fg();function e(g,m){return g===m&&(g!==0||1/g===1/m)||g!==g&&m!==m}var t=typeof Object.is=="function"?Object.is:e,i=n.useState,r=n.useEffect,s=n.useLayoutEffect,o=n.useDebugValue;function a(g,m){var v=m(),y=i({inst:{value:v,getSnapshot:m}}),T=y[0].inst,w=y[1];return s(function(){T.value=v,T.getSnapshot=m,u(T)&&w({inst:T})},[g,v,m]),r(function(){return u(T)&&w({inst:T}),g(function(){u(T)&&w({inst:T})})},[g]),o(v),v}function u(g){var m=g.getSnapshot;g=g.value;try{var v=m();return!t(g,v)}catch{return!0}}function h(g,m){return m()}var d=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?h:a;return _1.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:d,_1}var WA;function WF(){return WA||(WA=1,p1.exports=$F()),p1.exports}var KA;function KF(){if(KA)return m1;KA=1;var n=fg(),e=WF();function t(h,d){return h===d&&(h!==0||1/h===1/d)||h!==h&&d!==d}var i=typeof Object.is=="function"?Object.is:t,r=e.useSyncExternalStore,s=n.useRef,o=n.useEffect,a=n.useMemo,u=n.useDebugValue;return m1.useSyncExternalStoreWithSelector=function(h,d,g,m,v){var y=s(null);if(y.current===null){var T={hasValue:!1,value:null};y.current=T}else T=y.current;y=a(function(){function A(B){if(!P){if(P=!0,M=B,B=m(B),v!==void 0&&T.hasValue){var b=T.value;if(v(b,B))return k=b}return k=B}if(b=k,i(M,B))return b;var R=m(B);return v!==void 0&&v(b,R)?(M=B,b):(M=B,k=R)}var P=!1,M,k,N=g===void 0?null:g;return[function(){return A(d())},N===null?void 0:function(){return A(N())}]},[d,g,m,v]);var w=r(h,y[0],y[1]);return o(function(){T.hasValue=!0,T.value=w},[w]),u(w),w},m1}var HA;function HF(){return HA||(HA=1,g1.exports=KF()),g1.exports}var qF=HF();const XF=Dw(qF),v4={},{useDebugValue:YF}=t5,{useSyncExternalStoreWithSelector:ZF}=XF;let qA=!1;const QF=n=>n;function JF(n,e=QF,t){(v4?"production":void 0)!=="production"&&t&&!qA&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),qA=!0);const i=ZF(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return YF(i),i}const e9=n=>{(v4?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?zF(n):n,t=(i,r)=>JF(e,i,r);return Object.assign(t,e),t},wu=n=>e9;var E4=Symbol.for("immer-nothing"),XA=Symbol.for("immer-draftable"),Yi=Symbol.for("immer-state");function zr(n,...e){throw new Error(`[Immer] minified error nr: ${n}. Full error at: https://bit.ly/3cXEKWf`)}var jf=Object.getPrototypeOf;function dh(n){return!!n&&!!n[Yi]}function su(n){return n?w4(n)||Array.isArray(n)||!!n[XA]||!!n.constructor?.[XA]||Tg(n)||N0(n):!1}var t9=Object.prototype.constructor.toString(),YA=new WeakMap;function w4(n){if(!n||typeof n!="object")return!1;const e=Object.getPrototypeOf(n);if(e===null||e===Object.prototype)return!0;const t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(t===Object)return!0;if(typeof t!="function")return!1;let i=YA.get(t);return i===void 0&&(i=Function.toString.call(t),YA.set(t,i)),i===t9}function x_(n,e,t=!0){D0(n)===0?(t?Reflect.ownKeys(n):Object.keys(n)).forEach(r=>{e(r,n[r],n)}):n.forEach((i,r)=>e(r,i,n))}function D0(n){const e=n[Yi];return e?e.type_:Array.isArray(n)?1:Tg(n)?2:N0(n)?3:0}function xE(n,e){return D0(n)===2?n.has(e):Object.prototype.hasOwnProperty.call(n,e)}function x4(n,e,t){const i=D0(n);i===2?n.set(e,t):i===3?n.add(t):n[e]=t}function n9(n,e){return n===e?n!==0||1/n===1/e:n!==n&&e!==e}function Tg(n){return n instanceof Map}function N0(n){return n instanceof Set}function Pl(n){return n.copy_||n.base_}function SE(n,e){if(Tg(n))return new Map(n);if(N0(n))return new Set(n);if(Array.isArray(n))return Array.prototype.slice.call(n);const t=w4(n);if(e===!0||e==="class_only"&&!t){const i=Object.getOwnPropertyDescriptors(n);delete i[Yi];let r=Reflect.ownKeys(i);for(let s=0;s<r.length;s++){const o=r[s],a=i[o];a.writable===!1&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(i[o]={configurable:!0,writable:!0,enumerable:a.enumerable,value:n[o]})}return Object.create(jf(n),i)}else{const i=jf(n);if(i!==null&&t)return{...n};const r=Object.create(i);return Object.assign(r,n)}}function wx(n,e=!1){return O0(n)||dh(n)||!su(n)||(D0(n)>1&&Object.defineProperties(n,{set:pp,add:pp,clear:pp,delete:pp}),Object.freeze(n),e&&Object.values(n).forEach(t=>wx(t,!0))),n}function i9(){zr(2)}var pp={value:i9};function O0(n){return n===null||typeof n!="object"?!0:Object.isFrozen(n)}var r9={};function ou(n){const e=r9[n];return e||zr(0,n),e}var Uf;function S4(){return Uf}function s9(n,e){return{drafts_:[],parent_:n,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function ZA(n,e){e&&(ou("Patches"),n.patches_=[],n.inversePatches_=[],n.patchListener_=e)}function TE(n){IE(n),n.drafts_.forEach(o9),n.drafts_=null}function IE(n){n===Uf&&(Uf=n.parent_)}function QA(n){return Uf=s9(Uf,n)}function o9(n){const e=n[Yi];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function JA(n,e){e.unfinalizedDrafts_=e.drafts_.length;const t=e.drafts_[0];return n!==void 0&&n!==t?(t[Yi].modified_&&(TE(e),zr(4)),su(n)&&(n=S_(e,n),e.parent_||T_(e,n)),e.patches_&&ou("Patches").generateReplacementPatches_(t[Yi].base_,n,e.patches_,e.inversePatches_)):n=S_(e,t,[]),TE(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),n!==E4?n:void 0}function S_(n,e,t){if(O0(e))return e;const i=n.immer_.shouldUseStrictIteration(),r=e[Yi];if(!r)return x_(e,(s,o)=>eR(n,r,e,s,o,t),i),e;if(r.scope_!==n)return e;if(!r.modified_)return T_(n,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const s=r.copy_;let o=s,a=!1;r.type_===3&&(o=new Set(s),s.clear(),a=!0),x_(o,(u,h)=>eR(n,r,s,u,h,t,a),i),T_(n,s,!1),t&&n.patches_&&ou("Patches").generatePatches_(r,t,n.patches_,n.inversePatches_)}return r.copy_}function eR(n,e,t,i,r,s,o){if(r==null||typeof r!="object"&&!o)return;const a=O0(r);if(!(a&&!o)){if(dh(r)){const u=s&&e&&e.type_!==3&&!xE(e.assigned_,i)?s.concat(i):void 0,h=S_(n,r,u);if(x4(t,i,h),dh(h))n.canAutoFreeze_=!1;else return}else o&&t.add(r);if(su(r)&&!a){if(!n.immer_.autoFreeze_&&n.unfinalizedDrafts_<1||e&&e.base_&&e.base_[i]===r&&a)return;S_(n,r),(!e||!e.scope_.parent_)&&typeof i!="symbol"&&(Tg(t)?t.has(i):Object.prototype.propertyIsEnumerable.call(t,i))&&T_(n,r)}}}function T_(n,e,t=!1){!n.parent_&&n.immer_.autoFreeze_&&n.canAutoFreeze_&&wx(e,t)}function a9(n,e){const t=Array.isArray(n),i={type_:t?1:0,scope_:e?e.scope_:S4(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:n,draft_:null,copy_:null,revoke_:null,isManual_:!1};let r=i,s=xx;t&&(r=[i],s=Bf);const{revoke:o,proxy:a}=Proxy.revocable(r,s);return i.draft_=a,i.revoke_=o,a}var xx={get(n,e){if(e===Yi)return n;const t=Pl(n);if(!xE(t,e))return l9(n,t,e);const i=t[e];return n.finalized_||!su(i)?i:i===y1(n.base_,e)?(v1(n),n.copy_[e]=RE(i,n)):i},has(n,e){return e in Pl(n)},ownKeys(n){return Reflect.ownKeys(Pl(n))},set(n,e,t){const i=T4(Pl(n),e);if(i?.set)return i.set.call(n.draft_,t),!0;if(!n.modified_){const r=y1(Pl(n),e),s=r?.[Yi];if(s&&s.base_===t)return n.copy_[e]=t,n.assigned_[e]=!1,!0;if(n9(t,r)&&(t!==void 0||xE(n.base_,e)))return!0;v1(n),AE(n)}return n.copy_[e]===t&&(t!==void 0||e in n.copy_)||Number.isNaN(t)&&Number.isNaN(n.copy_[e])||(n.copy_[e]=t,n.assigned_[e]=!0),!0},deleteProperty(n,e){return y1(n.base_,e)!==void 0||e in n.base_?(n.assigned_[e]=!1,v1(n),AE(n)):delete n.assigned_[e],n.copy_&&delete n.copy_[e],!0},getOwnPropertyDescriptor(n,e){const t=Pl(n),i=Reflect.getOwnPropertyDescriptor(t,e);return i&&{writable:!0,configurable:n.type_!==1||e!=="length",enumerable:i.enumerable,value:t[e]}},defineProperty(){zr(11)},getPrototypeOf(n){return jf(n.base_)},setPrototypeOf(){zr(12)}},Bf={};x_(xx,(n,e)=>{Bf[n]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Bf.deleteProperty=function(n,e){return Bf.set.call(this,n,e,void 0)};Bf.set=function(n,e,t){return xx.set.call(this,n[0],e,t,n[0])};function y1(n,e){const t=n[Yi];return(t?Pl(t):n)[e]}function l9(n,e,t){const i=T4(e,t);return i?"value"in i?i.value:i.get?.call(n.draft_):void 0}function T4(n,e){if(!(e in n))return;let t=jf(n);for(;t;){const i=Object.getOwnPropertyDescriptor(t,e);if(i)return i;t=jf(t)}}function AE(n){n.modified_||(n.modified_=!0,n.parent_&&AE(n.parent_))}function v1(n){n.copy_||(n.copy_=SE(n.base_,n.scope_.immer_.useStrictShallowCopy_))}var u9=class{constructor(n){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,t,i)=>{if(typeof e=="function"&&typeof t!="function"){const s=t;t=e;const o=this;return function(u=s,...h){return o.produce(u,d=>t.call(this,d,...h))}}typeof t!="function"&&zr(6),i!==void 0&&typeof i!="function"&&zr(7);let r;if(su(e)){const s=QA(this),o=RE(e,void 0);let a=!0;try{r=t(o),a=!1}finally{a?TE(s):IE(s)}return ZA(s,i),JA(r,s)}else if(!e||typeof e!="object"){if(r=t(e),r===void 0&&(r=e),r===E4&&(r=void 0),this.autoFreeze_&&wx(r,!0),i){const s=[],o=[];ou("Patches").generateReplacementPatches_(e,r,s,o),i(s,o)}return r}else zr(1,e)},this.produceWithPatches=(e,t)=>{if(typeof e=="function")return(o,...a)=>this.produceWithPatches(o,u=>e(u,...a));let i,r;return[this.produce(e,t,(o,a)=>{i=o,r=a}),i,r]},typeof n?.autoFreeze=="boolean"&&this.setAutoFreeze(n.autoFreeze),typeof n?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(n.useStrictShallowCopy),typeof n?.useStrictIteration=="boolean"&&this.setUseStrictIteration(n.useStrictIteration)}createDraft(n){su(n)||zr(8),dh(n)&&(n=c9(n));const e=QA(this),t=RE(n,void 0);return t[Yi].isManual_=!0,IE(e),t}finishDraft(n,e){const t=n&&n[Yi];(!t||!t.isManual_)&&zr(9);const{scope_:i}=t;return ZA(i,e),JA(void 0,i)}setAutoFreeze(n){this.autoFreeze_=n}setUseStrictShallowCopy(n){this.useStrictShallowCopy_=n}setUseStrictIteration(n){this.useStrictIteration_=n}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(n,e){let t;for(t=e.length-1;t>=0;t--){const r=e[t];if(r.path.length===0&&r.op==="replace"){n=r.value;break}}t>-1&&(e=e.slice(t+1));const i=ou("Patches").applyPatches_;return dh(n)?i(n,e):this.produce(n,r=>i(r,e))}};function RE(n,e){const t=Tg(n)?ou("MapSet").proxyMap_(n,e):N0(n)?ou("MapSet").proxySet_(n,e):a9(n,e);return(e?e.scope_:S4()).drafts_.push(t),t}function c9(n){return dh(n)||zr(10,n),I4(n)}function I4(n){if(!su(n)||O0(n))return n;const e=n[Yi];let t,i=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,t=SE(n,e.scope_.immer_.useStrictShallowCopy_),i=e.scope_.immer_.shouldUseStrictIteration()}else t=SE(n,!0);return x_(t,(r,s)=>{x4(t,r,I4(s))},i),e&&(e.finalized_=!1),t}var h9=new u9,d9=h9.produce;const f9=n=>(e,t,i)=>(i.setState=(r,s,...o)=>{const a=typeof r=="function"?d9(r):r;return e(a,s,...o)},n(i.setState,t,i)),xu=f9,Ut=wu()(xu((n,e)=>({tracking:!0,navigationMode:"free",position:null,heading:null,smoothHeading:null,accuracy:null,speed:null,headingSource:null,watchId:null,firstFix:!0,config:{smoothingFactor:.4,minRotationSpeed:5,centerOnUser:!0,animationDuration:100},startTracking:()=>{n(t=>{t.tracking=!0})},stopTracking:()=>{n(t=>{const{watchId:i}=e();i!==null&&navigator.geolocation.clearWatch(i),t.tracking=!1,t.speed=null,t.headingSource=null,t.watchId=null})},toggleMode:()=>{n(t=>{t.navigationMode=t.navigationMode==="free"?"drive":"free",console.log(` Navigation mode: ${t.navigationMode}`)})},updatePosition:t=>{n(i=>{i.position={lat:t.coords.latitude,lng:t.coords.longitude},i.accuracy=t.coords.accuracy,i.speed=t.coords.speed;const r=15,s=.5;if(!(t.coords.accuracy!==null&&t.coords.accuracy<r)){i.headingSource=null;return}if(t.coords.heading!==null&&t.coords.speed!==null&&t.coords.speed>s){i.headingSource="gps";const a=t.coords.heading;e().updateHeading(a,"gps")}else i.headingSource="compass"})},updateHeading:(t,i="compass")=>{n(r=>{const{smoothHeading:s,config:o}=e();if(s===null){r.smoothHeading=t,r.heading=t;return}let a=t-s;a>180&&(a-=360),a<-180&&(a+=360);const u=i==="compass"?3:o.minRotationSpeed;if(Math.abs(a)<u)return;const h=s+a*o.smoothingFactor;r.smoothHeading=(h+360)%360,r.heading=t})},setWatchId:t=>{n(i=>{i.watchId=t})},resetFirstFix:()=>{n(t=>{t.firstFix=!1})}}))),A4={"AHN 0.5m":{name:"AHN 0.5m",factory:async()=>{const{createAHNLayerOL:n}=await Te(async()=>{const{createAHNLayerOL:e}=await import("./pdokWMSLayers-DUeftk34.js");return{createAHNLayerOL:e}},[]);return n()},immediateLoad:!0},Geomorfologie:{name:"Geomorfologie",factory:async()=>{const{createGeomorfologieLayerOL:n}=await Te(async()=>{const{createGeomorfologieLayerOL:e}=await import("./pdokWMSLayers-DUeftk34.js");return{createGeomorfologieLayerOL:e}},[]);return n()},immediateLoad:!0},Bodemkaart:{name:"Bodemkaart",factory:async()=>{const{createBodemkaartLayerOL:n}=await Te(async()=>{const{createBodemkaartLayerOL:e}=await import("./pdokWMSLayers-DUeftk34.js");return{createBodemkaartLayerOL:e}},[]);return n()},immediateLoad:!0},IKAW:{name:"IKAW",factory:async()=>{const{createIKAWLayerOL:n}=await Te(async()=>{const{createIKAWLayerOL:e}=await import("./pdokWMSLayers-DUeftk34.js");return{createIKAWLayerOL:e}},[]);return n()},immediateLoad:!0},"FAMKE Steentijd":{name:"FAMKE Steentijd",factory:async()=>{const{createFAMKESteentijdLayerOL:n}=await Te(async()=>{const{createFAMKESteentijdLayerOL:e}=await import("./pdokWMSLayers-DUeftk34.js");return{createFAMKESteentijdLayerOL:e}},[]);return n()},immediateLoad:!0},"Archeo Landschappen":{name:"Archeo Landschappen",factory:async()=>{const{createArcheoLandschappenLayerOL:n}=await Te(async()=>{const{createArcheoLandschappenLayerOL:e}=await import("./pdokWMSLayers-DUeftk34.js");return{createArcheoLandschappenLayerOL:e}},[]);return n()},immediateLoad:!0},"Archeo Zones Vlaanderen":{name:"Archeo Zones Vlaanderen",factory:async()=>{const{createVlaanderenArcheoZonesLayerOL:n}=await Te(async()=>{const{createVlaanderenArcheoZonesLayerOL:e}=await import("./pdokWMSLayers-DUeftk34.js");return{createVlaanderenArcheoZonesLayerOL:e}},[]);return n()},immediateLoad:!0},"Beschermde Sites Vlaanderen":{name:"Beschermde Sites Vlaanderen",factory:async()=>{const{createVlaanderenBeschArchLayerOL:n}=await Te(async()=>{const{createVlaanderenBeschArchLayerOL:e}=await import("./pdokWMSLayers-DUeftk34.js");return{createVlaanderenBeschArchLayerOL:e}},[]);return n()},immediateLoad:!0},"AHN4 Hillshade NL":{name:"AHN4 Hillshade NL",factory:async()=>{const{createAHN4HillshadeLayerOL:n}=await Te(async()=>{const{createAHN4HillshadeLayerOL:e}=await import("./hillshadeLayers-BgOZtFfI.js");return{createAHN4HillshadeLayerOL:e}},[]);return n()},immediateLoad:!0},"AHN4 Multi-Hillshade NL":{name:"AHN4 Multi-Hillshade NL",factory:async()=>{const{createAHN4MultiHillshadeLayerOL:n}=await Te(async()=>{const{createAHN4MultiHillshadeLayerOL:e}=await import("./hillshadeLayers-BgOZtFfI.js");return{createAHN4MultiHillshadeLayerOL:e}},[]);return n()},immediateLoad:!0},"AHN4 Helling NL":{name:"AHN4 Helling NL",factory:async()=>{const{createAHN4SlopeLayerOL:n}=await Te(async()=>{const{createAHN4SlopeLayerOL:e}=await import("./hillshadeLayers-BgOZtFfI.js");return{createAHN4SlopeLayerOL:e}},[]);return n()},immediateLoad:!0},"World Hillshade":{name:"World Hillshade",factory:async()=>{const{createWorldHillshadeLayerOL:n}=await Te(async()=>{const{createWorldHillshadeLayerOL:e}=await import("./hillshadeLayers-BgOZtFfI.js");return{createWorldHillshadeLayerOL:e}},[]);return n()},immediateLoad:!0},"Hillshade Vlaanderen 25cm":{name:"Hillshade Vlaanderen 25cm",factory:async()=>{const{createDHMVHillshadeLayerOL:n}=await Te(async()=>{const{createDHMVHillshadeLayerOL:e}=await import("./hillshadeLayers-BgOZtFfI.js");return{createDHMVHillshadeLayerOL:e}},[]);return n()},immediateLoad:!0},"Skyview Vlaanderen 25cm":{name:"Skyview Vlaanderen 25cm",factory:async()=>{const{createDHMVSkyviewLayerOL:n}=await Te(async()=>{const{createDHMVSkyviewLayerOL:e}=await import("./hillshadeLayers-BgOZtFfI.js");return{createDHMVSkyviewLayerOL:e}},[]);return n()},immediateLoad:!0},"DTM Vlaanderen 1m":{name:"DTM Vlaanderen 1m",factory:async()=>{const{createDHMVDTMLayerOL:n}=await Te(async()=>{const{createDHMVDTMLayerOL:e}=await import("./hillshadeLayers-BgOZtFfI.js");return{createDHMVDTMLayerOL:e}},[]);return n()},immediateLoad:!0},"Hillshade NRW 25cm":{name:"Hillshade NRW 25cm",factory:async()=>{const{createNRWHillshadeLayerOL:n}=await Te(async()=>{const{createNRWHillshadeLayerOL:e}=await import("./hillshadeLayers-BgOZtFfI.js");return{createNRWHillshadeLayerOL:e}},[]);return n()},immediateLoad:!0},"Hillshade NRW Kleur":{name:"Hillshade NRW Kleur",factory:async()=>{const{createNRWHillshadeColorLayerOL:n}=await Te(async()=>{const{createNRWHillshadeColorLayerOL:e}=await import("./hillshadeLayers-BgOZtFfI.js");return{createNRWHillshadeColorLayerOL:e}},[]);return n()},immediateLoad:!0},"Hillshade Frankrijk":{name:"Hillshade Frankrijk",factory:async()=>{const{createFranceHillshadeLayerOL:n}=await Te(async()=>{const{createFranceHillshadeLayerOL:e}=await import("./hillshadeLayers-BgOZtFfI.js");return{createFranceHillshadeLayerOL:e}},[]);return n()},immediateLoad:!0},"LiDAR HD Frankrijk":{name:"LiDAR HD Frankrijk",factory:async()=>{const{createFranceLidarHDHillshadeLayerOL:n}=await Te(async()=>{const{createFranceLidarHDHillshadeLayerOL:e}=await import("./hillshadeLayers-BgOZtFfI.js");return{createFranceLidarHDHillshadeLayerOL:e}},[]);return n()},immediateLoad:!0},"RGE Alti Frankrijk 1m":{name:"RGE Alti Frankrijk 1m",factory:async()=>{const{createFranceRGEAltiLayerOL:n}=await Te(async()=>{const{createFranceRGEAltiLayerOL:e}=await import("./hillshadeLayers-BgOZtFfI.js");return{createFranceRGEAltiLayerOL:e}},[]);return n()},immediateLoad:!0},"Hoogtelijn Frankrijk":{name:"Hoogtelijn Frankrijk",factory:async()=>{const{createFranceContourLayerOL:n}=await Te(async()=>{const{createFranceContourLayerOL:e}=await import("./hillshadeLayers-BgOZtFfI.js");return{createFranceContourLayerOL:e}},[]);return n()},immediateLoad:!0},"Hillshade Walloni":{name:"Hillshade Walloni",factory:async()=>{const{createWallonieHillshadeLayerOL:n}=await Te(async()=>{const{createWallonieHillshadeLayerOL:e}=await import("./hillshadeLayers-BgOZtFfI.js");return{createWallonieHillshadeLayerOL:e}},[]);return n()},immediateLoad:!0},"CAI Vlaanderen":{name:"CAI Vlaanderen",factory:async()=>{const{createCAIVlaanderenLayerOL:n}=await Te(async()=>{const{createCAIVlaanderenLayerOL:e}=await import("./caiVlaanderenOL-FQQHFneP.js");return{createCAIVlaanderenLayerOL:e}},__vite__mapDeps([0,1]));return n()},immediateLoad:!0},"Monumenten BE":{name:"Monumenten BE",factory:async()=>{const{createBeschermdeMonumentenBELayerOL:n}=await Te(async()=>{const{createBeschermdeMonumentenBELayerOL:e}=await import("./belgieErfgoedLayers-Bl4GEtDb.js");return{createBeschermdeMonumentenBELayerOL:e}},__vite__mapDeps([2,1]));return n()},immediateLoad:!1},"Archeo Zones BE":{name:"Archeo Zones BE",factory:async()=>{const{createArcheoZonesBELayerOL:n}=await Te(async()=>{const{createArcheoZonesBELayerOL:e}=await import("./belgieErfgoedLayers-Bl4GEtDb.js");return{createArcheoZonesBELayerOL:e}},__vite__mapDeps([2,1]));return n()},immediateLoad:!1},"Arch Sites BE":{name:"Arch Sites BE",factory:async()=>{const{createBeschArchSitesBELayerOL:n}=await Te(async()=>{const{createBeschArchSitesBELayerOL:e}=await import("./belgieErfgoedLayers-Bl4GEtDb.js");return{createBeschArchSitesBELayerOL:e}},__vite__mapDeps([2,1]));return n()},immediateLoad:!1},"Erfgoed Landschap BE":{name:"Erfgoed Landschap BE",factory:async()=>{const{createErfgoedLandschappenBELayerOL:n}=await Te(async()=>{const{createErfgoedLandschappenBELayerOL:e}=await import("./belgieErfgoedLayers-Bl4GEtDb.js");return{createErfgoedLandschappenBELayerOL:e}},__vite__mapDeps([2,1]));return n()},immediateLoad:!1},"CAI Elementen":{name:"CAI Elementen",factory:async()=>{const{createCAIElementenBELayerOL:n}=await Te(async()=>{const{createCAIElementenBELayerOL:e}=await import("./belgieErfgoedLayers-Bl4GEtDb.js");return{createCAIElementenBELayerOL:e}},__vite__mapDeps([2,1]));return n()},immediateLoad:!1},"Hist. Gebouwen FR":{name:"Hist. Gebouwen FR",factory:async()=>{const{createFrankrijkMonumentenLayerOL:n}=await Te(async()=>{const{createFrankrijkMonumentenLayerOL:e}=await import("./frankrijkMonumentenOL-Bg7vx75P.js");return{createFrankrijkMonumentenLayerOL:e}},__vite__mapDeps([3,1,4]));return n()},immediateLoad:!1},"INRAP Sites FR":{name:"INRAP Sites FR",factory:async()=>{const{createInrapSitesFRLayerOL:n}=await Te(async()=>{const{createInrapSitesFRLayerOL:e}=await import("./inrapSitesFROL-D4BUPHvR.js");return{createInrapSitesFRLayerOL:e}},__vite__mapDeps([5,1,4]));return n()},immediateLoad:!1},"Archeo Sites Bretagne":{name:"Archeo Sites Bretagne",factory:async()=>{const{createArcheoBretagneLayerOL:n}=await Te(async()=>{const{createArcheoBretagneLayerOL:e}=await import("./archeoBretagneOL-CvTCNk69.js");return{createArcheoBretagneLayerOL:e}},__vite__mapDeps([6,1]));return n()},immediateLoad:!1},"Operaties Bretagne":{name:"Operaties Bretagne",factory:async()=>{const{createBretagneOperationsLayerOL:n}=await Te(async()=>{const{createBretagneOperationsLayerOL:e}=await import("./bretagneOperationsOL-D0rf4asp.js");return{createBretagneOperationsLayerOL:e}},__vite__mapDeps([7,1]));return n()},immediateLoad:!1},"Archeo Parijs":{name:"Archeo Parijs",factory:async()=>{const{createParisArcheoLayerOL:n}=await Te(async()=>{const{createParisArcheoLayerOL:e}=await import("./parisArcheoOL-BP5avWyA.js");return{createParisArcheoLayerOL:e}},__vite__mapDeps([8,1]));return n()},immediateLoad:!1},"Sites Patrimoine Occitanie":{name:"Sites Patrimoine Occitanie",factory:async()=>{const{createOccitaniePatrimoineLayerOL:n}=await Te(async()=>{const{createOccitaniePatrimoineLayerOL:e}=await import("./occitaniePatrimoineOL-Bj_1sFI-.js");return{createOccitaniePatrimoineLayerOL:e}},__vite__mapDeps([9,1]));return n()},immediateLoad:!1},"Sites Patrimoine PACA":{name:"Sites Patrimoine PACA",factory:async()=>{const{createPacaPatrimoineLayerOL:n}=await Te(async()=>{const{createPacaPatrimoineLayerOL:e}=await import("./pacaPatrimoineOL-DlZfw0K5.js");return{createPacaPatrimoineLayerOL:e}},__vite__mapDeps([10,1]));return n()},immediateLoad:!1},Maginotlinie:{name:"Maginotlinie",factory:async()=>{const{createWikimaginotLayerOL:n}=await Te(async()=>{const{createWikimaginotLayerOL:e}=await import("./wikimaginotOL-CV_kGGWV.js");return{createWikimaginotLayerOL:e}},__vite__mapDeps([11,1]));return n()},immediateLoad:!1},"Sites Patrimoine Normandie":{name:"Sites Patrimoine Normandie",factory:async()=>{const{createNormandiePatrimoineLayerOL:n}=await Te(async()=>{const{createNormandiePatrimoineLayerOL:e}=await import("./normandiePatrimoineOL-B1AT3OHt.js");return{createNormandiePatrimoineLayerOL:e}},__vite__mapDeps([12,1]));return n()},immediateLoad:!1},"AMK Monumenten":{name:"AMK Monumenten",factory:async()=>{const{createAMKLayerOL:n}=await Te(async()=>{const{createAMKLayerOL:e}=await import("./amkOL-BHRXGoVd.js");return{createAMKLayerOL:e}},__vite__mapDeps([13,14,1]));return n()},immediateLoad:!1},"Archis-punten":{name:"Archis-punten",factory:async()=>{const{createArchisPuntenLayerOL:n}=await Te(async()=>{const{createArchisPuntenLayerOL:e}=await import("./archisOL-CuZ44hyi.js");return{createArchisPuntenLayerOL:e}},__vite__mapDeps([15,14,1,4]));return n()},immediateLoad:!1},"Romeinse wegen":{name:"Romeinse wegen",factory:async()=>{const{createRomeinseWegenLayerOL:n}=await Te(async()=>{const{createRomeinseWegenLayerOL:e}=await import("./romeinsOL-DL_NPOxn.js");return{createRomeinseWegenLayerOL:e}},__vite__mapDeps([16,14,1]));return n()},immediateLoad:!1},Toestemmingen:{name:"Toestemmingen",factory:async()=>{const{createToestemmingenLayerOL:n}=await Te(async()=>{const{createToestemmingenLayerOL:e}=await import("./toestemmingenOL-3BJ7lO_n.js");return{createToestemmingenLayerOL:e}},__vite__mapDeps([17,14,1,4]));return n()},immediateLoad:!1},"Castella (punten)":{name:"Castella (punten)",factory:async()=>{const{createCastellaPuntenLayerOL:n}=await Te(async()=>{const{createCastellaPuntenLayerOL:e}=await import("./castellaPuntenOL-Cl_tS_vK.js");return{createCastellaPuntenLayerOL:e}},__vite__mapDeps([18,1,4]));return n()},immediateLoad:!1},"Castella (lijnen)":{name:"Castella (lijnen)",factory:async()=>{const{createCastellaLijnenLayerOL:n}=await Te(async()=>{const{createCastellaLijnenLayerOL:e}=await import("./castellaLijnenOL-CAhaXq9c.js");return{createCastellaLijnenLayerOL:e}},__vite__mapDeps([19,1]));return n()},immediateLoad:!1},Oppida:{name:"Oppida",factory:async()=>{const{createOppidaLayerOL:n}=await Te(async()=>{const{createOppidaLayerOL:e}=await import("./oppidaOL-CEYwJQ2W.js");return{createOppidaLayerOL:e}},__vite__mapDeps([20,1,4]));return n()},immediateLoad:!1},Kastelen:{name:"Kastelen",factory:async()=>{const{createKastelenLayerOL:n}=await Te(async()=>{const{createKastelenLayerOL:e}=await import("./kastelenOL-CV-Pke2S.js");return{createKastelenLayerOL:e}},__vite__mapDeps([21,1,4]));return n()},immediateLoad:!1},Veengebieden:{name:"Veengebieden",factory:async()=>{const{createVeengebiedenLayerOL:n}=await Te(async()=>{const{createVeengebiedenLayerOL:e}=await import("./veengebiedenOL-CUZ2lvpU.js");return{createVeengebiedenLayerOL:e}},__vite__mapDeps([22,1]));return n()},immediateLoad:!1},"Kromme Rijn Aardewerk":{name:"Kromme Rijn Aardewerk",factory:async()=>{const{createKrommeRijnAardewerkLayerOL:n}=await Te(async()=>{const{createKrommeRijnAardewerkLayerOL:e}=await import("./krommeRijnAardewerkOL-bw2pCOsj.js");return{createKrommeRijnAardewerkLayerOL:e}},__vite__mapDeps([23,14,1,4]));return n()},immediateLoad:!1},Hunebedden:{name:"Hunebedden",factory:async()=>{const{createHunebeddenLayerOL:n}=await Te(async()=>{const{createHunebeddenLayerOL:e}=await import("./hunebeddenOL-B2JpHNnt.js");return{createHunebeddenLayerOL:e}},__vite__mapDeps([24,1,4]));return n()},immediateLoad:!1},"EUROEVOL Sites":{name:"EUROEVOL Sites",factory:async()=>{const{createEuroevolLayerOL:n}=await Te(async()=>{const{createEuroevolLayerOL:e}=await import("./euroevolOL-C6gUEJUm.js");return{createEuroevolLayerOL:e}},__vite__mapDeps([25,1,4]));return n()},immediateLoad:!1},"Archeo Punten":{name:"Archeo Punten",factory:async()=>{const{createUIKAVArcheoPuntenLayerOL:n}=await Te(async()=>{const{createUIKAVArcheoPuntenLayerOL:e}=await import("./uikavArcheoPuntenOL-ESiDlRBw.js");return{createUIKAVArcheoPuntenLayerOL:e}},__vite__mapDeps([26,1,27,14,4]));return n()},immediateLoad:!1},Vlakken:{name:"Vlakken",factory:async()=>{const{createUIKAVVlakkenLayerOL:n}=await Te(async()=>{const{createUIKAVVlakkenLayerOL:e}=await import("./uikavVlakkenOL-CfC9lJyr.js");return{createUIKAVVlakkenLayerOL:e}},__vite__mapDeps([28,1,27,14]));return n()},immediateLoad:!1},Bufferlaag:{name:"Bufferlaag",factory:async()=>{const{createUIKAVBufferlaagLayerOL:n}=await Te(async()=>{const{createUIKAVBufferlaagLayerOL:e}=await import("./uikavBufferlaagOL-gTu2vPn1.js");return{createUIKAVBufferlaagLayerOL:e}},__vite__mapDeps([29,1,27,14]));return n()},immediateLoad:!1},Expert:{name:"Expert",factory:async()=>{const{createUIKAVExpertLayerOL:n}=await Te(async()=>{const{createUIKAVExpertLayerOL:e}=await import("./uikavExpertOL-TqlSQsyu.js");return{createUIKAVExpertLayerOL:e}},__vite__mapDeps([30,1,27,14]));return n()},immediateLoad:!1},Indeling:{name:"Indeling",factory:async()=>{const{createUIKAVUiterwaardenLayerOL:n}=await Te(async()=>{const{createUIKAVUiterwaardenLayerOL:e}=await import("./uikavUiterwaardenOL-C1PH1MPQ.js");return{createUIKAVUiterwaardenLayerOL:e}},__vite__mapDeps([31,1,27,14]));return n()},immediateLoad:!1},Speeltuinen:{name:"Speeltuinen",factory:async()=>{const{createSpeeltuinenLayerOL:n}=await Te(async()=>{const{createSpeeltuinenLayerOL:e}=await import("./speeltuinenOL-Bazh29sr.js");return{createSpeeltuinenLayerOL:e}},__vite__mapDeps([32,1,27,14,4]));return n()},immediateLoad:!1},Musea:{name:"Musea",factory:async()=>{const{createMuseaLayerOL:n}=await Te(async()=>{const{createMuseaLayerOL:e}=await import("./museaOL-CYAbdBv5.js");return{createMuseaLayerOL:e}},__vite__mapDeps([33,1,27,14,4]));return n()},immediateLoad:!1},Strandjes:{name:"Strandjes",factory:async()=>{const{createStrandjesLayerOL:n}=await Te(async()=>{const{createStrandjesLayerOL:e}=await import("./strandjesOL-DGgTQWt5.js");return{createStrandjesLayerOL:e}},__vite__mapDeps([34,1,27,14]));return n()},immediateLoad:!1},Parken:{name:"Parken",factory:async()=>{const{createParkenLayerOL:n}=await Te(async()=>{const{createParkenLayerOL:e}=await import("./parkenOL-BjT30Wt6.js");return{createParkenLayerOL:e}},__vite__mapDeps([35,1,27,14]));return n()},immediateLoad:!1},Kringloopwinkels:{name:"Kringloopwinkels",factory:async()=>{const{createKringloopwinkelsLayerOL:n}=await Te(async()=>{const{createKringloopwinkelsLayerOL:e}=await import("./kringloopwinkelsOL-wQQZqqLV.js");return{createKringloopwinkelsLayerOL:e}},__vite__mapDeps([36,1,14,4]));return n()},immediateLoad:!1},"Fossielen Nederland":{name:"Fossielen Nederland",factory:async()=>{const{createFossielenLayerOL:n}=await Te(async()=>{const{createFossielenLayerOL:e}=await import("./fossielenOL-JpOTWWwG.js");return{createFossielenLayerOL:e}},__vite__mapDeps([37,38,4]));return n()},immediateLoad:!1},"Fossielen Belgi":{name:"Fossielen Belgi",factory:async()=>{const{createFossielenBelgieLayerOL:n}=await Te(async()=>{const{createFossielenBelgieLayerOL:e}=await import("./fossielenBelgieOL-DNwEQAqb.js");return{createFossielenBelgieLayerOL:e}},__vite__mapDeps([39,38,4]));return n()},immediateLoad:!1},"Fossielen Duitsland":{name:"Fossielen Duitsland",factory:async()=>{const{createFossielenDuitslandLayerOL:n}=await Te(async()=>{const{createFossielenDuitslandLayerOL:e}=await import("./fossielenDuitslandOL-CVUOws08.js");return{createFossielenDuitslandLayerOL:e}},__vite__mapDeps([40,38,4]));return n()},immediateLoad:!1},"Fossielen Frankrijk":{name:"Fossielen Frankrijk",factory:async()=>{const{createFossielenFrankrijkLayerOL:n}=await Te(async()=>{const{createFossielenFrankrijkLayerOL:e}=await import("./fossielenFrankrijkOL-CR9RTMpg.js");return{createFossielenFrankrijkLayerOL:e}},__vite__mapDeps([41,38,4]));return n()},immediateLoad:!1},"Vici.org Romeins":{name:"Vici.org Romeins",factory:async()=>{const{createViciLayerOL:n}=await Te(async()=>{const{createViciLayerOL:e}=await import("./viciOL-DnbPobHB.js");return{createViciLayerOL:e}},__vite__mapDeps([42,1,4]));return n()},immediateLoad:!1}};function g9(){return Object.values(A4).filter(n=>n.immediateLoad)}const Hi=wu()(xu((n,e)=>({map:null,rotation:0,rotationEnabled:!0,setMap:t=>{n(i=>{i.map=t})},setRotation:t=>{n(i=>{if(i.rotation=t,i.map&&i.rotationEnabled){const r=t*Math.PI/180;i.map.getView().setRotation(r)}})},enableRotation:()=>{n(t=>{t.rotationEnabled=!0})},disableRotation:()=>{n(t=>{t.rotationEnabled=!1,t.rotation=0,t.map&&t.map.getView().animate({rotation:0,duration:500})})}}))),lo=wu()(xu((n,e)=>({visible:{"AMK Monumenten":!1,"Archis-punten":!1,"Romeinse wegen":!1,Toestemmingen:!1,"Monumenten (custom)":!1,"Castella (punten)":!1,"Castella (lijnen)":!1,Oppida:!1,Kastelen:!1,Veengebieden:!1,"AHN 0.5m":!1,Geomorfologie:!1,Bodemkaart:!1,IKAW:!1,"FAMKE Steentijd":!1,"Archeo Landschappen":!1,"Archeo Zones Vlaanderen":!1,"Beschermde Sites Vlaanderen":!1,"Archeo Punten":!1,Vlakken:!1,Bufferlaag:!1,Expert:!1,Indeling:!1,Speeltuinen:!1,Musea:!1,Strandjes:!1,Parken:!1,Kringloopwinkels:!1,"CartoDB Positron":!0,OpenStreetMap:!1,Satellite:!1,"TMK 1850":!1,"Bonnebladen 1900":!1,"Carte Cassini":!1,"AHN4 Hillshade NL":!1,"AHN4 Multi-Hillshade NL":!1,"AHN4 Helling NL":!1,"World Hillshade":!1,"Hillshade Vlaanderen 25cm":!1,"Skyview Vlaanderen 25cm":!1,"DTM Vlaanderen 1m":!1,"Hillshade NRW 25cm":!1,"Hillshade NRW Kleur":!1,"Hillshade Frankrijk":!1,"LiDAR HD Frankrijk":!1,"RGE Alti Frankrijk 1m":!1,"Hoogtelijn Frankrijk":!1,"Hillshade Walloni":!1,"Fossielen Nederland":!1,"Fossielen Belgi":!1,"Fossielen Duitsland":!1,"Fossielen Frankrijk":!1,"CAI Vlaanderen":!1,"CAI Elementen":!1,"Monumenten BE":!1,"Archeo Zones BE":!1,"Arch Sites BE":!1,"Erfgoed Landschap BE":!1,"Hist. Gebouwen FR":!1,"INRAP Sites FR":!1,"Archeo Sites Bretagne":!1,"Operaties Bretagne":!1,"Archeo Parijs":!1,"Sites Patrimoine Occitanie":!1,"Sites Patrimoine PACA":!1,Maginotlinie:!1,"Sites Patrimoine Normandie":!1,"Kromme Rijn Aardewerk":!1,Hunebedden:!1,"EUROEVOL Sites":!1,"Vici.org Romeins":!1},opacity:{"AHN 0.5m":.7,Geomorfologie:.5,Bodemkaart:.6,IKAW:.5,"Archeo Landschappen":.5,"AHN4 Hillshade NL":.7,"AHN4 Multi-Hillshade NL":.7,"AHN4 Helling NL":.6,"World Hillshade":.7,"Hillshade Vlaanderen 25cm":.7,"Skyview Vlaanderen 25cm":.7,"DTM Vlaanderen 1m":.6,"Hillshade NRW 25cm":.7,"Hillshade NRW Kleur":.7,"Hillshade Frankrijk":.7,"LiDAR HD Frankrijk":.7,"RGE Alti Frankrijk 1m":.6,"Hoogtelijn Frankrijk":.8,"Hillshade Walloni":.7,"Monumenten BE":.8,"Archeo Zones BE":.6,"Arch Sites BE":.7,"Erfgoed Landschap BE":.5},loadingState:{},layers:{},toggleLayer:t=>{const i=e(),r=!i.visible[t];n(s=>{s.visible[t]=r}),r&&!i.layers[t]?e().loadLayer(t):i.layers[t]&&i.layers[t].setVisible(r)},setLayerVisibility:(t,i)=>{const r=e();n(s=>{s.visible[t]=i;const o=s.layers[t];o&&o.setVisible(i)}),i&&!r.layers[t]&&e().loadLayer(t)},setLayerOpacity:(t,i)=>{n(r=>{r.opacity[t]=i;const s=r.layers[t];s&&s.setOpacity(i)})},registerLayer:(t,i)=>{n(r=>{r.layers[t]=i,r.loadingState[t]="loaded",r.visible[t]!==void 0&&i.setVisible(r.visible[t]),r.opacity[t]!==void 0&&i.setOpacity(r.opacity[t])})},unregisterLayer:t=>{n(i=>{delete i.layers[t],delete i.loadingState[t]})},loadLayer:async t=>{const i=e();if(i.loadingState[t]==="loading"||i.layers[t])return;const r=A4[t];if(!r){console.warn(` Layer "${t}" not found in registry`);return}const s=Hi.getState().map;if(!s){console.warn(` Cannot load layer "${t}": map not initialized`);return}n(o=>{o.loadingState[t]="loading"}),console.log(` Loading layer: ${t}...`);try{const o=await r.factory();if(!o)throw new Error("Factory returned null");const a=e();o.setVisible(a.visible[t]??!1),a.opacity[t]!==void 0&&o.setOpacity(a.opacity[t]),s.addLayer(o),n(u=>{u.layers[t]=o,u.loadingState[t]="loaded"}),console.log(` Layer loaded: ${t}`)}catch(o){console.error(` Failed to load layer "${t}":`,o),n(a=>{a.loadingState[t]="error"})}}}))),PE=wu()(xu((n,e)=>({layerControlOpen:!1,legendOpen:!1,collapsedCategories:new Set,toggleLayerControl:()=>{n(t=>{t.layerControlOpen=!t.layerControlOpen})},toggleLegend:()=>{n(t=>{t.legendOpen=!t.legendOpen})},toggleCategory:t=>{n(i=>{i.collapsedCategories.has(t)?i.collapsedCategories.delete(t):i.collapsedCategories.add(t)})},setLayerControlOpen:t=>{n(i=>{i.layerControlOpen=t})},setLegendOpen:t=>{n(i=>{i.legendOpen=t})}})));wu()(xu(n=>({user:null,loading:!0,error:null,setUser:e=>{n(t=>{t.user=e,t.loading=!1})},setLoading:e=>{n(t=>{t.loading=e})},setError:e=>{n(t=>{t.error=e})}})));const m9=()=>{};var tR={};const R4=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},p9=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=n[t++];e[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){const s=n[t++],o=n[t++],a=n[t++],u=((r&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[i++]=String.fromCharCode(55296+(u>>10)),e[i++]=String.fromCharCode(56320+(u&1023))}else{const s=n[t++],o=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return e.join("")},P4={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){const s=n[r],o=r+1<n.length,a=o?n[r+1]:0,u=r+2<n.length,h=u?n[r+2]:0,d=s>>2,g=(s&3)<<4|a>>4;let m=(a&15)<<2|h>>6,v=h&63;u||(v=64,o||(m=64)),i.push(t[d],t[g],t[m],t[v])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(R4(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):p9(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){const s=t[n.charAt(r++)],a=r<n.length?t[n.charAt(r)]:0;++r;const h=r<n.length?t[n.charAt(r)]:64;++r;const g=r<n.length?t[n.charAt(r)]:64;if(++r,s==null||a==null||h==null||g==null)throw new _9;const m=s<<2|a>>4;if(i.push(m),h!==64){const v=a<<4&240|h>>2;if(i.push(v),g!==64){const y=h<<6&192|g;i.push(y)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class _9 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const y9=function(n){const e=R4(n);return P4.encodeByteArray(e,!0)},I_=function(n){return y9(n).replace(/\./g,"")},C4=function(n){try{return P4.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function M4(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const v9=()=>M4().__FIREBASE_DEFAULTS__,E9=()=>{if(typeof process>"u"||typeof tR>"u")return;const n=tR.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},w9=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&C4(n[1]);return e&&JSON.parse(e)},V0=()=>{try{return m9()||v9()||E9()||w9()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},b4=n=>V0()?.emulatorHosts?.[n],L4=n=>{const e=b4(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},k4=()=>V0()?.config,D4=n=>V0()?.[`_${n}`];class x9{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function Su(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Sx(n){return(await fetch(n,{credentials:"include"})).ok}function N4(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",r=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...n};return[I_(JSON.stringify(t)),I_(JSON.stringify(o)),""].join(".")}const cf={};function S9(){const n={prod:[],emulator:[]};for(const e of Object.keys(cf))cf[e]?n.emulator.push(e):n.prod.push(e);return n}function T9(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let nR=!1;function Tx(n,e){if(typeof window>"u"||typeof document>"u"||!Su(window.location.host)||cf[n]===e||cf[n]||nR)return;cf[n]=e;function t(m){return`__firebase__banner__${m}`}const i="__firebase__banner",s=S9().prod.length>0;function o(){const m=document.getElementById(i);m&&m.remove()}function a(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function u(m,v){m.setAttribute("width","24"),m.setAttribute("id",v),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function h(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{nR=!0,o()},m}function d(m,v){m.setAttribute("id",v),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function g(){const m=T9(i),v=t("text"),y=document.getElementById(v)||document.createElement("span"),T=t("learnmore"),w=document.getElementById(T)||document.createElement("a"),A=t("preprendIcon"),P=document.getElementById(A)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const M=m.element;a(M),d(w,T);const k=h();u(P,A),M.append(P,y,w,k),document.body.appendChild(M)}s?(y.innerText="Preview backend disconnected.",P.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(P.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,y.innerText="Preview backend running in this workspace."),y.setAttribute("id",v)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",g):g()}function pn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function I9(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(pn())}function O4(){const n=V0()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function A9(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function R9(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function P9(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function C9(){const n=pn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function V4(){return!O4()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function F4(){return!O4()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function G4(){try{return typeof indexedDB=="object"}catch{return!1}}function M9(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{e(r.error?.message||"")}}catch(t){e(t)}})}const b9="FirebaseError";class Fs extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=b9,Object.setPrototypeOf(this,Fs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ig.prototype.create)}}class Ig{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},r=`${this.service}/${e}`,s=this.errors[e],o=s?L9(s,i):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new Fs(r,a,i)}}function L9(n,e){return n.replace(k9,(t,i)=>{const r=e[i];return r!=null?String(r):`<${i}?>`})}const k9=/\{\$([^}]+)}/g;function D9(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function au(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const r of t){if(!i.includes(r))return!1;const s=n[r],o=e[r];if(iR(s)&&iR(o)){if(!au(s,o))return!1}else if(s!==o)return!1}for(const r of i)if(!t.includes(r))return!1;return!0}function iR(n){return n!==null&&typeof n=="object"}function Ag(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function N9(n,e){const t=new O9(n,e);return t.subscribe.bind(t)}class O9{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let r;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");V9(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:i},r.next===void 0&&(r.next=E1),r.error===void 0&&(r.error=E1),r.complete===void 0&&(r.complete=E1);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function V9(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function E1(){}function ni(n){return n&&n._delegate?n._delegate:n}class Na{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Cl="[DEFAULT]";class F9{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new x9;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(j9(e))try{this.getOrInitializeService({instanceIdentifier:Cl})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(e=Cl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Cl){return this.instances.has(e)}getOptions(e=Cl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);i===a&&o.resolve(r)}return r}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(i)??new Set;r.add(e),this.onInitCallbacks.set(i,r);const s=this.instances.get(i);return s&&e(s,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:G9(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Cl){return this.component?this.component.multipleInstances?e:Cl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function G9(n){return n===Cl?void 0:n}function j9(n){return n.instantiationMode==="EAGER"}class U9{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new F9(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var Je;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Je||(Je={}));const B9={debug:Je.DEBUG,verbose:Je.VERBOSE,info:Je.INFO,warn:Je.WARN,error:Je.ERROR,silent:Je.SILENT},z9=Je.INFO,$9={[Je.DEBUG]:"log",[Je.VERBOSE]:"log",[Je.INFO]:"info",[Je.WARN]:"warn",[Je.ERROR]:"error"},W9=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),r=$9[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Ix{constructor(e){this.name=e,this._logLevel=z9,this._logHandler=W9,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Je))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?B9[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Je.DEBUG,...e),this._logHandler(this,Je.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Je.VERBOSE,...e),this._logHandler(this,Je.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Je.INFO,...e),this._logHandler(this,Je.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Je.WARN,...e),this._logHandler(this,Je.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Je.ERROR,...e),this._logHandler(this,Je.ERROR,...e)}}const K9=(n,e)=>e.some(t=>n instanceof t);let rR,sR;function H9(){return rR||(rR=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function q9(){return sR||(sR=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const j4=new WeakMap,CE=new WeakMap,U4=new WeakMap,w1=new WeakMap,Ax=new WeakMap;function X9(n){const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(Pa(n.result)),r()},o=()=>{i(n.error),r()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&j4.set(t,n)}).catch(()=>{}),Ax.set(e,n),e}function Y9(n){if(CE.has(n))return;const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),r()},o=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});CE.set(n,e)}let ME={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return CE.get(n);if(e==="objectStoreNames")return n.objectStoreNames||U4.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Pa(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Z9(n){ME=n(ME)}function Q9(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(x1(this),e,...t);return U4.set(i,e.sort?e.sort():[e]),Pa(i)}:q9().includes(n)?function(...e){return n.apply(x1(this),e),Pa(j4.get(this))}:function(...e){return Pa(n.apply(x1(this),e))}}function J9(n){return typeof n=="function"?Q9(n):(n instanceof IDBTransaction&&Y9(n),K9(n,H9())?new Proxy(n,ME):n)}function Pa(n){if(n instanceof IDBRequest)return X9(n);if(w1.has(n))return w1.get(n);const e=J9(n);return e!==n&&(w1.set(n,e),Ax.set(e,n)),e}const x1=n=>Ax.get(n);function e7(n,e,{blocked:t,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(n,e),a=Pa(o);return i&&o.addEventListener("upgradeneeded",u=>{i(Pa(o.result),u.oldVersion,u.newVersion,Pa(o.transaction),u)}),t&&o.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),a.then(u=>{s&&u.addEventListener("close",()=>s()),r&&u.addEventListener("versionchange",h=>r(h.oldVersion,h.newVersion,h))}).catch(()=>{}),a}const t7=["get","getKey","getAll","getAllKeys","count"],n7=["put","add","delete","clear"],S1=new Map;function oR(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(S1.get(e))return S1.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,r=n7.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||t7.includes(t)))return;const s=async function(o,...a){const u=this.transaction(o,r?"readwrite":"readonly");let h=u.store;return i&&(h=h.index(a.shift())),(await Promise.all([h[t](...a),r&&u.done]))[0]};return S1.set(e,s),s}Z9(n=>({...n,get:(e,t,i)=>oR(e,t)||n.get(e,t,i),has:(e,t)=>!!oR(e,t)||n.has(e,t)}));class i7{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(r7(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function r7(n){return n.getComponent()?.type==="VERSION"}const bE="@firebase/app",aR="0.14.6";const Eo=new Ix("@firebase/app"),s7="@firebase/app-compat",o7="@firebase/analytics-compat",a7="@firebase/analytics",l7="@firebase/app-check-compat",u7="@firebase/app-check",c7="@firebase/auth",h7="@firebase/auth-compat",d7="@firebase/database",f7="@firebase/data-connect",g7="@firebase/database-compat",m7="@firebase/functions",p7="@firebase/functions-compat",_7="@firebase/installations",y7="@firebase/installations-compat",v7="@firebase/messaging",E7="@firebase/messaging-compat",w7="@firebase/performance",x7="@firebase/performance-compat",S7="@firebase/remote-config",T7="@firebase/remote-config-compat",I7="@firebase/storage",A7="@firebase/storage-compat",R7="@firebase/firestore",P7="@firebase/ai",C7="@firebase/firestore-compat",M7="firebase",b7="12.6.0";const LE="[DEFAULT]",L7={[bE]:"fire-core",[s7]:"fire-core-compat",[a7]:"fire-analytics",[o7]:"fire-analytics-compat",[u7]:"fire-app-check",[l7]:"fire-app-check-compat",[c7]:"fire-auth",[h7]:"fire-auth-compat",[d7]:"fire-rtdb",[f7]:"fire-data-connect",[g7]:"fire-rtdb-compat",[m7]:"fire-fn",[p7]:"fire-fn-compat",[_7]:"fire-iid",[y7]:"fire-iid-compat",[v7]:"fire-fcm",[E7]:"fire-fcm-compat",[w7]:"fire-perf",[x7]:"fire-perf-compat",[S7]:"fire-rc",[T7]:"fire-rc-compat",[I7]:"fire-gcs",[A7]:"fire-gcs-compat",[R7]:"fire-fst",[C7]:"fire-fst-compat",[P7]:"fire-vertex","fire-js":"fire-js",[M7]:"fire-js-all"};const A_=new Map,k7=new Map,kE=new Map;function lR(n,e){try{n.container.addComponent(e)}catch(t){Eo.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function lu(n){const e=n.name;if(kE.has(e))return Eo.debug(`There were multiple attempts to register component ${e}.`),!1;kE.set(e,n);for(const t of A_.values())lR(t,n);for(const t of k7.values())lR(t,n);return!0}function F0(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function $r(n){return n==null?!1:n.settings!==void 0}const D7={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ca=new Ig("app","Firebase",D7);class N7{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Na("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ca.create("app-deleted",{appName:this._name})}}const Tu=b7;function B4(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:LE,automaticDataCollectionEnabled:!0,...e},r=i.name;if(typeof r!="string"||!r)throw Ca.create("bad-app-name",{appName:String(r)});if(t||(t=k4()),!t)throw Ca.create("no-options");const s=A_.get(r);if(s){if(au(t,s.options)&&au(i,s.config))return s;throw Ca.create("duplicate-app",{appName:r})}const o=new U9(r);for(const u of kE.values())o.addComponent(u);const a=new N7(t,i,o);return A_.set(r,a),a}function Rx(n=LE){const e=A_.get(n);if(!e&&n===LE&&k4())return B4();if(!e)throw Ca.create("no-app",{appName:n});return e}function Rs(n,e,t){let i=L7[n]??n;t&&(i+=`-${t}`);const r=i.match(/\s|\//),s=e.match(/\s|\//);if(r||s){const o=[`Unable to register library "${i}" with version "${e}":`];r&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Eo.warn(o.join(" "));return}lu(new Na(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const O7="firebase-heartbeat-database",V7=1,zf="firebase-heartbeat-store";let T1=null;function z4(){return T1||(T1=e7(O7,V7,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(zf)}catch(t){console.warn(t)}}}}).catch(n=>{throw Ca.create("idb-open",{originalErrorMessage:n.message})})),T1}async function F7(n){try{const t=(await z4()).transaction(zf),i=await t.objectStore(zf).get($4(n));return await t.done,i}catch(e){if(e instanceof Fs)Eo.warn(e.message);else{const t=Ca.create("idb-get",{originalErrorMessage:e?.message});Eo.warn(t.message)}}}async function uR(n,e){try{const i=(await z4()).transaction(zf,"readwrite");await i.objectStore(zf).put(e,$4(n)),await i.done}catch(t){if(t instanceof Fs)Eo.warn(t.message);else{const i=Ca.create("idb-set",{originalErrorMessage:t?.message});Eo.warn(i.message)}}}function $4(n){return`${n.name}!${n.options.appId}`}const G7=1024,j7=30;class U7{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new z7(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=cR();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(r=>r.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>j7){const r=$7(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(r,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Eo.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=cR(),{heartbeatsToSend:t,unsentEntries:i}=B7(this._heartbeatsCache.heartbeats),r=I_(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(e){return Eo.warn(e),""}}}function cR(){return new Date().toISOString().substring(0,10)}function B7(n,e=G7){const t=[];let i=n.slice();for(const r of n){const s=t.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),hR(t)>e){s.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),hR(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class z7{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return G4()?M9().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await F7(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return uR(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return uR(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function hR(n){return I_(JSON.stringify({version:2,heartbeats:n})).length}function $7(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}function W7(n){lu(new Na("platform-logger",e=>new i7(e),"PRIVATE")),lu(new Na("heartbeat",e=>new U7(e),"PRIVATE")),Rs(bE,aR,n),Rs(bE,aR,"esm2020"),Rs("fire-js","")}W7("");var dR=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Ma,W4;(function(){var n;function e(b,R){function L(){}L.prototype=R.prototype,b.F=R.prototype,b.prototype=new L,b.prototype.constructor=b,b.D=function(V,F,U){for(var D=Array(arguments.length-2),le=2;le<arguments.length;le++)D[le-2]=arguments[le];return R.prototype[F].apply(V,D)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(b,R,L){L||(L=0);const V=Array(16);if(typeof R=="string")for(var F=0;F<16;++F)V[F]=R.charCodeAt(L++)|R.charCodeAt(L++)<<8|R.charCodeAt(L++)<<16|R.charCodeAt(L++)<<24;else for(F=0;F<16;++F)V[F]=R[L++]|R[L++]<<8|R[L++]<<16|R[L++]<<24;R=b.g[0],L=b.g[1],F=b.g[2];let U=b.g[3],D;D=R+(U^L&(F^U))+V[0]+3614090360&4294967295,R=L+(D<<7&4294967295|D>>>25),D=U+(F^R&(L^F))+V[1]+3905402710&4294967295,U=R+(D<<12&4294967295|D>>>20),D=F+(L^U&(R^L))+V[2]+606105819&4294967295,F=U+(D<<17&4294967295|D>>>15),D=L+(R^F&(U^R))+V[3]+3250441966&4294967295,L=F+(D<<22&4294967295|D>>>10),D=R+(U^L&(F^U))+V[4]+4118548399&4294967295,R=L+(D<<7&4294967295|D>>>25),D=U+(F^R&(L^F))+V[5]+1200080426&4294967295,U=R+(D<<12&4294967295|D>>>20),D=F+(L^U&(R^L))+V[6]+2821735955&4294967295,F=U+(D<<17&4294967295|D>>>15),D=L+(R^F&(U^R))+V[7]+4249261313&4294967295,L=F+(D<<22&4294967295|D>>>10),D=R+(U^L&(F^U))+V[8]+1770035416&4294967295,R=L+(D<<7&4294967295|D>>>25),D=U+(F^R&(L^F))+V[9]+2336552879&4294967295,U=R+(D<<12&4294967295|D>>>20),D=F+(L^U&(R^L))+V[10]+4294925233&4294967295,F=U+(D<<17&4294967295|D>>>15),D=L+(R^F&(U^R))+V[11]+2304563134&4294967295,L=F+(D<<22&4294967295|D>>>10),D=R+(U^L&(F^U))+V[12]+1804603682&4294967295,R=L+(D<<7&4294967295|D>>>25),D=U+(F^R&(L^F))+V[13]+4254626195&4294967295,U=R+(D<<12&4294967295|D>>>20),D=F+(L^U&(R^L))+V[14]+2792965006&4294967295,F=U+(D<<17&4294967295|D>>>15),D=L+(R^F&(U^R))+V[15]+1236535329&4294967295,L=F+(D<<22&4294967295|D>>>10),D=R+(F^U&(L^F))+V[1]+4129170786&4294967295,R=L+(D<<5&4294967295|D>>>27),D=U+(L^F&(R^L))+V[6]+3225465664&4294967295,U=R+(D<<9&4294967295|D>>>23),D=F+(R^L&(U^R))+V[11]+643717713&4294967295,F=U+(D<<14&4294967295|D>>>18),D=L+(U^R&(F^U))+V[0]+3921069994&4294967295,L=F+(D<<20&4294967295|D>>>12),D=R+(F^U&(L^F))+V[5]+3593408605&4294967295,R=L+(D<<5&4294967295|D>>>27),D=U+(L^F&(R^L))+V[10]+38016083&4294967295,U=R+(D<<9&4294967295|D>>>23),D=F+(R^L&(U^R))+V[15]+3634488961&4294967295,F=U+(D<<14&4294967295|D>>>18),D=L+(U^R&(F^U))+V[4]+3889429448&4294967295,L=F+(D<<20&4294967295|D>>>12),D=R+(F^U&(L^F))+V[9]+568446438&4294967295,R=L+(D<<5&4294967295|D>>>27),D=U+(L^F&(R^L))+V[14]+3275163606&4294967295,U=R+(D<<9&4294967295|D>>>23),D=F+(R^L&(U^R))+V[3]+4107603335&4294967295,F=U+(D<<14&4294967295|D>>>18),D=L+(U^R&(F^U))+V[8]+1163531501&4294967295,L=F+(D<<20&4294967295|D>>>12),D=R+(F^U&(L^F))+V[13]+2850285829&4294967295,R=L+(D<<5&4294967295|D>>>27),D=U+(L^F&(R^L))+V[2]+4243563512&4294967295,U=R+(D<<9&4294967295|D>>>23),D=F+(R^L&(U^R))+V[7]+1735328473&4294967295,F=U+(D<<14&4294967295|D>>>18),D=L+(U^R&(F^U))+V[12]+2368359562&4294967295,L=F+(D<<20&4294967295|D>>>12),D=R+(L^F^U)+V[5]+4294588738&4294967295,R=L+(D<<4&4294967295|D>>>28),D=U+(R^L^F)+V[8]+2272392833&4294967295,U=R+(D<<11&4294967295|D>>>21),D=F+(U^R^L)+V[11]+1839030562&4294967295,F=U+(D<<16&4294967295|D>>>16),D=L+(F^U^R)+V[14]+4259657740&4294967295,L=F+(D<<23&4294967295|D>>>9),D=R+(L^F^U)+V[1]+2763975236&4294967295,R=L+(D<<4&4294967295|D>>>28),D=U+(R^L^F)+V[4]+1272893353&4294967295,U=R+(D<<11&4294967295|D>>>21),D=F+(U^R^L)+V[7]+4139469664&4294967295,F=U+(D<<16&4294967295|D>>>16),D=L+(F^U^R)+V[10]+3200236656&4294967295,L=F+(D<<23&4294967295|D>>>9),D=R+(L^F^U)+V[13]+681279174&4294967295,R=L+(D<<4&4294967295|D>>>28),D=U+(R^L^F)+V[0]+3936430074&4294967295,U=R+(D<<11&4294967295|D>>>21),D=F+(U^R^L)+V[3]+3572445317&4294967295,F=U+(D<<16&4294967295|D>>>16),D=L+(F^U^R)+V[6]+76029189&4294967295,L=F+(D<<23&4294967295|D>>>9),D=R+(L^F^U)+V[9]+3654602809&4294967295,R=L+(D<<4&4294967295|D>>>28),D=U+(R^L^F)+V[12]+3873151461&4294967295,U=R+(D<<11&4294967295|D>>>21),D=F+(U^R^L)+V[15]+530742520&4294967295,F=U+(D<<16&4294967295|D>>>16),D=L+(F^U^R)+V[2]+3299628645&4294967295,L=F+(D<<23&4294967295|D>>>9),D=R+(F^(L|~U))+V[0]+4096336452&4294967295,R=L+(D<<6&4294967295|D>>>26),D=U+(L^(R|~F))+V[7]+1126891415&4294967295,U=R+(D<<10&4294967295|D>>>22),D=F+(R^(U|~L))+V[14]+2878612391&4294967295,F=U+(D<<15&4294967295|D>>>17),D=L+(U^(F|~R))+V[5]+4237533241&4294967295,L=F+(D<<21&4294967295|D>>>11),D=R+(F^(L|~U))+V[12]+1700485571&4294967295,R=L+(D<<6&4294967295|D>>>26),D=U+(L^(R|~F))+V[3]+2399980690&4294967295,U=R+(D<<10&4294967295|D>>>22),D=F+(R^(U|~L))+V[10]+4293915773&4294967295,F=U+(D<<15&4294967295|D>>>17),D=L+(U^(F|~R))+V[1]+2240044497&4294967295,L=F+(D<<21&4294967295|D>>>11),D=R+(F^(L|~U))+V[8]+1873313359&4294967295,R=L+(D<<6&4294967295|D>>>26),D=U+(L^(R|~F))+V[15]+4264355552&4294967295,U=R+(D<<10&4294967295|D>>>22),D=F+(R^(U|~L))+V[6]+2734768916&4294967295,F=U+(D<<15&4294967295|D>>>17),D=L+(U^(F|~R))+V[13]+1309151649&4294967295,L=F+(D<<21&4294967295|D>>>11),D=R+(F^(L|~U))+V[4]+4149444226&4294967295,R=L+(D<<6&4294967295|D>>>26),D=U+(L^(R|~F))+V[11]+3174756917&4294967295,U=R+(D<<10&4294967295|D>>>22),D=F+(R^(U|~L))+V[2]+718787259&4294967295,F=U+(D<<15&4294967295|D>>>17),D=L+(U^(F|~R))+V[9]+3951481745&4294967295,b.g[0]=b.g[0]+R&4294967295,b.g[1]=b.g[1]+(F+(D<<21&4294967295|D>>>11))&4294967295,b.g[2]=b.g[2]+F&4294967295,b.g[3]=b.g[3]+U&4294967295}i.prototype.v=function(b,R){R===void 0&&(R=b.length);const L=R-this.blockSize,V=this.C;let F=this.h,U=0;for(;U<R;){if(F==0)for(;U<=L;)r(this,b,U),U+=this.blockSize;if(typeof b=="string"){for(;U<R;)if(V[F++]=b.charCodeAt(U++),F==this.blockSize){r(this,V),F=0;break}}else for(;U<R;)if(V[F++]=b[U++],F==this.blockSize){r(this,V),F=0;break}}this.h=F,this.o+=R},i.prototype.A=function(){var b=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);b[0]=128;for(var R=1;R<b.length-8;++R)b[R]=0;R=this.o*8;for(var L=b.length-8;L<b.length;++L)b[L]=R&255,R/=256;for(this.v(b),b=Array(16),R=0,L=0;L<4;++L)for(let V=0;V<32;V+=8)b[R++]=this.g[L]>>>V&255;return b};function s(b,R){var L=a;return Object.prototype.hasOwnProperty.call(L,b)?L[b]:L[b]=R(b)}function o(b,R){this.h=R;const L=[];let V=!0;for(let F=b.length-1;F>=0;F--){const U=b[F]|0;V&&U==R||(L[F]=U,V=!1)}this.g=L}var a={};function u(b){return-128<=b&&b<128?s(b,function(R){return new o([R|0],R<0?-1:0)}):new o([b|0],b<0?-1:0)}function h(b){if(isNaN(b)||!isFinite(b))return g;if(b<0)return w(h(-b));const R=[];let L=1;for(let V=0;b>=L;V++)R[V]=b/L|0,L*=4294967296;return new o(R,0)}function d(b,R){if(b.length==0)throw Error("number format error: empty string");if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if(b.charAt(0)=="-")return w(d(b.substring(1),R));if(b.indexOf("-")>=0)throw Error('number format error: interior "-" character');const L=h(Math.pow(R,8));let V=g;for(let U=0;U<b.length;U+=8){var F=Math.min(8,b.length-U);const D=parseInt(b.substring(U,U+F),R);F<8?(F=h(Math.pow(R,F)),V=V.j(F).add(h(D))):(V=V.j(L),V=V.add(h(D)))}return V}var g=u(0),m=u(1),v=u(16777216);n=o.prototype,n.m=function(){if(T(this))return-w(this).m();let b=0,R=1;for(let L=0;L<this.g.length;L++){const V=this.i(L);b+=(V>=0?V:4294967296+V)*R,R*=4294967296}return b},n.toString=function(b){if(b=b||10,b<2||36<b)throw Error("radix out of range: "+b);if(y(this))return"0";if(T(this))return"-"+w(this).toString(b);const R=h(Math.pow(b,6));var L=this;let V="";for(;;){const F=k(L,R).g;L=A(L,F.j(R));let U=((L.g.length>0?L.g[0]:L.h)>>>0).toString(b);if(L=F,y(L))return U+V;for(;U.length<6;)U="0"+U;V=U+V}},n.i=function(b){return b<0?0:b<this.g.length?this.g[b]:this.h};function y(b){if(b.h!=0)return!1;for(let R=0;R<b.g.length;R++)if(b.g[R]!=0)return!1;return!0}function T(b){return b.h==-1}n.l=function(b){return b=A(this,b),T(b)?-1:y(b)?0:1};function w(b){const R=b.g.length,L=[];for(let V=0;V<R;V++)L[V]=~b.g[V];return new o(L,~b.h).add(m)}n.abs=function(){return T(this)?w(this):this},n.add=function(b){const R=Math.max(this.g.length,b.g.length),L=[];let V=0;for(let F=0;F<=R;F++){let U=V+(this.i(F)&65535)+(b.i(F)&65535),D=(U>>>16)+(this.i(F)>>>16)+(b.i(F)>>>16);V=D>>>16,U&=65535,D&=65535,L[F]=D<<16|U}return new o(L,L[L.length-1]&-2147483648?-1:0)};function A(b,R){return b.add(w(R))}n.j=function(b){if(y(this)||y(b))return g;if(T(this))return T(b)?w(this).j(w(b)):w(w(this).j(b));if(T(b))return w(this.j(w(b)));if(this.l(v)<0&&b.l(v)<0)return h(this.m()*b.m());const R=this.g.length+b.g.length,L=[];for(var V=0;V<2*R;V++)L[V]=0;for(V=0;V<this.g.length;V++)for(let F=0;F<b.g.length;F++){const U=this.i(V)>>>16,D=this.i(V)&65535,le=b.i(F)>>>16,we=b.i(F)&65535;L[2*V+2*F]+=D*we,P(L,2*V+2*F),L[2*V+2*F+1]+=U*we,P(L,2*V+2*F+1),L[2*V+2*F+1]+=D*le,P(L,2*V+2*F+1),L[2*V+2*F+2]+=U*le,P(L,2*V+2*F+2)}for(b=0;b<R;b++)L[b]=L[2*b+1]<<16|L[2*b];for(b=R;b<2*R;b++)L[b]=0;return new o(L,0)};function P(b,R){for(;(b[R]&65535)!=b[R];)b[R+1]+=b[R]>>>16,b[R]&=65535,R++}function M(b,R){this.g=b,this.h=R}function k(b,R){if(y(R))throw Error("division by zero");if(y(b))return new M(g,g);if(T(b))return R=k(w(b),R),new M(w(R.g),w(R.h));if(T(R))return R=k(b,w(R)),new M(w(R.g),R.h);if(b.g.length>30){if(T(b)||T(R))throw Error("slowDivide_ only works with positive integers.");for(var L=m,V=R;V.l(b)<=0;)L=N(L),V=N(V);var F=B(L,1),U=B(V,1);for(V=B(V,2),L=B(L,2);!y(V);){var D=U.add(V);D.l(b)<=0&&(F=F.add(L),U=D),V=B(V,1),L=B(L,1)}return R=A(b,F.j(R)),new M(F,R)}for(F=g;b.l(R)>=0;){for(L=Math.max(1,Math.floor(b.m()/R.m())),V=Math.ceil(Math.log(L)/Math.LN2),V=V<=48?1:Math.pow(2,V-48),U=h(L),D=U.j(R);T(D)||D.l(b)>0;)L-=V,U=h(L),D=U.j(R);y(U)&&(U=m),F=F.add(U),b=A(b,D)}return new M(F,b)}n.B=function(b){return k(this,b).h},n.and=function(b){const R=Math.max(this.g.length,b.g.length),L=[];for(let V=0;V<R;V++)L[V]=this.i(V)&b.i(V);return new o(L,this.h&b.h)},n.or=function(b){const R=Math.max(this.g.length,b.g.length),L=[];for(let V=0;V<R;V++)L[V]=this.i(V)|b.i(V);return new o(L,this.h|b.h)},n.xor=function(b){const R=Math.max(this.g.length,b.g.length),L=[];for(let V=0;V<R;V++)L[V]=this.i(V)^b.i(V);return new o(L,this.h^b.h)};function N(b){const R=b.g.length+1,L=[];for(let V=0;V<R;V++)L[V]=b.i(V)<<1|b.i(V-1)>>>31;return new o(L,b.h)}function B(b,R){const L=R>>5;R%=32;const V=b.g.length-L,F=[];for(let U=0;U<V;U++)F[U]=R>0?b.i(U+L)>>>R|b.i(U+L+1)<<32-R:b.i(U+L);return new o(F,b.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,W4=i,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=d,Ma=o}).apply(typeof dR<"u"?dR:typeof self<"u"?self:typeof window<"u"?window:{});var _p=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var K4,Xd,H4,Op,DE,q4,X4,Y4;(function(){var n,e=Object.defineProperty;function t(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof _p=="object"&&_p];for(var S=0;S<p.length;++S){var I=p[S];if(I&&I.Math==Math)return I}throw Error("Cannot find global object")}var i=t(this);function r(p,S){if(S)e:{var I=i;p=p.split(".");for(var O=0;O<p.length-1;O++){var X=p[O];if(!(X in I))break e;I=I[X]}p=p[p.length-1],O=I[p],S=S(O),S!=O&&S!=null&&e(I,p,{configurable:!0,writable:!0,value:S})}}r("Symbol.dispose",function(p){return p||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(p){return p||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(p){return p||function(S){var I=[],O;for(O in S)Object.prototype.hasOwnProperty.call(S,O)&&I.push([O,S[O]]);return I}});var s=s||{},o=this||self;function a(p){var S=typeof p;return S=="object"&&p!=null||S=="function"}function u(p,S,I){return p.call.apply(p.bind,arguments)}function h(p,S,I){return h=u,h.apply(null,arguments)}function d(p,S){var I=Array.prototype.slice.call(arguments,1);return function(){var O=I.slice();return O.push.apply(O,arguments),p.apply(this,O)}}function g(p,S){function I(){}I.prototype=S.prototype,p.Z=S.prototype,p.prototype=new I,p.prototype.constructor=p,p.Ob=function(O,X,Q){for(var fe=Array(arguments.length-2),He=2;He<arguments.length;He++)fe[He-2]=arguments[He];return S.prototype[X].apply(O,fe)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?p=>p&&AsyncContext.Snapshot.wrap(p):p=>p;function v(p){const S=p.length;if(S>0){const I=Array(S);for(let O=0;O<S;O++)I[O]=p[O];return I}return[]}function y(p,S){for(let O=1;O<arguments.length;O++){const X=arguments[O];var I=typeof X;if(I=I!="object"?I:X?Array.isArray(X)?"array":I:"null",I=="array"||I=="object"&&typeof X.length=="number"){I=p.length||0;const Q=X.length||0;p.length=I+Q;for(let fe=0;fe<Q;fe++)p[I+fe]=X[fe]}else p.push(X)}}class T{constructor(S,I){this.i=S,this.j=I,this.h=0,this.g=null}get(){let S;return this.h>0?(this.h--,S=this.g,this.g=S.next,S.next=null):S=this.i(),S}}function w(p){o.setTimeout(()=>{throw p},0)}function A(){var p=b;let S=null;return p.g&&(S=p.g,p.g=p.g.next,p.g||(p.h=null),S.next=null),S}class P{constructor(){this.h=this.g=null}add(S,I){const O=M.get();O.set(S,I),this.h?this.h.next=O:this.g=O,this.h=O}}var M=new T(()=>new k,p=>p.reset());class k{constructor(){this.next=this.g=this.h=null}set(S,I){this.h=S,this.g=I,this.next=null}reset(){this.next=this.g=this.h=null}}let N,B=!1,b=new P,R=()=>{const p=Promise.resolve(void 0);N=()=>{p.then(L)}};function L(){for(var p;p=A();){try{p.h.call(p.g)}catch(I){w(I)}var S=M;S.j(p),S.h<100&&(S.h++,p.next=S.g,S.g=p)}B=!1}function V(){this.u=this.u,this.C=this.C}V.prototype.u=!1,V.prototype.dispose=function(){this.u||(this.u=!0,this.N())},V.prototype[Symbol.dispose]=function(){this.dispose()},V.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function F(p,S){this.type=p,this.g=this.target=S,this.defaultPrevented=!1}F.prototype.h=function(){this.defaultPrevented=!0};var U=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var p=!1,S=Object.defineProperty({},"passive",{get:function(){p=!0}});try{const I=()=>{};o.addEventListener("test",I,S),o.removeEventListener("test",I,S)}catch{}return p})();function D(p){return/^[\s\xa0]*$/.test(p)}function le(p,S){F.call(this,p?p.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,p&&this.init(p,S)}g(le,F),le.prototype.init=function(p,S){const I=this.type=p.type,O=p.changedTouches&&p.changedTouches.length?p.changedTouches[0]:null;this.target=p.target||p.srcElement,this.g=S,S=p.relatedTarget,S||(I=="mouseover"?S=p.fromElement:I=="mouseout"&&(S=p.toElement)),this.relatedTarget=S,O?(this.clientX=O.clientX!==void 0?O.clientX:O.pageX,this.clientY=O.clientY!==void 0?O.clientY:O.pageY,this.screenX=O.screenX||0,this.screenY=O.screenY||0):(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0),this.button=p.button,this.key=p.key||"",this.ctrlKey=p.ctrlKey,this.altKey=p.altKey,this.shiftKey=p.shiftKey,this.metaKey=p.metaKey,this.pointerId=p.pointerId||0,this.pointerType=p.pointerType,this.state=p.state,this.i=p,p.defaultPrevented&&le.Z.h.call(this)},le.prototype.h=function(){le.Z.h.call(this);const p=this.i;p.preventDefault?p.preventDefault():p.returnValue=!1};var we="closure_listenable_"+(Math.random()*1e6|0),ye=0;function de(p,S,I,O,X){this.listener=p,this.proxy=null,this.src=S,this.type=I,this.capture=!!O,this.ha=X,this.key=++ye,this.da=this.fa=!1}function J(p){p.da=!0,p.listener=null,p.proxy=null,p.src=null,p.ha=null}function ae(p,S,I){for(const O in p)S.call(I,p[O],O,p)}function ie(p,S){for(const I in p)S.call(void 0,p[I],I,p)}function $(p){const S={};for(const I in p)S[I]=p[I];return S}const K="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Pe(p,S){let I,O;for(let X=1;X<arguments.length;X++){O=arguments[X];for(I in O)p[I]=O[I];for(let Q=0;Q<K.length;Q++)I=K[Q],Object.prototype.hasOwnProperty.call(O,I)&&(p[I]=O[I])}}function Ce(p){this.src=p,this.g={},this.h=0}Ce.prototype.add=function(p,S,I,O,X){const Q=p.toString();p=this.g[Q],p||(p=this.g[Q]=[],this.h++);const fe=Ve(p,S,O,X);return fe>-1?(S=p[fe],I||(S.fa=!1)):(S=new de(S,this.src,Q,!!O,X),S.fa=I,p.push(S)),S};function Me(p,S){const I=S.type;if(I in p.g){var O=p.g[I],X=Array.prototype.indexOf.call(O,S,void 0),Q;(Q=X>=0)&&Array.prototype.splice.call(O,X,1),Q&&(J(S),p.g[I].length==0&&(delete p.g[I],p.h--))}}function Ve(p,S,I,O){for(let X=0;X<p.length;++X){const Q=p[X];if(!Q.da&&Q.listener==S&&Q.capture==!!I&&Q.ha==O)return X}return-1}var Ge="closure_lm_"+(Math.random()*1e6|0),Ke={};function Ye(p,S,I,O,X){if(Array.isArray(S)){for(let Q=0;Q<S.length;Q++)Ye(p,S[Q],I,O,X);return null}return I=er(I),p&&p[we]?p.J(S,I,a(O)?!!O.capture:!1,X):yt(p,S,I,!1,O,X)}function yt(p,S,I,O,X,Q){if(!S)throw Error("Invalid event type");const fe=a(X)?!!X.capture:!!X;let He=Pn(p);if(He||(p[Ge]=He=new Ce(p)),I=He.add(S,I,O,fe,Q),I.proxy)return I;if(O=Ar(),I.proxy=O,O.src=p,O.listener=I,p.addEventListener)U||(X=fe),X===void 0&&(X=!1),p.addEventListener(S.toString(),O,X);else if(p.attachEvent)p.attachEvent(gi(S.toString()),O);else if(p.addListener&&p.removeListener)p.addListener(O);else throw Error("addEventListener and attachEvent are unavailable.");return I}function Ar(){function p(I){return S.call(p.src,p.listener,I)}const S=Rn;return p}function js(p,S,I,O,X){if(Array.isArray(S))for(var Q=0;Q<S.length;Q++)js(p,S[Q],I,O,X);else O=a(O)?!!O.capture:!!O,I=er(I),p&&p[we]?(p=p.i,Q=String(S).toString(),Q in p.g&&(S=p.g[Q],I=Ve(S,I,O,X),I>-1&&(J(S[I]),Array.prototype.splice.call(S,I,1),S.length==0&&(delete p.g[Q],p.h--)))):p&&(p=Pn(p))&&(S=p.g[S.toString()],p=-1,S&&(p=Ve(S,I,O,X)),(I=p>-1?S[p]:null)&&fi(I))}function fi(p){if(typeof p!="number"&&p&&!p.da){var S=p.src;if(S&&S[we])Me(S.i,p);else{var I=p.type,O=p.proxy;S.removeEventListener?S.removeEventListener(I,O,p.capture):S.detachEvent?S.detachEvent(gi(I),O):S.addListener&&S.removeListener&&S.removeListener(O),(I=Pn(S))?(Me(I,p),I.h==0&&(I.src=null,S[Ge]=null)):J(p)}}}function gi(p){return p in Ke?Ke[p]:Ke[p]="on"+p}function Rn(p,S){if(p.da)p=!0;else{S=new le(S,this);const I=p.listener,O=p.ha||p.src;p.fa&&fi(p),p=I.call(O,S)}return p}function Pn(p){return p=p[Ge],p instanceof Ce?p:null}var mi="__closure_events_fn_"+(Math.random()*1e9>>>0);function er(p){return typeof p=="function"?p:(p[mi]||(p[mi]=function(S){return p.handleEvent(S)}),p[mi])}function Rt(){V.call(this),this.i=new Ce(this),this.M=this,this.G=null}g(Rt,V),Rt.prototype[we]=!0,Rt.prototype.removeEventListener=function(p,S,I,O){js(this,p,S,I,O)};function vt(p,S){var I,O=p.G;if(O)for(I=[];O;O=O.G)I.push(O);if(p=p.M,O=S.type||S,typeof S=="string")S=new F(S,p);else if(S instanceof F)S.target=S.target||p;else{var X=S;S=new F(O,p),Pe(S,X)}X=!0;let Q,fe;if(I)for(fe=I.length-1;fe>=0;fe--)Q=S.g=I[fe],X=yn(Q,O,!0,S)&&X;if(Q=S.g=p,X=yn(Q,O,!0,S)&&X,X=yn(Q,O,!1,S)&&X,I)for(fe=0;fe<I.length;fe++)Q=S.g=I[fe],X=yn(Q,O,!1,S)&&X}Rt.prototype.N=function(){if(Rt.Z.N.call(this),this.i){var p=this.i;for(const S in p.g){const I=p.g[S];for(let O=0;O<I.length;O++)J(I[O]);delete p.g[S],p.h--}}this.G=null},Rt.prototype.J=function(p,S,I,O){return this.i.add(String(p),S,!1,I,O)},Rt.prototype.K=function(p,S,I,O){return this.i.add(String(p),S,!0,I,O)};function yn(p,S,I,O){if(S=p.i.g[String(S)],!S)return!0;S=S.concat();let X=!0;for(let Q=0;Q<S.length;++Q){const fe=S[Q];if(fe&&!fe.da&&fe.capture==I){const He=fe.listener,Qt=fe.ha||fe.src;fe.fa&&Me(p.i,fe),X=He.call(Qt,O)!==!1&&X}}return X&&!O.defaultPrevented}function tr(p,S){if(typeof p!="function")if(p&&typeof p.handleEvent=="function")p=h(p.handleEvent,p);else throw Error("Invalid listener argument");return Number(S)>2147483647?-1:o.setTimeout(p,S||0)}function Dt(p){p.g=tr(()=>{p.g=null,p.i&&(p.i=!1,Dt(p))},p.l);const S=p.h;p.h=null,p.m.apply(null,S)}class bo extends V{constructor(S,I){super(),this.m=S,this.l=I,this.h=null,this.i=!1,this.g=null}j(S){this.h=arguments,this.g?this.i=!0:Dt(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function nr(p){V.call(this),this.h=p,this.g={}}g(nr,V);var Qr=[];function Rr(p){ae(p.g,function(S,I){this.g.hasOwnProperty(I)&&fi(S)},p),p.g={}}nr.prototype.N=function(){nr.Z.N.call(this),Rr(this)},nr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Jr=o.JSON.stringify,Za=o.JSON.parse,es=class{stringify(p){return o.JSON.stringify(p,void 0)}parse(p){return o.JSON.parse(p,void 0)}};function ir(){}function Cu(){}var ts={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Us(){F.call(this,"d")}g(Us,F);function Lo(){F.call(this,"c")}g(Lo,F);var ii={},Bs=null;function ns(){return Bs=Bs||new Rt}ii.Ia="serverreachability";function is(p){F.call(this,ii.Ia,p)}g(is,F);function ri(p){const S=ns();vt(S,new is(S))}ii.STAT_EVENT="statevent";function si(p,S){F.call(this,ii.STAT_EVENT,p),this.stat=S}g(si,F);function It(p){const S=ns();vt(S,new si(S,p))}ii.Ja="timingevent";function ko(p,S){F.call(this,ii.Ja,p),this.size=S}g(ko,F);function Pr(p,S){if(typeof p!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){p()},S)}function Yt(){this.g=!0}Yt.prototype.ua=function(){this.g=!1};function rr(p,S,I,O,X,Q){p.info(function(){if(p.g)if(Q){var fe="",He=Q.split("&");for(let Et=0;Et<He.length;Et++){var Qt=He[Et].split("=");if(Qt.length>1){const sn=Qt[0];Qt=Qt[1];const Gi=sn.split("_");fe=Gi.length>=2&&Gi[1]=="type"?fe+(sn+"="+Qt+"&"):fe+(sn+"=redacted&")}}}else fe=null;else fe=Q;return"XMLHTTP REQ ("+O+") [attempt "+X+"]: "+S+`
`+I+`
`+fe})}function Cn(p,S,I,O,X,Q,fe){p.info(function(){return"XMLHTTP RESP ("+O+") [ attempt "+X+"]: "+S+`
`+I+`
`+Q+" "+fe})}function Zt(p,S,I,O){p.info(function(){return"XMLHTTP TEXT ("+S+"): "+bn(p,I)+(O?" "+O:"")})}function Mn(p,S){p.info(function(){return"TIMEOUT: "+S})}Yt.prototype.info=function(){};function bn(p,S){if(!p.g)return S;if(!S)return null;try{const Q=JSON.parse(S);if(Q){for(p=0;p<Q.length;p++)if(Array.isArray(Q[p])){var I=Q[p];if(!(I.length<2)){var O=I[1];if(Array.isArray(O)&&!(O.length<1)){var X=O[0];if(X!="noop"&&X!="stop"&&X!="close")for(let fe=1;fe<O.length;fe++)O[fe]=""}}}}return Jr(Q)}catch{return S}}var vn={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},ct={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},rn;function cn(){}g(cn,ir),cn.prototype.g=function(){return new XMLHttpRequest},rn=new cn;function sr(p){return encodeURIComponent(String(p))}function Mu(p){var S=1;p=p.split(":");const I=[];for(;S>0&&p.length;)I.push(p.shift()),S--;return p.length&&I.push(p.join(":")),I}function or(p,S,I,O){this.j=p,this.i=S,this.l=I,this.S=O||1,this.V=new nr(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Yg}function Yg(){this.i=null,this.g="",this.h=!1}var Zg={},Uh={};function Cr(p,S,I){p.M=1,p.A=$s(ar(S)),p.u=I,p.R=!0,Bh(p,null)}function Bh(p,S){p.F=Date.now(),Qa(p),p.B=ar(p.A);var I=p.B,O=p.S;Array.isArray(O)||(O=[String(O)]),Qh(I.i,"t",O),p.C=0,I=p.j.L,p.h=new Yg,p.g=am(p.j,I?S:null,!p.u),p.P>0&&(p.O=new bo(h(p.Y,p,p.g),p.P)),S=p.V,I=p.g,O=p.ba;var X="readystatechange";Array.isArray(X)||(X&&(Qr[0]=X.toString()),X=Qr);for(let Q=0;Q<X.length;Q++){const fe=Ye(I,X[Q],O||S.handleEvent,!1,S.h||S);if(!fe)break;S.g[fe.key]=fe}S=p.J?$(p.J):{},p.u?(p.v||(p.v="POST"),S["Content-Type"]="application/x-www-form-urlencoded",p.g.ea(p.B,p.v,p.u,S)):(p.v="GET",p.g.ea(p.B,p.v,null,S)),ri(),rr(p.i,p.v,p.B,p.l,p.S,p.u)}or.prototype.ba=function(p){p=p.target;const S=this.O;S&&cs(p)==3?S.j():this.Y(p)},or.prototype.Y=function(p){try{if(p==this.g)e:{const He=cs(this.g),Qt=this.g.ya(),Et=this.g.ca();if(!(He<3)&&(He!=3||this.g&&(this.h.h||this.g.la()||sm(this.g)))){this.K||He!=4||Qt==7||(Qt==8||Et<=0?ri(3):ri(2)),bu(this);var S=this.g.ca();this.X=S;var I=Qg(this);if(this.o=S==200,Cn(this.i,this.v,this.B,this.l,this.S,He,S),this.o){if(this.U&&!this.L){t:{if(this.g){var O,X=this.g;if((O=X.g?X.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!D(O)){var Q=O;break t}}Q=null}if(p=Q)Zt(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Ct(this,p);else{this.o=!1,this.m=3,It(12),zs(this),Ja(this);break e}}if(this.R){p=!0;let sn;for(;!this.K&&this.C<I.length;)if(sn=em(this,I),sn==Uh){He==4&&(this.m=4,It(14),p=!1),Zt(this.i,this.l,null,"[Incomplete Response]");break}else if(sn==Zg){this.m=4,It(15),Zt(this.i,this.l,I,"[Invalid Chunk]"),p=!1;break}else Zt(this.i,this.l,sn,null),Ct(this,sn);if(Jg(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),He!=4||I.length!=0||this.h.h||(this.m=1,It(16),p=!1),this.o=this.o&&p,!p)Zt(this.i,this.l,I,"[Invalid Chunked Response]"),zs(this),Ja(this);else if(I.length>0&&!this.W){this.W=!0;var fe=this.j;fe.g==this&&fe.aa&&!fe.P&&(fe.j.info("Great, no buffering proxy detected. Bytes received: "+I.length),ll(fe),fe.P=!0,It(11))}}else Zt(this.i,this.l,I,null),Ct(this,I);He==4&&zs(this),this.o&&!this.K&&(He==4?Uu(this.j,this):(this.o=!1,Qa(this)))}else ed(this.g),S==400&&I.indexOf("Unknown SID")>0?(this.m=3,It(12)):(this.m=0,It(13)),zs(this),Ja(this)}}}catch{}};function Qg(p){if(!Jg(p))return p.g.la();const S=sm(p.g);if(S==="")return"";let I="";const O=S.length,X=cs(p.g)==4;if(!p.h.i){if(typeof TextDecoder>"u")return zs(p),Ja(p),"";p.h.i=new o.TextDecoder}for(let Q=0;Q<O;Q++)p.h.h=!0,I+=p.h.i.decode(S[Q],{stream:!(X&&Q==O-1)});return S.length=0,p.h.g+=I,p.C=0,p.h.g}function Jg(p){return p.g?p.v=="GET"&&p.M!=2&&p.j.Aa:!1}function em(p,S){var I=p.C,O=S.indexOf(`
`,I);return O==-1?Uh:(I=Number(S.substring(I,O)),isNaN(I)?Zg:(O+=1,O+I>S.length?Uh:(S=S.slice(O,O+I),p.C=O+I,S)))}or.prototype.cancel=function(){this.K=!0,zs(this)};function Qa(p){p.T=Date.now()+p.H,zh(p,p.H)}function zh(p,S){if(p.D!=null)throw Error("WatchDog timer not null");p.D=Pr(h(p.aa,p),S)}function bu(p){p.D&&(o.clearTimeout(p.D),p.D=null)}or.prototype.aa=function(){this.D=null;const p=Date.now();p-this.T>=0?(Mn(this.i,this.B),this.M!=2&&(ri(),It(17)),zs(this),this.m=2,Ja(this)):zh(this,this.T-p)};function Ja(p){p.j.I==0||p.K||Uu(p.j,p)}function zs(p){bu(p);var S=p.O;S&&typeof S.dispose=="function"&&S.dispose(),p.O=null,Rr(p.V),p.g&&(S=p.g,p.g=null,S.abort(),S.dispose())}function Ct(p,S){try{var I=p.j;if(I.I!=0&&(I.g==p||Wh(I.h,p))){if(!p.L&&Wh(I.h,p)&&I.I==3){try{var O=I.Ba.g.parse(S)}catch{O=null}if(Array.isArray(O)&&O.length==3){var X=O;if(X[0]==0){e:if(!I.v){if(I.g)if(I.g.F+3e3<p.F)ju(I),Vi(I);else break e;fs(I),It(18)}}else I.xa=X[1],0<I.xa-I.K&&X[2]<37500&&I.F&&I.A==0&&!I.C&&(I.C=Pr(h(I.Va,I),6e3));el(I.h)<=1&&I.ta&&(I.ta=void 0)}else Fi(I,11)}else if((p.L||I.g==p)&&ju(I),!D(S))for(X=I.Ba.g.parse(S),S=0;S<X.length;S++){let Et=X[S];const sn=Et[0];if(!(sn<=I.K))if(I.K=sn,Et=Et[1],I.I==2)if(Et[0]=="c"){I.M=Et[1],I.ba=Et[2];const Gi=Et[3];Gi!=null&&(I.ka=Gi,I.j.info("VER="+I.ka));const Xs=Et[4];Xs!=null&&(I.za=Xs,I.j.info("SVER="+I.za));const gs=Et[5];gs!=null&&typeof gs=="number"&&gs>0&&(O=1.5*gs,I.O=O,I.j.info("backChannelRequestTimeoutMs_="+O)),O=I;const ms=p.g;if(ms){const $u=ms.g?ms.g.getResponseHeader("X-Client-Wire-Protocol"):null;if($u){var Q=O.h;Q.g||$u.indexOf("spdy")==-1&&$u.indexOf("quic")==-1&&$u.indexOf("h2")==-1||(Q.j=Q.l,Q.g=new Set,Q.h&&(ku(Q,Q.h),Q.h=null))}if(O.G){const id=ms.g?ms.g.getResponseHeader("X-HTTP-Session-Id"):null;id&&(O.wa=id,ht(O.J,O.G,id))}}I.I=3,I.l&&I.l.ra(),I.aa&&(I.T=Date.now()-p.F,I.j.info("Handshake RTT: "+I.T+"ms")),O=I;var fe=p;if(O.na=nd(O,O.L?O.ba:null,O.W),fe.L){tl(O.h,fe);var He=fe,Qt=O.O;Qt&&(He.H=Qt),He.D&&(bu(He),Qa(He)),O.g=fe}else Un(O);I.i.length>0&&qs(I)}else Et[0]!="stop"&&Et[0]!="close"||Fi(I,7);else I.I==3&&(Et[0]=="stop"||Et[0]=="close"?Et[0]=="stop"?Fi(I,7):Fu(I):Et[0]!="noop"&&I.l&&I.l.qa(Et),I.A=0)}}ri(4)}catch{}}var py=class{constructor(p,S){this.g=p,this.map=S}};function Lu(p){this.l=p||10,o.PerformanceNavigationTiming?(p=o.performance.getEntriesByType("navigation"),p=p.length>0&&(p[0].nextHopProtocol=="hq"||p[0].nextHopProtocol=="h2")):p=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=p?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function $h(p){return p.h?!0:p.g?p.g.size>=p.j:!1}function el(p){return p.h?1:p.g?p.g.size:0}function Wh(p,S){return p.h?p.h==S:p.g?p.g.has(S):!1}function ku(p,S){p.g?p.g.add(S):p.h=S}function tl(p,S){p.h&&p.h==S?p.h=null:p.g&&p.g.has(S)&&p.g.delete(S)}Lu.prototype.cancel=function(){if(this.i=Di(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const p of this.g.values())p.cancel();this.g.clear()}};function Di(p){if(p.h!=null)return p.i.concat(p.h.G);if(p.g!=null&&p.g.size!==0){let S=p.i;for(const I of p.g.values())S=S.concat(I.G);return S}return v(p.i)}var tm=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ni(p,S){if(p){p=p.split("&");for(let I=0;I<p.length;I++){const O=p[I].indexOf("=");let X,Q=null;O>=0?(X=p[I].substring(0,O),Q=p[I].substring(O+1)):X=p[I],S(X,Q?decodeURIComponent(Q.replace(/\+/g," ")):"")}}}function rs(p){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let S;p instanceof rs?(this.l=p.l,nl(this,p.j),this.o=p.o,this.g=p.g,ss(this,p.u),this.h=p.h,Do(this,Jh(p.i)),this.m=p.m):p&&(S=String(p).match(tm))?(this.l=!1,nl(this,S[1]||"",!0),this.o=il(S[2]||""),this.g=il(S[3]||"",!0),ss(this,S[4]),this.h=il(S[5]||"",!0),Do(this,S[6]||"",!0),this.m=il(S[7]||"")):(this.l=!1,this.i=new tt(null,this.l))}rs.prototype.toString=function(){const p=[];var S=this.j;S&&p.push(rl(S,Hh,!0),":");var I=this.g;return(I||S=="file")&&(p.push("//"),(S=this.o)&&p.push(rl(S,Hh,!0),"@"),p.push(sr(I).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),I=this.u,I!=null&&p.push(":",String(I))),(I=this.h)&&(this.g&&I.charAt(0)!="/"&&p.push("/"),p.push(rl(I,I.charAt(0)=="/"?sl:qh,!0))),(I=this.i.toString())&&p.push("?",I),(I=this.m)&&p.push("#",rl(I,Xh)),p.join("")},rs.prototype.resolve=function(p){const S=ar(this);let I=!!p.j;I?nl(S,p.j):I=!!p.o,I?S.o=p.o:I=!!p.g,I?S.g=p.g:I=p.u!=null;var O=p.h;if(I)ss(S,p.u);else if(I=!!p.h){if(O.charAt(0)!="/")if(this.g&&!this.h)O="/"+O;else{var X=S.h.lastIndexOf("/");X!=-1&&(O=S.h.slice(0,X+1)+O)}if(X=O,X==".."||X==".")O="";else if(X.indexOf("./")!=-1||X.indexOf("/.")!=-1){O=X.lastIndexOf("/",0)==0,X=X.split("/");const Q=[];for(let fe=0;fe<X.length;){const He=X[fe++];He=="."?O&&fe==X.length&&Q.push(""):He==".."?((Q.length>1||Q.length==1&&Q[0]!="")&&Q.pop(),O&&fe==X.length&&Q.push("")):(Q.push(He),O=!0)}O=Q.join("/")}else O=X}return I?S.h=O:I=p.i.toString()!=="",I?Do(S,Jh(p.i)):I=!!p.m,I&&(S.m=p.m),S};function ar(p){return new rs(p)}function nl(p,S,I){p.j=I?il(S,!0):S,p.j&&(p.j=p.j.replace(/:$/,""))}function ss(p,S){if(S){if(S=Number(S),isNaN(S)||S<0)throw Error("Bad port number "+S);p.u=S}else p.u=null}function Do(p,S,I){S instanceof tt?(p.i=S,Nu(p.i,p.l)):(I||(S=rl(S,_y)),p.i=new tt(S,p.l))}function ht(p,S,I){p.i.set(S,I)}function $s(p){return ht(p,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),p}function il(p,S){return p?S?decodeURI(p.replace(/%25/g,"%2525")):decodeURIComponent(p):""}function rl(p,S,I){return typeof p=="string"?(p=encodeURI(p).replace(S,Kh),I&&(p=p.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p):null}function Kh(p){return p=p.charCodeAt(0),"%"+(p>>4&15).toString(16)+(p&15).toString(16)}var Hh=/[#\/\?@]/g,qh=/[#\?:]/g,sl=/[#\?]/g,_y=/[#\?@]/g,Xh=/#/g;function tt(p,S){this.h=this.g=null,this.i=p||null,this.j=!!S}function os(p){p.g||(p.g=new Map,p.h=0,p.i&&Ni(p.i,function(S,I){p.add(decodeURIComponent(S.replace(/\+/g," ")),I)}))}n=tt.prototype,n.add=function(p,S){os(this),this.i=null,p=as(this,p);let I=this.g.get(p);return I||this.g.set(p,I=[]),I.push(S),this.h+=1,this};function Yh(p,S){os(p),S=as(p,S),p.g.has(S)&&(p.i=null,p.h-=p.g.get(S).length,p.g.delete(S))}function Du(p,S){return os(p),S=as(p,S),p.g.has(S)}n.forEach=function(p,S){os(this),this.g.forEach(function(I,O){I.forEach(function(X){p.call(S,X,O,this)},this)},this)};function Zh(p,S){os(p);let I=[];if(typeof S=="string")Du(p,S)&&(I=I.concat(p.g.get(as(p,S))));else for(p=Array.from(p.g.values()),S=0;S<p.length;S++)I=I.concat(p[S]);return I}n.set=function(p,S){return os(this),this.i=null,p=as(this,p),Du(this,p)&&(this.h-=this.g.get(p).length),this.g.set(p,[S]),this.h+=1,this},n.get=function(p,S){return p?(p=Zh(this,p),p.length>0?String(p[0]):S):S};function Qh(p,S,I){Yh(p,S),I.length>0&&(p.i=null,p.g.set(as(p,S),v(I)),p.h+=I.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const p=[],S=Array.from(this.g.keys());for(let O=0;O<S.length;O++){var I=S[O];const X=sr(I);I=Zh(this,I);for(let Q=0;Q<I.length;Q++){let fe=X;I[Q]!==""&&(fe+="="+sr(I[Q])),p.push(fe)}}return this.i=p.join("&")};function Jh(p){const S=new tt;return S.i=p.i,p.g&&(S.g=new Map(p.g),S.h=p.h),S}function as(p,S){return S=String(S),p.j&&(S=S.toLowerCase()),S}function Nu(p,S){S&&!p.j&&(os(p),p.i=null,p.g.forEach(function(I,O){const X=O.toLowerCase();O!=X&&(Yh(this,O),Qh(this,X,I))},p)),p.j=S}function ls(p,S){const I=new Yt;if(o.Image){const O=new Image;O.onload=d(Ln,I,"TestLoadImage: loaded",!0,S,O),O.onerror=d(Ln,I,"TestLoadImage: error",!1,S,O),O.onabort=d(Ln,I,"TestLoadImage: abort",!1,S,O),O.ontimeout=d(Ln,I,"TestLoadImage: timeout",!1,S,O),o.setTimeout(function(){O.ontimeout&&O.ontimeout()},1e4),O.src=p}else S(!1)}function us(p,S){const I=new Yt,O=new AbortController,X=setTimeout(()=>{O.abort(),Ln(I,"TestPingServer: timeout",!1,S)},1e4);fetch(p,{signal:O.signal}).then(Q=>{clearTimeout(X),Q.ok?Ln(I,"TestPingServer: ok",!0,S):Ln(I,"TestPingServer: server error",!1,S)}).catch(()=>{clearTimeout(X),Ln(I,"TestPingServer: error",!1,S)})}function Ln(p,S,I,O,X){try{X&&(X.onload=null,X.onerror=null,X.onabort=null,X.ontimeout=null),O(I)}catch{}}function ol(){this.g=new es}function Ws(p){this.i=p.Sb||null,this.h=p.ab||!1}g(Ws,ir),Ws.prototype.g=function(){return new Oi(this.i,this.h)};function Oi(p,S){Rt.call(this),this.H=p,this.o=S,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}g(Oi,Rt),n=Oi.prototype,n.open=function(p,S){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=p,this.D=S,this.readyState=1,Mr(this)},n.send=function(p){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const S={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};p&&(S.body=p),(this.H||o).fetch(new Request(this.D,S)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,No(this)),this.readyState=0},n.Pa=function(p){if(this.g&&(this.l=p,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=p.headers,this.readyState=2,Mr(this)),this.g&&(this.readyState=3,Mr(this),this.g)))if(this.responseType==="arraybuffer")p.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in p){if(this.j=p.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;nm(this)}else p.text().then(this.Oa.bind(this),this.ga.bind(this))};function nm(p){p.j.read().then(p.Ma.bind(p)).catch(p.ga.bind(p))}n.Ma=function(p){if(this.g){if(this.o&&p.value)this.response.push(p.value);else if(!this.o){var S=p.value?p.value:new Uint8Array(0);(S=this.B.decode(S,{stream:!p.done}))&&(this.response=this.responseText+=S)}p.done?No(this):Mr(this),this.readyState==3&&nm(this)}},n.Oa=function(p){this.g&&(this.response=this.responseText=p,No(this))},n.Na=function(p){this.g&&(this.response=p,No(this))},n.ga=function(){this.g&&No(this)};function No(p){p.readyState=4,p.l=null,p.j=null,p.B=null,Mr(p)}n.setRequestHeader=function(p,S){this.A.append(p,S)},n.getResponseHeader=function(p){return this.h&&this.h.get(p.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const p=[],S=this.h.entries();for(var I=S.next();!I.done;)I=I.value,p.push(I[0]+": "+I[1]),I=S.next();return p.join(`\r
`)};function Mr(p){p.onreadystatechange&&p.onreadystatechange.call(p)}Object.defineProperty(Oi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(p){this.m=p?"include":"same-origin"}});function im(p){let S="";return ae(p,function(I,O){S+=O,S+=":",S+=I,S+=`\r
`}),S}function Ou(p,S,I){e:{for(O in I){var O=!1;break e}O=!0}O||(I=im(I),typeof p=="string"?I!=null&&sr(I):ht(p,S,I))}function At(p){Rt.call(this),this.headers=new Map,this.L=p||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}g(At,Rt);var rm=/^https?$/i,yy=["POST","PUT"];n=At.prototype,n.Fa=function(p){this.H=p},n.ea=function(p,S,I,O){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+p);S=S?S.toUpperCase():"GET",this.D=p,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():rn.g(),this.g.onreadystatechange=m(h(this.Ca,this));try{this.B=!0,this.g.open(S,String(p),!0),this.B=!1}catch(Q){Oo(this,Q);return}if(p=I||"",I=new Map(this.headers),O)if(Object.getPrototypeOf(O)===Object.prototype)for(var X in O)I.set(X,O[X]);else if(typeof O.keys=="function"&&typeof O.get=="function")for(const Q of O.keys())I.set(Q,O.get(Q));else throw Error("Unknown input type for opt_headers: "+String(O));O=Array.from(I.keys()).find(Q=>Q.toLowerCase()=="content-type"),X=o.FormData&&p instanceof o.FormData,!(Array.prototype.indexOf.call(yy,S,void 0)>=0)||O||X||I.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Q,fe]of I)this.g.setRequestHeader(Q,fe);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(p),this.v=!1}catch(Q){Oo(this,Q)}};function Oo(p,S){p.h=!1,p.g&&(p.j=!0,p.g.abort(),p.j=!1),p.l=S,p.o=5,Vo(p),Hs(p)}function Vo(p){p.A||(p.A=!0,vt(p,"complete"),vt(p,"error"))}n.abort=function(p){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=p||7,vt(this,"complete"),vt(this,"abort"),Hs(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Hs(this,!0)),At.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Ks(this):this.Xa())},n.Xa=function(){Ks(this)};function Ks(p){if(p.h&&typeof s<"u"){if(p.v&&cs(p)==4)setTimeout(p.Ca.bind(p),0);else if(vt(p,"readystatechange"),cs(p)==4){p.h=!1;try{const Q=p.ca();e:switch(Q){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var S=!0;break e;default:S=!1}var I;if(!(I=S)){var O;if(O=Q===0){let fe=String(p.D).match(tm)[1]||null;!fe&&o.self&&o.self.location&&(fe=o.self.location.protocol.slice(0,-1)),O=!rm.test(fe?fe.toLowerCase():"")}I=O}if(I)vt(p,"complete"),vt(p,"success");else{p.o=6;try{var X=cs(p)>2?p.g.statusText:""}catch{X=""}p.l=X+" ["+p.ca()+"]",Vo(p)}}finally{Hs(p)}}}}function Hs(p,S){if(p.g){p.m&&(clearTimeout(p.m),p.m=null);const I=p.g;p.g=null,S||vt(p,"ready");try{I.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function cs(p){return p.g?p.g.readyState:0}n.ca=function(){try{return cs(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(p){if(this.g){var S=this.g.responseText;return p&&S.indexOf(p)==0&&(S=S.substring(p.length)),Za(S)}};function sm(p){try{if(!p.g)return null;if("response"in p.g)return p.g.response;switch(p.F){case"":case"text":return p.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in p.g)return p.g.mozResponseArrayBuffer}return null}catch{return null}}function ed(p){const S={};p=(p.g&&cs(p)>=2&&p.g.getAllResponseHeaders()||"").split(`\r
`);for(let O=0;O<p.length;O++){if(D(p[O]))continue;var I=Mu(p[O]);const X=I[0];if(I=I[1],typeof I!="string")continue;I=I.trim();const Q=S[X]||[];S[X]=Q,Q.push(I)}ie(S,function(O){return O.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function hs(p,S,I){return I&&I.internalChannelParams&&I.internalChannelParams[p]||S}function Vu(p){this.za=0,this.i=[],this.j=new Yt,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=hs("failFast",!1,p),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=hs("baseRetryDelayMs",5e3,p),this.Za=hs("retryDelaySeedMs",1e4,p),this.Ta=hs("forwardChannelMaxRetries",2,p),this.va=hs("forwardChannelRequestTimeoutMs",2e4,p),this.ma=p&&p.xmlHttpFactory||void 0,this.Ua=p&&p.Rb||void 0,this.Aa=p&&p.useFetchStreams||!1,this.O=void 0,this.L=p&&p.supportsCrossDomainXhr||!1,this.M="",this.h=new Lu(p&&p.concurrentRequestLimit),this.Ba=new ol,this.S=p&&p.fastHandshake||!1,this.R=p&&p.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=p&&p.Pb||!1,p&&p.ua&&this.j.ua(),p&&p.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&p&&p.detectBufferingProxy||!1,this.ia=void 0,p&&p.longPollingTimeout&&p.longPollingTimeout>0&&(this.ia=p.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Vu.prototype,n.ka=8,n.I=1,n.connect=function(p,S,I,O){It(0),this.W=p,this.H=S||{},I&&O!==void 0&&(this.H.OSID=I,this.H.OAID=O),this.F=this.X,this.J=nd(this,null,this.W),qs(this)};function Fu(p){if(Gu(p),p.I==3){var S=p.V++,I=ar(p.J);if(ht(I,"SID",p.M),ht(I,"RID",S),ht(I,"TYPE","terminate"),ds(p,I),S=new or(p,p.j,S),S.M=2,S.A=$s(ar(I)),I=!1,o.navigator&&o.navigator.sendBeacon)try{I=o.navigator.sendBeacon(S.A.toString(),"")}catch{}!I&&o.Image&&(new Image().src=S.A,I=!0),I||(S.g=am(S.j,null),S.g.ea(S.A)),S.F=Date.now(),Qa(S)}ul(p)}function Vi(p){p.g&&(ll(p),p.g.cancel(),p.g=null)}function Gu(p){Vi(p),p.v&&(o.clearTimeout(p.v),p.v=null),ju(p),p.h.cancel(),p.m&&(typeof p.m=="number"&&o.clearTimeout(p.m),p.m=null)}function qs(p){if(!$h(p.h)&&!p.m){p.m=!0;var S=p.Ea;N||R(),B||(N(),B=!0),b.add(S,p),p.D=0}}function om(p,S){return el(p.h)>=p.h.j-(p.m?1:0)?!1:p.m?(p.i=S.G.concat(p.i),!0):p.I==1||p.I==2||p.D>=(p.Sa?0:p.Ta)?!1:(p.m=Pr(h(p.Ea,p,S),Bu(p,p.D)),p.D++,!0)}n.Ea=function(p){if(this.m)if(this.m=null,this.I==1){if(!p){this.V=Math.floor(Math.random()*1e5),p=this.V++;const X=new or(this,this.j,p);let Q=this.o;if(this.U&&(Q?(Q=$(Q),Pe(Q,this.U)):Q=this.U),this.u!==null||this.R||(X.J=Q,Q=null),this.S)e:{for(var S=0,I=0;I<this.i.length;I++){t:{var O=this.i[I];if("__data__"in O.map&&(O=O.map.__data__,typeof O=="string")){O=O.length;break t}O=void 0}if(O===void 0)break;if(S+=O,S>4096){S=I;break e}if(S===4096||I===this.i.length-1){S=I+1;break e}}S=1e3}else S=1e3;S=td(this,X,S),I=ar(this.J),ht(I,"RID",p),ht(I,"CVER",22),this.G&&ht(I,"X-HTTP-Session-Id",this.G),ds(this,I),Q&&(this.R?S="headers="+sr(im(Q))+"&"+S:this.u&&Ou(I,this.u,Q)),ku(this.h,X),this.Ra&&ht(I,"TYPE","init"),this.S?(ht(I,"$req",S),ht(I,"SID","null"),X.U=!0,Cr(X,I,null)):Cr(X,I,S),this.I=2}}else this.I==3&&(p?al(this,p):this.i.length==0||$h(this.h)||al(this))};function al(p,S){var I;S?I=S.l:I=p.V++;const O=ar(p.J);ht(O,"SID",p.M),ht(O,"RID",I),ht(O,"AID",p.K),ds(p,O),p.u&&p.o&&Ou(O,p.u,p.o),I=new or(p,p.j,I,p.D+1),p.u===null&&(I.J=p.o),S&&(p.i=S.G.concat(p.i)),S=td(p,I,1e3),I.H=Math.round(p.va*.5)+Math.round(p.va*.5*Math.random()),ku(p.h,I),Cr(I,O,S)}function ds(p,S){p.H&&ae(p.H,function(I,O){ht(S,O,I)}),p.l&&ae({},function(I,O){ht(S,O,I)})}function td(p,S,I){I=Math.min(p.i.length,I);const O=p.l?h(p.l.Ka,p.l,p):null;e:{var X=p.i;let He=-1;for(;;){const Qt=["count="+I];He==-1?I>0?(He=X[0].g,Qt.push("ofs="+He)):He=0:Qt.push("ofs="+He);let Et=!0;for(let sn=0;sn<I;sn++){var Q=X[sn].g;const Gi=X[sn].map;if(Q-=He,Q<0)He=Math.max(0,X[sn].g-100),Et=!1;else try{Q="req"+Q+"_"||"";try{var fe=Gi instanceof Map?Gi:Object.entries(Gi);for(const[Xs,gs]of fe){let ms=gs;a(gs)&&(ms=Jr(gs)),Qt.push(Q+Xs+"="+encodeURIComponent(ms))}}catch(Xs){throw Qt.push(Q+"type="+encodeURIComponent("_badmap")),Xs}}catch{O&&O(Gi)}}if(Et){fe=Qt.join("&");break e}}fe=void 0}return p=p.i.splice(0,I),S.G=p,fe}function Un(p){if(!p.g&&!p.v){p.Y=1;var S=p.Da;N||R(),B||(N(),B=!0),b.add(S,p),p.A=0}}function fs(p){return p.g||p.v||p.A>=3?!1:(p.Y++,p.v=Pr(h(p.Da,p),Bu(p,p.A)),p.A++,!0)}n.Da=function(){if(this.v=null,Fo(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var p=4*this.T;this.j.info("BP detection timer enabled: "+p),this.B=Pr(h(this.Wa,this),p)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,It(10),Vi(this),Fo(this))};function ll(p){p.B!=null&&(o.clearTimeout(p.B),p.B=null)}function Fo(p){p.g=new or(p,p.j,"rpc",p.Y),p.u===null&&(p.g.J=p.o),p.g.P=0;var S=ar(p.na);ht(S,"RID","rpc"),ht(S,"SID",p.M),ht(S,"AID",p.K),ht(S,"CI",p.F?"0":"1"),!p.F&&p.ia&&ht(S,"TO",p.ia),ht(S,"TYPE","xmlhttp"),ds(p,S),p.u&&p.o&&Ou(S,p.u,p.o),p.O&&(p.g.H=p.O);var I=p.g;p=p.ba,I.M=1,I.A=$s(ar(S)),I.u=null,I.R=!0,Bh(I,p)}n.Va=function(){this.C!=null&&(this.C=null,Vi(this),fs(this),It(19))};function ju(p){p.C!=null&&(o.clearTimeout(p.C),p.C=null)}function Uu(p,S){var I=null;if(p.g==S){ju(p),ll(p),p.g=null;var O=2}else if(Wh(p.h,S))I=S.G,tl(p.h,S),O=1;else return;if(p.I!=0){if(S.o)if(O==1){I=S.u?S.u.length:0,S=Date.now()-S.F;var X=p.D;O=ns(),vt(O,new ko(O,I)),qs(p)}else Un(p);else if(X=S.m,X==3||X==0&&S.X>0||!(O==1&&om(p,S)||O==2&&fs(p)))switch(I&&I.length>0&&(S=p.h,S.i=S.i.concat(I)),X){case 1:Fi(p,5);break;case 4:Fi(p,10);break;case 3:Fi(p,6);break;default:Fi(p,2)}}}function Bu(p,S){let I=p.Qa+Math.floor(Math.random()*p.Za);return p.isActive()||(I*=2),I*S}function Fi(p,S){if(p.j.info("Error code "+S),S==2){var I=h(p.bb,p),O=p.Ua;const X=!O;O=new rs(O||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||nl(O,"https"),$s(O),X?ls(O.toString(),I):us(O.toString(),I)}else It(2);p.I=0,p.l&&p.l.pa(S),ul(p),Gu(p)}n.bb=function(p){p?(this.j.info("Successfully pinged google.com"),It(2)):(this.j.info("Failed to ping google.com"),It(1))};function ul(p){if(p.I=0,p.ja=[],p.l){const S=Di(p.h);(S.length!=0||p.i.length!=0)&&(y(p.ja,S),y(p.ja,p.i),p.h.i.length=0,v(p.i),p.i.length=0),p.l.oa()}}function nd(p,S,I){var O=I instanceof rs?ar(I):new rs(I);if(O.g!="")S&&(O.g=S+"."+O.g),ss(O,O.u);else{var X=o.location;O=X.protocol,S=S?S+"."+X.hostname:X.hostname,X=+X.port;const Q=new rs(null);O&&nl(Q,O),S&&(Q.g=S),X&&ss(Q,X),I&&(Q.h=I),O=Q}return I=p.G,S=p.wa,I&&S&&ht(O,I,S),ht(O,"VER",p.ka),ds(p,O),O}function am(p,S,I){if(S&&!p.L)throw Error("Can't create secondary domain capable XhrIo object.");return S=p.Aa&&!p.ma?new At(new Ws({ab:I})):new At(p.ma),S.Fa(p.L),S}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function lm(){}n=lm.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function zu(){}zu.prototype.g=function(p,S){return new kn(p,S)};function kn(p,S){Rt.call(this),this.g=new Vu(S),this.l=p,this.h=S&&S.messageUrlParams||null,p=S&&S.messageHeaders||null,S&&S.clientProtocolHeaderRequired&&(p?p["X-Client-Protocol"]="webchannel":p={"X-Client-Protocol":"webchannel"}),this.g.o=p,p=S&&S.initMessageHeaders||null,S&&S.messageContentType&&(p?p["X-WebChannel-Content-Type"]=S.messageContentType:p={"X-WebChannel-Content-Type":S.messageContentType}),S&&S.sa&&(p?p["X-WebChannel-Client-Profile"]=S.sa:p={"X-WebChannel-Client-Profile":S.sa}),this.g.U=p,(p=S&&S.Qb)&&!D(p)&&(this.g.u=p),this.A=S&&S.supportsCrossDomainXhr||!1,this.v=S&&S.sendRawJson||!1,(S=S&&S.httpSessionIdParam)&&!D(S)&&(this.g.G=S,p=this.h,p!==null&&S in p&&(p=this.h,S in p&&delete p[S])),this.j=new Go(this)}g(kn,Rt),kn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},kn.prototype.close=function(){Fu(this.g)},kn.prototype.o=function(p){var S=this.g;if(typeof p=="string"){var I={};I.__data__=p,p=I}else this.v&&(I={},I.__data__=Jr(p),p=I);S.i.push(new py(S.Ya++,p)),S.I==3&&qs(S)},kn.prototype.N=function(){this.g.l=null,delete this.j,Fu(this.g),delete this.g,kn.Z.N.call(this)};function um(p){Us.call(this),p.__headers__&&(this.headers=p.__headers__,this.statusCode=p.__status__,delete p.__headers__,delete p.__status__);var S=p.__sm__;if(S){e:{for(const I in S){p=I;break e}p=void 0}(this.i=p)&&(p=this.i,S=S!==null&&p in S?S[p]:void 0),this.data=S}else this.data=p}g(um,Us);function cm(){Lo.call(this),this.status=1}g(cm,Lo);function Go(p){this.g=p}g(Go,lm),Go.prototype.ra=function(){vt(this.g,"a")},Go.prototype.qa=function(p){vt(this.g,new um(p))},Go.prototype.pa=function(p){vt(this.g,new cm)},Go.prototype.oa=function(){vt(this.g,"b")},zu.prototype.createWebChannel=zu.prototype.g,kn.prototype.send=kn.prototype.o,kn.prototype.open=kn.prototype.m,kn.prototype.close=kn.prototype.close,Y4=function(){return new zu},X4=function(){return ns()},q4=ii,DE={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},vn.NO_ERROR=0,vn.TIMEOUT=8,vn.HTTP_ERROR=6,Op=vn,ct.COMPLETE="complete",H4=ct,Cu.EventType=ts,ts.OPEN="a",ts.CLOSE="b",ts.ERROR="c",ts.MESSAGE="d",Rt.prototype.listen=Rt.prototype.J,Xd=Cu,At.prototype.listenOnce=At.prototype.K,At.prototype.getLastError=At.prototype.Ha,At.prototype.getLastErrorCode=At.prototype.ya,At.prototype.getStatus=At.prototype.ca,At.prototype.getResponseJson=At.prototype.La,At.prototype.getResponseText=At.prototype.la,At.prototype.send=At.prototype.ea,At.prototype.setWithCredentials=At.prototype.Fa,K4=At}).apply(typeof _p<"u"?_p:typeof self<"u"?self:typeof window<"u"?window:{});const fR="@firebase/firestore",gR="4.9.3";class Fn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Fn.UNAUTHENTICATED=new Fn(null),Fn.GOOGLE_CREDENTIALS=new Fn("google-credentials-uid"),Fn.FIRST_PARTY=new Fn("first-party-uid"),Fn.MOCK_USER=new Fn("mock-user");let Lh="12.7.0";const uu=new Ix("@firebase/firestore");function Pc(){return uu.logLevel}function ce(n,...e){if(uu.logLevel<=Je.DEBUG){const t=e.map(Px);uu.debug(`Firestore (${Lh}): ${n}`,...t)}}function ui(n,...e){if(uu.logLevel<=Je.ERROR){const t=e.map(Px);uu.error(`Firestore (${Lh}): ${n}`,...t)}}function cu(n,...e){if(uu.logLevel<=Je.WARN){const t=e.map(Px);uu.warn(`Firestore (${Lh}): ${n}`,...t)}}function Px(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Ie(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,Z4(n,i,t)}function Z4(n,e,t){let i=`FIRESTORE (${Lh}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw ui(i),new Error(i)}function be(n,e,t,i){let r="Unexpected state";typeof t=="string"?r=t:i=t,n||Z4(e,r,i)}function We(n,e){return n}const ee={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class me extends Fs{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class po{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class Q4{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class K7{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Fn.UNAUTHENTICATED)))}shutdown(){}}class H7{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class q7{constructor(e){this.t=e,this.currentUser=Fn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){be(this.o===void 0,42304);let i=this.i;const r=u=>this.i!==i?(i=this.i,t(u)):Promise.resolve();let s=new po;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new po,e.enqueueRetryable((()=>r(this.currentUser)))};const o=()=>{const u=s;e.enqueueRetryable((async()=>{await u.promise,await r(this.currentUser)}))},a=u=>{ce("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((u=>a(u))),setTimeout((()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?a(u):(ce("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new po)}}),0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(ce("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(be(typeof i.accessToken=="string",31837,{l:i}),new Q4(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return be(e===null||typeof e=="string",2055,{h:e}),new Fn(e)}}class X7{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=Fn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Y7{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new X7(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Fn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class mR{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Z7{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,$r(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){be(this.o===void 0,3512);const i=s=>{s.error!=null&&ce("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,ce("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable((()=>i(s)))};const r=s=>{ce("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((s=>r(s))),setTimeout((()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?r(s):ce("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new mR(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(be(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new mR(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function Q7(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}class Cx{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const r=Q7(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<t&&(i+=e.charAt(r[s]%62))}return i}}function $e(n,e){return n<e?-1:n>e?1:0}function NE(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const r=n.charAt(i),s=e.charAt(i);if(r!==s)return I1(r)===I1(s)?$e(r,s):I1(r)?1:-1}return $e(n.length,e.length)}const J7=55296,eG=57343;function I1(n){const e=n.charCodeAt(0);return e>=J7&&e<=eG}function fh(n,e,t){return n.length===e.length&&n.every(((i,r)=>t(i,e[r])))}function J4(n){return n+"\0"}const pR="__name__";class ws{constructor(e,t,i){t===void 0?t=0:t>e.length&&Ie(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Ie(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return ws.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof ws?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let r=0;r<i;r++){const s=ws.compareSegments(e.get(r),t.get(r));if(s!==0)return s}return $e(e.length,t.length)}static compareSegments(e,t){const i=ws.isNumericId(e),r=ws.isNumericId(t);return i&&!r?-1:!i&&r?1:i&&r?ws.extractNumericId(e).compare(ws.extractNumericId(t)):NE(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ma.fromString(e.substring(4,e.length-2))}}class ft extends ws{construct(e,t,i){return new ft(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new me(ee.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((r=>r.length>0)))}return new ft(t)}static emptyPath(){return new ft([])}}const tG=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class zt extends ws{construct(e,t,i){return new zt(e,t,i)}static isValidIdentifier(e){return tG.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),zt.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===pR}static keyField(){return new zt([pR])}static fromServerFormat(e){const t=[];let i="",r=0;const s=()=>{if(i.length===0)throw new me(ee.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let o=!1;for(;r<e.length;){const a=e[r];if(a==="\\"){if(r+1===e.length)throw new me(ee.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[r+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new me(ee.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=u,r+=2}else a==="`"?(o=!o,r++):a!=="."||o?(i+=a,r++):(s(),r++)}if(s(),o)throw new me(ee.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new zt(t)}static emptyPath(){return new zt([])}}class pe{constructor(e){this.path=e}static fromPath(e){return new pe(ft.fromString(e))}static fromName(e){return new pe(ft.fromString(e).popFirst(5))}static empty(){return new pe(ft.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ft.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ft.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new pe(new ft(e.slice()))}}function eL(n,e,t){if(!t)throw new me(ee.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function nG(n,e,t,i){if(e===!0&&i===!0)throw new me(ee.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function _R(n){if(!pe.isDocumentKey(n))throw new me(ee.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function yR(n){if(pe.isDocumentKey(n))throw new me(ee.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function tL(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function G0(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Ie(12329,{type:typeof n})}function Oa(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new me(ee.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=G0(n);throw new me(ee.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function ln(n,e){const t={typeString:n};return e&&(t.value=e),t}function Rg(n,e){if(!tL(n))throw new me(ee.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const r=e[i].typeString,s="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const o=n[i];if(r&&typeof o!==r){t=`JSON field '${i}' must be a ${r}.`;break}if(s!==void 0&&o!==s.value){t=`Expected '${i}' field to equal '${s.value}'`;break}}if(t)throw new me(ee.INVALID_ARGUMENT,t);return!0}const vR=-62135596800,ER=1e6;class xt{static now(){return xt.fromMillis(Date.now())}static fromDate(e){return xt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*ER);return new xt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new me(ee.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new me(ee.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<vR)throw new me(ee.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new me(ee.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/ER}_compareTo(e){return this.seconds===e.seconds?$e(this.nanoseconds,e.nanoseconds):$e(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:xt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Rg(e,xt._jsonSchema))return new xt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-vR;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}xt._jsonSchemaVersion="firestore/timestamp/1.0",xt._jsonSchema={type:ln("string",xt._jsonSchemaVersion),seconds:ln("number"),nanoseconds:ln("number")};class Le{static fromTimestamp(e){return new Le(e)}static min(){return new Le(new xt(0,0))}static max(){return new Le(new xt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const $f=-1;class R_{constructor(e,t,i,r){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=r}}function OE(n){return n.fields.find((e=>e.kind===2))}function Ml(n){return n.fields.filter((e=>e.kind!==2))}R_.UNKNOWN_ID=-1;class Vp{constructor(e,t){this.fieldPath=e,this.kind=t}}class Wf{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Wf(0,Zi.min())}}function iG(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=Le.fromTimestamp(i===1e9?new xt(t+1,0):new xt(t,i));return new Zi(r,pe.empty(),e)}function nL(n){return new Zi(n.readTime,n.key,$f)}class Zi{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Zi(Le.min(),pe.empty(),$f)}static max(){return new Zi(Le.max(),pe.empty(),$f)}}function Mx(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=pe.comparator(n.documentKey,e.documentKey),t!==0?t:$e(n.largestBatchId,e.largestBatchId))}const iL="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class rL{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Iu(n){if(n.code!==ee.FAILED_PRECONDITION||n.message!==iL)throw n;ce("LocalStore","Unexpectedly lost primary lease")}class H{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ie(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new H(((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(i,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof H?t:H.resolve(t)}catch(t){return H.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):H.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):H.reject(t)}static resolve(e){return new H(((t,i)=>{t(e)}))}static reject(e){return new H(((t,i)=>{i(e)}))}static waitFor(e){return new H(((t,i)=>{let r=0,s=0,o=!1;e.forEach((a=>{++r,a.next((()=>{++s,o&&s===r&&t()}),(u=>i(u)))})),o=!0,s===r&&t()}))}static or(e){let t=H.resolve(!1);for(const i of e)t=t.next((r=>r?H.resolve(r):i()));return t}static forEach(e,t){const i=[];return e.forEach(((r,s)=>{i.push(t.call(this,r,s))})),this.waitFor(i)}static mapArray(e,t){return new H(((i,r)=>{const s=e.length,o=new Array(s);let a=0;for(let u=0;u<s;u++){const h=u;t(e[h]).next((d=>{o[h]=d,++a,a===s&&i(o)}),(d=>r(d)))}}))}static doWhile(e,t){return new H(((i,r)=>{const s=()=>{e()===!0?t().next((()=>{s()}),r):i()};s()}))}}const zi="SimpleDb";class j0{static open(e,t,i,r){try{return new j0(t,e.transaction(r,i))}catch(s){throw new hf(t,s)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new po,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new hf(e,t.error)):this.S.resolve()},this.transaction.onerror=i=>{const r=bx(i.target.error);this.S.reject(new hf(e,r))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(ce(zi,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new sG(t)}}class ba{static delete(e){return ce(zi,"Removing database:",e),Ol(M4().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!G4())return!1;if(ba.F())return!0;const e=pn(),t=ba.M(e),i=0<t&&t<10,r=sL(e),s=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||i||s)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(i)}constructor(e,t,i){this.name=e,this.version=t,this.N=i,this.B=null,ba.M(pn())===12.2&&ui("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(ce(zi,"Opening database:",this.name),this.db=await new Promise(((t,i)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=s=>{const o=s.target.result;t(o)},r.onblocked=()=>{i(new hf(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=s=>{const o=s.target.error;o.name==="VersionError"?i(new me(ee.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?i(new me(ee.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):i(new hf(e,o))},r.onupgradeneeded=s=>{ce(zi,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.N.k(o,r.transaction,s.oldVersion,this.version).next((()=>{ce(zi,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,i,r){const s=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const a=j0.open(this.db,e,s?"readonly":"readwrite",i),u=r(a).next((h=>(a.C(),h))).catch((h=>(a.abort(h),H.reject(h)))).toPromise();return u.catch((()=>{})),await a.D,u}catch(a){const u=a,h=u.name!=="FirebaseError"&&o<3;if(ce(zi,"Transaction failed with error:",u.message,"Retrying:",h),this.close(),!h)return Promise.reject(u)}}}close(){this.db&&this.db.close(),this.db=void 0}}function sL(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class rG{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Ol(this.U.delete())}}class hf extends me{constructor(e,t){super(ee.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Ha(n){return n.name==="IndexedDbTransactionError"}class sG{constructor(e){this.store=e}put(e,t){let i;return t!==void 0?(ce(zi,"PUT",this.store.name,e,t),i=this.store.put(t,e)):(ce(zi,"PUT",this.store.name,"<auto-key>",e),i=this.store.put(e)),Ol(i)}add(e){return ce(zi,"ADD",this.store.name,e,e),Ol(this.store.add(e))}get(e){return Ol(this.store.get(e)).next((t=>(t===void 0&&(t=null),ce(zi,"GET",this.store.name,e,t),t)))}delete(e){return ce(zi,"DELETE",this.store.name,e),Ol(this.store.delete(e))}count(){return ce(zi,"COUNT",this.store.name),Ol(this.store.count())}J(e,t){const i=this.options(e,t),r=i.index?this.store.index(i.index):this.store;if(typeof r.getAll=="function"){const s=r.getAll(i.range);return new H(((o,a)=>{s.onerror=u=>{a(u.target.error)},s.onsuccess=u=>{o(u.target.result)}}))}{const s=this.cursor(i),o=[];return this.H(s,((a,u)=>{o.push(u)})).next((()=>o))}}Y(e,t){const i=this.store.getAll(e,t===null?void 0:t);return new H(((r,s)=>{i.onerror=o=>{s(o.target.error)},i.onsuccess=o=>{r(o.target.result)}}))}Z(e,t){ce(zi,"DELETE ALL",this.store.name);const i=this.options(e,t);i.X=!1;const r=this.cursor(i);return this.H(r,((s,o,a)=>a.delete()))}ee(e,t){let i;t?i=e:(i={},t=e);const r=this.cursor(i);return this.H(r,t)}te(e){const t=this.cursor({});return new H(((i,r)=>{t.onerror=s=>{const o=bx(s.target.error);r(o)},t.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next((a=>{a?o.continue():i()})):i()}}))}H(e,t){const i=[];return new H(((r,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void r();const u=new rG(a),h=t(a.primaryKey,a.value,u);if(h instanceof H){const d=h.catch((g=>(u.done(),H.reject(g))));i.push(d)}u.isDone?r():u.G===null?a.continue():a.continue(u.G)}})).next((()=>H.waitFor(i)))}options(e,t){let i;return e!==void 0&&(typeof e=="string"?i=e:t=e),{index:i,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const i=this.store.index(e.index);return e.X?i.openKeyCursor(e.range,t):i.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Ol(n){return new H(((e,t)=>{n.onsuccess=i=>{const r=i.target.result;e(r)},n.onerror=i=>{const r=bx(i.target.error);t(r)}}))}let wR=!1;function bx(n){const e=ba.M(pn());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const i=new me("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return wR||(wR=!0,setTimeout((()=>{throw i}),0)),i}}return n}const df="IndexBackfiller";class oG{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){ce(df,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();ce(df,`Documents written: ${t}`)}catch(t){Ha(t)?ce(df,"Ignoring IndexedDB error during index backfill: ",t):await Iu(t)}await this.re(6e4)}))}}class aG{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const i=new Set;let r=t,s=!0;return H.doWhile((()=>s===!0&&r>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((o=>{if(o!==null&&!i.has(o))return ce(df,`Processing collection: ${o}`),this.oe(e,o,r).next((a=>{r-=a,i.add(o)}));s=!1})))).next((()=>t-r))}oe(e,t,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((r=>this.localStore.localDocuments.getNextDocuments(e,t,r,i).next((s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next((()=>this._e(r,s))).next((a=>(ce(df,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a)))).next((()=>o.size))}))))}_e(e,t){let i=e;return t.changes.forEach(((r,s)=>{const o=nL(s);Mx(o,i)>0&&(i=o)})),new Zi(i.readTime,i.documentKey,Math.max(t.batchId,e.largestBatchId))}}class xr{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}xr.ce=-1;const ql=-1;function U0(n){return n==null}function Kf(n){return n===0&&1/n==-1/0}function lG(n){return typeof n=="number"&&Number.isInteger(n)&&!Kf(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const P_="";function ti(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=xR(e)),e=uG(n.get(t),e);return xR(e)}function uG(n,e){let t=e;const i=n.length;for(let r=0;r<i;r++){const s=n.charAt(r);switch(s){case"\0":t+="";break;case P_:t+="";break;default:t+=s}}return t}function xR(n){return n+P_+""}function Is(n){const e=n.length;if(be(e>=2,64408,{path:n}),e===2)return be(n.charAt(0)===P_&&n.charAt(1)==="",56145,{path:n}),ft.emptyPath();const t=e-2,i=[];let r="";for(let s=0;s<e;){const o=n.indexOf(P_,s);switch((o<0||o>t)&&Ie(50515,{path:n}),n.charAt(o+1)){case"":const a=n.substring(s,o);let u;r.length===0?u=a:(r+=a,u=r,r=""),i.push(u);break;case"":r+=n.substring(s,o),r+="\0";break;case"":r+=n.substring(s,o+1);break;default:Ie(61167,{path:n})}s=o+2}return new ft(i)}const bl="remoteDocuments",Pg="owner",yc="owner",Hf="mutationQueues",cG="userId",jr="mutations",SR="batchId",Wl="userMutationsIndex",TR=["userId","batchId"];function Fp(n,e){return[n,ti(e)]}function oL(n,e,t){return[n,ti(e),t]}const hG={},gh="documentMutations",C_="remoteDocumentsV14",dG=["prefixPath","collectionGroup","readTime","documentId"],Gp="documentKeyIndex",fG=["prefixPath","collectionGroup","documentId"],aL="collectionGroupIndex",gG=["collectionGroup","readTime","prefixPath","documentId"],qf="remoteDocumentGlobal",VE="remoteDocumentGlobalKey",mh="targets",lL="queryTargetsIndex",mG=["canonicalId","targetId"],ph="targetDocuments",pG=["targetId","path"],Lx="documentTargetsIndex",_G=["path","targetId"],M_="targetGlobalKey",Xl="targetGlobal",Xf="collectionParents",yG=["collectionId","parent"],_h="clientMetadata",vG="clientId",B0="bundles",EG="bundleId",z0="namedQueries",wG="name",kx="indexConfiguration",xG="indexId",FE="collectionGroupIndex",SG="collectionGroup",ff="indexState",TG=["indexId","uid"],uL="sequenceNumberIndex",IG=["uid","sequenceNumber"],gf="indexEntries",AG=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],cL="documentKeyIndex",RG=["indexId","uid","orderedDocumentKey"],$0="documentOverlays",PG=["userId","collectionPath","documentId"],GE="collectionPathOverlayIndex",CG=["userId","collectionPath","largestBatchId"],hL="collectionGroupOverlayIndex",MG=["userId","collectionGroup","largestBatchId"],Dx="globals",bG="name",dL=[Hf,jr,gh,bl,mh,Pg,Xl,ph,_h,qf,Xf,B0,z0],LG=[...dL,$0],fL=[Hf,jr,gh,C_,mh,Pg,Xl,ph,_h,qf,Xf,B0,z0,$0],gL=fL,Nx=[...gL,kx,ff,gf],kG=Nx,mL=[...Nx,Dx],DG=mL;class jE extends rL{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function _n(n,e){const t=We(n);return ba.O(t.le,e)}function IR(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function qa(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function pL(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class Ft{constructor(e,t){this.comparator=e,this.root=t||Gn.EMPTY}insert(e,t){return new Ft(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Gn.BLACK,null,null))}remove(e){return new Ft(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Gn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new yp(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new yp(this.root,e,this.comparator,!1)}getReverseIterator(){return new yp(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new yp(this.root,e,this.comparator,!0)}}class yp{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?i(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Gn{constructor(e,t,i,r,s){this.key=e,this.value=t,this.color=i??Gn.RED,this.left=r??Gn.EMPTY,this.right=s??Gn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,s){return new Gn(e??this.key,t??this.value,i??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this;const s=i(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,i),null):s===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Gn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return Gn.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Gn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Gn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ie(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ie(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ie(27949);return e+(this.isRed()?0:1)}}Gn.EMPTY=null,Gn.RED=!0,Gn.BLACK=!1;Gn.EMPTY=new class{constructor(){this.size=0}get key(){throw Ie(57766)}get value(){throw Ie(16141)}get color(){throw Ie(16727)}get left(){throw Ie(29726)}get right(){throw Ie(36894)}copy(e,t,i,r,s){return this}insert(e,t,i){return new Gn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Tt{constructor(e){this.comparator=e,this.data=new Ft(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new AR(this.data.getIterator())}getIteratorFrom(e){return new AR(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof Tt)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=i.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Tt(this.comparator);return t.data=e,t}}class AR{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function vc(n){return n.hasNext()?n.getNext():void 0}class bi{constructor(e){this.fields=e,e.sort(zt.comparator)}static empty(){return new bi([])}unionWith(e){let t=new Tt(zt.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new bi(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return fh(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}class _L extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class un{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new _L("Invalid base64 string: "+s):s}})(e);return new un(t)}static fromUint8Array(e){const t=(function(r){let s="";for(let o=0;o<r.length;++o)s+=String.fromCharCode(r[o]);return s})(e);return new un(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return $e(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}un.EMPTY_BYTE_STRING=new un("");const NG=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function wo(n){if(be(!!n,39018),typeof n=="string"){let e=0;const t=NG.exec(n);if(be(!!t,46558,{timestamp:n}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Ot(n.seconds),nanos:Ot(n.nanos)}}function Ot(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function xo(n){return typeof n=="string"?un.fromBase64String(n):un.fromUint8Array(n)}const yL="server_timestamp",vL="__type__",EL="__previous_value__",wL="__local_write_time__";function Ox(n){return(n?.mapValue?.fields||{})[vL]?.stringValue===yL}function W0(n){const e=n.mapValue.fields[EL];return Ox(e)?W0(e):e}function Yf(n){const e=wo(n.mapValue.fields[wL].timestampValue);return new xt(e.seconds,e.nanos)}class OG{constructor(e,t,i,r,s,o,a,u,h,d){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=u,this.useFetchStreams=h,this.isUsingEmulator=d}}const b_="(default)";class hu{constructor(e,t){this.projectId=e,this.database=t||b_}static empty(){return new hu("","")}get isDefaultDatabase(){return this.database===b_}isEqual(e){return e instanceof hu&&e.projectId===this.projectId&&e.database===this.database}}const Vx="__type__",xL="__max__",xa={mapValue:{fields:{__type__:{stringValue:xL}}}},Fx="__vector__",yh="value",jp={nullValue:"NULL_VALUE"};function Va(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Ox(n)?4:SL(n)?9007199254740991:K0(n)?10:11:Ie(28295,{value:n})}function Ds(n,e){if(n===e)return!0;const t=Va(n);if(t!==Va(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Yf(n).isEqual(Yf(e));case 3:return(function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const o=wo(r.timestampValue),a=wo(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(r,s){return xo(r.bytesValue).isEqual(xo(s.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(r,s){return Ot(r.geoPointValue.latitude)===Ot(s.geoPointValue.latitude)&&Ot(r.geoPointValue.longitude)===Ot(s.geoPointValue.longitude)})(n,e);case 2:return(function(r,s){if("integerValue"in r&&"integerValue"in s)return Ot(r.integerValue)===Ot(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const o=Ot(r.doubleValue),a=Ot(s.doubleValue);return o===a?Kf(o)===Kf(a):isNaN(o)&&isNaN(a)}return!1})(n,e);case 9:return fh(n.arrayValue.values||[],e.arrayValue.values||[],Ds);case 10:case 11:return(function(r,s){const o=r.mapValue.fields||{},a=s.mapValue.fields||{};if(IR(o)!==IR(a))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(a[u]===void 0||!Ds(o[u],a[u])))return!1;return!0})(n,e);default:return Ie(52216,{left:n})}}function Zf(n,e){return(n.values||[]).find((t=>Ds(t,e)))!==void 0}function Fa(n,e){if(n===e)return 0;const t=Va(n),i=Va(e);if(t!==i)return $e(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return $e(n.booleanValue,e.booleanValue);case 2:return(function(s,o){const a=Ot(s.integerValue||s.doubleValue),u=Ot(o.integerValue||o.doubleValue);return a<u?-1:a>u?1:a===u?0:isNaN(a)?isNaN(u)?0:-1:1})(n,e);case 3:return RR(n.timestampValue,e.timestampValue);case 4:return RR(Yf(n),Yf(e));case 5:return NE(n.stringValue,e.stringValue);case 6:return(function(s,o){const a=xo(s),u=xo(o);return a.compareTo(u)})(n.bytesValue,e.bytesValue);case 7:return(function(s,o){const a=s.split("/"),u=o.split("/");for(let h=0;h<a.length&&h<u.length;h++){const d=$e(a[h],u[h]);if(d!==0)return d}return $e(a.length,u.length)})(n.referenceValue,e.referenceValue);case 8:return(function(s,o){const a=$e(Ot(s.latitude),Ot(o.latitude));return a!==0?a:$e(Ot(s.longitude),Ot(o.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return PR(n.arrayValue,e.arrayValue);case 10:return(function(s,o){const a=s.fields||{},u=o.fields||{},h=a[yh]?.arrayValue,d=u[yh]?.arrayValue,g=$e(h?.values?.length||0,d?.values?.length||0);return g!==0?g:PR(h,d)})(n.mapValue,e.mapValue);case 11:return(function(s,o){if(s===xa.mapValue&&o===xa.mapValue)return 0;if(s===xa.mapValue)return 1;if(o===xa.mapValue)return-1;const a=s.fields||{},u=Object.keys(a),h=o.fields||{},d=Object.keys(h);u.sort(),d.sort();for(let g=0;g<u.length&&g<d.length;++g){const m=NE(u[g],d[g]);if(m!==0)return m;const v=Fa(a[u[g]],h[d[g]]);if(v!==0)return v}return $e(u.length,d.length)})(n.mapValue,e.mapValue);default:throw Ie(23264,{he:t})}}function RR(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return $e(n,e);const t=wo(n),i=wo(e),r=$e(t.seconds,i.seconds);return r!==0?r:$e(t.nanos,i.nanos)}function PR(n,e){const t=n.values||[],i=e.values||[];for(let r=0;r<t.length&&r<i.length;++r){const s=Fa(t[r],i[r]);if(s)return s}return $e(t.length,i.length)}function vh(n){return UE(n)}function UE(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=wo(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return xo(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return pe.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",r=!0;for(const s of t.values||[])r?r=!1:i+=",",i+=UE(s);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let r="{",s=!0;for(const o of i)s?s=!1:r+=",",r+=`${o}:${UE(t.fields[o])}`;return r+"}"})(n.mapValue):Ie(61005,{value:n})}function Up(n){switch(Va(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=W0(n);return e?16+Up(e):16;case 5:return 2*n.stringValue.length;case 6:return xo(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((r,s)=>r+Up(s)),0)})(n.arrayValue);case 10:case 11:return(function(i){let r=0;return qa(i.fields,((s,o)=>{r+=s.length+Up(o)})),r})(n.mapValue);default:throw Ie(13486,{value:n})}}function Qf(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function BE(n){return!!n&&"integerValue"in n}function Jf(n){return!!n&&"arrayValue"in n}function CR(n){return!!n&&"nullValue"in n}function MR(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Bp(n){return!!n&&"mapValue"in n}function K0(n){return(n?.mapValue?.fields||{})[Vx]?.stringValue===Fx}function mf(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return qa(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=mf(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=mf(n.arrayValue.values[t]);return e}return{...n}}function SL(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===xL}const TL={mapValue:{fields:{[Vx]:{stringValue:Fx},[yh]:{arrayValue:{}}}}};function VG(n){return"nullValue"in n?jp:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Qf(hu.empty(),pe.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?K0(n)?TL:{mapValue:{}}:Ie(35942,{value:n})}function FG(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Qf(hu.empty(),pe.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?TL:"mapValue"in n?K0(n)?{mapValue:{}}:xa:Ie(61959,{value:n})}function bR(n,e){const t=Fa(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function LR(n,e){const t=Fa(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class Qn{constructor(e){this.value=e}static empty(){return new Qn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Bp(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=mf(t)}setAll(e){let t=zt.emptyPath(),i={},r=[];e.forEach(((o,a)=>{if(!t.isImmediateParentOf(a)){const u=this.getFieldsMap(t);this.applyChanges(u,i,r),i={},r=[],t=a.popLast()}o?i[a.lastSegment()]=mf(o):r.push(a.lastSegment())}));const s=this.getFieldsMap(t);this.applyChanges(s,i,r)}delete(e){const t=this.field(e.popLast());Bp(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ds(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];Bp(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){qa(t,((r,s)=>e[r]=s));for(const r of i)delete e[r]}clone(){return new Qn(mf(this.value))}}function IL(n){const e=[];return qa(n.fields,((t,i)=>{const r=new zt([t]);if(Bp(i)){const s=IL(i.mapValue).fields;if(s.length===0)e.push(r);else for(const o of s)e.push(r.child(o))}else e.push(r)})),new bi(e)}class Xt{constructor(e,t,i,r,s,o,a){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Xt(e,0,Le.min(),Le.min(),Le.min(),Qn.empty(),0)}static newFoundDocument(e,t,i,r){return new Xt(e,1,t,Le.min(),i,r,0)}static newNoDocument(e,t){return new Xt(e,2,t,Le.min(),Le.min(),Qn.empty(),0)}static newUnknownDocument(e,t){return new Xt(e,3,t,Le.min(),Le.min(),Qn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Le.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Qn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Qn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Le.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Xt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Xt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Eh{constructor(e,t){this.position=e,this.inclusive=t}}function kR(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){const s=e[r],o=n.position[r];if(s.field.isKeyField()?i=pe.comparator(pe.fromName(o.referenceValue),t.key):i=Fa(o,t.data.field(s.field)),s.dir==="desc"&&(i*=-1),i!==0)break}return i}function DR(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Ds(n.position[t],e.position[t]))return!1;return!0}class L_{constructor(e,t="asc"){this.field=e,this.dir=t}}function GG(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class AL{}class et extends AL{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new jG(e,t,i):t==="array-contains"?new zG(e,i):t==="in"?new LL(e,i):t==="not-in"?new $G(e,i):t==="array-contains-any"?new WG(e,i):new et(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new UG(e,i):new BG(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Fa(t,this.value)):t!==null&&Va(this.value)===Va(t)&&this.matchesComparison(Fa(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ie(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class St extends AL{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new St(e,t)}matches(e){return wh(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function wh(n){return n.op==="and"}function zE(n){return n.op==="or"}function Gx(n){return RL(n)&&wh(n)}function RL(n){for(const e of n.filters)if(e instanceof St)return!1;return!0}function $E(n){if(n instanceof et)return n.field.canonicalString()+n.op.toString()+vh(n.value);if(Gx(n))return n.filters.map((e=>$E(e))).join(",");{const e=n.filters.map((t=>$E(t))).join(",");return`${n.op}(${e})`}}function PL(n,e){return n instanceof et?(function(i,r){return r instanceof et&&i.op===r.op&&i.field.isEqual(r.field)&&Ds(i.value,r.value)})(n,e):n instanceof St?(function(i,r){return r instanceof St&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce(((s,o,a)=>s&&PL(o,r.filters[a])),!0):!1})(n,e):void Ie(19439)}function CL(n,e){const t=n.filters.concat(e);return St.create(t,n.op)}function ML(n){return n instanceof et?(function(t){return`${t.field.canonicalString()} ${t.op} ${vh(t.value)}`})(n):n instanceof St?(function(t){return t.op.toString()+" {"+t.getFilters().map(ML).join(" ,")+"}"})(n):"Filter"}class jG extends et{constructor(e,t,i){super(e,t,i),this.key=pe.fromName(i.referenceValue)}matches(e){const t=pe.comparator(e.key,this.key);return this.matchesComparison(t)}}class UG extends et{constructor(e,t){super(e,"in",t),this.keys=bL("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class BG extends et{constructor(e,t){super(e,"not-in",t),this.keys=bL("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function bL(n,e){return(e.arrayValue?.values||[]).map((t=>pe.fromName(t.referenceValue)))}class zG extends et{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Jf(t)&&Zf(t.arrayValue,this.value)}}class LL extends et{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Zf(this.value.arrayValue,t)}}class $G extends et{constructor(e,t){super(e,"not-in",t)}matches(e){if(Zf(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Zf(this.value.arrayValue,t)}}class WG extends et{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Jf(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>Zf(this.value.arrayValue,i)))}}class KG{constructor(e,t=null,i=[],r=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=o,this.endAt=a,this.Te=null}}function WE(n,e=null,t=[],i=[],r=null,s=null,o=null){return new KG(n,e,t,i,r,s,o)}function du(n){const e=We(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>$E(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(s){return s.field.canonicalString()+s.dir})(i))).join(","),U0(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>vh(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>vh(i))).join(",")),e.Te=t}return e.Te}function Cg(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!GG(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!PL(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!DR(n.startAt,e.startAt)&&DR(n.endAt,e.endAt)}function k_(n){return pe.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function D_(n,e){return n.filters.filter((t=>t instanceof et&&t.field.isEqual(e)))}function NR(n,e,t){let i=jp,r=!0;for(const s of D_(n,e)){let o=jp,a=!0;switch(s.op){case"<":case"<=":o=VG(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=jp}bR({value:i,inclusive:r},{value:o,inclusive:a})<0&&(i=o,r=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];bR({value:i,inclusive:r},{value:o,inclusive:t.inclusive})<0&&(i=o,r=t.inclusive);break}}return{value:i,inclusive:r}}function OR(n,e,t){let i=xa,r=!0;for(const s of D_(n,e)){let o=xa,a=!0;switch(s.op){case">=":case">":o=FG(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=xa}LR({value:i,inclusive:r},{value:o,inclusive:a})>0&&(i=o,r=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];LR({value:i,inclusive:r},{value:o,inclusive:t.inclusive})>0&&(i=o,r=t.inclusive);break}}return{value:i,inclusive:r}}class Mg{constructor(e,t=null,i=[],r=[],s=null,o="F",a=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function HG(n,e,t,i,r,s,o,a){return new Mg(n,e,t,i,r,s,o,a)}function jx(n){return new Mg(n)}function VR(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function kL(n){return n.collectionGroup!==null}function pf(n){const e=We(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),t.add(s.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Tt(zt.comparator);return o.filters.forEach((u=>{u.getFlattenedFilters().forEach((h=>{h.isInequality()&&(a=a.add(h.field))}))})),a})(e).forEach((s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new L_(s,i))})),t.has(zt.keyField().canonicalString())||e.Ie.push(new L_(zt.keyField(),i))}return e.Ie}function Tr(n){const e=We(n);return e.Ee||(e.Ee=qG(e,pf(n))),e.Ee}function qG(n,e){if(n.limitType==="F")return WE(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((r=>{const s=r.dir==="desc"?"asc":"desc";return new L_(r.field,s)}));const t=n.endAt?new Eh(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Eh(n.startAt.position,n.startAt.inclusive):null;return WE(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function KE(n,e){const t=n.filters.concat([e]);return new Mg(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function HE(n,e,t){return new Mg(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function H0(n,e){return Cg(Tr(n),Tr(e))&&n.limitType===e.limitType}function DL(n){return`${du(Tr(n))}|lt:${n.limitType}`}function Cc(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((r=>ML(r))).join(", ")}]`),U0(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((r=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(r))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((r=>vh(r))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((r=>vh(r))).join(",")),`Target(${i})`})(Tr(n))}; limitType=${n.limitType})`}function bg(n,e){return e.isFoundDocument()&&(function(i,r){const s=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(s):pe.isDocumentKey(i.path)?i.path.isEqual(s):i.path.isImmediateParentOf(s)})(n,e)&&(function(i,r){for(const s of pf(i))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0})(n,e)&&(function(i,r){for(const s of i.filters)if(!s.matches(r))return!1;return!0})(n,e)&&(function(i,r){return!(i.startAt&&!(function(o,a,u){const h=kR(o,a,u);return o.inclusive?h<=0:h<0})(i.startAt,pf(i),r)||i.endAt&&!(function(o,a,u){const h=kR(o,a,u);return o.inclusive?h>=0:h>0})(i.endAt,pf(i),r))})(n,e)}function XG(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function NL(n){return(e,t)=>{let i=!1;for(const r of pf(n)){const s=YG(r,e,t);if(s!==0)return s;i=i||r.field.isKeyField()}return 0}}function YG(n,e,t){const i=n.field.isKeyField()?pe.comparator(e.key,t.key):(function(s,o,a){const u=o.data.field(s),h=a.data.field(s);return u!==null&&h!==null?Fa(u,h):Ie(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Ie(19790,{direction:n.dir})}}class Po{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[r,s]of i)if(this.equalsFn(r,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){qa(this.inner,((t,i)=>{for(const[r,s]of i)e(r,s)}))}isEmpty(){return pL(this.inner)}size(){return this.innerSize}}const ZG=new Ft(pe.comparator);function Ki(){return ZG}const OL=new Ft(pe.comparator);function Yd(...n){let e=OL;for(const t of n)e=e.insert(t.key,t);return e}function VL(n){let e=OL;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function As(){return _f()}function FL(){return _f()}function _f(){return new Po((n=>n.toString()),((n,e)=>n.isEqual(e)))}const QG=new Ft(pe.comparator),JG=new Tt(pe.comparator);function Ze(...n){let e=JG;for(const t of n)e=e.add(t);return e}const ej=new Tt($e);function tj(){return ej}function Ux(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Kf(e)?"-0":e}}function GL(n){return{integerValue:""+n}}function nj(n,e){return lG(e)?GL(e):Ux(n,e)}class q0{constructor(){this._=void 0}}function ij(n,e,t){return n instanceof eg?(function(r,s){const o={fields:{[vL]:{stringValue:yL},[wL]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&Ox(s)&&(s=W0(s)),s&&(o.fields[EL]=s),{mapValue:o}})(t,e):n instanceof xh?UL(n,e):n instanceof Sh?BL(n,e):(function(r,s){const o=jL(r,s),a=FR(o)+FR(r.Ae);return BE(o)&&BE(r.Ae)?GL(a):Ux(r.serializer,a)})(n,e)}function rj(n,e,t){return n instanceof xh?UL(n,e):n instanceof Sh?BL(n,e):t}function jL(n,e){return n instanceof tg?(function(i){return BE(i)||(function(s){return!!s&&"doubleValue"in s})(i)})(e)?e:{integerValue:0}:null}class eg extends q0{}class xh extends q0{constructor(e){super(),this.elements=e}}function UL(n,e){const t=zL(e);for(const i of n.elements)t.some((r=>Ds(r,i)))||t.push(i);return{arrayValue:{values:t}}}class Sh extends q0{constructor(e){super(),this.elements=e}}function BL(n,e){let t=zL(e);for(const i of n.elements)t=t.filter((r=>!Ds(r,i)));return{arrayValue:{values:t}}}class tg extends q0{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function FR(n){return Ot(n.integerValue||n.doubleValue)}function zL(n){return Jf(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class sj{constructor(e,t){this.field=e,this.transform=t}}function oj(n,e){return n.field.isEqual(e.field)&&(function(i,r){return i instanceof xh&&r instanceof xh||i instanceof Sh&&r instanceof Sh?fh(i.elements,r.elements,Ds):i instanceof tg&&r instanceof tg?Ds(i.Ae,r.Ae):i instanceof eg&&r instanceof eg})(n.transform,e.transform)}class aj{constructor(e,t){this.version=e,this.transformResults=t}}class ci{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new ci}static exists(e){return new ci(void 0,e)}static updateTime(e){return new ci(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function zp(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class X0{}function $L(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Y0(n.key,ci.none()):new kh(n.key,n.data,ci.none());{const t=n.data,i=Qn.empty();let r=new Tt(zt.comparator);for(let s of e.fields)if(!r.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?i.delete(s):i.set(s,o),r=r.add(s)}return new Co(n.key,i,new bi(r.toArray()),ci.none())}}function lj(n,e,t){n instanceof kh?(function(r,s,o){const a=r.value.clone(),u=jR(r.fieldTransforms,s,o.transformResults);a.setAll(u),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()})(n,e,t):n instanceof Co?(function(r,s,o){if(!zp(r.precondition,s))return void s.convertToUnknownDocument(o.version);const a=jR(r.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(WL(r)),u.setAll(a),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()})(n,e,t):(function(r,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function yf(n,e,t,i){return n instanceof kh?(function(s,o,a,u){if(!zp(s.precondition,o))return a;const h=s.value.clone(),d=UR(s.fieldTransforms,u,o);return h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null})(n,e,t,i):n instanceof Co?(function(s,o,a,u){if(!zp(s.precondition,o))return a;const h=UR(s.fieldTransforms,u,o),d=o.data;return d.setAll(WL(s)),d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map((g=>g.field)))})(n,e,t,i):(function(s,o,a){return zp(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a})(n,e,t)}function uj(n,e){let t=null;for(const i of n.fieldTransforms){const r=e.data.field(i.field),s=jL(i.transform,r||null);s!=null&&(t===null&&(t=Qn.empty()),t.set(i.field,s))}return t||null}function GR(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&fh(i,r,((s,o)=>oj(s,o)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class kh extends X0{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Co extends X0{constructor(e,t,i,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function WL(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function jR(n,e,t){const i=new Map;be(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let r=0;r<t.length;r++){const s=n[r],o=s.transform,a=e.data.field(s.field);i.set(s.field,rj(o,a,t[r]))}return i}function UR(n,e,t){const i=new Map;for(const r of n){const s=r.transform,o=t.data.field(r.field);i.set(r.field,ij(s,o,e))}return i}class Y0 extends X0{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class KL extends X0{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Bx{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const s=this.mutations[r];s.key.isEqual(e.key)&&lj(s,e,i[r])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=yf(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=yf(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=FL();return this.mutations.forEach((r=>{const s=e.get(r.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=t.has(r.key)?null:a;const u=$L(o,a);u!==null&&i.set(r.key,u),o.isValidDocument()||o.convertToNoDocument(Le.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Ze())}isEqual(e){return this.batchId===e.batchId&&fh(this.mutations,e.mutations,((t,i)=>GR(t,i)))&&fh(this.baseMutations,e.baseMutations,((t,i)=>GR(t,i)))}}class zx{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){be(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let r=(function(){return QG})();const s=e.mutations;for(let o=0;o<s.length;o++)r=r.insert(s[o].key,i[o].version);return new zx(e,t,i,r)}}class $x{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class cj{constructor(e,t){this.count=e,this.unchangedNames=t}}var an,it;function hj(n){switch(n){case ee.OK:return Ie(64938);case ee.CANCELLED:case ee.UNKNOWN:case ee.DEADLINE_EXCEEDED:case ee.RESOURCE_EXHAUSTED:case ee.INTERNAL:case ee.UNAVAILABLE:case ee.UNAUTHENTICATED:return!1;case ee.INVALID_ARGUMENT:case ee.NOT_FOUND:case ee.ALREADY_EXISTS:case ee.PERMISSION_DENIED:case ee.FAILED_PRECONDITION:case ee.ABORTED:case ee.OUT_OF_RANGE:case ee.UNIMPLEMENTED:case ee.DATA_LOSS:return!0;default:return Ie(15467,{code:n})}}function HL(n){if(n===void 0)return ui("GRPC error has no .code"),ee.UNKNOWN;switch(n){case an.OK:return ee.OK;case an.CANCELLED:return ee.CANCELLED;case an.UNKNOWN:return ee.UNKNOWN;case an.DEADLINE_EXCEEDED:return ee.DEADLINE_EXCEEDED;case an.RESOURCE_EXHAUSTED:return ee.RESOURCE_EXHAUSTED;case an.INTERNAL:return ee.INTERNAL;case an.UNAVAILABLE:return ee.UNAVAILABLE;case an.UNAUTHENTICATED:return ee.UNAUTHENTICATED;case an.INVALID_ARGUMENT:return ee.INVALID_ARGUMENT;case an.NOT_FOUND:return ee.NOT_FOUND;case an.ALREADY_EXISTS:return ee.ALREADY_EXISTS;case an.PERMISSION_DENIED:return ee.PERMISSION_DENIED;case an.FAILED_PRECONDITION:return ee.FAILED_PRECONDITION;case an.ABORTED:return ee.ABORTED;case an.OUT_OF_RANGE:return ee.OUT_OF_RANGE;case an.UNIMPLEMENTED:return ee.UNIMPLEMENTED;case an.DATA_LOSS:return ee.DATA_LOSS;default:return Ie(39323,{code:n})}}(it=an||(an={}))[it.OK=0]="OK",it[it.CANCELLED=1]="CANCELLED",it[it.UNKNOWN=2]="UNKNOWN",it[it.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",it[it.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",it[it.NOT_FOUND=5]="NOT_FOUND",it[it.ALREADY_EXISTS=6]="ALREADY_EXISTS",it[it.PERMISSION_DENIED=7]="PERMISSION_DENIED",it[it.UNAUTHENTICATED=16]="UNAUTHENTICATED",it[it.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",it[it.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",it[it.ABORTED=10]="ABORTED",it[it.OUT_OF_RANGE=11]="OUT_OF_RANGE",it[it.UNIMPLEMENTED=12]="UNIMPLEMENTED",it[it.INTERNAL=13]="INTERNAL",it[it.UNAVAILABLE=14]="UNAVAILABLE",it[it.DATA_LOSS=15]="DATA_LOSS";function dj(){return new TextEncoder}const fj=new Ma([4294967295,4294967295],0);function BR(n){const e=dj().encode(n),t=new W4;return t.update(e),new Uint8Array(t.digest())}function zR(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),r=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Ma([t,i],0),new Ma([r,s],0)]}class Wx{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new Zd(`Invalid padding: ${t}`);if(i<0)throw new Zd(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new Zd(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new Zd(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Ma.fromNumber(this.ge)}ye(e,t,i){let r=e.add(t.multiply(Ma.fromNumber(i)));return r.compare(fj)===1&&(r=new Ma([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=BR(e),[i,r]=zR(t);for(let s=0;s<this.hashCount;s++){const o=this.ye(i,r,s);if(!this.we(o))return!1}return!0}static create(e,t,i){const r=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new Wx(s,r,t);return i.forEach((a=>o.insert(a))),o}insert(e){if(this.ge===0)return;const t=BR(e),[i,r]=zR(t);for(let s=0;s<this.hashCount;s++){const o=this.ye(i,r,s);this.Se(o)}}Se(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class Zd extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Z0{constructor(e,t,i,r,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const r=new Map;return r.set(e,Lg.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new Z0(Le.min(),r,new Ft($e),Ki(),Ze())}}class Lg{constructor(e,t,i,r,s){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Lg(i,t,Ze(),Ze(),Ze())}}class $p{constructor(e,t,i,r){this.be=e,this.removedTargetIds=t,this.key=i,this.De=r}}class qL{constructor(e,t){this.targetId=e,this.Ce=t}}class XL{constructor(e,t,i=un.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=r}}class $R{constructor(){this.ve=0,this.Fe=WR(),this.Me=un.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Ze(),t=Ze(),i=Ze();return this.Fe.forEach(((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:i=i.add(r);break;default:Ie(38017,{changeType:s})}})),new Lg(this.Me,this.xe,e,t,i)}qe(){this.Oe=!1,this.Fe=WR()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,be(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class gj{constructor(e){this.Ge=e,this.ze=new Map,this.je=Ki(),this.Je=vp(),this.He=vp(),this.Ye=new Ft($e)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.Ke(),i.Ne||i.qe(),i.Le(e.resumeToken);break;case 2:i.Ke(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.We(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:Ie(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,r)=>{this.rt(r)&&t(r)}))}st(e){const t=e.targetId,i=e.Ce.count,r=this.ot(t);if(r){const s=r.target;if(k_(s))if(i===0){const o=new pe(s.path);this.et(t,o,Xt.newNoDocument(o,Le.min()))}else be(i===1,20013,{expectedCount:i});else{const o=this._t(t);if(o!==i){const a=this.ut(e),u=a?this.ct(a,e,o):1;if(u!==0){this.it(t);const h=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,h)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:r=0},hashCount:s=0}=t;let o,a;try{o=xo(i).toUint8Array()}catch(u){if(u instanceof _L)return cu("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{a=new Wx(o,r,s)}catch(u){return cu(u instanceof Zd?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return a.ge===0?null:a}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let r=0;return i.forEach((s=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.et(t,s,null),r++)})),r}Tt(e){const t=new Map;this.ze.forEach(((s,o)=>{const a=this.ot(o);if(a){if(s.current&&k_(a.target)){const u=new pe(a.target.path);this.It(u).has(o)||this.Et(o,u)||this.et(o,u,Xt.newNoDocument(u,e))}s.Be&&(t.set(o,s.ke()),s.qe())}}));let i=Ze();this.He.forEach(((s,o)=>{let a=!0;o.forEachWhile((u=>{const h=this.ot(u);return!h||h.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)})),a&&(i=i.add(s))})),this.je.forEach(((s,o)=>o.setReadTime(e)));const r=new Z0(e,t,this.Ye,this.je,i);return this.je=Ki(),this.Je=vp(),this.He=vp(),this.Ye=new Ft($e),r}Xe(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,i),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,t)?r.Qe(t,1):r.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new $R,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Tt($e),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Tt($e),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||ce("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new $R),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function vp(){return new Ft(pe.comparator)}function WR(){return new Ft(pe.comparator)}const mj={asc:"ASCENDING",desc:"DESCENDING"},pj={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},_j={and:"AND",or:"OR"};class yj{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function qE(n,e){return n.useProto3Json||U0(e)?e:{value:e}}function Th(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function YL(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function vj(n,e){return Th(n,e.toTimestamp())}function di(n){return be(!!n,49232),Le.fromTimestamp((function(t){const i=wo(t);return new xt(i.seconds,i.nanos)})(n))}function Kx(n,e){return XE(n,e).canonicalString()}function XE(n,e){const t=(function(r){return new ft(["projects",r.projectId,"databases",r.database])})(n).child("documents");return e===void 0?t:t.child(e)}function ZL(n){const e=ft.fromString(n);return be(ok(e),10190,{key:e.toString()}),e}function N_(n,e){return Kx(n.databaseId,e.path)}function Yl(n,e){const t=ZL(e);if(t.get(1)!==n.databaseId.projectId)throw new me(ee.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new me(ee.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new pe(ek(t))}function QL(n,e){return Kx(n.databaseId,e)}function JL(n){const e=ZL(n);return e.length===4?ft.emptyPath():ek(e)}function YE(n){return new ft(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function ek(n){return be(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function KR(n,e,t){return{name:N_(n,e),fields:t.value.mapValue.fields}}function Ej(n,e,t){const i=Yl(n,e.name),r=di(e.updateTime),s=e.createTime?di(e.createTime):Le.min(),o=new Qn({mapValue:{fields:e.fields}}),a=Xt.newFoundDocument(i,r,s,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function wj(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:Ie(39313,{state:h})})(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],s=(function(h,d){return h.useProto3Json?(be(d===void 0||typeof d=="string",58123),un.fromBase64String(d||"")):(be(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),un.fromUint8Array(d||new Uint8Array))})(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&(function(h){const d=h.code===void 0?ee.UNKNOWN:HL(h.code);return new me(d,h.message||"")})(o);t=new XL(i,r,s,a||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const r=Yl(n,i.document.name),s=di(i.document.updateTime),o=i.document.createTime?di(i.document.createTime):Le.min(),a=new Qn({mapValue:{fields:i.document.fields}}),u=Xt.newFoundDocument(r,s,o,a),h=i.targetIds||[],d=i.removedTargetIds||[];t=new $p(h,d,u.key,u)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const r=Yl(n,i.document),s=i.readTime?di(i.readTime):Le.min(),o=Xt.newNoDocument(r,s),a=i.removedTargetIds||[];t=new $p([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const r=Yl(n,i.document),s=i.removedTargetIds||[];t=new $p([],s,r,null)}else{if(!("filter"in e))return Ie(11601,{Rt:e});{e.filter;const i=e.filter;i.targetId;const{count:r=0,unchangedNames:s}=i,o=new cj(r,s),a=i.targetId;t=new qL(a,o)}}return t}function O_(n,e){let t;if(e instanceof kh)t={update:KR(n,e.key,e.value)};else if(e instanceof Y0)t={delete:N_(n,e.key)};else if(e instanceof Co)t={update:KR(n,e.key,e.data),updateMask:Rj(e.fieldMask)};else{if(!(e instanceof KL))return Ie(16599,{Vt:e.type});t={verify:N_(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(s,o){const a=o.transform;if(a instanceof eg)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof xh)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Sh)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof tg)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw Ie(20930,{transform:o.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(r,s){return s.updateTime!==void 0?{updateTime:vj(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Ie(27497)})(n,e.precondition)),t}function ZE(n,e){const t=e.currentDocument?(function(s){return s.updateTime!==void 0?ci.updateTime(di(s.updateTime)):s.exists!==void 0?ci.exists(s.exists):ci.none()})(e.currentDocument):ci.none(),i=e.updateTransforms?e.updateTransforms.map((r=>(function(o,a){let u=null;if("setToServerValue"in a)be(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),u=new eg;else if("appendMissingElements"in a){const d=a.appendMissingElements.values||[];u=new xh(d)}else if("removeAllFromArray"in a){const d=a.removeAllFromArray.values||[];u=new Sh(d)}else"increment"in a?u=new tg(o,a.increment):Ie(16584,{proto:a});const h=zt.fromServerFormat(a.fieldPath);return new sj(h,u)})(n,r))):[];if(e.update){e.update.name;const r=Yl(n,e.update.name),s=new Qn({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=(function(u){const h=u.fieldPaths||[];return new bi(h.map((d=>zt.fromServerFormat(d))))})(e.updateMask);return new Co(r,s,o,t,i)}return new kh(r,s,t,i)}if(e.delete){const r=Yl(n,e.delete);return new Y0(r,t)}if(e.verify){const r=Yl(n,e.verify);return new KL(r,t)}return Ie(1463,{proto:e})}function xj(n,e){return n&&n.length>0?(be(e!==void 0,14353),n.map((t=>(function(r,s){let o=r.updateTime?di(r.updateTime):di(s);return o.isEqual(Le.min())&&(o=di(s)),new aj(o,r.transformResults||[])})(t,e)))):[]}function tk(n,e){return{documents:[QL(n,e.path)]}}function nk(n,e){const t={structuredQuery:{}},i=e.path;let r;e.collectionGroup!==null?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=QL(n,r);const s=(function(h){if(h.length!==0)return sk(St.create(h,"and"))})(e.filters);s&&(t.structuredQuery.where=s);const o=(function(h){if(h.length!==0)return h.map((d=>(function(m){return{field:Mc(m.field),direction:Tj(m.dir)}})(d)))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=qE(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(e.endAt)),{ft:t,parent:r}}function ik(n){let e=JL(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let r=null;if(i>0){be(i===1,65062);const d=t.from[0];d.allDescendants?r=d.collectionId:e=e.child(d.collectionId)}let s=[];t.where&&(s=(function(g){const m=rk(g);return m instanceof St&&Gx(m)?m.getFilters():[m]})(t.where));let o=[];t.orderBy&&(o=(function(g){return g.map((m=>(function(y){return new L_(bc(y.field),(function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(y.direction))})(m)))})(t.orderBy));let a=null;t.limit&&(a=(function(g){let m;return m=typeof g=="object"?g.value:g,U0(m)?null:m})(t.limit));let u=null;t.startAt&&(u=(function(g){const m=!!g.before,v=g.values||[];return new Eh(v,m)})(t.startAt));let h=null;return t.endAt&&(h=(function(g){const m=!g.before,v=g.values||[];return new Eh(v,m)})(t.endAt)),HG(e,r,o,s,a,"F",u,h)}function Sj(n,e){const t=(function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ie(28987,{purpose:r})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function rk(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=bc(t.unaryFilter.field);return et.create(i,"==",{doubleValue:NaN});case"IS_NULL":const r=bc(t.unaryFilter.field);return et.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=bc(t.unaryFilter.field);return et.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=bc(t.unaryFilter.field);return et.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ie(61313);default:return Ie(60726)}})(n):n.fieldFilter!==void 0?(function(t){return et.create(bc(t.fieldFilter.field),(function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ie(58110);default:return Ie(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return St.create(t.compositeFilter.filters.map((i=>rk(i))),(function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return Ie(1026)}})(t.compositeFilter.op))})(n):Ie(30097,{filter:n})}function Tj(n){return mj[n]}function Ij(n){return pj[n]}function Aj(n){return _j[n]}function Mc(n){return{fieldPath:n.canonicalString()}}function bc(n){return zt.fromServerFormat(n.fieldPath)}function sk(n){return n instanceof et?(function(t){if(t.op==="=="){if(MR(t.value))return{unaryFilter:{field:Mc(t.field),op:"IS_NAN"}};if(CR(t.value))return{unaryFilter:{field:Mc(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(MR(t.value))return{unaryFilter:{field:Mc(t.field),op:"IS_NOT_NAN"}};if(CR(t.value))return{unaryFilter:{field:Mc(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Mc(t.field),op:Ij(t.op),value:t.value}}})(n):n instanceof St?(function(t){const i=t.getFilters().map((r=>sk(r)));return i.length===1?i[0]:{compositeFilter:{op:Aj(t.op),filters:i}}})(n):Ie(54877,{filter:n})}function Rj(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function ok(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class uo{constructor(e,t,i,r,s=Le.min(),o=Le.min(),a=un.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=u}withSequenceNumber(e){return new uo(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new uo(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new uo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new uo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class ak{constructor(e){this.yt=e}}function Pj(n,e){let t;if(e.document)t=Ej(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const i=pe.fromSegments(e.noDocument.path),r=gu(e.noDocument.readTime);t=Xt.newNoDocument(i,r),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Ie(56709);{const i=pe.fromSegments(e.unknownDocument.path),r=gu(e.unknownDocument.version);t=Xt.newUnknownDocument(i,r)}}return e.readTime&&t.setReadTime((function(r){const s=new xt(r[0],r[1]);return Le.fromTimestamp(s)})(e.readTime)),t}function HR(n,e){const t=e.key,i={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:V_(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())i.document=(function(s,o){return{name:N_(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Th(s,o.version.toTimestamp()),createTime:Th(s,o.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())i.noDocument={path:t.path.toArray(),readTime:fu(e.version)};else{if(!e.isUnknownDocument())return Ie(57904,{document:e});i.unknownDocument={path:t.path.toArray(),version:fu(e.version)}}return i}function V_(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function fu(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function gu(n){const e=new xt(n.seconds,n.nanoseconds);return Le.fromTimestamp(e)}function Vl(n,e){const t=(e.baseMutations||[]).map((s=>ZE(n.yt,s)));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const i=e.mutations.map((s=>ZE(n.yt,s))),r=xt.fromMillis(e.localWriteTimeMs);return new Bx(e.batchId,r,t,i)}function Qd(n){const e=gu(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?gu(n.lastLimboFreeSnapshotVersion):Le.min();let i;return i=(function(s){return s.documents!==void 0})(n.query)?(function(s){const o=s.documents.length;return be(o===1,1966,{count:o}),Tr(jx(JL(s.documents[0])))})(n.query):(function(s){return Tr(ik(s))})(n.query),new uo(i,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,un.fromBase64String(n.resumeToken))}function lk(n,e){const t=fu(e.snapshotVersion),i=fu(e.lastLimboFreeSnapshotVersion);let r;r=k_(e.target)?tk(n.yt,e.target):nk(n.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:du(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:r}}function uk(n){const e=ik({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?HE(e,e.limit,"L"):e}function A1(n,e){return new $x(e.largestBatchId,ZE(n.yt,e.overlayMutation))}function qR(n,e){const t=e.path.lastSegment();return[n,ti(e.path.popLast()),t]}function XR(n,e,t,i){return{indexId:n,uid:e,sequenceNumber:t,readTime:fu(i.readTime),documentKey:ti(i.documentKey.path),largestBatchId:i.largestBatchId}}class Cj{getBundleMetadata(e,t){return YR(e).get(t).next((i=>{if(i)return(function(s){return{id:s.bundleId,createTime:gu(s.createTime),version:s.version}})(i)}))}saveBundleMetadata(e,t){return YR(e).put((function(r){return{bundleId:r.id,createTime:fu(di(r.createTime)),version:r.version}})(t))}getNamedQuery(e,t){return ZR(e).get(t).next((i=>{if(i)return(function(s){return{name:s.name,query:uk(s.bundledQuery),readTime:gu(s.readTime)}})(i)}))}saveNamedQuery(e,t){return ZR(e).put((function(r){return{name:r.name,readTime:fu(di(r.readTime)),bundledQuery:r.bundledQuery}})(t))}}function YR(n){return _n(n,B0)}function ZR(n){return _n(n,z0)}class Q0{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const i=t.uid||"";return new Q0(e,i)}getOverlay(e,t){return Dd(e).get(qR(this.userId,t)).next((i=>i?A1(this.serializer,i):null))}getOverlays(e,t){const i=As();return H.forEach(t,(r=>this.getOverlay(e,r).next((s=>{s!==null&&i.set(r,s)})))).next((()=>i))}saveOverlays(e,t,i){const r=[];return i.forEach(((s,o)=>{const a=new $x(t,o);r.push(this.St(e,a))})),H.waitFor(r)}removeOverlaysForBatchId(e,t,i){const r=new Set;t.forEach((o=>r.add(ti(o.getCollectionPath()))));const s=[];return r.forEach((o=>{const a=IDBKeyRange.bound([this.userId,o,i],[this.userId,o,i+1],!1,!0);s.push(Dd(e).Z(GE,a))})),H.waitFor(s)}getOverlaysForCollection(e,t,i){const r=As(),s=ti(t),o=IDBKeyRange.bound([this.userId,s,i],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Dd(e).J(GE,o).next((a=>{for(const u of a){const h=A1(this.serializer,u);r.set(h.getKey(),h)}return r}))}getOverlaysForCollectionGroup(e,t,i,r){const s=As();let o;const a=IDBKeyRange.bound([this.userId,t,i],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Dd(e).ee({index:hL,range:a},((u,h,d)=>{const g=A1(this.serializer,h);s.size()<r||g.largestBatchId===o?(s.set(g.getKey(),g),o=g.largestBatchId):d.done()})).next((()=>s))}St(e,t){return Dd(e).put((function(r,s,o){const[a,u,h]=qR(s,o.mutation.key);return{userId:s,collectionPath:u,documentId:h,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:O_(r.yt,o.mutation)}})(this.serializer,this.userId,t))}}function Dd(n){return _n(n,$0)}class Mj{bt(e){return _n(e,Dx)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const i=t?.value;return i?un.fromUint8Array(i):un.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class Fl{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(Ot(e.integerValue));else if("doubleValue"in e){const i=Ot(e.doubleValue);isNaN(i)?this.Ft(t,13):(this.Ft(t,15),Kf(i)?t.Mt(0):t.Mt(i))}else if("timestampValue"in e){let i=e.timestampValue;this.Ft(t,20),typeof i=="string"&&(i=wo(i)),t.xt(`${i.seconds||""}`),t.Mt(i.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(xo(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const i=e.geoPointValue;this.Ft(t,45),t.Mt(i.latitude||0),t.Mt(i.longitude||0)}else"mapValue"in e?SL(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):K0(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):Ie(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const i=e.fields||{};this.Ft(t,55);for(const r of Object.keys(i))this.Ot(r,t),this.Ct(i[r],t)}kt(e,t){const i=e.fields||{};this.Ft(t,53);const r=yh,s=i[r].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(Ot(s)),this.Ot(r,t),this.Ct(i[r],t)}Qt(e,t){const i=e.values||[];this.Ft(t,50);for(const r of i)this.Ct(r,t)}Lt(e,t){this.Ft(t,37),pe.fromName(e).path.forEach((i=>{this.Ft(t,60),this.Ut(i,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}Fl.Kt=new Fl;const Ec=255;function bj(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function QR(n){const e=64-(function(i){let r=0;for(let s=0;s<8;++s){const o=bj(255&i[s]);if(r+=o,o!==8)break}return r})(n);return Math.ceil(e/8)}class Lj{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Gt(i.value),i=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Jt(i.value),i=t.next();this.Ht()}Yt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Gt(i);else if(i<2048)this.Gt(960|i>>>6),this.Gt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i);else{const r=t.codePointAt(0);this.Gt(240|r>>>18),this.Gt(128|63&r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r)}}this.zt()}Zt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Jt(i);else if(i<2048)this.Jt(960|i>>>6),this.Jt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i);else{const r=t.codePointAt(0);this.Jt(240|r>>>18),this.Jt(128|63&r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r)}}this.Ht()}Xt(e){const t=this.en(e),i=QR(t);this.tn(1+i),this.buffer[this.position++]=255&i;for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=255&t[r]}nn(e){const t=this.en(e),i=QR(t);this.tn(1+i),this.buffer[this.position++]=~(255&i);for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}rn(){this.sn(Ec),this.sn(255)}_n(){this.an(Ec),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)})(e),i=!!(128&t[0]);t[0]^=i?255:128;for(let r=1;r<t.length;++r)t[r]^=i?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Ec?(this.sn(Ec),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Ec?(this.an(Ec),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let i=2*this.buffer.length;i<t&&(i=t);const r=new Uint8Array(i);r.set(this.buffer),this.buffer=r}}class kj{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class Dj{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Nd{constructor(){this.cn=new Lj,this.ln=new kj(this.cn),this.hn=new Dj(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class Gl{constructor(e,t,i,r){this.Tn=e,this.In=t,this.En=i,this.dn=r}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,i=new Uint8Array(t);return i.set(this.dn,0),t!==e?i.set([0],this.dn.length):++i[i.length-1],new Gl(this.Tn,this.In,this.En,i)}Rn(e,t,i){return{indexId:this.Tn,uid:e,arrayValue:Wp(this.En),directionalValue:Wp(this.dn),orderedDocumentKey:Wp(t),documentKey:i.path.toArray()}}Vn(e,t,i){const r=this.Rn(e,t,i);return[r.indexId,r.uid,r.arrayValue,r.directionalValue,r.orderedDocumentKey,r.documentKey]}}function oa(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=JR(n.En,e.En),t!==0?t:(t=JR(n.dn,e.dn),t!==0?t:pe.comparator(n.In,e.In)))}function JR(n,e){for(let t=0;t<n.length&&t<e.length;++t){const i=n[t]-e[t];if(i!==0)return i}return n.length-e.length}function Wp(n){return F4()?(function(t){let i="";for(let r=0;r<t.length;r++)i+=String.fromCharCode(t[r]);return i})(n):n}function eP(n){return typeof n!="string"?n:(function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(n)}class tP{constructor(e){this.mn=new Tt(((t,i)=>zt.comparator(t.field,i.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const i=t;i.isInequality()?this.mn=this.mn.add(i):this.gn.push(i)}}get pn(){return this.mn.size>1}yn(e){if(be(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=OE(e);if(t!==void 0&&!this.wn(t))return!1;const i=Ml(e);let r=new Set,s=0,o=0;for(;s<i.length&&this.wn(i[s]);++s)r=r.add(i[s].fieldPath.canonicalString());if(s===i.length)return!0;if(this.mn.size>0){const a=this.mn.getIterator().getNext();if(!r.has(a.field.canonicalString())){const u=i[s];if(!this.Sn(a,u)||!this.bn(this.fn[o++],u))return!1}++s}for(;s<i.length;++s){const a=i[s];if(o>=this.fn.length||!this.bn(this.fn[o++],a))return!1}return!0}Dn(){if(this.pn)return null;let e=new Tt(zt.comparator);const t=[];for(const i of this.gn)if(!i.field.isKeyField())if(i.op==="array-contains"||i.op==="array-contains-any")t.push(new Vp(i.field,2));else{if(e.has(i.field))continue;e=e.add(i.field),t.push(new Vp(i.field,0))}for(const i of this.fn)i.field.isKeyField()||e.has(i.field)||(e=e.add(i.field),t.push(new Vp(i.field,i.dir==="asc"?0:1)));return new R_(R_.UNKNOWN_ID,this.collectionId,t,Wf.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const i=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===i}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function ck(n){if(be(n instanceof et||n instanceof St,20012),n instanceof et){if(n instanceof LL){const t=n.value.arrayValue?.values?.map((i=>et.create(n.field,"==",i)))||[];return St.create(t,"or")}return n}const e=n.filters.map((t=>ck(t)));return St.create(e,n.op)}function Nj(n){if(n.getFilters().length===0)return[];const e=ew(ck(n));return be(hk(e),7391),QE(e)||JE(e)?[e]:e.getFilters()}function QE(n){return n instanceof et}function JE(n){return n instanceof St&&Gx(n)}function hk(n){return QE(n)||JE(n)||(function(t){if(t instanceof St&&zE(t)){for(const i of t.getFilters())if(!QE(i)&&!JE(i))return!1;return!0}return!1})(n)}function ew(n){if(be(n instanceof et||n instanceof St,34018),n instanceof et)return n;if(n.filters.length===1)return ew(n.filters[0]);const e=n.filters.map((i=>ew(i)));let t=St.create(e,n.op);return t=F_(t),hk(t)?t:(be(t instanceof St,64498),be(wh(t),40251),be(t.filters.length>1,57927),t.filters.reduce(((i,r)=>Hx(i,r))))}function Hx(n,e){let t;return be(n instanceof et||n instanceof St,38388),be(e instanceof et||e instanceof St,25473),t=n instanceof et?e instanceof et?(function(r,s){return St.create([r,s],"and")})(n,e):nP(n,e):e instanceof et?nP(e,n):(function(r,s){if(be(r.filters.length>0&&s.filters.length>0,48005),wh(r)&&wh(s))return CL(r,s.getFilters());const o=zE(r)?r:s,a=zE(r)?s:r,u=o.filters.map((h=>Hx(h,a)));return St.create(u,"or")})(n,e),F_(t)}function nP(n,e){if(wh(e))return CL(e,n.getFilters());{const t=e.filters.map((i=>Hx(n,i)));return St.create(t,"or")}}function F_(n){if(be(n instanceof et||n instanceof St,11850),n instanceof et)return n;const e=n.getFilters();if(e.length===1)return F_(e[0]);if(RL(n))return n;const t=e.map((r=>F_(r))),i=[];return t.forEach((r=>{r instanceof et?i.push(r):r instanceof St&&(r.op===n.op?i.push(...r.filters):i.push(r))})),i.length===1?i[0]:St.create(i,n.op)}class Oj{constructor(){this.Cn=new qx}addToCollectionParentIndex(e,t){return this.Cn.add(t),H.resolve()}getCollectionParents(e,t){return H.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return H.resolve()}deleteFieldIndex(e,t){return H.resolve()}deleteAllFieldIndexes(e){return H.resolve()}createTargetIndexes(e,t){return H.resolve()}getDocumentsMatchingTarget(e,t){return H.resolve(null)}getIndexType(e,t){return H.resolve(0)}getFieldIndexes(e,t){return H.resolve([])}getNextCollectionGroupToUpdate(e){return H.resolve(null)}getMinOffset(e,t){return H.resolve(Zi.min())}getMinOffsetFromCollectionGroup(e,t){return H.resolve(Zi.min())}updateCollectionGroup(e,t,i){return H.resolve()}updateIndexEntries(e,t){return H.resolve()}}class qx{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new Tt(ft.comparator),s=!r.has(i);return this.index[t]=r.add(i),s}has(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new Tt(ft.comparator)).toArray()}}const iP="IndexedDbIndexManager",Ep=new Uint8Array(0);class Vj{constructor(e,t){this.databaseId=t,this.vn=new qx,this.Fn=new Po((i=>du(i)),((i,r)=>Cg(i,r))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const i=t.lastSegment(),r=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const s={collectionId:i,parent:ti(r)};return rP(e).put(s)}return H.resolve()}getCollectionParents(e,t){const i=[],r=IDBKeyRange.bound([t,""],[J4(t),""],!1,!0);return rP(e).J(r).next((s=>{for(const o of s){if(o.collectionId!==t)break;i.push(Is(o.parent))}return i}))}addFieldIndex(e,t){const i=Od(e),r=(function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map((u=>[u.fieldPath.canonicalString(),u.kind]))}})(t);delete r.indexId;const s=i.add(r);if(t.indexState){const o=xc(e);return s.next((a=>{o.put(XR(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return s.next()}deleteFieldIndex(e,t){const i=Od(e),r=xc(e),s=wc(e);return i.delete(t.indexId).next((()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=Od(e),i=wc(e),r=xc(e);return t.Z().next((()=>i.Z())).next((()=>r.Z()))}createTargetIndexes(e,t){return H.forEach(this.Mn(t),(i=>this.getIndexType(e,i).next((r=>{if(r===0||r===1){const s=new tP(i).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))))}getDocumentsMatchingTarget(e,t){const i=wc(e);let r=!0;const s=new Map;return H.forEach(this.Mn(t),(o=>this.xn(e,o).next((a=>{r&&(r=!!a),s.set(o,a)})))).next((()=>{if(r){let o=Ze();const a=[];return H.forEach(s,((u,h)=>{ce(iP,`Using index ${(function(M){return`id=${M.indexId}|cg=${M.collectionGroup}|f=${M.fields.map((k=>`${k.fieldPath}:${k.kind}`)).join(",")}`})(u)} to execute ${du(t)}`);const d=(function(M,k){const N=OE(k);if(N===void 0)return null;for(const B of D_(M,N.fieldPath))switch(B.op){case"array-contains-any":return B.value.arrayValue.values||[];case"array-contains":return[B.value]}return null})(h,u),g=(function(M,k){const N=new Map;for(const B of Ml(k))for(const b of D_(M,B.fieldPath))switch(b.op){case"==":case"in":N.set(B.fieldPath.canonicalString(),b.value);break;case"not-in":case"!=":return N.set(B.fieldPath.canonicalString(),b.value),Array.from(N.values())}return null})(h,u),m=(function(M,k){const N=[];let B=!0;for(const b of Ml(k)){const R=b.kind===0?NR(M,b.fieldPath,M.startAt):OR(M,b.fieldPath,M.startAt);N.push(R.value),B&&(B=R.inclusive)}return new Eh(N,B)})(h,u),v=(function(M,k){const N=[];let B=!0;for(const b of Ml(k)){const R=b.kind===0?OR(M,b.fieldPath,M.endAt):NR(M,b.fieldPath,M.endAt);N.push(R.value),B&&(B=R.inclusive)}return new Eh(N,B)})(h,u),y=this.On(u,h,m),T=this.On(u,h,v),w=this.Nn(u,h,g),A=this.Bn(u.indexId,d,y,m.inclusive,T,v.inclusive,w);return H.forEach(A,(P=>i.Y(P,t.limit).next((M=>{M.forEach((k=>{const N=pe.fromSegments(k.documentKey);o.has(N)||(o=o.add(N),a.push(N))}))}))))})).next((()=>a))}return H.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=Nj(St.create(e.filters,"and")).map((i=>WE(e.path,e.collectionGroup,e.orderBy,i.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,i,r,s,o,a){const u=(t!=null?t.length:1)*Math.max(i.length,s.length),h=u/(t!=null?t.length:1),d=[];for(let g=0;g<u;++g){const m=t?this.Ln(t[g/h]):Ep,v=this.kn(e,m,i[g%h],r),y=this.qn(e,m,s[g%h],o),T=a.map((w=>this.kn(e,m,w,!0)));d.push(...this.createRange(v,y,T))}return d}kn(e,t,i,r){const s=new Gl(e,pe.empty(),t,i);return r?s:s.An()}qn(e,t,i,r){const s=new Gl(e,pe.empty(),t,i);return r?s.An():s}xn(e,t){const i=new tP(t),r=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next((s=>{let o=null;for(const a of s)i.yn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o}))}getIndexType(e,t){let i=2;const r=this.Mn(t);return H.forEach(r,(s=>this.xn(e,s).next((o=>{o?i!==0&&o.fields.length<(function(u){let h=new Tt(zt.comparator),d=!1;for(const g of u.filters)for(const m of g.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?d=!0:h=h.add(m.field));for(const g of u.orderBy)g.field.isKeyField()||(h=h.add(g.field));return h.size+(d?1:0)})(s)&&(i=1):i=0})))).next((()=>(function(o){return o.limit!==null})(t)&&r.length>1&&i===2?1:i))}Qn(e,t){const i=new Nd;for(const r of Ml(e)){const s=t.data.field(r.fieldPath);if(s==null)return null;const o=i.Pn(r.kind);Fl.Kt.Dt(s,o)}return i.un()}Ln(e){const t=new Nd;return Fl.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const i=new Nd;return Fl.Kt.Dt(Qf(this.databaseId,t),i.Pn((function(s){const o=Ml(s);return o.length===0?0:o[o.length-1].kind})(e))),i.un()}Nn(e,t,i){if(i===null)return[];let r=[];r.push(new Nd);let s=0;for(const o of Ml(e)){const a=i[s++];for(const u of r)if(this.Un(t,o.fieldPath)&&Jf(a))r=this.Kn(r,o,a);else{const h=u.Pn(o.kind);Fl.Kt.Dt(a,h)}}return this.Wn(r)}On(e,t,i){return this.Nn(e,t,i.position)}Wn(e){const t=[];for(let i=0;i<e.length;++i)t[i]=e[i].un();return t}Kn(e,t,i){const r=[...e],s=[];for(const o of i.arrayValue.values||[])for(const a of r){const u=new Nd;u.seed(a.un()),Fl.Kt.Dt(o,u.Pn(t.kind)),s.push(u)}return s}Un(e,t){return!!e.filters.find((i=>i instanceof et&&i.field.isEqual(t)&&(i.op==="in"||i.op==="not-in")))}getFieldIndexes(e,t){const i=Od(e),r=xc(e);return(t?i.J(FE,IDBKeyRange.bound(t,t)):i.J()).next((s=>{const o=[];return H.forEach(s,(a=>r.get([a.indexId,this.uid]).next((u=>{o.push((function(d,g){const m=g?new Wf(g.sequenceNumber,new Zi(gu(g.readTime),new pe(Is(g.documentKey)),g.largestBatchId)):Wf.empty(),v=d.fields.map((([y,T])=>new Vp(zt.fromServerFormat(y),T)));return new R_(d.indexId,d.collectionGroup,v,m)})(a,u))})))).next((()=>o))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((i,r)=>{const s=i.indexState.sequenceNumber-r.indexState.sequenceNumber;return s!==0?s:$e(i.collectionGroup,r.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,i){const r=Od(e),s=xc(e);return this.Gn(e).next((o=>r.J(FE,IDBKeyRange.bound(t,t)).next((a=>H.forEach(a,(u=>s.put(XR(u.indexId,this.uid,o,i))))))))}updateIndexEntries(e,t){const i=new Map;return H.forEach(t,((r,s)=>{const o=i.get(r.collectionGroup);return(o?H.resolve(o):this.getFieldIndexes(e,r.collectionGroup)).next((a=>(i.set(r.collectionGroup,a),H.forEach(a,(u=>this.zn(e,r,u).next((h=>{const d=this.jn(s,u);return h.isEqual(d)?H.resolve():this.Jn(e,s,u,h,d)})))))))}))}Hn(e,t,i,r){return wc(e).put(r.Rn(this.uid,this.$n(i,t.key),t.key))}Yn(e,t,i,r){return wc(e).delete(r.Vn(this.uid,this.$n(i,t.key),t.key))}zn(e,t,i){const r=wc(e);let s=new Tt(oa);return r.ee({index:cL,range:IDBKeyRange.only([i.indexId,this.uid,Wp(this.$n(i,t))])},((o,a)=>{s=s.add(new Gl(i.indexId,t,eP(a.arrayValue),eP(a.directionalValue)))})).next((()=>s))}jn(e,t){let i=new Tt(oa);const r=this.Qn(t,e);if(r==null)return i;const s=OE(t);if(s!=null){const o=e.data.field(s.fieldPath);if(Jf(o))for(const a of o.arrayValue.values||[])i=i.add(new Gl(t.indexId,e.key,this.Ln(a),r))}else i=i.add(new Gl(t.indexId,e.key,Ep,r));return i}Jn(e,t,i,r,s){ce(iP,"Updating index entries for document '%s'",t.key);const o=[];return(function(u,h,d,g,m){const v=u.getIterator(),y=h.getIterator();let T=vc(v),w=vc(y);for(;T||w;){let A=!1,P=!1;if(T&&w){const M=d(T,w);M<0?P=!0:M>0&&(A=!0)}else T!=null?P=!0:A=!0;A?(g(w),w=vc(y)):P?(m(T),T=vc(v)):(T=vc(v),w=vc(y))}})(r,s,oa,(a=>{o.push(this.Hn(e,t,i,a))}),(a=>{o.push(this.Yn(e,t,i,a))})),H.waitFor(o)}Gn(e){let t=1;return xc(e).ee({index:uL,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((i,r,s)=>{s.done(),t=r.sequenceNumber+1})).next((()=>t))}createRange(e,t,i){i=i.sort(((o,a)=>oa(o,a))).filter(((o,a,u)=>!a||oa(o,u[a-1])!==0));const r=[];r.push(e);for(const o of i){const a=oa(o,e),u=oa(o,t);if(a===0)r[0]=e.An();else if(a>0&&u<0)r.push(o),r.push(o.An());else if(u>0)break}r.push(t);const s=[];for(let o=0;o<r.length;o+=2){if(this.Zn(r[o],r[o+1]))return[];const a=r[o].Vn(this.uid,Ep,pe.empty()),u=r[o+1].Vn(this.uid,Ep,pe.empty());s.push(IDBKeyRange.bound(a,u))}return s}Zn(e,t){return oa(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(sP)}getMinOffset(e,t){return H.mapArray(this.Mn(t),(i=>this.xn(e,i).next((r=>r||Ie(44426))))).next(sP)}}function rP(n){return _n(n,Xf)}function wc(n){return _n(n,gf)}function Od(n){return _n(n,kx)}function xc(n){return _n(n,ff)}function sP(n){be(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let i=1;i<n.length;i++){const r=n[i].indexState.offset;Mx(r,e)<0&&(e=r),t<r.largestBatchId&&(t=r.largestBatchId)}return new Zi(e.readTime,e.documentKey,t)}const oP={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},dk=41943040;class Yn{static withCacheSize(e){return new Yn(e,Yn.DEFAULT_COLLECTION_PERCENTILE,Yn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}function fk(n,e,t){const i=n.store(jr),r=n.store(gh),s=[],o=IDBKeyRange.only(t.batchId);let a=0;const u=i.ee({range:o},((d,g,m)=>(a++,m.delete())));s.push(u.next((()=>{be(a===1,47070,{batchId:t.batchId})})));const h=[];for(const d of t.mutations){const g=oL(e,d.key.path,t.batchId);s.push(r.delete(g)),h.push(d.key)}return H.waitFor(s).next((()=>h))}function G_(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Ie(14731);e=n.noDocument}return JSON.stringify(e).length}Yn.DEFAULT_COLLECTION_PERCENTILE=10,Yn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Yn.DEFAULT=new Yn(dk,Yn.DEFAULT_COLLECTION_PERCENTILE,Yn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Yn.DISABLED=new Yn(-1,0,0);class J0{constructor(e,t,i,r){this.userId=e,this.serializer=t,this.indexManager=i,this.referenceDelegate=r,this.Xn={}}static wt(e,t,i,r){be(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new J0(s,t,i,r)}checkEmpty(e){let t=!0;const i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return aa(e).ee({index:Wl,range:i},((r,s,o)=>{t=!1,o.done()})).next((()=>t))}addMutationBatch(e,t,i,r){const s=Lc(e),o=aa(e);return o.add({}).next((a=>{be(typeof a=="number",49019);const u=new Bx(a,t,i,r),h=(function(v,y,T){const w=T.baseMutations.map((P=>O_(v.yt,P))),A=T.mutations.map((P=>O_(v.yt,P)));return{userId:y,batchId:T.batchId,localWriteTimeMs:T.localWriteTime.toMillis(),baseMutations:w,mutations:A}})(this.serializer,this.userId,u),d=[];let g=new Tt(((m,v)=>$e(m.canonicalString(),v.canonicalString())));for(const m of r){const v=oL(this.userId,m.key.path,a);g=g.add(m.key.path.popLast()),d.push(o.put(h)),d.push(s.put(v,hG))}return g.forEach((m=>{d.push(this.indexManager.addToCollectionParentIndex(e,m))})),e.addOnCommittedListener((()=>{this.Xn[a]=u.keys()})),H.waitFor(d).next((()=>u))}))}lookupMutationBatch(e,t){return aa(e).get(t).next((i=>i?(be(i.userId===this.userId,48,"Unexpected user for mutation batch",{userId:i.userId,batchId:t}),Vl(this.serializer,i)):null))}er(e,t){return this.Xn[t]?H.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((i=>{if(i){const r=i.keys();return this.Xn[t]=r,r}return null}))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=IDBKeyRange.lowerBound([this.userId,i]);let s=null;return aa(e).ee({index:Wl,range:r},((o,a,u)=>{a.userId===this.userId&&(be(a.batchId>=i,47524,{tr:i}),s=Vl(this.serializer,a)),u.done()})).next((()=>s))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let i=ql;return aa(e).ee({index:Wl,range:t,reverse:!0},((r,s,o)=>{i=s.batchId,o.done()})).next((()=>i))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,ql],[this.userId,Number.POSITIVE_INFINITY]);return aa(e).J(Wl,t).next((i=>i.map((r=>Vl(this.serializer,r)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const i=Fp(this.userId,t.path),r=IDBKeyRange.lowerBound(i),s=[];return Lc(e).ee({range:r},((o,a,u)=>{const[h,d,g]=o,m=Is(d);if(h===this.userId&&t.path.isEqual(m))return aa(e).get(g).next((v=>{if(!v)throw Ie(61480,{nr:o,batchId:g});be(v.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:v.userId,batchId:g}),s.push(Vl(this.serializer,v))}));u.done()})).next((()=>s))}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Tt($e);const r=[];return t.forEach((s=>{const o=Fp(this.userId,s.path),a=IDBKeyRange.lowerBound(o),u=Lc(e).ee({range:a},((h,d,g)=>{const[m,v,y]=h,T=Is(v);m===this.userId&&s.path.isEqual(T)?i=i.add(y):g.done()}));r.push(u)})),H.waitFor(r).next((()=>this.rr(e,i)))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1,s=Fp(this.userId,i),o=IDBKeyRange.lowerBound(s);let a=new Tt($e);return Lc(e).ee({range:o},((u,h,d)=>{const[g,m,v]=u,y=Is(m);g===this.userId&&i.isPrefixOf(y)?y.length===r&&(a=a.add(v)):d.done()})).next((()=>this.rr(e,a)))}rr(e,t){const i=[],r=[];return t.forEach((s=>{r.push(aa(e).get(s).next((o=>{if(o===null)throw Ie(35274,{batchId:s});be(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:s}),i.push(Vl(this.serializer,o))})))})),H.waitFor(r).next((()=>i))}removeMutationBatch(e,t){return fk(e.le,this.userId,t).next((i=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),H.forEach(i,(r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return H.resolve();const i=IDBKeyRange.lowerBound((function(o){return[o]})(this.userId)),r=[];return Lc(e).ee({range:i},((s,o,a)=>{if(s[0]===this.userId){const u=Is(s[1]);r.push(u)}else a.done()})).next((()=>{be(r.length===0,56720,{sr:r.map((s=>s.canonicalString()))})}))}))}containsKey(e,t){return gk(e,this.userId,t)}_r(e){return mk(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:ql,lastStreamToken:""}))}}function gk(n,e,t){const i=Fp(e,t.path),r=i[1],s=IDBKeyRange.lowerBound(i);let o=!1;return Lc(n).ee({range:s,X:!0},((a,u,h)=>{const[d,g,m]=a;d===e&&g===r&&(o=!0),h.done()})).next((()=>o))}function aa(n){return _n(n,jr)}function Lc(n){return _n(n,gh)}function mk(n){return _n(n,Hf)}class mu{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new mu(0)}static cr(){return new mu(-1)}}class Fj{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const i=new mu(t.highestTargetId);return t.highestTargetId=i.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>Le.fromTimestamp(new xt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,i){return this.lr(e).next((r=>(r.highestListenSequenceNumber=t,i&&(r.lastRemoteSnapshotVersion=i.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.hr(e,r))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((i=>(i.targetCount+=1,this.Tr(t,i),this.hr(e,i))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>Sc(e).delete(t.targetId))).next((()=>this.lr(e))).next((i=>(be(i.targetCount>0,8065),i.targetCount-=1,this.hr(e,i))))}removeTargets(e,t,i){let r=0;const s=[];return Sc(e).ee(((o,a)=>{const u=Qd(a);u.sequenceNumber<=t&&i.get(u.targetId)===null&&(r++,s.push(this.removeTargetData(e,u)))})).next((()=>H.waitFor(s))).next((()=>r))}forEachTarget(e,t){return Sc(e).ee(((i,r)=>{const s=Qd(r);t(s)}))}lr(e){return aP(e).get(M_).next((t=>(be(t!==null,2888),t)))}hr(e,t){return aP(e).put(M_,t)}Pr(e,t){return Sc(e).put(lk(this.serializer,t))}Tr(e,t){let i=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,i=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,i=!0),i}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const i=du(t),r=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]);let s=null;return Sc(e).ee({range:r,index:lL},((o,a,u)=>{const h=Qd(a);Cg(t,h.target)&&(s=h,u.done())})).next((()=>s))}addMatchingKeys(e,t,i){const r=[],s=ga(e);return t.forEach((o=>{const a=ti(o.path);r.push(s.put({targetId:i,path:a})),r.push(this.referenceDelegate.addReference(e,i,o))})),H.waitFor(r)}removeMatchingKeys(e,t,i){const r=ga(e);return H.forEach(t,(s=>{const o=ti(s.path);return H.waitFor([r.delete([i,o]),this.referenceDelegate.removeReference(e,i,s)])}))}removeMatchingKeysForTargetId(e,t){const i=ga(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return i.delete(r)}getMatchingKeysForTargetId(e,t){const i=IDBKeyRange.bound([t],[t+1],!1,!0),r=ga(e);let s=Ze();return r.ee({range:i,X:!0},((o,a,u)=>{const h=Is(o[1]),d=new pe(h);s=s.add(d)})).next((()=>s))}containsKey(e,t){const i=ti(t.path),r=IDBKeyRange.bound([i],[J4(i)],!1,!0);let s=0;return ga(e).ee({index:Lx,X:!0,range:r},(([o,a],u,h)=>{o!==0&&(s++,h.done())})).next((()=>s>0))}At(e,t){return Sc(e).get(t).next((i=>i?Qd(i):null))}}function Sc(n){return _n(n,mh)}function aP(n){return _n(n,Xl)}function ga(n){return _n(n,ph)}const lP="LruGarbageCollector",Gj=1048576;function uP([n,e],[t,i]){const r=$e(n,t);return r===0?$e(e,i):r}class jj{constructor(e){this.Ir=e,this.buffer=new Tt(uP),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();uP(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class pk{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){ce(lP,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Ha(t)?ce(lP,"Ignoring IndexedDB error during garbage collection: ",t):await Iu(t)}await this.Vr(3e5)}))}}class Uj{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return H.resolve(xr.ce);const i=new jj(t);return this.mr.forEachTarget(e,(r=>i.Ar(r.sequenceNumber))).next((()=>this.mr.pr(e,(r=>i.Ar(r))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.mr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ce("LruGarbageCollector","Garbage collection skipped; disabled"),H.resolve(oP)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(ce("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),oP):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let i,r,s,o,a,u,h;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((g=>(g>this.params.maximumSequenceNumbersToCollect?(ce("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${g}`),r=this.params.maximumSequenceNumbersToCollect):r=g,o=Date.now(),this.nthSequenceNumber(e,r)))).next((g=>(i=g,a=Date.now(),this.removeTargets(e,i,t)))).next((g=>(s=g,u=Date.now(),this.removeOrphanedDocuments(e,i)))).next((g=>(h=Date.now(),Pc()<=Je.DEBUG&&ce("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${r} in `+(a-o)+`ms
	Removed ${s} targets in `+(u-a)+`ms
	Removed ${g} documents in `+(h-u)+`ms
Total Duration: ${h-d}ms`),H.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:g}))))}}function _k(n,e){return new Uj(n,e)}class Bj{constructor(e,t){this.db=e,this.garbageCollector=_k(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((i=>t.next((r=>i+r))))}wr(e){let t=0;return this.pr(e,(i=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((i,r)=>t(r)))}addReference(e,t,i){return wp(e,i)}removeReference(e,t,i){return wp(e,i)}removeTargets(e,t,i){return this.db.getTargetCache().removeTargets(e,t,i)}markPotentiallyOrphaned(e,t){return wp(e,t)}br(e,t){return(function(r,s){let o=!1;return mk(r).te((a=>gk(r,a,s).next((u=>(u&&(o=!0),H.resolve(!u)))))).next((()=>o))})(e,t)}removeOrphanedDocuments(e,t){const i=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let s=0;return this.Sr(e,((o,a)=>{if(a<=t){const u=this.br(e,o).next((h=>{if(!h)return s++,i.getEntry(e,o).next((()=>(i.removeEntry(o,Le.min()),ga(e).delete((function(g){return[0,ti(g.path)]})(o)))))}));r.push(u)}})).next((()=>H.waitFor(r))).next((()=>i.apply(e))).next((()=>s))}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,i)}updateLimboDocument(e,t){return wp(e,t)}Sr(e,t){const i=ga(e);let r,s=xr.ce;return i.ee({index:Lx},(([o,a],{path:u,sequenceNumber:h})=>{o===0?(s!==xr.ce&&t(new pe(Is(r)),s),s=h,r=u):s=xr.ce})).next((()=>{s!==xr.ce&&t(new pe(Is(r)),s)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function wp(n,e){return ga(n).put((function(i,r){return{targetId:0,path:ti(i.path),sequenceNumber:r}})(e,n.currentSequenceNumber))}class yk{constructor(){this.changes=new Po((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Xt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?H.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class zj{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,i){return Tl(e).put(i)}removeEntry(e,t,i){return Tl(e).delete((function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],V_(o),a[a.length-1]]})(t,i))}updateMetadata(e,t){return this.getMetadata(e).next((i=>(i.byteSize+=t,this.Dr(e,i))))}getEntry(e,t){let i=Xt.newInvalidDocument(t);return Tl(e).ee({index:Gp,range:IDBKeyRange.only(Vd(t))},((r,s)=>{i=this.Cr(t,s)})).next((()=>i))}vr(e,t){let i={size:0,document:Xt.newInvalidDocument(t)};return Tl(e).ee({index:Gp,range:IDBKeyRange.only(Vd(t))},((r,s)=>{i={document:this.Cr(t,s),size:G_(s)}})).next((()=>i))}getEntries(e,t){let i=Ki();return this.Fr(e,t,((r,s)=>{const o=this.Cr(r,s);i=i.insert(r,o)})).next((()=>i))}Mr(e,t){let i=Ki(),r=new Ft(pe.comparator);return this.Fr(e,t,((s,o)=>{const a=this.Cr(s,o);i=i.insert(s,a),r=r.insert(s,G_(o))})).next((()=>({documents:i,Or:r})))}Fr(e,t,i){if(t.isEmpty())return H.resolve();let r=new Tt(dP);t.forEach((u=>r=r.add(u)));const s=IDBKeyRange.bound(Vd(r.first()),Vd(r.last())),o=r.getIterator();let a=o.getNext();return Tl(e).ee({index:Gp,range:s},((u,h,d)=>{const g=pe.fromSegments([...h.prefixPath,h.collectionGroup,h.documentId]);for(;a&&dP(a,g)<0;)i(a,null),a=o.getNext();a&&a.isEqual(g)&&(i(a,h),a=o.hasNext()?o.getNext():null),a?d.j(Vd(a)):d.done()})).next((()=>{for(;a;)i(a,null),a=o.hasNext()?o.getNext():null}))}getDocumentsMatchingQuery(e,t,i,r,s){const o=t.path,a=[o.popLast().toArray(),o.lastSegment(),V_(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Tl(e).J(IDBKeyRange.bound(a,u,!0)).next((h=>{s?.incrementDocumentReadCount(h.length);let d=Ki();for(const g of h){const m=this.Cr(pe.fromSegments(g.prefixPath.concat(g.collectionGroup,g.documentId)),g);m.isFoundDocument()&&(bg(t,m)||r.has(m.key))&&(d=d.insert(m.key,m))}return d}))}getAllFromCollectionGroup(e,t,i,r){let s=Ki();const o=hP(t,i),a=hP(t,Zi.max());return Tl(e).ee({index:aL,range:IDBKeyRange.bound(o,a,!0)},((u,h,d)=>{const g=this.Cr(pe.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);s=s.insert(g.key,g),s.size===r&&d.done()})).next((()=>s))}newChangeBuffer(e){return new $j(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return cP(e).get(VE).next((t=>(be(!!t,20021),t)))}Dr(e,t){return cP(e).put(VE,t)}Cr(e,t){if(t){const i=Pj(this.serializer,t);if(!(i.isNoDocument()&&i.version.isEqual(Le.min())))return i}return Xt.newInvalidDocument(e)}}function vk(n){return new zj(n)}class $j extends yk{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new Po((i=>i.toString()),((i,r)=>i.isEqual(r)))}applyChanges(e){const t=[];let i=0,r=new Tt(((s,o)=>$e(s.canonicalString(),o.canonicalString())));return this.changes.forEach(((s,o)=>{const a=this.Br.get(s);if(t.push(this.Nr.removeEntry(e,s,a.readTime)),o.isValidDocument()){const u=HR(this.Nr.serializer,o);r=r.add(s.path.popLast());const h=G_(u);i+=h-a.size,t.push(this.Nr.addEntry(e,s,u))}else if(i-=a.size,this.trackRemovals){const u=HR(this.Nr.serializer,o.convertToNoDocument(Le.min()));t.push(this.Nr.addEntry(e,s,u))}})),r.forEach((s=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))})),t.push(this.Nr.updateMetadata(e,i)),H.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((i=>(this.Br.set(t,{size:i.size,readTime:i.document.readTime}),i.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:i,Or:r})=>(r.forEach(((s,o)=>{this.Br.set(s,{size:o,readTime:i.get(s).readTime})})),i)))}}function cP(n){return _n(n,qf)}function Tl(n){return _n(n,C_)}function Vd(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function hP(n,e){const t=e.documentKey.path.toArray();return[n,V_(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function dP(n,e){const t=n.path.toArray(),i=e.path.toArray();let r=0;for(let s=0;s<t.length-2&&s<i.length-2;++s)if(r=$e(t[s],i[s]),r)return r;return r=$e(t.length,i.length),r||(r=$e(t[t.length-2],i[i.length-2]),r||$e(t[t.length-1],i[i.length-1]))}class Wj{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class Ek{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(i=r,this.remoteDocumentCache.getEntry(e,t)))).next((r=>(i!==null&&yf(i.mutation,r,bi.empty(),xt.now()),r)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,Ze()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=Ze()){const r=As();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,i).next((s=>{let o=Yd();return s.forEach(((a,u)=>{o=o.insert(a,u.overlayedDocument)})),o}))))}getOverlayedDocuments(e,t){const i=As();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,Ze())))}populateOverlays(e,t,i){const r=[];return i.forEach((s=>{t.has(s)||r.push(s)})),this.documentOverlayCache.getOverlays(e,r).next((s=>{s.forEach(((o,a)=>{t.set(o,a)}))}))}computeViews(e,t,i,r){let s=Ki();const o=_f(),a=(function(){return _f()})();return t.forEach(((u,h)=>{const d=i.get(h.key);r.has(h.key)&&(d===void 0||d.mutation instanceof Co)?s=s.insert(h.key,h):d!==void 0?(o.set(h.key,d.mutation.getFieldMask()),yf(d.mutation,h,d.mutation.getFieldMask(),xt.now())):o.set(h.key,bi.empty())})),this.recalculateAndSaveOverlays(e,s).next((u=>(u.forEach(((h,d)=>o.set(h,d))),t.forEach(((h,d)=>a.set(h,new Wj(d,o.get(h)??null)))),a)))}recalculateAndSaveOverlays(e,t){const i=_f();let r=new Ft(((o,a)=>o-a)),s=Ze();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((o=>{for(const a of o)a.keys().forEach((u=>{const h=t.get(u);if(h===null)return;let d=i.get(u)||bi.empty();d=a.applyToLocalView(h,d),i.set(u,d);const g=(r.get(a.batchId)||Ze()).add(u);r=r.insert(a.batchId,g)}))})).next((()=>{const o=[],a=r.getReverseIterator();for(;a.hasNext();){const u=a.getNext(),h=u.key,d=u.value,g=FL();d.forEach((m=>{if(!s.has(m)){const v=$L(t.get(m),i.get(m));v!==null&&g.set(m,v),s=s.add(m)}})),o.push(this.documentOverlayCache.saveOverlays(e,h,g))}return H.waitFor(o)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,r){return(function(o){return pe.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):kL(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next((s=>{const o=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-s.size):H.resolve(As());let a=$f,u=s;return o.next((h=>H.forEach(h,((d,g)=>(a<g.largestBatchId&&(a=g.largestBatchId),s.get(d)?H.resolve():this.remoteDocumentCache.getEntry(e,d).next((m=>{u=u.insert(d,m)}))))).next((()=>this.populateOverlays(e,h,s))).next((()=>this.computeViews(e,u,h,Ze()))).next((d=>({batchId:a,changes:VL(d)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new pe(t)).next((i=>{let r=Yd();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){const s=t.collectionGroup;let o=Yd();return this.indexManager.getCollectionParents(e,s).next((a=>H.forEach(a,(u=>{const h=(function(g,m){return new Mg(m,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)})(t,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,h,i,r).next((d=>{d.forEach(((g,m)=>{o=o.insert(g,m)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,t,i,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,s,r)))).next((o=>{s.forEach(((u,h)=>{const d=h.getKey();o.get(d)===null&&(o=o.insert(d,Xt.newInvalidDocument(d)))}));let a=Yd();return o.forEach(((u,h)=>{const d=s.get(u);d!==void 0&&yf(d.mutation,h,bi.empty(),xt.now()),bg(t,h)&&(a=a.insert(u,h))})),a}))}}class Kj{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return H.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(r){return{id:r.id,version:r.version,createTime:di(r.createTime)}})(t)),H.resolve()}getNamedQuery(e,t){return H.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(r){return{name:r.name,query:uk(r.bundledQuery),readTime:di(r.readTime)}})(t)),H.resolve()}}class Hj{constructor(){this.overlays=new Ft(pe.comparator),this.qr=new Map}getOverlay(e,t){return H.resolve(this.overlays.get(t))}getOverlays(e,t){const i=As();return H.forEach(t,(r=>this.getOverlay(e,r).next((s=>{s!==null&&i.set(r,s)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((r,s)=>{this.St(e,t,s)})),H.resolve()}removeOverlaysForBatchId(e,t,i){const r=this.qr.get(i);return r!==void 0&&(r.forEach((s=>this.overlays=this.overlays.remove(s))),this.qr.delete(i)),H.resolve()}getOverlaysForCollection(e,t,i){const r=As(),s=t.length+1,o=new pe(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const u=a.getNext().value,h=u.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===s&&u.largestBatchId>i&&r.set(u.getKey(),u)}return H.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let s=new Ft(((h,d)=>h-d));const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>i){let d=s.get(h.largestBatchId);d===null&&(d=As(),s=s.insert(h.largestBatchId,d)),d.set(h.getKey(),h)}}const a=As(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach(((h,d)=>a.set(h,d))),!(a.size()>=r)););return H.resolve(a)}St(e,t,i){const r=this.overlays.get(i.key);if(r!==null){const o=this.qr.get(r.largestBatchId).delete(i.key);this.qr.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new $x(t,i));let s=this.qr.get(t);s===void 0&&(s=Ze(),this.qr.set(t,s)),this.qr.set(t,s.add(i.key))}}class qj{constructor(){this.sessionToken=un.EMPTY_BYTE_STRING}getSessionToken(e){return H.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,H.resolve()}}class Xx{constructor(){this.Qr=new Tt(Tn.$r),this.Ur=new Tt(Tn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const i=new Tn(e,t);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Gr(new Tn(e,t))}zr(e,t){e.forEach((i=>this.removeReference(i,t)))}jr(e){const t=new pe(new ft([])),i=new Tn(t,e),r=new Tn(t,e+1),s=[];return this.Ur.forEachInRange([i,r],(o=>{this.Gr(o),s.push(o.key)})),s}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new pe(new ft([])),i=new Tn(t,e),r=new Tn(t,e+1);let s=Ze();return this.Ur.forEachInRange([i,r],(o=>{s=s.add(o.key)})),s}containsKey(e){const t=new Tn(e,0),i=this.Qr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class Tn{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return pe.comparator(e.key,t.key)||$e(e.Yr,t.Yr)}static Kr(e,t){return $e(e.Yr,t.Yr)||pe.comparator(e.key,t.key)}}class Xj{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Tt(Tn.$r)}checkEmpty(e){return H.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Bx(s,t,i,r);this.mutationQueue.push(o);for(const a of r)this.Zr=this.Zr.add(new Tn(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return H.resolve(o)}lookupMutationBatch(e,t){return H.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=this.ei(i),s=r<0?0:r;return H.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return H.resolve(this.mutationQueue.length===0?ql:this.tr-1)}getAllMutationBatches(e){return H.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Tn(t,0),r=new Tn(t,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([i,r],(o=>{const a=this.Xr(o.Yr);s.push(a)})),H.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Tt($e);return t.forEach((r=>{const s=new Tn(r,0),o=new Tn(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,o],(a=>{i=i.add(a.Yr)}))})),H.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1;let s=i;pe.isDocumentKey(s)||(s=s.child(""));const o=new Tn(new pe(s),0);let a=new Tt($e);return this.Zr.forEachWhile((u=>{const h=u.key.path;return!!i.isPrefixOf(h)&&(h.length===r&&(a=a.add(u.Yr)),!0)}),o),H.resolve(this.ti(a))}ti(e){const t=[];return e.forEach((i=>{const r=this.Xr(i);r!==null&&t.push(r)})),t}removeMutationBatch(e,t){be(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return H.forEach(t.mutations,(r=>{const s=new Tn(r.key,t.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Zr=i}))}ir(e){}containsKey(e,t){const i=new Tn(t,0),r=this.Zr.firstAfterOrEqual(i);return H.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,H.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Yj{constructor(e){this.ri=e,this.docs=(function(){return new Ft(pe.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,r=this.docs.get(i),s=r?r.size:0,o=this.ri(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return H.resolve(i?i.document.mutableCopy():Xt.newInvalidDocument(t))}getEntries(e,t){let i=Ki();return t.forEach((r=>{const s=this.docs.get(r);i=i.insert(r,s?s.document.mutableCopy():Xt.newInvalidDocument(r))})),H.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let s=Ki();const o=t.path,a=new pe(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(a);for(;u.hasNext();){const{key:h,value:{document:d}}=u.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||Mx(nL(d),i)<=0||(r.has(d.key)||bg(t,d))&&(s=s.insert(d.key,d.mutableCopy()))}return H.resolve(s)}getAllFromCollectionGroup(e,t,i,r){Ie(9500)}ii(e,t){return H.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new Zj(this)}getSize(e){return H.resolve(this.size)}}class Zj extends yk{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(i)})),H.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class Qj{constructor(e){this.persistence=e,this.si=new Po((t=>du(t)),Cg),this.lastRemoteSnapshotVersion=Le.min(),this.highestTargetId=0,this.oi=0,this._i=new Xx,this.targetCount=0,this.ai=mu.ur()}forEachTarget(e,t){return this.si.forEach(((i,r)=>t(r))),H.resolve()}getLastRemoteSnapshotVersion(e){return H.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return H.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),H.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.oi&&(this.oi=t),H.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new mu(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,H.resolve()}updateTargetData(e,t){return this.Pr(t),H.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,H.resolve()}removeTargets(e,t,i){let r=0;const s=[];return this.si.forEach(((o,a)=>{a.sequenceNumber<=t&&i.get(a.targetId)===null&&(this.si.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)})),H.waitFor(s).next((()=>r))}getTargetCount(e){return H.resolve(this.targetCount)}getTargetData(e,t){const i=this.si.get(t)||null;return H.resolve(i)}addMatchingKeys(e,t,i){return this._i.Wr(t,i),H.resolve()}removeMatchingKeys(e,t,i){this._i.zr(t,i);const r=this.persistence.referenceDelegate,s=[];return r&&t.forEach((o=>{s.push(r.markPotentiallyOrphaned(e,o))})),H.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),H.resolve()}getMatchingKeysForTargetId(e,t){const i=this._i.Hr(t);return H.resolve(i)}containsKey(e,t){return H.resolve(this._i.containsKey(t))}}class Yx{constructor(e,t){this.ui={},this.overlays={},this.ci=new xr(0),this.li=!1,this.li=!0,this.hi=new qj,this.referenceDelegate=e(this),this.Pi=new Qj(this),this.indexManager=new Oj,this.remoteDocumentCache=(function(r){return new Yj(r)})((i=>this.referenceDelegate.Ti(i))),this.serializer=new ak(t),this.Ii=new Kj(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Hj,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.ui[e.toKey()];return i||(i=new Xj(t,this.referenceDelegate),this.ui[e.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,i){ce("MemoryPersistence","Starting transaction:",e);const r=new Jj(this.ci.next());return this.referenceDelegate.Ei(),i(r).next((s=>this.referenceDelegate.di(r).next((()=>s)))).toPromise().then((s=>(r.raiseOnCommittedEvent(),s)))}Ai(e,t){return H.or(Object.values(this.ui).map((i=>()=>i.containsKey(e,t))))}}class Jj extends rL{constructor(e){super(),this.currentSequenceNumber=e}}class ey{constructor(e){this.persistence=e,this.Ri=new Xx,this.Vi=null}static mi(e){return new ey(e)}get fi(){if(this.Vi)return this.Vi;throw Ie(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.fi.delete(i.toString()),H.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.fi.add(i.toString()),H.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),H.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((r=>this.fi.add(r.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((r=>{r.forEach((s=>this.fi.add(s.toString())))})).next((()=>i.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return H.forEach(this.fi,(i=>{const r=pe.fromPath(i);return this.gi(e,r).next((s=>{s||t.removeEntry(r,Le.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((i=>{i?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return H.or([()=>H.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class j_{constructor(e,t){this.persistence=e,this.pi=new Po((i=>ti(i.path)),((i,r)=>i.isEqual(r))),this.garbageCollector=_k(this,t)}static mi(e,t){return new j_(e,t)}Ei(){}di(e){return H.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((r=>i+r))))}wr(e){let t=0;return this.pr(e,(i=>{t++})).next((()=>t))}pr(e,t){return H.forEach(this.pi,((i,r)=>this.br(e,i,r).next((s=>s?H.resolve():t(r)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const r=this.persistence.getRemoteDocumentCache(),s=r.newChangeBuffer();return r.ii(e,(o=>this.br(e,o,t).next((a=>{a||(i++,s.removeEntry(o,Le.min()))})))).next((()=>s.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),H.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.pi.set(i,e.currentSequenceNumber),H.resolve()}removeReference(e,t,i){return this.pi.set(i,e.currentSequenceNumber),H.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),H.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Up(e.data.value)),t}br(e,t,i){return H.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const r=this.pi.get(t);return H.resolve(r!==void 0&&r>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class eU{constructor(e){this.serializer=e}k(e,t,i,r){const s=new j0("createOrUpgrade",t);i<1&&r>=1&&((function(u){u.createObjectStore(Pg)})(e),(function(u){u.createObjectStore(Hf,{keyPath:cG}),u.createObjectStore(jr,{keyPath:SR,autoIncrement:!0}).createIndex(Wl,TR,{unique:!0}),u.createObjectStore(gh)})(e),fP(e),(function(u){u.createObjectStore(bl)})(e));let o=H.resolve();return i<3&&r>=3&&(i!==0&&((function(u){u.deleteObjectStore(ph),u.deleteObjectStore(mh),u.deleteObjectStore(Xl)})(e),fP(e)),o=o.next((()=>(function(u){const h=u.store(Xl),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Le.min().toTimestamp(),targetCount:0};return h.put(M_,d)})(s)))),i<4&&r>=4&&(i!==0&&(o=o.next((()=>(function(u,h){return h.store(jr).J().next((g=>{u.deleteObjectStore(jr),u.createObjectStore(jr,{keyPath:SR,autoIncrement:!0}).createIndex(Wl,TR,{unique:!0});const m=h.store(jr),v=g.map((y=>m.put(y)));return H.waitFor(v)}))})(e,s)))),o=o.next((()=>{(function(u){u.createObjectStore(_h,{keyPath:vG})})(e)}))),i<5&&r>=5&&(o=o.next((()=>this.yi(s)))),i<6&&r>=6&&(o=o.next((()=>((function(u){u.createObjectStore(qf)})(e),this.wi(s))))),i<7&&r>=7&&(o=o.next((()=>this.Si(s)))),i<8&&r>=8&&(o=o.next((()=>this.bi(e,s)))),i<9&&r>=9&&(o=o.next((()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)}))),i<10&&r>=10&&(o=o.next((()=>this.Di(s)))),i<11&&r>=11&&(o=o.next((()=>{(function(u){u.createObjectStore(B0,{keyPath:EG})})(e),(function(u){u.createObjectStore(z0,{keyPath:wG})})(e)}))),i<12&&r>=12&&(o=o.next((()=>{(function(u){const h=u.createObjectStore($0,{keyPath:PG});h.createIndex(GE,CG,{unique:!1}),h.createIndex(hL,MG,{unique:!1})})(e)}))),i<13&&r>=13&&(o=o.next((()=>(function(u){const h=u.createObjectStore(C_,{keyPath:dG});h.createIndex(Gp,fG),h.createIndex(aL,gG)})(e))).next((()=>this.Ci(e,s))).next((()=>e.deleteObjectStore(bl)))),i<14&&r>=14&&(o=o.next((()=>this.Fi(e,s)))),i<15&&r>=15&&(o=o.next((()=>(function(u){u.createObjectStore(kx,{keyPath:xG,autoIncrement:!0}).createIndex(FE,SG,{unique:!1}),u.createObjectStore(ff,{keyPath:TG}).createIndex(uL,IG,{unique:!1}),u.createObjectStore(gf,{keyPath:AG}).createIndex(cL,RG,{unique:!1})})(e)))),i<16&&r>=16&&(o=o.next((()=>{t.objectStore(ff).clear()})).next((()=>{t.objectStore(gf).clear()}))),i<17&&r>=17&&(o=o.next((()=>{(function(u){u.createObjectStore(Dx,{keyPath:bG})})(e)}))),i<18&&r>=18&&F4()&&(o=o.next((()=>{t.objectStore(ff).clear()})).next((()=>{t.objectStore(gf).clear()}))),o}wi(e){let t=0;return e.store(bl).ee(((i,r)=>{t+=G_(r)})).next((()=>{const i={byteSize:t};return e.store(qf).put(VE,i)}))}yi(e){const t=e.store(Hf),i=e.store(jr);return t.J().next((r=>H.forEach(r,(s=>{const o=IDBKeyRange.bound([s.userId,ql],[s.userId,s.lastAcknowledgedBatchId]);return i.J(Wl,o).next((a=>H.forEach(a,(u=>{be(u.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:u.batchId});const h=Vl(this.serializer,u);return fk(e,s.userId,h).next((()=>{}))}))))}))))}Si(e){const t=e.store(ph),i=e.store(bl);return e.store(Xl).get(M_).next((r=>{const s=[];return i.ee(((o,a)=>{const u=new ft(o),h=(function(g){return[0,ti(g)]})(u);s.push(t.get(h).next((d=>d?H.resolve():(g=>t.put({targetId:0,path:ti(g),sequenceNumber:r.highestListenSequenceNumber}))(u))))})).next((()=>H.waitFor(s)))}))}bi(e,t){e.createObjectStore(Xf,{keyPath:yG});const i=t.store(Xf),r=new qx,s=o=>{if(r.add(o)){const a=o.lastSegment(),u=o.popLast();return i.put({collectionId:a,parent:ti(u)})}};return t.store(bl).ee({X:!0},((o,a)=>{const u=new ft(o);return s(u.popLast())})).next((()=>t.store(gh).ee({X:!0},(([o,a,u],h)=>{const d=Is(a);return s(d.popLast())}))))}Di(e){const t=e.store(mh);return t.ee(((i,r)=>{const s=Qd(r),o=lk(this.serializer,s);return t.put(o)}))}Ci(e,t){const i=t.store(bl),r=[];return i.ee(((s,o)=>{const a=t.store(C_),u=(function(g){return g.document?new pe(ft.fromString(g.document.name).popFirst(5)):g.noDocument?pe.fromSegments(g.noDocument.path):g.unknownDocument?pe.fromSegments(g.unknownDocument.path):Ie(36783)})(o).path.toArray(),h={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};r.push(a.put(h))})).next((()=>H.waitFor(r)))}Fi(e,t){const i=t.store(jr),r=vk(this.serializer),s=new Yx(ey.mi,this.serializer.yt);return i.J().next((o=>{const a=new Map;return o.forEach((u=>{let h=a.get(u.userId)??Ze();Vl(this.serializer,u).keys().forEach((d=>h=h.add(d))),a.set(u.userId,h)})),H.forEach(a,((u,h)=>{const d=new Fn(h),g=Q0.wt(this.serializer,d),m=s.getIndexManager(d),v=J0.wt(d,this.serializer,m,s.referenceDelegate);return new Ek(r,v,g,m).recalculateAndSaveOverlaysForDocumentKeys(new jE(t,xr.ce),u).next()}))}))}}function fP(n){n.createObjectStore(ph,{keyPath:pG}).createIndex(Lx,_G,{unique:!0}),n.createObjectStore(mh,{keyPath:"targetId"}).createIndex(lL,mG,{unique:!0}),n.createObjectStore(Xl)}const la="IndexedDbPersistence",R1=18e5,P1=5e3,C1="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",tU="main";class Zx{constructor(e,t,i,r,s,o,a,u,h,d,g=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=i,this.Mi=s,this.window=o,this.document=a,this.xi=h,this.Oi=d,this.Ni=g,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=m=>Promise.resolve(),!Zx.v())throw new me(ee.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Bj(this,r),this.$i=t+tU,this.serializer=new ak(u),this.Ui=new ba(this.$i,this.Ni,new eU(this.serializer)),this.hi=new Mj,this.Pi=new Fj(this.referenceDelegate,this.serializer),this.remoteDocumentCache=vk(this.serializer),this.Ii=new Cj,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,d===!1&&ui(la,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new me(ee.FAILED_PRECONDITION,C1);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new xr(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>xp(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(Ha(e))return ce(la,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return ce(la,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return Fd(e).get(yc).next((t=>H.resolve(this.es(t))))}ts(e){return xp(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,R1)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const i=_n(t,_h);return i.J().next((r=>{const s=this.ss(r,R1),o=r.filter((a=>s.indexOf(a)===-1));return H.forEach(o,(a=>i.delete(a.clientId))).next((()=>o))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?H.resolve(!0):Fd(e).get(yc).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,P1)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new me(ee.FAILED_PRECONDITION,C1);return!1}}return!(!this.networkEnabled||!this.inForeground)||xp(e).J().next((i=>this.ss(i,P1).find((r=>{if(this.clientId!==r.clientId){const s=!this.networkEnabled&&r.networkEnabled,o=!this.inForeground&&r.inForeground,a=this.networkEnabled===r.networkEnabled;if(s||o&&a)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&ce(la,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[Pg,_h],(e=>{const t=new jE(e,xr.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((i=>this.rs(i.updateTimeMs,t)&&!this.us(i.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>xp(e).J().next((t=>this.ss(t,R1).map((i=>i.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return J0.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Vj(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return Q0.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,i){ce(la,"Starting transaction:",e);const r=t==="readonly"?"readonly":"readwrite",s=(function(u){return u===18?DG:u===17?mL:u===16?kG:u===15?Nx:u===14?gL:u===13?fL:u===12?LG:u===11?dL:void Ie(60245)})(this.Ni);let o;return this.Ui.runTransaction(e,r,s,(a=>(o=new jE(a,this.ci?this.ci.next():xr.ce),t==="readwrite-primary"?this.Hi(o).next((u=>!!u||this.Yi(o))).next((u=>{if(!u)throw ui(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new me(ee.FAILED_PRECONDITION,iL);return i(o)})).next((u=>this.Xi(o).next((()=>u)))):this.Is(o).next((()=>i(o)))))).then((a=>(o.raiseOnCommittedEvent(),a)))}Is(e){return Fd(e).get(yc).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,P1)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new me(ee.FAILED_PRECONDITION,C1)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Fd(e).put(yc,t)}static v(){return ba.v()}Zi(e){const t=Fd(e);return t.get(yc).next((i=>this.es(i)?(ce(la,"Releasing primary lease."),t.delete(yc)):H.resolve()))}rs(e,t){const i=Date.now();return!(e<i-t)&&(!(e>i)||(ui(`Detected an update time that is in the future: ${e} > ${i}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;V4()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const t=this.Ki?.getItem(this._s(e))!==null;return ce(la,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return ui(la,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){ui("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Fd(n){return _n(n,Pg)}function xp(n){return _n(n,_h)}function nU(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class Qx{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.Es=i,this.ds=r}static As(e,t){let i=Ze(),r=Ze();for(const s of t.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new Qx(e,t.fromCache,i,r)}}class iU{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class wk{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return V4()?8:sL(pn())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,r){const s={result:null};return this.ys(e,t).next((o=>{s.result=o})).next((()=>{if(!s.result)return this.ws(e,t,r,i).next((o=>{s.result=o}))})).next((()=>{if(s.result)return;const o=new iU;return this.Ss(e,t,o).next((a=>{if(s.result=a,this.Vs)return this.bs(e,t,o,a.size)}))})).next((()=>s.result))}bs(e,t,i,r){return i.documentReadCount<this.fs?(Pc()<=Je.DEBUG&&ce("QueryEngine","SDK will not create cache indexes for query:",Cc(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),H.resolve()):(Pc()<=Je.DEBUG&&ce("QueryEngine","Query:",Cc(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.gs*r?(Pc()<=Je.DEBUG&&ce("QueryEngine","The SDK decides to create cache indexes for query:",Cc(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Tr(t))):H.resolve())}ys(e,t){if(VR(t))return H.resolve(null);let i=Tr(t);return this.indexManager.getIndexType(e,i).next((r=>r===0?null:(t.limit!==null&&r===1&&(t=HE(t,null,"F"),i=Tr(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((s=>{const o=Ze(...s);return this.ps.getDocuments(e,o).next((a=>this.indexManager.getMinOffset(e,i).next((u=>{const h=this.Ds(t,a);return this.Cs(t,h,o,u.readTime)?this.ys(e,HE(t,null,"F")):this.vs(e,h,t,u)}))))})))))}ws(e,t,i,r){return VR(t)||r.isEqual(Le.min())?H.resolve(null):this.ps.getDocuments(e,i).next((s=>{const o=this.Ds(t,s);return this.Cs(t,o,i,r)?H.resolve(null):(Pc()<=Je.DEBUG&&ce("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Cc(t)),this.vs(e,o,t,iG(r,$f)).next((a=>a)))}))}Ds(e,t){let i=new Tt(NL(e));return t.forEach(((r,s)=>{bg(e,s)&&(i=i.add(s))})),i}Cs(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Ss(e,t,i){return Pc()<=Je.DEBUG&&ce("QueryEngine","Using full collection scan to execute query:",Cc(t)),this.ps.getDocumentsMatchingQuery(e,t,Zi.min(),i)}vs(e,t,i,r){return this.ps.getDocumentsMatchingQuery(e,i,r).next((s=>(t.forEach((o=>{s=s.insert(o.key,o)})),s)))}}const Jx="LocalStore",rU=3e8;class sU{constructor(e,t,i,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new Ft($e),this.xs=new Po((s=>du(s)),Cg),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(i)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Ek(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function xk(n,e,t,i){return new sU(n,e,t,i)}async function Sk(n,e){const t=We(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next((s=>(r=s,t.Bs(e),t.mutationQueue.getAllMutationBatches(i)))).next((s=>{const o=[],a=[];let u=Ze();for(const h of r){o.push(h.batchId);for(const d of h.mutations)u=u.add(d.key)}for(const h of s){a.push(h.batchId);for(const d of h.mutations)u=u.add(d.key)}return t.localDocuments.getDocuments(i,u).next((h=>({Ls:h,removedBatchIds:o,addedBatchIds:a})))}))}))}function oU(n,e){const t=We(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const r=e.batch.keys(),s=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(a,u,h,d){const g=h.batch,m=g.keys();let v=H.resolve();return m.forEach((y=>{v=v.next((()=>d.getEntry(u,y))).next((T=>{const w=h.docVersions.get(y);be(w!==null,48541),T.version.compareTo(w)<0&&(g.applyToRemoteDocument(T,h),T.isValidDocument()&&(T.setReadTime(h.commitVersion),d.addEntry(T)))}))})),v.next((()=>a.mutationQueue.removeMutationBatch(u,g)))})(t,i,e,s).next((()=>s.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(a){let u=Ze();for(let h=0;h<a.mutationResults.length;++h)a.mutationResults[h].transformResults.length>0&&(u=u.add(a.batch.mutations[h].key));return u})(e)))).next((()=>t.localDocuments.getDocuments(i,r)))}))}function Tk(n){const e=We(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function aU(n,e){const t=We(n),i=e.snapshotVersion;let r=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(s=>{const o=t.Ns.newChangeBuffer({trackRemovals:!0});r=t.Ms;const a=[];e.targetChanges.forEach(((d,g)=>{const m=r.get(g);if(!m)return;a.push(t.Pi.removeMatchingKeys(s,d.removedDocuments,g).next((()=>t.Pi.addMatchingKeys(s,d.addedDocuments,g))));let v=m.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(g)!==null?v=v.withResumeToken(un.EMPTY_BYTE_STRING,Le.min()).withLastLimboFreeSnapshotVersion(Le.min()):d.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(d.resumeToken,i)),r=r.insert(g,v),(function(T,w,A){return T.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-T.snapshotVersion.toMicroseconds()>=rU?!0:A.addedDocuments.size+A.modifiedDocuments.size+A.removedDocuments.size>0})(m,v,d)&&a.push(t.Pi.updateTargetData(s,v))}));let u=Ki(),h=Ze();if(e.documentUpdates.forEach((d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,d))})),a.push(lU(s,o,e.documentUpdates).next((d=>{u=d.ks,h=d.qs}))),!i.isEqual(Le.min())){const d=t.Pi.getLastRemoteSnapshotVersion(s).next((g=>t.Pi.setTargetsMetadata(s,s.currentSequenceNumber,i)));a.push(d)}return H.waitFor(a).next((()=>o.apply(s))).next((()=>t.localDocuments.getLocalViewOfDocuments(s,u,h))).next((()=>u))})).then((s=>(t.Ms=r,s)))}function lU(n,e,t){let i=Ze(),r=Ze();return t.forEach((s=>i=i.add(s))),e.getEntries(n,i).next((s=>{let o=Ki();return t.forEach(((a,u)=>{const h=s.get(a);u.isFoundDocument()!==h.isFoundDocument()&&(r=r.add(a)),u.isNoDocument()&&u.version.isEqual(Le.min())?(e.removeEntry(a,u.readTime),o=o.insert(a,u)):!h.isValidDocument()||u.version.compareTo(h.version)>0||u.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(u),o=o.insert(a,u)):ce(Jx,"Ignoring outdated watch update for ",a,". Current version:",h.version," Watch version:",u.version)})),{ks:o,qs:r}}))}function uU(n,e){const t=We(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=ql),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function cU(n,e){const t=We(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let r;return t.Pi.getTargetData(i,e).next((s=>s?(r=s,H.resolve(r)):t.Pi.allocateTargetId(i).next((o=>(r=new uo(e,o,"TargetPurposeListen",i.currentSequenceNumber),t.Pi.addTargetData(i,r).next((()=>r)))))))})).then((i=>{const r=t.Ms.get(i.targetId);return(r===null||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(i.targetId,i),t.xs.set(e,i.targetId)),i}))}async function tw(n,e,t){const i=We(n),r=i.Ms.get(e),s=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",s,(o=>i.persistence.referenceDelegate.removeTarget(o,r)))}catch(o){if(!Ha(o))throw o;ce(Jx,`Failed to update sequence numbers for target ${e}: ${o}`)}i.Ms=i.Ms.remove(e),i.xs.delete(r.target)}function gP(n,e,t){const i=We(n);let r=Le.min(),s=Ze();return i.persistence.runTransaction("Execute query","readwrite",(o=>(function(u,h,d){const g=We(u),m=g.xs.get(d);return m!==void 0?H.resolve(g.Ms.get(m)):g.Pi.getTargetData(h,d)})(i,o,Tr(e)).next((a=>{if(a)return r=a.lastLimboFreeSnapshotVersion,i.Pi.getMatchingKeysForTargetId(o,a.targetId).next((u=>{s=u}))})).next((()=>i.Fs.getDocumentsMatchingQuery(o,e,t?r:Le.min(),t?s:Ze()))).next((a=>(hU(i,XG(e),a),{documents:a,Qs:s})))))}function hU(n,e,t){let i=n.Os.get(e)||Le.min();t.forEach(((r,s)=>{s.readTime.compareTo(i)>0&&(i=s.readTime)})),n.Os.set(e,i)}class mP{constructor(){this.activeTargetIds=tj()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Ik{constructor(){this.Mo=new mP,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,i){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new mP,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class dU{Oo(e){}shutdown(){}}const pP="ConnectivityMonitor";class _P{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ce(pP,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){ce(pP,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Sp=null;function nw(){return Sp===null?Sp=(function(){return 268435456+Math.round(2147483648*Math.random())})():Sp++,"0x"+Sp.toString(16)}const M1="RestConnection",fU={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class gU{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${i}/databases/${r}`,this.Wo=this.databaseId.database===b_?`project_id=${i}`:`project_id=${i}&database_id=${r}`}Go(e,t,i,r,s){const o=nw(),a=this.zo(e,t.toUriEncodedString());ce(M1,`Sending RPC '${e}' ${o}:`,a,i);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,r,s);const{host:h}=new URL(a),d=Su(h);return this.Jo(e,a,u,i,d).then((g=>(ce(M1,`Received RPC '${e}' ${o}: `,g),g)),(g=>{throw cu(M1,`RPC '${e}' ${o} failed with error: `,g,"url: ",a,"request:",i),g}))}Ho(e,t,i,r,s,o){return this.Go(e,t,i,r,s)}jo(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Lh})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((r,s)=>e[s]=r)),i&&i.headers.forEach(((r,s)=>e[s]=r))}zo(e,t){const i=fU[e];return`${this.Uo}/v1/${t}:${i}`}terminate(){}}class mU{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const Kn="WebChannelConnection";class pU extends gU{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,i,r,s){const o=nw();return new Promise(((a,u)=>{const h=new K4;h.setWithCredentials(!0),h.listenOnce(H4.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case Op.NO_ERROR:const g=h.getResponseJson();ce(Kn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(g)),a(g);break;case Op.TIMEOUT:ce(Kn,`RPC '${e}' ${o} timed out`),u(new me(ee.DEADLINE_EXCEEDED,"Request time out"));break;case Op.HTTP_ERROR:const m=h.getStatus();if(ce(Kn,`RPC '${e}' ${o} failed with status:`,m,"response text:",h.getResponseText()),m>0){let v=h.getResponseJson();Array.isArray(v)&&(v=v[0]);const y=v?.error;if(y&&y.status&&y.message){const T=(function(A){const P=A.toLowerCase().replace(/_/g,"-");return Object.values(ee).indexOf(P)>=0?P:ee.UNKNOWN})(y.status);u(new me(T,y.message))}else u(new me(ee.UNKNOWN,"Server responded with status "+h.getStatus()))}else u(new me(ee.UNAVAILABLE,"Connection failed."));break;default:Ie(9055,{l_:e,streamId:o,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{ce(Kn,`RPC '${e}' ${o} completed.`)}}));const d=JSON.stringify(r);ce(Kn,`RPC '${e}' ${o} sending request:`,r),h.send(t,"POST",d,i,15)}))}T_(e,t,i){const r=nw(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Y4(),a=X4(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,t,i),u.encodeInitMessageHeaders=!0;const d=s.join("");ce(Kn,`Creating RPC '${e}' stream ${r}: ${d}`,u);const g=o.createWebChannel(d,u);this.I_(g);let m=!1,v=!1;const y=new mU({Yo:w=>{v?ce(Kn,`Not sending because RPC '${e}' stream ${r} is closed:`,w):(m||(ce(Kn,`Opening RPC '${e}' stream ${r} transport.`),g.open(),m=!0),ce(Kn,`RPC '${e}' stream ${r} sending:`,w),g.send(w))},Zo:()=>g.close()}),T=(w,A,P)=>{w.listen(A,(M=>{try{P(M)}catch(k){setTimeout((()=>{throw k}),0)}}))};return T(g,Xd.EventType.OPEN,(()=>{v||(ce(Kn,`RPC '${e}' stream ${r} transport opened.`),y.o_())})),T(g,Xd.EventType.CLOSE,(()=>{v||(v=!0,ce(Kn,`RPC '${e}' stream ${r} transport closed`),y.a_(),this.E_(g))})),T(g,Xd.EventType.ERROR,(w=>{v||(v=!0,cu(Kn,`RPC '${e}' stream ${r} transport errored. Name:`,w.name,"Message:",w.message),y.a_(new me(ee.UNAVAILABLE,"The operation could not be completed")))})),T(g,Xd.EventType.MESSAGE,(w=>{if(!v){const A=w.data[0];be(!!A,16349);const P=A,M=P?.error||P[0]?.error;if(M){ce(Kn,`RPC '${e}' stream ${r} received error:`,M);const k=M.status;let N=(function(R){const L=an[R];if(L!==void 0)return HL(L)})(k),B=M.message;N===void 0&&(N=ee.INTERNAL,B="Unknown error status: "+k+" with message "+M.message),v=!0,y.a_(new me(N,B)),g.close()}else ce(Kn,`RPC '${e}' stream ${r} received:`,A),y.u_(A)}})),T(a,q4.STAT_EVENT,(w=>{w.stat===DE.PROXY?ce(Kn,`RPC '${e}' stream ${r} detected buffering proxy`):w.stat===DE.NOPROXY&&ce(Kn,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{y.__()}),0),y}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function _U(){return typeof window<"u"?window:null}function Kp(){return typeof document<"u"?document:null}function ty(n){return new yj(n,!0)}class Ak{constructor(e,t,i=1e3,r=1.5,s=6e4){this.Mi=e,this.timerId=t,this.d_=i,this.A_=r,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-i);r>0&&ce("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const yP="PersistentStream";class Rk{constructor(e,t,i,r,s,o,a,u){this.Mi=e,this.S_=i,this.b_=r,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Ak(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ee.RESOURCE_EXHAUSTED?(ui(t.toString()),ui("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ee.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,r])=>{this.D_===t&&this.G_(i,r)}),(i=>{e((()=>{const r=new me(ee.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(r)}))}))}G_(e,t){const i=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{i((()=>this.listener.Xo()))})),this.stream.t_((()=>{i((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((r=>{i((()=>this.z_(r)))})),this.stream.onMessage((r=>{i((()=>++this.F_==1?this.J_(r):this.onNext(r)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return ce(yP,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(ce(yP,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class yU extends Rk{constructor(e,t,i,r,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=wj(this.serializer,e),i=(function(s){if(!("targetChange"in s))return Le.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?Le.min():o.readTime?di(o.readTime):Le.min()})(e);return this.listener.H_(t,i)}Y_(e){const t={};t.database=YE(this.serializer),t.addTarget=(function(s,o){let a;const u=o.target;if(a=k_(u)?{documents:tk(s,u)}:{query:nk(s,u).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=YL(s,o.resumeToken);const h=qE(s,o.expectedCount);h!==null&&(a.expectedCount=h)}else if(o.snapshotVersion.compareTo(Le.min())>0){a.readTime=Th(s,o.snapshotVersion.toTimestamp());const h=qE(s,o.expectedCount);h!==null&&(a.expectedCount=h)}return a})(this.serializer,e);const i=Sj(this.serializer,e);i&&(t.labels=i),this.q_(t)}Z_(e){const t={};t.database=YE(this.serializer),t.removeTarget=e,this.q_(t)}}class vU extends Rk{constructor(e,t,i,r,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return be(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,be(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){be(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=xj(e.writeResults,e.commitTime),i=di(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=YE(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>O_(this.serializer,i)))};this.q_(t)}}class EU{}class wU extends EU{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new me(ee.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,i,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,o])=>this.connection.Go(e,XE(t,i),r,s,o))).catch((s=>{throw s.name==="FirebaseError"?(s.code===ee.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new me(ee.UNKNOWN,s.toString())}))}Ho(e,t,i,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,a])=>this.connection.Ho(e,XE(t,i),r,o,a,s))).catch((o=>{throw o.name==="FirebaseError"?(o.code===ee.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new me(ee.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class xU{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ui(t),this.aa=!1):ce("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const pu="RemoteStore";class SU{constructor(e,t,i,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo((o=>{i.enqueueAndForget((async()=>{Au(this)&&(ce(pu,"Restarting streams for network reachability change."),await(async function(u){const h=We(u);h.Ea.add(4),await kg(h),h.Ra.set("Unknown"),h.Ea.delete(4),await ny(h)})(this))}))})),this.Ra=new xU(i,r)}}async function ny(n){if(Au(n))for(const e of n.da)await e(!0)}async function kg(n){for(const e of n.da)await e(!1)}function Pk(n,e){const t=We(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),iS(t)?nS(t):Dh(t).O_()&&tS(t,e))}function eS(n,e){const t=We(n),i=Dh(t);t.Ia.delete(e),i.O_()&&Ck(t,e),t.Ia.size===0&&(i.O_()?i.L_():Au(t)&&t.Ra.set("Unknown"))}function tS(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Le.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Dh(n).Y_(e)}function Ck(n,e){n.Va.Ue(e),Dh(n).Z_(e)}function nS(n){n.Va=new gj({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Dh(n).start(),n.Ra.ua()}function iS(n){return Au(n)&&!Dh(n).x_()&&n.Ia.size>0}function Au(n){return We(n).Ea.size===0}function Mk(n){n.Va=void 0}async function TU(n){n.Ra.set("Online")}async function IU(n){n.Ia.forEach(((e,t)=>{tS(n,e)}))}async function AU(n,e){Mk(n),iS(n)?(n.Ra.ha(e),nS(n)):n.Ra.set("Unknown")}async function RU(n,e,t){if(n.Ra.set("Online"),e instanceof XL&&e.state===2&&e.cause)try{await(async function(r,s){const o=s.cause;for(const a of s.targetIds)r.Ia.has(a)&&(await r.remoteSyncer.rejectListen(a,o),r.Ia.delete(a),r.Va.removeTarget(a))})(n,e)}catch(i){ce(pu,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await U_(n,i)}else if(e instanceof $p?n.Va.Ze(e):e instanceof qL?n.Va.st(e):n.Va.tt(e),!t.isEqual(Le.min()))try{const i=await Tk(n.localStore);t.compareTo(i)>=0&&await(function(s,o){const a=s.Va.Tt(o);return a.targetChanges.forEach(((u,h)=>{if(u.resumeToken.approximateByteSize()>0){const d=s.Ia.get(h);d&&s.Ia.set(h,d.withResumeToken(u.resumeToken,o))}})),a.targetMismatches.forEach(((u,h)=>{const d=s.Ia.get(u);if(!d)return;s.Ia.set(u,d.withResumeToken(un.EMPTY_BYTE_STRING,d.snapshotVersion)),Ck(s,u);const g=new uo(d.target,u,h,d.sequenceNumber);tS(s,g)})),s.remoteSyncer.applyRemoteEvent(a)})(n,t)}catch(i){ce(pu,"Failed to raise snapshot:",i),await U_(n,i)}}async function U_(n,e,t){if(!Ha(e))throw e;n.Ea.add(1),await kg(n),n.Ra.set("Offline"),t||(t=()=>Tk(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{ce(pu,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await ny(n)}))}function bk(n,e){return e().catch((t=>U_(n,t,e)))}async function Dg(n){const e=We(n),t=Ga(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:ql;for(;PU(e);)try{const r=await uU(e.localStore,i);if(r===null){e.Ta.length===0&&t.L_();break}i=r.batchId,CU(e,r)}catch(r){await U_(e,r)}Lk(e)&&kk(e)}function PU(n){return Au(n)&&n.Ta.length<10}function CU(n,e){n.Ta.push(e);const t=Ga(n);t.O_()&&t.X_&&t.ea(e.mutations)}function Lk(n){return Au(n)&&!Ga(n).x_()&&n.Ta.length>0}function kk(n){Ga(n).start()}async function MU(n){Ga(n).ra()}async function bU(n){const e=Ga(n);for(const t of n.Ta)e.ea(t.mutations)}async function LU(n,e,t){const i=n.Ta.shift(),r=zx.from(i,e,t);await bk(n,(()=>n.remoteSyncer.applySuccessfulWrite(r))),await Dg(n)}async function kU(n,e){e&&Ga(n).X_&&await(async function(i,r){if((function(o){return hj(o)&&o!==ee.ABORTED})(r.code)){const s=i.Ta.shift();Ga(i).B_(),await bk(i,(()=>i.remoteSyncer.rejectFailedWrite(s.batchId,r))),await Dg(i)}})(n,e),Lk(n)&&kk(n)}async function vP(n,e){const t=We(n);t.asyncQueue.verifyOperationInProgress(),ce(pu,"RemoteStore received new credentials");const i=Au(t);t.Ea.add(3),await kg(t),i&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await ny(t)}async function DU(n,e){const t=We(n);e?(t.Ea.delete(2),await ny(t)):e||(t.Ea.add(2),await kg(t),t.Ra.set("Unknown"))}function Dh(n){return n.ma||(n.ma=(function(t,i,r){const s=We(t);return s.sa(),new yU(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)})(n.datastore,n.asyncQueue,{Xo:TU.bind(null,n),t_:IU.bind(null,n),r_:AU.bind(null,n),H_:RU.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),iS(n)?nS(n):n.Ra.set("Unknown")):(await n.ma.stop(),Mk(n))}))),n.ma}function Ga(n){return n.fa||(n.fa=(function(t,i,r){const s=We(t);return s.sa(),new vU(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:MU.bind(null,n),r_:kU.bind(null,n),ta:bU.bind(null,n),na:LU.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await Dg(n)):(await n.fa.stop(),n.Ta.length>0&&(ce(pu,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class rS{constructor(e,t,i,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new po,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,s){const o=Date.now()+i,a=new rS(e,t,o,r,s);return a.start(i),a}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new me(ee.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function sS(n,e){if(ui("AsyncQueue",`${e}: ${n}`),Ha(n))return new me(ee.UNAVAILABLE,`${e}: ${n}`);throw n}class Zc{static emptySet(e){return new Zc(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||pe.comparator(t.key,i.key):(t,i)=>pe.comparator(t.key,i.key),this.keyedMap=Yd(),this.sortedSet=new Ft(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Zc)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=i.getNext().key;if(!r.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new Zc;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}class EP{constructor(){this.ga=new Ft(pe.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Ie(63341,{Rt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class Ih{constructor(e,t,i,r,s,o,a,u,h){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=u,this.hasCachedResults=h}static fromInitialDocuments(e,t,i,r,s){const o=[];return t.forEach((a=>{o.push({type:0,doc:a})})),new Ih(e,t,Zc.emptySet(t),o,i,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&H0(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==i[r].type||!t[r].doc.isEqual(i[r].doc))return!1;return!0}}class NU{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class OU{constructor(){this.queries=wP(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const r=We(t),s=r.queries;r.queries=wP(),s.forEach(((o,a)=>{for(const u of a.Sa)u.onError(i)}))})(this,new me(ee.ABORTED,"Firestore shutting down"))}}function wP(){return new Po((n=>DL(n)),H0)}async function VU(n,e){const t=We(n);let i=3;const r=e.query;let s=t.queries.get(r);s?!s.ba()&&e.Da()&&(i=2):(s=new NU,i=e.Da()?0:1);try{switch(i){case 0:s.wa=await t.onListen(r,!0);break;case 1:s.wa=await t.onListen(r,!1);break;case 2:await t.onFirstRemoteStoreListen(r)}}catch(o){const a=sS(o,`Initialization of query '${Cc(e.query)}' failed`);return void e.onError(a)}t.queries.set(r,s),s.Sa.push(e),e.va(t.onlineState),s.wa&&e.Fa(s.wa)&&oS(t)}async function FU(n,e){const t=We(n),i=e.query;let r=3;const s=t.queries.get(i);if(s){const o=s.Sa.indexOf(e);o>=0&&(s.Sa.splice(o,1),s.Sa.length===0?r=e.Da()?0:1:!s.ba()&&e.Da()&&(r=2))}switch(r){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function GU(n,e){const t=We(n);let i=!1;for(const r of e){const s=r.query,o=t.queries.get(s);if(o){for(const a of o.Sa)a.Fa(r)&&(i=!0);o.wa=r}}i&&oS(t)}function jU(n,e,t){const i=We(n),r=i.queries.get(e);if(r)for(const s of r.Sa)s.onError(t);i.queries.delete(e)}function oS(n){n.Ca.forEach((e=>{e.next()}))}var iw,xP;(xP=iw||(iw={})).Ma="default",xP.Cache="cache";class UU{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const r of e.docChanges)r.type!==3&&i.push(r);e=new Ih(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.qa||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Ih.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==iw.Cache}}class Dk{constructor(e){this.key=e}}class Nk{constructor(e){this.key=e}}class BU{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Ze(),this.mutatedKeys=Ze(),this.eu=NL(e),this.tu=new Zc(this.eu)}get nu(){return this.Ya}ru(e,t){const i=t?t.iu:new EP,r=t?t.tu:this.tu;let s=t?t.mutatedKeys:this.mutatedKeys,o=r,a=!1;const u=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,h=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((d,g)=>{const m=r.get(d),v=bg(this.query,g)?g:null,y=!!m&&this.mutatedKeys.has(m.key),T=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations);let w=!1;m&&v?m.data.isEqual(v.data)?y!==T&&(i.track({type:3,doc:v}),w=!0):this.su(m,v)||(i.track({type:2,doc:v}),w=!0,(u&&this.eu(v,u)>0||h&&this.eu(v,h)<0)&&(a=!0)):!m&&v?(i.track({type:0,doc:v}),w=!0):m&&!v&&(i.track({type:1,doc:m}),w=!0,(u||h)&&(a=!0)),w&&(v?(o=o.add(v),s=T?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))})),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),i.track({type:1,doc:d})}return{tu:o,iu:i,Cs:a,mutatedKeys:s}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,r){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort(((d,g)=>(function(v,y){const T=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ie(20277,{Rt:w})}};return T(v)-T(y)})(d.type,g.type)||this.eu(d.doc,g.doc))),this.ou(i),r=r??!1;const a=t&&!r?this._u():[],u=this.Xa.size===0&&this.current&&!r?1:0,h=u!==this.Za;return this.Za=u,o.length!==0||h?{snapshot:new Ih(this.query,e.tu,s,o,e.mutatedKeys,u===0,h,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new EP,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Ze(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Xa=this.Xa.add(i.key))}));const t=[];return e.forEach((i=>{this.Xa.has(i)||t.push(new Nk(i))})),this.Xa.forEach((i=>{e.has(i)||t.push(new Dk(i))})),t}cu(e){this.Ya=e.Qs,this.Xa=Ze();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Ih.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const aS="SyncEngine";class zU{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class $U{constructor(e){this.key=e,this.hu=!1}}class WU{constructor(e,t,i,r,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Po((a=>DL(a)),H0),this.Iu=new Map,this.Eu=new Set,this.du=new Ft(pe.comparator),this.Au=new Map,this.Ru=new Xx,this.Vu={},this.mu=new Map,this.fu=mu.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function KU(n,e,t=!0){const i=Uk(n);let r;const s=i.Tu.get(e);return s?(i.sharedClientState.addLocalQueryTarget(s.targetId),r=s.view.lu()):r=await Ok(i,e,t,!0),r}async function HU(n,e){const t=Uk(n);await Ok(t,e,!0,!1)}async function Ok(n,e,t,i){const r=await cU(n.localStore,Tr(e)),s=r.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t);let a;return i&&(a=await qU(n,e,s,o==="current",r.resumeToken)),n.isPrimaryClient&&t&&Pk(n.remoteStore,r),a}async function qU(n,e,t,i,r){n.pu=(g,m,v)=>(async function(T,w,A,P){let M=w.view.ru(A);M.Cs&&(M=await gP(T.localStore,w.query,!1).then((({documents:b})=>w.view.ru(b,M))));const k=P&&P.targetChanges.get(w.targetId),N=P&&P.targetMismatches.get(w.targetId)!=null,B=w.view.applyChanges(M,T.isPrimaryClient,k,N);return TP(T,w.targetId,B.au),B.snapshot})(n,g,m,v);const s=await gP(n.localStore,e,!0),o=new BU(e,s.Qs),a=o.ru(s.documents),u=Lg.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",r),h=o.applyChanges(a,n.isPrimaryClient,u);TP(n,t,h.au);const d=new zU(e,t,o);return n.Tu.set(e,d),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),h.snapshot}async function XU(n,e,t){const i=We(n),r=i.Tu.get(e),s=i.Iu.get(r.targetId);if(s.length>1)return i.Iu.set(r.targetId,s.filter((o=>!H0(o,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||await tw(i.localStore,r.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(r.targetId),t&&eS(i.remoteStore,r.targetId),rw(i,r.targetId)})).catch(Iu)):(rw(i,r.targetId),await tw(i.localStore,r.targetId,!0))}async function YU(n,e){const t=We(n),i=t.Tu.get(e),r=t.Iu.get(i.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),eS(t.remoteStore,i.targetId))}async function ZU(n,e,t){const i=Bk(n);try{const r=await(function(o,a){const u=We(o),h=xt.now(),d=a.reduce(((v,y)=>v.add(y.key)),Ze());let g,m;return u.persistence.runTransaction("Locally write mutations","readwrite",(v=>{let y=Ki(),T=Ze();return u.Ns.getEntries(v,d).next((w=>{y=w,y.forEach(((A,P)=>{P.isValidDocument()||(T=T.add(A))}))})).next((()=>u.localDocuments.getOverlayedDocuments(v,y))).next((w=>{g=w;const A=[];for(const P of a){const M=uj(P,g.get(P.key).overlayedDocument);M!=null&&A.push(new Co(P.key,M,IL(M.value.mapValue),ci.exists(!0)))}return u.mutationQueue.addMutationBatch(v,h,A,a)})).next((w=>{m=w;const A=w.applyToLocalDocumentSet(g,T);return u.documentOverlayCache.saveOverlays(v,w.batchId,A)}))})).then((()=>({batchId:m.batchId,changes:VL(g)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(r.batchId),(function(o,a,u){let h=o.Vu[o.currentUser.toKey()];h||(h=new Ft($e)),h=h.insert(a,u),o.Vu[o.currentUser.toKey()]=h})(i,r.batchId,t),await Ng(i,r.changes),await Dg(i.remoteStore)}catch(r){const s=sS(r,"Failed to persist write");t.reject(s)}}async function Vk(n,e){const t=We(n);try{const i=await aU(t.localStore,e);e.targetChanges.forEach(((r,s)=>{const o=t.Au.get(s);o&&(be(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?o.hu=!0:r.modifiedDocuments.size>0?be(o.hu,14607):r.removedDocuments.size>0&&(be(o.hu,42227),o.hu=!1))})),await Ng(t,i,e)}catch(i){await Iu(i)}}function SP(n,e,t){const i=We(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const r=[];i.Tu.forEach(((s,o)=>{const a=o.view.va(e);a.snapshot&&r.push(a.snapshot)})),(function(o,a){const u=We(o);u.onlineState=a;let h=!1;u.queries.forEach(((d,g)=>{for(const m of g.Sa)m.va(a)&&(h=!0)})),h&&oS(u)})(i.eventManager,e),r.length&&i.Pu.H_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function QU(n,e,t){const i=We(n);i.sharedClientState.updateQueryState(e,"rejected",t);const r=i.Au.get(e),s=r&&r.key;if(s){let o=new Ft(pe.comparator);o=o.insert(s,Xt.newNoDocument(s,Le.min()));const a=Ze().add(s),u=new Z0(Le.min(),new Map,new Ft($e),o,a);await Vk(i,u),i.du=i.du.remove(s),i.Au.delete(e),lS(i)}else await tw(i.localStore,e,!1).then((()=>rw(i,e,t))).catch(Iu)}async function JU(n,e){const t=We(n),i=e.batch.batchId;try{const r=await oU(t.localStore,e);Gk(t,i,null),Fk(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Ng(t,r)}catch(r){await Iu(r)}}async function eB(n,e,t){const i=We(n);try{const r=await(function(o,a){const u=We(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let d;return u.mutationQueue.lookupMutationBatch(h,a).next((g=>(be(g!==null,37113),d=g.keys(),u.mutationQueue.removeMutationBatch(h,g)))).next((()=>u.mutationQueue.performConsistencyCheck(h))).next((()=>u.documentOverlayCache.removeOverlaysForBatchId(h,d,a))).next((()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,d))).next((()=>u.localDocuments.getDocuments(h,d)))}))})(i.localStore,e);Gk(i,e,t),Fk(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Ng(i,r)}catch(r){await Iu(r)}}function Fk(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function Gk(n,e,t){const i=We(n);let r=i.Vu[i.currentUser.toKey()];if(r){const s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),i.Vu[i.currentUser.toKey()]=r}}function rw(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((i=>{n.Ru.containsKey(i)||jk(n,i)}))}function jk(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(eS(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),lS(n))}function TP(n,e,t){for(const i of t)i instanceof Dk?(n.Ru.addReference(i.key,e),tB(n,i)):i instanceof Nk?(ce(aS,"Document no longer in limbo: "+i.key),n.Ru.removeReference(i.key,e),n.Ru.containsKey(i.key)||jk(n,i.key)):Ie(19791,{wu:i})}function tB(n,e){const t=e.key,i=t.path.canonicalString();n.du.get(t)||n.Eu.has(i)||(ce(aS,"New document in limbo: "+t),n.Eu.add(i),lS(n))}function lS(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new pe(ft.fromString(e)),i=n.fu.next();n.Au.set(i,new $U(t)),n.du=n.du.insert(t,i),Pk(n.remoteStore,new uo(Tr(jx(t.path)),i,"TargetPurposeLimboResolution",xr.ce))}}async function Ng(n,e,t){const i=We(n),r=[],s=[],o=[];i.Tu.isEmpty()||(i.Tu.forEach(((a,u)=>{o.push(i.pu(u,e,t).then((h=>{if((h||t)&&i.isPrimaryClient){const d=h?!h.fromCache:t?.targetChanges.get(u.targetId)?.current;i.sharedClientState.updateQueryState(u.targetId,d?"current":"not-current")}if(h){r.push(h);const d=Qx.As(u.targetId,h);s.push(d)}})))})),await Promise.all(o),i.Pu.H_(r),await(async function(u,h){const d=We(u);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",(g=>H.forEach(h,(m=>H.forEach(m.Es,(v=>d.persistence.referenceDelegate.addReference(g,m.targetId,v))).next((()=>H.forEach(m.ds,(v=>d.persistence.referenceDelegate.removeReference(g,m.targetId,v)))))))))}catch(g){if(!Ha(g))throw g;ce(Jx,"Failed to update sequence numbers: "+g)}for(const g of h){const m=g.targetId;if(!g.fromCache){const v=d.Ms.get(m),y=v.snapshotVersion,T=v.withLastLimboFreeSnapshotVersion(y);d.Ms=d.Ms.insert(m,T)}}})(i.localStore,s))}async function nB(n,e){const t=We(n);if(!t.currentUser.isEqual(e)){ce(aS,"User change. New user:",e.toKey());const i=await Sk(t.localStore,e);t.currentUser=e,(function(s,o){s.mu.forEach((a=>{a.forEach((u=>{u.reject(new me(ee.CANCELLED,o))}))})),s.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Ng(t,i.Ls)}}function iB(n,e){const t=We(n),i=t.Au.get(e);if(i&&i.hu)return Ze().add(i.key);{let r=Ze();const s=t.Iu.get(e);if(!s)return r;for(const o of s){const a=t.Tu.get(o);r=r.unionWith(a.view.nu)}return r}}function Uk(n){const e=We(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Vk.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=iB.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=QU.bind(null,e),e.Pu.H_=GU.bind(null,e.eventManager),e.Pu.yu=jU.bind(null,e.eventManager),e}function Bk(n){const e=We(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=JU.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=eB.bind(null,e),e}class ng{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=ty(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return xk(this.persistence,new wk,e.initialUser,this.serializer)}Cu(e){return new Yx(ey.mi,this.serializer)}Du(e){return new Ik}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}ng.provider={build:()=>new ng};class rB extends ng{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){be(this.persistence.referenceDelegate instanceof j_,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new pk(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Yn.withCacheSize(this.cacheSizeBytes):Yn.DEFAULT;return new Yx((i=>j_.mi(i,t)),this.serializer)}}class sB extends ng{constructor(e,t,i){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=i,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await Bk(this.xu.syncEngine),await Dg(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return xk(this.persistence,new wk,e.initialUser,this.serializer)}Fu(e,t){const i=this.persistence.referenceDelegate.garbageCollector;return new pk(i,e.asyncQueue,t)}Mu(e,t){const i=new aG(t,this.persistence);return new oG(e.asyncQueue,i)}Cu(e){const t=nU(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),i=this.cacheSizeBytes!==void 0?Yn.withCacheSize(this.cacheSizeBytes):Yn.DEFAULT;return new Zx(this.synchronizeTabs,t,e.clientId,i,e.asyncQueue,_U(),Kp(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new Ik}}class B_{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>SP(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=nB.bind(null,this.syncEngine),await DU(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new OU})()}createDatastore(e){const t=ty(e.databaseInfo.databaseId),i=(function(s){return new pU(s)})(e.databaseInfo);return(function(s,o,a,u){return new wU(s,o,a,u)})(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,r,s,o,a){return new SU(i,r,s,o,a)})(this.localStore,this.datastore,e.asyncQueue,(t=>SP(this.syncEngine,t,0)),(function(){return _P.v()?new _P:new dU})())}createSyncEngine(e,t){return(function(r,s,o,a,u,h,d){const g=new WU(r,s,o,a,u,h);return d&&(g.gu=!0),g})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=We(t);ce(pu,"RemoteStore shutting down."),i.Ea.add(5),await kg(i),i.Aa.shutdown(),i.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}B_.provider={build:()=>new B_};class oB{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):ui("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const ja="FirestoreClient";class aB{constructor(e,t,i,r,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=r,this.user=Fn.UNAUTHENTICATED,this.clientId=Cx.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(i,(async o=>{ce(ja,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(i,(o=>(ce(ja,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new po;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=sS(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function b1(n,e){n.asyncQueue.verifyOperationInProgress(),ce(ja,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async r=>{i.isEqual(r)||(await Sk(e.localStore,r),i=r)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function IP(n,e){n.asyncQueue.verifyOperationInProgress();const t=await lB(n);ce(ja,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>vP(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,r)=>vP(e.remoteStore,r))),n._onlineComponents=e}async function lB(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){ce(ja,"Using user provided OfflineComponentProvider");try{await b1(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(r){return r.name==="FirebaseError"?r.code===ee.FAILED_PRECONDITION||r.code===ee.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11})(t))throw t;cu("Error using user provided cache. Falling back to memory cache: "+t),await b1(n,new ng)}}else ce(ja,"Using default OfflineComponentProvider"),await b1(n,new rB(void 0));return n._offlineComponents}async function zk(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(ce(ja,"Using user provided OnlineComponentProvider"),await IP(n,n._uninitializedComponentsProvider._online)):(ce(ja,"Using default OnlineComponentProvider"),await IP(n,new B_))),n._onlineComponents}function uB(n){return zk(n).then((e=>e.syncEngine))}async function cB(n){const e=await zk(n),t=e.eventManager;return t.onListen=KU.bind(null,e.syncEngine),t.onUnlisten=XU.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=HU.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=YU.bind(null,e.syncEngine),t}function hB(n,e,t={}){const i=new po;return n.asyncQueue.enqueueAndForget((async()=>(function(s,o,a,u,h){const d=new oB({next:m=>{d.Nu(),o.enqueueAndForget((()=>FU(s,g))),m.fromCache&&u.source==="server"?h.reject(new me(ee.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(m)},error:m=>h.reject(m)}),g=new UU(a,d,{includeMetadataChanges:!0,qa:!0});return VU(s,g)})(await cB(n),n.asyncQueue,e,t,i))),i.promise}function $k(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const AP=new Map;const Wk="firestore.googleapis.com",RP=!0;class PP{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new me(ee.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Wk,this.ssl=RP}else this.host=e.host,this.ssl=e.ssl??RP;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=dk;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Gj)throw new me(ee.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}nG("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=$k(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new me(ee.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new me(ee.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new me(ee.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,r){return i.timeoutSeconds===r.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class iy{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new PP({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new me(ee.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new me(ee.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new PP(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new K7;switch(i.type){case"firstParty":return new Y7(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new me(ee.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=AP.get(t);i&&(ce("ComponentProvider","Removing Datastore"),AP.delete(t),i.terminate())})(this),Promise.resolve()}}function dB(n,e,t,i={}){n=Oa(n,iy);const r=Su(e),s=n._getSettings(),o={...s,emulatorOptions:n._getEmulatorOptions()},a=`${e}:${t}`;r&&(Sx(`https://${a}`),Tx("Firestore",!0)),s.host!==Wk&&s.host!==a&&cu("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...s,host:a,ssl:r,emulatorOptions:i};if(!au(u,o)&&(n._setSettings(u),i.mockUserToken)){let h,d;if(typeof i.mockUserToken=="string")h=i.mockUserToken,d=Fn.MOCK_USER;else{h=N4(i.mockUserToken,n._app?.options.projectId);const g=i.mockUserToken.sub||i.mockUserToken.user_id;if(!g)throw new me(ee.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new Fn(g)}n._authCredentials=new H7(new Q4(h,d))}}class Nh{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Nh(this.firestore,e,this._query)}}class gn{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new La(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new gn(this.firestore,e,this._key)}toJSON(){return{type:gn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Rg(t,gn._jsonSchema))return new gn(e,i||null,new pe(ft.fromString(t.referencePath)))}}gn._jsonSchemaVersion="firestore/documentReference/1.0",gn._jsonSchema={type:ln("string",gn._jsonSchemaVersion),referencePath:ln("string")};class La extends Nh{constructor(e,t,i){super(e,t,jx(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new gn(this.firestore,null,new pe(e))}withConverter(e){return new La(this.firestore,e,this._path)}}function CP(n,e,...t){if(n=ni(n),eL("collection","path",e),n instanceof iy){const i=ft.fromString(e,...t);return yR(i),new La(n,null,i)}{if(!(n instanceof gn||n instanceof La))throw new me(ee.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(ft.fromString(e,...t));return yR(i),new La(n.firestore,null,i)}}function sw(n,e,...t){if(n=ni(n),arguments.length===1&&(e=Cx.newId()),eL("doc","path",e),n instanceof iy){const i=ft.fromString(e,...t);return _R(i),new gn(n,null,new pe(i))}{if(!(n instanceof gn||n instanceof La))throw new me(ee.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(ft.fromString(e,...t));return _R(i),new gn(n.firestore,n instanceof La?n.converter:null,new pe(i))}}const MP="AsyncQueue";class bP{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Ak(this,"async_queue_retry"),this._c=()=>{const i=Kp();i&&ce(MP,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=Kp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Kp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new po;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Ha(e))throw e;ce(MP,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,ui("INTERNAL UNHANDLED ERROR: ",LP(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=rS.createAndSchedule(this,e,t,i,(s=>this.hc(s)));return this.tc.push(r),r}uc(){this.nc&&Ie(47125,{Pc:LP(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function LP(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class Oh extends iy{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new bP,this._persistenceKey=r?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new bP(e),this._firestoreClient=void 0,await e}}}function fB(n,e){const t=typeof n=="object"?n:Rx(),i=typeof n=="string"?n:b_,r=F0(t,"firestore").getImmediate({identifier:i});if(!r._initialized){const s=L4("firestore");s&&dB(r,...s)}return r}function Kk(n){if(n._terminated)throw new me(ee.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||Hk(n),n._firestoreClient}function Hk(n){const e=n._freezeSettings(),t=(function(r,s,o,a){return new OG(r,s,o,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,$k(a.experimentalLongPollingOptions),a.useFetchStreams,a.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new aB(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(r){const s=r?._online.build();return{_offline:r?._offline.build(s),_online:s}})(n._componentsProvider))}function gB(n,e){cu("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return mB(n,B_.provider,{build:i=>new sB(i,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function mB(n,e,t){if((n=Oa(n,Oh))._firestoreClient||n._terminated)throw new me(ee.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new me(ee.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},Hk(n)}class yr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new yr(un.fromBase64String(e))}catch(t){throw new me(ee.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new yr(un.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:yr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Rg(e,yr._jsonSchema))return yr.fromBase64String(e.bytes)}}yr._jsonSchemaVersion="firestore/bytes/1.0",yr._jsonSchema={type:ln("string",yr._jsonSchemaVersion),bytes:ln("string")};class ry{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new me(ee.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new zt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class uS{constructor(e){this._methodName=e}}class Ps{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new me(ee.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new me(ee.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return $e(this._lat,e._lat)||$e(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ps._jsonSchemaVersion}}static fromJSON(e){if(Rg(e,Ps._jsonSchema))return new Ps(e.latitude,e.longitude)}}Ps._jsonSchemaVersion="firestore/geoPoint/1.0",Ps._jsonSchema={type:ln("string",Ps._jsonSchemaVersion),latitude:ln("number"),longitude:ln("number")};class Cs{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,r){if(i.length!==r.length)return!1;for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Cs._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Rg(e,Cs._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Cs(e.vectorValues);throw new me(ee.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Cs._jsonSchemaVersion="firestore/vectorValue/1.0",Cs._jsonSchema={type:ln("string",Cs._jsonSchemaVersion),vectorValues:ln("object")};const pB=/^__.*__$/;class _B{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new Co(e,this.data,this.fieldMask,t,this.fieldTransforms):new kh(e,this.data,t,this.fieldTransforms)}}class qk{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new Co(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Xk(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ie(40011,{Ac:n})}}class cS{constructor(e,t,i,r,s,o){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=r,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new cS({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),i=this.Vc({path:t,fc:!1});return i.gc(e),i}yc(e){const t=this.path?.child(e),i=this.Vc({path:t,fc:!1});return i.Rc(),i}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return z_(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(Xk(this.Ac)&&pB.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class yB{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||ty(e)}Cc(e,t,i,r=!1){return new cS({Ac:e,methodName:t,Dc:i,path:zt.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function hS(n){const e=n._freezeSettings(),t=ty(n._databaseId);return new yB(n._databaseId,!!e.ignoreUndefinedProperties,t)}function vB(n,e,t,i,r,s={}){const o=n.Cc(s.merge||s.mergeFields?2:0,e,t,r);dS("Data must be an object, but it was:",o,i);const a=Yk(i,o);let u,h;if(s.merge)u=new bi(o.fieldMask),h=o.fieldTransforms;else if(s.mergeFields){const d=[];for(const g of s.mergeFields){const m=ow(e,g,t);if(!o.contains(m))throw new me(ee.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);Qk(d,m)||d.push(m)}u=new bi(d),h=o.fieldTransforms.filter((g=>u.covers(g.field)))}else u=null,h=o.fieldTransforms;return new _B(new Qn(a),u,h)}class sy extends uS{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof sy}}function EB(n,e,t,i){const r=n.Cc(1,e,t);dS("Data must be an object, but it was:",r,i);const s=[],o=Qn.empty();qa(i,((u,h)=>{const d=fS(e,u,t);h=ni(h);const g=r.yc(d);if(h instanceof sy)s.push(d);else{const m=Og(h,g);m!=null&&(s.push(d),o.set(d,m))}}));const a=new bi(s);return new qk(o,a,r.fieldTransforms)}function wB(n,e,t,i,r,s){const o=n.Cc(1,e,t),a=[ow(e,i,t)],u=[r];if(s.length%2!=0)throw new me(ee.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<s.length;m+=2)a.push(ow(e,s[m])),u.push(s[m+1]);const h=[],d=Qn.empty();for(let m=a.length-1;m>=0;--m)if(!Qk(h,a[m])){const v=a[m];let y=u[m];y=ni(y);const T=o.yc(v);if(y instanceof sy)h.push(v);else{const w=Og(y,T);w!=null&&(h.push(v),d.set(v,w))}}const g=new bi(h);return new qk(d,g,o.fieldTransforms)}function xB(n,e,t,i=!1){return Og(t,n.Cc(i?4:3,e))}function Og(n,e){if(Zk(n=ni(n)))return dS("Unsupported field value:",e,n),Yk(n,e);if(n instanceof uS)return(function(i,r){if(!Xk(r.Ac))throw r.Sc(`${i._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Sc(`${i._methodName}() is not currently supported inside arrays`);const s=i._toFieldTransform(r);s&&r.fieldTransforms.push(s)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(i,r){const s=[];let o=0;for(const a of i){let u=Og(a,r.wc(o));u==null&&(u={nullValue:"NULL_VALUE"}),s.push(u),o++}return{arrayValue:{values:s}}})(n,e)}return(function(i,r){if((i=ni(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return nj(r.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const s=xt.fromDate(i);return{timestampValue:Th(r.serializer,s)}}if(i instanceof xt){const s=new xt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Th(r.serializer,s)}}if(i instanceof Ps)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof yr)return{bytesValue:YL(r.serializer,i._byteString)};if(i instanceof gn){const s=r.databaseId,o=i.firestore._databaseId;if(!o.isEqual(s))throw r.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Kx(i.firestore._databaseId||r.databaseId,i._key.path)}}if(i instanceof Cs)return(function(o,a){return{mapValue:{fields:{[Vx]:{stringValue:Fx},[yh]:{arrayValue:{values:o.toArray().map((h=>{if(typeof h!="number")throw a.Sc("VectorValues must only contain numeric values.");return Ux(a.serializer,h)}))}}}}}})(i,r);throw r.Sc(`Unsupported field value: ${G0(i)}`)})(n,e)}function Yk(n,e){const t={};return pL(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):qa(n,((i,r)=>{const s=Og(r,e.mc(i));s!=null&&(t[i]=s)})),{mapValue:{fields:t}}}function Zk(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof xt||n instanceof Ps||n instanceof yr||n instanceof gn||n instanceof uS||n instanceof Cs)}function dS(n,e,t){if(!Zk(t)||!tL(t)){const i=G0(t);throw i==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+i)}}function ow(n,e,t){if((e=ni(e))instanceof ry)return e._internalPath;if(typeof e=="string")return fS(n,e);throw z_("Field path arguments must be of type string or ",n,!1,void 0,t)}const SB=new RegExp("[~\\*/\\[\\]]");function fS(n,e,t){if(e.search(SB)>=0)throw z_(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new ry(...e.split("."))._internalPath}catch{throw z_(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function z_(n,e,t,i,r){const s=i&&!i.isEmpty(),o=r!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=` in field ${i}`),o&&(u+=` in document ${r}`),u+=")"),new me(ee.INVALID_ARGUMENT,a+n+u)}function Qk(n,e){return n.some((t=>t.isEqual(e)))}class Jk{constructor(e,t,i,r,s){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new gn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new TB(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(gS("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class TB extends Jk{data(){return super.data()}}function gS(n,e){return typeof e=="string"?fS(n,e):e instanceof ry?e._internalPath:e._delegate._internalPath}function IB(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new me(ee.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class mS{}class AB extends mS{}function RB(n,e,...t){let i=[];e instanceof mS&&i.push(e),i=i.concat(t),(function(s){const o=s.filter((u=>u instanceof pS)).length,a=s.filter((u=>u instanceof oy)).length;if(o>1||o>0&&a>0)throw new me(ee.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const r of i)n=r._apply(n);return n}class oy extends AB{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new oy(e,t,i)}_apply(e){const t=this._parse(e);return eD(e._query,t),new Nh(e.firestore,e.converter,KE(e._query,t))}_parse(e){const t=hS(e.firestore);return(function(s,o,a,u,h,d,g){let m;if(h.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new me(ee.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){DP(g,d);const y=[];for(const T of g)y.push(kP(u,s,T));m={arrayValue:{values:y}}}else m=kP(u,s,g)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||DP(g,d),m=xB(a,o,g,d==="in"||d==="not-in");return et.create(h,d,m)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function PB(n,e,t){const i=e,r=gS("where",n);return oy._create(r,i,t)}class pS extends mS{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new pS(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:St.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(r,s){let o=r;const a=s.getFlattenedFilters();for(const u of a)eD(o,u),o=KE(o,u)})(e._query,t),new Nh(e.firestore,e.converter,KE(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function kP(n,e,t){if(typeof(t=ni(t))=="string"){if(t==="")throw new me(ee.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!kL(e)&&t.indexOf("/")!==-1)throw new me(ee.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(ft.fromString(t));if(!pe.isDocumentKey(i))throw new me(ee.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Qf(n,new pe(i))}if(t instanceof gn)return Qf(n,t._key);throw new me(ee.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${G0(t)}.`)}function DP(n,e){if(!Array.isArray(n)||n.length===0)throw new me(ee.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function eD(n,e){const t=(function(r,s){for(const o of r)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null})(n.filters,(function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new me(ee.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new me(ee.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class CB{convertValue(e,t="none"){switch(Va(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ot(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(xo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ie(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return qa(e,((r,s)=>{i[r]=this.convertValue(s,t)})),i}convertVectorValue(e){const t=e.fields?.[yh].arrayValue?.values?.map((i=>Ot(i.doubleValue)));return new Cs(t)}convertGeoPoint(e){return new Ps(Ot(e.latitude),Ot(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=W0(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(Yf(e));default:return null}}convertTimestamp(e){const t=wo(e);return new xt(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=ft.fromString(e);be(ok(i),9688,{name:e});const r=new hu(i.get(1),i.get(3)),s=new pe(i.popFirst(5));return r.isEqual(t)||ui(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function MB(n,e,t){let i;return i=n?n.toFirestore(e):e,i}class Tp{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Qc extends Jk{constructor(e,t,i,r,s,o){super(e,t,i,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Hp(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(gS("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new me(ee.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Qc._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Qc._jsonSchemaVersion="firestore/documentSnapshot/1.0",Qc._jsonSchema={type:ln("string",Qc._jsonSchemaVersion),bundleSource:ln("string","DocumentSnapshot"),bundleName:ln("string"),bundle:ln("string")};class Hp extends Qc{data(e={}){return super.data(e)}}class Jc{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Tp(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new Hp(this._firestore,this._userDataWriter,i.key,i,new Tp(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new me(ee.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(r,s){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map((a=>{const u=new Hp(r._firestore,r._userDataWriter,a.doc.key,a.doc,new Tp(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);return a.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}}))}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter((a=>s||a.type!==3)).map((a=>{const u=new Hp(r._firestore,r._userDataWriter,a.doc.key,a.doc,new Tp(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);let h=-1,d=-1;return a.type!==0&&(h=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:bB(a.type),doc:u,oldIndex:h,newIndex:d}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new me(ee.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Jc._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Cx.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],r=[];return this.docs.forEach((s=>{s._document!==null&&(t.push(s._document),i.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),r.push(s.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function bB(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ie(61501,{type:n})}}Jc._jsonSchemaVersion="firestore/querySnapshot/1.0",Jc._jsonSchema={type:ln("string",Jc._jsonSchemaVersion),bundleSource:ln("string","QuerySnapshot"),bundleName:ln("string"),bundle:ln("string")};class LB extends CB{constructor(e){super(),this.firestore=e}convertBytes(e){return new yr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new gn(this.firestore,null,t)}}function kB(n){n=Oa(n,Nh);const e=Oa(n.firestore,Oh),t=Kk(e),i=new LB(e);return IB(n._query),hB(t,n._query).then((r=>new Jc(e,i,n,r)))}function DB(n,e,t,...i){n=Oa(n,gn);const r=Oa(n.firestore,Oh),s=hS(r);let o;return o=typeof(e=ni(e))=="string"||e instanceof ry?wB(s,"updateDoc",n._key,e,t,i):EB(s,"updateDoc",n._key,e),_S(r,[o.toMutation(n._key,ci.exists(!0))])}function NB(n){return _S(Oa(n.firestore,Oh),[new Y0(n._key,ci.none())])}function OB(n,e){const t=Oa(n.firestore,Oh),i=sw(n),r=MB(n.converter,e);return _S(t,[vB(hS(n.firestore),"addDoc",i._key,r,n.converter!==null,{}).toMutation(i._key,ci.exists(!1))]).then((()=>i))}function _S(n,e){return(function(i,r){const s=new po;return i.asyncQueue.enqueueAndForget((async()=>ZU(await uB(i),r,s))),s.promise})(Kk(n),e)}(function(e,t=!0){(function(r){Lh=r})(Tu),lu(new Na("firestore",((i,{instanceIdentifier:r,options:s})=>{const o=i.getProvider("app").getImmediate(),a=new Oh(new q7(i.getProvider("auth-internal")),new Z7(o,i.getProvider("app-check-internal")),(function(h,d){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new me(ee.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new hu(h.options.projectId,d)})(o,r),o);return s={useFetchStreams:t,...s},a._setSettings(s),a}),"PUBLIC").setMultipleInstances(!0)),Rs(fR,gR,e),Rs(fR,gR,"esm2020")})();var VB="firebase",FB="12.7.0";Rs(VB,FB,"app");function tD(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const GB=tD,nD=new Ig("auth","Firebase",tD());const $_=new Ix("@firebase/auth");function jB(n,...e){$_.logLevel<=Je.WARN&&$_.warn(`Auth (${Tu}): ${n}`,...e)}function qp(n,...e){$_.logLevel<=Je.ERROR&&$_.error(`Auth (${Tu}): ${n}`,...e)}function So(n,...e){throw yS(n,...e)}function Ms(n,...e){return yS(n,...e)}function iD(n,e,t){const i={...GB(),[e]:t};return new Ig("auth","Firebase",i).create(e,{appName:n.name})}function Zl(n){return iD(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function yS(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return nD.create(n,...e)}function Be(n,e,...t){if(!n)throw yS(e,...t)}function co(n){const e="INTERNAL ASSERTION FAILED: "+n;throw qp(e),new Error(e)}function To(n,e){n||co(e)}function aw(){return typeof self<"u"&&self.location?.href||""}function UB(){return NP()==="http:"||NP()==="https:"}function NP(){return typeof self<"u"&&self.location?.protocol||null}function BB(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(UB()||R9()||"connection"in navigator)?navigator.onLine:!0}function zB(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class Vg{constructor(e,t){this.shortDelay=e,this.longDelay=t,To(t>e,"Short delay should be less than long delay!"),this.isMobile=I9()||P9()}get(){return BB()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function vS(n,e){To(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class rD{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;co("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;co("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;co("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const $B={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const WB=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],KB=new Vg(3e4,6e4);function ES(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Vh(n,e,t,i,r={}){return sD(n,r,async()=>{let s={},o={};i&&(e==="GET"?o=i:s={body:JSON.stringify(i)});const a=Ag({key:n.config.apiKey,...o}).slice(1),u=await n._getAdditionalHeaders();u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode);const h={method:e,headers:u,...s};return A9()||(h.referrerPolicy="no-referrer"),n.emulatorConfig&&Su(n.emulatorConfig.host)&&(h.credentials="include"),rD.fetch()(await oD(n,n.config.apiHost,t,a),h)})}async function sD(n,e,t){n._canInitEmulator=!1;const i={...$B,...e};try{const r=new qB(n),s=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Ip(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[u,h]=a.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ip(n,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw Ip(n,"email-already-in-use",o);if(u==="USER_DISABLED")throw Ip(n,"user-disabled",o);const d=i[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw iD(n,d,h);So(n,d)}}catch(r){if(r instanceof Fs)throw r;So(n,"network-request-failed",{message:String(r)})}}async function HB(n,e,t,i,r={}){const s=await Vh(n,e,t,i,r);return"mfaPendingCredential"in s&&So(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function oD(n,e,t,i){const r=`${e}${t}?${i}`,s=n,o=s.config.emulator?vS(n.config,r):`${n.config.apiScheme}://${r}`;return WB.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}class qB{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Ms(this.auth,"network-request-failed")),KB.get())})}}function Ip(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const r=Ms(n,e,i);return r.customData._tokenResponse=t,r}async function XB(n,e){return Vh(n,"POST","/v1/accounts:delete",e)}async function W_(n,e){return Vh(n,"POST","/v1/accounts:lookup",e)}function vf(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function YB(n,e=!1){const t=ni(n),i=await t.getIdToken(e),r=wS(i);Be(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");const s=typeof r.firebase=="object"?r.firebase:void 0,o=s?.sign_in_provider;return{claims:r,token:i,authTime:vf(L1(r.auth_time)),issuedAtTime:vf(L1(r.iat)),expirationTime:vf(L1(r.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}}function L1(n){return Number(n)*1e3}function wS(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return qp("JWT malformed, contained fewer than 3 sections"),null;try{const r=C4(t);return r?JSON.parse(r):(qp("Failed to decode base64 JWT payload"),null)}catch(r){return qp("Caught error parsing JWT payload as JSON",r?.toString()),null}}function OP(n){const e=wS(n);return Be(e,"internal-error"),Be(typeof e.exp<"u","internal-error"),Be(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function ig(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof Fs&&ZB(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function ZB({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class QB{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class lw{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=vf(this.lastLoginAt),this.creationTime=vf(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function K_(n){const e=n.auth,t=await n.getIdToken(),i=await ig(n,W_(e,{idToken:t}));Be(i?.users.length,e,"internal-error");const r=i.users[0];n._notifyReloadListener(r);const s=r.providerUserInfo?.length?aD(r.providerUserInfo):[],o=ez(n.providerData,s),a=n.isAnonymous,u=!(n.email&&r.passwordHash)&&!o?.length,h=a?u:!1,d={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:o,metadata:new lw(r.createdAt,r.lastLoginAt),isAnonymous:h};Object.assign(n,d)}async function JB(n){const e=ni(n);await K_(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function ez(n,e){return[...n.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function aD(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function tz(n,e){const t=await sD(n,{},async()=>{const i=Ag({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:s}=n.config,o=await oD(n,r,"/v1/token",`key=${s}`),a=await n._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:a,body:i};return n.emulatorConfig&&Su(n.emulatorConfig.host)&&(u.credentials="include"),rD.fetch()(o,u)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function nz(n,e){return Vh(n,"POST","/v2/accounts:revokeToken",ES(n,e))}class eh{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Be(e.idToken,"internal-error"),Be(typeof e.idToken<"u","internal-error"),Be(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):OP(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Be(e.length!==0,"internal-error");const t=OP(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Be(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:r,expiresIn:s}=await tz(e,t);this.updateTokensAndExpiration(i,r,Number(s))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:r,expirationTime:s}=t,o=new eh;return i&&(Be(typeof i=="string","internal-error",{appName:e}),o.refreshToken=i),r&&(Be(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),s&&(Be(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new eh,this.toJSON())}_performRefresh(){return co("not implemented")}}function ua(n,e){Be(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Hr{constructor({uid:e,auth:t,stsTokenManager:i,...r}){this.providerId="firebase",this.proactiveRefresh=new QB(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new lw(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await ig(this,this.stsTokenManager.getToken(this.auth,e));return Be(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return YB(this,e)}reload(){return JB(this)}_assign(e){this!==e&&(Be(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Hr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Be(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await K_(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if($r(this.auth.app))return Promise.reject(Zl(this.auth));const e=await this.getIdToken();return await ig(this,XB(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,r=t.email??void 0,s=t.phoneNumber??void 0,o=t.photoURL??void 0,a=t.tenantId??void 0,u=t._redirectEventId??void 0,h=t.createdAt??void 0,d=t.lastLoginAt??void 0,{uid:g,emailVerified:m,isAnonymous:v,providerData:y,stsTokenManager:T}=t;Be(g&&T,e,"internal-error");const w=eh.fromJSON(this.name,T);Be(typeof g=="string",e,"internal-error"),ua(i,e.name),ua(r,e.name),Be(typeof m=="boolean",e,"internal-error"),Be(typeof v=="boolean",e,"internal-error"),ua(s,e.name),ua(o,e.name),ua(a,e.name),ua(u,e.name),ua(h,e.name),ua(d,e.name);const A=new Hr({uid:g,auth:e,email:r,emailVerified:m,displayName:i,isAnonymous:v,photoURL:o,phoneNumber:s,tenantId:a,stsTokenManager:w,createdAt:h,lastLoginAt:d});return y&&Array.isArray(y)&&(A.providerData=y.map(P=>({...P}))),u&&(A._redirectEventId=u),A}static async _fromIdTokenResponse(e,t,i=!1){const r=new eh;r.updateFromServerResponse(t);const s=new Hr({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:i});return await K_(s),s}static async _fromGetAccountInfoResponse(e,t,i){const r=t.users[0];Be(r.localId!==void 0,"internal-error");const s=r.providerUserInfo!==void 0?aD(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!s?.length,a=new eh;a.updateFromIdToken(i);const u=new Hr({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:o}),h={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new lw(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!s?.length};return Object.assign(u,h),u}}const VP=new Map;function ho(n){To(n instanceof Function,"Expected a class definition");let e=VP.get(n);return e?(To(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,VP.set(n,e),e)}class lD{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}lD.type="NONE";const FP=lD;function Xp(n,e,t){return`firebase:${n}:${e}:${t}`}class th{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:r,name:s}=this.auth;this.fullUserKey=Xp(this.userKey,r.apiKey,s),this.fullPersistenceKey=Xp("persistence",r.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await W_(this.auth,{idToken:e}).catch(()=>{});return t?Hr._fromGetAccountInfoResponse(this.auth,t,e):null}return Hr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new th(ho(FP),e,i);const r=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let s=r[0]||ho(FP);const o=Xp(i,e.config.apiKey,e.name);let a=null;for(const h of t)try{const d=await h._get(o);if(d){let g;if(typeof d=="string"){const m=await W_(e,{idToken:d}).catch(()=>{});if(!m)break;g=await Hr._fromGetAccountInfoResponse(e,m,d)}else g=Hr._fromJSON(e,d);h!==s&&(a=g),s=h;break}}catch{}const u=r.filter(h=>h._shouldAllowMigration);return!s._shouldAllowMigration||!u.length?new th(s,e,i):(s=u[0],a&&await s._set(o,a.toJSON()),await Promise.all(t.map(async h=>{if(h!==s)try{await h._remove(o)}catch{}})),new th(s,e,i))}}function GP(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(dD(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(uD(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(gD(e))return"Blackberry";if(mD(e))return"Webos";if(cD(e))return"Safari";if((e.includes("chrome/")||hD(e))&&!e.includes("edge/"))return"Chrome";if(fD(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function uD(n=pn()){return/firefox\//i.test(n)}function cD(n=pn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function hD(n=pn()){return/crios\//i.test(n)}function dD(n=pn()){return/iemobile/i.test(n)}function fD(n=pn()){return/android/i.test(n)}function gD(n=pn()){return/blackberry/i.test(n)}function mD(n=pn()){return/webos/i.test(n)}function xS(n=pn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function iz(n=pn()){return xS(n)&&!!window.navigator?.standalone}function rz(){return C9()&&document.documentMode===10}function pD(n=pn()){return xS(n)||fD(n)||mD(n)||gD(n)||/windows phone/i.test(n)||dD(n)}function _D(n,e=[]){let t;switch(n){case"Browser":t=GP(pn());break;case"Worker":t=`${GP(pn())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Tu}/${i}`}class sz{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=s=>new Promise((o,a)=>{try{const u=e(s);o(u)}catch(u){a(u)}});i.onAbort=t,this.queue.push(i);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function oz(n,e={}){return Vh(n,"GET","/v2/passwordPolicy",ES(n,e))}const az=6;class lz{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??az,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,r,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class uz{constructor(e,t,i,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new jP(this),this.idTokenSubscription=new jP(this),this.beforeStateQueue=new sz(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=nD,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ho(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await th.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await W_(this,{idToken:e}),i=await Hr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if($r(this.app)){const s=this.app.settings.authIdToken;return s?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(o,o))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const s=this.redirectUser?._redirectEventId,o=i?._redirectEventId,a=await this.tryRedirectSignIn(e);(!s||s===o)&&a?.user&&(i=a.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(s){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Be(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await K_(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=zB()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if($r(this.app))return Promise.reject(Zl(this));const t=e?ni(e):null;return t&&Be(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Be(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return $r(this.app)?Promise.reject(Zl(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return $r(this.app)?Promise.reject(Zl(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ho(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await oz(this),t=new lz(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Ig("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await nz(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&ho(e)||this._popupRedirectResolver;Be(t,this,"argument-error"),this.redirectPersistenceManager=await th.create(this,[ho(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,r){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(Be(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof t=="function"){const u=e.addObserver(t,i,r);return()=>{o=!0,u()}}else{const u=e.addObserver(t);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Be(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=_D(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if($r(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&jB(`Error while retrieving App Check token: ${e.error}`),e?.token}}function SS(n){return ni(n)}class jP{constructor(e){this.auth=e,this.observer=null,this.addObserver=N9(t=>this.observer=t)}get next(){return Be(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let TS={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function cz(n){TS=n}function hz(n){return TS.loadJS(n)}function dz(){return TS.gapiScript}function fz(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function gz(n,e){const t=F0(n,"auth");if(t.isInitialized()){const r=t.getImmediate(),s=t.getOptions();if(au(s,e??{}))return r;So(r,"already-initialized")}return t.initialize({options:e})}function mz(n,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(ho);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function pz(n,e,t){const i=SS(n);Be(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const r=!1,s=yD(e),{host:o,port:a}=_z(e),u=a===null?"":`:${a}`,h={url:`${s}//${o}${u}/`},d=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!i._canInitEmulator){Be(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Be(au(h,i.config.emulator)&&au(d,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=h,i.emulatorConfig=d,i.settings.appVerificationDisabledForTesting=!0,Su(o)?(Sx(`${s}//${o}${u}`),Tx("Auth",!0)):yz()}function yD(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function _z(n){const e=yD(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const s=r[1];return{host:s,port:UP(i.substr(s.length+1))}}else{const[s,o]=i.split(":");return{host:s,port:UP(o)}}}function UP(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function yz(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class vD{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return co("not implemented")}_getIdTokenResponse(e){return co("not implemented")}_linkToIdToken(e,t){return co("not implemented")}_getReauthenticationResolver(e){return co("not implemented")}}async function nh(n,e){return HB(n,"POST","/v1/accounts:signInWithIdp",ES(n,e))}const vz="http://localhost";class _u extends vD{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new _u(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):So("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:r,...s}=t;if(!i||!r)return null;const o=new _u(i,r);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return nh(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,nh(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,nh(e,t)}buildRequest(){const e={requestUri:vz,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Ag(t)}return e}}class ED{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Fg extends ED{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class ma extends Fg{constructor(){super("facebook.com")}static credential(e){return _u._fromParams({providerId:ma.PROVIDER_ID,signInMethod:ma.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ma.credentialFromTaggedObject(e)}static credentialFromError(e){return ma.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ma.credential(e.oauthAccessToken)}catch{return null}}}ma.FACEBOOK_SIGN_IN_METHOD="facebook.com";ma.PROVIDER_ID="facebook.com";class pa extends Fg{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return _u._fromParams({providerId:pa.PROVIDER_ID,signInMethod:pa.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return pa.credentialFromTaggedObject(e)}static credentialFromError(e){return pa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return pa.credential(t,i)}catch{return null}}}pa.GOOGLE_SIGN_IN_METHOD="google.com";pa.PROVIDER_ID="google.com";class _a extends Fg{constructor(){super("github.com")}static credential(e){return _u._fromParams({providerId:_a.PROVIDER_ID,signInMethod:_a.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return _a.credentialFromTaggedObject(e)}static credentialFromError(e){return _a.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return _a.credential(e.oauthAccessToken)}catch{return null}}}_a.GITHUB_SIGN_IN_METHOD="github.com";_a.PROVIDER_ID="github.com";class ya extends Fg{constructor(){super("twitter.com")}static credential(e,t){return _u._fromParams({providerId:ya.PROVIDER_ID,signInMethod:ya.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return ya.credentialFromTaggedObject(e)}static credentialFromError(e){return ya.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return ya.credential(t,i)}catch{return null}}}ya.TWITTER_SIGN_IN_METHOD="twitter.com";ya.PROVIDER_ID="twitter.com";class Ah{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,r=!1){const s=await Hr._fromIdTokenResponse(e,i,r),o=BP(i);return new Ah({user:s,providerId:o,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const r=BP(i);return new Ah({user:e,providerId:r,_tokenResponse:i,operationType:t})}}function BP(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class H_ extends Fs{constructor(e,t,i,r){super(t.code,t.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,H_.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,r){return new H_(e,t,i,r)}}function wD(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?H_._fromErrorAndOperation(n,s,e,i):s})}async function Ez(n,e,t=!1){const i=await ig(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Ah._forOperation(n,"link",i)}async function wz(n,e,t=!1){const{auth:i}=n;if($r(i.app))return Promise.reject(Zl(i));const r="reauthenticate";try{const s=await ig(n,wD(i,r,e,n),t);Be(s.idToken,i,"internal-error");const o=wS(s.idToken);Be(o,i,"internal-error");const{sub:a}=o;return Be(n.uid===a,i,"user-mismatch"),Ah._forOperation(n,r,s)}catch(s){throw s?.code==="auth/user-not-found"&&So(i,"user-mismatch"),s}}async function xz(n,e,t=!1){if($r(n.app))return Promise.reject(Zl(n));const i="signIn",r=await wD(n,i,e),s=await Ah._fromIdTokenResponse(n,i,r);return t||await n._updateCurrentUser(s.user),s}function Sz(n,e,t,i){return ni(n).onIdTokenChanged(e,t,i)}function Tz(n,e,t){return ni(n).beforeAuthStateChanged(e,t)}const q_="__sak";class xD{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(q_,"1"),this.storage.removeItem(q_),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const Iz=1e3,Az=10;class SD extends xD{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=pD(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),r=this.localCache[t];i!==r&&e(t,r,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,u)=>{this.notifyListeners(o,u)});return}const i=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const o=this.storage.getItem(i);!t&&this.localCache[i]===o||this.notifyListeners(i,o)},s=this.storage.getItem(i);rz()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,Az):r()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},Iz)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}SD.type="LOCAL";const Rz=SD;class TD extends xD{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}TD.type="SESSION";const ID=TD;function Pz(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class ay{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(r=>r.isListeningto(e));if(t)return t;const i=new ay(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:r,data:s}=t.data,o=this.handlersMap[r];if(!o?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:r});const a=Array.from(o).map(async h=>h(t.origin,s)),u=await Pz(a);t.ports[0].postMessage({status:"done",eventId:i,eventType:r,response:u})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}ay.receivers=[];function IS(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}class Cz{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,o;return new Promise((a,u)=>{const h=IS("",20);r.port1.start();const d=setTimeout(()=>{u(new Error("unsupported_event"))},i);o={messageChannel:r,onMessage(g){const m=g;if(m.data.eventId===h)switch(m.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(m.data.response);break;default:clearTimeout(d),clearTimeout(s),u(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function bs(){return window}function Mz(n){bs().location.href=n}function AD(){return typeof bs().WorkerGlobalScope<"u"&&typeof bs().importScripts=="function"}async function bz(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Lz(){return navigator?.serviceWorker?.controller||null}function kz(){return AD()?self:null}const RD="firebaseLocalStorageDb",Dz=1,X_="firebaseLocalStorage",PD="fbase_key";class Gg{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function ly(n,e){return n.transaction([X_],e?"readwrite":"readonly").objectStore(X_)}function Nz(){const n=indexedDB.deleteDatabase(RD);return new Gg(n).toPromise()}function uw(){const n=indexedDB.open(RD,Dz);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(X_,{keyPath:PD})}catch(r){t(r)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(X_)?e(i):(i.close(),await Nz(),e(await uw()))})})}async function zP(n,e,t){const i=ly(n,!0).put({[PD]:e,value:t});return new Gg(i).toPromise()}async function Oz(n,e){const t=ly(n,!1).get(e),i=await new Gg(t).toPromise();return i===void 0?null:i.value}function $P(n,e){const t=ly(n,!0).delete(e);return new Gg(t).toPromise()}const Vz=800,Fz=3;class CD{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await uw(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>Fz)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return AD()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ay._getInstance(kz()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await bz(),!this.activeServiceWorker)return;this.sender=new Cz(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Lz()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await uw();return await zP(e,q_,"1"),await $P(e,q_),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>zP(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>Oz(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>$P(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const s=ly(r,!1).getAll();return new Gg(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:r,value:s}of e)i.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(s)&&(this.notifyListeners(r,s),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!i.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Vz)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}CD.type="LOCAL";const Gz=CD;new Vg(3e4,6e4);function jz(n,e){return e?ho(e):(Be(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class AS extends vD{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return nh(e,this._buildIdpRequest())}_linkToIdToken(e,t){return nh(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return nh(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Uz(n){return xz(n.auth,new AS(n),n.bypassAuthState)}function Bz(n){const{auth:e,user:t}=n;return Be(t,e,"internal-error"),wz(t,new AS(n),n.bypassAuthState)}async function zz(n){const{auth:e,user:t}=n;return Be(t,e,"internal-error"),Ez(t,new AS(n),n.bypassAuthState)}class MD{constructor(e,t,i,r,s=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:r,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:t,sessionId:i,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(u))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Uz;case"linkViaPopup":case"linkViaRedirect":return zz;case"reauthViaPopup":case"reauthViaRedirect":return Bz;default:So(this.auth,"internal-error")}}resolve(e){To(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){To(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const $z=new Vg(2e3,1e4);class Oc extends MD{constructor(e,t,i,r,s){super(e,t,r,s),this.provider=i,this.authWindow=null,this.pollId=null,Oc.currentPopupAction&&Oc.currentPopupAction.cancel(),Oc.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Be(e,this.auth,"internal-error"),e}async onExecution(){To(this.filter.length===1,"Popup operations only handle one event");const e=IS();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Ms(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Ms(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Oc.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ms(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,$z.get())};e()}}Oc.currentPopupAction=null;const Wz="pendingRedirect",Yp=new Map;class Kz extends MD{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=Yp.get(this.auth._key());if(!e){try{const i=await Hz(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}Yp.set(this.auth._key(),e)}return this.bypassAuthState||Yp.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Hz(n,e){const t=Yz(e),i=Xz(n);if(!await i._isAvailable())return!1;const r=await i._get(t)==="true";return await i._remove(t),r}function qz(n,e){Yp.set(n._key(),e)}function Xz(n){return ho(n._redirectPersistence)}function Yz(n){return Xp(Wz,n.config.apiKey,n.name)}async function Zz(n,e,t=!1){if($r(n.app))return Promise.reject(Zl(n));const i=SS(n),r=jz(i,e),o=await new Kz(i,r,t).execute();return o&&!t&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,e)),o}const Qz=600*1e3;class Jz{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!e$(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!bD(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Ms(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Qz&&this.cachedEventUids.clear(),this.cachedEventUids.has(WP(e))}saveEventToCache(e){this.cachedEventUids.add(WP(e)),this.lastProcessedEventTime=Date.now()}}function WP(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function bD({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function e$(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return bD(n);default:return!1}}async function t$(n,e={}){return Vh(n,"GET","/v1/projects",e)}const n$=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,i$=/^https?/;async function r$(n){if(n.config.emulator)return;const{authorizedDomains:e}=await t$(n);for(const t of e)try{if(s$(t))return}catch{}So(n,"unauthorized-domain")}function s$(n){const e=aw(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===i}if(!i$.test(t))return!1;if(n$.test(n))return i===n;const r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const o$=new Vg(3e4,6e4);function KP(){const n=bs().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function a$(n){return new Promise((e,t)=>{function i(){KP(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{KP(),t(Ms(n,"network-request-failed"))},timeout:o$.get()})}if(bs().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(bs().gapi?.load)i();else{const r=fz("iframefcb");return bs()[r]=()=>{gapi.load?i():t(Ms(n,"network-request-failed"))},hz(`${dz()}?onload=${r}`).catch(s=>t(s))}}).catch(e=>{throw Zp=null,e})}let Zp=null;function l$(n){return Zp=Zp||a$(n),Zp}const u$=new Vg(5e3,15e3),c$="__/auth/iframe",h$="emulator/auth/iframe",d$={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},f$=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function g$(n){const e=n.config;Be(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?vS(e,h$):`https://${n.config.authDomain}/${c$}`,i={apiKey:e.apiKey,appName:n.name,v:Tu},r=f$.get(n.config.apiHost);r&&(i.eid=r);const s=n._getFrameworks();return s.length&&(i.fw=s.join(",")),`${t}?${Ag(i).slice(1)}`}async function m$(n){const e=await l$(n),t=bs().gapi;return Be(t,n,"internal-error"),e.open({where:document.body,url:g$(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:d$,dontclear:!0},i=>new Promise(async(r,s)=>{await i.restyle({setHideOnLeave:!1});const o=Ms(n,"network-request-failed"),a=bs().setTimeout(()=>{s(o)},u$.get());function u(){bs().clearTimeout(a),r(i)}i.ping(u).then(u,()=>{s(o)})}))}const p$={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},_$=500,y$=600,v$="_blank",E$="http://localhost";class HP{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function w$(n,e,t,i=_$,r=y$){const s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let a="";const u={...p$,width:i.toString(),height:r.toString(),top:s,left:o},h=pn().toLowerCase();t&&(a=hD(h)?v$:t),uD(h)&&(e=e||E$,u.scrollbars="yes");const d=Object.entries(u).reduce((m,[v,y])=>`${m}${v}=${y},`,"");if(iz(h)&&a!=="_self")return x$(e||"",a),new HP(null);const g=window.open(e||"",a,d);Be(g,n,"popup-blocked");try{g.focus()}catch{}return new HP(g)}function x$(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const S$="__/auth/handler",T$="emulator/auth/handler",I$=encodeURIComponent("fac");async function qP(n,e,t,i,r,s){Be(n.config.authDomain,n,"auth-domain-config-required"),Be(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:Tu,eventId:r};if(e instanceof ED){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",D9(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,g]of Object.entries({}))o[d]=g}if(e instanceof Fg){const d=e.getScopes().filter(g=>g!=="");d.length>0&&(o.scopes=d.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const d of Object.keys(a))a[d]===void 0&&delete a[d];const u=await n._getAppCheckToken(),h=u?`#${I$}=${encodeURIComponent(u)}`:"";return`${A$(n)}?${Ag(a).slice(1)}${h}`}function A$({config:n}){return n.emulator?vS(n,T$):`https://${n.authDomain}/${S$}`}const k1="webStorageSupport";class R${constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=ID,this._completeRedirectFn=Zz,this._overrideRedirectResult=qz}async _openPopup(e,t,i,r){To(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const s=await qP(e,t,i,aw(),r);return w$(e,s,IS())}async _openRedirect(e,t,i,r){await this._originValidation(e);const s=await qP(e,t,i,aw(),r);return Mz(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:r,promise:s}=this.eventManagers[t];return r?Promise.resolve(r):(To(s,"If manager is not set, promise should be"),s)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await m$(e),i=new Jz(e);return t.register("authEvent",r=>(Be(r?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(k1,{type:k1},r=>{const s=r?.[0]?.[k1];s!==void 0&&t(!!s),So(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=r$(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return pD()||cD()||xS()}}const P$=R$;var XP="@firebase/auth",YP="1.12.0";class C${constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Be(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function M$(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function b$(n){lu(new Na("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=i.options;Be(o&&!o.includes(":"),"invalid-api-key",{appName:i.name});const u={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:_D(n)},h=new uz(i,r,s,u);return mz(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),lu(new Na("auth-internal",e=>{const t=SS(e.getProvider("auth").getImmediate());return(i=>new C$(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Rs(XP,YP,M$(n)),Rs(XP,YP,"esm2020")}const L$=300,k$=D4("authIdTokenMaxAge")||L$;let ZP=null;const D$=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>k$)return;const r=t?.token;ZP!==r&&(ZP=r,await fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function N$(n=Rx()){const e=F0(n,"auth");if(e.isInitialized())return e.getImmediate();const t=gz(n,{popupRedirectResolver:P$,persistence:[Gz,Rz,ID]}),i=D4("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(i,location.origin);if(location.origin===s.origin){const o=D$(s.toString());Tz(t,o,()=>o(t.currentUser)),Sz(t,a=>o(a))}}const r=b4("auth");return r&&pz(t,`http://${r}`),t}function O$(){return document.getElementsByTagName("head")?.[0]??document}cz({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=r=>{const s=Ms("internal-error");s.customData=r,t(s)},i.type="text/javascript",i.charset="UTF-8",O$().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});b$("Browser");const LD="firebasestorage.googleapis.com",V$="storageBucket",F$=120*1e3,G$=600*1e3;class Gs extends Fs{constructor(e,t,i=0){super(D1(e),`Firebase Storage: ${t} (${D1(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Gs.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return D1(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Ns;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Ns||(Ns={}));function D1(n){return"storage/"+n}function j$(){const n="An unknown error occurred, please check the error payload for server response.";return new Gs(Ns.UNKNOWN,n)}function U$(){return new Gs(Ns.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function B$(){return new Gs(Ns.CANCELED,"User canceled the upload/download.")}function z$(n){return new Gs(Ns.INVALID_URL,"Invalid URL '"+n+"'.")}function $$(n){return new Gs(Ns.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function QP(n){return new Gs(Ns.INVALID_ARGUMENT,n)}function kD(){return new Gs(Ns.APP_DELETED,"The Firebase app was deleted.")}function W$(n){return new Gs(Ns.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}class qr{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=qr.makeFromUrl(e,t)}catch{return new qr(e,"")}if(i.path==="")return i;throw $$(e)}static makeFromUrl(e,t){let i=null;const r="([A-Za-z0-9.\\-_]+)";function s(k){k.path.charAt(k.path.length-1)==="/"&&(k.path_=k.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+r+o,"i"),u={bucket:1,path:3};function h(k){k.path_=decodeURIComponent(k.path)}const d="v[A-Za-z0-9_]+",g=t.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",v=new RegExp(`^https?://${g}/${d}/b/${r}/o${m}`,"i"),y={bucket:1,path:3},T=t===LD?"(?:storage.googleapis.com|storage.cloud.google.com)":t,w="([^?#]*)",A=new RegExp(`^https?://${T}/${r}/${w}`,"i"),M=[{regex:a,indices:u,postModify:s},{regex:v,indices:y,postModify:h},{regex:A,indices:{bucket:1,path:2},postModify:h}];for(let k=0;k<M.length;k++){const N=M[k],B=N.regex.exec(e);if(B){const b=B[N.indices.bucket];let R=B[N.indices.path];R||(R=""),i=new qr(b,R),N.postModify(i);break}}if(i==null)throw z$(e);return i}}class K${constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function H$(n,e,t){let i=1,r=null,s=null,o=!1,a=0;function u(){return a===2}let h=!1;function d(...w){h||(h=!0,e.apply(null,w))}function g(w){r=setTimeout(()=>{r=null,n(v,u())},w)}function m(){s&&clearTimeout(s)}function v(w,...A){if(h){m();return}if(w){m(),d.call(null,w,...A);return}if(u()||o){m(),d.call(null,w,...A);return}i<64&&(i*=2);let M;a===1?(a=2,M=0):M=(i+Math.random())*1e3,g(M)}let y=!1;function T(w){y||(y=!0,m(),!h&&(r!==null?(w||(a=2),clearTimeout(r),g(0)):w||(a=1)))}return g(0),s=setTimeout(()=>{o=!0,T(!0)},t),T}function q$(n){n(!1)}function X$(n){return n!==void 0}function JP(n,e,t,i){if(i<e)throw QP(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw QP(`Invalid value for '${n}'. Expected ${t} or less.`)}function Y$(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const r=e(i)+"="+e(n[i]);t=t+r+"&"}return t=t.slice(0,-1),t}var Y_;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(Y_||(Y_={}));function Z$(n,e){const t=n>=500&&n<600,r=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||r||s}class Q${constructor(e,t,i,r,s,o,a,u,h,d,g,m=!0,v=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=r,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=u,this.timeout_=h,this.progressCallback_=d,this.connectionFactory_=g,this.retry=m,this.isUsingEmulator=v,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((y,T)=>{this.resolve_=y,this.reject_=T,this.start_()})}start_(){const e=(i,r)=>{if(r){i(!1,new Ap(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=a=>{const u=a.loaded,h=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,h)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const a=s.getErrorCode()===Y_.NO_ERROR,u=s.getStatus();if(!a||Z$(u,this.additionalRetryCodes_)&&this.retry){const d=s.getErrorCode()===Y_.ABORT;i(!1,new Ap(!1,null,d));return}const h=this.successCodes_.indexOf(u)!==-1;i(!0,new Ap(h,s))})},t=(i,r)=>{const s=this.resolve_,o=this.reject_,a=r.connection;if(r.wasSuccessCode)try{const u=this.callback_(a,a.getResponse());X$(u)?s(u):s()}catch(u){o(u)}else if(a!==null){const u=j$();u.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,u)):o(u)}else if(r.canceled){const u=this.appDelete_?kD():B$();o(u)}else{const u=U$();o(u)}};this.canceled_?t(!1,new Ap(!1,null,!0)):this.backoffId_=H$(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&q$(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Ap{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function J$(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function eW(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function tW(n,e){e&&(n["X-Firebase-GMPID"]=e)}function nW(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function iW(n,e,t,i,r,s,o=!0,a=!1){const u=Y$(n.urlParams),h=n.url+u,d=Object.assign({},n.headers);return tW(d,e),J$(d,t),eW(d,s),nW(d,i),new Q$(h,n.method,d,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,r,o,a)}function rW(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function sW(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}class Z_{constructor(e,t){this._service=e,t instanceof qr?this._location=t:this._location=qr.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Z_(e,t)}get root(){const e=new qr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return sW(this._location.path)}get storage(){return this._service}get parent(){const e=rW(this._location.path);if(e===null)return null;const t=new qr(this._location.bucket,e);return new Z_(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw W$(e)}}function eC(n,e){const t=e?.[V$];return t==null?null:qr.makeFromBucketSpec(t,n)}function oW(n,e,t,i={}){n.host=`${e}:${t}`;const r=Su(e);r&&(Sx(`https://${n.host}/b`),Tx("Storage",!0)),n._isUsingEmulator=!0,n._protocol=r?"https":"http";const{mockUserToken:s}=i;s&&(n._overrideAuthToken=typeof s=="string"?s:N4(s,n.app.options.projectId))}class aW{constructor(e,t,i,r,s,o=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=r,this._firebaseVersion=s,this._isUsingEmulator=o,this._bucket=null,this._host=LD,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=F$,this._maxUploadRetryTime=G$,this._requests=new Set,r!=null?this._bucket=qr.makeFromBucketSpec(r,this._host):this._bucket=eC(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=qr.makeFromBucketSpec(this._url,e):this._bucket=eC(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){JP("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){JP("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if($r(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Z_(this,e)}_makeRequest(e,t,i,r,s=!0){if(this._deleted)return new K$(kD());{const o=iW(e,this._appId,i,r,t,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[i,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,r).getPromise()}}const tC="@firebase/storage",nC="0.14.0";const DD="storage";function lW(n=Rx(),e){n=ni(n);const i=F0(n,DD).getImmediate({identifier:e}),r=L4("storage");return r&&uW(i,...r),i}function uW(n,e,t,i={}){oW(n,e,t,i)}function cW(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),r=n.getProvider("app-check-internal");return new aW(t,i,r,e,Tu)}function hW(){lu(new Na(DD,cW,"PUBLIC").setMultipleInstances(!0)),Rs(tC,nC,""),Rs(tC,nC,"esm2020")}hW();const dW={apiKey:"REPLACE_WITH_YOUR_API_KEY",authDomain:"your-project.firebaseapp.com",projectId:"your-project-id",storageBucket:"your-project.appspot.com",messagingSenderId:"123456789",appId:"1:123456789:web:abcdef"},RS=B4(dW);N$(RS);const Jd=fB(RS);lW(RS);gB(Jd).catch(n=>{n.code==="failed-precondition"?console.warn("Offline persistence failed: Multiple tabs open"):n.code==="unimplemented"&&console.warn("Offline persistence not available in this browser")});wu()(xu((n,e)=>({vondsten:[],loading:!1,error:null,loadVondsten:async t=>{n(i=>{i.loading=!0});try{const i=RB(CP(Jd,"vondsten"),PB("userId","==",t)),s=(await kB(i)).docs.map(o=>({id:o.id,...o.data()}));n(o=>{o.vondsten=s,o.loading=!1})}catch(i){n(r=>{r.error=i.message,r.loading=!1})}},addVondst:async t=>{const i=new Date().toISOString(),r={...t,createdAt:i,updatedAt:i},s=await OB(CP(Jd,"vondsten"),r);return n(o=>{o.vondsten.push({...r,id:s.id})}),s.id},updateVondst:async(t,i)=>{const r=sw(Jd,"vondsten",t);await DB(r,{...i,updatedAt:new Date().toISOString()}),n(s=>{const o=s.vondsten.findIndex(a=>a.id===t);o!==-1&&(s.vondsten[o]={...s.vondsten[o],...i})})},deleteVondst:async t=>{await NB(sw(Jd,"vondsten",t)),n(i=>{i.vondsten=i.vondsten.filter(r=>r.id!==t)})}})));function fW({target:n,viewOptions:e}){const t=ne.useRef(null),i=Hi(r=>r.setMap);return ne.useEffect(()=>{if(!t.current){const r={center:[5.1214,52.0907],zoom:8,rotation:0,minZoom:3,maxZoom:19,...e},s=new jF({target:n,view:new Ss({center:Aa(r.center),zoom:r.zoom,rotation:r.rotation,minZoom:r.minZoom,maxZoom:r.maxZoom})});t.current=s,i(s),window.__olMap=s}return()=>{t.current&&(t.current.setTarget(void 0),i(null),window.__olMap=null)}},[n,e,i]),t.current}const gW="https://router.project-osrm.org/route/v1/driving";function mW(n,e){const t={depart:"Start de route",arrive:"U bent aangekomen","turn-left":"Sla linksaf","turn-right":"Sla rechtsaf","turn-slight-left":"Houd links aan","turn-slight-right":"Houd rechts aan","turn-sharp-left":"Sla scherp linksaf","turn-sharp-right":"Sla scherp rechtsaf",uturn:"Keer om",straight:"Ga rechtdoor",merge:"Voeg in","on-ramp":"Neem de oprit","off-ramp":"Neem de afrit","fork-left":"Houd links aan bij de splitsing","fork-right":"Houd rechts aan bij de splitsing","end-of-road-left":"Sla linksaf aan het einde van de weg","end-of-road-right":"Sla rechtsaf aan het einde van de weg",roundabout:"Neem de rotonde",rotary:"Neem de rotonde",continue:"Blijf de weg volgen",notification:"Let op"},i=e?`${n}-${e}`:n;return t[i]||t[n]||"Volg de route"}function iC(n,e){const i=(e.lat-n.lat)*Math.PI/180,r=(e.lng-n.lng)*Math.PI/180,s=Math.sin(i/2)*Math.sin(i/2)+Math.cos(n.lat*Math.PI/180)*Math.cos(e.lat*Math.PI/180)*Math.sin(r/2)*Math.sin(r/2);return 6371e3*(2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s)))}const tn=wu()(xu((n,e)=>({isNavigating:!1,destination:null,destinationName:null,routeCoordinates:null,distance:null,duration:null,loading:!1,error:null,steps:[],currentStepIndex:0,voiceEnabled:!0,lastSpokenStep:-1,lastSpokenTime:0,lastSpokenDistance:-1,startNavigation:async(t,i,r)=>{n(s=>{s.loading=!0,s.error=null});try{const s=`${gW}/${r.lng},${r.lat};${t.lng},${t.lat}?overview=full&geometries=geojson&steps=true`,o=await fetch(s);if(!o.ok)throw new Error("Route berekening mislukt");const a=await o.json();if(a.code==="Ok"&&a.routes&&a.routes.length>0){const u=a.routes[0],h=u.geometry.coordinates.map(g=>({lng:g[0],lat:g[1]})),d=[];if(u.legs&&u.legs[0]&&u.legs[0].steps)for(const g of u.legs[0].steps){const m=g.maneuver?.type||"continue",v=g.maneuver?.modifier;d.push({instruction:mW(m,v),maneuver:v?`${m}-${v}`:m,distance:g.distance||0,duration:g.duration||0,location:{lng:g.maneuver?.location?.[0]||r.lng,lat:g.maneuver?.location?.[1]||r.lat}})}if(n(g=>{g.isNavigating=!0,g.destination=t,g.destinationName=i,g.routeCoordinates=h,g.distance=u.distance,g.duration=u.duration,g.steps=d,g.currentStepIndex=0,g.lastSpokenStep=-1,g.loading=!1}),d.length>0){const g=d[0],m=g.distance>1e3?`${(g.distance/1e3).toFixed(1)} kilometer`:`${Math.round(g.distance)} meter`;e().speakInstruction(`${g.instruction}. Over ${m}.`)}console.log(` Navigation started to ${i}`),console.log(` Distance: ${(u.distance/1e3).toFixed(1)} km`),console.log(` Duration: ${Math.round(u.duration/60)} min`),console.log(` Steps: ${d.length}`)}else throw new Error(a.message||"Geen route gevonden")}catch(s){console.error("Navigation error:",s),n(o=>{o.loading=!1,o.error=s.message||"Navigatie fout"})}},stopNavigation:()=>{"speechSynthesis"in window&&window.speechSynthesis.cancel(),n(t=>{t.isNavigating=!1,t.destination=null,t.destinationName=null,t.routeCoordinates=null,t.distance=null,t.duration=null,t.error=null,t.steps=[],t.currentStepIndex=0,t.lastSpokenStep=-1,t.lastSpokenTime=0,t.lastSpokenDistance=-1}),console.log(" Navigation stopped")},clearError:()=>{n(t=>{t.error=null})},updateCurrentStep:t=>{const{steps:i,currentStepIndex:r,lastSpokenStep:s,lastSpokenTime:o,lastSpokenDistance:a,voiceEnabled:u}=e();if(i.length===0)return;const h=Date.now(),d=5e3;let g=r;for(let m=r;m<i.length;m++){const v=i[m].location;iC(t,v)<30&&(g=Math.min(m+1,i.length-1))}if(g!==r&&(n(m=>{m.currentStepIndex=g}),u&&g!==s&&g<i.length&&h-o>d)){const m=i[g],v=m.distance>1e3?`${(m.distance/1e3).toFixed(1)} kilometer`:`${Math.round(m.distance)} meter`;e().speakInstruction(`${m.instruction}. Over ${v}.`),n(y=>{y.lastSpokenStep=g,y.lastSpokenTime=h,y.lastSpokenDistance=-1})}if(u&&r<i.length){const m=i[r],v=iC(t,m.location);if(h-o<d)return;const y=[200,100,50];for(const T of y)if(v<=T&&v>T-30&&(a===-1||Math.abs(a-T)>30)&&m.maneuver!=="depart"&&m.maneuver!=="arrive"){e().speakInstruction(`Over ${T} meter, ${m.instruction.toLowerCase()}.`),n(w=>{w.lastSpokenTime=h,w.lastSpokenDistance=T});break}}},setVoiceEnabled:t=>{n(i=>{i.voiceEnabled=t}),!t&&"speechSynthesis"in window&&window.speechSynthesis.cancel()},speakInstruction:t=>{if(e().voiceEnabled&&"speechSynthesis"in window){window.speechSynthesis.cancel();const i=new SpeechSynthesisUtterance(t);i.lang="nl-NL",i.rate=1,i.pitch=1,i.volume=1;const s=window.speechSynthesis.getVoices().find(o=>o.lang.startsWith("nl"));s&&(i.voice=s),window.speechSynthesis.speak(i),console.log(` Speaking: ${t}`)}}})));function pW(){const n=ne.useRef(null);fW({target:"map"});const e=Hi(o=>o.map),t=lo(o=>o.registerLayer),i=tn(o=>o.isNavigating);ne.useEffect(()=>{if(!e){console.warn(" Map not initialized yet");return}console.log(" Initializing map layers...");const o=new Rl({properties:{title:"OpenStreetMap",type:"base"},visible:!1,source:new rF}),a=new Rl({properties:{title:"CartoDB Positron",type:"base"},visible:!0,source:new qd({url:"https://{a-d}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO"})}),u=new Rl({properties:{title:"Satellite",type:"base"},visible:!1,source:new qd({url:"https://mt{0-3}.google.com/vt/lyrs=y&x={x}&y={y}&z={z}",attributions:" Google"})}),h=new Rl({properties:{title:"TMK 1850",type:"base"},visible:!1,source:new qd({url:"https://s.map5.nl/map/gast/tiles/tmk_1850/EPSG3857/{z}/{x}/{y}.png",attributions:" Kadaster / Map5.nl",crossOrigin:"anonymous",maxZoom:14})}),d=new Rl({properties:{title:"Bonnebladen 1900",type:"base"},visible:!1,source:new qd({url:"https://s.map5.nl/map/gast/tiles/bonne_1900/EPSG3857/{z}/{x}/{y}.png",attributions:" Kadaster / Map5.nl",crossOrigin:"anonymous",maxZoom:14})}),m=An("EPSG:3857").getExtent(),v=st(m)/256,y=[],T=[];for(let A=6;A<=14;++A)y.push(v/Math.pow(2,A)),T.push(A.toString());const w=new Rl({properties:{title:"Carte Cassini",type:"base"},visible:!1,minZoom:6,maxZoom:14,source:new uF({url:"https://data.geopf.fr/wmts",layer:"BNF-IGNF_GEOGRAPHICALGRIDSYSTEMS.CASSINI",matrixSet:"PM_6_14",format:"image/png",style:"normal",tileGrid:new G8({origin:Ka(m),resolutions:y,matrixIds:T}),attributions:" IGN France / BnF - Carte de Cassini",crossOrigin:"anonymous"})});e.addLayer(o),e.addLayer(a),e.addLayer(u),e.addLayer(h),e.addLayer(d),e.addLayer(w),console.log(" Base layers added:",{osm:o.getVisible(),cartodb:a.getVisible(),satellite:u.getVisible()}),t("OpenStreetMap",o),t("CartoDB Positron",a),t("Satellite",u),t("TMK 1850",h),t("Bonnebladen 1900",d),t("Carte Cassini",w),e.updateSize(),console.log(" Map size:",e.getSize()),console.log(" Map center:",e.getView().getCenter()),console.log(" Map zoom:",e.getView().getZoom()),r()},[e,t]);async function r(){if(!e){console.error(" Cannot load layers: map is null");return}const o=g9();console.log(` Loading ${o.length} immediate-load layers (WMS/Tile)...`);const a=await Promise.allSettled(o.map(async h=>{try{const d=await h.factory();return d?{name:h.name,layer:d}:null}catch(d){return console.warn(` Failed to create ${h.name}:`,d),null}}));let u=0;a.forEach(h=>{if(h.status==="fulfilled"&&h.value){const{name:d,layer:g}=h.value;e.addLayer(g),t(d,g),u++,console.log(`   ${d}`)}}),console.log(` Immediate layers loaded: ${u}/${o.length}`),console.log(` Total layers on map: ${e.getLayers().getLength()}`),console.log(" Vector layers will load on first toggle (lazy loading enabled)")}const s={width:"100%",height:"100vh",transition:"transform 0.5s ease-out",transformOrigin:"center bottom",...i?{transform:"perspective(1000px) rotateX(25deg) scale(1.1)"}:{}};return G.jsx("div",{id:"map",ref:n,style:s})}const PS=ne.createContext({});function CS(n){const e=ne.useRef(null);return e.current===null&&(e.current=n()),e.current}const uy=ne.createContext(null),MS=ne.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});class _W extends ne.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const i=this.props.sizeRef.current;i.height=t.offsetHeight||0,i.width=t.offsetWidth||0,i.top=t.offsetTop,i.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function yW({children:n,isPresent:e}){const t=ne.useId(),i=ne.useRef(null),r=ne.useRef({width:0,height:0,top:0,left:0}),{nonce:s}=ne.useContext(MS);return ne.useInsertionEffect(()=>{const{width:o,height:a,top:u,left:h}=r.current;if(e||!i.current||!o||!a)return;i.current.dataset.motionPopId=t;const d=document.createElement("style");return s&&(d.nonce=s),document.head.appendChild(d),d.sheet&&d.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${a}px !important;
            top: ${u}px !important;
            left: ${h}px !important;
          }
        `),()=>{document.head.removeChild(d)}},[e]),G.jsx(_W,{isPresent:e,childRef:i,sizeRef:r,children:ne.cloneElement(n,{ref:i})})}const vW=({children:n,initial:e,isPresent:t,onExitComplete:i,custom:r,presenceAffectsLayout:s,mode:o})=>{const a=CS(EW),u=ne.useId(),h=ne.useCallback(g=>{a.set(g,!0);for(const m of a.values())if(!m)return;i&&i()},[a,i]),d=ne.useMemo(()=>({id:u,initial:e,isPresent:t,custom:r,onExitComplete:h,register:g=>(a.set(g,!1),()=>a.delete(g))}),s?[Math.random(),h]:[t,h]);return ne.useMemo(()=>{a.forEach((g,m)=>a.set(m,!1))},[t]),ne.useEffect(()=>{!t&&!a.size&&i&&i()},[t]),o==="popLayout"&&(n=G.jsx(yW,{isPresent:t,children:n})),G.jsx(uy.Provider,{value:d,children:n})};function EW(){return new Map}function ND(n=!0){const e=ne.useContext(uy);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:i,register:r}=e,s=ne.useId();ne.useEffect(()=>{n&&r(s)},[n]);const o=ne.useCallback(()=>n&&i&&i(s),[s,i,n]);return!t&&i?[!1,o]:[!0]}const Rp=n=>n.key||"";function rC(n){const e=[];return ne.Children.forEach(n,t=>{ne.isValidElement(t)&&e.push(t)}),e}const bS=typeof window<"u",OD=bS?ne.useLayoutEffect:ne.useEffect,Ru=({children:n,custom:e,initial:t=!0,onExitComplete:i,presenceAffectsLayout:r=!0,mode:s="sync",propagate:o=!1})=>{const[a,u]=ND(o),h=ne.useMemo(()=>rC(n),[n]),d=o&&!a?[]:h.map(Rp),g=ne.useRef(!0),m=ne.useRef(h),v=CS(()=>new Map),[y,T]=ne.useState(h),[w,A]=ne.useState(h);OD(()=>{g.current=!1,m.current=h;for(let k=0;k<w.length;k++){const N=Rp(w[k]);d.includes(N)?v.delete(N):v.get(N)!==!0&&v.set(N,!1)}},[w,d.length,d.join("-")]);const P=[];if(h!==y){let k=[...h];for(let N=0;N<w.length;N++){const B=w[N],b=Rp(B);d.includes(b)||(k.splice(N,0,B),P.push(B))}s==="wait"&&P.length&&(k=P),A(rC(k)),T(h);return}const{forceRender:M}=ne.useContext(PS);return G.jsx(G.Fragment,{children:w.map(k=>{const N=Rp(k),B=o&&!a?!1:h===w||d.includes(N),b=()=>{if(v.has(N))v.set(N,!0);else return;let R=!0;v.forEach(L=>{L||(R=!1)}),R&&(M?.(),A(m.current),o&&u?.(),i&&i())};return G.jsx(vW,{isPresent:B,initial:!g.current||t?void 0:!1,custom:B?void 0:e,presenceAffectsLayout:r,mode:s,onExitComplete:B?void 0:b,children:k},N)})})},qi=n=>n;let VD=qi;function LS(n){let e;return()=>(e===void 0&&(e=n()),e)}const Rh=(n,e,t)=>{const i=e-n;return i===0?1:(t-n)/i},_o=n=>n*1e3,yo=n=>n/1e3,wW={useManualTiming:!1};function xW(n){let e=new Set,t=new Set,i=!1,r=!1;const s=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function a(h){s.has(h)&&(u.schedule(h),n()),h(o)}const u={schedule:(h,d=!1,g=!1)=>{const v=g&&i?e:t;return d&&s.add(h),v.has(h)||v.add(h),h},cancel:h=>{t.delete(h),s.delete(h)},process:h=>{if(o=h,i){r=!0;return}i=!0,[e,t]=[t,e],e.forEach(a),e.clear(),i=!1,r&&(r=!1,u.process(h))}};return u}const Pp=["read","resolveKeyframes","update","preRender","render","postRender"],SW=40;function FD(n,e){let t=!1,i=!0;const r={delta:0,timestamp:0,isProcessing:!1},s=()=>t=!0,o=Pp.reduce((A,P)=>(A[P]=xW(s),A),{}),{read:a,resolveKeyframes:u,update:h,preRender:d,render:g,postRender:m}=o,v=()=>{const A=performance.now();t=!1,r.delta=i?1e3/60:Math.max(Math.min(A-r.timestamp,SW),1),r.timestamp=A,r.isProcessing=!0,a.process(r),u.process(r),h.process(r),d.process(r),g.process(r),m.process(r),r.isProcessing=!1,t&&e&&(i=!1,n(v))},y=()=>{t=!0,i=!0,r.isProcessing||n(v)};return{schedule:Pp.reduce((A,P)=>{const M=o[P];return A[P]=(k,N=!1,B=!1)=>(t||y(),M.schedule(k,N,B)),A},{}),cancel:A=>{for(let P=0;P<Pp.length;P++)o[Pp[P]].cancel(A)},state:r,steps:o}}const{schedule:kt,cancel:Ua,state:Vn,steps:N1}=FD(typeof requestAnimationFrame<"u"?requestAnimationFrame:qi,!0),GD=ne.createContext({strict:!1}),sC={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Ph={};for(const n in sC)Ph[n]={isEnabled:e=>sC[n].some(t=>!!e[t])};function TW(n){for(const e in n)Ph[e]={...Ph[e],...n[e]}}const IW=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Q_(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||IW.has(n)}let jD=n=>!Q_(n);function AW(n){n&&(jD=e=>e.startsWith("on")?!Q_(e):n(e))}try{AW(require("@emotion/is-prop-valid").default)}catch{}function RW(n,e,t){const i={};for(const r in n)r==="values"&&typeof n.values=="object"||(jD(r)||t===!0&&Q_(r)||!e&&!Q_(r)||n.draggable&&r.startsWith("onDrag"))&&(i[r]=n[r]);return i}function PW(n){if(typeof Proxy>"u")return n;const e=new Map,t=(...i)=>n(...i);return new Proxy(t,{get:(i,r)=>r==="create"?n:(e.has(r)||e.set(r,n(r)),e.get(r))})}const cy=ne.createContext({});function rg(n){return typeof n=="string"||Array.isArray(n)}function hy(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}const kS=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],DS=["initial",...kS];function dy(n){return hy(n.animate)||DS.some(e=>rg(n[e]))}function UD(n){return!!(dy(n)||n.variants)}function CW(n,e){if(dy(n)){const{initial:t,animate:i}=n;return{initial:t===!1||rg(t)?t:void 0,animate:rg(i)?i:void 0}}return n.inherit!==!1?e:{}}function MW(n){const{initial:e,animate:t}=CW(n,ne.useContext(cy));return ne.useMemo(()=>({initial:e,animate:t}),[oC(e),oC(t)])}function oC(n){return Array.isArray(n)?n.join(" "):n}const bW=Symbol.for("motionComponentSymbol");function Vc(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function LW(n,e,t){return ne.useCallback(i=>{i&&n.onMount&&n.onMount(i),e&&(i?e.mount(i):e.unmount()),t&&(typeof t=="function"?t(i):Vc(t)&&(t.current=i))},[e])}const NS=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),kW="framerAppearId",BD="data-"+NS(kW),{schedule:OS}=FD(queueMicrotask,!1),zD=ne.createContext({});function DW(n,e,t,i,r){var s,o;const{visualElement:a}=ne.useContext(cy),u=ne.useContext(GD),h=ne.useContext(uy),d=ne.useContext(MS).reducedMotion,g=ne.useRef(null);i=i||u.renderer,!g.current&&i&&(g.current=i(n,{visualState:e,parent:a,props:t,presenceContext:h,blockInitialAnimation:h?h.initial===!1:!1,reducedMotionConfig:d}));const m=g.current,v=ne.useContext(zD);m&&!m.projection&&r&&(m.type==="html"||m.type==="svg")&&NW(g.current,t,r,v);const y=ne.useRef(!1);ne.useInsertionEffect(()=>{m&&y.current&&m.update(t,h)});const T=t[BD],w=ne.useRef(!!T&&!(!((s=window.MotionHandoffIsComplete)===null||s===void 0)&&s.call(window,T))&&((o=window.MotionHasOptimisedAnimation)===null||o===void 0?void 0:o.call(window,T)));return OD(()=>{m&&(y.current=!0,window.MotionIsMounted=!0,m.updateFeatures(),OS.render(m.render),w.current&&m.animationState&&m.animationState.animateChanges())}),ne.useEffect(()=>{m&&(!w.current&&m.animationState&&m.animationState.animateChanges(),w.current&&(queueMicrotask(()=>{var A;(A=window.MotionHandoffMarkAsComplete)===null||A===void 0||A.call(window,T)}),w.current=!1))}),m}function NW(n,e,t,i){const{layoutId:r,layout:s,drag:o,dragConstraints:a,layoutScroll:u,layoutRoot:h}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:$D(n.parent)),n.projection.setOptions({layoutId:r,layout:s,alwaysMeasureLayout:!!o||a&&Vc(a),visualElement:n,animationType:typeof s=="string"?s:"both",initialPromotionConfig:i,layoutScroll:u,layoutRoot:h})}function $D(n){if(n)return n.options.allowProjection!==!1?n.projection:$D(n.parent)}function OW({preloadedFeatures:n,createVisualElement:e,useRender:t,useVisualState:i,Component:r}){var s,o;n&&TW(n);function a(h,d){let g;const m={...ne.useContext(MS),...h,layoutId:VW(h)},{isStatic:v}=m,y=MW(h),T=i(h,v);if(!v&&bS){FW();const w=GW(m);g=w.MeasureLayout,y.visualElement=DW(r,T,m,e,w.ProjectionNode)}return G.jsxs(cy.Provider,{value:y,children:[g&&y.visualElement?G.jsx(g,{visualElement:y.visualElement,...m}):null,t(r,h,LW(T,y.visualElement,d),T,v,y.visualElement)]})}a.displayName=`motion.${typeof r=="string"?r:`create(${(o=(s=r.displayName)!==null&&s!==void 0?s:r.name)!==null&&o!==void 0?o:""})`}`;const u=ne.forwardRef(a);return u[bW]=r,u}function VW({layoutId:n}){const e=ne.useContext(PS).id;return e&&n!==void 0?e+"-"+n:n}function FW(n,e){ne.useContext(GD).strict}function GW(n){const{drag:e,layout:t}=Ph;if(!e&&!t)return{};const i={...e,...t};return{MeasureLayout:e?.isEnabled(n)||t?.isEnabled(n)?i.MeasureLayout:void 0,ProjectionNode:i.ProjectionNode}}const jW=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function VS(n){return typeof n!="string"||n.includes("-")?!1:!!(jW.indexOf(n)>-1||/[A-Z]/u.test(n))}function aC(n){const e=[{},{}];return n?.values.forEach((t,i)=>{e[0][i]=t.get(),e[1][i]=t.getVelocity()}),e}function FS(n,e,t,i){if(typeof e=="function"){const[r,s]=aC(i);e=e(t!==void 0?t:n.custom,r,s)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[r,s]=aC(i);e=e(t!==void 0?t:n.custom,r,s)}return e}const cw=n=>Array.isArray(n),UW=n=>!!(n&&typeof n=="object"&&n.mix&&n.toValue),BW=n=>cw(n)?n[n.length-1]||0:n,ei=n=>!!(n&&n.getVelocity);function Qp(n){const e=ei(n)?n.get():n;return UW(e)?e.toValue():e}function zW({scrapeMotionValuesFromProps:n,createRenderState:e,onUpdate:t},i,r,s){const o={latestValues:$W(i,r,s,n),renderState:e()};return t&&(o.onMount=a=>t({props:i,current:a,...o}),o.onUpdate=a=>t(a)),o}const WD=n=>(e,t)=>{const i=ne.useContext(cy),r=ne.useContext(uy),s=()=>zW(n,e,i,r);return t?s():CS(s)};function $W(n,e,t,i){const r={},s=i(n,{});for(const m in s)r[m]=Qp(s[m]);let{initial:o,animate:a}=n;const u=dy(n),h=UD(n);e&&h&&!u&&n.inherit!==!1&&(o===void 0&&(o=e.initial),a===void 0&&(a=e.animate));let d=t?t.initial===!1:!1;d=d||o===!1;const g=d?a:o;if(g&&typeof g!="boolean"&&!hy(g)){const m=Array.isArray(g)?g:[g];for(let v=0;v<m.length;v++){const y=FS(n,m[v]);if(y){const{transitionEnd:T,transition:w,...A}=y;for(const P in A){let M=A[P];if(Array.isArray(M)){const k=d?M.length-1:0;M=M[k]}M!==null&&(r[P]=M)}for(const P in T)r[P]=T[P]}}}return r}const Fh=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Pu=new Set(Fh),KD=n=>e=>typeof e=="string"&&e.startsWith(n),HD=KD("--"),WW=KD("var(--"),GS=n=>WW(n)?KW.test(n.split("/*")[0].trim()):!1,KW=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,qD=(n,e)=>e&&typeof n=="number"?e.transform(n):n,Io=(n,e,t)=>t>e?e:t<n?n:t,Gh={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},sg={...Gh,transform:n=>Io(0,1,n)},Cp={...Gh,default:1},jg=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),da=jg("deg"),Ls=jg("%"),Fe=jg("px"),HW=jg("vh"),qW=jg("vw"),lC={...Ls,parse:n=>Ls.parse(n)/100,transform:n=>Ls.transform(n*100)},XW={borderWidth:Fe,borderTopWidth:Fe,borderRightWidth:Fe,borderBottomWidth:Fe,borderLeftWidth:Fe,borderRadius:Fe,radius:Fe,borderTopLeftRadius:Fe,borderTopRightRadius:Fe,borderBottomRightRadius:Fe,borderBottomLeftRadius:Fe,width:Fe,maxWidth:Fe,height:Fe,maxHeight:Fe,top:Fe,right:Fe,bottom:Fe,left:Fe,padding:Fe,paddingTop:Fe,paddingRight:Fe,paddingBottom:Fe,paddingLeft:Fe,margin:Fe,marginTop:Fe,marginRight:Fe,marginBottom:Fe,marginLeft:Fe,backgroundPositionX:Fe,backgroundPositionY:Fe},YW={rotate:da,rotateX:da,rotateY:da,rotateZ:da,scale:Cp,scaleX:Cp,scaleY:Cp,scaleZ:Cp,skew:da,skewX:da,skewY:da,distance:Fe,translateX:Fe,translateY:Fe,translateZ:Fe,x:Fe,y:Fe,z:Fe,perspective:Fe,transformPerspective:Fe,opacity:sg,originX:lC,originY:lC,originZ:Fe},uC={...Gh,transform:Math.round},jS={...XW,...YW,zIndex:uC,size:Fe,fillOpacity:sg,strokeOpacity:sg,numOctaves:uC},ZW={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},QW=Fh.length;function JW(n,e,t){let i="",r=!0;for(let s=0;s<QW;s++){const o=Fh[s],a=n[o];if(a===void 0)continue;let u=!0;if(typeof a=="number"?u=a===(o.startsWith("scale")?1:0):u=parseFloat(a)===0,!u||t){const h=qD(a,jS[o]);if(!u){r=!1;const d=ZW[o]||o;i+=`${d}(${h}) `}t&&(e[o]=h)}}return i=i.trim(),t?i=t(e,r?"":i):r&&(i="none"),i}function US(n,e,t){const{style:i,vars:r,transformOrigin:s}=n;let o=!1,a=!1;for(const u in e){const h=e[u];if(Pu.has(u)){o=!0;continue}else if(HD(u)){r[u]=h;continue}else{const d=qD(h,jS[u]);u.startsWith("origin")?(a=!0,s[u]=d):i[u]=d}}if(e.transform||(o||t?i.transform=JW(e,n.transform,t):i.transform&&(i.transform="none")),a){const{originX:u="50%",originY:h="50%",originZ:d=0}=s;i.transformOrigin=`${u} ${h} ${d}`}}const eK={offset:"stroke-dashoffset",array:"stroke-dasharray"},tK={offset:"strokeDashoffset",array:"strokeDasharray"};function nK(n,e,t=1,i=0,r=!0){n.pathLength=1;const s=r?eK:tK;n[s.offset]=Fe.transform(-i);const o=Fe.transform(e),a=Fe.transform(t);n[s.array]=`${o} ${a}`}function cC(n,e,t){return typeof n=="string"?n:Fe.transform(e+t*n)}function iK(n,e,t){const i=cC(e,n.x,n.width),r=cC(t,n.y,n.height);return`${i} ${r}`}function BS(n,{attrX:e,attrY:t,attrScale:i,originX:r,originY:s,pathLength:o,pathSpacing:a=1,pathOffset:u=0,...h},d,g){if(US(n,h,g),d){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:m,style:v,dimensions:y}=n;m.transform&&(y&&(v.transform=m.transform),delete m.transform),y&&(r!==void 0||s!==void 0||v.transform)&&(v.transformOrigin=iK(y,r!==void 0?r:.5,s!==void 0?s:.5)),e!==void 0&&(m.x=e),t!==void 0&&(m.y=t),i!==void 0&&(m.scale=i),o!==void 0&&nK(m,o,a,u,!1)}const zS=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),XD=()=>({...zS(),attrs:{}}),$S=n=>typeof n=="string"&&n.toLowerCase()==="svg";function YD(n,{style:e,vars:t},i,r){Object.assign(n.style,e,r&&r.getProjectionStyles(i));for(const s in t)n.style.setProperty(s,t[s])}const ZD=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function QD(n,e,t,i){YD(n,e,void 0,i);for(const r in e.attrs)n.setAttribute(ZD.has(r)?r:NS(r),e.attrs[r])}const J_={};function rK(n){Object.assign(J_,n)}function JD(n,{layout:e,layoutId:t}){return Pu.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!J_[n]||n==="opacity")}function WS(n,e,t){var i;const{style:r}=n,s={};for(const o in r)(ei(r[o])||e.style&&ei(e.style[o])||JD(o,n)||((i=t?.getValue(o))===null||i===void 0?void 0:i.liveStyle)!==void 0)&&(s[o]=r[o]);return s}function eN(n,e,t){const i=WS(n,e,t);for(const r in n)if(ei(n[r])||ei(e[r])){const s=Fh.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;i[s]=n[r]}return i}function sK(n,e){try{e.dimensions=typeof n.getBBox=="function"?n.getBBox():n.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const hC=["x","y","width","height","cx","cy","r"],oK={useVisualState:WD({scrapeMotionValuesFromProps:eN,createRenderState:XD,onUpdate:({props:n,prevProps:e,current:t,renderState:i,latestValues:r})=>{if(!t)return;let s=!!n.drag;if(!s){for(const a in r)if(Pu.has(a)){s=!0;break}}if(!s)return;let o=!e;if(e)for(let a=0;a<hC.length;a++){const u=hC[a];n[u]!==e[u]&&(o=!0)}o&&kt.read(()=>{sK(t,i),kt.render(()=>{BS(i,r,$S(t.tagName),n.transformTemplate),QD(t,i)})})}})},aK={useVisualState:WD({scrapeMotionValuesFromProps:WS,createRenderState:zS})};function tN(n,e,t){for(const i in e)!ei(e[i])&&!JD(i,t)&&(n[i]=e[i])}function lK({transformTemplate:n},e){return ne.useMemo(()=>{const t=zS();return US(t,e,n),Object.assign({},t.vars,t.style)},[e])}function uK(n,e){const t=n.style||{},i={};return tN(i,t,n),Object.assign(i,lK(n,e)),i}function cK(n,e){const t={},i=uK(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=i,t}function hK(n,e,t,i){const r=ne.useMemo(()=>{const s=XD();return BS(s,e,$S(i),n.transformTemplate),{...s.attrs,style:{...s.style}}},[e]);if(n.style){const s={};tN(s,n.style,n),r.style={...s,...r.style}}return r}function dK(n=!1){return(t,i,r,{latestValues:s},o)=>{const u=(VS(t)?hK:cK)(i,s,o,t),h=RW(i,typeof t=="string",n),d=t!==ne.Fragment?{...h,...u,ref:r}:{},{children:g}=i,m=ne.useMemo(()=>ei(g)?g.get():g,[g]);return ne.createElement(t,{...d,children:m})}}function fK(n,e){return function(i,{forwardMotionProps:r}={forwardMotionProps:!1}){const o={...VS(i)?oK:aK,preloadedFeatures:n,useRender:dK(r),createVisualElement:e,Component:i};return OW(o)}}function nN(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let i=0;i<t;i++)if(e[i]!==n[i])return!1;return!0}function fy(n,e,t){const i=n.getProps();return FS(i,e,t!==void 0?t:i.custom,n)}const gK=LS(()=>window.ScrollTimeline!==void 0);class mK{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,t){for(let i=0;i<this.animations.length;i++)this.animations[i][e]=t}attachTimeline(e,t){const i=this.animations.map(r=>{if(gK()&&r.attachTimeline)return r.attachTimeline(e);if(typeof t=="function")return t(r)});return()=>{i.forEach((r,s)=>{r&&r(),this.animations[s].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let t=0;t<this.animations.length;t++)e=Math.max(e,this.animations[t].duration);return e}runAll(e){this.animations.forEach(t=>t[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class pK extends mK{then(e,t){return Promise.all(this.animations).then(e).catch(t)}}function KS(n,e){return n?n[e]||n.default||n:void 0}const hw=2e4;function iN(n){let e=0;const t=50;let i=n.next(e);for(;!i.done&&e<hw;)e+=t,i=n.next(e);return e>=hw?1/0:e}function HS(n){return typeof n=="function"}function dC(n,e){n.timeline=e,n.onfinish=null}const qS=n=>Array.isArray(n)&&typeof n[0]=="number",_K={linearEasing:void 0};function yK(n,e){const t=LS(n);return()=>{var i;return(i=_K[e])!==null&&i!==void 0?i:t()}}const e0=yK(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),rN=(n,e,t=10)=>{let i="";const r=Math.max(Math.round(e/t),2);for(let s=0;s<r;s++)i+=n(Rh(0,r-1,s))+", ";return`linear(${i.substring(0,i.length-2)})`};function sN(n){return!!(typeof n=="function"&&e0()||!n||typeof n=="string"&&(n in dw||e0())||qS(n)||Array.isArray(n)&&n.every(sN))}const ef=([n,e,t,i])=>`cubic-bezier(${n}, ${e}, ${t}, ${i})`,dw={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:ef([0,.65,.55,1]),circOut:ef([.55,0,1,.45]),backIn:ef([.31,.01,.66,-.59]),backOut:ef([.33,1.53,.69,.99])};function oN(n,e){if(n)return typeof n=="function"&&e0()?rN(n,e):qS(n)?ef(n):Array.isArray(n)?n.map(t=>oN(t,e)||dw.easeOut):dw[n]}const Fr={x:!1,y:!1};function aN(){return Fr.x||Fr.y}function vK(n,e,t){var i;if(n instanceof Element)return[n];if(typeof n=="string"){let r=document;const s=(i=void 0)!==null&&i!==void 0?i:r.querySelectorAll(n);return s?Array.from(s):[]}return Array.from(n)}function lN(n,e){const t=vK(n),i=new AbortController,r={passive:!0,...e,signal:i.signal};return[t,r,()=>i.abort()]}function fC(n){return e=>{e.pointerType==="touch"||aN()||n(e)}}function EK(n,e,t={}){const[i,r,s]=lN(n,t),o=fC(a=>{const{target:u}=a,h=e(a);if(typeof h!="function"||!u)return;const d=fC(g=>{h(g),u.removeEventListener("pointerleave",d)});u.addEventListener("pointerleave",d,r)});return i.forEach(a=>{a.addEventListener("pointerenter",o,r)}),s}const uN=(n,e)=>e?n===e?!0:uN(n,e.parentElement):!1,XS=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,wK=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function xK(n){return wK.has(n.tagName)||n.tabIndex!==-1}const tf=new WeakSet;function gC(n){return e=>{e.key==="Enter"&&n(e)}}function O1(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const SK=(n,e)=>{const t=n.currentTarget;if(!t)return;const i=gC(()=>{if(tf.has(t))return;O1(t,"down");const r=gC(()=>{O1(t,"up")}),s=()=>O1(t,"cancel");t.addEventListener("keyup",r,e),t.addEventListener("blur",s,e)});t.addEventListener("keydown",i,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",i),e)};function mC(n){return XS(n)&&!aN()}function TK(n,e,t={}){const[i,r,s]=lN(n,t),o=a=>{const u=a.currentTarget;if(!mC(a)||tf.has(u))return;tf.add(u);const h=e(a),d=(v,y)=>{window.removeEventListener("pointerup",g),window.removeEventListener("pointercancel",m),!(!mC(v)||!tf.has(u))&&(tf.delete(u),typeof h=="function"&&h(v,{success:y}))},g=v=>{d(v,t.useGlobalTarget||uN(u,v.target))},m=v=>{d(v,!1)};window.addEventListener("pointerup",g,r),window.addEventListener("pointercancel",m,r)};return i.forEach(a=>{!xK(a)&&a.getAttribute("tabindex")===null&&(a.tabIndex=0),(t.useGlobalTarget?window:a).addEventListener("pointerdown",o,r),a.addEventListener("focus",h=>SK(h,r),r)}),s}function IK(n){return n==="x"||n==="y"?Fr[n]?null:(Fr[n]=!0,()=>{Fr[n]=!1}):Fr.x||Fr.y?null:(Fr.x=Fr.y=!0,()=>{Fr.x=Fr.y=!1})}const cN=new Set(["width","height","top","left","right","bottom",...Fh]);let Jp;function AK(){Jp=void 0}const ks={now:()=>(Jp===void 0&&ks.set(Vn.isProcessing||wW.useManualTiming?Vn.timestamp:performance.now()),Jp),set:n=>{Jp=n,queueMicrotask(AK)}};function YS(n,e){n.indexOf(e)===-1&&n.push(e)}function ZS(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}class QS{constructor(){this.subscriptions=[]}add(e){return YS(this.subscriptions,e),()=>ZS(this.subscriptions,e)}notify(e,t,i){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](e,t,i);else for(let s=0;s<r;s++){const o=this.subscriptions[s];o&&o(e,t,i)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function hN(n,e){return e?n*(1e3/e):0}const pC=30,RK=n=>!isNaN(parseFloat(n));class PK{constructor(e,t={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(i,r=!0)=>{const s=ks.now();this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(i),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),r&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=ks.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=RK(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new QS);const i=this.events[e].add(t);return e==="change"?()=>{i(),kt.read(()=>{this.events.change.getSize()||this.stop()})}:i}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e,t=!0){!t||!this.passiveEffect?this.updateAndNotify(e,t):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,t,i){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-i}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=ks.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>pC)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,pC);return hN(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function og(n,e){return new PK(n,e)}function CK(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,og(t))}function MK(n,e){const t=fy(n,e);let{transitionEnd:i={},transition:r={},...s}=t||{};s={...s,...i};for(const o in s){const a=BW(s[o]);CK(n,o,a)}}function bK(n){return!!(ei(n)&&n.add)}function fw(n,e){const t=n.getValue("willChange");if(bK(t))return t.add(e)}function dN(n){return n.props[BD]}const fN=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,LK=1e-7,kK=12;function DK(n,e,t,i,r){let s,o,a=0;do o=e+(t-e)/2,s=fN(o,i,r)-n,s>0?t=o:e=o;while(Math.abs(s)>LK&&++a<kK);return o}function Ug(n,e,t,i){if(n===e&&t===i)return qi;const r=s=>DK(s,0,1,n,t);return s=>s===0||s===1?s:fN(r(s),e,i)}const gN=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,mN=n=>e=>1-n(1-e),pN=Ug(.33,1.53,.69,.99),JS=mN(pN),_N=gN(JS),yN=n=>(n*=2)<1?.5*JS(n):.5*(2-Math.pow(2,-10*(n-1))),eT=n=>1-Math.sin(Math.acos(n)),vN=mN(eT),EN=gN(eT),wN=n=>/^0[^.\s]+$/u.test(n);function NK(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||wN(n):!0}const Ef=n=>Math.round(n*1e5)/1e5,tT=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function OK(n){return n==null}const VK=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,nT=(n,e)=>t=>!!(typeof t=="string"&&VK.test(t)&&t.startsWith(n)||e&&!OK(t)&&Object.prototype.hasOwnProperty.call(t,e)),xN=(n,e,t)=>i=>{if(typeof i!="string")return i;const[r,s,o,a]=i.match(tT);return{[n]:parseFloat(r),[e]:parseFloat(s),[t]:parseFloat(o),alpha:a!==void 0?parseFloat(a):1}},FK=n=>Io(0,255,n),V1={...Gh,transform:n=>Math.round(FK(n))},Kl={test:nT("rgb","red"),parse:xN("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:i=1})=>"rgba("+V1.transform(n)+", "+V1.transform(e)+", "+V1.transform(t)+", "+Ef(sg.transform(i))+")"};function GK(n){let e="",t="",i="",r="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),i=n.substring(5,7),r=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),i=n.substring(3,4),r=n.substring(4,5),e+=e,t+=t,i+=i,r+=r),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(i,16),alpha:r?parseInt(r,16)/255:1}}const gw={test:nT("#"),parse:GK,transform:Kl.transform},Fc={test:nT("hsl","hue"),parse:xN("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:i=1})=>"hsla("+Math.round(n)+", "+Ls.transform(Ef(e))+", "+Ls.transform(Ef(t))+", "+Ef(sg.transform(i))+")"},qn={test:n=>Kl.test(n)||gw.test(n)||Fc.test(n),parse:n=>Kl.test(n)?Kl.parse(n):Fc.test(n)?Fc.parse(n):gw.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?Kl.transform(n):Fc.transform(n)},jK=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function UK(n){var e,t;return isNaN(n)&&typeof n=="string"&&(((e=n.match(tT))===null||e===void 0?void 0:e.length)||0)+(((t=n.match(jK))===null||t===void 0?void 0:t.length)||0)>0}const SN="number",TN="color",BK="var",zK="var(",_C="${}",$K=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function ag(n){const e=n.toString(),t=[],i={color:[],number:[],var:[]},r=[];let s=0;const a=e.replace($K,u=>(qn.test(u)?(i.color.push(s),r.push(TN),t.push(qn.parse(u))):u.startsWith(zK)?(i.var.push(s),r.push(BK),t.push(u)):(i.number.push(s),r.push(SN),t.push(parseFloat(u))),++s,_C)).split(_C);return{values:t,split:a,indexes:i,types:r}}function IN(n){return ag(n).values}function AN(n){const{split:e,types:t}=ag(n),i=e.length;return r=>{let s="";for(let o=0;o<i;o++)if(s+=e[o],r[o]!==void 0){const a=t[o];a===SN?s+=Ef(r[o]):a===TN?s+=qn.transform(r[o]):s+=r[o]}return s}}const WK=n=>typeof n=="number"?0:n;function KK(n){const e=IN(n);return AN(n)(e.map(WK))}const Ba={test:UK,parse:IN,createTransformer:AN,getAnimatableNone:KK},HK=new Set(["brightness","contrast","saturate","opacity"]);function qK(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[i]=t.match(tT)||[];if(!i)return n;const r=t.replace(i,"");let s=HK.has(e)?1:0;return i!==t&&(s*=100),e+"("+s+r+")"}const XK=/\b([a-z-]*)\(.*?\)/gu,mw={...Ba,getAnimatableNone:n=>{const e=n.match(XK);return e?e.map(qK).join(" "):n}},YK={...jS,color:qn,backgroundColor:qn,outlineColor:qn,fill:qn,stroke:qn,borderColor:qn,borderTopColor:qn,borderRightColor:qn,borderBottomColor:qn,borderLeftColor:qn,filter:mw,WebkitFilter:mw},iT=n=>YK[n];function RN(n,e){let t=iT(n);return t!==mw&&(t=Ba),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const ZK=new Set(["auto","none","0"]);function QK(n,e,t){let i=0,r;for(;i<n.length&&!r;){const s=n[i];typeof s=="string"&&!ZK.has(s)&&ag(s).values.length&&(r=n[i]),i++}if(r&&t)for(const s of e)n[s]=RN(t,r)}const yC=n=>n===Gh||n===Fe,vC=(n,e)=>parseFloat(n.split(", ")[e]),EC=(n,e)=>(t,{transform:i})=>{if(i==="none"||!i)return 0;const r=i.match(/^matrix3d\((.+)\)$/u);if(r)return vC(r[1],e);{const s=i.match(/^matrix\((.+)\)$/u);return s?vC(s[1],n):0}},JK=new Set(["x","y","z"]),eH=Fh.filter(n=>!JK.has(n));function tH(n){const e=[];return eH.forEach(t=>{const i=n.getValue(t);i!==void 0&&(e.push([t,i.get()]),i.set(t.startsWith("scale")?1:0))}),e}const Ch={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:EC(4,13),y:EC(5,14)};Ch.translateX=Ch.x;Ch.translateY=Ch.y;const Ql=new Set;let pw=!1,_w=!1;function PN(){if(_w){const n=Array.from(Ql).filter(i=>i.needsMeasurement),e=new Set(n.map(i=>i.element)),t=new Map;e.forEach(i=>{const r=tH(i);r.length&&(t.set(i,r),i.render())}),n.forEach(i=>i.measureInitialState()),e.forEach(i=>{i.render();const r=t.get(i);r&&r.forEach(([s,o])=>{var a;(a=i.getValue(s))===null||a===void 0||a.set(o)})}),n.forEach(i=>i.measureEndState()),n.forEach(i=>{i.suspendedScrollY!==void 0&&window.scrollTo(0,i.suspendedScrollY)})}_w=!1,pw=!1,Ql.forEach(n=>n.complete()),Ql.clear()}function CN(){Ql.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(_w=!0)})}function nH(){CN(),PN()}class rT{constructor(e,t,i,r,s,o=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=i,this.motionValue=r,this.element=s,this.isAsync=o}scheduleResolve(){this.isScheduled=!0,this.isAsync?(Ql.add(this),pw||(pw=!0,kt.read(CN),kt.resolveKeyframes(PN))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:i,motionValue:r}=this;for(let s=0;s<e.length;s++)if(e[s]===null)if(s===0){const o=r?.get(),a=e[e.length-1];if(o!==void 0)e[0]=o;else if(i&&t){const u=i.readValue(t,a);u!=null&&(e[0]=u)}e[0]===void 0&&(e[0]=a),r&&o===void 0&&r.set(e[0])}else e[s]=e[s-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),Ql.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,Ql.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const MN=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n),iH=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function rH(n){const e=iH.exec(n);if(!e)return[,];const[,t,i,r]=e;return[`--${t??i}`,r]}function bN(n,e,t=1){const[i,r]=rH(n);if(!i)return;const s=window.getComputedStyle(e).getPropertyValue(i);if(s){const o=s.trim();return MN(o)?parseFloat(o):o}return GS(r)?bN(r,e,t+1):r}const LN=n=>e=>e.test(n),sH={test:n=>n==="auto",parse:n=>n},kN=[Gh,Fe,Ls,da,qW,HW,sH],wC=n=>kN.find(LN(n));class DN extends rT{constructor(e,t,i,r,s){super(e,t,i,r,s,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:i}=this;if(!t||!t.current)return;super.readKeyframes();for(let u=0;u<e.length;u++){let h=e[u];if(typeof h=="string"&&(h=h.trim(),GS(h))){const d=bN(h,t.current);d!==void 0&&(e[u]=d),u===e.length-1&&(this.finalKeyframe=h)}}if(this.resolveNoneKeyframes(),!cN.has(i)||e.length!==2)return;const[r,s]=e,o=wC(r),a=wC(s);if(o!==a)if(yC(o)&&yC(a))for(let u=0;u<e.length;u++){const h=e[u];typeof h=="string"&&(e[u]=parseFloat(h))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,i=[];for(let r=0;r<e.length;r++)NK(e[r])&&i.push(r);i.length&&QK(e,i,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:i}=this;if(!e||!e.current)return;i==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Ch[i](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const r=t[t.length-1];r!==void 0&&e.getValue(i,r).jump(r,!1)}measureEndState(){var e;const{element:t,name:i,unresolvedKeyframes:r}=this;if(!t||!t.current)return;const s=t.getValue(i);s&&s.jump(this.measuredOrigin,!1);const o=r.length-1,a=r[o];r[o]=Ch[i](t.measureViewportBox(),window.getComputedStyle(t.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([u,h])=>{t.getValue(u).set(h)}),this.resolveNoneKeyframes()}}const xC=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(Ba.test(n)||n==="0")&&!n.startsWith("url("));function oH(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function aH(n,e,t,i){const r=n[0];if(r===null)return!1;if(e==="display"||e==="visibility")return!0;const s=n[n.length-1],o=xC(r,e),a=xC(s,e);return!o||!a?!1:oH(n)||(t==="spring"||HS(t))&&i}const lH=n=>n!==null;function gy(n,{repeat:e,repeatType:t="loop"},i){const r=n.filter(lH),s=e&&t!=="loop"&&e%2===1?0:r.length-1;return!s||i===void 0?r[s]:i}const uH=40;class NN{constructor({autoplay:e=!0,delay:t=0,type:i="keyframes",repeat:r=0,repeatDelay:s=0,repeatType:o="loop",...a}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=ks.now(),this.options={autoplay:e,delay:t,type:i,repeat:r,repeatDelay:s,repeatType:o,...a},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>uH?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&nH(),this._resolved}onKeyframesResolved(e,t){this.resolvedAt=ks.now(),this.hasAttemptedResolve=!0;const{name:i,type:r,velocity:s,delay:o,onComplete:a,onUpdate:u,isGenerator:h}=this.options;if(!h&&!aH(e,i,r,s))if(o)this.options.duration=0;else{u&&u(gy(e,this.options,t)),a&&a(),this.resolveFinishedPromise();return}const d=this.initPlayback(e,t);d!==!1&&(this._resolved={keyframes:e,finalKeyframe:t,...d},this.onPostResolved())}onPostResolved(){}then(e,t){return this.currentFinishedPromise.then(e,t)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const $t=(n,e,t)=>n+(e-n)*t;function F1(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function cH({hue:n,saturation:e,lightness:t,alpha:i}){n/=360,e/=100,t/=100;let r=0,s=0,o=0;if(!e)r=s=o=t;else{const a=t<.5?t*(1+e):t+e-t*e,u=2*t-a;r=F1(u,a,n+1/3),s=F1(u,a,n),o=F1(u,a,n-1/3)}return{red:Math.round(r*255),green:Math.round(s*255),blue:Math.round(o*255),alpha:i}}function t0(n,e){return t=>t>0?e:n}const G1=(n,e,t)=>{const i=n*n,r=t*(e*e-i)+i;return r<0?0:Math.sqrt(r)},hH=[gw,Kl,Fc],dH=n=>hH.find(e=>e.test(n));function SC(n){const e=dH(n);if(!e)return!1;let t=e.parse(n);return e===Fc&&(t=cH(t)),t}const TC=(n,e)=>{const t=SC(n),i=SC(e);if(!t||!i)return t0(n,e);const r={...t};return s=>(r.red=G1(t.red,i.red,s),r.green=G1(t.green,i.green,s),r.blue=G1(t.blue,i.blue,s),r.alpha=$t(t.alpha,i.alpha,s),Kl.transform(r))},fH=(n,e)=>t=>e(n(t)),Bg=(...n)=>n.reduce(fH),yw=new Set(["none","hidden"]);function gH(n,e){return yw.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function mH(n,e){return t=>$t(n,e,t)}function sT(n){return typeof n=="number"?mH:typeof n=="string"?GS(n)?t0:qn.test(n)?TC:yH:Array.isArray(n)?ON:typeof n=="object"?qn.test(n)?TC:pH:t0}function ON(n,e){const t=[...n],i=t.length,r=n.map((s,o)=>sT(s)(s,e[o]));return s=>{for(let o=0;o<i;o++)t[o]=r[o](s);return t}}function pH(n,e){const t={...n,...e},i={};for(const r in t)n[r]!==void 0&&e[r]!==void 0&&(i[r]=sT(n[r])(n[r],e[r]));return r=>{for(const s in i)t[s]=i[s](r);return t}}function _H(n,e){var t;const i=[],r={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const o=e.types[s],a=n.indexes[o][r[o]],u=(t=n.values[a])!==null&&t!==void 0?t:0;i[s]=u,r[o]++}return i}const yH=(n,e)=>{const t=Ba.createTransformer(e),i=ag(n),r=ag(e);return i.indexes.var.length===r.indexes.var.length&&i.indexes.color.length===r.indexes.color.length&&i.indexes.number.length>=r.indexes.number.length?yw.has(n)&&!r.values.length||yw.has(e)&&!i.values.length?gH(n,e):Bg(ON(_H(i,r),r.values),t):t0(n,e)};function VN(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?$t(n,e,t):sT(n)(n,e)}const vH=5;function FN(n,e,t){const i=Math.max(e-vH,0);return hN(t-n(i),e-i)}const qt={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},j1=.001;function EH({duration:n=qt.duration,bounce:e=qt.bounce,velocity:t=qt.velocity,mass:i=qt.mass}){let r,s,o=1-e;o=Io(qt.minDamping,qt.maxDamping,o),n=Io(qt.minDuration,qt.maxDuration,yo(n)),o<1?(r=h=>{const d=h*o,g=d*n,m=d-t,v=vw(h,o),y=Math.exp(-g);return j1-m/v*y},s=h=>{const g=h*o*n,m=g*t+t,v=Math.pow(o,2)*Math.pow(h,2)*n,y=Math.exp(-g),T=vw(Math.pow(h,2),o);return(-r(h)+j1>0?-1:1)*((m-v)*y)/T}):(r=h=>{const d=Math.exp(-h*n),g=(h-t)*n+1;return-j1+d*g},s=h=>{const d=Math.exp(-h*n),g=(t-h)*(n*n);return d*g});const a=5/n,u=xH(r,s,a);if(n=_o(n),isNaN(u))return{stiffness:qt.stiffness,damping:qt.damping,duration:n};{const h=Math.pow(u,2)*i;return{stiffness:h,damping:o*2*Math.sqrt(i*h),duration:n}}}const wH=12;function xH(n,e,t){let i=t;for(let r=1;r<wH;r++)i=i-n(i)/e(i);return i}function vw(n,e){return n*Math.sqrt(1-e*e)}const SH=["duration","bounce"],TH=["stiffness","damping","mass"];function IC(n,e){return e.some(t=>n[t]!==void 0)}function IH(n){let e={velocity:qt.velocity,stiffness:qt.stiffness,damping:qt.damping,mass:qt.mass,isResolvedFromDuration:!1,...n};if(!IC(n,TH)&&IC(n,SH))if(n.visualDuration){const t=n.visualDuration,i=2*Math.PI/(t*1.2),r=i*i,s=2*Io(.05,1,1-(n.bounce||0))*Math.sqrt(r);e={...e,mass:qt.mass,stiffness:r,damping:s}}else{const t=EH(n);e={...e,...t,mass:qt.mass},e.isResolvedFromDuration=!0}return e}function GN(n=qt.visualDuration,e=qt.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:i,restDelta:r}=t;const s=t.keyframes[0],o=t.keyframes[t.keyframes.length-1],a={done:!1,value:s},{stiffness:u,damping:h,mass:d,duration:g,velocity:m,isResolvedFromDuration:v}=IH({...t,velocity:-yo(t.velocity||0)}),y=m||0,T=h/(2*Math.sqrt(u*d)),w=o-s,A=yo(Math.sqrt(u/d)),P=Math.abs(w)<5;i||(i=P?qt.restSpeed.granular:qt.restSpeed.default),r||(r=P?qt.restDelta.granular:qt.restDelta.default);let M;if(T<1){const N=vw(A,T);M=B=>{const b=Math.exp(-T*A*B);return o-b*((y+T*A*w)/N*Math.sin(N*B)+w*Math.cos(N*B))}}else if(T===1)M=N=>o-Math.exp(-A*N)*(w+(y+A*w)*N);else{const N=A*Math.sqrt(T*T-1);M=B=>{const b=Math.exp(-T*A*B),R=Math.min(N*B,300);return o-b*((y+T*A*w)*Math.sinh(R)+N*w*Math.cosh(R))/N}}const k={calculatedDuration:v&&g||null,next:N=>{const B=M(N);if(v)a.done=N>=g;else{let b=0;T<1&&(b=N===0?_o(y):FN(M,N,B));const R=Math.abs(b)<=i,L=Math.abs(o-B)<=r;a.done=R&&L}return a.value=a.done?o:B,a},toString:()=>{const N=Math.min(iN(k),hw),B=rN(b=>k.next(N*b).value,N,30);return N+"ms "+B}};return k}function AC({keyframes:n,velocity:e=0,power:t=.8,timeConstant:i=325,bounceDamping:r=10,bounceStiffness:s=500,modifyTarget:o,min:a,max:u,restDelta:h=.5,restSpeed:d}){const g=n[0],m={done:!1,value:g},v=R=>a!==void 0&&R<a||u!==void 0&&R>u,y=R=>a===void 0?u:u===void 0||Math.abs(a-R)<Math.abs(u-R)?a:u;let T=t*e;const w=g+T,A=o===void 0?w:o(w);A!==w&&(T=A-g);const P=R=>-T*Math.exp(-R/i),M=R=>A+P(R),k=R=>{const L=P(R),V=M(R);m.done=Math.abs(L)<=h,m.value=m.done?A:V};let N,B;const b=R=>{v(m.value)&&(N=R,B=GN({keyframes:[m.value,y(m.value)],velocity:FN(M,R,m.value),damping:r,stiffness:s,restDelta:h,restSpeed:d}))};return b(0),{calculatedDuration:null,next:R=>{let L=!1;return!B&&N===void 0&&(L=!0,k(R),b(R)),N!==void 0&&R>=N?B.next(R-N):(!L&&k(R),m)}}}const AH=Ug(.42,0,1,1),RH=Ug(0,0,.58,1),jN=Ug(.42,0,.58,1),PH=n=>Array.isArray(n)&&typeof n[0]!="number",CH={linear:qi,easeIn:AH,easeInOut:jN,easeOut:RH,circIn:eT,circInOut:EN,circOut:vN,backIn:JS,backInOut:_N,backOut:pN,anticipate:yN},RC=n=>{if(qS(n)){VD(n.length===4);const[e,t,i,r]=n;return Ug(e,t,i,r)}else if(typeof n=="string")return CH[n];return n};function MH(n,e,t){const i=[],r=t||VN,s=n.length-1;for(let o=0;o<s;o++){let a=r(n[o],n[o+1]);if(e){const u=Array.isArray(e)?e[o]||qi:e;a=Bg(u,a)}i.push(a)}return i}function bH(n,e,{clamp:t=!0,ease:i,mixer:r}={}){const s=n.length;if(VD(s===e.length),s===1)return()=>e[0];if(s===2&&e[0]===e[1])return()=>e[1];const o=n[0]===n[1];n[0]>n[s-1]&&(n=[...n].reverse(),e=[...e].reverse());const a=MH(e,i,r),u=a.length,h=d=>{if(o&&d<n[0])return e[0];let g=0;if(u>1)for(;g<n.length-2&&!(d<n[g+1]);g++);const m=Rh(n[g],n[g+1],d);return a[g](m)};return t?d=>h(Io(n[0],n[s-1],d)):h}function LH(n,e){const t=n[n.length-1];for(let i=1;i<=e;i++){const r=Rh(0,e,i);n.push($t(t,1,r))}}function kH(n){const e=[0];return LH(e,n.length-1),e}function DH(n,e){return n.map(t=>t*e)}function NH(n,e){return n.map(()=>e||jN).splice(0,n.length-1)}function n0({duration:n=300,keyframes:e,times:t,ease:i="easeInOut"}){const r=PH(i)?i.map(RC):RC(i),s={done:!1,value:e[0]},o=DH(t&&t.length===e.length?t:kH(e),n),a=bH(o,e,{ease:Array.isArray(r)?r:NH(e,r)});return{calculatedDuration:n,next:u=>(s.value=a(u),s.done=u>=n,s)}}const OH=n=>{const e=({timestamp:t})=>n(t);return{start:()=>kt.update(e,!0),stop:()=>Ua(e),now:()=>Vn.isProcessing?Vn.timestamp:ks.now()}},VH={decay:AC,inertia:AC,tween:n0,keyframes:n0,spring:GN},FH=n=>n/100;class oT extends NN{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:u}=this.options;u&&u()};const{name:t,motionValue:i,element:r,keyframes:s}=this.options,o=r?.KeyframeResolver||rT,a=(u,h)=>this.onKeyframesResolved(u,h);this.resolver=new o(s,a,t,i,r),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:t="keyframes",repeat:i=0,repeatDelay:r=0,repeatType:s,velocity:o=0}=this.options,a=HS(t)?t:VH[t]||n0;let u,h;a!==n0&&typeof e[0]!="number"&&(u=Bg(FH,VN(e[0],e[1])),e=[0,100]);const d=a({...this.options,keyframes:e});s==="mirror"&&(h=a({...this.options,keyframes:[...e].reverse(),velocity:-o})),d.calculatedDuration===null&&(d.calculatedDuration=iN(d));const{calculatedDuration:g}=d,m=g+r,v=m*(i+1)-r;return{generator:d,mirroredGenerator:h,mapPercentToKeyframes:u,calculatedDuration:g,resolvedDuration:m,totalDuration:v}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,t=!1){const{resolved:i}=this;if(!i){const{keyframes:R}=this.options;return{done:!0,value:R[R.length-1]}}const{finalKeyframe:r,generator:s,mirroredGenerator:o,mapPercentToKeyframes:a,keyframes:u,calculatedDuration:h,totalDuration:d,resolvedDuration:g}=i;if(this.startTime===null)return s.next(0);const{delay:m,repeat:v,repeatType:y,repeatDelay:T,onUpdate:w}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-d/this.speed,this.startTime)),t?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const A=this.currentTime-m*(this.speed>=0?1:-1),P=this.speed>=0?A<0:A>d;this.currentTime=Math.max(A,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=d);let M=this.currentTime,k=s;if(v){const R=Math.min(this.currentTime,d)/g;let L=Math.floor(R),V=R%1;!V&&R>=1&&(V=1),V===1&&L--,L=Math.min(L,v+1),L%2&&(y==="reverse"?(V=1-V,T&&(V-=T/g)):y==="mirror"&&(k=o)),M=Io(0,1,V)*g}const N=P?{done:!1,value:u[0]}:k.next(M);a&&(N.value=a(N.value));let{done:B}=N;!P&&h!==null&&(B=this.speed>=0?this.currentTime>=d:this.currentTime<=0);const b=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&B);return b&&r!==void 0&&(N.value=gy(u,this.options,r)),w&&w(N.value),b&&this.finish(),N}get duration(){const{resolved:e}=this;return e?yo(e.calculatedDuration):0}get time(){return yo(this.currentTime)}set time(e){e=_o(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=yo(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=OH,onPlay:t,startTime:i}=this.options;this.driver||(this.driver=e(s=>this.tick(s))),t&&t();const r=this.driver.now();this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=r):this.startTime=i??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const GH=new Set(["opacity","clipPath","filter","transform"]);function jH(n,e,t,{delay:i=0,duration:r=300,repeat:s=0,repeatType:o="loop",ease:a="easeInOut",times:u}={}){const h={[e]:t};u&&(h.offset=u);const d=oN(a,r);return Array.isArray(d)&&(h.easing=d),n.animate(h,{delay:i,duration:r,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:s+1,direction:o==="reverse"?"alternate":"normal"})}const UH=LS(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),i0=10,BH=2e4;function zH(n){return HS(n.type)||n.type==="spring"||!sN(n.ease)}function $H(n,e){const t=new oT({...e,keyframes:n,repeat:0,delay:0,isGenerator:!0});let i={done:!1,value:n[0]};const r=[];let s=0;for(;!i.done&&s<BH;)i=t.sample(s),r.push(i.value),s+=i0;return{times:void 0,keyframes:r,duration:s-i0,ease:"linear"}}const UN={anticipate:yN,backInOut:_N,circInOut:EN};function WH(n){return n in UN}class PC extends NN{constructor(e){super(e);const{name:t,motionValue:i,element:r,keyframes:s}=this.options;this.resolver=new DN(s,(o,a)=>this.onKeyframesResolved(o,a),t,i,r),this.resolver.scheduleResolve()}initPlayback(e,t){let{duration:i=300,times:r,ease:s,type:o,motionValue:a,name:u,startTime:h}=this.options;if(!a.owner||!a.owner.current)return!1;if(typeof s=="string"&&e0()&&WH(s)&&(s=UN[s]),zH(this.options)){const{onComplete:g,onUpdate:m,motionValue:v,element:y,...T}=this.options,w=$H(e,T);e=w.keyframes,e.length===1&&(e[1]=e[0]),i=w.duration,r=w.times,s=w.ease,o="keyframes"}const d=jH(a.owner.current,u,e,{...this.options,duration:i,times:r,ease:s});return d.startTime=h??this.calcStartTime(),this.pendingTimeline?(dC(d,this.pendingTimeline),this.pendingTimeline=void 0):d.onfinish=()=>{const{onComplete:g}=this.options;a.set(gy(e,this.options,t)),g&&g(),this.cancel(),this.resolveFinishedPromise()},{animation:d,duration:i,times:r,type:o,ease:s,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:t}=e;return yo(t)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:t}=e;return yo(t.currentTime||0)}set time(e){const{resolved:t}=this;if(!t)return;const{animation:i}=t;i.currentTime=_o(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:t}=e;return t.playbackRate}set speed(e){const{resolved:t}=this;if(!t)return;const{animation:i}=t;i.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:t}=e;return t.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:t}=e;return t.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:t}=this;if(!t)return qi;const{animation:i}=t;dC(i,e)}return qi}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.playState==="finished"&&this.updateFinishedPromise(),t.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:t,keyframes:i,duration:r,type:s,ease:o,times:a}=e;if(t.playState==="idle"||t.playState==="finished")return;if(this.time){const{motionValue:h,onUpdate:d,onComplete:g,element:m,...v}=this.options,y=new oT({...v,keyframes:i,duration:r,type:s,ease:o,times:a,isGenerator:!0}),T=_o(this.time);h.setWithVelocity(y.sample(T-i0).value,y.sample(T).value,i0)}const{onStop:u}=this.options;u&&u(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:t,name:i,repeatDelay:r,repeatType:s,damping:o,type:a}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:u,transformTemplate:h}=t.owner.getProps();return UH()&&i&&GH.has(i)&&!u&&!h&&!r&&s!=="mirror"&&o!==0&&a!=="inertia"}}const KH={type:"spring",stiffness:500,damping:25,restSpeed:10},HH=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),qH={type:"keyframes",duration:.8},XH={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},YH=(n,{keyframes:e})=>e.length>2?qH:Pu.has(n)?n.startsWith("scale")?HH(e[1]):KH:XH;function ZH({when:n,delay:e,delayChildren:t,staggerChildren:i,staggerDirection:r,repeat:s,repeatType:o,repeatDelay:a,from:u,elapsed:h,...d}){return!!Object.keys(d).length}const aT=(n,e,t,i={},r,s)=>o=>{const a=KS(i,n)||{},u=a.delay||i.delay||0;let{elapsed:h=0}=i;h=h-_o(u);let d={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...a,delay:-h,onUpdate:m=>{e.set(m),a.onUpdate&&a.onUpdate(m)},onComplete:()=>{o(),a.onComplete&&a.onComplete()},name:n,motionValue:e,element:s?void 0:r};ZH(a)||(d={...d,...YH(n,d)}),d.duration&&(d.duration=_o(d.duration)),d.repeatDelay&&(d.repeatDelay=_o(d.repeatDelay)),d.from!==void 0&&(d.keyframes[0]=d.from);let g=!1;if((d.type===!1||d.duration===0&&!d.repeatDelay)&&(d.duration=0,d.delay===0&&(g=!0)),g&&!s&&e.get()!==void 0){const m=gy(d.keyframes,a);if(m!==void 0)return kt.update(()=>{d.onUpdate(m),d.onComplete()}),new pK([])}return!s&&PC.supports(d)?new PC(d):new oT(d)};function QH({protectedKeys:n,needsAnimating:e},t){const i=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,i}function BN(n,e,{delay:t=0,transitionOverride:i,type:r}={}){var s;let{transition:o=n.getDefaultTransition(),transitionEnd:a,...u}=e;i&&(o=i);const h=[],d=r&&n.animationState&&n.animationState.getState()[r];for(const g in u){const m=n.getValue(g,(s=n.latestValues[g])!==null&&s!==void 0?s:null),v=u[g];if(v===void 0||d&&QH(d,g))continue;const y={delay:t,...KS(o||{},g)};let T=!1;if(window.MotionHandoffAnimation){const A=dN(n);if(A){const P=window.MotionHandoffAnimation(A,g,kt);P!==null&&(y.startTime=P,T=!0)}}fw(n,g),m.start(aT(g,m,v,n.shouldReduceMotion&&cN.has(g)?{type:!1}:y,n,T));const w=m.animation;w&&h.push(w)}return a&&Promise.all(h).then(()=>{kt.update(()=>{a&&MK(n,a)})}),h}function Ew(n,e,t={}){var i;const r=fy(n,e,t.type==="exit"?(i=n.presenceContext)===null||i===void 0?void 0:i.custom:void 0);let{transition:s=n.getDefaultTransition()||{}}=r||{};t.transitionOverride&&(s=t.transitionOverride);const o=r?()=>Promise.all(BN(n,r,t)):()=>Promise.resolve(),a=n.variantChildren&&n.variantChildren.size?(h=0)=>{const{delayChildren:d=0,staggerChildren:g,staggerDirection:m}=s;return JH(n,e,d+h,g,m,t)}:()=>Promise.resolve(),{when:u}=s;if(u){const[h,d]=u==="beforeChildren"?[o,a]:[a,o];return h().then(()=>d())}else return Promise.all([o(),a(t.delay)])}function JH(n,e,t=0,i=0,r=1,s){const o=[],a=(n.variantChildren.size-1)*i,u=r===1?(h=0)=>h*i:(h=0)=>a-h*i;return Array.from(n.variantChildren).sort(eq).forEach((h,d)=>{h.notify("AnimationStart",e),o.push(Ew(h,e,{...s,delay:t+u(d)}).then(()=>h.notify("AnimationComplete",e)))}),Promise.all(o)}function eq(n,e){return n.sortNodePosition(e)}function tq(n,e,t={}){n.notify("AnimationStart",e);let i;if(Array.isArray(e)){const r=e.map(s=>Ew(n,s,t));i=Promise.all(r)}else if(typeof e=="string")i=Ew(n,e,t);else{const r=typeof e=="function"?fy(n,e,t.custom):e;i=Promise.all(BN(n,r,t))}return i.then(()=>{n.notify("AnimationComplete",e)})}const nq=DS.length;function zN(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?zN(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<nq;t++){const i=DS[t],r=n.props[i];(rg(r)||r===!1)&&(e[i]=r)}return e}const iq=[...kS].reverse(),rq=kS.length;function sq(n){return e=>Promise.all(e.map(({animation:t,options:i})=>tq(n,t,i)))}function oq(n){let e=sq(n),t=CC(),i=!0;const r=u=>(h,d)=>{var g;const m=fy(n,d,u==="exit"?(g=n.presenceContext)===null||g===void 0?void 0:g.custom:void 0);if(m){const{transition:v,transitionEnd:y,...T}=m;h={...h,...T,...y}}return h};function s(u){e=u(n)}function o(u){const{props:h}=n,d=zN(n.parent)||{},g=[],m=new Set;let v={},y=1/0;for(let w=0;w<rq;w++){const A=iq[w],P=t[A],M=h[A]!==void 0?h[A]:d[A],k=rg(M),N=A===u?P.isActive:null;N===!1&&(y=w);let B=M===d[A]&&M!==h[A]&&k;if(B&&i&&n.manuallyAnimateOnMount&&(B=!1),P.protectedKeys={...v},!P.isActive&&N===null||!M&&!P.prevProp||hy(M)||typeof M=="boolean")continue;const b=aq(P.prevProp,M);let R=b||A===u&&P.isActive&&!B&&k||w>y&&k,L=!1;const V=Array.isArray(M)?M:[M];let F=V.reduce(r(A),{});N===!1&&(F={});const{prevResolvedValues:U={}}=P,D={...U,...F},le=de=>{R=!0,m.has(de)&&(L=!0,m.delete(de)),P.needsAnimating[de]=!0;const J=n.getValue(de);J&&(J.liveStyle=!1)};for(const de in D){const J=F[de],ae=U[de];if(v.hasOwnProperty(de))continue;let ie=!1;cw(J)&&cw(ae)?ie=!nN(J,ae):ie=J!==ae,ie?J!=null?le(de):m.add(de):J!==void 0&&m.has(de)?le(de):P.protectedKeys[de]=!0}P.prevProp=M,P.prevResolvedValues=F,P.isActive&&(v={...v,...F}),i&&n.blockInitialAnimation&&(R=!1),R&&(!(B&&b)||L)&&g.push(...V.map(de=>({animation:de,options:{type:A}})))}if(m.size){const w={};m.forEach(A=>{const P=n.getBaseTarget(A),M=n.getValue(A);M&&(M.liveStyle=!0),w[A]=P??null}),g.push({animation:w})}let T=!!g.length;return i&&(h.initial===!1||h.initial===h.animate)&&!n.manuallyAnimateOnMount&&(T=!1),i=!1,T?e(g):Promise.resolve()}function a(u,h){var d;if(t[u].isActive===h)return Promise.resolve();(d=n.variantChildren)===null||d===void 0||d.forEach(m=>{var v;return(v=m.animationState)===null||v===void 0?void 0:v.setActive(u,h)}),t[u].isActive=h;const g=o(u);for(const m in t)t[m].protectedKeys={};return g}return{animateChanges:o,setActive:a,setAnimateFunction:s,getState:()=>t,reset:()=>{t=CC(),i=!0}}}function aq(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!nN(e,n):!1}function Il(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function CC(){return{animate:Il(!0),whileInView:Il(),whileHover:Il(),whileTap:Il(),whileDrag:Il(),whileFocus:Il(),exit:Il()}}class Xa{constructor(e){this.isMounted=!1,this.node=e}update(){}}class lq extends Xa{constructor(e){super(e),e.animationState||(e.animationState=oq(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();hy(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let uq=0;class cq extends Xa{constructor(){super(...arguments),this.id=uq++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:i}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===i)return;const r=this.node.animationState.setActive("exit",!e);t&&!e&&r.then(()=>t(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const hq={animation:{Feature:lq},exit:{Feature:cq}};function lg(n,e,t,i={passive:!0}){return n.addEventListener(e,t,i),()=>n.removeEventListener(e,t)}function zg(n){return{point:{x:n.pageX,y:n.pageY}}}const dq=n=>e=>XS(e)&&n(e,zg(e));function wf(n,e,t,i){return lg(n,e,dq(t),i)}const MC=(n,e)=>Math.abs(n-e);function fq(n,e){const t=MC(n.x,e.x),i=MC(n.y,e.y);return Math.sqrt(t**2+i**2)}class $N{constructor(e,t,{transformPagePoint:i,contextWindow:r,dragSnapToOrigin:s=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const g=B1(this.lastMoveEventInfo,this.history),m=this.startEvent!==null,v=fq(g.offset,{x:0,y:0})>=3;if(!m&&!v)return;const{point:y}=g,{timestamp:T}=Vn;this.history.push({...y,timestamp:T});const{onStart:w,onMove:A}=this.handlers;m||(w&&w(this.lastMoveEvent,g),this.startEvent=this.lastMoveEvent),A&&A(this.lastMoveEvent,g)},this.handlePointerMove=(g,m)=>{this.lastMoveEvent=g,this.lastMoveEventInfo=U1(m,this.transformPagePoint),kt.update(this.updatePoint,!0)},this.handlePointerUp=(g,m)=>{this.end();const{onEnd:v,onSessionEnd:y,resumeAnimation:T}=this.handlers;if(this.dragSnapToOrigin&&T&&T(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const w=B1(g.type==="pointercancel"?this.lastMoveEventInfo:U1(m,this.transformPagePoint),this.history);this.startEvent&&v&&v(g,w),y&&y(g,w)},!XS(e))return;this.dragSnapToOrigin=s,this.handlers=t,this.transformPagePoint=i,this.contextWindow=r||window;const o=zg(e),a=U1(o,this.transformPagePoint),{point:u}=a,{timestamp:h}=Vn;this.history=[{...u,timestamp:h}];const{onSessionStart:d}=t;d&&d(e,B1(a,this.history)),this.removeListeners=Bg(wf(this.contextWindow,"pointermove",this.handlePointerMove),wf(this.contextWindow,"pointerup",this.handlePointerUp),wf(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Ua(this.updatePoint)}}function U1(n,e){return e?{point:e(n.point)}:n}function bC(n,e){return{x:n.x-e.x,y:n.y-e.y}}function B1({point:n},e){return{point:n,delta:bC(n,WN(e)),offset:bC(n,gq(e)),velocity:mq(e,.1)}}function gq(n){return n[0]}function WN(n){return n[n.length-1]}function mq(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,i=null;const r=WN(n);for(;t>=0&&(i=n[t],!(r.timestamp-i.timestamp>_o(e)));)t--;if(!i)return{x:0,y:0};const s=yo(r.timestamp-i.timestamp);if(s===0)return{x:0,y:0};const o={x:(r.x-i.x)/s,y:(r.y-i.y)/s};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}const KN=1e-4,pq=1-KN,_q=1+KN,HN=.01,yq=0-HN,vq=0+HN;function Qi(n){return n.max-n.min}function Eq(n,e,t){return Math.abs(n-e)<=t}function LC(n,e,t,i=.5){n.origin=i,n.originPoint=$t(e.min,e.max,n.origin),n.scale=Qi(t)/Qi(e),n.translate=$t(t.min,t.max,n.origin)-n.originPoint,(n.scale>=pq&&n.scale<=_q||isNaN(n.scale))&&(n.scale=1),(n.translate>=yq&&n.translate<=vq||isNaN(n.translate))&&(n.translate=0)}function xf(n,e,t,i){LC(n.x,e.x,t.x,i?i.originX:void 0),LC(n.y,e.y,t.y,i?i.originY:void 0)}function kC(n,e,t){n.min=t.min+e.min,n.max=n.min+Qi(e)}function wq(n,e,t){kC(n.x,e.x,t.x),kC(n.y,e.y,t.y)}function DC(n,e,t){n.min=e.min-t.min,n.max=n.min+Qi(e)}function Sf(n,e,t){DC(n.x,e.x,t.x),DC(n.y,e.y,t.y)}function xq(n,{min:e,max:t},i){return e!==void 0&&n<e?n=i?$t(e,n,i.min):Math.max(n,e):t!==void 0&&n>t&&(n=i?$t(t,n,i.max):Math.min(n,t)),n}function NC(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function Sq(n,{top:e,left:t,bottom:i,right:r}){return{x:NC(n.x,t,r),y:NC(n.y,e,i)}}function OC(n,e){let t=e.min-n.min,i=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,i]=[i,t]),{min:t,max:i}}function Tq(n,e){return{x:OC(n.x,e.x),y:OC(n.y,e.y)}}function Iq(n,e){let t=.5;const i=Qi(n),r=Qi(e);return r>i?t=Rh(e.min,e.max-i,n.min):i>r&&(t=Rh(n.min,n.max-r,e.min)),Io(0,1,t)}function Aq(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const ww=.35;function Rq(n=ww){return n===!1?n=0:n===!0&&(n=ww),{x:VC(n,"left","right"),y:VC(n,"top","bottom")}}function VC(n,e,t){return{min:FC(n,e),max:FC(n,t)}}function FC(n,e){return typeof n=="number"?n:n[e]||0}const GC=()=>({translate:0,scale:1,origin:0,originPoint:0}),Gc=()=>({x:GC(),y:GC()}),jC=()=>({min:0,max:0}),en=()=>({x:jC(),y:jC()});function pr(n){return[n("x"),n("y")]}function qN({top:n,left:e,right:t,bottom:i}){return{x:{min:e,max:t},y:{min:n,max:i}}}function Pq({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function Cq(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),i=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:i.y,right:i.x}}function z1(n){return n===void 0||n===1}function xw({scale:n,scaleX:e,scaleY:t}){return!z1(n)||!z1(e)||!z1(t)}function Ll(n){return xw(n)||XN(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function XN(n){return UC(n.x)||UC(n.y)}function UC(n){return n&&n!=="0%"}function r0(n,e,t){const i=n-t,r=e*i;return t+r}function BC(n,e,t,i,r){return r!==void 0&&(n=r0(n,r,i)),r0(n,t,i)+e}function Sw(n,e=0,t=1,i,r){n.min=BC(n.min,e,t,i,r),n.max=BC(n.max,e,t,i,r)}function YN(n,{x:e,y:t}){Sw(n.x,e.translate,e.scale,e.originPoint),Sw(n.y,t.translate,t.scale,t.originPoint)}const zC=.999999999999,$C=1.0000000000001;function Mq(n,e,t,i=!1){const r=t.length;if(!r)return;e.x=e.y=1;let s,o;for(let a=0;a<r;a++){s=t[a],o=s.projectionDelta;const{visualElement:u}=s.options;u&&u.props.style&&u.props.style.display==="contents"||(i&&s.options.layoutScroll&&s.scroll&&s!==s.root&&Uc(n,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,YN(n,o)),i&&Ll(s.latestValues)&&Uc(n,s.latestValues))}e.x<$C&&e.x>zC&&(e.x=1),e.y<$C&&e.y>zC&&(e.y=1)}function jc(n,e){n.min=n.min+e,n.max=n.max+e}function WC(n,e,t,i,r=.5){const s=$t(n.min,n.max,r);Sw(n,e,t,s,i)}function Uc(n,e){WC(n.x,e.x,e.scaleX,e.scale,e.originX),WC(n.y,e.y,e.scaleY,e.scale,e.originY)}function ZN(n,e){return qN(Cq(n.getBoundingClientRect(),e))}function bq(n,e,t){const i=ZN(n,t),{scroll:r}=e;return r&&(jc(i.x,r.offset.x),jc(i.y,r.offset.y)),i}const QN=({current:n})=>n?n.ownerDocument.defaultView:null,Lq=new WeakMap;class kq{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=en(),this.visualElement=e}start(e,{snapToCursor:t=!1}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const r=d=>{const{dragSnapToOrigin:g}=this.getProps();g?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(zg(d).point)},s=(d,g)=>{const{drag:m,dragPropagation:v,onDragStart:y}=this.getProps();if(m&&!v&&(this.openDragLock&&this.openDragLock(),this.openDragLock=IK(m),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),pr(w=>{let A=this.getAxisMotionValue(w).get()||0;if(Ls.test(A)){const{projection:P}=this.visualElement;if(P&&P.layout){const M=P.layout.layoutBox[w];M&&(A=Qi(M)*(parseFloat(A)/100))}}this.originPoint[w]=A}),y&&kt.postRender(()=>y(d,g)),fw(this.visualElement,"transform");const{animationState:T}=this.visualElement;T&&T.setActive("whileDrag",!0)},o=(d,g)=>{const{dragPropagation:m,dragDirectionLock:v,onDirectionLock:y,onDrag:T}=this.getProps();if(!m&&!this.openDragLock)return;const{offset:w}=g;if(v&&this.currentDirection===null){this.currentDirection=Dq(w),this.currentDirection!==null&&y&&y(this.currentDirection);return}this.updateAxis("x",g.point,w),this.updateAxis("y",g.point,w),this.visualElement.render(),T&&T(d,g)},a=(d,g)=>this.stop(d,g),u=()=>pr(d=>{var g;return this.getAnimationState(d)==="paused"&&((g=this.getAxisMotionValue(d).animation)===null||g===void 0?void 0:g.play())}),{dragSnapToOrigin:h}=this.getProps();this.panSession=new $N(e,{onSessionStart:r,onStart:s,onMove:o,onSessionEnd:a,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:h,contextWindow:QN(this.visualElement)})}stop(e,t){const i=this.isDragging;if(this.cancel(),!i)return;const{velocity:r}=t;this.startAnimation(r);const{onDragEnd:s}=this.getProps();s&&kt.postRender(()=>s(e,t))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:i}=this.getProps();!i&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,i){const{drag:r}=this.getProps();if(!i||!Mp(e,r,this.currentDirection))return;const s=this.getAxisMotionValue(e);let o=this.originPoint[e]+i[e];this.constraints&&this.constraints[e]&&(o=xq(o,this.constraints[e],this.elastic[e])),s.set(o)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:i}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,s=this.constraints;t&&Vc(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&r?this.constraints=Sq(r.layoutBox,t):this.constraints=!1,this.elastic=Rq(i),s!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&pr(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=Aq(r.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!Vc(e))return!1;const i=e.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const s=bq(i,r.root,this.visualElement.getTransformPagePoint());let o=Tq(r.layout.layoutBox,s);if(t){const a=t(Pq(o));this.hasMutatedConstraints=!!a,a&&(o=qN(a))}return o}startAnimation(e){const{drag:t,dragMomentum:i,dragElastic:r,dragTransition:s,dragSnapToOrigin:o,onDragTransitionEnd:a}=this.getProps(),u=this.constraints||{},h=pr(d=>{if(!Mp(d,t,this.currentDirection))return;let g=u&&u[d]||{};o&&(g={min:0,max:0});const m=r?200:1e6,v=r?40:1e7,y={type:"inertia",velocity:i?e[d]:0,bounceStiffness:m,bounceDamping:v,timeConstant:750,restDelta:1,restSpeed:10,...s,...g};return this.startAxisValueAnimation(d,y)});return Promise.all(h).then(a)}startAxisValueAnimation(e,t){const i=this.getAxisMotionValue(e);return fw(this.visualElement,e),i.start(aT(e,i,0,t,this.visualElement,!1))}stopAnimation(){pr(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){pr(e=>{var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.pause()})}getAnimationState(e){var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,i=this.visualElement.getProps(),r=i[t];return r||this.visualElement.getValue(e,(i.initial?i.initial[e]:void 0)||0)}snapToCursor(e){pr(t=>{const{drag:i}=this.getProps();if(!Mp(t,i,this.currentDirection))return;const{projection:r}=this.visualElement,s=this.getAxisMotionValue(t);if(r&&r.layout){const{min:o,max:a}=r.layout.layoutBox[t];s.set(e[t]-$t(o,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:i}=this.visualElement;if(!Vc(t)||!i||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};pr(o=>{const a=this.getAxisMotionValue(o);if(a&&this.constraints!==!1){const u=a.get();r[o]=Iq({min:u,max:u},this.constraints[o])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",i.root&&i.root.updateScroll(),i.updateLayout(),this.resolveConstraints(),pr(o=>{if(!Mp(o,e,null))return;const a=this.getAxisMotionValue(o),{min:u,max:h}=this.constraints[o];a.set($t(u,h,r[o]))})}addListeners(){if(!this.visualElement.current)return;Lq.set(this.visualElement,this);const e=this.visualElement.current,t=wf(e,"pointerdown",u=>{const{drag:h,dragListener:d=!0}=this.getProps();h&&d&&this.start(u)}),i=()=>{const{dragConstraints:u}=this.getProps();Vc(u)&&u.current&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,s=r.addEventListener("measure",i);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),kt.read(i);const o=lg(window,"resize",()=>this.scalePositionWithinConstraints()),a=r.addEventListener("didUpdate",(({delta:u,hasLayoutChanged:h})=>{this.isDragging&&h&&(pr(d=>{const g=this.getAxisMotionValue(d);g&&(this.originPoint[d]+=u[d].translate,g.set(g.get()+u[d].translate))}),this.visualElement.render())}));return()=>{o(),t(),s(),a&&a()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:i=!1,dragPropagation:r=!1,dragConstraints:s=!1,dragElastic:o=ww,dragMomentum:a=!0}=e;return{...e,drag:t,dragDirectionLock:i,dragPropagation:r,dragConstraints:s,dragElastic:o,dragMomentum:a}}}function Mp(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function Dq(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class Nq extends Xa{constructor(e){super(e),this.removeGroupControls=qi,this.removeListeners=qi,this.controls=new kq(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||qi}unmount(){this.removeGroupControls(),this.removeListeners()}}const KC=n=>(e,t)=>{n&&kt.postRender(()=>n(e,t))};class Oq extends Xa{constructor(){super(...arguments),this.removePointerDownListener=qi}onPointerDown(e){this.session=new $N(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:QN(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:i,onPanEnd:r}=this.node.getProps();return{onSessionStart:KC(e),onStart:KC(t),onMove:i,onEnd:(s,o)=>{delete this.session,r&&kt.postRender(()=>r(s,o))}}}mount(){this.removePointerDownListener=wf(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const e_={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function HC(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const Gd={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(Fe.test(n))n=parseFloat(n);else return n;const t=HC(n,e.target.x),i=HC(n,e.target.y);return`${t}% ${i}%`}},Vq={correct:(n,{treeScale:e,projectionDelta:t})=>{const i=n,r=Ba.parse(n);if(r.length>5)return i;const s=Ba.createTransformer(n),o=typeof r[0]!="number"?1:0,a=t.x.scale*e.x,u=t.y.scale*e.y;r[0+o]/=a,r[1+o]/=u;const h=$t(a,u,.5);return typeof r[2+o]=="number"&&(r[2+o]/=h),typeof r[3+o]=="number"&&(r[3+o]/=h),s(r)}};class Fq extends ne.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:i,layoutId:r}=this.props,{projection:s}=e;rK(Gq),s&&(t.group&&t.group.add(s),i&&i.register&&r&&i.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),e_.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:i,drag:r,isPresent:s}=this.props,o=i.projection;return o&&(o.isPresent=s,r||e.layoutDependency!==t||t===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?o.promote():o.relegate()||kt.postRender(()=>{const a=o.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),OS.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:i}=this.props,{projection:r}=e;r&&(r.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(r),i&&i.deregister&&i.deregister(r))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function JN(n){const[e,t]=ND(),i=ne.useContext(PS);return G.jsx(Fq,{...n,layoutGroup:i,switchLayoutGroup:ne.useContext(zD),isPresent:e,safeToRemove:t})}const Gq={borderRadius:{...Gd,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Gd,borderTopRightRadius:Gd,borderBottomLeftRadius:Gd,borderBottomRightRadius:Gd,boxShadow:Vq};function jq(n,e,t){const i=ei(n)?n:og(n);return i.start(aT("",i,e,t)),i.animation}function Uq(n){return n instanceof SVGElement&&n.tagName!=="svg"}const Bq=(n,e)=>n.depth-e.depth;class zq{constructor(){this.children=[],this.isDirty=!1}add(e){YS(this.children,e),this.isDirty=!0}remove(e){ZS(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(Bq),this.isDirty=!1,this.children.forEach(e)}}function $q(n,e){const t=ks.now(),i=({timestamp:r})=>{const s=r-t;s>=e&&(Ua(i),n(s-e))};return kt.read(i,!0),()=>Ua(i)}const eO=["TopLeft","TopRight","BottomLeft","BottomRight"],Wq=eO.length,qC=n=>typeof n=="string"?parseFloat(n):n,XC=n=>typeof n=="number"||Fe.test(n);function Kq(n,e,t,i,r,s){r?(n.opacity=$t(0,t.opacity!==void 0?t.opacity:1,Hq(i)),n.opacityExit=$t(e.opacity!==void 0?e.opacity:1,0,qq(i))):s&&(n.opacity=$t(e.opacity!==void 0?e.opacity:1,t.opacity!==void 0?t.opacity:1,i));for(let o=0;o<Wq;o++){const a=`border${eO[o]}Radius`;let u=YC(e,a),h=YC(t,a);if(u===void 0&&h===void 0)continue;u||(u=0),h||(h=0),u===0||h===0||XC(u)===XC(h)?(n[a]=Math.max($t(qC(u),qC(h),i),0),(Ls.test(h)||Ls.test(u))&&(n[a]+="%")):n[a]=h}(e.rotate||t.rotate)&&(n.rotate=$t(e.rotate||0,t.rotate||0,i))}function YC(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const Hq=tO(0,.5,vN),qq=tO(.5,.95,qi);function tO(n,e,t){return i=>i<n?0:i>e?1:t(Rh(n,e,i))}function ZC(n,e){n.min=e.min,n.max=e.max}function mr(n,e){ZC(n.x,e.x),ZC(n.y,e.y)}function QC(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function JC(n,e,t,i,r){return n-=e,n=r0(n,1/t,i),r!==void 0&&(n=r0(n,1/r,i)),n}function Xq(n,e=0,t=1,i=.5,r,s=n,o=n){if(Ls.test(e)&&(e=parseFloat(e),e=$t(o.min,o.max,e/100)-o.min),typeof e!="number")return;let a=$t(s.min,s.max,i);n===s&&(a-=e),n.min=JC(n.min,e,t,a,r),n.max=JC(n.max,e,t,a,r)}function eM(n,e,[t,i,r],s,o){Xq(n,e[t],e[i],e[r],e.scale,s,o)}const Yq=["x","scaleX","originX"],Zq=["y","scaleY","originY"];function tM(n,e,t,i){eM(n.x,e,Yq,t?t.x:void 0,i?i.x:void 0),eM(n.y,e,Zq,t?t.y:void 0,i?i.y:void 0)}function nM(n){return n.translate===0&&n.scale===1}function nO(n){return nM(n.x)&&nM(n.y)}function iM(n,e){return n.min===e.min&&n.max===e.max}function Qq(n,e){return iM(n.x,e.x)&&iM(n.y,e.y)}function rM(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function iO(n,e){return rM(n.x,e.x)&&rM(n.y,e.y)}function sM(n){return Qi(n.x)/Qi(n.y)}function oM(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class Jq{constructor(){this.members=[]}add(e){YS(this.members,e),e.scheduleRender()}remove(e){if(ZS(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(r=>e===r);if(t===0)return!1;let i;for(let r=t;r>=0;r--){const s=this.members[r];if(s.isPresent!==!1){i=s;break}}return i?(this.promote(i),!0):!1}promote(e,t){const i=this.lead;if(e!==i&&(this.prevLead=i,this.lead=e,e.show(),i)){i.instance&&i.scheduleRender(),e.scheduleRender(),e.resumeFrom=i,t&&(e.resumeFrom.preserveOpacity=!0),i.snapshot&&(e.snapshot=i.snapshot,e.snapshot.latestValues=i.animationValues||i.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:r}=e.options;r===!1&&i.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:i}=e;t.onExitComplete&&t.onExitComplete(),i&&i.options.onExitComplete&&i.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function eX(n,e,t){let i="";const r=n.x.translate/e.x,s=n.y.translate/e.y,o=t?.z||0;if((r||s||o)&&(i=`translate3d(${r}px, ${s}px, ${o}px) `),(e.x!==1||e.y!==1)&&(i+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:h,rotate:d,rotateX:g,rotateY:m,skewX:v,skewY:y}=t;h&&(i=`perspective(${h}px) ${i}`),d&&(i+=`rotate(${d}deg) `),g&&(i+=`rotateX(${g}deg) `),m&&(i+=`rotateY(${m}deg) `),v&&(i+=`skewX(${v}deg) `),y&&(i+=`skewY(${y}deg) `)}const a=n.x.scale*e.x,u=n.y.scale*e.y;return(a!==1||u!==1)&&(i+=`scale(${a}, ${u})`),i||"none"}const kl={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},nf=typeof window<"u"&&window.MotionDebug!==void 0,$1=["","X","Y","Z"],tX={visibility:"hidden"},aM=1e3;let nX=0;function W1(n,e,t,i){const{latestValues:r}=e;r[n]&&(t[n]=r[n],e.setStaticValue(n,0),i&&(i[n]=0))}function rO(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=dN(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:r,layoutId:s}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",kt,!(r||s))}const{parent:i}=n;i&&!i.hasCheckedOptimisedAppear&&rO(i)}function sO({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:i,resetTransform:r}){return class{constructor(o={},a=e?.()){this.id=nX++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,nf&&(kl.totalNodes=kl.resolvedTargetDeltas=kl.recalculatedProjection=0),this.nodes.forEach(sX),this.nodes.forEach(cX),this.nodes.forEach(hX),this.nodes.forEach(oX),nf&&window.MotionDebug.record(kl)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let u=0;u<this.path.length;u++)this.path[u].shouldResetTransform=!0;this.root===this&&(this.nodes=new zq)}addEventListener(o,a){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new QS),this.eventHandlers.get(o).add(a)}notifyListeners(o,...a){const u=this.eventHandlers.get(o);u&&u.notify(...a)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,a=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=Uq(o),this.instance=o;const{layoutId:u,layout:h,visualElement:d}=this.options;if(d&&!d.current&&d.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),a&&(h||u)&&(this.isLayoutDirty=!0),n){let g;const m=()=>this.root.updateBlockedByResize=!1;n(o,()=>{this.root.updateBlockedByResize=!0,g&&g(),g=$q(m,250),e_.hasAnimatedSinceResize&&(e_.hasAnimatedSinceResize=!1,this.nodes.forEach(uM))})}u&&this.root.registerSharedNode(u,this),this.options.animate!==!1&&d&&(u||h)&&this.addEventListener("didUpdate",({delta:g,hasLayoutChanged:m,hasRelativeTargetChanged:v,layout:y})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const T=this.options.transition||d.getDefaultTransition()||pX,{onLayoutAnimationStart:w,onLayoutAnimationComplete:A}=d.getProps(),P=!this.targetLayout||!iO(this.targetLayout,y)||v,M=!m&&v;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||M||m&&(P||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(g,M);const k={...KS(T,"layout"),onPlay:w,onComplete:A};(d.shouldReduceMotion||this.options.layoutRoot)&&(k.delay=0,k.type=!1),this.startAnimation(k)}else m||uM(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=y})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Ua(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(dX),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&rO(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let d=0;d<this.path.length;d++){const g=this.path[d];g.shouldResetTransform=!0,g.updateScroll("snapshot"),g.options.layoutRoot&&g.willUpdate(!1)}const{layoutId:a,layout:u}=this.options;if(a===void 0&&!u)return;const h=this.getTransformTemplate();this.prevTransformTemplateValue=h?h(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(lM);return}this.isUpdating||this.nodes.forEach(lX),this.isUpdating=!1,this.nodes.forEach(uX),this.nodes.forEach(iX),this.nodes.forEach(rX),this.clearAllSnapshots();const a=ks.now();Vn.delta=Io(0,1e3/60,a-Vn.timestamp),Vn.timestamp=a,Vn.isProcessing=!0,N1.update.process(Vn),N1.preRender.process(Vn),N1.render.process(Vn),Vn.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,OS.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(aX),this.sharedNodes.forEach(fX)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,kt.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){kt.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let u=0;u<this.path.length;u++)this.path[u].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=en(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let a=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(a=!1),a){const u=i(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:u,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:u}}}resetTransform(){if(!r)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,a=this.projectionDelta&&!nO(this.projectionDelta),u=this.getTransformTemplate(),h=u?u(this.latestValues,""):void 0,d=h!==this.prevTransformTemplateValue;o&&(a||Ll(this.latestValues)||d)&&(r(this.instance,h),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const a=this.measurePageBox();let u=this.removeElementScroll(a);return o&&(u=this.removeTransform(u)),_X(u),{animationId:this.root.animationId,measuredBox:a,layoutBox:u,latestValues:{},source:this.id}}measurePageBox(){var o;const{visualElement:a}=this.options;if(!a)return en();const u=a.measureViewportBox();if(!(((o=this.scroll)===null||o===void 0?void 0:o.wasRoot)||this.path.some(yX))){const{scroll:d}=this.root;d&&(jc(u.x,d.offset.x),jc(u.y,d.offset.y))}return u}removeElementScroll(o){var a;const u=en();if(mr(u,o),!((a=this.scroll)===null||a===void 0)&&a.wasRoot)return u;for(let h=0;h<this.path.length;h++){const d=this.path[h],{scroll:g,options:m}=d;d!==this.root&&g&&m.layoutScroll&&(g.wasRoot&&mr(u,o),jc(u.x,g.offset.x),jc(u.y,g.offset.y))}return u}applyTransform(o,a=!1){const u=en();mr(u,o);for(let h=0;h<this.path.length;h++){const d=this.path[h];!a&&d.options.layoutScroll&&d.scroll&&d!==d.root&&Uc(u,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),Ll(d.latestValues)&&Uc(u,d.latestValues)}return Ll(this.latestValues)&&Uc(u,this.latestValues),u}removeTransform(o){const a=en();mr(a,o);for(let u=0;u<this.path.length;u++){const h=this.path[u];if(!h.instance||!Ll(h.latestValues))continue;xw(h.latestValues)&&h.updateSnapshot();const d=en(),g=h.measurePageBox();mr(d,g),tM(a,h.latestValues,h.snapshot?h.snapshot.layoutBox:void 0,d)}return Ll(this.latestValues)&&tM(a,this.latestValues),a}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Vn.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var a;const u=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=u.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=u.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=u.isSharedProjectionDirty);const h=!!this.resumingFrom||this!==u;if(!(o||h&&this.isSharedProjectionDirty||this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:g,layoutId:m}=this.options;if(!(!this.layout||!(g||m))){if(this.resolvedRelativeTargetAt=Vn.timestamp,!this.targetDelta&&!this.relativeTarget){const v=this.getClosestProjectingParent();v&&v.layout&&this.animationProgress!==1?(this.relativeParent=v,this.forceRelativeParentToResolveTarget(),this.relativeTarget=en(),this.relativeTargetOrigin=en(),Sf(this.relativeTargetOrigin,this.layout.layoutBox,v.layout.layoutBox),mr(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=en(),this.targetWithTransforms=en()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),wq(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):mr(this.target,this.layout.layoutBox),YN(this.target,this.targetDelta)):mr(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const v=this.getClosestProjectingParent();v&&!!v.resumingFrom==!!this.resumingFrom&&!v.options.layoutScroll&&v.target&&this.animationProgress!==1?(this.relativeParent=v,this.forceRelativeParentToResolveTarget(),this.relativeTarget=en(),this.relativeTargetOrigin=en(),Sf(this.relativeTargetOrigin,this.target,v.target),mr(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}nf&&kl.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||xw(this.parent.latestValues)||XN(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const a=this.getLead(),u=!!this.resumingFrom||this!==a;let h=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(h=!1),u&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(h=!1),this.resolvedRelativeTargetAt===Vn.timestamp&&(h=!1),h)return;const{layout:d,layoutId:g}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||g))return;mr(this.layoutCorrected,this.layout.layoutBox);const m=this.treeScale.x,v=this.treeScale.y;Mq(this.layoutCorrected,this.treeScale,this.path,u),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox,a.targetWithTransforms=en());const{target:y}=a;if(!y){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(QC(this.prevProjectionDelta.x,this.projectionDelta.x),QC(this.prevProjectionDelta.y,this.projectionDelta.y)),xf(this.projectionDelta,this.layoutCorrected,y,this.latestValues),(this.treeScale.x!==m||this.treeScale.y!==v||!oM(this.projectionDelta.x,this.prevProjectionDelta.x)||!oM(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",y)),nf&&kl.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var a;if((a=this.options.visualElement)===null||a===void 0||a.scheduleRender(),o){const u=this.getStack();u&&u.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Gc(),this.projectionDelta=Gc(),this.projectionDeltaWithTransform=Gc()}setAnimationOrigin(o,a=!1){const u=this.snapshot,h=u?u.latestValues:{},d={...this.latestValues},g=Gc();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const m=en(),v=u?u.source:void 0,y=this.layout?this.layout.source:void 0,T=v!==y,w=this.getStack(),A=!w||w.members.length<=1,P=!!(T&&!A&&this.options.crossfade===!0&&!this.path.some(mX));this.animationProgress=0;let M;this.mixTargetDelta=k=>{const N=k/1e3;cM(g.x,o.x,N),cM(g.y,o.y,N),this.setTargetDelta(g),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Sf(m,this.layout.layoutBox,this.relativeParent.layout.layoutBox),gX(this.relativeTarget,this.relativeTargetOrigin,m,N),M&&Qq(this.relativeTarget,M)&&(this.isProjectionDirty=!1),M||(M=en()),mr(M,this.relativeTarget)),T&&(this.animationValues=d,Kq(d,h,this.latestValues,N,P,A)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=N},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Ua(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=kt.update(()=>{e_.hasAnimatedSinceResize=!0,this.currentAnimation=jq(0,aM,{...o,onUpdate:a=>{this.mixTargetDelta(a),o.onUpdate&&o.onUpdate(a)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(aM),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:a,target:u,layout:h,latestValues:d}=o;if(!(!a||!u||!h)){if(this!==o&&this.layout&&h&&oO(this.options.animationType,this.layout.layoutBox,h.layoutBox)){u=this.target||en();const g=Qi(this.layout.layoutBox.x);u.x.min=o.target.x.min,u.x.max=u.x.min+g;const m=Qi(this.layout.layoutBox.y);u.y.min=o.target.y.min,u.y.max=u.y.min+m}mr(a,u),Uc(a,d),xf(this.projectionDeltaWithTransform,this.layoutCorrected,a,d)}}registerSharedNode(o,a){this.sharedNodes.has(o)||this.sharedNodes.set(o,new Jq),this.sharedNodes.get(o).add(a);const h=a.options.initialPromotionConfig;a.promote({transition:h?h.transition:void 0,preserveFollowOpacity:h&&h.shouldPreserveFollowOpacity?h.shouldPreserveFollowOpacity(a):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:a}=this.options;return a?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:a}=this.options;return a?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:a,preserveFollowOpacity:u}={}){const h=this.getStack();h&&h.promote(this,u),o&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let a=!1;const{latestValues:u}=o;if((u.z||u.rotate||u.rotateX||u.rotateY||u.rotateZ||u.skewX||u.skewY)&&(a=!0),!a)return;const h={};u.z&&W1("z",o,h,this.animationValues);for(let d=0;d<$1.length;d++)W1(`rotate${$1[d]}`,o,h,this.animationValues),W1(`skew${$1[d]}`,o,h,this.animationValues);o.render();for(const d in h)o.setStaticValue(d,h[d]),this.animationValues&&(this.animationValues[d]=h[d]);o.scheduleRender()}getProjectionStyles(o){var a,u;if(!this.instance||this.isSVG)return;if(!this.isVisible)return tX;const h={visibility:""},d=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,h.opacity="",h.pointerEvents=Qp(o?.pointerEvents)||"",h.transform=d?d(this.latestValues,""):"none",h;const g=this.getLead();if(!this.projectionDelta||!this.layout||!g.target){const T={};return this.options.layoutId&&(T.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,T.pointerEvents=Qp(o?.pointerEvents)||""),this.hasProjected&&!Ll(this.latestValues)&&(T.transform=d?d({},""):"none",this.hasProjected=!1),T}const m=g.animationValues||g.latestValues;this.applyTransformsToTarget(),h.transform=eX(this.projectionDeltaWithTransform,this.treeScale,m),d&&(h.transform=d(m,h.transform));const{x:v,y}=this.projectionDelta;h.transformOrigin=`${v.origin*100}% ${y.origin*100}% 0`,g.animationValues?h.opacity=g===this?(u=(a=m.opacity)!==null&&a!==void 0?a:this.latestValues.opacity)!==null&&u!==void 0?u:1:this.preserveOpacity?this.latestValues.opacity:m.opacityExit:h.opacity=g===this?m.opacity!==void 0?m.opacity:"":m.opacityExit!==void 0?m.opacityExit:0;for(const T in J_){if(m[T]===void 0)continue;const{correct:w,applyTo:A}=J_[T],P=h.transform==="none"?m[T]:w(m[T],g);if(A){const M=A.length;for(let k=0;k<M;k++)h[A[k]]=P}else h[T]=P}return this.options.layoutId&&(h.pointerEvents=g===this?Qp(o?.pointerEvents)||"":"none"),h}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var a;return(a=o.currentAnimation)===null||a===void 0?void 0:a.stop()}),this.root.nodes.forEach(lM),this.root.sharedNodes.clear()}}}function iX(n){n.updateLayout()}function rX(n){var e;const t=((e=n.resumeFrom)===null||e===void 0?void 0:e.snapshot)||n.snapshot;if(n.isLead()&&n.layout&&t&&n.hasListeners("didUpdate")){const{layoutBox:i,measuredBox:r}=n.layout,{animationType:s}=n.options,o=t.source!==n.layout.source;s==="size"?pr(g=>{const m=o?t.measuredBox[g]:t.layoutBox[g],v=Qi(m);m.min=i[g].min,m.max=m.min+v}):oO(s,t.layoutBox,i)&&pr(g=>{const m=o?t.measuredBox[g]:t.layoutBox[g],v=Qi(i[g]);m.max=m.min+v,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[g].max=n.relativeTarget[g].min+v)});const a=Gc();xf(a,i,t.layoutBox);const u=Gc();o?xf(u,n.applyTransform(r,!0),t.measuredBox):xf(u,i,t.layoutBox);const h=!nO(a);let d=!1;if(!n.resumeFrom){const g=n.getClosestProjectingParent();if(g&&!g.resumeFrom){const{snapshot:m,layout:v}=g;if(m&&v){const y=en();Sf(y,t.layoutBox,m.layoutBox);const T=en();Sf(T,i,v.layoutBox),iO(y,T)||(d=!0),g.options.layoutRoot&&(n.relativeTarget=T,n.relativeTargetOrigin=y,n.relativeParent=g)}}}n.notifyListeners("didUpdate",{layout:i,snapshot:t,delta:u,layoutDelta:a,hasLayoutChanged:h,hasRelativeTargetChanged:d})}else if(n.isLead()){const{onExitComplete:i}=n.options;i&&i()}n.options.transition=void 0}function sX(n){nf&&kl.totalNodes++,n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function oX(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function aX(n){n.clearSnapshot()}function lM(n){n.clearMeasurements()}function lX(n){n.isLayoutDirty=!1}function uX(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function uM(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function cX(n){n.resolveTargetDelta()}function hX(n){n.calcProjection()}function dX(n){n.resetSkewAndRotation()}function fX(n){n.removeLeadSnapshot()}function cM(n,e,t){n.translate=$t(e.translate,0,t),n.scale=$t(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function hM(n,e,t,i){n.min=$t(e.min,t.min,i),n.max=$t(e.max,t.max,i)}function gX(n,e,t,i){hM(n.x,e.x,t.x,i),hM(n.y,e.y,t.y,i)}function mX(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const pX={duration:.45,ease:[.4,0,.1,1]},dM=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),fM=dM("applewebkit/")&&!dM("chrome/")?Math.round:qi;function gM(n){n.min=fM(n.min),n.max=fM(n.max)}function _X(n){gM(n.x),gM(n.y)}function oO(n,e,t){return n==="position"||n==="preserve-aspect"&&!Eq(sM(e),sM(t),.2)}function yX(n){var e;return n!==n.root&&((e=n.scroll)===null||e===void 0?void 0:e.wasRoot)}const vX=sO({attachResizeListener:(n,e)=>lg(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),K1={current:void 0},aO=sO({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!K1.current){const n=new vX({});n.mount(window),n.setOptions({layoutScroll:!0}),K1.current=n}return K1.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),EX={pan:{Feature:Oq},drag:{Feature:Nq,ProjectionNode:aO,MeasureLayout:JN}};function mM(n,e,t){const{props:i}=n;n.animationState&&i.whileHover&&n.animationState.setActive("whileHover",t==="Start");const r="onHover"+t,s=i[r];s&&kt.postRender(()=>s(e,zg(e)))}class wX extends Xa{mount(){const{current:e}=this.node;e&&(this.unmount=EK(e,t=>(mM(this.node,t,"Start"),i=>mM(this.node,i,"End"))))}unmount(){}}class xX extends Xa{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Bg(lg(this.node.current,"focus",()=>this.onFocus()),lg(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function pM(n,e,t){const{props:i}=n;n.animationState&&i.whileTap&&n.animationState.setActive("whileTap",t==="Start");const r="onTap"+(t==="End"?"":t),s=i[r];s&&kt.postRender(()=>s(e,zg(e)))}class SX extends Xa{mount(){const{current:e}=this.node;e&&(this.unmount=TK(e,t=>(pM(this.node,t,"Start"),(i,{success:r})=>pM(this.node,i,r?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const Tw=new WeakMap,H1=new WeakMap,TX=n=>{const e=Tw.get(n.target);e&&e(n)},IX=n=>{n.forEach(TX)};function AX({root:n,...e}){const t=n||document;H1.has(t)||H1.set(t,{});const i=H1.get(t),r=JSON.stringify(e);return i[r]||(i[r]=new IntersectionObserver(IX,{root:n,...e})),i[r]}function RX(n,e,t){const i=AX(e);return Tw.set(n,t),i.observe(n),()=>{Tw.delete(n),i.unobserve(n)}}const PX={some:0,all:1};class CX extends Xa{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:i,amount:r="some",once:s}=e,o={root:t?t.current:void 0,rootMargin:i,threshold:typeof r=="number"?r:PX[r]},a=u=>{const{isIntersecting:h}=u;if(this.isInView===h||(this.isInView=h,s&&!h&&this.hasEnteredView))return;h&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",h);const{onViewportEnter:d,onViewportLeave:g}=this.node.getProps(),m=h?d:g;m&&m(u)};return RX(this.node.current,o,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(MX(e,t))&&this.startObserver()}unmount(){}}function MX({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const bX={inView:{Feature:CX},tap:{Feature:SX},focus:{Feature:xX},hover:{Feature:wX}},LX={layout:{ProjectionNode:aO,MeasureLayout:JN}},Iw={current:null},lO={current:!1};function kX(){if(lO.current=!0,!!bS)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>Iw.current=n.matches;n.addListener(e),e()}else Iw.current=!1}const DX=[...kN,qn,Ba],NX=n=>DX.find(LN(n)),_M=new WeakMap;function OX(n,e,t){for(const i in e){const r=e[i],s=t[i];if(ei(r))n.addValue(i,r);else if(ei(s))n.addValue(i,og(r,{owner:n}));else if(s!==r)if(n.hasValue(i)){const o=n.getValue(i);o.liveStyle===!0?o.jump(r):o.hasAnimated||o.set(r)}else{const o=n.getStaticValue(i);n.addValue(i,og(o!==void 0?o:r,{owner:n}))}}for(const i in t)e[i]===void 0&&n.removeValue(i);return e}const yM=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class VX{scrapeMotionValuesFromProps(e,t,i){return{}}constructor({parent:e,props:t,presenceContext:i,reducedMotionConfig:r,blockInitialAnimation:s,visualState:o},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=rT,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const v=ks.now();this.renderScheduledAt<v&&(this.renderScheduledAt=v,kt.render(this.render,!1,!0))};const{latestValues:u,renderState:h,onUpdate:d}=o;this.onUpdate=d,this.latestValues=u,this.baseTarget={...u},this.initialValues=t.initial?{...u}:{},this.renderState=h,this.parent=e,this.props=t,this.presenceContext=i,this.depth=e?e.depth+1:0,this.reducedMotionConfig=r,this.options=a,this.blockInitialAnimation=!!s,this.isControllingVariants=dy(t),this.isVariantNode=UD(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:g,...m}=this.scrapeMotionValuesFromProps(t,{},this);for(const v in m){const y=m[v];u[v]!==void 0&&ei(y)&&y.set(u[v],!1)}}mount(e){this.current=e,_M.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,i)=>this.bindToMotionValue(i,t)),lO.current||kX(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Iw.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){_M.delete(this.current),this.projection&&this.projection.unmount(),Ua(this.notifyUpdate),Ua(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const i=Pu.has(e),r=t.on("change",a=>{this.latestValues[e]=a,this.props.onUpdate&&kt.preRender(this.notifyUpdate),i&&this.projection&&(this.projection.isTransformDirty=!0)}),s=t.on("renderRequest",this.scheduleRender);let o;window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{r(),s(),o&&o(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in Ph){const t=Ph[e];if(!t)continue;const{isEnabled:i,Feature:r}=t;if(!this.features[e]&&r&&i(this.props)&&(this.features[e]=new r(this)),this.features[e]){const s=this.features[e];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):en()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let i=0;i<yM.length;i++){const r=yM[i];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const s="on"+r,o=e[s];o&&(this.propEventSubscriptions[r]=this.on(r,o))}this.prevMotionValues=OX(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const i=this.values.get(e);t!==i&&(i&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let i=this.values.get(e);return i===void 0&&t!==void 0&&(i=og(t===null?void 0:t,{owner:this}),this.addValue(e,i)),i}readValue(e,t){var i;let r=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(i=this.getBaseTargetFromProps(this.props,e))!==null&&i!==void 0?i:this.readValueFromInstance(this.current,e,this.options);return r!=null&&(typeof r=="string"&&(MN(r)||wN(r))?r=parseFloat(r):!NX(r)&&Ba.test(t)&&(r=RN(e,t)),this.setBaseTarget(e,ei(r)?r.get():r)),ei(r)?r.get():r}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;const{initial:i}=this.props;let r;if(typeof i=="string"||typeof i=="object"){const o=FS(this.props,i,(t=this.presenceContext)===null||t===void 0?void 0:t.custom);o&&(r=o[e])}if(i&&r!==void 0)return r;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!ei(s)?s:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new QS),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}}class uO extends VX{constructor(){super(...arguments),this.KeyframeResolver=DN}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:i}){delete t[e],delete i[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;ei(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function FX(n){return window.getComputedStyle(n)}class GX extends uO{constructor(){super(...arguments),this.type="html",this.renderInstance=YD}readValueFromInstance(e,t){if(Pu.has(t)){const i=iT(t);return i&&i.default||0}else{const i=FX(e),r=(HD(t)?i.getPropertyValue(t):i[t])||0;return typeof r=="string"?r.trim():r}}measureInstanceViewportBox(e,{transformPagePoint:t}){return ZN(e,t)}build(e,t,i){US(e,t,i.transformTemplate)}scrapeMotionValuesFromProps(e,t,i){return WS(e,t,i)}}class jX extends uO{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=en}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(Pu.has(t)){const i=iT(t);return i&&i.default||0}return t=ZD.has(t)?t:NS(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,i){return eN(e,t,i)}build(e,t,i){BS(e,t,this.isSVGTag,i.transformTemplate)}renderInstance(e,t,i,r){QD(e,t,i,r)}mount(e){this.isSVGTag=$S(e.tagName),super.mount(e)}}const UX=(n,e)=>VS(n)?new jX(e):new GX(e,{allowProjection:n!==ne.Fragment}),BX=fK({...hq,...bX,...EX,...LX},UX),Ji=PW(BX);const zX=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),$X=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,i)=>i?i.toUpperCase():t.toLowerCase()),vM=n=>{const e=$X(n);return e.charAt(0).toUpperCase()+e.slice(1)},cO=(...n)=>n.filter((e,t,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===t).join(" ").trim(),WX=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var KX={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const HX=ne.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:i,className:r="",children:s,iconNode:o,...a},u)=>ne.createElement("svg",{ref:u,...KX,width:e,height:e,stroke:n,strokeWidth:i?Number(t)*24/Number(e):t,className:cO("lucide",r),...!s&&!WX(a)&&{"aria-hidden":"true"},...a},[...o.map(([h,d])=>ne.createElement(h,d)),...Array.isArray(s)?s:[s]]));const _t=(n,e)=>{const t=ne.forwardRef(({className:i,...r},s)=>ne.createElement(HX,{ref:s,iconNode:e,className:cO(`lucide-${zX(vM(n))}`,`lucide-${n}`,i),...r}));return t.displayName=vM(n),t};const qX=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],XX=_t("arrow-left",qX);const YX=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],ZX=_t("arrow-right",YX);const QX=[["path",{d:"M7 17V7h10",key:"11bw93"}],["path",{d:"M17 17 7 7",key:"2786uv"}]],JX=_t("arrow-up-left",QX);const eY=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],tY=_t("arrow-up-right",eY);const nY=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],iY=_t("arrow-up",nY);const rY=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],sY=_t("check",rY);const oY=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],aY=_t("chevron-down",oY);const lY=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],uY=_t("chevron-right",lY);const cY=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],hO=_t("chevron-up",cY);const hY=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],dY=_t("circle-alert",hY);const fY=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],gY=_t("circle",fY);const mY=[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],pY=_t("compass",mY);const _Y=[["path",{d:"M20 20v-7a4 4 0 0 0-4-4H4",key:"1nkjon"}],["path",{d:"M9 14 4 9l5-5",key:"102s5s"}]],yY=_t("corner-up-left",_Y);const vY=[["path",{d:"m15 14 5-5-5-5",key:"12vg1m"}],["path",{d:"M4 20v-7a4 4 0 0 1 4-4h12",key:"1lu4f8"}]],EY=_t("corner-up-right",vY);const wY=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],xY=_t("folder-open",wY);const SY=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],TY=_t("folder",SY);const IY=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],dO=_t("layers",IY);const AY=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],RY=_t("loader-circle",AY);const PY=[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],CY=_t("locate-fixed",PY);const MY=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],fO=_t("map-pin",MY);const bY=[["path",{d:"m8 3 4 8 5-5 5 15H2L8 3z",key:"otkl63"}]],LY=_t("mountain",bY);const kY=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],lT=_t("navigation",kY);const DY=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],Aw=_t("rotate-ccw",DY);const NY=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],OY=_t("search",NY);const VY=[["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}],["path",{d:"M3.103 6.034h17.794",key:"awc11p"}],["path",{d:"M3.4 5.467a2 2 0 0 0-.4 1.2V20a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6.667a2 2 0 0 0-.4-1.2l-2-2.667A2 2 0 0 0 17 2H7a2 2 0 0 0-1.6.8z",key:"o988cm"}]],FY=_t("shopping-bag",VY);const GY=[["path",{d:"M10 5H3",key:"1qgfaw"}],["path",{d:"M12 19H3",key:"yhmn1j"}],["path",{d:"M14 3v4",key:"1sua03"}],["path",{d:"M16 17v4",key:"1q0r14"}],["path",{d:"M21 12h-9",key:"1o4lsq"}],["path",{d:"M21 19h-5",key:"1rlt1p"}],["path",{d:"M21 5h-7",key:"1oszz2"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M8 12H3",key:"a7s4jb"}]],jY=_t("sliders-horizontal",GY);const UY=[["path",{d:"M13 8c0-2.76-2.46-5-5.5-5S2 5.24 2 8h2l1-1 1 1h4",key:"foxbe7"}],["path",{d:"M13 7.14A5.82 5.82 0 0 1 16.5 6c3.04 0 5.5 2.24 5.5 5h-3l-1-1-1 1h-3",key:"18arnh"}],["path",{d:"M5.89 9.71c-2.15 2.15-2.3 5.47-.35 7.43l4.24-4.25.7-.7.71-.71 2.12-2.12c-1.95-1.96-5.27-1.8-7.42.35",key:"ywahnh"}],["path",{d:"M11 15.5c.5 2.5-.17 4.5-1 6.5h4c2-5.5-.5-12-1-14",key:"ft0feo"}]],BY=_t("tree-palm",UY);const zY=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],$Y=_t("volume-2",zY);const WY=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]],KY=_t("volume-x",WY);const HY=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],$g=_t("x",HY);function qY(){const{tracking:n,startTracking:e,stopTracking:t,updatePosition:i,setWatchId:r,resetFirstFix:s}=Ut(),o=ne.useCallback(u=>{i(u)},[i]),a=ne.useCallback(u=>{console.error("GPS error:",u),alert(`GPS fout: ${u.message}`),t()},[t]);return ne.useEffect(()=>{if(!n)return;if(!navigator.geolocation){alert("Geolocation wordt niet ondersteund door deze browser"),t();return}const u=navigator.geolocation.watchPosition(o,a,{enableHighAccuracy:!0,maximumAge:1e3,timeout:15e3});return r(u),()=>{navigator.geolocation.clearWatch(u)}},[n,o,a,r,t]),{tracking:n,start:e,stop:t,toggle:()=>n?t():e()}}function XY(){const{tracking:n,toggle:e}=qY();return G.jsx(Ji.button,{className:`
        fixed bottom-[30px] md:bottom-10 right-2.5 z-[1000]
        w-11 h-11 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${n?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},animate:n?{scale:[1,1.02,1]}:{},transition:n?{scale:{duration:2,repeat:1/0,ease:"easeInOut"}}:{},"aria-label":n?"GPS tracking actief":"GPS tracking starten",title:n?"GPS tracking actief":"GPS tracking starten",children:G.jsx(CY,{size:22,strokeWidth:2})})}function YY(){const n=Hi(T=>T.map),e=Hi(T=>T.rotation),t=Ut(T=>T.position),i=Ut(T=>T.accuracy),r=Ut(T=>T.tracking),s=Ut(T=>T.navigationMode),o=Ut(T=>T.smoothHeading),a=Ut(T=>T.firstFix),u=Ut(T=>T.resetFirstFix),h=Ut(T=>T.config.centerOnUser),d=Ut(T=>T.config.animationDuration),g=ne.useRef(null),m=ne.useRef(null),v=ne.useRef(null),y=ne.useRef(null);return ne.useEffect(()=>{if(!n||!r&&!t)return;const T=Aa([5.1214,52.0907]);return g.current=new af({geometry:new d_(T)}),g.current.setStyle(new Mi({image:new iu({radius:10,fill:new Wr({color:"#4285F4"}),stroke:new Kr({color:"white",width:4})})})),m.current=new af({geometry:new d_(T)}),v.current=new af({geometry:new nu([[[0,0],[0,0],[0,0],[0,0]]])}),v.current.setStyle(new Mi({fill:new Wr({color:"rgba(66, 133, 244, 0.5)"}),stroke:new Kr({color:"#4285f4",width:2})})),y.current=new r4({source:new jb({features:[m.current,v.current,g.current]}),zIndex:1e3}),n.addLayer(y.current),()=>{y.current&&n&&n.removeLayer(y.current)}},[n,r,t]),ne.useEffect(()=>{if(!n||!t||!g.current||!m.current)return;const T=Aa([t.lng,t.lat]);if(g.current.getGeometry()?.setCoordinates(T),m.current.getGeometry()?.setCoordinates(T),i){const w=n.getView().getResolution()||1,A=i/w;m.current.setStyle(new Mi({image:new iu({radius:Math.min(A,100),fill:new Wr({color:"rgba(66, 133, 244, 0.15)"}),stroke:new Kr({color:"#4285f4",width:2})})}))}a&&r&&(n.getView().setCenter(T),n.getView().setZoom(17),u(),console.log(" GPS locked - jumped to position + street level")),r&&h&&!a&&n.getView().animate({center:T,duration:d})},[n,r,t,i,a,u,h,d]),ne.useEffect(()=>{if(!n||!t||!v.current||!g.current)return;const T=Aa([t.lng,t.lat]),w=n.getView(),A=w.getResolution()||1,P=10,M=P*3*A,k=Math.PI/4,N=w.getRotation();let B;s==="free"?B=o!==null?o*Math.PI/180:0:B=-N;const b=T[0]+Math.sin(B)*P*A,R=T[1]+Math.cos(B)*P*A,L=B-k/2,V=b+Math.sin(L)*M,F=R+Math.cos(L)*M,U=B+k/2,D=b+Math.sin(U)*M,le=R+Math.cos(U)*M,we=[[b,R],[V,F],[D,le],[b,R]];v.current.setGeometry(new nu([we])),v.current.setStyle(new Mi({fill:new Wr({color:"rgba(66, 133, 244, 0.18)"}),stroke:new Kr({color:"rgba(66, 133, 244, 0.1)",width:.5})}))},[n,t,e,s,o]),null}function ZY(){const n=PE(t=>t.layerControlOpen),e=PE(t=>t.toggleLayerControl);return G.jsx(Ji.button,{className:`
        fixed bottom-[85px] md:bottom-[95px] right-2.5 z-[1000]
        w-11 h-11 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${n?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":n?"Kaartlagen sluiten":"Kaartlagen openen",title:n?"Kaartlagen sluiten":"Kaartlagen openen",children:G.jsx(dO,{size:22,strokeWidth:2})})}function Es({title:n,children:e,defaultExpanded:t=!0}){const[i,r]=ne.useState(t);return G.jsxs("div",{className:"mb-0.5",children:[G.jsxs("button",{onClick:()=>r(!i),className:"w-full flex items-center gap-1 py-1 px-1 bg-transparent border-0 outline-none hover:bg-blue-100 transition-colors text-left",children:[G.jsx(Ji.span,{animate:{rotate:i?90:0},transition:{duration:.15},className:"text-gray-400",children:G.jsx(uY,{size:14})}),i?G.jsx(xY,{size:16,className:"text-blue-500"}):G.jsx(TY,{size:16,className:"text-blue-500"}),G.jsx("span",{className:"text-sm text-gray-700 font-medium",children:n})]}),G.jsx(Ru,{initial:!1,children:i&&G.jsx(Ji.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.15},style:{overflow:"hidden"},className:"ml-5",children:e})})]})}function Ee({name:n,type:e}){const t=lo(d=>d.visible[n]),i=lo(d=>d.loadingState[n]),r=lo(d=>d.toggleLayer),s=lo(d=>d.setLayerVisibility),o=i==="loading",a=i==="error",u=()=>{o||(e==="overlay"?r(n):["CartoDB Positron","OpenStreetMap","Satellite","TMK 1850","Bonnebladen 1900","Carte Cassini"].forEach(g=>{s(g,g===n)}))},h=t??!1;return G.jsxs("button",{onClick:u,disabled:o,className:`w-full flex items-center justify-between py-1 pl-3 pr-2 bg-transparent border-0 outline-none transition-colors text-left ${o?"opacity-70 cursor-wait":"hover:bg-blue-100"}`,children:[G.jsxs("span",{className:`text-sm ${a?"text-red-500":"text-gray-600"}`,children:[n,a&&G.jsx(dY,{size:12,className:"inline ml-1 text-red-500"})]}),G.jsx("div",{className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:o?"#93c5fd":h?"#3b82f6":"white",border:o?"2px solid #93c5fd":h?"2px solid #3b82f6":"2px solid #60a5fa",color:"white"},children:o?G.jsx(RY,{size:10,strokeWidth:3,className:"animate-spin"}):h?G.jsx(sY,{size:12,strokeWidth:3}):null})]})}function QY(){const{layerControlOpen:n,toggleLayerControl:e}=PE();return G.jsx(Ru,{children:n&&G.jsxs(Ji.div,{className:"fixed top-2.5 right-2.5 z-[999] bg-white rounded-lg shadow-lg overflow-hidden w-[280px] max-h-[calc(100vh-220px)] flex flex-col",initial:{opacity:0,scale:.95,y:-10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-10},transition:{duration:.15},children:[G.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-gradient-to-r from-blue-500 to-blue-600 text-white",children:[G.jsx("span",{className:"font-medium text-sm",children:"Kaartlagen"}),G.jsx("button",{onClick:e,className:"p-0.5 rounded border-0 outline-none hover:bg-white/20 transition-colors",children:G.jsx($g,{size:16})})]}),G.jsxs("div",{className:"p-2 overflow-y-auto flex-1",children:[G.jsxs(Es,{title:"Achtergrond",defaultExpanded:!0,children:[G.jsx(Ee,{name:"CartoDB Positron",type:"base"}),G.jsx(Ee,{name:"OpenStreetMap",type:"base"}),G.jsx(Ee,{name:"Satellite",type:"base"}),G.jsx(Ee,{name:"TMK 1850",type:"base"}),G.jsx(Ee,{name:"Bonnebladen 1900",type:"base"}),G.jsx(Ee,{name:"Carte Cassini",type:"base"})]}),G.jsxs(Es,{title:"Steentijd",defaultExpanded:!1,children:[G.jsx(Ee,{name:"Hunebedden",type:"overlay"}),G.jsx(Ee,{name:"EUROEVOL Sites",type:"overlay"}),G.jsx(Ee,{name:"FAMKE Steentijd",type:"overlay"}),G.jsx(Ee,{name:"Archeo Landschappen",type:"overlay"}),G.jsx(Ee,{name:"IKAW",type:"overlay"})]}),G.jsxs(Es,{title:"Archeologische lagen",defaultExpanded:!1,children:[G.jsx(Ee,{name:"AMK Monumenten",type:"overlay"}),G.jsx(Ee,{name:"Archis-punten",type:"overlay"}),G.jsx(Ee,{name:"CAI Vlaanderen",type:"overlay"}),G.jsx(Ee,{name:"Romeinse wegen",type:"overlay"}),G.jsx(Ee,{name:"Castella (punten)",type:"overlay"}),G.jsx(Ee,{name:"Castella (lijnen)",type:"overlay"}),G.jsx(Ee,{name:"Oppida",type:"overlay"}),G.jsx(Ee,{name:"Kastelen",type:"overlay"}),G.jsx(Ee,{name:"Toestemmingen",type:"overlay"}),G.jsx(Ee,{name:"Vici.org Romeins",type:"overlay"})]}),G.jsxs(Es,{title:"Frankrijk",defaultExpanded:!1,children:[G.jsx(Ee,{name:"Archeo Sites Bretagne",type:"overlay"}),G.jsx(Ee,{name:"Operaties Bretagne",type:"overlay"}),G.jsx(Ee,{name:"Archeo Parijs",type:"overlay"}),G.jsx(Ee,{name:"Sites Patrimoine Occitanie",type:"overlay"}),G.jsx(Ee,{name:"Sites Patrimoine PACA",type:"overlay"}),G.jsx(Ee,{name:"Maginotlinie",type:"overlay"}),G.jsx(Ee,{name:"Sites Patrimoine Normandie",type:"overlay"}),G.jsx(Ee,{name:"INRAP Sites FR",type:"overlay"}),G.jsx(Ee,{name:"Hist. Gebouwen FR",type:"overlay"})]}),G.jsxs(Es,{title:"Belgi",defaultExpanded:!1,children:[G.jsx(Ee,{name:"Archeo Zones Vlaanderen",type:"overlay"}),G.jsx(Ee,{name:"Beschermde Sites Vlaanderen",type:"overlay"}),G.jsx(Ee,{name:"Monumenten BE",type:"overlay"}),G.jsx(Ee,{name:"Archeo Zones BE",type:"overlay"}),G.jsx(Ee,{name:"Arch Sites BE",type:"overlay"}),G.jsx(Ee,{name:"Erfgoed Landschap BE",type:"overlay"}),G.jsx(Ee,{name:"CAI Elementen",type:"overlay"})]}),G.jsxs(Es,{title:"Uiterwaarden",defaultExpanded:!1,children:[G.jsx(Ee,{name:"Archeo Punten",type:"overlay"}),G.jsx(Ee,{name:"Vlakken",type:"overlay"}),G.jsx(Ee,{name:"Expert",type:"overlay"}),G.jsx(Ee,{name:"Bufferlaag",type:"overlay"}),G.jsx(Ee,{name:"Indeling",type:"overlay"})]}),G.jsxs(Es,{title:"Hillshade & LiDAR",defaultExpanded:!1,children:[G.jsx(Ee,{name:"AHN4 Hillshade NL",type:"overlay"}),G.jsx(Ee,{name:"AHN4 Multi-Hillshade NL",type:"overlay"}),G.jsx(Ee,{name:"AHN4 Helling NL",type:"overlay"}),G.jsx(Ee,{name:"AHN 0.5m",type:"overlay"}),G.jsx(Ee,{name:"Hillshade Vlaanderen 25cm",type:"overlay"}),G.jsx(Ee,{name:"Skyview Vlaanderen 25cm",type:"overlay"}),G.jsx(Ee,{name:"DTM Vlaanderen 1m",type:"overlay"}),G.jsx(Ee,{name:"Hillshade Walloni",type:"overlay"}),G.jsx(Ee,{name:"Hillshade NRW 25cm",type:"overlay"}),G.jsx(Ee,{name:"Hillshade NRW Kleur",type:"overlay"}),G.jsx(Ee,{name:"Hillshade Frankrijk",type:"overlay"}),G.jsx(Ee,{name:"LiDAR HD Frankrijk",type:"overlay"}),G.jsx(Ee,{name:"RGE Alti Frankrijk 1m",type:"overlay"}),G.jsx(Ee,{name:"Hoogtelijn Frankrijk",type:"overlay"})]}),G.jsxs(Es,{title:"Terrein & Bodem",defaultExpanded:!1,children:[G.jsx(Ee,{name:"Veengebieden",type:"overlay"}),G.jsx(Ee,{name:"Geomorfologie",type:"overlay"}),G.jsx(Ee,{name:"Bodemkaart",type:"overlay"})]}),G.jsxs(Es,{title:"Fossielen (vondsten)",defaultExpanded:!1,children:[G.jsx(Ee,{name:"Fossielen Nederland",type:"overlay"}),G.jsx(Ee,{name:"Fossielen Belgi",type:"overlay"}),G.jsx(Ee,{name:"Fossielen Duitsland",type:"overlay"}),G.jsx(Ee,{name:"Fossielen Frankrijk",type:"overlay"})]}),G.jsxs(Es,{title:"Recreatie",defaultExpanded:!1,children:[G.jsx(Ee,{name:"Parken",type:"overlay"}),G.jsx(Ee,{name:"Speeltuinen",type:"overlay"}),G.jsx(Ee,{name:"Musea",type:"overlay"}),G.jsx(Ee,{name:"Strandjes",type:"overlay"}),G.jsx(Ee,{name:"Kringloopwinkels",type:"overlay"})]})]})]})})}function JY(n){n("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),n("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),n("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs");for(var e=1;e<=60;++e)n("EPSG:"+(32600+e),"+proj=utm +zone="+e+" +datum=WGS84 +units=m"),n("EPSG:"+(32700+e),"+proj=utm +zone="+e+" +south +datum=WGS84 +units=m");n("EPSG:5041","+title=WGS 84 / UPS North (E,N) +proj=stere +lat_0=90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m"),n("EPSG:5042","+title=WGS 84 / UPS South (E,N) +proj=stere +lat_0=-90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m"),n.WGS84=n["EPSG:4326"],n["EPSG:3785"]=n["EPSG:3857"],n.GOOGLE=n["EPSG:3857"],n["EPSG:900913"]=n["EPSG:3857"],n["EPSG:102113"]=n["EPSG:3857"]}var yu=1,vu=2,ih=3,eZ=4,Rw=5,EM=6378137,tZ=6356752314e-3,wM=.0066943799901413165,Tf=484813681109536e-20,se=Math.PI/2,nZ=.16666666666666666,iZ=.04722222222222222,rZ=.022156084656084655,ge=1e-10,Ht=.017453292519943295,Li=57.29577951308232,gt=Math.PI/4,ug=Math.PI*2,nn=3.14159265359,ki={};ki.greenwich=0;ki.lisbon=-9.131906111111;ki.paris=2.337229166667;ki.bogota=-74.080916666667;ki.madrid=-3.687938888889;ki.rome=12.452333333333;ki.bern=7.439583333333;ki.jakarta=106.807719444444;ki.ferro=-17.666666666667;ki.brussels=4.367975;ki.stockholm=18.058277777778;ki.athens=23.7163375;ki.oslo=10.722916666667;const sZ={mm:{to_meter:.001},cm:{to_meter:.01},ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937},fath:{to_meter:1.8288},kmi:{to_meter:1852},"us-ch":{to_meter:20.1168402336805},"us-mi":{to_meter:1609.34721869444},km:{to_meter:1e3},"ind-ft":{to_meter:.30479841},"ind-yd":{to_meter:.91439523},mi:{to_meter:1609.344},yd:{to_meter:.9144},ch:{to_meter:20.1168},link:{to_meter:.201168},dm:{to_meter:.1},in:{to_meter:.0254},"ind-ch":{to_meter:20.11669506},"us-in":{to_meter:.025400050800101},"us-yd":{to_meter:.914401828803658}};var xM=/[\s_\-\/\(\)]/g;function za(n,e){if(n[e])return n[e];for(var t=Object.keys(n),i=e.toLowerCase().replace(xM,""),r=-1,s,o;++r<t.length;)if(s=t[r],o=s.toLowerCase().replace(xM,""),o===i)return n[s]}function Pw(n){var e={},t=n.split("+").map(function(a){return a.trim()}).filter(function(a){return a}).reduce(function(a,u){var h=u.split("=");return h.push(!0),a[h[0].toLowerCase()]=h[1],a},{}),i,r,s,o={proj:"projName",datum:"datumCode",rf:function(a){e.rf=parseFloat(a)},lat_0:function(a){e.lat0=a*Ht},lat_1:function(a){e.lat1=a*Ht},lat_2:function(a){e.lat2=a*Ht},lat_ts:function(a){e.lat_ts=a*Ht},lon_0:function(a){e.long0=a*Ht},lon_1:function(a){e.long1=a*Ht},lon_2:function(a){e.long2=a*Ht},alpha:function(a){e.alpha=parseFloat(a)*Ht},gamma:function(a){e.rectified_grid_angle=parseFloat(a)*Ht},lonc:function(a){e.longc=a*Ht},x_0:function(a){e.x0=parseFloat(a)},y_0:function(a){e.y0=parseFloat(a)},k_0:function(a){e.k0=parseFloat(a)},k:function(a){e.k0=parseFloat(a)},a:function(a){e.a=parseFloat(a)},b:function(a){e.b=parseFloat(a)},r:function(a){e.a=e.b=parseFloat(a)},r_a:function(){e.R_A=!0},zone:function(a){e.zone=parseInt(a,10)},south:function(){e.utmSouth=!0},towgs84:function(a){e.datum_params=a.split(",").map(function(u){return parseFloat(u)})},to_meter:function(a){e.to_meter=parseFloat(a)},units:function(a){e.units=a;var u=za(sZ,a);u&&(e.to_meter=u.to_meter)},from_greenwich:function(a){e.from_greenwich=a*Ht},pm:function(a){var u=za(ki,a);e.from_greenwich=(u||parseFloat(a))*Ht},nadgrids:function(a){a==="@null"?e.datumCode="none":e.nadgrids=a},axis:function(a){var u="ewnsud";a.length===3&&u.indexOf(a.substr(0,1))!==-1&&u.indexOf(a.substr(1,1))!==-1&&u.indexOf(a.substr(2,1))!==-1&&(e.axis=a)},approx:function(){e.approx=!0},over:function(){e.over=!0}};for(i in t)r=t[i],i in o?(s=o[i],typeof s=="function"?s(r):e[s]=r):e[i]=r;return typeof e.datumCode=="string"&&e.datumCode!=="WGS84"&&(e.datumCode=e.datumCode.toLowerCase()),e.projStr=n,e}class gO{static getId(e){const t=e.find(i=>Array.isArray(i)&&i[0]==="ID");return t&&t.length>=3?{authority:t[1],code:parseInt(t[2],10)}:null}static convertUnit(e,t="unit"){if(!e||e.length<3)return{type:t,name:"unknown",conversion_factor:null};const i=e[1],r=parseFloat(e[2])||null,s=e.find(a=>Array.isArray(a)&&a[0]==="ID"),o=s?{authority:s[1],code:parseInt(s[2],10)}:null;return{type:t,name:i,conversion_factor:r,id:o}}static convertAxis(e){const t=e[1]||"Unknown";let i;const r=t.match(/^\((.)\)$/);if(r){const h=r[1].toUpperCase();if(h==="E")i="east";else if(h==="N")i="north";else if(h==="U")i="up";else throw new Error(`Unknown axis abbreviation: ${h}`)}else i=e[2]?e[2].toLowerCase():"unknown";const s=e.find(h=>Array.isArray(h)&&h[0]==="ORDER"),o=s?parseInt(s[1],10):null,a=e.find(h=>Array.isArray(h)&&(h[0]==="LENGTHUNIT"||h[0]==="ANGLEUNIT"||h[0]==="SCALEUNIT")),u=this.convertUnit(a);return{name:t,direction:i,unit:u,order:o}}static extractAxes(e){return e.filter(t=>Array.isArray(t)&&t[0]==="AXIS").map(t=>this.convertAxis(t)).sort((t,i)=>(t.order||0)-(i.order||0))}static convert(e,t={}){switch(e[0]){case"PROJCRS":t.type="ProjectedCRS",t.name=e[1],t.base_crs=e.find(m=>Array.isArray(m)&&m[0]==="BASEGEOGCRS")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="BASEGEOGCRS")):null,t.conversion=e.find(m=>Array.isArray(m)&&m[0]==="CONVERSION")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="CONVERSION")):null;const i=e.find(m=>Array.isArray(m)&&m[0]==="CS");i&&(t.coordinate_system={type:i[1],axis:this.extractAxes(e)});const r=e.find(m=>Array.isArray(m)&&m[0]==="LENGTHUNIT");if(r){const m=this.convertUnit(r);t.coordinate_system.unit=m}t.id=this.getId(e);break;case"BASEGEOGCRS":case"GEOGCRS":t.type="GeographicCRS",t.name=e[1];const s=e.find(m=>Array.isArray(m)&&(m[0]==="DATUM"||m[0]==="ENSEMBLE"));if(s){const m=this.convert(s);s[0]==="ENSEMBLE"?t.datum_ensemble=m:t.datum=m;const v=e.find(y=>Array.isArray(y)&&y[0]==="PRIMEM");v&&v[1]!=="Greenwich"&&(m.prime_meridian={name:v[1],longitude:parseFloat(v[2])})}t.coordinate_system={type:"ellipsoidal",axis:this.extractAxes(e)},t.id=this.getId(e);break;case"DATUM":t.type="GeodeticReferenceFrame",t.name=e[1],t.ellipsoid=e.find(m=>Array.isArray(m)&&m[0]==="ELLIPSOID")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="ELLIPSOID")):null;break;case"ENSEMBLE":t.type="DatumEnsemble",t.name=e[1],t.members=e.filter(m=>Array.isArray(m)&&m[0]==="MEMBER").map(m=>({type:"DatumEnsembleMember",name:m[1],id:this.getId(m)}));const o=e.find(m=>Array.isArray(m)&&m[0]==="ENSEMBLEACCURACY");o&&(t.accuracy=parseFloat(o[1]));const a=e.find(m=>Array.isArray(m)&&m[0]==="ELLIPSOID");a&&(t.ellipsoid=this.convert(a)),t.id=this.getId(e);break;case"ELLIPSOID":t.type="Ellipsoid",t.name=e[1],t.semi_major_axis=parseFloat(e[2]),t.inverse_flattening=parseFloat(e[3]),e.find(m=>Array.isArray(m)&&m[0]==="LENGTHUNIT")&&this.convert(e.find(m=>Array.isArray(m)&&m[0]==="LENGTHUNIT"),t);break;case"CONVERSION":t.type="Conversion",t.name=e[1],t.method=e.find(m=>Array.isArray(m)&&m[0]==="METHOD")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="METHOD")):null,t.parameters=e.filter(m=>Array.isArray(m)&&m[0]==="PARAMETER").map(m=>this.convert(m));break;case"METHOD":t.type="Method",t.name=e[1],t.id=this.getId(e);break;case"PARAMETER":t.type="Parameter",t.name=e[1],t.value=parseFloat(e[2]),t.unit=this.convertUnit(e.find(m=>Array.isArray(m)&&(m[0]==="LENGTHUNIT"||m[0]==="ANGLEUNIT"||m[0]==="SCALEUNIT"))),t.id=this.getId(e);break;case"BOUNDCRS":t.type="BoundCRS";const u=e.find(m=>Array.isArray(m)&&m[0]==="SOURCECRS");if(u){const m=u.find(v=>Array.isArray(v));t.source_crs=m?this.convert(m):null}const h=e.find(m=>Array.isArray(m)&&m[0]==="TARGETCRS");if(h){const m=h.find(v=>Array.isArray(v));t.target_crs=m?this.convert(m):null}const d=e.find(m=>Array.isArray(m)&&m[0]==="ABRIDGEDTRANSFORMATION");d?t.transformation=this.convert(d):t.transformation=null;break;case"ABRIDGEDTRANSFORMATION":if(t.type="Transformation",t.name=e[1],t.method=e.find(m=>Array.isArray(m)&&m[0]==="METHOD")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="METHOD")):null,t.parameters=e.filter(m=>Array.isArray(m)&&(m[0]==="PARAMETER"||m[0]==="PARAMETERFILE")).map(m=>{if(m[0]==="PARAMETER")return this.convert(m);if(m[0]==="PARAMETERFILE")return{name:m[1],value:m[2],id:{authority:"EPSG",code:8656}}}),t.parameters.length===7){const m=t.parameters[6];m.name==="Scale difference"&&(m.value=Math.round((m.value-1)*1e12)/1e6)}t.id=this.getId(e);break;case"AXIS":t.coordinate_system||(t.coordinate_system={type:"unspecified",axis:[]}),t.coordinate_system.axis.push(this.convertAxis(e));break;case"LENGTHUNIT":const g=this.convertUnit(e,"LinearUnit");t.coordinate_system&&t.coordinate_system.axis&&t.coordinate_system.axis.forEach(m=>{m.unit||(m.unit=g)}),g.conversion_factor&&g.conversion_factor!==1&&t.semi_major_axis&&(t.semi_major_axis={value:t.semi_major_axis,unit:g});break;default:t.keyword=e[0];break}return t}}class oZ extends gO{static convert(e,t={}){return super.convert(e,t),t.coordinate_system&&t.coordinate_system.subtype==="Cartesian"&&delete t.coordinate_system,t.usage&&delete t.usage,t}}class aZ extends gO{static convert(e,t={}){super.convert(e,t);const i=e.find(s=>Array.isArray(s)&&s[0]==="CS");i&&(t.coordinate_system={subtype:i[1],axis:this.extractAxes(e)});const r=e.find(s=>Array.isArray(s)&&s[0]==="USAGE");if(r){const s=r.find(u=>Array.isArray(u)&&u[0]==="SCOPE"),o=r.find(u=>Array.isArray(u)&&u[0]==="AREA"),a=r.find(u=>Array.isArray(u)&&u[0]==="BBOX");t.usage={},s&&(t.usage.scope=s[1]),o&&(t.usage.area=o[1]),a&&(t.usage.bbox=a.slice(1))}return t}}function lZ(n){return n.find(e=>Array.isArray(e)&&e[0]==="USAGE")?"2019":(n.find(e=>Array.isArray(e)&&e[0]==="CS")||n[0]==="BOUNDCRS"||n[0]==="PROJCRS"||n[0]==="GEOGCRS","2015")}function uZ(n){return(lZ(n)==="2019"?aZ:oZ).convert(n)}function cZ(n){const e=n.toUpperCase();return e.includes("PROJCRS")||e.includes("GEOGCRS")||e.includes("BOUNDCRS")||e.includes("VERTCRS")||e.includes("LENGTHUNIT")||e.includes("ANGLEUNIT")||e.includes("SCALEUNIT")?"WKT2":(e.includes("PROJCS")||e.includes("GEOGCS")||e.includes("LOCAL_CS")||e.includes("VERT_CS")||e.includes("UNIT"),"WKT1")}var cg=1,mO=2,pO=3,s0=4,_O=5,uT=-1,hZ=/\s/,dZ=/[A-Za-z]/,fZ=/[A-Za-z84_]/,my=/[,\]]/,yO=/[\d\.E\-\+]/;function Mo(n){if(typeof n!="string")throw new Error("not a string");this.text=n.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=cg}Mo.prototype.readCharicter=function(){var n=this.text[this.place++];if(this.state!==s0)for(;hZ.test(n);){if(this.place>=this.text.length)return;n=this.text[this.place++]}switch(this.state){case cg:return this.neutral(n);case mO:return this.keyword(n);case s0:return this.quoted(n);case _O:return this.afterquote(n);case pO:return this.number(n);case uT:return}};Mo.prototype.afterquote=function(n){if(n==='"'){this.word+='"',this.state=s0;return}if(my.test(n)){this.word=this.word.trim(),this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in afterquote yet, index '+this.place)};Mo.prototype.afterItem=function(n){if(n===","){this.word!==null&&this.currentObject.push(this.word),this.word=null,this.state=cg;return}if(n==="]"){this.level--,this.word!==null&&(this.currentObject.push(this.word),this.word=null),this.state=cg,this.currentObject=this.stack.pop(),this.currentObject||(this.state=uT);return}};Mo.prototype.number=function(n){if(yO.test(n)){this.word+=n;return}if(my.test(n)){this.word=parseFloat(this.word),this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in number yet, index '+this.place)};Mo.prototype.quoted=function(n){if(n==='"'){this.state=_O;return}this.word+=n};Mo.prototype.keyword=function(n){if(fZ.test(n)){this.word+=n;return}if(n==="["){var e=[];e.push(this.word),this.level++,this.root===null?this.root=e:this.currentObject.push(e),this.stack.push(this.currentObject),this.currentObject=e,this.state=cg;return}if(my.test(n)){this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in keyword yet, index '+this.place)};Mo.prototype.neutral=function(n){if(dZ.test(n)){this.word=n,this.state=mO;return}if(n==='"'){this.word="",this.state=s0;return}if(yO.test(n)){this.word=n,this.state=pO;return}if(my.test(n)){this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in neutral yet, index '+this.place)};Mo.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===uT)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function gZ(n){var e=new Mo(n);return e.output()}function q1(n,e,t){Array.isArray(e)&&(t.unshift(e),e=null);var i=e?{}:n,r=t.reduce(function(s,o){return Bc(o,s),s},i);e&&(n[e]=r)}function Bc(n,e){if(!Array.isArray(n)){e[n]=!0;return}var t=n.shift();if(t==="PARAMETER"&&(t=n.shift()),n.length===1){if(Array.isArray(n[0])){e[t]={},Bc(n[0],e[t]);return}e[t]=n[0];return}if(!n.length){e[t]=!0;return}if(t==="TOWGS84"){e[t]=n;return}if(t==="AXIS"){t in e||(e[t]=[]),e[t].push(n);return}Array.isArray(t)||(e[t]={});var i;switch(t){case"UNIT":case"PRIMEM":case"VERT_DATUM":e[t]={name:n[0].toLowerCase(),convert:n[1]},n.length===3&&Bc(n[2],e[t]);return;case"SPHEROID":case"ELLIPSOID":e[t]={name:n[0],a:n[1],rf:n[2]},n.length===4&&Bc(n[3],e[t]);return;case"EDATUM":case"ENGINEERINGDATUM":case"LOCAL_DATUM":case"DATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":n[0]=["name",n[0]],q1(e,t,n);return;case"COMPD_CS":case"COMPOUNDCRS":case"FITTED_CS":case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"ENGCRS":case"ENGINEERINGCRS":n[0]=["name",n[0]],q1(e,t,n),e[t].type=t;return;default:for(i=-1;++i<n.length;)if(!Array.isArray(n[i]))return Bc(n,e[t]);return q1(e,t,n)}}var mZ=.017453292519943295;function Gr(n){return n*mZ}function vO(n){const e=(n.projName||"").toLowerCase().replace(/_/g," ");!n.long0&&n.longc&&(e==="albers conic equal area"||e==="lambert azimuthal equal area")&&(n.long0=n.longc),!n.lat_ts&&n.lat1&&(e==="stereographic south pole"||e==="polar stereographic (variant b)")?(n.lat0=Gr(n.lat1>0?90:-90),n.lat_ts=n.lat1,delete n.lat1):!n.lat_ts&&n.lat0&&(e==="polar stereographic"||e==="polar stereographic (variant a)")&&(n.lat_ts=n.lat0,n.lat0=Gr(n.lat0>0?90:-90),delete n.lat1)}function SM(n){let e={units:null,to_meter:void 0};return typeof n=="string"?(e.units=n.toLowerCase(),e.units==="metre"&&(e.units="meter"),e.units==="meter"&&(e.to_meter=1)):n&&n.name&&(e.units=n.name.toLowerCase(),e.units==="metre"&&(e.units="meter"),e.to_meter=n.conversion_factor),e}function TM(n){return typeof n=="object"?n.value*n.unit.conversion_factor:n}function IM(n,e){n.ellipsoid.radius?(e.a=n.ellipsoid.radius,e.rf=0):(e.a=TM(n.ellipsoid.semi_major_axis),n.ellipsoid.inverse_flattening!==void 0?e.rf=n.ellipsoid.inverse_flattening:n.ellipsoid.semi_major_axis!==void 0&&n.ellipsoid.semi_minor_axis!==void 0&&(e.rf=e.a/(e.a-TM(n.ellipsoid.semi_minor_axis))))}function o0(n,e={}){return!n||typeof n!="object"?n:n.type==="BoundCRS"?(o0(n.source_crs,e),n.transformation&&(n.transformation.method&&n.transformation.method.name==="NTv2"?e.nadgrids=n.transformation.parameters[0].value:e.datum_params=n.transformation.parameters.map(t=>t.value)),e):(Object.keys(n).forEach(t=>{const i=n[t];if(i!==null)switch(t){case"name":if(e.srsCode)break;e.name=i,e.srsCode=i;break;case"type":i==="GeographicCRS"?e.projName="longlat":i==="ProjectedCRS"&&n.conversion&&n.conversion.method&&(e.projName=n.conversion.method.name);break;case"datum":case"datum_ensemble":i.ellipsoid&&(e.ellps=i.ellipsoid.name,IM(i,e)),i.prime_meridian&&(e.from_greenwich=i.prime_meridian.longitude*Math.PI/180);break;case"ellipsoid":e.ellps=i.name,IM(i,e);break;case"prime_meridian":e.long0=(i.longitude||0)*Math.PI/180;break;case"coordinate_system":if(i.axis){if(e.axis=i.axis.map(r=>{const s=r.direction;if(s==="east")return"e";if(s==="north")return"n";if(s==="west")return"w";if(s==="south")return"s";throw new Error(`Unknown axis direction: ${s}`)}).join("")+"u",i.unit){const{units:r,to_meter:s}=SM(i.unit);e.units=r,e.to_meter=s}else if(i.axis[0]&&i.axis[0].unit){const{units:r,to_meter:s}=SM(i.axis[0].unit);e.units=r,e.to_meter=s}}break;case"id":i.authority&&i.code&&(e.title=i.authority+":"+i.code);break;case"conversion":i.method&&i.method.name&&(e.projName=i.method.name),i.parameters&&i.parameters.forEach(r=>{const s=r.name.toLowerCase().replace(/\s+/g,"_"),o=r.value;r.unit&&r.unit.conversion_factor?e[s]=o*r.unit.conversion_factor:r.unit==="degree"?e[s]=o*Math.PI/180:e[s]=o});break;case"unit":i.name&&(e.units=i.name.toLowerCase(),e.units==="metre"&&(e.units="meter")),i.conversion_factor&&(e.to_meter=i.conversion_factor);break;case"base_crs":o0(i,e),e.datumCode=i.id?i.id.authority+"_"+i.id.code:i.name;break}}),e.latitude_of_false_origin!==void 0&&(e.lat0=e.latitude_of_false_origin),e.longitude_of_false_origin!==void 0&&(e.long0=e.longitude_of_false_origin),e.latitude_of_standard_parallel!==void 0&&(e.lat0=e.latitude_of_standard_parallel,e.lat1=e.latitude_of_standard_parallel),e.latitude_of_1st_standard_parallel!==void 0&&(e.lat1=e.latitude_of_1st_standard_parallel),e.latitude_of_2nd_standard_parallel!==void 0&&(e.lat2=e.latitude_of_2nd_standard_parallel),e.latitude_of_projection_centre!==void 0&&(e.lat0=e.latitude_of_projection_centre),e.longitude_of_projection_centre!==void 0&&(e.longc=e.longitude_of_projection_centre),e.easting_at_false_origin!==void 0&&(e.x0=e.easting_at_false_origin),e.northing_at_false_origin!==void 0&&(e.y0=e.northing_at_false_origin),e.latitude_of_natural_origin!==void 0&&(e.lat0=e.latitude_of_natural_origin),e.longitude_of_natural_origin!==void 0&&(e.long0=e.longitude_of_natural_origin),e.longitude_of_origin!==void 0&&(e.long0=e.longitude_of_origin),e.false_easting!==void 0&&(e.x0=e.false_easting),e.easting_at_projection_centre&&(e.x0=e.easting_at_projection_centre),e.false_northing!==void 0&&(e.y0=e.false_northing),e.northing_at_projection_centre&&(e.y0=e.northing_at_projection_centre),e.standard_parallel_1!==void 0&&(e.lat1=e.standard_parallel_1),e.standard_parallel_2!==void 0&&(e.lat2=e.standard_parallel_2),e.scale_factor_at_natural_origin!==void 0&&(e.k0=e.scale_factor_at_natural_origin),e.scale_factor_at_projection_centre!==void 0&&(e.k0=e.scale_factor_at_projection_centre),e.scale_factor_on_pseudo_standard_parallel!==void 0&&(e.k0=e.scale_factor_on_pseudo_standard_parallel),e.azimuth!==void 0&&(e.alpha=e.azimuth),e.azimuth_at_projection_centre!==void 0&&(e.alpha=e.azimuth_at_projection_centre),e.angle_from_rectified_to_skew_grid&&(e.rectified_grid_angle=e.angle_from_rectified_to_skew_grid),vO(e),e)}var pZ=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function _Z(n,e){var t=e[0],i=e[1];!(t in n)&&i in n&&(n[t]=n[i],e.length===3&&(n[t]=e[2](n[t])))}function EO(n){for(var e=Object.keys(n),t=0,i=e.length;t<i;++t){var r=e[t];pZ.indexOf(r)!==-1&&yZ(n[r]),typeof n[r]=="object"&&EO(n[r])}}function yZ(n){if(n.AUTHORITY){var e=Object.keys(n.AUTHORITY)[0];e&&e in n.AUTHORITY&&(n.title=e+":"+n.AUTHORITY[e])}if(n.type==="GEOGCS"?n.projName="longlat":n.type==="LOCAL_CS"?(n.projName="identity",n.local=!0):typeof n.PROJECTION=="object"?n.projName=Object.keys(n.PROJECTION)[0]:n.projName=n.PROJECTION,n.AXIS){for(var t="",i=0,r=n.AXIS.length;i<r;++i){var s=[n.AXIS[i][0].toLowerCase(),n.AXIS[i][1].toLowerCase()];s[0].indexOf("north")!==-1||(s[0]==="y"||s[0]==="lat")&&s[1]==="north"?t+="n":s[0].indexOf("south")!==-1||(s[0]==="y"||s[0]==="lat")&&s[1]==="south"?t+="s":s[0].indexOf("east")!==-1||(s[0]==="x"||s[0]==="lon")&&s[1]==="east"?t+="e":(s[0].indexOf("west")!==-1||(s[0]==="x"||s[0]==="lon")&&s[1]==="west")&&(t+="w")}t.length===2&&(t+="u"),t.length===3&&(n.axis=t)}n.UNIT&&(n.units=n.UNIT.name.toLowerCase(),n.units==="metre"&&(n.units="meter"),n.UNIT.convert&&(n.type==="GEOGCS"?n.DATUM&&n.DATUM.SPHEROID&&(n.to_meter=n.UNIT.convert*n.DATUM.SPHEROID.a):n.to_meter=n.UNIT.convert));var o=n.GEOGCS;n.type==="GEOGCS"&&(o=n),o&&(o.DATUM?n.datumCode=o.DATUM.name.toLowerCase():n.datumCode=o.name.toLowerCase(),n.datumCode.slice(0,2)==="d_"&&(n.datumCode=n.datumCode.slice(2)),n.datumCode==="new_zealand_1949"&&(n.datumCode="nzgd49"),(n.datumCode==="wgs_1984"||n.datumCode==="world_geodetic_system_1984")&&(n.PROJECTION==="Mercator_Auxiliary_Sphere"&&(n.sphere=!0),n.datumCode="wgs84"),n.datumCode==="belge_1972"&&(n.datumCode="rnb72"),o.DATUM&&o.DATUM.SPHEROID&&(n.ellps=o.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),n.ellps.toLowerCase().slice(0,13)==="international"&&(n.ellps="intl"),n.a=o.DATUM.SPHEROID.a,n.rf=parseFloat(o.DATUM.SPHEROID.rf,10)),o.DATUM&&o.DATUM.TOWGS84&&(n.datum_params=o.DATUM.TOWGS84),~n.datumCode.indexOf("osgb_1936")&&(n.datumCode="osgb36"),~n.datumCode.indexOf("osni_1952")&&(n.datumCode="osni52"),(~n.datumCode.indexOf("tm65")||~n.datumCode.indexOf("geodetic_datum_of_1965"))&&(n.datumCode="ire65"),n.datumCode==="ch1903+"&&(n.datumCode="ch1903"),~n.datumCode.indexOf("israel")&&(n.datumCode="isr93")),n.b&&!isFinite(n.b)&&(n.b=n.a),n.rectified_grid_angle&&(n.rectified_grid_angle=Gr(n.rectified_grid_angle));function a(d){var g=n.to_meter||1;return d*g}var u=function(d){return _Z(n,d)},h=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",Gr],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",Gr],["x0","false_easting",a],["y0","false_northing",a],["long0","central_meridian",Gr],["lat0","latitude_of_origin",Gr],["lat0","standard_parallel_1",Gr],["lat1","standard_parallel_1",Gr],["lat2","standard_parallel_2",Gr],["azimuth","Azimuth"],["alpha","azimuth",Gr],["srsCode","name"]];h.forEach(u),vO(n)}function a0(n){if(typeof n=="object")return o0(n);const e=cZ(n);var t=gZ(n);if(e==="WKT2"){const s=uZ(t);return o0(s)}var i=t[0],r={};return Bc(t,r),EO(r),r[i]}function On(n){var e=this;if(arguments.length===2){var t=arguments[1];typeof t=="string"?t.charAt(0)==="+"?On[n]=Pw(arguments[1]):On[n]=a0(arguments[1]):t&&typeof t=="object"&&!("projName"in t)?On[n]=a0(arguments[1]):(On[n]=t,t||delete On[n])}else if(arguments.length===1){if(Array.isArray(n))return n.map(function(i){return Array.isArray(i)?On.apply(e,i):On(i)});if(typeof n=="string"){if(n in On)return On[n]}else"EPSG"in n?On["EPSG:"+n.EPSG]=n:"ESRI"in n?On["ESRI:"+n.ESRI]=n:"IAU2000"in n?On["IAU2000:"+n.IAU2000]=n:console.log(n);return}}JY(On);function vZ(n){return typeof n=="string"}function EZ(n){return n in On}function wZ(n){return n.indexOf("+")!==0&&n.indexOf("[")!==-1||typeof n=="object"&&!("srsCode"in n)}var xZ=["3857","900913","3785","102113"];function SZ(n){var e=za(n,"authority");if(e){var t=za(e,"epsg");return t&&xZ.indexOf(t)>-1}}function TZ(n){var e=za(n,"extension");if(e)return za(e,"proj4")}function IZ(n){return n[0]==="+"}function AZ(n){if(vZ(n)){if(EZ(n))return On[n];if(wZ(n)){var e=a0(n);if(SZ(e))return On["EPSG:3857"];var t=TZ(e);return t?Pw(t):e}if(IZ(n))return Pw(n)}else return"projName"in n?n:a0(n)}function AM(n,e){n=n||{};var t,i;if(!e)return n;for(i in e)t=e[i],t!==void 0&&(n[i]=t);return n}function Os(n,e,t){var i=n*e;return t/Math.sqrt(1-i*i)}function Wg(n){return n<0?-1:1}function _e(n,e){return e||Math.abs(n)<=nn?n:n-Wg(n)*ug}function Yr(n,e,t){var i=n*t,r=.5*n;return i=Math.pow((1-i)/(1+i),r),Math.tan(.5*(se-e))/i}function hg(n,e){for(var t=.5*n,i,r,s=se-2*Math.atan(e),o=0;o<=15;o++)if(i=n*Math.sin(s),r=se-2*Math.atan(e*Math.pow((1-i)/(1+i),t))-s,s+=r,Math.abs(r)<=1e-10)return s;return-9999}function RZ(){var n=this.b/this.a;this.es=1-n*n,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=Os(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function PZ(n){var e=n.x,t=n.y;if(t*Li>90&&t*Li<-90&&e*Li>180&&e*Li<-180)return null;var i,r;if(Math.abs(Math.abs(t)-se)<=ge)return null;if(this.sphere)i=this.x0+this.a*this.k0*_e(e-this.long0,this.over),r=this.y0+this.a*this.k0*Math.log(Math.tan(gt+.5*t));else{var s=Math.sin(t),o=Yr(this.e,t,s);i=this.x0+this.a*this.k0*_e(e-this.long0,this.over),r=this.y0-this.a*this.k0*Math.log(o)}return n.x=i,n.y=r,n}function CZ(n){var e=n.x-this.x0,t=n.y-this.y0,i,r;if(this.sphere)r=se-2*Math.atan(Math.exp(-t/(this.a*this.k0)));else{var s=Math.exp(-t/(this.a*this.k0));if(r=hg(this.e,s),r===-9999)return null}return i=_e(this.long0+e/(this.a*this.k0),this.over),n.x=i,n.y=r,n}var MZ=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","Mercator_Variant_A","merc"];const bZ={init:RZ,forward:PZ,inverse:CZ,names:MZ};function LZ(){}function RM(n){return n}var wO=["longlat","identity"];const kZ={init:LZ,forward:RM,inverse:RM,names:wO};var DZ=[bZ,kZ],Dl={},zc=[];function xO(n,e){var t=zc.length;return n.names?(zc[t]=n,n.names.forEach(function(i){Dl[i.toLowerCase()]=t}),this):(console.log(e),!0)}function SO(n){return n.replace(/[-\(\)\s]+/g," ").trim().replace(/ /g,"_")}function NZ(n){if(!n)return!1;var e=n.toLowerCase();if(typeof Dl[e]<"u"&&zc[Dl[e]]||(e=SO(e),e in Dl&&zc[Dl[e]]))return zc[Dl[e]]}function OZ(){DZ.forEach(xO)}const VZ={start:OZ,add:xO,get:NZ};var TO={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563396e-3,b:635625691e-2,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340189e-3,b:6356034446e-3,ellipseName:"Modified Airy"},andrae:{a:637710443e-2,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397155e-3,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483865e-3,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:63782064e-1,b:63565838e-1,ellipseName:"Clarke 1866"},clrk80:{a:6378249145e-3,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk80ign:{a:63782492e-1,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"},clrk58:{a:6378293645208759e-9,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:63757387e-1,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:637813605e-2,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276345e-3,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304063e-3,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301243e-3,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295664e-3,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298556e-3,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:63781575e-1,b:63567722e-1,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:63567733205e-4,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:63558348467e-4,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"},WGS84:{a:6378137,rf:298.257223563,ellipseName:"WGS 84"},sphere:{a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}};const FZ=TO.WGS84;function GZ(n,e,t,i){var r=n*n,s=e*e,o=(r-s)/r,a=0;i?(n*=1-o*(nZ+o*(iZ+o*rZ)),r=n*n,o=0):a=Math.sqrt(o);var u=(r-s)/s;return{es:o,e:a,ep2:u}}function jZ(n,e,t,i,r){if(!n){var s=za(TO,i);s||(s=FZ),n=s.a,e=s.b,t=s.rf}return t&&!e&&(e=(1-1/t)*n),(t===0||Math.abs(n-e)<ge)&&(r=!0,e=n),{a:n,b:e,rf:t,sphere:r}}var t_={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},mgi:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Ordnance Survey of Great Britain 1936"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"},EPSG_5451:{towgs84:"6.41,-49.05,-11.28,1.5657,0.5242,6.9718,-5.7649"},IGNF_LURESG:{towgs84:"-192.986,13.673,-39.309,-0.4099,-2.9332,2.6881,0.43"},EPSG_4614:{towgs84:"-119.4248,-303.65872,-11.00061,1.164298,0.174458,1.096259,3.657065"},EPSG_4615:{towgs84:"-494.088,-312.129,279.877,-1.423,-1.013,1.59,-0.748"},ESRI_37241:{towgs84:"-76.822,257.457,-12.817,2.136,-0.033,-2.392,-0.031"},ESRI_37249:{towgs84:"-440.296,58.548,296.265,1.128,10.202,4.559,-0.438"},ESRI_37245:{towgs84:"-511.151,-181.269,139.609,1.05,2.703,1.798,3.071"},EPSG_4178:{towgs84:"24.9,-126.4,-93.2,-0.063,-0.247,-0.041,1.01"},EPSG_4622:{towgs84:"-472.29,-5.63,-304.12,0.4362,-0.8374,0.2563,1.8984"},EPSG_4625:{towgs84:"126.93,547.94,130.41,-2.7867,5.1612,-0.8584,13.8227"},EPSG_5252:{towgs84:"0.023,0.036,-0.068,0.00176,0.00912,-0.01136,0.00439"},EPSG_4314:{towgs84:"597.1,71.4,412.1,0.894,0.068,-1.563,7.58"},EPSG_4282:{towgs84:"-178.3,-316.7,-131.5,5.278,6.077,10.979,19.166"},EPSG_4231:{towgs84:"-83.11,-97.38,-117.22,0.0276,-0.2167,0.2147,0.1218"},EPSG_4274:{towgs84:"-230.994,102.591,25.199,0.633,-0.239,0.9,1.95"},EPSG_4134:{towgs84:"-180.624,-225.516,173.919,-0.81,-1.898,8.336,16.71006"},EPSG_4254:{towgs84:"18.38,192.45,96.82,0.056,-0.142,-0.2,-0.0013"},EPSG_4159:{towgs84:"-194.513,-63.978,-25.759,-3.4027,3.756,-3.352,-0.9175"},EPSG_4687:{towgs84:"0.072,-0.507,-0.245,0.0183,-0.0003,0.007,-0.0093"},EPSG_4227:{towgs84:"-83.58,-397.54,458.78,-17.595,-2.847,4.256,3.225"},EPSG_4746:{towgs84:"599.4,72.4,419.2,-0.062,-0.022,-2.723,6.46"},EPSG_4745:{towgs84:"612.4,77,440.2,-0.054,0.057,-2.797,2.55"},EPSG_6311:{towgs84:"8.846,-4.394,-1.122,-0.00237,-0.146528,0.130428,0.783926"},EPSG_4289:{towgs84:"565.7381,50.4018,465.2904,-1.91514,1.60363,-9.09546,4.07244"},EPSG_4230:{towgs84:"-68.863,-134.888,-111.49,-0.53,-0.14,0.57,-3.4"},EPSG_4154:{towgs84:"-123.02,-158.95,-168.47"},EPSG_4156:{towgs84:"570.8,85.7,462.8,4.998,1.587,5.261,3.56"},EPSG_4299:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4179:{towgs84:"33.4,-146.6,-76.3,-0.359,-0.053,0.844,-0.84"},EPSG_4313:{towgs84:"-106.8686,52.2978,-103.7239,0.3366,-0.457,1.8422,-1.2747"},EPSG_4194:{towgs84:"163.511,127.533,-159.789"},EPSG_4195:{towgs84:"105,326,-102.5"},EPSG_4196:{towgs84:"-45,417,-3.5"},EPSG_4611:{towgs84:"-162.619,-276.959,-161.764,0.067753,-2.243649,-1.158827,-1.094246"},EPSG_4633:{towgs84:"137.092,131.66,91.475,-1.9436,-11.5993,-4.3321,-7.4824"},EPSG_4641:{towgs84:"-408.809,366.856,-412.987,1.8842,-0.5308,2.1655,-121.0993"},EPSG_4643:{towgs84:"-480.26,-438.32,-643.429,16.3119,20.1721,-4.0349,-111.7002"},EPSG_4300:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4188:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4660:{towgs84:"982.6087,552.753,-540.873,32.39344,-153.25684,-96.2266,16.805"},EPSG_4662:{towgs84:"97.295,-263.247,310.882,-1.5999,0.8386,3.1409,13.3259"},EPSG_3906:{towgs84:"577.88891,165.22205,391.18289,4.9145,-0.94729,-13.05098,7.78664"},EPSG_4307:{towgs84:"-209.3622,-87.8162,404.6198,0.0046,3.4784,0.5805,-1.4547"},EPSG_6892:{towgs84:"-76.269,-16.683,68.562,-6.275,10.536,-4.286,-13.686"},EPSG_4690:{towgs84:"221.597,152.441,176.523,2.403,1.3893,0.884,11.4648"},EPSG_4691:{towgs84:"218.769,150.75,176.75,3.5231,2.0037,1.288,10.9817"},EPSG_4629:{towgs84:"72.51,345.411,79.241,-1.5862,-0.8826,-0.5495,1.3653"},EPSG_4630:{towgs84:"165.804,216.213,180.26,-0.6251,-0.4515,-0.0721,7.4111"},EPSG_4692:{towgs84:"217.109,86.452,23.711,0.0183,-0.0003,0.007,-0.0093"},EPSG_9333:{towgs84:"0,0,0,-8.393,0.749,-10.276,0"},EPSG_9059:{towgs84:"0,0,0"},EPSG_4312:{towgs84:"601.705,84.263,485.227,4.7354,1.3145,5.393,-2.3887"},EPSG_4123:{towgs84:"-96.062,-82.428,-121.753,4.801,0.345,-1.376,1.496"},EPSG_4309:{towgs84:"-124.45,183.74,44.64,-0.4384,0.5446,-0.9706,-2.1365"},ESRI_104106:{towgs84:"-283.088,-70.693,117.445,-1.157,0.059,-0.652,-4.058"},EPSG_4281:{towgs84:"-219.247,-73.802,269.529"},EPSG_4322:{towgs84:"0,0,4.5"},EPSG_4324:{towgs84:"0,0,1.9"},EPSG_4284:{towgs84:"43.822,-108.842,-119.585,1.455,-0.761,0.737,0.549"},EPSG_4277:{towgs84:"446.448,-125.157,542.06,0.15,0.247,0.842,-20.489"},EPSG_4207:{towgs84:"-282.1,-72.2,120,-1.529,0.145,-0.89,-4.46"},EPSG_4688:{towgs84:"347.175,1077.618,2623.677,33.9058,-70.6776,9.4013,186.0647"},EPSG_4689:{towgs84:"410.793,54.542,80.501,-2.5596,-2.3517,-0.6594,17.3218"},EPSG_4720:{towgs84:"0,0,4.5"},EPSG_4273:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},EPSG_4240:{towgs84:"204.64,834.74,293.8"},EPSG_4817:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},ESRI_104131:{towgs84:"426.62,142.62,460.09,4.98,4.49,-12.42,-17.1"},EPSG_4265:{towgs84:"-104.1,-49.1,-9.9,0.971,-2.917,0.714,-11.68"},EPSG_4263:{towgs84:"-111.92,-87.85,114.5,1.875,0.202,0.219,0.032"},EPSG_4298:{towgs84:"-689.5937,623.84046,-65.93566,-0.02331,1.17094,-0.80054,5.88536"},EPSG_4270:{towgs84:"-253.4392,-148.452,386.5267,0.15605,0.43,-0.1013,-0.0424"},EPSG_4229:{towgs84:"-121.8,98.1,-10.7"},EPSG_4220:{towgs84:"-55.5,-348,-229.2"},EPSG_4214:{towgs84:"12.646,-155.176,-80.863"},EPSG_4232:{towgs84:"-345,3,223"},EPSG_4238:{towgs84:"-1.977,-13.06,-9.993,0.364,0.254,0.689,-1.037"},EPSG_4168:{towgs84:"-170,33,326"},EPSG_4131:{towgs84:"199,931,318.9"},EPSG_4152:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_5228:{towgs84:"572.213,85.334,461.94,4.9732,1.529,5.2484,3.5378"},EPSG_8351:{towgs84:"485.021,169.465,483.839,7.786342,4.397554,4.102655,0"},EPSG_4683:{towgs84:"-127.62,-67.24,-47.04,-3.068,4.903,1.578,-1.06"},EPSG_4133:{towgs84:"0,0,0"},EPSG_7373:{towgs84:"0.819,-0.5762,-1.6446,-0.00378,-0.03317,0.00318,0.0693"},EPSG_9075:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9072:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9294:{towgs84:"1.16835,-1.42001,-2.24431,-0.00822,-0.05508,0.01818,0.23388"},EPSG_4212:{towgs84:"-267.434,173.496,181.814,-13.4704,8.7154,7.3926,14.7492"},EPSG_4191:{towgs84:"-44.183,-0.58,-38.489,2.3867,2.7072,-3.5196,-8.2703"},EPSG_4237:{towgs84:"52.684,-71.194,-13.975,-0.312,-0.1063,-0.3729,1.0191"},EPSG_4740:{towgs84:"-1.08,-0.27,-0.9"},EPSG_4124:{towgs84:"419.3836,99.3335,591.3451,0.850389,1.817277,-7.862238,-0.99496"},EPSG_5681:{towgs84:"584.9636,107.7175,413.8067,1.1155,0.2824,-3.1384,7.9922"},EPSG_4141:{towgs84:"23.772,17.49,17.859,-0.3132,-1.85274,1.67299,-5.4262"},EPSG_4204:{towgs84:"-85.645,-273.077,-79.708,2.289,-1.421,2.532,3.194"},EPSG_4319:{towgs84:"226.702,-193.337,-35.371,-2.229,-4.391,9.238,0.9798"},EPSG_4200:{towgs84:"24.82,-131.21,-82.66"},EPSG_4130:{towgs84:"0,0,0"},EPSG_4127:{towgs84:"-82.875,-57.097,-156.768,-2.158,1.524,-0.982,-0.359"},EPSG_4149:{towgs84:"674.374,15.056,405.346"},EPSG_4617:{towgs84:"-0.991,1.9072,0.5129,1.25033e-7,4.6785e-8,5.6529e-8,0"},EPSG_4663:{towgs84:"-210.502,-66.902,-48.476,2.094,-15.067,-5.817,0.485"},EPSG_4664:{towgs84:"-211.939,137.626,58.3,-0.089,0.251,0.079,0.384"},EPSG_4665:{towgs84:"-105.854,165.589,-38.312,-0.003,-0.026,0.024,-0.048"},EPSG_4666:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},EPSG_4756:{towgs84:"-192.873,-39.382,-111.202,-0.00205,-0.0005,0.00335,0.0188"},EPSG_4723:{towgs84:"-179.483,-69.379,-27.584,-7.862,8.163,6.042,-13.925"},EPSG_4726:{towgs84:"8.853,-52.644,180.304,-0.393,-2.323,2.96,-24.081"},EPSG_4267:{towgs84:"-8.0,160.0,176.0"},EPSG_5365:{towgs84:"-0.16959,0.35312,0.51846,0.03385,-0.16325,0.03446,0.03693"},EPSG_4218:{towgs84:"304.5,306.5,-318.1"},EPSG_4242:{towgs84:"-33.722,153.789,94.959,-8.581,-4.478,4.54,8.95"},EPSG_4216:{towgs84:"-292.295,248.758,429.447,4.9971,2.99,6.6906,1.0289"},ESRI_104105:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},ESRI_104129:{towgs84:"0,0,0"},EPSG_4673:{towgs84:"174.05,-25.49,112.57"},EPSG_4202:{towgs84:"-124,-60,154"},EPSG_4203:{towgs84:"-117.763,-51.51,139.061,0.292,0.443,0.277,-0.191"},EPSG_3819:{towgs84:"595.48,121.69,515.35,4.115,-2.9383,0.853,-3.408"},EPSG_8694:{towgs84:"-93.799,-132.737,-219.073,-1.844,0.648,-6.37,-0.169"},EPSG_4145:{towgs84:"275.57,676.78,229.6"},EPSG_4283:{towgs84:"61.55,-10.87,-40.19,39.4924,32.7221,32.8979,-9.994"},EPSG_4317:{towgs84:"2.3287,-147.0425,-92.0802,-0.3092483,0.32482185,0.49729934,5.68906266"},EPSG_4272:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993"},EPSG_4248:{towgs84:"-307.7,265.3,-363.5"},EPSG_5561:{towgs84:"24,-121,-76"},EPSG_5233:{towgs84:"-0.293,766.95,87.713,0.195704,1.695068,3.473016,-0.039338"},ESRI_104130:{towgs84:"-86,-98,-119"},ESRI_104102:{towgs84:"682,-203,480"},ESRI_37207:{towgs84:"7,-10,-26"},EPSG_4675:{towgs84:"59.935,118.4,-10.871"},ESRI_104109:{towgs84:"-89.121,-348.182,260.871"},ESRI_104112:{towgs84:"-185.583,-230.096,281.361"},ESRI_104113:{towgs84:"25.1,-275.6,222.6"},IGNF_WGS72G:{towgs84:"0,12,6"},IGNF_NTFG:{towgs84:"-168,-60,320"},IGNF_EFATE57G:{towgs84:"-127,-769,472"},IGNF_PGP50G:{towgs84:"324.8,153.6,172.1"},IGNF_REUN47G:{towgs84:"94,-948,-1262"},IGNF_CSG67G:{towgs84:"-186,230,110"},IGNF_GUAD48G:{towgs84:"-467,-16,-300"},IGNF_TAHI51G:{towgs84:"162,117,154"},IGNF_TAHAAG:{towgs84:"65,342,77"},IGNF_NUKU72G:{towgs84:"84,274,65"},IGNF_PETRELS72G:{towgs84:"365,194,166"},IGNF_WALL78G:{towgs84:"253,-133,-127"},IGNF_MAYO50G:{towgs84:"-382,-59,-262"},IGNF_TANNAG:{towgs84:"-139,-967,436"},IGNF_IGN72G:{towgs84:"-13,-348,292"},IGNF_ATIGG:{towgs84:"1118,23,66"},IGNF_FANGA84G:{towgs84:"150.57,158.33,118.32"},IGNF_RUSAT84G:{towgs84:"202.13,174.6,-15.74"},IGNF_KAUE70G:{towgs84:"126.74,300.1,-75.49"},IGNF_MOP90G:{towgs84:"-10.8,-1.8,12.77"},IGNF_MHPF67G:{towgs84:"338.08,212.58,-296.17"},IGNF_TAHI79G:{towgs84:"160.61,116.05,153.69"},IGNF_ANAA92G:{towgs84:"1.5,3.84,4.81"},IGNF_MARQUI72G:{towgs84:"330.91,-13.92,58.56"},IGNF_APAT86G:{towgs84:"143.6,197.82,74.05"},IGNF_TUBU69G:{towgs84:"237.17,171.61,-77.84"},IGNF_STPM50G:{towgs84:"11.363,424.148,373.13"},EPSG_4150:{towgs84:"674.374,15.056,405.346"},EPSG_4754:{towgs84:"-208.4058,-109.8777,-2.5764"},ESRI_104101:{towgs84:"374,150,588"},EPSG_4693:{towgs84:"0,-0.15,0.68"},EPSG_6207:{towgs84:"293.17,726.18,245.36"},EPSG_4153:{towgs84:"-133.63,-157.5,-158.62"},EPSG_4132:{towgs84:"-241.54,-163.64,396.06"},EPSG_4221:{towgs84:"-154.5,150.7,100.4"},EPSG_4266:{towgs84:"-80.7,-132.5,41.1"},EPSG_4193:{towgs84:"-70.9,-151.8,-41.4"},EPSG_5340:{towgs84:"-0.41,0.46,-0.35"},EPSG_4246:{towgs84:"-294.7,-200.1,525.5"},EPSG_4318:{towgs84:"-3.2,-5.7,2.8"},EPSG_4121:{towgs84:"-199.87,74.79,246.62"},EPSG_4223:{towgs84:"-260.1,5.5,432.2"},EPSG_4158:{towgs84:"-0.465,372.095,171.736"},EPSG_4285:{towgs84:"-128.16,-282.42,21.93"},EPSG_4613:{towgs84:"-404.78,685.68,45.47"},EPSG_4607:{towgs84:"195.671,332.517,274.607"},EPSG_4475:{towgs84:"-381.788,-57.501,-256.673"},EPSG_4208:{towgs84:"-157.84,308.54,-146.6"},EPSG_4743:{towgs84:"70.995,-335.916,262.898"},EPSG_4710:{towgs84:"-323.65,551.39,-491.22"},EPSG_7881:{towgs84:"-0.077,0.079,0.086"},EPSG_4682:{towgs84:"283.729,735.942,261.143"},EPSG_4739:{towgs84:"-156,-271,-189"},EPSG_4679:{towgs84:"-80.01,253.26,291.19"},EPSG_4750:{towgs84:"-56.263,16.136,-22.856"},EPSG_4644:{towgs84:"-10.18,-350.43,291.37"},EPSG_4695:{towgs84:"-103.746,-9.614,-255.95"},EPSG_4292:{towgs84:"-355,21,72"},EPSG_4302:{towgs84:"-61.702,284.488,472.052"},EPSG_4143:{towgs84:"-124.76,53,466.79"},EPSG_4606:{towgs84:"-153,153,307"},EPSG_4699:{towgs84:"-770.1,158.4,-498.2"},EPSG_4247:{towgs84:"-273.5,110.6,-357.9"},EPSG_4160:{towgs84:"8.88,184.86,106.69"},EPSG_4161:{towgs84:"-233.43,6.65,173.64"},EPSG_9251:{towgs84:"-9.5,122.9,138.2"},EPSG_9253:{towgs84:"-78.1,101.6,133.3"},EPSG_4297:{towgs84:"-198.383,-240.517,-107.909"},EPSG_4269:{towgs84:"0,0,0"},EPSG_4301:{towgs84:"-147,506,687"},EPSG_4618:{towgs84:"-59,-11,-52"},EPSG_4612:{towgs84:"0,0,0"},EPSG_4678:{towgs84:"44.585,-131.212,-39.544"},EPSG_4250:{towgs84:"-130,29,364"},EPSG_4144:{towgs84:"214,804,268"},EPSG_4147:{towgs84:"-17.51,-108.32,-62.39"},EPSG_4259:{towgs84:"-254.1,-5.36,-100.29"},EPSG_4164:{towgs84:"-76,-138,67"},EPSG_4211:{towgs84:"-378.873,676.002,-46.255"},EPSG_4182:{towgs84:"-422.651,-172.995,84.02"},EPSG_4224:{towgs84:"-143.87,243.37,-33.52"},EPSG_4225:{towgs84:"-205.57,168.77,-4.12"},EPSG_5527:{towgs84:"-67.35,3.88,-38.22"},EPSG_4752:{towgs84:"98,390,-22"},EPSG_4310:{towgs84:"-30,190,89"},EPSG_9248:{towgs84:"-192.26,65.72,132.08"},EPSG_4680:{towgs84:"124.5,-63.5,-281"},EPSG_4701:{towgs84:"-79.9,-158,-168.9"},EPSG_4706:{towgs84:"-146.21,112.63,4.05"},EPSG_4805:{towgs84:"682,-203,480"},EPSG_4201:{towgs84:"-165,-11,206"},EPSG_4210:{towgs84:"-157,-2,-299"},EPSG_4183:{towgs84:"-104,167,-38"},EPSG_4139:{towgs84:"11,72,-101"},EPSG_4668:{towgs84:"-86,-98,-119"},EPSG_4717:{towgs84:"-2,151,181"},EPSG_4732:{towgs84:"102,52,-38"},EPSG_4280:{towgs84:"-377,681,-50"},EPSG_4209:{towgs84:"-138,-105,-289"},EPSG_4261:{towgs84:"31,146,47"},EPSG_4658:{towgs84:"-73,46,-86"},EPSG_4721:{towgs84:"265.025,384.929,-194.046"},EPSG_4222:{towgs84:"-136,-108,-292"},EPSG_4601:{towgs84:"-255,-15,71"},EPSG_4602:{towgs84:"725,685,536"},EPSG_4603:{towgs84:"72,213.7,93"},EPSG_4605:{towgs84:"9,183,236"},EPSG_4621:{towgs84:"137,248,-430"},EPSG_4657:{towgs84:"-28,199,5"},EPSG_4316:{towgs84:"103.25,-100.4,-307.19"},EPSG_4642:{towgs84:"-13,-348,292"},EPSG_4698:{towgs84:"145,-187,103"},EPSG_4192:{towgs84:"-206.1,-174.7,-87.7"},EPSG_4311:{towgs84:"-265,120,-358"},EPSG_4135:{towgs84:"58,-283,-182"},ESRI_104138:{towgs84:"198,-226,-347"},EPSG_4245:{towgs84:"-11,851,5"},EPSG_4142:{towgs84:"-125,53,467"},EPSG_4213:{towgs84:"-106,-87,188"},EPSG_4253:{towgs84:"-133,-77,-51"},EPSG_4129:{towgs84:"-132,-110,-335"},EPSG_4713:{towgs84:"-77,-128,142"},EPSG_4239:{towgs84:"217,823,299"},EPSG_4146:{towgs84:"295,736,257"},EPSG_4155:{towgs84:"-83,37,124"},EPSG_4165:{towgs84:"-173,253,27"},EPSG_4672:{towgs84:"175,-38,113"},EPSG_4236:{towgs84:"-637,-549,-203"},EPSG_4251:{towgs84:"-90,40,88"},EPSG_4271:{towgs84:"-2,374,172"},EPSG_4175:{towgs84:"-88,4,101"},EPSG_4716:{towgs84:"298,-304,-375"},EPSG_4315:{towgs84:"-23,259,-9"},EPSG_4744:{towgs84:"-242.2,-144.9,370.3"},EPSG_4244:{towgs84:"-97,787,86"},EPSG_4293:{towgs84:"616,97,-251"},EPSG_4714:{towgs84:"-127,-769,472"},EPSG_4736:{towgs84:"260,12,-147"},EPSG_6883:{towgs84:"-235,-110,393"},EPSG_6894:{towgs84:"-63,176,185"},EPSG_4205:{towgs84:"-43,-163,45"},EPSG_4256:{towgs84:"41,-220,-134"},EPSG_4262:{towgs84:"639,405,60"},EPSG_4604:{towgs84:"174,359,365"},EPSG_4169:{towgs84:"-115,118,426"},EPSG_4620:{towgs84:"-106,-129,165"},EPSG_4184:{towgs84:"-203,141,53"},EPSG_4616:{towgs84:"-289,-124,60"},EPSG_9403:{towgs84:"-307,-92,127"},EPSG_4684:{towgs84:"-133,-321,50"},EPSG_4708:{towgs84:"-491,-22,435"},EPSG_4707:{towgs84:"114,-116,-333"},EPSG_4709:{towgs84:"145,75,-272"},EPSG_4712:{towgs84:"-205,107,53"},EPSG_4711:{towgs84:"124,-234,-25"},EPSG_4718:{towgs84:"230,-199,-752"},EPSG_4719:{towgs84:"211,147,111"},EPSG_4724:{towgs84:"208,-435,-229"},EPSG_4725:{towgs84:"189,-79,-202"},EPSG_4735:{towgs84:"647,1777,-1124"},EPSG_4722:{towgs84:"-794,119,-298"},EPSG_4728:{towgs84:"-307,-92,127"},EPSG_4734:{towgs84:"-632,438,-609"},EPSG_4727:{towgs84:"912,-58,1227"},EPSG_4729:{towgs84:"185,165,42"},EPSG_4730:{towgs84:"170,42,84"},EPSG_4733:{towgs84:"276,-57,149"},ESRI_37218:{towgs84:"230,-199,-752"},ESRI_37240:{towgs84:"-7,215,225"},ESRI_37221:{towgs84:"252,-209,-751"},ESRI_4305:{towgs84:"-123,-206,219"},ESRI_104139:{towgs84:"-73,-247,227"},EPSG_4748:{towgs84:"51,391,-36"},EPSG_4219:{towgs84:"-384,664,-48"},EPSG_4255:{towgs84:"-333,-222,114"},EPSG_4257:{towgs84:"-587.8,519.75,145.76"},EPSG_4646:{towgs84:"-963,510,-359"},EPSG_6881:{towgs84:"-24,-203,268"},EPSG_6882:{towgs84:"-183,-15,273"},EPSG_4715:{towgs84:"-104,-129,239"},IGNF_RGF93GDD:{towgs84:"0,0,0"},IGNF_RGM04GDD:{towgs84:"0,0,0"},IGNF_RGSPM06GDD:{towgs84:"0,0,0"},IGNF_RGTAAF07GDD:{towgs84:"0,0,0"},IGNF_RGFG95GDD:{towgs84:"0,0,0"},IGNF_RGNCG:{towgs84:"0,0,0"},IGNF_RGPFGDD:{towgs84:"0,0,0"},IGNF_ETRS89G:{towgs84:"0,0,0"},IGNF_RGR92GDD:{towgs84:"0,0,0"},EPSG_4173:{towgs84:"0,0,0"},EPSG_4180:{towgs84:"0,0,0"},EPSG_4619:{towgs84:"0,0,0"},EPSG_4667:{towgs84:"0,0,0"},EPSG_4075:{towgs84:"0,0,0"},EPSG_6706:{towgs84:"0,0,0"},EPSG_7798:{towgs84:"0,0,0"},EPSG_4661:{towgs84:"0,0,0"},EPSG_4669:{towgs84:"0,0,0"},EPSG_8685:{towgs84:"0,0,0"},EPSG_4151:{towgs84:"0,0,0"},EPSG_9702:{towgs84:"0,0,0"},EPSG_4758:{towgs84:"0,0,0"},EPSG_4761:{towgs84:"0,0,0"},EPSG_4765:{towgs84:"0,0,0"},EPSG_8997:{towgs84:"0,0,0"},EPSG_4023:{towgs84:"0,0,0"},EPSG_4670:{towgs84:"0,0,0"},EPSG_4694:{towgs84:"0,0,0"},EPSG_4148:{towgs84:"0,0,0"},EPSG_4163:{towgs84:"0,0,0"},EPSG_4167:{towgs84:"0,0,0"},EPSG_4189:{towgs84:"0,0,0"},EPSG_4190:{towgs84:"0,0,0"},EPSG_4176:{towgs84:"0,0,0"},EPSG_4659:{towgs84:"0,0,0"},EPSG_3824:{towgs84:"0,0,0"},EPSG_3889:{towgs84:"0,0,0"},EPSG_4046:{towgs84:"0,0,0"},EPSG_4081:{towgs84:"0,0,0"},EPSG_4558:{towgs84:"0,0,0"},EPSG_4483:{towgs84:"0,0,0"},EPSG_5013:{towgs84:"0,0,0"},EPSG_5264:{towgs84:"0,0,0"},EPSG_5324:{towgs84:"0,0,0"},EPSG_5354:{towgs84:"0,0,0"},EPSG_5371:{towgs84:"0,0,0"},EPSG_5373:{towgs84:"0,0,0"},EPSG_5381:{towgs84:"0,0,0"},EPSG_5393:{towgs84:"0,0,0"},EPSG_5489:{towgs84:"0,0,0"},EPSG_5593:{towgs84:"0,0,0"},EPSG_6135:{towgs84:"0,0,0"},EPSG_6365:{towgs84:"0,0,0"},EPSG_5246:{towgs84:"0,0,0"},EPSG_7886:{towgs84:"0,0,0"},EPSG_8431:{towgs84:"0,0,0"},EPSG_8427:{towgs84:"0,0,0"},EPSG_8699:{towgs84:"0,0,0"},EPSG_8818:{towgs84:"0,0,0"},EPSG_4757:{towgs84:"0,0,0"},EPSG_9140:{towgs84:"0,0,0"},EPSG_8086:{towgs84:"0,0,0"},EPSG_4686:{towgs84:"0,0,0"},EPSG_4737:{towgs84:"0,0,0"},EPSG_4702:{towgs84:"0,0,0"},EPSG_4747:{towgs84:"0,0,0"},EPSG_4749:{towgs84:"0,0,0"},EPSG_4674:{towgs84:"0,0,0"},EPSG_4755:{towgs84:"0,0,0"},EPSG_4759:{towgs84:"0,0,0"},EPSG_4762:{towgs84:"0,0,0"},EPSG_4763:{towgs84:"0,0,0"},EPSG_4764:{towgs84:"0,0,0"},EPSG_4166:{towgs84:"0,0,0"},EPSG_4170:{towgs84:"0,0,0"},EPSG_5546:{towgs84:"0,0,0"},EPSG_7844:{towgs84:"0,0,0"},EPSG_4818:{towgs84:"589,76,480"}};for(var UZ in t_){var X1=t_[UZ];X1.datumName&&(t_[X1.datumName]=X1)}function BZ(n,e,t,i,r,s,o){var a={};return n===void 0||n==="none"?a.datum_type=Rw:a.datum_type=eZ,e&&(a.datum_params=e.map(parseFloat),(a.datum_params[0]!==0||a.datum_params[1]!==0||a.datum_params[2]!==0)&&(a.datum_type=yu),a.datum_params.length>3&&(a.datum_params[3]!==0||a.datum_params[4]!==0||a.datum_params[5]!==0||a.datum_params[6]!==0)&&(a.datum_type=vu,a.datum_params[3]*=Tf,a.datum_params[4]*=Tf,a.datum_params[5]*=Tf,a.datum_params[6]=a.datum_params[6]/1e6+1)),o&&(a.datum_type=ih,a.grids=o),a.a=t,a.b=i,a.es=r,a.ep2=s,a}var cT={};function zZ(n,e,t){return e instanceof ArrayBuffer?$Z(n,e,t):{ready:WZ(n,e)}}function $Z(n,e,t){var i=!0;t!==void 0&&t.includeErrorFields===!1&&(i=!1);var r=new DataView(e),s=qZ(r),o=XZ(r,s),a=YZ(r,o,s,i),u={header:o,subgrids:a};return cT[n]=u,u}async function WZ(n,e){for(var t=[],i=await e.getImageCount(),r=i-1;r>=0;r--){var s=await e.getImage(r),o=await s.readRasters(),a=o,u=[s.getWidth(),s.getHeight()],h=s.getBoundingBox().map(PM),d=[s.fileDirectory.ModelPixelScale[0],s.fileDirectory.ModelPixelScale[1]].map(PM),g=h[0]+(u[0]-1)*d[0],m=h[3]-(u[1]-1)*d[1],v=a[0],y=a[1],T=[];for(let P=u[1]-1;P>=0;P--)for(let M=u[0]-1;M>=0;M--){var w=P*u[0]+M;T.push([-Sa(y[w]),Sa(v[w])])}t.push({del:d,lim:u,ll:[-g,m],cvs:T})}var A={header:{nSubgrids:i},subgrids:t};return cT[n]=A,A}function KZ(n){if(n===void 0)return null;var e=n.split(",");return e.map(HZ)}function HZ(n){if(n.length===0)return null;var e=n[0]==="@";return e&&(n=n.slice(1)),n==="null"?{name:"null",mandatory:!e,grid:null,isNull:!0}:{name:n,mandatory:!e,grid:cT[n]||null,isNull:!1}}function PM(n){return n*Math.PI/180}function Sa(n){return n/3600*Math.PI/180}function qZ(n){var e=n.getInt32(8,!1);return e===11?!1:(e=n.getInt32(8,!0),e!==11&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}function XZ(n,e){return{nFields:n.getInt32(8,e),nSubgridFields:n.getInt32(24,e),nSubgrids:n.getInt32(40,e),shiftType:Cw(n,56,64).trim(),fromSemiMajorAxis:n.getFloat64(120,e),fromSemiMinorAxis:n.getFloat64(136,e),toSemiMajorAxis:n.getFloat64(152,e),toSemiMinorAxis:n.getFloat64(168,e)}}function Cw(n,e,t){return String.fromCharCode.apply(null,new Uint8Array(n.buffer.slice(e,t)))}function YZ(n,e,t,i){for(var r=176,s=[],o=0;o<e.nSubgrids;o++){var a=QZ(n,r,t),u=JZ(n,r,a,t,i),h=Math.round(1+(a.upperLongitude-a.lowerLongitude)/a.longitudeInterval),d=Math.round(1+(a.upperLatitude-a.lowerLatitude)/a.latitudeInterval);s.push({ll:[Sa(a.lowerLongitude),Sa(a.lowerLatitude)],del:[Sa(a.longitudeInterval),Sa(a.latitudeInterval)],lim:[h,d],count:a.gridNodeCount,cvs:ZZ(u)});var g=16;i===!1&&(g=8),r+=176+a.gridNodeCount*g}return s}function ZZ(n){return n.map(function(e){return[Sa(e.longitudeShift),Sa(e.latitudeShift)]})}function QZ(n,e,t){return{name:Cw(n,e+8,e+16).trim(),parent:Cw(n,e+24,e+24+8).trim(),lowerLatitude:n.getFloat64(e+72,t),upperLatitude:n.getFloat64(e+88,t),lowerLongitude:n.getFloat64(e+104,t),upperLongitude:n.getFloat64(e+120,t),latitudeInterval:n.getFloat64(e+136,t),longitudeInterval:n.getFloat64(e+152,t),gridNodeCount:n.getInt32(e+168,t)}}function JZ(n,e,t,i,r){var s=e+176,o=16;r===!1&&(o=8);for(var a=[],u=0;u<t.gridNodeCount;u++){var h={latitudeShift:n.getFloat32(s+u*o,i),longitudeShift:n.getFloat32(s+u*o+4,i)};r!==!1&&(h.latitudeAccuracy=n.getFloat32(s+u*o+8,i),h.longitudeAccuracy=n.getFloat32(s+u*o+12,i)),a.push(h)}return a}function Ir(n,e){if(!(this instanceof Ir))return new Ir(n);this.forward=null,this.inverse=null,this.init=null,this.name,this.names=null,this.title,e=e||function(h){if(h)throw h};var t=AZ(n);if(typeof t!="object"){e("Could not parse to valid json: "+n);return}var i=Ir.projections.get(t.projName);if(!i){e("Could not get projection name from: "+n);return}if(t.datumCode&&t.datumCode!=="none"){var r=za(t_,t.datumCode);r&&(t.datum_params=t.datum_params||(r.towgs84?r.towgs84.split(","):null),t.ellps=r.ellipse,t.datumName=r.datumName?r.datumName:t.datumCode)}t.k0=t.k0||1,t.axis=t.axis||"enu",t.ellps=t.ellps||"wgs84",t.lat1=t.lat1||t.lat0;var s=jZ(t.a,t.b,t.rf,t.ellps,t.sphere),o=GZ(s.a,s.b,s.rf,t.R_A),a=KZ(t.nadgrids),u=t.datum||BZ(t.datumCode,t.datum_params,s.a,s.b,o.es,o.ep2,a);AM(this,t),AM(this,i),this.a=s.a,this.b=s.b,this.rf=s.rf,this.sphere=s.sphere,this.es=o.es,this.e=o.e,this.ep2=o.ep2,this.datum=u,"init"in this&&typeof this.init=="function"&&this.init(),e(null,this)}Ir.projections=VZ;Ir.projections.start();function eQ(n,e){return n.datum_type!==e.datum_type||n.a!==e.a||Math.abs(n.es-e.es)>5e-11?!1:n.datum_type===yu?n.datum_params[0]===e.datum_params[0]&&n.datum_params[1]===e.datum_params[1]&&n.datum_params[2]===e.datum_params[2]:n.datum_type===vu?n.datum_params[0]===e.datum_params[0]&&n.datum_params[1]===e.datum_params[1]&&n.datum_params[2]===e.datum_params[2]&&n.datum_params[3]===e.datum_params[3]&&n.datum_params[4]===e.datum_params[4]&&n.datum_params[5]===e.datum_params[5]&&n.datum_params[6]===e.datum_params[6]:!0}function IO(n,e,t){var i=n.x,r=n.y,s=n.z?n.z:0,o,a,u,h;if(r<-se&&r>-1.001*se)r=-se;else if(r>se&&r<1.001*se)r=se;else{if(r<-se)return{x:-1/0,y:-1/0,z:n.z};if(r>se)return{x:1/0,y:1/0,z:n.z}}return i>Math.PI&&(i-=2*Math.PI),a=Math.sin(r),h=Math.cos(r),u=a*a,o=t/Math.sqrt(1-e*u),{x:(o+s)*h*Math.cos(i),y:(o+s)*h*Math.sin(i),z:(o*(1-e)+s)*a}}function AO(n,e,t,i){var r=1e-12,s=r*r,o=30,a,u,h,d,g,m,v,y,T,w,A,P,M,k=n.x,N=n.y,B=n.z?n.z:0,b,R,L;if(a=Math.sqrt(k*k+N*N),u=Math.sqrt(k*k+N*N+B*B),a/t<r){if(b=0,u/t<r)return R=se,L=-i,{x:n.x,y:n.y,z:n.z}}else b=Math.atan2(N,k);h=B/u,d=a/u,g=1/Math.sqrt(1-e*(2-e)*d*d),y=d*(1-e)*g,T=h*g,M=0;do M++,v=t/Math.sqrt(1-e*T*T),L=a*y+B*T-v*(1-e*T*T),m=e*v/(v+L),g=1/Math.sqrt(1-m*(2-m)*d*d),w=d*(1-m)*g,A=h*g,P=A*y-w*T,y=w,T=A;while(P*P>s&&M<o);return R=Math.atan(A/Math.abs(w)),{x:b,y:R,z:L}}function tQ(n,e,t){if(e===yu)return{x:n.x+t[0],y:n.y+t[1],z:n.z+t[2]};if(e===vu){var i=t[0],r=t[1],s=t[2],o=t[3],a=t[4],u=t[5],h=t[6];return{x:h*(n.x-u*n.y+a*n.z)+i,y:h*(u*n.x+n.y-o*n.z)+r,z:h*(-a*n.x+o*n.y+n.z)+s}}}function nQ(n,e,t){if(e===yu)return{x:n.x-t[0],y:n.y-t[1],z:n.z-t[2]};if(e===vu){var i=t[0],r=t[1],s=t[2],o=t[3],a=t[4],u=t[5],h=t[6],d=(n.x-i)/h,g=(n.y-r)/h,m=(n.z-s)/h;return{x:d+u*g-a*m,y:-u*d+g+o*m,z:a*d-o*g+m}}}function bp(n){return n===yu||n===vu}function iQ(n,e,t){if(eQ(n,e)||n.datum_type===Rw||e.datum_type===Rw)return t;var i=n.a,r=n.es;if(n.datum_type===ih){var s=CM(n,!1,t);if(s!==0)return;i=EM,r=wM}var o=e.a,a=e.b,u=e.es;if(e.datum_type===ih&&(o=EM,a=tZ,u=wM),r===u&&i===o&&!bp(n.datum_type)&&!bp(e.datum_type))return t;if(t=IO(t,r,i),bp(n.datum_type)&&(t=tQ(t,n.datum_type,n.datum_params)),bp(e.datum_type)&&(t=nQ(t,e.datum_type,e.datum_params)),t=AO(t,u,o,a),e.datum_type===ih){var h=CM(e,!0,t);if(h!==0)return}return t}function CM(n,e,t){if(n.grids===null||n.grids.length===0)return console.log("Grid shift grids not found"),-1;var i={x:-t.x,y:t.y},r={x:Number.NaN,y:Number.NaN},s=[];e:for(var o=0;o<n.grids.length;o++){var a=n.grids[o];if(s.push(a.name),a.isNull){r=i;break}if(a.grid===null){if(a.mandatory)return console.log("Unable to find mandatory grid '"+a.name+"'"),-1;continue}for(var u=a.grid.subgrids,h=0,d=u.length;h<d;h++){var g=u[h],m=(Math.abs(g.del[1])+Math.abs(g.del[0]))/1e4,v=g.ll[0]-m,y=g.ll[1]-m,T=g.ll[0]+(g.lim[0]-1)*g.del[0]+m,w=g.ll[1]+(g.lim[1]-1)*g.del[1]+m;if(!(y>i.y||v>i.x||w<i.y||T<i.x)&&(r=rQ(i,e,g),!isNaN(r.x)))break e}}return isNaN(r.x)?(console.log("Failed to find a grid shift table for location '"+-i.x*Li+" "+i.y*Li+" tried: '"+s+"'"),-1):(t.x=-r.x,t.y=r.y,0)}function rQ(n,e,t){var i={x:Number.NaN,y:Number.NaN};if(isNaN(n.x))return i;var r={x:n.x,y:n.y};r.x-=t.ll[0],r.y-=t.ll[1],r.x=_e(r.x-Math.PI)+Math.PI;var s=MM(r,t);if(e){if(isNaN(s.x))return i;s.x=r.x-s.x,s.y=r.y-s.y;var o=9,a=1e-12,u,h;do{if(h=MM(s,t),isNaN(h.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}u={x:r.x-(h.x+s.x),y:r.y-(h.y+s.y)},s.x+=u.x,s.y+=u.y}while(o--&&Math.abs(u.x)>a&&Math.abs(u.y)>a);if(o<0)return console.log("Inverse grid shift iterator failed to converge."),i;i.x=_e(s.x+t.ll[0]),i.y=s.y+t.ll[1]}else isNaN(s.x)||(i.x=n.x+s.x,i.y=n.y+s.y);return i}function MM(n,e){var t={x:n.x/e.del[0],y:n.y/e.del[1]},i={x:Math.floor(t.x),y:Math.floor(t.y)},r={x:t.x-1*i.x,y:t.y-1*i.y},s={x:Number.NaN,y:Number.NaN},o;if(i.x<0||i.x>=e.lim[0]||i.y<0||i.y>=e.lim[1])return s;o=i.y*e.lim[0]+i.x;var a={x:e.cvs[o][0],y:e.cvs[o][1]};o++;var u={x:e.cvs[o][0],y:e.cvs[o][1]};o+=e.lim[0];var h={x:e.cvs[o][0],y:e.cvs[o][1]};o--;var d={x:e.cvs[o][0],y:e.cvs[o][1]},g=r.x*r.y,m=r.x*(1-r.y),v=(1-r.x)*(1-r.y),y=(1-r.x)*r.y;return s.x=v*a.x+m*u.x+y*d.x+g*h.x,s.y=v*a.y+m*u.y+y*d.y+g*h.y,s}function bM(n,e,t){var i=t.x,r=t.y,s=t.z||0,o,a,u,h={};for(u=0;u<3;u++)if(!(e&&u===2&&t.z===void 0))switch(u===0?(o=i,"ew".indexOf(n.axis[u])!==-1?a="x":a="y"):u===1?(o=r,"ns".indexOf(n.axis[u])!==-1?a="y":a="x"):(o=s,a="z"),n.axis[u]){case"e":h[a]=o;break;case"w":h[a]=-o;break;case"n":h[a]=o;break;case"s":h[a]=-o;break;case"u":t[a]!==void 0&&(h.z=o);break;case"d":t[a]!==void 0&&(h.z=-o);break;default:return null}return h}function RO(n){var e={x:n[0],y:n[1]};return n.length>2&&(e.z=n[2]),n.length>3&&(e.m=n[3]),e}function sQ(n){LM(n.x),LM(n.y)}function LM(n){if(typeof Number.isFinite=="function"){if(Number.isFinite(n))return;throw new TypeError("coordinates must be finite numbers")}if(typeof n!="number"||n!==n||!isFinite(n))throw new TypeError("coordinates must be finite numbers")}function oQ(n,e){return(n.datum.datum_type===yu||n.datum.datum_type===vu||n.datum.datum_type===ih)&&e.datumCode!=="WGS84"||(e.datum.datum_type===yu||e.datum.datum_type===vu||e.datum.datum_type===ih)&&n.datumCode!=="WGS84"}function l0(n,e,t,i){var r;Array.isArray(t)?t=RO(t):t={x:t.x,y:t.y,z:t.z,m:t.m};var s=t.z!==void 0;if(sQ(t),n.datum&&e.datum&&oQ(n,e)&&(r=new Ir("WGS84"),t=l0(n,r,t,i),n=r),i&&n.axis!=="enu"&&(t=bM(n,!1,t)),n.projName==="longlat")t={x:t.x*Ht,y:t.y*Ht,z:t.z||0};else if(n.to_meter&&(t={x:t.x*n.to_meter,y:t.y*n.to_meter,z:t.z||0}),t=n.inverse(t),!t)return;if(n.from_greenwich&&(t.x+=n.from_greenwich),t=iQ(n.datum,e.datum,t),!!t)return t=t,e.from_greenwich&&(t={x:t.x-e.from_greenwich,y:t.y,z:t.z||0}),e.projName==="longlat"?t={x:t.x*Li,y:t.y*Li,z:t.z||0}:(t=e.forward(t),e.to_meter&&(t={x:t.x/e.to_meter,y:t.y/e.to_meter,z:t.z||0})),i&&e.axis!=="enu"?bM(e,!0,t):(t&&!s&&delete t.z,t)}var kM=Ir("WGS84");function Y1(n,e,t,i){var r,s,o;return Array.isArray(t)?(r=l0(n,e,t,i)||{x:NaN,y:NaN},t.length>2?typeof n.name<"u"&&n.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"?typeof r.z=="number"?[r.x,r.y,r.z].concat(t.slice(3)):[r.x,r.y,t[2]].concat(t.slice(3)):[r.x,r.y].concat(t.slice(2)):[r.x,r.y]):(s=l0(n,e,t,i),o=Object.keys(t),o.length===2||o.forEach(function(a){if(typeof n.name<"u"&&n.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"){if(a==="x"||a==="y"||a==="z")return}else if(a==="x"||a==="y")return;s[a]=t[a]}),s)}function Lp(n){return n instanceof Ir?n:typeof n=="object"&&"oProj"in n?n.oProj:Ir(n)}function aQ(n,e,t){var i,r,s=!1,o;return typeof e>"u"?(r=Lp(n),i=kM,s=!0):(typeof e.x<"u"||Array.isArray(e))&&(t=e,r=Lp(n),i=kM,s=!0),i||(i=Lp(n)),r||(r=Lp(e)),t?Y1(i,r,t):(o={forward:function(a,u){return Y1(i,r,a,u)},inverse:function(a,u){return Y1(r,i,a,u)}},s&&(o.oProj=r),o)}var DM=6,PO="AJSAJS",CO="AFAFAF",$c=65,xi=73,_r=79,rf=86,sf=90;const lQ={forward:MO,inverse:uQ,toPoint:bO};function MO(n,e){return e=e||5,dQ(cQ({lat:n[1],lon:n[0]}),e)}function uQ(n){var e=hT(kO(n.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat,e.lon,e.lat]:[e.left,e.bottom,e.right,e.top]}function bO(n){var e=hT(kO(n.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}function Z1(n){return n*(Math.PI/180)}function NM(n){return 180*(n/Math.PI)}function cQ(n){var e=n.lat,t=n.lon,i=6378137,r=.00669438,s=.9996,o,a,u,h,d,g,m,v=Z1(e),y=Z1(t),T,w;w=Math.floor((t+180)/6)+1,t===180&&(w=60),e>=56&&e<64&&t>=3&&t<12&&(w=32),e>=72&&e<84&&(t>=0&&t<9?w=31:t>=9&&t<21?w=33:t>=21&&t<33?w=35:t>=33&&t<42&&(w=37)),o=(w-1)*6-180+3,T=Z1(o),a=r/(1-r),u=i/Math.sqrt(1-r*Math.sin(v)*Math.sin(v)),h=Math.tan(v)*Math.tan(v),d=a*Math.cos(v)*Math.cos(v),g=Math.cos(v)*(y-T),m=i*((1-r/4-3*r*r/64-5*r*r*r/256)*v-(3*r/8+3*r*r/32+45*r*r*r/1024)*Math.sin(2*v)+(15*r*r/256+45*r*r*r/1024)*Math.sin(4*v)-35*r*r*r/3072*Math.sin(6*v));var A=s*u*(g+(1-h+d)*g*g*g/6+(5-18*h+h*h+72*d-58*a)*g*g*g*g*g/120)+5e5,P=s*(m+u*Math.tan(v)*(g*g/2+(5-h+9*d+4*d*d)*g*g*g*g/24+(61-58*h+h*h+600*d-330*a)*g*g*g*g*g*g/720));return e<0&&(P+=1e7),{northing:Math.round(P),easting:Math.round(A),zoneNumber:w,zoneLetter:hQ(e)}}function hT(n){var e=n.northing,t=n.easting,i=n.zoneLetter,r=n.zoneNumber;if(r<0||r>60)return null;var s=.9996,o=6378137,a=.00669438,u,h=(1-Math.sqrt(1-a))/(1+Math.sqrt(1-a)),d,g,m,v,y,T,w,A,P,M=t-5e5,k=e;i<"N"&&(k-=1e7),w=(r-1)*6-180+3,u=a/(1-a),T=k/s,A=T/(o*(1-a/4-3*a*a/64-5*a*a*a/256)),P=A+(3*h/2-27*h*h*h/32)*Math.sin(2*A)+(21*h*h/16-55*h*h*h*h/32)*Math.sin(4*A)+151*h*h*h/96*Math.sin(6*A),d=o/Math.sqrt(1-a*Math.sin(P)*Math.sin(P)),g=Math.tan(P)*Math.tan(P),m=u*Math.cos(P)*Math.cos(P),v=o*(1-a)/Math.pow(1-a*Math.sin(P)*Math.sin(P),1.5),y=M/(d*s);var N=P-d*Math.tan(P)/v*(y*y/2-(5+3*g+10*m-4*m*m-9*u)*y*y*y*y/24+(61+90*g+298*m+45*g*g-252*u-3*m*m)*y*y*y*y*y*y/720);N=NM(N);var B=(y-(1+2*g+m)*y*y*y/6+(5-2*m+28*g-3*m*m+8*u+24*g*g)*y*y*y*y*y/120)/Math.cos(P);B=w+NM(B);var b;if(n.accuracy){var R=hT({northing:n.northing+n.accuracy,easting:n.easting+n.accuracy,zoneLetter:n.zoneLetter,zoneNumber:n.zoneNumber});b={top:R.lat,right:R.lon,bottom:N,left:B}}else b={lat:N,lon:B};return b}function hQ(n){var e="Z";return 84>=n&&n>=72?e="X":72>n&&n>=64?e="W":64>n&&n>=56?e="V":56>n&&n>=48?e="U":48>n&&n>=40?e="T":40>n&&n>=32?e="S":32>n&&n>=24?e="R":24>n&&n>=16?e="Q":16>n&&n>=8?e="P":8>n&&n>=0?e="N":0>n&&n>=-8?e="M":-8>n&&n>=-16?e="L":-16>n&&n>=-24?e="K":-24>n&&n>=-32?e="J":-32>n&&n>=-40?e="H":-40>n&&n>=-48?e="G":-48>n&&n>=-56?e="F":-56>n&&n>=-64?e="E":-64>n&&n>=-72?e="D":-72>n&&n>=-80&&(e="C"),e}function dQ(n,e){var t="00000"+n.easting,i="00000"+n.northing;return n.zoneNumber+n.zoneLetter+fQ(n.easting,n.northing,n.zoneNumber)+t.substr(t.length-5,e)+i.substr(i.length-5,e)}function fQ(n,e,t){var i=LO(t),r=Math.floor(n/1e5),s=Math.floor(e/1e5)%20;return gQ(r,s,i)}function LO(n){var e=n%DM;return e===0&&(e=DM),e}function gQ(n,e,t){var i=t-1,r=PO.charCodeAt(i),s=CO.charCodeAt(i),o=r+n-1,a=s+e,u=!1;o>sf&&(o=o-sf+$c-1,u=!0),(o===xi||r<xi&&o>xi||(o>xi||r<xi)&&u)&&o++,(o===_r||r<_r&&o>_r||(o>_r||r<_r)&&u)&&(o++,o===xi&&o++),o>sf&&(o=o-sf+$c-1),a>rf?(a=a-rf+$c-1,u=!0):u=!1,(a===xi||s<xi&&a>xi||(a>xi||s<xi)&&u)&&a++,(a===_r||s<_r&&a>_r||(a>_r||s<_r)&&u)&&(a++,a===xi&&a++),a>rf&&(a=a-rf+$c-1);var h=String.fromCharCode(o)+String.fromCharCode(a);return h}function kO(n){if(n&&n.length===0)throw"MGRSPoint coverting from nothing";for(var e=n.length,t=null,i="",r,s=0;!/[A-Z]/.test(r=n.charAt(s));){if(s>=2)throw"MGRSPoint bad conversion from: "+n;i+=r,s++}var o=parseInt(i,10);if(s===0||s+3>e)throw"MGRSPoint bad conversion from: "+n;var a=n.charAt(s++);if(a<="A"||a==="B"||a==="Y"||a>="Z"||a==="I"||a==="O")throw"MGRSPoint zone letter "+a+" not handled: "+n;t=n.substring(s,s+=2);for(var u=LO(o),h=mQ(t.charAt(0),u),d=pQ(t.charAt(1),u);d<_Q(a);)d+=2e6;var g=e-s;if(g%2!==0)throw`MGRSPoint has to have an even number 
of digits after the zone letter and two 100km letters - front 
half for easting meters, second half for 
northing meters`+n;var m=g/2,v=0,y=0,T,w,A,P,M;return m>0&&(T=1e5/Math.pow(10,m),w=n.substring(s,s+m),v=parseFloat(w)*T,A=n.substring(s+m),y=parseFloat(A)*T),P=v+h,M=y+d,{easting:P,northing:M,zoneLetter:a,zoneNumber:o,accuracy:T}}function mQ(n,e){for(var t=PO.charCodeAt(e-1),i=1e5,r=!1;t!==n.charCodeAt(0);){if(t++,t===xi&&t++,t===_r&&t++,t>sf){if(r)throw"Bad character: "+n;t=$c,r=!0}i+=1e5}return i}function pQ(n,e){if(n>"V")throw"MGRSPoint given invalid Northing "+n;for(var t=CO.charCodeAt(e-1),i=0,r=!1;t!==n.charCodeAt(0);){if(t++,t===xi&&t++,t===_r&&t++,t>rf){if(r)throw"Bad character: "+n;t=$c,r=!0}i+=1e5}return i}function _Q(n){var e;switch(n){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+n}function Mh(n,e,t){if(!(this instanceof Mh))return new Mh(n,e,t);if(Array.isArray(n))this.x=n[0],this.y=n[1],this.z=n[2]||0;else if(typeof n=="object")this.x=n.x,this.y=n.y,this.z=n.z||0;else if(typeof n=="string"&&typeof e>"u"){var i=n.split(",");this.x=parseFloat(i[0]),this.y=parseFloat(i[1]),this.z=parseFloat(i[2])||0}else this.x=n,this.y=e,this.z=t||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}Mh.fromMGRS=function(n){return new Mh(bO(n))};Mh.prototype.toMGRS=function(n){return MO([this.x,this.y],n)};var yQ=1,vQ=.25,OM=.046875,VM=.01953125,FM=.01068115234375,EQ=.75,wQ=.46875,xQ=.013020833333333334,SQ=.007120768229166667,TQ=.3645833333333333,IQ=.005696614583333333,AQ=.3076171875;function dT(n){var e=[];e[0]=yQ-n*(vQ+n*(OM+n*(VM+n*FM))),e[1]=n*(EQ-n*(OM+n*(VM+n*FM)));var t=n*n;return e[2]=t*(wQ-n*(xQ+n*SQ)),t*=n,e[3]=t*(TQ-n*IQ),e[4]=t*n*AQ,e}function jh(n,e,t,i){return t*=e,e*=e,i[0]*n-t*(i[1]+e*(i[2]+e*(i[3]+e*i[4])))}var RQ=20;function fT(n,e,t){for(var i=1/(1-e),r=n,s=RQ;s;--s){var o=Math.sin(r),a=1-e*o*o;if(a=(jh(r,o,Math.cos(r),t)-n)*(a*Math.sqrt(a))*i,r-=a,Math.abs(a)<ge)return r}return r}function PQ(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.es&&(this.en=dT(this.es),this.ml0=jh(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))}function CQ(n){var e=n.x,t=n.y,i=_e(e-this.long0,this.over),r,s,o,a=Math.sin(t),u=Math.cos(t);if(this.es){var d=u*i,g=Math.pow(d,2),m=this.ep2*Math.pow(u,2),v=Math.pow(m,2),y=Math.abs(u)>ge?Math.tan(t):0,T=Math.pow(y,2),w=Math.pow(T,2);r=1-this.es*Math.pow(a,2),d=d/Math.sqrt(r);var A=jh(t,a,u,this.en);s=this.a*(this.k0*d*(1+g/6*(1-T+m+g/20*(5-18*T+w+14*m-58*T*m+g/42*(61+179*w-w*T-479*T)))))+this.x0,o=this.a*(this.k0*(A-this.ml0+a*i*d/2*(1+g/12*(5-T+9*m+4*v+g/30*(61+w-58*T+270*m-330*T*m+g/56*(1385+543*w-w*T-3111*T))))))+this.y0}else{var h=u*Math.sin(i);if(Math.abs(Math.abs(h)-1)<ge)return 93;if(s=.5*this.a*this.k0*Math.log((1+h)/(1-h))+this.x0,o=u*Math.cos(i)/Math.sqrt(1-Math.pow(h,2)),h=Math.abs(o),h>=1){if(h-1>ge)return 93;o=0}else o=Math.acos(o);t<0&&(o=-o),o=this.a*this.k0*(o-this.lat0)+this.y0}return n.x=s,n.y=o,n}function MQ(n){var e,t,i,r,s=(n.x-this.x0)*(1/this.a),o=(n.y-this.y0)*(1/this.a);if(this.es)if(e=this.ml0+o/this.k0,t=fT(e,this.es,this.en),Math.abs(t)<se){var g=Math.sin(t),m=Math.cos(t),v=Math.abs(m)>ge?Math.tan(t):0,y=this.ep2*Math.pow(m,2),T=Math.pow(y,2),w=Math.pow(v,2),A=Math.pow(w,2);e=1-this.es*Math.pow(g,2);var P=s*Math.sqrt(e)/this.k0,M=Math.pow(P,2);e=e*v,i=t-e*M/(1-this.es)*.5*(1-M/12*(5+3*w-9*y*w+y-4*T-M/30*(61+90*w-252*y*w+45*A+46*y-M/56*(1385+3633*w+4095*A+1574*A*w)))),r=_e(this.long0+P*(1-M/6*(1+2*w+y-M/20*(5+28*w+24*A+8*y*w+6*y-M/42*(61+662*w+1320*A+720*A*w))))/m,this.over)}else i=se*Wg(o),r=0;else{var a=Math.exp(s/this.k0),u=.5*(a-1/a),h=this.lat0+o/this.k0,d=Math.cos(h);e=Math.sqrt((1-Math.pow(d,2))/(1+Math.pow(u,2))),i=Math.asin(e),o<0&&(i=-i),u===0&&d===0?r=0:r=_e(Math.atan2(u,d)+this.long0,this.over)}return n.x=r,n.y=i,n}var bQ=["Fast_Transverse_Mercator","Fast Transverse Mercator"];const n_={init:PQ,forward:CQ,inverse:MQ,names:bQ};function DO(n){var e=Math.exp(n);return e=(e-1/e)/2,e}function Pi(n,e){n=Math.abs(n),e=Math.abs(e);var t=Math.max(n,e),i=Math.min(n,e)/(t||1);return t*Math.sqrt(1+Math.pow(i,2))}function LQ(n){var e=1+n,t=e-1;return t===0?n:n*Math.log(e)/t}function kQ(n){var e=Math.abs(n);return e=LQ(e*(1+e/(Pi(1,e)+1))),n<0?-e:e}function gT(n,e){for(var t=2*Math.cos(2*e),i=n.length-1,r=n[i],s=0,o;--i>=0;)o=-s+t*r+n[i],s=r,r=o;return e+o*Math.sin(2*e)}function DQ(n,e){for(var t=2*Math.cos(e),i=n.length-1,r=n[i],s=0,o;--i>=0;)o=-s+t*r+n[i],s=r,r=o;return Math.sin(e)*o}function NQ(n){var e=Math.exp(n);return e=(e+1/e)/2,e}function NO(n,e,t){for(var i=Math.sin(e),r=Math.cos(e),s=DO(t),o=NQ(t),a=2*r*o,u=-2*i*s,h=n.length-1,d=n[h],g=0,m=0,v=0,y,T;--h>=0;)y=m,T=g,m=d,g=v,d=-y+a*m-u*g+n[h],v=-T+u*m+a*g;return a=i*o,u=r*s,[a*d-u*v,a*v+u*d]}function OQ(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(n_.init.apply(this),this.forward=n_.forward,this.inverse=n_.inverse),this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var n=this.es/(1+Math.sqrt(1-this.es)),e=n/(2-n),t=e;this.cgb[0]=e*(2+e*(-2/3+e*(-2+e*(116/45+e*(26/45+e*(-2854/675)))))),this.cbg[0]=e*(-2+e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725)))))),t=t*e,this.cgb[1]=t*(7/3+e*(-8/5+e*(-227/45+e*(2704/315+e*(2323/945))))),this.cbg[1]=t*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945))))),t=t*e,this.cgb[2]=t*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835)))),this.cbg[2]=t*(-26/15+e*(34/21+e*(8/5+e*(-12686/2835)))),t=t*e,this.cgb[3]=t*(4279/630+e*(-332/35+e*(-399572/14175))),this.cbg[3]=t*(1237/630+e*(-12/5+e*(-24832/14175))),t=t*e,this.cgb[4]=t*(4174/315+e*(-144838/6237)),this.cbg[4]=t*(-734/315+e*(109598/31185)),t=t*e,this.cgb[5]=t*(601676/22275),this.cbg[5]=t*(444337/155925),t=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+t*(1/4+t*(1/64+t/256))),this.utg[0]=e*(-.5+e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800)))))),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800)))))),this.utg[1]=t*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720))))),this.gtu[1]=t*(13/48+e*(-3/5+e*(557/1440+e*(281/630+e*(-1983433/1935360))))),t=t*e,this.utg[2]=t*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720)))),this.gtu[2]=t*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440)))),t=t*e,this.utg[3]=t*(-4397/161280+e*(11/504+e*(830251/7257600))),this.gtu[3]=t*(49561/161280+e*(-179/168+e*(6601661/7257600))),t=t*e,this.utg[4]=t*(-4583/161280+e*(108847/3991680)),this.gtu[4]=t*(34729/80640+e*(-3418889/1995840)),t=t*e,this.utg[5]=t*(-20648693/638668800),this.gtu[5]=t*(212378941/319334400);var i=gT(this.cbg,this.lat0);this.Zb=-this.Qn*(i+DQ(this.gtu,2*i))}function VQ(n){var e=_e(n.x-this.long0,this.over),t=n.y;t=gT(this.cbg,t);var i=Math.sin(t),r=Math.cos(t),s=Math.sin(e),o=Math.cos(e);t=Math.atan2(i,o*r),e=Math.atan2(s*r,Pi(i,r*o)),e=kQ(Math.tan(e));var a=NO(this.gtu,2*t,2*e);t=t+a[0],e=e+a[1];var u,h;return Math.abs(e)<=2.623395162778?(u=this.a*(this.Qn*e)+this.x0,h=this.a*(this.Qn*t+this.Zb)+this.y0):(u=1/0,h=1/0),n.x=u,n.y=h,n}function FQ(n){var e=(n.x-this.x0)*(1/this.a),t=(n.y-this.y0)*(1/this.a);t=(t-this.Zb)/this.Qn,e=e/this.Qn;var i,r;if(Math.abs(e)<=2.623395162778){var s=NO(this.utg,2*t,2*e);t=t+s[0],e=e+s[1],e=Math.atan(DO(e));var o=Math.sin(t),a=Math.cos(t),u=Math.sin(e),h=Math.cos(e);t=Math.atan2(o*h,Pi(u,h*a)),e=Math.atan2(u,h*a),i=_e(e+this.long0,this.over),r=gT(this.cgb,t)}else i=1/0,r=1/0;return n.x=i,n.y=r,n}var GQ=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"];const i_={init:OQ,forward:VQ,inverse:FQ,names:GQ};function jQ(n,e){if(n===void 0){if(n=Math.floor((_e(e)+Math.PI)*30/Math.PI)+1,n<0)return 0;if(n>60)return 60}return n}var UQ="etmerc";function BQ(){var n=jQ(this.zone,this.long0);if(n===void 0)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(n)-183)*Ht,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,i_.init.apply(this),this.forward=i_.forward,this.inverse=i_.inverse}var zQ=["Universal Transverse Mercator System","utm"];const $Q={init:BQ,names:zQ,dependsOn:UQ};function mT(n,e){return Math.pow((1-n)/(1+n),e)}var WQ=20;function KQ(){var n=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*n*n),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(n/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+gt)/(Math.pow(Math.tan(.5*this.lat0+gt),this.C)*mT(this.e*n,this.ratexp))}function HQ(n){var e=n.x,t=n.y;return n.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*t+gt),this.C)*mT(this.e*Math.sin(t),this.ratexp))-se,n.x=this.C*e,n}function qQ(n){for(var e=1e-14,t=n.x/this.C,i=n.y,r=Math.pow(Math.tan(.5*i+gt)/this.K,1/this.C),s=WQ;s>0&&(i=2*Math.atan(r*mT(this.e*Math.sin(n.y),-.5*this.e))-se,!(Math.abs(i-n.y)<e));--s)n.y=i;return s?(n.x=t,n.y=i,n):null}const pT={init:KQ,forward:HQ,inverse:qQ};function XQ(){pT.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))}function YQ(n){var e,t,i,r;return n.x=_e(n.x-this.long0,this.over),pT.forward.apply(this,[n]),e=Math.sin(n.y),t=Math.cos(n.y),i=Math.cos(n.x),r=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*t*i),n.x=r*t*Math.sin(n.x),n.y=r*(this.cosc0*e-this.sinc0*t*i),n.x=this.a*n.x+this.x0,n.y=this.a*n.y+this.y0,n}function ZQ(n){var e,t,i,r,s;if(n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,n.x/=this.k0,n.y/=this.k0,s=Pi(n.x,n.y)){var o=2*Math.atan2(s,this.R2);e=Math.sin(o),t=Math.cos(o),r=Math.asin(t*this.sinc0+n.y*e*this.cosc0/s),i=Math.atan2(n.x*e,s*this.cosc0*t-n.y*this.sinc0*e)}else r=this.phic0,i=0;return n.x=i,n.y=r,pT.inverse.apply(this,[n]),n.x=_e(n.x+this.long0,this.over),n}var QQ=["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"];const JQ={init:XQ,forward:YQ,inverse:ZQ,names:QQ};function _T(n,e,t){return e*=t,Math.tan(.5*(se+n))*Math.pow((1-e)/(1+e),.5*t)}function eJ(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=ge&&(this.k0=.5*(1+Wg(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=ge&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=ge&&Math.abs(Math.cos(this.lat_ts))>ge&&(this.k0=.5*this.cons*Os(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/Yr(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=Os(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(_T(this.lat0,this.sinlat0,this.e))-se,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function tJ(n){var e=n.x,t=n.y,i=Math.sin(t),r=Math.cos(t),s,o,a,u,h,d,g=_e(e-this.long0,this.over);return Math.abs(Math.abs(e-this.long0)-Math.PI)<=ge&&Math.abs(t+this.lat0)<=ge?(n.x=NaN,n.y=NaN,n):this.sphere?(s=2*this.k0/(1+this.sinlat0*i+this.coslat0*r*Math.cos(g)),n.x=this.a*s*r*Math.sin(g)+this.x0,n.y=this.a*s*(this.coslat0*i-this.sinlat0*r*Math.cos(g))+this.y0,n):(o=2*Math.atan(_T(t,i,this.e))-se,u=Math.cos(o),a=Math.sin(o),Math.abs(this.coslat0)<=ge?(h=Yr(this.e,t*this.con,this.con*i),d=2*this.a*this.k0*h/this.cons,n.x=this.x0+d*Math.sin(e-this.long0),n.y=this.y0-this.con*d*Math.cos(e-this.long0),n):(Math.abs(this.sinlat0)<ge?(s=2*this.a*this.k0/(1+u*Math.cos(g)),n.y=s*a):(s=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*a+this.cosX0*u*Math.cos(g))),n.y=s*(this.cosX0*a-this.sinX0*u*Math.cos(g))+this.y0),n.x=s*u*Math.sin(g)+this.x0,n))}function nJ(n){n.x-=this.x0,n.y-=this.y0;var e,t,i,r,s,o=Math.sqrt(n.x*n.x+n.y*n.y);if(this.sphere){var a=2*Math.atan(o/(2*this.a*this.k0));return e=this.long0,t=this.lat0,o<=ge?(n.x=e,n.y=t,n):(t=Math.asin(Math.cos(a)*this.sinlat0+n.y*Math.sin(a)*this.coslat0/o),Math.abs(this.coslat0)<ge?this.lat0>0?e=_e(this.long0+Math.atan2(n.x,-1*n.y),this.over):e=_e(this.long0+Math.atan2(n.x,n.y),this.over):e=_e(this.long0+Math.atan2(n.x*Math.sin(a),o*this.coslat0*Math.cos(a)-n.y*this.sinlat0*Math.sin(a)),this.over),n.x=e,n.y=t,n)}else if(Math.abs(this.coslat0)<=ge){if(o<=ge)return t=this.lat0,e=this.long0,n.x=e,n.y=t,n;n.x*=this.con,n.y*=this.con,i=o*this.cons/(2*this.a*this.k0),t=this.con*hg(this.e,i),e=this.con*_e(this.con*this.long0+Math.atan2(n.x,-1*n.y),this.over)}else r=2*Math.atan(o*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,o<=ge?s=this.X0:(s=Math.asin(Math.cos(r)*this.sinX0+n.y*Math.sin(r)*this.cosX0/o),e=_e(this.long0+Math.atan2(n.x*Math.sin(r),o*this.cosX0*Math.cos(r)-n.y*this.sinX0*Math.sin(r)),this.over)),t=-1*hg(this.e,Math.tan(.5*(se+s)));return n.x=e,n.y=t,n}var iJ=["stere","Stereographic_South_Pole","Polar_Stereographic_variant_A","Polar_Stereographic_variant_B","Polar_Stereographic"];const rJ={init:eJ,forward:tJ,inverse:nJ,names:iJ,ssfn_:_T};function sJ(){var n=this.lat0;this.lambda0=this.long0;var e=Math.sin(n),t=this.a,i=this.rf,r=1/i,s=2*r-Math.pow(r,2),o=this.e=Math.sqrt(s);this.R=this.k0*t*Math.sqrt(1-s)/(1-s*Math.pow(e,2)),this.alpha=Math.sqrt(1+s/(1-s)*Math.pow(Math.cos(n),4)),this.b0=Math.asin(e/this.alpha);var a=Math.log(Math.tan(Math.PI/4+this.b0/2)),u=Math.log(Math.tan(Math.PI/4+n/2)),h=Math.log((1+o*e)/(1-o*e));this.K=a-this.alpha*u+this.alpha*o/2*h}function oJ(n){var e=Math.log(Math.tan(Math.PI/4-n.y/2)),t=this.e/2*Math.log((1+this.e*Math.sin(n.y))/(1-this.e*Math.sin(n.y))),i=-this.alpha*(e+t)+this.K,r=2*(Math.atan(Math.exp(i))-Math.PI/4),s=this.alpha*(n.x-this.lambda0),o=Math.atan(Math.sin(s)/(Math.sin(this.b0)*Math.tan(r)+Math.cos(this.b0)*Math.cos(s))),a=Math.asin(Math.cos(this.b0)*Math.sin(r)-Math.sin(this.b0)*Math.cos(r)*Math.cos(s));return n.y=this.R/2*Math.log((1+Math.sin(a))/(1-Math.sin(a)))+this.y0,n.x=this.R*o+this.x0,n}function aJ(n){for(var e=n.x-this.x0,t=n.y-this.y0,i=e/this.R,r=2*(Math.atan(Math.exp(t/this.R))-Math.PI/4),s=Math.asin(Math.cos(this.b0)*Math.sin(r)+Math.sin(this.b0)*Math.cos(r)*Math.cos(i)),o=Math.atan(Math.sin(i)/(Math.cos(this.b0)*Math.cos(i)-Math.sin(this.b0)*Math.tan(r))),a=this.lambda0+o/this.alpha,u=0,h=s,d=-1e3,g=0;Math.abs(h-d)>1e-7;){if(++g>20)return;u=1/this.alpha*(Math.log(Math.tan(Math.PI/4+s/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(h))/2)),d=h,h=2*Math.atan(Math.exp(u))-Math.PI/2}return n.x=a,n.y=h,n}var lJ=["somerc"];const uJ={init:sJ,forward:oJ,inverse:aJ,names:lJ};var kc=1e-7;function cJ(n){var e=["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"],t=typeof n.projName=="object"?Object.keys(n.projName)[0]:n.projName;return"no_uoff"in n||"no_off"in n||e.indexOf(t)!==-1||e.indexOf(SO(t))!==-1}function hJ(){var n,e,t,i,r,s,o,a,u,h,d=0,g,m=0,v=0,y=0,T=0,w=0,A=0;this.no_off=cJ(this),this.no_rot="no_rot"in this;var P=!1;"alpha"in this&&(P=!0);var M=!1;if("rectified_grid_angle"in this&&(M=!0),P&&(A=this.alpha),M&&(d=this.rectified_grid_angle),P||M)m=this.longc;else if(v=this.long1,T=this.lat1,y=this.long2,w=this.lat2,Math.abs(T-w)<=kc||(n=Math.abs(T))<=kc||Math.abs(n-se)<=kc||Math.abs(Math.abs(this.lat0)-se)<=kc||Math.abs(Math.abs(w)-se)<=kc)throw new Error;var k=1-this.es;e=Math.sqrt(k),Math.abs(this.lat0)>ge?(a=Math.sin(this.lat0),t=Math.cos(this.lat0),n=1-this.es*a*a,this.B=t*t,this.B=Math.sqrt(1+this.es*this.B*this.B/k),this.A=this.B*this.k0*e/n,i=this.B*e/(t*Math.sqrt(n)),r=i*i-1,r<=0?r=0:(r=Math.sqrt(r),this.lat0<0&&(r=-r)),this.E=r+=i,this.E*=Math.pow(Yr(this.e,this.lat0,a),this.B)):(this.B=1/e,this.A=this.k0,this.E=i=r=1),P||M?(P?(g=Math.asin(Math.sin(A)/i),M||(d=A)):(g=d,A=Math.asin(i*Math.sin(g))),this.lam0=m-Math.asin(.5*(r-1/r)*Math.tan(g))/this.B):(s=Math.pow(Yr(this.e,T,Math.sin(T)),this.B),o=Math.pow(Yr(this.e,w,Math.sin(w)),this.B),r=this.E/s,u=(o-s)/(o+s),h=this.E*this.E,h=(h-o*s)/(h+o*s),n=v-y,n<-Math.PI?y-=ug:n>Math.PI&&(y+=ug),this.lam0=_e(.5*(v+y)-Math.atan(h*Math.tan(.5*this.B*(v-y))/u)/this.B,this.over),g=Math.atan(2*Math.sin(this.B*_e(v-this.lam0,this.over))/(r-1/r)),d=A=Math.asin(i*Math.sin(g))),this.singam=Math.sin(g),this.cosgam=Math.cos(g),this.sinrot=Math.sin(d),this.cosrot=Math.cos(d),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(i*i-1)/Math.cos(A))),this.lat0<0&&(this.u_0=-this.u_0)),r=.5*g,this.v_pole_n=this.ArB*Math.log(Math.tan(gt-r)),this.v_pole_s=this.ArB*Math.log(Math.tan(gt+r))}function dJ(n){var e={},t,i,r,s,o,a,u,h;if(n.x=n.x-this.lam0,Math.abs(Math.abs(n.y)-se)>ge){if(o=this.E/Math.pow(Yr(this.e,n.y,Math.sin(n.y)),this.B),a=1/o,t=.5*(o-a),i=.5*(o+a),s=Math.sin(this.B*n.x),r=(t*this.singam-s*this.cosgam)/i,Math.abs(Math.abs(r)-1)<ge)throw new Error;h=.5*this.ArB*Math.log((1-r)/(1+r)),a=Math.cos(this.B*n.x),Math.abs(a)<kc?u=this.A*n.x:u=this.ArB*Math.atan2(t*this.cosgam+s*this.singam,a)}else h=n.y>0?this.v_pole_n:this.v_pole_s,u=this.ArB*n.y;return this.no_rot?(e.x=u,e.y=h):(u-=this.u_0,e.x=h*this.cosrot+u*this.sinrot,e.y=u*this.cosrot-h*this.sinrot),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e}function fJ(n){var e,t,i,r,s,o,a,u={};if(n.x=(n.x-this.x0)*(1/this.a),n.y=(n.y-this.y0)*(1/this.a),this.no_rot?(t=n.y,e=n.x):(t=n.x*this.cosrot-n.y*this.sinrot,e=n.y*this.cosrot+n.x*this.sinrot+this.u_0),i=Math.exp(-this.BrA*t),r=.5*(i-1/i),s=.5*(i+1/i),o=Math.sin(this.BrA*e),a=(o*this.cosgam+r*this.singam)/s,Math.abs(Math.abs(a)-1)<ge)u.x=0,u.y=a<0?-se:se;else{if(u.y=this.E/Math.sqrt((1+a)/(1-a)),u.y=hg(this.e,Math.pow(u.y,1/this.B)),u.y===1/0)throw new Error;u.x=-this.rB*Math.atan2(r*this.cosgam-o*this.singam,Math.cos(this.BrA*e))}return u.x+=this.lam0,u}var gJ=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Variant_B","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"];const mJ={init:hJ,forward:dJ,inverse:fJ,names:gJ};function pJ(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<ge)){var n=this.b/this.a;this.e=Math.sqrt(1-n*n);var e=Math.sin(this.lat1),t=Math.cos(this.lat1),i=Os(this.e,e,t),r=Yr(this.e,this.lat1,e),s=Math.sin(this.lat2),o=Math.cos(this.lat2),a=Os(this.e,s,o),u=Yr(this.e,this.lat2,s),h=Math.abs(Math.abs(this.lat0)-se)<ge?0:Yr(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>ge?this.ns=Math.log(i/a)/Math.log(r/u):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=i/(this.ns*Math.pow(r,this.ns)),this.rh=this.a*this.f0*Math.pow(h,this.ns),this.title||(this.title="Lambert Conformal Conic")}}function _J(n){var e=n.x,t=n.y;Math.abs(2*Math.abs(t)-Math.PI)<=ge&&(t=Wg(t)*(se-2*ge));var i=Math.abs(Math.abs(t)-se),r,s;if(i>ge)r=Yr(this.e,t,Math.sin(t)),s=this.a*this.f0*Math.pow(r,this.ns);else{if(i=t*this.ns,i<=0)return null;s=0}var o=this.ns*_e(e-this.long0,this.over);return n.x=this.k0*(s*Math.sin(o))+this.x0,n.y=this.k0*(this.rh-s*Math.cos(o))+this.y0,n}function yJ(n){var e,t,i,r,s,o=(n.x-this.x0)/this.k0,a=this.rh-(n.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(o*o+a*a),t=1):(e=-Math.sqrt(o*o+a*a),t=-1);var u=0;if(e!==0&&(u=Math.atan2(t*o,t*a)),e!==0||this.ns>0){if(t=1/this.ns,i=Math.pow(e/(this.a*this.f0),t),r=hg(this.e,i),r===-9999)return null}else r=-se;return s=_e(u/this.ns+this.long0,this.over),n.x=s,n.y=r,n}var vJ=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"];const EJ={init:pJ,forward:_J,inverse:yJ,names:vJ};function wJ(){this.a=6377397155e-3,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.7417649320975901-.308341501185665),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq}function xJ(n){var e,t,i,r,s,o,a,u=n.x,h=n.y,d=_e(u-this.long0,this.over);return e=Math.pow((1+this.e*Math.sin(h))/(1-this.e*Math.sin(h)),this.alfa*this.e/2),t=2*(Math.atan(this.k*Math.pow(Math.tan(h/2+this.s45),this.alfa)/e)-this.s45),i=-d*this.alfa,r=Math.asin(Math.cos(this.ad)*Math.sin(t)+Math.sin(this.ad)*Math.cos(t)*Math.cos(i)),s=Math.asin(Math.cos(t)*Math.sin(i)/Math.cos(r)),o=this.n*s,a=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(r/2+this.s45),this.n),n.y=a*Math.cos(o)/1,n.x=a*Math.sin(o)/1,this.czech||(n.y*=-1,n.x*=-1),n}function SJ(n){var e,t,i,r,s,o,a,u,h=n.x;n.x=n.y,n.y=h,this.czech||(n.y*=-1,n.x*=-1),o=Math.sqrt(n.x*n.x+n.y*n.y),s=Math.atan2(n.y,n.x),r=s/Math.sin(this.s0),i=2*(Math.atan(Math.pow(this.ro0/o,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(i)-Math.sin(this.ad)*Math.cos(i)*Math.cos(r)),t=Math.asin(Math.cos(i)*Math.sin(r)/Math.cos(e)),n.x=this.long0-t/this.alfa,a=e,u=0;var d=0;do n.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(a))/(1-this.e*Math.sin(a)),this.e/2))-this.s45),Math.abs(a-n.y)<1e-10&&(u=1),a=n.y,d+=1;while(u===0&&d<15);return d>=15?null:n}var TJ=["Krovak","krovak"];const IJ={init:wJ,forward:xJ,inverse:SJ,names:TJ};function hi(n,e,t,i,r){return n*r-e*Math.sin(2*r)+t*Math.sin(4*r)-i*Math.sin(6*r)}function Kg(n){return 1-.25*n*(1+n/16*(3+1.25*n))}function Hg(n){return .375*n*(1+.25*n*(1+.46875*n))}function qg(n){return .05859375*n*n*(1+.75*n)}function Xg(n){return n*n*n*(35/3072)}function yT(n,e,t){var i=e*t;return n/Math.sqrt(1-i*i)}function Ya(n){return Math.abs(n)<se?n:n-Wg(n)*Math.PI}function u0(n,e,t,i,r){var s,o;s=n/e;for(var a=0;a<15;a++)if(o=(n-(e*s-t*Math.sin(2*s)+i*Math.sin(4*s)-r*Math.sin(6*s)))/(e-2*t*Math.cos(2*s)+4*i*Math.cos(4*s)-6*r*Math.cos(6*s)),s+=o,Math.abs(o)<=1e-10)return s;return NaN}function AJ(){this.sphere||(this.e0=Kg(this.es),this.e1=Hg(this.es),this.e2=qg(this.es),this.e3=Xg(this.es),this.ml0=this.a*hi(this.e0,this.e1,this.e2,this.e3,this.lat0))}function RJ(n){var e,t,i=n.x,r=n.y;if(i=_e(i-this.long0,this.over),this.sphere)e=this.a*Math.asin(Math.cos(r)*Math.sin(i)),t=this.a*(Math.atan2(Math.tan(r),Math.cos(i))-this.lat0);else{var s=Math.sin(r),o=Math.cos(r),a=yT(this.a,this.e,s),u=Math.tan(r)*Math.tan(r),h=i*Math.cos(r),d=h*h,g=this.es*o*o/(1-this.es),m=this.a*hi(this.e0,this.e1,this.e2,this.e3,r);e=a*h*(1-d*u*(1/6-(8-u+8*g)*d/120)),t=m-this.ml0+a*s/o*d*(.5+(5-u+6*g)*d/24)}return n.x=e+this.x0,n.y=t+this.y0,n}function PJ(n){n.x-=this.x0,n.y-=this.y0;var e=n.x/this.a,t=n.y/this.a,i,r;if(this.sphere){var s=t+this.lat0;i=Math.asin(Math.sin(s)*Math.cos(e)),r=Math.atan2(Math.tan(e),Math.cos(s))}else{var o=this.ml0/this.a+t,a=u0(o,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(a)-se)<=ge)return n.x=this.long0,n.y=se,t<0&&(n.y*=-1),n;var u=yT(this.a,this.e,Math.sin(a)),h=u*u*u/this.a/this.a*(1-this.es),d=Math.pow(Math.tan(a),2),g=e*this.a/u,m=g*g;i=a-u*Math.tan(a)/h*g*g*(.5-(1+3*d)*g*g/24),r=g*(1-m*(d/3+(1+3*d)*d*m/15))/Math.cos(a)}return n.x=_e(r+this.long0,this.over),n.y=Ya(i),n}var CJ=["Cassini","Cassini_Soldner","cass"];const MJ={init:AJ,forward:RJ,inverse:PJ,names:CJ};function ka(n,e){var t;return n>1e-7?(t=n*e,(1-n*n)*(e/(1-t*t)-.5/n*Math.log((1-t)/(1+t)))):2*e}var Mw=1,bw=2,Lw=3,r_=4;function bJ(){var n=Math.abs(this.lat0);if(Math.abs(n-se)<ge?this.mode=this.lat0<0?Mw:bw:Math.abs(n)<ge?this.mode=Lw:this.mode=r_,this.es>0){var e;switch(this.qp=ka(this.e,1),this.mmf=.5/(1-this.es),this.apa=jJ(this.es),this.mode){case bw:this.dd=1;break;case Mw:this.dd=1;break;case Lw:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case r_:this.rq=Math.sqrt(.5*this.qp),e=Math.sin(this.lat0),this.sinb1=ka(this.e,e)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*e*e)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd;break}}else this.mode===r_&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function LJ(n){var e,t,i,r,s,o,a,u,h,d,g=n.x,m=n.y;if(g=_e(g-this.long0,this.over),this.sphere){if(s=Math.sin(m),d=Math.cos(m),i=Math.cos(g),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(t=this.mode===this.EQUIT?1+d*i:1+this.sinph0*s+this.cosph0*d*i,t<=ge)return null;t=Math.sqrt(2/t),e=t*d*Math.sin(g),t*=this.mode===this.EQUIT?s:this.cosph0*s-this.sinph0*d*i}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(i=-i),Math.abs(m+this.lat0)<ge)return null;t=gt-m*.5,t=2*(this.mode===this.S_POLE?Math.cos(t):Math.sin(t)),e=t*Math.sin(g),t*=i}}else{switch(a=0,u=0,h=0,i=Math.cos(g),r=Math.sin(g),s=Math.sin(m),o=ka(this.e,s),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(a=o/this.qp,u=Math.sqrt(1-a*a)),this.mode){case this.OBLIQ:h=1+this.sinb1*a+this.cosb1*u*i;break;case this.EQUIT:h=1+u*i;break;case this.N_POLE:h=se+m,o=this.qp-o;break;case this.S_POLE:h=m-se,o=this.qp+o;break}if(Math.abs(h)<ge)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:h=Math.sqrt(2/h),this.mode===this.OBLIQ?t=this.ymf*h*(this.cosb1*a-this.sinb1*u*i):t=(h=Math.sqrt(2/(1+u*i)))*a*this.ymf,e=this.xmf*h*u*r;break;case this.N_POLE:case this.S_POLE:o>=0?(e=(h=Math.sqrt(o))*r,t=i*(this.mode===this.S_POLE?h:-h)):e=t=0;break}}return n.x=this.a*e+this.x0,n.y=this.a*t+this.y0,n}function kJ(n){n.x-=this.x0,n.y-=this.y0;var e=n.x/this.a,t=n.y/this.a,i,r,s,o,a,u,h;if(this.sphere){var d=0,g,m=0;if(g=Math.sqrt(e*e+t*t),r=g*.5,r>1)return null;switch(r=2*Math.asin(r),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(m=Math.sin(r),d=Math.cos(r)),this.mode){case this.EQUIT:r=Math.abs(g)<=ge?0:Math.asin(t*m/g),e*=m,t=d*g;break;case this.OBLIQ:r=Math.abs(g)<=ge?this.lat0:Math.asin(d*this.sinph0+t*m*this.cosph0/g),e*=m*this.cosph0,t=(d-Math.sin(r)*this.sinph0)*g;break;case this.N_POLE:t=-t,r=se-r;break;case this.S_POLE:r-=se;break}i=t===0&&(this.mode===this.EQUIT||this.mode===this.OBLIQ)?0:Math.atan2(e,t)}else{if(h=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(e/=this.dd,t*=this.dd,u=Math.sqrt(e*e+t*t),u<ge)return n.x=this.long0,n.y=this.lat0,n;o=2*Math.asin(.5*u/this.rq),s=Math.cos(o),e*=o=Math.sin(o),this.mode===this.OBLIQ?(h=s*this.sinb1+t*o*this.cosb1/u,a=this.qp*h,t=u*this.cosb1*s-t*this.sinb1*o):(h=t*o/u,a=this.qp*h,t=u*s)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(t=-t),a=e*e+t*t,!a)return n.x=this.long0,n.y=this.lat0,n;h=1-a/this.qp,this.mode===this.S_POLE&&(h=-h)}i=Math.atan2(e,t),r=UJ(Math.asin(h),this.apa)}return n.x=_e(this.long0+i,this.over),n.y=r,n}var DJ=.3333333333333333,NJ=.17222222222222222,OJ=.10257936507936508,VJ=.06388888888888888,FJ=.0664021164021164,GJ=.016415012942191543;function jJ(n){var e,t=[];return t[0]=n*DJ,e=n*n,t[0]+=e*NJ,t[1]=e*VJ,e*=n,t[0]+=e*OJ,t[1]+=e*FJ,t[2]=e*GJ,t}function UJ(n,e){var t=n+n;return n+e[0]*Math.sin(t)+e[1]*Math.sin(t+t)+e[2]*Math.sin(t+t+t)}var BJ=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"];const zJ={init:bJ,forward:LJ,inverse:kJ,names:BJ,S_POLE:Mw,N_POLE:bw,EQUIT:Lw,OBLIQ:r_};function $a(n){return Math.abs(n)>1&&(n=n>1?1:-1),Math.asin(n)}function $J(){Math.abs(this.lat1+this.lat2)<ge||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=Os(this.e3,this.sin_po,this.cos_po),this.qs1=ka(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=Os(this.e3,this.sin_po,this.cos_po),this.qs2=ka(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=ka(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>ge?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function WJ(n){var e=n.x,t=n.y;this.sin_phi=Math.sin(t),this.cos_phi=Math.cos(t);var i=ka(this.e3,this.sin_phi),r=this.a*Math.sqrt(this.c-this.ns0*i)/this.ns0,s=this.ns0*_e(e-this.long0,this.over),o=r*Math.sin(s)+this.x0,a=this.rh-r*Math.cos(s)+this.y0;return n.x=o,n.y=a,n}function KJ(n){var e,t,i,r,s,o;return n.x-=this.x0,n.y=this.rh-n.y+this.y0,this.ns0>=0?(e=Math.sqrt(n.x*n.x+n.y*n.y),i=1):(e=-Math.sqrt(n.x*n.x+n.y*n.y),i=-1),r=0,e!==0&&(r=Math.atan2(i*n.x,i*n.y)),i=e*this.ns0/this.a,this.sphere?o=Math.asin((this.c-i*i)/(2*this.ns0)):(t=(this.c-i*i)/this.ns0,o=this.phi1z(this.e3,t)),s=_e(r/this.ns0+this.long0,this.over),n.x=s,n.y=o,n}function HJ(n,e){var t,i,r,s,o,a=$a(.5*e);if(n<ge)return a;for(var u=n*n,h=1;h<=25;h++)if(t=Math.sin(a),i=Math.cos(a),r=n*t,s=1-r*r,o=.5*s*s/i*(e/(1-u)-t/s+.5/n*Math.log((1-r)/(1+r))),a=a+o,Math.abs(o)<=1e-7)return a;return null}var qJ=["Albers_Conic_Equal_Area","Albers_Equal_Area","Albers","aea"];const XJ={init:$J,forward:WJ,inverse:KJ,names:qJ,phi1z:HJ};function YJ(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1}function ZJ(n){var e,t,i,r,s,o,a,u,h=n.x,d=n.y;return i=_e(h-this.long0,this.over),e=Math.sin(d),t=Math.cos(d),r=Math.cos(i),o=this.sin_p14*e+this.cos_p14*t*r,s=1,o>0||Math.abs(o)<=ge?(a=this.x0+this.a*s*t*Math.sin(i)/o,u=this.y0+this.a*s*(this.cos_p14*e-this.sin_p14*t*r)/o):(a=this.x0+this.infinity_dist*t*Math.sin(i),u=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*t*r)),n.x=a,n.y=u,n}function QJ(n){var e,t,i,r,s,o;return n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,n.x/=this.k0,n.y/=this.k0,(e=Math.sqrt(n.x*n.x+n.y*n.y))?(r=Math.atan2(e,this.rc),t=Math.sin(r),i=Math.cos(r),o=$a(i*this.sin_p14+n.y*t*this.cos_p14/e),s=Math.atan2(n.x*t,e*this.cos_p14*i-n.y*this.sin_p14*t),s=_e(this.long0+s,this.over)):(o=this.phic0,s=0),n.x=s,n.y=o,n}var JJ=["gnom"];const eee={init:YJ,forward:ZJ,inverse:QJ,names:JJ};function tee(n,e){var t=1-(1-n*n)/(2*n)*Math.log((1-n)/(1+n));if(Math.abs(Math.abs(e)-t)<1e-6)return e<0?-1*se:se;for(var i=Math.asin(.5*e),r,s,o,a,u=0;u<30;u++)if(s=Math.sin(i),o=Math.cos(i),a=n*s,r=Math.pow(1-a*a,2)/(2*o)*(e/(1-n*n)-s/(1-a*a)+.5/n*Math.log((1-a)/(1+a))),i+=r,Math.abs(r)<=1e-10)return i;return NaN}function nee(){this.sphere||(this.k0=Os(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))}function iee(n){var e=n.x,t=n.y,i,r,s=_e(e-this.long0,this.over);if(this.sphere)i=this.x0+this.a*s*Math.cos(this.lat_ts),r=this.y0+this.a*Math.sin(t)/Math.cos(this.lat_ts);else{var o=ka(this.e,Math.sin(t));i=this.x0+this.a*this.k0*s,r=this.y0+this.a*o*.5/this.k0}return n.x=i,n.y=r,n}function ree(n){n.x-=this.x0,n.y-=this.y0;var e,t;return this.sphere?(e=_e(this.long0+n.x/this.a/Math.cos(this.lat_ts),this.over),t=Math.asin(n.y/this.a*Math.cos(this.lat_ts))):(t=tee(this.e,2*n.y*this.k0/this.a),e=_e(this.long0+n.x/(this.a*this.k0),this.over)),n.x=e,n.y=t,n}var see=["cea"];const oee={init:nee,forward:iee,inverse:ree,names:see};function aee(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)}function lee(n){var e=n.x,t=n.y,i=_e(e-this.long0,this.over),r=Ya(t-this.lat0);return n.x=this.x0+this.a*i*this.rc,n.y=this.y0+this.a*r,n}function uee(n){var e=n.x,t=n.y;return n.x=_e(this.long0+(e-this.x0)/(this.a*this.rc),this.over),n.y=Ya(this.lat0+(t-this.y0)/this.a),n}var cee=["Equirectangular","Equidistant_Cylindrical","Equidistant_Cylindrical_Spherical","eqc"];const hee={init:aee,forward:lee,inverse:uee,names:cee};var GM=20;function dee(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Kg(this.es),this.e1=Hg(this.es),this.e2=qg(this.es),this.e3=Xg(this.es),this.ml0=this.a*hi(this.e0,this.e1,this.e2,this.e3,this.lat0)}function fee(n){var e=n.x,t=n.y,i,r,s,o=_e(e-this.long0,this.over);if(s=o*Math.sin(t),this.sphere)Math.abs(t)<=ge?(i=this.a*o,r=-1*this.a*this.lat0):(i=this.a*Math.sin(s)/Math.tan(t),r=this.a*(Ya(t-this.lat0)+(1-Math.cos(s))/Math.tan(t)));else if(Math.abs(t)<=ge)i=this.a*o,r=-1*this.ml0;else{var a=yT(this.a,this.e,Math.sin(t))/Math.tan(t);i=a*Math.sin(s),r=this.a*hi(this.e0,this.e1,this.e2,this.e3,t)-this.ml0+a*(1-Math.cos(s))}return n.x=i+this.x0,n.y=r+this.y0,n}function gee(n){var e,t,i,r,s,o,a,u,h;if(i=n.x-this.x0,r=n.y-this.y0,this.sphere)if(Math.abs(r+this.a*this.lat0)<=ge)e=_e(i/this.a+this.long0,this.over),t=0;else{o=this.lat0+r/this.a,a=i*i/this.a/this.a+o*o,u=o;var d;for(s=GM;s;--s)if(d=Math.tan(u),h=-1*(o*(u*d+1)-u-.5*(u*u+a)*d)/((u-o)/d-1),u+=h,Math.abs(h)<=ge){t=u;break}e=_e(this.long0+Math.asin(i*Math.tan(u)/this.a)/Math.sin(t),this.over)}else if(Math.abs(r+this.ml0)<=ge)t=0,e=_e(this.long0+i/this.a,this.over);else{o=(this.ml0+r)/this.a,a=i*i/this.a/this.a+o*o,u=o;var g,m,v,y,T;for(s=GM;s;--s)if(T=this.e*Math.sin(u),g=Math.sqrt(1-T*T)*Math.tan(u),m=this.a*hi(this.e0,this.e1,this.e2,this.e3,u),v=this.e0-2*this.e1*Math.cos(2*u)+4*this.e2*Math.cos(4*u)-6*this.e3*Math.cos(6*u),y=m/this.a,h=(o*(g*y+1)-y-.5*g*(y*y+a))/(this.es*Math.sin(2*u)*(y*y+a-2*o*y)/(4*g)+(o-y)*(g*v-2/Math.sin(2*u))-v),u-=h,Math.abs(h)<=ge){t=u;break}g=Math.sqrt(1-this.es*Math.pow(Math.sin(t),2))*Math.tan(t),e=_e(this.long0+Math.asin(i*g/this.a)/Math.sin(t),this.over)}return n.x=e,n.y=t,n}var mee=["Polyconic","American_Polyconic","poly"];const pee={init:dee,forward:fee,inverse:gee,names:mee};function _ee(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function yee(n){var e,t=n.x,i=n.y,r=i-this.lat0,s=t-this.long0,o=r/Tf*1e-5,a=s,u=1,h=0;for(e=1;e<=10;e++)u=u*o,h=h+this.A[e]*u;var d=h,g=a,m=1,v=0,y,T,w=0,A=0;for(e=1;e<=6;e++)y=m*d-v*g,T=v*d+m*g,m=y,v=T,w=w+this.B_re[e]*m-this.B_im[e]*v,A=A+this.B_im[e]*m+this.B_re[e]*v;return n.x=A*this.a+this.x0,n.y=w*this.a+this.y0,n}function vee(n){var e,t=n.x,i=n.y,r=t-this.x0,s=i-this.y0,o=s/this.a,a=r/this.a,u=1,h=0,d,g,m=0,v=0;for(e=1;e<=6;e++)d=u*o-h*a,g=h*o+u*a,u=d,h=g,m=m+this.C_re[e]*u-this.C_im[e]*h,v=v+this.C_im[e]*u+this.C_re[e]*h;for(var y=0;y<this.iterations;y++){var T=m,w=v,A,P,M=o,k=a;for(e=2;e<=6;e++)A=T*m-w*v,P=w*m+T*v,T=A,w=P,M=M+(e-1)*(this.B_re[e]*T-this.B_im[e]*w),k=k+(e-1)*(this.B_im[e]*T+this.B_re[e]*w);T=1,w=0;var N=this.B_re[1],B=this.B_im[1];for(e=2;e<=6;e++)A=T*m-w*v,P=w*m+T*v,T=A,w=P,N=N+e*(this.B_re[e]*T-this.B_im[e]*w),B=B+e*(this.B_im[e]*T+this.B_re[e]*w);var b=N*N+B*B;m=(M*N+k*B)/b,v=(k*N-M*B)/b}var R=m,L=v,V=1,F=0;for(e=1;e<=9;e++)V=V*R,F=F+this.D[e]*V;var U=this.lat0+F*Tf*1e5,D=this.long0+L;return n.x=D,n.y=U,n}var Eee=["New_Zealand_Map_Grid","nzmg"];const wee={init:_ee,forward:yee,inverse:vee,names:Eee};function xee(){}function See(n){var e=n.x,t=n.y,i=_e(e-this.long0,this.over),r=this.x0+this.a*i,s=this.y0+this.a*Math.log(Math.tan(Math.PI/4+t/2.5))*1.25;return n.x=r,n.y=s,n}function Tee(n){n.x-=this.x0,n.y-=this.y0;var e=_e(this.long0+n.x/this.a,this.over),t=2.5*(Math.atan(Math.exp(.8*n.y/this.a))-Math.PI/4);return n.x=e,n.y=t,n}var Iee=["Miller_Cylindrical","mill"];const Aee={init:xee,forward:See,inverse:Tee,names:Iee};var Ree=20;function Pee(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=dT(this.es)}function Cee(n){var e,t,i=n.x,r=n.y;if(i=_e(i-this.long0,this.over),this.sphere){if(!this.m)r=this.n!==1?Math.asin(this.n*Math.sin(r)):r;else for(var s=this.n*Math.sin(r),o=Ree;o;--o){var a=(this.m*r+Math.sin(r)-s)/(this.m+Math.cos(r));if(r-=a,Math.abs(a)<ge)break}e=this.a*this.C_x*i*(this.m+Math.cos(r)),t=this.a*this.C_y*r}else{var u=Math.sin(r),h=Math.cos(r);t=this.a*jh(r,u,h,this.en),e=this.a*i*h/Math.sqrt(1-this.es*u*u)}return n.x=e,n.y=t,n}function Mee(n){var e,t,i,r;return n.x-=this.x0,i=n.x/this.a,n.y-=this.y0,e=n.y/this.a,this.sphere?(e/=this.C_y,i=i/(this.C_x*(this.m+Math.cos(e))),this.m?e=$a((this.m*e+Math.sin(e))/this.n):this.n!==1&&(e=$a(Math.sin(e)/this.n)),i=_e(i+this.long0,this.over),e=Ya(e)):(e=fT(n.y/this.a,this.es,this.en),r=Math.abs(e),r<se?(r=Math.sin(e),t=this.long0+n.x*Math.sqrt(1-this.es*r*r)/(this.a*Math.cos(e)),i=_e(t,this.over)):r-ge<se&&(i=this.long0)),n.x=i,n.y=e,n}var bee=["Sinusoidal","sinu"];const Lee={init:Pee,forward:Cee,inverse:Mee,names:bee};function kee(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0}function Dee(n){for(var e=n.x,t=n.y,i=_e(e-this.long0,this.over),r=t,s=Math.PI*Math.sin(t);;){var o=-(r+Math.sin(r)-s)/(1+Math.cos(r));if(r+=o,Math.abs(o)<ge)break}r/=2,Math.PI/2-Math.abs(t)<ge&&(i=0);var a=.900316316158*this.a*i*Math.cos(r)+this.x0,u=1.4142135623731*this.a*Math.sin(r)+this.y0;return n.x=a,n.y=u,n}function Nee(n){var e,t;n.x-=this.x0,n.y-=this.y0,t=n.y/(1.4142135623731*this.a),Math.abs(t)>.999999999999&&(t=.999999999999),e=Math.asin(t);var i=_e(this.long0+n.x/(.900316316158*this.a*Math.cos(e)),this.over);i<-Math.PI&&(i=-Math.PI),i>Math.PI&&(i=Math.PI),t=(2*e+Math.sin(2*e))/Math.PI,Math.abs(t)>1&&(t=1);var r=Math.asin(t);return n.x=i,n.y=r,n}var Oee=["Mollweide","moll"];const Vee={init:kee,forward:Dee,inverse:Nee,names:Oee};function Fee(){Math.abs(this.lat1+this.lat2)<ge||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Kg(this.es),this.e1=Hg(this.es),this.e2=qg(this.es),this.e3=Xg(this.es),this.sin_phi=Math.sin(this.lat1),this.cos_phi=Math.cos(this.lat1),this.ms1=Os(this.e,this.sin_phi,this.cos_phi),this.ml1=hi(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<ge?this.ns=this.sin_phi:(this.sin_phi=Math.sin(this.lat2),this.cos_phi=Math.cos(this.lat2),this.ms2=Os(this.e,this.sin_phi,this.cos_phi),this.ml2=hi(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=hi(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))}function Gee(n){var e=n.x,t=n.y,i;if(this.sphere)i=this.a*(this.g-t);else{var r=hi(this.e0,this.e1,this.e2,this.e3,t);i=this.a*(this.g-r)}var s=this.ns*_e(e-this.long0,this.over),o=this.x0+i*Math.sin(s),a=this.y0+this.rh-i*Math.cos(s);return n.x=o,n.y=a,n}function jee(n){n.x-=this.x0,n.y=this.rh-n.y+this.y0;var e,t,i,r;this.ns>=0?(t=Math.sqrt(n.x*n.x+n.y*n.y),e=1):(t=-Math.sqrt(n.x*n.x+n.y*n.y),e=-1);var s=0;if(t!==0&&(s=Math.atan2(e*n.x,e*n.y)),this.sphere)return r=_e(this.long0+s/this.ns,this.over),i=Ya(this.g-t/this.a),n.x=r,n.y=i,n;var o=this.g-t/this.a;return i=u0(o,this.e0,this.e1,this.e2,this.e3),r=_e(this.long0+s/this.ns,this.over),n.x=r,n.y=i,n}var Uee=["Equidistant_Conic","eqdc"];const Bee={init:Fee,forward:Gee,inverse:jee,names:Uee};function zee(){this.R=this.a}function $ee(n){var e=n.x,t=n.y,i=_e(e-this.long0,this.over),r,s;Math.abs(t)<=ge&&(r=this.x0+this.R*i,s=this.y0);var o=$a(2*Math.abs(t/Math.PI));(Math.abs(i)<=ge||Math.abs(Math.abs(t)-se)<=ge)&&(r=this.x0,t>=0?s=this.y0+Math.PI*this.R*Math.tan(.5*o):s=this.y0+Math.PI*this.R*-Math.tan(.5*o));var a=.5*Math.abs(Math.PI/i-i/Math.PI),u=a*a,h=Math.sin(o),d=Math.cos(o),g=d/(h+d-1),m=g*g,v=g*(2/h-1),y=v*v,T=Math.PI*this.R*(a*(g-y)+Math.sqrt(u*(g-y)*(g-y)-(y+u)*(m-y)))/(y+u);i<0&&(T=-T),r=this.x0+T;var w=u+g;return T=Math.PI*this.R*(v*w-a*Math.sqrt((y+u)*(u+1)-w*w))/(y+u),t>=0?s=this.y0+T:s=this.y0-T,n.x=r,n.y=s,n}function Wee(n){var e,t,i,r,s,o,a,u,h,d,g,m,v;return n.x-=this.x0,n.y-=this.y0,g=Math.PI*this.R,i=n.x/g,r=n.y/g,s=i*i+r*r,o=-Math.abs(r)*(1+s),a=o-2*r*r+i*i,u=-2*o+1+2*r*r+s*s,v=r*r/u+(2*a*a*a/u/u/u-9*o*a/u/u)/27,h=(o-a*a/3/u)/u,d=2*Math.sqrt(-h/3),g=3*v/h/d,Math.abs(g)>1&&(g>=0?g=1:g=-1),m=Math.acos(g)/3,n.y>=0?t=(-d*Math.cos(m+Math.PI/3)-a/3/u)*Math.PI:t=-(-d*Math.cos(m+Math.PI/3)-a/3/u)*Math.PI,Math.abs(i)<ge?e=this.long0:e=_e(this.long0+Math.PI*(s-1+Math.sqrt(1+2*(i*i-r*r)+s*s))/2/i,this.over),n.x=e,n.y=t,n}var Kee=["Van_der_Grinten_I","VanDerGrinten","Van_der_Grinten","vandg"];const Hee={init:zee,forward:$ee,inverse:Wee,names:Kee};function qee(n,e,t,i,r,s){const o=i-e,a=Math.atan((1-s)*Math.tan(n)),u=Math.atan((1-s)*Math.tan(t)),h=Math.sin(a),d=Math.cos(a),g=Math.sin(u),m=Math.cos(u);let v=o,y,T=100,w,A,P,M,k,N,B,b,R,L,V,F,U,D;do{if(w=Math.sin(v),A=Math.cos(v),P=Math.sqrt(m*w*(m*w)+(d*g-h*m*A)*(d*g-h*m*A)),P===0)return{azi1:0,s12:0};M=h*g+d*m*A,k=Math.atan2(P,M),N=d*m*w/P,B=1-N*N,b=B!==0?M-2*h*g/B:0,R=s/16*B*(4+s*(4-3*B)),y=v,v=o+(1-R)*s*N*(k+R*P*(b+R*M*(-1+2*b*b)))}while(Math.abs(v-y)>1e-12&&--T>0);return T===0?{azi1:NaN,s12:NaN}:(L=B*(r*r-r*(1-s)*(r*(1-s)))/(r*(1-s)*(r*(1-s))),V=1+L/16384*(4096+L*(-768+L*(320-175*L))),F=L/1024*(256+L*(-128+L*(74-47*L))),U=F*P*(b+F/4*(M*(-1+2*b*b)-F/6*b*(-3+4*P*P)*(-3+4*b*b))),D=r*(1-s)*V*(k-U),{azi1:Math.atan2(m*w,d*g-h*m*A),s12:D})}function Xee(n,e,t,i,r,s){const o=Math.atan((1-s)*Math.tan(n)),a=Math.sin(o),u=Math.cos(o),h=Math.sin(t),d=Math.cos(t),g=Math.atan2(a,u*d),m=u*h,v=1-m*m,y=v*(r*r-r*(1-s)*(r*(1-s)))/(r*(1-s)*(r*(1-s))),T=1+y/16384*(4096+y*(-768+y*(320-175*y))),w=y/1024*(256+y*(-128+y*(74-47*y)));let A=i/(r*(1-s)*T),P,M=100,k,N,B,b;do k=Math.cos(2*g+A),N=Math.sin(A),B=Math.cos(A),b=w*N*(k+w/4*(B*(-1+2*k*k)-w/6*k*(-3+4*N*N)*(-3+4*k*k))),P=A,A=i/(r*(1-s)*T)+b;while(Math.abs(A-P)>1e-12&&--M>0);if(M===0)return{lat2:NaN,lon2:NaN};const R=a*N-u*B*d,L=Math.atan2(a*B+u*N*d,(1-s)*Math.sqrt(m*m+R*R)),V=Math.atan2(N*h,u*B-a*N*d),F=s/16*v*(4+s*(4-3*v)),U=V-(1-F)*s*m*(A+F*N*(k+F*B*(-1+2*k*k))),D=e+U;return{lat2:L,lon2:D}}function Yee(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0),this.f=this.es/(1+Math.sqrt(1-this.es))}function Zee(n){var e=n.x,t=n.y,i=Math.sin(n.y),r=Math.cos(n.y),s=_e(e-this.long0,this.over),o,a,u,h,d,g,m,v,y,T,w;return this.sphere?Math.abs(this.sin_p12-1)<=ge?(n.x=this.x0+this.a*(se-t)*Math.sin(s),n.y=this.y0-this.a*(se-t)*Math.cos(s),n):Math.abs(this.sin_p12+1)<=ge?(n.x=this.x0+this.a*(se+t)*Math.sin(s),n.y=this.y0+this.a*(se+t)*Math.cos(s),n):(y=this.sin_p12*i+this.cos_p12*r*Math.cos(s),m=Math.acos(y),v=m?m/Math.sin(m):1,n.x=this.x0+this.a*v*r*Math.sin(s),n.y=this.y0+this.a*v*(this.cos_p12*i-this.sin_p12*r*Math.cos(s)),n):(o=Kg(this.es),a=Hg(this.es),u=qg(this.es),h=Xg(this.es),Math.abs(this.sin_p12-1)<=ge?(d=this.a*hi(o,a,u,h,se),g=this.a*hi(o,a,u,h,t),n.x=this.x0+(d-g)*Math.sin(s),n.y=this.y0-(d-g)*Math.cos(s),n):Math.abs(this.sin_p12+1)<=ge?(d=this.a*hi(o,a,u,h,se),g=this.a*hi(o,a,u,h,t),n.x=this.x0+(d+g)*Math.sin(s),n.y=this.y0+(d+g)*Math.cos(s),n):Math.abs(e)<ge&&Math.abs(t-this.lat0)<ge?(n.x=n.y=0,n):(T=qee(this.lat0,this.long0,t,e,this.a,this.f),w=T.azi1,n.x=T.s12*Math.sin(w),n.y=T.s12*Math.cos(w),n))}function Qee(n){n.x-=this.x0,n.y-=this.y0;var e,t,i,r,s,o,a,u,h,d,g,m,v,y,T,w;return this.sphere?(e=Math.sqrt(n.x*n.x+n.y*n.y),e>2*se*this.a?void 0:(t=e/this.a,i=Math.sin(t),r=Math.cos(t),s=this.long0,Math.abs(e)<=ge?o=this.lat0:(o=$a(r*this.sin_p12+n.y*i*this.cos_p12/e),a=Math.abs(this.lat0)-se,Math.abs(a)<=ge?this.lat0>=0?s=_e(this.long0+Math.atan2(n.x,-n.y),this.over):s=_e(this.long0-Math.atan2(-n.x,n.y),this.over):s=_e(this.long0+Math.atan2(n.x*i,e*this.cos_p12*r-n.y*this.sin_p12*i),this.over)),n.x=s,n.y=o,n)):(u=Kg(this.es),h=Hg(this.es),d=qg(this.es),g=Xg(this.es),Math.abs(this.sin_p12-1)<=ge?(m=this.a*hi(u,h,d,g,se),e=Math.sqrt(n.x*n.x+n.y*n.y),v=m-e,o=u0(v/this.a,u,h,d,g),s=_e(this.long0+Math.atan2(n.x,-1*n.y),this.over),n.x=s,n.y=o,n):Math.abs(this.sin_p12+1)<=ge?(m=this.a*hi(u,h,d,g,se),e=Math.sqrt(n.x*n.x+n.y*n.y),v=e-m,o=u0(v/this.a,u,h,d,g),s=_e(this.long0+Math.atan2(n.x,n.y),this.over),n.x=s,n.y=o,n):(y=Math.atan2(n.x,n.y),T=Math.sqrt(n.x*n.x+n.y*n.y),w=Xee(this.lat0,this.long0,y,T,this.a,this.f),n.x=w.lon2,n.y=w.lat2,n))}var Jee=["Azimuthal_Equidistant","aeqd"];const ete={init:Yee,forward:Zee,inverse:Qee,names:Jee};function tte(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)}function nte(n){var e,t,i,r,s,o,a,u,h=n.x,d=n.y;return i=_e(h-this.long0,this.over),e=Math.sin(d),t=Math.cos(d),r=Math.cos(i),o=this.sin_p14*e+this.cos_p14*t*r,s=1,(o>0||Math.abs(o)<=ge)&&(a=this.a*s*t*Math.sin(i),u=this.y0+this.a*s*(this.cos_p14*e-this.sin_p14*t*r)),n.x=a,n.y=u,n}function ite(n){var e,t,i,r,s,o,a;return n.x-=this.x0,n.y-=this.y0,e=Math.sqrt(n.x*n.x+n.y*n.y),t=$a(e/this.a),i=Math.sin(t),r=Math.cos(t),o=this.long0,Math.abs(e)<=ge?(a=this.lat0,n.x=o,n.y=a,n):(a=$a(r*this.sin_p14+n.y*i*this.cos_p14/e),s=Math.abs(this.lat0)-se,Math.abs(s)<=ge?(this.lat0>=0?o=_e(this.long0+Math.atan2(n.x,-n.y),this.over):o=_e(this.long0-Math.atan2(-n.x,n.y),this.over),n.x=o,n.y=a,n):(o=_e(this.long0+Math.atan2(n.x*i,e*this.cos_p14*r-n.y*this.sin_p14*i),this.over),n.x=o,n.y=a,n))}var rte=["ortho"];const ste={init:tte,forward:nte,inverse:ite,names:rte};var Bt={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},mt={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function ote(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=se-gt/2?this.face=Bt.TOP:this.lat0<=-(se-gt/2)?this.face=Bt.BOTTOM:Math.abs(this.long0)<=gt?this.face=Bt.FRONT:Math.abs(this.long0)<=se+gt?this.face=this.long0>0?Bt.RIGHT:Bt.LEFT:this.face=Bt.BACK,this.es!==0&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)}function ate(n){var e={x:0,y:0},t,i,r,s,o,a,u={value:0};if(n.x-=this.long0,this.es!==0?t=Math.atan(this.one_minus_f_squared*Math.tan(n.y)):t=n.y,i=n.x,this.face===Bt.TOP)s=se-t,i>=gt&&i<=se+gt?(u.value=mt.AREA_0,r=i-se):i>se+gt||i<=-(se+gt)?(u.value=mt.AREA_1,r=i>0?i-nn:i+nn):i>-(se+gt)&&i<=-gt?(u.value=mt.AREA_2,r=i+se):(u.value=mt.AREA_3,r=i);else if(this.face===Bt.BOTTOM)s=se+t,i>=gt&&i<=se+gt?(u.value=mt.AREA_0,r=-i+se):i<gt&&i>=-gt?(u.value=mt.AREA_1,r=-i):i<-gt&&i>=-(se+gt)?(u.value=mt.AREA_2,r=-i-se):(u.value=mt.AREA_3,r=i>0?-i+nn:-i-nn);else{var h,d,g,m,v,y,T;this.face===Bt.RIGHT?i=rh(i,+se):this.face===Bt.BACK?i=rh(i,+nn):this.face===Bt.LEFT&&(i=rh(i,-se)),m=Math.sin(t),v=Math.cos(t),y=Math.sin(i),T=Math.cos(i),h=v*T,d=v*y,g=m,this.face===Bt.FRONT?(s=Math.acos(h),r=kp(s,g,d,u)):this.face===Bt.RIGHT?(s=Math.acos(d),r=kp(s,g,-h,u)):this.face===Bt.BACK?(s=Math.acos(-h),r=kp(s,g,-d,u)):this.face===Bt.LEFT?(s=Math.acos(-d),r=kp(s,g,h,u)):(s=r=0,u.value=mt.AREA_0)}return a=Math.atan(12/nn*(r+Math.acos(Math.sin(r)*Math.cos(gt))-se)),o=Math.sqrt((1-Math.cos(s))/(Math.cos(a)*Math.cos(a))/(1-Math.cos(Math.atan(1/Math.cos(r))))),u.value===mt.AREA_1?a+=se:u.value===mt.AREA_2?a+=nn:u.value===mt.AREA_3&&(a+=1.5*nn),e.x=o*Math.cos(a),e.y=o*Math.sin(a),e.x=e.x*this.a+this.x0,e.y=e.y*this.a+this.y0,n.x=e.x,n.y=e.y,n}function lte(n){var e={lam:0,phi:0},t,i,r,s,o,a,u,h,d,g={value:0};if(n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,i=Math.atan(Math.sqrt(n.x*n.x+n.y*n.y)),t=Math.atan2(n.y,n.x),n.x>=0&&n.x>=Math.abs(n.y)?g.value=mt.AREA_0:n.y>=0&&n.y>=Math.abs(n.x)?(g.value=mt.AREA_1,t-=se):n.x<0&&-n.x>=Math.abs(n.y)?(g.value=mt.AREA_2,t=t<0?t+nn:t-nn):(g.value=mt.AREA_3,t+=se),d=nn/12*Math.tan(t),o=Math.sin(d)/(Math.cos(d)-1/Math.sqrt(2)),a=Math.atan(o),r=Math.cos(t),s=Math.tan(i),u=1-r*r*s*s*(1-Math.cos(Math.atan(1/Math.cos(a)))),u<-1?u=-1:u>1&&(u=1),this.face===Bt.TOP)h=Math.acos(u),e.phi=se-h,g.value===mt.AREA_0?e.lam=a+se:g.value===mt.AREA_1?e.lam=a<0?a+nn:a-nn:g.value===mt.AREA_2?e.lam=a-se:e.lam=a;else if(this.face===Bt.BOTTOM)h=Math.acos(u),e.phi=h-se,g.value===mt.AREA_0?e.lam=-a+se:g.value===mt.AREA_1?e.lam=-a:g.value===mt.AREA_2?e.lam=-a-se:e.lam=a<0?-a-nn:-a+nn;else{var m,v,y;m=u,d=m*m,d>=1?y=0:y=Math.sqrt(1-d)*Math.sin(a),d+=y*y,d>=1?v=0:v=Math.sqrt(1-d),g.value===mt.AREA_1?(d=v,v=-y,y=d):g.value===mt.AREA_2?(v=-v,y=-y):g.value===mt.AREA_3&&(d=v,v=y,y=-d),this.face===Bt.RIGHT?(d=m,m=-v,v=d):this.face===Bt.BACK?(m=-m,v=-v):this.face===Bt.LEFT&&(d=m,m=v,v=-d),e.phi=Math.acos(-y)-se,e.lam=Math.atan2(v,m),this.face===Bt.RIGHT?e.lam=rh(e.lam,-se):this.face===Bt.BACK?e.lam=rh(e.lam,-nn):this.face===Bt.LEFT&&(e.lam=rh(e.lam,+se))}if(this.es!==0){var T,w,A;T=e.phi<0?1:0,w=Math.tan(e.phi),A=this.b/Math.sqrt(w*w+this.one_minus_f_squared),e.phi=Math.atan(Math.sqrt(this.a*this.a-A*A)/(this.one_minus_f*A)),T&&(e.phi=-e.phi)}return e.lam+=this.long0,n.x=e.lam,n.y=e.phi,n}function kp(n,e,t,i){var r;return n<ge?(i.value=mt.AREA_0,r=0):(r=Math.atan2(e,t),Math.abs(r)<=gt?i.value=mt.AREA_0:r>gt&&r<=se+gt?(i.value=mt.AREA_1,r-=se):r>se+gt||r<=-(se+gt)?(i.value=mt.AREA_2,r=r>=0?r-nn:r+nn):(i.value=mt.AREA_3,r+=se)),r}function rh(n,e){var t=n+e;return t<-nn?t+=ug:t>+nn&&(t-=ug),t}var ute=["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"];const cte={init:ote,forward:ate,inverse:lte,names:ute};var kw=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-986701e-12],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,18736e-12],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,934959e-12],[.7986,-.00755338,-500009e-10,935324e-12],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],of=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-126793e-14,422642e-15],[.124,.0124,507171e-14,-160604e-14],[.186,.0123999,-190189e-13,600152e-14],[.248,.0124002,710039e-13,-224e-10],[.31,.0123992,-264997e-12,835986e-13],[.372,.0124029,988983e-12,-311994e-12],[.434,.0123893,-369093e-11,-435621e-12],[.4958,.0123198,-102252e-10,-345523e-12],[.5571,.0121916,-154081e-10,-582288e-12],[.6176,.0119938,-241424e-10,-525327e-12],[.6769,.011713,-320223e-10,-516405e-12],[.7346,.0113541,-397684e-10,-609052e-12],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-140374e-14],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],OO=.8487,VO=1.3523,FO=Li/5,hte=1/FO,Wc=18,c0=function(n,e){return n[0]+e*(n[1]+e*(n[2]+e*n[3]))},dte=function(n,e){return n[1]+e*(2*n[2]+e*3*n[3])};function fte(n,e,t,i){for(var r=e;i;--i){var s=n(r);if(r-=s,Math.abs(s)<t)break}return r}function gte(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"}function mte(n){var e=_e(n.x-this.long0,this.over),t=Math.abs(n.y),i=Math.floor(t*FO);i<0?i=0:i>=Wc&&(i=Wc-1),t=Li*(t-hte*i);var r={x:c0(kw[i],t)*e,y:c0(of[i],t)};return n.y<0&&(r.y=-r.y),r.x=r.x*this.a*OO+this.x0,r.y=r.y*this.a*VO+this.y0,r}function pte(n){var e={x:(n.x-this.x0)/(this.a*OO),y:Math.abs(n.y-this.y0)/(this.a*VO)};if(e.y>=1)e.x/=kw[Wc][0],e.y=n.y<0?-se:se;else{var t=Math.floor(e.y*Wc);for(t<0?t=0:t>=Wc&&(t=Wc-1);;)if(of[t][0]>e.y)--t;else if(of[t+1][0]<=e.y)++t;else break;var i=of[t],r=5*(e.y-i[0])/(of[t+1][0]-i[0]);r=fte(function(s){return(c0(i,s)-e.y)/dte(i,s)},r,ge,100),e.x/=c0(kw[t],r),e.y=(5*t+r)*Ht,n.y<0&&(e.y=-e.y)}return e.x=_e(e.x+this.long0,this.over),e}var _te=["Robinson","robin"];const yte={init:gte,forward:mte,inverse:pte,names:_te};function vte(){this.name="geocent"}function Ete(n){var e=IO(n,this.es,this.a);return e}function wte(n){var e=AO(n,this.es,this.a,this.b);return e}var xte=["Geocentric","geocentric","geocent","Geocent"];const Ste={init:vte,forward:Ete,inverse:wte,names:xte};var Zn={N_POLE:0,S_POLE:1,EQUIT:2,OBLIQ:3},jd={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};function Tte(){if(Object.keys(jd).forEach((function(t){if(typeof this[t]>"u")this[t]=jd[t].def;else{if(jd[t].num&&isNaN(this[t]))throw new Error("Invalid parameter value, must be numeric "+t+" = "+this[t]);jd[t].num&&(this[t]=parseFloat(this[t]))}jd[t].degrees&&(this[t]=this[t]*Ht)}).bind(this)),Math.abs(Math.abs(this.lat0)-se)<ge?this.mode=this.lat0<0?Zn.S_POLE:Zn.N_POLE:Math.abs(this.lat0)<ge?this.mode=Zn.EQUIT:(this.mode=Zn.OBLIQ,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var n=this.tilt,e=this.azi;this.cg=Math.cos(e),this.sg=Math.sin(e),this.cw=Math.cos(n),this.sw=Math.sin(n)}function Ite(n){n.x-=this.long0;var e=Math.sin(n.y),t=Math.cos(n.y),i=Math.cos(n.x),r,s;switch(this.mode){case Zn.OBLIQ:s=this.sinph0*e+this.cosph0*t*i;break;case Zn.EQUIT:s=t*i;break;case Zn.S_POLE:s=-e;break;case Zn.N_POLE:s=e;break}switch(s=this.pn1/(this.p-s),r=s*t*Math.sin(n.x),this.mode){case Zn.OBLIQ:s*=this.cosph0*e-this.sinph0*t*i;break;case Zn.EQUIT:s*=e;break;case Zn.N_POLE:s*=-(t*i);break;case Zn.S_POLE:s*=t*i;break}var o,a;return o=s*this.cg+r*this.sg,a=1/(o*this.sw*this.h1+this.cw),r=(r*this.cg-s*this.sg)*this.cw*a,s=o*a,n.x=r*this.a,n.y=s*this.a,n}function Ate(n){n.x/=this.a,n.y/=this.a;var e={x:n.x,y:n.y},t,i,r;r=1/(this.pn1-n.y*this.sw),t=this.pn1*n.x*r,i=this.pn1*n.y*this.cw*r,n.x=t*this.cg+i*this.sg,n.y=i*this.cg-t*this.sg;var s=Pi(n.x,n.y);if(Math.abs(s)<ge)e.x=0,e.y=n.y;else{var o,a;switch(a=1-s*s*this.pfact,a=(this.p-Math.sqrt(a))/(this.pn1/s+s/this.pn1),o=Math.sqrt(1-a*a),this.mode){case Zn.OBLIQ:e.y=Math.asin(o*this.sinph0+n.y*a*this.cosph0/s),n.y=(o-this.sinph0*Math.sin(e.y))*s,n.x*=a*this.cosph0;break;case Zn.EQUIT:e.y=Math.asin(n.y*a/s),n.y=o*s,n.x*=a;break;case Zn.N_POLE:e.y=Math.asin(o),n.y=-n.y;break;case Zn.S_POLE:e.y=-Math.asin(o);break}e.x=Math.atan2(n.x,n.y)}return n.x=e.x+this.long0,n.y=e.y,n}var Rte=["Tilted_Perspective","tpers"];const Pte={init:Tte,forward:Ite,inverse:Ate,names:Rte};function Cte(){if(this.flip_axis=this.sweep==="x"?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,this.es!==0){var n=1-this.es,e=1/n;this.radius_p=Math.sqrt(n),this.radius_p2=n,this.radius_p_inv2=e,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")}function Mte(n){var e=n.x,t=n.y,i,r,s,o;if(e=e-this.long0,this.shape==="ellipse"){t=Math.atan(this.radius_p2*Math.tan(t));var a=this.radius_p/Pi(this.radius_p*Math.cos(t),Math.sin(t));if(r=a*Math.cos(e)*Math.cos(t),s=a*Math.sin(e)*Math.cos(t),o=a*Math.sin(t),(this.radius_g-r)*r-s*s-o*o*this.radius_p_inv2<0)return n.x=Number.NaN,n.y=Number.NaN,n;i=this.radius_g-r,this.flip_axis?(n.x=this.radius_g_1*Math.atan(s/Pi(o,i)),n.y=this.radius_g_1*Math.atan(o/i)):(n.x=this.radius_g_1*Math.atan(s/i),n.y=this.radius_g_1*Math.atan(o/Pi(s,i)))}else this.shape==="sphere"&&(i=Math.cos(t),r=Math.cos(e)*i,s=Math.sin(e)*i,o=Math.sin(t),i=this.radius_g-r,this.flip_axis?(n.x=this.radius_g_1*Math.atan(s/Pi(o,i)),n.y=this.radius_g_1*Math.atan(o/i)):(n.x=this.radius_g_1*Math.atan(s/i),n.y=this.radius_g_1*Math.atan(o/Pi(s,i))));return n.x=n.x*this.a,n.y=n.y*this.a,n}function bte(n){var e=-1,t=0,i=0,r,s,o,a;if(n.x=n.x/this.a,n.y=n.y/this.a,this.shape==="ellipse"){this.flip_axis?(i=Math.tan(n.y/this.radius_g_1),t=Math.tan(n.x/this.radius_g_1)*Pi(1,i)):(t=Math.tan(n.x/this.radius_g_1),i=Math.tan(n.y/this.radius_g_1)*Pi(1,t));var u=i/this.radius_p;if(r=t*t+u*u+e*e,s=2*this.radius_g*e,o=s*s-4*r*this.C,o<0)return n.x=Number.NaN,n.y=Number.NaN,n;a=(-s-Math.sqrt(o))/(2*r),e=this.radius_g+a*e,t*=a,i*=a,n.x=Math.atan2(t,e),n.y=Math.atan(i*Math.cos(n.x)/e),n.y=Math.atan(this.radius_p_inv2*Math.tan(n.y))}else if(this.shape==="sphere"){if(this.flip_axis?(i=Math.tan(n.y/this.radius_g_1),t=Math.tan(n.x/this.radius_g_1)*Math.sqrt(1+i*i)):(t=Math.tan(n.x/this.radius_g_1),i=Math.tan(n.y/this.radius_g_1)*Math.sqrt(1+t*t)),r=t*t+i*i+e*e,s=2*this.radius_g*e,o=s*s-4*r*this.C,o<0)return n.x=Number.NaN,n.y=Number.NaN,n;a=(-s-Math.sqrt(o))/(2*r),e=this.radius_g+a*e,t*=a,i*=a,n.x=Math.atan2(t,e),n.y=Math.atan(i*Math.cos(n.x)/e)}return n.x=n.x+this.long0,n}var Lte=["Geostationary Satellite View","Geostationary_Satellite","geos"];const kte={init:Cte,forward:Mte,inverse:bte,names:Lte};var If=1.340264,Af=-.081106,Rf=893e-6,Pf=.003796,h0=Math.sqrt(3)/2;function Dte(){this.es=0,this.long0=this.long0!==void 0?this.long0:0,this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0}function Nte(n){var e=_e(n.x-this.long0,this.over),t=n.y,i=Math.asin(h0*Math.sin(t)),r=i*i,s=r*r*r;return n.x=e*Math.cos(i)/(h0*(If+3*Af*r+s*(7*Rf+9*Pf*r))),n.y=i*(If+Af*r+s*(Rf+Pf*r)),n.x=this.a*n.x+this.x0,n.y=this.a*n.y+this.y0,n}function Ote(n){n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a;var e=1e-9,t=12,i=n.y,r,s,o,a,u,h;for(h=0;h<t&&(r=i*i,s=r*r*r,o=i*(If+Af*r+s*(Rf+Pf*r))-n.y,a=If+3*Af*r+s*(7*Rf+9*Pf*r),i-=u=o/a,!(Math.abs(u)<e));++h);return r=i*i,s=r*r*r,n.x=h0*n.x*(If+3*Af*r+s*(7*Rf+9*Pf*r))/Math.cos(i),n.y=Math.asin(Math.sin(i)/h0),n.x=_e(n.x+this.long0,this.over),n}var Vte=["eqearth","Equal Earth","Equal_Earth"];const Fte={init:Dte,forward:Nte,inverse:Ote,names:Vte};var dg=1e-10;function Gte(){var n;if(this.phi1=this.lat1,Math.abs(this.phi1)<dg)throw new Error;this.es?(this.en=dT(this.es),this.m1=jh(this.phi1,this.am1=Math.sin(this.phi1),n=Math.cos(this.phi1),this.en),this.am1=n/(Math.sqrt(1-this.es*this.am1*this.am1)*this.am1),this.inverse=Ute,this.forward=jte):(Math.abs(this.phi1)+dg>=se?this.cphi1=0:this.cphi1=1/Math.tan(this.phi1),this.inverse=zte,this.forward=Bte)}function jte(n){var e=_e(n.x-(this.long0||0),this.over),t=n.y,i,r,s;return i=this.am1+this.m1-jh(t,r=Math.sin(t),s=Math.cos(t),this.en),r=s*e/(i*Math.sqrt(1-this.es*r*r)),n.x=i*Math.sin(r),n.y=this.am1-i*Math.cos(r),n.x=this.a*n.x+(this.x0||0),n.y=this.a*n.y+(this.y0||0),n}function Ute(n){n.x=(n.x-(this.x0||0))/this.a,n.y=(n.y-(this.y0||0))/this.a;var e,t,i,r;if(t=Pi(n.x,n.y=this.am1-n.y),r=fT(this.am1+this.m1-t,this.es,this.en),(e=Math.abs(r))<se)e=Math.sin(r),i=t*Math.atan2(n.x,n.y)*Math.sqrt(1-this.es*e*e)/Math.cos(r);else if(Math.abs(e-se)<=dg)i=0;else throw new Error;return n.x=_e(i+(this.long0||0),this.over),n.y=Ya(r),n}function Bte(n){var e=_e(n.x-(this.long0||0),this.over),t=n.y,i,r;return r=this.cphi1+this.phi1-t,Math.abs(r)>dg?(n.x=r*Math.sin(i=e*Math.cos(t)/r),n.y=this.cphi1-r*Math.cos(i)):n.x=n.y=0,n.x=this.a*n.x+(this.x0||0),n.y=this.a*n.y+(this.y0||0),n}function zte(n){n.x=(n.x-(this.x0||0))/this.a,n.y=(n.y-(this.y0||0))/this.a;var e,t,i=Pi(n.x,n.y=this.cphi1-n.y);if(t=this.cphi1+this.phi1-i,Math.abs(t)>se)throw new Error;return Math.abs(Math.abs(t)-se)<=dg?e=0:e=i*Math.atan2(n.x,n.y)/Math.cos(t),n.x=_e(e+(this.long0||0),this.over),n.y=Ya(t),n}var $te=["bonne","Bonne (Werner lat_1=90)"];const Wte={init:Gte,names:$te},jM={OBLIQUE:{forward:Yte,inverse:Qte},TRANSVERSE:{forward:Zte,inverse:Jte}},d0={ROTATE:{o_alpha:"oAlpha",o_lon_c:"oLongC",o_lat_c:"oLatC"},NEW_POLE:{o_lat_p:"oLatP",o_lon_p:"oLongP"},NEW_EQUATOR:{o_lon_1:"oLong1",o_lat_1:"oLat1",o_lon_2:"oLong2",o_lat_2:"oLat2"}};function Kte(){if(this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.title=this.title||"General Oblique Transformation",this.isIdentity=wO.includes(this.o_proj),!this.o_proj)throw new Error("Missing parameter: o_proj");if(this.o_proj==="ob_tran")throw new Error("Invalid value for o_proj: "+this.o_proj);const n=this.projStr.replace("+proj=ob_tran","").replace("+o_proj=","+proj=").trim(),e=Ir(n);if(!e)throw new Error("Invalid parameter: o_proj. Unknown projection "+this.o_proj);e.long0=0,this.obliqueProjection=e;let t;const i=Object.keys(d0),r=a=>{if(typeof this[a]>"u")return;const u=parseFloat(this[a])*Ht;if(isNaN(u))throw new Error("Invalid value for "+a+": "+this[a]);return u};for(let a=0;a<i.length;a++){const u=i[a],h=d0[u],d=Object.entries(h);if(d.some(([m])=>typeof this[m]<"u")){t=h;for(let m=0;m<d.length;m++){const[v,y]=d[m],T=r(v);if(typeof T>"u")throw new Error("Missing parameter: "+v+".");this[y]=T}break}}if(!t)throw new Error("No valid parameters provided for ob_tran projection.");const{lamp:s,phip:o}=Xte(this,t);this.lamp=s,Math.abs(o)>ge?(this.cphip=Math.cos(o),this.sphip=Math.sin(o),this.projectionType=jM.OBLIQUE):this.projectionType=jM.TRANSVERSE}function Hte(n){return this.projectionType.forward(this,n)}function qte(n){return this.projectionType.inverse(this,n)}function Xte(n,e){let t,i;if(e===d0.ROTATE){let r=n.oLongC,s=n.oLatC,o=n.oAlpha;if(Math.abs(Math.abs(s)-se)<=ge)throw new Error("Invalid value for o_lat_c: "+n.o_lat_c+" should be < 90");i=r+Math.atan2(-1*Math.cos(o),-1*Math.sin(o)*Math.sin(s)),t=Math.asin(Math.cos(s)*Math.sin(o))}else if(e===d0.NEW_POLE)i=n.oLongP,t=n.oLatP;else{let r=n.oLong1,s=n.oLat1,o=n.oLong2,a=n.oLat2,u=Math.abs(s);if(Math.abs(s)>se-ge)throw new Error("Invalid value for o_lat_1: "+n.o_lat_1+" should be < 90");if(Math.abs(a)>se-ge)throw new Error("Invalid value for o_lat_2: "+n.o_lat_2+" should be < 90");if(Math.abs(s-a)<ge)throw new Error("Invalid value for o_lat_1 and o_lat_2: o_lat_1 should be different from o_lat_2");if(u<ge)throw new Error("Invalid value for o_lat_1: o_lat_1 should be different from zero");i=Math.atan2(Math.cos(s)*Math.sin(a)*Math.cos(r)-Math.sin(s)*Math.cos(a)*Math.cos(o),Math.sin(s)*Math.cos(a)*Math.sin(o)-Math.cos(s)*Math.sin(a)*Math.sin(r)),t=Math.atan(-1*Math.cos(i-r)/Math.tan(s))}return{lamp:i,phip:t}}function Yte(n,e){let{x:t,y:i}=e;t+=n.long0;const r=Math.cos(t),s=Math.sin(i),o=Math.cos(i);e.x=_e(Math.atan2(o*Math.sin(t),n.sphip*o*r+n.cphip*s)+n.lamp),e.y=Math.asin(n.sphip*s-n.cphip*o*r);const a=n.obliqueProjection.forward(e);return n.isIdentity&&(a.x*=Li,a.y*=Li),a}function Zte(n,e){let{x:t,y:i}=e;t+=n.long0;const r=Math.cos(i),s=Math.cos(t);e.x=_e(Math.atan2(r*Math.sin(t),Math.sin(i))+n.lamp),e.y=Math.asin(-1*r*s);const o=n.obliqueProjection.forward(e);return n.isIdentity&&(o.x*=Li,o.y*=Li),o}function Qte(n,e){n.isIdentity&&(e.x*=Ht,e.y*=Ht);const t=n.obliqueProjection.inverse(e);let{x:i,y:r}=t;if(i<Number.MAX_VALUE){i-=n.lamp;const s=Math.cos(i),o=Math.sin(r),a=Math.cos(r);e.x=Math.atan2(a*Math.sin(i),n.sphip*a*s-n.cphip*o),e.y=Math.asin(n.sphip*o+n.cphip*a*s)}return e.x=_e(e.x+n.long0),e}function Jte(n,e){n.isIdentity&&(e.x*=Ht,e.y*=Ht);const t=n.obliqueProjection.inverse(e);let{x:i,y:r}=t;if(i<Number.MAX_VALUE){const s=Math.cos(r);i-=n.lamp,e.x=Math.atan2(s*Math.sin(i),-1*Math.sin(r)),e.y=Math.asin(s*Math.cos(i))}return e.x=_e(e.x+n.long0),e}var ene=["General Oblique Transformation","General_Oblique_Transformation","ob_tran"];const tne={init:Kte,forward:Hte,inverse:qte,names:ene};function nne(n){n.Proj.projections.add(n_),n.Proj.projections.add(i_),n.Proj.projections.add($Q),n.Proj.projections.add(JQ),n.Proj.projections.add(rJ),n.Proj.projections.add(uJ),n.Proj.projections.add(mJ),n.Proj.projections.add(EJ),n.Proj.projections.add(IJ),n.Proj.projections.add(MJ),n.Proj.projections.add(zJ),n.Proj.projections.add(XJ),n.Proj.projections.add(eee),n.Proj.projections.add(oee),n.Proj.projections.add(hee),n.Proj.projections.add(pee),n.Proj.projections.add(wee),n.Proj.projections.add(Aee),n.Proj.projections.add(Lee),n.Proj.projections.add(Vee),n.Proj.projections.add(Bee),n.Proj.projections.add(Hee),n.Proj.projections.add(ete),n.Proj.projections.add(ste),n.Proj.projections.add(cte),n.Proj.projections.add(yte),n.Proj.projections.add(Ste),n.Proj.projections.add(Pte),n.Proj.projections.add(kte),n.Proj.projections.add(Fte),n.Proj.projections.add(Wte),n.Proj.projections.add(tne)}const Kc=Object.assign(aQ,{defaultDatum:"WGS84",Proj:Ir,WGS84:new Ir("WGS84"),Point:Mh,toPoint:RO,defs:On,nadgrid:zZ,transform:l0,mgrs:lQ,version:"__VERSION__"});nne(Kc);Kc.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs");const ine={1:"Zeer lage trefkans op archeologische resten",2:"Lage trefkans op archeologische resten",3:"Middelhoge trefkans op archeologische resten",4:"Hoge trefkans op archeologische resten",5:"Lage trefkans (water)",6:"Middelhoge trefkans (water)",7:"Hoge trefkans (water)",8:"Water",9:"Niet gekarteerd"};function rne(){const n=Hi(a=>a.map),[e,t]=ne.useState(""),[i,r]=ne.useState(!1);ne.useEffect(()=>{if(!n)return;const a=async d=>{try{const g=Nc(d),m=Kc("EPSG:4326","EPSG:28992",g),v=50,T=`https://data.geo.cultureelerfgoed.nl/openbaar/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=Archeologische_Monumentenkaart_2014&QUERY_LAYERS=Archeologische_Monumentenkaart_2014&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${m[0]-v},${m[1]-v},${m[0]+v},${m[1]+v}`}`,A=await(await fetch(T)).json();if(A.features&&A.features.length>0){const P=A.features[0].properties;let M='<strong class="text-purple-800">AMK Monument</strong>';if(P.toponiem&&(M+=`<br/><span class="text-sm font-semibold">${P.toponiem}</span>`),P.kwaliteitswaarde&&(M+=`<br/><span class="text-sm text-purple-700">${P.kwaliteitswaarde}</span>`),P.omschrijving&&(M+=`<br/><span class="text-xs text-gray-600 mt-1 block">${P.omschrijving}</span>`),P.txt_label){const k=P.txt_label.split(", ").slice(0,3).join(", ");M+=`<br/><span class="text-xs text-gray-500 italic">${k}${P.txt_label.split(", ").length>3?"...":""}</span>`}return M}}catch(g){console.warn("AMK WMS query failed:",g)}return null},u=async(d,g)=>{const m=n.getLayers().getArray().filter(v=>v instanceof Rl&&v.getVisible()?v.getSource()instanceof lF:!1);for(const v of m){const y=v.getSource();if(!y)continue;const T=v.get("title")||"";if(T==="Archeo Landschappen"){try{const A=Nc(d),P=Kc("EPSG:4326","EPSG:28992",A),M=100,N=`https://services.rce.geovoorziening.nl/landschappenkaart/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=landschappenkaart_nl&QUERY_LAYERS=landschappenkaart_nl&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${P[0]-M},${P[1]-M},${P[0]+M},${P[1]+M}`}`,b=await(await fetch(N)).json();if(b.features&&b.features.length>0){const R=b.features[0].properties;let L='<strong class="text-green-800">Archeologisch Landschap</strong>';return(R.landschapsnaam||R.naam)&&(L+=`<br/><span class="text-sm font-semibold">${R.landschapsnaam||R.naam}</span>`),R.omschrijving&&(L+=`<br/><span class="text-xs text-gray-600">${R.omschrijving}</span>`),L}}catch(A){console.warn("Archeo Landschappen WMS query failed:",A)}continue}if(T==="FAMKE Steentijd"){try{const A=Nc(d),P=Kc("EPSG:4326","EPSG:28992",A),M=100,N=`https://geoportaal.fryslan.nl/arcgis/services/Themas/cultuurhistorie/MapServer/WMSServer?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=FAMKE_Advies_steentijd-bronstijd3339&QUERY_LAYERS=FAMKE_Advies_steentijd-bronstijd3339&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${P[0]-M},${P[1]-M},${P[0]+M},${P[1]+M}`}`,b=await(await fetch(N)).json();if(b.features&&b.features.length>0){const R=b.features[0].properties;let L='<strong class="text-amber-800">FAMKE Steentijd-Bronstijd</strong>';return(R.advies||R.Advies)&&(L+=`<br/><span class="text-sm text-amber-700">${R.advies||R.Advies}</span>`),L}}catch(A){console.warn("FAMKE WMS query failed:",A)}continue}if(T==="IKAW"){try{const A=Nc(d),P=Kc("EPSG:4326","EPSG:28992",A),M=500,N=`https://services.rce.geovoorziening.nl/ikaw/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=IKAW3Indicatievekaartarcheologischewaarden2008&QUERY_LAYERS=IKAW3Indicatievekaartarcheologischewaarden2008&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${P[0]-M},${P[1]-M},${P[0]+M},${P[1]+M}`}`,b=await(await fetch(N)).json();if(b.features&&b.features.length>0){const R=b.features[0].properties,L=Math.round(R.PALETTE_INDEX||R.palette_index||0),V=ine[L]||`Trefkans onbekend (${L})`;let F='<strong class="text-orange-800">IKAW (2008)</strong>';return F+=`<br/><span class="text-sm text-orange-700">${V}</span>`,F}}catch(A){console.warn("IKAW WMS query failed:",A)}continue}const w=y.getFeatureInfoUrl(d,g,"EPSG:3857",{INFO_FORMAT:"application/json"});if(w)try{const P=await(await fetch(w)).json();if(P.features&&P.features.length>0){const M=P.features[0].properties;let k=`<strong>${T}</strong>`;if((M.first_soilname||M.soilname)&&(k+=`<br/><span class="text-sm text-amber-700">${M.first_soilname||M.soilname}</span>`),(M.soilcode||M.first_soilcode)&&(k+=`<br/><span class="text-xs text-gray-500">Code: ${M.soilcode||M.first_soilcode}</span>`),M.soilslope&&M.soilslope!=="Niet opgenomen"&&(k+=`<br/><span class="text-xs text-gray-500">Helling: ${M.soilslope}</span>`),M.geomorphological_area_name&&(k+=`<br/><span class="text-sm text-green-700">${M.geomorphological_area_name}</span>`),M.relief&&(k+=`<br/><span class="text-xs text-gray-500">Relief: ${M.relief}</span>`),!M.first_soilname&&!M.soilname&&!M.geomorphological_area_name){const N=["geometry","id","fid","gml_id"];for(const[B,b]of Object.entries(M))!N.includes(B)&&b&&b!=="Niet opgenomen"&&(k+=`<br/><span class="text-xs text-gray-600">${B}: ${b}</span>`)}return k}}catch(A){console.warn("WMS GetFeatureInfo failed:",A)}}return null},h=async d=>{const g=n.forEachFeatureAtPixel(d.pixel,m=>m);if(g){const m=g.getProperties(),{geometry:v,...y}=m;if(y.WAARDE&&(y.WAARDE.includes("archeologische waarde")||y.WAARDE.includes("Terrein"))){const P=await a(d.coordinate);if(P){t(P),r(!0);return}}const T=y.name||y.naam||y.title||y.NAAM||y.NAME||y.label||y.route_name||y.road_name||"Info";let w=`<strong>${T}</strong>`;if(y.WAARDE&&(w+=`<br/><span class="text-sm text-gray-700">${y.WAARDE}</span>`),y.category&&(w+=`<br/><span class="text-sm text-gray-600">Categorie: ${y.category}</span>`),y.from_to&&y.from_to!==T&&(w+=`<br/><span class="text-sm text-gray-600">${y.from_to}</span>`),y.route&&y.route!==T&&(w+=`<br/><span class="text-sm text-gray-600">${y.route}</span>`),y.TOPONIEM&&(w+=`<br/><span class="text-sm font-semibold text-gray-800">${y.TOPONIEM}</span>`,y.PLAATS&&(w+=`<br/><span class="text-xs text-gray-500">${y.PLAATS}</span>`)),(y.AARD_VINDP||y.Aard_vindp)&&(w+=`<br/><span class="text-sm text-gray-700">Aard: ${y.AARD_VINDP||y.Aard_vindp}</span>`),y.BEGIN_PER&&y.EIND_PER&&(w+=`<br/><span class="text-sm text-purple-700">Periode: ${y.BEGIN_PER} - ${y.EIND_PER}</span>`),(y.AARD_OPM||y.Aard_opmer)&&(w+=`<br/><span class="text-xs text-gray-600 italic">${y.AARD_OPM||y.Aard_opmer}</span>`),y.Gemeente&&(w+=`<br/><span class="text-sm text-gray-600">Gemeente: ${y.Gemeente}</span>`),y.Bron&&(w+=`<br/><span class="text-xs text-gray-500">Bron: ${y.Bron}</span>`),y.Bron_besch&&(w+=`<br/><span class="text-xs text-gray-500">${y.Bron_besch}</span>`),y.Dat_st_z&&y.Dat_ei_z&&(w+=`<br/><span class="text-sm text-purple-700">Datering: ${y.Dat_st_z} - ${y.Dat_ei_z}</span>`),y.Begin&&y.Einde&&(w+=`<br/><span class="text-sm text-purple-700">Periode: ${y.Begin} - ${y.Einde}</span>`),y.Uiterwaard&&(w+=`<br/><span class="text-sm font-semibold">${y.Uiterwaard}</span>`),y.rivier&&(w+=`<br/><span class="text-sm text-blue-600">Rivier: ${y.rivier}</span>`),y.Beschrijvi&&(w+=`<br/><span class="text-sm text-gray-700">${y.Beschrijvi}</span>`),y.leisure){const P=y.leisure==="playground"?"Speeltuin":"Park";w+=`<br/><span class="text-xs text-gray-500">${P}</span>`}if((y.tourism==="museum"||y.museum)&&(w+='<br/><span class="text-xs text-purple-600">Museum</span>'),(y.leisure==="swimming_area"||y.sport==="swimming")&&(w+='<br/><span class="text-xs text-cyan-600">Zwemplek</span>'),y.osm_id&&y.address!==void 0&&(w+='<br/><span class="text-xs text-lime-600">Kringloopwinkel</span>',y.address&&(w+=`<br/><span class="text-xs text-gray-500">${y.address}</span>`),y.phone&&(w+=`<br/><span class="text-xs text-gray-600">${y.phone}</span>`)),(y.historic==="castle"||y.castle_type)&&(w+='<br/><span class="text-xs text-purple-600">Kasteel</span>',y.castle_type&&(w+=`<br/><span class="text-xs text-gray-500">Type: ${y.castle_type}</span>`),y.start_date&&(w+=`<br/><span class="text-xs text-gray-500">Bouwjaar: ${y.start_date}</span>`),y.heritage&&(w+='<br/><span class="text-xs text-amber-600">Rijksmonument</span>')),y.bron==="Paleobiology Database"&&(y.taxonomie&&y.taxonomie!=="Onbekend"&&(w+=`<br/><span class="text-xs text-amber-700">${y.taxonomie}</span>`),y.periode&&y.periode!=="Onbekend"&&(w+=`<br/><span class="text-sm text-purple-700">${y.periode}</span>`),y.ouderdom&&y.ouderdom!=="Onbekend"&&(w+=`<br/><span class="text-xs text-gray-600">Ouderdom: ${y.ouderdom}</span>`),y.aantal_fossielen&&(w+=`<br/><span class="text-xs text-green-700">Aantal fossielen: ${y.aantal_fossielen}</span>`),y.formatie&&(w+=`<br/><span class="text-xs text-gray-500">Formatie: ${y.formatie}</span>`),y.lid&&(w+=`<br/><span class="text-xs text-gray-500">Lid: ${y.lid}</span>`),y.gesteente&&(w+=`<br/><span class="text-xs text-gray-500">Gesteente: ${y.gesteente}</span>`),y.milieu&&(w+=`<br/><span class="text-xs text-blue-600">Milieu: ${y.milieu}</span>`),y.vindplaats&&(w+=`<br/><span class="text-xs text-gray-500 italic">${y.vindplaats}</span>`)),(y.inventarisnummer||y.locatie_naam)&&(y.locatie_naam&&(w+=`<br/><span class="text-sm font-semibold">${y.locatie_naam}</span>`),y.inventarisnummer&&(w+=`<br/><span class="text-xs text-gray-500">CAI: ${y.inventarisnummer}</span>`),y.datering_tekst&&(w+=`<br/><span class="text-sm text-purple-700">${y.datering_tekst}</span>`)),(y.veensoort||y.dikte)&&(y.veensoort&&(w+=`<br/><span class="text-sm text-amber-700">${y.veensoort}</span>`),y.dikte&&(w+=`<br/><span class="text-xs text-gray-600">Dikte: ${y.dikte}</span>`)),(y.type_site||y.dating)&&(y.type_site&&(w+=`<br/><span class="text-sm text-red-700">${y.type_site}</span>`),y.dating&&(w+=`<br/><span class="text-xs text-purple-600">${y.dating}</span>`),y.culture&&(w+=`<br/><span class="text-xs text-gray-500">${y.culture}</span>`)),y.nature&&y.debut){w+=`<br/><span class="text-sm text-purple-700">${y.nature}</span>`;const P=y.debut===y.fin?y.debut:`${y.debut} - ${y.fin}`;P&&(w+=`<br/><span class="text-sm text-gray-700">Periode: ${P}</span>`),y.structure&&(w+=`<br/><span class="text-xs text-gray-600">${y.structure}</span>`),y.commune&&(w+=`<br/><span class="text-xs text-gray-500">${y.commune}</span>`),y.decouvert&&(w+=`<br/><span class="text-xs text-gray-400">Ontdekt: ${y.decouvert}</span>`),y.numero&&(w+=`<br/><span class="text-xs text-gray-400">${y.numero}</span>`)}if((y.NATURE_OPE||y.CODE_OPERA)&&(y.TITRE&&(w+=`<br/><span class="text-sm font-semibold">${y.TITRE}</span>`),y.NATURE_OPE&&(w+=`<br/><span class="text-sm text-amber-700">${y.NATURE_OPE}</span>`),y.AUTEUR&&(w+=`<br/><span class="text-xs text-gray-600">Auteur: ${y.AUTEUR}</span>`),y.DATE&&(w+=`<br/><span class="text-xs text-gray-500">Datum: ${y.DATE}</span>`),y.COMMUNE&&(w+=`<br/><span class="text-xs text-gray-500">${y.COMMUNE}</span>`)),y.type_protection&&(y.n_site||y.t_site)){const P=y.type_protection==="Classe"?"text-red-700":"text-amber-700";w+=`<br/><span class="text-sm ${P}">${y.type_protection}</span>`,y.n_site&&(w+=`<br/><span class="text-sm font-semibold">${y.n_site}</span>`),y.t_site&&(w+=`<br/><span class="text-xs text-gray-600">${y.t_site}</span>`),y.c_site&&(w+=`<br/><span class="text-xs text-gray-500">Code: ${y.c_site}</span>`),y.d_creation&&(w+=`<br/><span class="text-xs text-gray-400">Beschermd sinds: ${y.d_creation}</span>`)}if(y.type_protection&&y.cod_diren){const P=y.type_protection==="Classe"?"text-red-700":"text-amber-700";if(w+=`<br/><span class="text-sm ${P}">${y.type_protection}</span>`,y.proced&&(w+=`<br/><span class="text-xs text-gray-600">${y.proced}</span>`),y.d_proced&&(w+=`<br/><span class="text-xs text-gray-500">Date: ${y.d_proced}</span>`),y.comment){const M=String(y.comment).slice(0,150);w+=`<br/><span class="text-xs text-gray-600 italic">${M}${String(y.comment).length>150?"...":""}</span>`}}if(y.type_protection&&y.nomsite){const P=y.type_protection==="Classe"?"text-red-700":"text-amber-700";if(w+=`<br/><span class="text-sm ${P}">${y.type_protection}</span>`,y.caractere&&(w+=`<br/><span class="text-xs text-gray-600">${y.caractere}</span>`),y.datedecis&&(w+=`<br/><span class="text-xs text-gray-500">Date: ${y.datedecis}</span>`),y.descriptio){const M=String(y.descriptio).slice(0,150);w+=`<br/><span class="text-xs text-gray-600 italic">${M}${String(y.descriptio).length>150?"...":""}</span>`}}if(y.secteur&&y.style){if(w+=`<br/><span class="text-sm text-gray-700">${y.secteur}</span>`,y["sous-secteur"]&&(w+=`<br/><span class="text-xs text-gray-600">${y["sous-secteur"]}</span>`),y.description){const P=String(y.description).slice(0,150);w+=`<br/><span class="text-xs text-gray-600 italic">${P}${String(y.description).length>150?"...":""}</span>`}y.url&&(w+=`<br/><a href="${y.url}" target="_blank" class="text-xs text-blue-600 hover:underline">Meer info</a>`)}if(y.nature_operation||y.synthese){y.nature_operation&&(w+=`<br/><span class="text-sm text-red-700">${y.nature_operation}</span>`),y.responsable_operation&&(w+=`<br/><span class="text-xs text-gray-600">Responsable: ${y.responsable_operation}</span>`),y.date_operation&&(w+=`<br/><span class="text-xs text-gray-500">Datum: ${y.date_operation}</span>`);const P=[];if(y.prehistoire==="Oui"&&P.push("Prehistorie"),y.protohistoire==="Oui"&&P.push("Protohistorie"),y.antiquite==="Oui"&&P.push("Romeins"),y.moyen_age==="Oui"&&P.push("Middeleeuwen"),y.temps_modernes==="Oui"&&P.push("Moderne tijd"),P.length>0&&(w+=`<br/><span class="text-sm text-purple-700">${P.join(", ")}</span>`),y.adresse&&(w+=`<br/><span class="text-xs text-gray-500">${y.adresse}</span>`),y.synthese){const M=String(y.synthese).slice(0,200);w+=`<br/><span class="text-xs text-gray-600 italic">${M}${String(y.synthese).length>200?"...":""}</span>`}}if(y.operator&&(w+=`<br/><span class="text-sm text-gray-600">${y.operator}</span>`),y.opening_hours&&(w+=`<br/><span class="text-xs text-green-600">Open: ${y.opening_hours}</span>`),y.website&&(w+=`<br/><a href="${y.website}" target="_blank" class="text-xs text-blue-600 underline">Website</a>`),y.addr_street){const P=[y.addr_street,y.addr_housenumber,y.addr_postcode].filter(Boolean).join(" ");w+=`<br/><span class="text-xs text-gray-500">${P}</span>`}const A=y.description||y.omschrijving||y.descr||y.info;A&&A!==T&&(w+=`<br/><span class="text-sm text-gray-600">${A}</span>`),t(w),r(!0)}else{const m=n.getView().getResolution()||1,v=await u(d.coordinate,m);v&&(t(v),r(!0))}};return n.on("click",h),()=>{n.un("click",h)}},[n]);const s=()=>{r(!1)},o=(a,u)=>{u.offset.y>100&&r(!1)};return G.jsx(Ru,{children:i&&G.jsxs(G.Fragment,{children:[G.jsx(Ji.div,{className:"fixed inset-0 z-[1500]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:s}),G.jsxs(Ji.div,{className:"fixed bottom-0 left-0 right-0 z-[1501] bg-white rounded-t-2xl shadow-2xl",initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",damping:25,stiffness:300},drag:"y",dragConstraints:{top:0},dragElastic:.2,onDragEnd:o,children:[G.jsx("div",{className:"flex justify-center pt-3 pb-2",children:G.jsx("div",{className:"w-10 h-1 bg-gray-300 rounded-full"})}),G.jsx("button",{onClick:s,className:"absolute top-3 right-3 w-8 h-8 flex items-center justify-center text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-full transition-colors","aria-label":"Sluiten",children:G.jsx($g,{size:20})}),G.jsx("div",{className:"px-4 pb-6 max-h-[50vh] overflow-y-auto",dangerouslySetInnerHTML:{__html:e}})]})]})})}function sne(){const n=Hi(w=>w.map),e=Ut(w=>w.position),t=tn(w=>w.startNavigation),i=tn(w=>w.isNavigating),[r,s]=ne.useState(null),[o,a]=ne.useState(!1),[u,h]=ne.useState(!1),d=ne.useRef(null),g=ne.useRef(null);ne.useEffect(()=>{if(!n){console.log(" LongPressMenu: map not ready");return}const w=n.getViewport();if(!w){console.log(" LongPressMenu: viewport not ready");return}console.log(" LongPressMenu: attached to viewport",w);const A=600,P=15,M=V=>{if(console.log(" Touch start, touches:",V.touches.length),V.touches.length!==1)return;const F=V.touches[0];g.current={x:F.clientX,y:F.clientY},console.log(" Starting long press timer at:",g.current),d.current&&clearTimeout(d.current),d.current=window.setTimeout(()=>{if(console.log(" Timer fired! startPos:",g.current),!g.current)return;const U=window.__olMap;if(!U){console.log(" Map not available (global)");return}const D=w.getBoundingClientRect(),le=[g.current.x-D.left,g.current.y-D.top],we=U.getCoordinateFromPixel(le);if(we){const ye=Nc(we);V.preventDefault(),s({pixel:[g.current.x,g.current.y],coordinate:ye}),a(!0),h(!1),setTimeout(()=>h(!0),300),"vibrate"in navigator&&navigator.vibrate(50),console.log(" Long press detected at:",ye)}},A)},k=V=>{if(!d.current||!g.current)return;const F=V.touches[0],U=F.clientX-g.current.x,D=F.clientY-g.current.y,le=Math.sqrt(U*U+D*D);le>P&&(console.log(" Touch moved too much, cancelling. Distance:",le),clearTimeout(d.current),d.current=null)},N=()=>{console.log(" Touch end, timer active:",!!d.current),d.current&&(console.log(" Cancelling timer on touch end"),clearTimeout(d.current),d.current=null),g.current=null},B=V=>{o&&V.preventDefault()},b=V=>{V.button===0&&(console.log(" Mouse down"),g.current={x:V.clientX,y:V.clientY},d.current&&clearTimeout(d.current),d.current=window.setTimeout(()=>{if(console.log(" Mouse timer fired!"),!g.current)return;const F=window.__olMap;if(console.log(" __olMap:",F),console.log(" __olMap constructor:",F?.constructor?.name),console.log(" has getCoordinateAtPixel:",typeof F?.getCoordinateAtPixel),!F){console.log(" Map not available (global)");return}const U=w.getBoundingClientRect(),D=[g.current.x-U.left,g.current.y-U.top];console.log(" Pixel:",D);const le=F.getCoordinateFromPixel(D);if(console.log(" Coordinate:",le),le){const we=Nc(le);s({pixel:[g.current.x,g.current.y],coordinate:we}),a(!0),h(!1),setTimeout(()=>h(!0),300),console.log(" Long press (mouse) detected at:",we)}},A))},R=V=>{if(!d.current||!g.current)return;const F=V.clientX-g.current.x,U=V.clientY-g.current.y;Math.sqrt(F*F+U*U)>P&&(console.log(" Mouse moved, cancelling"),clearTimeout(d.current),d.current=null)},L=()=>{console.log(" Mouse up"),d.current&&(clearTimeout(d.current),d.current=null),g.current=null};return w.addEventListener("touchstart",M,{passive:!1}),w.addEventListener("touchmove",k,{passive:!0}),w.addEventListener("touchend",N),w.addEventListener("touchcancel",N),w.addEventListener("contextmenu",B),w.addEventListener("mousedown",b),w.addEventListener("mousemove",R),w.addEventListener("mouseup",L),w.addEventListener("mouseleave",L),()=>{w.removeEventListener("touchstart",M),w.removeEventListener("touchmove",k),w.removeEventListener("touchend",N),w.removeEventListener("touchcancel",N),w.removeEventListener("contextmenu",B),w.removeEventListener("mousedown",b),w.removeEventListener("mousemove",R),w.removeEventListener("mouseup",L),w.removeEventListener("mouseleave",L),d.current&&clearTimeout(d.current)}},[n,o]);const m=()=>{u&&(a(!1),s(null),h(!1))},v=async()=>{if(!r||!e)return;const[w,A]=r.coordinate,P=`${A.toFixed(4)}, ${w.toFixed(4)}`;await t({lng:w,lat:A},P,{lng:e.lng,lat:e.lat}),a(!1),s(null),h(!1)},y=()=>{a(!1),s(null),h(!1)},T=w=>{const[A,P]=w;return`${P.toFixed(5)}N, ${A.toFixed(5)}E`};return G.jsx(Ru,{children:o&&r&&G.jsxs(G.Fragment,{children:[G.jsx(Ji.div,{className:"fixed inset-0 z-[1600]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:m}),G.jsxs(Ji.div,{className:"fixed z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden min-w-[200px]",style:{left:Math.min(r.pixel[0],window.innerWidth-220),top:Math.min(r.pixel[1],window.innerHeight-180)},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.15},children:[G.jsx("div",{className:"px-4 py-3 bg-gray-50 border-b border-gray-100",children:G.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[G.jsx(fO,{size:16}),G.jsx("span",{className:"text-xs font-mono",children:T(r.coordinate)})]})}),G.jsxs("div",{className:"py-1",children:[G.jsxs("button",{onClick:v,disabled:!e||i,className:`w-full px-4 py-3 flex items-center gap-3 transition-colors ${e&&!i?"hover:bg-blue-50 text-gray-700":"text-gray-400 cursor-not-allowed"}`,children:[G.jsx(lT,{size:20,className:e&&!i?"text-blue-500":"text-gray-300"}),G.jsx("span",{className:"font-medium",children:"Navigeer hierheen"})]}),!e&&G.jsx("div",{className:"px-4 py-2 text-xs text-amber-600 bg-amber-50",children:"GPS positie niet beschikbaar"}),i&&G.jsx("div",{className:"px-4 py-2 text-xs text-blue-600 bg-blue-50",children:"Navigatie al actief"})]}),G.jsx("div",{className:"border-t border-gray-100",children:G.jsxs("button",{onClick:y,className:"w-full px-4 py-3 flex items-center justify-center gap-2 text-gray-500 hover:bg-gray-50 transition-colors",children:[G.jsx($g,{size:18}),G.jsx("span",{children:"Annuleren"})]})})]})]})})}function one(){return G.jsx("div",{className:"fixed bottom-2.5 left-2.5 z-[800] px-2 py-1 bg-white/90 rounded shadow-sm text-xs font-mono text-gray-600",children:"bvd v1.0.0"})}const ane=["AMK Monumenten","Romeinse wegen","Castella (punten)","Castella (lijnen)","Toestemmingen"],lne=["Parken","Speeltuinen","Strandjes"],une=["Musea","Kringloopwinkels"],cne=["AHN 0.5m","Geomorfologie","AHN4 Multi-Hillshade NL"],UM=["Hunebedden","EUROEVOL Sites","FAMKE Steentijd","Archeo Landschappen","IKAW","AMK Monumenten","Archis-punten","CAI Vlaanderen","Romeinse wegen","Castella (punten)","Castella (lijnen)","Oppida","Kastelen","Toestemmingen","Archeo Zones Vlaanderen","Beschermde Sites Vlaanderen","Monumenten BE","Archeo Zones BE","Arch Sites BE","Erfgoed Landschap BE","CAI Elementen","Hist. Gebouwen FR","INRAP Sites FR","Archeo Sites Bretagne","Operaties Bretagne","Archeo Parijs","Sites Patrimoine Occitanie","Sites Patrimoine PACA","Maginotlinie","Sites Patrimoine Normandie","Vici.org Romeins","Archeo Punten","Vlakken","Expert","Bufferlaag","Indeling","Veengebieden","AHN 0.5m","Geomorfologie","Bodemkaart","AHN4 Hillshade NL","AHN4 Multi-Hillshade NL","AHN4 Helling NL","World Hillshade","Hillshade Vlaanderen 25cm","Skyview Vlaanderen 25cm","DTM Vlaanderen 1m","Hillshade Walloni","Hillshade NRW 25cm","Hillshade NRW Kleur","Hillshade Frankrijk","LiDAR HD Frankrijk","RGE Alti Frankrijk 1m","Hoogtelijn Frankrijk","Fossielen Nederland","Fossielen Belgi","Fossielen Duitsland","Fossielen Frankrijk","Parken","Speeltuinen","Musea","Strandjes","Kringloopwinkels"],hne=["CartoDB Positron","OpenStreetMap","Satellite","TMK 1850","Bonnebladen 1900","Carte Cassini"];function dne(){const[n,e]=ne.useState(!1),t=lo(o=>o.setLayerVisibility),i=Ut(o=>o.stopTracking),r=()=>{UM.forEach(o=>t(o,!1)),hne.forEach(o=>{t(o,o==="CartoDB Positron")}),i(),console.log(" Reset: CartoDB Positron, alle lagen uit, GPS uit")},s=o=>{UM.forEach(a=>t(a,!1)),o.forEach(a=>t(a,!0)),e(!1)};return G.jsxs("div",{className:"fixed bottom-12 left-2.5 z-[800]",children:[G.jsxs("div",{className:"flex gap-1",children:[G.jsx("button",{onClick:()=>e(!n),className:"w-8 h-8 flex items-center justify-center bg-white/90 hover:bg-blue-50 rounded shadow-sm border-0 outline-none transition-colors",title:"Presets",children:n?G.jsx(hO,{size:16,className:"text-blue-600"}):G.jsx(dO,{size:16,className:"text-blue-600"})}),G.jsx("button",{onClick:r,className:"w-8 h-8 flex items-center justify-center bg-white/90 hover:bg-gray-100 rounded shadow-sm border-0 outline-none transition-colors",title:"Reset - CartoDB, alle lagen uit, GPS uit",children:G.jsx(Aw,{size:16,className:"text-gray-600"})})]}),G.jsx(Ru,{children:n&&G.jsxs(Ji.div,{initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.95},transition:{duration:.15},className:"absolute bottom-10 left-0 bg-white/95 rounded-lg shadow-lg p-1.5 min-w-[140px]",children:[G.jsxs("button",{onClick:()=>s(ane),className:"w-full flex items-center gap-2 px-2 py-1.5 hover:bg-purple-50 rounded text-left transition-colors border-0 outline-none bg-transparent",children:[G.jsx(pY,{size:14,className:"text-purple-600"}),G.jsx("span",{className:"text-xs text-gray-700",children:"Detectie"})]}),G.jsxs("button",{onClick:()=>s(lne),className:"w-full flex items-center gap-2 px-2 py-1.5 hover:bg-green-50 rounded text-left transition-colors border-0 outline-none bg-transparent",children:[G.jsx(BY,{size:14,className:"text-green-600"}),G.jsx("span",{className:"text-xs text-gray-700",children:"Recreatie"})]}),G.jsxs("button",{onClick:()=>s(une),className:"w-full flex items-center gap-2 px-2 py-1.5 hover:bg-amber-50 rounded text-left transition-colors border-0 outline-none bg-transparent",children:[G.jsx(FY,{size:14,className:"text-amber-600"}),G.jsx("span",{className:"text-xs text-gray-700",children:"Uitjes"})]}),G.jsxs("button",{onClick:()=>s(cne),className:"w-full flex items-center gap-2 px-2 py-1.5 hover:bg-stone-50 rounded text-left transition-colors border-0 outline-none bg-transparent",children:[G.jsx(LY,{size:14,className:"text-stone-600"}),G.jsx("span",{className:"text-xs text-gray-700",children:"Hillshade"})]})]})})]})}const fne=[{name:"AHN4 Hillshade NL",color:"blue",default:.7},{name:"AHN4 Multi-Hillshade NL",color:"blue",default:.7},{name:"AHN4 Helling NL",color:"blue",default:.6},{name:"AHN 0.5m",color:"blue",default:.7},{name:"World Hillshade",color:"blue",default:.7},{name:"Hillshade Vlaanderen 25cm",color:"amber",default:.7},{name:"Skyview Vlaanderen 25cm",color:"amber",default:.7},{name:"DTM Vlaanderen 1m",color:"amber",default:.6},{name:"Hillshade Walloni",color:"amber",default:.7},{name:"Hillshade NRW 25cm",color:"red",default:.7},{name:"Hillshade NRW Kleur",color:"red",default:.7},{name:"Hillshade Frankrijk",color:"indigo",default:.7},{name:"LiDAR HD Frankrijk",color:"indigo",default:.7},{name:"RGE Alti Frankrijk 1m",color:"indigo",default:.6},{name:"Hoogtelijn Frankrijk",color:"indigo",default:.8},{name:"Geomorfologie",color:"green",default:.5},{name:"Bodemkaart",color:"amber",default:.6},{name:"IKAW",color:"orange",default:.5},{name:"Archeo Landschappen",color:"green",default:.5},{name:"AMK Monumenten",color:"purple",default:.8},{name:"Monumenten BE",color:"purple",default:.8},{name:"Archeo Zones BE",color:"purple",default:.6},{name:"Arch Sites BE",color:"purple",default:.7},{name:"Erfgoed Landschap BE",color:"purple",default:.5}],gne={blue:"accent-blue-500",amber:"accent-amber-500",red:"accent-red-500",indigo:"accent-indigo-500",green:"accent-green-500",orange:"accent-orange-500",purple:"accent-purple-500"};function mne(){const[n,e]=ne.useState(!1),[t,i]=ne.useState(!1),r=lo(d=>d.visible),s=lo(d=>d.opacity),o=lo(d=>d.setLayerOpacity),a=fne.filter(d=>r[d.name]);if(a.length===0)return null;const u=t?a:a.slice(0,3),h=a.length>3;return G.jsxs("div",{className:"fixed bottom-[195px] md:bottom-[220px] right-2.5 z-[900]",children:[G.jsxs(Ji.button,{onClick:()=>e(!n),className:"w-11 h-11 bg-white/80 rounded-xl backdrop-blur-sm shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none hover:bg-white/90 transition-colors",whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":"Opacity sliders",title:n?"Sluit opacity sliders":"Open opacity sliders",children:[G.jsx(jY,{size:22,strokeWidth:2,className:"text-gray-500"}),a.length>0&&G.jsx("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-blue-500 text-white text-[10px] rounded-full flex items-center justify-center",children:a.length})]}),G.jsx(Ru,{children:n&&G.jsxs(Ji.div,{initial:{opacity:0,x:20,scale:.9},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:20,scale:.9},transition:{duration:.2},className:"absolute bottom-0 right-14 bg-white/95 rounded-lg shadow-lg p-3 min-w-[220px] max-h-[60vh] overflow-y-auto",children:[G.jsx("div",{className:"text-xs font-semibold text-gray-500 mb-2 uppercase tracking-wide",children:"Transparantie"}),G.jsx("div",{className:"space-y-3",children:u.map(d=>{const g=s[d.name]??d.default;return G.jsxs("div",{children:[G.jsx("label",{className:"text-xs font-medium text-gray-700 mb-1 block truncate",title:d.name,children:d.name}),G.jsxs("div",{className:"flex items-center gap-2",children:[G.jsx("input",{type:"range",min:"0",max:"100",value:g*100,onChange:m=>o(d.name,parseInt(m.target.value)/100),className:`flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer ${gne[d.color]}`}),G.jsxs("span",{className:"text-xs text-gray-500 w-8 text-right",children:[Math.round(g*100),"%"]})]})]},d.name)})}),h&&G.jsx("button",{onClick:()=>i(!t),className:"w-full mt-3 pt-2 border-t border-gray-200 flex items-center justify-center gap-1 text-xs text-gray-500 hover:text-gray-700",children:t?G.jsxs(G.Fragment,{children:[G.jsx(hO,{size:14}),"Minder tonen"]}):G.jsxs(G.Fragment,{children:[G.jsx(aY,{size:14}),a.length-3," meer..."]})})]})})]})}function pne(){const n=Hi(M=>M.map),e=Ut(M=>M.position),t=tn(M=>M.startNavigation);tn(M=>M.isNavigating);const i=tn(M=>M.loading),[r,s]=ne.useState(""),[o,a]=ne.useState([]),[u,h]=ne.useState(!1),[d,g]=ne.useState(!1),m=ne.useRef(null),v=ne.useRef();ne.useEffect(()=>{if(v.current&&clearTimeout(v.current),r.length<2){a([]);return}return v.current=window.setTimeout(async()=>{g(!0);try{const k=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/suggest?q=${encodeURIComponent(r)}&rows=7`)).json();k.response?.docs&&a(k.response.docs)}catch(M){console.error("Search error:",M),a([])}finally{g(!1)}},300),()=>{v.current&&clearTimeout(v.current)}},[r]);const y=async M=>{try{const N=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/lookup?id=${encodeURIComponent(M)}`)).json();if(N.response?.docs?.[0]?.centroide_ll){const b=N.response.docs[0].centroide_ll.match(/POINT\(([^ ]+) ([^)]+)\)/);if(b)return{lng:parseFloat(b[1]),lat:parseFloat(b[2])}}}catch(k){console.error("Lookup error:",k)}return null},T=async M=>{if(!n)return;const k=await y(M.id);k&&n.getView().animate({center:Aa([k.lng,k.lat]),zoom:16,duration:1e3}),s(""),a([]),h(!1)},w=async(M,k)=>{if(k.stopPropagation(),!e){alert("GPS positie niet beschikbaar. Zet GPS aan.");return}const N=await y(M.id);N&&await t(N,M.weergavenaam,{lng:e.lng,lat:e.lat}),s(""),a([]),h(!1)},A=()=>{s(""),a([]),m.current?.focus()},P=M=>{switch(M){case"adres":return"";case"weg":return"";case"woonplaats":return"";case"gemeente":return"";case"provincie":return"";case"postcode":return"";default:return""}};return G.jsxs("div",{className:"search-box",children:[G.jsxs("div",{className:"search-input-wrapper",children:[G.jsx(OY,{size:18,className:"search-icon"}),G.jsx("input",{ref:m,type:"text",value:r,onChange:M=>{s(M.target.value),h(!0)},onFocus:()=>h(!0),placeholder:"Zoek adres of plaats...",className:"search-input"}),r&&G.jsx("button",{onClick:A,className:"search-clear",children:G.jsx($g,{size:16})})]}),u&&o.length>0&&G.jsx("ul",{className:"search-results",children:o.map(M=>G.jsxs("li",{className:"search-result-item",children:[G.jsxs("div",{className:"search-result-content",onClick:()=>T(M),children:[G.jsx("span",{className:"search-result-icon",children:P(M.type)}),G.jsx("span",{className:"search-result-text",children:M.weergavenaam})]}),G.jsx("button",{className:"search-navigate-btn",onClick:k=>w(M,k),disabled:i||!e,title:e?"Navigeer hierheen":"GPS niet actief",children:G.jsx(lT,{size:16})})]},M.id))}),u&&d&&G.jsx("div",{className:"search-loading",children:"Zoeken..."})]})}function _ne(){const n=Hi(s=>s.map),e=tn(s=>s.routeCoordinates),t=tn(s=>s.destination),i=tn(s=>s.isNavigating),r=ne.useRef(null);return ne.useEffect(()=>{if(!n)return;const s=new jb;return r.current=new r4({source:s,zIndex:500}),n.addLayer(r.current),()=>{r.current&&n&&n.removeLayer(r.current)}},[n]),ne.useEffect(()=>{if(!r.current)return;const s=r.current.getSource();if(!s||(s.clear(),!i||!e||e.length===0))return;const o=e.map(u=>Aa([u.lng,u.lat])),a=new af({geometry:new h_(o)});if(a.setStyle([new Mi({stroke:new Kr({color:"white",width:8,lineCap:"round",lineJoin:"round"})}),new Mi({stroke:new Kr({color:"#4285F4",width:5,lineCap:"round",lineJoin:"round"})})]),s.addFeature(a),t){const u=new af({geometry:new d_(Aa([t.lng,t.lat]))});u.setStyle(new Mi({image:new iu({radius:12,fill:new Wr({color:"#EA4335"}),stroke:new Kr({color:"white",width:3})})})),s.addFeature(u)}if(n){const u=s.getExtent();n.getView().fit(u,{padding:[80,80,80,80],duration:500})}},[n,i,e,t]),null}function yne(n){const e={size:24,className:"text-white"};return n.includes("left")?n.includes("sharp")?G.jsx(yY,{...e}):n.includes("slight")?G.jsx(JX,{...e}):G.jsx(XX,{...e}):n.includes("right")?n.includes("sharp")?G.jsx(EY,{...e}):n.includes("slight")?G.jsx(tY,{...e}):G.jsx(ZX,{...e}):n.includes("uturn")?G.jsx(Aw,{...e}):n.includes("arrive")?G.jsx(gY,{...e}):n.includes("roundabout")||n.includes("rotary")?G.jsx(Aw,{...e}):G.jsx(iY,{...e})}function vne(){const n=tn(m=>m.isNavigating),e=tn(m=>m.destinationName),t=tn(m=>m.distance),i=tn(m=>m.duration),r=tn(m=>m.steps),s=tn(m=>m.currentStepIndex),o=tn(m=>m.voiceEnabled),a=tn(m=>m.setVoiceEnabled),u=tn(m=>m.stopNavigation),h=r[s],d=m=>m?m<1e3?`${Math.round(m)} m`:`${(m/1e3).toFixed(1)} km`:"--",g=m=>{if(!m)return"--";if(m<60)return`${Math.round(m)} sec`;const v=Math.round(m/60);if(v<60)return`${v} min`;const y=Math.floor(v/60),T=v%60;return`${y}u ${T}m`};return G.jsx(Ru,{children:n&&G.jsxs(Ji.div,{className:"fixed top-16 left-2 right-2 z-[1100] bg-white rounded-xl shadow-lg overflow-hidden",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.2},children:[h&&G.jsxs("div",{className:"bg-blue-600 px-4 py-3 flex items-center gap-3",children:[G.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-700 flex items-center justify-center flex-shrink-0",children:yne(h.maneuver)}),G.jsxs("div",{className:"flex-1 min-w-0",children:[G.jsx("div",{className:"text-white font-bold text-lg truncate",children:h.instruction}),G.jsxs("div",{className:"text-blue-200 text-sm",children:["Over ",d(h.distance)]})]}),G.jsx("button",{onClick:()=>a(!o),className:`w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0 transition-colors ${o?"bg-blue-700 text-white":"bg-blue-800 text-blue-400"}`,title:o?"Geluid uit":"Geluid aan",children:o?G.jsx($Y,{size:20}):G.jsx(KY,{size:20})})]}),G.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 border-t border-gray-100",children:[G.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center flex-shrink-0",children:G.jsx(lT,{size:20,className:"text-gray-600"})}),G.jsxs("div",{className:"flex-1 min-w-0",children:[G.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500",children:[G.jsx(fO,{size:12}),G.jsx("span",{children:"Bestemming"})]}),G.jsx("div",{className:"font-medium text-gray-900 truncate text-sm",children:e||"Bestemming"})]}),G.jsxs("div",{className:"text-right flex-shrink-0",children:[G.jsx("div",{className:"text-lg font-bold text-blue-600",children:d(t)}),G.jsx("div",{className:"text-xs text-gray-500",children:g(i)})]}),G.jsx("button",{onClick:u,className:"w-10 h-10 rounded-full bg-red-500 hover:bg-red-600 flex items-center justify-center flex-shrink-0 transition-colors",title:"Stop navigatie",children:G.jsx($g,{size:20,className:"text-white"})})]}),r.length>1&&G.jsxs("div",{className:"px-4 pb-2",children:[G.jsx("div",{className:"flex gap-1",children:r.map((m,v)=>G.jsx("div",{className:`h-1 flex-1 rounded-full transition-colors ${v<s?"bg-green-500":v===s?"bg-blue-500":"bg-gray-200"}`},v))}),G.jsxs("div",{className:"text-xs text-gray-400 mt-1 text-center",children:["Stap ",s+1," van ",r.length]})]})]})})}function Ene(){const n=Ut(i=>i.tracking),e=Ut(i=>i.headingSource),t=Ut(i=>i.updateHeading);ne.useEffect(()=>{if(!n||e!=="compass")return;let i=0;const r=100,s=u=>{const h=Date.now();h-i<r||(i=h,u.alpha!==null&&t(360-u.alpha,"compass"))},o=u=>{const h=Date.now();h-i<r||(i=h,u.alpha!==null&&t(360-u.alpha,"compass"))},a=u=>{const h=Date.now();h-i<r||(i=h,u.webkitCompassHeading!==void 0&&t(u.webkitCompassHeading,"compass"))};return window.addEventListener("deviceorientationabsolute",o),window.addEventListener("deviceorientation",s),window.addEventListener("deviceorientation",a),()=>{window.removeEventListener("deviceorientationabsolute",o),window.removeEventListener("deviceorientation",s),window.removeEventListener("deviceorientation",a)}},[n,e,t])}const wne=n=>n<.5?2*n*n:-1+(4-2*n)*n;function xne(){const n=Hi(u=>u.map),e=Hi(u=>u.rotationEnabled),t=Hi(u=>u.setRotation),i=Ut(u=>u.smoothHeading),r=Ut(u=>u.tracking),s=Ut(u=>u.navigationMode),o=ne.useRef(null),a=ne.useRef(null);ne.useEffect(()=>{n&&(s==="drive"&&a.current!=="drive"&&(n.getView().animate({zoom:15,duration:500}),console.log(" Rijmodus: zoom naar wijkniveau (15)")),a.current=s)},[n,s]),ne.useEffect(()=>{if(s==="free"){n&&n.getView().getRotation()!==0&&(n.getView().animate({rotation:0,duration:500}),t(0),o.current=null);return}if(!n||!r||!e||i===null){n&&!r&&(n.getView().animate({rotation:0,duration:500}),t(0),o.current=null);return}const u=i*Math.PI/180,h=o.current??n.getView().getRotation();let d=u-h;for(;d>Math.PI;)d-=2*Math.PI;for(;d<-Math.PI;)d+=2*Math.PI;Math.abs(d)<.087||(n.getView().animate({rotation:u,duration:250,easing:wne}),o.current=u,t(i))},[n,r,e,i,t])}function Sne(){const n=Hi(d=>d.map),e=Ut(d=>d.position),t=Ut(d=>d.tracking),i=Ut(d=>d.navigationMode),r=Ut(d=>d.toggleMode),s=tn(d=>d.isNavigating),o=tn(d=>d.updateCurrentStep),a=tn(d=>d.destination),u=ne.useRef(!1),h=ne.useRef(0);return ne.useEffect(()=>{s&&!u.current?(console.log(" Navigation started - activating drive mode"),i==="free"&&r(),u.current=!0):!s&&u.current&&(console.log(" Navigation stopped - deactivating drive mode"),i==="drive"&&r(),u.current=!1)},[s,i,r]),ne.useEffect(()=>{!s||!e||o({lng:e.lng,lat:e.lat})},[s,e,o]),ne.useEffect(()=>{if(!n||!e||!s||!t)return;const d=Date.now();if(d-h.current<500)return;h.current=d;const g=Aa([e.lng,e.lat]);n.getView().animate({center:g,duration:300})},[n,e,s,t]),ne.useEffect(()=>{if(!n||!s)return;(n.getView().getZoom()||15)<14&&n.getView().animate({zoom:15,duration:500})},[n,s,e]),{isNavigating:s,destination:a}}function Tne(){return Ene(),xne(),Sne(),G.jsxs(G.Fragment,{children:[G.jsx(pW,{}),G.jsx(YY,{}),G.jsx(_ne,{}),G.jsx(rne,{}),G.jsx(sne,{}),G.jsx(pne,{}),G.jsx(vne,{}),G.jsx(XY,{}),G.jsx(ZY,{}),G.jsx(QY,{}),G.jsx(mne,{}),G.jsx(one,{}),G.jsx(dne,{})]})}e5.createRoot(document.getElementById("root")).render(G.jsx(Tne,{}));export{fb as $,j2 as A,Ao as B,Hb as C,jA as D,qe as E,E_ as F,jb as G,r4 as H,ze as I,Mi as J,iu as K,L0 as L,Kr as M,Wr as N,Kc as O,rx as P,e6 as Q,Ow as R,Gb as S,Rl as T,p0 as U,Xn as V,u5 as W,qd as X,S0 as Y,g0 as Z,db as _,lF as a,bne as a0,c_ as a1,h_ as a2,yb as a3,lE as a4,s6 as a5,kne as a6,gb as a7,Hc as a8,Ul as a9,rE as aA,jw as aB,$v as aC,Y2 as aD,Ane as aE,Rne as aF,Aa as aG,d_ as aa,KM as ab,qw as ac,Pne as ad,Cne as ae,Lne as af,jne as ag,Gne as ah,eA as ai,q6 as aj,X6 as ak,Fne as al,Nne as am,nu as an,Dne as ao,Mne as ap,Ur as aq,af as ar,at as as,u_ as at,Db as au,fE as av,oh as aw,t6 as ax,$b as ay,T5 as az,In as b,ah as c,st as d,Jn as e,va as f,Hl as g,Ai as h,E0 as i,Ud as j,vo as k,One as l,Jl as m,_E as n,b8 as o,lt as p,L8 as q,C8 as r,Nw as s,Dp as t,Vt as u,Lf as v,op as w,eE as x,An as y,Vne as z};
//# sourceMappingURL=index-sepMzkky.js.map
