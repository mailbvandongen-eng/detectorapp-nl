const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/amkOL-C9OM5KdE.js","assets/layerLoaderOL-A-7AFNcY.js","assets/GeoJSON-DzryzwP6.js","assets/romeinsOL-DBqq32gp.js","assets/kastelenOL-BdI4vfHl.js","assets/iconStyles-BdRV-uQT.js","assets/veengebiedenOL-BXXnblP4.js","assets/hunebeddenOL-DKe2f5ki.js","assets/uikavArcheoPuntenOL-Ac_D6-iP.js","assets/proj4-C9i8Vp0h.js","assets/uikavVlakkenOL--t69HSzV.js","assets/uikavBufferlaagOL-DLfnGDoG.js","assets/uikavExpertOL-CWMnY5Vh.js","assets/uikavUiterwaardenOL-BybQSlZu.js","assets/speeltuinenOL-DSbLvjy-.js","assets/museaOL-CUdkhTWY.js","assets/strandjesOL-sHnAXFdQ.js","assets/parkenOL-B9DPJe4S.js","assets/fossielenOL-C_rVI4jQ.js","assets/fossielUtils-Tt4BBoEz.js","assets/fossielenBelgieOL-CPZQuDlD.js","assets/fossielenDuitslandOL-DWaEgZPa.js","assets/fossielenFrankrijkOL-rh0eLYXU.js","assets/bunkersOL-BcYOGP-D.js","assets/grafheuvelsOL-Dnrch09m.js","assets/slagveldenOL-CdvmPH0z.js","assets/vliegveldenOL-CA9GlKXI.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();function Lw(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Gv={exports:{}},Pd={},jv={exports:{}},Qe={};var I2;function W3(){if(I2)return Qe;I2=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),o=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),g=Symbol.iterator;function m($){return $===null||typeof $!="object"?null:($=g&&$[g]||$["@@iterator"],typeof $=="function"?$:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,I={};function w($,K,Ae){this.props=$,this.context=K,this.refs=I,this.updater=Ae||v}w.prototype.isReactComponent={},w.prototype.setState=function($,K){if(typeof $!="object"&&typeof $!="function"&&$!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,$,K,"setState")},w.prototype.forceUpdate=function($){this.updater.enqueueForceUpdate(this,$,"forceUpdate")};function R(){}R.prototype=w.prototype;function P($,K,Ae){this.props=$,this.context=K,this.refs=I,this.updater=Ae||v}var b=P.prototype=new R;b.constructor=P,y(b,w.prototype),b.isPureReactComponent=!0;var L=Array.isArray,D=Object.prototype.hasOwnProperty,B={current:null},M={key:!0,ref:!0,__self:!0,__source:!0};function A($,K,Ae){var Re,Pe={},Oe=null,Fe=null;if(K!=null)for(Re in K.ref!==void 0&&(Fe=K.ref),K.key!==void 0&&(Oe=""+K.key),K)D.call(K,Re)&&!M.hasOwnProperty(Re)&&(Pe[Re]=K[Re]);var Ke=arguments.length-2;if(Ke===1)Pe.children=Ae;else if(1<Ke){for(var Ye=Array(Ke),yt=0;yt<Ke;yt++)Ye[yt]=arguments[yt+2];Pe.children=Ye}if($&&$.defaultProps)for(Re in Ke=$.defaultProps,Ke)Pe[Re]===void 0&&(Pe[Re]=Ke[Re]);return{$$typeof:n,type:$,key:Oe,ref:Fe,props:Pe,_owner:B.current}}function k($,K){return{$$typeof:n,type:$.type,key:K,ref:$.ref,props:$.props,_owner:$._owner}}function F($){return typeof $=="object"&&$!==null&&$.$$typeof===n}function G($){var K={"=":"=0",":":"=2"};return"$"+$.replace(/[=:]/g,function(Ae){return K[Ae]})}var U=/\/+/g;function N($,K){return typeof $=="object"&&$!==null&&$.key!=null?G(""+$.key):K.toString(36)}function ue($,K,Ae,Re,Pe){var Oe=typeof $;(Oe==="undefined"||Oe==="boolean")&&($=null);var Fe=!1;if($===null)Fe=!0;else switch(Oe){case"string":case"number":Fe=!0;break;case"object":switch($.$$typeof){case n:case e:Fe=!0}}if(Fe)return Fe=$,Pe=Pe(Fe),$=Re===""?"."+N(Fe,0):Re,L(Pe)?(Ae="",$!=null&&(Ae=$.replace(U,"$&/")+"/"),ue(Pe,K,Ae,"",function(yt){return yt})):Pe!=null&&(F(Pe)&&(Pe=k(Pe,Ae+(!Pe.key||Fe&&Fe.key===Pe.key?"":(""+Pe.key).replace(U,"$&/")+"/")+$)),K.push(Pe)),1;if(Fe=0,Re=Re===""?".":Re+":",L($))for(var Ke=0;Ke<$.length;Ke++){Oe=$[Ke];var Ye=Re+N(Oe,Ke);Fe+=ue(Oe,K,Ae,Ye,Pe)}else if(Ye=m($),typeof Ye=="function")for($=Ye.call($),Ke=0;!(Oe=$.next()).done;)Oe=Oe.value,Ye=Re+N(Oe,Ke++),Fe+=ue(Oe,K,Ae,Ye,Pe);else if(Oe==="object")throw K=String($),Error("Objects are not valid as a React child (found: "+(K==="[object Object]"?"object with keys {"+Object.keys($).join(", ")+"}":K)+"). If you meant to render a collection of children, use an array instead.");return Fe}function we($,K,Ae){if($==null)return $;var Re=[],Pe=0;return ue($,Re,"","",function(Oe){return K.call(Ae,Oe,Pe++)}),Re}function ye($){if($._status===-1){var K=$._result;K=K(),K.then(function(Ae){($._status===0||$._status===-1)&&($._status=1,$._result=Ae)},function(Ae){($._status===0||$._status===-1)&&($._status=2,$._result=Ae)}),$._status===-1&&($._status=0,$._result=K)}if($._status===1)return $._result.default;throw $._result}var de={current:null},J={transition:null},ae={ReactCurrentDispatcher:de,ReactCurrentBatchConfig:J,ReactCurrentOwner:B};function ie(){throw Error("act(...) is not supported in production builds of React.")}return Qe.Children={map:we,forEach:function($,K,Ae){we($,function(){K.apply(this,arguments)},Ae)},count:function($){var K=0;return we($,function(){K++}),K},toArray:function($){return we($,function(K){return K})||[]},only:function($){if(!F($))throw Error("React.Children.only expected to receive a single React element child.");return $}},Qe.Component=w,Qe.Fragment=t,Qe.Profiler=r,Qe.PureComponent=P,Qe.StrictMode=i,Qe.Suspense=u,Qe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ae,Qe.act=ie,Qe.cloneElement=function($,K,Ae){if($==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+$+".");var Re=y({},$.props),Pe=$.key,Oe=$.ref,Fe=$._owner;if(K!=null){if(K.ref!==void 0&&(Oe=K.ref,Fe=B.current),K.key!==void 0&&(Pe=""+K.key),$.type&&$.type.defaultProps)var Ke=$.type.defaultProps;for(Ye in K)D.call(K,Ye)&&!M.hasOwnProperty(Ye)&&(Re[Ye]=K[Ye]===void 0&&Ke!==void 0?Ke[Ye]:K[Ye])}var Ye=arguments.length-2;if(Ye===1)Re.children=Ae;else if(1<Ye){Ke=Array(Ye);for(var yt=0;yt<Ye;yt++)Ke[yt]=arguments[yt+2];Re.children=Ke}return{$$typeof:n,type:$.type,key:Pe,ref:Oe,props:Re,_owner:Fe}},Qe.createContext=function($){return $={$$typeof:o,_currentValue:$,_currentValue2:$,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},$.Provider={$$typeof:s,_context:$},$.Consumer=$},Qe.createElement=A,Qe.createFactory=function($){var K=A.bind(null,$);return K.type=$,K},Qe.createRef=function(){return{current:null}},Qe.forwardRef=function($){return{$$typeof:a,render:$}},Qe.isValidElement=F,Qe.lazy=function($){return{$$typeof:d,_payload:{_status:-1,_result:$},_init:ye}},Qe.memo=function($,K){return{$$typeof:h,type:$,compare:K===void 0?null:K}},Qe.startTransition=function($){var K=J.transition;J.transition={};try{$()}finally{J.transition=K}},Qe.unstable_act=ie,Qe.useCallback=function($,K){return de.current.useCallback($,K)},Qe.useContext=function($){return de.current.useContext($)},Qe.useDebugValue=function(){},Qe.useDeferredValue=function($){return de.current.useDeferredValue($)},Qe.useEffect=function($,K){return de.current.useEffect($,K)},Qe.useId=function(){return de.current.useId()},Qe.useImperativeHandle=function($,K,Ae){return de.current.useImperativeHandle($,K,Ae)},Qe.useInsertionEffect=function($,K){return de.current.useInsertionEffect($,K)},Qe.useLayoutEffect=function($,K){return de.current.useLayoutEffect($,K)},Qe.useMemo=function($,K){return de.current.useMemo($,K)},Qe.useReducer=function($,K,Ae){return de.current.useReducer($,K,Ae)},Qe.useRef=function($){return de.current.useRef($)},Qe.useState=function($){return de.current.useState($)},Qe.useSyncExternalStore=function($,K,Ae){return de.current.useSyncExternalStore($,K,Ae)},Qe.useTransition=function(){return de.current.useTransition()},Qe.version="18.3.1",Qe}var S2;function fg(){return S2||(S2=1,jv.exports=W3()),jv.exports}var A2;function K3(){if(A2)return Pd;A2=1;var n=fg(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,r=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(a,u,h){var d,g={},m=null,v=null;h!==void 0&&(m=""+h),u.key!==void 0&&(m=""+u.key),u.ref!==void 0&&(v=u.ref);for(d in u)i.call(u,d)&&!s.hasOwnProperty(d)&&(g[d]=u[d]);if(a&&a.defaultProps)for(d in u=a.defaultProps,u)g[d]===void 0&&(g[d]=u[d]);return{$$typeof:e,type:a,key:m,ref:v,props:g,_owner:r.current}}return Pd.Fragment=t,Pd.jsx=o,Pd.jsxs=o,Pd}var R2;function q3(){return R2||(R2=1,Gv.exports=K3()),Gv.exports}var V=q3(),np={},Uv={exports:{}},xi={},Bv={exports:{}},zv={};var P2;function H3(){return P2||(P2=1,(function(n){function e(J,ae){var ie=J.length;J.push(ae);e:for(;0<ie;){var $=ie-1>>>1,K=J[$];if(0<r(K,ae))J[$]=ae,J[ie]=K,ie=$;else break e}}function t(J){return J.length===0?null:J[0]}function i(J){if(J.length===0)return null;var ae=J[0],ie=J.pop();if(ie!==ae){J[0]=ie;e:for(var $=0,K=J.length,Ae=K>>>1;$<Ae;){var Re=2*($+1)-1,Pe=J[Re],Oe=Re+1,Fe=J[Oe];if(0>r(Pe,ie))Oe<K&&0>r(Fe,Pe)?(J[$]=Fe,J[Oe]=ie,$=Oe):(J[$]=Pe,J[Re]=ie,$=Re);else if(Oe<K&&0>r(Fe,ie))J[$]=Fe,J[Oe]=ie,$=Oe;else break e}}return ae}function r(J,ae){var ie=J.sortIndex-ae.sortIndex;return ie!==0?ie:J.id-ae.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var u=[],h=[],d=1,g=null,m=3,v=!1,y=!1,I=!1,w=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,P=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(J){for(var ae=t(h);ae!==null;){if(ae.callback===null)i(h);else if(ae.startTime<=J)i(h),ae.sortIndex=ae.expirationTime,e(u,ae);else break;ae=t(h)}}function L(J){if(I=!1,b(J),!y)if(t(u)!==null)y=!0,ye(D);else{var ae=t(h);ae!==null&&de(L,ae.startTime-J)}}function D(J,ae){y=!1,I&&(I=!1,R(A),A=-1),v=!0;var ie=m;try{for(b(ae),g=t(u);g!==null&&(!(g.expirationTime>ae)||J&&!G());){var $=g.callback;if(typeof $=="function"){g.callback=null,m=g.priorityLevel;var K=$(g.expirationTime<=ae);ae=n.unstable_now(),typeof K=="function"?g.callback=K:g===t(u)&&i(u),b(ae)}else i(u);g=t(u)}if(g!==null)var Ae=!0;else{var Re=t(h);Re!==null&&de(L,Re.startTime-ae),Ae=!1}return Ae}finally{g=null,m=ie,v=!1}}var B=!1,M=null,A=-1,k=5,F=-1;function G(){return!(n.unstable_now()-F<k)}function U(){if(M!==null){var J=n.unstable_now();F=J;var ae=!0;try{ae=M(!0,J)}finally{ae?N():(B=!1,M=null)}}else B=!1}var N;if(typeof P=="function")N=function(){P(U)};else if(typeof MessageChannel<"u"){var ue=new MessageChannel,we=ue.port2;ue.port1.onmessage=U,N=function(){we.postMessage(null)}}else N=function(){w(U,0)};function ye(J){M=J,B||(B=!0,N())}function de(J,ae){A=w(function(){J(n.unstable_now())},ae)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(J){J.callback=null},n.unstable_continueExecution=function(){y||v||(y=!0,ye(D))},n.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<J?Math.floor(1e3/J):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_getFirstCallbackNode=function(){return t(u)},n.unstable_next=function(J){switch(m){case 1:case 2:case 3:var ae=3;break;default:ae=m}var ie=m;m=ae;try{return J()}finally{m=ie}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(J,ae){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var ie=m;m=J;try{return ae()}finally{m=ie}},n.unstable_scheduleCallback=function(J,ae,ie){var $=n.unstable_now();switch(typeof ie=="object"&&ie!==null?(ie=ie.delay,ie=typeof ie=="number"&&0<ie?$+ie:$):ie=$,J){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=ie+K,J={id:d++,callback:ae,priorityLevel:J,startTime:ie,expirationTime:K,sortIndex:-1},ie>$?(J.sortIndex=ie,e(h,J),t(u)===null&&J===t(h)&&(I?(R(A),A=-1):I=!0,de(L,ie-$))):(J.sortIndex=K,e(u,J),y||v||(y=!0,ye(D))),J},n.unstable_shouldYield=G,n.unstable_wrapCallback=function(J){var ae=m;return function(){var ie=m;m=ae;try{return J.apply(this,arguments)}finally{m=ie}}}})(zv)),zv}var C2;function X3(){return C2||(C2=1,Bv.exports=H3()),Bv.exports}var M2;function Y3(){if(M2)return xi;M2=1;var n=fg(),e=X3();function t(l){for(var c="https://reactjs.org/docs/error-decoder.html?invariant="+l,f=1;f<arguments.length;f++)c+="&args[]="+encodeURIComponent(arguments[f]);return"Minified React error #"+l+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,r={};function s(l,c){o(l,c),o(l+"Capture",c)}function o(l,c){for(r[l]=c,l=0;l<c.length;l++)i.add(c[l])}var a=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},g={};function m(l){return u.call(g,l)?!0:u.call(d,l)?!1:h.test(l)?g[l]=!0:(d[l]=!0,!1)}function v(l,c,f,_){if(f!==null&&f.type===0)return!1;switch(typeof c){case"function":case"symbol":return!0;case"boolean":return _?!1:f!==null?!f.acceptsBooleans:(l=l.toLowerCase().slice(0,5),l!=="data-"&&l!=="aria-");default:return!1}}function y(l,c,f,_){if(c===null||typeof c>"u"||v(l,c,f,_))return!0;if(_)return!1;if(f!==null)switch(f.type){case 3:return!c;case 4:return c===!1;case 5:return isNaN(c);case 6:return isNaN(c)||1>c}return!1}function I(l,c,f,_,E,x,C){this.acceptsBooleans=c===2||c===3||c===4,this.attributeName=_,this.attributeNamespace=E,this.mustUseProperty=f,this.propertyName=l,this.type=c,this.sanitizeURL=x,this.removeEmptyString=C}var w={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(l){w[l]=new I(l,0,!1,l,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(l){var c=l[0];w[c]=new I(c,1,!1,l[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(l){w[l]=new I(l,2,!1,l.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(l){w[l]=new I(l,2,!1,l,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(l){w[l]=new I(l,3,!1,l.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(l){w[l]=new I(l,3,!0,l,null,!1,!1)}),["capture","download"].forEach(function(l){w[l]=new I(l,4,!1,l,null,!1,!1)}),["cols","rows","size","span"].forEach(function(l){w[l]=new I(l,6,!1,l,null,!1,!1)}),["rowSpan","start"].forEach(function(l){w[l]=new I(l,5,!1,l.toLowerCase(),null,!1,!1)});var R=/[\-:]([a-z])/g;function P(l){return l[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(l){var c=l.replace(R,P);w[c]=new I(c,1,!1,l,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(l){var c=l.replace(R,P);w[c]=new I(c,1,!1,l,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(l){var c=l.replace(R,P);w[c]=new I(c,1,!1,l,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(l){w[l]=new I(l,1,!1,l.toLowerCase(),null,!1,!1)}),w.xlinkHref=new I("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(l){w[l]=new I(l,1,!1,l.toLowerCase(),null,!0,!0)});function b(l,c,f,_){var E=w.hasOwnProperty(c)?w[c]:null;(E!==null?E.type!==0:_||!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(y(c,f,E,_)&&(f=null),_||E===null?m(c)&&(f===null?l.removeAttribute(c):l.setAttribute(c,""+f)):E.mustUseProperty?l[E.propertyName]=f===null?E.type===3?!1:"":f:(c=E.attributeName,_=E.attributeNamespace,f===null?l.removeAttribute(c):(E=E.type,f=E===3||E===4&&f===!0?"":""+f,_?l.setAttributeNS(_,c,f):l.setAttribute(c,f))))}var L=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,D=Symbol.for("react.element"),B=Symbol.for("react.portal"),M=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),F=Symbol.for("react.provider"),G=Symbol.for("react.context"),U=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),ue=Symbol.for("react.suspense_list"),we=Symbol.for("react.memo"),ye=Symbol.for("react.lazy"),de=Symbol.for("react.offscreen"),J=Symbol.iterator;function ae(l){return l===null||typeof l!="object"?null:(l=J&&l[J]||l["@@iterator"],typeof l=="function"?l:null)}var ie=Object.assign,$;function K(l){if($===void 0)try{throw Error()}catch(f){var c=f.stack.trim().match(/\n( *(at )?)/);$=c&&c[1]||""}return`
`+$+l}var Ae=!1;function Re(l,c){if(!l||Ae)return"";Ae=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(c)if(c=function(){throw Error()},Object.defineProperty(c.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(c,[])}catch(Z){var _=Z}Reflect.construct(l,[],c)}else{try{c.call()}catch(Z){_=Z}l.call(c.prototype)}else{try{throw Error()}catch(Z){_=Z}l()}}catch(Z){if(Z&&_&&typeof Z.stack=="string"){for(var E=Z.stack.split(`
`),x=_.stack.split(`
`),C=E.length-1,j=x.length-1;1<=C&&0<=j&&E[C]!==x[j];)j--;for(;1<=C&&0<=j;C--,j--)if(E[C]!==x[j]){if(C!==1||j!==1)do if(C--,j--,0>j||E[C]!==x[j]){var z=`
`+E[C].replace(" at new "," at ");return l.displayName&&z.includes("<anonymous>")&&(z=z.replace("<anonymous>",l.displayName)),z}while(1<=C&&0<=j);break}}}finally{Ae=!1,Error.prepareStackTrace=f}return(l=l?l.displayName||l.name:"")?K(l):""}function Pe(l){switch(l.tag){case 5:return K(l.type);case 16:return K("Lazy");case 13:return K("Suspense");case 19:return K("SuspenseList");case 0:case 2:case 15:return l=Re(l.type,!1),l;case 11:return l=Re(l.type.render,!1),l;case 1:return l=Re(l.type,!0),l;default:return""}}function Oe(l){if(l==null)return null;if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case M:return"Fragment";case B:return"Portal";case k:return"Profiler";case A:return"StrictMode";case N:return"Suspense";case ue:return"SuspenseList"}if(typeof l=="object")switch(l.$$typeof){case G:return(l.displayName||"Context")+".Consumer";case F:return(l._context.displayName||"Context")+".Provider";case U:var c=l.render;return l=l.displayName,l||(l=c.displayName||c.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case we:return c=l.displayName||null,c!==null?c:Oe(l.type)||"Memo";case ye:c=l._payload,l=l._init;try{return Oe(l(c))}catch{}}return null}function Fe(l){var c=l.type;switch(l.tag){case 24:return"Cache";case 9:return(c.displayName||"Context")+".Consumer";case 10:return(c._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return l=c.render,l=l.displayName||l.name||"",c.displayName||(l!==""?"ForwardRef("+l+")":"ForwardRef");case 7:return"Fragment";case 5:return c;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Oe(c);case 8:return c===A?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c}return null}function Ke(l){switch(typeof l){case"boolean":case"number":case"string":case"undefined":return l;case"object":return l;default:return""}}function Ye(l){var c=l.type;return(l=l.nodeName)&&l.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function yt(l){var c=Ye(l)?"checked":"value",f=Object.getOwnPropertyDescriptor(l.constructor.prototype,c),_=""+l[c];if(!l.hasOwnProperty(c)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var E=f.get,x=f.set;return Object.defineProperty(l,c,{configurable:!0,get:function(){return E.call(this)},set:function(C){_=""+C,x.call(this,C)}}),Object.defineProperty(l,c,{enumerable:f.enumerable}),{getValue:function(){return _},setValue:function(C){_=""+C},stopTracking:function(){l._valueTracker=null,delete l[c]}}}}function Rr(l){l._valueTracker||(l._valueTracker=yt(l))}function Fs(l){if(!l)return!1;var c=l._valueTracker;if(!c)return!0;var f=c.getValue(),_="";return l&&(_=Ye(l)?l.checked?"true":"false":l.value),l=_,l!==f?(c.setValue(l),!0):!1}function gi(l){if(l=l||(typeof document<"u"?document:void 0),typeof l>"u")return null;try{return l.activeElement||l.body}catch{return l.body}}function mi(l,c){var f=c.checked;return ie({},c,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:f??l._wrapperState.initialChecked})}function An(l,c){var f=c.defaultValue==null?"":c.defaultValue,_=c.checked!=null?c.checked:c.defaultChecked;f=Ke(c.value!=null?c.value:f),l._wrapperState={initialChecked:_,initialValue:f,controlled:c.type==="checkbox"||c.type==="radio"?c.checked!=null:c.value!=null}}function Rn(l,c){c=c.checked,c!=null&&b(l,"checked",c,!1)}function pi(l,c){Rn(l,c);var f=Ke(c.value),_=c.type;if(f!=null)_==="number"?(f===0&&l.value===""||l.value!=f)&&(l.value=""+f):l.value!==""+f&&(l.value=""+f);else if(_==="submit"||_==="reset"){l.removeAttribute("value");return}c.hasOwnProperty("value")?Rt(l,c.type,f):c.hasOwnProperty("defaultValue")&&Rt(l,c.type,Ke(c.defaultValue)),c.checked==null&&c.defaultChecked!=null&&(l.defaultChecked=!!c.defaultChecked)}function er(l,c,f){if(c.hasOwnProperty("value")||c.hasOwnProperty("defaultValue")){var _=c.type;if(!(_!=="submit"&&_!=="reset"||c.value!==void 0&&c.value!==null))return;c=""+l._wrapperState.initialValue,f||c===l.value||(l.value=c),l.defaultValue=c}f=l.name,f!==""&&(l.name=""),l.defaultChecked=!!l._wrapperState.initialChecked,f!==""&&(l.name=f)}function Rt(l,c,f){(c!=="number"||gi(l.ownerDocument)!==l)&&(f==null?l.defaultValue=""+l._wrapperState.initialValue:l.defaultValue!==""+f&&(l.defaultValue=""+f))}var vt=Array.isArray;function yn(l,c,f,_){if(l=l.options,c){c={};for(var E=0;E<f.length;E++)c["$"+f[E]]=!0;for(f=0;f<l.length;f++)E=c.hasOwnProperty("$"+l[f].value),l[f].selected!==E&&(l[f].selected=E),E&&_&&(l[f].defaultSelected=!0)}else{for(f=""+Ke(f),c=null,E=0;E<l.length;E++){if(l[E].value===f){l[E].selected=!0,_&&(l[E].defaultSelected=!0);return}c!==null||l[E].disabled||(c=l[E])}c!==null&&(c.selected=!0)}}function tr(l,c){if(c.dangerouslySetInnerHTML!=null)throw Error(t(91));return ie({},c,{value:void 0,defaultValue:void 0,children:""+l._wrapperState.initialValue})}function Dt(l,c){var f=c.value;if(f==null){if(f=c.children,c=c.defaultValue,f!=null){if(c!=null)throw Error(t(92));if(vt(f)){if(1<f.length)throw Error(t(93));f=f[0]}c=f}c==null&&(c=""),f=c}l._wrapperState={initialValue:Ke(f)}}function Co(l,c){var f=Ke(c.value),_=Ke(c.defaultValue);f!=null&&(f=""+f,f!==l.value&&(l.value=f),c.defaultValue==null&&l.defaultValue!==f&&(l.defaultValue=f)),_!=null&&(l.defaultValue=""+_)}function nr(l){var c=l.textContent;c===l._wrapperState.initialValue&&c!==""&&c!==null&&(l.value=c)}function Zr(l){switch(l){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Pr(l,c){return l==null||l==="http://www.w3.org/1999/xhtml"?Zr(c):l==="http://www.w3.org/2000/svg"&&c==="foreignObject"?"http://www.w3.org/1999/xhtml":l}var Qr,Xa=(function(l){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(c,f,_,E){MSApp.execUnsafeLocalFunction(function(){return l(c,f,_,E)})}:l})(function(l,c){if(l.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in l)l.innerHTML=c;else{for(Qr=Qr||document.createElement("div"),Qr.innerHTML="<svg>"+c.valueOf().toString()+"</svg>",c=Qr.firstChild;l.firstChild;)l.removeChild(l.firstChild);for(;c.firstChild;)l.appendChild(c.firstChild)}});function Jr(l,c){if(c){var f=l.firstChild;if(f&&f===l.lastChild&&f.nodeType===3){f.nodeValue=c;return}}l.textContent=c}var ir={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Au=["Webkit","ms","Moz","O"];Object.keys(ir).forEach(function(l){Au.forEach(function(c){c=c+l.charAt(0).toUpperCase()+l.substring(1),ir[c]=ir[l]})});function es(l,c,f){return c==null||typeof c=="boolean"||c===""?"":f||typeof c!="number"||c===0||ir.hasOwnProperty(l)&&ir[l]?(""+c).trim():c+"px"}function Gs(l,c){l=l.style;for(var f in c)if(c.hasOwnProperty(f)){var _=f.indexOf("--")===0,E=es(f,c[f],_);f==="float"&&(f="cssFloat"),_?l.setProperty(f,E):l[f]=E}}var Mo=ie({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ii(l,c){if(c){if(Mo[l]&&(c.children!=null||c.dangerouslySetInnerHTML!=null))throw Error(t(137,l));if(c.dangerouslySetInnerHTML!=null){if(c.children!=null)throw Error(t(60));if(typeof c.dangerouslySetInnerHTML!="object"||!("__html"in c.dangerouslySetInnerHTML))throw Error(t(61))}if(c.style!=null&&typeof c.style!="object")throw Error(t(62))}}function js(l,c){if(l.indexOf("-")===-1)return typeof c.is=="string";switch(l){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ts=null;function ns(l){return l=l.target||l.srcElement||window,l.correspondingUseElement&&(l=l.correspondingUseElement),l.nodeType===3?l.parentNode:l}var ri=null,si=null,St=null;function bo(l){if(l=fd(l)){if(typeof ri!="function")throw Error(t(280));var c=l.stateNode;c&&(c=_m(c),ri(l.stateNode,l.type,c))}}function Cr(l){si?St?St.push(l):St=[l]:si=l}function Yt(){if(si){var l=si,c=St;if(St=si=null,bo(l),c)for(l=0;l<c.length;l++)bo(c[l])}}function rr(l,c){return l(c)}function Pn(){}var Zt=!1;function Cn(l,c,f){if(Zt)return l(c,f);Zt=!0;try{return rr(l,c,f)}finally{Zt=!1,(si!==null||St!==null)&&(Pn(),Yt())}}function Mn(l,c){var f=l.stateNode;if(f===null)return null;var _=_m(f);if(_===null)return null;f=_[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(_=!_.disabled)||(l=l.type,_=!(l==="button"||l==="input"||l==="select"||l==="textarea")),l=!_;break e;default:l=!1}if(l)return null;if(f&&typeof f!="function")throw Error(t(231,c,typeof f));return f}var vn=!1;if(a)try{var ht={};Object.defineProperty(ht,"passive",{get:function(){vn=!0}}),window.addEventListener("test",ht,ht),window.removeEventListener("test",ht,ht)}catch{vn=!1}function rn(l,c,f,_,E,x,C,j,z){var Z=Array.prototype.slice.call(arguments,3);try{c.apply(f,Z)}catch(oe){this.onError(oe)}}var cn=!1,sr=null,Ru=!1,or=null,Xg={onError:function(l){cn=!0,sr=l}};function Yg(l,c,f,_,E,x,C,j,z){cn=!1,sr=null,rn.apply(Xg,arguments)}function Uh(l,c,f,_,E,x,C,j,z){if(Yg.apply(this,arguments),cn){if(cn){var Z=sr;cn=!1,sr=null}else throw Error(t(198));Ru||(Ru=!0,or=Z)}}function Mr(l){var c=l,f=l;if(l.alternate)for(;c.return;)c=c.return;else{l=c;do c=l,(c.flags&4098)!==0&&(f=c.return),l=c.return;while(l)}return c.tag===3?f:null}function Bh(l){if(l.tag===13){var c=l.memoizedState;if(c===null&&(l=l.alternate,l!==null&&(c=l.memoizedState)),c!==null)return c.dehydrated}return null}function Zg(l){if(Mr(l)!==l)throw Error(t(188))}function Qg(l){var c=l.alternate;if(!c){if(c=Mr(l),c===null)throw Error(t(188));return c!==l?null:l}for(var f=l,_=c;;){var E=f.return;if(E===null)break;var x=E.alternate;if(x===null){if(_=E.return,_!==null){f=_;continue}break}if(E.child===x.child){for(x=E.child;x;){if(x===f)return Zg(E),l;if(x===_)return Zg(E),c;x=x.sibling}throw Error(t(188))}if(f.return!==_.return)f=E,_=x;else{for(var C=!1,j=E.child;j;){if(j===f){C=!0,f=E,_=x;break}if(j===_){C=!0,_=E,f=x;break}j=j.sibling}if(!C){for(j=x.child;j;){if(j===f){C=!0,f=x,_=E;break}if(j===_){C=!0,_=x,f=E;break}j=j.sibling}if(!C)throw Error(t(189))}}if(f.alternate!==_)throw Error(t(190))}if(f.tag!==3)throw Error(t(188));return f.stateNode.current===f?l:c}function Jg(l){return l=Qg(l),l!==null?Ya(l):null}function Ya(l){if(l.tag===5||l.tag===6)return l;for(l=l.child;l!==null;){var c=Ya(l);if(c!==null)return c;l=l.sibling}return null}var zh=e.unstable_scheduleCallback,Pu=e.unstable_cancelCallback,Za=e.unstable_shouldYield,Us=e.unstable_requestPaint,Ct=e.unstable_now,py=e.unstable_getCurrentPriorityLevel,Cu=e.unstable_ImmediatePriority,$h=e.unstable_UserBlockingPriority,Qa=e.unstable_NormalPriority,Wh=e.unstable_LowPriority,Mu=e.unstable_IdlePriority,Ja=null,Di=null;function em(l){if(Di&&typeof Di.onCommitFiberRoot=="function")try{Di.onCommitFiberRoot(Ja,l,void 0,(l.current.flags&128)===128)}catch{}}var Ni=Math.clz32?Math.clz32:el,is=Math.log,ar=Math.LN2;function el(l){return l>>>=0,l===0?32:31-(is(l)/ar|0)|0}var rs=64,ko=4194304;function dt(l){switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return l&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return l}}function Bs(l,c){var f=l.pendingLanes;if(f===0)return 0;var _=0,E=l.suspendedLanes,x=l.pingedLanes,C=f&268435455;if(C!==0){var j=C&~E;j!==0?_=dt(j):(x&=C,x!==0&&(_=dt(x)))}else C=f&~E,C!==0?_=dt(C):x!==0&&(_=dt(x));if(_===0)return 0;if(c!==0&&c!==_&&(c&E)===0&&(E=_&-_,x=c&-c,E>=x||E===16&&(x&4194240)!==0))return c;if((_&4)!==0&&(_|=f&16),c=l.entangledLanes,c!==0)for(l=l.entanglements,c&=_;0<c;)f=31-Ni(c),E=1<<f,_|=l[f],c&=~E;return _}function tl(l,c){switch(l){case 1:case 2:case 4:return c+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function nl(l,c){for(var f=l.suspendedLanes,_=l.pingedLanes,E=l.expirationTimes,x=l.pendingLanes;0<x;){var C=31-Ni(x),j=1<<C,z=E[C];z===-1?((j&f)===0||(j&_)!==0)&&(E[C]=tl(j,c)):z<=c&&(l.expiredLanes|=j),x&=~j}}function Kh(l){return l=l.pendingLanes&-1073741825,l!==0?l:l&1073741824?1073741824:0}function qh(){var l=rs;return rs<<=1,(rs&4194240)===0&&(rs=64),l}function Hh(l){for(var c=[],f=0;31>f;f++)c.push(l);return c}function il(l,c,f){l.pendingLanes|=c,c!==536870912&&(l.suspendedLanes=0,l.pingedLanes=0),l=l.eventTimes,c=31-Ni(c),l[c]=f}function _y(l,c){var f=l.pendingLanes&~c;l.pendingLanes=c,l.suspendedLanes=0,l.pingedLanes=0,l.expiredLanes&=c,l.mutableReadLanes&=c,l.entangledLanes&=c,c=l.entanglements;var _=l.eventTimes;for(l=l.expirationTimes;0<f;){var E=31-Ni(f),x=1<<E;c[E]=0,_[E]=-1,l[E]=-1,f&=~x}}function Xh(l,c){var f=l.entangledLanes|=c;for(l=l.entanglements;f;){var _=31-Ni(f),E=1<<_;E&c|l[_]&c&&(l[_]|=c),f&=~E}}var tt=0;function ss(l){return l&=-l,1<l?4<l?(l&268435455)!==0?16:536870912:4:1}var Yh,bu,Zh,Qh,Jh,os=!1,ku=[],as=null,ls=null,bn=null,rl=new Map,zs=new Map,Oi=[],tm="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Lo(l,c){switch(l){case"focusin":case"focusout":as=null;break;case"dragenter":case"dragleave":ls=null;break;case"mouseover":case"mouseout":bn=null;break;case"pointerover":case"pointerout":rl.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":zs.delete(c.pointerId)}}function br(l,c,f,_,E,x){return l===null||l.nativeEvent!==x?(l={blockedOn:c,domEventName:f,eventSystemFlags:_,nativeEvent:x,targetContainers:[E]},c!==null&&(c=fd(c),c!==null&&bu(c)),l):(l.eventSystemFlags|=_,c=l.targetContainers,E!==null&&c.indexOf(E)===-1&&c.push(E),l)}function nm(l,c,f,_,E){switch(c){case"focusin":return as=br(as,l,c,f,_,E),!0;case"dragenter":return ls=br(ls,l,c,f,_,E),!0;case"mouseover":return bn=br(bn,l,c,f,_,E),!0;case"pointerover":var x=E.pointerId;return rl.set(x,br(rl.get(x)||null,l,c,f,_,E)),!0;case"gotpointercapture":return x=E.pointerId,zs.set(x,br(zs.get(x)||null,l,c,f,_,E)),!0}return!1}function Lu(l){var c=ll(l.target);if(c!==null){var f=Mr(c);if(f!==null){if(c=f.tag,c===13){if(c=Bh(f),c!==null){l.blockedOn=c,Jh(l.priority,function(){Zh(f)});return}}else if(c===3&&f.stateNode.current.memoizedState.isDehydrated){l.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}l.blockedOn=null}function At(l){if(l.blockedOn!==null)return!1;for(var c=l.targetContainers;0<c.length;){var f=Du(l.domEventName,l.eventSystemFlags,c[0],l.nativeEvent);if(f===null){f=l.nativeEvent;var _=new f.constructor(f.type,f);ts=_,f.target.dispatchEvent(_),ts=null}else return c=fd(f),c!==null&&bu(c),l.blockedOn=f,!1;c.shift()}return!0}function im(l,c,f){At(l)&&f.delete(c)}function yy(){os=!1,as!==null&&At(as)&&(as=null),ls!==null&&At(ls)&&(ls=null),bn!==null&&At(bn)&&(bn=null),rl.forEach(im),zs.forEach(im)}function Do(l,c){l.blockedOn===c&&(l.blockedOn=null,os||(os=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,yy)))}function No(l){function c(E){return Do(E,l)}if(0<ku.length){Do(ku[0],l);for(var f=1;f<ku.length;f++){var _=ku[f];_.blockedOn===l&&(_.blockedOn=null)}}for(as!==null&&Do(as,l),ls!==null&&Do(ls,l),bn!==null&&Do(bn,l),rl.forEach(c),zs.forEach(c),f=0;f<Oi.length;f++)_=Oi[f],_.blockedOn===l&&(_.blockedOn=null);for(;0<Oi.length&&(f=Oi[0],f.blockedOn===null);)Lu(f),f.blockedOn===null&&Oi.shift()}var $s=L.ReactCurrentBatchConfig,Ws=!0;function us(l,c,f,_){var E=tt,x=$s.transition;$s.transition=null;try{tt=1,ed(l,c,f,_)}finally{tt=E,$s.transition=x}}function rm(l,c,f,_){var E=tt,x=$s.transition;$s.transition=null;try{tt=4,ed(l,c,f,_)}finally{tt=E,$s.transition=x}}function ed(l,c,f,_){if(Ws){var E=Du(l,c,f,_);if(E===null)Cy(l,c,_,cs,f),Lo(l,_);else if(nm(E,l,c,f,_))_.stopPropagation();else if(Lo(l,_),c&4&&-1<tm.indexOf(l)){for(;E!==null;){var x=fd(E);if(x!==null&&Yh(x),x=Du(l,c,f,_),x===null&&Cy(l,c,_,cs,f),x===E)break;E=x}E!==null&&_.stopPropagation()}else Cy(l,c,_,null,f)}}var cs=null;function Du(l,c,f,_){if(cs=null,l=ns(_),l=ll(l),l!==null)if(c=Mr(l),c===null)l=null;else if(f=c.tag,f===13){if(l=Bh(c),l!==null)return l;l=null}else if(f===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;l=null}else c!==l&&(l=null);return cs=l,null}function Nu(l){switch(l){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(py()){case Cu:return 1;case $h:return 4;case Qa:case Wh:return 16;case Mu:return 536870912;default:return 16}default:return 16}}var Vi=null,Ou=null,Ks=null;function sm(){if(Ks)return Ks;var l,c=Ou,f=c.length,_,E="value"in Vi?Vi.value:Vi.textContent,x=E.length;for(l=0;l<f&&c[l]===E[l];l++);var C=f-l;for(_=1;_<=C&&c[f-_]===E[x-_];_++);return Ks=E.slice(l,1<_?1-_:void 0)}function sl(l){var c=l.keyCode;return"charCode"in l?(l=l.charCode,l===0&&c===13&&(l=13)):l=c,l===10&&(l=13),32<=l||l===13?l:0}function hs(){return!0}function td(){return!1}function Un(l){function c(f,_,E,x,C){this._reactName=f,this._targetInst=E,this.type=_,this.nativeEvent=x,this.target=C,this.currentTarget=null;for(var j in l)l.hasOwnProperty(j)&&(f=l[j],this[j]=f?f(x):x[j]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?hs:td,this.isPropagationStopped=td,this}return ie(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=hs)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=hs)},persist:function(){},isPersistent:hs}),c}var ds={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(l){return l.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ol=Un(ds),Oo=ie({},ds,{view:0,detail:0}),Vu=Un(Oo),Fu,Gu,Fi,al=ie({},Oo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:qe,button:0,buttons:0,relatedTarget:function(l){return l.relatedTarget===void 0?l.fromElement===l.srcElement?l.toElement:l.fromElement:l.relatedTarget},movementX:function(l){return"movementX"in l?l.movementX:(l!==Fi&&(Fi&&l.type==="mousemove"?(Fu=l.screenX-Fi.screenX,Gu=l.screenY-Fi.screenY):Gu=Fu=0,Fi=l),Fu)},movementY:function(l){return"movementY"in l?l.movementY:Gu}}),nd=Un(al),om=ie({},al,{dataTransfer:0}),am=Un(om),ju=ie({},Oo,{relatedTarget:0}),kn=Un(ju),lm=ie({},ds,{animationName:0,elapsedTime:0,pseudoElement:0}),um=Un(lm),Vo=ie({},ds,{clipboardData:function(l){return"clipboardData"in l?l.clipboardData:window.clipboardData}}),p=Un(Vo),T=ie({},ds,{data:0}),S=Un(T),O={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},X={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Q={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fe(l){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(l):(l=Q[l])?!!c[l]:!1}function qe(){return fe}var Qt=ie({},Oo,{key:function(l){if(l.key){var c=O[l.key]||l.key;if(c!=="Unidentified")return c}return l.type==="keypress"?(l=sl(l),l===13?"Enter":String.fromCharCode(l)):l.type==="keydown"||l.type==="keyup"?X[l.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:qe,charCode:function(l){return l.type==="keypress"?sl(l):0},keyCode:function(l){return l.type==="keydown"||l.type==="keyup"?l.keyCode:0},which:function(l){return l.type==="keypress"?sl(l):l.type==="keydown"||l.type==="keyup"?l.keyCode:0}}),Et=Un(Qt),sn=ie({},al,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Gi=Un(sn),qs=ie({},Oo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:qe}),fs=Un(qs),gs=ie({},ds,{propertyName:0,elapsedTime:0,pseudoElement:0}),Uu=Un(gs),id=ie({},al,{deltaX:function(l){return"deltaX"in l?l.deltaX:"wheelDeltaX"in l?-l.wheelDeltaX:0},deltaY:function(l){return"deltaY"in l?l.deltaY:"wheelDeltaY"in l?-l.wheelDeltaY:"wheelDelta"in l?-l.wheelDelta:0},deltaZ:0,deltaMode:0}),GO=Un(id),jO=[9,13,27,32],vy=a&&"CompositionEvent"in window,rd=null;a&&"documentMode"in document&&(rd=document.documentMode);var UO=a&&"TextEvent"in window&&!rd,pI=a&&(!vy||rd&&8<rd&&11>=rd),_I=" ",yI=!1;function vI(l,c){switch(l){case"keyup":return jO.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function EI(l){return l=l.detail,typeof l=="object"&&"data"in l?l.data:null}var Bu=!1;function BO(l,c){switch(l){case"compositionend":return EI(c);case"keypress":return c.which!==32?null:(yI=!0,_I);case"textInput":return l=c.data,l===_I&&yI?null:l;default:return null}}function zO(l,c){if(Bu)return l==="compositionend"||!vy&&vI(l,c)?(l=sm(),Ks=Ou=Vi=null,Bu=!1,l):null;switch(l){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return pI&&c.locale!=="ko"?null:c.data;default:return null}}var $O={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function wI(l){var c=l&&l.nodeName&&l.nodeName.toLowerCase();return c==="input"?!!$O[l.type]:c==="textarea"}function xI(l,c,f,_){Cr(_),c=gm(c,"onChange"),0<c.length&&(f=new ol("onChange","change",null,f,_),l.push({event:f,listeners:c}))}var sd=null,od=null;function WO(l){jI(l,0)}function cm(l){var c=qu(l);if(Fs(c))return l}function KO(l,c){if(l==="change")return c}var TI=!1;if(a){var Ey;if(a){var wy="oninput"in document;if(!wy){var II=document.createElement("div");II.setAttribute("oninput","return;"),wy=typeof II.oninput=="function"}Ey=wy}else Ey=!1;TI=Ey&&(!document.documentMode||9<document.documentMode)}function SI(){sd&&(sd.detachEvent("onpropertychange",AI),od=sd=null)}function AI(l){if(l.propertyName==="value"&&cm(od)){var c=[];xI(c,od,l,ns(l)),Cn(WO,c)}}function qO(l,c,f){l==="focusin"?(SI(),sd=c,od=f,sd.attachEvent("onpropertychange",AI)):l==="focusout"&&SI()}function HO(l){if(l==="selectionchange"||l==="keyup"||l==="keydown")return cm(od)}function XO(l,c){if(l==="click")return cm(c)}function YO(l,c){if(l==="input"||l==="change")return cm(c)}function ZO(l,c){return l===c&&(l!==0||1/l===1/c)||l!==l&&c!==c}var kr=typeof Object.is=="function"?Object.is:ZO;function ad(l,c){if(kr(l,c))return!0;if(typeof l!="object"||l===null||typeof c!="object"||c===null)return!1;var f=Object.keys(l),_=Object.keys(c);if(f.length!==_.length)return!1;for(_=0;_<f.length;_++){var E=f[_];if(!u.call(c,E)||!kr(l[E],c[E]))return!1}return!0}function RI(l){for(;l&&l.firstChild;)l=l.firstChild;return l}function PI(l,c){var f=RI(l);l=0;for(var _;f;){if(f.nodeType===3){if(_=l+f.textContent.length,l<=c&&_>=c)return{node:f,offset:c-l};l=_}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=RI(f)}}function CI(l,c){return l&&c?l===c?!0:l&&l.nodeType===3?!1:c&&c.nodeType===3?CI(l,c.parentNode):"contains"in l?l.contains(c):l.compareDocumentPosition?!!(l.compareDocumentPosition(c)&16):!1:!1}function MI(){for(var l=window,c=gi();c instanceof l.HTMLIFrameElement;){try{var f=typeof c.contentWindow.location.href=="string"}catch{f=!1}if(f)l=c.contentWindow;else break;c=gi(l.document)}return c}function xy(l){var c=l&&l.nodeName&&l.nodeName.toLowerCase();return c&&(c==="input"&&(l.type==="text"||l.type==="search"||l.type==="tel"||l.type==="url"||l.type==="password")||c==="textarea"||l.contentEditable==="true")}function QO(l){var c=MI(),f=l.focusedElem,_=l.selectionRange;if(c!==f&&f&&f.ownerDocument&&CI(f.ownerDocument.documentElement,f)){if(_!==null&&xy(f)){if(c=_.start,l=_.end,l===void 0&&(l=c),"selectionStart"in f)f.selectionStart=c,f.selectionEnd=Math.min(l,f.value.length);else if(l=(c=f.ownerDocument||document)&&c.defaultView||window,l.getSelection){l=l.getSelection();var E=f.textContent.length,x=Math.min(_.start,E);_=_.end===void 0?x:Math.min(_.end,E),!l.extend&&x>_&&(E=_,_=x,x=E),E=PI(f,x);var C=PI(f,_);E&&C&&(l.rangeCount!==1||l.anchorNode!==E.node||l.anchorOffset!==E.offset||l.focusNode!==C.node||l.focusOffset!==C.offset)&&(c=c.createRange(),c.setStart(E.node,E.offset),l.removeAllRanges(),x>_?(l.addRange(c),l.extend(C.node,C.offset)):(c.setEnd(C.node,C.offset),l.addRange(c)))}}for(c=[],l=f;l=l.parentNode;)l.nodeType===1&&c.push({element:l,left:l.scrollLeft,top:l.scrollTop});for(typeof f.focus=="function"&&f.focus(),f=0;f<c.length;f++)l=c[f],l.element.scrollLeft=l.left,l.element.scrollTop=l.top}}var JO=a&&"documentMode"in document&&11>=document.documentMode,zu=null,Ty=null,ld=null,Iy=!1;function bI(l,c,f){var _=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;Iy||zu==null||zu!==gi(_)||(_=zu,"selectionStart"in _&&xy(_)?_={start:_.selectionStart,end:_.selectionEnd}:(_=(_.ownerDocument&&_.ownerDocument.defaultView||window).getSelection(),_={anchorNode:_.anchorNode,anchorOffset:_.anchorOffset,focusNode:_.focusNode,focusOffset:_.focusOffset}),ld&&ad(ld,_)||(ld=_,_=gm(Ty,"onSelect"),0<_.length&&(c=new ol("onSelect","select",null,c,f),l.push({event:c,listeners:_}),c.target=zu)))}function hm(l,c){var f={};return f[l.toLowerCase()]=c.toLowerCase(),f["Webkit"+l]="webkit"+c,f["Moz"+l]="moz"+c,f}var $u={animationend:hm("Animation","AnimationEnd"),animationiteration:hm("Animation","AnimationIteration"),animationstart:hm("Animation","AnimationStart"),transitionend:hm("Transition","TransitionEnd")},Sy={},kI={};a&&(kI=document.createElement("div").style,"AnimationEvent"in window||(delete $u.animationend.animation,delete $u.animationiteration.animation,delete $u.animationstart.animation),"TransitionEvent"in window||delete $u.transitionend.transition);function dm(l){if(Sy[l])return Sy[l];if(!$u[l])return l;var c=$u[l],f;for(f in c)if(c.hasOwnProperty(f)&&f in kI)return Sy[l]=c[f];return l}var LI=dm("animationend"),DI=dm("animationiteration"),NI=dm("animationstart"),OI=dm("transitionend"),VI=new Map,FI="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Fo(l,c){VI.set(l,c),s(c,[l])}for(var Ay=0;Ay<FI.length;Ay++){var Ry=FI[Ay],e3=Ry.toLowerCase(),t3=Ry[0].toUpperCase()+Ry.slice(1);Fo(e3,"on"+t3)}Fo(LI,"onAnimationEnd"),Fo(DI,"onAnimationIteration"),Fo(NI,"onAnimationStart"),Fo("dblclick","onDoubleClick"),Fo("focusin","onFocus"),Fo("focusout","onBlur"),Fo(OI,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ud="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),n3=new Set("cancel close invalid load scroll toggle".split(" ").concat(ud));function GI(l,c,f){var _=l.type||"unknown-event";l.currentTarget=f,Uh(_,c,void 0,l),l.currentTarget=null}function jI(l,c){c=(c&4)!==0;for(var f=0;f<l.length;f++){var _=l[f],E=_.event;_=_.listeners;e:{var x=void 0;if(c)for(var C=_.length-1;0<=C;C--){var j=_[C],z=j.instance,Z=j.currentTarget;if(j=j.listener,z!==x&&E.isPropagationStopped())break e;GI(E,j,Z),x=z}else for(C=0;C<_.length;C++){if(j=_[C],z=j.instance,Z=j.currentTarget,j=j.listener,z!==x&&E.isPropagationStopped())break e;GI(E,j,Z),x=z}}}if(Ru)throw l=or,Ru=!1,or=null,l}function Mt(l,c){var f=c[Ny];f===void 0&&(f=c[Ny]=new Set);var _=l+"__bubble";f.has(_)||(UI(c,l,2,!1),f.add(_))}function Py(l,c,f){var _=0;c&&(_|=4),UI(f,l,_,c)}var fm="_reactListening"+Math.random().toString(36).slice(2);function cd(l){if(!l[fm]){l[fm]=!0,i.forEach(function(f){f!=="selectionchange"&&(n3.has(f)||Py(f,!1,l),Py(f,!0,l))});var c=l.nodeType===9?l:l.ownerDocument;c===null||c[fm]||(c[fm]=!0,Py("selectionchange",!1,c))}}function UI(l,c,f,_){switch(Nu(c)){case 1:var E=us;break;case 4:E=rm;break;default:E=ed}f=E.bind(null,c,f,l),E=void 0,!vn||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(E=!0),_?E!==void 0?l.addEventListener(c,f,{capture:!0,passive:E}):l.addEventListener(c,f,!0):E!==void 0?l.addEventListener(c,f,{passive:E}):l.addEventListener(c,f,!1)}function Cy(l,c,f,_,E){var x=_;if((c&1)===0&&(c&2)===0&&_!==null)e:for(;;){if(_===null)return;var C=_.tag;if(C===3||C===4){var j=_.stateNode.containerInfo;if(j===E||j.nodeType===8&&j.parentNode===E)break;if(C===4)for(C=_.return;C!==null;){var z=C.tag;if((z===3||z===4)&&(z=C.stateNode.containerInfo,z===E||z.nodeType===8&&z.parentNode===E))return;C=C.return}for(;j!==null;){if(C=ll(j),C===null)return;if(z=C.tag,z===5||z===6){_=x=C;continue e}j=j.parentNode}}_=_.return}Cn(function(){var Z=x,oe=ns(f),le=[];e:{var re=VI.get(l);if(re!==void 0){var ve=ol,xe=l;switch(l){case"keypress":if(sl(f)===0)break e;case"keydown":case"keyup":ve=Et;break;case"focusin":xe="focus",ve=kn;break;case"focusout":xe="blur",ve=kn;break;case"beforeblur":case"afterblur":ve=kn;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ve=nd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ve=am;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ve=fs;break;case LI:case DI:case NI:ve=um;break;case OI:ve=Uu;break;case"scroll":ve=Vu;break;case"wheel":ve=GO;break;case"copy":case"cut":case"paste":ve=p;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ve=Gi}var Ie=(c&4)!==0,Jt=!Ie&&l==="scroll",H=Ie?re!==null?re+"Capture":null:re;Ie=[];for(var W=Z,Y;W!==null;){Y=W;var he=Y.stateNode;if(Y.tag===5&&he!==null&&(Y=he,H!==null&&(he=Mn(W,H),he!=null&&Ie.push(hd(W,he,Y)))),Jt)break;W=W.return}0<Ie.length&&(re=new ve(re,xe,null,f,oe),le.push({event:re,listeners:Ie}))}}if((c&7)===0){e:{if(re=l==="mouseover"||l==="pointerover",ve=l==="mouseout"||l==="pointerout",re&&f!==ts&&(xe=f.relatedTarget||f.fromElement)&&(ll(xe)||xe[Hs]))break e;if((ve||re)&&(re=oe.window===oe?oe:(re=oe.ownerDocument)?re.defaultView||re.parentWindow:window,ve?(xe=f.relatedTarget||f.toElement,ve=Z,xe=xe?ll(xe):null,xe!==null&&(Jt=Mr(xe),xe!==Jt||xe.tag!==5&&xe.tag!==6)&&(xe=null)):(ve=null,xe=Z),ve!==xe)){if(Ie=nd,he="onMouseLeave",H="onMouseEnter",W="mouse",(l==="pointerout"||l==="pointerover")&&(Ie=Gi,he="onPointerLeave",H="onPointerEnter",W="pointer"),Jt=ve==null?re:qu(ve),Y=xe==null?re:qu(xe),re=new Ie(he,W+"leave",ve,f,oe),re.target=Jt,re.relatedTarget=Y,he=null,ll(oe)===Z&&(Ie=new Ie(H,W+"enter",xe,f,oe),Ie.target=Y,Ie.relatedTarget=Jt,he=Ie),Jt=he,ve&&xe)t:{for(Ie=ve,H=xe,W=0,Y=Ie;Y;Y=Wu(Y))W++;for(Y=0,he=H;he;he=Wu(he))Y++;for(;0<W-Y;)Ie=Wu(Ie),W--;for(;0<Y-W;)H=Wu(H),Y--;for(;W--;){if(Ie===H||H!==null&&Ie===H.alternate)break t;Ie=Wu(Ie),H=Wu(H)}Ie=null}else Ie=null;ve!==null&&BI(le,re,ve,Ie,!1),xe!==null&&Jt!==null&&BI(le,Jt,xe,Ie,!0)}}e:{if(re=Z?qu(Z):window,ve=re.nodeName&&re.nodeName.toLowerCase(),ve==="select"||ve==="input"&&re.type==="file")var Se=KO;else if(wI(re))if(TI)Se=YO;else{Se=HO;var Le=qO}else(ve=re.nodeName)&&ve.toLowerCase()==="input"&&(re.type==="checkbox"||re.type==="radio")&&(Se=XO);if(Se&&(Se=Se(l,Z))){xI(le,Se,f,oe);break e}Le&&Le(l,re,Z),l==="focusout"&&(Le=re._wrapperState)&&Le.controlled&&re.type==="number"&&Rt(re,"number",re.value)}switch(Le=Z?qu(Z):window,l){case"focusin":(wI(Le)||Le.contentEditable==="true")&&(zu=Le,Ty=Z,ld=null);break;case"focusout":ld=Ty=zu=null;break;case"mousedown":Iy=!0;break;case"contextmenu":case"mouseup":case"dragend":Iy=!1,bI(le,f,oe);break;case"selectionchange":if(JO)break;case"keydown":case"keyup":bI(le,f,oe)}var De;if(vy)e:{switch(l){case"compositionstart":var Ge="onCompositionStart";break e;case"compositionend":Ge="onCompositionEnd";break e;case"compositionupdate":Ge="onCompositionUpdate";break e}Ge=void 0}else Bu?vI(l,f)&&(Ge="onCompositionEnd"):l==="keydown"&&f.keyCode===229&&(Ge="onCompositionStart");Ge&&(pI&&f.locale!=="ko"&&(Bu||Ge!=="onCompositionStart"?Ge==="onCompositionEnd"&&Bu&&(De=sm()):(Vi=oe,Ou="value"in Vi?Vi.value:Vi.textContent,Bu=!0)),Le=gm(Z,Ge),0<Le.length&&(Ge=new S(Ge,l,null,f,oe),le.push({event:Ge,listeners:Le}),De?Ge.data=De:(De=EI(f),De!==null&&(Ge.data=De)))),(De=UO?BO(l,f):zO(l,f))&&(Z=gm(Z,"onBeforeInput"),0<Z.length&&(oe=new S("onBeforeInput","beforeinput",null,f,oe),le.push({event:oe,listeners:Z}),oe.data=De))}jI(le,c)})}function hd(l,c,f){return{instance:l,listener:c,currentTarget:f}}function gm(l,c){for(var f=c+"Capture",_=[];l!==null;){var E=l,x=E.stateNode;E.tag===5&&x!==null&&(E=x,x=Mn(l,f),x!=null&&_.unshift(hd(l,x,E)),x=Mn(l,c),x!=null&&_.push(hd(l,x,E))),l=l.return}return _}function Wu(l){if(l===null)return null;do l=l.return;while(l&&l.tag!==5);return l||null}function BI(l,c,f,_,E){for(var x=c._reactName,C=[];f!==null&&f!==_;){var j=f,z=j.alternate,Z=j.stateNode;if(z!==null&&z===_)break;j.tag===5&&Z!==null&&(j=Z,E?(z=Mn(f,x),z!=null&&C.unshift(hd(f,z,j))):E||(z=Mn(f,x),z!=null&&C.push(hd(f,z,j)))),f=f.return}C.length!==0&&l.push({event:c,listeners:C})}var i3=/\r\n?/g,r3=/\u0000|\uFFFD/g;function zI(l){return(typeof l=="string"?l:""+l).replace(i3,`
`).replace(r3,"")}function mm(l,c,f){if(c=zI(c),zI(l)!==c&&f)throw Error(t(425))}function pm(){}var My=null,by=null;function ky(l,c){return l==="textarea"||l==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var Ly=typeof setTimeout=="function"?setTimeout:void 0,s3=typeof clearTimeout=="function"?clearTimeout:void 0,$I=typeof Promise=="function"?Promise:void 0,o3=typeof queueMicrotask=="function"?queueMicrotask:typeof $I<"u"?function(l){return $I.resolve(null).then(l).catch(a3)}:Ly;function a3(l){setTimeout(function(){throw l})}function Dy(l,c){var f=c,_=0;do{var E=f.nextSibling;if(l.removeChild(f),E&&E.nodeType===8)if(f=E.data,f==="/$"){if(_===0){l.removeChild(E),No(c);return}_--}else f!=="$"&&f!=="$?"&&f!=="$!"||_++;f=E}while(f);No(c)}function Go(l){for(;l!=null;l=l.nextSibling){var c=l.nodeType;if(c===1||c===3)break;if(c===8){if(c=l.data,c==="$"||c==="$!"||c==="$?")break;if(c==="/$")return null}}return l}function WI(l){l=l.previousSibling;for(var c=0;l;){if(l.nodeType===8){var f=l.data;if(f==="$"||f==="$!"||f==="$?"){if(c===0)return l;c--}else f==="/$"&&c++}l=l.previousSibling}return null}var Ku=Math.random().toString(36).slice(2),ms="__reactFiber$"+Ku,dd="__reactProps$"+Ku,Hs="__reactContainer$"+Ku,Ny="__reactEvents$"+Ku,l3="__reactListeners$"+Ku,u3="__reactHandles$"+Ku;function ll(l){var c=l[ms];if(c)return c;for(var f=l.parentNode;f;){if(c=f[Hs]||f[ms]){if(f=c.alternate,c.child!==null||f!==null&&f.child!==null)for(l=WI(l);l!==null;){if(f=l[ms])return f;l=WI(l)}return c}l=f,f=l.parentNode}return null}function fd(l){return l=l[ms]||l[Hs],!l||l.tag!==5&&l.tag!==6&&l.tag!==13&&l.tag!==3?null:l}function qu(l){if(l.tag===5||l.tag===6)return l.stateNode;throw Error(t(33))}function _m(l){return l[dd]||null}var Oy=[],Hu=-1;function jo(l){return{current:l}}function bt(l){0>Hu||(l.current=Oy[Hu],Oy[Hu]=null,Hu--)}function Pt(l,c){Hu++,Oy[Hu]=l.current,l.current=c}var Uo={},Bn=jo(Uo),_i=jo(!1),ul=Uo;function Xu(l,c){var f=l.type.contextTypes;if(!f)return Uo;var _=l.stateNode;if(_&&_.__reactInternalMemoizedUnmaskedChildContext===c)return _.__reactInternalMemoizedMaskedChildContext;var E={},x;for(x in f)E[x]=c[x];return _&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=c,l.__reactInternalMemoizedMaskedChildContext=E),E}function yi(l){return l=l.childContextTypes,l!=null}function ym(){bt(_i),bt(Bn)}function KI(l,c,f){if(Bn.current!==Uo)throw Error(t(168));Pt(Bn,c),Pt(_i,f)}function qI(l,c,f){var _=l.stateNode;if(c=c.childContextTypes,typeof _.getChildContext!="function")return f;_=_.getChildContext();for(var E in _)if(!(E in c))throw Error(t(108,Fe(l)||"Unknown",E));return ie({},f,_)}function vm(l){return l=(l=l.stateNode)&&l.__reactInternalMemoizedMergedChildContext||Uo,ul=Bn.current,Pt(Bn,l),Pt(_i,_i.current),!0}function HI(l,c,f){var _=l.stateNode;if(!_)throw Error(t(169));f?(l=qI(l,c,ul),_.__reactInternalMemoizedMergedChildContext=l,bt(_i),bt(Bn),Pt(Bn,l)):bt(_i),Pt(_i,f)}var Xs=null,Em=!1,Vy=!1;function XI(l){Xs===null?Xs=[l]:Xs.push(l)}function c3(l){Em=!0,XI(l)}function Bo(){if(!Vy&&Xs!==null){Vy=!0;var l=0,c=tt;try{var f=Xs;for(tt=1;l<f.length;l++){var _=f[l];do _=_(!0);while(_!==null)}Xs=null,Em=!1}catch(E){throw Xs!==null&&(Xs=Xs.slice(l+1)),zh(Cu,Bo),E}finally{tt=c,Vy=!1}}return null}var Yu=[],Zu=0,wm=null,xm=0,lr=[],ur=0,cl=null,Ys=1,Zs="";function hl(l,c){Yu[Zu++]=xm,Yu[Zu++]=wm,wm=l,xm=c}function YI(l,c,f){lr[ur++]=Ys,lr[ur++]=Zs,lr[ur++]=cl,cl=l;var _=Ys;l=Zs;var E=32-Ni(_)-1;_&=~(1<<E),f+=1;var x=32-Ni(c)+E;if(30<x){var C=E-E%5;x=(_&(1<<C)-1).toString(32),_>>=C,E-=C,Ys=1<<32-Ni(c)+E|f<<E|_,Zs=x+l}else Ys=1<<x|f<<E|_,Zs=l}function Fy(l){l.return!==null&&(hl(l,1),YI(l,1,0))}function Gy(l){for(;l===wm;)wm=Yu[--Zu],Yu[Zu]=null,xm=Yu[--Zu],Yu[Zu]=null;for(;l===cl;)cl=lr[--ur],lr[ur]=null,Zs=lr[--ur],lr[ur]=null,Ys=lr[--ur],lr[ur]=null}var ji=null,Ui=null,Nt=!1,Lr=null;function ZI(l,c){var f=fr(5,null,null,0);f.elementType="DELETED",f.stateNode=c,f.return=l,c=l.deletions,c===null?(l.deletions=[f],l.flags|=16):c.push(f)}function QI(l,c){switch(l.tag){case 5:var f=l.type;return c=c.nodeType!==1||f.toLowerCase()!==c.nodeName.toLowerCase()?null:c,c!==null?(l.stateNode=c,ji=l,Ui=Go(c.firstChild),!0):!1;case 6:return c=l.pendingProps===""||c.nodeType!==3?null:c,c!==null?(l.stateNode=c,ji=l,Ui=null,!0):!1;case 13:return c=c.nodeType!==8?null:c,c!==null?(f=cl!==null?{id:Ys,overflow:Zs}:null,l.memoizedState={dehydrated:c,treeContext:f,retryLane:1073741824},f=fr(18,null,null,0),f.stateNode=c,f.return=l,l.child=f,ji=l,Ui=null,!0):!1;default:return!1}}function jy(l){return(l.mode&1)!==0&&(l.flags&128)===0}function Uy(l){if(Nt){var c=Ui;if(c){var f=c;if(!QI(l,c)){if(jy(l))throw Error(t(418));c=Go(f.nextSibling);var _=ji;c&&QI(l,c)?ZI(_,f):(l.flags=l.flags&-4097|2,Nt=!1,ji=l)}}else{if(jy(l))throw Error(t(418));l.flags=l.flags&-4097|2,Nt=!1,ji=l}}}function JI(l){for(l=l.return;l!==null&&l.tag!==5&&l.tag!==3&&l.tag!==13;)l=l.return;ji=l}function Tm(l){if(l!==ji)return!1;if(!Nt)return JI(l),Nt=!0,!1;var c;if((c=l.tag!==3)&&!(c=l.tag!==5)&&(c=l.type,c=c!=="head"&&c!=="body"&&!ky(l.type,l.memoizedProps)),c&&(c=Ui)){if(jy(l))throw eS(),Error(t(418));for(;c;)ZI(l,c),c=Go(c.nextSibling)}if(JI(l),l.tag===13){if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(t(317));e:{for(l=l.nextSibling,c=0;l;){if(l.nodeType===8){var f=l.data;if(f==="/$"){if(c===0){Ui=Go(l.nextSibling);break e}c--}else f!=="$"&&f!=="$!"&&f!=="$?"||c++}l=l.nextSibling}Ui=null}}else Ui=ji?Go(l.stateNode.nextSibling):null;return!0}function eS(){for(var l=Ui;l;)l=Go(l.nextSibling)}function Qu(){Ui=ji=null,Nt=!1}function By(l){Lr===null?Lr=[l]:Lr.push(l)}var h3=L.ReactCurrentBatchConfig;function gd(l,c,f){if(l=f.ref,l!==null&&typeof l!="function"&&typeof l!="object"){if(f._owner){if(f=f._owner,f){if(f.tag!==1)throw Error(t(309));var _=f.stateNode}if(!_)throw Error(t(147,l));var E=_,x=""+l;return c!==null&&c.ref!==null&&typeof c.ref=="function"&&c.ref._stringRef===x?c.ref:(c=function(C){var j=E.refs;C===null?delete j[x]:j[x]=C},c._stringRef=x,c)}if(typeof l!="string")throw Error(t(284));if(!f._owner)throw Error(t(290,l))}return l}function Im(l,c){throw l=Object.prototype.toString.call(c),Error(t(31,l==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":l))}function tS(l){var c=l._init;return c(l._payload)}function nS(l){function c(H,W){if(l){var Y=H.deletions;Y===null?(H.deletions=[W],H.flags|=16):Y.push(W)}}function f(H,W){if(!l)return null;for(;W!==null;)c(H,W),W=W.sibling;return null}function _(H,W){for(H=new Map;W!==null;)W.key!==null?H.set(W.key,W):H.set(W.index,W),W=W.sibling;return H}function E(H,W){return H=Yo(H,W),H.index=0,H.sibling=null,H}function x(H,W,Y){return H.index=Y,l?(Y=H.alternate,Y!==null?(Y=Y.index,Y<W?(H.flags|=2,W):Y):(H.flags|=2,W)):(H.flags|=1048576,W)}function C(H){return l&&H.alternate===null&&(H.flags|=2),H}function j(H,W,Y,he){return W===null||W.tag!==6?(W=Lv(Y,H.mode,he),W.return=H,W):(W=E(W,Y),W.return=H,W)}function z(H,W,Y,he){var Se=Y.type;return Se===M?oe(H,W,Y.props.children,he,Y.key):W!==null&&(W.elementType===Se||typeof Se=="object"&&Se!==null&&Se.$$typeof===ye&&tS(Se)===W.type)?(he=E(W,Y.props),he.ref=gd(H,W,Y),he.return=H,he):(he=Hm(Y.type,Y.key,Y.props,null,H.mode,he),he.ref=gd(H,W,Y),he.return=H,he)}function Z(H,W,Y,he){return W===null||W.tag!==4||W.stateNode.containerInfo!==Y.containerInfo||W.stateNode.implementation!==Y.implementation?(W=Dv(Y,H.mode,he),W.return=H,W):(W=E(W,Y.children||[]),W.return=H,W)}function oe(H,W,Y,he,Se){return W===null||W.tag!==7?(W=vl(Y,H.mode,he,Se),W.return=H,W):(W=E(W,Y),W.return=H,W)}function le(H,W,Y){if(typeof W=="string"&&W!==""||typeof W=="number")return W=Lv(""+W,H.mode,Y),W.return=H,W;if(typeof W=="object"&&W!==null){switch(W.$$typeof){case D:return Y=Hm(W.type,W.key,W.props,null,H.mode,Y),Y.ref=gd(H,null,W),Y.return=H,Y;case B:return W=Dv(W,H.mode,Y),W.return=H,W;case ye:var he=W._init;return le(H,he(W._payload),Y)}if(vt(W)||ae(W))return W=vl(W,H.mode,Y,null),W.return=H,W;Im(H,W)}return null}function re(H,W,Y,he){var Se=W!==null?W.key:null;if(typeof Y=="string"&&Y!==""||typeof Y=="number")return Se!==null?null:j(H,W,""+Y,he);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case D:return Y.key===Se?z(H,W,Y,he):null;case B:return Y.key===Se?Z(H,W,Y,he):null;case ye:return Se=Y._init,re(H,W,Se(Y._payload),he)}if(vt(Y)||ae(Y))return Se!==null?null:oe(H,W,Y,he,null);Im(H,Y)}return null}function ve(H,W,Y,he,Se){if(typeof he=="string"&&he!==""||typeof he=="number")return H=H.get(Y)||null,j(W,H,""+he,Se);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case D:return H=H.get(he.key===null?Y:he.key)||null,z(W,H,he,Se);case B:return H=H.get(he.key===null?Y:he.key)||null,Z(W,H,he,Se);case ye:var Le=he._init;return ve(H,W,Y,Le(he._payload),Se)}if(vt(he)||ae(he))return H=H.get(Y)||null,oe(W,H,he,Se,null);Im(W,he)}return null}function xe(H,W,Y,he){for(var Se=null,Le=null,De=W,Ge=W=0,xn=null;De!==null&&Ge<Y.length;Ge++){De.index>Ge?(xn=De,De=null):xn=De.sibling;var st=re(H,De,Y[Ge],he);if(st===null){De===null&&(De=xn);break}l&&De&&st.alternate===null&&c(H,De),W=x(st,W,Ge),Le===null?Se=st:Le.sibling=st,Le=st,De=xn}if(Ge===Y.length)return f(H,De),Nt&&hl(H,Ge),Se;if(De===null){for(;Ge<Y.length;Ge++)De=le(H,Y[Ge],he),De!==null&&(W=x(De,W,Ge),Le===null?Se=De:Le.sibling=De,Le=De);return Nt&&hl(H,Ge),Se}for(De=_(H,De);Ge<Y.length;Ge++)xn=ve(De,H,Ge,Y[Ge],he),xn!==null&&(l&&xn.alternate!==null&&De.delete(xn.key===null?Ge:xn.key),W=x(xn,W,Ge),Le===null?Se=xn:Le.sibling=xn,Le=xn);return l&&De.forEach(function(Zo){return c(H,Zo)}),Nt&&hl(H,Ge),Se}function Ie(H,W,Y,he){var Se=ae(Y);if(typeof Se!="function")throw Error(t(150));if(Y=Se.call(Y),Y==null)throw Error(t(151));for(var Le=Se=null,De=W,Ge=W=0,xn=null,st=Y.next();De!==null&&!st.done;Ge++,st=Y.next()){De.index>Ge?(xn=De,De=null):xn=De.sibling;var Zo=re(H,De,st.value,he);if(Zo===null){De===null&&(De=xn);break}l&&De&&Zo.alternate===null&&c(H,De),W=x(Zo,W,Ge),Le===null?Se=Zo:Le.sibling=Zo,Le=Zo,De=xn}if(st.done)return f(H,De),Nt&&hl(H,Ge),Se;if(De===null){for(;!st.done;Ge++,st=Y.next())st=le(H,st.value,he),st!==null&&(W=x(st,W,Ge),Le===null?Se=st:Le.sibling=st,Le=st);return Nt&&hl(H,Ge),Se}for(De=_(H,De);!st.done;Ge++,st=Y.next())st=ve(De,H,Ge,st.value,he),st!==null&&(l&&st.alternate!==null&&De.delete(st.key===null?Ge:st.key),W=x(st,W,Ge),Le===null?Se=st:Le.sibling=st,Le=st);return l&&De.forEach(function($3){return c(H,$3)}),Nt&&hl(H,Ge),Se}function Jt(H,W,Y,he){if(typeof Y=="object"&&Y!==null&&Y.type===M&&Y.key===null&&(Y=Y.props.children),typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case D:e:{for(var Se=Y.key,Le=W;Le!==null;){if(Le.key===Se){if(Se=Y.type,Se===M){if(Le.tag===7){f(H,Le.sibling),W=E(Le,Y.props.children),W.return=H,H=W;break e}}else if(Le.elementType===Se||typeof Se=="object"&&Se!==null&&Se.$$typeof===ye&&tS(Se)===Le.type){f(H,Le.sibling),W=E(Le,Y.props),W.ref=gd(H,Le,Y),W.return=H,H=W;break e}f(H,Le);break}else c(H,Le);Le=Le.sibling}Y.type===M?(W=vl(Y.props.children,H.mode,he,Y.key),W.return=H,H=W):(he=Hm(Y.type,Y.key,Y.props,null,H.mode,he),he.ref=gd(H,W,Y),he.return=H,H=he)}return C(H);case B:e:{for(Le=Y.key;W!==null;){if(W.key===Le)if(W.tag===4&&W.stateNode.containerInfo===Y.containerInfo&&W.stateNode.implementation===Y.implementation){f(H,W.sibling),W=E(W,Y.children||[]),W.return=H,H=W;break e}else{f(H,W);break}else c(H,W);W=W.sibling}W=Dv(Y,H.mode,he),W.return=H,H=W}return C(H);case ye:return Le=Y._init,Jt(H,W,Le(Y._payload),he)}if(vt(Y))return xe(H,W,Y,he);if(ae(Y))return Ie(H,W,Y,he);Im(H,Y)}return typeof Y=="string"&&Y!==""||typeof Y=="number"?(Y=""+Y,W!==null&&W.tag===6?(f(H,W.sibling),W=E(W,Y),W.return=H,H=W):(f(H,W),W=Lv(Y,H.mode,he),W.return=H,H=W),C(H)):f(H,W)}return Jt}var Ju=nS(!0),iS=nS(!1),Sm=jo(null),Am=null,ec=null,zy=null;function $y(){zy=ec=Am=null}function Wy(l){var c=Sm.current;bt(Sm),l._currentValue=c}function Ky(l,c,f){for(;l!==null;){var _=l.alternate;if((l.childLanes&c)!==c?(l.childLanes|=c,_!==null&&(_.childLanes|=c)):_!==null&&(_.childLanes&c)!==c&&(_.childLanes|=c),l===f)break;l=l.return}}function tc(l,c){Am=l,zy=ec=null,l=l.dependencies,l!==null&&l.firstContext!==null&&((l.lanes&c)!==0&&(vi=!0),l.firstContext=null)}function cr(l){var c=l._currentValue;if(zy!==l)if(l={context:l,memoizedValue:c,next:null},ec===null){if(Am===null)throw Error(t(308));ec=l,Am.dependencies={lanes:0,firstContext:l}}else ec=ec.next=l;return c}var dl=null;function qy(l){dl===null?dl=[l]:dl.push(l)}function rS(l,c,f,_){var E=c.interleaved;return E===null?(f.next=f,qy(c)):(f.next=E.next,E.next=f),c.interleaved=f,Qs(l,_)}function Qs(l,c){l.lanes|=c;var f=l.alternate;for(f!==null&&(f.lanes|=c),f=l,l=l.return;l!==null;)l.childLanes|=c,f=l.alternate,f!==null&&(f.childLanes|=c),f=l,l=l.return;return f.tag===3?f.stateNode:null}var zo=!1;function Hy(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function sS(l,c){l=l.updateQueue,c.updateQueue===l&&(c.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,effects:l.effects})}function Js(l,c){return{eventTime:l,lane:c,tag:0,payload:null,callback:null,next:null}}function $o(l,c,f){var _=l.updateQueue;if(_===null)return null;if(_=_.shared,(rt&2)!==0){var E=_.pending;return E===null?c.next=c:(c.next=E.next,E.next=c),_.pending=c,Qs(l,f)}return E=_.interleaved,E===null?(c.next=c,qy(_)):(c.next=E.next,E.next=c),_.interleaved=c,Qs(l,f)}function Rm(l,c,f){if(c=c.updateQueue,c!==null&&(c=c.shared,(f&4194240)!==0)){var _=c.lanes;_&=l.pendingLanes,f|=_,c.lanes=f,Xh(l,f)}}function oS(l,c){var f=l.updateQueue,_=l.alternate;if(_!==null&&(_=_.updateQueue,f===_)){var E=null,x=null;if(f=f.firstBaseUpdate,f!==null){do{var C={eventTime:f.eventTime,lane:f.lane,tag:f.tag,payload:f.payload,callback:f.callback,next:null};x===null?E=x=C:x=x.next=C,f=f.next}while(f!==null);x===null?E=x=c:x=x.next=c}else E=x=c;f={baseState:_.baseState,firstBaseUpdate:E,lastBaseUpdate:x,shared:_.shared,effects:_.effects},l.updateQueue=f;return}l=f.lastBaseUpdate,l===null?f.firstBaseUpdate=c:l.next=c,f.lastBaseUpdate=c}function Pm(l,c,f,_){var E=l.updateQueue;zo=!1;var x=E.firstBaseUpdate,C=E.lastBaseUpdate,j=E.shared.pending;if(j!==null){E.shared.pending=null;var z=j,Z=z.next;z.next=null,C===null?x=Z:C.next=Z,C=z;var oe=l.alternate;oe!==null&&(oe=oe.updateQueue,j=oe.lastBaseUpdate,j!==C&&(j===null?oe.firstBaseUpdate=Z:j.next=Z,oe.lastBaseUpdate=z))}if(x!==null){var le=E.baseState;C=0,oe=Z=z=null,j=x;do{var re=j.lane,ve=j.eventTime;if((_&re)===re){oe!==null&&(oe=oe.next={eventTime:ve,lane:0,tag:j.tag,payload:j.payload,callback:j.callback,next:null});e:{var xe=l,Ie=j;switch(re=c,ve=f,Ie.tag){case 1:if(xe=Ie.payload,typeof xe=="function"){le=xe.call(ve,le,re);break e}le=xe;break e;case 3:xe.flags=xe.flags&-65537|128;case 0:if(xe=Ie.payload,re=typeof xe=="function"?xe.call(ve,le,re):xe,re==null)break e;le=ie({},le,re);break e;case 2:zo=!0}}j.callback!==null&&j.lane!==0&&(l.flags|=64,re=E.effects,re===null?E.effects=[j]:re.push(j))}else ve={eventTime:ve,lane:re,tag:j.tag,payload:j.payload,callback:j.callback,next:null},oe===null?(Z=oe=ve,z=le):oe=oe.next=ve,C|=re;if(j=j.next,j===null){if(j=E.shared.pending,j===null)break;re=j,j=re.next,re.next=null,E.lastBaseUpdate=re,E.shared.pending=null}}while(!0);if(oe===null&&(z=le),E.baseState=z,E.firstBaseUpdate=Z,E.lastBaseUpdate=oe,c=E.shared.interleaved,c!==null){E=c;do C|=E.lane,E=E.next;while(E!==c)}else x===null&&(E.shared.lanes=0);ml|=C,l.lanes=C,l.memoizedState=le}}function aS(l,c,f){if(l=c.effects,c.effects=null,l!==null)for(c=0;c<l.length;c++){var _=l[c],E=_.callback;if(E!==null){if(_.callback=null,_=f,typeof E!="function")throw Error(t(191,E));E.call(_)}}}var md={},ps=jo(md),pd=jo(md),_d=jo(md);function fl(l){if(l===md)throw Error(t(174));return l}function Xy(l,c){switch(Pt(_d,c),Pt(pd,l),Pt(ps,md),l=c.nodeType,l){case 9:case 11:c=(c=c.documentElement)?c.namespaceURI:Pr(null,"");break;default:l=l===8?c.parentNode:c,c=l.namespaceURI||null,l=l.tagName,c=Pr(c,l)}bt(ps),Pt(ps,c)}function nc(){bt(ps),bt(pd),bt(_d)}function lS(l){fl(_d.current);var c=fl(ps.current),f=Pr(c,l.type);c!==f&&(Pt(pd,l),Pt(ps,f))}function Yy(l){pd.current===l&&(bt(ps),bt(pd))}var jt=jo(0);function Cm(l){for(var c=l;c!==null;){if(c.tag===13){var f=c.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||f.data==="$?"||f.data==="$!"))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===l)break;for(;c.sibling===null;){if(c.return===null||c.return===l)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var Zy=[];function Qy(){for(var l=0;l<Zy.length;l++)Zy[l]._workInProgressVersionPrimary=null;Zy.length=0}var Mm=L.ReactCurrentDispatcher,Jy=L.ReactCurrentBatchConfig,gl=0,Ut=null,hn=null,En=null,bm=!1,yd=!1,vd=0,d3=0;function zn(){throw Error(t(321))}function ev(l,c){if(c===null)return!1;for(var f=0;f<c.length&&f<l.length;f++)if(!kr(l[f],c[f]))return!1;return!0}function tv(l,c,f,_,E,x){if(gl=x,Ut=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,Mm.current=l===null||l.memoizedState===null?p3:_3,l=f(_,E),yd){x=0;do{if(yd=!1,vd=0,25<=x)throw Error(t(301));x+=1,En=hn=null,c.updateQueue=null,Mm.current=y3,l=f(_,E)}while(yd)}if(Mm.current=Dm,c=hn!==null&&hn.next!==null,gl=0,En=hn=Ut=null,bm=!1,c)throw Error(t(300));return l}function nv(){var l=vd!==0;return vd=0,l}function _s(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return En===null?Ut.memoizedState=En=l:En=En.next=l,En}function hr(){if(hn===null){var l=Ut.alternate;l=l!==null?l.memoizedState:null}else l=hn.next;var c=En===null?Ut.memoizedState:En.next;if(c!==null)En=c,hn=l;else{if(l===null)throw Error(t(310));hn=l,l={memoizedState:hn.memoizedState,baseState:hn.baseState,baseQueue:hn.baseQueue,queue:hn.queue,next:null},En===null?Ut.memoizedState=En=l:En=En.next=l}return En}function Ed(l,c){return typeof c=="function"?c(l):c}function iv(l){var c=hr(),f=c.queue;if(f===null)throw Error(t(311));f.lastRenderedReducer=l;var _=hn,E=_.baseQueue,x=f.pending;if(x!==null){if(E!==null){var C=E.next;E.next=x.next,x.next=C}_.baseQueue=E=x,f.pending=null}if(E!==null){x=E.next,_=_.baseState;var j=C=null,z=null,Z=x;do{var oe=Z.lane;if((gl&oe)===oe)z!==null&&(z=z.next={lane:0,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null}),_=Z.hasEagerState?Z.eagerState:l(_,Z.action);else{var le={lane:oe,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null};z===null?(j=z=le,C=_):z=z.next=le,Ut.lanes|=oe,ml|=oe}Z=Z.next}while(Z!==null&&Z!==x);z===null?C=_:z.next=j,kr(_,c.memoizedState)||(vi=!0),c.memoizedState=_,c.baseState=C,c.baseQueue=z,f.lastRenderedState=_}if(l=f.interleaved,l!==null){E=l;do x=E.lane,Ut.lanes|=x,ml|=x,E=E.next;while(E!==l)}else E===null&&(f.lanes=0);return[c.memoizedState,f.dispatch]}function rv(l){var c=hr(),f=c.queue;if(f===null)throw Error(t(311));f.lastRenderedReducer=l;var _=f.dispatch,E=f.pending,x=c.memoizedState;if(E!==null){f.pending=null;var C=E=E.next;do x=l(x,C.action),C=C.next;while(C!==E);kr(x,c.memoizedState)||(vi=!0),c.memoizedState=x,c.baseQueue===null&&(c.baseState=x),f.lastRenderedState=x}return[x,_]}function uS(){}function cS(l,c){var f=Ut,_=hr(),E=c(),x=!kr(_.memoizedState,E);if(x&&(_.memoizedState=E,vi=!0),_=_.queue,sv(fS.bind(null,f,_,l),[l]),_.getSnapshot!==c||x||En!==null&&En.memoizedState.tag&1){if(f.flags|=2048,wd(9,dS.bind(null,f,_,E,c),void 0,null),wn===null)throw Error(t(349));(gl&30)!==0||hS(f,c,E)}return E}function hS(l,c,f){l.flags|=16384,l={getSnapshot:c,value:f},c=Ut.updateQueue,c===null?(c={lastEffect:null,stores:null},Ut.updateQueue=c,c.stores=[l]):(f=c.stores,f===null?c.stores=[l]:f.push(l))}function dS(l,c,f,_){c.value=f,c.getSnapshot=_,gS(c)&&mS(l)}function fS(l,c,f){return f(function(){gS(c)&&mS(l)})}function gS(l){var c=l.getSnapshot;l=l.value;try{var f=c();return!kr(l,f)}catch{return!0}}function mS(l){var c=Qs(l,1);c!==null&&Vr(c,l,1,-1)}function pS(l){var c=_s();return typeof l=="function"&&(l=l()),c.memoizedState=c.baseState=l,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ed,lastRenderedState:l},c.queue=l,l=l.dispatch=m3.bind(null,Ut,l),[c.memoizedState,l]}function wd(l,c,f,_){return l={tag:l,create:c,destroy:f,deps:_,next:null},c=Ut.updateQueue,c===null?(c={lastEffect:null,stores:null},Ut.updateQueue=c,c.lastEffect=l.next=l):(f=c.lastEffect,f===null?c.lastEffect=l.next=l:(_=f.next,f.next=l,l.next=_,c.lastEffect=l)),l}function _S(){return hr().memoizedState}function km(l,c,f,_){var E=_s();Ut.flags|=l,E.memoizedState=wd(1|c,f,void 0,_===void 0?null:_)}function Lm(l,c,f,_){var E=hr();_=_===void 0?null:_;var x=void 0;if(hn!==null){var C=hn.memoizedState;if(x=C.destroy,_!==null&&ev(_,C.deps)){E.memoizedState=wd(c,f,x,_);return}}Ut.flags|=l,E.memoizedState=wd(1|c,f,x,_)}function yS(l,c){return km(8390656,8,l,c)}function sv(l,c){return Lm(2048,8,l,c)}function vS(l,c){return Lm(4,2,l,c)}function ES(l,c){return Lm(4,4,l,c)}function wS(l,c){if(typeof c=="function")return l=l(),c(l),function(){c(null)};if(c!=null)return l=l(),c.current=l,function(){c.current=null}}function xS(l,c,f){return f=f!=null?f.concat([l]):null,Lm(4,4,wS.bind(null,c,l),f)}function ov(){}function TS(l,c){var f=hr();c=c===void 0?null:c;var _=f.memoizedState;return _!==null&&c!==null&&ev(c,_[1])?_[0]:(f.memoizedState=[l,c],l)}function IS(l,c){var f=hr();c=c===void 0?null:c;var _=f.memoizedState;return _!==null&&c!==null&&ev(c,_[1])?_[0]:(l=l(),f.memoizedState=[l,c],l)}function SS(l,c,f){return(gl&21)===0?(l.baseState&&(l.baseState=!1,vi=!0),l.memoizedState=f):(kr(f,c)||(f=qh(),Ut.lanes|=f,ml|=f,l.baseState=!0),c)}function f3(l,c){var f=tt;tt=f!==0&&4>f?f:4,l(!0);var _=Jy.transition;Jy.transition={};try{l(!1),c()}finally{tt=f,Jy.transition=_}}function AS(){return hr().memoizedState}function g3(l,c,f){var _=Ho(l);if(f={lane:_,action:f,hasEagerState:!1,eagerState:null,next:null},RS(l))PS(c,f);else if(f=rS(l,c,f,_),f!==null){var E=ai();Vr(f,l,_,E),CS(f,c,_)}}function m3(l,c,f){var _=Ho(l),E={lane:_,action:f,hasEagerState:!1,eagerState:null,next:null};if(RS(l))PS(c,E);else{var x=l.alternate;if(l.lanes===0&&(x===null||x.lanes===0)&&(x=c.lastRenderedReducer,x!==null))try{var C=c.lastRenderedState,j=x(C,f);if(E.hasEagerState=!0,E.eagerState=j,kr(j,C)){var z=c.interleaved;z===null?(E.next=E,qy(c)):(E.next=z.next,z.next=E),c.interleaved=E;return}}catch{}f=rS(l,c,E,_),f!==null&&(E=ai(),Vr(f,l,_,E),CS(f,c,_))}}function RS(l){var c=l.alternate;return l===Ut||c!==null&&c===Ut}function PS(l,c){yd=bm=!0;var f=l.pending;f===null?c.next=c:(c.next=f.next,f.next=c),l.pending=c}function CS(l,c,f){if((f&4194240)!==0){var _=c.lanes;_&=l.pendingLanes,f|=_,c.lanes=f,Xh(l,f)}}var Dm={readContext:cr,useCallback:zn,useContext:zn,useEffect:zn,useImperativeHandle:zn,useInsertionEffect:zn,useLayoutEffect:zn,useMemo:zn,useReducer:zn,useRef:zn,useState:zn,useDebugValue:zn,useDeferredValue:zn,useTransition:zn,useMutableSource:zn,useSyncExternalStore:zn,useId:zn,unstable_isNewReconciler:!1},p3={readContext:cr,useCallback:function(l,c){return _s().memoizedState=[l,c===void 0?null:c],l},useContext:cr,useEffect:yS,useImperativeHandle:function(l,c,f){return f=f!=null?f.concat([l]):null,km(4194308,4,wS.bind(null,c,l),f)},useLayoutEffect:function(l,c){return km(4194308,4,l,c)},useInsertionEffect:function(l,c){return km(4,2,l,c)},useMemo:function(l,c){var f=_s();return c=c===void 0?null:c,l=l(),f.memoizedState=[l,c],l},useReducer:function(l,c,f){var _=_s();return c=f!==void 0?f(c):c,_.memoizedState=_.baseState=c,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:c},_.queue=l,l=l.dispatch=g3.bind(null,Ut,l),[_.memoizedState,l]},useRef:function(l){var c=_s();return l={current:l},c.memoizedState=l},useState:pS,useDebugValue:ov,useDeferredValue:function(l){return _s().memoizedState=l},useTransition:function(){var l=pS(!1),c=l[0];return l=f3.bind(null,l[1]),_s().memoizedState=l,[c,l]},useMutableSource:function(){},useSyncExternalStore:function(l,c,f){var _=Ut,E=_s();if(Nt){if(f===void 0)throw Error(t(407));f=f()}else{if(f=c(),wn===null)throw Error(t(349));(gl&30)!==0||hS(_,c,f)}E.memoizedState=f;var x={value:f,getSnapshot:c};return E.queue=x,yS(fS.bind(null,_,x,l),[l]),_.flags|=2048,wd(9,dS.bind(null,_,x,f,c),void 0,null),f},useId:function(){var l=_s(),c=wn.identifierPrefix;if(Nt){var f=Zs,_=Ys;f=(_&~(1<<32-Ni(_)-1)).toString(32)+f,c=":"+c+"R"+f,f=vd++,0<f&&(c+="H"+f.toString(32)),c+=":"}else f=d3++,c=":"+c+"r"+f.toString(32)+":";return l.memoizedState=c},unstable_isNewReconciler:!1},_3={readContext:cr,useCallback:TS,useContext:cr,useEffect:sv,useImperativeHandle:xS,useInsertionEffect:vS,useLayoutEffect:ES,useMemo:IS,useReducer:iv,useRef:_S,useState:function(){return iv(Ed)},useDebugValue:ov,useDeferredValue:function(l){var c=hr();return SS(c,hn.memoizedState,l)},useTransition:function(){var l=iv(Ed)[0],c=hr().memoizedState;return[l,c]},useMutableSource:uS,useSyncExternalStore:cS,useId:AS,unstable_isNewReconciler:!1},y3={readContext:cr,useCallback:TS,useContext:cr,useEffect:sv,useImperativeHandle:xS,useInsertionEffect:vS,useLayoutEffect:ES,useMemo:IS,useReducer:rv,useRef:_S,useState:function(){return rv(Ed)},useDebugValue:ov,useDeferredValue:function(l){var c=hr();return hn===null?c.memoizedState=l:SS(c,hn.memoizedState,l)},useTransition:function(){var l=rv(Ed)[0],c=hr().memoizedState;return[l,c]},useMutableSource:uS,useSyncExternalStore:cS,useId:AS,unstable_isNewReconciler:!1};function Dr(l,c){if(l&&l.defaultProps){c=ie({},c),l=l.defaultProps;for(var f in l)c[f]===void 0&&(c[f]=l[f]);return c}return c}function av(l,c,f,_){c=l.memoizedState,f=f(_,c),f=f==null?c:ie({},c,f),l.memoizedState=f,l.lanes===0&&(l.updateQueue.baseState=f)}var Nm={isMounted:function(l){return(l=l._reactInternals)?Mr(l)===l:!1},enqueueSetState:function(l,c,f){l=l._reactInternals;var _=ai(),E=Ho(l),x=Js(_,E);x.payload=c,f!=null&&(x.callback=f),c=$o(l,x,E),c!==null&&(Vr(c,l,E,_),Rm(c,l,E))},enqueueReplaceState:function(l,c,f){l=l._reactInternals;var _=ai(),E=Ho(l),x=Js(_,E);x.tag=1,x.payload=c,f!=null&&(x.callback=f),c=$o(l,x,E),c!==null&&(Vr(c,l,E,_),Rm(c,l,E))},enqueueForceUpdate:function(l,c){l=l._reactInternals;var f=ai(),_=Ho(l),E=Js(f,_);E.tag=2,c!=null&&(E.callback=c),c=$o(l,E,_),c!==null&&(Vr(c,l,_,f),Rm(c,l,_))}};function MS(l,c,f,_,E,x,C){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(_,x,C):c.prototype&&c.prototype.isPureReactComponent?!ad(f,_)||!ad(E,x):!0}function bS(l,c,f){var _=!1,E=Uo,x=c.contextType;return typeof x=="object"&&x!==null?x=cr(x):(E=yi(c)?ul:Bn.current,_=c.contextTypes,x=(_=_!=null)?Xu(l,E):Uo),c=new c(f,x),l.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=Nm,l.stateNode=c,c._reactInternals=l,_&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=E,l.__reactInternalMemoizedMaskedChildContext=x),c}function kS(l,c,f,_){l=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(f,_),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(f,_),c.state!==l&&Nm.enqueueReplaceState(c,c.state,null)}function lv(l,c,f,_){var E=l.stateNode;E.props=f,E.state=l.memoizedState,E.refs={},Hy(l);var x=c.contextType;typeof x=="object"&&x!==null?E.context=cr(x):(x=yi(c)?ul:Bn.current,E.context=Xu(l,x)),E.state=l.memoizedState,x=c.getDerivedStateFromProps,typeof x=="function"&&(av(l,c,x,f),E.state=l.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof E.getSnapshotBeforeUpdate=="function"||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(c=E.state,typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount(),c!==E.state&&Nm.enqueueReplaceState(E,E.state,null),Pm(l,f,E,_),E.state=l.memoizedState),typeof E.componentDidMount=="function"&&(l.flags|=4194308)}function ic(l,c){try{var f="",_=c;do f+=Pe(_),_=_.return;while(_);var E=f}catch(x){E=`
Error generating stack: `+x.message+`
`+x.stack}return{value:l,source:c,stack:E,digest:null}}function uv(l,c,f){return{value:l,source:null,stack:f??null,digest:c??null}}function cv(l,c){try{console.error(c.value)}catch(f){setTimeout(function(){throw f})}}var v3=typeof WeakMap=="function"?WeakMap:Map;function LS(l,c,f){f=Js(-1,f),f.tag=3,f.payload={element:null};var _=c.value;return f.callback=function(){Bm||(Bm=!0,Sv=_),cv(l,c)},f}function DS(l,c,f){f=Js(-1,f),f.tag=3;var _=l.type.getDerivedStateFromError;if(typeof _=="function"){var E=c.value;f.payload=function(){return _(E)},f.callback=function(){cv(l,c)}}var x=l.stateNode;return x!==null&&typeof x.componentDidCatch=="function"&&(f.callback=function(){cv(l,c),typeof _!="function"&&(Ko===null?Ko=new Set([this]):Ko.add(this));var C=c.stack;this.componentDidCatch(c.value,{componentStack:C!==null?C:""})}),f}function NS(l,c,f){var _=l.pingCache;if(_===null){_=l.pingCache=new v3;var E=new Set;_.set(c,E)}else E=_.get(c),E===void 0&&(E=new Set,_.set(c,E));E.has(f)||(E.add(f),l=L3.bind(null,l,c,f),c.then(l,l))}function OS(l){do{var c;if((c=l.tag===13)&&(c=l.memoizedState,c=c!==null?c.dehydrated!==null:!0),c)return l;l=l.return}while(l!==null);return null}function VS(l,c,f,_,E){return(l.mode&1)===0?(l===c?l.flags|=65536:(l.flags|=128,f.flags|=131072,f.flags&=-52805,f.tag===1&&(f.alternate===null?f.tag=17:(c=Js(-1,1),c.tag=2,$o(f,c,1))),f.lanes|=1),l):(l.flags|=65536,l.lanes=E,l)}var E3=L.ReactCurrentOwner,vi=!1;function oi(l,c,f,_){c.child=l===null?iS(c,null,f,_):Ju(c,l.child,f,_)}function FS(l,c,f,_,E){f=f.render;var x=c.ref;return tc(c,E),_=tv(l,c,f,_,x,E),f=nv(),l!==null&&!vi?(c.updateQueue=l.updateQueue,c.flags&=-2053,l.lanes&=~E,eo(l,c,E)):(Nt&&f&&Fy(c),c.flags|=1,oi(l,c,_,E),c.child)}function GS(l,c,f,_,E){if(l===null){var x=f.type;return typeof x=="function"&&!kv(x)&&x.defaultProps===void 0&&f.compare===null&&f.defaultProps===void 0?(c.tag=15,c.type=x,jS(l,c,x,_,E)):(l=Hm(f.type,null,_,c,c.mode,E),l.ref=c.ref,l.return=c,c.child=l)}if(x=l.child,(l.lanes&E)===0){var C=x.memoizedProps;if(f=f.compare,f=f!==null?f:ad,f(C,_)&&l.ref===c.ref)return eo(l,c,E)}return c.flags|=1,l=Yo(x,_),l.ref=c.ref,l.return=c,c.child=l}function jS(l,c,f,_,E){if(l!==null){var x=l.memoizedProps;if(ad(x,_)&&l.ref===c.ref)if(vi=!1,c.pendingProps=_=x,(l.lanes&E)!==0)(l.flags&131072)!==0&&(vi=!0);else return c.lanes=l.lanes,eo(l,c,E)}return hv(l,c,f,_,E)}function US(l,c,f){var _=c.pendingProps,E=_.children,x=l!==null?l.memoizedState:null;if(_.mode==="hidden")if((c.mode&1)===0)c.memoizedState={baseLanes:0,cachePool:null,transitions:null},Pt(sc,Bi),Bi|=f;else{if((f&1073741824)===0)return l=x!==null?x.baseLanes|f:f,c.lanes=c.childLanes=1073741824,c.memoizedState={baseLanes:l,cachePool:null,transitions:null},c.updateQueue=null,Pt(sc,Bi),Bi|=l,null;c.memoizedState={baseLanes:0,cachePool:null,transitions:null},_=x!==null?x.baseLanes:f,Pt(sc,Bi),Bi|=_}else x!==null?(_=x.baseLanes|f,c.memoizedState=null):_=f,Pt(sc,Bi),Bi|=_;return oi(l,c,E,f),c.child}function BS(l,c){var f=c.ref;(l===null&&f!==null||l!==null&&l.ref!==f)&&(c.flags|=512,c.flags|=2097152)}function hv(l,c,f,_,E){var x=yi(f)?ul:Bn.current;return x=Xu(c,x),tc(c,E),f=tv(l,c,f,_,x,E),_=nv(),l!==null&&!vi?(c.updateQueue=l.updateQueue,c.flags&=-2053,l.lanes&=~E,eo(l,c,E)):(Nt&&_&&Fy(c),c.flags|=1,oi(l,c,f,E),c.child)}function zS(l,c,f,_,E){if(yi(f)){var x=!0;vm(c)}else x=!1;if(tc(c,E),c.stateNode===null)Vm(l,c),bS(c,f,_),lv(c,f,_,E),_=!0;else if(l===null){var C=c.stateNode,j=c.memoizedProps;C.props=j;var z=C.context,Z=f.contextType;typeof Z=="object"&&Z!==null?Z=cr(Z):(Z=yi(f)?ul:Bn.current,Z=Xu(c,Z));var oe=f.getDerivedStateFromProps,le=typeof oe=="function"||typeof C.getSnapshotBeforeUpdate=="function";le||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(j!==_||z!==Z)&&kS(c,C,_,Z),zo=!1;var re=c.memoizedState;C.state=re,Pm(c,_,C,E),z=c.memoizedState,j!==_||re!==z||_i.current||zo?(typeof oe=="function"&&(av(c,f,oe,_),z=c.memoizedState),(j=zo||MS(c,f,j,_,re,z,Z))?(le||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount()),typeof C.componentDidMount=="function"&&(c.flags|=4194308)):(typeof C.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=_,c.memoizedState=z),C.props=_,C.state=z,C.context=Z,_=j):(typeof C.componentDidMount=="function"&&(c.flags|=4194308),_=!1)}else{C=c.stateNode,sS(l,c),j=c.memoizedProps,Z=c.type===c.elementType?j:Dr(c.type,j),C.props=Z,le=c.pendingProps,re=C.context,z=f.contextType,typeof z=="object"&&z!==null?z=cr(z):(z=yi(f)?ul:Bn.current,z=Xu(c,z));var ve=f.getDerivedStateFromProps;(oe=typeof ve=="function"||typeof C.getSnapshotBeforeUpdate=="function")||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(j!==le||re!==z)&&kS(c,C,_,z),zo=!1,re=c.memoizedState,C.state=re,Pm(c,_,C,E);var xe=c.memoizedState;j!==le||re!==xe||_i.current||zo?(typeof ve=="function"&&(av(c,f,ve,_),xe=c.memoizedState),(Z=zo||MS(c,f,Z,_,re,xe,z)||!1)?(oe||typeof C.UNSAFE_componentWillUpdate!="function"&&typeof C.componentWillUpdate!="function"||(typeof C.componentWillUpdate=="function"&&C.componentWillUpdate(_,xe,z),typeof C.UNSAFE_componentWillUpdate=="function"&&C.UNSAFE_componentWillUpdate(_,xe,z)),typeof C.componentDidUpdate=="function"&&(c.flags|=4),typeof C.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof C.componentDidUpdate!="function"||j===l.memoizedProps&&re===l.memoizedState||(c.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||j===l.memoizedProps&&re===l.memoizedState||(c.flags|=1024),c.memoizedProps=_,c.memoizedState=xe),C.props=_,C.state=xe,C.context=z,_=Z):(typeof C.componentDidUpdate!="function"||j===l.memoizedProps&&re===l.memoizedState||(c.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||j===l.memoizedProps&&re===l.memoizedState||(c.flags|=1024),_=!1)}return dv(l,c,f,_,x,E)}function dv(l,c,f,_,E,x){BS(l,c);var C=(c.flags&128)!==0;if(!_&&!C)return E&&HI(c,f,!1),eo(l,c,x);_=c.stateNode,E3.current=c;var j=C&&typeof f.getDerivedStateFromError!="function"?null:_.render();return c.flags|=1,l!==null&&C?(c.child=Ju(c,l.child,null,x),c.child=Ju(c,null,j,x)):oi(l,c,j,x),c.memoizedState=_.state,E&&HI(c,f,!0),c.child}function $S(l){var c=l.stateNode;c.pendingContext?KI(l,c.pendingContext,c.pendingContext!==c.context):c.context&&KI(l,c.context,!1),Xy(l,c.containerInfo)}function WS(l,c,f,_,E){return Qu(),By(E),c.flags|=256,oi(l,c,f,_),c.child}var fv={dehydrated:null,treeContext:null,retryLane:0};function gv(l){return{baseLanes:l,cachePool:null,transitions:null}}function KS(l,c,f){var _=c.pendingProps,E=jt.current,x=!1,C=(c.flags&128)!==0,j;if((j=C)||(j=l!==null&&l.memoizedState===null?!1:(E&2)!==0),j?(x=!0,c.flags&=-129):(l===null||l.memoizedState!==null)&&(E|=1),Pt(jt,E&1),l===null)return Uy(c),l=c.memoizedState,l!==null&&(l=l.dehydrated,l!==null)?((c.mode&1)===0?c.lanes=1:l.data==="$!"?c.lanes=8:c.lanes=1073741824,null):(C=_.children,l=_.fallback,x?(_=c.mode,x=c.child,C={mode:"hidden",children:C},(_&1)===0&&x!==null?(x.childLanes=0,x.pendingProps=C):x=Xm(C,_,0,null),l=vl(l,_,f,null),x.return=c,l.return=c,x.sibling=l,c.child=x,c.child.memoizedState=gv(f),c.memoizedState=fv,l):mv(c,C));if(E=l.memoizedState,E!==null&&(j=E.dehydrated,j!==null))return w3(l,c,C,_,j,E,f);if(x){x=_.fallback,C=c.mode,E=l.child,j=E.sibling;var z={mode:"hidden",children:_.children};return(C&1)===0&&c.child!==E?(_=c.child,_.childLanes=0,_.pendingProps=z,c.deletions=null):(_=Yo(E,z),_.subtreeFlags=E.subtreeFlags&14680064),j!==null?x=Yo(j,x):(x=vl(x,C,f,null),x.flags|=2),x.return=c,_.return=c,_.sibling=x,c.child=_,_=x,x=c.child,C=l.child.memoizedState,C=C===null?gv(f):{baseLanes:C.baseLanes|f,cachePool:null,transitions:C.transitions},x.memoizedState=C,x.childLanes=l.childLanes&~f,c.memoizedState=fv,_}return x=l.child,l=x.sibling,_=Yo(x,{mode:"visible",children:_.children}),(c.mode&1)===0&&(_.lanes=f),_.return=c,_.sibling=null,l!==null&&(f=c.deletions,f===null?(c.deletions=[l],c.flags|=16):f.push(l)),c.child=_,c.memoizedState=null,_}function mv(l,c){return c=Xm({mode:"visible",children:c},l.mode,0,null),c.return=l,l.child=c}function Om(l,c,f,_){return _!==null&&By(_),Ju(c,l.child,null,f),l=mv(c,c.pendingProps.children),l.flags|=2,c.memoizedState=null,l}function w3(l,c,f,_,E,x,C){if(f)return c.flags&256?(c.flags&=-257,_=uv(Error(t(422))),Om(l,c,C,_)):c.memoizedState!==null?(c.child=l.child,c.flags|=128,null):(x=_.fallback,E=c.mode,_=Xm({mode:"visible",children:_.children},E,0,null),x=vl(x,E,C,null),x.flags|=2,_.return=c,x.return=c,_.sibling=x,c.child=_,(c.mode&1)!==0&&Ju(c,l.child,null,C),c.child.memoizedState=gv(C),c.memoizedState=fv,x);if((c.mode&1)===0)return Om(l,c,C,null);if(E.data==="$!"){if(_=E.nextSibling&&E.nextSibling.dataset,_)var j=_.dgst;return _=j,x=Error(t(419)),_=uv(x,_,void 0),Om(l,c,C,_)}if(j=(C&l.childLanes)!==0,vi||j){if(_=wn,_!==null){switch(C&-C){case 4:E=2;break;case 16:E=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:E=32;break;case 536870912:E=268435456;break;default:E=0}E=(E&(_.suspendedLanes|C))!==0?0:E,E!==0&&E!==x.retryLane&&(x.retryLane=E,Qs(l,E),Vr(_,l,E,-1))}return bv(),_=uv(Error(t(421))),Om(l,c,C,_)}return E.data==="$?"?(c.flags|=128,c.child=l.child,c=D3.bind(null,l),E._reactRetry=c,null):(l=x.treeContext,Ui=Go(E.nextSibling),ji=c,Nt=!0,Lr=null,l!==null&&(lr[ur++]=Ys,lr[ur++]=Zs,lr[ur++]=cl,Ys=l.id,Zs=l.overflow,cl=c),c=mv(c,_.children),c.flags|=4096,c)}function qS(l,c,f){l.lanes|=c;var _=l.alternate;_!==null&&(_.lanes|=c),Ky(l.return,c,f)}function pv(l,c,f,_,E){var x=l.memoizedState;x===null?l.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:_,tail:f,tailMode:E}:(x.isBackwards=c,x.rendering=null,x.renderingStartTime=0,x.last=_,x.tail=f,x.tailMode=E)}function HS(l,c,f){var _=c.pendingProps,E=_.revealOrder,x=_.tail;if(oi(l,c,_.children,f),_=jt.current,(_&2)!==0)_=_&1|2,c.flags|=128;else{if(l!==null&&(l.flags&128)!==0)e:for(l=c.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&qS(l,f,c);else if(l.tag===19)qS(l,f,c);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===c)break e;for(;l.sibling===null;){if(l.return===null||l.return===c)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}_&=1}if(Pt(jt,_),(c.mode&1)===0)c.memoizedState=null;else switch(E){case"forwards":for(f=c.child,E=null;f!==null;)l=f.alternate,l!==null&&Cm(l)===null&&(E=f),f=f.sibling;f=E,f===null?(E=c.child,c.child=null):(E=f.sibling,f.sibling=null),pv(c,!1,E,f,x);break;case"backwards":for(f=null,E=c.child,c.child=null;E!==null;){if(l=E.alternate,l!==null&&Cm(l)===null){c.child=E;break}l=E.sibling,E.sibling=f,f=E,E=l}pv(c,!0,f,null,x);break;case"together":pv(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function Vm(l,c){(c.mode&1)===0&&l!==null&&(l.alternate=null,c.alternate=null,c.flags|=2)}function eo(l,c,f){if(l!==null&&(c.dependencies=l.dependencies),ml|=c.lanes,(f&c.childLanes)===0)return null;if(l!==null&&c.child!==l.child)throw Error(t(153));if(c.child!==null){for(l=c.child,f=Yo(l,l.pendingProps),c.child=f,f.return=c;l.sibling!==null;)l=l.sibling,f=f.sibling=Yo(l,l.pendingProps),f.return=c;f.sibling=null}return c.child}function x3(l,c,f){switch(c.tag){case 3:$S(c),Qu();break;case 5:lS(c);break;case 1:yi(c.type)&&vm(c);break;case 4:Xy(c,c.stateNode.containerInfo);break;case 10:var _=c.type._context,E=c.memoizedProps.value;Pt(Sm,_._currentValue),_._currentValue=E;break;case 13:if(_=c.memoizedState,_!==null)return _.dehydrated!==null?(Pt(jt,jt.current&1),c.flags|=128,null):(f&c.child.childLanes)!==0?KS(l,c,f):(Pt(jt,jt.current&1),l=eo(l,c,f),l!==null?l.sibling:null);Pt(jt,jt.current&1);break;case 19:if(_=(f&c.childLanes)!==0,(l.flags&128)!==0){if(_)return HS(l,c,f);c.flags|=128}if(E=c.memoizedState,E!==null&&(E.rendering=null,E.tail=null,E.lastEffect=null),Pt(jt,jt.current),_)break;return null;case 22:case 23:return c.lanes=0,US(l,c,f)}return eo(l,c,f)}var XS,_v,YS,ZS;XS=function(l,c){for(var f=c.child;f!==null;){if(f.tag===5||f.tag===6)l.appendChild(f.stateNode);else if(f.tag!==4&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===c)break;for(;f.sibling===null;){if(f.return===null||f.return===c)return;f=f.return}f.sibling.return=f.return,f=f.sibling}},_v=function(){},YS=function(l,c,f,_){var E=l.memoizedProps;if(E!==_){l=c.stateNode,fl(ps.current);var x=null;switch(f){case"input":E=mi(l,E),_=mi(l,_),x=[];break;case"select":E=ie({},E,{value:void 0}),_=ie({},_,{value:void 0}),x=[];break;case"textarea":E=tr(l,E),_=tr(l,_),x=[];break;default:typeof E.onClick!="function"&&typeof _.onClick=="function"&&(l.onclick=pm)}ii(f,_);var C;f=null;for(Z in E)if(!_.hasOwnProperty(Z)&&E.hasOwnProperty(Z)&&E[Z]!=null)if(Z==="style"){var j=E[Z];for(C in j)j.hasOwnProperty(C)&&(f||(f={}),f[C]="")}else Z!=="dangerouslySetInnerHTML"&&Z!=="children"&&Z!=="suppressContentEditableWarning"&&Z!=="suppressHydrationWarning"&&Z!=="autoFocus"&&(r.hasOwnProperty(Z)?x||(x=[]):(x=x||[]).push(Z,null));for(Z in _){var z=_[Z];if(j=E?.[Z],_.hasOwnProperty(Z)&&z!==j&&(z!=null||j!=null))if(Z==="style")if(j){for(C in j)!j.hasOwnProperty(C)||z&&z.hasOwnProperty(C)||(f||(f={}),f[C]="");for(C in z)z.hasOwnProperty(C)&&j[C]!==z[C]&&(f||(f={}),f[C]=z[C])}else f||(x||(x=[]),x.push(Z,f)),f=z;else Z==="dangerouslySetInnerHTML"?(z=z?z.__html:void 0,j=j?j.__html:void 0,z!=null&&j!==z&&(x=x||[]).push(Z,z)):Z==="children"?typeof z!="string"&&typeof z!="number"||(x=x||[]).push(Z,""+z):Z!=="suppressContentEditableWarning"&&Z!=="suppressHydrationWarning"&&(r.hasOwnProperty(Z)?(z!=null&&Z==="onScroll"&&Mt("scroll",l),x||j===z||(x=[])):(x=x||[]).push(Z,z))}f&&(x=x||[]).push("style",f);var Z=x;(c.updateQueue=Z)&&(c.flags|=4)}},ZS=function(l,c,f,_){f!==_&&(c.flags|=4)};function xd(l,c){if(!Nt)switch(l.tailMode){case"hidden":c=l.tail;for(var f=null;c!==null;)c.alternate!==null&&(f=c),c=c.sibling;f===null?l.tail=null:f.sibling=null;break;case"collapsed":f=l.tail;for(var _=null;f!==null;)f.alternate!==null&&(_=f),f=f.sibling;_===null?c||l.tail===null?l.tail=null:l.tail.sibling=null:_.sibling=null}}function $n(l){var c=l.alternate!==null&&l.alternate.child===l.child,f=0,_=0;if(c)for(var E=l.child;E!==null;)f|=E.lanes|E.childLanes,_|=E.subtreeFlags&14680064,_|=E.flags&14680064,E.return=l,E=E.sibling;else for(E=l.child;E!==null;)f|=E.lanes|E.childLanes,_|=E.subtreeFlags,_|=E.flags,E.return=l,E=E.sibling;return l.subtreeFlags|=_,l.childLanes=f,c}function T3(l,c,f){var _=c.pendingProps;switch(Gy(c),c.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return $n(c),null;case 1:return yi(c.type)&&ym(),$n(c),null;case 3:return _=c.stateNode,nc(),bt(_i),bt(Bn),Qy(),_.pendingContext&&(_.context=_.pendingContext,_.pendingContext=null),(l===null||l.child===null)&&(Tm(c)?c.flags|=4:l===null||l.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,Lr!==null&&(Pv(Lr),Lr=null))),_v(l,c),$n(c),null;case 5:Yy(c);var E=fl(_d.current);if(f=c.type,l!==null&&c.stateNode!=null)YS(l,c,f,_,E),l.ref!==c.ref&&(c.flags|=512,c.flags|=2097152);else{if(!_){if(c.stateNode===null)throw Error(t(166));return $n(c),null}if(l=fl(ps.current),Tm(c)){_=c.stateNode,f=c.type;var x=c.memoizedProps;switch(_[ms]=c,_[dd]=x,l=(c.mode&1)!==0,f){case"dialog":Mt("cancel",_),Mt("close",_);break;case"iframe":case"object":case"embed":Mt("load",_);break;case"video":case"audio":for(E=0;E<ud.length;E++)Mt(ud[E],_);break;case"source":Mt("error",_);break;case"img":case"image":case"link":Mt("error",_),Mt("load",_);break;case"details":Mt("toggle",_);break;case"input":An(_,x),Mt("invalid",_);break;case"select":_._wrapperState={wasMultiple:!!x.multiple},Mt("invalid",_);break;case"textarea":Dt(_,x),Mt("invalid",_)}ii(f,x),E=null;for(var C in x)if(x.hasOwnProperty(C)){var j=x[C];C==="children"?typeof j=="string"?_.textContent!==j&&(x.suppressHydrationWarning!==!0&&mm(_.textContent,j,l),E=["children",j]):typeof j=="number"&&_.textContent!==""+j&&(x.suppressHydrationWarning!==!0&&mm(_.textContent,j,l),E=["children",""+j]):r.hasOwnProperty(C)&&j!=null&&C==="onScroll"&&Mt("scroll",_)}switch(f){case"input":Rr(_),er(_,x,!0);break;case"textarea":Rr(_),nr(_);break;case"select":case"option":break;default:typeof x.onClick=="function"&&(_.onclick=pm)}_=E,c.updateQueue=_,_!==null&&(c.flags|=4)}else{C=E.nodeType===9?E:E.ownerDocument,l==="http://www.w3.org/1999/xhtml"&&(l=Zr(f)),l==="http://www.w3.org/1999/xhtml"?f==="script"?(l=C.createElement("div"),l.innerHTML="<script><\/script>",l=l.removeChild(l.firstChild)):typeof _.is=="string"?l=C.createElement(f,{is:_.is}):(l=C.createElement(f),f==="select"&&(C=l,_.multiple?C.multiple=!0:_.size&&(C.size=_.size))):l=C.createElementNS(l,f),l[ms]=c,l[dd]=_,XS(l,c,!1,!1),c.stateNode=l;e:{switch(C=js(f,_),f){case"dialog":Mt("cancel",l),Mt("close",l),E=_;break;case"iframe":case"object":case"embed":Mt("load",l),E=_;break;case"video":case"audio":for(E=0;E<ud.length;E++)Mt(ud[E],l);E=_;break;case"source":Mt("error",l),E=_;break;case"img":case"image":case"link":Mt("error",l),Mt("load",l),E=_;break;case"details":Mt("toggle",l),E=_;break;case"input":An(l,_),E=mi(l,_),Mt("invalid",l);break;case"option":E=_;break;case"select":l._wrapperState={wasMultiple:!!_.multiple},E=ie({},_,{value:void 0}),Mt("invalid",l);break;case"textarea":Dt(l,_),E=tr(l,_),Mt("invalid",l);break;default:E=_}ii(f,E),j=E;for(x in j)if(j.hasOwnProperty(x)){var z=j[x];x==="style"?Gs(l,z):x==="dangerouslySetInnerHTML"?(z=z?z.__html:void 0,z!=null&&Xa(l,z)):x==="children"?typeof z=="string"?(f!=="textarea"||z!=="")&&Jr(l,z):typeof z=="number"&&Jr(l,""+z):x!=="suppressContentEditableWarning"&&x!=="suppressHydrationWarning"&&x!=="autoFocus"&&(r.hasOwnProperty(x)?z!=null&&x==="onScroll"&&Mt("scroll",l):z!=null&&b(l,x,z,C))}switch(f){case"input":Rr(l),er(l,_,!1);break;case"textarea":Rr(l),nr(l);break;case"option":_.value!=null&&l.setAttribute("value",""+Ke(_.value));break;case"select":l.multiple=!!_.multiple,x=_.value,x!=null?yn(l,!!_.multiple,x,!1):_.defaultValue!=null&&yn(l,!!_.multiple,_.defaultValue,!0);break;default:typeof E.onClick=="function"&&(l.onclick=pm)}switch(f){case"button":case"input":case"select":case"textarea":_=!!_.autoFocus;break e;case"img":_=!0;break e;default:_=!1}}_&&(c.flags|=4)}c.ref!==null&&(c.flags|=512,c.flags|=2097152)}return $n(c),null;case 6:if(l&&c.stateNode!=null)ZS(l,c,l.memoizedProps,_);else{if(typeof _!="string"&&c.stateNode===null)throw Error(t(166));if(f=fl(_d.current),fl(ps.current),Tm(c)){if(_=c.stateNode,f=c.memoizedProps,_[ms]=c,(x=_.nodeValue!==f)&&(l=ji,l!==null))switch(l.tag){case 3:mm(_.nodeValue,f,(l.mode&1)!==0);break;case 5:l.memoizedProps.suppressHydrationWarning!==!0&&mm(_.nodeValue,f,(l.mode&1)!==0)}x&&(c.flags|=4)}else _=(f.nodeType===9?f:f.ownerDocument).createTextNode(_),_[ms]=c,c.stateNode=_}return $n(c),null;case 13:if(bt(jt),_=c.memoizedState,l===null||l.memoizedState!==null&&l.memoizedState.dehydrated!==null){if(Nt&&Ui!==null&&(c.mode&1)!==0&&(c.flags&128)===0)eS(),Qu(),c.flags|=98560,x=!1;else if(x=Tm(c),_!==null&&_.dehydrated!==null){if(l===null){if(!x)throw Error(t(318));if(x=c.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(t(317));x[ms]=c}else Qu(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;$n(c),x=!1}else Lr!==null&&(Pv(Lr),Lr=null),x=!0;if(!x)return c.flags&65536?c:null}return(c.flags&128)!==0?(c.lanes=f,c):(_=_!==null,_!==(l!==null&&l.memoizedState!==null)&&_&&(c.child.flags|=8192,(c.mode&1)!==0&&(l===null||(jt.current&1)!==0?dn===0&&(dn=3):bv())),c.updateQueue!==null&&(c.flags|=4),$n(c),null);case 4:return nc(),_v(l,c),l===null&&cd(c.stateNode.containerInfo),$n(c),null;case 10:return Wy(c.type._context),$n(c),null;case 17:return yi(c.type)&&ym(),$n(c),null;case 19:if(bt(jt),x=c.memoizedState,x===null)return $n(c),null;if(_=(c.flags&128)!==0,C=x.rendering,C===null)if(_)xd(x,!1);else{if(dn!==0||l!==null&&(l.flags&128)!==0)for(l=c.child;l!==null;){if(C=Cm(l),C!==null){for(c.flags|=128,xd(x,!1),_=C.updateQueue,_!==null&&(c.updateQueue=_,c.flags|=4),c.subtreeFlags=0,_=f,f=c.child;f!==null;)x=f,l=_,x.flags&=14680066,C=x.alternate,C===null?(x.childLanes=0,x.lanes=l,x.child=null,x.subtreeFlags=0,x.memoizedProps=null,x.memoizedState=null,x.updateQueue=null,x.dependencies=null,x.stateNode=null):(x.childLanes=C.childLanes,x.lanes=C.lanes,x.child=C.child,x.subtreeFlags=0,x.deletions=null,x.memoizedProps=C.memoizedProps,x.memoizedState=C.memoizedState,x.updateQueue=C.updateQueue,x.type=C.type,l=C.dependencies,x.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),f=f.sibling;return Pt(jt,jt.current&1|2),c.child}l=l.sibling}x.tail!==null&&Ct()>oc&&(c.flags|=128,_=!0,xd(x,!1),c.lanes=4194304)}else{if(!_)if(l=Cm(C),l!==null){if(c.flags|=128,_=!0,f=l.updateQueue,f!==null&&(c.updateQueue=f,c.flags|=4),xd(x,!0),x.tail===null&&x.tailMode==="hidden"&&!C.alternate&&!Nt)return $n(c),null}else 2*Ct()-x.renderingStartTime>oc&&f!==1073741824&&(c.flags|=128,_=!0,xd(x,!1),c.lanes=4194304);x.isBackwards?(C.sibling=c.child,c.child=C):(f=x.last,f!==null?f.sibling=C:c.child=C,x.last=C)}return x.tail!==null?(c=x.tail,x.rendering=c,x.tail=c.sibling,x.renderingStartTime=Ct(),c.sibling=null,f=jt.current,Pt(jt,_?f&1|2:f&1),c):($n(c),null);case 22:case 23:return Mv(),_=c.memoizedState!==null,l!==null&&l.memoizedState!==null!==_&&(c.flags|=8192),_&&(c.mode&1)!==0?(Bi&1073741824)!==0&&($n(c),c.subtreeFlags&6&&(c.flags|=8192)):$n(c),null;case 24:return null;case 25:return null}throw Error(t(156,c.tag))}function I3(l,c){switch(Gy(c),c.tag){case 1:return yi(c.type)&&ym(),l=c.flags,l&65536?(c.flags=l&-65537|128,c):null;case 3:return nc(),bt(_i),bt(Bn),Qy(),l=c.flags,(l&65536)!==0&&(l&128)===0?(c.flags=l&-65537|128,c):null;case 5:return Yy(c),null;case 13:if(bt(jt),l=c.memoizedState,l!==null&&l.dehydrated!==null){if(c.alternate===null)throw Error(t(340));Qu()}return l=c.flags,l&65536?(c.flags=l&-65537|128,c):null;case 19:return bt(jt),null;case 4:return nc(),null;case 10:return Wy(c.type._context),null;case 22:case 23:return Mv(),null;case 24:return null;default:return null}}var Fm=!1,Wn=!1,S3=typeof WeakSet=="function"?WeakSet:Set,Ee=null;function rc(l,c){var f=l.ref;if(f!==null)if(typeof f=="function")try{f(null)}catch(_){Wt(l,c,_)}else f.current=null}function yv(l,c,f){try{f()}catch(_){Wt(l,c,_)}}var QS=!1;function A3(l,c){if(My=Ws,l=MI(),xy(l)){if("selectionStart"in l)var f={start:l.selectionStart,end:l.selectionEnd};else e:{f=(f=l.ownerDocument)&&f.defaultView||window;var _=f.getSelection&&f.getSelection();if(_&&_.rangeCount!==0){f=_.anchorNode;var E=_.anchorOffset,x=_.focusNode;_=_.focusOffset;try{f.nodeType,x.nodeType}catch{f=null;break e}var C=0,j=-1,z=-1,Z=0,oe=0,le=l,re=null;t:for(;;){for(var ve;le!==f||E!==0&&le.nodeType!==3||(j=C+E),le!==x||_!==0&&le.nodeType!==3||(z=C+_),le.nodeType===3&&(C+=le.nodeValue.length),(ve=le.firstChild)!==null;)re=le,le=ve;for(;;){if(le===l)break t;if(re===f&&++Z===E&&(j=C),re===x&&++oe===_&&(z=C),(ve=le.nextSibling)!==null)break;le=re,re=le.parentNode}le=ve}f=j===-1||z===-1?null:{start:j,end:z}}else f=null}f=f||{start:0,end:0}}else f=null;for(by={focusedElem:l,selectionRange:f},Ws=!1,Ee=c;Ee!==null;)if(c=Ee,l=c.child,(c.subtreeFlags&1028)!==0&&l!==null)l.return=c,Ee=l;else for(;Ee!==null;){c=Ee;try{var xe=c.alternate;if((c.flags&1024)!==0)switch(c.tag){case 0:case 11:case 15:break;case 1:if(xe!==null){var Ie=xe.memoizedProps,Jt=xe.memoizedState,H=c.stateNode,W=H.getSnapshotBeforeUpdate(c.elementType===c.type?Ie:Dr(c.type,Ie),Jt);H.__reactInternalSnapshotBeforeUpdate=W}break;case 3:var Y=c.stateNode.containerInfo;Y.nodeType===1?Y.textContent="":Y.nodeType===9&&Y.documentElement&&Y.removeChild(Y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(he){Wt(c,c.return,he)}if(l=c.sibling,l!==null){l.return=c.return,Ee=l;break}Ee=c.return}return xe=QS,QS=!1,xe}function Td(l,c,f){var _=c.updateQueue;if(_=_!==null?_.lastEffect:null,_!==null){var E=_=_.next;do{if((E.tag&l)===l){var x=E.destroy;E.destroy=void 0,x!==void 0&&yv(c,f,x)}E=E.next}while(E!==_)}}function Gm(l,c){if(c=c.updateQueue,c=c!==null?c.lastEffect:null,c!==null){var f=c=c.next;do{if((f.tag&l)===l){var _=f.create;f.destroy=_()}f=f.next}while(f!==c)}}function vv(l){var c=l.ref;if(c!==null){var f=l.stateNode;switch(l.tag){case 5:l=f;break;default:l=f}typeof c=="function"?c(l):c.current=l}}function JS(l){var c=l.alternate;c!==null&&(l.alternate=null,JS(c)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(c=l.stateNode,c!==null&&(delete c[ms],delete c[dd],delete c[Ny],delete c[l3],delete c[u3])),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}function e2(l){return l.tag===5||l.tag===3||l.tag===4}function t2(l){e:for(;;){for(;l.sibling===null;){if(l.return===null||e2(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(l.flags&2||l.child===null||l.tag===4)continue e;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function Ev(l,c,f){var _=l.tag;if(_===5||_===6)l=l.stateNode,c?f.nodeType===8?f.parentNode.insertBefore(l,c):f.insertBefore(l,c):(f.nodeType===8?(c=f.parentNode,c.insertBefore(l,f)):(c=f,c.appendChild(l)),f=f._reactRootContainer,f!=null||c.onclick!==null||(c.onclick=pm));else if(_!==4&&(l=l.child,l!==null))for(Ev(l,c,f),l=l.sibling;l!==null;)Ev(l,c,f),l=l.sibling}function wv(l,c,f){var _=l.tag;if(_===5||_===6)l=l.stateNode,c?f.insertBefore(l,c):f.appendChild(l);else if(_!==4&&(l=l.child,l!==null))for(wv(l,c,f),l=l.sibling;l!==null;)wv(l,c,f),l=l.sibling}var Ln=null,Nr=!1;function Wo(l,c,f){for(f=f.child;f!==null;)n2(l,c,f),f=f.sibling}function n2(l,c,f){if(Di&&typeof Di.onCommitFiberUnmount=="function")try{Di.onCommitFiberUnmount(Ja,f)}catch{}switch(f.tag){case 5:Wn||rc(f,c);case 6:var _=Ln,E=Nr;Ln=null,Wo(l,c,f),Ln=_,Nr=E,Ln!==null&&(Nr?(l=Ln,f=f.stateNode,l.nodeType===8?l.parentNode.removeChild(f):l.removeChild(f)):Ln.removeChild(f.stateNode));break;case 18:Ln!==null&&(Nr?(l=Ln,f=f.stateNode,l.nodeType===8?Dy(l.parentNode,f):l.nodeType===1&&Dy(l,f),No(l)):Dy(Ln,f.stateNode));break;case 4:_=Ln,E=Nr,Ln=f.stateNode.containerInfo,Nr=!0,Wo(l,c,f),Ln=_,Nr=E;break;case 0:case 11:case 14:case 15:if(!Wn&&(_=f.updateQueue,_!==null&&(_=_.lastEffect,_!==null))){E=_=_.next;do{var x=E,C=x.destroy;x=x.tag,C!==void 0&&((x&2)!==0||(x&4)!==0)&&yv(f,c,C),E=E.next}while(E!==_)}Wo(l,c,f);break;case 1:if(!Wn&&(rc(f,c),_=f.stateNode,typeof _.componentWillUnmount=="function"))try{_.props=f.memoizedProps,_.state=f.memoizedState,_.componentWillUnmount()}catch(j){Wt(f,c,j)}Wo(l,c,f);break;case 21:Wo(l,c,f);break;case 22:f.mode&1?(Wn=(_=Wn)||f.memoizedState!==null,Wo(l,c,f),Wn=_):Wo(l,c,f);break;default:Wo(l,c,f)}}function i2(l){var c=l.updateQueue;if(c!==null){l.updateQueue=null;var f=l.stateNode;f===null&&(f=l.stateNode=new S3),c.forEach(function(_){var E=N3.bind(null,l,_);f.has(_)||(f.add(_),_.then(E,E))})}}function Or(l,c){var f=c.deletions;if(f!==null)for(var _=0;_<f.length;_++){var E=f[_];try{var x=l,C=c,j=C;e:for(;j!==null;){switch(j.tag){case 5:Ln=j.stateNode,Nr=!1;break e;case 3:Ln=j.stateNode.containerInfo,Nr=!0;break e;case 4:Ln=j.stateNode.containerInfo,Nr=!0;break e}j=j.return}if(Ln===null)throw Error(t(160));n2(x,C,E),Ln=null,Nr=!1;var z=E.alternate;z!==null&&(z.return=null),E.return=null}catch(Z){Wt(E,c,Z)}}if(c.subtreeFlags&12854)for(c=c.child;c!==null;)r2(c,l),c=c.sibling}function r2(l,c){var f=l.alternate,_=l.flags;switch(l.tag){case 0:case 11:case 14:case 15:if(Or(c,l),ys(l),_&4){try{Td(3,l,l.return),Gm(3,l)}catch(Ie){Wt(l,l.return,Ie)}try{Td(5,l,l.return)}catch(Ie){Wt(l,l.return,Ie)}}break;case 1:Or(c,l),ys(l),_&512&&f!==null&&rc(f,f.return);break;case 5:if(Or(c,l),ys(l),_&512&&f!==null&&rc(f,f.return),l.flags&32){var E=l.stateNode;try{Jr(E,"")}catch(Ie){Wt(l,l.return,Ie)}}if(_&4&&(E=l.stateNode,E!=null)){var x=l.memoizedProps,C=f!==null?f.memoizedProps:x,j=l.type,z=l.updateQueue;if(l.updateQueue=null,z!==null)try{j==="input"&&x.type==="radio"&&x.name!=null&&Rn(E,x),js(j,C);var Z=js(j,x);for(C=0;C<z.length;C+=2){var oe=z[C],le=z[C+1];oe==="style"?Gs(E,le):oe==="dangerouslySetInnerHTML"?Xa(E,le):oe==="children"?Jr(E,le):b(E,oe,le,Z)}switch(j){case"input":pi(E,x);break;case"textarea":Co(E,x);break;case"select":var re=E._wrapperState.wasMultiple;E._wrapperState.wasMultiple=!!x.multiple;var ve=x.value;ve!=null?yn(E,!!x.multiple,ve,!1):re!==!!x.multiple&&(x.defaultValue!=null?yn(E,!!x.multiple,x.defaultValue,!0):yn(E,!!x.multiple,x.multiple?[]:"",!1))}E[dd]=x}catch(Ie){Wt(l,l.return,Ie)}}break;case 6:if(Or(c,l),ys(l),_&4){if(l.stateNode===null)throw Error(t(162));E=l.stateNode,x=l.memoizedProps;try{E.nodeValue=x}catch(Ie){Wt(l,l.return,Ie)}}break;case 3:if(Or(c,l),ys(l),_&4&&f!==null&&f.memoizedState.isDehydrated)try{No(c.containerInfo)}catch(Ie){Wt(l,l.return,Ie)}break;case 4:Or(c,l),ys(l);break;case 13:Or(c,l),ys(l),E=l.child,E.flags&8192&&(x=E.memoizedState!==null,E.stateNode.isHidden=x,!x||E.alternate!==null&&E.alternate.memoizedState!==null||(Iv=Ct())),_&4&&i2(l);break;case 22:if(oe=f!==null&&f.memoizedState!==null,l.mode&1?(Wn=(Z=Wn)||oe,Or(c,l),Wn=Z):Or(c,l),ys(l),_&8192){if(Z=l.memoizedState!==null,(l.stateNode.isHidden=Z)&&!oe&&(l.mode&1)!==0)for(Ee=l,oe=l.child;oe!==null;){for(le=Ee=oe;Ee!==null;){switch(re=Ee,ve=re.child,re.tag){case 0:case 11:case 14:case 15:Td(4,re,re.return);break;case 1:rc(re,re.return);var xe=re.stateNode;if(typeof xe.componentWillUnmount=="function"){_=re,f=re.return;try{c=_,xe.props=c.memoizedProps,xe.state=c.memoizedState,xe.componentWillUnmount()}catch(Ie){Wt(_,f,Ie)}}break;case 5:rc(re,re.return);break;case 22:if(re.memoizedState!==null){a2(le);continue}}ve!==null?(ve.return=re,Ee=ve):a2(le)}oe=oe.sibling}e:for(oe=null,le=l;;){if(le.tag===5){if(oe===null){oe=le;try{E=le.stateNode,Z?(x=E.style,typeof x.setProperty=="function"?x.setProperty("display","none","important"):x.display="none"):(j=le.stateNode,z=le.memoizedProps.style,C=z!=null&&z.hasOwnProperty("display")?z.display:null,j.style.display=es("display",C))}catch(Ie){Wt(l,l.return,Ie)}}}else if(le.tag===6){if(oe===null)try{le.stateNode.nodeValue=Z?"":le.memoizedProps}catch(Ie){Wt(l,l.return,Ie)}}else if((le.tag!==22&&le.tag!==23||le.memoizedState===null||le===l)&&le.child!==null){le.child.return=le,le=le.child;continue}if(le===l)break e;for(;le.sibling===null;){if(le.return===null||le.return===l)break e;oe===le&&(oe=null),le=le.return}oe===le&&(oe=null),le.sibling.return=le.return,le=le.sibling}}break;case 19:Or(c,l),ys(l),_&4&&i2(l);break;case 21:break;default:Or(c,l),ys(l)}}function ys(l){var c=l.flags;if(c&2){try{e:{for(var f=l.return;f!==null;){if(e2(f)){var _=f;break e}f=f.return}throw Error(t(160))}switch(_.tag){case 5:var E=_.stateNode;_.flags&32&&(Jr(E,""),_.flags&=-33);var x=t2(l);wv(l,x,E);break;case 3:case 4:var C=_.stateNode.containerInfo,j=t2(l);Ev(l,j,C);break;default:throw Error(t(161))}}catch(z){Wt(l,l.return,z)}l.flags&=-3}c&4096&&(l.flags&=-4097)}function R3(l,c,f){Ee=l,s2(l)}function s2(l,c,f){for(var _=(l.mode&1)!==0;Ee!==null;){var E=Ee,x=E.child;if(E.tag===22&&_){var C=E.memoizedState!==null||Fm;if(!C){var j=E.alternate,z=j!==null&&j.memoizedState!==null||Wn;j=Fm;var Z=Wn;if(Fm=C,(Wn=z)&&!Z)for(Ee=E;Ee!==null;)C=Ee,z=C.child,C.tag===22&&C.memoizedState!==null?l2(E):z!==null?(z.return=C,Ee=z):l2(E);for(;x!==null;)Ee=x,s2(x),x=x.sibling;Ee=E,Fm=j,Wn=Z}o2(l)}else(E.subtreeFlags&8772)!==0&&x!==null?(x.return=E,Ee=x):o2(l)}}function o2(l){for(;Ee!==null;){var c=Ee;if((c.flags&8772)!==0){var f=c.alternate;try{if((c.flags&8772)!==0)switch(c.tag){case 0:case 11:case 15:Wn||Gm(5,c);break;case 1:var _=c.stateNode;if(c.flags&4&&!Wn)if(f===null)_.componentDidMount();else{var E=c.elementType===c.type?f.memoizedProps:Dr(c.type,f.memoizedProps);_.componentDidUpdate(E,f.memoizedState,_.__reactInternalSnapshotBeforeUpdate)}var x=c.updateQueue;x!==null&&aS(c,x,_);break;case 3:var C=c.updateQueue;if(C!==null){if(f=null,c.child!==null)switch(c.child.tag){case 5:f=c.child.stateNode;break;case 1:f=c.child.stateNode}aS(c,C,f)}break;case 5:var j=c.stateNode;if(f===null&&c.flags&4){f=j;var z=c.memoizedProps;switch(c.type){case"button":case"input":case"select":case"textarea":z.autoFocus&&f.focus();break;case"img":z.src&&(f.src=z.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(c.memoizedState===null){var Z=c.alternate;if(Z!==null){var oe=Z.memoizedState;if(oe!==null){var le=oe.dehydrated;le!==null&&No(le)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Wn||c.flags&512&&vv(c)}catch(re){Wt(c,c.return,re)}}if(c===l){Ee=null;break}if(f=c.sibling,f!==null){f.return=c.return,Ee=f;break}Ee=c.return}}function a2(l){for(;Ee!==null;){var c=Ee;if(c===l){Ee=null;break}var f=c.sibling;if(f!==null){f.return=c.return,Ee=f;break}Ee=c.return}}function l2(l){for(;Ee!==null;){var c=Ee;try{switch(c.tag){case 0:case 11:case 15:var f=c.return;try{Gm(4,c)}catch(z){Wt(c,f,z)}break;case 1:var _=c.stateNode;if(typeof _.componentDidMount=="function"){var E=c.return;try{_.componentDidMount()}catch(z){Wt(c,E,z)}}var x=c.return;try{vv(c)}catch(z){Wt(c,x,z)}break;case 5:var C=c.return;try{vv(c)}catch(z){Wt(c,C,z)}}}catch(z){Wt(c,c.return,z)}if(c===l){Ee=null;break}var j=c.sibling;if(j!==null){j.return=c.return,Ee=j;break}Ee=c.return}}var P3=Math.ceil,jm=L.ReactCurrentDispatcher,xv=L.ReactCurrentOwner,dr=L.ReactCurrentBatchConfig,rt=0,wn=null,on=null,Dn=0,Bi=0,sc=jo(0),dn=0,Id=null,ml=0,Um=0,Tv=0,Sd=null,Ei=null,Iv=0,oc=1/0,to=null,Bm=!1,Sv=null,Ko=null,zm=!1,qo=null,$m=0,Ad=0,Av=null,Wm=-1,Km=0;function ai(){return(rt&6)!==0?Ct():Wm!==-1?Wm:Wm=Ct()}function Ho(l){return(l.mode&1)===0?1:(rt&2)!==0&&Dn!==0?Dn&-Dn:h3.transition!==null?(Km===0&&(Km=qh()),Km):(l=tt,l!==0||(l=window.event,l=l===void 0?16:Nu(l.type)),l)}function Vr(l,c,f,_){if(50<Ad)throw Ad=0,Av=null,Error(t(185));il(l,f,_),((rt&2)===0||l!==wn)&&(l===wn&&((rt&2)===0&&(Um|=f),dn===4&&Xo(l,Dn)),wi(l,_),f===1&&rt===0&&(c.mode&1)===0&&(oc=Ct()+500,Em&&Bo()))}function wi(l,c){var f=l.callbackNode;nl(l,c);var _=Bs(l,l===wn?Dn:0);if(_===0)f!==null&&Pu(f),l.callbackNode=null,l.callbackPriority=0;else if(c=_&-_,l.callbackPriority!==c){if(f!=null&&Pu(f),c===1)l.tag===0?c3(c2.bind(null,l)):XI(c2.bind(null,l)),o3(function(){(rt&6)===0&&Bo()}),f=null;else{switch(ss(_)){case 1:f=Cu;break;case 4:f=$h;break;case 16:f=Qa;break;case 536870912:f=Mu;break;default:f=Qa}f=y2(f,u2.bind(null,l))}l.callbackPriority=c,l.callbackNode=f}}function u2(l,c){if(Wm=-1,Km=0,(rt&6)!==0)throw Error(t(327));var f=l.callbackNode;if(ac()&&l.callbackNode!==f)return null;var _=Bs(l,l===wn?Dn:0);if(_===0)return null;if((_&30)!==0||(_&l.expiredLanes)!==0||c)c=qm(l,_);else{c=_;var E=rt;rt|=2;var x=d2();(wn!==l||Dn!==c)&&(to=null,oc=Ct()+500,_l(l,c));do try{b3();break}catch(j){h2(l,j)}while(!0);$y(),jm.current=x,rt=E,on!==null?c=0:(wn=null,Dn=0,c=dn)}if(c!==0){if(c===2&&(E=Kh(l),E!==0&&(_=E,c=Rv(l,E))),c===1)throw f=Id,_l(l,0),Xo(l,_),wi(l,Ct()),f;if(c===6)Xo(l,_);else{if(E=l.current.alternate,(_&30)===0&&!C3(E)&&(c=qm(l,_),c===2&&(x=Kh(l),x!==0&&(_=x,c=Rv(l,x))),c===1))throw f=Id,_l(l,0),Xo(l,_),wi(l,Ct()),f;switch(l.finishedWork=E,l.finishedLanes=_,c){case 0:case 1:throw Error(t(345));case 2:yl(l,Ei,to);break;case 3:if(Xo(l,_),(_&130023424)===_&&(c=Iv+500-Ct(),10<c)){if(Bs(l,0)!==0)break;if(E=l.suspendedLanes,(E&_)!==_){ai(),l.pingedLanes|=l.suspendedLanes&E;break}l.timeoutHandle=Ly(yl.bind(null,l,Ei,to),c);break}yl(l,Ei,to);break;case 4:if(Xo(l,_),(_&4194240)===_)break;for(c=l.eventTimes,E=-1;0<_;){var C=31-Ni(_);x=1<<C,C=c[C],C>E&&(E=C),_&=~x}if(_=E,_=Ct()-_,_=(120>_?120:480>_?480:1080>_?1080:1920>_?1920:3e3>_?3e3:4320>_?4320:1960*P3(_/1960))-_,10<_){l.timeoutHandle=Ly(yl.bind(null,l,Ei,to),_);break}yl(l,Ei,to);break;case 5:yl(l,Ei,to);break;default:throw Error(t(329))}}}return wi(l,Ct()),l.callbackNode===f?u2.bind(null,l):null}function Rv(l,c){var f=Sd;return l.current.memoizedState.isDehydrated&&(_l(l,c).flags|=256),l=qm(l,c),l!==2&&(c=Ei,Ei=f,c!==null&&Pv(c)),l}function Pv(l){Ei===null?Ei=l:Ei.push.apply(Ei,l)}function C3(l){for(var c=l;;){if(c.flags&16384){var f=c.updateQueue;if(f!==null&&(f=f.stores,f!==null))for(var _=0;_<f.length;_++){var E=f[_],x=E.getSnapshot;E=E.value;try{if(!kr(x(),E))return!1}catch{return!1}}}if(f=c.child,c.subtreeFlags&16384&&f!==null)f.return=c,c=f;else{if(c===l)break;for(;c.sibling===null;){if(c.return===null||c.return===l)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function Xo(l,c){for(c&=~Tv,c&=~Um,l.suspendedLanes|=c,l.pingedLanes&=~c,l=l.expirationTimes;0<c;){var f=31-Ni(c),_=1<<f;l[f]=-1,c&=~_}}function c2(l){if((rt&6)!==0)throw Error(t(327));ac();var c=Bs(l,0);if((c&1)===0)return wi(l,Ct()),null;var f=qm(l,c);if(l.tag!==0&&f===2){var _=Kh(l);_!==0&&(c=_,f=Rv(l,_))}if(f===1)throw f=Id,_l(l,0),Xo(l,c),wi(l,Ct()),f;if(f===6)throw Error(t(345));return l.finishedWork=l.current.alternate,l.finishedLanes=c,yl(l,Ei,to),wi(l,Ct()),null}function Cv(l,c){var f=rt;rt|=1;try{return l(c)}finally{rt=f,rt===0&&(oc=Ct()+500,Em&&Bo())}}function pl(l){qo!==null&&qo.tag===0&&(rt&6)===0&&ac();var c=rt;rt|=1;var f=dr.transition,_=tt;try{if(dr.transition=null,tt=1,l)return l()}finally{tt=_,dr.transition=f,rt=c,(rt&6)===0&&Bo()}}function Mv(){Bi=sc.current,bt(sc)}function _l(l,c){l.finishedWork=null,l.finishedLanes=0;var f=l.timeoutHandle;if(f!==-1&&(l.timeoutHandle=-1,s3(f)),on!==null)for(f=on.return;f!==null;){var _=f;switch(Gy(_),_.tag){case 1:_=_.type.childContextTypes,_!=null&&ym();break;case 3:nc(),bt(_i),bt(Bn),Qy();break;case 5:Yy(_);break;case 4:nc();break;case 13:bt(jt);break;case 19:bt(jt);break;case 10:Wy(_.type._context);break;case 22:case 23:Mv()}f=f.return}if(wn=l,on=l=Yo(l.current,null),Dn=Bi=c,dn=0,Id=null,Tv=Um=ml=0,Ei=Sd=null,dl!==null){for(c=0;c<dl.length;c++)if(f=dl[c],_=f.interleaved,_!==null){f.interleaved=null;var E=_.next,x=f.pending;if(x!==null){var C=x.next;x.next=E,_.next=C}f.pending=_}dl=null}return l}function h2(l,c){do{var f=on;try{if($y(),Mm.current=Dm,bm){for(var _=Ut.memoizedState;_!==null;){var E=_.queue;E!==null&&(E.pending=null),_=_.next}bm=!1}if(gl=0,En=hn=Ut=null,yd=!1,vd=0,xv.current=null,f===null||f.return===null){dn=1,Id=c,on=null;break}e:{var x=l,C=f.return,j=f,z=c;if(c=Dn,j.flags|=32768,z!==null&&typeof z=="object"&&typeof z.then=="function"){var Z=z,oe=j,le=oe.tag;if((oe.mode&1)===0&&(le===0||le===11||le===15)){var re=oe.alternate;re?(oe.updateQueue=re.updateQueue,oe.memoizedState=re.memoizedState,oe.lanes=re.lanes):(oe.updateQueue=null,oe.memoizedState=null)}var ve=OS(C);if(ve!==null){ve.flags&=-257,VS(ve,C,j,x,c),ve.mode&1&&NS(x,Z,c),c=ve,z=Z;var xe=c.updateQueue;if(xe===null){var Ie=new Set;Ie.add(z),c.updateQueue=Ie}else xe.add(z);break e}else{if((c&1)===0){NS(x,Z,c),bv();break e}z=Error(t(426))}}else if(Nt&&j.mode&1){var Jt=OS(C);if(Jt!==null){(Jt.flags&65536)===0&&(Jt.flags|=256),VS(Jt,C,j,x,c),By(ic(z,j));break e}}x=z=ic(z,j),dn!==4&&(dn=2),Sd===null?Sd=[x]:Sd.push(x),x=C;do{switch(x.tag){case 3:x.flags|=65536,c&=-c,x.lanes|=c;var H=LS(x,z,c);oS(x,H);break e;case 1:j=z;var W=x.type,Y=x.stateNode;if((x.flags&128)===0&&(typeof W.getDerivedStateFromError=="function"||Y!==null&&typeof Y.componentDidCatch=="function"&&(Ko===null||!Ko.has(Y)))){x.flags|=65536,c&=-c,x.lanes|=c;var he=DS(x,j,c);oS(x,he);break e}}x=x.return}while(x!==null)}g2(f)}catch(Se){c=Se,on===f&&f!==null&&(on=f=f.return);continue}break}while(!0)}function d2(){var l=jm.current;return jm.current=Dm,l===null?Dm:l}function bv(){(dn===0||dn===3||dn===2)&&(dn=4),wn===null||(ml&268435455)===0&&(Um&268435455)===0||Xo(wn,Dn)}function qm(l,c){var f=rt;rt|=2;var _=d2();(wn!==l||Dn!==c)&&(to=null,_l(l,c));do try{M3();break}catch(E){h2(l,E)}while(!0);if($y(),rt=f,jm.current=_,on!==null)throw Error(t(261));return wn=null,Dn=0,dn}function M3(){for(;on!==null;)f2(on)}function b3(){for(;on!==null&&!Za();)f2(on)}function f2(l){var c=_2(l.alternate,l,Bi);l.memoizedProps=l.pendingProps,c===null?g2(l):on=c,xv.current=null}function g2(l){var c=l;do{var f=c.alternate;if(l=c.return,(c.flags&32768)===0){if(f=T3(f,c,Bi),f!==null){on=f;return}}else{if(f=I3(f,c),f!==null){f.flags&=32767,on=f;return}if(l!==null)l.flags|=32768,l.subtreeFlags=0,l.deletions=null;else{dn=6,on=null;return}}if(c=c.sibling,c!==null){on=c;return}on=c=l}while(c!==null);dn===0&&(dn=5)}function yl(l,c,f){var _=tt,E=dr.transition;try{dr.transition=null,tt=1,k3(l,c,f,_)}finally{dr.transition=E,tt=_}return null}function k3(l,c,f,_){do ac();while(qo!==null);if((rt&6)!==0)throw Error(t(327));f=l.finishedWork;var E=l.finishedLanes;if(f===null)return null;if(l.finishedWork=null,l.finishedLanes=0,f===l.current)throw Error(t(177));l.callbackNode=null,l.callbackPriority=0;var x=f.lanes|f.childLanes;if(_y(l,x),l===wn&&(on=wn=null,Dn=0),(f.subtreeFlags&2064)===0&&(f.flags&2064)===0||zm||(zm=!0,y2(Qa,function(){return ac(),null})),x=(f.flags&15990)!==0,(f.subtreeFlags&15990)!==0||x){x=dr.transition,dr.transition=null;var C=tt;tt=1;var j=rt;rt|=4,xv.current=null,A3(l,f),r2(f,l),QO(by),Ws=!!My,by=My=null,l.current=f,R3(f),Us(),rt=j,tt=C,dr.transition=x}else l.current=f;if(zm&&(zm=!1,qo=l,$m=E),x=l.pendingLanes,x===0&&(Ko=null),em(f.stateNode),wi(l,Ct()),c!==null)for(_=l.onRecoverableError,f=0;f<c.length;f++)E=c[f],_(E.value,{componentStack:E.stack,digest:E.digest});if(Bm)throw Bm=!1,l=Sv,Sv=null,l;return($m&1)!==0&&l.tag!==0&&ac(),x=l.pendingLanes,(x&1)!==0?l===Av?Ad++:(Ad=0,Av=l):Ad=0,Bo(),null}function ac(){if(qo!==null){var l=ss($m),c=dr.transition,f=tt;try{if(dr.transition=null,tt=16>l?16:l,qo===null)var _=!1;else{if(l=qo,qo=null,$m=0,(rt&6)!==0)throw Error(t(331));var E=rt;for(rt|=4,Ee=l.current;Ee!==null;){var x=Ee,C=x.child;if((Ee.flags&16)!==0){var j=x.deletions;if(j!==null){for(var z=0;z<j.length;z++){var Z=j[z];for(Ee=Z;Ee!==null;){var oe=Ee;switch(oe.tag){case 0:case 11:case 15:Td(8,oe,x)}var le=oe.child;if(le!==null)le.return=oe,Ee=le;else for(;Ee!==null;){oe=Ee;var re=oe.sibling,ve=oe.return;if(JS(oe),oe===Z){Ee=null;break}if(re!==null){re.return=ve,Ee=re;break}Ee=ve}}}var xe=x.alternate;if(xe!==null){var Ie=xe.child;if(Ie!==null){xe.child=null;do{var Jt=Ie.sibling;Ie.sibling=null,Ie=Jt}while(Ie!==null)}}Ee=x}}if((x.subtreeFlags&2064)!==0&&C!==null)C.return=x,Ee=C;else e:for(;Ee!==null;){if(x=Ee,(x.flags&2048)!==0)switch(x.tag){case 0:case 11:case 15:Td(9,x,x.return)}var H=x.sibling;if(H!==null){H.return=x.return,Ee=H;break e}Ee=x.return}}var W=l.current;for(Ee=W;Ee!==null;){C=Ee;var Y=C.child;if((C.subtreeFlags&2064)!==0&&Y!==null)Y.return=C,Ee=Y;else e:for(C=W;Ee!==null;){if(j=Ee,(j.flags&2048)!==0)try{switch(j.tag){case 0:case 11:case 15:Gm(9,j)}}catch(Se){Wt(j,j.return,Se)}if(j===C){Ee=null;break e}var he=j.sibling;if(he!==null){he.return=j.return,Ee=he;break e}Ee=j.return}}if(rt=E,Bo(),Di&&typeof Di.onPostCommitFiberRoot=="function")try{Di.onPostCommitFiberRoot(Ja,l)}catch{}_=!0}return _}finally{tt=f,dr.transition=c}}return!1}function m2(l,c,f){c=ic(f,c),c=LS(l,c,1),l=$o(l,c,1),c=ai(),l!==null&&(il(l,1,c),wi(l,c))}function Wt(l,c,f){if(l.tag===3)m2(l,l,f);else for(;c!==null;){if(c.tag===3){m2(c,l,f);break}else if(c.tag===1){var _=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof _.componentDidCatch=="function"&&(Ko===null||!Ko.has(_))){l=ic(f,l),l=DS(c,l,1),c=$o(c,l,1),l=ai(),c!==null&&(il(c,1,l),wi(c,l));break}}c=c.return}}function L3(l,c,f){var _=l.pingCache;_!==null&&_.delete(c),c=ai(),l.pingedLanes|=l.suspendedLanes&f,wn===l&&(Dn&f)===f&&(dn===4||dn===3&&(Dn&130023424)===Dn&&500>Ct()-Iv?_l(l,0):Tv|=f),wi(l,c)}function p2(l,c){c===0&&((l.mode&1)===0?c=1:(c=ko,ko<<=1,(ko&130023424)===0&&(ko=4194304)));var f=ai();l=Qs(l,c),l!==null&&(il(l,c,f),wi(l,f))}function D3(l){var c=l.memoizedState,f=0;c!==null&&(f=c.retryLane),p2(l,f)}function N3(l,c){var f=0;switch(l.tag){case 13:var _=l.stateNode,E=l.memoizedState;E!==null&&(f=E.retryLane);break;case 19:_=l.stateNode;break;default:throw Error(t(314))}_!==null&&_.delete(c),p2(l,f)}var _2;_2=function(l,c,f){if(l!==null)if(l.memoizedProps!==c.pendingProps||_i.current)vi=!0;else{if((l.lanes&f)===0&&(c.flags&128)===0)return vi=!1,x3(l,c,f);vi=(l.flags&131072)!==0}else vi=!1,Nt&&(c.flags&1048576)!==0&&YI(c,xm,c.index);switch(c.lanes=0,c.tag){case 2:var _=c.type;Vm(l,c),l=c.pendingProps;var E=Xu(c,Bn.current);tc(c,f),E=tv(null,c,_,l,E,f);var x=nv();return c.flags|=1,typeof E=="object"&&E!==null&&typeof E.render=="function"&&E.$$typeof===void 0?(c.tag=1,c.memoizedState=null,c.updateQueue=null,yi(_)?(x=!0,vm(c)):x=!1,c.memoizedState=E.state!==null&&E.state!==void 0?E.state:null,Hy(c),E.updater=Nm,c.stateNode=E,E._reactInternals=c,lv(c,_,l,f),c=dv(null,c,_,!0,x,f)):(c.tag=0,Nt&&x&&Fy(c),oi(null,c,E,f),c=c.child),c;case 16:_=c.elementType;e:{switch(Vm(l,c),l=c.pendingProps,E=_._init,_=E(_._payload),c.type=_,E=c.tag=V3(_),l=Dr(_,l),E){case 0:c=hv(null,c,_,l,f);break e;case 1:c=zS(null,c,_,l,f);break e;case 11:c=FS(null,c,_,l,f);break e;case 14:c=GS(null,c,_,Dr(_.type,l),f);break e}throw Error(t(306,_,""))}return c;case 0:return _=c.type,E=c.pendingProps,E=c.elementType===_?E:Dr(_,E),hv(l,c,_,E,f);case 1:return _=c.type,E=c.pendingProps,E=c.elementType===_?E:Dr(_,E),zS(l,c,_,E,f);case 3:e:{if($S(c),l===null)throw Error(t(387));_=c.pendingProps,x=c.memoizedState,E=x.element,sS(l,c),Pm(c,_,null,f);var C=c.memoizedState;if(_=C.element,x.isDehydrated)if(x={element:_,isDehydrated:!1,cache:C.cache,pendingSuspenseBoundaries:C.pendingSuspenseBoundaries,transitions:C.transitions},c.updateQueue.baseState=x,c.memoizedState=x,c.flags&256){E=ic(Error(t(423)),c),c=WS(l,c,_,f,E);break e}else if(_!==E){E=ic(Error(t(424)),c),c=WS(l,c,_,f,E);break e}else for(Ui=Go(c.stateNode.containerInfo.firstChild),ji=c,Nt=!0,Lr=null,f=iS(c,null,_,f),c.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling;else{if(Qu(),_===E){c=eo(l,c,f);break e}oi(l,c,_,f)}c=c.child}return c;case 5:return lS(c),l===null&&Uy(c),_=c.type,E=c.pendingProps,x=l!==null?l.memoizedProps:null,C=E.children,ky(_,E)?C=null:x!==null&&ky(_,x)&&(c.flags|=32),BS(l,c),oi(l,c,C,f),c.child;case 6:return l===null&&Uy(c),null;case 13:return KS(l,c,f);case 4:return Xy(c,c.stateNode.containerInfo),_=c.pendingProps,l===null?c.child=Ju(c,null,_,f):oi(l,c,_,f),c.child;case 11:return _=c.type,E=c.pendingProps,E=c.elementType===_?E:Dr(_,E),FS(l,c,_,E,f);case 7:return oi(l,c,c.pendingProps,f),c.child;case 8:return oi(l,c,c.pendingProps.children,f),c.child;case 12:return oi(l,c,c.pendingProps.children,f),c.child;case 10:e:{if(_=c.type._context,E=c.pendingProps,x=c.memoizedProps,C=E.value,Pt(Sm,_._currentValue),_._currentValue=C,x!==null)if(kr(x.value,C)){if(x.children===E.children&&!_i.current){c=eo(l,c,f);break e}}else for(x=c.child,x!==null&&(x.return=c);x!==null;){var j=x.dependencies;if(j!==null){C=x.child;for(var z=j.firstContext;z!==null;){if(z.context===_){if(x.tag===1){z=Js(-1,f&-f),z.tag=2;var Z=x.updateQueue;if(Z!==null){Z=Z.shared;var oe=Z.pending;oe===null?z.next=z:(z.next=oe.next,oe.next=z),Z.pending=z}}x.lanes|=f,z=x.alternate,z!==null&&(z.lanes|=f),Ky(x.return,f,c),j.lanes|=f;break}z=z.next}}else if(x.tag===10)C=x.type===c.type?null:x.child;else if(x.tag===18){if(C=x.return,C===null)throw Error(t(341));C.lanes|=f,j=C.alternate,j!==null&&(j.lanes|=f),Ky(C,f,c),C=x.sibling}else C=x.child;if(C!==null)C.return=x;else for(C=x;C!==null;){if(C===c){C=null;break}if(x=C.sibling,x!==null){x.return=C.return,C=x;break}C=C.return}x=C}oi(l,c,E.children,f),c=c.child}return c;case 9:return E=c.type,_=c.pendingProps.children,tc(c,f),E=cr(E),_=_(E),c.flags|=1,oi(l,c,_,f),c.child;case 14:return _=c.type,E=Dr(_,c.pendingProps),E=Dr(_.type,E),GS(l,c,_,E,f);case 15:return jS(l,c,c.type,c.pendingProps,f);case 17:return _=c.type,E=c.pendingProps,E=c.elementType===_?E:Dr(_,E),Vm(l,c),c.tag=1,yi(_)?(l=!0,vm(c)):l=!1,tc(c,f),bS(c,_,E),lv(c,_,E,f),dv(null,c,_,!0,l,f);case 19:return HS(l,c,f);case 22:return US(l,c,f)}throw Error(t(156,c.tag))};function y2(l,c){return zh(l,c)}function O3(l,c,f,_){this.tag=l,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=_,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function fr(l,c,f,_){return new O3(l,c,f,_)}function kv(l){return l=l.prototype,!(!l||!l.isReactComponent)}function V3(l){if(typeof l=="function")return kv(l)?1:0;if(l!=null){if(l=l.$$typeof,l===U)return 11;if(l===we)return 14}return 2}function Yo(l,c){var f=l.alternate;return f===null?(f=fr(l.tag,c,l.key,l.mode),f.elementType=l.elementType,f.type=l.type,f.stateNode=l.stateNode,f.alternate=l,l.alternate=f):(f.pendingProps=c,f.type=l.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=l.flags&14680064,f.childLanes=l.childLanes,f.lanes=l.lanes,f.child=l.child,f.memoizedProps=l.memoizedProps,f.memoizedState=l.memoizedState,f.updateQueue=l.updateQueue,c=l.dependencies,f.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},f.sibling=l.sibling,f.index=l.index,f.ref=l.ref,f}function Hm(l,c,f,_,E,x){var C=2;if(_=l,typeof l=="function")kv(l)&&(C=1);else if(typeof l=="string")C=5;else e:switch(l){case M:return vl(f.children,E,x,c);case A:C=8,E|=8;break;case k:return l=fr(12,f,c,E|2),l.elementType=k,l.lanes=x,l;case N:return l=fr(13,f,c,E),l.elementType=N,l.lanes=x,l;case ue:return l=fr(19,f,c,E),l.elementType=ue,l.lanes=x,l;case de:return Xm(f,E,x,c);default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case F:C=10;break e;case G:C=9;break e;case U:C=11;break e;case we:C=14;break e;case ye:C=16,_=null;break e}throw Error(t(130,l==null?l:typeof l,""))}return c=fr(C,f,c,E),c.elementType=l,c.type=_,c.lanes=x,c}function vl(l,c,f,_){return l=fr(7,l,_,c),l.lanes=f,l}function Xm(l,c,f,_){return l=fr(22,l,_,c),l.elementType=de,l.lanes=f,l.stateNode={isHidden:!1},l}function Lv(l,c,f){return l=fr(6,l,null,c),l.lanes=f,l}function Dv(l,c,f){return c=fr(4,l.children!==null?l.children:[],l.key,c),c.lanes=f,c.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},c}function F3(l,c,f,_,E){this.tag=c,this.containerInfo=l,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Hh(0),this.expirationTimes=Hh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Hh(0),this.identifierPrefix=_,this.onRecoverableError=E,this.mutableSourceEagerHydrationData=null}function Nv(l,c,f,_,E,x,C,j,z){return l=new F3(l,c,f,j,z),c===1?(c=1,x===!0&&(c|=8)):c=0,x=fr(3,null,null,c),l.current=x,x.stateNode=l,x.memoizedState={element:_,isDehydrated:f,cache:null,transitions:null,pendingSuspenseBoundaries:null},Hy(x),l}function G3(l,c,f){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:B,key:_==null?null:""+_,children:l,containerInfo:c,implementation:f}}function v2(l){if(!l)return Uo;l=l._reactInternals;e:{if(Mr(l)!==l||l.tag!==1)throw Error(t(170));var c=l;do{switch(c.tag){case 3:c=c.stateNode.context;break e;case 1:if(yi(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break e}}c=c.return}while(c!==null);throw Error(t(171))}if(l.tag===1){var f=l.type;if(yi(f))return qI(l,f,c)}return c}function E2(l,c,f,_,E,x,C,j,z){return l=Nv(f,_,!0,l,E,x,C,j,z),l.context=v2(null),f=l.current,_=ai(),E=Ho(f),x=Js(_,E),x.callback=c??null,$o(f,x,E),l.current.lanes=E,il(l,E,_),wi(l,_),l}function Ym(l,c,f,_){var E=c.current,x=ai(),C=Ho(E);return f=v2(f),c.context===null?c.context=f:c.pendingContext=f,c=Js(x,C),c.payload={element:l},_=_===void 0?null:_,_!==null&&(c.callback=_),l=$o(E,c,C),l!==null&&(Vr(l,E,C,x),Rm(l,E,C)),C}function Zm(l){if(l=l.current,!l.child)return null;switch(l.child.tag){case 5:return l.child.stateNode;default:return l.child.stateNode}}function w2(l,c){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var f=l.retryLane;l.retryLane=f!==0&&f<c?f:c}}function Ov(l,c){w2(l,c),(l=l.alternate)&&w2(l,c)}function j3(){return null}var x2=typeof reportError=="function"?reportError:function(l){console.error(l)};function Vv(l){this._internalRoot=l}Qm.prototype.render=Vv.prototype.render=function(l){var c=this._internalRoot;if(c===null)throw Error(t(409));Ym(l,c,null,null)},Qm.prototype.unmount=Vv.prototype.unmount=function(){var l=this._internalRoot;if(l!==null){this._internalRoot=null;var c=l.containerInfo;pl(function(){Ym(null,l,null,null)}),c[Hs]=null}};function Qm(l){this._internalRoot=l}Qm.prototype.unstable_scheduleHydration=function(l){if(l){var c=Qh();l={blockedOn:null,target:l,priority:c};for(var f=0;f<Oi.length&&c!==0&&c<Oi[f].priority;f++);Oi.splice(f,0,l),f===0&&Lu(l)}};function Fv(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11)}function Jm(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11&&(l.nodeType!==8||l.nodeValue!==" react-mount-point-unstable "))}function T2(){}function U3(l,c,f,_,E){if(E){if(typeof _=="function"){var x=_;_=function(){var Z=Zm(C);x.call(Z)}}var C=E2(c,_,l,0,null,!1,!1,"",T2);return l._reactRootContainer=C,l[Hs]=C.current,cd(l.nodeType===8?l.parentNode:l),pl(),C}for(;E=l.lastChild;)l.removeChild(E);if(typeof _=="function"){var j=_;_=function(){var Z=Zm(z);j.call(Z)}}var z=Nv(l,0,!1,null,null,!1,!1,"",T2);return l._reactRootContainer=z,l[Hs]=z.current,cd(l.nodeType===8?l.parentNode:l),pl(function(){Ym(c,z,f,_)}),z}function ep(l,c,f,_,E){var x=f._reactRootContainer;if(x){var C=x;if(typeof E=="function"){var j=E;E=function(){var z=Zm(C);j.call(z)}}Ym(c,C,l,E)}else C=U3(f,c,l,E,_);return Zm(C)}Yh=function(l){switch(l.tag){case 3:var c=l.stateNode;if(c.current.memoizedState.isDehydrated){var f=dt(c.pendingLanes);f!==0&&(Xh(c,f|1),wi(c,Ct()),(rt&6)===0&&(oc=Ct()+500,Bo()))}break;case 13:pl(function(){var _=Qs(l,1);if(_!==null){var E=ai();Vr(_,l,1,E)}}),Ov(l,1)}},bu=function(l){if(l.tag===13){var c=Qs(l,134217728);if(c!==null){var f=ai();Vr(c,l,134217728,f)}Ov(l,134217728)}},Zh=function(l){if(l.tag===13){var c=Ho(l),f=Qs(l,c);if(f!==null){var _=ai();Vr(f,l,c,_)}Ov(l,c)}},Qh=function(){return tt},Jh=function(l,c){var f=tt;try{return tt=l,c()}finally{tt=f}},ri=function(l,c,f){switch(c){case"input":if(pi(l,f),c=f.name,f.type==="radio"&&c!=null){for(f=l;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll("input[name="+JSON.stringify(""+c)+'][type="radio"]'),c=0;c<f.length;c++){var _=f[c];if(_!==l&&_.form===l.form){var E=_m(_);if(!E)throw Error(t(90));Fs(_),pi(_,E)}}}break;case"textarea":Co(l,f);break;case"select":c=f.value,c!=null&&yn(l,!!f.multiple,c,!1)}},rr=Cv,Pn=pl;var B3={usingClientEntryPoint:!1,Events:[fd,qu,_m,Cr,Yt,Cv]},Rd={findFiberByHostInstance:ll,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},z3={bundleType:Rd.bundleType,version:Rd.version,rendererPackageName:Rd.rendererPackageName,rendererConfig:Rd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:L.ReactCurrentDispatcher,findHostInstanceByFiber:function(l){return l=Jg(l),l===null?null:l.stateNode},findFiberByHostInstance:Rd.findFiberByHostInstance||j3,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var tp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!tp.isDisabled&&tp.supportsFiber)try{Ja=tp.inject(z3),Di=tp}catch{}}return xi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=B3,xi.createPortal=function(l,c){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Fv(c))throw Error(t(200));return G3(l,c,null,f)},xi.createRoot=function(l,c){if(!Fv(l))throw Error(t(299));var f=!1,_="",E=x2;return c!=null&&(c.unstable_strictMode===!0&&(f=!0),c.identifierPrefix!==void 0&&(_=c.identifierPrefix),c.onRecoverableError!==void 0&&(E=c.onRecoverableError)),c=Nv(l,1,!1,null,null,f,!1,_,E),l[Hs]=c.current,cd(l.nodeType===8?l.parentNode:l),new Vv(c)},xi.findDOMNode=function(l){if(l==null)return null;if(l.nodeType===1)return l;var c=l._reactInternals;if(c===void 0)throw typeof l.render=="function"?Error(t(188)):(l=Object.keys(l).join(","),Error(t(268,l)));return l=Jg(c),l=l===null?null:l.stateNode,l},xi.flushSync=function(l){return pl(l)},xi.hydrate=function(l,c,f){if(!Jm(c))throw Error(t(200));return ep(null,l,c,!0,f)},xi.hydrateRoot=function(l,c,f){if(!Fv(l))throw Error(t(405));var _=f!=null&&f.hydratedSources||null,E=!1,x="",C=x2;if(f!=null&&(f.unstable_strictMode===!0&&(E=!0),f.identifierPrefix!==void 0&&(x=f.identifierPrefix),f.onRecoverableError!==void 0&&(C=f.onRecoverableError)),c=E2(c,null,l,1,f??null,E,!1,x,C),l[Hs]=c.current,cd(l),_)for(l=0;l<_.length;l++)f=_[l],E=f._getVersion,E=E(f._source),c.mutableSourceEagerHydrationData==null?c.mutableSourceEagerHydrationData=[f,E]:c.mutableSourceEagerHydrationData.push(f,E);return new Qm(c)},xi.render=function(l,c,f){if(!Jm(c))throw Error(t(200));return ep(null,l,c,!1,f)},xi.unmountComponentAtNode=function(l){if(!Jm(l))throw Error(t(40));return l._reactRootContainer?(pl(function(){ep(null,null,l,!1,function(){l._reactRootContainer=null,l[Hs]=null})}),!0):!1},xi.unstable_batchedUpdates=Cv,xi.unstable_renderSubtreeIntoContainer=function(l,c,f,_){if(!Jm(f))throw Error(t(200));if(l==null||l._reactInternals===void 0)throw Error(t(38));return ep(l,c,f,!1,_)},xi.version="18.3.1-next-f1338f8080-20240426",xi}var b2;function Z3(){if(b2)return Uv.exports;b2=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Uv.exports=Y3(),Uv.exports}var k2;function Q3(){if(k2)return np;k2=1;var n=Z3();return np.createRoot=n.createRoot,np.hydrateRoot=n.hydrateRoot,np}var J3=Q3();const e5=Lw(J3);var ne=fg();const t5=Lw(ne),Ii={ADD:"add",REMOVE:"remove"},ih={PROPERTYCHANGE:"propertychange"},He={CHANGE:"change",ERROR:"error",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",TOUCHMOVE:"touchmove",WHEEL:"wheel"};class f_{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function n5(n,e,t){let i,r;t=t||co;let s=0,o=n.length,a=!1;for(;s<o;)i=s+(o-s>>1),r=+t(n[i],e),r<0?s=i+1:(o=i,a=!r);return a?s:~s}function co(n,e){return n>e?1:n<e?-1:0}function i5(n,e){return n<e?1:n>e?-1:0}function Dw(n,e,t){if(n[0]<=e)return 0;const i=n.length;if(e<=n[i-1])return i-1;if(typeof t=="function"){for(let r=1;r<i;++r){const s=n[r];if(s===e)return r;if(s<e)return t(e,n[r-1],s)>0?r-1:r}return i-1}if(t>0){for(let r=1;r<i;++r)if(n[r]<e)return r-1;return i-1}if(t<0){for(let r=1;r<i;++r)if(n[r]<=e)return r;return i-1}for(let r=1;r<i;++r){if(n[r]==e)return r;if(n[r]<e)return n[r-1]-e<e-n[r]?r-1:r}return i-1}function r5(n,e,t){for(;e<t;){const i=n[e];n[e]=n[t],n[t]=i,++e,--t}}function g_(n,e){const t=Array.isArray(e)?e:[e],i=t.length;for(let r=0;r<i;r++)n[n.length]=t[r]}function za(n,e){const t=n.length;if(t!==e.length)return!1;for(let i=0;i<t;i++)if(n[i]!==e[i])return!1;return!0}function s5(n,e,t){const i=e||co;return n.every(function(r,s){if(s===0)return!0;const o=i(n[s-1],r);return!(o>0||o===0)})}function Pf(){return!0}function m_(){return!1}function Cf(){}function jM(n){let e,t,i;return function(){const r=Array.prototype.slice.call(arguments);return(!t||this!==i||!za(r,t))&&(i=this,t=r,e=n.apply(this,arguments)),e}}function UM(n){function e(){let t;try{t=n()}catch(i){return Promise.reject(i)}return t instanceof Promise?t:Promise.resolve(t)}return e()}function gg(n){for(const e in n)delete n[e]}function rh(n){let e;for(e in n)return!1;return!e}class Io{constructor(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}let mg=class extends f_{constructor(e){super(),this.eventTarget_=e,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(e,t){if(!e||!t)return;const i=this.listeners_||(this.listeners_={}),r=i[e]||(i[e]=[]);r.includes(t)||r.push(t)}dispatchEvent(e){const t=typeof e=="string",i=t?e:e.type,r=this.listeners_&&this.listeners_[i];if(!r)return;const s=t?new Io(e):e;s.target||(s.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),a=this.pendingRemovals_||(this.pendingRemovals_={});i in o||(o[i]=0,a[i]=0),++o[i];let u;for(let h=0,d=r.length;h<d;++h)if("handleEvent"in r[h]?u=r[h].handleEvent(s):u=r[h].call(this,s),u===!1||s.propagationStopped){u=!1;break}if(--o[i]===0){let h=a[i];for(delete a[i];h--;)this.removeEventListener(i,Cf);delete o[i]}return u}disposeInternal(){this.listeners_&&gg(this.listeners_)}getListeners(e){return this.listeners_&&this.listeners_[e]||void 0}hasListener(e){return this.listeners_?e?e in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(e,t){if(!this.listeners_)return;const i=this.listeners_[e];if(!i)return;const r=i.indexOf(t);r!==-1&&(this.pendingRemovals_&&e in this.pendingRemovals_?(i[r]=Cf,++this.pendingRemovals_[e]):(i.splice(r,1),i.length===0&&delete this.listeners_[e]))}};function at(n,e,t,i,r){if(r){const o=t;t=function(a){return n.removeEventListener(e,t),o.call(i??this,a)}}else i&&i!==n&&(t=t.bind(i));const s={target:n,type:e,listener:t};return n.addEventListener(e,t),s}function r0(n,e,t,i){return at(n,e,t,i,!0)}function Ft(n){n&&n.target&&(n.target.removeEventListener(n.type,n.listener),gg(n))}class pg extends mg{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(He.CHANGE)}getRevision(){return this.revision_}onInternal(e,t){if(Array.isArray(e)){const i=e.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=at(this,e[s],t);return r}return at(this,e,t)}onceInternal(e,t){let i;if(Array.isArray(e)){const r=e.length;i=new Array(r);for(let s=0;s<r;++s)i[s]=r0(this,e[s],t)}else i=r0(this,e,t);return t.ol_key=i,i}unInternal(e,t){const i=t.ol_key;if(i)o5(i);else if(Array.isArray(e))for(let r=0,s=e.length;r<s;++r)this.removeEventListener(e[r],t);else this.removeEventListener(e,t)}}pg.prototype.on;pg.prototype.once;pg.prototype.un;function o5(n){if(Array.isArray(n))for(let e=0,t=n.length;e<t;++e)Ft(n[e]);else Ft(n)}function ot(){throw new Error("Unimplemented abstract method.")}let a5=0;function lt(n){return n.ol_uid||(n.ol_uid=String(++a5))}class L2 extends Io{constructor(e,t,i){super(e),this.key=t,this.oldValue=i}}class Ns extends pg{constructor(e){super(),this.on,this.once,this.un,lt(this),this.values_=null,e!==void 0&&this.setProperties(e)}get(e){let t;return this.values_&&this.values_.hasOwnProperty(e)&&(t=this.values_[e]),t}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(e,t){let i;i=`change:${e}`,this.hasListener(i)&&this.dispatchEvent(new L2(i,e,t)),i=ih.PROPERTYCHANGE,this.hasListener(i)&&this.dispatchEvent(new L2(i,e,t))}addChangeListener(e,t){this.addEventListener(`change:${e}`,t)}removeChangeListener(e,t){this.removeEventListener(`change:${e}`,t)}set(e,t,i){const r=this.values_||(this.values_={});if(i)r[e]=t;else{const s=r[e];r[e]=t,s!==t&&this.notify(e,s)}}setProperties(e,t){for(const i in e)this.set(i,e[i],t)}applyProperties(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}unset(e,t){if(this.values_&&e in this.values_){const i=this.values_[e];delete this.values_[e],rh(this.values_)&&(this.values_=null),t||this.notify(e,i)}}}const D2={LENGTH:"length"};class ip extends Io{constructor(e,t,i){super(e),this.element=t,this.index=i}}class Er extends Ns{constructor(e,t){if(super(),this.on,this.once,this.un,t=t||{},this.unique_=!!t.unique,this.array_=e??[],this.unique_)for(let i=1,r=this.array_.length;i<r;++i)this.assertUnique_(this.array_[i],i);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(e){for(let t=0,i=e.length;t<i;++t)this.push(e[t]);return this}forEach(e){const t=this.array_;for(let i=0,r=t.length;i<r;++i)e(t[i],i,t)}getArray(){return this.array_}item(e){return this.array_[e]}getLength(){return this.get(D2.LENGTH)}insertAt(e,t){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t),this.array_.splice(e,0,t),this.updateLength_(),this.dispatchEvent(new ip(Ii.ADD,t,e))}pop(){return this.removeAt(this.getLength()-1)}push(e){const t=this.getLength();return this.insertAt(t,e),this.getLength()}remove(e){const t=this.array_;for(let i=0,r=t.length;i<r;++i)if(t[i]===e)return this.removeAt(i)}removeAt(e){if(e<0||e>=this.getLength())return;const t=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new ip(Ii.REMOVE,t,e)),t}setAt(e,t){const i=this.getLength();if(e>=i){this.insertAt(e,t);return}if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t,e);const r=this.array_[e];this.array_[e]=t,this.dispatchEvent(new ip(Ii.REMOVE,r,e)),this.dispatchEvent(new ip(Ii.ADD,t,e))}updateLength_(){this.set(D2.LENGTH,this.array_.length)}assertUnique_(e,t){const i=this.array_;for(let r=0,s=i.length;r<s;++r)if(i[r]===e&&r!==t)throw new Error("Duplicate item added to a unique collection")}}function _t(n,e){if(!n)throw new Error(e)}let s0=class BM extends Ns{constructor(e){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),e)if(typeof e.getSimplifiedGeometry=="function"){const t=e;this.setGeometry(t)}else{const t=e;this.setProperties(t)}}clone(){const e=new BM(this.hasProperties()?this.getProperties():null);e.setGeometryName(this.getGeometryName());const t=this.getGeometry();t&&e.setGeometry(t.clone());const i=this.getStyle();return i&&e.setStyle(i),e}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(Ft(this.geometryChangeKey_),this.geometryChangeKey_=null);const e=this.getGeometry();e&&(this.geometryChangeKey_=at(e,He.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(e){this.set(this.geometryName_,e)}setStyle(e){this.style_=e,this.styleFunction_=e?l5(e):void 0,this.changed()}setId(e){this.id_=e,this.changed()}setGeometryName(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}};function l5(n){if(typeof n=="function")return n;let e;return Array.isArray(n)?e=n:(_t(typeof n.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[n]),function(){return e}}const Tn={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function N2(n){const e=Yi();for(let t=0,i=n.length;t<i;++t)af(e,n[t]);return e}function Mf(n,e,t){return t?(t[0]=n[0]-e,t[1]=n[1]-e,t[2]=n[2]+e,t[3]=n[3]+e,t):[n[0]-e,n[1]-e,n[2]+e,n[3]+e]}function zM(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n.slice()}function Nw(n,e,t){let i,r;return e<n[0]?i=n[0]-e:n[2]<e?i=e-n[2]:i=0,t<n[1]?r=n[1]-t:n[3]<t?r=t-n[3]:r=0,i*i+r*r}function sh(n,e){return $M(n,e[0],e[1])}function Ud(n,e){return n[0]<=e[0]&&e[2]<=n[2]&&n[1]<=e[1]&&e[3]<=n[3]}function $M(n,e,t){return n[0]<=e&&e<=n[2]&&n[1]<=t&&t<=n[3]}function Q1(n,e){const t=n[0],i=n[1],r=n[2],s=n[3],o=e[0],a=e[1];let u=Tn.UNKNOWN;return o<t?u=u|Tn.LEFT:o>r&&(u=u|Tn.RIGHT),a<i?u=u|Tn.BELOW:a>s&&(u=u|Tn.ABOVE),u===Tn.UNKNOWN&&(u=Tn.INTERSECTING),u}function Yi(){return[1/0,1/0,-1/0,-1/0]}function ba(n,e,t,i,r){return r?(r[0]=n,r[1]=e,r[2]=t,r[3]=i,r):[n,e,t,i]}function p_(n){return ba(1/0,1/0,-1/0,-1/0,n)}function WM(n,e){const t=n[0],i=n[1];return ba(t,i,t,i,e)}function Ow(n,e,t,i,r){const s=p_(r);return KM(s,n,e,t,i)}function bf(n,e){return n[0]==e[0]&&n[2]==e[2]&&n[1]==e[1]&&n[3]==e[3]}function u5(n,e){return e[0]<n[0]&&(n[0]=e[0]),e[2]>n[2]&&(n[2]=e[2]),e[1]<n[1]&&(n[1]=e[1]),e[3]>n[3]&&(n[3]=e[3]),n}function af(n,e){e[0]<n[0]&&(n[0]=e[0]),e[0]>n[2]&&(n[2]=e[0]),e[1]<n[1]&&(n[1]=e[1]),e[1]>n[3]&&(n[3]=e[1])}function KM(n,e,t,i,r){for(;t<i;t+=r)c5(n,e[t],e[t+1]);return n}function c5(n,e,t){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}function qM(n,e){let t;return t=e(__(n)),t||(t=e(y_(n)),t)||(t=e(v_(n)),t)||(t=e(_u(n)),t)?t:!1}function J1(n){let e=0;return E_(n)||(e=ut(n)*Jn(n)),e}function __(n){return[n[0],n[1]]}function y_(n){return[n[2],n[1]]}function Zl(n){return[(n[0]+n[2])/2,(n[1]+n[3])/2]}function h5(n,e){let t;if(e==="bottom-left")t=__(n);else if(e==="bottom-right")t=y_(n);else if(e==="top-left")t=_u(n);else if(e==="top-right")t=v_(n);else throw new Error("Invalid corner");return t}function eE(n,e,t,i,r){const[s,o,a,u,h,d,g,m]=HM(n,e,t,i);return ba(Math.min(s,a,h,g),Math.min(o,u,d,m),Math.max(s,a,h,g),Math.max(o,u,d,m),r)}function HM(n,e,t,i){const r=e*i[0]/2,s=e*i[1]/2,o=Math.cos(t),a=Math.sin(t),u=r*o,h=r*a,d=s*o,g=s*a,m=n[0],v=n[1];return[m-u+g,v-h-d,m-u-g,v-h+d,m+u-g,v+h+d,m+u+g,v+h-d,m-u+g,v-h-d]}function Jn(n){return n[3]-n[1]}function $l(n,e,t){const i=t||Yi();return Ri(n,e)?(n[0]>e[0]?i[0]=n[0]:i[0]=e[0],n[1]>e[1]?i[1]=n[1]:i[1]=e[1],n[2]<e[2]?i[2]=n[2]:i[2]=e[2],n[3]<e[3]?i[3]=n[3]:i[3]=e[3]):p_(i),i}function _u(n){return[n[0],n[3]]}function v_(n){return[n[2],n[3]]}function ut(n){return n[2]-n[0]}function Ri(n,e){return n[0]<=e[2]&&n[2]>=e[0]&&n[1]<=e[3]&&n[3]>=e[1]}function E_(n){return n[2]<n[0]||n[3]<n[1]}function d5(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n}function f5(n,e,t){let i=!1;const r=Q1(n,e),s=Q1(n,t);if(r===Tn.INTERSECTING||s===Tn.INTERSECTING)i=!0;else{const o=n[0],a=n[1],u=n[2],h=n[3],d=e[0],g=e[1],m=t[0],v=t[1],y=(v-g)/(m-d);let I,w;s&Tn.ABOVE&&!(r&Tn.ABOVE)&&(I=m-(v-h)/y,i=I>=o&&I<=u),!i&&s&Tn.RIGHT&&!(r&Tn.RIGHT)&&(w=v-(m-u)*y,i=w>=a&&w<=h),!i&&s&Tn.BELOW&&!(r&Tn.BELOW)&&(I=m-(v-a)/y,i=I>=o&&I<=u),!i&&s&Tn.LEFT&&!(r&Tn.LEFT)&&(w=v-(m-o)*y,i=w>=a&&w<=h)}return i}function XM(n,e){const t=e.getExtent(),i=Zl(n);if(e.canWrapX()&&(i[0]<t[0]||i[0]>=t[2])){const r=ut(t),o=Math.floor((i[0]-t[0])/r)*r;n[0]-=o,n[2]-=o}return n}function YM(n,e,t){if(e.canWrapX()){const i=e.getExtent();if(!isFinite(n[0])||!isFinite(n[2]))return[[i[0],n[1],i[2],n[3]]];XM(n,e);const r=ut(i);if(ut(n)>r&&!t)return[[i[0],n[1],i[2],n[3]]];if(n[0]<i[0])return[[n[0]+r,n[1],i[2],n[3]],[i[0],n[1],n[2],n[3]]];if(n[2]>i[2])return[[n[0],n[1],i[2],n[3]],[i[0],n[1],n[2]-r,n[3]]]}return[n]}function kt(n,e,t){return Math.min(Math.max(n,e),t)}function g5(n,e,t,i,r,s){const o=r-t,a=s-i;if(o!==0||a!==0){const u=((n-t)*o+(e-i)*a)/(o*o+a*a);u>1?(t=r,i=s):u>0&&(t+=o*u,i+=a*u)}return Wc(n,e,t,i)}function Wc(n,e,t,i){const r=t-n,s=i-e;return r*r+s*s}function m5(n){const e=n.length;for(let i=0;i<e;i++){let r=i,s=Math.abs(n[i][i]);for(let a=i+1;a<e;a++){const u=Math.abs(n[a][i]);u>s&&(s=u,r=a)}if(s===0)return null;const o=n[r];n[r]=n[i],n[i]=o;for(let a=i+1;a<e;a++){const u=-n[a][i]/n[i][i];for(let h=i;h<e+1;h++)i==h?n[a][h]=0:n[a][h]+=u*n[i][h]}}const t=new Array(e);for(let i=e-1;i>=0;i--){t[i]=n[i][e]/n[i][i];for(let r=i-1;r>=0;r--)n[r][e]-=n[r][i]*t[i]}return t}function O2(n){return n*180/Math.PI}function xa(n){return n*Math.PI/180}function Ta(n,e){const t=n%e;return t*e<0?t+e:t}function $i(n,e,t){return n+t*(e-n)}function _g(n,e){const t=Math.pow(10,e);return Math.round(n*t)/t}function V2(n,e){return Math.round(_g(n,e))}function rp(n,e){return Math.floor(_g(n,e))}function sp(n,e){return Math.ceil(_g(n,e))}function tE(n,e,t){if(n>=e&&n<t)return n;const i=t-e;return((n-e)%i+i)%i+e}function ZM(n,e){const t=(""+n).split("."),i=(""+e).split(".");for(let r=0;r<Math.max(t.length,i.length);r++){const s=parseInt(t[r]||"0",10),o=parseInt(i[r]||"0",10);if(s>o)return 1;if(o>s)return-1}return 0}function p5(n,e){return n[0]+=+e[0],n[1]+=+e[1],n}function o0(n,e){let t=!0;for(let i=n.length-1;i>=0;--i)if(n[i]!=e[i]){t=!1;break}return t}function Vw(n,e){const t=Math.cos(e),i=Math.sin(e),r=n[0]*t-n[1]*i,s=n[1]*t+n[0]*i;return n[0]=r,n[1]=s,n}function _5(n,e){return n[0]*=e,n[1]*=e,n}function QM(n,e){if(e.canWrapX()){const t=ut(e.getExtent()),i=JM(n,e,t);i&&(n[0]-=i*t)}return n}function JM(n,e,t){const i=e.getExtent();let r=0;return e.canWrapX()&&(n[0]<i[0]||n[0]>i[2])&&(t=t||ut(i),r=Math.floor((n[0]-i[0])/t)),r}function eb(...n){console.warn(...n)}const Fw={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};let Gw=class{constructor(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||Fw[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(e){this.defaultTileGrid_=e}setExtent(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)}setWorldExtent(e){this.worldExtent_=e}setGetPointResolution(e){this.getPointResolutionFunc_=e}getPointResolutionFunc(){return this.getPointResolutionFunc_}};const yg=6378137,kc=Math.PI*yg,y5=[-kc,-kc,kc,kc],v5=[-180,-85,180,85],op=yg*Math.log(Math.tan(Math.PI/2));class lc extends Gw{constructor(e){super({code:e,units:"m",extent:y5,global:!0,worldExtent:v5,getPointResolution:function(t,i){return t/Math.cosh(i[1]/yg)}})}}const F2=[new lc("EPSG:3857"),new lc("EPSG:102100"),new lc("EPSG:102113"),new lc("EPSG:900913"),new lc("http://www.opengis.net/def/crs/EPSG/0/3857"),new lc("http://www.opengis.net/gml/srs/epsg.xml#3857")];function E5(n,e,t,i){const r=n.length;t=t>1?t:2,i=i??t,e===void 0&&(t>2?e=n.slice():e=new Array(r));for(let s=0;s<r;s+=i){e[s]=kc*n[s]/180;let o=yg*Math.log(Math.tan(Math.PI*(+n[s+1]+90)/360));o>op?o=op:o<-op&&(o=-op),e[s+1]=o}return e}function w5(n,e,t,i){const r=n.length;t=t>1?t:2,i=i??t,e===void 0&&(t>2?e=n.slice():e=new Array(r));for(let s=0;s<r;s+=i)e[s]=180*n[s]/kc,e[s+1]=360*Math.atan(Math.exp(n[s+1]/yg))/Math.PI-90;return e}const x5=6378137,G2=[-180,-90,180,90],T5=Math.PI*x5/180;class El extends Gw{constructor(e,t){super({code:e,units:"degrees",extent:G2,axisOrientation:t,global:!0,metersPerUnit:T5,worldExtent:G2})}}const j2=[new El("CRS:84"),new El("EPSG:4326","neu"),new El("urn:ogc:def:crs:OGC:1.3:CRS84"),new El("urn:ogc:def:crs:OGC:2:84"),new El("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new El("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new El("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let nE={};function I5(n){return nE[n]||nE[n.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function S5(n,e){nE[n]=e}let Kc={};function Ql(n,e,t){const i=n.getCode(),r=e.getCode();i in Kc||(Kc[i]={}),Kc[i][r]=t}function $v(n,e){return n in Kc&&e in Kc[n]?Kc[n][e]:null}const a0=.9996,Ir=.00669438,w_=Ir*Ir,x_=w_*Ir,Vl=Ir/(1-Ir),U2=Math.sqrt(1-Ir),oh=(1-U2)/(1+U2),tb=oh*oh,jw=tb*oh,Uw=jw*oh,nb=Uw*oh,ib=1-Ir/4-3*w_/64-5*x_/256,A5=3*Ir/8+3*w_/32+45*x_/1024,R5=15*w_/256+45*x_/1024,P5=35*x_/3072,C5=3/2*oh-27/32*jw+269/512*nb,M5=21/16*tb-55/32*Uw,b5=151/96*jw-417/128*nb,k5=1097/512*Uw,l0=6378137;function L5(n,e,t){const i=n-5e5,o=(t.north?e:e-1e7)/a0/(l0*ib),a=o+C5*Math.sin(2*o)+M5*Math.sin(4*o)+b5*Math.sin(6*o)+k5*Math.sin(8*o),u=Math.sin(a),h=u*u,d=Math.cos(a),g=u/d,m=g*g,v=m*m,y=1-Ir*h,I=Math.sqrt(1-Ir*h),w=l0/I,R=(1-Ir)/y,P=Vl*d**2,b=P*P,L=i/(w*a0),D=L*L,B=D*L,M=B*L,A=M*L,k=A*L,F=a-g/R*(D/2-M/24*(5+3*m+10*P-4*b-9*Vl))+k/720*(61+90*m+298*P+45*v-252*Vl-3*b);let G=(L-B/6*(1+2*m+P)+A/120*(5-2*P+28*m-3*b+8*Vl+24*v))/d;return G=tE(G+xa(rb(t.number)),-Math.PI,Math.PI),[O2(G),O2(F)]}const B2=-80,z2=84,D5=-180,N5=180;function O5(n,e,t){n=tE(n,D5,N5),e<B2?e=B2:e>z2&&(e=z2);const i=xa(e),r=Math.sin(i),s=Math.cos(i),o=r/s,a=o*o,u=a*a,h=xa(n),d=rb(t.number),g=xa(d),m=l0/Math.sqrt(1-Ir*r**2),v=Vl*s**2,y=s*tE(h-g,-Math.PI,Math.PI),I=y*y,w=I*y,R=w*y,P=R*y,b=P*y,L=l0*(ib*i-A5*Math.sin(2*i)+R5*Math.sin(4*i)-P5*Math.sin(6*i)),D=a0*m*(y+w/6*(1-a+v)+P/120*(5-18*a+u+72*v-58*Vl))+5e5;let B=a0*(L+m*o*(I/2+R/24*(5-a+9*v+4*v**2)+b/720*(61-58*a+u+600*v-330*Vl)));return t.north||(B+=1e7),[D,B]}function rb(n){return(n-1)*6-180+3}const V5=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function sb(n){let e=0;for(const r of V5){const s=n.match(r);if(s){e=parseInt(s[1]);break}}if(!e)return null;let t=0,i=!1;return e>32700&&e<32761?t=e-32700:e>32600&&e<32661&&(i=!0,t=e-32600),t?{number:t,north:i}:null}function $2(n,e){return function(t,i,r,s){const o=t.length;r=r>1?r:2,s=s??r,i||(r>2?i=t.slice():i=new Array(o));for(let a=0;a<o;a+=s){const u=t[a],h=t[a+1],d=n(u,h,e);i[a]=d[0],i[a+1]=d[1]}return i}}function F5(n){return sb(n)?new Gw({code:n,units:"m"}):null}function G5(n){const e=sb(n.getCode());return e?{forward:$2(O5,e),inverse:$2(L5,e)}:null}const j5=63710088e-1;function W2(n,e,t){t=t||j5;const i=xa(n[1]),r=xa(e[1]),s=(r-i)/2,o=xa(e[0]-n[0])/2,a=Math.sin(s)*Math.sin(s)+Math.sin(o)*Math.sin(o)*Math.cos(i)*Math.cos(r);return 2*t*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}const U5=[G5],B5=[F5];let iE=!0;function ob(n){iE=!1}function Bw(n,e){if(e!==void 0){for(let t=0,i=n.length;t<i;++t)e[t]=n[t];e=e}else e=n.slice();return e}function rE(n){S5(n.getCode(),n),Ql(n,n,Bw)}function z5(n){n.forEach(rE)}function jn(n){if(typeof n!="string")return n;const e=I5(n);if(e)return e;for(const t of B5){const i=t(n);if(i)return i}return null}function K2(n,e,t,i){n=jn(n);let r;const s=n.getPointResolutionFunc();if(s)r=s(e,t);else{const o=n.getUnits();if(o=="degrees"&&!i||i=="degrees")r=e;else{const a=$w(n,jn("EPSG:4326"));if(!a&&o!=="degrees")r=e*n.getMetersPerUnit();else{let h=[t[0]-e/2,t[1],t[0]+e/2,t[1],t[0],t[1]-e/2,t[0],t[1]+e/2];h=a(h,h,2);const d=W2(h.slice(0,2),h.slice(2,4)),g=W2(h.slice(4,6),h.slice(6,8));r=(d+g)/2}const u=n.getMetersPerUnit();u!==void 0&&(r/=u)}}return r}function q2(n){z5(n),n.forEach(function(e){n.forEach(function(t){e!==t&&Ql(e,t,Bw)})})}function $5(n,e,t,i){n.forEach(function(r){e.forEach(function(s){Ql(r,s,t),Ql(s,r,i)})})}function zw(n,e){return n?typeof n=="string"?jn(n):n:jn(e)}function sE(n){return(function(e,t,i,r){const s=e.length;i=i!==void 0?i:2,r=r??i,t=t!==void 0?t:new Array(s);for(let o=0;o<s;o+=r){const a=n(e.slice(o,o+i)),u=a.length;for(let h=0,d=r;h<d;++h)t[o+h]=h>=u?e[o+h]:a[h]}return t})}function Nne(n,e,t,i){const r=jn(n),s=jn(e);Ql(r,s,sE(t)),Ql(s,r,sE(i))}function Jl(n,e){return ob(),vg(n,"EPSG:4326","EPSG:3857")}function Lc(n,e){const t=vg(n,"EPSG:3857","EPSG:4326"),i=t[0];return(i<-180||i>180)&&(t[0]=Ta(i+180,360)-180),t}function Lp(n,e){if(n===e)return!0;const t=n.getUnits()===e.getUnits();return(n.getCode()===e.getCode()||$w(n,e)===Bw)&&t}function $w(n,e){const t=n.getCode(),i=e.getCode();let r=$v(t,i);if(r)return r;let s=null,o=null;for(const u of U5)s||(s=u(n)),o||(o=u(e));if(!s&&!o)return null;const a="EPSG:4326";if(o)if(s)r=Wv(s.inverse,o.forward);else{const u=$v(t,a);u&&(r=Wv(u,o.forward))}else{const u=$v(a,i);u&&(r=Wv(s.inverse,u))}return r&&(rE(n),rE(e),Ql(n,e,r)),r}function Wv(n,e){return function(t,i,r,s){return i=n(t,i,r,s),e(i,i,r,s)}}function u0(n,e){const t=jn(n),i=jn(e);return $w(t,i)}function vg(n,e,t){const i=u0(e,t);if(!i){const r=jn(e).getCode(),s=jn(t).getCode();throw new Error(`No transform available between ${r} and ${s}`)}return i(n,void 0,n.length)}function oE(n,e){return n}function ro(n,e){return iE&&!o0(n,[0,0])&&n[0]>=-180&&n[0]<=180&&n[1]>=-90&&n[1]<=90&&(iE=!1,eb("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),n}function ab(n,e){return n}function _a(n,e){return n}function One(n,e,t){return function(i){let r,s;if(n.canWrapX()){const o=n.getExtent(),a=ut(o);i=i.slice(0),s=JM(i,n,a),s&&(i[0]=i[0]-s*a),i[0]=kt(i[0],o[0],o[2]),i[1]=kt(i[1],o[1],o[3]),r=t(i)}else r=t(i);return s&&e.canWrapX()&&(r[0]+=s*ut(e.getExtent())),r}}function W5(){q2(F2),q2(j2),$5(j2,F2,E5,w5)}W5();new Array(6);function Hr(){return[1,0,0,1,0,0]}function K5(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n}function Sn(n,e){const t=e[0],i=e[1];return e[0]=n[0]*t+n[2]*i+n[4],e[1]=n[1]*t+n[3]*i+n[5],e}function _o(n,e,t,i,r,s,o,a){const u=Math.sin(s),h=Math.cos(s);return n[0]=i*h,n[1]=r*u,n[2]=-i*u,n[3]=r*h,n[4]=o*i*h-a*i*u+e,n[5]=o*r*u+a*r*h+t,n}function lb(n,e){const t=q5(e);_t(t!==0,"Transformation matrix cannot be inverted");const i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],u=e[5];return n[0]=o/t,n[1]=-r/t,n[2]=-s/t,n[3]=i/t,n[4]=(s*u-o*a)/t,n[5]=-(i*u-r*a)/t,n}function q5(n){return n[0]*n[3]-n[1]*n[2]}const H5=[1e5,1e5,1e5,1e5,2,2];function X5(n){return"matrix("+n.join(", ")+")"}function aE(n){return n.substring(7,n.length-1).split(",").map(parseFloat)}function Y5(n,e){const t=aE(n),i=aE(e);for(let r=0;r<6;++r)if(Math.round((t[r]-i[r])*H5[r])!==0)return!1;return!0}function Ia(n,e,t,i,r,s,o){s=s||[],o=o||2;let a=0;for(let u=e;u<t;u+=i){const h=n[u],d=n[u+1];s[a++]=r[0]*h+r[2]*d+r[4],s[a++]=r[1]*h+r[3]*d+r[5];for(let g=2;g<o;g++)s[a++]=n[u+g]}return s&&s.length!=a&&(s.length=a),s}function ub(n,e,t,i,r,s,o){o=o||[];const a=Math.cos(r),u=Math.sin(r),h=s[0],d=s[1];let g=0;for(let m=e;m<t;m+=i){const v=n[m]-h,y=n[m+1]-d;o[g++]=h+v*a-y*u,o[g++]=d+v*u+y*a;for(let I=m+2;I<m+i;++I)o[g++]=n[I]}return o&&o.length!=g&&(o.length=g),o}function Z5(n,e,t,i,r,s,o,a){a=a||[];const u=o[0],h=o[1];let d=0;for(let g=e;g<t;g+=i){const m=n[g]-u,v=n[g+1]-h;a[d++]=u+r*m,a[d++]=h+s*v;for(let y=g+2;y<g+i;++y)a[d++]=n[y]}return a&&a.length!=d&&(a.length=d),a}function Q5(n,e,t,i,r,s,o){o=o||[];let a=0;for(let u=e;u<t;u+=i){o[a++]=n[u]+r,o[a++]=n[u+1]+s;for(let h=u+2;h<u+i;++h)o[a++]=n[h]}return o&&o.length!=a&&(o.length=a),o}const H2=Hr(),J5=[NaN,NaN];class e6 extends Ns{constructor(){super(),this.extent_=Yi(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=jM((e,t,i)=>{if(!i)return this.getSimplifiedGeometry(t);const r=this.clone();return r.applyTransform(i),r.getSimplifiedGeometry(t)})}simplifyTransformed(e,t){return this.simplifyTransformedInternal(this.getRevision(),e,t)}clone(){return ot()}closestPointXY(e,t,i,r){return ot()}containsXY(e,t){return this.closestPointXY(e,t,J5,Number.MIN_VALUE)===0}getClosestPoint(e,t){return t=t||[NaN,NaN],this.closestPointXY(e[0],e[1],t,1/0),t}intersectsCoordinate(e){return this.containsXY(e[0],e[1])}computeExtent(e){return ot()}getExtent(e){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&p_(t),this.extentRevision_=this.getRevision()}return d5(this.extent_,e)}rotate(e,t){ot()}scale(e,t,i){ot()}simplify(e){return this.getSimplifiedGeometry(e*e)}getSimplifiedGeometry(e){return ot()}getType(){return ot()}applyTransform(e){ot()}intersectsExtent(e){return ot()}translate(e,t){ot()}transform(e,t){const i=jn(e),r=i.getUnits()=="tile-pixels"?function(s,o,a){const u=i.getExtent(),h=i.getWorldExtent(),d=Jn(h)/Jn(u);_o(H2,h[0],h[3],d,-d,0,0,0);const g=Ia(s,0,s.length,a,H2,o),m=u0(i,t);return m?m(g,g,a):g}:u0(i,t);return this.applyTransform(r),this}}class T_ extends e6{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(e){return Ow(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinates(){return ot()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=this.getSimplifiedGeometryInternal(e);return t.getFlatCoordinates().length<this.flatCoordinates.length?t:(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getSimplifiedGeometryInternal(e){return this}getStride(){return this.stride}setFlatCoordinates(e,t){this.stride=X2(e),this.layout=e,this.flatCoordinates=t}setCoordinates(e,t){ot()}setLayout(e,t,i){let r;if(e)r=X2(e);else{for(let s=0;s<i;++s){if(t.length===0){this.layout="XY",this.stride=2;return}t=t[0]}r=t.length,e=t6(r)}this.layout=e,this.stride=r}applyTransform(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(e,t){const i=this.getFlatCoordinates();if(i){const r=this.getStride();ub(i,0,i.length,r,e,t,i),this.changed()}}scale(e,t,i){t===void 0&&(t=e),i||(i=Zl(this.getExtent()));const r=this.getFlatCoordinates();if(r){const s=this.getStride();Z5(r,0,r.length,s,e,t,i,r),this.changed()}}translate(e,t){const i=this.getFlatCoordinates();if(i){const r=this.getStride();Q5(i,0,i.length,r,e,t,i),this.changed()}}}function t6(n){let e;return n==2?e="XY":n==3?e="XYZ":n==4&&(e="XYZM"),e}function X2(n){let e;return n=="XY"?e=2:n=="XYZ"||n=="XYM"?e=3:n=="XYZM"&&(e=4),e}function n6(n,e,t){const i=n.getFlatCoordinates();if(!i)return null;const r=n.getStride();return Ia(i,0,i.length,r,e,t)}function Y2(n,e,t,i,r,s,o){const a=n[e],u=n[e+1],h=n[t]-a,d=n[t+1]-u;let g;if(h===0&&d===0)g=e;else{const m=((r-a)*h+(s-u)*d)/(h*h+d*d);if(m>1)g=t;else if(m>0){for(let v=0;v<i;++v)o[v]=$i(n[e+v],n[t+v],m);o.length=i;return}else g=e}for(let m=0;m<i;++m)o[m]=n[g+m];o.length=i}function Ww(n,e,t,i,r){let s=n[e],o=n[e+1];for(e+=i;e<t;e+=i){const a=n[e],u=n[e+1],h=Wc(s,o,a,u);h>r&&(r=h),s=a,o=u}return r}function cb(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const a=t[s];r=Ww(n,e,a,i,r),e=a}return r}function Vne(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const a=t[s];r=cb(n,e,a,i,r),e=a[a.length-1]}return r}function Kw(n,e,t,i,r,s,o,a,u,h,d){if(e==t)return h;let g,m;if(r===0){if(m=Wc(o,a,n[e],n[e+1]),m<h){for(g=0;g<i;++g)u[g]=n[e+g];return u.length=i,m}return h}d=d||[NaN,NaN];let v=e+i;for(;v<t;)if(Y2(n,v-i,v,i,o,a,d),m=Wc(o,a,d[0],d[1]),m<h){for(h=m,g=0;g<i;++g)u[g]=d[g];u.length=i,v+=i}else v+=i*Math.max((Math.sqrt(m)-Math.sqrt(h))/r|0,1);if(s&&(Y2(n,t-i,e,i,o,a,d),m=Wc(o,a,d[0],d[1]),m<h)){for(h=m,g=0;g<i;++g)u[g]=d[g];u.length=i}return h}function hb(n,e,t,i,r,s,o,a,u,h,d){d=d||[NaN,NaN];for(let g=0,m=t.length;g<m;++g){const v=t[g];h=Kw(n,e,v,i,r,s,o,a,u,h,d),e=v}return h}function Fne(n,e,t,i,r,s,o,a,u,h,d){d=d||[NaN,NaN];for(let g=0,m=t.length;g<m;++g){const v=t[g];h=hb(n,e,v,i,r,s,o,a,u,h,d),e=v[v.length-1]}return h}function i6(n,e,t,i){for(let r=0,s=t.length;r<s;++r)n[e++]=t[r];return e}function qw(n,e,t,i){for(let r=0,s=t.length;r<s;++r){const o=t[r];for(let a=0;a<i;++a)n[e++]=o[a]}return e}function db(n,e,t,i,r){r=r||[];let s=0;for(let o=0,a=t.length;o<a;++o){const u=qw(n,e,t[o],i);r[s++]=u,e=u}return r.length=s,r}function Gne(n,e,t,i,r){r=r||[];let s=0;for(let o=0,a=t.length;o<a;++o){const u=db(n,e,t[o],i,r[s]);u.length===0&&(u[0]=e),r[s++]=u,e=u[u.length-1]}return r.length=s,r}function Fl(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=e;o<t;o+=i)r[s++]=n.slice(o,o+i);return r.length=s,r}function c0(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,a=t.length;o<a;++o){const u=t[o];r[s++]=Fl(n,e,u,i,r[s]),e=u}return r.length=s,r}function Z2(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,a=t.length;o<a;++o){const u=t[o];r[s++]=u.length===1&&u[0]===e?[]:c0(n,e,u,i,r[s]),e=u[u.length-1]}return r.length=s,r}function lE(n,e,t,i,r,s,o){let a,u;const h=(t-e)/i;if(h===1)a=e;else if(h===2)a=e,u=r;else if(h!==0){let d=n[e],g=n[e+1],m=0;const v=[0];for(let w=e+i;w<t;w+=i){const R=n[w],P=n[w+1];m+=Math.sqrt((R-d)*(R-d)+(P-g)*(P-g)),v.push(m),d=R,g=P}const y=r*m,I=n5(v,y);I<0?(u=(y-v[-I-2])/(v[-I-1]-v[-I-2]),a=e+(-I-2)*i):a=e+I*i}o=o>1?o:2,s=s||new Array(o);for(let d=0;d<o;++d)s[d]=a===void 0?NaN:u===void 0?n[a+d]:$i(n[a+d],n[a+i+d],u);return s}function uE(n,e,t,i,r,s){if(t==e)return null;let o;if(r<n[e+i-1])return s?(o=n.slice(e,e+i),o[i-1]=r,o):null;if(n[t-1]<r)return s?(o=n.slice(t-i,t),o[i-1]=r,o):null;if(r==n[e+i-1])return n.slice(e,e+i);let a=e/i,u=t/i;for(;a<u;){const m=a+u>>1;r<n[(m+1)*i-1]?u=m:a=m+1}const h=n[a*i-1];if(r==h)return n.slice((a-1)*i,(a-1)*i+i);const d=n[(a+1)*i-1],g=(r-h)/(d-h);o=[];for(let m=0;m<i-1;++m)o.push($i(n[(a-1)*i+m],n[a*i+m],g));return o.push(r),o}function jne(n,e,t,i,r,s,o){if(o)return uE(n,e,t[t.length-1],i,r,s);let a;if(r<n[i-1])return s?(a=n.slice(0,i),a[i-1]=r,a):null;if(n[n.length-1]<r)return s?(a=n.slice(n.length-i),a[i-1]=r,a):null;for(let u=0,h=t.length;u<h;++u){const d=t[u];if(e!=d){if(r<n[e+i-1])return null;if(r<=n[d-1])return uE(n,e,d,i,r,!1);e=d}}return null}function r6(n,e,t,i,r){return!qM(r,function(o){return!Gl(n,e,t,i,o[0],o[1])})}function Gl(n,e,t,i,r,s){let o=0,a=n[t-i],u=n[t-i+1];for(;e<t;e+=i){const h=n[e],d=n[e+1];u<=s?d>s&&(h-a)*(s-u)-(r-a)*(d-u)>0&&o++:d<=s&&(h-a)*(s-u)-(r-a)*(d-u)<0&&o--,a=h,u=d}return o!==0}function Hw(n,e,t,i,r,s){if(t.length===0||!Gl(n,e,t[0],i,r,s))return!1;for(let o=1,a=t.length;o<a;++o)if(Gl(n,t[o-1],t[o],i,r,s))return!1;return!0}function Une(n,e,t,i,r,s){if(t.length===0)return!1;for(let o=0,a=t.length;o<a;++o){const u=t[o];if(Hw(n,e,u,i,r,s))return!0;e=u[u.length-1]}return!1}function fb(n,e,t,i,r){let s;for(e+=i;e<t;e+=i)if(s=r(n.slice(e-i,e),n.slice(e,e+i)),s)return s;return!1}function I_(n,e,t,i,r,s){return s=s??KM(Yi(),n,e,t,i),Ri(r,s)?s[0]>=r[0]&&s[2]<=r[2]||s[1]>=r[1]&&s[3]<=r[3]?!0:fb(n,e,t,i,function(o,a){return f5(r,o,a)}):!1}function Bne(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){if(I_(n,e,t[s],i,r))return!0;e=t[s]}return!1}function gb(n,e,t,i,r){return!!(I_(n,e,t,i,r)||Gl(n,e,t,i,r[0],r[1])||Gl(n,e,t,i,r[0],r[3])||Gl(n,e,t,i,r[2],r[1])||Gl(n,e,t,i,r[2],r[3]))}function mb(n,e,t,i,r){if(!gb(n,e,t[0],i,r))return!1;if(t.length===1)return!0;for(let s=1,o=t.length;s<o;++s)if(r6(n,t[s-1],t[s],i,r)&&!I_(n,t[s-1],t[s],i,r))return!1;return!0}function zne(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const a=t[s];if(mb(n,e,a,i,r))return!0;e=a[a.length-1]}return!1}function pb(n,e,t,i){let r=n[e],s=n[e+1],o=0;for(let a=e+i;a<t;a+=i){const u=n[a],h=n[a+1];o+=Math.sqrt((u-r)*(u-r)+(h-s)*(h-s)),r=u,s=h}return o}function S_(n,e,t,i,r,s,o){const a=(t-e)/i;if(a<3){for(;e<t;e+=i)s[o++]=n[e],s[o++]=n[e+1];return o}const u=new Array(a);u[0]=1,u[a-1]=1;const h=[e,t-i];let d=0;for(;h.length>0;){const g=h.pop(),m=h.pop();let v=0;const y=n[m],I=n[m+1],w=n[g],R=n[g+1];for(let P=m+i;P<g;P+=i){const b=n[P],L=n[P+1],D=g5(b,L,y,I,w,R);D>v&&(d=P,v=D)}v>r&&(u[(d-e)/i]=1,m+i<d&&h.push(m,d),d+i<g&&h.push(d,g))}for(let g=0;g<a;++g)u[g]&&(s[o++]=n[e+g*i],s[o++]=n[e+g*i+1]);return o}function s6(n,e,t,i,r,s,o,a){for(let u=0,h=t.length;u<h;++u){const d=t[u];o=S_(n,e,d,i,r,s,o),a.push(o),e=d}return o}function Il(n,e){return e*Math.round(n/e)}function o6(n,e,t,i,r,s,o){if(e==t)return o;let a=Il(n[e],r),u=Il(n[e+1],r);e+=i,s[o++]=a,s[o++]=u;let h,d;do if(h=Il(n[e],r),d=Il(n[e+1],r),e+=i,e==t)return s[o++]=h,s[o++]=d,o;while(h==a&&d==u);for(;e<t;){const g=Il(n[e],r),m=Il(n[e+1],r);if(e+=i,g==h&&m==d)continue;const v=h-a,y=d-u,I=g-a,w=m-u;if(v*w==y*I&&(v<0&&I<v||v==I||v>0&&I>v)&&(y<0&&w<y||y==w||y>0&&w>y)){h=g,d=m;continue}s[o++]=h,s[o++]=d,a=h,u=d,h=g,d=m}return s[o++]=h,s[o++]=d,o}function Xw(n,e,t,i,r,s,o,a){for(let u=0,h=t.length;u<h;++u){const d=t[u];o=o6(n,e,d,i,r,s,o),a.push(o),e=d}return o}function $ne(n,e,t,i,r,s,o,a){for(let u=0,h=t.length;u<h;++u){const d=t[u],g=[];o=Xw(n,e,d,i,r,s,o,g),a.push(g),e=d[d.length-1]}return o}class h0 extends T_{constructor(e,t){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}appendCoordinate(e){g_(this.flatCoordinates,e),this.changed()}clone(){const e=new h0(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,i,r){return r<Nw(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Ww(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Kw(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,e,t,i,r))}forEachSegment(e){return fb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinateAtM(e,t){return this.layout!="XYM"&&this.layout!="XYZM"?null:(t=t!==void 0?t:!1,uE(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t))}getCoordinates(){return Fl(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(e,t){return lE(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,this.stride)}getLength(){return pb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(e){const t=[];return t.length=S_(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new h0(t,"XY")}getType(){return"LineString"}intersectsExtent(e){return I_(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,this.getExtent())}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=qw(this.flatCoordinates,0,e,this.stride),this.changed()}}let d0=class _b extends T_{constructor(e,t){super(),this.setCoordinates(e,t)}clone(){const e=new _b(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,i,r){const s=this.flatCoordinates,o=Wc(e,t,s[0],s[1]);if(o<r){const a=this.stride;for(let u=0;u<a;++u)i[u]=s[u];return i.length=a,o}return r}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(e){return WM(this.flatCoordinates,e)}getType(){return"Point"}intersectsExtent(e){return $M(e,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(e,t){this.setLayout(t,e,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=i6(this.flatCoordinates,0,e,this.stride),this.changed()}};const wr={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},eu=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",a6=eu.includes("safari")&&!eu.includes("chrom");a6&&(eu.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(eu));const l6=eu.includes("webkit")&&!eu.includes("edge"),yb=eu.includes("macintosh"),u6=typeof devicePixelRatio<"u"?devicePixelRatio:1,Wi=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,Yw=typeof Image<"u"&&Image.prototype.decode,vb=typeof createImageBitmap=="function",Eb=(function(){let n=!1;try{const e=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return n})(),ze={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function mn(n,e,t,i){let r;return t&&t.length?r=t.shift():Wi?r=new class extends OffscreenCanvas{style={}}(n??300,e??150):r=document.createElement("canvas"),n&&(r.width=n),e&&(r.height=e),r.getContext("2d",i)}let Kv;function f0(){return Kv||(Kv=mn(1,1)),Kv}function A_(n){const e=n.canvas;e.width=1,e.height=1,n.clearRect(0,0,1,1)}function Q2(n,e){const t=e.parentNode;t&&t.replaceChild(n,e)}function c6(n){for(;n.lastChild;)n.lastChild.remove()}function h6(n,e){const t=n.childNodes;for(let i=0;;++i){const r=t[i],s=e[i];if(!r&&!s)break;if(r!==s){if(!r){n.appendChild(s);continue}if(!s){n.removeChild(r),--i;continue}n.insertBefore(s,r)}}}function wb(){return new Proxy({childNodes:[],appendChild:function(e){return this.childNodes.push(e),e},remove:function(){},removeChild:function(e){const t=this.childNodes.indexOf(e);if(t===-1)throw new Error("Node to remove was not found");return this.childNodes.splice(t,1),e},insertBefore:function(e,t){const i=this.childNodes.indexOf(t);if(i===-1)throw new Error("Reference node not found");return this.childNodes.splice(i,0,e),e},style:{}},{get(e,t,i){return t==="firstElementChild"?e.childNodes.length>0?e.childNodes[0]:null:Reflect.get(e,t,i)}})}function ya(n){return typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas}const Zw=[NaN,NaN,NaN,0];let qv;function d6(){return qv||(qv=mn(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),qv}const f6=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,g6=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,m6=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,p6=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function ap(n,e){return n.endsWith("%")?Number(n.substring(0,n.length-1))/e:Number(n)}function lf(n){throw new Error('failed to parse "'+n+'" as color')}function xb(n){if(n.toLowerCase().startsWith("rgb")){const s=n.match(g6)||n.match(f6)||n.match(m6);if(s){const o=s[4],a=100/255;return[kt(ap(s[1],a)+.5|0,0,255),kt(ap(s[2],a)+.5|0,0,255),kt(ap(s[3],a)+.5|0,0,255),o!==void 0?kt(ap(o,100),0,1):1]}lf(n)}if(n.startsWith("#")){if(p6.test(n)){const s=n.substring(1),o=s.length<=4?1:2,a=[0,0,0,255];for(let u=0,h=s.length;u<h;u+=o){let d=parseInt(s.substring(u,u+o),16);o===1&&(d+=d<<4),a[u/o]=d}return a[3]=a[3]/255,a}lf(n)}const e=d6();e.fillStyle="#abcdef";let t=e.fillStyle;e.fillStyle=n,e.fillStyle===t&&(e.fillStyle="#fedcba",t=e.fillStyle,e.fillStyle=n,e.fillStyle===t&&lf(n));const i=e.fillStyle;if(i.startsWith("#")||i.startsWith("rgba"))return xb(i);e.clearRect(0,0,1,1),e.fillRect(0,0,1,1);const r=Array.from(e.getImageData(0,0,1,1).data);return r[3]=_g(r[3]/255,3),r}function _6(n){return typeof n=="string"?n:Jw(n)}const y6=1024,Cd={};let Hv=0;function v6(n){if(n.length===4)return n;const e=n.slice();return e[3]=1,e}function Xv(n){return n>.0031308?Math.pow(n,1/2.4)*269.025-14.025:n*3294.6}function Yv(n){return n>.2068965?Math.pow(n,3):(n-4/29)*(108/841)}function Zv(n){return n>10.314724?Math.pow((n+14.025)/269.025,2.4):n/3294.6}function Qv(n){return n>.0088564?Math.pow(n,1/3):n/(108/841)+4/29}function J2(n){const e=Zv(n[0]),t=Zv(n[1]),i=Zv(n[2]),r=Qv(e*.222488403+t*.716873169+i*.06060791),s=500*(Qv(e*.452247074+t*.399439023+i*.148375274)-r),o=200*(r-Qv(e*.016863605+t*.117638439+i*.865350722)),a=Math.atan2(o,s)*(180/Math.PI);return[116*r-16,Math.sqrt(s*s+o*o),a<0?a+360:a,n[3]]}function E6(n){const e=(n[0]+16)/116,t=n[1],i=n[2]*Math.PI/180,r=Yv(e),s=Yv(e+t/500*Math.cos(i)),o=Yv(e-t/200*Math.sin(i)),a=Xv(s*3.021973625-r*1.617392459-o*.404875592),u=Xv(s*-.943766287+r*1.916279586+o*.027607165),h=Xv(s*.069407491-r*.22898585+o*1.159737864);return[kt(a+.5|0,0,255),kt(u+.5|0,0,255),kt(h+.5|0,0,255),n[3]]}function Qw(n){if(n==="none")return Zw;if(Cd.hasOwnProperty(n))return Cd[n];if(Hv>=y6){let t=0;for(const i in Cd)(t++&3)===0&&(delete Cd[i],--Hv)}const e=xb(n);e.length!==4&&lf(n);for(const t of e)isNaN(t)&&lf(n);return Cd[n]=e,++Hv,e}function ah(n){return Array.isArray(n)?n:Qw(n)}function Jw(n){let e=n[0];e!=(e|0)&&(e=e+.5|0);let t=n[1];t!=(t|0)&&(t=t+.5|0);let i=n[2];i!=(i|0)&&(i=i+.5|0);const r=n[3]===void 0?1:Math.round(n[3]*1e3)/1e3;return"rgba("+e+","+t+","+i+","+r+")"}class Wne extends mg{constructor(e,t,i,r){super(),this.extent=e,this.pixelRatio_=i,this.resolution=t,this.state=typeof r=="function"?ze.IDLE:r,this.image_=null,this.loader=typeof r=="function"?r:null}changed(){this.dispatchEvent(He.CHANGE)}getExtent(){return this.extent}getImage(){return this.image_}getPixelRatio(){return this.pixelRatio_}getResolution(){return this.resolution}getState(){return this.state}load(){if(this.state==ze.IDLE&&this.loader){this.state=ze.LOADING,this.changed();const e=this.getResolution(),t=Array.isArray(e)?e[0]:e;UM(()=>this.loader(this.getExtent(),t,this.getPixelRatio())).then(i=>{"image"in i&&(this.image_=i.image),"extent"in i&&(this.extent=i.extent),"resolution"in i&&(this.resolution=i.resolution),"pixelRatio"in i&&(this.pixelRatio_=i.pixelRatio),(i instanceof HTMLImageElement||vb&&i instanceof ImageBitmap||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement)&&(this.image_=i),this.state=ze.LOADED}).catch(i=>{this.state=ze.ERROR,console.error(i)}).finally(()=>this.changed())}}setImage(e){this.image_=e}setResolution(e){this.resolution=e}}function w6(n,e,t){const i=n;let r=!0,s=!1,o=!1;const a=[r0(i,He.LOAD,function(){o=!0,s||e()})];return i.src&&Yw?(s=!0,i.decode().then(function(){r&&e()}).catch(function(u){r&&(o?e():t())})):a.push(r0(i,He.ERROR,t)),function(){r=!1,a.forEach(Ft)}}function x6(n,e){return new Promise((t,i)=>{function r(){o(),t(n)}function s(){o(),i(new Error("Image load error"))}function o(){n.removeEventListener("load",r),n.removeEventListener("error",s)}n.addEventListener("load",r),n.addEventListener("error",s)})}function Tb(n,e){return e&&(n.src=e),n.src&&Yw?new Promise((t,i)=>n.decode().then(()=>t(n)).catch(r=>n.complete&&n.width?t(n):i(r))):x6(n)}function Kne(n,e){return e&&(n.src=e),n.src&&Yw&&vb?n.decode().then(()=>createImageBitmap(n)).catch(t=>{if(n.complete&&n.width)return n;throw t}):Tb(n)}class T6{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let e=0;for(const t in this.cache_){const i=this.cache_[t];(e++&3)===0&&!i.hasListener()&&(delete this.cache_[t],delete this.patternCache_[t],--this.cacheSize_)}}}get(e,t,i){const r=Jv(e,t,i);return r in this.cache_?this.cache_[r]:null}getPattern(e,t,i){const r=Jv(e,t,i);return r in this.patternCache_?this.patternCache_[r]:null}set(e,t,i,r,s){const o=Jv(e,t,i),a=o in this.cache_;this.cache_[o]=r,s&&(r.getImageState()===ze.IDLE&&r.load(),r.getImageState()===ze.LOADING?r.ready().then(()=>{this.patternCache_[o]=f0().createPattern(r.getImage(1),"repeat")}):this.patternCache_[o]=f0().createPattern(r.getImage(1),"repeat")),a||++this.cacheSize_}setSize(e){this.maxCacheSize_=e,this.expire()}}function Jv(n,e,t){const i=t?ah(t):"null";return e+":"+n+":"+i}const xr=new T6;let Md=null;class Ib extends mg{constructor(e,t,i,r,s){super(),this.hitDetectionImage_=null,this.image_=e,this.crossOrigin_=i,this.canvas_={},this.color_=s,this.imageState_=r===void 0?ze.IDLE:r,this.size_=e&&e.width&&e.height?[e.width,e.height]:null,this.src_=t,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===ze.LOADED){Md||(Md=mn(1,1,void 0,{willReadFrequently:!0})),Md.drawImage(this.image_,0,0);try{Md.getImageData(0,0,1,1),this.tainted_=!1}catch{Md=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(He.CHANGE)}handleImageError_(){this.imageState_=ze.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=ze.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}getPixelRatio(e){return this.replaceColor_(e),this.canvas_[e]?e:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const e=this.size_[0],t=this.size_[1],i=mn(e,t);i.fillRect(0,0,e,t),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===ze.IDLE){this.image_||this.initializeImage_(),this.imageState_=ze.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&Tb(this.image_,this.src_).then(e=>{this.image_=e,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(e){if(!this.color_||this.canvas_[e]||this.imageState_!==ze.LOADED)return;const t=this.image_,i=mn(Math.ceil(t.width*e),Math.ceil(t.height*e)),r=i.canvas;i.scale(e,e),i.drawImage(t,0,0),i.globalCompositeOperation="multiply",i.fillStyle=_6(this.color_),i.fillRect(0,0,r.width/e,r.height/e),i.globalCompositeOperation="destination-in",i.drawImage(t,0,0),this.canvas_[e]=r}ready(){return this.ready_||(this.ready_=new Promise(e=>{if(this.imageState_===ze.LOADED||this.imageState_===ze.ERROR)e();else{const t=()=>{(this.imageState_===ze.LOADED||this.imageState_===ze.ERROR)&&(this.removeEventListener(He.CHANGE,t),e())};this.addEventListener(He.CHANGE,t)}})),this.ready_}}function g0(n,e,t,i,r,s){let o=e===void 0?void 0:xr.get(e,t,r);return o||(o=new Ib(n,n&&"src"in n?n.src||void 0:e,t,i,r),xr.set(e,t,r,o,s)),s&&o&&!xr.getPattern(e,t,r)&&xr.set(e,t,r,o,s),o}function xs(n){return n?Array.isArray(n)?Jw(n):typeof n=="object"&&"src"in n?I6(n):n:null}function I6(n){if(!n.offset||!n.size)return xr.getPattern(n.src,"anonymous",n.color);const e=n.src+":"+n.offset,t=xr.getPattern(e,void 0,n.color);if(t)return t;const i=xr.get(n.src,"anonymous",null);if(i.getImageState()!==ze.LOADED)return null;const r=mn(n.size[0],n.size[1]);return r.drawImage(i.getImage(1),n.offset[0],n.offset[1],n.size[0],n.size[1],0,0,n.size[0],n.size[1]),g0(r.canvas,e,void 0,ze.LOADED,n.color,!0),xr.getPattern(e,void 0,n.color)}class Sb{drawCustom(e,t,i,r,s){}drawGeometry(e){}setStyle(e){}drawCircle(e,t,i){}drawFeature(e,t,i){}drawGeometryCollection(e,t,i){}drawLineString(e,t,i){}drawMultiLineString(e,t,i){}drawMultiPoint(e,t,i){}drawMultiPolygon(e,t,i){}drawPoint(e,t,i){}drawPolygon(e,t,i){}drawText(e,t,i){}setFillStrokeStyle(e,t){}setImageStyle(e,t){}setTextStyle(e,t){}}const lp="ol-hidden",R_="ol-unselectable",ex="ol-control",eA="ol-collapsed",S6=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),tA=["style","variant","weight","size","lineHeight","family"],cE={normal:400,bold:700},hE=function(n){const e=n.match(S6);if(!e)return null;const t={lineHeight:"normal",size:"1.2em",style:"normal",weight:"400",variant:"normal"};for(let i=0,r=tA.length;i<r;++i){const s=e[i+1];s!==void 0&&(t[tA[i]]=typeof s=="string"?s.trim():s)}return isNaN(Number(t.weight))&&t.weight in cE&&(t.weight=cE[t.weight]),t.families=t.family.split(/,\s?/).map(i=>i.trim().replace(/^['"]|['"]$/g,"")),t},Ab="10px sans-serif",Si="#000",lh="round",ho=[],fo=0,uh="round",kf=10,Lf="#000",Df="center",m0="middle",jl=[0,0,0,0],Nf=1,wc=new Ns;let bd=null,nA;const dE={},A6=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"]);function R6(n,e,t){return`${n} ${e} 16px "${t}"`}const P6=(function(){let e,t;async function i(s){await t.ready;const o=await t.load(s);if(o.length===0)return!1;const a=hE(s),u=a.families[0].toLowerCase(),h=a.weight;return o.some(d=>{const g=d.family.replace(/^['"]|['"]$/g,"").toLowerCase(),m=cE[d.weight]||d.weight;return g===u&&d.style===a.style&&m==h})}async function r(){await t.ready;let s=!0;const o=wc.getProperties(),a=Object.keys(o).filter(u=>o[u]<100);for(let u=a.length-1;u>=0;--u){const h=a[u];let d=o[h];d<100&&(await i(h)?(gg(dE),wc.set(h,100)):(d+=10,wc.set(h,d,!0),d<100&&(s=!1)))}e=void 0,s||(e=setTimeout(r,100))}return async function(s){t||(t=Wi?self.fonts:document.fonts);const o=hE(s);if(!o)return;const a=o.families;let u=!1;for(const h of a){if(A6.has(h))continue;const d=R6(o.style,o.weight,h);wc.get(d)===void 0&&(wc.set(d,0,!0),u=!0)}u&&(clearTimeout(e),e=setTimeout(r,100))}})(),C6=(function(){let n;return function(e){let t=dE[e];if(t==null){if(Wi){const i=hE(e),r=Rb(e,"g");t=(isNaN(Number(i.lineHeight))?1.2:Number(i.lineHeight))*(r.actualBoundingBoxAscent+r.actualBoundingBoxDescent)}else n||(n=document.createElement("div"),n.innerHTML="M",n.style.minHeight="0",n.style.maxHeight="none",n.style.height="auto",n.style.padding="0",n.style.border="none",n.style.position="absolute",n.style.display="block",n.style.left="-99999px"),n.style.font=e,document.body.appendChild(n),t=n.offsetHeight,document.body.removeChild(n);dE[e]=t}return t}})();function Rb(n,e){return bd||(bd=mn(1,1)),n!=nA&&(bd.font=n,nA=bd.font),bd.measureText(e)}function Pb(n,e){return Rb(n,e).width}function iA(n,e,t){if(e in t)return t[e];const i=e.split(`
`).reduce((r,s)=>Math.max(r,Pb(n,s)),0);return t[e]=i,i}function M6(n,e){const t=[],i=[],r=[];let s=0,o=0,a=0,u=0;for(let h=0,d=e.length;h<=d;h+=2){const g=e[h];if(g===`
`||h===d){s=Math.max(s,o),r.push(o),o=0,a+=u,u=0;continue}const m=e[h+1]||n.font,v=Pb(m,g);t.push(v),o+=v;const y=C6(m);i.push(y),u=Math.max(u,y)}return{width:s,height:a,widths:t,heights:i,lineWidths:r}}function b6(n,e,t,i,r,s,o,a,u,h,d){n.save(),t!==1&&(n.globalAlpha===void 0?n.globalAlpha=g=>g.globalAlpha*=t:n.globalAlpha*=t),e&&n.transform.apply(n,e),i.contextInstructions?(n.translate(u,h),n.scale(d[0],d[1]),k6(i,n)):d[0]<0||d[1]<0?(n.translate(u,h),n.scale(d[0],d[1]),n.drawImage(i,r,s,o,a,0,0,o,a)):n.drawImage(i,r,s,o,a,u,h,o*d[0],a*d[1]),n.restore()}function k6(n,e){const t=n.contextInstructions;for(let i=0,r=t.length;i<r;i+=2)Array.isArray(t[i+1])?e[t[i]].apply(e,t[i+1]):e[t[i]]=t[i+1]}class L6 extends Sb{constructor(e,t,i,r,s,o,a){super(),this.context_=e,this.pixelRatio_=t,this.extent_=i,this.transform_=r,this.transformRotation_=r?_g(Math.atan2(r[1],r[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=o,this.userTransform_=a,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=Hr()}drawImages_(e,t,i,r){if(!this.image_)return;const s=Ia(e,t,i,r,this.transform_,this.pixelCoordinates_),o=this.context_,a=this.tmpLocalTransform_,u=o.globalAlpha;this.imageOpacity_!=1&&(o.globalAlpha=u*this.imageOpacity_);let h=this.imageRotation_;this.transformRotation_===0&&(h-=this.viewRotation_),this.imageRotateWithView_&&(h+=this.viewRotation_);for(let d=0,g=s.length;d<g;d+=2){const m=s[d]-this.imageAnchorX_,v=s[d+1]-this.imageAnchorY_;if(h!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const y=m+this.imageAnchorX_,I=v+this.imageAnchorY_;_o(a,y,I,1,1,h,-y,-I),o.save(),o.transform.apply(o,a),o.translate(y,I),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.restore()}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,m,v,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(o.globalAlpha=u)}drawText_(e,t,i,r){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=Ia(e,t,i,r,this.transform_,this.pixelCoordinates_),o=this.context_;let a=this.textRotation_;for(this.transformRotation_===0&&(a-=this.viewRotation_),this.textRotateWithView_&&(a+=this.viewRotation_);t<i;t+=r){const u=s[t]+this.textOffsetX_,h=s[t+1]+this.textOffsetY_;a!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(o.save(),o.translate(u-this.textOffsetX_,h-this.textOffsetY_),o.rotate(a),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.restore()):(this.textStrokeState_&&o.strokeText(this.text_,u,h),this.textFillState_&&o.fillText(this.text_,u,h))}}moveToLineTo_(e,t,i,r,s){const o=this.context_,a=Ia(e,t,i,r,this.transform_,this.pixelCoordinates_);o.moveTo(a[0],a[1]);let u=a.length;s&&(u-=2);for(let h=2;h<u;h+=2)o.lineTo(a[h],a[h+1]);return s&&o.closePath(),i}drawRings_(e,t,i,r){for(let s=0,o=i.length;s<o;++s)t=this.moveToLineTo_(e,t,i[s],r,!0);return t}drawCircle(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Ri(this.extent_,e.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=n6(e,this.transform_,this.pixelCoordinates_),i=t[2]-t[0],r=t[3]-t[1],s=Math.sqrt(i*i+r*r),o=this.context_;o.beginPath(),o.arc(t[0],t[1],s,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}this.text_!==""&&this.drawText_(e.getCenter(),0,2,2)}}setStyle(e){this.setFillStrokeStyle(e.getFill(),e.getStroke()),this.setImageStyle(e.getImage()),this.setTextStyle(e.getText())}setTransform(e){this.transform_=e}drawGeometry(e){switch(e.getType()){case"Point":this.drawPoint(e);break;case"LineString":this.drawLineString(e);break;case"Polygon":this.drawPolygon(e);break;case"MultiPoint":this.drawMultiPoint(e);break;case"MultiLineString":this.drawMultiLineString(e);break;case"MultiPolygon":this.drawMultiPolygon(e);break;case"GeometryCollection":this.drawGeometryCollection(e);break;case"Circle":this.drawCircle(e);break}}drawFeature(e,t){const i=t.getGeometryFunction()(e);i&&(this.setStyle(t),this.drawGeometry(i))}drawGeometryCollection(e){const t=e.getGeometriesArray();for(let i=0,r=t.length;i<r;++i)this.drawGeometry(t[i])}drawPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(t,0,t.length,i),this.text_!==""&&this.drawText_(t,0,t.length,i)}drawMultiPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(t,0,t.length,i),this.text_!==""&&this.drawText_(t,0,t.length,i)}drawLineString(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Ri(this.extent_,e.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const t=this.context_,i=e.getFlatCoordinates();t.beginPath(),this.moveToLineTo_(i,0,i.length,e.getStride(),!1),t.stroke()}if(this.text_!==""){const t=e.getFlatMidpoint();this.drawText_(t,0,2,2)}}}drawMultiLineString(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getExtent();if(Ri(this.extent_,t)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const i=this.context_,r=e.getFlatCoordinates();let s=0;const o=e.getEnds(),a=e.getStride();i.beginPath();for(let u=0,h=o.length;u<h;++u)s=this.moveToLineTo_(r,s,o[u],a,!1);i.stroke()}if(this.text_!==""){const i=e.getFlatMidpoints();this.drawText_(i,0,i.length,2)}}}drawPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Ri(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_;t.beginPath(),this.drawRings_(e.getOrientedFlatCoordinates(),0,e.getEnds(),e.getStride()),this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoint();this.drawText_(t,0,2,2)}}}drawMultiPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Ri(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_,i=e.getOrientedFlatCoordinates();let r=0;const s=e.getEndss(),o=e.getStride();t.beginPath();for(let a=0,u=s.length;a<u;++a){const h=s[a];r=this.drawRings_(i,r,h,o)}this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoints();this.drawText_(t,0,t.length,2)}}}setContextFillState_(e){const t=this.context_,i=this.contextFillState_;i?i.fillStyle!=e.fillStyle&&(i.fillStyle=e.fillStyle,t.fillStyle=e.fillStyle):(t.fillStyle=e.fillStyle,this.contextFillState_={fillStyle:e.fillStyle})}setContextStrokeState_(e){const t=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=e.lineCap&&(i.lineCap=e.lineCap,t.lineCap=e.lineCap),za(i.lineDash,e.lineDash)||t.setLineDash(i.lineDash=e.lineDash),i.lineDashOffset!=e.lineDashOffset&&(i.lineDashOffset=e.lineDashOffset,t.lineDashOffset=e.lineDashOffset),i.lineJoin!=e.lineJoin&&(i.lineJoin=e.lineJoin,t.lineJoin=e.lineJoin),i.lineWidth!=e.lineWidth&&(i.lineWidth=e.lineWidth,t.lineWidth=e.lineWidth),i.miterLimit!=e.miterLimit&&(i.miterLimit=e.miterLimit,t.miterLimit=e.miterLimit),i.strokeStyle!=e.strokeStyle&&(i.strokeStyle=e.strokeStyle,t.strokeStyle=e.strokeStyle)):(t.lineCap=e.lineCap,t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset,t.lineJoin=e.lineJoin,t.lineWidth=e.lineWidth,t.miterLimit=e.miterLimit,t.strokeStyle=e.strokeStyle,this.contextStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle})}setContextTextState_(e){const t=this.context_,i=this.contextTextState_,r=e.textAlign?e.textAlign:Df;i?(i.font!=e.font&&(i.font=e.font,t.font=e.font),i.textAlign!=r&&(i.textAlign=r,t.textAlign=r),i.textBaseline!=e.textBaseline&&(i.textBaseline=e.textBaseline,t.textBaseline=e.textBaseline)):(t.font=e.font,t.textAlign=r,t.textBaseline=e.textBaseline,this.contextTextState_={font:e.font,textAlign:r,textBaseline:e.textBaseline})}setFillStrokeStyle(e,t){if(!e)this.fillState_=null;else{const i=e.getColor();this.fillState_={fillStyle:xs(i||Si)}}if(!t)this.strokeState_=null;else{const i=t.getColor(),r=t.getLineCap(),s=t.getLineDash(),o=t.getLineDashOffset(),a=t.getLineJoin(),u=t.getWidth(),h=t.getMiterLimit(),d=s||ho;this.strokeState_={lineCap:r!==void 0?r:lh,lineDash:this.pixelRatio_===1?d:d.map(g=>g*this.pixelRatio_),lineDashOffset:(o||fo)*this.pixelRatio_,lineJoin:a!==void 0?a:uh,lineWidth:(u!==void 0?u:Nf)*this.pixelRatio_,miterLimit:h!==void 0?h:kf,strokeStyle:xs(i||Lf)}}}setImageStyle(e){let t;if(!e||!(t=e.getSize())){this.image_=null;return}const i=e.getPixelRatio(this.pixelRatio_),r=e.getAnchor(),s=e.getOrigin();this.image_=e.getImage(this.pixelRatio_),this.imageAnchorX_=r[0]*i,this.imageAnchorY_=r[1]*i,this.imageHeight_=t[1]*i,this.imageOpacity_=e.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=e.getRotateWithView(),this.imageRotation_=e.getRotation();const o=e.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/i,o[1]*this.pixelRatio_/i],this.imageWidth_=t[0]*i}setTextStyle(e){if(!e)this.text_="";else{const t=e.getFill();if(!t)this.textFillState_=null;else{const v=t.getColor();this.textFillState_={fillStyle:xs(v||Si)}}const i=e.getStroke();if(!i)this.textStrokeState_=null;else{const v=i.getColor(),y=i.getLineCap(),I=i.getLineDash(),w=i.getLineDashOffset(),R=i.getLineJoin(),P=i.getWidth(),b=i.getMiterLimit();this.textStrokeState_={lineCap:y!==void 0?y:lh,lineDash:I||ho,lineDashOffset:w||fo,lineJoin:R!==void 0?R:uh,lineWidth:P!==void 0?P:Nf,miterLimit:b!==void 0?b:kf,strokeStyle:xs(v||Lf)}}const r=e.getFont(),s=e.getOffsetX(),o=e.getOffsetY(),a=e.getRotateWithView(),u=e.getRotation(),h=e.getScaleArray(),d=e.getText(),g=e.getTextAlign(),m=e.getTextBaseline();this.textState_={font:r!==void 0?r:Ab,textAlign:g!==void 0?g:Df,textBaseline:m!==void 0?m:m0},this.text_=d!==void 0?Array.isArray(d)?d.reduce((v,y,I)=>v+=I%2?" ":y,""):d:"",this.textOffsetX_=s!==void 0?this.pixelRatio_*s:0,this.textOffsetY_=o!==void 0?this.pixelRatio_*o:0,this.textRotateWithView_=a!==void 0?a:!1,this.textRotation_=u!==void 0?u:0,this.textScale_=[this.pixelRatio_*h[0],this.pixelRatio_*h[1]]}}}const D6=.5,Cb={Point:B6,LineString:G6,Polygon:$6,MultiPoint:z6,MultiLineString:j6,MultiPolygon:U6,GeometryCollection:F6,Circle:O6};function N6(n,e){return parseInt(lt(n),10)-parseInt(lt(e),10)}function rA(n,e){const t=Mb(n,e);return t*t}function Mb(n,e){return D6*n/e}function O6(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(s||o){const u=n.getBuilder(t.getZIndex(),"Circle");u.setFillStrokeStyle(s,o),u.drawCircle(e,i,r)}const a=t.getText();if(a&&a.getText()){const u=n.getBuilder(t.getZIndex(),"Text");u.setTextStyle(a),u.drawText(e,i)}}function sA(n,e,t,i,r,s,o,a){const u=[],h=t.getImage();if(h){let m=!0;const v=h.getImageState();v==ze.LOADED||v==ze.ERROR?m=!1:v==ze.IDLE&&h.load(),m&&u.push(h.ready())}const d=t.getFill();d&&d.loading()&&u.push(d.ready());const g=u.length>0;return g&&Promise.all(u).then(()=>r(null)),V6(n,e,t,i,s,o,a),g}function V6(n,e,t,i,r,s,o){const a=t.getGeometryFunction()(e);if(!a)return;const u=a.simplifyTransformed(i,r);if(t.getRenderer())bb(n,u,t,e,o);else{const d=Cb[u.getType()];d(n,u,t,e,o,s)}}function bb(n,e,t,i,r){if(e.getType()=="GeometryCollection"){const o=e.getGeometries();for(let a=0,u=o.length;a<u;++a)bb(n,o[a],t,i,r);return}n.getBuilder(t.getZIndex(),"Default").drawCustom(e,i,t.getRenderer(),t.getHitDetectionRenderer(),r)}function F6(n,e,t,i,r,s){const o=e.getGeometriesArray();let a,u;for(a=0,u=o.length;a<u;++a){const h=Cb[o[a].getType()];h(n,o[a],t,i,r,s)}}function G6(n,e,t,i,r){const s=t.getStroke();if(s){const a=n.getBuilder(t.getZIndex(),"LineString");a.setFillStrokeStyle(null,s),a.drawLineString(e,i,r)}const o=t.getText();if(o&&o.getText()){const a=n.getBuilder(t.getZIndex(),"Text");a.setTextStyle(o),a.drawText(e,i,r)}}function j6(n,e,t,i,r){const s=t.getStroke();if(s){const a=n.getBuilder(t.getZIndex(),"LineString");a.setFillStrokeStyle(null,s),a.drawMultiLineString(e,i,r)}const o=t.getText();if(o&&o.getText()){const a=n.getBuilder(t.getZIndex(),"Text");a.setTextStyle(o),a.drawText(e,i,r)}}function U6(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(o||s){const u=n.getBuilder(t.getZIndex(),"Polygon");u.setFillStrokeStyle(s,o),u.drawMultiPolygon(e,i,r)}const a=t.getText();if(a&&a.getText()){const u=n.getBuilder(t.getZIndex(),"Text");u.setTextStyle(a),u.drawText(e,i,r)}}function B6(n,e,t,i,r,s){const o=t.getImage(),a=t.getText(),u=a&&a.getText(),h=s&&o&&u?{}:void 0;if(o){if(o.getImageState()!=ze.LOADED)return;const d=n.getBuilder(t.getZIndex(),"Image");d.setImageStyle(o,h),d.drawPoint(e,i,r)}if(u){const d=n.getBuilder(t.getZIndex(),"Text");d.setTextStyle(a,h),d.drawText(e,i,r)}}function z6(n,e,t,i,r,s){const o=t.getImage(),a=o&&o.getOpacity()!==0,u=t.getText(),h=u&&u.getText(),d=s&&a&&h?{}:void 0;if(a){if(o.getImageState()!=ze.LOADED)return;const g=n.getBuilder(t.getZIndex(),"Image");g.setImageStyle(o,d),g.drawMultiPoint(e,i,r)}if(h){const g=n.getBuilder(t.getZIndex(),"Text");g.setTextStyle(u,d),g.drawText(e,i,r)}}function $6(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(s||o){const u=n.getBuilder(t.getZIndex(),"Polygon");u.setFillStrokeStyle(s,o),u.drawPolygon(e,i,r)}const a=t.getText();if(a&&a.getText()){const u=n.getBuilder(t.getZIndex(),"Text");u.setTextStyle(a),u.drawText(e,i,r)}}let W6=!1;function K6(n,e,t,i,r,s,o){const a=new XMLHttpRequest;a.open("GET",typeof n=="function"?n(t,i,r):n,!0),e.getType()=="arraybuffer"&&(a.responseType="arraybuffer"),a.withCredentials=W6,a.onload=function(u){if(!a.status||a.status>=200&&a.status<300){const h=e.getType();try{let d;h=="text"||h=="json"?d=a.responseText:h=="xml"?d=a.responseXML||a.responseText:h=="arraybuffer"&&(d=a.response),d?s(e.readFeatures(d,{extent:t,featureProjection:r}),e.readProjection(d)):o()}catch{o()}}else o()},a.onerror=o,a.send()}function oA(n,e){return function(t,i,r,s,o){K6(n,e,t,i,r,(a,u)=>{this.addFeatures(a),s!==void 0&&s(a)},()=>{this.changed(),o!==void 0&&o()})}}function q6(n,e){return[[-1/0,-1/0,1/0,1/0]]}function H6(n,e,t,i){const r=[];let s=Yi();for(let o=0,a=t.length;o<a;++o){const u=t[o];s=Ow(n,e,u[0],i),r.push((s[0]+s[2])/2,(s[1]+s[3])/2),e=u[u.length-1]}return r}function tx(n,e,t,i,r,s,o){let a,u,h,d,g,m,v;const y=r[s+1],I=[];for(let P=0,b=t.length;P<b;++P){const L=t[P];for(d=n[L-i],m=n[L-i+1],a=e;a<L;a+=i)g=n[a],v=n[a+1],(y<=m&&v<=y||m<=y&&y<=v)&&(h=(y-m)/(v-m)*(g-d)+d,I.push(h)),d=g,m=v}let w=NaN,R=-1/0;for(I.sort(co),d=I[0],a=1,u=I.length;a<u;++a){g=I[a];const P=Math.abs(g-d);P>R&&(h=(d+g)/2,Hw(n,e,t,i,h,y)&&(w=h,R=P)),d=g}return isNaN(w)&&(w=r[s]),o?(o.push(w,y,R),o):[w,y,R]}function X6(n,e,t,i,r){let s=[];for(let o=0,a=t.length;o<a;++o){const u=t[o];s=tx(n,e,u,i,r,2*o,s),e=u[u.length-1]}return s}function Y6(n,e,t,i){for(;e<t-i;){for(let r=0;r<i;++r){const s=n[e+r];n[e+r]=n[t-i+r],n[t-i+r]=s}e+=i,t-=i}}function nx(n,e,t,i){let r=0,s=n[t-i],o=n[t-i+1];for(;e<t;e+=i){const a=n[e],u=n[e+1];r+=(a-s)*(u+o),s=a,o=u}return r===0?void 0:r>0}function kb(n,e,t,i,r){r=r!==void 0?r:!1;for(let s=0,o=t.length;s<o;++s){const a=t[s],u=nx(n,e,a,i);if(s===0){if(r&&u||!r&&!u)return!1}else if(r&&!u||!r&&u)return!1;e=a}return!0}function qne(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const a=t[s];if(!kb(n,e,a,i,r))return!1;a.length&&(e=a[a.length-1])}return!0}function fE(n,e,t,i,r){r=r!==void 0?r:!1;for(let s=0,o=t.length;s<o;++s){const a=t[s],u=nx(n,e,a,i);(s===0?r&&u||!r&&!u:r&&!u||!r&&u)&&Y6(n,e,a,i),e=a}return e}function Hne(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s)e=fE(n,e,t[s],i,r);return e}function Z6(n,e){const t=[];let i=0,r=0,s;for(let o=0,a=e.length;o<a;++o){const u=e[o],h=nx(n,i,u,2);if(s===void 0&&(s=h),h===s)t.push(e.slice(r,o+1));else{if(t.length===0)continue;t[t.length-1].push(e[r])}r=o+1,i=u}return t}function Lb(n,e,t,i){let r=0;const s=n[t-i],o=n[t-i+1];let a=0,u=0;for(;e<t;e+=i){const h=n[e]-s,d=n[e+1]-o;r+=u*h-a*d,a=h,u=d}return r/2}function Db(n,e,t,i){let r=0;for(let s=0,o=t.length;s<o;++s){const a=t[s];r+=Lb(n,e,a,i),e=a}return r}function Xne(n,e,t,i){let r=0;for(let s=0,o=t.length;s<o;++s){const a=t[s];r+=Db(n,e,a,i),e=a[a.length-1]}return r}class Of extends T_{constructor(e,t){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}clone(){return new Of(this.flatCoordinates.slice(),this.layout)}closestPointXY(e,t,i,r){return r<Nw(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Ww(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Kw(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,t,i,r))}getArea(){return Lb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return Fl(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(e){const t=[];return t.length=S_(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new Of(t,"XY")}getType(){return"LinearRing"}intersectsExtent(e){return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=qw(this.flatCoordinates,0,e,this.stride),this.changed()}}class Vf extends T_{constructor(e,t,i){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,t!==void 0&&i?(this.setFlatCoordinates(t,e),this.ends_=i):this.setCoordinates(e,t)}appendLinearRing(e){this.flatCoordinates?g_(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new Vf(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,i,r){return r<Nw(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(cb(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),hb(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,t,i,r))}containsXY(e,t){return Hw(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,t)}getArea(){return Db(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),fE(t,0,this.ends_,this.stride,e)):t=this.flatCoordinates,c0(t,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const e=Zl(this.getExtent());this.flatInteriorPoint_=tx(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new d0(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(e){return e<0||this.ends_.length<=e?null:new Of(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLinearRings(){const e=this.layout,t=this.flatCoordinates,i=this.ends_,r=[];let s=0;for(let o=0,a=i.length;o<a;++o){const u=i[o],h=new Of(t.slice(s,u),e);r.push(h),s=u}return r}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;kb(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=fE(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],i=[];return t.length=Xw(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(e),t,0,i),new Vf(t,"XY",i)}getType(){return"Polygon"}intersectsExtent(e){return mb(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=db(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}}function aA(n){if(E_(n))throw new Error("Cannot create polygon from empty extent");const e=n[0],t=n[1],i=n[2],r=n[3],s=[e,t,e,r,i,r,i,t,e,t];return new Vf(s,"XY",[s.length])}const lA=Hr();class Br{constructor(e,t,i,r,s,o){this.styleFunction,this.extent_,this.id_=o,this.type_=e,this.flatCoordinates_=t,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=i||null,this.properties_=s,this.squaredTolerance_,this.stride_=r,this.simplifiedGeometry_}get(e){return this.properties_[e]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?WM(this.flatCoordinates_):Ow(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const e=Zl(this.getExtent());this.flatInteriorPoints_=tx(this.flatCoordinates_,0,this.ends_,2,e,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const e=Z6(this.flatCoordinates_,this.ends_),t=H6(this.flatCoordinates_,0,e,2);this.flatInteriorPoints_=X6(this.flatCoordinates_,0,e,2,t)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=lE(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const e=this.flatCoordinates_;let t=0;const i=this.ends_;for(let r=0,s=i.length;r<s;++r){const o=i[r],a=lE(e,t,o,2,.5);g_(this.flatMidpoints_,a),t=o}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(e){return this}simplifyTransformed(e,t){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(e){e=jn(e);const t=e.getExtent(),i=e.getWorldExtent();if(t&&i){const r=Jn(i)/Jn(t);_o(lA,i[0],i[3],r,-r,0,0,0),Ia(this.flatCoordinates_,0,this.flatCoordinates_.length,2,lA,this.flatCoordinates_)}}applyTransform(e){e(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new Br(this.type_,this.flatCoordinates_.slice(),this.ends_?.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=jM((e,t)=>{if(e===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),t&&this.simplifiedGeometry_.applyTransform(t);const i=this.simplifiedGeometry_.getFlatCoordinates();let r;switch(this.type_){case"LineString":i.length=S_(i,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,e,i,0),r=[i.length];break;case"MultiLineString":r=[],i.length=s6(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,e,i,0,r);break;case"Polygon":r=[],i.length=Xw(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(e),i,0,r);break}return r&&(this.simplifiedGeometry_=new Br(this.type_,i,r,2,this.properties_,this.id_)),this.squaredTolerance_=e,this.simplifiedGeometry_}),this}}Br.prototype.getFlatCoordinates=Br.prototype.getOrientedFlatCoordinates;function Nb(n,e,t=0,i=n.length-1,r=Q6){for(;i>t;){if(i-t>600){const u=i-t+1,h=e-t+1,d=Math.log(u),g=.5*Math.exp(2*d/3),m=.5*Math.sqrt(d*g*(u-g)/u)*(h-u/2<0?-1:1),v=Math.max(t,Math.floor(e-h*g/u+m)),y=Math.min(i,Math.floor(e+(u-h)*g/u+m));Nb(n,e,v,y,r)}const s=n[e];let o=t,a=i;for(kd(n,t,e),r(n[i],s)>0&&kd(n,t,i);o<a;){for(kd(n,o,a),o++,a--;r(n[o],s)<0;)o++;for(;r(n[a],s)>0;)a--}r(n[t],s)===0?kd(n,t,a):(a++,kd(n,a,i)),a<=e&&(t=a+1),e<=a&&(i=a-1)}}function kd(n,e,t){const i=n[e];n[e]=n[t],n[t]=i}function Q6(n,e){return n<e?-1:n>e?1:0}let Ob=class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data;const i=[];if(!cp(e,t))return i;const r=this.toBBox,s=[];for(;t;){for(let o=0;o<t.children.length;o++){const a=t.children[o],u=t.leaf?r(a):a;cp(e,u)&&(t.leaf?i.push(a):t1(e,u)?this._all(a,i):s.push(a))}t=s.pop()}return i}collides(e){let t=this.data;if(!cp(e,t))return!1;const i=[];for(;t;){for(let r=0;r<t.children.length;r++){const s=t.children[r],o=t.leaf?this.toBBox(s):s;if(cp(e,o)){if(t.leaf||t1(e,o))return!0;i.push(s)}}t=i.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let i=0;i<e.length;i++)this.insert(e[i]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=t;else if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const i=this.data;this.data=t,t=i}this._insert(t,this.data.height-t.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=xc([]),this}remove(e,t){if(!e)return this;let i=this.data;const r=this.toBBox(e),s=[],o=[];let a,u,h;for(;i||s.length;){if(i||(i=s.pop(),u=s[s.length-1],a=o.pop(),h=!0),i.leaf){const d=J6(e,i.children,t);if(d!==-1)return i.children.splice(d,1),s.push(i),this._condense(s),this}!h&&!i.leaf&&t1(i,r)?(s.push(i),o.push(a),a=0,u=i,i=i.children[0]):u?(a++,i=u.children[a],h=!1):i=null}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){const i=[];for(;e;)e.leaf?t.push(...e.children):i.push(...e.children),e=i.pop();return t}_build(e,t,i,r){const s=i-t+1;let o=this._maxEntries,a;if(s<=o)return a=xc(e.slice(t,i+1)),uc(a,this.toBBox),a;r||(r=Math.ceil(Math.log(s)/Math.log(o)),o=Math.ceil(s/Math.pow(o,r-1))),a=xc([]),a.leaf=!1,a.height=r;const u=Math.ceil(s/o),h=u*Math.ceil(Math.sqrt(o));uA(e,t,i,h,this.compareMinX);for(let d=t;d<=i;d+=h){const g=Math.min(d+h-1,i);uA(e,d,g,u,this.compareMinY);for(let m=d;m<=g;m+=u){const v=Math.min(m+u-1,g);a.children.push(this._build(e,m,v,r-1))}}return uc(a,this.toBBox),a}_chooseSubtree(e,t,i,r){for(;r.push(t),!(t.leaf||r.length-1===i);){let s=1/0,o=1/0,a;for(let u=0;u<t.children.length;u++){const h=t.children[u],d=e1(h),g=n8(e,h)-d;g<o?(o=g,s=d<s?d:s,a=h):g===o&&d<s&&(s=d,a=h)}t=a||t.children[0]}return t}_insert(e,t,i){const r=i?e:this.toBBox(e),s=[],o=this._chooseSubtree(r,this.data,t,s);for(o.children.push(e),zd(o,r);t>=0&&s[t].children.length>this._maxEntries;)this._split(s,t),t--;this._adjustParentBBoxes(r,s,t)}_split(e,t){const i=e[t],r=i.children.length,s=this._minEntries;this._chooseSplitAxis(i,s,r);const o=this._chooseSplitIndex(i,s,r),a=xc(i.children.splice(o,i.children.length-o));a.height=i.height,a.leaf=i.leaf,uc(i,this.toBBox),uc(a,this.toBBox),t?e[t-1].children.push(a):this._splitRoot(i,a)}_splitRoot(e,t){this.data=xc([e,t]),this.data.height=e.height+1,this.data.leaf=!1,uc(this.data,this.toBBox)}_chooseSplitIndex(e,t,i){let r,s=1/0,o=1/0;for(let a=t;a<=i-t;a++){const u=Bd(e,0,a,this.toBBox),h=Bd(e,a,i,this.toBBox),d=i8(u,h),g=e1(u)+e1(h);d<s?(s=d,r=a,o=g<o?g:o):d===s&&g<o&&(o=g,r=a)}return r||i-t}_chooseSplitAxis(e,t,i){const r=e.leaf?this.compareMinX:e8,s=e.leaf?this.compareMinY:t8,o=this._allDistMargin(e,t,i,r),a=this._allDistMargin(e,t,i,s);o<a&&e.children.sort(r)}_allDistMargin(e,t,i,r){e.children.sort(r);const s=this.toBBox,o=Bd(e,0,t,s),a=Bd(e,i-t,i,s);let u=up(o)+up(a);for(let h=t;h<i-t;h++){const d=e.children[h];zd(o,e.leaf?s(d):d),u+=up(o)}for(let h=i-t-1;h>=t;h--){const d=e.children[h];zd(a,e.leaf?s(d):d),u+=up(a)}return u}_adjustParentBBoxes(e,t,i){for(let r=i;r>=0;r--)zd(t[r],e)}_condense(e){for(let t=e.length-1,i;t>=0;t--)e[t].children.length===0?t>0?(i=e[t-1].children,i.splice(i.indexOf(e[t]),1)):this.clear():uc(e[t],this.toBBox)}};function J6(n,e,t){if(!t)return e.indexOf(n);for(let i=0;i<e.length;i++)if(t(n,e[i]))return i;return-1}function uc(n,e){Bd(n,0,n.children.length,e,n)}function Bd(n,e,t,i,r){r||(r=xc(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(let s=e;s<t;s++){const o=n.children[s];zd(r,n.leaf?i(o):o)}return r}function zd(n,e){return n.minX=Math.min(n.minX,e.minX),n.minY=Math.min(n.minY,e.minY),n.maxX=Math.max(n.maxX,e.maxX),n.maxY=Math.max(n.maxY,e.maxY),n}function e8(n,e){return n.minX-e.minX}function t8(n,e){return n.minY-e.minY}function e1(n){return(n.maxX-n.minX)*(n.maxY-n.minY)}function up(n){return n.maxX-n.minX+(n.maxY-n.minY)}function n8(n,e){return(Math.max(e.maxX,n.maxX)-Math.min(e.minX,n.minX))*(Math.max(e.maxY,n.maxY)-Math.min(e.minY,n.minY))}function i8(n,e){const t=Math.max(n.minX,e.minX),i=Math.max(n.minY,e.minY),r=Math.min(n.maxX,e.maxX),s=Math.min(n.maxY,e.maxY);return Math.max(0,r-t)*Math.max(0,s-i)}function t1(n,e){return n.minX<=e.minX&&n.minY<=e.minY&&e.maxX<=n.maxX&&e.maxY<=n.maxY}function cp(n,e){return e.minX<=n.maxX&&e.minY<=n.maxY&&e.maxX>=n.minX&&e.maxY>=n.minY}function xc(n){return{children:n,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function uA(n,e,t,i,r){const s=[e,t];for(;s.length;){if(t=s.pop(),e=s.pop(),t-e<=i)continue;const o=e+Math.ceil((t-e)/i/2)*i;Nb(n,o,e,t,r),s.push(e,o,o,t)}}class cA{constructor(e){this.rbush_=new Ob(e),this.items_={}}insert(e,t){const i={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:t};this.rbush_.insert(i),this.items_[lt(t)]=i}load(e,t){const i=new Array(t.length);for(let r=0,s=t.length;r<s;r++){const o=e[r],a=t[r],u={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:a};i[r]=u,this.items_[lt(a)]=u}this.rbush_.load(i)}remove(e){const t=lt(e),i=this.items_[t];return delete this.items_[t],this.rbush_.remove(i)!==null}update(e,t){const i=this.items_[lt(t)],r=[i.minX,i.minY,i.maxX,i.maxY];bf(r,e)||(this.remove(t),this.insert(e,t))}getAll(){return this.rbush_.all().map(function(t){return t.value})}getInExtent(e){const t={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this.rbush_.search(t).map(function(r){return r.value})}forEach(e){return this.forEach_(this.getAll(),e)}forEachInExtent(e,t){return this.forEach_(this.getInExtent(e),t)}forEach_(e,t){let i;for(let r=0,s=e.length;r<s;r++)if(i=t(e[r]),i)return i;return i}isEmpty(){return rh(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(e){const t=this.rbush_.toJSON();return ba(t.minX,t.minY,t.maxX,t.maxY,e)}concat(e){this.rbush_.load(e.rbush_.all());for(const t in e.items_)this.items_[t]=e.items_[t]}}class Vb extends Ns{constructor(e){super(),this.projection=jn(e.projection),this.attributions_=hA(e.attributions),this.attributionsCollapsible_=e.attributionsCollapsible??!0,this.loading=!1,this.state_=e.state!==void 0?e.state:"ready",this.wrapX_=e.wrapX!==void 0?e.wrapX:!1,this.interpolate_=!!e.interpolate,this.viewResolver=null,this.viewRejector=null;const t=this;this.viewPromise_=new Promise(function(i,r){t.viewResolver=i,t.viewRejector=r})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(e){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(e){this.attributions_=hA(e),this.changed()}setState(e){this.state_=e,this.changed()}}function hA(n){return n?typeof n=="function"?n:(Array.isArray(n)||(n=[n]),e=>n):null}const gr={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};class Qo extends Io{constructor(e,t,i){super(e),this.feature=t,this.features=i}}class Fb extends Vb{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:e.wrapX!==void 0?e.wrapX:!0}),this.on,this.once,this.un,this.loader_=Cf,this.format_=e.format||null,this.overlaps_=e.overlaps===void 0?!0:e.overlaps,this.url_=e.url,e.loader!==void 0?this.loader_=e.loader:this.url_!==void 0&&(_t(this.format_,"`format` must be set when `url` is set"),this.loader_=oA(this.url_,this.format_)),this.strategy_=e.strategy!==void 0?e.strategy:q6;const t=e.useSpatialIndex!==void 0?e.useSpatialIndex:!0;this.featuresRtree_=t?new cA:null,this.loadedExtentsRtree_=new cA,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let i,r;Array.isArray(e.features)?r=e.features:e.features&&(i=e.features,r=i.getArray()),!t&&i===void 0&&(i=new Er(r)),r!==void 0&&this.addFeaturesInternal(r),i!==void 0&&this.bindFeaturesCollection_(i)}addFeature(e){this.addFeatureInternal(e),this.changed()}addFeatureInternal(e){const t=lt(e);if(!this.addToIndex_(t,e)){this.featuresCollection_&&this.featuresCollection_.remove(e);return}this.setupChangeEvents_(t,e);const i=e.getGeometry();if(i){const r=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(r,e)}else this.nullGeometryFeatures_[t]=e;this.dispatchEvent(new Qo(gr.ADDFEATURE,e))}setupChangeEvents_(e,t){t instanceof Br||(this.featureChangeKeys_[e]=[at(t,He.CHANGE,this.handleFeatureChange_,this),at(t,ih.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(e,t){let i=!0;if(t.getId()!==void 0){const r=String(t.getId());if(!(r in this.idIndex_))this.idIndex_[r]=t;else if(t instanceof Br){const s=this.idIndex_[r];s instanceof Br?Array.isArray(s)?s.push(t):this.idIndex_[r]=[s,t]:i=!1}else i=!1}return i&&(_t(!(e in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[e]=t),i}addFeatures(e){this.addFeaturesInternal(e),this.changed()}addFeaturesInternal(e){const t=[],i=[],r=[];for(let s=0,o=e.length;s<o;s++){const a=e[s],u=lt(a);this.addToIndex_(u,a)&&i.push(a)}for(let s=0,o=i.length;s<o;s++){const a=i[s],u=lt(a);this.setupChangeEvents_(u,a);const h=a.getGeometry();if(h){const d=h.getExtent();t.push(d),r.push(a)}else this.nullGeometryFeatures_[u]=a}if(this.featuresRtree_&&this.featuresRtree_.load(t,r),this.hasListener(gr.ADDFEATURE))for(let s=0,o=i.length;s<o;s++)this.dispatchEvent(new Qo(gr.ADDFEATURE,i[s]))}bindFeaturesCollection_(e){let t=!1;this.addEventListener(gr.ADDFEATURE,function(i){t||(t=!0,e.push(i.feature),t=!1)}),this.addEventListener(gr.REMOVEFEATURE,function(i){t||(t=!0,e.remove(i.feature),t=!1)}),e.addEventListener(Ii.ADD,i=>{t||(t=!0,this.addFeature(i.element),t=!1)}),e.addEventListener(Ii.REMOVE,i=>{t||(t=!0,this.removeFeature(i.element),t=!1)}),this.featuresCollection_=e}clear(e){if(e){for(const i in this.featureChangeKeys_)this.featureChangeKeys_[i].forEach(Ft);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(i=>{this.removeFeatureInternal(i)});for(const i in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[i])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const t=new Qo(gr.CLEAR);this.dispatchEvent(t),this.changed()}forEachFeature(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureAtCoordinateDirect(e,t){const i=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(i,function(r){const s=r.getGeometry();if(s instanceof Br||s.intersectsCoordinate(e))return t(r)})}forEachFeatureInExtent(e,t){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureIntersectingExtent(e,t){return this.forEachFeatureInExtent(e,function(i){const r=i.getGeometry();if(r instanceof Br||r.intersectsExtent(e)){const s=t(i);if(s)return s}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let e;return this.featuresCollection_?e=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(e=this.featuresRtree_.getAll(),rh(this.nullGeometryFeatures_)||g_(e,Object.values(this.nullGeometryFeatures_))),e}getFeaturesAtCoordinate(e){const t=[];return this.forEachFeatureAtCoordinateDirect(e,function(i){t.push(i)}),t}getFeaturesInExtent(e,t){if(this.featuresRtree_){if(!(t&&t.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(e);const r=YM(e,t);return[].concat(...r.map(s=>this.featuresRtree_.getInExtent(s)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(e,t){const i=e[0],r=e[1];let s=null;const o=[NaN,NaN];let a=1/0;const u=[-1/0,-1/0,1/0,1/0];return t=t||Pf,this.featuresRtree_.forEachInExtent(u,function(h){if(t(h)){const d=h.getGeometry(),g=a;if(a=d instanceof Br?0:d.closestPointXY(i,r,o,a),a<g){s=h;const m=Math.sqrt(a);u[0]=i-m,u[1]=r-m,u[2]=i+m,u[3]=r+m}}}),s}getExtent(e){return this.featuresRtree_.getExtent(e)}getFeatureById(e){const t=this.idIndex_[e.toString()];return t!==void 0?t:null}getFeatureByUid(e){const t=this.uidIndex_[e];return t!==void 0?t:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(e){const t=e.target,i=lt(t),r=t.getGeometry();if(!r)i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(t),this.nullGeometryFeatures_[i]=t);else{const o=r.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(o,t)):this.featuresRtree_&&this.featuresRtree_.update(o,t)}const s=t.getId();if(s!==void 0){const o=s.toString();this.idIndex_[o]!==t&&(this.removeFromIdIndex_(t),this.idIndex_[o]=t)}else this.removeFromIdIndex_(t),this.uidIndex_[i]=t;this.changed(),this.dispatchEvent(new Qo(gr.CHANGEFEATURE,t))}hasFeature(e){const t=e.getId();return t!==void 0?t in this.idIndex_:lt(e)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&rh(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(e,t,i){const r=this.loadedExtentsRtree_,s=this.strategy_(e,t,i);for(let o=0,a=s.length;o<a;++o){const u=s[o];r.forEachInExtent(u,function(d){return Ud(d.extent,u)})||(++this.loadingExtentsCount_,this.dispatchEvent(new Qo(gr.FEATURESLOADSTART)),this.loader_.call(this,u,t,i,d=>{--this.loadingExtentsCount_,this.dispatchEvent(new Qo(gr.FEATURESLOADEND,void 0,d))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new Qo(gr.FEATURESLOADERROR))}),r.insert(u,{extent:u.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(e){const t=this.loadedExtentsRtree_,i=t.forEachInExtent(e,function(r){if(bf(r.extent,e))return r});i&&t.remove(i)}removeFeatures(e){let t=!1;for(let i=0,r=e.length;i<r;++i)t=this.removeFeatureInternal(e[i])||t;t&&this.changed()}removeFeature(e){if(!e)return;this.removeFeatureInternal(e)&&this.changed()}removeFeatureInternal(e){const t=lt(e);if(!(t in this.uidIndex_))return!1;t in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[t]:this.featuresRtree_&&this.featuresRtree_.remove(e),this.featureChangeKeys_[t]?.forEach(Ft),delete this.featureChangeKeys_[t];const r=e.getId();if(r!==void 0){const s=r.toString(),o=this.idIndex_[s];o===e?delete this.idIndex_[s]:Array.isArray(o)&&(o.splice(o.indexOf(e),1),o.length===1&&(this.idIndex_[s]=o[0]))}return delete this.uidIndex_[t],this.hasListener(gr.REMOVEFEATURE)&&this.dispatchEvent(new Qo(gr.REMOVEFEATURE,e)),!0}removeFromIdIndex_(e){for(const t in this.idIndex_)if(this.idIndex_[t]===e){delete this.idIndex_[t];break}}setLoader(e){this.loader_=e}setUrl(e){_t(this.format_,"`format` must be set when `url` is set"),this.url_=e,this.setLoader(oA(e,this.format_))}setOverlaps(e){this.overlaps_=e,this.changed()}}class ka{constructor(e){e=e||{},this.patternImage_=null,this.color_=null,e.color!==void 0&&this.setColor(e.color)}clone(){const e=this.getColor();return new ka({color:Array.isArray(e)?e.slice():e||void 0})}getColor(){return this.color_}setColor(e){if(e!==null&&typeof e=="object"&&"src"in e){const t=g0(null,e.src,"anonymous",void 0,e.offset?null:e.color?e.color:null,!(e.offset&&e.size));t.ready().then(()=>{this.patternImage_=null}),t.getImageState()===ze.IDLE&&t.load(),t.getImageState()===ze.LOADING&&(this.patternImage_=t)}this.color_=e}getKey(){const e=this.getColor();return e?e instanceof CanvasPattern||e instanceof CanvasGradient?lt(e):typeof e=="object"&&"src"in e?e.src+":"+e.offset:ah(e).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}class Wl{constructor(e){e=e||{},this.color_=e.color!==void 0?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=e.lineDash!==void 0?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}clone(){const e=this.getColor();return new Wl({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(e){this.color_=e}setLineCap(e){this.lineCap_=e}setLineDash(e){this.lineDash_=e}setLineDashOffset(e){this.lineDashOffset_=e}setLineJoin(e){this.lineJoin_=e}setMiterLimit(e){this.miterLimit_=e}setWidth(e){this.width_=e}}function dA(n){return n[0]>0&&n[1]>0}function r8(n,e,t){return t===void 0&&(t=[0,0]),t[0]=n[0]*e+.5|0,t[1]=n[1]*e+.5|0,t}function Mi(n,e){return Array.isArray(n)?n:(e===void 0?e=[n,n]:(e[0]=n,e[1]=n),e)}class P_{constructor(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=Mi(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new P_({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return ot()}getImage(e){return ot()}getHitDetectionImage(){return ot()}getPixelRatio(e){return 1}getImageState(){return ot()}getImageSize(){return ot()}getOrigin(){return ot()}getSize(){return ot()}setDisplacement(e){this.displacement_=e}setOpacity(e){this.opacity_=e}setRotateWithView(e){this.rotateWithView_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=Mi(e)}listenImageChange(e){ot()}load(){ot()}unlistenImageChange(e){ot()}ready(){return Promise.resolve()}}class C_ extends P_{constructor(e){super({opacity:1,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,rotation:e.rotation!==void 0?e.rotation:0,scale:e.scale!==void 0?e.scale:1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=e.fill!==void 0?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius=e.radius,this.radius2_=e.radius2,this.angle_=e.angle!==void 0?e.angle:0,this.stroke_=e.stroke!==void 0?e.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?ze.LOADING:ze.LOADED,this.imageState_===ze.LOADING&&this.ready().then(()=>this.imageState_=ze.LOADED),this.render()}clone(){const e=this.getScale(),t=new C_({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}getAnchor(){const e=this.size_,t=this.getDisplacement(),i=this.getScaleArray();return[e[0]/2-t[0]/i[0],e[1]/2+t[1]/i[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(e){this.fill_=e,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(e){const t=this.fill_?.getKey(),i=`${e},${this.angle_},${this.radius},${this.radius2_},${this.points_},${t}`+Object.values(this.renderOptions_).join(",");let r=xr.get(i,null,null)?.getImage(1);if(!r){const s=this.renderOptions_,o=Math.ceil(s.size*e),a=mn(o,o);this.draw_(s,a,e),r=a.canvas,xr.set(i,null,null,new Ib(r,void 0,null,ze.LOADED,null))}return r}getPixelRatio(e){return e}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e,this.render()}listenImageChange(e){}load(){}unlistenImageChange(e){}calculateLineJoinSize_(e,t,i){if(t===0||this.points_===1/0||e!=="bevel"&&e!=="miter")return t;let r=this.radius,s=this.radius2_===void 0?r:this.radius2_;if(r<s){const B=r;r=s,s=B}const o=this.radius2_===void 0?this.points_:this.points_*2,a=2*Math.PI/o,u=s*Math.sin(a),h=Math.sqrt(s*s-u*u),d=r-h,g=Math.sqrt(u*u+d*d),m=g/u;if(e==="miter"&&m<=i)return m*t;const v=t/2/m,y=t/2*(d/g),w=Math.sqrt((r+v)*(r+v)+y*y)-r;if(this.radius2_===void 0||e==="bevel")return w*2;const R=r*Math.sin(a),P=Math.sqrt(r*r-R*R),b=s-P,D=Math.sqrt(R*R+b*b)/R;if(D<=i){const B=D*t/2-s-r;return 2*Math.max(w,B)}return w*2}createRenderOptions(){let e=lh,t=uh,i=0,r=null,s=0,o,a=0;this.stroke_&&(o=xs(this.stroke_.getColor()??Lf),a=this.stroke_.getWidth()??Nf,r=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,t=this.stroke_.getLineJoin()??uh,e=this.stroke_.getLineCap()??lh,i=this.stroke_.getMiterLimit()??kf);const u=this.calculateLineJoinSize_(t,a,i),h=Math.max(this.radius,this.radius2_||0),d=Math.ceil(2*h+u);return{strokeStyle:o,strokeWidth:a,size:d,lineCap:e,lineDash:r,lineDashOffset:s,lineJoin:t,miterLimit:i}}render(){this.renderOptions_=this.createRenderOptions();const e=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[e,e]}draw_(e,t,i){if(t.scale(i,i),t.translate(e.size/2,e.size/2),this.createPath_(t),this.fill_){let r=this.fill_.getColor();r===null&&(r=Si),t.fillStyle=xs(r),t.fill()}e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}createHitDetectionCanvas_(e){let t;if(this.fill_){let i=this.fill_.getColor(),r=0;typeof i=="string"&&(i=ah(i)),i===null?r=1:Array.isArray(i)&&(r=i.length===4?i[3]:1),r===0&&(t=mn(e.size,e.size),this.drawHitDetectionCanvas_(e,t))}return t?t.canvas:this.getImage(1)}createPath_(e){let t=this.points_;const i=this.radius;if(t===1/0)e.arc(0,0,i,0,2*Math.PI);else{const r=this.radius2_===void 0?i:this.radius2_;this.radius2_!==void 0&&(t*=2);const s=this.angle_-Math.PI/2,o=2*Math.PI/t;for(let a=0;a<t;a++){const u=s+a*o,h=a%2===0?i:r;e.lineTo(h*Math.cos(u),h*Math.sin(u))}e.closePath()}}drawHitDetectionCanvas_(e,t){t.translate(e.size/2,e.size/2),this.createPath_(t),t.fillStyle=Si,t.fill(),e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class Ch extends C_{constructor(e){e=e||{radius:5},super({points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:e.scale!==void 0?e.scale:1,rotation:e.rotation!==void 0?e.rotation:0,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode})}clone(){const e=this.getScale(),t=new Ch({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}setRadius(e){this.radius=e,this.render()}}class qi{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=fA,e.geometry!==void 0&&this.setGeometry(e.geometry),this.fill_=e.fill!==void 0?e.fill:null,this.image_=e.image!==void 0?e.image:null,this.renderer_=e.renderer!==void 0?e.renderer:null,this.hitDetectionRenderer_=e.hitDetectionRenderer!==void 0?e.hitDetectionRenderer:null,this.stroke_=e.stroke!==void 0?e.stroke:null,this.text_=e.text!==void 0?e.text:null,this.zIndex_=e.zIndex}clone(){let e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new qi({geometry:e??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(e){this.renderer_=e}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(e){this.fill_=e}getImage(){return this.image_}setImage(e){this.image_=e}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e}getText(){return this.text_}setText(e){this.text_=e}getZIndex(){return this.zIndex_}setGeometry(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(t){return t.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=fA,this.geometry_=e}setZIndex(e){this.zIndex_=e}}function s8(n){let e;if(typeof n=="function")e=n;else{let t;Array.isArray(n)?t=n:(_t(typeof n.getZIndex=="function","Expected an `Style` or an array of `Style`"),t=[n]),e=function(){return t}}return e}let n1=null;function Gb(n,e){if(!n1){const t=new ka({color:"rgba(255,255,255,0.4)"}),i=new Wl({color:"#3399CC",width:1.25});n1=[new qi({image:new Ch({fill:t,stroke:i,radius:5}),fill:t,stroke:i})]}return n1}function fA(n){return n.getGeometry()}const o8="#333";class ix{constructor(e){e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.keepUpright_=e.keepUpright,this.scale_=e.scale,this.scaleArray_=Mi(e.scale!==void 0?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=e.fill!==void 0?e.fill:new ka({color:o8}),this.maxAngle_=e.maxAngle!==void 0?e.maxAngle:Math.PI/4,this.placement_=e.placement!==void 0?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=e.stroke!==void 0?e.stroke:null,this.offsetX_=e.offsetX!==void 0?e.offsetX:0,this.offsetY_=e.offsetY!==void 0?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=e.padding===void 0?null:e.padding,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new ix({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()instanceof ka?this.getFill().clone():this.getFill(),stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(e){this.overflow_=e}setFont(e){this.font_=e}setMaxAngle(e){this.maxAngle_=e}setOffsetX(e){this.offsetX_=e}setOffsetY(e){this.offsetY_=e}setPlacement(e){this.placement_=e}setRepeat(e){this.repeat_=e}setRotateWithView(e){this.rotateWithView_=e}setKeepUpright(e){this.keepUpright_=e}setFill(e){this.fill_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=Mi(e!==void 0?e:1)}setStroke(e){this.stroke_=e}setText(e){this.text_=e}setTextAlign(e){this.textAlign_=e}setJustify(e){this.justify_=e}setTextBaseline(e){this.textBaseline_=e}setBackgroundFill(e){this.backgroundFill_=e}setBackgroundStroke(e){this.backgroundStroke_=e}setPadding(e){this.padding_=e}}const Xn={ANIMATING:0,INTERACTING:1},be={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},hp=[be.FILL],va=[be.STROKE],Ul=[be.BEGIN_PATH],gA=[be.CLOSE_PATH];class Eg extends Sb{constructor(e,t,i,r){super(),this.tolerance=e,this.maxExtent=t,this.pixelRatio=r,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(e){const t=this.pixelRatio;return t==1?e:e.map(function(i){return i*t})}appendFlatPointCoordinates(e,t){const i=this.getBufferedMaxExtent(),r=this.tmpCoordinate_,s=this.coordinates;let o=s.length;for(let a=0,u=e.length;a<u;a+=t)r[0]=e[a],r[1]=e[a+1],sh(i,r)&&(s[o++]=r[0],s[o++]=r[1]);return o}appendFlatLineCoordinates(e,t,i,r,s,o){const a=this.coordinates;let u=a.length;const h=this.getBufferedMaxExtent();o&&(t+=r);let d=e[t],g=e[t+1];const m=this.tmpCoordinate_;let v=!0,y,I,w;for(y=t+r;y<i;y+=r)m[0]=e[y],m[1]=e[y+1],w=Q1(h,m),w!==I?(v&&(a[u++]=d,a[u++]=g,v=!1),a[u++]=m[0],a[u++]=m[1]):w===Tn.INTERSECTING?(a[u++]=m[0],a[u++]=m[1],v=!1):v=!0,d=m[0],g=m[1],I=w;return(s&&v||y===t+r)&&(a[u++]=d,a[u++]=g),u}drawCustomCoordinates_(e,t,i,r,s){for(let o=0,a=i.length;o<a;++o){const u=i[o],h=this.appendFlatLineCoordinates(e,t,u,r,!1,!1);s.push(h),t=u}return t}drawCustom(e,t,i,r,s){this.beginGeometry(e,t,s);const o=e.getType(),a=e.getStride(),u=this.coordinates.length;let h,d,g,m,v;switch(o){case"MultiPolygon":h=e.getOrientedFlatCoordinates(),m=[];const y=e.getEndss();v=0;for(let I=0,w=y.length;I<w;++I){const R=[];v=this.drawCustomCoordinates_(h,v,y[I],a,R),m.push(R)}this.instructions.push([be.CUSTOM,u,m,e,i,Z2,s]),this.hitDetectionInstructions.push([be.CUSTOM,u,m,e,r||i,Z2,s]);break;case"Polygon":case"MultiLineString":g=[],h=o=="Polygon"?e.getOrientedFlatCoordinates():e.getFlatCoordinates(),v=this.drawCustomCoordinates_(h,0,e.getEnds(),a,g),this.instructions.push([be.CUSTOM,u,g,e,i,c0,s]),this.hitDetectionInstructions.push([be.CUSTOM,u,g,e,r||i,c0,s]);break;case"LineString":case"Circle":h=e.getFlatCoordinates(),d=this.appendFlatLineCoordinates(h,0,h.length,a,!1,!1),this.instructions.push([be.CUSTOM,u,d,e,i,Fl,s]),this.hitDetectionInstructions.push([be.CUSTOM,u,d,e,r||i,Fl,s]);break;case"MultiPoint":h=e.getFlatCoordinates(),d=this.appendFlatPointCoordinates(h,a),d>u&&(this.instructions.push([be.CUSTOM,u,d,e,i,Fl,s]),this.hitDetectionInstructions.push([be.CUSTOM,u,d,e,r||i,Fl,s]));break;case"Point":h=e.getFlatCoordinates(),this.coordinates.push(h[0],h[1]),d=this.coordinates.length,this.instructions.push([be.CUSTOM,u,d,e,i,void 0,s]),this.hitDetectionInstructions.push([be.CUSTOM,u,d,e,r||i,void 0,s]);break}this.endGeometry(t)}beginGeometry(e,t,i){this.beginGeometryInstruction1_=[be.BEGIN_GEOMETRY,t,0,e,i],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[be.BEGIN_GEOMETRY,t,0,e,i],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const e=this.hitDetectionInstructions;e.reverse();let t;const i=e.length;let r,s,o=-1;for(t=0;t<i;++t)r=e[t],s=r[0],s==be.END_GEOMETRY?o=t:s==be.BEGIN_GEOMETRY&&(r[2]=t,r5(this.hitDetectionInstructions,o,t),o=-1)}fillStyleToState(e,t={}){if(e){const i=e.getColor();t.fillPatternScale=i&&typeof i=="object"&&"src"in i?this.pixelRatio:1,t.fillStyle=xs(i||Si)}else t.fillStyle=void 0;return t}strokeStyleToState(e,t={}){if(e){const i=e.getColor();t.strokeStyle=xs(i||Lf);const r=e.getLineCap();t.lineCap=r!==void 0?r:lh;const s=e.getLineDash();t.lineDash=s?s.slice():ho;const o=e.getLineDashOffset();t.lineDashOffset=o||fo;const a=e.getLineJoin();t.lineJoin=a!==void 0?a:uh;const u=e.getWidth();t.lineWidth=u!==void 0?u:Nf;const h=e.getMiterLimit();t.miterLimit=h!==void 0?h:kf,t.lineWidth>this.maxLineWidth&&(this.maxLineWidth=t.lineWidth,this.bufferedMaxExtent_=null)}else t.strokeStyle=void 0,t.lineCap=void 0,t.lineDash=null,t.lineDashOffset=void 0,t.lineJoin=void 0,t.lineWidth=void 0,t.miterLimit=void 0;return t}setFillStrokeStyle(e,t){const i=this.state;this.fillStyleToState(e,i),this.strokeStyleToState(t,i)}createFill(e){const t=e.fillStyle,i=[be.SET_FILL_STYLE,t];return typeof t!="string"&&i.push(e.fillPatternScale),i}applyStroke(e){this.instructions.push(this.createStroke(e))}createStroke(e){return[be.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth*this.pixelRatio,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash?this.applyPixelRatio(e.lineDash):null,e.lineDashOffset*this.pixelRatio]}updateFillStyle(e,t){const i=e.fillStyle;(typeof i!="string"||e.currentFillStyle!=i)&&(this.instructions.push(t.call(this,e)),e.currentFillStyle=i)}updateStrokeStyle(e,t){const i=e.strokeStyle,r=e.lineCap,s=e.lineDash,o=e.lineDashOffset,a=e.lineJoin,u=e.lineWidth,h=e.miterLimit;(e.currentStrokeStyle!=i||e.currentLineCap!=r||s!=e.currentLineDash&&!za(e.currentLineDash,s)||e.currentLineDashOffset!=o||e.currentLineJoin!=a||e.currentLineWidth!=u||e.currentMiterLimit!=h)&&(t.call(this,e),e.currentStrokeStyle=i,e.currentLineCap=r,e.currentLineDash=s,e.currentLineDashOffset=o,e.currentLineJoin=a,e.currentLineWidth=u,e.currentMiterLimit=h)}endGeometry(e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const t=[be.END_GEOMETRY,e];this.instructions.push(t),this.hitDetectionInstructions.push(t)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=zM(this.maxExtent),this.maxLineWidth>0)){const e=this.resolution*(this.maxLineWidth+1)/2;Mf(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class a8 extends Eg{constructor(e,t,i,r){super(e,t,i,r),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(e,t,i){if(!this.image_||this.maxExtent&&!sh(this.maxExtent,e.getFlatCoordinates()))return;this.beginGeometry(e,t,i);const r=e.getFlatCoordinates(),s=e.getStride(),o=this.coordinates.length,a=this.appendFlatPointCoordinates(r,s);this.instructions.push([be.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([be.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}drawMultiPoint(e,t,i){if(!this.image_)return;this.beginGeometry(e,t,i);const r=e.getFlatCoordinates(),s=[];for(let u=0,h=r.length;u<h;u+=e.getStride())(!this.maxExtent||sh(this.maxExtent,r.slice(u,u+2)))&&s.push(r[u],r[u+1]);const o=this.coordinates.length,a=this.appendFlatPointCoordinates(s,2);this.instructions.push([be.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([be.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(e,t){const i=e.getAnchor(),r=e.getSize(),s=e.getOrigin();this.imagePixelRatio_=e.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=e.getHitDetectionImage(),this.image_=e.getImage(this.pixelRatio),this.height_=r[1],this.opacity_=e.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=e.getRotateWithView(),this.rotation_=e.getRotation(),this.scale_=e.getScaleArray(),this.width_=r[0],this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}class l8 extends Eg{constructor(e,t,i,r){super(e,t,i,r)}drawFlatCoordinates_(e,t,i,r){const s=this.coordinates.length,o=this.appendFlatLineCoordinates(e,t,i,r,!1,!1),a=[be.MOVE_TO_LINE_TO,s,o];return this.instructions.push(a),this.hitDetectionInstructions.push(a),i}drawLineString(e,t,i){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(e,t,i),this.hitDetectionInstructions.push([be.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,ho,fo],Ul);const a=e.getFlatCoordinates(),u=e.getStride();this.drawFlatCoordinates_(a,0,a.length,u),this.hitDetectionInstructions.push(va),this.endGeometry(t)}drawMultiLineString(e,t,i){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(e,t,i),this.hitDetectionInstructions.push([be.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,ho,fo],Ul);const a=e.getEnds(),u=e.getFlatCoordinates(),h=e.getStride();let d=0;for(let g=0,m=a.length;g<m;++g)d=this.drawFlatCoordinates_(u,d,a[g],h);this.hitDetectionInstructions.push(va),this.endGeometry(t)}finish(){const e=this.state;return e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&this.instructions.push(va),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(e){e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(va),e.lastStroke=this.coordinates.length),e.lastStroke=0,super.applyStroke(e),this.instructions.push(Ul)}}class mA extends Eg{constructor(e,t,i,r){super(e,t,i,r)}drawFlatCoordinatess_(e,t,i,r){const s=this.state,o=s.fillStyle!==void 0,a=s.strokeStyle!==void 0,u=i.length;this.instructions.push(Ul),this.hitDetectionInstructions.push(Ul);for(let h=0;h<u;++h){const d=i[h],g=this.coordinates.length,m=this.appendFlatLineCoordinates(e,t,d,r,!0,!a),v=[be.MOVE_TO_LINE_TO,g,m];this.instructions.push(v),this.hitDetectionInstructions.push(v),a&&(this.instructions.push(gA),this.hitDetectionInstructions.push(gA)),t=d}return o&&(this.instructions.push(hp),this.hitDetectionInstructions.push(hp)),a&&(this.instructions.push(va),this.hitDetectionInstructions.push(va)),t}drawCircle(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([be.SET_FILL_STYLE,Si]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([be.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,ho,fo]);const a=e.getFlatCoordinates(),u=e.getStride(),h=this.coordinates.length;this.appendFlatLineCoordinates(a,0,a.length,u,!1,!1);const d=[be.CIRCLE,h];this.instructions.push(Ul,d),this.hitDetectionInstructions.push(Ul,d),r.fillStyle!==void 0&&(this.instructions.push(hp),this.hitDetectionInstructions.push(hp)),r.strokeStyle!==void 0&&(this.instructions.push(va),this.hitDetectionInstructions.push(va)),this.endGeometry(t)}drawPolygon(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([be.SET_FILL_STYLE,Si]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([be.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,ho,fo]);const a=e.getEnds(),u=e.getOrientedFlatCoordinates(),h=e.getStride();this.drawFlatCoordinatess_(u,0,a,h),this.endGeometry(t)}drawMultiPolygon(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([be.SET_FILL_STYLE,Si]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([be.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,ho,fo]);const a=e.getEndss(),u=e.getOrientedFlatCoordinates(),h=e.getStride();let d=0;for(let g=0,m=a.length;g<m;++g)d=this.drawFlatCoordinatess_(u,d,a[g],h);this.endGeometry(t)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const e=this.tolerance;if(e!==0){const t=this.coordinates;for(let i=0,r=t.length;i<r;++i)t[i]=Il(t[i],e)}return super.finish()}setFillStrokeStyles_(){const e=this.state;this.updateFillStyle(e,this.createFill),this.updateStrokeStyle(e,this.applyStroke)}}function u8(n,e,t,i,r){const s=[];let o=t,a=0,u=e.slice(t,2);for(;a<n&&o+r<i;){const[h,d]=u.slice(-2),g=e[o+r],m=e[o+r+1],v=Math.sqrt((g-h)*(g-h)+(m-d)*(m-d));if(a+=v,a>=n){const y=(n-a+v)/v,I=$i(h,g,y),w=$i(d,m,y);u.push(I,w),s.push(u),u=[I,w],a==n&&(o+=r),a=0}else if(a<n)u.push(e[o+r],e[o+r+1]),o+=r;else{const y=v-a,I=$i(h,g,y/v),w=$i(d,m,y/v);u.push(I,w),s.push(u),u=[I,w],a=0,o+=r}}return a>0&&s.push(u),s}function c8(n,e,t,i,r){let s=t,o=t,a=0,u=0,h=t,d,g,m,v,y,I,w,R,P,b;for(g=t;g<i;g+=r){const L=e[g],D=e[g+1];y!==void 0&&(P=L-y,b=D-I,v=Math.sqrt(P*P+b*b),w!==void 0&&(u+=m,d=Math.acos((w*P+R*b)/(m*v)),d>n&&(u>a&&(a=u,s=h,o=g),u=0,h=g-r)),m=v,w=P,R=b),y=L,I=D}return u+=v,u>a?[h,g]:[s,o]}const p0={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class h8 extends Eg{constructor(e,t,i,r){super(e,t,i,r),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[Si]={fillStyle:Si},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const e=super.finish();return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e}drawText(e,t,i){const r=this.textFillState_,s=this.textStrokeState_,o=this.textState_;if(this.text_===""||!o||!r&&!s)return;const a=this.coordinates;let u=a.length;const h=e.getType();let d=null,g=e.getStride();if(o.placement==="line"&&(h=="LineString"||h=="MultiLineString"||h=="Polygon"||h=="MultiPolygon")){if(!Ri(this.maxExtent,e.getExtent()))return;let m;if(d=e.getFlatCoordinates(),h=="LineString")m=[d.length];else if(h=="MultiLineString")m=e.getEnds();else if(h=="Polygon")m=e.getEnds().slice(0,1);else if(h=="MultiPolygon"){const w=e.getEndss();m=[];for(let R=0,P=w.length;R<P;++R)m.push(w[R][0])}this.beginGeometry(e,t,i);const v=o.repeat,y=v?void 0:o.textAlign;let I=0;for(let w=0,R=m.length;w<R;++w){let P;v?P=u8(v*this.resolution,d,I,m[w],g):P=[d.slice(I,m[w])];for(let b=0,L=P.length;b<L;++b){const D=P[b];let B=0,M=D.length;if(y==null){const k=c8(o.maxAngle,D,0,D.length,2);B=k[0],M=k[1]}for(let k=B;k<M;k+=g)a.push(D[k],D[k+1]);const A=a.length;I=m[w],this.drawChars_(u,A),u=A}}this.endGeometry(t)}else{let m=o.overflow?null:[];switch(h){case"Point":case"MultiPoint":d=e.getFlatCoordinates();break;case"LineString":d=e.getFlatMidpoint();break;case"Circle":d=e.getCenter();break;case"MultiLineString":d=e.getFlatMidpoints(),g=2;break;case"Polygon":d=e.getFlatInteriorPoint(),o.overflow||m.push(d[2]/this.resolution),g=3;break;case"MultiPolygon":const L=e.getFlatInteriorPoints();d=[];for(let D=0,B=L.length;D<B;D+=3)o.overflow||m.push(L[D+2]/this.resolution),d.push(L[D],L[D+1]);if(d.length===0)return;g=2;break}const v=this.appendFlatPointCoordinates(d,g);if(v===u)return;if(m&&(v-u)/2!==d.length/g){let L=u/2;m=m.filter((D,B)=>{const M=a[(L+B)*2]===d[B*g]&&a[(L+B)*2+1]===d[B*g+1];return M||--L,M})}this.saveTextStates_();const y=o.backgroundFill?this.createFill(this.fillStyleToState(o.backgroundFill)):null,I=o.backgroundStroke?this.createStroke(this.strokeStyleToState(o.backgroundStroke)):null;this.beginGeometry(e,t,i);let w=o.padding;if(w!=jl&&(o.scale[0]<0||o.scale[1]<0)){let L=o.padding[0],D=o.padding[1],B=o.padding[2],M=o.padding[3];o.scale[0]<0&&(D=-D,M=-M),o.scale[1]<0&&(L=-L,B=-B),w=[L,D,B,M]}const R=this.pixelRatio;this.instructions.push([be.DRAW_IMAGE,u,v,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,w==jl?jl:w.map(function(L){return L*R}),y,I,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,m]);const P=1/R,b=y?y.slice(0):null;b&&(b[1]=Si),this.hitDetectionInstructions.push([be.DRAW_IMAGE,u,v,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[P,P],NaN,this.declutterMode_,this.declutterImageWithText_,w,b,I,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?Si:this.fillKey_,this.textOffsetX_,this.textOffsetY_,m]),this.endGeometry(t)}}saveTextStates_(){const e=this.textStrokeState_,t=this.textState_,i=this.textFillState_,r=this.strokeKey_;e&&(r in this.strokeStates||(this.strokeStates[r]={strokeStyle:e.strokeStyle,lineCap:e.lineCap,lineDashOffset:e.lineDashOffset,lineWidth:e.lineWidth,lineJoin:e.lineJoin,miterLimit:e.miterLimit,lineDash:e.lineDash}));const s=this.textKey_;s in this.textStates||(this.textStates[s]={font:t.font,textAlign:t.textAlign||Df,justify:t.justify,textBaseline:t.textBaseline||m0,scale:t.scale});const o=this.fillKey_;i&&(o in this.fillStates||(this.fillStates[o]={fillStyle:i.fillStyle}))}drawChars_(e,t){const i=this.textStrokeState_,r=this.textState_,s=this.strokeKey_,o=this.textKey_,a=this.fillKey_;this.saveTextStates_();const u=this.pixelRatio,h=p0[r.textBaseline],d=this.textOffsetY_*u,g=this.text_,m=i?i.lineWidth*Math.abs(r.scale[0])/2:0;this.instructions.push([be.DRAW_CHARS,e,t,h,r.overflow,a,r.maxAngle,u,d,s,m*u,g,o,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([be.DRAW_CHARS,e,t,h,r.overflow,a&&Si,r.maxAngle,u,d,s,m*u,g,o,1/u,this.declutterMode_,this.textKeepUpright_])}setTextStyle(e,t){let i,r,s;if(!e)this.text_="";else{const o=e.getFill();o?(r=this.textFillState_,r||(r={},this.textFillState_=r),r.fillStyle=xs(o.getColor()||Si)):(r=null,this.textFillState_=r);const a=e.getStroke();if(!a)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);const I=a.getLineDash(),w=a.getLineDashOffset(),R=a.getWidth(),P=a.getMiterLimit();s.lineCap=a.getLineCap()||lh,s.lineDash=I?I.slice():ho,s.lineDashOffset=w===void 0?fo:w,s.lineJoin=a.getLineJoin()||uh,s.lineWidth=R===void 0?Nf:R,s.miterLimit=P===void 0?kf:P,s.strokeStyle=xs(a.getColor()||Lf)}i=this.textState_;const u=e.getFont()||Ab;P6(u);const h=e.getScaleArray();i.overflow=e.getOverflow(),i.font=u,i.maxAngle=e.getMaxAngle(),i.placement=e.getPlacement(),i.textAlign=e.getTextAlign(),i.repeat=e.getRepeat(),i.justify=e.getJustify(),i.textBaseline=e.getTextBaseline()||m0,i.backgroundFill=e.getBackgroundFill(),i.backgroundStroke=e.getBackgroundStroke(),i.padding=e.getPadding()||jl,i.scale=h===void 0?[1,1]:h;const d=e.getOffsetX(),g=e.getOffsetY(),m=e.getRotateWithView(),v=e.getKeepUpright(),y=e.getRotation();this.text_=e.getText()||"",this.textOffsetX_=d===void 0?0:d,this.textOffsetY_=g===void 0?0:g,this.textRotateWithView_=m===void 0?!1:m,this.textKeepUpright_=v===void 0?!0:v,this.textRotation_=y===void 0?0:y,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:lt(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=r&&r.fillStyle?typeof r.fillStyle=="string"?r.fillStyle:"|"+lt(r.fillStyle):""}this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}const d8={Circle:mA,Default:Eg,Image:a8,LineString:l8,Polygon:mA,Text:h8};class f8{constructor(e,t,i,r){this.tolerance_=e,this.maxExtent_=t,this.pixelRatio_=r,this.resolution_=i,this.buildersByZIndex_={}}finish(){const e={};for(const t in this.buildersByZIndex_){e[t]=e[t]||{};const i=this.buildersByZIndex_[t];for(const r in i){const s=i[r].finish();e[t][r]=s}}return e}getBuilder(e,t){const i=e!==void 0?e.toString():"0";let r=this.buildersByZIndex_[i];r===void 0&&(r={},this.buildersByZIndex_[i]=r);let s=r[t];if(s===void 0){const o=d8[t];s=new o(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),r[t]=s}return s}}function g8(n,e,t,i,r,s,o,a,u,h,d,g,m=!0){let v=n[e],y=n[e+1],I=0,w=0,R=0,P=0;function b(){I=v,w=y,e+=i,v=n[e],y=n[e+1],P+=R,R=Math.sqrt((v-I)*(v-I)+(y-w)*(y-w))}do b();while(e<t-i&&P+R<s);let L=R===0?0:(s-P)/R;const D=$i(I,v,L),B=$i(w,y,L),M=e-i,A=P,k=s+a*u(h,r,d);for(;e<t-i&&P+R<k;)b();L=R===0?0:(k-P)/R;const F=$i(I,v,L),G=$i(w,y,L);let U=!1;if(m)if(g){const de=[D,B,F,G];ub(de,0,4,2,g,de,de),U=de[0]>de[2]}else U=D>F;const N=Math.PI,ue=[],we=M+i===e;e=M,R=0,P=A,v=n[e],y=n[e+1];let ye;if(we){b(),ye=Math.atan2(y-w,v-I),U&&(ye+=ye>0?-N:N);const de=(F+D)/2,J=(G+B)/2;return ue[0]=[de,J,(k-s)/2,ye,r],ue}r=r.replace(/\n/g," ");for(let de=0,J=r.length;de<J;){b();let ae=Math.atan2(y-w,v-I);if(U&&(ae+=ae>0?-N:N),ye!==void 0){let Pe=ae-ye;if(Pe+=Pe>N?-2*N:Pe<-N?2*N:0,Math.abs(Pe)>o)return null}ye=ae;const ie=de;let $=0;for(;de<J;++de){const Pe=U?J-de-1:de,Oe=a*u(h,r[Pe],d);if(e+i<t&&P+R<s+$+Oe/2)break;$+=Oe}if(de===ie)continue;const K=U?r.substring(J-ie,J-de):r.substring(ie,de);L=R===0?0:(s+$/2-P)/R;const Ae=$i(I,v,L),Re=$i(w,y,L);ue.push([Ae,Re,$/2,ae,K]),s+=$}return ue}class jb{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(f0(),{get:(e,t)=>{if(typeof f0()[t]=="function")return this.push_(t),this.pushMethodArgs_},set:(e,t,i)=>(this.push_(t,i),!0)})}push_(...e){const t=this.instructions_,i=this.zIndex+this.offset_;t[i]||(t[i]=[]),t[i].push(...e)}pushMethodArgs_=(...e)=>(this.push_(e),this);pushFunction(e){this.push_(e)}getContext(){return this.context_}draw(e){this.instructions_.forEach(t=>{for(let i=0,r=t.length;i<r;++i){const s=t[i];if(typeof s=="function"){s(e);continue}const o=t[++i];if(typeof e[s]=="function")e[s](...o);else{if(typeof o=="function"){e[s]=o(e);continue}e[s]=o}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const cc=Yi(),Jo=[],no=[],io=[],ea=[];function pA(n){return n[3].declutterBox}const _A=new RegExp("[-----]");function i1(n,e){return e==="start"?e=_A.test(n)?"right":"left":e==="end"&&(e=_A.test(n)?"left":"right"),p0[e]}function m8(n,e,t){return t>0&&n.push(`
`,""),n.push(e,""),n}function p8(n,e,t){return t%2===0&&(n+=e),n}class _8{constructor(e,t,i,r,s){this.overlaps=i,this.pixelRatio=t,this.resolution=e,this.alignAndScaleFill_,this.instructions=r.instructions,this.coordinates=r.coordinates,this.coordinateCache_={},this.renderedTransform_=Hr(),this.hitDetectionInstructions=r.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=r.fillStates||{},this.strokeStates=r.strokeStates||{},this.textStates=r.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=s?new jb:null}getZIndexContext(){return this.zIndexContext_}createLabel(e,t,i,r){const s=e+t+i+r;if(this.labels_[s])return this.labels_[s];const o=r?this.strokeStates[r]:null,a=i?this.fillStates[i]:null,u=this.textStates[t],h=this.pixelRatio,d=[u.scale[0]*h,u.scale[1]*h],g=u.justify?p0[u.justify]:i1(Array.isArray(e)?e[0]:e,u.textAlign||Df),m=r&&o.lineWidth?o.lineWidth:0,v=Array.isArray(e)?e:String(e).split(`
`).reduce(m8,[]),{width:y,height:I,widths:w,heights:R,lineWidths:P}=M6(u,v),b=y+m,L=[],D=(b+2)*d[0],B=(I+m)*d[1],M={width:D<0?Math.floor(D):Math.ceil(D),height:B<0?Math.floor(B):Math.ceil(B),contextInstructions:L};(d[0]!=1||d[1]!=1)&&L.push("scale",d),r&&(L.push("strokeStyle",o.strokeStyle),L.push("lineWidth",m),L.push("lineCap",o.lineCap),L.push("lineJoin",o.lineJoin),L.push("miterLimit",o.miterLimit),L.push("setLineDash",[o.lineDash]),L.push("lineDashOffset",o.lineDashOffset)),i&&L.push("fillStyle",a.fillStyle),L.push("textBaseline","middle"),L.push("textAlign","center");const A=.5-g;let k=g*b+A*m;const F=[],G=[];let U=0,N=0,ue=0,we=0,ye;for(let de=0,J=v.length;de<J;de+=2){const ae=v[de];if(ae===`
`){N+=U,U=0,k=g*b+A*m,++we;continue}const ie=v[de+1]||u.font;ie!==ye&&(r&&F.push("font",ie),i&&G.push("font",ie),ye=ie),U=Math.max(U,R[ue]);const $=[ae,k+A*w[ue]+g*(w[ue]-P[we]),.5*(m+U)+N];k+=w[ue],r&&F.push("strokeText",$),i&&G.push("fillText",$),++ue}return Array.prototype.push.apply(L,F),Array.prototype.push.apply(L,G),this.labels_[s]=M,M}replayTextBackground_(e,t,i,r,s,o,a){e.beginPath(),e.moveTo.apply(e,t),e.lineTo.apply(e,i),e.lineTo.apply(e,r),e.lineTo.apply(e,s),e.lineTo.apply(e,t),o&&(this.alignAndScaleFill_=o[2],e.fillStyle=o[1],this.fill_(e)),a&&(this.setStrokeStyle_(e,a),e.stroke())}calculateImageOrLabelDimensions_(e,t,i,r,s,o,a,u,h,d,g,m,v,y,I,w){a*=m[0],u*=m[1];let R=i-a,P=r-u;const b=s+h>e?e-h:s,L=o+d>t?t-d:o,D=y[3]+b*m[0]+y[1],B=y[0]+L*m[1]+y[2],M=R-y[3],A=P-y[0];(I||g!==0)&&(Jo[0]=M,ea[0]=M,Jo[1]=A,no[1]=A,no[0]=M+D,io[0]=no[0],io[1]=A+B,ea[1]=io[1]);let k;return g!==0?(k=_o(Hr(),i,r,1,1,g,-i,-r),Sn(k,Jo),Sn(k,no),Sn(k,io),Sn(k,ea),ba(Math.min(Jo[0],no[0],io[0],ea[0]),Math.min(Jo[1],no[1],io[1],ea[1]),Math.max(Jo[0],no[0],io[0],ea[0]),Math.max(Jo[1],no[1],io[1],ea[1]),cc)):ba(Math.min(M,M+D),Math.min(A,A+B),Math.max(M,M+D),Math.max(A,A+B),cc),v&&(R=Math.round(R),P=Math.round(P)),{drawImageX:R,drawImageY:P,drawImageW:b,drawImageH:L,originX:h,originY:d,declutterBox:{minX:cc[0],minY:cc[1],maxX:cc[2],maxY:cc[3],value:w},canvasTransform:k,scale:m}}replayImageOrLabel_(e,t,i,r,s,o,a){const u=!!(o||a),h=r.declutterBox,d=a?a[2]*r.scale[0]/2:0;return h.minX-d<=t[0]&&h.maxX+d>=0&&h.minY-d<=t[1]&&h.maxY+d>=0&&(u&&this.replayTextBackground_(e,Jo,no,io,ea,o,a),b6(e,r.canvasTransform,s,i,r.originX,r.originY,r.drawImageW,r.drawImageH,r.drawImageX,r.drawImageY,r.scale)),!0}fill_(e){const t=this.alignAndScaleFill_;if(t){const i=Sn(this.renderedTransform_,[0,0]),r=512*this.pixelRatio;e.save(),e.translate(i[0]%r,i[1]%r),t!==1&&e.scale(t,t),e.rotate(this.viewRotation_)}e.fill(),t&&e.restore()}setStrokeStyle_(e,t){e.strokeStyle=t[1],t[1]&&(e.lineWidth=t[2],e.lineCap=t[3],e.lineJoin=t[4],e.miterLimit=t[5],e.lineDashOffset=t[7],e.setLineDash(t[6]))}drawLabelWithPointPlacement_(e,t,i,r){const s=this.textStates[t],o=this.createLabel(e,t,r,i),a=this.strokeStates[i],u=this.pixelRatio,h=i1(Array.isArray(e)?e[0]:e,s.textAlign||Df),d=p0[s.textBaseline||m0],g=a&&a.lineWidth?a.lineWidth:0,m=o.width/u-2*s.scale[0],v=h*m+2*(.5-h)*g,y=d*o.height/u+2*(.5-d)*g;return{label:o,anchorX:v,anchorY:y}}execute_(e,t,i,r,s,o,a,u){const h=this.zIndexContext_;let d;this.pixelCoordinates_&&za(i,this.renderedTransform_)?d=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),d=Ia(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),K5(this.renderedTransform_,i));let g=0;const m=r.length;let v=0,y,I,w,R,P,b,L,D,B,M,A,k,F,G=0,U=0;const N=this.coordinateCache_,ue=this.viewRotation_,we=Math.round(Math.atan2(-i[1],i[0])*1e12)/1e12,ye={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:ue},de=this.instructions!=r||this.overlaps?0:200;let J,ae,ie,$;for(;g<m;){const K=r[g];switch(K[0]){case be.BEGIN_GEOMETRY:J=K[1],$=K[3],J.getGeometry()?a!==void 0&&!Ri(a,$.getExtent())?g=K[2]+1:++g:g=K[2],h&&(h.zIndex=K[4]);break;case be.BEGIN_PATH:G>de&&(this.fill_(e),G=0),U>de&&(e.stroke(),U=0),!G&&!U&&(e.beginPath(),P=NaN,b=NaN),++g;break;case be.CIRCLE:v=K[1];const Re=d[v],Pe=d[v+1],Oe=d[v+2],Fe=d[v+3],Ke=Oe-Re,Ye=Fe-Pe,yt=Math.sqrt(Ke*Ke+Ye*Ye);e.moveTo(Re+yt,Pe),e.arc(Re,Pe,yt,0,2*Math.PI,!0),++g;break;case be.CLOSE_PATH:e.closePath(),++g;break;case be.CUSTOM:v=K[1],y=K[2];const Rr=K[3],Fs=K[4],gi=K[5];ye.geometry=Rr,ye.feature=J,g in N||(N[g]=[]);const mi=N[g];gi?gi(d,v,y,2,mi):(mi[0]=d[v],mi[1]=d[v+1],mi.length=2),h&&(h.zIndex=K[6]),Fs(mi,ye),++g;break;case be.DRAW_IMAGE:v=K[1],y=K[2],B=K[3],I=K[4],w=K[5];let An=K[6];const Rn=K[7],pi=K[8],er=K[9],Rt=K[10];let vt=K[11];const yn=K[12];let tr=K[13];R=K[14]||"declutter";const Dt=K[15];if(!B&&K.length>=20){M=K[19],A=K[20],k=K[21],F=K[22];const Yt=this.drawLabelWithPointPlacement_(M,A,k,F);B=Yt.label,K[3]=B;const rr=K[23];I=(Yt.anchorX-rr)*this.pixelRatio,K[4]=I;const Pn=K[24];w=(Yt.anchorY-Pn)*this.pixelRatio,K[5]=w,An=B.height,K[6]=An,tr=B.width,K[13]=tr}let Co;K.length>25&&(Co=K[25]);let nr,Zr,Pr;K.length>17?(nr=K[16],Zr=K[17],Pr=K[18]):(nr=jl,Zr=null,Pr=null),Rt&&we?vt+=ue:!Rt&&!we&&(vt-=ue);let Qr=0;for(;v<y;v+=2){if(Co&&Co[Qr++]<tr/this.pixelRatio)continue;const Yt=this.calculateImageOrLabelDimensions_(B.width,B.height,d[v],d[v+1],tr,An,I,w,pi,er,vt,yn,s,nr,!!Zr||!!Pr,J),rr=[e,t,B,Yt,Rn,Zr,Pr];if(u){let Pn,Zt,Cn;if(Dt){const ht=y-v;if(!Dt[ht]){Dt[ht]={args:rr,declutterMode:R};continue}const rn=Dt[ht];Pn=rn.args,Zt=rn.declutterMode,delete Dt[ht],Cn=pA(Pn)}let Mn,vn;if(Pn&&(Zt!=="declutter"||!u.collides(Cn))&&(Mn=!0),(R!=="declutter"||!u.collides(Yt.declutterBox))&&(vn=!0),Zt==="declutter"&&R==="declutter"){const ht=Mn&&vn;Mn=ht,vn=ht}Mn&&(Zt!=="none"&&u.insert(Cn),this.replayImageOrLabel_.apply(this,Pn)),vn&&(R!=="none"&&u.insert(Yt.declutterBox),this.replayImageOrLabel_.apply(this,rr))}else this.replayImageOrLabel_.apply(this,rr)}++g;break;case be.DRAW_CHARS:const Xa=K[1],Jr=K[2],ir=K[3],Au=K[4];F=K[5];const es=K[6],Gs=K[7],Mo=K[8];k=K[9];const ii=K[10];M=K[11],Array.isArray(M)&&(M=M.reduce(p8,"")),A=K[12];const js=[K[13],K[13]];R=K[14]||"declutter";const ts=K[15],ns=this.textStates[A],ri=ns.font,si=[ns.scale[0]*Gs,ns.scale[1]*Gs];let St;ri in this.widths_?St=this.widths_[ri]:(St={},this.widths_[ri]=St);const bo=pb(d,Xa,Jr,2),Cr=Math.abs(si[0])*iA(ri,M,St);if(Au||Cr<=bo){const Yt=this.textStates[A].textAlign,rr=(bo-Cr)*i1(M,Yt),Pn=g8(d,Xa,Jr,2,M,rr,es,Math.abs(si[0]),iA,ri,St,we?0:this.viewRotation_,ts);e:if(Pn){const Zt=[];let Cn,Mn,vn,ht,rn;if(k)for(Cn=0,Mn=Pn.length;Cn<Mn;++Cn){rn=Pn[Cn],vn=rn[4],ht=this.createLabel(vn,A,"",k),I=rn[2]+(si[0]<0?-ii:ii),w=ir*ht.height+(.5-ir)*2*ii*si[1]/si[0]-Mo;const cn=this.calculateImageOrLabelDimensions_(ht.width,ht.height,rn[0],rn[1],ht.width,ht.height,I,w,0,0,rn[3],js,!1,jl,!1,J);if(u&&R==="declutter"&&u.collides(cn.declutterBox))break e;Zt.push([e,t,ht,cn,1,null,null])}if(F)for(Cn=0,Mn=Pn.length;Cn<Mn;++Cn){rn=Pn[Cn],vn=rn[4],ht=this.createLabel(vn,A,F,""),I=rn[2],w=ir*ht.height-Mo;const cn=this.calculateImageOrLabelDimensions_(ht.width,ht.height,rn[0],rn[1],ht.width,ht.height,I,w,0,0,rn[3],js,!1,jl,!1,J);if(u&&R==="declutter"&&u.collides(cn.declutterBox))break e;Zt.push([e,t,ht,cn,1,null,null])}u&&R!=="none"&&u.load(Zt.map(pA));for(let cn=0,sr=Zt.length;cn<sr;++cn)this.replayImageOrLabel_.apply(this,Zt[cn])}}++g;break;case be.END_GEOMETRY:if(o!==void 0){J=K[1];const Yt=o(J,$,R);if(Yt)return Yt}++g;break;case be.FILL:de?G++:this.fill_(e),++g;break;case be.MOVE_TO_LINE_TO:for(v=K[1],y=K[2],ae=d[v],ie=d[v+1],e.moveTo(ae,ie),P=ae+.5|0,b=ie+.5|0,v+=2;v<y;v+=2)ae=d[v],ie=d[v+1],L=ae+.5|0,D=ie+.5|0,(v==y-2||L!==P||D!==b)&&(e.lineTo(ae,ie),P=L,b=D);++g;break;case be.SET_FILL_STYLE:this.alignAndScaleFill_=K[2],G&&(this.fill_(e),G=0,U&&(e.stroke(),U=0)),e.fillStyle=K[1],++g;break;case be.SET_STROKE_STYLE:U&&(e.stroke(),U=0),this.setStrokeStyle_(e,K),++g;break;case be.STROKE:de?U++:e.stroke(),++g;break;default:++g;break}}G&&this.fill_(e),U&&e.stroke()}execute(e,t,i,r,s,o){this.viewRotation_=r,this.execute_(e,t,i,this.instructions,s,void 0,void 0,o)}executeHitDetection(e,t,i,r,s){return this.viewRotation_=i,this.execute_(e,[e.canvas.width,e.canvas.height],t,this.hitDetectionInstructions,!0,r,s)}}const kl=["Polygon","Circle","LineString","Image","Text","Default"],Ub=["Image","Text"],y8=kl.filter(n=>!Ub.includes(n));class v8{constructor(e,t,i,r,s,o,a){this.maxExtent_=e,this.overlaps_=r,this.pixelRatio_=i,this.resolution_=t,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=Hr(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(s,a)}clip(e,t){const i=this.getClipCoords(t);e.beginPath(),e.moveTo(i[0],i[1]),e.lineTo(i[2],i[3]),e.lineTo(i[4],i[5]),e.lineTo(i[6],i[7]),e.clip()}createExecutors_(e,t){for(const i in e){let r=this.executorsByZIndex_[i];r===void 0&&(r={},this.executorsByZIndex_[i]=r);const s=e[i];for(const o in s){const a=s[o];r[o]=new _8(this.resolution_,this.pixelRatio_,this.overlaps_,a,t)}}}hasExecutors(e){for(const t in this.executorsByZIndex_){const i=this.executorsByZIndex_[t];for(let r=0,s=e.length;r<s;++r)if(e[r]in i)return!0}return!1}forEachFeatureAtCoordinate(e,t,i,r,s,o){r=Math.round(r);const a=r*2+1,u=_o(this.hitDetectionTransform_,r+.5,r+.5,1/t,-1/t,-i,-e[0],-e[1]),h=!this.hitDetectionContext_;h&&(this.hitDetectionContext_=mn(a,a));const d=this.hitDetectionContext_;d.canvas.width!==a||d.canvas.height!==a?(d.canvas.width=a,d.canvas.height=a):h||d.clearRect(0,0,a,a);let g;this.renderBuffer_!==void 0&&(g=Yi(),af(g,e),Mf(g,t*(this.renderBuffer_+r),g));const m=E8(r);let v;function y(D,B,M){const A=d.getImageData(0,0,a,a).data;for(let k=0,F=m.length;k<F;k++)if(A[m[k]]>0){if(!o||M==="none"||v!=="Image"&&v!=="Text"||o.includes(D)){const G=(m[k]-3)/4,U=r-G%a,N=r-(G/a|0),ue=s(D,B,U*U+N*N);if(ue)return ue}d.clearRect(0,0,a,a);break}}const I=Object.keys(this.executorsByZIndex_).map(Number);I.sort(co);let w,R,P,b,L;for(w=I.length-1;w>=0;--w){const D=I[w].toString();for(P=this.executorsByZIndex_[D],R=kl.length-1;R>=0;--R)if(v=kl[R],b=P[v],b!==void 0&&(L=b.executeHitDetection(d,u,i,y,g),L))return L}}getClipCoords(e){const t=this.maxExtent_;if(!t)return null;const i=t[0],r=t[1],s=t[2],o=t[3],a=[i,r,i,o,s,o,s,r];return Ia(a,0,8,2,e,a),a}isEmpty(){return rh(this.executorsByZIndex_)}execute(e,t,i,r,s,o,a){const u=Object.keys(this.executorsByZIndex_).map(Number);u.sort(a?i5:co),o=o||kl;const h=kl.length;for(let d=0,g=u.length;d<g;++d){const m=u[d].toString(),v=this.executorsByZIndex_[m];for(let y=0,I=o.length;y<I;++y){const w=o[y],R=v[w];if(R!==void 0){const P=a===null?void 0:R.getZIndexContext(),b=P?P.getContext():e,L=this.maxExtent_&&w!=="Image"&&w!=="Text";if(L&&(b.save(),this.clip(b,i)),!P||w==="Text"||w==="Image"?R.execute(b,t,i,r,s,a):P.pushFunction(D=>R.execute(D,t,i,r,s,a)),L&&b.restore(),P){P.offset();const D=u[d]*h+kl.indexOf(w);this.deferredZIndexContexts_[D]||(this.deferredZIndexContexts_[D]=[]),this.deferredZIndexContexts_[D].push(P)}}}}this.renderedContext_=e}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const e=this.deferredZIndexContexts_,t=Object.keys(e).map(Number).sort(co);for(let i=0,r=t.length;i<r;++i)e[t[i]].forEach(s=>{s.draw(this.renderedContext_),s.clear()}),e[t[i]].length=0}}const r1={};function E8(n){if(r1[n]!==void 0)return r1[n];const e=n*2+1,t=n*n,i=new Array(t+1);for(let s=0;s<=n;++s)for(let o=0;o<=n;++o){const a=s*s+o*o;if(a>t)break;let u=i[a];u||(u=[],i[a]=u),u.push(((n+s)*e+(n+o))*4+3),s>0&&u.push(((n-s)*e+(n+o))*4+3),o>0&&(u.push(((n+s)*e+(n-o))*4+3),s>0&&u.push(((n-s)*e+(n-o))*4+3))}const r=[];for(let s=0,o=i.length;s<o;++s)i[s]&&r.push(...i[s]);return r1[n]=r,r}function yA(n,e,t,i){return t!==void 0&&i!==void 0?[t/n,i/e]:t!==void 0?t/n:i!==void 0?i/e:1}let _0=class Bb extends P_{constructor(e){e=e||{};const t=e.opacity!==void 0?e.opacity:1,i=e.rotation!==void 0?e.rotation:0,r=e.scale!==void 0?e.scale:1,s=e.rotateWithView!==void 0?e.rotateWithView:!1;super({opacity:t,rotation:i,scale:r,displacement:e.displacement!==void 0?e.displacement:[0,0],rotateWithView:s,declutterMode:e.declutterMode}),this.anchor_=e.anchor!==void 0?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=e.anchorOrigin!==void 0?e.anchorOrigin:"top-left",this.anchorXUnits_=e.anchorXUnits!==void 0?e.anchorXUnits:"fraction",this.anchorYUnits_=e.anchorYUnits!==void 0?e.anchorYUnits:"fraction",this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null;const o=e.img!==void 0?e.img:null;let a=e.src;_t(!(a!==void 0&&o),"`image` and `src` cannot be provided at the same time"),(a===void 0||a.length===0)&&o&&(a=o.src||lt(o)),_t(a!==void 0&&a.length>0,"A defined and non-empty `src` or `image` must be provided"),_t(!((e.width!==void 0||e.height!==void 0)&&e.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let u;if(e.src!==void 0?u=ze.IDLE:o!==void 0&&("complete"in o?o.complete?u=o.src?ze.LOADED:ze.IDLE:u=ze.LOADING:u=ze.LOADED),this.color_=e.color!==void 0?ah(e.color):null,this.iconImage_=g0(o,a,this.crossOrigin_,u,this.color_),this.offset_=e.offset!==void 0?e.offset:[0,0],this.offsetOrigin_=e.offsetOrigin!==void 0?e.offsetOrigin:"top-left",this.origin_=null,this.size_=e.size!==void 0?e.size:null,this.initialOptions_,e.width!==void 0||e.height!==void 0){let h,d;if(e.size)[h,d]=e.size;else{const g=this.getImage(1);if(g.width&&g.height)h=g.width,d=g.height;else if(g instanceof HTMLImageElement){this.initialOptions_=e;const m=()=>{if(this.unlistenImageChange(m),!this.initialOptions_)return;const v=this.iconImage_.getSize();this.setScale(yA(v[0],v[1],e.width,e.height))};this.listenImageChange(m);return}}h!==void 0&&this.setScale(yA(h,d,e.width,e.height))}}clone(){let e,t,i;return this.initialOptions_?(t=this.initialOptions_.width,i=this.initialOptions_.height):(e=this.getScale(),e=Array.isArray(e)?e.slice():e),new Bb({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:e,width:t,height:i,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let e=this.normalizedAnchor_;if(!e){e=this.anchor_;const r=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!r)return null;e=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(e[0]*=r[0]),this.anchorYUnits_=="fraction"&&(e[1]*=r[1])}if(this.anchorOrigin_!="top-left"){if(!r)return null;e===this.anchor_&&(e=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(e[0]=-e[0]+r[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(e[1]=-e[1]+r[1])}this.normalizedAnchor_=e}const t=this.getDisplacement(),i=this.getScaleArray();return[e[0]-t[0]/i[0],e[1]+t[1]/i[1]]}setAnchor(e){this.anchor_=e,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(e){return this.iconImage_.getImage(e)}getPixelRatio(e){return this.iconImage_.getPixelRatio(e)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let e=this.offset_;if(this.offsetOrigin_!="top-left"){const t=this.getSize(),i=this.iconImage_.getSize();if(!t||!i)return null;e=e.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(e[0]=i[0]-t[0]-e[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(e[1]=i[1]-t[1]-e[1])}return this.origin_=e,this.origin_}getSrc(){return this.iconImage_.getSrc()}setSrc(e){this.iconImage_=g0(null,e,this.crossOrigin_,ze.IDLE,this.color_)}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const e=this.getScaleArray();if(this.size_)return this.size_[0]*e[0];if(this.iconImage_.getImageState()==ze.LOADED)return this.iconImage_.getSize()[0]*e[0]}getHeight(){const e=this.getScaleArray();if(this.size_)return this.size_[1]*e[1];if(this.iconImage_.getImageState()==ze.LOADED)return this.iconImage_.getSize()[1]*e[1]}setScale(e){delete this.initialOptions_,super.setScale(e)}listenImageChange(e){this.iconImage_.addEventListener(He.CHANGE,e)}load(){this.iconImage_.load()}unlistenImageChange(e){this.iconImage_.removeEventListener(He.CHANGE,e)}ready(){return this.iconImage_.ready()}};const Es=.5;function w8(n,e,t,i,r,s,o,a,u){const h=r,d=n[0]*Es,g=n[1]*Es,m=mn(d,g);m.imageSmoothingEnabled=!1;const v=m.canvas,y=new L6(m,Es,r,null,o,a,null),I=t.length,w=Math.floor((256*256*256-1)/I),R={};for(let b=1;b<=I;++b){const L=t[b-1],D=L.getStyleFunction()||i;if(!D)continue;let B=D(L,s);if(!B)continue;Array.isArray(B)||(B=[B]);const A=(b*w).toString(16).padStart(7,"#00000");for(let k=0,F=B.length;k<F;++k){const G=B[k],U=G.getGeometryFunction()(L);if(!U||!Ri(h,U.getExtent()))continue;const N=G.clone(),ue=N.getFill();ue&&ue.setColor(A);const we=N.getStroke();we&&(we.setColor(A),we.setLineDash(null)),N.setText(void 0);const ye=G.getImage();if(ye){const ie=ye.getImageSize();if(!ie)continue;const $=mn(ie[0],ie[1],void 0,{alpha:!1}),K=$.canvas;$.fillStyle=A,$.fillRect(0,0,K.width,K.height),N.setImage(new _0({img:K,anchor:ye.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:ye.getOrigin(),opacity:1,size:ye.getSize(),scale:ye.getScale(),rotation:ye.getRotation(),rotateWithView:ye.getRotateWithView()}))}const de=N.getZIndex()||0;let J=R[de];J||(J={},R[de]=J,J.Polygon=[],J.Circle=[],J.LineString=[],J.Point=[]);const ae=U.getType();if(ae==="GeometryCollection"){const ie=U.getGeometriesArrayRecursive();for(let $=0,K=ie.length;$<K;++$){const Ae=ie[$];J[Ae.getType().replace("Multi","")].push(Ae,N)}}else J[ae.replace("Multi","")].push(U,N)}}const P=Object.keys(R).map(Number).sort(co);for(let b=0,L=P.length;b<L;++b){const D=R[P[b]];for(const B in D){const M=D[B];for(let A=0,k=M.length;A<k;A+=2){y.setStyle(M[A+1]);for(let F=0,G=e.length;F<G;++F)y.setTransform(e[F]),y.drawGeometry(M[A])}}}return m.getImageData(0,0,v.width,v.height)}function x8(n,e,t){const i=[];if(t){const r=Math.floor(Math.round(n[0])*Es),s=Math.floor(Math.round(n[1])*Es),o=(kt(r,0,t.width-1)+kt(s,0,t.height-1)*t.width)*4,a=t.data[o],u=t.data[o+1],d=t.data[o+2]+256*(u+256*a),g=Math.floor((256*256*256-1)/e.length);d&&d%g===0&&i.push(e[d/g-1])}return i}class zb extends Io{constructor(e,t,i,r){super(e),this.inversePixelTransform=t,this.frameState=i,this.context=r}}const T8=5;class I8 extends pg{constructor(e){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e,this.staleKeys_=new Array,this.maxStaleKeys=T8}getStaleKeys(){return this.staleKeys_}prependStaleKey(e){this.staleKeys_.unshift(e),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(e){return ot()}getData(e){return null}prepareFrame(e){return ot()}renderFrame(e,t){return ot()}forEachFeatureAtCoordinate(e,t,i,r,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(e){const t=e.target;(t.getState()===ze.LOADED||t.getState()===ze.ERROR)&&this.renderIfReadyAndVisible()}loadImage(e){let t=e.getState();return t!=ze.LOADED&&t!=ze.ERROR&&e.addEventListener(He.CHANGE,this.boundHandleImageChange_),t==ze.IDLE&&(e.load(),t=e.getState()),t==ze.LOADED}renderIfReadyAndVisible(){const e=this.getLayer();e&&e.getVisible()&&e.getSourceState()==="ready"&&e.changed()}renderDeferred(e){}disposeInternal(){delete this.layer_,super.disposeInternal()}}const vA=[];let Tc=null;function S8(){Tc=mn(1,1,void 0,{willReadFrequently:!0})}class $b extends I8{constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=Hr(),this.pixelTransform=Hr(),this.inversePixelTransform=Hr(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(e,t,i){Tc||S8(),Tc.clearRect(0,0,1,1);let r;try{Tc.drawImage(e,t,i,1,1,0,0,1,1),r=Tc.getImageData(0,0,1,1).data}catch{return Tc=null,null}return r}getBackground(e){let i=this.getLayer().getBackground();return typeof i=="function"&&(i=i(e.viewState.resolution)),i||void 0}useContainer(e,t,i){const r=this.getLayer().getClassName();let s,o;if(e&&e.className===r&&(!i||e&&e.style.backgroundColor&&za(ah(e.style.backgroundColor),ah(i)))){const a=e.firstElementChild;ya(a)&&(o=a.getContext("2d"))}if(o&&Y5(o.canvas.style.transform,t)?(this.container=e,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){s=Wi?wb():document.createElement("div"),s.className=r;let a=s.style;a.position="absolute",a.width="100%",a.height="100%",o=mn();const u=o.canvas;s.appendChild(u),a=u.style,a.position="absolute",a.left="0",a.transformOrigin="top left",this.container=s,this.context=o}!this.containerReused&&i&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=i)}clipUnrotated(e,t,i){const r=_u(i),s=v_(i),o=y_(i),a=__(i);Sn(t.coordinateToPixelTransform,r),Sn(t.coordinateToPixelTransform,s),Sn(t.coordinateToPixelTransform,o),Sn(t.coordinateToPixelTransform,a);const u=this.inversePixelTransform;Sn(u,r),Sn(u,s),Sn(u,o),Sn(u,a),e.save(),e.beginPath(),e.moveTo(Math.round(r[0]),Math.round(r[1])),e.lineTo(Math.round(s[0]),Math.round(s[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.lineTo(Math.round(a[0]),Math.round(a[1])),e.clip()}prepareContainer(e,t){const i=e.extent,r=e.viewState.resolution,s=e.viewState.rotation,o=e.pixelRatio,a=Math.round(ut(i)/r*o),u=Math.round(Jn(i)/r*o);_o(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/o,1/o,s,-a/2,-u/2),lb(this.inversePixelTransform,this.pixelTransform);const h=X5(this.pixelTransform);if(this.useContainer(t,h,this.getBackground(e)),!this.containerReused){const d=this.context.canvas;d.width!=a||d.height!=u?(d.width=a,d.height=u):this.context.clearRect(0,0,a,u),h!==d.style.transform&&(d.style.transform=h)}}dispatchRenderEvent_(e,t,i){const r=this.getLayer();if(r.hasListener(e)){const s=new zb(e,this.inversePixelTransform,i,t);r.dispatchEvent(s)}}preRender(e,t){this.frameState=t,!t.declutter&&this.dispatchRenderEvent_(wr.PRERENDER,e,t)}postRender(e,t){t.declutter||this.dispatchRenderEvent_(wr.POSTRENDER,e,t)}renderDeferredInternal(e){}getRenderContext(e){return e.declutter&&!this.deferredContext_&&(this.deferredContext_=new jb),e.declutter?this.deferredContext_.getContext():this.context}renderDeferred(e){e.declutter&&(this.dispatchRenderEvent_(wr.PRERENDER,this.context,e),e.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(e),this.dispatchRenderEvent_(wr.POSTRENDER,this.context,e))}getRenderTransform(e,t,i,r,s,o,a){const u=s/2,h=o/2,d=r/t,g=-d,m=-e[0]+a,v=-e[1];return _o(this.tempTransform,u,h,d,g,-i,m,v)}disposeInternal(){delete this.frameState,super.disposeInternal()}}class A8 extends $b{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=Yi(),this.wrappedRenderedExtent_=Yi(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(e,t,i){const r=t.extent,s=t.viewState,o=s.center,a=s.resolution,u=s.projection,h=s.rotation,d=u.getExtent(),g=this.getLayer().getSource(),m=this.getLayer().getDeclutter(),v=t.pixelRatio,y=t.viewHints,I=!(y[Xn.ANIMATING]||y[Xn.INTERACTING]),w=this.context,R=Math.round(ut(r)/a*v),P=Math.round(Jn(r)/a*v),b=g.getWrapX()&&u.canWrapX(),L=b?ut(d):null,D=b?Math.ceil((r[2]-d[2])/L)+1:1;let B=b?Math.floor((r[0]-d[0])/L):0;do{let M=this.getRenderTransform(o,a,0,v,R,P,B*L);t.declutter&&(M=M.slice(0)),e.execute(w,[w.canvas.width,w.canvas.height],M,h,I,i===void 0?kl:i?Ub:y8,i?m&&t.declutter[m]:void 0)}while(++B<D)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=mn(this.context.canvas.width,this.context.canvas.height,vA))}resetDrawContext_(){if(this.opacity_!==1&&this.targetContext_){const e=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=e,A_(this.context),vA.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(e){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,e,!0)}renderDeferredInternal(e){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(e,t){const i=e.layerStatesArray[e.layerIndex];this.opacity_=i.opacity;const r=e.viewState;this.prepareContainer(e,t);const s=this.context,o=this.replayGroup_;let a=o&&!o.isEmpty();if(!a&&!(this.getLayer().hasListener(wr.PRERENDER)||this.getLayer().hasListener(wr.POSTRENDER)))return this.container;if(this.setDrawContext_(),this.preRender(s,e),r.projection,this.clipped_=!1,a&&i.extent&&this.clipping){const u=_a(i.extent);a=Ri(u,e.extent),this.clipped_=a&&!Ud(u,e.extent),this.clipped_&&this.clipUnrotated(s,e,u)}return a&&this.renderWorlds(o,e,this.getLayer().getDeclutter()?!1:void 0),!e.declutter&&this.clipped_&&s.restore(),this.postRender(s,e),this.renderedRotation_!==r.rotation&&(this.renderedRotation_=r.rotation,this.hitDetectionImageData_=null),e.declutter||this.resetDrawContext_(),this.container}getFeatures(e){return new Promise(t=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const i=this.frameState.size.slice(),r=this.renderedCenter_,s=this.renderedResolution_,o=this.renderedRotation_,a=this.renderedProjection_,u=this.wrappedRenderedExtent_,h=this.getLayer(),d=[],g=i[0]*Es,m=i[1]*Es;d.push(this.getRenderTransform(r,s,o,Es,g,m,0).slice());const v=h.getSource(),y=a.getExtent();if(v.getWrapX()&&a.canWrapX()&&!Ud(y,u)){let I=u[0];const w=ut(y);let R=0,P;for(;I<y[0];)--R,P=w*R,d.push(this.getRenderTransform(r,s,o,Es,g,m,P).slice()),I+=w;for(R=0,I=u[2];I>y[2];)++R,P=w*R,d.push(this.getRenderTransform(r,s,o,Es,g,m,P).slice()),I-=w}this.hitDetectionImageData_=w8(i,d,this.renderedFeatures_,h.getStyleFunction(),u,s,o,rA(s,this.renderedPixelRatio_))}t(x8(e,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(e,t,i,r,s){if(!this.replayGroup_)return;const o=t.viewState.resolution,a=t.viewState.rotation,u=this.getLayer(),h={},d=function(m,v,y){const I=lt(m),w=h[I];if(w){if(w!==!0&&y<w.distanceSq){if(y===0)return h[I]=!0,s.splice(s.lastIndexOf(w),1),r(m,u,v);w.geometry=v,w.distanceSq=y}}else{if(y===0)return h[I]=!0,r(m,u,v);s.push(h[I]={feature:m,layer:u,geometry:v,distanceSq:y,callback:r})}},g=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(e,o,a,i,d,g?t.declutter?.[g]?.all().map(m=>m.value):null)}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}prepareFrame(e){const t=this.getLayer(),i=t.getSource();if(!i)return!1;const r=e.viewHints[Xn.ANIMATING],s=e.viewHints[Xn.INTERACTING],o=t.getUpdateWhileAnimating(),a=t.getUpdateWhileInteracting();if(this.ready&&!o&&r||!a&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const u=e.extent,h=e.viewState,d=h.projection,g=h.resolution,m=e.pixelRatio,v=t.getRevision(),y=t.getRenderBuffer();let I=t.getRenderOrder();I===void 0&&(I=N6);const w=h.center.slice(),R=Mf(u,y*g),P=R.slice(),b=[R.slice()],L=d.getExtent();if(i.getWrapX()&&d.canWrapX()&&!Ud(L,e.extent)){const ue=ut(L),we=Math.max(ut(R)/2,ue);R[0]=L[0]-we,R[2]=L[2]+we,QM(w,d);const ye=XM(b[0],d);ye[0]<L[0]&&ye[2]<L[2]?b.push([ye[0]+ue,ye[1],ye[2]+ue,ye[3]]):ye[0]>L[0]&&ye[2]>L[2]&&b.push([ye[0]-ue,ye[1],ye[2]-ue,ye[3]])}if(this.ready&&this.renderedResolution_==g&&this.renderedRevision_==v&&this.renderedRenderOrder_==I&&this.renderedFrameDeclutter_===!!e.declutter&&Ud(this.wrappedRenderedExtent_,R))return za(this.renderedExtent_,P)||(this.hitDetectionImageData_=null,this.renderedExtent_=P),this.renderedCenter_=w,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const D=new f8(Mb(g,m),R,g,m);let B;for(let ue=0,we=b.length;ue<we;++ue)i.loadFeatures(b[ue],g,d);const M=rA(g,m);let A=!0;const k=(ue,we)=>{let ye;const de=ue.getStyleFunction()||t.getStyleFunction();if(de&&(ye=de(ue,g)),ye){const J=this.renderFeature(ue,M,ye,D,B,this.getLayer().getDeclutter(),we);A=A&&!J}},F=ab(R),G=i.getFeaturesInExtent(F);I&&G.sort(I);for(let ue=0,we=G.length;ue<we;++ue)k(G[ue],ue);this.renderedFeatures_=G,this.ready=A;const U=D.finish(),N=new v8(R,g,m,i.getOverlaps(),U,t.getRenderBuffer(),!!e.declutter);return this.renderedResolution_=g,this.renderedRevision_=v,this.renderedRenderOrder_=I,this.renderedFrameDeclutter_=!!e.declutter,this.renderedExtent_=P,this.wrappedRenderedExtent_=R,this.renderedCenter_=w,this.renderedProjection_=d,this.renderedPixelRatio_=m,this.replayGroup_=N,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(e,t,i,r,s,o,a){if(!i)return!1;let u=!1;if(Array.isArray(i))for(let h=0,d=i.length;h<d;++h)u=sA(r,e,i[h],t,this.boundHandleStyleImageChange_,s,o,a)||u;else u=sA(r,e,i,t,this.boundHandleStyleImageChange_,s,o,a);return u}}let yu=0;const li=1<<yu++,nt=1<<yu++,Ai=1<<yu++,zr=1<<yu++,tu=1<<yu++,$d=1<<yu++,dp=Math.pow(2,yu)-1,rx={[li]:"boolean",[nt]:"number",[Ai]:"string",[zr]:"color",[tu]:"number[]",[$d]:"size"},R8=Object.keys(rx).map(Number).sort(co);function P8(n){return n in rx}function Wd(n){const e=[];for(const t of R8)Kd(n,t)&&e.push(rx[t]);return e.length===0?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function Kd(n,e){return(n&e)===e}function ta(n,e){return n===e}class fn{constructor(e,t){if(!P8(e))throw new Error(`literal expressions must have a specific type, got ${Wd(e)}`);this.type=e,this.value=t}}class C8{constructor(e,t,...i){this.type=e,this.operator=t,this.args=i}}function Wb(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function Gn(n,e,t){switch(typeof n){case"boolean":{if(ta(e,Ai))return new fn(Ai,n?"true":"false");if(!Kd(e,li))throw new Error(`got a boolean, but expected ${Wd(e)}`);return new fn(li,n)}case"number":{if(ta(e,$d))return new fn($d,Mi(n));if(ta(e,li))return new fn(li,!!n);if(ta(e,Ai))return new fn(Ai,n.toString());if(!Kd(e,nt))throw new Error(`got a number, but expected ${Wd(e)}`);return new fn(nt,n)}case"string":{if(ta(e,zr))return new fn(zr,Qw(n));if(ta(e,li))return new fn(li,!!n);if(!Kd(e,Ai))throw new Error(`got a string, but expected ${Wd(e)}`);return new fn(Ai,n)}}if(!Array.isArray(n))throw new Error("expression must be an array or a primitive value");if(n.length===0)throw new Error("empty expression");if(typeof n[0]=="string")return j8(n,e,t);for(const i of n)if(typeof i!="number")throw new Error("expected an array of numbers");if(ta(e,$d)){if(n.length!==2)throw new Error(`expected an array of two values for a size, got ${n.length}`);return new fn($d,n)}if(ta(e,zr)){if(n.length===3)return new fn(zr,[...n,1]);if(n.length===4)return new fn(zr,n);throw new Error(`expected an array of 3 or 4 values for a color, got ${n.length}`)}if(!Kd(e,tu))throw new Error(`got an array of numbers, but expected ${Wd(e)}`);return new fn(tu,n)}const te={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},M8={[te.Get]:je(Xe(1,1/0),EA),[te.Var]:je(Xe(1,1),b8),[te.Has]:je(Xe(1,1/0),EA),[te.Id]:je(k8,hc),[te.Concat]:je(Xe(2,1/0),ft(Ai)),[te.GeometryType]:je(L8,hc),[te.LineMetric]:je(hc),[te.Resolution]:je(s1,hc),[te.Zoom]:je(s1,hc),[te.Time]:je(s1,hc),[te.Any]:je(Xe(2,1/0),ft(li)),[te.All]:je(Xe(2,1/0),ft(li)),[te.Not]:je(Xe(1,1),ft(li)),[te.Equal]:je(Xe(2,2),ft(dp)),[te.NotEqual]:je(Xe(2,2),ft(dp)),[te.GreaterThan]:je(Xe(2,2),ft(nt)),[te.GreaterThanOrEqualTo]:je(Xe(2,2),ft(nt)),[te.LessThan]:je(Xe(2,2),ft(nt)),[te.LessThanOrEqualTo]:je(Xe(2,2),ft(nt)),[te.Multiply]:je(Xe(2,1/0),wA),[te.Coalesce]:je(Xe(2,1/0),wA),[te.Divide]:je(Xe(2,2),ft(nt)),[te.Add]:je(Xe(2,1/0),ft(nt)),[te.Subtract]:je(Xe(2,2),ft(nt)),[te.Clamp]:je(Xe(3,3),ft(nt)),[te.Mod]:je(Xe(2,2),ft(nt)),[te.Pow]:je(Xe(2,2),ft(nt)),[te.Abs]:je(Xe(1,1),ft(nt)),[te.Floor]:je(Xe(1,1),ft(nt)),[te.Ceil]:je(Xe(1,1),ft(nt)),[te.Round]:je(Xe(1,1),ft(nt)),[te.Sin]:je(Xe(1,1),ft(nt)),[te.Cos]:je(Xe(1,1),ft(nt)),[te.Atan]:je(Xe(1,2),ft(nt)),[te.Sqrt]:je(Xe(1,1),ft(nt)),[te.Match]:je(Xe(4,1/0),xA,N8),[te.Between]:je(Xe(3,3),ft(nt)),[te.Interpolate]:je(Xe(6,1/0),xA,O8),[te.Case]:je(Xe(3,1/0),D8,V8),[te.In]:je(Xe(2,2),F8),[te.Number]:je(Xe(1,1/0),ft(dp)),[te.String]:je(Xe(1,1/0),ft(dp)),[te.Array]:je(Xe(1,1/0),ft(nt)),[te.Color]:je(Xe(1,4),ft(nt)),[te.Band]:je(Xe(1,3),ft(nt)),[te.Palette]:je(Xe(2,2),G8),[te.ToString]:je(Xe(1,1),ft(li|nt|Ai|zr))};function EA(n,e,t){const i=n.length-1,r=new Array(i);for(let s=0;s<i;++s){const o=n[s+1];switch(typeof o){case"number":{r[s]=new fn(nt,o);break}case"string":{r[s]=new fn(Ai,o);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${o}`)}s===0&&t.properties.add(String(o))}return r}function b8(n,e,t){const i=n[1];if(typeof i!="string")throw new Error("expected a string argument for var operation");return t.variables.add(i),[new fn(Ai,i)]}function k8(n,e,t){t.featureId=!0}function L8(n,e,t){t.geometryType=!0}function s1(n,e,t){t.mapState=!0}function hc(n,e,t){const i=n[0];if(n.length!==1)throw new Error(`expected no arguments for ${i} operation`);return[]}function Xe(n,e){return function(t,i,r){const s=t[0],o=t.length-1;if(n===e){if(o!==n){const a=n===1?"":"s";throw new Error(`expected ${n} argument${a} for ${s}, got ${o}`)}}else if(o<n||o>e){const a=e===1/0?`${n} or more`:`${n} to ${e}`;throw new Error(`expected ${a} arguments for ${s}, got ${o}`)}}}function wA(n,e,t){const i=n.length-1,r=new Array(i);for(let s=0;s<i;++s){const o=Gn(n[s+1],e,t);r[s]=o}return r}function ft(n){return function(e,t,i){const r=e.length-1,s=new Array(r);for(let o=0;o<r;++o){const a=Gn(e[o+1],n,i);s[o]=a}return s}}function D8(n,e,t){const i=n[0],r=n.length-1;if(r%2===0)throw new Error(`expected an odd number of arguments for ${i}, got ${r} instead`)}function xA(n,e,t){const i=n[0],r=n.length-1;if(r%2===1)throw new Error(`expected an even number of arguments for operation ${i}, got ${r} instead`)}function N8(n,e,t){const i=n.length-1,r=Ai|nt|li,s=Gn(n[1],r,t),o=Gn(n[n.length-1],e,t),a=new Array(i-2);for(let u=0;u<i-2;u+=2){try{const h=Gn(n[u+2],s.type,t);a[u]=h}catch(h){throw new Error(`failed to parse argument ${u+1} of match expression: ${h.message}`)}try{const h=Gn(n[u+3],o.type,t);a[u+1]=h}catch(h){throw new Error(`failed to parse argument ${u+2} of match expression: ${h.message}`)}}return[s,...a,o]}function O8(n,e,t){const i=n[1];let r;switch(i[0]){case"linear":r=1;break;case"exponential":const u=i[1];if(typeof u!="number"||u<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(u)} instead`);r=u;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(i)}`)}const s=new fn(nt,r);let o;try{o=Gn(n[2],nt,t)}catch(u){throw new Error(`failed to parse argument 1 in interpolate expression: ${u.message}`)}const a=new Array(n.length-3);for(let u=0;u<a.length;u+=2){try{const h=Gn(n[u+3],nt,t);a[u]=h}catch(h){throw new Error(`failed to parse argument ${u+2} for interpolate expression: ${h.message}`)}try{const h=Gn(n[u+4],e,t);a[u+1]=h}catch(h){throw new Error(`failed to parse argument ${u+3} for interpolate expression: ${h.message}`)}}return[s,o,...a]}function V8(n,e,t){const i=Gn(n[n.length-1],e,t),r=new Array(n.length-1);for(let s=0;s<r.length-1;s+=2){try{const o=Gn(n[s+1],li,t);r[s]=o}catch(o){throw new Error(`failed to parse argument ${s} of case expression: ${o.message}`)}try{const o=Gn(n[s+2],i.type,t);r[s+1]=o}catch(o){throw new Error(`failed to parse argument ${s+1} of case expression: ${o.message}`)}}return r[r.length-1]=i,r}function F8(n,e,t){let i=n[2];if(!Array.isArray(i))throw new Error('the second argument for the "in" operator must be an array');let r;if(typeof i[0]=="string"){if(i[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(i[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');i=i[1],r=Ai}else r=nt;const s=new Array(i.length);for(let a=0;a<s.length;a++)try{const u=Gn(i[a],r,t);s[a]=u}catch(u){throw new Error(`failed to parse haystack item ${a} for "in" expression: ${u.message}`)}return[Gn(n[1],r,t),...s]}function G8(n,e,t){let i;try{i=Gn(n[1],nt,t)}catch(o){throw new Error(`failed to parse first argument in palette expression: ${o.message}`)}const r=n[2];if(!Array.isArray(r))throw new Error("the second argument of palette must be an array");const s=new Array(r.length);for(let o=0;o<s.length;o++){let a;try{a=Gn(r[o],zr,t)}catch(u){throw new Error(`failed to parse color at index ${o} in palette expression: ${u.message}`)}if(!(a instanceof fn))throw new Error(`the palette color at index ${o} must be a literal value`);s[o]=a}return[i,...s]}function je(...n){return function(e,t,i){const r=e[0];let s;for(let o=0;o<n.length;o++){const a=n[o](e,t,i);if(o==n.length-1){if(!a)throw new Error("expected last argument validator to return the parsed args");s=a}}return new C8(t,r,...s)}}function j8(n,e,t){const i=n[0],r=M8[i];if(!r)throw new Error(`unknown operator: ${i}`);return r(n,e,t)}function Kb(n){if(!n)return"";const e=n.getType();switch(e){case"Point":case"LineString":case"Polygon":return e;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return e.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return Kb(n.getGeometries()[0]);default:return""}}function qb(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function So(n,e,t){const i=Gn(n,e,t);return Yr(i)}function Yr(n,e){if(n instanceof fn){if(n.type===zr&&typeof n.value=="string"){const i=Qw(n.value);return function(){return i}}return function(){return n.value}}const t=n.operator;switch(t){case te.Number:case te.String:case te.Coalesce:return U8(n);case te.Get:case te.Var:case te.Has:return B8(n);case te.Id:return i=>i.featureId;case te.GeometryType:return i=>i.geometryType;case te.Concat:{const i=n.args.map(r=>Yr(r));return r=>"".concat(...i.map(s=>s(r).toString()))}case te.Resolution:return i=>i.resolution;case te.Any:case te.All:case te.Between:case te.In:case te.Not:return $8(n);case te.Equal:case te.NotEqual:case te.LessThan:case te.LessThanOrEqualTo:case te.GreaterThan:case te.GreaterThanOrEqualTo:return z8(n);case te.Multiply:case te.Divide:case te.Add:case te.Subtract:case te.Clamp:case te.Mod:case te.Pow:case te.Abs:case te.Floor:case te.Ceil:case te.Round:case te.Sin:case te.Cos:case te.Atan:case te.Sqrt:return W8(n);case te.Case:return K8(n);case te.Match:return q8(n);case te.Interpolate:return H8(n);case te.ToString:return X8(n);default:throw new Error(`Unsupported operator ${t}`)}}function U8(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Yr(n.args[s]);switch(t){case te.Coalesce:return s=>{for(let o=0;o<i;++o){const a=r[o](s);if(typeof a<"u"&&a!==null)return a}throw new Error("Expected one of the values to be non-null")};case te.Number:case te.String:return s=>{for(let o=0;o<i;++o){const a=r[o](s);if(typeof a===t)return a}throw new Error(`Expected one of the values to be a ${t}`)};default:throw new Error(`Unsupported assertion operator ${t}`)}}function B8(n,e){const i=n.args[0].value;switch(n.operator){case te.Get:return r=>{const s=n.args;let o=r.properties[i];for(let a=1,u=s.length;a<u;++a){const d=s[a].value;o=o[d]}return o};case te.Var:return r=>r.variables[i];case te.Has:return r=>{const s=n.args;if(!(i in r.properties))return!1;let o=r.properties[i];for(let a=1,u=s.length;a<u;++a){const d=s[a].value;if(!o||!Object.hasOwn(o,d))return!1;o=o[d]}return!0};default:throw new Error(`Unsupported accessor operator ${n.operator}`)}}function z8(n,e){const t=n.operator,i=Yr(n.args[0]),r=Yr(n.args[1]);switch(t){case te.Equal:return s=>i(s)===r(s);case te.NotEqual:return s=>i(s)!==r(s);case te.LessThan:return s=>i(s)<r(s);case te.LessThanOrEqualTo:return s=>i(s)<=r(s);case te.GreaterThan:return s=>i(s)>r(s);case te.GreaterThanOrEqualTo:return s=>i(s)>=r(s);default:throw new Error(`Unsupported comparison operator ${t}`)}}function $8(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Yr(n.args[s]);switch(t){case te.Any:return s=>{for(let o=0;o<i;++o)if(r[o](s))return!0;return!1};case te.All:return s=>{for(let o=0;o<i;++o)if(!r[o](s))return!1;return!0};case te.Between:return s=>{const o=r[0](s),a=r[1](s),u=r[2](s);return o>=a&&o<=u};case te.In:return s=>{const o=r[0](s);for(let a=1;a<i;++a)if(o===r[a](s))return!0;return!1};case te.Not:return s=>!r[0](s);default:throw new Error(`Unsupported logical operator ${t}`)}}function W8(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Yr(n.args[s]);switch(t){case te.Multiply:return s=>{let o=1;for(let a=0;a<i;++a)o*=r[a](s);return o};case te.Divide:return s=>r[0](s)/r[1](s);case te.Add:return s=>{let o=0;for(let a=0;a<i;++a)o+=r[a](s);return o};case te.Subtract:return s=>r[0](s)-r[1](s);case te.Clamp:return s=>{const o=r[0](s),a=r[1](s);if(o<a)return a;const u=r[2](s);return o>u?u:o};case te.Mod:return s=>r[0](s)%r[1](s);case te.Pow:return s=>Math.pow(r[0](s),r[1](s));case te.Abs:return s=>Math.abs(r[0](s));case te.Floor:return s=>Math.floor(r[0](s));case te.Ceil:return s=>Math.ceil(r[0](s));case te.Round:return s=>Math.round(r[0](s));case te.Sin:return s=>Math.sin(r[0](s));case te.Cos:return s=>Math.cos(r[0](s));case te.Atan:return i===2?s=>Math.atan2(r[0](s),r[1](s)):s=>Math.atan(r[0](s));case te.Sqrt:return s=>Math.sqrt(r[0](s));default:throw new Error(`Unsupported numeric operator ${t}`)}}function K8(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=Yr(n.args[r]);return r=>{for(let s=0;s<t-1;s+=2)if(i[s](r))return i[s+1](r);return i[t-1](r)}}function q8(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=Yr(n.args[r]);return r=>{const s=i[0](r);for(let o=1;o<t-1;o+=2)if(s===i[o](r))return i[o+1](r);return i[t-1](r)}}function H8(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=Yr(n.args[r]);return r=>{const s=i[0](r),o=i[1](r);let a,u;for(let h=2;h<t;h+=2){const d=i[h](r);let g=i[h+1](r);const m=Array.isArray(g);if(m&&(g=v6(g)),d>=o)return h===2?g:m?Y8(s,o,a,u,d,g):qd(s,o,a,u,d,g);a=d,u=g}return u}}function X8(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Yr(n.args[s]);switch(t){case te.ToString:return s=>{const o=r[0](s);return n.args[0].type===zr?Jw(o):o.toString()};default:throw new Error(`Unsupported convert operator ${t}`)}}function qd(n,e,t,i,r,s){const o=r-t;if(o===0)return i;const a=e-t,u=n===1?a/o:(Math.pow(n,a)-1)/(Math.pow(n,o)-1);return i+u*(s-i)}function Y8(n,e,t,i,r,s){if(r-t===0)return i;const a=J2(i),u=J2(s);let h=u[2]-a[2];h>180?h-=360:h<-180&&(h+=360);const d=[qd(n,e,t,a[0],r,u[0]),qd(n,e,t,a[1],r,u[1]),a[2]+qd(n,e,t,0,r,h),qd(n,e,t,i[3],r,s[3])];return E6(d)}function Z8(n){return!0}function Q8(n){const e=Wb(),t=J8(n,e),i=qb();return function(r,s){if(i.properties=r.getPropertiesInternal(),i.resolution=s,e.featureId){const o=r.getId();o!==void 0?i.featureId=o:i.featureId=null}return e.geometryType&&(i.geometryType=Kb(r.getGeometry())),t(i)}}function TA(n){const e=Wb(),t=n.length,i=new Array(t);for(let o=0;o<t;++o)i[o]=gE(n[o],e);const r=qb(),s=new Array(t);return function(o,a){if(r.properties=o.getPropertiesInternal(),r.resolution=a,e.featureId){const h=o.getId();h!==void 0?r.featureId=h:r.featureId=null}let u=0;for(let h=0;h<t;++h){const d=i[h](r);d&&(s[u]=d,u+=1)}return s.length=u,s}}function J8(n,e){const t=n.length,i=new Array(t);for(let r=0;r<t;++r){const s=n[r],o="filter"in s?So(s.filter,li,e):Z8;let a;if(Array.isArray(s.style)){const u=s.style.length;a=new Array(u);for(let h=0;h<u;++h)a[h]=gE(s.style[h],e)}else a=[gE(s.style,e)];i[r]={filter:o,styles:a}}return function(r){const s=[];let o=!1;for(let a=0;a<t;++a){const u=i[a].filter;if(u(r)&&!(n[a].else&&o)){o=!0;for(const h of i[a].styles){const d=h(r);d&&s.push(d)}}}return s}}function gE(n,e){const t=Ff(n,"",e),i=Gf(n,"",e),r=eV(n,e),s=tV(n,e),o=Pi(n,"z-index",e);if(!t&&!i&&!r&&!s&&!rh(n))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(n));const a=new qi;return function(u){let h=!0;if(t){const d=t(u);d&&(h=!1),a.setFill(d)}if(i){const d=i(u);d&&(h=!1),a.setStroke(d)}if(r){const d=r(u);d&&(h=!1),a.setText(d)}if(s){const d=s(u);d&&(h=!1),a.setImage(d)}return o&&a.setZIndex(o(u)),h?null:a}}function Ff(n,e,t){let i;if(e+"fill-pattern-src"in n)i=sV(n,e+"fill-",t);else{if(n[e+"fill-color"]==="none")return s=>null;i=sx(n,e+"fill-color",t)}if(!i)return null;const r=new ka;return function(s){const o=i(s);return o===Zw?null:(r.setColor(o),r)}}function Gf(n,e,t){const i=Pi(n,e+"stroke-width",t),r=sx(n,e+"stroke-color",t);if(!i&&!r)return null;const s=so(n,e+"stroke-line-cap",t),o=so(n,e+"stroke-line-join",t),a=Hb(n,e+"stroke-line-dash",t),u=Pi(n,e+"stroke-line-dash-offset",t),h=Pi(n,e+"stroke-miter-limit",t),d=new Wl;return function(g){if(r){const m=r(g);if(m===Zw)return null;d.setColor(m)}if(i&&d.setWidth(i(g)),s){const m=s(g);if(m!=="butt"&&m!=="round"&&m!=="square")throw new Error("Expected butt, round, or square line cap");d.setLineCap(m)}if(o){const m=o(g);if(m!=="bevel"&&m!=="round"&&m!=="miter")throw new Error("Expected bevel, round, or miter line join");d.setLineJoin(m)}return a&&d.setLineDash(a(g)),u&&d.setLineDashOffset(u(g)),h&&d.setMiterLimit(h(g)),d}}function eV(n,e){const t="text-",i=so(n,t+"value",e);if(!i)return null;const r=Ff(n,t,e),s=Ff(n,t+"background-",e),o=Gf(n,t,e),a=Gf(n,t+"background-",e),u=so(n,t+"font",e),h=Pi(n,t+"max-angle",e),d=Pi(n,t+"offset-x",e),g=Pi(n,t+"offset-y",e),m=qc(n,t+"overflow",e),v=so(n,t+"placement",e),y=Pi(n,t+"repeat",e),I=M_(n,t+"scale",e),w=qc(n,t+"rotate-with-view",e),R=Pi(n,t+"rotation",e),P=so(n,t+"align",e),b=so(n,t+"justify",e),L=so(n,t+"baseline",e),D=qc(n,t+"keep-upright",e),B=Hb(n,t+"padding",e),M=b_(n,t+"declutter-mode"),A=new ix({declutterMode:M});return function(k){if(A.setText(i(k)),r&&A.setFill(r(k)),s&&A.setBackgroundFill(s(k)),o&&A.setStroke(o(k)),a&&A.setBackgroundStroke(a(k)),u&&A.setFont(u(k)),h&&A.setMaxAngle(h(k)),d&&A.setOffsetX(d(k)),g&&A.setOffsetY(g(k)),m&&A.setOverflow(m(k)),v){const F=v(k);if(F!=="point"&&F!=="line")throw new Error("Expected point or line for text-placement");A.setPlacement(F)}if(y&&A.setRepeat(y(k)),I&&A.setScale(I(k)),w&&A.setRotateWithView(w(k)),R&&A.setRotation(R(k)),P){const F=P(k);if(F!=="left"&&F!=="center"&&F!=="right"&&F!=="end"&&F!=="start")throw new Error("Expected left, right, center, start, or end for text-align");A.setTextAlign(F)}if(b){const F=b(k);if(F!=="left"&&F!=="right"&&F!=="center")throw new Error("Expected left, right, or center for text-justify");A.setJustify(F)}if(L){const F=L(k);if(F!=="bottom"&&F!=="top"&&F!=="middle"&&F!=="alphabetic"&&F!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");A.setTextBaseline(F)}return B&&A.setPadding(B(k)),D&&A.setKeepUpright(D(k)),A}}function tV(n,e){return"icon-src"in n?nV(n,e):"shape-points"in n?iV(n,e):"circle-radius"in n?rV(n,e):null}function nV(n,e){const t="icon-",i=t+"src",r=Xb(n[i],i),s=y0(n,t+"anchor",e),o=M_(n,t+"scale",e),a=Pi(n,t+"opacity",e),u=y0(n,t+"displacement",e),h=Pi(n,t+"rotation",e),d=qc(n,t+"rotate-with-view",e),g=SA(n,t+"anchor-origin"),m=AA(n,t+"anchor-x-units"),v=AA(n,t+"anchor-y-units"),y=uV(n,t+"color"),I=aV(n,t+"cross-origin"),w=lV(n,t+"offset"),R=SA(n,t+"offset-origin"),P=v0(n,t+"width"),b=v0(n,t+"height"),L=oV(n,t+"size"),D=b_(n,t+"declutter-mode"),B=new _0({src:r,anchorOrigin:g,anchorXUnits:m,anchorYUnits:v,color:y,crossOrigin:I,offset:w,offsetOrigin:R,height:b,width:P,size:L,declutterMode:D});return function(M){return a&&B.setOpacity(a(M)),u&&B.setDisplacement(u(M)),h&&B.setRotation(h(M)),d&&B.setRotateWithView(d(M)),o&&B.setScale(o(M)),s&&B.setAnchor(s(M)),B}}function iV(n,e){const t="shape-",i=t+"points",r=t+"radius",s=mE(n[i],i),o=mE(n[r],r),a=Ff(n,t,e),u=Gf(n,t,e),h=M_(n,t+"scale",e),d=y0(n,t+"displacement",e),g=Pi(n,t+"rotation",e),m=qc(n,t+"rotate-with-view",e),v=v0(n,t+"radius2"),y=v0(n,t+"angle"),I=b_(n,t+"declutter-mode"),w=new C_({points:s,radius:o,radius2:v,angle:y,declutterMode:I});return function(R){return a&&w.setFill(a(R)),u&&w.setStroke(u(R)),d&&w.setDisplacement(d(R)),g&&w.setRotation(g(R)),m&&w.setRotateWithView(m(R)),h&&w.setScale(h(R)),w}}function rV(n,e){const t="circle-",i=Ff(n,t,e),r=Gf(n,t,e),s=Pi(n,t+"radius",e),o=M_(n,t+"scale",e),a=y0(n,t+"displacement",e),u=Pi(n,t+"rotation",e),h=qc(n,t+"rotate-with-view",e),d=b_(n,t+"declutter-mode"),g=new Ch({radius:5,declutterMode:d});return function(m){return s&&g.setRadius(s(m)),i&&g.setFill(i(m)),r&&g.setStroke(r(m)),a&&g.setDisplacement(a(m)),u&&g.setRotation(u(m)),h&&g.setRotateWithView(h(m)),o&&g.setScale(o(m)),g}}function Pi(n,e,t){if(!(e in n))return;const i=So(n[e],nt,t);return function(r){return mE(i(r),e)}}function so(n,e,t){if(!(e in n))return null;const i=So(n[e],Ai,t);return function(r){return Xb(i(r),e)}}function sV(n,e,t){const i=so(n,e+"pattern-src",t),r=IA(n,e+"pattern-offset",t),s=IA(n,e+"pattern-size",t),o=sx(n,e+"color",t);return function(a){return{src:i(a),offset:r&&r(a),size:s&&s(a),color:o&&o(a)}}}function qc(n,e,t){if(!(e in n))return null;const i=So(n[e],li,t);return function(r){const s=i(r);if(typeof s!="boolean")throw new Error(`Expected a boolean for ${e}`);return s}}function sx(n,e,t){if(!(e in n))return null;const i=So(n[e],zr,t);return function(r){return Yb(i(r),e)}}function Hb(n,e,t){if(!(e in n))return null;const i=So(n[e],tu,t);return function(r){return wg(i(r),e)}}function y0(n,e,t){if(!(e in n))return null;const i=So(n[e],tu,t);return function(r){const s=wg(i(r),e);if(s.length!==2)throw new Error(`Expected two numbers for ${e}`);return s}}function IA(n,e,t){if(!(e in n))return null;const i=So(n[e],tu,t);return function(r){return Zb(i(r),e)}}function M_(n,e,t){if(!(e in n))return null;const i=So(n[e],tu|nt,t);return function(r){return cV(i(r),e)}}function v0(n,e){const t=n[e];if(t!==void 0){if(typeof t!="number")throw new Error(`Expected a number for ${e}`);return t}}function oV(n,e){const t=n[e];if(t!==void 0){if(typeof t=="number")return Mi(t);if(!Array.isArray(t))throw new Error(`Expected a number or size array for ${e}`);if(t.length!==2||typeof t[0]!="number"||typeof t[1]!="number")throw new Error(`Expected a number or size array for ${e}`);return t}}function aV(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);return t}}function SA(n,e){const t=n[e];if(t!==void 0){if(t!=="bottom-left"&&t!=="bottom-right"&&t!=="top-left"&&t!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return t}}function AA(n,e){const t=n[e];if(t!==void 0){if(t!=="pixels"&&t!=="fraction")throw new Error(`Expected pixels or fraction for ${e}`);return t}}function lV(n,e){const t=n[e];if(t!==void 0)return wg(t,e)}function b_(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);if(t!=="declutter"&&t!=="obstacle"&&t!=="none")throw new Error(`Expected declutter, obstacle, or none for ${e}`);return t}}function uV(n,e){const t=n[e];if(t!==void 0)return Yb(t,e)}function wg(n,e){if(!Array.isArray(n))throw new Error(`Expected an array for ${e}`);const t=n.length;for(let i=0;i<t;++i)if(typeof n[i]!="number")throw new Error(`Expected an array of numbers for ${e}`);return n}function Xb(n,e){if(typeof n!="string")throw new Error(`Expected a string for ${e}`);return n}function mE(n,e){if(typeof n!="number")throw new Error(`Expected a number for ${e}`);return n}function Yb(n,e){if(typeof n=="string")return n;const t=wg(n,e),i=t.length;if(i<3||i>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return t}function Zb(n,e){const t=wg(n,e);if(t.length!==2)throw new Error(`Expected an array of two numbers for ${e}`);return t}function cV(n,e){return typeof n=="number"?n:Zb(n,e)}const Fr={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function RA(n,e,t){return(function(i,r,s,o,a){if(!i)return;if(!r&&!e)return i;const u=e?0:s[0]*r,h=e?0:s[1]*r,d=a?a[0]:0,g=a?a[1]:0;let m=n[0]+u/2+d,v=n[2]-u/2+d,y=n[1]+h/2+g,I=n[3]-h/2+g;m>v&&(m=(v+m)/2,v=m),y>I&&(y=(I+y)/2,I=y);let w=kt(i[0],m,v),R=kt(i[1],y,I);if(o&&t&&r){const P=30*r;w+=-P*Math.log(1+Math.max(0,m-i[0])/P)+P*Math.log(1+Math.max(0,i[0]-v)/P),R+=-P*Math.log(1+Math.max(0,y-i[1])/P)+P*Math.log(1+Math.max(0,i[1]-I)/P)}return[w,R]})}function hV(n){return n}function Qb(n){return Math.pow(n,3)}function Mh(n){return 1-Qb(1-n)}function dV(n){return 3*n*n-2*n*n*n}function fV(n){return n}function ox(n,e,t,i){const r=ut(e)/t[0],s=Jn(e)/t[1];return i?Math.min(n,Math.max(r,s)):Math.min(n,Math.min(r,s))}function ax(n,e,t){let i=Math.min(n,e);const r=50;return i*=Math.log(1+r*Math.max(0,n/e-1))/r+1,t&&(i=Math.max(i,t),i/=Math.log(1+r*Math.max(0,t/n-1))/r+1),kt(i,t/2,e*2)}function gV(n,e,t,i){return e=e!==void 0?e:!0,(function(r,s,o,a){if(r!==void 0){const u=n[0],h=n[n.length-1],d=t?ox(u,t,o,i):u;if(a)return e?ax(r,d,h):kt(r,h,d);const g=Math.min(d,r),m=Math.floor(Dw(n,g,s));return n[m]>d&&m<n.length-1?n[m+1]:n[m]}})}function mV(n,e,t,i,r,s){return i=i!==void 0?i:!0,t=t!==void 0?t:0,(function(o,a,u,h){if(o!==void 0){const d=r?ox(e,r,u,s):e;if(h)return i?ax(o,d,t):kt(o,t,d);const g=1e-9,m=Math.ceil(Math.log(e/d)/Math.log(n)-g),v=-a*(.5-g)+.5,y=Math.min(d,o),I=Math.floor(Math.log(e/y)/Math.log(n)+v),w=Math.max(m,I),R=e/Math.pow(n,w);return kt(R,t,d)}})}function PA(n,e,t,i,r){return t=t!==void 0?t:!0,(function(s,o,a,u){if(s!==void 0){const h=i?ox(n,i,a,r):n;return!t||!u?kt(s,e,h):ax(s,h,e)}})}function lx(n){if(n!==void 0)return 0}function CA(n){if(n!==void 0)return n}function pV(n){const e=2*Math.PI/n;return(function(t,i){if(i)return t;if(t!==void 0)return t=Math.floor(t/e+.5)*e,t})}function _V(n){const e=xa(5);return(function(t,i){return i||t===void 0?t:Math.abs(t)<=e?0:t})}const yV=42,ux=256,o1=0;class ws extends Ns{constructor(e){super(),this.on,this.once,this.un,e=Object.assign({},e),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=zw(e.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,e.projection&&ob(),e.center&&(e.center=ro(e.center,this.projection_)),e.extent&&(e.extent=_a(e.extent,this.projection_)),this.applyOptions_(e)}applyOptions_(e){const t=Object.assign({},e);for(const a in Fr)delete t[a];this.setProperties(t,!0);const i=EV(e);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=i.minZoom;const r=vV(e),s=i.constraint,o=wV(e);this.constraints_={center:r,resolution:s,rotation:o},this.setRotation(e.rotation!==void 0?e.rotation:0),this.setCenterInternal(e.center!==void 0?e.center:null),e.resolution!==void 0?this.setResolution(e.resolution):e.zoom!==void 0&&this.setZoom(e.zoom)}get padding(){return this.padding_}set padding(e){let t=this.padding_;this.padding_=e;const i=this.getCenterInternal();if(i){const r=e||[0,0,0,0];t=t||[0,0,0,0];const s=this.getResolution(),o=s/2*(r[3]-t[3]+t[1]-r[1]),a=s/2*(r[0]-t[0]+t[2]-r[2]);this.setCenterInternal([i[0]+o,i[1]-a])}}getUpdatedOptions_(e){const t=this.getProperties();return t.resolution!==void 0?t.resolution=this.getResolution():t.zoom=this.getZoom(),t.center=this.getCenterInternal(),t.rotation=this.getRotation(),Object.assign({},t,e)}animate(e){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const t=new Array(arguments.length);for(let i=0;i<t.length;++i){let r=arguments[i];r.center&&(r=Object.assign({},r),r.center=ro(r.center,this.getProjection())),r.anchor&&(r=Object.assign({},r),r.anchor=ro(r.anchor,this.getProjection())),t[i]=r}this.animateInternal.apply(this,t)}animateInternal(e){let t=arguments.length,i;t>1&&typeof arguments[t-1]=="function"&&(i=arguments[t-1],--t);let r=0;for(;r<t&&!this.isDef();++r){const d=arguments[r];d.center&&this.setCenterInternal(d.center),d.zoom!==void 0?this.setZoom(d.zoom):d.resolution&&this.setResolution(d.resolution),d.rotation!==void 0&&this.setRotation(d.rotation)}if(r===t){i&&fp(i,!0);return}let s=Date.now(),o=this.targetCenter_.slice(),a=this.targetResolution_,u=this.targetRotation_;const h=[];for(;r<t;++r){const d=arguments[r],g={start:s,complete:!1,anchor:d.anchor,duration:d.duration!==void 0?d.duration:1e3,easing:d.easing||dV,callback:i};if(d.center&&(g.sourceCenter=o,g.targetCenter=d.center.slice(),o=g.targetCenter),d.zoom!==void 0?(g.sourceResolution=a,g.targetResolution=this.getResolutionForZoom(d.zoom),a=g.targetResolution):d.resolution&&(g.sourceResolution=a,g.targetResolution=d.resolution,a=g.targetResolution),d.rotation!==void 0){g.sourceRotation=u;const m=Ta(d.rotation-u+Math.PI,2*Math.PI)-Math.PI;g.targetRotation=u+m,u=g.targetRotation}xV(g)?g.complete=!0:s+=g.duration,h.push(g)}this.animations_.push(h),this.setHint(Xn.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[Xn.ANIMATING]>0}getInteracting(){return this.hints_[Xn.INTERACTING]>0}cancelAnimations(){this.setHint(Xn.ANIMATING,-this.hints_[Xn.ANIMATING]);let e;for(let t=0,i=this.animations_.length;t<i;++t){const r=this.animations_[t];if(r[0].callback&&fp(r[0].callback,!1),!e)for(let s=0,o=r.length;s<o;++s){const a=r[s];if(!a.complete){e=a.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=e,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const e=Date.now();let t=!1;for(let i=this.animations_.length-1;i>=0;--i){const r=this.animations_[i];let s=!0;for(let o=0,a=r.length;o<a;++o){const u=r[o];if(u.complete)continue;const h=e-u.start;let d=u.duration>0?h/u.duration:1;d>=1?(u.complete=!0,d=1):s=!1;const g=u.easing(d);if(u.sourceCenter){const m=u.sourceCenter[0],v=u.sourceCenter[1],y=u.targetCenter[0],I=u.targetCenter[1];this.nextCenter_=u.targetCenter;const w=m+g*(y-m),R=v+g*(I-v);this.targetCenter_=[w,R]}if(u.sourceResolution&&u.targetResolution){const m=g===1?u.targetResolution:u.sourceResolution+g*(u.targetResolution-u.sourceResolution);if(u.anchor){const v=this.getViewportSize_(this.getRotation()),y=this.constraints_.resolution(m,0,v,!0);this.targetCenter_=this.calculateCenterZoom(y,u.anchor)}this.nextResolution_=u.targetResolution,this.targetResolution_=m,this.applyTargetState_(!0)}if(u.sourceRotation!==void 0&&u.targetRotation!==void 0){const m=g===1?Ta(u.targetRotation+Math.PI,2*Math.PI)-Math.PI:u.sourceRotation+g*(u.targetRotation-u.sourceRotation);if(u.anchor){const v=this.constraints_.rotation(m,!0);this.targetCenter_=this.calculateCenterRotate(v,u.anchor)}this.nextRotation_=u.targetRotation,this.targetRotation_=m}if(this.applyTargetState_(!0),t=!0,!u.complete)break}if(s){this.animations_[i]=null,this.setHint(Xn.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const o=r[0].callback;o&&fp(o,!0)}}this.animations_=this.animations_.filter(Boolean),t&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(e,t){let i;const r=this.getCenterInternal();return r!==void 0&&(i=[r[0]-t[0],r[1]-t[1]],Vw(i,e-this.getRotation()),p5(i,t)),i}calculateCenterZoom(e,t){let i;const r=this.getCenterInternal(),s=this.getResolution();if(r!==void 0&&s!==void 0){const o=t[0]-e*(t[0]-r[0])/s,a=t[1]-e*(t[1]-r[1])/s;i=[o,a]}return i}getViewportSize_(e){const t=this.viewportSize_;if(e){const i=t[0],r=t[1];return[Math.abs(i*Math.cos(e))+Math.abs(r*Math.sin(e)),Math.abs(i*Math.sin(e))+Math.abs(r*Math.cos(e))]}return t}setViewportSize(e){this.viewportSize_=Array.isArray(e)?e.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const e=this.getCenterInternal();return e&&oE(e,this.getProjection())}getCenterInternal(){return this.get(Fr.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(e){return e!==void 0?(e[0]=this.hints_[0],e[1]=this.hints_[1],e):this.hints_.slice()}calculateExtent(e){const t=this.calculateExtentInternal(e);return ab(t,this.getProjection())}calculateExtentInternal(e){e=e||this.getViewportSizeMinusPadding_();const t=this.getCenterInternal();_t(t,"The view center is not defined");const i=this.getResolution();_t(i!==void 0,"The view resolution is not defined");const r=this.getRotation();return _t(r!==void 0,"The view rotation is not defined"),eE(t,i,r,e)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))}setConstrainResolution(e){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:e}))}getProjection(){return this.projection_}getResolution(){return this.get(Fr.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(e,t){return this.getResolutionForExtentInternal(_a(e,this.getProjection()),t)}getResolutionForExtentInternal(e,t){t=t||this.getViewportSizeMinusPadding_();const i=ut(e)/t[0],r=Jn(e)/t[1];return Math.max(i,r)}getResolutionForValueFunction(e){e=e||2;const t=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,r=Math.log(t/i)/Math.log(e);return(function(s){return t/Math.pow(e,s*r)})}getRotation(){return this.get(Fr.ROTATION)}getValueForResolutionFunction(e){const t=Math.log(e||2),i=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,s=Math.log(i/r)/t;return(function(o){return Math.log(i/o)/t/s})}getViewportSizeMinusPadding_(e){let t=this.getViewportSize_(e);const i=this.padding_;return i&&(t=[t[0]-i[1]-i[3],t[1]-i[0]-i[2]]),t}getState(){const e=this.getProjection(),t=this.getResolution(),i=this.getRotation();let r=this.getCenterInternal();const s=this.padding_;if(s){const o=this.getViewportSizeMinusPadding_();r=a1(r,this.getViewportSize_(),[o[0]/2+s[3],o[1]/2+s[0]],t,i)}return{center:r.slice(0),projection:e!==void 0?e:null,resolution:t,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let e;const t=this.getResolution();return t!==void 0&&(e=this.getZoomForResolution(t)),e}getZoomForResolution(e){let t=this.minZoom_||0,i,r;if(this.resolutions_){const s=Dw(this.resolutions_,e,1);t=s,i=this.resolutions_[s],s==this.resolutions_.length-1?r=2:r=i/this.resolutions_[s+1]}else i=this.maxResolution_,r=this.zoomFactor_;return t+Math.log(i/e)/Math.log(r)}getResolutionForZoom(e){if(this.resolutions_?.length){if(this.resolutions_.length===1)return this.resolutions_[0];const t=kt(Math.floor(e),0,this.resolutions_.length-2),i=this.resolutions_[t]/this.resolutions_[t+1];return this.resolutions_[t]/Math.pow(i,kt(e-t,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,e-this.minZoom_)}fit(e,t){let i;if(_t(Array.isArray(e)||typeof e.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(e)){_t(!E_(e),"Cannot fit empty extent provided as `geometry`");const r=_a(e,this.getProjection());i=aA(r)}else if(e.getType()==="Circle"){const r=_a(e.getExtent(),this.getProjection());i=aA(r),i.rotate(this.getRotation(),Zl(r))}else i=e;this.fitInternal(i,t)}rotatedExtentForGeometry(e){const t=this.getRotation(),i=Math.cos(t),r=Math.sin(-t),s=e.getFlatCoordinates(),o=e.getStride();let a=1/0,u=1/0,h=-1/0,d=-1/0;for(let g=0,m=s.length;g<m;g+=o){const v=s[g]*i-s[g+1]*r,y=s[g]*r+s[g+1]*i;a=Math.min(a,v),u=Math.min(u,y),h=Math.max(h,v),d=Math.max(d,y)}return[a,u,h,d]}fitInternal(e,t){t=t||{};let i=t.size;i||(i=this.getViewportSizeMinusPadding_());const r=t.padding!==void 0?t.padding:[0,0,0,0],s=t.nearest!==void 0?t.nearest:!1;let o;t.minResolution!==void 0?o=t.minResolution:t.maxZoom!==void 0?o=this.getResolutionForZoom(t.maxZoom):o=0;const a=this.rotatedExtentForGeometry(e);let u=this.getResolutionForExtentInternal(a,[i[0]-r[1]-r[3],i[1]-r[0]-r[2]]);u=isNaN(u)?o:Math.max(u,o),u=this.getConstrainedResolution(u,s?0:1);const h=this.getRotation(),d=Math.sin(h),g=Math.cos(h),m=Zl(a);m[0]+=(r[1]-r[3])/2*u,m[1]+=(r[0]-r[2])/2*u;const v=m[0]*g-m[1]*d,y=m[1]*g+m[0]*d,I=this.getConstrainedCenter([v,y],u),w=t.callback?t.callback:Cf;t.duration!==void 0?this.animateInternal({resolution:u,center:I,duration:t.duration,easing:t.easing},w):(this.targetResolution_=u,this.targetCenter_=I,this.applyTargetState_(!1,!0),fp(w,!0))}centerOn(e,t,i){this.centerOnInternal(ro(e,this.getProjection()),t,i)}centerOnInternal(e,t,i){this.setCenterInternal(a1(e,t,i,this.getResolution(),this.getRotation()))}calculateCenterShift(e,t,i,r){let s;const o=this.padding_;if(o&&e){const a=this.getViewportSizeMinusPadding_(-i),u=a1(e,r,[a[0]/2+o[3],a[1]/2+o[0]],t,i);s=[e[0]-u[0],e[1]-u[1]]}return s}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(e){const t=oE(this.targetCenter_,this.getProjection());this.setCenter([t[0]+e[0],t[1]+e[1]])}adjustCenterInternal(e){const t=this.targetCenter_;this.setCenterInternal([t[0]+e[0],t[1]+e[1]])}adjustResolution(e,t){t=t&&ro(t,this.getProjection()),this.adjustResolutionInternal(e,t)}adjustResolutionInternal(e,t){const i=this.getAnimating()||this.getInteracting(),r=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*e,0,r,i);t&&(this.targetCenter_=this.calculateCenterZoom(s,t)),this.targetResolution_*=e,this.applyTargetState_()}adjustZoom(e,t){this.adjustResolution(Math.pow(this.zoomFactor_,-e),t)}adjustRotation(e,t){t&&(t=ro(t,this.getProjection())),this.adjustRotationInternal(e,t)}adjustRotationInternal(e,t){const i=this.getAnimating()||this.getInteracting(),r=this.constraints_.rotation(this.targetRotation_+e,i);t&&(this.targetCenter_=this.calculateCenterRotate(r,t)),this.targetRotation_+=e,this.applyTargetState_()}setCenter(e){this.setCenterInternal(e&&ro(e,this.getProjection()))}setCenterInternal(e){this.targetCenter_=e,this.applyTargetState_()}setHint(e,t){return this.hints_[e]+=t,this.changed(),this.hints_[e]}setResolution(e){this.targetResolution_=e,this.applyTargetState_()}setRotation(e){this.targetRotation_=e,this.applyTargetState_()}setZoom(e){this.setResolution(this.getResolutionForZoom(e))}applyTargetState_(e,t){const i=this.getAnimating()||this.getInteracting()||t,r=this.constraints_.rotation(this.targetRotation_,i),s=this.getViewportSize_(r),o=this.constraints_.resolution(this.targetResolution_,0,s,i),a=this.constraints_.center(this.targetCenter_,o,s,i,this.calculateCenterShift(this.targetCenter_,o,r,s));this.get(Fr.ROTATION)!==r&&this.set(Fr.ROTATION,r),this.get(Fr.RESOLUTION)!==o&&(this.set(Fr.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),(!a||!this.get(Fr.CENTER)||!o0(this.get(Fr.CENTER),a))&&this.set(Fr.CENTER,a),this.getAnimating()&&!e&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(e,t,i){e=e!==void 0?e:200;const r=t||0,s=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(s),a=this.constraints_.resolution(this.targetResolution_,r,o),u=this.constraints_.center(this.targetCenter_,a,o,!1,this.calculateCenterShift(this.targetCenter_,a,s,o));if(e===0&&!this.cancelAnchor_){this.targetResolution_=a,this.targetRotation_=s,this.targetCenter_=u,this.applyTargetState_();return}i=i||(e===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==a||this.getRotation()!==s||!this.getCenterInternal()||!o0(this.getCenterInternal(),u))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:u,resolution:a,duration:e,easing:Mh,anchor:i}))}beginInteraction(){this.resolveConstraints(0),this.setHint(Xn.INTERACTING,1)}endInteraction(e,t,i){i=i&&ro(i,this.getProjection()),this.endInteractionInternal(e,t,i)}endInteractionInternal(e,t,i){this.getInteracting()&&(this.setHint(Xn.INTERACTING,-1),this.resolveConstraints(e,t,i))}getConstrainedCenter(e,t){const i=this.getViewportSize_(this.getRotation());return this.constraints_.center(e,t||this.getResolution(),i)}getConstrainedZoom(e,t){const i=this.getResolutionForZoom(e);return this.getZoomForResolution(this.getConstrainedResolution(i,t))}getConstrainedResolution(e,t){t=t||0;const i=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(e,t,i)}}function fp(n,e){setTimeout(function(){n(e)},0)}function vV(n){if(n.extent!==void 0){const t=n.smoothExtentConstraint!==void 0?n.smoothExtentConstraint:!0;return RA(n.extent,n.constrainOnlyCenter,t)}const e=zw(n.projection,"EPSG:3857");if(n.multiWorld!==!0&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,RA(t,!1,!1)}return hV}function EV(n){let e,t,i,o=n.minZoom!==void 0?n.minZoom:o1,a=n.maxZoom!==void 0?n.maxZoom:28;const u=n.zoomFactor!==void 0?n.zoomFactor:2,h=n.multiWorld!==void 0?n.multiWorld:!1,d=n.smoothResolutionConstraint!==void 0?n.smoothResolutionConstraint:!0,g=n.showFullExtent!==void 0?n.showFullExtent:!1,m=zw(n.projection,"EPSG:3857"),v=m.getExtent();let y=n.constrainOnlyCenter,I=n.extent;if(!h&&!I&&m.isGlobal()&&(y=!1,I=v),n.resolutions!==void 0){const w=n.resolutions;t=w[o],i=w[a]!==void 0?w[a]:w[w.length-1],n.constrainResolution?e=gV(w,d,!y&&I,g):e=PA(t,i,d,!y&&I,g)}else{const R=(v?Math.max(ut(v),Jn(v)):360*Fw.degrees/m.getMetersPerUnit())/ux/Math.pow(2,o1),P=R/Math.pow(2,28-o1);t=n.maxResolution,t!==void 0?o=0:t=R/Math.pow(u,o),i=n.minResolution,i===void 0&&(n.maxZoom!==void 0?n.maxResolution!==void 0?i=t/Math.pow(u,a):i=R/Math.pow(u,a):i=P),a=o+Math.floor(Math.log(t/i)/Math.log(u)),i=t/Math.pow(u,a-o),n.constrainResolution?e=mV(u,t,i,d,!y&&I,g):e=PA(t,i,d,!y&&I,g)}return{constraint:e,maxResolution:t,minResolution:i,minZoom:o,zoomFactor:u}}function wV(n){if(n.enableRotation!==void 0?n.enableRotation:!0){const t=n.constrainRotation;return t===void 0||t===!0?_V():t===!1?CA:typeof t=="number"?pV(t):CA}return lx}function xV(n){return!(n.sourceCenter&&n.targetCenter&&!o0(n.sourceCenter,n.targetCenter)||n.sourceResolution!==n.targetResolution||n.sourceRotation!==n.targetRotation)}function a1(n,e,t,i,r){const s=Math.cos(-r);let o=Math.sin(-r),a=n[0]*s-n[1]*o,u=n[1]*s+n[0]*o;a+=(e[0]/2-t[0])*i,u+=(t[1]-e[1]/2)*i,o=-o;const h=a*s-u*o,d=u*s+a*o;return[h,d]}const wt={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class Jb extends Ns{constructor(e){super(),this.on,this.once,this.un,this.background_=e.background;const t=Object.assign({},e);typeof e.properties=="object"&&(delete t.properties,Object.assign(t,e.properties)),t[wt.OPACITY]=e.opacity!==void 0?e.opacity:1,_t(typeof t[wt.OPACITY]=="number","Layer opacity must be a number"),t[wt.VISIBLE]=e.visible!==void 0?e.visible:!0,t[wt.Z_INDEX]=e.zIndex,t[wt.MAX_RESOLUTION]=e.maxResolution!==void 0?e.maxResolution:1/0,t[wt.MIN_RESOLUTION]=e.minResolution!==void 0?e.minResolution:0,t[wt.MIN_ZOOM]=e.minZoom!==void 0?e.minZoom:-1/0,t[wt.MAX_ZOOM]=e.maxZoom!==void 0?e.maxZoom:1/0,this.className_=t.className!==void 0?t.className:"ol-layer",delete t.className,this.setProperties(t),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(e){const t=this.state_||{layer:this,managed:e===void 0?!0:e},i=this.getZIndex();return t.opacity=kt(Math.round(this.getOpacity()*100)/100,0,1),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=i===void 0&&!t.managed?1/0:i,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),t.minZoom=this.getMinZoom(),t.maxZoom=this.getMaxZoom(),this.state_=t,t}getLayersArray(e){return ot()}getLayerStatesArray(e){return ot()}getExtent(){return this.get(wt.EXTENT)}getMaxResolution(){return this.get(wt.MAX_RESOLUTION)}getMinResolution(){return this.get(wt.MIN_RESOLUTION)}getMinZoom(){return this.get(wt.MIN_ZOOM)}getMaxZoom(){return this.get(wt.MAX_ZOOM)}getOpacity(){return this.get(wt.OPACITY)}getSourceState(){return ot()}getVisible(){return this.get(wt.VISIBLE)}getZIndex(){return this.get(wt.Z_INDEX)}setBackground(e){this.background_=e,this.changed()}setExtent(e){this.set(wt.EXTENT,e)}setMaxResolution(e){this.set(wt.MAX_RESOLUTION,e)}setMinResolution(e){this.set(wt.MIN_RESOLUTION,e)}setMaxZoom(e){this.set(wt.MAX_ZOOM,e)}setMinZoom(e){this.set(wt.MIN_ZOOM,e)}setOpacity(e){_t(typeof e=="number","Layer opacity must be a number"),this.set(wt.OPACITY,e)}setVisible(e){this.set(wt.VISIBLE,e)}setZIndex(e){this.set(wt.Z_INDEX,e)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}class k_ extends Jb{constructor(e){const t=Object.assign({},e);delete t.source,super(t),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,e.render&&(this.render=e.render),e.map&&this.setMap(e.map),this.addChangeListener(wt.SOURCE,this.handleSourcePropertyChange_);const i=e.source?e.source:null;this.setSource(i)}getLayersArray(e){return e=e||[],e.push(this),e}getLayerStatesArray(e){return e=e||[],e.push(this.getLayerState()),e}getSource(){return this.get(wt.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const e=this.getSource();return e?e.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(Ft(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const e=this.getSource();e&&(this.sourceChangeKey_=at(e,He.CHANGE,this.handleSourceChange_,this),e.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(e){return this.renderer_?this.renderer_.getFeatures(e):Promise.resolve([])}getData(e){return!this.renderer_||!this.rendered?null:this.renderer_.getData(e)}isVisible(e){let t;const i=this.getMapInternal();!e&&i&&(e=i.getView()),e instanceof ws?t={viewState:e.getState(),extent:e.calculateExtent()}:t=e,!t.layerStatesArray&&i&&(t.layerStatesArray=i.getLayerGroup().getLayerStatesArray());let r;if(t.layerStatesArray){if(r=t.layerStatesArray.find(o=>o.layer===this),!r)return!1}else r=this.getLayerState();const s=this.getExtent();return cx(r,t.viewState)&&(!s||Ri(s,t.extent))}getAttributions(e){if(!this.isVisible(e))return[];const t=this.getSource()?.getAttributions();if(!t)return[];const i=e instanceof ws?e.getViewStateAndExtent():e;let r=t(i);return Array.isArray(r)||(r=[r]),r}render(e,t){const i=this.getRenderer();return i.prepareFrame(e)?(this.rendered=!0,i.renderFrame(e,t)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(e,t){}renderDeferred(e){const t=this.getRenderer();t&&t.renderDeferred(e)}setMapInternal(e){e||this.unrender(),this.set(wt.MAP,e)}getMapInternal(){return this.get(wt.MAP)}setMap(e){this.mapPrecomposeKey_&&(Ft(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(Ft(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=at(e,wr.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=at(this,He.CHANGE,e.render,e),this.changed())}handlePrecompose_(e){const t=e.frameState.layerStatesArray,i=this.getLayerState(!1);_t(!t.some(r=>r.layer===i.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),t.push(i)}setSource(e){this.set(wt.SOURCE,e)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}}function cx(n,e){if(!n.visible)return!1;const t=e.resolution;if(t<n.minResolution||t>=n.maxResolution)return!1;const i=e.zoom;return i>n.minZoom&&i<=n.maxZoom}const MA={RENDER_ORDER:"renderOrder"};class e4 extends k_{constructor(e){e=e||{};const t=Object.assign({},e);delete t.style,delete t.renderBuffer,delete t.updateWhileAnimating,delete t.updateWhileInteracting,super(t),this.declutter_=e.declutter?String(e.declutter):void 0,this.renderBuffer_=e.renderBuffer!==void 0?e.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(e.style),this.updateWhileAnimating_=e.updateWhileAnimating!==void 0?e.updateWhileAnimating:!1,this.updateWhileInteracting_=e.updateWhileInteracting!==void 0?e.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(e){return super.getFeatures(e)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(MA.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(e,t){const i=this.getDeclutter();i in e.declutter||(e.declutter[i]=new Ob(9)),this.getRenderer().renderDeclutter(e,t)}setRenderOrder(e){this.set(MA.RENDER_ORDER,e)}setStyle(e){this.style_=e===void 0?Gb:e;const t=TV(e);this.styleFunction_=e===null?void 0:s8(t),this.changed()}setDeclutter(e){this.declutter_=e?String(e):void 0,this.changed()}}function TV(n){if(n===void 0)return Gb;if(!n)return null;if(typeof n=="function"||n instanceof qi)return n;if(!Array.isArray(n))return TA([n]);if(n.length===0)return[];const e=n.length,t=n[0];if(t instanceof qi){const r=new Array(e);for(let s=0;s<e;++s){const o=n[s];if(!(o instanceof qi))throw new Error("Expected a list of style instances");r[s]=o}return r}if("style"in t){const r=new Array(e);for(let s=0;s<e;++s){const o=n[s];if(!("style"in o))throw new Error("Expected a list of rules with a style property");r[s]=o}return Q8(r)}return TA(n)}class t4 extends e4{constructor(e){super(e)}createRenderer(){return new A8(this)}}const na={ADDLAYER:"addlayer",REMOVELAYER:"removelayer"};class ha extends Io{constructor(e,t){super(e),this.layer=t}}const l1={LAYERS:"layers"};let L_=class n4 extends Jb{constructor(e){e=e||{};const t=Object.assign({},e);delete t.layers;let i=e.layers;super(t),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(l1.LAYERS,this.handleLayersChanged_),i?Array.isArray(i)?i=new Er(i.slice(),{unique:!0}):_t(typeof i.getArray=="function","Expected `layers` to be an array or a `Collection`"):i=new Er(void 0,{unique:!0}),this.setLayers(i)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(Ft),this.layersListenerKeys_.length=0;const e=this.getLayers();this.layersListenerKeys_.push(at(e,Ii.ADD,this.handleLayersAdd_,this),at(e,Ii.REMOVE,this.handleLayersRemove_,this));for(const i in this.listenerKeys_)this.listenerKeys_[i].forEach(Ft);gg(this.listenerKeys_);const t=e.getArray();for(let i=0,r=t.length;i<r;i++){const s=t[i];this.registerLayerListeners_(s),this.dispatchEvent(new ha(na.ADDLAYER,s))}this.changed()}registerLayerListeners_(e){const t=[at(e,ih.PROPERTYCHANGE,this.handleLayerChange_,this),at(e,He.CHANGE,this.handleLayerChange_,this)];e instanceof n4&&t.push(at(e,na.ADDLAYER,this.handleLayerGroupAdd_,this),at(e,na.REMOVELAYER,this.handleLayerGroupRemove_,this)),this.listenerKeys_[lt(e)]=t}handleLayerGroupAdd_(e){this.dispatchEvent(new ha(na.ADDLAYER,e.layer))}handleLayerGroupRemove_(e){this.dispatchEvent(new ha(na.REMOVELAYER,e.layer))}handleLayersAdd_(e){const t=e.element;this.registerLayerListeners_(t),this.dispatchEvent(new ha(na.ADDLAYER,t)),this.changed()}handleLayersRemove_(e){const t=e.element,i=lt(t);this.listenerKeys_[i].forEach(Ft),delete this.listenerKeys_[i],this.dispatchEvent(new ha(na.REMOVELAYER,t)),this.changed()}getLayers(){return this.get(l1.LAYERS)}setLayers(e){const t=this.getLayers();if(t){const i=t.getArray();for(let r=0,s=i.length;r<s;++r)this.dispatchEvent(new ha(na.REMOVELAYER,i[r]))}this.set(l1.LAYERS,e)}getLayersArray(e){return e=e!==void 0?e:[],this.getLayers().forEach(function(t){t.getLayersArray(e)}),e}getLayerStatesArray(e){const t=e!==void 0?e:[],i=t.length;this.getLayers().forEach(function(o){o.getLayerStatesArray(t)});const r=this.getLayerState();let s=r.zIndex;!e&&r.zIndex===void 0&&(s=0);for(let o=i,a=t.length;o<a;o++){const u=t[o];u.opacity*=r.opacity,u.visible=u.visible&&r.visible,u.maxResolution=Math.min(u.maxResolution,r.maxResolution),u.minResolution=Math.max(u.minResolution,r.minResolution),u.minZoom=Math.max(u.minZoom,r.minZoom),u.maxZoom=Math.min(u.maxZoom,r.maxZoom),r.extent!==void 0&&(u.extent!==void 0?u.extent=$l(u.extent,r.extent):u.extent=r.extent),u.zIndex===void 0&&(u.zIndex=s)}return t}getSourceState(){return"ready"}};const ke={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};class hx extends mg{constructor(e,t,i){super(),i=i||{},this.tileCoord=e,this.state=t,this.key="",this.transition_=i.transition===void 0?250:i.transition,this.transitionStarts_={},this.interpolate=!!i.interpolate}changed(){this.dispatchEvent(He.CHANGE)}release(){this.setState(ke.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(e){if(this.state!==ke.EMPTY){if(this.state!==ke.ERROR&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()}}load(){ot()}getAlpha(e,t){if(!this.transition_)return 1;let i=this.transitionStarts_[e];if(!i)i=t,this.transitionStarts_[e]=i;else if(i===-1)return 1;const r=t-i+1e3/60;return r>=this.transition_?1:Qb(r/this.transition_)}inTransition(e){return this.transition_?this.transitionStarts_[e]!==-1:!1}endTransition(e){this.transition_&&(this.transitionStarts_[e]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}function pE(n){return n instanceof Image||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageBitmap?n:null}const IV=new Error("disposed"),SV=[256,256];class bA extends hx{constructor(e){const t=ke.IDLE;super(e.tileCoord,t,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null,this.controller_=e.controller||null}getSize(){if(this.size_)return this.size_;const e=pE(this.data_);return e?[e.width,e.height]:SV}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==ke.IDLE&&this.state!==ke.ERROR)return;this.state=ke.LOADING,this.changed();const e=this;this.loader_().then(function(t){e.data_=t,e.state=ke.LOADED,e.changed()}).catch(function(t){e.error_=t,e.state=ke.ERROR,e.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(IV),this.controller_=null),super.disposeInternal()}}class i4 extends hx{constructor(e,t,i,r,s,o){super(e,t,o),this.crossOrigin_=r,this.src_=i,this.key=i,this.image_,Wi?this.image_=new OffscreenCanvas(1,1):(this.image_=new Image,r!==null&&(this.image_.crossOrigin=r)),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(e){this.image_=e,this.state=ke.LOADED,this.unlistenImage_(),this.changed()}getCrossOrigin(){return this.crossOrigin_}handleImageError_(){this.state=ke.ERROR,this.unlistenImage_(),this.image_=AV(),this.changed()}handleImageLoad_(){if(Wi)this.state=ke.LOADED;else{const e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=ke.LOADED:this.state=ke.EMPTY}this.unlistenImage_(),this.changed()}load(){this.state==ke.ERROR&&(this.state=ke.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==ke.IDLE&&(this.state=ke.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=w6(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function AV(){const n=mn(1,1);return n.fillStyle="rgba(0,0,0,0)",n.fillRect(0,0,1,1),n.canvas}let u1;const Hc=[];function kA(n,e,t,i,r){n.beginPath(),n.moveTo(0,0),n.lineTo(e,t),n.lineTo(i,r),n.closePath(),n.save(),n.clip(),n.fillRect(0,0,Math.max(e,i)+1,Math.max(t,r)),n.restore()}function c1(n,e){return Math.abs(n[e*4]-210)>2||Math.abs(n[e*4+3]-.75*255)>2}function RV(){if(u1===void 0){const n=mn(6,6,Hc);n.globalCompositeOperation="lighter",n.fillStyle="rgba(210, 0, 0, 0.75)",kA(n,4,5,4,0),kA(n,4,5,0,5);const e=n.getImageData(0,0,3,3).data;u1=c1(e,0)||c1(e,4)||c1(e,8),A_(n),Hc.push(n.canvas)}return u1}function _E(n,e,t,i){const r=vg(t,e,n);let s=K2(e,i,t);const o=e.getMetersPerUnit();o!==void 0&&(s*=o);const a=n.getMetersPerUnit();a!==void 0&&(s/=a);const u=n.getExtent();if(!u||sh(u,r)){const h=K2(n,s,r)/s;isFinite(h)&&h>0&&(s/=h)}return s}function PV(n,e,t,i){const r=Zl(t);let s=_E(n,e,r,i);return(!isFinite(s)||s<=0)&&qM(t,function(o){return s=_E(n,e,o,i),isFinite(s)&&s>0}),s}function CV(n,e,t,i,r,s,o,a,u,h,d,g,m,v){const y=mn(Math.round(t*n),Math.round(t*e),Hc);if(g||(y.imageSmoothingEnabled=!1),u.length===0)return y.canvas;y.scale(t,t);function I(D){return Math.round(D*t)/t}y.globalCompositeOperation="lighter";const w=Yi();u.forEach(function(D,B,M){u5(w,D.extent)});let R;const P=t/i,b=(g?1:1+Math.pow(2,-24))/P;(!m||u.length!==1||h!==0)&&(R=mn(Math.round(ut(w)*P),Math.round(Jn(w)*P),Hc),g||(R.imageSmoothingEnabled=!1),u.forEach(function(D,B,M){if(D.image.width>0&&D.image.height>0){if(D.clipExtent){R.save();const U=(D.clipExtent[0]-w[0])*P,N=-(D.clipExtent[3]-w[3])*P,ue=ut(D.clipExtent)*P,we=Jn(D.clipExtent)*P;R.rect(g?U:Math.round(U),g?N:Math.round(N),g?ue:Math.round(U+ue)-Math.round(U),g?we:Math.round(N+we)-Math.round(N)),R.clip()}const A=(D.extent[0]-w[0])*P,k=-(D.extent[3]-w[3])*P,F=ut(D.extent)*P,G=Jn(D.extent)*P;R.drawImage(D.image,h,h,D.image.width-2*h,D.image.height-2*h,g?A:Math.round(A),g?k:Math.round(k),g?F:Math.round(A+F)-Math.round(A),g?G:Math.round(k+G)-Math.round(k)),D.clipExtent&&R.restore()}}));const L=_u(o);return a.getTriangles().forEach(function(D,B,M){const A=D.source,k=D.target;let F=A[0][0],G=A[0][1],U=A[1][0],N=A[1][1],ue=A[2][0],we=A[2][1];const ye=I((k[0][0]-L[0])/s),de=I(-(k[0][1]-L[1])/s),J=I((k[1][0]-L[0])/s),ae=I(-(k[1][1]-L[1])/s),ie=I((k[2][0]-L[0])/s),$=I(-(k[2][1]-L[1])/s),K=F,Ae=G;F=0,G=0,U-=K,N-=Ae,ue-=K,we-=Ae;const Re=[[U,N,0,0,J-ye],[ue,we,0,0,ie-ye],[0,0,U,N,ae-de],[0,0,ue,we,$-de]],Pe=m5(Re);if(!Pe)return;if(y.save(),y.beginPath(),RV()||!g){y.moveTo(J,ae);const Fe=4,Ke=ye-J,Ye=de-ae;for(let yt=0;yt<Fe;yt++)y.lineTo(J+I((yt+1)*Ke/Fe),ae+I(yt*Ye/(Fe-1))),yt!=Fe-1&&y.lineTo(J+I((yt+1)*Ke/Fe),ae+I((yt+1)*Ye/(Fe-1)));y.lineTo(ie,$)}else y.moveTo(J,ae),y.lineTo(ye,de),y.lineTo(ie,$);y.clip(),y.transform(Pe[0],Pe[2],Pe[1],Pe[3],ye,de),y.translate(w[0]-K,w[3]-Ae);let Oe;if(R)Oe=R.canvas,y.scale(b,-b);else{const Fe=u[0],Ke=Fe.extent;Oe=Fe.image,y.scale(ut(Ke)/Oe.width,-Jn(Ke)/Oe.height)}y.drawImage(Oe,0,0),y.restore()}),R&&(A_(R),Hc.push(R.canvas)),d&&(y.save(),y.globalCompositeOperation="source-over",y.strokeStyle="black",y.lineWidth=1,a.getTriangles().forEach(function(D,B,M){const A=D.target,k=(A[0][0]-L[0])/s,F=-(A[0][1]-L[1])/s,G=(A[1][0]-L[0])/s,U=-(A[1][1]-L[1])/s,N=(A[2][0]-L[0])/s,ue=-(A[2][1]-L[1])/s;y.beginPath(),y.moveTo(G,U),y.lineTo(k,F),y.lineTo(N,ue),y.closePath(),y.stroke()}),y.restore()),y.canvas}const MV=10,LA=.25;class bV{constructor(e,t,i,r,s,o,a){this.sourceProj_=e,this.targetProj_=t;let u={};const h=a?sE(b=>Sn(a,vg(b,this.targetProj_,this.sourceProj_))):u0(this.targetProj_,this.sourceProj_);this.transformInv_=function(b){const L=b[0]+"/"+b[1];return u[L]||(u[L]=h(b)),u[L]},this.maxSourceExtent_=r,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!r&&!!this.sourceProj_.getExtent()&&ut(r)>=ut(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?ut(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?ut(this.targetProj_.getExtent()):null;const d=_u(i),g=v_(i),m=y_(i),v=__(i),y=this.transformInv_(d),I=this.transformInv_(g),w=this.transformInv_(m),R=this.transformInv_(v),P=MV+(o?Math.max(0,Math.ceil(Math.log2(J1(i)/(o*o*256*256)))):0);if(this.addQuad_(d,g,m,v,y,I,w,R,P),this.wrapsXInSource_){let b=1/0;this.triangles_.forEach(function(L,D,B){b=Math.min(b,L.source[0][0],L.source[1][0],L.source[2][0])}),this.triangles_.forEach(L=>{if(Math.max(L.source[0][0],L.source[1][0],L.source[2][0])-b>this.sourceWorldWidth_/2){const D=[[L.source[0][0],L.source[0][1]],[L.source[1][0],L.source[1][1]],[L.source[2][0],L.source[2][1]]];D[0][0]-b>this.sourceWorldWidth_/2&&(D[0][0]-=this.sourceWorldWidth_),D[1][0]-b>this.sourceWorldWidth_/2&&(D[1][0]-=this.sourceWorldWidth_),D[2][0]-b>this.sourceWorldWidth_/2&&(D[2][0]-=this.sourceWorldWidth_);const B=Math.min(D[0][0],D[1][0],D[2][0]);Math.max(D[0][0],D[1][0],D[2][0])-B<this.sourceWorldWidth_/2&&(L.source=D)}})}u={}}addTriangle_(e,t,i,r,s,o){this.triangles_.push({source:[r,s,o],target:[e,t,i]})}addQuad_(e,t,i,r,s,o,a,u,h){const d=N2([s,o,a,u]),g=this.sourceWorldWidth_?ut(d)/this.sourceWorldWidth_:null,m=this.sourceWorldWidth_,v=this.sourceProj_.canWrapX()&&g>.5&&g<1;let y=!1;if(h>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const w=N2([e,t,i,r]);y=ut(w)/this.targetWorldWidth_>LA||y}!v&&this.sourceProj_.isGlobal()&&g&&(y=g>LA||y)}if(!y&&this.maxSourceExtent_&&isFinite(d[0])&&isFinite(d[1])&&isFinite(d[2])&&isFinite(d[3])&&!Ri(d,this.maxSourceExtent_))return;let I=0;if(!y&&(!isFinite(s[0])||!isFinite(s[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(u[0])||!isFinite(u[1]))){if(h>0)y=!0;else if(I=(!isFinite(s[0])||!isFinite(s[1])?8:0)+(!isFinite(o[0])||!isFinite(o[1])?4:0)+(!isFinite(a[0])||!isFinite(a[1])?2:0)+(!isFinite(u[0])||!isFinite(u[1])?1:0),I!=1&&I!=2&&I!=4&&I!=8)return}if(h>0){if(!y){const w=[(e[0]+i[0])/2,(e[1]+i[1])/2],R=this.transformInv_(w);let P;v?P=(Ta(s[0],m)+Ta(a[0],m))/2-Ta(R[0],m):P=(s[0]+a[0])/2-R[0];const b=(s[1]+a[1])/2-R[1];y=P*P+b*b>this.errorThresholdSquared_}if(y){if(Math.abs(e[0]-i[0])<=Math.abs(e[1]-i[1])){const w=[(t[0]+i[0])/2,(t[1]+i[1])/2],R=this.transformInv_(w),P=[(r[0]+e[0])/2,(r[1]+e[1])/2],b=this.transformInv_(P);this.addQuad_(e,t,w,P,s,o,R,b,h-1),this.addQuad_(P,w,i,r,b,R,a,u,h-1)}else{const w=[(e[0]+t[0])/2,(e[1]+t[1])/2],R=this.transformInv_(w),P=[(i[0]+r[0])/2,(i[1]+r[1])/2],b=this.transformInv_(P);this.addQuad_(e,w,P,r,s,R,b,u,h-1),this.addQuad_(w,t,i,P,R,o,a,b,h-1)}return}}if(v){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(I&11)==0&&this.addTriangle_(e,i,r,s,a,u),(I&14)==0&&this.addTriangle_(e,i,t,s,a,o),I&&((I&13)==0&&this.addTriangle_(t,r,e,o,u,s),(I&7)==0&&this.addTriangle_(t,r,i,o,u,a))}calculateSourceExtent(){const e=Yi();return this.triangles_.forEach(function(t,i,r){const s=t.source;af(e,s[0]),af(e,s[1]),af(e,s[2])}),e}getTriangles(){return this.triangles_}}const kV=.5;class r4 extends hx{constructor(e,t,i,r,s,o,a,u,h,d,g,m){super(s,ke.IDLE,m),this.renderEdges_=g!==void 0?g:!1,this.pixelRatio_=a,this.gutter_=u,this.canvas_=null,this.sourceTileGrid_=t,this.targetTileGrid_=r,this.wrappedTileCoord_=o||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=e.canWrapX()?e.getExtent():void 0;const v=r.getTileCoordExtent(this.wrappedTileCoord_),y=this.targetTileGrid_.getExtent();let I=this.sourceTileGrid_.getExtent();const w=y?$l(v,y):v;if(J1(w)===0){this.state=ke.EMPTY;return}const R=e.getExtent();R&&(I?I=$l(I,R):I=R);const P=r.getResolution(this.wrappedTileCoord_[0]),b=PV(e,i,w,P);if(!isFinite(b)||b<=0){this.state=ke.EMPTY;return}const L=d!==void 0?d:kV;if(this.triangulation_=new bV(e,i,w,I,b*L,P),this.triangulation_.getTriangles().length===0){this.state=ke.EMPTY;return}this.sourceZ_=t.getZForResolution(b);let D=this.triangulation_.calculateSourceExtent();if(I&&(e.canWrapX()?(D[1]=kt(D[1],I[1],I[3]),D[3]=kt(D[3],I[1],I[3])):D=$l(D,I)),!J1(D))this.state=ke.EMPTY;else{let B=0,M=0;e.canWrapX()&&(B=ut(R),M=Math.floor((D[0]-R[0])/B)),YM(D.slice(),e,!0).forEach(k=>{const F=t.getTileRangeForExtentAndZ(k,this.sourceZ_);for(let G=F.minX;G<=F.maxX;G++)for(let U=F.minY;U<=F.maxY;U++){const N=h(this.sourceZ_,G,U,a);if(N){const ue=M*B;this.sourceTiles_.push({tile:N,offset:ue})}}++M}),this.sourceTiles_.length===0&&(this.state=ke.EMPTY)}}getImage(){return this.canvas_}reproject_(){const e=[];if(this.sourceTiles_.forEach(t=>{const i=t.tile;if(i&&i.getState()==ke.LOADED){const r=this.sourceTileGrid_.getTileCoordExtent(i.tileCoord);r[0]+=t.offset,r[2]+=t.offset;const s=this.clipExtent_?.slice();s&&(s[0]+=t.offset,s[2]+=t.offset),e.push({extent:r,clipExtent:s,image:i.getImage()})}}),this.sourceTiles_.length=0,e.length===0)this.state=ke.ERROR;else{const t=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(t),r=typeof i=="number"?i:i[0],s=typeof i=="number"?i:i[1],o=this.targetTileGrid_.getResolution(t),a=this.sourceTileGrid_.getResolution(this.sourceZ_),u=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=CV(r,s,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),o,u,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=ke.LOADED}this.changed()}load(){if(this.state==ke.IDLE){this.state=ke.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:t})=>{const i=t.getState();if(i==ke.IDLE||i==ke.LOADING){e++;const r=at(t,He.CHANGE,s=>{const o=t.getState();(o==ke.LOADED||o==ke.ERROR||o==ke.EMPTY)&&(Ft(r),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(r)}}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:t},i,r){t.getState()==ke.IDLE&&t.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(Ft),this.sourcesListenerKeys_=null}release(){this.canvas_&&(A_(this.canvas_.getContext("2d")),Hc.push(this.canvas_),this.canvas_=null),super.release()}}class dx{constructor(e,t,i,r){this.minX=e,this.maxX=t,this.minY=i,this.maxY=r}contains(e){return this.containsXY(e[1],e[2])}containsTileRange(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}containsXY(e,t){return this.minX<=e&&e<=this.maxX&&this.minY<=t&&t<=this.maxY}equals(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}extend(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}}function dc(n,e,t,i,r){return r!==void 0?(r.minX=n,r.maxX=e,r.minY=t,r.maxY=i,r):new dx(n,e,t,i)}class DA{constructor(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const e=this.pop();e instanceof f_&&e.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(e){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let t=this.oldest_;for(;t;)e(t.value_,t.key_,this),t=t.newer}get(e,t){const i=this.entries_[e];return _t(i!==void 0,"Tried to get a value for a key that does not exist in the cache"),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_}remove(e){const t=this.entries_[e];return _t(t!==void 0,"Tried to get a value for a key that does not exist in the cache"),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_}getCount(){return this.count_}getKeys(){const e=new Array(this.count_);let t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.key_;return e}getValues(){const e=new Array(this.count_);let t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.value_;return e}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){return this.entries_[e]?.value_}pop(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,t){this.get(e),this.entries_[e].value_=t}set(e,t){_t(!(e in this.entries_),"Tried to set a value for a key that is used already");const i={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[e]=i,++this.count_}setSize(e){this.highWaterMark=e}}function E0(n,e,t,i){return i!==void 0?(i[0]=n,i[1]=e,i[2]=t,i):[n,e,t]}function LV(n,e,t){return n+"/"+e+"/"+t}function Dp(n,e,t,i,r){return`${lt(n)},${e},${LV(t,i,r)}`}function s4(n){return DV(n[0],n[1],n[2])}function DV(n,e,t){return(e<<n)+t}function NV(n,e){const t=n[0],i=n[1],r=n[2];if(e.getMinZoom()>t||t>e.getMaxZoom())return!1;const s=e.getFullTileRange(t);return s?s.containsXY(i,r):!0}function h1(n,e,t){if(!(t in n))return n[t]=new Set([e]),!0;const i=n[t],r=i.has(e);return r||i.add(e),!r}function OV(n,e,t){const i=n[t];return i?i.delete(e):!1}function NA(n,e){const t=n.layerStatesArray[n.layerIndex];t.extent&&(e=$l(e,_a(t.extent,n.viewState.projection)));const i=t.layer.getRenderSource();if(!i.getWrapX()){const r=i.getTileGridForProjection(n.viewState.projection).getExtent();r&&(e=$l(e,r))}return e}class VV extends $b{constructor(e,t){super(e),t=t||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=Yi(),this.tempTileRange_=new dx(0,0,0,0),this.tempTileCoord_=E0(0,0,0);const i=t.cacheSize!==void 0?t.cacheSize:512;this.tileCache_=new DA(i),this.sourceTileCache_=null,this.maxStaleKeys=i*.5}getTileCache(){return this.tileCache_}getSourceTileCache(){return this.sourceTileCache_||(this.sourceTileCache_=new DA(512)),this.sourceTileCache_}getOrCreateTile(e,t,i,r){const s=this.tileCache_,a=this.getLayer().getSource(),u=Dp(a,a.getKey(),e,t,i);let h;if(s.containsKey(u))h=s.get(u);else{const d=r.viewState.projection,g=a.getProjection();if(h=a.getTile(e,t,i,r.pixelRatio,d,!g||Lp(g,d)?void 0:this.getSourceTileCache()),!h)return null;s.set(u,h)}return h}getTile(e,t,i,r){const s=this.getOrCreateTile(e,t,i,r);return s||null}getData(e){const t=this.frameState;if(!t)return null;const i=this.getLayer(),r=Sn(t.pixelToCoordinateTransform,e.slice()),s=i.getExtent();if(s&&!sh(s,r))return null;const o=t.viewState,a=i.getRenderSource(),u=a.getTileGridForProjection(o.projection),h=a.getTilePixelRatio(t.pixelRatio);for(let d=u.getZForResolution(o.resolution);d>=u.getMinZoom();--d){const g=u.getTileCoordForCoordAndZ(r,d),m=this.getTile(d,g[1],g[2],t);if(!m||m.getState()!==ke.LOADED)continue;const v=u.getOrigin(d),y=Mi(u.getTileSize(d)),I=u.getResolution(d);let w;if(m instanceof i4||m instanceof r4)w=m.getImage();else if(m instanceof bA){if(w=pE(m.getData()),!w)continue}else continue;const R=Math.floor(h*((r[0]-v[0])/I-g[1]*y[0])),P=Math.floor(h*((v[1]-r[1])/I-g[2]*y[1])),b=Math.round(h*a.getGutterForProjection(o.projection));return this.getImageData(w,R+b,P+b)}return null}prepareFrame(e){this.renderedProjection?e.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=e.viewState.projection):this.renderedProjection=e.viewState.projection;const t=this.getLayer().getSource();if(!t)return!1;const i=t.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==i&&(this.renderedSourceRevision_=i,this.renderedSourceKey_===t.getKey()&&(this.tileCache_.clear(),this.sourceTileCache_?.clear())):this.renderedSourceRevision_=i,!0}enqueueTilesForNextExtent(){return!0}enqueueTiles(e,t,i,r,s){const o=e.viewState,a=this.getLayer(),u=a.getRenderSource(),h=u.getTileGridForProjection(o.projection),d=lt(u);d in e.wantedTiles||(e.wantedTiles[d]={});const g=e.wantedTiles[d],m=a.getMapInternal(),v=Math.max(i-s,h.getMinZoom(),h.getZForResolution(Math.min(a.getMaxResolution(),m?m.getView().getResolutionForZoom(Math.max(a.getMinZoom(),0)):h.getResolution(0)),u.zDirection)),y=o.rotation,I=y?HM(o.center,o.resolution,y,e.size):void 0;for(let w=i;w>=v;--w){const R=h.getTileRangeForExtentAndZ(t,w,this.tempTileRange_),P=h.getResolution(w);for(let b=R.minX;b<=R.maxX;++b)for(let L=R.minY;L<=R.maxY;++L){if(y&&!h.tileCoordIntersectsViewport([w,b,L],I))continue;const D=this.getTile(w,b,L,e);if(!D||!h1(r,D,w))continue;const M=D.getKey();if(g[M]=!0,D.getState()===ke.IDLE&&!e.tileQueue.isKeyQueued(M)){const A=E0(w,b,L,this.tempTileCoord_);e.tileQueue.enqueue([D,d,h.getTileCoordCenter(A),P])}}}}findStaleTile_(e,t){const i=this.tileCache_,r=e[0],s=e[1],o=e[2],a=this.getStaleKeys();for(let u=0;u<a.length;++u){const h=Dp(this.getLayer().getSource(),a[u],r,s,o);if(i.containsKey(h)){const d=i.peek(h);if(d.getState()===ke.LOADED)return d.endTransition(lt(this)),h1(t,d,r),!0}}return!1}findAltTiles_(e,t,i,r){const s=e.getTileRangeForTileCoordAndZ(t,i,this.tempTileRange_);if(!s)return!1;let o=!0;const a=this.tileCache_,u=this.getLayer().getRenderSource(),h=u.getKey();for(let d=s.minX;d<=s.maxX;++d)for(let g=s.minY;g<=s.maxY;++g){const m=Dp(u,h,i,d,g);let v=!1;if(a.containsKey(m)){const y=a.peek(m);y.getState()===ke.LOADED&&(h1(r,y,i),v=!0)}v||(o=!1)}return o}renderFrame(e,t){this.renderComplete=!0;const i=e.layerStatesArray[e.layerIndex],r=e.viewState,s=r.projection,o=r.resolution,a=r.center,u=e.pixelRatio,h=this.getLayer(),d=h.getSource(),g=d.getTileGridForProjection(s),m=g.getZForResolution(o,d.zDirection),v=g.getResolution(m),y=d.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==y&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=y):this.renderedSourceKey_=y;let I=e.extent;const w=d.getTilePixelRatio(u);this.prepareContainer(e,t);const R=this.context.canvas.width,P=this.context.canvas.height,b=i.extent&&_a(i.extent);b&&(I=$l(I,_a(i.extent)));const L=v*R/2/w,D=v*P/2/w,B=[a[0]-L,a[1]-D,a[0]+L,a[1]+D],M={};this.renderedTiles.length=0;const A=h.getPreload();if(e.nextExtent&&this.enqueueTilesForNextExtent()){const J=g.getZForResolution(r.nextResolution,d.zDirection),ae=NA(e,e.nextExtent);this.enqueueTiles(e,ae,J,M,A)}const k=NA(e,I);if(this.enqueueTiles(e,k,m,M,0),A>0&&setTimeout(()=>{this.enqueueTiles(e,k,m-1,M,A-1)},0),!(m in M))return this.container;const F=lt(this),G=e.time;for(const J of M[m]){const ae=J.getState();if(ae===ke.EMPTY)continue;const ie=J.tileCoord;if(ae===ke.LOADED&&J.getAlpha(F,G)===1){J.endTransition(F);continue}if(ae!==ke.ERROR&&(this.renderComplete=!1),this.findStaleTile_(ie,M)){OV(M,J,m),e.animate=!0;continue}if(this.findAltTiles_(g,ie,m+1,M))continue;const Ae=g.getMinZoom();for(let Re=m-1;Re>=Ae&&!this.findAltTiles_(g,ie,Re,M);--Re);}const U=v/o*u/w,N=this.getRenderContext(e);_o(this.tempTransform,R/2,P/2,U,U,0,-R/2,-P/2),i.extent&&this.clipUnrotated(N,e,b),d.getInterpolate()||(N.imageSmoothingEnabled=!1),this.preRender(N,e);const ue=Object.keys(M).map(Number);ue.sort(co);let we;const ye=[],de=[];for(let J=ue.length-1;J>=0;--J){const ae=ue[J],ie=d.getTilePixelSize(ae,u,s),K=g.getResolution(ae)/v,Ae=ie[0]*K*U,Re=ie[1]*K*U,Pe=g.getTileCoordForCoordAndZ(_u(B),ae),Oe=g.getTileCoordExtent(Pe),Fe=Sn(this.tempTransform,[w*(Oe[0]-B[0])/v,w*(B[3]-Oe[3])/v]),Ke=w*d.getGutterForProjection(s);for(const Ye of M[ae]){if(Ye.getState()!==ke.LOADED)continue;const yt=Ye.tileCoord,Rr=Pe[1]-yt[1],Fs=Math.round(Fe[0]-(Rr-1)*Ae),gi=Pe[2]-yt[2],mi=Math.round(Fe[1]-(gi-1)*Re),An=Math.round(Fe[0]-Rr*Ae),Rn=Math.round(Fe[1]-gi*Re),pi=Fs-An,er=mi-Rn,Rt=ue.length===1;let vt=!1;we=[An,Rn,An+pi,Rn,An+pi,Rn+er,An,Rn+er];for(let yn=0,tr=ye.length;yn<tr;++yn)if(!Rt&&ae<de[yn]){const Dt=ye[yn];Ri([An,Rn,An+pi,Rn+er],[Dt[0],Dt[3],Dt[4],Dt[7]])&&(vt||(N.save(),vt=!0),N.beginPath(),N.moveTo(we[0],we[1]),N.lineTo(we[2],we[3]),N.lineTo(we[4],we[5]),N.lineTo(we[6],we[7]),N.moveTo(Dt[6],Dt[7]),N.lineTo(Dt[4],Dt[5]),N.lineTo(Dt[2],Dt[3]),N.lineTo(Dt[0],Dt[1]),N.clip())}ye.push(we),de.push(ae),this.drawTile(Ye,e,An,Rn,pi,er,Ke,Rt),vt&&N.restore(),this.renderedTiles.unshift(Ye),this.updateUsedTiles(e.usedTiles,d,Ye)}}if(this.renderedResolution=v,this.extentChanged=!this.renderedExtent_||!bf(this.renderedExtent_,B),this.renderedExtent_=B,this.renderedPixelRatio=u,this.postRender(this.context,e),i.extent&&N.restore(),N.imageSmoothingEnabled=!0,this.renderComplete){const J=(ae,ie)=>{const $=lt(d),K=ie.wantedTiles[$],Ae=K?Object.keys(K).length:0;this.updateCacheSize(Ae),this.tileCache_.expireCache(),this.sourceTileCache_?.expireCache()};e.postRenderFunctions.push(J)}return this.container}updateCacheSize(e){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,e*2)}drawTile(e,t,i,r,s,o,a,u){let h;if(e instanceof bA){if(h=pE(e.getData()),!h)throw new Error("Rendering array data is not yet supported")}else h=this.getTileImage(e);if(!h)return;const d=this.getRenderContext(t),g=lt(this),m=t.layerStatesArray[t.layerIndex],v=m.opacity*(u?e.getAlpha(g,t.time):1),y=v!==d.globalAlpha;y&&(d.save(),d.globalAlpha=v),d.drawImage(h,a,a,h.width-2*a,h.height-2*a,i,r,s,o),y&&d.restore(),v!==m.opacity?t.animate=!0:u&&e.endTransition(g)}getImage(){const e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}updateUsedTiles(e,t,i){const r=lt(t);r in e||(e[r]={}),e[r][i.getKey()]=!0}}const gp={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class FV extends k_{constructor(e){e=e||{};const t=Object.assign({},e),i=e.cacheSize;delete e.cacheSize,delete t.preload,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un,this.cacheSize_=i,this.setPreload(e.preload!==void 0?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(gp.PRELOAD)}setPreload(e){this.set(gp.PRELOAD,e)}getUseInterimTilesOnError(){return this.get(gp.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(gp.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}}class Ic extends FV{constructor(e){super(e)}createRenderer(){return new VV(this,{cacheSize:this.getCacheSize()})}}const fc=[0,0,0],ia=5;class o4{constructor(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,_t(s5(this.resolutions_,(r,s)=>s-r),"`resolutions` must be sorted in descending order");let t;if(!e.origins){for(let r=0,s=this.resolutions_.length-1;r<s;++r)if(!t)t=this.resolutions_[r]/this.resolutions_[r+1];else if(this.resolutions_[r]/this.resolutions_[r+1]!==t){t=void 0;break}}this.zoomFactor_=t,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,_t(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const i=e.extent;i!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=_u(i)),_t(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,_t(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:ux,_t(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=i!==void 0?i:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map((r,s)=>{const o=new dx(Math.min(0,r[0]),Math.max(r[0]-1,-1),Math.min(0,r[1]),Math.max(r[1]-1,-1));if(i){const a=this.getTileRangeForExtentAndZ(i,s);o.minX=Math.max(a.minX,o.minX),o.maxX=Math.min(a.maxX,o.maxX),o.minY=Math.max(a.minY,o.minY),o.maxY=Math.min(a.maxY,o.maxY)}return o}):i&&this.calculateTileRanges_(i)}forEachTileCoord(e,t,i){const r=this.getTileRangeForExtentAndZ(e,t);for(let s=r.minX,o=r.maxX;s<=o;++s)for(let a=r.minY,u=r.maxY;a<=u;++a)i([t,s,a])}forEachTileCoordParentTileRange(e,t,i,r){let s,o,a,u=null,h=e[0]-1;for(this.zoomFactor_===2?(o=e[1],a=e[2]):u=this.getTileCoordExtent(e,r);h>=this.minZoom;){if(o!==void 0&&a!==void 0?(o=Math.floor(o/2),a=Math.floor(a/2),s=dc(o,o,a,a,i)):s=this.getTileRangeForExtentAndZ(u,h,i),t(h,s))return!0;--h}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,t,i){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){const s=e[1]*2,o=e[2]*2;return dc(s,s+1,o,o+1,t)}const r=this.getTileCoordExtent(e,i||this.tmpExtent_);return this.getTileRangeForExtentAndZ(r,e[0]+1,t)}return null}getTileRangeForTileCoordAndZ(e,t,i){if(t>this.maxZoom||t<this.minZoom)return null;const r=e[0],s=e[1],o=e[2];if(t===r)return dc(s,o,s,o,i);if(this.zoomFactor_){const u=Math.pow(this.zoomFactor_,t-r),h=Math.floor(s*u),d=Math.floor(o*u);if(t<r)return dc(h,h,d,d,i);const g=Math.floor(u*(s+1))-1,m=Math.floor(u*(o+1))-1;return dc(h,g,d,m,i)}const a=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(a,t,i)}getTileRangeForExtentAndZ(e,t,i){this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,fc);const r=fc[1],s=fc[2];this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,fc);const o=fc[1],a=fc[2];return dc(r,o,s,a,i)}getTileCoordCenter(e){const t=this.getOrigin(e[0]),i=this.getResolution(e[0]),r=Mi(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*r[0]*i,t[1]-(e[2]+.5)*r[1]*i]}getTileCoordExtent(e,t){const i=this.getOrigin(e[0]),r=this.getResolution(e[0]),s=Mi(this.getTileSize(e[0]),this.tmpSize_),o=i[0]+e[1]*s[0]*r,a=i[1]-(e[2]+1)*s[1]*r,u=o+s[0]*r,h=a+s[1]*r;return ba(o,a,u,h,t)}getTileCoordForCoordAndResolution(e,t,i){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,i)}getTileCoordForXYAndResolution_(e,t,i,r,s){const o=this.getZForResolution(i),a=i/this.getResolution(o),u=this.getOrigin(o),h=Mi(this.getTileSize(o),this.tmpSize_);let d=a*(e-u[0])/i/h[0],g=a*(u[1]-t)/i/h[1];return r?(d=sp(d,ia)-1,g=sp(g,ia)-1):(d=rp(d,ia),g=rp(g,ia)),E0(o,d,g,s)}getTileCoordForXYAndZ_(e,t,i,r,s){const o=this.getOrigin(i),a=this.getResolution(i),u=Mi(this.getTileSize(i),this.tmpSize_);let h=(e-o[0])/a/u[0],d=(o[1]-t)/a/u[1];return r?(h=sp(h,ia)-1,d=sp(d,ia)-1):(h=rp(h,ia),d=rp(d,ia)),E0(i,h,d,s)}getTileCoordForCoordAndZ(e,t,i){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,i)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,t){const i=Dw(this.resolutions_,e,t||0);return kt(i,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,t){return gb(t,0,t.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){const t=this.resolutions_.length,i=new Array(t);for(let r=this.minZoom;r<t;++r)i[r]=this.getTileRangeForExtentAndZ(e,r);this.fullTileRanges_=i}}function a4(n){let e=n.getDefaultTileGrid();return e||(e=BV(n),n.setDefaultTileGrid(e)),e}function GV(n,e,t){const i=e[0],r=n.getTileCoordCenter(e),s=fx(t);if(!sh(s,r)){const o=ut(s),a=Math.ceil((s[0]-r[0])/o);return r[0]+=o*a,n.getTileCoordForCoordAndZ(r,i)}return e}function jV(n,e,t,i){i=i!==void 0?i:"top-left";const r=l4(n,e,t);return new o4({extent:n,origin:h5(n,i),resolutions:r,tileSize:t})}function UV(n){const e=n||{},t=e.extent||jn("EPSG:3857").getExtent(),i={extent:t,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:l4(t,e.maxZoom,e.tileSize,e.maxResolution)};return new o4(i)}function l4(n,e,t,i){e=e!==void 0?e:yV,t=Mi(t!==void 0?t:ux);const r=Jn(n),s=ut(n);i=i>0?i:Math.max(s/t[0],r/t[1]);const o=e+1,a=new Array(o);for(let u=0;u<o;++u)a[u]=i/Math.pow(2,u);return a}function BV(n,e,t,i){const r=fx(n);return jV(r,e,t,i)}function fx(n){n=jn(n);let e=n.getExtent();if(!e){const t=180*Fw.degrees/n.getMetersPerUnit();e=ba(-t,-t,t,t)}return e}function u4(n,e){const t=[];Object.keys(e).forEach(function(r){e[r]!==null&&e[r]!==void 0&&t.push(r+"="+encodeURIComponent(e[r]))});const i=t.join("&");return n=n.replace(/[?&]$/,""),n+=n.includes("?")?"&":"?",n+i}const zV=/\{z\}/g,$V=/\{x\}/g,WV=/\{y\}/g,KV=/\{-y\}/g;function qV(n,e,t,i,r){return n.replace(zV,e.toString()).replace($V,t.toString()).replace(WV,i.toString()).replace(KV,function(){if(r===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(r-i).toString()})}function HV(n){const e=[];let t=/\{([a-z])-([a-z])\}/.exec(n);if(t){const i=t[1].charCodeAt(0),r=t[2].charCodeAt(0);let s;for(s=i;s<=r;++s)e.push(n.replace(t[0],String.fromCharCode(s)));return e}if(t=/\{(\d+)-(\d+)\}/.exec(n),t){const i=parseInt(t[2],10);for(let r=parseInt(t[1],10);r<=i;r++)e.push(n.replace(t[0],r.toString()));return e}return e.push(n),e}function XV(n,e){return(function(t,i,r){if(!t)return;let s;const o=t[0];if(e){const a=e.getFullTileRange(o);a&&(s=a.getHeight()-1)}return qV(n,o,t[1],t[2],s)})}function YV(n,e){const t=n.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=XV(n[r],e);return ZV(i)}function ZV(n){return n.length===1?n[0]:(function(e,t,i){if(!e)return;const r=s4(e),s=Ta(r,n.length);return n[s](e,t,i)})}class QV extends Vb{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=e.tilePixelRatio!==void 0?e.tilePixelRatio:1,this.tileGrid=e.tileGrid!==void 0?e.tileGrid:null;const t=[256,256];this.tileGrid&&Mi(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),t),this.tmpSize=[0,0],this.key_=e.key||lt(this),this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}getGutterForProjection(e){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getResolutions(e){const t=e?this.getTileGridForProjection(e):this.tileGrid;return t?t.getResolutions():null}getTile(e,t,i,r,s,o){return ot()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:a4(e)}getTilePixelRatio(e){return this.tilePixelRatio_}getTilePixelSize(e,t,i){const r=this.getTileGridForProjection(i),s=this.getTilePixelRatio(t),o=Mi(r.getTileSize(e),this.tmpSize);return s==1?o:r8(o,s,this.tmpSize)}getTileCoordForTileUrlFunction(e,t){const i=t!==void 0?t:this.getProjection(),r=t!==void 0?this.getTileGridForProjection(i):this.tileGrid||this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(e=GV(r,e,i)),NV(e,r)?e:null}clear(){}refresh(){this.clear(),super.refresh()}}class JV extends Io{constructor(e,t){super(e),this.tile=t}}const d1={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class gx extends QV{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===gx.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){const t=e.target,i=lt(t),r=t.getState();let s;r==ke.LOADING?(this.tileLoadingKeys_[i]=!0,s=d1.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],s=r==ke.ERROR?d1.TILELOADERROR:r==ke.LOADED?d1.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new JV(s,t))}setTileLoadFunction(e){this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,t){this.tileUrlFunction=e,typeof t<"u"?this.setKey(t):this.changed()}setUrl(e){const t=HV(e);this.urls=t,this.setUrls(t)}setUrls(e){this.urls=e;const t=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(YV(e,this.tileGrid),t):this.setKey(t)}tileUrlFunction(e,t,i){}}class c4 extends gx{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:h4,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate!==void 0?e.interpolate:!0,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,this.tileClass=e.tileClass!==void 0?e.tileClass:i4,this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(e){return this.getProjection()&&e&&!Lp(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getTileGridForProjection(e){const t=this.getProjection();if(this.tileGrid&&(!t||Lp(t,e)))return this.tileGrid;const i=lt(e);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=a4(e)),this.tileGridForProjection[i]}createTile_(e,t,i,r,s,o){const a=[e,t,i],u=this.getTileCoordForTileUrlFunction(a,s),h=u?this.tileUrlFunction(u,r,s):void 0,d=new this.tileClass(a,h!==void 0?ke.IDLE:ke.EMPTY,h!==void 0?h:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return d.key=o,d.addEventListener(He.CHANGE,this.handleTileChange.bind(this)),d}getTile(e,t,i,r,s,o){const a=this.getProjection();if(!a||!s||Lp(a,s))return this.getTileInternal(e,t,i,r,a||s);const u=[e,t,i],h=this.getKey(),d=this.getTileGridForProjection(a),g=this.getTileGridForProjection(s),m=this.getTileCoordForTileUrlFunction(u,s),v=new r4(a,d,s,g,u,m,this.getTilePixelRatio(r),this.getGutter(),(y,I,w,R)=>this.getTileInternal(y,I,w,R,a,o),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return v.key=h,v}getTileInternal(e,t,i,r,s,o){const a=this.getKey(),u=Dp(this,a,e,t,i);if(o&&o.containsKey(u))return o.get(u);const h=this.createTile_(e,t,i,r,s,a);return o?.set(u,h),h}setRenderReprojectionEdges(e){this.renderReprojectionEdges_!=e&&(this.renderReprojectionEdges_=e,this.changed())}setTileGridForProjection(e,t){const i=jn(e);if(i){const r=lt(i);r in this.tileGridForProjection||(this.tileGridForProjection[r]=t)}}}function h4(n,e){if(Wi){const t=n.getCrossOrigin();let i="same-origin",r="same-origin";t==="anonymous"||t===""?(i="cors",r="omit"):t==="use-credentials"&&(i="cors",r="include"),fetch(e,{mode:i,credentials:r}).then(s=>{if(!s.ok)throw new Error(`HTTP ${s.status}`);return s.blob()}).then(s=>createImageBitmap(s)).then(s=>{const o=n.getImage();o.width=s.width,o.height=s.height,o.getContext("2d").drawImage(s,0,0),s.close?.(),o.dispatchEvent(new Event("load"))}).catch(()=>{n.getImage().dispatchEvent(new Event("error"))});return}n.getImage().src=e}class Hd extends c4{constructor(e){e=e||{};const t=e.projection!==void 0?e.projection:"EPSG:3857",i=e.tileGrid!==void 0?e.tileGrid:UV({extent:fx(t),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:t,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:i,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0}getGutter(){return this.gutter_}}const eF="modulepreload",tF=function(n){return"/detectorapp-nl/"+n},OA={},Ue=function(e,t,i){let r=Promise.resolve();if(t&&t.length>0){let u=function(h){return Promise.all(h.map(d=>Promise.resolve(d).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=o?.nonce||o?.getAttribute("nonce");r=u(t.map(h=>{if(h=tF(h),h in OA)return;OA[h]=!0;const d=h.endsWith(".css"),g=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${g}`))return;const m=document.createElement("link");if(m.rel=d?"stylesheet":eF,d||(m.as="script"),m.crossOrigin="",m.href=h,a&&m.setAttribute("nonce",a),document.head.appendChild(m),d)return new Promise((v,y)=>{m.addEventListener("load",v),m.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${h}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return r.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})},VA=4,yE="1.3.0";function nF(n,e,t,i,r){r.WIDTH=t[0],r.HEIGHT=t[1];const s=i.getAxisOrientation(),o=ZM(r.VERSION,"1.3")>=0;r[o?"CRS":"SRS"]=i.getCode();const a=o&&s.startsWith("ne")?[e[1],e[0],e[3],e[2]]:e;return r.BBOX=a.join(","),u4(n,r)}function iF(n,e,t,i,r,s,o){s=Object.assign({REQUEST:"GetMap"},s);const a=e/t,u=[V2(ut(n)/a,VA),V2(Jn(n)/a,VA)];if(t!=1)switch(o){case"geoserver":const d=90*t+.5|0;"FORMAT_OPTIONS"in s?s.FORMAT_OPTIONS+=";dpi:"+d:s.FORMAT_OPTIONS="dpi:"+d;break;case"mapserver":s.MAP_RESOLUTION=90*t;break;case"carmentaserver":case"qgis":s.DPI=90*t;break;default:throw new Error("Unknown `serverType` configured")}return nF(r,n,u,i,s)}function FA(n,e){return Object.assign({REQUEST:e,SERVICE:"WMS",VERSION:yE,FORMAT:"image/png",STYLES:"",TRANSPARENT:"TRUE"},n)}const rF='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.';class sF extends Hd{constructor(e){e=e||{};let t;e.attributions!==void 0?t=e.attributions:t=[rF];const i=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",r=e.url!==void 0?e.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:t,attributionsCollapsible:!1,cacheSize:e.cacheSize,crossOrigin:i,interpolate:e.interpolate,maxZoom:e.maxZoom!==void 0?e.maxZoom:19,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:(s,o)=>{const a=s.getImage();!Wi&&a instanceof HTMLImageElement&&(a.referrerPolicy="origin-when-cross-origin"),(e.tileLoadFunction||h4)(s,o)},transition:e.transition,url:r,wrapX:e.wrapX,zDirection:e.zDirection})}}const w0=1/0;class oF{constructor(e,t){this.priorityFunction_=e,this.keyFunction_=t,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,gg(this.queuedElements_)}dequeue(){const e=this.elements_,t=this.priorities_,i=e[0];e.length==1?(e.length=0,t.length=0):(e[0]=e.pop(),t[0]=t.pop(),this.siftUp_(0));const r=this.keyFunction_(i);return delete this.queuedElements_[r],i}enqueue(e){_t(!(this.keyFunction_(e)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const t=this.priorityFunction_(e);return t!=w0?(this.elements_.push(e),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(e){return e*2+1}getRightChildIndex_(e){return e*2+2}getParentIndex_(e){return e-1>>1}heapify_(){let e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)}isEmpty(){return this.elements_.length===0}isKeyQueued(e){return e in this.queuedElements_}isQueued(e){return this.isKeyQueued(this.keyFunction_(e))}siftUp_(e){const t=this.elements_,i=this.priorities_,r=t.length,s=t[e],o=i[e],a=e;for(;e<r>>1;){const u=this.getLeftChildIndex_(e),h=this.getRightChildIndex_(e),d=h<r&&i[h]<i[u]?h:u;t[e]=t[d],i[e]=i[d],e=d}t[e]=s,i[e]=o,this.siftDown_(a,e)}siftDown_(e,t){const i=this.elements_,r=this.priorities_,s=i[t],o=r[t];for(;t>e;){const a=this.getParentIndex_(t);if(r[a]>o)i[t]=i[a],r[t]=r[a],t=a;else break}i[t]=s,r[t]=o}reprioritize(){const e=this.priorityFunction_,t=this.elements_,i=this.priorities_;let r=0;const s=t.length;let o,a,u;for(a=0;a<s;++a)o=t[a],u=e(o),u==w0?delete this.queuedElements_[this.keyFunction_(o)]:(i[r]=u,t[r++]=o);t.length=r,i.length=r,this.heapify_()}}class aF extends oF{constructor(e,t){super(i=>e.apply(null,i),i=>i[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=t,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(e){const t=super.enqueue(e);return t&&e[0].addEventListener(He.CHANGE,this.boundHandleTileChange_),t}getTilesLoading(){return this.tilesLoading_}handleTileChange(e){const t=e.target,i=t.getState();if(i===ke.LOADED||i===ke.ERROR||i===ke.EMPTY){i!==ke.ERROR&&t.removeEventListener(He.CHANGE,this.boundHandleTileChange_);const r=t.getKey();r in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[r],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(e,t){let i=0;for(;this.tilesLoading_<e&&i<t&&this.getCount()>0;){const r=this.dequeue()[0],s=r.getKey();r.getState()===ke.IDLE&&!(s in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++i,r.load())}}}function lF(n,e,t,i,r){if(!n||!(t in n.wantedTiles)||!n.wantedTiles[t][e.getKey()])return w0;const s=n.viewState.center,o=i[0]-s[0],a=i[1]-s[1];return 65536*Math.log(r)+Math.sqrt(o*o+a*a)/r}class uF extends c4{constructor(e){e=e||{};const t=Object.assign({},e.params);super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:e.tileClass,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0,this.params_=t,this.v13_=!0,this.serverType_=e.serverType,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.tmpExtent_=Yi(),this.updateV13_(),this.setKey(this.getKeyForParams_())}getFeatureInfoUrl(e,t,i,r){const s=jn(i),o=this.getProjection()||s;let a=this.getTileGrid();a||(a=this.getTileGridForProjection(o));const u=vg(e,s,o),h=_E(o,s,e,t),d=a.getZForResolution(h,this.zDirection),g=a.getResolution(d),m=a.getTileCoordForCoordAndZ(u,d);if(a.getResolutions().length<=m[0])return;let v=a.getTileCoordExtent(m,this.tmpExtent_);const y=this.gutter_;y!==0&&(v=Mf(v,g*y,v));const I={QUERY_LAYERS:this.params_.LAYERS};Object.assign(I,FA(this.params_,"GetFeatureInfo"),r);const w=Math.floor((u[0]-v[0])/g),R=Math.floor((v[3]-u[1])/g);return I[this.v13_?"I":"X"]=w,I[this.v13_?"J":"Y"]=R,this.getRequestUrl_(m,v,1,o||s,I)}getLegendUrl(e,t){if(this.urls[0]===void 0)return;const i={SERVICE:"WMS",VERSION:yE,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(t===void 0||t.LAYER===void 0){const r=this.params_.LAYERS;if(!(!Array.isArray(r)||r.length===1))return;i.LAYER=r}if(e!==void 0){const r=this.getProjection()?this.getProjection().getMetersPerUnit():1,s=28e-5;i.SCALE=e*r/s}return Object.assign(i,t),u4(this.urls[0],i)}getGutter(){return this.gutter_}getParams(){return this.params_}getRequestUrl_(e,t,i,r,s){const o=this.urls;if(!o)return;let a;if(o.length==1)a=o[0];else{const u=Ta(s4(e),o.length);a=o[u]}return iF(t,(this.tileGrid||this.getTileGridForProjection(r)).getResolution(e[0]),i,r,a,s,this.serverType_)}getTilePixelRatio(e){return!this.hidpi_||this.serverType_===void 0?1:e}getKeyForParams_(){let e=0;const t=[];for(const i in this.params_)t[e++]=i+"-"+this.params_[i];return t.join("/")}setParams_(e){this.params_=e,this.updateV13_(),this.setKey(this.getKeyForParams_())}setParams(e){this.setParams_(Object.assign({},e))}updateParams(e){this.setParams_(Object.assign(this.params_,e))}updateV13_(){const e=this.params_.VERSION||yE;this.v13_=ZM(e,"1.3")>=0}tileUrlFunction(e,t,i){let r=this.getTileGrid();if(r||(r=this.getTileGridForProjection(i)),r.getResolutions().length<=e[0])return;t!=1&&(!this.hidpi_||this.serverType_===void 0)&&(t=1);const s=r.getResolution(e[0]);let o=r.getTileCoordExtent(e,this.tmpExtent_);const a=this.gutter_;a!==0&&(o=Mf(o,s*a,o));const u=Object.assign({},FA(this.params_,"GetMap"));return this.getRequestUrl_(e,o,t,i,u)}}class Sc extends Io{constructor(e,t,i){super(e),this.map=t,this.frameState=i!==void 0?i:null}}class la extends Sc{constructor(e,t,i,r,s,o){super(e,t,s),this.originalEvent=i,this.pixel_=null,this.coordinate_=null,this.dragging=r!==void 0?r:!1,this.activePointers=o}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(e){this.pixel_=e}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(e){this.coordinate_=e}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const Kt={SINGLECLICK:"singleclick",CLICK:He.CLICK,DBLCLICK:He.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},vE={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown"};class cF extends mg{constructor(e,t){super(e),this.map_=e,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=t===void 0?1:t,this.down_=null;const i=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=i,this.pointerdownListenerKey_=at(i,vE.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=at(i,vE.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(He.TOUCHMOVE,this.boundHandleTouchMove_,Eb?{passive:!1}:!1)}emulateClick_(e){let t=new la(Kt.CLICK,this.map_,e);this.dispatchEvent(t),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,t=new la(Kt.DBLCLICK,this.map_,e),this.dispatchEvent(t)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const i=new la(Kt.SINGLECLICK,this.map_,e);this.dispatchEvent(i)},250)}updateActivePointers_(e){const t=e,i=t.pointerId;if(t.type==Kt.POINTERUP||t.type==Kt.POINTERCANCEL){delete this.trackedTouches_[i];for(const r in this.trackedTouches_)if(this.trackedTouches_[r].target!==t.target){delete this.trackedTouches_[r];break}}else(t.type==Kt.POINTERDOWN||t.type==Kt.POINTERMOVE)&&(this.trackedTouches_[i]=t);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(e){this.updateActivePointers_(e);const t=new la(Kt.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(t),this.emulateClicks_&&!t.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(Ft),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(e){return e.button===0}handlePointerDown_(e){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(e);const t=new la(Kt.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);if(this.dispatchEvent(t),this.down_=new PointerEvent(e.type,e),Object.defineProperty(this.down_,"target",{writable:!1,value:e.target}),this.dragListenerKeys_.length===0){const i=this.map_.getOwnerDocument();this.dragListenerKeys_.push(at(i,Kt.POINTERMOVE,this.handlePointerMove_,this),at(i,Kt.POINTERUP,this.handlePointerUp_,this),at(this.element_,Kt.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==i&&this.dragListenerKeys_.push(at(this.element_.getRootNode(),Kt.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;const t=new la(Kt.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(t)}}relayMoveEvent_(e){this.originalPointerMoveEvent_=e;const t=!!(this.down_&&this.isMoving_(e));this.dispatchEvent(new la(Kt.POINTERMOVE,this.map_,e,t))}handleTouchMove_(e){const t=this.originalPointerMoveEvent_;(!t||t.defaultPrevented)&&(typeof e.cancelable!="boolean"||e.cancelable===!0)&&e.preventDefault()}isMoving_(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(Ft(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(He.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(Ft(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(Ft),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const ua={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},qn={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};class mx extends Ns{constructor(e){super();const t=e.element;t&&!e.target&&!t.style.pointerEvents&&(t.style.pointerEvents="auto"),this.element=t||null,this.target_=null,this.map_=null,this.listenerKeys=[],e.render&&(this.render=e.render),e.target&&this.setTarget(e.target)}disposeInternal(){this.element?.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(e){this.map_&&this.element?.remove();for(let t=0,i=this.listenerKeys.length;t<i;++t)Ft(this.listenerKeys[t]);if(this.listenerKeys.length=0,this.map_=e,e){const t=this.target_??e.getOverlayContainerStopEvent();this.element&&t.appendChild(this.element),this.render!==Cf&&this.listenerKeys.push(at(e,ua.POSTRENDER,this.render,this)),e.render()}}render(e){}setTarget(e){this.target_=typeof e=="string"?document.getElementById(e):e}}class hF extends mx{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=e.collapsible!==void 0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=e.attributions;const t=e.className!==void 0?e.className:"ol-attribution",i=e.tipLabel!==void 0?e.tipLabel:"Attributions",r=e.expandClassName!==void 0?e.expandClassName:t+"-expand",s=e.collapseLabel!==void 0?e.collapseLabel:"",o=e.collapseClassName!==void 0?e.collapseClassName:t+"-collapse";typeof s=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=o):this.collapseLabel_=s;const a=e.label!==void 0?e.label:"i";typeof a=="string"?(this.label_=document.createElement("span"),this.label_.textContent=a,this.label_.className=r):this.label_=a;const u=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=i,this.toggleButton_.appendChild(u),this.toggleButton_.addEventListener(He.CLICK,this.handleClick_.bind(this),!1);const h=t+" "+R_+" "+ex+(this.collapsed_&&this.collapsible_?" "+eA:"")+(this.collapsible_?"":" ol-uncollapsible"),d=this.element;d.className=h,d.appendChild(this.toggleButton_),d.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(e){const t=this.getMap().getAllLayers(),i=new Set(t.flatMap(r=>r.getAttributions(e)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(r=>i.add(r)):i.add(this.attributions_)),!this.overrideCollapsible_){const r=!t.some(s=>s.getSource()?.getAttributionsCollapsible()===!1);this.setCollapsible(r)}return Array.from(i)}async updateElement_(e){if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=await Promise.all(this.collectSourceAttributions_(e).map(r=>UM(()=>r))),i=t.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!za(t,this.renderedAttributions_)){c6(this.ulElement_);for(let r=0,s=t.length;r<s;++r){const o=document.createElement("li");o.innerHTML=t[r],this.ulElement_.appendChild(o)}this.renderedAttributions_=t}}handleClick_(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(eA),this.collapsed_?Q2(this.collapseLabel_,this.label_):Q2(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(e){this.userCollapsed_=e,!(!this.collapsible_||this.collapsed_===e)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(e){this.updateElement_(e.frameState)}}class dF extends mx{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target});const t=e.className!==void 0?e.className:"ol-rotate",i=e.label!==void 0?e.label:"",r=e.compassClassName!==void 0?e.compassClassName:"ol-compass";this.label_=null,typeof i=="string"?(this.label_=document.createElement("span"),this.label_.className=r,this.label_.textContent=i):(this.label_=i,this.label_.classList.add(r));const s=e.tipLabel?e.tipLabel:"Reset rotation",o=document.createElement("button");o.className=t+"-reset",o.setAttribute("type","button"),o.title=s,o.appendChild(this.label_),o.addEventListener(He.CLICK,this.handleClick_.bind(this),!1);const a=t+" "+R_+" "+ex,u=this.element;u.className=a,u.appendChild(o),this.callResetNorth_=e.resetNorth?e.resetNorth:void 0,this.duration_=e.duration!==void 0?e.duration:250,this.autoHide_=e.autoHide!==void 0?e.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(lp)}handleClick_(e){e.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const i=t.getRotation();i!==void 0&&(this.duration_>0&&i%(2*Math.PI)!==0?t.animate({rotation:0,duration:this.duration_,easing:Mh}):t.setRotation(0))}render(e){const t=e.frameState;if(!t)return;const i=t.viewState.rotation;if(i!=this.rotation_){const r="rotate("+i+"rad)";if(this.autoHide_){const s=this.element.classList.contains(lp);!s&&i===0?this.element.classList.add(lp):s&&i!==0&&this.element.classList.remove(lp)}this.label_.style.transform=r}this.rotation_=i}}class fF extends mx{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target});const t=e.className!==void 0?e.className:"ol-zoom",i=e.delta!==void 0?e.delta:1,r=e.zoomInClassName!==void 0?e.zoomInClassName:t+"-in",s=e.zoomOutClassName!==void 0?e.zoomOutClassName:t+"-out",o=e.zoomInLabel!==void 0?e.zoomInLabel:"+",a=e.zoomOutLabel!==void 0?e.zoomOutLabel:"",u=e.zoomInTipLabel!==void 0?e.zoomInTipLabel:"Zoom in",h=e.zoomOutTipLabel!==void 0?e.zoomOutTipLabel:"Zoom out",d=document.createElement("button");d.className=r,d.setAttribute("type","button"),d.title=u,d.appendChild(typeof o=="string"?document.createTextNode(o):o),d.addEventListener(He.CLICK,this.handleClick_.bind(this,i),!1);const g=document.createElement("button");g.className=s,g.setAttribute("type","button"),g.title=h,g.appendChild(typeof a=="string"?document.createTextNode(a):a),g.addEventListener(He.CLICK,this.handleClick_.bind(this,-i),!1);const m=t+" "+R_+" "+ex,v=this.element;v.className=m,v.appendChild(d),v.appendChild(g),this.duration_=e.duration!==void 0?e.duration:250}handleClick_(e,t){t.preventDefault(),this.zoomByDelta_(e)}zoomByDelta_(e){const i=this.getMap().getView();if(!i)return;const r=i.getZoom();if(r!==void 0){const s=i.getConstrainedZoom(r+e);this.duration_>0?(i.getAnimating()&&i.cancelAnimations(),i.animate({zoom:s,duration:this.duration_,easing:Mh})):i.setZoom(s)}}}function gF(n){n=n||{};const e=new Er;return(n.zoom===void 0||n.zoom)&&e.push(new fF(n.zoomOptions)),(n.rotate===void 0||n.rotate)&&e.push(new dF(n.rotateOptions)),(n.attribution===void 0||n.attribution)&&e.push(new hF(n.attributionOptions)),e}class mF{constructor(e,t,i){this.decay_=e,this.minVelocity_=t,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(e,t){this.points_.push(e,t,Date.now())}end(){if(this.points_.length<6)return!1;const e=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[t+2]<e)return!1;let i=t-3;for(;i>0&&this.points_[i+2]>e;)i-=3;const r=this.points_[t+2]-this.points_[i+2];if(r<1e3/60)return!1;const s=this.points_[t]-this.points_[i],o=this.points_[t+1]-this.points_[i+1];return this.angle_=Math.atan2(o,s),this.initialVelocity_=Math.sqrt(s*s+o*o)/r,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}const GA={ACTIVE:"active"};class xg extends Ns{constructor(e){super(),this.on,this.once,this.un,e&&e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(GA.ACTIVE)}getMap(){return this.map_}handleEvent(e){return!0}setActive(e){this.set(GA.ACTIVE,e)}setMap(e){this.map_=e}}function pF(n,e,t){const i=n.getCenterInternal();if(i){const r=[i[0]+e[0],i[1]+e[1]];n.animateInternal({duration:t!==void 0?t:250,easing:fV,center:n.getConstrainedCenter(r)})}}function px(n,e,t,i){const r=n.getZoom();if(r===void 0)return;const s=n.getConstrainedZoom(r+e),o=n.getResolutionForZoom(s);n.getAnimating()&&n.cancelAnimations(),n.animate({resolution:o,anchor:t,duration:i!==void 0?i:250,easing:Mh})}class _F extends xg{constructor(e){super(),e=e||{},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:250}handleEvent(e){let t=!1;if(e.type==Kt.DBLCLICK){const i=e.originalEvent,r=e.map,s=e.coordinate,o=i.shiftKey?-this.delta_:this.delta_,a=r.getView();px(a,o,s,this.duration_),i.preventDefault(),t=!0}return!t}}function EE(n){const e=arguments;return function(t){let i=!0;for(let r=0,s=e.length;r<s&&(i=i&&e[r](t),!!i);++r);return i}}const yF=function(n){const e=n.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},vF=function(n){const e=n.map.getTargetElement(),t=e.getRootNode(),i=n.map.getOwnerDocument().activeElement;return t instanceof ShadowRoot?t.host.contains(i):e.contains(i)},d4=function(n){const e=n.map.getTargetElement(),t=e.getRootNode();return(t instanceof ShadowRoot?t.host:e).hasAttribute("tabindex")?vF(n):!0},EF=Pf,f4=function(n){const e=n.originalEvent;return"pointerId"in e&&e.button==0&&!(l6&&yb&&e.ctrlKey)},g4=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},wF=function(n){const e=n.originalEvent;return yb?e.metaKey:e.ctrlKey},xF=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},m4=function(n){const e=n.originalEvent,t=e.target.tagName;return t!=="INPUT"&&t!=="SELECT"&&t!=="TEXTAREA"&&!e.target.isContentEditable},f1=function(n){const e=n.originalEvent;return"pointerId"in e&&e.pointerType=="mouse"},TF=function(n){const e=n.originalEvent;return"pointerId"in e&&e.isPrimary&&e.button===0};class Tg extends xg{constructor(e){e=e||{},super(e),e.handleDownEvent&&(this.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(this.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(this.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(this.handleUpEvent=e.handleUpEvent),e.stopDown&&(this.stopDown=e.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(e){return!1}handleDragEvent(e){}handleEvent(e){if(!e.originalEvent)return!0;let t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==Kt.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==Kt.POINTERUP){const i=this.handleUpEvent(e);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(e.type==Kt.POINTERDOWN){const i=this.handleDownEvent(e);this.handlingDownUpSequence=i,t=this.stopDown(i)}else e.type==Kt.POINTERMOVE&&this.handleMoveEvent(e);return!t}handleMoveEvent(e){}handleUpEvent(e){return!1}stopDown(e){return e}updateTrackedPointers_(e){e.activePointers&&(this.targetPointers=e.activePointers)}}function _x(n){const e=n.length;let t=0,i=0;for(let r=0;r<e;r++)t+=n[r].clientX,i+=n[r].clientY;return{clientX:t/e,clientY:i/e}}class IF extends Tg{constructor(e){super({stopDown:m_}),e=e||{},this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const t=e.condition?e.condition:EE(g4,TF);this.condition_=e.onFocusOnly?EE(d4,t):t,this.noKinetic_=!1}handleDragEvent(e){const t=e.map;this.panning_||(this.panning_=!0,t.getView().beginInteraction());const i=this.targetPointers,r=t.getEventPixel(_x(i));if(i.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(r[0],r[1]),this.lastCentroid){const s=[this.lastCentroid[0]-r[0],r[1]-this.lastCentroid[1]],a=e.map.getView();_5(s,a.getResolution()),Vw(s,a.getRotation()),a.adjustCenterInternal(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=r,this.lastPointersCount_=i.length,e.originalEvent.preventDefault()}handleUpEvent(e){const t=e.map,i=t.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const r=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),o=i.getCenterInternal(),a=t.getPixelFromCoordinateInternal(o),u=t.getCoordinateFromPixelInternal([a[0]-r*Math.cos(s),a[1]-r*Math.sin(s)]);i.animateInternal({center:i.getConstrainedCenter(u),duration:500,easing:Mh})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(e){if(this.targetPointers.length>0&&this.condition_(e)){const i=e.map.getView();return this.lastCentroid=null,i.getAnimating()&&i.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class SF extends Tg{constructor(e){e=e||{},super({stopDown:m_}),this.condition_=e.condition?e.condition:yF,this.lastAngle_=void 0,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){if(!f1(e))return;const t=e.map,i=t.getView();if(i.getConstraints().rotation===lx)return;const r=t.getSize(),s=e.pixel,o=Math.atan2(r[1]/2-s[1],s[0]-r[0]/2);if(this.lastAngle_!==void 0){const a=o-this.lastAngle_;i.adjustRotationInternal(-a)}this.lastAngle_=o}handleUpEvent(e){return f1(e)?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){return f1(e)&&f4(e)&&this.condition_(e)?(e.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class AF extends f_{constructor(e){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const e=this.startPixel_,t=this.endPixel_,i="px",r=this.element_.style;r.left=Math.min(e[0],t[0])+i,r.top=Math.min(e[1],t[1])+i,r.width=Math.abs(t[0]-e[0])+i,r.height=Math.abs(t[1]-e[1])+i}setMap(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(e,t){this.startPixel_=e,this.endPixel_=t,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const e=this.startPixel_,t=this.endPixel_,r=[e,[e[0],t[1]],t,[t[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);r[4]=r[0].slice(),this.geometry_?this.geometry_.setCoordinates([r]):this.geometry_=new Vf([r])}getGeometry(){return this.geometry_}}const gc={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class Ld extends Io{constructor(e,t,i){super(e),this.coordinate=t,this.mapBrowserEvent=i}}class RF extends Tg{constructor(e){super(),this.on,this.once,this.un,e=e??{},this.box_=new AF(e.className||"ol-dragbox"),this.minArea_=e.minArea??64,e.onBoxEnd&&(this.onBoxEnd=e.onBoxEnd),this.startPixel_=null,this.condition_=e.condition??f4,this.boxEndCondition_=e.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(e,t,i){const r=i[0]-t[0],s=i[1]-t[1];return r*r+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(e){this.startPixel_&&(this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new Ld(gc.BOXDRAG,e.coordinate,e)))}handleUpEvent(e){if(!this.startPixel_)return!1;const t=this.boxEndCondition_(e,this.startPixel_,e.pixel);return t&&this.onBoxEnd(e),this.dispatchEvent(new Ld(t?gc.BOXEND:gc.BOXCANCEL,e.coordinate,e)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(e){return this.condition_(e)?(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new Ld(gc.BOXSTART,e.coordinate,e)),!0):!1}onBoxEnd(e){}setActive(e){e||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Ld(gc.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(e)}setMap(e){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Ld(gc.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(e)}}class PF extends RF{constructor(e){e=e||{};const t=e.condition?e.condition:xF;super({condition:t,className:e.className||"ol-dragzoom",minArea:e.minArea}),this.duration_=e.duration!==void 0?e.duration:200,this.out_=e.out!==void 0?e.out:!1}onBoxEnd(e){const i=this.getMap().getView();let r=this.getGeometry();if(this.out_){const s=i.rotatedExtentForGeometry(r),o=i.getResolutionForExtentInternal(s),a=i.getResolution()/o;r=r.clone(),r.scale(a*a)}i.fitInternal(r,{duration:this.duration_,easing:Mh})}}const wl={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class CF extends xg{constructor(e){super(),e=e||{},this.defaultCondition_=function(t){return g4(t)&&m4(t)},this.condition_=e.condition!==void 0?e.condition:this.defaultCondition_,this.duration_=e.duration!==void 0?e.duration:100,this.pixelDelta_=e.pixelDelta!==void 0?e.pixelDelta:128}handleEvent(e){let t=!1;if(e.type==He.KEYDOWN){const i=e.originalEvent,r=i.key;if(this.condition_(e)&&(r==wl.DOWN||r==wl.LEFT||r==wl.RIGHT||r==wl.UP)){const o=e.map.getView(),a=o.getResolution()*this.pixelDelta_;let u=0,h=0;r==wl.DOWN?h=-a:r==wl.LEFT?u=-a:r==wl.RIGHT?u=a:h=a;const d=[u,h];Vw(d,o.getRotation()),pF(o,d,this.duration_),i.preventDefault(),t=!0}}return!t}}class MF extends xg{constructor(e){super(),e=e||{},this.condition_=e.condition?e.condition:function(t){return!wF(t)&&m4(t)},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:100}handleEvent(e){let t=!1;if(e.type==He.KEYDOWN||e.type==He.KEYPRESS){const i=e.originalEvent,r=i.key;if(this.condition_(e)&&(r==="+"||r==="-")){const s=e.map,o=r==="+"?this.delta_:-this.delta_,a=s.getView();px(a,o,void 0,this.duration_),i.preventDefault(),t=!0}}return!t}}const bF=40,kF=300;class LF extends xg{constructor(e){e=e||{},super(e),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=e.maxDelta!==void 0?e.maxDelta:1,this.duration_=e.duration!==void 0?e.duration:250,this.timeout_=e.timeout!==void 0?e.timeout:80,this.useAnchor_=e.useAnchor!==void 0?e.useAnchor:!0,this.constrainResolution_=e.constrainResolution!==void 0?e.constrainResolution:!1;const t=e.condition?e.condition:EF;this.condition_=e.onFocusOnly?EE(d4,t):t,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const e=this.getMap();if(!e)return;e.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(e){if(!this.condition_(e)||e.type!==He.WHEEL)return!0;const i=e.map,r=e.originalEvent;r.preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.pixel);let s=r.deltaY;switch(r.deltaMode){case WheelEvent.DOM_DELTA_LINE:s*=bF;break;case WheelEvent.DOM_DELTA_PAGE:s*=kF;break}if(s===0)return!1;this.lastDelta_=s;const o=Date.now();this.startTime_===void 0&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?"trackpad":"wheel");const a=i.getView();if(this.mode_==="trackpad"&&!(a.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(a.getAnimating()&&a.cancelAnimations(),a.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),a.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_?i.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=o,!1;this.totalDelta_+=s;const u=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,i),u),!1}handleWheelZoom_(e){const t=e.getView();t.getAnimating()&&t.cancelAnimations();let i=-kt(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(t.getConstrainResolution()||this.constrainResolution_)&&(i=i?i>0?1:-1:0),px(t,i,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(e){this.useAnchor_=e,e||(this.lastAnchor_=null)}}class DF extends Tg{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=m_),super(t),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=e.threshold!==void 0?e.threshold:.3,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){let t=0;const i=this.targetPointers[0],r=this.targetPointers[1],s=Math.atan2(r.clientY-i.clientY,r.clientX-i.clientX);if(this.lastAngle_!==void 0){const u=s-this.lastAngle_;this.rotationDelta_+=u,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),t=u}this.lastAngle_=s;const o=e.map,a=o.getView();a.getConstraints().rotation!==lx&&(this.anchor_=o.getCoordinateFromPixelInternal(o.getEventPixel(_x(this.targetPointers))),this.rotating_&&(o.render(),a.adjustRotationInternal(t,this.anchor_)))}handleUpEvent(e){return this.targetPointers.length<2?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}class NF extends Tg{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=m_),super(t),this.anchor_=null,this.duration_=e.duration!==void 0?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(e){let t=1;const i=this.targetPointers[0],r=this.targetPointers[1],s=i.clientX-r.clientX,o=i.clientY-r.clientY,a=Math.sqrt(s*s+o*o);this.lastDistance_!==void 0&&(t=this.lastDistance_/a),this.lastDistance_=a;const u=e.map,h=u.getView();t!=1&&(this.lastScaleDelta_=t),this.anchor_=u.getCoordinateFromPixelInternal(u.getEventPixel(_x(this.targetPointers))),u.render(),h.adjustResolutionInternal(t,this.anchor_)}handleUpEvent(e){if(this.targetPointers.length<2){const i=e.map.getView(),r=this.lastScaleDelta_>1?1:-1;return i.endInteraction(this.duration_,r),!1}return!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}function OF(n){n=n||{};const e=new Er,t=new mF(-.005,.05,100);return(n.altShiftDragRotate===void 0||n.altShiftDragRotate)&&e.push(new SF),(n.doubleClickZoom===void 0||n.doubleClickZoom)&&e.push(new _F({delta:n.zoomDelta,duration:n.zoomDuration})),(n.dragPan===void 0||n.dragPan)&&e.push(new IF({onFocusOnly:n.onFocusOnly,kinetic:t})),(n.pinchRotate===void 0||n.pinchRotate)&&e.push(new DF),(n.pinchZoom===void 0||n.pinchZoom)&&e.push(new NF({duration:n.zoomDuration})),(n.keyboard===void 0||n.keyboard)&&(e.push(new CF),e.push(new MF({delta:n.zoomDelta,duration:n.zoomDuration}))),(n.mouseWheelZoom===void 0||n.mouseWheelZoom)&&e.push(new LF({onFocusOnly:n.onFocusOnly,duration:n.zoomDuration})),(n.shiftDragZoom===void 0||n.shiftDragZoom)&&e.push(new PF({duration:n.zoomDuration})),e}class VF extends f_{constructor(e){super(),this.map_=e}dispatchRenderEvent(e,t){ot()}calculateMatrices2D(e){const t=e.viewState,i=e.coordinateToPixelTransform,r=e.pixelToCoordinateTransform;_o(i,e.size[0]/2,e.size[1]/2,1/t.resolution,-1/t.resolution,-t.rotation,-t.center[0],-t.center[1]),lb(r,i)}forEachFeatureAtCoordinate(e,t,i,r,s,o,a,u){let h;const d=t.viewState;function g(L,D,B,M){return s.call(o,D,L?B:null,M)}const m=d.projection,v=QM(e.slice(),m),y=[[0,0]];if(m.canWrapX()&&r){const L=m.getExtent(),D=ut(L);y.push([-D,0],[D,0])}const I=t.layerStatesArray,w=I.length,R=[],P=[];for(let L=0;L<y.length;L++)for(let D=w-1;D>=0;--D){const B=I[D],M=B.layer;if(M.hasRenderer()&&cx(B,d)&&a.call(u,M)){const A=M.getRenderer(),k=M.getSource();if(A&&k){const F=k.getWrapX()?v:e,G=g.bind(null,B.managed);P[0]=F[0]+y[L][0],P[1]=F[1]+y[L][1],h=A.forEachFeatureAtCoordinate(P,t,i,G,R)}if(h)return h}}if(R.length===0)return;const b=1/R.length;return R.forEach((L,D)=>L.distanceSq+=D*b),R.sort((L,D)=>L.distanceSq-D.distanceSq),R.some(L=>h=L.callback(L.feature,L.layer,L.geometry)),h}hasFeatureAtCoordinate(e,t,i,r,s,o){return this.forEachFeatureAtCoordinate(e,t,i,r,Pf,this,s,o)!==void 0}getMap(){return this.map_}renderFrame(e){ot()}scheduleExpireIconCache(e){xr.canExpireCache()&&e.postRenderFunctions.push(FF)}}function FF(n,e){xr.expire()}class GF extends VF{constructor(e){super(e),this.fontChangeListenerKey_=at(wc,ih.PROPERTYCHANGE,e.redrawText,e),this.element_=Wi?wb():document.createElement("div");const t=this.element_.style;t.position="absolute",t.width="100%",t.height="100%",t.zIndex="0",this.element_.className=R_+" ol-layers";const i=e.getViewport();i&&i.insertBefore(this.element_,i.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(e,t){const i=this.getMap();if(i.hasListener(e)){const r=new zb(e,void 0,t);i.dispatchEvent(r)}}disposeInternal(){Ft(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(e){if(!e){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(e),this.dispatchRenderEvent(wr.PRECOMPOSE,e);const t=e.layerStatesArray.sort((h,d)=>h.zIndex-d.zIndex);t.some(h=>h.layer instanceof e4&&h.layer.getDeclutter())&&(e.declutter={});const r=e.viewState;this.children_.length=0;const s=[];let o=null;for(let h=0,d=t.length;h<d;++h){const g=t[h];e.layerIndex=h;const m=g.layer,v=m.getSourceState();if(!cx(g,r)||v!="ready"&&v!="undefined"){m.unrender();continue}const y=m.render(e,o);y&&(y!==o&&(this.children_.push(y),o=y),s.push(g))}this.declutter(e,s),h6(this.element_,this.children_);const u=this.getMap().getTargetElement();if(ya(u)){const h=u.getContext("2d");for(const d of this.children_){const g=d.firstElementChild||d,m=d.style.backgroundColor;if(m&&(!ya(g)||g.width>0)&&(h.fillStyle=m,h.fillRect(0,0,u.width,u.height)),ya(g)&&g.width>0){const v=d.style.opacity||g.style.opacity;h.globalAlpha=v===""?1:Number(v);const y=g.style.transform;if(y)h.setTransform(...aE(y));else{const I=parseFloat(g.style.width)/g.width,w=parseFloat(g.style.height)/g.height;h.setTransform(I,0,0,w,0,0)}h.drawImage(g,0,0)}}h.globalAlpha=1,h.setTransform(1,0,0,1,0,0)}this.dispatchRenderEvent(wr.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}declutter(e,t){if(e.declutter){for(let i=t.length-1;i>=0;--i){const r=t[i],s=r.layer;s.getDeclutter()&&s.renderDeclutter(e,r)}t.forEach(i=>i.layer.renderDeferred(e))}}}function p4(n){if(n instanceof k_){n.setMapInternal(null);return}n instanceof L_&&n.getLayers().forEach(p4)}function _4(n,e){if(n instanceof k_){n.setMapInternal(e);return}if(n instanceof L_){const t=n.getLayers().getArray();for(let i=0,r=t.length;i<r;++i)_4(t[i],e)}}let jF=class extends Ns{constructor(e){super(),e=e||{},this.on,this.once,this.un;const t=UF(e);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=e.maxTilesLoading!==void 0?e.maxTilesLoading:16,this.pixelRatio_=e.pixelRatio!==void 0?e.pixelRatio:u6,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=Hr(),this.pixelToCoordinateTransform_=Hr(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,Wi||(this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_)),this.mapBrowserEventHandler_=null,this.moveTolerance_=e.moveTolerance,this.keyboardEventTarget_=t.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,Wi||(this.resizeObserver_=new ResizeObserver(()=>this.updateSize())),this.controls=t.controls||(Wi?new Er:gF()),this.interactions=t.interactions||(Wi?new Er:OF({onFocusOnly:!0})),this.overlays_=t.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new aF(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(qn.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(qn.VIEW,this.handleViewChanged_),this.addChangeListener(qn.SIZE,this.handleSizeChanged_),this.addChangeListener(qn.TARGET,this.handleTargetChanged_),this.setProperties(t.values);const i=this;e.view&&!(e.view instanceof ws)&&e.view.then(function(r){i.setView(new ws(r))}),this.controls.addEventListener(Ii.ADD,r=>{r.element.setMap(this)}),this.controls.addEventListener(Ii.REMOVE,r=>{r.element.setMap(null)}),this.interactions.addEventListener(Ii.ADD,r=>{r.element.setMap(this)}),this.interactions.addEventListener(Ii.REMOVE,r=>{r.element.setMap(null)}),this.overlays_.addEventListener(Ii.ADD,r=>{this.addOverlayInternal_(r.element)}),this.overlays_.addEventListener(Ii.REMOVE,r=>{const s=r.element.getId();s!==void 0&&delete this.overlayIdIndex_[s.toString()],r.element.setMap(null)}),this.controls.forEach(r=>{r.setMap(this)}),this.interactions.forEach(r=>{r.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(e){this.getControls().push(e)}addInteraction(e){this.getInteractions().push(e)}addLayer(e){this.getLayerGroup().getLayers().push(e)}handleLayerAdd_(e){_4(e.layer,this)}addOverlay(e){this.getOverlays().push(e)}addOverlayInternal_(e){const t=e.getId();t!==void 0&&(this.overlayIdIndex_[t.toString()]=e),e.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_?.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(e,t,i){if(!this.frameState_||!this.renderer_)return;const r=this.getCoordinateFromPixelInternal(e);i=i!==void 0?i:{};const s=i.hitTolerance!==void 0?i.hitTolerance:0,o=i.layerFilter!==void 0?i.layerFilter:Pf,a=i.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(r,this.frameState_,s,a,t,null,o,null)}getFeaturesAtPixel(e,t){const i=[];return this.forEachFeatureAtPixel(e,function(r){i.push(r)},t),i}getAllLayers(){const e=[];function t(i){i.forEach(function(r){r instanceof L_?t(r.getLayers()):e.push(r)})}return t(this.getLayers()),e}hasFeatureAtPixel(e,t){if(!this.frameState_||!this.renderer_)return!1;const i=this.getCoordinateFromPixelInternal(e);t=t!==void 0?t:{};const r=t.layerFilter!==void 0?t.layerFilter:Pf,s=t.hitTolerance!==void 0?t.hitTolerance:0,o=t.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,s,o,r,null)}getEventCoordinate(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}getEventCoordinateInternal(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}getEventPixel(e){const i=this.viewport_.getBoundingClientRect(),r=this.getSize(),s=i.width/r[0],o=i.height/r[1],a="changedTouches"in e?e.changedTouches[0]:e;return[(a.clientX-i.left)/s,(a.clientY-i.top)/o]}getTarget(){return this.get(qn.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(e){return oE(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}getCoordinateFromPixelInternal(e){const t=this.frameState_;return t?Sn(t.pixelToCoordinateTransform,e.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(e){const t=this.overlayIdIndex_[e.toString()];return t!==void 0?t:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(qn.LAYERGROUP)}setLayers(e){const t=this.getLayerGroup();if(e instanceof Er){t.setLayers(e);return}const i=t.getLayers();i.clear(),i.extend(e)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const e=this.getLayerGroup().getLayerStatesArray();for(let t=0,i=e.length;t<i;++t){const r=e[t];if(!r.visible)continue;const s=r.layer.getRenderer();if(s&&!s.ready)return!0;const o=r.layer.getSource();if(o&&o.loading)return!0}return!1}getPixelFromCoordinate(e){const t=ro(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(t)}getPixelFromCoordinateInternal(e){const t=this.frameState_;return t?Sn(t.coordinateToPixelTransform,e.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(qn.SIZE)}getView(){return this.get(qn.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const e=this.getTargetElement();return e?e.ownerDocument:document}getTilePriority(e,t,i,r){return lF(this.frameState_,e,t,i,r)}handleBrowserEvent(e,t){t=t||e.type;const i=new la(t,this,e);this.handleMapBrowserEvent(i)}handleMapBrowserEvent(e){if(!this.frameState_)return;const t=e.originalEvent,i=t.type;if(i===vE.POINTERDOWN||i===He.WHEEL||i===He.KEYDOWN){const r=this.getOwnerDocument(),s=this.viewport_.getRootNode?this.viewport_.getRootNode():r,o=t.target,a=s instanceof ShadowRoot?s.host===o?s.host.ownerDocument:s:s===r?r.documentElement:s;if(this.overlayContainerStopEvent_.contains(o)||!a.contains(o))return}if(e.frameState=this.frameState_,this.dispatchEvent(e)!==!1){const r=this.getInteractions().getArray().slice();for(let s=r.length-1;s>=0;s--){const o=r[s];if(o.getMap()!==this||!o.getActive()||!this.getTargetElement())continue;if(!o.handleEvent(e)||e.propagationStopped)break}}}handlePostRender(){const e=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){let r=this.maxTilesLoading_,s=r;if(e){const o=e.viewHints;if(o[Xn.ANIMATING]||o[Xn.INTERACTING]){const a=Date.now()-e.time>8;r=a?0:8,s=a?0:2}}t.getTilesLoading()<r&&(t.reprioritize(),t.loadMoreTiles(r,s))}e&&this.renderer_&&!e.animate&&(this.renderComplete_?(this.hasListener(wr.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(wr.RENDERCOMPLETE,e),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new Sc(ua.LOADEND,this,e)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new Sc(ua.LOADSTART,this,e))));const i=this.postRenderFunctions_;if(e)for(let r=0,s=i.length;r<s;++r)i[r](this,e);i.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let i=0,r=this.targetChangeHandlerKeys_.length;i<r;++i)Ft(this.targetChangeHandlerKeys_[i]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(He.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(He.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_&&!ya(this.targetElement_)){this.resizeObserver_?.unobserve(this.targetElement_);const i=this.targetElement_.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.unobserve(i.host),this.setSize(void 0)}const e=this.getTarget(),t=typeof e=="string"?document.getElementById(e):e;if(this.targetElement_=t,!t)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{if(ya(t)||t.appendChild(this.viewport_),this.renderer_||(this.renderer_=new GF(this)),!ya(t)){this.mapBrowserEventHandler_=new cF(this,this.moveTolerance_);for(const r in Kt)this.mapBrowserEventHandler_.addEventListener(Kt[r],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(He.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(He.WHEEL,this.boundHandleBrowserEvent_,Eb?{passive:!1}:!1);let i;if(this.keyboardEventTarget_)i=this.keyboardEventTarget_;else{const r=t.getRootNode();i=r instanceof ShadowRoot?r.host:t}if(this.targetChangeHandlerKeys_=[at(i,He.KEYDOWN,this.handleBrowserEvent,this),at(i,He.KEYPRESS,this.handleBrowserEvent,this)],t instanceof HTMLElement){const r=t.getRootNode();r instanceof ShadowRoot&&this.resizeObserver_.observe(r.host),this.resizeObserver_?.observe(t)}}this.updateSize()}}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(Ft(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(Ft(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const e=this.getView();e&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=at(e,ih.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=at(e,He.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(Ft),this.layerGroupPropertyListenerKeys_=null);const e=this.getLayerGroup();e&&(this.handleLayerAdd_(new ha("addlayer",e)),this.layerGroupPropertyListenerKeys_=[at(e,ih.PROPERTYCHANGE,this.render,this),at(e,He.CHANGE,this.render,this),at(e,"addlayer",this.handleLayerAdd_,this),at(e,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;const e=this.frameState_.layerStatesArray;for(let t=0,i=e.length;t<i;++t){const r=e[t].layer;r.hasRenderer()&&r.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(e){return this.getControls().remove(e)}removeInteraction(e){return this.getInteractions().remove(e)}removeLayer(e){return this.getLayerGroup().getLayers().remove(e)}handleLayerRemove_(e){p4(e.layer)}removeOverlay(e){return this.getOverlays().remove(e)}renderFrame_(e){const t=this.getSize(),i=this.getView(),r=this.frameState_;let s=null;if(t!==void 0&&dA(t)&&i&&i.isDef()){const o=i.getHints(this.frameState_?this.frameState_.viewHints:void 0),a=i.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:eE(a.center,a.resolution,a.rotation,t),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:t,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:a,viewHints:o,wantedTiles:{},mapId:lt(this),renderTargets:{}},a.nextCenter&&a.nextResolution){const u=isNaN(a.nextRotation)?a.rotation:a.nextRotation;s.nextExtent=eE(a.nextCenter,a.nextResolution,u,t)}}this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),r&&(!this.previousExtent_||!E_(this.previousExtent_)&&!bf(s.extent,this.previousExtent_))&&(this.dispatchEvent(new Sc(ua.MOVESTART,this,r)),this.previousExtent_=p_(this.previousExtent_)),this.previousExtent_&&!s.viewHints[Xn.ANIMATING]&&!s.viewHints[Xn.INTERACTING]&&!bf(s.extent,this.previousExtent_)&&(this.dispatchEvent(new Sc(ua.MOVEEND,this,s)),zM(s.extent,this.previousExtent_))),this.dispatchEvent(new Sc(ua.POSTRENDER,this,s)),this.renderComplete_=(this.hasListener(ua.LOADSTART)||this.hasListener(ua.LOADEND)||this.hasListener(wr.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(e){const t=this.getLayerGroup();t&&this.handleLayerRemove_(new ha("removelayer",t)),this.set(qn.LAYERGROUP,e)}setSize(e){this.set(qn.SIZE,e)}setTarget(e){this.set(qn.TARGET,e)}setView(e){if(!e||e instanceof ws){this.set(qn.VIEW,e);return}this.set(qn.VIEW,new ws);const t=this;e.then(function(i){t.setView(new ws(i))})}updateSize(){const e=this.getTargetElement();let t;if(e){let r,s;if(ya(e))r=e.width,s=e.height;else{const o=getComputedStyle(e);r=e.offsetWidth-parseFloat(o.borderLeftWidth)-parseFloat(o.paddingLeft)-parseFloat(o.paddingRight)-parseFloat(o.borderRightWidth),s=e.offsetHeight-parseFloat(o.borderTopWidth)-parseFloat(o.paddingTop)-parseFloat(o.paddingBottom)-parseFloat(o.borderBottomWidth)}!isNaN(r)&&!isNaN(s)&&(t=[Math.max(0,r),Math.max(0,s)],!dA(t)&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&eb("No map visible because the map container's width or height are 0."))}const i=this.getSize();t&&(!i||!za(t,i))&&(this.setSize(t),this.updateViewportSize_(t))}updateViewportSize_(e){const t=this.getView();t&&t.setViewportSize(e)}};function UF(n){let e=null;n.keyboardEventTarget!==void 0&&(e=typeof n.keyboardEventTarget=="string"?document.getElementById(n.keyboardEventTarget):n.keyboardEventTarget);const t={},i=n.layers&&typeof n.layers.getLayers=="function"?n.layers:new L_({layers:n.layers});t[qn.LAYERGROUP]=i,t[qn.TARGET]=n.target,t[qn.VIEW]=n.view instanceof ws?n.view:new ws;let r;n.controls!==void 0&&(Array.isArray(n.controls)?r=new Er(n.controls.slice()):(_t(typeof n.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),r=n.controls));let s;n.interactions!==void 0&&(Array.isArray(n.interactions)?s=new Er(n.interactions.slice()):(_t(typeof n.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),s=n.interactions));let o;return n.overlays!==void 0?Array.isArray(n.overlays)?o=new Er(n.overlays.slice()):(_t(typeof n.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),o=n.overlays):o=new Er,{controls:r,interactions:s,keyboardEventTarget:e,overlays:o,values:t}}const BF={},jA=n=>{let e;const t=new Set,i=(d,g)=>{const m=typeof d=="function"?d(e):d;if(!Object.is(m,e)){const v=e;e=g??(typeof m!="object"||m===null)?m:Object.assign({},e,m),t.forEach(y=>y(e,v))}},r=()=>e,u={setState:i,getState:r,getInitialState:()=>h,subscribe:d=>(t.add(d),()=>t.delete(d)),destroy:()=>{(BF?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},h=e=n(i,r,u);return u},zF=n=>n?jA(n):jA;var g1={exports:{}},m1={},p1={exports:{}},_1={};var UA;function $F(){if(UA)return _1;UA=1;var n=fg();function e(g,m){return g===m&&(g!==0||1/g===1/m)||g!==g&&m!==m}var t=typeof Object.is=="function"?Object.is:e,i=n.useState,r=n.useEffect,s=n.useLayoutEffect,o=n.useDebugValue;function a(g,m){var v=m(),y=i({inst:{value:v,getSnapshot:m}}),I=y[0].inst,w=y[1];return s(function(){I.value=v,I.getSnapshot=m,u(I)&&w({inst:I})},[g,v,m]),r(function(){return u(I)&&w({inst:I}),g(function(){u(I)&&w({inst:I})})},[g]),o(v),v}function u(g){var m=g.getSnapshot;g=g.value;try{var v=m();return!t(g,v)}catch{return!0}}function h(g,m){return m()}var d=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?h:a;return _1.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:d,_1}var BA;function WF(){return BA||(BA=1,p1.exports=$F()),p1.exports}var zA;function KF(){if(zA)return m1;zA=1;var n=fg(),e=WF();function t(h,d){return h===d&&(h!==0||1/h===1/d)||h!==h&&d!==d}var i=typeof Object.is=="function"?Object.is:t,r=e.useSyncExternalStore,s=n.useRef,o=n.useEffect,a=n.useMemo,u=n.useDebugValue;return m1.useSyncExternalStoreWithSelector=function(h,d,g,m,v){var y=s(null);if(y.current===null){var I={hasValue:!1,value:null};y.current=I}else I=y.current;y=a(function(){function R(B){if(!P){if(P=!0,b=B,B=m(B),v!==void 0&&I.hasValue){var M=I.value;if(v(M,B))return L=M}return L=B}if(M=L,i(b,B))return M;var A=m(B);return v!==void 0&&v(M,A)?(b=B,M):(b=B,L=A)}var P=!1,b,L,D=g===void 0?null:g;return[function(){return R(d())},D===null?void 0:function(){return R(D())}]},[d,g,m,v]);var w=r(h,y[0],y[1]);return o(function(){I.hasValue=!0,I.value=w},[w]),u(w),w},m1}var $A;function qF(){return $A||($A=1,g1.exports=KF()),g1.exports}var HF=qF();const XF=Lw(HF),y4={},{useDebugValue:YF}=t5,{useSyncExternalStoreWithSelector:ZF}=XF;let WA=!1;const QF=n=>n;function JF(n,e=QF,t){(y4?"production":void 0)!=="production"&&t&&!WA&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),WA=!0);const i=ZF(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return YF(i),i}const e9=n=>{(y4?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?zF(n):n,t=(i,r)=>JF(e,i,r);return Object.assign(t,e),t},vu=n=>e9;var v4=Symbol.for("immer-nothing"),KA=Symbol.for("immer-draftable"),Zi=Symbol.for("immer-state");function $r(n,...e){throw new Error(`[Immer] minified error nr: ${n}. Full error at: https://bit.ly/3cXEKWf`)}var jf=Object.getPrototypeOf;function ch(n){return!!n&&!!n[Zi]}function nu(n){return n?E4(n)||Array.isArray(n)||!!n[KA]||!!n.constructor?.[KA]||Ig(n)||N_(n):!1}var t9=Object.prototype.constructor.toString(),qA=new WeakMap;function E4(n){if(!n||typeof n!="object")return!1;const e=Object.getPrototypeOf(n);if(e===null||e===Object.prototype)return!0;const t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(t===Object)return!0;if(typeof t!="function")return!1;let i=qA.get(t);return i===void 0&&(i=Function.toString.call(t),qA.set(t,i)),i===t9}function x0(n,e,t=!0){D_(n)===0?(t?Reflect.ownKeys(n):Object.keys(n)).forEach(r=>{e(r,n[r],n)}):n.forEach((i,r)=>e(r,i,n))}function D_(n){const e=n[Zi];return e?e.type_:Array.isArray(n)?1:Ig(n)?2:N_(n)?3:0}function wE(n,e){return D_(n)===2?n.has(e):Object.prototype.hasOwnProperty.call(n,e)}function w4(n,e,t){const i=D_(n);i===2?n.set(e,t):i===3?n.add(t):n[e]=t}function n9(n,e){return n===e?n!==0||1/n===1/e:n!==n&&e!==e}function Ig(n){return n instanceof Map}function N_(n){return n instanceof Set}function Sl(n){return n.copy_||n.base_}function xE(n,e){if(Ig(n))return new Map(n);if(N_(n))return new Set(n);if(Array.isArray(n))return Array.prototype.slice.call(n);const t=E4(n);if(e===!0||e==="class_only"&&!t){const i=Object.getOwnPropertyDescriptors(n);delete i[Zi];let r=Reflect.ownKeys(i);for(let s=0;s<r.length;s++){const o=r[s],a=i[o];a.writable===!1&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(i[o]={configurable:!0,writable:!0,enumerable:a.enumerable,value:n[o]})}return Object.create(jf(n),i)}else{const i=jf(n);if(i!==null&&t)return{...n};const r=Object.create(i);return Object.assign(r,n)}}function yx(n,e=!1){return O_(n)||ch(n)||!nu(n)||(D_(n)>1&&Object.defineProperties(n,{set:mp,add:mp,clear:mp,delete:mp}),Object.freeze(n),e&&Object.values(n).forEach(t=>yx(t,!0))),n}function i9(){$r(2)}var mp={value:i9};function O_(n){return n===null||typeof n!="object"?!0:Object.isFrozen(n)}var r9={};function iu(n){const e=r9[n];return e||$r(0,n),e}var Uf;function x4(){return Uf}function s9(n,e){return{drafts_:[],parent_:n,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function HA(n,e){e&&(iu("Patches"),n.patches_=[],n.inversePatches_=[],n.patchListener_=e)}function TE(n){IE(n),n.drafts_.forEach(o9),n.drafts_=null}function IE(n){n===Uf&&(Uf=n.parent_)}function XA(n){return Uf=s9(Uf,n)}function o9(n){const e=n[Zi];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function YA(n,e){e.unfinalizedDrafts_=e.drafts_.length;const t=e.drafts_[0];return n!==void 0&&n!==t?(t[Zi].modified_&&(TE(e),$r(4)),nu(n)&&(n=T0(e,n),e.parent_||I0(e,n)),e.patches_&&iu("Patches").generateReplacementPatches_(t[Zi].base_,n,e.patches_,e.inversePatches_)):n=T0(e,t,[]),TE(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),n!==v4?n:void 0}function T0(n,e,t){if(O_(e))return e;const i=n.immer_.shouldUseStrictIteration(),r=e[Zi];if(!r)return x0(e,(s,o)=>ZA(n,r,e,s,o,t),i),e;if(r.scope_!==n)return e;if(!r.modified_)return I0(n,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const s=r.copy_;let o=s,a=!1;r.type_===3&&(o=new Set(s),s.clear(),a=!0),x0(o,(u,h)=>ZA(n,r,s,u,h,t,a),i),I0(n,s,!1),t&&n.patches_&&iu("Patches").generatePatches_(r,t,n.patches_,n.inversePatches_)}return r.copy_}function ZA(n,e,t,i,r,s,o){if(r==null||typeof r!="object"&&!o)return;const a=O_(r);if(!(a&&!o)){if(ch(r)){const u=s&&e&&e.type_!==3&&!wE(e.assigned_,i)?s.concat(i):void 0,h=T0(n,r,u);if(w4(t,i,h),ch(h))n.canAutoFreeze_=!1;else return}else o&&t.add(r);if(nu(r)&&!a){if(!n.immer_.autoFreeze_&&n.unfinalizedDrafts_<1||e&&e.base_&&e.base_[i]===r&&a)return;T0(n,r),(!e||!e.scope_.parent_)&&typeof i!="symbol"&&(Ig(t)?t.has(i):Object.prototype.propertyIsEnumerable.call(t,i))&&I0(n,r)}}}function I0(n,e,t=!1){!n.parent_&&n.immer_.autoFreeze_&&n.canAutoFreeze_&&yx(e,t)}function a9(n,e){const t=Array.isArray(n),i={type_:t?1:0,scope_:e?e.scope_:x4(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:n,draft_:null,copy_:null,revoke_:null,isManual_:!1};let r=i,s=vx;t&&(r=[i],s=Bf);const{revoke:o,proxy:a}=Proxy.revocable(r,s);return i.draft_=a,i.revoke_=o,a}var vx={get(n,e){if(e===Zi)return n;const t=Sl(n);if(!wE(t,e))return l9(n,t,e);const i=t[e];return n.finalized_||!nu(i)?i:i===y1(n.base_,e)?(v1(n),n.copy_[e]=AE(i,n)):i},has(n,e){return e in Sl(n)},ownKeys(n){return Reflect.ownKeys(Sl(n))},set(n,e,t){const i=T4(Sl(n),e);if(i?.set)return i.set.call(n.draft_,t),!0;if(!n.modified_){const r=y1(Sl(n),e),s=r?.[Zi];if(s&&s.base_===t)return n.copy_[e]=t,n.assigned_[e]=!1,!0;if(n9(t,r)&&(t!==void 0||wE(n.base_,e)))return!0;v1(n),SE(n)}return n.copy_[e]===t&&(t!==void 0||e in n.copy_)||Number.isNaN(t)&&Number.isNaN(n.copy_[e])||(n.copy_[e]=t,n.assigned_[e]=!0),!0},deleteProperty(n,e){return y1(n.base_,e)!==void 0||e in n.base_?(n.assigned_[e]=!1,v1(n),SE(n)):delete n.assigned_[e],n.copy_&&delete n.copy_[e],!0},getOwnPropertyDescriptor(n,e){const t=Sl(n),i=Reflect.getOwnPropertyDescriptor(t,e);return i&&{writable:!0,configurable:n.type_!==1||e!=="length",enumerable:i.enumerable,value:t[e]}},defineProperty(){$r(11)},getPrototypeOf(n){return jf(n.base_)},setPrototypeOf(){$r(12)}},Bf={};x0(vx,(n,e)=>{Bf[n]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Bf.deleteProperty=function(n,e){return Bf.set.call(this,n,e,void 0)};Bf.set=function(n,e,t){return vx.set.call(this,n[0],e,t,n[0])};function y1(n,e){const t=n[Zi];return(t?Sl(t):n)[e]}function l9(n,e,t){const i=T4(e,t);return i?"value"in i?i.value:i.get?.call(n.draft_):void 0}function T4(n,e){if(!(e in n))return;let t=jf(n);for(;t;){const i=Object.getOwnPropertyDescriptor(t,e);if(i)return i;t=jf(t)}}function SE(n){n.modified_||(n.modified_=!0,n.parent_&&SE(n.parent_))}function v1(n){n.copy_||(n.copy_=xE(n.base_,n.scope_.immer_.useStrictShallowCopy_))}var u9=class{constructor(n){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,t,i)=>{if(typeof e=="function"&&typeof t!="function"){const s=t;t=e;const o=this;return function(u=s,...h){return o.produce(u,d=>t.call(this,d,...h))}}typeof t!="function"&&$r(6),i!==void 0&&typeof i!="function"&&$r(7);let r;if(nu(e)){const s=XA(this),o=AE(e,void 0);let a=!0;try{r=t(o),a=!1}finally{a?TE(s):IE(s)}return HA(s,i),YA(r,s)}else if(!e||typeof e!="object"){if(r=t(e),r===void 0&&(r=e),r===v4&&(r=void 0),this.autoFreeze_&&yx(r,!0),i){const s=[],o=[];iu("Patches").generateReplacementPatches_(e,r,s,o),i(s,o)}return r}else $r(1,e)},this.produceWithPatches=(e,t)=>{if(typeof e=="function")return(o,...a)=>this.produceWithPatches(o,u=>e(u,...a));let i,r;return[this.produce(e,t,(o,a)=>{i=o,r=a}),i,r]},typeof n?.autoFreeze=="boolean"&&this.setAutoFreeze(n.autoFreeze),typeof n?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(n.useStrictShallowCopy),typeof n?.useStrictIteration=="boolean"&&this.setUseStrictIteration(n.useStrictIteration)}createDraft(n){nu(n)||$r(8),ch(n)&&(n=c9(n));const e=XA(this),t=AE(n,void 0);return t[Zi].isManual_=!0,IE(e),t}finishDraft(n,e){const t=n&&n[Zi];(!t||!t.isManual_)&&$r(9);const{scope_:i}=t;return HA(i,e),YA(void 0,i)}setAutoFreeze(n){this.autoFreeze_=n}setUseStrictShallowCopy(n){this.useStrictShallowCopy_=n}setUseStrictIteration(n){this.useStrictIteration_=n}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(n,e){let t;for(t=e.length-1;t>=0;t--){const r=e[t];if(r.path.length===0&&r.op==="replace"){n=r.value;break}}t>-1&&(e=e.slice(t+1));const i=iu("Patches").applyPatches_;return ch(n)?i(n,e):this.produce(n,r=>i(r,e))}};function AE(n,e){const t=Ig(n)?iu("MapSet").proxyMap_(n,e):N_(n)?iu("MapSet").proxySet_(n,e):a9(n,e);return(e?e.scope_:x4()).drafts_.push(t),t}function c9(n){return ch(n)||$r(10,n),I4(n)}function I4(n){if(!nu(n)||O_(n))return n;const e=n[Zi];let t,i=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,t=xE(n,e.scope_.immer_.useStrictShallowCopy_),i=e.scope_.immer_.shouldUseStrictIteration()}else t=xE(n,!0);return x0(t,(r,s)=>{w4(t,r,I4(s))},i),e&&(e.finalized_=!1),t}var h9=new u9,d9=h9.produce;const f9=n=>(e,t,i)=>(i.setState=(r,s,...o)=>{const a=typeof r=="function"?d9(r):r;return e(a,s,...o)},n(i.setState,t,i)),Eu=f9,Ot=vu()(Eu((n,e)=>({tracking:!1,navigationMode:"free",position:null,heading:null,smoothHeading:null,accuracy:null,speed:null,headingSource:null,watchId:null,firstFix:!0,config:{smoothingFactor:.2,minRotationSpeed:8,centerOnUser:!0,animationDuration:100},startTracking:()=>{n(t=>{t.tracking=!0})},stopTracking:()=>{n(t=>{const{watchId:i}=e();i!==null&&navigator.geolocation.clearWatch(i),t.tracking=!1,t.speed=null,t.headingSource=null,t.watchId=null})},toggleMode:()=>{n(t=>{t.navigationMode=t.navigationMode==="free"?"drive":"free",console.log(` Navigation mode: ${t.navigationMode}`)})},updatePosition:t=>{n(i=>{i.position={lat:t.coords.latitude,lng:t.coords.longitude},i.accuracy=t.coords.accuracy,i.speed=t.coords.speed;const r=15,s=.5;if(!(t.coords.accuracy!==null&&t.coords.accuracy<r)){i.headingSource=null;return}if(t.coords.heading!==null&&t.coords.speed!==null&&t.coords.speed>s){i.headingSource="gps";const a=t.coords.heading;e().updateHeading(a,"gps")}else i.headingSource="compass"})},updateHeading:(t,i="compass")=>{n(r=>{const{smoothHeading:s,config:o}=e();if(s===null){r.smoothHeading=t,r.heading=t;return}let a=t-s;a>180&&(a-=360),a<-180&&(a+=360);const u=i==="compass"?8:o.minRotationSpeed;if(Math.abs(a)<u)return;const h=s+a*o.smoothingFactor;r.smoothHeading=(h+360)%360,r.heading=t})},setWatchId:t=>{n(i=>{i.watchId=t})},resetFirstFix:()=>{n(t=>{t.firstFix=!1})}}))),S4={"AHN 0.5m":{name:"AHN 0.5m",factory:async()=>{const{createAHNLayerOL:n}=await Ue(async()=>{const{createAHNLayerOL:e}=await import("./pdokWMSLayers-BRwvu22m.js");return{createAHNLayerOL:e}},[]);return n()},immediateLoad:!0},Geomorfologie:{name:"Geomorfologie",factory:async()=>{const{createGeomorfologieLayerOL:n}=await Ue(async()=>{const{createGeomorfologieLayerOL:e}=await import("./pdokWMSLayers-BRwvu22m.js");return{createGeomorfologieLayerOL:e}},[]);return n()},immediateLoad:!0},Bodemkaart:{name:"Bodemkaart",factory:async()=>{const{createBodemkaartLayerOL:n}=await Ue(async()=>{const{createBodemkaartLayerOL:e}=await import("./pdokWMSLayers-BRwvu22m.js");return{createBodemkaartLayerOL:e}},[]);return n()},immediateLoad:!0},IKAW:{name:"IKAW",factory:async()=>{const{createIKAWLayerOL:n}=await Ue(async()=>{const{createIKAWLayerOL:e}=await import("./pdokWMSLayers-BRwvu22m.js");return{createIKAWLayerOL:e}},[]);return n()},immediateLoad:!0},"FAMKE Steentijd":{name:"FAMKE Steentijd",factory:async()=>{const{createFAMKESteentijdLayerOL:n}=await Ue(async()=>{const{createFAMKESteentijdLayerOL:e}=await import("./pdokWMSLayers-BRwvu22m.js");return{createFAMKESteentijdLayerOL:e}},[]);return n()},immediateLoad:!0},"Archeo Landschappen":{name:"Archeo Landschappen",factory:async()=>{const{createArcheoLandschappenLayerOL:n}=await Ue(async()=>{const{createArcheoLandschappenLayerOL:e}=await import("./pdokWMSLayers-BRwvu22m.js");return{createArcheoLandschappenLayerOL:e}},[]);return n()},immediateLoad:!0},Rijksmonumenten:{name:"Rijksmonumenten",factory:async()=>{const{createRijksmonumentenLayerOL:n}=await Ue(async()=>{const{createRijksmonumentenLayerOL:e}=await import("./pdokWMSLayers-BRwvu22m.js");return{createRijksmonumentenLayerOL:e}},[]);return n()},immediateLoad:!0},"Archeo Onderzoeken":{name:"Archeo Onderzoeken",factory:async()=>{const{createArcheoOnderzoekenLayerOL:n}=await Ue(async()=>{const{createArcheoOnderzoekenLayerOL:e}=await import("./pdokWMSLayers-BRwvu22m.js");return{createArcheoOnderzoekenLayerOL:e}},[]);return n()},immediateLoad:!0},Werelderfgoed:{name:"Werelderfgoed",factory:async()=>{const{createWerelderfgoedLayerOL:n}=await Ue(async()=>{const{createWerelderfgoedLayerOL:e}=await import("./pdokWMSLayers-BRwvu22m.js");return{createWerelderfgoedLayerOL:e}},[]);return n()},immediateLoad:!0},Terpen:{name:"Terpen",factory:async()=>{const{createTerpenLayerOL:n}=await Ue(async()=>{const{createTerpenLayerOL:e}=await import("./terpenOL-Dg9KjFSV.js");return{createTerpenLayerOL:e}},[]);return n()},immediateLoad:!0},Verdedigingslinies:{name:"Verdedigingslinies",factory:async()=>{const{createLiniesLayerOL:n}=await Ue(async()=>{const{createLiniesLayerOL:e}=await import("./verdedigingswerkenOL-B5cbOEnr.js");return{createLiniesLayerOL:e}},[]);return n()},immediateLoad:!0},Inundatiegebieden:{name:"Inundatiegebieden",factory:async()=>{const{createInundatiesLayerOL:n}=await Ue(async()=>{const{createInundatiesLayerOL:e}=await import("./verdedigingswerkenOL-B5cbOEnr.js");return{createInundatiesLayerOL:e}},[]);return n()},immediateLoad:!0},"Militaire Objecten":{name:"Militaire Objecten",factory:async()=>{const{createMilitaireObjectenLayerOL:n}=await Ue(async()=>{const{createMilitaireObjectenLayerOL:e}=await import("./verdedigingswerkenOL-B5cbOEnr.js");return{createMilitaireObjectenLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 800 n.Chr.":{name:"Paleokaart 800 n.Chr.",factory:async()=>{const{createPaleo800ncLayerOL:n}=await Ue(async()=>{const{createPaleo800ncLayerOL:e}=await import("./paleokaartOL-BnbH8ZQ6.js");return{createPaleo800ncLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 100 n.Chr.":{name:"Paleokaart 100 n.Chr.",factory:async()=>{const{createPaleo100ncLayerOL:n}=await Ue(async()=>{const{createPaleo100ncLayerOL:e}=await import("./paleokaartOL-BnbH8ZQ6.js");return{createPaleo100ncLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 500 v.Chr.":{name:"Paleokaart 500 v.Chr.",factory:async()=>{const{createPaleo500vcLayerOL:n}=await Ue(async()=>{const{createPaleo500vcLayerOL:e}=await import("./paleokaartOL-BnbH8ZQ6.js");return{createPaleo500vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 1500 v.Chr.":{name:"Paleokaart 1500 v.Chr.",factory:async()=>{const{createPaleo1500vcLayerOL:n}=await Ue(async()=>{const{createPaleo1500vcLayerOL:e}=await import("./paleokaartOL-BnbH8ZQ6.js");return{createPaleo1500vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 2750 v.Chr.":{name:"Paleokaart 2750 v.Chr.",factory:async()=>{const{createPaleo2750vcLayerOL:n}=await Ue(async()=>{const{createPaleo2750vcLayerOL:e}=await import("./paleokaartOL-BnbH8ZQ6.js");return{createPaleo2750vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 5500 v.Chr.":{name:"Paleokaart 5500 v.Chr.",factory:async()=>{const{createPaleo5500vcLayerOL:n}=await Ue(async()=>{const{createPaleo5500vcLayerOL:e}=await import("./paleokaartOL-BnbH8ZQ6.js");return{createPaleo5500vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 9000 v.Chr.":{name:"Paleokaart 9000 v.Chr.",factory:async()=>{const{createPaleo9000vcLayerOL:n}=await Ue(async()=>{const{createPaleo9000vcLayerOL:e}=await import("./paleokaartOL-BnbH8ZQ6.js");return{createPaleo9000vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Religieus Erfgoed":{name:"Religieus Erfgoed",factory:async()=>{const{createReligieusErfgoedLayerOL:n}=await Ue(async()=>{const{createReligieusErfgoedLayerOL:e}=await import("./religieusErfgoedOL-CQ3q99Bq.js");return{createReligieusErfgoedLayerOL:e}},[]);return n()},immediateLoad:!0},"AHN4 Hillshade NL":{name:"AHN4 Hillshade NL",factory:async()=>{const{createAHN4HillshadeLayerOL:n}=await Ue(async()=>{const{createAHN4HillshadeLayerOL:e}=await import("./hillshadeLayers-C3ufFLys.js");return{createAHN4HillshadeLayerOL:e}},[]);return n()},immediateLoad:!0},"AHN4 Multi-Hillshade NL":{name:"AHN4 Multi-Hillshade NL",factory:async()=>{const{createAHN4MultiHillshadeLayerOL:n}=await Ue(async()=>{const{createAHN4MultiHillshadeLayerOL:e}=await import("./hillshadeLayers-C3ufFLys.js");return{createAHN4MultiHillshadeLayerOL:e}},[]);return n()},immediateLoad:!0},"AHN4 Helling NL":{name:"AHN4 Helling NL",factory:async()=>{const{createAHN4SlopeLayerOL:n}=await Ue(async()=>{const{createAHN4SlopeLayerOL:e}=await import("./hillshadeLayers-C3ufFLys.js");return{createAHN4SlopeLayerOL:e}},[]);return n()},immediateLoad:!0},"World Hillshade":{name:"World Hillshade",factory:async()=>{const{createWorldHillshadeLayerOL:n}=await Ue(async()=>{const{createWorldHillshadeLayerOL:e}=await import("./hillshadeLayers-C3ufFLys.js");return{createWorldHillshadeLayerOL:e}},[]);return n()},immediateLoad:!0},"AMK Monumenten":{name:"AMK Monumenten",factory:async()=>{const{createAMKLayerOL:n}=await Ue(async()=>{const{createAMKLayerOL:e}=await import("./amkOL-C9OM5KdE.js");return{createAMKLayerOL:e}},__vite__mapDeps([0,1,2]));return n()},immediateLoad:!1},"Romeinse wegen":{name:"Romeinse wegen",factory:async()=>{const{createRomeinseWegenLayerOL:n}=await Ue(async()=>{const{createRomeinseWegenLayerOL:e}=await import("./romeinsOL-DBqq32gp.js");return{createRomeinseWegenLayerOL:e}},__vite__mapDeps([3,1,2]));return n()},immediateLoad:!1},Kastelen:{name:"Kastelen",factory:async()=>{const{createKastelenLayerOL:n}=await Ue(async()=>{const{createKastelenLayerOL:e}=await import("./kastelenOL-BdI4vfHl.js");return{createKastelenLayerOL:e}},__vite__mapDeps([4,2,5]));return n()},immediateLoad:!1},Veengebieden:{name:"Veengebieden",factory:async()=>{const{createVeengebiedenLayerOL:n}=await Ue(async()=>{const{createVeengebiedenLayerOL:e}=await import("./veengebiedenOL-BXXnblP4.js");return{createVeengebiedenLayerOL:e}},__vite__mapDeps([6,2]));return n()},immediateLoad:!1},Hunebedden:{name:"Hunebedden",factory:async()=>{const{createHunebeddenLayerOL:n}=await Ue(async()=>{const{createHunebeddenLayerOL:e}=await import("./hunebeddenOL-DKe2f5ki.js");return{createHunebeddenLayerOL:e}},__vite__mapDeps([7,2,5]));return n()},immediateLoad:!1},"UIKAV Punten":{name:"UIKAV Punten",factory:async()=>{const{createUIKAVArcheoPuntenLayerOL:n}=await Ue(async()=>{const{createUIKAVArcheoPuntenLayerOL:e}=await import("./uikavArcheoPuntenOL-Ac_D6-iP.js");return{createUIKAVArcheoPuntenLayerOL:e}},__vite__mapDeps([8,2,9,1,5]));return n()},immediateLoad:!1},"UIKAV Vlakken":{name:"UIKAV Vlakken",factory:async()=>{const{createUIKAVVlakkenLayerOL:n}=await Ue(async()=>{const{createUIKAVVlakkenLayerOL:e}=await import("./uikavVlakkenOL--t69HSzV.js");return{createUIKAVVlakkenLayerOL:e}},__vite__mapDeps([10,2,9,1]));return n()},immediateLoad:!1},"UIKAV Buffer":{name:"UIKAV Buffer",factory:async()=>{const{createUIKAVBufferlaagLayerOL:n}=await Ue(async()=>{const{createUIKAVBufferlaagLayerOL:e}=await import("./uikavBufferlaagOL-DLfnGDoG.js");return{createUIKAVBufferlaagLayerOL:e}},__vite__mapDeps([11,2,9,1]));return n()},immediateLoad:!1},"UIKAV Expert":{name:"UIKAV Expert",factory:async()=>{const{createUIKAVExpertLayerOL:n}=await Ue(async()=>{const{createUIKAVExpertLayerOL:e}=await import("./uikavExpertOL-CWMnY5Vh.js");return{createUIKAVExpertLayerOL:e}},__vite__mapDeps([12,2,9,1]));return n()},immediateLoad:!1},"UIKAV Indeling":{name:"UIKAV Indeling",factory:async()=>{const{createUIKAVUiterwaardenLayerOL:n}=await Ue(async()=>{const{createUIKAVUiterwaardenLayerOL:e}=await import("./uikavUiterwaardenOL-BybQSlZu.js");return{createUIKAVUiterwaardenLayerOL:e}},__vite__mapDeps([13,2,9,1]));return n()},immediateLoad:!1},Speeltuinen:{name:"Speeltuinen",factory:async()=>{const{createSpeeltuinenLayerOL:n}=await Ue(async()=>{const{createSpeeltuinenLayerOL:e}=await import("./speeltuinenOL-DSbLvjy-.js");return{createSpeeltuinenLayerOL:e}},__vite__mapDeps([14,2,9,1,5]));return n()},immediateLoad:!1},Musea:{name:"Musea",factory:async()=>{const{createMuseaLayerOL:n}=await Ue(async()=>{const{createMuseaLayerOL:e}=await import("./museaOL-CUdkhTWY.js");return{createMuseaLayerOL:e}},__vite__mapDeps([15,2,9,1,5]));return n()},immediateLoad:!1},Strandjes:{name:"Strandjes",factory:async()=>{const{createStrandjesLayerOL:n}=await Ue(async()=>{const{createStrandjesLayerOL:e}=await import("./strandjesOL-sHnAXFdQ.js");return{createStrandjesLayerOL:e}},__vite__mapDeps([16,2,9,1]));return n()},immediateLoad:!1},Parken:{name:"Parken",factory:async()=>{const{createParkenLayerOL:n}=await Ue(async()=>{const{createParkenLayerOL:e}=await import("./parkenOL-B9DPJe4S.js");return{createParkenLayerOL:e}},__vite__mapDeps([17,2,9,1]));return n()},immediateLoad:!1},"Fossielen Nederland":{name:"Fossielen Nederland",factory:async()=>{const{createFossielenLayerOL:n}=await Ue(async()=>{const{createFossielenLayerOL:e}=await import("./fossielenOL-C_rVI4jQ.js");return{createFossielenLayerOL:e}},__vite__mapDeps([18,19,5]));return n()},immediateLoad:!1},"Fossielen Belgi":{name:"Fossielen Belgi",factory:async()=>{const{createFossielenBelgieLayerOL:n}=await Ue(async()=>{const{createFossielenBelgieLayerOL:e}=await import("./fossielenBelgieOL-CPZQuDlD.js");return{createFossielenBelgieLayerOL:e}},__vite__mapDeps([20,19,5]));return n()},immediateLoad:!1},"Fossielen Duitsland":{name:"Fossielen Duitsland",factory:async()=>{const{createFossielenDuitslandLayerOL:n}=await Ue(async()=>{const{createFossielenDuitslandLayerOL:e}=await import("./fossielenDuitslandOL-DWaEgZPa.js");return{createFossielenDuitslandLayerOL:e}},__vite__mapDeps([21,19,5]));return n()},immediateLoad:!1},"Fossielen Frankrijk":{name:"Fossielen Frankrijk",factory:async()=>{const{createFossielenFrankrijkLayerOL:n}=await Ue(async()=>{const{createFossielenFrankrijkLayerOL:e}=await import("./fossielenFrankrijkOL-rh0eLYXU.js");return{createFossielenFrankrijkLayerOL:e}},__vite__mapDeps([22,19,5]));return n()},immediateLoad:!1},"WWII Bunkers":{name:"WWII Bunkers",factory:async()=>{const{createBunkersLayerOL:n}=await Ue(async()=>{const{createBunkersLayerOL:e}=await import("./bunkersOL-BcYOGP-D.js");return{createBunkersLayerOL:e}},__vite__mapDeps([23,2,5]));return n()},immediateLoad:!1},Grafheuvels:{name:"Grafheuvels",factory:async()=>{const{createGrafheuvelsLayerOL:n}=await Ue(async()=>{const{createGrafheuvelsLayerOL:e}=await import("./grafheuvelsOL-Dnrch09m.js");return{createGrafheuvelsLayerOL:e}},__vite__mapDeps([24,2,5]));return n()},immediateLoad:!1},Slagvelden:{name:"Slagvelden",factory:async()=>{const{createSlagveldenLayerOL:n}=await Ue(async()=>{const{createSlagveldenLayerOL:e}=await import("./slagveldenOL-CdvmPH0z.js");return{createSlagveldenLayerOL:e}},__vite__mapDeps([25,2]));return n()},immediateLoad:!1},"Militaire Vliegvelden":{name:"Militaire Vliegvelden",factory:async()=>{const{createVliegveldenLayerOL:n}=await Ue(async()=>{const{createVliegveldenLayerOL:e}=await import("./vliegveldenOL-CA9GlKXI.js");return{createVliegveldenLayerOL:e}},__vite__mapDeps([26,2]));return n()},immediateLoad:!1}};function g9(){return Object.values(S4).filter(n=>n.immediateLoad)}const Hi=vu()(Eu((n,e)=>({map:null,rotation:0,rotationEnabled:!0,setMap:t=>{n(i=>{i.map=t})},setRotation:t=>{n(i=>{if(i.rotation=t,i.map&&i.rotationEnabled){const r=t*Math.PI/180;i.map.getView().setRotation(r)}})},enableRotation:()=>{n(t=>{t.rotationEnabled=!0})},disableRotation:()=>{n(t=>{t.rotationEnabled=!1,t.rotation=0,t.map&&t.map.getView().animate({rotation:0,duration:500})})}}))),oo=vu()(Eu((n,e)=>({visible:{"CartoDB (licht)":!0,OpenStreetMap:!1,"Luchtfoto (PDOK)":!1,"TMK 1850":!1,"Bonnebladen 1900":!1,Hunebedden:!1,"FAMKE Steentijd":!1,Grafheuvels:!1,Terpen:!1,"AMK Monumenten":!1,"Romeinse wegen":!1,Kastelen:!1,IKAW:!1,"Archeo Landschappen":!1,Rijksmonumenten:!1,Werelderfgoed:!1,"WWII Bunkers":!1,Slagvelden:!1,"Militaire Vliegvelden":!1,Verdedigingslinies:!1,Inundatiegebieden:!1,"Militaire Objecten":!1,"Paleokaart 800 n.Chr.":!1,"Paleokaart 100 n.Chr.":!1,"Paleokaart 500 v.Chr.":!1,"Paleokaart 1500 v.Chr.":!1,"Paleokaart 2750 v.Chr.":!1,"Paleokaart 5500 v.Chr.":!1,"Paleokaart 9000 v.Chr.":!1,"Religieus Erfgoed":!1,"UIKAV Punten":!1,"UIKAV Vlakken":!1,"UIKAV Buffer":!1,"UIKAV Expert":!1,"UIKAV Indeling":!1,"AHN4 Hillshade NL":!1,"AHN4 Multi-Hillshade NL":!1,"AHN4 Helling NL":!1,"AHN 0.5m":!1,"World Hillshade":!1,Veengebieden:!1,Geomorfologie:!1,Bodemkaart:!1,"Fossielen Nederland":!1,"Fossielen Belgi":!1,"Fossielen Duitsland":!1,"Fossielen Frankrijk":!1,Parken:!1,Speeltuinen:!1,Musea:!1,Strandjes:!1},opacity:{"AHN 0.5m":.7,Geomorfologie:.5,Bodemkaart:.6,IKAW:.5,"Archeo Landschappen":.5,"AHN4 Hillshade NL":.7,"AHN4 Multi-Hillshade NL":.7,"AHN4 Helling NL":.6,"World Hillshade":.7,Terpen:.7,Verdedigingslinies:.7,Inundatiegebieden:.5,"Militaire Objecten":.8,"Paleokaart 800 n.Chr.":.7,"Paleokaart 100 n.Chr.":.7,"Paleokaart 500 v.Chr.":.7,"Paleokaart 1500 v.Chr.":.7,"Paleokaart 2750 v.Chr.":.7,"Paleokaart 5500 v.Chr.":.7,"Paleokaart 9000 v.Chr.":.7,"Religieus Erfgoed":.8},loadingState:{},layers:{},toggleLayer:t=>{const i=e(),r=!i.visible[t];n(s=>{s.visible[t]=r}),r&&!i.layers[t]?e().loadLayer(t):i.layers[t]&&i.layers[t].setVisible(r)},setLayerVisibility:(t,i)=>{const r=e();n(s=>{s.visible[t]=i;const o=s.layers[t];o&&o.setVisible(i)}),i&&!r.layers[t]&&e().loadLayer(t)},setLayerOpacity:(t,i)=>{n(r=>{r.opacity[t]=i;const s=r.layers[t];s&&s.setOpacity(i)})},registerLayer:(t,i)=>{n(r=>{r.layers[t]=i,r.loadingState[t]="loaded",r.visible[t]!==void 0&&i.setVisible(r.visible[t]),r.opacity[t]!==void 0&&i.setOpacity(r.opacity[t])})},unregisterLayer:t=>{n(i=>{delete i.layers[t],delete i.loadingState[t]})},loadLayer:async t=>{const i=e();if(i.loadingState[t]==="loading"||i.layers[t])return;const r=S4[t];if(!r){console.warn(` Layer "${t}" not found in registry`);return}const s=Hi.getState().map;if(!s){console.warn(` Cannot load layer "${t}": map not initialized`);return}n(o=>{o.loadingState[t]="loading"}),console.log(` Loading layer: ${t}...`);try{const o=await r.factory();if(!o)throw new Error("Factory returned null");const a=e();o.setVisible(a.visible[t]??!1),a.opacity[t]!==void 0&&o.setOpacity(a.opacity[t]),s.addLayer(o),n(u=>{u.layers[t]=o,u.loadingState[t]="loaded"}),console.log(` Layer loaded: ${t}`)}catch(o){console.error(` Failed to load layer "${t}":`,o),n(a=>{a.loadingState[t]="error"})}}}))),RE=vu()(Eu((n,e)=>({layerControlOpen:!1,legendOpen:!1,collapsedCategories:new Set,toggleLayerControl:()=>{n(t=>{t.layerControlOpen=!t.layerControlOpen})},toggleLegend:()=>{n(t=>{t.legendOpen=!t.legendOpen})},toggleCategory:t=>{n(i=>{i.collapsedCategories.has(t)?i.collapsedCategories.delete(t):i.collapsedCategories.add(t)})},setLayerControlOpen:t=>{n(i=>{i.layerControlOpen=t})},setLegendOpen:t=>{n(i=>{i.legendOpen=t})}})));vu()(Eu(n=>({user:null,loading:!0,error:null,setUser:e=>{n(t=>{t.user=e,t.loading=!1})},setLoading:e=>{n(t=>{t.loading=e})},setError:e=>{n(t=>{t.error=e})}})));const m9=()=>{};var QA={};const A4=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},p9=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=n[t++];e[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){const s=n[t++],o=n[t++],a=n[t++],u=((r&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[i++]=String.fromCharCode(55296+(u>>10)),e[i++]=String.fromCharCode(56320+(u&1023))}else{const s=n[t++],o=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return e.join("")},R4={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){const s=n[r],o=r+1<n.length,a=o?n[r+1]:0,u=r+2<n.length,h=u?n[r+2]:0,d=s>>2,g=(s&3)<<4|a>>4;let m=(a&15)<<2|h>>6,v=h&63;u||(v=64,o||(m=64)),i.push(t[d],t[g],t[m],t[v])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(A4(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):p9(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){const s=t[n.charAt(r++)],a=r<n.length?t[n.charAt(r)]:0;++r;const h=r<n.length?t[n.charAt(r)]:64;++r;const g=r<n.length?t[n.charAt(r)]:64;if(++r,s==null||a==null||h==null||g==null)throw new _9;const m=s<<2|a>>4;if(i.push(m),h!==64){const v=a<<4&240|h>>2;if(i.push(v),g!==64){const y=h<<6&192|g;i.push(y)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class _9 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const y9=function(n){const e=A4(n);return R4.encodeByteArray(e,!0)},S0=function(n){return y9(n).replace(/\./g,"")},P4=function(n){try{return R4.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function C4(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const v9=()=>C4().__FIREBASE_DEFAULTS__,E9=()=>{if(typeof process>"u"||typeof QA>"u")return;const n=QA.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},w9=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&P4(n[1]);return e&&JSON.parse(e)},V_=()=>{try{return m9()||v9()||E9()||w9()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},M4=n=>V_()?.emulatorHosts?.[n],b4=n=>{const e=M4(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},k4=()=>V_()?.config,L4=n=>V_()?.[`_${n}`];class x9{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function wu(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Ex(n){return(await fetch(n,{credentials:"include"})).ok}function D4(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",r=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...n};return[S0(JSON.stringify(t)),S0(JSON.stringify(o)),""].join(".")}const uf={};function T9(){const n={prod:[],emulator:[]};for(const e of Object.keys(uf))uf[e]?n.emulator.push(e):n.prod.push(e);return n}function I9(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let JA=!1;function wx(n,e){if(typeof window>"u"||typeof document>"u"||!wu(window.location.host)||uf[n]===e||uf[n]||JA)return;uf[n]=e;function t(m){return`__firebase__banner__${m}`}const i="__firebase__banner",s=T9().prod.length>0;function o(){const m=document.getElementById(i);m&&m.remove()}function a(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function u(m,v){m.setAttribute("width","24"),m.setAttribute("id",v),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function h(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{JA=!0,o()},m}function d(m,v){m.setAttribute("id",v),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function g(){const m=I9(i),v=t("text"),y=document.getElementById(v)||document.createElement("span"),I=t("learnmore"),w=document.getElementById(I)||document.createElement("a"),R=t("preprendIcon"),P=document.getElementById(R)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const b=m.element;a(b),d(w,I);const L=h();u(P,R),b.append(P,y,w,L),document.body.appendChild(b)}s?(y.innerText="Preview backend disconnected.",P.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(P.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,y.innerText="Preview backend running in this workspace."),y.setAttribute("id",v)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",g):g()}function pn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function S9(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(pn())}function N4(){const n=V_()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function A9(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function R9(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function P9(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function C9(){const n=pn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function O4(){return!N4()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function V4(){return!N4()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function F4(){try{return typeof indexedDB=="object"}catch{return!1}}function M9(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{e(r.error?.message||"")}}catch(t){e(t)}})}const b9="FirebaseError";class Os extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=b9,Object.setPrototypeOf(this,Os.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Sg.prototype.create)}}class Sg{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},r=`${this.service}/${e}`,s=this.errors[e],o=s?k9(s,i):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new Os(r,a,i)}}function k9(n,e){return n.replace(L9,(t,i)=>{const r=e[i];return r!=null?String(r):`<${i}?>`})}const L9=/\{\$([^}]+)}/g;function D9(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function ru(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const r of t){if(!i.includes(r))return!1;const s=n[r],o=e[r];if(eR(s)&&eR(o)){if(!ru(s,o))return!1}else if(s!==o)return!1}for(const r of i)if(!t.includes(r))return!1;return!0}function eR(n){return n!==null&&typeof n=="object"}function Ag(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function N9(n,e){const t=new O9(n,e);return t.subscribe.bind(t)}class O9{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let r;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");V9(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:i},r.next===void 0&&(r.next=E1),r.error===void 0&&(r.error=E1),r.complete===void 0&&(r.complete=E1);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function V9(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function E1(){}function ni(n){return n&&n._delegate?n._delegate:n}class La{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Al="[DEFAULT]";class F9{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new x9;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(j9(e))try{this.getOrInitializeService({instanceIdentifier:Al})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(e=Al){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Al){return this.instances.has(e)}getOptions(e=Al){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);i===a&&o.resolve(r)}return r}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(i)??new Set;r.add(e),this.onInitCallbacks.set(i,r);const s=this.instances.get(i);return s&&e(s,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:G9(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Al){return this.component?this.component.multipleInstances?e:Al:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function G9(n){return n===Al?void 0:n}function j9(n){return n.instantiationMode==="EAGER"}class U9{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new F9(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var Je;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Je||(Je={}));const B9={debug:Je.DEBUG,verbose:Je.VERBOSE,info:Je.INFO,warn:Je.WARN,error:Je.ERROR,silent:Je.SILENT},z9=Je.INFO,$9={[Je.DEBUG]:"log",[Je.VERBOSE]:"log",[Je.INFO]:"info",[Je.WARN]:"warn",[Je.ERROR]:"error"},W9=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),r=$9[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class xx{constructor(e){this.name=e,this._logLevel=z9,this._logHandler=W9,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Je))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?B9[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Je.DEBUG,...e),this._logHandler(this,Je.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Je.VERBOSE,...e),this._logHandler(this,Je.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Je.INFO,...e),this._logHandler(this,Je.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Je.WARN,...e),this._logHandler(this,Je.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Je.ERROR,...e),this._logHandler(this,Je.ERROR,...e)}}const K9=(n,e)=>e.some(t=>n instanceof t);let tR,nR;function q9(){return tR||(tR=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function H9(){return nR||(nR=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const G4=new WeakMap,PE=new WeakMap,j4=new WeakMap,w1=new WeakMap,Tx=new WeakMap;function X9(n){const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(Sa(n.result)),r()},o=()=>{i(n.error),r()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&G4.set(t,n)}).catch(()=>{}),Tx.set(e,n),e}function Y9(n){if(PE.has(n))return;const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),r()},o=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});PE.set(n,e)}let CE={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return PE.get(n);if(e==="objectStoreNames")return n.objectStoreNames||j4.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Sa(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Z9(n){CE=n(CE)}function Q9(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(x1(this),e,...t);return j4.set(i,e.sort?e.sort():[e]),Sa(i)}:H9().includes(n)?function(...e){return n.apply(x1(this),e),Sa(G4.get(this))}:function(...e){return Sa(n.apply(x1(this),e))}}function J9(n){return typeof n=="function"?Q9(n):(n instanceof IDBTransaction&&Y9(n),K9(n,q9())?new Proxy(n,CE):n)}function Sa(n){if(n instanceof IDBRequest)return X9(n);if(w1.has(n))return w1.get(n);const e=J9(n);return e!==n&&(w1.set(n,e),Tx.set(e,n)),e}const x1=n=>Tx.get(n);function e7(n,e,{blocked:t,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(n,e),a=Sa(o);return i&&o.addEventListener("upgradeneeded",u=>{i(Sa(o.result),u.oldVersion,u.newVersion,Sa(o.transaction),u)}),t&&o.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),a.then(u=>{s&&u.addEventListener("close",()=>s()),r&&u.addEventListener("versionchange",h=>r(h.oldVersion,h.newVersion,h))}).catch(()=>{}),a}const t7=["get","getKey","getAll","getAllKeys","count"],n7=["put","add","delete","clear"],T1=new Map;function iR(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(T1.get(e))return T1.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,r=n7.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||t7.includes(t)))return;const s=async function(o,...a){const u=this.transaction(o,r?"readwrite":"readonly");let h=u.store;return i&&(h=h.index(a.shift())),(await Promise.all([h[t](...a),r&&u.done]))[0]};return T1.set(e,s),s}Z9(n=>({...n,get:(e,t,i)=>iR(e,t)||n.get(e,t,i),has:(e,t)=>!!iR(e,t)||n.has(e,t)}));class i7{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(r7(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function r7(n){return n.getComponent()?.type==="VERSION"}const ME="@firebase/app",rR="0.14.6";const yo=new xx("@firebase/app"),s7="@firebase/app-compat",o7="@firebase/analytics-compat",a7="@firebase/analytics",l7="@firebase/app-check-compat",u7="@firebase/app-check",c7="@firebase/auth",h7="@firebase/auth-compat",d7="@firebase/database",f7="@firebase/data-connect",g7="@firebase/database-compat",m7="@firebase/functions",p7="@firebase/functions-compat",_7="@firebase/installations",y7="@firebase/installations-compat",v7="@firebase/messaging",E7="@firebase/messaging-compat",w7="@firebase/performance",x7="@firebase/performance-compat",T7="@firebase/remote-config",I7="@firebase/remote-config-compat",S7="@firebase/storage",A7="@firebase/storage-compat",R7="@firebase/firestore",P7="@firebase/ai",C7="@firebase/firestore-compat",M7="firebase",b7="12.6.0";const bE="[DEFAULT]",k7={[ME]:"fire-core",[s7]:"fire-core-compat",[a7]:"fire-analytics",[o7]:"fire-analytics-compat",[u7]:"fire-app-check",[l7]:"fire-app-check-compat",[c7]:"fire-auth",[h7]:"fire-auth-compat",[d7]:"fire-rtdb",[f7]:"fire-data-connect",[g7]:"fire-rtdb-compat",[m7]:"fire-fn",[p7]:"fire-fn-compat",[_7]:"fire-iid",[y7]:"fire-iid-compat",[v7]:"fire-fcm",[E7]:"fire-fcm-compat",[w7]:"fire-perf",[x7]:"fire-perf-compat",[T7]:"fire-rc",[I7]:"fire-rc-compat",[S7]:"fire-gcs",[A7]:"fire-gcs-compat",[R7]:"fire-fst",[C7]:"fire-fst-compat",[P7]:"fire-vertex","fire-js":"fire-js",[M7]:"fire-js-all"};const A0=new Map,L7=new Map,kE=new Map;function sR(n,e){try{n.container.addComponent(e)}catch(t){yo.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function su(n){const e=n.name;if(kE.has(e))return yo.debug(`There were multiple attempts to register component ${e}.`),!1;kE.set(e,n);for(const t of A0.values())sR(t,n);for(const t of L7.values())sR(t,n);return!0}function F_(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Wr(n){return n==null?!1:n.settings!==void 0}const D7={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Aa=new Sg("app","Firebase",D7);class N7{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new La("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Aa.create("app-deleted",{appName:this._name})}}const xu=b7;function U4(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:bE,automaticDataCollectionEnabled:!0,...e},r=i.name;if(typeof r!="string"||!r)throw Aa.create("bad-app-name",{appName:String(r)});if(t||(t=k4()),!t)throw Aa.create("no-options");const s=A0.get(r);if(s){if(ru(t,s.options)&&ru(i,s.config))return s;throw Aa.create("duplicate-app",{appName:r})}const o=new U9(r);for(const u of kE.values())o.addComponent(u);const a=new N7(t,i,o);return A0.set(r,a),a}function Ix(n=bE){const e=A0.get(n);if(!e&&n===bE&&k4())return U4();if(!e)throw Aa.create("no-app",{appName:n});return e}function Ss(n,e,t){let i=k7[n]??n;t&&(i+=`-${t}`);const r=i.match(/\s|\//),s=e.match(/\s|\//);if(r||s){const o=[`Unable to register library "${i}" with version "${e}":`];r&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),yo.warn(o.join(" "));return}su(new La(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const O7="firebase-heartbeat-database",V7=1,zf="firebase-heartbeat-store";let I1=null;function B4(){return I1||(I1=e7(O7,V7,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(zf)}catch(t){console.warn(t)}}}}).catch(n=>{throw Aa.create("idb-open",{originalErrorMessage:n.message})})),I1}async function F7(n){try{const t=(await B4()).transaction(zf),i=await t.objectStore(zf).get(z4(n));return await t.done,i}catch(e){if(e instanceof Os)yo.warn(e.message);else{const t=Aa.create("idb-get",{originalErrorMessage:e?.message});yo.warn(t.message)}}}async function oR(n,e){try{const i=(await B4()).transaction(zf,"readwrite");await i.objectStore(zf).put(e,z4(n)),await i.done}catch(t){if(t instanceof Os)yo.warn(t.message);else{const i=Aa.create("idb-set",{originalErrorMessage:t?.message});yo.warn(i.message)}}}function z4(n){return`${n.name}!${n.options.appId}`}const G7=1024,j7=30;class U7{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new z7(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=aR();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(r=>r.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>j7){const r=$7(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(r,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){yo.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=aR(),{heartbeatsToSend:t,unsentEntries:i}=B7(this._heartbeatsCache.heartbeats),r=S0(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(e){return yo.warn(e),""}}}function aR(){return new Date().toISOString().substring(0,10)}function B7(n,e=G7){const t=[];let i=n.slice();for(const r of n){const s=t.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),lR(t)>e){s.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),lR(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class z7{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return F4()?M9().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await F7(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return oR(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return oR(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function lR(n){return S0(JSON.stringify({version:2,heartbeats:n})).length}function $7(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}function W7(n){su(new La("platform-logger",e=>new i7(e),"PRIVATE")),su(new La("heartbeat",e=>new U7(e),"PRIVATE")),Ss(ME,rR,n),Ss(ME,rR,"esm2020"),Ss("fire-js","")}W7("");var uR=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Ra,$4;(function(){var n;function e(M,A){function k(){}k.prototype=A.prototype,M.F=A.prototype,M.prototype=new k,M.prototype.constructor=M,M.D=function(F,G,U){for(var N=Array(arguments.length-2),ue=2;ue<arguments.length;ue++)N[ue-2]=arguments[ue];return A.prototype[G].apply(F,N)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(M,A,k){k||(k=0);const F=Array(16);if(typeof A=="string")for(var G=0;G<16;++G)F[G]=A.charCodeAt(k++)|A.charCodeAt(k++)<<8|A.charCodeAt(k++)<<16|A.charCodeAt(k++)<<24;else for(G=0;G<16;++G)F[G]=A[k++]|A[k++]<<8|A[k++]<<16|A[k++]<<24;A=M.g[0],k=M.g[1],G=M.g[2];let U=M.g[3],N;N=A+(U^k&(G^U))+F[0]+3614090360&4294967295,A=k+(N<<7&4294967295|N>>>25),N=U+(G^A&(k^G))+F[1]+3905402710&4294967295,U=A+(N<<12&4294967295|N>>>20),N=G+(k^U&(A^k))+F[2]+606105819&4294967295,G=U+(N<<17&4294967295|N>>>15),N=k+(A^G&(U^A))+F[3]+3250441966&4294967295,k=G+(N<<22&4294967295|N>>>10),N=A+(U^k&(G^U))+F[4]+4118548399&4294967295,A=k+(N<<7&4294967295|N>>>25),N=U+(G^A&(k^G))+F[5]+1200080426&4294967295,U=A+(N<<12&4294967295|N>>>20),N=G+(k^U&(A^k))+F[6]+2821735955&4294967295,G=U+(N<<17&4294967295|N>>>15),N=k+(A^G&(U^A))+F[7]+4249261313&4294967295,k=G+(N<<22&4294967295|N>>>10),N=A+(U^k&(G^U))+F[8]+1770035416&4294967295,A=k+(N<<7&4294967295|N>>>25),N=U+(G^A&(k^G))+F[9]+2336552879&4294967295,U=A+(N<<12&4294967295|N>>>20),N=G+(k^U&(A^k))+F[10]+4294925233&4294967295,G=U+(N<<17&4294967295|N>>>15),N=k+(A^G&(U^A))+F[11]+2304563134&4294967295,k=G+(N<<22&4294967295|N>>>10),N=A+(U^k&(G^U))+F[12]+1804603682&4294967295,A=k+(N<<7&4294967295|N>>>25),N=U+(G^A&(k^G))+F[13]+4254626195&4294967295,U=A+(N<<12&4294967295|N>>>20),N=G+(k^U&(A^k))+F[14]+2792965006&4294967295,G=U+(N<<17&4294967295|N>>>15),N=k+(A^G&(U^A))+F[15]+1236535329&4294967295,k=G+(N<<22&4294967295|N>>>10),N=A+(G^U&(k^G))+F[1]+4129170786&4294967295,A=k+(N<<5&4294967295|N>>>27),N=U+(k^G&(A^k))+F[6]+3225465664&4294967295,U=A+(N<<9&4294967295|N>>>23),N=G+(A^k&(U^A))+F[11]+643717713&4294967295,G=U+(N<<14&4294967295|N>>>18),N=k+(U^A&(G^U))+F[0]+3921069994&4294967295,k=G+(N<<20&4294967295|N>>>12),N=A+(G^U&(k^G))+F[5]+3593408605&4294967295,A=k+(N<<5&4294967295|N>>>27),N=U+(k^G&(A^k))+F[10]+38016083&4294967295,U=A+(N<<9&4294967295|N>>>23),N=G+(A^k&(U^A))+F[15]+3634488961&4294967295,G=U+(N<<14&4294967295|N>>>18),N=k+(U^A&(G^U))+F[4]+3889429448&4294967295,k=G+(N<<20&4294967295|N>>>12),N=A+(G^U&(k^G))+F[9]+568446438&4294967295,A=k+(N<<5&4294967295|N>>>27),N=U+(k^G&(A^k))+F[14]+3275163606&4294967295,U=A+(N<<9&4294967295|N>>>23),N=G+(A^k&(U^A))+F[3]+4107603335&4294967295,G=U+(N<<14&4294967295|N>>>18),N=k+(U^A&(G^U))+F[8]+1163531501&4294967295,k=G+(N<<20&4294967295|N>>>12),N=A+(G^U&(k^G))+F[13]+2850285829&4294967295,A=k+(N<<5&4294967295|N>>>27),N=U+(k^G&(A^k))+F[2]+4243563512&4294967295,U=A+(N<<9&4294967295|N>>>23),N=G+(A^k&(U^A))+F[7]+1735328473&4294967295,G=U+(N<<14&4294967295|N>>>18),N=k+(U^A&(G^U))+F[12]+2368359562&4294967295,k=G+(N<<20&4294967295|N>>>12),N=A+(k^G^U)+F[5]+4294588738&4294967295,A=k+(N<<4&4294967295|N>>>28),N=U+(A^k^G)+F[8]+2272392833&4294967295,U=A+(N<<11&4294967295|N>>>21),N=G+(U^A^k)+F[11]+1839030562&4294967295,G=U+(N<<16&4294967295|N>>>16),N=k+(G^U^A)+F[14]+4259657740&4294967295,k=G+(N<<23&4294967295|N>>>9),N=A+(k^G^U)+F[1]+2763975236&4294967295,A=k+(N<<4&4294967295|N>>>28),N=U+(A^k^G)+F[4]+1272893353&4294967295,U=A+(N<<11&4294967295|N>>>21),N=G+(U^A^k)+F[7]+4139469664&4294967295,G=U+(N<<16&4294967295|N>>>16),N=k+(G^U^A)+F[10]+3200236656&4294967295,k=G+(N<<23&4294967295|N>>>9),N=A+(k^G^U)+F[13]+681279174&4294967295,A=k+(N<<4&4294967295|N>>>28),N=U+(A^k^G)+F[0]+3936430074&4294967295,U=A+(N<<11&4294967295|N>>>21),N=G+(U^A^k)+F[3]+3572445317&4294967295,G=U+(N<<16&4294967295|N>>>16),N=k+(G^U^A)+F[6]+76029189&4294967295,k=G+(N<<23&4294967295|N>>>9),N=A+(k^G^U)+F[9]+3654602809&4294967295,A=k+(N<<4&4294967295|N>>>28),N=U+(A^k^G)+F[12]+3873151461&4294967295,U=A+(N<<11&4294967295|N>>>21),N=G+(U^A^k)+F[15]+530742520&4294967295,G=U+(N<<16&4294967295|N>>>16),N=k+(G^U^A)+F[2]+3299628645&4294967295,k=G+(N<<23&4294967295|N>>>9),N=A+(G^(k|~U))+F[0]+4096336452&4294967295,A=k+(N<<6&4294967295|N>>>26),N=U+(k^(A|~G))+F[7]+1126891415&4294967295,U=A+(N<<10&4294967295|N>>>22),N=G+(A^(U|~k))+F[14]+2878612391&4294967295,G=U+(N<<15&4294967295|N>>>17),N=k+(U^(G|~A))+F[5]+4237533241&4294967295,k=G+(N<<21&4294967295|N>>>11),N=A+(G^(k|~U))+F[12]+1700485571&4294967295,A=k+(N<<6&4294967295|N>>>26),N=U+(k^(A|~G))+F[3]+2399980690&4294967295,U=A+(N<<10&4294967295|N>>>22),N=G+(A^(U|~k))+F[10]+4293915773&4294967295,G=U+(N<<15&4294967295|N>>>17),N=k+(U^(G|~A))+F[1]+2240044497&4294967295,k=G+(N<<21&4294967295|N>>>11),N=A+(G^(k|~U))+F[8]+1873313359&4294967295,A=k+(N<<6&4294967295|N>>>26),N=U+(k^(A|~G))+F[15]+4264355552&4294967295,U=A+(N<<10&4294967295|N>>>22),N=G+(A^(U|~k))+F[6]+2734768916&4294967295,G=U+(N<<15&4294967295|N>>>17),N=k+(U^(G|~A))+F[13]+1309151649&4294967295,k=G+(N<<21&4294967295|N>>>11),N=A+(G^(k|~U))+F[4]+4149444226&4294967295,A=k+(N<<6&4294967295|N>>>26),N=U+(k^(A|~G))+F[11]+3174756917&4294967295,U=A+(N<<10&4294967295|N>>>22),N=G+(A^(U|~k))+F[2]+718787259&4294967295,G=U+(N<<15&4294967295|N>>>17),N=k+(U^(G|~A))+F[9]+3951481745&4294967295,M.g[0]=M.g[0]+A&4294967295,M.g[1]=M.g[1]+(G+(N<<21&4294967295|N>>>11))&4294967295,M.g[2]=M.g[2]+G&4294967295,M.g[3]=M.g[3]+U&4294967295}i.prototype.v=function(M,A){A===void 0&&(A=M.length);const k=A-this.blockSize,F=this.C;let G=this.h,U=0;for(;U<A;){if(G==0)for(;U<=k;)r(this,M,U),U+=this.blockSize;if(typeof M=="string"){for(;U<A;)if(F[G++]=M.charCodeAt(U++),G==this.blockSize){r(this,F),G=0;break}}else for(;U<A;)if(F[G++]=M[U++],G==this.blockSize){r(this,F),G=0;break}}this.h=G,this.o+=A},i.prototype.A=function(){var M=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);M[0]=128;for(var A=1;A<M.length-8;++A)M[A]=0;A=this.o*8;for(var k=M.length-8;k<M.length;++k)M[k]=A&255,A/=256;for(this.v(M),M=Array(16),A=0,k=0;k<4;++k)for(let F=0;F<32;F+=8)M[A++]=this.g[k]>>>F&255;return M};function s(M,A){var k=a;return Object.prototype.hasOwnProperty.call(k,M)?k[M]:k[M]=A(M)}function o(M,A){this.h=A;const k=[];let F=!0;for(let G=M.length-1;G>=0;G--){const U=M[G]|0;F&&U==A||(k[G]=U,F=!1)}this.g=k}var a={};function u(M){return-128<=M&&M<128?s(M,function(A){return new o([A|0],A<0?-1:0)}):new o([M|0],M<0?-1:0)}function h(M){if(isNaN(M)||!isFinite(M))return g;if(M<0)return w(h(-M));const A=[];let k=1;for(let F=0;M>=k;F++)A[F]=M/k|0,k*=4294967296;return new o(A,0)}function d(M,A){if(M.length==0)throw Error("number format error: empty string");if(A=A||10,A<2||36<A)throw Error("radix out of range: "+A);if(M.charAt(0)=="-")return w(d(M.substring(1),A));if(M.indexOf("-")>=0)throw Error('number format error: interior "-" character');const k=h(Math.pow(A,8));let F=g;for(let U=0;U<M.length;U+=8){var G=Math.min(8,M.length-U);const N=parseInt(M.substring(U,U+G),A);G<8?(G=h(Math.pow(A,G)),F=F.j(G).add(h(N))):(F=F.j(k),F=F.add(h(N)))}return F}var g=u(0),m=u(1),v=u(16777216);n=o.prototype,n.m=function(){if(I(this))return-w(this).m();let M=0,A=1;for(let k=0;k<this.g.length;k++){const F=this.i(k);M+=(F>=0?F:4294967296+F)*A,A*=4294967296}return M},n.toString=function(M){if(M=M||10,M<2||36<M)throw Error("radix out of range: "+M);if(y(this))return"0";if(I(this))return"-"+w(this).toString(M);const A=h(Math.pow(M,6));var k=this;let F="";for(;;){const G=L(k,A).g;k=R(k,G.j(A));let U=((k.g.length>0?k.g[0]:k.h)>>>0).toString(M);if(k=G,y(k))return U+F;for(;U.length<6;)U="0"+U;F=U+F}},n.i=function(M){return M<0?0:M<this.g.length?this.g[M]:this.h};function y(M){if(M.h!=0)return!1;for(let A=0;A<M.g.length;A++)if(M.g[A]!=0)return!1;return!0}function I(M){return M.h==-1}n.l=function(M){return M=R(this,M),I(M)?-1:y(M)?0:1};function w(M){const A=M.g.length,k=[];for(let F=0;F<A;F++)k[F]=~M.g[F];return new o(k,~M.h).add(m)}n.abs=function(){return I(this)?w(this):this},n.add=function(M){const A=Math.max(this.g.length,M.g.length),k=[];let F=0;for(let G=0;G<=A;G++){let U=F+(this.i(G)&65535)+(M.i(G)&65535),N=(U>>>16)+(this.i(G)>>>16)+(M.i(G)>>>16);F=N>>>16,U&=65535,N&=65535,k[G]=N<<16|U}return new o(k,k[k.length-1]&-2147483648?-1:0)};function R(M,A){return M.add(w(A))}n.j=function(M){if(y(this)||y(M))return g;if(I(this))return I(M)?w(this).j(w(M)):w(w(this).j(M));if(I(M))return w(this.j(w(M)));if(this.l(v)<0&&M.l(v)<0)return h(this.m()*M.m());const A=this.g.length+M.g.length,k=[];for(var F=0;F<2*A;F++)k[F]=0;for(F=0;F<this.g.length;F++)for(let G=0;G<M.g.length;G++){const U=this.i(F)>>>16,N=this.i(F)&65535,ue=M.i(G)>>>16,we=M.i(G)&65535;k[2*F+2*G]+=N*we,P(k,2*F+2*G),k[2*F+2*G+1]+=U*we,P(k,2*F+2*G+1),k[2*F+2*G+1]+=N*ue,P(k,2*F+2*G+1),k[2*F+2*G+2]+=U*ue,P(k,2*F+2*G+2)}for(M=0;M<A;M++)k[M]=k[2*M+1]<<16|k[2*M];for(M=A;M<2*A;M++)k[M]=0;return new o(k,0)};function P(M,A){for(;(M[A]&65535)!=M[A];)M[A+1]+=M[A]>>>16,M[A]&=65535,A++}function b(M,A){this.g=M,this.h=A}function L(M,A){if(y(A))throw Error("division by zero");if(y(M))return new b(g,g);if(I(M))return A=L(w(M),A),new b(w(A.g),w(A.h));if(I(A))return A=L(M,w(A)),new b(w(A.g),A.h);if(M.g.length>30){if(I(M)||I(A))throw Error("slowDivide_ only works with positive integers.");for(var k=m,F=A;F.l(M)<=0;)k=D(k),F=D(F);var G=B(k,1),U=B(F,1);for(F=B(F,2),k=B(k,2);!y(F);){var N=U.add(F);N.l(M)<=0&&(G=G.add(k),U=N),F=B(F,1),k=B(k,1)}return A=R(M,G.j(A)),new b(G,A)}for(G=g;M.l(A)>=0;){for(k=Math.max(1,Math.floor(M.m()/A.m())),F=Math.ceil(Math.log(k)/Math.LN2),F=F<=48?1:Math.pow(2,F-48),U=h(k),N=U.j(A);I(N)||N.l(M)>0;)k-=F,U=h(k),N=U.j(A);y(U)&&(U=m),G=G.add(U),M=R(M,N)}return new b(G,M)}n.B=function(M){return L(this,M).h},n.and=function(M){const A=Math.max(this.g.length,M.g.length),k=[];for(let F=0;F<A;F++)k[F]=this.i(F)&M.i(F);return new o(k,this.h&M.h)},n.or=function(M){const A=Math.max(this.g.length,M.g.length),k=[];for(let F=0;F<A;F++)k[F]=this.i(F)|M.i(F);return new o(k,this.h|M.h)},n.xor=function(M){const A=Math.max(this.g.length,M.g.length),k=[];for(let F=0;F<A;F++)k[F]=this.i(F)^M.i(F);return new o(k,this.h^M.h)};function D(M){const A=M.g.length+1,k=[];for(let F=0;F<A;F++)k[F]=M.i(F)<<1|M.i(F-1)>>>31;return new o(k,M.h)}function B(M,A){const k=A>>5;A%=32;const F=M.g.length-k,G=[];for(let U=0;U<F;U++)G[U]=A>0?M.i(U+k)>>>A|M.i(U+k+1)<<32-A:M.i(U+k);return new o(G,M.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,$4=i,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=d,Ra=o}).apply(typeof uR<"u"?uR:typeof self<"u"?self:typeof window<"u"?window:{});var pp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var W4,Xd,K4,Np,LE,q4,H4,X4;(function(){var n,e=Object.defineProperty;function t(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof pp=="object"&&pp];for(var T=0;T<p.length;++T){var S=p[T];if(S&&S.Math==Math)return S}throw Error("Cannot find global object")}var i=t(this);function r(p,T){if(T)e:{var S=i;p=p.split(".");for(var O=0;O<p.length-1;O++){var X=p[O];if(!(X in S))break e;S=S[X]}p=p[p.length-1],O=S[p],T=T(O),T!=O&&T!=null&&e(S,p,{configurable:!0,writable:!0,value:T})}}r("Symbol.dispose",function(p){return p||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(p){return p||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(p){return p||function(T){var S=[],O;for(O in T)Object.prototype.hasOwnProperty.call(T,O)&&S.push([O,T[O]]);return S}});var s=s||{},o=this||self;function a(p){var T=typeof p;return T=="object"&&p!=null||T=="function"}function u(p,T,S){return p.call.apply(p.bind,arguments)}function h(p,T,S){return h=u,h.apply(null,arguments)}function d(p,T){var S=Array.prototype.slice.call(arguments,1);return function(){var O=S.slice();return O.push.apply(O,arguments),p.apply(this,O)}}function g(p,T){function S(){}S.prototype=T.prototype,p.Z=T.prototype,p.prototype=new S,p.prototype.constructor=p,p.Ob=function(O,X,Q){for(var fe=Array(arguments.length-2),qe=2;qe<arguments.length;qe++)fe[qe-2]=arguments[qe];return T.prototype[X].apply(O,fe)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?p=>p&&AsyncContext.Snapshot.wrap(p):p=>p;function v(p){const T=p.length;if(T>0){const S=Array(T);for(let O=0;O<T;O++)S[O]=p[O];return S}return[]}function y(p,T){for(let O=1;O<arguments.length;O++){const X=arguments[O];var S=typeof X;if(S=S!="object"?S:X?Array.isArray(X)?"array":S:"null",S=="array"||S=="object"&&typeof X.length=="number"){S=p.length||0;const Q=X.length||0;p.length=S+Q;for(let fe=0;fe<Q;fe++)p[S+fe]=X[fe]}else p.push(X)}}class I{constructor(T,S){this.i=T,this.j=S,this.h=0,this.g=null}get(){let T;return this.h>0?(this.h--,T=this.g,this.g=T.next,T.next=null):T=this.i(),T}}function w(p){o.setTimeout(()=>{throw p},0)}function R(){var p=M;let T=null;return p.g&&(T=p.g,p.g=p.g.next,p.g||(p.h=null),T.next=null),T}class P{constructor(){this.h=this.g=null}add(T,S){const O=b.get();O.set(T,S),this.h?this.h.next=O:this.g=O,this.h=O}}var b=new I(()=>new L,p=>p.reset());class L{constructor(){this.next=this.g=this.h=null}set(T,S){this.h=T,this.g=S,this.next=null}reset(){this.next=this.g=this.h=null}}let D,B=!1,M=new P,A=()=>{const p=Promise.resolve(void 0);D=()=>{p.then(k)}};function k(){for(var p;p=R();){try{p.h.call(p.g)}catch(S){w(S)}var T=b;T.j(p),T.h<100&&(T.h++,p.next=T.g,T.g=p)}B=!1}function F(){this.u=this.u,this.C=this.C}F.prototype.u=!1,F.prototype.dispose=function(){this.u||(this.u=!0,this.N())},F.prototype[Symbol.dispose]=function(){this.dispose()},F.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function G(p,T){this.type=p,this.g=this.target=T,this.defaultPrevented=!1}G.prototype.h=function(){this.defaultPrevented=!0};var U=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var p=!1,T=Object.defineProperty({},"passive",{get:function(){p=!0}});try{const S=()=>{};o.addEventListener("test",S,T),o.removeEventListener("test",S,T)}catch{}return p})();function N(p){return/^[\s\xa0]*$/.test(p)}function ue(p,T){G.call(this,p?p.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,p&&this.init(p,T)}g(ue,G),ue.prototype.init=function(p,T){const S=this.type=p.type,O=p.changedTouches&&p.changedTouches.length?p.changedTouches[0]:null;this.target=p.target||p.srcElement,this.g=T,T=p.relatedTarget,T||(S=="mouseover"?T=p.fromElement:S=="mouseout"&&(T=p.toElement)),this.relatedTarget=T,O?(this.clientX=O.clientX!==void 0?O.clientX:O.pageX,this.clientY=O.clientY!==void 0?O.clientY:O.pageY,this.screenX=O.screenX||0,this.screenY=O.screenY||0):(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0),this.button=p.button,this.key=p.key||"",this.ctrlKey=p.ctrlKey,this.altKey=p.altKey,this.shiftKey=p.shiftKey,this.metaKey=p.metaKey,this.pointerId=p.pointerId||0,this.pointerType=p.pointerType,this.state=p.state,this.i=p,p.defaultPrevented&&ue.Z.h.call(this)},ue.prototype.h=function(){ue.Z.h.call(this);const p=this.i;p.preventDefault?p.preventDefault():p.returnValue=!1};var we="closure_listenable_"+(Math.random()*1e6|0),ye=0;function de(p,T,S,O,X){this.listener=p,this.proxy=null,this.src=T,this.type=S,this.capture=!!O,this.ha=X,this.key=++ye,this.da=this.fa=!1}function J(p){p.da=!0,p.listener=null,p.proxy=null,p.src=null,p.ha=null}function ae(p,T,S){for(const O in p)T.call(S,p[O],O,p)}function ie(p,T){for(const S in p)T.call(void 0,p[S],S,p)}function $(p){const T={};for(const S in p)T[S]=p[S];return T}const K="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ae(p,T){let S,O;for(let X=1;X<arguments.length;X++){O=arguments[X];for(S in O)p[S]=O[S];for(let Q=0;Q<K.length;Q++)S=K[Q],Object.prototype.hasOwnProperty.call(O,S)&&(p[S]=O[S])}}function Re(p){this.src=p,this.g={},this.h=0}Re.prototype.add=function(p,T,S,O,X){const Q=p.toString();p=this.g[Q],p||(p=this.g[Q]=[],this.h++);const fe=Oe(p,T,O,X);return fe>-1?(T=p[fe],S||(T.fa=!1)):(T=new de(T,this.src,Q,!!O,X),T.fa=S,p.push(T)),T};function Pe(p,T){const S=T.type;if(S in p.g){var O=p.g[S],X=Array.prototype.indexOf.call(O,T,void 0),Q;(Q=X>=0)&&Array.prototype.splice.call(O,X,1),Q&&(J(T),p.g[S].length==0&&(delete p.g[S],p.h--))}}function Oe(p,T,S,O){for(let X=0;X<p.length;++X){const Q=p[X];if(!Q.da&&Q.listener==T&&Q.capture==!!S&&Q.ha==O)return X}return-1}var Fe="closure_lm_"+(Math.random()*1e6|0),Ke={};function Ye(p,T,S,O,X){if(Array.isArray(T)){for(let Q=0;Q<T.length;Q++)Ye(p,T[Q],S,O,X);return null}return S=er(S),p&&p[we]?p.J(T,S,a(O)?!!O.capture:!1,X):yt(p,T,S,!1,O,X)}function yt(p,T,S,O,X,Q){if(!T)throw Error("Invalid event type");const fe=a(X)?!!X.capture:!!X;let qe=Rn(p);if(qe||(p[Fe]=qe=new Re(p)),S=qe.add(T,S,O,fe,Q),S.proxy)return S;if(O=Rr(),S.proxy=O,O.src=p,O.listener=S,p.addEventListener)U||(X=fe),X===void 0&&(X=!1),p.addEventListener(T.toString(),O,X);else if(p.attachEvent)p.attachEvent(mi(T.toString()),O);else if(p.addListener&&p.removeListener)p.addListener(O);else throw Error("addEventListener and attachEvent are unavailable.");return S}function Rr(){function p(S){return T.call(p.src,p.listener,S)}const T=An;return p}function Fs(p,T,S,O,X){if(Array.isArray(T))for(var Q=0;Q<T.length;Q++)Fs(p,T[Q],S,O,X);else O=a(O)?!!O.capture:!!O,S=er(S),p&&p[we]?(p=p.i,Q=String(T).toString(),Q in p.g&&(T=p.g[Q],S=Oe(T,S,O,X),S>-1&&(J(T[S]),Array.prototype.splice.call(T,S,1),T.length==0&&(delete p.g[Q],p.h--)))):p&&(p=Rn(p))&&(T=p.g[T.toString()],p=-1,T&&(p=Oe(T,S,O,X)),(S=p>-1?T[p]:null)&&gi(S))}function gi(p){if(typeof p!="number"&&p&&!p.da){var T=p.src;if(T&&T[we])Pe(T.i,p);else{var S=p.type,O=p.proxy;T.removeEventListener?T.removeEventListener(S,O,p.capture):T.detachEvent?T.detachEvent(mi(S),O):T.addListener&&T.removeListener&&T.removeListener(O),(S=Rn(T))?(Pe(S,p),S.h==0&&(S.src=null,T[Fe]=null)):J(p)}}}function mi(p){return p in Ke?Ke[p]:Ke[p]="on"+p}function An(p,T){if(p.da)p=!0;else{T=new ue(T,this);const S=p.listener,O=p.ha||p.src;p.fa&&gi(p),p=S.call(O,T)}return p}function Rn(p){return p=p[Fe],p instanceof Re?p:null}var pi="__closure_events_fn_"+(Math.random()*1e9>>>0);function er(p){return typeof p=="function"?p:(p[pi]||(p[pi]=function(T){return p.handleEvent(T)}),p[pi])}function Rt(){F.call(this),this.i=new Re(this),this.M=this,this.G=null}g(Rt,F),Rt.prototype[we]=!0,Rt.prototype.removeEventListener=function(p,T,S,O){Fs(this,p,T,S,O)};function vt(p,T){var S,O=p.G;if(O)for(S=[];O;O=O.G)S.push(O);if(p=p.M,O=T.type||T,typeof T=="string")T=new G(T,p);else if(T instanceof G)T.target=T.target||p;else{var X=T;T=new G(O,p),Ae(T,X)}X=!0;let Q,fe;if(S)for(fe=S.length-1;fe>=0;fe--)Q=T.g=S[fe],X=yn(Q,O,!0,T)&&X;if(Q=T.g=p,X=yn(Q,O,!0,T)&&X,X=yn(Q,O,!1,T)&&X,S)for(fe=0;fe<S.length;fe++)Q=T.g=S[fe],X=yn(Q,O,!1,T)&&X}Rt.prototype.N=function(){if(Rt.Z.N.call(this),this.i){var p=this.i;for(const T in p.g){const S=p.g[T];for(let O=0;O<S.length;O++)J(S[O]);delete p.g[T],p.h--}}this.G=null},Rt.prototype.J=function(p,T,S,O){return this.i.add(String(p),T,!1,S,O)},Rt.prototype.K=function(p,T,S,O){return this.i.add(String(p),T,!0,S,O)};function yn(p,T,S,O){if(T=p.i.g[String(T)],!T)return!0;T=T.concat();let X=!0;for(let Q=0;Q<T.length;++Q){const fe=T[Q];if(fe&&!fe.da&&fe.capture==S){const qe=fe.listener,Qt=fe.ha||fe.src;fe.fa&&Pe(p.i,fe),X=qe.call(Qt,O)!==!1&&X}}return X&&!O.defaultPrevented}function tr(p,T){if(typeof p!="function")if(p&&typeof p.handleEvent=="function")p=h(p.handleEvent,p);else throw Error("Invalid listener argument");return Number(T)>2147483647?-1:o.setTimeout(p,T||0)}function Dt(p){p.g=tr(()=>{p.g=null,p.i&&(p.i=!1,Dt(p))},p.l);const T=p.h;p.h=null,p.m.apply(null,T)}class Co extends F{constructor(T,S){super(),this.m=T,this.l=S,this.h=null,this.i=!1,this.g=null}j(T){this.h=arguments,this.g?this.i=!0:Dt(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function nr(p){F.call(this),this.h=p,this.g={}}g(nr,F);var Zr=[];function Pr(p){ae(p.g,function(T,S){this.g.hasOwnProperty(S)&&gi(T)},p),p.g={}}nr.prototype.N=function(){nr.Z.N.call(this),Pr(this)},nr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Qr=o.JSON.stringify,Xa=o.JSON.parse,Jr=class{stringify(p){return o.JSON.stringify(p,void 0)}parse(p){return o.JSON.parse(p,void 0)}};function ir(){}function Au(){}var es={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Gs(){G.call(this,"d")}g(Gs,G);function Mo(){G.call(this,"c")}g(Mo,G);var ii={},js=null;function ts(){return js=js||new Rt}ii.Ia="serverreachability";function ns(p){G.call(this,ii.Ia,p)}g(ns,G);function ri(p){const T=ts();vt(T,new ns(T))}ii.STAT_EVENT="statevent";function si(p,T){G.call(this,ii.STAT_EVENT,p),this.stat=T}g(si,G);function St(p){const T=ts();vt(T,new si(T,p))}ii.Ja="timingevent";function bo(p,T){G.call(this,ii.Ja,p),this.size=T}g(bo,G);function Cr(p,T){if(typeof p!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){p()},T)}function Yt(){this.g=!0}Yt.prototype.ua=function(){this.g=!1};function rr(p,T,S,O,X,Q){p.info(function(){if(p.g)if(Q){var fe="",qe=Q.split("&");for(let Et=0;Et<qe.length;Et++){var Qt=qe[Et].split("=");if(Qt.length>1){const sn=Qt[0];Qt=Qt[1];const Gi=sn.split("_");fe=Gi.length>=2&&Gi[1]=="type"?fe+(sn+"="+Qt+"&"):fe+(sn+"=redacted&")}}}else fe=null;else fe=Q;return"XMLHTTP REQ ("+O+") [attempt "+X+"]: "+T+`
`+S+`
`+fe})}function Pn(p,T,S,O,X,Q,fe){p.info(function(){return"XMLHTTP RESP ("+O+") [ attempt "+X+"]: "+T+`
`+S+`
`+Q+" "+fe})}function Zt(p,T,S,O){p.info(function(){return"XMLHTTP TEXT ("+T+"): "+Mn(p,S)+(O?" "+O:"")})}function Cn(p,T){p.info(function(){return"TIMEOUT: "+T})}Yt.prototype.info=function(){};function Mn(p,T){if(!p.g)return T;if(!T)return null;try{const Q=JSON.parse(T);if(Q){for(p=0;p<Q.length;p++)if(Array.isArray(Q[p])){var S=Q[p];if(!(S.length<2)){var O=S[1];if(Array.isArray(O)&&!(O.length<1)){var X=O[0];if(X!="noop"&&X!="stop"&&X!="close")for(let fe=1;fe<O.length;fe++)O[fe]=""}}}}return Qr(Q)}catch{return T}}var vn={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},ht={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},rn;function cn(){}g(cn,ir),cn.prototype.g=function(){return new XMLHttpRequest},rn=new cn;function sr(p){return encodeURIComponent(String(p))}function Ru(p){var T=1;p=p.split(":");const S=[];for(;T>0&&p.length;)S.push(p.shift()),T--;return p.length&&S.push(p.join(":")),S}function or(p,T,S,O){this.j=p,this.i=T,this.l=S,this.S=O||1,this.V=new nr(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Xg}function Xg(){this.i=null,this.g="",this.h=!1}var Yg={},Uh={};function Mr(p,T,S){p.M=1,p.A=Bs(ar(T)),p.u=S,p.R=!0,Bh(p,null)}function Bh(p,T){p.F=Date.now(),Ya(p),p.B=ar(p.A);var S=p.B,O=p.S;Array.isArray(O)||(O=[String(O)]),Qh(S.i,"t",O),p.C=0,S=p.j.L,p.h=new Xg,p.g=om(p.j,S?T:null,!p.u),p.P>0&&(p.O=new Co(h(p.Y,p,p.g),p.P)),T=p.V,S=p.g,O=p.ba;var X="readystatechange";Array.isArray(X)||(X&&(Zr[0]=X.toString()),X=Zr);for(let Q=0;Q<X.length;Q++){const fe=Ye(S,X[Q],O||T.handleEvent,!1,T.h||T);if(!fe)break;T.g[fe.key]=fe}T=p.J?$(p.J):{},p.u?(p.v||(p.v="POST"),T["Content-Type"]="application/x-www-form-urlencoded",p.g.ea(p.B,p.v,p.u,T)):(p.v="GET",p.g.ea(p.B,p.v,null,T)),ri(),rr(p.i,p.v,p.B,p.l,p.S,p.u)}or.prototype.ba=function(p){p=p.target;const T=this.O;T&&us(p)==3?T.j():this.Y(p)},or.prototype.Y=function(p){try{if(p==this.g)e:{const qe=us(this.g),Qt=this.g.ya(),Et=this.g.ca();if(!(qe<3)&&(qe!=3||this.g&&(this.h.h||this.g.la()||rm(this.g)))){this.K||qe!=4||Qt==7||(Qt==8||Et<=0?ri(3):ri(2)),Pu(this);var T=this.g.ca();this.X=T;var S=Zg(this);if(this.o=T==200,Pn(this.i,this.v,this.B,this.l,this.S,qe,T),this.o){if(this.U&&!this.L){t:{if(this.g){var O,X=this.g;if((O=X.g?X.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!N(O)){var Q=O;break t}}Q=null}if(p=Q)Zt(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Ct(this,p);else{this.o=!1,this.m=3,St(12),Us(this),Za(this);break e}}if(this.R){p=!0;let sn;for(;!this.K&&this.C<S.length;)if(sn=Jg(this,S),sn==Uh){qe==4&&(this.m=4,St(14),p=!1),Zt(this.i,this.l,null,"[Incomplete Response]");break}else if(sn==Yg){this.m=4,St(15),Zt(this.i,this.l,S,"[Invalid Chunk]"),p=!1;break}else Zt(this.i,this.l,sn,null),Ct(this,sn);if(Qg(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),qe!=4||S.length!=0||this.h.h||(this.m=1,St(16),p=!1),this.o=this.o&&p,!p)Zt(this.i,this.l,S,"[Invalid Chunked Response]"),Us(this),Za(this);else if(S.length>0&&!this.W){this.W=!0;var fe=this.j;fe.g==this&&fe.aa&&!fe.P&&(fe.j.info("Great, no buffering proxy detected. Bytes received: "+S.length),ol(fe),fe.P=!0,St(11))}}else Zt(this.i,this.l,S,null),Ct(this,S);qe==4&&Us(this),this.o&&!this.K&&(qe==4?Fu(this.j,this):(this.o=!1,Ya(this)))}else ed(this.g),T==400&&S.indexOf("Unknown SID")>0?(this.m=3,St(12)):(this.m=0,St(13)),Us(this),Za(this)}}}catch{}};function Zg(p){if(!Qg(p))return p.g.la();const T=rm(p.g);if(T==="")return"";let S="";const O=T.length,X=us(p.g)==4;if(!p.h.i){if(typeof TextDecoder>"u")return Us(p),Za(p),"";p.h.i=new o.TextDecoder}for(let Q=0;Q<O;Q++)p.h.h=!0,S+=p.h.i.decode(T[Q],{stream:!(X&&Q==O-1)});return T.length=0,p.h.g+=S,p.C=0,p.h.g}function Qg(p){return p.g?p.v=="GET"&&p.M!=2&&p.j.Aa:!1}function Jg(p,T){var S=p.C,O=T.indexOf(`
`,S);return O==-1?Uh:(S=Number(T.substring(S,O)),isNaN(S)?Yg:(O+=1,O+S>T.length?Uh:(T=T.slice(O,O+S),p.C=O+S,T)))}or.prototype.cancel=function(){this.K=!0,Us(this)};function Ya(p){p.T=Date.now()+p.H,zh(p,p.H)}function zh(p,T){if(p.D!=null)throw Error("WatchDog timer not null");p.D=Cr(h(p.aa,p),T)}function Pu(p){p.D&&(o.clearTimeout(p.D),p.D=null)}or.prototype.aa=function(){this.D=null;const p=Date.now();p-this.T>=0?(Cn(this.i,this.B),this.M!=2&&(ri(),St(17)),Us(this),this.m=2,Za(this)):zh(this,this.T-p)};function Za(p){p.j.I==0||p.K||Fu(p.j,p)}function Us(p){Pu(p);var T=p.O;T&&typeof T.dispose=="function"&&T.dispose(),p.O=null,Pr(p.V),p.g&&(T=p.g,p.g=null,T.abort(),T.dispose())}function Ct(p,T){try{var S=p.j;if(S.I!=0&&(S.g==p||Wh(S.h,p))){if(!p.L&&Wh(S.h,p)&&S.I==3){try{var O=S.Ba.g.parse(T)}catch{O=null}if(Array.isArray(O)&&O.length==3){var X=O;if(X[0]==0){e:if(!S.v){if(S.g)if(S.g.F+3e3<p.F)Vu(S),Vi(S);else break e;ds(S),St(18)}}else S.xa=X[1],0<S.xa-S.K&&X[2]<37500&&S.F&&S.A==0&&!S.C&&(S.C=Cr(h(S.Va,S),6e3));Qa(S.h)<=1&&S.ta&&(S.ta=void 0)}else Fi(S,11)}else if((p.L||S.g==p)&&Vu(S),!N(T))for(X=S.Ba.g.parse(T),T=0;T<X.length;T++){let Et=X[T];const sn=Et[0];if(!(sn<=S.K))if(S.K=sn,Et=Et[1],S.I==2)if(Et[0]=="c"){S.M=Et[1],S.ba=Et[2];const Gi=Et[3];Gi!=null&&(S.ka=Gi,S.j.info("VER="+S.ka));const qs=Et[4];qs!=null&&(S.za=qs,S.j.info("SVER="+S.za));const fs=Et[5];fs!=null&&typeof fs=="number"&&fs>0&&(O=1.5*fs,S.O=O,S.j.info("backChannelRequestTimeoutMs_="+O)),O=S;const gs=p.g;if(gs){const Uu=gs.g?gs.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Uu){var Q=O.h;Q.g||Uu.indexOf("spdy")==-1&&Uu.indexOf("quic")==-1&&Uu.indexOf("h2")==-1||(Q.j=Q.l,Q.g=new Set,Q.h&&(Mu(Q,Q.h),Q.h=null))}if(O.G){const id=gs.g?gs.g.getResponseHeader("X-HTTP-Session-Id"):null;id&&(O.wa=id,dt(O.J,O.G,id))}}S.I=3,S.l&&S.l.ra(),S.aa&&(S.T=Date.now()-p.F,S.j.info("Handshake RTT: "+S.T+"ms")),O=S;var fe=p;if(O.na=nd(O,O.L?O.ba:null,O.W),fe.L){Ja(O.h,fe);var qe=fe,Qt=O.O;Qt&&(qe.H=Qt),qe.D&&(Pu(qe),Ya(qe)),O.g=fe}else Un(O);S.i.length>0&&Ks(S)}else Et[0]!="stop"&&Et[0]!="close"||Fi(S,7);else S.I==3&&(Et[0]=="stop"||Et[0]=="close"?Et[0]=="stop"?Fi(S,7):Nu(S):Et[0]!="noop"&&S.l&&S.l.qa(Et),S.A=0)}}ri(4)}catch{}}var py=class{constructor(p,T){this.g=p,this.map=T}};function Cu(p){this.l=p||10,o.PerformanceNavigationTiming?(p=o.performance.getEntriesByType("navigation"),p=p.length>0&&(p[0].nextHopProtocol=="hq"||p[0].nextHopProtocol=="h2")):p=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=p?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function $h(p){return p.h?!0:p.g?p.g.size>=p.j:!1}function Qa(p){return p.h?1:p.g?p.g.size:0}function Wh(p,T){return p.h?p.h==T:p.g?p.g.has(T):!1}function Mu(p,T){p.g?p.g.add(T):p.h=T}function Ja(p,T){p.h&&p.h==T?p.h=null:p.g&&p.g.has(T)&&p.g.delete(T)}Cu.prototype.cancel=function(){if(this.i=Di(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const p of this.g.values())p.cancel();this.g.clear()}};function Di(p){if(p.h!=null)return p.i.concat(p.h.G);if(p.g!=null&&p.g.size!==0){let T=p.i;for(const S of p.g.values())T=T.concat(S.G);return T}return v(p.i)}var em=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ni(p,T){if(p){p=p.split("&");for(let S=0;S<p.length;S++){const O=p[S].indexOf("=");let X,Q=null;O>=0?(X=p[S].substring(0,O),Q=p[S].substring(O+1)):X=p[S],T(X,Q?decodeURIComponent(Q.replace(/\+/g," ")):"")}}}function is(p){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let T;p instanceof is?(this.l=p.l,el(this,p.j),this.o=p.o,this.g=p.g,rs(this,p.u),this.h=p.h,ko(this,Jh(p.i)),this.m=p.m):p&&(T=String(p).match(em))?(this.l=!1,el(this,T[1]||"",!0),this.o=tl(T[2]||""),this.g=tl(T[3]||"",!0),rs(this,T[4]),this.h=tl(T[5]||"",!0),ko(this,T[6]||"",!0),this.m=tl(T[7]||"")):(this.l=!1,this.i=new tt(null,this.l))}is.prototype.toString=function(){const p=[];var T=this.j;T&&p.push(nl(T,qh,!0),":");var S=this.g;return(S||T=="file")&&(p.push("//"),(T=this.o)&&p.push(nl(T,qh,!0),"@"),p.push(sr(S).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),S=this.u,S!=null&&p.push(":",String(S))),(S=this.h)&&(this.g&&S.charAt(0)!="/"&&p.push("/"),p.push(nl(S,S.charAt(0)=="/"?il:Hh,!0))),(S=this.i.toString())&&p.push("?",S),(S=this.m)&&p.push("#",nl(S,Xh)),p.join("")},is.prototype.resolve=function(p){const T=ar(this);let S=!!p.j;S?el(T,p.j):S=!!p.o,S?T.o=p.o:S=!!p.g,S?T.g=p.g:S=p.u!=null;var O=p.h;if(S)rs(T,p.u);else if(S=!!p.h){if(O.charAt(0)!="/")if(this.g&&!this.h)O="/"+O;else{var X=T.h.lastIndexOf("/");X!=-1&&(O=T.h.slice(0,X+1)+O)}if(X=O,X==".."||X==".")O="";else if(X.indexOf("./")!=-1||X.indexOf("/.")!=-1){O=X.lastIndexOf("/",0)==0,X=X.split("/");const Q=[];for(let fe=0;fe<X.length;){const qe=X[fe++];qe=="."?O&&fe==X.length&&Q.push(""):qe==".."?((Q.length>1||Q.length==1&&Q[0]!="")&&Q.pop(),O&&fe==X.length&&Q.push("")):(Q.push(qe),O=!0)}O=Q.join("/")}else O=X}return S?T.h=O:S=p.i.toString()!=="",S?ko(T,Jh(p.i)):S=!!p.m,S&&(T.m=p.m),T};function ar(p){return new is(p)}function el(p,T,S){p.j=S?tl(T,!0):T,p.j&&(p.j=p.j.replace(/:$/,""))}function rs(p,T){if(T){if(T=Number(T),isNaN(T)||T<0)throw Error("Bad port number "+T);p.u=T}else p.u=null}function ko(p,T,S){T instanceof tt?(p.i=T,ku(p.i,p.l)):(S||(T=nl(T,_y)),p.i=new tt(T,p.l))}function dt(p,T,S){p.i.set(T,S)}function Bs(p){return dt(p,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),p}function tl(p,T){return p?T?decodeURI(p.replace(/%25/g,"%2525")):decodeURIComponent(p):""}function nl(p,T,S){return typeof p=="string"?(p=encodeURI(p).replace(T,Kh),S&&(p=p.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p):null}function Kh(p){return p=p.charCodeAt(0),"%"+(p>>4&15).toString(16)+(p&15).toString(16)}var qh=/[#\/\?@]/g,Hh=/[#\?:]/g,il=/[#\?]/g,_y=/[#\?@]/g,Xh=/#/g;function tt(p,T){this.h=this.g=null,this.i=p||null,this.j=!!T}function ss(p){p.g||(p.g=new Map,p.h=0,p.i&&Ni(p.i,function(T,S){p.add(decodeURIComponent(T.replace(/\+/g," ")),S)}))}n=tt.prototype,n.add=function(p,T){ss(this),this.i=null,p=os(this,p);let S=this.g.get(p);return S||this.g.set(p,S=[]),S.push(T),this.h+=1,this};function Yh(p,T){ss(p),T=os(p,T),p.g.has(T)&&(p.i=null,p.h-=p.g.get(T).length,p.g.delete(T))}function bu(p,T){return ss(p),T=os(p,T),p.g.has(T)}n.forEach=function(p,T){ss(this),this.g.forEach(function(S,O){S.forEach(function(X){p.call(T,X,O,this)},this)},this)};function Zh(p,T){ss(p);let S=[];if(typeof T=="string")bu(p,T)&&(S=S.concat(p.g.get(os(p,T))));else for(p=Array.from(p.g.values()),T=0;T<p.length;T++)S=S.concat(p[T]);return S}n.set=function(p,T){return ss(this),this.i=null,p=os(this,p),bu(this,p)&&(this.h-=this.g.get(p).length),this.g.set(p,[T]),this.h+=1,this},n.get=function(p,T){return p?(p=Zh(this,p),p.length>0?String(p[0]):T):T};function Qh(p,T,S){Yh(p,T),S.length>0&&(p.i=null,p.g.set(os(p,T),v(S)),p.h+=S.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const p=[],T=Array.from(this.g.keys());for(let O=0;O<T.length;O++){var S=T[O];const X=sr(S);S=Zh(this,S);for(let Q=0;Q<S.length;Q++){let fe=X;S[Q]!==""&&(fe+="="+sr(S[Q])),p.push(fe)}}return this.i=p.join("&")};function Jh(p){const T=new tt;return T.i=p.i,p.g&&(T.g=new Map(p.g),T.h=p.h),T}function os(p,T){return T=String(T),p.j&&(T=T.toLowerCase()),T}function ku(p,T){T&&!p.j&&(ss(p),p.i=null,p.g.forEach(function(S,O){const X=O.toLowerCase();O!=X&&(Yh(this,O),Qh(this,X,S))},p)),p.j=T}function as(p,T){const S=new Yt;if(o.Image){const O=new Image;O.onload=d(bn,S,"TestLoadImage: loaded",!0,T,O),O.onerror=d(bn,S,"TestLoadImage: error",!1,T,O),O.onabort=d(bn,S,"TestLoadImage: abort",!1,T,O),O.ontimeout=d(bn,S,"TestLoadImage: timeout",!1,T,O),o.setTimeout(function(){O.ontimeout&&O.ontimeout()},1e4),O.src=p}else T(!1)}function ls(p,T){const S=new Yt,O=new AbortController,X=setTimeout(()=>{O.abort(),bn(S,"TestPingServer: timeout",!1,T)},1e4);fetch(p,{signal:O.signal}).then(Q=>{clearTimeout(X),Q.ok?bn(S,"TestPingServer: ok",!0,T):bn(S,"TestPingServer: server error",!1,T)}).catch(()=>{clearTimeout(X),bn(S,"TestPingServer: error",!1,T)})}function bn(p,T,S,O,X){try{X&&(X.onload=null,X.onerror=null,X.onabort=null,X.ontimeout=null),O(S)}catch{}}function rl(){this.g=new Jr}function zs(p){this.i=p.Sb||null,this.h=p.ab||!1}g(zs,ir),zs.prototype.g=function(){return new Oi(this.i,this.h)};function Oi(p,T){Rt.call(this),this.H=p,this.o=T,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}g(Oi,Rt),n=Oi.prototype,n.open=function(p,T){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=p,this.D=T,this.readyState=1,br(this)},n.send=function(p){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const T={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};p&&(T.body=p),(this.H||o).fetch(new Request(this.D,T)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Lo(this)),this.readyState=0},n.Pa=function(p){if(this.g&&(this.l=p,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=p.headers,this.readyState=2,br(this)),this.g&&(this.readyState=3,br(this),this.g)))if(this.responseType==="arraybuffer")p.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in p){if(this.j=p.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;tm(this)}else p.text().then(this.Oa.bind(this),this.ga.bind(this))};function tm(p){p.j.read().then(p.Ma.bind(p)).catch(p.ga.bind(p))}n.Ma=function(p){if(this.g){if(this.o&&p.value)this.response.push(p.value);else if(!this.o){var T=p.value?p.value:new Uint8Array(0);(T=this.B.decode(T,{stream:!p.done}))&&(this.response=this.responseText+=T)}p.done?Lo(this):br(this),this.readyState==3&&tm(this)}},n.Oa=function(p){this.g&&(this.response=this.responseText=p,Lo(this))},n.Na=function(p){this.g&&(this.response=p,Lo(this))},n.ga=function(){this.g&&Lo(this)};function Lo(p){p.readyState=4,p.l=null,p.j=null,p.B=null,br(p)}n.setRequestHeader=function(p,T){this.A.append(p,T)},n.getResponseHeader=function(p){return this.h&&this.h.get(p.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const p=[],T=this.h.entries();for(var S=T.next();!S.done;)S=S.value,p.push(S[0]+": "+S[1]),S=T.next();return p.join(`\r
`)};function br(p){p.onreadystatechange&&p.onreadystatechange.call(p)}Object.defineProperty(Oi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(p){this.m=p?"include":"same-origin"}});function nm(p){let T="";return ae(p,function(S,O){T+=O,T+=":",T+=S,T+=`\r
`}),T}function Lu(p,T,S){e:{for(O in S){var O=!1;break e}O=!0}O||(S=nm(S),typeof p=="string"?S!=null&&sr(S):dt(p,T,S))}function At(p){Rt.call(this),this.headers=new Map,this.L=p||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}g(At,Rt);var im=/^https?$/i,yy=["POST","PUT"];n=At.prototype,n.Fa=function(p){this.H=p},n.ea=function(p,T,S,O){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+p);T=T?T.toUpperCase():"GET",this.D=p,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():rn.g(),this.g.onreadystatechange=m(h(this.Ca,this));try{this.B=!0,this.g.open(T,String(p),!0),this.B=!1}catch(Q){Do(this,Q);return}if(p=S||"",S=new Map(this.headers),O)if(Object.getPrototypeOf(O)===Object.prototype)for(var X in O)S.set(X,O[X]);else if(typeof O.keys=="function"&&typeof O.get=="function")for(const Q of O.keys())S.set(Q,O.get(Q));else throw Error("Unknown input type for opt_headers: "+String(O));O=Array.from(S.keys()).find(Q=>Q.toLowerCase()=="content-type"),X=o.FormData&&p instanceof o.FormData,!(Array.prototype.indexOf.call(yy,T,void 0)>=0)||O||X||S.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Q,fe]of S)this.g.setRequestHeader(Q,fe);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(p),this.v=!1}catch(Q){Do(this,Q)}};function Do(p,T){p.h=!1,p.g&&(p.j=!0,p.g.abort(),p.j=!1),p.l=T,p.o=5,No(p),Ws(p)}function No(p){p.A||(p.A=!0,vt(p,"complete"),vt(p,"error"))}n.abort=function(p){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=p||7,vt(this,"complete"),vt(this,"abort"),Ws(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ws(this,!0)),At.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?$s(this):this.Xa())},n.Xa=function(){$s(this)};function $s(p){if(p.h&&typeof s<"u"){if(p.v&&us(p)==4)setTimeout(p.Ca.bind(p),0);else if(vt(p,"readystatechange"),us(p)==4){p.h=!1;try{const Q=p.ca();e:switch(Q){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var T=!0;break e;default:T=!1}var S;if(!(S=T)){var O;if(O=Q===0){let fe=String(p.D).match(em)[1]||null;!fe&&o.self&&o.self.location&&(fe=o.self.location.protocol.slice(0,-1)),O=!im.test(fe?fe.toLowerCase():"")}S=O}if(S)vt(p,"complete"),vt(p,"success");else{p.o=6;try{var X=us(p)>2?p.g.statusText:""}catch{X=""}p.l=X+" ["+p.ca()+"]",No(p)}}finally{Ws(p)}}}}function Ws(p,T){if(p.g){p.m&&(clearTimeout(p.m),p.m=null);const S=p.g;p.g=null,T||vt(p,"ready");try{S.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function us(p){return p.g?p.g.readyState:0}n.ca=function(){try{return us(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(p){if(this.g){var T=this.g.responseText;return p&&T.indexOf(p)==0&&(T=T.substring(p.length)),Xa(T)}};function rm(p){try{if(!p.g)return null;if("response"in p.g)return p.g.response;switch(p.F){case"":case"text":return p.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in p.g)return p.g.mozResponseArrayBuffer}return null}catch{return null}}function ed(p){const T={};p=(p.g&&us(p)>=2&&p.g.getAllResponseHeaders()||"").split(`\r
`);for(let O=0;O<p.length;O++){if(N(p[O]))continue;var S=Ru(p[O]);const X=S[0];if(S=S[1],typeof S!="string")continue;S=S.trim();const Q=T[X]||[];T[X]=Q,Q.push(S)}ie(T,function(O){return O.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function cs(p,T,S){return S&&S.internalChannelParams&&S.internalChannelParams[p]||T}function Du(p){this.za=0,this.i=[],this.j=new Yt,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=cs("failFast",!1,p),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=cs("baseRetryDelayMs",5e3,p),this.Za=cs("retryDelaySeedMs",1e4,p),this.Ta=cs("forwardChannelMaxRetries",2,p),this.va=cs("forwardChannelRequestTimeoutMs",2e4,p),this.ma=p&&p.xmlHttpFactory||void 0,this.Ua=p&&p.Rb||void 0,this.Aa=p&&p.useFetchStreams||!1,this.O=void 0,this.L=p&&p.supportsCrossDomainXhr||!1,this.M="",this.h=new Cu(p&&p.concurrentRequestLimit),this.Ba=new rl,this.S=p&&p.fastHandshake||!1,this.R=p&&p.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=p&&p.Pb||!1,p&&p.ua&&this.j.ua(),p&&p.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&p&&p.detectBufferingProxy||!1,this.ia=void 0,p&&p.longPollingTimeout&&p.longPollingTimeout>0&&(this.ia=p.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Du.prototype,n.ka=8,n.I=1,n.connect=function(p,T,S,O){St(0),this.W=p,this.H=T||{},S&&O!==void 0&&(this.H.OSID=S,this.H.OAID=O),this.F=this.X,this.J=nd(this,null,this.W),Ks(this)};function Nu(p){if(Ou(p),p.I==3){var T=p.V++,S=ar(p.J);if(dt(S,"SID",p.M),dt(S,"RID",T),dt(S,"TYPE","terminate"),hs(p,S),T=new or(p,p.j,T),T.M=2,T.A=Bs(ar(S)),S=!1,o.navigator&&o.navigator.sendBeacon)try{S=o.navigator.sendBeacon(T.A.toString(),"")}catch{}!S&&o.Image&&(new Image().src=T.A,S=!0),S||(T.g=om(T.j,null),T.g.ea(T.A)),T.F=Date.now(),Ya(T)}al(p)}function Vi(p){p.g&&(ol(p),p.g.cancel(),p.g=null)}function Ou(p){Vi(p),p.v&&(o.clearTimeout(p.v),p.v=null),Vu(p),p.h.cancel(),p.m&&(typeof p.m=="number"&&o.clearTimeout(p.m),p.m=null)}function Ks(p){if(!$h(p.h)&&!p.m){p.m=!0;var T=p.Ea;D||A(),B||(D(),B=!0),M.add(T,p),p.D=0}}function sm(p,T){return Qa(p.h)>=p.h.j-(p.m?1:0)?!1:p.m?(p.i=T.G.concat(p.i),!0):p.I==1||p.I==2||p.D>=(p.Sa?0:p.Ta)?!1:(p.m=Cr(h(p.Ea,p,T),Gu(p,p.D)),p.D++,!0)}n.Ea=function(p){if(this.m)if(this.m=null,this.I==1){if(!p){this.V=Math.floor(Math.random()*1e5),p=this.V++;const X=new or(this,this.j,p);let Q=this.o;if(this.U&&(Q?(Q=$(Q),Ae(Q,this.U)):Q=this.U),this.u!==null||this.R||(X.J=Q,Q=null),this.S)e:{for(var T=0,S=0;S<this.i.length;S++){t:{var O=this.i[S];if("__data__"in O.map&&(O=O.map.__data__,typeof O=="string")){O=O.length;break t}O=void 0}if(O===void 0)break;if(T+=O,T>4096){T=S;break e}if(T===4096||S===this.i.length-1){T=S+1;break e}}T=1e3}else T=1e3;T=td(this,X,T),S=ar(this.J),dt(S,"RID",p),dt(S,"CVER",22),this.G&&dt(S,"X-HTTP-Session-Id",this.G),hs(this,S),Q&&(this.R?T="headers="+sr(nm(Q))+"&"+T:this.u&&Lu(S,this.u,Q)),Mu(this.h,X),this.Ra&&dt(S,"TYPE","init"),this.S?(dt(S,"$req",T),dt(S,"SID","null"),X.U=!0,Mr(X,S,null)):Mr(X,S,T),this.I=2}}else this.I==3&&(p?sl(this,p):this.i.length==0||$h(this.h)||sl(this))};function sl(p,T){var S;T?S=T.l:S=p.V++;const O=ar(p.J);dt(O,"SID",p.M),dt(O,"RID",S),dt(O,"AID",p.K),hs(p,O),p.u&&p.o&&Lu(O,p.u,p.o),S=new or(p,p.j,S,p.D+1),p.u===null&&(S.J=p.o),T&&(p.i=T.G.concat(p.i)),T=td(p,S,1e3),S.H=Math.round(p.va*.5)+Math.round(p.va*.5*Math.random()),Mu(p.h,S),Mr(S,O,T)}function hs(p,T){p.H&&ae(p.H,function(S,O){dt(T,O,S)}),p.l&&ae({},function(S,O){dt(T,O,S)})}function td(p,T,S){S=Math.min(p.i.length,S);const O=p.l?h(p.l.Ka,p.l,p):null;e:{var X=p.i;let qe=-1;for(;;){const Qt=["count="+S];qe==-1?S>0?(qe=X[0].g,Qt.push("ofs="+qe)):qe=0:Qt.push("ofs="+qe);let Et=!0;for(let sn=0;sn<S;sn++){var Q=X[sn].g;const Gi=X[sn].map;if(Q-=qe,Q<0)qe=Math.max(0,X[sn].g-100),Et=!1;else try{Q="req"+Q+"_"||"";try{var fe=Gi instanceof Map?Gi:Object.entries(Gi);for(const[qs,fs]of fe){let gs=fs;a(fs)&&(gs=Qr(fs)),Qt.push(Q+qs+"="+encodeURIComponent(gs))}}catch(qs){throw Qt.push(Q+"type="+encodeURIComponent("_badmap")),qs}}catch{O&&O(Gi)}}if(Et){fe=Qt.join("&");break e}}fe=void 0}return p=p.i.splice(0,S),T.G=p,fe}function Un(p){if(!p.g&&!p.v){p.Y=1;var T=p.Da;D||A(),B||(D(),B=!0),M.add(T,p),p.A=0}}function ds(p){return p.g||p.v||p.A>=3?!1:(p.Y++,p.v=Cr(h(p.Da,p),Gu(p,p.A)),p.A++,!0)}n.Da=function(){if(this.v=null,Oo(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var p=4*this.T;this.j.info("BP detection timer enabled: "+p),this.B=Cr(h(this.Wa,this),p)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,St(10),Vi(this),Oo(this))};function ol(p){p.B!=null&&(o.clearTimeout(p.B),p.B=null)}function Oo(p){p.g=new or(p,p.j,"rpc",p.Y),p.u===null&&(p.g.J=p.o),p.g.P=0;var T=ar(p.na);dt(T,"RID","rpc"),dt(T,"SID",p.M),dt(T,"AID",p.K),dt(T,"CI",p.F?"0":"1"),!p.F&&p.ia&&dt(T,"TO",p.ia),dt(T,"TYPE","xmlhttp"),hs(p,T),p.u&&p.o&&Lu(T,p.u,p.o),p.O&&(p.g.H=p.O);var S=p.g;p=p.ba,S.M=1,S.A=Bs(ar(T)),S.u=null,S.R=!0,Bh(S,p)}n.Va=function(){this.C!=null&&(this.C=null,Vi(this),ds(this),St(19))};function Vu(p){p.C!=null&&(o.clearTimeout(p.C),p.C=null)}function Fu(p,T){var S=null;if(p.g==T){Vu(p),ol(p),p.g=null;var O=2}else if(Wh(p.h,T))S=T.G,Ja(p.h,T),O=1;else return;if(p.I!=0){if(T.o)if(O==1){S=T.u?T.u.length:0,T=Date.now()-T.F;var X=p.D;O=ts(),vt(O,new bo(O,S)),Ks(p)}else Un(p);else if(X=T.m,X==3||X==0&&T.X>0||!(O==1&&sm(p,T)||O==2&&ds(p)))switch(S&&S.length>0&&(T=p.h,T.i=T.i.concat(S)),X){case 1:Fi(p,5);break;case 4:Fi(p,10);break;case 3:Fi(p,6);break;default:Fi(p,2)}}}function Gu(p,T){let S=p.Qa+Math.floor(Math.random()*p.Za);return p.isActive()||(S*=2),S*T}function Fi(p,T){if(p.j.info("Error code "+T),T==2){var S=h(p.bb,p),O=p.Ua;const X=!O;O=new is(O||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||el(O,"https"),Bs(O),X?as(O.toString(),S):ls(O.toString(),S)}else St(2);p.I=0,p.l&&p.l.pa(T),al(p),Ou(p)}n.bb=function(p){p?(this.j.info("Successfully pinged google.com"),St(2)):(this.j.info("Failed to ping google.com"),St(1))};function al(p){if(p.I=0,p.ja=[],p.l){const T=Di(p.h);(T.length!=0||p.i.length!=0)&&(y(p.ja,T),y(p.ja,p.i),p.h.i.length=0,v(p.i),p.i.length=0),p.l.oa()}}function nd(p,T,S){var O=S instanceof is?ar(S):new is(S);if(O.g!="")T&&(O.g=T+"."+O.g),rs(O,O.u);else{var X=o.location;O=X.protocol,T=T?T+"."+X.hostname:X.hostname,X=+X.port;const Q=new is(null);O&&el(Q,O),T&&(Q.g=T),X&&rs(Q,X),S&&(Q.h=S),O=Q}return S=p.G,T=p.wa,S&&T&&dt(O,S,T),dt(O,"VER",p.ka),hs(p,O),O}function om(p,T,S){if(T&&!p.L)throw Error("Can't create secondary domain capable XhrIo object.");return T=p.Aa&&!p.ma?new At(new zs({ab:S})):new At(p.ma),T.Fa(p.L),T}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function am(){}n=am.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function ju(){}ju.prototype.g=function(p,T){return new kn(p,T)};function kn(p,T){Rt.call(this),this.g=new Du(T),this.l=p,this.h=T&&T.messageUrlParams||null,p=T&&T.messageHeaders||null,T&&T.clientProtocolHeaderRequired&&(p?p["X-Client-Protocol"]="webchannel":p={"X-Client-Protocol":"webchannel"}),this.g.o=p,p=T&&T.initMessageHeaders||null,T&&T.messageContentType&&(p?p["X-WebChannel-Content-Type"]=T.messageContentType:p={"X-WebChannel-Content-Type":T.messageContentType}),T&&T.sa&&(p?p["X-WebChannel-Client-Profile"]=T.sa:p={"X-WebChannel-Client-Profile":T.sa}),this.g.U=p,(p=T&&T.Qb)&&!N(p)&&(this.g.u=p),this.A=T&&T.supportsCrossDomainXhr||!1,this.v=T&&T.sendRawJson||!1,(T=T&&T.httpSessionIdParam)&&!N(T)&&(this.g.G=T,p=this.h,p!==null&&T in p&&(p=this.h,T in p&&delete p[T])),this.j=new Vo(this)}g(kn,Rt),kn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},kn.prototype.close=function(){Nu(this.g)},kn.prototype.o=function(p){var T=this.g;if(typeof p=="string"){var S={};S.__data__=p,p=S}else this.v&&(S={},S.__data__=Qr(p),p=S);T.i.push(new py(T.Ya++,p)),T.I==3&&Ks(T)},kn.prototype.N=function(){this.g.l=null,delete this.j,Nu(this.g),delete this.g,kn.Z.N.call(this)};function lm(p){Gs.call(this),p.__headers__&&(this.headers=p.__headers__,this.statusCode=p.__status__,delete p.__headers__,delete p.__status__);var T=p.__sm__;if(T){e:{for(const S in T){p=S;break e}p=void 0}(this.i=p)&&(p=this.i,T=T!==null&&p in T?T[p]:void 0),this.data=T}else this.data=p}g(lm,Gs);function um(){Mo.call(this),this.status=1}g(um,Mo);function Vo(p){this.g=p}g(Vo,am),Vo.prototype.ra=function(){vt(this.g,"a")},Vo.prototype.qa=function(p){vt(this.g,new lm(p))},Vo.prototype.pa=function(p){vt(this.g,new um)},Vo.prototype.oa=function(){vt(this.g,"b")},ju.prototype.createWebChannel=ju.prototype.g,kn.prototype.send=kn.prototype.o,kn.prototype.open=kn.prototype.m,kn.prototype.close=kn.prototype.close,X4=function(){return new ju},H4=function(){return ts()},q4=ii,LE={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},vn.NO_ERROR=0,vn.TIMEOUT=8,vn.HTTP_ERROR=6,Np=vn,ht.COMPLETE="complete",K4=ht,Au.EventType=es,es.OPEN="a",es.CLOSE="b",es.ERROR="c",es.MESSAGE="d",Rt.prototype.listen=Rt.prototype.J,Xd=Au,At.prototype.listenOnce=At.prototype.K,At.prototype.getLastError=At.prototype.Ha,At.prototype.getLastErrorCode=At.prototype.ya,At.prototype.getStatus=At.prototype.ca,At.prototype.getResponseJson=At.prototype.La,At.prototype.getResponseText=At.prototype.la,At.prototype.send=At.prototype.ea,At.prototype.setWithCredentials=At.prototype.Fa,W4=At}).apply(typeof pp<"u"?pp:typeof self<"u"?self:typeof window<"u"?window:{});const cR="@firebase/firestore",hR="4.9.3";class Vn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Vn.UNAUTHENTICATED=new Vn(null),Vn.GOOGLE_CREDENTIALS=new Vn("google-credentials-uid"),Vn.FIRST_PARTY=new Vn("first-party-uid"),Vn.MOCK_USER=new Vn("mock-user");let bh="12.7.0";const ou=new xx("@firebase/firestore");function Ac(){return ou.logLevel}function ce(n,...e){if(ou.logLevel<=Je.DEBUG){const t=e.map(Sx);ou.debug(`Firestore (${bh}): ${n}`,...t)}}function ui(n,...e){if(ou.logLevel<=Je.ERROR){const t=e.map(Sx);ou.error(`Firestore (${bh}): ${n}`,...t)}}function au(n,...e){if(ou.logLevel<=Je.WARN){const t=e.map(Sx);ou.warn(`Firestore (${bh}): ${n}`,...t)}}function Sx(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Te(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,Y4(n,i,t)}function Y4(n,e,t){let i=`FIRESTORE (${bh}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw ui(i),new Error(i)}function Ce(n,e,t,i){let r="Unexpected state";typeof t=="string"?r=t:i=t,n||Y4(e,r,i)}function We(n,e){return n}const ee={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class me extends Os{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class go{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class Z4{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class K7{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Vn.UNAUTHENTICATED)))}shutdown(){}}class q7{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class H7{constructor(e){this.t=e,this.currentUser=Vn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ce(this.o===void 0,42304);let i=this.i;const r=u=>this.i!==i?(i=this.i,t(u)):Promise.resolve();let s=new go;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new go,e.enqueueRetryable((()=>r(this.currentUser)))};const o=()=>{const u=s;e.enqueueRetryable((async()=>{await u.promise,await r(this.currentUser)}))},a=u=>{ce("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((u=>a(u))),setTimeout((()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?a(u):(ce("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new go)}}),0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(ce("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Ce(typeof i.accessToken=="string",31837,{l:i}),new Z4(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ce(e===null||typeof e=="string",2055,{h:e}),new Vn(e)}}class X7{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=Vn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Y7{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new X7(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Vn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class dR{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Z7{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Wr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Ce(this.o===void 0,3512);const i=s=>{s.error!=null&&ce("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,ce("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable((()=>i(s)))};const r=s=>{ce("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((s=>r(s))),setTimeout((()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?r(s):ce("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new dR(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Ce(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new dR(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function Q7(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}class Ax{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const r=Q7(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<t&&(i+=e.charAt(r[s]%62))}return i}}function $e(n,e){return n<e?-1:n>e?1:0}function DE(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const r=n.charAt(i),s=e.charAt(i);if(r!==s)return S1(r)===S1(s)?$e(r,s):S1(r)?1:-1}return $e(n.length,e.length)}const J7=55296,eG=57343;function S1(n){const e=n.charCodeAt(0);return e>=J7&&e<=eG}function hh(n,e,t){return n.length===e.length&&n.every(((i,r)=>t(i,e[r])))}function Q4(n){return n+"\0"}const fR="__name__";class vs{constructor(e,t,i){t===void 0?t=0:t>e.length&&Te(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Te(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return vs.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof vs?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let r=0;r<i;r++){const s=vs.compareSegments(e.get(r),t.get(r));if(s!==0)return s}return $e(e.length,t.length)}static compareSegments(e,t){const i=vs.isNumericId(e),r=vs.isNumericId(t);return i&&!r?-1:!i&&r?1:i&&r?vs.extractNumericId(e).compare(vs.extractNumericId(t)):DE(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ra.fromString(e.substring(4,e.length-2))}}class gt extends vs{construct(e,t,i){return new gt(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new me(ee.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((r=>r.length>0)))}return new gt(t)}static emptyPath(){return new gt([])}}const tG=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class zt extends vs{construct(e,t,i){return new zt(e,t,i)}static isValidIdentifier(e){return tG.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),zt.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===fR}static keyField(){return new zt([fR])}static fromServerFormat(e){const t=[];let i="",r=0;const s=()=>{if(i.length===0)throw new me(ee.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let o=!1;for(;r<e.length;){const a=e[r];if(a==="\\"){if(r+1===e.length)throw new me(ee.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[r+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new me(ee.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=u,r+=2}else a==="`"?(o=!o,r++):a!=="."||o?(i+=a,r++):(s(),r++)}if(s(),o)throw new me(ee.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new zt(t)}static emptyPath(){return new zt([])}}class pe{constructor(e){this.path=e}static fromPath(e){return new pe(gt.fromString(e))}static fromName(e){return new pe(gt.fromString(e).popFirst(5))}static empty(){return new pe(gt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&gt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return gt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new pe(new gt(e.slice()))}}function J4(n,e,t){if(!t)throw new me(ee.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function nG(n,e,t,i){if(e===!0&&i===!0)throw new me(ee.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function gR(n){if(!pe.isDocumentKey(n))throw new me(ee.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function mR(n){if(pe.isDocumentKey(n))throw new me(ee.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function ek(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function G_(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Te(12329,{type:typeof n})}function Da(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new me(ee.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=G_(n);throw new me(ee.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function ln(n,e){const t={typeString:n};return e&&(t.value=e),t}function Rg(n,e){if(!ek(n))throw new me(ee.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const r=e[i].typeString,s="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const o=n[i];if(r&&typeof o!==r){t=`JSON field '${i}' must be a ${r}.`;break}if(s!==void 0&&o!==s.value){t=`Expected '${i}' field to equal '${s.value}'`;break}}if(t)throw new me(ee.INVALID_ARGUMENT,t);return!0}const pR=-62135596800,_R=1e6;class xt{static now(){return xt.fromMillis(Date.now())}static fromDate(e){return xt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*_R);return new xt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new me(ee.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new me(ee.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<pR)throw new me(ee.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new me(ee.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/_R}_compareTo(e){return this.seconds===e.seconds?$e(this.nanoseconds,e.nanoseconds):$e(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:xt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Rg(e,xt._jsonSchema))return new xt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-pR;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}xt._jsonSchemaVersion="firestore/timestamp/1.0",xt._jsonSchema={type:ln("string",xt._jsonSchemaVersion),seconds:ln("number"),nanoseconds:ln("number")};class Me{static fromTimestamp(e){return new Me(e)}static min(){return new Me(new xt(0,0))}static max(){return new Me(new xt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const $f=-1;class R0{constructor(e,t,i,r){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=r}}function NE(n){return n.fields.find((e=>e.kind===2))}function Rl(n){return n.fields.filter((e=>e.kind!==2))}R0.UNKNOWN_ID=-1;class Op{constructor(e,t){this.fieldPath=e,this.kind=t}}class Wf{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Wf(0,Qi.min())}}function iG(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=Me.fromTimestamp(i===1e9?new xt(t+1,0):new xt(t,i));return new Qi(r,pe.empty(),e)}function tk(n){return new Qi(n.readTime,n.key,$f)}class Qi{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Qi(Me.min(),pe.empty(),$f)}static max(){return new Qi(Me.max(),pe.empty(),$f)}}function Rx(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=pe.comparator(n.documentKey,e.documentKey),t!==0?t:$e(n.largestBatchId,e.largestBatchId))}const nk="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class ik{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Tu(n){if(n.code!==ee.FAILED_PRECONDITION||n.message!==nk)throw n;ce("LocalStore","Unexpectedly lost primary lease")}class q{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Te(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new q(((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(i,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof q?t:q.resolve(t)}catch(t){return q.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):q.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):q.reject(t)}static resolve(e){return new q(((t,i)=>{t(e)}))}static reject(e){return new q(((t,i)=>{i(e)}))}static waitFor(e){return new q(((t,i)=>{let r=0,s=0,o=!1;e.forEach((a=>{++r,a.next((()=>{++s,o&&s===r&&t()}),(u=>i(u)))})),o=!0,s===r&&t()}))}static or(e){let t=q.resolve(!1);for(const i of e)t=t.next((r=>r?q.resolve(r):i()));return t}static forEach(e,t){const i=[];return e.forEach(((r,s)=>{i.push(t.call(this,r,s))})),this.waitFor(i)}static mapArray(e,t){return new q(((i,r)=>{const s=e.length,o=new Array(s);let a=0;for(let u=0;u<s;u++){const h=u;t(e[h]).next((d=>{o[h]=d,++a,a===s&&i(o)}),(d=>r(d)))}}))}static doWhile(e,t){return new q(((i,r)=>{const s=()=>{e()===!0?t().next((()=>{s()}),r):i()};s()}))}}const zi="SimpleDb";class j_{static open(e,t,i,r){try{return new j_(t,e.transaction(r,i))}catch(s){throw new cf(t,s)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new go,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new cf(e,t.error)):this.S.resolve()},this.transaction.onerror=i=>{const r=Px(i.target.error);this.S.reject(new cf(e,r))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(ce(zi,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new sG(t)}}class Pa{static delete(e){return ce(zi,"Removing database:",e),Ll(C4().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!F4())return!1;if(Pa.F())return!0;const e=pn(),t=Pa.M(e),i=0<t&&t<10,r=rk(e),s=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||i||s)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(i)}constructor(e,t,i){this.name=e,this.version=t,this.N=i,this.B=null,Pa.M(pn())===12.2&&ui("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(ce(zi,"Opening database:",this.name),this.db=await new Promise(((t,i)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=s=>{const o=s.target.result;t(o)},r.onblocked=()=>{i(new cf(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=s=>{const o=s.target.error;o.name==="VersionError"?i(new me(ee.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?i(new me(ee.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):i(new cf(e,o))},r.onupgradeneeded=s=>{ce(zi,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.N.k(o,r.transaction,s.oldVersion,this.version).next((()=>{ce(zi,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,i,r){const s=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const a=j_.open(this.db,e,s?"readonly":"readwrite",i),u=r(a).next((h=>(a.C(),h))).catch((h=>(a.abort(h),q.reject(h)))).toPromise();return u.catch((()=>{})),await a.D,u}catch(a){const u=a,h=u.name!=="FirebaseError"&&o<3;if(ce(zi,"Transaction failed with error:",u.message,"Retrying:",h),this.close(),!h)return Promise.reject(u)}}}close(){this.db&&this.db.close(),this.db=void 0}}function rk(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class rG{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Ll(this.U.delete())}}class cf extends me{constructor(e,t){super(ee.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function $a(n){return n.name==="IndexedDbTransactionError"}class sG{constructor(e){this.store=e}put(e,t){let i;return t!==void 0?(ce(zi,"PUT",this.store.name,e,t),i=this.store.put(t,e)):(ce(zi,"PUT",this.store.name,"<auto-key>",e),i=this.store.put(e)),Ll(i)}add(e){return ce(zi,"ADD",this.store.name,e,e),Ll(this.store.add(e))}get(e){return Ll(this.store.get(e)).next((t=>(t===void 0&&(t=null),ce(zi,"GET",this.store.name,e,t),t)))}delete(e){return ce(zi,"DELETE",this.store.name,e),Ll(this.store.delete(e))}count(){return ce(zi,"COUNT",this.store.name),Ll(this.store.count())}J(e,t){const i=this.options(e,t),r=i.index?this.store.index(i.index):this.store;if(typeof r.getAll=="function"){const s=r.getAll(i.range);return new q(((o,a)=>{s.onerror=u=>{a(u.target.error)},s.onsuccess=u=>{o(u.target.result)}}))}{const s=this.cursor(i),o=[];return this.H(s,((a,u)=>{o.push(u)})).next((()=>o))}}Y(e,t){const i=this.store.getAll(e,t===null?void 0:t);return new q(((r,s)=>{i.onerror=o=>{s(o.target.error)},i.onsuccess=o=>{r(o.target.result)}}))}Z(e,t){ce(zi,"DELETE ALL",this.store.name);const i=this.options(e,t);i.X=!1;const r=this.cursor(i);return this.H(r,((s,o,a)=>a.delete()))}ee(e,t){let i;t?i=e:(i={},t=e);const r=this.cursor(i);return this.H(r,t)}te(e){const t=this.cursor({});return new q(((i,r)=>{t.onerror=s=>{const o=Px(s.target.error);r(o)},t.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next((a=>{a?o.continue():i()})):i()}}))}H(e,t){const i=[];return new q(((r,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void r();const u=new rG(a),h=t(a.primaryKey,a.value,u);if(h instanceof q){const d=h.catch((g=>(u.done(),q.reject(g))));i.push(d)}u.isDone?r():u.G===null?a.continue():a.continue(u.G)}})).next((()=>q.waitFor(i)))}options(e,t){let i;return e!==void 0&&(typeof e=="string"?i=e:t=e),{index:i,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const i=this.store.index(e.index);return e.X?i.openKeyCursor(e.range,t):i.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Ll(n){return new q(((e,t)=>{n.onsuccess=i=>{const r=i.target.result;e(r)},n.onerror=i=>{const r=Px(i.target.error);t(r)}}))}let yR=!1;function Px(n){const e=Pa.M(pn());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const i=new me("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return yR||(yR=!0,setTimeout((()=>{throw i}),0)),i}}return n}const hf="IndexBackfiller";class oG{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){ce(hf,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();ce(hf,`Documents written: ${t}`)}catch(t){$a(t)?ce(hf,"Ignoring IndexedDB error during index backfill: ",t):await Tu(t)}await this.re(6e4)}))}}class aG{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const i=new Set;let r=t,s=!0;return q.doWhile((()=>s===!0&&r>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((o=>{if(o!==null&&!i.has(o))return ce(hf,`Processing collection: ${o}`),this.oe(e,o,r).next((a=>{r-=a,i.add(o)}));s=!1})))).next((()=>t-r))}oe(e,t,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((r=>this.localStore.localDocuments.getNextDocuments(e,t,r,i).next((s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next((()=>this._e(r,s))).next((a=>(ce(hf,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a)))).next((()=>o.size))}))))}_e(e,t){let i=e;return t.changes.forEach(((r,s)=>{const o=tk(s);Rx(o,i)>0&&(i=o)})),new Qi(i.readTime,i.documentKey,Math.max(t.batchId,e.largestBatchId))}}class Tr{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Tr.ce=-1;const Kl=-1;function U_(n){return n==null}function Kf(n){return n===0&&1/n==-1/0}function lG(n){return typeof n=="number"&&Number.isInteger(n)&&!Kf(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const P0="";function ti(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=vR(e)),e=uG(n.get(t),e);return vR(e)}function uG(n,e){let t=e;const i=n.length;for(let r=0;r<i;r++){const s=n.charAt(r);switch(s){case"\0":t+="";break;case P0:t+="";break;default:t+=s}}return t}function vR(n){return n+P0+""}function Ts(n){const e=n.length;if(Ce(e>=2,64408,{path:n}),e===2)return Ce(n.charAt(0)===P0&&n.charAt(1)==="",56145,{path:n}),gt.emptyPath();const t=e-2,i=[];let r="";for(let s=0;s<e;){const o=n.indexOf(P0,s);switch((o<0||o>t)&&Te(50515,{path:n}),n.charAt(o+1)){case"":const a=n.substring(s,o);let u;r.length===0?u=a:(r+=a,u=r,r=""),i.push(u);break;case"":r+=n.substring(s,o),r+="\0";break;case"":r+=n.substring(s,o+1);break;default:Te(61167,{path:n})}s=o+2}return new gt(i)}const Pl="remoteDocuments",Pg="owner",mc="owner",qf="mutationQueues",cG="userId",Ur="mutations",ER="batchId",Bl="userMutationsIndex",wR=["userId","batchId"];function Vp(n,e){return[n,ti(e)]}function sk(n,e,t){return[n,ti(e),t]}const hG={},dh="documentMutations",C0="remoteDocumentsV14",dG=["prefixPath","collectionGroup","readTime","documentId"],Fp="documentKeyIndex",fG=["prefixPath","collectionGroup","documentId"],ok="collectionGroupIndex",gG=["collectionGroup","readTime","prefixPath","documentId"],Hf="remoteDocumentGlobal",OE="remoteDocumentGlobalKey",fh="targets",ak="queryTargetsIndex",mG=["canonicalId","targetId"],gh="targetDocuments",pG=["targetId","path"],Cx="documentTargetsIndex",_G=["path","targetId"],M0="targetGlobalKey",ql="targetGlobal",Xf="collectionParents",yG=["collectionId","parent"],mh="clientMetadata",vG="clientId",B_="bundles",EG="bundleId",z_="namedQueries",wG="name",Mx="indexConfiguration",xG="indexId",VE="collectionGroupIndex",TG="collectionGroup",df="indexState",IG=["indexId","uid"],lk="sequenceNumberIndex",SG=["uid","sequenceNumber"],ff="indexEntries",AG=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],uk="documentKeyIndex",RG=["indexId","uid","orderedDocumentKey"],$_="documentOverlays",PG=["userId","collectionPath","documentId"],FE="collectionPathOverlayIndex",CG=["userId","collectionPath","largestBatchId"],ck="collectionGroupOverlayIndex",MG=["userId","collectionGroup","largestBatchId"],bx="globals",bG="name",hk=[qf,Ur,dh,Pl,fh,Pg,ql,gh,mh,Hf,Xf,B_,z_],kG=[...hk,$_],dk=[qf,Ur,dh,C0,fh,Pg,ql,gh,mh,Hf,Xf,B_,z_,$_],fk=dk,kx=[...fk,Mx,df,ff],LG=kx,gk=[...kx,bx],DG=gk;class GE extends ik{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function _n(n,e){const t=We(n);return Pa.O(t.le,e)}function xR(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Wa(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function mk(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class Gt{constructor(e,t){this.comparator=e,this.root=t||Fn.EMPTY}insert(e,t){return new Gt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Fn.BLACK,null,null))}remove(e){return new Gt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Fn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new _p(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new _p(this.root,e,this.comparator,!1)}getReverseIterator(){return new _p(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new _p(this.root,e,this.comparator,!0)}}class _p{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?i(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Fn{constructor(e,t,i,r,s){this.key=e,this.value=t,this.color=i??Fn.RED,this.left=r??Fn.EMPTY,this.right=s??Fn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,s){return new Fn(e??this.key,t??this.value,i??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this;const s=i(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,i),null):s===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Fn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return Fn.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Fn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Fn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Te(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Te(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Te(27949);return e+(this.isRed()?0:1)}}Fn.EMPTY=null,Fn.RED=!0,Fn.BLACK=!1;Fn.EMPTY=new class{constructor(){this.size=0}get key(){throw Te(57766)}get value(){throw Te(16141)}get color(){throw Te(16727)}get left(){throw Te(29726)}get right(){throw Te(36894)}copy(e,t,i,r,s){return this}insert(e,t,i){return new Fn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class It{constructor(e){this.comparator=e,this.data=new Gt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new TR(this.data.getIterator())}getIteratorFrom(e){return new TR(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof It)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=i.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new It(this.comparator);return t.data=e,t}}class TR{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function pc(n){return n.hasNext()?n.getNext():void 0}class bi{constructor(e){this.fields=e,e.sort(zt.comparator)}static empty(){return new bi([])}unionWith(e){let t=new It(zt.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new bi(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return hh(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}class pk extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class un{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new pk("Invalid base64 string: "+s):s}})(e);return new un(t)}static fromUint8Array(e){const t=(function(r){let s="";for(let o=0;o<r.length;++o)s+=String.fromCharCode(r[o]);return s})(e);return new un(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return $e(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}un.EMPTY_BYTE_STRING=new un("");const NG=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function vo(n){if(Ce(!!n,39018),typeof n=="string"){let e=0;const t=NG.exec(n);if(Ce(!!t,46558,{timestamp:n}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Vt(n.seconds),nanos:Vt(n.nanos)}}function Vt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Eo(n){return typeof n=="string"?un.fromBase64String(n):un.fromUint8Array(n)}const _k="server_timestamp",yk="__type__",vk="__previous_value__",Ek="__local_write_time__";function Lx(n){return(n?.mapValue?.fields||{})[yk]?.stringValue===_k}function W_(n){const e=n.mapValue.fields[vk];return Lx(e)?W_(e):e}function Yf(n){const e=vo(n.mapValue.fields[Ek].timestampValue);return new xt(e.seconds,e.nanos)}class OG{constructor(e,t,i,r,s,o,a,u,h,d){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=u,this.useFetchStreams=h,this.isUsingEmulator=d}}const b0="(default)";class lu{constructor(e,t){this.projectId=e,this.database=t||b0}static empty(){return new lu("","")}get isDefaultDatabase(){return this.database===b0}isEqual(e){return e instanceof lu&&e.projectId===this.projectId&&e.database===this.database}}const Dx="__type__",wk="__max__",Ea={mapValue:{fields:{__type__:{stringValue:wk}}}},Nx="__vector__",ph="value",Gp={nullValue:"NULL_VALUE"};function Na(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Lx(n)?4:xk(n)?9007199254740991:K_(n)?10:11:Te(28295,{value:n})}function ks(n,e){if(n===e)return!0;const t=Na(n);if(t!==Na(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Yf(n).isEqual(Yf(e));case 3:return(function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const o=vo(r.timestampValue),a=vo(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(r,s){return Eo(r.bytesValue).isEqual(Eo(s.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(r,s){return Vt(r.geoPointValue.latitude)===Vt(s.geoPointValue.latitude)&&Vt(r.geoPointValue.longitude)===Vt(s.geoPointValue.longitude)})(n,e);case 2:return(function(r,s){if("integerValue"in r&&"integerValue"in s)return Vt(r.integerValue)===Vt(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const o=Vt(r.doubleValue),a=Vt(s.doubleValue);return o===a?Kf(o)===Kf(a):isNaN(o)&&isNaN(a)}return!1})(n,e);case 9:return hh(n.arrayValue.values||[],e.arrayValue.values||[],ks);case 10:case 11:return(function(r,s){const o=r.mapValue.fields||{},a=s.mapValue.fields||{};if(xR(o)!==xR(a))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(a[u]===void 0||!ks(o[u],a[u])))return!1;return!0})(n,e);default:return Te(52216,{left:n})}}function Zf(n,e){return(n.values||[]).find((t=>ks(t,e)))!==void 0}function Oa(n,e){if(n===e)return 0;const t=Na(n),i=Na(e);if(t!==i)return $e(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return $e(n.booleanValue,e.booleanValue);case 2:return(function(s,o){const a=Vt(s.integerValue||s.doubleValue),u=Vt(o.integerValue||o.doubleValue);return a<u?-1:a>u?1:a===u?0:isNaN(a)?isNaN(u)?0:-1:1})(n,e);case 3:return IR(n.timestampValue,e.timestampValue);case 4:return IR(Yf(n),Yf(e));case 5:return DE(n.stringValue,e.stringValue);case 6:return(function(s,o){const a=Eo(s),u=Eo(o);return a.compareTo(u)})(n.bytesValue,e.bytesValue);case 7:return(function(s,o){const a=s.split("/"),u=o.split("/");for(let h=0;h<a.length&&h<u.length;h++){const d=$e(a[h],u[h]);if(d!==0)return d}return $e(a.length,u.length)})(n.referenceValue,e.referenceValue);case 8:return(function(s,o){const a=$e(Vt(s.latitude),Vt(o.latitude));return a!==0?a:$e(Vt(s.longitude),Vt(o.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return SR(n.arrayValue,e.arrayValue);case 10:return(function(s,o){const a=s.fields||{},u=o.fields||{},h=a[ph]?.arrayValue,d=u[ph]?.arrayValue,g=$e(h?.values?.length||0,d?.values?.length||0);return g!==0?g:SR(h,d)})(n.mapValue,e.mapValue);case 11:return(function(s,o){if(s===Ea.mapValue&&o===Ea.mapValue)return 0;if(s===Ea.mapValue)return 1;if(o===Ea.mapValue)return-1;const a=s.fields||{},u=Object.keys(a),h=o.fields||{},d=Object.keys(h);u.sort(),d.sort();for(let g=0;g<u.length&&g<d.length;++g){const m=DE(u[g],d[g]);if(m!==0)return m;const v=Oa(a[u[g]],h[d[g]]);if(v!==0)return v}return $e(u.length,d.length)})(n.mapValue,e.mapValue);default:throw Te(23264,{he:t})}}function IR(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return $e(n,e);const t=vo(n),i=vo(e),r=$e(t.seconds,i.seconds);return r!==0?r:$e(t.nanos,i.nanos)}function SR(n,e){const t=n.values||[],i=e.values||[];for(let r=0;r<t.length&&r<i.length;++r){const s=Oa(t[r],i[r]);if(s)return s}return $e(t.length,i.length)}function _h(n){return jE(n)}function jE(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=vo(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Eo(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return pe.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",r=!0;for(const s of t.values||[])r?r=!1:i+=",",i+=jE(s);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let r="{",s=!0;for(const o of i)s?s=!1:r+=",",r+=`${o}:${jE(t.fields[o])}`;return r+"}"})(n.mapValue):Te(61005,{value:n})}function jp(n){switch(Na(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=W_(n);return e?16+jp(e):16;case 5:return 2*n.stringValue.length;case 6:return Eo(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((r,s)=>r+jp(s)),0)})(n.arrayValue);case 10:case 11:return(function(i){let r=0;return Wa(i.fields,((s,o)=>{r+=s.length+jp(o)})),r})(n.mapValue);default:throw Te(13486,{value:n})}}function Qf(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function UE(n){return!!n&&"integerValue"in n}function Jf(n){return!!n&&"arrayValue"in n}function AR(n){return!!n&&"nullValue"in n}function RR(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Up(n){return!!n&&"mapValue"in n}function K_(n){return(n?.mapValue?.fields||{})[Dx]?.stringValue===Nx}function gf(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Wa(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=gf(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=gf(n.arrayValue.values[t]);return e}return{...n}}function xk(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===wk}const Tk={mapValue:{fields:{[Dx]:{stringValue:Nx},[ph]:{arrayValue:{}}}}};function VG(n){return"nullValue"in n?Gp:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Qf(lu.empty(),pe.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?K_(n)?Tk:{mapValue:{}}:Te(35942,{value:n})}function FG(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Qf(lu.empty(),pe.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?Tk:"mapValue"in n?K_(n)?{mapValue:{}}:Ea:Te(61959,{value:n})}function PR(n,e){const t=Oa(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function CR(n,e){const t=Oa(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class Qn{constructor(e){this.value=e}static empty(){return new Qn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Up(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=gf(t)}setAll(e){let t=zt.emptyPath(),i={},r=[];e.forEach(((o,a)=>{if(!t.isImmediateParentOf(a)){const u=this.getFieldsMap(t);this.applyChanges(u,i,r),i={},r=[],t=a.popLast()}o?i[a.lastSegment()]=gf(o):r.push(a.lastSegment())}));const s=this.getFieldsMap(t);this.applyChanges(s,i,r)}delete(e){const t=this.field(e.popLast());Up(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ks(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];Up(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){Wa(t,((r,s)=>e[r]=s));for(const r of i)delete e[r]}clone(){return new Qn(gf(this.value))}}function Ik(n){const e=[];return Wa(n.fields,((t,i)=>{const r=new zt([t]);if(Up(i)){const s=Ik(i.mapValue).fields;if(s.length===0)e.push(r);else for(const o of s)e.push(r.child(o))}else e.push(r)})),new bi(e)}class Xt{constructor(e,t,i,r,s,o,a){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Xt(e,0,Me.min(),Me.min(),Me.min(),Qn.empty(),0)}static newFoundDocument(e,t,i,r){return new Xt(e,1,t,Me.min(),i,r,0)}static newNoDocument(e,t){return new Xt(e,2,t,Me.min(),Me.min(),Qn.empty(),0)}static newUnknownDocument(e,t){return new Xt(e,3,t,Me.min(),Me.min(),Qn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Me.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Qn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Qn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Me.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Xt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Xt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class yh{constructor(e,t){this.position=e,this.inclusive=t}}function MR(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){const s=e[r],o=n.position[r];if(s.field.isKeyField()?i=pe.comparator(pe.fromName(o.referenceValue),t.key):i=Oa(o,t.data.field(s.field)),s.dir==="desc"&&(i*=-1),i!==0)break}return i}function bR(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!ks(n.position[t],e.position[t]))return!1;return!0}class k0{constructor(e,t="asc"){this.field=e,this.dir=t}}function GG(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class Sk{}class et extends Sk{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new jG(e,t,i):t==="array-contains"?new zG(e,i):t==="in"?new bk(e,i):t==="not-in"?new $G(e,i):t==="array-contains-any"?new WG(e,i):new et(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new UG(e,i):new BG(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Oa(t,this.value)):t!==null&&Na(this.value)===Na(t)&&this.matchesComparison(Oa(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Te(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Tt extends Sk{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Tt(e,t)}matches(e){return vh(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function vh(n){return n.op==="and"}function BE(n){return n.op==="or"}function Ox(n){return Ak(n)&&vh(n)}function Ak(n){for(const e of n.filters)if(e instanceof Tt)return!1;return!0}function zE(n){if(n instanceof et)return n.field.canonicalString()+n.op.toString()+_h(n.value);if(Ox(n))return n.filters.map((e=>zE(e))).join(",");{const e=n.filters.map((t=>zE(t))).join(",");return`${n.op}(${e})`}}function Rk(n,e){return n instanceof et?(function(i,r){return r instanceof et&&i.op===r.op&&i.field.isEqual(r.field)&&ks(i.value,r.value)})(n,e):n instanceof Tt?(function(i,r){return r instanceof Tt&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce(((s,o,a)=>s&&Rk(o,r.filters[a])),!0):!1})(n,e):void Te(19439)}function Pk(n,e){const t=n.filters.concat(e);return Tt.create(t,n.op)}function Ck(n){return n instanceof et?(function(t){return`${t.field.canonicalString()} ${t.op} ${_h(t.value)}`})(n):n instanceof Tt?(function(t){return t.op.toString()+" {"+t.getFilters().map(Ck).join(" ,")+"}"})(n):"Filter"}class jG extends et{constructor(e,t,i){super(e,t,i),this.key=pe.fromName(i.referenceValue)}matches(e){const t=pe.comparator(e.key,this.key);return this.matchesComparison(t)}}class UG extends et{constructor(e,t){super(e,"in",t),this.keys=Mk("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class BG extends et{constructor(e,t){super(e,"not-in",t),this.keys=Mk("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function Mk(n,e){return(e.arrayValue?.values||[]).map((t=>pe.fromName(t.referenceValue)))}class zG extends et{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Jf(t)&&Zf(t.arrayValue,this.value)}}class bk extends et{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Zf(this.value.arrayValue,t)}}class $G extends et{constructor(e,t){super(e,"not-in",t)}matches(e){if(Zf(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Zf(this.value.arrayValue,t)}}class WG extends et{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Jf(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>Zf(this.value.arrayValue,i)))}}class KG{constructor(e,t=null,i=[],r=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=o,this.endAt=a,this.Te=null}}function $E(n,e=null,t=[],i=[],r=null,s=null,o=null){return new KG(n,e,t,i,r,s,o)}function uu(n){const e=We(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>zE(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(s){return s.field.canonicalString()+s.dir})(i))).join(","),U_(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>_h(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>_h(i))).join(",")),e.Te=t}return e.Te}function Cg(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!GG(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Rk(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!bR(n.startAt,e.startAt)&&bR(n.endAt,e.endAt)}function L0(n){return pe.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function D0(n,e){return n.filters.filter((t=>t instanceof et&&t.field.isEqual(e)))}function kR(n,e,t){let i=Gp,r=!0;for(const s of D0(n,e)){let o=Gp,a=!0;switch(s.op){case"<":case"<=":o=VG(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Gp}PR({value:i,inclusive:r},{value:o,inclusive:a})<0&&(i=o,r=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];PR({value:i,inclusive:r},{value:o,inclusive:t.inclusive})<0&&(i=o,r=t.inclusive);break}}return{value:i,inclusive:r}}function LR(n,e,t){let i=Ea,r=!0;for(const s of D0(n,e)){let o=Ea,a=!0;switch(s.op){case">=":case">":o=FG(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Ea}CR({value:i,inclusive:r},{value:o,inclusive:a})>0&&(i=o,r=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];CR({value:i,inclusive:r},{value:o,inclusive:t.inclusive})>0&&(i=o,r=t.inclusive);break}}return{value:i,inclusive:r}}class Mg{constructor(e,t=null,i=[],r=[],s=null,o="F",a=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function qG(n,e,t,i,r,s,o,a){return new Mg(n,e,t,i,r,s,o,a)}function Vx(n){return new Mg(n)}function DR(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function kk(n){return n.collectionGroup!==null}function mf(n){const e=We(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),t.add(s.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new It(zt.comparator);return o.filters.forEach((u=>{u.getFlattenedFilters().forEach((h=>{h.isInequality()&&(a=a.add(h.field))}))})),a})(e).forEach((s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new k0(s,i))})),t.has(zt.keyField().canonicalString())||e.Ie.push(new k0(zt.keyField(),i))}return e.Ie}function Sr(n){const e=We(n);return e.Ee||(e.Ee=HG(e,mf(n))),e.Ee}function HG(n,e){if(n.limitType==="F")return $E(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((r=>{const s=r.dir==="desc"?"asc":"desc";return new k0(r.field,s)}));const t=n.endAt?new yh(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new yh(n.startAt.position,n.startAt.inclusive):null;return $E(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function WE(n,e){const t=n.filters.concat([e]);return new Mg(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function KE(n,e,t){return new Mg(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function q_(n,e){return Cg(Sr(n),Sr(e))&&n.limitType===e.limitType}function Lk(n){return`${uu(Sr(n))}|lt:${n.limitType}`}function Rc(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((r=>Ck(r))).join(", ")}]`),U_(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((r=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(r))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((r=>_h(r))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((r=>_h(r))).join(",")),`Target(${i})`})(Sr(n))}; limitType=${n.limitType})`}function bg(n,e){return e.isFoundDocument()&&(function(i,r){const s=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(s):pe.isDocumentKey(i.path)?i.path.isEqual(s):i.path.isImmediateParentOf(s)})(n,e)&&(function(i,r){for(const s of mf(i))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0})(n,e)&&(function(i,r){for(const s of i.filters)if(!s.matches(r))return!1;return!0})(n,e)&&(function(i,r){return!(i.startAt&&!(function(o,a,u){const h=MR(o,a,u);return o.inclusive?h<=0:h<0})(i.startAt,mf(i),r)||i.endAt&&!(function(o,a,u){const h=MR(o,a,u);return o.inclusive?h>=0:h>0})(i.endAt,mf(i),r))})(n,e)}function XG(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Dk(n){return(e,t)=>{let i=!1;for(const r of mf(n)){const s=YG(r,e,t);if(s!==0)return s;i=i||r.field.isKeyField()}return 0}}function YG(n,e,t){const i=n.field.isKeyField()?pe.comparator(e.key,t.key):(function(s,o,a){const u=o.data.field(s),h=a.data.field(s);return u!==null&&h!==null?Oa(u,h):Te(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Te(19790,{direction:n.dir})}}class Ao{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[r,s]of i)if(this.equalsFn(r,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Wa(this.inner,((t,i)=>{for(const[r,s]of i)e(r,s)}))}isEmpty(){return mk(this.inner)}size(){return this.innerSize}}const ZG=new Gt(pe.comparator);function Ki(){return ZG}const Nk=new Gt(pe.comparator);function Yd(...n){let e=Nk;for(const t of n)e=e.insert(t.key,t);return e}function Ok(n){let e=Nk;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function Is(){return pf()}function Vk(){return pf()}function pf(){return new Ao((n=>n.toString()),((n,e)=>n.isEqual(e)))}const QG=new Gt(pe.comparator),JG=new It(pe.comparator);function Ze(...n){let e=JG;for(const t of n)e=e.add(t);return e}const ej=new It($e);function tj(){return ej}function Fx(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Kf(e)?"-0":e}}function Fk(n){return{integerValue:""+n}}function nj(n,e){return lG(e)?Fk(e):Fx(n,e)}class H_{constructor(){this._=void 0}}function ij(n,e,t){return n instanceof eg?(function(r,s){const o={fields:{[yk]:{stringValue:_k},[Ek]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&Lx(s)&&(s=W_(s)),s&&(o.fields[vk]=s),{mapValue:o}})(t,e):n instanceof Eh?jk(n,e):n instanceof wh?Uk(n,e):(function(r,s){const o=Gk(r,s),a=NR(o)+NR(r.Ae);return UE(o)&&UE(r.Ae)?Fk(a):Fx(r.serializer,a)})(n,e)}function rj(n,e,t){return n instanceof Eh?jk(n,e):n instanceof wh?Uk(n,e):t}function Gk(n,e){return n instanceof tg?(function(i){return UE(i)||(function(s){return!!s&&"doubleValue"in s})(i)})(e)?e:{integerValue:0}:null}class eg extends H_{}class Eh extends H_{constructor(e){super(),this.elements=e}}function jk(n,e){const t=Bk(e);for(const i of n.elements)t.some((r=>ks(r,i)))||t.push(i);return{arrayValue:{values:t}}}class wh extends H_{constructor(e){super(),this.elements=e}}function Uk(n,e){let t=Bk(e);for(const i of n.elements)t=t.filter((r=>!ks(r,i)));return{arrayValue:{values:t}}}class tg extends H_{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function NR(n){return Vt(n.integerValue||n.doubleValue)}function Bk(n){return Jf(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class sj{constructor(e,t){this.field=e,this.transform=t}}function oj(n,e){return n.field.isEqual(e.field)&&(function(i,r){return i instanceof Eh&&r instanceof Eh||i instanceof wh&&r instanceof wh?hh(i.elements,r.elements,ks):i instanceof tg&&r instanceof tg?ks(i.Ae,r.Ae):i instanceof eg&&r instanceof eg})(n.transform,e.transform)}class aj{constructor(e,t){this.version=e,this.transformResults=t}}class ci{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new ci}static exists(e){return new ci(void 0,e)}static updateTime(e){return new ci(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Bp(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class X_{}function zk(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Y_(n.key,ci.none()):new kh(n.key,n.data,ci.none());{const t=n.data,i=Qn.empty();let r=new It(zt.comparator);for(let s of e.fields)if(!r.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?i.delete(s):i.set(s,o),r=r.add(s)}return new Ro(n.key,i,new bi(r.toArray()),ci.none())}}function lj(n,e,t){n instanceof kh?(function(r,s,o){const a=r.value.clone(),u=VR(r.fieldTransforms,s,o.transformResults);a.setAll(u),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()})(n,e,t):n instanceof Ro?(function(r,s,o){if(!Bp(r.precondition,s))return void s.convertToUnknownDocument(o.version);const a=VR(r.fieldTransforms,s,o.transformResults),u=s.data;u.setAll($k(r)),u.setAll(a),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()})(n,e,t):(function(r,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function _f(n,e,t,i){return n instanceof kh?(function(s,o,a,u){if(!Bp(s.precondition,o))return a;const h=s.value.clone(),d=FR(s.fieldTransforms,u,o);return h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null})(n,e,t,i):n instanceof Ro?(function(s,o,a,u){if(!Bp(s.precondition,o))return a;const h=FR(s.fieldTransforms,u,o),d=o.data;return d.setAll($k(s)),d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map((g=>g.field)))})(n,e,t,i):(function(s,o,a){return Bp(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a})(n,e,t)}function uj(n,e){let t=null;for(const i of n.fieldTransforms){const r=e.data.field(i.field),s=Gk(i.transform,r||null);s!=null&&(t===null&&(t=Qn.empty()),t.set(i.field,s))}return t||null}function OR(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&hh(i,r,((s,o)=>oj(s,o)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class kh extends X_{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Ro extends X_{constructor(e,t,i,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function $k(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function VR(n,e,t){const i=new Map;Ce(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let r=0;r<t.length;r++){const s=n[r],o=s.transform,a=e.data.field(s.field);i.set(s.field,rj(o,a,t[r]))}return i}function FR(n,e,t){const i=new Map;for(const r of n){const s=r.transform,o=t.data.field(r.field);i.set(r.field,ij(s,o,e))}return i}class Y_ extends X_{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Wk extends X_{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Gx{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const s=this.mutations[r];s.key.isEqual(e.key)&&lj(s,e,i[r])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=_f(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=_f(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=Vk();return this.mutations.forEach((r=>{const s=e.get(r.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=t.has(r.key)?null:a;const u=zk(o,a);u!==null&&i.set(r.key,u),o.isValidDocument()||o.convertToNoDocument(Me.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Ze())}isEqual(e){return this.batchId===e.batchId&&hh(this.mutations,e.mutations,((t,i)=>OR(t,i)))&&hh(this.baseMutations,e.baseMutations,((t,i)=>OR(t,i)))}}class jx{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){Ce(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let r=(function(){return QG})();const s=e.mutations;for(let o=0;o<s.length;o++)r=r.insert(s[o].key,i[o].version);return new jx(e,t,i,r)}}class Ux{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class cj{constructor(e,t){this.count=e,this.unchangedNames=t}}var an,it;function hj(n){switch(n){case ee.OK:return Te(64938);case ee.CANCELLED:case ee.UNKNOWN:case ee.DEADLINE_EXCEEDED:case ee.RESOURCE_EXHAUSTED:case ee.INTERNAL:case ee.UNAVAILABLE:case ee.UNAUTHENTICATED:return!1;case ee.INVALID_ARGUMENT:case ee.NOT_FOUND:case ee.ALREADY_EXISTS:case ee.PERMISSION_DENIED:case ee.FAILED_PRECONDITION:case ee.ABORTED:case ee.OUT_OF_RANGE:case ee.UNIMPLEMENTED:case ee.DATA_LOSS:return!0;default:return Te(15467,{code:n})}}function Kk(n){if(n===void 0)return ui("GRPC error has no .code"),ee.UNKNOWN;switch(n){case an.OK:return ee.OK;case an.CANCELLED:return ee.CANCELLED;case an.UNKNOWN:return ee.UNKNOWN;case an.DEADLINE_EXCEEDED:return ee.DEADLINE_EXCEEDED;case an.RESOURCE_EXHAUSTED:return ee.RESOURCE_EXHAUSTED;case an.INTERNAL:return ee.INTERNAL;case an.UNAVAILABLE:return ee.UNAVAILABLE;case an.UNAUTHENTICATED:return ee.UNAUTHENTICATED;case an.INVALID_ARGUMENT:return ee.INVALID_ARGUMENT;case an.NOT_FOUND:return ee.NOT_FOUND;case an.ALREADY_EXISTS:return ee.ALREADY_EXISTS;case an.PERMISSION_DENIED:return ee.PERMISSION_DENIED;case an.FAILED_PRECONDITION:return ee.FAILED_PRECONDITION;case an.ABORTED:return ee.ABORTED;case an.OUT_OF_RANGE:return ee.OUT_OF_RANGE;case an.UNIMPLEMENTED:return ee.UNIMPLEMENTED;case an.DATA_LOSS:return ee.DATA_LOSS;default:return Te(39323,{code:n})}}(it=an||(an={}))[it.OK=0]="OK",it[it.CANCELLED=1]="CANCELLED",it[it.UNKNOWN=2]="UNKNOWN",it[it.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",it[it.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",it[it.NOT_FOUND=5]="NOT_FOUND",it[it.ALREADY_EXISTS=6]="ALREADY_EXISTS",it[it.PERMISSION_DENIED=7]="PERMISSION_DENIED",it[it.UNAUTHENTICATED=16]="UNAUTHENTICATED",it[it.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",it[it.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",it[it.ABORTED=10]="ABORTED",it[it.OUT_OF_RANGE=11]="OUT_OF_RANGE",it[it.UNIMPLEMENTED=12]="UNIMPLEMENTED",it[it.INTERNAL=13]="INTERNAL",it[it.UNAVAILABLE=14]="UNAVAILABLE",it[it.DATA_LOSS=15]="DATA_LOSS";function dj(){return new TextEncoder}const fj=new Ra([4294967295,4294967295],0);function GR(n){const e=dj().encode(n),t=new $4;return t.update(e),new Uint8Array(t.digest())}function jR(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),r=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Ra([t,i],0),new Ra([r,s],0)]}class Bx{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new Zd(`Invalid padding: ${t}`);if(i<0)throw new Zd(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new Zd(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new Zd(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Ra.fromNumber(this.ge)}ye(e,t,i){let r=e.add(t.multiply(Ra.fromNumber(i)));return r.compare(fj)===1&&(r=new Ra([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=GR(e),[i,r]=jR(t);for(let s=0;s<this.hashCount;s++){const o=this.ye(i,r,s);if(!this.we(o))return!1}return!0}static create(e,t,i){const r=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new Bx(s,r,t);return i.forEach((a=>o.insert(a))),o}insert(e){if(this.ge===0)return;const t=GR(e),[i,r]=jR(t);for(let s=0;s<this.hashCount;s++){const o=this.ye(i,r,s);this.Se(o)}}Se(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class Zd extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Z_{constructor(e,t,i,r,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const r=new Map;return r.set(e,kg.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new Z_(Me.min(),r,new Gt($e),Ki(),Ze())}}class kg{constructor(e,t,i,r,s){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new kg(i,t,Ze(),Ze(),Ze())}}class zp{constructor(e,t,i,r){this.be=e,this.removedTargetIds=t,this.key=i,this.De=r}}class qk{constructor(e,t){this.targetId=e,this.Ce=t}}class Hk{constructor(e,t,i=un.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=r}}class UR{constructor(){this.ve=0,this.Fe=BR(),this.Me=un.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Ze(),t=Ze(),i=Ze();return this.Fe.forEach(((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:i=i.add(r);break;default:Te(38017,{changeType:s})}})),new kg(this.Me,this.xe,e,t,i)}qe(){this.Oe=!1,this.Fe=BR()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Ce(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class gj{constructor(e){this.Ge=e,this.ze=new Map,this.je=Ki(),this.Je=yp(),this.He=yp(),this.Ye=new Gt($e)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.Ke(),i.Ne||i.qe(),i.Le(e.resumeToken);break;case 2:i.Ke(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.We(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:Te(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,r)=>{this.rt(r)&&t(r)}))}st(e){const t=e.targetId,i=e.Ce.count,r=this.ot(t);if(r){const s=r.target;if(L0(s))if(i===0){const o=new pe(s.path);this.et(t,o,Xt.newNoDocument(o,Me.min()))}else Ce(i===1,20013,{expectedCount:i});else{const o=this._t(t);if(o!==i){const a=this.ut(e),u=a?this.ct(a,e,o):1;if(u!==0){this.it(t);const h=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,h)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:r=0},hashCount:s=0}=t;let o,a;try{o=Eo(i).toUint8Array()}catch(u){if(u instanceof pk)return au("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{a=new Bx(o,r,s)}catch(u){return au(u instanceof Zd?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return a.ge===0?null:a}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let r=0;return i.forEach((s=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.et(t,s,null),r++)})),r}Tt(e){const t=new Map;this.ze.forEach(((s,o)=>{const a=this.ot(o);if(a){if(s.current&&L0(a.target)){const u=new pe(a.target.path);this.It(u).has(o)||this.Et(o,u)||this.et(o,u,Xt.newNoDocument(u,e))}s.Be&&(t.set(o,s.ke()),s.qe())}}));let i=Ze();this.He.forEach(((s,o)=>{let a=!0;o.forEachWhile((u=>{const h=this.ot(u);return!h||h.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)})),a&&(i=i.add(s))})),this.je.forEach(((s,o)=>o.setReadTime(e)));const r=new Z_(e,t,this.Ye,this.je,i);return this.je=Ki(),this.Je=yp(),this.He=yp(),this.Ye=new Gt($e),r}Xe(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,i),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,t)?r.Qe(t,1):r.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new UR,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new It($e),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new It($e),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||ce("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new UR),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function yp(){return new Gt(pe.comparator)}function BR(){return new Gt(pe.comparator)}const mj={asc:"ASCENDING",desc:"DESCENDING"},pj={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},_j={and:"AND",or:"OR"};class yj{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function qE(n,e){return n.useProto3Json||U_(e)?e:{value:e}}function xh(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Xk(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function vj(n,e){return xh(n,e.toTimestamp())}function di(n){return Ce(!!n,49232),Me.fromTimestamp((function(t){const i=vo(t);return new xt(i.seconds,i.nanos)})(n))}function zx(n,e){return HE(n,e).canonicalString()}function HE(n,e){const t=(function(r){return new gt(["projects",r.projectId,"databases",r.database])})(n).child("documents");return e===void 0?t:t.child(e)}function Yk(n){const e=gt.fromString(n);return Ce(sL(e),10190,{key:e.toString()}),e}function N0(n,e){return zx(n.databaseId,e.path)}function Hl(n,e){const t=Yk(e);if(t.get(1)!==n.databaseId.projectId)throw new me(ee.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new me(ee.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new pe(Jk(t))}function Zk(n,e){return zx(n.databaseId,e)}function Qk(n){const e=Yk(n);return e.length===4?gt.emptyPath():Jk(e)}function XE(n){return new gt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Jk(n){return Ce(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function zR(n,e,t){return{name:N0(n,e),fields:t.value.mapValue.fields}}function Ej(n,e,t){const i=Hl(n,e.name),r=di(e.updateTime),s=e.createTime?di(e.createTime):Me.min(),o=new Qn({mapValue:{fields:e.fields}}),a=Xt.newFoundDocument(i,r,s,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function wj(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:Te(39313,{state:h})})(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],s=(function(h,d){return h.useProto3Json?(Ce(d===void 0||typeof d=="string",58123),un.fromBase64String(d||"")):(Ce(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),un.fromUint8Array(d||new Uint8Array))})(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&(function(h){const d=h.code===void 0?ee.UNKNOWN:Kk(h.code);return new me(d,h.message||"")})(o);t=new Hk(i,r,s,a||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const r=Hl(n,i.document.name),s=di(i.document.updateTime),o=i.document.createTime?di(i.document.createTime):Me.min(),a=new Qn({mapValue:{fields:i.document.fields}}),u=Xt.newFoundDocument(r,s,o,a),h=i.targetIds||[],d=i.removedTargetIds||[];t=new zp(h,d,u.key,u)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const r=Hl(n,i.document),s=i.readTime?di(i.readTime):Me.min(),o=Xt.newNoDocument(r,s),a=i.removedTargetIds||[];t=new zp([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const r=Hl(n,i.document),s=i.removedTargetIds||[];t=new zp([],s,r,null)}else{if(!("filter"in e))return Te(11601,{Rt:e});{e.filter;const i=e.filter;i.targetId;const{count:r=0,unchangedNames:s}=i,o=new cj(r,s),a=i.targetId;t=new qk(a,o)}}return t}function O0(n,e){let t;if(e instanceof kh)t={update:zR(n,e.key,e.value)};else if(e instanceof Y_)t={delete:N0(n,e.key)};else if(e instanceof Ro)t={update:zR(n,e.key,e.data),updateMask:Rj(e.fieldMask)};else{if(!(e instanceof Wk))return Te(16599,{Vt:e.type});t={verify:N0(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(s,o){const a=o.transform;if(a instanceof eg)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Eh)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof wh)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof tg)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw Te(20930,{transform:o.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(r,s){return s.updateTime!==void 0?{updateTime:vj(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Te(27497)})(n,e.precondition)),t}function YE(n,e){const t=e.currentDocument?(function(s){return s.updateTime!==void 0?ci.updateTime(di(s.updateTime)):s.exists!==void 0?ci.exists(s.exists):ci.none()})(e.currentDocument):ci.none(),i=e.updateTransforms?e.updateTransforms.map((r=>(function(o,a){let u=null;if("setToServerValue"in a)Ce(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),u=new eg;else if("appendMissingElements"in a){const d=a.appendMissingElements.values||[];u=new Eh(d)}else if("removeAllFromArray"in a){const d=a.removeAllFromArray.values||[];u=new wh(d)}else"increment"in a?u=new tg(o,a.increment):Te(16584,{proto:a});const h=zt.fromServerFormat(a.fieldPath);return new sj(h,u)})(n,r))):[];if(e.update){e.update.name;const r=Hl(n,e.update.name),s=new Qn({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=(function(u){const h=u.fieldPaths||[];return new bi(h.map((d=>zt.fromServerFormat(d))))})(e.updateMask);return new Ro(r,s,o,t,i)}return new kh(r,s,t,i)}if(e.delete){const r=Hl(n,e.delete);return new Y_(r,t)}if(e.verify){const r=Hl(n,e.verify);return new Wk(r,t)}return Te(1463,{proto:e})}function xj(n,e){return n&&n.length>0?(Ce(e!==void 0,14353),n.map((t=>(function(r,s){let o=r.updateTime?di(r.updateTime):di(s);return o.isEqual(Me.min())&&(o=di(s)),new aj(o,r.transformResults||[])})(t,e)))):[]}function eL(n,e){return{documents:[Zk(n,e.path)]}}function tL(n,e){const t={structuredQuery:{}},i=e.path;let r;e.collectionGroup!==null?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=Zk(n,r);const s=(function(h){if(h.length!==0)return rL(Tt.create(h,"and"))})(e.filters);s&&(t.structuredQuery.where=s);const o=(function(h){if(h.length!==0)return h.map((d=>(function(m){return{field:Pc(m.field),direction:Ij(m.dir)}})(d)))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=qE(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(e.endAt)),{ft:t,parent:r}}function nL(n){let e=Qk(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let r=null;if(i>0){Ce(i===1,65062);const d=t.from[0];d.allDescendants?r=d.collectionId:e=e.child(d.collectionId)}let s=[];t.where&&(s=(function(g){const m=iL(g);return m instanceof Tt&&Ox(m)?m.getFilters():[m]})(t.where));let o=[];t.orderBy&&(o=(function(g){return g.map((m=>(function(y){return new k0(Cc(y.field),(function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(y.direction))})(m)))})(t.orderBy));let a=null;t.limit&&(a=(function(g){let m;return m=typeof g=="object"?g.value:g,U_(m)?null:m})(t.limit));let u=null;t.startAt&&(u=(function(g){const m=!!g.before,v=g.values||[];return new yh(v,m)})(t.startAt));let h=null;return t.endAt&&(h=(function(g){const m=!g.before,v=g.values||[];return new yh(v,m)})(t.endAt)),qG(e,r,o,s,a,"F",u,h)}function Tj(n,e){const t=(function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Te(28987,{purpose:r})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function iL(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Cc(t.unaryFilter.field);return et.create(i,"==",{doubleValue:NaN});case"IS_NULL":const r=Cc(t.unaryFilter.field);return et.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Cc(t.unaryFilter.field);return et.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Cc(t.unaryFilter.field);return et.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Te(61313);default:return Te(60726)}})(n):n.fieldFilter!==void 0?(function(t){return et.create(Cc(t.fieldFilter.field),(function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Te(58110);default:return Te(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Tt.create(t.compositeFilter.filters.map((i=>iL(i))),(function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return Te(1026)}})(t.compositeFilter.op))})(n):Te(30097,{filter:n})}function Ij(n){return mj[n]}function Sj(n){return pj[n]}function Aj(n){return _j[n]}function Pc(n){return{fieldPath:n.canonicalString()}}function Cc(n){return zt.fromServerFormat(n.fieldPath)}function rL(n){return n instanceof et?(function(t){if(t.op==="=="){if(RR(t.value))return{unaryFilter:{field:Pc(t.field),op:"IS_NAN"}};if(AR(t.value))return{unaryFilter:{field:Pc(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(RR(t.value))return{unaryFilter:{field:Pc(t.field),op:"IS_NOT_NAN"}};if(AR(t.value))return{unaryFilter:{field:Pc(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Pc(t.field),op:Sj(t.op),value:t.value}}})(n):n instanceof Tt?(function(t){const i=t.getFilters().map((r=>rL(r)));return i.length===1?i[0]:{compositeFilter:{op:Aj(t.op),filters:i}}})(n):Te(54877,{filter:n})}function Rj(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function sL(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class ao{constructor(e,t,i,r,s=Me.min(),o=Me.min(),a=un.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=u}withSequenceNumber(e){return new ao(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new ao(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ao(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ao(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class oL{constructor(e){this.yt=e}}function Pj(n,e){let t;if(e.document)t=Ej(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const i=pe.fromSegments(e.noDocument.path),r=hu(e.noDocument.readTime);t=Xt.newNoDocument(i,r),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Te(56709);{const i=pe.fromSegments(e.unknownDocument.path),r=hu(e.unknownDocument.version);t=Xt.newUnknownDocument(i,r)}}return e.readTime&&t.setReadTime((function(r){const s=new xt(r[0],r[1]);return Me.fromTimestamp(s)})(e.readTime)),t}function $R(n,e){const t=e.key,i={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:V0(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())i.document=(function(s,o){return{name:N0(s,o.key),fields:o.data.value.mapValue.fields,updateTime:xh(s,o.version.toTimestamp()),createTime:xh(s,o.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())i.noDocument={path:t.path.toArray(),readTime:cu(e.version)};else{if(!e.isUnknownDocument())return Te(57904,{document:e});i.unknownDocument={path:t.path.toArray(),version:cu(e.version)}}return i}function V0(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function cu(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function hu(n){const e=new xt(n.seconds,n.nanoseconds);return Me.fromTimestamp(e)}function Dl(n,e){const t=(e.baseMutations||[]).map((s=>YE(n.yt,s)));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const i=e.mutations.map((s=>YE(n.yt,s))),r=xt.fromMillis(e.localWriteTimeMs);return new Gx(e.batchId,r,t,i)}function Qd(n){const e=hu(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?hu(n.lastLimboFreeSnapshotVersion):Me.min();let i;return i=(function(s){return s.documents!==void 0})(n.query)?(function(s){const o=s.documents.length;return Ce(o===1,1966,{count:o}),Sr(Vx(Qk(s.documents[0])))})(n.query):(function(s){return Sr(nL(s))})(n.query),new ao(i,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,un.fromBase64String(n.resumeToken))}function aL(n,e){const t=cu(e.snapshotVersion),i=cu(e.lastLimboFreeSnapshotVersion);let r;r=L0(e.target)?eL(n.yt,e.target):tL(n.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:uu(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:r}}function lL(n){const e=nL({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?KE(e,e.limit,"L"):e}function A1(n,e){return new Ux(e.largestBatchId,YE(n.yt,e.overlayMutation))}function WR(n,e){const t=e.path.lastSegment();return[n,ti(e.path.popLast()),t]}function KR(n,e,t,i){return{indexId:n,uid:e,sequenceNumber:t,readTime:cu(i.readTime),documentKey:ti(i.documentKey.path),largestBatchId:i.largestBatchId}}class Cj{getBundleMetadata(e,t){return qR(e).get(t).next((i=>{if(i)return(function(s){return{id:s.bundleId,createTime:hu(s.createTime),version:s.version}})(i)}))}saveBundleMetadata(e,t){return qR(e).put((function(r){return{bundleId:r.id,createTime:cu(di(r.createTime)),version:r.version}})(t))}getNamedQuery(e,t){return HR(e).get(t).next((i=>{if(i)return(function(s){return{name:s.name,query:lL(s.bundledQuery),readTime:hu(s.readTime)}})(i)}))}saveNamedQuery(e,t){return HR(e).put((function(r){return{name:r.name,readTime:cu(di(r.readTime)),bundledQuery:r.bundledQuery}})(t))}}function qR(n){return _n(n,B_)}function HR(n){return _n(n,z_)}class Q_{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const i=t.uid||"";return new Q_(e,i)}getOverlay(e,t){return Dd(e).get(WR(this.userId,t)).next((i=>i?A1(this.serializer,i):null))}getOverlays(e,t){const i=Is();return q.forEach(t,(r=>this.getOverlay(e,r).next((s=>{s!==null&&i.set(r,s)})))).next((()=>i))}saveOverlays(e,t,i){const r=[];return i.forEach(((s,o)=>{const a=new Ux(t,o);r.push(this.St(e,a))})),q.waitFor(r)}removeOverlaysForBatchId(e,t,i){const r=new Set;t.forEach((o=>r.add(ti(o.getCollectionPath()))));const s=[];return r.forEach((o=>{const a=IDBKeyRange.bound([this.userId,o,i],[this.userId,o,i+1],!1,!0);s.push(Dd(e).Z(FE,a))})),q.waitFor(s)}getOverlaysForCollection(e,t,i){const r=Is(),s=ti(t),o=IDBKeyRange.bound([this.userId,s,i],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Dd(e).J(FE,o).next((a=>{for(const u of a){const h=A1(this.serializer,u);r.set(h.getKey(),h)}return r}))}getOverlaysForCollectionGroup(e,t,i,r){const s=Is();let o;const a=IDBKeyRange.bound([this.userId,t,i],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Dd(e).ee({index:ck,range:a},((u,h,d)=>{const g=A1(this.serializer,h);s.size()<r||g.largestBatchId===o?(s.set(g.getKey(),g),o=g.largestBatchId):d.done()})).next((()=>s))}St(e,t){return Dd(e).put((function(r,s,o){const[a,u,h]=WR(s,o.mutation.key);return{userId:s,collectionPath:u,documentId:h,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:O0(r.yt,o.mutation)}})(this.serializer,this.userId,t))}}function Dd(n){return _n(n,$_)}class Mj{bt(e){return _n(e,bx)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const i=t?.value;return i?un.fromUint8Array(i):un.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class Nl{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(Vt(e.integerValue));else if("doubleValue"in e){const i=Vt(e.doubleValue);isNaN(i)?this.Ft(t,13):(this.Ft(t,15),Kf(i)?t.Mt(0):t.Mt(i))}else if("timestampValue"in e){let i=e.timestampValue;this.Ft(t,20),typeof i=="string"&&(i=vo(i)),t.xt(`${i.seconds||""}`),t.Mt(i.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Eo(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const i=e.geoPointValue;this.Ft(t,45),t.Mt(i.latitude||0),t.Mt(i.longitude||0)}else"mapValue"in e?xk(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):K_(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):Te(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const i=e.fields||{};this.Ft(t,55);for(const r of Object.keys(i))this.Ot(r,t),this.Ct(i[r],t)}kt(e,t){const i=e.fields||{};this.Ft(t,53);const r=ph,s=i[r].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(Vt(s)),this.Ot(r,t),this.Ct(i[r],t)}Qt(e,t){const i=e.values||[];this.Ft(t,50);for(const r of i)this.Ct(r,t)}Lt(e,t){this.Ft(t,37),pe.fromName(e).path.forEach((i=>{this.Ft(t,60),this.Ut(i,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}Nl.Kt=new Nl;const _c=255;function bj(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function XR(n){const e=64-(function(i){let r=0;for(let s=0;s<8;++s){const o=bj(255&i[s]);if(r+=o,o!==8)break}return r})(n);return Math.ceil(e/8)}class kj{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Gt(i.value),i=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Jt(i.value),i=t.next();this.Ht()}Yt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Gt(i);else if(i<2048)this.Gt(960|i>>>6),this.Gt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i);else{const r=t.codePointAt(0);this.Gt(240|r>>>18),this.Gt(128|63&r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r)}}this.zt()}Zt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Jt(i);else if(i<2048)this.Jt(960|i>>>6),this.Jt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i);else{const r=t.codePointAt(0);this.Jt(240|r>>>18),this.Jt(128|63&r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r)}}this.Ht()}Xt(e){const t=this.en(e),i=XR(t);this.tn(1+i),this.buffer[this.position++]=255&i;for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=255&t[r]}nn(e){const t=this.en(e),i=XR(t);this.tn(1+i),this.buffer[this.position++]=~(255&i);for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}rn(){this.sn(_c),this.sn(255)}_n(){this.an(_c),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)})(e),i=!!(128&t[0]);t[0]^=i?255:128;for(let r=1;r<t.length;++r)t[r]^=i?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===_c?(this.sn(_c),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===_c?(this.an(_c),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let i=2*this.buffer.length;i<t&&(i=t);const r=new Uint8Array(i);r.set(this.buffer),this.buffer=r}}class Lj{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class Dj{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Nd{constructor(){this.cn=new kj,this.ln=new Lj(this.cn),this.hn=new Dj(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class Ol{constructor(e,t,i,r){this.Tn=e,this.In=t,this.En=i,this.dn=r}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,i=new Uint8Array(t);return i.set(this.dn,0),t!==e?i.set([0],this.dn.length):++i[i.length-1],new Ol(this.Tn,this.In,this.En,i)}Rn(e,t,i){return{indexId:this.Tn,uid:e,arrayValue:$p(this.En),directionalValue:$p(this.dn),orderedDocumentKey:$p(t),documentKey:i.path.toArray()}}Vn(e,t,i){const r=this.Rn(e,t,i);return[r.indexId,r.uid,r.arrayValue,r.directionalValue,r.orderedDocumentKey,r.documentKey]}}function ra(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=YR(n.En,e.En),t!==0?t:(t=YR(n.dn,e.dn),t!==0?t:pe.comparator(n.In,e.In)))}function YR(n,e){for(let t=0;t<n.length&&t<e.length;++t){const i=n[t]-e[t];if(i!==0)return i}return n.length-e.length}function $p(n){return V4()?(function(t){let i="";for(let r=0;r<t.length;r++)i+=String.fromCharCode(t[r]);return i})(n):n}function ZR(n){return typeof n!="string"?n:(function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(n)}class QR{constructor(e){this.mn=new It(((t,i)=>zt.comparator(t.field,i.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const i=t;i.isInequality()?this.mn=this.mn.add(i):this.gn.push(i)}}get pn(){return this.mn.size>1}yn(e){if(Ce(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=NE(e);if(t!==void 0&&!this.wn(t))return!1;const i=Rl(e);let r=new Set,s=0,o=0;for(;s<i.length&&this.wn(i[s]);++s)r=r.add(i[s].fieldPath.canonicalString());if(s===i.length)return!0;if(this.mn.size>0){const a=this.mn.getIterator().getNext();if(!r.has(a.field.canonicalString())){const u=i[s];if(!this.Sn(a,u)||!this.bn(this.fn[o++],u))return!1}++s}for(;s<i.length;++s){const a=i[s];if(o>=this.fn.length||!this.bn(this.fn[o++],a))return!1}return!0}Dn(){if(this.pn)return null;let e=new It(zt.comparator);const t=[];for(const i of this.gn)if(!i.field.isKeyField())if(i.op==="array-contains"||i.op==="array-contains-any")t.push(new Op(i.field,2));else{if(e.has(i.field))continue;e=e.add(i.field),t.push(new Op(i.field,0))}for(const i of this.fn)i.field.isKeyField()||e.has(i.field)||(e=e.add(i.field),t.push(new Op(i.field,i.dir==="asc"?0:1)));return new R0(R0.UNKNOWN_ID,this.collectionId,t,Wf.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const i=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===i}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function uL(n){if(Ce(n instanceof et||n instanceof Tt,20012),n instanceof et){if(n instanceof bk){const t=n.value.arrayValue?.values?.map((i=>et.create(n.field,"==",i)))||[];return Tt.create(t,"or")}return n}const e=n.filters.map((t=>uL(t)));return Tt.create(e,n.op)}function Nj(n){if(n.getFilters().length===0)return[];const e=JE(uL(n));return Ce(cL(e),7391),ZE(e)||QE(e)?[e]:e.getFilters()}function ZE(n){return n instanceof et}function QE(n){return n instanceof Tt&&Ox(n)}function cL(n){return ZE(n)||QE(n)||(function(t){if(t instanceof Tt&&BE(t)){for(const i of t.getFilters())if(!ZE(i)&&!QE(i))return!1;return!0}return!1})(n)}function JE(n){if(Ce(n instanceof et||n instanceof Tt,34018),n instanceof et)return n;if(n.filters.length===1)return JE(n.filters[0]);const e=n.filters.map((i=>JE(i)));let t=Tt.create(e,n.op);return t=F0(t),cL(t)?t:(Ce(t instanceof Tt,64498),Ce(vh(t),40251),Ce(t.filters.length>1,57927),t.filters.reduce(((i,r)=>$x(i,r))))}function $x(n,e){let t;return Ce(n instanceof et||n instanceof Tt,38388),Ce(e instanceof et||e instanceof Tt,25473),t=n instanceof et?e instanceof et?(function(r,s){return Tt.create([r,s],"and")})(n,e):JR(n,e):e instanceof et?JR(e,n):(function(r,s){if(Ce(r.filters.length>0&&s.filters.length>0,48005),vh(r)&&vh(s))return Pk(r,s.getFilters());const o=BE(r)?r:s,a=BE(r)?s:r,u=o.filters.map((h=>$x(h,a)));return Tt.create(u,"or")})(n,e),F0(t)}function JR(n,e){if(vh(e))return Pk(e,n.getFilters());{const t=e.filters.map((i=>$x(n,i)));return Tt.create(t,"or")}}function F0(n){if(Ce(n instanceof et||n instanceof Tt,11850),n instanceof et)return n;const e=n.getFilters();if(e.length===1)return F0(e[0]);if(Ak(n))return n;const t=e.map((r=>F0(r))),i=[];return t.forEach((r=>{r instanceof et?i.push(r):r instanceof Tt&&(r.op===n.op?i.push(...r.filters):i.push(r))})),i.length===1?i[0]:Tt.create(i,n.op)}class Oj{constructor(){this.Cn=new Wx}addToCollectionParentIndex(e,t){return this.Cn.add(t),q.resolve()}getCollectionParents(e,t){return q.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return q.resolve()}deleteFieldIndex(e,t){return q.resolve()}deleteAllFieldIndexes(e){return q.resolve()}createTargetIndexes(e,t){return q.resolve()}getDocumentsMatchingTarget(e,t){return q.resolve(null)}getIndexType(e,t){return q.resolve(0)}getFieldIndexes(e,t){return q.resolve([])}getNextCollectionGroupToUpdate(e){return q.resolve(null)}getMinOffset(e,t){return q.resolve(Qi.min())}getMinOffsetFromCollectionGroup(e,t){return q.resolve(Qi.min())}updateCollectionGroup(e,t,i){return q.resolve()}updateIndexEntries(e,t){return q.resolve()}}class Wx{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new It(gt.comparator),s=!r.has(i);return this.index[t]=r.add(i),s}has(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new It(gt.comparator)).toArray()}}const eP="IndexedDbIndexManager",vp=new Uint8Array(0);class Vj{constructor(e,t){this.databaseId=t,this.vn=new Wx,this.Fn=new Ao((i=>uu(i)),((i,r)=>Cg(i,r))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const i=t.lastSegment(),r=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const s={collectionId:i,parent:ti(r)};return tP(e).put(s)}return q.resolve()}getCollectionParents(e,t){const i=[],r=IDBKeyRange.bound([t,""],[Q4(t),""],!1,!0);return tP(e).J(r).next((s=>{for(const o of s){if(o.collectionId!==t)break;i.push(Ts(o.parent))}return i}))}addFieldIndex(e,t){const i=Od(e),r=(function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map((u=>[u.fieldPath.canonicalString(),u.kind]))}})(t);delete r.indexId;const s=i.add(r);if(t.indexState){const o=vc(e);return s.next((a=>{o.put(KR(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return s.next()}deleteFieldIndex(e,t){const i=Od(e),r=vc(e),s=yc(e);return i.delete(t.indexId).next((()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=Od(e),i=yc(e),r=vc(e);return t.Z().next((()=>i.Z())).next((()=>r.Z()))}createTargetIndexes(e,t){return q.forEach(this.Mn(t),(i=>this.getIndexType(e,i).next((r=>{if(r===0||r===1){const s=new QR(i).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))))}getDocumentsMatchingTarget(e,t){const i=yc(e);let r=!0;const s=new Map;return q.forEach(this.Mn(t),(o=>this.xn(e,o).next((a=>{r&&(r=!!a),s.set(o,a)})))).next((()=>{if(r){let o=Ze();const a=[];return q.forEach(s,((u,h)=>{ce(eP,`Using index ${(function(b){return`id=${b.indexId}|cg=${b.collectionGroup}|f=${b.fields.map((L=>`${L.fieldPath}:${L.kind}`)).join(",")}`})(u)} to execute ${uu(t)}`);const d=(function(b,L){const D=NE(L);if(D===void 0)return null;for(const B of D0(b,D.fieldPath))switch(B.op){case"array-contains-any":return B.value.arrayValue.values||[];case"array-contains":return[B.value]}return null})(h,u),g=(function(b,L){const D=new Map;for(const B of Rl(L))for(const M of D0(b,B.fieldPath))switch(M.op){case"==":case"in":D.set(B.fieldPath.canonicalString(),M.value);break;case"not-in":case"!=":return D.set(B.fieldPath.canonicalString(),M.value),Array.from(D.values())}return null})(h,u),m=(function(b,L){const D=[];let B=!0;for(const M of Rl(L)){const A=M.kind===0?kR(b,M.fieldPath,b.startAt):LR(b,M.fieldPath,b.startAt);D.push(A.value),B&&(B=A.inclusive)}return new yh(D,B)})(h,u),v=(function(b,L){const D=[];let B=!0;for(const M of Rl(L)){const A=M.kind===0?LR(b,M.fieldPath,b.endAt):kR(b,M.fieldPath,b.endAt);D.push(A.value),B&&(B=A.inclusive)}return new yh(D,B)})(h,u),y=this.On(u,h,m),I=this.On(u,h,v),w=this.Nn(u,h,g),R=this.Bn(u.indexId,d,y,m.inclusive,I,v.inclusive,w);return q.forEach(R,(P=>i.Y(P,t.limit).next((b=>{b.forEach((L=>{const D=pe.fromSegments(L.documentKey);o.has(D)||(o=o.add(D),a.push(D))}))}))))})).next((()=>a))}return q.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=Nj(Tt.create(e.filters,"and")).map((i=>$E(e.path,e.collectionGroup,e.orderBy,i.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,i,r,s,o,a){const u=(t!=null?t.length:1)*Math.max(i.length,s.length),h=u/(t!=null?t.length:1),d=[];for(let g=0;g<u;++g){const m=t?this.Ln(t[g/h]):vp,v=this.kn(e,m,i[g%h],r),y=this.qn(e,m,s[g%h],o),I=a.map((w=>this.kn(e,m,w,!0)));d.push(...this.createRange(v,y,I))}return d}kn(e,t,i,r){const s=new Ol(e,pe.empty(),t,i);return r?s:s.An()}qn(e,t,i,r){const s=new Ol(e,pe.empty(),t,i);return r?s.An():s}xn(e,t){const i=new QR(t),r=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next((s=>{let o=null;for(const a of s)i.yn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o}))}getIndexType(e,t){let i=2;const r=this.Mn(t);return q.forEach(r,(s=>this.xn(e,s).next((o=>{o?i!==0&&o.fields.length<(function(u){let h=new It(zt.comparator),d=!1;for(const g of u.filters)for(const m of g.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?d=!0:h=h.add(m.field));for(const g of u.orderBy)g.field.isKeyField()||(h=h.add(g.field));return h.size+(d?1:0)})(s)&&(i=1):i=0})))).next((()=>(function(o){return o.limit!==null})(t)&&r.length>1&&i===2?1:i))}Qn(e,t){const i=new Nd;for(const r of Rl(e)){const s=t.data.field(r.fieldPath);if(s==null)return null;const o=i.Pn(r.kind);Nl.Kt.Dt(s,o)}return i.un()}Ln(e){const t=new Nd;return Nl.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const i=new Nd;return Nl.Kt.Dt(Qf(this.databaseId,t),i.Pn((function(s){const o=Rl(s);return o.length===0?0:o[o.length-1].kind})(e))),i.un()}Nn(e,t,i){if(i===null)return[];let r=[];r.push(new Nd);let s=0;for(const o of Rl(e)){const a=i[s++];for(const u of r)if(this.Un(t,o.fieldPath)&&Jf(a))r=this.Kn(r,o,a);else{const h=u.Pn(o.kind);Nl.Kt.Dt(a,h)}}return this.Wn(r)}On(e,t,i){return this.Nn(e,t,i.position)}Wn(e){const t=[];for(let i=0;i<e.length;++i)t[i]=e[i].un();return t}Kn(e,t,i){const r=[...e],s=[];for(const o of i.arrayValue.values||[])for(const a of r){const u=new Nd;u.seed(a.un()),Nl.Kt.Dt(o,u.Pn(t.kind)),s.push(u)}return s}Un(e,t){return!!e.filters.find((i=>i instanceof et&&i.field.isEqual(t)&&(i.op==="in"||i.op==="not-in")))}getFieldIndexes(e,t){const i=Od(e),r=vc(e);return(t?i.J(VE,IDBKeyRange.bound(t,t)):i.J()).next((s=>{const o=[];return q.forEach(s,(a=>r.get([a.indexId,this.uid]).next((u=>{o.push((function(d,g){const m=g?new Wf(g.sequenceNumber,new Qi(hu(g.readTime),new pe(Ts(g.documentKey)),g.largestBatchId)):Wf.empty(),v=d.fields.map((([y,I])=>new Op(zt.fromServerFormat(y),I)));return new R0(d.indexId,d.collectionGroup,v,m)})(a,u))})))).next((()=>o))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((i,r)=>{const s=i.indexState.sequenceNumber-r.indexState.sequenceNumber;return s!==0?s:$e(i.collectionGroup,r.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,i){const r=Od(e),s=vc(e);return this.Gn(e).next((o=>r.J(VE,IDBKeyRange.bound(t,t)).next((a=>q.forEach(a,(u=>s.put(KR(u.indexId,this.uid,o,i))))))))}updateIndexEntries(e,t){const i=new Map;return q.forEach(t,((r,s)=>{const o=i.get(r.collectionGroup);return(o?q.resolve(o):this.getFieldIndexes(e,r.collectionGroup)).next((a=>(i.set(r.collectionGroup,a),q.forEach(a,(u=>this.zn(e,r,u).next((h=>{const d=this.jn(s,u);return h.isEqual(d)?q.resolve():this.Jn(e,s,u,h,d)})))))))}))}Hn(e,t,i,r){return yc(e).put(r.Rn(this.uid,this.$n(i,t.key),t.key))}Yn(e,t,i,r){return yc(e).delete(r.Vn(this.uid,this.$n(i,t.key),t.key))}zn(e,t,i){const r=yc(e);let s=new It(ra);return r.ee({index:uk,range:IDBKeyRange.only([i.indexId,this.uid,$p(this.$n(i,t))])},((o,a)=>{s=s.add(new Ol(i.indexId,t,ZR(a.arrayValue),ZR(a.directionalValue)))})).next((()=>s))}jn(e,t){let i=new It(ra);const r=this.Qn(t,e);if(r==null)return i;const s=NE(t);if(s!=null){const o=e.data.field(s.fieldPath);if(Jf(o))for(const a of o.arrayValue.values||[])i=i.add(new Ol(t.indexId,e.key,this.Ln(a),r))}else i=i.add(new Ol(t.indexId,e.key,vp,r));return i}Jn(e,t,i,r,s){ce(eP,"Updating index entries for document '%s'",t.key);const o=[];return(function(u,h,d,g,m){const v=u.getIterator(),y=h.getIterator();let I=pc(v),w=pc(y);for(;I||w;){let R=!1,P=!1;if(I&&w){const b=d(I,w);b<0?P=!0:b>0&&(R=!0)}else I!=null?P=!0:R=!0;R?(g(w),w=pc(y)):P?(m(I),I=pc(v)):(I=pc(v),w=pc(y))}})(r,s,ra,(a=>{o.push(this.Hn(e,t,i,a))}),(a=>{o.push(this.Yn(e,t,i,a))})),q.waitFor(o)}Gn(e){let t=1;return vc(e).ee({index:lk,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((i,r,s)=>{s.done(),t=r.sequenceNumber+1})).next((()=>t))}createRange(e,t,i){i=i.sort(((o,a)=>ra(o,a))).filter(((o,a,u)=>!a||ra(o,u[a-1])!==0));const r=[];r.push(e);for(const o of i){const a=ra(o,e),u=ra(o,t);if(a===0)r[0]=e.An();else if(a>0&&u<0)r.push(o),r.push(o.An());else if(u>0)break}r.push(t);const s=[];for(let o=0;o<r.length;o+=2){if(this.Zn(r[o],r[o+1]))return[];const a=r[o].Vn(this.uid,vp,pe.empty()),u=r[o+1].Vn(this.uid,vp,pe.empty());s.push(IDBKeyRange.bound(a,u))}return s}Zn(e,t){return ra(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(nP)}getMinOffset(e,t){return q.mapArray(this.Mn(t),(i=>this.xn(e,i).next((r=>r||Te(44426))))).next(nP)}}function tP(n){return _n(n,Xf)}function yc(n){return _n(n,ff)}function Od(n){return _n(n,Mx)}function vc(n){return _n(n,df)}function nP(n){Ce(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let i=1;i<n.length;i++){const r=n[i].indexState.offset;Rx(r,e)<0&&(e=r),t<r.largestBatchId&&(t=r.largestBatchId)}return new Qi(e.readTime,e.documentKey,t)}const iP={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},hL=41943040;class Yn{static withCacheSize(e){return new Yn(e,Yn.DEFAULT_COLLECTION_PERCENTILE,Yn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}function dL(n,e,t){const i=n.store(Ur),r=n.store(dh),s=[],o=IDBKeyRange.only(t.batchId);let a=0;const u=i.ee({range:o},((d,g,m)=>(a++,m.delete())));s.push(u.next((()=>{Ce(a===1,47070,{batchId:t.batchId})})));const h=[];for(const d of t.mutations){const g=sk(e,d.key.path,t.batchId);s.push(r.delete(g)),h.push(d.key)}return q.waitFor(s).next((()=>h))}function G0(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Te(14731);e=n.noDocument}return JSON.stringify(e).length}Yn.DEFAULT_COLLECTION_PERCENTILE=10,Yn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Yn.DEFAULT=new Yn(hL,Yn.DEFAULT_COLLECTION_PERCENTILE,Yn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Yn.DISABLED=new Yn(-1,0,0);class J_{constructor(e,t,i,r){this.userId=e,this.serializer=t,this.indexManager=i,this.referenceDelegate=r,this.Xn={}}static wt(e,t,i,r){Ce(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new J_(s,t,i,r)}checkEmpty(e){let t=!0;const i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return sa(e).ee({index:Bl,range:i},((r,s,o)=>{t=!1,o.done()})).next((()=>t))}addMutationBatch(e,t,i,r){const s=Mc(e),o=sa(e);return o.add({}).next((a=>{Ce(typeof a=="number",49019);const u=new Gx(a,t,i,r),h=(function(v,y,I){const w=I.baseMutations.map((P=>O0(v.yt,P))),R=I.mutations.map((P=>O0(v.yt,P)));return{userId:y,batchId:I.batchId,localWriteTimeMs:I.localWriteTime.toMillis(),baseMutations:w,mutations:R}})(this.serializer,this.userId,u),d=[];let g=new It(((m,v)=>$e(m.canonicalString(),v.canonicalString())));for(const m of r){const v=sk(this.userId,m.key.path,a);g=g.add(m.key.path.popLast()),d.push(o.put(h)),d.push(s.put(v,hG))}return g.forEach((m=>{d.push(this.indexManager.addToCollectionParentIndex(e,m))})),e.addOnCommittedListener((()=>{this.Xn[a]=u.keys()})),q.waitFor(d).next((()=>u))}))}lookupMutationBatch(e,t){return sa(e).get(t).next((i=>i?(Ce(i.userId===this.userId,48,"Unexpected user for mutation batch",{userId:i.userId,batchId:t}),Dl(this.serializer,i)):null))}er(e,t){return this.Xn[t]?q.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((i=>{if(i){const r=i.keys();return this.Xn[t]=r,r}return null}))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=IDBKeyRange.lowerBound([this.userId,i]);let s=null;return sa(e).ee({index:Bl,range:r},((o,a,u)=>{a.userId===this.userId&&(Ce(a.batchId>=i,47524,{tr:i}),s=Dl(this.serializer,a)),u.done()})).next((()=>s))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let i=Kl;return sa(e).ee({index:Bl,range:t,reverse:!0},((r,s,o)=>{i=s.batchId,o.done()})).next((()=>i))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Kl],[this.userId,Number.POSITIVE_INFINITY]);return sa(e).J(Bl,t).next((i=>i.map((r=>Dl(this.serializer,r)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const i=Vp(this.userId,t.path),r=IDBKeyRange.lowerBound(i),s=[];return Mc(e).ee({range:r},((o,a,u)=>{const[h,d,g]=o,m=Ts(d);if(h===this.userId&&t.path.isEqual(m))return sa(e).get(g).next((v=>{if(!v)throw Te(61480,{nr:o,batchId:g});Ce(v.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:v.userId,batchId:g}),s.push(Dl(this.serializer,v))}));u.done()})).next((()=>s))}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new It($e);const r=[];return t.forEach((s=>{const o=Vp(this.userId,s.path),a=IDBKeyRange.lowerBound(o),u=Mc(e).ee({range:a},((h,d,g)=>{const[m,v,y]=h,I=Ts(v);m===this.userId&&s.path.isEqual(I)?i=i.add(y):g.done()}));r.push(u)})),q.waitFor(r).next((()=>this.rr(e,i)))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1,s=Vp(this.userId,i),o=IDBKeyRange.lowerBound(s);let a=new It($e);return Mc(e).ee({range:o},((u,h,d)=>{const[g,m,v]=u,y=Ts(m);g===this.userId&&i.isPrefixOf(y)?y.length===r&&(a=a.add(v)):d.done()})).next((()=>this.rr(e,a)))}rr(e,t){const i=[],r=[];return t.forEach((s=>{r.push(sa(e).get(s).next((o=>{if(o===null)throw Te(35274,{batchId:s});Ce(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:s}),i.push(Dl(this.serializer,o))})))})),q.waitFor(r).next((()=>i))}removeMutationBatch(e,t){return dL(e.le,this.userId,t).next((i=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),q.forEach(i,(r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return q.resolve();const i=IDBKeyRange.lowerBound((function(o){return[o]})(this.userId)),r=[];return Mc(e).ee({range:i},((s,o,a)=>{if(s[0]===this.userId){const u=Ts(s[1]);r.push(u)}else a.done()})).next((()=>{Ce(r.length===0,56720,{sr:r.map((s=>s.canonicalString()))})}))}))}containsKey(e,t){return fL(e,this.userId,t)}_r(e){return gL(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:Kl,lastStreamToken:""}))}}function fL(n,e,t){const i=Vp(e,t.path),r=i[1],s=IDBKeyRange.lowerBound(i);let o=!1;return Mc(n).ee({range:s,X:!0},((a,u,h)=>{const[d,g,m]=a;d===e&&g===r&&(o=!0),h.done()})).next((()=>o))}function sa(n){return _n(n,Ur)}function Mc(n){return _n(n,dh)}function gL(n){return _n(n,qf)}class du{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new du(0)}static cr(){return new du(-1)}}class Fj{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const i=new du(t.highestTargetId);return t.highestTargetId=i.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>Me.fromTimestamp(new xt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,i){return this.lr(e).next((r=>(r.highestListenSequenceNumber=t,i&&(r.lastRemoteSnapshotVersion=i.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.hr(e,r))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((i=>(i.targetCount+=1,this.Tr(t,i),this.hr(e,i))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>Ec(e).delete(t.targetId))).next((()=>this.lr(e))).next((i=>(Ce(i.targetCount>0,8065),i.targetCount-=1,this.hr(e,i))))}removeTargets(e,t,i){let r=0;const s=[];return Ec(e).ee(((o,a)=>{const u=Qd(a);u.sequenceNumber<=t&&i.get(u.targetId)===null&&(r++,s.push(this.removeTargetData(e,u)))})).next((()=>q.waitFor(s))).next((()=>r))}forEachTarget(e,t){return Ec(e).ee(((i,r)=>{const s=Qd(r);t(s)}))}lr(e){return rP(e).get(M0).next((t=>(Ce(t!==null,2888),t)))}hr(e,t){return rP(e).put(M0,t)}Pr(e,t){return Ec(e).put(aL(this.serializer,t))}Tr(e,t){let i=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,i=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,i=!0),i}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const i=uu(t),r=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]);let s=null;return Ec(e).ee({range:r,index:ak},((o,a,u)=>{const h=Qd(a);Cg(t,h.target)&&(s=h,u.done())})).next((()=>s))}addMatchingKeys(e,t,i){const r=[],s=da(e);return t.forEach((o=>{const a=ti(o.path);r.push(s.put({targetId:i,path:a})),r.push(this.referenceDelegate.addReference(e,i,o))})),q.waitFor(r)}removeMatchingKeys(e,t,i){const r=da(e);return q.forEach(t,(s=>{const o=ti(s.path);return q.waitFor([r.delete([i,o]),this.referenceDelegate.removeReference(e,i,s)])}))}removeMatchingKeysForTargetId(e,t){const i=da(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return i.delete(r)}getMatchingKeysForTargetId(e,t){const i=IDBKeyRange.bound([t],[t+1],!1,!0),r=da(e);let s=Ze();return r.ee({range:i,X:!0},((o,a,u)=>{const h=Ts(o[1]),d=new pe(h);s=s.add(d)})).next((()=>s))}containsKey(e,t){const i=ti(t.path),r=IDBKeyRange.bound([i],[Q4(i)],!1,!0);let s=0;return da(e).ee({index:Cx,X:!0,range:r},(([o,a],u,h)=>{o!==0&&(s++,h.done())})).next((()=>s>0))}At(e,t){return Ec(e).get(t).next((i=>i?Qd(i):null))}}function Ec(n){return _n(n,fh)}function rP(n){return _n(n,ql)}function da(n){return _n(n,gh)}const sP="LruGarbageCollector",Gj=1048576;function oP([n,e],[t,i]){const r=$e(n,t);return r===0?$e(e,i):r}class jj{constructor(e){this.Ir=e,this.buffer=new It(oP),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();oP(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class mL{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){ce(sP,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){$a(t)?ce(sP,"Ignoring IndexedDB error during garbage collection: ",t):await Tu(t)}await this.Vr(3e5)}))}}class Uj{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return q.resolve(Tr.ce);const i=new jj(t);return this.mr.forEachTarget(e,(r=>i.Ar(r.sequenceNumber))).next((()=>this.mr.pr(e,(r=>i.Ar(r))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.mr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ce("LruGarbageCollector","Garbage collection skipped; disabled"),q.resolve(iP)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(ce("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),iP):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let i,r,s,o,a,u,h;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((g=>(g>this.params.maximumSequenceNumbersToCollect?(ce("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${g}`),r=this.params.maximumSequenceNumbersToCollect):r=g,o=Date.now(),this.nthSequenceNumber(e,r)))).next((g=>(i=g,a=Date.now(),this.removeTargets(e,i,t)))).next((g=>(s=g,u=Date.now(),this.removeOrphanedDocuments(e,i)))).next((g=>(h=Date.now(),Ac()<=Je.DEBUG&&ce("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${r} in `+(a-o)+`ms
	Removed ${s} targets in `+(u-a)+`ms
	Removed ${g} documents in `+(h-u)+`ms
Total Duration: ${h-d}ms`),q.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:g}))))}}function pL(n,e){return new Uj(n,e)}class Bj{constructor(e,t){this.db=e,this.garbageCollector=pL(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((i=>t.next((r=>i+r))))}wr(e){let t=0;return this.pr(e,(i=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((i,r)=>t(r)))}addReference(e,t,i){return Ep(e,i)}removeReference(e,t,i){return Ep(e,i)}removeTargets(e,t,i){return this.db.getTargetCache().removeTargets(e,t,i)}markPotentiallyOrphaned(e,t){return Ep(e,t)}br(e,t){return(function(r,s){let o=!1;return gL(r).te((a=>fL(r,a,s).next((u=>(u&&(o=!0),q.resolve(!u)))))).next((()=>o))})(e,t)}removeOrphanedDocuments(e,t){const i=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let s=0;return this.Sr(e,((o,a)=>{if(a<=t){const u=this.br(e,o).next((h=>{if(!h)return s++,i.getEntry(e,o).next((()=>(i.removeEntry(o,Me.min()),da(e).delete((function(g){return[0,ti(g.path)]})(o)))))}));r.push(u)}})).next((()=>q.waitFor(r))).next((()=>i.apply(e))).next((()=>s))}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,i)}updateLimboDocument(e,t){return Ep(e,t)}Sr(e,t){const i=da(e);let r,s=Tr.ce;return i.ee({index:Cx},(([o,a],{path:u,sequenceNumber:h})=>{o===0?(s!==Tr.ce&&t(new pe(Ts(r)),s),s=h,r=u):s=Tr.ce})).next((()=>{s!==Tr.ce&&t(new pe(Ts(r)),s)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Ep(n,e){return da(n).put((function(i,r){return{targetId:0,path:ti(i.path),sequenceNumber:r}})(e,n.currentSequenceNumber))}class _L{constructor(){this.changes=new Ao((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Xt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?q.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class zj{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,i){return xl(e).put(i)}removeEntry(e,t,i){return xl(e).delete((function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],V0(o),a[a.length-1]]})(t,i))}updateMetadata(e,t){return this.getMetadata(e).next((i=>(i.byteSize+=t,this.Dr(e,i))))}getEntry(e,t){let i=Xt.newInvalidDocument(t);return xl(e).ee({index:Fp,range:IDBKeyRange.only(Vd(t))},((r,s)=>{i=this.Cr(t,s)})).next((()=>i))}vr(e,t){let i={size:0,document:Xt.newInvalidDocument(t)};return xl(e).ee({index:Fp,range:IDBKeyRange.only(Vd(t))},((r,s)=>{i={document:this.Cr(t,s),size:G0(s)}})).next((()=>i))}getEntries(e,t){let i=Ki();return this.Fr(e,t,((r,s)=>{const o=this.Cr(r,s);i=i.insert(r,o)})).next((()=>i))}Mr(e,t){let i=Ki(),r=new Gt(pe.comparator);return this.Fr(e,t,((s,o)=>{const a=this.Cr(s,o);i=i.insert(s,a),r=r.insert(s,G0(o))})).next((()=>({documents:i,Or:r})))}Fr(e,t,i){if(t.isEmpty())return q.resolve();let r=new It(uP);t.forEach((u=>r=r.add(u)));const s=IDBKeyRange.bound(Vd(r.first()),Vd(r.last())),o=r.getIterator();let a=o.getNext();return xl(e).ee({index:Fp,range:s},((u,h,d)=>{const g=pe.fromSegments([...h.prefixPath,h.collectionGroup,h.documentId]);for(;a&&uP(a,g)<0;)i(a,null),a=o.getNext();a&&a.isEqual(g)&&(i(a,h),a=o.hasNext()?o.getNext():null),a?d.j(Vd(a)):d.done()})).next((()=>{for(;a;)i(a,null),a=o.hasNext()?o.getNext():null}))}getDocumentsMatchingQuery(e,t,i,r,s){const o=t.path,a=[o.popLast().toArray(),o.lastSegment(),V0(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return xl(e).J(IDBKeyRange.bound(a,u,!0)).next((h=>{s?.incrementDocumentReadCount(h.length);let d=Ki();for(const g of h){const m=this.Cr(pe.fromSegments(g.prefixPath.concat(g.collectionGroup,g.documentId)),g);m.isFoundDocument()&&(bg(t,m)||r.has(m.key))&&(d=d.insert(m.key,m))}return d}))}getAllFromCollectionGroup(e,t,i,r){let s=Ki();const o=lP(t,i),a=lP(t,Qi.max());return xl(e).ee({index:ok,range:IDBKeyRange.bound(o,a,!0)},((u,h,d)=>{const g=this.Cr(pe.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);s=s.insert(g.key,g),s.size===r&&d.done()})).next((()=>s))}newChangeBuffer(e){return new $j(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return aP(e).get(OE).next((t=>(Ce(!!t,20021),t)))}Dr(e,t){return aP(e).put(OE,t)}Cr(e,t){if(t){const i=Pj(this.serializer,t);if(!(i.isNoDocument()&&i.version.isEqual(Me.min())))return i}return Xt.newInvalidDocument(e)}}function yL(n){return new zj(n)}class $j extends _L{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new Ao((i=>i.toString()),((i,r)=>i.isEqual(r)))}applyChanges(e){const t=[];let i=0,r=new It(((s,o)=>$e(s.canonicalString(),o.canonicalString())));return this.changes.forEach(((s,o)=>{const a=this.Br.get(s);if(t.push(this.Nr.removeEntry(e,s,a.readTime)),o.isValidDocument()){const u=$R(this.Nr.serializer,o);r=r.add(s.path.popLast());const h=G0(u);i+=h-a.size,t.push(this.Nr.addEntry(e,s,u))}else if(i-=a.size,this.trackRemovals){const u=$R(this.Nr.serializer,o.convertToNoDocument(Me.min()));t.push(this.Nr.addEntry(e,s,u))}})),r.forEach((s=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))})),t.push(this.Nr.updateMetadata(e,i)),q.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((i=>(this.Br.set(t,{size:i.size,readTime:i.document.readTime}),i.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:i,Or:r})=>(r.forEach(((s,o)=>{this.Br.set(s,{size:o,readTime:i.get(s).readTime})})),i)))}}function aP(n){return _n(n,Hf)}function xl(n){return _n(n,C0)}function Vd(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function lP(n,e){const t=e.documentKey.path.toArray();return[n,V0(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function uP(n,e){const t=n.path.toArray(),i=e.path.toArray();let r=0;for(let s=0;s<t.length-2&&s<i.length-2;++s)if(r=$e(t[s],i[s]),r)return r;return r=$e(t.length,i.length),r||(r=$e(t[t.length-2],i[i.length-2]),r||$e(t[t.length-1],i[i.length-1]))}class Wj{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class vL{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(i=r,this.remoteDocumentCache.getEntry(e,t)))).next((r=>(i!==null&&_f(i.mutation,r,bi.empty(),xt.now()),r)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,Ze()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=Ze()){const r=Is();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,i).next((s=>{let o=Yd();return s.forEach(((a,u)=>{o=o.insert(a,u.overlayedDocument)})),o}))))}getOverlayedDocuments(e,t){const i=Is();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,Ze())))}populateOverlays(e,t,i){const r=[];return i.forEach((s=>{t.has(s)||r.push(s)})),this.documentOverlayCache.getOverlays(e,r).next((s=>{s.forEach(((o,a)=>{t.set(o,a)}))}))}computeViews(e,t,i,r){let s=Ki();const o=pf(),a=(function(){return pf()})();return t.forEach(((u,h)=>{const d=i.get(h.key);r.has(h.key)&&(d===void 0||d.mutation instanceof Ro)?s=s.insert(h.key,h):d!==void 0?(o.set(h.key,d.mutation.getFieldMask()),_f(d.mutation,h,d.mutation.getFieldMask(),xt.now())):o.set(h.key,bi.empty())})),this.recalculateAndSaveOverlays(e,s).next((u=>(u.forEach(((h,d)=>o.set(h,d))),t.forEach(((h,d)=>a.set(h,new Wj(d,o.get(h)??null)))),a)))}recalculateAndSaveOverlays(e,t){const i=pf();let r=new Gt(((o,a)=>o-a)),s=Ze();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((o=>{for(const a of o)a.keys().forEach((u=>{const h=t.get(u);if(h===null)return;let d=i.get(u)||bi.empty();d=a.applyToLocalView(h,d),i.set(u,d);const g=(r.get(a.batchId)||Ze()).add(u);r=r.insert(a.batchId,g)}))})).next((()=>{const o=[],a=r.getReverseIterator();for(;a.hasNext();){const u=a.getNext(),h=u.key,d=u.value,g=Vk();d.forEach((m=>{if(!s.has(m)){const v=zk(t.get(m),i.get(m));v!==null&&g.set(m,v),s=s.add(m)}})),o.push(this.documentOverlayCache.saveOverlays(e,h,g))}return q.waitFor(o)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,r){return(function(o){return pe.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):kk(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next((s=>{const o=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-s.size):q.resolve(Is());let a=$f,u=s;return o.next((h=>q.forEach(h,((d,g)=>(a<g.largestBatchId&&(a=g.largestBatchId),s.get(d)?q.resolve():this.remoteDocumentCache.getEntry(e,d).next((m=>{u=u.insert(d,m)}))))).next((()=>this.populateOverlays(e,h,s))).next((()=>this.computeViews(e,u,h,Ze()))).next((d=>({batchId:a,changes:Ok(d)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new pe(t)).next((i=>{let r=Yd();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){const s=t.collectionGroup;let o=Yd();return this.indexManager.getCollectionParents(e,s).next((a=>q.forEach(a,(u=>{const h=(function(g,m){return new Mg(m,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)})(t,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,h,i,r).next((d=>{d.forEach(((g,m)=>{o=o.insert(g,m)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,t,i,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,s,r)))).next((o=>{s.forEach(((u,h)=>{const d=h.getKey();o.get(d)===null&&(o=o.insert(d,Xt.newInvalidDocument(d)))}));let a=Yd();return o.forEach(((u,h)=>{const d=s.get(u);d!==void 0&&_f(d.mutation,h,bi.empty(),xt.now()),bg(t,h)&&(a=a.insert(u,h))})),a}))}}class Kj{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return q.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(r){return{id:r.id,version:r.version,createTime:di(r.createTime)}})(t)),q.resolve()}getNamedQuery(e,t){return q.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(r){return{name:r.name,query:lL(r.bundledQuery),readTime:di(r.readTime)}})(t)),q.resolve()}}class qj{constructor(){this.overlays=new Gt(pe.comparator),this.qr=new Map}getOverlay(e,t){return q.resolve(this.overlays.get(t))}getOverlays(e,t){const i=Is();return q.forEach(t,(r=>this.getOverlay(e,r).next((s=>{s!==null&&i.set(r,s)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((r,s)=>{this.St(e,t,s)})),q.resolve()}removeOverlaysForBatchId(e,t,i){const r=this.qr.get(i);return r!==void 0&&(r.forEach((s=>this.overlays=this.overlays.remove(s))),this.qr.delete(i)),q.resolve()}getOverlaysForCollection(e,t,i){const r=Is(),s=t.length+1,o=new pe(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const u=a.getNext().value,h=u.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===s&&u.largestBatchId>i&&r.set(u.getKey(),u)}return q.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let s=new Gt(((h,d)=>h-d));const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>i){let d=s.get(h.largestBatchId);d===null&&(d=Is(),s=s.insert(h.largestBatchId,d)),d.set(h.getKey(),h)}}const a=Is(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach(((h,d)=>a.set(h,d))),!(a.size()>=r)););return q.resolve(a)}St(e,t,i){const r=this.overlays.get(i.key);if(r!==null){const o=this.qr.get(r.largestBatchId).delete(i.key);this.qr.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new Ux(t,i));let s=this.qr.get(t);s===void 0&&(s=Ze(),this.qr.set(t,s)),this.qr.set(t,s.add(i.key))}}class Hj{constructor(){this.sessionToken=un.EMPTY_BYTE_STRING}getSessionToken(e){return q.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,q.resolve()}}class Kx{constructor(){this.Qr=new It(In.$r),this.Ur=new It(In.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const i=new In(e,t);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Gr(new In(e,t))}zr(e,t){e.forEach((i=>this.removeReference(i,t)))}jr(e){const t=new pe(new gt([])),i=new In(t,e),r=new In(t,e+1),s=[];return this.Ur.forEachInRange([i,r],(o=>{this.Gr(o),s.push(o.key)})),s}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new pe(new gt([])),i=new In(t,e),r=new In(t,e+1);let s=Ze();return this.Ur.forEachInRange([i,r],(o=>{s=s.add(o.key)})),s}containsKey(e){const t=new In(e,0),i=this.Qr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class In{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return pe.comparator(e.key,t.key)||$e(e.Yr,t.Yr)}static Kr(e,t){return $e(e.Yr,t.Yr)||pe.comparator(e.key,t.key)}}class Xj{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new It(In.$r)}checkEmpty(e){return q.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Gx(s,t,i,r);this.mutationQueue.push(o);for(const a of r)this.Zr=this.Zr.add(new In(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return q.resolve(o)}lookupMutationBatch(e,t){return q.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=this.ei(i),s=r<0?0:r;return q.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return q.resolve(this.mutationQueue.length===0?Kl:this.tr-1)}getAllMutationBatches(e){return q.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new In(t,0),r=new In(t,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([i,r],(o=>{const a=this.Xr(o.Yr);s.push(a)})),q.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new It($e);return t.forEach((r=>{const s=new In(r,0),o=new In(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,o],(a=>{i=i.add(a.Yr)}))})),q.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1;let s=i;pe.isDocumentKey(s)||(s=s.child(""));const o=new In(new pe(s),0);let a=new It($e);return this.Zr.forEachWhile((u=>{const h=u.key.path;return!!i.isPrefixOf(h)&&(h.length===r&&(a=a.add(u.Yr)),!0)}),o),q.resolve(this.ti(a))}ti(e){const t=[];return e.forEach((i=>{const r=this.Xr(i);r!==null&&t.push(r)})),t}removeMutationBatch(e,t){Ce(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return q.forEach(t.mutations,(r=>{const s=new In(r.key,t.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Zr=i}))}ir(e){}containsKey(e,t){const i=new In(t,0),r=this.Zr.firstAfterOrEqual(i);return q.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,q.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Yj{constructor(e){this.ri=e,this.docs=(function(){return new Gt(pe.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,r=this.docs.get(i),s=r?r.size:0,o=this.ri(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return q.resolve(i?i.document.mutableCopy():Xt.newInvalidDocument(t))}getEntries(e,t){let i=Ki();return t.forEach((r=>{const s=this.docs.get(r);i=i.insert(r,s?s.document.mutableCopy():Xt.newInvalidDocument(r))})),q.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let s=Ki();const o=t.path,a=new pe(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(a);for(;u.hasNext();){const{key:h,value:{document:d}}=u.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||Rx(tk(d),i)<=0||(r.has(d.key)||bg(t,d))&&(s=s.insert(d.key,d.mutableCopy()))}return q.resolve(s)}getAllFromCollectionGroup(e,t,i,r){Te(9500)}ii(e,t){return q.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new Zj(this)}getSize(e){return q.resolve(this.size)}}class Zj extends _L{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(i)})),q.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class Qj{constructor(e){this.persistence=e,this.si=new Ao((t=>uu(t)),Cg),this.lastRemoteSnapshotVersion=Me.min(),this.highestTargetId=0,this.oi=0,this._i=new Kx,this.targetCount=0,this.ai=du.ur()}forEachTarget(e,t){return this.si.forEach(((i,r)=>t(r))),q.resolve()}getLastRemoteSnapshotVersion(e){return q.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return q.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),q.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.oi&&(this.oi=t),q.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new du(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,q.resolve()}updateTargetData(e,t){return this.Pr(t),q.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,q.resolve()}removeTargets(e,t,i){let r=0;const s=[];return this.si.forEach(((o,a)=>{a.sequenceNumber<=t&&i.get(a.targetId)===null&&(this.si.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)})),q.waitFor(s).next((()=>r))}getTargetCount(e){return q.resolve(this.targetCount)}getTargetData(e,t){const i=this.si.get(t)||null;return q.resolve(i)}addMatchingKeys(e,t,i){return this._i.Wr(t,i),q.resolve()}removeMatchingKeys(e,t,i){this._i.zr(t,i);const r=this.persistence.referenceDelegate,s=[];return r&&t.forEach((o=>{s.push(r.markPotentiallyOrphaned(e,o))})),q.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),q.resolve()}getMatchingKeysForTargetId(e,t){const i=this._i.Hr(t);return q.resolve(i)}containsKey(e,t){return q.resolve(this._i.containsKey(t))}}class qx{constructor(e,t){this.ui={},this.overlays={},this.ci=new Tr(0),this.li=!1,this.li=!0,this.hi=new Hj,this.referenceDelegate=e(this),this.Pi=new Qj(this),this.indexManager=new Oj,this.remoteDocumentCache=(function(r){return new Yj(r)})((i=>this.referenceDelegate.Ti(i))),this.serializer=new oL(t),this.Ii=new Kj(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new qj,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.ui[e.toKey()];return i||(i=new Xj(t,this.referenceDelegate),this.ui[e.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,i){ce("MemoryPersistence","Starting transaction:",e);const r=new Jj(this.ci.next());return this.referenceDelegate.Ei(),i(r).next((s=>this.referenceDelegate.di(r).next((()=>s)))).toPromise().then((s=>(r.raiseOnCommittedEvent(),s)))}Ai(e,t){return q.or(Object.values(this.ui).map((i=>()=>i.containsKey(e,t))))}}class Jj extends ik{constructor(e){super(),this.currentSequenceNumber=e}}class ey{constructor(e){this.persistence=e,this.Ri=new Kx,this.Vi=null}static mi(e){return new ey(e)}get fi(){if(this.Vi)return this.Vi;throw Te(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.fi.delete(i.toString()),q.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.fi.add(i.toString()),q.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),q.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((r=>this.fi.add(r.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((r=>{r.forEach((s=>this.fi.add(s.toString())))})).next((()=>i.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return q.forEach(this.fi,(i=>{const r=pe.fromPath(i);return this.gi(e,r).next((s=>{s||t.removeEntry(r,Me.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((i=>{i?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return q.or([()=>q.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class j0{constructor(e,t){this.persistence=e,this.pi=new Ao((i=>ti(i.path)),((i,r)=>i.isEqual(r))),this.garbageCollector=pL(this,t)}static mi(e,t){return new j0(e,t)}Ei(){}di(e){return q.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((r=>i+r))))}wr(e){let t=0;return this.pr(e,(i=>{t++})).next((()=>t))}pr(e,t){return q.forEach(this.pi,((i,r)=>this.br(e,i,r).next((s=>s?q.resolve():t(r)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const r=this.persistence.getRemoteDocumentCache(),s=r.newChangeBuffer();return r.ii(e,(o=>this.br(e,o,t).next((a=>{a||(i++,s.removeEntry(o,Me.min()))})))).next((()=>s.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),q.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.pi.set(i,e.currentSequenceNumber),q.resolve()}removeReference(e,t,i){return this.pi.set(i,e.currentSequenceNumber),q.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),q.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=jp(e.data.value)),t}br(e,t,i){return q.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const r=this.pi.get(t);return q.resolve(r!==void 0&&r>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class eU{constructor(e){this.serializer=e}k(e,t,i,r){const s=new j_("createOrUpgrade",t);i<1&&r>=1&&((function(u){u.createObjectStore(Pg)})(e),(function(u){u.createObjectStore(qf,{keyPath:cG}),u.createObjectStore(Ur,{keyPath:ER,autoIncrement:!0}).createIndex(Bl,wR,{unique:!0}),u.createObjectStore(dh)})(e),cP(e),(function(u){u.createObjectStore(Pl)})(e));let o=q.resolve();return i<3&&r>=3&&(i!==0&&((function(u){u.deleteObjectStore(gh),u.deleteObjectStore(fh),u.deleteObjectStore(ql)})(e),cP(e)),o=o.next((()=>(function(u){const h=u.store(ql),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Me.min().toTimestamp(),targetCount:0};return h.put(M0,d)})(s)))),i<4&&r>=4&&(i!==0&&(o=o.next((()=>(function(u,h){return h.store(Ur).J().next((g=>{u.deleteObjectStore(Ur),u.createObjectStore(Ur,{keyPath:ER,autoIncrement:!0}).createIndex(Bl,wR,{unique:!0});const m=h.store(Ur),v=g.map((y=>m.put(y)));return q.waitFor(v)}))})(e,s)))),o=o.next((()=>{(function(u){u.createObjectStore(mh,{keyPath:vG})})(e)}))),i<5&&r>=5&&(o=o.next((()=>this.yi(s)))),i<6&&r>=6&&(o=o.next((()=>((function(u){u.createObjectStore(Hf)})(e),this.wi(s))))),i<7&&r>=7&&(o=o.next((()=>this.Si(s)))),i<8&&r>=8&&(o=o.next((()=>this.bi(e,s)))),i<9&&r>=9&&(o=o.next((()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)}))),i<10&&r>=10&&(o=o.next((()=>this.Di(s)))),i<11&&r>=11&&(o=o.next((()=>{(function(u){u.createObjectStore(B_,{keyPath:EG})})(e),(function(u){u.createObjectStore(z_,{keyPath:wG})})(e)}))),i<12&&r>=12&&(o=o.next((()=>{(function(u){const h=u.createObjectStore($_,{keyPath:PG});h.createIndex(FE,CG,{unique:!1}),h.createIndex(ck,MG,{unique:!1})})(e)}))),i<13&&r>=13&&(o=o.next((()=>(function(u){const h=u.createObjectStore(C0,{keyPath:dG});h.createIndex(Fp,fG),h.createIndex(ok,gG)})(e))).next((()=>this.Ci(e,s))).next((()=>e.deleteObjectStore(Pl)))),i<14&&r>=14&&(o=o.next((()=>this.Fi(e,s)))),i<15&&r>=15&&(o=o.next((()=>(function(u){u.createObjectStore(Mx,{keyPath:xG,autoIncrement:!0}).createIndex(VE,TG,{unique:!1}),u.createObjectStore(df,{keyPath:IG}).createIndex(lk,SG,{unique:!1}),u.createObjectStore(ff,{keyPath:AG}).createIndex(uk,RG,{unique:!1})})(e)))),i<16&&r>=16&&(o=o.next((()=>{t.objectStore(df).clear()})).next((()=>{t.objectStore(ff).clear()}))),i<17&&r>=17&&(o=o.next((()=>{(function(u){u.createObjectStore(bx,{keyPath:bG})})(e)}))),i<18&&r>=18&&V4()&&(o=o.next((()=>{t.objectStore(df).clear()})).next((()=>{t.objectStore(ff).clear()}))),o}wi(e){let t=0;return e.store(Pl).ee(((i,r)=>{t+=G0(r)})).next((()=>{const i={byteSize:t};return e.store(Hf).put(OE,i)}))}yi(e){const t=e.store(qf),i=e.store(Ur);return t.J().next((r=>q.forEach(r,(s=>{const o=IDBKeyRange.bound([s.userId,Kl],[s.userId,s.lastAcknowledgedBatchId]);return i.J(Bl,o).next((a=>q.forEach(a,(u=>{Ce(u.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:u.batchId});const h=Dl(this.serializer,u);return dL(e,s.userId,h).next((()=>{}))}))))}))))}Si(e){const t=e.store(gh),i=e.store(Pl);return e.store(ql).get(M0).next((r=>{const s=[];return i.ee(((o,a)=>{const u=new gt(o),h=(function(g){return[0,ti(g)]})(u);s.push(t.get(h).next((d=>d?q.resolve():(g=>t.put({targetId:0,path:ti(g),sequenceNumber:r.highestListenSequenceNumber}))(u))))})).next((()=>q.waitFor(s)))}))}bi(e,t){e.createObjectStore(Xf,{keyPath:yG});const i=t.store(Xf),r=new Wx,s=o=>{if(r.add(o)){const a=o.lastSegment(),u=o.popLast();return i.put({collectionId:a,parent:ti(u)})}};return t.store(Pl).ee({X:!0},((o,a)=>{const u=new gt(o);return s(u.popLast())})).next((()=>t.store(dh).ee({X:!0},(([o,a,u],h)=>{const d=Ts(a);return s(d.popLast())}))))}Di(e){const t=e.store(fh);return t.ee(((i,r)=>{const s=Qd(r),o=aL(this.serializer,s);return t.put(o)}))}Ci(e,t){const i=t.store(Pl),r=[];return i.ee(((s,o)=>{const a=t.store(C0),u=(function(g){return g.document?new pe(gt.fromString(g.document.name).popFirst(5)):g.noDocument?pe.fromSegments(g.noDocument.path):g.unknownDocument?pe.fromSegments(g.unknownDocument.path):Te(36783)})(o).path.toArray(),h={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};r.push(a.put(h))})).next((()=>q.waitFor(r)))}Fi(e,t){const i=t.store(Ur),r=yL(this.serializer),s=new qx(ey.mi,this.serializer.yt);return i.J().next((o=>{const a=new Map;return o.forEach((u=>{let h=a.get(u.userId)??Ze();Dl(this.serializer,u).keys().forEach((d=>h=h.add(d))),a.set(u.userId,h)})),q.forEach(a,((u,h)=>{const d=new Vn(h),g=Q_.wt(this.serializer,d),m=s.getIndexManager(d),v=J_.wt(d,this.serializer,m,s.referenceDelegate);return new vL(r,v,g,m).recalculateAndSaveOverlaysForDocumentKeys(new GE(t,Tr.ce),u).next()}))}))}}function cP(n){n.createObjectStore(gh,{keyPath:pG}).createIndex(Cx,_G,{unique:!0}),n.createObjectStore(fh,{keyPath:"targetId"}).createIndex(ak,mG,{unique:!0}),n.createObjectStore(ql)}const oa="IndexedDbPersistence",R1=18e5,P1=5e3,C1="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",tU="main";class Hx{constructor(e,t,i,r,s,o,a,u,h,d,g=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=i,this.Mi=s,this.window=o,this.document=a,this.xi=h,this.Oi=d,this.Ni=g,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=m=>Promise.resolve(),!Hx.v())throw new me(ee.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Bj(this,r),this.$i=t+tU,this.serializer=new oL(u),this.Ui=new Pa(this.$i,this.Ni,new eU(this.serializer)),this.hi=new Mj,this.Pi=new Fj(this.referenceDelegate,this.serializer),this.remoteDocumentCache=yL(this.serializer),this.Ii=new Cj,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,d===!1&&ui(oa,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new me(ee.FAILED_PRECONDITION,C1);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new Tr(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>wp(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if($a(e))return ce(oa,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return ce(oa,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return Fd(e).get(mc).next((t=>q.resolve(this.es(t))))}ts(e){return wp(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,R1)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const i=_n(t,mh);return i.J().next((r=>{const s=this.ss(r,R1),o=r.filter((a=>s.indexOf(a)===-1));return q.forEach(o,(a=>i.delete(a.clientId))).next((()=>o))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?q.resolve(!0):Fd(e).get(mc).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,P1)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new me(ee.FAILED_PRECONDITION,C1);return!1}}return!(!this.networkEnabled||!this.inForeground)||wp(e).J().next((i=>this.ss(i,P1).find((r=>{if(this.clientId!==r.clientId){const s=!this.networkEnabled&&r.networkEnabled,o=!this.inForeground&&r.inForeground,a=this.networkEnabled===r.networkEnabled;if(s||o&&a)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&ce(oa,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[Pg,mh],(e=>{const t=new GE(e,Tr.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((i=>this.rs(i.updateTimeMs,t)&&!this.us(i.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>wp(e).J().next((t=>this.ss(t,R1).map((i=>i.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return J_.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Vj(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return Q_.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,i){ce(oa,"Starting transaction:",e);const r=t==="readonly"?"readonly":"readwrite",s=(function(u){return u===18?DG:u===17?gk:u===16?LG:u===15?kx:u===14?fk:u===13?dk:u===12?kG:u===11?hk:void Te(60245)})(this.Ni);let o;return this.Ui.runTransaction(e,r,s,(a=>(o=new GE(a,this.ci?this.ci.next():Tr.ce),t==="readwrite-primary"?this.Hi(o).next((u=>!!u||this.Yi(o))).next((u=>{if(!u)throw ui(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new me(ee.FAILED_PRECONDITION,nk);return i(o)})).next((u=>this.Xi(o).next((()=>u)))):this.Is(o).next((()=>i(o)))))).then((a=>(o.raiseOnCommittedEvent(),a)))}Is(e){return Fd(e).get(mc).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,P1)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new me(ee.FAILED_PRECONDITION,C1)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Fd(e).put(mc,t)}static v(){return Pa.v()}Zi(e){const t=Fd(e);return t.get(mc).next((i=>this.es(i)?(ce(oa,"Releasing primary lease."),t.delete(mc)):q.resolve()))}rs(e,t){const i=Date.now();return!(e<i-t)&&(!(e>i)||(ui(`Detected an update time that is in the future: ${e} > ${i}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;O4()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const t=this.Ki?.getItem(this._s(e))!==null;return ce(oa,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return ui(oa,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){ui("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Fd(n){return _n(n,Pg)}function wp(n){return _n(n,mh)}function nU(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class Xx{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.Es=i,this.ds=r}static As(e,t){let i=Ze(),r=Ze();for(const s of t.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new Xx(e,t.fromCache,i,r)}}class iU{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class EL{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return O4()?8:rk(pn())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,r){const s={result:null};return this.ys(e,t).next((o=>{s.result=o})).next((()=>{if(!s.result)return this.ws(e,t,r,i).next((o=>{s.result=o}))})).next((()=>{if(s.result)return;const o=new iU;return this.Ss(e,t,o).next((a=>{if(s.result=a,this.Vs)return this.bs(e,t,o,a.size)}))})).next((()=>s.result))}bs(e,t,i,r){return i.documentReadCount<this.fs?(Ac()<=Je.DEBUG&&ce("QueryEngine","SDK will not create cache indexes for query:",Rc(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),q.resolve()):(Ac()<=Je.DEBUG&&ce("QueryEngine","Query:",Rc(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.gs*r?(Ac()<=Je.DEBUG&&ce("QueryEngine","The SDK decides to create cache indexes for query:",Rc(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Sr(t))):q.resolve())}ys(e,t){if(DR(t))return q.resolve(null);let i=Sr(t);return this.indexManager.getIndexType(e,i).next((r=>r===0?null:(t.limit!==null&&r===1&&(t=KE(t,null,"F"),i=Sr(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((s=>{const o=Ze(...s);return this.ps.getDocuments(e,o).next((a=>this.indexManager.getMinOffset(e,i).next((u=>{const h=this.Ds(t,a);return this.Cs(t,h,o,u.readTime)?this.ys(e,KE(t,null,"F")):this.vs(e,h,t,u)}))))})))))}ws(e,t,i,r){return DR(t)||r.isEqual(Me.min())?q.resolve(null):this.ps.getDocuments(e,i).next((s=>{const o=this.Ds(t,s);return this.Cs(t,o,i,r)?q.resolve(null):(Ac()<=Je.DEBUG&&ce("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Rc(t)),this.vs(e,o,t,iG(r,$f)).next((a=>a)))}))}Ds(e,t){let i=new It(Dk(e));return t.forEach(((r,s)=>{bg(e,s)&&(i=i.add(s))})),i}Cs(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Ss(e,t,i){return Ac()<=Je.DEBUG&&ce("QueryEngine","Using full collection scan to execute query:",Rc(t)),this.ps.getDocumentsMatchingQuery(e,t,Qi.min(),i)}vs(e,t,i,r){return this.ps.getDocumentsMatchingQuery(e,i,r).next((s=>(t.forEach((o=>{s=s.insert(o.key,o)})),s)))}}const Yx="LocalStore",rU=3e8;class sU{constructor(e,t,i,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new Gt($e),this.xs=new Ao((s=>uu(s)),Cg),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(i)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new vL(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function wL(n,e,t,i){return new sU(n,e,t,i)}async function xL(n,e){const t=We(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next((s=>(r=s,t.Bs(e),t.mutationQueue.getAllMutationBatches(i)))).next((s=>{const o=[],a=[];let u=Ze();for(const h of r){o.push(h.batchId);for(const d of h.mutations)u=u.add(d.key)}for(const h of s){a.push(h.batchId);for(const d of h.mutations)u=u.add(d.key)}return t.localDocuments.getDocuments(i,u).next((h=>({Ls:h,removedBatchIds:o,addedBatchIds:a})))}))}))}function oU(n,e){const t=We(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const r=e.batch.keys(),s=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(a,u,h,d){const g=h.batch,m=g.keys();let v=q.resolve();return m.forEach((y=>{v=v.next((()=>d.getEntry(u,y))).next((I=>{const w=h.docVersions.get(y);Ce(w!==null,48541),I.version.compareTo(w)<0&&(g.applyToRemoteDocument(I,h),I.isValidDocument()&&(I.setReadTime(h.commitVersion),d.addEntry(I)))}))})),v.next((()=>a.mutationQueue.removeMutationBatch(u,g)))})(t,i,e,s).next((()=>s.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(a){let u=Ze();for(let h=0;h<a.mutationResults.length;++h)a.mutationResults[h].transformResults.length>0&&(u=u.add(a.batch.mutations[h].key));return u})(e)))).next((()=>t.localDocuments.getDocuments(i,r)))}))}function TL(n){const e=We(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function aU(n,e){const t=We(n),i=e.snapshotVersion;let r=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(s=>{const o=t.Ns.newChangeBuffer({trackRemovals:!0});r=t.Ms;const a=[];e.targetChanges.forEach(((d,g)=>{const m=r.get(g);if(!m)return;a.push(t.Pi.removeMatchingKeys(s,d.removedDocuments,g).next((()=>t.Pi.addMatchingKeys(s,d.addedDocuments,g))));let v=m.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(g)!==null?v=v.withResumeToken(un.EMPTY_BYTE_STRING,Me.min()).withLastLimboFreeSnapshotVersion(Me.min()):d.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(d.resumeToken,i)),r=r.insert(g,v),(function(I,w,R){return I.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-I.snapshotVersion.toMicroseconds()>=rU?!0:R.addedDocuments.size+R.modifiedDocuments.size+R.removedDocuments.size>0})(m,v,d)&&a.push(t.Pi.updateTargetData(s,v))}));let u=Ki(),h=Ze();if(e.documentUpdates.forEach((d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,d))})),a.push(lU(s,o,e.documentUpdates).next((d=>{u=d.ks,h=d.qs}))),!i.isEqual(Me.min())){const d=t.Pi.getLastRemoteSnapshotVersion(s).next((g=>t.Pi.setTargetsMetadata(s,s.currentSequenceNumber,i)));a.push(d)}return q.waitFor(a).next((()=>o.apply(s))).next((()=>t.localDocuments.getLocalViewOfDocuments(s,u,h))).next((()=>u))})).then((s=>(t.Ms=r,s)))}function lU(n,e,t){let i=Ze(),r=Ze();return t.forEach((s=>i=i.add(s))),e.getEntries(n,i).next((s=>{let o=Ki();return t.forEach(((a,u)=>{const h=s.get(a);u.isFoundDocument()!==h.isFoundDocument()&&(r=r.add(a)),u.isNoDocument()&&u.version.isEqual(Me.min())?(e.removeEntry(a,u.readTime),o=o.insert(a,u)):!h.isValidDocument()||u.version.compareTo(h.version)>0||u.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(u),o=o.insert(a,u)):ce(Yx,"Ignoring outdated watch update for ",a,". Current version:",h.version," Watch version:",u.version)})),{ks:o,qs:r}}))}function uU(n,e){const t=We(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=Kl),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function cU(n,e){const t=We(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let r;return t.Pi.getTargetData(i,e).next((s=>s?(r=s,q.resolve(r)):t.Pi.allocateTargetId(i).next((o=>(r=new ao(e,o,"TargetPurposeListen",i.currentSequenceNumber),t.Pi.addTargetData(i,r).next((()=>r)))))))})).then((i=>{const r=t.Ms.get(i.targetId);return(r===null||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(i.targetId,i),t.xs.set(e,i.targetId)),i}))}async function ew(n,e,t){const i=We(n),r=i.Ms.get(e),s=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",s,(o=>i.persistence.referenceDelegate.removeTarget(o,r)))}catch(o){if(!$a(o))throw o;ce(Yx,`Failed to update sequence numbers for target ${e}: ${o}`)}i.Ms=i.Ms.remove(e),i.xs.delete(r.target)}function hP(n,e,t){const i=We(n);let r=Me.min(),s=Ze();return i.persistence.runTransaction("Execute query","readwrite",(o=>(function(u,h,d){const g=We(u),m=g.xs.get(d);return m!==void 0?q.resolve(g.Ms.get(m)):g.Pi.getTargetData(h,d)})(i,o,Sr(e)).next((a=>{if(a)return r=a.lastLimboFreeSnapshotVersion,i.Pi.getMatchingKeysForTargetId(o,a.targetId).next((u=>{s=u}))})).next((()=>i.Fs.getDocumentsMatchingQuery(o,e,t?r:Me.min(),t?s:Ze()))).next((a=>(hU(i,XG(e),a),{documents:a,Qs:s})))))}function hU(n,e,t){let i=n.Os.get(e)||Me.min();t.forEach(((r,s)=>{s.readTime.compareTo(i)>0&&(i=s.readTime)})),n.Os.set(e,i)}class dP{constructor(){this.activeTargetIds=tj()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class IL{constructor(){this.Mo=new dP,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,i){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new dP,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class dU{Oo(e){}shutdown(){}}const fP="ConnectivityMonitor";class gP{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ce(fP,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){ce(fP,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let xp=null;function tw(){return xp===null?xp=(function(){return 268435456+Math.round(2147483648*Math.random())})():xp++,"0x"+xp.toString(16)}const M1="RestConnection",fU={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class gU{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${i}/databases/${r}`,this.Wo=this.databaseId.database===b0?`project_id=${i}`:`project_id=${i}&database_id=${r}`}Go(e,t,i,r,s){const o=tw(),a=this.zo(e,t.toUriEncodedString());ce(M1,`Sending RPC '${e}' ${o}:`,a,i);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,r,s);const{host:h}=new URL(a),d=wu(h);return this.Jo(e,a,u,i,d).then((g=>(ce(M1,`Received RPC '${e}' ${o}: `,g),g)),(g=>{throw au(M1,`RPC '${e}' ${o} failed with error: `,g,"url: ",a,"request:",i),g}))}Ho(e,t,i,r,s,o){return this.Go(e,t,i,r,s)}jo(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+bh})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((r,s)=>e[s]=r)),i&&i.headers.forEach(((r,s)=>e[s]=r))}zo(e,t){const i=fU[e];return`${this.Uo}/v1/${t}:${i}`}terminate(){}}class mU{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const Kn="WebChannelConnection";class pU extends gU{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,i,r,s){const o=tw();return new Promise(((a,u)=>{const h=new W4;h.setWithCredentials(!0),h.listenOnce(K4.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case Np.NO_ERROR:const g=h.getResponseJson();ce(Kn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(g)),a(g);break;case Np.TIMEOUT:ce(Kn,`RPC '${e}' ${o} timed out`),u(new me(ee.DEADLINE_EXCEEDED,"Request time out"));break;case Np.HTTP_ERROR:const m=h.getStatus();if(ce(Kn,`RPC '${e}' ${o} failed with status:`,m,"response text:",h.getResponseText()),m>0){let v=h.getResponseJson();Array.isArray(v)&&(v=v[0]);const y=v?.error;if(y&&y.status&&y.message){const I=(function(R){const P=R.toLowerCase().replace(/_/g,"-");return Object.values(ee).indexOf(P)>=0?P:ee.UNKNOWN})(y.status);u(new me(I,y.message))}else u(new me(ee.UNKNOWN,"Server responded with status "+h.getStatus()))}else u(new me(ee.UNAVAILABLE,"Connection failed."));break;default:Te(9055,{l_:e,streamId:o,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{ce(Kn,`RPC '${e}' ${o} completed.`)}}));const d=JSON.stringify(r);ce(Kn,`RPC '${e}' ${o} sending request:`,r),h.send(t,"POST",d,i,15)}))}T_(e,t,i){const r=tw(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=X4(),a=H4(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,t,i),u.encodeInitMessageHeaders=!0;const d=s.join("");ce(Kn,`Creating RPC '${e}' stream ${r}: ${d}`,u);const g=o.createWebChannel(d,u);this.I_(g);let m=!1,v=!1;const y=new mU({Yo:w=>{v?ce(Kn,`Not sending because RPC '${e}' stream ${r} is closed:`,w):(m||(ce(Kn,`Opening RPC '${e}' stream ${r} transport.`),g.open(),m=!0),ce(Kn,`RPC '${e}' stream ${r} sending:`,w),g.send(w))},Zo:()=>g.close()}),I=(w,R,P)=>{w.listen(R,(b=>{try{P(b)}catch(L){setTimeout((()=>{throw L}),0)}}))};return I(g,Xd.EventType.OPEN,(()=>{v||(ce(Kn,`RPC '${e}' stream ${r} transport opened.`),y.o_())})),I(g,Xd.EventType.CLOSE,(()=>{v||(v=!0,ce(Kn,`RPC '${e}' stream ${r} transport closed`),y.a_(),this.E_(g))})),I(g,Xd.EventType.ERROR,(w=>{v||(v=!0,au(Kn,`RPC '${e}' stream ${r} transport errored. Name:`,w.name,"Message:",w.message),y.a_(new me(ee.UNAVAILABLE,"The operation could not be completed")))})),I(g,Xd.EventType.MESSAGE,(w=>{if(!v){const R=w.data[0];Ce(!!R,16349);const P=R,b=P?.error||P[0]?.error;if(b){ce(Kn,`RPC '${e}' stream ${r} received error:`,b);const L=b.status;let D=(function(A){const k=an[A];if(k!==void 0)return Kk(k)})(L),B=b.message;D===void 0&&(D=ee.INTERNAL,B="Unknown error status: "+L+" with message "+b.message),v=!0,y.a_(new me(D,B)),g.close()}else ce(Kn,`RPC '${e}' stream ${r} received:`,R),y.u_(R)}})),I(a,q4.STAT_EVENT,(w=>{w.stat===LE.PROXY?ce(Kn,`RPC '${e}' stream ${r} detected buffering proxy`):w.stat===LE.NOPROXY&&ce(Kn,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{y.__()}),0),y}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function _U(){return typeof window<"u"?window:null}function Wp(){return typeof document<"u"?document:null}function ty(n){return new yj(n,!0)}class SL{constructor(e,t,i=1e3,r=1.5,s=6e4){this.Mi=e,this.timerId=t,this.d_=i,this.A_=r,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-i);r>0&&ce("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const mP="PersistentStream";class AL{constructor(e,t,i,r,s,o,a,u){this.Mi=e,this.S_=i,this.b_=r,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new SL(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ee.RESOURCE_EXHAUSTED?(ui(t.toString()),ui("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ee.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,r])=>{this.D_===t&&this.G_(i,r)}),(i=>{e((()=>{const r=new me(ee.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(r)}))}))}G_(e,t){const i=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{i((()=>this.listener.Xo()))})),this.stream.t_((()=>{i((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((r=>{i((()=>this.z_(r)))})),this.stream.onMessage((r=>{i((()=>++this.F_==1?this.J_(r):this.onNext(r)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return ce(mP,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(ce(mP,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class yU extends AL{constructor(e,t,i,r,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=wj(this.serializer,e),i=(function(s){if(!("targetChange"in s))return Me.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?Me.min():o.readTime?di(o.readTime):Me.min()})(e);return this.listener.H_(t,i)}Y_(e){const t={};t.database=XE(this.serializer),t.addTarget=(function(s,o){let a;const u=o.target;if(a=L0(u)?{documents:eL(s,u)}:{query:tL(s,u).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=Xk(s,o.resumeToken);const h=qE(s,o.expectedCount);h!==null&&(a.expectedCount=h)}else if(o.snapshotVersion.compareTo(Me.min())>0){a.readTime=xh(s,o.snapshotVersion.toTimestamp());const h=qE(s,o.expectedCount);h!==null&&(a.expectedCount=h)}return a})(this.serializer,e);const i=Tj(this.serializer,e);i&&(t.labels=i),this.q_(t)}Z_(e){const t={};t.database=XE(this.serializer),t.removeTarget=e,this.q_(t)}}class vU extends AL{constructor(e,t,i,r,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Ce(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ce(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ce(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=xj(e.writeResults,e.commitTime),i=di(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=XE(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>O0(this.serializer,i)))};this.q_(t)}}class EU{}class wU extends EU{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new me(ee.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,i,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,o])=>this.connection.Go(e,HE(t,i),r,s,o))).catch((s=>{throw s.name==="FirebaseError"?(s.code===ee.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new me(ee.UNKNOWN,s.toString())}))}Ho(e,t,i,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,a])=>this.connection.Ho(e,HE(t,i),r,o,a,s))).catch((o=>{throw o.name==="FirebaseError"?(o.code===ee.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new me(ee.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class xU{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ui(t),this.aa=!1):ce("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const fu="RemoteStore";class TU{constructor(e,t,i,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo((o=>{i.enqueueAndForget((async()=>{Iu(this)&&(ce(fu,"Restarting streams for network reachability change."),await(async function(u){const h=We(u);h.Ea.add(4),await Lg(h),h.Ra.set("Unknown"),h.Ea.delete(4),await ny(h)})(this))}))})),this.Ra=new xU(i,r)}}async function ny(n){if(Iu(n))for(const e of n.da)await e(!0)}async function Lg(n){for(const e of n.da)await e(!1)}function RL(n,e){const t=We(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),eT(t)?Jx(t):Lh(t).O_()&&Qx(t,e))}function Zx(n,e){const t=We(n),i=Lh(t);t.Ia.delete(e),i.O_()&&PL(t,e),t.Ia.size===0&&(i.O_()?i.L_():Iu(t)&&t.Ra.set("Unknown"))}function Qx(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Me.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Lh(n).Y_(e)}function PL(n,e){n.Va.Ue(e),Lh(n).Z_(e)}function Jx(n){n.Va=new gj({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Lh(n).start(),n.Ra.ua()}function eT(n){return Iu(n)&&!Lh(n).x_()&&n.Ia.size>0}function Iu(n){return We(n).Ea.size===0}function CL(n){n.Va=void 0}async function IU(n){n.Ra.set("Online")}async function SU(n){n.Ia.forEach(((e,t)=>{Qx(n,e)}))}async function AU(n,e){CL(n),eT(n)?(n.Ra.ha(e),Jx(n)):n.Ra.set("Unknown")}async function RU(n,e,t){if(n.Ra.set("Online"),e instanceof Hk&&e.state===2&&e.cause)try{await(async function(r,s){const o=s.cause;for(const a of s.targetIds)r.Ia.has(a)&&(await r.remoteSyncer.rejectListen(a,o),r.Ia.delete(a),r.Va.removeTarget(a))})(n,e)}catch(i){ce(fu,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await U0(n,i)}else if(e instanceof zp?n.Va.Ze(e):e instanceof qk?n.Va.st(e):n.Va.tt(e),!t.isEqual(Me.min()))try{const i=await TL(n.localStore);t.compareTo(i)>=0&&await(function(s,o){const a=s.Va.Tt(o);return a.targetChanges.forEach(((u,h)=>{if(u.resumeToken.approximateByteSize()>0){const d=s.Ia.get(h);d&&s.Ia.set(h,d.withResumeToken(u.resumeToken,o))}})),a.targetMismatches.forEach(((u,h)=>{const d=s.Ia.get(u);if(!d)return;s.Ia.set(u,d.withResumeToken(un.EMPTY_BYTE_STRING,d.snapshotVersion)),PL(s,u);const g=new ao(d.target,u,h,d.sequenceNumber);Qx(s,g)})),s.remoteSyncer.applyRemoteEvent(a)})(n,t)}catch(i){ce(fu,"Failed to raise snapshot:",i),await U0(n,i)}}async function U0(n,e,t){if(!$a(e))throw e;n.Ea.add(1),await Lg(n),n.Ra.set("Offline"),t||(t=()=>TL(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{ce(fu,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await ny(n)}))}function ML(n,e){return e().catch((t=>U0(n,t,e)))}async function Dg(n){const e=We(n),t=Va(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Kl;for(;PU(e);)try{const r=await uU(e.localStore,i);if(r===null){e.Ta.length===0&&t.L_();break}i=r.batchId,CU(e,r)}catch(r){await U0(e,r)}bL(e)&&kL(e)}function PU(n){return Iu(n)&&n.Ta.length<10}function CU(n,e){n.Ta.push(e);const t=Va(n);t.O_()&&t.X_&&t.ea(e.mutations)}function bL(n){return Iu(n)&&!Va(n).x_()&&n.Ta.length>0}function kL(n){Va(n).start()}async function MU(n){Va(n).ra()}async function bU(n){const e=Va(n);for(const t of n.Ta)e.ea(t.mutations)}async function kU(n,e,t){const i=n.Ta.shift(),r=jx.from(i,e,t);await ML(n,(()=>n.remoteSyncer.applySuccessfulWrite(r))),await Dg(n)}async function LU(n,e){e&&Va(n).X_&&await(async function(i,r){if((function(o){return hj(o)&&o!==ee.ABORTED})(r.code)){const s=i.Ta.shift();Va(i).B_(),await ML(i,(()=>i.remoteSyncer.rejectFailedWrite(s.batchId,r))),await Dg(i)}})(n,e),bL(n)&&kL(n)}async function pP(n,e){const t=We(n);t.asyncQueue.verifyOperationInProgress(),ce(fu,"RemoteStore received new credentials");const i=Iu(t);t.Ea.add(3),await Lg(t),i&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await ny(t)}async function DU(n,e){const t=We(n);e?(t.Ea.delete(2),await ny(t)):e||(t.Ea.add(2),await Lg(t),t.Ra.set("Unknown"))}function Lh(n){return n.ma||(n.ma=(function(t,i,r){const s=We(t);return s.sa(),new yU(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)})(n.datastore,n.asyncQueue,{Xo:IU.bind(null,n),t_:SU.bind(null,n),r_:AU.bind(null,n),H_:RU.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),eT(n)?Jx(n):n.Ra.set("Unknown")):(await n.ma.stop(),CL(n))}))),n.ma}function Va(n){return n.fa||(n.fa=(function(t,i,r){const s=We(t);return s.sa(),new vU(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:MU.bind(null,n),r_:LU.bind(null,n),ta:bU.bind(null,n),na:kU.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await Dg(n)):(await n.fa.stop(),n.Ta.length>0&&(ce(fu,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class tT{constructor(e,t,i,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new go,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,s){const o=Date.now()+i,a=new tT(e,t,o,r,s);return a.start(i),a}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new me(ee.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function nT(n,e){if(ui("AsyncQueue",`${e}: ${n}`),$a(n))return new me(ee.UNAVAILABLE,`${e}: ${n}`);throw n}class Xc{static emptySet(e){return new Xc(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||pe.comparator(t.key,i.key):(t,i)=>pe.comparator(t.key,i.key),this.keyedMap=Yd(),this.sortedSet=new Gt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Xc)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=i.getNext().key;if(!r.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new Xc;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}class _P{constructor(){this.ga=new Gt(pe.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Te(63341,{Rt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class Th{constructor(e,t,i,r,s,o,a,u,h){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=u,this.hasCachedResults=h}static fromInitialDocuments(e,t,i,r,s){const o=[];return t.forEach((a=>{o.push({type:0,doc:a})})),new Th(e,t,Xc.emptySet(t),o,i,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&q_(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==i[r].type||!t[r].doc.isEqual(i[r].doc))return!1;return!0}}class NU{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class OU{constructor(){this.queries=yP(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const r=We(t),s=r.queries;r.queries=yP(),s.forEach(((o,a)=>{for(const u of a.Sa)u.onError(i)}))})(this,new me(ee.ABORTED,"Firestore shutting down"))}}function yP(){return new Ao((n=>Lk(n)),q_)}async function VU(n,e){const t=We(n);let i=3;const r=e.query;let s=t.queries.get(r);s?!s.ba()&&e.Da()&&(i=2):(s=new NU,i=e.Da()?0:1);try{switch(i){case 0:s.wa=await t.onListen(r,!0);break;case 1:s.wa=await t.onListen(r,!1);break;case 2:await t.onFirstRemoteStoreListen(r)}}catch(o){const a=nT(o,`Initialization of query '${Rc(e.query)}' failed`);return void e.onError(a)}t.queries.set(r,s),s.Sa.push(e),e.va(t.onlineState),s.wa&&e.Fa(s.wa)&&iT(t)}async function FU(n,e){const t=We(n),i=e.query;let r=3;const s=t.queries.get(i);if(s){const o=s.Sa.indexOf(e);o>=0&&(s.Sa.splice(o,1),s.Sa.length===0?r=e.Da()?0:1:!s.ba()&&e.Da()&&(r=2))}switch(r){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function GU(n,e){const t=We(n);let i=!1;for(const r of e){const s=r.query,o=t.queries.get(s);if(o){for(const a of o.Sa)a.Fa(r)&&(i=!0);o.wa=r}}i&&iT(t)}function jU(n,e,t){const i=We(n),r=i.queries.get(e);if(r)for(const s of r.Sa)s.onError(t);i.queries.delete(e)}function iT(n){n.Ca.forEach((e=>{e.next()}))}var nw,vP;(vP=nw||(nw={})).Ma="default",vP.Cache="cache";class UU{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const r of e.docChanges)r.type!==3&&i.push(r);e=new Th(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.qa||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Th.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==nw.Cache}}class LL{constructor(e){this.key=e}}class DL{constructor(e){this.key=e}}class BU{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Ze(),this.mutatedKeys=Ze(),this.eu=Dk(e),this.tu=new Xc(this.eu)}get nu(){return this.Ya}ru(e,t){const i=t?t.iu:new _P,r=t?t.tu:this.tu;let s=t?t.mutatedKeys:this.mutatedKeys,o=r,a=!1;const u=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,h=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((d,g)=>{const m=r.get(d),v=bg(this.query,g)?g:null,y=!!m&&this.mutatedKeys.has(m.key),I=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations);let w=!1;m&&v?m.data.isEqual(v.data)?y!==I&&(i.track({type:3,doc:v}),w=!0):this.su(m,v)||(i.track({type:2,doc:v}),w=!0,(u&&this.eu(v,u)>0||h&&this.eu(v,h)<0)&&(a=!0)):!m&&v?(i.track({type:0,doc:v}),w=!0):m&&!v&&(i.track({type:1,doc:m}),w=!0,(u||h)&&(a=!0)),w&&(v?(o=o.add(v),s=I?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))})),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),i.track({type:1,doc:d})}return{tu:o,iu:i,Cs:a,mutatedKeys:s}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,r){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort(((d,g)=>(function(v,y){const I=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Te(20277,{Rt:w})}};return I(v)-I(y)})(d.type,g.type)||this.eu(d.doc,g.doc))),this.ou(i),r=r??!1;const a=t&&!r?this._u():[],u=this.Xa.size===0&&this.current&&!r?1:0,h=u!==this.Za;return this.Za=u,o.length!==0||h?{snapshot:new Th(this.query,e.tu,s,o,e.mutatedKeys,u===0,h,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new _P,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Ze(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Xa=this.Xa.add(i.key))}));const t=[];return e.forEach((i=>{this.Xa.has(i)||t.push(new DL(i))})),this.Xa.forEach((i=>{e.has(i)||t.push(new LL(i))})),t}cu(e){this.Ya=e.Qs,this.Xa=Ze();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Th.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const rT="SyncEngine";class zU{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class $U{constructor(e){this.key=e,this.hu=!1}}class WU{constructor(e,t,i,r,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Ao((a=>Lk(a)),q_),this.Iu=new Map,this.Eu=new Set,this.du=new Gt(pe.comparator),this.Au=new Map,this.Ru=new Kx,this.Vu={},this.mu=new Map,this.fu=du.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function KU(n,e,t=!0){const i=jL(n);let r;const s=i.Tu.get(e);return s?(i.sharedClientState.addLocalQueryTarget(s.targetId),r=s.view.lu()):r=await NL(i,e,t,!0),r}async function qU(n,e){const t=jL(n);await NL(t,e,!0,!1)}async function NL(n,e,t,i){const r=await cU(n.localStore,Sr(e)),s=r.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t);let a;return i&&(a=await HU(n,e,s,o==="current",r.resumeToken)),n.isPrimaryClient&&t&&RL(n.remoteStore,r),a}async function HU(n,e,t,i,r){n.pu=(g,m,v)=>(async function(I,w,R,P){let b=w.view.ru(R);b.Cs&&(b=await hP(I.localStore,w.query,!1).then((({documents:M})=>w.view.ru(M,b))));const L=P&&P.targetChanges.get(w.targetId),D=P&&P.targetMismatches.get(w.targetId)!=null,B=w.view.applyChanges(b,I.isPrimaryClient,L,D);return wP(I,w.targetId,B.au),B.snapshot})(n,g,m,v);const s=await hP(n.localStore,e,!0),o=new BU(e,s.Qs),a=o.ru(s.documents),u=kg.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",r),h=o.applyChanges(a,n.isPrimaryClient,u);wP(n,t,h.au);const d=new zU(e,t,o);return n.Tu.set(e,d),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),h.snapshot}async function XU(n,e,t){const i=We(n),r=i.Tu.get(e),s=i.Iu.get(r.targetId);if(s.length>1)return i.Iu.set(r.targetId,s.filter((o=>!q_(o,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||await ew(i.localStore,r.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(r.targetId),t&&Zx(i.remoteStore,r.targetId),iw(i,r.targetId)})).catch(Tu)):(iw(i,r.targetId),await ew(i.localStore,r.targetId,!0))}async function YU(n,e){const t=We(n),i=t.Tu.get(e),r=t.Iu.get(i.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),Zx(t.remoteStore,i.targetId))}async function ZU(n,e,t){const i=UL(n);try{const r=await(function(o,a){const u=We(o),h=xt.now(),d=a.reduce(((v,y)=>v.add(y.key)),Ze());let g,m;return u.persistence.runTransaction("Locally write mutations","readwrite",(v=>{let y=Ki(),I=Ze();return u.Ns.getEntries(v,d).next((w=>{y=w,y.forEach(((R,P)=>{P.isValidDocument()||(I=I.add(R))}))})).next((()=>u.localDocuments.getOverlayedDocuments(v,y))).next((w=>{g=w;const R=[];for(const P of a){const b=uj(P,g.get(P.key).overlayedDocument);b!=null&&R.push(new Ro(P.key,b,Ik(b.value.mapValue),ci.exists(!0)))}return u.mutationQueue.addMutationBatch(v,h,R,a)})).next((w=>{m=w;const R=w.applyToLocalDocumentSet(g,I);return u.documentOverlayCache.saveOverlays(v,w.batchId,R)}))})).then((()=>({batchId:m.batchId,changes:Ok(g)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(r.batchId),(function(o,a,u){let h=o.Vu[o.currentUser.toKey()];h||(h=new Gt($e)),h=h.insert(a,u),o.Vu[o.currentUser.toKey()]=h})(i,r.batchId,t),await Ng(i,r.changes),await Dg(i.remoteStore)}catch(r){const s=nT(r,"Failed to persist write");t.reject(s)}}async function OL(n,e){const t=We(n);try{const i=await aU(t.localStore,e);e.targetChanges.forEach(((r,s)=>{const o=t.Au.get(s);o&&(Ce(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?o.hu=!0:r.modifiedDocuments.size>0?Ce(o.hu,14607):r.removedDocuments.size>0&&(Ce(o.hu,42227),o.hu=!1))})),await Ng(t,i,e)}catch(i){await Tu(i)}}function EP(n,e,t){const i=We(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const r=[];i.Tu.forEach(((s,o)=>{const a=o.view.va(e);a.snapshot&&r.push(a.snapshot)})),(function(o,a){const u=We(o);u.onlineState=a;let h=!1;u.queries.forEach(((d,g)=>{for(const m of g.Sa)m.va(a)&&(h=!0)})),h&&iT(u)})(i.eventManager,e),r.length&&i.Pu.H_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function QU(n,e,t){const i=We(n);i.sharedClientState.updateQueryState(e,"rejected",t);const r=i.Au.get(e),s=r&&r.key;if(s){let o=new Gt(pe.comparator);o=o.insert(s,Xt.newNoDocument(s,Me.min()));const a=Ze().add(s),u=new Z_(Me.min(),new Map,new Gt($e),o,a);await OL(i,u),i.du=i.du.remove(s),i.Au.delete(e),sT(i)}else await ew(i.localStore,e,!1).then((()=>iw(i,e,t))).catch(Tu)}async function JU(n,e){const t=We(n),i=e.batch.batchId;try{const r=await oU(t.localStore,e);FL(t,i,null),VL(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Ng(t,r)}catch(r){await Tu(r)}}async function eB(n,e,t){const i=We(n);try{const r=await(function(o,a){const u=We(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let d;return u.mutationQueue.lookupMutationBatch(h,a).next((g=>(Ce(g!==null,37113),d=g.keys(),u.mutationQueue.removeMutationBatch(h,g)))).next((()=>u.mutationQueue.performConsistencyCheck(h))).next((()=>u.documentOverlayCache.removeOverlaysForBatchId(h,d,a))).next((()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,d))).next((()=>u.localDocuments.getDocuments(h,d)))}))})(i.localStore,e);FL(i,e,t),VL(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Ng(i,r)}catch(r){await Tu(r)}}function VL(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function FL(n,e,t){const i=We(n);let r=i.Vu[i.currentUser.toKey()];if(r){const s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),i.Vu[i.currentUser.toKey()]=r}}function iw(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((i=>{n.Ru.containsKey(i)||GL(n,i)}))}function GL(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(Zx(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),sT(n))}function wP(n,e,t){for(const i of t)i instanceof LL?(n.Ru.addReference(i.key,e),tB(n,i)):i instanceof DL?(ce(rT,"Document no longer in limbo: "+i.key),n.Ru.removeReference(i.key,e),n.Ru.containsKey(i.key)||GL(n,i.key)):Te(19791,{wu:i})}function tB(n,e){const t=e.key,i=t.path.canonicalString();n.du.get(t)||n.Eu.has(i)||(ce(rT,"New document in limbo: "+t),n.Eu.add(i),sT(n))}function sT(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new pe(gt.fromString(e)),i=n.fu.next();n.Au.set(i,new $U(t)),n.du=n.du.insert(t,i),RL(n.remoteStore,new ao(Sr(Vx(t.path)),i,"TargetPurposeLimboResolution",Tr.ce))}}async function Ng(n,e,t){const i=We(n),r=[],s=[],o=[];i.Tu.isEmpty()||(i.Tu.forEach(((a,u)=>{o.push(i.pu(u,e,t).then((h=>{if((h||t)&&i.isPrimaryClient){const d=h?!h.fromCache:t?.targetChanges.get(u.targetId)?.current;i.sharedClientState.updateQueryState(u.targetId,d?"current":"not-current")}if(h){r.push(h);const d=Xx.As(u.targetId,h);s.push(d)}})))})),await Promise.all(o),i.Pu.H_(r),await(async function(u,h){const d=We(u);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",(g=>q.forEach(h,(m=>q.forEach(m.Es,(v=>d.persistence.referenceDelegate.addReference(g,m.targetId,v))).next((()=>q.forEach(m.ds,(v=>d.persistence.referenceDelegate.removeReference(g,m.targetId,v)))))))))}catch(g){if(!$a(g))throw g;ce(Yx,"Failed to update sequence numbers: "+g)}for(const g of h){const m=g.targetId;if(!g.fromCache){const v=d.Ms.get(m),y=v.snapshotVersion,I=v.withLastLimboFreeSnapshotVersion(y);d.Ms=d.Ms.insert(m,I)}}})(i.localStore,s))}async function nB(n,e){const t=We(n);if(!t.currentUser.isEqual(e)){ce(rT,"User change. New user:",e.toKey());const i=await xL(t.localStore,e);t.currentUser=e,(function(s,o){s.mu.forEach((a=>{a.forEach((u=>{u.reject(new me(ee.CANCELLED,o))}))})),s.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Ng(t,i.Ls)}}function iB(n,e){const t=We(n),i=t.Au.get(e);if(i&&i.hu)return Ze().add(i.key);{let r=Ze();const s=t.Iu.get(e);if(!s)return r;for(const o of s){const a=t.Tu.get(o);r=r.unionWith(a.view.nu)}return r}}function jL(n){const e=We(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=OL.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=iB.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=QU.bind(null,e),e.Pu.H_=GU.bind(null,e.eventManager),e.Pu.yu=jU.bind(null,e.eventManager),e}function UL(n){const e=We(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=JU.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=eB.bind(null,e),e}class ng{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=ty(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return wL(this.persistence,new EL,e.initialUser,this.serializer)}Cu(e){return new qx(ey.mi,this.serializer)}Du(e){return new IL}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}ng.provider={build:()=>new ng};class rB extends ng{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Ce(this.persistence.referenceDelegate instanceof j0,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new mL(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Yn.withCacheSize(this.cacheSizeBytes):Yn.DEFAULT;return new qx((i=>j0.mi(i,t)),this.serializer)}}class sB extends ng{constructor(e,t,i){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=i,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await UL(this.xu.syncEngine),await Dg(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return wL(this.persistence,new EL,e.initialUser,this.serializer)}Fu(e,t){const i=this.persistence.referenceDelegate.garbageCollector;return new mL(i,e.asyncQueue,t)}Mu(e,t){const i=new aG(t,this.persistence);return new oG(e.asyncQueue,i)}Cu(e){const t=nU(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),i=this.cacheSizeBytes!==void 0?Yn.withCacheSize(this.cacheSizeBytes):Yn.DEFAULT;return new Hx(this.synchronizeTabs,t,e.clientId,i,e.asyncQueue,_U(),Wp(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new IL}}class B0{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>EP(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=nB.bind(null,this.syncEngine),await DU(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new OU})()}createDatastore(e){const t=ty(e.databaseInfo.databaseId),i=(function(s){return new pU(s)})(e.databaseInfo);return(function(s,o,a,u){return new wU(s,o,a,u)})(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,r,s,o,a){return new TU(i,r,s,o,a)})(this.localStore,this.datastore,e.asyncQueue,(t=>EP(this.syncEngine,t,0)),(function(){return gP.v()?new gP:new dU})())}createSyncEngine(e,t){return(function(r,s,o,a,u,h,d){const g=new WU(r,s,o,a,u,h);return d&&(g.gu=!0),g})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=We(t);ce(fu,"RemoteStore shutting down."),i.Ea.add(5),await Lg(i),i.Aa.shutdown(),i.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}B0.provider={build:()=>new B0};class oB{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):ui("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const Fa="FirestoreClient";class aB{constructor(e,t,i,r,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=r,this.user=Vn.UNAUTHENTICATED,this.clientId=Ax.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(i,(async o=>{ce(Fa,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(i,(o=>(ce(Fa,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new go;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=nT(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function b1(n,e){n.asyncQueue.verifyOperationInProgress(),ce(Fa,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async r=>{i.isEqual(r)||(await xL(e.localStore,r),i=r)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function xP(n,e){n.asyncQueue.verifyOperationInProgress();const t=await lB(n);ce(Fa,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>pP(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,r)=>pP(e.remoteStore,r))),n._onlineComponents=e}async function lB(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){ce(Fa,"Using user provided OfflineComponentProvider");try{await b1(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(r){return r.name==="FirebaseError"?r.code===ee.FAILED_PRECONDITION||r.code===ee.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11})(t))throw t;au("Error using user provided cache. Falling back to memory cache: "+t),await b1(n,new ng)}}else ce(Fa,"Using default OfflineComponentProvider"),await b1(n,new rB(void 0));return n._offlineComponents}async function BL(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(ce(Fa,"Using user provided OnlineComponentProvider"),await xP(n,n._uninitializedComponentsProvider._online)):(ce(Fa,"Using default OnlineComponentProvider"),await xP(n,new B0))),n._onlineComponents}function uB(n){return BL(n).then((e=>e.syncEngine))}async function cB(n){const e=await BL(n),t=e.eventManager;return t.onListen=KU.bind(null,e.syncEngine),t.onUnlisten=XU.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=qU.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=YU.bind(null,e.syncEngine),t}function hB(n,e,t={}){const i=new go;return n.asyncQueue.enqueueAndForget((async()=>(function(s,o,a,u,h){const d=new oB({next:m=>{d.Nu(),o.enqueueAndForget((()=>FU(s,g))),m.fromCache&&u.source==="server"?h.reject(new me(ee.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(m)},error:m=>h.reject(m)}),g=new UU(a,d,{includeMetadataChanges:!0,qa:!0});return VU(s,g)})(await cB(n),n.asyncQueue,e,t,i))),i.promise}function zL(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const TP=new Map;const $L="firestore.googleapis.com",IP=!0;class SP{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new me(ee.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=$L,this.ssl=IP}else this.host=e.host,this.ssl=e.ssl??IP;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=hL;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Gj)throw new me(ee.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}nG("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=zL(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new me(ee.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new me(ee.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new me(ee.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,r){return i.timeoutSeconds===r.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class iy{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new SP({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new me(ee.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new me(ee.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new SP(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new K7;switch(i.type){case"firstParty":return new Y7(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new me(ee.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=TP.get(t);i&&(ce("ComponentProvider","Removing Datastore"),TP.delete(t),i.terminate())})(this),Promise.resolve()}}function dB(n,e,t,i={}){n=Da(n,iy);const r=wu(e),s=n._getSettings(),o={...s,emulatorOptions:n._getEmulatorOptions()},a=`${e}:${t}`;r&&(Ex(`https://${a}`),wx("Firestore",!0)),s.host!==$L&&s.host!==a&&au("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...s,host:a,ssl:r,emulatorOptions:i};if(!ru(u,o)&&(n._setSettings(u),i.mockUserToken)){let h,d;if(typeof i.mockUserToken=="string")h=i.mockUserToken,d=Vn.MOCK_USER;else{h=D4(i.mockUserToken,n._app?.options.projectId);const g=i.mockUserToken.sub||i.mockUserToken.user_id;if(!g)throw new me(ee.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new Vn(g)}n._authCredentials=new q7(new Z4(h,d))}}class Dh{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Dh(this.firestore,e,this._query)}}class gn{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ca(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new gn(this.firestore,e,this._key)}toJSON(){return{type:gn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Rg(t,gn._jsonSchema))return new gn(e,i||null,new pe(gt.fromString(t.referencePath)))}}gn._jsonSchemaVersion="firestore/documentReference/1.0",gn._jsonSchema={type:ln("string",gn._jsonSchemaVersion),referencePath:ln("string")};class Ca extends Dh{constructor(e,t,i){super(e,t,Vx(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new gn(this.firestore,null,new pe(e))}withConverter(e){return new Ca(this.firestore,e,this._path)}}function AP(n,e,...t){if(n=ni(n),J4("collection","path",e),n instanceof iy){const i=gt.fromString(e,...t);return mR(i),new Ca(n,null,i)}{if(!(n instanceof gn||n instanceof Ca))throw new me(ee.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(gt.fromString(e,...t));return mR(i),new Ca(n.firestore,null,i)}}function rw(n,e,...t){if(n=ni(n),arguments.length===1&&(e=Ax.newId()),J4("doc","path",e),n instanceof iy){const i=gt.fromString(e,...t);return gR(i),new gn(n,null,new pe(i))}{if(!(n instanceof gn||n instanceof Ca))throw new me(ee.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(gt.fromString(e,...t));return gR(i),new gn(n.firestore,n instanceof Ca?n.converter:null,new pe(i))}}const RP="AsyncQueue";class PP{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new SL(this,"async_queue_retry"),this._c=()=>{const i=Wp();i&&ce(RP,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=Wp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Wp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new go;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!$a(e))throw e;ce(RP,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,ui("INTERNAL UNHANDLED ERROR: ",CP(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=tT.createAndSchedule(this,e,t,i,(s=>this.hc(s)));return this.tc.push(r),r}uc(){this.nc&&Te(47125,{Pc:CP(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function CP(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class Nh extends iy{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new PP,this._persistenceKey=r?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new PP(e),this._firestoreClient=void 0,await e}}}function fB(n,e){const t=typeof n=="object"?n:Ix(),i=typeof n=="string"?n:b0,r=F_(t,"firestore").getImmediate({identifier:i});if(!r._initialized){const s=b4("firestore");s&&dB(r,...s)}return r}function WL(n){if(n._terminated)throw new me(ee.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||KL(n),n._firestoreClient}function KL(n){const e=n._freezeSettings(),t=(function(r,s,o,a){return new OG(r,s,o,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,zL(a.experimentalLongPollingOptions),a.useFetchStreams,a.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new aB(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(r){const s=r?._online.build();return{_offline:r?._offline.build(s),_online:s}})(n._componentsProvider))}function gB(n,e){au("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return mB(n,B0.provider,{build:i=>new sB(i,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function mB(n,e,t){if((n=Da(n,Nh))._firestoreClient||n._terminated)throw new me(ee.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new me(ee.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},KL(n)}class vr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new vr(un.fromBase64String(e))}catch(t){throw new me(ee.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new vr(un.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:vr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Rg(e,vr._jsonSchema))return vr.fromBase64String(e.bytes)}}vr._jsonSchemaVersion="firestore/bytes/1.0",vr._jsonSchema={type:ln("string",vr._jsonSchemaVersion),bytes:ln("string")};class ry{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new me(ee.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new zt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class oT{constructor(e){this._methodName=e}}class As{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new me(ee.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new me(ee.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return $e(this._lat,e._lat)||$e(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:As._jsonSchemaVersion}}static fromJSON(e){if(Rg(e,As._jsonSchema))return new As(e.latitude,e.longitude)}}As._jsonSchemaVersion="firestore/geoPoint/1.0",As._jsonSchema={type:ln("string",As._jsonSchemaVersion),latitude:ln("number"),longitude:ln("number")};class Rs{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,r){if(i.length!==r.length)return!1;for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Rs._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Rg(e,Rs._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Rs(e.vectorValues);throw new me(ee.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Rs._jsonSchemaVersion="firestore/vectorValue/1.0",Rs._jsonSchema={type:ln("string",Rs._jsonSchemaVersion),vectorValues:ln("object")};const pB=/^__.*__$/;class _B{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new Ro(e,this.data,this.fieldMask,t,this.fieldTransforms):new kh(e,this.data,t,this.fieldTransforms)}}class qL{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new Ro(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function HL(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Te(40011,{Ac:n})}}class aT{constructor(e,t,i,r,s,o){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=r,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new aT({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),i=this.Vc({path:t,fc:!1});return i.gc(e),i}yc(e){const t=this.path?.child(e),i=this.Vc({path:t,fc:!1});return i.Rc(),i}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return z0(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(HL(this.Ac)&&pB.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class yB{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||ty(e)}Cc(e,t,i,r=!1){return new aT({Ac:e,methodName:t,Dc:i,path:zt.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function lT(n){const e=n._freezeSettings(),t=ty(n._databaseId);return new yB(n._databaseId,!!e.ignoreUndefinedProperties,t)}function vB(n,e,t,i,r,s={}){const o=n.Cc(s.merge||s.mergeFields?2:0,e,t,r);uT("Data must be an object, but it was:",o,i);const a=XL(i,o);let u,h;if(s.merge)u=new bi(o.fieldMask),h=o.fieldTransforms;else if(s.mergeFields){const d=[];for(const g of s.mergeFields){const m=sw(e,g,t);if(!o.contains(m))throw new me(ee.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);ZL(d,m)||d.push(m)}u=new bi(d),h=o.fieldTransforms.filter((g=>u.covers(g.field)))}else u=null,h=o.fieldTransforms;return new _B(new Qn(a),u,h)}class sy extends oT{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof sy}}function EB(n,e,t,i){const r=n.Cc(1,e,t);uT("Data must be an object, but it was:",r,i);const s=[],o=Qn.empty();Wa(i,((u,h)=>{const d=cT(e,u,t);h=ni(h);const g=r.yc(d);if(h instanceof sy)s.push(d);else{const m=Og(h,g);m!=null&&(s.push(d),o.set(d,m))}}));const a=new bi(s);return new qL(o,a,r.fieldTransforms)}function wB(n,e,t,i,r,s){const o=n.Cc(1,e,t),a=[sw(e,i,t)],u=[r];if(s.length%2!=0)throw new me(ee.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<s.length;m+=2)a.push(sw(e,s[m])),u.push(s[m+1]);const h=[],d=Qn.empty();for(let m=a.length-1;m>=0;--m)if(!ZL(h,a[m])){const v=a[m];let y=u[m];y=ni(y);const I=o.yc(v);if(y instanceof sy)h.push(v);else{const w=Og(y,I);w!=null&&(h.push(v),d.set(v,w))}}const g=new bi(h);return new qL(d,g,o.fieldTransforms)}function xB(n,e,t,i=!1){return Og(t,n.Cc(i?4:3,e))}function Og(n,e){if(YL(n=ni(n)))return uT("Unsupported field value:",e,n),XL(n,e);if(n instanceof oT)return(function(i,r){if(!HL(r.Ac))throw r.Sc(`${i._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Sc(`${i._methodName}() is not currently supported inside arrays`);const s=i._toFieldTransform(r);s&&r.fieldTransforms.push(s)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(i,r){const s=[];let o=0;for(const a of i){let u=Og(a,r.wc(o));u==null&&(u={nullValue:"NULL_VALUE"}),s.push(u),o++}return{arrayValue:{values:s}}})(n,e)}return(function(i,r){if((i=ni(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return nj(r.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const s=xt.fromDate(i);return{timestampValue:xh(r.serializer,s)}}if(i instanceof xt){const s=new xt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:xh(r.serializer,s)}}if(i instanceof As)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof vr)return{bytesValue:Xk(r.serializer,i._byteString)};if(i instanceof gn){const s=r.databaseId,o=i.firestore._databaseId;if(!o.isEqual(s))throw r.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:zx(i.firestore._databaseId||r.databaseId,i._key.path)}}if(i instanceof Rs)return(function(o,a){return{mapValue:{fields:{[Dx]:{stringValue:Nx},[ph]:{arrayValue:{values:o.toArray().map((h=>{if(typeof h!="number")throw a.Sc("VectorValues must only contain numeric values.");return Fx(a.serializer,h)}))}}}}}})(i,r);throw r.Sc(`Unsupported field value: ${G_(i)}`)})(n,e)}function XL(n,e){const t={};return mk(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Wa(n,((i,r)=>{const s=Og(r,e.mc(i));s!=null&&(t[i]=s)})),{mapValue:{fields:t}}}function YL(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof xt||n instanceof As||n instanceof vr||n instanceof gn||n instanceof oT||n instanceof Rs)}function uT(n,e,t){if(!YL(t)||!ek(t)){const i=G_(t);throw i==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+i)}}function sw(n,e,t){if((e=ni(e))instanceof ry)return e._internalPath;if(typeof e=="string")return cT(n,e);throw z0("Field path arguments must be of type string or ",n,!1,void 0,t)}const TB=new RegExp("[~\\*/\\[\\]]");function cT(n,e,t){if(e.search(TB)>=0)throw z0(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new ry(...e.split("."))._internalPath}catch{throw z0(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function z0(n,e,t,i,r){const s=i&&!i.isEmpty(),o=r!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=` in field ${i}`),o&&(u+=` in document ${r}`),u+=")"),new me(ee.INVALID_ARGUMENT,a+n+u)}function ZL(n,e){return n.some((t=>t.isEqual(e)))}class QL{constructor(e,t,i,r,s){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new gn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new IB(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(hT("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class IB extends QL{data(){return super.data()}}function hT(n,e){return typeof e=="string"?cT(n,e):e instanceof ry?e._internalPath:e._delegate._internalPath}function SB(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new me(ee.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class dT{}class AB extends dT{}function RB(n,e,...t){let i=[];e instanceof dT&&i.push(e),i=i.concat(t),(function(s){const o=s.filter((u=>u instanceof fT)).length,a=s.filter((u=>u instanceof oy)).length;if(o>1||o>0&&a>0)throw new me(ee.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const r of i)n=r._apply(n);return n}class oy extends AB{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new oy(e,t,i)}_apply(e){const t=this._parse(e);return JL(e._query,t),new Dh(e.firestore,e.converter,WE(e._query,t))}_parse(e){const t=lT(e.firestore);return(function(s,o,a,u,h,d,g){let m;if(h.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new me(ee.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){bP(g,d);const y=[];for(const I of g)y.push(MP(u,s,I));m={arrayValue:{values:y}}}else m=MP(u,s,g)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||bP(g,d),m=xB(a,o,g,d==="in"||d==="not-in");return et.create(h,d,m)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function PB(n,e,t){const i=e,r=hT("where",n);return oy._create(r,i,t)}class fT extends dT{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new fT(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:Tt.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(r,s){let o=r;const a=s.getFlattenedFilters();for(const u of a)JL(o,u),o=WE(o,u)})(e._query,t),new Dh(e.firestore,e.converter,WE(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function MP(n,e,t){if(typeof(t=ni(t))=="string"){if(t==="")throw new me(ee.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!kk(e)&&t.indexOf("/")!==-1)throw new me(ee.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(gt.fromString(t));if(!pe.isDocumentKey(i))throw new me(ee.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Qf(n,new pe(i))}if(t instanceof gn)return Qf(n,t._key);throw new me(ee.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${G_(t)}.`)}function bP(n,e){if(!Array.isArray(n)||n.length===0)throw new me(ee.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function JL(n,e){const t=(function(r,s){for(const o of r)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null})(n.filters,(function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new me(ee.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new me(ee.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class CB{convertValue(e,t="none"){switch(Na(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Vt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Eo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Te(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return Wa(e,((r,s)=>{i[r]=this.convertValue(s,t)})),i}convertVectorValue(e){const t=e.fields?.[ph].arrayValue?.values?.map((i=>Vt(i.doubleValue)));return new Rs(t)}convertGeoPoint(e){return new As(Vt(e.latitude),Vt(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=W_(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(Yf(e));default:return null}}convertTimestamp(e){const t=vo(e);return new xt(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=gt.fromString(e);Ce(sL(i),9688,{name:e});const r=new lu(i.get(1),i.get(3)),s=new pe(i.popFirst(5));return r.isEqual(t)||ui(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function MB(n,e,t){let i;return i=n?n.toFirestore(e):e,i}class Tp{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Yc extends QL{constructor(e,t,i,r,s,o){super(e,t,i,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Kp(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(hT("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new me(ee.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Yc._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Yc._jsonSchemaVersion="firestore/documentSnapshot/1.0",Yc._jsonSchema={type:ln("string",Yc._jsonSchemaVersion),bundleSource:ln("string","DocumentSnapshot"),bundleName:ln("string"),bundle:ln("string")};class Kp extends Yc{data(e={}){return super.data(e)}}class Zc{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Tp(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new Kp(this._firestore,this._userDataWriter,i.key,i,new Tp(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new me(ee.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(r,s){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map((a=>{const u=new Kp(r._firestore,r._userDataWriter,a.doc.key,a.doc,new Tp(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);return a.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}}))}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter((a=>s||a.type!==3)).map((a=>{const u=new Kp(r._firestore,r._userDataWriter,a.doc.key,a.doc,new Tp(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);let h=-1,d=-1;return a.type!==0&&(h=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:bB(a.type),doc:u,oldIndex:h,newIndex:d}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new me(ee.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Zc._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Ax.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],r=[];return this.docs.forEach((s=>{s._document!==null&&(t.push(s._document),i.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),r.push(s.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function bB(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Te(61501,{type:n})}}Zc._jsonSchemaVersion="firestore/querySnapshot/1.0",Zc._jsonSchema={type:ln("string",Zc._jsonSchemaVersion),bundleSource:ln("string","QuerySnapshot"),bundleName:ln("string"),bundle:ln("string")};class kB extends CB{constructor(e){super(),this.firestore=e}convertBytes(e){return new vr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new gn(this.firestore,null,t)}}function LB(n){n=Da(n,Dh);const e=Da(n.firestore,Nh),t=WL(e),i=new kB(e);return SB(n._query),hB(t,n._query).then((r=>new Zc(e,i,n,r)))}function DB(n,e,t,...i){n=Da(n,gn);const r=Da(n.firestore,Nh),s=lT(r);let o;return o=typeof(e=ni(e))=="string"||e instanceof ry?wB(s,"updateDoc",n._key,e,t,i):EB(s,"updateDoc",n._key,e),gT(r,[o.toMutation(n._key,ci.exists(!0))])}function NB(n){return gT(Da(n.firestore,Nh),[new Y_(n._key,ci.none())])}function OB(n,e){const t=Da(n.firestore,Nh),i=rw(n),r=MB(n.converter,e);return gT(t,[vB(lT(n.firestore),"addDoc",i._key,r,n.converter!==null,{}).toMutation(i._key,ci.exists(!1))]).then((()=>i))}function gT(n,e){return(function(i,r){const s=new go;return i.asyncQueue.enqueueAndForget((async()=>ZU(await uB(i),r,s))),s.promise})(WL(n),e)}(function(e,t=!0){(function(r){bh=r})(xu),su(new La("firestore",((i,{instanceIdentifier:r,options:s})=>{const o=i.getProvider("app").getImmediate(),a=new Nh(new H7(i.getProvider("auth-internal")),new Z7(o,i.getProvider("app-check-internal")),(function(h,d){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new me(ee.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new lu(h.options.projectId,d)})(o,r),o);return s={useFetchStreams:t,...s},a._setSettings(s),a}),"PUBLIC").setMultipleInstances(!0)),Ss(cR,hR,e),Ss(cR,hR,"esm2020")})();var VB="firebase",FB="12.7.0";Ss(VB,FB,"app");function eD(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const GB=eD,tD=new Sg("auth","Firebase",eD());const $0=new xx("@firebase/auth");function jB(n,...e){$0.logLevel<=Je.WARN&&$0.warn(`Auth (${xu}): ${n}`,...e)}function qp(n,...e){$0.logLevel<=Je.ERROR&&$0.error(`Auth (${xu}): ${n}`,...e)}function wo(n,...e){throw mT(n,...e)}function Ps(n,...e){return mT(n,...e)}function nD(n,e,t){const i={...GB(),[e]:t};return new Sg("auth","Firebase",i).create(e,{appName:n.name})}function Xl(n){return nD(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function mT(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return tD.create(n,...e)}function Be(n,e,...t){if(!n)throw mT(e,...t)}function lo(n){const e="INTERNAL ASSERTION FAILED: "+n;throw qp(e),new Error(e)}function xo(n,e){n||lo(e)}function ow(){return typeof self<"u"&&self.location?.href||""}function UB(){return kP()==="http:"||kP()==="https:"}function kP(){return typeof self<"u"&&self.location?.protocol||null}function BB(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(UB()||R9()||"connection"in navigator)?navigator.onLine:!0}function zB(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class Vg{constructor(e,t){this.shortDelay=e,this.longDelay=t,xo(t>e,"Short delay should be less than long delay!"),this.isMobile=S9()||P9()}get(){return BB()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function pT(n,e){xo(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class iD{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;lo("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;lo("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;lo("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const $B={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const WB=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],KB=new Vg(3e4,6e4);function _T(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Oh(n,e,t,i,r={}){return rD(n,r,async()=>{let s={},o={};i&&(e==="GET"?o=i:s={body:JSON.stringify(i)});const a=Ag({key:n.config.apiKey,...o}).slice(1),u=await n._getAdditionalHeaders();u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode);const h={method:e,headers:u,...s};return A9()||(h.referrerPolicy="no-referrer"),n.emulatorConfig&&wu(n.emulatorConfig.host)&&(h.credentials="include"),iD.fetch()(await sD(n,n.config.apiHost,t,a),h)})}async function rD(n,e,t){n._canInitEmulator=!1;const i={...$B,...e};try{const r=new HB(n),s=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Ip(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[u,h]=a.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ip(n,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw Ip(n,"email-already-in-use",o);if(u==="USER_DISABLED")throw Ip(n,"user-disabled",o);const d=i[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw nD(n,d,h);wo(n,d)}}catch(r){if(r instanceof Os)throw r;wo(n,"network-request-failed",{message:String(r)})}}async function qB(n,e,t,i,r={}){const s=await Oh(n,e,t,i,r);return"mfaPendingCredential"in s&&wo(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function sD(n,e,t,i){const r=`${e}${t}?${i}`,s=n,o=s.config.emulator?pT(n.config,r):`${n.config.apiScheme}://${r}`;return WB.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}class HB{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Ps(this.auth,"network-request-failed")),KB.get())})}}function Ip(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const r=Ps(n,e,i);return r.customData._tokenResponse=t,r}async function XB(n,e){return Oh(n,"POST","/v1/accounts:delete",e)}async function W0(n,e){return Oh(n,"POST","/v1/accounts:lookup",e)}function yf(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function YB(n,e=!1){const t=ni(n),i=await t.getIdToken(e),r=yT(i);Be(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");const s=typeof r.firebase=="object"?r.firebase:void 0,o=s?.sign_in_provider;return{claims:r,token:i,authTime:yf(k1(r.auth_time)),issuedAtTime:yf(k1(r.iat)),expirationTime:yf(k1(r.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}}function k1(n){return Number(n)*1e3}function yT(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return qp("JWT malformed, contained fewer than 3 sections"),null;try{const r=P4(t);return r?JSON.parse(r):(qp("Failed to decode base64 JWT payload"),null)}catch(r){return qp("Caught error parsing JWT payload as JSON",r?.toString()),null}}function LP(n){const e=yT(n);return Be(e,"internal-error"),Be(typeof e.exp<"u","internal-error"),Be(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function ig(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof Os&&ZB(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function ZB({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class QB{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class aw{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=yf(this.lastLoginAt),this.creationTime=yf(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function K0(n){const e=n.auth,t=await n.getIdToken(),i=await ig(n,W0(e,{idToken:t}));Be(i?.users.length,e,"internal-error");const r=i.users[0];n._notifyReloadListener(r);const s=r.providerUserInfo?.length?oD(r.providerUserInfo):[],o=ez(n.providerData,s),a=n.isAnonymous,u=!(n.email&&r.passwordHash)&&!o?.length,h=a?u:!1,d={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:o,metadata:new aw(r.createdAt,r.lastLoginAt),isAnonymous:h};Object.assign(n,d)}async function JB(n){const e=ni(n);await K0(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function ez(n,e){return[...n.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function oD(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function tz(n,e){const t=await rD(n,{},async()=>{const i=Ag({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:s}=n.config,o=await sD(n,r,"/v1/token",`key=${s}`),a=await n._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:a,body:i};return n.emulatorConfig&&wu(n.emulatorConfig.host)&&(u.credentials="include"),iD.fetch()(o,u)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function nz(n,e){return Oh(n,"POST","/v2/accounts:revokeToken",_T(n,e))}class Qc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Be(e.idToken,"internal-error"),Be(typeof e.idToken<"u","internal-error"),Be(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):LP(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Be(e.length!==0,"internal-error");const t=LP(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Be(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:r,expiresIn:s}=await tz(e,t);this.updateTokensAndExpiration(i,r,Number(s))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:r,expirationTime:s}=t,o=new Qc;return i&&(Be(typeof i=="string","internal-error",{appName:e}),o.refreshToken=i),r&&(Be(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),s&&(Be(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Qc,this.toJSON())}_performRefresh(){return lo("not implemented")}}function aa(n,e){Be(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Kr{constructor({uid:e,auth:t,stsTokenManager:i,...r}){this.providerId="firebase",this.proactiveRefresh=new QB(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new aw(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await ig(this,this.stsTokenManager.getToken(this.auth,e));return Be(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return YB(this,e)}reload(){return JB(this)}_assign(e){this!==e&&(Be(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Kr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Be(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await K0(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Wr(this.auth.app))return Promise.reject(Xl(this.auth));const e=await this.getIdToken();return await ig(this,XB(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,r=t.email??void 0,s=t.phoneNumber??void 0,o=t.photoURL??void 0,a=t.tenantId??void 0,u=t._redirectEventId??void 0,h=t.createdAt??void 0,d=t.lastLoginAt??void 0,{uid:g,emailVerified:m,isAnonymous:v,providerData:y,stsTokenManager:I}=t;Be(g&&I,e,"internal-error");const w=Qc.fromJSON(this.name,I);Be(typeof g=="string",e,"internal-error"),aa(i,e.name),aa(r,e.name),Be(typeof m=="boolean",e,"internal-error"),Be(typeof v=="boolean",e,"internal-error"),aa(s,e.name),aa(o,e.name),aa(a,e.name),aa(u,e.name),aa(h,e.name),aa(d,e.name);const R=new Kr({uid:g,auth:e,email:r,emailVerified:m,displayName:i,isAnonymous:v,photoURL:o,phoneNumber:s,tenantId:a,stsTokenManager:w,createdAt:h,lastLoginAt:d});return y&&Array.isArray(y)&&(R.providerData=y.map(P=>({...P}))),u&&(R._redirectEventId=u),R}static async _fromIdTokenResponse(e,t,i=!1){const r=new Qc;r.updateFromServerResponse(t);const s=new Kr({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:i});return await K0(s),s}static async _fromGetAccountInfoResponse(e,t,i){const r=t.users[0];Be(r.localId!==void 0,"internal-error");const s=r.providerUserInfo!==void 0?oD(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!s?.length,a=new Qc;a.updateFromIdToken(i);const u=new Kr({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:o}),h={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new aw(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!s?.length};return Object.assign(u,h),u}}const DP=new Map;function uo(n){xo(n instanceof Function,"Expected a class definition");let e=DP.get(n);return e?(xo(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,DP.set(n,e),e)}class aD{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}aD.type="NONE";const NP=aD;function Hp(n,e,t){return`firebase:${n}:${e}:${t}`}class Jc{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:r,name:s}=this.auth;this.fullUserKey=Hp(this.userKey,r.apiKey,s),this.fullPersistenceKey=Hp("persistence",r.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await W0(this.auth,{idToken:e}).catch(()=>{});return t?Kr._fromGetAccountInfoResponse(this.auth,t,e):null}return Kr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new Jc(uo(NP),e,i);const r=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let s=r[0]||uo(NP);const o=Hp(i,e.config.apiKey,e.name);let a=null;for(const h of t)try{const d=await h._get(o);if(d){let g;if(typeof d=="string"){const m=await W0(e,{idToken:d}).catch(()=>{});if(!m)break;g=await Kr._fromGetAccountInfoResponse(e,m,d)}else g=Kr._fromJSON(e,d);h!==s&&(a=g),s=h;break}}catch{}const u=r.filter(h=>h._shouldAllowMigration);return!s._shouldAllowMigration||!u.length?new Jc(s,e,i):(s=u[0],a&&await s._set(o,a.toJSON()),await Promise.all(t.map(async h=>{if(h!==s)try{await h._remove(o)}catch{}})),new Jc(s,e,i))}}function OP(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(hD(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(lD(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(fD(e))return"Blackberry";if(gD(e))return"Webos";if(uD(e))return"Safari";if((e.includes("chrome/")||cD(e))&&!e.includes("edge/"))return"Chrome";if(dD(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function lD(n=pn()){return/firefox\//i.test(n)}function uD(n=pn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function cD(n=pn()){return/crios\//i.test(n)}function hD(n=pn()){return/iemobile/i.test(n)}function dD(n=pn()){return/android/i.test(n)}function fD(n=pn()){return/blackberry/i.test(n)}function gD(n=pn()){return/webos/i.test(n)}function vT(n=pn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function iz(n=pn()){return vT(n)&&!!window.navigator?.standalone}function rz(){return C9()&&document.documentMode===10}function mD(n=pn()){return vT(n)||dD(n)||gD(n)||fD(n)||/windows phone/i.test(n)||hD(n)}function pD(n,e=[]){let t;switch(n){case"Browser":t=OP(pn());break;case"Worker":t=`${OP(pn())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${xu}/${i}`}class sz{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=s=>new Promise((o,a)=>{try{const u=e(s);o(u)}catch(u){a(u)}});i.onAbort=t,this.queue.push(i);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function oz(n,e={}){return Oh(n,"GET","/v2/passwordPolicy",_T(n,e))}const az=6;class lz{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??az,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,r,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class uz{constructor(e,t,i,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new VP(this),this.idTokenSubscription=new VP(this),this.beforeStateQueue=new sz(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=tD,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=uo(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Jc.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await W0(this,{idToken:e}),i=await Kr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Wr(this.app)){const s=this.app.settings.authIdToken;return s?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(o,o))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const s=this.redirectUser?._redirectEventId,o=i?._redirectEventId,a=await this.tryRedirectSignIn(e);(!s||s===o)&&a?.user&&(i=a.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(s){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Be(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await K0(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=zB()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Wr(this.app))return Promise.reject(Xl(this));const t=e?ni(e):null;return t&&Be(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Be(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Wr(this.app)?Promise.reject(Xl(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Wr(this.app)?Promise.reject(Xl(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(uo(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await oz(this),t=new lz(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Sg("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await nz(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&uo(e)||this._popupRedirectResolver;Be(t,this,"argument-error"),this.redirectPersistenceManager=await Jc.create(this,[uo(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,r){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(Be(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof t=="function"){const u=e.addObserver(t,i,r);return()=>{o=!0,u()}}else{const u=e.addObserver(t);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Be(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=pD(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(Wr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&jB(`Error while retrieving App Check token: ${e.error}`),e?.token}}function ET(n){return ni(n)}class VP{constructor(e){this.auth=e,this.observer=null,this.addObserver=N9(t=>this.observer=t)}get next(){return Be(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let wT={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function cz(n){wT=n}function hz(n){return wT.loadJS(n)}function dz(){return wT.gapiScript}function fz(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function gz(n,e){const t=F_(n,"auth");if(t.isInitialized()){const r=t.getImmediate(),s=t.getOptions();if(ru(s,e??{}))return r;wo(r,"already-initialized")}return t.initialize({options:e})}function mz(n,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(uo);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function pz(n,e,t){const i=ET(n);Be(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const r=!1,s=_D(e),{host:o,port:a}=_z(e),u=a===null?"":`:${a}`,h={url:`${s}//${o}${u}/`},d=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!i._canInitEmulator){Be(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Be(ru(h,i.config.emulator)&&ru(d,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=h,i.emulatorConfig=d,i.settings.appVerificationDisabledForTesting=!0,wu(o)?(Ex(`${s}//${o}${u}`),wx("Auth",!0)):yz()}function _D(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function _z(n){const e=_D(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const s=r[1];return{host:s,port:FP(i.substr(s.length+1))}}else{const[s,o]=i.split(":");return{host:s,port:FP(o)}}}function FP(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function yz(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class yD{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return lo("not implemented")}_getIdTokenResponse(e){return lo("not implemented")}_linkToIdToken(e,t){return lo("not implemented")}_getReauthenticationResolver(e){return lo("not implemented")}}async function eh(n,e){return qB(n,"POST","/v1/accounts:signInWithIdp",_T(n,e))}const vz="http://localhost";class gu extends yD{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new gu(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):wo("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:r,...s}=t;if(!i||!r)return null;const o=new gu(i,r);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return eh(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,eh(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,eh(e,t)}buildRequest(){const e={requestUri:vz,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Ag(t)}return e}}class vD{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Fg extends vD{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class fa extends Fg{constructor(){super("facebook.com")}static credential(e){return gu._fromParams({providerId:fa.PROVIDER_ID,signInMethod:fa.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return fa.credentialFromTaggedObject(e)}static credentialFromError(e){return fa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return fa.credential(e.oauthAccessToken)}catch{return null}}}fa.FACEBOOK_SIGN_IN_METHOD="facebook.com";fa.PROVIDER_ID="facebook.com";class ga extends Fg{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return gu._fromParams({providerId:ga.PROVIDER_ID,signInMethod:ga.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return ga.credentialFromTaggedObject(e)}static credentialFromError(e){return ga.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return ga.credential(t,i)}catch{return null}}}ga.GOOGLE_SIGN_IN_METHOD="google.com";ga.PROVIDER_ID="google.com";class ma extends Fg{constructor(){super("github.com")}static credential(e){return gu._fromParams({providerId:ma.PROVIDER_ID,signInMethod:ma.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ma.credentialFromTaggedObject(e)}static credentialFromError(e){return ma.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ma.credential(e.oauthAccessToken)}catch{return null}}}ma.GITHUB_SIGN_IN_METHOD="github.com";ma.PROVIDER_ID="github.com";class pa extends Fg{constructor(){super("twitter.com")}static credential(e,t){return gu._fromParams({providerId:pa.PROVIDER_ID,signInMethod:pa.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return pa.credentialFromTaggedObject(e)}static credentialFromError(e){return pa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return pa.credential(t,i)}catch{return null}}}pa.TWITTER_SIGN_IN_METHOD="twitter.com";pa.PROVIDER_ID="twitter.com";class Ih{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,r=!1){const s=await Kr._fromIdTokenResponse(e,i,r),o=GP(i);return new Ih({user:s,providerId:o,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const r=GP(i);return new Ih({user:e,providerId:r,_tokenResponse:i,operationType:t})}}function GP(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class q0 extends Os{constructor(e,t,i,r){super(t.code,t.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,q0.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,r){return new q0(e,t,i,r)}}function ED(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?q0._fromErrorAndOperation(n,s,e,i):s})}async function Ez(n,e,t=!1){const i=await ig(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Ih._forOperation(n,"link",i)}async function wz(n,e,t=!1){const{auth:i}=n;if(Wr(i.app))return Promise.reject(Xl(i));const r="reauthenticate";try{const s=await ig(n,ED(i,r,e,n),t);Be(s.idToken,i,"internal-error");const o=yT(s.idToken);Be(o,i,"internal-error");const{sub:a}=o;return Be(n.uid===a,i,"user-mismatch"),Ih._forOperation(n,r,s)}catch(s){throw s?.code==="auth/user-not-found"&&wo(i,"user-mismatch"),s}}async function xz(n,e,t=!1){if(Wr(n.app))return Promise.reject(Xl(n));const i="signIn",r=await ED(n,i,e),s=await Ih._fromIdTokenResponse(n,i,r);return t||await n._updateCurrentUser(s.user),s}function Tz(n,e,t,i){return ni(n).onIdTokenChanged(e,t,i)}function Iz(n,e,t){return ni(n).beforeAuthStateChanged(e,t)}const H0="__sak";class wD{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(H0,"1"),this.storage.removeItem(H0),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const Sz=1e3,Az=10;class xD extends wD{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=mD(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),r=this.localCache[t];i!==r&&e(t,r,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,u)=>{this.notifyListeners(o,u)});return}const i=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const o=this.storage.getItem(i);!t&&this.localCache[i]===o||this.notifyListeners(i,o)},s=this.storage.getItem(i);rz()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,Az):r()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},Sz)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}xD.type="LOCAL";const Rz=xD;class TD extends wD{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}TD.type="SESSION";const ID=TD;function Pz(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class ay{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(r=>r.isListeningto(e));if(t)return t;const i=new ay(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:r,data:s}=t.data,o=this.handlersMap[r];if(!o?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:r});const a=Array.from(o).map(async h=>h(t.origin,s)),u=await Pz(a);t.ports[0].postMessage({status:"done",eventId:i,eventType:r,response:u})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}ay.receivers=[];function xT(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}class Cz{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,o;return new Promise((a,u)=>{const h=xT("",20);r.port1.start();const d=setTimeout(()=>{u(new Error("unsupported_event"))},i);o={messageChannel:r,onMessage(g){const m=g;if(m.data.eventId===h)switch(m.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(m.data.response);break;default:clearTimeout(d),clearTimeout(s),u(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function Cs(){return window}function Mz(n){Cs().location.href=n}function SD(){return typeof Cs().WorkerGlobalScope<"u"&&typeof Cs().importScripts=="function"}async function bz(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function kz(){return navigator?.serviceWorker?.controller||null}function Lz(){return SD()?self:null}const AD="firebaseLocalStorageDb",Dz=1,X0="firebaseLocalStorage",RD="fbase_key";class Gg{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function ly(n,e){return n.transaction([X0],e?"readwrite":"readonly").objectStore(X0)}function Nz(){const n=indexedDB.deleteDatabase(AD);return new Gg(n).toPromise()}function lw(){const n=indexedDB.open(AD,Dz);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(X0,{keyPath:RD})}catch(r){t(r)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(X0)?e(i):(i.close(),await Nz(),e(await lw()))})})}async function jP(n,e,t){const i=ly(n,!0).put({[RD]:e,value:t});return new Gg(i).toPromise()}async function Oz(n,e){const t=ly(n,!1).get(e),i=await new Gg(t).toPromise();return i===void 0?null:i.value}function UP(n,e){const t=ly(n,!0).delete(e);return new Gg(t).toPromise()}const Vz=800,Fz=3;class PD{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await lw(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>Fz)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return SD()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ay._getInstance(Lz()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await bz(),!this.activeServiceWorker)return;this.sender=new Cz(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||kz()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await lw();return await jP(e,H0,"1"),await UP(e,H0),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>jP(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>Oz(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>UP(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const s=ly(r,!1).getAll();return new Gg(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:r,value:s}of e)i.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(s)&&(this.notifyListeners(r,s),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!i.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Vz)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}PD.type="LOCAL";const Gz=PD;new Vg(3e4,6e4);function jz(n,e){return e?uo(e):(Be(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class TT extends yD{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return eh(e,this._buildIdpRequest())}_linkToIdToken(e,t){return eh(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return eh(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Uz(n){return xz(n.auth,new TT(n),n.bypassAuthState)}function Bz(n){const{auth:e,user:t}=n;return Be(t,e,"internal-error"),wz(t,new TT(n),n.bypassAuthState)}async function zz(n){const{auth:e,user:t}=n;return Be(t,e,"internal-error"),Ez(t,new TT(n),n.bypassAuthState)}class CD{constructor(e,t,i,r,s=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:r,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:t,sessionId:i,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(u))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Uz;case"linkViaPopup":case"linkViaRedirect":return zz;case"reauthViaPopup":case"reauthViaRedirect":return Bz;default:wo(this.auth,"internal-error")}}resolve(e){xo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){xo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const $z=new Vg(2e3,1e4);class Dc extends CD{constructor(e,t,i,r,s){super(e,t,r,s),this.provider=i,this.authWindow=null,this.pollId=null,Dc.currentPopupAction&&Dc.currentPopupAction.cancel(),Dc.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Be(e,this.auth,"internal-error"),e}async onExecution(){xo(this.filter.length===1,"Popup operations only handle one event");const e=xT();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Ps(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Ps(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Dc.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ps(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,$z.get())};e()}}Dc.currentPopupAction=null;const Wz="pendingRedirect",Xp=new Map;class Kz extends CD{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=Xp.get(this.auth._key());if(!e){try{const i=await qz(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}Xp.set(this.auth._key(),e)}return this.bypassAuthState||Xp.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function qz(n,e){const t=Yz(e),i=Xz(n);if(!await i._isAvailable())return!1;const r=await i._get(t)==="true";return await i._remove(t),r}function Hz(n,e){Xp.set(n._key(),e)}function Xz(n){return uo(n._redirectPersistence)}function Yz(n){return Hp(Wz,n.config.apiKey,n.name)}async function Zz(n,e,t=!1){if(Wr(n.app))return Promise.reject(Xl(n));const i=ET(n),r=jz(i,e),o=await new Kz(i,r,t).execute();return o&&!t&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,e)),o}const Qz=600*1e3;class Jz{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!e$(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!MD(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Ps(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Qz&&this.cachedEventUids.clear(),this.cachedEventUids.has(BP(e))}saveEventToCache(e){this.cachedEventUids.add(BP(e)),this.lastProcessedEventTime=Date.now()}}function BP(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function MD({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function e$(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return MD(n);default:return!1}}async function t$(n,e={}){return Oh(n,"GET","/v1/projects",e)}const n$=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,i$=/^https?/;async function r$(n){if(n.config.emulator)return;const{authorizedDomains:e}=await t$(n);for(const t of e)try{if(s$(t))return}catch{}wo(n,"unauthorized-domain")}function s$(n){const e=ow(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===i}if(!i$.test(t))return!1;if(n$.test(n))return i===n;const r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const o$=new Vg(3e4,6e4);function zP(){const n=Cs().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function a$(n){return new Promise((e,t)=>{function i(){zP(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{zP(),t(Ps(n,"network-request-failed"))},timeout:o$.get()})}if(Cs().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Cs().gapi?.load)i();else{const r=fz("iframefcb");return Cs()[r]=()=>{gapi.load?i():t(Ps(n,"network-request-failed"))},hz(`${dz()}?onload=${r}`).catch(s=>t(s))}}).catch(e=>{throw Yp=null,e})}let Yp=null;function l$(n){return Yp=Yp||a$(n),Yp}const u$=new Vg(5e3,15e3),c$="__/auth/iframe",h$="emulator/auth/iframe",d$={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},f$=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function g$(n){const e=n.config;Be(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?pT(e,h$):`https://${n.config.authDomain}/${c$}`,i={apiKey:e.apiKey,appName:n.name,v:xu},r=f$.get(n.config.apiHost);r&&(i.eid=r);const s=n._getFrameworks();return s.length&&(i.fw=s.join(",")),`${t}?${Ag(i).slice(1)}`}async function m$(n){const e=await l$(n),t=Cs().gapi;return Be(t,n,"internal-error"),e.open({where:document.body,url:g$(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:d$,dontclear:!0},i=>new Promise(async(r,s)=>{await i.restyle({setHideOnLeave:!1});const o=Ps(n,"network-request-failed"),a=Cs().setTimeout(()=>{s(o)},u$.get());function u(){Cs().clearTimeout(a),r(i)}i.ping(u).then(u,()=>{s(o)})}))}const p$={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},_$=500,y$=600,v$="_blank",E$="http://localhost";class $P{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function w$(n,e,t,i=_$,r=y$){const s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let a="";const u={...p$,width:i.toString(),height:r.toString(),top:s,left:o},h=pn().toLowerCase();t&&(a=cD(h)?v$:t),lD(h)&&(e=e||E$,u.scrollbars="yes");const d=Object.entries(u).reduce((m,[v,y])=>`${m}${v}=${y},`,"");if(iz(h)&&a!=="_self")return x$(e||"",a),new $P(null);const g=window.open(e||"",a,d);Be(g,n,"popup-blocked");try{g.focus()}catch{}return new $P(g)}function x$(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const T$="__/auth/handler",I$="emulator/auth/handler",S$=encodeURIComponent("fac");async function WP(n,e,t,i,r,s){Be(n.config.authDomain,n,"auth-domain-config-required"),Be(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:xu,eventId:r};if(e instanceof vD){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",D9(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,g]of Object.entries({}))o[d]=g}if(e instanceof Fg){const d=e.getScopes().filter(g=>g!=="");d.length>0&&(o.scopes=d.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const d of Object.keys(a))a[d]===void 0&&delete a[d];const u=await n._getAppCheckToken(),h=u?`#${S$}=${encodeURIComponent(u)}`:"";return`${A$(n)}?${Ag(a).slice(1)}${h}`}function A$({config:n}){return n.emulator?pT(n,I$):`https://${n.authDomain}/${T$}`}const L1="webStorageSupport";class R${constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=ID,this._completeRedirectFn=Zz,this._overrideRedirectResult=Hz}async _openPopup(e,t,i,r){xo(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const s=await WP(e,t,i,ow(),r);return w$(e,s,xT())}async _openRedirect(e,t,i,r){await this._originValidation(e);const s=await WP(e,t,i,ow(),r);return Mz(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:r,promise:s}=this.eventManagers[t];return r?Promise.resolve(r):(xo(s,"If manager is not set, promise should be"),s)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await m$(e),i=new Jz(e);return t.register("authEvent",r=>(Be(r?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(L1,{type:L1},r=>{const s=r?.[0]?.[L1];s!==void 0&&t(!!s),wo(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=r$(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return mD()||uD()||vT()}}const P$=R$;var KP="@firebase/auth",qP="1.12.0";class C${constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Be(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function M$(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function b$(n){su(new La("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=i.options;Be(o&&!o.includes(":"),"invalid-api-key",{appName:i.name});const u={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:pD(n)},h=new uz(i,r,s,u);return mz(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),su(new La("auth-internal",e=>{const t=ET(e.getProvider("auth").getImmediate());return(i=>new C$(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ss(KP,qP,M$(n)),Ss(KP,qP,"esm2020")}const k$=300,L$=L4("authIdTokenMaxAge")||k$;let HP=null;const D$=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>L$)return;const r=t?.token;HP!==r&&(HP=r,await fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function N$(n=Ix()){const e=F_(n,"auth");if(e.isInitialized())return e.getImmediate();const t=gz(n,{popupRedirectResolver:P$,persistence:[Gz,Rz,ID]}),i=L4("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(i,location.origin);if(location.origin===s.origin){const o=D$(s.toString());Iz(t,o,()=>o(t.currentUser)),Tz(t,a=>o(a))}}const r=M4("auth");return r&&pz(t,`http://${r}`),t}function O$(){return document.getElementsByTagName("head")?.[0]??document}cz({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=r=>{const s=Ps("internal-error");s.customData=r,t(s)},i.type="text/javascript",i.charset="UTF-8",O$().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});b$("Browser");const bD="firebasestorage.googleapis.com",V$="storageBucket",F$=120*1e3,G$=600*1e3;class Vs extends Os{constructor(e,t,i=0){super(D1(e),`Firebase Storage: ${t} (${D1(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Vs.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return D1(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Ls;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Ls||(Ls={}));function D1(n){return"storage/"+n}function j$(){const n="An unknown error occurred, please check the error payload for server response.";return new Vs(Ls.UNKNOWN,n)}function U$(){return new Vs(Ls.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function B$(){return new Vs(Ls.CANCELED,"User canceled the upload/download.")}function z$(n){return new Vs(Ls.INVALID_URL,"Invalid URL '"+n+"'.")}function $$(n){return new Vs(Ls.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function XP(n){return new Vs(Ls.INVALID_ARGUMENT,n)}function kD(){return new Vs(Ls.APP_DELETED,"The Firebase app was deleted.")}function W$(n){return new Vs(Ls.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}class qr{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=qr.makeFromUrl(e,t)}catch{return new qr(e,"")}if(i.path==="")return i;throw $$(e)}static makeFromUrl(e,t){let i=null;const r="([A-Za-z0-9.\\-_]+)";function s(L){L.path.charAt(L.path.length-1)==="/"&&(L.path_=L.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+r+o,"i"),u={bucket:1,path:3};function h(L){L.path_=decodeURIComponent(L.path)}const d="v[A-Za-z0-9_]+",g=t.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",v=new RegExp(`^https?://${g}/${d}/b/${r}/o${m}`,"i"),y={bucket:1,path:3},I=t===bD?"(?:storage.googleapis.com|storage.cloud.google.com)":t,w="([^?#]*)",R=new RegExp(`^https?://${I}/${r}/${w}`,"i"),b=[{regex:a,indices:u,postModify:s},{regex:v,indices:y,postModify:h},{regex:R,indices:{bucket:1,path:2},postModify:h}];for(let L=0;L<b.length;L++){const D=b[L],B=D.regex.exec(e);if(B){const M=B[D.indices.bucket];let A=B[D.indices.path];A||(A=""),i=new qr(M,A),D.postModify(i);break}}if(i==null)throw z$(e);return i}}class K${constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function q$(n,e,t){let i=1,r=null,s=null,o=!1,a=0;function u(){return a===2}let h=!1;function d(...w){h||(h=!0,e.apply(null,w))}function g(w){r=setTimeout(()=>{r=null,n(v,u())},w)}function m(){s&&clearTimeout(s)}function v(w,...R){if(h){m();return}if(w){m(),d.call(null,w,...R);return}if(u()||o){m(),d.call(null,w,...R);return}i<64&&(i*=2);let b;a===1?(a=2,b=0):b=(i+Math.random())*1e3,g(b)}let y=!1;function I(w){y||(y=!0,m(),!h&&(r!==null?(w||(a=2),clearTimeout(r),g(0)):w||(a=1)))}return g(0),s=setTimeout(()=>{o=!0,I(!0)},t),I}function H$(n){n(!1)}function X$(n){return n!==void 0}function YP(n,e,t,i){if(i<e)throw XP(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw XP(`Invalid value for '${n}'. Expected ${t} or less.`)}function Y$(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const r=e(i)+"="+e(n[i]);t=t+r+"&"}return t=t.slice(0,-1),t}var Y0;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(Y0||(Y0={}));function Z$(n,e){const t=n>=500&&n<600,r=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||r||s}class Q${constructor(e,t,i,r,s,o,a,u,h,d,g,m=!0,v=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=r,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=u,this.timeout_=h,this.progressCallback_=d,this.connectionFactory_=g,this.retry=m,this.isUsingEmulator=v,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((y,I)=>{this.resolve_=y,this.reject_=I,this.start_()})}start_(){const e=(i,r)=>{if(r){i(!1,new Sp(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=a=>{const u=a.loaded,h=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,h)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const a=s.getErrorCode()===Y0.NO_ERROR,u=s.getStatus();if(!a||Z$(u,this.additionalRetryCodes_)&&this.retry){const d=s.getErrorCode()===Y0.ABORT;i(!1,new Sp(!1,null,d));return}const h=this.successCodes_.indexOf(u)!==-1;i(!0,new Sp(h,s))})},t=(i,r)=>{const s=this.resolve_,o=this.reject_,a=r.connection;if(r.wasSuccessCode)try{const u=this.callback_(a,a.getResponse());X$(u)?s(u):s()}catch(u){o(u)}else if(a!==null){const u=j$();u.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,u)):o(u)}else if(r.canceled){const u=this.appDelete_?kD():B$();o(u)}else{const u=U$();o(u)}};this.canceled_?t(!1,new Sp(!1,null,!0)):this.backoffId_=q$(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&H$(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Sp{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function J$(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function eW(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function tW(n,e){e&&(n["X-Firebase-GMPID"]=e)}function nW(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function iW(n,e,t,i,r,s,o=!0,a=!1){const u=Y$(n.urlParams),h=n.url+u,d=Object.assign({},n.headers);return tW(d,e),J$(d,t),eW(d,s),nW(d,i),new Q$(h,n.method,d,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,r,o,a)}function rW(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function sW(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}class Z0{constructor(e,t){this._service=e,t instanceof qr?this._location=t:this._location=qr.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Z0(e,t)}get root(){const e=new qr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return sW(this._location.path)}get storage(){return this._service}get parent(){const e=rW(this._location.path);if(e===null)return null;const t=new qr(this._location.bucket,e);return new Z0(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw W$(e)}}function ZP(n,e){const t=e?.[V$];return t==null?null:qr.makeFromBucketSpec(t,n)}function oW(n,e,t,i={}){n.host=`${e}:${t}`;const r=wu(e);r&&(Ex(`https://${n.host}/b`),wx("Storage",!0)),n._isUsingEmulator=!0,n._protocol=r?"https":"http";const{mockUserToken:s}=i;s&&(n._overrideAuthToken=typeof s=="string"?s:D4(s,n.app.options.projectId))}class aW{constructor(e,t,i,r,s,o=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=r,this._firebaseVersion=s,this._isUsingEmulator=o,this._bucket=null,this._host=bD,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=F$,this._maxUploadRetryTime=G$,this._requests=new Set,r!=null?this._bucket=qr.makeFromBucketSpec(r,this._host):this._bucket=ZP(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=qr.makeFromBucketSpec(this._url,e):this._bucket=ZP(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){YP("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){YP("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Wr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Z0(this,e)}_makeRequest(e,t,i,r,s=!0){if(this._deleted)return new K$(kD());{const o=iW(e,this._appId,i,r,t,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[i,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,r).getPromise()}}const QP="@firebase/storage",JP="0.14.0";const LD="storage";function lW(n=Ix(),e){n=ni(n);const i=F_(n,LD).getImmediate({identifier:e}),r=b4("storage");return r&&uW(i,...r),i}function uW(n,e,t,i={}){oW(n,e,t,i)}function cW(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),r=n.getProvider("app-check-internal");return new aW(t,i,r,e,xu)}function hW(){su(new La(LD,cW,"PUBLIC").setMultipleInstances(!0)),Ss(QP,JP,""),Ss(QP,JP,"esm2020")}hW();const dW={apiKey:"REPLACE_WITH_YOUR_API_KEY",authDomain:"your-project.firebaseapp.com",projectId:"your-project-id",storageBucket:"your-project.appspot.com",messagingSenderId:"123456789",appId:"1:123456789:web:abcdef"},IT=U4(dW);N$(IT);const Jd=fB(IT);lW(IT);gB(Jd).catch(n=>{n.code==="failed-precondition"?console.warn("Offline persistence failed: Multiple tabs open"):n.code==="unimplemented"&&console.warn("Offline persistence not available in this browser")});vu()(Eu((n,e)=>({vondsten:[],loading:!1,error:null,loadVondsten:async t=>{n(i=>{i.loading=!0});try{const i=RB(AP(Jd,"vondsten"),PB("userId","==",t)),s=(await LB(i)).docs.map(o=>({id:o.id,...o.data()}));n(o=>{o.vondsten=s,o.loading=!1})}catch(i){n(r=>{r.error=i.message,r.loading=!1})}},addVondst:async t=>{const i=new Date().toISOString(),r={...t,createdAt:i,updatedAt:i},s=await OB(AP(Jd,"vondsten"),r);return n(o=>{o.vondsten.push({...r,id:s.id})}),s.id},updateVondst:async(t,i)=>{const r=rw(Jd,"vondsten",t);await DB(r,{...i,updatedAt:new Date().toISOString()}),n(s=>{const o=s.vondsten.findIndex(a=>a.id===t);o!==-1&&(s.vondsten[o]={...s.vondsten[o],...i})})},deleteVondst:async t=>{await NB(rw(Jd,"vondsten",t)),n(i=>{i.vondsten=i.vondsten.filter(r=>r.id!==t)})}})));function fW({target:n,viewOptions:e}){const t=ne.useRef(null),i=Hi(r=>r.setMap);return ne.useEffect(()=>{if(!t.current){const r={center:[5.1214,52.0907],zoom:8,rotation:0,minZoom:3,maxZoom:19,...e},s=new jF({target:n,view:new ws({center:Jl(r.center),zoom:r.zoom,rotation:r.rotation,minZoom:r.minZoom,maxZoom:r.maxZoom})});t.current=s,i(s),window.__olMap=s}return()=>{t.current&&(t.current.setTarget(void 0),i(null),window.__olMap=null)}},[n,e,i]),t.current}const gW="https://router.project-osrm.org/route/v1/driving";function mW(n,e){const t={depart:"Start de route",arrive:"U bent aangekomen","turn-left":"Sla linksaf","turn-right":"Sla rechtsaf","turn-slight-left":"Houd links aan","turn-slight-right":"Houd rechts aan","turn-sharp-left":"Sla scherp linksaf","turn-sharp-right":"Sla scherp rechtsaf",uturn:"Keer om",straight:"Ga rechtdoor",merge:"Voeg in","on-ramp":"Neem de oprit","off-ramp":"Neem de afrit","fork-left":"Houd links aan bij de splitsing","fork-right":"Houd rechts aan bij de splitsing","end-of-road-left":"Sla linksaf aan het einde van de weg","end-of-road-right":"Sla rechtsaf aan het einde van de weg",roundabout:"Neem de rotonde",rotary:"Neem de rotonde",continue:"Blijf de weg volgen",notification:"Let op"},i=e?`${n}-${e}`:n;return t[i]||t[n]||"Volg de route"}function eC(n,e){const i=(e.lat-n.lat)*Math.PI/180,r=(e.lng-n.lng)*Math.PI/180,s=Math.sin(i/2)*Math.sin(i/2)+Math.cos(n.lat*Math.PI/180)*Math.cos(e.lat*Math.PI/180)*Math.sin(r/2)*Math.sin(r/2);return 6371e3*(2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s)))}const tn=vu()(Eu((n,e)=>({isNavigating:!1,destination:null,destinationName:null,routeCoordinates:null,distance:null,duration:null,loading:!1,error:null,steps:[],currentStepIndex:0,voiceEnabled:!0,lastSpokenStep:-1,lastSpokenTime:0,lastSpokenDistance:-1,startNavigation:async(t,i,r)=>{n(s=>{s.loading=!0,s.error=null});try{const s=`${gW}/${r.lng},${r.lat};${t.lng},${t.lat}?overview=full&geometries=geojson&steps=true`,o=await fetch(s);if(!o.ok)throw new Error("Route berekening mislukt");const a=await o.json();if(a.code==="Ok"&&a.routes&&a.routes.length>0){const u=a.routes[0],h=u.geometry.coordinates.map(g=>({lng:g[0],lat:g[1]})),d=[];if(u.legs&&u.legs[0]&&u.legs[0].steps)for(const g of u.legs[0].steps){const m=g.maneuver?.type||"continue",v=g.maneuver?.modifier;d.push({instruction:mW(m,v),maneuver:v?`${m}-${v}`:m,distance:g.distance||0,duration:g.duration||0,location:{lng:g.maneuver?.location?.[0]||r.lng,lat:g.maneuver?.location?.[1]||r.lat}})}if(n(g=>{g.isNavigating=!0,g.destination=t,g.destinationName=i,g.routeCoordinates=h,g.distance=u.distance,g.duration=u.duration,g.steps=d,g.currentStepIndex=0,g.lastSpokenStep=-1,g.loading=!1}),d.length>0){const g=d[0],m=g.distance>1e3?`${(g.distance/1e3).toFixed(1)} kilometer`:`${Math.round(g.distance)} meter`;e().speakInstruction(`${g.instruction}. Over ${m}.`)}console.log(` Navigation started to ${i}`),console.log(` Distance: ${(u.distance/1e3).toFixed(1)} km`),console.log(` Duration: ${Math.round(u.duration/60)} min`),console.log(` Steps: ${d.length}`)}else throw new Error(a.message||"Geen route gevonden")}catch(s){console.error("Navigation error:",s),n(o=>{o.loading=!1,o.error=s.message||"Navigatie fout"})}},stopNavigation:()=>{"speechSynthesis"in window&&window.speechSynthesis.cancel(),n(t=>{t.isNavigating=!1,t.destination=null,t.destinationName=null,t.routeCoordinates=null,t.distance=null,t.duration=null,t.error=null,t.steps=[],t.currentStepIndex=0,t.lastSpokenStep=-1,t.lastSpokenTime=0,t.lastSpokenDistance=-1}),console.log(" Navigation stopped")},clearError:()=>{n(t=>{t.error=null})},updateCurrentStep:t=>{const{steps:i,currentStepIndex:r,lastSpokenStep:s,lastSpokenTime:o,lastSpokenDistance:a,voiceEnabled:u}=e();if(i.length===0)return;const h=Date.now(),d=5e3;let g=r;for(let m=r;m<i.length;m++){const v=i[m].location;eC(t,v)<30&&(g=Math.min(m+1,i.length-1))}if(g!==r&&(n(m=>{m.currentStepIndex=g}),u&&g!==s&&g<i.length&&h-o>d)){const m=i[g],v=m.distance>1e3?`${(m.distance/1e3).toFixed(1)} kilometer`:`${Math.round(m.distance)} meter`;e().speakInstruction(`${m.instruction}. Over ${v}.`),n(y=>{y.lastSpokenStep=g,y.lastSpokenTime=h,y.lastSpokenDistance=-1})}if(u&&r<i.length){const m=i[r],v=eC(t,m.location);if(h-o<d)return;const y=[200,100,50];for(const I of y)if(v<=I&&v>I-30&&(a===-1||Math.abs(a-I)>30)&&m.maneuver!=="depart"&&m.maneuver!=="arrive"){e().speakInstruction(`Over ${I} meter, ${m.instruction.toLowerCase()}.`),n(w=>{w.lastSpokenTime=h,w.lastSpokenDistance=I});break}}},setVoiceEnabled:t=>{n(i=>{i.voiceEnabled=t}),!t&&"speechSynthesis"in window&&window.speechSynthesis.cancel()},speakInstruction:t=>{if(e().voiceEnabled&&"speechSynthesis"in window){window.speechSynthesis.cancel();const i=new SpeechSynthesisUtterance(t);i.lang="nl-NL",i.rate=1,i.pitch=1,i.volume=1;const s=window.speechSynthesis.getVoices().find(o=>o.lang.startsWith("nl"));s&&(i.voice=s),window.speechSynthesis.speak(i),console.log(` Speaking: ${t}`)}}})));function pW(){const n=ne.useRef(null);fW({target:"map"});const e=Hi(o=>o.map),t=oo(o=>o.registerLayer),i=tn(o=>o.isNavigating);ne.useEffect(()=>{if(!e){console.warn(" Map not initialized yet");return}console.log(" Initializing map layers...");const o=new Ic({properties:{title:"OpenStreetMap",type:"base"},visible:!1,source:new sF}),a=new Ic({properties:{title:"CartoDB (licht)",type:"base"},visible:!0,source:new Hd({url:"https://{a-d}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO"})}),u=new Ic({properties:{title:"Luchtfoto (PDOK)",type:"base"},visible:!1,source:new Hd({url:"https://service.pdok.nl/hwh/luchtfotorgb/wmts/v1_0/Actueel_orthoHR/EPSG:3857/{z}/{x}/{y}.jpeg",attributions:" Kadaster / PDOK"})}),h=new Ic({properties:{title:"TMK 1850",type:"base"},visible:!1,source:new Hd({url:"https://s.map5.nl/map/gast/tiles/tmk_1850/EPSG3857/{z}/{x}/{y}.png",attributions:" Kadaster / Map5.nl",crossOrigin:"anonymous",maxZoom:14})}),d=new Ic({properties:{title:"Bonnebladen 1900",type:"base"},visible:!1,source:new Hd({url:"https://s.map5.nl/map/gast/tiles/bonne_1900/EPSG3857/{z}/{x}/{y}.png",attributions:" Kadaster / Map5.nl",crossOrigin:"anonymous",maxZoom:14})});e.addLayer(o),e.addLayer(a),e.addLayer(u),e.addLayer(h),e.addLayer(d),console.log(" Base layers added:",{osm:o.getVisible(),cartodb:a.getVisible(),satellite:u.getVisible()}),t("OpenStreetMap",o),t("CartoDB (licht)",a),t("Luchtfoto (PDOK)",u),t("TMK 1850",h),t("Bonnebladen 1900",d),e.updateSize(),console.log(" Map size:",e.getSize()),console.log(" Map center:",e.getView().getCenter()),console.log(" Map zoom:",e.getView().getZoom()),r()},[e,t]);async function r(){if(!e){console.error(" Cannot load layers: map is null");return}const o=g9();console.log(` Loading ${o.length} immediate-load layers (WMS/Tile)...`);const a=await Promise.allSettled(o.map(async h=>{try{const d=await h.factory();return d?{name:h.name,layer:d}:null}catch(d){return console.warn(` Failed to create ${h.name}:`,d),null}}));let u=0;a.forEach(h=>{if(h.status==="fulfilled"&&h.value){const{name:d,layer:g}=h.value;e.addLayer(g),t(d,g),u++,console.log(`   ${d}`)}}),console.log(` Immediate layers loaded: ${u}/${o.length}`),console.log(` Total layers on map: ${e.getLayers().getLength()}`),console.log(" Vector layers will load on first toggle (lazy loading enabled)")}const s={width:"100%",height:"100vh",transition:"transform 0.5s ease-out",transformOrigin:"center bottom",...i?{transform:"perspective(1000px) rotateX(25deg) scale(1.1)"}:{}};return V.jsx("div",{id:"map",ref:n,style:s})}const ST=ne.createContext({});function AT(n){const e=ne.useRef(null);return e.current===null&&(e.current=n()),e.current}const uy=ne.createContext(null),RT=ne.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});class _W extends ne.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const i=this.props.sizeRef.current;i.height=t.offsetHeight||0,i.width=t.offsetWidth||0,i.top=t.offsetTop,i.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function yW({children:n,isPresent:e}){const t=ne.useId(),i=ne.useRef(null),r=ne.useRef({width:0,height:0,top:0,left:0}),{nonce:s}=ne.useContext(RT);return ne.useInsertionEffect(()=>{const{width:o,height:a,top:u,left:h}=r.current;if(e||!i.current||!o||!a)return;i.current.dataset.motionPopId=t;const d=document.createElement("style");return s&&(d.nonce=s),document.head.appendChild(d),d.sheet&&d.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${a}px !important;
            top: ${u}px !important;
            left: ${h}px !important;
          }
        `),()=>{document.head.removeChild(d)}},[e]),V.jsx(_W,{isPresent:e,childRef:i,sizeRef:r,children:ne.cloneElement(n,{ref:i})})}const vW=({children:n,initial:e,isPresent:t,onExitComplete:i,custom:r,presenceAffectsLayout:s,mode:o})=>{const a=AT(EW),u=ne.useId(),h=ne.useCallback(g=>{a.set(g,!0);for(const m of a.values())if(!m)return;i&&i()},[a,i]),d=ne.useMemo(()=>({id:u,initial:e,isPresent:t,custom:r,onExitComplete:h,register:g=>(a.set(g,!1),()=>a.delete(g))}),s?[Math.random(),h]:[t,h]);return ne.useMemo(()=>{a.forEach((g,m)=>a.set(m,!1))},[t]),ne.useEffect(()=>{!t&&!a.size&&i&&i()},[t]),o==="popLayout"&&(n=V.jsx(yW,{isPresent:t,children:n})),V.jsx(uy.Provider,{value:d,children:n})};function EW(){return new Map}function DD(n=!0){const e=ne.useContext(uy);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:i,register:r}=e,s=ne.useId();ne.useEffect(()=>{n&&r(s)},[n]);const o=ne.useCallback(()=>n&&i&&i(s),[s,i,n]);return!t&&i?[!1,o]:[!0]}const Ap=n=>n.key||"";function tC(n){const e=[];return ne.Children.forEach(n,t=>{ne.isValidElement(t)&&e.push(t)}),e}const PT=typeof window<"u",ND=PT?ne.useLayoutEffect:ne.useEffect,Ka=({children:n,custom:e,initial:t=!0,onExitComplete:i,presenceAffectsLayout:r=!0,mode:s="sync",propagate:o=!1})=>{const[a,u]=DD(o),h=ne.useMemo(()=>tC(n),[n]),d=o&&!a?[]:h.map(Ap),g=ne.useRef(!0),m=ne.useRef(h),v=AT(()=>new Map),[y,I]=ne.useState(h),[w,R]=ne.useState(h);ND(()=>{g.current=!1,m.current=h;for(let L=0;L<w.length;L++){const D=Ap(w[L]);d.includes(D)?v.delete(D):v.get(D)!==!0&&v.set(D,!1)}},[w,d.length,d.join("-")]);const P=[];if(h!==y){let L=[...h];for(let D=0;D<w.length;D++){const B=w[D],M=Ap(B);d.includes(M)||(L.splice(D,0,B),P.push(B))}s==="wait"&&P.length&&(L=P),R(tC(L)),I(h);return}const{forceRender:b}=ne.useContext(ST);return V.jsx(V.Fragment,{children:w.map(L=>{const D=Ap(L),B=o&&!a?!1:h===w||d.includes(D),M=()=>{if(v.has(D))v.set(D,!0);else return;let A=!0;v.forEach(k=>{k||(A=!1)}),A&&(b?.(),R(m.current),o&&u?.(),i&&i())};return V.jsx(vW,{isPresent:B,initial:!g.current||t?void 0:!1,custom:B?void 0:e,presenceAffectsLayout:r,mode:s,onExitComplete:B?void 0:M,children:L},D)})})},Xi=n=>n;let OD=Xi;function CT(n){let e;return()=>(e===void 0&&(e=n()),e)}const Sh=(n,e,t)=>{const i=e-n;return i===0?1:(t-n)/i},mo=n=>n*1e3,po=n=>n/1e3,wW={useManualTiming:!1};function xW(n){let e=new Set,t=new Set,i=!1,r=!1;const s=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function a(h){s.has(h)&&(u.schedule(h),n()),h(o)}const u={schedule:(h,d=!1,g=!1)=>{const v=g&&i?e:t;return d&&s.add(h),v.has(h)||v.add(h),h},cancel:h=>{t.delete(h),s.delete(h)},process:h=>{if(o=h,i){r=!0;return}i=!0,[e,t]=[t,e],e.forEach(a),e.clear(),i=!1,r&&(r=!1,u.process(h))}};return u}const Rp=["read","resolveKeyframes","update","preRender","render","postRender"],TW=40;function VD(n,e){let t=!1,i=!0;const r={delta:0,timestamp:0,isProcessing:!1},s=()=>t=!0,o=Rp.reduce((R,P)=>(R[P]=xW(s),R),{}),{read:a,resolveKeyframes:u,update:h,preRender:d,render:g,postRender:m}=o,v=()=>{const R=performance.now();t=!1,r.delta=i?1e3/60:Math.max(Math.min(R-r.timestamp,TW),1),r.timestamp=R,r.isProcessing=!0,a.process(r),u.process(r),h.process(r),d.process(r),g.process(r),m.process(r),r.isProcessing=!1,t&&e&&(i=!1,n(v))},y=()=>{t=!0,i=!0,r.isProcessing||n(v)};return{schedule:Rp.reduce((R,P)=>{const b=o[P];return R[P]=(L,D=!1,B=!1)=>(t||y(),b.schedule(L,D,B)),R},{}),cancel:R=>{for(let P=0;P<Rp.length;P++)o[Rp[P]].cancel(R)},state:r,steps:o}}const{schedule:Lt,cancel:Ga,state:On,steps:N1}=VD(typeof requestAnimationFrame<"u"?requestAnimationFrame:Xi,!0),FD=ne.createContext({strict:!1}),nC={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Ah={};for(const n in nC)Ah[n]={isEnabled:e=>nC[n].some(t=>!!e[t])};function IW(n){for(const e in n)Ah[e]={...Ah[e],...n[e]}}const SW=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Q0(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||SW.has(n)}let GD=n=>!Q0(n);function AW(n){n&&(GD=e=>e.startsWith("on")?!Q0(e):n(e))}try{AW(require("@emotion/is-prop-valid").default)}catch{}function RW(n,e,t){const i={};for(const r in n)r==="values"&&typeof n.values=="object"||(GD(r)||t===!0&&Q0(r)||!e&&!Q0(r)||n.draggable&&r.startsWith("onDrag"))&&(i[r]=n[r]);return i}function PW(n){if(typeof Proxy>"u")return n;const e=new Map,t=(...i)=>n(...i);return new Proxy(t,{get:(i,r)=>r==="create"?n:(e.has(r)||e.set(r,n(r)),e.get(r))})}const cy=ne.createContext({});function rg(n){return typeof n=="string"||Array.isArray(n)}function hy(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}const MT=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],bT=["initial",...MT];function dy(n){return hy(n.animate)||bT.some(e=>rg(n[e]))}function jD(n){return!!(dy(n)||n.variants)}function CW(n,e){if(dy(n)){const{initial:t,animate:i}=n;return{initial:t===!1||rg(t)?t:void 0,animate:rg(i)?i:void 0}}return n.inherit!==!1?e:{}}function MW(n){const{initial:e,animate:t}=CW(n,ne.useContext(cy));return ne.useMemo(()=>({initial:e,animate:t}),[iC(e),iC(t)])}function iC(n){return Array.isArray(n)?n.join(" "):n}const bW=Symbol.for("motionComponentSymbol");function Nc(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function kW(n,e,t){return ne.useCallback(i=>{i&&n.onMount&&n.onMount(i),e&&(i?e.mount(i):e.unmount()),t&&(typeof t=="function"?t(i):Nc(t)&&(t.current=i))},[e])}const kT=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),LW="framerAppearId",UD="data-"+kT(LW),{schedule:LT}=VD(queueMicrotask,!1),BD=ne.createContext({});function DW(n,e,t,i,r){var s,o;const{visualElement:a}=ne.useContext(cy),u=ne.useContext(FD),h=ne.useContext(uy),d=ne.useContext(RT).reducedMotion,g=ne.useRef(null);i=i||u.renderer,!g.current&&i&&(g.current=i(n,{visualState:e,parent:a,props:t,presenceContext:h,blockInitialAnimation:h?h.initial===!1:!1,reducedMotionConfig:d}));const m=g.current,v=ne.useContext(BD);m&&!m.projection&&r&&(m.type==="html"||m.type==="svg")&&NW(g.current,t,r,v);const y=ne.useRef(!1);ne.useInsertionEffect(()=>{m&&y.current&&m.update(t,h)});const I=t[UD],w=ne.useRef(!!I&&!(!((s=window.MotionHandoffIsComplete)===null||s===void 0)&&s.call(window,I))&&((o=window.MotionHasOptimisedAnimation)===null||o===void 0?void 0:o.call(window,I)));return ND(()=>{m&&(y.current=!0,window.MotionIsMounted=!0,m.updateFeatures(),LT.render(m.render),w.current&&m.animationState&&m.animationState.animateChanges())}),ne.useEffect(()=>{m&&(!w.current&&m.animationState&&m.animationState.animateChanges(),w.current&&(queueMicrotask(()=>{var R;(R=window.MotionHandoffMarkAsComplete)===null||R===void 0||R.call(window,I)}),w.current=!1))}),m}function NW(n,e,t,i){const{layoutId:r,layout:s,drag:o,dragConstraints:a,layoutScroll:u,layoutRoot:h}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:zD(n.parent)),n.projection.setOptions({layoutId:r,layout:s,alwaysMeasureLayout:!!o||a&&Nc(a),visualElement:n,animationType:typeof s=="string"?s:"both",initialPromotionConfig:i,layoutScroll:u,layoutRoot:h})}function zD(n){if(n)return n.options.allowProjection!==!1?n.projection:zD(n.parent)}function OW({preloadedFeatures:n,createVisualElement:e,useRender:t,useVisualState:i,Component:r}){var s,o;n&&IW(n);function a(h,d){let g;const m={...ne.useContext(RT),...h,layoutId:VW(h)},{isStatic:v}=m,y=MW(h),I=i(h,v);if(!v&&PT){FW();const w=GW(m);g=w.MeasureLayout,y.visualElement=DW(r,I,m,e,w.ProjectionNode)}return V.jsxs(cy.Provider,{value:y,children:[g&&y.visualElement?V.jsx(g,{visualElement:y.visualElement,...m}):null,t(r,h,kW(I,y.visualElement,d),I,v,y.visualElement)]})}a.displayName=`motion.${typeof r=="string"?r:`create(${(o=(s=r.displayName)!==null&&s!==void 0?s:r.name)!==null&&o!==void 0?o:""})`}`;const u=ne.forwardRef(a);return u[bW]=r,u}function VW({layoutId:n}){const e=ne.useContext(ST).id;return e&&n!==void 0?e+"-"+n:n}function FW(n,e){ne.useContext(FD).strict}function GW(n){const{drag:e,layout:t}=Ah;if(!e&&!t)return{};const i={...e,...t};return{MeasureLayout:e?.isEnabled(n)||t?.isEnabled(n)?i.MeasureLayout:void 0,ProjectionNode:i.ProjectionNode}}const jW=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function DT(n){return typeof n!="string"||n.includes("-")?!1:!!(jW.indexOf(n)>-1||/[A-Z]/u.test(n))}function rC(n){const e=[{},{}];return n?.values.forEach((t,i)=>{e[0][i]=t.get(),e[1][i]=t.getVelocity()}),e}function NT(n,e,t,i){if(typeof e=="function"){const[r,s]=rC(i);e=e(t!==void 0?t:n.custom,r,s)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[r,s]=rC(i);e=e(t!==void 0?t:n.custom,r,s)}return e}const uw=n=>Array.isArray(n),UW=n=>!!(n&&typeof n=="object"&&n.mix&&n.toValue),BW=n=>uw(n)?n[n.length-1]||0:n,ei=n=>!!(n&&n.getVelocity);function Zp(n){const e=ei(n)?n.get():n;return UW(e)?e.toValue():e}function zW({scrapeMotionValuesFromProps:n,createRenderState:e,onUpdate:t},i,r,s){const o={latestValues:$W(i,r,s,n),renderState:e()};return t&&(o.onMount=a=>t({props:i,current:a,...o}),o.onUpdate=a=>t(a)),o}const $D=n=>(e,t)=>{const i=ne.useContext(cy),r=ne.useContext(uy),s=()=>zW(n,e,i,r);return t?s():AT(s)};function $W(n,e,t,i){const r={},s=i(n,{});for(const m in s)r[m]=Zp(s[m]);let{initial:o,animate:a}=n;const u=dy(n),h=jD(n);e&&h&&!u&&n.inherit!==!1&&(o===void 0&&(o=e.initial),a===void 0&&(a=e.animate));let d=t?t.initial===!1:!1;d=d||o===!1;const g=d?a:o;if(g&&typeof g!="boolean"&&!hy(g)){const m=Array.isArray(g)?g:[g];for(let v=0;v<m.length;v++){const y=NT(n,m[v]);if(y){const{transitionEnd:I,transition:w,...R}=y;for(const P in R){let b=R[P];if(Array.isArray(b)){const L=d?b.length-1:0;b=b[L]}b!==null&&(r[P]=b)}for(const P in I)r[P]=I[P]}}}return r}const Vh=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Su=new Set(Vh),WD=n=>e=>typeof e=="string"&&e.startsWith(n),KD=WD("--"),WW=WD("var(--"),OT=n=>WW(n)?KW.test(n.split("/*")[0].trim()):!1,KW=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,qD=(n,e)=>e&&typeof n=="number"?e.transform(n):n,To=(n,e,t)=>t>e?e:t<n?n:t,Fh={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},sg={...Fh,transform:n=>To(0,1,n)},Pp={...Fh,default:1},jg=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),ca=jg("deg"),Ms=jg("%"),Ve=jg("px"),qW=jg("vh"),HW=jg("vw"),sC={...Ms,parse:n=>Ms.parse(n)/100,transform:n=>Ms.transform(n*100)},XW={borderWidth:Ve,borderTopWidth:Ve,borderRightWidth:Ve,borderBottomWidth:Ve,borderLeftWidth:Ve,borderRadius:Ve,radius:Ve,borderTopLeftRadius:Ve,borderTopRightRadius:Ve,borderBottomRightRadius:Ve,borderBottomLeftRadius:Ve,width:Ve,maxWidth:Ve,height:Ve,maxHeight:Ve,top:Ve,right:Ve,bottom:Ve,left:Ve,padding:Ve,paddingTop:Ve,paddingRight:Ve,paddingBottom:Ve,paddingLeft:Ve,margin:Ve,marginTop:Ve,marginRight:Ve,marginBottom:Ve,marginLeft:Ve,backgroundPositionX:Ve,backgroundPositionY:Ve},YW={rotate:ca,rotateX:ca,rotateY:ca,rotateZ:ca,scale:Pp,scaleX:Pp,scaleY:Pp,scaleZ:Pp,skew:ca,skewX:ca,skewY:ca,distance:Ve,translateX:Ve,translateY:Ve,translateZ:Ve,x:Ve,y:Ve,z:Ve,perspective:Ve,transformPerspective:Ve,opacity:sg,originX:sC,originY:sC,originZ:Ve},oC={...Fh,transform:Math.round},VT={...XW,...YW,zIndex:oC,size:Ve,fillOpacity:sg,strokeOpacity:sg,numOctaves:oC},ZW={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},QW=Vh.length;function JW(n,e,t){let i="",r=!0;for(let s=0;s<QW;s++){const o=Vh[s],a=n[o];if(a===void 0)continue;let u=!0;if(typeof a=="number"?u=a===(o.startsWith("scale")?1:0):u=parseFloat(a)===0,!u||t){const h=qD(a,VT[o]);if(!u){r=!1;const d=ZW[o]||o;i+=`${d}(${h}) `}t&&(e[o]=h)}}return i=i.trim(),t?i=t(e,r?"":i):r&&(i="none"),i}function FT(n,e,t){const{style:i,vars:r,transformOrigin:s}=n;let o=!1,a=!1;for(const u in e){const h=e[u];if(Su.has(u)){o=!0;continue}else if(KD(u)){r[u]=h;continue}else{const d=qD(h,VT[u]);u.startsWith("origin")?(a=!0,s[u]=d):i[u]=d}}if(e.transform||(o||t?i.transform=JW(e,n.transform,t):i.transform&&(i.transform="none")),a){const{originX:u="50%",originY:h="50%",originZ:d=0}=s;i.transformOrigin=`${u} ${h} ${d}`}}const eK={offset:"stroke-dashoffset",array:"stroke-dasharray"},tK={offset:"strokeDashoffset",array:"strokeDasharray"};function nK(n,e,t=1,i=0,r=!0){n.pathLength=1;const s=r?eK:tK;n[s.offset]=Ve.transform(-i);const o=Ve.transform(e),a=Ve.transform(t);n[s.array]=`${o} ${a}`}function aC(n,e,t){return typeof n=="string"?n:Ve.transform(e+t*n)}function iK(n,e,t){const i=aC(e,n.x,n.width),r=aC(t,n.y,n.height);return`${i} ${r}`}function GT(n,{attrX:e,attrY:t,attrScale:i,originX:r,originY:s,pathLength:o,pathSpacing:a=1,pathOffset:u=0,...h},d,g){if(FT(n,h,g),d){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:m,style:v,dimensions:y}=n;m.transform&&(y&&(v.transform=m.transform),delete m.transform),y&&(r!==void 0||s!==void 0||v.transform)&&(v.transformOrigin=iK(y,r!==void 0?r:.5,s!==void 0?s:.5)),e!==void 0&&(m.x=e),t!==void 0&&(m.y=t),i!==void 0&&(m.scale=i),o!==void 0&&nK(m,o,a,u,!1)}const jT=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),HD=()=>({...jT(),attrs:{}}),UT=n=>typeof n=="string"&&n.toLowerCase()==="svg";function XD(n,{style:e,vars:t},i,r){Object.assign(n.style,e,r&&r.getProjectionStyles(i));for(const s in t)n.style.setProperty(s,t[s])}const YD=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function ZD(n,e,t,i){XD(n,e,void 0,i);for(const r in e.attrs)n.setAttribute(YD.has(r)?r:kT(r),e.attrs[r])}const J0={};function rK(n){Object.assign(J0,n)}function QD(n,{layout:e,layoutId:t}){return Su.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!J0[n]||n==="opacity")}function BT(n,e,t){var i;const{style:r}=n,s={};for(const o in r)(ei(r[o])||e.style&&ei(e.style[o])||QD(o,n)||((i=t?.getValue(o))===null||i===void 0?void 0:i.liveStyle)!==void 0)&&(s[o]=r[o]);return s}function JD(n,e,t){const i=BT(n,e,t);for(const r in n)if(ei(n[r])||ei(e[r])){const s=Vh.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;i[s]=n[r]}return i}function sK(n,e){try{e.dimensions=typeof n.getBBox=="function"?n.getBBox():n.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const lC=["x","y","width","height","cx","cy","r"],oK={useVisualState:$D({scrapeMotionValuesFromProps:JD,createRenderState:HD,onUpdate:({props:n,prevProps:e,current:t,renderState:i,latestValues:r})=>{if(!t)return;let s=!!n.drag;if(!s){for(const a in r)if(Su.has(a)){s=!0;break}}if(!s)return;let o=!e;if(e)for(let a=0;a<lC.length;a++){const u=lC[a];n[u]!==e[u]&&(o=!0)}o&&Lt.read(()=>{sK(t,i),Lt.render(()=>{GT(i,r,UT(t.tagName),n.transformTemplate),ZD(t,i)})})}})},aK={useVisualState:$D({scrapeMotionValuesFromProps:BT,createRenderState:jT})};function eN(n,e,t){for(const i in e)!ei(e[i])&&!QD(i,t)&&(n[i]=e[i])}function lK({transformTemplate:n},e){return ne.useMemo(()=>{const t=jT();return FT(t,e,n),Object.assign({},t.vars,t.style)},[e])}function uK(n,e){const t=n.style||{},i={};return eN(i,t,n),Object.assign(i,lK(n,e)),i}function cK(n,e){const t={},i=uK(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=i,t}function hK(n,e,t,i){const r=ne.useMemo(()=>{const s=HD();return GT(s,e,UT(i),n.transformTemplate),{...s.attrs,style:{...s.style}}},[e]);if(n.style){const s={};eN(s,n.style,n),r.style={...s,...r.style}}return r}function dK(n=!1){return(t,i,r,{latestValues:s},o)=>{const u=(DT(t)?hK:cK)(i,s,o,t),h=RW(i,typeof t=="string",n),d=t!==ne.Fragment?{...h,...u,ref:r}:{},{children:g}=i,m=ne.useMemo(()=>ei(g)?g.get():g,[g]);return ne.createElement(t,{...d,children:m})}}function fK(n,e){return function(i,{forwardMotionProps:r}={forwardMotionProps:!1}){const o={...DT(i)?oK:aK,preloadedFeatures:n,useRender:dK(r),createVisualElement:e,Component:i};return OW(o)}}function tN(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let i=0;i<t;i++)if(e[i]!==n[i])return!1;return!0}function fy(n,e,t){const i=n.getProps();return NT(i,e,t!==void 0?t:i.custom,n)}const gK=CT(()=>window.ScrollTimeline!==void 0);class mK{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,t){for(let i=0;i<this.animations.length;i++)this.animations[i][e]=t}attachTimeline(e,t){const i=this.animations.map(r=>{if(gK()&&r.attachTimeline)return r.attachTimeline(e);if(typeof t=="function")return t(r)});return()=>{i.forEach((r,s)=>{r&&r(),this.animations[s].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let t=0;t<this.animations.length;t++)e=Math.max(e,this.animations[t].duration);return e}runAll(e){this.animations.forEach(t=>t[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class pK extends mK{then(e,t){return Promise.all(this.animations).then(e).catch(t)}}function zT(n,e){return n?n[e]||n.default||n:void 0}const cw=2e4;function nN(n){let e=0;const t=50;let i=n.next(e);for(;!i.done&&e<cw;)e+=t,i=n.next(e);return e>=cw?1/0:e}function $T(n){return typeof n=="function"}function uC(n,e){n.timeline=e,n.onfinish=null}const WT=n=>Array.isArray(n)&&typeof n[0]=="number",_K={linearEasing:void 0};function yK(n,e){const t=CT(n);return()=>{var i;return(i=_K[e])!==null&&i!==void 0?i:t()}}const e_=yK(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),iN=(n,e,t=10)=>{let i="";const r=Math.max(Math.round(e/t),2);for(let s=0;s<r;s++)i+=n(Sh(0,r-1,s))+", ";return`linear(${i.substring(0,i.length-2)})`};function rN(n){return!!(typeof n=="function"&&e_()||!n||typeof n=="string"&&(n in hw||e_())||WT(n)||Array.isArray(n)&&n.every(rN))}const ef=([n,e,t,i])=>`cubic-bezier(${n}, ${e}, ${t}, ${i})`,hw={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:ef([0,.65,.55,1]),circOut:ef([.55,0,1,.45]),backIn:ef([.31,.01,.66,-.59]),backOut:ef([.33,1.53,.69,.99])};function sN(n,e){if(n)return typeof n=="function"&&e_()?iN(n,e):WT(n)?ef(n):Array.isArray(n)?n.map(t=>sN(t,e)||hw.easeOut):hw[n]}const Gr={x:!1,y:!1};function oN(){return Gr.x||Gr.y}function vK(n,e,t){var i;if(n instanceof Element)return[n];if(typeof n=="string"){let r=document;const s=(i=void 0)!==null&&i!==void 0?i:r.querySelectorAll(n);return s?Array.from(s):[]}return Array.from(n)}function aN(n,e){const t=vK(n),i=new AbortController,r={passive:!0,...e,signal:i.signal};return[t,r,()=>i.abort()]}function cC(n){return e=>{e.pointerType==="touch"||oN()||n(e)}}function EK(n,e,t={}){const[i,r,s]=aN(n,t),o=cC(a=>{const{target:u}=a,h=e(a);if(typeof h!="function"||!u)return;const d=cC(g=>{h(g),u.removeEventListener("pointerleave",d)});u.addEventListener("pointerleave",d,r)});return i.forEach(a=>{a.addEventListener("pointerenter",o,r)}),s}const lN=(n,e)=>e?n===e?!0:lN(n,e.parentElement):!1,KT=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,wK=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function xK(n){return wK.has(n.tagName)||n.tabIndex!==-1}const tf=new WeakSet;function hC(n){return e=>{e.key==="Enter"&&n(e)}}function O1(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const TK=(n,e)=>{const t=n.currentTarget;if(!t)return;const i=hC(()=>{if(tf.has(t))return;O1(t,"down");const r=hC(()=>{O1(t,"up")}),s=()=>O1(t,"cancel");t.addEventListener("keyup",r,e),t.addEventListener("blur",s,e)});t.addEventListener("keydown",i,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",i),e)};function dC(n){return KT(n)&&!oN()}function IK(n,e,t={}){const[i,r,s]=aN(n,t),o=a=>{const u=a.currentTarget;if(!dC(a)||tf.has(u))return;tf.add(u);const h=e(a),d=(v,y)=>{window.removeEventListener("pointerup",g),window.removeEventListener("pointercancel",m),!(!dC(v)||!tf.has(u))&&(tf.delete(u),typeof h=="function"&&h(v,{success:y}))},g=v=>{d(v,t.useGlobalTarget||lN(u,v.target))},m=v=>{d(v,!1)};window.addEventListener("pointerup",g,r),window.addEventListener("pointercancel",m,r)};return i.forEach(a=>{!xK(a)&&a.getAttribute("tabindex")===null&&(a.tabIndex=0),(t.useGlobalTarget?window:a).addEventListener("pointerdown",o,r),a.addEventListener("focus",h=>TK(h,r),r)}),s}function SK(n){return n==="x"||n==="y"?Gr[n]?null:(Gr[n]=!0,()=>{Gr[n]=!1}):Gr.x||Gr.y?null:(Gr.x=Gr.y=!0,()=>{Gr.x=Gr.y=!1})}const uN=new Set(["width","height","top","left","right","bottom",...Vh]);let Qp;function AK(){Qp=void 0}const bs={now:()=>(Qp===void 0&&bs.set(On.isProcessing||wW.useManualTiming?On.timestamp:performance.now()),Qp),set:n=>{Qp=n,queueMicrotask(AK)}};function qT(n,e){n.indexOf(e)===-1&&n.push(e)}function HT(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}class XT{constructor(){this.subscriptions=[]}add(e){return qT(this.subscriptions,e),()=>HT(this.subscriptions,e)}notify(e,t,i){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](e,t,i);else for(let s=0;s<r;s++){const o=this.subscriptions[s];o&&o(e,t,i)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function cN(n,e){return e?n*(1e3/e):0}const fC=30,RK=n=>!isNaN(parseFloat(n));class PK{constructor(e,t={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(i,r=!0)=>{const s=bs.now();this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(i),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),r&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=bs.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=RK(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new XT);const i=this.events[e].add(t);return e==="change"?()=>{i(),Lt.read(()=>{this.events.change.getSize()||this.stop()})}:i}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e,t=!0){!t||!this.passiveEffect?this.updateAndNotify(e,t):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,t,i){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-i}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=bs.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>fC)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,fC);return cN(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function og(n,e){return new PK(n,e)}function CK(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,og(t))}function MK(n,e){const t=fy(n,e);let{transitionEnd:i={},transition:r={},...s}=t||{};s={...s,...i};for(const o in s){const a=BW(s[o]);CK(n,o,a)}}function bK(n){return!!(ei(n)&&n.add)}function dw(n,e){const t=n.getValue("willChange");if(bK(t))return t.add(e)}function hN(n){return n.props[UD]}const dN=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,kK=1e-7,LK=12;function DK(n,e,t,i,r){let s,o,a=0;do o=e+(t-e)/2,s=dN(o,i,r)-n,s>0?t=o:e=o;while(Math.abs(s)>kK&&++a<LK);return o}function Ug(n,e,t,i){if(n===e&&t===i)return Xi;const r=s=>DK(s,0,1,n,t);return s=>s===0||s===1?s:dN(r(s),e,i)}const fN=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,gN=n=>e=>1-n(1-e),mN=Ug(.33,1.53,.69,.99),YT=gN(mN),pN=fN(YT),_N=n=>(n*=2)<1?.5*YT(n):.5*(2-Math.pow(2,-10*(n-1))),ZT=n=>1-Math.sin(Math.acos(n)),yN=gN(ZT),vN=fN(ZT),EN=n=>/^0[^.\s]+$/u.test(n);function NK(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||EN(n):!0}const vf=n=>Math.round(n*1e5)/1e5,QT=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function OK(n){return n==null}const VK=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,JT=(n,e)=>t=>!!(typeof t=="string"&&VK.test(t)&&t.startsWith(n)||e&&!OK(t)&&Object.prototype.hasOwnProperty.call(t,e)),wN=(n,e,t)=>i=>{if(typeof i!="string")return i;const[r,s,o,a]=i.match(QT);return{[n]:parseFloat(r),[e]:parseFloat(s),[t]:parseFloat(o),alpha:a!==void 0?parseFloat(a):1}},FK=n=>To(0,255,n),V1={...Fh,transform:n=>Math.round(FK(n))},zl={test:JT("rgb","red"),parse:wN("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:i=1})=>"rgba("+V1.transform(n)+", "+V1.transform(e)+", "+V1.transform(t)+", "+vf(sg.transform(i))+")"};function GK(n){let e="",t="",i="",r="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),i=n.substring(5,7),r=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),i=n.substring(3,4),r=n.substring(4,5),e+=e,t+=t,i+=i,r+=r),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(i,16),alpha:r?parseInt(r,16)/255:1}}const fw={test:JT("#"),parse:GK,transform:zl.transform},Oc={test:JT("hsl","hue"),parse:wN("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:i=1})=>"hsla("+Math.round(n)+", "+Ms.transform(vf(e))+", "+Ms.transform(vf(t))+", "+vf(sg.transform(i))+")"},Hn={test:n=>zl.test(n)||fw.test(n)||Oc.test(n),parse:n=>zl.test(n)?zl.parse(n):Oc.test(n)?Oc.parse(n):fw.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?zl.transform(n):Oc.transform(n)},jK=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function UK(n){var e,t;return isNaN(n)&&typeof n=="string"&&(((e=n.match(QT))===null||e===void 0?void 0:e.length)||0)+(((t=n.match(jK))===null||t===void 0?void 0:t.length)||0)>0}const xN="number",TN="color",BK="var",zK="var(",gC="${}",$K=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function ag(n){const e=n.toString(),t=[],i={color:[],number:[],var:[]},r=[];let s=0;const a=e.replace($K,u=>(Hn.test(u)?(i.color.push(s),r.push(TN),t.push(Hn.parse(u))):u.startsWith(zK)?(i.var.push(s),r.push(BK),t.push(u)):(i.number.push(s),r.push(xN),t.push(parseFloat(u))),++s,gC)).split(gC);return{values:t,split:a,indexes:i,types:r}}function IN(n){return ag(n).values}function SN(n){const{split:e,types:t}=ag(n),i=e.length;return r=>{let s="";for(let o=0;o<i;o++)if(s+=e[o],r[o]!==void 0){const a=t[o];a===xN?s+=vf(r[o]):a===TN?s+=Hn.transform(r[o]):s+=r[o]}return s}}const WK=n=>typeof n=="number"?0:n;function KK(n){const e=IN(n);return SN(n)(e.map(WK))}const ja={test:UK,parse:IN,createTransformer:SN,getAnimatableNone:KK},qK=new Set(["brightness","contrast","saturate","opacity"]);function HK(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[i]=t.match(QT)||[];if(!i)return n;const r=t.replace(i,"");let s=qK.has(e)?1:0;return i!==t&&(s*=100),e+"("+s+r+")"}const XK=/\b([a-z-]*)\(.*?\)/gu,gw={...ja,getAnimatableNone:n=>{const e=n.match(XK);return e?e.map(HK).join(" "):n}},YK={...VT,color:Hn,backgroundColor:Hn,outlineColor:Hn,fill:Hn,stroke:Hn,borderColor:Hn,borderTopColor:Hn,borderRightColor:Hn,borderBottomColor:Hn,borderLeftColor:Hn,filter:gw,WebkitFilter:gw},eI=n=>YK[n];function AN(n,e){let t=eI(n);return t!==gw&&(t=ja),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const ZK=new Set(["auto","none","0"]);function QK(n,e,t){let i=0,r;for(;i<n.length&&!r;){const s=n[i];typeof s=="string"&&!ZK.has(s)&&ag(s).values.length&&(r=n[i]),i++}if(r&&t)for(const s of e)n[s]=AN(t,r)}const mC=n=>n===Fh||n===Ve,pC=(n,e)=>parseFloat(n.split(", ")[e]),_C=(n,e)=>(t,{transform:i})=>{if(i==="none"||!i)return 0;const r=i.match(/^matrix3d\((.+)\)$/u);if(r)return pC(r[1],e);{const s=i.match(/^matrix\((.+)\)$/u);return s?pC(s[1],n):0}},JK=new Set(["x","y","z"]),eq=Vh.filter(n=>!JK.has(n));function tq(n){const e=[];return eq.forEach(t=>{const i=n.getValue(t);i!==void 0&&(e.push([t,i.get()]),i.set(t.startsWith("scale")?1:0))}),e}const Rh={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:_C(4,13),y:_C(5,14)};Rh.translateX=Rh.x;Rh.translateY=Rh.y;const Yl=new Set;let mw=!1,pw=!1;function RN(){if(pw){const n=Array.from(Yl).filter(i=>i.needsMeasurement),e=new Set(n.map(i=>i.element)),t=new Map;e.forEach(i=>{const r=tq(i);r.length&&(t.set(i,r),i.render())}),n.forEach(i=>i.measureInitialState()),e.forEach(i=>{i.render();const r=t.get(i);r&&r.forEach(([s,o])=>{var a;(a=i.getValue(s))===null||a===void 0||a.set(o)})}),n.forEach(i=>i.measureEndState()),n.forEach(i=>{i.suspendedScrollY!==void 0&&window.scrollTo(0,i.suspendedScrollY)})}pw=!1,mw=!1,Yl.forEach(n=>n.complete()),Yl.clear()}function PN(){Yl.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(pw=!0)})}function nq(){PN(),RN()}class tI{constructor(e,t,i,r,s,o=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=i,this.motionValue=r,this.element=s,this.isAsync=o}scheduleResolve(){this.isScheduled=!0,this.isAsync?(Yl.add(this),mw||(mw=!0,Lt.read(PN),Lt.resolveKeyframes(RN))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:i,motionValue:r}=this;for(let s=0;s<e.length;s++)if(e[s]===null)if(s===0){const o=r?.get(),a=e[e.length-1];if(o!==void 0)e[0]=o;else if(i&&t){const u=i.readValue(t,a);u!=null&&(e[0]=u)}e[0]===void 0&&(e[0]=a),r&&o===void 0&&r.set(e[0])}else e[s]=e[s-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),Yl.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,Yl.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const CN=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n),iq=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function rq(n){const e=iq.exec(n);if(!e)return[,];const[,t,i,r]=e;return[`--${t??i}`,r]}function MN(n,e,t=1){const[i,r]=rq(n);if(!i)return;const s=window.getComputedStyle(e).getPropertyValue(i);if(s){const o=s.trim();return CN(o)?parseFloat(o):o}return OT(r)?MN(r,e,t+1):r}const bN=n=>e=>e.test(n),sq={test:n=>n==="auto",parse:n=>n},kN=[Fh,Ve,Ms,ca,HW,qW,sq],yC=n=>kN.find(bN(n));class LN extends tI{constructor(e,t,i,r,s){super(e,t,i,r,s,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:i}=this;if(!t||!t.current)return;super.readKeyframes();for(let u=0;u<e.length;u++){let h=e[u];if(typeof h=="string"&&(h=h.trim(),OT(h))){const d=MN(h,t.current);d!==void 0&&(e[u]=d),u===e.length-1&&(this.finalKeyframe=h)}}if(this.resolveNoneKeyframes(),!uN.has(i)||e.length!==2)return;const[r,s]=e,o=yC(r),a=yC(s);if(o!==a)if(mC(o)&&mC(a))for(let u=0;u<e.length;u++){const h=e[u];typeof h=="string"&&(e[u]=parseFloat(h))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,i=[];for(let r=0;r<e.length;r++)NK(e[r])&&i.push(r);i.length&&QK(e,i,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:i}=this;if(!e||!e.current)return;i==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Rh[i](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const r=t[t.length-1];r!==void 0&&e.getValue(i,r).jump(r,!1)}measureEndState(){var e;const{element:t,name:i,unresolvedKeyframes:r}=this;if(!t||!t.current)return;const s=t.getValue(i);s&&s.jump(this.measuredOrigin,!1);const o=r.length-1,a=r[o];r[o]=Rh[i](t.measureViewportBox(),window.getComputedStyle(t.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([u,h])=>{t.getValue(u).set(h)}),this.resolveNoneKeyframes()}}const vC=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(ja.test(n)||n==="0")&&!n.startsWith("url("));function oq(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function aq(n,e,t,i){const r=n[0];if(r===null)return!1;if(e==="display"||e==="visibility")return!0;const s=n[n.length-1],o=vC(r,e),a=vC(s,e);return!o||!a?!1:oq(n)||(t==="spring"||$T(t))&&i}const lq=n=>n!==null;function gy(n,{repeat:e,repeatType:t="loop"},i){const r=n.filter(lq),s=e&&t!=="loop"&&e%2===1?0:r.length-1;return!s||i===void 0?r[s]:i}const uq=40;class DN{constructor({autoplay:e=!0,delay:t=0,type:i="keyframes",repeat:r=0,repeatDelay:s=0,repeatType:o="loop",...a}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=bs.now(),this.options={autoplay:e,delay:t,type:i,repeat:r,repeatDelay:s,repeatType:o,...a},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>uq?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&nq(),this._resolved}onKeyframesResolved(e,t){this.resolvedAt=bs.now(),this.hasAttemptedResolve=!0;const{name:i,type:r,velocity:s,delay:o,onComplete:a,onUpdate:u,isGenerator:h}=this.options;if(!h&&!aq(e,i,r,s))if(o)this.options.duration=0;else{u&&u(gy(e,this.options,t)),a&&a(),this.resolveFinishedPromise();return}const d=this.initPlayback(e,t);d!==!1&&(this._resolved={keyframes:e,finalKeyframe:t,...d},this.onPostResolved())}onPostResolved(){}then(e,t){return this.currentFinishedPromise.then(e,t)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const $t=(n,e,t)=>n+(e-n)*t;function F1(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function cq({hue:n,saturation:e,lightness:t,alpha:i}){n/=360,e/=100,t/=100;let r=0,s=0,o=0;if(!e)r=s=o=t;else{const a=t<.5?t*(1+e):t+e-t*e,u=2*t-a;r=F1(u,a,n+1/3),s=F1(u,a,n),o=F1(u,a,n-1/3)}return{red:Math.round(r*255),green:Math.round(s*255),blue:Math.round(o*255),alpha:i}}function t_(n,e){return t=>t>0?e:n}const G1=(n,e,t)=>{const i=n*n,r=t*(e*e-i)+i;return r<0?0:Math.sqrt(r)},hq=[fw,zl,Oc],dq=n=>hq.find(e=>e.test(n));function EC(n){const e=dq(n);if(!e)return!1;let t=e.parse(n);return e===Oc&&(t=cq(t)),t}const wC=(n,e)=>{const t=EC(n),i=EC(e);if(!t||!i)return t_(n,e);const r={...t};return s=>(r.red=G1(t.red,i.red,s),r.green=G1(t.green,i.green,s),r.blue=G1(t.blue,i.blue,s),r.alpha=$t(t.alpha,i.alpha,s),zl.transform(r))},fq=(n,e)=>t=>e(n(t)),Bg=(...n)=>n.reduce(fq),_w=new Set(["none","hidden"]);function gq(n,e){return _w.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function mq(n,e){return t=>$t(n,e,t)}function nI(n){return typeof n=="number"?mq:typeof n=="string"?OT(n)?t_:Hn.test(n)?wC:yq:Array.isArray(n)?NN:typeof n=="object"?Hn.test(n)?wC:pq:t_}function NN(n,e){const t=[...n],i=t.length,r=n.map((s,o)=>nI(s)(s,e[o]));return s=>{for(let o=0;o<i;o++)t[o]=r[o](s);return t}}function pq(n,e){const t={...n,...e},i={};for(const r in t)n[r]!==void 0&&e[r]!==void 0&&(i[r]=nI(n[r])(n[r],e[r]));return r=>{for(const s in i)t[s]=i[s](r);return t}}function _q(n,e){var t;const i=[],r={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const o=e.types[s],a=n.indexes[o][r[o]],u=(t=n.values[a])!==null&&t!==void 0?t:0;i[s]=u,r[o]++}return i}const yq=(n,e)=>{const t=ja.createTransformer(e),i=ag(n),r=ag(e);return i.indexes.var.length===r.indexes.var.length&&i.indexes.color.length===r.indexes.color.length&&i.indexes.number.length>=r.indexes.number.length?_w.has(n)&&!r.values.length||_w.has(e)&&!i.values.length?gq(n,e):Bg(NN(_q(i,r),r.values),t):t_(n,e)};function ON(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?$t(n,e,t):nI(n)(n,e)}const vq=5;function VN(n,e,t){const i=Math.max(e-vq,0);return cN(t-n(i),e-i)}const Ht={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},j1=.001;function Eq({duration:n=Ht.duration,bounce:e=Ht.bounce,velocity:t=Ht.velocity,mass:i=Ht.mass}){let r,s,o=1-e;o=To(Ht.minDamping,Ht.maxDamping,o),n=To(Ht.minDuration,Ht.maxDuration,po(n)),o<1?(r=h=>{const d=h*o,g=d*n,m=d-t,v=yw(h,o),y=Math.exp(-g);return j1-m/v*y},s=h=>{const g=h*o*n,m=g*t+t,v=Math.pow(o,2)*Math.pow(h,2)*n,y=Math.exp(-g),I=yw(Math.pow(h,2),o);return(-r(h)+j1>0?-1:1)*((m-v)*y)/I}):(r=h=>{const d=Math.exp(-h*n),g=(h-t)*n+1;return-j1+d*g},s=h=>{const d=Math.exp(-h*n),g=(t-h)*(n*n);return d*g});const a=5/n,u=xq(r,s,a);if(n=mo(n),isNaN(u))return{stiffness:Ht.stiffness,damping:Ht.damping,duration:n};{const h=Math.pow(u,2)*i;return{stiffness:h,damping:o*2*Math.sqrt(i*h),duration:n}}}const wq=12;function xq(n,e,t){let i=t;for(let r=1;r<wq;r++)i=i-n(i)/e(i);return i}function yw(n,e){return n*Math.sqrt(1-e*e)}const Tq=["duration","bounce"],Iq=["stiffness","damping","mass"];function xC(n,e){return e.some(t=>n[t]!==void 0)}function Sq(n){let e={velocity:Ht.velocity,stiffness:Ht.stiffness,damping:Ht.damping,mass:Ht.mass,isResolvedFromDuration:!1,...n};if(!xC(n,Iq)&&xC(n,Tq))if(n.visualDuration){const t=n.visualDuration,i=2*Math.PI/(t*1.2),r=i*i,s=2*To(.05,1,1-(n.bounce||0))*Math.sqrt(r);e={...e,mass:Ht.mass,stiffness:r,damping:s}}else{const t=Eq(n);e={...e,...t,mass:Ht.mass},e.isResolvedFromDuration=!0}return e}function FN(n=Ht.visualDuration,e=Ht.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:i,restDelta:r}=t;const s=t.keyframes[0],o=t.keyframes[t.keyframes.length-1],a={done:!1,value:s},{stiffness:u,damping:h,mass:d,duration:g,velocity:m,isResolvedFromDuration:v}=Sq({...t,velocity:-po(t.velocity||0)}),y=m||0,I=h/(2*Math.sqrt(u*d)),w=o-s,R=po(Math.sqrt(u/d)),P=Math.abs(w)<5;i||(i=P?Ht.restSpeed.granular:Ht.restSpeed.default),r||(r=P?Ht.restDelta.granular:Ht.restDelta.default);let b;if(I<1){const D=yw(R,I);b=B=>{const M=Math.exp(-I*R*B);return o-M*((y+I*R*w)/D*Math.sin(D*B)+w*Math.cos(D*B))}}else if(I===1)b=D=>o-Math.exp(-R*D)*(w+(y+R*w)*D);else{const D=R*Math.sqrt(I*I-1);b=B=>{const M=Math.exp(-I*R*B),A=Math.min(D*B,300);return o-M*((y+I*R*w)*Math.sinh(A)+D*w*Math.cosh(A))/D}}const L={calculatedDuration:v&&g||null,next:D=>{const B=b(D);if(v)a.done=D>=g;else{let M=0;I<1&&(M=D===0?mo(y):VN(b,D,B));const A=Math.abs(M)<=i,k=Math.abs(o-B)<=r;a.done=A&&k}return a.value=a.done?o:B,a},toString:()=>{const D=Math.min(nN(L),cw),B=iN(M=>L.next(D*M).value,D,30);return D+"ms "+B}};return L}function TC({keyframes:n,velocity:e=0,power:t=.8,timeConstant:i=325,bounceDamping:r=10,bounceStiffness:s=500,modifyTarget:o,min:a,max:u,restDelta:h=.5,restSpeed:d}){const g=n[0],m={done:!1,value:g},v=A=>a!==void 0&&A<a||u!==void 0&&A>u,y=A=>a===void 0?u:u===void 0||Math.abs(a-A)<Math.abs(u-A)?a:u;let I=t*e;const w=g+I,R=o===void 0?w:o(w);R!==w&&(I=R-g);const P=A=>-I*Math.exp(-A/i),b=A=>R+P(A),L=A=>{const k=P(A),F=b(A);m.done=Math.abs(k)<=h,m.value=m.done?R:F};let D,B;const M=A=>{v(m.value)&&(D=A,B=FN({keyframes:[m.value,y(m.value)],velocity:VN(b,A,m.value),damping:r,stiffness:s,restDelta:h,restSpeed:d}))};return M(0),{calculatedDuration:null,next:A=>{let k=!1;return!B&&D===void 0&&(k=!0,L(A),M(A)),D!==void 0&&A>=D?B.next(A-D):(!k&&L(A),m)}}}const Aq=Ug(.42,0,1,1),Rq=Ug(0,0,.58,1),GN=Ug(.42,0,.58,1),Pq=n=>Array.isArray(n)&&typeof n[0]!="number",Cq={linear:Xi,easeIn:Aq,easeInOut:GN,easeOut:Rq,circIn:ZT,circInOut:vN,circOut:yN,backIn:YT,backInOut:pN,backOut:mN,anticipate:_N},IC=n=>{if(WT(n)){OD(n.length===4);const[e,t,i,r]=n;return Ug(e,t,i,r)}else if(typeof n=="string")return Cq[n];return n};function Mq(n,e,t){const i=[],r=t||ON,s=n.length-1;for(let o=0;o<s;o++){let a=r(n[o],n[o+1]);if(e){const u=Array.isArray(e)?e[o]||Xi:e;a=Bg(u,a)}i.push(a)}return i}function bq(n,e,{clamp:t=!0,ease:i,mixer:r}={}){const s=n.length;if(OD(s===e.length),s===1)return()=>e[0];if(s===2&&e[0]===e[1])return()=>e[1];const o=n[0]===n[1];n[0]>n[s-1]&&(n=[...n].reverse(),e=[...e].reverse());const a=Mq(e,i,r),u=a.length,h=d=>{if(o&&d<n[0])return e[0];let g=0;if(u>1)for(;g<n.length-2&&!(d<n[g+1]);g++);const m=Sh(n[g],n[g+1],d);return a[g](m)};return t?d=>h(To(n[0],n[s-1],d)):h}function kq(n,e){const t=n[n.length-1];for(let i=1;i<=e;i++){const r=Sh(0,e,i);n.push($t(t,1,r))}}function Lq(n){const e=[0];return kq(e,n.length-1),e}function Dq(n,e){return n.map(t=>t*e)}function Nq(n,e){return n.map(()=>e||GN).splice(0,n.length-1)}function n_({duration:n=300,keyframes:e,times:t,ease:i="easeInOut"}){const r=Pq(i)?i.map(IC):IC(i),s={done:!1,value:e[0]},o=Dq(t&&t.length===e.length?t:Lq(e),n),a=bq(o,e,{ease:Array.isArray(r)?r:Nq(e,r)});return{calculatedDuration:n,next:u=>(s.value=a(u),s.done=u>=n,s)}}const Oq=n=>{const e=({timestamp:t})=>n(t);return{start:()=>Lt.update(e,!0),stop:()=>Ga(e),now:()=>On.isProcessing?On.timestamp:bs.now()}},Vq={decay:TC,inertia:TC,tween:n_,keyframes:n_,spring:FN},Fq=n=>n/100;class iI extends DN{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:u}=this.options;u&&u()};const{name:t,motionValue:i,element:r,keyframes:s}=this.options,o=r?.KeyframeResolver||tI,a=(u,h)=>this.onKeyframesResolved(u,h);this.resolver=new o(s,a,t,i,r),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:t="keyframes",repeat:i=0,repeatDelay:r=0,repeatType:s,velocity:o=0}=this.options,a=$T(t)?t:Vq[t]||n_;let u,h;a!==n_&&typeof e[0]!="number"&&(u=Bg(Fq,ON(e[0],e[1])),e=[0,100]);const d=a({...this.options,keyframes:e});s==="mirror"&&(h=a({...this.options,keyframes:[...e].reverse(),velocity:-o})),d.calculatedDuration===null&&(d.calculatedDuration=nN(d));const{calculatedDuration:g}=d,m=g+r,v=m*(i+1)-r;return{generator:d,mirroredGenerator:h,mapPercentToKeyframes:u,calculatedDuration:g,resolvedDuration:m,totalDuration:v}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,t=!1){const{resolved:i}=this;if(!i){const{keyframes:A}=this.options;return{done:!0,value:A[A.length-1]}}const{finalKeyframe:r,generator:s,mirroredGenerator:o,mapPercentToKeyframes:a,keyframes:u,calculatedDuration:h,totalDuration:d,resolvedDuration:g}=i;if(this.startTime===null)return s.next(0);const{delay:m,repeat:v,repeatType:y,repeatDelay:I,onUpdate:w}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-d/this.speed,this.startTime)),t?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const R=this.currentTime-m*(this.speed>=0?1:-1),P=this.speed>=0?R<0:R>d;this.currentTime=Math.max(R,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=d);let b=this.currentTime,L=s;if(v){const A=Math.min(this.currentTime,d)/g;let k=Math.floor(A),F=A%1;!F&&A>=1&&(F=1),F===1&&k--,k=Math.min(k,v+1),k%2&&(y==="reverse"?(F=1-F,I&&(F-=I/g)):y==="mirror"&&(L=o)),b=To(0,1,F)*g}const D=P?{done:!1,value:u[0]}:L.next(b);a&&(D.value=a(D.value));let{done:B}=D;!P&&h!==null&&(B=this.speed>=0?this.currentTime>=d:this.currentTime<=0);const M=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&B);return M&&r!==void 0&&(D.value=gy(u,this.options,r)),w&&w(D.value),M&&this.finish(),D}get duration(){const{resolved:e}=this;return e?po(e.calculatedDuration):0}get time(){return po(this.currentTime)}set time(e){e=mo(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=po(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=Oq,onPlay:t,startTime:i}=this.options;this.driver||(this.driver=e(s=>this.tick(s))),t&&t();const r=this.driver.now();this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=r):this.startTime=i??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const Gq=new Set(["opacity","clipPath","filter","transform"]);function jq(n,e,t,{delay:i=0,duration:r=300,repeat:s=0,repeatType:o="loop",ease:a="easeInOut",times:u}={}){const h={[e]:t};u&&(h.offset=u);const d=sN(a,r);return Array.isArray(d)&&(h.easing=d),n.animate(h,{delay:i,duration:r,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:s+1,direction:o==="reverse"?"alternate":"normal"})}const Uq=CT(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),i_=10,Bq=2e4;function zq(n){return $T(n.type)||n.type==="spring"||!rN(n.ease)}function $q(n,e){const t=new iI({...e,keyframes:n,repeat:0,delay:0,isGenerator:!0});let i={done:!1,value:n[0]};const r=[];let s=0;for(;!i.done&&s<Bq;)i=t.sample(s),r.push(i.value),s+=i_;return{times:void 0,keyframes:r,duration:s-i_,ease:"linear"}}const jN={anticipate:_N,backInOut:pN,circInOut:vN};function Wq(n){return n in jN}class SC extends DN{constructor(e){super(e);const{name:t,motionValue:i,element:r,keyframes:s}=this.options;this.resolver=new LN(s,(o,a)=>this.onKeyframesResolved(o,a),t,i,r),this.resolver.scheduleResolve()}initPlayback(e,t){let{duration:i=300,times:r,ease:s,type:o,motionValue:a,name:u,startTime:h}=this.options;if(!a.owner||!a.owner.current)return!1;if(typeof s=="string"&&e_()&&Wq(s)&&(s=jN[s]),zq(this.options)){const{onComplete:g,onUpdate:m,motionValue:v,element:y,...I}=this.options,w=$q(e,I);e=w.keyframes,e.length===1&&(e[1]=e[0]),i=w.duration,r=w.times,s=w.ease,o="keyframes"}const d=jq(a.owner.current,u,e,{...this.options,duration:i,times:r,ease:s});return d.startTime=h??this.calcStartTime(),this.pendingTimeline?(uC(d,this.pendingTimeline),this.pendingTimeline=void 0):d.onfinish=()=>{const{onComplete:g}=this.options;a.set(gy(e,this.options,t)),g&&g(),this.cancel(),this.resolveFinishedPromise()},{animation:d,duration:i,times:r,type:o,ease:s,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:t}=e;return po(t)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:t}=e;return po(t.currentTime||0)}set time(e){const{resolved:t}=this;if(!t)return;const{animation:i}=t;i.currentTime=mo(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:t}=e;return t.playbackRate}set speed(e){const{resolved:t}=this;if(!t)return;const{animation:i}=t;i.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:t}=e;return t.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:t}=e;return t.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:t}=this;if(!t)return Xi;const{animation:i}=t;uC(i,e)}return Xi}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.playState==="finished"&&this.updateFinishedPromise(),t.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:t,keyframes:i,duration:r,type:s,ease:o,times:a}=e;if(t.playState==="idle"||t.playState==="finished")return;if(this.time){const{motionValue:h,onUpdate:d,onComplete:g,element:m,...v}=this.options,y=new iI({...v,keyframes:i,duration:r,type:s,ease:o,times:a,isGenerator:!0}),I=mo(this.time);h.setWithVelocity(y.sample(I-i_).value,y.sample(I).value,i_)}const{onStop:u}=this.options;u&&u(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:t,name:i,repeatDelay:r,repeatType:s,damping:o,type:a}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:u,transformTemplate:h}=t.owner.getProps();return Uq()&&i&&Gq.has(i)&&!u&&!h&&!r&&s!=="mirror"&&o!==0&&a!=="inertia"}}const Kq={type:"spring",stiffness:500,damping:25,restSpeed:10},qq=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),Hq={type:"keyframes",duration:.8},Xq={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Yq=(n,{keyframes:e})=>e.length>2?Hq:Su.has(n)?n.startsWith("scale")?qq(e[1]):Kq:Xq;function Zq({when:n,delay:e,delayChildren:t,staggerChildren:i,staggerDirection:r,repeat:s,repeatType:o,repeatDelay:a,from:u,elapsed:h,...d}){return!!Object.keys(d).length}const rI=(n,e,t,i={},r,s)=>o=>{const a=zT(i,n)||{},u=a.delay||i.delay||0;let{elapsed:h=0}=i;h=h-mo(u);let d={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...a,delay:-h,onUpdate:m=>{e.set(m),a.onUpdate&&a.onUpdate(m)},onComplete:()=>{o(),a.onComplete&&a.onComplete()},name:n,motionValue:e,element:s?void 0:r};Zq(a)||(d={...d,...Yq(n,d)}),d.duration&&(d.duration=mo(d.duration)),d.repeatDelay&&(d.repeatDelay=mo(d.repeatDelay)),d.from!==void 0&&(d.keyframes[0]=d.from);let g=!1;if((d.type===!1||d.duration===0&&!d.repeatDelay)&&(d.duration=0,d.delay===0&&(g=!0)),g&&!s&&e.get()!==void 0){const m=gy(d.keyframes,a);if(m!==void 0)return Lt.update(()=>{d.onUpdate(m),d.onComplete()}),new pK([])}return!s&&SC.supports(d)?new SC(d):new iI(d)};function Qq({protectedKeys:n,needsAnimating:e},t){const i=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,i}function UN(n,e,{delay:t=0,transitionOverride:i,type:r}={}){var s;let{transition:o=n.getDefaultTransition(),transitionEnd:a,...u}=e;i&&(o=i);const h=[],d=r&&n.animationState&&n.animationState.getState()[r];for(const g in u){const m=n.getValue(g,(s=n.latestValues[g])!==null&&s!==void 0?s:null),v=u[g];if(v===void 0||d&&Qq(d,g))continue;const y={delay:t,...zT(o||{},g)};let I=!1;if(window.MotionHandoffAnimation){const R=hN(n);if(R){const P=window.MotionHandoffAnimation(R,g,Lt);P!==null&&(y.startTime=P,I=!0)}}dw(n,g),m.start(rI(g,m,v,n.shouldReduceMotion&&uN.has(g)?{type:!1}:y,n,I));const w=m.animation;w&&h.push(w)}return a&&Promise.all(h).then(()=>{Lt.update(()=>{a&&MK(n,a)})}),h}function vw(n,e,t={}){var i;const r=fy(n,e,t.type==="exit"?(i=n.presenceContext)===null||i===void 0?void 0:i.custom:void 0);let{transition:s=n.getDefaultTransition()||{}}=r||{};t.transitionOverride&&(s=t.transitionOverride);const o=r?()=>Promise.all(UN(n,r,t)):()=>Promise.resolve(),a=n.variantChildren&&n.variantChildren.size?(h=0)=>{const{delayChildren:d=0,staggerChildren:g,staggerDirection:m}=s;return Jq(n,e,d+h,g,m,t)}:()=>Promise.resolve(),{when:u}=s;if(u){const[h,d]=u==="beforeChildren"?[o,a]:[a,o];return h().then(()=>d())}else return Promise.all([o(),a(t.delay)])}function Jq(n,e,t=0,i=0,r=1,s){const o=[],a=(n.variantChildren.size-1)*i,u=r===1?(h=0)=>h*i:(h=0)=>a-h*i;return Array.from(n.variantChildren).sort(eH).forEach((h,d)=>{h.notify("AnimationStart",e),o.push(vw(h,e,{...s,delay:t+u(d)}).then(()=>h.notify("AnimationComplete",e)))}),Promise.all(o)}function eH(n,e){return n.sortNodePosition(e)}function tH(n,e,t={}){n.notify("AnimationStart",e);let i;if(Array.isArray(e)){const r=e.map(s=>vw(n,s,t));i=Promise.all(r)}else if(typeof e=="string")i=vw(n,e,t);else{const r=typeof e=="function"?fy(n,e,t.custom):e;i=Promise.all(UN(n,r,t))}return i.then(()=>{n.notify("AnimationComplete",e)})}const nH=bT.length;function BN(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?BN(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<nH;t++){const i=bT[t],r=n.props[i];(rg(r)||r===!1)&&(e[i]=r)}return e}const iH=[...MT].reverse(),rH=MT.length;function sH(n){return e=>Promise.all(e.map(({animation:t,options:i})=>tH(n,t,i)))}function oH(n){let e=sH(n),t=AC(),i=!0;const r=u=>(h,d)=>{var g;const m=fy(n,d,u==="exit"?(g=n.presenceContext)===null||g===void 0?void 0:g.custom:void 0);if(m){const{transition:v,transitionEnd:y,...I}=m;h={...h,...I,...y}}return h};function s(u){e=u(n)}function o(u){const{props:h}=n,d=BN(n.parent)||{},g=[],m=new Set;let v={},y=1/0;for(let w=0;w<rH;w++){const R=iH[w],P=t[R],b=h[R]!==void 0?h[R]:d[R],L=rg(b),D=R===u?P.isActive:null;D===!1&&(y=w);let B=b===d[R]&&b!==h[R]&&L;if(B&&i&&n.manuallyAnimateOnMount&&(B=!1),P.protectedKeys={...v},!P.isActive&&D===null||!b&&!P.prevProp||hy(b)||typeof b=="boolean")continue;const M=aH(P.prevProp,b);let A=M||R===u&&P.isActive&&!B&&L||w>y&&L,k=!1;const F=Array.isArray(b)?b:[b];let G=F.reduce(r(R),{});D===!1&&(G={});const{prevResolvedValues:U={}}=P,N={...U,...G},ue=de=>{A=!0,m.has(de)&&(k=!0,m.delete(de)),P.needsAnimating[de]=!0;const J=n.getValue(de);J&&(J.liveStyle=!1)};for(const de in N){const J=G[de],ae=U[de];if(v.hasOwnProperty(de))continue;let ie=!1;uw(J)&&uw(ae)?ie=!tN(J,ae):ie=J!==ae,ie?J!=null?ue(de):m.add(de):J!==void 0&&m.has(de)?ue(de):P.protectedKeys[de]=!0}P.prevProp=b,P.prevResolvedValues=G,P.isActive&&(v={...v,...G}),i&&n.blockInitialAnimation&&(A=!1),A&&(!(B&&M)||k)&&g.push(...F.map(de=>({animation:de,options:{type:R}})))}if(m.size){const w={};m.forEach(R=>{const P=n.getBaseTarget(R),b=n.getValue(R);b&&(b.liveStyle=!0),w[R]=P??null}),g.push({animation:w})}let I=!!g.length;return i&&(h.initial===!1||h.initial===h.animate)&&!n.manuallyAnimateOnMount&&(I=!1),i=!1,I?e(g):Promise.resolve()}function a(u,h){var d;if(t[u].isActive===h)return Promise.resolve();(d=n.variantChildren)===null||d===void 0||d.forEach(m=>{var v;return(v=m.animationState)===null||v===void 0?void 0:v.setActive(u,h)}),t[u].isActive=h;const g=o(u);for(const m in t)t[m].protectedKeys={};return g}return{animateChanges:o,setActive:a,setAnimateFunction:s,getState:()=>t,reset:()=>{t=AC(),i=!0}}}function aH(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!tN(e,n):!1}function Tl(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function AC(){return{animate:Tl(!0),whileInView:Tl(),whileHover:Tl(),whileTap:Tl(),whileDrag:Tl(),whileFocus:Tl(),exit:Tl()}}class qa{constructor(e){this.isMounted=!1,this.node=e}update(){}}class lH extends qa{constructor(e){super(e),e.animationState||(e.animationState=oH(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();hy(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let uH=0;class cH extends qa{constructor(){super(...arguments),this.id=uH++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:i}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===i)return;const r=this.node.animationState.setActive("exit",!e);t&&!e&&r.then(()=>t(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const hH={animation:{Feature:lH},exit:{Feature:cH}};function lg(n,e,t,i={passive:!0}){return n.addEventListener(e,t,i),()=>n.removeEventListener(e,t)}function zg(n){return{point:{x:n.pageX,y:n.pageY}}}const dH=n=>e=>KT(e)&&n(e,zg(e));function Ef(n,e,t,i){return lg(n,e,dH(t),i)}const RC=(n,e)=>Math.abs(n-e);function fH(n,e){const t=RC(n.x,e.x),i=RC(n.y,e.y);return Math.sqrt(t**2+i**2)}class zN{constructor(e,t,{transformPagePoint:i,contextWindow:r,dragSnapToOrigin:s=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const g=B1(this.lastMoveEventInfo,this.history),m=this.startEvent!==null,v=fH(g.offset,{x:0,y:0})>=3;if(!m&&!v)return;const{point:y}=g,{timestamp:I}=On;this.history.push({...y,timestamp:I});const{onStart:w,onMove:R}=this.handlers;m||(w&&w(this.lastMoveEvent,g),this.startEvent=this.lastMoveEvent),R&&R(this.lastMoveEvent,g)},this.handlePointerMove=(g,m)=>{this.lastMoveEvent=g,this.lastMoveEventInfo=U1(m,this.transformPagePoint),Lt.update(this.updatePoint,!0)},this.handlePointerUp=(g,m)=>{this.end();const{onEnd:v,onSessionEnd:y,resumeAnimation:I}=this.handlers;if(this.dragSnapToOrigin&&I&&I(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const w=B1(g.type==="pointercancel"?this.lastMoveEventInfo:U1(m,this.transformPagePoint),this.history);this.startEvent&&v&&v(g,w),y&&y(g,w)},!KT(e))return;this.dragSnapToOrigin=s,this.handlers=t,this.transformPagePoint=i,this.contextWindow=r||window;const o=zg(e),a=U1(o,this.transformPagePoint),{point:u}=a,{timestamp:h}=On;this.history=[{...u,timestamp:h}];const{onSessionStart:d}=t;d&&d(e,B1(a,this.history)),this.removeListeners=Bg(Ef(this.contextWindow,"pointermove",this.handlePointerMove),Ef(this.contextWindow,"pointerup",this.handlePointerUp),Ef(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Ga(this.updatePoint)}}function U1(n,e){return e?{point:e(n.point)}:n}function PC(n,e){return{x:n.x-e.x,y:n.y-e.y}}function B1({point:n},e){return{point:n,delta:PC(n,$N(e)),offset:PC(n,gH(e)),velocity:mH(e,.1)}}function gH(n){return n[0]}function $N(n){return n[n.length-1]}function mH(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,i=null;const r=$N(n);for(;t>=0&&(i=n[t],!(r.timestamp-i.timestamp>mo(e)));)t--;if(!i)return{x:0,y:0};const s=po(r.timestamp-i.timestamp);if(s===0)return{x:0,y:0};const o={x:(r.x-i.x)/s,y:(r.y-i.y)/s};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}const WN=1e-4,pH=1-WN,_H=1+WN,KN=.01,yH=0-KN,vH=0+KN;function Ji(n){return n.max-n.min}function EH(n,e,t){return Math.abs(n-e)<=t}function CC(n,e,t,i=.5){n.origin=i,n.originPoint=$t(e.min,e.max,n.origin),n.scale=Ji(t)/Ji(e),n.translate=$t(t.min,t.max,n.origin)-n.originPoint,(n.scale>=pH&&n.scale<=_H||isNaN(n.scale))&&(n.scale=1),(n.translate>=yH&&n.translate<=vH||isNaN(n.translate))&&(n.translate=0)}function wf(n,e,t,i){CC(n.x,e.x,t.x,i?i.originX:void 0),CC(n.y,e.y,t.y,i?i.originY:void 0)}function MC(n,e,t){n.min=t.min+e.min,n.max=n.min+Ji(e)}function wH(n,e,t){MC(n.x,e.x,t.x),MC(n.y,e.y,t.y)}function bC(n,e,t){n.min=e.min-t.min,n.max=n.min+Ji(e)}function xf(n,e,t){bC(n.x,e.x,t.x),bC(n.y,e.y,t.y)}function xH(n,{min:e,max:t},i){return e!==void 0&&n<e?n=i?$t(e,n,i.min):Math.max(n,e):t!==void 0&&n>t&&(n=i?$t(t,n,i.max):Math.min(n,t)),n}function kC(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function TH(n,{top:e,left:t,bottom:i,right:r}){return{x:kC(n.x,t,r),y:kC(n.y,e,i)}}function LC(n,e){let t=e.min-n.min,i=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,i]=[i,t]),{min:t,max:i}}function IH(n,e){return{x:LC(n.x,e.x),y:LC(n.y,e.y)}}function SH(n,e){let t=.5;const i=Ji(n),r=Ji(e);return r>i?t=Sh(e.min,e.max-i,n.min):i>r&&(t=Sh(n.min,n.max-r,e.min)),To(0,1,t)}function AH(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const Ew=.35;function RH(n=Ew){return n===!1?n=0:n===!0&&(n=Ew),{x:DC(n,"left","right"),y:DC(n,"top","bottom")}}function DC(n,e,t){return{min:NC(n,e),max:NC(n,t)}}function NC(n,e){return typeof n=="number"?n:n[e]||0}const OC=()=>({translate:0,scale:1,origin:0,originPoint:0}),Vc=()=>({x:OC(),y:OC()}),VC=()=>({min:0,max:0}),en=()=>({x:VC(),y:VC()});function _r(n){return[n("x"),n("y")]}function qN({top:n,left:e,right:t,bottom:i}){return{x:{min:e,max:t},y:{min:n,max:i}}}function PH({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function CH(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),i=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:i.y,right:i.x}}function z1(n){return n===void 0||n===1}function ww({scale:n,scaleX:e,scaleY:t}){return!z1(n)||!z1(e)||!z1(t)}function Cl(n){return ww(n)||HN(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function HN(n){return FC(n.x)||FC(n.y)}function FC(n){return n&&n!=="0%"}function r_(n,e,t){const i=n-t,r=e*i;return t+r}function GC(n,e,t,i,r){return r!==void 0&&(n=r_(n,r,i)),r_(n,t,i)+e}function xw(n,e=0,t=1,i,r){n.min=GC(n.min,e,t,i,r),n.max=GC(n.max,e,t,i,r)}function XN(n,{x:e,y:t}){xw(n.x,e.translate,e.scale,e.originPoint),xw(n.y,t.translate,t.scale,t.originPoint)}const jC=.999999999999,UC=1.0000000000001;function MH(n,e,t,i=!1){const r=t.length;if(!r)return;e.x=e.y=1;let s,o;for(let a=0;a<r;a++){s=t[a],o=s.projectionDelta;const{visualElement:u}=s.options;u&&u.props.style&&u.props.style.display==="contents"||(i&&s.options.layoutScroll&&s.scroll&&s!==s.root&&Gc(n,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,XN(n,o)),i&&Cl(s.latestValues)&&Gc(n,s.latestValues))}e.x<UC&&e.x>jC&&(e.x=1),e.y<UC&&e.y>jC&&(e.y=1)}function Fc(n,e){n.min=n.min+e,n.max=n.max+e}function BC(n,e,t,i,r=.5){const s=$t(n.min,n.max,r);xw(n,e,t,s,i)}function Gc(n,e){BC(n.x,e.x,e.scaleX,e.scale,e.originX),BC(n.y,e.y,e.scaleY,e.scale,e.originY)}function YN(n,e){return qN(CH(n.getBoundingClientRect(),e))}function bH(n,e,t){const i=YN(n,t),{scroll:r}=e;return r&&(Fc(i.x,r.offset.x),Fc(i.y,r.offset.y)),i}const ZN=({current:n})=>n?n.ownerDocument.defaultView:null,kH=new WeakMap;class LH{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=en(),this.visualElement=e}start(e,{snapToCursor:t=!1}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const r=d=>{const{dragSnapToOrigin:g}=this.getProps();g?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(zg(d).point)},s=(d,g)=>{const{drag:m,dragPropagation:v,onDragStart:y}=this.getProps();if(m&&!v&&(this.openDragLock&&this.openDragLock(),this.openDragLock=SK(m),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),_r(w=>{let R=this.getAxisMotionValue(w).get()||0;if(Ms.test(R)){const{projection:P}=this.visualElement;if(P&&P.layout){const b=P.layout.layoutBox[w];b&&(R=Ji(b)*(parseFloat(R)/100))}}this.originPoint[w]=R}),y&&Lt.postRender(()=>y(d,g)),dw(this.visualElement,"transform");const{animationState:I}=this.visualElement;I&&I.setActive("whileDrag",!0)},o=(d,g)=>{const{dragPropagation:m,dragDirectionLock:v,onDirectionLock:y,onDrag:I}=this.getProps();if(!m&&!this.openDragLock)return;const{offset:w}=g;if(v&&this.currentDirection===null){this.currentDirection=DH(w),this.currentDirection!==null&&y&&y(this.currentDirection);return}this.updateAxis("x",g.point,w),this.updateAxis("y",g.point,w),this.visualElement.render(),I&&I(d,g)},a=(d,g)=>this.stop(d,g),u=()=>_r(d=>{var g;return this.getAnimationState(d)==="paused"&&((g=this.getAxisMotionValue(d).animation)===null||g===void 0?void 0:g.play())}),{dragSnapToOrigin:h}=this.getProps();this.panSession=new zN(e,{onSessionStart:r,onStart:s,onMove:o,onSessionEnd:a,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:h,contextWindow:ZN(this.visualElement)})}stop(e,t){const i=this.isDragging;if(this.cancel(),!i)return;const{velocity:r}=t;this.startAnimation(r);const{onDragEnd:s}=this.getProps();s&&Lt.postRender(()=>s(e,t))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:i}=this.getProps();!i&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,i){const{drag:r}=this.getProps();if(!i||!Cp(e,r,this.currentDirection))return;const s=this.getAxisMotionValue(e);let o=this.originPoint[e]+i[e];this.constraints&&this.constraints[e]&&(o=xH(o,this.constraints[e],this.elastic[e])),s.set(o)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:i}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,s=this.constraints;t&&Nc(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&r?this.constraints=TH(r.layoutBox,t):this.constraints=!1,this.elastic=RH(i),s!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&_r(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=AH(r.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!Nc(e))return!1;const i=e.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const s=bH(i,r.root,this.visualElement.getTransformPagePoint());let o=IH(r.layout.layoutBox,s);if(t){const a=t(PH(o));this.hasMutatedConstraints=!!a,a&&(o=qN(a))}return o}startAnimation(e){const{drag:t,dragMomentum:i,dragElastic:r,dragTransition:s,dragSnapToOrigin:o,onDragTransitionEnd:a}=this.getProps(),u=this.constraints||{},h=_r(d=>{if(!Cp(d,t,this.currentDirection))return;let g=u&&u[d]||{};o&&(g={min:0,max:0});const m=r?200:1e6,v=r?40:1e7,y={type:"inertia",velocity:i?e[d]:0,bounceStiffness:m,bounceDamping:v,timeConstant:750,restDelta:1,restSpeed:10,...s,...g};return this.startAxisValueAnimation(d,y)});return Promise.all(h).then(a)}startAxisValueAnimation(e,t){const i=this.getAxisMotionValue(e);return dw(this.visualElement,e),i.start(rI(e,i,0,t,this.visualElement,!1))}stopAnimation(){_r(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){_r(e=>{var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.pause()})}getAnimationState(e){var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,i=this.visualElement.getProps(),r=i[t];return r||this.visualElement.getValue(e,(i.initial?i.initial[e]:void 0)||0)}snapToCursor(e){_r(t=>{const{drag:i}=this.getProps();if(!Cp(t,i,this.currentDirection))return;const{projection:r}=this.visualElement,s=this.getAxisMotionValue(t);if(r&&r.layout){const{min:o,max:a}=r.layout.layoutBox[t];s.set(e[t]-$t(o,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:i}=this.visualElement;if(!Nc(t)||!i||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};_r(o=>{const a=this.getAxisMotionValue(o);if(a&&this.constraints!==!1){const u=a.get();r[o]=SH({min:u,max:u},this.constraints[o])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",i.root&&i.root.updateScroll(),i.updateLayout(),this.resolveConstraints(),_r(o=>{if(!Cp(o,e,null))return;const a=this.getAxisMotionValue(o),{min:u,max:h}=this.constraints[o];a.set($t(u,h,r[o]))})}addListeners(){if(!this.visualElement.current)return;kH.set(this.visualElement,this);const e=this.visualElement.current,t=Ef(e,"pointerdown",u=>{const{drag:h,dragListener:d=!0}=this.getProps();h&&d&&this.start(u)}),i=()=>{const{dragConstraints:u}=this.getProps();Nc(u)&&u.current&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,s=r.addEventListener("measure",i);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),Lt.read(i);const o=lg(window,"resize",()=>this.scalePositionWithinConstraints()),a=r.addEventListener("didUpdate",(({delta:u,hasLayoutChanged:h})=>{this.isDragging&&h&&(_r(d=>{const g=this.getAxisMotionValue(d);g&&(this.originPoint[d]+=u[d].translate,g.set(g.get()+u[d].translate))}),this.visualElement.render())}));return()=>{o(),t(),s(),a&&a()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:i=!1,dragPropagation:r=!1,dragConstraints:s=!1,dragElastic:o=Ew,dragMomentum:a=!0}=e;return{...e,drag:t,dragDirectionLock:i,dragPropagation:r,dragConstraints:s,dragElastic:o,dragMomentum:a}}}function Cp(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function DH(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class NH extends qa{constructor(e){super(e),this.removeGroupControls=Xi,this.removeListeners=Xi,this.controls=new LH(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Xi}unmount(){this.removeGroupControls(),this.removeListeners()}}const zC=n=>(e,t)=>{n&&Lt.postRender(()=>n(e,t))};class OH extends qa{constructor(){super(...arguments),this.removePointerDownListener=Xi}onPointerDown(e){this.session=new zN(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:ZN(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:i,onPanEnd:r}=this.node.getProps();return{onSessionStart:zC(e),onStart:zC(t),onMove:i,onEnd:(s,o)=>{delete this.session,r&&Lt.postRender(()=>r(s,o))}}}mount(){this.removePointerDownListener=Ef(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Jp={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function $C(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const Gd={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(Ve.test(n))n=parseFloat(n);else return n;const t=$C(n,e.target.x),i=$C(n,e.target.y);return`${t}% ${i}%`}},VH={correct:(n,{treeScale:e,projectionDelta:t})=>{const i=n,r=ja.parse(n);if(r.length>5)return i;const s=ja.createTransformer(n),o=typeof r[0]!="number"?1:0,a=t.x.scale*e.x,u=t.y.scale*e.y;r[0+o]/=a,r[1+o]/=u;const h=$t(a,u,.5);return typeof r[2+o]=="number"&&(r[2+o]/=h),typeof r[3+o]=="number"&&(r[3+o]/=h),s(r)}};class FH extends ne.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:i,layoutId:r}=this.props,{projection:s}=e;rK(GH),s&&(t.group&&t.group.add(s),i&&i.register&&r&&i.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),Jp.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:i,drag:r,isPresent:s}=this.props,o=i.projection;return o&&(o.isPresent=s,r||e.layoutDependency!==t||t===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?o.promote():o.relegate()||Lt.postRender(()=>{const a=o.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),LT.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:i}=this.props,{projection:r}=e;r&&(r.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(r),i&&i.deregister&&i.deregister(r))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function QN(n){const[e,t]=DD(),i=ne.useContext(ST);return V.jsx(FH,{...n,layoutGroup:i,switchLayoutGroup:ne.useContext(BD),isPresent:e,safeToRemove:t})}const GH={borderRadius:{...Gd,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Gd,borderTopRightRadius:Gd,borderBottomLeftRadius:Gd,borderBottomRightRadius:Gd,boxShadow:VH};function jH(n,e,t){const i=ei(n)?n:og(n);return i.start(rI("",i,e,t)),i.animation}function UH(n){return n instanceof SVGElement&&n.tagName!=="svg"}const BH=(n,e)=>n.depth-e.depth;class zH{constructor(){this.children=[],this.isDirty=!1}add(e){qT(this.children,e),this.isDirty=!0}remove(e){HT(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(BH),this.isDirty=!1,this.children.forEach(e)}}function $H(n,e){const t=bs.now(),i=({timestamp:r})=>{const s=r-t;s>=e&&(Ga(i),n(s-e))};return Lt.read(i,!0),()=>Ga(i)}const JN=["TopLeft","TopRight","BottomLeft","BottomRight"],WH=JN.length,WC=n=>typeof n=="string"?parseFloat(n):n,KC=n=>typeof n=="number"||Ve.test(n);function KH(n,e,t,i,r,s){r?(n.opacity=$t(0,t.opacity!==void 0?t.opacity:1,qH(i)),n.opacityExit=$t(e.opacity!==void 0?e.opacity:1,0,HH(i))):s&&(n.opacity=$t(e.opacity!==void 0?e.opacity:1,t.opacity!==void 0?t.opacity:1,i));for(let o=0;o<WH;o++){const a=`border${JN[o]}Radius`;let u=qC(e,a),h=qC(t,a);if(u===void 0&&h===void 0)continue;u||(u=0),h||(h=0),u===0||h===0||KC(u)===KC(h)?(n[a]=Math.max($t(WC(u),WC(h),i),0),(Ms.test(h)||Ms.test(u))&&(n[a]+="%")):n[a]=h}(e.rotate||t.rotate)&&(n.rotate=$t(e.rotate||0,t.rotate||0,i))}function qC(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const qH=eO(0,.5,yN),HH=eO(.5,.95,Xi);function eO(n,e,t){return i=>i<n?0:i>e?1:t(Sh(n,e,i))}function HC(n,e){n.min=e.min,n.max=e.max}function mr(n,e){HC(n.x,e.x),HC(n.y,e.y)}function XC(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function YC(n,e,t,i,r){return n-=e,n=r_(n,1/t,i),r!==void 0&&(n=r_(n,1/r,i)),n}function XH(n,e=0,t=1,i=.5,r,s=n,o=n){if(Ms.test(e)&&(e=parseFloat(e),e=$t(o.min,o.max,e/100)-o.min),typeof e!="number")return;let a=$t(s.min,s.max,i);n===s&&(a-=e),n.min=YC(n.min,e,t,a,r),n.max=YC(n.max,e,t,a,r)}function ZC(n,e,[t,i,r],s,o){XH(n,e[t],e[i],e[r],e.scale,s,o)}const YH=["x","scaleX","originX"],ZH=["y","scaleY","originY"];function QC(n,e,t,i){ZC(n.x,e,YH,t?t.x:void 0,i?i.x:void 0),ZC(n.y,e,ZH,t?t.y:void 0,i?i.y:void 0)}function JC(n){return n.translate===0&&n.scale===1}function tO(n){return JC(n.x)&&JC(n.y)}function eM(n,e){return n.min===e.min&&n.max===e.max}function QH(n,e){return eM(n.x,e.x)&&eM(n.y,e.y)}function tM(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function nO(n,e){return tM(n.x,e.x)&&tM(n.y,e.y)}function nM(n){return Ji(n.x)/Ji(n.y)}function iM(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class JH{constructor(){this.members=[]}add(e){qT(this.members,e),e.scheduleRender()}remove(e){if(HT(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(r=>e===r);if(t===0)return!1;let i;for(let r=t;r>=0;r--){const s=this.members[r];if(s.isPresent!==!1){i=s;break}}return i?(this.promote(i),!0):!1}promote(e,t){const i=this.lead;if(e!==i&&(this.prevLead=i,this.lead=e,e.show(),i)){i.instance&&i.scheduleRender(),e.scheduleRender(),e.resumeFrom=i,t&&(e.resumeFrom.preserveOpacity=!0),i.snapshot&&(e.snapshot=i.snapshot,e.snapshot.latestValues=i.animationValues||i.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:r}=e.options;r===!1&&i.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:i}=e;t.onExitComplete&&t.onExitComplete(),i&&i.options.onExitComplete&&i.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function eX(n,e,t){let i="";const r=n.x.translate/e.x,s=n.y.translate/e.y,o=t?.z||0;if((r||s||o)&&(i=`translate3d(${r}px, ${s}px, ${o}px) `),(e.x!==1||e.y!==1)&&(i+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:h,rotate:d,rotateX:g,rotateY:m,skewX:v,skewY:y}=t;h&&(i=`perspective(${h}px) ${i}`),d&&(i+=`rotate(${d}deg) `),g&&(i+=`rotateX(${g}deg) `),m&&(i+=`rotateY(${m}deg) `),v&&(i+=`skewX(${v}deg) `),y&&(i+=`skewY(${y}deg) `)}const a=n.x.scale*e.x,u=n.y.scale*e.y;return(a!==1||u!==1)&&(i+=`scale(${a}, ${u})`),i||"none"}const Ml={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},nf=typeof window<"u"&&window.MotionDebug!==void 0,$1=["","X","Y","Z"],tX={visibility:"hidden"},rM=1e3;let nX=0;function W1(n,e,t,i){const{latestValues:r}=e;r[n]&&(t[n]=r[n],e.setStaticValue(n,0),i&&(i[n]=0))}function iO(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=hN(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:r,layoutId:s}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",Lt,!(r||s))}const{parent:i}=n;i&&!i.hasCheckedOptimisedAppear&&iO(i)}function rO({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:i,resetTransform:r}){return class{constructor(o={},a=e?.()){this.id=nX++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,nf&&(Ml.totalNodes=Ml.resolvedTargetDeltas=Ml.recalculatedProjection=0),this.nodes.forEach(sX),this.nodes.forEach(cX),this.nodes.forEach(hX),this.nodes.forEach(oX),nf&&window.MotionDebug.record(Ml)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let u=0;u<this.path.length;u++)this.path[u].shouldResetTransform=!0;this.root===this&&(this.nodes=new zH)}addEventListener(o,a){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new XT),this.eventHandlers.get(o).add(a)}notifyListeners(o,...a){const u=this.eventHandlers.get(o);u&&u.notify(...a)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,a=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=UH(o),this.instance=o;const{layoutId:u,layout:h,visualElement:d}=this.options;if(d&&!d.current&&d.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),a&&(h||u)&&(this.isLayoutDirty=!0),n){let g;const m=()=>this.root.updateBlockedByResize=!1;n(o,()=>{this.root.updateBlockedByResize=!0,g&&g(),g=$H(m,250),Jp.hasAnimatedSinceResize&&(Jp.hasAnimatedSinceResize=!1,this.nodes.forEach(oM))})}u&&this.root.registerSharedNode(u,this),this.options.animate!==!1&&d&&(u||h)&&this.addEventListener("didUpdate",({delta:g,hasLayoutChanged:m,hasRelativeTargetChanged:v,layout:y})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const I=this.options.transition||d.getDefaultTransition()||pX,{onLayoutAnimationStart:w,onLayoutAnimationComplete:R}=d.getProps(),P=!this.targetLayout||!nO(this.targetLayout,y)||v,b=!m&&v;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||b||m&&(P||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(g,b);const L={...zT(I,"layout"),onPlay:w,onComplete:R};(d.shouldReduceMotion||this.options.layoutRoot)&&(L.delay=0,L.type=!1),this.startAnimation(L)}else m||oM(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=y})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Ga(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(dX),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&iO(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let d=0;d<this.path.length;d++){const g=this.path[d];g.shouldResetTransform=!0,g.updateScroll("snapshot"),g.options.layoutRoot&&g.willUpdate(!1)}const{layoutId:a,layout:u}=this.options;if(a===void 0&&!u)return;const h=this.getTransformTemplate();this.prevTransformTemplateValue=h?h(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(sM);return}this.isUpdating||this.nodes.forEach(lX),this.isUpdating=!1,this.nodes.forEach(uX),this.nodes.forEach(iX),this.nodes.forEach(rX),this.clearAllSnapshots();const a=bs.now();On.delta=To(0,1e3/60,a-On.timestamp),On.timestamp=a,On.isProcessing=!0,N1.update.process(On),N1.preRender.process(On),N1.render.process(On),On.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,LT.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(aX),this.sharedNodes.forEach(fX)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Lt.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Lt.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let u=0;u<this.path.length;u++)this.path[u].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=en(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let a=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(a=!1),a){const u=i(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:u,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:u}}}resetTransform(){if(!r)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,a=this.projectionDelta&&!tO(this.projectionDelta),u=this.getTransformTemplate(),h=u?u(this.latestValues,""):void 0,d=h!==this.prevTransformTemplateValue;o&&(a||Cl(this.latestValues)||d)&&(r(this.instance,h),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const a=this.measurePageBox();let u=this.removeElementScroll(a);return o&&(u=this.removeTransform(u)),_X(u),{animationId:this.root.animationId,measuredBox:a,layoutBox:u,latestValues:{},source:this.id}}measurePageBox(){var o;const{visualElement:a}=this.options;if(!a)return en();const u=a.measureViewportBox();if(!(((o=this.scroll)===null||o===void 0?void 0:o.wasRoot)||this.path.some(yX))){const{scroll:d}=this.root;d&&(Fc(u.x,d.offset.x),Fc(u.y,d.offset.y))}return u}removeElementScroll(o){var a;const u=en();if(mr(u,o),!((a=this.scroll)===null||a===void 0)&&a.wasRoot)return u;for(let h=0;h<this.path.length;h++){const d=this.path[h],{scroll:g,options:m}=d;d!==this.root&&g&&m.layoutScroll&&(g.wasRoot&&mr(u,o),Fc(u.x,g.offset.x),Fc(u.y,g.offset.y))}return u}applyTransform(o,a=!1){const u=en();mr(u,o);for(let h=0;h<this.path.length;h++){const d=this.path[h];!a&&d.options.layoutScroll&&d.scroll&&d!==d.root&&Gc(u,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),Cl(d.latestValues)&&Gc(u,d.latestValues)}return Cl(this.latestValues)&&Gc(u,this.latestValues),u}removeTransform(o){const a=en();mr(a,o);for(let u=0;u<this.path.length;u++){const h=this.path[u];if(!h.instance||!Cl(h.latestValues))continue;ww(h.latestValues)&&h.updateSnapshot();const d=en(),g=h.measurePageBox();mr(d,g),QC(a,h.latestValues,h.snapshot?h.snapshot.layoutBox:void 0,d)}return Cl(this.latestValues)&&QC(a,this.latestValues),a}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==On.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var a;const u=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=u.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=u.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=u.isSharedProjectionDirty);const h=!!this.resumingFrom||this!==u;if(!(o||h&&this.isSharedProjectionDirty||this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:g,layoutId:m}=this.options;if(!(!this.layout||!(g||m))){if(this.resolvedRelativeTargetAt=On.timestamp,!this.targetDelta&&!this.relativeTarget){const v=this.getClosestProjectingParent();v&&v.layout&&this.animationProgress!==1?(this.relativeParent=v,this.forceRelativeParentToResolveTarget(),this.relativeTarget=en(),this.relativeTargetOrigin=en(),xf(this.relativeTargetOrigin,this.layout.layoutBox,v.layout.layoutBox),mr(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=en(),this.targetWithTransforms=en()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),wH(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):mr(this.target,this.layout.layoutBox),XN(this.target,this.targetDelta)):mr(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const v=this.getClosestProjectingParent();v&&!!v.resumingFrom==!!this.resumingFrom&&!v.options.layoutScroll&&v.target&&this.animationProgress!==1?(this.relativeParent=v,this.forceRelativeParentToResolveTarget(),this.relativeTarget=en(),this.relativeTargetOrigin=en(),xf(this.relativeTargetOrigin,this.target,v.target),mr(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}nf&&Ml.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||ww(this.parent.latestValues)||HN(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const a=this.getLead(),u=!!this.resumingFrom||this!==a;let h=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(h=!1),u&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(h=!1),this.resolvedRelativeTargetAt===On.timestamp&&(h=!1),h)return;const{layout:d,layoutId:g}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||g))return;mr(this.layoutCorrected,this.layout.layoutBox);const m=this.treeScale.x,v=this.treeScale.y;MH(this.layoutCorrected,this.treeScale,this.path,u),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox,a.targetWithTransforms=en());const{target:y}=a;if(!y){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(XC(this.prevProjectionDelta.x,this.projectionDelta.x),XC(this.prevProjectionDelta.y,this.projectionDelta.y)),wf(this.projectionDelta,this.layoutCorrected,y,this.latestValues),(this.treeScale.x!==m||this.treeScale.y!==v||!iM(this.projectionDelta.x,this.prevProjectionDelta.x)||!iM(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",y)),nf&&Ml.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var a;if((a=this.options.visualElement)===null||a===void 0||a.scheduleRender(),o){const u=this.getStack();u&&u.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Vc(),this.projectionDelta=Vc(),this.projectionDeltaWithTransform=Vc()}setAnimationOrigin(o,a=!1){const u=this.snapshot,h=u?u.latestValues:{},d={...this.latestValues},g=Vc();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const m=en(),v=u?u.source:void 0,y=this.layout?this.layout.source:void 0,I=v!==y,w=this.getStack(),R=!w||w.members.length<=1,P=!!(I&&!R&&this.options.crossfade===!0&&!this.path.some(mX));this.animationProgress=0;let b;this.mixTargetDelta=L=>{const D=L/1e3;aM(g.x,o.x,D),aM(g.y,o.y,D),this.setTargetDelta(g),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(xf(m,this.layout.layoutBox,this.relativeParent.layout.layoutBox),gX(this.relativeTarget,this.relativeTargetOrigin,m,D),b&&QH(this.relativeTarget,b)&&(this.isProjectionDirty=!1),b||(b=en()),mr(b,this.relativeTarget)),I&&(this.animationValues=d,KH(d,h,this.latestValues,D,P,R)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=D},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Ga(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Lt.update(()=>{Jp.hasAnimatedSinceResize=!0,this.currentAnimation=jH(0,rM,{...o,onUpdate:a=>{this.mixTargetDelta(a),o.onUpdate&&o.onUpdate(a)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(rM),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:a,target:u,layout:h,latestValues:d}=o;if(!(!a||!u||!h)){if(this!==o&&this.layout&&h&&sO(this.options.animationType,this.layout.layoutBox,h.layoutBox)){u=this.target||en();const g=Ji(this.layout.layoutBox.x);u.x.min=o.target.x.min,u.x.max=u.x.min+g;const m=Ji(this.layout.layoutBox.y);u.y.min=o.target.y.min,u.y.max=u.y.min+m}mr(a,u),Gc(a,d),wf(this.projectionDeltaWithTransform,this.layoutCorrected,a,d)}}registerSharedNode(o,a){this.sharedNodes.has(o)||this.sharedNodes.set(o,new JH),this.sharedNodes.get(o).add(a);const h=a.options.initialPromotionConfig;a.promote({transition:h?h.transition:void 0,preserveFollowOpacity:h&&h.shouldPreserveFollowOpacity?h.shouldPreserveFollowOpacity(a):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:a}=this.options;return a?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:a}=this.options;return a?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:a,preserveFollowOpacity:u}={}){const h=this.getStack();h&&h.promote(this,u),o&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let a=!1;const{latestValues:u}=o;if((u.z||u.rotate||u.rotateX||u.rotateY||u.rotateZ||u.skewX||u.skewY)&&(a=!0),!a)return;const h={};u.z&&W1("z",o,h,this.animationValues);for(let d=0;d<$1.length;d++)W1(`rotate${$1[d]}`,o,h,this.animationValues),W1(`skew${$1[d]}`,o,h,this.animationValues);o.render();for(const d in h)o.setStaticValue(d,h[d]),this.animationValues&&(this.animationValues[d]=h[d]);o.scheduleRender()}getProjectionStyles(o){var a,u;if(!this.instance||this.isSVG)return;if(!this.isVisible)return tX;const h={visibility:""},d=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,h.opacity="",h.pointerEvents=Zp(o?.pointerEvents)||"",h.transform=d?d(this.latestValues,""):"none",h;const g=this.getLead();if(!this.projectionDelta||!this.layout||!g.target){const I={};return this.options.layoutId&&(I.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,I.pointerEvents=Zp(o?.pointerEvents)||""),this.hasProjected&&!Cl(this.latestValues)&&(I.transform=d?d({},""):"none",this.hasProjected=!1),I}const m=g.animationValues||g.latestValues;this.applyTransformsToTarget(),h.transform=eX(this.projectionDeltaWithTransform,this.treeScale,m),d&&(h.transform=d(m,h.transform));const{x:v,y}=this.projectionDelta;h.transformOrigin=`${v.origin*100}% ${y.origin*100}% 0`,g.animationValues?h.opacity=g===this?(u=(a=m.opacity)!==null&&a!==void 0?a:this.latestValues.opacity)!==null&&u!==void 0?u:1:this.preserveOpacity?this.latestValues.opacity:m.opacityExit:h.opacity=g===this?m.opacity!==void 0?m.opacity:"":m.opacityExit!==void 0?m.opacityExit:0;for(const I in J0){if(m[I]===void 0)continue;const{correct:w,applyTo:R}=J0[I],P=h.transform==="none"?m[I]:w(m[I],g);if(R){const b=R.length;for(let L=0;L<b;L++)h[R[L]]=P}else h[I]=P}return this.options.layoutId&&(h.pointerEvents=g===this?Zp(o?.pointerEvents)||"":"none"),h}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var a;return(a=o.currentAnimation)===null||a===void 0?void 0:a.stop()}),this.root.nodes.forEach(sM),this.root.sharedNodes.clear()}}}function iX(n){n.updateLayout()}function rX(n){var e;const t=((e=n.resumeFrom)===null||e===void 0?void 0:e.snapshot)||n.snapshot;if(n.isLead()&&n.layout&&t&&n.hasListeners("didUpdate")){const{layoutBox:i,measuredBox:r}=n.layout,{animationType:s}=n.options,o=t.source!==n.layout.source;s==="size"?_r(g=>{const m=o?t.measuredBox[g]:t.layoutBox[g],v=Ji(m);m.min=i[g].min,m.max=m.min+v}):sO(s,t.layoutBox,i)&&_r(g=>{const m=o?t.measuredBox[g]:t.layoutBox[g],v=Ji(i[g]);m.max=m.min+v,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[g].max=n.relativeTarget[g].min+v)});const a=Vc();wf(a,i,t.layoutBox);const u=Vc();o?wf(u,n.applyTransform(r,!0),t.measuredBox):wf(u,i,t.layoutBox);const h=!tO(a);let d=!1;if(!n.resumeFrom){const g=n.getClosestProjectingParent();if(g&&!g.resumeFrom){const{snapshot:m,layout:v}=g;if(m&&v){const y=en();xf(y,t.layoutBox,m.layoutBox);const I=en();xf(I,i,v.layoutBox),nO(y,I)||(d=!0),g.options.layoutRoot&&(n.relativeTarget=I,n.relativeTargetOrigin=y,n.relativeParent=g)}}}n.notifyListeners("didUpdate",{layout:i,snapshot:t,delta:u,layoutDelta:a,hasLayoutChanged:h,hasRelativeTargetChanged:d})}else if(n.isLead()){const{onExitComplete:i}=n.options;i&&i()}n.options.transition=void 0}function sX(n){nf&&Ml.totalNodes++,n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function oX(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function aX(n){n.clearSnapshot()}function sM(n){n.clearMeasurements()}function lX(n){n.isLayoutDirty=!1}function uX(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function oM(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function cX(n){n.resolveTargetDelta()}function hX(n){n.calcProjection()}function dX(n){n.resetSkewAndRotation()}function fX(n){n.removeLeadSnapshot()}function aM(n,e,t){n.translate=$t(e.translate,0,t),n.scale=$t(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function lM(n,e,t,i){n.min=$t(e.min,t.min,i),n.max=$t(e.max,t.max,i)}function gX(n,e,t,i){lM(n.x,e.x,t.x,i),lM(n.y,e.y,t.y,i)}function mX(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const pX={duration:.45,ease:[.4,0,.1,1]},uM=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),cM=uM("applewebkit/")&&!uM("chrome/")?Math.round:Xi;function hM(n){n.min=cM(n.min),n.max=cM(n.max)}function _X(n){hM(n.x),hM(n.y)}function sO(n,e,t){return n==="position"||n==="preserve-aspect"&&!EH(nM(e),nM(t),.2)}function yX(n){var e;return n!==n.root&&((e=n.scroll)===null||e===void 0?void 0:e.wasRoot)}const vX=rO({attachResizeListener:(n,e)=>lg(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),K1={current:void 0},oO=rO({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!K1.current){const n=new vX({});n.mount(window),n.setOptions({layoutScroll:!0}),K1.current=n}return K1.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),EX={pan:{Feature:OH},drag:{Feature:NH,ProjectionNode:oO,MeasureLayout:QN}};function dM(n,e,t){const{props:i}=n;n.animationState&&i.whileHover&&n.animationState.setActive("whileHover",t==="Start");const r="onHover"+t,s=i[r];s&&Lt.postRender(()=>s(e,zg(e)))}class wX extends qa{mount(){const{current:e}=this.node;e&&(this.unmount=EK(e,t=>(dM(this.node,t,"Start"),i=>dM(this.node,i,"End"))))}unmount(){}}class xX extends qa{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Bg(lg(this.node.current,"focus",()=>this.onFocus()),lg(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function fM(n,e,t){const{props:i}=n;n.animationState&&i.whileTap&&n.animationState.setActive("whileTap",t==="Start");const r="onTap"+(t==="End"?"":t),s=i[r];s&&Lt.postRender(()=>s(e,zg(e)))}class TX extends qa{mount(){const{current:e}=this.node;e&&(this.unmount=IK(e,t=>(fM(this.node,t,"Start"),(i,{success:r})=>fM(this.node,i,r?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const Tw=new WeakMap,q1=new WeakMap,IX=n=>{const e=Tw.get(n.target);e&&e(n)},SX=n=>{n.forEach(IX)};function AX({root:n,...e}){const t=n||document;q1.has(t)||q1.set(t,{});const i=q1.get(t),r=JSON.stringify(e);return i[r]||(i[r]=new IntersectionObserver(SX,{root:n,...e})),i[r]}function RX(n,e,t){const i=AX(e);return Tw.set(n,t),i.observe(n),()=>{Tw.delete(n),i.unobserve(n)}}const PX={some:0,all:1};class CX extends qa{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:i,amount:r="some",once:s}=e,o={root:t?t.current:void 0,rootMargin:i,threshold:typeof r=="number"?r:PX[r]},a=u=>{const{isIntersecting:h}=u;if(this.isInView===h||(this.isInView=h,s&&!h&&this.hasEnteredView))return;h&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",h);const{onViewportEnter:d,onViewportLeave:g}=this.node.getProps(),m=h?d:g;m&&m(u)};return RX(this.node.current,o,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(MX(e,t))&&this.startObserver()}unmount(){}}function MX({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const bX={inView:{Feature:CX},tap:{Feature:TX},focus:{Feature:xX},hover:{Feature:wX}},kX={layout:{ProjectionNode:oO,MeasureLayout:QN}},Iw={current:null},aO={current:!1};function LX(){if(aO.current=!0,!!PT)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>Iw.current=n.matches;n.addListener(e),e()}else Iw.current=!1}const DX=[...kN,Hn,ja],NX=n=>DX.find(bN(n)),gM=new WeakMap;function OX(n,e,t){for(const i in e){const r=e[i],s=t[i];if(ei(r))n.addValue(i,r);else if(ei(s))n.addValue(i,og(r,{owner:n}));else if(s!==r)if(n.hasValue(i)){const o=n.getValue(i);o.liveStyle===!0?o.jump(r):o.hasAnimated||o.set(r)}else{const o=n.getStaticValue(i);n.addValue(i,og(o!==void 0?o:r,{owner:n}))}}for(const i in t)e[i]===void 0&&n.removeValue(i);return e}const mM=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class VX{scrapeMotionValuesFromProps(e,t,i){return{}}constructor({parent:e,props:t,presenceContext:i,reducedMotionConfig:r,blockInitialAnimation:s,visualState:o},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=tI,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const v=bs.now();this.renderScheduledAt<v&&(this.renderScheduledAt=v,Lt.render(this.render,!1,!0))};const{latestValues:u,renderState:h,onUpdate:d}=o;this.onUpdate=d,this.latestValues=u,this.baseTarget={...u},this.initialValues=t.initial?{...u}:{},this.renderState=h,this.parent=e,this.props=t,this.presenceContext=i,this.depth=e?e.depth+1:0,this.reducedMotionConfig=r,this.options=a,this.blockInitialAnimation=!!s,this.isControllingVariants=dy(t),this.isVariantNode=jD(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:g,...m}=this.scrapeMotionValuesFromProps(t,{},this);for(const v in m){const y=m[v];u[v]!==void 0&&ei(y)&&y.set(u[v],!1)}}mount(e){this.current=e,gM.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,i)=>this.bindToMotionValue(i,t)),aO.current||LX(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Iw.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){gM.delete(this.current),this.projection&&this.projection.unmount(),Ga(this.notifyUpdate),Ga(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const i=Su.has(e),r=t.on("change",a=>{this.latestValues[e]=a,this.props.onUpdate&&Lt.preRender(this.notifyUpdate),i&&this.projection&&(this.projection.isTransformDirty=!0)}),s=t.on("renderRequest",this.scheduleRender);let o;window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{r(),s(),o&&o(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in Ah){const t=Ah[e];if(!t)continue;const{isEnabled:i,Feature:r}=t;if(!this.features[e]&&r&&i(this.props)&&(this.features[e]=new r(this)),this.features[e]){const s=this.features[e];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):en()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let i=0;i<mM.length;i++){const r=mM[i];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const s="on"+r,o=e[s];o&&(this.propEventSubscriptions[r]=this.on(r,o))}this.prevMotionValues=OX(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const i=this.values.get(e);t!==i&&(i&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let i=this.values.get(e);return i===void 0&&t!==void 0&&(i=og(t===null?void 0:t,{owner:this}),this.addValue(e,i)),i}readValue(e,t){var i;let r=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(i=this.getBaseTargetFromProps(this.props,e))!==null&&i!==void 0?i:this.readValueFromInstance(this.current,e,this.options);return r!=null&&(typeof r=="string"&&(CN(r)||EN(r))?r=parseFloat(r):!NX(r)&&ja.test(t)&&(r=AN(e,t)),this.setBaseTarget(e,ei(r)?r.get():r)),ei(r)?r.get():r}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;const{initial:i}=this.props;let r;if(typeof i=="string"||typeof i=="object"){const o=NT(this.props,i,(t=this.presenceContext)===null||t===void 0?void 0:t.custom);o&&(r=o[e])}if(i&&r!==void 0)return r;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!ei(s)?s:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new XT),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}}class lO extends VX{constructor(){super(...arguments),this.KeyframeResolver=LN}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:i}){delete t[e],delete i[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;ei(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function FX(n){return window.getComputedStyle(n)}class GX extends lO{constructor(){super(...arguments),this.type="html",this.renderInstance=XD}readValueFromInstance(e,t){if(Su.has(t)){const i=eI(t);return i&&i.default||0}else{const i=FX(e),r=(KD(t)?i.getPropertyValue(t):i[t])||0;return typeof r=="string"?r.trim():r}}measureInstanceViewportBox(e,{transformPagePoint:t}){return YN(e,t)}build(e,t,i){FT(e,t,i.transformTemplate)}scrapeMotionValuesFromProps(e,t,i){return BT(e,t,i)}}class jX extends lO{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=en}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(Su.has(t)){const i=eI(t);return i&&i.default||0}return t=YD.has(t)?t:kT(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,i){return JD(e,t,i)}build(e,t,i){GT(e,t,this.isSVGTag,i.transformTemplate)}renderInstance(e,t,i,r){ZD(e,t,i,r)}mount(e){this.isSVGTag=UT(e.tagName),super.mount(e)}}const UX=(n,e)=>DT(n)?new jX(e):new GX(e,{allowProjection:n!==ne.Fragment}),BX=fK({...hH,...bX,...EX,...kX},UX),fi=PW(BX);const zX=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),$X=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,i)=>i?i.toUpperCase():t.toLowerCase()),pM=n=>{const e=$X(n);return e.charAt(0).toUpperCase()+e.slice(1)},uO=(...n)=>n.filter((e,t,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===t).join(" ").trim(),WX=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var KX={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const qX=ne.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:i,className:r="",children:s,iconNode:o,...a},u)=>ne.createElement("svg",{ref:u,...KX,width:e,height:e,stroke:n,strokeWidth:i?Number(t)*24/Number(e):t,className:uO("lucide",r),...!s&&!WX(a)&&{"aria-hidden":"true"},...a},[...o.map(([h,d])=>ne.createElement(h,d)),...Array.isArray(s)?s:[s]]));const ct=(n,e)=>{const t=ne.forwardRef(({className:i,...r},s)=>ne.createElement(qX,{ref:s,iconNode:e,className:uO(`lucide-${zX(pM(n))}`,`lucide-${n}`,i),...r}));return t.displayName=pM(n),t};const HX=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],XX=ct("arrow-left",HX);const YX=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],ZX=ct("arrow-right",YX);const QX=[["path",{d:"M7 17V7h10",key:"11bw93"}],["path",{d:"M17 17 7 7",key:"2786uv"}]],JX=ct("arrow-up-left",QX);const eY=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],tY=ct("arrow-up-right",eY);const nY=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],iY=ct("arrow-up",nY);const rY=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],sY=ct("check",rY);const oY=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],aY=ct("chevron-down",oY);const lY=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],uY=ct("chevron-right",lY);const cY=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],cO=ct("chevron-up",cY);const hY=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],dY=ct("circle-alert",hY);const fY=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],gY=ct("circle",fY);const mY=[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],pY=ct("compass",mY);const _Y=[["path",{d:"M20 20v-7a4 4 0 0 0-4-4H4",key:"1nkjon"}],["path",{d:"M9 14 4 9l5-5",key:"102s5s"}]],yY=ct("corner-up-left",_Y);const vY=[["path",{d:"m15 14 5-5-5-5",key:"12vg1m"}],["path",{d:"M4 20v-7a4 4 0 0 1 4-4h12",key:"1lu4f8"}]],EY=ct("corner-up-right",vY);const wY=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],xY=ct("folder-open",wY);const TY=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],IY=ct("folder",TY);const SY=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],AY=ct("info",SY);const RY=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],hO=ct("layers",RY);const PY=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],CY=ct("loader-circle",PY);const MY=[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],bY=ct("locate-fixed",MY);const kY=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],dO=ct("map-pin",kY);const LY=[["path",{d:"m8 3 4 8 5-5 5 15H2L8 3z",key:"otkl63"}]],DY=ct("mountain",LY);const NY=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],sI=ct("navigation",NY);const OY=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],Sw=ct("rotate-ccw",OY);const VY=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],fO=ct("search",VY);const FY=[["path",{d:"M10 5H3",key:"1qgfaw"}],["path",{d:"M12 19H3",key:"yhmn1j"}],["path",{d:"M14 3v4",key:"1sua03"}],["path",{d:"M16 17v4",key:"1q0r14"}],["path",{d:"M21 12h-9",key:"1o4lsq"}],["path",{d:"M21 19h-5",key:"1rlt1p"}],["path",{d:"M21 5h-7",key:"1oszz2"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M8 12H3",key:"a7s4jb"}]],GY=ct("sliders-horizontal",FY);const jY=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],UY=ct("target",jY);const BY=[["path",{d:"M13 8c0-2.76-2.46-5-5.5-5S2 5.24 2 8h2l1-1 1 1h4",key:"foxbe7"}],["path",{d:"M13 7.14A5.82 5.82 0 0 1 16.5 6c3.04 0 5.5 2.24 5.5 5h-3l-1-1-1 1h-3",key:"18arnh"}],["path",{d:"M5.89 9.71c-2.15 2.15-2.3 5.47-.35 7.43l4.24-4.25.7-.7.71-.71 2.12-2.12c-1.95-1.96-5.27-1.8-7.42.35",key:"ywahnh"}],["path",{d:"M11 15.5c.5 2.5-.17 4.5-1 6.5h4c2-5.5-.5-12-1-14",key:"ft0feo"}]],zY=ct("tree-palm",BY);const $Y=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],WY=ct("volume-2",$Y);const KY=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]],qY=ct("volume-x",KY);const HY=[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]],XY=ct("waves",HY);const YY=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Gh=ct("x",YY);function ZY(){const{tracking:n,startTracking:e,stopTracking:t,updatePosition:i,setWatchId:r,resetFirstFix:s}=Ot(),o=ne.useCallback(u=>{i(u)},[i]),a=ne.useCallback(u=>{console.error("GPS error:",u),alert(`GPS fout: ${u.message}`),t()},[t]);return ne.useEffect(()=>{if(!n)return;if(!navigator.geolocation){alert("Geolocation wordt niet ondersteund door deze browser"),t();return}const u=navigator.geolocation.watchPosition(o,a,{enableHighAccuracy:!0,maximumAge:1e3,timeout:15e3});return r(u),()=>{navigator.geolocation.clearWatch(u)}},[n,o,a,r,t]),{tracking:n,start:e,stop:t,toggle:()=>n?t():e()}}function QY(){const{tracking:n,toggle:e}=ZY();return V.jsx(fi.button,{className:`
        fixed bottom-[30px] md:bottom-10 right-2.5 z-[1000]
        w-11 h-11 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${n?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},animate:n?{scale:[1,1.02,1]}:{},transition:n?{scale:{duration:2,repeat:1/0,ease:"easeInOut"}}:{},"aria-label":n?"GPS tracking actief":"GPS tracking starten",title:n?"GPS tracking actief":"GPS tracking starten",children:V.jsx(bY,{size:22,strokeWidth:2})})}const _M="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40">
    <polygon points="20,4 32,32 20,26 8,32" fill="#4285F4" stroke="white" stroke-width="2.5" stroke-linejoin="round"/>
  </svg>`);function JY(){const n=Hi(w=>w.map),e=Hi(w=>w.rotation),t=Ot(w=>w.position),i=Ot(w=>w.accuracy),r=Ot(w=>w.tracking),s=Ot(w=>w.navigationMode),o=Ot(w=>w.smoothHeading),a=Ot(w=>w.firstFix),u=Ot(w=>w.resetFirstFix),h=Ot(w=>w.config.centerOnUser),d=Ot(w=>w.config.animationDuration),g=ne.useRef(null),m=ne.useRef(null),v=ne.useRef(null),y=ne.useRef(0),I=ne.useMemo(()=>new qi({image:new _0({src:_M,scale:1,rotation:0,rotateWithView:!1,anchor:[.5,.5]})}),[]);return ne.useEffect(()=>{if(!n||!r&&!t)return;const w=Jl([5.1214,52.0907]);return g.current=new s0({geometry:new d0(w)}),g.current.setStyle(I),m.current=new s0({geometry:new d0(w)}),v.current=new t4({source:new Fb({features:[m.current,g.current]}),zIndex:1e3}),n.addLayer(v.current),()=>{v.current&&n&&n.removeLayer(v.current)}},[n,r,t,I]),ne.useEffect(()=>{if(!n||!t||!g.current||!m.current)return;const w=Jl([t.lng,t.lat]);if(g.current.getGeometry()?.setCoordinates(w),m.current.getGeometry()?.setCoordinates(w),i){const R=n.getView().getResolution()||1,P=i/R;m.current.setStyle(new qi({image:new Ch({radius:Math.min(P,100),fill:new ka({color:"rgba(66, 133, 244, 0.1)"})})}))}a&&r&&(n.getView().setCenter(w),n.getView().setZoom(17),u(),console.log(" GPS locked - jumped to position + street level")),r&&h&&!a&&n.getView().animate({center:w,duration:d})},[n,r,t,i,a,u,h,d]),ne.useEffect(()=>{if(!n||!g.current)return;const R=n.getView().getRotation();let P;s==="free"?P=o!==null?o*Math.PI/180:0:P=-R;const b=5*Math.PI/180;let L=P-y.current;L>Math.PI&&(L-=2*Math.PI),L<-Math.PI&&(L+=2*Math.PI),!(Math.abs(L)<b)&&(y.current=P,g.current.setStyle(new qi({image:new _0({src:_M,scale:1,rotation:P,rotateWithView:!1,anchor:[.5,.5]})})))},[n,s,o,e]),null}function eZ(){const n=RE(t=>t.layerControlOpen),e=RE(t=>t.toggleLayerControl);return V.jsx(fi.button,{className:`
        fixed bottom-[85px] md:bottom-[95px] right-2.5 z-[1000]
        w-11 h-11 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${n?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":n?"Kaartlagen sluiten":"Kaartlagen openen",title:n?"Kaartlagen sluiten":"Kaartlagen openen",children:V.jsx(hO,{size:22,strokeWidth:2})})}function pr({title:n,children:e,defaultExpanded:t=!0}){const[i,r]=ne.useState(t);return V.jsxs("div",{className:"mb-0.5",children:[V.jsxs("button",{onClick:()=>r(!i),className:"w-full flex items-center gap-1 py-1 px-1 bg-transparent border-0 outline-none hover:bg-blue-100 transition-colors text-left",children:[V.jsx(fi.span,{animate:{rotate:i?90:0},transition:{duration:.15},className:"text-gray-400",children:V.jsx(uY,{size:14})}),i?V.jsx(xY,{size:16,className:"text-blue-500"}):V.jsx(IY,{size:16,className:"text-blue-500"}),V.jsx("span",{className:"text-sm text-gray-700 font-medium",children:n})]}),V.jsx(Ka,{initial:!1,children:i&&V.jsx(fi.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.15},style:{overflow:"hidden"},className:"ml-5",children:e})})]})}function Ne({name:n,type:e}){const t=oo(d=>d.visible[n]),i=oo(d=>d.loadingState[n]),r=oo(d=>d.toggleLayer),s=oo(d=>d.setLayerVisibility),o=i==="loading",a=i==="error",u=()=>{o||(e==="overlay"?r(n):["CartoDB (licht)","OpenStreetMap","Google Hybride","TMK 1850","Bonnebladen 1900"].forEach(g=>{s(g,g===n)}))},h=t??!1;return V.jsxs("button",{onClick:u,disabled:o,className:`w-full flex items-center justify-between py-1 pl-3 pr-2 bg-transparent border-0 outline-none transition-colors text-left ${o?"opacity-70 cursor-wait":"hover:bg-blue-100"}`,children:[V.jsxs("span",{className:`text-sm ${a?"text-red-500":"text-gray-600"}`,children:[n,a&&V.jsx(dY,{size:12,className:"inline ml-1 text-red-500"})]}),V.jsx("div",{className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:o?"#93c5fd":h?"#3b82f6":"white",border:o?"2px solid #93c5fd":h?"2px solid #3b82f6":"2px solid #60a5fa",color:"white"},children:o?V.jsx(CY,{size:10,strokeWidth:3,className:"animate-spin"}):h?V.jsx(sY,{size:12,strokeWidth:3}):null})]})}function tZ(){const{layerControlOpen:n,toggleLayerControl:e}=RE();return V.jsx(Ka,{children:n&&V.jsxs(fi.div,{className:"fixed top-2.5 right-2.5 z-[999] bg-white rounded-lg shadow-lg overflow-hidden w-[280px] max-h-[calc(100vh-220px)] flex flex-col",initial:{opacity:0,scale:.95,y:-10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-10},transition:{duration:.15},children:[V.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-gradient-to-r from-blue-500 to-blue-600 text-white",children:[V.jsx("span",{className:"font-medium text-sm",children:"Kaartlagen"}),V.jsx("button",{onClick:e,className:"p-0.5 rounded border-0 outline-none hover:bg-white/20 transition-colors",children:V.jsx(Gh,{size:16})})]}),V.jsxs("div",{className:"p-2 overflow-y-auto flex-1",children:[V.jsxs(pr,{title:"Achtergrond",defaultExpanded:!1,children:[V.jsx(Ne,{name:"CartoDB (licht)",type:"base"}),V.jsx(Ne,{name:"OpenStreetMap",type:"base"}),V.jsx(Ne,{name:"Luchtfoto (PDOK)",type:"base"}),V.jsx(Ne,{name:"TMK 1850",type:"base"}),V.jsx(Ne,{name:"Bonnebladen 1900",type:"base"})]}),V.jsxs(pr,{title:"Steentijd & Prehistorie",defaultExpanded:!1,children:[V.jsx(Ne,{name:"Hunebedden",type:"overlay"}),V.jsx(Ne,{name:"FAMKE Steentijd",type:"overlay"}),V.jsx(Ne,{name:"Grafheuvels",type:"overlay"}),V.jsx(Ne,{name:"Terpen",type:"overlay"})]}),V.jsxs(pr,{title:"Archeologische lagen",defaultExpanded:!1,children:[V.jsx(Ne,{name:"AMK Monumenten",type:"overlay"}),V.jsx(Ne,{name:"Romeinse wegen",type:"overlay"}),V.jsx(Ne,{name:"Kastelen",type:"overlay"}),V.jsx(Ne,{name:"IKAW",type:"overlay"}),V.jsx(Ne,{name:"Archeo Landschappen",type:"overlay"})]}),V.jsxs(pr,{title:"Erfgoed & Monumenten",defaultExpanded:!1,children:[V.jsx(Ne,{name:"Rijksmonumenten",type:"overlay"}),V.jsx(Ne,{name:"Werelderfgoed",type:"overlay"})]}),V.jsxs(pr,{title:"WOII & Militair",defaultExpanded:!1,children:[V.jsx(Ne,{name:"WWII Bunkers",type:"overlay"}),V.jsx(Ne,{name:"Slagvelden",type:"overlay"}),V.jsx(Ne,{name:"Militaire Vliegvelden",type:"overlay"}),V.jsx(Ne,{name:"Verdedigingslinies",type:"overlay"}),V.jsx(Ne,{name:"Militaire Objecten",type:"overlay"}),V.jsx(Ne,{name:"Inundatiegebieden",type:"overlay"})]}),V.jsxs(pr,{title:"Paleokaarten (tijdreizen)",defaultExpanded:!1,children:[V.jsx(Ne,{name:"Paleokaart 800 n.Chr.",type:"overlay"}),V.jsx(Ne,{name:"Paleokaart 100 n.Chr.",type:"overlay"}),V.jsx(Ne,{name:"Paleokaart 500 v.Chr.",type:"overlay"}),V.jsx(Ne,{name:"Paleokaart 1500 v.Chr.",type:"overlay"}),V.jsx(Ne,{name:"Paleokaart 2750 v.Chr.",type:"overlay"}),V.jsx(Ne,{name:"Paleokaart 5500 v.Chr.",type:"overlay"}),V.jsx(Ne,{name:"Paleokaart 9000 v.Chr.",type:"overlay"})]}),V.jsx(pr,{title:"Religieus Erfgoed",defaultExpanded:!1,children:V.jsx(Ne,{name:"Religieus Erfgoed",type:"overlay"})}),V.jsxs(pr,{title:"Uiterwaarden (UIKAV)",defaultExpanded:!1,children:[V.jsx(Ne,{name:"UIKAV Punten",type:"overlay"}),V.jsx(Ne,{name:"UIKAV Vlakken",type:"overlay"}),V.jsx(Ne,{name:"UIKAV Expert",type:"overlay"}),V.jsx(Ne,{name:"UIKAV Buffer",type:"overlay"}),V.jsx(Ne,{name:"UIKAV Indeling",type:"overlay"})]}),V.jsxs(pr,{title:"Hillshade & LiDAR",defaultExpanded:!1,children:[V.jsx(Ne,{name:"AHN4 Hillshade NL",type:"overlay"}),V.jsx(Ne,{name:"AHN4 Multi-Hillshade NL",type:"overlay"}),V.jsx(Ne,{name:"AHN4 Helling NL",type:"overlay"}),V.jsx(Ne,{name:"AHN 0.5m",type:"overlay"}),V.jsx(Ne,{name:"World Hillshade",type:"overlay"})]}),V.jsxs(pr,{title:"Terrein & Bodem",defaultExpanded:!1,children:[V.jsx(Ne,{name:"Veengebieden",type:"overlay"}),V.jsx(Ne,{name:"Geomorfologie",type:"overlay"}),V.jsx(Ne,{name:"Bodemkaart",type:"overlay"})]}),V.jsxs(pr,{title:"Fossielen (vondsten)",defaultExpanded:!1,children:[V.jsx(Ne,{name:"Fossielen Nederland",type:"overlay"}),V.jsx(Ne,{name:"Fossielen Belgi",type:"overlay"}),V.jsx(Ne,{name:"Fossielen Duitsland",type:"overlay"}),V.jsx(Ne,{name:"Fossielen Frankrijk",type:"overlay"})]}),V.jsxs(pr,{title:"Recreatie",defaultExpanded:!1,children:[V.jsx(Ne,{name:"Parken",type:"overlay"}),V.jsx(Ne,{name:"Speeltuinen",type:"overlay"}),V.jsx(Ne,{name:"Musea",type:"overlay"}),V.jsx(Ne,{name:"Strandjes",type:"overlay"})]})]})]})})}function nZ(n){n("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),n("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),n("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs");for(var e=1;e<=60;++e)n("EPSG:"+(32600+e),"+proj=utm +zone="+e+" +datum=WGS84 +units=m"),n("EPSG:"+(32700+e),"+proj=utm +zone="+e+" +south +datum=WGS84 +units=m");n("EPSG:5041","+title=WGS 84 / UPS North (E,N) +proj=stere +lat_0=90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m"),n("EPSG:5042","+title=WGS 84 / UPS South (E,N) +proj=stere +lat_0=-90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m"),n.WGS84=n["EPSG:4326"],n["EPSG:3785"]=n["EPSG:3857"],n.GOOGLE=n["EPSG:3857"],n["EPSG:900913"]=n["EPSG:3857"],n["EPSG:102113"]=n["EPSG:3857"]}var mu=1,pu=2,th=3,iZ=4,Aw=5,yM=6378137,rZ=6356752314e-3,vM=.0066943799901413165,Tf=484813681109536e-20,se=Math.PI/2,sZ=.16666666666666666,oZ=.04722222222222222,aZ=.022156084656084655,ge=1e-10,qt=.017453292519943295,ki=57.29577951308232,mt=Math.PI/4,ug=Math.PI*2,nn=3.14159265359,Li={};Li.greenwich=0;Li.lisbon=-9.131906111111;Li.paris=2.337229166667;Li.bogota=-74.080916666667;Li.madrid=-3.687938888889;Li.rome=12.452333333333;Li.bern=7.439583333333;Li.jakarta=106.807719444444;Li.ferro=-17.666666666667;Li.brussels=4.367975;Li.stockholm=18.058277777778;Li.athens=23.7163375;Li.oslo=10.722916666667;const lZ={mm:{to_meter:.001},cm:{to_meter:.01},ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937},fath:{to_meter:1.8288},kmi:{to_meter:1852},"us-ch":{to_meter:20.1168402336805},"us-mi":{to_meter:1609.34721869444},km:{to_meter:1e3},"ind-ft":{to_meter:.30479841},"ind-yd":{to_meter:.91439523},mi:{to_meter:1609.344},yd:{to_meter:.9144},ch:{to_meter:20.1168},link:{to_meter:.201168},dm:{to_meter:.1},in:{to_meter:.0254},"ind-ch":{to_meter:20.11669506},"us-in":{to_meter:.025400050800101},"us-yd":{to_meter:.914401828803658}};var EM=/[\s_\-\/\(\)]/g;function Ua(n,e){if(n[e])return n[e];for(var t=Object.keys(n),i=e.toLowerCase().replace(EM,""),r=-1,s,o;++r<t.length;)if(s=t[r],o=s.toLowerCase().replace(EM,""),o===i)return n[s]}function Rw(n){var e={},t=n.split("+").map(function(a){return a.trim()}).filter(function(a){return a}).reduce(function(a,u){var h=u.split("=");return h.push(!0),a[h[0].toLowerCase()]=h[1],a},{}),i,r,s,o={proj:"projName",datum:"datumCode",rf:function(a){e.rf=parseFloat(a)},lat_0:function(a){e.lat0=a*qt},lat_1:function(a){e.lat1=a*qt},lat_2:function(a){e.lat2=a*qt},lat_ts:function(a){e.lat_ts=a*qt},lon_0:function(a){e.long0=a*qt},lon_1:function(a){e.long1=a*qt},lon_2:function(a){e.long2=a*qt},alpha:function(a){e.alpha=parseFloat(a)*qt},gamma:function(a){e.rectified_grid_angle=parseFloat(a)*qt},lonc:function(a){e.longc=a*qt},x_0:function(a){e.x0=parseFloat(a)},y_0:function(a){e.y0=parseFloat(a)},k_0:function(a){e.k0=parseFloat(a)},k:function(a){e.k0=parseFloat(a)},a:function(a){e.a=parseFloat(a)},b:function(a){e.b=parseFloat(a)},r:function(a){e.a=e.b=parseFloat(a)},r_a:function(){e.R_A=!0},zone:function(a){e.zone=parseInt(a,10)},south:function(){e.utmSouth=!0},towgs84:function(a){e.datum_params=a.split(",").map(function(u){return parseFloat(u)})},to_meter:function(a){e.to_meter=parseFloat(a)},units:function(a){e.units=a;var u=Ua(lZ,a);u&&(e.to_meter=u.to_meter)},from_greenwich:function(a){e.from_greenwich=a*qt},pm:function(a){var u=Ua(Li,a);e.from_greenwich=(u||parseFloat(a))*qt},nadgrids:function(a){a==="@null"?e.datumCode="none":e.nadgrids=a},axis:function(a){var u="ewnsud";a.length===3&&u.indexOf(a.substr(0,1))!==-1&&u.indexOf(a.substr(1,1))!==-1&&u.indexOf(a.substr(2,1))!==-1&&(e.axis=a)},approx:function(){e.approx=!0},over:function(){e.over=!0}};for(i in t)r=t[i],i in o?(s=o[i],typeof s=="function"?s(r):e[s]=r):e[i]=r;return typeof e.datumCode=="string"&&e.datumCode!=="WGS84"&&(e.datumCode=e.datumCode.toLowerCase()),e.projStr=n,e}class gO{static getId(e){const t=e.find(i=>Array.isArray(i)&&i[0]==="ID");return t&&t.length>=3?{authority:t[1],code:parseInt(t[2],10)}:null}static convertUnit(e,t="unit"){if(!e||e.length<3)return{type:t,name:"unknown",conversion_factor:null};const i=e[1],r=parseFloat(e[2])||null,s=e.find(a=>Array.isArray(a)&&a[0]==="ID"),o=s?{authority:s[1],code:parseInt(s[2],10)}:null;return{type:t,name:i,conversion_factor:r,id:o}}static convertAxis(e){const t=e[1]||"Unknown";let i;const r=t.match(/^\((.)\)$/);if(r){const h=r[1].toUpperCase();if(h==="E")i="east";else if(h==="N")i="north";else if(h==="U")i="up";else throw new Error(`Unknown axis abbreviation: ${h}`)}else i=e[2]?e[2].toLowerCase():"unknown";const s=e.find(h=>Array.isArray(h)&&h[0]==="ORDER"),o=s?parseInt(s[1],10):null,a=e.find(h=>Array.isArray(h)&&(h[0]==="LENGTHUNIT"||h[0]==="ANGLEUNIT"||h[0]==="SCALEUNIT")),u=this.convertUnit(a);return{name:t,direction:i,unit:u,order:o}}static extractAxes(e){return e.filter(t=>Array.isArray(t)&&t[0]==="AXIS").map(t=>this.convertAxis(t)).sort((t,i)=>(t.order||0)-(i.order||0))}static convert(e,t={}){switch(e[0]){case"PROJCRS":t.type="ProjectedCRS",t.name=e[1],t.base_crs=e.find(m=>Array.isArray(m)&&m[0]==="BASEGEOGCRS")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="BASEGEOGCRS")):null,t.conversion=e.find(m=>Array.isArray(m)&&m[0]==="CONVERSION")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="CONVERSION")):null;const i=e.find(m=>Array.isArray(m)&&m[0]==="CS");i&&(t.coordinate_system={type:i[1],axis:this.extractAxes(e)});const r=e.find(m=>Array.isArray(m)&&m[0]==="LENGTHUNIT");if(r){const m=this.convertUnit(r);t.coordinate_system.unit=m}t.id=this.getId(e);break;case"BASEGEOGCRS":case"GEOGCRS":t.type="GeographicCRS",t.name=e[1];const s=e.find(m=>Array.isArray(m)&&(m[0]==="DATUM"||m[0]==="ENSEMBLE"));if(s){const m=this.convert(s);s[0]==="ENSEMBLE"?t.datum_ensemble=m:t.datum=m;const v=e.find(y=>Array.isArray(y)&&y[0]==="PRIMEM");v&&v[1]!=="Greenwich"&&(m.prime_meridian={name:v[1],longitude:parseFloat(v[2])})}t.coordinate_system={type:"ellipsoidal",axis:this.extractAxes(e)},t.id=this.getId(e);break;case"DATUM":t.type="GeodeticReferenceFrame",t.name=e[1],t.ellipsoid=e.find(m=>Array.isArray(m)&&m[0]==="ELLIPSOID")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="ELLIPSOID")):null;break;case"ENSEMBLE":t.type="DatumEnsemble",t.name=e[1],t.members=e.filter(m=>Array.isArray(m)&&m[0]==="MEMBER").map(m=>({type:"DatumEnsembleMember",name:m[1],id:this.getId(m)}));const o=e.find(m=>Array.isArray(m)&&m[0]==="ENSEMBLEACCURACY");o&&(t.accuracy=parseFloat(o[1]));const a=e.find(m=>Array.isArray(m)&&m[0]==="ELLIPSOID");a&&(t.ellipsoid=this.convert(a)),t.id=this.getId(e);break;case"ELLIPSOID":t.type="Ellipsoid",t.name=e[1],t.semi_major_axis=parseFloat(e[2]),t.inverse_flattening=parseFloat(e[3]),e.find(m=>Array.isArray(m)&&m[0]==="LENGTHUNIT")&&this.convert(e.find(m=>Array.isArray(m)&&m[0]==="LENGTHUNIT"),t);break;case"CONVERSION":t.type="Conversion",t.name=e[1],t.method=e.find(m=>Array.isArray(m)&&m[0]==="METHOD")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="METHOD")):null,t.parameters=e.filter(m=>Array.isArray(m)&&m[0]==="PARAMETER").map(m=>this.convert(m));break;case"METHOD":t.type="Method",t.name=e[1],t.id=this.getId(e);break;case"PARAMETER":t.type="Parameter",t.name=e[1],t.value=parseFloat(e[2]),t.unit=this.convertUnit(e.find(m=>Array.isArray(m)&&(m[0]==="LENGTHUNIT"||m[0]==="ANGLEUNIT"||m[0]==="SCALEUNIT"))),t.id=this.getId(e);break;case"BOUNDCRS":t.type="BoundCRS";const u=e.find(m=>Array.isArray(m)&&m[0]==="SOURCECRS");if(u){const m=u.find(v=>Array.isArray(v));t.source_crs=m?this.convert(m):null}const h=e.find(m=>Array.isArray(m)&&m[0]==="TARGETCRS");if(h){const m=h.find(v=>Array.isArray(v));t.target_crs=m?this.convert(m):null}const d=e.find(m=>Array.isArray(m)&&m[0]==="ABRIDGEDTRANSFORMATION");d?t.transformation=this.convert(d):t.transformation=null;break;case"ABRIDGEDTRANSFORMATION":if(t.type="Transformation",t.name=e[1],t.method=e.find(m=>Array.isArray(m)&&m[0]==="METHOD")?this.convert(e.find(m=>Array.isArray(m)&&m[0]==="METHOD")):null,t.parameters=e.filter(m=>Array.isArray(m)&&(m[0]==="PARAMETER"||m[0]==="PARAMETERFILE")).map(m=>{if(m[0]==="PARAMETER")return this.convert(m);if(m[0]==="PARAMETERFILE")return{name:m[1],value:m[2],id:{authority:"EPSG",code:8656}}}),t.parameters.length===7){const m=t.parameters[6];m.name==="Scale difference"&&(m.value=Math.round((m.value-1)*1e12)/1e6)}t.id=this.getId(e);break;case"AXIS":t.coordinate_system||(t.coordinate_system={type:"unspecified",axis:[]}),t.coordinate_system.axis.push(this.convertAxis(e));break;case"LENGTHUNIT":const g=this.convertUnit(e,"LinearUnit");t.coordinate_system&&t.coordinate_system.axis&&t.coordinate_system.axis.forEach(m=>{m.unit||(m.unit=g)}),g.conversion_factor&&g.conversion_factor!==1&&t.semi_major_axis&&(t.semi_major_axis={value:t.semi_major_axis,unit:g});break;default:t.keyword=e[0];break}return t}}class uZ extends gO{static convert(e,t={}){return super.convert(e,t),t.coordinate_system&&t.coordinate_system.subtype==="Cartesian"&&delete t.coordinate_system,t.usage&&delete t.usage,t}}class cZ extends gO{static convert(e,t={}){super.convert(e,t);const i=e.find(s=>Array.isArray(s)&&s[0]==="CS");i&&(t.coordinate_system={subtype:i[1],axis:this.extractAxes(e)});const r=e.find(s=>Array.isArray(s)&&s[0]==="USAGE");if(r){const s=r.find(u=>Array.isArray(u)&&u[0]==="SCOPE"),o=r.find(u=>Array.isArray(u)&&u[0]==="AREA"),a=r.find(u=>Array.isArray(u)&&u[0]==="BBOX");t.usage={},s&&(t.usage.scope=s[1]),o&&(t.usage.area=o[1]),a&&(t.usage.bbox=a.slice(1))}return t}}function hZ(n){return n.find(e=>Array.isArray(e)&&e[0]==="USAGE")?"2019":(n.find(e=>Array.isArray(e)&&e[0]==="CS")||n[0]==="BOUNDCRS"||n[0]==="PROJCRS"||n[0]==="GEOGCRS","2015")}function dZ(n){return(hZ(n)==="2019"?cZ:uZ).convert(n)}function fZ(n){const e=n.toUpperCase();return e.includes("PROJCRS")||e.includes("GEOGCRS")||e.includes("BOUNDCRS")||e.includes("VERTCRS")||e.includes("LENGTHUNIT")||e.includes("ANGLEUNIT")||e.includes("SCALEUNIT")?"WKT2":(e.includes("PROJCS")||e.includes("GEOGCS")||e.includes("LOCAL_CS")||e.includes("VERT_CS")||e.includes("UNIT"),"WKT1")}var cg=1,mO=2,pO=3,s_=4,_O=5,oI=-1,gZ=/\s/,mZ=/[A-Za-z]/,pZ=/[A-Za-z84_]/,my=/[,\]]/,yO=/[\d\.E\-\+]/;function Po(n){if(typeof n!="string")throw new Error("not a string");this.text=n.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=cg}Po.prototype.readCharicter=function(){var n=this.text[this.place++];if(this.state!==s_)for(;gZ.test(n);){if(this.place>=this.text.length)return;n=this.text[this.place++]}switch(this.state){case cg:return this.neutral(n);case mO:return this.keyword(n);case s_:return this.quoted(n);case _O:return this.afterquote(n);case pO:return this.number(n);case oI:return}};Po.prototype.afterquote=function(n){if(n==='"'){this.word+='"',this.state=s_;return}if(my.test(n)){this.word=this.word.trim(),this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in afterquote yet, index '+this.place)};Po.prototype.afterItem=function(n){if(n===","){this.word!==null&&this.currentObject.push(this.word),this.word=null,this.state=cg;return}if(n==="]"){this.level--,this.word!==null&&(this.currentObject.push(this.word),this.word=null),this.state=cg,this.currentObject=this.stack.pop(),this.currentObject||(this.state=oI);return}};Po.prototype.number=function(n){if(yO.test(n)){this.word+=n;return}if(my.test(n)){this.word=parseFloat(this.word),this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in number yet, index '+this.place)};Po.prototype.quoted=function(n){if(n==='"'){this.state=_O;return}this.word+=n};Po.prototype.keyword=function(n){if(pZ.test(n)){this.word+=n;return}if(n==="["){var e=[];e.push(this.word),this.level++,this.root===null?this.root=e:this.currentObject.push(e),this.stack.push(this.currentObject),this.currentObject=e,this.state=cg;return}if(my.test(n)){this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in keyword yet, index '+this.place)};Po.prototype.neutral=function(n){if(mZ.test(n)){this.word=n,this.state=mO;return}if(n==='"'){this.word="",this.state=s_;return}if(yO.test(n)){this.word=n,this.state=pO;return}if(my.test(n)){this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in neutral yet, index '+this.place)};Po.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===oI)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function _Z(n){var e=new Po(n);return e.output()}function H1(n,e,t){Array.isArray(e)&&(t.unshift(e),e=null);var i=e?{}:n,r=t.reduce(function(s,o){return jc(o,s),s},i);e&&(n[e]=r)}function jc(n,e){if(!Array.isArray(n)){e[n]=!0;return}var t=n.shift();if(t==="PARAMETER"&&(t=n.shift()),n.length===1){if(Array.isArray(n[0])){e[t]={},jc(n[0],e[t]);return}e[t]=n[0];return}if(!n.length){e[t]=!0;return}if(t==="TOWGS84"){e[t]=n;return}if(t==="AXIS"){t in e||(e[t]=[]),e[t].push(n);return}Array.isArray(t)||(e[t]={});var i;switch(t){case"UNIT":case"PRIMEM":case"VERT_DATUM":e[t]={name:n[0].toLowerCase(),convert:n[1]},n.length===3&&jc(n[2],e[t]);return;case"SPHEROID":case"ELLIPSOID":e[t]={name:n[0],a:n[1],rf:n[2]},n.length===4&&jc(n[3],e[t]);return;case"EDATUM":case"ENGINEERINGDATUM":case"LOCAL_DATUM":case"DATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":n[0]=["name",n[0]],H1(e,t,n);return;case"COMPD_CS":case"COMPOUNDCRS":case"FITTED_CS":case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"ENGCRS":case"ENGINEERINGCRS":n[0]=["name",n[0]],H1(e,t,n),e[t].type=t;return;default:for(i=-1;++i<n.length;)if(!Array.isArray(n[i]))return jc(n,e[t]);return H1(e,t,n)}}var yZ=.017453292519943295;function jr(n){return n*yZ}function vO(n){const e=(n.projName||"").toLowerCase().replace(/_/g," ");!n.long0&&n.longc&&(e==="albers conic equal area"||e==="lambert azimuthal equal area")&&(n.long0=n.longc),!n.lat_ts&&n.lat1&&(e==="stereographic south pole"||e==="polar stereographic (variant b)")?(n.lat0=jr(n.lat1>0?90:-90),n.lat_ts=n.lat1,delete n.lat1):!n.lat_ts&&n.lat0&&(e==="polar stereographic"||e==="polar stereographic (variant a)")&&(n.lat_ts=n.lat0,n.lat0=jr(n.lat0>0?90:-90),delete n.lat1)}function wM(n){let e={units:null,to_meter:void 0};return typeof n=="string"?(e.units=n.toLowerCase(),e.units==="metre"&&(e.units="meter"),e.units==="meter"&&(e.to_meter=1)):n&&n.name&&(e.units=n.name.toLowerCase(),e.units==="metre"&&(e.units="meter"),e.to_meter=n.conversion_factor),e}function xM(n){return typeof n=="object"?n.value*n.unit.conversion_factor:n}function TM(n,e){n.ellipsoid.radius?(e.a=n.ellipsoid.radius,e.rf=0):(e.a=xM(n.ellipsoid.semi_major_axis),n.ellipsoid.inverse_flattening!==void 0?e.rf=n.ellipsoid.inverse_flattening:n.ellipsoid.semi_major_axis!==void 0&&n.ellipsoid.semi_minor_axis!==void 0&&(e.rf=e.a/(e.a-xM(n.ellipsoid.semi_minor_axis))))}function o_(n,e={}){return!n||typeof n!="object"?n:n.type==="BoundCRS"?(o_(n.source_crs,e),n.transformation&&(n.transformation.method&&n.transformation.method.name==="NTv2"?e.nadgrids=n.transformation.parameters[0].value:e.datum_params=n.transformation.parameters.map(t=>t.value)),e):(Object.keys(n).forEach(t=>{const i=n[t];if(i!==null)switch(t){case"name":if(e.srsCode)break;e.name=i,e.srsCode=i;break;case"type":i==="GeographicCRS"?e.projName="longlat":i==="ProjectedCRS"&&n.conversion&&n.conversion.method&&(e.projName=n.conversion.method.name);break;case"datum":case"datum_ensemble":i.ellipsoid&&(e.ellps=i.ellipsoid.name,TM(i,e)),i.prime_meridian&&(e.from_greenwich=i.prime_meridian.longitude*Math.PI/180);break;case"ellipsoid":e.ellps=i.name,TM(i,e);break;case"prime_meridian":e.long0=(i.longitude||0)*Math.PI/180;break;case"coordinate_system":if(i.axis){if(e.axis=i.axis.map(r=>{const s=r.direction;if(s==="east")return"e";if(s==="north")return"n";if(s==="west")return"w";if(s==="south")return"s";throw new Error(`Unknown axis direction: ${s}`)}).join("")+"u",i.unit){const{units:r,to_meter:s}=wM(i.unit);e.units=r,e.to_meter=s}else if(i.axis[0]&&i.axis[0].unit){const{units:r,to_meter:s}=wM(i.axis[0].unit);e.units=r,e.to_meter=s}}break;case"id":i.authority&&i.code&&(e.title=i.authority+":"+i.code);break;case"conversion":i.method&&i.method.name&&(e.projName=i.method.name),i.parameters&&i.parameters.forEach(r=>{const s=r.name.toLowerCase().replace(/\s+/g,"_"),o=r.value;r.unit&&r.unit.conversion_factor?e[s]=o*r.unit.conversion_factor:r.unit==="degree"?e[s]=o*Math.PI/180:e[s]=o});break;case"unit":i.name&&(e.units=i.name.toLowerCase(),e.units==="metre"&&(e.units="meter")),i.conversion_factor&&(e.to_meter=i.conversion_factor);break;case"base_crs":o_(i,e),e.datumCode=i.id?i.id.authority+"_"+i.id.code:i.name;break}}),e.latitude_of_false_origin!==void 0&&(e.lat0=e.latitude_of_false_origin),e.longitude_of_false_origin!==void 0&&(e.long0=e.longitude_of_false_origin),e.latitude_of_standard_parallel!==void 0&&(e.lat0=e.latitude_of_standard_parallel,e.lat1=e.latitude_of_standard_parallel),e.latitude_of_1st_standard_parallel!==void 0&&(e.lat1=e.latitude_of_1st_standard_parallel),e.latitude_of_2nd_standard_parallel!==void 0&&(e.lat2=e.latitude_of_2nd_standard_parallel),e.latitude_of_projection_centre!==void 0&&(e.lat0=e.latitude_of_projection_centre),e.longitude_of_projection_centre!==void 0&&(e.longc=e.longitude_of_projection_centre),e.easting_at_false_origin!==void 0&&(e.x0=e.easting_at_false_origin),e.northing_at_false_origin!==void 0&&(e.y0=e.northing_at_false_origin),e.latitude_of_natural_origin!==void 0&&(e.lat0=e.latitude_of_natural_origin),e.longitude_of_natural_origin!==void 0&&(e.long0=e.longitude_of_natural_origin),e.longitude_of_origin!==void 0&&(e.long0=e.longitude_of_origin),e.false_easting!==void 0&&(e.x0=e.false_easting),e.easting_at_projection_centre&&(e.x0=e.easting_at_projection_centre),e.false_northing!==void 0&&(e.y0=e.false_northing),e.northing_at_projection_centre&&(e.y0=e.northing_at_projection_centre),e.standard_parallel_1!==void 0&&(e.lat1=e.standard_parallel_1),e.standard_parallel_2!==void 0&&(e.lat2=e.standard_parallel_2),e.scale_factor_at_natural_origin!==void 0&&(e.k0=e.scale_factor_at_natural_origin),e.scale_factor_at_projection_centre!==void 0&&(e.k0=e.scale_factor_at_projection_centre),e.scale_factor_on_pseudo_standard_parallel!==void 0&&(e.k0=e.scale_factor_on_pseudo_standard_parallel),e.azimuth!==void 0&&(e.alpha=e.azimuth),e.azimuth_at_projection_centre!==void 0&&(e.alpha=e.azimuth_at_projection_centre),e.angle_from_rectified_to_skew_grid&&(e.rectified_grid_angle=e.angle_from_rectified_to_skew_grid),vO(e),e)}var vZ=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function EZ(n,e){var t=e[0],i=e[1];!(t in n)&&i in n&&(n[t]=n[i],e.length===3&&(n[t]=e[2](n[t])))}function EO(n){for(var e=Object.keys(n),t=0,i=e.length;t<i;++t){var r=e[t];vZ.indexOf(r)!==-1&&wZ(n[r]),typeof n[r]=="object"&&EO(n[r])}}function wZ(n){if(n.AUTHORITY){var e=Object.keys(n.AUTHORITY)[0];e&&e in n.AUTHORITY&&(n.title=e+":"+n.AUTHORITY[e])}if(n.type==="GEOGCS"?n.projName="longlat":n.type==="LOCAL_CS"?(n.projName="identity",n.local=!0):typeof n.PROJECTION=="object"?n.projName=Object.keys(n.PROJECTION)[0]:n.projName=n.PROJECTION,n.AXIS){for(var t="",i=0,r=n.AXIS.length;i<r;++i){var s=[n.AXIS[i][0].toLowerCase(),n.AXIS[i][1].toLowerCase()];s[0].indexOf("north")!==-1||(s[0]==="y"||s[0]==="lat")&&s[1]==="north"?t+="n":s[0].indexOf("south")!==-1||(s[0]==="y"||s[0]==="lat")&&s[1]==="south"?t+="s":s[0].indexOf("east")!==-1||(s[0]==="x"||s[0]==="lon")&&s[1]==="east"?t+="e":(s[0].indexOf("west")!==-1||(s[0]==="x"||s[0]==="lon")&&s[1]==="west")&&(t+="w")}t.length===2&&(t+="u"),t.length===3&&(n.axis=t)}n.UNIT&&(n.units=n.UNIT.name.toLowerCase(),n.units==="metre"&&(n.units="meter"),n.UNIT.convert&&(n.type==="GEOGCS"?n.DATUM&&n.DATUM.SPHEROID&&(n.to_meter=n.UNIT.convert*n.DATUM.SPHEROID.a):n.to_meter=n.UNIT.convert));var o=n.GEOGCS;n.type==="GEOGCS"&&(o=n),o&&(o.DATUM?n.datumCode=o.DATUM.name.toLowerCase():n.datumCode=o.name.toLowerCase(),n.datumCode.slice(0,2)==="d_"&&(n.datumCode=n.datumCode.slice(2)),n.datumCode==="new_zealand_1949"&&(n.datumCode="nzgd49"),(n.datumCode==="wgs_1984"||n.datumCode==="world_geodetic_system_1984")&&(n.PROJECTION==="Mercator_Auxiliary_Sphere"&&(n.sphere=!0),n.datumCode="wgs84"),n.datumCode==="belge_1972"&&(n.datumCode="rnb72"),o.DATUM&&o.DATUM.SPHEROID&&(n.ellps=o.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),n.ellps.toLowerCase().slice(0,13)==="international"&&(n.ellps="intl"),n.a=o.DATUM.SPHEROID.a,n.rf=parseFloat(o.DATUM.SPHEROID.rf,10)),o.DATUM&&o.DATUM.TOWGS84&&(n.datum_params=o.DATUM.TOWGS84),~n.datumCode.indexOf("osgb_1936")&&(n.datumCode="osgb36"),~n.datumCode.indexOf("osni_1952")&&(n.datumCode="osni52"),(~n.datumCode.indexOf("tm65")||~n.datumCode.indexOf("geodetic_datum_of_1965"))&&(n.datumCode="ire65"),n.datumCode==="ch1903+"&&(n.datumCode="ch1903"),~n.datumCode.indexOf("israel")&&(n.datumCode="isr93")),n.b&&!isFinite(n.b)&&(n.b=n.a),n.rectified_grid_angle&&(n.rectified_grid_angle=jr(n.rectified_grid_angle));function a(d){var g=n.to_meter||1;return d*g}var u=function(d){return EZ(n,d)},h=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",jr],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",jr],["x0","false_easting",a],["y0","false_northing",a],["long0","central_meridian",jr],["lat0","latitude_of_origin",jr],["lat0","standard_parallel_1",jr],["lat1","standard_parallel_1",jr],["lat2","standard_parallel_2",jr],["azimuth","Azimuth"],["alpha","azimuth",jr],["srsCode","name"]];h.forEach(u),vO(n)}function a_(n){if(typeof n=="object")return o_(n);const e=fZ(n);var t=_Z(n);if(e==="WKT2"){const s=dZ(t);return o_(s)}var i=t[0],r={};return jc(t,r),EO(r),r[i]}function Nn(n){var e=this;if(arguments.length===2){var t=arguments[1];typeof t=="string"?t.charAt(0)==="+"?Nn[n]=Rw(arguments[1]):Nn[n]=a_(arguments[1]):t&&typeof t=="object"&&!("projName"in t)?Nn[n]=a_(arguments[1]):(Nn[n]=t,t||delete Nn[n])}else if(arguments.length===1){if(Array.isArray(n))return n.map(function(i){return Array.isArray(i)?Nn.apply(e,i):Nn(i)});if(typeof n=="string"){if(n in Nn)return Nn[n]}else"EPSG"in n?Nn["EPSG:"+n.EPSG]=n:"ESRI"in n?Nn["ESRI:"+n.ESRI]=n:"IAU2000"in n?Nn["IAU2000:"+n.IAU2000]=n:console.log(n);return}}nZ(Nn);function xZ(n){return typeof n=="string"}function TZ(n){return n in Nn}function IZ(n){return n.indexOf("+")!==0&&n.indexOf("[")!==-1||typeof n=="object"&&!("srsCode"in n)}var SZ=["3857","900913","3785","102113"];function AZ(n){var e=Ua(n,"authority");if(e){var t=Ua(e,"epsg");return t&&SZ.indexOf(t)>-1}}function RZ(n){var e=Ua(n,"extension");if(e)return Ua(e,"proj4")}function PZ(n){return n[0]==="+"}function CZ(n){if(xZ(n)){if(TZ(n))return Nn[n];if(IZ(n)){var e=a_(n);if(AZ(e))return Nn["EPSG:3857"];var t=RZ(e);return t?Rw(t):e}if(PZ(n))return Rw(n)}else return"projName"in n?n:a_(n)}function IM(n,e){n=n||{};var t,i;if(!e)return n;for(i in e)t=e[i],t!==void 0&&(n[i]=t);return n}function Ds(n,e,t){var i=n*e;return t/Math.sqrt(1-i*i)}function $g(n){return n<0?-1:1}function _e(n,e){return e||Math.abs(n)<=nn?n:n-$g(n)*ug}function Xr(n,e,t){var i=n*t,r=.5*n;return i=Math.pow((1-i)/(1+i),r),Math.tan(.5*(se-e))/i}function hg(n,e){for(var t=.5*n,i,r,s=se-2*Math.atan(e),o=0;o<=15;o++)if(i=n*Math.sin(s),r=se-2*Math.atan(e*Math.pow((1-i)/(1+i),t))-s,s+=r,Math.abs(r)<=1e-10)return s;return-9999}function MZ(){var n=this.b/this.a;this.es=1-n*n,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=Ds(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function bZ(n){var e=n.x,t=n.y;if(t*ki>90&&t*ki<-90&&e*ki>180&&e*ki<-180)return null;var i,r;if(Math.abs(Math.abs(t)-se)<=ge)return null;if(this.sphere)i=this.x0+this.a*this.k0*_e(e-this.long0,this.over),r=this.y0+this.a*this.k0*Math.log(Math.tan(mt+.5*t));else{var s=Math.sin(t),o=Xr(this.e,t,s);i=this.x0+this.a*this.k0*_e(e-this.long0,this.over),r=this.y0-this.a*this.k0*Math.log(o)}return n.x=i,n.y=r,n}function kZ(n){var e=n.x-this.x0,t=n.y-this.y0,i,r;if(this.sphere)r=se-2*Math.atan(Math.exp(-t/(this.a*this.k0)));else{var s=Math.exp(-t/(this.a*this.k0));if(r=hg(this.e,s),r===-9999)return null}return i=_e(this.long0+e/(this.a*this.k0),this.over),n.x=i,n.y=r,n}var LZ=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","Mercator_Variant_A","merc"];const DZ={init:MZ,forward:bZ,inverse:kZ,names:LZ};function NZ(){}function SM(n){return n}var wO=["longlat","identity"];const OZ={init:NZ,forward:SM,inverse:SM,names:wO};var VZ=[DZ,OZ],bl={},Uc=[];function xO(n,e){var t=Uc.length;return n.names?(Uc[t]=n,n.names.forEach(function(i){bl[i.toLowerCase()]=t}),this):(console.log(e),!0)}function TO(n){return n.replace(/[-\(\)\s]+/g," ").trim().replace(/ /g,"_")}function FZ(n){if(!n)return!1;var e=n.toLowerCase();if(typeof bl[e]<"u"&&Uc[bl[e]]||(e=TO(e),e in bl&&Uc[bl[e]]))return Uc[bl[e]]}function GZ(){VZ.forEach(xO)}const jZ={start:GZ,add:xO,get:FZ};var IO={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563396e-3,b:635625691e-2,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340189e-3,b:6356034446e-3,ellipseName:"Modified Airy"},andrae:{a:637710443e-2,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397155e-3,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483865e-3,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:63782064e-1,b:63565838e-1,ellipseName:"Clarke 1866"},clrk80:{a:6378249145e-3,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk80ign:{a:63782492e-1,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"},clrk58:{a:6378293645208759e-9,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:63757387e-1,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:637813605e-2,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276345e-3,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304063e-3,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301243e-3,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295664e-3,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298556e-3,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:63781575e-1,b:63567722e-1,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:63567733205e-4,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:63558348467e-4,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"},WGS84:{a:6378137,rf:298.257223563,ellipseName:"WGS 84"},sphere:{a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}};const UZ=IO.WGS84;function BZ(n,e,t,i){var r=n*n,s=e*e,o=(r-s)/r,a=0;i?(n*=1-o*(sZ+o*(oZ+o*aZ)),r=n*n,o=0):a=Math.sqrt(o);var u=(r-s)/s;return{es:o,e:a,ep2:u}}function zZ(n,e,t,i,r){if(!n){var s=Ua(IO,i);s||(s=UZ),n=s.a,e=s.b,t=s.rf}return t&&!e&&(e=(1-1/t)*n),(t===0||Math.abs(n-e)<ge)&&(r=!0,e=n),{a:n,b:e,rf:t,sphere:r}}var e0={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},mgi:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Ordnance Survey of Great Britain 1936"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"},EPSG_5451:{towgs84:"6.41,-49.05,-11.28,1.5657,0.5242,6.9718,-5.7649"},IGNF_LURESG:{towgs84:"-192.986,13.673,-39.309,-0.4099,-2.9332,2.6881,0.43"},EPSG_4614:{towgs84:"-119.4248,-303.65872,-11.00061,1.164298,0.174458,1.096259,3.657065"},EPSG_4615:{towgs84:"-494.088,-312.129,279.877,-1.423,-1.013,1.59,-0.748"},ESRI_37241:{towgs84:"-76.822,257.457,-12.817,2.136,-0.033,-2.392,-0.031"},ESRI_37249:{towgs84:"-440.296,58.548,296.265,1.128,10.202,4.559,-0.438"},ESRI_37245:{towgs84:"-511.151,-181.269,139.609,1.05,2.703,1.798,3.071"},EPSG_4178:{towgs84:"24.9,-126.4,-93.2,-0.063,-0.247,-0.041,1.01"},EPSG_4622:{towgs84:"-472.29,-5.63,-304.12,0.4362,-0.8374,0.2563,1.8984"},EPSG_4625:{towgs84:"126.93,547.94,130.41,-2.7867,5.1612,-0.8584,13.8227"},EPSG_5252:{towgs84:"0.023,0.036,-0.068,0.00176,0.00912,-0.01136,0.00439"},EPSG_4314:{towgs84:"597.1,71.4,412.1,0.894,0.068,-1.563,7.58"},EPSG_4282:{towgs84:"-178.3,-316.7,-131.5,5.278,6.077,10.979,19.166"},EPSG_4231:{towgs84:"-83.11,-97.38,-117.22,0.0276,-0.2167,0.2147,0.1218"},EPSG_4274:{towgs84:"-230.994,102.591,25.199,0.633,-0.239,0.9,1.95"},EPSG_4134:{towgs84:"-180.624,-225.516,173.919,-0.81,-1.898,8.336,16.71006"},EPSG_4254:{towgs84:"18.38,192.45,96.82,0.056,-0.142,-0.2,-0.0013"},EPSG_4159:{towgs84:"-194.513,-63.978,-25.759,-3.4027,3.756,-3.352,-0.9175"},EPSG_4687:{towgs84:"0.072,-0.507,-0.245,0.0183,-0.0003,0.007,-0.0093"},EPSG_4227:{towgs84:"-83.58,-397.54,458.78,-17.595,-2.847,4.256,3.225"},EPSG_4746:{towgs84:"599.4,72.4,419.2,-0.062,-0.022,-2.723,6.46"},EPSG_4745:{towgs84:"612.4,77,440.2,-0.054,0.057,-2.797,2.55"},EPSG_6311:{towgs84:"8.846,-4.394,-1.122,-0.00237,-0.146528,0.130428,0.783926"},EPSG_4289:{towgs84:"565.7381,50.4018,465.2904,-1.91514,1.60363,-9.09546,4.07244"},EPSG_4230:{towgs84:"-68.863,-134.888,-111.49,-0.53,-0.14,0.57,-3.4"},EPSG_4154:{towgs84:"-123.02,-158.95,-168.47"},EPSG_4156:{towgs84:"570.8,85.7,462.8,4.998,1.587,5.261,3.56"},EPSG_4299:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4179:{towgs84:"33.4,-146.6,-76.3,-0.359,-0.053,0.844,-0.84"},EPSG_4313:{towgs84:"-106.8686,52.2978,-103.7239,0.3366,-0.457,1.8422,-1.2747"},EPSG_4194:{towgs84:"163.511,127.533,-159.789"},EPSG_4195:{towgs84:"105,326,-102.5"},EPSG_4196:{towgs84:"-45,417,-3.5"},EPSG_4611:{towgs84:"-162.619,-276.959,-161.764,0.067753,-2.243649,-1.158827,-1.094246"},EPSG_4633:{towgs84:"137.092,131.66,91.475,-1.9436,-11.5993,-4.3321,-7.4824"},EPSG_4641:{towgs84:"-408.809,366.856,-412.987,1.8842,-0.5308,2.1655,-121.0993"},EPSG_4643:{towgs84:"-480.26,-438.32,-643.429,16.3119,20.1721,-4.0349,-111.7002"},EPSG_4300:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4188:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4660:{towgs84:"982.6087,552.753,-540.873,32.39344,-153.25684,-96.2266,16.805"},EPSG_4662:{towgs84:"97.295,-263.247,310.882,-1.5999,0.8386,3.1409,13.3259"},EPSG_3906:{towgs84:"577.88891,165.22205,391.18289,4.9145,-0.94729,-13.05098,7.78664"},EPSG_4307:{towgs84:"-209.3622,-87.8162,404.6198,0.0046,3.4784,0.5805,-1.4547"},EPSG_6892:{towgs84:"-76.269,-16.683,68.562,-6.275,10.536,-4.286,-13.686"},EPSG_4690:{towgs84:"221.597,152.441,176.523,2.403,1.3893,0.884,11.4648"},EPSG_4691:{towgs84:"218.769,150.75,176.75,3.5231,2.0037,1.288,10.9817"},EPSG_4629:{towgs84:"72.51,345.411,79.241,-1.5862,-0.8826,-0.5495,1.3653"},EPSG_4630:{towgs84:"165.804,216.213,180.26,-0.6251,-0.4515,-0.0721,7.4111"},EPSG_4692:{towgs84:"217.109,86.452,23.711,0.0183,-0.0003,0.007,-0.0093"},EPSG_9333:{towgs84:"0,0,0,-8.393,0.749,-10.276,0"},EPSG_9059:{towgs84:"0,0,0"},EPSG_4312:{towgs84:"601.705,84.263,485.227,4.7354,1.3145,5.393,-2.3887"},EPSG_4123:{towgs84:"-96.062,-82.428,-121.753,4.801,0.345,-1.376,1.496"},EPSG_4309:{towgs84:"-124.45,183.74,44.64,-0.4384,0.5446,-0.9706,-2.1365"},ESRI_104106:{towgs84:"-283.088,-70.693,117.445,-1.157,0.059,-0.652,-4.058"},EPSG_4281:{towgs84:"-219.247,-73.802,269.529"},EPSG_4322:{towgs84:"0,0,4.5"},EPSG_4324:{towgs84:"0,0,1.9"},EPSG_4284:{towgs84:"43.822,-108.842,-119.585,1.455,-0.761,0.737,0.549"},EPSG_4277:{towgs84:"446.448,-125.157,542.06,0.15,0.247,0.842,-20.489"},EPSG_4207:{towgs84:"-282.1,-72.2,120,-1.529,0.145,-0.89,-4.46"},EPSG_4688:{towgs84:"347.175,1077.618,2623.677,33.9058,-70.6776,9.4013,186.0647"},EPSG_4689:{towgs84:"410.793,54.542,80.501,-2.5596,-2.3517,-0.6594,17.3218"},EPSG_4720:{towgs84:"0,0,4.5"},EPSG_4273:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},EPSG_4240:{towgs84:"204.64,834.74,293.8"},EPSG_4817:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},ESRI_104131:{towgs84:"426.62,142.62,460.09,4.98,4.49,-12.42,-17.1"},EPSG_4265:{towgs84:"-104.1,-49.1,-9.9,0.971,-2.917,0.714,-11.68"},EPSG_4263:{towgs84:"-111.92,-87.85,114.5,1.875,0.202,0.219,0.032"},EPSG_4298:{towgs84:"-689.5937,623.84046,-65.93566,-0.02331,1.17094,-0.80054,5.88536"},EPSG_4270:{towgs84:"-253.4392,-148.452,386.5267,0.15605,0.43,-0.1013,-0.0424"},EPSG_4229:{towgs84:"-121.8,98.1,-10.7"},EPSG_4220:{towgs84:"-55.5,-348,-229.2"},EPSG_4214:{towgs84:"12.646,-155.176,-80.863"},EPSG_4232:{towgs84:"-345,3,223"},EPSG_4238:{towgs84:"-1.977,-13.06,-9.993,0.364,0.254,0.689,-1.037"},EPSG_4168:{towgs84:"-170,33,326"},EPSG_4131:{towgs84:"199,931,318.9"},EPSG_4152:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_5228:{towgs84:"572.213,85.334,461.94,4.9732,1.529,5.2484,3.5378"},EPSG_8351:{towgs84:"485.021,169.465,483.839,7.786342,4.397554,4.102655,0"},EPSG_4683:{towgs84:"-127.62,-67.24,-47.04,-3.068,4.903,1.578,-1.06"},EPSG_4133:{towgs84:"0,0,0"},EPSG_7373:{towgs84:"0.819,-0.5762,-1.6446,-0.00378,-0.03317,0.00318,0.0693"},EPSG_9075:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9072:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9294:{towgs84:"1.16835,-1.42001,-2.24431,-0.00822,-0.05508,0.01818,0.23388"},EPSG_4212:{towgs84:"-267.434,173.496,181.814,-13.4704,8.7154,7.3926,14.7492"},EPSG_4191:{towgs84:"-44.183,-0.58,-38.489,2.3867,2.7072,-3.5196,-8.2703"},EPSG_4237:{towgs84:"52.684,-71.194,-13.975,-0.312,-0.1063,-0.3729,1.0191"},EPSG_4740:{towgs84:"-1.08,-0.27,-0.9"},EPSG_4124:{towgs84:"419.3836,99.3335,591.3451,0.850389,1.817277,-7.862238,-0.99496"},EPSG_5681:{towgs84:"584.9636,107.7175,413.8067,1.1155,0.2824,-3.1384,7.9922"},EPSG_4141:{towgs84:"23.772,17.49,17.859,-0.3132,-1.85274,1.67299,-5.4262"},EPSG_4204:{towgs84:"-85.645,-273.077,-79.708,2.289,-1.421,2.532,3.194"},EPSG_4319:{towgs84:"226.702,-193.337,-35.371,-2.229,-4.391,9.238,0.9798"},EPSG_4200:{towgs84:"24.82,-131.21,-82.66"},EPSG_4130:{towgs84:"0,0,0"},EPSG_4127:{towgs84:"-82.875,-57.097,-156.768,-2.158,1.524,-0.982,-0.359"},EPSG_4149:{towgs84:"674.374,15.056,405.346"},EPSG_4617:{towgs84:"-0.991,1.9072,0.5129,1.25033e-7,4.6785e-8,5.6529e-8,0"},EPSG_4663:{towgs84:"-210.502,-66.902,-48.476,2.094,-15.067,-5.817,0.485"},EPSG_4664:{towgs84:"-211.939,137.626,58.3,-0.089,0.251,0.079,0.384"},EPSG_4665:{towgs84:"-105.854,165.589,-38.312,-0.003,-0.026,0.024,-0.048"},EPSG_4666:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},EPSG_4756:{towgs84:"-192.873,-39.382,-111.202,-0.00205,-0.0005,0.00335,0.0188"},EPSG_4723:{towgs84:"-179.483,-69.379,-27.584,-7.862,8.163,6.042,-13.925"},EPSG_4726:{towgs84:"8.853,-52.644,180.304,-0.393,-2.323,2.96,-24.081"},EPSG_4267:{towgs84:"-8.0,160.0,176.0"},EPSG_5365:{towgs84:"-0.16959,0.35312,0.51846,0.03385,-0.16325,0.03446,0.03693"},EPSG_4218:{towgs84:"304.5,306.5,-318.1"},EPSG_4242:{towgs84:"-33.722,153.789,94.959,-8.581,-4.478,4.54,8.95"},EPSG_4216:{towgs84:"-292.295,248.758,429.447,4.9971,2.99,6.6906,1.0289"},ESRI_104105:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},ESRI_104129:{towgs84:"0,0,0"},EPSG_4673:{towgs84:"174.05,-25.49,112.57"},EPSG_4202:{towgs84:"-124,-60,154"},EPSG_4203:{towgs84:"-117.763,-51.51,139.061,0.292,0.443,0.277,-0.191"},EPSG_3819:{towgs84:"595.48,121.69,515.35,4.115,-2.9383,0.853,-3.408"},EPSG_8694:{towgs84:"-93.799,-132.737,-219.073,-1.844,0.648,-6.37,-0.169"},EPSG_4145:{towgs84:"275.57,676.78,229.6"},EPSG_4283:{towgs84:"61.55,-10.87,-40.19,39.4924,32.7221,32.8979,-9.994"},EPSG_4317:{towgs84:"2.3287,-147.0425,-92.0802,-0.3092483,0.32482185,0.49729934,5.68906266"},EPSG_4272:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993"},EPSG_4248:{towgs84:"-307.7,265.3,-363.5"},EPSG_5561:{towgs84:"24,-121,-76"},EPSG_5233:{towgs84:"-0.293,766.95,87.713,0.195704,1.695068,3.473016,-0.039338"},ESRI_104130:{towgs84:"-86,-98,-119"},ESRI_104102:{towgs84:"682,-203,480"},ESRI_37207:{towgs84:"7,-10,-26"},EPSG_4675:{towgs84:"59.935,118.4,-10.871"},ESRI_104109:{towgs84:"-89.121,-348.182,260.871"},ESRI_104112:{towgs84:"-185.583,-230.096,281.361"},ESRI_104113:{towgs84:"25.1,-275.6,222.6"},IGNF_WGS72G:{towgs84:"0,12,6"},IGNF_NTFG:{towgs84:"-168,-60,320"},IGNF_EFATE57G:{towgs84:"-127,-769,472"},IGNF_PGP50G:{towgs84:"324.8,153.6,172.1"},IGNF_REUN47G:{towgs84:"94,-948,-1262"},IGNF_CSG67G:{towgs84:"-186,230,110"},IGNF_GUAD48G:{towgs84:"-467,-16,-300"},IGNF_TAHI51G:{towgs84:"162,117,154"},IGNF_TAHAAG:{towgs84:"65,342,77"},IGNF_NUKU72G:{towgs84:"84,274,65"},IGNF_PETRELS72G:{towgs84:"365,194,166"},IGNF_WALL78G:{towgs84:"253,-133,-127"},IGNF_MAYO50G:{towgs84:"-382,-59,-262"},IGNF_TANNAG:{towgs84:"-139,-967,436"},IGNF_IGN72G:{towgs84:"-13,-348,292"},IGNF_ATIGG:{towgs84:"1118,23,66"},IGNF_FANGA84G:{towgs84:"150.57,158.33,118.32"},IGNF_RUSAT84G:{towgs84:"202.13,174.6,-15.74"},IGNF_KAUE70G:{towgs84:"126.74,300.1,-75.49"},IGNF_MOP90G:{towgs84:"-10.8,-1.8,12.77"},IGNF_MHPF67G:{towgs84:"338.08,212.58,-296.17"},IGNF_TAHI79G:{towgs84:"160.61,116.05,153.69"},IGNF_ANAA92G:{towgs84:"1.5,3.84,4.81"},IGNF_MARQUI72G:{towgs84:"330.91,-13.92,58.56"},IGNF_APAT86G:{towgs84:"143.6,197.82,74.05"},IGNF_TUBU69G:{towgs84:"237.17,171.61,-77.84"},IGNF_STPM50G:{towgs84:"11.363,424.148,373.13"},EPSG_4150:{towgs84:"674.374,15.056,405.346"},EPSG_4754:{towgs84:"-208.4058,-109.8777,-2.5764"},ESRI_104101:{towgs84:"374,150,588"},EPSG_4693:{towgs84:"0,-0.15,0.68"},EPSG_6207:{towgs84:"293.17,726.18,245.36"},EPSG_4153:{towgs84:"-133.63,-157.5,-158.62"},EPSG_4132:{towgs84:"-241.54,-163.64,396.06"},EPSG_4221:{towgs84:"-154.5,150.7,100.4"},EPSG_4266:{towgs84:"-80.7,-132.5,41.1"},EPSG_4193:{towgs84:"-70.9,-151.8,-41.4"},EPSG_5340:{towgs84:"-0.41,0.46,-0.35"},EPSG_4246:{towgs84:"-294.7,-200.1,525.5"},EPSG_4318:{towgs84:"-3.2,-5.7,2.8"},EPSG_4121:{towgs84:"-199.87,74.79,246.62"},EPSG_4223:{towgs84:"-260.1,5.5,432.2"},EPSG_4158:{towgs84:"-0.465,372.095,171.736"},EPSG_4285:{towgs84:"-128.16,-282.42,21.93"},EPSG_4613:{towgs84:"-404.78,685.68,45.47"},EPSG_4607:{towgs84:"195.671,332.517,274.607"},EPSG_4475:{towgs84:"-381.788,-57.501,-256.673"},EPSG_4208:{towgs84:"-157.84,308.54,-146.6"},EPSG_4743:{towgs84:"70.995,-335.916,262.898"},EPSG_4710:{towgs84:"-323.65,551.39,-491.22"},EPSG_7881:{towgs84:"-0.077,0.079,0.086"},EPSG_4682:{towgs84:"283.729,735.942,261.143"},EPSG_4739:{towgs84:"-156,-271,-189"},EPSG_4679:{towgs84:"-80.01,253.26,291.19"},EPSG_4750:{towgs84:"-56.263,16.136,-22.856"},EPSG_4644:{towgs84:"-10.18,-350.43,291.37"},EPSG_4695:{towgs84:"-103.746,-9.614,-255.95"},EPSG_4292:{towgs84:"-355,21,72"},EPSG_4302:{towgs84:"-61.702,284.488,472.052"},EPSG_4143:{towgs84:"-124.76,53,466.79"},EPSG_4606:{towgs84:"-153,153,307"},EPSG_4699:{towgs84:"-770.1,158.4,-498.2"},EPSG_4247:{towgs84:"-273.5,110.6,-357.9"},EPSG_4160:{towgs84:"8.88,184.86,106.69"},EPSG_4161:{towgs84:"-233.43,6.65,173.64"},EPSG_9251:{towgs84:"-9.5,122.9,138.2"},EPSG_9253:{towgs84:"-78.1,101.6,133.3"},EPSG_4297:{towgs84:"-198.383,-240.517,-107.909"},EPSG_4269:{towgs84:"0,0,0"},EPSG_4301:{towgs84:"-147,506,687"},EPSG_4618:{towgs84:"-59,-11,-52"},EPSG_4612:{towgs84:"0,0,0"},EPSG_4678:{towgs84:"44.585,-131.212,-39.544"},EPSG_4250:{towgs84:"-130,29,364"},EPSG_4144:{towgs84:"214,804,268"},EPSG_4147:{towgs84:"-17.51,-108.32,-62.39"},EPSG_4259:{towgs84:"-254.1,-5.36,-100.29"},EPSG_4164:{towgs84:"-76,-138,67"},EPSG_4211:{towgs84:"-378.873,676.002,-46.255"},EPSG_4182:{towgs84:"-422.651,-172.995,84.02"},EPSG_4224:{towgs84:"-143.87,243.37,-33.52"},EPSG_4225:{towgs84:"-205.57,168.77,-4.12"},EPSG_5527:{towgs84:"-67.35,3.88,-38.22"},EPSG_4752:{towgs84:"98,390,-22"},EPSG_4310:{towgs84:"-30,190,89"},EPSG_9248:{towgs84:"-192.26,65.72,132.08"},EPSG_4680:{towgs84:"124.5,-63.5,-281"},EPSG_4701:{towgs84:"-79.9,-158,-168.9"},EPSG_4706:{towgs84:"-146.21,112.63,4.05"},EPSG_4805:{towgs84:"682,-203,480"},EPSG_4201:{towgs84:"-165,-11,206"},EPSG_4210:{towgs84:"-157,-2,-299"},EPSG_4183:{towgs84:"-104,167,-38"},EPSG_4139:{towgs84:"11,72,-101"},EPSG_4668:{towgs84:"-86,-98,-119"},EPSG_4717:{towgs84:"-2,151,181"},EPSG_4732:{towgs84:"102,52,-38"},EPSG_4280:{towgs84:"-377,681,-50"},EPSG_4209:{towgs84:"-138,-105,-289"},EPSG_4261:{towgs84:"31,146,47"},EPSG_4658:{towgs84:"-73,46,-86"},EPSG_4721:{towgs84:"265.025,384.929,-194.046"},EPSG_4222:{towgs84:"-136,-108,-292"},EPSG_4601:{towgs84:"-255,-15,71"},EPSG_4602:{towgs84:"725,685,536"},EPSG_4603:{towgs84:"72,213.7,93"},EPSG_4605:{towgs84:"9,183,236"},EPSG_4621:{towgs84:"137,248,-430"},EPSG_4657:{towgs84:"-28,199,5"},EPSG_4316:{towgs84:"103.25,-100.4,-307.19"},EPSG_4642:{towgs84:"-13,-348,292"},EPSG_4698:{towgs84:"145,-187,103"},EPSG_4192:{towgs84:"-206.1,-174.7,-87.7"},EPSG_4311:{towgs84:"-265,120,-358"},EPSG_4135:{towgs84:"58,-283,-182"},ESRI_104138:{towgs84:"198,-226,-347"},EPSG_4245:{towgs84:"-11,851,5"},EPSG_4142:{towgs84:"-125,53,467"},EPSG_4213:{towgs84:"-106,-87,188"},EPSG_4253:{towgs84:"-133,-77,-51"},EPSG_4129:{towgs84:"-132,-110,-335"},EPSG_4713:{towgs84:"-77,-128,142"},EPSG_4239:{towgs84:"217,823,299"},EPSG_4146:{towgs84:"295,736,257"},EPSG_4155:{towgs84:"-83,37,124"},EPSG_4165:{towgs84:"-173,253,27"},EPSG_4672:{towgs84:"175,-38,113"},EPSG_4236:{towgs84:"-637,-549,-203"},EPSG_4251:{towgs84:"-90,40,88"},EPSG_4271:{towgs84:"-2,374,172"},EPSG_4175:{towgs84:"-88,4,101"},EPSG_4716:{towgs84:"298,-304,-375"},EPSG_4315:{towgs84:"-23,259,-9"},EPSG_4744:{towgs84:"-242.2,-144.9,370.3"},EPSG_4244:{towgs84:"-97,787,86"},EPSG_4293:{towgs84:"616,97,-251"},EPSG_4714:{towgs84:"-127,-769,472"},EPSG_4736:{towgs84:"260,12,-147"},EPSG_6883:{towgs84:"-235,-110,393"},EPSG_6894:{towgs84:"-63,176,185"},EPSG_4205:{towgs84:"-43,-163,45"},EPSG_4256:{towgs84:"41,-220,-134"},EPSG_4262:{towgs84:"639,405,60"},EPSG_4604:{towgs84:"174,359,365"},EPSG_4169:{towgs84:"-115,118,426"},EPSG_4620:{towgs84:"-106,-129,165"},EPSG_4184:{towgs84:"-203,141,53"},EPSG_4616:{towgs84:"-289,-124,60"},EPSG_9403:{towgs84:"-307,-92,127"},EPSG_4684:{towgs84:"-133,-321,50"},EPSG_4708:{towgs84:"-491,-22,435"},EPSG_4707:{towgs84:"114,-116,-333"},EPSG_4709:{towgs84:"145,75,-272"},EPSG_4712:{towgs84:"-205,107,53"},EPSG_4711:{towgs84:"124,-234,-25"},EPSG_4718:{towgs84:"230,-199,-752"},EPSG_4719:{towgs84:"211,147,111"},EPSG_4724:{towgs84:"208,-435,-229"},EPSG_4725:{towgs84:"189,-79,-202"},EPSG_4735:{towgs84:"647,1777,-1124"},EPSG_4722:{towgs84:"-794,119,-298"},EPSG_4728:{towgs84:"-307,-92,127"},EPSG_4734:{towgs84:"-632,438,-609"},EPSG_4727:{towgs84:"912,-58,1227"},EPSG_4729:{towgs84:"185,165,42"},EPSG_4730:{towgs84:"170,42,84"},EPSG_4733:{towgs84:"276,-57,149"},ESRI_37218:{towgs84:"230,-199,-752"},ESRI_37240:{towgs84:"-7,215,225"},ESRI_37221:{towgs84:"252,-209,-751"},ESRI_4305:{towgs84:"-123,-206,219"},ESRI_104139:{towgs84:"-73,-247,227"},EPSG_4748:{towgs84:"51,391,-36"},EPSG_4219:{towgs84:"-384,664,-48"},EPSG_4255:{towgs84:"-333,-222,114"},EPSG_4257:{towgs84:"-587.8,519.75,145.76"},EPSG_4646:{towgs84:"-963,510,-359"},EPSG_6881:{towgs84:"-24,-203,268"},EPSG_6882:{towgs84:"-183,-15,273"},EPSG_4715:{towgs84:"-104,-129,239"},IGNF_RGF93GDD:{towgs84:"0,0,0"},IGNF_RGM04GDD:{towgs84:"0,0,0"},IGNF_RGSPM06GDD:{towgs84:"0,0,0"},IGNF_RGTAAF07GDD:{towgs84:"0,0,0"},IGNF_RGFG95GDD:{towgs84:"0,0,0"},IGNF_RGNCG:{towgs84:"0,0,0"},IGNF_RGPFGDD:{towgs84:"0,0,0"},IGNF_ETRS89G:{towgs84:"0,0,0"},IGNF_RGR92GDD:{towgs84:"0,0,0"},EPSG_4173:{towgs84:"0,0,0"},EPSG_4180:{towgs84:"0,0,0"},EPSG_4619:{towgs84:"0,0,0"},EPSG_4667:{towgs84:"0,0,0"},EPSG_4075:{towgs84:"0,0,0"},EPSG_6706:{towgs84:"0,0,0"},EPSG_7798:{towgs84:"0,0,0"},EPSG_4661:{towgs84:"0,0,0"},EPSG_4669:{towgs84:"0,0,0"},EPSG_8685:{towgs84:"0,0,0"},EPSG_4151:{towgs84:"0,0,0"},EPSG_9702:{towgs84:"0,0,0"},EPSG_4758:{towgs84:"0,0,0"},EPSG_4761:{towgs84:"0,0,0"},EPSG_4765:{towgs84:"0,0,0"},EPSG_8997:{towgs84:"0,0,0"},EPSG_4023:{towgs84:"0,0,0"},EPSG_4670:{towgs84:"0,0,0"},EPSG_4694:{towgs84:"0,0,0"},EPSG_4148:{towgs84:"0,0,0"},EPSG_4163:{towgs84:"0,0,0"},EPSG_4167:{towgs84:"0,0,0"},EPSG_4189:{towgs84:"0,0,0"},EPSG_4190:{towgs84:"0,0,0"},EPSG_4176:{towgs84:"0,0,0"},EPSG_4659:{towgs84:"0,0,0"},EPSG_3824:{towgs84:"0,0,0"},EPSG_3889:{towgs84:"0,0,0"},EPSG_4046:{towgs84:"0,0,0"},EPSG_4081:{towgs84:"0,0,0"},EPSG_4558:{towgs84:"0,0,0"},EPSG_4483:{towgs84:"0,0,0"},EPSG_5013:{towgs84:"0,0,0"},EPSG_5264:{towgs84:"0,0,0"},EPSG_5324:{towgs84:"0,0,0"},EPSG_5354:{towgs84:"0,0,0"},EPSG_5371:{towgs84:"0,0,0"},EPSG_5373:{towgs84:"0,0,0"},EPSG_5381:{towgs84:"0,0,0"},EPSG_5393:{towgs84:"0,0,0"},EPSG_5489:{towgs84:"0,0,0"},EPSG_5593:{towgs84:"0,0,0"},EPSG_6135:{towgs84:"0,0,0"},EPSG_6365:{towgs84:"0,0,0"},EPSG_5246:{towgs84:"0,0,0"},EPSG_7886:{towgs84:"0,0,0"},EPSG_8431:{towgs84:"0,0,0"},EPSG_8427:{towgs84:"0,0,0"},EPSG_8699:{towgs84:"0,0,0"},EPSG_8818:{towgs84:"0,0,0"},EPSG_4757:{towgs84:"0,0,0"},EPSG_9140:{towgs84:"0,0,0"},EPSG_8086:{towgs84:"0,0,0"},EPSG_4686:{towgs84:"0,0,0"},EPSG_4737:{towgs84:"0,0,0"},EPSG_4702:{towgs84:"0,0,0"},EPSG_4747:{towgs84:"0,0,0"},EPSG_4749:{towgs84:"0,0,0"},EPSG_4674:{towgs84:"0,0,0"},EPSG_4755:{towgs84:"0,0,0"},EPSG_4759:{towgs84:"0,0,0"},EPSG_4762:{towgs84:"0,0,0"},EPSG_4763:{towgs84:"0,0,0"},EPSG_4764:{towgs84:"0,0,0"},EPSG_4166:{towgs84:"0,0,0"},EPSG_4170:{towgs84:"0,0,0"},EPSG_5546:{towgs84:"0,0,0"},EPSG_7844:{towgs84:"0,0,0"},EPSG_4818:{towgs84:"589,76,480"}};for(var $Z in e0){var X1=e0[$Z];X1.datumName&&(e0[X1.datumName]=X1)}function WZ(n,e,t,i,r,s,o){var a={};return n===void 0||n==="none"?a.datum_type=Aw:a.datum_type=iZ,e&&(a.datum_params=e.map(parseFloat),(a.datum_params[0]!==0||a.datum_params[1]!==0||a.datum_params[2]!==0)&&(a.datum_type=mu),a.datum_params.length>3&&(a.datum_params[3]!==0||a.datum_params[4]!==0||a.datum_params[5]!==0||a.datum_params[6]!==0)&&(a.datum_type=pu,a.datum_params[3]*=Tf,a.datum_params[4]*=Tf,a.datum_params[5]*=Tf,a.datum_params[6]=a.datum_params[6]/1e6+1)),o&&(a.datum_type=th,a.grids=o),a.a=t,a.b=i,a.es=r,a.ep2=s,a}var aI={};function KZ(n,e,t){return e instanceof ArrayBuffer?qZ(n,e,t):{ready:HZ(n,e)}}function qZ(n,e,t){var i=!0;t!==void 0&&t.includeErrorFields===!1&&(i=!1);var r=new DataView(e),s=ZZ(r),o=QZ(r,s),a=JZ(r,o,s,i),u={header:o,subgrids:a};return aI[n]=u,u}async function HZ(n,e){for(var t=[],i=await e.getImageCount(),r=i-1;r>=0;r--){var s=await e.getImage(r),o=await s.readRasters(),a=o,u=[s.getWidth(),s.getHeight()],h=s.getBoundingBox().map(AM),d=[s.fileDirectory.ModelPixelScale[0],s.fileDirectory.ModelPixelScale[1]].map(AM),g=h[0]+(u[0]-1)*d[0],m=h[3]-(u[1]-1)*d[1],v=a[0],y=a[1],I=[];for(let P=u[1]-1;P>=0;P--)for(let b=u[0]-1;b>=0;b--){var w=P*u[0]+b;I.push([-wa(y[w]),wa(v[w])])}t.push({del:d,lim:u,ll:[-g,m],cvs:I})}var R={header:{nSubgrids:i},subgrids:t};return aI[n]=R,R}function XZ(n){if(n===void 0)return null;var e=n.split(",");return e.map(YZ)}function YZ(n){if(n.length===0)return null;var e=n[0]==="@";return e&&(n=n.slice(1)),n==="null"?{name:"null",mandatory:!e,grid:null,isNull:!0}:{name:n,mandatory:!e,grid:aI[n]||null,isNull:!1}}function AM(n){return n*Math.PI/180}function wa(n){return n/3600*Math.PI/180}function ZZ(n){var e=n.getInt32(8,!1);return e===11?!1:(e=n.getInt32(8,!0),e!==11&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}function QZ(n,e){return{nFields:n.getInt32(8,e),nSubgridFields:n.getInt32(24,e),nSubgrids:n.getInt32(40,e),shiftType:Pw(n,56,64).trim(),fromSemiMajorAxis:n.getFloat64(120,e),fromSemiMinorAxis:n.getFloat64(136,e),toSemiMajorAxis:n.getFloat64(152,e),toSemiMinorAxis:n.getFloat64(168,e)}}function Pw(n,e,t){return String.fromCharCode.apply(null,new Uint8Array(n.buffer.slice(e,t)))}function JZ(n,e,t,i){for(var r=176,s=[],o=0;o<e.nSubgrids;o++){var a=tQ(n,r,t),u=nQ(n,r,a,t,i),h=Math.round(1+(a.upperLongitude-a.lowerLongitude)/a.longitudeInterval),d=Math.round(1+(a.upperLatitude-a.lowerLatitude)/a.latitudeInterval);s.push({ll:[wa(a.lowerLongitude),wa(a.lowerLatitude)],del:[wa(a.longitudeInterval),wa(a.latitudeInterval)],lim:[h,d],count:a.gridNodeCount,cvs:eQ(u)});var g=16;i===!1&&(g=8),r+=176+a.gridNodeCount*g}return s}function eQ(n){return n.map(function(e){return[wa(e.longitudeShift),wa(e.latitudeShift)]})}function tQ(n,e,t){return{name:Pw(n,e+8,e+16).trim(),parent:Pw(n,e+24,e+24+8).trim(),lowerLatitude:n.getFloat64(e+72,t),upperLatitude:n.getFloat64(e+88,t),lowerLongitude:n.getFloat64(e+104,t),upperLongitude:n.getFloat64(e+120,t),latitudeInterval:n.getFloat64(e+136,t),longitudeInterval:n.getFloat64(e+152,t),gridNodeCount:n.getInt32(e+168,t)}}function nQ(n,e,t,i,r){var s=e+176,o=16;r===!1&&(o=8);for(var a=[],u=0;u<t.gridNodeCount;u++){var h={latitudeShift:n.getFloat32(s+u*o,i),longitudeShift:n.getFloat32(s+u*o+4,i)};r!==!1&&(h.latitudeAccuracy=n.getFloat32(s+u*o+8,i),h.longitudeAccuracy=n.getFloat32(s+u*o+12,i)),a.push(h)}return a}function Ar(n,e){if(!(this instanceof Ar))return new Ar(n);this.forward=null,this.inverse=null,this.init=null,this.name,this.names=null,this.title,e=e||function(h){if(h)throw h};var t=CZ(n);if(typeof t!="object"){e("Could not parse to valid json: "+n);return}var i=Ar.projections.get(t.projName);if(!i){e("Could not get projection name from: "+n);return}if(t.datumCode&&t.datumCode!=="none"){var r=Ua(e0,t.datumCode);r&&(t.datum_params=t.datum_params||(r.towgs84?r.towgs84.split(","):null),t.ellps=r.ellipse,t.datumName=r.datumName?r.datumName:t.datumCode)}t.k0=t.k0||1,t.axis=t.axis||"enu",t.ellps=t.ellps||"wgs84",t.lat1=t.lat1||t.lat0;var s=zZ(t.a,t.b,t.rf,t.ellps,t.sphere),o=BZ(s.a,s.b,s.rf,t.R_A),a=XZ(t.nadgrids),u=t.datum||WZ(t.datumCode,t.datum_params,s.a,s.b,o.es,o.ep2,a);IM(this,t),IM(this,i),this.a=s.a,this.b=s.b,this.rf=s.rf,this.sphere=s.sphere,this.es=o.es,this.e=o.e,this.ep2=o.ep2,this.datum=u,"init"in this&&typeof this.init=="function"&&this.init(),e(null,this)}Ar.projections=jZ;Ar.projections.start();function iQ(n,e){return n.datum_type!==e.datum_type||n.a!==e.a||Math.abs(n.es-e.es)>5e-11?!1:n.datum_type===mu?n.datum_params[0]===e.datum_params[0]&&n.datum_params[1]===e.datum_params[1]&&n.datum_params[2]===e.datum_params[2]:n.datum_type===pu?n.datum_params[0]===e.datum_params[0]&&n.datum_params[1]===e.datum_params[1]&&n.datum_params[2]===e.datum_params[2]&&n.datum_params[3]===e.datum_params[3]&&n.datum_params[4]===e.datum_params[4]&&n.datum_params[5]===e.datum_params[5]&&n.datum_params[6]===e.datum_params[6]:!0}function SO(n,e,t){var i=n.x,r=n.y,s=n.z?n.z:0,o,a,u,h;if(r<-se&&r>-1.001*se)r=-se;else if(r>se&&r<1.001*se)r=se;else{if(r<-se)return{x:-1/0,y:-1/0,z:n.z};if(r>se)return{x:1/0,y:1/0,z:n.z}}return i>Math.PI&&(i-=2*Math.PI),a=Math.sin(r),h=Math.cos(r),u=a*a,o=t/Math.sqrt(1-e*u),{x:(o+s)*h*Math.cos(i),y:(o+s)*h*Math.sin(i),z:(o*(1-e)+s)*a}}function AO(n,e,t,i){var r=1e-12,s=r*r,o=30,a,u,h,d,g,m,v,y,I,w,R,P,b,L=n.x,D=n.y,B=n.z?n.z:0,M,A,k;if(a=Math.sqrt(L*L+D*D),u=Math.sqrt(L*L+D*D+B*B),a/t<r){if(M=0,u/t<r)return A=se,k=-i,{x:n.x,y:n.y,z:n.z}}else M=Math.atan2(D,L);h=B/u,d=a/u,g=1/Math.sqrt(1-e*(2-e)*d*d),y=d*(1-e)*g,I=h*g,b=0;do b++,v=t/Math.sqrt(1-e*I*I),k=a*y+B*I-v*(1-e*I*I),m=e*v/(v+k),g=1/Math.sqrt(1-m*(2-m)*d*d),w=d*(1-m)*g,R=h*g,P=R*y-w*I,y=w,I=R;while(P*P>s&&b<o);return A=Math.atan(R/Math.abs(w)),{x:M,y:A,z:k}}function rQ(n,e,t){if(e===mu)return{x:n.x+t[0],y:n.y+t[1],z:n.z+t[2]};if(e===pu){var i=t[0],r=t[1],s=t[2],o=t[3],a=t[4],u=t[5],h=t[6];return{x:h*(n.x-u*n.y+a*n.z)+i,y:h*(u*n.x+n.y-o*n.z)+r,z:h*(-a*n.x+o*n.y+n.z)+s}}}function sQ(n,e,t){if(e===mu)return{x:n.x-t[0],y:n.y-t[1],z:n.z-t[2]};if(e===pu){var i=t[0],r=t[1],s=t[2],o=t[3],a=t[4],u=t[5],h=t[6],d=(n.x-i)/h,g=(n.y-r)/h,m=(n.z-s)/h;return{x:d+u*g-a*m,y:-u*d+g+o*m,z:a*d-o*g+m}}}function Mp(n){return n===mu||n===pu}function oQ(n,e,t){if(iQ(n,e)||n.datum_type===Aw||e.datum_type===Aw)return t;var i=n.a,r=n.es;if(n.datum_type===th){var s=RM(n,!1,t);if(s!==0)return;i=yM,r=vM}var o=e.a,a=e.b,u=e.es;if(e.datum_type===th&&(o=yM,a=rZ,u=vM),r===u&&i===o&&!Mp(n.datum_type)&&!Mp(e.datum_type))return t;if(t=SO(t,r,i),Mp(n.datum_type)&&(t=rQ(t,n.datum_type,n.datum_params)),Mp(e.datum_type)&&(t=sQ(t,e.datum_type,e.datum_params)),t=AO(t,u,o,a),e.datum_type===th){var h=RM(e,!0,t);if(h!==0)return}return t}function RM(n,e,t){if(n.grids===null||n.grids.length===0)return console.log("Grid shift grids not found"),-1;var i={x:-t.x,y:t.y},r={x:Number.NaN,y:Number.NaN},s=[];e:for(var o=0;o<n.grids.length;o++){var a=n.grids[o];if(s.push(a.name),a.isNull){r=i;break}if(a.grid===null){if(a.mandatory)return console.log("Unable to find mandatory grid '"+a.name+"'"),-1;continue}for(var u=a.grid.subgrids,h=0,d=u.length;h<d;h++){var g=u[h],m=(Math.abs(g.del[1])+Math.abs(g.del[0]))/1e4,v=g.ll[0]-m,y=g.ll[1]-m,I=g.ll[0]+(g.lim[0]-1)*g.del[0]+m,w=g.ll[1]+(g.lim[1]-1)*g.del[1]+m;if(!(y>i.y||v>i.x||w<i.y||I<i.x)&&(r=aQ(i,e,g),!isNaN(r.x)))break e}}return isNaN(r.x)?(console.log("Failed to find a grid shift table for location '"+-i.x*ki+" "+i.y*ki+" tried: '"+s+"'"),-1):(t.x=-r.x,t.y=r.y,0)}function aQ(n,e,t){var i={x:Number.NaN,y:Number.NaN};if(isNaN(n.x))return i;var r={x:n.x,y:n.y};r.x-=t.ll[0],r.y-=t.ll[1],r.x=_e(r.x-Math.PI)+Math.PI;var s=PM(r,t);if(e){if(isNaN(s.x))return i;s.x=r.x-s.x,s.y=r.y-s.y;var o=9,a=1e-12,u,h;do{if(h=PM(s,t),isNaN(h.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}u={x:r.x-(h.x+s.x),y:r.y-(h.y+s.y)},s.x+=u.x,s.y+=u.y}while(o--&&Math.abs(u.x)>a&&Math.abs(u.y)>a);if(o<0)return console.log("Inverse grid shift iterator failed to converge."),i;i.x=_e(s.x+t.ll[0]),i.y=s.y+t.ll[1]}else isNaN(s.x)||(i.x=n.x+s.x,i.y=n.y+s.y);return i}function PM(n,e){var t={x:n.x/e.del[0],y:n.y/e.del[1]},i={x:Math.floor(t.x),y:Math.floor(t.y)},r={x:t.x-1*i.x,y:t.y-1*i.y},s={x:Number.NaN,y:Number.NaN},o;if(i.x<0||i.x>=e.lim[0]||i.y<0||i.y>=e.lim[1])return s;o=i.y*e.lim[0]+i.x;var a={x:e.cvs[o][0],y:e.cvs[o][1]};o++;var u={x:e.cvs[o][0],y:e.cvs[o][1]};o+=e.lim[0];var h={x:e.cvs[o][0],y:e.cvs[o][1]};o--;var d={x:e.cvs[o][0],y:e.cvs[o][1]},g=r.x*r.y,m=r.x*(1-r.y),v=(1-r.x)*(1-r.y),y=(1-r.x)*r.y;return s.x=v*a.x+m*u.x+y*d.x+g*h.x,s.y=v*a.y+m*u.y+y*d.y+g*h.y,s}function CM(n,e,t){var i=t.x,r=t.y,s=t.z||0,o,a,u,h={};for(u=0;u<3;u++)if(!(e&&u===2&&t.z===void 0))switch(u===0?(o=i,"ew".indexOf(n.axis[u])!==-1?a="x":a="y"):u===1?(o=r,"ns".indexOf(n.axis[u])!==-1?a="y":a="x"):(o=s,a="z"),n.axis[u]){case"e":h[a]=o;break;case"w":h[a]=-o;break;case"n":h[a]=o;break;case"s":h[a]=-o;break;case"u":t[a]!==void 0&&(h.z=o);break;case"d":t[a]!==void 0&&(h.z=-o);break;default:return null}return h}function RO(n){var e={x:n[0],y:n[1]};return n.length>2&&(e.z=n[2]),n.length>3&&(e.m=n[3]),e}function lQ(n){MM(n.x),MM(n.y)}function MM(n){if(typeof Number.isFinite=="function"){if(Number.isFinite(n))return;throw new TypeError("coordinates must be finite numbers")}if(typeof n!="number"||n!==n||!isFinite(n))throw new TypeError("coordinates must be finite numbers")}function uQ(n,e){return(n.datum.datum_type===mu||n.datum.datum_type===pu||n.datum.datum_type===th)&&e.datumCode!=="WGS84"||(e.datum.datum_type===mu||e.datum.datum_type===pu||e.datum.datum_type===th)&&n.datumCode!=="WGS84"}function l_(n,e,t,i){var r;Array.isArray(t)?t=RO(t):t={x:t.x,y:t.y,z:t.z,m:t.m};var s=t.z!==void 0;if(lQ(t),n.datum&&e.datum&&uQ(n,e)&&(r=new Ar("WGS84"),t=l_(n,r,t,i),n=r),i&&n.axis!=="enu"&&(t=CM(n,!1,t)),n.projName==="longlat")t={x:t.x*qt,y:t.y*qt,z:t.z||0};else if(n.to_meter&&(t={x:t.x*n.to_meter,y:t.y*n.to_meter,z:t.z||0}),t=n.inverse(t),!t)return;if(n.from_greenwich&&(t.x+=n.from_greenwich),t=oQ(n.datum,e.datum,t),!!t)return t=t,e.from_greenwich&&(t={x:t.x-e.from_greenwich,y:t.y,z:t.z||0}),e.projName==="longlat"?t={x:t.x*ki,y:t.y*ki,z:t.z||0}:(t=e.forward(t),e.to_meter&&(t={x:t.x/e.to_meter,y:t.y/e.to_meter,z:t.z||0})),i&&e.axis!=="enu"?CM(e,!0,t):(t&&!s&&delete t.z,t)}var bM=Ar("WGS84");function Y1(n,e,t,i){var r,s,o;return Array.isArray(t)?(r=l_(n,e,t,i)||{x:NaN,y:NaN},t.length>2?typeof n.name<"u"&&n.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"?typeof r.z=="number"?[r.x,r.y,r.z].concat(t.slice(3)):[r.x,r.y,t[2]].concat(t.slice(3)):[r.x,r.y].concat(t.slice(2)):[r.x,r.y]):(s=l_(n,e,t,i),o=Object.keys(t),o.length===2||o.forEach(function(a){if(typeof n.name<"u"&&n.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"){if(a==="x"||a==="y"||a==="z")return}else if(a==="x"||a==="y")return;s[a]=t[a]}),s)}function bp(n){return n instanceof Ar?n:typeof n=="object"&&"oProj"in n?n.oProj:Ar(n)}function cQ(n,e,t){var i,r,s=!1,o;return typeof e>"u"?(r=bp(n),i=bM,s=!0):(typeof e.x<"u"||Array.isArray(e))&&(t=e,r=bp(n),i=bM,s=!0),i||(i=bp(n)),r||(r=bp(e)),t?Y1(i,r,t):(o={forward:function(a,u){return Y1(i,r,a,u)},inverse:function(a,u){return Y1(r,i,a,u)}},s&&(o.oProj=r),o)}var kM=6,PO="AJSAJS",CO="AFAFAF",Bc=65,Ti=73,yr=79,rf=86,sf=90;const hQ={forward:MO,inverse:dQ,toPoint:bO};function MO(n,e){return e=e||5,mQ(fQ({lat:n[1],lon:n[0]}),e)}function dQ(n){var e=lI(LO(n.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat,e.lon,e.lat]:[e.left,e.bottom,e.right,e.top]}function bO(n){var e=lI(LO(n.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}function Z1(n){return n*(Math.PI/180)}function LM(n){return 180*(n/Math.PI)}function fQ(n){var e=n.lat,t=n.lon,i=6378137,r=.00669438,s=.9996,o,a,u,h,d,g,m,v=Z1(e),y=Z1(t),I,w;w=Math.floor((t+180)/6)+1,t===180&&(w=60),e>=56&&e<64&&t>=3&&t<12&&(w=32),e>=72&&e<84&&(t>=0&&t<9?w=31:t>=9&&t<21?w=33:t>=21&&t<33?w=35:t>=33&&t<42&&(w=37)),o=(w-1)*6-180+3,I=Z1(o),a=r/(1-r),u=i/Math.sqrt(1-r*Math.sin(v)*Math.sin(v)),h=Math.tan(v)*Math.tan(v),d=a*Math.cos(v)*Math.cos(v),g=Math.cos(v)*(y-I),m=i*((1-r/4-3*r*r/64-5*r*r*r/256)*v-(3*r/8+3*r*r/32+45*r*r*r/1024)*Math.sin(2*v)+(15*r*r/256+45*r*r*r/1024)*Math.sin(4*v)-35*r*r*r/3072*Math.sin(6*v));var R=s*u*(g+(1-h+d)*g*g*g/6+(5-18*h+h*h+72*d-58*a)*g*g*g*g*g/120)+5e5,P=s*(m+u*Math.tan(v)*(g*g/2+(5-h+9*d+4*d*d)*g*g*g*g/24+(61-58*h+h*h+600*d-330*a)*g*g*g*g*g*g/720));return e<0&&(P+=1e7),{northing:Math.round(P),easting:Math.round(R),zoneNumber:w,zoneLetter:gQ(e)}}function lI(n){var e=n.northing,t=n.easting,i=n.zoneLetter,r=n.zoneNumber;if(r<0||r>60)return null;var s=.9996,o=6378137,a=.00669438,u,h=(1-Math.sqrt(1-a))/(1+Math.sqrt(1-a)),d,g,m,v,y,I,w,R,P,b=t-5e5,L=e;i<"N"&&(L-=1e7),w=(r-1)*6-180+3,u=a/(1-a),I=L/s,R=I/(o*(1-a/4-3*a*a/64-5*a*a*a/256)),P=R+(3*h/2-27*h*h*h/32)*Math.sin(2*R)+(21*h*h/16-55*h*h*h*h/32)*Math.sin(4*R)+151*h*h*h/96*Math.sin(6*R),d=o/Math.sqrt(1-a*Math.sin(P)*Math.sin(P)),g=Math.tan(P)*Math.tan(P),m=u*Math.cos(P)*Math.cos(P),v=o*(1-a)/Math.pow(1-a*Math.sin(P)*Math.sin(P),1.5),y=b/(d*s);var D=P-d*Math.tan(P)/v*(y*y/2-(5+3*g+10*m-4*m*m-9*u)*y*y*y*y/24+(61+90*g+298*m+45*g*g-252*u-3*m*m)*y*y*y*y*y*y/720);D=LM(D);var B=(y-(1+2*g+m)*y*y*y/6+(5-2*m+28*g-3*m*m+8*u+24*g*g)*y*y*y*y*y/120)/Math.cos(P);B=w+LM(B);var M;if(n.accuracy){var A=lI({northing:n.northing+n.accuracy,easting:n.easting+n.accuracy,zoneLetter:n.zoneLetter,zoneNumber:n.zoneNumber});M={top:A.lat,right:A.lon,bottom:D,left:B}}else M={lat:D,lon:B};return M}function gQ(n){var e="Z";return 84>=n&&n>=72?e="X":72>n&&n>=64?e="W":64>n&&n>=56?e="V":56>n&&n>=48?e="U":48>n&&n>=40?e="T":40>n&&n>=32?e="S":32>n&&n>=24?e="R":24>n&&n>=16?e="Q":16>n&&n>=8?e="P":8>n&&n>=0?e="N":0>n&&n>=-8?e="M":-8>n&&n>=-16?e="L":-16>n&&n>=-24?e="K":-24>n&&n>=-32?e="J":-32>n&&n>=-40?e="H":-40>n&&n>=-48?e="G":-48>n&&n>=-56?e="F":-56>n&&n>=-64?e="E":-64>n&&n>=-72?e="D":-72>n&&n>=-80&&(e="C"),e}function mQ(n,e){var t="00000"+n.easting,i="00000"+n.northing;return n.zoneNumber+n.zoneLetter+pQ(n.easting,n.northing,n.zoneNumber)+t.substr(t.length-5,e)+i.substr(i.length-5,e)}function pQ(n,e,t){var i=kO(t),r=Math.floor(n/1e5),s=Math.floor(e/1e5)%20;return _Q(r,s,i)}function kO(n){var e=n%kM;return e===0&&(e=kM),e}function _Q(n,e,t){var i=t-1,r=PO.charCodeAt(i),s=CO.charCodeAt(i),o=r+n-1,a=s+e,u=!1;o>sf&&(o=o-sf+Bc-1,u=!0),(o===Ti||r<Ti&&o>Ti||(o>Ti||r<Ti)&&u)&&o++,(o===yr||r<yr&&o>yr||(o>yr||r<yr)&&u)&&(o++,o===Ti&&o++),o>sf&&(o=o-sf+Bc-1),a>rf?(a=a-rf+Bc-1,u=!0):u=!1,(a===Ti||s<Ti&&a>Ti||(a>Ti||s<Ti)&&u)&&a++,(a===yr||s<yr&&a>yr||(a>yr||s<yr)&&u)&&(a++,a===Ti&&a++),a>rf&&(a=a-rf+Bc-1);var h=String.fromCharCode(o)+String.fromCharCode(a);return h}function LO(n){if(n&&n.length===0)throw"MGRSPoint coverting from nothing";for(var e=n.length,t=null,i="",r,s=0;!/[A-Z]/.test(r=n.charAt(s));){if(s>=2)throw"MGRSPoint bad conversion from: "+n;i+=r,s++}var o=parseInt(i,10);if(s===0||s+3>e)throw"MGRSPoint bad conversion from: "+n;var a=n.charAt(s++);if(a<="A"||a==="B"||a==="Y"||a>="Z"||a==="I"||a==="O")throw"MGRSPoint zone letter "+a+" not handled: "+n;t=n.substring(s,s+=2);for(var u=kO(o),h=yQ(t.charAt(0),u),d=vQ(t.charAt(1),u);d<EQ(a);)d+=2e6;var g=e-s;if(g%2!==0)throw`MGRSPoint has to have an even number 
of digits after the zone letter and two 100km letters - front 
half for easting meters, second half for 
northing meters`+n;var m=g/2,v=0,y=0,I,w,R,P,b;return m>0&&(I=1e5/Math.pow(10,m),w=n.substring(s,s+m),v=parseFloat(w)*I,R=n.substring(s+m),y=parseFloat(R)*I),P=v+h,b=y+d,{easting:P,northing:b,zoneLetter:a,zoneNumber:o,accuracy:I}}function yQ(n,e){for(var t=PO.charCodeAt(e-1),i=1e5,r=!1;t!==n.charCodeAt(0);){if(t++,t===Ti&&t++,t===yr&&t++,t>sf){if(r)throw"Bad character: "+n;t=Bc,r=!0}i+=1e5}return i}function vQ(n,e){if(n>"V")throw"MGRSPoint given invalid Northing "+n;for(var t=CO.charCodeAt(e-1),i=0,r=!1;t!==n.charCodeAt(0);){if(t++,t===Ti&&t++,t===yr&&t++,t>rf){if(r)throw"Bad character: "+n;t=Bc,r=!0}i+=1e5}return i}function EQ(n){var e;switch(n){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+n}function Ph(n,e,t){if(!(this instanceof Ph))return new Ph(n,e,t);if(Array.isArray(n))this.x=n[0],this.y=n[1],this.z=n[2]||0;else if(typeof n=="object")this.x=n.x,this.y=n.y,this.z=n.z||0;else if(typeof n=="string"&&typeof e>"u"){var i=n.split(",");this.x=parseFloat(i[0]),this.y=parseFloat(i[1]),this.z=parseFloat(i[2])||0}else this.x=n,this.y=e,this.z=t||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}Ph.fromMGRS=function(n){return new Ph(bO(n))};Ph.prototype.toMGRS=function(n){return MO([this.x,this.y],n)};var wQ=1,xQ=.25,DM=.046875,NM=.01953125,OM=.01068115234375,TQ=.75,IQ=.46875,SQ=.013020833333333334,AQ=.007120768229166667,RQ=.3645833333333333,PQ=.005696614583333333,CQ=.3076171875;function uI(n){var e=[];e[0]=wQ-n*(xQ+n*(DM+n*(NM+n*OM))),e[1]=n*(TQ-n*(DM+n*(NM+n*OM)));var t=n*n;return e[2]=t*(IQ-n*(SQ+n*AQ)),t*=n,e[3]=t*(RQ-n*PQ),e[4]=t*n*CQ,e}function jh(n,e,t,i){return t*=e,e*=e,i[0]*n-t*(i[1]+e*(i[2]+e*(i[3]+e*i[4])))}var MQ=20;function cI(n,e,t){for(var i=1/(1-e),r=n,s=MQ;s;--s){var o=Math.sin(r),a=1-e*o*o;if(a=(jh(r,o,Math.cos(r),t)-n)*(a*Math.sqrt(a))*i,r-=a,Math.abs(a)<ge)return r}return r}function bQ(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.es&&(this.en=uI(this.es),this.ml0=jh(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))}function kQ(n){var e=n.x,t=n.y,i=_e(e-this.long0,this.over),r,s,o,a=Math.sin(t),u=Math.cos(t);if(this.es){var d=u*i,g=Math.pow(d,2),m=this.ep2*Math.pow(u,2),v=Math.pow(m,2),y=Math.abs(u)>ge?Math.tan(t):0,I=Math.pow(y,2),w=Math.pow(I,2);r=1-this.es*Math.pow(a,2),d=d/Math.sqrt(r);var R=jh(t,a,u,this.en);s=this.a*(this.k0*d*(1+g/6*(1-I+m+g/20*(5-18*I+w+14*m-58*I*m+g/42*(61+179*w-w*I-479*I)))))+this.x0,o=this.a*(this.k0*(R-this.ml0+a*i*d/2*(1+g/12*(5-I+9*m+4*v+g/30*(61+w-58*I+270*m-330*I*m+g/56*(1385+543*w-w*I-3111*I))))))+this.y0}else{var h=u*Math.sin(i);if(Math.abs(Math.abs(h)-1)<ge)return 93;if(s=.5*this.a*this.k0*Math.log((1+h)/(1-h))+this.x0,o=u*Math.cos(i)/Math.sqrt(1-Math.pow(h,2)),h=Math.abs(o),h>=1){if(h-1>ge)return 93;o=0}else o=Math.acos(o);t<0&&(o=-o),o=this.a*this.k0*(o-this.lat0)+this.y0}return n.x=s,n.y=o,n}function LQ(n){var e,t,i,r,s=(n.x-this.x0)*(1/this.a),o=(n.y-this.y0)*(1/this.a);if(this.es)if(e=this.ml0+o/this.k0,t=cI(e,this.es,this.en),Math.abs(t)<se){var g=Math.sin(t),m=Math.cos(t),v=Math.abs(m)>ge?Math.tan(t):0,y=this.ep2*Math.pow(m,2),I=Math.pow(y,2),w=Math.pow(v,2),R=Math.pow(w,2);e=1-this.es*Math.pow(g,2);var P=s*Math.sqrt(e)/this.k0,b=Math.pow(P,2);e=e*v,i=t-e*b/(1-this.es)*.5*(1-b/12*(5+3*w-9*y*w+y-4*I-b/30*(61+90*w-252*y*w+45*R+46*y-b/56*(1385+3633*w+4095*R+1574*R*w)))),r=_e(this.long0+P*(1-b/6*(1+2*w+y-b/20*(5+28*w+24*R+8*y*w+6*y-b/42*(61+662*w+1320*R+720*R*w))))/m,this.over)}else i=se*$g(o),r=0;else{var a=Math.exp(s/this.k0),u=.5*(a-1/a),h=this.lat0+o/this.k0,d=Math.cos(h);e=Math.sqrt((1-Math.pow(d,2))/(1+Math.pow(u,2))),i=Math.asin(e),o<0&&(i=-i),u===0&&d===0?r=0:r=_e(Math.atan2(u,d)+this.long0,this.over)}return n.x=r,n.y=i,n}var DQ=["Fast_Transverse_Mercator","Fast Transverse Mercator"];const t0={init:bQ,forward:kQ,inverse:LQ,names:DQ};function DO(n){var e=Math.exp(n);return e=(e-1/e)/2,e}function Ci(n,e){n=Math.abs(n),e=Math.abs(e);var t=Math.max(n,e),i=Math.min(n,e)/(t||1);return t*Math.sqrt(1+Math.pow(i,2))}function NQ(n){var e=1+n,t=e-1;return t===0?n:n*Math.log(e)/t}function OQ(n){var e=Math.abs(n);return e=NQ(e*(1+e/(Ci(1,e)+1))),n<0?-e:e}function hI(n,e){for(var t=2*Math.cos(2*e),i=n.length-1,r=n[i],s=0,o;--i>=0;)o=-s+t*r+n[i],s=r,r=o;return e+o*Math.sin(2*e)}function VQ(n,e){for(var t=2*Math.cos(e),i=n.length-1,r=n[i],s=0,o;--i>=0;)o=-s+t*r+n[i],s=r,r=o;return Math.sin(e)*o}function FQ(n){var e=Math.exp(n);return e=(e+1/e)/2,e}function NO(n,e,t){for(var i=Math.sin(e),r=Math.cos(e),s=DO(t),o=FQ(t),a=2*r*o,u=-2*i*s,h=n.length-1,d=n[h],g=0,m=0,v=0,y,I;--h>=0;)y=m,I=g,m=d,g=v,d=-y+a*m-u*g+n[h],v=-I+u*m+a*g;return a=i*o,u=r*s,[a*d-u*v,a*v+u*d]}function GQ(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(t0.init.apply(this),this.forward=t0.forward,this.inverse=t0.inverse),this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var n=this.es/(1+Math.sqrt(1-this.es)),e=n/(2-n),t=e;this.cgb[0]=e*(2+e*(-2/3+e*(-2+e*(116/45+e*(26/45+e*(-2854/675)))))),this.cbg[0]=e*(-2+e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725)))))),t=t*e,this.cgb[1]=t*(7/3+e*(-8/5+e*(-227/45+e*(2704/315+e*(2323/945))))),this.cbg[1]=t*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945))))),t=t*e,this.cgb[2]=t*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835)))),this.cbg[2]=t*(-26/15+e*(34/21+e*(8/5+e*(-12686/2835)))),t=t*e,this.cgb[3]=t*(4279/630+e*(-332/35+e*(-399572/14175))),this.cbg[3]=t*(1237/630+e*(-12/5+e*(-24832/14175))),t=t*e,this.cgb[4]=t*(4174/315+e*(-144838/6237)),this.cbg[4]=t*(-734/315+e*(109598/31185)),t=t*e,this.cgb[5]=t*(601676/22275),this.cbg[5]=t*(444337/155925),t=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+t*(1/4+t*(1/64+t/256))),this.utg[0]=e*(-.5+e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800)))))),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800)))))),this.utg[1]=t*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720))))),this.gtu[1]=t*(13/48+e*(-3/5+e*(557/1440+e*(281/630+e*(-1983433/1935360))))),t=t*e,this.utg[2]=t*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720)))),this.gtu[2]=t*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440)))),t=t*e,this.utg[3]=t*(-4397/161280+e*(11/504+e*(830251/7257600))),this.gtu[3]=t*(49561/161280+e*(-179/168+e*(6601661/7257600))),t=t*e,this.utg[4]=t*(-4583/161280+e*(108847/3991680)),this.gtu[4]=t*(34729/80640+e*(-3418889/1995840)),t=t*e,this.utg[5]=t*(-20648693/638668800),this.gtu[5]=t*(212378941/319334400);var i=hI(this.cbg,this.lat0);this.Zb=-this.Qn*(i+VQ(this.gtu,2*i))}function jQ(n){var e=_e(n.x-this.long0,this.over),t=n.y;t=hI(this.cbg,t);var i=Math.sin(t),r=Math.cos(t),s=Math.sin(e),o=Math.cos(e);t=Math.atan2(i,o*r),e=Math.atan2(s*r,Ci(i,r*o)),e=OQ(Math.tan(e));var a=NO(this.gtu,2*t,2*e);t=t+a[0],e=e+a[1];var u,h;return Math.abs(e)<=2.623395162778?(u=this.a*(this.Qn*e)+this.x0,h=this.a*(this.Qn*t+this.Zb)+this.y0):(u=1/0,h=1/0),n.x=u,n.y=h,n}function UQ(n){var e=(n.x-this.x0)*(1/this.a),t=(n.y-this.y0)*(1/this.a);t=(t-this.Zb)/this.Qn,e=e/this.Qn;var i,r;if(Math.abs(e)<=2.623395162778){var s=NO(this.utg,2*t,2*e);t=t+s[0],e=e+s[1],e=Math.atan(DO(e));var o=Math.sin(t),a=Math.cos(t),u=Math.sin(e),h=Math.cos(e);t=Math.atan2(o*h,Ci(u,h*a)),e=Math.atan2(u,h*a),i=_e(e+this.long0,this.over),r=hI(this.cgb,t)}else i=1/0,r=1/0;return n.x=i,n.y=r,n}var BQ=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"];const n0={init:GQ,forward:jQ,inverse:UQ,names:BQ};function zQ(n,e){if(n===void 0){if(n=Math.floor((_e(e)+Math.PI)*30/Math.PI)+1,n<0)return 0;if(n>60)return 60}return n}var $Q="etmerc";function WQ(){var n=zQ(this.zone,this.long0);if(n===void 0)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(n)-183)*qt,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,n0.init.apply(this),this.forward=n0.forward,this.inverse=n0.inverse}var KQ=["Universal Transverse Mercator System","utm"];const qQ={init:WQ,names:KQ,dependsOn:$Q};function dI(n,e){return Math.pow((1-n)/(1+n),e)}var HQ=20;function XQ(){var n=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*n*n),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(n/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+mt)/(Math.pow(Math.tan(.5*this.lat0+mt),this.C)*dI(this.e*n,this.ratexp))}function YQ(n){var e=n.x,t=n.y;return n.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*t+mt),this.C)*dI(this.e*Math.sin(t),this.ratexp))-se,n.x=this.C*e,n}function ZQ(n){for(var e=1e-14,t=n.x/this.C,i=n.y,r=Math.pow(Math.tan(.5*i+mt)/this.K,1/this.C),s=HQ;s>0&&(i=2*Math.atan(r*dI(this.e*Math.sin(n.y),-.5*this.e))-se,!(Math.abs(i-n.y)<e));--s)n.y=i;return s?(n.x=t,n.y=i,n):null}const fI={init:XQ,forward:YQ,inverse:ZQ};function QQ(){fI.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))}function JQ(n){var e,t,i,r;return n.x=_e(n.x-this.long0,this.over),fI.forward.apply(this,[n]),e=Math.sin(n.y),t=Math.cos(n.y),i=Math.cos(n.x),r=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*t*i),n.x=r*t*Math.sin(n.x),n.y=r*(this.cosc0*e-this.sinc0*t*i),n.x=this.a*n.x+this.x0,n.y=this.a*n.y+this.y0,n}function eJ(n){var e,t,i,r,s;if(n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,n.x/=this.k0,n.y/=this.k0,s=Ci(n.x,n.y)){var o=2*Math.atan2(s,this.R2);e=Math.sin(o),t=Math.cos(o),r=Math.asin(t*this.sinc0+n.y*e*this.cosc0/s),i=Math.atan2(n.x*e,s*this.cosc0*t-n.y*this.sinc0*e)}else r=this.phic0,i=0;return n.x=i,n.y=r,fI.inverse.apply(this,[n]),n.x=_e(n.x+this.long0,this.over),n}var tJ=["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"];const nJ={init:QQ,forward:JQ,inverse:eJ,names:tJ};function gI(n,e,t){return e*=t,Math.tan(.5*(se+n))*Math.pow((1-e)/(1+e),.5*t)}function iJ(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=ge&&(this.k0=.5*(1+$g(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=ge&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=ge&&Math.abs(Math.cos(this.lat_ts))>ge&&(this.k0=.5*this.cons*Ds(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/Xr(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=Ds(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(gI(this.lat0,this.sinlat0,this.e))-se,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function rJ(n){var e=n.x,t=n.y,i=Math.sin(t),r=Math.cos(t),s,o,a,u,h,d,g=_e(e-this.long0,this.over);return Math.abs(Math.abs(e-this.long0)-Math.PI)<=ge&&Math.abs(t+this.lat0)<=ge?(n.x=NaN,n.y=NaN,n):this.sphere?(s=2*this.k0/(1+this.sinlat0*i+this.coslat0*r*Math.cos(g)),n.x=this.a*s*r*Math.sin(g)+this.x0,n.y=this.a*s*(this.coslat0*i-this.sinlat0*r*Math.cos(g))+this.y0,n):(o=2*Math.atan(gI(t,i,this.e))-se,u=Math.cos(o),a=Math.sin(o),Math.abs(this.coslat0)<=ge?(h=Xr(this.e,t*this.con,this.con*i),d=2*this.a*this.k0*h/this.cons,n.x=this.x0+d*Math.sin(e-this.long0),n.y=this.y0-this.con*d*Math.cos(e-this.long0),n):(Math.abs(this.sinlat0)<ge?(s=2*this.a*this.k0/(1+u*Math.cos(g)),n.y=s*a):(s=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*a+this.cosX0*u*Math.cos(g))),n.y=s*(this.cosX0*a-this.sinX0*u*Math.cos(g))+this.y0),n.x=s*u*Math.sin(g)+this.x0,n))}function sJ(n){n.x-=this.x0,n.y-=this.y0;var e,t,i,r,s,o=Math.sqrt(n.x*n.x+n.y*n.y);if(this.sphere){var a=2*Math.atan(o/(2*this.a*this.k0));return e=this.long0,t=this.lat0,o<=ge?(n.x=e,n.y=t,n):(t=Math.asin(Math.cos(a)*this.sinlat0+n.y*Math.sin(a)*this.coslat0/o),Math.abs(this.coslat0)<ge?this.lat0>0?e=_e(this.long0+Math.atan2(n.x,-1*n.y),this.over):e=_e(this.long0+Math.atan2(n.x,n.y),this.over):e=_e(this.long0+Math.atan2(n.x*Math.sin(a),o*this.coslat0*Math.cos(a)-n.y*this.sinlat0*Math.sin(a)),this.over),n.x=e,n.y=t,n)}else if(Math.abs(this.coslat0)<=ge){if(o<=ge)return t=this.lat0,e=this.long0,n.x=e,n.y=t,n;n.x*=this.con,n.y*=this.con,i=o*this.cons/(2*this.a*this.k0),t=this.con*hg(this.e,i),e=this.con*_e(this.con*this.long0+Math.atan2(n.x,-1*n.y),this.over)}else r=2*Math.atan(o*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,o<=ge?s=this.X0:(s=Math.asin(Math.cos(r)*this.sinX0+n.y*Math.sin(r)*this.cosX0/o),e=_e(this.long0+Math.atan2(n.x*Math.sin(r),o*this.cosX0*Math.cos(r)-n.y*this.sinX0*Math.sin(r)),this.over)),t=-1*hg(this.e,Math.tan(.5*(se+s)));return n.x=e,n.y=t,n}var oJ=["stere","Stereographic_South_Pole","Polar_Stereographic_variant_A","Polar_Stereographic_variant_B","Polar_Stereographic"];const aJ={init:iJ,forward:rJ,inverse:sJ,names:oJ,ssfn_:gI};function lJ(){var n=this.lat0;this.lambda0=this.long0;var e=Math.sin(n),t=this.a,i=this.rf,r=1/i,s=2*r-Math.pow(r,2),o=this.e=Math.sqrt(s);this.R=this.k0*t*Math.sqrt(1-s)/(1-s*Math.pow(e,2)),this.alpha=Math.sqrt(1+s/(1-s)*Math.pow(Math.cos(n),4)),this.b0=Math.asin(e/this.alpha);var a=Math.log(Math.tan(Math.PI/4+this.b0/2)),u=Math.log(Math.tan(Math.PI/4+n/2)),h=Math.log((1+o*e)/(1-o*e));this.K=a-this.alpha*u+this.alpha*o/2*h}function uJ(n){var e=Math.log(Math.tan(Math.PI/4-n.y/2)),t=this.e/2*Math.log((1+this.e*Math.sin(n.y))/(1-this.e*Math.sin(n.y))),i=-this.alpha*(e+t)+this.K,r=2*(Math.atan(Math.exp(i))-Math.PI/4),s=this.alpha*(n.x-this.lambda0),o=Math.atan(Math.sin(s)/(Math.sin(this.b0)*Math.tan(r)+Math.cos(this.b0)*Math.cos(s))),a=Math.asin(Math.cos(this.b0)*Math.sin(r)-Math.sin(this.b0)*Math.cos(r)*Math.cos(s));return n.y=this.R/2*Math.log((1+Math.sin(a))/(1-Math.sin(a)))+this.y0,n.x=this.R*o+this.x0,n}function cJ(n){for(var e=n.x-this.x0,t=n.y-this.y0,i=e/this.R,r=2*(Math.atan(Math.exp(t/this.R))-Math.PI/4),s=Math.asin(Math.cos(this.b0)*Math.sin(r)+Math.sin(this.b0)*Math.cos(r)*Math.cos(i)),o=Math.atan(Math.sin(i)/(Math.cos(this.b0)*Math.cos(i)-Math.sin(this.b0)*Math.tan(r))),a=this.lambda0+o/this.alpha,u=0,h=s,d=-1e3,g=0;Math.abs(h-d)>1e-7;){if(++g>20)return;u=1/this.alpha*(Math.log(Math.tan(Math.PI/4+s/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(h))/2)),d=h,h=2*Math.atan(Math.exp(u))-Math.PI/2}return n.x=a,n.y=h,n}var hJ=["somerc"];const dJ={init:lJ,forward:uJ,inverse:cJ,names:hJ};var bc=1e-7;function fJ(n){var e=["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"],t=typeof n.projName=="object"?Object.keys(n.projName)[0]:n.projName;return"no_uoff"in n||"no_off"in n||e.indexOf(t)!==-1||e.indexOf(TO(t))!==-1}function gJ(){var n,e,t,i,r,s,o,a,u,h,d=0,g,m=0,v=0,y=0,I=0,w=0,R=0;this.no_off=fJ(this),this.no_rot="no_rot"in this;var P=!1;"alpha"in this&&(P=!0);var b=!1;if("rectified_grid_angle"in this&&(b=!0),P&&(R=this.alpha),b&&(d=this.rectified_grid_angle),P||b)m=this.longc;else if(v=this.long1,I=this.lat1,y=this.long2,w=this.lat2,Math.abs(I-w)<=bc||(n=Math.abs(I))<=bc||Math.abs(n-se)<=bc||Math.abs(Math.abs(this.lat0)-se)<=bc||Math.abs(Math.abs(w)-se)<=bc)throw new Error;var L=1-this.es;e=Math.sqrt(L),Math.abs(this.lat0)>ge?(a=Math.sin(this.lat0),t=Math.cos(this.lat0),n=1-this.es*a*a,this.B=t*t,this.B=Math.sqrt(1+this.es*this.B*this.B/L),this.A=this.B*this.k0*e/n,i=this.B*e/(t*Math.sqrt(n)),r=i*i-1,r<=0?r=0:(r=Math.sqrt(r),this.lat0<0&&(r=-r)),this.E=r+=i,this.E*=Math.pow(Xr(this.e,this.lat0,a),this.B)):(this.B=1/e,this.A=this.k0,this.E=i=r=1),P||b?(P?(g=Math.asin(Math.sin(R)/i),b||(d=R)):(g=d,R=Math.asin(i*Math.sin(g))),this.lam0=m-Math.asin(.5*(r-1/r)*Math.tan(g))/this.B):(s=Math.pow(Xr(this.e,I,Math.sin(I)),this.B),o=Math.pow(Xr(this.e,w,Math.sin(w)),this.B),r=this.E/s,u=(o-s)/(o+s),h=this.E*this.E,h=(h-o*s)/(h+o*s),n=v-y,n<-Math.PI?y-=ug:n>Math.PI&&(y+=ug),this.lam0=_e(.5*(v+y)-Math.atan(h*Math.tan(.5*this.B*(v-y))/u)/this.B,this.over),g=Math.atan(2*Math.sin(this.B*_e(v-this.lam0,this.over))/(r-1/r)),d=R=Math.asin(i*Math.sin(g))),this.singam=Math.sin(g),this.cosgam=Math.cos(g),this.sinrot=Math.sin(d),this.cosrot=Math.cos(d),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(i*i-1)/Math.cos(R))),this.lat0<0&&(this.u_0=-this.u_0)),r=.5*g,this.v_pole_n=this.ArB*Math.log(Math.tan(mt-r)),this.v_pole_s=this.ArB*Math.log(Math.tan(mt+r))}function mJ(n){var e={},t,i,r,s,o,a,u,h;if(n.x=n.x-this.lam0,Math.abs(Math.abs(n.y)-se)>ge){if(o=this.E/Math.pow(Xr(this.e,n.y,Math.sin(n.y)),this.B),a=1/o,t=.5*(o-a),i=.5*(o+a),s=Math.sin(this.B*n.x),r=(t*this.singam-s*this.cosgam)/i,Math.abs(Math.abs(r)-1)<ge)throw new Error;h=.5*this.ArB*Math.log((1-r)/(1+r)),a=Math.cos(this.B*n.x),Math.abs(a)<bc?u=this.A*n.x:u=this.ArB*Math.atan2(t*this.cosgam+s*this.singam,a)}else h=n.y>0?this.v_pole_n:this.v_pole_s,u=this.ArB*n.y;return this.no_rot?(e.x=u,e.y=h):(u-=this.u_0,e.x=h*this.cosrot+u*this.sinrot,e.y=u*this.cosrot-h*this.sinrot),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e}function pJ(n){var e,t,i,r,s,o,a,u={};if(n.x=(n.x-this.x0)*(1/this.a),n.y=(n.y-this.y0)*(1/this.a),this.no_rot?(t=n.y,e=n.x):(t=n.x*this.cosrot-n.y*this.sinrot,e=n.y*this.cosrot+n.x*this.sinrot+this.u_0),i=Math.exp(-this.BrA*t),r=.5*(i-1/i),s=.5*(i+1/i),o=Math.sin(this.BrA*e),a=(o*this.cosgam+r*this.singam)/s,Math.abs(Math.abs(a)-1)<ge)u.x=0,u.y=a<0?-se:se;else{if(u.y=this.E/Math.sqrt((1+a)/(1-a)),u.y=hg(this.e,Math.pow(u.y,1/this.B)),u.y===1/0)throw new Error;u.x=-this.rB*Math.atan2(r*this.cosgam-o*this.singam,Math.cos(this.BrA*e))}return u.x+=this.lam0,u}var _J=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Variant_B","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"];const yJ={init:gJ,forward:mJ,inverse:pJ,names:_J};function vJ(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<ge)){var n=this.b/this.a;this.e=Math.sqrt(1-n*n);var e=Math.sin(this.lat1),t=Math.cos(this.lat1),i=Ds(this.e,e,t),r=Xr(this.e,this.lat1,e),s=Math.sin(this.lat2),o=Math.cos(this.lat2),a=Ds(this.e,s,o),u=Xr(this.e,this.lat2,s),h=Math.abs(Math.abs(this.lat0)-se)<ge?0:Xr(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>ge?this.ns=Math.log(i/a)/Math.log(r/u):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=i/(this.ns*Math.pow(r,this.ns)),this.rh=this.a*this.f0*Math.pow(h,this.ns),this.title||(this.title="Lambert Conformal Conic")}}function EJ(n){var e=n.x,t=n.y;Math.abs(2*Math.abs(t)-Math.PI)<=ge&&(t=$g(t)*(se-2*ge));var i=Math.abs(Math.abs(t)-se),r,s;if(i>ge)r=Xr(this.e,t,Math.sin(t)),s=this.a*this.f0*Math.pow(r,this.ns);else{if(i=t*this.ns,i<=0)return null;s=0}var o=this.ns*_e(e-this.long0,this.over);return n.x=this.k0*(s*Math.sin(o))+this.x0,n.y=this.k0*(this.rh-s*Math.cos(o))+this.y0,n}function wJ(n){var e,t,i,r,s,o=(n.x-this.x0)/this.k0,a=this.rh-(n.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(o*o+a*a),t=1):(e=-Math.sqrt(o*o+a*a),t=-1);var u=0;if(e!==0&&(u=Math.atan2(t*o,t*a)),e!==0||this.ns>0){if(t=1/this.ns,i=Math.pow(e/(this.a*this.f0),t),r=hg(this.e,i),r===-9999)return null}else r=-se;return s=_e(u/this.ns+this.long0,this.over),n.x=s,n.y=r,n}var xJ=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"];const TJ={init:vJ,forward:EJ,inverse:wJ,names:xJ};function IJ(){this.a=6377397155e-3,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.7417649320975901-.308341501185665),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq}function SJ(n){var e,t,i,r,s,o,a,u=n.x,h=n.y,d=_e(u-this.long0,this.over);return e=Math.pow((1+this.e*Math.sin(h))/(1-this.e*Math.sin(h)),this.alfa*this.e/2),t=2*(Math.atan(this.k*Math.pow(Math.tan(h/2+this.s45),this.alfa)/e)-this.s45),i=-d*this.alfa,r=Math.asin(Math.cos(this.ad)*Math.sin(t)+Math.sin(this.ad)*Math.cos(t)*Math.cos(i)),s=Math.asin(Math.cos(t)*Math.sin(i)/Math.cos(r)),o=this.n*s,a=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(r/2+this.s45),this.n),n.y=a*Math.cos(o)/1,n.x=a*Math.sin(o)/1,this.czech||(n.y*=-1,n.x*=-1),n}function AJ(n){var e,t,i,r,s,o,a,u,h=n.x;n.x=n.y,n.y=h,this.czech||(n.y*=-1,n.x*=-1),o=Math.sqrt(n.x*n.x+n.y*n.y),s=Math.atan2(n.y,n.x),r=s/Math.sin(this.s0),i=2*(Math.atan(Math.pow(this.ro0/o,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(i)-Math.sin(this.ad)*Math.cos(i)*Math.cos(r)),t=Math.asin(Math.cos(i)*Math.sin(r)/Math.cos(e)),n.x=this.long0-t/this.alfa,a=e,u=0;var d=0;do n.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(a))/(1-this.e*Math.sin(a)),this.e/2))-this.s45),Math.abs(a-n.y)<1e-10&&(u=1),a=n.y,d+=1;while(u===0&&d<15);return d>=15?null:n}var RJ=["Krovak","krovak"];const PJ={init:IJ,forward:SJ,inverse:AJ,names:RJ};function hi(n,e,t,i,r){return n*r-e*Math.sin(2*r)+t*Math.sin(4*r)-i*Math.sin(6*r)}function Wg(n){return 1-.25*n*(1+n/16*(3+1.25*n))}function Kg(n){return .375*n*(1+.25*n*(1+.46875*n))}function qg(n){return .05859375*n*n*(1+.75*n)}function Hg(n){return n*n*n*(35/3072)}function mI(n,e,t){var i=e*t;return n/Math.sqrt(1-i*i)}function Ha(n){return Math.abs(n)<se?n:n-$g(n)*Math.PI}function u_(n,e,t,i,r){var s,o;s=n/e;for(var a=0;a<15;a++)if(o=(n-(e*s-t*Math.sin(2*s)+i*Math.sin(4*s)-r*Math.sin(6*s)))/(e-2*t*Math.cos(2*s)+4*i*Math.cos(4*s)-6*r*Math.cos(6*s)),s+=o,Math.abs(o)<=1e-10)return s;return NaN}function CJ(){this.sphere||(this.e0=Wg(this.es),this.e1=Kg(this.es),this.e2=qg(this.es),this.e3=Hg(this.es),this.ml0=this.a*hi(this.e0,this.e1,this.e2,this.e3,this.lat0))}function MJ(n){var e,t,i=n.x,r=n.y;if(i=_e(i-this.long0,this.over),this.sphere)e=this.a*Math.asin(Math.cos(r)*Math.sin(i)),t=this.a*(Math.atan2(Math.tan(r),Math.cos(i))-this.lat0);else{var s=Math.sin(r),o=Math.cos(r),a=mI(this.a,this.e,s),u=Math.tan(r)*Math.tan(r),h=i*Math.cos(r),d=h*h,g=this.es*o*o/(1-this.es),m=this.a*hi(this.e0,this.e1,this.e2,this.e3,r);e=a*h*(1-d*u*(1/6-(8-u+8*g)*d/120)),t=m-this.ml0+a*s/o*d*(.5+(5-u+6*g)*d/24)}return n.x=e+this.x0,n.y=t+this.y0,n}function bJ(n){n.x-=this.x0,n.y-=this.y0;var e=n.x/this.a,t=n.y/this.a,i,r;if(this.sphere){var s=t+this.lat0;i=Math.asin(Math.sin(s)*Math.cos(e)),r=Math.atan2(Math.tan(e),Math.cos(s))}else{var o=this.ml0/this.a+t,a=u_(o,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(a)-se)<=ge)return n.x=this.long0,n.y=se,t<0&&(n.y*=-1),n;var u=mI(this.a,this.e,Math.sin(a)),h=u*u*u/this.a/this.a*(1-this.es),d=Math.pow(Math.tan(a),2),g=e*this.a/u,m=g*g;i=a-u*Math.tan(a)/h*g*g*(.5-(1+3*d)*g*g/24),r=g*(1-m*(d/3+(1+3*d)*d*m/15))/Math.cos(a)}return n.x=_e(r+this.long0,this.over),n.y=Ha(i),n}var kJ=["Cassini","Cassini_Soldner","cass"];const LJ={init:CJ,forward:MJ,inverse:bJ,names:kJ};function Ma(n,e){var t;return n>1e-7?(t=n*e,(1-n*n)*(e/(1-t*t)-.5/n*Math.log((1-t)/(1+t)))):2*e}var Cw=1,Mw=2,bw=3,i0=4;function DJ(){var n=Math.abs(this.lat0);if(Math.abs(n-se)<ge?this.mode=this.lat0<0?Cw:Mw:Math.abs(n)<ge?this.mode=bw:this.mode=i0,this.es>0){var e;switch(this.qp=Ma(this.e,1),this.mmf=.5/(1-this.es),this.apa=zJ(this.es),this.mode){case Mw:this.dd=1;break;case Cw:this.dd=1;break;case bw:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case i0:this.rq=Math.sqrt(.5*this.qp),e=Math.sin(this.lat0),this.sinb1=Ma(this.e,e)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*e*e)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd;break}}else this.mode===i0&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function NJ(n){var e,t,i,r,s,o,a,u,h,d,g=n.x,m=n.y;if(g=_e(g-this.long0,this.over),this.sphere){if(s=Math.sin(m),d=Math.cos(m),i=Math.cos(g),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(t=this.mode===this.EQUIT?1+d*i:1+this.sinph0*s+this.cosph0*d*i,t<=ge)return null;t=Math.sqrt(2/t),e=t*d*Math.sin(g),t*=this.mode===this.EQUIT?s:this.cosph0*s-this.sinph0*d*i}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(i=-i),Math.abs(m+this.lat0)<ge)return null;t=mt-m*.5,t=2*(this.mode===this.S_POLE?Math.cos(t):Math.sin(t)),e=t*Math.sin(g),t*=i}}else{switch(a=0,u=0,h=0,i=Math.cos(g),r=Math.sin(g),s=Math.sin(m),o=Ma(this.e,s),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(a=o/this.qp,u=Math.sqrt(1-a*a)),this.mode){case this.OBLIQ:h=1+this.sinb1*a+this.cosb1*u*i;break;case this.EQUIT:h=1+u*i;break;case this.N_POLE:h=se+m,o=this.qp-o;break;case this.S_POLE:h=m-se,o=this.qp+o;break}if(Math.abs(h)<ge)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:h=Math.sqrt(2/h),this.mode===this.OBLIQ?t=this.ymf*h*(this.cosb1*a-this.sinb1*u*i):t=(h=Math.sqrt(2/(1+u*i)))*a*this.ymf,e=this.xmf*h*u*r;break;case this.N_POLE:case this.S_POLE:o>=0?(e=(h=Math.sqrt(o))*r,t=i*(this.mode===this.S_POLE?h:-h)):e=t=0;break}}return n.x=this.a*e+this.x0,n.y=this.a*t+this.y0,n}function OJ(n){n.x-=this.x0,n.y-=this.y0;var e=n.x/this.a,t=n.y/this.a,i,r,s,o,a,u,h;if(this.sphere){var d=0,g,m=0;if(g=Math.sqrt(e*e+t*t),r=g*.5,r>1)return null;switch(r=2*Math.asin(r),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(m=Math.sin(r),d=Math.cos(r)),this.mode){case this.EQUIT:r=Math.abs(g)<=ge?0:Math.asin(t*m/g),e*=m,t=d*g;break;case this.OBLIQ:r=Math.abs(g)<=ge?this.lat0:Math.asin(d*this.sinph0+t*m*this.cosph0/g),e*=m*this.cosph0,t=(d-Math.sin(r)*this.sinph0)*g;break;case this.N_POLE:t=-t,r=se-r;break;case this.S_POLE:r-=se;break}i=t===0&&(this.mode===this.EQUIT||this.mode===this.OBLIQ)?0:Math.atan2(e,t)}else{if(h=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(e/=this.dd,t*=this.dd,u=Math.sqrt(e*e+t*t),u<ge)return n.x=this.long0,n.y=this.lat0,n;o=2*Math.asin(.5*u/this.rq),s=Math.cos(o),e*=o=Math.sin(o),this.mode===this.OBLIQ?(h=s*this.sinb1+t*o*this.cosb1/u,a=this.qp*h,t=u*this.cosb1*s-t*this.sinb1*o):(h=t*o/u,a=this.qp*h,t=u*s)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(t=-t),a=e*e+t*t,!a)return n.x=this.long0,n.y=this.lat0,n;h=1-a/this.qp,this.mode===this.S_POLE&&(h=-h)}i=Math.atan2(e,t),r=$J(Math.asin(h),this.apa)}return n.x=_e(this.long0+i,this.over),n.y=r,n}var VJ=.3333333333333333,FJ=.17222222222222222,GJ=.10257936507936508,jJ=.06388888888888888,UJ=.0664021164021164,BJ=.016415012942191543;function zJ(n){var e,t=[];return t[0]=n*VJ,e=n*n,t[0]+=e*FJ,t[1]=e*jJ,e*=n,t[0]+=e*GJ,t[1]+=e*UJ,t[2]=e*BJ,t}function $J(n,e){var t=n+n;return n+e[0]*Math.sin(t)+e[1]*Math.sin(t+t)+e[2]*Math.sin(t+t+t)}var WJ=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"];const KJ={init:DJ,forward:NJ,inverse:OJ,names:WJ,S_POLE:Cw,N_POLE:Mw,EQUIT:bw,OBLIQ:i0};function Ba(n){return Math.abs(n)>1&&(n=n>1?1:-1),Math.asin(n)}function qJ(){Math.abs(this.lat1+this.lat2)<ge||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=Ds(this.e3,this.sin_po,this.cos_po),this.qs1=Ma(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=Ds(this.e3,this.sin_po,this.cos_po),this.qs2=Ma(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=Ma(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>ge?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function HJ(n){var e=n.x,t=n.y;this.sin_phi=Math.sin(t),this.cos_phi=Math.cos(t);var i=Ma(this.e3,this.sin_phi),r=this.a*Math.sqrt(this.c-this.ns0*i)/this.ns0,s=this.ns0*_e(e-this.long0,this.over),o=r*Math.sin(s)+this.x0,a=this.rh-r*Math.cos(s)+this.y0;return n.x=o,n.y=a,n}function XJ(n){var e,t,i,r,s,o;return n.x-=this.x0,n.y=this.rh-n.y+this.y0,this.ns0>=0?(e=Math.sqrt(n.x*n.x+n.y*n.y),i=1):(e=-Math.sqrt(n.x*n.x+n.y*n.y),i=-1),r=0,e!==0&&(r=Math.atan2(i*n.x,i*n.y)),i=e*this.ns0/this.a,this.sphere?o=Math.asin((this.c-i*i)/(2*this.ns0)):(t=(this.c-i*i)/this.ns0,o=this.phi1z(this.e3,t)),s=_e(r/this.ns0+this.long0,this.over),n.x=s,n.y=o,n}function YJ(n,e){var t,i,r,s,o,a=Ba(.5*e);if(n<ge)return a;for(var u=n*n,h=1;h<=25;h++)if(t=Math.sin(a),i=Math.cos(a),r=n*t,s=1-r*r,o=.5*s*s/i*(e/(1-u)-t/s+.5/n*Math.log((1-r)/(1+r))),a=a+o,Math.abs(o)<=1e-7)return a;return null}var ZJ=["Albers_Conic_Equal_Area","Albers_Equal_Area","Albers","aea"];const QJ={init:qJ,forward:HJ,inverse:XJ,names:ZJ,phi1z:YJ};function JJ(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1}function eee(n){var e,t,i,r,s,o,a,u,h=n.x,d=n.y;return i=_e(h-this.long0,this.over),e=Math.sin(d),t=Math.cos(d),r=Math.cos(i),o=this.sin_p14*e+this.cos_p14*t*r,s=1,o>0||Math.abs(o)<=ge?(a=this.x0+this.a*s*t*Math.sin(i)/o,u=this.y0+this.a*s*(this.cos_p14*e-this.sin_p14*t*r)/o):(a=this.x0+this.infinity_dist*t*Math.sin(i),u=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*t*r)),n.x=a,n.y=u,n}function tee(n){var e,t,i,r,s,o;return n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,n.x/=this.k0,n.y/=this.k0,(e=Math.sqrt(n.x*n.x+n.y*n.y))?(r=Math.atan2(e,this.rc),t=Math.sin(r),i=Math.cos(r),o=Ba(i*this.sin_p14+n.y*t*this.cos_p14/e),s=Math.atan2(n.x*t,e*this.cos_p14*i-n.y*this.sin_p14*t),s=_e(this.long0+s,this.over)):(o=this.phic0,s=0),n.x=s,n.y=o,n}var nee=["gnom"];const iee={init:JJ,forward:eee,inverse:tee,names:nee};function ree(n,e){var t=1-(1-n*n)/(2*n)*Math.log((1-n)/(1+n));if(Math.abs(Math.abs(e)-t)<1e-6)return e<0?-1*se:se;for(var i=Math.asin(.5*e),r,s,o,a,u=0;u<30;u++)if(s=Math.sin(i),o=Math.cos(i),a=n*s,r=Math.pow(1-a*a,2)/(2*o)*(e/(1-n*n)-s/(1-a*a)+.5/n*Math.log((1-a)/(1+a))),i+=r,Math.abs(r)<=1e-10)return i;return NaN}function see(){this.sphere||(this.k0=Ds(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))}function oee(n){var e=n.x,t=n.y,i,r,s=_e(e-this.long0,this.over);if(this.sphere)i=this.x0+this.a*s*Math.cos(this.lat_ts),r=this.y0+this.a*Math.sin(t)/Math.cos(this.lat_ts);else{var o=Ma(this.e,Math.sin(t));i=this.x0+this.a*this.k0*s,r=this.y0+this.a*o*.5/this.k0}return n.x=i,n.y=r,n}function aee(n){n.x-=this.x0,n.y-=this.y0;var e,t;return this.sphere?(e=_e(this.long0+n.x/this.a/Math.cos(this.lat_ts),this.over),t=Math.asin(n.y/this.a*Math.cos(this.lat_ts))):(t=ree(this.e,2*n.y*this.k0/this.a),e=_e(this.long0+n.x/(this.a*this.k0),this.over)),n.x=e,n.y=t,n}var lee=["cea"];const uee={init:see,forward:oee,inverse:aee,names:lee};function cee(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)}function hee(n){var e=n.x,t=n.y,i=_e(e-this.long0,this.over),r=Ha(t-this.lat0);return n.x=this.x0+this.a*i*this.rc,n.y=this.y0+this.a*r,n}function dee(n){var e=n.x,t=n.y;return n.x=_e(this.long0+(e-this.x0)/(this.a*this.rc),this.over),n.y=Ha(this.lat0+(t-this.y0)/this.a),n}var fee=["Equirectangular","Equidistant_Cylindrical","Equidistant_Cylindrical_Spherical","eqc"];const gee={init:cee,forward:hee,inverse:dee,names:fee};var VM=20;function mee(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Wg(this.es),this.e1=Kg(this.es),this.e2=qg(this.es),this.e3=Hg(this.es),this.ml0=this.a*hi(this.e0,this.e1,this.e2,this.e3,this.lat0)}function pee(n){var e=n.x,t=n.y,i,r,s,o=_e(e-this.long0,this.over);if(s=o*Math.sin(t),this.sphere)Math.abs(t)<=ge?(i=this.a*o,r=-1*this.a*this.lat0):(i=this.a*Math.sin(s)/Math.tan(t),r=this.a*(Ha(t-this.lat0)+(1-Math.cos(s))/Math.tan(t)));else if(Math.abs(t)<=ge)i=this.a*o,r=-1*this.ml0;else{var a=mI(this.a,this.e,Math.sin(t))/Math.tan(t);i=a*Math.sin(s),r=this.a*hi(this.e0,this.e1,this.e2,this.e3,t)-this.ml0+a*(1-Math.cos(s))}return n.x=i+this.x0,n.y=r+this.y0,n}function _ee(n){var e,t,i,r,s,o,a,u,h;if(i=n.x-this.x0,r=n.y-this.y0,this.sphere)if(Math.abs(r+this.a*this.lat0)<=ge)e=_e(i/this.a+this.long0,this.over),t=0;else{o=this.lat0+r/this.a,a=i*i/this.a/this.a+o*o,u=o;var d;for(s=VM;s;--s)if(d=Math.tan(u),h=-1*(o*(u*d+1)-u-.5*(u*u+a)*d)/((u-o)/d-1),u+=h,Math.abs(h)<=ge){t=u;break}e=_e(this.long0+Math.asin(i*Math.tan(u)/this.a)/Math.sin(t),this.over)}else if(Math.abs(r+this.ml0)<=ge)t=0,e=_e(this.long0+i/this.a,this.over);else{o=(this.ml0+r)/this.a,a=i*i/this.a/this.a+o*o,u=o;var g,m,v,y,I;for(s=VM;s;--s)if(I=this.e*Math.sin(u),g=Math.sqrt(1-I*I)*Math.tan(u),m=this.a*hi(this.e0,this.e1,this.e2,this.e3,u),v=this.e0-2*this.e1*Math.cos(2*u)+4*this.e2*Math.cos(4*u)-6*this.e3*Math.cos(6*u),y=m/this.a,h=(o*(g*y+1)-y-.5*g*(y*y+a))/(this.es*Math.sin(2*u)*(y*y+a-2*o*y)/(4*g)+(o-y)*(g*v-2/Math.sin(2*u))-v),u-=h,Math.abs(h)<=ge){t=u;break}g=Math.sqrt(1-this.es*Math.pow(Math.sin(t),2))*Math.tan(t),e=_e(this.long0+Math.asin(i*g/this.a)/Math.sin(t),this.over)}return n.x=e,n.y=t,n}var yee=["Polyconic","American_Polyconic","poly"];const vee={init:mee,forward:pee,inverse:_ee,names:yee};function Eee(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function wee(n){var e,t=n.x,i=n.y,r=i-this.lat0,s=t-this.long0,o=r/Tf*1e-5,a=s,u=1,h=0;for(e=1;e<=10;e++)u=u*o,h=h+this.A[e]*u;var d=h,g=a,m=1,v=0,y,I,w=0,R=0;for(e=1;e<=6;e++)y=m*d-v*g,I=v*d+m*g,m=y,v=I,w=w+this.B_re[e]*m-this.B_im[e]*v,R=R+this.B_im[e]*m+this.B_re[e]*v;return n.x=R*this.a+this.x0,n.y=w*this.a+this.y0,n}function xee(n){var e,t=n.x,i=n.y,r=t-this.x0,s=i-this.y0,o=s/this.a,a=r/this.a,u=1,h=0,d,g,m=0,v=0;for(e=1;e<=6;e++)d=u*o-h*a,g=h*o+u*a,u=d,h=g,m=m+this.C_re[e]*u-this.C_im[e]*h,v=v+this.C_im[e]*u+this.C_re[e]*h;for(var y=0;y<this.iterations;y++){var I=m,w=v,R,P,b=o,L=a;for(e=2;e<=6;e++)R=I*m-w*v,P=w*m+I*v,I=R,w=P,b=b+(e-1)*(this.B_re[e]*I-this.B_im[e]*w),L=L+(e-1)*(this.B_im[e]*I+this.B_re[e]*w);I=1,w=0;var D=this.B_re[1],B=this.B_im[1];for(e=2;e<=6;e++)R=I*m-w*v,P=w*m+I*v,I=R,w=P,D=D+e*(this.B_re[e]*I-this.B_im[e]*w),B=B+e*(this.B_im[e]*I+this.B_re[e]*w);var M=D*D+B*B;m=(b*D+L*B)/M,v=(L*D-b*B)/M}var A=m,k=v,F=1,G=0;for(e=1;e<=9;e++)F=F*A,G=G+this.D[e]*F;var U=this.lat0+G*Tf*1e5,N=this.long0+k;return n.x=N,n.y=U,n}var Tee=["New_Zealand_Map_Grid","nzmg"];const Iee={init:Eee,forward:wee,inverse:xee,names:Tee};function See(){}function Aee(n){var e=n.x,t=n.y,i=_e(e-this.long0,this.over),r=this.x0+this.a*i,s=this.y0+this.a*Math.log(Math.tan(Math.PI/4+t/2.5))*1.25;return n.x=r,n.y=s,n}function Ree(n){n.x-=this.x0,n.y-=this.y0;var e=_e(this.long0+n.x/this.a,this.over),t=2.5*(Math.atan(Math.exp(.8*n.y/this.a))-Math.PI/4);return n.x=e,n.y=t,n}var Pee=["Miller_Cylindrical","mill"];const Cee={init:See,forward:Aee,inverse:Ree,names:Pee};var Mee=20;function bee(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=uI(this.es)}function kee(n){var e,t,i=n.x,r=n.y;if(i=_e(i-this.long0,this.over),this.sphere){if(!this.m)r=this.n!==1?Math.asin(this.n*Math.sin(r)):r;else for(var s=this.n*Math.sin(r),o=Mee;o;--o){var a=(this.m*r+Math.sin(r)-s)/(this.m+Math.cos(r));if(r-=a,Math.abs(a)<ge)break}e=this.a*this.C_x*i*(this.m+Math.cos(r)),t=this.a*this.C_y*r}else{var u=Math.sin(r),h=Math.cos(r);t=this.a*jh(r,u,h,this.en),e=this.a*i*h/Math.sqrt(1-this.es*u*u)}return n.x=e,n.y=t,n}function Lee(n){var e,t,i,r;return n.x-=this.x0,i=n.x/this.a,n.y-=this.y0,e=n.y/this.a,this.sphere?(e/=this.C_y,i=i/(this.C_x*(this.m+Math.cos(e))),this.m?e=Ba((this.m*e+Math.sin(e))/this.n):this.n!==1&&(e=Ba(Math.sin(e)/this.n)),i=_e(i+this.long0,this.over),e=Ha(e)):(e=cI(n.y/this.a,this.es,this.en),r=Math.abs(e),r<se?(r=Math.sin(e),t=this.long0+n.x*Math.sqrt(1-this.es*r*r)/(this.a*Math.cos(e)),i=_e(t,this.over)):r-ge<se&&(i=this.long0)),n.x=i,n.y=e,n}var Dee=["Sinusoidal","sinu"];const Nee={init:bee,forward:kee,inverse:Lee,names:Dee};function Oee(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0}function Vee(n){for(var e=n.x,t=n.y,i=_e(e-this.long0,this.over),r=t,s=Math.PI*Math.sin(t);;){var o=-(r+Math.sin(r)-s)/(1+Math.cos(r));if(r+=o,Math.abs(o)<ge)break}r/=2,Math.PI/2-Math.abs(t)<ge&&(i=0);var a=.900316316158*this.a*i*Math.cos(r)+this.x0,u=1.4142135623731*this.a*Math.sin(r)+this.y0;return n.x=a,n.y=u,n}function Fee(n){var e,t;n.x-=this.x0,n.y-=this.y0,t=n.y/(1.4142135623731*this.a),Math.abs(t)>.999999999999&&(t=.999999999999),e=Math.asin(t);var i=_e(this.long0+n.x/(.900316316158*this.a*Math.cos(e)),this.over);i<-Math.PI&&(i=-Math.PI),i>Math.PI&&(i=Math.PI),t=(2*e+Math.sin(2*e))/Math.PI,Math.abs(t)>1&&(t=1);var r=Math.asin(t);return n.x=i,n.y=r,n}var Gee=["Mollweide","moll"];const jee={init:Oee,forward:Vee,inverse:Fee,names:Gee};function Uee(){Math.abs(this.lat1+this.lat2)<ge||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Wg(this.es),this.e1=Kg(this.es),this.e2=qg(this.es),this.e3=Hg(this.es),this.sin_phi=Math.sin(this.lat1),this.cos_phi=Math.cos(this.lat1),this.ms1=Ds(this.e,this.sin_phi,this.cos_phi),this.ml1=hi(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<ge?this.ns=this.sin_phi:(this.sin_phi=Math.sin(this.lat2),this.cos_phi=Math.cos(this.lat2),this.ms2=Ds(this.e,this.sin_phi,this.cos_phi),this.ml2=hi(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=hi(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))}function Bee(n){var e=n.x,t=n.y,i;if(this.sphere)i=this.a*(this.g-t);else{var r=hi(this.e0,this.e1,this.e2,this.e3,t);i=this.a*(this.g-r)}var s=this.ns*_e(e-this.long0,this.over),o=this.x0+i*Math.sin(s),a=this.y0+this.rh-i*Math.cos(s);return n.x=o,n.y=a,n}function zee(n){n.x-=this.x0,n.y=this.rh-n.y+this.y0;var e,t,i,r;this.ns>=0?(t=Math.sqrt(n.x*n.x+n.y*n.y),e=1):(t=-Math.sqrt(n.x*n.x+n.y*n.y),e=-1);var s=0;if(t!==0&&(s=Math.atan2(e*n.x,e*n.y)),this.sphere)return r=_e(this.long0+s/this.ns,this.over),i=Ha(this.g-t/this.a),n.x=r,n.y=i,n;var o=this.g-t/this.a;return i=u_(o,this.e0,this.e1,this.e2,this.e3),r=_e(this.long0+s/this.ns,this.over),n.x=r,n.y=i,n}var $ee=["Equidistant_Conic","eqdc"];const Wee={init:Uee,forward:Bee,inverse:zee,names:$ee};function Kee(){this.R=this.a}function qee(n){var e=n.x,t=n.y,i=_e(e-this.long0,this.over),r,s;Math.abs(t)<=ge&&(r=this.x0+this.R*i,s=this.y0);var o=Ba(2*Math.abs(t/Math.PI));(Math.abs(i)<=ge||Math.abs(Math.abs(t)-se)<=ge)&&(r=this.x0,t>=0?s=this.y0+Math.PI*this.R*Math.tan(.5*o):s=this.y0+Math.PI*this.R*-Math.tan(.5*o));var a=.5*Math.abs(Math.PI/i-i/Math.PI),u=a*a,h=Math.sin(o),d=Math.cos(o),g=d/(h+d-1),m=g*g,v=g*(2/h-1),y=v*v,I=Math.PI*this.R*(a*(g-y)+Math.sqrt(u*(g-y)*(g-y)-(y+u)*(m-y)))/(y+u);i<0&&(I=-I),r=this.x0+I;var w=u+g;return I=Math.PI*this.R*(v*w-a*Math.sqrt((y+u)*(u+1)-w*w))/(y+u),t>=0?s=this.y0+I:s=this.y0-I,n.x=r,n.y=s,n}function Hee(n){var e,t,i,r,s,o,a,u,h,d,g,m,v;return n.x-=this.x0,n.y-=this.y0,g=Math.PI*this.R,i=n.x/g,r=n.y/g,s=i*i+r*r,o=-Math.abs(r)*(1+s),a=o-2*r*r+i*i,u=-2*o+1+2*r*r+s*s,v=r*r/u+(2*a*a*a/u/u/u-9*o*a/u/u)/27,h=(o-a*a/3/u)/u,d=2*Math.sqrt(-h/3),g=3*v/h/d,Math.abs(g)>1&&(g>=0?g=1:g=-1),m=Math.acos(g)/3,n.y>=0?t=(-d*Math.cos(m+Math.PI/3)-a/3/u)*Math.PI:t=-(-d*Math.cos(m+Math.PI/3)-a/3/u)*Math.PI,Math.abs(i)<ge?e=this.long0:e=_e(this.long0+Math.PI*(s-1+Math.sqrt(1+2*(i*i-r*r)+s*s))/2/i,this.over),n.x=e,n.y=t,n}var Xee=["Van_der_Grinten_I","VanDerGrinten","Van_der_Grinten","vandg"];const Yee={init:Kee,forward:qee,inverse:Hee,names:Xee};function Zee(n,e,t,i,r,s){const o=i-e,a=Math.atan((1-s)*Math.tan(n)),u=Math.atan((1-s)*Math.tan(t)),h=Math.sin(a),d=Math.cos(a),g=Math.sin(u),m=Math.cos(u);let v=o,y,I=100,w,R,P,b,L,D,B,M,A,k,F,G,U,N;do{if(w=Math.sin(v),R=Math.cos(v),P=Math.sqrt(m*w*(m*w)+(d*g-h*m*R)*(d*g-h*m*R)),P===0)return{azi1:0,s12:0};b=h*g+d*m*R,L=Math.atan2(P,b),D=d*m*w/P,B=1-D*D,M=B!==0?b-2*h*g/B:0,A=s/16*B*(4+s*(4-3*B)),y=v,v=o+(1-A)*s*D*(L+A*P*(M+A*b*(-1+2*M*M)))}while(Math.abs(v-y)>1e-12&&--I>0);return I===0?{azi1:NaN,s12:NaN}:(k=B*(r*r-r*(1-s)*(r*(1-s)))/(r*(1-s)*(r*(1-s))),F=1+k/16384*(4096+k*(-768+k*(320-175*k))),G=k/1024*(256+k*(-128+k*(74-47*k))),U=G*P*(M+G/4*(b*(-1+2*M*M)-G/6*M*(-3+4*P*P)*(-3+4*M*M))),N=r*(1-s)*F*(L-U),{azi1:Math.atan2(m*w,d*g-h*m*R),s12:N})}function Qee(n,e,t,i,r,s){const o=Math.atan((1-s)*Math.tan(n)),a=Math.sin(o),u=Math.cos(o),h=Math.sin(t),d=Math.cos(t),g=Math.atan2(a,u*d),m=u*h,v=1-m*m,y=v*(r*r-r*(1-s)*(r*(1-s)))/(r*(1-s)*(r*(1-s))),I=1+y/16384*(4096+y*(-768+y*(320-175*y))),w=y/1024*(256+y*(-128+y*(74-47*y)));let R=i/(r*(1-s)*I),P,b=100,L,D,B,M;do L=Math.cos(2*g+R),D=Math.sin(R),B=Math.cos(R),M=w*D*(L+w/4*(B*(-1+2*L*L)-w/6*L*(-3+4*D*D)*(-3+4*L*L))),P=R,R=i/(r*(1-s)*I)+M;while(Math.abs(R-P)>1e-12&&--b>0);if(b===0)return{lat2:NaN,lon2:NaN};const A=a*D-u*B*d,k=Math.atan2(a*B+u*D*d,(1-s)*Math.sqrt(m*m+A*A)),F=Math.atan2(D*h,u*B-a*D*d),G=s/16*v*(4+s*(4-3*v)),U=F-(1-G)*s*m*(R+G*D*(L+G*B*(-1+2*L*L))),N=e+U;return{lat2:k,lon2:N}}function Jee(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0),this.f=this.es/(1+Math.sqrt(1-this.es))}function ete(n){var e=n.x,t=n.y,i=Math.sin(n.y),r=Math.cos(n.y),s=_e(e-this.long0,this.over),o,a,u,h,d,g,m,v,y,I,w;return this.sphere?Math.abs(this.sin_p12-1)<=ge?(n.x=this.x0+this.a*(se-t)*Math.sin(s),n.y=this.y0-this.a*(se-t)*Math.cos(s),n):Math.abs(this.sin_p12+1)<=ge?(n.x=this.x0+this.a*(se+t)*Math.sin(s),n.y=this.y0+this.a*(se+t)*Math.cos(s),n):(y=this.sin_p12*i+this.cos_p12*r*Math.cos(s),m=Math.acos(y),v=m?m/Math.sin(m):1,n.x=this.x0+this.a*v*r*Math.sin(s),n.y=this.y0+this.a*v*(this.cos_p12*i-this.sin_p12*r*Math.cos(s)),n):(o=Wg(this.es),a=Kg(this.es),u=qg(this.es),h=Hg(this.es),Math.abs(this.sin_p12-1)<=ge?(d=this.a*hi(o,a,u,h,se),g=this.a*hi(o,a,u,h,t),n.x=this.x0+(d-g)*Math.sin(s),n.y=this.y0-(d-g)*Math.cos(s),n):Math.abs(this.sin_p12+1)<=ge?(d=this.a*hi(o,a,u,h,se),g=this.a*hi(o,a,u,h,t),n.x=this.x0+(d+g)*Math.sin(s),n.y=this.y0+(d+g)*Math.cos(s),n):Math.abs(e)<ge&&Math.abs(t-this.lat0)<ge?(n.x=n.y=0,n):(I=Zee(this.lat0,this.long0,t,e,this.a,this.f),w=I.azi1,n.x=I.s12*Math.sin(w),n.y=I.s12*Math.cos(w),n))}function tte(n){n.x-=this.x0,n.y-=this.y0;var e,t,i,r,s,o,a,u,h,d,g,m,v,y,I,w;return this.sphere?(e=Math.sqrt(n.x*n.x+n.y*n.y),e>2*se*this.a?void 0:(t=e/this.a,i=Math.sin(t),r=Math.cos(t),s=this.long0,Math.abs(e)<=ge?o=this.lat0:(o=Ba(r*this.sin_p12+n.y*i*this.cos_p12/e),a=Math.abs(this.lat0)-se,Math.abs(a)<=ge?this.lat0>=0?s=_e(this.long0+Math.atan2(n.x,-n.y),this.over):s=_e(this.long0-Math.atan2(-n.x,n.y),this.over):s=_e(this.long0+Math.atan2(n.x*i,e*this.cos_p12*r-n.y*this.sin_p12*i),this.over)),n.x=s,n.y=o,n)):(u=Wg(this.es),h=Kg(this.es),d=qg(this.es),g=Hg(this.es),Math.abs(this.sin_p12-1)<=ge?(m=this.a*hi(u,h,d,g,se),e=Math.sqrt(n.x*n.x+n.y*n.y),v=m-e,o=u_(v/this.a,u,h,d,g),s=_e(this.long0+Math.atan2(n.x,-1*n.y),this.over),n.x=s,n.y=o,n):Math.abs(this.sin_p12+1)<=ge?(m=this.a*hi(u,h,d,g,se),e=Math.sqrt(n.x*n.x+n.y*n.y),v=e-m,o=u_(v/this.a,u,h,d,g),s=_e(this.long0+Math.atan2(n.x,n.y),this.over),n.x=s,n.y=o,n):(y=Math.atan2(n.x,n.y),I=Math.sqrt(n.x*n.x+n.y*n.y),w=Qee(this.lat0,this.long0,y,I,this.a,this.f),n.x=w.lon2,n.y=w.lat2,n))}var nte=["Azimuthal_Equidistant","aeqd"];const ite={init:Jee,forward:ete,inverse:tte,names:nte};function rte(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)}function ste(n){var e,t,i,r,s,o,a,u,h=n.x,d=n.y;return i=_e(h-this.long0,this.over),e=Math.sin(d),t=Math.cos(d),r=Math.cos(i),o=this.sin_p14*e+this.cos_p14*t*r,s=1,(o>0||Math.abs(o)<=ge)&&(a=this.a*s*t*Math.sin(i),u=this.y0+this.a*s*(this.cos_p14*e-this.sin_p14*t*r)),n.x=a,n.y=u,n}function ote(n){var e,t,i,r,s,o,a;return n.x-=this.x0,n.y-=this.y0,e=Math.sqrt(n.x*n.x+n.y*n.y),t=Ba(e/this.a),i=Math.sin(t),r=Math.cos(t),o=this.long0,Math.abs(e)<=ge?(a=this.lat0,n.x=o,n.y=a,n):(a=Ba(r*this.sin_p14+n.y*i*this.cos_p14/e),s=Math.abs(this.lat0)-se,Math.abs(s)<=ge?(this.lat0>=0?o=_e(this.long0+Math.atan2(n.x,-n.y),this.over):o=_e(this.long0-Math.atan2(-n.x,n.y),this.over),n.x=o,n.y=a,n):(o=_e(this.long0+Math.atan2(n.x*i,e*this.cos_p14*r-n.y*this.sin_p14*i),this.over),n.x=o,n.y=a,n))}var ate=["ortho"];const lte={init:rte,forward:ste,inverse:ote,names:ate};var Bt={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},pt={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function ute(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=se-mt/2?this.face=Bt.TOP:this.lat0<=-(se-mt/2)?this.face=Bt.BOTTOM:Math.abs(this.long0)<=mt?this.face=Bt.FRONT:Math.abs(this.long0)<=se+mt?this.face=this.long0>0?Bt.RIGHT:Bt.LEFT:this.face=Bt.BACK,this.es!==0&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)}function cte(n){var e={x:0,y:0},t,i,r,s,o,a,u={value:0};if(n.x-=this.long0,this.es!==0?t=Math.atan(this.one_minus_f_squared*Math.tan(n.y)):t=n.y,i=n.x,this.face===Bt.TOP)s=se-t,i>=mt&&i<=se+mt?(u.value=pt.AREA_0,r=i-se):i>se+mt||i<=-(se+mt)?(u.value=pt.AREA_1,r=i>0?i-nn:i+nn):i>-(se+mt)&&i<=-mt?(u.value=pt.AREA_2,r=i+se):(u.value=pt.AREA_3,r=i);else if(this.face===Bt.BOTTOM)s=se+t,i>=mt&&i<=se+mt?(u.value=pt.AREA_0,r=-i+se):i<mt&&i>=-mt?(u.value=pt.AREA_1,r=-i):i<-mt&&i>=-(se+mt)?(u.value=pt.AREA_2,r=-i-se):(u.value=pt.AREA_3,r=i>0?-i+nn:-i-nn);else{var h,d,g,m,v,y,I;this.face===Bt.RIGHT?i=nh(i,+se):this.face===Bt.BACK?i=nh(i,+nn):this.face===Bt.LEFT&&(i=nh(i,-se)),m=Math.sin(t),v=Math.cos(t),y=Math.sin(i),I=Math.cos(i),h=v*I,d=v*y,g=m,this.face===Bt.FRONT?(s=Math.acos(h),r=kp(s,g,d,u)):this.face===Bt.RIGHT?(s=Math.acos(d),r=kp(s,g,-h,u)):this.face===Bt.BACK?(s=Math.acos(-h),r=kp(s,g,-d,u)):this.face===Bt.LEFT?(s=Math.acos(-d),r=kp(s,g,h,u)):(s=r=0,u.value=pt.AREA_0)}return a=Math.atan(12/nn*(r+Math.acos(Math.sin(r)*Math.cos(mt))-se)),o=Math.sqrt((1-Math.cos(s))/(Math.cos(a)*Math.cos(a))/(1-Math.cos(Math.atan(1/Math.cos(r))))),u.value===pt.AREA_1?a+=se:u.value===pt.AREA_2?a+=nn:u.value===pt.AREA_3&&(a+=1.5*nn),e.x=o*Math.cos(a),e.y=o*Math.sin(a),e.x=e.x*this.a+this.x0,e.y=e.y*this.a+this.y0,n.x=e.x,n.y=e.y,n}function hte(n){var e={lam:0,phi:0},t,i,r,s,o,a,u,h,d,g={value:0};if(n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,i=Math.atan(Math.sqrt(n.x*n.x+n.y*n.y)),t=Math.atan2(n.y,n.x),n.x>=0&&n.x>=Math.abs(n.y)?g.value=pt.AREA_0:n.y>=0&&n.y>=Math.abs(n.x)?(g.value=pt.AREA_1,t-=se):n.x<0&&-n.x>=Math.abs(n.y)?(g.value=pt.AREA_2,t=t<0?t+nn:t-nn):(g.value=pt.AREA_3,t+=se),d=nn/12*Math.tan(t),o=Math.sin(d)/(Math.cos(d)-1/Math.sqrt(2)),a=Math.atan(o),r=Math.cos(t),s=Math.tan(i),u=1-r*r*s*s*(1-Math.cos(Math.atan(1/Math.cos(a)))),u<-1?u=-1:u>1&&(u=1),this.face===Bt.TOP)h=Math.acos(u),e.phi=se-h,g.value===pt.AREA_0?e.lam=a+se:g.value===pt.AREA_1?e.lam=a<0?a+nn:a-nn:g.value===pt.AREA_2?e.lam=a-se:e.lam=a;else if(this.face===Bt.BOTTOM)h=Math.acos(u),e.phi=h-se,g.value===pt.AREA_0?e.lam=-a+se:g.value===pt.AREA_1?e.lam=-a:g.value===pt.AREA_2?e.lam=-a-se:e.lam=a<0?-a-nn:-a+nn;else{var m,v,y;m=u,d=m*m,d>=1?y=0:y=Math.sqrt(1-d)*Math.sin(a),d+=y*y,d>=1?v=0:v=Math.sqrt(1-d),g.value===pt.AREA_1?(d=v,v=-y,y=d):g.value===pt.AREA_2?(v=-v,y=-y):g.value===pt.AREA_3&&(d=v,v=y,y=-d),this.face===Bt.RIGHT?(d=m,m=-v,v=d):this.face===Bt.BACK?(m=-m,v=-v):this.face===Bt.LEFT&&(d=m,m=v,v=-d),e.phi=Math.acos(-y)-se,e.lam=Math.atan2(v,m),this.face===Bt.RIGHT?e.lam=nh(e.lam,-se):this.face===Bt.BACK?e.lam=nh(e.lam,-nn):this.face===Bt.LEFT&&(e.lam=nh(e.lam,+se))}if(this.es!==0){var I,w,R;I=e.phi<0?1:0,w=Math.tan(e.phi),R=this.b/Math.sqrt(w*w+this.one_minus_f_squared),e.phi=Math.atan(Math.sqrt(this.a*this.a-R*R)/(this.one_minus_f*R)),I&&(e.phi=-e.phi)}return e.lam+=this.long0,n.x=e.lam,n.y=e.phi,n}function kp(n,e,t,i){var r;return n<ge?(i.value=pt.AREA_0,r=0):(r=Math.atan2(e,t),Math.abs(r)<=mt?i.value=pt.AREA_0:r>mt&&r<=se+mt?(i.value=pt.AREA_1,r-=se):r>se+mt||r<=-(se+mt)?(i.value=pt.AREA_2,r=r>=0?r-nn:r+nn):(i.value=pt.AREA_3,r+=se)),r}function nh(n,e){var t=n+e;return t<-nn?t+=ug:t>+nn&&(t-=ug),t}var dte=["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"];const fte={init:ute,forward:cte,inverse:hte,names:dte};var kw=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-986701e-12],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,18736e-12],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,934959e-12],[.7986,-.00755338,-500009e-10,935324e-12],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],of=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-126793e-14,422642e-15],[.124,.0124,507171e-14,-160604e-14],[.186,.0123999,-190189e-13,600152e-14],[.248,.0124002,710039e-13,-224e-10],[.31,.0123992,-264997e-12,835986e-13],[.372,.0124029,988983e-12,-311994e-12],[.434,.0123893,-369093e-11,-435621e-12],[.4958,.0123198,-102252e-10,-345523e-12],[.5571,.0121916,-154081e-10,-582288e-12],[.6176,.0119938,-241424e-10,-525327e-12],[.6769,.011713,-320223e-10,-516405e-12],[.7346,.0113541,-397684e-10,-609052e-12],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-140374e-14],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],OO=.8487,VO=1.3523,FO=ki/5,gte=1/FO,zc=18,c_=function(n,e){return n[0]+e*(n[1]+e*(n[2]+e*n[3]))},mte=function(n,e){return n[1]+e*(2*n[2]+e*3*n[3])};function pte(n,e,t,i){for(var r=e;i;--i){var s=n(r);if(r-=s,Math.abs(s)<t)break}return r}function _te(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"}function yte(n){var e=_e(n.x-this.long0,this.over),t=Math.abs(n.y),i=Math.floor(t*FO);i<0?i=0:i>=zc&&(i=zc-1),t=ki*(t-gte*i);var r={x:c_(kw[i],t)*e,y:c_(of[i],t)};return n.y<0&&(r.y=-r.y),r.x=r.x*this.a*OO+this.x0,r.y=r.y*this.a*VO+this.y0,r}function vte(n){var e={x:(n.x-this.x0)/(this.a*OO),y:Math.abs(n.y-this.y0)/(this.a*VO)};if(e.y>=1)e.x/=kw[zc][0],e.y=n.y<0?-se:se;else{var t=Math.floor(e.y*zc);for(t<0?t=0:t>=zc&&(t=zc-1);;)if(of[t][0]>e.y)--t;else if(of[t+1][0]<=e.y)++t;else break;var i=of[t],r=5*(e.y-i[0])/(of[t+1][0]-i[0]);r=pte(function(s){return(c_(i,s)-e.y)/mte(i,s)},r,ge,100),e.x/=c_(kw[t],r),e.y=(5*t+r)*qt,n.y<0&&(e.y=-e.y)}return e.x=_e(e.x+this.long0,this.over),e}var Ete=["Robinson","robin"];const wte={init:_te,forward:yte,inverse:vte,names:Ete};function xte(){this.name="geocent"}function Tte(n){var e=SO(n,this.es,this.a);return e}function Ite(n){var e=AO(n,this.es,this.a,this.b);return e}var Ste=["Geocentric","geocentric","geocent","Geocent"];const Ate={init:xte,forward:Tte,inverse:Ite,names:Ste};var Zn={N_POLE:0,S_POLE:1,EQUIT:2,OBLIQ:3},jd={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};function Rte(){if(Object.keys(jd).forEach((function(t){if(typeof this[t]>"u")this[t]=jd[t].def;else{if(jd[t].num&&isNaN(this[t]))throw new Error("Invalid parameter value, must be numeric "+t+" = "+this[t]);jd[t].num&&(this[t]=parseFloat(this[t]))}jd[t].degrees&&(this[t]=this[t]*qt)}).bind(this)),Math.abs(Math.abs(this.lat0)-se)<ge?this.mode=this.lat0<0?Zn.S_POLE:Zn.N_POLE:Math.abs(this.lat0)<ge?this.mode=Zn.EQUIT:(this.mode=Zn.OBLIQ,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var n=this.tilt,e=this.azi;this.cg=Math.cos(e),this.sg=Math.sin(e),this.cw=Math.cos(n),this.sw=Math.sin(n)}function Pte(n){n.x-=this.long0;var e=Math.sin(n.y),t=Math.cos(n.y),i=Math.cos(n.x),r,s;switch(this.mode){case Zn.OBLIQ:s=this.sinph0*e+this.cosph0*t*i;break;case Zn.EQUIT:s=t*i;break;case Zn.S_POLE:s=-e;break;case Zn.N_POLE:s=e;break}switch(s=this.pn1/(this.p-s),r=s*t*Math.sin(n.x),this.mode){case Zn.OBLIQ:s*=this.cosph0*e-this.sinph0*t*i;break;case Zn.EQUIT:s*=e;break;case Zn.N_POLE:s*=-(t*i);break;case Zn.S_POLE:s*=t*i;break}var o,a;return o=s*this.cg+r*this.sg,a=1/(o*this.sw*this.h1+this.cw),r=(r*this.cg-s*this.sg)*this.cw*a,s=o*a,n.x=r*this.a,n.y=s*this.a,n}function Cte(n){n.x/=this.a,n.y/=this.a;var e={x:n.x,y:n.y},t,i,r;r=1/(this.pn1-n.y*this.sw),t=this.pn1*n.x*r,i=this.pn1*n.y*this.cw*r,n.x=t*this.cg+i*this.sg,n.y=i*this.cg-t*this.sg;var s=Ci(n.x,n.y);if(Math.abs(s)<ge)e.x=0,e.y=n.y;else{var o,a;switch(a=1-s*s*this.pfact,a=(this.p-Math.sqrt(a))/(this.pn1/s+s/this.pn1),o=Math.sqrt(1-a*a),this.mode){case Zn.OBLIQ:e.y=Math.asin(o*this.sinph0+n.y*a*this.cosph0/s),n.y=(o-this.sinph0*Math.sin(e.y))*s,n.x*=a*this.cosph0;break;case Zn.EQUIT:e.y=Math.asin(n.y*a/s),n.y=o*s,n.x*=a;break;case Zn.N_POLE:e.y=Math.asin(o),n.y=-n.y;break;case Zn.S_POLE:e.y=-Math.asin(o);break}e.x=Math.atan2(n.x,n.y)}return n.x=e.x+this.long0,n.y=e.y,n}var Mte=["Tilted_Perspective","tpers"];const bte={init:Rte,forward:Pte,inverse:Cte,names:Mte};function kte(){if(this.flip_axis=this.sweep==="x"?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,this.es!==0){var n=1-this.es,e=1/n;this.radius_p=Math.sqrt(n),this.radius_p2=n,this.radius_p_inv2=e,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")}function Lte(n){var e=n.x,t=n.y,i,r,s,o;if(e=e-this.long0,this.shape==="ellipse"){t=Math.atan(this.radius_p2*Math.tan(t));var a=this.radius_p/Ci(this.radius_p*Math.cos(t),Math.sin(t));if(r=a*Math.cos(e)*Math.cos(t),s=a*Math.sin(e)*Math.cos(t),o=a*Math.sin(t),(this.radius_g-r)*r-s*s-o*o*this.radius_p_inv2<0)return n.x=Number.NaN,n.y=Number.NaN,n;i=this.radius_g-r,this.flip_axis?(n.x=this.radius_g_1*Math.atan(s/Ci(o,i)),n.y=this.radius_g_1*Math.atan(o/i)):(n.x=this.radius_g_1*Math.atan(s/i),n.y=this.radius_g_1*Math.atan(o/Ci(s,i)))}else this.shape==="sphere"&&(i=Math.cos(t),r=Math.cos(e)*i,s=Math.sin(e)*i,o=Math.sin(t),i=this.radius_g-r,this.flip_axis?(n.x=this.radius_g_1*Math.atan(s/Ci(o,i)),n.y=this.radius_g_1*Math.atan(o/i)):(n.x=this.radius_g_1*Math.atan(s/i),n.y=this.radius_g_1*Math.atan(o/Ci(s,i))));return n.x=n.x*this.a,n.y=n.y*this.a,n}function Dte(n){var e=-1,t=0,i=0,r,s,o,a;if(n.x=n.x/this.a,n.y=n.y/this.a,this.shape==="ellipse"){this.flip_axis?(i=Math.tan(n.y/this.radius_g_1),t=Math.tan(n.x/this.radius_g_1)*Ci(1,i)):(t=Math.tan(n.x/this.radius_g_1),i=Math.tan(n.y/this.radius_g_1)*Ci(1,t));var u=i/this.radius_p;if(r=t*t+u*u+e*e,s=2*this.radius_g*e,o=s*s-4*r*this.C,o<0)return n.x=Number.NaN,n.y=Number.NaN,n;a=(-s-Math.sqrt(o))/(2*r),e=this.radius_g+a*e,t*=a,i*=a,n.x=Math.atan2(t,e),n.y=Math.atan(i*Math.cos(n.x)/e),n.y=Math.atan(this.radius_p_inv2*Math.tan(n.y))}else if(this.shape==="sphere"){if(this.flip_axis?(i=Math.tan(n.y/this.radius_g_1),t=Math.tan(n.x/this.radius_g_1)*Math.sqrt(1+i*i)):(t=Math.tan(n.x/this.radius_g_1),i=Math.tan(n.y/this.radius_g_1)*Math.sqrt(1+t*t)),r=t*t+i*i+e*e,s=2*this.radius_g*e,o=s*s-4*r*this.C,o<0)return n.x=Number.NaN,n.y=Number.NaN,n;a=(-s-Math.sqrt(o))/(2*r),e=this.radius_g+a*e,t*=a,i*=a,n.x=Math.atan2(t,e),n.y=Math.atan(i*Math.cos(n.x)/e)}return n.x=n.x+this.long0,n}var Nte=["Geostationary Satellite View","Geostationary_Satellite","geos"];const Ote={init:kte,forward:Lte,inverse:Dte,names:Nte};var If=1.340264,Sf=-.081106,Af=893e-6,Rf=.003796,h_=Math.sqrt(3)/2;function Vte(){this.es=0,this.long0=this.long0!==void 0?this.long0:0,this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0}function Fte(n){var e=_e(n.x-this.long0,this.over),t=n.y,i=Math.asin(h_*Math.sin(t)),r=i*i,s=r*r*r;return n.x=e*Math.cos(i)/(h_*(If+3*Sf*r+s*(7*Af+9*Rf*r))),n.y=i*(If+Sf*r+s*(Af+Rf*r)),n.x=this.a*n.x+this.x0,n.y=this.a*n.y+this.y0,n}function Gte(n){n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a;var e=1e-9,t=12,i=n.y,r,s,o,a,u,h;for(h=0;h<t&&(r=i*i,s=r*r*r,o=i*(If+Sf*r+s*(Af+Rf*r))-n.y,a=If+3*Sf*r+s*(7*Af+9*Rf*r),i-=u=o/a,!(Math.abs(u)<e));++h);return r=i*i,s=r*r*r,n.x=h_*n.x*(If+3*Sf*r+s*(7*Af+9*Rf*r))/Math.cos(i),n.y=Math.asin(Math.sin(i)/h_),n.x=_e(n.x+this.long0,this.over),n}var jte=["eqearth","Equal Earth","Equal_Earth"];const Ute={init:Vte,forward:Fte,inverse:Gte,names:jte};var dg=1e-10;function Bte(){var n;if(this.phi1=this.lat1,Math.abs(this.phi1)<dg)throw new Error;this.es?(this.en=uI(this.es),this.m1=jh(this.phi1,this.am1=Math.sin(this.phi1),n=Math.cos(this.phi1),this.en),this.am1=n/(Math.sqrt(1-this.es*this.am1*this.am1)*this.am1),this.inverse=$te,this.forward=zte):(Math.abs(this.phi1)+dg>=se?this.cphi1=0:this.cphi1=1/Math.tan(this.phi1),this.inverse=Kte,this.forward=Wte)}function zte(n){var e=_e(n.x-(this.long0||0),this.over),t=n.y,i,r,s;return i=this.am1+this.m1-jh(t,r=Math.sin(t),s=Math.cos(t),this.en),r=s*e/(i*Math.sqrt(1-this.es*r*r)),n.x=i*Math.sin(r),n.y=this.am1-i*Math.cos(r),n.x=this.a*n.x+(this.x0||0),n.y=this.a*n.y+(this.y0||0),n}function $te(n){n.x=(n.x-(this.x0||0))/this.a,n.y=(n.y-(this.y0||0))/this.a;var e,t,i,r;if(t=Ci(n.x,n.y=this.am1-n.y),r=cI(this.am1+this.m1-t,this.es,this.en),(e=Math.abs(r))<se)e=Math.sin(r),i=t*Math.atan2(n.x,n.y)*Math.sqrt(1-this.es*e*e)/Math.cos(r);else if(Math.abs(e-se)<=dg)i=0;else throw new Error;return n.x=_e(i+(this.long0||0),this.over),n.y=Ha(r),n}function Wte(n){var e=_e(n.x-(this.long0||0),this.over),t=n.y,i,r;return r=this.cphi1+this.phi1-t,Math.abs(r)>dg?(n.x=r*Math.sin(i=e*Math.cos(t)/r),n.y=this.cphi1-r*Math.cos(i)):n.x=n.y=0,n.x=this.a*n.x+(this.x0||0),n.y=this.a*n.y+(this.y0||0),n}function Kte(n){n.x=(n.x-(this.x0||0))/this.a,n.y=(n.y-(this.y0||0))/this.a;var e,t,i=Ci(n.x,n.y=this.cphi1-n.y);if(t=this.cphi1+this.phi1-i,Math.abs(t)>se)throw new Error;return Math.abs(Math.abs(t)-se)<=dg?e=0:e=i*Math.atan2(n.x,n.y)/Math.cos(t),n.x=_e(e+(this.long0||0),this.over),n.y=Ha(t),n}var qte=["bonne","Bonne (Werner lat_1=90)"];const Hte={init:Bte,names:qte},FM={OBLIQUE:{forward:Jte,inverse:tne},TRANSVERSE:{forward:ene,inverse:nne}},d_={ROTATE:{o_alpha:"oAlpha",o_lon_c:"oLongC",o_lat_c:"oLatC"},NEW_POLE:{o_lat_p:"oLatP",o_lon_p:"oLongP"},NEW_EQUATOR:{o_lon_1:"oLong1",o_lat_1:"oLat1",o_lon_2:"oLong2",o_lat_2:"oLat2"}};function Xte(){if(this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.title=this.title||"General Oblique Transformation",this.isIdentity=wO.includes(this.o_proj),!this.o_proj)throw new Error("Missing parameter: o_proj");if(this.o_proj==="ob_tran")throw new Error("Invalid value for o_proj: "+this.o_proj);const n=this.projStr.replace("+proj=ob_tran","").replace("+o_proj=","+proj=").trim(),e=Ar(n);if(!e)throw new Error("Invalid parameter: o_proj. Unknown projection "+this.o_proj);e.long0=0,this.obliqueProjection=e;let t;const i=Object.keys(d_),r=a=>{if(typeof this[a]>"u")return;const u=parseFloat(this[a])*qt;if(isNaN(u))throw new Error("Invalid value for "+a+": "+this[a]);return u};for(let a=0;a<i.length;a++){const u=i[a],h=d_[u],d=Object.entries(h);if(d.some(([m])=>typeof this[m]<"u")){t=h;for(let m=0;m<d.length;m++){const[v,y]=d[m],I=r(v);if(typeof I>"u")throw new Error("Missing parameter: "+v+".");this[y]=I}break}}if(!t)throw new Error("No valid parameters provided for ob_tran projection.");const{lamp:s,phip:o}=Qte(this,t);this.lamp=s,Math.abs(o)>ge?(this.cphip=Math.cos(o),this.sphip=Math.sin(o),this.projectionType=FM.OBLIQUE):this.projectionType=FM.TRANSVERSE}function Yte(n){return this.projectionType.forward(this,n)}function Zte(n){return this.projectionType.inverse(this,n)}function Qte(n,e){let t,i;if(e===d_.ROTATE){let r=n.oLongC,s=n.oLatC,o=n.oAlpha;if(Math.abs(Math.abs(s)-se)<=ge)throw new Error("Invalid value for o_lat_c: "+n.o_lat_c+" should be < 90");i=r+Math.atan2(-1*Math.cos(o),-1*Math.sin(o)*Math.sin(s)),t=Math.asin(Math.cos(s)*Math.sin(o))}else if(e===d_.NEW_POLE)i=n.oLongP,t=n.oLatP;else{let r=n.oLong1,s=n.oLat1,o=n.oLong2,a=n.oLat2,u=Math.abs(s);if(Math.abs(s)>se-ge)throw new Error("Invalid value for o_lat_1: "+n.o_lat_1+" should be < 90");if(Math.abs(a)>se-ge)throw new Error("Invalid value for o_lat_2: "+n.o_lat_2+" should be < 90");if(Math.abs(s-a)<ge)throw new Error("Invalid value for o_lat_1 and o_lat_2: o_lat_1 should be different from o_lat_2");if(u<ge)throw new Error("Invalid value for o_lat_1: o_lat_1 should be different from zero");i=Math.atan2(Math.cos(s)*Math.sin(a)*Math.cos(r)-Math.sin(s)*Math.cos(a)*Math.cos(o),Math.sin(s)*Math.cos(a)*Math.sin(o)-Math.cos(s)*Math.sin(a)*Math.sin(r)),t=Math.atan(-1*Math.cos(i-r)/Math.tan(s))}return{lamp:i,phip:t}}function Jte(n,e){let{x:t,y:i}=e;t+=n.long0;const r=Math.cos(t),s=Math.sin(i),o=Math.cos(i);e.x=_e(Math.atan2(o*Math.sin(t),n.sphip*o*r+n.cphip*s)+n.lamp),e.y=Math.asin(n.sphip*s-n.cphip*o*r);const a=n.obliqueProjection.forward(e);return n.isIdentity&&(a.x*=ki,a.y*=ki),a}function ene(n,e){let{x:t,y:i}=e;t+=n.long0;const r=Math.cos(i),s=Math.cos(t);e.x=_e(Math.atan2(r*Math.sin(t),Math.sin(i))+n.lamp),e.y=Math.asin(-1*r*s);const o=n.obliqueProjection.forward(e);return n.isIdentity&&(o.x*=ki,o.y*=ki),o}function tne(n,e){n.isIdentity&&(e.x*=qt,e.y*=qt);const t=n.obliqueProjection.inverse(e);let{x:i,y:r}=t;if(i<Number.MAX_VALUE){i-=n.lamp;const s=Math.cos(i),o=Math.sin(r),a=Math.cos(r);e.x=Math.atan2(a*Math.sin(i),n.sphip*a*s-n.cphip*o),e.y=Math.asin(n.sphip*o+n.cphip*a*s)}return e.x=_e(e.x+n.long0),e}function nne(n,e){n.isIdentity&&(e.x*=qt,e.y*=qt);const t=n.obliqueProjection.inverse(e);let{x:i,y:r}=t;if(i<Number.MAX_VALUE){const s=Math.cos(r);i-=n.lamp,e.x=Math.atan2(s*Math.sin(i),-1*Math.sin(r)),e.y=Math.asin(s*Math.cos(i))}return e.x=_e(e.x+n.long0),e}var ine=["General Oblique Transformation","General_Oblique_Transformation","ob_tran"];const rne={init:Xte,forward:Yte,inverse:Zte,names:ine};function sne(n){n.Proj.projections.add(t0),n.Proj.projections.add(n0),n.Proj.projections.add(qQ),n.Proj.projections.add(nJ),n.Proj.projections.add(aJ),n.Proj.projections.add(dJ),n.Proj.projections.add(yJ),n.Proj.projections.add(TJ),n.Proj.projections.add(PJ),n.Proj.projections.add(LJ),n.Proj.projections.add(KJ),n.Proj.projections.add(QJ),n.Proj.projections.add(iee),n.Proj.projections.add(uee),n.Proj.projections.add(gee),n.Proj.projections.add(vee),n.Proj.projections.add(Iee),n.Proj.projections.add(Cee),n.Proj.projections.add(Nee),n.Proj.projections.add(jee),n.Proj.projections.add(Wee),n.Proj.projections.add(Yee),n.Proj.projections.add(ite),n.Proj.projections.add(lte),n.Proj.projections.add(fte),n.Proj.projections.add(wte),n.Proj.projections.add(Ate),n.Proj.projections.add(bte),n.Proj.projections.add(Ote),n.Proj.projections.add(Ute),n.Proj.projections.add(Hte),n.Proj.projections.add(rne)}const $c=Object.assign(cQ,{defaultDatum:"WGS84",Proj:Ar,WGS84:new Ar("WGS84"),Point:Ph,toPoint:RO,defs:Nn,nadgrid:KZ,transform:l_,mgrs:hQ,version:"__VERSION__"});sne($c);$c.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs");const one={1:"Zeer lage trefkans op archeologische resten",2:"Lage trefkans op archeologische resten",3:"Middelhoge trefkans op archeologische resten",4:"Hoge trefkans op archeologische resten",5:"Lage trefkans (water)",6:"Middelhoge trefkans (water)",7:"Hoge trefkans (water)",8:"Water",9:"Niet gekarteerd"};function ane(){const n=Hi(a=>a.map),[e,t]=ne.useState(""),[i,r]=ne.useState(!1);ne.useEffect(()=>{if(!n)return;const a=d=>{let g='<strong class="text-purple-800">AMK Monument</strong>';if(d.toponiem&&(g+=`<br/><span class="text-sm font-semibold">${d.toponiem}</span>`),d.kwaliteitswaarde&&(g+=`<br/><span class="text-sm text-purple-700">${d.kwaliteitswaarde}</span>`),d.omschrijving&&(g+=`<br/><span class="text-xs text-gray-600 mt-1 block">${d.omschrijving}</span>`),d.txt_label){const m=d.txt_label.split(", ").slice(0,3).join(", ");g+=`<br/><span class="text-xs text-gray-500 italic">${m}${d.txt_label.split(", ").length>3?"...":""}</span>`}return g},u=async(d,g)=>{const m=n.getLayers().getArray().filter(v=>v instanceof Ic&&v.getVisible()?v.getSource()instanceof uF:!1);for(const v of m){const y=v.getSource();if(!y)continue;const I=v.get("title")||"";if(I==="Archeo Landschappen"){try{const R=Lc(d),P=$c("EPSG:4326","EPSG:28992",R),b=100,D=`https://services.rce.geovoorziening.nl/landschappenkaart/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=landschappenkaart_nl&QUERY_LAYERS=landschappenkaart_nl&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${P[0]-b},${P[1]-b},${P[0]+b},${P[1]+b}`}`,M=await(await fetch(D)).json();if(M.features&&M.features.length>0){const A=M.features[0].properties;let k='<strong class="text-green-800">Archeologisch Landschap</strong>';return(A.landschapsnaam||A.naam)&&(k+=`<br/><span class="text-sm font-semibold">${A.landschapsnaam||A.naam}</span>`),A.omschrijving&&(k+=`<br/><span class="text-xs text-gray-600">${A.omschrijving}</span>`),k}}catch(R){console.warn("Archeo Landschappen WMS query failed:",R)}continue}if(I==="FAMKE Steentijd"){try{const R=Lc(d),P=$c("EPSG:4326","EPSG:28992",R),b=100,D=`https://geoportaal.fryslan.nl/arcgis/services/Themas/cultuurhistorie/MapServer/WMSServer?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=FAMKE_Advies_steentijd-bronstijd3339&QUERY_LAYERS=FAMKE_Advies_steentijd-bronstijd3339&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${P[0]-b},${P[1]-b},${P[0]+b},${P[1]+b}`}`,M=await(await fetch(D)).json();if(M.features&&M.features.length>0){const A=M.features[0].properties;let k='<strong class="text-amber-800">FAMKE Steentijd-Bronstijd</strong>';return(A.advies||A.Advies)&&(k+=`<br/><span class="text-sm text-amber-700">${A.advies||A.Advies}</span>`),k}}catch(R){console.warn("FAMKE WMS query failed:",R)}continue}if(I==="Archeo Onderzoeken"){try{const R=Lc(d),P=$c("EPSG:4326","EPSG:28992",R),b=100,D=`https://data.geo.cultureelerfgoed.nl/openbaar/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=archeologische_onderzoeksmeldingen_openbaar_rd&QUERY_LAYERS=archeologische_onderzoeksmeldingen_openbaar_rd&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${P[0]-b},${P[1]-b},${P[0]+b},${P[1]+b}`}`,M=await(await fetch(D)).json();if(M.features&&M.features.length>0){const A=M.features[0].properties;let k='<strong class="text-blue-800">Archeologisch Onderzoek</strong>';if(A.type_onderzoek&&(k+=`<br/><span class="text-sm font-semibold">${A.type_onderzoek}</span>`),A.onderzoeksmeldingnummer&&(k+=`<br/><span class="text-xs text-gray-500">Melding: ${A.onderzoeksmeldingnummer}</span>`),A.uitvoerder&&(k+=`<br/><span class="text-sm text-gray-700">Uitvoerder: ${A.uitvoerder}</span>`),A.startdatum||A.einddatum){const F=[A.startdatum,A.einddatum].filter(Boolean).join(" - ");k+=`<br/><span class="text-xs text-gray-600">Periode: ${F}</span>`}if(A.gemeente&&(k+=`<br/><span class="text-xs text-gray-500">${A.gemeente}</span>`),A.type_uri){const F=A.type_uri.replace("type_uri:","").trim();F.startsWith("http")&&(k+=`<br/><a href="${F}" target="_blank" rel="noopener noreferrer" class="text-xs text-blue-600 hover:underline">Meer informatie </a>`)}for(const[F,G]of Object.entries(A))if(F.toLowerCase().includes("uri")&&typeof G=="string"&&F!=="type_uri"){const U=G.replace(/^[a-z_]+:/i,"").trim();U.startsWith("http")&&(k+=`<br/><a href="${U}" target="_blank" rel="noopener noreferrer" class="text-xs text-blue-600 hover:underline">${F.replace("_uri","")} </a>`)}return k}}catch(R){console.warn("Archeo Onderzoeken WMS query failed:",R)}continue}if(I==="IKAW"){try{const R=Lc(d),P=$c("EPSG:4326","EPSG:28992",R),b=500,D=`https://services.rce.geovoorziening.nl/ikaw/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=IKAW3Indicatievekaartarcheologischewaarden2008&QUERY_LAYERS=IKAW3Indicatievekaartarcheologischewaarden2008&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${P[0]-b},${P[1]-b},${P[0]+b},${P[1]+b}`}`,M=await(await fetch(D)).json();if(M.features&&M.features.length>0){const A=M.features[0].properties,k=Math.round(A.PALETTE_INDEX||A.palette_index||0),F=one[k]||`Trefkans onbekend (${k})`;let G='<strong class="text-orange-800">IKAW (2008)</strong>';return G+=`<br/><span class="text-sm text-orange-700">${F}</span>`,G}}catch(R){console.warn("IKAW WMS query failed:",R)}continue}const w=y.getFeatureInfoUrl(d,g,"EPSG:3857",{INFO_FORMAT:"application/json"});if(w)try{const P=await(await fetch(w)).json();if(P.features&&P.features.length>0){const b=P.features[0].properties;let L=`<strong>${I}</strong>`;if((b.first_soilname||b.soilname)&&(L+=`<br/><span class="text-sm text-amber-700">${b.first_soilname||b.soilname}</span>`),(b.soilcode||b.first_soilcode)&&(L+=`<br/><span class="text-xs text-gray-500">Code: ${b.soilcode||b.first_soilcode}</span>`),b.soilslope&&b.soilslope!=="Niet opgenomen"&&(L+=`<br/><span class="text-xs text-gray-500">Helling: ${b.soilslope}</span>`),b.geomorphological_area_name&&(L+=`<br/><span class="text-sm text-green-700">${b.geomorphological_area_name}</span>`),b.relief&&(L+=`<br/><span class="text-xs text-gray-500">Relief: ${b.relief}</span>`),!b.first_soilname&&!b.soilname&&!b.geomorphological_area_name){const D=["geometry","id","fid","gml_id"];for(const[B,M]of Object.entries(b))!D.includes(B)&&M&&M!=="Niet opgenomen"&&(L+=`<br/><span class="text-xs text-gray-600">${B}: ${M}</span>`)}return L}}catch(R){console.warn("WMS GetFeatureInfo failed:",R)}}return null},h=async d=>{const g=n.forEachFeatureAtPixel(d.pixel,m=>m);if(g){const m=g.getProperties(),{geometry:v,...y}=m;if(y.kwaliteitswaarde&&y.kwaliteitswaarde.includes("archeologische waarde")){const P=a(y);t(P),r(!0);return}const I=y.name||y.naam||y.title||y.NAAM||y.NAME||y.label||y.route_name||y.road_name||"Info";let w=`<strong>${I}</strong>`;if(y.category&&(w+=`<br/><span class="text-sm text-gray-600">Categorie: ${y.category}</span>`),y.from_to&&y.from_to!==I&&(w+=`<br/><span class="text-sm text-gray-600">${y.from_to}</span>`),y.route&&y.route!==I&&(w+=`<br/><span class="text-sm text-gray-600">${y.route}</span>`),y.TOPONIEM&&(w+=`<br/><span class="text-sm font-semibold text-gray-800">${y.TOPONIEM}</span>`,y.PLAATS&&(w+=`<br/><span class="text-xs text-gray-500">${y.PLAATS}</span>`)),(y.AARD_VINDP||y.Aard_vindp)&&(w+=`<br/><span class="text-sm text-gray-700">Aard: ${y.AARD_VINDP||y.Aard_vindp}</span>`),y.BEGIN_PER&&y.EIND_PER&&(w+=`<br/><span class="text-sm text-purple-700">Periode: ${y.BEGIN_PER} - ${y.EIND_PER}</span>`),(y.AARD_OPM||y.Aard_opmer)&&(w+=`<br/><span class="text-xs text-gray-600 italic">${y.AARD_OPM||y.Aard_opmer}</span>`),y.Gemeente&&(w+=`<br/><span class="text-sm text-gray-600">Gemeente: ${y.Gemeente}</span>`),y.Bron&&(w+=`<br/><span class="text-xs text-gray-500">Bron: ${y.Bron}</span>`),y.Bron_besch&&(w+=`<br/><span class="text-xs text-gray-500">${y.Bron_besch}</span>`),y.Dat_st_z&&y.Dat_ei_z&&(w+=`<br/><span class="text-sm text-purple-700">Datering: ${y.Dat_st_z} - ${y.Dat_ei_z}</span>`),y.Begin&&y.Einde&&(w+=`<br/><span class="text-sm text-purple-700">Periode: ${y.Begin} - ${y.Einde}</span>`),y.Uiterwaard&&(w+=`<br/><span class="text-sm font-semibold">${y.Uiterwaard}</span>`),y.rivier&&(w+=`<br/><span class="text-sm text-blue-600">Rivier: ${y.rivier}</span>`),y.Beschrijvi&&(w+=`<br/><span class="text-sm text-gray-700">${y.Beschrijvi}</span>`),y.leisure){const P=y.leisure==="playground"?"Speeltuin":"Park";w+=`<br/><span class="text-xs text-gray-500">${P}</span>`}if((y.tourism==="museum"||y.museum)&&(w+='<br/><span class="text-xs text-purple-600">Museum</span>'),(y.leisure==="swimming_area"||y.sport==="swimming")&&(w+='<br/><span class="text-xs text-cyan-600">Zwemplek</span>'),y.osm_id&&y.address!==void 0&&(w+='<br/><span class="text-xs text-lime-600">Kringloopwinkel</span>',y.address&&(w+=`<br/><span class="text-xs text-gray-500">${y.address}</span>`),y.phone&&(w+=`<br/><span class="text-xs text-gray-600">${y.phone}</span>`)),(y.historic==="castle"||y.castle_type)&&(w+='<br/><span class="text-xs text-purple-600">Kasteel</span>',y.castle_type&&(w+=`<br/><span class="text-xs text-gray-500">Type: ${y.castle_type}</span>`),y.start_date&&(w+=`<br/><span class="text-xs text-gray-500">Bouwjaar: ${y.start_date}</span>`),y.heritage&&(w+='<br/><span class="text-xs text-amber-600">Rijksmonument</span>')),y.bron==="Paleobiology Database"&&(y.taxonomie&&y.taxonomie!=="Onbekend"&&(w+=`<br/><span class="text-xs text-amber-700">${y.taxonomie}</span>`),y.periode&&y.periode!=="Onbekend"&&(w+=`<br/><span class="text-sm text-purple-700">${y.periode}</span>`),y.ouderdom&&y.ouderdom!=="Onbekend"&&(w+=`<br/><span class="text-xs text-gray-600">Ouderdom: ${y.ouderdom}</span>`),y.aantal_fossielen&&(w+=`<br/><span class="text-xs text-green-700">Aantal fossielen: ${y.aantal_fossielen}</span>`),y.formatie&&(w+=`<br/><span class="text-xs text-gray-500">Formatie: ${y.formatie}</span>`),y.lid&&(w+=`<br/><span class="text-xs text-gray-500">Lid: ${y.lid}</span>`),y.gesteente&&(w+=`<br/><span class="text-xs text-gray-500">Gesteente: ${y.gesteente}</span>`),y.milieu&&(w+=`<br/><span class="text-xs text-blue-600">Milieu: ${y.milieu}</span>`),y.vindplaats&&(w+=`<br/><span class="text-xs text-gray-500 italic">${y.vindplaats}</span>`)),(y.inventarisnummer||y.locatie_naam)&&(y.locatie_naam&&(w+=`<br/><span class="text-sm font-semibold">${y.locatie_naam}</span>`),y.inventarisnummer&&(w+=`<br/><span class="text-xs text-gray-500">CAI: ${y.inventarisnummer}</span>`),y.datering_tekst&&(w+=`<br/><span class="text-sm text-purple-700">${y.datering_tekst}</span>`)),(y.veensoort||y.dikte)&&(y.veensoort&&(w+=`<br/><span class="text-sm text-amber-700">${y.veensoort}</span>`),y.dikte&&(w+=`<br/><span class="text-xs text-gray-600">Dikte: ${y.dikte}</span>`)),y.nature&&y.debut){w+=`<br/><span class="text-sm text-purple-700">${y.nature}</span>`;const P=y.debut===y.fin?y.debut:`${y.debut} - ${y.fin}`;P&&(w+=`<br/><span class="text-sm text-gray-700">Periode: ${P}</span>`),y.structure&&(w+=`<br/><span class="text-xs text-gray-600">${y.structure}</span>`),y.commune&&(w+=`<br/><span class="text-xs text-gray-500">${y.commune}</span>`),y.decouvert&&(w+=`<br/><span class="text-xs text-gray-400">Ontdekt: ${y.decouvert}</span>`),y.numero&&(w+=`<br/><span class="text-xs text-gray-400">${y.numero}</span>`)}if((y.NATURE_OPE||y.CODE_OPERA)&&(y.TITRE&&(w+=`<br/><span class="text-sm font-semibold">${y.TITRE}</span>`),y.NATURE_OPE&&(w+=`<br/><span class="text-sm text-amber-700">${y.NATURE_OPE}</span>`),y.AUTEUR&&(w+=`<br/><span class="text-xs text-gray-600">Auteur: ${y.AUTEUR}</span>`),y.DATE&&(w+=`<br/><span class="text-xs text-gray-500">Datum: ${y.DATE}</span>`),y.COMMUNE&&(w+=`<br/><span class="text-xs text-gray-500">${y.COMMUNE}</span>`)),y.type_protection&&(y.n_site||y.t_site)){const P=y.type_protection==="Classe"?"text-red-700":"text-amber-700";w+=`<br/><span class="text-sm ${P}">${y.type_protection}</span>`,y.n_site&&(w+=`<br/><span class="text-sm font-semibold">${y.n_site}</span>`),y.t_site&&(w+=`<br/><span class="text-xs text-gray-600">${y.t_site}</span>`),y.c_site&&(w+=`<br/><span class="text-xs text-gray-500">Code: ${y.c_site}</span>`),y.d_creation&&(w+=`<br/><span class="text-xs text-gray-400">Beschermd sinds: ${y.d_creation}</span>`)}if(y.type_protection&&y.cod_diren){const P=y.type_protection==="Classe"?"text-red-700":"text-amber-700";if(w+=`<br/><span class="text-sm ${P}">${y.type_protection}</span>`,y.proced&&(w+=`<br/><span class="text-xs text-gray-600">${y.proced}</span>`),y.d_proced&&(w+=`<br/><span class="text-xs text-gray-500">Date: ${y.d_proced}</span>`),y.comment){const b=String(y.comment).slice(0,150);w+=`<br/><span class="text-xs text-gray-600 italic">${b}${String(y.comment).length>150?"...":""}</span>`}}if(y.type_protection&&y.nomsite){const P=y.type_protection==="Classe"?"text-red-700":"text-amber-700";if(w+=`<br/><span class="text-sm ${P}">${y.type_protection}</span>`,y.caractere&&(w+=`<br/><span class="text-xs text-gray-600">${y.caractere}</span>`),y.datedecis&&(w+=`<br/><span class="text-xs text-gray-500">Date: ${y.datedecis}</span>`),y.descriptio){const b=String(y.descriptio).slice(0,150);w+=`<br/><span class="text-xs text-gray-600 italic">${b}${String(y.descriptio).length>150?"...":""}</span>`}}if(y.secteur&&y.style){if(w+=`<br/><span class="text-sm text-gray-700">${y.secteur}</span>`,y["sous-secteur"]&&(w+=`<br/><span class="text-xs text-gray-600">${y["sous-secteur"]}</span>`),y.description){const P=String(y.description).slice(0,150);w+=`<br/><span class="text-xs text-gray-600 italic">${P}${String(y.description).length>150?"...":""}</span>`}y.url&&(w+=`<br/><a href="${y.url}" target="_blank" class="text-xs text-blue-600 hover:underline">Meer info</a>`)}if(y.nature_operation||y.synthese){y.nature_operation&&(w+=`<br/><span class="text-sm text-red-700">${y.nature_operation}</span>`),y.responsable_operation&&(w+=`<br/><span class="text-xs text-gray-600">Responsable: ${y.responsable_operation}</span>`),y.date_operation&&(w+=`<br/><span class="text-xs text-gray-500">Datum: ${y.date_operation}</span>`);const P=[];if(y.prehistoire==="Oui"&&P.push("Prehistorie"),y.protohistoire==="Oui"&&P.push("Protohistorie"),y.antiquite==="Oui"&&P.push("Romeins"),y.moyen_age==="Oui"&&P.push("Middeleeuwen"),y.temps_modernes==="Oui"&&P.push("Moderne tijd"),P.length>0&&(w+=`<br/><span class="text-sm text-purple-700">${P.join(", ")}</span>`),y.adresse&&(w+=`<br/><span class="text-xs text-gray-500">${y.adresse}</span>`),y.synthese){const b=String(y.synthese).slice(0,200);w+=`<br/><span class="text-xs text-gray-600 italic">${b}${String(y.synthese).length>200?"...":""}</span>`}}if(y.operator&&(w+=`<br/><span class="text-sm text-gray-600">${y.operator}</span>`),y.opening_hours&&(w+=`<br/><span class="text-xs text-green-600">Open: ${y.opening_hours}</span>`),y.website&&(w+=`<br/><a href="${y.website}" target="_blank" class="text-xs text-blue-600 underline">Website</a>`),y.addr_street){const P=[y.addr_street,y.addr_housenumber,y.addr_postcode].filter(Boolean).join(" ");w+=`<br/><span class="text-xs text-gray-500">${P}</span>`}const R=y.description||y.omschrijving||y.descr||y.info;R&&R!==I&&(w+=`<br/><span class="text-sm text-gray-600">${R}</span>`),t(w),r(!0)}else{const m=n.getView().getResolution()||1,v=await u(d.coordinate,m);v&&(t(v),r(!0))}};return n.on("click",h),()=>{n.un("click",h)}},[n]);const s=()=>{r(!1)},o=(a,u)=>{u.offset.y>100&&r(!1)};return V.jsx(Ka,{children:i&&V.jsxs(V.Fragment,{children:[V.jsx(fi.div,{className:"fixed inset-0 z-[1500]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:s}),V.jsxs(fi.div,{className:"fixed bottom-0 left-0 right-0 z-[1501] bg-white rounded-t-2xl shadow-2xl",initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",damping:25,stiffness:300},drag:"y",dragConstraints:{top:0},dragElastic:.2,onDragEnd:o,children:[V.jsx("div",{className:"flex justify-center pt-3 pb-2",children:V.jsx("div",{className:"w-10 h-1 bg-gray-300 rounded-full"})}),V.jsx("button",{onClick:s,className:"absolute top-3 right-3 w-8 h-8 flex items-center justify-center text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-full transition-colors","aria-label":"Sluiten",children:V.jsx(Gh,{size:20})}),V.jsx("div",{className:"px-4 pb-6 max-h-[50vh] overflow-y-auto",dangerouslySetInnerHTML:{__html:e}})]})]})})}function lne(){const n=Hi(w=>w.map),e=Ot(w=>w.position),t=tn(w=>w.startNavigation),i=tn(w=>w.isNavigating),[r,s]=ne.useState(null),[o,a]=ne.useState(!1),[u,h]=ne.useState(!1),d=ne.useRef(null),g=ne.useRef(null);ne.useEffect(()=>{if(!n){console.log(" LongPressMenu: map not ready");return}const w=n.getViewport();if(!w){console.log(" LongPressMenu: viewport not ready");return}console.log(" LongPressMenu: attached to viewport",w);const R=600,P=15,b=F=>{if(console.log(" Touch start, touches:",F.touches.length),F.touches.length!==1)return;const G=F.touches[0];g.current={x:G.clientX,y:G.clientY},console.log(" Starting long press timer at:",g.current),d.current&&clearTimeout(d.current),d.current=window.setTimeout(()=>{if(console.log(" Timer fired! startPos:",g.current),!g.current)return;const U=window.__olMap;if(!U){console.log(" Map not available (global)");return}const N=w.getBoundingClientRect(),ue=[g.current.x-N.left,g.current.y-N.top],we=U.getCoordinateFromPixel(ue);if(we){const ye=Lc(we);F.preventDefault(),s({pixel:[g.current.x,g.current.y],coordinate:ye}),a(!0),h(!1),setTimeout(()=>h(!0),300),"vibrate"in navigator&&navigator.vibrate(50),console.log(" Long press detected at:",ye)}},R)},L=F=>{if(!d.current||!g.current)return;const G=F.touches[0],U=G.clientX-g.current.x,N=G.clientY-g.current.y,ue=Math.sqrt(U*U+N*N);ue>P&&(console.log(" Touch moved too much, cancelling. Distance:",ue),clearTimeout(d.current),d.current=null)},D=()=>{console.log(" Touch end, timer active:",!!d.current),d.current&&(console.log(" Cancelling timer on touch end"),clearTimeout(d.current),d.current=null),g.current=null},B=F=>{o&&F.preventDefault()},M=F=>{F.button===0&&(console.log(" Mouse down"),g.current={x:F.clientX,y:F.clientY},d.current&&clearTimeout(d.current),d.current=window.setTimeout(()=>{if(console.log(" Mouse timer fired!"),!g.current)return;const G=window.__olMap;if(console.log(" __olMap:",G),console.log(" __olMap constructor:",G?.constructor?.name),console.log(" has getCoordinateAtPixel:",typeof G?.getCoordinateAtPixel),!G){console.log(" Map not available (global)");return}const U=w.getBoundingClientRect(),N=[g.current.x-U.left,g.current.y-U.top];console.log(" Pixel:",N);const ue=G.getCoordinateFromPixel(N);if(console.log(" Coordinate:",ue),ue){const we=Lc(ue);s({pixel:[g.current.x,g.current.y],coordinate:we}),a(!0),h(!1),setTimeout(()=>h(!0),300),console.log(" Long press (mouse) detected at:",we)}},R))},A=F=>{if(!d.current||!g.current)return;const G=F.clientX-g.current.x,U=F.clientY-g.current.y;Math.sqrt(G*G+U*U)>P&&(console.log(" Mouse moved, cancelling"),clearTimeout(d.current),d.current=null)},k=()=>{console.log(" Mouse up"),d.current&&(clearTimeout(d.current),d.current=null),g.current=null};return w.addEventListener("touchstart",b,{passive:!1}),w.addEventListener("touchmove",L,{passive:!0}),w.addEventListener("touchend",D),w.addEventListener("touchcancel",D),w.addEventListener("contextmenu",B),w.addEventListener("mousedown",M),w.addEventListener("mousemove",A),w.addEventListener("mouseup",k),w.addEventListener("mouseleave",k),()=>{w.removeEventListener("touchstart",b),w.removeEventListener("touchmove",L),w.removeEventListener("touchend",D),w.removeEventListener("touchcancel",D),w.removeEventListener("contextmenu",B),w.removeEventListener("mousedown",M),w.removeEventListener("mousemove",A),w.removeEventListener("mouseup",k),w.removeEventListener("mouseleave",k),d.current&&clearTimeout(d.current)}},[n,o]);const m=()=>{u&&(a(!1),s(null),h(!1))},v=async()=>{if(!r||!e)return;const[w,R]=r.coordinate,P=`${R.toFixed(4)}, ${w.toFixed(4)}`;await t({lng:w,lat:R},P,{lng:e.lng,lat:e.lat}),a(!1),s(null),h(!1)},y=()=>{a(!1),s(null),h(!1)},I=w=>{const[R,P]=w;return`${P.toFixed(5)}N, ${R.toFixed(5)}E`};return V.jsx(Ka,{children:o&&r&&V.jsxs(V.Fragment,{children:[V.jsx(fi.div,{className:"fixed inset-0 z-[1600]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:m}),V.jsxs(fi.div,{className:"fixed z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden min-w-[200px]",style:{left:Math.min(r.pixel[0],window.innerWidth-220),top:Math.min(r.pixel[1],window.innerHeight-180)},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.15},children:[V.jsx("div",{className:"px-4 py-3 bg-gray-50 border-b border-gray-100",children:V.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[V.jsx(dO,{size:16}),V.jsx("span",{className:"text-xs font-mono",children:I(r.coordinate)})]})}),V.jsxs("div",{className:"py-1",children:[V.jsxs("button",{onClick:v,disabled:!e||i,className:`w-full px-4 py-3 flex items-center gap-3 transition-colors ${e&&!i?"hover:bg-blue-50 text-gray-700":"text-gray-400 cursor-not-allowed"}`,children:[V.jsx(sI,{size:20,className:e&&!i?"text-blue-500":"text-gray-300"}),V.jsx("span",{className:"font-medium",children:"Navigeer hierheen"})]}),!e&&V.jsx("div",{className:"px-4 py-2 text-xs text-amber-600 bg-amber-50",children:"GPS positie niet beschikbaar"}),i&&V.jsx("div",{className:"px-4 py-2 text-xs text-blue-600 bg-blue-50",children:"Navigatie al actief"})]}),V.jsx("div",{className:"border-t border-gray-100",children:V.jsxs("button",{onClick:y,className:"w-full px-4 py-3 flex items-center justify-center gap-2 text-gray-500 hover:bg-gray-50 transition-colors",children:[V.jsx(Gh,{size:18}),V.jsx("span",{children:"Annuleren"})]})})]})]})})}function une(){return V.jsx("div",{className:"fixed bottom-2.5 left-2.5 z-[800] px-2 py-1 bg-white/90 rounded shadow-sm text-xs font-mono text-gray-600",children:"bvd v2.2.0"})}const cne=["AMK Monumenten","Romeinse wegen","IKAW"],hne=["Parken","Speeltuinen","Strandjes"],dne=["UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling"],fne=["AHN 0.5m","Geomorfologie","AHN4 Multi-Hillshade NL"],gne=["IKAW","Geomorfologie","Bodemkaart","AHN4 Multi-Hillshade NL","AMK Monumenten"],mne=["WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Militaire Objecten"],GM=["Hunebedden","FAMKE Steentijd","Grafheuvels","Terpen","AMK Monumenten","Romeinse wegen","Kastelen","IKAW","Archeo Landschappen","Rijksmonumenten","Werelderfgoed","WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Inundatiegebieden","Militaire Objecten","Paleokaart 800 n.Chr.","Paleokaart 100 n.Chr.","Paleokaart 500 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 9000 v.Chr.","Religieus Erfgoed","UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling","Veengebieden","AHN 0.5m","Geomorfologie","Bodemkaart","AHN4 Hillshade NL","AHN4 Multi-Hillshade NL","AHN4 Helling NL","World Hillshade","Fossielen Nederland","Fossielen Belgi","Fossielen Duitsland","Fossielen Frankrijk","Parken","Speeltuinen","Musea","Strandjes"],pne=["CartoDB (licht)","OpenStreetMap","Luchtfoto (PDOK)","TMK 1850","Bonnebladen 1900"];function _ne(){const[n,e]=ne.useState(!1),t=oo(o=>o.setLayerVisibility),i=Ot(o=>o.stopTracking),r=()=>{GM.forEach(o=>t(o,!1)),pne.forEach(o=>{t(o,o==="CartoDB (licht)")}),i(),console.log(" Reset: CartoDB (licht), alle lagen uit, GPS uit")},s=o=>{GM.forEach(a=>t(a,!1)),o.forEach(a=>t(a,!0)),e(!1)};return V.jsxs("div",{className:"fixed bottom-[30px] md:bottom-10 left-2 z-[800]",children:[V.jsxs("div",{className:"flex flex-col gap-2",children:[V.jsx("button",{onClick:()=>e(!n),className:"w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",title:"Presets",children:n?V.jsx(cO,{size:22,className:"text-blue-600"}):V.jsx(hO,{size:22,className:"text-blue-600"})}),V.jsx("button",{onClick:r,className:"w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",title:"Reset - CartoDB, alle lagen uit, GPS uit",children:V.jsx(Sw,{size:22,className:"text-gray-600"})})]}),V.jsx(Ka,{children:n&&V.jsxs(fi.div,{initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.95},transition:{duration:.15},className:"absolute bottom-0 left-14 bg-white/95 rounded-xl shadow-lg p-2 min-w-[140px] backdrop-blur-sm",children:[V.jsxs("button",{onClick:()=>s(cne),className:"w-full flex items-center gap-2 px-2 py-1.5 hover:bg-purple-50 rounded text-left transition-colors border-0 outline-none bg-transparent",children:[V.jsx(pY,{size:14,className:"text-purple-600"}),V.jsx("span",{className:"text-xs text-gray-700",children:"Detectie"})]}),V.jsxs("button",{onClick:()=>s(dne),className:"w-full flex items-center gap-2 px-2 py-1.5 hover:bg-cyan-50 rounded text-left transition-colors border-0 outline-none bg-transparent",children:[V.jsx(XY,{size:14,className:"text-cyan-600"}),V.jsx("span",{className:"text-xs text-gray-700",children:"Uiterwaarden"})]}),V.jsxs("button",{onClick:()=>s(hne),className:"w-full flex items-center gap-2 px-2 py-1.5 hover:bg-green-50 rounded text-left transition-colors border-0 outline-none bg-transparent",children:[V.jsx(zY,{size:14,className:"text-green-600"}),V.jsx("span",{className:"text-xs text-gray-700",children:"Recreatie"})]}),V.jsxs("button",{onClick:()=>s(fne),className:"w-full flex items-center gap-2 px-2 py-1.5 hover:bg-stone-50 rounded text-left transition-colors border-0 outline-none bg-transparent",children:[V.jsx(DY,{size:14,className:"text-stone-600"}),V.jsx("span",{className:"text-xs text-gray-700",children:"Hillshade"})]}),V.jsxs("button",{onClick:()=>s(gne),className:"w-full flex items-center gap-2 px-2 py-1.5 hover:bg-amber-50 rounded text-left transition-colors border-0 outline-none bg-transparent",children:[V.jsx(fO,{size:14,className:"text-amber-600"}),V.jsx("span",{className:"text-xs text-gray-700",children:"Analyse"})]}),V.jsxs("button",{onClick:()=>s(mne),className:"w-full flex items-center gap-2 px-2 py-1.5 hover:bg-red-50 rounded text-left transition-colors border-0 outline-none bg-transparent",children:[V.jsx(UY,{size:14,className:"text-red-600"}),V.jsx("span",{className:"text-xs text-gray-700",children:"WOII"})]})]})})]})}function yne(){const[n,e]=ne.useState(!1);return V.jsxs(V.Fragment,{children:[V.jsx("button",{onClick:()=>e(!0),className:"fixed top-2.5 right-2.5 z-[800] w-8 h-8 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-lg shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",title:"Info & Attributies",children:V.jsx(AY,{size:16,className:"text-blue-600"})}),V.jsx(Ka,{children:n&&V.jsxs(V.Fragment,{children:[V.jsx(fi.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>e(!1)}),V.jsxs(fi.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[V.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white",children:[V.jsx("span",{className:"font-medium",children:"Info & Attributies"}),V.jsx("button",{onClick:()=>e(!1),className:"p-1 rounded hover:bg-white/20 transition-colors",children:V.jsx(Gh,{size:18})})]}),V.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 text-sm",children:[V.jsxs("section",{children:[V.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Over deze app"}),V.jsx("p",{className:"text-gray-600",children:"Detectorapp NL is een kaartapplicatie voor metal detecting en archeologische verkenning in Nederland."})]}),V.jsxs("section",{children:[V.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Databronnen & Licenties"}),V.jsxs("ul",{className:"space-y-2 text-gray-600",children:[V.jsxs("li",{children:[V.jsx("strong",{children:"RCE / Cultureelerfgoed.nl"})," (CC0/CC-BY)",V.jsx("br",{}),V.jsx("span",{className:"text-xs",children:"AMK, Rijksmonumenten, Werelderfgoed, Paleokaarten, Religieus Erfgoed"})]}),V.jsxs("li",{children:[V.jsx("strong",{children:"PDOK / Kadaster"})," (CC0/CC-BY)",V.jsx("br",{}),V.jsx("span",{className:"text-xs",children:"Luchtfoto, AHN, IKAW, Bodemkaart, Geomorfologie"})]}),V.jsxs("li",{children:[V.jsx("strong",{children:"OpenStreetMap"})," (ODbL)",V.jsx("br",{}),V.jsx("span",{className:"text-xs",children:"Hunebedden, Grafheuvels, Bunkers, Kastelen, Parken, etc."})]}),V.jsxs("li",{children:[V.jsx("strong",{children:"Itiner-E"})," (CC BY 4.0)",V.jsx("br",{}),V.jsx("span",{className:"text-xs",children:"Romeinse wegen - Brughmans, Paout, de Soto & Bjerregaard Vahlstrup"})]}),V.jsxs("li",{children:[V.jsx("strong",{children:"CARTO"})," (CC BY 3.0)",V.jsx("br",{}),V.jsx("span",{className:"text-xs",children:"CartoDB basiskaart"})]}),V.jsxs("li",{children:[V.jsx("strong",{children:"Map5.nl / Kadaster"}),V.jsx("br",{}),V.jsx("span",{className:"text-xs",children:"Historische kaarten (TMK 1850, Bonnebladen 1900)"})]}),V.jsxs("li",{children:[V.jsx("strong",{children:"Friesland Geoportal"}),V.jsx("br",{}),V.jsx("span",{className:"text-xs",children:"FAMKE Steentijd, Terpen"})]}),V.jsxs("li",{children:[V.jsx("strong",{children:"UIKAV / Rijkswaterstaat"}),V.jsx("br",{}),V.jsx("span",{className:"text-xs",children:"Uiterwaarden archeologische data"})]})]})]}),V.jsxs("section",{children:[V.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Privacy"}),V.jsxs("div",{className:"text-gray-600 space-y-2",children:[V.jsxs("p",{children:[V.jsx("strong",{children:"Locatiegegevens:"})," Deze app gebruikt uw GPS-locatie alleen voor navigatie op de kaart. Locatiegegevens worden niet opgeslagen of gedeeld met derden."]}),V.jsxs("p",{children:[V.jsx("strong",{children:"Geen tracking:"})," We verzamelen geen persoonlijke gegevens, analytics of gebruiksstatistieken."]}),V.jsxs("p",{children:[V.jsx("strong",{children:"Lokale opslag:"})," Alle kaartdata wordt lokaal in de app opgeslagen. Er worden geen gegevens naar externe servers gestuurd."]})]})]}),V.jsxs("section",{children:[V.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Contact"}),V.jsx("p",{className:"text-gray-600",children:"Vragen of feedback? Neem contact op via de ontwikkelaar."})]}),V.jsx("section",{className:"pt-2 border-t border-gray-200",children:V.jsx("p",{className:"text-xs text-gray-400 text-center",children:"Detectorapp NL v2.2.0"})})]})]})]})})]})}const vne=[{name:"AHN4 Hillshade NL",color:"blue",default:.7},{name:"AHN4 Multi-Hillshade NL",color:"blue",default:.7},{name:"AHN4 Helling NL",color:"blue",default:.6},{name:"AHN 0.5m",color:"blue",default:.7},{name:"World Hillshade",color:"blue",default:.7},{name:"Geomorfologie",color:"green",default:.5},{name:"Bodemkaart",color:"amber",default:.6},{name:"IKAW",color:"orange",default:.5},{name:"Archeo Landschappen",color:"green",default:.5},{name:"AMK Monumenten",color:"purple",default:.8}],Ene={blue:"accent-blue-500",amber:"accent-amber-500",red:"accent-red-500",indigo:"accent-indigo-500",green:"accent-green-500",orange:"accent-orange-500",purple:"accent-purple-500"};function wne(){const[n,e]=ne.useState(!1),[t,i]=ne.useState(!1),r=oo(d=>d.visible),s=oo(d=>d.opacity),o=oo(d=>d.setLayerOpacity),a=vne.filter(d=>r[d.name]);if(a.length===0)return null;const u=t?a:a.slice(0,3),h=a.length>3;return V.jsxs("div",{className:"fixed bottom-[140px] md:bottom-[150px] right-2.5 z-[900]",children:[V.jsxs(fi.button,{onClick:()=>e(!n),className:"w-11 h-11 bg-white/80 rounded-xl backdrop-blur-sm shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none hover:bg-white/90 transition-colors",whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":"Opacity sliders",title:n?"Sluit opacity sliders":"Open opacity sliders",children:[V.jsx(GY,{size:22,strokeWidth:2,className:"text-gray-500"}),a.length>0&&V.jsx("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-blue-500 text-white text-[10px] rounded-full flex items-center justify-center",children:a.length})]}),V.jsx(Ka,{children:n&&V.jsxs(fi.div,{initial:{opacity:0,x:20,scale:.9},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:20,scale:.9},transition:{duration:.2},className:"absolute bottom-0 right-14 bg-white/95 rounded-lg shadow-lg p-3 min-w-[220px] max-h-[60vh] overflow-y-auto",children:[V.jsx("div",{className:"text-xs font-semibold text-gray-500 mb-2 uppercase tracking-wide",children:"Transparantie"}),V.jsx("div",{className:"space-y-3",children:u.map(d=>{const g=s[d.name]??d.default;return V.jsxs("div",{children:[V.jsx("label",{className:"text-xs font-medium text-gray-700 mb-1 block truncate",title:d.name,children:d.name}),V.jsxs("div",{className:"flex items-center gap-2",children:[V.jsx("input",{type:"range",min:"0",max:"100",value:g*100,onChange:m=>o(d.name,parseInt(m.target.value)/100),className:`flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer ${Ene[d.color]}`}),V.jsxs("span",{className:"text-xs text-gray-500 w-8 text-right",children:[Math.round(g*100),"%"]})]})]},d.name)})}),h&&V.jsx("button",{onClick:()=>i(!t),className:"w-full mt-3 pt-2 border-t border-gray-200 flex items-center justify-center gap-1 text-xs text-gray-500 hover:text-gray-700",children:t?V.jsxs(V.Fragment,{children:[V.jsx(cO,{size:14}),"Minder tonen"]}):V.jsxs(V.Fragment,{children:[V.jsx(aY,{size:14}),a.length-3," meer..."]})})]})})]})}function xne(){const n=Hi(b=>b.map),e=Ot(b=>b.position),t=tn(b=>b.startNavigation);tn(b=>b.isNavigating);const i=tn(b=>b.loading),[r,s]=ne.useState(""),[o,a]=ne.useState([]),[u,h]=ne.useState(!1),[d,g]=ne.useState(!1),m=ne.useRef(null),v=ne.useRef();ne.useEffect(()=>{if(v.current&&clearTimeout(v.current),r.length<2){a([]);return}return v.current=window.setTimeout(async()=>{g(!0);try{const L=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/suggest?q=${encodeURIComponent(r)}&rows=7`)).json();L.response?.docs&&a(L.response.docs)}catch(b){console.error("Search error:",b),a([])}finally{g(!1)}},300),()=>{v.current&&clearTimeout(v.current)}},[r]);const y=async b=>{try{const D=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/lookup?id=${encodeURIComponent(b)}`)).json();if(D.response?.docs?.[0]?.centroide_ll){const M=D.response.docs[0].centroide_ll.match(/POINT\(([^ ]+) ([^)]+)\)/);if(M)return{lng:parseFloat(M[1]),lat:parseFloat(M[2])}}}catch(L){console.error("Lookup error:",L)}return null},I=async b=>{if(!n)return;const L=await y(b.id);L&&n.getView().animate({center:Jl([L.lng,L.lat]),zoom:16,duration:1e3}),s(""),a([]),h(!1)},w=async(b,L)=>{if(L.stopPropagation(),!e){alert("GPS positie niet beschikbaar. Zet GPS aan.");return}const D=await y(b.id);D&&await t(D,b.weergavenaam,{lng:e.lng,lat:e.lat}),s(""),a([]),h(!1)},R=()=>{s(""),a([]),m.current?.focus()},P=b=>{switch(b){case"adres":return"";case"weg":return"";case"woonplaats":return"";case"gemeente":return"";case"provincie":return"";case"postcode":return"";default:return""}};return V.jsxs("div",{className:"search-box",children:[V.jsxs("div",{className:"search-input-wrapper",children:[V.jsx(fO,{size:18,className:"search-icon"}),V.jsx("input",{ref:m,type:"text",value:r,onChange:b=>{s(b.target.value),h(!0)},onFocus:()=>h(!0),placeholder:"Zoek adres of plaats...",className:"search-input"}),r&&V.jsx("button",{onClick:R,className:"search-clear",children:V.jsx(Gh,{size:16})})]}),u&&o.length>0&&V.jsx("ul",{className:"search-results",children:o.map(b=>V.jsxs("li",{className:"search-result-item",children:[V.jsxs("div",{className:"search-result-content",onClick:()=>I(b),children:[V.jsx("span",{className:"search-result-icon",children:P(b.type)}),V.jsx("span",{className:"search-result-text",children:b.weergavenaam})]}),V.jsx("button",{className:"search-navigate-btn",onClick:L=>w(b,L),disabled:i||!e,title:e?"Navigeer hierheen":"GPS niet actief",children:V.jsx(sI,{size:16})})]},b.id))}),u&&d&&V.jsx("div",{className:"search-loading",children:"Zoeken..."})]})}function Tne(n,e){const i=(e.lat-n.lat)*Math.PI/180,r=(e.lng-n.lng)*Math.PI/180,s=Math.sin(i/2)*Math.sin(i/2)+Math.cos(n.lat*Math.PI/180)*Math.cos(e.lat*Math.PI/180)*Math.sin(r/2)*Math.sin(r/2);return 6371e3*(2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s)))}function Ine(n,e){let t=1/0,i=0;for(let r=0;r<e.length;r++){const s=Tne(n,e[r]);s<t&&(t=s,i=r)}return i}function Sne(){const n=Hi(a=>a.map),e=tn(a=>a.routeCoordinates),t=tn(a=>a.destination),i=tn(a=>a.isNavigating),r=Ot(a=>a.position),s=ne.useRef(null),o=ne.useRef(0);return ne.useEffect(()=>{if(!n)return;const a=new Fb;return s.current=new t4({source:a,zIndex:500}),n.addLayer(s.current),()=>{s.current&&n&&n.removeLayer(s.current)}},[n]),ne.useEffect(()=>{i||(o.current=0)},[i]),ne.useEffect(()=>{if(!s.current)return;const a=s.current.getSource();if(!a||(a.clear(),!i||!e||e.length===0))return;let u=0;if(r&&e.length>2){const m={lng:r.lng,lat:r.lat},v=Ine(m,e);v>o.current&&(o.current=v),u=o.current,u>e.length-2&&(u=e.length-2)}const d=e.slice(u).map(m=>Jl([m.lng,m.lat])),g=new s0({geometry:new h0(d)});if(g.setStyle([new qi({stroke:new Wl({color:"white",width:8,lineCap:"round",lineJoin:"round"})}),new qi({stroke:new Wl({color:"#4285F4",width:5,lineCap:"round",lineJoin:"round"})})]),a.addFeature(g),t){const m=new s0({geometry:new d0(Jl([t.lng,t.lat]))});m.setStyle(new qi({image:new Ch({radius:12,fill:new ka({color:"#EA4335"}),stroke:new Wl({color:"white",width:3})})})),a.addFeature(m)}if(n&&u===0){const m=a.getExtent();n.getView().fit(m,{padding:[80,80,80,80],duration:500})}},[n,i,e,t,r]),null}function Ane(n){const e={size:24,className:"text-white"};return n.includes("left")?n.includes("sharp")?V.jsx(yY,{...e}):n.includes("slight")?V.jsx(JX,{...e}):V.jsx(XX,{...e}):n.includes("right")?n.includes("sharp")?V.jsx(EY,{...e}):n.includes("slight")?V.jsx(tY,{...e}):V.jsx(ZX,{...e}):n.includes("uturn")?V.jsx(Sw,{...e}):n.includes("arrive")?V.jsx(gY,{...e}):n.includes("roundabout")||n.includes("rotary")?V.jsx(Sw,{...e}):V.jsx(iY,{...e})}function Rne(){const n=tn(m=>m.isNavigating),e=tn(m=>m.destinationName),t=tn(m=>m.distance),i=tn(m=>m.duration),r=tn(m=>m.steps),s=tn(m=>m.currentStepIndex),o=tn(m=>m.voiceEnabled),a=tn(m=>m.setVoiceEnabled),u=tn(m=>m.stopNavigation),h=r[s],d=m=>m?m<1e3?`${Math.round(m)} m`:`${(m/1e3).toFixed(1)} km`:"--",g=m=>{if(!m)return"--";if(m<60)return`${Math.round(m)} sec`;const v=Math.round(m/60);if(v<60)return`${v} min`;const y=Math.floor(v/60),I=v%60;return`${y}u ${I}m`};return V.jsx(Ka,{children:n&&V.jsxs(fi.div,{className:"fixed top-16 left-2 right-2 z-[1100] bg-white rounded-xl shadow-lg overflow-hidden",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.2},children:[h&&V.jsxs("div",{className:"bg-blue-600 px-4 py-3 flex items-center gap-3",children:[V.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-700 flex items-center justify-center flex-shrink-0",children:Ane(h.maneuver)}),V.jsxs("div",{className:"flex-1 min-w-0",children:[V.jsx("div",{className:"text-white font-bold text-lg truncate",children:h.instruction}),V.jsxs("div",{className:"text-blue-200 text-sm",children:["Over ",d(h.distance)]})]}),V.jsx("button",{onClick:()=>a(!o),className:`w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0 transition-colors ${o?"bg-blue-700 text-white":"bg-blue-800 text-blue-400"}`,title:o?"Geluid uit":"Geluid aan",children:o?V.jsx(WY,{size:20}):V.jsx(qY,{size:20})})]}),V.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 border-t border-gray-100",children:[V.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center flex-shrink-0",children:V.jsx(sI,{size:20,className:"text-gray-600"})}),V.jsxs("div",{className:"flex-1 min-w-0",children:[V.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500",children:[V.jsx(dO,{size:12}),V.jsx("span",{children:"Bestemming"})]}),V.jsx("div",{className:"font-medium text-gray-900 truncate text-sm",children:e||"Bestemming"})]}),V.jsxs("div",{className:"text-right flex-shrink-0",children:[V.jsx("div",{className:"text-lg font-bold text-blue-600",children:d(t)}),V.jsx("div",{className:"text-xs text-gray-500",children:g(i)})]}),V.jsx("button",{onClick:u,className:"w-10 h-10 rounded-full bg-red-500 hover:bg-red-600 flex items-center justify-center flex-shrink-0 transition-colors",title:"Stop navigatie",children:V.jsx(Gh,{size:20,className:"text-white"})})]}),r.length>1&&V.jsxs("div",{className:"px-4 pb-2",children:[V.jsx("div",{className:"flex gap-1",children:r.map((m,v)=>V.jsx("div",{className:`h-1 flex-1 rounded-full transition-colors ${v<s?"bg-green-500":v===s?"bg-blue-500":"bg-gray-200"}`},v))}),V.jsxs("div",{className:"text-xs text-gray-400 mt-1 text-center",children:["Stap ",s+1," van ",r.length]})]})]})})}function Pne(){const n=Ot(i=>i.tracking),e=Ot(i=>i.headingSource),t=Ot(i=>i.updateHeading);ne.useEffect(()=>{if(!n||e!=="compass")return;let i=0;const r=100,s=u=>{const h=Date.now();h-i<r||(i=h,u.alpha!==null&&t(360-u.alpha,"compass"))},o=u=>{const h=Date.now();h-i<r||(i=h,u.alpha!==null&&t(360-u.alpha,"compass"))},a=u=>{const h=Date.now();h-i<r||(i=h,u.webkitCompassHeading!==void 0&&t(u.webkitCompassHeading,"compass"))};return window.addEventListener("deviceorientationabsolute",o),window.addEventListener("deviceorientation",s),window.addEventListener("deviceorientation",a),()=>{window.removeEventListener("deviceorientationabsolute",o),window.removeEventListener("deviceorientation",s),window.removeEventListener("deviceorientation",a)}},[n,e,t])}const Cne=n=>n<.5?2*n*n:-1+(4-2*n)*n;function Mne(){const n=Hi(u=>u.map),e=Hi(u=>u.rotationEnabled),t=Hi(u=>u.setRotation),i=Ot(u=>u.smoothHeading),r=Ot(u=>u.tracking),s=Ot(u=>u.navigationMode),o=ne.useRef(null),a=ne.useRef(null);ne.useEffect(()=>{n&&(s==="drive"&&a.current!=="drive"&&(n.getView().animate({zoom:15,duration:500}),console.log(" Rijmodus: zoom naar wijkniveau (15)")),a.current=s)},[n,s]),ne.useEffect(()=>{if(s==="free"){n&&n.getView().getRotation()!==0&&(n.getView().animate({rotation:0,duration:500}),t(0),o.current=null);return}if(!n||!r||!e||i===null){n&&!r&&(n.getView().animate({rotation:0,duration:500}),t(0),o.current=null);return}const u=i*Math.PI/180,h=o.current??n.getView().getRotation();let d=u-h;for(;d>Math.PI;)d-=2*Math.PI;for(;d<-Math.PI;)d+=2*Math.PI;Math.abs(d)<.087||(n.getView().animate({rotation:u,duration:250,easing:Cne}),o.current=u,t(i))},[n,r,e,i,t])}function bne(){const n=Hi(d=>d.map),e=Ot(d=>d.position),t=Ot(d=>d.tracking),i=Ot(d=>d.navigationMode),r=Ot(d=>d.toggleMode),s=tn(d=>d.isNavigating),o=tn(d=>d.updateCurrentStep),a=tn(d=>d.destination),u=ne.useRef(!1),h=ne.useRef(0);return ne.useEffect(()=>{s&&!u.current?(console.log(" Navigation started - activating drive mode"),i==="free"&&r(),u.current=!0):!s&&u.current&&(console.log(" Navigation stopped - deactivating drive mode"),i==="drive"&&r(),u.current=!1)},[s,i,r]),ne.useEffect(()=>{!s||!e||o({lng:e.lng,lat:e.lat})},[s,e,o]),ne.useEffect(()=>{if(!n||!e||!s||!t)return;const d=Date.now();if(d-h.current<500)return;h.current=d;const g=Jl([e.lng,e.lat]);n.getView().animate({center:g,duration:300})},[n,e,s,t]),ne.useEffect(()=>{if(!n||!s)return;(n.getView().getZoom()||15)<14&&n.getView().animate({zoom:15,duration:500})},[n,s,e]),{isNavigating:s,destination:a}}function kne(){return Pne(),Mne(),bne(),V.jsxs(V.Fragment,{children:[V.jsx(pW,{}),V.jsx(JY,{}),V.jsx(Sne,{}),V.jsx(ane,{}),V.jsx(lne,{}),V.jsx(xne,{}),V.jsx(Rne,{}),V.jsx(QY,{}),V.jsx(eZ,{}),V.jsx(tZ,{}),V.jsx(wne,{}),V.jsx(une,{}),V.jsx(_ne,{}),V.jsx(yne,{})]})}e5.createRoot(document.getElementById("root")).render(V.jsx(kne,{}));export{d0 as $,V2 as A,Io as B,$b as C,VA as D,He as E,u4 as F,t4 as G,qi as H,ze as I,Wl as J,ka as K,k_ as L,Fb as M,$c as N,ix as O,I5 as P,rE as Q,Gw as R,Vb as S,Ic as T,$v as U,Xn as V,q2 as W,Hd as X,Nne as Y,One as Z,s0 as _,uF as a,Jl as a0,_0 as a1,e6 as a2,Nw as a3,p_ as a4,u5 as a5,T_ as a6,g_ as a7,cb as a8,hb as a9,ot as aA,u0 as aB,kb as aC,fE as aD,rh as aE,t6 as aF,jne as aa,c0 as ab,h0 as ac,pb as ad,lE as ae,s6 as af,Bne as ag,db as ah,Wc as ai,Fl as aj,$M as ak,qw as al,Vne as am,Fne as an,Une as ao,Xne as ap,Hne as aq,Z2 as ar,H6 as as,X6 as at,qne as au,$ne as av,Vf as aw,zne as ax,Gne as ay,Br as az,Sn as b,sh as c,ut as d,Jn as e,_a as f,$l as g,Ri as h,E_ as i,Ud as j,_o as k,Wne as l,Zl as m,_E as n,bV as o,at as p,kV as q,CV as r,Dw as s,Lp as t,Ft as u,bf as v,sp as w,eE as x,jn as y,Kne as z};
//# sourceMappingURL=index-WTSpnFHA.js.map
