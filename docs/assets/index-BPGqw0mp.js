const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/romeinseFortenOL-CduQhRzn.js","assets/iconStyles-hn9Wg7E6.js","assets/amkOL-hRRq-Ive.js","assets/layerLoaderOL-Bnx3Jd5G.js","assets/romeinsOL-C99Oifri.js","assets/kastelenOL-Cgq4BfdT.js","assets/ruinesOL-B8a0rT8r.js","assets/hunebeddenOL-DSQe2qw7.js","assets/uikavArcheoPuntenOL-Co3MnA8h.js","assets/uikavVlakkenOL-PbC0WFT7.js","assets/uikavBufferlaagOL-PlIjcn5X.js","assets/uikavExpertOL-B0oFPklS.js","assets/uikavUiterwaardenOL-DPthI7Im.js","assets/speeltuinenOL-BGBYRl-q.js","assets/museaOL-DMS8OkbZ.js","assets/strandjesOL-Dz6fNbQW.js","assets/parkenOL-9WM-OB9q.js","assets/kringloopwinkelsOL-C8kbVK2v.js","assets/fossielenOL-xHjeIVxE.js","assets/fossielUtils-B--7gkll.js","assets/fossielenBelgieOL-BILs619n.js","assets/fossielenDuitslandOL-CFRC0rbi.js","assets/fossielenFrankrijkOL-pmuEQXvv.js","assets/bunkersOL-Bk_D376i.js","assets/grafheuvelsOL-CJorVBYH.js","assets/slagveldenOL-CuYzhhT8.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();function Kb(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var x2={exports:{}},Lg={},v2={exports:{}},ln={};var TP;function RB(){if(TP)return ln;TP=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),a=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;function g(se){return se===null||typeof se!="object"?null:(se=f&&se[f]||se["@@iterator"],typeof se=="function"?se:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,x={};function E(se,V,J){this.props=se,this.context=V,this.refs=x,this.updater=J||y}E.prototype.isReactComponent={},E.prototype.setState=function(se,V){if(typeof se!="object"&&typeof se!="function"&&se!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,se,V,"setState")},E.prototype.forceUpdate=function(se){this.updater.enqueueForceUpdate(this,se,"forceUpdate")};function T(){}T.prototype=E.prototype;function b(se,V,J){this.props=se,this.context=V,this.refs=x,this.updater=J||y}var I=b.prototype=new T;I.constructor=b,v(I,E.prototype),I.isPureReactComponent=!0;var M=Array.isArray,F=Object.prototype.hasOwnProperty,z={current:null},P={key:!0,ref:!0,__self:!0,__source:!0};function C(se,V,J){var re,q={},he=null,Me=null;if(V!=null)for(re in V.ref!==void 0&&(Me=V.ref),V.key!==void 0&&(he=""+V.key),V)F.call(V,re)&&!P.hasOwnProperty(re)&&(q[re]=V[re]);var je=arguments.length-2;if(je===1)q.children=J;else if(1<je){for(var De=Array(je),Be=0;Be<je;Be++)De[Be]=arguments[Be+2];q.children=De}if(se&&se.defaultProps)for(re in je=se.defaultProps,je)q[re]===void 0&&(q[re]=je[re]);return{$$typeof:n,type:se,key:he,ref:Me,props:q,_owner:z.current}}function k(se,V){return{$$typeof:n,type:se.type,key:V,ref:se.ref,props:se.props,_owner:se._owner}}function L(se){return typeof se=="object"&&se!==null&&se.$$typeof===n}function O(se){var V={"=":"=0",":":"=2"};return"$"+se.replace(/[=:]/g,function(J){return V[J]})}var U=/\/+/g;function j(se,V){return typeof se=="object"&&se!==null&&se.key!=null?O(""+se.key):V.toString(36)}function Te(se,V,J,re,q){var he=typeof se;(he==="undefined"||he==="boolean")&&(se=null);var Me=!1;if(se===null)Me=!0;else switch(he){case"string":case"number":Me=!0;break;case"object":switch(se.$$typeof){case n:case e:Me=!0}}if(Me)return Me=se,q=q(Me),se=re===""?"."+j(Me,0):re,M(q)?(J="",se!=null&&(J=se.replace(U,"$&/")+"/"),Te(q,V,J,"",function(Be){return Be})):q!=null&&(L(q)&&(q=k(q,J+(!q.key||Me&&Me.key===q.key?"":(""+q.key).replace(U,"$&/")+"/")+se)),V.push(q)),1;if(Me=0,re=re===""?".":re+":",M(se))for(var je=0;je<se.length;je++){he=se[je];var De=re+j(he,je);Me+=Te(he,V,J,De,q)}else if(De=g(se),typeof De=="function")for(se=De.call(se),je=0;!(he=se.next()).done;)he=he.value,De=re+j(he,je++),Me+=Te(he,V,J,De,q);else if(he==="object")throw V=String(se),Error("Objects are not valid as a React child (found: "+(V==="[object Object]"?"object with keys {"+Object.keys(se).join(", ")+"}":V)+"). If you meant to render a collection of children, use an array instead.");return Me}function Ce(se,V,J){if(se==null)return se;var re=[],q=0;return Te(se,re,"","",function(he){return V.call(J,he,q++)}),re}function Ue(se){if(se._status===-1){var V=se._result;V=V(),V.then(function(J){(se._status===0||se._status===-1)&&(se._status=1,se._result=J)},function(J){(se._status===0||se._status===-1)&&(se._status=2,se._result=J)}),se._status===-1&&(se._status=0,se._result=V)}if(se._status===1)return se._result.default;throw se._result}var Ne={current:null},le={transition:null},ue={ReactCurrentDispatcher:Ne,ReactCurrentBatchConfig:le,ReactCurrentOwner:z};function Se(){throw Error("act(...) is not supported in production builds of React.")}return ln.Children={map:Ce,forEach:function(se,V,J){Ce(se,function(){V.apply(this,arguments)},J)},count:function(se){var V=0;return Ce(se,function(){V++}),V},toArray:function(se){return Ce(se,function(V){return V})||[]},only:function(se){if(!L(se))throw Error("React.Children.only expected to receive a single React element child.");return se}},ln.Component=E,ln.Fragment=t,ln.Profiler=i,ln.PureComponent=b,ln.StrictMode=r,ln.Suspense=l,ln.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ue,ln.act=Se,ln.cloneElement=function(se,V,J){if(se==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+se+".");var re=v({},se.props),q=se.key,he=se.ref,Me=se._owner;if(V!=null){if(V.ref!==void 0&&(he=V.ref,Me=z.current),V.key!==void 0&&(q=""+V.key),se.type&&se.type.defaultProps)var je=se.type.defaultProps;for(De in V)F.call(V,De)&&!P.hasOwnProperty(De)&&(re[De]=V[De]===void 0&&je!==void 0?je[De]:V[De])}var De=arguments.length-2;if(De===1)re.children=J;else if(1<De){je=Array(De);for(var Be=0;Be<De;Be++)je[Be]=arguments[Be+2];re.children=je}return{$$typeof:n,type:se.type,key:q,ref:he,props:re,_owner:Me}},ln.createContext=function(se){return se={$$typeof:a,_currentValue:se,_currentValue2:se,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},se.Provider={$$typeof:s,_context:se},se.Consumer=se},ln.createElement=C,ln.createFactory=function(se){var V=C.bind(null,se);return V.type=se,V},ln.createRef=function(){return{current:null}},ln.forwardRef=function(se){return{$$typeof:o,render:se}},ln.isValidElement=L,ln.lazy=function(se){return{$$typeof:h,_payload:{_status:-1,_result:se},_init:Ue}},ln.memo=function(se,V){return{$$typeof:u,type:se,compare:V===void 0?null:V}},ln.startTransition=function(se){var V=le.transition;le.transition={};try{se()}finally{le.transition=V}},ln.unstable_act=Se,ln.useCallback=function(se,V){return Ne.current.useCallback(se,V)},ln.useContext=function(se){return Ne.current.useContext(se)},ln.useDebugValue=function(){},ln.useDeferredValue=function(se){return Ne.current.useDeferredValue(se)},ln.useEffect=function(se,V){return Ne.current.useEffect(se,V)},ln.useId=function(){return Ne.current.useId()},ln.useImperativeHandle=function(se,V,J){return Ne.current.useImperativeHandle(se,V,J)},ln.useInsertionEffect=function(se,V){return Ne.current.useInsertionEffect(se,V)},ln.useLayoutEffect=function(se,V){return Ne.current.useLayoutEffect(se,V)},ln.useMemo=function(se,V){return Ne.current.useMemo(se,V)},ln.useReducer=function(se,V,J){return Ne.current.useReducer(se,V,J)},ln.useRef=function(se){return Ne.current.useRef(se)},ln.useState=function(se){return Ne.current.useState(se)},ln.useSyncExternalStore=function(se,V,J){return Ne.current.useSyncExternalStore(se,V,J)},ln.useTransition=function(){return Ne.current.useTransition()},ln.version="18.3.1",ln}var bP;function Vp(){return bP||(bP=1,v2.exports=RB()),v2.exports}var IP;function CB(){if(IP)return Lg;IP=1;var n=Vp(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,i=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function a(o,l,u){var h,f={},g=null,y=null;u!==void 0&&(g=""+u),l.key!==void 0&&(g=""+l.key),l.ref!==void 0&&(y=l.ref);for(h in l)r.call(l,h)&&!s.hasOwnProperty(h)&&(f[h]=l[h]);if(o&&o.defaultProps)for(h in l=o.defaultProps,l)f[h]===void 0&&(f[h]=l[h]);return{$$typeof:e,type:o,key:g,ref:y,props:f,_owner:i.current}}return Lg.Fragment=t,Lg.jsx=a,Lg.jsxs=a,Lg}var AP;function kB(){return AP||(AP=1,x2.exports=CB()),x2.exports}var m=kB(),Fy={},w2={exports:{}},_s={},E2={exports:{}},S2={};var RP;function PB(){return RP||(RP=1,(function(n){function e(le,ue){var Se=le.length;le.push(ue);e:for(;0<Se;){var se=Se-1>>>1,V=le[se];if(0<i(V,ue))le[se]=ue,le[Se]=V,Se=se;else break e}}function t(le){return le.length===0?null:le[0]}function r(le){if(le.length===0)return null;var ue=le[0],Se=le.pop();if(Se!==ue){le[0]=Se;e:for(var se=0,V=le.length,J=V>>>1;se<J;){var re=2*(se+1)-1,q=le[re],he=re+1,Me=le[he];if(0>i(q,Se))he<V&&0>i(Me,q)?(le[se]=Me,le[he]=Se,se=he):(le[se]=q,le[re]=Se,se=re);else if(he<V&&0>i(Me,Se))le[se]=Me,le[he]=Se,se=he;else break e}}return ue}function i(le,ue){var Se=le.sortIndex-ue.sortIndex;return Se!==0?Se:le.id-ue.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();n.unstable_now=function(){return a.now()-o}}var l=[],u=[],h=1,f=null,g=3,y=!1,v=!1,x=!1,E=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function I(le){for(var ue=t(u);ue!==null;){if(ue.callback===null)r(u);else if(ue.startTime<=le)r(u),ue.sortIndex=ue.expirationTime,e(l,ue);else break;ue=t(u)}}function M(le){if(x=!1,I(le),!v)if(t(l)!==null)v=!0,Ue(F);else{var ue=t(u);ue!==null&&Ne(M,ue.startTime-le)}}function F(le,ue){v=!1,x&&(x=!1,T(C),C=-1),y=!0;var Se=g;try{for(I(ue),f=t(l);f!==null&&(!(f.expirationTime>ue)||le&&!O());){var se=f.callback;if(typeof se=="function"){f.callback=null,g=f.priorityLevel;var V=se(f.expirationTime<=ue);ue=n.unstable_now(),typeof V=="function"?f.callback=V:f===t(l)&&r(l),I(ue)}else r(l);f=t(l)}if(f!==null)var J=!0;else{var re=t(u);re!==null&&Ne(M,re.startTime-ue),J=!1}return J}finally{f=null,g=Se,y=!1}}var z=!1,P=null,C=-1,k=5,L=-1;function O(){return!(n.unstable_now()-L<k)}function U(){if(P!==null){var le=n.unstable_now();L=le;var ue=!0;try{ue=P(!0,le)}finally{ue?j():(z=!1,P=null)}}else z=!1}var j;if(typeof b=="function")j=function(){b(U)};else if(typeof MessageChannel<"u"){var Te=new MessageChannel,Ce=Te.port2;Te.port1.onmessage=U,j=function(){Ce.postMessage(null)}}else j=function(){E(U,0)};function Ue(le){P=le,z||(z=!0,j())}function Ne(le,ue){C=E(function(){le(n.unstable_now())},ue)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(le){le.callback=null},n.unstable_continueExecution=function(){v||y||(v=!0,Ue(F))},n.unstable_forceFrameRate=function(le){0>le||125<le?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<le?Math.floor(1e3/le):5},n.unstable_getCurrentPriorityLevel=function(){return g},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(le){switch(g){case 1:case 2:case 3:var ue=3;break;default:ue=g}var Se=g;g=ue;try{return le()}finally{g=Se}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(le,ue){switch(le){case 1:case 2:case 3:case 4:case 5:break;default:le=3}var Se=g;g=le;try{return ue()}finally{g=Se}},n.unstable_scheduleCallback=function(le,ue,Se){var se=n.unstable_now();switch(typeof Se=="object"&&Se!==null?(Se=Se.delay,Se=typeof Se=="number"&&0<Se?se+Se:se):Se=se,le){case 1:var V=-1;break;case 2:V=250;break;case 5:V=1073741823;break;case 4:V=1e4;break;default:V=5e3}return V=Se+V,le={id:h++,callback:ue,priorityLevel:le,startTime:Se,expirationTime:V,sortIndex:-1},Se>se?(le.sortIndex=Se,e(u,le),t(l)===null&&le===t(u)&&(x?(T(C),C=-1):x=!0,Ne(M,Se-se))):(le.sortIndex=V,e(l,le),v||y||(v=!0,Ue(F))),le},n.unstable_shouldYield=O,n.unstable_wrapCallback=function(le){var ue=g;return function(){var Se=g;g=ue;try{return le.apply(this,arguments)}finally{g=Se}}}})(S2)),S2}var CP;function MB(){return CP||(CP=1,E2.exports=PB()),E2.exports}var kP;function NB(){if(kP)return _s;kP=1;var n=Vp(),e=MB();function t(c){for(var d="https://reactjs.org/docs/error-decoder.html?invariant="+c,p=1;p<arguments.length;p++)d+="&args[]="+encodeURIComponent(arguments[p]);return"Minified React error #"+c+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,i={};function s(c,d){a(c,d),a(c+"Capture",d)}function a(c,d){for(i[c]=d,c=0;c<d.length;c++)r.add(d[c])}var o=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),l=Object.prototype.hasOwnProperty,u=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},f={};function g(c){return l.call(f,c)?!0:l.call(h,c)?!1:u.test(c)?f[c]=!0:(h[c]=!0,!1)}function y(c,d,p,w){if(p!==null&&p.type===0)return!1;switch(typeof d){case"function":case"symbol":return!0;case"boolean":return w?!1:p!==null?!p.acceptsBooleans:(c=c.toLowerCase().slice(0,5),c!=="data-"&&c!=="aria-");default:return!1}}function v(c,d,p,w){if(d===null||typeof d>"u"||y(c,d,p,w))return!0;if(w)return!1;if(p!==null)switch(p.type){case 3:return!d;case 4:return d===!1;case 5:return isNaN(d);case 6:return isNaN(d)||1>d}return!1}function x(c,d,p,w,S,A,G){this.acceptsBooleans=d===2||d===3||d===4,this.attributeName=w,this.attributeNamespace=S,this.mustUseProperty=p,this.propertyName=c,this.type=d,this.sanitizeURL=A,this.removeEmptyString=G}var E={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(c){E[c]=new x(c,0,!1,c,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(c){var d=c[0];E[d]=new x(d,1,!1,c[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(c){E[c]=new x(c,2,!1,c.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(c){E[c]=new x(c,2,!1,c,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(c){E[c]=new x(c,3,!1,c.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(c){E[c]=new x(c,3,!0,c,null,!1,!1)}),["capture","download"].forEach(function(c){E[c]=new x(c,4,!1,c,null,!1,!1)}),["cols","rows","size","span"].forEach(function(c){E[c]=new x(c,6,!1,c,null,!1,!1)}),["rowSpan","start"].forEach(function(c){E[c]=new x(c,5,!1,c.toLowerCase(),null,!1,!1)});var T=/[\-:]([a-z])/g;function b(c){return c[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(c){var d=c.replace(T,b);E[d]=new x(d,1,!1,c,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(c){var d=c.replace(T,b);E[d]=new x(d,1,!1,c,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(c){var d=c.replace(T,b);E[d]=new x(d,1,!1,c,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(c){E[c]=new x(c,1,!1,c.toLowerCase(),null,!1,!1)}),E.xlinkHref=new x("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(c){E[c]=new x(c,1,!1,c.toLowerCase(),null,!0,!0)});function I(c,d,p,w){var S=E.hasOwnProperty(d)?E[d]:null;(S!==null?S.type!==0:w||!(2<d.length)||d[0]!=="o"&&d[0]!=="O"||d[1]!=="n"&&d[1]!=="N")&&(v(d,p,S,w)&&(p=null),w||S===null?g(d)&&(p===null?c.removeAttribute(d):c.setAttribute(d,""+p)):S.mustUseProperty?c[S.propertyName]=p===null?S.type===3?!1:"":p:(d=S.attributeName,w=S.attributeNamespace,p===null?c.removeAttribute(d):(S=S.type,p=S===3||S===4&&p===!0?"":""+p,w?c.setAttributeNS(w,d,p):c.setAttribute(d,p))))}var M=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,F=Symbol.for("react.element"),z=Symbol.for("react.portal"),P=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),L=Symbol.for("react.provider"),O=Symbol.for("react.context"),U=Symbol.for("react.forward_ref"),j=Symbol.for("react.suspense"),Te=Symbol.for("react.suspense_list"),Ce=Symbol.for("react.memo"),Ue=Symbol.for("react.lazy"),Ne=Symbol.for("react.offscreen"),le=Symbol.iterator;function ue(c){return c===null||typeof c!="object"?null:(c=le&&c[le]||c["@@iterator"],typeof c=="function"?c:null)}var Se=Object.assign,se;function V(c){if(se===void 0)try{throw Error()}catch(p){var d=p.stack.trim().match(/\n( *(at )?)/);se=d&&d[1]||""}return`
`+se+c}var J=!1;function re(c,d){if(!c||J)return"";J=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(d)if(d=function(){throw Error()},Object.defineProperty(d.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(d,[])}catch(Ie){var w=Ie}Reflect.construct(c,[],d)}else{try{d.call()}catch(Ie){w=Ie}c.call(d.prototype)}else{try{throw Error()}catch(Ie){w=Ie}c()}}catch(Ie){if(Ie&&w&&typeof Ie.stack=="string"){for(var S=Ie.stack.split(`
`),A=w.stack.split(`
`),G=S.length-1,ie=A.length-1;1<=G&&0<=ie&&S[G]!==A[ie];)ie--;for(;1<=G&&0<=ie;G--,ie--)if(S[G]!==A[ie]){if(G!==1||ie!==1)do if(G--,ie--,0>ie||S[G]!==A[ie]){var ae=`
`+S[G].replace(" at new "," at ");return c.displayName&&ae.includes("<anonymous>")&&(ae=ae.replace("<anonymous>",c.displayName)),ae}while(1<=G&&0<=ie);break}}}finally{J=!1,Error.prepareStackTrace=p}return(c=c?c.displayName||c.name:"")?V(c):""}function q(c){switch(c.tag){case 5:return V(c.type);case 16:return V("Lazy");case 13:return V("Suspense");case 19:return V("SuspenseList");case 0:case 2:case 15:return c=re(c.type,!1),c;case 11:return c=re(c.type.render,!1),c;case 1:return c=re(c.type,!0),c;default:return""}}function he(c){if(c==null)return null;if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c;switch(c){case P:return"Fragment";case z:return"Portal";case k:return"Profiler";case C:return"StrictMode";case j:return"Suspense";case Te:return"SuspenseList"}if(typeof c=="object")switch(c.$$typeof){case O:return(c.displayName||"Context")+".Consumer";case L:return(c._context.displayName||"Context")+".Provider";case U:var d=c.render;return c=c.displayName,c||(c=d.displayName||d.name||"",c=c!==""?"ForwardRef("+c+")":"ForwardRef"),c;case Ce:return d=c.displayName||null,d!==null?d:he(c.type)||"Memo";case Ue:d=c._payload,c=c._init;try{return he(c(d))}catch{}}return null}function Me(c){var d=c.type;switch(c.tag){case 24:return"Cache";case 9:return(d.displayName||"Context")+".Consumer";case 10:return(d._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return c=d.render,c=c.displayName||c.name||"",d.displayName||(c!==""?"ForwardRef("+c+")":"ForwardRef");case 7:return"Fragment";case 5:return d;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return he(d);case 8:return d===C?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof d=="function")return d.displayName||d.name||null;if(typeof d=="string")return d}return null}function je(c){switch(typeof c){case"boolean":case"number":case"string":case"undefined":return c;case"object":return c;default:return""}}function De(c){var d=c.type;return(c=c.nodeName)&&c.toLowerCase()==="input"&&(d==="checkbox"||d==="radio")}function Be(c){var d=De(c)?"checked":"value",p=Object.getOwnPropertyDescriptor(c.constructor.prototype,d),w=""+c[d];if(!c.hasOwnProperty(d)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var S=p.get,A=p.set;return Object.defineProperty(c,d,{configurable:!0,get:function(){return S.call(this)},set:function(G){w=""+G,A.call(this,G)}}),Object.defineProperty(c,d,{enumerable:p.enumerable}),{getValue:function(){return w},setValue:function(G){w=""+G},stopTracking:function(){c._valueTracker=null,delete c[d]}}}}function Gt(c){c._valueTracker||(c._valueTracker=Be(c))}function Kt(c){if(!c)return!1;var d=c._valueTracker;if(!d)return!0;var p=d.getValue(),w="";return c&&(w=De(c)?c.checked?"true":"false":c.value),c=w,c!==p?(d.setValue(c),!0):!1}function wn(c){if(c=c||(typeof document<"u"?document:void 0),typeof c>"u")return null;try{return c.activeElement||c.body}catch{return c.body}}function Bt(c,d){var p=d.checked;return Se({},d,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:p??c._wrapperState.initialChecked})}function Fn(c,d){var p=d.defaultValue==null?"":d.defaultValue,w=d.checked!=null?d.checked:d.defaultChecked;p=je(d.value!=null?d.value:p),c._wrapperState={initialChecked:w,initialValue:p,controlled:d.type==="checkbox"||d.type==="radio"?d.checked!=null:d.value!=null}}function Qt(c,d){d=d.checked,d!=null&&I(c,"checked",d,!1)}function ot(c,d){Qt(c,d);var p=je(d.value),w=d.type;if(p!=null)w==="number"?(p===0&&c.value===""||c.value!=p)&&(c.value=""+p):c.value!==""+p&&(c.value=""+p);else if(w==="submit"||w==="reset"){c.removeAttribute("value");return}d.hasOwnProperty("value")?on(c,d.type,p):d.hasOwnProperty("defaultValue")&&on(c,d.type,je(d.defaultValue)),d.checked==null&&d.defaultChecked!=null&&(c.defaultChecked=!!d.defaultChecked)}function Zn(c,d,p){if(d.hasOwnProperty("value")||d.hasOwnProperty("defaultValue")){var w=d.type;if(!(w!=="submit"&&w!=="reset"||d.value!==void 0&&d.value!==null))return;d=""+c._wrapperState.initialValue,p||d===c.value||(c.value=d),c.defaultValue=d}p=c.name,p!==""&&(c.name=""),c.defaultChecked=!!c._wrapperState.initialChecked,p!==""&&(c.name=p)}function on(c,d,p){(d!=="number"||wn(c.ownerDocument)!==c)&&(p==null?c.defaultValue=""+c._wrapperState.initialValue:c.defaultValue!==""+p&&(c.defaultValue=""+p))}var en=Array.isArray;function Qn(c,d,p,w){if(c=c.options,d){d={};for(var S=0;S<p.length;S++)d["$"+p[S]]=!0;for(p=0;p<c.length;p++)S=d.hasOwnProperty("$"+c[p].value),c[p].selected!==S&&(c[p].selected=S),S&&w&&(c[p].defaultSelected=!0)}else{for(p=""+je(p),d=null,S=0;S<c.length;S++){if(c[S].value===p){c[S].selected=!0,w&&(c[S].defaultSelected=!0);return}d!==null||c[S].disabled||(d=c[S])}d!==null&&(d.selected=!0)}}function mt(c,d){if(d.dangerouslySetInnerHTML!=null)throw Error(t(91));return Se({},d,{value:void 0,defaultValue:void 0,children:""+c._wrapperState.initialValue})}function jt(c,d){var p=d.value;if(p==null){if(p=d.children,d=d.defaultValue,p!=null){if(d!=null)throw Error(t(92));if(en(p)){if(1<p.length)throw Error(t(93));p=p[0]}d=p}d==null&&(d=""),p=d}c._wrapperState={initialValue:je(p)}}function Pn(c,d){var p=je(d.value),w=je(d.defaultValue);p!=null&&(p=""+p,p!==c.value&&(c.value=p),d.defaultValue==null&&c.defaultValue!==p&&(c.defaultValue=p)),w!=null&&(c.defaultValue=""+w)}function _t(c){var d=c.textContent;d===c._wrapperState.initialValue&&d!==""&&d!==null&&(c.value=d)}function Jt(c){switch(c){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Rt(c,d){return c==null||c==="http://www.w3.org/1999/xhtml"?Jt(d):c==="http://www.w3.org/2000/svg"&&d==="foreignObject"?"http://www.w3.org/1999/xhtml":c}var rr,ai=(function(c){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(d,p,w,S){MSApp.execUnsafeLocalFunction(function(){return c(d,p,w,S)})}:c})(function(c,d){if(c.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in c)c.innerHTML=d;else{for(rr=rr||document.createElement("div"),rr.innerHTML="<svg>"+d.valueOf().toString()+"</svg>",d=rr.firstChild;c.firstChild;)c.removeChild(c.firstChild);for(;d.firstChild;)c.appendChild(d.firstChild)}});function Gr(c,d){if(d){var p=c.firstChild;if(p&&p===c.lastChild&&p.nodeType===3){p.nodeValue=d;return}}c.textContent=d}var Ut={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},es=["Webkit","ms","Moz","O"];Object.keys(Ut).forEach(function(c){es.forEach(function(d){d=d+c.charAt(0).toUpperCase()+c.substring(1),Ut[d]=Ut[c]})});function Oe(c,d,p){return d==null||typeof d=="boolean"||d===""?"":p||typeof d!="number"||d===0||Ut.hasOwnProperty(c)&&Ut[c]?(""+d).trim():d+"px"}function we(c,d){c=c.style;for(var p in d)if(d.hasOwnProperty(p)){var w=p.indexOf("--")===0,S=Oe(p,d[p],w);p==="float"&&(p="cssFloat"),w?c.setProperty(p,S):c[p]=S}}var pe=Se({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function kt(c,d){if(d){if(pe[c]&&(d.children!=null||d.dangerouslySetInnerHTML!=null))throw Error(t(137,c));if(d.dangerouslySetInnerHTML!=null){if(d.children!=null)throw Error(t(60));if(typeof d.dangerouslySetInnerHTML!="object"||!("__html"in d.dangerouslySetInnerHTML))throw Error(t(61))}if(d.style!=null&&typeof d.style!="object")throw Error(t(62))}}function N(c,d){if(c.indexOf("-")===-1)return typeof d.is=="string";switch(c){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Pt=null;function W(c){return c=c.target||c.srcElement||window,c.correspondingUseElement&&(c=c.correspondingUseElement),c.nodeType===3?c.parentNode:c}var Z=null,X=null,ce=null;function de(c){if(c=xg(c)){if(typeof Z!="function")throw Error(t(280));var d=c.stateNode;d&&(d=Q1(d),Z(c.stateNode,c.type,d))}}function Ve(c){X?ce?ce.push(c):ce=[c]:X=c}function be(){if(X){var c=X,d=ce;if(ce=X=null,de(c),d)for(c=0;c<d.length;c++)de(d[c])}}function $e(c,d){return c(d)}function et(){}var ft=!1;function St(c,d,p){if(ft)return c(d,p);ft=!0;try{return $e(c,d,p)}finally{ft=!1,(X!==null||ce!==null)&&(et(),be())}}function sn(c,d){var p=c.stateNode;if(p===null)return null;var w=Q1(p);if(w===null)return null;p=w[d];e:switch(d){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(w=!w.disabled)||(c=c.type,w=!(c==="button"||c==="input"||c==="select"||c==="textarea")),c=!w;break e;default:c=!1}if(c)return null;if(p&&typeof p!="function")throw Error(t(231,d,typeof p));return p}var ur=!1;if(o)try{var cn={};Object.defineProperty(cn,"passive",{get:function(){ur=!0}}),window.addEventListener("test",cn,cn),window.removeEventListener("test",cn,cn)}catch{ur=!1}function hr(c,d,p,w,S,A,G,ie,ae){var Ie=Array.prototype.slice.call(arguments,3);try{d.apply(p,Ie)}catch(He){this.onError(He)}}var yr=!1,Li=null,B=!1,Q=null,K={onError:function(c){yr=!0,Li=c}};function Y(c,d,p,w,S,A,G,ie,ae){yr=!1,Li=null,hr.apply(K,arguments)}function ee(c,d,p,w,S,A,G,ie,ae){if(Y.apply(this,arguments),yr){if(yr){var Ie=Li;yr=!1,Li=null}else throw Error(t(198));B||(B=!0,Q=Ie)}}function te(c){var d=c,p=c;if(c.alternate)for(;d.return;)d=d.return;else{c=d;do d=c,(d.flags&4098)!==0&&(p=d.return),c=d.return;while(c)}return d.tag===3?p:null}function _e(c){if(c.tag===13){var d=c.memoizedState;if(d===null&&(c=c.alternate,c!==null&&(d=c.memoizedState)),d!==null)return d.dehydrated}return null}function ke(c){if(te(c)!==c)throw Error(t(188))}function ye(c){var d=c.alternate;if(!d){if(d=te(c),d===null)throw Error(t(188));return d!==c?null:c}for(var p=c,w=d;;){var S=p.return;if(S===null)break;var A=S.alternate;if(A===null){if(w=S.return,w!==null){p=w;continue}break}if(S.child===A.child){for(A=S.child;A;){if(A===p)return ke(S),c;if(A===w)return ke(S),d;A=A.sibling}throw Error(t(188))}if(p.return!==w.return)p=S,w=A;else{for(var G=!1,ie=S.child;ie;){if(ie===p){G=!0,p=S,w=A;break}if(ie===w){G=!0,w=S,p=A;break}ie=ie.sibling}if(!G){for(ie=A.child;ie;){if(ie===p){G=!0,p=A,w=S;break}if(ie===w){G=!0,w=A,p=S;break}ie=ie.sibling}if(!G)throw Error(t(189))}}if(p.alternate!==w)throw Error(t(190))}if(p.tag!==3)throw Error(t(188));return p.stateNode.current===p?c:d}function ve(c){return c=ye(c),c!==null?Ee(c):null}function Ee(c){if(c.tag===5||c.tag===6)return c;for(c=c.child;c!==null;){var d=Ee(c);if(d!==null)return d;c=c.sibling}return null}var Ke=e.unstable_scheduleCallback,tt=e.unstable_cancelCallback,gt=e.unstable_shouldYield,Ye=e.unstable_requestPaint,Xe=e.unstable_now,zt=e.unstable_getCurrentPriorityLevel,Mn=e.unstable_ImmediatePriority,jn=e.unstable_UserBlockingPriority,dr=e.unstable_NormalPriority,Na=e.unstable_LowPriority,aa=e.unstable_IdlePriority,Os=null,Nr=null;function tc(c){if(Nr&&typeof Nr.onCommitFiberRoot=="function")try{Nr.onCommitFiberRoot(Os,c,void 0,(c.current.flags&128)===128)}catch{}}var _r=Math.clz32?Math.clz32:Pu,go=Math.log,oa=Math.LN2;function Pu(c){return c>>>=0,c===0?32:31-(go(c)/oa|0)|0}var mo=64,nc=4194304;function In(c){switch(c&-c){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return c&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return c}}function sl(c,d){var p=c.pendingLanes;if(p===0)return 0;var w=0,S=c.suspendedLanes,A=c.pingedLanes,G=p&268435455;if(G!==0){var ie=G&~S;ie!==0?w=In(ie):(A&=G,A!==0&&(w=In(A)))}else G=p&~S,G!==0?w=In(G):A!==0&&(w=In(A));if(w===0)return 0;if(d!==0&&d!==w&&(d&S)===0&&(S=w&-w,A=d&-d,S>=A||S===16&&(A&4194240)!==0))return d;if((w&4)!==0&&(w|=p&16),d=c.entangledLanes,d!==0)for(c=c.entanglements,d&=w;0<d;)p=31-_r(d),S=1<<p,w|=c[p],d&=~S;return w}function Mu(c,d){switch(c){case 1:case 2:case 4:return d+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Nu(c,d){for(var p=c.suspendedLanes,w=c.pingedLanes,S=c.expirationTimes,A=c.pendingLanes;0<A;){var G=31-_r(A),ie=1<<G,ae=S[G];ae===-1?((ie&p)===0||(ie&w)!==0)&&(S[G]=Mu(ie,d)):ae<=d&&(c.expiredLanes|=ie),A&=~ie}}function Q0(c){return c=c.pendingLanes&-1073741825,c!==0?c:c&1073741824?1073741824:0}function J0(){var c=mo;return mo<<=1,(mo&4194240)===0&&(mo=64),c}function eg(c){for(var d=[],p=0;31>p;p++)d.push(c);return d}function Lu(c,d,p){c.pendingLanes|=d,d!==536870912&&(c.suspendedLanes=0,c.pingedLanes=0),c=c.eventTimes,d=31-_r(d),c[d]=p}function Zw(c,d){var p=c.pendingLanes&~d;c.pendingLanes=d,c.suspendedLanes=0,c.pingedLanes=0,c.expiredLanes&=d,c.mutableReadLanes&=d,c.entangledLanes&=d,d=c.entanglements;var w=c.eventTimes;for(c=c.expirationTimes;0<p;){var S=31-_r(p),A=1<<S;d[S]=0,w[S]=-1,c[S]=-1,p&=~A}}function tg(c,d){var p=c.entangledLanes|=d;for(c=c.entanglements;p;){var w=31-_r(p),S=1<<w;S&d|c[w]&d&&(c[w]|=d),p&=~S}}var gn=0;function po(c){return c&=-c,1<c?4<c?(c&268435455)!==0?16:536870912:4:1}var ng,bd,rg,ig,sg,yo=!1,Id=[],_o=null,xo=null,_i=null,Ou=new Map,al=new Map,Ds=[],D1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function rc(c,d){switch(c){case"focusin":case"focusout":_o=null;break;case"dragenter":case"dragleave":xo=null;break;case"mouseover":case"mouseout":_i=null;break;case"pointerover":case"pointerout":Ou.delete(d.pointerId);break;case"gotpointercapture":case"lostpointercapture":al.delete(d.pointerId)}}function La(c,d,p,w,S,A){return c===null||c.nativeEvent!==A?(c={blockedOn:d,domEventName:p,eventSystemFlags:w,nativeEvent:A,targetContainers:[S]},d!==null&&(d=xg(d),d!==null&&bd(d)),c):(c.eventSystemFlags|=w,d=c.targetContainers,S!==null&&d.indexOf(S)===-1&&d.push(S),c)}function F1(c,d,p,w,S){switch(d){case"focusin":return _o=La(_o,c,d,p,w,S),!0;case"dragenter":return xo=La(xo,c,d,p,w,S),!0;case"mouseover":return _i=La(_i,c,d,p,w,S),!0;case"pointerover":var A=S.pointerId;return Ou.set(A,La(Ou.get(A)||null,c,d,p,w,S)),!0;case"gotpointercapture":return A=S.pointerId,al.set(A,La(al.get(A)||null,c,d,p,w,S)),!0}return!1}function Ad(c){var d=Vu(c.target);if(d!==null){var p=te(d);if(p!==null){if(d=p.tag,d===13){if(d=_e(p),d!==null){c.blockedOn=d,sg(c.priority,function(){rg(p)});return}}else if(d===3&&p.stateNode.current.memoizedState.isDehydrated){c.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}c.blockedOn=null}function Jn(c){if(c.blockedOn!==null)return!1;for(var d=c.targetContainers;0<d.length;){var p=Rd(c.domEventName,c.eventSystemFlags,d[0],c.nativeEvent);if(p===null){p=c.nativeEvent;var w=new p.constructor(p.type,p);Pt=w,p.target.dispatchEvent(w),Pt=null}else return d=xg(p),d!==null&&bd(d),c.blockedOn=p,!1;d.shift()}return!0}function j1(c,d,p){Jn(c)&&p.delete(d)}function Qw(){yo=!1,_o!==null&&Jn(_o)&&(_o=null),xo!==null&&Jn(xo)&&(xo=null),_i!==null&&Jn(_i)&&(_i=null),Ou.forEach(j1),al.forEach(j1)}function ic(c,d){c.blockedOn===d&&(c.blockedOn=null,yo||(yo=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Qw)))}function sc(c){function d(S){return ic(S,c)}if(0<Id.length){ic(Id[0],c);for(var p=1;p<Id.length;p++){var w=Id[p];w.blockedOn===c&&(w.blockedOn=null)}}for(_o!==null&&ic(_o,c),xo!==null&&ic(xo,c),_i!==null&&ic(_i,c),Ou.forEach(d),al.forEach(d),p=0;p<Ds.length;p++)w=Ds[p],w.blockedOn===c&&(w.blockedOn=null);for(;0<Ds.length&&(p=Ds[0],p.blockedOn===null);)Ad(p),p.blockedOn===null&&Ds.shift()}var ol=M.ReactCurrentBatchConfig,ll=!0;function vo(c,d,p,w){var S=gn,A=ol.transition;ol.transition=null;try{gn=1,ag(c,d,p,w)}finally{gn=S,ol.transition=A}}function V1(c,d,p,w){var S=gn,A=ol.transition;ol.transition=null;try{gn=4,ag(c,d,p,w)}finally{gn=S,ol.transition=A}}function ag(c,d,p,w){if(ll){var S=Rd(c,d,p,w);if(S===null)cE(c,d,w,wo,p),rc(c,w);else if(F1(S,c,d,p,w))w.stopPropagation();else if(rc(c,w),d&4&&-1<D1.indexOf(c)){for(;S!==null;){var A=xg(S);if(A!==null&&ng(A),A=Rd(c,d,p,w),A===null&&cE(c,d,w,wo,p),A===S)break;S=A}S!==null&&w.stopPropagation()}else cE(c,d,w,null,p)}}var wo=null;function Rd(c,d,p,w){if(wo=null,c=W(w),c=Vu(c),c!==null)if(d=te(c),d===null)c=null;else if(p=d.tag,p===13){if(c=_e(d),c!==null)return c;c=null}else if(p===3){if(d.stateNode.current.memoizedState.isDehydrated)return d.tag===3?d.stateNode.containerInfo:null;c=null}else d!==c&&(c=null);return wo=c,null}function Cd(c){switch(c){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(zt()){case Mn:return 1;case jn:return 4;case dr:case Na:return 16;case aa:return 536870912;default:return 16}default:return 16}}var Fs=null,kd=null,cl=null;function G1(){if(cl)return cl;var c,d=kd,p=d.length,w,S="value"in Fs?Fs.value:Fs.textContent,A=S.length;for(c=0;c<p&&d[c]===S[c];c++);var G=p-c;for(w=1;w<=G&&d[p-w]===S[A-w];w++);return cl=S.slice(c,1<w?1-w:void 0)}function Du(c){var d=c.keyCode;return"charCode"in c?(c=c.charCode,c===0&&d===13&&(c=13)):c=d,c===10&&(c=13),32<=c||c===13?c:0}function Eo(){return!0}function og(){return!1}function Oi(c){function d(p,w,S,A,G){this._reactName=p,this._targetInst=S,this.type=w,this.nativeEvent=A,this.target=G,this.currentTarget=null;for(var ie in c)c.hasOwnProperty(ie)&&(p=c[ie],this[ie]=p?p(A):A[ie]);return this.isDefaultPrevented=(A.defaultPrevented!=null?A.defaultPrevented:A.returnValue===!1)?Eo:og,this.isPropagationStopped=og,this}return Se(d.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=Eo)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=Eo)},persist:function(){},isPersistent:Eo}),d}var So={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(c){return c.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Fu=Oi(So),ac=Se({},So,{view:0,detail:0}),Pd=Oi(ac),Md,Nd,js,ju=Se({},ac,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Zt,button:0,buttons:0,relatedTarget:function(c){return c.relatedTarget===void 0?c.fromElement===c.srcElement?c.toElement:c.fromElement:c.relatedTarget},movementX:function(c){return"movementX"in c?c.movementX:(c!==js&&(js&&c.type==="mousemove"?(Md=c.screenX-js.screenX,Nd=c.screenY-js.screenY):Nd=Md=0,js=c),Md)},movementY:function(c){return"movementY"in c?c.movementY:Nd}}),lg=Oi(ju),B1=Se({},ju,{dataTransfer:0}),U1=Oi(B1),Ld=Se({},ac,{relatedTarget:0}),xi=Oi(Ld),z1=Se({},So,{animationName:0,elapsedTime:0,pseudoElement:0}),$1=Oi(z1),oc=Se({},So,{clipboardData:function(c){return"clipboardData"in c?c.clipboardData:window.clipboardData}}),_=Oi(oc),R=Se({},So,{data:0}),D=Oi(R),H={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},me={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ae={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function it(c){var d=this.nativeEvent;return d.getModifierState?d.getModifierState(c):(c=Ae[c])?!!d[c]:!1}function Zt(){return it}var Lr=Se({},ac,{key:function(c){if(c.key){var d=H[c.key]||c.key;if(d!=="Unidentified")return d}return c.type==="keypress"?(c=Du(c),c===13?"Enter":String.fromCharCode(c)):c.type==="keydown"||c.type==="keyup"?me[c.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Zt,charCode:function(c){return c.type==="keypress"?Du(c):0},keyCode:function(c){return c.type==="keydown"||c.type==="keyup"?c.keyCode:0},which:function(c){return c.type==="keypress"?Du(c):c.type==="keydown"||c.type==="keyup"?c.keyCode:0}}),Vn=Oi(Lr),Br=Se({},ju,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Vs=Oi(Br),ul=Se({},ac,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Zt}),To=Oi(ul),bo=Se({},So,{propertyName:0,elapsedTime:0,pseudoElement:0}),Od=Oi(bo),cg=Se({},ju,{deltaX:function(c){return"deltaX"in c?c.deltaX:"wheelDeltaX"in c?-c.wheelDeltaX:0},deltaY:function(c){return"deltaY"in c?c.deltaY:"wheelDeltaY"in c?-c.wheelDeltaY:"wheelDelta"in c?-c.wheelDelta:0},deltaZ:0,deltaMode:0}),EG=Oi(cg),SG=[9,13,27,32],Jw=o&&"CompositionEvent"in window,ug=null;o&&"documentMode"in document&&(ug=document.documentMode);var TG=o&&"TextEvent"in window&&!ug,pC=o&&(!Jw||ug&&8<ug&&11>=ug),yC=" ",_C=!1;function xC(c,d){switch(c){case"keyup":return SG.indexOf(d.keyCode)!==-1;case"keydown":return d.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function vC(c){return c=c.detail,typeof c=="object"&&"data"in c?c.data:null}var Dd=!1;function bG(c,d){switch(c){case"compositionend":return vC(d);case"keypress":return d.which!==32?null:(_C=!0,yC);case"textInput":return c=d.data,c===yC&&_C?null:c;default:return null}}function IG(c,d){if(Dd)return c==="compositionend"||!Jw&&xC(c,d)?(c=G1(),cl=kd=Fs=null,Dd=!1,c):null;switch(c){case"paste":return null;case"keypress":if(!(d.ctrlKey||d.altKey||d.metaKey)||d.ctrlKey&&d.altKey){if(d.char&&1<d.char.length)return d.char;if(d.which)return String.fromCharCode(d.which)}return null;case"compositionend":return pC&&d.locale!=="ko"?null:d.data;default:return null}}var AG={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function wC(c){var d=c&&c.nodeName&&c.nodeName.toLowerCase();return d==="input"?!!AG[c.type]:d==="textarea"}function EC(c,d,p,w){Ve(w),d=X1(d,"onChange"),0<d.length&&(p=new Fu("onChange","change",null,p,w),c.push({event:p,listeners:d}))}var hg=null,dg=null;function RG(c){GC(c,0)}function W1(c){var d=Bd(c);if(Kt(d))return c}function CG(c,d){if(c==="change")return d}var SC=!1;if(o){var eE;if(o){var tE="oninput"in document;if(!tE){var TC=document.createElement("div");TC.setAttribute("oninput","return;"),tE=typeof TC.oninput=="function"}eE=tE}else eE=!1;SC=eE&&(!document.documentMode||9<document.documentMode)}function bC(){hg&&(hg.detachEvent("onpropertychange",IC),dg=hg=null)}function IC(c){if(c.propertyName==="value"&&W1(dg)){var d=[];EC(d,dg,c,W(c)),St(RG,d)}}function kG(c,d,p){c==="focusin"?(bC(),hg=d,dg=p,hg.attachEvent("onpropertychange",IC)):c==="focusout"&&bC()}function PG(c){if(c==="selectionchange"||c==="keyup"||c==="keydown")return W1(dg)}function MG(c,d){if(c==="click")return W1(d)}function NG(c,d){if(c==="input"||c==="change")return W1(d)}function LG(c,d){return c===d&&(c!==0||1/c===1/d)||c!==c&&d!==d}var Oa=typeof Object.is=="function"?Object.is:LG;function fg(c,d){if(Oa(c,d))return!0;if(typeof c!="object"||c===null||typeof d!="object"||d===null)return!1;var p=Object.keys(c),w=Object.keys(d);if(p.length!==w.length)return!1;for(w=0;w<p.length;w++){var S=p[w];if(!l.call(d,S)||!Oa(c[S],d[S]))return!1}return!0}function AC(c){for(;c&&c.firstChild;)c=c.firstChild;return c}function RC(c,d){var p=AC(c);c=0;for(var w;p;){if(p.nodeType===3){if(w=c+p.textContent.length,c<=d&&w>=d)return{node:p,offset:d-c};c=w}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=AC(p)}}function CC(c,d){return c&&d?c===d?!0:c&&c.nodeType===3?!1:d&&d.nodeType===3?CC(c,d.parentNode):"contains"in c?c.contains(d):c.compareDocumentPosition?!!(c.compareDocumentPosition(d)&16):!1:!1}function kC(){for(var c=window,d=wn();d instanceof c.HTMLIFrameElement;){try{var p=typeof d.contentWindow.location.href=="string"}catch{p=!1}if(p)c=d.contentWindow;else break;d=wn(c.document)}return d}function nE(c){var d=c&&c.nodeName&&c.nodeName.toLowerCase();return d&&(d==="input"&&(c.type==="text"||c.type==="search"||c.type==="tel"||c.type==="url"||c.type==="password")||d==="textarea"||c.contentEditable==="true")}function OG(c){var d=kC(),p=c.focusedElem,w=c.selectionRange;if(d!==p&&p&&p.ownerDocument&&CC(p.ownerDocument.documentElement,p)){if(w!==null&&nE(p)){if(d=w.start,c=w.end,c===void 0&&(c=d),"selectionStart"in p)p.selectionStart=d,p.selectionEnd=Math.min(c,p.value.length);else if(c=(d=p.ownerDocument||document)&&d.defaultView||window,c.getSelection){c=c.getSelection();var S=p.textContent.length,A=Math.min(w.start,S);w=w.end===void 0?A:Math.min(w.end,S),!c.extend&&A>w&&(S=w,w=A,A=S),S=RC(p,A);var G=RC(p,w);S&&G&&(c.rangeCount!==1||c.anchorNode!==S.node||c.anchorOffset!==S.offset||c.focusNode!==G.node||c.focusOffset!==G.offset)&&(d=d.createRange(),d.setStart(S.node,S.offset),c.removeAllRanges(),A>w?(c.addRange(d),c.extend(G.node,G.offset)):(d.setEnd(G.node,G.offset),c.addRange(d)))}}for(d=[],c=p;c=c.parentNode;)c.nodeType===1&&d.push({element:c,left:c.scrollLeft,top:c.scrollTop});for(typeof p.focus=="function"&&p.focus(),p=0;p<d.length;p++)c=d[p],c.element.scrollLeft=c.left,c.element.scrollTop=c.top}}var DG=o&&"documentMode"in document&&11>=document.documentMode,Fd=null,rE=null,gg=null,iE=!1;function PC(c,d,p){var w=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;iE||Fd==null||Fd!==wn(w)||(w=Fd,"selectionStart"in w&&nE(w)?w={start:w.selectionStart,end:w.selectionEnd}:(w=(w.ownerDocument&&w.ownerDocument.defaultView||window).getSelection(),w={anchorNode:w.anchorNode,anchorOffset:w.anchorOffset,focusNode:w.focusNode,focusOffset:w.focusOffset}),gg&&fg(gg,w)||(gg=w,w=X1(rE,"onSelect"),0<w.length&&(d=new Fu("onSelect","select",null,d,p),c.push({event:d,listeners:w}),d.target=Fd)))}function H1(c,d){var p={};return p[c.toLowerCase()]=d.toLowerCase(),p["Webkit"+c]="webkit"+d,p["Moz"+c]="moz"+d,p}var jd={animationend:H1("Animation","AnimationEnd"),animationiteration:H1("Animation","AnimationIteration"),animationstart:H1("Animation","AnimationStart"),transitionend:H1("Transition","TransitionEnd")},sE={},MC={};o&&(MC=document.createElement("div").style,"AnimationEvent"in window||(delete jd.animationend.animation,delete jd.animationiteration.animation,delete jd.animationstart.animation),"TransitionEvent"in window||delete jd.transitionend.transition);function K1(c){if(sE[c])return sE[c];if(!jd[c])return c;var d=jd[c],p;for(p in d)if(d.hasOwnProperty(p)&&p in MC)return sE[c]=d[p];return c}var NC=K1("animationend"),LC=K1("animationiteration"),OC=K1("animationstart"),DC=K1("transitionend"),FC=new Map,jC="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function lc(c,d){FC.set(c,d),s(d,[c])}for(var aE=0;aE<jC.length;aE++){var oE=jC[aE],FG=oE.toLowerCase(),jG=oE[0].toUpperCase()+oE.slice(1);lc(FG,"on"+jG)}lc(NC,"onAnimationEnd"),lc(LC,"onAnimationIteration"),lc(OC,"onAnimationStart"),lc("dblclick","onDoubleClick"),lc("focusin","onFocus"),lc("focusout","onBlur"),lc(DC,"onTransitionEnd"),a("onMouseEnter",["mouseout","mouseover"]),a("onMouseLeave",["mouseout","mouseover"]),a("onPointerEnter",["pointerout","pointerover"]),a("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var mg="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),VG=new Set("cancel close invalid load scroll toggle".split(" ").concat(mg));function VC(c,d,p){var w=c.type||"unknown-event";c.currentTarget=p,ee(w,d,void 0,c),c.currentTarget=null}function GC(c,d){d=(d&4)!==0;for(var p=0;p<c.length;p++){var w=c[p],S=w.event;w=w.listeners;e:{var A=void 0;if(d)for(var G=w.length-1;0<=G;G--){var ie=w[G],ae=ie.instance,Ie=ie.currentTarget;if(ie=ie.listener,ae!==A&&S.isPropagationStopped())break e;VC(S,ie,Ie),A=ae}else for(G=0;G<w.length;G++){if(ie=w[G],ae=ie.instance,Ie=ie.currentTarget,ie=ie.listener,ae!==A&&S.isPropagationStopped())break e;VC(S,ie,Ie),A=ae}}}if(B)throw c=Q,B=!1,Q=null,c}function ir(c,d){var p=d[mE];p===void 0&&(p=d[mE]=new Set);var w=c+"__bubble";p.has(w)||(BC(d,c,2,!1),p.add(w))}function lE(c,d,p){var w=0;d&&(w|=4),BC(p,c,w,d)}var Y1="_reactListening"+Math.random().toString(36).slice(2);function pg(c){if(!c[Y1]){c[Y1]=!0,r.forEach(function(p){p!=="selectionchange"&&(VG.has(p)||lE(p,!1,c),lE(p,!0,c))});var d=c.nodeType===9?c:c.ownerDocument;d===null||d[Y1]||(d[Y1]=!0,lE("selectionchange",!1,d))}}function BC(c,d,p,w){switch(Cd(d)){case 1:var S=vo;break;case 4:S=V1;break;default:S=ag}p=S.bind(null,d,p,c),S=void 0,!ur||d!=="touchstart"&&d!=="touchmove"&&d!=="wheel"||(S=!0),w?S!==void 0?c.addEventListener(d,p,{capture:!0,passive:S}):c.addEventListener(d,p,!0):S!==void 0?c.addEventListener(d,p,{passive:S}):c.addEventListener(d,p,!1)}function cE(c,d,p,w,S){var A=w;if((d&1)===0&&(d&2)===0&&w!==null)e:for(;;){if(w===null)return;var G=w.tag;if(G===3||G===4){var ie=w.stateNode.containerInfo;if(ie===S||ie.nodeType===8&&ie.parentNode===S)break;if(G===4)for(G=w.return;G!==null;){var ae=G.tag;if((ae===3||ae===4)&&(ae=G.stateNode.containerInfo,ae===S||ae.nodeType===8&&ae.parentNode===S))return;G=G.return}for(;ie!==null;){if(G=Vu(ie),G===null)return;if(ae=G.tag,ae===5||ae===6){w=A=G;continue e}ie=ie.parentNode}}w=w.return}St(function(){var Ie=A,He=W(p),qe=[];e:{var ze=FC.get(c);if(ze!==void 0){var yt=Fu,wt=c;switch(c){case"keypress":if(Du(p)===0)break e;case"keydown":case"keyup":yt=Vn;break;case"focusin":wt="focus",yt=xi;break;case"focusout":wt="blur",yt=xi;break;case"beforeblur":case"afterblur":yt=xi;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":yt=lg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":yt=U1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":yt=To;break;case NC:case LC:case OC:yt=$1;break;case DC:yt=Od;break;case"scroll":yt=Pd;break;case"wheel":yt=EG;break;case"copy":case"cut":case"paste":yt=_;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":yt=Vs}var Tt=(d&4)!==0,Or=!Tt&&c==="scroll",ge=Tt?ze!==null?ze+"Capture":null:ze;Tt=[];for(var oe=Ie,xe;oe!==null;){xe=oe;var Je=xe.stateNode;if(xe.tag===5&&Je!==null&&(xe=Je,ge!==null&&(Je=sn(oe,ge),Je!=null&&Tt.push(yg(oe,Je,xe)))),Or)break;oe=oe.return}0<Tt.length&&(ze=new yt(ze,wt,null,p,He),qe.push({event:ze,listeners:Tt}))}}if((d&7)===0){e:{if(ze=c==="mouseover"||c==="pointerover",yt=c==="mouseout"||c==="pointerout",ze&&p!==Pt&&(wt=p.relatedTarget||p.fromElement)&&(Vu(wt)||wt[hl]))break e;if((yt||ze)&&(ze=He.window===He?He:(ze=He.ownerDocument)?ze.defaultView||ze.parentWindow:window,yt?(wt=p.relatedTarget||p.toElement,yt=Ie,wt=wt?Vu(wt):null,wt!==null&&(Or=te(wt),wt!==Or||wt.tag!==5&&wt.tag!==6)&&(wt=null)):(yt=null,wt=Ie),yt!==wt)){if(Tt=lg,Je="onMouseLeave",ge="onMouseEnter",oe="mouse",(c==="pointerout"||c==="pointerover")&&(Tt=Vs,Je="onPointerLeave",ge="onPointerEnter",oe="pointer"),Or=yt==null?ze:Bd(yt),xe=wt==null?ze:Bd(wt),ze=new Tt(Je,oe+"leave",yt,p,He),ze.target=Or,ze.relatedTarget=xe,Je=null,Vu(He)===Ie&&(Tt=new Tt(ge,oe+"enter",wt,p,He),Tt.target=xe,Tt.relatedTarget=Or,Je=Tt),Or=Je,yt&&wt)t:{for(Tt=yt,ge=wt,oe=0,xe=Tt;xe;xe=Vd(xe))oe++;for(xe=0,Je=ge;Je;Je=Vd(Je))xe++;for(;0<oe-xe;)Tt=Vd(Tt),oe--;for(;0<xe-oe;)ge=Vd(ge),xe--;for(;oe--;){if(Tt===ge||ge!==null&&Tt===ge.alternate)break t;Tt=Vd(Tt),ge=Vd(ge)}Tt=null}else Tt=null;yt!==null&&UC(qe,ze,yt,Tt,!1),wt!==null&&Or!==null&&UC(qe,Or,wt,Tt,!0)}}e:{if(ze=Ie?Bd(Ie):window,yt=ze.nodeName&&ze.nodeName.toLowerCase(),yt==="select"||yt==="input"&&ze.type==="file")var It=CG;else if(wC(ze))if(SC)It=NG;else{It=PG;var Ot=kG}else(yt=ze.nodeName)&&yt.toLowerCase()==="input"&&(ze.type==="checkbox"||ze.type==="radio")&&(It=MG);if(It&&(It=It(c,Ie))){EC(qe,It,p,He);break e}Ot&&Ot(c,ze,Ie),c==="focusout"&&(Ot=ze._wrapperState)&&Ot.controlled&&ze.type==="number"&&on(ze,"number",ze.value)}switch(Ot=Ie?Bd(Ie):window,c){case"focusin":(wC(Ot)||Ot.contentEditable==="true")&&(Fd=Ot,rE=Ie,gg=null);break;case"focusout":gg=rE=Fd=null;break;case"mousedown":iE=!0;break;case"contextmenu":case"mouseup":case"dragend":iE=!1,PC(qe,p,He);break;case"selectionchange":if(DG)break;case"keydown":case"keyup":PC(qe,p,He)}var Dt;if(Jw)e:{switch(c){case"compositionstart":var $t="onCompositionStart";break e;case"compositionend":$t="onCompositionEnd";break e;case"compositionupdate":$t="onCompositionUpdate";break e}$t=void 0}else Dd?xC(c,p)&&($t="onCompositionEnd"):c==="keydown"&&p.keyCode===229&&($t="onCompositionStart");$t&&(pC&&p.locale!=="ko"&&(Dd||$t!=="onCompositionStart"?$t==="onCompositionEnd"&&Dd&&(Dt=G1()):(Fs=He,kd="value"in Fs?Fs.value:Fs.textContent,Dd=!0)),Ot=X1(Ie,$t),0<Ot.length&&($t=new D($t,c,null,p,He),qe.push({event:$t,listeners:Ot}),Dt?$t.data=Dt:(Dt=vC(p),Dt!==null&&($t.data=Dt)))),(Dt=TG?bG(c,p):IG(c,p))&&(Ie=X1(Ie,"onBeforeInput"),0<Ie.length&&(He=new D("onBeforeInput","beforeinput",null,p,He),qe.push({event:He,listeners:Ie}),He.data=Dt))}GC(qe,d)})}function yg(c,d,p){return{instance:c,listener:d,currentTarget:p}}function X1(c,d){for(var p=d+"Capture",w=[];c!==null;){var S=c,A=S.stateNode;S.tag===5&&A!==null&&(S=A,A=sn(c,p),A!=null&&w.unshift(yg(c,A,S)),A=sn(c,d),A!=null&&w.push(yg(c,A,S))),c=c.return}return w}function Vd(c){if(c===null)return null;do c=c.return;while(c&&c.tag!==5);return c||null}function UC(c,d,p,w,S){for(var A=d._reactName,G=[];p!==null&&p!==w;){var ie=p,ae=ie.alternate,Ie=ie.stateNode;if(ae!==null&&ae===w)break;ie.tag===5&&Ie!==null&&(ie=Ie,S?(ae=sn(p,A),ae!=null&&G.unshift(yg(p,ae,ie))):S||(ae=sn(p,A),ae!=null&&G.push(yg(p,ae,ie)))),p=p.return}G.length!==0&&c.push({event:d,listeners:G})}var GG=/\r\n?/g,BG=/\u0000|\uFFFD/g;function zC(c){return(typeof c=="string"?c:""+c).replace(GG,`
`).replace(BG,"")}function q1(c,d,p){if(d=zC(d),zC(c)!==d&&p)throw Error(t(425))}function Z1(){}var uE=null,hE=null;function dE(c,d){return c==="textarea"||c==="noscript"||typeof d.children=="string"||typeof d.children=="number"||typeof d.dangerouslySetInnerHTML=="object"&&d.dangerouslySetInnerHTML!==null&&d.dangerouslySetInnerHTML.__html!=null}var fE=typeof setTimeout=="function"?setTimeout:void 0,UG=typeof clearTimeout=="function"?clearTimeout:void 0,$C=typeof Promise=="function"?Promise:void 0,zG=typeof queueMicrotask=="function"?queueMicrotask:typeof $C<"u"?function(c){return $C.resolve(null).then(c).catch($G)}:fE;function $G(c){setTimeout(function(){throw c})}function gE(c,d){var p=d,w=0;do{var S=p.nextSibling;if(c.removeChild(p),S&&S.nodeType===8)if(p=S.data,p==="/$"){if(w===0){c.removeChild(S),sc(d);return}w--}else p!=="$"&&p!=="$?"&&p!=="$!"||w++;p=S}while(p);sc(d)}function cc(c){for(;c!=null;c=c.nextSibling){var d=c.nodeType;if(d===1||d===3)break;if(d===8){if(d=c.data,d==="$"||d==="$!"||d==="$?")break;if(d==="/$")return null}}return c}function WC(c){c=c.previousSibling;for(var d=0;c;){if(c.nodeType===8){var p=c.data;if(p==="$"||p==="$!"||p==="$?"){if(d===0)return c;d--}else p==="/$"&&d++}c=c.previousSibling}return null}var Gd=Math.random().toString(36).slice(2),Io="__reactFiber$"+Gd,_g="__reactProps$"+Gd,hl="__reactContainer$"+Gd,mE="__reactEvents$"+Gd,WG="__reactListeners$"+Gd,HG="__reactHandles$"+Gd;function Vu(c){var d=c[Io];if(d)return d;for(var p=c.parentNode;p;){if(d=p[hl]||p[Io]){if(p=d.alternate,d.child!==null||p!==null&&p.child!==null)for(c=WC(c);c!==null;){if(p=c[Io])return p;c=WC(c)}return d}c=p,p=c.parentNode}return null}function xg(c){return c=c[Io]||c[hl],!c||c.tag!==5&&c.tag!==6&&c.tag!==13&&c.tag!==3?null:c}function Bd(c){if(c.tag===5||c.tag===6)return c.stateNode;throw Error(t(33))}function Q1(c){return c[_g]||null}var pE=[],Ud=-1;function uc(c){return{current:c}}function sr(c){0>Ud||(c.current=pE[Ud],pE[Ud]=null,Ud--)}function tr(c,d){Ud++,pE[Ud]=c.current,c.current=d}var hc={},Di=uc(hc),fs=uc(!1),Gu=hc;function zd(c,d){var p=c.type.contextTypes;if(!p)return hc;var w=c.stateNode;if(w&&w.__reactInternalMemoizedUnmaskedChildContext===d)return w.__reactInternalMemoizedMaskedChildContext;var S={},A;for(A in p)S[A]=d[A];return w&&(c=c.stateNode,c.__reactInternalMemoizedUnmaskedChildContext=d,c.__reactInternalMemoizedMaskedChildContext=S),S}function gs(c){return c=c.childContextTypes,c!=null}function J1(){sr(fs),sr(Di)}function HC(c,d,p){if(Di.current!==hc)throw Error(t(168));tr(Di,d),tr(fs,p)}function KC(c,d,p){var w=c.stateNode;if(d=d.childContextTypes,typeof w.getChildContext!="function")return p;w=w.getChildContext();for(var S in w)if(!(S in d))throw Error(t(108,Me(c)||"Unknown",S));return Se({},p,w)}function ey(c){return c=(c=c.stateNode)&&c.__reactInternalMemoizedMergedChildContext||hc,Gu=Di.current,tr(Di,c),tr(fs,fs.current),!0}function YC(c,d,p){var w=c.stateNode;if(!w)throw Error(t(169));p?(c=KC(c,d,Gu),w.__reactInternalMemoizedMergedChildContext=c,sr(fs),sr(Di),tr(Di,c)):sr(fs),tr(fs,p)}var dl=null,ty=!1,yE=!1;function XC(c){dl===null?dl=[c]:dl.push(c)}function KG(c){ty=!0,XC(c)}function dc(){if(!yE&&dl!==null){yE=!0;var c=0,d=gn;try{var p=dl;for(gn=1;c<p.length;c++){var w=p[c];do w=w(!0);while(w!==null)}dl=null,ty=!1}catch(S){throw dl!==null&&(dl=dl.slice(c+1)),Ke(Mn,dc),S}finally{gn=d,yE=!1}}return null}var $d=[],Wd=0,ny=null,ry=0,la=[],ca=0,Bu=null,fl=1,gl="";function Uu(c,d){$d[Wd++]=ry,$d[Wd++]=ny,ny=c,ry=d}function qC(c,d,p){la[ca++]=fl,la[ca++]=gl,la[ca++]=Bu,Bu=c;var w=fl;c=gl;var S=32-_r(w)-1;w&=~(1<<S),p+=1;var A=32-_r(d)+S;if(30<A){var G=S-S%5;A=(w&(1<<G)-1).toString(32),w>>=G,S-=G,fl=1<<32-_r(d)+S|p<<S|w,gl=A+c}else fl=1<<A|p<<S|w,gl=c}function _E(c){c.return!==null&&(Uu(c,1),qC(c,1,0))}function xE(c){for(;c===ny;)ny=$d[--Wd],$d[Wd]=null,ry=$d[--Wd],$d[Wd]=null;for(;c===Bu;)Bu=la[--ca],la[ca]=null,gl=la[--ca],la[ca]=null,fl=la[--ca],la[ca]=null}var Gs=null,Bs=null,fr=!1,Da=null;function ZC(c,d){var p=fa(5,null,null,0);p.elementType="DELETED",p.stateNode=d,p.return=c,d=c.deletions,d===null?(c.deletions=[p],c.flags|=16):d.push(p)}function QC(c,d){switch(c.tag){case 5:var p=c.type;return d=d.nodeType!==1||p.toLowerCase()!==d.nodeName.toLowerCase()?null:d,d!==null?(c.stateNode=d,Gs=c,Bs=cc(d.firstChild),!0):!1;case 6:return d=c.pendingProps===""||d.nodeType!==3?null:d,d!==null?(c.stateNode=d,Gs=c,Bs=null,!0):!1;case 13:return d=d.nodeType!==8?null:d,d!==null?(p=Bu!==null?{id:fl,overflow:gl}:null,c.memoizedState={dehydrated:d,treeContext:p,retryLane:1073741824},p=fa(18,null,null,0),p.stateNode=d,p.return=c,c.child=p,Gs=c,Bs=null,!0):!1;default:return!1}}function vE(c){return(c.mode&1)!==0&&(c.flags&128)===0}function wE(c){if(fr){var d=Bs;if(d){var p=d;if(!QC(c,d)){if(vE(c))throw Error(t(418));d=cc(p.nextSibling);var w=Gs;d&&QC(c,d)?ZC(w,p):(c.flags=c.flags&-4097|2,fr=!1,Gs=c)}}else{if(vE(c))throw Error(t(418));c.flags=c.flags&-4097|2,fr=!1,Gs=c}}}function JC(c){for(c=c.return;c!==null&&c.tag!==5&&c.tag!==3&&c.tag!==13;)c=c.return;Gs=c}function iy(c){if(c!==Gs)return!1;if(!fr)return JC(c),fr=!0,!1;var d;if((d=c.tag!==3)&&!(d=c.tag!==5)&&(d=c.type,d=d!=="head"&&d!=="body"&&!dE(c.type,c.memoizedProps)),d&&(d=Bs)){if(vE(c))throw ek(),Error(t(418));for(;d;)ZC(c,d),d=cc(d.nextSibling)}if(JC(c),c.tag===13){if(c=c.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(t(317));e:{for(c=c.nextSibling,d=0;c;){if(c.nodeType===8){var p=c.data;if(p==="/$"){if(d===0){Bs=cc(c.nextSibling);break e}d--}else p!=="$"&&p!=="$!"&&p!=="$?"||d++}c=c.nextSibling}Bs=null}}else Bs=Gs?cc(c.stateNode.nextSibling):null;return!0}function ek(){for(var c=Bs;c;)c=cc(c.nextSibling)}function Hd(){Bs=Gs=null,fr=!1}function EE(c){Da===null?Da=[c]:Da.push(c)}var YG=M.ReactCurrentBatchConfig;function vg(c,d,p){if(c=p.ref,c!==null&&typeof c!="function"&&typeof c!="object"){if(p._owner){if(p=p._owner,p){if(p.tag!==1)throw Error(t(309));var w=p.stateNode}if(!w)throw Error(t(147,c));var S=w,A=""+c;return d!==null&&d.ref!==null&&typeof d.ref=="function"&&d.ref._stringRef===A?d.ref:(d=function(G){var ie=S.refs;G===null?delete ie[A]:ie[A]=G},d._stringRef=A,d)}if(typeof c!="string")throw Error(t(284));if(!p._owner)throw Error(t(290,c))}return c}function sy(c,d){throw c=Object.prototype.toString.call(d),Error(t(31,c==="[object Object]"?"object with keys {"+Object.keys(d).join(", ")+"}":c))}function tk(c){var d=c._init;return d(c._payload)}function nk(c){function d(ge,oe){if(c){var xe=ge.deletions;xe===null?(ge.deletions=[oe],ge.flags|=16):xe.push(oe)}}function p(ge,oe){if(!c)return null;for(;oe!==null;)d(ge,oe),oe=oe.sibling;return null}function w(ge,oe){for(ge=new Map;oe!==null;)oe.key!==null?ge.set(oe.key,oe):ge.set(oe.index,oe),oe=oe.sibling;return ge}function S(ge,oe){return ge=vc(ge,oe),ge.index=0,ge.sibling=null,ge}function A(ge,oe,xe){return ge.index=xe,c?(xe=ge.alternate,xe!==null?(xe=xe.index,xe<oe?(ge.flags|=2,oe):xe):(ge.flags|=2,oe)):(ge.flags|=1048576,oe)}function G(ge){return c&&ge.alternate===null&&(ge.flags|=2),ge}function ie(ge,oe,xe,Je){return oe===null||oe.tag!==6?(oe=f2(xe,ge.mode,Je),oe.return=ge,oe):(oe=S(oe,xe),oe.return=ge,oe)}function ae(ge,oe,xe,Je){var It=xe.type;return It===P?He(ge,oe,xe.props.children,Je,xe.key):oe!==null&&(oe.elementType===It||typeof It=="object"&&It!==null&&It.$$typeof===Ue&&tk(It)===oe.type)?(Je=S(oe,xe.props),Je.ref=vg(ge,oe,xe),Je.return=ge,Je):(Je=Cy(xe.type,xe.key,xe.props,null,ge.mode,Je),Je.ref=vg(ge,oe,xe),Je.return=ge,Je)}function Ie(ge,oe,xe,Je){return oe===null||oe.tag!==4||oe.stateNode.containerInfo!==xe.containerInfo||oe.stateNode.implementation!==xe.implementation?(oe=g2(xe,ge.mode,Je),oe.return=ge,oe):(oe=S(oe,xe.children||[]),oe.return=ge,oe)}function He(ge,oe,xe,Je,It){return oe===null||oe.tag!==7?(oe=qu(xe,ge.mode,Je,It),oe.return=ge,oe):(oe=S(oe,xe),oe.return=ge,oe)}function qe(ge,oe,xe){if(typeof oe=="string"&&oe!==""||typeof oe=="number")return oe=f2(""+oe,ge.mode,xe),oe.return=ge,oe;if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case F:return xe=Cy(oe.type,oe.key,oe.props,null,ge.mode,xe),xe.ref=vg(ge,null,oe),xe.return=ge,xe;case z:return oe=g2(oe,ge.mode,xe),oe.return=ge,oe;case Ue:var Je=oe._init;return qe(ge,Je(oe._payload),xe)}if(en(oe)||ue(oe))return oe=qu(oe,ge.mode,xe,null),oe.return=ge,oe;sy(ge,oe)}return null}function ze(ge,oe,xe,Je){var It=oe!==null?oe.key:null;if(typeof xe=="string"&&xe!==""||typeof xe=="number")return It!==null?null:ie(ge,oe,""+xe,Je);if(typeof xe=="object"&&xe!==null){switch(xe.$$typeof){case F:return xe.key===It?ae(ge,oe,xe,Je):null;case z:return xe.key===It?Ie(ge,oe,xe,Je):null;case Ue:return It=xe._init,ze(ge,oe,It(xe._payload),Je)}if(en(xe)||ue(xe))return It!==null?null:He(ge,oe,xe,Je,null);sy(ge,xe)}return null}function yt(ge,oe,xe,Je,It){if(typeof Je=="string"&&Je!==""||typeof Je=="number")return ge=ge.get(xe)||null,ie(oe,ge,""+Je,It);if(typeof Je=="object"&&Je!==null){switch(Je.$$typeof){case F:return ge=ge.get(Je.key===null?xe:Je.key)||null,ae(oe,ge,Je,It);case z:return ge=ge.get(Je.key===null?xe:Je.key)||null,Ie(oe,ge,Je,It);case Ue:var Ot=Je._init;return yt(ge,oe,xe,Ot(Je._payload),It)}if(en(Je)||ue(Je))return ge=ge.get(xe)||null,He(oe,ge,Je,It,null);sy(oe,Je)}return null}function wt(ge,oe,xe,Je){for(var It=null,Ot=null,Dt=oe,$t=oe=0,ci=null;Dt!==null&&$t<xe.length;$t++){Dt.index>$t?(ci=Dt,Dt=null):ci=Dt.sibling;var En=ze(ge,Dt,xe[$t],Je);if(En===null){Dt===null&&(Dt=ci);break}c&&Dt&&En.alternate===null&&d(ge,Dt),oe=A(En,oe,$t),Ot===null?It=En:Ot.sibling=En,Ot=En,Dt=ci}if($t===xe.length)return p(ge,Dt),fr&&Uu(ge,$t),It;if(Dt===null){for(;$t<xe.length;$t++)Dt=qe(ge,xe[$t],Je),Dt!==null&&(oe=A(Dt,oe,$t),Ot===null?It=Dt:Ot.sibling=Dt,Ot=Dt);return fr&&Uu(ge,$t),It}for(Dt=w(ge,Dt);$t<xe.length;$t++)ci=yt(Dt,ge,$t,xe[$t],Je),ci!==null&&(c&&ci.alternate!==null&&Dt.delete(ci.key===null?$t:ci.key),oe=A(ci,oe,$t),Ot===null?It=ci:Ot.sibling=ci,Ot=ci);return c&&Dt.forEach(function(wc){return d(ge,wc)}),fr&&Uu(ge,$t),It}function Tt(ge,oe,xe,Je){var It=ue(xe);if(typeof It!="function")throw Error(t(150));if(xe=It.call(xe),xe==null)throw Error(t(151));for(var Ot=It=null,Dt=oe,$t=oe=0,ci=null,En=xe.next();Dt!==null&&!En.done;$t++,En=xe.next()){Dt.index>$t?(ci=Dt,Dt=null):ci=Dt.sibling;var wc=ze(ge,Dt,En.value,Je);if(wc===null){Dt===null&&(Dt=ci);break}c&&Dt&&wc.alternate===null&&d(ge,Dt),oe=A(wc,oe,$t),Ot===null?It=wc:Ot.sibling=wc,Ot=wc,Dt=ci}if(En.done)return p(ge,Dt),fr&&Uu(ge,$t),It;if(Dt===null){for(;!En.done;$t++,En=xe.next())En=qe(ge,En.value,Je),En!==null&&(oe=A(En,oe,$t),Ot===null?It=En:Ot.sibling=En,Ot=En);return fr&&Uu(ge,$t),It}for(Dt=w(ge,Dt);!En.done;$t++,En=xe.next())En=yt(Dt,ge,$t,En.value,Je),En!==null&&(c&&En.alternate!==null&&Dt.delete(En.key===null?$t:En.key),oe=A(En,oe,$t),Ot===null?It=En:Ot.sibling=En,Ot=En);return c&&Dt.forEach(function(AB){return d(ge,AB)}),fr&&Uu(ge,$t),It}function Or(ge,oe,xe,Je){if(typeof xe=="object"&&xe!==null&&xe.type===P&&xe.key===null&&(xe=xe.props.children),typeof xe=="object"&&xe!==null){switch(xe.$$typeof){case F:e:{for(var It=xe.key,Ot=oe;Ot!==null;){if(Ot.key===It){if(It=xe.type,It===P){if(Ot.tag===7){p(ge,Ot.sibling),oe=S(Ot,xe.props.children),oe.return=ge,ge=oe;break e}}else if(Ot.elementType===It||typeof It=="object"&&It!==null&&It.$$typeof===Ue&&tk(It)===Ot.type){p(ge,Ot.sibling),oe=S(Ot,xe.props),oe.ref=vg(ge,Ot,xe),oe.return=ge,ge=oe;break e}p(ge,Ot);break}else d(ge,Ot);Ot=Ot.sibling}xe.type===P?(oe=qu(xe.props.children,ge.mode,Je,xe.key),oe.return=ge,ge=oe):(Je=Cy(xe.type,xe.key,xe.props,null,ge.mode,Je),Je.ref=vg(ge,oe,xe),Je.return=ge,ge=Je)}return G(ge);case z:e:{for(Ot=xe.key;oe!==null;){if(oe.key===Ot)if(oe.tag===4&&oe.stateNode.containerInfo===xe.containerInfo&&oe.stateNode.implementation===xe.implementation){p(ge,oe.sibling),oe=S(oe,xe.children||[]),oe.return=ge,ge=oe;break e}else{p(ge,oe);break}else d(ge,oe);oe=oe.sibling}oe=g2(xe,ge.mode,Je),oe.return=ge,ge=oe}return G(ge);case Ue:return Ot=xe._init,Or(ge,oe,Ot(xe._payload),Je)}if(en(xe))return wt(ge,oe,xe,Je);if(ue(xe))return Tt(ge,oe,xe,Je);sy(ge,xe)}return typeof xe=="string"&&xe!==""||typeof xe=="number"?(xe=""+xe,oe!==null&&oe.tag===6?(p(ge,oe.sibling),oe=S(oe,xe),oe.return=ge,ge=oe):(p(ge,oe),oe=f2(xe,ge.mode,Je),oe.return=ge,ge=oe),G(ge)):p(ge,oe)}return Or}var Kd=nk(!0),rk=nk(!1),ay=uc(null),oy=null,Yd=null,SE=null;function TE(){SE=Yd=oy=null}function bE(c){var d=ay.current;sr(ay),c._currentValue=d}function IE(c,d,p){for(;c!==null;){var w=c.alternate;if((c.childLanes&d)!==d?(c.childLanes|=d,w!==null&&(w.childLanes|=d)):w!==null&&(w.childLanes&d)!==d&&(w.childLanes|=d),c===p)break;c=c.return}}function Xd(c,d){oy=c,SE=Yd=null,c=c.dependencies,c!==null&&c.firstContext!==null&&((c.lanes&d)!==0&&(ms=!0),c.firstContext=null)}function ua(c){var d=c._currentValue;if(SE!==c)if(c={context:c,memoizedValue:d,next:null},Yd===null){if(oy===null)throw Error(t(308));Yd=c,oy.dependencies={lanes:0,firstContext:c}}else Yd=Yd.next=c;return d}var zu=null;function AE(c){zu===null?zu=[c]:zu.push(c)}function ik(c,d,p,w){var S=d.interleaved;return S===null?(p.next=p,AE(d)):(p.next=S.next,S.next=p),d.interleaved=p,ml(c,w)}function ml(c,d){c.lanes|=d;var p=c.alternate;for(p!==null&&(p.lanes|=d),p=c,c=c.return;c!==null;)c.childLanes|=d,p=c.alternate,p!==null&&(p.childLanes|=d),p=c,c=c.return;return p.tag===3?p.stateNode:null}var fc=!1;function RE(c){c.updateQueue={baseState:c.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function sk(c,d){c=c.updateQueue,d.updateQueue===c&&(d.updateQueue={baseState:c.baseState,firstBaseUpdate:c.firstBaseUpdate,lastBaseUpdate:c.lastBaseUpdate,shared:c.shared,effects:c.effects})}function pl(c,d){return{eventTime:c,lane:d,tag:0,payload:null,callback:null,next:null}}function gc(c,d,p){var w=c.updateQueue;if(w===null)return null;if(w=w.shared,(_n&2)!==0){var S=w.pending;return S===null?d.next=d:(d.next=S.next,S.next=d),w.pending=d,ml(c,p)}return S=w.interleaved,S===null?(d.next=d,AE(w)):(d.next=S.next,S.next=d),w.interleaved=d,ml(c,p)}function ly(c,d,p){if(d=d.updateQueue,d!==null&&(d=d.shared,(p&4194240)!==0)){var w=d.lanes;w&=c.pendingLanes,p|=w,d.lanes=p,tg(c,p)}}function ak(c,d){var p=c.updateQueue,w=c.alternate;if(w!==null&&(w=w.updateQueue,p===w)){var S=null,A=null;if(p=p.firstBaseUpdate,p!==null){do{var G={eventTime:p.eventTime,lane:p.lane,tag:p.tag,payload:p.payload,callback:p.callback,next:null};A===null?S=A=G:A=A.next=G,p=p.next}while(p!==null);A===null?S=A=d:A=A.next=d}else S=A=d;p={baseState:w.baseState,firstBaseUpdate:S,lastBaseUpdate:A,shared:w.shared,effects:w.effects},c.updateQueue=p;return}c=p.lastBaseUpdate,c===null?p.firstBaseUpdate=d:c.next=d,p.lastBaseUpdate=d}function cy(c,d,p,w){var S=c.updateQueue;fc=!1;var A=S.firstBaseUpdate,G=S.lastBaseUpdate,ie=S.shared.pending;if(ie!==null){S.shared.pending=null;var ae=ie,Ie=ae.next;ae.next=null,G===null?A=Ie:G.next=Ie,G=ae;var He=c.alternate;He!==null&&(He=He.updateQueue,ie=He.lastBaseUpdate,ie!==G&&(ie===null?He.firstBaseUpdate=Ie:ie.next=Ie,He.lastBaseUpdate=ae))}if(A!==null){var qe=S.baseState;G=0,He=Ie=ae=null,ie=A;do{var ze=ie.lane,yt=ie.eventTime;if((w&ze)===ze){He!==null&&(He=He.next={eventTime:yt,lane:0,tag:ie.tag,payload:ie.payload,callback:ie.callback,next:null});e:{var wt=c,Tt=ie;switch(ze=d,yt=p,Tt.tag){case 1:if(wt=Tt.payload,typeof wt=="function"){qe=wt.call(yt,qe,ze);break e}qe=wt;break e;case 3:wt.flags=wt.flags&-65537|128;case 0:if(wt=Tt.payload,ze=typeof wt=="function"?wt.call(yt,qe,ze):wt,ze==null)break e;qe=Se({},qe,ze);break e;case 2:fc=!0}}ie.callback!==null&&ie.lane!==0&&(c.flags|=64,ze=S.effects,ze===null?S.effects=[ie]:ze.push(ie))}else yt={eventTime:yt,lane:ze,tag:ie.tag,payload:ie.payload,callback:ie.callback,next:null},He===null?(Ie=He=yt,ae=qe):He=He.next=yt,G|=ze;if(ie=ie.next,ie===null){if(ie=S.shared.pending,ie===null)break;ze=ie,ie=ze.next,ze.next=null,S.lastBaseUpdate=ze,S.shared.pending=null}}while(!0);if(He===null&&(ae=qe),S.baseState=ae,S.firstBaseUpdate=Ie,S.lastBaseUpdate=He,d=S.shared.interleaved,d!==null){S=d;do G|=S.lane,S=S.next;while(S!==d)}else A===null&&(S.shared.lanes=0);Hu|=G,c.lanes=G,c.memoizedState=qe}}function ok(c,d,p){if(c=d.effects,d.effects=null,c!==null)for(d=0;d<c.length;d++){var w=c[d],S=w.callback;if(S!==null){if(w.callback=null,w=p,typeof S!="function")throw Error(t(191,S));S.call(w)}}}var wg={},Ao=uc(wg),Eg=uc(wg),Sg=uc(wg);function $u(c){if(c===wg)throw Error(t(174));return c}function CE(c,d){switch(tr(Sg,d),tr(Eg,c),tr(Ao,wg),c=d.nodeType,c){case 9:case 11:d=(d=d.documentElement)?d.namespaceURI:Rt(null,"");break;default:c=c===8?d.parentNode:d,d=c.namespaceURI||null,c=c.tagName,d=Rt(d,c)}sr(Ao),tr(Ao,d)}function qd(){sr(Ao),sr(Eg),sr(Sg)}function lk(c){$u(Sg.current);var d=$u(Ao.current),p=Rt(d,c.type);d!==p&&(tr(Eg,c),tr(Ao,p))}function kE(c){Eg.current===c&&(sr(Ao),sr(Eg))}var xr=uc(0);function uy(c){for(var d=c;d!==null;){if(d.tag===13){var p=d.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||p.data==="$?"||p.data==="$!"))return d}else if(d.tag===19&&d.memoizedProps.revealOrder!==void 0){if((d.flags&128)!==0)return d}else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===c)break;for(;d.sibling===null;){if(d.return===null||d.return===c)return null;d=d.return}d.sibling.return=d.return,d=d.sibling}return null}var PE=[];function ME(){for(var c=0;c<PE.length;c++)PE[c]._workInProgressVersionPrimary=null;PE.length=0}var hy=M.ReactCurrentDispatcher,NE=M.ReactCurrentBatchConfig,Wu=0,vr=null,Zr=null,oi=null,dy=!1,Tg=!1,bg=0,XG=0;function Fi(){throw Error(t(321))}function LE(c,d){if(d===null)return!1;for(var p=0;p<d.length&&p<c.length;p++)if(!Oa(c[p],d[p]))return!1;return!0}function OE(c,d,p,w,S,A){if(Wu=A,vr=d,d.memoizedState=null,d.updateQueue=null,d.lanes=0,hy.current=c===null||c.memoizedState===null?JG:eB,c=p(w,S),Tg){A=0;do{if(Tg=!1,bg=0,25<=A)throw Error(t(301));A+=1,oi=Zr=null,d.updateQueue=null,hy.current=tB,c=p(w,S)}while(Tg)}if(hy.current=my,d=Zr!==null&&Zr.next!==null,Wu=0,oi=Zr=vr=null,dy=!1,d)throw Error(t(300));return c}function DE(){var c=bg!==0;return bg=0,c}function Ro(){var c={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return oi===null?vr.memoizedState=oi=c:oi=oi.next=c,oi}function ha(){if(Zr===null){var c=vr.alternate;c=c!==null?c.memoizedState:null}else c=Zr.next;var d=oi===null?vr.memoizedState:oi.next;if(d!==null)oi=d,Zr=c;else{if(c===null)throw Error(t(310));Zr=c,c={memoizedState:Zr.memoizedState,baseState:Zr.baseState,baseQueue:Zr.baseQueue,queue:Zr.queue,next:null},oi===null?vr.memoizedState=oi=c:oi=oi.next=c}return oi}function Ig(c,d){return typeof d=="function"?d(c):d}function FE(c){var d=ha(),p=d.queue;if(p===null)throw Error(t(311));p.lastRenderedReducer=c;var w=Zr,S=w.baseQueue,A=p.pending;if(A!==null){if(S!==null){var G=S.next;S.next=A.next,A.next=G}w.baseQueue=S=A,p.pending=null}if(S!==null){A=S.next,w=w.baseState;var ie=G=null,ae=null,Ie=A;do{var He=Ie.lane;if((Wu&He)===He)ae!==null&&(ae=ae.next={lane:0,action:Ie.action,hasEagerState:Ie.hasEagerState,eagerState:Ie.eagerState,next:null}),w=Ie.hasEagerState?Ie.eagerState:c(w,Ie.action);else{var qe={lane:He,action:Ie.action,hasEagerState:Ie.hasEagerState,eagerState:Ie.eagerState,next:null};ae===null?(ie=ae=qe,G=w):ae=ae.next=qe,vr.lanes|=He,Hu|=He}Ie=Ie.next}while(Ie!==null&&Ie!==A);ae===null?G=w:ae.next=ie,Oa(w,d.memoizedState)||(ms=!0),d.memoizedState=w,d.baseState=G,d.baseQueue=ae,p.lastRenderedState=w}if(c=p.interleaved,c!==null){S=c;do A=S.lane,vr.lanes|=A,Hu|=A,S=S.next;while(S!==c)}else S===null&&(p.lanes=0);return[d.memoizedState,p.dispatch]}function jE(c){var d=ha(),p=d.queue;if(p===null)throw Error(t(311));p.lastRenderedReducer=c;var w=p.dispatch,S=p.pending,A=d.memoizedState;if(S!==null){p.pending=null;var G=S=S.next;do A=c(A,G.action),G=G.next;while(G!==S);Oa(A,d.memoizedState)||(ms=!0),d.memoizedState=A,d.baseQueue===null&&(d.baseState=A),p.lastRenderedState=A}return[A,w]}function ck(){}function uk(c,d){var p=vr,w=ha(),S=d(),A=!Oa(w.memoizedState,S);if(A&&(w.memoizedState=S,ms=!0),w=w.queue,VE(fk.bind(null,p,w,c),[c]),w.getSnapshot!==d||A||oi!==null&&oi.memoizedState.tag&1){if(p.flags|=2048,Ag(9,dk.bind(null,p,w,S,d),void 0,null),li===null)throw Error(t(349));(Wu&30)!==0||hk(p,d,S)}return S}function hk(c,d,p){c.flags|=16384,c={getSnapshot:d,value:p},d=vr.updateQueue,d===null?(d={lastEffect:null,stores:null},vr.updateQueue=d,d.stores=[c]):(p=d.stores,p===null?d.stores=[c]:p.push(c))}function dk(c,d,p,w){d.value=p,d.getSnapshot=w,gk(d)&&mk(c)}function fk(c,d,p){return p(function(){gk(d)&&mk(c)})}function gk(c){var d=c.getSnapshot;c=c.value;try{var p=d();return!Oa(c,p)}catch{return!0}}function mk(c){var d=ml(c,1);d!==null&&Ga(d,c,1,-1)}function pk(c){var d=Ro();return typeof c=="function"&&(c=c()),d.memoizedState=d.baseState=c,c={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ig,lastRenderedState:c},d.queue=c,c=c.dispatch=QG.bind(null,vr,c),[d.memoizedState,c]}function Ag(c,d,p,w){return c={tag:c,create:d,destroy:p,deps:w,next:null},d=vr.updateQueue,d===null?(d={lastEffect:null,stores:null},vr.updateQueue=d,d.lastEffect=c.next=c):(p=d.lastEffect,p===null?d.lastEffect=c.next=c:(w=p.next,p.next=c,c.next=w,d.lastEffect=c)),c}function yk(){return ha().memoizedState}function fy(c,d,p,w){var S=Ro();vr.flags|=c,S.memoizedState=Ag(1|d,p,void 0,w===void 0?null:w)}function gy(c,d,p,w){var S=ha();w=w===void 0?null:w;var A=void 0;if(Zr!==null){var G=Zr.memoizedState;if(A=G.destroy,w!==null&&LE(w,G.deps)){S.memoizedState=Ag(d,p,A,w);return}}vr.flags|=c,S.memoizedState=Ag(1|d,p,A,w)}function _k(c,d){return fy(8390656,8,c,d)}function VE(c,d){return gy(2048,8,c,d)}function xk(c,d){return gy(4,2,c,d)}function vk(c,d){return gy(4,4,c,d)}function wk(c,d){if(typeof d=="function")return c=c(),d(c),function(){d(null)};if(d!=null)return c=c(),d.current=c,function(){d.current=null}}function Ek(c,d,p){return p=p!=null?p.concat([c]):null,gy(4,4,wk.bind(null,d,c),p)}function GE(){}function Sk(c,d){var p=ha();d=d===void 0?null:d;var w=p.memoizedState;return w!==null&&d!==null&&LE(d,w[1])?w[0]:(p.memoizedState=[c,d],c)}function Tk(c,d){var p=ha();d=d===void 0?null:d;var w=p.memoizedState;return w!==null&&d!==null&&LE(d,w[1])?w[0]:(c=c(),p.memoizedState=[c,d],c)}function bk(c,d,p){return(Wu&21)===0?(c.baseState&&(c.baseState=!1,ms=!0),c.memoizedState=p):(Oa(p,d)||(p=J0(),vr.lanes|=p,Hu|=p,c.baseState=!0),d)}function qG(c,d){var p=gn;gn=p!==0&&4>p?p:4,c(!0);var w=NE.transition;NE.transition={};try{c(!1),d()}finally{gn=p,NE.transition=w}}function Ik(){return ha().memoizedState}function ZG(c,d,p){var w=_c(c);if(p={lane:w,action:p,hasEagerState:!1,eagerState:null,next:null},Ak(c))Rk(d,p);else if(p=ik(c,d,p,w),p!==null){var S=ns();Ga(p,c,w,S),Ck(p,d,w)}}function QG(c,d,p){var w=_c(c),S={lane:w,action:p,hasEagerState:!1,eagerState:null,next:null};if(Ak(c))Rk(d,S);else{var A=c.alternate;if(c.lanes===0&&(A===null||A.lanes===0)&&(A=d.lastRenderedReducer,A!==null))try{var G=d.lastRenderedState,ie=A(G,p);if(S.hasEagerState=!0,S.eagerState=ie,Oa(ie,G)){var ae=d.interleaved;ae===null?(S.next=S,AE(d)):(S.next=ae.next,ae.next=S),d.interleaved=S;return}}catch{}p=ik(c,d,S,w),p!==null&&(S=ns(),Ga(p,c,w,S),Ck(p,d,w))}}function Ak(c){var d=c.alternate;return c===vr||d!==null&&d===vr}function Rk(c,d){Tg=dy=!0;var p=c.pending;p===null?d.next=d:(d.next=p.next,p.next=d),c.pending=d}function Ck(c,d,p){if((p&4194240)!==0){var w=d.lanes;w&=c.pendingLanes,p|=w,d.lanes=p,tg(c,p)}}var my={readContext:ua,useCallback:Fi,useContext:Fi,useEffect:Fi,useImperativeHandle:Fi,useInsertionEffect:Fi,useLayoutEffect:Fi,useMemo:Fi,useReducer:Fi,useRef:Fi,useState:Fi,useDebugValue:Fi,useDeferredValue:Fi,useTransition:Fi,useMutableSource:Fi,useSyncExternalStore:Fi,useId:Fi,unstable_isNewReconciler:!1},JG={readContext:ua,useCallback:function(c,d){return Ro().memoizedState=[c,d===void 0?null:d],c},useContext:ua,useEffect:_k,useImperativeHandle:function(c,d,p){return p=p!=null?p.concat([c]):null,fy(4194308,4,wk.bind(null,d,c),p)},useLayoutEffect:function(c,d){return fy(4194308,4,c,d)},useInsertionEffect:function(c,d){return fy(4,2,c,d)},useMemo:function(c,d){var p=Ro();return d=d===void 0?null:d,c=c(),p.memoizedState=[c,d],c},useReducer:function(c,d,p){var w=Ro();return d=p!==void 0?p(d):d,w.memoizedState=w.baseState=d,c={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:c,lastRenderedState:d},w.queue=c,c=c.dispatch=ZG.bind(null,vr,c),[w.memoizedState,c]},useRef:function(c){var d=Ro();return c={current:c},d.memoizedState=c},useState:pk,useDebugValue:GE,useDeferredValue:function(c){return Ro().memoizedState=c},useTransition:function(){var c=pk(!1),d=c[0];return c=qG.bind(null,c[1]),Ro().memoizedState=c,[d,c]},useMutableSource:function(){},useSyncExternalStore:function(c,d,p){var w=vr,S=Ro();if(fr){if(p===void 0)throw Error(t(407));p=p()}else{if(p=d(),li===null)throw Error(t(349));(Wu&30)!==0||hk(w,d,p)}S.memoizedState=p;var A={value:p,getSnapshot:d};return S.queue=A,_k(fk.bind(null,w,A,c),[c]),w.flags|=2048,Ag(9,dk.bind(null,w,A,p,d),void 0,null),p},useId:function(){var c=Ro(),d=li.identifierPrefix;if(fr){var p=gl,w=fl;p=(w&~(1<<32-_r(w)-1)).toString(32)+p,d=":"+d+"R"+p,p=bg++,0<p&&(d+="H"+p.toString(32)),d+=":"}else p=XG++,d=":"+d+"r"+p.toString(32)+":";return c.memoizedState=d},unstable_isNewReconciler:!1},eB={readContext:ua,useCallback:Sk,useContext:ua,useEffect:VE,useImperativeHandle:Ek,useInsertionEffect:xk,useLayoutEffect:vk,useMemo:Tk,useReducer:FE,useRef:yk,useState:function(){return FE(Ig)},useDebugValue:GE,useDeferredValue:function(c){var d=ha();return bk(d,Zr.memoizedState,c)},useTransition:function(){var c=FE(Ig)[0],d=ha().memoizedState;return[c,d]},useMutableSource:ck,useSyncExternalStore:uk,useId:Ik,unstable_isNewReconciler:!1},tB={readContext:ua,useCallback:Sk,useContext:ua,useEffect:VE,useImperativeHandle:Ek,useInsertionEffect:xk,useLayoutEffect:vk,useMemo:Tk,useReducer:jE,useRef:yk,useState:function(){return jE(Ig)},useDebugValue:GE,useDeferredValue:function(c){var d=ha();return Zr===null?d.memoizedState=c:bk(d,Zr.memoizedState,c)},useTransition:function(){var c=jE(Ig)[0],d=ha().memoizedState;return[c,d]},useMutableSource:ck,useSyncExternalStore:uk,useId:Ik,unstable_isNewReconciler:!1};function Fa(c,d){if(c&&c.defaultProps){d=Se({},d),c=c.defaultProps;for(var p in c)d[p]===void 0&&(d[p]=c[p]);return d}return d}function BE(c,d,p,w){d=c.memoizedState,p=p(w,d),p=p==null?d:Se({},d,p),c.memoizedState=p,c.lanes===0&&(c.updateQueue.baseState=p)}var py={isMounted:function(c){return(c=c._reactInternals)?te(c)===c:!1},enqueueSetState:function(c,d,p){c=c._reactInternals;var w=ns(),S=_c(c),A=pl(w,S);A.payload=d,p!=null&&(A.callback=p),d=gc(c,A,S),d!==null&&(Ga(d,c,S,w),ly(d,c,S))},enqueueReplaceState:function(c,d,p){c=c._reactInternals;var w=ns(),S=_c(c),A=pl(w,S);A.tag=1,A.payload=d,p!=null&&(A.callback=p),d=gc(c,A,S),d!==null&&(Ga(d,c,S,w),ly(d,c,S))},enqueueForceUpdate:function(c,d){c=c._reactInternals;var p=ns(),w=_c(c),S=pl(p,w);S.tag=2,d!=null&&(S.callback=d),d=gc(c,S,w),d!==null&&(Ga(d,c,w,p),ly(d,c,w))}};function kk(c,d,p,w,S,A,G){return c=c.stateNode,typeof c.shouldComponentUpdate=="function"?c.shouldComponentUpdate(w,A,G):d.prototype&&d.prototype.isPureReactComponent?!fg(p,w)||!fg(S,A):!0}function Pk(c,d,p){var w=!1,S=hc,A=d.contextType;return typeof A=="object"&&A!==null?A=ua(A):(S=gs(d)?Gu:Di.current,w=d.contextTypes,A=(w=w!=null)?zd(c,S):hc),d=new d(p,A),c.memoizedState=d.state!==null&&d.state!==void 0?d.state:null,d.updater=py,c.stateNode=d,d._reactInternals=c,w&&(c=c.stateNode,c.__reactInternalMemoizedUnmaskedChildContext=S,c.__reactInternalMemoizedMaskedChildContext=A),d}function Mk(c,d,p,w){c=d.state,typeof d.componentWillReceiveProps=="function"&&d.componentWillReceiveProps(p,w),typeof d.UNSAFE_componentWillReceiveProps=="function"&&d.UNSAFE_componentWillReceiveProps(p,w),d.state!==c&&py.enqueueReplaceState(d,d.state,null)}function UE(c,d,p,w){var S=c.stateNode;S.props=p,S.state=c.memoizedState,S.refs={},RE(c);var A=d.contextType;typeof A=="object"&&A!==null?S.context=ua(A):(A=gs(d)?Gu:Di.current,S.context=zd(c,A)),S.state=c.memoizedState,A=d.getDerivedStateFromProps,typeof A=="function"&&(BE(c,d,A,p),S.state=c.memoizedState),typeof d.getDerivedStateFromProps=="function"||typeof S.getSnapshotBeforeUpdate=="function"||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(d=S.state,typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount(),d!==S.state&&py.enqueueReplaceState(S,S.state,null),cy(c,p,S,w),S.state=c.memoizedState),typeof S.componentDidMount=="function"&&(c.flags|=4194308)}function Zd(c,d){try{var p="",w=d;do p+=q(w),w=w.return;while(w);var S=p}catch(A){S=`
Error generating stack: `+A.message+`
`+A.stack}return{value:c,source:d,stack:S,digest:null}}function zE(c,d,p){return{value:c,source:null,stack:p??null,digest:d??null}}function $E(c,d){try{console.error(d.value)}catch(p){setTimeout(function(){throw p})}}var nB=typeof WeakMap=="function"?WeakMap:Map;function Nk(c,d,p){p=pl(-1,p),p.tag=3,p.payload={element:null};var w=d.value;return p.callback=function(){Sy||(Sy=!0,s2=w),$E(c,d)},p}function Lk(c,d,p){p=pl(-1,p),p.tag=3;var w=c.type.getDerivedStateFromError;if(typeof w=="function"){var S=d.value;p.payload=function(){return w(S)},p.callback=function(){$E(c,d)}}var A=c.stateNode;return A!==null&&typeof A.componentDidCatch=="function"&&(p.callback=function(){$E(c,d),typeof w!="function"&&(pc===null?pc=new Set([this]):pc.add(this));var G=d.stack;this.componentDidCatch(d.value,{componentStack:G!==null?G:""})}),p}function Ok(c,d,p){var w=c.pingCache;if(w===null){w=c.pingCache=new nB;var S=new Set;w.set(d,S)}else S=w.get(d),S===void 0&&(S=new Set,w.set(d,S));S.has(p)||(S.add(p),c=pB.bind(null,c,d,p),d.then(c,c))}function Dk(c){do{var d;if((d=c.tag===13)&&(d=c.memoizedState,d=d!==null?d.dehydrated!==null:!0),d)return c;c=c.return}while(c!==null);return null}function Fk(c,d,p,w,S){return(c.mode&1)===0?(c===d?c.flags|=65536:(c.flags|=128,p.flags|=131072,p.flags&=-52805,p.tag===1&&(p.alternate===null?p.tag=17:(d=pl(-1,1),d.tag=2,gc(p,d,1))),p.lanes|=1),c):(c.flags|=65536,c.lanes=S,c)}var rB=M.ReactCurrentOwner,ms=!1;function ts(c,d,p,w){d.child=c===null?rk(d,null,p,w):Kd(d,c.child,p,w)}function jk(c,d,p,w,S){p=p.render;var A=d.ref;return Xd(d,S),w=OE(c,d,p,w,A,S),p=DE(),c!==null&&!ms?(d.updateQueue=c.updateQueue,d.flags&=-2053,c.lanes&=~S,yl(c,d,S)):(fr&&p&&_E(d),d.flags|=1,ts(c,d,w,S),d.child)}function Vk(c,d,p,w,S){if(c===null){var A=p.type;return typeof A=="function"&&!d2(A)&&A.defaultProps===void 0&&p.compare===null&&p.defaultProps===void 0?(d.tag=15,d.type=A,Gk(c,d,A,w,S)):(c=Cy(p.type,null,w,d,d.mode,S),c.ref=d.ref,c.return=d,d.child=c)}if(A=c.child,(c.lanes&S)===0){var G=A.memoizedProps;if(p=p.compare,p=p!==null?p:fg,p(G,w)&&c.ref===d.ref)return yl(c,d,S)}return d.flags|=1,c=vc(A,w),c.ref=d.ref,c.return=d,d.child=c}function Gk(c,d,p,w,S){if(c!==null){var A=c.memoizedProps;if(fg(A,w)&&c.ref===d.ref)if(ms=!1,d.pendingProps=w=A,(c.lanes&S)!==0)(c.flags&131072)!==0&&(ms=!0);else return d.lanes=c.lanes,yl(c,d,S)}return WE(c,d,p,w,S)}function Bk(c,d,p){var w=d.pendingProps,S=w.children,A=c!==null?c.memoizedState:null;if(w.mode==="hidden")if((d.mode&1)===0)d.memoizedState={baseLanes:0,cachePool:null,transitions:null},tr(Jd,Us),Us|=p;else{if((p&1073741824)===0)return c=A!==null?A.baseLanes|p:p,d.lanes=d.childLanes=1073741824,d.memoizedState={baseLanes:c,cachePool:null,transitions:null},d.updateQueue=null,tr(Jd,Us),Us|=c,null;d.memoizedState={baseLanes:0,cachePool:null,transitions:null},w=A!==null?A.baseLanes:p,tr(Jd,Us),Us|=w}else A!==null?(w=A.baseLanes|p,d.memoizedState=null):w=p,tr(Jd,Us),Us|=w;return ts(c,d,S,p),d.child}function Uk(c,d){var p=d.ref;(c===null&&p!==null||c!==null&&c.ref!==p)&&(d.flags|=512,d.flags|=2097152)}function WE(c,d,p,w,S){var A=gs(p)?Gu:Di.current;return A=zd(d,A),Xd(d,S),p=OE(c,d,p,w,A,S),w=DE(),c!==null&&!ms?(d.updateQueue=c.updateQueue,d.flags&=-2053,c.lanes&=~S,yl(c,d,S)):(fr&&w&&_E(d),d.flags|=1,ts(c,d,p,S),d.child)}function zk(c,d,p,w,S){if(gs(p)){var A=!0;ey(d)}else A=!1;if(Xd(d,S),d.stateNode===null)_y(c,d),Pk(d,p,w),UE(d,p,w,S),w=!0;else if(c===null){var G=d.stateNode,ie=d.memoizedProps;G.props=ie;var ae=G.context,Ie=p.contextType;typeof Ie=="object"&&Ie!==null?Ie=ua(Ie):(Ie=gs(p)?Gu:Di.current,Ie=zd(d,Ie));var He=p.getDerivedStateFromProps,qe=typeof He=="function"||typeof G.getSnapshotBeforeUpdate=="function";qe||typeof G.UNSAFE_componentWillReceiveProps!="function"&&typeof G.componentWillReceiveProps!="function"||(ie!==w||ae!==Ie)&&Mk(d,G,w,Ie),fc=!1;var ze=d.memoizedState;G.state=ze,cy(d,w,G,S),ae=d.memoizedState,ie!==w||ze!==ae||fs.current||fc?(typeof He=="function"&&(BE(d,p,He,w),ae=d.memoizedState),(ie=fc||kk(d,p,ie,w,ze,ae,Ie))?(qe||typeof G.UNSAFE_componentWillMount!="function"&&typeof G.componentWillMount!="function"||(typeof G.componentWillMount=="function"&&G.componentWillMount(),typeof G.UNSAFE_componentWillMount=="function"&&G.UNSAFE_componentWillMount()),typeof G.componentDidMount=="function"&&(d.flags|=4194308)):(typeof G.componentDidMount=="function"&&(d.flags|=4194308),d.memoizedProps=w,d.memoizedState=ae),G.props=w,G.state=ae,G.context=Ie,w=ie):(typeof G.componentDidMount=="function"&&(d.flags|=4194308),w=!1)}else{G=d.stateNode,sk(c,d),ie=d.memoizedProps,Ie=d.type===d.elementType?ie:Fa(d.type,ie),G.props=Ie,qe=d.pendingProps,ze=G.context,ae=p.contextType,typeof ae=="object"&&ae!==null?ae=ua(ae):(ae=gs(p)?Gu:Di.current,ae=zd(d,ae));var yt=p.getDerivedStateFromProps;(He=typeof yt=="function"||typeof G.getSnapshotBeforeUpdate=="function")||typeof G.UNSAFE_componentWillReceiveProps!="function"&&typeof G.componentWillReceiveProps!="function"||(ie!==qe||ze!==ae)&&Mk(d,G,w,ae),fc=!1,ze=d.memoizedState,G.state=ze,cy(d,w,G,S);var wt=d.memoizedState;ie!==qe||ze!==wt||fs.current||fc?(typeof yt=="function"&&(BE(d,p,yt,w),wt=d.memoizedState),(Ie=fc||kk(d,p,Ie,w,ze,wt,ae)||!1)?(He||typeof G.UNSAFE_componentWillUpdate!="function"&&typeof G.componentWillUpdate!="function"||(typeof G.componentWillUpdate=="function"&&G.componentWillUpdate(w,wt,ae),typeof G.UNSAFE_componentWillUpdate=="function"&&G.UNSAFE_componentWillUpdate(w,wt,ae)),typeof G.componentDidUpdate=="function"&&(d.flags|=4),typeof G.getSnapshotBeforeUpdate=="function"&&(d.flags|=1024)):(typeof G.componentDidUpdate!="function"||ie===c.memoizedProps&&ze===c.memoizedState||(d.flags|=4),typeof G.getSnapshotBeforeUpdate!="function"||ie===c.memoizedProps&&ze===c.memoizedState||(d.flags|=1024),d.memoizedProps=w,d.memoizedState=wt),G.props=w,G.state=wt,G.context=ae,w=Ie):(typeof G.componentDidUpdate!="function"||ie===c.memoizedProps&&ze===c.memoizedState||(d.flags|=4),typeof G.getSnapshotBeforeUpdate!="function"||ie===c.memoizedProps&&ze===c.memoizedState||(d.flags|=1024),w=!1)}return HE(c,d,p,w,A,S)}function HE(c,d,p,w,S,A){Uk(c,d);var G=(d.flags&128)!==0;if(!w&&!G)return S&&YC(d,p,!1),yl(c,d,A);w=d.stateNode,rB.current=d;var ie=G&&typeof p.getDerivedStateFromError!="function"?null:w.render();return d.flags|=1,c!==null&&G?(d.child=Kd(d,c.child,null,A),d.child=Kd(d,null,ie,A)):ts(c,d,ie,A),d.memoizedState=w.state,S&&YC(d,p,!0),d.child}function $k(c){var d=c.stateNode;d.pendingContext?HC(c,d.pendingContext,d.pendingContext!==d.context):d.context&&HC(c,d.context,!1),CE(c,d.containerInfo)}function Wk(c,d,p,w,S){return Hd(),EE(S),d.flags|=256,ts(c,d,p,w),d.child}var KE={dehydrated:null,treeContext:null,retryLane:0};function YE(c){return{baseLanes:c,cachePool:null,transitions:null}}function Hk(c,d,p){var w=d.pendingProps,S=xr.current,A=!1,G=(d.flags&128)!==0,ie;if((ie=G)||(ie=c!==null&&c.memoizedState===null?!1:(S&2)!==0),ie?(A=!0,d.flags&=-129):(c===null||c.memoizedState!==null)&&(S|=1),tr(xr,S&1),c===null)return wE(d),c=d.memoizedState,c!==null&&(c=c.dehydrated,c!==null)?((d.mode&1)===0?d.lanes=1:c.data==="$!"?d.lanes=8:d.lanes=1073741824,null):(G=w.children,c=w.fallback,A?(w=d.mode,A=d.child,G={mode:"hidden",children:G},(w&1)===0&&A!==null?(A.childLanes=0,A.pendingProps=G):A=ky(G,w,0,null),c=qu(c,w,p,null),A.return=d,c.return=d,A.sibling=c,d.child=A,d.child.memoizedState=YE(p),d.memoizedState=KE,c):XE(d,G));if(S=c.memoizedState,S!==null&&(ie=S.dehydrated,ie!==null))return iB(c,d,G,w,ie,S,p);if(A){A=w.fallback,G=d.mode,S=c.child,ie=S.sibling;var ae={mode:"hidden",children:w.children};return(G&1)===0&&d.child!==S?(w=d.child,w.childLanes=0,w.pendingProps=ae,d.deletions=null):(w=vc(S,ae),w.subtreeFlags=S.subtreeFlags&14680064),ie!==null?A=vc(ie,A):(A=qu(A,G,p,null),A.flags|=2),A.return=d,w.return=d,w.sibling=A,d.child=w,w=A,A=d.child,G=c.child.memoizedState,G=G===null?YE(p):{baseLanes:G.baseLanes|p,cachePool:null,transitions:G.transitions},A.memoizedState=G,A.childLanes=c.childLanes&~p,d.memoizedState=KE,w}return A=c.child,c=A.sibling,w=vc(A,{mode:"visible",children:w.children}),(d.mode&1)===0&&(w.lanes=p),w.return=d,w.sibling=null,c!==null&&(p=d.deletions,p===null?(d.deletions=[c],d.flags|=16):p.push(c)),d.child=w,d.memoizedState=null,w}function XE(c,d){return d=ky({mode:"visible",children:d},c.mode,0,null),d.return=c,c.child=d}function yy(c,d,p,w){return w!==null&&EE(w),Kd(d,c.child,null,p),c=XE(d,d.pendingProps.children),c.flags|=2,d.memoizedState=null,c}function iB(c,d,p,w,S,A,G){if(p)return d.flags&256?(d.flags&=-257,w=zE(Error(t(422))),yy(c,d,G,w)):d.memoizedState!==null?(d.child=c.child,d.flags|=128,null):(A=w.fallback,S=d.mode,w=ky({mode:"visible",children:w.children},S,0,null),A=qu(A,S,G,null),A.flags|=2,w.return=d,A.return=d,w.sibling=A,d.child=w,(d.mode&1)!==0&&Kd(d,c.child,null,G),d.child.memoizedState=YE(G),d.memoizedState=KE,A);if((d.mode&1)===0)return yy(c,d,G,null);if(S.data==="$!"){if(w=S.nextSibling&&S.nextSibling.dataset,w)var ie=w.dgst;return w=ie,A=Error(t(419)),w=zE(A,w,void 0),yy(c,d,G,w)}if(ie=(G&c.childLanes)!==0,ms||ie){if(w=li,w!==null){switch(G&-G){case 4:S=2;break;case 16:S=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:S=32;break;case 536870912:S=268435456;break;default:S=0}S=(S&(w.suspendedLanes|G))!==0?0:S,S!==0&&S!==A.retryLane&&(A.retryLane=S,ml(c,S),Ga(w,c,S,-1))}return h2(),w=zE(Error(t(421))),yy(c,d,G,w)}return S.data==="$?"?(d.flags|=128,d.child=c.child,d=yB.bind(null,c),S._reactRetry=d,null):(c=A.treeContext,Bs=cc(S.nextSibling),Gs=d,fr=!0,Da=null,c!==null&&(la[ca++]=fl,la[ca++]=gl,la[ca++]=Bu,fl=c.id,gl=c.overflow,Bu=d),d=XE(d,w.children),d.flags|=4096,d)}function Kk(c,d,p){c.lanes|=d;var w=c.alternate;w!==null&&(w.lanes|=d),IE(c.return,d,p)}function qE(c,d,p,w,S){var A=c.memoizedState;A===null?c.memoizedState={isBackwards:d,rendering:null,renderingStartTime:0,last:w,tail:p,tailMode:S}:(A.isBackwards=d,A.rendering=null,A.renderingStartTime=0,A.last=w,A.tail=p,A.tailMode=S)}function Yk(c,d,p){var w=d.pendingProps,S=w.revealOrder,A=w.tail;if(ts(c,d,w.children,p),w=xr.current,(w&2)!==0)w=w&1|2,d.flags|=128;else{if(c!==null&&(c.flags&128)!==0)e:for(c=d.child;c!==null;){if(c.tag===13)c.memoizedState!==null&&Kk(c,p,d);else if(c.tag===19)Kk(c,p,d);else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===d)break e;for(;c.sibling===null;){if(c.return===null||c.return===d)break e;c=c.return}c.sibling.return=c.return,c=c.sibling}w&=1}if(tr(xr,w),(d.mode&1)===0)d.memoizedState=null;else switch(S){case"forwards":for(p=d.child,S=null;p!==null;)c=p.alternate,c!==null&&uy(c)===null&&(S=p),p=p.sibling;p=S,p===null?(S=d.child,d.child=null):(S=p.sibling,p.sibling=null),qE(d,!1,S,p,A);break;case"backwards":for(p=null,S=d.child,d.child=null;S!==null;){if(c=S.alternate,c!==null&&uy(c)===null){d.child=S;break}c=S.sibling,S.sibling=p,p=S,S=c}qE(d,!0,p,null,A);break;case"together":qE(d,!1,null,null,void 0);break;default:d.memoizedState=null}return d.child}function _y(c,d){(d.mode&1)===0&&c!==null&&(c.alternate=null,d.alternate=null,d.flags|=2)}function yl(c,d,p){if(c!==null&&(d.dependencies=c.dependencies),Hu|=d.lanes,(p&d.childLanes)===0)return null;if(c!==null&&d.child!==c.child)throw Error(t(153));if(d.child!==null){for(c=d.child,p=vc(c,c.pendingProps),d.child=p,p.return=d;c.sibling!==null;)c=c.sibling,p=p.sibling=vc(c,c.pendingProps),p.return=d;p.sibling=null}return d.child}function sB(c,d,p){switch(d.tag){case 3:$k(d),Hd();break;case 5:lk(d);break;case 1:gs(d.type)&&ey(d);break;case 4:CE(d,d.stateNode.containerInfo);break;case 10:var w=d.type._context,S=d.memoizedProps.value;tr(ay,w._currentValue),w._currentValue=S;break;case 13:if(w=d.memoizedState,w!==null)return w.dehydrated!==null?(tr(xr,xr.current&1),d.flags|=128,null):(p&d.child.childLanes)!==0?Hk(c,d,p):(tr(xr,xr.current&1),c=yl(c,d,p),c!==null?c.sibling:null);tr(xr,xr.current&1);break;case 19:if(w=(p&d.childLanes)!==0,(c.flags&128)!==0){if(w)return Yk(c,d,p);d.flags|=128}if(S=d.memoizedState,S!==null&&(S.rendering=null,S.tail=null,S.lastEffect=null),tr(xr,xr.current),w)break;return null;case 22:case 23:return d.lanes=0,Bk(c,d,p)}return yl(c,d,p)}var Xk,ZE,qk,Zk;Xk=function(c,d){for(var p=d.child;p!==null;){if(p.tag===5||p.tag===6)c.appendChild(p.stateNode);else if(p.tag!==4&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===d)break;for(;p.sibling===null;){if(p.return===null||p.return===d)return;p=p.return}p.sibling.return=p.return,p=p.sibling}},ZE=function(){},qk=function(c,d,p,w){var S=c.memoizedProps;if(S!==w){c=d.stateNode,$u(Ao.current);var A=null;switch(p){case"input":S=Bt(c,S),w=Bt(c,w),A=[];break;case"select":S=Se({},S,{value:void 0}),w=Se({},w,{value:void 0}),A=[];break;case"textarea":S=mt(c,S),w=mt(c,w),A=[];break;default:typeof S.onClick!="function"&&typeof w.onClick=="function"&&(c.onclick=Z1)}kt(p,w);var G;p=null;for(Ie in S)if(!w.hasOwnProperty(Ie)&&S.hasOwnProperty(Ie)&&S[Ie]!=null)if(Ie==="style"){var ie=S[Ie];for(G in ie)ie.hasOwnProperty(G)&&(p||(p={}),p[G]="")}else Ie!=="dangerouslySetInnerHTML"&&Ie!=="children"&&Ie!=="suppressContentEditableWarning"&&Ie!=="suppressHydrationWarning"&&Ie!=="autoFocus"&&(i.hasOwnProperty(Ie)?A||(A=[]):(A=A||[]).push(Ie,null));for(Ie in w){var ae=w[Ie];if(ie=S?.[Ie],w.hasOwnProperty(Ie)&&ae!==ie&&(ae!=null||ie!=null))if(Ie==="style")if(ie){for(G in ie)!ie.hasOwnProperty(G)||ae&&ae.hasOwnProperty(G)||(p||(p={}),p[G]="");for(G in ae)ae.hasOwnProperty(G)&&ie[G]!==ae[G]&&(p||(p={}),p[G]=ae[G])}else p||(A||(A=[]),A.push(Ie,p)),p=ae;else Ie==="dangerouslySetInnerHTML"?(ae=ae?ae.__html:void 0,ie=ie?ie.__html:void 0,ae!=null&&ie!==ae&&(A=A||[]).push(Ie,ae)):Ie==="children"?typeof ae!="string"&&typeof ae!="number"||(A=A||[]).push(Ie,""+ae):Ie!=="suppressContentEditableWarning"&&Ie!=="suppressHydrationWarning"&&(i.hasOwnProperty(Ie)?(ae!=null&&Ie==="onScroll"&&ir("scroll",c),A||ie===ae||(A=[])):(A=A||[]).push(Ie,ae))}p&&(A=A||[]).push("style",p);var Ie=A;(d.updateQueue=Ie)&&(d.flags|=4)}},Zk=function(c,d,p,w){p!==w&&(d.flags|=4)};function Rg(c,d){if(!fr)switch(c.tailMode){case"hidden":d=c.tail;for(var p=null;d!==null;)d.alternate!==null&&(p=d),d=d.sibling;p===null?c.tail=null:p.sibling=null;break;case"collapsed":p=c.tail;for(var w=null;p!==null;)p.alternate!==null&&(w=p),p=p.sibling;w===null?d||c.tail===null?c.tail=null:c.tail.sibling=null:w.sibling=null}}function ji(c){var d=c.alternate!==null&&c.alternate.child===c.child,p=0,w=0;if(d)for(var S=c.child;S!==null;)p|=S.lanes|S.childLanes,w|=S.subtreeFlags&14680064,w|=S.flags&14680064,S.return=c,S=S.sibling;else for(S=c.child;S!==null;)p|=S.lanes|S.childLanes,w|=S.subtreeFlags,w|=S.flags,S.return=c,S=S.sibling;return c.subtreeFlags|=w,c.childLanes=p,d}function aB(c,d,p){var w=d.pendingProps;switch(xE(d),d.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ji(d),null;case 1:return gs(d.type)&&J1(),ji(d),null;case 3:return w=d.stateNode,qd(),sr(fs),sr(Di),ME(),w.pendingContext&&(w.context=w.pendingContext,w.pendingContext=null),(c===null||c.child===null)&&(iy(d)?d.flags|=4:c===null||c.memoizedState.isDehydrated&&(d.flags&256)===0||(d.flags|=1024,Da!==null&&(l2(Da),Da=null))),ZE(c,d),ji(d),null;case 5:kE(d);var S=$u(Sg.current);if(p=d.type,c!==null&&d.stateNode!=null)qk(c,d,p,w,S),c.ref!==d.ref&&(d.flags|=512,d.flags|=2097152);else{if(!w){if(d.stateNode===null)throw Error(t(166));return ji(d),null}if(c=$u(Ao.current),iy(d)){w=d.stateNode,p=d.type;var A=d.memoizedProps;switch(w[Io]=d,w[_g]=A,c=(d.mode&1)!==0,p){case"dialog":ir("cancel",w),ir("close",w);break;case"iframe":case"object":case"embed":ir("load",w);break;case"video":case"audio":for(S=0;S<mg.length;S++)ir(mg[S],w);break;case"source":ir("error",w);break;case"img":case"image":case"link":ir("error",w),ir("load",w);break;case"details":ir("toggle",w);break;case"input":Fn(w,A),ir("invalid",w);break;case"select":w._wrapperState={wasMultiple:!!A.multiple},ir("invalid",w);break;case"textarea":jt(w,A),ir("invalid",w)}kt(p,A),S=null;for(var G in A)if(A.hasOwnProperty(G)){var ie=A[G];G==="children"?typeof ie=="string"?w.textContent!==ie&&(A.suppressHydrationWarning!==!0&&q1(w.textContent,ie,c),S=["children",ie]):typeof ie=="number"&&w.textContent!==""+ie&&(A.suppressHydrationWarning!==!0&&q1(w.textContent,ie,c),S=["children",""+ie]):i.hasOwnProperty(G)&&ie!=null&&G==="onScroll"&&ir("scroll",w)}switch(p){case"input":Gt(w),Zn(w,A,!0);break;case"textarea":Gt(w),_t(w);break;case"select":case"option":break;default:typeof A.onClick=="function"&&(w.onclick=Z1)}w=S,d.updateQueue=w,w!==null&&(d.flags|=4)}else{G=S.nodeType===9?S:S.ownerDocument,c==="http://www.w3.org/1999/xhtml"&&(c=Jt(p)),c==="http://www.w3.org/1999/xhtml"?p==="script"?(c=G.createElement("div"),c.innerHTML="<script><\/script>",c=c.removeChild(c.firstChild)):typeof w.is=="string"?c=G.createElement(p,{is:w.is}):(c=G.createElement(p),p==="select"&&(G=c,w.multiple?G.multiple=!0:w.size&&(G.size=w.size))):c=G.createElementNS(c,p),c[Io]=d,c[_g]=w,Xk(c,d,!1,!1),d.stateNode=c;e:{switch(G=N(p,w),p){case"dialog":ir("cancel",c),ir("close",c),S=w;break;case"iframe":case"object":case"embed":ir("load",c),S=w;break;case"video":case"audio":for(S=0;S<mg.length;S++)ir(mg[S],c);S=w;break;case"source":ir("error",c),S=w;break;case"img":case"image":case"link":ir("error",c),ir("load",c),S=w;break;case"details":ir("toggle",c),S=w;break;case"input":Fn(c,w),S=Bt(c,w),ir("invalid",c);break;case"option":S=w;break;case"select":c._wrapperState={wasMultiple:!!w.multiple},S=Se({},w,{value:void 0}),ir("invalid",c);break;case"textarea":jt(c,w),S=mt(c,w),ir("invalid",c);break;default:S=w}kt(p,S),ie=S;for(A in ie)if(ie.hasOwnProperty(A)){var ae=ie[A];A==="style"?we(c,ae):A==="dangerouslySetInnerHTML"?(ae=ae?ae.__html:void 0,ae!=null&&ai(c,ae)):A==="children"?typeof ae=="string"?(p!=="textarea"||ae!=="")&&Gr(c,ae):typeof ae=="number"&&Gr(c,""+ae):A!=="suppressContentEditableWarning"&&A!=="suppressHydrationWarning"&&A!=="autoFocus"&&(i.hasOwnProperty(A)?ae!=null&&A==="onScroll"&&ir("scroll",c):ae!=null&&I(c,A,ae,G))}switch(p){case"input":Gt(c),Zn(c,w,!1);break;case"textarea":Gt(c),_t(c);break;case"option":w.value!=null&&c.setAttribute("value",""+je(w.value));break;case"select":c.multiple=!!w.multiple,A=w.value,A!=null?Qn(c,!!w.multiple,A,!1):w.defaultValue!=null&&Qn(c,!!w.multiple,w.defaultValue,!0);break;default:typeof S.onClick=="function"&&(c.onclick=Z1)}switch(p){case"button":case"input":case"select":case"textarea":w=!!w.autoFocus;break e;case"img":w=!0;break e;default:w=!1}}w&&(d.flags|=4)}d.ref!==null&&(d.flags|=512,d.flags|=2097152)}return ji(d),null;case 6:if(c&&d.stateNode!=null)Zk(c,d,c.memoizedProps,w);else{if(typeof w!="string"&&d.stateNode===null)throw Error(t(166));if(p=$u(Sg.current),$u(Ao.current),iy(d)){if(w=d.stateNode,p=d.memoizedProps,w[Io]=d,(A=w.nodeValue!==p)&&(c=Gs,c!==null))switch(c.tag){case 3:q1(w.nodeValue,p,(c.mode&1)!==0);break;case 5:c.memoizedProps.suppressHydrationWarning!==!0&&q1(w.nodeValue,p,(c.mode&1)!==0)}A&&(d.flags|=4)}else w=(p.nodeType===9?p:p.ownerDocument).createTextNode(w),w[Io]=d,d.stateNode=w}return ji(d),null;case 13:if(sr(xr),w=d.memoizedState,c===null||c.memoizedState!==null&&c.memoizedState.dehydrated!==null){if(fr&&Bs!==null&&(d.mode&1)!==0&&(d.flags&128)===0)ek(),Hd(),d.flags|=98560,A=!1;else if(A=iy(d),w!==null&&w.dehydrated!==null){if(c===null){if(!A)throw Error(t(318));if(A=d.memoizedState,A=A!==null?A.dehydrated:null,!A)throw Error(t(317));A[Io]=d}else Hd(),(d.flags&128)===0&&(d.memoizedState=null),d.flags|=4;ji(d),A=!1}else Da!==null&&(l2(Da),Da=null),A=!0;if(!A)return d.flags&65536?d:null}return(d.flags&128)!==0?(d.lanes=p,d):(w=w!==null,w!==(c!==null&&c.memoizedState!==null)&&w&&(d.child.flags|=8192,(d.mode&1)!==0&&(c===null||(xr.current&1)!==0?Qr===0&&(Qr=3):h2())),d.updateQueue!==null&&(d.flags|=4),ji(d),null);case 4:return qd(),ZE(c,d),c===null&&pg(d.stateNode.containerInfo),ji(d),null;case 10:return bE(d.type._context),ji(d),null;case 17:return gs(d.type)&&J1(),ji(d),null;case 19:if(sr(xr),A=d.memoizedState,A===null)return ji(d),null;if(w=(d.flags&128)!==0,G=A.rendering,G===null)if(w)Rg(A,!1);else{if(Qr!==0||c!==null&&(c.flags&128)!==0)for(c=d.child;c!==null;){if(G=uy(c),G!==null){for(d.flags|=128,Rg(A,!1),w=G.updateQueue,w!==null&&(d.updateQueue=w,d.flags|=4),d.subtreeFlags=0,w=p,p=d.child;p!==null;)A=p,c=w,A.flags&=14680066,G=A.alternate,G===null?(A.childLanes=0,A.lanes=c,A.child=null,A.subtreeFlags=0,A.memoizedProps=null,A.memoizedState=null,A.updateQueue=null,A.dependencies=null,A.stateNode=null):(A.childLanes=G.childLanes,A.lanes=G.lanes,A.child=G.child,A.subtreeFlags=0,A.deletions=null,A.memoizedProps=G.memoizedProps,A.memoizedState=G.memoizedState,A.updateQueue=G.updateQueue,A.type=G.type,c=G.dependencies,A.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),p=p.sibling;return tr(xr,xr.current&1|2),d.child}c=c.sibling}A.tail!==null&&Xe()>ef&&(d.flags|=128,w=!0,Rg(A,!1),d.lanes=4194304)}else{if(!w)if(c=uy(G),c!==null){if(d.flags|=128,w=!0,p=c.updateQueue,p!==null&&(d.updateQueue=p,d.flags|=4),Rg(A,!0),A.tail===null&&A.tailMode==="hidden"&&!G.alternate&&!fr)return ji(d),null}else 2*Xe()-A.renderingStartTime>ef&&p!==1073741824&&(d.flags|=128,w=!0,Rg(A,!1),d.lanes=4194304);A.isBackwards?(G.sibling=d.child,d.child=G):(p=A.last,p!==null?p.sibling=G:d.child=G,A.last=G)}return A.tail!==null?(d=A.tail,A.rendering=d,A.tail=d.sibling,A.renderingStartTime=Xe(),d.sibling=null,p=xr.current,tr(xr,w?p&1|2:p&1),d):(ji(d),null);case 22:case 23:return u2(),w=d.memoizedState!==null,c!==null&&c.memoizedState!==null!==w&&(d.flags|=8192),w&&(d.mode&1)!==0?(Us&1073741824)!==0&&(ji(d),d.subtreeFlags&6&&(d.flags|=8192)):ji(d),null;case 24:return null;case 25:return null}throw Error(t(156,d.tag))}function oB(c,d){switch(xE(d),d.tag){case 1:return gs(d.type)&&J1(),c=d.flags,c&65536?(d.flags=c&-65537|128,d):null;case 3:return qd(),sr(fs),sr(Di),ME(),c=d.flags,(c&65536)!==0&&(c&128)===0?(d.flags=c&-65537|128,d):null;case 5:return kE(d),null;case 13:if(sr(xr),c=d.memoizedState,c!==null&&c.dehydrated!==null){if(d.alternate===null)throw Error(t(340));Hd()}return c=d.flags,c&65536?(d.flags=c&-65537|128,d):null;case 19:return sr(xr),null;case 4:return qd(),null;case 10:return bE(d.type._context),null;case 22:case 23:return u2(),null;case 24:return null;default:return null}}var xy=!1,Vi=!1,lB=typeof WeakSet=="function"?WeakSet:Set,xt=null;function Qd(c,d){var p=c.ref;if(p!==null)if(typeof p=="function")try{p(null)}catch(w){Tr(c,d,w)}else p.current=null}function QE(c,d,p){try{p()}catch(w){Tr(c,d,w)}}var Qk=!1;function cB(c,d){if(uE=ll,c=kC(),nE(c)){if("selectionStart"in c)var p={start:c.selectionStart,end:c.selectionEnd};else e:{p=(p=c.ownerDocument)&&p.defaultView||window;var w=p.getSelection&&p.getSelection();if(w&&w.rangeCount!==0){p=w.anchorNode;var S=w.anchorOffset,A=w.focusNode;w=w.focusOffset;try{p.nodeType,A.nodeType}catch{p=null;break e}var G=0,ie=-1,ae=-1,Ie=0,He=0,qe=c,ze=null;t:for(;;){for(var yt;qe!==p||S!==0&&qe.nodeType!==3||(ie=G+S),qe!==A||w!==0&&qe.nodeType!==3||(ae=G+w),qe.nodeType===3&&(G+=qe.nodeValue.length),(yt=qe.firstChild)!==null;)ze=qe,qe=yt;for(;;){if(qe===c)break t;if(ze===p&&++Ie===S&&(ie=G),ze===A&&++He===w&&(ae=G),(yt=qe.nextSibling)!==null)break;qe=ze,ze=qe.parentNode}qe=yt}p=ie===-1||ae===-1?null:{start:ie,end:ae}}else p=null}p=p||{start:0,end:0}}else p=null;for(hE={focusedElem:c,selectionRange:p},ll=!1,xt=d;xt!==null;)if(d=xt,c=d.child,(d.subtreeFlags&1028)!==0&&c!==null)c.return=d,xt=c;else for(;xt!==null;){d=xt;try{var wt=d.alternate;if((d.flags&1024)!==0)switch(d.tag){case 0:case 11:case 15:break;case 1:if(wt!==null){var Tt=wt.memoizedProps,Or=wt.memoizedState,ge=d.stateNode,oe=ge.getSnapshotBeforeUpdate(d.elementType===d.type?Tt:Fa(d.type,Tt),Or);ge.__reactInternalSnapshotBeforeUpdate=oe}break;case 3:var xe=d.stateNode.containerInfo;xe.nodeType===1?xe.textContent="":xe.nodeType===9&&xe.documentElement&&xe.removeChild(xe.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Je){Tr(d,d.return,Je)}if(c=d.sibling,c!==null){c.return=d.return,xt=c;break}xt=d.return}return wt=Qk,Qk=!1,wt}function Cg(c,d,p){var w=d.updateQueue;if(w=w!==null?w.lastEffect:null,w!==null){var S=w=w.next;do{if((S.tag&c)===c){var A=S.destroy;S.destroy=void 0,A!==void 0&&QE(d,p,A)}S=S.next}while(S!==w)}}function vy(c,d){if(d=d.updateQueue,d=d!==null?d.lastEffect:null,d!==null){var p=d=d.next;do{if((p.tag&c)===c){var w=p.create;p.destroy=w()}p=p.next}while(p!==d)}}function JE(c){var d=c.ref;if(d!==null){var p=c.stateNode;switch(c.tag){case 5:c=p;break;default:c=p}typeof d=="function"?d(c):d.current=c}}function Jk(c){var d=c.alternate;d!==null&&(c.alternate=null,Jk(d)),c.child=null,c.deletions=null,c.sibling=null,c.tag===5&&(d=c.stateNode,d!==null&&(delete d[Io],delete d[_g],delete d[mE],delete d[WG],delete d[HG])),c.stateNode=null,c.return=null,c.dependencies=null,c.memoizedProps=null,c.memoizedState=null,c.pendingProps=null,c.stateNode=null,c.updateQueue=null}function eP(c){return c.tag===5||c.tag===3||c.tag===4}function tP(c){e:for(;;){for(;c.sibling===null;){if(c.return===null||eP(c.return))return null;c=c.return}for(c.sibling.return=c.return,c=c.sibling;c.tag!==5&&c.tag!==6&&c.tag!==18;){if(c.flags&2||c.child===null||c.tag===4)continue e;c.child.return=c,c=c.child}if(!(c.flags&2))return c.stateNode}}function e2(c,d,p){var w=c.tag;if(w===5||w===6)c=c.stateNode,d?p.nodeType===8?p.parentNode.insertBefore(c,d):p.insertBefore(c,d):(p.nodeType===8?(d=p.parentNode,d.insertBefore(c,p)):(d=p,d.appendChild(c)),p=p._reactRootContainer,p!=null||d.onclick!==null||(d.onclick=Z1));else if(w!==4&&(c=c.child,c!==null))for(e2(c,d,p),c=c.sibling;c!==null;)e2(c,d,p),c=c.sibling}function t2(c,d,p){var w=c.tag;if(w===5||w===6)c=c.stateNode,d?p.insertBefore(c,d):p.appendChild(c);else if(w!==4&&(c=c.child,c!==null))for(t2(c,d,p),c=c.sibling;c!==null;)t2(c,d,p),c=c.sibling}var vi=null,ja=!1;function mc(c,d,p){for(p=p.child;p!==null;)nP(c,d,p),p=p.sibling}function nP(c,d,p){if(Nr&&typeof Nr.onCommitFiberUnmount=="function")try{Nr.onCommitFiberUnmount(Os,p)}catch{}switch(p.tag){case 5:Vi||Qd(p,d);case 6:var w=vi,S=ja;vi=null,mc(c,d,p),vi=w,ja=S,vi!==null&&(ja?(c=vi,p=p.stateNode,c.nodeType===8?c.parentNode.removeChild(p):c.removeChild(p)):vi.removeChild(p.stateNode));break;case 18:vi!==null&&(ja?(c=vi,p=p.stateNode,c.nodeType===8?gE(c.parentNode,p):c.nodeType===1&&gE(c,p),sc(c)):gE(vi,p.stateNode));break;case 4:w=vi,S=ja,vi=p.stateNode.containerInfo,ja=!0,mc(c,d,p),vi=w,ja=S;break;case 0:case 11:case 14:case 15:if(!Vi&&(w=p.updateQueue,w!==null&&(w=w.lastEffect,w!==null))){S=w=w.next;do{var A=S,G=A.destroy;A=A.tag,G!==void 0&&((A&2)!==0||(A&4)!==0)&&QE(p,d,G),S=S.next}while(S!==w)}mc(c,d,p);break;case 1:if(!Vi&&(Qd(p,d),w=p.stateNode,typeof w.componentWillUnmount=="function"))try{w.props=p.memoizedProps,w.state=p.memoizedState,w.componentWillUnmount()}catch(ie){Tr(p,d,ie)}mc(c,d,p);break;case 21:mc(c,d,p);break;case 22:p.mode&1?(Vi=(w=Vi)||p.memoizedState!==null,mc(c,d,p),Vi=w):mc(c,d,p);break;default:mc(c,d,p)}}function rP(c){var d=c.updateQueue;if(d!==null){c.updateQueue=null;var p=c.stateNode;p===null&&(p=c.stateNode=new lB),d.forEach(function(w){var S=_B.bind(null,c,w);p.has(w)||(p.add(w),w.then(S,S))})}}function Va(c,d){var p=d.deletions;if(p!==null)for(var w=0;w<p.length;w++){var S=p[w];try{var A=c,G=d,ie=G;e:for(;ie!==null;){switch(ie.tag){case 5:vi=ie.stateNode,ja=!1;break e;case 3:vi=ie.stateNode.containerInfo,ja=!0;break e;case 4:vi=ie.stateNode.containerInfo,ja=!0;break e}ie=ie.return}if(vi===null)throw Error(t(160));nP(A,G,S),vi=null,ja=!1;var ae=S.alternate;ae!==null&&(ae.return=null),S.return=null}catch(Ie){Tr(S,d,Ie)}}if(d.subtreeFlags&12854)for(d=d.child;d!==null;)iP(d,c),d=d.sibling}function iP(c,d){var p=c.alternate,w=c.flags;switch(c.tag){case 0:case 11:case 14:case 15:if(Va(d,c),Co(c),w&4){try{Cg(3,c,c.return),vy(3,c)}catch(Tt){Tr(c,c.return,Tt)}try{Cg(5,c,c.return)}catch(Tt){Tr(c,c.return,Tt)}}break;case 1:Va(d,c),Co(c),w&512&&p!==null&&Qd(p,p.return);break;case 5:if(Va(d,c),Co(c),w&512&&p!==null&&Qd(p,p.return),c.flags&32){var S=c.stateNode;try{Gr(S,"")}catch(Tt){Tr(c,c.return,Tt)}}if(w&4&&(S=c.stateNode,S!=null)){var A=c.memoizedProps,G=p!==null?p.memoizedProps:A,ie=c.type,ae=c.updateQueue;if(c.updateQueue=null,ae!==null)try{ie==="input"&&A.type==="radio"&&A.name!=null&&Qt(S,A),N(ie,G);var Ie=N(ie,A);for(G=0;G<ae.length;G+=2){var He=ae[G],qe=ae[G+1];He==="style"?we(S,qe):He==="dangerouslySetInnerHTML"?ai(S,qe):He==="children"?Gr(S,qe):I(S,He,qe,Ie)}switch(ie){case"input":ot(S,A);break;case"textarea":Pn(S,A);break;case"select":var ze=S._wrapperState.wasMultiple;S._wrapperState.wasMultiple=!!A.multiple;var yt=A.value;yt!=null?Qn(S,!!A.multiple,yt,!1):ze!==!!A.multiple&&(A.defaultValue!=null?Qn(S,!!A.multiple,A.defaultValue,!0):Qn(S,!!A.multiple,A.multiple?[]:"",!1))}S[_g]=A}catch(Tt){Tr(c,c.return,Tt)}}break;case 6:if(Va(d,c),Co(c),w&4){if(c.stateNode===null)throw Error(t(162));S=c.stateNode,A=c.memoizedProps;try{S.nodeValue=A}catch(Tt){Tr(c,c.return,Tt)}}break;case 3:if(Va(d,c),Co(c),w&4&&p!==null&&p.memoizedState.isDehydrated)try{sc(d.containerInfo)}catch(Tt){Tr(c,c.return,Tt)}break;case 4:Va(d,c),Co(c);break;case 13:Va(d,c),Co(c),S=c.child,S.flags&8192&&(A=S.memoizedState!==null,S.stateNode.isHidden=A,!A||S.alternate!==null&&S.alternate.memoizedState!==null||(i2=Xe())),w&4&&rP(c);break;case 22:if(He=p!==null&&p.memoizedState!==null,c.mode&1?(Vi=(Ie=Vi)||He,Va(d,c),Vi=Ie):Va(d,c),Co(c),w&8192){if(Ie=c.memoizedState!==null,(c.stateNode.isHidden=Ie)&&!He&&(c.mode&1)!==0)for(xt=c,He=c.child;He!==null;){for(qe=xt=He;xt!==null;){switch(ze=xt,yt=ze.child,ze.tag){case 0:case 11:case 14:case 15:Cg(4,ze,ze.return);break;case 1:Qd(ze,ze.return);var wt=ze.stateNode;if(typeof wt.componentWillUnmount=="function"){w=ze,p=ze.return;try{d=w,wt.props=d.memoizedProps,wt.state=d.memoizedState,wt.componentWillUnmount()}catch(Tt){Tr(w,p,Tt)}}break;case 5:Qd(ze,ze.return);break;case 22:if(ze.memoizedState!==null){oP(qe);continue}}yt!==null?(yt.return=ze,xt=yt):oP(qe)}He=He.sibling}e:for(He=null,qe=c;;){if(qe.tag===5){if(He===null){He=qe;try{S=qe.stateNode,Ie?(A=S.style,typeof A.setProperty=="function"?A.setProperty("display","none","important"):A.display="none"):(ie=qe.stateNode,ae=qe.memoizedProps.style,G=ae!=null&&ae.hasOwnProperty("display")?ae.display:null,ie.style.display=Oe("display",G))}catch(Tt){Tr(c,c.return,Tt)}}}else if(qe.tag===6){if(He===null)try{qe.stateNode.nodeValue=Ie?"":qe.memoizedProps}catch(Tt){Tr(c,c.return,Tt)}}else if((qe.tag!==22&&qe.tag!==23||qe.memoizedState===null||qe===c)&&qe.child!==null){qe.child.return=qe,qe=qe.child;continue}if(qe===c)break e;for(;qe.sibling===null;){if(qe.return===null||qe.return===c)break e;He===qe&&(He=null),qe=qe.return}He===qe&&(He=null),qe.sibling.return=qe.return,qe=qe.sibling}}break;case 19:Va(d,c),Co(c),w&4&&rP(c);break;case 21:break;default:Va(d,c),Co(c)}}function Co(c){var d=c.flags;if(d&2){try{e:{for(var p=c.return;p!==null;){if(eP(p)){var w=p;break e}p=p.return}throw Error(t(160))}switch(w.tag){case 5:var S=w.stateNode;w.flags&32&&(Gr(S,""),w.flags&=-33);var A=tP(c);t2(c,A,S);break;case 3:case 4:var G=w.stateNode.containerInfo,ie=tP(c);e2(c,ie,G);break;default:throw Error(t(161))}}catch(ae){Tr(c,c.return,ae)}c.flags&=-3}d&4096&&(c.flags&=-4097)}function uB(c,d,p){xt=c,sP(c)}function sP(c,d,p){for(var w=(c.mode&1)!==0;xt!==null;){var S=xt,A=S.child;if(S.tag===22&&w){var G=S.memoizedState!==null||xy;if(!G){var ie=S.alternate,ae=ie!==null&&ie.memoizedState!==null||Vi;ie=xy;var Ie=Vi;if(xy=G,(Vi=ae)&&!Ie)for(xt=S;xt!==null;)G=xt,ae=G.child,G.tag===22&&G.memoizedState!==null?lP(S):ae!==null?(ae.return=G,xt=ae):lP(S);for(;A!==null;)xt=A,sP(A),A=A.sibling;xt=S,xy=ie,Vi=Ie}aP(c)}else(S.subtreeFlags&8772)!==0&&A!==null?(A.return=S,xt=A):aP(c)}}function aP(c){for(;xt!==null;){var d=xt;if((d.flags&8772)!==0){var p=d.alternate;try{if((d.flags&8772)!==0)switch(d.tag){case 0:case 11:case 15:Vi||vy(5,d);break;case 1:var w=d.stateNode;if(d.flags&4&&!Vi)if(p===null)w.componentDidMount();else{var S=d.elementType===d.type?p.memoizedProps:Fa(d.type,p.memoizedProps);w.componentDidUpdate(S,p.memoizedState,w.__reactInternalSnapshotBeforeUpdate)}var A=d.updateQueue;A!==null&&ok(d,A,w);break;case 3:var G=d.updateQueue;if(G!==null){if(p=null,d.child!==null)switch(d.child.tag){case 5:p=d.child.stateNode;break;case 1:p=d.child.stateNode}ok(d,G,p)}break;case 5:var ie=d.stateNode;if(p===null&&d.flags&4){p=ie;var ae=d.memoizedProps;switch(d.type){case"button":case"input":case"select":case"textarea":ae.autoFocus&&p.focus();break;case"img":ae.src&&(p.src=ae.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(d.memoizedState===null){var Ie=d.alternate;if(Ie!==null){var He=Ie.memoizedState;if(He!==null){var qe=He.dehydrated;qe!==null&&sc(qe)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Vi||d.flags&512&&JE(d)}catch(ze){Tr(d,d.return,ze)}}if(d===c){xt=null;break}if(p=d.sibling,p!==null){p.return=d.return,xt=p;break}xt=d.return}}function oP(c){for(;xt!==null;){var d=xt;if(d===c){xt=null;break}var p=d.sibling;if(p!==null){p.return=d.return,xt=p;break}xt=d.return}}function lP(c){for(;xt!==null;){var d=xt;try{switch(d.tag){case 0:case 11:case 15:var p=d.return;try{vy(4,d)}catch(ae){Tr(d,p,ae)}break;case 1:var w=d.stateNode;if(typeof w.componentDidMount=="function"){var S=d.return;try{w.componentDidMount()}catch(ae){Tr(d,S,ae)}}var A=d.return;try{JE(d)}catch(ae){Tr(d,A,ae)}break;case 5:var G=d.return;try{JE(d)}catch(ae){Tr(d,G,ae)}}}catch(ae){Tr(d,d.return,ae)}if(d===c){xt=null;break}var ie=d.sibling;if(ie!==null){ie.return=d.return,xt=ie;break}xt=d.return}}var hB=Math.ceil,wy=M.ReactCurrentDispatcher,n2=M.ReactCurrentOwner,da=M.ReactCurrentBatchConfig,_n=0,li=null,Ur=null,wi=0,Us=0,Jd=uc(0),Qr=0,kg=null,Hu=0,Ey=0,r2=0,Pg=null,ps=null,i2=0,ef=1/0,_l=null,Sy=!1,s2=null,pc=null,Ty=!1,yc=null,by=0,Mg=0,a2=null,Iy=-1,Ay=0;function ns(){return(_n&6)!==0?Xe():Iy!==-1?Iy:Iy=Xe()}function _c(c){return(c.mode&1)===0?1:(_n&2)!==0&&wi!==0?wi&-wi:YG.transition!==null?(Ay===0&&(Ay=J0()),Ay):(c=gn,c!==0||(c=window.event,c=c===void 0?16:Cd(c.type)),c)}function Ga(c,d,p,w){if(50<Mg)throw Mg=0,a2=null,Error(t(185));Lu(c,p,w),((_n&2)===0||c!==li)&&(c===li&&((_n&2)===0&&(Ey|=p),Qr===4&&xc(c,wi)),ys(c,w),p===1&&_n===0&&(d.mode&1)===0&&(ef=Xe()+500,ty&&dc()))}function ys(c,d){var p=c.callbackNode;Nu(c,d);var w=sl(c,c===li?wi:0);if(w===0)p!==null&&tt(p),c.callbackNode=null,c.callbackPriority=0;else if(d=w&-w,c.callbackPriority!==d){if(p!=null&&tt(p),d===1)c.tag===0?KG(uP.bind(null,c)):XC(uP.bind(null,c)),zG(function(){(_n&6)===0&&dc()}),p=null;else{switch(po(w)){case 1:p=Mn;break;case 4:p=jn;break;case 16:p=dr;break;case 536870912:p=aa;break;default:p=dr}p=_P(p,cP.bind(null,c))}c.callbackPriority=d,c.callbackNode=p}}function cP(c,d){if(Iy=-1,Ay=0,(_n&6)!==0)throw Error(t(327));var p=c.callbackNode;if(tf()&&c.callbackNode!==p)return null;var w=sl(c,c===li?wi:0);if(w===0)return null;if((w&30)!==0||(w&c.expiredLanes)!==0||d)d=Ry(c,w);else{d=w;var S=_n;_n|=2;var A=dP();(li!==c||wi!==d)&&(_l=null,ef=Xe()+500,Yu(c,d));do try{gB();break}catch(ie){hP(c,ie)}while(!0);TE(),wy.current=A,_n=S,Ur!==null?d=0:(li=null,wi=0,d=Qr)}if(d!==0){if(d===2&&(S=Q0(c),S!==0&&(w=S,d=o2(c,S))),d===1)throw p=kg,Yu(c,0),xc(c,w),ys(c,Xe()),p;if(d===6)xc(c,w);else{if(S=c.current.alternate,(w&30)===0&&!dB(S)&&(d=Ry(c,w),d===2&&(A=Q0(c),A!==0&&(w=A,d=o2(c,A))),d===1))throw p=kg,Yu(c,0),xc(c,w),ys(c,Xe()),p;switch(c.finishedWork=S,c.finishedLanes=w,d){case 0:case 1:throw Error(t(345));case 2:Xu(c,ps,_l);break;case 3:if(xc(c,w),(w&130023424)===w&&(d=i2+500-Xe(),10<d)){if(sl(c,0)!==0)break;if(S=c.suspendedLanes,(S&w)!==w){ns(),c.pingedLanes|=c.suspendedLanes&S;break}c.timeoutHandle=fE(Xu.bind(null,c,ps,_l),d);break}Xu(c,ps,_l);break;case 4:if(xc(c,w),(w&4194240)===w)break;for(d=c.eventTimes,S=-1;0<w;){var G=31-_r(w);A=1<<G,G=d[G],G>S&&(S=G),w&=~A}if(w=S,w=Xe()-w,w=(120>w?120:480>w?480:1080>w?1080:1920>w?1920:3e3>w?3e3:4320>w?4320:1960*hB(w/1960))-w,10<w){c.timeoutHandle=fE(Xu.bind(null,c,ps,_l),w);break}Xu(c,ps,_l);break;case 5:Xu(c,ps,_l);break;default:throw Error(t(329))}}}return ys(c,Xe()),c.callbackNode===p?cP.bind(null,c):null}function o2(c,d){var p=Pg;return c.current.memoizedState.isDehydrated&&(Yu(c,d).flags|=256),c=Ry(c,d),c!==2&&(d=ps,ps=p,d!==null&&l2(d)),c}function l2(c){ps===null?ps=c:ps.push.apply(ps,c)}function dB(c){for(var d=c;;){if(d.flags&16384){var p=d.updateQueue;if(p!==null&&(p=p.stores,p!==null))for(var w=0;w<p.length;w++){var S=p[w],A=S.getSnapshot;S=S.value;try{if(!Oa(A(),S))return!1}catch{return!1}}}if(p=d.child,d.subtreeFlags&16384&&p!==null)p.return=d,d=p;else{if(d===c)break;for(;d.sibling===null;){if(d.return===null||d.return===c)return!0;d=d.return}d.sibling.return=d.return,d=d.sibling}}return!0}function xc(c,d){for(d&=~r2,d&=~Ey,c.suspendedLanes|=d,c.pingedLanes&=~d,c=c.expirationTimes;0<d;){var p=31-_r(d),w=1<<p;c[p]=-1,d&=~w}}function uP(c){if((_n&6)!==0)throw Error(t(327));tf();var d=sl(c,0);if((d&1)===0)return ys(c,Xe()),null;var p=Ry(c,d);if(c.tag!==0&&p===2){var w=Q0(c);w!==0&&(d=w,p=o2(c,w))}if(p===1)throw p=kg,Yu(c,0),xc(c,d),ys(c,Xe()),p;if(p===6)throw Error(t(345));return c.finishedWork=c.current.alternate,c.finishedLanes=d,Xu(c,ps,_l),ys(c,Xe()),null}function c2(c,d){var p=_n;_n|=1;try{return c(d)}finally{_n=p,_n===0&&(ef=Xe()+500,ty&&dc())}}function Ku(c){yc!==null&&yc.tag===0&&(_n&6)===0&&tf();var d=_n;_n|=1;var p=da.transition,w=gn;try{if(da.transition=null,gn=1,c)return c()}finally{gn=w,da.transition=p,_n=d,(_n&6)===0&&dc()}}function u2(){Us=Jd.current,sr(Jd)}function Yu(c,d){c.finishedWork=null,c.finishedLanes=0;var p=c.timeoutHandle;if(p!==-1&&(c.timeoutHandle=-1,UG(p)),Ur!==null)for(p=Ur.return;p!==null;){var w=p;switch(xE(w),w.tag){case 1:w=w.type.childContextTypes,w!=null&&J1();break;case 3:qd(),sr(fs),sr(Di),ME();break;case 5:kE(w);break;case 4:qd();break;case 13:sr(xr);break;case 19:sr(xr);break;case 10:bE(w.type._context);break;case 22:case 23:u2()}p=p.return}if(li=c,Ur=c=vc(c.current,null),wi=Us=d,Qr=0,kg=null,r2=Ey=Hu=0,ps=Pg=null,zu!==null){for(d=0;d<zu.length;d++)if(p=zu[d],w=p.interleaved,w!==null){p.interleaved=null;var S=w.next,A=p.pending;if(A!==null){var G=A.next;A.next=S,w.next=G}p.pending=w}zu=null}return c}function hP(c,d){do{var p=Ur;try{if(TE(),hy.current=my,dy){for(var w=vr.memoizedState;w!==null;){var S=w.queue;S!==null&&(S.pending=null),w=w.next}dy=!1}if(Wu=0,oi=Zr=vr=null,Tg=!1,bg=0,n2.current=null,p===null||p.return===null){Qr=1,kg=d,Ur=null;break}e:{var A=c,G=p.return,ie=p,ae=d;if(d=wi,ie.flags|=32768,ae!==null&&typeof ae=="object"&&typeof ae.then=="function"){var Ie=ae,He=ie,qe=He.tag;if((He.mode&1)===0&&(qe===0||qe===11||qe===15)){var ze=He.alternate;ze?(He.updateQueue=ze.updateQueue,He.memoizedState=ze.memoizedState,He.lanes=ze.lanes):(He.updateQueue=null,He.memoizedState=null)}var yt=Dk(G);if(yt!==null){yt.flags&=-257,Fk(yt,G,ie,A,d),yt.mode&1&&Ok(A,Ie,d),d=yt,ae=Ie;var wt=d.updateQueue;if(wt===null){var Tt=new Set;Tt.add(ae),d.updateQueue=Tt}else wt.add(ae);break e}else{if((d&1)===0){Ok(A,Ie,d),h2();break e}ae=Error(t(426))}}else if(fr&&ie.mode&1){var Or=Dk(G);if(Or!==null){(Or.flags&65536)===0&&(Or.flags|=256),Fk(Or,G,ie,A,d),EE(Zd(ae,ie));break e}}A=ae=Zd(ae,ie),Qr!==4&&(Qr=2),Pg===null?Pg=[A]:Pg.push(A),A=G;do{switch(A.tag){case 3:A.flags|=65536,d&=-d,A.lanes|=d;var ge=Nk(A,ae,d);ak(A,ge);break e;case 1:ie=ae;var oe=A.type,xe=A.stateNode;if((A.flags&128)===0&&(typeof oe.getDerivedStateFromError=="function"||xe!==null&&typeof xe.componentDidCatch=="function"&&(pc===null||!pc.has(xe)))){A.flags|=65536,d&=-d,A.lanes|=d;var Je=Lk(A,ie,d);ak(A,Je);break e}}A=A.return}while(A!==null)}gP(p)}catch(It){d=It,Ur===p&&p!==null&&(Ur=p=p.return);continue}break}while(!0)}function dP(){var c=wy.current;return wy.current=my,c===null?my:c}function h2(){(Qr===0||Qr===3||Qr===2)&&(Qr=4),li===null||(Hu&268435455)===0&&(Ey&268435455)===0||xc(li,wi)}function Ry(c,d){var p=_n;_n|=2;var w=dP();(li!==c||wi!==d)&&(_l=null,Yu(c,d));do try{fB();break}catch(S){hP(c,S)}while(!0);if(TE(),_n=p,wy.current=w,Ur!==null)throw Error(t(261));return li=null,wi=0,Qr}function fB(){for(;Ur!==null;)fP(Ur)}function gB(){for(;Ur!==null&&!gt();)fP(Ur)}function fP(c){var d=yP(c.alternate,c,Us);c.memoizedProps=c.pendingProps,d===null?gP(c):Ur=d,n2.current=null}function gP(c){var d=c;do{var p=d.alternate;if(c=d.return,(d.flags&32768)===0){if(p=aB(p,d,Us),p!==null){Ur=p;return}}else{if(p=oB(p,d),p!==null){p.flags&=32767,Ur=p;return}if(c!==null)c.flags|=32768,c.subtreeFlags=0,c.deletions=null;else{Qr=6,Ur=null;return}}if(d=d.sibling,d!==null){Ur=d;return}Ur=d=c}while(d!==null);Qr===0&&(Qr=5)}function Xu(c,d,p){var w=gn,S=da.transition;try{da.transition=null,gn=1,mB(c,d,p,w)}finally{da.transition=S,gn=w}return null}function mB(c,d,p,w){do tf();while(yc!==null);if((_n&6)!==0)throw Error(t(327));p=c.finishedWork;var S=c.finishedLanes;if(p===null)return null;if(c.finishedWork=null,c.finishedLanes=0,p===c.current)throw Error(t(177));c.callbackNode=null,c.callbackPriority=0;var A=p.lanes|p.childLanes;if(Zw(c,A),c===li&&(Ur=li=null,wi=0),(p.subtreeFlags&2064)===0&&(p.flags&2064)===0||Ty||(Ty=!0,_P(dr,function(){return tf(),null})),A=(p.flags&15990)!==0,(p.subtreeFlags&15990)!==0||A){A=da.transition,da.transition=null;var G=gn;gn=1;var ie=_n;_n|=4,n2.current=null,cB(c,p),iP(p,c),OG(hE),ll=!!uE,hE=uE=null,c.current=p,uB(p),Ye(),_n=ie,gn=G,da.transition=A}else c.current=p;if(Ty&&(Ty=!1,yc=c,by=S),A=c.pendingLanes,A===0&&(pc=null),tc(p.stateNode),ys(c,Xe()),d!==null)for(w=c.onRecoverableError,p=0;p<d.length;p++)S=d[p],w(S.value,{componentStack:S.stack,digest:S.digest});if(Sy)throw Sy=!1,c=s2,s2=null,c;return(by&1)!==0&&c.tag!==0&&tf(),A=c.pendingLanes,(A&1)!==0?c===a2?Mg++:(Mg=0,a2=c):Mg=0,dc(),null}function tf(){if(yc!==null){var c=po(by),d=da.transition,p=gn;try{if(da.transition=null,gn=16>c?16:c,yc===null)var w=!1;else{if(c=yc,yc=null,by=0,(_n&6)!==0)throw Error(t(331));var S=_n;for(_n|=4,xt=c.current;xt!==null;){var A=xt,G=A.child;if((xt.flags&16)!==0){var ie=A.deletions;if(ie!==null){for(var ae=0;ae<ie.length;ae++){var Ie=ie[ae];for(xt=Ie;xt!==null;){var He=xt;switch(He.tag){case 0:case 11:case 15:Cg(8,He,A)}var qe=He.child;if(qe!==null)qe.return=He,xt=qe;else for(;xt!==null;){He=xt;var ze=He.sibling,yt=He.return;if(Jk(He),He===Ie){xt=null;break}if(ze!==null){ze.return=yt,xt=ze;break}xt=yt}}}var wt=A.alternate;if(wt!==null){var Tt=wt.child;if(Tt!==null){wt.child=null;do{var Or=Tt.sibling;Tt.sibling=null,Tt=Or}while(Tt!==null)}}xt=A}}if((A.subtreeFlags&2064)!==0&&G!==null)G.return=A,xt=G;else e:for(;xt!==null;){if(A=xt,(A.flags&2048)!==0)switch(A.tag){case 0:case 11:case 15:Cg(9,A,A.return)}var ge=A.sibling;if(ge!==null){ge.return=A.return,xt=ge;break e}xt=A.return}}var oe=c.current;for(xt=oe;xt!==null;){G=xt;var xe=G.child;if((G.subtreeFlags&2064)!==0&&xe!==null)xe.return=G,xt=xe;else e:for(G=oe;xt!==null;){if(ie=xt,(ie.flags&2048)!==0)try{switch(ie.tag){case 0:case 11:case 15:vy(9,ie)}}catch(It){Tr(ie,ie.return,It)}if(ie===G){xt=null;break e}var Je=ie.sibling;if(Je!==null){Je.return=ie.return,xt=Je;break e}xt=ie.return}}if(_n=S,dc(),Nr&&typeof Nr.onPostCommitFiberRoot=="function")try{Nr.onPostCommitFiberRoot(Os,c)}catch{}w=!0}return w}finally{gn=p,da.transition=d}}return!1}function mP(c,d,p){d=Zd(p,d),d=Nk(c,d,1),c=gc(c,d,1),d=ns(),c!==null&&(Lu(c,1,d),ys(c,d))}function Tr(c,d,p){if(c.tag===3)mP(c,c,p);else for(;d!==null;){if(d.tag===3){mP(d,c,p);break}else if(d.tag===1){var w=d.stateNode;if(typeof d.type.getDerivedStateFromError=="function"||typeof w.componentDidCatch=="function"&&(pc===null||!pc.has(w))){c=Zd(p,c),c=Lk(d,c,1),d=gc(d,c,1),c=ns(),d!==null&&(Lu(d,1,c),ys(d,c));break}}d=d.return}}function pB(c,d,p){var w=c.pingCache;w!==null&&w.delete(d),d=ns(),c.pingedLanes|=c.suspendedLanes&p,li===c&&(wi&p)===p&&(Qr===4||Qr===3&&(wi&130023424)===wi&&500>Xe()-i2?Yu(c,0):r2|=p),ys(c,d)}function pP(c,d){d===0&&((c.mode&1)===0?d=1:(d=nc,nc<<=1,(nc&130023424)===0&&(nc=4194304)));var p=ns();c=ml(c,d),c!==null&&(Lu(c,d,p),ys(c,p))}function yB(c){var d=c.memoizedState,p=0;d!==null&&(p=d.retryLane),pP(c,p)}function _B(c,d){var p=0;switch(c.tag){case 13:var w=c.stateNode,S=c.memoizedState;S!==null&&(p=S.retryLane);break;case 19:w=c.stateNode;break;default:throw Error(t(314))}w!==null&&w.delete(d),pP(c,p)}var yP;yP=function(c,d,p){if(c!==null)if(c.memoizedProps!==d.pendingProps||fs.current)ms=!0;else{if((c.lanes&p)===0&&(d.flags&128)===0)return ms=!1,sB(c,d,p);ms=(c.flags&131072)!==0}else ms=!1,fr&&(d.flags&1048576)!==0&&qC(d,ry,d.index);switch(d.lanes=0,d.tag){case 2:var w=d.type;_y(c,d),c=d.pendingProps;var S=zd(d,Di.current);Xd(d,p),S=OE(null,d,w,c,S,p);var A=DE();return d.flags|=1,typeof S=="object"&&S!==null&&typeof S.render=="function"&&S.$$typeof===void 0?(d.tag=1,d.memoizedState=null,d.updateQueue=null,gs(w)?(A=!0,ey(d)):A=!1,d.memoizedState=S.state!==null&&S.state!==void 0?S.state:null,RE(d),S.updater=py,d.stateNode=S,S._reactInternals=d,UE(d,w,c,p),d=HE(null,d,w,!0,A,p)):(d.tag=0,fr&&A&&_E(d),ts(null,d,S,p),d=d.child),d;case 16:w=d.elementType;e:{switch(_y(c,d),c=d.pendingProps,S=w._init,w=S(w._payload),d.type=w,S=d.tag=vB(w),c=Fa(w,c),S){case 0:d=WE(null,d,w,c,p);break e;case 1:d=zk(null,d,w,c,p);break e;case 11:d=jk(null,d,w,c,p);break e;case 14:d=Vk(null,d,w,Fa(w.type,c),p);break e}throw Error(t(306,w,""))}return d;case 0:return w=d.type,S=d.pendingProps,S=d.elementType===w?S:Fa(w,S),WE(c,d,w,S,p);case 1:return w=d.type,S=d.pendingProps,S=d.elementType===w?S:Fa(w,S),zk(c,d,w,S,p);case 3:e:{if($k(d),c===null)throw Error(t(387));w=d.pendingProps,A=d.memoizedState,S=A.element,sk(c,d),cy(d,w,null,p);var G=d.memoizedState;if(w=G.element,A.isDehydrated)if(A={element:w,isDehydrated:!1,cache:G.cache,pendingSuspenseBoundaries:G.pendingSuspenseBoundaries,transitions:G.transitions},d.updateQueue.baseState=A,d.memoizedState=A,d.flags&256){S=Zd(Error(t(423)),d),d=Wk(c,d,w,p,S);break e}else if(w!==S){S=Zd(Error(t(424)),d),d=Wk(c,d,w,p,S);break e}else for(Bs=cc(d.stateNode.containerInfo.firstChild),Gs=d,fr=!0,Da=null,p=rk(d,null,w,p),d.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling;else{if(Hd(),w===S){d=yl(c,d,p);break e}ts(c,d,w,p)}d=d.child}return d;case 5:return lk(d),c===null&&wE(d),w=d.type,S=d.pendingProps,A=c!==null?c.memoizedProps:null,G=S.children,dE(w,S)?G=null:A!==null&&dE(w,A)&&(d.flags|=32),Uk(c,d),ts(c,d,G,p),d.child;case 6:return c===null&&wE(d),null;case 13:return Hk(c,d,p);case 4:return CE(d,d.stateNode.containerInfo),w=d.pendingProps,c===null?d.child=Kd(d,null,w,p):ts(c,d,w,p),d.child;case 11:return w=d.type,S=d.pendingProps,S=d.elementType===w?S:Fa(w,S),jk(c,d,w,S,p);case 7:return ts(c,d,d.pendingProps,p),d.child;case 8:return ts(c,d,d.pendingProps.children,p),d.child;case 12:return ts(c,d,d.pendingProps.children,p),d.child;case 10:e:{if(w=d.type._context,S=d.pendingProps,A=d.memoizedProps,G=S.value,tr(ay,w._currentValue),w._currentValue=G,A!==null)if(Oa(A.value,G)){if(A.children===S.children&&!fs.current){d=yl(c,d,p);break e}}else for(A=d.child,A!==null&&(A.return=d);A!==null;){var ie=A.dependencies;if(ie!==null){G=A.child;for(var ae=ie.firstContext;ae!==null;){if(ae.context===w){if(A.tag===1){ae=pl(-1,p&-p),ae.tag=2;var Ie=A.updateQueue;if(Ie!==null){Ie=Ie.shared;var He=Ie.pending;He===null?ae.next=ae:(ae.next=He.next,He.next=ae),Ie.pending=ae}}A.lanes|=p,ae=A.alternate,ae!==null&&(ae.lanes|=p),IE(A.return,p,d),ie.lanes|=p;break}ae=ae.next}}else if(A.tag===10)G=A.type===d.type?null:A.child;else if(A.tag===18){if(G=A.return,G===null)throw Error(t(341));G.lanes|=p,ie=G.alternate,ie!==null&&(ie.lanes|=p),IE(G,p,d),G=A.sibling}else G=A.child;if(G!==null)G.return=A;else for(G=A;G!==null;){if(G===d){G=null;break}if(A=G.sibling,A!==null){A.return=G.return,G=A;break}G=G.return}A=G}ts(c,d,S.children,p),d=d.child}return d;case 9:return S=d.type,w=d.pendingProps.children,Xd(d,p),S=ua(S),w=w(S),d.flags|=1,ts(c,d,w,p),d.child;case 14:return w=d.type,S=Fa(w,d.pendingProps),S=Fa(w.type,S),Vk(c,d,w,S,p);case 15:return Gk(c,d,d.type,d.pendingProps,p);case 17:return w=d.type,S=d.pendingProps,S=d.elementType===w?S:Fa(w,S),_y(c,d),d.tag=1,gs(w)?(c=!0,ey(d)):c=!1,Xd(d,p),Pk(d,w,S),UE(d,w,S,p),HE(null,d,w,!0,c,p);case 19:return Yk(c,d,p);case 22:return Bk(c,d,p)}throw Error(t(156,d.tag))};function _P(c,d){return Ke(c,d)}function xB(c,d,p,w){this.tag=c,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=d,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=w,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function fa(c,d,p,w){return new xB(c,d,p,w)}function d2(c){return c=c.prototype,!(!c||!c.isReactComponent)}function vB(c){if(typeof c=="function")return d2(c)?1:0;if(c!=null){if(c=c.$$typeof,c===U)return 11;if(c===Ce)return 14}return 2}function vc(c,d){var p=c.alternate;return p===null?(p=fa(c.tag,d,c.key,c.mode),p.elementType=c.elementType,p.type=c.type,p.stateNode=c.stateNode,p.alternate=c,c.alternate=p):(p.pendingProps=d,p.type=c.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=c.flags&14680064,p.childLanes=c.childLanes,p.lanes=c.lanes,p.child=c.child,p.memoizedProps=c.memoizedProps,p.memoizedState=c.memoizedState,p.updateQueue=c.updateQueue,d=c.dependencies,p.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext},p.sibling=c.sibling,p.index=c.index,p.ref=c.ref,p}function Cy(c,d,p,w,S,A){var G=2;if(w=c,typeof c=="function")d2(c)&&(G=1);else if(typeof c=="string")G=5;else e:switch(c){case P:return qu(p.children,S,A,d);case C:G=8,S|=8;break;case k:return c=fa(12,p,d,S|2),c.elementType=k,c.lanes=A,c;case j:return c=fa(13,p,d,S),c.elementType=j,c.lanes=A,c;case Te:return c=fa(19,p,d,S),c.elementType=Te,c.lanes=A,c;case Ne:return ky(p,S,A,d);default:if(typeof c=="object"&&c!==null)switch(c.$$typeof){case L:G=10;break e;case O:G=9;break e;case U:G=11;break e;case Ce:G=14;break e;case Ue:G=16,w=null;break e}throw Error(t(130,c==null?c:typeof c,""))}return d=fa(G,p,d,S),d.elementType=c,d.type=w,d.lanes=A,d}function qu(c,d,p,w){return c=fa(7,c,w,d),c.lanes=p,c}function ky(c,d,p,w){return c=fa(22,c,w,d),c.elementType=Ne,c.lanes=p,c.stateNode={isHidden:!1},c}function f2(c,d,p){return c=fa(6,c,null,d),c.lanes=p,c}function g2(c,d,p){return d=fa(4,c.children!==null?c.children:[],c.key,d),d.lanes=p,d.stateNode={containerInfo:c.containerInfo,pendingChildren:null,implementation:c.implementation},d}function wB(c,d,p,w,S){this.tag=d,this.containerInfo=c,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=eg(0),this.expirationTimes=eg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=eg(0),this.identifierPrefix=w,this.onRecoverableError=S,this.mutableSourceEagerHydrationData=null}function m2(c,d,p,w,S,A,G,ie,ae){return c=new wB(c,d,p,ie,ae),d===1?(d=1,A===!0&&(d|=8)):d=0,A=fa(3,null,null,d),c.current=A,A.stateNode=c,A.memoizedState={element:w,isDehydrated:p,cache:null,transitions:null,pendingSuspenseBoundaries:null},RE(A),c}function EB(c,d,p){var w=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:z,key:w==null?null:""+w,children:c,containerInfo:d,implementation:p}}function xP(c){if(!c)return hc;c=c._reactInternals;e:{if(te(c)!==c||c.tag!==1)throw Error(t(170));var d=c;do{switch(d.tag){case 3:d=d.stateNode.context;break e;case 1:if(gs(d.type)){d=d.stateNode.__reactInternalMemoizedMergedChildContext;break e}}d=d.return}while(d!==null);throw Error(t(171))}if(c.tag===1){var p=c.type;if(gs(p))return KC(c,p,d)}return d}function vP(c,d,p,w,S,A,G,ie,ae){return c=m2(p,w,!0,c,S,A,G,ie,ae),c.context=xP(null),p=c.current,w=ns(),S=_c(p),A=pl(w,S),A.callback=d??null,gc(p,A,S),c.current.lanes=S,Lu(c,S,w),ys(c,w),c}function Py(c,d,p,w){var S=d.current,A=ns(),G=_c(S);return p=xP(p),d.context===null?d.context=p:d.pendingContext=p,d=pl(A,G),d.payload={element:c},w=w===void 0?null:w,w!==null&&(d.callback=w),c=gc(S,d,G),c!==null&&(Ga(c,S,G,A),ly(c,S,G)),G}function My(c){if(c=c.current,!c.child)return null;switch(c.child.tag){case 5:return c.child.stateNode;default:return c.child.stateNode}}function wP(c,d){if(c=c.memoizedState,c!==null&&c.dehydrated!==null){var p=c.retryLane;c.retryLane=p!==0&&p<d?p:d}}function p2(c,d){wP(c,d),(c=c.alternate)&&wP(c,d)}function SB(){return null}var EP=typeof reportError=="function"?reportError:function(c){console.error(c)};function y2(c){this._internalRoot=c}Ny.prototype.render=y2.prototype.render=function(c){var d=this._internalRoot;if(d===null)throw Error(t(409));Py(c,d,null,null)},Ny.prototype.unmount=y2.prototype.unmount=function(){var c=this._internalRoot;if(c!==null){this._internalRoot=null;var d=c.containerInfo;Ku(function(){Py(null,c,null,null)}),d[hl]=null}};function Ny(c){this._internalRoot=c}Ny.prototype.unstable_scheduleHydration=function(c){if(c){var d=ig();c={blockedOn:null,target:c,priority:d};for(var p=0;p<Ds.length&&d!==0&&d<Ds[p].priority;p++);Ds.splice(p,0,c),p===0&&Ad(c)}};function _2(c){return!(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)}function Ly(c){return!(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11&&(c.nodeType!==8||c.nodeValue!==" react-mount-point-unstable "))}function SP(){}function TB(c,d,p,w,S){if(S){if(typeof w=="function"){var A=w;w=function(){var Ie=My(G);A.call(Ie)}}var G=vP(d,w,c,0,null,!1,!1,"",SP);return c._reactRootContainer=G,c[hl]=G.current,pg(c.nodeType===8?c.parentNode:c),Ku(),G}for(;S=c.lastChild;)c.removeChild(S);if(typeof w=="function"){var ie=w;w=function(){var Ie=My(ae);ie.call(Ie)}}var ae=m2(c,0,!1,null,null,!1,!1,"",SP);return c._reactRootContainer=ae,c[hl]=ae.current,pg(c.nodeType===8?c.parentNode:c),Ku(function(){Py(d,ae,p,w)}),ae}function Oy(c,d,p,w,S){var A=p._reactRootContainer;if(A){var G=A;if(typeof S=="function"){var ie=S;S=function(){var ae=My(G);ie.call(ae)}}Py(d,G,c,S)}else G=TB(p,d,c,S,w);return My(G)}ng=function(c){switch(c.tag){case 3:var d=c.stateNode;if(d.current.memoizedState.isDehydrated){var p=In(d.pendingLanes);p!==0&&(tg(d,p|1),ys(d,Xe()),(_n&6)===0&&(ef=Xe()+500,dc()))}break;case 13:Ku(function(){var w=ml(c,1);if(w!==null){var S=ns();Ga(w,c,1,S)}}),p2(c,1)}},bd=function(c){if(c.tag===13){var d=ml(c,134217728);if(d!==null){var p=ns();Ga(d,c,134217728,p)}p2(c,134217728)}},rg=function(c){if(c.tag===13){var d=_c(c),p=ml(c,d);if(p!==null){var w=ns();Ga(p,c,d,w)}p2(c,d)}},ig=function(){return gn},sg=function(c,d){var p=gn;try{return gn=c,d()}finally{gn=p}},Z=function(c,d,p){switch(d){case"input":if(ot(c,p),d=p.name,p.type==="radio"&&d!=null){for(p=c;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll("input[name="+JSON.stringify(""+d)+'][type="radio"]'),d=0;d<p.length;d++){var w=p[d];if(w!==c&&w.form===c.form){var S=Q1(w);if(!S)throw Error(t(90));Kt(w),ot(w,S)}}}break;case"textarea":Pn(c,p);break;case"select":d=p.value,d!=null&&Qn(c,!!p.multiple,d,!1)}},$e=c2,et=Ku;var bB={usingClientEntryPoint:!1,Events:[xg,Bd,Q1,Ve,be,c2]},Ng={findFiberByHostInstance:Vu,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},IB={bundleType:Ng.bundleType,version:Ng.version,rendererPackageName:Ng.rendererPackageName,rendererConfig:Ng.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:M.ReactCurrentDispatcher,findHostInstanceByFiber:function(c){return c=ve(c),c===null?null:c.stateNode},findFiberByHostInstance:Ng.findFiberByHostInstance||SB,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Dy=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Dy.isDisabled&&Dy.supportsFiber)try{Os=Dy.inject(IB),Nr=Dy}catch{}}return _s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=bB,_s.createPortal=function(c,d){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!_2(d))throw Error(t(200));return EB(c,d,null,p)},_s.createRoot=function(c,d){if(!_2(c))throw Error(t(299));var p=!1,w="",S=EP;return d!=null&&(d.unstable_strictMode===!0&&(p=!0),d.identifierPrefix!==void 0&&(w=d.identifierPrefix),d.onRecoverableError!==void 0&&(S=d.onRecoverableError)),d=m2(c,1,!1,null,null,p,!1,w,S),c[hl]=d.current,pg(c.nodeType===8?c.parentNode:c),new y2(d)},_s.findDOMNode=function(c){if(c==null)return null;if(c.nodeType===1)return c;var d=c._reactInternals;if(d===void 0)throw typeof c.render=="function"?Error(t(188)):(c=Object.keys(c).join(","),Error(t(268,c)));return c=ve(d),c=c===null?null:c.stateNode,c},_s.flushSync=function(c){return Ku(c)},_s.hydrate=function(c,d,p){if(!Ly(d))throw Error(t(200));return Oy(null,c,d,!0,p)},_s.hydrateRoot=function(c,d,p){if(!_2(c))throw Error(t(405));var w=p!=null&&p.hydratedSources||null,S=!1,A="",G=EP;if(p!=null&&(p.unstable_strictMode===!0&&(S=!0),p.identifierPrefix!==void 0&&(A=p.identifierPrefix),p.onRecoverableError!==void 0&&(G=p.onRecoverableError)),d=vP(d,null,c,1,p??null,S,!1,A,G),c[hl]=d.current,pg(c),w)for(c=0;c<w.length;c++)p=w[c],S=p._getVersion,S=S(p._source),d.mutableSourceEagerHydrationData==null?d.mutableSourceEagerHydrationData=[p,S]:d.mutableSourceEagerHydrationData.push(p,S);return new Ny(d)},_s.render=function(c,d,p){if(!Ly(d))throw Error(t(200));return Oy(null,c,d,!1,p)},_s.unmountComponentAtNode=function(c){if(!Ly(c))throw Error(t(40));return c._reactRootContainer?(Ku(function(){Oy(null,null,c,!1,function(){c._reactRootContainer=null,c[hl]=null})}),!0):!1},_s.unstable_batchedUpdates=c2,_s.unstable_renderSubtreeIntoContainer=function(c,d,p,w){if(!Ly(p))throw Error(t(200));if(c==null||c._reactInternals===void 0)throw Error(t(38));return Oy(c,d,p,!1,w)},_s.version="18.3.1-next-f1338f8080-20240426",_s}var PP;function LB(){if(PP)return w2.exports;PP=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),w2.exports=NB(),w2.exports}var MP;function OB(){if(MP)return Fy;MP=1;var n=LB();return Fy.createRoot=n.createRoot,Fy.hydrateRoot=n.hydrateRoot,Fy}var DB=OB();const FB=Kb(DB);var ne=Vp();const jB=Kb(ne),ws={ADD:"add",REMOVE:"remove"},o0={PROPERTYCHANGE:"propertychange"},Yt={CHANGE:"change",ERROR:"error",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",TOUCHMOVE:"touchmove",WHEEL:"wheel"};class Rv{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function VB(n,e,t){let r,i;t=t||Cl;let s=0,a=n.length,o=!1;for(;s<a;)r=s+(a-s>>1),i=+t(n[r],e),i<0?s=r+1:(a=r,o=!i);return o?s:~s}function Cl(n,e){return n>e?1:n<e?-1:0}function GB(n,e){return n<e?1:n>e?-1:0}function Cv(n,e,t){if(n[0]<=e)return 0;const r=n.length;if(e<=n[r-1])return r-1;if(typeof t=="function"){for(let i=1;i<r;++i){const s=n[i];if(s===e)return i;if(s<e)return t(e,n[i-1],s)>0?i-1:i}return r-1}if(t>0){for(let i=1;i<r;++i)if(n[i]<e)return i-1;return r-1}if(t<0){for(let i=1;i<r;++i)if(n[i]<=e)return i;return r-1}for(let i=1;i<r;++i){if(n[i]==e)return i;if(n[i]<e)return n[i-1]-e<e-n[i]?i-1:i}return r-1}function BB(n,e,t){for(;e<t;){const r=n[e];n[e]=n[t],n[t]=r,++e,--t}}function Nn(n,e){const t=Array.isArray(e)?e:[e],r=t.length;for(let i=0;i<r;i++)n[n.length]=t[i]}function Su(n,e){const t=n.length;if(t!==e.length)return!1;for(let r=0;r<t;r++)if(n[r]!==e[r])return!1;return!0}function UB(n,e,t){const r=e||Cl;return n.every(function(i,s){if(s===0)return!0;const a=r(n[s-1],i);return!(a>0||a===0)})}function Wm(){return!0}function kv(){return!1}function Hm(){}function VO(n){let e,t,r;return function(){const i=Array.prototype.slice.call(arguments);return(!t||this!==r||!Su(i,t))&&(r=this,t=i,e=n.apply(this,arguments)),e}}function GO(n){function e(){let t;try{t=n()}catch(r){return Promise.reject(r)}return t instanceof Promise?t:Promise.resolve(t)}return e()}function Gp(n){for(const e in n)delete n[e]}function Lh(n){let e;for(e in n)return!1;return!e}class tl{constructor(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}let Bp=class extends Rv{constructor(e){super(),this.eventTarget_=e,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(e,t){if(!e||!t)return;const r=this.listeners_||(this.listeners_={}),i=r[e]||(r[e]=[]);i.includes(t)||i.push(t)}dispatchEvent(e){const t=typeof e=="string",r=t?e:e.type,i=this.listeners_&&this.listeners_[r];if(!i)return;const s=t?new tl(e):e;s.target||(s.target=this.eventTarget_||this);const a=this.dispatching_||(this.dispatching_={}),o=this.pendingRemovals_||(this.pendingRemovals_={});r in a||(a[r]=0,o[r]=0),++a[r];let l;for(let u=0,h=i.length;u<h;++u)if("handleEvent"in i[u]?l=i[u].handleEvent(s):l=i[u].call(this,s),l===!1||s.propagationStopped){l=!1;break}if(--a[r]===0){let u=o[r];for(delete o[r];u--;)this.removeEventListener(r,Hm);delete a[r]}return l}disposeInternal(){this.listeners_&&Gp(this.listeners_)}getListeners(e){return this.listeners_&&this.listeners_[e]||void 0}hasListener(e){return this.listeners_?e?e in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(e,t){if(!this.listeners_)return;const r=this.listeners_[e];if(!r)return;const i=r.indexOf(t);i!==-1&&(this.pendingRemovals_&&e in this.pendingRemovals_?(r[i]=Hm,++this.pendingRemovals_[e]):(r.splice(i,1),r.length===0&&delete this.listeners_[e]))}};function yn(n,e,t,r,i){if(i){const a=t;t=function(o){return n.removeEventListener(e,t),a.call(r??this,o)}}else r&&r!==n&&(t=t.bind(r));const s={target:n,type:e,listener:t};return n.addEventListener(e,t),s}function Q_(n,e,t,r){return yn(n,e,t,r,!0)}function nr(n){n&&n.target&&(n.target.removeEventListener(n.type,n.listener),Gp(n))}class Up extends Bp{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(Yt.CHANGE)}getRevision(){return this.revision_}onInternal(e,t){if(Array.isArray(e)){const r=e.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=yn(this,e[s],t);return i}return yn(this,e,t)}onceInternal(e,t){let r;if(Array.isArray(e)){const i=e.length;r=new Array(i);for(let s=0;s<i;++s)r[s]=Q_(this,e[s],t)}else r=Q_(this,e,t);return t.ol_key=r,r}unInternal(e,t){const r=t.ol_key;if(r)zB(r);else if(Array.isArray(e))for(let i=0,s=e.length;i<s;++i)this.removeEventListener(e[i],t);else this.removeEventListener(e,t)}}Up.prototype.on;Up.prototype.once;Up.prototype.un;function zB(n){if(Array.isArray(n))for(let e=0,t=n.length;e<t;++e)nr(n[e]);else nr(n)}function Vt(){throw new Error("Unimplemented abstract method.")}let $B=0;function bn(n){return n.ol_uid||(n.ol_uid=String(++$B))}class NP extends tl{constructor(e,t,r){super(e),this.key=t,this.oldValue=r}}class nl extends Up{constructor(e){super(),this.on,this.once,this.un,bn(this),this.values_=null,e!==void 0&&this.setProperties(e)}get(e){let t;return this.values_&&this.values_.hasOwnProperty(e)&&(t=this.values_[e]),t}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(e,t){let r;r=`change:${e}`,this.hasListener(r)&&this.dispatchEvent(new NP(r,e,t)),r=o0.PROPERTYCHANGE,this.hasListener(r)&&this.dispatchEvent(new NP(r,e,t))}addChangeListener(e,t){this.addEventListener(`change:${e}`,t)}removeChangeListener(e,t){this.removeEventListener(`change:${e}`,t)}set(e,t,r){const i=this.values_||(this.values_={});if(r)i[e]=t;else{const s=i[e];i[e]=t,s!==t&&this.notify(e,s)}}setProperties(e,t){for(const r in e)this.set(r,e[r],t)}applyProperties(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}unset(e,t){if(this.values_&&e in this.values_){const r=this.values_[e];delete this.values_[e],Lh(this.values_)&&(this.values_=null),t||this.notify(e,r)}}}const LP={LENGTH:"length"};class jy extends tl{constructor(e,t,r){super(e),this.element=t,this.index=r}}class wa extends nl{constructor(e,t){if(super(),this.on,this.once,this.un,t=t||{},this.unique_=!!t.unique,this.array_=e??[],this.unique_)for(let r=1,i=this.array_.length;r<i;++r)this.assertUnique_(this.array_[r],r);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(e){for(let t=0,r=e.length;t<r;++t)this.push(e[t]);return this}forEach(e){const t=this.array_;for(let r=0,i=t.length;r<i;++r)e(t[r],r,t)}getArray(){return this.array_}item(e){return this.array_[e]}getLength(){return this.get(LP.LENGTH)}insertAt(e,t){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t),this.array_.splice(e,0,t),this.updateLength_(),this.dispatchEvent(new jy(ws.ADD,t,e))}pop(){return this.removeAt(this.getLength()-1)}push(e){const t=this.getLength();return this.insertAt(t,e),this.getLength()}remove(e){const t=this.array_;for(let r=0,i=t.length;r<i;++r)if(t[r]===e)return this.removeAt(r)}removeAt(e){if(e<0||e>=this.getLength())return;const t=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new jy(ws.REMOVE,t,e)),t}setAt(e,t){const r=this.getLength();if(e>=r){this.insertAt(e,t);return}if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t,e);const i=this.array_[e];this.array_[e]=t,this.dispatchEvent(new jy(ws.REMOVE,i,e)),this.dispatchEvent(new jy(ws.ADD,t,e))}updateLength_(){this.set(LP.LENGTH,this.array_.length)}assertUnique_(e,t){const r=this.array_;for(let i=0,s=r.length;i<s;++i)if(r[i]===e&&i!==t)throw new Error("Duplicate item added to a unique collection")}}function Dn(n,e){if(!n)throw new Error(e)}let Cs=class BO extends nl{constructor(e){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),e)if(typeof e.getSimplifiedGeometry=="function"){const t=e;this.setGeometry(t)}else{const t=e;this.setProperties(t)}}clone(){const e=new BO(this.hasProperties()?this.getProperties():null);e.setGeometryName(this.getGeometryName());const t=this.getGeometry();t&&e.setGeometry(t.clone());const r=this.getStyle();return r&&e.setStyle(r),e}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(nr(this.geometryChangeKey_),this.geometryChangeKey_=null);const e=this.getGeometry();e&&(this.geometryChangeKey_=yn(e,Yt.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(e){this.set(this.geometryName_,e)}setStyle(e){this.style_=e,this.styleFunction_=e?WB(e):void 0,this.changed()}setId(e){this.id_=e,this.changed()}setGeometryName(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}};function WB(n){if(typeof n=="function")return n;let e;return Array.isArray(n)?e=n:(Dn(typeof n.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[n]),function(){return e}}const ui={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function OP(n){const e=ea();for(let t=0,r=n.length;t<r;++t)gm(e,n[t]);return e}function Km(n,e,t){return t?(t[0]=n[0]-e,t[1]=n[1]-e,t[2]=n[2]+e,t[3]=n[3]+e,t):[n[0]-e,n[1]-e,n[2]+e,n[3]+e]}function UO(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n.slice()}function sd(n,e,t){let r,i;return e<n[0]?r=n[0]-e:n[2]<e?r=e-n[2]:r=0,t<n[1]?i=n[1]-t:n[3]<t?i=t-n[3]:i=0,r*r+i*i}function Oh(n,e){return Yb(n,e[0],e[1])}function Uc(n,e){return n[0]<=e[0]&&e[2]<=n[2]&&n[1]<=e[1]&&e[3]<=n[3]}function Yb(n,e,t){return n[0]<=e&&e<=n[2]&&n[1]<=t&&t<=n[3]}function ZS(n,e){const t=n[0],r=n[1],i=n[2],s=n[3],a=e[0],o=e[1];let l=ui.UNKNOWN;return a<t?l=l|ui.LEFT:a>i&&(l=l|ui.RIGHT),o<r?l=l|ui.BELOW:o>s&&(l=l|ui.ABOVE),l===ui.UNKNOWN&&(l=ui.INTERSECTING),l}function ea(){return[1/0,1/0,-1/0,-1/0]}function lu(n,e,t,r,i){return i?(i[0]=n,i[1]=e,i[2]=t,i[3]=r,i):[n,e,t,r]}function zp(n){return lu(1/0,1/0,-1/0,-1/0,n)}function zO(n,e){const t=n[0],r=n[1];return lu(t,r,t,r,e)}function Xb(n,e,t,r,i){const s=zp(i);return WO(s,n,e,t,r)}function l0(n,e){return n[0]==e[0]&&n[2]==e[2]&&n[1]==e[1]&&n[3]==e[3]}function $O(n,e){return e[0]<n[0]&&(n[0]=e[0]),e[2]>n[2]&&(n[2]=e[2]),e[1]<n[1]&&(n[1]=e[1]),e[3]>n[3]&&(n[3]=e[3]),n}function gm(n,e){e[0]<n[0]&&(n[0]=e[0]),e[0]>n[2]&&(n[2]=e[0]),e[1]<n[1]&&(n[1]=e[1]),e[1]>n[3]&&(n[3]=e[1])}function WO(n,e,t,r,i){for(;t<r;t+=i)HB(n,e[t],e[t+1]);return n}function HB(n,e,t){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}function HO(n,e){let t;return t=e(Pv(n)),t||(t=e(Mv(n)),t)||(t=e(Nv(n)),t)||(t=e(ad(n)),t)?t:!1}function QS(n){let e=0;return L0(n)||(e=un(n)*Wr(n)),e}function Pv(n){return[n[0],n[1]]}function Mv(n){return[n[2],n[1]]}function Yo(n){return[(n[0]+n[2])/2,(n[1]+n[3])/2]}function KB(n,e){let t;if(e==="bottom-left")t=Pv(n);else if(e==="bottom-right")t=Mv(n);else if(e==="top-left")t=ad(n);else if(e==="top-right")t=Nv(n);else throw new Error("Invalid corner");return t}function J_(n,e,t,r,i){const[s,a,o,l,u,h,f,g]=KO(n,e,t,r);return lu(Math.min(s,o,u,f),Math.min(a,l,h,g),Math.max(s,o,u,f),Math.max(a,l,h,g),i)}function KO(n,e,t,r){const i=e*r[0]/2,s=e*r[1]/2,a=Math.cos(t),o=Math.sin(t),l=i*a,u=i*o,h=s*a,f=s*o,g=n[0],y=n[1];return[g-l+f,y-u-h,g-l-f,y-u+h,g+l-f,y+u+h,g+l+f,y+u-h,g-l+f,y-u-h]}function Wr(n){return n[3]-n[1]}function kl(n,e,t){const r=t||ea();return os(n,e)?(n[0]>e[0]?r[0]=n[0]:r[0]=e[0],n[1]>e[1]?r[1]=n[1]:r[1]=e[1],n[2]<e[2]?r[2]=n[2]:r[2]=e[2],n[3]<e[3]?r[3]=n[3]:r[3]=e[3]):zp(r),r}function ad(n){return[n[0],n[3]]}function Nv(n){return[n[2],n[3]]}function un(n){return n[2]-n[0]}function os(n,e){return n[0]<=e[2]&&n[2]>=e[0]&&n[1]<=e[3]&&n[3]>=e[1]}function L0(n){return n[2]<n[0]||n[3]<n[1]}function YB(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n}function XB(n,e,t){let r=!1;const i=ZS(n,e),s=ZS(n,t);if(i===ui.INTERSECTING||s===ui.INTERSECTING)r=!0;else{const a=n[0],o=n[1],l=n[2],u=n[3],h=e[0],f=e[1],g=t[0],y=t[1],v=(y-f)/(g-h);let x,E;s&ui.ABOVE&&!(i&ui.ABOVE)&&(x=g-(y-u)/v,r=x>=a&&x<=l),!r&&s&ui.RIGHT&&!(i&ui.RIGHT)&&(E=y-(g-l)*v,r=E>=o&&E<=u),!r&&s&ui.BELOW&&!(i&ui.BELOW)&&(x=g-(y-o)/v,r=x>=a&&x<=l),!r&&s&ui.LEFT&&!(i&ui.LEFT)&&(E=y-(g-a)*v,r=E>=o&&E<=u)}return r}function YO(n,e){const t=e.getExtent(),r=Yo(n);if(e.canWrapX()&&(r[0]<t[0]||r[0]>=t[2])){const i=un(t),a=Math.floor((r[0]-t[0])/i)*i;n[0]-=a,n[2]-=a}return n}function XO(n,e,t){if(e.canWrapX()){const r=e.getExtent();if(!isFinite(n[0])||!isFinite(n[2]))return[[r[0],n[1],r[2],n[3]]];YO(n,e);const i=un(r);if(un(n)>i&&!t)return[[r[0],n[1],r[2],n[3]]];if(n[0]<r[0])return[[n[0]+i,n[1],r[2],n[3]],[r[0],n[1],n[2],n[3]]];if(n[2]>r[2])return[[n[0],n[1],r[2],n[3]],[r[0],n[1],n[2]-i,n[3]]]}return[n]}function ar(n,e,t){return Math.min(Math.max(n,e),t)}function qB(n,e,t,r,i,s){const a=i-t,o=s-r;if(a!==0||o!==0){const l=((n-t)*a+(e-r)*o)/(a*a+o*o);l>1?(t=i,r=s):l>0&&(t+=a*l,r+=o*l)}return Ih(n,e,t,r)}function Ih(n,e,t,r){const i=t-n,s=r-e;return i*i+s*s}function ZB(n){const e=n.length;for(let r=0;r<e;r++){let i=r,s=Math.abs(n[r][r]);for(let o=r+1;o<e;o++){const l=Math.abs(n[o][r]);l>s&&(s=l,i=o)}if(s===0)return null;const a=n[i];n[i]=n[r],n[r]=a;for(let o=r+1;o<e;o++){const l=-n[o][r]/n[r][r];for(let u=r;u<e+1;u++)r==u?n[o][u]=0:n[o][u]+=l*n[r][u]}}const t=new Array(e);for(let r=e-1;r>=0;r--){t[r]=n[r][e]/n[r][r];for(let i=r-1;i>=0;i--)n[i][e]-=n[i][r]*t[r]}return t}function DP(n){return n*180/Math.PI}function Pl(n){return n*Math.PI/180}function Jc(n,e){const t=n%e;return t*e<0?t+e:t}function Hs(n,e,t){return n+t*(e-n)}function $p(n,e){const t=Math.pow(10,e);return Math.round(n*t)/t}function ex(n,e){return Math.round($p(n,e))}function Vy(n,e){return Math.floor($p(n,e))}function zc(n,e){return Math.ceil($p(n,e))}function JS(n,e,t){if(n>=e&&n<t)return n;const r=t-e;return((n-e)%r+r)%r+e}function Og(n,e,t){const r=""+n;let i=r.indexOf(".");return i=i===-1?r.length:i,i>e?r:new Array(1+e-i).join("0")+r}function qO(n,e){const t=(""+n).split("."),r=(""+e).split(".");for(let i=0;i<Math.max(t.length,r.length);i++){const s=parseInt(t[i]||"0",10),a=parseInt(r[i]||"0",10);if(s>a)return 1;if(a>s)return-1}return 0}function QB(n,e){return n[0]+=+e[0],n[1]+=+e[1],n}function tx(n,e){let t=!0;for(let r=n.length-1;r>=0;--r)if(n[r]!=e[r]){t=!1;break}return t}function qb(n,e){const t=Math.cos(e),r=Math.sin(e),i=n[0]*t-n[1]*r,s=n[1]*t+n[0]*r;return n[0]=i,n[1]=s,n}function JB(n,e){return n[0]*=e,n[1]*=e,n}function ZO(n,e){if(e.canWrapX()){const t=un(e.getExtent()),r=QO(n,e,t);r&&(n[0]-=r*t)}return n}function QO(n,e,t){const r=e.getExtent();let i=0;return e.canWrapX()&&(n[0]<r[0]||n[0]>r[2])&&(t=t||un(r),i=Math.floor((n[0]-r[0])/t)),i}function JO(...n){console.warn(...n)}const c0={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};let Lv=class{constructor(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||c0[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(e){this.defaultTileGrid_=e}setExtent(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)}setWorldExtent(e){this.worldExtent_=e}setGetPointResolution(e){this.getPointResolutionFunc_=e}getPointResolutionFunc(){return this.getPointResolutionFunc_}};const Wp=6378137,Mf=Math.PI*Wp,eU=[-Mf,-Mf,Mf,Mf],tU=[-180,-85,180,85],Gy=Wp*Math.log(Math.tan(Math.PI/2));class nf extends Lv{constructor(e){super({code:e,units:"m",extent:eU,global:!0,worldExtent:tU,getPointResolution:function(t,r){return t/Math.cosh(r[1]/Wp)}})}}const FP=[new nf("EPSG:3857"),new nf("EPSG:102100"),new nf("EPSG:102113"),new nf("EPSG:900913"),new nf("http://www.opengis.net/def/crs/EPSG/0/3857"),new nf("http://www.opengis.net/gml/srs/epsg.xml#3857")];function nU(n,e,t,r){const i=n.length;t=t>1?t:2,r=r??t,e===void 0&&(t>2?e=n.slice():e=new Array(i));for(let s=0;s<i;s+=r){e[s]=Mf*n[s]/180;let a=Wp*Math.log(Math.tan(Math.PI*(+n[s+1]+90)/360));a>Gy?a=Gy:a<-Gy&&(a=-Gy),e[s+1]=a}return e}function rU(n,e,t,r){const i=n.length;t=t>1?t:2,r=r??t,e===void 0&&(t>2?e=n.slice():e=new Array(i));for(let s=0;s<i;s+=r)e[s]=180*n[s]/Mf,e[s+1]=360*Math.atan(Math.exp(n[s+1]/Wp))/Math.PI-90;return e}const iU=6378137,jP=[-180,-90,180,90],sU=Math.PI*iU/180;class Zu extends Lv{constructor(e,t){super({code:e,units:"degrees",extent:jP,axisOrientation:t,global:!0,metersPerUnit:sU,worldExtent:jP})}}const VP=[new Zu("CRS:84"),new Zu("EPSG:4326","neu"),new Zu("urn:ogc:def:crs:OGC:1.3:CRS84"),new Zu("urn:ogc:def:crs:OGC:2:84"),new Zu("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new Zu("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Zu("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let eT={};function T_(n){return eT[n]||eT[n.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function aU(n,e){eT[n]=e}let zf={};function Dh(n,e,t){const r=n.getCode(),i=e.getCode();r in zf||(zf[r]={}),zf[r][i]=t}function b_(n,e){return n in zf&&e in zf[n]?zf[n][e]:null}const nx=.9996,ba=.00669438,Ov=ba*ba,Dv=Ov*ba,yh=ba/(1-ba),GP=Math.sqrt(1-ba),u0=(1-GP)/(1+GP),e5=u0*u0,Zb=e5*u0,Qb=Zb*u0,t5=Qb*u0,n5=1-ba/4-3*Ov/64-5*Dv/256,oU=3*ba/8+3*Ov/32+45*Dv/1024,lU=15*Ov/256+45*Dv/1024,cU=35*Dv/3072,uU=3/2*u0-27/32*Zb+269/512*t5,hU=21/16*e5-55/32*Qb,dU=151/96*Zb-417/128*t5,fU=1097/512*Qb,rx=6378137;function gU(n,e,t){const r=n-5e5,a=(t.north?e:e-1e7)/nx/(rx*n5),o=a+uU*Math.sin(2*a)+hU*Math.sin(4*a)+dU*Math.sin(6*a)+fU*Math.sin(8*a),l=Math.sin(o),u=l*l,h=Math.cos(o),f=l/h,g=f*f,y=g*g,v=1-ba*u,x=Math.sqrt(1-ba*u),E=rx/x,T=(1-ba)/v,b=yh*h**2,I=b*b,M=r/(E*nx),F=M*M,z=F*M,P=z*M,C=P*M,k=C*M,L=o-f/T*(F/2-P/24*(5+3*g+10*b-4*I-9*yh))+k/720*(61+90*g+298*b+45*y-252*yh-3*I);let O=(M-z/6*(1+2*g+b)+C/120*(5-2*b+28*g-3*I+8*yh+24*y))/h;return O=JS(O+Pl(r5(t.number)),-Math.PI,Math.PI),[DP(O),DP(L)]}const BP=-80,UP=84,mU=-180,pU=180;function yU(n,e,t){n=JS(n,mU,pU),e<BP?e=BP:e>UP&&(e=UP);const r=Pl(e),i=Math.sin(r),s=Math.cos(r),a=i/s,o=a*a,l=o*o,u=Pl(n),h=r5(t.number),f=Pl(h),g=rx/Math.sqrt(1-ba*i**2),y=yh*s**2,v=s*JS(u-f,-Math.PI,Math.PI),x=v*v,E=x*v,T=E*v,b=T*v,I=b*v,M=rx*(n5*r-oU*Math.sin(2*r)+lU*Math.sin(4*r)-cU*Math.sin(6*r)),F=nx*g*(v+E/6*(1-o+y)+b/120*(5-18*o+l+72*y-58*yh))+5e5;let z=nx*(M+g*a*(x/2+T/24*(5-o+9*y+4*y**2)+I/720*(61-58*o+l+600*y-330*yh)));return t.north||(z+=1e7),[F,z]}function r5(n){return(n-1)*6-180+3}const _U=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function i5(n){let e=0;for(const i of _U){const s=n.match(i);if(s){e=parseInt(s[1]);break}}if(!e)return null;let t=0,r=!1;return e>32700&&e<32761?t=e-32700:e>32600&&e<32661&&(r=!0,t=e-32600),t?{number:t,north:r}:null}function zP(n,e){return function(t,r,i,s){const a=t.length;i=i>1?i:2,s=s??i,r||(i>2?r=t.slice():r=new Array(a));for(let o=0;o<a;o+=s){const l=t[o],u=t[o+1],h=n(l,u,e);r[o]=h[0],r[o+1]=h[1]}return r}}function xU(n){return i5(n)?new Lv({code:n,units:"m"}):null}function vU(n){const e=i5(n.getCode());return e?{forward:zP(yU,e),inverse:zP(gU,e)}:null}const wU=63710088e-1;function $P(n,e,t){t=t||wU;const r=Pl(n[1]),i=Pl(e[1]),s=(i-r)/2,a=Pl(e[0]-n[0])/2,o=Math.sin(s)*Math.sin(s)+Math.sin(a)*Math.sin(a)*Math.cos(r)*Math.cos(i);return 2*t*Math.atan2(Math.sqrt(o),Math.sqrt(1-o))}const EU=[vU],SU=[xU];let tT=!0;function s5(n){tT=!1}function Jb(n,e){if(e!==void 0){for(let t=0,r=n.length;t<r;++t)e[t]=n[t];e=e}else e=n.slice();return e}function ix(n){aU(n.getCode(),n),Dh(n,n,Jb)}function TU(n){n.forEach(ix)}function qn(n){if(typeof n!="string")return n;const e=T_(n);if(e)return e;for(const t of SU){const r=t(n);if(r)return r}return null}function sx(n,e,t,r){n=qn(n);let i;const s=n.getPointResolutionFunc();if(s){if(i=s(e,t),r&&r!==n.getUnits()){const a=n.getMetersPerUnit();a&&(i=i*a/c0[r])}}else{const a=n.getUnits();if(a=="degrees"&&!r||r=="degrees")i=e;else{const o=tI(n,qn("EPSG:4326"));if(!o&&a!=="degrees")i=e*n.getMetersPerUnit();else{let u=[t[0]-e/2,t[1],t[0]+e/2,t[1],t[0],t[1]-e/2,t[0],t[1]+e/2];u=o(u,u,2);const h=$P(u.slice(0,2),u.slice(2,4)),f=$P(u.slice(4,6),u.slice(6,8));i=(h+f)/2}const l=r?c0[r]:n.getMetersPerUnit();l!==void 0&&(i/=l)}}return i}function nT(n){TU(n),n.forEach(function(e){n.forEach(function(t){e!==t&&Dh(e,t,Jb)})})}function bU(n,e,t,r){n.forEach(function(i){e.forEach(function(s){Dh(i,s,t),Dh(s,i,r)})})}function eI(n,e){return n?typeof n=="string"?qn(n):n:qn(e)}function rT(n){return(function(e,t,r,i){const s=e.length;r=r!==void 0?r:2,i=i??r,t=t!==void 0?t:new Array(s);for(let a=0;a<s;a+=i){const o=n(e.slice(a,a+r)),l=o.length;for(let u=0,h=i;u<h;++u)t[a+u]=u>=l?e[a+u]:o[u]}return t})}function IU(n,e,t,r){const i=qn(n),s=qn(e);Dh(i,s,rT(t)),Dh(s,i,rT(r))}function oo(n,e){return s5(),Hp(n,"EPSG:4326","EPSG:3857")}function xn(n,e){const t=Hp(n,"EPSG:3857","EPSG:4326"),r=t[0];return(r<-180||r>180)&&(t[0]=Jc(r+180,360)-180),t}function Ah(n,e){if(n===e)return!0;const t=n.getUnits()===e.getUnits();return(n.getCode()===e.getCode()||tI(n,e)===Jb)&&t}function tI(n,e){const t=n.getCode(),r=e.getCode();let i=b_(t,r);if(i)return i;let s=null,a=null;for(const l of EU)s||(s=l(n)),a||(a=l(e));if(!s&&!a)return null;const o="EPSG:4326";if(a)if(s)i=T2(s.inverse,a.forward);else{const l=b_(t,o);l&&(i=T2(l,a.forward))}else{const l=b_(o,r);l&&(i=T2(s.inverse,l))}return i&&(ix(n),ix(e),Dh(n,e,i)),i}function T2(n,e){return function(t,r,i,s){return r=n(t,r,i,s),e(r,r,i,s)}}function Ym(n,e){const t=qn(n),r=qn(e);return tI(t,r)}function Hp(n,e,t){const r=Ym(e,t);if(!r){const i=qn(e).getCode(),s=qn(t).getCode();throw new Error(`No transform available between ${i} and ${s}`)}return r(n,void 0,n.length)}function iT(n,e){return n}function wl(n,e){return tT&&!tx(n,[0,0])&&n[0]>=-180&&n[0]<=180&&n[1]>=-90&&n[1]<=90&&(tT=!1,JO("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),n}function a5(n,e){return n}function Do(n,e){return n}function WP(n,e,t){return function(r){let i,s;if(n.canWrapX()){const a=n.getExtent(),o=un(a);r=r.slice(0),s=QO(r,n,o),s&&(r[0]=r[0]-s*o),r[0]=ar(r[0],a[0],a[2]),r[1]=ar(r[1],a[1],a[3]),i=t(r)}else i=t(r);return s&&e.canWrapX()&&(i[0]+=s*un(e.getExtent())),i}}function AU(){nT(FP),nT(VP),bU(VP,FP,nU,rU)}AU();new Array(6);function to(){return[1,0,0,1,0,0]}function RU(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n}function ni(n,e){const t=e[0],r=e[1];return e[0]=n[0]*t+n[2]*r+n[4],e[1]=n[1]*t+n[3]*r+n[5],e}function Xo(n,e,t,r,i,s,a,o){const l=Math.sin(s),u=Math.cos(s);return n[0]=r*u,n[1]=i*l,n[2]=-r*l,n[3]=i*u,n[4]=a*r*u-o*r*l+e,n[5]=a*i*l+o*i*u+t,n}function o5(n,e){const t=CU(e);Dn(t!==0,"Transformation matrix cannot be inverted");const r=e[0],i=e[1],s=e[2],a=e[3],o=e[4],l=e[5];return n[0]=a/t,n[1]=-i/t,n[2]=-s/t,n[3]=r/t,n[4]=(s*l-a*o)/t,n[5]=-(r*l-i*o)/t,n}function CU(n){return n[0]*n[3]-n[1]*n[2]}const kU=[1e5,1e5,1e5,1e5,2,2];function PU(n){return"matrix("+n.join(", ")+")"}function sT(n){return n.substring(7,n.length-1).split(",").map(parseFloat)}function MU(n,e){const t=sT(n),r=sT(e);for(let i=0;i<6;++i)if(Math.round((t[i]-r[i])*kU[i])!==0)return!1;return!0}function eu(n,e,t,r,i,s,a){s=s||[],a=a||2;let o=0;for(let l=e;l<t;l+=r){const u=n[l],h=n[l+1];s[o++]=i[0]*u+i[2]*h+i[4],s[o++]=i[1]*u+i[3]*h+i[5];for(let f=2;f<a;f++)s[o++]=n[l+f]}return s&&s.length!=o&&(s.length=o),s}function l5(n,e,t,r,i,s,a){a=a||[];const o=Math.cos(i),l=Math.sin(i),u=s[0],h=s[1];let f=0;for(let g=e;g<t;g+=r){const y=n[g]-u,v=n[g+1]-h;a[f++]=u+y*o-v*l,a[f++]=h+y*l+v*o;for(let x=g+2;x<g+r;++x)a[f++]=n[x]}return a&&a.length!=f&&(a.length=f),a}function NU(n,e,t,r,i,s,a,o){o=o||[];const l=a[0],u=a[1];let h=0;for(let f=e;f<t;f+=r){const g=n[f]-l,y=n[f+1]-u;o[h++]=l+i*g,o[h++]=u+s*y;for(let v=f+2;v<f+r;++v)o[h++]=n[v]}return o&&o.length!=h&&(o.length=h),o}function LU(n,e,t,r,i,s,a){a=a||[];let o=0;for(let l=e;l<t;l+=r){a[o++]=n[l]+i,a[o++]=n[l+1]+s;for(let u=l+2;u<l+r;++u)a[o++]=n[u]}return a&&a.length!=o&&(a.length=o),a}const HP=to(),OU=[NaN,NaN];class c5 extends nl{constructor(){super(),this.extent_=ea(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=VO((e,t,r)=>{if(!r)return this.getSimplifiedGeometry(t);const i=this.clone();return i.applyTransform(r),i.getSimplifiedGeometry(t)})}simplifyTransformed(e,t){return this.simplifyTransformedInternal(this.getRevision(),e,t)}clone(){return Vt()}closestPointXY(e,t,r,i){return Vt()}containsXY(e,t){return this.closestPointXY(e,t,OU,Number.MIN_VALUE)===0}getClosestPoint(e,t){return t=t||[NaN,NaN],this.closestPointXY(e[0],e[1],t,1/0),t}intersectsCoordinate(e){return this.containsXY(e[0],e[1])}computeExtent(e){return Vt()}getExtent(e){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&zp(t),this.extentRevision_=this.getRevision()}return YB(this.extent_,e)}rotate(e,t){Vt()}scale(e,t,r){Vt()}simplify(e){return this.getSimplifiedGeometry(e*e)}getSimplifiedGeometry(e){return Vt()}getType(){return Vt()}applyTransform(e){Vt()}intersectsExtent(e){return Vt()}translate(e,t){Vt()}transform(e,t){const r=qn(e),i=r.getUnits()=="tile-pixels"?function(s,a,o){const l=r.getExtent(),u=r.getWorldExtent(),h=Wr(u)/Wr(l);Xo(HP,u[0],u[3],h,-h,0,0,0);const f=eu(s,0,s.length,o,HP,a),g=Ym(r,t);return g?g(f,f,o):f}:Ym(r,t);return this.applyTransform(i),this}}class od extends c5{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(e){return Xb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinates(){return Vt()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=this.getSimplifiedGeometryInternal(e);return t.getFlatCoordinates().length<this.flatCoordinates.length?t:(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getSimplifiedGeometryInternal(e){return this}getStride(){return this.stride}setFlatCoordinates(e,t){this.stride=KP(e),this.layout=e,this.flatCoordinates=t}setCoordinates(e,t){Vt()}setLayout(e,t,r){let i;if(e)i=KP(e);else{for(let s=0;s<r;++s){if(t.length===0){this.layout="XY",this.stride=2;return}t=t[0]}i=t.length,e=ld(i)}this.layout=e,this.stride=i}applyTransform(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(e,t){const r=this.getFlatCoordinates();if(r){const i=this.getStride();l5(r,0,r.length,i,e,t,r),this.changed()}}scale(e,t,r){t===void 0&&(t=e),r||(r=Yo(this.getExtent()));const i=this.getFlatCoordinates();if(i){const s=this.getStride();NU(i,0,i.length,s,e,t,r,i),this.changed()}}translate(e,t){const r=this.getFlatCoordinates();if(r){const i=this.getStride();LU(r,0,r.length,i,e,t,r),this.changed()}}}function ld(n){let e;return n==2?e="XY":n==3?e="XYZ":n==4&&(e="XYZM"),e}function KP(n){let e;return n=="XY"?e=2:n=="XYZ"||n=="XYM"?e=3:n=="XYZM"&&(e=4),e}function DU(n,e,t){const r=n.getFlatCoordinates();if(!r)return null;const i=n.getStride();return eu(r,0,r.length,i,e,t)}function YP(n,e,t,r,i,s,a){const o=n[e],l=n[e+1],u=n[t]-o,h=n[t+1]-l;let f;if(u===0&&h===0)f=e;else{const g=((i-o)*u+(s-l)*h)/(u*u+h*h);if(g>1)f=t;else if(g>0){for(let y=0;y<r;++y)a[y]=Hs(n[e+y],n[t+y],g);a.length=r;return}else f=e}for(let g=0;g<r;++g)a[g]=n[f+g];a.length=r}function nI(n,e,t,r,i){let s=n[e],a=n[e+1];for(e+=r;e<t;e+=r){const o=n[e],l=n[e+1],u=Ih(s,a,o,l);u>i&&(i=u),s=o,a=l}return i}function rI(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){const o=t[s];i=nI(n,e,o,r,i),e=o}return i}function FU(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){const o=t[s];i=rI(n,e,o,r,i),e=o[o.length-1]}return i}function iI(n,e,t,r,i,s,a,o,l,u,h){if(e==t)return u;let f,g;if(i===0){if(g=Ih(a,o,n[e],n[e+1]),g<u){for(f=0;f<r;++f)l[f]=n[e+f];return l.length=r,g}return u}h=h||[NaN,NaN];let y=e+r;for(;y<t;)if(YP(n,y-r,y,r,a,o,h),g=Ih(a,o,h[0],h[1]),g<u){for(u=g,f=0;f<r;++f)l[f]=h[f];l.length=r,y+=r}else y+=r*Math.max((Math.sqrt(g)-Math.sqrt(u))/i|0,1);if(s&&(YP(n,t-r,e,r,a,o,h),g=Ih(a,o,h[0],h[1]),g<u)){for(u=g,f=0;f<r;++f)l[f]=h[f];l.length=r}return u}function sI(n,e,t,r,i,s,a,o,l,u,h){h=h||[NaN,NaN];for(let f=0,g=t.length;f<g;++f){const y=t[f];u=iI(n,e,y,r,i,s,a,o,l,u,h),e=y}return u}function jU(n,e,t,r,i,s,a,o,l,u,h){h=h||[NaN,NaN];for(let f=0,g=t.length;f<g;++f){const y=t[f];u=sI(n,e,y,r,i,s,a,o,l,u,h),e=y[y.length-1]}return u}function VU(n,e,t,r){for(let i=0,s=t.length;i<s;++i)n[e++]=t[i];return e}function Fv(n,e,t,r){for(let i=0,s=t.length;i<s;++i){const a=t[i];for(let o=0;o<r;++o)n[e++]=a[o]}return e}function Kp(n,e,t,r,i){i=i||[];let s=0;for(let a=0,o=t.length;a<o;++a){const l=Fv(n,e,t[a],r);i[s++]=l,e=l}return i.length=s,i}function u5(n,e,t,r,i){i=i||[];let s=0;for(let a=0,o=t.length;a<o;++a){const l=Kp(n,e,t[a],r,i[s]);l.length===0&&(l[0]=e),i[s++]=l,e=l[l.length-1]}return i.length=s,i}function $c(n,e,t,r,i){i=i!==void 0?i:[];let s=0;for(let a=e;a<t;a+=r)i[s++]=n.slice(a,a+r);return i.length=s,i}function Xm(n,e,t,r,i){i=i!==void 0?i:[];let s=0;for(let a=0,o=t.length;a<o;++a){const l=t[a];i[s++]=$c(n,e,l,r,i[s]),e=l}return i.length=s,i}function aT(n,e,t,r,i){i=i!==void 0?i:[];let s=0;for(let a=0,o=t.length;a<o;++a){const l=t[a];i[s++]=l.length===1&&l[0]===e?[]:Xm(n,e,l,r,i[s]),e=l[l.length-1]}return i.length=s,i}function ax(n,e,t,r,i,s,a){let o,l;const u=(t-e)/r;if(u===1)o=e;else if(u===2)o=e,l=i;else if(u!==0){let h=n[e],f=n[e+1],g=0;const y=[0];for(let E=e+r;E<t;E+=r){const T=n[E],b=n[E+1];g+=Math.sqrt((T-h)*(T-h)+(b-f)*(b-f)),y.push(g),h=T,f=b}const v=i*g,x=VB(y,v);x<0?(l=(v-y[-x-2])/(y[-x-1]-y[-x-2]),o=e+(-x-2)*r):o=e+x*r}a=a>1?a:2,s=s||new Array(a);for(let h=0;h<a;++h)s[h]=o===void 0?NaN:l===void 0?n[o+h]:Hs(n[o+h],n[o+r+h],l);return s}function oT(n,e,t,r,i,s){if(t==e)return null;let a;if(i<n[e+r-1])return s?(a=n.slice(e,e+r),a[r-1]=i,a):null;if(n[t-1]<i)return s?(a=n.slice(t-r,t),a[r-1]=i,a):null;if(i==n[e+r-1])return n.slice(e,e+r);let o=e/r,l=t/r;for(;o<l;){const g=o+l>>1;i<n[(g+1)*r-1]?l=g:o=g+1}const u=n[o*r-1];if(i==u)return n.slice((o-1)*r,(o-1)*r+r);const h=n[(o+1)*r-1],f=(i-u)/(h-u);a=[];for(let g=0;g<r-1;++g)a.push(Hs(n[(o-1)*r+g],n[o*r+g],f));return a.push(i),a}function GU(n,e,t,r,i,s,a){if(a)return oT(n,e,t[t.length-1],r,i,s);let o;if(i<n[r-1])return s?(o=n.slice(0,r),o[r-1]=i,o):null;if(n[n.length-1]<i)return s?(o=n.slice(n.length-r),o[r-1]=i,o):null;for(let l=0,u=t.length;l<u;++l){const h=t[l];if(e!=h){if(i<n[e+r-1])return null;if(i<=n[h-1])return oT(n,e,h,r,i,!1);e=h}}return null}function BU(n,e,t,r,i){return!HO(i,function(a){return!_h(n,e,t,r,a[0],a[1])})}function _h(n,e,t,r,i,s){let a=0,o=n[t-r],l=n[t-r+1];for(;e<t;e+=r){const u=n[e],h=n[e+1];l<=s?h>s&&(u-o)*(s-l)-(i-o)*(h-l)>0&&a++:h<=s&&(u-o)*(s-l)-(i-o)*(h-l)<0&&a--,o=u,l=h}return a!==0}function aI(n,e,t,r,i,s){if(t.length===0||!_h(n,e,t[0],r,i,s))return!1;for(let a=1,o=t.length;a<o;++a)if(_h(n,t[a-1],t[a],r,i,s))return!1;return!0}function UU(n,e,t,r,i,s){if(t.length===0)return!1;for(let a=0,o=t.length;a<o;++a){const l=t[a];if(aI(n,e,l,r,i,s))return!0;e=l[l.length-1]}return!1}function h5(n,e,t,r,i){let s;for(e+=r;e<t;e+=r)if(s=i(n.slice(e-r,e),n.slice(e,e+r)),s)return s;return!1}function jv(n,e,t,r,i,s){return s=s??WO(ea(),n,e,t,r),os(i,s)?s[0]>=i[0]&&s[2]<=i[2]||s[1]>=i[1]&&s[3]<=i[3]?!0:h5(n,e,t,r,function(a,o){return XB(i,a,o)}):!1}function zU(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){if(jv(n,e,t[s],r,i))return!0;e=t[s]}return!1}function d5(n,e,t,r,i){return!!(jv(n,e,t,r,i)||_h(n,e,t,r,i[0],i[1])||_h(n,e,t,r,i[0],i[3])||_h(n,e,t,r,i[2],i[1])||_h(n,e,t,r,i[2],i[3]))}function f5(n,e,t,r,i){if(!d5(n,e,t[0],r,i))return!1;if(t.length===1)return!0;for(let s=1,a=t.length;s<a;++s)if(BU(n,t[s-1],t[s],r,i)&&!jv(n,t[s-1],t[s],r,i))return!1;return!0}function $U(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){const o=t[s];if(f5(n,e,o,r,i))return!0;e=o[o.length-1]}return!1}function oI(n,e,t,r){let i=n[e],s=n[e+1],a=0;for(let o=e+r;o<t;o+=r){const l=n[o],u=n[o+1];a+=Math.sqrt((l-i)*(l-i)+(u-s)*(u-s)),i=l,s=u}return a}function Vv(n,e,t,r,i,s,a){const o=(t-e)/r;if(o<3){for(;e<t;e+=r)s[a++]=n[e],s[a++]=n[e+1];return a}const l=new Array(o);l[0]=1,l[o-1]=1;const u=[e,t-r];let h=0;for(;u.length>0;){const f=u.pop(),g=u.pop();let y=0;const v=n[g],x=n[g+1],E=n[f],T=n[f+1];for(let b=g+r;b<f;b+=r){const I=n[b],M=n[b+1],F=qB(I,M,v,x,E,T);F>y&&(h=b,y=F)}y>i&&(l[(h-e)/r]=1,g+r<h&&u.push(g,h),h+r<f&&u.push(h,f))}for(let f=0;f<o;++f)l[f]&&(s[a++]=n[e+f*r],s[a++]=n[e+f*r+1]);return a}function g5(n,e,t,r,i,s,a,o){for(let l=0,u=t.length;l<u;++l){const h=t[l];a=Vv(n,e,h,r,i,s,a),o.push(a),e=h}return a}function nh(n,e){return e*Math.round(n/e)}function WU(n,e,t,r,i,s,a){if(e==t)return a;let o=nh(n[e],i),l=nh(n[e+1],i);e+=r,s[a++]=o,s[a++]=l;let u,h;do if(u=nh(n[e],i),h=nh(n[e+1],i),e+=r,e==t)return s[a++]=u,s[a++]=h,a;while(u==o&&h==l);for(;e<t;){const f=nh(n[e],i),g=nh(n[e+1],i);if(e+=r,f==u&&g==h)continue;const y=u-o,v=h-l,x=f-o,E=g-l;if(y*E==v*x&&(y<0&&x<y||y==x||y>0&&x>y)&&(v<0&&E<v||v==E||v>0&&E>v)){u=f,h=g;continue}s[a++]=u,s[a++]=h,o=u,l=h,u=f,h=g}return s[a++]=u,s[a++]=h,a}function lI(n,e,t,r,i,s,a,o){for(let l=0,u=t.length;l<u;++l){const h=t[l];a=WU(n,e,h,r,i,s,a),o.push(a),e=h}return a}function HU(n,e,t,r,i,s,a,o){for(let l=0,u=t.length;l<u;++l){const h=t[l],f=[];a=lI(n,e,h,r,i,s,a,f),o.push(f),e=h[h.length-1]}return a}class Ra extends od{constructor(e,t){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}appendCoordinate(e){Nn(this.flatCoordinates,e),this.changed()}clone(){const e=new Ra(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,r,i){return i<sd(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(nI(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),iI(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,e,t,r,i))}forEachSegment(e){return h5(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinateAtM(e,t){return this.layout!="XYM"&&this.layout!="XYZM"?null:(t=t!==void 0?t:!1,oT(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t))}getCoordinates(){return $c(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(e,t){return ax(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,this.stride)}getLength(){return oI(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(e){const t=[];return t.length=Vv(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new Ra(t,"XY")}getType(){return"LineString"}intersectsExtent(e){return jv(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,this.getExtent())}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Fv(this.flatCoordinates,0,e,this.stride),this.changed()}}let ds=class m5 extends od{constructor(e,t){super(),this.setCoordinates(e,t)}clone(){const e=new m5(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,r,i){const s=this.flatCoordinates,a=Ih(e,t,s[0],s[1]);if(a<i){const o=this.stride;for(let l=0;l<o;++l)r[l]=s[l];return r.length=o,a}return i}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(e){return zO(this.flatCoordinates,e)}getType(){return"Point"}intersectsExtent(e){return Yb(e,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(e,t){this.setLayout(t,e,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=VU(this.flatCoordinates,0,e,this.stride),this.changed()}};const Ea={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},Fh=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",KU=Fh.includes("safari")&&!Fh.includes("chrom");KU&&(Fh.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(Fh));const YU=Fh.includes("webkit")&&!Fh.includes("edge"),p5=Fh.includes("macintosh"),XU=typeof devicePixelRatio<"u"?devicePixelRatio:1,Zs=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,cI=typeof Image<"u"&&Image.prototype.decode,y5=typeof createImageBitmap=="function",_5=(function(){let n=!1;try{const e=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return n})(),vt={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function ri(n,e,t,r){let i;return t&&t.length?i=t.shift():Zs?i=new class extends OffscreenCanvas{style={}}(n??300,e??150):i=document.createElement("canvas"),n&&(i.width=n),e&&(i.height=e),i.getContext("2d",r)}let b2;function ox(){return b2||(b2=ri(1,1)),b2}function Gv(n){const e=n.canvas;e.width=1,e.height=1,n.clearRect(0,0,1,1)}function XP(n,e){const t=e.parentNode;t&&t.replaceChild(n,e)}function qU(n){for(;n.lastChild;)n.lastChild.remove()}function ZU(n,e){const t=n.childNodes;for(let r=0;;++r){const i=t[r],s=e[r];if(!i&&!s)break;if(i!==s){if(!i){n.appendChild(s);continue}if(!s){n.removeChild(i),--r;continue}n.insertBefore(s,i)}}}function x5(){return new Proxy({childNodes:[],appendChild:function(e){return this.childNodes.push(e),e},remove:function(){},removeChild:function(e){const t=this.childNodes.indexOf(e);if(t===-1)throw new Error("Node to remove was not found");return this.childNodes.splice(t,1),e},insertBefore:function(e,t){const r=this.childNodes.indexOf(t);if(r===-1)throw new Error("Reference node not found");return this.childNodes.splice(r,0,e),e},style:{}},{get(e,t,r){return t==="firstElementChild"?e.childNodes.length>0?e.childNodes[0]:null:Reflect.get(e,t,r)}})}function Wc(n){return typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas}const uI=[NaN,NaN,NaN,0];let I2;function QU(){return I2||(I2=ri(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),I2}const JU=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,ez=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,tz=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,nz=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function By(n,e){return n.endsWith("%")?Number(n.substring(0,n.length-1))/e:Number(n)}function mm(n){throw new Error('failed to parse "'+n+'" as color')}function v5(n){if(n.toLowerCase().startsWith("rgb")){const s=n.match(ez)||n.match(JU)||n.match(tz);if(s){const a=s[4],o=100/255;return[ar(By(s[1],o)+.5|0,0,255),ar(By(s[2],o)+.5|0,0,255),ar(By(s[3],o)+.5|0,0,255),a!==void 0?ar(By(a,100),0,1):1]}mm(n)}if(n.startsWith("#")){if(nz.test(n)){const s=n.substring(1),a=s.length<=4?1:2,o=[0,0,0,255];for(let l=0,u=s.length;l<u;l+=a){let h=parseInt(s.substring(l,l+a),16);a===1&&(h+=h<<4),o[l/a]=h}return o[3]=o[3]/255,o}mm(n)}const e=QU();e.fillStyle="#abcdef";let t=e.fillStyle;e.fillStyle=n,e.fillStyle===t&&(e.fillStyle="#fedcba",t=e.fillStyle,e.fillStyle=n,e.fillStyle===t&&mm(n));const r=e.fillStyle;if(r.startsWith("#")||r.startsWith("rgba"))return v5(r);e.clearRect(0,0,1,1),e.fillRect(0,0,1,1);const i=Array.from(e.getImageData(0,0,1,1).data);return i[3]=$p(i[3]/255,3),i}function rz(n){return typeof n=="string"?n:dI(n)}const iz=1024,Dg={};let A2=0;function sz(n){if(n.length===4)return n;const e=n.slice();return e[3]=1,e}function R2(n){return n>.0031308?Math.pow(n,1/2.4)*269.025-14.025:n*3294.6}function C2(n){return n>.2068965?Math.pow(n,3):(n-4/29)*(108/841)}function k2(n){return n>10.314724?Math.pow((n+14.025)/269.025,2.4):n/3294.6}function P2(n){return n>.0088564?Math.pow(n,1/3):n/(108/841)+4/29}function qP(n){const e=k2(n[0]),t=k2(n[1]),r=k2(n[2]),i=P2(e*.222488403+t*.716873169+r*.06060791),s=500*(P2(e*.452247074+t*.399439023+r*.148375274)-i),a=200*(i-P2(e*.016863605+t*.117638439+r*.865350722)),o=Math.atan2(a,s)*(180/Math.PI);return[116*i-16,Math.sqrt(s*s+a*a),o<0?o+360:o,n[3]]}function az(n){const e=(n[0]+16)/116,t=n[1],r=n[2]*Math.PI/180,i=C2(e),s=C2(e+t/500*Math.cos(r)),a=C2(e-t/200*Math.sin(r)),o=R2(s*3.021973625-i*1.617392459-a*.404875592),l=R2(s*-.943766287+i*1.916279586+a*.027607165),u=R2(s*.069407491-i*.22898585+a*1.159737864);return[ar(o+.5|0,0,255),ar(l+.5|0,0,255),ar(u+.5|0,0,255),n[3]]}function hI(n){if(n==="none")return uI;if(Dg.hasOwnProperty(n))return Dg[n];if(A2>=iz){let t=0;for(const r in Dg)(t++&3)===0&&(delete Dg[r],--A2)}const e=v5(n);e.length!==4&&mm(n);for(const t of e)isNaN(t)&&mm(n);return Dg[n]=e,++A2,e}function jh(n){return Array.isArray(n)?n:hI(n)}function dI(n){let e=n[0];e!=(e|0)&&(e=e+.5|0);let t=n[1];t!=(t|0)&&(t=t+.5|0);let r=n[2];r!=(r|0)&&(r=r+.5|0);const i=n[3]===void 0?1:Math.round(n[3]*1e3)/1e3;return"rgba("+e+","+t+","+r+","+i+")"}class w5 extends Bp{constructor(e,t,r,i){super(),this.extent=e,this.pixelRatio_=r,this.resolution=t,this.state=typeof i=="function"?vt.IDLE:i,this.image_=null,this.loader=typeof i=="function"?i:null}changed(){this.dispatchEvent(Yt.CHANGE)}getExtent(){return this.extent}getImage(){return this.image_}getPixelRatio(){return this.pixelRatio_}getResolution(){return this.resolution}getState(){return this.state}load(){if(this.state==vt.IDLE&&this.loader){this.state=vt.LOADING,this.changed();const e=this.getResolution(),t=Array.isArray(e)?e[0]:e;GO(()=>this.loader(this.getExtent(),t,this.getPixelRatio())).then(r=>{"image"in r&&(this.image_=r.image),"extent"in r&&(this.extent=r.extent),"resolution"in r&&(this.resolution=r.resolution),"pixelRatio"in r&&(this.pixelRatio_=r.pixelRatio),(r instanceof HTMLImageElement||y5&&r instanceof ImageBitmap||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement)&&(this.image_=r),this.state=vt.LOADED}).catch(r=>{this.state=vt.ERROR,console.error(r)}).finally(()=>this.changed())}}setImage(e){this.image_=e}setResolution(e){this.resolution=e}}function oz(n,e,t){const r=n;let i=!0,s=!1,a=!1;const o=[Q_(r,Yt.LOAD,function(){a=!0,s||e()})];return r.src&&cI?(s=!0,r.decode().then(function(){i&&e()}).catch(function(l){i&&(a?e():t())})):o.push(Q_(r,Yt.ERROR,t)),function(){i=!1,o.forEach(nr)}}function lz(n,e){return new Promise((t,r)=>{function i(){a(),t(n)}function s(){a(),r(new Error("Image load error"))}function a(){n.removeEventListener("load",i),n.removeEventListener("error",s)}n.addEventListener("load",i),n.addEventListener("error",s)})}function E5(n,e){return e&&(n.src=e),n.src&&cI?new Promise((t,r)=>n.decode().then(()=>t(n)).catch(i=>n.complete&&n.width?t(n):r(i))):lz(n)}function S5(n,e){return e&&(n.src=e),n.src&&cI&&y5?n.decode().then(()=>createImageBitmap(n)).catch(t=>{if(n.complete&&n.width)return n;throw t}):E5(n)}class cz{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let e=0;for(const t in this.cache_){const r=this.cache_[t];(e++&3)===0&&!r.hasListener()&&(delete this.cache_[t],delete this.patternCache_[t],--this.cacheSize_)}}}get(e,t,r){const i=M2(e,t,r);return i in this.cache_?this.cache_[i]:null}getPattern(e,t,r){const i=M2(e,t,r);return i in this.patternCache_?this.patternCache_[i]:null}set(e,t,r,i,s){const a=M2(e,t,r),o=a in this.cache_;this.cache_[a]=i,s&&(i.getImageState()===vt.IDLE&&i.load(),i.getImageState()===vt.LOADING?i.ready().then(()=>{this.patternCache_[a]=ox().createPattern(i.getImage(1),"repeat")}):this.patternCache_[a]=ox().createPattern(i.getImage(1),"repeat")),o||++this.cacheSize_}setSize(e){this.maxCacheSize_=e,this.expire()}}function M2(n,e,t){const r=t?jh(t):"null";return e+":"+n+":"+r}const Sa=new cz;let Fg=null;class T5 extends Bp{constructor(e,t,r,i,s){super(),this.hitDetectionImage_=null,this.image_=e,this.crossOrigin_=r,this.canvas_={},this.color_=s,this.imageState_=i===void 0?vt.IDLE:i,this.size_=e&&e.width&&e.height?[e.width,e.height]:null,this.src_=t,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===vt.LOADED){Fg||(Fg=ri(1,1,void 0,{willReadFrequently:!0})),Fg.drawImage(this.image_,0,0);try{Fg.getImageData(0,0,1,1),this.tainted_=!1}catch{Fg=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(Yt.CHANGE)}handleImageError_(){this.imageState_=vt.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=vt.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}getPixelRatio(e){return this.replaceColor_(e),this.canvas_[e]?e:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const e=this.size_[0],t=this.size_[1],r=ri(e,t);r.fillRect(0,0,e,t),this.hitDetectionImage_=r.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===vt.IDLE){this.image_||this.initializeImage_(),this.imageState_=vt.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&E5(this.image_,this.src_).then(e=>{this.image_=e,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(e){if(!this.color_||this.canvas_[e]||this.imageState_!==vt.LOADED)return;const t=this.image_,r=ri(Math.ceil(t.width*e),Math.ceil(t.height*e)),i=r.canvas;r.scale(e,e),r.drawImage(t,0,0),r.globalCompositeOperation="multiply",r.fillStyle=rz(this.color_),r.fillRect(0,0,i.width/e,i.height/e),r.globalCompositeOperation="destination-in",r.drawImage(t,0,0),this.canvas_[e]=i}ready(){return this.ready_||(this.ready_=new Promise(e=>{if(this.imageState_===vt.LOADED||this.imageState_===vt.ERROR)e();else{const t=()=>{(this.imageState_===vt.LOADED||this.imageState_===vt.ERROR)&&(this.removeEventListener(Yt.CHANGE,t),e())};this.addEventListener(Yt.CHANGE,t)}})),this.ready_}}function lx(n,e,t,r,i,s){let a=e===void 0?void 0:Sa.get(e,t,i);return a||(a=new T5(n,n&&"src"in n?n.src||void 0:e,t,r,i),Sa.set(e,t,i,a,s)),s&&a&&!Sa.getPattern(e,t,i)&&Sa.set(e,t,i,a,s),a}function Fo(n){return n?Array.isArray(n)?dI(n):typeof n=="object"&&"src"in n?uz(n):n:null}function uz(n){if(!n.offset||!n.size)return Sa.getPattern(n.src,"anonymous",n.color);const e=n.src+":"+n.offset,t=Sa.getPattern(e,void 0,n.color);if(t)return t;const r=Sa.get(n.src,"anonymous",null);if(r.getImageState()!==vt.LOADED)return null;const i=ri(n.size[0],n.size[1]);return i.drawImage(r.getImage(1),n.offset[0],n.offset[1],n.size[0],n.size[1],0,0,n.size[0],n.size[1]),lx(i.canvas,e,void 0,vt.LOADED,n.color,!0),Sa.getPattern(e,void 0,n.color)}class b5{drawCustom(e,t,r,i,s){}drawGeometry(e){}setStyle(e){}drawCircle(e,t,r){}drawFeature(e,t,r){}drawGeometryCollection(e,t,r){}drawLineString(e,t,r){}drawMultiLineString(e,t,r){}drawMultiPoint(e,t,r){}drawMultiPolygon(e,t,r){}drawPoint(e,t,r){}drawPolygon(e,t,r){}drawText(e,t,r){}setFillStrokeStyle(e,t){}setImageStyle(e,t){}setTextStyle(e,t){}}const Uy="ol-hidden",Yp="ol-unselectable",fI="ol-control",ZP="ol-collapsed",hz=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),QP=["style","variant","weight","size","lineHeight","family"],lT={normal:400,bold:700},cT=function(n){const e=n.match(hz);if(!e)return null;const t={lineHeight:"normal",size:"1.2em",style:"normal",weight:"400",variant:"normal"};for(let r=0,i=QP.length;r<i;++r){const s=e[r+1];s!==void 0&&(t[QP[r]]=typeof s=="string"?s.trim():s)}return isNaN(Number(t.weight))&&t.weight in lT&&(t.weight=lT[t.weight]),t.families=t.family.split(/,\s?/).map(r=>r.trim().replace(/^['"]|['"]$/g,"")),t},I5="10px sans-serif",Es="#000",h0="round",Ml=[],Nl=0,d0="round",qm=10,Zm="#000",Qm="center",cx="middle",xh=[0,0,0,0],Jm=1,xf=new nl;let jg=null,JP;const uT={},dz=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"]);function fz(n,e,t){return`${n} ${e} 16px "${t}"`}const gz=(function(){let e,t;async function r(s){await t.ready;const a=await t.load(s);if(a.length===0)return!1;const o=cT(s),l=o.families[0].toLowerCase(),u=o.weight;return a.some(h=>{const f=h.family.replace(/^['"]|['"]$/g,"").toLowerCase(),g=lT[h.weight]||h.weight;return f===l&&h.style===o.style&&g==u})}async function i(){await t.ready;let s=!0;const a=xf.getProperties(),o=Object.keys(a).filter(l=>a[l]<100);for(let l=o.length-1;l>=0;--l){const u=o[l];let h=a[u];h<100&&(await r(u)?(Gp(uT),xf.set(u,100)):(h+=10,xf.set(u,h,!0),h<100&&(s=!1)))}e=void 0,s||(e=setTimeout(i,100))}return async function(s){t||(t=Zs?self.fonts:document.fonts);const a=cT(s);if(!a)return;const o=a.families;let l=!1;for(const u of o){if(dz.has(u))continue;const h=fz(a.style,a.weight,u);xf.get(h)===void 0&&(xf.set(h,0,!0),l=!0)}l&&(clearTimeout(e),e=setTimeout(i,100))}})(),mz=(function(){let n;return function(e){let t=uT[e];if(t==null){if(Zs){const r=cT(e),i=A5(e,"g");t=(isNaN(Number(r.lineHeight))?1.2:Number(r.lineHeight))*(i.actualBoundingBoxAscent+i.actualBoundingBoxDescent)}else n||(n=document.createElement("div"),n.innerHTML="M",n.style.minHeight="0",n.style.maxHeight="none",n.style.height="auto",n.style.padding="0",n.style.border="none",n.style.position="absolute",n.style.display="block",n.style.left="-99999px"),n.style.font=e,document.body.appendChild(n),t=n.offsetHeight,document.body.removeChild(n);uT[e]=t}return t}})();function A5(n,e){return jg||(jg=ri(1,1)),n!=JP&&(jg.font=n,JP=jg.font),jg.measureText(e)}function R5(n,e){return A5(n,e).width}function e4(n,e,t){if(e in t)return t[e];const r=e.split(`
`).reduce((i,s)=>Math.max(i,R5(n,s)),0);return t[e]=r,r}function pz(n,e){const t=[],r=[],i=[];let s=0,a=0,o=0,l=0;for(let u=0,h=e.length;u<=h;u+=2){const f=e[u];if(f===`
`||u===h){s=Math.max(s,a),i.push(a),a=0,o+=l,l=0;continue}const g=e[u+1]||n.font,y=R5(g,f);t.push(y),a+=y;const v=mz(g);r.push(v),l=Math.max(l,v)}return{width:s,height:o,widths:t,heights:r,lineWidths:i}}function yz(n,e,t,r,i,s,a,o,l,u,h){n.save(),t!==1&&(n.globalAlpha===void 0?n.globalAlpha=f=>f.globalAlpha*=t:n.globalAlpha*=t),e&&n.transform.apply(n,e),r.contextInstructions?(n.translate(l,u),n.scale(h[0],h[1]),_z(r,n)):h[0]<0||h[1]<0?(n.translate(l,u),n.scale(h[0],h[1]),n.drawImage(r,i,s,a,o,0,0,a,o)):n.drawImage(r,i,s,a,o,l,u,a*h[0],o*h[1]),n.restore()}function _z(n,e){const t=n.contextInstructions;for(let r=0,i=t.length;r<i;r+=2)Array.isArray(t[r+1])?e[t[r]].apply(e,t[r+1]):e[t[r]]=t[r+1]}class xz extends b5{constructor(e,t,r,i,s,a,o){super(),this.context_=e,this.pixelRatio_=t,this.extent_=r,this.transform_=i,this.transformRotation_=i?$p(Math.atan2(i[1],i[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=a,this.userTransform_=o,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=to()}drawImages_(e,t,r,i){if(!this.image_)return;const s=eu(e,t,r,i,this.transform_,this.pixelCoordinates_),a=this.context_,o=this.tmpLocalTransform_,l=a.globalAlpha;this.imageOpacity_!=1&&(a.globalAlpha=l*this.imageOpacity_);let u=this.imageRotation_;this.transformRotation_===0&&(u-=this.viewRotation_),this.imageRotateWithView_&&(u+=this.viewRotation_);for(let h=0,f=s.length;h<f;h+=2){const g=s[h]-this.imageAnchorX_,y=s[h+1]-this.imageAnchorY_;if(u!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const v=g+this.imageAnchorX_,x=y+this.imageAnchorY_;Xo(o,v,x,1,1,u,-v,-x),a.save(),a.transform.apply(a,o),a.translate(v,x),a.scale(this.imageScale_[0],this.imageScale_[1]),a.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),a.restore()}else a.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,g,y,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(a.globalAlpha=l)}drawText_(e,t,r,i){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=eu(e,t,r,i,this.transform_,this.pixelCoordinates_),a=this.context_;let o=this.textRotation_;for(this.transformRotation_===0&&(o-=this.viewRotation_),this.textRotateWithView_&&(o+=this.viewRotation_);t<r;t+=i){const l=s[t]+this.textOffsetX_,u=s[t+1]+this.textOffsetY_;o!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(a.save(),a.translate(l-this.textOffsetX_,u-this.textOffsetY_),a.rotate(o),a.translate(this.textOffsetX_,this.textOffsetY_),a.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&a.strokeText(this.text_,0,0),this.textFillState_&&a.fillText(this.text_,0,0),a.restore()):(this.textStrokeState_&&a.strokeText(this.text_,l,u),this.textFillState_&&a.fillText(this.text_,l,u))}}moveToLineTo_(e,t,r,i,s){const a=this.context_,o=eu(e,t,r,i,this.transform_,this.pixelCoordinates_);a.moveTo(o[0],o[1]);let l=o.length;s&&(l-=2);for(let u=2;u<l;u+=2)a.lineTo(o[u],o[u+1]);return s&&a.closePath(),r}drawRings_(e,t,r,i){for(let s=0,a=r.length;s<a;++s)t=this.moveToLineTo_(e,t,r[s],i,!0);return t}drawCircle(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!os(this.extent_,e.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=DU(e,this.transform_,this.pixelCoordinates_),r=t[2]-t[0],i=t[3]-t[1],s=Math.sqrt(r*r+i*i),a=this.context_;a.beginPath(),a.arc(t[0],t[1],s,0,2*Math.PI),this.fillState_&&a.fill(),this.strokeState_&&a.stroke()}this.text_!==""&&this.drawText_(e.getCenter(),0,2,2)}}setStyle(e){this.setFillStrokeStyle(e.getFill(),e.getStroke()),this.setImageStyle(e.getImage()),this.setTextStyle(e.getText())}setTransform(e){this.transform_=e}drawGeometry(e){switch(e.getType()){case"Point":this.drawPoint(e);break;case"LineString":this.drawLineString(e);break;case"Polygon":this.drawPolygon(e);break;case"MultiPoint":this.drawMultiPoint(e);break;case"MultiLineString":this.drawMultiLineString(e);break;case"MultiPolygon":this.drawMultiPolygon(e);break;case"GeometryCollection":this.drawGeometryCollection(e);break;case"Circle":this.drawCircle(e);break}}drawFeature(e,t){const r=t.getGeometryFunction()(e);r&&(this.setStyle(t),this.drawGeometry(r))}drawGeometryCollection(e){const t=e.getGeometriesArray();for(let r=0,i=t.length;r<i;++r)this.drawGeometry(t[r])}drawPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),r=e.getStride();this.image_&&this.drawImages_(t,0,t.length,r),this.text_!==""&&this.drawText_(t,0,t.length,r)}drawMultiPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),r=e.getStride();this.image_&&this.drawImages_(t,0,t.length,r),this.text_!==""&&this.drawText_(t,0,t.length,r)}drawLineString(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!os(this.extent_,e.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const t=this.context_,r=e.getFlatCoordinates();t.beginPath(),this.moveToLineTo_(r,0,r.length,e.getStride(),!1),t.stroke()}if(this.text_!==""){const t=e.getFlatMidpoint();this.drawText_(t,0,2,2)}}}drawMultiLineString(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getExtent();if(os(this.extent_,t)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const r=this.context_,i=e.getFlatCoordinates();let s=0;const a=e.getEnds(),o=e.getStride();r.beginPath();for(let l=0,u=a.length;l<u;++l)s=this.moveToLineTo_(i,s,a[l],o,!1);r.stroke()}if(this.text_!==""){const r=e.getFlatMidpoints();this.drawText_(r,0,r.length,2)}}}drawPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!os(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_;t.beginPath(),this.drawRings_(e.getOrientedFlatCoordinates(),0,e.getEnds(),e.getStride()),this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoint();this.drawText_(t,0,2,2)}}}drawMultiPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!os(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_,r=e.getOrientedFlatCoordinates();let i=0;const s=e.getEndss(),a=e.getStride();t.beginPath();for(let o=0,l=s.length;o<l;++o){const u=s[o];i=this.drawRings_(r,i,u,a)}this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoints();this.drawText_(t,0,t.length,2)}}}setContextFillState_(e){const t=this.context_,r=this.contextFillState_;r?r.fillStyle!=e.fillStyle&&(r.fillStyle=e.fillStyle,t.fillStyle=e.fillStyle):(t.fillStyle=e.fillStyle,this.contextFillState_={fillStyle:e.fillStyle})}setContextStrokeState_(e){const t=this.context_,r=this.contextStrokeState_;r?(r.lineCap!=e.lineCap&&(r.lineCap=e.lineCap,t.lineCap=e.lineCap),Su(r.lineDash,e.lineDash)||t.setLineDash(r.lineDash=e.lineDash),r.lineDashOffset!=e.lineDashOffset&&(r.lineDashOffset=e.lineDashOffset,t.lineDashOffset=e.lineDashOffset),r.lineJoin!=e.lineJoin&&(r.lineJoin=e.lineJoin,t.lineJoin=e.lineJoin),r.lineWidth!=e.lineWidth&&(r.lineWidth=e.lineWidth,t.lineWidth=e.lineWidth),r.miterLimit!=e.miterLimit&&(r.miterLimit=e.miterLimit,t.miterLimit=e.miterLimit),r.strokeStyle!=e.strokeStyle&&(r.strokeStyle=e.strokeStyle,t.strokeStyle=e.strokeStyle)):(t.lineCap=e.lineCap,t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset,t.lineJoin=e.lineJoin,t.lineWidth=e.lineWidth,t.miterLimit=e.miterLimit,t.strokeStyle=e.strokeStyle,this.contextStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle})}setContextTextState_(e){const t=this.context_,r=this.contextTextState_,i=e.textAlign?e.textAlign:Qm;r?(r.font!=e.font&&(r.font=e.font,t.font=e.font),r.textAlign!=i&&(r.textAlign=i,t.textAlign=i),r.textBaseline!=e.textBaseline&&(r.textBaseline=e.textBaseline,t.textBaseline=e.textBaseline)):(t.font=e.font,t.textAlign=i,t.textBaseline=e.textBaseline,this.contextTextState_={font:e.font,textAlign:i,textBaseline:e.textBaseline})}setFillStrokeStyle(e,t){if(!e)this.fillState_=null;else{const r=e.getColor();this.fillState_={fillStyle:Fo(r||Es)}}if(!t)this.strokeState_=null;else{const r=t.getColor(),i=t.getLineCap(),s=t.getLineDash(),a=t.getLineDashOffset(),o=t.getLineJoin(),l=t.getWidth(),u=t.getMiterLimit(),h=s||Ml;this.strokeState_={lineCap:i!==void 0?i:h0,lineDash:this.pixelRatio_===1?h:h.map(f=>f*this.pixelRatio_),lineDashOffset:(a||Nl)*this.pixelRatio_,lineJoin:o!==void 0?o:d0,lineWidth:(l!==void 0?l:Jm)*this.pixelRatio_,miterLimit:u!==void 0?u:qm,strokeStyle:Fo(r||Zm)}}}setImageStyle(e){let t;if(!e||!(t=e.getSize())){this.image_=null;return}const r=e.getPixelRatio(this.pixelRatio_),i=e.getAnchor(),s=e.getOrigin();this.image_=e.getImage(this.pixelRatio_),this.imageAnchorX_=i[0]*r,this.imageAnchorY_=i[1]*r,this.imageHeight_=t[1]*r,this.imageOpacity_=e.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=e.getRotateWithView(),this.imageRotation_=e.getRotation();const a=e.getScaleArray();this.imageScale_=[a[0]*this.pixelRatio_/r,a[1]*this.pixelRatio_/r],this.imageWidth_=t[0]*r}setTextStyle(e){if(!e)this.text_="";else{const t=e.getFill();if(!t)this.textFillState_=null;else{const y=t.getColor();this.textFillState_={fillStyle:Fo(y||Es)}}const r=e.getStroke();if(!r)this.textStrokeState_=null;else{const y=r.getColor(),v=r.getLineCap(),x=r.getLineDash(),E=r.getLineDashOffset(),T=r.getLineJoin(),b=r.getWidth(),I=r.getMiterLimit();this.textStrokeState_={lineCap:v!==void 0?v:h0,lineDash:x||Ml,lineDashOffset:E||Nl,lineJoin:T!==void 0?T:d0,lineWidth:b!==void 0?b:Jm,miterLimit:I!==void 0?I:qm,strokeStyle:Fo(y||Zm)}}const i=e.getFont(),s=e.getOffsetX(),a=e.getOffsetY(),o=e.getRotateWithView(),l=e.getRotation(),u=e.getScaleArray(),h=e.getText(),f=e.getTextAlign(),g=e.getTextBaseline();this.textState_={font:i!==void 0?i:I5,textAlign:f!==void 0?f:Qm,textBaseline:g!==void 0?g:cx},this.text_=h!==void 0?Array.isArray(h)?h.reduce((y,v,x)=>y+=x%2?" ":v,""):h:"",this.textOffsetX_=s!==void 0?this.pixelRatio_*s:0,this.textOffsetY_=a!==void 0?this.pixelRatio_*a:0,this.textRotateWithView_=o!==void 0?o:!1,this.textRotation_=l!==void 0?l:0,this.textScale_=[this.pixelRatio_*u[0],this.pixelRatio_*u[1]]}}}const vz=.5,C5={Point:Rz,LineString:bz,Polygon:kz,MultiPoint:Cz,MultiLineString:Iz,MultiPolygon:Az,GeometryCollection:Tz,Circle:Ez};function wz(n,e){return parseInt(bn(n),10)-parseInt(bn(e),10)}function t4(n,e){const t=k5(n,e);return t*t}function k5(n,e){return vz*n/e}function Ez(n,e,t,r,i){const s=t.getFill(),a=t.getStroke();if(s||a){const l=n.getBuilder(t.getZIndex(),"Circle");l.setFillStrokeStyle(s,a),l.drawCircle(e,r,i)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,r)}}function n4(n,e,t,r,i,s,a,o){const l=[],u=t.getImage();if(u){let g=!0;const y=u.getImageState();y==vt.LOADED||y==vt.ERROR?g=!1:y==vt.IDLE&&u.load(),g&&l.push(u.ready())}const h=t.getFill();h&&h.loading()&&l.push(h.ready());const f=l.length>0;return f&&Promise.all(l).then(()=>i(null)),Sz(n,e,t,r,s,a,o),f}function Sz(n,e,t,r,i,s,a){const o=t.getGeometryFunction()(e);if(!o)return;const l=o.simplifyTransformed(r,i);if(t.getRenderer())P5(n,l,t,e,a);else{const h=C5[l.getType()];h(n,l,t,e,a,s)}}function P5(n,e,t,r,i){if(e.getType()=="GeometryCollection"){const a=e.getGeometries();for(let o=0,l=a.length;o<l;++o)P5(n,a[o],t,r,i);return}n.getBuilder(t.getZIndex(),"Default").drawCustom(e,r,t.getRenderer(),t.getHitDetectionRenderer(),i)}function Tz(n,e,t,r,i,s){const a=e.getGeometriesArray();let o,l;for(o=0,l=a.length;o<l;++o){const u=C5[a[o].getType()];u(n,a[o],t,r,i,s)}}function bz(n,e,t,r,i){const s=t.getStroke();if(s){const o=n.getBuilder(t.getZIndex(),"LineString");o.setFillStrokeStyle(null,s),o.drawLineString(e,r,i)}const a=t.getText();if(a&&a.getText()){const o=n.getBuilder(t.getZIndex(),"Text");o.setTextStyle(a),o.drawText(e,r,i)}}function Iz(n,e,t,r,i){const s=t.getStroke();if(s){const o=n.getBuilder(t.getZIndex(),"LineString");o.setFillStrokeStyle(null,s),o.drawMultiLineString(e,r,i)}const a=t.getText();if(a&&a.getText()){const o=n.getBuilder(t.getZIndex(),"Text");o.setTextStyle(a),o.drawText(e,r,i)}}function Az(n,e,t,r,i){const s=t.getFill(),a=t.getStroke();if(a||s){const l=n.getBuilder(t.getZIndex(),"Polygon");l.setFillStrokeStyle(s,a),l.drawMultiPolygon(e,r,i)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,r,i)}}function Rz(n,e,t,r,i,s){const a=t.getImage(),o=t.getText(),l=o&&o.getText(),u=s&&a&&l?{}:void 0;if(a){if(a.getImageState()!=vt.LOADED)return;const h=n.getBuilder(t.getZIndex(),"Image");h.setImageStyle(a,u),h.drawPoint(e,r,i)}if(l){const h=n.getBuilder(t.getZIndex(),"Text");h.setTextStyle(o,u),h.drawText(e,r,i)}}function Cz(n,e,t,r,i,s){const a=t.getImage(),o=a&&a.getOpacity()!==0,l=t.getText(),u=l&&l.getText(),h=s&&o&&u?{}:void 0;if(o){if(a.getImageState()!=vt.LOADED)return;const f=n.getBuilder(t.getZIndex(),"Image");f.setImageStyle(a,h),f.drawMultiPoint(e,r,i)}if(u){const f=n.getBuilder(t.getZIndex(),"Text");f.setTextStyle(l,h),f.drawText(e,r,i)}}function kz(n,e,t,r,i){const s=t.getFill(),a=t.getStroke();if(s||a){const l=n.getBuilder(t.getZIndex(),"Polygon");l.setFillStrokeStyle(s,a),l.drawPolygon(e,r,i)}const o=t.getText();if(o&&o.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(o),l.drawText(e,r,i)}}let Pz=!1;function Mz(n,e,t,r,i,s,a){const o=new XMLHttpRequest;o.open("GET",typeof n=="function"?n(t,r,i):n,!0),e.getType()=="arraybuffer"&&(o.responseType="arraybuffer"),o.withCredentials=Pz,o.onload=function(l){if(!o.status||o.status>=200&&o.status<300){const u=e.getType();try{let h;u=="text"||u=="json"?h=o.responseText:u=="xml"?h=o.responseXML||o.responseText:u=="arraybuffer"&&(h=o.response),h?s(e.readFeatures(h,{extent:t,featureProjection:i}),e.readProjection(h)):a()}catch{a()}}else a()},o.onerror=a,o.send()}function r4(n,e){return function(t,r,i,s,a){Mz(n,e,t,r,i,(o,l)=>{this.addFeatures(o),s!==void 0&&s(o)},()=>{this.changed(),a!==void 0&&a()})}}function Nz(n,e){return[[-1/0,-1/0,1/0,1/0]]}function M5(n,e,t,r){const i=[];let s=ea();for(let a=0,o=t.length;a<o;++a){const l=t[a];s=Xb(n,e,l[0],r),i.push((s[0]+s[2])/2,(s[1]+s[3])/2),e=l[l.length-1]}return i}function gI(n,e,t,r,i,s,a){let o,l,u,h,f,g,y;const v=i[s+1],x=[];for(let b=0,I=t.length;b<I;++b){const M=t[b];for(h=n[M-r],g=n[M-r+1],o=e;o<M;o+=r)f=n[o],y=n[o+1],(v<=g&&y<=v||g<=v&&v<=y)&&(u=(v-g)/(y-g)*(f-h)+h,x.push(u)),h=f,g=y}let E=NaN,T=-1/0;for(x.sort(Cl),h=x[0],o=1,l=x.length;o<l;++o){f=x[o];const b=Math.abs(f-h);b>T&&(u=(h+f)/2,aI(n,e,t,r,u,v)&&(E=u,T=b)),h=f}return isNaN(E)&&(E=i[s]),a?(a.push(E,v,T),a):[E,v,T]}function N5(n,e,t,r,i){let s=[];for(let a=0,o=t.length;a<o;++a){const l=t[a];s=gI(n,e,l,r,i,2*a,s),e=l[l.length-1]}return s}function Lz(n,e,t,r){for(;e<t-r;){for(let i=0;i<r;++i){const s=n[e+i];n[e+i]=n[t-r+i],n[t-r+i]=s}e+=r,t-=r}}function mI(n,e,t,r){let i=0,s=n[t-r],a=n[t-r+1];for(;e<t;e+=r){const o=n[e],l=n[e+1];i+=(o-s)*(l+a),s=o,a=l}return i===0?void 0:i>0}function pI(n,e,t,r,i){i=i!==void 0?i:!1;for(let s=0,a=t.length;s<a;++s){const o=t[s],l=mI(n,e,o,r);if(s===0){if(i&&l||!i&&!l)return!1}else if(i&&!l||!i&&l)return!1;e=o}return!0}function L5(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){const o=t[s];if(!pI(n,e,o,r,i))return!1;o.length&&(e=o[o.length-1])}return!0}function ux(n,e,t,r,i){i=i!==void 0?i:!1;for(let s=0,a=t.length;s<a;++s){const o=t[s],l=mI(n,e,o,r);(s===0?i&&l||!i&&!l:i&&!l||!i&&l)&&Lz(n,e,o,r),e=o}return e}function hT(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s)e=ux(n,e,t[s],r,i);return e}function Oz(n,e){const t=[];let r=0,i=0,s;for(let a=0,o=e.length;a<o;++a){const l=e[a],u=mI(n,r,l,2);if(s===void 0&&(s=u),u===s)t.push(e.slice(i,a+1));else{if(t.length===0)continue;t[t.length-1].push(e[i])}i=a+1,r=l}return t}class no extends c5{constructor(e){super(),this.geometries_=e,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(nr),this.changeEventsKeys_.length=0}listenGeometriesChange_(){const e=this.geometries_;for(let t=0,r=e.length;t<r;++t)this.changeEventsKeys_.push(yn(e[t],Yt.CHANGE,this.changed,this))}clone(){const e=new no(N2(this.geometries_));return e.applyProperties(this),e}closestPointXY(e,t,r,i){if(i<sd(this.getExtent(),e,t))return i;const s=this.geometries_;for(let a=0,o=s.length;a<o;++a)i=s[a].closestPointXY(e,t,r,i);return i}containsXY(e,t){const r=this.geometries_;for(let i=0,s=r.length;i<s;++i)if(r[i].containsXY(e,t))return!0;return!1}computeExtent(e){zp(e);const t=this.geometries_;for(let r=0,i=t.length;r<i;++r)$O(e,t[r].getExtent());return e}getGeometries(){return N2(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let e=[];const t=this.geometries_;for(let r=0,i=t.length;r<i;++r)t[r].getType()===this.getType()?e=e.concat(t[r].getGeometriesArrayRecursive()):e.push(t[r]);return e}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=[],r=this.geometries_;let i=!1;for(let s=0,a=r.length;s<a;++s){const o=r[s],l=o.getSimplifiedGeometry(e);t.push(l),l!==o&&(i=!0)}return i?new no(t):(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getType(){return"GeometryCollection"}intersectsExtent(e){const t=this.geometries_;for(let r=0,i=t.length;r<i;++r)if(t[r].intersectsExtent(e))return!0;return!1}isEmpty(){return this.geometries_.length===0}rotate(e,t){const r=this.geometries_;for(let i=0,s=r.length;i<s;++i)r[i].rotate(e,t);this.changed()}scale(e,t,r){r||(r=Yo(this.getExtent()));const i=this.geometries_;for(let s=0,a=i.length;s<a;++s)i[s].scale(e,t,r);this.changed()}setGeometries(e){this.setGeometriesArray(N2(e))}setGeometriesArray(e){this.unlistenGeometriesChange_(),this.geometries_=e,this.listenGeometriesChange_(),this.changed()}applyTransform(e){const t=this.geometries_;for(let r=0,i=t.length;r<i;++r)t[r].applyTransform(e);this.changed()}translate(e,t){const r=this.geometries_;for(let i=0,s=r.length;i<s;++i)r[i].translate(e,t);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function N2(n){return n.map(e=>e.clone())}function O5(n,e,t,r){let i=0;const s=n[t-r],a=n[t-r+1];let o=0,l=0;for(;e<t;e+=r){const u=n[e]-s,h=n[e+1]-a;i+=l*u-o*h,o=u,l=h}return i/2}function D5(n,e,t,r){let i=0;for(let s=0,a=t.length;s<a;++s){const o=t[s];i+=O5(n,e,o,r),e=o}return i}function Dz(n,e,t,r){let i=0;for(let s=0,a=t.length;s<a;++s){const o=t[s];i+=D5(n,e,o,r),e=o[o.length-1]}return i}class ep extends od{constructor(e,t){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}clone(){return new ep(this.flatCoordinates.slice(),this.layout)}closestPointXY(e,t,r,i){return i<sd(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(nI(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),iI(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,t,r,i))}getArea(){return O5(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return $c(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(e){const t=[];return t.length=Vv(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new ep(t,"XY")}getType(){return"LinearRing"}intersectsExtent(e){return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Fv(this.flatCoordinates,0,e,this.stride),this.changed()}}class Vl extends od{constructor(e,t,r){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(e[0]))this.setCoordinates(e,t);else if(t!==void 0&&r)this.setFlatCoordinates(t,e),this.ends_=r;else{const i=e,s=[],a=[];for(let l=0,u=i.length;l<u;++l){const h=i[l];Nn(s,h.getFlatCoordinates()),a.push(s.length)}const o=i.length===0?this.getLayout():i[0].getLayout();this.setFlatCoordinates(o,s),this.ends_=a}}appendLineString(e){Nn(this.flatCoordinates,e.getFlatCoordinates().slice()),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new Vl(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,r,i){return i<sd(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(rI(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),sI(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,e,t,r,i))}getCoordinateAtM(e,t,r){return this.layout!="XYM"&&this.layout!="XYZM"||this.flatCoordinates.length===0?null:(t=t!==void 0?t:!1,r=r!==void 0?r:!1,GU(this.flatCoordinates,0,this.ends_,this.stride,e,t,r))}getCoordinates(){return Xm(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(e){return e<0||this.ends_.length<=e?null:new Ra(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLineStrings(){const e=this.flatCoordinates,t=this.ends_,r=this.layout,i=[];let s=0;for(let a=0,o=t.length;a<o;++a){const l=t[a],u=new Ra(e.slice(s,l),r);i.push(u),s=l}return i}getLength(){const e=this.ends_;let t=0,r=0;for(let i=0,s=e.length;i<s;++i)r+=oI(this.flatCoordinates,t,e[i],this.stride),t=e[i];return r}getFlatMidpoints(){const e=[],t=this.flatCoordinates;let r=0;const i=this.ends_,s=this.stride;for(let a=0,o=i.length;a<o;++a){const l=i[a],u=ax(t,r,l,s,.5);Nn(e,u),r=l}return e}getSimplifiedGeometryInternal(e){const t=[],r=[];return t.length=g5(this.flatCoordinates,0,this.ends_,this.stride,e,t,0,r),new Vl(t,"XY",r)}getType(){return"MultiLineString"}intersectsExtent(e){return zU(this.flatCoordinates,0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const r=Kp(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=r.length===0?0:r[r.length-1],this.changed()}}class cd extends od{constructor(e,t){super(),t&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}appendPoint(e){Nn(this.flatCoordinates,e.getFlatCoordinates()),this.changed()}clone(){const e=new cd(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,r,i){if(i<sd(this.getExtent(),e,t))return i;const s=this.flatCoordinates,a=this.stride;for(let o=0,l=s.length;o<l;o+=a){const u=Ih(e,t,s[o],s[o+1]);if(u<i){i=u;for(let h=0;h<a;++h)r[h]=s[o+h];r.length=a}}return i}getCoordinates(){return $c(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(e){const t=this.flatCoordinates.length/this.stride;return e<0||t<=e?null:new ds(this.flatCoordinates.slice(e*this.stride,(e+1)*this.stride),this.layout)}getPoints(){const e=this.flatCoordinates,t=this.layout,r=this.stride,i=[];for(let s=0,a=e.length;s<a;s+=r){const o=new ds(e.slice(s,s+r),t);i.push(o)}return i}getType(){return"MultiPoint"}intersectsExtent(e){const t=this.flatCoordinates,r=this.stride;for(let i=0,s=t.length;i<s;i+=r){const a=t[i],o=t[i+1];if(Yb(e,a,o))return!0}return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Fv(this.flatCoordinates,0,e,this.stride),this.changed()}}class Ca extends od{constructor(e,t,r){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,t!==void 0&&r?(this.setFlatCoordinates(t,e),this.ends_=r):this.setCoordinates(e,t)}appendLinearRing(e){this.flatCoordinates?Nn(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new Ca(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,r,i){return i<sd(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(rI(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),sI(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,t,r,i))}containsXY(e,t){return aI(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,t)}getArea(){return D5(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),ux(t,0,this.ends_,this.stride,e)):t=this.flatCoordinates,Xm(t,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const e=Yo(this.getExtent());this.flatInteriorPoint_=gI(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new ds(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(e){return e<0||this.ends_.length<=e?null:new ep(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLinearRings(){const e=this.layout,t=this.flatCoordinates,r=this.ends_,i=[];let s=0;for(let a=0,o=r.length;a<o;++a){const l=r[a],u=new ep(t.slice(s,l),e);i.push(u),s=l}return i}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;pI(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=ux(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],r=[];return t.length=lI(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(e),t,0,r),new Ca(t,"XY",r)}getType(){return"Polygon"}intersectsExtent(e){return f5(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const r=Kp(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=r.length===0?0:r[r.length-1],this.changed()}}function i4(n){if(L0(n))throw new Error("Cannot create polygon from empty extent");const e=n[0],t=n[1],r=n[2],i=n[3],s=[e,t,e,i,r,i,r,t,e,t];return new Ca(s,"XY",[s.length])}class Vh extends od{constructor(e,t,r){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!r&&!Array.isArray(e[0])){const i=e,s=[],a=[];for(let o=0,l=i.length;o<l;++o){const u=i[o],h=s.length,f=u.getEnds();for(let g=0,y=f.length;g<y;++g)f[g]+=h;Nn(s,u.getFlatCoordinates()),a.push(f)}t=i.length===0?this.getLayout():i[0].getLayout(),e=s,r=a}t!==void 0&&r?(this.setFlatCoordinates(t,e),this.endss_=r):this.setCoordinates(e,t)}appendPolygon(e){let t;if(!this.flatCoordinates)this.flatCoordinates=e.getFlatCoordinates().slice(),t=e.getEnds().slice(),this.endss_.push();else{const r=this.flatCoordinates.length;Nn(this.flatCoordinates,e.getFlatCoordinates()),t=e.getEnds().slice();for(let i=0,s=t.length;i<s;++i)t[i]+=r}this.endss_.push(t),this.changed()}clone(){const e=this.endss_.length,t=new Array(e);for(let i=0;i<e;++i)t[i]=this.endss_[i].slice();const r=new Vh(this.flatCoordinates.slice(),this.layout,t);return r.applyProperties(this),r}closestPointXY(e,t,r,i){return i<sd(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(FU(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),jU(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,e,t,r,i))}containsXY(e,t){return UU(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e,t)}getArea(){return Dz(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),hT(t,0,this.endss_,this.stride,e)):t=this.flatCoordinates,aT(t,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const e=M5(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=N5(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new cd(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;L5(e,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=hT(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],r=[];return t.length=HU(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(e),t,0,r),new Vh(t,"XY",r)}getPolygon(e){if(e<0||this.endss_.length<=e)return null;let t;if(e===0)t=0;else{const s=this.endss_[e-1];t=s[s.length-1]}const r=this.endss_[e].slice(),i=r[r.length-1];if(t!==0)for(let s=0,a=r.length;s<a;++s)r[s]-=t;return new Ca(this.flatCoordinates.slice(t,i),this.layout,r)}getPolygons(){const e=this.layout,t=this.flatCoordinates,r=this.endss_,i=[];let s=0;for(let a=0,o=r.length;a<o;++a){const l=r[a].slice(),u=l[l.length-1];if(s!==0)for(let f=0,g=l.length;f<g;++f)l[f]-=s;const h=new Ca(t.slice(s,u),e,l);i.push(h),s=u}return i}getType(){return"MultiPolygon"}intersectsExtent(e){return $U(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,3),this.flatCoordinates||(this.flatCoordinates=[]);const r=u5(this.flatCoordinates,0,e,this.stride,this.endss_);if(r.length===0)this.flatCoordinates.length=0;else{const i=r[r.length-1];this.flatCoordinates.length=i.length===0?0:i[i.length-1]}this.changed()}}const s4=to();class Ks{constructor(e,t,r,i,s,a){this.styleFunction,this.extent_,this.id_=a,this.type_=e,this.flatCoordinates_=t,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=r||null,this.properties_=s,this.squaredTolerance_,this.stride_=i,this.simplifiedGeometry_}get(e){return this.properties_[e]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?zO(this.flatCoordinates_):Xb(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const e=Yo(this.getExtent());this.flatInteriorPoints_=gI(this.flatCoordinates_,0,this.ends_,2,e,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const e=Oz(this.flatCoordinates_,this.ends_),t=M5(this.flatCoordinates_,0,e,2);this.flatInteriorPoints_=N5(this.flatCoordinates_,0,e,2,t)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=ax(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const e=this.flatCoordinates_;let t=0;const r=this.ends_;for(let i=0,s=r.length;i<s;++i){const a=r[i],o=ax(e,t,a,2,.5);Nn(this.flatMidpoints_,o),t=a}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(e){return this}simplifyTransformed(e,t){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(e){e=qn(e);const t=e.getExtent(),r=e.getWorldExtent();if(t&&r){const i=Wr(r)/Wr(t);Xo(s4,r[0],r[3],i,-i,0,0,0),eu(this.flatCoordinates_,0,this.flatCoordinates_.length,2,s4,this.flatCoordinates_)}}applyTransform(e){e(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new Ks(this.type_,this.flatCoordinates_.slice(),this.ends_?.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=VO((e,t)=>{if(e===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),t&&this.simplifiedGeometry_.applyTransform(t);const r=this.simplifiedGeometry_.getFlatCoordinates();let i;switch(this.type_){case"LineString":r.length=Vv(r,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,e,r,0),i=[r.length];break;case"MultiLineString":i=[],r.length=g5(r,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,e,r,0,i);break;case"Polygon":i=[],r.length=lI(r,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(e),r,0,i);break}return i&&(this.simplifiedGeometry_=new Ks(this.type_,r,i,2,this.properties_,this.id_)),this.squaredTolerance_=e,this.simplifiedGeometry_}),this}}Ks.prototype.getFlatCoordinates=Ks.prototype.getOrientedFlatCoordinates;function F5(n,e,t=0,r=n.length-1,i=Fz){for(;r>t;){if(r-t>600){const l=r-t+1,u=e-t+1,h=Math.log(l),f=.5*Math.exp(2*h/3),g=.5*Math.sqrt(h*f*(l-f)/l)*(u-l/2<0?-1:1),y=Math.max(t,Math.floor(e-u*f/l+g)),v=Math.min(r,Math.floor(e+(l-u)*f/l+g));F5(n,e,y,v,i)}const s=n[e];let a=t,o=r;for(Vg(n,t,e),i(n[r],s)>0&&Vg(n,t,r);a<o;){for(Vg(n,a,o),a++,o--;i(n[a],s)<0;)a++;for(;i(n[o],s)>0;)o--}i(n[t],s)===0?Vg(n,t,o):(o++,Vg(n,o,r)),o<=e&&(t=o+1),e<=o&&(r=o-1)}}function Vg(n,e,t){const r=n[e];n[e]=n[t],n[t]=r}function Fz(n,e){return n<e?-1:n>e?1:0}let j5=class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data;const r=[];if(!$y(e,t))return r;const i=this.toBBox,s=[];for(;t;){for(let a=0;a<t.children.length;a++){const o=t.children[a],l=t.leaf?i(o):o;$y(e,l)&&(t.leaf?r.push(o):O2(e,l)?this._all(o,r):s.push(o))}t=s.pop()}return r}collides(e){let t=this.data;if(!$y(e,t))return!1;const r=[];for(;t;){for(let i=0;i<t.children.length;i++){const s=t.children[i],a=t.leaf?this.toBBox(s):s;if($y(e,a)){if(t.leaf||O2(e,a))return!0;r.push(s)}}t=r.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let r=0;r<e.length;r++)this.insert(e[r]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=t;else if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const r=this.data;this.data=t,t=r}this._insert(t,this.data.height-t.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=vf([]),this}remove(e,t){if(!e)return this;let r=this.data;const i=this.toBBox(e),s=[],a=[];let o,l,u;for(;r||s.length;){if(r||(r=s.pop(),l=s[s.length-1],o=a.pop(),u=!0),r.leaf){const h=jz(e,r.children,t);if(h!==-1)return r.children.splice(h,1),s.push(r),this._condense(s),this}!u&&!r.leaf&&O2(r,i)?(s.push(r),a.push(o),o=0,l=r,r=r.children[0]):l?(o++,r=l.children[o],u=!1):r=null}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){const r=[];for(;e;)e.leaf?t.push(...e.children):r.push(...e.children),e=r.pop();return t}_build(e,t,r,i){const s=r-t+1;let a=this._maxEntries,o;if(s<=a)return o=vf(e.slice(t,r+1)),rf(o,this.toBBox),o;i||(i=Math.ceil(Math.log(s)/Math.log(a)),a=Math.ceil(s/Math.pow(a,i-1))),o=vf([]),o.leaf=!1,o.height=i;const l=Math.ceil(s/a),u=l*Math.ceil(Math.sqrt(a));a4(e,t,r,u,this.compareMinX);for(let h=t;h<=r;h+=u){const f=Math.min(h+u-1,r);a4(e,h,f,l,this.compareMinY);for(let g=h;g<=f;g+=l){const y=Math.min(g+l-1,f);o.children.push(this._build(e,g,y,i-1))}}return rf(o,this.toBBox),o}_chooseSubtree(e,t,r,i){for(;i.push(t),!(t.leaf||i.length-1===r);){let s=1/0,a=1/0,o;for(let l=0;l<t.children.length;l++){const u=t.children[l],h=L2(u),f=Bz(e,u)-h;f<a?(a=f,s=h<s?h:s,o=u):f===a&&h<s&&(s=h,o=u)}t=o||t.children[0]}return t}_insert(e,t,r){const i=r?e:this.toBBox(e),s=[],a=this._chooseSubtree(i,this.data,t,s);for(a.children.push(e),Zg(a,i);t>=0&&s[t].children.length>this._maxEntries;)this._split(s,t),t--;this._adjustParentBBoxes(i,s,t)}_split(e,t){const r=e[t],i=r.children.length,s=this._minEntries;this._chooseSplitAxis(r,s,i);const a=this._chooseSplitIndex(r,s,i),o=vf(r.children.splice(a,r.children.length-a));o.height=r.height,o.leaf=r.leaf,rf(r,this.toBBox),rf(o,this.toBBox),t?e[t-1].children.push(o):this._splitRoot(r,o)}_splitRoot(e,t){this.data=vf([e,t]),this.data.height=e.height+1,this.data.leaf=!1,rf(this.data,this.toBBox)}_chooseSplitIndex(e,t,r){let i,s=1/0,a=1/0;for(let o=t;o<=r-t;o++){const l=qg(e,0,o,this.toBBox),u=qg(e,o,r,this.toBBox),h=Uz(l,u),f=L2(l)+L2(u);h<s?(s=h,i=o,a=f<a?f:a):h===s&&f<a&&(a=f,i=o)}return i||r-t}_chooseSplitAxis(e,t,r){const i=e.leaf?this.compareMinX:Vz,s=e.leaf?this.compareMinY:Gz,a=this._allDistMargin(e,t,r,i),o=this._allDistMargin(e,t,r,s);a<o&&e.children.sort(i)}_allDistMargin(e,t,r,i){e.children.sort(i);const s=this.toBBox,a=qg(e,0,t,s),o=qg(e,r-t,r,s);let l=zy(a)+zy(o);for(let u=t;u<r-t;u++){const h=e.children[u];Zg(a,e.leaf?s(h):h),l+=zy(a)}for(let u=r-t-1;u>=t;u--){const h=e.children[u];Zg(o,e.leaf?s(h):h),l+=zy(o)}return l}_adjustParentBBoxes(e,t,r){for(let i=r;i>=0;i--)Zg(t[i],e)}_condense(e){for(let t=e.length-1,r;t>=0;t--)e[t].children.length===0?t>0?(r=e[t-1].children,r.splice(r.indexOf(e[t]),1)):this.clear():rf(e[t],this.toBBox)}};function jz(n,e,t){if(!t)return e.indexOf(n);for(let r=0;r<e.length;r++)if(t(n,e[r]))return r;return-1}function rf(n,e){qg(n,0,n.children.length,e,n)}function qg(n,e,t,r,i){i||(i=vf(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(let s=e;s<t;s++){const a=n.children[s];Zg(i,n.leaf?r(a):a)}return i}function Zg(n,e){return n.minX=Math.min(n.minX,e.minX),n.minY=Math.min(n.minY,e.minY),n.maxX=Math.max(n.maxX,e.maxX),n.maxY=Math.max(n.maxY,e.maxY),n}function Vz(n,e){return n.minX-e.minX}function Gz(n,e){return n.minY-e.minY}function L2(n){return(n.maxX-n.minX)*(n.maxY-n.minY)}function zy(n){return n.maxX-n.minX+(n.maxY-n.minY)}function Bz(n,e){return(Math.max(e.maxX,n.maxX)-Math.min(e.minX,n.minX))*(Math.max(e.maxY,n.maxY)-Math.min(e.minY,n.minY))}function Uz(n,e){const t=Math.max(n.minX,e.minX),r=Math.max(n.minY,e.minY),i=Math.min(n.maxX,e.maxX),s=Math.min(n.maxY,e.maxY);return Math.max(0,i-t)*Math.max(0,s-r)}function O2(n,e){return n.minX<=e.minX&&n.minY<=e.minY&&e.maxX<=n.maxX&&e.maxY<=n.maxY}function $y(n,e){return e.minX<=n.maxX&&e.minY<=n.maxY&&e.maxX>=n.minX&&e.maxY>=n.minY}function vf(n){return{children:n,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function a4(n,e,t,r,i){const s=[e,t];for(;s.length;){if(t=s.pop(),e=s.pop(),t-e<=r)continue;const a=e+Math.ceil((t-e)/r/2)*r;F5(n,a,e,t,i),s.push(e,a,a,t)}}class o4{constructor(e){this.rbush_=new j5(e),this.items_={}}insert(e,t){const r={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:t};this.rbush_.insert(r),this.items_[bn(t)]=r}load(e,t){const r=new Array(t.length);for(let i=0,s=t.length;i<s;i++){const a=e[i],o=t[i],l={minX:a[0],minY:a[1],maxX:a[2],maxY:a[3],value:o};r[i]=l,this.items_[bn(o)]=l}this.rbush_.load(r)}remove(e){const t=bn(e),r=this.items_[t];return delete this.items_[t],this.rbush_.remove(r)!==null}update(e,t){const r=this.items_[bn(t)],i=[r.minX,r.minY,r.maxX,r.maxY];l0(i,e)||(this.remove(t),this.insert(e,t))}getAll(){return this.rbush_.all().map(function(t){return t.value})}getInExtent(e){const t={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this.rbush_.search(t).map(function(i){return i.value})}forEach(e){return this.forEach_(this.getAll(),e)}forEachInExtent(e,t){return this.forEach_(this.getInExtent(e),t)}forEach_(e,t){let r;for(let i=0,s=e.length;i<s;i++)if(r=t(e[i]),r)return r;return r}isEmpty(){return Lh(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(e){const t=this.rbush_.toJSON();return lu(t.minX,t.minY,t.maxX,t.maxY,e)}concat(e){this.rbush_.load(e.rbush_.all());for(const t in e.items_)this.items_[t]=e.items_[t]}}class yI extends nl{constructor(e){super(),this.projection=qn(e.projection),this.attributions_=l4(e.attributions),this.attributionsCollapsible_=e.attributionsCollapsible??!0,this.loading=!1,this.state_=e.state!==void 0?e.state:"ready",this.wrapX_=e.wrapX!==void 0?e.wrapX:!1,this.interpolate_=!!e.interpolate,this.viewResolver=null,this.viewRejector=null;const t=this;this.viewPromise_=new Promise(function(r,i){t.viewResolver=r,t.viewRejector=i})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(e){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(e){this.attributions_=l4(e),this.changed()}setState(e){this.state_=e,this.changed()}}function l4(n){return n?typeof n=="function"?n:(Array.isArray(n)||(n=[n]),e=>n):null}const ga={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};class Ec extends tl{constructor(e,t,r){super(e),this.feature=t,this.features=r}}class O0 extends yI{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:e.wrapX!==void 0?e.wrapX:!0}),this.on,this.once,this.un,this.loader_=Hm,this.format_=e.format||null,this.overlaps_=e.overlaps===void 0?!0:e.overlaps,this.url_=e.url,e.loader!==void 0?this.loader_=e.loader:this.url_!==void 0&&(Dn(this.format_,"`format` must be set when `url` is set"),this.loader_=r4(this.url_,this.format_)),this.strategy_=e.strategy!==void 0?e.strategy:Nz;const t=e.useSpatialIndex!==void 0?e.useSpatialIndex:!0;this.featuresRtree_=t?new o4:null,this.loadedExtentsRtree_=new o4,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let r,i;Array.isArray(e.features)?i=e.features:e.features&&(r=e.features,i=r.getArray()),!t&&r===void 0&&(r=new wa(i)),i!==void 0&&this.addFeaturesInternal(i),r!==void 0&&this.bindFeaturesCollection_(r)}addFeature(e){this.addFeatureInternal(e),this.changed()}addFeatureInternal(e){const t=bn(e);if(!this.addToIndex_(t,e)){this.featuresCollection_&&this.featuresCollection_.remove(e);return}this.setupChangeEvents_(t,e);const r=e.getGeometry();if(r){const i=r.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(i,e)}else this.nullGeometryFeatures_[t]=e;this.dispatchEvent(new Ec(ga.ADDFEATURE,e))}setupChangeEvents_(e,t){t instanceof Ks||(this.featureChangeKeys_[e]=[yn(t,Yt.CHANGE,this.handleFeatureChange_,this),yn(t,o0.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(e,t){let r=!0;if(t.getId()!==void 0){const i=String(t.getId());if(!(i in this.idIndex_))this.idIndex_[i]=t;else if(t instanceof Ks){const s=this.idIndex_[i];s instanceof Ks?Array.isArray(s)?s.push(t):this.idIndex_[i]=[s,t]:r=!1}else r=!1}return r&&(Dn(!(e in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[e]=t),r}addFeatures(e){this.addFeaturesInternal(e),this.changed()}addFeaturesInternal(e){const t=[],r=[],i=[];for(let s=0,a=e.length;s<a;s++){const o=e[s],l=bn(o);this.addToIndex_(l,o)&&r.push(o)}for(let s=0,a=r.length;s<a;s++){const o=r[s],l=bn(o);this.setupChangeEvents_(l,o);const u=o.getGeometry();if(u){const h=u.getExtent();t.push(h),i.push(o)}else this.nullGeometryFeatures_[l]=o}if(this.featuresRtree_&&this.featuresRtree_.load(t,i),this.hasListener(ga.ADDFEATURE))for(let s=0,a=r.length;s<a;s++)this.dispatchEvent(new Ec(ga.ADDFEATURE,r[s]))}bindFeaturesCollection_(e){let t=!1;this.addEventListener(ga.ADDFEATURE,function(r){t||(t=!0,e.push(r.feature),t=!1)}),this.addEventListener(ga.REMOVEFEATURE,function(r){t||(t=!0,e.remove(r.feature),t=!1)}),e.addEventListener(ws.ADD,r=>{t||(t=!0,this.addFeature(r.element),t=!1)}),e.addEventListener(ws.REMOVE,r=>{t||(t=!0,this.removeFeature(r.element),t=!1)}),this.featuresCollection_=e}clear(e){if(e){for(const r in this.featureChangeKeys_)this.featureChangeKeys_[r].forEach(nr);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(r=>{this.removeFeatureInternal(r)});for(const r in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[r])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const t=new Ec(ga.CLEAR);this.dispatchEvent(t),this.changed()}forEachFeature(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureAtCoordinateDirect(e,t){const r=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(r,function(i){const s=i.getGeometry();if(s instanceof Ks||s.intersectsCoordinate(e))return t(i)})}forEachFeatureInExtent(e,t){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureIntersectingExtent(e,t){return this.forEachFeatureInExtent(e,function(r){const i=r.getGeometry();if(i instanceof Ks||i.intersectsExtent(e)){const s=t(r);if(s)return s}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let e;return this.featuresCollection_?e=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(e=this.featuresRtree_.getAll(),Lh(this.nullGeometryFeatures_)||Nn(e,Object.values(this.nullGeometryFeatures_))),e}getFeaturesAtCoordinate(e){const t=[];return this.forEachFeatureAtCoordinateDirect(e,function(r){t.push(r)}),t}getFeaturesInExtent(e,t){if(this.featuresRtree_){if(!(t&&t.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(e);const i=XO(e,t);return[].concat(...i.map(s=>this.featuresRtree_.getInExtent(s)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(e,t){const r=e[0],i=e[1];let s=null;const a=[NaN,NaN];let o=1/0;const l=[-1/0,-1/0,1/0,1/0];return t=t||Wm,this.featuresRtree_.forEachInExtent(l,function(u){if(t(u)){const h=u.getGeometry(),f=o;if(o=h instanceof Ks?0:h.closestPointXY(r,i,a,o),o<f){s=u;const g=Math.sqrt(o);l[0]=r-g,l[1]=i-g,l[2]=r+g,l[3]=i+g}}}),s}getExtent(e){return this.featuresRtree_.getExtent(e)}getFeatureById(e){const t=this.idIndex_[e.toString()];return t!==void 0?t:null}getFeatureByUid(e){const t=this.uidIndex_[e];return t!==void 0?t:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(e){const t=e.target,r=bn(t),i=t.getGeometry();if(!i)r in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(t),this.nullGeometryFeatures_[r]=t);else{const a=i.getExtent();r in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[r],this.featuresRtree_&&this.featuresRtree_.insert(a,t)):this.featuresRtree_&&this.featuresRtree_.update(a,t)}const s=t.getId();if(s!==void 0){const a=s.toString();this.idIndex_[a]!==t&&(this.removeFromIdIndex_(t),this.idIndex_[a]=t)}else this.removeFromIdIndex_(t),this.uidIndex_[r]=t;this.changed(),this.dispatchEvent(new Ec(ga.CHANGEFEATURE,t))}hasFeature(e){const t=e.getId();return t!==void 0?t in this.idIndex_:bn(e)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&Lh(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(e,t,r){const i=this.loadedExtentsRtree_,s=this.strategy_(e,t,r);for(let a=0,o=s.length;a<o;++a){const l=s[a];i.forEachInExtent(l,function(h){return Uc(h.extent,l)})||(++this.loadingExtentsCount_,this.dispatchEvent(new Ec(ga.FEATURESLOADSTART)),this.loader_.call(this,l,t,r,h=>{--this.loadingExtentsCount_,this.dispatchEvent(new Ec(ga.FEATURESLOADEND,void 0,h))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new Ec(ga.FEATURESLOADERROR))}),i.insert(l,{extent:l.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(e){const t=this.loadedExtentsRtree_,r=t.forEachInExtent(e,function(i){if(l0(i.extent,e))return i});r&&t.remove(r)}removeFeatures(e){let t=!1;for(let r=0,i=e.length;r<i;++r)t=this.removeFeatureInternal(e[r])||t;t&&this.changed()}removeFeature(e){if(!e)return;this.removeFeatureInternal(e)&&this.changed()}removeFeatureInternal(e){const t=bn(e);if(!(t in this.uidIndex_))return!1;t in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[t]:this.featuresRtree_&&this.featuresRtree_.remove(e),this.featureChangeKeys_[t]?.forEach(nr),delete this.featureChangeKeys_[t];const i=e.getId();if(i!==void 0){const s=i.toString(),a=this.idIndex_[s];a===e?delete this.idIndex_[s]:Array.isArray(a)&&(a.splice(a.indexOf(e),1),a.length===1&&(this.idIndex_[s]=a[0]))}return delete this.uidIndex_[t],this.hasListener(ga.REMOVEFEATURE)&&this.dispatchEvent(new Ec(ga.REMOVEFEATURE,e)),!0}removeFromIdIndex_(e){for(const t in this.idIndex_)if(this.idIndex_[t]===e){delete this.idIndex_[t];break}}setLoader(e){this.loader_=e}setUrl(e){Dn(this.format_,"`format` must be set when `url` is set"),this.url_=e,this.setLoader(r4(e,this.format_))}setOverlaps(e){this.overlaps_=e,this.changed()}}class kr{constructor(e){e=e||{},this.patternImage_=null,this.color_=null,e.color!==void 0&&this.setColor(e.color)}clone(){const e=this.getColor();return new kr({color:Array.isArray(e)?e.slice():e||void 0})}getColor(){return this.color_}setColor(e){if(e!==null&&typeof e=="object"&&"src"in e){const t=lx(null,e.src,"anonymous",void 0,e.offset?null:e.color?e.color:null,!(e.offset&&e.size));t.ready().then(()=>{this.patternImage_=null}),t.getImageState()===vt.IDLE&&t.load(),t.getImageState()===vt.LOADING&&(this.patternImage_=t)}this.color_=e}getKey(){const e=this.getColor();return e?e instanceof CanvasPattern||e instanceof CanvasGradient?bn(e):typeof e=="object"&&"src"in e?e.src+":"+e.offset:jh(e).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}class Hr{constructor(e){e=e||{},this.color_=e.color!==void 0?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=e.lineDash!==void 0?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}clone(){const e=this.getColor();return new Hr({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(e){this.color_=e}setLineCap(e){this.lineCap_=e}setLineDash(e){this.lineDash_=e}setLineDashOffset(e){this.lineDashOffset_=e}setLineJoin(e){this.lineJoin_=e}setMiterLimit(e){this.miterLimit_=e}setWidth(e){this.width_=e}}function c4(n){return n[0]>0&&n[1]>0}function zz(n,e,t){return t===void 0&&(t=[0,0]),t[0]=n[0]*e+.5|0,t[1]=n[1]*e+.5|0,t}function Is(n,e){return Array.isArray(n)?n:(e===void 0?e=[n,n]:(e[0]=n,e[1]=n),e)}class Bv{constructor(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=Is(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new Bv({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return Vt()}getImage(e){return Vt()}getHitDetectionImage(){return Vt()}getPixelRatio(e){return 1}getImageState(){return Vt()}getImageSize(){return Vt()}getOrigin(){return Vt()}getSize(){return Vt()}setDisplacement(e){this.displacement_=e}setOpacity(e){this.opacity_=e}setRotateWithView(e){this.rotateWithView_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=Is(e)}listenImageChange(e){Vt()}load(){Vt()}unlistenImageChange(e){Vt()}ready(){return Promise.resolve()}}class Uv extends Bv{constructor(e){super({opacity:1,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,rotation:e.rotation!==void 0?e.rotation:0,scale:e.scale!==void 0?e.scale:1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=e.fill!==void 0?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius=e.radius,this.radius2_=e.radius2,this.angle_=e.angle!==void 0?e.angle:0,this.stroke_=e.stroke!==void 0?e.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?vt.LOADING:vt.LOADED,this.imageState_===vt.LOADING&&this.ready().then(()=>this.imageState_=vt.LOADED),this.render()}clone(){const e=this.getScale(),t=new Uv({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}getAnchor(){const e=this.size_,t=this.getDisplacement(),r=this.getScaleArray();return[e[0]/2-t[0]/r[0],e[1]/2+t[1]/r[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(e){this.fill_=e,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(e){const t=this.fill_?.getKey(),r=`${e},${this.angle_},${this.radius},${this.radius2_},${this.points_},${t}`+Object.values(this.renderOptions_).join(",");let i=Sa.get(r,null,null)?.getImage(1);if(!i){const s=this.renderOptions_,a=Math.ceil(s.size*e),o=ri(a,a);this.draw_(s,o,e),i=o.canvas,Sa.set(r,null,null,new T5(i,void 0,null,vt.LOADED,null))}return i}getPixelRatio(e){return e}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e,this.render()}listenImageChange(e){}load(){}unlistenImageChange(e){}calculateLineJoinSize_(e,t,r){if(t===0||this.points_===1/0||e!=="bevel"&&e!=="miter")return t;let i=this.radius,s=this.radius2_===void 0?i:this.radius2_;if(i<s){const z=i;i=s,s=z}const a=this.radius2_===void 0?this.points_:this.points_*2,o=2*Math.PI/a,l=s*Math.sin(o),u=Math.sqrt(s*s-l*l),h=i-u,f=Math.sqrt(l*l+h*h),g=f/l;if(e==="miter"&&g<=r)return g*t;const y=t/2/g,v=t/2*(h/f),E=Math.sqrt((i+y)*(i+y)+v*v)-i;if(this.radius2_===void 0||e==="bevel")return E*2;const T=i*Math.sin(o),b=Math.sqrt(i*i-T*T),I=s-b,F=Math.sqrt(T*T+I*I)/T;if(F<=r){const z=F*t/2-s-i;return 2*Math.max(E,z)}return E*2}createRenderOptions(){let e=h0,t=d0,r=0,i=null,s=0,a,o=0;this.stroke_&&(a=Fo(this.stroke_.getColor()??Zm),o=this.stroke_.getWidth()??Jm,i=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,t=this.stroke_.getLineJoin()??d0,e=this.stroke_.getLineCap()??h0,r=this.stroke_.getMiterLimit()??qm);const l=this.calculateLineJoinSize_(t,o,r),u=Math.max(this.radius,this.radius2_||0),h=Math.ceil(2*u+l);return{strokeStyle:a,strokeWidth:o,size:h,lineCap:e,lineDash:i,lineDashOffset:s,lineJoin:t,miterLimit:r}}render(){this.renderOptions_=this.createRenderOptions();const e=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[e,e]}draw_(e,t,r){if(t.scale(r,r),t.translate(e.size/2,e.size/2),this.createPath_(t),this.fill_){let i=this.fill_.getColor();i===null&&(i=Es),t.fillStyle=Fo(i),t.fill()}e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}createHitDetectionCanvas_(e){let t;if(this.fill_){let r=this.fill_.getColor(),i=0;typeof r=="string"&&(r=jh(r)),r===null?i=1:Array.isArray(r)&&(i=r.length===4?r[3]:1),i===0&&(t=ri(e.size,e.size),this.drawHitDetectionCanvas_(e,t))}return t?t.canvas:this.getImage(1)}createPath_(e){let t=this.points_;const r=this.radius;if(t===1/0)e.arc(0,0,r,0,2*Math.PI);else{const i=this.radius2_===void 0?r:this.radius2_;this.radius2_!==void 0&&(t*=2);const s=this.angle_-Math.PI/2,a=2*Math.PI/t;for(let o=0;o<t;o++){const l=s+o*a,u=o%2===0?r:i;e.lineTo(u*Math.cos(l),u*Math.sin(l))}e.closePath()}}drawHitDetectionCanvas_(e,t){t.translate(e.size/2,e.size/2),this.createPath_(t),t.fillStyle=Es,t.fill(),e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class ka extends Uv{constructor(e){e=e||{radius:5},super({points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:e.scale!==void 0?e.scale:1,rotation:e.rotation!==void 0?e.rotation:0,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode})}clone(){const e=this.getScale(),t=new ka({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}setRadius(e){this.radius=e,this.render()}}class $n{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=u4,e.geometry!==void 0&&this.setGeometry(e.geometry),this.fill_=e.fill!==void 0?e.fill:null,this.image_=e.image!==void 0?e.image:null,this.renderer_=e.renderer!==void 0?e.renderer:null,this.hitDetectionRenderer_=e.hitDetectionRenderer!==void 0?e.hitDetectionRenderer:null,this.stroke_=e.stroke!==void 0?e.stroke:null,this.text_=e.text!==void 0?e.text:null,this.zIndex_=e.zIndex}clone(){let e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new $n({geometry:e??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(e){this.renderer_=e}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(e){this.fill_=e}getImage(){return this.image_}setImage(e){this.image_=e}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e}getText(){return this.text_}setText(e){this.text_=e}getZIndex(){return this.zIndex_}setGeometry(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(t){return t.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=u4,this.geometry_=e}setZIndex(e){this.zIndex_=e}}function $z(n){let e;if(typeof n=="function")e=n;else{let t;Array.isArray(n)?t=n:(Dn(typeof n.getZIndex=="function","Expected an `Style` or an array of `Style`"),t=[n]),e=function(){return t}}return e}let D2=null;function V5(n,e){if(!D2){const t=new kr({color:"rgba(255,255,255,0.4)"}),r=new Hr({color:"#3399CC",width:1.25});D2=[new $n({image:new ka({fill:t,stroke:r,radius:5}),fill:t,stroke:r})]}return D2}function u4(n){return n.getGeometry()}const Wz="#333";class ud{constructor(e){e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.keepUpright_=e.keepUpright,this.scale_=e.scale,this.scaleArray_=Is(e.scale!==void 0?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=e.fill!==void 0?e.fill:new kr({color:Wz}),this.maxAngle_=e.maxAngle!==void 0?e.maxAngle:Math.PI/4,this.placement_=e.placement!==void 0?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=e.stroke!==void 0?e.stroke:null,this.offsetX_=e.offsetX!==void 0?e.offsetX:0,this.offsetY_=e.offsetY!==void 0?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=e.padding===void 0?null:e.padding,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new ud({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()instanceof kr?this.getFill().clone():this.getFill(),stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(e){this.overflow_=e}setFont(e){this.font_=e}setMaxAngle(e){this.maxAngle_=e}setOffsetX(e){this.offsetX_=e}setOffsetY(e){this.offsetY_=e}setPlacement(e){this.placement_=e}setRepeat(e){this.repeat_=e}setRotateWithView(e){this.rotateWithView_=e}setKeepUpright(e){this.keepUpright_=e}setFill(e){this.fill_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=Is(e!==void 0?e:1)}setStroke(e){this.stroke_=e}setText(e){this.text_=e}setTextAlign(e){this.textAlign_=e}setJustify(e){this.justify_=e}setTextBaseline(e){this.textBaseline_=e}setBackgroundFill(e){this.backgroundFill_=e}setBackgroundStroke(e){this.backgroundStroke_=e}setPadding(e){this.padding_=e}}const di={ANIMATING:0,INTERACTING:1},Nt={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Wy=[Nt.FILL],Hc=[Nt.STROKE],vh=[Nt.BEGIN_PATH],h4=[Nt.CLOSE_PATH];class Xp extends b5{constructor(e,t,r,i){super(),this.tolerance=e,this.maxExtent=t,this.pixelRatio=i,this.maxLineWidth=0,this.resolution=r,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(e){const t=this.pixelRatio;return t==1?e:e.map(function(r){return r*t})}appendFlatPointCoordinates(e,t){const r=this.getBufferedMaxExtent(),i=this.tmpCoordinate_,s=this.coordinates;let a=s.length;for(let o=0,l=e.length;o<l;o+=t)i[0]=e[o],i[1]=e[o+1],Oh(r,i)&&(s[a++]=i[0],s[a++]=i[1]);return a}appendFlatLineCoordinates(e,t,r,i,s,a){const o=this.coordinates;let l=o.length;const u=this.getBufferedMaxExtent();a&&(t+=i);let h=e[t],f=e[t+1];const g=this.tmpCoordinate_;let y=!0,v,x,E;for(v=t+i;v<r;v+=i)g[0]=e[v],g[1]=e[v+1],E=ZS(u,g),E!==x?(y&&(o[l++]=h,o[l++]=f,y=!1),o[l++]=g[0],o[l++]=g[1]):E===ui.INTERSECTING?(o[l++]=g[0],o[l++]=g[1],y=!1):y=!0,h=g[0],f=g[1],x=E;return(s&&y||v===t+i)&&(o[l++]=h,o[l++]=f),l}drawCustomCoordinates_(e,t,r,i,s){for(let a=0,o=r.length;a<o;++a){const l=r[a],u=this.appendFlatLineCoordinates(e,t,l,i,!1,!1);s.push(u),t=l}return t}drawCustom(e,t,r,i,s){this.beginGeometry(e,t,s);const a=e.getType(),o=e.getStride(),l=this.coordinates.length;let u,h,f,g,y;switch(a){case"MultiPolygon":u=e.getOrientedFlatCoordinates(),g=[];const v=e.getEndss();y=0;for(let x=0,E=v.length;x<E;++x){const T=[];y=this.drawCustomCoordinates_(u,y,v[x],o,T),g.push(T)}this.instructions.push([Nt.CUSTOM,l,g,e,r,aT,s]),this.hitDetectionInstructions.push([Nt.CUSTOM,l,g,e,i||r,aT,s]);break;case"Polygon":case"MultiLineString":f=[],u=a=="Polygon"?e.getOrientedFlatCoordinates():e.getFlatCoordinates(),y=this.drawCustomCoordinates_(u,0,e.getEnds(),o,f),this.instructions.push([Nt.CUSTOM,l,f,e,r,Xm,s]),this.hitDetectionInstructions.push([Nt.CUSTOM,l,f,e,i||r,Xm,s]);break;case"LineString":case"Circle":u=e.getFlatCoordinates(),h=this.appendFlatLineCoordinates(u,0,u.length,o,!1,!1),this.instructions.push([Nt.CUSTOM,l,h,e,r,$c,s]),this.hitDetectionInstructions.push([Nt.CUSTOM,l,h,e,i||r,$c,s]);break;case"MultiPoint":u=e.getFlatCoordinates(),h=this.appendFlatPointCoordinates(u,o),h>l&&(this.instructions.push([Nt.CUSTOM,l,h,e,r,$c,s]),this.hitDetectionInstructions.push([Nt.CUSTOM,l,h,e,i||r,$c,s]));break;case"Point":u=e.getFlatCoordinates(),this.coordinates.push(u[0],u[1]),h=this.coordinates.length,this.instructions.push([Nt.CUSTOM,l,h,e,r,void 0,s]),this.hitDetectionInstructions.push([Nt.CUSTOM,l,h,e,i||r,void 0,s]);break}this.endGeometry(t)}beginGeometry(e,t,r){this.beginGeometryInstruction1_=[Nt.BEGIN_GEOMETRY,t,0,e,r],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[Nt.BEGIN_GEOMETRY,t,0,e,r],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const e=this.hitDetectionInstructions;e.reverse();let t;const r=e.length;let i,s,a=-1;for(t=0;t<r;++t)i=e[t],s=i[0],s==Nt.END_GEOMETRY?a=t:s==Nt.BEGIN_GEOMETRY&&(i[2]=t,BB(this.hitDetectionInstructions,a,t),a=-1)}fillStyleToState(e,t={}){if(e){const r=e.getColor();t.fillPatternScale=r&&typeof r=="object"&&"src"in r?this.pixelRatio:1,t.fillStyle=Fo(r||Es)}else t.fillStyle=void 0;return t}strokeStyleToState(e,t={}){if(e){const r=e.getColor();t.strokeStyle=Fo(r||Zm);const i=e.getLineCap();t.lineCap=i!==void 0?i:h0;const s=e.getLineDash();t.lineDash=s?s.slice():Ml;const a=e.getLineDashOffset();t.lineDashOffset=a||Nl;const o=e.getLineJoin();t.lineJoin=o!==void 0?o:d0;const l=e.getWidth();t.lineWidth=l!==void 0?l:Jm;const u=e.getMiterLimit();t.miterLimit=u!==void 0?u:qm,t.lineWidth>this.maxLineWidth&&(this.maxLineWidth=t.lineWidth,this.bufferedMaxExtent_=null)}else t.strokeStyle=void 0,t.lineCap=void 0,t.lineDash=null,t.lineDashOffset=void 0,t.lineJoin=void 0,t.lineWidth=void 0,t.miterLimit=void 0;return t}setFillStrokeStyle(e,t){const r=this.state;this.fillStyleToState(e,r),this.strokeStyleToState(t,r)}createFill(e){const t=e.fillStyle,r=[Nt.SET_FILL_STYLE,t];return typeof t!="string"&&r.push(e.fillPatternScale),r}applyStroke(e){this.instructions.push(this.createStroke(e))}createStroke(e){return[Nt.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth*this.pixelRatio,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash?this.applyPixelRatio(e.lineDash):null,e.lineDashOffset*this.pixelRatio]}updateFillStyle(e,t){const r=e.fillStyle;(typeof r!="string"||e.currentFillStyle!=r)&&(this.instructions.push(t.call(this,e)),e.currentFillStyle=r)}updateStrokeStyle(e,t){const r=e.strokeStyle,i=e.lineCap,s=e.lineDash,a=e.lineDashOffset,o=e.lineJoin,l=e.lineWidth,u=e.miterLimit;(e.currentStrokeStyle!=r||e.currentLineCap!=i||s!=e.currentLineDash&&!Su(e.currentLineDash,s)||e.currentLineDashOffset!=a||e.currentLineJoin!=o||e.currentLineWidth!=l||e.currentMiterLimit!=u)&&(t.call(this,e),e.currentStrokeStyle=r,e.currentLineCap=i,e.currentLineDash=s,e.currentLineDashOffset=a,e.currentLineJoin=o,e.currentLineWidth=l,e.currentMiterLimit=u)}endGeometry(e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const t=[Nt.END_GEOMETRY,e];this.instructions.push(t),this.hitDetectionInstructions.push(t)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=UO(this.maxExtent),this.maxLineWidth>0)){const e=this.resolution*(this.maxLineWidth+1)/2;Km(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class Hz extends Xp{constructor(e,t,r,i){super(e,t,r,i),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(e,t,r){if(!this.image_||this.maxExtent&&!Oh(this.maxExtent,e.getFlatCoordinates()))return;this.beginGeometry(e,t,r);const i=e.getFlatCoordinates(),s=e.getStride(),a=this.coordinates.length,o=this.appendFlatPointCoordinates(i,s);this.instructions.push([Nt.DRAW_IMAGE,a,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Nt.DRAW_IMAGE,a,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}drawMultiPoint(e,t,r){if(!this.image_)return;this.beginGeometry(e,t,r);const i=e.getFlatCoordinates(),s=[];for(let l=0,u=i.length;l<u;l+=e.getStride())(!this.maxExtent||Oh(this.maxExtent,i.slice(l,l+2)))&&s.push(i[l],i[l+1]);const a=this.coordinates.length,o=this.appendFlatPointCoordinates(s,2);this.instructions.push([Nt.DRAW_IMAGE,a,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Nt.DRAW_IMAGE,a,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(e,t){const r=e.getAnchor(),i=e.getSize(),s=e.getOrigin();this.imagePixelRatio_=e.getPixelRatio(this.pixelRatio),this.anchorX_=r[0],this.anchorY_=r[1],this.hitDetectionImage_=e.getHitDetectionImage(),this.image_=e.getImage(this.pixelRatio),this.height_=i[1],this.opacity_=e.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=e.getRotateWithView(),this.rotation_=e.getRotation(),this.scale_=e.getScaleArray(),this.width_=i[0],this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}class Kz extends Xp{constructor(e,t,r,i){super(e,t,r,i)}drawFlatCoordinates_(e,t,r,i){const s=this.coordinates.length,a=this.appendFlatLineCoordinates(e,t,r,i,!1,!1),o=[Nt.MOVE_TO_LINE_TO,s,a];return this.instructions.push(o),this.hitDetectionInstructions.push(o),r}drawLineString(e,t,r){const i=this.state,s=i.strokeStyle,a=i.lineWidth;if(s===void 0||a===void 0)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(e,t,r),this.hitDetectionInstructions.push([Nt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Ml,Nl],vh);const o=e.getFlatCoordinates(),l=e.getStride();this.drawFlatCoordinates_(o,0,o.length,l),this.hitDetectionInstructions.push(Hc),this.endGeometry(t)}drawMultiLineString(e,t,r){const i=this.state,s=i.strokeStyle,a=i.lineWidth;if(s===void 0||a===void 0)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(e,t,r),this.hitDetectionInstructions.push([Nt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Ml,Nl],vh);const o=e.getEnds(),l=e.getFlatCoordinates(),u=e.getStride();let h=0;for(let f=0,g=o.length;f<g;++f)h=this.drawFlatCoordinates_(l,h,o[f],u);this.hitDetectionInstructions.push(Hc),this.endGeometry(t)}finish(){const e=this.state;return e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&this.instructions.push(Hc),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(e){e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(Hc),e.lastStroke=this.coordinates.length),e.lastStroke=0,super.applyStroke(e),this.instructions.push(vh)}}class d4 extends Xp{constructor(e,t,r,i){super(e,t,r,i)}drawFlatCoordinatess_(e,t,r,i){const s=this.state,a=s.fillStyle!==void 0,o=s.strokeStyle!==void 0,l=r.length;this.instructions.push(vh),this.hitDetectionInstructions.push(vh);for(let u=0;u<l;++u){const h=r[u],f=this.coordinates.length,g=this.appendFlatLineCoordinates(e,t,h,i,!0,!o),y=[Nt.MOVE_TO_LINE_TO,f,g];this.instructions.push(y),this.hitDetectionInstructions.push(y),o&&(this.instructions.push(h4),this.hitDetectionInstructions.push(h4)),t=h}return a&&(this.instructions.push(Wy),this.hitDetectionInstructions.push(Wy)),o&&(this.instructions.push(Hc),this.hitDetectionInstructions.push(Hc)),t}drawCircle(e,t,r){const i=this.state,s=i.fillStyle,a=i.strokeStyle;if(s===void 0&&a===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([Nt.SET_FILL_STYLE,Es]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Nt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Ml,Nl]);const o=e.getFlatCoordinates(),l=e.getStride(),u=this.coordinates.length;this.appendFlatLineCoordinates(o,0,o.length,l,!1,!1);const h=[Nt.CIRCLE,u];this.instructions.push(vh,h),this.hitDetectionInstructions.push(vh,h),i.fillStyle!==void 0&&(this.instructions.push(Wy),this.hitDetectionInstructions.push(Wy)),i.strokeStyle!==void 0&&(this.instructions.push(Hc),this.hitDetectionInstructions.push(Hc)),this.endGeometry(t)}drawPolygon(e,t,r){const i=this.state,s=i.fillStyle,a=i.strokeStyle;if(s===void 0&&a===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([Nt.SET_FILL_STYLE,Es]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Nt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Ml,Nl]);const o=e.getEnds(),l=e.getOrientedFlatCoordinates(),u=e.getStride();this.drawFlatCoordinatess_(l,0,o,u),this.endGeometry(t)}drawMultiPolygon(e,t,r){const i=this.state,s=i.fillStyle,a=i.strokeStyle;if(s===void 0&&a===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([Nt.SET_FILL_STYLE,Es]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Nt.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Ml,Nl]);const o=e.getEndss(),l=e.getOrientedFlatCoordinates(),u=e.getStride();let h=0;for(let f=0,g=o.length;f<g;++f)h=this.drawFlatCoordinatess_(l,h,o[f],u);this.endGeometry(t)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const e=this.tolerance;if(e!==0){const t=this.coordinates;for(let r=0,i=t.length;r<i;++r)t[r]=nh(t[r],e)}return super.finish()}setFillStrokeStyles_(){const e=this.state;this.updateFillStyle(e,this.createFill),this.updateStrokeStyle(e,this.applyStroke)}}function Yz(n,e,t,r,i){const s=[];let a=t,o=0,l=e.slice(t,2);for(;o<n&&a+i<r;){const[u,h]=l.slice(-2),f=e[a+i],g=e[a+i+1],y=Math.sqrt((f-u)*(f-u)+(g-h)*(g-h));if(o+=y,o>=n){const v=(n-o+y)/y,x=Hs(u,f,v),E=Hs(h,g,v);l.push(x,E),s.push(l),l=[x,E],o==n&&(a+=i),o=0}else if(o<n)l.push(e[a+i],e[a+i+1]),a+=i;else{const v=y-o,x=Hs(u,f,v/y),E=Hs(h,g,v/y);l.push(x,E),s.push(l),l=[x,E],o=0,a+=i}}return o>0&&s.push(l),s}function Xz(n,e,t,r,i){let s=t,a=t,o=0,l=0,u=t,h,f,g,y,v,x,E,T,b,I;for(f=t;f<r;f+=i){const M=e[f],F=e[f+1];v!==void 0&&(b=M-v,I=F-x,y=Math.sqrt(b*b+I*I),E!==void 0&&(l+=g,h=Math.acos((E*b+T*I)/(g*y)),h>n&&(l>o&&(o=l,s=u,a=f),l=0,u=f-i)),g=y,E=b,T=I),v=M,x=F}return l+=y,l>o?[u,f]:[s,a]}const hx={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class qz extends Xp{constructor(e,t,r,i){super(e,t,r,i),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[Es]={fillStyle:Es},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const e=super.finish();return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e}drawText(e,t,r){const i=this.textFillState_,s=this.textStrokeState_,a=this.textState_;if(this.text_===""||!a||!i&&!s)return;const o=this.coordinates;let l=o.length;const u=e.getType();let h=null,f=e.getStride();if(a.placement==="line"&&(u=="LineString"||u=="MultiLineString"||u=="Polygon"||u=="MultiPolygon")){if(!os(this.maxExtent,e.getExtent()))return;let g;if(h=e.getFlatCoordinates(),u=="LineString")g=[h.length];else if(u=="MultiLineString")g=e.getEnds();else if(u=="Polygon")g=e.getEnds().slice(0,1);else if(u=="MultiPolygon"){const E=e.getEndss();g=[];for(let T=0,b=E.length;T<b;++T)g.push(E[T][0])}this.beginGeometry(e,t,r);const y=a.repeat,v=y?void 0:a.textAlign;let x=0;for(let E=0,T=g.length;E<T;++E){let b;y?b=Yz(y*this.resolution,h,x,g[E],f):b=[h.slice(x,g[E])];for(let I=0,M=b.length;I<M;++I){const F=b[I];let z=0,P=F.length;if(v==null){const k=Xz(a.maxAngle,F,0,F.length,2);z=k[0],P=k[1]}for(let k=z;k<P;k+=f)o.push(F[k],F[k+1]);const C=o.length;x=g[E],this.drawChars_(l,C),l=C}}this.endGeometry(t)}else{let g=a.overflow?null:[];switch(u){case"Point":case"MultiPoint":h=e.getFlatCoordinates();break;case"LineString":h=e.getFlatMidpoint();break;case"Circle":h=e.getCenter();break;case"MultiLineString":h=e.getFlatMidpoints(),f=2;break;case"Polygon":h=e.getFlatInteriorPoint(),a.overflow||g.push(h[2]/this.resolution),f=3;break;case"MultiPolygon":const M=e.getFlatInteriorPoints();h=[];for(let F=0,z=M.length;F<z;F+=3)a.overflow||g.push(M[F+2]/this.resolution),h.push(M[F],M[F+1]);if(h.length===0)return;f=2;break}const y=this.appendFlatPointCoordinates(h,f);if(y===l)return;if(g&&(y-l)/2!==h.length/f){let M=l/2;g=g.filter((F,z)=>{const P=o[(M+z)*2]===h[z*f]&&o[(M+z)*2+1]===h[z*f+1];return P||--M,P})}this.saveTextStates_();const v=a.backgroundFill?this.createFill(this.fillStyleToState(a.backgroundFill)):null,x=a.backgroundStroke?this.createStroke(this.strokeStyleToState(a.backgroundStroke)):null;this.beginGeometry(e,t,r);let E=a.padding;if(E!=xh&&(a.scale[0]<0||a.scale[1]<0)){let M=a.padding[0],F=a.padding[1],z=a.padding[2],P=a.padding[3];a.scale[0]<0&&(F=-F,P=-P),a.scale[1]<0&&(M=-M,z=-z),E=[M,F,z,P]}const T=this.pixelRatio;this.instructions.push([Nt.DRAW_IMAGE,l,y,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,E==xh?xh:E.map(function(M){return M*T}),v,x,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,g]);const b=1/T,I=v?v.slice(0):null;I&&(I[1]=Es),this.hitDetectionInstructions.push([Nt.DRAW_IMAGE,l,y,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[b,b],NaN,this.declutterMode_,this.declutterImageWithText_,E,I,x,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?Es:this.fillKey_,this.textOffsetX_,this.textOffsetY_,g]),this.endGeometry(t)}}saveTextStates_(){const e=this.textStrokeState_,t=this.textState_,r=this.textFillState_,i=this.strokeKey_;e&&(i in this.strokeStates||(this.strokeStates[i]={strokeStyle:e.strokeStyle,lineCap:e.lineCap,lineDashOffset:e.lineDashOffset,lineWidth:e.lineWidth,lineJoin:e.lineJoin,miterLimit:e.miterLimit,lineDash:e.lineDash}));const s=this.textKey_;s in this.textStates||(this.textStates[s]={font:t.font,textAlign:t.textAlign||Qm,justify:t.justify,textBaseline:t.textBaseline||cx,scale:t.scale});const a=this.fillKey_;r&&(a in this.fillStates||(this.fillStates[a]={fillStyle:r.fillStyle}))}drawChars_(e,t){const r=this.textStrokeState_,i=this.textState_,s=this.strokeKey_,a=this.textKey_,o=this.fillKey_;this.saveTextStates_();const l=this.pixelRatio,u=hx[i.textBaseline],h=this.textOffsetY_*l,f=this.text_,g=r?r.lineWidth*Math.abs(i.scale[0])/2:0;this.instructions.push([Nt.DRAW_CHARS,e,t,u,i.overflow,o,i.maxAngle,l,h,s,g*l,f,a,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([Nt.DRAW_CHARS,e,t,u,i.overflow,o&&Es,i.maxAngle,l,h,s,g*l,f,a,1/l,this.declutterMode_,this.textKeepUpright_])}setTextStyle(e,t){let r,i,s;if(!e)this.text_="";else{const a=e.getFill();a?(i=this.textFillState_,i||(i={},this.textFillState_=i),i.fillStyle=Fo(a.getColor()||Es)):(i=null,this.textFillState_=i);const o=e.getStroke();if(!o)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);const x=o.getLineDash(),E=o.getLineDashOffset(),T=o.getWidth(),b=o.getMiterLimit();s.lineCap=o.getLineCap()||h0,s.lineDash=x?x.slice():Ml,s.lineDashOffset=E===void 0?Nl:E,s.lineJoin=o.getLineJoin()||d0,s.lineWidth=T===void 0?Jm:T,s.miterLimit=b===void 0?qm:b,s.strokeStyle=Fo(o.getColor()||Zm)}r=this.textState_;const l=e.getFont()||I5;gz(l);const u=e.getScaleArray();r.overflow=e.getOverflow(),r.font=l,r.maxAngle=e.getMaxAngle(),r.placement=e.getPlacement(),r.textAlign=e.getTextAlign(),r.repeat=e.getRepeat(),r.justify=e.getJustify(),r.textBaseline=e.getTextBaseline()||cx,r.backgroundFill=e.getBackgroundFill(),r.backgroundStroke=e.getBackgroundStroke(),r.padding=e.getPadding()||xh,r.scale=u===void 0?[1,1]:u;const h=e.getOffsetX(),f=e.getOffsetY(),g=e.getRotateWithView(),y=e.getKeepUpright(),v=e.getRotation();this.text_=e.getText()||"",this.textOffsetX_=h===void 0?0:h,this.textOffsetY_=f===void 0?0:f,this.textRotateWithView_=g===void 0?!1:g,this.textKeepUpright_=y===void 0?!0:y,this.textRotation_=v===void 0?0:v,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:bn(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=r.font+r.scale+(r.textAlign||"?")+(r.repeat||"?")+(r.justify||"?")+(r.textBaseline||"?"),this.fillKey_=i&&i.fillStyle?typeof i.fillStyle=="string"?i.fillStyle:"|"+bn(i.fillStyle):""}this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}const Zz={Circle:d4,Default:Xp,Image:Hz,LineString:Kz,Polygon:d4,Text:qz};class Qz{constructor(e,t,r,i){this.tolerance_=e,this.maxExtent_=t,this.pixelRatio_=i,this.resolution_=r,this.buildersByZIndex_={}}finish(){const e={};for(const t in this.buildersByZIndex_){e[t]=e[t]||{};const r=this.buildersByZIndex_[t];for(const i in r){const s=r[i].finish();e[t][i]=s}}return e}getBuilder(e,t){const r=e!==void 0?e.toString():"0";let i=this.buildersByZIndex_[r];i===void 0&&(i={},this.buildersByZIndex_[r]=i);let s=i[t];if(s===void 0){const a=Zz[t];s=new a(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),i[t]=s}return s}}function Jz(n,e,t,r,i,s,a,o,l,u,h,f,g=!0){let y=n[e],v=n[e+1],x=0,E=0,T=0,b=0;function I(){x=y,E=v,e+=r,y=n[e],v=n[e+1],b+=T,T=Math.sqrt((y-x)*(y-x)+(v-E)*(v-E))}do I();while(e<t-r&&b+T<s);let M=T===0?0:(s-b)/T;const F=Hs(x,y,M),z=Hs(E,v,M),P=e-r,C=b,k=s+o*l(u,i,h);for(;e<t-r&&b+T<k;)I();M=T===0?0:(k-b)/T;const L=Hs(x,y,M),O=Hs(E,v,M);let U=!1;if(g)if(f){const Ne=[F,z,L,O];l5(Ne,0,4,2,f,Ne,Ne),U=Ne[0]>Ne[2]}else U=F>L;const j=Math.PI,Te=[],Ce=P+r===e;e=P,T=0,b=C,y=n[e],v=n[e+1];let Ue;if(Ce){I(),Ue=Math.atan2(v-E,y-x),U&&(Ue+=Ue>0?-j:j);const Ne=(L+F)/2,le=(O+z)/2;return Te[0]=[Ne,le,(k-s)/2,Ue,i],Te}i=i.replace(/\n/g," ");for(let Ne=0,le=i.length;Ne<le;){I();let ue=Math.atan2(v-E,y-x);if(U&&(ue+=ue>0?-j:j),Ue!==void 0){let q=ue-Ue;if(q+=q>j?-2*j:q<-j?2*j:0,Math.abs(q)>a)return null}Ue=ue;const Se=Ne;let se=0;for(;Ne<le;++Ne){const q=U?le-Ne-1:Ne,he=o*l(u,i[q],h);if(e+r<t&&b+T<s+se+he/2)break;se+=he}if(Ne===Se)continue;const V=U?i.substring(le-Se,le-Ne):i.substring(Se,Ne);M=T===0?0:(s+se/2-b)/T;const J=Hs(x,y,M),re=Hs(E,v,M);Te.push([J,re,se/2,ue,V]),s+=se}return Te}class G5{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(ox(),{get:(e,t)=>{if(typeof ox()[t]=="function")return this.push_(t),this.pushMethodArgs_},set:(e,t,r)=>(this.push_(t,r),!0)})}push_(...e){const t=this.instructions_,r=this.zIndex+this.offset_;t[r]||(t[r]=[]),t[r].push(...e)}pushMethodArgs_=(...e)=>(this.push_(e),this);pushFunction(e){this.push_(e)}getContext(){return this.context_}draw(e){this.instructions_.forEach(t=>{for(let r=0,i=t.length;r<i;++r){const s=t[r];if(typeof s=="function"){s(e);continue}const a=t[++r];if(typeof e[s]=="function")e[s](...a);else{if(typeof a=="function"){e[s]=a(e);continue}e[s]=a}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const sf=ea(),Sc=[],xl=[],vl=[],Tc=[];function f4(n){return n[3].declutterBox}const g4=new RegExp("[-----]");function F2(n,e){return e==="start"?e=g4.test(n)?"right":"left":e==="end"&&(e=g4.test(n)?"left":"right"),hx[e]}function e$(n,e,t){return t>0&&n.push(`
`,""),n.push(e,""),n}function t$(n,e,t){return t%2===0&&(n+=e),n}class n${constructor(e,t,r,i,s){this.overlaps=r,this.pixelRatio=t,this.resolution=e,this.alignAndScaleFill_,this.instructions=i.instructions,this.coordinates=i.coordinates,this.coordinateCache_={},this.renderedTransform_=to(),this.hitDetectionInstructions=i.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=i.fillStates||{},this.strokeStates=i.strokeStates||{},this.textStates=i.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=s?new G5:null}getZIndexContext(){return this.zIndexContext_}createLabel(e,t,r,i){const s=e+t+r+i;if(this.labels_[s])return this.labels_[s];const a=i?this.strokeStates[i]:null,o=r?this.fillStates[r]:null,l=this.textStates[t],u=this.pixelRatio,h=[l.scale[0]*u,l.scale[1]*u],f=l.justify?hx[l.justify]:F2(Array.isArray(e)?e[0]:e,l.textAlign||Qm),g=i&&a.lineWidth?a.lineWidth:0,y=Array.isArray(e)?e:String(e).split(`
`).reduce(e$,[]),{width:v,height:x,widths:E,heights:T,lineWidths:b}=pz(l,y),I=v+g,M=[],F=(I+2)*h[0],z=(x+g)*h[1],P={width:F<0?Math.floor(F):Math.ceil(F),height:z<0?Math.floor(z):Math.ceil(z),contextInstructions:M};(h[0]!=1||h[1]!=1)&&M.push("scale",h),i&&(M.push("strokeStyle",a.strokeStyle),M.push("lineWidth",g),M.push("lineCap",a.lineCap),M.push("lineJoin",a.lineJoin),M.push("miterLimit",a.miterLimit),M.push("setLineDash",[a.lineDash]),M.push("lineDashOffset",a.lineDashOffset)),r&&M.push("fillStyle",o.fillStyle),M.push("textBaseline","middle"),M.push("textAlign","center");const C=.5-f;let k=f*I+C*g;const L=[],O=[];let U=0,j=0,Te=0,Ce=0,Ue;for(let Ne=0,le=y.length;Ne<le;Ne+=2){const ue=y[Ne];if(ue===`
`){j+=U,U=0,k=f*I+C*g,++Ce;continue}const Se=y[Ne+1]||l.font;Se!==Ue&&(i&&L.push("font",Se),r&&O.push("font",Se),Ue=Se),U=Math.max(U,T[Te]);const se=[ue,k+C*E[Te]+f*(E[Te]-b[Ce]),.5*(g+U)+j];k+=E[Te],i&&L.push("strokeText",se),r&&O.push("fillText",se),++Te}return Array.prototype.push.apply(M,L),Array.prototype.push.apply(M,O),this.labels_[s]=P,P}replayTextBackground_(e,t,r,i,s,a,o){e.beginPath(),e.moveTo.apply(e,t),e.lineTo.apply(e,r),e.lineTo.apply(e,i),e.lineTo.apply(e,s),e.lineTo.apply(e,t),a&&(this.alignAndScaleFill_=a[2],e.fillStyle=a[1],this.fill_(e)),o&&(this.setStrokeStyle_(e,o),e.stroke())}calculateImageOrLabelDimensions_(e,t,r,i,s,a,o,l,u,h,f,g,y,v,x,E){o*=g[0],l*=g[1];let T=r-o,b=i-l;const I=s+u>e?e-u:s,M=a+h>t?t-h:a,F=v[3]+I*g[0]+v[1],z=v[0]+M*g[1]+v[2],P=T-v[3],C=b-v[0];(x||f!==0)&&(Sc[0]=P,Tc[0]=P,Sc[1]=C,xl[1]=C,xl[0]=P+F,vl[0]=xl[0],vl[1]=C+z,Tc[1]=vl[1]);let k;return f!==0?(k=Xo(to(),r,i,1,1,f,-r,-i),ni(k,Sc),ni(k,xl),ni(k,vl),ni(k,Tc),lu(Math.min(Sc[0],xl[0],vl[0],Tc[0]),Math.min(Sc[1],xl[1],vl[1],Tc[1]),Math.max(Sc[0],xl[0],vl[0],Tc[0]),Math.max(Sc[1],xl[1],vl[1],Tc[1]),sf)):lu(Math.min(P,P+F),Math.min(C,C+z),Math.max(P,P+F),Math.max(C,C+z),sf),y&&(T=Math.round(T),b=Math.round(b)),{drawImageX:T,drawImageY:b,drawImageW:I,drawImageH:M,originX:u,originY:h,declutterBox:{minX:sf[0],minY:sf[1],maxX:sf[2],maxY:sf[3],value:E},canvasTransform:k,scale:g}}replayImageOrLabel_(e,t,r,i,s,a,o){const l=!!(a||o),u=i.declutterBox,h=o?o[2]*i.scale[0]/2:0;return u.minX-h<=t[0]&&u.maxX+h>=0&&u.minY-h<=t[1]&&u.maxY+h>=0&&(l&&this.replayTextBackground_(e,Sc,xl,vl,Tc,a,o),yz(e,i.canvasTransform,s,r,i.originX,i.originY,i.drawImageW,i.drawImageH,i.drawImageX,i.drawImageY,i.scale)),!0}fill_(e){const t=this.alignAndScaleFill_;if(t){const r=ni(this.renderedTransform_,[0,0]),i=512*this.pixelRatio;e.save(),e.translate(r[0]%i,r[1]%i),t!==1&&e.scale(t,t),e.rotate(this.viewRotation_)}e.fill(),t&&e.restore()}setStrokeStyle_(e,t){e.strokeStyle=t[1],t[1]&&(e.lineWidth=t[2],e.lineCap=t[3],e.lineJoin=t[4],e.miterLimit=t[5],e.lineDashOffset=t[7],e.setLineDash(t[6]))}drawLabelWithPointPlacement_(e,t,r,i){const s=this.textStates[t],a=this.createLabel(e,t,i,r),o=this.strokeStates[r],l=this.pixelRatio,u=F2(Array.isArray(e)?e[0]:e,s.textAlign||Qm),h=hx[s.textBaseline||cx],f=o&&o.lineWidth?o.lineWidth:0,g=a.width/l-2*s.scale[0],y=u*g+2*(.5-u)*f,v=h*a.height/l+2*(.5-h)*f;return{label:a,anchorX:y,anchorY:v}}execute_(e,t,r,i,s,a,o,l){const u=this.zIndexContext_;let h;this.pixelCoordinates_&&Su(r,this.renderedTransform_)?h=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),h=eu(this.coordinates,0,this.coordinates.length,2,r,this.pixelCoordinates_),RU(this.renderedTransform_,r));let f=0;const g=i.length;let y=0,v,x,E,T,b,I,M,F,z,P,C,k,L,O=0,U=0;const j=this.coordinateCache_,Te=this.viewRotation_,Ce=Math.round(Math.atan2(-r[1],r[0])*1e12)/1e12,Ue={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:Te},Ne=this.instructions!=i||this.overlaps?0:200;let le,ue,Se,se;for(;f<g;){const V=i[f];switch(V[0]){case Nt.BEGIN_GEOMETRY:le=V[1],se=V[3],le.getGeometry()?o!==void 0&&!os(o,se.getExtent())?f=V[2]+1:++f:f=V[2],u&&(u.zIndex=V[4]);break;case Nt.BEGIN_PATH:O>Ne&&(this.fill_(e),O=0),U>Ne&&(e.stroke(),U=0),!O&&!U&&(e.beginPath(),b=NaN,I=NaN),++f;break;case Nt.CIRCLE:y=V[1];const re=h[y],q=h[y+1],he=h[y+2],Me=h[y+3],je=he-re,De=Me-q,Be=Math.sqrt(je*je+De*De);e.moveTo(re+Be,q),e.arc(re,q,Be,0,2*Math.PI,!0),++f;break;case Nt.CLOSE_PATH:e.closePath(),++f;break;case Nt.CUSTOM:y=V[1],v=V[2];const Gt=V[3],Kt=V[4],wn=V[5];Ue.geometry=Gt,Ue.feature=le,f in j||(j[f]=[]);const Bt=j[f];wn?wn(h,y,v,2,Bt):(Bt[0]=h[y],Bt[1]=h[y+1],Bt.length=2),u&&(u.zIndex=V[6]),Kt(Bt,Ue),++f;break;case Nt.DRAW_IMAGE:y=V[1],v=V[2],z=V[3],x=V[4],E=V[5];let Fn=V[6];const Qt=V[7],ot=V[8],Zn=V[9],on=V[10];let en=V[11];const Qn=V[12];let mt=V[13];T=V[14]||"declutter";const jt=V[15];if(!z&&V.length>=20){P=V[19],C=V[20],k=V[21],L=V[22];const be=this.drawLabelWithPointPlacement_(P,C,k,L);z=be.label,V[3]=z;const $e=V[23];x=(be.anchorX-$e)*this.pixelRatio,V[4]=x;const et=V[24];E=(be.anchorY-et)*this.pixelRatio,V[5]=E,Fn=z.height,V[6]=Fn,mt=z.width,V[13]=mt}let Pn;V.length>25&&(Pn=V[25]);let _t,Jt,Rt;V.length>17?(_t=V[16],Jt=V[17],Rt=V[18]):(_t=xh,Jt=null,Rt=null),on&&Ce?en+=Te:!on&&!Ce&&(en-=Te);let rr=0;for(;y<v;y+=2){if(Pn&&Pn[rr++]<mt/this.pixelRatio)continue;const be=this.calculateImageOrLabelDimensions_(z.width,z.height,h[y],h[y+1],mt,Fn,x,E,ot,Zn,en,Qn,s,_t,!!Jt||!!Rt,le),$e=[e,t,z,be,Qt,Jt,Rt];if(l){let et,ft,St;if(jt){const cn=v-y;if(!jt[cn]){jt[cn]={args:$e,declutterMode:T};continue}const hr=jt[cn];et=hr.args,ft=hr.declutterMode,delete jt[cn],St=f4(et)}let sn,ur;if(et&&(ft!=="declutter"||!l.collides(St))&&(sn=!0),(T!=="declutter"||!l.collides(be.declutterBox))&&(ur=!0),ft==="declutter"&&T==="declutter"){const cn=sn&&ur;sn=cn,ur=cn}sn&&(ft!=="none"&&l.insert(St),this.replayImageOrLabel_.apply(this,et)),ur&&(T!=="none"&&l.insert(be.declutterBox),this.replayImageOrLabel_.apply(this,$e))}else this.replayImageOrLabel_.apply(this,$e)}++f;break;case Nt.DRAW_CHARS:const ai=V[1],Gr=V[2],Ut=V[3],es=V[4];L=V[5];const Oe=V[6],we=V[7],pe=V[8];k=V[9];const kt=V[10];P=V[11],Array.isArray(P)&&(P=P.reduce(t$,"")),C=V[12];const N=[V[13],V[13]];T=V[14]||"declutter";const Pt=V[15],W=this.textStates[C],Z=W.font,X=[W.scale[0]*we,W.scale[1]*we];let ce;Z in this.widths_?ce=this.widths_[Z]:(ce={},this.widths_[Z]=ce);const de=oI(h,ai,Gr,2),Ve=Math.abs(X[0])*e4(Z,P,ce);if(es||Ve<=de){const be=this.textStates[C].textAlign,$e=(de-Ve)*F2(P,be),et=Jz(h,ai,Gr,2,P,$e,Oe,Math.abs(X[0]),e4,Z,ce,Ce?0:this.viewRotation_,Pt);e:if(et){const ft=[];let St,sn,ur,cn,hr;if(k)for(St=0,sn=et.length;St<sn;++St){hr=et[St],ur=hr[4],cn=this.createLabel(ur,C,"",k),x=hr[2]+(X[0]<0?-kt:kt),E=Ut*cn.height+(.5-Ut)*2*kt*X[1]/X[0]-pe;const yr=this.calculateImageOrLabelDimensions_(cn.width,cn.height,hr[0],hr[1],cn.width,cn.height,x,E,0,0,hr[3],N,!1,xh,!1,le);if(l&&T==="declutter"&&l.collides(yr.declutterBox))break e;ft.push([e,t,cn,yr,1,null,null])}if(L)for(St=0,sn=et.length;St<sn;++St){hr=et[St],ur=hr[4],cn=this.createLabel(ur,C,L,""),x=hr[2],E=Ut*cn.height-pe;const yr=this.calculateImageOrLabelDimensions_(cn.width,cn.height,hr[0],hr[1],cn.width,cn.height,x,E,0,0,hr[3],N,!1,xh,!1,le);if(l&&T==="declutter"&&l.collides(yr.declutterBox))break e;ft.push([e,t,cn,yr,1,null,null])}l&&T!=="none"&&l.load(ft.map(f4));for(let yr=0,Li=ft.length;yr<Li;++yr)this.replayImageOrLabel_.apply(this,ft[yr])}}++f;break;case Nt.END_GEOMETRY:if(a!==void 0){le=V[1];const be=a(le,se,T);if(be)return be}++f;break;case Nt.FILL:Ne?O++:this.fill_(e),++f;break;case Nt.MOVE_TO_LINE_TO:for(y=V[1],v=V[2],ue=h[y],Se=h[y+1],e.moveTo(ue,Se),b=ue+.5|0,I=Se+.5|0,y+=2;y<v;y+=2)ue=h[y],Se=h[y+1],M=ue+.5|0,F=Se+.5|0,(y==v-2||M!==b||F!==I)&&(e.lineTo(ue,Se),b=M,I=F);++f;break;case Nt.SET_FILL_STYLE:this.alignAndScaleFill_=V[2],O&&(this.fill_(e),O=0,U&&(e.stroke(),U=0)),e.fillStyle=V[1],++f;break;case Nt.SET_STROKE_STYLE:U&&(e.stroke(),U=0),this.setStrokeStyle_(e,V),++f;break;case Nt.STROKE:Ne?U++:e.stroke(),++f;break;default:++f;break}}O&&this.fill_(e),U&&e.stroke()}execute(e,t,r,i,s,a){this.viewRotation_=i,this.execute_(e,t,r,this.instructions,s,void 0,void 0,a)}executeHitDetection(e,t,r,i,s){return this.viewRotation_=r,this.execute_(e,[e.canvas.width,e.canvas.height],t,this.hitDetectionInstructions,!0,i,s)}}const hh=["Polygon","Circle","LineString","Image","Text","Default"],B5=["Image","Text"],r$=hh.filter(n=>!B5.includes(n));class i${constructor(e,t,r,i,s,a,o){this.maxExtent_=e,this.overlaps_=i,this.pixelRatio_=r,this.resolution_=t,this.renderBuffer_=a,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=to(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(s,o)}clip(e,t){const r=this.getClipCoords(t);e.beginPath(),e.moveTo(r[0],r[1]),e.lineTo(r[2],r[3]),e.lineTo(r[4],r[5]),e.lineTo(r[6],r[7]),e.clip()}createExecutors_(e,t){for(const r in e){let i=this.executorsByZIndex_[r];i===void 0&&(i={},this.executorsByZIndex_[r]=i);const s=e[r];for(const a in s){const o=s[a];i[a]=new n$(this.resolution_,this.pixelRatio_,this.overlaps_,o,t)}}}hasExecutors(e){for(const t in this.executorsByZIndex_){const r=this.executorsByZIndex_[t];for(let i=0,s=e.length;i<s;++i)if(e[i]in r)return!0}return!1}forEachFeatureAtCoordinate(e,t,r,i,s,a){i=Math.round(i);const o=i*2+1,l=Xo(this.hitDetectionTransform_,i+.5,i+.5,1/t,-1/t,-r,-e[0],-e[1]),u=!this.hitDetectionContext_;u&&(this.hitDetectionContext_=ri(o,o));const h=this.hitDetectionContext_;h.canvas.width!==o||h.canvas.height!==o?(h.canvas.width=o,h.canvas.height=o):u||h.clearRect(0,0,o,o);let f;this.renderBuffer_!==void 0&&(f=ea(),gm(f,e),Km(f,t*(this.renderBuffer_+i),f));const g=s$(i);let y;function v(F,z,P){const C=h.getImageData(0,0,o,o).data;for(let k=0,L=g.length;k<L;k++)if(C[g[k]]>0){if(!a||P==="none"||y!=="Image"&&y!=="Text"||a.includes(F)){const O=(g[k]-3)/4,U=i-O%o,j=i-(O/o|0),Te=s(F,z,U*U+j*j);if(Te)return Te}h.clearRect(0,0,o,o);break}}const x=Object.keys(this.executorsByZIndex_).map(Number);x.sort(Cl);let E,T,b,I,M;for(E=x.length-1;E>=0;--E){const F=x[E].toString();for(b=this.executorsByZIndex_[F],T=hh.length-1;T>=0;--T)if(y=hh[T],I=b[y],I!==void 0&&(M=I.executeHitDetection(h,l,r,v,f),M))return M}}getClipCoords(e){const t=this.maxExtent_;if(!t)return null;const r=t[0],i=t[1],s=t[2],a=t[3],o=[r,i,r,a,s,a,s,i];return eu(o,0,8,2,e,o),o}isEmpty(){return Lh(this.executorsByZIndex_)}execute(e,t,r,i,s,a,o){const l=Object.keys(this.executorsByZIndex_).map(Number);l.sort(o?GB:Cl),a=a||hh;const u=hh.length;for(let h=0,f=l.length;h<f;++h){const g=l[h].toString(),y=this.executorsByZIndex_[g];for(let v=0,x=a.length;v<x;++v){const E=a[v],T=y[E];if(T!==void 0){const b=o===null?void 0:T.getZIndexContext(),I=b?b.getContext():e,M=this.maxExtent_&&E!=="Image"&&E!=="Text";if(M&&(I.save(),this.clip(I,r)),!b||E==="Text"||E==="Image"?T.execute(I,t,r,i,s,o):b.pushFunction(F=>T.execute(F,t,r,i,s,o)),M&&I.restore(),b){b.offset();const F=l[h]*u+hh.indexOf(E);this.deferredZIndexContexts_[F]||(this.deferredZIndexContexts_[F]=[]),this.deferredZIndexContexts_[F].push(b)}}}}this.renderedContext_=e}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const e=this.deferredZIndexContexts_,t=Object.keys(e).map(Number).sort(Cl);for(let r=0,i=t.length;r<i;++r)e[t[r]].forEach(s=>{s.draw(this.renderedContext_),s.clear()}),e[t[r]].length=0}}const j2={};function s$(n){if(j2[n]!==void 0)return j2[n];const e=n*2+1,t=n*n,r=new Array(t+1);for(let s=0;s<=n;++s)for(let a=0;a<=n;++a){const o=s*s+a*a;if(o>t)break;let l=r[o];l||(l=[],r[o]=l),l.push(((n+s)*e+(n+a))*4+3),s>0&&l.push(((n-s)*e+(n+a))*4+3),a>0&&(l.push(((n+s)*e+(n-a))*4+3),s>0&&l.push(((n-s)*e+(n-a))*4+3))}const i=[];for(let s=0,a=r.length;s<a;++s)r[s]&&i.push(...r[s]);return j2[n]=i,i}function m4(n,e,t,r){return t!==void 0&&r!==void 0?[t/n,r/e]:t!==void 0?t/n:r!==void 0?r/e:1}let qp=class U5 extends Bv{constructor(e){e=e||{};const t=e.opacity!==void 0?e.opacity:1,r=e.rotation!==void 0?e.rotation:0,i=e.scale!==void 0?e.scale:1,s=e.rotateWithView!==void 0?e.rotateWithView:!1;super({opacity:t,rotation:r,scale:i,displacement:e.displacement!==void 0?e.displacement:[0,0],rotateWithView:s,declutterMode:e.declutterMode}),this.anchor_=e.anchor!==void 0?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=e.anchorOrigin!==void 0?e.anchorOrigin:"top-left",this.anchorXUnits_=e.anchorXUnits!==void 0?e.anchorXUnits:"fraction",this.anchorYUnits_=e.anchorYUnits!==void 0?e.anchorYUnits:"fraction",this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null;const a=e.img!==void 0?e.img:null;let o=e.src;Dn(!(o!==void 0&&a),"`image` and `src` cannot be provided at the same time"),(o===void 0||o.length===0)&&a&&(o=a.src||bn(a)),Dn(o!==void 0&&o.length>0,"A defined and non-empty `src` or `image` must be provided"),Dn(!((e.width!==void 0||e.height!==void 0)&&e.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let l;if(e.src!==void 0?l=vt.IDLE:a!==void 0&&("complete"in a?a.complete?l=a.src?vt.LOADED:vt.IDLE:l=vt.LOADING:l=vt.LOADED),this.color_=e.color!==void 0?jh(e.color):null,this.iconImage_=lx(a,o,this.crossOrigin_,l,this.color_),this.offset_=e.offset!==void 0?e.offset:[0,0],this.offsetOrigin_=e.offsetOrigin!==void 0?e.offsetOrigin:"top-left",this.origin_=null,this.size_=e.size!==void 0?e.size:null,this.initialOptions_,e.width!==void 0||e.height!==void 0){let u,h;if(e.size)[u,h]=e.size;else{const f=this.getImage(1);if(f.width&&f.height)u=f.width,h=f.height;else if(f instanceof HTMLImageElement){this.initialOptions_=e;const g=()=>{if(this.unlistenImageChange(g),!this.initialOptions_)return;const y=this.iconImage_.getSize();this.setScale(m4(y[0],y[1],e.width,e.height))};this.listenImageChange(g);return}}u!==void 0&&this.setScale(m4(u,h,e.width,e.height))}}clone(){let e,t,r;return this.initialOptions_?(t=this.initialOptions_.width,r=this.initialOptions_.height):(e=this.getScale(),e=Array.isArray(e)?e.slice():e),new U5({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:e,width:t,height:r,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let e=this.normalizedAnchor_;if(!e){e=this.anchor_;const i=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!i)return null;e=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(e[0]*=i[0]),this.anchorYUnits_=="fraction"&&(e[1]*=i[1])}if(this.anchorOrigin_!="top-left"){if(!i)return null;e===this.anchor_&&(e=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(e[0]=-e[0]+i[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(e[1]=-e[1]+i[1])}this.normalizedAnchor_=e}const t=this.getDisplacement(),r=this.getScaleArray();return[e[0]-t[0]/r[0],e[1]+t[1]/r[1]]}setAnchor(e){this.anchor_=e,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(e){return this.iconImage_.getImage(e)}getPixelRatio(e){return this.iconImage_.getPixelRatio(e)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let e=this.offset_;if(this.offsetOrigin_!="top-left"){const t=this.getSize(),r=this.iconImage_.getSize();if(!t||!r)return null;e=e.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(e[0]=r[0]-t[0]-e[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(e[1]=r[1]-t[1]-e[1])}return this.origin_=e,this.origin_}getSrc(){return this.iconImage_.getSrc()}setSrc(e){this.iconImage_=lx(null,e,this.crossOrigin_,vt.IDLE,this.color_)}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const e=this.getScaleArray();if(this.size_)return this.size_[0]*e[0];if(this.iconImage_.getImageState()==vt.LOADED)return this.iconImage_.getSize()[0]*e[0]}getHeight(){const e=this.getScaleArray();if(this.size_)return this.size_[1]*e[1];if(this.iconImage_.getImageState()==vt.LOADED)return this.iconImage_.getSize()[1]*e[1]}setScale(e){delete this.initialOptions_,super.setScale(e)}listenImageChange(e){this.iconImage_.addEventListener(Yt.CHANGE,e)}load(){this.iconImage_.load()}unlistenImageChange(e){this.iconImage_.removeEventListener(Yt.CHANGE,e)}ready(){return this.iconImage_.ready()}};const Lo=.5;function a$(n,e,t,r,i,s,a,o,l){const u=i,h=n[0]*Lo,f=n[1]*Lo,g=ri(h,f);g.imageSmoothingEnabled=!1;const y=g.canvas,v=new xz(g,Lo,i,null,a,o,null),x=t.length,E=Math.floor((256*256*256-1)/x),T={};for(let I=1;I<=x;++I){const M=t[I-1],F=M.getStyleFunction()||r;if(!F)continue;let z=F(M,s);if(!z)continue;Array.isArray(z)||(z=[z]);const C=(I*E).toString(16).padStart(7,"#00000");for(let k=0,L=z.length;k<L;++k){const O=z[k],U=O.getGeometryFunction()(M);if(!U||!os(u,U.getExtent()))continue;const j=O.clone(),Te=j.getFill();Te&&Te.setColor(C);const Ce=j.getStroke();Ce&&(Ce.setColor(C),Ce.setLineDash(null)),j.setText(void 0);const Ue=O.getImage();if(Ue){const Se=Ue.getImageSize();if(!Se)continue;const se=ri(Se[0],Se[1],void 0,{alpha:!1}),V=se.canvas;se.fillStyle=C,se.fillRect(0,0,V.width,V.height),j.setImage(new qp({img:V,anchor:Ue.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:Ue.getOrigin(),opacity:1,size:Ue.getSize(),scale:Ue.getScale(),rotation:Ue.getRotation(),rotateWithView:Ue.getRotateWithView()}))}const Ne=j.getZIndex()||0;let le=T[Ne];le||(le={},T[Ne]=le,le.Polygon=[],le.Circle=[],le.LineString=[],le.Point=[]);const ue=U.getType();if(ue==="GeometryCollection"){const Se=U.getGeometriesArrayRecursive();for(let se=0,V=Se.length;se<V;++se){const J=Se[se];le[J.getType().replace("Multi","")].push(J,j)}}else le[ue.replace("Multi","")].push(U,j)}}const b=Object.keys(T).map(Number).sort(Cl);for(let I=0,M=b.length;I<M;++I){const F=T[b[I]];for(const z in F){const P=F[z];for(let C=0,k=P.length;C<k;C+=2){v.setStyle(P[C+1]);for(let L=0,O=e.length;L<O;++L)v.setTransform(e[L]),v.drawGeometry(P[C])}}}return g.getImageData(0,0,y.width,y.height)}function o$(n,e,t){const r=[];if(t){const i=Math.floor(Math.round(n[0])*Lo),s=Math.floor(Math.round(n[1])*Lo),a=(ar(i,0,t.width-1)+ar(s,0,t.height-1)*t.width)*4,o=t.data[a],l=t.data[a+1],h=t.data[a+2]+256*(l+256*o),f=Math.floor((256*256*256-1)/e.length);h&&h%f===0&&r.push(e[h/f-1])}return r}class z5 extends tl{constructor(e,t,r,i){super(e),this.inversePixelTransform=t,this.frameState=r,this.context=i}}const l$=5;class c$ extends Up{constructor(e){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e,this.staleKeys_=new Array,this.maxStaleKeys=l$}getStaleKeys(){return this.staleKeys_}prependStaleKey(e){this.staleKeys_.unshift(e),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(e){return Vt()}getData(e){return null}prepareFrame(e){return Vt()}renderFrame(e,t){return Vt()}forEachFeatureAtCoordinate(e,t,r,i,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(e){const t=e.target;(t.getState()===vt.LOADED||t.getState()===vt.ERROR)&&this.renderIfReadyAndVisible()}loadImage(e){let t=e.getState();return t!=vt.LOADED&&t!=vt.ERROR&&e.addEventListener(Yt.CHANGE,this.boundHandleImageChange_),t==vt.IDLE&&(e.load(),t=e.getState()),t==vt.LOADED}renderIfReadyAndVisible(){const e=this.getLayer();e&&e.getVisible()&&e.getSourceState()==="ready"&&e.changed()}renderDeferred(e){}disposeInternal(){delete this.layer_,super.disposeInternal()}}const p4=[];let wf=null;function u$(){wf=ri(1,1,void 0,{willReadFrequently:!0})}class _I extends c${constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=to(),this.pixelTransform=to(),this.inversePixelTransform=to(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(e,t,r){wf||u$(),wf.clearRect(0,0,1,1);let i;try{wf.drawImage(e,t,r,1,1,0,0,1,1),i=wf.getImageData(0,0,1,1).data}catch{return wf=null,null}return i}getBackground(e){let r=this.getLayer().getBackground();return typeof r=="function"&&(r=r(e.viewState.resolution)),r||void 0}useContainer(e,t,r){const i=this.getLayer().getClassName();let s,a;if(e&&e.className===i&&(!r||e&&e.style.backgroundColor&&Su(jh(e.style.backgroundColor),jh(r)))){const o=e.firstElementChild;Wc(o)&&(a=o.getContext("2d"))}if(a&&MU(a.canvas.style.transform,t)?(this.container=e,this.context=a,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){s=Zs?x5():document.createElement("div"),s.className=i;let o=s.style;o.position="absolute",o.width="100%",o.height="100%",a=ri();const l=a.canvas;s.appendChild(l),o=l.style,o.position="absolute",o.left="0",o.transformOrigin="top left",this.container=s,this.context=a}!this.containerReused&&r&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=r)}clipUnrotated(e,t,r){const i=ad(r),s=Nv(r),a=Mv(r),o=Pv(r);ni(t.coordinateToPixelTransform,i),ni(t.coordinateToPixelTransform,s),ni(t.coordinateToPixelTransform,a),ni(t.coordinateToPixelTransform,o);const l=this.inversePixelTransform;ni(l,i),ni(l,s),ni(l,a),ni(l,o),e.save(),e.beginPath(),e.moveTo(Math.round(i[0]),Math.round(i[1])),e.lineTo(Math.round(s[0]),Math.round(s[1])),e.lineTo(Math.round(a[0]),Math.round(a[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.clip()}prepareContainer(e,t){const r=e.extent,i=e.viewState.resolution,s=e.viewState.rotation,a=e.pixelRatio,o=Math.round(un(r)/i*a),l=Math.round(Wr(r)/i*a);Xo(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/a,1/a,s,-o/2,-l/2),o5(this.inversePixelTransform,this.pixelTransform);const u=PU(this.pixelTransform);if(this.useContainer(t,u,this.getBackground(e)),!this.containerReused){const h=this.context.canvas;h.width!=o||h.height!=l?(h.width=o,h.height=l):this.context.clearRect(0,0,o,l),u!==h.style.transform&&(h.style.transform=u)}}dispatchRenderEvent_(e,t,r){const i=this.getLayer();if(i.hasListener(e)){const s=new z5(e,this.inversePixelTransform,r,t);i.dispatchEvent(s)}}preRender(e,t){this.frameState=t,!t.declutter&&this.dispatchRenderEvent_(Ea.PRERENDER,e,t)}postRender(e,t){t.declutter||this.dispatchRenderEvent_(Ea.POSTRENDER,e,t)}renderDeferredInternal(e){}getRenderContext(e){return e.declutter&&!this.deferredContext_&&(this.deferredContext_=new G5),e.declutter?this.deferredContext_.getContext():this.context}renderDeferred(e){e.declutter&&(this.dispatchRenderEvent_(Ea.PRERENDER,this.context,e),e.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(e),this.dispatchRenderEvent_(Ea.POSTRENDER,this.context,e))}getRenderTransform(e,t,r,i,s,a,o){const l=s/2,u=a/2,h=i/t,f=-h,g=-e[0]+o,y=-e[1];return Xo(this.tempTransform,l,u,h,f,-r,g,y)}disposeInternal(){delete this.frameState,super.disposeInternal()}}class h$ extends _I{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=ea(),this.wrappedRenderedExtent_=ea(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(e,t,r){const i=t.extent,s=t.viewState,a=s.center,o=s.resolution,l=s.projection,u=s.rotation,h=l.getExtent(),f=this.getLayer().getSource(),g=this.getLayer().getDeclutter(),y=t.pixelRatio,v=t.viewHints,x=!(v[di.ANIMATING]||v[di.INTERACTING]),E=this.context,T=Math.round(un(i)/o*y),b=Math.round(Wr(i)/o*y),I=f.getWrapX()&&l.canWrapX(),M=I?un(h):null,F=I?Math.ceil((i[2]-h[2])/M)+1:1;let z=I?Math.floor((i[0]-h[0])/M):0;do{let P=this.getRenderTransform(a,o,0,y,T,b,z*M);t.declutter&&(P=P.slice(0)),e.execute(E,[E.canvas.width,E.canvas.height],P,u,x,r===void 0?hh:r?B5:r$,r?g&&t.declutter[g]:void 0)}while(++z<F)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=ri(this.context.canvas.width,this.context.canvas.height,p4))}resetDrawContext_(){if(this.opacity_!==1&&this.targetContext_){const e=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=e,Gv(this.context),p4.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(e){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,e,!0)}renderDeferredInternal(e){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(e,t){const r=e.layerStatesArray[e.layerIndex];this.opacity_=r.opacity;const i=e.viewState;this.prepareContainer(e,t);const s=this.context,a=this.replayGroup_;let o=a&&!a.isEmpty();if(!o&&!(this.getLayer().hasListener(Ea.PRERENDER)||this.getLayer().hasListener(Ea.POSTRENDER)))return this.container;if(this.setDrawContext_(),this.preRender(s,e),i.projection,this.clipped_=!1,o&&r.extent&&this.clipping){const l=Do(r.extent);o=os(l,e.extent),this.clipped_=o&&!Uc(l,e.extent),this.clipped_&&this.clipUnrotated(s,e,l)}return o&&this.renderWorlds(a,e,this.getLayer().getDeclutter()?!1:void 0),!e.declutter&&this.clipped_&&s.restore(),this.postRender(s,e),this.renderedRotation_!==i.rotation&&(this.renderedRotation_=i.rotation,this.hitDetectionImageData_=null),e.declutter||this.resetDrawContext_(),this.container}getFeatures(e){return new Promise(t=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const r=this.frameState.size.slice(),i=this.renderedCenter_,s=this.renderedResolution_,a=this.renderedRotation_,o=this.renderedProjection_,l=this.wrappedRenderedExtent_,u=this.getLayer(),h=[],f=r[0]*Lo,g=r[1]*Lo;h.push(this.getRenderTransform(i,s,a,Lo,f,g,0).slice());const y=u.getSource(),v=o.getExtent();if(y.getWrapX()&&o.canWrapX()&&!Uc(v,l)){let x=l[0];const E=un(v);let T=0,b;for(;x<v[0];)--T,b=E*T,h.push(this.getRenderTransform(i,s,a,Lo,f,g,b).slice()),x+=E;for(T=0,x=l[2];x>v[2];)++T,b=E*T,h.push(this.getRenderTransform(i,s,a,Lo,f,g,b).slice()),x-=E}this.hitDetectionImageData_=a$(r,h,this.renderedFeatures_,u.getStyleFunction(),l,s,a,t4(s,this.renderedPixelRatio_))}t(o$(e,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(e,t,r,i,s){if(!this.replayGroup_)return;const a=t.viewState.resolution,o=t.viewState.rotation,l=this.getLayer(),u={},h=function(g,y,v){const x=bn(g),E=u[x];if(E){if(E!==!0&&v<E.distanceSq){if(v===0)return u[x]=!0,s.splice(s.lastIndexOf(E),1),i(g,l,y);E.geometry=y,E.distanceSq=v}}else{if(v===0)return u[x]=!0,i(g,l,y);s.push(u[x]={feature:g,layer:l,geometry:y,distanceSq:v,callback:i})}},f=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(e,a,o,r,h,f?t.declutter?.[f]?.all().map(g=>g.value):null)}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}prepareFrame(e){const t=this.getLayer(),r=t.getSource();if(!r)return!1;const i=e.viewHints[di.ANIMATING],s=e.viewHints[di.INTERACTING],a=t.getUpdateWhileAnimating(),o=t.getUpdateWhileInteracting();if(this.ready&&!a&&i||!o&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const l=e.extent,u=e.viewState,h=u.projection,f=u.resolution,g=e.pixelRatio,y=t.getRevision(),v=t.getRenderBuffer();let x=t.getRenderOrder();x===void 0&&(x=wz);const E=u.center.slice(),T=Km(l,v*f),b=T.slice(),I=[T.slice()],M=h.getExtent();if(r.getWrapX()&&h.canWrapX()&&!Uc(M,e.extent)){const Te=un(M),Ce=Math.max(un(T)/2,Te);T[0]=M[0]-Ce,T[2]=M[2]+Ce,ZO(E,h);const Ue=YO(I[0],h);Ue[0]<M[0]&&Ue[2]<M[2]?I.push([Ue[0]+Te,Ue[1],Ue[2]+Te,Ue[3]]):Ue[0]>M[0]&&Ue[2]>M[2]&&I.push([Ue[0]-Te,Ue[1],Ue[2]-Te,Ue[3]])}if(this.ready&&this.renderedResolution_==f&&this.renderedRevision_==y&&this.renderedRenderOrder_==x&&this.renderedFrameDeclutter_===!!e.declutter&&Uc(this.wrappedRenderedExtent_,T))return Su(this.renderedExtent_,b)||(this.hitDetectionImageData_=null,this.renderedExtent_=b),this.renderedCenter_=E,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const F=new Qz(k5(f,g),T,f,g);let z;for(let Te=0,Ce=I.length;Te<Ce;++Te)r.loadFeatures(I[Te],f,h);const P=t4(f,g);let C=!0;const k=(Te,Ce)=>{let Ue;const Ne=Te.getStyleFunction()||t.getStyleFunction();if(Ne&&(Ue=Ne(Te,f)),Ue){const le=this.renderFeature(Te,P,Ue,F,z,this.getLayer().getDeclutter(),Ce);C=C&&!le}},L=a5(T),O=r.getFeaturesInExtent(L);x&&O.sort(x);for(let Te=0,Ce=O.length;Te<Ce;++Te)k(O[Te],Te);this.renderedFeatures_=O,this.ready=C;const U=F.finish(),j=new i$(T,f,g,r.getOverlaps(),U,t.getRenderBuffer(),!!e.declutter);return this.renderedResolution_=f,this.renderedRevision_=y,this.renderedRenderOrder_=x,this.renderedFrameDeclutter_=!!e.declutter,this.renderedExtent_=b,this.wrappedRenderedExtent_=T,this.renderedCenter_=E,this.renderedProjection_=h,this.renderedPixelRatio_=g,this.replayGroup_=j,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(e,t,r,i,s,a,o){if(!r)return!1;let l=!1;if(Array.isArray(r))for(let u=0,h=r.length;u<h;++u)l=n4(i,e,r[u],t,this.boundHandleStyleImageChange_,s,a,o)||l;else l=n4(i,e,r,t,this.boundHandleStyleImageChange_,s,a,o);return l}}let hd=0;const as=1<<hd++,mn=1<<hd++,Ss=1<<hd++,Ya=1<<hd++,Gh=1<<hd++,Qg=1<<hd++,Hy=Math.pow(2,hd)-1,xI={[as]:"boolean",[mn]:"number",[Ss]:"string",[Ya]:"color",[Gh]:"number[]",[Qg]:"size"},d$=Object.keys(xI).map(Number).sort(Cl);function f$(n){return n in xI}function Jg(n){const e=[];for(const t of d$)em(n,t)&&e.push(xI[t]);return e.length===0?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function em(n,e){return(n&e)===e}function bc(n,e){return n===e}class ti{constructor(e,t){if(!f$(e))throw new Error(`literal expressions must have a specific type, got ${Jg(e)}`);this.type=e,this.value=t}}class g${constructor(e,t,...r){this.type=e,this.operator=t,this.args=r}}function $5(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function ki(n,e,t){switch(typeof n){case"boolean":{if(bc(e,Ss))return new ti(Ss,n?"true":"false");if(!em(e,as))throw new Error(`got a boolean, but expected ${Jg(e)}`);return new ti(as,n)}case"number":{if(bc(e,Qg))return new ti(Qg,Is(n));if(bc(e,as))return new ti(as,!!n);if(bc(e,Ss))return new ti(Ss,n.toString());if(!em(e,mn))throw new Error(`got a number, but expected ${Jg(e)}`);return new ti(mn,n)}case"string":{if(bc(e,Ya))return new ti(Ya,hI(n));if(bc(e,as))return new ti(as,!!n);if(!em(e,Ss))throw new Error(`got a string, but expected ${Jg(e)}`);return new ti(Ss,n)}}if(!Array.isArray(n))throw new Error("expression must be an array or a primitive value");if(n.length===0)throw new Error("empty expression");if(typeof n[0]=="string")return b$(n,e,t);for(const r of n)if(typeof r!="number")throw new Error("expected an array of numbers");if(bc(e,Qg)){if(n.length!==2)throw new Error(`expected an array of two values for a size, got ${n.length}`);return new ti(Qg,n)}if(bc(e,Ya)){if(n.length===3)return new ti(Ya,[...n,1]);if(n.length===4)return new ti(Ya,n);throw new Error(`expected an array of 3 or 4 values for a color, got ${n.length}`)}if(!em(e,Gh))throw new Error(`got an array of numbers, but expected ${Jg(e)}`);return new ti(Gh,n)}const Le={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},m$={[Le.Get]:Wt(tn(1,1/0),y4),[Le.Var]:Wt(tn(1,1),p$),[Le.Has]:Wt(tn(1,1/0),y4),[Le.Id]:Wt(y$,af),[Le.Concat]:Wt(tn(2,1/0),An(Ss)),[Le.GeometryType]:Wt(_$,af),[Le.LineMetric]:Wt(af),[Le.Resolution]:Wt(V2,af),[Le.Zoom]:Wt(V2,af),[Le.Time]:Wt(V2,af),[Le.Any]:Wt(tn(2,1/0),An(as)),[Le.All]:Wt(tn(2,1/0),An(as)),[Le.Not]:Wt(tn(1,1),An(as)),[Le.Equal]:Wt(tn(2,2),An(Hy)),[Le.NotEqual]:Wt(tn(2,2),An(Hy)),[Le.GreaterThan]:Wt(tn(2,2),An(mn)),[Le.GreaterThanOrEqualTo]:Wt(tn(2,2),An(mn)),[Le.LessThan]:Wt(tn(2,2),An(mn)),[Le.LessThanOrEqualTo]:Wt(tn(2,2),An(mn)),[Le.Multiply]:Wt(tn(2,1/0),_4),[Le.Coalesce]:Wt(tn(2,1/0),_4),[Le.Divide]:Wt(tn(2,2),An(mn)),[Le.Add]:Wt(tn(2,1/0),An(mn)),[Le.Subtract]:Wt(tn(2,2),An(mn)),[Le.Clamp]:Wt(tn(3,3),An(mn)),[Le.Mod]:Wt(tn(2,2),An(mn)),[Le.Pow]:Wt(tn(2,2),An(mn)),[Le.Abs]:Wt(tn(1,1),An(mn)),[Le.Floor]:Wt(tn(1,1),An(mn)),[Le.Ceil]:Wt(tn(1,1),An(mn)),[Le.Round]:Wt(tn(1,1),An(mn)),[Le.Sin]:Wt(tn(1,1),An(mn)),[Le.Cos]:Wt(tn(1,1),An(mn)),[Le.Atan]:Wt(tn(1,2),An(mn)),[Le.Sqrt]:Wt(tn(1,1),An(mn)),[Le.Match]:Wt(tn(4,1/0),x4,v$),[Le.Between]:Wt(tn(3,3),An(mn)),[Le.Interpolate]:Wt(tn(6,1/0),x4,w$),[Le.Case]:Wt(tn(3,1/0),x$,E$),[Le.In]:Wt(tn(2,2),S$),[Le.Number]:Wt(tn(1,1/0),An(Hy)),[Le.String]:Wt(tn(1,1/0),An(Hy)),[Le.Array]:Wt(tn(1,1/0),An(mn)),[Le.Color]:Wt(tn(1,4),An(mn)),[Le.Band]:Wt(tn(1,3),An(mn)),[Le.Palette]:Wt(tn(2,2),T$),[Le.ToString]:Wt(tn(1,1),An(as|mn|Ss|Ya))};function y4(n,e,t){const r=n.length-1,i=new Array(r);for(let s=0;s<r;++s){const a=n[s+1];switch(typeof a){case"number":{i[s]=new ti(mn,a);break}case"string":{i[s]=new ti(Ss,a);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${a}`)}s===0&&t.properties.add(String(a))}return i}function p$(n,e,t){const r=n[1];if(typeof r!="string")throw new Error("expected a string argument for var operation");return t.variables.add(r),[new ti(Ss,r)]}function y$(n,e,t){t.featureId=!0}function _$(n,e,t){t.geometryType=!0}function V2(n,e,t){t.mapState=!0}function af(n,e,t){const r=n[0];if(n.length!==1)throw new Error(`expected no arguments for ${r} operation`);return[]}function tn(n,e){return function(t,r,i){const s=t[0],a=t.length-1;if(n===e){if(a!==n){const o=n===1?"":"s";throw new Error(`expected ${n} argument${o} for ${s}, got ${a}`)}}else if(a<n||a>e){const o=e===1/0?`${n} or more`:`${n} to ${e}`;throw new Error(`expected ${o} arguments for ${s}, got ${a}`)}}}function _4(n,e,t){const r=n.length-1,i=new Array(r);for(let s=0;s<r;++s){const a=ki(n[s+1],e,t);i[s]=a}return i}function An(n){return function(e,t,r){const i=e.length-1,s=new Array(i);for(let a=0;a<i;++a){const o=ki(e[a+1],n,r);s[a]=o}return s}}function x$(n,e,t){const r=n[0],i=n.length-1;if(i%2===0)throw new Error(`expected an odd number of arguments for ${r}, got ${i} instead`)}function x4(n,e,t){const r=n[0],i=n.length-1;if(i%2===1)throw new Error(`expected an even number of arguments for operation ${r}, got ${i} instead`)}function v$(n,e,t){const r=n.length-1,i=Ss|mn|as,s=ki(n[1],i,t),a=ki(n[n.length-1],e,t),o=new Array(r-2);for(let l=0;l<r-2;l+=2){try{const u=ki(n[l+2],s.type,t);o[l]=u}catch(u){throw new Error(`failed to parse argument ${l+1} of match expression: ${u.message}`)}try{const u=ki(n[l+3],a.type,t);o[l+1]=u}catch(u){throw new Error(`failed to parse argument ${l+2} of match expression: ${u.message}`)}}return[s,...o,a]}function w$(n,e,t){const r=n[1];let i;switch(r[0]){case"linear":i=1;break;case"exponential":const l=r[1];if(typeof l!="number"||l<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(l)} instead`);i=l;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(r)}`)}const s=new ti(mn,i);let a;try{a=ki(n[2],mn,t)}catch(l){throw new Error(`failed to parse argument 1 in interpolate expression: ${l.message}`)}const o=new Array(n.length-3);for(let l=0;l<o.length;l+=2){try{const u=ki(n[l+3],mn,t);o[l]=u}catch(u){throw new Error(`failed to parse argument ${l+2} for interpolate expression: ${u.message}`)}try{const u=ki(n[l+4],e,t);o[l+1]=u}catch(u){throw new Error(`failed to parse argument ${l+3} for interpolate expression: ${u.message}`)}}return[s,a,...o]}function E$(n,e,t){const r=ki(n[n.length-1],e,t),i=new Array(n.length-1);for(let s=0;s<i.length-1;s+=2){try{const a=ki(n[s+1],as,t);i[s]=a}catch(a){throw new Error(`failed to parse argument ${s} of case expression: ${a.message}`)}try{const a=ki(n[s+2],r.type,t);i[s+1]=a}catch(a){throw new Error(`failed to parse argument ${s+1} of case expression: ${a.message}`)}}return i[i.length-1]=r,i}function S$(n,e,t){let r=n[2];if(!Array.isArray(r))throw new Error('the second argument for the "in" operator must be an array');let i;if(typeof r[0]=="string"){if(r[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(r[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');r=r[1],i=Ss}else i=mn;const s=new Array(r.length);for(let o=0;o<s.length;o++)try{const l=ki(r[o],i,t);s[o]=l}catch(l){throw new Error(`failed to parse haystack item ${o} for "in" expression: ${l.message}`)}return[ki(n[1],i,t),...s]}function T$(n,e,t){let r;try{r=ki(n[1],mn,t)}catch(a){throw new Error(`failed to parse first argument in palette expression: ${a.message}`)}const i=n[2];if(!Array.isArray(i))throw new Error("the second argument of palette must be an array");const s=new Array(i.length);for(let a=0;a<s.length;a++){let o;try{o=ki(i[a],Ya,t)}catch(l){throw new Error(`failed to parse color at index ${a} in palette expression: ${l.message}`)}if(!(o instanceof ti))throw new Error(`the palette color at index ${a} must be a literal value`);s[a]=o}return[r,...s]}function Wt(...n){return function(e,t,r){const i=e[0];let s;for(let a=0;a<n.length;a++){const o=n[a](e,t,r);if(a==n.length-1){if(!o)throw new Error("expected last argument validator to return the parsed args");s=o}}return new g$(t,i,...s)}}function b$(n,e,t){const r=n[0],i=m$[r];if(!i)throw new Error(`unknown operator: ${r}`);return i(n,e,t)}function W5(n){if(!n)return"";const e=n.getType();switch(e){case"Point":case"LineString":case"Polygon":return e;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return e.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return W5(n.getGeometries()[0]);default:return""}}function H5(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function Xl(n,e,t){const r=ki(n,e,t);return lo(r)}function lo(n,e){if(n instanceof ti){if(n.type===Ya&&typeof n.value=="string"){const r=hI(n.value);return function(){return r}}return function(){return n.value}}const t=n.operator;switch(t){case Le.Number:case Le.String:case Le.Coalesce:return I$(n);case Le.Get:case Le.Var:case Le.Has:return A$(n);case Le.Id:return r=>r.featureId;case Le.GeometryType:return r=>r.geometryType;case Le.Concat:{const r=n.args.map(i=>lo(i));return i=>"".concat(...r.map(s=>s(i).toString()))}case Le.Resolution:return r=>r.resolution;case Le.Any:case Le.All:case Le.Between:case Le.In:case Le.Not:return C$(n);case Le.Equal:case Le.NotEqual:case Le.LessThan:case Le.LessThanOrEqualTo:case Le.GreaterThan:case Le.GreaterThanOrEqualTo:return R$(n);case Le.Multiply:case Le.Divide:case Le.Add:case Le.Subtract:case Le.Clamp:case Le.Mod:case Le.Pow:case Le.Abs:case Le.Floor:case Le.Ceil:case Le.Round:case Le.Sin:case Le.Cos:case Le.Atan:case Le.Sqrt:return k$(n);case Le.Case:return P$(n);case Le.Match:return M$(n);case Le.Interpolate:return N$(n);case Le.ToString:return L$(n);default:throw new Error(`Unsupported operator ${t}`)}}function I$(n,e){const t=n.operator,r=n.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=lo(n.args[s]);switch(t){case Le.Coalesce:return s=>{for(let a=0;a<r;++a){const o=i[a](s);if(typeof o<"u"&&o!==null)return o}throw new Error("Expected one of the values to be non-null")};case Le.Number:case Le.String:return s=>{for(let a=0;a<r;++a){const o=i[a](s);if(typeof o===t)return o}throw new Error(`Expected one of the values to be a ${t}`)};default:throw new Error(`Unsupported assertion operator ${t}`)}}function A$(n,e){const r=n.args[0].value;switch(n.operator){case Le.Get:return i=>{const s=n.args;let a=i.properties[r];for(let o=1,l=s.length;o<l;++o){const h=s[o].value;a=a[h]}return a};case Le.Var:return i=>i.variables[r];case Le.Has:return i=>{const s=n.args;if(!(r in i.properties))return!1;let a=i.properties[r];for(let o=1,l=s.length;o<l;++o){const h=s[o].value;if(!a||!Object.hasOwn(a,h))return!1;a=a[h]}return!0};default:throw new Error(`Unsupported accessor operator ${n.operator}`)}}function R$(n,e){const t=n.operator,r=lo(n.args[0]),i=lo(n.args[1]);switch(t){case Le.Equal:return s=>r(s)===i(s);case Le.NotEqual:return s=>r(s)!==i(s);case Le.LessThan:return s=>r(s)<i(s);case Le.LessThanOrEqualTo:return s=>r(s)<=i(s);case Le.GreaterThan:return s=>r(s)>i(s);case Le.GreaterThanOrEqualTo:return s=>r(s)>=i(s);default:throw new Error(`Unsupported comparison operator ${t}`)}}function C$(n,e){const t=n.operator,r=n.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=lo(n.args[s]);switch(t){case Le.Any:return s=>{for(let a=0;a<r;++a)if(i[a](s))return!0;return!1};case Le.All:return s=>{for(let a=0;a<r;++a)if(!i[a](s))return!1;return!0};case Le.Between:return s=>{const a=i[0](s),o=i[1](s),l=i[2](s);return a>=o&&a<=l};case Le.In:return s=>{const a=i[0](s);for(let o=1;o<r;++o)if(a===i[o](s))return!0;return!1};case Le.Not:return s=>!i[0](s);default:throw new Error(`Unsupported logical operator ${t}`)}}function k$(n,e){const t=n.operator,r=n.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=lo(n.args[s]);switch(t){case Le.Multiply:return s=>{let a=1;for(let o=0;o<r;++o)a*=i[o](s);return a};case Le.Divide:return s=>i[0](s)/i[1](s);case Le.Add:return s=>{let a=0;for(let o=0;o<r;++o)a+=i[o](s);return a};case Le.Subtract:return s=>i[0](s)-i[1](s);case Le.Clamp:return s=>{const a=i[0](s),o=i[1](s);if(a<o)return o;const l=i[2](s);return a>l?l:a};case Le.Mod:return s=>i[0](s)%i[1](s);case Le.Pow:return s=>Math.pow(i[0](s),i[1](s));case Le.Abs:return s=>Math.abs(i[0](s));case Le.Floor:return s=>Math.floor(i[0](s));case Le.Ceil:return s=>Math.ceil(i[0](s));case Le.Round:return s=>Math.round(i[0](s));case Le.Sin:return s=>Math.sin(i[0](s));case Le.Cos:return s=>Math.cos(i[0](s));case Le.Atan:return r===2?s=>Math.atan2(i[0](s),i[1](s)):s=>Math.atan(i[0](s));case Le.Sqrt:return s=>Math.sqrt(i[0](s));default:throw new Error(`Unsupported numeric operator ${t}`)}}function P$(n,e){const t=n.args.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=lo(n.args[i]);return i=>{for(let s=0;s<t-1;s+=2)if(r[s](i))return r[s+1](i);return r[t-1](i)}}function M$(n,e){const t=n.args.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=lo(n.args[i]);return i=>{const s=r[0](i);for(let a=1;a<t-1;a+=2)if(s===r[a](i))return r[a+1](i);return r[t-1](i)}}function N$(n,e){const t=n.args.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=lo(n.args[i]);return i=>{const s=r[0](i),a=r[1](i);let o,l;for(let u=2;u<t;u+=2){const h=r[u](i);let f=r[u+1](i);const g=Array.isArray(f);if(g&&(f=sz(f)),h>=a)return u===2?f:g?O$(s,a,o,l,h,f):tm(s,a,o,l,h,f);o=h,l=f}return l}}function L$(n,e){const t=n.operator,r=n.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=lo(n.args[s]);switch(t){case Le.ToString:return s=>{const a=i[0](s);return n.args[0].type===Ya?dI(a):a.toString()};default:throw new Error(`Unsupported convert operator ${t}`)}}function tm(n,e,t,r,i,s){const a=i-t;if(a===0)return r;const o=e-t,l=n===1?o/a:(Math.pow(n,o)-1)/(Math.pow(n,a)-1);return r+l*(s-r)}function O$(n,e,t,r,i,s){if(i-t===0)return r;const o=qP(r),l=qP(s);let u=l[2]-o[2];u>180?u-=360:u<-180&&(u+=360);const h=[tm(n,e,t,o[0],i,l[0]),tm(n,e,t,o[1],i,l[1]),o[2]+tm(n,e,t,0,i,u),tm(n,e,t,r[3],i,s[3])];return az(h)}function D$(n){return!0}function F$(n){const e=$5(),t=j$(n,e),r=H5();return function(i,s){if(r.properties=i.getPropertiesInternal(),r.resolution=s,e.featureId){const a=i.getId();a!==void 0?r.featureId=a:r.featureId=null}return e.geometryType&&(r.geometryType=W5(i.getGeometry())),t(r)}}function v4(n){const e=$5(),t=n.length,r=new Array(t);for(let a=0;a<t;++a)r[a]=dT(n[a],e);const i=H5(),s=new Array(t);return function(a,o){if(i.properties=a.getPropertiesInternal(),i.resolution=o,e.featureId){const u=a.getId();u!==void 0?i.featureId=u:i.featureId=null}let l=0;for(let u=0;u<t;++u){const h=r[u](i);h&&(s[l]=h,l+=1)}return s.length=l,s}}function j$(n,e){const t=n.length,r=new Array(t);for(let i=0;i<t;++i){const s=n[i],a="filter"in s?Xl(s.filter,as,e):D$;let o;if(Array.isArray(s.style)){const l=s.style.length;o=new Array(l);for(let u=0;u<l;++u)o[u]=dT(s.style[u],e)}else o=[dT(s.style,e)];r[i]={filter:a,styles:o}}return function(i){const s=[];let a=!1;for(let o=0;o<t;++o){const l=r[o].filter;if(l(i)&&!(n[o].else&&a)){a=!0;for(const u of r[o].styles){const h=u(i);h&&s.push(h)}}}return s}}function dT(n,e){const t=tp(n,"",e),r=np(n,"",e),i=V$(n,e),s=G$(n,e),a=Ts(n,"z-index",e);if(!t&&!r&&!i&&!s&&!Lh(n))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(n));const o=new $n;return function(l){let u=!0;if(t){const h=t(l);h&&(u=!1),o.setFill(h)}if(r){const h=r(l);h&&(u=!1),o.setStroke(h)}if(i){const h=i(l);h&&(u=!1),o.setText(h)}if(s){const h=s(l);h&&(u=!1),o.setImage(h)}return a&&o.setZIndex(a(l)),u?null:o}}function tp(n,e,t){let r;if(e+"fill-pattern-src"in n)r=$$(n,e+"fill-",t);else{if(n[e+"fill-color"]==="none")return s=>null;r=vI(n,e+"fill-color",t)}if(!r)return null;const i=new kr;return function(s){const a=r(s);return a===uI?null:(i.setColor(a),i)}}function np(n,e,t){const r=Ts(n,e+"stroke-width",t),i=vI(n,e+"stroke-color",t);if(!r&&!i)return null;const s=El(n,e+"stroke-line-cap",t),a=El(n,e+"stroke-line-join",t),o=K5(n,e+"stroke-line-dash",t),l=Ts(n,e+"stroke-line-dash-offset",t),u=Ts(n,e+"stroke-miter-limit",t),h=new Hr;return function(f){if(i){const g=i(f);if(g===uI)return null;h.setColor(g)}if(r&&h.setWidth(r(f)),s){const g=s(f);if(g!=="butt"&&g!=="round"&&g!=="square")throw new Error("Expected butt, round, or square line cap");h.setLineCap(g)}if(a){const g=a(f);if(g!=="bevel"&&g!=="round"&&g!=="miter")throw new Error("Expected bevel, round, or miter line join");h.setLineJoin(g)}return o&&h.setLineDash(o(f)),l&&h.setLineDashOffset(l(f)),u&&h.setMiterLimit(u(f)),h}}function V$(n,e){const t="text-",r=El(n,t+"value",e);if(!r)return null;const i=tp(n,t,e),s=tp(n,t+"background-",e),a=np(n,t,e),o=np(n,t+"background-",e),l=El(n,t+"font",e),u=Ts(n,t+"max-angle",e),h=Ts(n,t+"offset-x",e),f=Ts(n,t+"offset-y",e),g=$f(n,t+"overflow",e),y=El(n,t+"placement",e),v=Ts(n,t+"repeat",e),x=zv(n,t+"scale",e),E=$f(n,t+"rotate-with-view",e),T=Ts(n,t+"rotation",e),b=El(n,t+"align",e),I=El(n,t+"justify",e),M=El(n,t+"baseline",e),F=$f(n,t+"keep-upright",e),z=K5(n,t+"padding",e),P=$v(n,t+"declutter-mode"),C=new ud({declutterMode:P});return function(k){if(C.setText(r(k)),i&&C.setFill(i(k)),s&&C.setBackgroundFill(s(k)),a&&C.setStroke(a(k)),o&&C.setBackgroundStroke(o(k)),l&&C.setFont(l(k)),u&&C.setMaxAngle(u(k)),h&&C.setOffsetX(h(k)),f&&C.setOffsetY(f(k)),g&&C.setOverflow(g(k)),y){const L=y(k);if(L!=="point"&&L!=="line")throw new Error("Expected point or line for text-placement");C.setPlacement(L)}if(v&&C.setRepeat(v(k)),x&&C.setScale(x(k)),E&&C.setRotateWithView(E(k)),T&&C.setRotation(T(k)),b){const L=b(k);if(L!=="left"&&L!=="center"&&L!=="right"&&L!=="end"&&L!=="start")throw new Error("Expected left, right, center, start, or end for text-align");C.setTextAlign(L)}if(I){const L=I(k);if(L!=="left"&&L!=="right"&&L!=="center")throw new Error("Expected left, right, or center for text-justify");C.setJustify(L)}if(M){const L=M(k);if(L!=="bottom"&&L!=="top"&&L!=="middle"&&L!=="alphabetic"&&L!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");C.setTextBaseline(L)}return z&&C.setPadding(z(k)),F&&C.setKeepUpright(F(k)),C}}function G$(n,e){return"icon-src"in n?B$(n,e):"shape-points"in n?U$(n,e):"circle-radius"in n?z$(n,e):null}function B$(n,e){const t="icon-",r=t+"src",i=Y5(n[r],r),s=dx(n,t+"anchor",e),a=zv(n,t+"scale",e),o=Ts(n,t+"opacity",e),l=dx(n,t+"displacement",e),u=Ts(n,t+"rotation",e),h=$f(n,t+"rotate-with-view",e),f=E4(n,t+"anchor-origin"),g=S4(n,t+"anchor-x-units"),y=S4(n,t+"anchor-y-units"),v=Y$(n,t+"color"),x=H$(n,t+"cross-origin"),E=K$(n,t+"offset"),T=E4(n,t+"offset-origin"),b=fx(n,t+"width"),I=fx(n,t+"height"),M=W$(n,t+"size"),F=$v(n,t+"declutter-mode"),z=new qp({src:i,anchorOrigin:f,anchorXUnits:g,anchorYUnits:y,color:v,crossOrigin:x,offset:E,offsetOrigin:T,height:I,width:b,size:M,declutterMode:F});return function(P){return o&&z.setOpacity(o(P)),l&&z.setDisplacement(l(P)),u&&z.setRotation(u(P)),h&&z.setRotateWithView(h(P)),a&&z.setScale(a(P)),s&&z.setAnchor(s(P)),z}}function U$(n,e){const t="shape-",r=t+"points",i=t+"radius",s=fT(n[r],r),a=fT(n[i],i),o=tp(n,t,e),l=np(n,t,e),u=zv(n,t+"scale",e),h=dx(n,t+"displacement",e),f=Ts(n,t+"rotation",e),g=$f(n,t+"rotate-with-view",e),y=fx(n,t+"radius2"),v=fx(n,t+"angle"),x=$v(n,t+"declutter-mode"),E=new Uv({points:s,radius:a,radius2:y,angle:v,declutterMode:x});return function(T){return o&&E.setFill(o(T)),l&&E.setStroke(l(T)),h&&E.setDisplacement(h(T)),f&&E.setRotation(f(T)),g&&E.setRotateWithView(g(T)),u&&E.setScale(u(T)),E}}function z$(n,e){const t="circle-",r=tp(n,t,e),i=np(n,t,e),s=Ts(n,t+"radius",e),a=zv(n,t+"scale",e),o=dx(n,t+"displacement",e),l=Ts(n,t+"rotation",e),u=$f(n,t+"rotate-with-view",e),h=$v(n,t+"declutter-mode"),f=new ka({radius:5,declutterMode:h});return function(g){return s&&f.setRadius(s(g)),r&&f.setFill(r(g)),i&&f.setStroke(i(g)),o&&f.setDisplacement(o(g)),l&&f.setRotation(l(g)),u&&f.setRotateWithView(u(g)),a&&f.setScale(a(g)),f}}function Ts(n,e,t){if(!(e in n))return;const r=Xl(n[e],mn,t);return function(i){return fT(r(i),e)}}function El(n,e,t){if(!(e in n))return null;const r=Xl(n[e],Ss,t);return function(i){return Y5(r(i),e)}}function $$(n,e,t){const r=El(n,e+"pattern-src",t),i=w4(n,e+"pattern-offset",t),s=w4(n,e+"pattern-size",t),a=vI(n,e+"color",t);return function(o){return{src:r(o),offset:i&&i(o),size:s&&s(o),color:a&&a(o)}}}function $f(n,e,t){if(!(e in n))return null;const r=Xl(n[e],as,t);return function(i){const s=r(i);if(typeof s!="boolean")throw new Error(`Expected a boolean for ${e}`);return s}}function vI(n,e,t){if(!(e in n))return null;const r=Xl(n[e],Ya,t);return function(i){return X5(r(i),e)}}function K5(n,e,t){if(!(e in n))return null;const r=Xl(n[e],Gh,t);return function(i){return Zp(r(i),e)}}function dx(n,e,t){if(!(e in n))return null;const r=Xl(n[e],Gh,t);return function(i){const s=Zp(r(i),e);if(s.length!==2)throw new Error(`Expected two numbers for ${e}`);return s}}function w4(n,e,t){if(!(e in n))return null;const r=Xl(n[e],Gh,t);return function(i){return q5(r(i),e)}}function zv(n,e,t){if(!(e in n))return null;const r=Xl(n[e],Gh|mn,t);return function(i){return X$(r(i),e)}}function fx(n,e){const t=n[e];if(t!==void 0){if(typeof t!="number")throw new Error(`Expected a number for ${e}`);return t}}function W$(n,e){const t=n[e];if(t!==void 0){if(typeof t=="number")return Is(t);if(!Array.isArray(t))throw new Error(`Expected a number or size array for ${e}`);if(t.length!==2||typeof t[0]!="number"||typeof t[1]!="number")throw new Error(`Expected a number or size array for ${e}`);return t}}function H$(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);return t}}function E4(n,e){const t=n[e];if(t!==void 0){if(t!=="bottom-left"&&t!=="bottom-right"&&t!=="top-left"&&t!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return t}}function S4(n,e){const t=n[e];if(t!==void 0){if(t!=="pixels"&&t!=="fraction")throw new Error(`Expected pixels or fraction for ${e}`);return t}}function K$(n,e){const t=n[e];if(t!==void 0)return Zp(t,e)}function $v(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);if(t!=="declutter"&&t!=="obstacle"&&t!=="none")throw new Error(`Expected declutter, obstacle, or none for ${e}`);return t}}function Y$(n,e){const t=n[e];if(t!==void 0)return X5(t,e)}function Zp(n,e){if(!Array.isArray(n))throw new Error(`Expected an array for ${e}`);const t=n.length;for(let r=0;r<t;++r)if(typeof n[r]!="number")throw new Error(`Expected an array of numbers for ${e}`);return n}function Y5(n,e){if(typeof n!="string")throw new Error(`Expected a string for ${e}`);return n}function fT(n,e){if(typeof n!="number")throw new Error(`Expected a number for ${e}`);return n}function X5(n,e){if(typeof n=="string")return n;const t=Zp(n,e),r=t.length;if(r<3||r>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return t}function q5(n,e){const t=Zp(n,e);if(t.length!==2)throw new Error(`Expected an array of two numbers for ${e}`);return t}function X$(n,e){return typeof n=="number"?n:q5(n,e)}const Ba={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function T4(n,e,t){return(function(r,i,s,a,o){if(!r)return;if(!i&&!e)return r;const l=e?0:s[0]*i,u=e?0:s[1]*i,h=o?o[0]:0,f=o?o[1]:0;let g=n[0]+l/2+h,y=n[2]-l/2+h,v=n[1]+u/2+f,x=n[3]-u/2+f;g>y&&(g=(y+g)/2,y=g),v>x&&(v=(x+v)/2,x=v);let E=ar(r[0],g,y),T=ar(r[1],v,x);if(a&&t&&i){const b=30*i;E+=-b*Math.log(1+Math.max(0,g-r[0])/b)+b*Math.log(1+Math.max(0,r[0]-y)/b),T+=-b*Math.log(1+Math.max(0,v-r[1])/b)+b*Math.log(1+Math.max(0,r[1]-x)/b)}return[E,T]})}function q$(n){return n}function Z5(n){return Math.pow(n,3)}function D0(n){return 1-Z5(1-n)}function Z$(n){return 3*n*n-2*n*n*n}function Q$(n){return n}function wI(n,e,t,r){const i=un(e)/t[0],s=Wr(e)/t[1];return r?Math.min(n,Math.max(i,s)):Math.min(n,Math.min(i,s))}function EI(n,e,t){let r=Math.min(n,e);const i=50;return r*=Math.log(1+i*Math.max(0,n/e-1))/i+1,t&&(r=Math.max(r,t),r/=Math.log(1+i*Math.max(0,t/n-1))/i+1),ar(r,t/2,e*2)}function J$(n,e,t,r){return e=e!==void 0?e:!0,(function(i,s,a,o){if(i!==void 0){const l=n[0],u=n[n.length-1],h=t?wI(l,t,a,r):l;if(o)return e?EI(i,h,u):ar(i,u,h);const f=Math.min(h,i),g=Math.floor(Cv(n,f,s));return n[g]>h&&g<n.length-1?n[g+1]:n[g]}})}function eW(n,e,t,r,i,s){return r=r!==void 0?r:!0,t=t!==void 0?t:0,(function(a,o,l,u){if(a!==void 0){const h=i?wI(e,i,l,s):e;if(u)return r?EI(a,h,t):ar(a,t,h);const f=1e-9,g=Math.ceil(Math.log(e/h)/Math.log(n)-f),y=-o*(.5-f)+.5,v=Math.min(h,a),x=Math.floor(Math.log(e/v)/Math.log(n)+y),E=Math.max(g,x),T=e/Math.pow(n,E);return ar(T,t,h)}})}function b4(n,e,t,r,i){return t=t!==void 0?t:!0,(function(s,a,o,l){if(s!==void 0){const u=r?wI(n,r,o,i):n;return!t||!l?ar(s,e,u):EI(s,u,e)}})}function SI(n){if(n!==void 0)return 0}function I4(n){if(n!==void 0)return n}function tW(n){const e=2*Math.PI/n;return(function(t,r){if(r)return t;if(t!==void 0)return t=Math.floor(t/e+.5)*e,t})}function nW(n){const e=Pl(5);return(function(t,r){return r||t===void 0?t:Math.abs(t)<=e?0:t})}const rW=42,TI=256,G2=0;class Oo extends nl{constructor(e){super(),this.on,this.once,this.un,e=Object.assign({},e),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=eI(e.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,e.projection&&s5(),e.center&&(e.center=wl(e.center,this.projection_)),e.extent&&(e.extent=Do(e.extent,this.projection_)),this.applyOptions_(e)}applyOptions_(e){const t=Object.assign({},e);for(const o in Ba)delete t[o];this.setProperties(t,!0);const r=sW(e);this.maxResolution_=r.maxResolution,this.minResolution_=r.minResolution,this.zoomFactor_=r.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=r.minZoom;const i=iW(e),s=r.constraint,a=aW(e);this.constraints_={center:i,resolution:s,rotation:a},this.setRotation(e.rotation!==void 0?e.rotation:0),this.setCenterInternal(e.center!==void 0?e.center:null),e.resolution!==void 0?this.setResolution(e.resolution):e.zoom!==void 0&&this.setZoom(e.zoom)}get padding(){return this.padding_}set padding(e){let t=this.padding_;this.padding_=e;const r=this.getCenterInternal();if(r){const i=e||[0,0,0,0];t=t||[0,0,0,0];const s=this.getResolution(),a=s/2*(i[3]-t[3]+t[1]-i[1]),o=s/2*(i[0]-t[0]+t[2]-i[2]);this.setCenterInternal([r[0]+a,r[1]-o])}}getUpdatedOptions_(e){const t=this.getProperties();return t.resolution!==void 0?t.resolution=this.getResolution():t.zoom=this.getZoom(),t.center=this.getCenterInternal(),t.rotation=this.getRotation(),Object.assign({},t,e)}animate(e){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const t=new Array(arguments.length);for(let r=0;r<t.length;++r){let i=arguments[r];i.center&&(i=Object.assign({},i),i.center=wl(i.center,this.getProjection())),i.anchor&&(i=Object.assign({},i),i.anchor=wl(i.anchor,this.getProjection())),t[r]=i}this.animateInternal.apply(this,t)}animateInternal(e){let t=arguments.length,r;t>1&&typeof arguments[t-1]=="function"&&(r=arguments[t-1],--t);let i=0;for(;i<t&&!this.isDef();++i){const h=arguments[i];h.center&&this.setCenterInternal(h.center),h.zoom!==void 0?this.setZoom(h.zoom):h.resolution&&this.setResolution(h.resolution),h.rotation!==void 0&&this.setRotation(h.rotation)}if(i===t){r&&Ky(r,!0);return}let s=Date.now(),a=this.targetCenter_.slice(),o=this.targetResolution_,l=this.targetRotation_;const u=[];for(;i<t;++i){const h=arguments[i],f={start:s,complete:!1,anchor:h.anchor,duration:h.duration!==void 0?h.duration:1e3,easing:h.easing||Z$,callback:r};if(h.center&&(f.sourceCenter=a,f.targetCenter=h.center.slice(),a=f.targetCenter),h.zoom!==void 0?(f.sourceResolution=o,f.targetResolution=this.getResolutionForZoom(h.zoom),o=f.targetResolution):h.resolution&&(f.sourceResolution=o,f.targetResolution=h.resolution,o=f.targetResolution),h.rotation!==void 0){f.sourceRotation=l;const g=Jc(h.rotation-l+Math.PI,2*Math.PI)-Math.PI;f.targetRotation=l+g,l=f.targetRotation}oW(f)?f.complete=!0:s+=f.duration,u.push(f)}this.animations_.push(u),this.setHint(di.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[di.ANIMATING]>0}getInteracting(){return this.hints_[di.INTERACTING]>0}cancelAnimations(){this.setHint(di.ANIMATING,-this.hints_[di.ANIMATING]);let e;for(let t=0,r=this.animations_.length;t<r;++t){const i=this.animations_[t];if(i[0].callback&&Ky(i[0].callback,!1),!e)for(let s=0,a=i.length;s<a;++s){const o=i[s];if(!o.complete){e=o.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=e,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const e=Date.now();let t=!1;for(let r=this.animations_.length-1;r>=0;--r){const i=this.animations_[r];let s=!0;for(let a=0,o=i.length;a<o;++a){const l=i[a];if(l.complete)continue;const u=e-l.start;let h=l.duration>0?u/l.duration:1;h>=1?(l.complete=!0,h=1):s=!1;const f=l.easing(h);if(l.sourceCenter){const g=l.sourceCenter[0],y=l.sourceCenter[1],v=l.targetCenter[0],x=l.targetCenter[1];this.nextCenter_=l.targetCenter;const E=g+f*(v-g),T=y+f*(x-y);this.targetCenter_=[E,T]}if(l.sourceResolution&&l.targetResolution){const g=f===1?l.targetResolution:l.sourceResolution+f*(l.targetResolution-l.sourceResolution);if(l.anchor){const y=this.getViewportSize_(this.getRotation()),v=this.constraints_.resolution(g,0,y,!0);this.targetCenter_=this.calculateCenterZoom(v,l.anchor)}this.nextResolution_=l.targetResolution,this.targetResolution_=g,this.applyTargetState_(!0)}if(l.sourceRotation!==void 0&&l.targetRotation!==void 0){const g=f===1?Jc(l.targetRotation+Math.PI,2*Math.PI)-Math.PI:l.sourceRotation+f*(l.targetRotation-l.sourceRotation);if(l.anchor){const y=this.constraints_.rotation(g,!0);this.targetCenter_=this.calculateCenterRotate(y,l.anchor)}this.nextRotation_=l.targetRotation,this.targetRotation_=g}if(this.applyTargetState_(!0),t=!0,!l.complete)break}if(s){this.animations_[r]=null,this.setHint(di.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const a=i[0].callback;a&&Ky(a,!0)}}this.animations_=this.animations_.filter(Boolean),t&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(e,t){let r;const i=this.getCenterInternal();return i!==void 0&&(r=[i[0]-t[0],i[1]-t[1]],qb(r,e-this.getRotation()),QB(r,t)),r}calculateCenterZoom(e,t){let r;const i=this.getCenterInternal(),s=this.getResolution();if(i!==void 0&&s!==void 0){const a=t[0]-e*(t[0]-i[0])/s,o=t[1]-e*(t[1]-i[1])/s;r=[a,o]}return r}getViewportSize_(e){const t=this.viewportSize_;if(e){const r=t[0],i=t[1];return[Math.abs(r*Math.cos(e))+Math.abs(i*Math.sin(e)),Math.abs(r*Math.sin(e))+Math.abs(i*Math.cos(e))]}return t}setViewportSize(e){this.viewportSize_=Array.isArray(e)?e.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const e=this.getCenterInternal();return e&&iT(e,this.getProjection())}getCenterInternal(){return this.get(Ba.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(e){return e!==void 0?(e[0]=this.hints_[0],e[1]=this.hints_[1],e):this.hints_.slice()}calculateExtent(e){const t=this.calculateExtentInternal(e);return a5(t,this.getProjection())}calculateExtentInternal(e){e=e||this.getViewportSizeMinusPadding_();const t=this.getCenterInternal();Dn(t,"The view center is not defined");const r=this.getResolution();Dn(r!==void 0,"The view resolution is not defined");const i=this.getRotation();return Dn(i!==void 0,"The view rotation is not defined"),J_(t,r,i,e)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))}setConstrainResolution(e){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:e}))}getProjection(){return this.projection_}getResolution(){return this.get(Ba.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(e,t){return this.getResolutionForExtentInternal(Do(e,this.getProjection()),t)}getResolutionForExtentInternal(e,t){t=t||this.getViewportSizeMinusPadding_();const r=un(e)/t[0],i=Wr(e)/t[1];return Math.max(r,i)}getResolutionForValueFunction(e){e=e||2;const t=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,i=Math.log(t/r)/Math.log(e);return(function(s){return t/Math.pow(e,s*i)})}getRotation(){return this.get(Ba.ROTATION)}getValueForResolutionFunction(e){const t=Math.log(e||2),r=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,s=Math.log(r/i)/t;return(function(a){return Math.log(r/a)/t/s})}getViewportSizeMinusPadding_(e){let t=this.getViewportSize_(e);const r=this.padding_;return r&&(t=[t[0]-r[1]-r[3],t[1]-r[0]-r[2]]),t}getState(){const e=this.getProjection(),t=this.getResolution(),r=this.getRotation();let i=this.getCenterInternal();const s=this.padding_;if(s){const a=this.getViewportSizeMinusPadding_();i=B2(i,this.getViewportSize_(),[a[0]/2+s[3],a[1]/2+s[0]],t,r)}return{center:i.slice(0),projection:e!==void 0?e:null,resolution:t,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:r,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let e;const t=this.getResolution();return t!==void 0&&(e=this.getZoomForResolution(t)),e}getZoomForResolution(e){let t=this.minZoom_||0,r,i;if(this.resolutions_){const s=Cv(this.resolutions_,e,1);t=s,r=this.resolutions_[s],s==this.resolutions_.length-1?i=2:i=r/this.resolutions_[s+1]}else r=this.maxResolution_,i=this.zoomFactor_;return t+Math.log(r/e)/Math.log(i)}getResolutionForZoom(e){if(this.resolutions_?.length){if(this.resolutions_.length===1)return this.resolutions_[0];const t=ar(Math.floor(e),0,this.resolutions_.length-2),r=this.resolutions_[t]/this.resolutions_[t+1];return this.resolutions_[t]/Math.pow(r,ar(e-t,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,e-this.minZoom_)}fit(e,t){let r;if(Dn(Array.isArray(e)||typeof e.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(e)){Dn(!L0(e),"Cannot fit empty extent provided as `geometry`");const i=Do(e,this.getProjection());r=i4(i)}else if(e.getType()==="Circle"){const i=Do(e.getExtent(),this.getProjection());r=i4(i),r.rotate(this.getRotation(),Yo(i))}else r=e;this.fitInternal(r,t)}rotatedExtentForGeometry(e){const t=this.getRotation(),r=Math.cos(t),i=Math.sin(-t),s=e.getFlatCoordinates(),a=e.getStride();let o=1/0,l=1/0,u=-1/0,h=-1/0;for(let f=0,g=s.length;f<g;f+=a){const y=s[f]*r-s[f+1]*i,v=s[f]*i+s[f+1]*r;o=Math.min(o,y),l=Math.min(l,v),u=Math.max(u,y),h=Math.max(h,v)}return[o,l,u,h]}fitInternal(e,t){t=t||{};let r=t.size;r||(r=this.getViewportSizeMinusPadding_());const i=t.padding!==void 0?t.padding:[0,0,0,0],s=t.nearest!==void 0?t.nearest:!1;let a;t.minResolution!==void 0?a=t.minResolution:t.maxZoom!==void 0?a=this.getResolutionForZoom(t.maxZoom):a=0;const o=this.rotatedExtentForGeometry(e);let l=this.getResolutionForExtentInternal(o,[r[0]-i[1]-i[3],r[1]-i[0]-i[2]]);l=isNaN(l)?a:Math.max(l,a),l=this.getConstrainedResolution(l,s?0:1);const u=this.getRotation(),h=Math.sin(u),f=Math.cos(u),g=Yo(o);g[0]+=(i[1]-i[3])/2*l,g[1]+=(i[0]-i[2])/2*l;const y=g[0]*f-g[1]*h,v=g[1]*f+g[0]*h,x=this.getConstrainedCenter([y,v],l),E=t.callback?t.callback:Hm;t.duration!==void 0?this.animateInternal({resolution:l,center:x,duration:t.duration,easing:t.easing},E):(this.targetResolution_=l,this.targetCenter_=x,this.applyTargetState_(!1,!0),Ky(E,!0))}centerOn(e,t,r){this.centerOnInternal(wl(e,this.getProjection()),t,r)}centerOnInternal(e,t,r){this.setCenterInternal(B2(e,t,r,this.getResolution(),this.getRotation()))}calculateCenterShift(e,t,r,i){let s;const a=this.padding_;if(a&&e){const o=this.getViewportSizeMinusPadding_(-r),l=B2(e,i,[o[0]/2+a[3],o[1]/2+a[0]],t,r);s=[e[0]-l[0],e[1]-l[1]]}return s}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(e){const t=iT(this.targetCenter_,this.getProjection());this.setCenter([t[0]+e[0],t[1]+e[1]])}adjustCenterInternal(e){const t=this.targetCenter_;this.setCenterInternal([t[0]+e[0],t[1]+e[1]])}adjustResolution(e,t){t=t&&wl(t,this.getProjection()),this.adjustResolutionInternal(e,t)}adjustResolutionInternal(e,t){const r=this.getAnimating()||this.getInteracting(),i=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*e,0,i,r);t&&(this.targetCenter_=this.calculateCenterZoom(s,t)),this.targetResolution_*=e,this.applyTargetState_()}adjustZoom(e,t){this.adjustResolution(Math.pow(this.zoomFactor_,-e),t)}adjustRotation(e,t){t&&(t=wl(t,this.getProjection())),this.adjustRotationInternal(e,t)}adjustRotationInternal(e,t){const r=this.getAnimating()||this.getInteracting(),i=this.constraints_.rotation(this.targetRotation_+e,r);t&&(this.targetCenter_=this.calculateCenterRotate(i,t)),this.targetRotation_+=e,this.applyTargetState_()}setCenter(e){this.setCenterInternal(e&&wl(e,this.getProjection()))}setCenterInternal(e){this.targetCenter_=e,this.applyTargetState_()}setHint(e,t){return this.hints_[e]+=t,this.changed(),this.hints_[e]}setResolution(e){this.targetResolution_=e,this.applyTargetState_()}setRotation(e){this.targetRotation_=e,this.applyTargetState_()}setZoom(e){this.setResolution(this.getResolutionForZoom(e))}applyTargetState_(e,t){const r=this.getAnimating()||this.getInteracting()||t,i=this.constraints_.rotation(this.targetRotation_,r),s=this.getViewportSize_(i),a=this.constraints_.resolution(this.targetResolution_,0,s,r),o=this.constraints_.center(this.targetCenter_,a,s,r,this.calculateCenterShift(this.targetCenter_,a,i,s));this.get(Ba.ROTATION)!==i&&this.set(Ba.ROTATION,i),this.get(Ba.RESOLUTION)!==a&&(this.set(Ba.RESOLUTION,a),this.set("zoom",this.getZoom(),!0)),(!o||!this.get(Ba.CENTER)||!tx(this.get(Ba.CENTER),o))&&this.set(Ba.CENTER,o),this.getAnimating()&&!e&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(e,t,r){e=e!==void 0?e:200;const i=t||0,s=this.constraints_.rotation(this.targetRotation_),a=this.getViewportSize_(s),o=this.constraints_.resolution(this.targetResolution_,i,a),l=this.constraints_.center(this.targetCenter_,o,a,!1,this.calculateCenterShift(this.targetCenter_,o,s,a));if(e===0&&!this.cancelAnchor_){this.targetResolution_=o,this.targetRotation_=s,this.targetCenter_=l,this.applyTargetState_();return}r=r||(e===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==o||this.getRotation()!==s||!this.getCenterInternal()||!tx(this.getCenterInternal(),l))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:l,resolution:o,duration:e,easing:D0,anchor:r}))}beginInteraction(){this.resolveConstraints(0),this.setHint(di.INTERACTING,1)}endInteraction(e,t,r){r=r&&wl(r,this.getProjection()),this.endInteractionInternal(e,t,r)}endInteractionInternal(e,t,r){this.getInteracting()&&(this.setHint(di.INTERACTING,-1),this.resolveConstraints(e,t,r))}getConstrainedCenter(e,t){const r=this.getViewportSize_(this.getRotation());return this.constraints_.center(e,t||this.getResolution(),r)}getConstrainedZoom(e,t){const r=this.getResolutionForZoom(e);return this.getZoomForResolution(this.getConstrainedResolution(r,t))}getConstrainedResolution(e,t){t=t||0;const r=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(e,t,r)}}function Ky(n,e){setTimeout(function(){n(e)},0)}function iW(n){if(n.extent!==void 0){const t=n.smoothExtentConstraint!==void 0?n.smoothExtentConstraint:!0;return T4(n.extent,n.constrainOnlyCenter,t)}const e=eI(n.projection,"EPSG:3857");if(n.multiWorld!==!0&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,T4(t,!1,!1)}return q$}function sW(n){let e,t,r,a=n.minZoom!==void 0?n.minZoom:G2,o=n.maxZoom!==void 0?n.maxZoom:28;const l=n.zoomFactor!==void 0?n.zoomFactor:2,u=n.multiWorld!==void 0?n.multiWorld:!1,h=n.smoothResolutionConstraint!==void 0?n.smoothResolutionConstraint:!0,f=n.showFullExtent!==void 0?n.showFullExtent:!1,g=eI(n.projection,"EPSG:3857"),y=g.getExtent();let v=n.constrainOnlyCenter,x=n.extent;if(!u&&!x&&g.isGlobal()&&(v=!1,x=y),n.resolutions!==void 0){const E=n.resolutions;t=E[a],r=E[o]!==void 0?E[o]:E[E.length-1],n.constrainResolution?e=J$(E,h,!v&&x,f):e=b4(t,r,h,!v&&x,f)}else{const T=(y?Math.max(un(y),Wr(y)):360*c0.degrees/g.getMetersPerUnit())/TI/Math.pow(2,G2),b=T/Math.pow(2,28-G2);t=n.maxResolution,t!==void 0?a=0:t=T/Math.pow(l,a),r=n.minResolution,r===void 0&&(n.maxZoom!==void 0?n.maxResolution!==void 0?r=t/Math.pow(l,o):r=T/Math.pow(l,o):r=b),o=a+Math.floor(Math.log(t/r)/Math.log(l)),r=t/Math.pow(l,o-a),n.constrainResolution?e=eW(l,t,r,h,!v&&x,f):e=b4(t,r,h,!v&&x,f)}return{constraint:e,maxResolution:t,minResolution:r,minZoom:a,zoomFactor:l}}function aW(n){if(n.enableRotation!==void 0?n.enableRotation:!0){const t=n.constrainRotation;return t===void 0||t===!0?nW():t===!1?I4:typeof t=="number"?tW(t):I4}return SI}function oW(n){return!(n.sourceCenter&&n.targetCenter&&!tx(n.sourceCenter,n.targetCenter)||n.sourceResolution!==n.targetResolution||n.sourceRotation!==n.targetRotation)}function B2(n,e,t,r,i){const s=Math.cos(-i);let a=Math.sin(-i),o=n[0]*s-n[1]*a,l=n[1]*s+n[0]*a;o+=(e[0]/2-t[0])*r,l+=(t[1]-e[1]/2)*r,a=-a;const u=o*s-l*a,h=l*s+o*a;return[u,h]}const Gn={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class Q5 extends nl{constructor(e){super(),this.on,this.once,this.un,this.background_=e.background;const t=Object.assign({},e);typeof e.properties=="object"&&(delete t.properties,Object.assign(t,e.properties)),t[Gn.OPACITY]=e.opacity!==void 0?e.opacity:1,Dn(typeof t[Gn.OPACITY]=="number","Layer opacity must be a number"),t[Gn.VISIBLE]=e.visible!==void 0?e.visible:!0,t[Gn.Z_INDEX]=e.zIndex,t[Gn.MAX_RESOLUTION]=e.maxResolution!==void 0?e.maxResolution:1/0,t[Gn.MIN_RESOLUTION]=e.minResolution!==void 0?e.minResolution:0,t[Gn.MIN_ZOOM]=e.minZoom!==void 0?e.minZoom:-1/0,t[Gn.MAX_ZOOM]=e.maxZoom!==void 0?e.maxZoom:1/0,this.className_=t.className!==void 0?t.className:"ol-layer",delete t.className,this.setProperties(t),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(e){const t=this.state_||{layer:this,managed:e===void 0?!0:e},r=this.getZIndex();return t.opacity=ar(Math.round(this.getOpacity()*100)/100,0,1),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=r===void 0&&!t.managed?1/0:r,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),t.minZoom=this.getMinZoom(),t.maxZoom=this.getMaxZoom(),this.state_=t,t}getLayersArray(e){return Vt()}getLayerStatesArray(e){return Vt()}getExtent(){return this.get(Gn.EXTENT)}getMaxResolution(){return this.get(Gn.MAX_RESOLUTION)}getMinResolution(){return this.get(Gn.MIN_RESOLUTION)}getMinZoom(){return this.get(Gn.MIN_ZOOM)}getMaxZoom(){return this.get(Gn.MAX_ZOOM)}getOpacity(){return this.get(Gn.OPACITY)}getSourceState(){return Vt()}getVisible(){return this.get(Gn.VISIBLE)}getZIndex(){return this.get(Gn.Z_INDEX)}setBackground(e){this.background_=e,this.changed()}setExtent(e){this.set(Gn.EXTENT,e)}setMaxResolution(e){this.set(Gn.MAX_RESOLUTION,e)}setMinResolution(e){this.set(Gn.MIN_RESOLUTION,e)}setMaxZoom(e){this.set(Gn.MAX_ZOOM,e)}setMinZoom(e){this.set(Gn.MIN_ZOOM,e)}setOpacity(e){Dn(typeof e=="number","Layer opacity must be a number"),this.set(Gn.OPACITY,e)}setVisible(e){this.set(Gn.VISIBLE,e)}setZIndex(e){this.set(Gn.Z_INDEX,e)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}class Qp extends Q5{constructor(e){const t=Object.assign({},e);delete t.source,super(t),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,e.render&&(this.render=e.render),e.map&&this.setMap(e.map),this.addChangeListener(Gn.SOURCE,this.handleSourcePropertyChange_);const r=e.source?e.source:null;this.setSource(r)}getLayersArray(e){return e=e||[],e.push(this),e}getLayerStatesArray(e){return e=e||[],e.push(this.getLayerState()),e}getSource(){return this.get(Gn.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const e=this.getSource();return e?e.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(nr(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const e=this.getSource();e&&(this.sourceChangeKey_=yn(e,Yt.CHANGE,this.handleSourceChange_,this),e.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(e){return this.renderer_?this.renderer_.getFeatures(e):Promise.resolve([])}getData(e){return!this.renderer_||!this.rendered?null:this.renderer_.getData(e)}isVisible(e){let t;const r=this.getMapInternal();!e&&r&&(e=r.getView()),e instanceof Oo?t={viewState:e.getState(),extent:e.calculateExtent()}:t=e,!t.layerStatesArray&&r&&(t.layerStatesArray=r.getLayerGroup().getLayerStatesArray());let i;if(t.layerStatesArray){if(i=t.layerStatesArray.find(a=>a.layer===this),!i)return!1}else i=this.getLayerState();const s=this.getExtent();return bI(i,t.viewState)&&(!s||os(s,t.extent))}getAttributions(e){if(!this.isVisible(e))return[];const t=this.getSource()?.getAttributions();if(!t)return[];const r=e instanceof Oo?e.getViewStateAndExtent():e;let i=t(r);return Array.isArray(i)||(i=[i]),i}render(e,t){const r=this.getRenderer();return r.prepareFrame(e)?(this.rendered=!0,r.renderFrame(e,t)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(e,t){}renderDeferred(e){const t=this.getRenderer();t&&t.renderDeferred(e)}setMapInternal(e){e||this.unrender(),this.set(Gn.MAP,e)}getMapInternal(){return this.get(Gn.MAP)}setMap(e){this.mapPrecomposeKey_&&(nr(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(nr(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=yn(e,Ea.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=yn(this,Yt.CHANGE,e.render,e),this.changed())}handlePrecompose_(e){const t=e.frameState.layerStatesArray,r=this.getLayerState(!1);Dn(!t.some(i=>i.layer===r.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),t.push(r)}setSource(e){this.set(Gn.SOURCE,e)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}}function bI(n,e){if(!n.visible)return!1;const t=e.resolution;if(t<n.minResolution||t>=n.maxResolution)return!1;const r=e.zoom;return r>n.minZoom&&r<=n.maxZoom}const A4={RENDER_ORDER:"renderOrder"};class J5 extends Qp{constructor(e){e=e||{};const t=Object.assign({},e);delete t.style,delete t.renderBuffer,delete t.updateWhileAnimating,delete t.updateWhileInteracting,super(t),this.declutter_=e.declutter?String(e.declutter):void 0,this.renderBuffer_=e.renderBuffer!==void 0?e.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(e.style),this.updateWhileAnimating_=e.updateWhileAnimating!==void 0?e.updateWhileAnimating:!1,this.updateWhileInteracting_=e.updateWhileInteracting!==void 0?e.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(e){return super.getFeatures(e)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(A4.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(e,t){const r=this.getDeclutter();r in e.declutter||(e.declutter[r]=new j5(9)),this.getRenderer().renderDeclutter(e,t)}setRenderOrder(e){this.set(A4.RENDER_ORDER,e)}setStyle(e){this.style_=e===void 0?V5:e;const t=lW(e);this.styleFunction_=e===null?void 0:$z(t),this.changed()}setDeclutter(e){this.declutter_=e?String(e):void 0,this.changed()}}function lW(n){if(n===void 0)return V5;if(!n)return null;if(typeof n=="function"||n instanceof $n)return n;if(!Array.isArray(n))return v4([n]);if(n.length===0)return[];const e=n.length,t=n[0];if(t instanceof $n){const i=new Array(e);for(let s=0;s<e;++s){const a=n[s];if(!(a instanceof $n))throw new Error("Expected a list of style instances");i[s]=a}return i}if("style"in t){const i=new Array(e);for(let s=0;s<e;++s){const a=n[s];if(!("style"in a))throw new Error("Expected a list of rules with a style property");i[s]=a}return F$(i)}return v4(n)}class F0 extends J5{constructor(e){super(e)}createRenderer(){return new h$(this)}}const Ic={ADDLAYER:"addlayer",REMOVELAYER:"removelayer"};class Dc extends tl{constructor(e,t){super(e),this.layer=t}}const U2={LAYERS:"layers"};let Wv=class eD extends Q5{constructor(e){e=e||{};const t=Object.assign({},e);delete t.layers;let r=e.layers;super(t),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(U2.LAYERS,this.handleLayersChanged_),r?Array.isArray(r)?r=new wa(r.slice(),{unique:!0}):Dn(typeof r.getArray=="function","Expected `layers` to be an array or a `Collection`"):r=new wa(void 0,{unique:!0}),this.setLayers(r)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(nr),this.layersListenerKeys_.length=0;const e=this.getLayers();this.layersListenerKeys_.push(yn(e,ws.ADD,this.handleLayersAdd_,this),yn(e,ws.REMOVE,this.handleLayersRemove_,this));for(const r in this.listenerKeys_)this.listenerKeys_[r].forEach(nr);Gp(this.listenerKeys_);const t=e.getArray();for(let r=0,i=t.length;r<i;r++){const s=t[r];this.registerLayerListeners_(s),this.dispatchEvent(new Dc(Ic.ADDLAYER,s))}this.changed()}registerLayerListeners_(e){const t=[yn(e,o0.PROPERTYCHANGE,this.handleLayerChange_,this),yn(e,Yt.CHANGE,this.handleLayerChange_,this)];e instanceof eD&&t.push(yn(e,Ic.ADDLAYER,this.handleLayerGroupAdd_,this),yn(e,Ic.REMOVELAYER,this.handleLayerGroupRemove_,this)),this.listenerKeys_[bn(e)]=t}handleLayerGroupAdd_(e){this.dispatchEvent(new Dc(Ic.ADDLAYER,e.layer))}handleLayerGroupRemove_(e){this.dispatchEvent(new Dc(Ic.REMOVELAYER,e.layer))}handleLayersAdd_(e){const t=e.element;this.registerLayerListeners_(t),this.dispatchEvent(new Dc(Ic.ADDLAYER,t)),this.changed()}handleLayersRemove_(e){const t=e.element,r=bn(t);this.listenerKeys_[r].forEach(nr),delete this.listenerKeys_[r],this.dispatchEvent(new Dc(Ic.REMOVELAYER,t)),this.changed()}getLayers(){return this.get(U2.LAYERS)}setLayers(e){const t=this.getLayers();if(t){const r=t.getArray();for(let i=0,s=r.length;i<s;++i)this.dispatchEvent(new Dc(Ic.REMOVELAYER,r[i]))}this.set(U2.LAYERS,e)}getLayersArray(e){return e=e!==void 0?e:[],this.getLayers().forEach(function(t){t.getLayersArray(e)}),e}getLayerStatesArray(e){const t=e!==void 0?e:[],r=t.length;this.getLayers().forEach(function(a){a.getLayerStatesArray(t)});const i=this.getLayerState();let s=i.zIndex;!e&&i.zIndex===void 0&&(s=0);for(let a=r,o=t.length;a<o;a++){const l=t[a];l.opacity*=i.opacity,l.visible=l.visible&&i.visible,l.maxResolution=Math.min(l.maxResolution,i.maxResolution),l.minResolution=Math.max(l.minResolution,i.minResolution),l.minZoom=Math.max(l.minZoom,i.minZoom),l.maxZoom=Math.min(l.maxZoom,i.maxZoom),i.extent!==void 0&&(l.extent!==void 0?l.extent=kl(l.extent,i.extent):l.extent=i.extent),l.zIndex===void 0&&(l.zIndex=s)}return t}getSourceState(){return"ready"}};const Lt={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};class II extends Bp{constructor(e,t,r){super(),r=r||{},this.tileCoord=e,this.state=t,this.key="",this.transition_=r.transition===void 0?250:r.transition,this.transitionStarts_={},this.interpolate=!!r.interpolate}changed(){this.dispatchEvent(Yt.CHANGE)}release(){this.setState(Lt.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(e){if(this.state!==Lt.EMPTY){if(this.state!==Lt.ERROR&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()}}load(){Vt()}getAlpha(e,t){if(!this.transition_)return 1;let r=this.transitionStarts_[e];if(!r)r=t,this.transitionStarts_[e]=r;else if(r===-1)return 1;const i=t-r+1e3/60;return i>=this.transition_?1:Z5(i/this.transition_)}inTransition(e){return this.transition_?this.transitionStarts_[e]!==-1:!1}endTransition(e){this.transition_&&(this.transitionStarts_[e]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}function gT(n){return n instanceof Image||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageBitmap?n:null}const cW=new Error("disposed"),uW=[256,256];class R4 extends II{constructor(e){const t=Lt.IDLE;super(e.tileCoord,t,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null,this.controller_=e.controller||null}getSize(){if(this.size_)return this.size_;const e=gT(this.data_);return e?[e.width,e.height]:uW}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==Lt.IDLE&&this.state!==Lt.ERROR)return;this.state=Lt.LOADING,this.changed();const e=this;this.loader_().then(function(t){e.data_=t,e.state=Lt.LOADED,e.changed()}).catch(function(t){e.error_=t,e.state=Lt.ERROR,e.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(cW),this.controller_=null),super.disposeInternal()}}class tD extends II{constructor(e,t,r,i,s,a){super(e,t,a),this.crossOrigin_=i,this.src_=r,this.key=r,this.image_,Zs?this.image_=new OffscreenCanvas(1,1):(this.image_=new Image,i!==null&&(this.image_.crossOrigin=i)),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(e){this.image_=e,this.state=Lt.LOADED,this.unlistenImage_(),this.changed()}getCrossOrigin(){return this.crossOrigin_}handleImageError_(){this.state=Lt.ERROR,this.unlistenImage_(),this.image_=hW(),this.changed()}handleImageLoad_(){if(Zs)this.state=Lt.LOADED;else{const e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=Lt.LOADED:this.state=Lt.EMPTY}this.unlistenImage_(),this.changed()}load(){this.state==Lt.ERROR&&(this.state=Lt.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==Lt.IDLE&&(this.state=Lt.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=oz(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function hW(){const n=ri(1,1);return n.fillStyle="rgba(0,0,0,0)",n.fillRect(0,0,1,1),n.canvas}let z2;const Wf=[];function C4(n,e,t,r,i){n.beginPath(),n.moveTo(0,0),n.lineTo(e,t),n.lineTo(r,i),n.closePath(),n.save(),n.clip(),n.fillRect(0,0,Math.max(e,r)+1,Math.max(t,i)),n.restore()}function $2(n,e){return Math.abs(n[e*4]-210)>2||Math.abs(n[e*4+3]-.75*255)>2}function dW(){if(z2===void 0){const n=ri(6,6,Wf);n.globalCompositeOperation="lighter",n.fillStyle="rgba(210, 0, 0, 0.75)",C4(n,4,5,4,0),C4(n,4,5,0,5);const e=n.getImageData(0,0,3,3).data;z2=$2(e,0)||$2(e,4)||$2(e,8),Gv(n),Wf.push(n.canvas)}return z2}function gx(n,e,t,r){const i=Hp(t,e,n);let s=sx(e,r,t);const a=e.getMetersPerUnit();a!==void 0&&(s*=a);const o=n.getMetersPerUnit();o!==void 0&&(s/=o);const l=n.getExtent();if(!l||Oh(l,i)){const u=sx(n,s,i)/s;isFinite(u)&&u>0&&(s/=u)}return s}function fW(n,e,t,r){const i=Yo(t);let s=gx(n,e,i,r);return(!isFinite(s)||s<=0)&&HO(t,function(a){return s=gx(n,e,a,r),isFinite(s)&&s>0}),s}function nD(n,e,t,r,i,s,a,o,l,u,h,f,g,y){const v=ri(Math.round(t*n),Math.round(t*e),Wf);if(f||(v.imageSmoothingEnabled=!1),l.length===0)return v.canvas;v.scale(t,t);function x(F){return Math.round(F*t)/t}v.globalCompositeOperation="lighter";const E=ea();l.forEach(function(F,z,P){$O(E,F.extent)});let T;const b=t/r,I=(f?1:1+Math.pow(2,-24))/b;(!g||l.length!==1||u!==0)&&(T=ri(Math.round(un(E)*b),Math.round(Wr(E)*b),Wf),f||(T.imageSmoothingEnabled=!1),l.forEach(function(F,z,P){if(F.image.width>0&&F.image.height>0){if(F.clipExtent){T.save();const U=(F.clipExtent[0]-E[0])*b,j=-(F.clipExtent[3]-E[3])*b,Te=un(F.clipExtent)*b,Ce=Wr(F.clipExtent)*b;T.rect(f?U:Math.round(U),f?j:Math.round(j),f?Te:Math.round(U+Te)-Math.round(U),f?Ce:Math.round(j+Ce)-Math.round(j)),T.clip()}const C=(F.extent[0]-E[0])*b,k=-(F.extent[3]-E[3])*b,L=un(F.extent)*b,O=Wr(F.extent)*b;T.drawImage(F.image,u,u,F.image.width-2*u,F.image.height-2*u,f?C:Math.round(C),f?k:Math.round(k),f?L:Math.round(C+L)-Math.round(C),f?O:Math.round(k+O)-Math.round(k)),F.clipExtent&&T.restore()}}));const M=ad(a);return o.getTriangles().forEach(function(F,z,P){const C=F.source,k=F.target;let L=C[0][0],O=C[0][1],U=C[1][0],j=C[1][1],Te=C[2][0],Ce=C[2][1];const Ue=x((k[0][0]-M[0])/s),Ne=x(-(k[0][1]-M[1])/s),le=x((k[1][0]-M[0])/s),ue=x(-(k[1][1]-M[1])/s),Se=x((k[2][0]-M[0])/s),se=x(-(k[2][1]-M[1])/s),V=L,J=O;L=0,O=0,U-=V,j-=J,Te-=V,Ce-=J;const re=[[U,j,0,0,le-Ue],[Te,Ce,0,0,Se-Ue],[0,0,U,j,ue-Ne],[0,0,Te,Ce,se-Ne]],q=ZB(re);if(!q)return;if(v.save(),v.beginPath(),dW()||!f){v.moveTo(le,ue);const Me=4,je=Ue-le,De=Ne-ue;for(let Be=0;Be<Me;Be++)v.lineTo(le+x((Be+1)*je/Me),ue+x(Be*De/(Me-1))),Be!=Me-1&&v.lineTo(le+x((Be+1)*je/Me),ue+x((Be+1)*De/(Me-1)));v.lineTo(Se,se)}else v.moveTo(le,ue),v.lineTo(Ue,Ne),v.lineTo(Se,se);v.clip(),v.transform(q[0],q[2],q[1],q[3],Ue,Ne),v.translate(E[0]-V,E[3]-J);let he;if(T)he=T.canvas,v.scale(I,-I);else{const Me=l[0],je=Me.extent;he=Me.image,v.scale(un(je)/he.width,-Wr(je)/he.height)}v.drawImage(he,0,0),v.restore()}),T&&(Gv(T),Wf.push(T.canvas)),h&&(v.save(),v.globalCompositeOperation="source-over",v.strokeStyle="black",v.lineWidth=1,o.getTriangles().forEach(function(F,z,P){const C=F.target,k=(C[0][0]-M[0])/s,L=-(C[0][1]-M[1])/s,O=(C[1][0]-M[0])/s,U=-(C[1][1]-M[1])/s,j=(C[2][0]-M[0])/s,Te=-(C[2][1]-M[1])/s;v.beginPath(),v.moveTo(O,U),v.lineTo(k,L),v.lineTo(j,Te),v.closePath(),v.stroke()}),v.restore()),v.canvas}const gW=10,k4=.25;class rD{constructor(e,t,r,i,s,a,o){this.sourceProj_=e,this.targetProj_=t;let l={};const u=o?rT(I=>ni(o,Hp(I,this.targetProj_,this.sourceProj_))):Ym(this.targetProj_,this.sourceProj_);this.transformInv_=function(I){const M=I[0]+"/"+I[1];return l[M]||(l[M]=u(I)),l[M]},this.maxSourceExtent_=i,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!i&&!!this.sourceProj_.getExtent()&&un(i)>=un(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?un(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?un(this.targetProj_.getExtent()):null;const h=ad(r),f=Nv(r),g=Mv(r),y=Pv(r),v=this.transformInv_(h),x=this.transformInv_(f),E=this.transformInv_(g),T=this.transformInv_(y),b=gW+(a?Math.max(0,Math.ceil(Math.log2(QS(r)/(a*a*256*256)))):0);if(this.addQuad_(h,f,g,y,v,x,E,T,b),this.wrapsXInSource_){let I=1/0;this.triangles_.forEach(function(M,F,z){I=Math.min(I,M.source[0][0],M.source[1][0],M.source[2][0])}),this.triangles_.forEach(M=>{if(Math.max(M.source[0][0],M.source[1][0],M.source[2][0])-I>this.sourceWorldWidth_/2){const F=[[M.source[0][0],M.source[0][1]],[M.source[1][0],M.source[1][1]],[M.source[2][0],M.source[2][1]]];F[0][0]-I>this.sourceWorldWidth_/2&&(F[0][0]-=this.sourceWorldWidth_),F[1][0]-I>this.sourceWorldWidth_/2&&(F[1][0]-=this.sourceWorldWidth_),F[2][0]-I>this.sourceWorldWidth_/2&&(F[2][0]-=this.sourceWorldWidth_);const z=Math.min(F[0][0],F[1][0],F[2][0]);Math.max(F[0][0],F[1][0],F[2][0])-z<this.sourceWorldWidth_/2&&(M.source=F)}})}l={}}addTriangle_(e,t,r,i,s,a){this.triangles_.push({source:[i,s,a],target:[e,t,r]})}addQuad_(e,t,r,i,s,a,o,l,u){const h=OP([s,a,o,l]),f=this.sourceWorldWidth_?un(h)/this.sourceWorldWidth_:null,g=this.sourceWorldWidth_,y=this.sourceProj_.canWrapX()&&f>.5&&f<1;let v=!1;if(u>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const E=OP([e,t,r,i]);v=un(E)/this.targetWorldWidth_>k4||v}!y&&this.sourceProj_.isGlobal()&&f&&(v=f>k4||v)}if(!v&&this.maxSourceExtent_&&isFinite(h[0])&&isFinite(h[1])&&isFinite(h[2])&&isFinite(h[3])&&!os(h,this.maxSourceExtent_))return;let x=0;if(!v&&(!isFinite(s[0])||!isFinite(s[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(l[0])||!isFinite(l[1]))){if(u>0)v=!0;else if(x=(!isFinite(s[0])||!isFinite(s[1])?8:0)+(!isFinite(a[0])||!isFinite(a[1])?4:0)+(!isFinite(o[0])||!isFinite(o[1])?2:0)+(!isFinite(l[0])||!isFinite(l[1])?1:0),x!=1&&x!=2&&x!=4&&x!=8)return}if(u>0){if(!v){const E=[(e[0]+r[0])/2,(e[1]+r[1])/2],T=this.transformInv_(E);let b;y?b=(Jc(s[0],g)+Jc(o[0],g))/2-Jc(T[0],g):b=(s[0]+o[0])/2-T[0];const I=(s[1]+o[1])/2-T[1];v=b*b+I*I>this.errorThresholdSquared_}if(v){if(Math.abs(e[0]-r[0])<=Math.abs(e[1]-r[1])){const E=[(t[0]+r[0])/2,(t[1]+r[1])/2],T=this.transformInv_(E),b=[(i[0]+e[0])/2,(i[1]+e[1])/2],I=this.transformInv_(b);this.addQuad_(e,t,E,b,s,a,T,I,u-1),this.addQuad_(b,E,r,i,I,T,o,l,u-1)}else{const E=[(e[0]+t[0])/2,(e[1]+t[1])/2],T=this.transformInv_(E),b=[(r[0]+i[0])/2,(r[1]+i[1])/2],I=this.transformInv_(b);this.addQuad_(e,E,b,i,s,T,I,l,u-1),this.addQuad_(E,t,r,b,T,a,o,I,u-1)}return}}if(y){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(x&11)==0&&this.addTriangle_(e,r,i,s,o,l),(x&14)==0&&this.addTriangle_(e,r,t,s,o,a),x&&((x&13)==0&&this.addTriangle_(t,i,e,a,l,s),(x&7)==0&&this.addTriangle_(t,i,r,a,l,o))}calculateSourceExtent(){const e=ea();return this.triangles_.forEach(function(t,r,i){const s=t.source;gm(e,s[0]),gm(e,s[1]),gm(e,s[2])}),e}getTriangles(){return this.triangles_}}const iD=.5;class sD extends II{constructor(e,t,r,i,s,a,o,l,u,h,f,g){super(s,Lt.IDLE,g),this.renderEdges_=f!==void 0?f:!1,this.pixelRatio_=o,this.gutter_=l,this.canvas_=null,this.sourceTileGrid_=t,this.targetTileGrid_=i,this.wrappedTileCoord_=a||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=e.canWrapX()?e.getExtent():void 0;const y=i.getTileCoordExtent(this.wrappedTileCoord_),v=this.targetTileGrid_.getExtent();let x=this.sourceTileGrid_.getExtent();const E=v?kl(y,v):y;if(QS(E)===0){this.state=Lt.EMPTY;return}const T=e.getExtent();T&&(x?x=kl(x,T):x=T);const b=i.getResolution(this.wrappedTileCoord_[0]),I=fW(e,r,E,b);if(!isFinite(I)||I<=0){this.state=Lt.EMPTY;return}const M=h!==void 0?h:iD;if(this.triangulation_=new rD(e,r,E,x,I*M,b),this.triangulation_.getTriangles().length===0){this.state=Lt.EMPTY;return}this.sourceZ_=t.getZForResolution(I);let F=this.triangulation_.calculateSourceExtent();if(x&&(e.canWrapX()?(F[1]=ar(F[1],x[1],x[3]),F[3]=ar(F[3],x[1],x[3])):F=kl(F,x)),!QS(F))this.state=Lt.EMPTY;else{let z=0,P=0;e.canWrapX()&&(z=un(T),P=Math.floor((F[0]-T[0])/z)),XO(F.slice(),e,!0).forEach(k=>{const L=t.getTileRangeForExtentAndZ(k,this.sourceZ_);for(let O=L.minX;O<=L.maxX;O++)for(let U=L.minY;U<=L.maxY;U++){const j=u(this.sourceZ_,O,U,o);if(j){const Te=P*z;this.sourceTiles_.push({tile:j,offset:Te})}}++P}),this.sourceTiles_.length===0&&(this.state=Lt.EMPTY)}}getImage(){return this.canvas_}reproject_(){const e=[];if(this.sourceTiles_.forEach(t=>{const r=t.tile;if(r&&r.getState()==Lt.LOADED){const i=this.sourceTileGrid_.getTileCoordExtent(r.tileCoord);i[0]+=t.offset,i[2]+=t.offset;const s=this.clipExtent_?.slice();s&&(s[0]+=t.offset,s[2]+=t.offset),e.push({extent:i,clipExtent:s,image:r.getImage()})}}),this.sourceTiles_.length=0,e.length===0)this.state=Lt.ERROR;else{const t=this.wrappedTileCoord_[0],r=this.targetTileGrid_.getTileSize(t),i=typeof r=="number"?r:r[0],s=typeof r=="number"?r:r[1],a=this.targetTileGrid_.getResolution(t),o=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=nD(i,s,this.pixelRatio_,o,this.sourceTileGrid_.getExtent(),a,l,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=Lt.LOADED}this.changed()}load(){if(this.state==Lt.IDLE){this.state=Lt.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:t})=>{const r=t.getState();if(r==Lt.IDLE||r==Lt.LOADING){e++;const i=yn(t,Yt.CHANGE,s=>{const a=t.getState();(a==Lt.LOADED||a==Lt.ERROR||a==Lt.EMPTY)&&(nr(i),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(i)}}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:t},r,i){t.getState()==Lt.IDLE&&t.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(nr),this.sourcesListenerKeys_=null}release(){this.canvas_&&(Gv(this.canvas_.getContext("2d")),Wf.push(this.canvas_),this.canvas_=null),super.release()}}class AI{constructor(e,t,r,i){this.minX=e,this.maxX=t,this.minY=r,this.maxY=i}contains(e){return this.containsXY(e[1],e[2])}containsTileRange(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}containsXY(e,t){return this.minX<=e&&e<=this.maxX&&this.minY<=t&&t<=this.maxY}equals(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}extend(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}}function of(n,e,t,r,i){return i!==void 0?(i.minX=n,i.maxX=e,i.minY=t,i.maxY=r,i):new AI(n,e,t,r)}class P4{constructor(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const e=this.pop();e instanceof Rv&&e.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(e){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let t=this.oldest_;for(;t;)e(t.value_,t.key_,this),t=t.newer}get(e,t){const r=this.entries_[e];return Dn(r!==void 0,"Tried to get a value for a key that does not exist in the cache"),r===this.newest_||(r===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(r.newer.older=r.older,r.older.newer=r.newer),r.newer=null,r.older=this.newest_,this.newest_.newer=r,this.newest_=r),r.value_}remove(e){const t=this.entries_[e];return Dn(t!==void 0,"Tried to get a value for a key that does not exist in the cache"),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_}getCount(){return this.count_}getKeys(){const e=new Array(this.count_);let t=0,r;for(r=this.newest_;r;r=r.older)e[t++]=r.key_;return e}getValues(){const e=new Array(this.count_);let t=0,r;for(r=this.newest_;r;r=r.older)e[t++]=r.value_;return e}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){return this.entries_[e]?.value_}pop(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,t){this.get(e),this.entries_[e].value_=t}set(e,t){Dn(!(e in this.entries_),"Tried to set a value for a key that is used already");const r={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=r:this.oldest_=r,this.newest_=r,this.entries_[e]=r,++this.count_}setSize(e){this.highWaterMark=e}}function mx(n,e,t,r){return r!==void 0?(r[0]=n,r[1]=e,r[2]=t,r):[n,e,t]}function mW(n,e,t){return n+"/"+e+"/"+t}function I_(n,e,t,r,i){return`${bn(n)},${e},${mW(t,r,i)}`}function aD(n){return pW(n[0],n[1],n[2])}function pW(n,e,t){return(e<<n)+t}function yW(n,e){const t=n[0],r=n[1],i=n[2];if(e.getMinZoom()>t||t>e.getMaxZoom())return!1;const s=e.getFullTileRange(t);return s?s.containsXY(r,i):!0}class _W extends _I{constructor(e){super(e),this.image=null}getImage(){return this.image?this.image.getImage():null}prepareFrame(e){const t=e.layerStatesArray[e.layerIndex],r=e.pixelRatio,i=e.viewState,s=i.resolution,a=this.getLayer().getSource(),o=e.viewHints;let l=e.extent;if(t.extent!==void 0&&(l=kl(l,Do(t.extent,i.projection))),!o[di.ANIMATING]&&!o[di.INTERACTING]&&!L0(l))if(a){const u=i.projection,h=a.getImage(l,s,r,u);h&&(this.loadImage(h)?this.image=h:h.getState()===vt.EMPTY&&(this.image=null))}else this.image=null;return!!this.image}getData(e){const t=this.frameState;if(!t)return null;const r=this.getLayer(),i=ni(t.pixelToCoordinateTransform,e.slice()),s=r.getExtent();if(s&&!Oh(s,i))return null;const a=this.image.getExtent(),o=this.image.getImage(),l=un(a),u=Math.floor(o.width*((i[0]-a[0])/l));if(u<0||u>=o.width)return null;const h=Wr(a),f=Math.floor(o.height*((a[3]-i[1])/h));return f<0||f>=o.height?null:this.getImageData(o,u,f)}renderFrame(e,t){const r=this.image,i=r.getExtent(),s=r.getResolution(),[a,o]=Array.isArray(s)?s:[s,s],l=r.getPixelRatio(),u=e.layerStatesArray[e.layerIndex],h=e.pixelRatio,f=e.viewState,g=f.center,y=f.resolution,v=h*a/(y*l),x=h*o/(y*l);this.prepareContainer(e,t);const E=this.context.canvas.width,T=this.context.canvas.height,b=this.getRenderContext(e);let I=!1,M=!0;if(u.extent){const k=Do(u.extent,f.projection);M=os(k,e.extent),I=M&&!Uc(k,e.extent),I&&this.clipUnrotated(b,e,k)}const F=r.getImage(),z=Xo(this.tempTransform,E/2,T/2,v,x,0,l*(i[0]-g[0])/a,l*(g[1]-i[3])/o);this.renderedResolution=o*h/l;const P=F.width*z[0],C=F.height*z[3];if(this.getLayer().getSource().getInterpolate()||(b.imageSmoothingEnabled=!1),this.preRender(b,e),M&&P>=.5&&C>=.5){const k=z[4],L=z[5],O=u.opacity;O!==1&&(b.save(),b.globalAlpha=O),b.drawImage(F,0,0,+F.width,+F.height,k,L,P,C),O!==1&&b.restore()}return this.postRender(this.context,e),I&&b.restore(),b.imageSmoothingEnabled=!0,this.container}}class xW extends Qp{constructor(e){e=e||{},super(e)}}class vW extends xW{constructor(e){super(e)}createRenderer(){return new _W(this)}getData(e){return super.getData(e)}}function W2(n,e,t){if(!(t in n))return n[t]=new Set([e]),!0;const r=n[t],i=r.has(e);return i||r.add(e),!i}function wW(n,e,t){const r=n[t];return r?r.delete(e):!1}function M4(n,e){const t=n.layerStatesArray[n.layerIndex];t.extent&&(e=kl(e,Do(t.extent,n.viewState.projection)));const r=t.layer.getRenderSource();if(!r.getWrapX()){const i=r.getTileGridForProjection(n.viewState.projection).getExtent();i&&(e=kl(e,i))}return e}class EW extends _I{constructor(e,t){super(e),t=t||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=ea(),this.tempTileRange_=new AI(0,0,0,0),this.tempTileCoord_=mx(0,0,0);const r=t.cacheSize!==void 0?t.cacheSize:512;this.tileCache_=new P4(r),this.sourceTileCache_=null,this.maxStaleKeys=r*.5}getTileCache(){return this.tileCache_}getSourceTileCache(){return this.sourceTileCache_||(this.sourceTileCache_=new P4(512)),this.sourceTileCache_}getOrCreateTile(e,t,r,i){const s=this.tileCache_,o=this.getLayer().getSource(),l=I_(o,o.getKey(),e,t,r);let u;if(s.containsKey(l))u=s.get(l);else{const h=i.viewState.projection,f=o.getProjection();if(u=o.getTile(e,t,r,i.pixelRatio,h,!f||Ah(f,h)?void 0:this.getSourceTileCache()),!u)return null;s.set(l,u)}return u}getTile(e,t,r,i){const s=this.getOrCreateTile(e,t,r,i);return s||null}getData(e){const t=this.frameState;if(!t)return null;const r=this.getLayer(),i=ni(t.pixelToCoordinateTransform,e.slice()),s=r.getExtent();if(s&&!Oh(s,i))return null;const a=t.viewState,o=r.getRenderSource(),l=o.getTileGridForProjection(a.projection),u=o.getTilePixelRatio(t.pixelRatio);for(let h=l.getZForResolution(a.resolution);h>=l.getMinZoom();--h){const f=l.getTileCoordForCoordAndZ(i,h),g=this.getTile(h,f[1],f[2],t);if(!g||g.getState()!==Lt.LOADED)continue;const y=l.getOrigin(h),v=Is(l.getTileSize(h)),x=l.getResolution(h);let E;if(g instanceof tD||g instanceof sD)E=g.getImage();else if(g instanceof R4){if(E=gT(g.getData()),!E)continue}else continue;const T=Math.floor(u*((i[0]-y[0])/x-f[1]*v[0])),b=Math.floor(u*((y[1]-i[1])/x-f[2]*v[1])),I=Math.round(u*o.getGutterForProjection(a.projection));return this.getImageData(E,T+I,b+I)}return null}prepareFrame(e){this.renderedProjection?e.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=e.viewState.projection):this.renderedProjection=e.viewState.projection;const t=this.getLayer().getSource();if(!t)return!1;const r=t.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==r&&(this.renderedSourceRevision_=r,this.renderedSourceKey_===t.getKey()&&(this.tileCache_.clear(),this.sourceTileCache_?.clear())):this.renderedSourceRevision_=r,!0}enqueueTilesForNextExtent(){return!0}enqueueTiles(e,t,r,i,s){const a=e.viewState,o=this.getLayer(),l=o.getRenderSource(),u=l.getTileGridForProjection(a.projection),h=bn(l);h in e.wantedTiles||(e.wantedTiles[h]={});const f=e.wantedTiles[h],g=o.getMapInternal(),y=Math.max(r-s,u.getMinZoom(),u.getZForResolution(Math.min(o.getMaxResolution(),g?g.getView().getResolutionForZoom(Math.max(o.getMinZoom(),0)):u.getResolution(0)),l.zDirection)),v=a.rotation,x=v?KO(a.center,a.resolution,v,e.size):void 0;for(let E=r;E>=y;--E){const T=u.getTileRangeForExtentAndZ(t,E,this.tempTileRange_),b=u.getResolution(E);for(let I=T.minX;I<=T.maxX;++I)for(let M=T.minY;M<=T.maxY;++M){if(v&&!u.tileCoordIntersectsViewport([E,I,M],x))continue;const F=this.getTile(E,I,M,e);if(!F||!W2(i,F,E))continue;const P=F.getKey();if(f[P]=!0,F.getState()===Lt.IDLE&&!e.tileQueue.isKeyQueued(P)){const C=mx(E,I,M,this.tempTileCoord_);e.tileQueue.enqueue([F,h,u.getTileCoordCenter(C),b])}}}}findStaleTile_(e,t){const r=this.tileCache_,i=e[0],s=e[1],a=e[2],o=this.getStaleKeys();for(let l=0;l<o.length;++l){const u=I_(this.getLayer().getSource(),o[l],i,s,a);if(r.containsKey(u)){const h=r.peek(u);if(h.getState()===Lt.LOADED)return h.endTransition(bn(this)),W2(t,h,i),!0}}return!1}findAltTiles_(e,t,r,i){const s=e.getTileRangeForTileCoordAndZ(t,r,this.tempTileRange_);if(!s)return!1;let a=!0;const o=this.tileCache_,l=this.getLayer().getRenderSource(),u=l.getKey();for(let h=s.minX;h<=s.maxX;++h)for(let f=s.minY;f<=s.maxY;++f){const g=I_(l,u,r,h,f);let y=!1;if(o.containsKey(g)){const v=o.peek(g);v.getState()===Lt.LOADED&&(W2(i,v,r),y=!0)}y||(a=!1)}return a}renderFrame(e,t){this.renderComplete=!0;const r=e.layerStatesArray[e.layerIndex],i=e.viewState,s=i.projection,a=i.resolution,o=i.center,l=e.pixelRatio,u=this.getLayer(),h=u.getSource(),f=h.getTileGridForProjection(s),g=f.getZForResolution(a,h.zDirection),y=f.getResolution(g),v=h.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==v&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=v):this.renderedSourceKey_=v;let x=e.extent;const E=h.getTilePixelRatio(l);this.prepareContainer(e,t);const T=this.context.canvas.width,b=this.context.canvas.height,I=r.extent&&Do(r.extent);I&&(x=kl(x,Do(r.extent)));const M=y*T/2/E,F=y*b/2/E,z=[o[0]-M,o[1]-F,o[0]+M,o[1]+F],P={};this.renderedTiles.length=0;const C=u.getPreload();if(e.nextExtent&&this.enqueueTilesForNextExtent()){const le=f.getZForResolution(i.nextResolution,h.zDirection),ue=M4(e,e.nextExtent);this.enqueueTiles(e,ue,le,P,C)}const k=M4(e,x);if(this.enqueueTiles(e,k,g,P,0),C>0&&setTimeout(()=>{this.enqueueTiles(e,k,g-1,P,C-1)},0),!(g in P))return this.container;const L=bn(this),O=e.time;for(const le of P[g]){const ue=le.getState();if(ue===Lt.EMPTY)continue;const Se=le.tileCoord;if(ue===Lt.LOADED&&le.getAlpha(L,O)===1){le.endTransition(L);continue}if(ue!==Lt.ERROR&&(this.renderComplete=!1),this.findStaleTile_(Se,P)){wW(P,le,g),e.animate=!0;continue}if(this.findAltTiles_(f,Se,g+1,P))continue;const J=f.getMinZoom();for(let re=g-1;re>=J&&!this.findAltTiles_(f,Se,re,P);--re);}const U=y/a*l/E,j=this.getRenderContext(e);Xo(this.tempTransform,T/2,b/2,U,U,0,-T/2,-b/2),r.extent&&this.clipUnrotated(j,e,I),h.getInterpolate()||(j.imageSmoothingEnabled=!1),this.preRender(j,e);const Te=Object.keys(P).map(Number);Te.sort(Cl);let Ce;const Ue=[],Ne=[];for(let le=Te.length-1;le>=0;--le){const ue=Te[le],Se=h.getTilePixelSize(ue,l,s),V=f.getResolution(ue)/y,J=Se[0]*V*U,re=Se[1]*V*U,q=f.getTileCoordForCoordAndZ(ad(z),ue),he=f.getTileCoordExtent(q),Me=ni(this.tempTransform,[E*(he[0]-z[0])/y,E*(z[3]-he[3])/y]),je=E*h.getGutterForProjection(s);for(const De of P[ue]){if(De.getState()!==Lt.LOADED)continue;const Be=De.tileCoord,Gt=q[1]-Be[1],Kt=Math.round(Me[0]-(Gt-1)*J),wn=q[2]-Be[2],Bt=Math.round(Me[1]-(wn-1)*re),Fn=Math.round(Me[0]-Gt*J),Qt=Math.round(Me[1]-wn*re),ot=Kt-Fn,Zn=Bt-Qt,on=Te.length===1;let en=!1;Ce=[Fn,Qt,Fn+ot,Qt,Fn+ot,Qt+Zn,Fn,Qt+Zn];for(let Qn=0,mt=Ue.length;Qn<mt;++Qn)if(!on&&ue<Ne[Qn]){const jt=Ue[Qn];os([Fn,Qt,Fn+ot,Qt+Zn],[jt[0],jt[3],jt[4],jt[7]])&&(en||(j.save(),en=!0),j.beginPath(),j.moveTo(Ce[0],Ce[1]),j.lineTo(Ce[2],Ce[3]),j.lineTo(Ce[4],Ce[5]),j.lineTo(Ce[6],Ce[7]),j.moveTo(jt[6],jt[7]),j.lineTo(jt[4],jt[5]),j.lineTo(jt[2],jt[3]),j.lineTo(jt[0],jt[1]),j.clip())}Ue.push(Ce),Ne.push(ue),this.drawTile(De,e,Fn,Qt,ot,Zn,je,on),en&&j.restore(),this.renderedTiles.unshift(De),this.updateUsedTiles(e.usedTiles,h,De)}}if(this.renderedResolution=y,this.extentChanged=!this.renderedExtent_||!l0(this.renderedExtent_,z),this.renderedExtent_=z,this.renderedPixelRatio=l,this.postRender(this.context,e),r.extent&&j.restore(),j.imageSmoothingEnabled=!0,this.renderComplete){const le=(ue,Se)=>{const se=bn(h),V=Se.wantedTiles[se],J=V?Object.keys(V).length:0;this.updateCacheSize(J),this.tileCache_.expireCache(),this.sourceTileCache_?.expireCache()};e.postRenderFunctions.push(le)}return this.container}updateCacheSize(e){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,e*2)}drawTile(e,t,r,i,s,a,o,l){let u;if(e instanceof R4){if(u=gT(e.getData()),!u)throw new Error("Rendering array data is not yet supported")}else u=this.getTileImage(e);if(!u)return;const h=this.getRenderContext(t),f=bn(this),g=t.layerStatesArray[t.layerIndex],y=g.opacity*(l?e.getAlpha(f,t.time):1),v=y!==h.globalAlpha;v&&(h.save(),h.globalAlpha=y),h.drawImage(u,o,o,u.width-2*o,u.height-2*o,r,i,s,a),v&&h.restore(),y!==g.opacity?t.animate=!0:l&&e.endTransition(f)}getImage(){const e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}updateUsedTiles(e,t,r){const i=bn(t);i in e||(e[i]={}),e[i][r.getKey()]=!0}}const Yy={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class SW extends Qp{constructor(e){e=e||{};const t=Object.assign({},e),r=e.cacheSize;delete e.cacheSize,delete t.preload,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un,this.cacheSize_=r,this.setPreload(e.preload!==void 0?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(Yy.PRELOAD)}setPreload(e){this.set(Yy.PRELOAD,e)}getUseInterimTilesOnError(){return this.get(Yy.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(Yy.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}}class rh extends SW{constructor(e){super(e)}createRenderer(){return new EW(this,{cacheSize:this.getCacheSize()})}}function mT(n){return Array.isArray(n)?Math.min(...n):n}const lf=[0,0,0],Ac=5;class oD{constructor(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,Dn(UB(this.resolutions_,(i,s)=>s-i),"`resolutions` must be sorted in descending order");let t;if(!e.origins){for(let i=0,s=this.resolutions_.length-1;i<s;++i)if(!t)t=this.resolutions_[i]/this.resolutions_[i+1];else if(this.resolutions_[i]/this.resolutions_[i+1]!==t){t=void 0;break}}this.zoomFactor_=t,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,Dn(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const r=e.extent;r!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=ad(r)),Dn(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,Dn(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:TI,Dn(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=r!==void 0?r:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map((i,s)=>{const a=new AI(Math.min(0,i[0]),Math.max(i[0]-1,-1),Math.min(0,i[1]),Math.max(i[1]-1,-1));if(r){const o=this.getTileRangeForExtentAndZ(r,s);a.minX=Math.max(o.minX,a.minX),a.maxX=Math.min(o.maxX,a.maxX),a.minY=Math.max(o.minY,a.minY),a.maxY=Math.min(o.maxY,a.maxY)}return a}):r&&this.calculateTileRanges_(r)}forEachTileCoord(e,t,r){const i=this.getTileRangeForExtentAndZ(e,t);for(let s=i.minX,a=i.maxX;s<=a;++s)for(let o=i.minY,l=i.maxY;o<=l;++o)r([t,s,o])}forEachTileCoordParentTileRange(e,t,r,i){let s,a,o,l=null,u=e[0]-1;for(this.zoomFactor_===2?(a=e[1],o=e[2]):l=this.getTileCoordExtent(e,i);u>=this.minZoom;){if(a!==void 0&&o!==void 0?(a=Math.floor(a/2),o=Math.floor(o/2),s=of(a,a,o,o,r)):s=this.getTileRangeForExtentAndZ(l,u,r),t(u,s))return!0;--u}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,t,r){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){const s=e[1]*2,a=e[2]*2;return of(s,s+1,a,a+1,t)}const i=this.getTileCoordExtent(e,r||this.tmpExtent_);return this.getTileRangeForExtentAndZ(i,e[0]+1,t)}return null}getTileRangeForTileCoordAndZ(e,t,r){if(t>this.maxZoom||t<this.minZoom)return null;const i=e[0],s=e[1],a=e[2];if(t===i)return of(s,a,s,a,r);if(this.zoomFactor_){const l=Math.pow(this.zoomFactor_,t-i),u=Math.floor(s*l),h=Math.floor(a*l);if(t<i)return of(u,u,h,h,r);const f=Math.floor(l*(s+1))-1,g=Math.floor(l*(a+1))-1;return of(u,f,h,g,r)}const o=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(o,t,r)}getTileRangeForExtentAndZ(e,t,r){this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,lf);const i=lf[1],s=lf[2];this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,lf);const a=lf[1],o=lf[2];return of(i,a,s,o,r)}getTileCoordCenter(e){const t=this.getOrigin(e[0]),r=this.getResolution(e[0]),i=Is(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*i[0]*r,t[1]-(e[2]+.5)*i[1]*r]}getTileCoordExtent(e,t){const r=this.getOrigin(e[0]),i=this.getResolution(e[0]),s=Is(this.getTileSize(e[0]),this.tmpSize_),a=r[0]+e[1]*s[0]*i,o=r[1]-(e[2]+1)*s[1]*i,l=a+s[0]*i,u=o+s[1]*i;return lu(a,o,l,u,t)}getTileCoordForCoordAndResolution(e,t,r){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,r)}getTileCoordForXYAndResolution_(e,t,r,i,s){const a=this.getZForResolution(r),o=r/this.getResolution(a),l=this.getOrigin(a),u=Is(this.getTileSize(a),this.tmpSize_);let h=o*(e-l[0])/r/u[0],f=o*(l[1]-t)/r/u[1];return i?(h=zc(h,Ac)-1,f=zc(f,Ac)-1):(h=Vy(h,Ac),f=Vy(f,Ac)),mx(a,h,f,s)}getTileCoordForXYAndZ_(e,t,r,i,s){const a=this.getOrigin(r),o=this.getResolution(r),l=Is(this.getTileSize(r),this.tmpSize_);let u=(e-a[0])/o/l[0],h=(a[1]-t)/o/l[1];return i?(u=zc(u,Ac)-1,h=zc(h,Ac)-1):(u=Vy(u,Ac),h=Vy(h,Ac)),mx(r,u,h,s)}getTileCoordForCoordAndZ(e,t,r){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,r)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,t){const r=Cv(this.resolutions_,e,t||0);return ar(r,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,t){return d5(t,0,t.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){const t=this.resolutions_.length,r=new Array(t);for(let i=this.minZoom;i<t;++i)r[i]=this.getTileRangeForExtentAndZ(e,i);this.fullTileRanges_=r}}function lD(n){let e=n.getDefaultTileGrid();return e||(e=AW(n),n.setDefaultTileGrid(e)),e}function TW(n,e,t){const r=e[0],i=n.getTileCoordCenter(e),s=RI(t);if(!Oh(s,i)){const a=un(s),o=Math.ceil((s[0]-i[0])/a);return i[0]+=a*o,n.getTileCoordForCoordAndZ(i,r)}return e}function bW(n,e,t,r){r=r!==void 0?r:"top-left";const i=cD(n,e,t);return new oD({extent:n,origin:KB(n,r),resolutions:i,tileSize:t})}function IW(n){const e=n||{},t=e.extent||qn("EPSG:3857").getExtent(),r={extent:t,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:cD(t,e.maxZoom,e.tileSize,e.maxResolution)};return new oD(r)}function cD(n,e,t,r){e=e!==void 0?e:rW,t=Is(t!==void 0?t:TI);const i=Wr(n),s=un(n);r=r>0?r:Math.max(s/t[0],i/t[1]);const a=e+1,o=new Array(a);for(let l=0;l<a;++l)o[l]=r/Math.pow(2,l);return o}function AW(n,e,t,r){const i=RI(n);return bW(i,e,t,r)}function RI(n){n=qn(n);let e=n.getExtent();if(!e){const t=180*c0.degrees/n.getMetersPerUnit();e=lu(-t,-t,t,t)}return e}function CI(n,e){const t=[];Object.keys(e).forEach(function(i){e[i]!==null&&e[i]!==void 0&&t.push(i+"="+encodeURIComponent(e[i]))});const r=t.join("&");return n=n.replace(/[?&]$/,""),n+=n.includes("?")?"&":"?",n+r}const RW=/\{z\}/g,CW=/\{x\}/g,kW=/\{y\}/g,PW=/\{-y\}/g;function MW(n,e,t,r,i){return n.replace(RW,e.toString()).replace(CW,t.toString()).replace(kW,r.toString()).replace(PW,function(){if(i===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(i-r).toString()})}function NW(n){const e=[];let t=/\{([a-z])-([a-z])\}/.exec(n);if(t){const r=t[1].charCodeAt(0),i=t[2].charCodeAt(0);let s;for(s=r;s<=i;++s)e.push(n.replace(t[0],String.fromCharCode(s)));return e}if(t=/\{(\d+)-(\d+)\}/.exec(n),t){const r=parseInt(t[2],10);for(let i=parseInt(t[1],10);i<=r;i++)e.push(n.replace(t[0],i.toString()));return e}return e.push(n),e}function LW(n,e){return(function(t,r,i){if(!t)return;let s;const a=t[0];if(e){const o=e.getFullTileRange(a);o&&(s=o.getHeight()-1)}return MW(n,a,t[1],t[2],s)})}function OW(n,e){const t=n.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=LW(n[i],e);return DW(r)}function DW(n){return n.length===1?n[0]:(function(e,t,r){if(!e)return;const i=aD(e),s=Jc(i,n.length);return n[s](e,t,r)})}class FW extends yI{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=e.tilePixelRatio!==void 0?e.tilePixelRatio:1,this.tileGrid=e.tileGrid!==void 0?e.tileGrid:null;const t=[256,256];this.tileGrid&&Is(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),t),this.tmpSize=[0,0],this.key_=e.key||bn(this),this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}getGutterForProjection(e){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getResolutions(e){const t=e?this.getTileGridForProjection(e):this.tileGrid;return t?t.getResolutions():null}getTile(e,t,r,i,s,a){return Vt()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:lD(e)}getTilePixelRatio(e){return this.tilePixelRatio_}getTilePixelSize(e,t,r){const i=this.getTileGridForProjection(r),s=this.getTilePixelRatio(t),a=Is(i.getTileSize(e),this.tmpSize);return s==1?a:zz(a,s,this.tmpSize)}getTileCoordForTileUrlFunction(e,t){const r=t!==void 0?t:this.getProjection(),i=t!==void 0?this.getTileGridForProjection(r):this.tileGrid||this.getTileGridForProjection(r);return this.getWrapX()&&r.isGlobal()&&(e=TW(i,e,r)),yW(e,i)?e:null}clear(){}refresh(){this.clear(),super.refresh()}}class jW extends tl{constructor(e,t){super(e),this.tile=t}}const H2={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class kI extends FW{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===kI.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){const t=e.target,r=bn(t),i=t.getState();let s;i==Lt.LOADING?(this.tileLoadingKeys_[r]=!0,s=H2.TILELOADSTART):r in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[r],s=i==Lt.ERROR?H2.TILELOADERROR:i==Lt.LOADED?H2.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new jW(s,t))}setTileLoadFunction(e){this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,t){this.tileUrlFunction=e,typeof t<"u"?this.setKey(t):this.changed()}setUrl(e){const t=NW(e);this.urls=t,this.setUrls(t)}setUrls(e){this.urls=e;const t=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(OW(e,this.tileGrid),t):this.setKey(t)}tileUrlFunction(e,t,r){}}class uD extends kI{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:hD,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate!==void 0?e.interpolate:!0,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,this.tileClass=e.tileClass!==void 0?e.tileClass:tD,this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(e){return this.getProjection()&&e&&!Ah(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getTileGridForProjection(e){const t=this.getProjection();if(this.tileGrid&&(!t||Ah(t,e)))return this.tileGrid;const r=bn(e);return r in this.tileGridForProjection||(this.tileGridForProjection[r]=lD(e)),this.tileGridForProjection[r]}createTile_(e,t,r,i,s,a){const o=[e,t,r],l=this.getTileCoordForTileUrlFunction(o,s),u=l?this.tileUrlFunction(l,i,s):void 0,h=new this.tileClass(o,u!==void 0?Lt.IDLE:Lt.EMPTY,u!==void 0?u:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return h.key=a,h.addEventListener(Yt.CHANGE,this.handleTileChange.bind(this)),h}getTile(e,t,r,i,s,a){const o=this.getProjection();if(!o||!s||Ah(o,s))return this.getTileInternal(e,t,r,i,o||s);const l=[e,t,r],u=this.getKey(),h=this.getTileGridForProjection(o),f=this.getTileGridForProjection(s),g=this.getTileCoordForTileUrlFunction(l,s),y=new sD(o,h,s,f,l,g,this.getTilePixelRatio(i),this.getGutter(),(v,x,E,T)=>this.getTileInternal(v,x,E,T,o,a),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return y.key=u,y}getTileInternal(e,t,r,i,s,a){const o=this.getKey(),l=I_(this,o,e,t,r);if(a&&a.containsKey(l))return a.get(l);const u=this.createTile_(e,t,r,i,s,o);return a?.set(l,u),u}setRenderReprojectionEdges(e){this.renderReprojectionEdges_!=e&&(this.renderReprojectionEdges_=e,this.changed())}setTileGridForProjection(e,t){const r=qn(e);if(r){const i=bn(r);i in this.tileGridForProjection||(this.tileGridForProjection[i]=t)}}}function hD(n,e){if(Zs){const t=n.getCrossOrigin();let r="same-origin",i="same-origin";t==="anonymous"||t===""?(r="cors",i="omit"):t==="use-credentials"&&(r="cors",i="include"),fetch(e,{mode:r,credentials:i}).then(s=>{if(!s.ok)throw new Error(`HTTP ${s.status}`);return s.blob()}).then(s=>createImageBitmap(s)).then(s=>{const a=n.getImage();a.width=s.width,a.height=s.height,a.getContext("2d").drawImage(s,0,0),s.close?.(),a.dispatchEvent(new Event("load"))}).catch(()=>{n.getImage().dispatchEvent(new Event("error"))});return}n.getImage().src=e}class Ef extends uD{constructor(e){e=e||{};const t=e.projection!==void 0?e.projection:"EPSG:3857",r=e.tileGrid!==void 0?e.tileGrid:IW({extent:RI(t),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:t,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:r,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0}getGutter(){return this.gutter_}}const VW="modulepreload",GW=function(n){return"/detectorapp-nl/"+n},N4={},pt=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){let l=function(u){return Promise.all(u.map(h=>Promise.resolve(h).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=a?.nonce||a?.getAttribute("nonce");i=l(t.map(u=>{if(u=GW(u),u in N4)return;N4[u]=!0;const h=u.endsWith(".css"),f=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${f}`))return;const g=document.createElement("link");if(g.rel=h?"stylesheet":VW,h||(g.as="script"),g.crossOrigin="",g.href=u,o&&g.setAttribute("nonce",o),document.head.appendChild(g),h)return new Promise((y,v)=>{g.addEventListener("load",y),g.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${u}`)))})}))}function s(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return i.then(a=>{for(const o of a||[])o.status==="rejected"&&s(o.reason);return e().catch(s)})};class BW extends w5{constructor(e,t,r,i,s,a,o){let l=e.getExtent();l&&e.canWrapX()&&(l=l.slice(),l[0]=-1/0,l[2]=1/0);let u=t.getExtent();u&&t.canWrapX()&&(u=u.slice(),u[0]=-1/0,u[2]=1/0);const h=u?kl(r,u):r,f=Yo(h),g=gx(e,t,f,i),y=iD,v=new rD(e,t,h,l,g*y,i),x=v.calculateSourceExtent(),E=L0(x)?null:a(x,g,s),T=E?vt.IDLE:vt.EMPTY,b=E?E.getPixelRatio():1;super(r,i,b,T),this.targetProj_=t,this.maxSourceExtent_=l,this.triangulation_=v,this.targetResolution_=i,this.targetExtent_=r,this.sourceImage_=E,this.sourcePixelRatio_=b,this.interpolate_=o,this.canvas_=null,this.sourceListenerKey_=null}disposeInternal(){this.state==vt.LOADING&&this.unlistenSource_(),super.disposeInternal()}getImage(){return this.canvas_}getProjection(){return this.targetProj_}reproject_(){const e=this.sourceImage_.getState();if(e==vt.LOADED){const t=un(this.targetExtent_)/this.targetResolution_,r=Wr(this.targetExtent_)/this.targetResolution_;this.canvas_=nD(t,r,this.sourcePixelRatio_,mT(this.sourceImage_.getResolution()),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0,void 0,this.interpolate_,!0)}this.state=e,this.changed()}load(){if(this.state==vt.IDLE){this.state=vt.LOADING,this.changed();const e=this.sourceImage_.getState();e==vt.LOADED||e==vt.ERROR?this.reproject_():(this.sourceListenerKey_=yn(this.sourceImage_,Yt.CHANGE,t=>{const r=this.sourceImage_.getState();(r==vt.LOADED||r==vt.ERROR)&&(this.unlistenSource_(),this.reproject_())}),this.sourceImage_.load())}}unlistenSource_(){nr(this.sourceListenerKey_),this.sourceListenerKey_=null}}const Kc=4,K2={IMAGELOADSTART:"imageloadstart",IMAGELOADEND:"imageloadend",IMAGELOADERROR:"imageloaderror"};class UW extends tl{constructor(e,t){super(e),this.image=t}}class zW extends yI{constructor(e){super({attributions:e.attributions,projection:e.projection,state:e.state,interpolate:e.interpolate!==void 0?e.interpolate:!0}),this.on,this.once,this.un,this.loader=e.loader||null,this.resolutions_=e.resolutions!==void 0?e.resolutions:null,this.reprojectedImage_=null,this.reprojectedRevision_=0,this.image=null,this.wantedExtent_,this.wantedResolution_,this.static_=e.loader?e.loader.length===0:!1,this.wantedProjection_=null}getResolutions(){return this.resolutions_}setResolutions(e){this.resolutions_=e}findNearestResolution(e){const t=this.getResolutions();if(t){const r=Cv(t,e,0);e=t[r]}return e}getImage(e,t,r,i){const s=this.getProjection();if(!s||!i||Ah(s,i))return s&&(i=s),this.getImageInternal(e,t,r,i);if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&Ah(this.reprojectedImage_.getProjection(),i)&&this.reprojectedImage_.getResolution()==t&&l0(this.reprojectedImage_.getExtent(),e))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new BW(s,i,e,t,r,(a,o,l)=>this.getImageInternal(a,o,l,s),this.getInterpolate()),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}getImageInternal(e,t,r,i){if(this.loader){const s=dD(e,t,r,1),a=this.findNearestResolution(t);if(this.image&&(this.static_||this.wantedProjection_===i&&(this.wantedExtent_&&Uc(this.wantedExtent_,s)||Uc(this.image.getExtent(),s))&&(this.wantedResolution_&&mT(this.wantedResolution_)===a||mT(this.image.getResolution())===a)))return this.image;this.wantedProjection_=i,this.wantedExtent_=s,this.wantedResolution_=a,this.image=new w5(s,a,r,this.loader),this.image.addEventListener(Yt.CHANGE,this.handleImageChange.bind(this))}return this.image}handleImageChange(e){const t=e.target;let r;switch(t.getState()){case vt.LOADING:this.loading=!0,r=K2.IMAGELOADSTART;break;case vt.LOADED:this.loading=!1,r=K2.IMAGELOADEND;break;case vt.ERROR:this.loading=!1,r=K2.IMAGELOADERROR;break;default:return}this.hasListener(r)&&this.dispatchEvent(new UW(r,t))}}function $W(n,e){n.getImage().src=e}function dD(n,e,t,r){const i=e/t,s=Yo(n),a=zc(un(n)/i,Kc),o=zc(Wr(n)/i,Kc),l=zc((r-1)*a/2,Kc),u=a+2*l,h=zc((r-1)*o/2,Kc),f=o+2*h;return J_(s,i,0,[u,f])}function WW(n,e,t,r,i,s){const a=i.getCode().split(/:(?=\d+$)/).pop(),o=t/r,l=[ex(un(e)/o,Kc),ex(Wr(e)/o,Kc)];s.SIZE=l[0]+","+l[1],s.BBOX=e.join(","),s.BBOXSR=a,s.IMAGESR=a,s.DPI=Math.round(s.DPI?s.DPI*r:90*r);const u=n.replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage");return CI(u,s)}function HW(n){const e=n.load?n.load:S5,t=qn(n.projection||"EPSG:3857"),r=n.ratio??1.5,i=n.crossOrigin??null;return function(s,a,o){o=n.hidpi?o:1;const l={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};Object.assign(l,n.params),s=dD(s,a,o,r);const u=WW(n.url,s,a,o,t,l),h=new Image;return h.crossOrigin=i,e(h,u).then(f=>{const g=un(s)/f.width*o;return{image:f,extent:s,resolution:g,pixelRatio:o}})}}class KW extends zW{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:e.interpolate,projection:e.projection,resolutions:e.resolutions}),this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.url_=e.url,this.imageLoadFunction_=e.imageLoadFunction!==void 0?e.imageLoadFunction:$W,this.params_=Object.assign({},e.params),this.imageSize_=[0,0],this.renderedRevision_=0,this.ratio_=e.ratio!==void 0?e.ratio:1.5,this.loaderProjection_=null}getParams(){return this.params_}getImageInternal(e,t,r,i){return this.url_===void 0?null:((!this.loader||this.loaderProjection_!==i)&&(this.loaderProjection_=i,this.loader=HW({crossOrigin:this.crossOrigin_,params:this.params_,projection:i,hidpi:this.hidpi_,url:this.url_,ratio:this.ratio_,load:(s,a)=>(this.image.setImage(s),this.imageLoadFunction_(this.image,a),S5(s))})),super.getImageInternal(e,t,r,i))}getImageLoadFunction(){return this.imageLoadFunction_}getUrl(){return this.url_}setImageLoadFunction(e){this.imageLoadFunction_=e,this.changed()}setUrl(e){e!=this.url_&&(this.url_=e,this.loader=null,this.changed())}setParams(e){this.params_=Object.assign({},e),this.changed()}updateParams(e){Object.assign(this.params_,e),this.changed()}changed(){this.image=null,super.changed()}}const pT="1.3.0";function YW(n,e,t,r,i){i.WIDTH=t[0],i.HEIGHT=t[1];const s=r.getAxisOrientation(),a=qO(i.VERSION,"1.3")>=0;i[a?"CRS":"SRS"]=r.getCode();const o=a&&s.startsWith("ne")?[e[1],e[0],e[3],e[2]]:e;return i.BBOX=o.join(","),CI(n,i)}function XW(n,e,t,r,i,s,a){s=Object.assign({REQUEST:"GetMap"},s);const o=e/t,l=[ex(un(n)/o,Kc),ex(Wr(n)/o,Kc)];if(t!=1)switch(a){case"geoserver":const h=90*t+.5|0;"FORMAT_OPTIONS"in s?s.FORMAT_OPTIONS+=";dpi:"+h:s.FORMAT_OPTIONS="dpi:"+h;break;case"mapserver":s.MAP_RESOLUTION=90*t;break;case"carmentaserver":case"qgis":s.DPI=90*t;break;default:throw new Error("Unknown `serverType` configured")}return YW(i,n,l,r,s)}function L4(n,e){return Object.assign({REQUEST:e,SERVICE:"WMS",VERSION:pT,FORMAT:"image/png",STYLES:"",TRANSPARENT:"TRUE"},n)}const qW='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.';class ZW extends Ef{constructor(e){e=e||{};let t;e.attributions!==void 0?t=e.attributions:t=[qW];const r=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",i=e.url!==void 0?e.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:t,attributionsCollapsible:!1,cacheSize:e.cacheSize,crossOrigin:r,interpolate:e.interpolate,maxZoom:e.maxZoom!==void 0?e.maxZoom:19,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:(s,a)=>{const o=s.getImage();!Zs&&o instanceof HTMLImageElement&&(o.referrerPolicy="origin-when-cross-origin"),(e.tileLoadFunction||hD)(s,a)},transition:e.transition,url:i,wrapX:e.wrapX,zDirection:e.zDirection})}}const px=1/0;class QW{constructor(e,t){this.priorityFunction_=e,this.keyFunction_=t,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,Gp(this.queuedElements_)}dequeue(){const e=this.elements_,t=this.priorities_,r=e[0];e.length==1?(e.length=0,t.length=0):(e[0]=e.pop(),t[0]=t.pop(),this.siftUp_(0));const i=this.keyFunction_(r);return delete this.queuedElements_[i],r}enqueue(e){Dn(!(this.keyFunction_(e)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const t=this.priorityFunction_(e);return t!=px?(this.elements_.push(e),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(e){return e*2+1}getRightChildIndex_(e){return e*2+2}getParentIndex_(e){return e-1>>1}heapify_(){let e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)}isEmpty(){return this.elements_.length===0}isKeyQueued(e){return e in this.queuedElements_}isQueued(e){return this.isKeyQueued(this.keyFunction_(e))}siftUp_(e){const t=this.elements_,r=this.priorities_,i=t.length,s=t[e],a=r[e],o=e;for(;e<i>>1;){const l=this.getLeftChildIndex_(e),u=this.getRightChildIndex_(e),h=u<i&&r[u]<r[l]?u:l;t[e]=t[h],r[e]=r[h],e=h}t[e]=s,r[e]=a,this.siftDown_(o,e)}siftDown_(e,t){const r=this.elements_,i=this.priorities_,s=r[t],a=i[t];for(;t>e;){const o=this.getParentIndex_(t);if(i[o]>a)r[t]=r[o],i[t]=i[o],t=o;else break}r[t]=s,i[t]=a}reprioritize(){const e=this.priorityFunction_,t=this.elements_,r=this.priorities_;let i=0;const s=t.length;let a,o,l;for(o=0;o<s;++o)a=t[o],l=e(a),l==px?delete this.queuedElements_[this.keyFunction_(a)]:(r[i]=l,t[i++]=a);t.length=i,r.length=i,this.heapify_()}}class JW extends QW{constructor(e,t){super(r=>e.apply(null,r),r=>r[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=t,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(e){const t=super.enqueue(e);return t&&e[0].addEventListener(Yt.CHANGE,this.boundHandleTileChange_),t}getTilesLoading(){return this.tilesLoading_}handleTileChange(e){const t=e.target,r=t.getState();if(r===Lt.LOADED||r===Lt.ERROR||r===Lt.EMPTY){r!==Lt.ERROR&&t.removeEventListener(Yt.CHANGE,this.boundHandleTileChange_);const i=t.getKey();i in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[i],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(e,t){let r=0;for(;this.tilesLoading_<e&&r<t&&this.getCount()>0;){const i=this.dequeue()[0],s=i.getKey();i.getState()===Lt.IDLE&&!(s in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++r,i.load())}}}function eH(n,e,t,r,i){if(!n||!(t in n.wantedTiles)||!n.wantedTiles[t][e.getKey()])return px;const s=n.viewState.center,a=r[0]-s[0],o=r[1]-s[1];return 65536*Math.log(i)+Math.sqrt(a*a+o*o)/i}class tH extends uD{constructor(e){e=e||{};const t=Object.assign({},e.params);super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:e.tileClass,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0,this.params_=t,this.v13_=!0,this.serverType_=e.serverType,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.tmpExtent_=ea(),this.updateV13_(),this.setKey(this.getKeyForParams_())}getFeatureInfoUrl(e,t,r,i){const s=qn(r),a=this.getProjection()||s;let o=this.getTileGrid();o||(o=this.getTileGridForProjection(a));const l=Hp(e,s,a),u=gx(a,s,e,t),h=o.getZForResolution(u,this.zDirection),f=o.getResolution(h),g=o.getTileCoordForCoordAndZ(l,h);if(o.getResolutions().length<=g[0])return;let y=o.getTileCoordExtent(g,this.tmpExtent_);const v=this.gutter_;v!==0&&(y=Km(y,f*v,y));const x={QUERY_LAYERS:this.params_.LAYERS};Object.assign(x,L4(this.params_,"GetFeatureInfo"),i);const E=Math.floor((l[0]-y[0])/f),T=Math.floor((y[3]-l[1])/f);return x[this.v13_?"I":"X"]=E,x[this.v13_?"J":"Y"]=T,this.getRequestUrl_(g,y,1,a||s,x)}getLegendUrl(e,t){if(this.urls[0]===void 0)return;const r={SERVICE:"WMS",VERSION:pT,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(t===void 0||t.LAYER===void 0){const i=this.params_.LAYERS;if(!(!Array.isArray(i)||i.length===1))return;r.LAYER=i}if(e!==void 0){const i=this.getProjection()?this.getProjection().getMetersPerUnit():1,s=28e-5;r.SCALE=e*i/s}return Object.assign(r,t),CI(this.urls[0],r)}getGutter(){return this.gutter_}getParams(){return this.params_}getRequestUrl_(e,t,r,i,s){const a=this.urls;if(!a)return;let o;if(a.length==1)o=a[0];else{const l=Jc(aD(e),a.length);o=a[l]}return XW(t,(this.tileGrid||this.getTileGridForProjection(i)).getResolution(e[0]),r,i,o,s,this.serverType_)}getTilePixelRatio(e){return!this.hidpi_||this.serverType_===void 0?1:e}getKeyForParams_(){let e=0;const t=[];for(const r in this.params_)t[e++]=r+"-"+this.params_[r];return t.join("/")}setParams_(e){this.params_=e,this.updateV13_(),this.setKey(this.getKeyForParams_())}setParams(e){this.setParams_(Object.assign({},e))}updateParams(e){this.setParams_(Object.assign(this.params_,e))}updateV13_(){const e=this.params_.VERSION||pT;this.v13_=qO(e,"1.3")>=0}tileUrlFunction(e,t,r){let i=this.getTileGrid();if(i||(i=this.getTileGridForProjection(r)),i.getResolutions().length<=e[0])return;t!=1&&(!this.hidpi_||this.serverType_===void 0)&&(t=1);const s=i.getResolution(e[0]);let a=i.getTileCoordExtent(e,this.tmpExtent_);const o=this.gutter_;o!==0&&(a=Km(a,s*o,a));const l=Object.assign({},L4(this.params_,"GetMap"));return this.getRequestUrl_(e,a,t,r,l)}}class Sf extends tl{constructor(e,t,r){super(e),this.map=t,this.frameState=r!==void 0?r:null}}class Nc extends Sf{constructor(e,t,r,i,s,a){super(e,t,s),this.originalEvent=r,this.pixel_=null,this.coordinate_=null,this.dragging=i!==void 0?i:!1,this.activePointers=a}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(e){this.pixel_=e}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(e){this.coordinate_=e}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const br={SINGLECLICK:"singleclick",CLICK:Yt.CLICK,DBLCLICK:Yt.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},yT={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown"};class nH extends Bp{constructor(e,t){super(e),this.map_=e,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=t===void 0?1:t,this.down_=null;const r=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=r,this.pointerdownListenerKey_=yn(r,yT.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=yn(r,yT.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(Yt.TOUCHMOVE,this.boundHandleTouchMove_,_5?{passive:!1}:!1)}emulateClick_(e){let t=new Nc(br.CLICK,this.map_,e);this.dispatchEvent(t),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,t=new Nc(br.DBLCLICK,this.map_,e),this.dispatchEvent(t)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const r=new Nc(br.SINGLECLICK,this.map_,e);this.dispatchEvent(r)},250)}updateActivePointers_(e){const t=e,r=t.pointerId;if(t.type==br.POINTERUP||t.type==br.POINTERCANCEL){delete this.trackedTouches_[r];for(const i in this.trackedTouches_)if(this.trackedTouches_[i].target!==t.target){delete this.trackedTouches_[i];break}}else(t.type==br.POINTERDOWN||t.type==br.POINTERMOVE)&&(this.trackedTouches_[r]=t);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(e){this.updateActivePointers_(e);const t=new Nc(br.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(t),this.emulateClicks_&&!t.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(nr),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(e){return e.button===0}handlePointerDown_(e){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(e);const t=new Nc(br.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);if(this.dispatchEvent(t),this.down_=new PointerEvent(e.type,e),Object.defineProperty(this.down_,"target",{writable:!1,value:e.target}),this.dragListenerKeys_.length===0){const r=this.map_.getOwnerDocument();this.dragListenerKeys_.push(yn(r,br.POINTERMOVE,this.handlePointerMove_,this),yn(r,br.POINTERUP,this.handlePointerUp_,this),yn(this.element_,br.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==r&&this.dragListenerKeys_.push(yn(this.element_.getRootNode(),br.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;const t=new Nc(br.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(t)}}relayMoveEvent_(e){this.originalPointerMoveEvent_=e;const t=!!(this.down_&&this.isMoving_(e));this.dispatchEvent(new Nc(br.POINTERMOVE,this.map_,e,t))}handleTouchMove_(e){const t=this.originalPointerMoveEvent_;(!t||t.defaultPrevented)&&(typeof e.cancelable!="boolean"||e.cancelable===!0)&&e.preventDefault()}isMoving_(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(nr(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(Yt.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(nr(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(nr),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const Lc={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},Bi={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};class Hv extends nl{constructor(e){super();const t=e.element;t&&!e.target&&!t.style.pointerEvents&&(t.style.pointerEvents="auto"),this.element=t||null,this.target_=null,this.map_=null,this.listenerKeys=[],e.render&&(this.render=e.render),e.target&&this.setTarget(e.target)}disposeInternal(){this.element?.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(e){this.map_&&this.element?.remove();for(let t=0,r=this.listenerKeys.length;t<r;++t)nr(this.listenerKeys[t]);if(this.listenerKeys.length=0,this.map_=e,e){const t=this.target_??e.getOverlayContainerStopEvent();this.element&&t.appendChild(this.element),this.render!==Hm&&this.listenerKeys.push(yn(e,Lc.POSTRENDER,this.render,this)),e.render()}}render(e){}setTarget(e){this.target_=typeof e=="string"?document.getElementById(e):e}}class rH extends Hv{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=e.collapsible!==void 0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=e.attributions;const t=e.className!==void 0?e.className:"ol-attribution",r=e.tipLabel!==void 0?e.tipLabel:"Attributions",i=e.expandClassName!==void 0?e.expandClassName:t+"-expand",s=e.collapseLabel!==void 0?e.collapseLabel:"",a=e.collapseClassName!==void 0?e.collapseClassName:t+"-collapse";typeof s=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=a):this.collapseLabel_=s;const o=e.label!==void 0?e.label:"i";typeof o=="string"?(this.label_=document.createElement("span"),this.label_.textContent=o,this.label_.className=i):this.label_=o;const l=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=r,this.toggleButton_.appendChild(l),this.toggleButton_.addEventListener(Yt.CLICK,this.handleClick_.bind(this),!1);const u=t+" "+Yp+" "+fI+(this.collapsed_&&this.collapsible_?" "+ZP:"")+(this.collapsible_?"":" ol-uncollapsible"),h=this.element;h.className=u,h.appendChild(this.toggleButton_),h.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(e){const t=this.getMap().getAllLayers(),r=new Set(t.flatMap(i=>i.getAttributions(e)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(i=>r.add(i)):r.add(this.attributions_)),!this.overrideCollapsible_){const i=!t.some(s=>s.getSource()?.getAttributionsCollapsible()===!1);this.setCollapsible(i)}return Array.from(r)}async updateElement_(e){if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=await Promise.all(this.collectSourceAttributions_(e).map(i=>GO(()=>i))),r=t.length>0;if(this.renderedVisible_!=r&&(this.element.style.display=r?"":"none",this.renderedVisible_=r),!Su(t,this.renderedAttributions_)){qU(this.ulElement_);for(let i=0,s=t.length;i<s;++i){const a=document.createElement("li");a.innerHTML=t[i],this.ulElement_.appendChild(a)}this.renderedAttributions_=t}}handleClick_(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(ZP),this.collapsed_?XP(this.collapseLabel_,this.label_):XP(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(e){this.userCollapsed_=e,!(!this.collapsible_||this.collapsed_===e)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(e){this.updateElement_(e.frameState)}}class iH extends Hv{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target});const t=e.className!==void 0?e.className:"ol-rotate",r=e.label!==void 0?e.label:"",i=e.compassClassName!==void 0?e.compassClassName:"ol-compass";this.label_=null,typeof r=="string"?(this.label_=document.createElement("span"),this.label_.className=i,this.label_.textContent=r):(this.label_=r,this.label_.classList.add(i));const s=e.tipLabel?e.tipLabel:"Reset rotation",a=document.createElement("button");a.className=t+"-reset",a.setAttribute("type","button"),a.title=s,a.appendChild(this.label_),a.addEventListener(Yt.CLICK,this.handleClick_.bind(this),!1);const o=t+" "+Yp+" "+fI,l=this.element;l.className=o,l.appendChild(a),this.callResetNorth_=e.resetNorth?e.resetNorth:void 0,this.duration_=e.duration!==void 0?e.duration:250,this.autoHide_=e.autoHide!==void 0?e.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(Uy)}handleClick_(e){e.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const r=t.getRotation();r!==void 0&&(this.duration_>0&&r%(2*Math.PI)!==0?t.animate({rotation:0,duration:this.duration_,easing:D0}):t.setRotation(0))}render(e){const t=e.frameState;if(!t)return;const r=t.viewState.rotation;if(r!=this.rotation_){const i="rotate("+r+"rad)";if(this.autoHide_){const s=this.element.classList.contains(Uy);!s&&r===0?this.element.classList.add(Uy):s&&r!==0&&this.element.classList.remove(Uy)}this.label_.style.transform=i}this.rotation_=r}}class sH extends Hv{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target});const t=e.className!==void 0?e.className:"ol-zoom",r=e.delta!==void 0?e.delta:1,i=e.zoomInClassName!==void 0?e.zoomInClassName:t+"-in",s=e.zoomOutClassName!==void 0?e.zoomOutClassName:t+"-out",a=e.zoomInLabel!==void 0?e.zoomInLabel:"+",o=e.zoomOutLabel!==void 0?e.zoomOutLabel:"",l=e.zoomInTipLabel!==void 0?e.zoomInTipLabel:"Zoom in",u=e.zoomOutTipLabel!==void 0?e.zoomOutTipLabel:"Zoom out",h=document.createElement("button");h.className=i,h.setAttribute("type","button"),h.title=l,h.appendChild(typeof a=="string"?document.createTextNode(a):a),h.addEventListener(Yt.CLICK,this.handleClick_.bind(this,r),!1);const f=document.createElement("button");f.className=s,f.setAttribute("type","button"),f.title=u,f.appendChild(typeof o=="string"?document.createTextNode(o):o),f.addEventListener(Yt.CLICK,this.handleClick_.bind(this,-r),!1);const g=t+" "+Yp+" "+fI,y=this.element;y.className=g,y.appendChild(h),y.appendChild(f),this.duration_=e.duration!==void 0?e.duration:250}handleClick_(e,t){t.preventDefault(),this.zoomByDelta_(e)}zoomByDelta_(e){const r=this.getMap().getView();if(!r)return;const i=r.getZoom();if(i!==void 0){const s=r.getConstrainedZoom(i+e);this.duration_>0?(r.getAnimating()&&r.cancelAnimations(),r.animate({zoom:s,duration:this.duration_,easing:D0})):r.setZoom(s)}}}function aH(n){n=n||{};const e=new wa;return(n.zoom===void 0||n.zoom)&&e.push(new sH(n.zoomOptions)),(n.rotate===void 0||n.rotate)&&e.push(new iH(n.rotateOptions)),(n.attribution===void 0||n.attribution)&&e.push(new rH(n.attributionOptions)),e}class oH{constructor(e,t,r){this.decay_=e,this.minVelocity_=t,this.delay_=r,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(e,t){this.points_.push(e,t,Date.now())}end(){if(this.points_.length<6)return!1;const e=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[t+2]<e)return!1;let r=t-3;for(;r>0&&this.points_[r+2]>e;)r-=3;const i=this.points_[t+2]-this.points_[r+2];if(i<1e3/60)return!1;const s=this.points_[t]-this.points_[r],a=this.points_[t+1]-this.points_[r+1];return this.angle_=Math.atan2(a,s),this.initialVelocity_=Math.sqrt(s*s+a*a)/i,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}const O4={ACTIVE:"active"};class Jp extends nl{constructor(e){super(),this.on,this.once,this.un,e&&e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(O4.ACTIVE)}getMap(){return this.map_}handleEvent(e){return!0}setActive(e){this.set(O4.ACTIVE,e)}setMap(e){this.map_=e}}function lH(n,e,t){const r=n.getCenterInternal();if(r){const i=[r[0]+e[0],r[1]+e[1]];n.animateInternal({duration:t!==void 0?t:250,easing:Q$,center:n.getConstrainedCenter(i)})}}function PI(n,e,t,r){const i=n.getZoom();if(i===void 0)return;const s=n.getConstrainedZoom(i+e),a=n.getResolutionForZoom(s);n.getAnimating()&&n.cancelAnimations(),n.animate({resolution:a,anchor:t,duration:r!==void 0?r:250,easing:D0})}class cH extends Jp{constructor(e){super(),e=e||{},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:250}handleEvent(e){let t=!1;if(e.type==br.DBLCLICK){const r=e.originalEvent,i=e.map,s=e.coordinate,a=r.shiftKey?-this.delta_:this.delta_,o=i.getView();PI(o,a,s,this.duration_),r.preventDefault(),t=!0}return!t}}function _T(n){const e=arguments;return function(t){let r=!0;for(let i=0,s=e.length;i<s&&(r=r&&e[i](t),!!r);++i);return r}}const uH=function(n){const e=n.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},hH=function(n){const e=n.map.getTargetElement(),t=e.getRootNode(),r=n.map.getOwnerDocument().activeElement;return t instanceof ShadowRoot?t.host.contains(r):e.contains(r)},fD=function(n){const e=n.map.getTargetElement(),t=e.getRootNode();return(t instanceof ShadowRoot?t.host:e).hasAttribute("tabindex")?hH(n):!0},dH=Wm,gD=function(n){const e=n.originalEvent;return"pointerId"in e&&e.button==0&&!(YU&&p5&&e.ctrlKey)},mD=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},fH=function(n){const e=n.originalEvent;return p5?e.metaKey:e.ctrlKey},gH=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},pD=function(n){const e=n.originalEvent,t=e.target.tagName;return t!=="INPUT"&&t!=="SELECT"&&t!=="TEXTAREA"&&!e.target.isContentEditable},Y2=function(n){const e=n.originalEvent;return"pointerId"in e&&e.pointerType=="mouse"},mH=function(n){const e=n.originalEvent;return"pointerId"in e&&e.isPrimary&&e.button===0};class e1 extends Jp{constructor(e){e=e||{},super(e),e.handleDownEvent&&(this.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(this.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(this.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(this.handleUpEvent=e.handleUpEvent),e.stopDown&&(this.stopDown=e.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(e){return!1}handleDragEvent(e){}handleEvent(e){if(!e.originalEvent)return!0;let t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==br.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==br.POINTERUP){const r=this.handleUpEvent(e);this.handlingDownUpSequence=r&&this.targetPointers.length>0}}else if(e.type==br.POINTERDOWN){const r=this.handleDownEvent(e);this.handlingDownUpSequence=r,t=this.stopDown(r)}else e.type==br.POINTERMOVE&&this.handleMoveEvent(e);return!t}handleMoveEvent(e){}handleUpEvent(e){return!1}stopDown(e){return e}updateTrackedPointers_(e){e.activePointers&&(this.targetPointers=e.activePointers)}}function MI(n){const e=n.length;let t=0,r=0;for(let i=0;i<e;i++)t+=n[i].clientX,r+=n[i].clientY;return{clientX:t/e,clientY:r/e}}class pH extends e1{constructor(e){super({stopDown:kv}),e=e||{},this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const t=e.condition?e.condition:_T(mD,mH);this.condition_=e.onFocusOnly?_T(fD,t):t,this.noKinetic_=!1}handleDragEvent(e){const t=e.map;this.panning_||(this.panning_=!0,t.getView().beginInteraction());const r=this.targetPointers,i=t.getEventPixel(MI(r));if(r.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(i[0],i[1]),this.lastCentroid){const s=[this.lastCentroid[0]-i[0],i[1]-this.lastCentroid[1]],o=e.map.getView();JB(s,o.getResolution()),qb(s,o.getRotation()),o.adjustCenterInternal(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=i,this.lastPointersCount_=r.length,e.originalEvent.preventDefault()}handleUpEvent(e){const t=e.map,r=t.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const i=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),a=r.getCenterInternal(),o=t.getPixelFromCoordinateInternal(a),l=t.getCoordinateFromPixelInternal([o[0]-i*Math.cos(s),o[1]-i*Math.sin(s)]);r.animateInternal({center:r.getConstrainedCenter(l),duration:500,easing:D0})}return this.panning_&&(this.panning_=!1,r.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(e){if(this.targetPointers.length>0&&this.condition_(e)){const r=e.map.getView();return this.lastCentroid=null,r.getAnimating()&&r.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class yH extends e1{constructor(e){e=e||{},super({stopDown:kv}),this.condition_=e.condition?e.condition:uH,this.lastAngle_=void 0,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){if(!Y2(e))return;const t=e.map,r=t.getView();if(r.getConstraints().rotation===SI)return;const i=t.getSize(),s=e.pixel,a=Math.atan2(i[1]/2-s[1],s[0]-i[0]/2);if(this.lastAngle_!==void 0){const o=a-this.lastAngle_;r.adjustRotationInternal(-o)}this.lastAngle_=a}handleUpEvent(e){return Y2(e)?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){return Y2(e)&&gD(e)&&this.condition_(e)?(e.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class _H extends Rv{constructor(e){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const e=this.startPixel_,t=this.endPixel_,r="px",i=this.element_.style;i.left=Math.min(e[0],t[0])+r,i.top=Math.min(e[1],t[1])+r,i.width=Math.abs(t[0]-e[0])+r,i.height=Math.abs(t[1]-e[1])+r}setMap(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(e,t){this.startPixel_=e,this.endPixel_=t,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const e=this.startPixel_,t=this.endPixel_,i=[e,[e[0],t[1]],t,[t[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);i[4]=i[0].slice(),this.geometry_?this.geometry_.setCoordinates([i]):this.geometry_=new Ca([i])}getGeometry(){return this.geometry_}}const cf={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class Gg extends tl{constructor(e,t,r){super(e),this.coordinate=t,this.mapBrowserEvent=r}}class xH extends e1{constructor(e){super(),this.on,this.once,this.un,e=e??{},this.box_=new _H(e.className||"ol-dragbox"),this.minArea_=e.minArea??64,e.onBoxEnd&&(this.onBoxEnd=e.onBoxEnd),this.startPixel_=null,this.condition_=e.condition??gD,this.boxEndCondition_=e.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(e,t,r){const i=r[0]-t[0],s=r[1]-t[1];return i*i+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(e){this.startPixel_&&(this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new Gg(cf.BOXDRAG,e.coordinate,e)))}handleUpEvent(e){if(!this.startPixel_)return!1;const t=this.boxEndCondition_(e,this.startPixel_,e.pixel);return t&&this.onBoxEnd(e),this.dispatchEvent(new Gg(t?cf.BOXEND:cf.BOXCANCEL,e.coordinate,e)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(e){return this.condition_(e)?(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new Gg(cf.BOXSTART,e.coordinate,e)),!0):!1}onBoxEnd(e){}setActive(e){e||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Gg(cf.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(e)}setMap(e){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Gg(cf.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(e)}}class vH extends xH{constructor(e){e=e||{};const t=e.condition?e.condition:gH;super({condition:t,className:e.className||"ol-dragzoom",minArea:e.minArea}),this.duration_=e.duration!==void 0?e.duration:200,this.out_=e.out!==void 0?e.out:!1}onBoxEnd(e){const r=this.getMap().getView();let i=this.getGeometry();if(this.out_){const s=r.rotatedExtentForGeometry(i),a=r.getResolutionForExtentInternal(s),o=r.getResolution()/a;i=i.clone(),i.scale(o*o)}r.fitInternal(i,{duration:this.duration_,easing:D0})}}const Qu={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class wH extends Jp{constructor(e){super(),e=e||{},this.defaultCondition_=function(t){return mD(t)&&pD(t)},this.condition_=e.condition!==void 0?e.condition:this.defaultCondition_,this.duration_=e.duration!==void 0?e.duration:100,this.pixelDelta_=e.pixelDelta!==void 0?e.pixelDelta:128}handleEvent(e){let t=!1;if(e.type==Yt.KEYDOWN){const r=e.originalEvent,i=r.key;if(this.condition_(e)&&(i==Qu.DOWN||i==Qu.LEFT||i==Qu.RIGHT||i==Qu.UP)){const a=e.map.getView(),o=a.getResolution()*this.pixelDelta_;let l=0,u=0;i==Qu.DOWN?u=-o:i==Qu.LEFT?l=-o:i==Qu.RIGHT?l=o:u=o;const h=[l,u];qb(h,a.getRotation()),lH(a,h,this.duration_),r.preventDefault(),t=!0}}return!t}}class EH extends Jp{constructor(e){super(),e=e||{},this.condition_=e.condition?e.condition:function(t){return!fH(t)&&pD(t)},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:100}handleEvent(e){let t=!1;if(e.type==Yt.KEYDOWN||e.type==Yt.KEYPRESS){const r=e.originalEvent,i=r.key;if(this.condition_(e)&&(i==="+"||i==="-")){const s=e.map,a=i==="+"?this.delta_:-this.delta_,o=s.getView();PI(o,a,void 0,this.duration_),r.preventDefault(),t=!0}}return!t}}const SH=40,TH=300;class bH extends Jp{constructor(e){e=e||{},super(e),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=e.maxDelta!==void 0?e.maxDelta:1,this.duration_=e.duration!==void 0?e.duration:250,this.timeout_=e.timeout!==void 0?e.timeout:80,this.useAnchor_=e.useAnchor!==void 0?e.useAnchor:!0,this.constrainResolution_=e.constrainResolution!==void 0?e.constrainResolution:!1;const t=e.condition?e.condition:dH;this.condition_=e.onFocusOnly?_T(fD,t):t,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const e=this.getMap();if(!e)return;e.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(e){if(!this.condition_(e)||e.type!==Yt.WHEEL)return!0;const r=e.map,i=e.originalEvent;i.preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.pixel);let s=i.deltaY;switch(i.deltaMode){case WheelEvent.DOM_DELTA_LINE:s*=SH;break;case WheelEvent.DOM_DELTA_PAGE:s*=TH;break}if(s===0)return!1;this.lastDelta_=s;const a=Date.now();this.startTime_===void 0&&(this.startTime_=a),(!this.mode_||a-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?"trackpad":"wheel");const o=r.getView();if(this.mode_==="trackpad"&&!(o.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(o.getAnimating()&&o.cancelAnimations(),o.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),o.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_?r.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=a,!1;this.totalDelta_+=s;const l=Math.max(this.timeout_-(a-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,r),l),!1}handleWheelZoom_(e){const t=e.getView();t.getAnimating()&&t.cancelAnimations();let r=-ar(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(t.getConstrainResolution()||this.constrainResolution_)&&(r=r?r>0?1:-1:0),PI(t,r,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(e){this.useAnchor_=e,e||(this.lastAnchor_=null)}}class IH extends e1{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=kv),super(t),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=e.threshold!==void 0?e.threshold:.3,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){let t=0;const r=this.targetPointers[0],i=this.targetPointers[1],s=Math.atan2(i.clientY-r.clientY,i.clientX-r.clientX);if(this.lastAngle_!==void 0){const l=s-this.lastAngle_;this.rotationDelta_+=l,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),t=l}this.lastAngle_=s;const a=e.map,o=a.getView();o.getConstraints().rotation!==SI&&(this.anchor_=a.getCoordinateFromPixelInternal(a.getEventPixel(MI(this.targetPointers))),this.rotating_&&(a.render(),o.adjustRotationInternal(t,this.anchor_)))}handleUpEvent(e){return this.targetPointers.length<2?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}class AH extends e1{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=kv),super(t),this.anchor_=null,this.duration_=e.duration!==void 0?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(e){let t=1;const r=this.targetPointers[0],i=this.targetPointers[1],s=r.clientX-i.clientX,a=r.clientY-i.clientY,o=Math.sqrt(s*s+a*a);this.lastDistance_!==void 0&&(t=this.lastDistance_/o),this.lastDistance_=o;const l=e.map,u=l.getView();t!=1&&(this.lastScaleDelta_=t),this.anchor_=l.getCoordinateFromPixelInternal(l.getEventPixel(MI(this.targetPointers))),l.render(),u.adjustResolutionInternal(t,this.anchor_)}handleUpEvent(e){if(this.targetPointers.length<2){const r=e.map.getView(),i=this.lastScaleDelta_>1?1:-1;return r.endInteraction(this.duration_,i),!1}return!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}function RH(n){n=n||{};const e=new wa,t=new oH(-.005,.05,100);return(n.altShiftDragRotate===void 0||n.altShiftDragRotate)&&e.push(new yH),(n.doubleClickZoom===void 0||n.doubleClickZoom)&&e.push(new cH({delta:n.zoomDelta,duration:n.zoomDuration})),(n.dragPan===void 0||n.dragPan)&&e.push(new pH({onFocusOnly:n.onFocusOnly,kinetic:t})),(n.pinchRotate===void 0||n.pinchRotate)&&e.push(new IH),(n.pinchZoom===void 0||n.pinchZoom)&&e.push(new AH({duration:n.zoomDuration})),(n.keyboard===void 0||n.keyboard)&&(e.push(new wH),e.push(new EH({delta:n.zoomDelta,duration:n.zoomDuration}))),(n.mouseWheelZoom===void 0||n.mouseWheelZoom)&&e.push(new bH({onFocusOnly:n.onFocusOnly,duration:n.zoomDuration})),(n.shiftDragZoom===void 0||n.shiftDragZoom)&&e.push(new vH({duration:n.zoomDuration})),e}class CH extends Rv{constructor(e){super(),this.map_=e}dispatchRenderEvent(e,t){Vt()}calculateMatrices2D(e){const t=e.viewState,r=e.coordinateToPixelTransform,i=e.pixelToCoordinateTransform;Xo(r,e.size[0]/2,e.size[1]/2,1/t.resolution,-1/t.resolution,-t.rotation,-t.center[0],-t.center[1]),o5(i,r)}forEachFeatureAtCoordinate(e,t,r,i,s,a,o,l){let u;const h=t.viewState;function f(M,F,z,P){return s.call(a,F,M?z:null,P)}const g=h.projection,y=ZO(e.slice(),g),v=[[0,0]];if(g.canWrapX()&&i){const M=g.getExtent(),F=un(M);v.push([-F,0],[F,0])}const x=t.layerStatesArray,E=x.length,T=[],b=[];for(let M=0;M<v.length;M++)for(let F=E-1;F>=0;--F){const z=x[F],P=z.layer;if(P.hasRenderer()&&bI(z,h)&&o.call(l,P)){const C=P.getRenderer(),k=P.getSource();if(C&&k){const L=k.getWrapX()?y:e,O=f.bind(null,z.managed);b[0]=L[0]+v[M][0],b[1]=L[1]+v[M][1],u=C.forEachFeatureAtCoordinate(b,t,r,O,T)}if(u)return u}}if(T.length===0)return;const I=1/T.length;return T.forEach((M,F)=>M.distanceSq+=F*I),T.sort((M,F)=>M.distanceSq-F.distanceSq),T.some(M=>u=M.callback(M.feature,M.layer,M.geometry)),u}hasFeatureAtCoordinate(e,t,r,i,s,a){return this.forEachFeatureAtCoordinate(e,t,r,i,Wm,this,s,a)!==void 0}getMap(){return this.map_}renderFrame(e){Vt()}scheduleExpireIconCache(e){Sa.canExpireCache()&&e.postRenderFunctions.push(kH)}}function kH(n,e){Sa.expire()}class PH extends CH{constructor(e){super(e),this.fontChangeListenerKey_=yn(xf,o0.PROPERTYCHANGE,e.redrawText,e),this.element_=Zs?x5():document.createElement("div");const t=this.element_.style;t.position="absolute",t.width="100%",t.height="100%",t.zIndex="0",this.element_.className=Yp+" ol-layers";const r=e.getViewport();r&&r.insertBefore(this.element_,r.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(e,t){const r=this.getMap();if(r.hasListener(e)){const i=new z5(e,void 0,t);r.dispatchEvent(i)}}disposeInternal(){nr(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(e){if(!e){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(e),this.dispatchRenderEvent(Ea.PRECOMPOSE,e);const t=e.layerStatesArray.sort((u,h)=>u.zIndex-h.zIndex);t.some(u=>u.layer instanceof J5&&u.layer.getDeclutter())&&(e.declutter={});const i=e.viewState;this.children_.length=0;const s=[];let a=null;for(let u=0,h=t.length;u<h;++u){const f=t[u];e.layerIndex=u;const g=f.layer,y=g.getSourceState();if(!bI(f,i)||y!="ready"&&y!="undefined"){g.unrender();continue}const v=g.render(e,a);v&&(v!==a&&(this.children_.push(v),a=v),s.push(f))}this.declutter(e,s),ZU(this.element_,this.children_);const l=this.getMap().getTargetElement();if(Wc(l)){const u=l.getContext("2d");for(const h of this.children_){const f=h.firstElementChild||h,g=h.style.backgroundColor;if(g&&(!Wc(f)||f.width>0)&&(u.fillStyle=g,u.fillRect(0,0,l.width,l.height)),Wc(f)&&f.width>0){const y=h.style.opacity||f.style.opacity;u.globalAlpha=y===""?1:Number(y);const v=f.style.transform;if(v)u.setTransform(...sT(v));else{const x=parseFloat(f.style.width)/f.width,E=parseFloat(f.style.height)/f.height;u.setTransform(x,0,0,E,0,0)}u.drawImage(f,0,0)}}u.globalAlpha=1,u.setTransform(1,0,0,1,0,0)}this.dispatchRenderEvent(Ea.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}declutter(e,t){if(e.declutter){for(let r=t.length-1;r>=0;--r){const i=t[r],s=i.layer;s.getDeclutter()&&s.renderDeclutter(e,i)}t.forEach(r=>r.layer.renderDeferred(e))}}}function yD(n){if(n instanceof Qp){n.setMapInternal(null);return}n instanceof Wv&&n.getLayers().forEach(yD)}function _D(n,e){if(n instanceof Qp){n.setMapInternal(e);return}if(n instanceof Wv){const t=n.getLayers().getArray();for(let r=0,i=t.length;r<i;++r)_D(t[r],e)}}let MH=class extends nl{constructor(e){super(),e=e||{},this.on,this.once,this.un;const t=NH(e);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=e.maxTilesLoading!==void 0?e.maxTilesLoading:16,this.pixelRatio_=e.pixelRatio!==void 0?e.pixelRatio:XU,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=to(),this.pixelToCoordinateTransform_=to(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,Zs||(this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_)),this.mapBrowserEventHandler_=null,this.moveTolerance_=e.moveTolerance,this.keyboardEventTarget_=t.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,Zs||(this.resizeObserver_=new ResizeObserver(()=>this.updateSize())),this.controls=t.controls||(Zs?new wa:aH()),this.interactions=t.interactions||(Zs?new wa:RH({onFocusOnly:!0})),this.overlays_=t.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new JW(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(Bi.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(Bi.VIEW,this.handleViewChanged_),this.addChangeListener(Bi.SIZE,this.handleSizeChanged_),this.addChangeListener(Bi.TARGET,this.handleTargetChanged_),this.setProperties(t.values);const r=this;e.view&&!(e.view instanceof Oo)&&e.view.then(function(i){r.setView(new Oo(i))}),this.controls.addEventListener(ws.ADD,i=>{i.element.setMap(this)}),this.controls.addEventListener(ws.REMOVE,i=>{i.element.setMap(null)}),this.interactions.addEventListener(ws.ADD,i=>{i.element.setMap(this)}),this.interactions.addEventListener(ws.REMOVE,i=>{i.element.setMap(null)}),this.overlays_.addEventListener(ws.ADD,i=>{this.addOverlayInternal_(i.element)}),this.overlays_.addEventListener(ws.REMOVE,i=>{const s=i.element.getId();s!==void 0&&delete this.overlayIdIndex_[s.toString()],i.element.setMap(null)}),this.controls.forEach(i=>{i.setMap(this)}),this.interactions.forEach(i=>{i.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(e){this.getControls().push(e)}addInteraction(e){this.getInteractions().push(e)}addLayer(e){this.getLayerGroup().getLayers().push(e)}handleLayerAdd_(e){_D(e.layer,this)}addOverlay(e){this.getOverlays().push(e)}addOverlayInternal_(e){const t=e.getId();t!==void 0&&(this.overlayIdIndex_[t.toString()]=e),e.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_?.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(e,t,r){if(!this.frameState_||!this.renderer_)return;const i=this.getCoordinateFromPixelInternal(e);r=r!==void 0?r:{};const s=r.hitTolerance!==void 0?r.hitTolerance:0,a=r.layerFilter!==void 0?r.layerFilter:Wm,o=r.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(i,this.frameState_,s,o,t,null,a,null)}getFeaturesAtPixel(e,t){const r=[];return this.forEachFeatureAtPixel(e,function(i){r.push(i)},t),r}getAllLayers(){const e=[];function t(r){r.forEach(function(i){i instanceof Wv?t(i.getLayers()):e.push(i)})}return t(this.getLayers()),e}hasFeatureAtPixel(e,t){if(!this.frameState_||!this.renderer_)return!1;const r=this.getCoordinateFromPixelInternal(e);t=t!==void 0?t:{};const i=t.layerFilter!==void 0?t.layerFilter:Wm,s=t.hitTolerance!==void 0?t.hitTolerance:0,a=t.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(r,this.frameState_,s,a,i,null)}getEventCoordinate(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}getEventCoordinateInternal(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}getEventPixel(e){const r=this.viewport_.getBoundingClientRect(),i=this.getSize(),s=r.width/i[0],a=r.height/i[1],o="changedTouches"in e?e.changedTouches[0]:e;return[(o.clientX-r.left)/s,(o.clientY-r.top)/a]}getTarget(){return this.get(Bi.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(e){return iT(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}getCoordinateFromPixelInternal(e){const t=this.frameState_;return t?ni(t.pixelToCoordinateTransform,e.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(e){const t=this.overlayIdIndex_[e.toString()];return t!==void 0?t:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(Bi.LAYERGROUP)}setLayers(e){const t=this.getLayerGroup();if(e instanceof wa){t.setLayers(e);return}const r=t.getLayers();r.clear(),r.extend(e)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const e=this.getLayerGroup().getLayerStatesArray();for(let t=0,r=e.length;t<r;++t){const i=e[t];if(!i.visible)continue;const s=i.layer.getRenderer();if(s&&!s.ready)return!0;const a=i.layer.getSource();if(a&&a.loading)return!0}return!1}getPixelFromCoordinate(e){const t=wl(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(t)}getPixelFromCoordinateInternal(e){const t=this.frameState_;return t?ni(t.coordinateToPixelTransform,e.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(Bi.SIZE)}getView(){return this.get(Bi.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const e=this.getTargetElement();return e?e.ownerDocument:document}getTilePriority(e,t,r,i){return eH(this.frameState_,e,t,r,i)}handleBrowserEvent(e,t){t=t||e.type;const r=new Nc(t,this,e);this.handleMapBrowserEvent(r)}handleMapBrowserEvent(e){if(!this.frameState_)return;const t=e.originalEvent,r=t.type;if(r===yT.POINTERDOWN||r===Yt.WHEEL||r===Yt.KEYDOWN){const i=this.getOwnerDocument(),s=this.viewport_.getRootNode?this.viewport_.getRootNode():i,a=t.target,o=s instanceof ShadowRoot?s.host===a?s.host.ownerDocument:s:s===i?i.documentElement:s;if(this.overlayContainerStopEvent_.contains(a)||!o.contains(a))return}if(e.frameState=this.frameState_,this.dispatchEvent(e)!==!1){const i=this.getInteractions().getArray().slice();for(let s=i.length-1;s>=0;s--){const a=i[s];if(a.getMap()!==this||!a.getActive()||!this.getTargetElement())continue;if(!a.handleEvent(e)||e.propagationStopped)break}}}handlePostRender(){const e=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){let i=this.maxTilesLoading_,s=i;if(e){const a=e.viewHints;if(a[di.ANIMATING]||a[di.INTERACTING]){const o=Date.now()-e.time>8;i=o?0:8,s=o?0:2}}t.getTilesLoading()<i&&(t.reprioritize(),t.loadMoreTiles(i,s))}e&&this.renderer_&&!e.animate&&(this.renderComplete_?(this.hasListener(Ea.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(Ea.RENDERCOMPLETE,e),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new Sf(Lc.LOADEND,this,e)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new Sf(Lc.LOADSTART,this,e))));const r=this.postRenderFunctions_;if(e)for(let i=0,s=r.length;i<s;++i)r[i](this,e);r.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let r=0,i=this.targetChangeHandlerKeys_.length;r<i;++r)nr(this.targetChangeHandlerKeys_[r]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(Yt.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(Yt.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_&&!Wc(this.targetElement_)){this.resizeObserver_?.unobserve(this.targetElement_);const r=this.targetElement_.getRootNode();r instanceof ShadowRoot&&this.resizeObserver_.unobserve(r.host),this.setSize(void 0)}const e=this.getTarget(),t=typeof e=="string"?document.getElementById(e):e;if(this.targetElement_=t,!t)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{if(Wc(t)||t.appendChild(this.viewport_),this.renderer_||(this.renderer_=new PH(this)),!Wc(t)){this.mapBrowserEventHandler_=new nH(this,this.moveTolerance_);for(const i in br)this.mapBrowserEventHandler_.addEventListener(br[i],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(Yt.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(Yt.WHEEL,this.boundHandleBrowserEvent_,_5?{passive:!1}:!1);let r;if(this.keyboardEventTarget_)r=this.keyboardEventTarget_;else{const i=t.getRootNode();r=i instanceof ShadowRoot?i.host:t}if(this.targetChangeHandlerKeys_=[yn(r,Yt.KEYDOWN,this.handleBrowserEvent,this),yn(r,Yt.KEYPRESS,this.handleBrowserEvent,this)],t instanceof HTMLElement){const i=t.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.observe(i.host),this.resizeObserver_?.observe(t)}}this.updateSize()}}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(nr(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(nr(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const e=this.getView();e&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=yn(e,o0.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=yn(e,Yt.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(nr),this.layerGroupPropertyListenerKeys_=null);const e=this.getLayerGroup();e&&(this.handleLayerAdd_(new Dc("addlayer",e)),this.layerGroupPropertyListenerKeys_=[yn(e,o0.PROPERTYCHANGE,this.render,this),yn(e,Yt.CHANGE,this.render,this),yn(e,"addlayer",this.handleLayerAdd_,this),yn(e,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;const e=this.frameState_.layerStatesArray;for(let t=0,r=e.length;t<r;++t){const i=e[t].layer;i.hasRenderer()&&i.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(e){return this.getControls().remove(e)}removeInteraction(e){return this.getInteractions().remove(e)}removeLayer(e){return this.getLayerGroup().getLayers().remove(e)}handleLayerRemove_(e){yD(e.layer)}removeOverlay(e){return this.getOverlays().remove(e)}renderFrame_(e){const t=this.getSize(),r=this.getView(),i=this.frameState_;let s=null;if(t!==void 0&&c4(t)&&r&&r.isDef()){const a=r.getHints(this.frameState_?this.frameState_.viewHints:void 0),o=r.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:J_(o.center,o.resolution,o.rotation,t),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:t,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:o,viewHints:a,wantedTiles:{},mapId:bn(this),renderTargets:{}},o.nextCenter&&o.nextResolution){const l=isNaN(o.nextRotation)?o.rotation:o.nextRotation;s.nextExtent=J_(o.nextCenter,o.nextResolution,l,t)}}this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),i&&(!this.previousExtent_||!L0(this.previousExtent_)&&!l0(s.extent,this.previousExtent_))&&(this.dispatchEvent(new Sf(Lc.MOVESTART,this,i)),this.previousExtent_=zp(this.previousExtent_)),this.previousExtent_&&!s.viewHints[di.ANIMATING]&&!s.viewHints[di.INTERACTING]&&!l0(s.extent,this.previousExtent_)&&(this.dispatchEvent(new Sf(Lc.MOVEEND,this,s)),UO(s.extent,this.previousExtent_))),this.dispatchEvent(new Sf(Lc.POSTRENDER,this,s)),this.renderComplete_=(this.hasListener(Lc.LOADSTART)||this.hasListener(Lc.LOADEND)||this.hasListener(Ea.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(e){const t=this.getLayerGroup();t&&this.handleLayerRemove_(new Dc("removelayer",t)),this.set(Bi.LAYERGROUP,e)}setSize(e){this.set(Bi.SIZE,e)}setTarget(e){this.set(Bi.TARGET,e)}setView(e){if(!e||e instanceof Oo){this.set(Bi.VIEW,e);return}this.set(Bi.VIEW,new Oo);const t=this;e.then(function(r){t.setView(new Oo(r))})}updateSize(){const e=this.getTargetElement();let t;if(e){let i,s;if(Wc(e))i=e.width,s=e.height;else{const a=getComputedStyle(e);i=e.offsetWidth-parseFloat(a.borderLeftWidth)-parseFloat(a.paddingLeft)-parseFloat(a.paddingRight)-parseFloat(a.borderRightWidth),s=e.offsetHeight-parseFloat(a.borderTopWidth)-parseFloat(a.paddingTop)-parseFloat(a.paddingBottom)-parseFloat(a.borderBottomWidth)}!isNaN(i)&&!isNaN(s)&&(t=[Math.max(0,i),Math.max(0,s)],!c4(t)&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&JO("No map visible because the map container's width or height are 0."))}const r=this.getSize();t&&(!r||!Su(t,r))&&(this.setSize(t),this.updateViewportSize_(t))}updateViewportSize_(e){const t=this.getView();t&&t.setViewportSize(e)}};function NH(n){let e=null;n.keyboardEventTarget!==void 0&&(e=typeof n.keyboardEventTarget=="string"?document.getElementById(n.keyboardEventTarget):n.keyboardEventTarget);const t={},r=n.layers&&typeof n.layers.getLayers=="function"?n.layers:new Wv({layers:n.layers});t[Bi.LAYERGROUP]=r,t[Bi.TARGET]=n.target,t[Bi.VIEW]=n.view instanceof Oo?n.view:new Oo;let i;n.controls!==void 0&&(Array.isArray(n.controls)?i=new wa(n.controls.slice()):(Dn(typeof n.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),i=n.controls));let s;n.interactions!==void 0&&(Array.isArray(n.interactions)?s=new wa(n.interactions.slice()):(Dn(typeof n.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),s=n.interactions));let a;return n.overlays!==void 0?Array.isArray(n.overlays)?a=new wa(n.overlays.slice()):(Dn(typeof n.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),a=n.overlays):a=new wa,{controls:i,interactions:s,keyboardEventTarget:e,overlays:a,values:t}}const X2="units",LH=[1,2,5],Bg=25.4/.28;class OH extends Hv{constructor(e){e=e||{};const t=document.createElement("div");t.style.pointerEvents="none",super({element:t,render:e.render,target:e.target}),this.on,this.once,this.un;const r=e.className!==void 0?e.className:e.bar?"ol-scale-bar":"ol-scale-line";this.innerElement_=document.createElement("div"),this.innerElement_.className=r+"-inner",this.element.className=r+" "+Yp,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=e.minWidth!==void 0?e.minWidth:64,this.maxWidth_=e.maxWidth,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",this.addChangeListener(X2,this.handleUnitsChanged_),this.setUnits(e.units||"metric"),this.scaleBar_=e.bar||!1,this.scaleBarSteps_=e.steps||4,this.scaleBarText_=e.text||!1,this.dpi_=e.dpi||void 0}getUnits(){return this.get(X2)}handleUnitsChanged_(){this.updateElement_()}setUnits(e){this.set(X2,e)}setDpi(e){this.dpi_=e}updateElement_(){const e=this.viewState_;if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=e.center,r=e.projection,i=this.getUnits(),s=i=="degrees"?"degrees":"m";let a=sx(r,e.resolution,t,s);const o=this.minWidth_*(this.dpi_||Bg)/Bg,l=this.maxWidth_!==void 0?this.maxWidth_*(this.dpi_||Bg)/Bg:void 0;let u=o*a,h="";if(i=="degrees"){const I=c0.degrees;u*=I,u<I/60?(h="",a*=3600):u<I?(h="",a*=60):h=""}else if(i=="imperial")u<.9144?(h="in",a/=.0254):u<1609.344?(h="ft",a/=.3048):(h="mi",a/=1609.344);else if(i=="nautical")a/=1852,h="NM";else if(i=="metric")u<1e-6?(h="nm",a*=1e9):u<.001?(h="m",a*=1e6):u<1?(h="mm",a*=1e3):u<1e3?h="m":(h="km",a/=1e3);else if(i=="us")u<.9144?(h="in",a*=39.37):u<1609.344?(h="ft",a/=.30480061):(h="mi",a/=1609.3472);else throw new Error("Invalid units");let f=3*Math.floor(Math.log(o*a)/Math.log(10)),g,y,v,x=0,E,T;for(;;){v=Math.floor(f/3);const I=Math.pow(10,v);if(g=LH[(f%3+3)%3]*I,y=Math.round(g/a),isNaN(y)){this.element.style.display="none",this.renderedVisible_=!1;return}if(l!==void 0&&y>=l){g=x,y=E,v=T;break}else if(y>=o)break;x=g,E=y,T=v,++f}const b=this.scaleBar_?this.createScaleBar(y,g,h):g.toFixed(v<0?-v:0)+" "+h;this.renderedHTML_!=b&&(this.innerElement_.innerHTML=b,this.renderedHTML_=b),this.renderedWidth_!=y&&(this.innerElement_.style.width=y+"px",this.renderedWidth_=y),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}createScaleBar(e,t,r){const i=this.getScaleForResolution(),s=i<1?Math.round(1/i).toLocaleString()+" : 1":"1 : "+Math.round(i).toLocaleString(),a=this.scaleBarSteps_,o=e/a,l=[this.createMarker("absolute")];for(let h=0;h<a;++h){const f=h%2===0?"ol-scale-singlebar-odd":"ol-scale-singlebar-even";l.push(`<div><div class="ol-scale-singlebar ${f}" style="width: ${o}px;"></div>`+this.createMarker("relative")+(h%2===0||a===2?this.createStepText(h,e,!1,t,r):"")+"</div>")}return l.push(this.createStepText(a,e,!0,t,r)),(this.scaleBarText_?`<div class="ol-scale-text" style="width: ${e}px;">`+s+"</div>":"")+l.join("")}createMarker(e){return`<div class="ol-scale-step-marker" style="position: ${e}; top: ${e==="absolute"?3:-10}px;"></div>`}createStepText(e,t,r,i,s){const o=(e===0?0:Math.round(i/this.scaleBarSteps_*e*100)/100)+(e===0?"":" "+s),l=e===0?-3:t/this.scaleBarSteps_*-1,u=e===0?0:t/this.scaleBarSteps_*2;return`<div class="ol-scale-step-text" style="margin-left: ${l}px;text-align: ${e===0?"left":"center"};min-width: ${u}px;left: ${r?t+"px":"unset"};">`+o+"</div>"}getScaleForResolution(){const e=sx(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,"m"),t=this.dpi_||Bg,r=1e3/25.4;return e*r*t}render(e){const t=e.frameState;t?this.viewState_=t.viewState:this.viewState_=null,this.updateElement_()}}const DH={},D4=n=>{let e;const t=new Set,r=(h,f)=>{const g=typeof h=="function"?h(e):h;if(!Object.is(g,e)){const y=e;e=f??(typeof g!="object"||g===null)?g:Object.assign({},e,g),t.forEach(v=>v(e,y))}},i=()=>e,l={setState:r,getState:i,getInitialState:()=>u,subscribe:h=>(t.add(h),()=>t.delete(h)),destroy:()=>{(DH?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},u=e=n(r,i,l);return l},FH=n=>n?D4(n):D4;var q2={exports:{}},Z2={},Q2={exports:{}},J2={};var F4;function jH(){if(F4)return J2;F4=1;var n=Vp();function e(f,g){return f===g&&(f!==0||1/f===1/g)||f!==f&&g!==g}var t=typeof Object.is=="function"?Object.is:e,r=n.useState,i=n.useEffect,s=n.useLayoutEffect,a=n.useDebugValue;function o(f,g){var y=g(),v=r({inst:{value:y,getSnapshot:g}}),x=v[0].inst,E=v[1];return s(function(){x.value=y,x.getSnapshot=g,l(x)&&E({inst:x})},[f,y,g]),i(function(){return l(x)&&E({inst:x}),f(function(){l(x)&&E({inst:x})})},[f]),a(y),y}function l(f){var g=f.getSnapshot;f=f.value;try{var y=g();return!t(f,y)}catch{return!0}}function u(f,g){return g()}var h=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?u:o;return J2.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:h,J2}var j4;function VH(){return j4||(j4=1,Q2.exports=jH()),Q2.exports}var V4;function GH(){if(V4)return Z2;V4=1;var n=Vp(),e=VH();function t(u,h){return u===h&&(u!==0||1/u===1/h)||u!==u&&h!==h}var r=typeof Object.is=="function"?Object.is:t,i=e.useSyncExternalStore,s=n.useRef,a=n.useEffect,o=n.useMemo,l=n.useDebugValue;return Z2.useSyncExternalStoreWithSelector=function(u,h,f,g,y){var v=s(null);if(v.current===null){var x={hasValue:!1,value:null};v.current=x}else x=v.current;v=o(function(){function T(z){if(!b){if(b=!0,I=z,z=g(z),y!==void 0&&x.hasValue){var P=x.value;if(y(P,z))return M=P}return M=z}if(P=M,r(I,z))return P;var C=g(z);return y!==void 0&&y(P,C)?(I=z,P):(I=z,M=C)}var b=!1,I,M,F=f===void 0?null:f;return[function(){return T(h())},F===null?void 0:function(){return T(F())}]},[h,f,g,y]);var E=i(u,v[0],v[1]);return a(function(){x.hasValue=!0,x.value=E},[E]),l(E),E},Z2}var G4;function BH(){return G4||(G4=1,q2.exports=GH()),q2.exports}var UH=BH();const zH=Kb(UH),xD={},{useDebugValue:$H}=jB,{useSyncExternalStoreWithSelector:WH}=zH;let B4=!1;const HH=n=>n;function KH(n,e=HH,t){(xD?"production":void 0)!=="production"&&t&&!B4&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),B4=!0);const r=WH(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return $H(r),r}const YH=n=>{(xD?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?FH(n):n,t=(r,i)=>KH(e,r,i);return Object.assign(t,e),t},sa=n=>YH;var vD=Symbol.for("immer-nothing"),U4=Symbol.for("immer-draftable"),ta=Symbol.for("immer-state");function Xa(n,...e){throw new Error(`[Immer] minified error nr: ${n}. Full error at: https://bit.ly/3cXEKWf`)}var rp=Object.getPrototypeOf;function f0(n){return!!n&&!!n[ta]}function Bh(n){return n?wD(n)||Array.isArray(n)||!!n[U4]||!!n.constructor?.[U4]||t1(n)||Yv(n):!1}var XH=Object.prototype.constructor.toString(),z4=new WeakMap;function wD(n){if(!n||typeof n!="object")return!1;const e=Object.getPrototypeOf(n);if(e===null||e===Object.prototype)return!0;const t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(t===Object)return!0;if(typeof t!="function")return!1;let r=z4.get(t);return r===void 0&&(r=Function.toString.call(t),z4.set(t,r)),r===XH}function yx(n,e,t=!0){Kv(n)===0?(t?Reflect.ownKeys(n):Object.keys(n)).forEach(i=>{e(i,n[i],n)}):n.forEach((r,i)=>e(i,r,n))}function Kv(n){const e=n[ta];return e?e.type_:Array.isArray(n)?1:t1(n)?2:Yv(n)?3:0}function xT(n,e){return Kv(n)===2?n.has(e):Object.prototype.hasOwnProperty.call(n,e)}function ED(n,e,t){const r=Kv(n);r===2?n.set(e,t):r===3?n.add(t):n[e]=t}function qH(n,e){return n===e?n!==0||1/n===1/e:n!==n&&e!==e}function t1(n){return n instanceof Map}function Yv(n){return n instanceof Set}function ih(n){return n.copy_||n.base_}function vT(n,e){if(t1(n))return new Map(n);if(Yv(n))return new Set(n);if(Array.isArray(n))return Array.prototype.slice.call(n);const t=wD(n);if(e===!0||e==="class_only"&&!t){const r=Object.getOwnPropertyDescriptors(n);delete r[ta];let i=Reflect.ownKeys(r);for(let s=0;s<i.length;s++){const a=i[s],o=r[a];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(r[a]={configurable:!0,writable:!0,enumerable:o.enumerable,value:n[a]})}return Object.create(rp(n),r)}else{const r=rp(n);if(r!==null&&t)return{...n};const i=Object.create(r);return Object.assign(i,n)}}function NI(n,e=!1){return Xv(n)||f0(n)||!Bh(n)||(Kv(n)>1&&Object.defineProperties(n,{set:Xy,add:Xy,clear:Xy,delete:Xy}),Object.freeze(n),e&&Object.values(n).forEach(t=>NI(t,!0))),n}function ZH(){Xa(2)}var Xy={value:ZH};function Xv(n){return n===null||typeof n!="object"?!0:Object.isFrozen(n)}var QH={};function Uh(n){const e=QH[n];return e||Xa(0,n),e}var ip;function SD(){return ip}function JH(n,e){return{drafts_:[],parent_:n,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function $4(n,e){e&&(Uh("Patches"),n.patches_=[],n.inversePatches_=[],n.patchListener_=e)}function wT(n){ET(n),n.drafts_.forEach(eK),n.drafts_=null}function ET(n){n===ip&&(ip=n.parent_)}function W4(n){return ip=JH(ip,n)}function eK(n){const e=n[ta];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function H4(n,e){e.unfinalizedDrafts_=e.drafts_.length;const t=e.drafts_[0];return n!==void 0&&n!==t?(t[ta].modified_&&(wT(e),Xa(4)),Bh(n)&&(n=_x(e,n),e.parent_||xx(e,n)),e.patches_&&Uh("Patches").generateReplacementPatches_(t[ta].base_,n,e.patches_,e.inversePatches_)):n=_x(e,t,[]),wT(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),n!==vD?n:void 0}function _x(n,e,t){if(Xv(e))return e;const r=n.immer_.shouldUseStrictIteration(),i=e[ta];if(!i)return yx(e,(s,a)=>K4(n,i,e,s,a,t),r),e;if(i.scope_!==n)return e;if(!i.modified_)return xx(n,i.base_,!0),i.base_;if(!i.finalized_){i.finalized_=!0,i.scope_.unfinalizedDrafts_--;const s=i.copy_;let a=s,o=!1;i.type_===3&&(a=new Set(s),s.clear(),o=!0),yx(a,(l,u)=>K4(n,i,s,l,u,t,o),r),xx(n,s,!1),t&&n.patches_&&Uh("Patches").generatePatches_(i,t,n.patches_,n.inversePatches_)}return i.copy_}function K4(n,e,t,r,i,s,a){if(i==null||typeof i!="object"&&!a)return;const o=Xv(i);if(!(o&&!a)){if(f0(i)){const l=s&&e&&e.type_!==3&&!xT(e.assigned_,r)?s.concat(r):void 0,u=_x(n,i,l);if(ED(t,r,u),f0(u))n.canAutoFreeze_=!1;else return}else a&&t.add(i);if(Bh(i)&&!o){if(!n.immer_.autoFreeze_&&n.unfinalizedDrafts_<1||e&&e.base_&&e.base_[r]===i&&o)return;_x(n,i),(!e||!e.scope_.parent_)&&typeof r!="symbol"&&(t1(t)?t.has(r):Object.prototype.propertyIsEnumerable.call(t,r))&&xx(n,i)}}}function xx(n,e,t=!1){!n.parent_&&n.immer_.autoFreeze_&&n.canAutoFreeze_&&NI(e,t)}function tK(n,e){const t=Array.isArray(n),r={type_:t?1:0,scope_:e?e.scope_:SD(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:n,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=r,s=LI;t&&(i=[r],s=sp);const{revoke:a,proxy:o}=Proxy.revocable(i,s);return r.draft_=o,r.revoke_=a,o}var LI={get(n,e){if(e===ta)return n;const t=ih(n);if(!xT(t,e))return nK(n,t,e);const r=t[e];return n.finalized_||!Bh(r)?r:r===eS(n.base_,e)?(tS(n),n.copy_[e]=TT(r,n)):r},has(n,e){return e in ih(n)},ownKeys(n){return Reflect.ownKeys(ih(n))},set(n,e,t){const r=TD(ih(n),e);if(r?.set)return r.set.call(n.draft_,t),!0;if(!n.modified_){const i=eS(ih(n),e),s=i?.[ta];if(s&&s.base_===t)return n.copy_[e]=t,n.assigned_[e]=!1,!0;if(qH(t,i)&&(t!==void 0||xT(n.base_,e)))return!0;tS(n),ST(n)}return n.copy_[e]===t&&(t!==void 0||e in n.copy_)||Number.isNaN(t)&&Number.isNaN(n.copy_[e])||(n.copy_[e]=t,n.assigned_[e]=!0),!0},deleteProperty(n,e){return eS(n.base_,e)!==void 0||e in n.base_?(n.assigned_[e]=!1,tS(n),ST(n)):delete n.assigned_[e],n.copy_&&delete n.copy_[e],!0},getOwnPropertyDescriptor(n,e){const t=ih(n),r=Reflect.getOwnPropertyDescriptor(t,e);return r&&{writable:!0,configurable:n.type_!==1||e!=="length",enumerable:r.enumerable,value:t[e]}},defineProperty(){Xa(11)},getPrototypeOf(n){return rp(n.base_)},setPrototypeOf(){Xa(12)}},sp={};yx(LI,(n,e)=>{sp[n]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});sp.deleteProperty=function(n,e){return sp.set.call(this,n,e,void 0)};sp.set=function(n,e,t){return LI.set.call(this,n[0],e,t,n[0])};function eS(n,e){const t=n[ta];return(t?ih(t):n)[e]}function nK(n,e,t){const r=TD(e,t);return r?"value"in r?r.value:r.get?.call(n.draft_):void 0}function TD(n,e){if(!(e in n))return;let t=rp(n);for(;t;){const r=Object.getOwnPropertyDescriptor(t,e);if(r)return r;t=rp(t)}}function ST(n){n.modified_||(n.modified_=!0,n.parent_&&ST(n.parent_))}function tS(n){n.copy_||(n.copy_=vT(n.base_,n.scope_.immer_.useStrictShallowCopy_))}var rK=class{constructor(n){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,t,r)=>{if(typeof e=="function"&&typeof t!="function"){const s=t;t=e;const a=this;return function(l=s,...u){return a.produce(l,h=>t.call(this,h,...u))}}typeof t!="function"&&Xa(6),r!==void 0&&typeof r!="function"&&Xa(7);let i;if(Bh(e)){const s=W4(this),a=TT(e,void 0);let o=!0;try{i=t(a),o=!1}finally{o?wT(s):ET(s)}return $4(s,r),H4(i,s)}else if(!e||typeof e!="object"){if(i=t(e),i===void 0&&(i=e),i===vD&&(i=void 0),this.autoFreeze_&&NI(i,!0),r){const s=[],a=[];Uh("Patches").generateReplacementPatches_(e,i,s,a),r(s,a)}return i}else Xa(1,e)},this.produceWithPatches=(e,t)=>{if(typeof e=="function")return(a,...o)=>this.produceWithPatches(a,l=>e(l,...o));let r,i;return[this.produce(e,t,(a,o)=>{r=a,i=o}),r,i]},typeof n?.autoFreeze=="boolean"&&this.setAutoFreeze(n.autoFreeze),typeof n?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(n.useStrictShallowCopy),typeof n?.useStrictIteration=="boolean"&&this.setUseStrictIteration(n.useStrictIteration)}createDraft(n){Bh(n)||Xa(8),f0(n)&&(n=iK(n));const e=W4(this),t=TT(n,void 0);return t[ta].isManual_=!0,ET(e),t}finishDraft(n,e){const t=n&&n[ta];(!t||!t.isManual_)&&Xa(9);const{scope_:r}=t;return $4(r,e),H4(void 0,r)}setAutoFreeze(n){this.autoFreeze_=n}setUseStrictShallowCopy(n){this.useStrictShallowCopy_=n}setUseStrictIteration(n){this.useStrictIteration_=n}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(n,e){let t;for(t=e.length-1;t>=0;t--){const i=e[t];if(i.path.length===0&&i.op==="replace"){n=i.value;break}}t>-1&&(e=e.slice(t+1));const r=Uh("Patches").applyPatches_;return f0(n)?r(n,e):this.produce(n,i=>r(i,e))}};function TT(n,e){const t=t1(n)?Uh("MapSet").proxyMap_(n,e):Yv(n)?Uh("MapSet").proxySet_(n,e):tK(n,e);return(e?e.scope_:SD()).drafts_.push(t),t}function iK(n){return f0(n)||Xa(10,n),bD(n)}function bD(n){if(!Bh(n)||Xv(n))return n;const e=n[ta];let t,r=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,t=vT(n,e.scope_.immer_.useStrictShallowCopy_),r=e.scope_.immer_.shouldUseStrictIteration()}else t=vT(n,!0);return yx(t,(i,s)=>{ED(t,i,bD(s))},r),e&&(e.finalized_=!1),t}var sK=new rK,aK=sK.produce;const oK=n=>(e,t,r)=>(r.setState=(i,s,...a)=>{const o=typeof i=="function"?aK(i):i;return e(o,s,...a)},n(r.setState,t,r)),j0=oK,ss=sa()(j0((n,e)=>({tracking:!1,position:null,heading:null,smoothHeading:null,accuracy:null,speed:null,headingSource:null,watchId:null,firstFix:!0,config:{smoothingFactor:.2,minRotationSpeed:8,centerOnUser:!0,animationDuration:100},startTracking:()=>{n(t=>{t.tracking=!0})},stopTracking:()=>{n(t=>{const{watchId:r}=e();r!==null&&navigator.geolocation.clearWatch(r),t.tracking=!1,t.speed=null,t.headingSource=null,t.watchId=null})},updatePosition:t=>{n(r=>{r.position={lat:t.coords.latitude,lng:t.coords.longitude},r.accuracy=t.coords.accuracy,r.speed=t.coords.speed;const i=15,s=.5;if(!(t.coords.accuracy!==null&&t.coords.accuracy<i)){r.headingSource=null;return}if(t.coords.heading!==null&&t.coords.speed!==null&&t.coords.speed>s){r.headingSource="gps";const o=t.coords.heading;e().updateHeading(o,"gps")}else r.headingSource="compass"})},updateHeading:(t,r="compass")=>{n(i=>{const{smoothHeading:s,config:a}=e();if(s===null){i.smoothHeading=t,i.heading=t;return}let o=t-s;o>180&&(o-=360),o<-180&&(o+=360);const l=r==="compass"?5:3;if(Math.abs(o)<l)return;const h=s+o*(r==="gps"?.5:.35);i.smoothHeading=(h+360)%360,i.heading=t})},setSmoothedHeading:t=>{n(r=>{r.smoothHeading=t,r.heading=t})},setWatchId:t=>{n(r=>{r.watchId=t})},resetFirstFix:()=>{n(t=>{t.firstFix=!1})}}))),qv={"TMK 1850":{name:"TMK 1850",factory:async()=>null,immediateLoad:!0,tier:"premium"},"Bonnebladen 1900":{name:"Bonnebladen 1900",factory:async()=>null,immediateLoad:!0,tier:"premium"},"AHN 0.5m":{name:"AHN 0.5m",factory:async()=>{const{createAHNLayerOL:n}=await pt(async()=>{const{createAHNLayerOL:e}=await import("./pdokWMSLayers-BrEaDqEP.js");return{createAHNLayerOL:e}},[]);return n()},immediateLoad:!0},Geomorfologie:{name:"Geomorfologie",factory:async()=>{const{createGeomorfologieLayerOL:n}=await pt(async()=>{const{createGeomorfologieLayerOL:e}=await import("./pdokWMSLayers-BrEaDqEP.js");return{createGeomorfologieLayerOL:e}},[]);return n()},immediateLoad:!0},Bodemkaart:{name:"Bodemkaart",factory:async()=>{const{createBodemkaartLayerOL:n}=await pt(async()=>{const{createBodemkaartLayerOL:e}=await import("./pdokWMSLayers-BrEaDqEP.js");return{createBodemkaartLayerOL:e}},[]);return n()},immediateLoad:!0},IKAW:{name:"IKAW",factory:async()=>{const{createIKAWLayerOL:n}=await pt(async()=>{const{createIKAWLayerOL:e}=await import("./pdokWMSLayers-BrEaDqEP.js");return{createIKAWLayerOL:e}},[]);return n()},immediateLoad:!0},"FAMKE Steentijd":{name:"FAMKE Steentijd",factory:async()=>{const{createFAMKESteentijdLayerOL:n}=await pt(async()=>{const{createFAMKESteentijdLayerOL:e}=await import("./pdokWMSLayers-BrEaDqEP.js");return{createFAMKESteentijdLayerOL:e}},[]);return n()},immediateLoad:!0},"Archeo Landschappen":{name:"Archeo Landschappen",factory:async()=>{const{createArcheoLandschappenLayerOL:n}=await pt(async()=>{const{createArcheoLandschappenLayerOL:e}=await import("./pdokWMSLayers-BrEaDqEP.js");return{createArcheoLandschappenLayerOL:e}},[]);return n()},immediateLoad:!0},Essen:{name:"Essen",factory:async()=>{const{createEssenLayerOL:n}=await pt(async()=>{const{createEssenLayerOL:e}=await import("./pdokWMSLayers-BrEaDqEP.js");return{createEssenLayerOL:e}},[]);return n()},immediateLoad:!0},Rijksmonumenten:{name:"Rijksmonumenten",factory:async()=>{const{createRijksmonumentenLayerOL:n}=await pt(async()=>{const{createRijksmonumentenLayerOL:e}=await import("./pdokWMSLayers-BrEaDqEP.js");return{createRijksmonumentenLayerOL:e}},[]);return n()},immediateLoad:!0},"Archeo Onderzoeken":{name:"Archeo Onderzoeken",factory:async()=>{const{createArcheoOnderzoekenLayerOL:n}=await pt(async()=>{const{createArcheoOnderzoekenLayerOL:e}=await import("./pdokWMSLayers-BrEaDqEP.js");return{createArcheoOnderzoekenLayerOL:e}},[]);return n()},immediateLoad:!0},Werelderfgoed:{name:"Werelderfgoed",factory:async()=>{const{createWerelderfgoedLayerOL:n}=await pt(async()=>{const{createWerelderfgoedLayerOL:e}=await import("./pdokWMSLayers-BrEaDqEP.js");return{createWerelderfgoedLayerOL:e}},[]);return n()},immediateLoad:!0},Terpen:{name:"Terpen",factory:async()=>{const{createTerpenLayerOL:n}=await pt(async()=>{const{createTerpenLayerOL:e}=await import("./terpenOL-XYgFpr4s.js");return{createTerpenLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},Verdedigingslinies:{name:"Verdedigingslinies",factory:async()=>{const{createLiniesLayerOL:n}=await pt(async()=>{const{createLiniesLayerOL:e}=await import("./verdedigingswerkenOL-CD8zQl3S.js");return{createLiniesLayerOL:e}},[]);return n()},immediateLoad:!0},Inundatiegebieden:{name:"Inundatiegebieden",factory:async()=>{const{createInundatiesLayerOL:n}=await pt(async()=>{const{createInundatiesLayerOL:e}=await import("./verdedigingswerkenOL-CD8zQl3S.js");return{createInundatiesLayerOL:e}},[]);return n()},immediateLoad:!0},"Militaire Objecten":{name:"Militaire Objecten",factory:async()=>{const{createMilitaireObjectenLayerOL:n}=await pt(async()=>{const{createMilitaireObjectenLayerOL:e}=await import("./verdedigingswerkenOL-CD8zQl3S.js");return{createMilitaireObjectenLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 800 n.Chr.":{name:"Paleokaart 800 n.Chr.",factory:async()=>{const{createPaleo800ncLayerOL:n}=await pt(async()=>{const{createPaleo800ncLayerOL:e}=await import("./paleokaartOL-ZuAAGHn0.js");return{createPaleo800ncLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 100 n.Chr.":{name:"Paleokaart 100 n.Chr.",factory:async()=>{const{createPaleo100ncLayerOL:n}=await pt(async()=>{const{createPaleo100ncLayerOL:e}=await import("./paleokaartOL-ZuAAGHn0.js");return{createPaleo100ncLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 500 v.Chr.":{name:"Paleokaart 500 v.Chr.",factory:async()=>{const{createPaleo500vcLayerOL:n}=await pt(async()=>{const{createPaleo500vcLayerOL:e}=await import("./paleokaartOL-ZuAAGHn0.js");return{createPaleo500vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 1500 v.Chr.":{name:"Paleokaart 1500 v.Chr.",factory:async()=>{const{createPaleo1500vcLayerOL:n}=await pt(async()=>{const{createPaleo1500vcLayerOL:e}=await import("./paleokaartOL-ZuAAGHn0.js");return{createPaleo1500vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 2750 v.Chr.":{name:"Paleokaart 2750 v.Chr.",factory:async()=>{const{createPaleo2750vcLayerOL:n}=await pt(async()=>{const{createPaleo2750vcLayerOL:e}=await import("./paleokaartOL-ZuAAGHn0.js");return{createPaleo2750vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 5500 v.Chr.":{name:"Paleokaart 5500 v.Chr.",factory:async()=>{const{createPaleo5500vcLayerOL:n}=await pt(async()=>{const{createPaleo5500vcLayerOL:e}=await import("./paleokaartOL-ZuAAGHn0.js");return{createPaleo5500vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Paleokaart 9000 v.Chr.":{name:"Paleokaart 9000 v.Chr.",factory:async()=>{const{createPaleo9000vcLayerOL:n}=await pt(async()=>{const{createPaleo9000vcLayerOL:e}=await import("./paleokaartOL-ZuAAGHn0.js");return{createPaleo9000vcLayerOL:e}},[]);return n()},immediateLoad:!0},"Religieus Erfgoed":{name:"Religieus Erfgoed",factory:async()=>{const{createReligieusErfgoedLayerOL:n}=await pt(async()=>{const{createReligieusErfgoedLayerOL:e}=await import("./religieusErfgoedOL-BXckrEvV.js");return{createReligieusErfgoedLayerOL:e}},[]);return n()},immediateLoad:!0},"AHN4 Hoogtekaart Kleur":{name:"AHN4 Hoogtekaart Kleur",factory:async()=>{const{createAHN4ColorElevationLayerOL:n}=await pt(async()=>{const{createAHN4ColorElevationLayerOL:e}=await import("./hillshadeLayers-0NS9JEdx.js");return{createAHN4ColorElevationLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},"AHN4 Hillshade NL":{name:"AHN4 Hillshade NL",factory:async()=>{const{createAHN4HillshadeLayerOL:n}=await pt(async()=>{const{createAHN4HillshadeLayerOL:e}=await import("./hillshadeLayers-0NS9JEdx.js");return{createAHN4HillshadeLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},"AHN4 Multi-Hillshade NL":{name:"AHN4 Multi-Hillshade NL",factory:async()=>{const{createAHN4MultiHillshadeLayerOL:n}=await pt(async()=>{const{createAHN4MultiHillshadeLayerOL:e}=await import("./hillshadeLayers-0NS9JEdx.js");return{createAHN4MultiHillshadeLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},Gewaspercelen:{name:"Gewaspercelen",factory:async()=>{const{createGewaspercelenLayerOL:n}=await pt(async()=>{const{createGewaspercelenLayerOL:e}=await import("./pdokWMSLayers-BrEaDqEP.js");return{createGewaspercelenLayerOL:e}},[]);return n()},immediateLoad:!0,tier:"premium"},"Kadastrale Grenzen":{name:"Kadastrale Grenzen",factory:async()=>{const{createKadastraleKaartLayerOL:n}=await pt(async()=>{const{createKadastraleKaartLayerOL:e}=await import("./pdokWMSLayers-BrEaDqEP.js");return{createKadastraleKaartLayerOL:e}},[]);return n()},immediateLoad:!0},Scheepswrakken:{name:"Scheepswrakken",factory:async()=>{const{createScheepswrakkenLayerOL:n}=await pt(async()=>{const{createScheepswrakkenLayerOL:e}=await import("./pdokWMSLayers-BrEaDqEP.js");return{createScheepswrakkenLayerOL:e}},[]);return n()},immediateLoad:!0},"Woonheuvels ZH":{name:"Woonheuvels ZH",factory:async()=>{const{createWoonheuvelsLayerOL:n}=await pt(async()=>{const{createWoonheuvelsLayerOL:e}=await import("./pdokWMSLayers-BrEaDqEP.js");return{createWoonheuvelsLayerOL:e}},[]);return n()},immediateLoad:!0},"Romeinse Forten":{name:"Romeinse Forten",factory:async()=>{const{createRomeinseFortenLayerOL:n}=await pt(async()=>{const{createRomeinseFortenLayerOL:e}=await import("./romeinseFortenOL-CduQhRzn.js");return{createRomeinseFortenLayerOL:e}},__vite__mapDeps([0,1]));return n()},immediateLoad:!1},"Romeinse Forten Lijnen":{name:"Romeinse Forten Lijnen",factory:async()=>{const{createRomeinseFortenLijnenLayerOL:n}=await pt(async()=>{const{createRomeinseFortenLijnenLayerOL:e}=await import("./romeinseFortenOL-CduQhRzn.js");return{createRomeinseFortenLijnenLayerOL:e}},__vite__mapDeps([0,1]));return n()},immediateLoad:!1},Windmolens:{name:"Windmolens",factory:async()=>{const{createWindmolensLayerOL:n}=await pt(async()=>{const{createWindmolensLayerOL:e}=await import("./pdokWMSLayers-BrEaDqEP.js");return{createWindmolensLayerOL:e}},[]);return n()},immediateLoad:!0},Erfgoedlijnen:{name:"Erfgoedlijnen",factory:async()=>{const{createErfgoedlijnenLayerOL:n}=await pt(async()=>{const{createErfgoedlijnenLayerOL:e}=await import("./pdokWMSLayers-BrEaDqEP.js");return{createErfgoedlijnenLayerOL:e}},[]);return n()},immediateLoad:!0},"Oude Kernen":{name:"Oude Kernen",factory:async()=>{const{createOudeKernenLayerOL:n}=await pt(async()=>{const{createOudeKernenLayerOL:e}=await import("./pdokWMSLayers-BrEaDqEP.js");return{createOudeKernenLayerOL:e}},[]);return n()},immediateLoad:!0},"Relictenkaart Punten":{name:"Relictenkaart Punten",factory:async()=>{const{createRelictenkaartPuntenLayerOL:n}=await pt(async()=>{const{createRelictenkaartPuntenLayerOL:e}=await import("./pdokWMSLayers-BrEaDqEP.js");return{createRelictenkaartPuntenLayerOL:e}},[]);return n()},immediateLoad:!0},"Relictenkaart Lijnen":{name:"Relictenkaart Lijnen",factory:async()=>{const{createRelictenkaartLijnenLayerOL:n}=await pt(async()=>{const{createRelictenkaartLijnenLayerOL:e}=await import("./pdokWMSLayers-BrEaDqEP.js");return{createRelictenkaartLijnenLayerOL:e}},[]);return n()},immediateLoad:!0},"Relictenkaart Vlakken":{name:"Relictenkaart Vlakken",factory:async()=>{const{createRelictenkaartVlakkenLayerOL:n}=await pt(async()=>{const{createRelictenkaartVlakkenLayerOL:e}=await import("./pdokWMSLayers-BrEaDqEP.js");return{createRelictenkaartVlakkenLayerOL:e}},[]);return n()},immediateLoad:!0},"Verdronken Dorpen":{name:"Verdronken Dorpen",factory:async()=>{const{createVerdronkenDorpenLayerOL:n}=await pt(async()=>{const{createVerdronkenDorpenLayerOL:e}=await import("./pdokWMSLayers-BrEaDqEP.js");return{createVerdronkenDorpenLayerOL:e}},[]);return n()},immediateLoad:!0},"AMK Monumenten":{name:"AMK Monumenten",factory:async()=>{const{createAMKLayerOL:n}=await pt(async()=>{const{createAMKLayerOL:e}=await import("./amkOL-hRRq-Ive.js");return{createAMKLayerOL:e}},__vite__mapDeps([2,3]));return n()},immediateLoad:!1,tier:"premium"},"AMK Romeins":{name:"AMK Romeins",factory:async()=>{const{createAMKRomeinsLayerOL:n}=await pt(async()=>{const{createAMKRomeinsLayerOL:e}=await import("./amkOL-hRRq-Ive.js");return{createAMKRomeinsLayerOL:e}},__vite__mapDeps([2,3]));return n()},immediateLoad:!1,tier:"premium"},"AMK Steentijd":{name:"AMK Steentijd",factory:async()=>{const{createAMKSteentijdLayerOL:n}=await pt(async()=>{const{createAMKSteentijdLayerOL:e}=await import("./amkOL-hRRq-Ive.js");return{createAMKSteentijdLayerOL:e}},__vite__mapDeps([2,3]));return n()},immediateLoad:!1,tier:"premium"},"AMK Vroege ME":{name:"AMK Vroege ME",factory:async()=>{const{createAMKVroegeMELayerOL:n}=await pt(async()=>{const{createAMKVroegeMELayerOL:e}=await import("./amkOL-hRRq-Ive.js");return{createAMKVroegeMELayerOL:e}},__vite__mapDeps([2,3]));return n()},immediateLoad:!1,tier:"premium"},"AMK Late ME":{name:"AMK Late ME",factory:async()=>{const{createAMKLateMELayerOL:n}=await pt(async()=>{const{createAMKLateMELayerOL:e}=await import("./amkOL-hRRq-Ive.js");return{createAMKLateMELayerOL:e}},__vite__mapDeps([2,3]));return n()},immediateLoad:!1,tier:"premium"},"AMK Overig":{name:"AMK Overig",factory:async()=>{const{createAMKOverigLayerOL:n}=await pt(async()=>{const{createAMKOverigLayerOL:e}=await import("./amkOL-hRRq-Ive.js");return{createAMKOverigLayerOL:e}},__vite__mapDeps([2,3]));return n()},immediateLoad:!1,tier:"premium"},"Romeinse wegen (regio)":{name:"Romeinse wegen (regio)",factory:async()=>{const{createRomeinseWegenLayerOL:n}=await pt(async()=>{const{createRomeinseWegenLayerOL:e}=await import("./romeinsOL-C99Oifri.js");return{createRomeinseWegenLayerOL:e}},__vite__mapDeps([4,3]));return n()},immediateLoad:!1},"Romeinse wegen (Wereld)":{name:"Romeinse wegen (Wereld)",factory:async()=>{const{createRomeinseWegenWereldLayerOL:n}=await pt(async()=>{const{createRomeinseWegenWereldLayerOL:e}=await import("./romeinsOL-C99Oifri.js");return{createRomeinseWegenWereldLayerOL:e}},__vite__mapDeps([4,3]));return n()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},Kastelen:{name:"Kastelen",factory:async()=>{const{createKastelenLayerOL:n}=await pt(async()=>{const{createKastelenLayerOL:e}=await import("./kastelenOL-Cgq4BfdT.js");return{createKastelenLayerOL:e}},__vite__mapDeps([5,1]));return n()},immediateLoad:!1},Runes:{name:"Runes",factory:async()=>{const{createRuinesLayerOL:n}=await pt(async()=>{const{createRuinesLayerOL:e}=await import("./ruinesOL-B8a0rT8r.js");return{createRuinesLayerOL:e}},__vite__mapDeps([6,1]));return n()},immediateLoad:!1},Veengebieden:{name:"Veengebieden",factory:async()=>{const{createVeengebiedenLayerOL:n}=await pt(async()=>{const{createVeengebiedenLayerOL:e}=await import("./veengebiedenOL-B_LeGzJj.js");return{createVeengebiedenLayerOL:e}},[]);return n()},immediateLoad:!1},Hunebedden:{name:"Hunebedden",factory:async()=>{const{createHunebeddenLayerOL:n}=await pt(async()=>{const{createHunebeddenLayerOL:e}=await import("./hunebeddenOL-DSQe2qw7.js");return{createHunebeddenLayerOL:e}},__vite__mapDeps([7,1]));return n()},immediateLoad:!1},"UIKAV Punten":{name:"UIKAV Punten",factory:async()=>{const{createUIKAVArcheoPuntenLayerOL:n}=await pt(async()=>{const{createUIKAVArcheoPuntenLayerOL:e}=await import("./uikavArcheoPuntenOL-Co3MnA8h.js");return{createUIKAVArcheoPuntenLayerOL:e}},__vite__mapDeps([8,3,1]));return n()},immediateLoad:!1,tier:"premium"},"UIKAV Vlakken":{name:"UIKAV Vlakken",factory:async()=>{const{createUIKAVVlakkenLayerOL:n}=await pt(async()=>{const{createUIKAVVlakkenLayerOL:e}=await import("./uikavVlakkenOL-PbC0WFT7.js");return{createUIKAVVlakkenLayerOL:e}},__vite__mapDeps([9,3]));return n()},immediateLoad:!1},"UIKAV Buffer":{name:"UIKAV Buffer",factory:async()=>{const{createUIKAVBufferlaagLayerOL:n}=await pt(async()=>{const{createUIKAVBufferlaagLayerOL:e}=await import("./uikavBufferlaagOL-PlIjcn5X.js");return{createUIKAVBufferlaagLayerOL:e}},__vite__mapDeps([10,3]));return n()},immediateLoad:!1},"UIKAV Expert":{name:"UIKAV Expert",factory:async()=>{const{createUIKAVExpertLayerOL:n}=await pt(async()=>{const{createUIKAVExpertLayerOL:e}=await import("./uikavExpertOL-B0oFPklS.js");return{createUIKAVExpertLayerOL:e}},__vite__mapDeps([11,3]));return n()},immediateLoad:!1},"UIKAV Indeling":{name:"UIKAV Indeling",factory:async()=>{const{createUIKAVUiterwaardenLayerOL:n}=await pt(async()=>{const{createUIKAVUiterwaardenLayerOL:e}=await import("./uikavUiterwaardenOL-DPthI7Im.js");return{createUIKAVUiterwaardenLayerOL:e}},__vite__mapDeps([12,3]));return n()},immediateLoad:!1},Speeltuinen:{name:"Speeltuinen",factory:async()=>{const{createSpeeltuinenLayerOL:n}=await pt(async()=>{const{createSpeeltuinenLayerOL:e}=await import("./speeltuinenOL-BGBYRl-q.js");return{createSpeeltuinenLayerOL:e}},__vite__mapDeps([13,3,1]));return n()},immediateLoad:!1},Musea:{name:"Musea",factory:async()=>{const{createMuseaLayerOL:n}=await pt(async()=>{const{createMuseaLayerOL:e}=await import("./museaOL-DMS8OkbZ.js");return{createMuseaLayerOL:e}},__vite__mapDeps([14,3,1]));return n()},immediateLoad:!1},Strandjes:{name:"Strandjes",factory:async()=>{const{createStrandjesLayerOL:n}=await pt(async()=>{const{createStrandjesLayerOL:e}=await import("./strandjesOL-Dz6fNbQW.js");return{createStrandjesLayerOL:e}},__vite__mapDeps([15,3]));return n()},immediateLoad:!1},Parken:{name:"Parken",factory:async()=>{const{createParkenLayerOL:n}=await pt(async()=>{const{createParkenLayerOL:e}=await import("./parkenOL-9WM-OB9q.js");return{createParkenLayerOL:e}},__vite__mapDeps([16,3]));return n()},immediateLoad:!1},Kringloopwinkels:{name:"Kringloopwinkels",factory:async()=>{const{createKringloopwinkelsLayerOL:n}=await pt(async()=>{const{createKringloopwinkelsLayerOL:e}=await import("./kringloopwinkelsOL-C8kbVK2v.js");return{createKringloopwinkelsLayerOL:e}},__vite__mapDeps([17,1]));return n()},immediateLoad:!1},"Fossielen Nederland":{name:"Fossielen Nederland",factory:async()=>{const{createFossielenLayerOL:n}=await pt(async()=>{const{createFossielenLayerOL:e}=await import("./fossielenOL-xHjeIVxE.js");return{createFossielenLayerOL:e}},__vite__mapDeps([18,19,1]));return n()},immediateLoad:!1,tier:"premium"},"Fossielen Belgi":{name:"Fossielen Belgi",factory:async()=>{const{createFossielenBelgieLayerOL:n}=await pt(async()=>{const{createFossielenBelgieLayerOL:e}=await import("./fossielenBelgieOL-BILs619n.js");return{createFossielenBelgieLayerOL:e}},__vite__mapDeps([20,19,1]));return n()},immediateLoad:!1,tier:"premium",regions:["be"]},"Fossielen Duitsland":{name:"Fossielen Duitsland",factory:async()=>{const{createFossielenDuitslandLayerOL:n}=await pt(async()=>{const{createFossielenDuitslandLayerOL:e}=await import("./fossielenDuitslandOL-CFRC0rbi.js");return{createFossielenDuitslandLayerOL:e}},__vite__mapDeps([21,19,1]));return n()},immediateLoad:!1,tier:"premium",regions:["de"]},"Fossielen Frankrijk":{name:"Fossielen Frankrijk",factory:async()=>{const{createFossielenFrankrijkLayerOL:n}=await pt(async()=>{const{createFossielenFrankrijkLayerOL:e}=await import("./fossielenFrankrijkOL-pmuEQXvv.js");return{createFossielenFrankrijkLayerOL:e}},__vite__mapDeps([22,19,1]));return n()},immediateLoad:!1,tier:"premium",regions:["fr"]},"Fossiel Hotspots":{name:"Fossiel Hotspots",factory:async()=>{const{createFossielHotspotsLayerOL:n}=await pt(async()=>{const{createFossielHotspotsLayerOL:e}=await import("./fossielHotspotsOL-B3vqxF4p.js");return{createFossielHotspotsLayerOL:e}},[]);return n()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},"Mineralen Hotspots":{name:"Mineralen Hotspots",factory:async()=>{const{createMineralenHotspotsLayerOL:n}=await pt(async()=>{const{createMineralenHotspotsLayerOL:e}=await import("./mineralenHotspotsOL-C2EypOpx.js");return{createMineralenHotspotsLayerOL:e}},[]);return n()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},Goudrivieren:{name:"Goudrivieren",factory:async()=>{const{createGoudrivierenLayerOL:n}=await pt(async()=>{const{createGoudrivierenLayerOL:e}=await import("./goudrivierenOL-BxfoSBjU.js");return{createGoudrivierenLayerOL:e}},[]);return n()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},Wandelroutes:{name:"Wandelroutes",factory:async()=>{const{createWandelroutesLayer:n}=await pt(async()=>{const{createWandelroutesLayer:e}=await import("./wandelroutesOL-C7D-lB-j.js");return{createWandelroutesLayer:e}},[]);return n()},immediateLoad:!1,tier:"free",regions:["nl","be"]},"WWII Bunkers":{name:"WWII Bunkers",factory:async()=>{const{createBunkersLayerOL:n}=await pt(async()=>{const{createBunkersLayerOL:e}=await import("./bunkersOL-Bk_D376i.js");return{createBunkersLayerOL:e}},__vite__mapDeps([23,1]));return n()},immediateLoad:!1},Grafheuvels:{name:"Grafheuvels",factory:async()=>{const{createGrafheuvelsLayerOL:n}=await pt(async()=>{const{createGrafheuvelsLayerOL:e}=await import("./grafheuvelsOL-CJorVBYH.js");return{createGrafheuvelsLayerOL:e}},__vite__mapDeps([24,1]));return n()},immediateLoad:!1},Slagvelden:{name:"Slagvelden",factory:async()=>{const{createSlagveldenLayerOL:n}=await pt(async()=>{const{createSlagveldenLayerOL:e}=await import("./slagveldenOL-CuYzhhT8.js");return{createSlagveldenLayerOL:e}},__vite__mapDeps([25,1]));return n()},immediateLoad:!1},"Militaire Vliegvelden":{name:"Militaire Vliegvelden",factory:async()=>{const{createVliegveldenLayerOL:n}=await pt(async()=>{const{createVliegveldenLayerOL:e}=await import("./vliegveldenOL-CYlHPkXB.js");return{createVliegveldenLayerOL:e}},[]);return n()},immediateLoad:!1}};function lK(){return Object.values(qv).filter(n=>n.immediateLoad)}const Ji=sa()(j0((n,e)=>({map:null,rotation:0,rotationEnabled:!0,setMap:t=>{n(r=>{r.map=t})},setRotation:t=>{n(r=>{if(r.rotation=t,r.map&&r.rotationEnabled){const i=t*Math.PI/180;r.map.getView().setRotation(i)}})},enableRotation:()=>{n(t=>{t.rotationEnabled=!0})},disableRotation:()=>{n(t=>{t.rotationEnabled=!1,t.rotation=0,t.map&&t.map.getView().animate({rotation:0,duration:500})})}}))),fi=sa()(j0((n,e)=>({visible:{"CartoDB (licht)":!0,OpenStreetMap:!1,Luchtfoto:!1,"Labels Overlay":!1,"TMK 1850":!1,"Bonnebladen 1900":!1,Hunebedden:!1,"FAMKE Steentijd":!1,Grafheuvels:!1,Terpen:!1,"AMK Monumenten":!1,"AMK Romeins":!1,"AMK Steentijd":!1,"AMK Vroege ME":!1,"AMK Late ME":!1,"AMK Overig":!1,"Archeo Onderzoeken":!1,"Romeinse wegen (regio)":!1,"Romeinse wegen (Wereld)":!1,Kastelen:!1,IKAW:!1,"Archeo Landschappen":!1,Essen:!1,Rijksmonumenten:!1,Werelderfgoed:!1,"WWII Bunkers":!1,Slagvelden:!1,"Militaire Vliegvelden":!1,Verdedigingslinies:!1,Inundatiegebieden:!1,"Militaire Objecten":!1,"Paleokaart 800 n.Chr.":!1,"Paleokaart 100 n.Chr.":!1,"Paleokaart 500 v.Chr.":!1,"Paleokaart 1500 v.Chr.":!1,"Paleokaart 2750 v.Chr.":!1,"Paleokaart 5500 v.Chr.":!1,"Paleokaart 9000 v.Chr.":!1,"Religieus Erfgoed":!1,"UIKAV Punten":!1,"UIKAV Vlakken":!1,"UIKAV Buffer":!1,"UIKAV Expert":!1,"UIKAV Indeling":!1,"AHN4 Hoogtekaart Kleur":!1,"AHN4 Hillshade NL":!1,"AHN4 Multi-Hillshade NL":!1,"AHN 0.5m":!1,Veengebieden:!1,Geomorfologie:!1,Bodemkaart:!1,"Fossielen Nederland":!1,"Fossielen Belgi":!1,"Fossielen Duitsland":!1,"Fossielen Frankrijk":!1,Parken:!1,Speeltuinen:!1,Musea:!1,Strandjes:!1,Gewaspercelen:!1,"Kadastrale Grenzen":!1,Scheepswrakken:!1,"Woonheuvels ZH":!1,"Romeinse Forten":!1,Windmolens:!1,Erfgoedlijnen:!1,"Oude Kernen":!1,"Relictenkaart Punten":!1,"Relictenkaart Lijnen":!1,"Relictenkaart Vlakken":!1,"Verdronken Dorpen":!1,"Mijn Vondsten":!0},opacity:{"AHN4 Hoogtekaart Kleur":.85,"AHN4 Hillshade NL":.7,"AHN4 Multi-Hillshade NL":.7,"AHN 0.5m":.7,"TMK 1850":.8,"Bonnebladen 1900":.8,Geomorfologie:.5,Bodemkaart:.6,Veengebieden:.6,IKAW:.5,"Archeo Landschappen":.5,Essen:.6,Terpen:.7,"Paleokaart 9000 v.Chr.":.7,"Paleokaart 5500 v.Chr.":.7,"Paleokaart 2750 v.Chr.":.7,"Paleokaart 1500 v.Chr.":.7,"Paleokaart 500 v.Chr.":.7,"Paleokaart 100 n.Chr.":.7,"Paleokaart 800 n.Chr.":.7,Verdedigingslinies:.7,Inundatiegebieden:.5,"Militaire Objecten":.8,"Religieus Erfgoed":.8,Gewaspercelen:.6,"Kadastrale Grenzen":.7,Erfgoedlijnen:.7,"Oude Kernen":.6,"Relictenkaart Vlakken":.5},loadingState:{},layers:{},toggleLayer:t=>{const r=e(),i=!r.visible[t];n(s=>{s.visible[t]=i}),i&&!r.layers[t]?e().loadLayer(t):r.layers[t]&&r.layers[t].setVisible(i)},setLayerVisibility:(t,r)=>{const i=e();n(s=>{s.visible[t]=r;const a=s.layers[t];a&&a.setVisible(r)}),r&&!i.layers[t]&&e().loadLayer(t)},setLayerOpacity:(t,r)=>{n(i=>{i.opacity[t]=r;const s=i.layers[t];s&&s.setOpacity(r)})},registerLayer:(t,r)=>{n(i=>{i.layers[t]=r,i.loadingState[t]="loaded",i.visible[t]!==void 0&&r.setVisible(i.visible[t]),i.opacity[t]!==void 0&&r.setOpacity(i.opacity[t])})},unregisterLayer:t=>{n(r=>{delete r.layers[t],delete r.loadingState[t]})},loadLayer:async t=>{const r=e();if(r.loadingState[t]==="loading"||r.layers[t])return;const i=qv[t];if(!i){console.warn(` Layer "${t}" not found in registry`);return}const s=Ji.getState().map;if(!s){console.warn(` Cannot load layer "${t}": map not initialized`);return}n(a=>{a.loadingState[t]="loading"}),console.log(` Loading layer: ${t}...`);try{const a=await i.factory();if(!a)throw new Error("Factory returned null");const o=e();a.setVisible(o.visible[t]??!1),o.opacity[t]!==void 0&&a.setOpacity(o.opacity[t]),s.addLayer(a),n(l=>{l.layers[t]=a,l.loadingState[t]="loaded"}),console.log(` Layer loaded: ${t}`)}catch(a){console.error(` Failed to load layer "${t}":`,a),n(o=>{o.loadingState[t]="error"})}}}))),jr=sa()(j0((n,e)=>({layerControlOpen:!1,legendOpen:!1,backgroundsPanelOpen:!1,themesPanelOpen:!1,settingsPanelOpen:!1,infoPanelOpen:!1,presetsPanelOpen:!1,vondstFormOpen:!1,vondstFormLocation:null,vondstFormPhoto:null,vondstDashboardOpen:!1,createLayerModalOpen:!1,addPointModalOpen:!1,addPointModalLayerId:null,addPointModalLocation:null,layerManagerModalOpen:!1,layerDashboardOpen:!1,layerDashboardLayerId:null,collapsedCategories:new Set,closeAllPanels:()=>{n(t=>{t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1})},toggleLayerControl:()=>{n(t=>{t.layerControlOpen=!t.layerControlOpen})},toggleLegend:()=>{n(t=>{t.legendOpen=!t.legendOpen})},toggleBackgroundsPanel:()=>{n(t=>{const r=t.backgroundsPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,r||(t.backgroundsPanelOpen=!0)})},toggleThemesPanel:()=>{n(t=>{const r=t.themesPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,r||(t.themesPanelOpen=!0)})},toggleSettingsPanel:()=>{n(t=>{const r=t.settingsPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,r||(t.settingsPanelOpen=!0)})},toggleInfoPanel:()=>{n(t=>{const r=t.infoPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,r||(t.infoPanelOpen=!0)})},togglePresetsPanel:()=>{n(t=>{const r=t.presetsPanelOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,r||(t.presetsPanelOpen=!0)})},toggleCategory:t=>{n(r=>{r.collapsedCategories.has(t)?r.collapsedCategories.delete(t):r.collapsedCategories.add(t)})},setLayerControlOpen:t=>{n(r=>{r.layerControlOpen=t})},setLegendOpen:t=>{n(r=>{r.legendOpen=t})},openVondstForm:(t,r)=>{n(i=>{i.backgroundsPanelOpen=!1,i.themesPanelOpen=!1,i.settingsPanelOpen=!1,i.infoPanelOpen=!1,i.presetsPanelOpen=!1,i.vondstFormOpen=!0,i.vondstFormLocation=t||null,i.vondstFormPhoto=r||null})},closeVondstForm:()=>{n(t=>{t.vondstFormOpen=!1,t.vondstFormLocation=null,t.vondstFormPhoto=null})},toggleVondstDashboard:()=>{n(t=>{const r=t.vondstDashboardOpen;t.backgroundsPanelOpen=!1,t.themesPanelOpen=!1,t.settingsPanelOpen=!1,t.infoPanelOpen=!1,t.presetsPanelOpen=!1,t.vondstDashboardOpen=!r})},openCreateLayerModal:()=>{n(t=>{t.createLayerModalOpen=!0})},closeCreateLayerModal:()=>{n(t=>{t.createLayerModalOpen=!1})},openAddPointModal:(t,r)=>{n(i=>{i.addPointModalOpen=!0,i.addPointModalLayerId=t,i.addPointModalLocation=r})},closeAddPointModal:()=>{n(t=>{t.addPointModalOpen=!1,t.addPointModalLayerId=null,t.addPointModalLocation=null})},openLayerManagerModal:()=>{n(t=>{t.layerManagerModalOpen=!0})},closeLayerManagerModal:()=>{n(t=>{t.layerManagerModalOpen=!1})},openLayerDashboard:t=>{n(r=>{r.layerDashboardOpen=!0,r.layerDashboardLayerId=t,r.layerManagerModalOpen=!1})},closeLayerDashboard:()=>{n(t=>{t.layerDashboardOpen=!1,t.layerDashboardLayerId=null})}}))),cK=()=>{};var Y4={};const ID=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},uK=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=n[t++],a=n[t++],o=n[t++],l=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=n[t++],a=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},AD={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const s=n[i],a=i+1<n.length,o=a?n[i+1]:0,l=i+2<n.length,u=l?n[i+2]:0,h=s>>2,f=(s&3)<<4|o>>4;let g=(o&15)<<2|u>>6,y=u&63;l||(y=64,a||(g=64)),r.push(t[h],t[f],t[g],t[y])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(ID(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):uK(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const s=t[n.charAt(i++)],o=i<n.length?t[n.charAt(i)]:0;++i;const u=i<n.length?t[n.charAt(i)]:64;++i;const f=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||o==null||u==null||f==null)throw new hK;const g=s<<2|o>>4;if(r.push(g),u!==64){const y=o<<4&240|u>>2;if(r.push(y),f!==64){const v=u<<6&192|f;r.push(v)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class hK extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const dK=function(n){const e=ID(n);return AD.encodeByteArray(e,!0)},vx=function(n){return dK(n).replace(/\./g,"")},RD=function(n){try{return AD.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function CD(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const fK=()=>CD().__FIREBASE_DEFAULTS__,gK=()=>{if(typeof process>"u"||typeof Y4>"u")return;const n=Y4.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},mK=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&RD(n[1]);return e&&JSON.parse(e)},Zv=()=>{try{return cK()||fK()||gK()||mK()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},kD=n=>Zv()?.emulatorHosts?.[n],PD=n=>{const e=kD(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},MD=()=>Zv()?.config,ND=n=>Zv()?.[`_${n}`];class pK{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function dd(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function OI(n){return(await fetch(n,{credentials:"include"})).ok}function LD(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...n};return[vx(JSON.stringify(t)),vx(JSON.stringify(a)),""].join(".")}const pm={};function yK(){const n={prod:[],emulator:[]};for(const e of Object.keys(pm))pm[e]?n.emulator.push(e):n.prod.push(e);return n}function _K(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let X4=!1;function DI(n,e){if(typeof window>"u"||typeof document>"u"||!dd(window.location.host)||pm[n]===e||pm[n]||X4)return;pm[n]=e;function t(g){return`__firebase__banner__${g}`}const r="__firebase__banner",s=yK().prod.length>0;function a(){const g=document.getElementById(r);g&&g.remove()}function o(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function l(g,y){g.setAttribute("width","24"),g.setAttribute("id",y),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function u(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{X4=!0,a()},g}function h(g,y){g.setAttribute("id",y),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function f(){const g=_K(r),y=t("text"),v=document.getElementById(y)||document.createElement("span"),x=t("learnmore"),E=document.getElementById(x)||document.createElement("a"),T=t("preprendIcon"),b=document.getElementById(T)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const I=g.element;o(I),h(E,x);const M=u();l(b,T),I.append(b,v,E,M),document.body.appendChild(I)}s?(v.innerText="Preview backend disconnected.",b.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(b.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,v.innerText="Preview backend running in this workspace."),v.setAttribute("id",y)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}function ii(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function xK(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ii())}function OD(){const n=Zv()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function vK(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function wK(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function EK(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function SK(){const n=ii();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function DD(){return!OD()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function FD(){return!OD()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function jD(){try{return typeof indexedDB=="object"}catch{return!1}}function TK(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(t){e(t)}})}const bK="FirebaseError";class rl extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=bK,Object.setPrototypeOf(this,rl.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,n1.prototype.create)}}class n1{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?IK(s,r):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new rl(i,o,r)}}function IK(n,e){return n.replace(AK,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const AK=/\{\$([^}]+)}/g;function RK(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function zh(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const s=n[i],a=e[i];if(q4(s)&&q4(a)){if(!zh(s,a))return!1}else if(s!==a)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function q4(n){return n!==null&&typeof n=="object"}function r1(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function CK(n,e){const t=new kK(n,e);return t.subscribe.bind(t)}class kK{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");PK(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=nS),i.error===void 0&&(i.error=nS),i.complete===void 0&&(i.complete=nS);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function PK(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function nS(){}function yi(n){return n&&n._delegate?n._delegate:n}class cu{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const sh="[DEFAULT]";class MK{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new pK;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(LK(e))try{this.getOrInitializeService({instanceIdentifier:sh})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=sh){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=sh){return this.instances.has(e)}getOptions(e=sh){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);r===o&&a.resolve(i)}return i}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:NK(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=sh){return this.component?this.component.multipleInstances?e:sh:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function NK(n){return n===sh?void 0:n}function LK(n){return n.instantiationMode==="EAGER"}class OK{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new MK(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var hn;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(hn||(hn={}));const DK={debug:hn.DEBUG,verbose:hn.VERBOSE,info:hn.INFO,warn:hn.WARN,error:hn.ERROR,silent:hn.SILENT},FK=hn.INFO,jK={[hn.DEBUG]:"log",[hn.VERBOSE]:"log",[hn.INFO]:"info",[hn.WARN]:"warn",[hn.ERROR]:"error"},VK=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=jK[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class FI{constructor(e){this.name=e,this._logLevel=FK,this._logHandler=VK,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in hn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?DK[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,hn.DEBUG,...e),this._logHandler(this,hn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,hn.VERBOSE,...e),this._logHandler(this,hn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,hn.INFO,...e),this._logHandler(this,hn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,hn.WARN,...e),this._logHandler(this,hn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,hn.ERROR,...e),this._logHandler(this,hn.ERROR,...e)}}const GK=(n,e)=>e.some(t=>n instanceof t);let Z4,Q4;function BK(){return Z4||(Z4=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function UK(){return Q4||(Q4=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const VD=new WeakMap,bT=new WeakMap,GD=new WeakMap,rS=new WeakMap,jI=new WeakMap;function zK(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",a)},s=()=>{t(tu(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&VD.set(t,n)}).catch(()=>{}),jI.set(e,n),e}function $K(n){if(bT.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",a),n.removeEventListener("abort",a)},s=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",a),n.addEventListener("abort",a)});bT.set(n,e)}let IT={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return bT.get(n);if(e==="objectStoreNames")return n.objectStoreNames||GD.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return tu(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function WK(n){IT=n(IT)}function HK(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(iS(this),e,...t);return GD.set(r,e.sort?e.sort():[e]),tu(r)}:UK().includes(n)?function(...e){return n.apply(iS(this),e),tu(VD.get(this))}:function(...e){return tu(n.apply(iS(this),e))}}function KK(n){return typeof n=="function"?HK(n):(n instanceof IDBTransaction&&$K(n),GK(n,BK())?new Proxy(n,IT):n)}function tu(n){if(n instanceof IDBRequest)return zK(n);if(rS.has(n))return rS.get(n);const e=KK(n);return e!==n&&(rS.set(n,e),jI.set(e,n)),e}const iS=n=>jI.get(n);function YK(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){const a=indexedDB.open(n,e),o=tu(a);return r&&a.addEventListener("upgradeneeded",l=>{r(tu(a.result),l.oldVersion,l.newVersion,tu(a.transaction),l)}),t&&a.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),o.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),o}const XK=["get","getKey","getAll","getAllKeys","count"],qK=["put","add","delete","clear"],sS=new Map;function J4(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(sS.get(e))return sS.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=qK.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||XK.includes(t)))return;const s=async function(a,...o){const l=this.transaction(a,i?"readwrite":"readonly");let u=l.store;return r&&(u=u.index(o.shift())),(await Promise.all([u[t](...o),i&&l.done]))[0]};return sS.set(e,s),s}WK(n=>({...n,get:(e,t,r)=>J4(e,t)||n.get(e,t,r),has:(e,t)=>!!J4(e,t)||n.has(e,t)}));class ZK{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(QK(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function QK(n){return n.getComponent()?.type==="VERSION"}const AT="@firebase/app",eM="0.14.6";const Gl=new FI("@firebase/app"),JK="@firebase/app-compat",eY="@firebase/analytics-compat",tY="@firebase/analytics",nY="@firebase/app-check-compat",rY="@firebase/app-check",iY="@firebase/auth",sY="@firebase/auth-compat",aY="@firebase/database",oY="@firebase/data-connect",lY="@firebase/database-compat",cY="@firebase/functions",uY="@firebase/functions-compat",hY="@firebase/installations",dY="@firebase/installations-compat",fY="@firebase/messaging",gY="@firebase/messaging-compat",mY="@firebase/performance",pY="@firebase/performance-compat",yY="@firebase/remote-config",_Y="@firebase/remote-config-compat",xY="@firebase/storage",vY="@firebase/storage-compat",wY="@firebase/firestore",EY="@firebase/ai",SY="@firebase/firestore-compat",TY="firebase",bY="12.6.0";const RT="[DEFAULT]",IY={[AT]:"fire-core",[JK]:"fire-core-compat",[tY]:"fire-analytics",[eY]:"fire-analytics-compat",[rY]:"fire-app-check",[nY]:"fire-app-check-compat",[iY]:"fire-auth",[sY]:"fire-auth-compat",[aY]:"fire-rtdb",[oY]:"fire-data-connect",[lY]:"fire-rtdb-compat",[cY]:"fire-fn",[uY]:"fire-fn-compat",[hY]:"fire-iid",[dY]:"fire-iid-compat",[fY]:"fire-fcm",[gY]:"fire-fcm-compat",[mY]:"fire-perf",[pY]:"fire-perf-compat",[yY]:"fire-rc",[_Y]:"fire-rc-compat",[xY]:"fire-gcs",[vY]:"fire-gcs-compat",[wY]:"fire-fst",[SY]:"fire-fst-compat",[EY]:"fire-vertex","fire-js":"fire-js",[TY]:"fire-js-all"};const wx=new Map,AY=new Map,CT=new Map;function tM(n,e){try{n.container.addComponent(e)}catch(t){Gl.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function $h(n){const e=n.name;if(CT.has(e))return Gl.debug(`There were multiple attempts to register component ${e}.`),!1;CT.set(e,n);for(const t of wx.values())tM(t,n);for(const t of AY.values())tM(t,n);return!0}function Qv(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function qs(n){return n==null?!1:n.settings!==void 0}const RY={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},nu=new n1("app","Firebase",RY);class CY{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new cu("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw nu.create("app-deleted",{appName:this._name})}}const fd=bY;function BD(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:RT,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw nu.create("bad-app-name",{appName:String(i)});if(t||(t=MD()),!t)throw nu.create("no-options");const s=wx.get(i);if(s){if(zh(t,s.options)&&zh(r,s.config))return s;throw nu.create("duplicate-app",{appName:i})}const a=new OK(i);for(const l of CT.values())a.addComponent(l);const o=new CY(t,r,a);return wx.set(i,o),o}function VI(n=RT){const e=wx.get(n);if(!e&&n===RT&&MD())return BD();if(!e)throw nu.create("no-app",{appName:n});return e}function Go(n,e,t){let r=IY[n]??n;t&&(r+=`-${t}`);const i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){const a=[`Unable to register library "${r}" with version "${e}":`];i&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&a.push("and"),s&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Gl.warn(a.join(" "));return}$h(new cu(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}const kY="firebase-heartbeat-database",PY=1,ap="firebase-heartbeat-store";let aS=null;function UD(){return aS||(aS=YK(kY,PY,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(ap)}catch(t){console.warn(t)}}}}).catch(n=>{throw nu.create("idb-open",{originalErrorMessage:n.message})})),aS}async function MY(n){try{const t=(await UD()).transaction(ap),r=await t.objectStore(ap).get(zD(n));return await t.done,r}catch(e){if(e instanceof rl)Gl.warn(e.message);else{const t=nu.create("idb-get",{originalErrorMessage:e?.message});Gl.warn(t.message)}}}async function nM(n,e){try{const r=(await UD()).transaction(ap,"readwrite");await r.objectStore(ap).put(e,zD(n)),await r.done}catch(t){if(t instanceof rl)Gl.warn(t.message);else{const r=nu.create("idb-set",{originalErrorMessage:t?.message});Gl.warn(r.message)}}}function zD(n){return`${n.name}!${n.options.appId}`}const NY=1024,LY=30;class OY{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new FY(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=rM();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>LY){const i=jY(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Gl.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=rM(),{heartbeatsToSend:t,unsentEntries:r}=DY(this._heartbeatsCache.heartbeats),i=vx(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return Gl.warn(e),""}}}function rM(){return new Date().toISOString().substring(0,10)}function DY(n,e=NY){const t=[];let r=n.slice();for(const i of n){const s=t.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),iM(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),iM(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class FY{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return jD()?TK().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await MY(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return nM(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return nM(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function iM(n){return vx(JSON.stringify({version:2,heartbeats:n})).length}function jY(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function VY(n){$h(new cu("platform-logger",e=>new ZK(e),"PRIVATE")),$h(new cu("heartbeat",e=>new OY(e),"PRIVATE")),Go(AT,eM,n),Go(AT,eM,"esm2020"),Go("fire-js","")}VY("");function $D(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const GY=$D,WD=new n1("auth","Firebase",$D());const Ex=new FI("@firebase/auth");function BY(n,...e){Ex.logLevel<=hn.WARN&&Ex.warn(`Auth (${fd}): ${n}`,...e)}function A_(n,...e){Ex.logLevel<=hn.ERROR&&Ex.error(`Auth (${fd}): ${n}`,...e)}function qo(n,...e){throw BI(n,...e)}function ro(n,...e){return BI(n,...e)}function GI(n,e,t){const r={...GY(),[e]:t};return new n1("auth","Firebase",r).create(e,{appName:n.name})}function ru(n){return GI(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function UY(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&qo(n,"argument-error"),GI(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function BI(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return WD.create(n,...e)}function Ht(n,e,...t){if(!n)throw BI(e,...t)}function Tl(n){const e="INTERNAL ASSERTION FAILED: "+n;throw A_(e),new Error(e)}function Bl(n,e){n||Tl(e)}function kT(){return typeof self<"u"&&self.location?.href||""}function zY(){return sM()==="http:"||sM()==="https:"}function sM(){return typeof self<"u"&&self.location?.protocol||null}function $Y(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(zY()||wK()||"connection"in navigator)?navigator.onLine:!0}function WY(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class i1{constructor(e,t){this.shortDelay=e,this.longDelay=t,Bl(t>e,"Short delay should be less than long delay!"),this.isMobile=xK()||EK()}get(){return $Y()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function UI(n,e){Bl(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class HD{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Tl("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Tl("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Tl("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const HY={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const KY=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],YY=new i1(3e4,6e4);function Jv(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function V0(n,e,t,r,i={}){return KD(n,i,async()=>{let s={},a={};r&&(e==="GET"?a=r:s={body:JSON.stringify(r)});const o=r1({key:n.config.apiKey,...a}).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const u={method:e,headers:l,...s};return vK()||(u.referrerPolicy="no-referrer"),n.emulatorConfig&&dd(n.emulatorConfig.host)&&(u.credentials="include"),HD.fetch()(await XD(n,n.config.apiHost,t,o),u)})}async function KD(n,e,t){n._canInitEmulator=!1;const r={...HY,...e};try{const i=new XY(n),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw qy(n,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const o=s.ok?a.errorMessage:a.error.message,[l,u]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw qy(n,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw qy(n,"email-already-in-use",a);if(l==="USER_DISABLED")throw qy(n,"user-disabled",a);const h=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw GI(n,h,u);qo(n,h)}}catch(i){if(i instanceof rl)throw i;qo(n,"network-request-failed",{message:String(i)})}}async function YD(n,e,t,r,i={}){const s=await V0(n,e,t,r,i);return"mfaPendingCredential"in s&&qo(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function XD(n,e,t,r){const i=`${e}${t}?${r}`,s=n,a=s.config.emulator?UI(n.config,i):`${n.config.apiScheme}://${i}`;return KY.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(a).toString():a}class XY{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(ro(this.auth,"network-request-failed")),YY.get())})}}function qy(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=ro(n,e,r);return i.customData._tokenResponse=t,i}async function qY(n,e){return V0(n,"POST","/v1/accounts:delete",e)}async function Sx(n,e){return V0(n,"POST","/v1/accounts:lookup",e)}function ym(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function ZY(n,e=!1){const t=yi(n),r=await t.getIdToken(e),i=zI(r);Ht(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s?.sign_in_provider;return{claims:i,token:r,authTime:ym(oS(i.auth_time)),issuedAtTime:ym(oS(i.iat)),expirationTime:ym(oS(i.exp)),signInProvider:a||null,signInSecondFactor:s?.sign_in_second_factor||null}}function oS(n){return Number(n)*1e3}function zI(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return A_("JWT malformed, contained fewer than 3 sections"),null;try{const i=RD(t);return i?JSON.parse(i):(A_("Failed to decode base64 JWT payload"),null)}catch(i){return A_("Caught error parsing JWT payload as JSON",i?.toString()),null}}function aM(n){const e=zI(n);return Ht(e,"internal-error"),Ht(typeof e.exp<"u","internal-error"),Ht(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function op(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof rl&&QY(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function QY({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class JY{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class PT{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=ym(this.lastLoginAt),this.creationTime=ym(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Tx(n){const e=n.auth,t=await n.getIdToken(),r=await op(n,Sx(e,{idToken:t}));Ht(r?.users.length,e,"internal-error");const i=r.users[0];n._notifyReloadListener(i);const s=i.providerUserInfo?.length?qD(i.providerUserInfo):[],a=tX(n.providerData,s),o=n.isAnonymous,l=!(n.email&&i.passwordHash)&&!a?.length,u=o?l:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new PT(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(n,h)}async function eX(n){const e=yi(n);await Tx(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function tX(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function qD(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function nX(n,e){const t=await KD(n,{},async()=>{const r=r1({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,a=await XD(n,i,"/v1/token",`key=${s}`),o=await n._getAdditionalHeaders();o["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:o,body:r};return n.emulatorConfig&&dd(n.emulatorConfig.host)&&(l.credentials="include"),HD.fetch()(a,l)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function rX(n,e){return V0(n,"POST","/v2/accounts:revokeToken",Jv(n,e))}class Hf{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ht(e.idToken,"internal-error"),Ht(typeof e.idToken<"u","internal-error"),Ht(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):aM(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Ht(e.length!==0,"internal-error");const t=aM(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Ht(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:s}=await nX(e,t);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:s}=t,a=new Hf;return r&&(Ht(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(Ht(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(Ht(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Hf,this.toJSON())}_performRefresh(){return Tl("not implemented")}}function Rc(n,e){Ht(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Qa{constructor({uid:e,auth:t,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new JY(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new PT(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await op(this,this.stsTokenManager.getToken(this.auth,e));return Ht(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return ZY(this,e)}reload(){return eX(this)}_assign(e){this!==e&&(Ht(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Qa({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Ht(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await Tx(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(qs(this.auth.app))return Promise.reject(ru(this.auth));const e=await this.getIdToken();return await op(this,qY(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,i=t.email??void 0,s=t.phoneNumber??void 0,a=t.photoURL??void 0,o=t.tenantId??void 0,l=t._redirectEventId??void 0,u=t.createdAt??void 0,h=t.lastLoginAt??void 0,{uid:f,emailVerified:g,isAnonymous:y,providerData:v,stsTokenManager:x}=t;Ht(f&&x,e,"internal-error");const E=Hf.fromJSON(this.name,x);Ht(typeof f=="string",e,"internal-error"),Rc(r,e.name),Rc(i,e.name),Ht(typeof g=="boolean",e,"internal-error"),Ht(typeof y=="boolean",e,"internal-error"),Rc(s,e.name),Rc(a,e.name),Rc(o,e.name),Rc(l,e.name),Rc(u,e.name),Rc(h,e.name);const T=new Qa({uid:f,auth:e,email:i,emailVerified:g,displayName:r,isAnonymous:y,photoURL:a,phoneNumber:s,tenantId:o,stsTokenManager:E,createdAt:u,lastLoginAt:h});return v&&Array.isArray(v)&&(T.providerData=v.map(b=>({...b}))),l&&(T._redirectEventId=l),T}static async _fromIdTokenResponse(e,t,r=!1){const i=new Hf;i.updateFromServerResponse(t);const s=new Qa({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await Tx(s),s}static async _fromGetAccountInfoResponse(e,t,r){const i=t.users[0];Ht(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?qD(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!s?.length,o=new Hf;o.updateFromIdToken(r);const l=new Qa({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:a}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new PT(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(l,u),l}}const oM=new Map;function bl(n){Bl(n instanceof Function,"Expected a class definition");let e=oM.get(n);return e?(Bl(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,oM.set(n,e),e)}class ZD{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}ZD.type="NONE";const lM=ZD;function R_(n,e,t){return`firebase:${n}:${e}:${t}`}class Kf{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=R_(this.userKey,i.apiKey,s),this.fullPersistenceKey=R_("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Sx(this.auth,{idToken:e}).catch(()=>{});return t?Qa._fromGetAccountInfoResponse(this.auth,t,e):null}return Qa._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Kf(bl(lM),e,r);const i=(await Promise.all(t.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let s=i[0]||bl(lM);const a=R_(r,e.config.apiKey,e.name);let o=null;for(const u of t)try{const h=await u._get(a);if(h){let f;if(typeof h=="string"){const g=await Sx(e,{idToken:h}).catch(()=>{});if(!g)break;f=await Qa._fromGetAccountInfoResponse(e,g,h)}else f=Qa._fromJSON(e,h);u!==s&&(o=f),s=u;break}}catch{}const l=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new Kf(s,e,r):(s=l[0],o&&await s._set(a,o.toJSON()),await Promise.all(t.map(async u=>{if(u!==s)try{await u._remove(a)}catch{}})),new Kf(s,e,r))}}function cM(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(t6(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(QD(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(r6(e))return"Blackberry";if(i6(e))return"Webos";if(JD(e))return"Safari";if((e.includes("chrome/")||e6(e))&&!e.includes("edge/"))return"Chrome";if(n6(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function QD(n=ii()){return/firefox\//i.test(n)}function JD(n=ii()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function e6(n=ii()){return/crios\//i.test(n)}function t6(n=ii()){return/iemobile/i.test(n)}function n6(n=ii()){return/android/i.test(n)}function r6(n=ii()){return/blackberry/i.test(n)}function i6(n=ii()){return/webos/i.test(n)}function $I(n=ii()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function iX(n=ii()){return $I(n)&&!!window.navigator?.standalone}function sX(){return SK()&&document.documentMode===10}function s6(n=ii()){return $I(n)||n6(n)||i6(n)||r6(n)||/windows phone/i.test(n)||t6(n)}function a6(n,e=[]){let t;switch(n){case"Browser":t=cM(ii());break;case"Worker":t=`${cM(ii())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${fd}/${r}`}class aX{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=s=>new Promise((a,o)=>{try{const l=e(s);a(l)}catch(l){o(l)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function oX(n,e={}){return V0(n,"GET","/v2/passwordPolicy",Jv(n,e))}const lX=6;class cX{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??lX,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class uX{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new uM(this),this.idTokenSubscription=new uM(this),this.beforeStateQueue=new aX(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=WD,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=bl(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Kf.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Sx(this,{idToken:e}),r=await Qa._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(qs(this.app)){const s=this.app.settings.authIdToken;return s?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(a,a))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const s=this.redirectUser?._redirectEventId,a=r?._redirectEventId,o=await this.tryRedirectSignIn(e);(!s||s===a)&&o?.user&&(r=o.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(s){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Ht(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Tx(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=WY()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(qs(this.app))return Promise.reject(ru(this));const t=e?yi(e):null;return t&&Ht(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Ht(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return qs(this.app)?Promise.reject(ru(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return qs(this.app)?Promise.reject(ru(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(bl(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await oX(this),t=new cX(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new n1("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await rX(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&bl(e)||this._popupRedirectResolver;Ht(t,this,"argument-error"),this.redirectPersistenceManager=await Kf.create(this,[bl(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ht(o,this,"internal-error"),o.then(()=>{a||s(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,r,i);return()=>{a=!0,l()}}else{const l=e.addObserver(t);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ht(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=a6(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(qs(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&BY(`Error while retrieving App Check token: ${e.error}`),e?.token}}function s1(n){return yi(n)}class uM{constructor(e){this.auth=e,this.observer=null,this.addObserver=CK(t=>this.observer=t)}get next(){return Ht(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let WI={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function hX(n){WI=n}function dX(n){return WI.loadJS(n)}function fX(){return WI.gapiScript}function gX(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function mX(n,e){const t=Qv(n,"auth");if(t.isInitialized()){const i=t.getImmediate(),s=t.getOptions();if(zh(s,e??{}))return i;qo(i,"already-initialized")}return t.initialize({options:e})}function pX(n,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(bl);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function yX(n,e,t){const r=s1(n);Ht(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=o6(e),{host:a,port:o}=_X(e),l=o===null?"":`:${o}`,u={url:`${s}//${a}${l}/`},h=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){Ht(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Ht(zh(u,r.config.emulator)&&zh(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=u,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,dd(a)?(OI(`${s}//${a}${l}`),DI("Auth",!0)):xX()}function o6(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function _X(n){const e=o6(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:hM(r.substr(s.length+1))}}else{const[s,a]=r.split(":");return{host:s,port:hM(a)}}}function hM(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function xX(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class l6{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Tl("not implemented")}_getIdTokenResponse(e){return Tl("not implemented")}_linkToIdToken(e,t){return Tl("not implemented")}_getReauthenticationResolver(e){return Tl("not implemented")}}async function Yf(n,e){return YD(n,"POST","/v1/accounts:signInWithIdp",Jv(n,e))}const vX="http://localhost";class Wh extends l6{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Wh(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):qo("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...s}=t;if(!r||!i)return null;const a=new Wh(r,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const t=this.buildRequest();return Yf(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Yf(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Yf(e,t)}buildRequest(){const e={requestUri:vX,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=r1(t)}return e}}class HI{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class a1 extends HI{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class jc extends a1{constructor(){super("facebook.com")}static credential(e){return Wh._fromParams({providerId:jc.PROVIDER_ID,signInMethod:jc.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return jc.credentialFromTaggedObject(e)}static credentialFromError(e){return jc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return jc.credential(e.oauthAccessToken)}catch{return null}}}jc.FACEBOOK_SIGN_IN_METHOD="facebook.com";jc.PROVIDER_ID="facebook.com";class Sl extends a1{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Wh._fromParams({providerId:Sl.PROVIDER_ID,signInMethod:Sl.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Sl.credentialFromTaggedObject(e)}static credentialFromError(e){return Sl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Sl.credential(t,r)}catch{return null}}}Sl.GOOGLE_SIGN_IN_METHOD="google.com";Sl.PROVIDER_ID="google.com";class Vc extends a1{constructor(){super("github.com")}static credential(e){return Wh._fromParams({providerId:Vc.PROVIDER_ID,signInMethod:Vc.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Vc.credentialFromTaggedObject(e)}static credentialFromError(e){return Vc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Vc.credential(e.oauthAccessToken)}catch{return null}}}Vc.GITHUB_SIGN_IN_METHOD="github.com";Vc.PROVIDER_ID="github.com";class Gc extends a1{constructor(){super("twitter.com")}static credential(e,t){return Wh._fromParams({providerId:Gc.PROVIDER_ID,signInMethod:Gc.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Gc.credentialFromTaggedObject(e)}static credentialFromError(e){return Gc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return Gc.credential(t,r)}catch{return null}}}Gc.TWITTER_SIGN_IN_METHOD="twitter.com";Gc.PROVIDER_ID="twitter.com";async function wX(n,e){return YD(n,"POST","/v1/accounts:signUp",Jv(n,e))}class uu{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const s=await Qa._fromIdTokenResponse(e,r,i),a=dM(r);return new uu({user:s,providerId:a,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=dM(r);return new uu({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function dM(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}async function EX(n){if(qs(n.app))return Promise.reject(ru(n));const e=s1(n);if(await e._initializationPromise,e.currentUser?.isAnonymous)return new uu({user:e.currentUser,providerId:null,operationType:"signIn"});const t=await wX(e,{returnSecureToken:!0}),r=await uu._fromIdTokenResponse(e,"signIn",t,!0);return await e._updateCurrentUser(r.user),r}class bx extends rl{constructor(e,t,r,i){super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,bx.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new bx(e,t,r,i)}}function c6(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?bx._fromErrorAndOperation(n,s,e,r):s})}async function SX(n,e,t=!1){const r=await op(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return uu._forOperation(n,"link",r)}async function TX(n,e,t=!1){const{auth:r}=n;if(qs(r.app))return Promise.reject(ru(r));const i="reauthenticate";try{const s=await op(n,c6(r,i,e,n),t);Ht(s.idToken,r,"internal-error");const a=zI(s.idToken);Ht(a,r,"internal-error");const{sub:o}=a;return Ht(n.uid===o,r,"user-mismatch"),uu._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&qo(r,"user-mismatch"),s}}async function bX(n,e,t=!1){if(qs(n.app))return Promise.reject(ru(n));const r="signIn",i=await c6(n,r,e),s=await uu._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(s.user),s}function IX(n,e,t,r){return yi(n).onIdTokenChanged(e,t,r)}function AX(n,e,t){return yi(n).beforeAuthStateChanged(e,t)}function u6(n,e,t,r){return yi(n).onAuthStateChanged(e,t,r)}function h6(n){return yi(n).signOut()}const Ix="__sak";class d6{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Ix,"1"),this.storage.removeItem(Ix),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const RX=1e3,CX=10;class f6 extends d6{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=s6(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const r=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(r);!t&&this.localCache[r]===a||this.notifyListeners(r,a)},s=this.storage.getItem(r);sX()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,CX):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},RX)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}f6.type="LOCAL";const kX=f6;class g6 extends d6{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}g6.type="SESSION";const m6=g6;function PX(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class ew{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new ew(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:s}=t.data,a=this.handlersMap[i];if(!a?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const o=Array.from(a).map(async u=>u(t.origin,s)),l=await PX(o);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}ew.receivers=[];function KI(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}class MX{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((o,l)=>{const u=KI("",20);i.port1.start();const h=setTimeout(()=>{l(new Error("unsupported_event"))},r);a={messageChannel:i,onMessage(f){const g=f;if(g.data.eventId===u)switch(g.data.status){case"ack":clearTimeout(h),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),o(g.data.response);break;default:clearTimeout(h),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:u,data:t},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}function Bo(){return window}function NX(n){Bo().location.href=n}function p6(){return typeof Bo().WorkerGlobalScope<"u"&&typeof Bo().importScripts=="function"}async function LX(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function OX(){return navigator?.serviceWorker?.controller||null}function DX(){return p6()?self:null}const y6="firebaseLocalStorageDb",FX=1,Ax="firebaseLocalStorage",_6="fbase_key";class o1{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function tw(n,e){return n.transaction([Ax],e?"readwrite":"readonly").objectStore(Ax)}function jX(){const n=indexedDB.deleteDatabase(y6);return new o1(n).toPromise()}function MT(){const n=indexedDB.open(y6,FX);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(Ax,{keyPath:_6})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(Ax)?e(r):(r.close(),await jX(),e(await MT()))})})}async function fM(n,e,t){const r=tw(n,!0).put({[_6]:e,value:t});return new o1(r).toPromise()}async function VX(n,e){const t=tw(n,!1).get(e),r=await new o1(t).toPromise();return r===void 0?null:r.value}function gM(n,e){const t=tw(n,!0).delete(e);return new o1(t).toPromise()}const GX=800,BX=3;class x6{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await MT(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>BX)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return p6()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ew._getInstance(DX()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await LX(),!this.activeServiceWorker)return;this.sender=new MX(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||OX()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await MT();return await fM(e,Ix,"1"),await gM(e,Ix),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>fM(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>VX(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>gM(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=tw(i,!1).getAll();return new o1(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),GX)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}x6.type="LOCAL";const UX=x6;new i1(3e4,6e4);function v6(n,e){return e?bl(e):(Ht(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class YI extends l6{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Yf(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Yf(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Yf(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function zX(n){return bX(n.auth,new YI(n),n.bypassAuthState)}function $X(n){const{auth:e,user:t}=n;return Ht(t,e,"internal-error"),TX(t,new YI(n),n.bypassAuthState)}async function WX(n){const{auth:e,user:t}=n;return Ht(t,e,"internal-error"),SX(t,new YI(n),n.bypassAuthState)}class w6{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:a,type:o}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return zX;case"linkViaPopup":case"linkViaRedirect":return WX;case"reauthViaPopup":case"reauthViaRedirect":return $X;default:qo(this.auth,"internal-error")}}resolve(e){Bl(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Bl(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const HX=new i1(2e3,1e4);async function KX(n,e,t){if(qs(n.app))return Promise.reject(ro(n,"operation-not-supported-in-this-environment"));const r=s1(n);UY(n,e,HI);const i=v6(r,t);return new wh(r,"signInViaPopup",e,i).executeNotNull()}class wh extends w6{constructor(e,t,r,i,s){super(e,t,i,s),this.provider=r,this.authWindow=null,this.pollId=null,wh.currentPopupAction&&wh.currentPopupAction.cancel(),wh.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ht(e,this.auth,"internal-error"),e}async onExecution(){Bl(this.filter.length===1,"Popup operations only handle one event");const e=KI();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(ro(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(ro(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,wh.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ro(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,HX.get())};e()}}wh.currentPopupAction=null;const YX="pendingRedirect",C_=new Map;class XX extends w6{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=C_.get(this.auth._key());if(!e){try{const r=await qX(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}C_.set(this.auth._key(),e)}return this.bypassAuthState||C_.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function qX(n,e){const t=JX(e),r=QX(n);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}function ZX(n,e){C_.set(n._key(),e)}function QX(n){return bl(n._redirectPersistence)}function JX(n){return R_(YX,n.config.apiKey,n.name)}async function eq(n,e,t=!1){if(qs(n.app))return Promise.reject(ru(n));const r=s1(n),i=v6(r,e),a=await new XX(r,i,t).execute();return a&&!t&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}const tq=600*1e3;class nq{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!rq(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!E6(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(ro(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=tq&&this.cachedEventUids.clear(),this.cachedEventUids.has(mM(e))}saveEventToCache(e){this.cachedEventUids.add(mM(e)),this.lastProcessedEventTime=Date.now()}}function mM(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function E6({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function rq(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return E6(n);default:return!1}}async function iq(n,e={}){return V0(n,"GET","/v1/projects",e)}const sq=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,aq=/^https?/;async function oq(n){if(n.config.emulator)return;const{authorizedDomains:e}=await iq(n);for(const t of e)try{if(lq(t))return}catch{}qo(n,"unauthorized-domain")}function lq(n){const e=kT(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!aq.test(t))return!1;if(sq.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const cq=new i1(3e4,6e4);function pM(){const n=Bo().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function uq(n){return new Promise((e,t)=>{function r(){pM(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{pM(),t(ro(n,"network-request-failed"))},timeout:cq.get()})}if(Bo().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Bo().gapi?.load)r();else{const i=gX("iframefcb");return Bo()[i]=()=>{gapi.load?r():t(ro(n,"network-request-failed"))},dX(`${fX()}?onload=${i}`).catch(s=>t(s))}}).catch(e=>{throw k_=null,e})}let k_=null;function hq(n){return k_=k_||uq(n),k_}const dq=new i1(5e3,15e3),fq="__/auth/iframe",gq="emulator/auth/iframe",mq={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},pq=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function yq(n){const e=n.config;Ht(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?UI(e,gq):`https://${n.config.authDomain}/${fq}`,r={apiKey:e.apiKey,appName:n.name,v:fd},i=pq.get(n.config.apiHost);i&&(r.eid=i);const s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${r1(r).slice(1)}`}async function _q(n){const e=await hq(n),t=Bo().gapi;return Ht(t,n,"internal-error"),e.open({where:document.body,url:yq(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:mq,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const a=ro(n,"network-request-failed"),o=Bo().setTimeout(()=>{s(a)},dq.get());function l(){Bo().clearTimeout(o),i(r)}r.ping(l).then(l,()=>{s(a)})}))}const xq={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},vq=500,wq=600,Eq="_blank",Sq="http://localhost";class yM{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Tq(n,e,t,r=vq,i=wq){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let o="";const l={...xq,width:r.toString(),height:i.toString(),top:s,left:a},u=ii().toLowerCase();t&&(o=e6(u)?Eq:t),QD(u)&&(e=e||Sq,l.scrollbars="yes");const h=Object.entries(l).reduce((g,[y,v])=>`${g}${y}=${v},`,"");if(iX(u)&&o!=="_self")return bq(e||"",o),new yM(null);const f=window.open(e||"",o,h);Ht(f,n,"popup-blocked");try{f.focus()}catch{}return new yM(f)}function bq(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}const Iq="__/auth/handler",Aq="emulator/auth/handler",Rq=encodeURIComponent("fac");async function _M(n,e,t,r,i,s){Ht(n.config.authDomain,n,"auth-domain-config-required"),Ht(n.config.apiKey,n,"invalid-api-key");const a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:fd,eventId:i};if(e instanceof HI){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",RK(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,f]of Object.entries({}))a[h]=f}if(e instanceof a1){const h=e.getScopes().filter(f=>f!=="");h.length>0&&(a.scopes=h.join(","))}n.tenantId&&(a.tid=n.tenantId);const o=a;for(const h of Object.keys(o))o[h]===void 0&&delete o[h];const l=await n._getAppCheckToken(),u=l?`#${Rq}=${encodeURIComponent(l)}`:"";return`${Cq(n)}?${r1(o).slice(1)}${u}`}function Cq({config:n}){return n.emulator?UI(n,Aq):`https://${n.authDomain}/${Iq}`}const lS="webStorageSupport";class kq{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=m6,this._completeRedirectFn=eq,this._overrideRedirectResult=ZX}async _openPopup(e,t,r,i){Bl(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const s=await _M(e,t,r,kT(),i);return Tq(e,s,KI())}async _openRedirect(e,t,r,i){await this._originValidation(e);const s=await _M(e,t,r,kT(),i);return NX(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(Bl(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await _q(e),r=new nq(e);return t.register("authEvent",i=>(Ht(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(lS,{type:lS},i=>{const s=i?.[0]?.[lS];s!==void 0&&t(!!s),qo(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=oq(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return s6()||JD()||$I()}}const Pq=kq;var xM="@firebase/auth",vM="1.12.0";class Mq{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Ht(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function Nq(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Lq(n){$h(new cu("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=r.options;Ht(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:a,authDomain:o,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:a6(n)},u=new uX(r,i,s,l);return pX(u,t),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),$h(new cu("auth-internal",e=>{const t=s1(e.getProvider("auth").getImmediate());return(r=>new Mq(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Go(xM,vM,Nq(n)),Go(xM,vM,"esm2020")}const Oq=300,Dq=ND("authIdTokenMaxAge")||Oq;let wM=null;const Fq=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>Dq)return;const i=t?.token;wM!==i&&(wM=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function jq(n=VI()){const e=Qv(n,"auth");if(e.isInitialized())return e.getImmediate();const t=mX(n,{popupRedirectResolver:Pq,persistence:[UX,kX,m6]}),r=ND("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const a=Fq(s.toString());AX(t,a,()=>a(t.currentUser)),IX(t,o=>a(o))}}const i=kD("auth");return i&&yX(t,`http://${i}`),t}function Vq(){return document.getElementsByTagName("head")?.[0]??document}hX({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{const s=ro("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",Vq().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Lq("Browser");var Gq="firebase",Bq="12.7.0";Go(Gq,Bq,"app");var EM=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var iu,S6;(function(){var n;function e(P,C){function k(){}k.prototype=C.prototype,P.F=C.prototype,P.prototype=new k,P.prototype.constructor=P,P.D=function(L,O,U){for(var j=Array(arguments.length-2),Te=2;Te<arguments.length;Te++)j[Te-2]=arguments[Te];return C.prototype[O].apply(L,j)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(P,C,k){k||(k=0);const L=Array(16);if(typeof C=="string")for(var O=0;O<16;++O)L[O]=C.charCodeAt(k++)|C.charCodeAt(k++)<<8|C.charCodeAt(k++)<<16|C.charCodeAt(k++)<<24;else for(O=0;O<16;++O)L[O]=C[k++]|C[k++]<<8|C[k++]<<16|C[k++]<<24;C=P.g[0],k=P.g[1],O=P.g[2];let U=P.g[3],j;j=C+(U^k&(O^U))+L[0]+3614090360&4294967295,C=k+(j<<7&4294967295|j>>>25),j=U+(O^C&(k^O))+L[1]+3905402710&4294967295,U=C+(j<<12&4294967295|j>>>20),j=O+(k^U&(C^k))+L[2]+606105819&4294967295,O=U+(j<<17&4294967295|j>>>15),j=k+(C^O&(U^C))+L[3]+3250441966&4294967295,k=O+(j<<22&4294967295|j>>>10),j=C+(U^k&(O^U))+L[4]+4118548399&4294967295,C=k+(j<<7&4294967295|j>>>25),j=U+(O^C&(k^O))+L[5]+1200080426&4294967295,U=C+(j<<12&4294967295|j>>>20),j=O+(k^U&(C^k))+L[6]+2821735955&4294967295,O=U+(j<<17&4294967295|j>>>15),j=k+(C^O&(U^C))+L[7]+4249261313&4294967295,k=O+(j<<22&4294967295|j>>>10),j=C+(U^k&(O^U))+L[8]+1770035416&4294967295,C=k+(j<<7&4294967295|j>>>25),j=U+(O^C&(k^O))+L[9]+2336552879&4294967295,U=C+(j<<12&4294967295|j>>>20),j=O+(k^U&(C^k))+L[10]+4294925233&4294967295,O=U+(j<<17&4294967295|j>>>15),j=k+(C^O&(U^C))+L[11]+2304563134&4294967295,k=O+(j<<22&4294967295|j>>>10),j=C+(U^k&(O^U))+L[12]+1804603682&4294967295,C=k+(j<<7&4294967295|j>>>25),j=U+(O^C&(k^O))+L[13]+4254626195&4294967295,U=C+(j<<12&4294967295|j>>>20),j=O+(k^U&(C^k))+L[14]+2792965006&4294967295,O=U+(j<<17&4294967295|j>>>15),j=k+(C^O&(U^C))+L[15]+1236535329&4294967295,k=O+(j<<22&4294967295|j>>>10),j=C+(O^U&(k^O))+L[1]+4129170786&4294967295,C=k+(j<<5&4294967295|j>>>27),j=U+(k^O&(C^k))+L[6]+3225465664&4294967295,U=C+(j<<9&4294967295|j>>>23),j=O+(C^k&(U^C))+L[11]+643717713&4294967295,O=U+(j<<14&4294967295|j>>>18),j=k+(U^C&(O^U))+L[0]+3921069994&4294967295,k=O+(j<<20&4294967295|j>>>12),j=C+(O^U&(k^O))+L[5]+3593408605&4294967295,C=k+(j<<5&4294967295|j>>>27),j=U+(k^O&(C^k))+L[10]+38016083&4294967295,U=C+(j<<9&4294967295|j>>>23),j=O+(C^k&(U^C))+L[15]+3634488961&4294967295,O=U+(j<<14&4294967295|j>>>18),j=k+(U^C&(O^U))+L[4]+3889429448&4294967295,k=O+(j<<20&4294967295|j>>>12),j=C+(O^U&(k^O))+L[9]+568446438&4294967295,C=k+(j<<5&4294967295|j>>>27),j=U+(k^O&(C^k))+L[14]+3275163606&4294967295,U=C+(j<<9&4294967295|j>>>23),j=O+(C^k&(U^C))+L[3]+4107603335&4294967295,O=U+(j<<14&4294967295|j>>>18),j=k+(U^C&(O^U))+L[8]+1163531501&4294967295,k=O+(j<<20&4294967295|j>>>12),j=C+(O^U&(k^O))+L[13]+2850285829&4294967295,C=k+(j<<5&4294967295|j>>>27),j=U+(k^O&(C^k))+L[2]+4243563512&4294967295,U=C+(j<<9&4294967295|j>>>23),j=O+(C^k&(U^C))+L[7]+1735328473&4294967295,O=U+(j<<14&4294967295|j>>>18),j=k+(U^C&(O^U))+L[12]+2368359562&4294967295,k=O+(j<<20&4294967295|j>>>12),j=C+(k^O^U)+L[5]+4294588738&4294967295,C=k+(j<<4&4294967295|j>>>28),j=U+(C^k^O)+L[8]+2272392833&4294967295,U=C+(j<<11&4294967295|j>>>21),j=O+(U^C^k)+L[11]+1839030562&4294967295,O=U+(j<<16&4294967295|j>>>16),j=k+(O^U^C)+L[14]+4259657740&4294967295,k=O+(j<<23&4294967295|j>>>9),j=C+(k^O^U)+L[1]+2763975236&4294967295,C=k+(j<<4&4294967295|j>>>28),j=U+(C^k^O)+L[4]+1272893353&4294967295,U=C+(j<<11&4294967295|j>>>21),j=O+(U^C^k)+L[7]+4139469664&4294967295,O=U+(j<<16&4294967295|j>>>16),j=k+(O^U^C)+L[10]+3200236656&4294967295,k=O+(j<<23&4294967295|j>>>9),j=C+(k^O^U)+L[13]+681279174&4294967295,C=k+(j<<4&4294967295|j>>>28),j=U+(C^k^O)+L[0]+3936430074&4294967295,U=C+(j<<11&4294967295|j>>>21),j=O+(U^C^k)+L[3]+3572445317&4294967295,O=U+(j<<16&4294967295|j>>>16),j=k+(O^U^C)+L[6]+76029189&4294967295,k=O+(j<<23&4294967295|j>>>9),j=C+(k^O^U)+L[9]+3654602809&4294967295,C=k+(j<<4&4294967295|j>>>28),j=U+(C^k^O)+L[12]+3873151461&4294967295,U=C+(j<<11&4294967295|j>>>21),j=O+(U^C^k)+L[15]+530742520&4294967295,O=U+(j<<16&4294967295|j>>>16),j=k+(O^U^C)+L[2]+3299628645&4294967295,k=O+(j<<23&4294967295|j>>>9),j=C+(O^(k|~U))+L[0]+4096336452&4294967295,C=k+(j<<6&4294967295|j>>>26),j=U+(k^(C|~O))+L[7]+1126891415&4294967295,U=C+(j<<10&4294967295|j>>>22),j=O+(C^(U|~k))+L[14]+2878612391&4294967295,O=U+(j<<15&4294967295|j>>>17),j=k+(U^(O|~C))+L[5]+4237533241&4294967295,k=O+(j<<21&4294967295|j>>>11),j=C+(O^(k|~U))+L[12]+1700485571&4294967295,C=k+(j<<6&4294967295|j>>>26),j=U+(k^(C|~O))+L[3]+2399980690&4294967295,U=C+(j<<10&4294967295|j>>>22),j=O+(C^(U|~k))+L[10]+4293915773&4294967295,O=U+(j<<15&4294967295|j>>>17),j=k+(U^(O|~C))+L[1]+2240044497&4294967295,k=O+(j<<21&4294967295|j>>>11),j=C+(O^(k|~U))+L[8]+1873313359&4294967295,C=k+(j<<6&4294967295|j>>>26),j=U+(k^(C|~O))+L[15]+4264355552&4294967295,U=C+(j<<10&4294967295|j>>>22),j=O+(C^(U|~k))+L[6]+2734768916&4294967295,O=U+(j<<15&4294967295|j>>>17),j=k+(U^(O|~C))+L[13]+1309151649&4294967295,k=O+(j<<21&4294967295|j>>>11),j=C+(O^(k|~U))+L[4]+4149444226&4294967295,C=k+(j<<6&4294967295|j>>>26),j=U+(k^(C|~O))+L[11]+3174756917&4294967295,U=C+(j<<10&4294967295|j>>>22),j=O+(C^(U|~k))+L[2]+718787259&4294967295,O=U+(j<<15&4294967295|j>>>17),j=k+(U^(O|~C))+L[9]+3951481745&4294967295,P.g[0]=P.g[0]+C&4294967295,P.g[1]=P.g[1]+(O+(j<<21&4294967295|j>>>11))&4294967295,P.g[2]=P.g[2]+O&4294967295,P.g[3]=P.g[3]+U&4294967295}r.prototype.v=function(P,C){C===void 0&&(C=P.length);const k=C-this.blockSize,L=this.C;let O=this.h,U=0;for(;U<C;){if(O==0)for(;U<=k;)i(this,P,U),U+=this.blockSize;if(typeof P=="string"){for(;U<C;)if(L[O++]=P.charCodeAt(U++),O==this.blockSize){i(this,L),O=0;break}}else for(;U<C;)if(L[O++]=P[U++],O==this.blockSize){i(this,L),O=0;break}}this.h=O,this.o+=C},r.prototype.A=function(){var P=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);P[0]=128;for(var C=1;C<P.length-8;++C)P[C]=0;C=this.o*8;for(var k=P.length-8;k<P.length;++k)P[k]=C&255,C/=256;for(this.v(P),P=Array(16),C=0,k=0;k<4;++k)for(let L=0;L<32;L+=8)P[C++]=this.g[k]>>>L&255;return P};function s(P,C){var k=o;return Object.prototype.hasOwnProperty.call(k,P)?k[P]:k[P]=C(P)}function a(P,C){this.h=C;const k=[];let L=!0;for(let O=P.length-1;O>=0;O--){const U=P[O]|0;L&&U==C||(k[O]=U,L=!1)}this.g=k}var o={};function l(P){return-128<=P&&P<128?s(P,function(C){return new a([C|0],C<0?-1:0)}):new a([P|0],P<0?-1:0)}function u(P){if(isNaN(P)||!isFinite(P))return f;if(P<0)return E(u(-P));const C=[];let k=1;for(let L=0;P>=k;L++)C[L]=P/k|0,k*=4294967296;return new a(C,0)}function h(P,C){if(P.length==0)throw Error("number format error: empty string");if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(P.charAt(0)=="-")return E(h(P.substring(1),C));if(P.indexOf("-")>=0)throw Error('number format error: interior "-" character');const k=u(Math.pow(C,8));let L=f;for(let U=0;U<P.length;U+=8){var O=Math.min(8,P.length-U);const j=parseInt(P.substring(U,U+O),C);O<8?(O=u(Math.pow(C,O)),L=L.j(O).add(u(j))):(L=L.j(k),L=L.add(u(j)))}return L}var f=l(0),g=l(1),y=l(16777216);n=a.prototype,n.m=function(){if(x(this))return-E(this).m();let P=0,C=1;for(let k=0;k<this.g.length;k++){const L=this.i(k);P+=(L>=0?L:4294967296+L)*C,C*=4294967296}return P},n.toString=function(P){if(P=P||10,P<2||36<P)throw Error("radix out of range: "+P);if(v(this))return"0";if(x(this))return"-"+E(this).toString(P);const C=u(Math.pow(P,6));var k=this;let L="";for(;;){const O=M(k,C).g;k=T(k,O.j(C));let U=((k.g.length>0?k.g[0]:k.h)>>>0).toString(P);if(k=O,v(k))return U+L;for(;U.length<6;)U="0"+U;L=U+L}},n.i=function(P){return P<0?0:P<this.g.length?this.g[P]:this.h};function v(P){if(P.h!=0)return!1;for(let C=0;C<P.g.length;C++)if(P.g[C]!=0)return!1;return!0}function x(P){return P.h==-1}n.l=function(P){return P=T(this,P),x(P)?-1:v(P)?0:1};function E(P){const C=P.g.length,k=[];for(let L=0;L<C;L++)k[L]=~P.g[L];return new a(k,~P.h).add(g)}n.abs=function(){return x(this)?E(this):this},n.add=function(P){const C=Math.max(this.g.length,P.g.length),k=[];let L=0;for(let O=0;O<=C;O++){let U=L+(this.i(O)&65535)+(P.i(O)&65535),j=(U>>>16)+(this.i(O)>>>16)+(P.i(O)>>>16);L=j>>>16,U&=65535,j&=65535,k[O]=j<<16|U}return new a(k,k[k.length-1]&-2147483648?-1:0)};function T(P,C){return P.add(E(C))}n.j=function(P){if(v(this)||v(P))return f;if(x(this))return x(P)?E(this).j(E(P)):E(E(this).j(P));if(x(P))return E(this.j(E(P)));if(this.l(y)<0&&P.l(y)<0)return u(this.m()*P.m());const C=this.g.length+P.g.length,k=[];for(var L=0;L<2*C;L++)k[L]=0;for(L=0;L<this.g.length;L++)for(let O=0;O<P.g.length;O++){const U=this.i(L)>>>16,j=this.i(L)&65535,Te=P.i(O)>>>16,Ce=P.i(O)&65535;k[2*L+2*O]+=j*Ce,b(k,2*L+2*O),k[2*L+2*O+1]+=U*Ce,b(k,2*L+2*O+1),k[2*L+2*O+1]+=j*Te,b(k,2*L+2*O+1),k[2*L+2*O+2]+=U*Te,b(k,2*L+2*O+2)}for(P=0;P<C;P++)k[P]=k[2*P+1]<<16|k[2*P];for(P=C;P<2*C;P++)k[P]=0;return new a(k,0)};function b(P,C){for(;(P[C]&65535)!=P[C];)P[C+1]+=P[C]>>>16,P[C]&=65535,C++}function I(P,C){this.g=P,this.h=C}function M(P,C){if(v(C))throw Error("division by zero");if(v(P))return new I(f,f);if(x(P))return C=M(E(P),C),new I(E(C.g),E(C.h));if(x(C))return C=M(P,E(C)),new I(E(C.g),C.h);if(P.g.length>30){if(x(P)||x(C))throw Error("slowDivide_ only works with positive integers.");for(var k=g,L=C;L.l(P)<=0;)k=F(k),L=F(L);var O=z(k,1),U=z(L,1);for(L=z(L,2),k=z(k,2);!v(L);){var j=U.add(L);j.l(P)<=0&&(O=O.add(k),U=j),L=z(L,1),k=z(k,1)}return C=T(P,O.j(C)),new I(O,C)}for(O=f;P.l(C)>=0;){for(k=Math.max(1,Math.floor(P.m()/C.m())),L=Math.ceil(Math.log(k)/Math.LN2),L=L<=48?1:Math.pow(2,L-48),U=u(k),j=U.j(C);x(j)||j.l(P)>0;)k-=L,U=u(k),j=U.j(C);v(U)&&(U=g),O=O.add(U),P=T(P,j)}return new I(O,P)}n.B=function(P){return M(this,P).h},n.and=function(P){const C=Math.max(this.g.length,P.g.length),k=[];for(let L=0;L<C;L++)k[L]=this.i(L)&P.i(L);return new a(k,this.h&P.h)},n.or=function(P){const C=Math.max(this.g.length,P.g.length),k=[];for(let L=0;L<C;L++)k[L]=this.i(L)|P.i(L);return new a(k,this.h|P.h)},n.xor=function(P){const C=Math.max(this.g.length,P.g.length),k=[];for(let L=0;L<C;L++)k[L]=this.i(L)^P.i(L);return new a(k,this.h^P.h)};function F(P){const C=P.g.length+1,k=[];for(let L=0;L<C;L++)k[L]=P.i(L)<<1|P.i(L-1)>>>31;return new a(k,P.h)}function z(P,C){const k=C>>5;C%=32;const L=P.g.length-k,O=[];for(let U=0;U<L;U++)O[U]=C>0?P.i(U+k)>>>C|P.i(U+k+1)<<32-C:P.i(U+k);return new a(O,P.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,S6=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.B,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=u,a.fromString=h,iu=a}).apply(typeof EM<"u"?EM:typeof self<"u"?self:typeof window<"u"?window:{});var Zy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var T6,nm,b6,P_,NT,I6,A6,R6;(function(){var n,e=Object.defineProperty;function t(_){_=[typeof globalThis=="object"&&globalThis,_,typeof window=="object"&&window,typeof self=="object"&&self,typeof Zy=="object"&&Zy];for(var R=0;R<_.length;++R){var D=_[R];if(D&&D.Math==Math)return D}throw Error("Cannot find global object")}var r=t(this);function i(_,R){if(R)e:{var D=r;_=_.split(".");for(var H=0;H<_.length-1;H++){var me=_[H];if(!(me in D))break e;D=D[me]}_=_[_.length-1],H=D[_],R=R(H),R!=H&&R!=null&&e(D,_,{configurable:!0,writable:!0,value:R})}}i("Symbol.dispose",function(_){return _||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(_){return _||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(_){return _||function(R){var D=[],H;for(H in R)Object.prototype.hasOwnProperty.call(R,H)&&D.push([H,R[H]]);return D}});var s=s||{},a=this||self;function o(_){var R=typeof _;return R=="object"&&_!=null||R=="function"}function l(_,R,D){return _.call.apply(_.bind,arguments)}function u(_,R,D){return u=l,u.apply(null,arguments)}function h(_,R){var D=Array.prototype.slice.call(arguments,1);return function(){var H=D.slice();return H.push.apply(H,arguments),_.apply(this,H)}}function f(_,R){function D(){}D.prototype=R.prototype,_.Z=R.prototype,_.prototype=new D,_.prototype.constructor=_,_.Ob=function(H,me,Ae){for(var it=Array(arguments.length-2),Zt=2;Zt<arguments.length;Zt++)it[Zt-2]=arguments[Zt];return R.prototype[me].apply(H,it)}}var g=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?_=>_&&AsyncContext.Snapshot.wrap(_):_=>_;function y(_){const R=_.length;if(R>0){const D=Array(R);for(let H=0;H<R;H++)D[H]=_[H];return D}return[]}function v(_,R){for(let H=1;H<arguments.length;H++){const me=arguments[H];var D=typeof me;if(D=D!="object"?D:me?Array.isArray(me)?"array":D:"null",D=="array"||D=="object"&&typeof me.length=="number"){D=_.length||0;const Ae=me.length||0;_.length=D+Ae;for(let it=0;it<Ae;it++)_[D+it]=me[it]}else _.push(me)}}class x{constructor(R,D){this.i=R,this.j=D,this.h=0,this.g=null}get(){let R;return this.h>0?(this.h--,R=this.g,this.g=R.next,R.next=null):R=this.i(),R}}function E(_){a.setTimeout(()=>{throw _},0)}function T(){var _=P;let R=null;return _.g&&(R=_.g,_.g=_.g.next,_.g||(_.h=null),R.next=null),R}class b{constructor(){this.h=this.g=null}add(R,D){const H=I.get();H.set(R,D),this.h?this.h.next=H:this.g=H,this.h=H}}var I=new x(()=>new M,_=>_.reset());class M{constructor(){this.next=this.g=this.h=null}set(R,D){this.h=R,this.g=D,this.next=null}reset(){this.next=this.g=this.h=null}}let F,z=!1,P=new b,C=()=>{const _=Promise.resolve(void 0);F=()=>{_.then(k)}};function k(){for(var _;_=T();){try{_.h.call(_.g)}catch(D){E(D)}var R=I;R.j(_),R.h<100&&(R.h++,_.next=R.g,R.g=_)}z=!1}function L(){this.u=this.u,this.C=this.C}L.prototype.u=!1,L.prototype.dispose=function(){this.u||(this.u=!0,this.N())},L.prototype[Symbol.dispose]=function(){this.dispose()},L.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function O(_,R){this.type=_,this.g=this.target=R,this.defaultPrevented=!1}O.prototype.h=function(){this.defaultPrevented=!0};var U=(function(){if(!a.addEventListener||!Object.defineProperty)return!1;var _=!1,R=Object.defineProperty({},"passive",{get:function(){_=!0}});try{const D=()=>{};a.addEventListener("test",D,R),a.removeEventListener("test",D,R)}catch{}return _})();function j(_){return/^[\s\xa0]*$/.test(_)}function Te(_,R){O.call(this,_?_.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,_&&this.init(_,R)}f(Te,O),Te.prototype.init=function(_,R){const D=this.type=_.type,H=_.changedTouches&&_.changedTouches.length?_.changedTouches[0]:null;this.target=_.target||_.srcElement,this.g=R,R=_.relatedTarget,R||(D=="mouseover"?R=_.fromElement:D=="mouseout"&&(R=_.toElement)),this.relatedTarget=R,H?(this.clientX=H.clientX!==void 0?H.clientX:H.pageX,this.clientY=H.clientY!==void 0?H.clientY:H.pageY,this.screenX=H.screenX||0,this.screenY=H.screenY||0):(this.clientX=_.clientX!==void 0?_.clientX:_.pageX,this.clientY=_.clientY!==void 0?_.clientY:_.pageY,this.screenX=_.screenX||0,this.screenY=_.screenY||0),this.button=_.button,this.key=_.key||"",this.ctrlKey=_.ctrlKey,this.altKey=_.altKey,this.shiftKey=_.shiftKey,this.metaKey=_.metaKey,this.pointerId=_.pointerId||0,this.pointerType=_.pointerType,this.state=_.state,this.i=_,_.defaultPrevented&&Te.Z.h.call(this)},Te.prototype.h=function(){Te.Z.h.call(this);const _=this.i;_.preventDefault?_.preventDefault():_.returnValue=!1};var Ce="closure_listenable_"+(Math.random()*1e6|0),Ue=0;function Ne(_,R,D,H,me){this.listener=_,this.proxy=null,this.src=R,this.type=D,this.capture=!!H,this.ha=me,this.key=++Ue,this.da=this.fa=!1}function le(_){_.da=!0,_.listener=null,_.proxy=null,_.src=null,_.ha=null}function ue(_,R,D){for(const H in _)R.call(D,_[H],H,_)}function Se(_,R){for(const D in _)R.call(void 0,_[D],D,_)}function se(_){const R={};for(const D in _)R[D]=_[D];return R}const V="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function J(_,R){let D,H;for(let me=1;me<arguments.length;me++){H=arguments[me];for(D in H)_[D]=H[D];for(let Ae=0;Ae<V.length;Ae++)D=V[Ae],Object.prototype.hasOwnProperty.call(H,D)&&(_[D]=H[D])}}function re(_){this.src=_,this.g={},this.h=0}re.prototype.add=function(_,R,D,H,me){const Ae=_.toString();_=this.g[Ae],_||(_=this.g[Ae]=[],this.h++);const it=he(_,R,H,me);return it>-1?(R=_[it],D||(R.fa=!1)):(R=new Ne(R,this.src,Ae,!!H,me),R.fa=D,_.push(R)),R};function q(_,R){const D=R.type;if(D in _.g){var H=_.g[D],me=Array.prototype.indexOf.call(H,R,void 0),Ae;(Ae=me>=0)&&Array.prototype.splice.call(H,me,1),Ae&&(le(R),_.g[D].length==0&&(delete _.g[D],_.h--))}}function he(_,R,D,H){for(let me=0;me<_.length;++me){const Ae=_[me];if(!Ae.da&&Ae.listener==R&&Ae.capture==!!D&&Ae.ha==H)return me}return-1}var Me="closure_lm_"+(Math.random()*1e6|0),je={};function De(_,R,D,H,me){if(Array.isArray(R)){for(let Ae=0;Ae<R.length;Ae++)De(_,R[Ae],D,H,me);return null}return D=Zn(D),_&&_[Ce]?_.J(R,D,o(H)?!!H.capture:!1,me):Be(_,R,D,!1,H,me)}function Be(_,R,D,H,me,Ae){if(!R)throw Error("Invalid event type");const it=o(me)?!!me.capture:!!me;let Zt=Qt(_);if(Zt||(_[Me]=Zt=new re(_)),D=Zt.add(R,D,H,it,Ae),D.proxy)return D;if(H=Gt(),D.proxy=H,H.src=_,H.listener=D,_.addEventListener)U||(me=it),me===void 0&&(me=!1),_.addEventListener(R.toString(),H,me);else if(_.attachEvent)_.attachEvent(Bt(R.toString()),H);else if(_.addListener&&_.removeListener)_.addListener(H);else throw Error("addEventListener and attachEvent are unavailable.");return D}function Gt(){function _(D){return R.call(_.src,_.listener,D)}const R=Fn;return _}function Kt(_,R,D,H,me){if(Array.isArray(R))for(var Ae=0;Ae<R.length;Ae++)Kt(_,R[Ae],D,H,me);else H=o(H)?!!H.capture:!!H,D=Zn(D),_&&_[Ce]?(_=_.i,Ae=String(R).toString(),Ae in _.g&&(R=_.g[Ae],D=he(R,D,H,me),D>-1&&(le(R[D]),Array.prototype.splice.call(R,D,1),R.length==0&&(delete _.g[Ae],_.h--)))):_&&(_=Qt(_))&&(R=_.g[R.toString()],_=-1,R&&(_=he(R,D,H,me)),(D=_>-1?R[_]:null)&&wn(D))}function wn(_){if(typeof _!="number"&&_&&!_.da){var R=_.src;if(R&&R[Ce])q(R.i,_);else{var D=_.type,H=_.proxy;R.removeEventListener?R.removeEventListener(D,H,_.capture):R.detachEvent?R.detachEvent(Bt(D),H):R.addListener&&R.removeListener&&R.removeListener(H),(D=Qt(R))?(q(D,_),D.h==0&&(D.src=null,R[Me]=null)):le(_)}}}function Bt(_){return _ in je?je[_]:je[_]="on"+_}function Fn(_,R){if(_.da)_=!0;else{R=new Te(R,this);const D=_.listener,H=_.ha||_.src;_.fa&&wn(_),_=D.call(H,R)}return _}function Qt(_){return _=_[Me],_ instanceof re?_:null}var ot="__closure_events_fn_"+(Math.random()*1e9>>>0);function Zn(_){return typeof _=="function"?_:(_[ot]||(_[ot]=function(R){return _.handleEvent(R)}),_[ot])}function on(){L.call(this),this.i=new re(this),this.M=this,this.G=null}f(on,L),on.prototype[Ce]=!0,on.prototype.removeEventListener=function(_,R,D,H){Kt(this,_,R,D,H)};function en(_,R){var D,H=_.G;if(H)for(D=[];H;H=H.G)D.push(H);if(_=_.M,H=R.type||R,typeof R=="string")R=new O(R,_);else if(R instanceof O)R.target=R.target||_;else{var me=R;R=new O(H,_),J(R,me)}me=!0;let Ae,it;if(D)for(it=D.length-1;it>=0;it--)Ae=R.g=D[it],me=Qn(Ae,H,!0,R)&&me;if(Ae=R.g=_,me=Qn(Ae,H,!0,R)&&me,me=Qn(Ae,H,!1,R)&&me,D)for(it=0;it<D.length;it++)Ae=R.g=D[it],me=Qn(Ae,H,!1,R)&&me}on.prototype.N=function(){if(on.Z.N.call(this),this.i){var _=this.i;for(const R in _.g){const D=_.g[R];for(let H=0;H<D.length;H++)le(D[H]);delete _.g[R],_.h--}}this.G=null},on.prototype.J=function(_,R,D,H){return this.i.add(String(_),R,!1,D,H)},on.prototype.K=function(_,R,D,H){return this.i.add(String(_),R,!0,D,H)};function Qn(_,R,D,H){if(R=_.i.g[String(R)],!R)return!0;R=R.concat();let me=!0;for(let Ae=0;Ae<R.length;++Ae){const it=R[Ae];if(it&&!it.da&&it.capture==D){const Zt=it.listener,Lr=it.ha||it.src;it.fa&&q(_.i,it),me=Zt.call(Lr,H)!==!1&&me}}return me&&!H.defaultPrevented}function mt(_,R){if(typeof _!="function")if(_&&typeof _.handleEvent=="function")_=u(_.handleEvent,_);else throw Error("Invalid listener argument");return Number(R)>2147483647?-1:a.setTimeout(_,R||0)}function jt(_){_.g=mt(()=>{_.g=null,_.i&&(_.i=!1,jt(_))},_.l);const R=_.h;_.h=null,_.m.apply(null,R)}class Pn extends L{constructor(R,D){super(),this.m=R,this.l=D,this.h=null,this.i=!1,this.g=null}j(R){this.h=arguments,this.g?this.i=!0:jt(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function _t(_){L.call(this),this.h=_,this.g={}}f(_t,L);var Jt=[];function Rt(_){ue(_.g,function(R,D){this.g.hasOwnProperty(D)&&wn(R)},_),_.g={}}_t.prototype.N=function(){_t.Z.N.call(this),Rt(this)},_t.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var rr=a.JSON.stringify,ai=a.JSON.parse,Gr=class{stringify(_){return a.JSON.stringify(_,void 0)}parse(_){return a.JSON.parse(_,void 0)}};function Ut(){}function es(){}var Oe={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function we(){O.call(this,"d")}f(we,O);function pe(){O.call(this,"c")}f(pe,O);var kt={},N=null;function Pt(){return N=N||new on}kt.Ia="serverreachability";function W(_){O.call(this,kt.Ia,_)}f(W,O);function Z(_){const R=Pt();en(R,new W(R))}kt.STAT_EVENT="statevent";function X(_,R){O.call(this,kt.STAT_EVENT,_),this.stat=R}f(X,O);function ce(_){const R=Pt();en(R,new X(R,_))}kt.Ja="timingevent";function de(_,R){O.call(this,kt.Ja,_),this.size=R}f(de,O);function Ve(_,R){if(typeof _!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){_()},R)}function be(){this.g=!0}be.prototype.ua=function(){this.g=!1};function $e(_,R,D,H,me,Ae){_.info(function(){if(_.g)if(Ae){var it="",Zt=Ae.split("&");for(let Vn=0;Vn<Zt.length;Vn++){var Lr=Zt[Vn].split("=");if(Lr.length>1){const Br=Lr[0];Lr=Lr[1];const Vs=Br.split("_");it=Vs.length>=2&&Vs[1]=="type"?it+(Br+"="+Lr+"&"):it+(Br+"=redacted&")}}}else it=null;else it=Ae;return"XMLHTTP REQ ("+H+") [attempt "+me+"]: "+R+`
`+D+`
`+it})}function et(_,R,D,H,me,Ae,it){_.info(function(){return"XMLHTTP RESP ("+H+") [ attempt "+me+"]: "+R+`
`+D+`
`+Ae+" "+it})}function ft(_,R,D,H){_.info(function(){return"XMLHTTP TEXT ("+R+"): "+sn(_,D)+(H?" "+H:"")})}function St(_,R){_.info(function(){return"TIMEOUT: "+R})}be.prototype.info=function(){};function sn(_,R){if(!_.g)return R;if(!R)return null;try{const Ae=JSON.parse(R);if(Ae){for(_=0;_<Ae.length;_++)if(Array.isArray(Ae[_])){var D=Ae[_];if(!(D.length<2)){var H=D[1];if(Array.isArray(H)&&!(H.length<1)){var me=H[0];if(me!="noop"&&me!="stop"&&me!="close")for(let it=1;it<H.length;it++)H[it]=""}}}}return rr(Ae)}catch{return R}}var ur={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},cn={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},hr;function yr(){}f(yr,Ut),yr.prototype.g=function(){return new XMLHttpRequest},hr=new yr;function Li(_){return encodeURIComponent(String(_))}function B(_){var R=1;_=_.split(":");const D=[];for(;R>0&&_.length;)D.push(_.shift()),R--;return _.length&&D.push(_.join(":")),D}function Q(_,R,D,H){this.j=_,this.i=R,this.l=D,this.S=H||1,this.V=new _t(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new K}function K(){this.i=null,this.g="",this.h=!1}var Y={},ee={};function te(_,R,D){_.M=1,_.A=sl(oa(R)),_.u=D,_.R=!0,_e(_,null)}function _e(_,R){_.F=Date.now(),Ee(_),_.B=oa(_.A);var D=_.B,H=_.S;Array.isArray(H)||(H=[String(H)]),ig(D.i,"t",H),_.C=0,D=_.j.L,_.h=new K,_.g=B1(_.j,D?R:null,!_.u),_.P>0&&(_.O=new Pn(u(_.Y,_,_.g),_.P)),R=_.V,D=_.g,H=_.ba;var me="readystatechange";Array.isArray(me)||(me&&(Jt[0]=me.toString()),me=Jt);for(let Ae=0;Ae<me.length;Ae++){const it=De(D,me[Ae],H||R.handleEvent,!1,R.h||R);if(!it)break;R.g[it.key]=it}R=_.J?se(_.J):{},_.u?(_.v||(_.v="POST"),R["Content-Type"]="application/x-www-form-urlencoded",_.g.ea(_.B,_.v,_.u,R)):(_.v="GET",_.g.ea(_.B,_.v,null,R)),Z(),$e(_.i,_.v,_.B,_.l,_.S,_.u)}Q.prototype.ba=function(_){_=_.target;const R=this.O;R&&vo(_)==3?R.j():this.Y(_)},Q.prototype.Y=function(_){try{if(_==this.g)e:{const Zt=vo(this.g),Lr=this.g.ya(),Vn=this.g.ca();if(!(Zt<3)&&(Zt!=3||this.g&&(this.h.h||this.g.la()||V1(this.g)))){this.K||Zt!=4||Lr==7||(Lr==8||Vn<=0?Z(3):Z(2)),tt(this);var R=this.g.ca();this.X=R;var D=ke(this);if(this.o=R==200,et(this.i,this.v,this.B,this.l,this.S,Zt,R),this.o){if(this.U&&!this.L){t:{if(this.g){var H,me=this.g;if((H=me.g?me.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!j(H)){var Ae=H;break t}}Ae=null}if(_=Ae)ft(this.i,this.l,_,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Xe(this,_);else{this.o=!1,this.m=3,ce(12),Ye(this),gt(this);break e}}if(this.R){_=!0;let Br;for(;!this.K&&this.C<D.length;)if(Br=ve(this,D),Br==ee){Zt==4&&(this.m=4,ce(14),_=!1),ft(this.i,this.l,null,"[Incomplete Response]");break}else if(Br==Y){this.m=4,ce(15),ft(this.i,this.l,D,"[Invalid Chunk]"),_=!1;break}else ft(this.i,this.l,Br,null),Xe(this,Br);if(ye(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Zt!=4||D.length!=0||this.h.h||(this.m=1,ce(16),_=!1),this.o=this.o&&_,!_)ft(this.i,this.l,D,"[Invalid Chunked Response]"),Ye(this),gt(this);else if(D.length>0&&!this.W){this.W=!0;var it=this.j;it.g==this&&it.aa&&!it.P&&(it.j.info("Great, no buffering proxy detected. Bytes received: "+D.length),Fu(it),it.P=!0,ce(11))}}else ft(this.i,this.l,D,null),Xe(this,D);Zt==4&&Ye(this),this.o&&!this.K&&(Zt==4?Md(this.j,this):(this.o=!1,Ee(this)))}else ag(this.g),R==400&&D.indexOf("Unknown SID")>0?(this.m=3,ce(12)):(this.m=0,ce(13)),Ye(this),gt(this)}}}catch{}};function ke(_){if(!ye(_))return _.g.la();const R=V1(_.g);if(R==="")return"";let D="";const H=R.length,me=vo(_.g)==4;if(!_.h.i){if(typeof TextDecoder>"u")return Ye(_),gt(_),"";_.h.i=new a.TextDecoder}for(let Ae=0;Ae<H;Ae++)_.h.h=!0,D+=_.h.i.decode(R[Ae],{stream:!(me&&Ae==H-1)});return R.length=0,_.h.g+=D,_.C=0,_.h.g}function ye(_){return _.g?_.v=="GET"&&_.M!=2&&_.j.Aa:!1}function ve(_,R){var D=_.C,H=R.indexOf(`
`,D);return H==-1?ee:(D=Number(R.substring(D,H)),isNaN(D)?Y:(H+=1,H+D>R.length?ee:(R=R.slice(H,H+D),_.C=H+D,R)))}Q.prototype.cancel=function(){this.K=!0,Ye(this)};function Ee(_){_.T=Date.now()+_.H,Ke(_,_.H)}function Ke(_,R){if(_.D!=null)throw Error("WatchDog timer not null");_.D=Ve(u(_.aa,_),R)}function tt(_){_.D&&(a.clearTimeout(_.D),_.D=null)}Q.prototype.aa=function(){this.D=null;const _=Date.now();_-this.T>=0?(St(this.i,this.B),this.M!=2&&(Z(),ce(17)),Ye(this),this.m=2,gt(this)):Ke(this,this.T-_)};function gt(_){_.j.I==0||_.K||Md(_.j,_)}function Ye(_){tt(_);var R=_.O;R&&typeof R.dispose=="function"&&R.dispose(),_.O=null,Rt(_.V),_.g&&(R=_.g,_.g=null,R.abort(),R.dispose())}function Xe(_,R){try{var D=_.j;if(D.I!=0&&(D.g==_||Na(D.h,_))){if(!_.L&&Na(D.h,_)&&D.I==3){try{var H=D.Ba.g.parse(R)}catch{H=null}if(Array.isArray(H)&&H.length==3){var me=H;if(me[0]==0){e:if(!D.v){if(D.g)if(D.g.F+3e3<_.F)Pd(D),Fs(D);else break e;So(D),ce(18)}}else D.xa=me[1],0<D.xa-D.K&&me[2]<37500&&D.F&&D.A==0&&!D.C&&(D.C=Ve(u(D.Va,D),6e3));dr(D.h)<=1&&D.ta&&(D.ta=void 0)}else js(D,11)}else if((_.L||D.g==_)&&Pd(D),!j(R))for(me=D.Ba.g.parse(R),R=0;R<me.length;R++){let Vn=me[R];const Br=Vn[0];if(!(Br<=D.K))if(D.K=Br,Vn=Vn[1],D.I==2)if(Vn[0]=="c"){D.M=Vn[1],D.ba=Vn[2];const Vs=Vn[3];Vs!=null&&(D.ka=Vs,D.j.info("VER="+D.ka));const ul=Vn[4];ul!=null&&(D.za=ul,D.j.info("SVER="+D.za));const To=Vn[5];To!=null&&typeof To=="number"&&To>0&&(H=1.5*To,D.O=H,D.j.info("backChannelRequestTimeoutMs_="+H)),H=D;const bo=_.g;if(bo){const Od=bo.g?bo.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Od){var Ae=H.h;Ae.g||Od.indexOf("spdy")==-1&&Od.indexOf("quic")==-1&&Od.indexOf("h2")==-1||(Ae.j=Ae.l,Ae.g=new Set,Ae.h&&(aa(Ae,Ae.h),Ae.h=null))}if(H.G){const cg=bo.g?bo.g.getResponseHeader("X-HTTP-Session-Id"):null;cg&&(H.wa=cg,In(H.J,H.G,cg))}}D.I=3,D.l&&D.l.ra(),D.aa&&(D.T=Date.now()-_.F,D.j.info("Handshake RTT: "+D.T+"ms")),H=D;var it=_;if(H.na=lg(H,H.L?H.ba:null,H.W),it.L){Os(H.h,it);var Zt=it,Lr=H.O;Lr&&(Zt.H=Lr),Zt.D&&(tt(Zt),Ee(Zt)),H.g=it}else Oi(H);D.i.length>0&&cl(D)}else Vn[0]!="stop"&&Vn[0]!="close"||js(D,7);else D.I==3&&(Vn[0]=="stop"||Vn[0]=="close"?Vn[0]=="stop"?js(D,7):Cd(D):Vn[0]!="noop"&&D.l&&D.l.qa(Vn),D.A=0)}}Z(4)}catch{}}var zt=class{constructor(_,R){this.g=_,this.map=R}};function Mn(_){this.l=_||10,a.PerformanceNavigationTiming?(_=a.performance.getEntriesByType("navigation"),_=_.length>0&&(_[0].nextHopProtocol=="hq"||_[0].nextHopProtocol=="h2")):_=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=_?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function jn(_){return _.h?!0:_.g?_.g.size>=_.j:!1}function dr(_){return _.h?1:_.g?_.g.size:0}function Na(_,R){return _.h?_.h==R:_.g?_.g.has(R):!1}function aa(_,R){_.g?_.g.add(R):_.h=R}function Os(_,R){_.h&&_.h==R?_.h=null:_.g&&_.g.has(R)&&_.g.delete(R)}Mn.prototype.cancel=function(){if(this.i=Nr(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const _ of this.g.values())_.cancel();this.g.clear()}};function Nr(_){if(_.h!=null)return _.i.concat(_.h.G);if(_.g!=null&&_.g.size!==0){let R=_.i;for(const D of _.g.values())R=R.concat(D.G);return R}return y(_.i)}var tc=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function _r(_,R){if(_){_=_.split("&");for(let D=0;D<_.length;D++){const H=_[D].indexOf("=");let me,Ae=null;H>=0?(me=_[D].substring(0,H),Ae=_[D].substring(H+1)):me=_[D],R(me,Ae?decodeURIComponent(Ae.replace(/\+/g," ")):"")}}}function go(_){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let R;_ instanceof go?(this.l=_.l,Pu(this,_.j),this.o=_.o,this.g=_.g,mo(this,_.u),this.h=_.h,nc(this,sg(_.i)),this.m=_.m):_&&(R=String(_).match(tc))?(this.l=!1,Pu(this,R[1]||"",!0),this.o=Mu(R[2]||""),this.g=Mu(R[3]||"",!0),mo(this,R[4]),this.h=Mu(R[5]||"",!0),nc(this,R[6]||"",!0),this.m=Mu(R[7]||"")):(this.l=!1,this.i=new gn(null,this.l))}go.prototype.toString=function(){const _=[];var R=this.j;R&&_.push(Nu(R,J0,!0),":");var D=this.g;return(D||R=="file")&&(_.push("//"),(R=this.o)&&_.push(Nu(R,J0,!0),"@"),_.push(Li(D).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),D=this.u,D!=null&&_.push(":",String(D))),(D=this.h)&&(this.g&&D.charAt(0)!="/"&&_.push("/"),_.push(Nu(D,D.charAt(0)=="/"?Lu:eg,!0))),(D=this.i.toString())&&_.push("?",D),(D=this.m)&&_.push("#",Nu(D,tg)),_.join("")},go.prototype.resolve=function(_){const R=oa(this);let D=!!_.j;D?Pu(R,_.j):D=!!_.o,D?R.o=_.o:D=!!_.g,D?R.g=_.g:D=_.u!=null;var H=_.h;if(D)mo(R,_.u);else if(D=!!_.h){if(H.charAt(0)!="/")if(this.g&&!this.h)H="/"+H;else{var me=R.h.lastIndexOf("/");me!=-1&&(H=R.h.slice(0,me+1)+H)}if(me=H,me==".."||me==".")H="";else if(me.indexOf("./")!=-1||me.indexOf("/.")!=-1){H=me.lastIndexOf("/",0)==0,me=me.split("/");const Ae=[];for(let it=0;it<me.length;){const Zt=me[it++];Zt=="."?H&&it==me.length&&Ae.push(""):Zt==".."?((Ae.length>1||Ae.length==1&&Ae[0]!="")&&Ae.pop(),H&&it==me.length&&Ae.push("")):(Ae.push(Zt),H=!0)}H=Ae.join("/")}else H=me}return D?R.h=H:D=_.i.toString()!=="",D?nc(R,sg(_.i)):D=!!_.m,D&&(R.m=_.m),R};function oa(_){return new go(_)}function Pu(_,R,D){_.j=D?Mu(R,!0):R,_.j&&(_.j=_.j.replace(/:$/,""))}function mo(_,R){if(R){if(R=Number(R),isNaN(R)||R<0)throw Error("Bad port number "+R);_.u=R}else _.u=null}function nc(_,R,D){R instanceof gn?(_.i=R,Id(_.i,_.l)):(D||(R=Nu(R,Zw)),_.i=new gn(R,_.l))}function In(_,R,D){_.i.set(R,D)}function sl(_){return In(_,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),_}function Mu(_,R){return _?R?decodeURI(_.replace(/%25/g,"%2525")):decodeURIComponent(_):""}function Nu(_,R,D){return typeof _=="string"?(_=encodeURI(_).replace(R,Q0),D&&(_=_.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_):null}function Q0(_){return _=_.charCodeAt(0),"%"+(_>>4&15).toString(16)+(_&15).toString(16)}var J0=/[#\/\?@]/g,eg=/[#\?:]/g,Lu=/[#\?]/g,Zw=/[#\?@]/g,tg=/#/g;function gn(_,R){this.h=this.g=null,this.i=_||null,this.j=!!R}function po(_){_.g||(_.g=new Map,_.h=0,_.i&&_r(_.i,function(R,D){_.add(decodeURIComponent(R.replace(/\+/g," ")),D)}))}n=gn.prototype,n.add=function(_,R){po(this),this.i=null,_=yo(this,_);let D=this.g.get(_);return D||this.g.set(_,D=[]),D.push(R),this.h+=1,this};function ng(_,R){po(_),R=yo(_,R),_.g.has(R)&&(_.i=null,_.h-=_.g.get(R).length,_.g.delete(R))}function bd(_,R){return po(_),R=yo(_,R),_.g.has(R)}n.forEach=function(_,R){po(this),this.g.forEach(function(D,H){D.forEach(function(me){_.call(R,me,H,this)},this)},this)};function rg(_,R){po(_);let D=[];if(typeof R=="string")bd(_,R)&&(D=D.concat(_.g.get(yo(_,R))));else for(_=Array.from(_.g.values()),R=0;R<_.length;R++)D=D.concat(_[R]);return D}n.set=function(_,R){return po(this),this.i=null,_=yo(this,_),bd(this,_)&&(this.h-=this.g.get(_).length),this.g.set(_,[R]),this.h+=1,this},n.get=function(_,R){return _?(_=rg(this,_),_.length>0?String(_[0]):R):R};function ig(_,R,D){ng(_,R),D.length>0&&(_.i=null,_.g.set(yo(_,R),y(D)),_.h+=D.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const _=[],R=Array.from(this.g.keys());for(let H=0;H<R.length;H++){var D=R[H];const me=Li(D);D=rg(this,D);for(let Ae=0;Ae<D.length;Ae++){let it=me;D[Ae]!==""&&(it+="="+Li(D[Ae])),_.push(it)}}return this.i=_.join("&")};function sg(_){const R=new gn;return R.i=_.i,_.g&&(R.g=new Map(_.g),R.h=_.h),R}function yo(_,R){return R=String(R),_.j&&(R=R.toLowerCase()),R}function Id(_,R){R&&!_.j&&(po(_),_.i=null,_.g.forEach(function(D,H){const me=H.toLowerCase();H!=me&&(ng(this,H),ig(this,me,D))},_)),_.j=R}function _o(_,R){const D=new be;if(a.Image){const H=new Image;H.onload=h(_i,D,"TestLoadImage: loaded",!0,R,H),H.onerror=h(_i,D,"TestLoadImage: error",!1,R,H),H.onabort=h(_i,D,"TestLoadImage: abort",!1,R,H),H.ontimeout=h(_i,D,"TestLoadImage: timeout",!1,R,H),a.setTimeout(function(){H.ontimeout&&H.ontimeout()},1e4),H.src=_}else R(!1)}function xo(_,R){const D=new be,H=new AbortController,me=setTimeout(()=>{H.abort(),_i(D,"TestPingServer: timeout",!1,R)},1e4);fetch(_,{signal:H.signal}).then(Ae=>{clearTimeout(me),Ae.ok?_i(D,"TestPingServer: ok",!0,R):_i(D,"TestPingServer: server error",!1,R)}).catch(()=>{clearTimeout(me),_i(D,"TestPingServer: error",!1,R)})}function _i(_,R,D,H,me){try{me&&(me.onload=null,me.onerror=null,me.onabort=null,me.ontimeout=null),H(D)}catch{}}function Ou(){this.g=new Gr}function al(_){this.i=_.Sb||null,this.h=_.ab||!1}f(al,Ut),al.prototype.g=function(){return new Ds(this.i,this.h)};function Ds(_,R){on.call(this),this.H=_,this.o=R,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}f(Ds,on),n=Ds.prototype,n.open=function(_,R){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=_,this.D=R,this.readyState=1,La(this)},n.send=function(_){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const R={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};_&&(R.body=_),(this.H||a).fetch(new Request(this.D,R)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,rc(this)),this.readyState=0},n.Pa=function(_){if(this.g&&(this.l=_,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=_.headers,this.readyState=2,La(this)),this.g&&(this.readyState=3,La(this),this.g)))if(this.responseType==="arraybuffer")_.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in _){if(this.j=_.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;D1(this)}else _.text().then(this.Oa.bind(this),this.ga.bind(this))};function D1(_){_.j.read().then(_.Ma.bind(_)).catch(_.ga.bind(_))}n.Ma=function(_){if(this.g){if(this.o&&_.value)this.response.push(_.value);else if(!this.o){var R=_.value?_.value:new Uint8Array(0);(R=this.B.decode(R,{stream:!_.done}))&&(this.response=this.responseText+=R)}_.done?rc(this):La(this),this.readyState==3&&D1(this)}},n.Oa=function(_){this.g&&(this.response=this.responseText=_,rc(this))},n.Na=function(_){this.g&&(this.response=_,rc(this))},n.ga=function(){this.g&&rc(this)};function rc(_){_.readyState=4,_.l=null,_.j=null,_.B=null,La(_)}n.setRequestHeader=function(_,R){this.A.append(_,R)},n.getResponseHeader=function(_){return this.h&&this.h.get(_.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const _=[],R=this.h.entries();for(var D=R.next();!D.done;)D=D.value,_.push(D[0]+": "+D[1]),D=R.next();return _.join(`\r
`)};function La(_){_.onreadystatechange&&_.onreadystatechange.call(_)}Object.defineProperty(Ds.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(_){this.m=_?"include":"same-origin"}});function F1(_){let R="";return ue(_,function(D,H){R+=H,R+=":",R+=D,R+=`\r
`}),R}function Ad(_,R,D){e:{for(H in D){var H=!1;break e}H=!0}H||(D=F1(D),typeof _=="string"?D!=null&&Li(D):In(_,R,D))}function Jn(_){on.call(this),this.headers=new Map,this.L=_||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}f(Jn,on);var j1=/^https?$/i,Qw=["POST","PUT"];n=Jn.prototype,n.Fa=function(_){this.H=_},n.ea=function(_,R,D,H){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+_);R=R?R.toUpperCase():"GET",this.D=_,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():hr.g(),this.g.onreadystatechange=g(u(this.Ca,this));try{this.B=!0,this.g.open(R,String(_),!0),this.B=!1}catch(Ae){ic(this,Ae);return}if(_=D||"",D=new Map(this.headers),H)if(Object.getPrototypeOf(H)===Object.prototype)for(var me in H)D.set(me,H[me]);else if(typeof H.keys=="function"&&typeof H.get=="function")for(const Ae of H.keys())D.set(Ae,H.get(Ae));else throw Error("Unknown input type for opt_headers: "+String(H));H=Array.from(D.keys()).find(Ae=>Ae.toLowerCase()=="content-type"),me=a.FormData&&_ instanceof a.FormData,!(Array.prototype.indexOf.call(Qw,R,void 0)>=0)||H||me||D.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Ae,it]of D)this.g.setRequestHeader(Ae,it);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(_),this.v=!1}catch(Ae){ic(this,Ae)}};function ic(_,R){_.h=!1,_.g&&(_.j=!0,_.g.abort(),_.j=!1),_.l=R,_.o=5,sc(_),ll(_)}function sc(_){_.A||(_.A=!0,en(_,"complete"),en(_,"error"))}n.abort=function(_){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=_||7,en(this,"complete"),en(this,"abort"),ll(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ll(this,!0)),Jn.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?ol(this):this.Xa())},n.Xa=function(){ol(this)};function ol(_){if(_.h&&typeof s<"u"){if(_.v&&vo(_)==4)setTimeout(_.Ca.bind(_),0);else if(en(_,"readystatechange"),vo(_)==4){_.h=!1;try{const Ae=_.ca();e:switch(Ae){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var R=!0;break e;default:R=!1}var D;if(!(D=R)){var H;if(H=Ae===0){let it=String(_.D).match(tc)[1]||null;!it&&a.self&&a.self.location&&(it=a.self.location.protocol.slice(0,-1)),H=!j1.test(it?it.toLowerCase():"")}D=H}if(D)en(_,"complete"),en(_,"success");else{_.o=6;try{var me=vo(_)>2?_.g.statusText:""}catch{me=""}_.l=me+" ["+_.ca()+"]",sc(_)}}finally{ll(_)}}}}function ll(_,R){if(_.g){_.m&&(clearTimeout(_.m),_.m=null);const D=_.g;_.g=null,R||en(_,"ready");try{D.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function vo(_){return _.g?_.g.readyState:0}n.ca=function(){try{return vo(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(_){if(this.g){var R=this.g.responseText;return _&&R.indexOf(_)==0&&(R=R.substring(_.length)),ai(R)}};function V1(_){try{if(!_.g)return null;if("response"in _.g)return _.g.response;switch(_.F){case"":case"text":return _.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in _.g)return _.g.mozResponseArrayBuffer}return null}catch{return null}}function ag(_){const R={};_=(_.g&&vo(_)>=2&&_.g.getAllResponseHeaders()||"").split(`\r
`);for(let H=0;H<_.length;H++){if(j(_[H]))continue;var D=B(_[H]);const me=D[0];if(D=D[1],typeof D!="string")continue;D=D.trim();const Ae=R[me]||[];R[me]=Ae,Ae.push(D)}Se(R,function(H){return H.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function wo(_,R,D){return D&&D.internalChannelParams&&D.internalChannelParams[_]||R}function Rd(_){this.za=0,this.i=[],this.j=new be,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=wo("failFast",!1,_),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=wo("baseRetryDelayMs",5e3,_),this.Za=wo("retryDelaySeedMs",1e4,_),this.Ta=wo("forwardChannelMaxRetries",2,_),this.va=wo("forwardChannelRequestTimeoutMs",2e4,_),this.ma=_&&_.xmlHttpFactory||void 0,this.Ua=_&&_.Rb||void 0,this.Aa=_&&_.useFetchStreams||!1,this.O=void 0,this.L=_&&_.supportsCrossDomainXhr||!1,this.M="",this.h=new Mn(_&&_.concurrentRequestLimit),this.Ba=new Ou,this.S=_&&_.fastHandshake||!1,this.R=_&&_.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=_&&_.Pb||!1,_&&_.ua&&this.j.ua(),_&&_.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&_&&_.detectBufferingProxy||!1,this.ia=void 0,_&&_.longPollingTimeout&&_.longPollingTimeout>0&&(this.ia=_.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Rd.prototype,n.ka=8,n.I=1,n.connect=function(_,R,D,H){ce(0),this.W=_,this.H=R||{},D&&H!==void 0&&(this.H.OSID=D,this.H.OAID=H),this.F=this.X,this.J=lg(this,null,this.W),cl(this)};function Cd(_){if(kd(_),_.I==3){var R=_.V++,D=oa(_.J);if(In(D,"SID",_.M),In(D,"RID",R),In(D,"TYPE","terminate"),Eo(_,D),R=new Q(_,_.j,R),R.M=2,R.A=sl(oa(D)),D=!1,a.navigator&&a.navigator.sendBeacon)try{D=a.navigator.sendBeacon(R.A.toString(),"")}catch{}!D&&a.Image&&(new Image().src=R.A,D=!0),D||(R.g=B1(R.j,null),R.g.ea(R.A)),R.F=Date.now(),Ee(R)}ju(_)}function Fs(_){_.g&&(Fu(_),_.g.cancel(),_.g=null)}function kd(_){Fs(_),_.v&&(a.clearTimeout(_.v),_.v=null),Pd(_),_.h.cancel(),_.m&&(typeof _.m=="number"&&a.clearTimeout(_.m),_.m=null)}function cl(_){if(!jn(_.h)&&!_.m){_.m=!0;var R=_.Ea;F||C(),z||(F(),z=!0),P.add(R,_),_.D=0}}function G1(_,R){return dr(_.h)>=_.h.j-(_.m?1:0)?!1:_.m?(_.i=R.G.concat(_.i),!0):_.I==1||_.I==2||_.D>=(_.Sa?0:_.Ta)?!1:(_.m=Ve(u(_.Ea,_,R),Nd(_,_.D)),_.D++,!0)}n.Ea=function(_){if(this.m)if(this.m=null,this.I==1){if(!_){this.V=Math.floor(Math.random()*1e5),_=this.V++;const me=new Q(this,this.j,_);let Ae=this.o;if(this.U&&(Ae?(Ae=se(Ae),J(Ae,this.U)):Ae=this.U),this.u!==null||this.R||(me.J=Ae,Ae=null),this.S)e:{for(var R=0,D=0;D<this.i.length;D++){t:{var H=this.i[D];if("__data__"in H.map&&(H=H.map.__data__,typeof H=="string")){H=H.length;break t}H=void 0}if(H===void 0)break;if(R+=H,R>4096){R=D;break e}if(R===4096||D===this.i.length-1){R=D+1;break e}}R=1e3}else R=1e3;R=og(this,me,R),D=oa(this.J),In(D,"RID",_),In(D,"CVER",22),this.G&&In(D,"X-HTTP-Session-Id",this.G),Eo(this,D),Ae&&(this.R?R="headers="+Li(F1(Ae))+"&"+R:this.u&&Ad(D,this.u,Ae)),aa(this.h,me),this.Ra&&In(D,"TYPE","init"),this.S?(In(D,"$req",R),In(D,"SID","null"),me.U=!0,te(me,D,null)):te(me,D,R),this.I=2}}else this.I==3&&(_?Du(this,_):this.i.length==0||jn(this.h)||Du(this))};function Du(_,R){var D;R?D=R.l:D=_.V++;const H=oa(_.J);In(H,"SID",_.M),In(H,"RID",D),In(H,"AID",_.K),Eo(_,H),_.u&&_.o&&Ad(H,_.u,_.o),D=new Q(_,_.j,D,_.D+1),_.u===null&&(D.J=_.o),R&&(_.i=R.G.concat(_.i)),R=og(_,D,1e3),D.H=Math.round(_.va*.5)+Math.round(_.va*.5*Math.random()),aa(_.h,D),te(D,H,R)}function Eo(_,R){_.H&&ue(_.H,function(D,H){In(R,H,D)}),_.l&&ue({},function(D,H){In(R,H,D)})}function og(_,R,D){D=Math.min(_.i.length,D);const H=_.l?u(_.l.Ka,_.l,_):null;e:{var me=_.i;let Zt=-1;for(;;){const Lr=["count="+D];Zt==-1?D>0?(Zt=me[0].g,Lr.push("ofs="+Zt)):Zt=0:Lr.push("ofs="+Zt);let Vn=!0;for(let Br=0;Br<D;Br++){var Ae=me[Br].g;const Vs=me[Br].map;if(Ae-=Zt,Ae<0)Zt=Math.max(0,me[Br].g-100),Vn=!1;else try{Ae="req"+Ae+"_"||"";try{var it=Vs instanceof Map?Vs:Object.entries(Vs);for(const[ul,To]of it){let bo=To;o(To)&&(bo=rr(To)),Lr.push(Ae+ul+"="+encodeURIComponent(bo))}}catch(ul){throw Lr.push(Ae+"type="+encodeURIComponent("_badmap")),ul}}catch{H&&H(Vs)}}if(Vn){it=Lr.join("&");break e}}it=void 0}return _=_.i.splice(0,D),R.G=_,it}function Oi(_){if(!_.g&&!_.v){_.Y=1;var R=_.Da;F||C(),z||(F(),z=!0),P.add(R,_),_.A=0}}function So(_){return _.g||_.v||_.A>=3?!1:(_.Y++,_.v=Ve(u(_.Da,_),Nd(_,_.A)),_.A++,!0)}n.Da=function(){if(this.v=null,ac(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var _=4*this.T;this.j.info("BP detection timer enabled: "+_),this.B=Ve(u(this.Wa,this),_)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,ce(10),Fs(this),ac(this))};function Fu(_){_.B!=null&&(a.clearTimeout(_.B),_.B=null)}function ac(_){_.g=new Q(_,_.j,"rpc",_.Y),_.u===null&&(_.g.J=_.o),_.g.P=0;var R=oa(_.na);In(R,"RID","rpc"),In(R,"SID",_.M),In(R,"AID",_.K),In(R,"CI",_.F?"0":"1"),!_.F&&_.ia&&In(R,"TO",_.ia),In(R,"TYPE","xmlhttp"),Eo(_,R),_.u&&_.o&&Ad(R,_.u,_.o),_.O&&(_.g.H=_.O);var D=_.g;_=_.ba,D.M=1,D.A=sl(oa(R)),D.u=null,D.R=!0,_e(D,_)}n.Va=function(){this.C!=null&&(this.C=null,Fs(this),So(this),ce(19))};function Pd(_){_.C!=null&&(a.clearTimeout(_.C),_.C=null)}function Md(_,R){var D=null;if(_.g==R){Pd(_),Fu(_),_.g=null;var H=2}else if(Na(_.h,R))D=R.G,Os(_.h,R),H=1;else return;if(_.I!=0){if(R.o)if(H==1){D=R.u?R.u.length:0,R=Date.now()-R.F;var me=_.D;H=Pt(),en(H,new de(H,D)),cl(_)}else Oi(_);else if(me=R.m,me==3||me==0&&R.X>0||!(H==1&&G1(_,R)||H==2&&So(_)))switch(D&&D.length>0&&(R=_.h,R.i=R.i.concat(D)),me){case 1:js(_,5);break;case 4:js(_,10);break;case 3:js(_,6);break;default:js(_,2)}}}function Nd(_,R){let D=_.Qa+Math.floor(Math.random()*_.Za);return _.isActive()||(D*=2),D*R}function js(_,R){if(_.j.info("Error code "+R),R==2){var D=u(_.bb,_),H=_.Ua;const me=!H;H=new go(H||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Pu(H,"https"),sl(H),me?_o(H.toString(),D):xo(H.toString(),D)}else ce(2);_.I=0,_.l&&_.l.pa(R),ju(_),kd(_)}n.bb=function(_){_?(this.j.info("Successfully pinged google.com"),ce(2)):(this.j.info("Failed to ping google.com"),ce(1))};function ju(_){if(_.I=0,_.ja=[],_.l){const R=Nr(_.h);(R.length!=0||_.i.length!=0)&&(v(_.ja,R),v(_.ja,_.i),_.h.i.length=0,y(_.i),_.i.length=0),_.l.oa()}}function lg(_,R,D){var H=D instanceof go?oa(D):new go(D);if(H.g!="")R&&(H.g=R+"."+H.g),mo(H,H.u);else{var me=a.location;H=me.protocol,R=R?R+"."+me.hostname:me.hostname,me=+me.port;const Ae=new go(null);H&&Pu(Ae,H),R&&(Ae.g=R),me&&mo(Ae,me),D&&(Ae.h=D),H=Ae}return D=_.G,R=_.wa,D&&R&&In(H,D,R),In(H,"VER",_.ka),Eo(_,H),H}function B1(_,R,D){if(R&&!_.L)throw Error("Can't create secondary domain capable XhrIo object.");return R=_.Aa&&!_.ma?new Jn(new al({ab:D})):new Jn(_.ma),R.Fa(_.L),R}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function U1(){}n=U1.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Ld(){}Ld.prototype.g=function(_,R){return new xi(_,R)};function xi(_,R){on.call(this),this.g=new Rd(R),this.l=_,this.h=R&&R.messageUrlParams||null,_=R&&R.messageHeaders||null,R&&R.clientProtocolHeaderRequired&&(_?_["X-Client-Protocol"]="webchannel":_={"X-Client-Protocol":"webchannel"}),this.g.o=_,_=R&&R.initMessageHeaders||null,R&&R.messageContentType&&(_?_["X-WebChannel-Content-Type"]=R.messageContentType:_={"X-WebChannel-Content-Type":R.messageContentType}),R&&R.sa&&(_?_["X-WebChannel-Client-Profile"]=R.sa:_={"X-WebChannel-Client-Profile":R.sa}),this.g.U=_,(_=R&&R.Qb)&&!j(_)&&(this.g.u=_),this.A=R&&R.supportsCrossDomainXhr||!1,this.v=R&&R.sendRawJson||!1,(R=R&&R.httpSessionIdParam)&&!j(R)&&(this.g.G=R,_=this.h,_!==null&&R in _&&(_=this.h,R in _&&delete _[R])),this.j=new oc(this)}f(xi,on),xi.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},xi.prototype.close=function(){Cd(this.g)},xi.prototype.o=function(_){var R=this.g;if(typeof _=="string"){var D={};D.__data__=_,_=D}else this.v&&(D={},D.__data__=rr(_),_=D);R.i.push(new zt(R.Ya++,_)),R.I==3&&cl(R)},xi.prototype.N=function(){this.g.l=null,delete this.j,Cd(this.g),delete this.g,xi.Z.N.call(this)};function z1(_){we.call(this),_.__headers__&&(this.headers=_.__headers__,this.statusCode=_.__status__,delete _.__headers__,delete _.__status__);var R=_.__sm__;if(R){e:{for(const D in R){_=D;break e}_=void 0}(this.i=_)&&(_=this.i,R=R!==null&&_ in R?R[_]:void 0),this.data=R}else this.data=_}f(z1,we);function $1(){pe.call(this),this.status=1}f($1,pe);function oc(_){this.g=_}f(oc,U1),oc.prototype.ra=function(){en(this.g,"a")},oc.prototype.qa=function(_){en(this.g,new z1(_))},oc.prototype.pa=function(_){en(this.g,new $1)},oc.prototype.oa=function(){en(this.g,"b")},Ld.prototype.createWebChannel=Ld.prototype.g,xi.prototype.send=xi.prototype.o,xi.prototype.open=xi.prototype.m,xi.prototype.close=xi.prototype.close,R6=function(){return new Ld},A6=function(){return Pt()},I6=kt,NT={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ur.NO_ERROR=0,ur.TIMEOUT=8,ur.HTTP_ERROR=6,P_=ur,cn.COMPLETE="complete",b6=cn,es.EventType=Oe,Oe.OPEN="a",Oe.CLOSE="b",Oe.ERROR="c",Oe.MESSAGE="d",on.prototype.listen=on.prototype.J,nm=es,Jn.prototype.listenOnce=Jn.prototype.K,Jn.prototype.getLastError=Jn.prototype.Ha,Jn.prototype.getLastErrorCode=Jn.prototype.ya,Jn.prototype.getStatus=Jn.prototype.ca,Jn.prototype.getResponseJson=Jn.prototype.La,Jn.prototype.getResponseText=Jn.prototype.la,Jn.prototype.send=Jn.prototype.ea,Jn.prototype.setWithCredentials=Jn.prototype.Fa,T6=Jn}).apply(typeof Zy<"u"?Zy:typeof self<"u"?self:typeof window<"u"?window:{});const SM="@firebase/firestore",TM="4.9.3";let Ii=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Ii.UNAUTHENTICATED=new Ii(null),Ii.GOOGLE_CREDENTIALS=new Ii("google-credentials-uid"),Ii.FIRST_PARTY=new Ii("first-party-uid"),Ii.MOCK_USER=new Ii("mock-user");let G0="12.7.0";const Hh=new FI("@firebase/firestore");function Tf(){return Hh.logLevel}function Ze(n,...e){if(Hh.logLevel<=hn.DEBUG){const t=e.map(XI);Hh.debug(`Firestore (${G0}): ${n}`,...t)}}function ls(n,...e){if(Hh.logLevel<=hn.ERROR){const t=e.map(XI);Hh.error(`Firestore (${G0}): ${n}`,...t)}}function Kh(n,...e){if(Hh.logLevel<=hn.WARN){const t=e.map(XI);Hh.warn(`Firestore (${G0}): ${n}`,...t)}}function XI(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Et(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,C6(n,r,t)}function C6(n,e,t){let r=`FIRESTORE (${G0}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw ls(r),new Error(r)}function At(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||C6(e,i,r)}function qt(n,e){return n}const Pe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class at extends rl{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Uo{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class k6{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Uq{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Ii.UNAUTHENTICATED)))}shutdown(){}}class zq{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class $q{constructor(e){this.t=e,this.currentUser=Ii.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){At(this.o===void 0,42304);let r=this.i;const i=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve();let s=new Uo;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Uo,e.enqueueRetryable((()=>i(this.currentUser)))};const a=()=>{const l=s;e.enqueueRetryable((async()=>{await l.promise,await i(this.currentUser)}))},o=l=>{Ze("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit((l=>o(l))),setTimeout((()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(Ze("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Uo)}}),0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(Ze("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(At(typeof r.accessToken=="string",31837,{l:r}),new k6(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return At(e===null||typeof e=="string",2055,{h:e}),new Ii(e)}}class Wq{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Ii.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Hq{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new Wq(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Ii.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class bM{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Kq{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,qs(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){At(this.o===void 0,3512);const r=s=>{s.error!=null&&Ze("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.m;return this.m=s.token,Ze("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable((()=>r(s)))};const i=s=>{Ze("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((s=>i(s))),setTimeout((()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):Ze("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new bM(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(At(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new bM(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function Yq(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class qI{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=Yq(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%62))}return r}}function Xt(n,e){return n<e?-1:n>e?1:0}function LT(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const i=n.charAt(r),s=e.charAt(r);if(i!==s)return cS(i)===cS(s)?Xt(i,s):cS(i)?1:-1}return Xt(n.length,e.length)}const Xq=55296,qq=57343;function cS(n){const e=n.charCodeAt(0);return e>=Xq&&e<=qq}function g0(n,e,t){return n.length===e.length&&n.every(((r,i)=>t(r,e[i])))}function P6(n){return n+"\0"}const IM="__name__";class No{constructor(e,t,r){t===void 0?t=0:t>e.length&&Et(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&Et(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return No.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof No?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const s=No.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return Xt(e.length,t.length)}static compareSegments(e,t){const r=No.isNumericId(e),i=No.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?No.extractNumericId(e).compare(No.extractNumericId(t)):LT(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return iu.fromString(e.substring(4,e.length-2))}}class kn extends No{construct(e,t,r){return new kn(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new at(Pe.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((i=>i.length>0)))}return new kn(t)}static emptyPath(){return new kn([])}}const Zq=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Er extends No{construct(e,t,r){return new Er(e,t,r)}static isValidIdentifier(e){return Zq.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Er.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===IM}static keyField(){return new Er([IM])}static fromServerFormat(e){const t=[];let r="",i=0;const s=()=>{if(r.length===0)throw new at(Pe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let a=!1;for(;i<e.length;){const o=e[i];if(o==="\\"){if(i+1===e.length)throw new at(Pe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new at(Pe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else o==="`"?(a=!a,i++):o!=="."||a?(r+=o,i++):(s(),i++)}if(s(),a)throw new at(Pe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Er(t)}static emptyPath(){return new Er([])}}class ct{constructor(e){this.path=e}static fromPath(e){return new ct(kn.fromString(e))}static fromName(e){return new ct(kn.fromString(e).popFirst(5))}static empty(){return new ct(kn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&kn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return kn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ct(new kn(e.slice()))}}function M6(n,e,t){if(!t)throw new at(Pe.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Qq(n,e,t,r){if(e===!0&&r===!0)throw new at(Pe.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function AM(n){if(!ct.isDocumentKey(n))throw new at(Pe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function RM(n){if(ct.isDocumentKey(n))throw new at(Pe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function N6(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function nw(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Et(12329,{type:typeof n})}function Pa(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new at(Pe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=nw(n);throw new at(Pe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Kr(n,e){const t={typeString:n};return e&&(t.value=e),t}function l1(n,e){if(!N6(n))throw new at(Pe.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const a=n[r];if(i&&typeof a!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&a!==s.value){t=`Expected '${r}' field to equal '${s.value}'`;break}}if(t)throw new at(Pe.INVALID_ARGUMENT,t);return!0}const CM=-62135596800,kM=1e6;class zn{static now(){return zn.fromMillis(Date.now())}static fromDate(e){return zn.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*kM);return new zn(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new at(Pe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new at(Pe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<CM)throw new at(Pe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new at(Pe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/kM}_compareTo(e){return this.seconds===e.seconds?Xt(this.nanoseconds,e.nanoseconds):Xt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:zn._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(l1(e,zn._jsonSchema))return new zn(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-CM;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}zn._jsonSchemaVersion="firestore/timestamp/1.0",zn._jsonSchema={type:Kr("string",zn._jsonSchemaVersion),seconds:Kr("number"),nanoseconds:Kr("number")};class Mt{static fromTimestamp(e){return new Mt(e)}static min(){return new Mt(new zn(0,0))}static max(){return new Mt(new zn(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const lp=-1;class Rx{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function OT(n){return n.fields.find((e=>e.kind===2))}function ah(n){return n.fields.filter((e=>e.kind!==2))}Rx.UNKNOWN_ID=-1;class M_{constructor(e,t){this.fieldPath=e,this.kind=t}}class cp{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new cp(0,na.min())}}function Jq(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Mt.fromTimestamp(r===1e9?new zn(t+1,0):new zn(t,r));return new na(i,ct.empty(),e)}function L6(n){return new na(n.readTime,n.key,lp)}class na{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new na(Mt.min(),ct.empty(),lp)}static max(){return new na(Mt.max(),ct.empty(),lp)}}function ZI(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=ct.comparator(n.documentKey,e.documentKey),t!==0?t:Xt(n.largestBatchId,e.largestBatchId))}const O6="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class D6{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function gd(n){if(n.code!==Pe.FAILED_PRECONDITION||n.message!==O6)throw n;Ze("LocalStore","Unexpectedly lost primary lease")}class fe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Et(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new fe(((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof fe?t:fe.resolve(t)}catch(t){return fe.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):fe.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):fe.reject(t)}static resolve(e){return new fe(((t,r)=>{t(e)}))}static reject(e){return new fe(((t,r)=>{r(e)}))}static waitFor(e){return new fe(((t,r)=>{let i=0,s=0,a=!1;e.forEach((o=>{++i,o.next((()=>{++s,a&&s===i&&t()}),(l=>r(l)))})),a=!0,s===i&&t()}))}static or(e){let t=fe.resolve(!1);for(const r of e)t=t.next((i=>i?fe.resolve(i):r()));return t}static forEach(e,t){const r=[];return e.forEach(((i,s)=>{r.push(t.call(this,i,s))})),this.waitFor(r)}static mapArray(e,t){return new fe(((r,i)=>{const s=e.length,a=new Array(s);let o=0;for(let l=0;l<s;l++){const u=l;t(e[u]).next((h=>{a[u]=h,++o,o===s&&r(a)}),(h=>i(h)))}}))}static doWhile(e,t){return new fe(((r,i)=>{const s=()=>{e()===!0?t().next((()=>{s()}),i):r()};s()}))}}const $s="SimpleDb";class rw{static open(e,t,r,i){try{return new rw(t,e.transaction(i,r))}catch(s){throw new _m(t,s)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new Uo,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new _m(e,t.error)):this.S.resolve()},this.transaction.onerror=r=>{const i=QI(r.target.error);this.S.reject(new _m(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(Ze($s,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new tZ(t)}}class su{static delete(e){return Ze($s,"Removing database:",e),dh(CD().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!jD())return!1;if(su.F())return!0;const e=ii(),t=su.M(e),r=0<t&&t<10,i=F6(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.N=r,this.B=null,su.M(ii())===12.2&&ls("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(Ze($s,"Opening database:",this.name),this.db=await new Promise(((t,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const a=s.target.result;t(a)},i.onblocked=()=>{r(new _m(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const a=s.target.error;a.name==="VersionError"?r(new at(Pe.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):a.name==="InvalidStateError"?r(new at(Pe.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a)):r(new _m(e,a))},i.onupgradeneeded=s=>{Ze($s,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const a=s.target.result;this.N.k(a,i.transaction,s.oldVersion,this.version).next((()=>{Ze($s,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,i){const s=t==="readonly";let a=0;for(;;){++a;try{this.db=await this.L(e);const o=rw.open(this.db,e,s?"readonly":"readwrite",r),l=i(o).next((u=>(o.C(),u))).catch((u=>(o.abort(u),fe.reject(u)))).toPromise();return l.catch((()=>{})),await o.D,l}catch(o){const l=o,u=l.name!=="FirebaseError"&&a<3;if(Ze($s,"Transaction failed with error:",l.message,"Retrying:",u),this.close(),!u)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function F6(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class eZ{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return dh(this.U.delete())}}class _m extends at{constructor(e,t){super(Pe.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Tu(n){return n.name==="IndexedDbTransactionError"}class tZ{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(Ze($s,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(Ze($s,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),dh(r)}add(e){return Ze($s,"ADD",this.store.name,e,e),dh(this.store.add(e))}get(e){return dh(this.store.get(e)).next((t=>(t===void 0&&(t=null),Ze($s,"GET",this.store.name,e,t),t)))}delete(e){return Ze($s,"DELETE",this.store.name,e),dh(this.store.delete(e))}count(){return Ze($s,"COUNT",this.store.name),dh(this.store.count())}J(e,t){const r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(r.range);return new fe(((a,o)=>{s.onerror=l=>{o(l.target.error)},s.onsuccess=l=>{a(l.target.result)}}))}{const s=this.cursor(r),a=[];return this.H(s,((o,l)=>{a.push(l)})).next((()=>a))}}Y(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new fe(((i,s)=>{r.onerror=a=>{s(a.target.error)},r.onsuccess=a=>{i(a.target.result)}}))}Z(e,t){Ze($s,"DELETE ALL",this.store.name);const r=this.options(e,t);r.X=!1;const i=this.cursor(r);return this.H(i,((s,a,o)=>o.delete()))}ee(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.H(i,t)}te(e){const t=this.cursor({});return new fe(((r,i)=>{t.onerror=s=>{const a=QI(s.target.error);i(a)},t.onsuccess=s=>{const a=s.target.result;a?e(a.primaryKey,a.value).next((o=>{o?a.continue():r()})):r()}}))}H(e,t){const r=[];return new fe(((i,s)=>{e.onerror=a=>{s(a.target.error)},e.onsuccess=a=>{const o=a.target.result;if(!o)return void i();const l=new eZ(o),u=t(o.primaryKey,o.value,l);if(u instanceof fe){const h=u.catch((f=>(l.done(),fe.reject(f))));r.push(h)}l.isDone?i():l.G===null?o.continue():o.continue(l.G)}})).next((()=>fe.waitFor(r)))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function dh(n){return new fe(((e,t)=>{n.onsuccess=r=>{const i=r.target.result;e(i)},n.onerror=r=>{const i=QI(r.target.error);t(i)}}))}let PM=!1;function QI(n){const e=su.M(ii());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new at("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return PM||(PM=!0,setTimeout((()=>{throw r}),0)),r}}return n}const xm="IndexBackfiller";class nZ{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){Ze(xm,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();Ze(xm,`Documents written: ${t}`)}catch(t){Tu(t)?Ze(xm,"Ignoring IndexedDB error during index backfill: ",t):await gd(t)}await this.re(6e4)}))}}class rZ{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const r=new Set;let i=t,s=!0;return fe.doWhile((()=>s===!0&&i>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((a=>{if(a!==null&&!r.has(a))return Ze(xm,`Processing collection: ${a}`),this.oe(e,a,i).next((o=>{i-=o,r.add(a)}));s=!1})))).next((()=>t-i))}oe(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next((s=>{const a=s.changes;return this.localStore.indexManager.updateIndexEntries(e,a).next((()=>this._e(i,s))).next((o=>(Ze(xm,`Updating offset: ${o}`),this.localStore.indexManager.updateCollectionGroup(e,t,o)))).next((()=>a.size))}))))}_e(e,t){let r=e;return t.changes.forEach(((i,s)=>{const a=L6(s);ZI(a,r)>0&&(r=a)})),new na(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}class Ta{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Ta.ce=-1;const Rh=-1;function iw(n){return n==null}function up(n){return n===0&&1/n==-1/0}function iZ(n){return typeof n=="number"&&Number.isInteger(n)&&!up(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const Cx="";function Yi(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=MM(e)),e=sZ(n.get(t),e);return MM(e)}function sZ(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const s=n.charAt(i);switch(s){case"\0":t+="";break;case Cx:t+="";break;default:t+=s}}return t}function MM(n){return n+Cx+""}function jo(n){const e=n.length;if(At(e>=2,64408,{path:n}),e===2)return At(n.charAt(0)===Cx&&n.charAt(1)==="",56145,{path:n}),kn.emptyPath();const t=e-2,r=[];let i="";for(let s=0;s<e;){const a=n.indexOf(Cx,s);switch((a<0||a>t)&&Et(50515,{path:n}),n.charAt(a+1)){case"":const o=n.substring(s,a);let l;i.length===0?l=o:(i+=o,l=i,i=""),r.push(l);break;case"":i+=n.substring(s,a),i+="\0";break;case"":i+=n.substring(s,a+1);break;default:Et(61167,{path:n})}s=a+2}return new kn(r)}const oh="remoteDocuments",c1="owner",uf="owner",hp="mutationQueues",aZ="userId",Ha="mutations",NM="batchId",Eh="userMutationsIndex",LM=["userId","batchId"];function N_(n,e){return[n,Yi(e)]}function j6(n,e,t){return[n,Yi(e),t]}const oZ={},m0="documentMutations",kx="remoteDocumentsV14",lZ=["prefixPath","collectionGroup","readTime","documentId"],L_="documentKeyIndex",cZ=["prefixPath","collectionGroup","documentId"],V6="collectionGroupIndex",uZ=["collectionGroup","readTime","prefixPath","documentId"],dp="remoteDocumentGlobal",DT="remoteDocumentGlobalKey",p0="targets",G6="queryTargetsIndex",hZ=["canonicalId","targetId"],y0="targetDocuments",dZ=["targetId","path"],JI="documentTargetsIndex",fZ=["path","targetId"],Px="targetGlobalKey",Ch="targetGlobal",fp="collectionParents",gZ=["collectionId","parent"],_0="clientMetadata",mZ="clientId",sw="bundles",pZ="bundleId",aw="namedQueries",yZ="name",eA="indexConfiguration",_Z="indexId",FT="collectionGroupIndex",xZ="collectionGroup",vm="indexState",vZ=["indexId","uid"],B6="sequenceNumberIndex",wZ=["uid","sequenceNumber"],wm="indexEntries",EZ=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],U6="documentKeyIndex",SZ=["indexId","uid","orderedDocumentKey"],ow="documentOverlays",TZ=["userId","collectionPath","documentId"],jT="collectionPathOverlayIndex",bZ=["userId","collectionPath","largestBatchId"],z6="collectionGroupOverlayIndex",IZ=["userId","collectionGroup","largestBatchId"],tA="globals",AZ="name",$6=[hp,Ha,m0,oh,p0,c1,Ch,y0,_0,dp,fp,sw,aw],RZ=[...$6,ow],W6=[hp,Ha,m0,kx,p0,c1,Ch,y0,_0,dp,fp,sw,aw,ow],H6=W6,nA=[...H6,eA,vm,wm],CZ=nA,K6=[...nA,tA],kZ=K6;class VT extends D6{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function si(n,e){const t=qt(n);return su.O(t.le,e)}function OM(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function bu(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Y6(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class pr{constructor(e,t){this.comparator=e,this.root=t||Ai.EMPTY}insert(e,t){return new pr(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ai.BLACK,null,null))}remove(e){return new pr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ai.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Qy(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Qy(this.root,e,this.comparator,!1)}getReverseIterator(){return new Qy(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Qy(this.root,e,this.comparator,!0)}}class Qy{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ai{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??Ai.RED,this.left=i??Ai.EMPTY,this.right=s??Ai.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new Ai(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Ai.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return Ai.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ai.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ai.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Et(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Et(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Et(27949);return e+(this.isRed()?0:1)}}Ai.EMPTY=null,Ai.RED=!0,Ai.BLACK=!1;Ai.EMPTY=new class{constructor(){this.size=0}get key(){throw Et(57766)}get value(){throw Et(16141)}get color(){throw Et(16727)}get left(){throw Et(29726)}get right(){throw Et(36894)}copy(e,t,r,i,s){return this}insert(e,t,r){return new Ai(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Kn{constructor(e){this.comparator=e,this.data=new pr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new DM(this.data.getIterator())}getIteratorFrom(e){return new DM(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof Kn)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Kn(this.comparator);return t.data=e,t}}class DM{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function hf(n){return n.hasNext()?n.getNext():void 0}class As{constructor(e){this.fields=e,e.sort(Er.comparator)}static empty(){return new As([])}unionWith(e){let t=new Kn(Er.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new As(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return g0(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}class X6 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Xr{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new X6("Invalid base64 string: "+s):s}})(e);return new Xr(t)}static fromUint8Array(e){const t=(function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s})(e);return new Xr(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Xt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Xr.EMPTY_BYTE_STRING=new Xr("");const PZ=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ul(n){if(At(!!n,39018),typeof n=="string"){let e=0;const t=PZ.exec(n);if(At(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:gr(n.seconds),nanos:gr(n.nanos)}}function gr(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function zl(n){return typeof n=="string"?Xr.fromBase64String(n):Xr.fromUint8Array(n)}const q6="server_timestamp",Z6="__type__",Q6="__previous_value__",J6="__local_write_time__";function rA(n){return(n?.mapValue?.fields||{})[Z6]?.stringValue===q6}function lw(n){const e=n.mapValue.fields[Q6];return rA(e)?lw(e):e}function gp(n){const e=Ul(n.mapValue.fields[J6].timestampValue);return new zn(e.seconds,e.nanos)}class MZ{constructor(e,t,r,i,s,a,o,l,u,h){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=u,this.isUsingEmulator=h}}const Mx="(default)";class Yh{constructor(e,t){this.projectId=e,this.database=t||Mx}static empty(){return new Yh("","")}get isDefaultDatabase(){return this.database===Mx}isEqual(e){return e instanceof Yh&&e.projectId===this.projectId&&e.database===this.database}}const iA="__type__",eF="__max__",Yc={mapValue:{fields:{__type__:{stringValue:eF}}}},sA="__vector__",x0="value",O_={nullValue:"NULL_VALUE"};function hu(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?rA(n)?4:tF(n)?9007199254740991:cw(n)?10:11:Et(28295,{value:n})}function Zo(n,e){if(n===e)return!0;const t=hu(n);if(t!==hu(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return gp(n).isEqual(gp(e));case 3:return(function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=Ul(i.timestampValue),o=Ul(s.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,s){return zl(i.bytesValue).isEqual(zl(s.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,s){return gr(i.geoPointValue.latitude)===gr(s.geoPointValue.latitude)&&gr(i.geoPointValue.longitude)===gr(s.geoPointValue.longitude)})(n,e);case 2:return(function(i,s){if("integerValue"in i&&"integerValue"in s)return gr(i.integerValue)===gr(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=gr(i.doubleValue),o=gr(s.doubleValue);return a===o?up(a)===up(o):isNaN(a)&&isNaN(o)}return!1})(n,e);case 9:return g0(n.arrayValue.values||[],e.arrayValue.values||[],Zo);case 10:case 11:return(function(i,s){const a=i.mapValue.fields||{},o=s.mapValue.fields||{};if(OM(a)!==OM(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!Zo(a[l],o[l])))return!1;return!0})(n,e);default:return Et(52216,{left:n})}}function mp(n,e){return(n.values||[]).find((t=>Zo(t,e)))!==void 0}function du(n,e){if(n===e)return 0;const t=hu(n),r=hu(e);if(t!==r)return Xt(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Xt(n.booleanValue,e.booleanValue);case 2:return(function(s,a){const o=gr(s.integerValue||s.doubleValue),l=gr(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1})(n,e);case 3:return FM(n.timestampValue,e.timestampValue);case 4:return FM(gp(n),gp(e));case 5:return LT(n.stringValue,e.stringValue);case 6:return(function(s,a){const o=zl(s),l=zl(a);return o.compareTo(l)})(n.bytesValue,e.bytesValue);case 7:return(function(s,a){const o=s.split("/"),l=a.split("/");for(let u=0;u<o.length&&u<l.length;u++){const h=Xt(o[u],l[u]);if(h!==0)return h}return Xt(o.length,l.length)})(n.referenceValue,e.referenceValue);case 8:return(function(s,a){const o=Xt(gr(s.latitude),gr(a.latitude));return o!==0?o:Xt(gr(s.longitude),gr(a.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return jM(n.arrayValue,e.arrayValue);case 10:return(function(s,a){const o=s.fields||{},l=a.fields||{},u=o[x0]?.arrayValue,h=l[x0]?.arrayValue,f=Xt(u?.values?.length||0,h?.values?.length||0);return f!==0?f:jM(u,h)})(n.mapValue,e.mapValue);case 11:return(function(s,a){if(s===Yc.mapValue&&a===Yc.mapValue)return 0;if(s===Yc.mapValue)return 1;if(a===Yc.mapValue)return-1;const o=s.fields||{},l=Object.keys(o),u=a.fields||{},h=Object.keys(u);l.sort(),h.sort();for(let f=0;f<l.length&&f<h.length;++f){const g=LT(l[f],h[f]);if(g!==0)return g;const y=du(o[l[f]],u[h[f]]);if(y!==0)return y}return Xt(l.length,h.length)})(n.mapValue,e.mapValue);default:throw Et(23264,{he:t})}}function FM(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Xt(n,e);const t=Ul(n),r=Ul(e),i=Xt(t.seconds,r.seconds);return i!==0?i:Xt(t.nanos,r.nanos)}function jM(n,e){const t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const s=du(t[i],r[i]);if(s)return s}return Xt(t.length,r.length)}function v0(n){return GT(n)}function GT(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=Ul(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return zl(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return ct.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(const s of t.values||[])i?i=!1:r+=",",r+=GT(s);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const a of r)s?s=!1:i+=",",i+=`${a}:${GT(t.fields[a])}`;return i+"}"})(n.mapValue):Et(61005,{value:n})}function D_(n){switch(hu(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=lw(n);return e?16+D_(e):16;case 5:return 2*n.stringValue.length;case 6:return zl(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((i,s)=>i+D_(s)),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return bu(r.fields,((s,a)=>{i+=s.length+D_(a)})),i})(n.mapValue);default:throw Et(13486,{value:n})}}function pp(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function BT(n){return!!n&&"integerValue"in n}function yp(n){return!!n&&"arrayValue"in n}function VM(n){return!!n&&"nullValue"in n}function GM(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function F_(n){return!!n&&"mapValue"in n}function cw(n){return(n?.mapValue?.fields||{})[iA]?.stringValue===sA}function Em(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return bu(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=Em(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Em(n.arrayValue.values[t]);return e}return{...n}}function tF(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===eF}const nF={mapValue:{fields:{[iA]:{stringValue:sA},[x0]:{arrayValue:{}}}}};function NZ(n){return"nullValue"in n?O_:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?pp(Yh.empty(),ct.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?cw(n)?nF:{mapValue:{}}:Et(35942,{value:n})}function LZ(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?pp(Yh.empty(),ct.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?nF:"mapValue"in n?cw(n)?{mapValue:{}}:Yc:Et(61959,{value:n})}function BM(n,e){const t=du(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function UM(n,e){const t=du(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class Wi{constructor(e){this.value=e}static empty(){return new Wi({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!F_(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Em(t)}setAll(e){let t=Er.emptyPath(),r={},i=[];e.forEach(((a,o)=>{if(!t.isImmediateParentOf(o)){const l=this.getFieldsMap(t);this.applyChanges(l,r,i),r={},i=[],t=o.popLast()}a?r[o.lastSegment()]=Em(a):i.push(o.lastSegment())}));const s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){const t=this.field(e.popLast());F_(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Zo(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];F_(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){bu(t,((i,s)=>e[i]=s));for(const i of r)delete e[i]}clone(){return new Wi(Em(this.value))}}function rF(n){const e=[];return bu(n.fields,((t,r)=>{const i=new Er([t]);if(F_(r)){const s=rF(r.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)})),new As(e)}class Cr{constructor(e,t,r,i,s,a,o){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(e){return new Cr(e,0,Mt.min(),Mt.min(),Mt.min(),Wi.empty(),0)}static newFoundDocument(e,t,r,i){return new Cr(e,1,t,Mt.min(),r,i,0)}static newNoDocument(e,t){return new Cr(e,2,t,Mt.min(),Mt.min(),Wi.empty(),0)}static newUnknownDocument(e,t){return new Cr(e,3,t,Mt.min(),Mt.min(),Wi.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Mt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Wi.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Wi.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Mt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Cr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Cr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class w0{constructor(e,t){this.position=e,this.inclusive=t}}function zM(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const s=e[i],a=n.position[i];if(s.field.isKeyField()?r=ct.comparator(ct.fromName(a.referenceValue),t.key):r=du(a,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function $M(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Zo(n.position[t],e.position[t]))return!1;return!0}class Nx{constructor(e,t="asc"){this.field=e,this.dir=t}}function OZ(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class iF{}class dn extends iF{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new DZ(e,t,r):t==="array-contains"?new VZ(e,r):t==="in"?new uF(e,r):t==="not-in"?new GZ(e,r):t==="array-contains-any"?new BZ(e,r):new dn(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new FZ(e,r):new jZ(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(du(t,this.value)):t!==null&&hu(this.value)===hu(t)&&this.matchesComparison(du(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Et(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Wn extends iF{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Wn(e,t)}matches(e){return E0(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function E0(n){return n.op==="and"}function UT(n){return n.op==="or"}function aA(n){return sF(n)&&E0(n)}function sF(n){for(const e of n.filters)if(e instanceof Wn)return!1;return!0}function zT(n){if(n instanceof dn)return n.field.canonicalString()+n.op.toString()+v0(n.value);if(aA(n))return n.filters.map((e=>zT(e))).join(",");{const e=n.filters.map((t=>zT(t))).join(",");return`${n.op}(${e})`}}function aF(n,e){return n instanceof dn?(function(r,i){return i instanceof dn&&r.op===i.op&&r.field.isEqual(i.field)&&Zo(r.value,i.value)})(n,e):n instanceof Wn?(function(r,i){return i instanceof Wn&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce(((s,a,o)=>s&&aF(a,i.filters[o])),!0):!1})(n,e):void Et(19439)}function oF(n,e){const t=n.filters.concat(e);return Wn.create(t,n.op)}function lF(n){return n instanceof dn?(function(t){return`${t.field.canonicalString()} ${t.op} ${v0(t.value)}`})(n):n instanceof Wn?(function(t){return t.op.toString()+" {"+t.getFilters().map(lF).join(" ,")+"}"})(n):"Filter"}class DZ extends dn{constructor(e,t,r){super(e,t,r),this.key=ct.fromName(r.referenceValue)}matches(e){const t=ct.comparator(e.key,this.key);return this.matchesComparison(t)}}class FZ extends dn{constructor(e,t){super(e,"in",t),this.keys=cF("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class jZ extends dn{constructor(e,t){super(e,"not-in",t),this.keys=cF("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function cF(n,e){return(e.arrayValue?.values||[]).map((t=>ct.fromName(t.referenceValue)))}class VZ extends dn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return yp(t)&&mp(t.arrayValue,this.value)}}class uF extends dn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&mp(this.value.arrayValue,t)}}class GZ extends dn{constructor(e,t){super(e,"not-in",t)}matches(e){if(mp(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!mp(this.value.arrayValue,t)}}class BZ extends dn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!yp(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>mp(this.value.arrayValue,r)))}}class UZ{constructor(e,t=null,r=[],i=[],s=null,a=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=a,this.endAt=o,this.Te=null}}function $T(n,e=null,t=[],r=[],i=null,s=null,a=null){return new UZ(n,e,t,r,i,s,a)}function Xh(n){const e=qt(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>zT(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(s){return s.field.canonicalString()+s.dir})(r))).join(","),iw(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>v0(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>v0(r))).join(",")),e.Te=t}return e.Te}function u1(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!OZ(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!aF(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!$M(n.startAt,e.startAt)&&$M(n.endAt,e.endAt)}function Lx(n){return ct.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Ox(n,e){return n.filters.filter((t=>t instanceof dn&&t.field.isEqual(e)))}function WM(n,e,t){let r=O_,i=!0;for(const s of Ox(n,e)){let a=O_,o=!0;switch(s.op){case"<":case"<=":a=NZ(s.value);break;case"==":case"in":case">=":a=s.value;break;case">":a=s.value,o=!1;break;case"!=":case"not-in":a=O_}BM({value:r,inclusive:i},{value:a,inclusive:o})<0&&(r=a,i=o)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const a=t.position[s];BM({value:r,inclusive:i},{value:a,inclusive:t.inclusive})<0&&(r=a,i=t.inclusive);break}}return{value:r,inclusive:i}}function HM(n,e,t){let r=Yc,i=!0;for(const s of Ox(n,e)){let a=Yc,o=!0;switch(s.op){case">=":case">":a=LZ(s.value),o=!1;break;case"==":case"in":case"<=":a=s.value;break;case"<":a=s.value,o=!1;break;case"!=":case"not-in":a=Yc}UM({value:r,inclusive:i},{value:a,inclusive:o})>0&&(r=a,i=o)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const a=t.position[s];UM({value:r,inclusive:i},{value:a,inclusive:t.inclusive})>0&&(r=a,i=t.inclusive);break}}return{value:r,inclusive:i}}class h1{constructor(e,t=null,r=[],i=[],s=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function zZ(n,e,t,r,i,s,a,o){return new h1(n,e,t,r,i,s,a,o)}function uw(n){return new h1(n)}function KM(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function hF(n){return n.collectionGroup!==null}function Sm(n){const e=qt(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),t.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new Kn(Er.comparator);return a.filters.forEach((l=>{l.getFlattenedFilters().forEach((u=>{u.isInequality()&&(o=o.add(u.field))}))})),o})(e).forEach((s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new Nx(s,r))})),t.has(Er.keyField().canonicalString())||e.Ie.push(new Nx(Er.keyField(),r))}return e.Ie}function Ia(n){const e=qt(n);return e.Ee||(e.Ee=$Z(e,Sm(n))),e.Ee}function $Z(n,e){if(n.limitType==="F")return $T(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((i=>{const s=i.dir==="desc"?"asc":"desc";return new Nx(i.field,s)}));const t=n.endAt?new w0(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new w0(n.startAt.position,n.startAt.inclusive):null;return $T(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function WT(n,e){const t=n.filters.concat([e]);return new h1(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function HT(n,e,t){return new h1(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function hw(n,e){return u1(Ia(n),Ia(e))&&n.limitType===e.limitType}function dF(n){return`${Xh(Ia(n))}|lt:${n.limitType}`}function bf(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((i=>lF(i))).join(", ")}]`),iw(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((i=>(function(a){return`${a.field.canonicalString()} (${a.dir})`})(i))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((i=>v0(i))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((i=>v0(i))).join(",")),`Target(${r})`})(Ia(n))}; limitType=${n.limitType})`}function d1(n,e){return e.isFoundDocument()&&(function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):ct.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)})(n,e)&&(function(r,i){for(const s of Sm(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(a,o,l){const u=zM(a,o,l);return a.inclusive?u<=0:u<0})(r.startAt,Sm(r),i)||r.endAt&&!(function(a,o,l){const u=zM(a,o,l);return a.inclusive?u>=0:u>0})(r.endAt,Sm(r),i))})(n,e)}function WZ(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function fF(n){return(e,t)=>{let r=!1;for(const i of Sm(n)){const s=HZ(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function HZ(n,e,t){const r=n.field.isKeyField()?ct.comparator(e.key,t.key):(function(s,a,o){const l=a.data.field(s),u=o.data.field(s);return l!==null&&u!==null?du(l,u):Et(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Et(19790,{direction:n.dir})}}class ql{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){bu(this.inner,((t,r)=>{for(const[i,s]of r)e(i,s)}))}isEmpty(){return Y6(this.inner)}size(){return this.innerSize}}const KZ=new pr(ct.comparator);function Qs(){return KZ}const gF=new pr(ct.comparator);function rm(...n){let e=gF;for(const t of n)e=e.insert(t.key,t);return e}function mF(n){let e=gF;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function Vo(){return Tm()}function pF(){return Tm()}function Tm(){return new ql((n=>n.toString()),((n,e)=>n.isEqual(e)))}const YZ=new pr(ct.comparator),XZ=new Kn(ct.comparator);function an(...n){let e=XZ;for(const t of n)e=e.add(t);return e}const qZ=new Kn(Xt);function ZZ(){return qZ}function oA(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:up(e)?"-0":e}}function yF(n){return{integerValue:""+n}}function QZ(n,e){return iZ(e)?yF(e):oA(n,e)}class dw{constructor(){this._=void 0}}function JZ(n,e,t){return n instanceof S0?(function(i,s){const a={fields:{[Z6]:{stringValue:q6},[J6]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&rA(s)&&(s=lw(s)),s&&(a.fields[Q6]=s),{mapValue:a}})(t,e):n instanceof T0?xF(n,e):n instanceof b0?vF(n,e):(function(i,s){const a=_F(i,s),o=YM(a)+YM(i.Ae);return BT(a)&&BT(i.Ae)?yF(o):oA(i.serializer,o)})(n,e)}function eQ(n,e,t){return n instanceof T0?xF(n,e):n instanceof b0?vF(n,e):t}function _F(n,e){return n instanceof _p?(function(r){return BT(r)||(function(s){return!!s&&"doubleValue"in s})(r)})(e)?e:{integerValue:0}:null}class S0 extends dw{}class T0 extends dw{constructor(e){super(),this.elements=e}}function xF(n,e){const t=wF(e);for(const r of n.elements)t.some((i=>Zo(i,r)))||t.push(r);return{arrayValue:{values:t}}}class b0 extends dw{constructor(e){super(),this.elements=e}}function vF(n,e){let t=wF(e);for(const r of n.elements)t=t.filter((i=>!Zo(i,r)));return{arrayValue:{values:t}}}class _p extends dw{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function YM(n){return gr(n.integerValue||n.doubleValue)}function wF(n){return yp(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class EF{constructor(e,t){this.field=e,this.transform=t}}function tQ(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof T0&&i instanceof T0||r instanceof b0&&i instanceof b0?g0(r.elements,i.elements,Zo):r instanceof _p&&i instanceof _p?Zo(r.Ae,i.Ae):r instanceof S0&&i instanceof S0})(n.transform,e.transform)}class nQ{constructor(e,t){this.version=e,this.transformResults=t}}class Hi{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Hi}static exists(e){return new Hi(void 0,e)}static updateTime(e){return new Hi(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function j_(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class fw{}function SF(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new gw(n.key,Hi.none()):new B0(n.key,n.data,Hi.none());{const t=n.data,r=Wi.empty();let i=new Kn(Er.comparator);for(let s of e.fields)if(!i.has(s)){let a=t.field(s);a===null&&s.length>1&&(s=s.popLast(),a=t.field(s)),a===null?r.delete(s):r.set(s,a),i=i.add(s)}return new Zl(n.key,r,new As(i.toArray()),Hi.none())}}function rQ(n,e,t){n instanceof B0?(function(i,s,a){const o=i.value.clone(),l=qM(i.fieldTransforms,s,a.transformResults);o.setAll(l),s.convertToFoundDocument(a.version,o).setHasCommittedMutations()})(n,e,t):n instanceof Zl?(function(i,s,a){if(!j_(i.precondition,s))return void s.convertToUnknownDocument(a.version);const o=qM(i.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(TF(i)),l.setAll(o),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()})(n,e,t):(function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()})(0,e,t)}function bm(n,e,t,r){return n instanceof B0?(function(s,a,o,l){if(!j_(s.precondition,a))return o;const u=s.value.clone(),h=ZM(s.fieldTransforms,l,a);return u.setAll(h),a.convertToFoundDocument(a.version,u).setHasLocalMutations(),null})(n,e,t,r):n instanceof Zl?(function(s,a,o,l){if(!j_(s.precondition,a))return o;const u=ZM(s.fieldTransforms,l,a),h=a.data;return h.setAll(TF(s)),h.setAll(u),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map((f=>f.field)))})(n,e,t,r):(function(s,a,o){return j_(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o})(n,e,t)}function iQ(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),s=_F(r.transform,i||null);s!=null&&(t===null&&(t=Wi.empty()),t.set(r.field,s))}return t||null}function XM(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&g0(r,i,((s,a)=>tQ(s,a)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class B0 extends fw{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Zl extends fw{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function TF(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function qM(n,e,t){const r=new Map;At(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let i=0;i<t.length;i++){const s=n[i],a=s.transform,o=e.data.field(s.field);r.set(s.field,eQ(a,o,t[i]))}return r}function ZM(n,e,t){const r=new Map;for(const i of n){const s=i.transform,a=t.data.field(i.field);r.set(i.field,JZ(s,a,e))}return r}class gw extends fw{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class bF extends fw{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class lA{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&rQ(s,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=bm(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=bm(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=pF();return this.mutations.forEach((i=>{const s=e.get(i.key),a=s.overlayedDocument;let o=this.applyToLocalView(a,s.mutatedFields);o=t.has(i.key)?null:o;const l=SF(a,o);l!==null&&r.set(i.key,l),a.isValidDocument()||a.convertToNoDocument(Mt.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),an())}isEqual(e){return this.batchId===e.batchId&&g0(this.mutations,e.mutations,((t,r)=>XM(t,r)))&&g0(this.baseMutations,e.baseMutations,((t,r)=>XM(t,r)))}}class cA{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){At(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=(function(){return YZ})();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,r[a].version);return new cA(e,t,r,i)}}class uA{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class sQ{constructor(e,t){this.count=e,this.unchangedNames=t}}var $r,pn;function aQ(n){switch(n){case Pe.OK:return Et(64938);case Pe.CANCELLED:case Pe.UNKNOWN:case Pe.DEADLINE_EXCEEDED:case Pe.RESOURCE_EXHAUSTED:case Pe.INTERNAL:case Pe.UNAVAILABLE:case Pe.UNAUTHENTICATED:return!1;case Pe.INVALID_ARGUMENT:case Pe.NOT_FOUND:case Pe.ALREADY_EXISTS:case Pe.PERMISSION_DENIED:case Pe.FAILED_PRECONDITION:case Pe.ABORTED:case Pe.OUT_OF_RANGE:case Pe.UNIMPLEMENTED:case Pe.DATA_LOSS:return!0;default:return Et(15467,{code:n})}}function IF(n){if(n===void 0)return ls("GRPC error has no .code"),Pe.UNKNOWN;switch(n){case $r.OK:return Pe.OK;case $r.CANCELLED:return Pe.CANCELLED;case $r.UNKNOWN:return Pe.UNKNOWN;case $r.DEADLINE_EXCEEDED:return Pe.DEADLINE_EXCEEDED;case $r.RESOURCE_EXHAUSTED:return Pe.RESOURCE_EXHAUSTED;case $r.INTERNAL:return Pe.INTERNAL;case $r.UNAVAILABLE:return Pe.UNAVAILABLE;case $r.UNAUTHENTICATED:return Pe.UNAUTHENTICATED;case $r.INVALID_ARGUMENT:return Pe.INVALID_ARGUMENT;case $r.NOT_FOUND:return Pe.NOT_FOUND;case $r.ALREADY_EXISTS:return Pe.ALREADY_EXISTS;case $r.PERMISSION_DENIED:return Pe.PERMISSION_DENIED;case $r.FAILED_PRECONDITION:return Pe.FAILED_PRECONDITION;case $r.ABORTED:return Pe.ABORTED;case $r.OUT_OF_RANGE:return Pe.OUT_OF_RANGE;case $r.UNIMPLEMENTED:return Pe.UNIMPLEMENTED;case $r.DATA_LOSS:return Pe.DATA_LOSS;default:return Et(39323,{code:n})}}(pn=$r||($r={}))[pn.OK=0]="OK",pn[pn.CANCELLED=1]="CANCELLED",pn[pn.UNKNOWN=2]="UNKNOWN",pn[pn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",pn[pn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",pn[pn.NOT_FOUND=5]="NOT_FOUND",pn[pn.ALREADY_EXISTS=6]="ALREADY_EXISTS",pn[pn.PERMISSION_DENIED=7]="PERMISSION_DENIED",pn[pn.UNAUTHENTICATED=16]="UNAUTHENTICATED",pn[pn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",pn[pn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",pn[pn.ABORTED=10]="ABORTED",pn[pn.OUT_OF_RANGE=11]="OUT_OF_RANGE",pn[pn.UNIMPLEMENTED=12]="UNIMPLEMENTED",pn[pn.INTERNAL=13]="INTERNAL",pn[pn.UNAVAILABLE=14]="UNAVAILABLE",pn[pn.DATA_LOSS=15]="DATA_LOSS";function oQ(){return new TextEncoder}const lQ=new iu([4294967295,4294967295],0);function QM(n){const e=oQ().encode(n),t=new S6;return t.update(e),new Uint8Array(t.digest())}function JM(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new iu([t,r],0),new iu([i,s],0)]}class hA{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new im(`Invalid padding: ${t}`);if(r<0)throw new im(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new im(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new im(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=iu.fromNumber(this.ge)}ye(e,t,r){let i=e.add(t.multiply(iu.fromNumber(r)));return i.compare(lQ)===1&&(i=new iu([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=QM(e),[r,i]=JM(t);for(let s=0;s<this.hashCount;s++){const a=this.ye(r,i,s);if(!this.we(a))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new hA(s,i,t);return r.forEach((o=>a.insert(o))),a}insert(e){if(this.ge===0)return;const t=QM(e),[r,i]=JM(t);for(let s=0;s<this.hashCount;s++){const a=this.ye(r,i,s);this.Se(a)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class im extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class mw{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,f1.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new mw(Mt.min(),i,new pr(Xt),Qs(),an())}}class f1{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new f1(r,t,an(),an(),an())}}class V_{constructor(e,t,r,i){this.be=e,this.removedTargetIds=t,this.key=r,this.De=i}}class AF{constructor(e,t){this.targetId=e,this.Ce=t}}class RF{constructor(e,t,r=Xr.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class eN{constructor(){this.ve=0,this.Fe=tN(),this.Me=Xr.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=an(),t=an(),r=an();return this.Fe.forEach(((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:Et(38017,{changeType:s})}})),new f1(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=tN()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,At(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class cQ{constructor(e){this.Ge=e,this.ze=new Map,this.je=Qs(),this.Je=Jy(),this.He=Jy(),this.Ye=new pr(Xt)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:Et(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,i)=>{this.rt(i)&&t(i)}))}st(e){const t=e.targetId,r=e.Ce.count,i=this.ot(t);if(i){const s=i.target;if(Lx(s))if(r===0){const a=new ct(s.path);this.et(t,a,Cr.newNoDocument(a,Mt.min()))}else At(r===1,20013,{expectedCount:r});else{const a=this._t(t);if(a!==r){const o=this.ut(e),l=o?this.ct(o,e,a):1;if(l!==0){this.it(t);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,u)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t;let a,o;try{a=zl(r).toUint8Array()}catch(l){if(l instanceof X6)return Kh("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new hA(a,i,s)}catch(l){return Kh(l instanceof im?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.ge===0?null:o}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let i=0;return r.forEach((s=>{const a=this.Ge.ht(),o=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(o)||(this.et(t,s,null),i++)})),i}Tt(e){const t=new Map;this.ze.forEach(((s,a)=>{const o=this.ot(a);if(o){if(s.current&&Lx(o.target)){const l=new ct(o.target.path);this.It(l).has(a)||this.Et(a,l)||this.et(a,l,Cr.newNoDocument(l,e))}s.Be&&(t.set(a,s.ke()),s.qe())}}));let r=an();this.He.forEach(((s,a)=>{let o=!0;a.forEachWhile((l=>{const u=this.ot(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)})),o&&(r=r.add(s))})),this.je.forEach(((s,a)=>a.setReadTime(e)));const i=new mw(e,t,this.Ye,this.je,r);return this.je=Qs(),this.Je=Jy(),this.He=Jy(),this.Ye=new pr(Xt),i}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,t)?i.Qe(t,1):i.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new eN,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Kn(Xt),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Kn(Xt),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Ze("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new eN),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Jy(){return new pr(ct.comparator)}function tN(){return new pr(ct.comparator)}const uQ={asc:"ASCENDING",desc:"DESCENDING"},hQ={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},dQ={and:"AND",or:"OR"};class fQ{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function KT(n,e){return n.useProto3Json||iw(e)?e:{value:e}}function I0(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function CF(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function gQ(n,e){return I0(n,e.toTimestamp())}function us(n){return At(!!n,49232),Mt.fromTimestamp((function(t){const r=Ul(t);return new zn(r.seconds,r.nanos)})(n))}function dA(n,e){return YT(n,e).canonicalString()}function YT(n,e){const t=(function(i){return new kn(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function kF(n){const e=kn.fromString(n);return At(VF(e),10190,{key:e.toString()}),e}function Dx(n,e){return dA(n.databaseId,e.path)}function kh(n,e){const t=kF(e);if(t.get(1)!==n.databaseId.projectId)throw new at(Pe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new at(Pe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new ct(NF(t))}function PF(n,e){return dA(n.databaseId,e)}function MF(n){const e=kF(n);return e.length===4?kn.emptyPath():NF(e)}function XT(n){return new kn(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function NF(n){return At(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function nN(n,e,t){return{name:Dx(n,e),fields:t.value.mapValue.fields}}function mQ(n,e,t){const r=kh(n,e.name),i=us(e.updateTime),s=e.createTime?us(e.createTime):Mt.min(),a=new Wi({mapValue:{fields:e.fields}}),o=Cr.newFoundDocument(r,i,s,a);return t&&o.setHasCommittedMutations(),t?o.setHasCommittedMutations():o}function pQ(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:Et(39313,{state:u})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=(function(u,h){return u.useProto3Json?(At(h===void 0||typeof h=="string",58123),Xr.fromBase64String(h||"")):(At(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),Xr.fromUint8Array(h||new Uint8Array))})(n,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&(function(u){const h=u.code===void 0?Pe.UNKNOWN:IF(u.code);return new at(h,u.message||"")})(a);t=new RF(r,i,s,o||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=kh(n,r.document.name),s=us(r.document.updateTime),a=r.document.createTime?us(r.document.createTime):Mt.min(),o=new Wi({mapValue:{fields:r.document.fields}}),l=Cr.newFoundDocument(i,s,a,o),u=r.targetIds||[],h=r.removedTargetIds||[];t=new V_(u,h,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=kh(n,r.document),s=r.readTime?us(r.readTime):Mt.min(),a=Cr.newNoDocument(i,s),o=r.removedTargetIds||[];t=new V_([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=kh(n,r.document),s=r.removedTargetIds||[];t=new V_([],s,i,null)}else{if(!("filter"in e))return Et(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,a=new sQ(i,s),o=r.targetId;t=new AF(o,a)}}return t}function Fx(n,e){let t;if(e instanceof B0)t={update:nN(n,e.key,e.value)};else if(e instanceof gw)t={delete:Dx(n,e.key)};else if(e instanceof Zl)t={update:nN(n,e.key,e.data),updateMask:EQ(e.fieldMask)};else{if(!(e instanceof bF))return Et(16599,{Vt:e.type});t={verify:Dx(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(s,a){const o=a.transform;if(o instanceof S0)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof T0)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof b0)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof _p)return{fieldPath:a.field.canonicalString(),increment:o.Ae};throw Et(20930,{transform:a.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(i,s){return s.updateTime!==void 0?{updateTime:gQ(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Et(27497)})(n,e.precondition)),t}function qT(n,e){const t=e.currentDocument?(function(s){return s.updateTime!==void 0?Hi.updateTime(us(s.updateTime)):s.exists!==void 0?Hi.exists(s.exists):Hi.none()})(e.currentDocument):Hi.none(),r=e.updateTransforms?e.updateTransforms.map((i=>(function(a,o){let l=null;if("setToServerValue"in o)At(o.setToServerValue==="REQUEST_TIME",16630,{proto:o}),l=new S0;else if("appendMissingElements"in o){const h=o.appendMissingElements.values||[];l=new T0(h)}else if("removeAllFromArray"in o){const h=o.removeAllFromArray.values||[];l=new b0(h)}else"increment"in o?l=new _p(a,o.increment):Et(16584,{proto:o});const u=Er.fromServerFormat(o.fieldPath);return new EF(u,l)})(n,i))):[];if(e.update){e.update.name;const i=kh(n,e.update.name),s=new Wi({mapValue:{fields:e.update.fields}});if(e.updateMask){const a=(function(l){const u=l.fieldPaths||[];return new As(u.map((h=>Er.fromServerFormat(h))))})(e.updateMask);return new Zl(i,s,a,t,r)}return new B0(i,s,t,r)}if(e.delete){const i=kh(n,e.delete);return new gw(i,t)}if(e.verify){const i=kh(n,e.verify);return new bF(i,t)}return Et(1463,{proto:e})}function yQ(n,e){return n&&n.length>0?(At(e!==void 0,14353),n.map((t=>(function(i,s){let a=i.updateTime?us(i.updateTime):us(s);return a.isEqual(Mt.min())&&(a=us(s)),new nQ(a,i.transformResults||[])})(t,e)))):[]}function LF(n,e){return{documents:[PF(n,e.path)]}}function OF(n,e){const t={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=PF(n,i);const s=(function(u){if(u.length!==0)return jF(Wn.create(u,"and"))})(e.filters);s&&(t.structuredQuery.where=s);const a=(function(u){if(u.length!==0)return u.map((h=>(function(g){return{field:If(g.field),direction:xQ(g.dir)}})(h)))})(e.orderBy);a&&(t.structuredQuery.orderBy=a);const o=KT(n,e.limit);return o!==null&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt=(function(u){return{before:u.inclusive,values:u.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(u){return{before:!u.inclusive,values:u.position}})(e.endAt)),{ft:t,parent:i}}function DF(n){let e=MF(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){At(r===1,65062);const h=t.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let s=[];t.where&&(s=(function(f){const g=FF(f);return g instanceof Wn&&aA(g)?g.getFilters():[g]})(t.where));let a=[];t.orderBy&&(a=(function(f){return f.map((g=>(function(v){return new Nx(Af(v.field),(function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(v.direction))})(g)))})(t.orderBy));let o=null;t.limit&&(o=(function(f){let g;return g=typeof f=="object"?f.value:f,iw(g)?null:g})(t.limit));let l=null;t.startAt&&(l=(function(f){const g=!!f.before,y=f.values||[];return new w0(y,g)})(t.startAt));let u=null;return t.endAt&&(u=(function(f){const g=!f.before,y=f.values||[];return new w0(y,g)})(t.endAt)),zZ(e,i,a,s,o,"F",l,u)}function _Q(n,e){const t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Et(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function FF(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Af(t.unaryFilter.field);return dn.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Af(t.unaryFilter.field);return dn.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Af(t.unaryFilter.field);return dn.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Af(t.unaryFilter.field);return dn.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Et(61313);default:return Et(60726)}})(n):n.fieldFilter!==void 0?(function(t){return dn.create(Af(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Et(58110);default:return Et(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Wn.create(t.compositeFilter.filters.map((r=>FF(r))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Et(1026)}})(t.compositeFilter.op))})(n):Et(30097,{filter:n})}function xQ(n){return uQ[n]}function vQ(n){return hQ[n]}function wQ(n){return dQ[n]}function If(n){return{fieldPath:n.canonicalString()}}function Af(n){return Er.fromServerFormat(n.fieldPath)}function jF(n){return n instanceof dn?(function(t){if(t.op==="=="){if(GM(t.value))return{unaryFilter:{field:If(t.field),op:"IS_NAN"}};if(VM(t.value))return{unaryFilter:{field:If(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(GM(t.value))return{unaryFilter:{field:If(t.field),op:"IS_NOT_NAN"}};if(VM(t.value))return{unaryFilter:{field:If(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:If(t.field),op:vQ(t.op),value:t.value}}})(n):n instanceof Wn?(function(t){const r=t.getFilters().map((i=>jF(i)));return r.length===1?r[0]:{compositeFilter:{op:wQ(t.op),filters:r}}})(n):Et(54877,{filter:n})}function EQ(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function VF(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class Il{constructor(e,t,r,i,s=Mt.min(),a=Mt.min(),o=Xr.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new Il(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Il(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Il(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Il(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class GF{constructor(e){this.yt=e}}function SQ(n,e){let t;if(e.document)t=mQ(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=ct.fromSegments(e.noDocument.path),i=Zh(e.noDocument.readTime);t=Cr.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Et(56709);{const r=ct.fromSegments(e.unknownDocument.path),i=Zh(e.unknownDocument.version);t=Cr.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime((function(i){const s=new zn(i[0],i[1]);return Mt.fromTimestamp(s)})(e.readTime)),t}function rN(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:jx(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=(function(s,a){return{name:Dx(s,a.key),fields:a.data.value.mapValue.fields,updateTime:I0(s,a.version.toTimestamp()),createTime:I0(s,a.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:qh(e.version)};else{if(!e.isUnknownDocument())return Et(57904,{document:e});r.unknownDocument={path:t.path.toArray(),version:qh(e.version)}}return r}function jx(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function qh(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Zh(n){const e=new zn(n.seconds,n.nanoseconds);return Mt.fromTimestamp(e)}function fh(n,e){const t=(e.baseMutations||[]).map((s=>qT(n.yt,s)));for(let s=0;s<e.mutations.length-1;++s){const a=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const o=e.mutations[s+1];a.updateTransforms=o.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map((s=>qT(n.yt,s))),i=zn.fromMillis(e.localWriteTimeMs);return new lA(e.batchId,i,t,r)}function sm(n){const e=Zh(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Zh(n.lastLimboFreeSnapshotVersion):Mt.min();let r;return r=(function(s){return s.documents!==void 0})(n.query)?(function(s){const a=s.documents.length;return At(a===1,1966,{count:a}),Ia(uw(MF(s.documents[0])))})(n.query):(function(s){return Ia(DF(s))})(n.query),new Il(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Xr.fromBase64String(n.resumeToken))}function BF(n,e){const t=qh(e.snapshotVersion),r=qh(e.lastLimboFreeSnapshotVersion);let i;i=Lx(e.target)?LF(n.yt,e.target):OF(n.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Xh(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function UF(n){const e=DF({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?HT(e,e.limit,"L"):e}function uS(n,e){return new uA(e.largestBatchId,qT(n.yt,e.overlayMutation))}function iN(n,e){const t=e.path.lastSegment();return[n,Yi(e.path.popLast()),t]}function sN(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:qh(r.readTime),documentKey:Yi(r.documentKey.path),largestBatchId:r.largestBatchId}}class TQ{getBundleMetadata(e,t){return aN(e).get(t).next((r=>{if(r)return(function(s){return{id:s.bundleId,createTime:Zh(s.createTime),version:s.version}})(r)}))}saveBundleMetadata(e,t){return aN(e).put((function(i){return{bundleId:i.id,createTime:qh(us(i.createTime)),version:i.version}})(t))}getNamedQuery(e,t){return oN(e).get(t).next((r=>{if(r)return(function(s){return{name:s.name,query:UF(s.bundledQuery),readTime:Zh(s.readTime)}})(r)}))}saveNamedQuery(e,t){return oN(e).put((function(i){return{name:i.name,readTime:qh(us(i.readTime)),bundledQuery:i.bundledQuery}})(t))}}function aN(n){return si(n,sw)}function oN(n){return si(n,aw)}class pw{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const r=t.uid||"";return new pw(e,r)}getOverlay(e,t){return Ug(e).get(iN(this.userId,t)).next((r=>r?uS(this.serializer,r):null))}getOverlays(e,t){const r=Vo();return fe.forEach(t,(i=>this.getOverlay(e,i).next((s=>{s!==null&&r.set(i,s)})))).next((()=>r))}saveOverlays(e,t,r){const i=[];return r.forEach(((s,a)=>{const o=new uA(t,a);i.push(this.St(e,o))})),fe.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach((a=>i.add(Yi(a.getCollectionPath()))));const s=[];return i.forEach((a=>{const o=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,r+1],!1,!0);s.push(Ug(e).Z(jT,o))})),fe.waitFor(s)}getOverlaysForCollection(e,t,r){const i=Vo(),s=Yi(t),a=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Ug(e).J(jT,a).next((o=>{for(const l of o){const u=uS(this.serializer,l);i.set(u.getKey(),u)}return i}))}getOverlaysForCollectionGroup(e,t,r,i){const s=Vo();let a;const o=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Ug(e).ee({index:z6,range:o},((l,u,h)=>{const f=uS(this.serializer,u);s.size()<i||f.largestBatchId===a?(s.set(f.getKey(),f),a=f.largestBatchId):h.done()})).next((()=>s))}St(e,t){return Ug(e).put((function(i,s,a){const[o,l,u]=iN(s,a.mutation.key);return{userId:s,collectionPath:l,documentId:u,collectionGroup:a.mutation.key.getCollectionGroup(),largestBatchId:a.largestBatchId,overlayMutation:Fx(i.yt,a.mutation)}})(this.serializer,this.userId,t))}}function Ug(n){return si(n,ow)}class bQ{bt(e){return si(e,tA)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const r=t?.value;return r?Xr.fromUint8Array(r):Xr.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class gh{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(gr(e.integerValue));else if("doubleValue"in e){const r=gr(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),up(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),typeof r=="string"&&(r=Ul(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(zl(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?tF(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):cw(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):Et(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const r=e.fields||{};this.Ft(t,55);for(const i of Object.keys(r))this.Ot(i,t),this.Ct(r[i],t)}kt(e,t){const r=e.fields||{};this.Ft(t,53);const i=x0,s=r[i].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(gr(s)),this.Ot(i,t),this.Ct(r[i],t)}Qt(e,t){const r=e.values||[];this.Ft(t,50);for(const i of r)this.Ct(i,t)}Lt(e,t){this.Ft(t,37),ct.fromName(e).path.forEach((r=>{this.Ft(t,60),this.Ut(r,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}gh.Kt=new gh;const df=255;function IQ(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function lN(n){const e=64-(function(r){let i=0;for(let s=0;s<8;++s){const a=IQ(255&r[s]);if(i+=a,a!==8)break}return i})(n);return Math.ceil(e/8)}class AQ{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Gt(r.value),r=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Jt(r.value),r=t.next();this.Ht()}Yt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const i=t.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Zt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const i=t.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Ht()}Xt(e){const t=this.en(e),r=lN(t);this.tn(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}nn(e){const t=this.en(e),r=lN(t);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}rn(){this.sn(df),this.sn(255)}_n(){this.an(df),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(s){const a=new DataView(new ArrayBuffer(8));return a.setFloat64(0,s,!1),new Uint8Array(a.buffer)})(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===df?(this.sn(df),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===df?(this.an(df),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class RQ{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class CQ{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class zg{constructor(){this.cn=new AQ,this.ln=new RQ(this.cn),this.hn=new CQ(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class mh{constructor(e,t,r,i){this.Tn=e,this.In=t,this.En=r,this.dn=i}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.dn,0),t!==e?r.set([0],this.dn.length):++r[r.length-1],new mh(this.Tn,this.In,this.En,r)}Rn(e,t,r){return{indexId:this.Tn,uid:e,arrayValue:G_(this.En),directionalValue:G_(this.dn),orderedDocumentKey:G_(t),documentKey:r.path.toArray()}}Vn(e,t,r){const i=this.Rn(e,t,r);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function Cc(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=cN(n.En,e.En),t!==0?t:(t=cN(n.dn,e.dn),t!==0?t:ct.comparator(n.In,e.In)))}function cN(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}function G_(n){return FD()?(function(t){let r="";for(let i=0;i<t.length;i++)r+=String.fromCharCode(t[i]);return r})(n):n}function uN(n){return typeof n!="string"?n:(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(n)}class hN{constructor(e){this.mn=new Kn(((t,r)=>Er.comparator(t.field,r.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const r=t;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(At(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=OT(e);if(t!==void 0&&!this.wn(t))return!1;const r=ah(e);let i=new Set,s=0,a=0;for(;s<r.length&&this.wn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.mn.size>0){const o=this.mn.getIterator().getNext();if(!i.has(o.field.canonicalString())){const l=r[s];if(!this.Sn(o,l)||!this.bn(this.fn[a++],l))return!1}++s}for(;s<r.length;++s){const o=r[s];if(a>=this.fn.length||!this.bn(this.fn[a++],o))return!1}return!0}Dn(){if(this.pn)return null;let e=new Kn(Er.comparator);const t=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new M_(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new M_(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new M_(r.field,r.dir==="asc"?0:1)));return new Rx(Rx.UNKNOWN_ID,this.collectionId,t,cp.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function zF(n){if(At(n instanceof dn||n instanceof Wn,20012),n instanceof dn){if(n instanceof uF){const t=n.value.arrayValue?.values?.map((r=>dn.create(n.field,"==",r)))||[];return Wn.create(t,"or")}return n}const e=n.filters.map((t=>zF(t)));return Wn.create(e,n.op)}function kQ(n){if(n.getFilters().length===0)return[];const e=JT(zF(n));return At($F(e),7391),ZT(e)||QT(e)?[e]:e.getFilters()}function ZT(n){return n instanceof dn}function QT(n){return n instanceof Wn&&aA(n)}function $F(n){return ZT(n)||QT(n)||(function(t){if(t instanceof Wn&&UT(t)){for(const r of t.getFilters())if(!ZT(r)&&!QT(r))return!1;return!0}return!1})(n)}function JT(n){if(At(n instanceof dn||n instanceof Wn,34018),n instanceof dn)return n;if(n.filters.length===1)return JT(n.filters[0]);const e=n.filters.map((r=>JT(r)));let t=Wn.create(e,n.op);return t=Vx(t),$F(t)?t:(At(t instanceof Wn,64498),At(E0(t),40251),At(t.filters.length>1,57927),t.filters.reduce(((r,i)=>fA(r,i))))}function fA(n,e){let t;return At(n instanceof dn||n instanceof Wn,38388),At(e instanceof dn||e instanceof Wn,25473),t=n instanceof dn?e instanceof dn?(function(i,s){return Wn.create([i,s],"and")})(n,e):dN(n,e):e instanceof dn?dN(e,n):(function(i,s){if(At(i.filters.length>0&&s.filters.length>0,48005),E0(i)&&E0(s))return oF(i,s.getFilters());const a=UT(i)?i:s,o=UT(i)?s:i,l=a.filters.map((u=>fA(u,o)));return Wn.create(l,"or")})(n,e),Vx(t)}function dN(n,e){if(E0(e))return oF(e,n.getFilters());{const t=e.filters.map((r=>fA(n,r)));return Wn.create(t,"or")}}function Vx(n){if(At(n instanceof dn||n instanceof Wn,11850),n instanceof dn)return n;const e=n.getFilters();if(e.length===1)return Vx(e[0]);if(sF(n))return n;const t=e.map((i=>Vx(i))),r=[];return t.forEach((i=>{i instanceof dn?r.push(i):i instanceof Wn&&(i.op===n.op?r.push(...i.filters):r.push(i))})),r.length===1?r[0]:Wn.create(r,n.op)}class PQ{constructor(){this.Cn=new gA}addToCollectionParentIndex(e,t){return this.Cn.add(t),fe.resolve()}getCollectionParents(e,t){return fe.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return fe.resolve()}deleteFieldIndex(e,t){return fe.resolve()}deleteAllFieldIndexes(e){return fe.resolve()}createTargetIndexes(e,t){return fe.resolve()}getDocumentsMatchingTarget(e,t){return fe.resolve(null)}getIndexType(e,t){return fe.resolve(0)}getFieldIndexes(e,t){return fe.resolve([])}getNextCollectionGroupToUpdate(e){return fe.resolve(null)}getMinOffset(e,t){return fe.resolve(na.min())}getMinOffsetFromCollectionGroup(e,t){return fe.resolve(na.min())}updateCollectionGroup(e,t,r){return fe.resolve()}updateIndexEntries(e,t){return fe.resolve()}}class gA{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Kn(kn.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Kn(kn.comparator)).toArray()}}const fN="IndexedDbIndexManager",e_=new Uint8Array(0);class MQ{constructor(e,t){this.databaseId=t,this.vn=new gA,this.Fn=new ql((r=>Xh(r)),((r,i)=>u1(r,i))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const s={collectionId:r,parent:Yi(i)};return gN(e).put(s)}return fe.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[P6(t),""],!1,!0);return gN(e).J(i).next((s=>{for(const a of s){if(a.collectionId!==t)break;r.push(jo(a.parent))}return r}))}addFieldIndex(e,t){const r=$g(e),i=(function(o){return{indexId:o.indexId,collectionGroup:o.collectionGroup,fields:o.fields.map((l=>[l.fieldPath.canonicalString(),l.kind]))}})(t);delete i.indexId;const s=r.add(i);if(t.indexState){const a=gf(e);return s.next((o=>{a.put(sN(o,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return s.next()}deleteFieldIndex(e,t){const r=$g(e),i=gf(e),s=ff(e);return r.delete(t.indexId).next((()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=$g(e),r=ff(e),i=gf(e);return t.Z().next((()=>r.Z())).next((()=>i.Z()))}createTargetIndexes(e,t){return fe.forEach(this.Mn(t),(r=>this.getIndexType(e,r).next((i=>{if(i===0||i===1){const s=new hN(r).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))))}getDocumentsMatchingTarget(e,t){const r=ff(e);let i=!0;const s=new Map;return fe.forEach(this.Mn(t),(a=>this.xn(e,a).next((o=>{i&&(i=!!o),s.set(a,o)})))).next((()=>{if(i){let a=an();const o=[];return fe.forEach(s,((l,u)=>{Ze(fN,`Using index ${(function(I){return`id=${I.indexId}|cg=${I.collectionGroup}|f=${I.fields.map((M=>`${M.fieldPath}:${M.kind}`)).join(",")}`})(l)} to execute ${Xh(t)}`);const h=(function(I,M){const F=OT(M);if(F===void 0)return null;for(const z of Ox(I,F.fieldPath))switch(z.op){case"array-contains-any":return z.value.arrayValue.values||[];case"array-contains":return[z.value]}return null})(u,l),f=(function(I,M){const F=new Map;for(const z of ah(M))for(const P of Ox(I,z.fieldPath))switch(P.op){case"==":case"in":F.set(z.fieldPath.canonicalString(),P.value);break;case"not-in":case"!=":return F.set(z.fieldPath.canonicalString(),P.value),Array.from(F.values())}return null})(u,l),g=(function(I,M){const F=[];let z=!0;for(const P of ah(M)){const C=P.kind===0?WM(I,P.fieldPath,I.startAt):HM(I,P.fieldPath,I.startAt);F.push(C.value),z&&(z=C.inclusive)}return new w0(F,z)})(u,l),y=(function(I,M){const F=[];let z=!0;for(const P of ah(M)){const C=P.kind===0?HM(I,P.fieldPath,I.endAt):WM(I,P.fieldPath,I.endAt);F.push(C.value),z&&(z=C.inclusive)}return new w0(F,z)})(u,l),v=this.On(l,u,g),x=this.On(l,u,y),E=this.Nn(l,u,f),T=this.Bn(l.indexId,h,v,g.inclusive,x,y.inclusive,E);return fe.forEach(T,(b=>r.Y(b,t.limit).next((I=>{I.forEach((M=>{const F=ct.fromSegments(M.documentKey);a.has(F)||(a=a.add(F),o.push(F))}))}))))})).next((()=>o))}return fe.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=kQ(Wn.create(e.filters,"and")).map((r=>$T(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,r,i,s,a,o){const l=(t!=null?t.length:1)*Math.max(r.length,s.length),u=l/(t!=null?t.length:1),h=[];for(let f=0;f<l;++f){const g=t?this.Ln(t[f/u]):e_,y=this.kn(e,g,r[f%u],i),v=this.qn(e,g,s[f%u],a),x=o.map((E=>this.kn(e,g,E,!0)));h.push(...this.createRange(y,v,x))}return h}kn(e,t,r,i){const s=new mh(e,ct.empty(),t,r);return i?s:s.An()}qn(e,t,r,i){const s=new mh(e,ct.empty(),t,r);return i?s.An():s}xn(e,t){const r=new hN(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next((s=>{let a=null;for(const o of s)r.yn(o)&&(!a||o.fields.length>a.fields.length)&&(a=o);return a}))}getIndexType(e,t){let r=2;const i=this.Mn(t);return fe.forEach(i,(s=>this.xn(e,s).next((a=>{a?r!==0&&a.fields.length<(function(l){let u=new Kn(Er.comparator),h=!1;for(const f of l.filters)for(const g of f.getFlattenedFilters())g.field.isKeyField()||(g.op==="array-contains"||g.op==="array-contains-any"?h=!0:u=u.add(g.field));for(const f of l.orderBy)f.field.isKeyField()||(u=u.add(f.field));return u.size+(h?1:0)})(s)&&(r=1):r=0})))).next((()=>(function(a){return a.limit!==null})(t)&&i.length>1&&r===2?1:r))}Qn(e,t){const r=new zg;for(const i of ah(e)){const s=t.data.field(i.fieldPath);if(s==null)return null;const a=r.Pn(i.kind);gh.Kt.Dt(s,a)}return r.un()}Ln(e){const t=new zg;return gh.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const r=new zg;return gh.Kt.Dt(pp(this.databaseId,t),r.Pn((function(s){const a=ah(s);return a.length===0?0:a[a.length-1].kind})(e))),r.un()}Nn(e,t,r){if(r===null)return[];let i=[];i.push(new zg);let s=0;for(const a of ah(e)){const o=r[s++];for(const l of i)if(this.Un(t,a.fieldPath)&&yp(o))i=this.Kn(i,a,o);else{const u=l.Pn(a.kind);gh.Kt.Dt(o,u)}}return this.Wn(i)}On(e,t,r){return this.Nn(e,t,r.position)}Wn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].un();return t}Kn(e,t,r){const i=[...e],s=[];for(const a of r.arrayValue.values||[])for(const o of i){const l=new zg;l.seed(o.un()),gh.Kt.Dt(a,l.Pn(t.kind)),s.push(l)}return s}Un(e,t){return!!e.filters.find((r=>r instanceof dn&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in")))}getFieldIndexes(e,t){const r=$g(e),i=gf(e);return(t?r.J(FT,IDBKeyRange.bound(t,t)):r.J()).next((s=>{const a=[];return fe.forEach(s,(o=>i.get([o.indexId,this.uid]).next((l=>{a.push((function(h,f){const g=f?new cp(f.sequenceNumber,new na(Zh(f.readTime),new ct(jo(f.documentKey)),f.largestBatchId)):cp.empty(),y=h.fields.map((([v,x])=>new M_(Er.fromServerFormat(v),x)));return new Rx(h.indexId,h.collectionGroup,y,g)})(o,l))})))).next((()=>a))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:Xt(r.collectionGroup,i.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,r){const i=$g(e),s=gf(e);return this.Gn(e).next((a=>i.J(FT,IDBKeyRange.bound(t,t)).next((o=>fe.forEach(o,(l=>s.put(sN(l.indexId,this.uid,a,r))))))))}updateIndexEntries(e,t){const r=new Map;return fe.forEach(t,((i,s)=>{const a=r.get(i.collectionGroup);return(a?fe.resolve(a):this.getFieldIndexes(e,i.collectionGroup)).next((o=>(r.set(i.collectionGroup,o),fe.forEach(o,(l=>this.zn(e,i,l).next((u=>{const h=this.jn(s,l);return u.isEqual(h)?fe.resolve():this.Jn(e,s,l,u,h)})))))))}))}Hn(e,t,r,i){return ff(e).put(i.Rn(this.uid,this.$n(r,t.key),t.key))}Yn(e,t,r,i){return ff(e).delete(i.Vn(this.uid,this.$n(r,t.key),t.key))}zn(e,t,r){const i=ff(e);let s=new Kn(Cc);return i.ee({index:U6,range:IDBKeyRange.only([r.indexId,this.uid,G_(this.$n(r,t))])},((a,o)=>{s=s.add(new mh(r.indexId,t,uN(o.arrayValue),uN(o.directionalValue)))})).next((()=>s))}jn(e,t){let r=new Kn(Cc);const i=this.Qn(t,e);if(i==null)return r;const s=OT(t);if(s!=null){const a=e.data.field(s.fieldPath);if(yp(a))for(const o of a.arrayValue.values||[])r=r.add(new mh(t.indexId,e.key,this.Ln(o),i))}else r=r.add(new mh(t.indexId,e.key,e_,i));return r}Jn(e,t,r,i,s){Ze(fN,"Updating index entries for document '%s'",t.key);const a=[];return(function(l,u,h,f,g){const y=l.getIterator(),v=u.getIterator();let x=hf(y),E=hf(v);for(;x||E;){let T=!1,b=!1;if(x&&E){const I=h(x,E);I<0?b=!0:I>0&&(T=!0)}else x!=null?b=!0:T=!0;T?(f(E),E=hf(v)):b?(g(x),x=hf(y)):(x=hf(y),E=hf(v))}})(i,s,Cc,(o=>{a.push(this.Hn(e,t,r,o))}),(o=>{a.push(this.Yn(e,t,r,o))})),fe.waitFor(a)}Gn(e){let t=1;return gf(e).ee({index:B6,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((r,i,s)=>{s.done(),t=i.sequenceNumber+1})).next((()=>t))}createRange(e,t,r){r=r.sort(((a,o)=>Cc(a,o))).filter(((a,o,l)=>!o||Cc(a,l[o-1])!==0));const i=[];i.push(e);for(const a of r){const o=Cc(a,e),l=Cc(a,t);if(o===0)i[0]=e.An();else if(o>0&&l<0)i.push(a),i.push(a.An());else if(l>0)break}i.push(t);const s=[];for(let a=0;a<i.length;a+=2){if(this.Zn(i[a],i[a+1]))return[];const o=i[a].Vn(this.uid,e_,ct.empty()),l=i[a+1].Vn(this.uid,e_,ct.empty());s.push(IDBKeyRange.bound(o,l))}return s}Zn(e,t){return Cc(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(mN)}getMinOffset(e,t){return fe.mapArray(this.Mn(t),(r=>this.xn(e,r).next((i=>i||Et(44426))))).next(mN)}}function gN(n){return si(n,fp)}function ff(n){return si(n,wm)}function $g(n){return si(n,eA)}function gf(n){return si(n,vm)}function mN(n){At(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;ZI(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new na(e.readTime,e.documentKey,t)}const pN={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},WF=41943040;class zi{static withCacheSize(e){return new zi(e,zi.DEFAULT_COLLECTION_PERCENTILE,zi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}function HF(n,e,t){const r=n.store(Ha),i=n.store(m0),s=[],a=IDBKeyRange.only(t.batchId);let o=0;const l=r.ee({range:a},((h,f,g)=>(o++,g.delete())));s.push(l.next((()=>{At(o===1,47070,{batchId:t.batchId})})));const u=[];for(const h of t.mutations){const f=j6(e,h.key.path,t.batchId);s.push(i.delete(f)),u.push(h.key)}return fe.waitFor(s).next((()=>u))}function Gx(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Et(14731);e=n.noDocument}return JSON.stringify(e).length}zi.DEFAULT_COLLECTION_PERCENTILE=10,zi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,zi.DEFAULT=new zi(WF,zi.DEFAULT_COLLECTION_PERCENTILE,zi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),zi.DISABLED=new zi(-1,0,0);class yw{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Xn={}}static wt(e,t,r,i){At(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new yw(s,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return kc(e).ee({index:Eh,range:r},((i,s,a)=>{t=!1,a.done()})).next((()=>t))}addMutationBatch(e,t,r,i){const s=Rf(e),a=kc(e);return a.add({}).next((o=>{At(typeof o=="number",49019);const l=new lA(o,t,r,i),u=(function(y,v,x){const E=x.baseMutations.map((b=>Fx(y.yt,b))),T=x.mutations.map((b=>Fx(y.yt,b)));return{userId:v,batchId:x.batchId,localWriteTimeMs:x.localWriteTime.toMillis(),baseMutations:E,mutations:T}})(this.serializer,this.userId,l),h=[];let f=new Kn(((g,y)=>Xt(g.canonicalString(),y.canonicalString())));for(const g of i){const y=j6(this.userId,g.key.path,o);f=f.add(g.key.path.popLast()),h.push(a.put(u)),h.push(s.put(y,oZ))}return f.forEach((g=>{h.push(this.indexManager.addToCollectionParentIndex(e,g))})),e.addOnCommittedListener((()=>{this.Xn[o]=l.keys()})),fe.waitFor(h).next((()=>l))}))}lookupMutationBatch(e,t){return kc(e).get(t).next((r=>r?(At(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:t}),fh(this.serializer,r)):null))}er(e,t){return this.Xn[t]?fe.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((r=>{if(r){const i=r.keys();return this.Xn[t]=i,i}return null}))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return kc(e).ee({index:Eh,range:i},((a,o,l)=>{o.userId===this.userId&&(At(o.batchId>=r,47524,{tr:r}),s=fh(this.serializer,o)),l.done()})).next((()=>s))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=Rh;return kc(e).ee({index:Eh,range:t,reverse:!0},((i,s,a)=>{r=s.batchId,a.done()})).next((()=>r))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Rh],[this.userId,Number.POSITIVE_INFINITY]);return kc(e).J(Eh,t).next((r=>r.map((i=>fh(this.serializer,i)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=N_(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return Rf(e).ee({range:i},((a,o,l)=>{const[u,h,f]=a,g=jo(h);if(u===this.userId&&t.path.isEqual(g))return kc(e).get(f).next((y=>{if(!y)throw Et(61480,{nr:a,batchId:f});At(y.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:y.userId,batchId:f}),s.push(fh(this.serializer,y))}));l.done()})).next((()=>s))}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Kn(Xt);const i=[];return t.forEach((s=>{const a=N_(this.userId,s.path),o=IDBKeyRange.lowerBound(a),l=Rf(e).ee({range:o},((u,h,f)=>{const[g,y,v]=u,x=jo(y);g===this.userId&&s.path.isEqual(x)?r=r.add(v):f.done()}));i.push(l)})),fe.waitFor(i).next((()=>this.rr(e,r)))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,s=N_(this.userId,r),a=IDBKeyRange.lowerBound(s);let o=new Kn(Xt);return Rf(e).ee({range:a},((l,u,h)=>{const[f,g,y]=l,v=jo(g);f===this.userId&&r.isPrefixOf(v)?v.length===i&&(o=o.add(y)):h.done()})).next((()=>this.rr(e,o)))}rr(e,t){const r=[],i=[];return t.forEach((s=>{i.push(kc(e).get(s).next((a=>{if(a===null)throw Et(35274,{batchId:s});At(a.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:a.userId,batchId:s}),r.push(fh(this.serializer,a))})))})),fe.waitFor(i).next((()=>r))}removeMutationBatch(e,t){return HF(e.le,this.userId,t).next((r=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),fe.forEach(r,(i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return fe.resolve();const r=IDBKeyRange.lowerBound((function(a){return[a]})(this.userId)),i=[];return Rf(e).ee({range:r},((s,a,o)=>{if(s[0]===this.userId){const l=jo(s[1]);i.push(l)}else o.done()})).next((()=>{At(i.length===0,56720,{sr:i.map((s=>s.canonicalString()))})}))}))}containsKey(e,t){return KF(e,this.userId,t)}_r(e){return YF(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:Rh,lastStreamToken:""}))}}function KF(n,e,t){const r=N_(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r);let a=!1;return Rf(n).ee({range:s,X:!0},((o,l,u)=>{const[h,f,g]=o;h===e&&f===i&&(a=!0),u.done()})).next((()=>a))}function kc(n){return si(n,Ha)}function Rf(n){return si(n,m0)}function YF(n){return si(n,hp)}class Qh{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Qh(0)}static cr(){return new Qh(-1)}}class NQ{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const r=new Qh(t.highestTargetId);return t.highestTargetId=r.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>Mt.fromTimestamp(new zn(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,r){return this.lr(e).next((i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.hr(e,i))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((r=>(r.targetCount+=1,this.Tr(t,r),this.hr(e,r))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>mf(e).delete(t.targetId))).next((()=>this.lr(e))).next((r=>(At(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r))))}removeTargets(e,t,r){let i=0;const s=[];return mf(e).ee(((a,o)=>{const l=sm(o);l.sequenceNumber<=t&&r.get(l.targetId)===null&&(i++,s.push(this.removeTargetData(e,l)))})).next((()=>fe.waitFor(s))).next((()=>i))}forEachTarget(e,t){return mf(e).ee(((r,i)=>{const s=sm(i);t(s)}))}lr(e){return yN(e).get(Px).next((t=>(At(t!==null,2888),t)))}hr(e,t){return yN(e).put(Px,t)}Pr(e,t){return mf(e).put(BF(this.serializer,t))}Tr(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const r=Xh(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return mf(e).ee({range:i,index:G6},((a,o,l)=>{const u=sm(o);u1(t,u.target)&&(s=u,l.done())})).next((()=>s))}addMatchingKeys(e,t,r){const i=[],s=Bc(e);return t.forEach((a=>{const o=Yi(a.path);i.push(s.put({targetId:r,path:o})),i.push(this.referenceDelegate.addReference(e,r,a))})),fe.waitFor(i)}removeMatchingKeys(e,t,r){const i=Bc(e);return fe.forEach(t,(s=>{const a=Yi(s.path);return fe.waitFor([i.delete([r,a]),this.referenceDelegate.removeReference(e,r,s)])}))}removeMatchingKeysForTargetId(e,t){const r=Bc(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=Bc(e);let s=an();return i.ee({range:r,X:!0},((a,o,l)=>{const u=jo(a[1]),h=new ct(u);s=s.add(h)})).next((()=>s))}containsKey(e,t){const r=Yi(t.path),i=IDBKeyRange.bound([r],[P6(r)],!1,!0);let s=0;return Bc(e).ee({index:JI,X:!0,range:i},(([a,o],l,u)=>{a!==0&&(s++,u.done())})).next((()=>s>0))}At(e,t){return mf(e).get(t).next((r=>r?sm(r):null))}}function mf(n){return si(n,p0)}function yN(n){return si(n,Ch)}function Bc(n){return si(n,y0)}const _N="LruGarbageCollector",LQ=1048576;function xN([n,e],[t,r]){const i=Xt(n,t);return i===0?Xt(e,r):i}class OQ{constructor(e){this.Ir=e,this.buffer=new Kn(xN),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();xN(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class XF{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Ze(_N,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Tu(t)?Ze(_N,"Ignoring IndexedDB error during garbage collection: ",t):await gd(t)}await this.Vr(3e5)}))}}class DQ{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return fe.resolve(Ta.ce);const r=new OQ(t);return this.mr.forEachTarget(e,(i=>r.Ar(i.sequenceNumber))).next((()=>this.mr.pr(e,(i=>r.Ar(i))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Ze("LruGarbageCollector","Garbage collection skipped; disabled"),fe.resolve(pN)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(Ze("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),pN):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,i,s,a,o,l,u;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((f=>(f>this.params.maximumSequenceNumbersToCollect?(Ze("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),i=this.params.maximumSequenceNumbersToCollect):i=f,a=Date.now(),this.nthSequenceNumber(e,i)))).next((f=>(r=f,o=Date.now(),this.removeTargets(e,r,t)))).next((f=>(s=f,l=Date.now(),this.removeOrphanedDocuments(e,r)))).next((f=>(u=Date.now(),Tf()<=hn.DEBUG&&Ze("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-h}ms
	Determined least recently used ${i} in `+(o-a)+`ms
	Removed ${s} targets in `+(l-o)+`ms
	Removed ${f} documents in `+(u-l)+`ms
Total Duration: ${u-h}ms`),fe.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:f}))))}}function qF(n,e){return new DQ(n,e)}class FQ{constructor(e,t){this.db=e,this.garbageCollector=qF(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((r,i)=>t(i)))}addReference(e,t,r){return t_(e,r)}removeReference(e,t,r){return t_(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return t_(e,t)}br(e,t){return(function(i,s){let a=!1;return YF(i).te((o=>KF(i,o,s).next((l=>(l&&(a=!0),fe.resolve(!l)))))).next((()=>a))})(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Sr(e,((a,o)=>{if(o<=t){const l=this.br(e,a).next((u=>{if(!u)return s++,r.getEntry(e,a).next((()=>(r.removeEntry(a,Mt.min()),Bc(e).delete((function(f){return[0,Yi(f.path)]})(a)))))}));i.push(l)}})).next((()=>fe.waitFor(i))).next((()=>r.apply(e))).next((()=>s))}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return t_(e,t)}Sr(e,t){const r=Bc(e);let i,s=Ta.ce;return r.ee({index:JI},(([a,o],{path:l,sequenceNumber:u})=>{a===0?(s!==Ta.ce&&t(new ct(jo(i)),s),s=u,i=l):s=Ta.ce})).next((()=>{s!==Ta.ce&&t(new ct(jo(i)),s)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function t_(n,e){return Bc(n).put((function(r,i){return{targetId:0,path:Yi(r.path),sequenceNumber:i}})(e,n.currentSequenceNumber))}class ZF{constructor(){this.changes=new ql((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Cr.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?fe.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class jQ{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Ju(e).put(r)}removeEntry(e,t,r){return Ju(e).delete((function(s,a){const o=s.path.toArray();return[o.slice(0,o.length-2),o[o.length-2],jx(a),o[o.length-1]]})(t,r))}updateMetadata(e,t){return this.getMetadata(e).next((r=>(r.byteSize+=t,this.Dr(e,r))))}getEntry(e,t){let r=Cr.newInvalidDocument(t);return Ju(e).ee({index:L_,range:IDBKeyRange.only(Wg(t))},((i,s)=>{r=this.Cr(t,s)})).next((()=>r))}vr(e,t){let r={size:0,document:Cr.newInvalidDocument(t)};return Ju(e).ee({index:L_,range:IDBKeyRange.only(Wg(t))},((i,s)=>{r={document:this.Cr(t,s),size:Gx(s)}})).next((()=>r))}getEntries(e,t){let r=Qs();return this.Fr(e,t,((i,s)=>{const a=this.Cr(i,s);r=r.insert(i,a)})).next((()=>r))}Mr(e,t){let r=Qs(),i=new pr(ct.comparator);return this.Fr(e,t,((s,a)=>{const o=this.Cr(s,a);r=r.insert(s,o),i=i.insert(s,Gx(a))})).next((()=>({documents:r,Or:i})))}Fr(e,t,r){if(t.isEmpty())return fe.resolve();let i=new Kn(EN);t.forEach((l=>i=i.add(l)));const s=IDBKeyRange.bound(Wg(i.first()),Wg(i.last())),a=i.getIterator();let o=a.getNext();return Ju(e).ee({index:L_,range:s},((l,u,h)=>{const f=ct.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;o&&EN(o,f)<0;)r(o,null),o=a.getNext();o&&o.isEqual(f)&&(r(o,u),o=a.hasNext()?a.getNext():null),o?h.j(Wg(o)):h.done()})).next((()=>{for(;o;)r(o,null),o=a.hasNext()?a.getNext():null}))}getDocumentsMatchingQuery(e,t,r,i,s){const a=t.path,o=[a.popLast().toArray(),a.lastSegment(),jx(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[a.popLast().toArray(),a.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Ju(e).J(IDBKeyRange.bound(o,l,!0)).next((u=>{s?.incrementDocumentReadCount(u.length);let h=Qs();for(const f of u){const g=this.Cr(ct.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);g.isFoundDocument()&&(d1(t,g)||i.has(g.key))&&(h=h.insert(g.key,g))}return h}))}getAllFromCollectionGroup(e,t,r,i){let s=Qs();const a=wN(t,r),o=wN(t,na.max());return Ju(e).ee({index:V6,range:IDBKeyRange.bound(a,o,!0)},((l,u,h)=>{const f=this.Cr(ct.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);s=s.insert(f.key,f),s.size===i&&h.done()})).next((()=>s))}newChangeBuffer(e){return new VQ(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return vN(e).get(DT).next((t=>(At(!!t,20021),t)))}Dr(e,t){return vN(e).put(DT,t)}Cr(e,t){if(t){const r=SQ(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(Mt.min())))return r}return Cr.newInvalidDocument(e)}}function QF(n){return new jQ(n)}class VQ extends ZF{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new ql((r=>r.toString()),((r,i)=>r.isEqual(i)))}applyChanges(e){const t=[];let r=0,i=new Kn(((s,a)=>Xt(s.canonicalString(),a.canonicalString())));return this.changes.forEach(((s,a)=>{const o=this.Br.get(s);if(t.push(this.Nr.removeEntry(e,s,o.readTime)),a.isValidDocument()){const l=rN(this.Nr.serializer,a);i=i.add(s.path.popLast());const u=Gx(l);r+=u-o.size,t.push(this.Nr.addEntry(e,s,l))}else if(r-=o.size,this.trackRemovals){const l=rN(this.Nr.serializer,a.convertToNoDocument(Mt.min()));t.push(this.Nr.addEntry(e,s,l))}})),i.forEach((s=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))})),t.push(this.Nr.updateMetadata(e,r)),fe.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((r=>(this.Br.set(t,{size:r.size,readTime:r.document.readTime}),r.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:r,Or:i})=>(i.forEach(((s,a)=>{this.Br.set(s,{size:a,readTime:r.get(s).readTime})})),r)))}}function vN(n){return si(n,dp)}function Ju(n){return si(n,kx)}function Wg(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function wN(n,e){const t=e.documentKey.path.toArray();return[n,jx(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function EN(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=Xt(t[s],r[s]),i)return i;return i=Xt(t.length,r.length),i||(i=Xt(t[t.length-2],r[r.length-2]),i||Xt(t[t.length-1],r[r.length-1]))}class GQ{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class JF{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(r=i,this.remoteDocumentCache.getEntry(e,t)))).next((i=>(r!==null&&bm(r.mutation,i,As.empty(),zn.now()),i)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,an()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=an()){const i=Vo();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,r).next((s=>{let a=rm();return s.forEach(((o,l)=>{a=a.insert(o,l.overlayedDocument)})),a}))))}getOverlayedDocuments(e,t){const r=Vo();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,an())))}populateOverlays(e,t,r){const i=[];return r.forEach((s=>{t.has(s)||i.push(s)})),this.documentOverlayCache.getOverlays(e,i).next((s=>{s.forEach(((a,o)=>{t.set(a,o)}))}))}computeViews(e,t,r,i){let s=Qs();const a=Tm(),o=(function(){return Tm()})();return t.forEach(((l,u)=>{const h=r.get(u.key);i.has(u.key)&&(h===void 0||h.mutation instanceof Zl)?s=s.insert(u.key,u):h!==void 0?(a.set(u.key,h.mutation.getFieldMask()),bm(h.mutation,u,h.mutation.getFieldMask(),zn.now())):a.set(u.key,As.empty())})),this.recalculateAndSaveOverlays(e,s).next((l=>(l.forEach(((u,h)=>a.set(u,h))),t.forEach(((u,h)=>o.set(u,new GQ(h,a.get(u)??null)))),o)))}recalculateAndSaveOverlays(e,t){const r=Tm();let i=new pr(((a,o)=>a-o)),s=an();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((a=>{for(const o of a)o.keys().forEach((l=>{const u=t.get(l);if(u===null)return;let h=r.get(l)||As.empty();h=o.applyToLocalView(u,h),r.set(l,h);const f=(i.get(o.batchId)||an()).add(l);i=i.insert(o.batchId,f)}))})).next((()=>{const a=[],o=i.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),u=l.key,h=l.value,f=pF();h.forEach((g=>{if(!s.has(g)){const y=SF(t.get(g),r.get(g));y!==null&&f.set(g,y),s=s.add(g)}})),a.push(this.documentOverlayCache.saveOverlays(e,u,f))}return fe.waitFor(a)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,i){return(function(a){return ct.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):hF(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next((s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):fe.resolve(Vo());let o=lp,l=s;return a.next((u=>fe.forEach(u,((h,f)=>(o<f.largestBatchId&&(o=f.largestBatchId),s.get(h)?fe.resolve():this.remoteDocumentCache.getEntry(e,h).next((g=>{l=l.insert(h,g)}))))).next((()=>this.populateOverlays(e,u,s))).next((()=>this.computeViews(e,l,u,an()))).next((h=>({batchId:o,changes:mF(h)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ct(t)).next((r=>{let i=rm();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const s=t.collectionGroup;let a=rm();return this.indexManager.getCollectionParents(e,s).next((o=>fe.forEach(o,(l=>{const u=(function(f,g){return new h1(g,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)})(t,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next((h=>{h.forEach(((f,g)=>{a=a.insert(f,g)}))}))})).next((()=>a))))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i)))).next((a=>{s.forEach(((l,u)=>{const h=u.getKey();a.get(h)===null&&(a=a.insert(h,Cr.newInvalidDocument(h)))}));let o=rm();return a.forEach(((l,u)=>{const h=s.get(l);h!==void 0&&bm(h.mutation,u,As.empty(),zn.now()),d1(t,u)&&(o=o.insert(l,u))})),o}))}}class BQ{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return fe.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:us(i.createTime)}})(t)),fe.resolve()}getNamedQuery(e,t){return fe.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(i){return{name:i.name,query:UF(i.bundledQuery),readTime:us(i.readTime)}})(t)),fe.resolve()}}class UQ{constructor(){this.overlays=new pr(ct.comparator),this.qr=new Map}getOverlay(e,t){return fe.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Vo();return fe.forEach(t,(i=>this.getOverlay(e,i).next((s=>{s!==null&&r.set(i,s)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((i,s)=>{this.St(e,t,s)})),fe.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach((s=>this.overlays=this.overlays.remove(s))),this.qr.delete(r)),fe.resolve()}getOverlaysForCollection(e,t,r){const i=Vo(),s=t.length+1,a=new ct(t.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,u=l.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return fe.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new pr(((u,h)=>u-h));const a=this.overlays.getIterator();for(;a.hasNext();){const u=a.getNext().value;if(u.getKey().getCollectionGroup()===t&&u.largestBatchId>r){let h=s.get(u.largestBatchId);h===null&&(h=Vo(),s=s.insert(u.largestBatchId,h)),h.set(u.getKey(),u)}}const o=Vo(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach(((u,h)=>o.set(u,h))),!(o.size()>=i)););return fe.resolve(o)}St(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const a=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new uA(t,r));let s=this.qr.get(t);s===void 0&&(s=an(),this.qr.set(t,s)),this.qr.set(t,s.add(r.key))}}class zQ{constructor(){this.sessionToken=Xr.EMPTY_BYTE_STRING}getSessionToken(e){return fe.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,fe.resolve()}}class mA{constructor(){this.Qr=new Kn(hi.$r),this.Ur=new Kn(hi.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new hi(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Gr(new hi(e,t))}zr(e,t){e.forEach((r=>this.removeReference(r,t)))}jr(e){const t=new ct(new kn([])),r=new hi(t,e),i=new hi(t,e+1),s=[];return this.Ur.forEachInRange([r,i],(a=>{this.Gr(a),s.push(a.key)})),s}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new ct(new kn([])),r=new hi(t,e),i=new hi(t,e+1);let s=an();return this.Ur.forEachInRange([r,i],(a=>{s=s.add(a.key)})),s}containsKey(e){const t=new hi(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class hi{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return ct.comparator(e.key,t.key)||Xt(e.Yr,t.Yr)}static Kr(e,t){return Xt(e.Yr,t.Yr)||ct.comparator(e.key,t.key)}}class $Q{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Kn(hi.$r)}checkEmpty(e){return fe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new lA(s,t,r,i);this.mutationQueue.push(a);for(const o of i)this.Zr=this.Zr.add(new hi(o.key,s)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return fe.resolve(a)}lookupMutationBatch(e,t){return fe.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.ei(r),s=i<0?0:i;return fe.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return fe.resolve(this.mutationQueue.length===0?Rh:this.tr-1)}getAllMutationBatches(e){return fe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new hi(t,0),i=new hi(t,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([r,i],(a=>{const o=this.Xr(a.Yr);s.push(o)})),fe.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Kn(Xt);return t.forEach((i=>{const s=new hi(i,0),a=new hi(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,a],(o=>{r=r.add(o.Yr)}))})),fe.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let s=r;ct.isDocumentKey(s)||(s=s.child(""));const a=new hi(new ct(s),0);let o=new Kn(Xt);return this.Zr.forEachWhile((l=>{const u=l.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(o=o.add(l.Yr)),!0)}),a),fe.resolve(this.ti(o))}ti(e){const t=[];return e.forEach((r=>{const i=this.Xr(r);i!==null&&t.push(i)})),t}removeMutationBatch(e,t){At(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return fe.forEach(t.mutations,(i=>{const s=new hi(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,t){const r=new hi(t,0),i=this.Zr.firstAfterOrEqual(r);return fe.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,fe.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class WQ{constructor(e){this.ri=e,this.docs=(function(){return new pr(ct.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),s=i?i.size:0,a=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return fe.resolve(r?r.document.mutableCopy():Cr.newInvalidDocument(t))}getEntries(e,t){let r=Qs();return t.forEach((i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Cr.newInvalidDocument(i))})),fe.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=Qs();const a=t.path,o=new ct(a.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:u,value:{document:h}}=l.getNext();if(!a.isPrefixOf(u.path))break;u.path.length>a.length+1||ZI(L6(h),r)<=0||(i.has(h.key)||d1(t,h))&&(s=s.insert(h.key,h.mutableCopy()))}return fe.resolve(s)}getAllFromCollectionGroup(e,t,r,i){Et(9500)}ii(e,t){return fe.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new HQ(this)}getSize(e){return fe.resolve(this.size)}}class HQ extends ZF{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,i)=>{i.isValidDocument()?t.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)})),fe.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class KQ{constructor(e){this.persistence=e,this.si=new ql((t=>Xh(t)),u1),this.lastRemoteSnapshotVersion=Mt.min(),this.highestTargetId=0,this.oi=0,this._i=new mA,this.targetCount=0,this.ai=Qh.ur()}forEachTarget(e,t){return this.si.forEach(((r,i)=>t(i))),fe.resolve()}getLastRemoteSnapshotVersion(e){return fe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return fe.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),fe.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),fe.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Qh(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,fe.resolve()}updateTargetData(e,t){return this.Pr(t),fe.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,fe.resolve()}removeTargets(e,t,r){let i=0;const s=[];return this.si.forEach(((a,o)=>{o.sequenceNumber<=t&&r.get(o.targetId)===null&&(this.si.delete(a),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)})),fe.waitFor(s).next((()=>i))}getTargetCount(e){return fe.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return fe.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),fe.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach((a=>{s.push(i.markPotentiallyOrphaned(e,a))})),fe.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),fe.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return fe.resolve(r)}containsKey(e,t){return fe.resolve(this._i.containsKey(t))}}class pA{constructor(e,t){this.ui={},this.overlays={},this.ci=new Ta(0),this.li=!1,this.li=!0,this.hi=new zQ,this.referenceDelegate=e(this),this.Pi=new KQ(this),this.indexManager=new PQ,this.remoteDocumentCache=(function(i){return new WQ(i)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new GF(t),this.Ii=new BQ(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new UQ,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new $Q(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){Ze("MemoryPersistence","Starting transaction:",e);const i=new YQ(this.ci.next());return this.referenceDelegate.Ei(),r(i).next((s=>this.referenceDelegate.di(i).next((()=>s)))).toPromise().then((s=>(i.raiseOnCommittedEvent(),s)))}Ai(e,t){return fe.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,t))))}}class YQ extends D6{constructor(e){super(),this.currentSequenceNumber=e}}class _w{constructor(e){this.persistence=e,this.Ri=new mA,this.Vi=null}static mi(e){return new _w(e)}get fi(){if(this.Vi)return this.Vi;throw Et(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),fe.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),fe.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),fe.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((i=>this.fi.add(i.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((i=>{i.forEach((s=>this.fi.add(s.toString())))})).next((()=>r.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return fe.forEach(this.fi,(r=>{const i=ct.fromPath(r);return this.gi(e,i).next((s=>{s||t.removeEntry(i,Mt.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return fe.or([()=>fe.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Bx{constructor(e,t){this.persistence=e,this.pi=new ql((r=>Yi(r.path)),((r,i)=>r.isEqual(i))),this.garbageCollector=qF(this,t)}static mi(e,t){return new Bx(e,t)}Ei(){}di(e){return fe.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}pr(e,t){return fe.forEach(this.pi,((r,i)=>this.br(e,r,i).next((s=>s?fe.resolve():t(i)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ii(e,(a=>this.br(e,a,t).next((o=>{o||(r++,s.removeEntry(a,Mt.min()))})))).next((()=>s.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),fe.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),fe.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),fe.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),fe.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=D_(e.data.value)),t}br(e,t,r){return fe.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.pi.get(t);return fe.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class XQ{constructor(e){this.serializer=e}k(e,t,r,i){const s=new rw("createOrUpgrade",t);r<1&&i>=1&&((function(l){l.createObjectStore(c1)})(e),(function(l){l.createObjectStore(hp,{keyPath:aZ}),l.createObjectStore(Ha,{keyPath:NM,autoIncrement:!0}).createIndex(Eh,LM,{unique:!0}),l.createObjectStore(m0)})(e),SN(e),(function(l){l.createObjectStore(oh)})(e));let a=fe.resolve();return r<3&&i>=3&&(r!==0&&((function(l){l.deleteObjectStore(y0),l.deleteObjectStore(p0),l.deleteObjectStore(Ch)})(e),SN(e)),a=a.next((()=>(function(l){const u=l.store(Ch),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Mt.min().toTimestamp(),targetCount:0};return u.put(Px,h)})(s)))),r<4&&i>=4&&(r!==0&&(a=a.next((()=>(function(l,u){return u.store(Ha).J().next((f=>{l.deleteObjectStore(Ha),l.createObjectStore(Ha,{keyPath:NM,autoIncrement:!0}).createIndex(Eh,LM,{unique:!0});const g=u.store(Ha),y=f.map((v=>g.put(v)));return fe.waitFor(y)}))})(e,s)))),a=a.next((()=>{(function(l){l.createObjectStore(_0,{keyPath:mZ})})(e)}))),r<5&&i>=5&&(a=a.next((()=>this.yi(s)))),r<6&&i>=6&&(a=a.next((()=>((function(l){l.createObjectStore(dp)})(e),this.wi(s))))),r<7&&i>=7&&(a=a.next((()=>this.Si(s)))),r<8&&i>=8&&(a=a.next((()=>this.bi(e,s)))),r<9&&i>=9&&(a=a.next((()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)}))),r<10&&i>=10&&(a=a.next((()=>this.Di(s)))),r<11&&i>=11&&(a=a.next((()=>{(function(l){l.createObjectStore(sw,{keyPath:pZ})})(e),(function(l){l.createObjectStore(aw,{keyPath:yZ})})(e)}))),r<12&&i>=12&&(a=a.next((()=>{(function(l){const u=l.createObjectStore(ow,{keyPath:TZ});u.createIndex(jT,bZ,{unique:!1}),u.createIndex(z6,IZ,{unique:!1})})(e)}))),r<13&&i>=13&&(a=a.next((()=>(function(l){const u=l.createObjectStore(kx,{keyPath:lZ});u.createIndex(L_,cZ),u.createIndex(V6,uZ)})(e))).next((()=>this.Ci(e,s))).next((()=>e.deleteObjectStore(oh)))),r<14&&i>=14&&(a=a.next((()=>this.Fi(e,s)))),r<15&&i>=15&&(a=a.next((()=>(function(l){l.createObjectStore(eA,{keyPath:_Z,autoIncrement:!0}).createIndex(FT,xZ,{unique:!1}),l.createObjectStore(vm,{keyPath:vZ}).createIndex(B6,wZ,{unique:!1}),l.createObjectStore(wm,{keyPath:EZ}).createIndex(U6,SZ,{unique:!1})})(e)))),r<16&&i>=16&&(a=a.next((()=>{t.objectStore(vm).clear()})).next((()=>{t.objectStore(wm).clear()}))),r<17&&i>=17&&(a=a.next((()=>{(function(l){l.createObjectStore(tA,{keyPath:AZ})})(e)}))),r<18&&i>=18&&FD()&&(a=a.next((()=>{t.objectStore(vm).clear()})).next((()=>{t.objectStore(wm).clear()}))),a}wi(e){let t=0;return e.store(oh).ee(((r,i)=>{t+=Gx(i)})).next((()=>{const r={byteSize:t};return e.store(dp).put(DT,r)}))}yi(e){const t=e.store(hp),r=e.store(Ha);return t.J().next((i=>fe.forEach(i,(s=>{const a=IDBKeyRange.bound([s.userId,Rh],[s.userId,s.lastAcknowledgedBatchId]);return r.J(Eh,a).next((o=>fe.forEach(o,(l=>{At(l.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:l.batchId});const u=fh(this.serializer,l);return HF(e,s.userId,u).next((()=>{}))}))))}))))}Si(e){const t=e.store(y0),r=e.store(oh);return e.store(Ch).get(Px).next((i=>{const s=[];return r.ee(((a,o)=>{const l=new kn(a),u=(function(f){return[0,Yi(f)]})(l);s.push(t.get(u).next((h=>h?fe.resolve():(f=>t.put({targetId:0,path:Yi(f),sequenceNumber:i.highestListenSequenceNumber}))(l))))})).next((()=>fe.waitFor(s)))}))}bi(e,t){e.createObjectStore(fp,{keyPath:gZ});const r=t.store(fp),i=new gA,s=a=>{if(i.add(a)){const o=a.lastSegment(),l=a.popLast();return r.put({collectionId:o,parent:Yi(l)})}};return t.store(oh).ee({X:!0},((a,o)=>{const l=new kn(a);return s(l.popLast())})).next((()=>t.store(m0).ee({X:!0},(([a,o,l],u)=>{const h=jo(o);return s(h.popLast())}))))}Di(e){const t=e.store(p0);return t.ee(((r,i)=>{const s=sm(i),a=BF(this.serializer,s);return t.put(a)}))}Ci(e,t){const r=t.store(oh),i=[];return r.ee(((s,a)=>{const o=t.store(kx),l=(function(f){return f.document?new ct(kn.fromString(f.document.name).popFirst(5)):f.noDocument?ct.fromSegments(f.noDocument.path):f.unknownDocument?ct.fromSegments(f.unknownDocument.path):Et(36783)})(a).path.toArray(),u={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:a.readTime||[0,0],unknownDocument:a.unknownDocument,noDocument:a.noDocument,document:a.document,hasCommittedMutations:!!a.hasCommittedMutations};i.push(o.put(u))})).next((()=>fe.waitFor(i)))}Fi(e,t){const r=t.store(Ha),i=QF(this.serializer),s=new pA(_w.mi,this.serializer.yt);return r.J().next((a=>{const o=new Map;return a.forEach((l=>{let u=o.get(l.userId)??an();fh(this.serializer,l).keys().forEach((h=>u=u.add(h))),o.set(l.userId,u)})),fe.forEach(o,((l,u)=>{const h=new Ii(u),f=pw.wt(this.serializer,h),g=s.getIndexManager(h),y=yw.wt(h,this.serializer,g,s.referenceDelegate);return new JF(i,y,f,g).recalculateAndSaveOverlaysForDocumentKeys(new VT(t,Ta.ce),l).next()}))}))}}function SN(n){n.createObjectStore(y0,{keyPath:dZ}).createIndex(JI,fZ,{unique:!0}),n.createObjectStore(p0,{keyPath:"targetId"}).createIndex(G6,hZ,{unique:!0}),n.createObjectStore(Ch)}const Pc="IndexedDbPersistence",hS=18e5,dS=5e3,fS="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",qQ="main";class yA{constructor(e,t,r,i,s,a,o,l,u,h,f=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Mi=s,this.window=a,this.document=o,this.xi=u,this.Oi=h,this.Ni=f,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=g=>Promise.resolve(),!yA.v())throw new at(Pe.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new FQ(this,i),this.$i=t+qQ,this.serializer=new GF(l),this.Ui=new su(this.$i,this.Ni,new XQ(this.serializer)),this.hi=new bQ,this.Pi=new NQ(this.referenceDelegate,this.serializer),this.remoteDocumentCache=QF(this.serializer),this.Ii=new TQ,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,h===!1&&ls(Pc,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new at(Pe.FAILED_PRECONDITION,fS);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new Ta(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>n_(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(Tu(e))return Ze(Pc,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Ze(Pc,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return Hg(e).get(uf).next((t=>fe.resolve(this.es(t))))}ts(e){return n_(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,hS)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const r=si(t,_0);return r.J().next((i=>{const s=this.ss(i,hS),a=i.filter((o=>s.indexOf(o)===-1));return fe.forEach(a,(o=>r.delete(o.clientId))).next((()=>a))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?fe.resolve(!0):Hg(e).get(uf).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,dS)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new at(Pe.FAILED_PRECONDITION,fS);return!1}}return!(!this.networkEnabled||!this.inForeground)||n_(e).J().next((r=>this.ss(r,dS).find((i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,a=!this.inForeground&&i.inForeground,o=this.networkEnabled===i.networkEnabled;if(s||a&&o)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&Ze(Pc,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[c1,_0],(e=>{const t=new VT(e,Ta.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((r=>this.rs(r.updateTimeMs,t)&&!this.us(r.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>n_(e).J().next((t=>this.ss(t,hS).map((r=>r.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return yw.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new MQ(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return pw.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,r){Ze(Pc,"Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",s=(function(l){return l===18?kZ:l===17?K6:l===16?CZ:l===15?nA:l===14?H6:l===13?W6:l===12?RZ:l===11?$6:void Et(60245)})(this.Ni);let a;return this.Ui.runTransaction(e,i,s,(o=>(a=new VT(o,this.ci?this.ci.next():Ta.ce),t==="readwrite-primary"?this.Hi(a).next((l=>!!l||this.Yi(a))).next((l=>{if(!l)throw ls(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new at(Pe.FAILED_PRECONDITION,O6);return r(a)})).next((l=>this.Xi(a).next((()=>l)))):this.Is(a).next((()=>r(a)))))).then((o=>(a.raiseOnCommittedEvent(),o)))}Is(e){return Hg(e).get(uf).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,dS)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new at(Pe.FAILED_PRECONDITION,fS)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Hg(e).put(uf,t)}static v(){return su.v()}Zi(e){const t=Hg(e);return t.get(uf).next((r=>this.es(r)?(Ze(Pc,"Releasing primary lease."),t.delete(uf)):fe.resolve()))}rs(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(ls(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;DD()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const t=this.Ki?.getItem(this._s(e))!==null;return Ze(Pc,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return ls(Pc,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){ls("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Hg(n){return si(n,c1)}function n_(n){return si(n,_0)}function ZQ(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class _A{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=i}static As(e,t){let r=an(),i=an();for(const s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new _A(e,t.fromCache,r,i)}}class QQ{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class e8{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return DD()?8:F6(ii())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,i){const s={result:null};return this.ys(e,t).next((a=>{s.result=a})).next((()=>{if(!s.result)return this.ws(e,t,i,r).next((a=>{s.result=a}))})).next((()=>{if(s.result)return;const a=new QQ;return this.Ss(e,t,a).next((o=>{if(s.result=o,this.Vs)return this.bs(e,t,a,o.size)}))})).next((()=>s.result))}bs(e,t,r,i){return r.documentReadCount<this.fs?(Tf()<=hn.DEBUG&&Ze("QueryEngine","SDK will not create cache indexes for query:",bf(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),fe.resolve()):(Tf()<=hn.DEBUG&&Ze("QueryEngine","Query:",bf(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(Tf()<=hn.DEBUG&&Ze("QueryEngine","The SDK decides to create cache indexes for query:",bf(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ia(t))):fe.resolve())}ys(e,t){if(KM(t))return fe.resolve(null);let r=Ia(t);return this.indexManager.getIndexType(e,r).next((i=>i===0?null:(t.limit!==null&&i===1&&(t=HT(t,null,"F"),r=Ia(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((s=>{const a=an(...s);return this.ps.getDocuments(e,a).next((o=>this.indexManager.getMinOffset(e,r).next((l=>{const u=this.Ds(t,o);return this.Cs(t,u,a,l.readTime)?this.ys(e,HT(t,null,"F")):this.vs(e,u,t,l)}))))})))))}ws(e,t,r,i){return KM(t)||i.isEqual(Mt.min())?fe.resolve(null):this.ps.getDocuments(e,r).next((s=>{const a=this.Ds(t,s);return this.Cs(t,a,r,i)?fe.resolve(null):(Tf()<=hn.DEBUG&&Ze("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),bf(t)),this.vs(e,a,t,Jq(i,lp)).next((o=>o)))}))}Ds(e,t){let r=new Kn(fF(e));return t.forEach(((i,s)=>{d1(e,s)&&(r=r.add(s))})),r}Cs(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,t,r){return Tf()<=hn.DEBUG&&Ze("QueryEngine","Using full collection scan to execute query:",bf(t)),this.ps.getDocumentsMatchingQuery(e,t,na.min(),r)}vs(e,t,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next((s=>(t.forEach((a=>{s=s.insert(a.key,a)})),s)))}}const xA="LocalStore",JQ=3e8;class eJ{constructor(e,t,r,i){this.persistence=e,this.Fs=t,this.serializer=i,this.Ms=new pr(Xt),this.xs=new ql((s=>Xh(s)),u1),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new JF(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function t8(n,e,t,r){return new eJ(n,e,t,r)}async function n8(n,e){const t=qt(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next((s=>(i=s,t.Bs(e),t.mutationQueue.getAllMutationBatches(r)))).next((s=>{const a=[],o=[];let l=an();for(const u of i){a.push(u.batchId);for(const h of u.mutations)l=l.add(h.key)}for(const u of s){o.push(u.batchId);for(const h of u.mutations)l=l.add(h.key)}return t.localDocuments.getDocuments(r,l).next((u=>({Ls:u,removedBatchIds:a,addedBatchIds:o})))}))}))}function tJ(n,e){const t=qt(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const i=e.batch.keys(),s=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(o,l,u,h){const f=u.batch,g=f.keys();let y=fe.resolve();return g.forEach((v=>{y=y.next((()=>h.getEntry(l,v))).next((x=>{const E=u.docVersions.get(v);At(E!==null,48541),x.version.compareTo(E)<0&&(f.applyToRemoteDocument(x,u),x.isValidDocument()&&(x.setReadTime(u.commitVersion),h.addEntry(x)))}))})),y.next((()=>o.mutationQueue.removeMutationBatch(l,f)))})(t,r,e,s).next((()=>s.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(o){let l=an();for(let u=0;u<o.mutationResults.length;++u)o.mutationResults[u].transformResults.length>0&&(l=l.add(o.batch.mutations[u].key));return l})(e)))).next((()=>t.localDocuments.getDocuments(r,i)))}))}function r8(n){const e=qt(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function nJ(n,e){const t=qt(n),r=e.snapshotVersion;let i=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(s=>{const a=t.Ns.newChangeBuffer({trackRemovals:!0});i=t.Ms;const o=[];e.targetChanges.forEach(((h,f)=>{const g=i.get(f);if(!g)return;o.push(t.Pi.removeMatchingKeys(s,h.removedDocuments,f).next((()=>t.Pi.addMatchingKeys(s,h.addedDocuments,f))));let y=g.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(f)!==null?y=y.withResumeToken(Xr.EMPTY_BYTE_STRING,Mt.min()).withLastLimboFreeSnapshotVersion(Mt.min()):h.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(h.resumeToken,r)),i=i.insert(f,y),(function(x,E,T){return x.resumeToken.approximateByteSize()===0||E.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=JQ?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0})(g,y,h)&&o.push(t.Pi.updateTargetData(s,y))}));let l=Qs(),u=an();if(e.documentUpdates.forEach((h=>{e.resolvedLimboDocuments.has(h)&&o.push(t.persistence.referenceDelegate.updateLimboDocument(s,h))})),o.push(rJ(s,a,e.documentUpdates).next((h=>{l=h.ks,u=h.qs}))),!r.isEqual(Mt.min())){const h=t.Pi.getLastRemoteSnapshotVersion(s).next((f=>t.Pi.setTargetsMetadata(s,s.currentSequenceNumber,r)));o.push(h)}return fe.waitFor(o).next((()=>a.apply(s))).next((()=>t.localDocuments.getLocalViewOfDocuments(s,l,u))).next((()=>l))})).then((s=>(t.Ms=i,s)))}function rJ(n,e,t){let r=an(),i=an();return t.forEach((s=>r=r.add(s))),e.getEntries(n,r).next((s=>{let a=Qs();return t.forEach(((o,l)=>{const u=s.get(o);l.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(o)),l.isNoDocument()&&l.version.isEqual(Mt.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):Ze(xA,"Ignoring outdated watch update for ",o,". Current version:",u.version," Watch version:",l.version)})),{ks:a,qs:i}}))}function iJ(n,e){const t=qt(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=Rh),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function sJ(n,e){const t=qt(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let i;return t.Pi.getTargetData(r,e).next((s=>s?(i=s,fe.resolve(i)):t.Pi.allocateTargetId(r).next((a=>(i=new Il(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,i).next((()=>i)))))))})).then((r=>{const i=t.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r}))}async function eb(n,e,t){const r=qt(n),i=r.Ms.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,(a=>r.persistence.referenceDelegate.removeTarget(a,i)))}catch(a){if(!Tu(a))throw a;Ze(xA,`Failed to update sequence numbers for target ${e}: ${a}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function TN(n,e,t){const r=qt(n);let i=Mt.min(),s=an();return r.persistence.runTransaction("Execute query","readwrite",(a=>(function(l,u,h){const f=qt(l),g=f.xs.get(h);return g!==void 0?fe.resolve(f.Ms.get(g)):f.Pi.getTargetData(u,h)})(r,a,Ia(e)).next((o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(a,o.targetId).next((l=>{s=l}))})).next((()=>r.Fs.getDocumentsMatchingQuery(a,e,t?i:Mt.min(),t?s:an()))).next((o=>(aJ(r,WZ(e),o),{documents:o,Qs:s})))))}function aJ(n,e,t){let r=n.Os.get(e)||Mt.min();t.forEach(((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)})),n.Os.set(e,r)}class bN{constructor(){this.activeTargetIds=ZZ()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class i8{constructor(){this.Mo=new bN,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new bN,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class oJ{Oo(e){}shutdown(){}}const IN="ConnectivityMonitor";class AN{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Ze(IN,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Ze(IN,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let r_=null;function tb(){return r_===null?r_=(function(){return 268435456+Math.round(2147483648*Math.random())})():r_++,"0x"+r_.toString(16)}const gS="RestConnection",lJ={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class cJ{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===Mx?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,t,r,i,s){const a=tb(),o=this.zo(e,t.toUriEncodedString());Ze(gS,`Sending RPC '${e}' ${a}:`,o,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,i,s);const{host:u}=new URL(o),h=dd(u);return this.Jo(e,o,l,r,h).then((f=>(Ze(gS,`Received RPC '${e}' ${a}: `,f),f)),(f=>{throw Kh(gS,`RPC '${e}' ${a} failed with error: `,f,"url: ",o,"request:",r),f}))}Ho(e,t,r,i,s,a){return this.Go(e,t,r,i,s)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+G0})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((i,s)=>e[s]=i)),r&&r.headers.forEach(((i,s)=>e[s]=i))}zo(e,t){const r=lJ[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}class uJ{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const Gi="WebChannelConnection";class hJ extends cJ{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,i,s){const a=tb();return new Promise(((o,l)=>{const u=new T6;u.setWithCredentials(!0),u.listenOnce(b6.COMPLETE,(()=>{try{switch(u.getLastErrorCode()){case P_.NO_ERROR:const f=u.getResponseJson();Ze(Gi,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(f)),o(f);break;case P_.TIMEOUT:Ze(Gi,`RPC '${e}' ${a} timed out`),l(new at(Pe.DEADLINE_EXCEEDED,"Request time out"));break;case P_.HTTP_ERROR:const g=u.getStatus();if(Ze(Gi,`RPC '${e}' ${a} failed with status:`,g,"response text:",u.getResponseText()),g>0){let y=u.getResponseJson();Array.isArray(y)&&(y=y[0]);const v=y?.error;if(v&&v.status&&v.message){const x=(function(T){const b=T.toLowerCase().replace(/_/g,"-");return Object.values(Pe).indexOf(b)>=0?b:Pe.UNKNOWN})(v.status);l(new at(x,v.message))}else l(new at(Pe.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new at(Pe.UNAVAILABLE,"Connection failed."));break;default:Et(9055,{l_:e,streamId:a,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{Ze(Gi,`RPC '${e}' ${a} completed.`)}}));const h=JSON.stringify(i);Ze(Gi,`RPC '${e}' ${a} sending request:`,i),u.send(t,"POST",h,r,15)}))}T_(e,t,r){const i=tb(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=R6(),o=A6(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;const h=s.join("");Ze(Gi,`Creating RPC '${e}' stream ${i}: ${h}`,l);const f=a.createWebChannel(h,l);this.I_(f);let g=!1,y=!1;const v=new uJ({Yo:E=>{y?Ze(Gi,`Not sending because RPC '${e}' stream ${i} is closed:`,E):(g||(Ze(Gi,`Opening RPC '${e}' stream ${i} transport.`),f.open(),g=!0),Ze(Gi,`RPC '${e}' stream ${i} sending:`,E),f.send(E))},Zo:()=>f.close()}),x=(E,T,b)=>{E.listen(T,(I=>{try{b(I)}catch(M){setTimeout((()=>{throw M}),0)}}))};return x(f,nm.EventType.OPEN,(()=>{y||(Ze(Gi,`RPC '${e}' stream ${i} transport opened.`),v.o_())})),x(f,nm.EventType.CLOSE,(()=>{y||(y=!0,Ze(Gi,`RPC '${e}' stream ${i} transport closed`),v.a_(),this.E_(f))})),x(f,nm.EventType.ERROR,(E=>{y||(y=!0,Kh(Gi,`RPC '${e}' stream ${i} transport errored. Name:`,E.name,"Message:",E.message),v.a_(new at(Pe.UNAVAILABLE,"The operation could not be completed")))})),x(f,nm.EventType.MESSAGE,(E=>{if(!y){const T=E.data[0];At(!!T,16349);const b=T,I=b?.error||b[0]?.error;if(I){Ze(Gi,`RPC '${e}' stream ${i} received error:`,I);const M=I.status;let F=(function(C){const k=$r[C];if(k!==void 0)return IF(k)})(M),z=I.message;F===void 0&&(F=Pe.INTERNAL,z="Unknown error status: "+M+" with message "+I.message),y=!0,v.a_(new at(F,z)),f.close()}else Ze(Gi,`RPC '${e}' stream ${i} received:`,T),v.u_(T)}})),x(o,I6.STAT_EVENT,(E=>{E.stat===NT.PROXY?Ze(Gi,`RPC '${e}' stream ${i} detected buffering proxy`):E.stat===NT.NOPROXY&&Ze(Gi,`RPC '${e}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{v.__()}),0),v}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function dJ(){return typeof window<"u"?window:null}function B_(){return typeof document<"u"?document:null}function xw(n){return new fQ(n,!0)}class s8{constructor(e,t,r=1e3,i=1.5,s=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=i,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-r);i>0&&Ze("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const RN="PersistentStream";class a8{constructor(e,t,r,i,s,a,o,l){this.Mi=e,this.S_=r,this.b_=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new s8(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===Pe.RESOURCE_EXHAUSTED?(ls(t.toString()),ls("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===Pe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,i])=>{this.D_===t&&this.G_(r,i)}),(r=>{e((()=>{const i=new at(Pe.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)}))}))}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((i=>{r((()=>this.z_(i)))})),this.stream.onMessage((i=>{r((()=>++this.F_==1?this.J_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Ze(RN,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(Ze(RN,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class fJ extends a8{constructor(e,t,r,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=pQ(this.serializer,e),r=(function(s){if(!("targetChange"in s))return Mt.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?Mt.min():a.readTime?us(a.readTime):Mt.min()})(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=XT(this.serializer),t.addTarget=(function(s,a){let o;const l=a.target;if(o=Lx(l)?{documents:LF(s,l)}:{query:OF(s,l).ft},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=CF(s,a.resumeToken);const u=KT(s,a.expectedCount);u!==null&&(o.expectedCount=u)}else if(a.snapshotVersion.compareTo(Mt.min())>0){o.readTime=I0(s,a.snapshotVersion.toTimestamp());const u=KT(s,a.expectedCount);u!==null&&(o.expectedCount=u)}return o})(this.serializer,e);const r=_Q(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=XT(this.serializer),t.removeTarget=e,this.q_(t)}}class gJ extends a8{constructor(e,t,r,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return At(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,At(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){At(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=yQ(e.writeResults,e.commitTime),r=us(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=XT(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>Fx(this.serializer,r)))};this.q_(t)}}class mJ{}class pJ extends mJ{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new at(Pe.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,a])=>this.connection.Go(e,YT(t,r),i,s,a))).catch((s=>{throw s.name==="FirebaseError"?(s.code===Pe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new at(Pe.UNKNOWN,s.toString())}))}Ho(e,t,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,o])=>this.connection.Ho(e,YT(t,r),i,a,o,s))).catch((a=>{throw a.name==="FirebaseError"?(a.code===Pe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new at(Pe.UNKNOWN,a.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class yJ{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ls(t),this.aa=!1):Ze("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Jh="RemoteStore";class _J{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo((a=>{r.enqueueAndForget((async()=>{md(this)&&(Ze(Jh,"Restarting streams for network reachability change."),await(async function(l){const u=qt(l);u.Ea.add(4),await g1(u),u.Ra.set("Unknown"),u.Ea.delete(4),await vw(u)})(this))}))})),this.Ra=new yJ(r,i)}}async function vw(n){if(md(n))for(const e of n.da)await e(!0)}async function g1(n){for(const e of n.da)await e(!1)}function o8(n,e){const t=qt(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),SA(t)?EA(t):U0(t).O_()&&wA(t,e))}function vA(n,e){const t=qt(n),r=U0(t);t.Ia.delete(e),r.O_()&&l8(t,e),t.Ia.size===0&&(r.O_()?r.L_():md(t)&&t.Ra.set("Unknown"))}function wA(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Mt.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}U0(n).Y_(e)}function l8(n,e){n.Va.Ue(e),U0(n).Z_(e)}function EA(n){n.Va=new cQ({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),U0(n).start(),n.Ra.ua()}function SA(n){return md(n)&&!U0(n).x_()&&n.Ia.size>0}function md(n){return qt(n).Ea.size===0}function c8(n){n.Va=void 0}async function xJ(n){n.Ra.set("Online")}async function vJ(n){n.Ia.forEach(((e,t)=>{wA(n,e)}))}async function wJ(n,e){c8(n),SA(n)?(n.Ra.ha(e),EA(n)):n.Ra.set("Unknown")}async function EJ(n,e,t){if(n.Ra.set("Online"),e instanceof RF&&e.state===2&&e.cause)try{await(async function(i,s){const a=s.cause;for(const o of s.targetIds)i.Ia.has(o)&&(await i.remoteSyncer.rejectListen(o,a),i.Ia.delete(o),i.Va.removeTarget(o))})(n,e)}catch(r){Ze(Jh,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Ux(n,r)}else if(e instanceof V_?n.Va.Ze(e):e instanceof AF?n.Va.st(e):n.Va.tt(e),!t.isEqual(Mt.min()))try{const r=await r8(n.localStore);t.compareTo(r)>=0&&await(function(s,a){const o=s.Va.Tt(a);return o.targetChanges.forEach(((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const h=s.Ia.get(u);h&&s.Ia.set(u,h.withResumeToken(l.resumeToken,a))}})),o.targetMismatches.forEach(((l,u)=>{const h=s.Ia.get(l);if(!h)return;s.Ia.set(l,h.withResumeToken(Xr.EMPTY_BYTE_STRING,h.snapshotVersion)),l8(s,l);const f=new Il(h.target,l,u,h.sequenceNumber);wA(s,f)})),s.remoteSyncer.applyRemoteEvent(o)})(n,t)}catch(r){Ze(Jh,"Failed to raise snapshot:",r),await Ux(n,r)}}async function Ux(n,e,t){if(!Tu(e))throw e;n.Ea.add(1),await g1(n),n.Ra.set("Offline"),t||(t=()=>r8(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{Ze(Jh,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await vw(n)}))}function u8(n,e){return e().catch((t=>Ux(n,t,e)))}async function m1(n){const e=qt(n),t=fu(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Rh;for(;SJ(e);)try{const i=await iJ(e.localStore,r);if(i===null){e.Ta.length===0&&t.L_();break}r=i.batchId,TJ(e,i)}catch(i){await Ux(e,i)}h8(e)&&d8(e)}function SJ(n){return md(n)&&n.Ta.length<10}function TJ(n,e){n.Ta.push(e);const t=fu(n);t.O_()&&t.X_&&t.ea(e.mutations)}function h8(n){return md(n)&&!fu(n).x_()&&n.Ta.length>0}function d8(n){fu(n).start()}async function bJ(n){fu(n).ra()}async function IJ(n){const e=fu(n);for(const t of n.Ta)e.ea(t.mutations)}async function AJ(n,e,t){const r=n.Ta.shift(),i=cA.from(r,e,t);await u8(n,(()=>n.remoteSyncer.applySuccessfulWrite(i))),await m1(n)}async function RJ(n,e){e&&fu(n).X_&&await(async function(r,i){if((function(a){return aQ(a)&&a!==Pe.ABORTED})(i.code)){const s=r.Ta.shift();fu(r).B_(),await u8(r,(()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i))),await m1(r)}})(n,e),h8(n)&&d8(n)}async function CN(n,e){const t=qt(n);t.asyncQueue.verifyOperationInProgress(),Ze(Jh,"RemoteStore received new credentials");const r=md(t);t.Ea.add(3),await g1(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await vw(t)}async function CJ(n,e){const t=qt(n);e?(t.Ea.delete(2),await vw(t)):e||(t.Ea.add(2),await g1(t),t.Ra.set("Unknown"))}function U0(n){return n.ma||(n.ma=(function(t,r,i){const s=qt(t);return s.sa(),new fJ(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Xo:xJ.bind(null,n),t_:vJ.bind(null,n),r_:wJ.bind(null,n),H_:EJ.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),SA(n)?EA(n):n.Ra.set("Unknown")):(await n.ma.stop(),c8(n))}))),n.ma}function fu(n){return n.fa||(n.fa=(function(t,r,i){const s=qt(t);return s.sa(),new gJ(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:bJ.bind(null,n),r_:RJ.bind(null,n),ta:IJ.bind(null,n),na:AJ.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await m1(n)):(await n.fa.stop(),n.Ta.length>0&&(Ze(Jh,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class TA{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Uo,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((a=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){const a=Date.now()+r,o=new TA(e,t,a,i,s);return o.start(r),o}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new at(Pe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function bA(n,e){if(ls("AsyncQueue",`${e}: ${n}`),Tu(n))return new at(Pe.UNAVAILABLE,`${e}: ${n}`);throw n}class Xf{static emptySet(e){return new Xf(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||ct.comparator(t.key,r.key):(t,r)=>ct.comparator(t.key,r.key),this.keyedMap=rm(),this.sortedSet=new pr(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Xf)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Xf;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class kN{constructor(){this.ga=new pr(ct.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Et(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class A0{constructor(e,t,r,i,s,a,o,l,u){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,t,r,i,s){const a=[];return t.forEach((o=>{a.push({type:0,doc:o})})),new A0(e,t,Xf.emptySet(t),a,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&hw(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}class kJ{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class PJ{constructor(){this.queries=PN(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const i=qt(t),s=i.queries;i.queries=PN(),s.forEach(((a,o)=>{for(const l of o.Sa)l.onError(r)}))})(this,new at(Pe.ABORTED,"Firestore shutting down"))}}function PN(){return new ql((n=>dF(n)),hw)}async function f8(n,e){const t=qt(n);let r=3;const i=e.query;let s=t.queries.get(i);s?!s.ba()&&e.Da()&&(r=2):(s=new kJ,r=e.Da()?0:1);try{switch(r){case 0:s.wa=await t.onListen(i,!0);break;case 1:s.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(a){const o=bA(a,`Initialization of query '${bf(e.query)}' failed`);return void e.onError(o)}t.queries.set(i,s),s.Sa.push(e),e.va(t.onlineState),s.wa&&e.Fa(s.wa)&&IA(t)}async function g8(n,e){const t=qt(n),r=e.query;let i=3;const s=t.queries.get(r);if(s){const a=s.Sa.indexOf(e);a>=0&&(s.Sa.splice(a,1),s.Sa.length===0?i=e.Da()?0:1:!s.ba()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function MJ(n,e){const t=qt(n);let r=!1;for(const i of e){const s=i.query,a=t.queries.get(s);if(a){for(const o of a.Sa)o.Fa(i)&&(r=!0);a.wa=i}}r&&IA(t)}function NJ(n,e,t){const r=qt(n),i=r.queries.get(e);if(i)for(const s of i.Sa)s.onError(t);r.queries.delete(e)}function IA(n){n.Ca.forEach((e=>{e.next()}))}var nb,MN;(MN=nb||(nb={})).Ma="default",MN.Cache="cache";class m8{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new A0(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=A0.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==nb.Cache}}class p8{constructor(e){this.key=e}}class y8{constructor(e){this.key=e}}class LJ{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=an(),this.mutatedKeys=an(),this.eu=fF(e),this.tu=new Xf(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new kN,i=t?t.tu:this.tu;let s=t?t.mutatedKeys:this.mutatedKeys,a=i,o=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((h,f)=>{const g=i.get(h),y=d1(this.query,f)?f:null,v=!!g&&this.mutatedKeys.has(g.key),x=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let E=!1;g&&y?g.data.isEqual(y.data)?v!==x&&(r.track({type:3,doc:y}),E=!0):this.su(g,y)||(r.track({type:2,doc:y}),E=!0,(l&&this.eu(y,l)>0||u&&this.eu(y,u)<0)&&(o=!0)):!g&&y?(r.track({type:0,doc:y}),E=!0):g&&!y&&(r.track({type:1,doc:g}),E=!0,(l||u)&&(o=!0)),E&&(y?(a=a.add(y),s=x?s.add(h):s.delete(h)):(a=a.delete(h),s=s.delete(h)))})),this.query.limit!==null)for(;a.size>this.query.limit;){const h=this.query.limitType==="F"?a.last():a.first();a=a.delete(h.key),s=s.delete(h.key),r.track({type:1,doc:h})}return{tu:a,iu:r,Cs:o,mutatedKeys:s}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort(((h,f)=>(function(y,v){const x=E=>{switch(E){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Et(20277,{Rt:E})}};return x(y)-x(v)})(h.type,f.type)||this.eu(h.doc,f.doc))),this.ou(r),i=i??!1;const o=t&&!i?this._u():[],l=this.Xa.size===0&&this.current&&!i?1:0,u=l!==this.Za;return this.Za=l,a.length!==0||u?{snapshot:new A0(this.query,e.tu,s,a,e.mutatedKeys,l===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:o}:{au:o}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new kN,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=an(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const t=[];return e.forEach((r=>{this.Xa.has(r)||t.push(new y8(r))})),this.Xa.forEach((r=>{e.has(r)||t.push(new p8(r))})),t}cu(e){this.Ya=e.Qs,this.Xa=an();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return A0.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const AA="SyncEngine";class OJ{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class DJ{constructor(e){this.key=e,this.hu=!1}}class FJ{constructor(e,t,r,i,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new ql((o=>dF(o)),hw),this.Iu=new Map,this.Eu=new Set,this.du=new pr(ct.comparator),this.Au=new Map,this.Ru=new mA,this.Vu={},this.mu=new Map,this.fu=Qh.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function jJ(n,e,t=!0){const r=S8(n);let i;const s=r.Tu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await _8(r,e,t,!0),i}async function VJ(n,e){const t=S8(n);await _8(t,e,!0,!1)}async function _8(n,e,t,r){const i=await sJ(n.localStore,Ia(e)),s=i.targetId,a=n.sharedClientState.addLocalQueryTarget(s,t);let o;return r&&(o=await GJ(n,e,s,a==="current",i.resumeToken)),n.isPrimaryClient&&t&&o8(n.remoteStore,i),o}async function GJ(n,e,t,r,i){n.pu=(f,g,y)=>(async function(x,E,T,b){let I=E.view.ru(T);I.Cs&&(I=await TN(x.localStore,E.query,!1).then((({documents:P})=>E.view.ru(P,I))));const M=b&&b.targetChanges.get(E.targetId),F=b&&b.targetMismatches.get(E.targetId)!=null,z=E.view.applyChanges(I,x.isPrimaryClient,M,F);return LN(x,E.targetId,z.au),z.snapshot})(n,f,g,y);const s=await TN(n.localStore,e,!0),a=new LJ(e,s.Qs),o=a.ru(s.documents),l=f1.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),u=a.applyChanges(o,n.isPrimaryClient,l);LN(n,t,u.au);const h=new OJ(e,t,a);return n.Tu.set(e,h),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),u.snapshot}async function BJ(n,e,t){const r=qt(n),i=r.Tu.get(e),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter((a=>!hw(a,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await eb(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),t&&vA(r.remoteStore,i.targetId),rb(r,i.targetId)})).catch(gd)):(rb(r,i.targetId),await eb(r.localStore,i.targetId,!0))}async function UJ(n,e){const t=qt(n),r=t.Tu.get(e),i=t.Iu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),vA(t.remoteStore,r.targetId))}async function zJ(n,e,t){const r=T8(n);try{const i=await(function(a,o){const l=qt(a),u=zn.now(),h=o.reduce(((y,v)=>y.add(v.key)),an());let f,g;return l.persistence.runTransaction("Locally write mutations","readwrite",(y=>{let v=Qs(),x=an();return l.Ns.getEntries(y,h).next((E=>{v=E,v.forEach(((T,b)=>{b.isValidDocument()||(x=x.add(T))}))})).next((()=>l.localDocuments.getOverlayedDocuments(y,v))).next((E=>{f=E;const T=[];for(const b of o){const I=iQ(b,f.get(b.key).overlayedDocument);I!=null&&T.push(new Zl(b.key,I,rF(I.value.mapValue),Hi.exists(!0)))}return l.mutationQueue.addMutationBatch(y,u,T,o)})).next((E=>{g=E;const T=E.applyToLocalDocumentSet(f,x);return l.documentOverlayCache.saveOverlays(y,E.batchId,T)}))})).then((()=>({batchId:g.batchId,changes:mF(f)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(a,o,l){let u=a.Vu[a.currentUser.toKey()];u||(u=new pr(Xt)),u=u.insert(o,l),a.Vu[a.currentUser.toKey()]=u})(r,i.batchId,t),await p1(r,i.changes),await m1(r.remoteStore)}catch(i){const s=bA(i,"Failed to persist write");t.reject(s)}}async function x8(n,e){const t=qt(n);try{const r=await nJ(t.localStore,e);e.targetChanges.forEach(((i,s)=>{const a=t.Au.get(s);a&&(At(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?a.hu=!0:i.modifiedDocuments.size>0?At(a.hu,14607):i.removedDocuments.size>0&&(At(a.hu,42227),a.hu=!1))})),await p1(t,r,e)}catch(r){await gd(r)}}function NN(n,e,t){const r=qt(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.Tu.forEach(((s,a)=>{const o=a.view.va(e);o.snapshot&&i.push(o.snapshot)})),(function(a,o){const l=qt(a);l.onlineState=o;let u=!1;l.queries.forEach(((h,f)=>{for(const g of f.Sa)g.va(o)&&(u=!0)})),u&&IA(l)})(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function $J(n,e,t){const r=qt(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Au.get(e),s=i&&i.key;if(s){let a=new pr(ct.comparator);a=a.insert(s,Cr.newNoDocument(s,Mt.min()));const o=an().add(s),l=new mw(Mt.min(),new Map,new pr(Xt),a,o);await x8(r,l),r.du=r.du.remove(s),r.Au.delete(e),RA(r)}else await eb(r.localStore,e,!1).then((()=>rb(r,e,t))).catch(gd)}async function WJ(n,e){const t=qt(n),r=e.batch.batchId;try{const i=await tJ(t.localStore,e);w8(t,r,null),v8(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await p1(t,i)}catch(i){await gd(i)}}async function HJ(n,e,t){const r=qt(n);try{const i=await(function(a,o){const l=qt(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",(u=>{let h;return l.mutationQueue.lookupMutationBatch(u,o).next((f=>(At(f!==null,37113),h=f.keys(),l.mutationQueue.removeMutationBatch(u,f)))).next((()=>l.mutationQueue.performConsistencyCheck(u))).next((()=>l.documentOverlayCache.removeOverlaysForBatchId(u,h,o))).next((()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,h))).next((()=>l.localDocuments.getDocuments(u,h)))}))})(r.localStore,e);w8(r,e,t),v8(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await p1(r,i)}catch(i){await gd(i)}}function v8(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function w8(n,e,t){const r=qt(n);let i=r.Vu[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function rb(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((r=>{n.Ru.containsKey(r)||E8(n,r)}))}function E8(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(vA(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),RA(n))}function LN(n,e,t){for(const r of t)r instanceof p8?(n.Ru.addReference(r.key,e),KJ(n,r)):r instanceof y8?(Ze(AA,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||E8(n,r.key)):Et(19791,{wu:r})}function KJ(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(Ze(AA,"New document in limbo: "+t),n.Eu.add(r),RA(n))}function RA(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new ct(kn.fromString(e)),r=n.fu.next();n.Au.set(r,new DJ(t)),n.du=n.du.insert(t,r),o8(n.remoteStore,new Il(Ia(uw(t.path)),r,"TargetPurposeLimboResolution",Ta.ce))}}async function p1(n,e,t){const r=qt(n),i=[],s=[],a=[];r.Tu.isEmpty()||(r.Tu.forEach(((o,l)=>{a.push(r.pu(l,e,t).then((u=>{if((u||t)&&r.isPrimaryClient){const h=u?!u.fromCache:t?.targetChanges.get(l.targetId)?.current;r.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(u){i.push(u);const h=_A.As(l.targetId,u);s.push(h)}})))})),await Promise.all(a),r.Pu.H_(i),await(async function(l,u){const h=qt(l);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",(f=>fe.forEach(u,(g=>fe.forEach(g.Es,(y=>h.persistence.referenceDelegate.addReference(f,g.targetId,y))).next((()=>fe.forEach(g.ds,(y=>h.persistence.referenceDelegate.removeReference(f,g.targetId,y)))))))))}catch(f){if(!Tu(f))throw f;Ze(xA,"Failed to update sequence numbers: "+f)}for(const f of u){const g=f.targetId;if(!f.fromCache){const y=h.Ms.get(g),v=y.snapshotVersion,x=y.withLastLimboFreeSnapshotVersion(v);h.Ms=h.Ms.insert(g,x)}}})(r.localStore,s))}async function YJ(n,e){const t=qt(n);if(!t.currentUser.isEqual(e)){Ze(AA,"User change. New user:",e.toKey());const r=await n8(t.localStore,e);t.currentUser=e,(function(s,a){s.mu.forEach((o=>{o.forEach((l=>{l.reject(new at(Pe.CANCELLED,a))}))})),s.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await p1(t,r.Ls)}}function XJ(n,e){const t=qt(n),r=t.Au.get(e);if(r&&r.hu)return an().add(r.key);{let i=an();const s=t.Iu.get(e);if(!s)return i;for(const a of s){const o=t.Tu.get(a);i=i.unionWith(o.view.nu)}return i}}function S8(n){const e=qt(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=x8.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=XJ.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=$J.bind(null,e),e.Pu.H_=MJ.bind(null,e.eventManager),e.Pu.yu=NJ.bind(null,e.eventManager),e}function T8(n){const e=qt(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=WJ.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=HJ.bind(null,e),e}class xp{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=xw(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return t8(this.persistence,new e8,e.initialUser,this.serializer)}Cu(e){return new pA(_w.mi,this.serializer)}Du(e){return new i8}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}xp.provider={build:()=>new xp};class qJ extends xp{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){At(this.persistence.referenceDelegate instanceof Bx,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new XF(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?zi.withCacheSize(this.cacheSizeBytes):zi.DEFAULT;return new pA((r=>Bx.mi(r,t)),this.serializer)}}class ZJ extends xp{constructor(e,t,r){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await T8(this.xu.syncEngine),await m1(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return t8(this.persistence,new e8,e.initialUser,this.serializer)}Fu(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new XF(r,e.asyncQueue,t)}Mu(e,t){const r=new rZ(t,this.persistence);return new nZ(e.asyncQueue,r)}Cu(e){const t=ZQ(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?zi.withCacheSize(this.cacheSizeBytes):zi.DEFAULT;return new yA(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,dJ(),B_(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new i8}}class zx{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>NN(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=YJ.bind(null,this.syncEngine),await CJ(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new PJ})()}createDatastore(e){const t=xw(e.databaseInfo.databaseId),r=(function(s){return new hJ(s)})(e.databaseInfo);return(function(s,a,o,l){return new pJ(s,a,o,l)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,i,s,a,o){return new _J(r,i,s,a,o)})(this.localStore,this.datastore,e.asyncQueue,(t=>NN(this.syncEngine,t,0)),(function(){return AN.v()?new AN:new oJ})())}createSyncEngine(e,t){return(function(i,s,a,o,l,u,h){const f=new FJ(i,s,a,o,l,u);return h&&(f.gu=!0),f})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const r=qt(t);Ze(Jh,"RemoteStore shutting down."),r.Ea.add(5),await g1(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}zx.provider={build:()=>new zx};class b8{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):ls("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const gu="FirestoreClient";class QJ{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Ii.UNAUTHENTICATED,this.clientId=qI.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,(async a=>{Ze(gu,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(r,(a=>(Ze(gu,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Uo;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=bA(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function mS(n,e){n.asyncQueue.verifyOperationInProgress(),Ze(gu,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async i=>{r.isEqual(i)||(await n8(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function ON(n,e){n.asyncQueue.verifyOperationInProgress();const t=await JJ(n);Ze(gu,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>CN(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,i)=>CN(e.remoteStore,i))),n._onlineComponents=e}async function JJ(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Ze(gu,"Using user provided OfflineComponentProvider");try{await mS(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===Pe.FAILED_PRECONDITION||i.code===Pe.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;Kh("Error using user provided cache. Falling back to memory cache: "+t),await mS(n,new xp)}}else Ze(gu,"Using default OfflineComponentProvider"),await mS(n,new qJ(void 0));return n._offlineComponents}async function I8(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Ze(gu,"Using user provided OnlineComponentProvider"),await ON(n,n._uninitializedComponentsProvider._online)):(Ze(gu,"Using default OnlineComponentProvider"),await ON(n,new zx))),n._onlineComponents}function eee(n){return I8(n).then((e=>e.syncEngine))}async function A8(n){const e=await I8(n),t=e.eventManager;return t.onListen=jJ.bind(null,e.syncEngine),t.onUnlisten=BJ.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=VJ.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=UJ.bind(null,e.syncEngine),t}function tee(n,e,t={}){const r=new Uo;return n.asyncQueue.enqueueAndForget((async()=>(function(s,a,o,l,u){const h=new b8({next:g=>{h.Nu(),a.enqueueAndForget((()=>g8(s,f)));const y=g.docs.has(o);!y&&g.fromCache?u.reject(new at(Pe.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&g.fromCache&&l&&l.source==="server"?u.reject(new at(Pe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(g)},error:g=>u.reject(g)}),f=new m8(uw(o.path),h,{includeMetadataChanges:!0,qa:!0});return f8(s,f)})(await A8(n),n.asyncQueue,e,t,r))),r.promise}function nee(n,e,t={}){const r=new Uo;return n.asyncQueue.enqueueAndForget((async()=>(function(s,a,o,l,u){const h=new b8({next:g=>{h.Nu(),a.enqueueAndForget((()=>g8(s,f))),g.fromCache&&l.source==="server"?u.reject(new at(Pe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(g)},error:g=>u.reject(g)}),f=new m8(o,h,{includeMetadataChanges:!0,qa:!0});return f8(s,f)})(await A8(n),n.asyncQueue,e,t,r))),r.promise}function R8(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const DN=new Map;const C8="firestore.googleapis.com",FN=!0;class jN{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new at(Pe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=C8,this.ssl=FN}else this.host=e.host,this.ssl=e.ssl??FN;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=WF;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<LQ)throw new at(Pe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Qq("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=R8(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new at(Pe.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new at(Pe.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new at(Pe.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class ww{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new jN({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new at(Pe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new at(Pe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new jN(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new Uq;switch(r.type){case"firstParty":return new Hq(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new at(Pe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=DN.get(t);r&&(Ze("ComponentProvider","Removing Datastore"),DN.delete(t),r.terminate())})(this),Promise.resolve()}}function ree(n,e,t,r={}){n=Pa(n,ww);const i=dd(e),s=n._getSettings(),a={...s,emulatorOptions:n._getEmulatorOptions()},o=`${e}:${t}`;i&&(OI(`https://${o}`),DI("Firestore",!0)),s.host!==C8&&s.host!==o&&Kh("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...s,host:o,ssl:i,emulatorOptions:r};if(!zh(l,a)&&(n._setSettings(l),r.mockUserToken)){let u,h;if(typeof r.mockUserToken=="string")u=r.mockUserToken,h=Ii.MOCK_USER;else{u=LD(r.mockUserToken,n._app?.options.projectId);const f=r.mockUserToken.sub||r.mockUserToken.user_id;if(!f)throw new at(Pe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new Ii(f)}n._authCredentials=new zq(new k6(u,h))}}class z0{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new z0(this.firestore,e,this._query)}}class Vr{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new au(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Vr(this.firestore,e,this._key)}toJSON(){return{type:Vr._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(l1(t,Vr._jsonSchema))return new Vr(e,r||null,new ct(kn.fromString(t.referencePath)))}}Vr._jsonSchemaVersion="firestore/documentReference/1.0",Vr._jsonSchema={type:Kr("string",Vr._jsonSchemaVersion),referencePath:Kr("string")};class au extends z0{constructor(e,t,r){super(e,t,uw(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Vr(this.firestore,null,new ct(e))}withConverter(e){return new au(this.firestore,e,this._path)}}function VN(n,e,...t){if(n=yi(n),M6("collection","path",e),n instanceof ww){const r=kn.fromString(e,...t);return RM(r),new au(n,null,r)}{if(!(n instanceof Vr||n instanceof au))throw new at(Pe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(kn.fromString(e,...t));return RM(r),new au(n.firestore,null,r)}}function qf(n,e,...t){if(n=yi(n),arguments.length===1&&(e=qI.newId()),M6("doc","path",e),n instanceof ww){const r=kn.fromString(e,...t);return AM(r),new Vr(n,null,new ct(r))}{if(!(n instanceof Vr||n instanceof au))throw new at(Pe.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(kn.fromString(e,...t));return AM(r),new Vr(n.firestore,n instanceof au?n.converter:null,new ct(r))}}const GN="AsyncQueue";class BN{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new s8(this,"async_queue_retry"),this._c=()=>{const r=B_();r&&Ze(GN,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=B_();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=B_();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Uo;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Tu(e))throw e;Ze(GN,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,ls("INTERNAL UNHANDLED ERROR: ",UN(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const i=TA.createAndSchedule(this,e,t,r,(s=>this.hc(s)));return this.tc.push(i),i}uc(){this.nc&&Et(47125,{Pc:UN(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function UN(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class Iu extends ww{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new BN,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new BN(e),this._firestoreClient=void 0,await e}}}function iee(n,e){const t=typeof n=="object"?n:VI(),r=typeof n=="string"?n:Mx,i=Qv(t,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=PD("firestore");s&&ree(i,...s)}return i}function CA(n){if(n._terminated)throw new at(Pe.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||k8(n),n._firestoreClient}function k8(n){const e=n._freezeSettings(),t=(function(i,s,a,o){return new MZ(i,s,a,o.host,o.ssl,o.experimentalForceLongPolling,o.experimentalAutoDetectLongPolling,R8(o.experimentalLongPollingOptions),o.useFetchStreams,o.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new QJ(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(i){const s=i?._online.build();return{_offline:i?._offline.build(s),_online:s}})(n._componentsProvider))}function see(n,e){Kh("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return aee(n,zx.provider,{build:r=>new ZJ(r,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function aee(n,e,t){if((n=Pa(n,Iu))._firestoreClient||n._terminated)throw new at(Pe.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new at(Pe.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},k8(n)}class va{constructor(e){this._byteString=e}static fromBase64String(e){try{return new va(Xr.fromBase64String(e))}catch(t){throw new at(Pe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new va(Xr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:va._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(l1(e,va._jsonSchema))return va.fromBase64String(e.bytes)}}va._jsonSchemaVersion="firestore/bytes/1.0",va._jsonSchema={type:Kr("string",va._jsonSchemaVersion),bytes:Kr("string")};class Ew{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new at(Pe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Er(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Sw{constructor(e){this._methodName=e}}class zo{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new at(Pe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new at(Pe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Xt(this._lat,e._lat)||Xt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:zo._jsonSchemaVersion}}static fromJSON(e){if(l1(e,zo._jsonSchema))return new zo(e.latitude,e.longitude)}}zo._jsonSchemaVersion="firestore/geoPoint/1.0",zo._jsonSchema={type:Kr("string",zo._jsonSchemaVersion),latitude:Kr("number"),longitude:Kr("number")};class $o{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:$o._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(l1(e,$o._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new $o(e.vectorValues);throw new at(Pe.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}$o._jsonSchemaVersion="firestore/vectorValue/1.0",$o._jsonSchema={type:Kr("string",$o._jsonSchemaVersion),vectorValues:Kr("object")};const oee=/^__.*__$/;class lee{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Zl(e,this.data,this.fieldMask,t,this.fieldTransforms):new B0(e,this.data,t,this.fieldTransforms)}}class P8{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Zl(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function M8(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Et(40011,{Ac:n})}}class kA{constructor(e,t,r,i,s,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new kA({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return $x(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(M8(this.Ac)&&oee.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class cee{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||xw(e)}Cc(e,t,r,i=!1){return new kA({Ac:e,methodName:t,Dc:r,path:Er.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Tw(n){const e=n._freezeSettings(),t=xw(n._databaseId);return new cee(n._databaseId,!!e.ignoreUndefinedProperties,t)}function N8(n,e,t,r,i,s={}){const a=n.Cc(s.merge||s.mergeFields?2:0,e,t,i);MA("Data must be an object, but it was:",a,r);const o=L8(r,a);let l,u;if(s.merge)l=new As(a.fieldMask),u=a.fieldTransforms;else if(s.mergeFields){const h=[];for(const f of s.mergeFields){const g=ib(e,f,t);if(!a.contains(g))throw new at(Pe.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);D8(h,g)||h.push(g)}l=new As(h),u=a.fieldTransforms.filter((f=>l.covers(f.field)))}else l=null,u=a.fieldTransforms;return new lee(new Wi(o),l,u)}class bw extends Sw{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof bw}}class PA extends Sw{_toFieldTransform(e){return new EF(e.path,new S0)}isEqual(e){return e instanceof PA}}function uee(n,e,t,r){const i=n.Cc(1,e,t);MA("Data must be an object, but it was:",i,r);const s=[],a=Wi.empty();bu(r,((l,u)=>{const h=NA(e,l,t);u=yi(u);const f=i.yc(h);if(u instanceof bw)s.push(h);else{const g=y1(u,f);g!=null&&(s.push(h),a.set(h,g))}}));const o=new As(s);return new P8(a,o,i.fieldTransforms)}function hee(n,e,t,r,i,s){const a=n.Cc(1,e,t),o=[ib(e,r,t)],l=[i];if(s.length%2!=0)throw new at(Pe.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<s.length;g+=2)o.push(ib(e,s[g])),l.push(s[g+1]);const u=[],h=Wi.empty();for(let g=o.length-1;g>=0;--g)if(!D8(u,o[g])){const y=o[g];let v=l[g];v=yi(v);const x=a.yc(y);if(v instanceof bw)u.push(y);else{const E=y1(v,x);E!=null&&(u.push(y),h.set(y,E))}}const f=new As(u);return new P8(h,f,a.fieldTransforms)}function dee(n,e,t,r=!1){return y1(t,n.Cc(r?4:3,e))}function y1(n,e){if(O8(n=yi(n)))return MA("Unsupported field value:",e,n),L8(n,e);if(n instanceof Sw)return(function(r,i){if(!M8(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,i){const s=[];let a=0;for(const o of r){let l=y1(o,i.wc(a));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),a++}return{arrayValue:{values:s}}})(n,e)}return(function(r,i){if((r=yi(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return QZ(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=zn.fromDate(r);return{timestampValue:I0(i.serializer,s)}}if(r instanceof zn){const s=new zn(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:I0(i.serializer,s)}}if(r instanceof zo)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof va)return{bytesValue:CF(i.serializer,r._byteString)};if(r instanceof Vr){const s=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(s))throw i.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:dA(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof $o)return(function(a,o){return{mapValue:{fields:{[iA]:{stringValue:sA},[x0]:{arrayValue:{values:a.toArray().map((u=>{if(typeof u!="number")throw o.Sc("VectorValues must only contain numeric values.");return oA(o.serializer,u)}))}}}}}})(r,i);throw i.Sc(`Unsupported field value: ${nw(r)}`)})(n,e)}function L8(n,e){const t={};return Y6(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):bu(n,((r,i)=>{const s=y1(i,e.mc(r));s!=null&&(t[r]=s)})),{mapValue:{fields:t}}}function O8(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof zn||n instanceof zo||n instanceof va||n instanceof Vr||n instanceof Sw||n instanceof $o)}function MA(n,e,t){if(!O8(t)||!N6(t)){const r=nw(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function ib(n,e,t){if((e=yi(e))instanceof Ew)return e._internalPath;if(typeof e=="string")return NA(n,e);throw $x("Field path arguments must be of type string or ",n,!1,void 0,t)}const fee=new RegExp("[~\\*/\\[\\]]");function NA(n,e,t){if(e.search(fee)>=0)throw $x(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Ew(...e.split("."))._internalPath}catch{throw $x(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function $x(n,e,t,r,i){const s=r&&!r.isEmpty(),a=i!==void 0;let o=`Function ${e}() called with invalid data`;t&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${r}`),a&&(l+=` in document ${i}`),l+=")"),new at(Pe.INVALID_ARGUMENT,o+n+l)}function D8(n,e){return n.some((t=>t.isEqual(e)))}class F8{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Vr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new gee(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(LA("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class gee extends F8{data(){return super.data()}}function LA(n,e){return typeof e=="string"?NA(n,e):e instanceof Ew?e._internalPath:e._delegate._internalPath}function mee(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new at(Pe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class OA{}class pee extends OA{}function yee(n,e,...t){let r=[];e instanceof OA&&r.push(e),r=r.concat(t),(function(s){const a=s.filter((l=>l instanceof DA)).length,o=s.filter((l=>l instanceof Iw)).length;if(a>1||a>0&&o>0)throw new at(Pe.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const i of r)n=i._apply(n);return n}class Iw extends pee{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new Iw(e,t,r)}_apply(e){const t=this._parse(e);return j8(e._query,t),new z0(e.firestore,e.converter,WT(e._query,t))}_parse(e){const t=Tw(e.firestore);return(function(s,a,o,l,u,h,f){let g;if(u.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new at(Pe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){$N(f,h);const v=[];for(const x of f)v.push(zN(l,s,x));g={arrayValue:{values:v}}}else g=zN(l,s,f)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||$N(f,h),g=dee(o,a,f,h==="in"||h==="not-in");return dn.create(u,h,g)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function _ee(n,e,t){const r=e,i=LA("where",n);return Iw._create(i,r,t)}class DA extends OA{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new DA(e,t)}_parse(e){const t=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return t.length===1?t[0]:Wn.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(i,s){let a=i;const o=s.getFlattenedFilters();for(const l of o)j8(a,l),a=WT(a,l)})(e._query,t),new z0(e.firestore,e.converter,WT(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function zN(n,e,t){if(typeof(t=yi(t))=="string"){if(t==="")throw new at(Pe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!hF(e)&&t.indexOf("/")!==-1)throw new at(Pe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(kn.fromString(t));if(!ct.isDocumentKey(r))throw new at(Pe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return pp(n,new ct(r))}if(t instanceof Vr)return pp(n,t._key);throw new at(Pe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${nw(t)}.`)}function $N(n,e){if(!Array.isArray(n)||n.length===0)throw new at(Pe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function j8(n,e){const t=(function(i,s){for(const a of i)for(const o of a.getFlattenedFilters())if(s.indexOf(o.op)>=0)return o.op;return null})(n.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new at(Pe.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new at(Pe.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class xee{convertValue(e,t="none"){switch(hu(e)){case 0:return null;case 1:return e.booleanValue;case 2:return gr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(zl(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Et(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return bu(e,((i,s)=>{r[i]=this.convertValue(s,t)})),r}convertVectorValue(e){const t=e.fields?.[x0].arrayValue?.values?.map((r=>gr(r.doubleValue)));return new $o(t)}convertGeoPoint(e){return new zo(gr(e.latitude),gr(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=lw(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(gp(e));default:return null}}convertTimestamp(e){const t=Ul(e);return new zn(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=kn.fromString(e);At(VF(r),9688,{name:e});const i=new Yh(r.get(1),r.get(3)),s=new ct(r.popFirst(5));return i.isEqual(t)||ls(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function V8(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class am{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ph extends F8{constructor(e,t,r,i,s,a){super(e,t,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new U_(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(LA("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new at(Pe.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Ph._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Ph._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ph._jsonSchema={type:Kr("string",Ph._jsonSchemaVersion),bundleSource:Kr("string","DocumentSnapshot"),bundleName:Kr("string"),bundle:Kr("string")};class U_ extends Ph{data(e={}){return super.data(e)}}class Zf{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new am(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new U_(this._firestore,this._userDataWriter,r.key,r,new am(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new at(Pe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map((o=>{const l=new U_(i._firestore,i._userDataWriter,o.doc.key,o.doc,new am(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}}))}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((o=>s||o.type!==3)).map((o=>{const l=new U_(i._firestore,i._userDataWriter,o.doc.key,o.doc,new am(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,h=-1;return o.type!==0&&(u=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),h=a.indexOf(o.doc.key)),{type:vee(o.type),doc:l,oldIndex:u,newIndex:h}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new at(Pe.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Zf._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=qI.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],i=[];return this.docs.forEach((s=>{s._document!==null&&(t.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function vee(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Et(61501,{type:n})}}function wee(n){n=Pa(n,Vr);const e=Pa(n.firestore,Iu);return tee(CA(e),n._key).then((t=>Iee(e,n,t)))}Zf._jsonSchemaVersion="firestore/querySnapshot/1.0",Zf._jsonSchema={type:Kr("string",Zf._jsonSchemaVersion),bundleSource:Kr("string","QuerySnapshot"),bundleName:Kr("string"),bundle:Kr("string")};class G8 extends xee{constructor(e){super(),this.firestore=e}convertBytes(e){return new va(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Vr(this.firestore,null,t)}}function Eee(n){n=Pa(n,z0);const e=Pa(n.firestore,Iu),t=CA(e),r=new G8(e);return mee(n._query),nee(t,n._query).then((i=>new Zf(e,r,n,i)))}function WN(n,e,t){n=Pa(n,Vr);const r=Pa(n.firestore,Iu),i=V8(n.converter,e,t);return Aw(r,[N8(Tw(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,Hi.none())])}function See(n,e,t,...r){n=Pa(n,Vr);const i=Pa(n.firestore,Iu),s=Tw(i);let a;return a=typeof(e=yi(e))=="string"||e instanceof Ew?hee(s,"updateDoc",n._key,e,t,r):uee(s,"updateDoc",n._key,e),Aw(i,[a.toMutation(n._key,Hi.exists(!0))])}function Tee(n){return Aw(Pa(n.firestore,Iu),[new gw(n._key,Hi.none())])}function bee(n,e){const t=Pa(n.firestore,Iu),r=qf(n),i=V8(n.converter,e);return Aw(t,[N8(Tw(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,Hi.exists(!1))]).then((()=>r))}function Aw(n,e){return(function(r,i){const s=new Uo;return r.asyncQueue.enqueueAndForget((async()=>zJ(await eee(r),i,s))),s.promise})(CA(n),e)}function Iee(n,e,t){const r=t.docs.get(e._key),i=new G8(n);return new Ph(n,i,e._key,r,new am(t.hasPendingWrites,t.fromCache),e.converter)}function HN(){return new PA("serverTimestamp")}(function(e,t=!0){(function(i){G0=i})(fd),$h(new cu("firestore",((r,{instanceIdentifier:i,options:s})=>{const a=r.getProvider("app").getImmediate(),o=new Iu(new $q(r.getProvider("auth-internal")),new Kq(a,r.getProvider("app-check-internal")),(function(u,h){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new at(Pe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Yh(u.options.projectId,h)})(a,i),a);return s={useFetchStreams:t,...s},o._setSettings(s),o}),"PUBLIC").setMultipleInstances(!0)),Go(SM,TM,e),Go(SM,TM,"esm2020")})();const B8="firebasestorage.googleapis.com",Aee="storageBucket",Ree=120*1e3,Cee=600*1e3;class il extends rl{constructor(e,t,r=0){super(pS(e),`Firebase Storage: ${t} (${pS(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,il.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return pS(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Qo;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Qo||(Qo={}));function pS(n){return"storage/"+n}function kee(){const n="An unknown error occurred, please check the error payload for server response.";return new il(Qo.UNKNOWN,n)}function Pee(){return new il(Qo.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Mee(){return new il(Qo.CANCELED,"User canceled the upload/download.")}function Nee(n){return new il(Qo.INVALID_URL,"Invalid URL '"+n+"'.")}function Lee(n){return new il(Qo.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function KN(n){return new il(Qo.INVALID_ARGUMENT,n)}function U8(){return new il(Qo.APP_DELETED,"The Firebase app was deleted.")}function Oee(n){return new il(Qo.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}class Ja{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=Ja.makeFromUrl(e,t)}catch{return new Ja(e,"")}if(r.path==="")return r;throw Lee(e)}static makeFromUrl(e,t){let r=null;const i="([A-Za-z0-9.\\-_]+)";function s(M){M.path.charAt(M.path.length-1)==="/"&&(M.path_=M.path_.slice(0,-1))}const a="(/(.*))?$",o=new RegExp("^gs://"+i+a,"i"),l={bucket:1,path:3};function u(M){M.path_=decodeURIComponent(M.path)}const h="v[A-Za-z0-9_]+",f=t.replace(/[.]/g,"\\."),g="(/([^?#]*).*)?$",y=new RegExp(`^https?://${f}/${h}/b/${i}/o${g}`,"i"),v={bucket:1,path:3},x=t===B8?"(?:storage.googleapis.com|storage.cloud.google.com)":t,E="([^?#]*)",T=new RegExp(`^https?://${x}/${i}/${E}`,"i"),I=[{regex:o,indices:l,postModify:s},{regex:y,indices:v,postModify:u},{regex:T,indices:{bucket:1,path:2},postModify:u}];for(let M=0;M<I.length;M++){const F=I[M],z=F.regex.exec(e);if(z){const P=z[F.indices.bucket];let C=z[F.indices.path];C||(C=""),r=new Ja(P,C),F.postModify(r);break}}if(r==null)throw Nee(e);return r}}class Dee{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function Fee(n,e,t){let r=1,i=null,s=null,a=!1,o=0;function l(){return o===2}let u=!1;function h(...E){u||(u=!0,e.apply(null,E))}function f(E){i=setTimeout(()=>{i=null,n(y,l())},E)}function g(){s&&clearTimeout(s)}function y(E,...T){if(u){g();return}if(E){g(),h.call(null,E,...T);return}if(l()||a){g(),h.call(null,E,...T);return}r<64&&(r*=2);let I;o===1?(o=2,I=0):I=(r+Math.random())*1e3,f(I)}let v=!1;function x(E){v||(v=!0,g(),!u&&(i!==null?(E||(o=2),clearTimeout(i),f(0)):E||(o=1)))}return f(0),s=setTimeout(()=>{a=!0,x(!0)},t),x}function jee(n){n(!1)}function Vee(n){return n!==void 0}function YN(n,e,t,r){if(r<e)throw KN(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw KN(`Invalid value for '${n}'. Expected ${t} or less.`)}function Gee(n){const e=encodeURIComponent;let t="?";for(const r in n)if(n.hasOwnProperty(r)){const i=e(r)+"="+e(n[r]);t=t+i+"&"}return t=t.slice(0,-1),t}var Wx;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(Wx||(Wx={}));function Bee(n,e){const t=n>=500&&n<600,i=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||i||s}class Uee{constructor(e,t,r,i,s,a,o,l,u,h,f,g=!0,y=!1){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=a,this.callback_=o,this.errorCallback_=l,this.timeout_=u,this.progressCallback_=h,this.connectionFactory_=f,this.retry=g,this.isUsingEmulator=y,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((v,x)=>{this.resolve_=v,this.reject_=x,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new i_(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const a=o=>{const l=o.loaded,u=o.lengthComputable?o.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,u)};this.progressCallback_!==null&&s.addUploadProgressListener(a),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(a),this.pendingConnection_=null;const o=s.getErrorCode()===Wx.NO_ERROR,l=s.getStatus();if(!o||Bee(l,this.additionalRetryCodes_)&&this.retry){const h=s.getErrorCode()===Wx.ABORT;r(!1,new i_(!1,null,h));return}const u=this.successCodes_.indexOf(l)!==-1;r(!0,new i_(u,s))})},t=(r,i)=>{const s=this.resolve_,a=this.reject_,o=i.connection;if(i.wasSuccessCode)try{const l=this.callback_(o,o.getResponse());Vee(l)?s(l):s()}catch(l){a(l)}else if(o!==null){const l=kee();l.serverResponse=o.getErrorText(),this.errorCallback_?a(this.errorCallback_(o,l)):a(l)}else if(i.canceled){const l=this.appDelete_?U8():Mee();a(l)}else{const l=Pee();a(l)}};this.canceled_?t(!1,new i_(!1,null,!0)):this.backoffId_=Fee(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&jee(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class i_{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}function zee(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function $ee(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function Wee(n,e){e&&(n["X-Firebase-GMPID"]=e)}function Hee(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function Kee(n,e,t,r,i,s,a=!0,o=!1){const l=Gee(n.urlParams),u=n.url+l,h=Object.assign({},n.headers);return Wee(h,e),zee(h,t),$ee(h,s),Hee(h,r),new Uee(u,n.method,h,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,a,o)}function Yee(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function Xee(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}class Hx{constructor(e,t){this._service=e,t instanceof Ja?this._location=t:this._location=Ja.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Hx(e,t)}get root(){const e=new Ja(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Xee(this._location.path)}get storage(){return this._service}get parent(){const e=Yee(this._location.path);if(e===null)return null;const t=new Ja(this._location.bucket,e);return new Hx(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw Oee(e)}}function XN(n,e){const t=e?.[Aee];return t==null?null:Ja.makeFromBucketSpec(t,n)}function qee(n,e,t,r={}){n.host=`${e}:${t}`;const i=dd(e);i&&(OI(`https://${n.host}/b`),DI("Storage",!0)),n._isUsingEmulator=!0,n._protocol=i?"https":"http";const{mockUserToken:s}=r;s&&(n._overrideAuthToken=typeof s=="string"?s:LD(s,n.app.options.projectId))}class Zee{constructor(e,t,r,i,s,a=!1){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._isUsingEmulator=a,this._bucket=null,this._host=B8,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=Ree,this._maxUploadRetryTime=Cee,this._requests=new Set,i!=null?this._bucket=Ja.makeFromBucketSpec(i,this._host):this._bucket=XN(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Ja.makeFromBucketSpec(this._url,e):this._bucket=XN(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){YN("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){YN("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(qs(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Hx(this,e)}_makeRequest(e,t,r,i,s=!0){if(this._deleted)return new Dee(U8());{const a=Kee(e,this._appId,r,i,t,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,t){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,i).getPromise()}}const qN="@firebase/storage",ZN="0.14.0";const z8="storage";function Qee(n=VI(),e){n=yi(n);const r=Qv(n,z8).getImmediate({identifier:e}),i=PD("storage");return i&&Jee(r,...i),r}function Jee(n,e,t,r={}){qee(n,e,t,r)}function ete(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new Zee(t,r,i,e,fd)}function tte(){$h(new cu(z8,ete,"PUBLIC").setMultipleInstances(!0)),Go(qN,ZN,""),Go(qN,ZN,"esm2020")}tte();const nte={apiKey:"AIzaSyBcLuKvUr5XqEJTwOf9I0hqJ1o9g3kOZ-g",authDomain:"detectorapp-nl.firebaseapp.com",projectId:"detectorapp-nl",storageBucket:"detectorapp-nl.firebasestorage.app",messagingSenderId:"110954177210",appId:"1:110954177210:web:d77c9ed262ad92bc431883"},FA=BD(nte),Qf=jq(FA),Xc=iee(FA);Qee(FA);see(Xc).catch(n=>{n.code==="failed-precondition"?console.warn("Offline persistence failed: Multiple tabs open"):n.code==="unimplemented"&&console.warn("Offline persistence not available in this browser")});const rte={};function ite(n,e){let t;try{t=n()}catch{return}return{getItem:i=>{var s;const a=l=>l===null?null:JSON.parse(l,void 0),o=(s=t.getItem(i))!=null?s:null;return o instanceof Promise?o.then(a):a(o)},setItem:(i,s)=>t.setItem(i,JSON.stringify(s,void 0)),removeItem:i=>t.removeItem(i)}}const vp=n=>e=>{try{const t=n(e);return t instanceof Promise?t:{then(r){return vp(r)(t)},catch(r){return this}}}catch(t){return{then(r){return this},catch(r){return vp(r)(t)}}}},ste=(n,e)=>(t,r,i)=>{let s={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:E=>E,version:0,merge:(E,T)=>({...T,...E}),...e},a=!1;const o=new Set,l=new Set;let u;try{u=s.getStorage()}catch{}if(!u)return n((...E)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...E)},r,i);const h=vp(s.serialize),f=()=>{const E=s.partialize({...r()});let T;const b=h({state:E,version:s.version}).then(I=>u.setItem(s.name,I)).catch(I=>{T=I});if(T)throw T;return b},g=i.setState;i.setState=(E,T)=>{g(E,T),f()};const y=n((...E)=>{t(...E),f()},r,i);let v;const x=()=>{var E;if(!u)return;a=!1,o.forEach(b=>b(r()));const T=((E=s.onRehydrateStorage)==null?void 0:E.call(s,r()))||void 0;return vp(u.getItem.bind(u))(s.name).then(b=>{if(b)return s.deserialize(b)}).then(b=>{if(b)if(typeof b.version=="number"&&b.version!==s.version){if(s.migrate)return s.migrate(b.state,b.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return b.state}).then(b=>{var I;return v=s.merge(b,(I=r())!=null?I:y),t(v,!0),f()}).then(()=>{T?.(v,void 0),a=!0,l.forEach(b=>b(v))}).catch(b=>{T?.(void 0,b)})};return i.persist={setOptions:E=>{s={...s,...E},E.getStorage&&(u=E.getStorage())},clearStorage:()=>{u?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>x(),hasHydrated:()=>a,onHydrate:E=>(o.add(E),()=>{o.delete(E)}),onFinishHydration:E=>(l.add(E),()=>{l.delete(E)})},x(),v||y},ate=(n,e)=>(t,r,i)=>{let s={storage:ite(()=>localStorage),partialize:x=>x,version:0,merge:(x,E)=>({...E,...x}),...e},a=!1;const o=new Set,l=new Set;let u=s.storage;if(!u)return n((...x)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...x)},r,i);const h=()=>{const x=s.partialize({...r()});return u.setItem(s.name,{state:x,version:s.version})},f=i.setState;i.setState=(x,E)=>{f(x,E),h()};const g=n((...x)=>{t(...x),h()},r,i);i.getInitialState=()=>g;let y;const v=()=>{var x,E;if(!u)return;a=!1,o.forEach(b=>{var I;return b((I=r())!=null?I:g)});const T=((E=s.onRehydrateStorage)==null?void 0:E.call(s,(x=r())!=null?x:g))||void 0;return vp(u.getItem.bind(u))(s.name).then(b=>{if(b)if(typeof b.version=="number"&&b.version!==s.version){if(s.migrate)return[!0,s.migrate(b.state,b.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,b.state];return[!1,void 0]}).then(b=>{var I;const[M,F]=b;if(y=s.merge(F,(I=r())!=null?I:g),t(y,!0),M)return h()}).then(()=>{T?.(y,void 0),y=r(),a=!0,l.forEach(b=>b(y))}).catch(b=>{T?.(void 0,b)})};return i.persist={setOptions:x=>{s={...s,...x},x.storage&&(u=x.storage)},clearStorage:()=>{u?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>v(),hasHydrated:()=>a,onHydrate:x=>(o.add(x),()=>{o.delete(x)}),onFinishHydration:x=>(l.add(x),()=>{l.delete(x)})},s.skipHydration||v(),y||g},ote=(n,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((rte?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),ste(n,e)):ate(n,e),pd=ote,Mr=sa()(pd(n=>({defaultBackground:"CartoDB (licht)",showScaleBar:!0,gpsAutoStart:!1,showAccuracyCircle:!0,hapticFeedback:!0,vondstenLocalOnly:!0,showVondstButton:!1,showRouteRecordButton:!1,showLocalVondsten:!0,showCustomPointLayers:!0,fontScale:100,layerPanelFontScale:100,presetPanelFontScale:100,menuFontScale:100,setDefaultBackground:e=>n({defaultBackground:e}),setShowScaleBar:e=>n({showScaleBar:e}),setGpsAutoStart:e=>n({gpsAutoStart:e}),setShowAccuracyCircle:e=>n({showAccuracyCircle:e}),setHapticFeedback:e=>n({hapticFeedback:e}),setVondstenLocalOnly:e=>n({vondstenLocalOnly:e}),setShowVondstButton:e=>n({showVondstButton:e}),setShowRouteRecordButton:e=>n({showRouteRecordButton:e}),setShowLocalVondsten:e=>n({showLocalVondsten:e}),setShowCustomPointLayers:e=>n({showCustomPointLayers:e}),setFontScale:e=>n({fontScale:e}),setLayerPanelFontScale:e=>n({layerPanelFontScale:e}),setPresetPanelFontScale:e=>n({presetPanelFontScale:e}),setMenuFontScale:e=>n({menuFontScale:e})}),{name:"detectorapp-settings",version:2,migrate:(n,e)=>e<2?{...n,showScaleBar:!0}:n})),Rw=sa()(j0((n,e)=>({user:null,loading:!1,error:null,initialized:!1,setUser:t=>{n(r=>{r.user=t,r.loading=!1})},setLoading:t=>{n(r=>{r.loading=t})},setError:t=>{n(r=>{r.error=t})},signInWithGoogle:async()=>{n(t=>{t.loading=!0,t.error=null});try{const t=new Sl;await KX(Qf,t)}catch(t){console.error("Google sign-in error:",t),n(r=>{r.error=t.message,r.loading=!1})}},logout:async()=>{n(t=>{t.loading=!0});try{await h6(Qf)}catch(t){console.error("Logout error:",t),n(r=>{r.error=t.message,r.loading=!1})}},initAuth:()=>{e().initialized||(n(t=>{t.initialized=!0}),u6(Qf,t=>{n(r=>{r.user=t,r.loading=!1}),t&&Mr.getState().setVondstenLocalOnly(!1)}))}})));sa()(j0((n,e)=>({vondsten:[],loading:!1,error:null,loadVondsten:async t=>{n(r=>{r.loading=!0});try{const r=yee(VN(Xc,"vondsten"),_ee("userId","==",t)),s=(await Eee(r)).docs.map(a=>({id:a.id,...a.data()}));n(a=>{a.vondsten=s,a.loading=!1})}catch(r){n(i=>{i.error=r.message,i.loading=!1})}},addVondst:async t=>{const r=new Date().toISOString(),i={...t,createdAt:r,updatedAt:r},s=await bee(VN(Xc,"vondsten"),i);return n(a=>{a.vondsten.push({...i,id:s.id})}),s.id},updateVondst:async(t,r)=>{const i=qf(Xc,"vondsten",t);await See(i,{...r,updatedAt:new Date().toISOString()}),n(s=>{const a=s.vondsten.findIndex(o=>o.id===t);a!==-1&&(s.vondsten[a]={...s.vondsten[a],...r})})},deleteVondst:async t=>{await Tee(qf(Xc,"vondsten",t)),n(r=>{r.vondsten=r.vondsten.filter(i=>i.id!==t)})}})));const yS=[{id:"detectie",name:"Detectie",icon:"Compass",layers:["AMK Monumenten","Gewaspercelen"],baseLayer:"CartoDB (licht)",isBuiltIn:!1},{id:"steentijd",name:"Steentijd",icon:"Mountain",layers:["Hunebedden","Grafheuvels","Terpen","FAMKE Steentijd","AMK Steentijd","AHN4 Multi-Hillshade NL","Labels Overlay"],baseLayer:"Luchtfoto",isBuiltIn:!1},{id:"romeins-midvroeg",name:"Romeins - Mid vroeg",icon:"Layers",layers:["Romeinse wegen (regio)","Romeinse Forten","Romeinse Forten Lijnen","AMK Romeins","AMK Vroege ME","Gewaspercelen","Kadastrale Grenzen"],isBuiltIn:!1},{id:"midlaat-nieuwetijd",name:"Mid laat - Nieuwe tijd",icon:"Grid",layers:["AMK Late ME","Kastelen","Essen","Rijksmonumenten","Gewaspercelen","Kadastrale Grenzen","Oude Kernen"],isBuiltIn:!1},{id:"woii-militair",name:"WOII & Militair",icon:"Target",layers:["WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Inundatiegebieden","Militaire Objecten"],isBuiltIn:!1},{id:"analyse",name:"Terrein Analyse",icon:"Search",layers:["IKAW","Geomorfologie","Bodemkaart","Archeo Landschappen","AHN4 Multi-Hillshade NL","AHN4 Hoogtekaart Kleur"],isBuiltIn:!1}],QN=["Labels Overlay","TMK 1850","Bonnebladen 1900","Hunebedden","FAMKE Steentijd","Grafheuvels","Terpen","AMK Monumenten","AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig","Romeinse wegen (regio)","Romeinse wegen (Wereld)","Romeinse Forten","Romeinse Forten Lijnen","Kastelen","IKAW","Archeo Landschappen","Rijksmonumenten","Werelderfgoed","Religieus Erfgoed","Essen","WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Inundatiegebieden","Militaire Objecten","Paleokaart 800 n.Chr.","Paleokaart 100 n.Chr.","Paleokaart 500 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 9000 v.Chr.","UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling","AHN4 Hoogtekaart Kleur","AHN4 Hillshade NL","AHN4 Multi-Hillshade NL","AHN 0.5m","Veengebieden","Geomorfologie","Bodemkaart","Fossielen Nederland","Fossielen Belgi","Fossielen Duitsland","Fossielen Frankrijk","Parken","Speeltuinen","Musea","Strandjes","Kringloopwinkels","Gewaspercelen","Kadastrale Grenzen","Scheepswrakken","Woonheuvels ZH","Windmolens","Erfgoedlijnen","Oude Kernen","Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken","Verdronken Dorpen"],$8=sa()(pd((n,e)=>({presets:[...yS],applyPreset:t=>{const r=e().presets.find(s=>s.id===t);if(!r)return;const i=fi.getState();QN.forEach(s=>i.setLayerVisibility(s,!1)),r.layers.forEach(s=>i.setLayerVisibility(s,!0)),r.baseLayer&&["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"].forEach(a=>{i.setLayerVisibility(a,a===r.baseLayer)}),console.log(` Preset toegepast: ${r.name}${r.baseLayer?` (${r.baseLayer})`:""}`)},createPreset:(t,r)=>{const i=fi.getState(),s=Object.entries(i.visible).filter(([o,l])=>l&&QN.includes(o)).map(([o])=>o),a={id:`custom-${Date.now()}`,name:t,icon:r,layers:s,isBuiltIn:!1};n(o=>({presets:[...o.presets,a]})),console.log(` Preset aangemaakt: ${t} met ${s.length} lagen`)},updatePreset:(t,r)=>{n(i=>({presets:i.presets.map(s=>s.id===t?{...s,...r}:s)}))},deletePreset:t=>{n(r=>({presets:r.presets.filter(i=>i.id!==t||i.isBuiltIn)}))},resetToDefaults:()=>{n({presets:[...yS]})}}),{name:"detectorapp-presets",version:9,migrate:(n,e)=>e<9?{presets:[...yS]}:n})),JN=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899"],_1=sa()(pd((n,e)=>({layers:[],addLayer:t=>{const r=crypto.randomUUID(),i=e().layers.length,s=JN[i%JN.length];return n(a=>({layers:[...a.layers,{...t,id:r,createdAt:new Date().toISOString(),color:t.color||s,visible:t.visible??!0,opacity:t.opacity??1}]})),r},removeLayer:t=>n(r=>({layers:r.layers.filter(i=>i.id!==t)})),updateLayer:(t,r)=>n(i=>({layers:i.layers.map(s=>s.id===t?{...s,...r}:s)})),toggleVisibility:t=>n(r=>({layers:r.layers.map(i=>i.id===t?{...i,visible:!i.visible}:i)})),setOpacity:(t,r)=>n(i=>({layers:i.layers.map(s=>s.id===t?{...s,opacity:r}:s)})),setColor:(t,r)=>n(i=>({layers:i.layers.map(s=>s.id===t?{...s,color:r}:s)})),clearAll:()=>n({layers:[]})}),{name:"detectorapp-custom-layers",version:1})),lte=["CartoDB (licht)","OpenStreetMap","Luchtfoto","Labels Overlay","Mijn Vondsten"],jA=sa()(pd((n,e)=>({tier:"free",unlockedRegions:["nl"],devMode:!0,setTier:t=>n({tier:t}),unlockRegion:t=>n(r=>({unlockedRegions:r.unlockedRegions.includes(t)?r.unlockedRegions:[...r.unlockedRegions,t]})),lockRegion:t=>n(r=>({unlockedRegions:r.unlockedRegions.filter(i=>i!==t)})),setDevMode:t=>n({devMode:t}),isRegionUnlocked:t=>{const r=e();return r.devMode||r.tier==="pro"?!0:r.unlockedRegions.includes(t)},isLayerUnlocked:(t,r="free",i=["nl"])=>{const s=e();return s.devMode||lte.includes(t)||r==="free"||s.tier==="pro"?!0:s.tier==="premium"?i.some(a=>s.unlockedRegions.includes(a)):!1},canAccessPremiumFeatures:()=>{const t=e();return t.devMode||t.tier!=="free"}}),{name:"detectorapp-subscription",version:1}));function cte({target:n,viewOptions:e}){const t=ne.useRef(null),r=ne.useRef(null),i=Ji(a=>a.setMap),s=Mr(a=>a.showScaleBar);return ne.useEffect(()=>{if(!t.current){const a={center:[5.1214,52.0907],zoom:8,rotation:0,minZoom:3,maxZoom:19,...e},o=new MH({target:n,controls:[],view:new Oo({center:oo(a.center),zoom:a.zoom,rotation:a.rotation,minZoom:a.minZoom,maxZoom:a.maxZoom})});t.current=o,i(o),window.__olMap=o}return()=>{t.current&&(t.current.setTarget(void 0),i(null),window.__olMap=null)}},[n,e,i]),ne.useEffect(()=>{const a=t.current;a&&(s?r.current||(r.current=new OH({units:"metric",bar:!1,text:!0,minWidth:80}),a.addControl(r.current)):r.current&&(a.removeControl(r.current),r.current=null))},[s]),t.current}const e3=["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"];function ute(){const n=ne.useRef(null),e=ne.useRef(!1);cte({target:"map"});const t=Ji(f=>f.map),r=fi(f=>f.registerLayer),i=fi(f=>f.setLayerVisibility),s=Mr(f=>f.defaultBackground);ne.useEffect(()=>{if(!t){console.warn(" Map not initialized yet");return}console.log(" Initializing map layers...");const f=new rh({properties:{title:"OpenStreetMap",type:"base"},visible:!1,source:new ZW}),g=new rh({properties:{title:"CartoDB (licht)",type:"base"},visible:!0,source:new Ef({url:"https://{a-d}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO"})}),y=new rh({properties:{title:"Luchtfoto",type:"base"},visible:!1,source:new Ef({url:"https://service.pdok.nl/hwh/luchtfotorgb/wmts/v1_0/Actueel_orthoHR/EPSG:3857/{z}/{x}/{y}.jpeg",attributions:" Kadaster / PDOK Luchtfoto",maxZoom:19})}),v=new rh({properties:{title:"Labels Overlay",type:"overlay"},visible:!1,source:new Ef({url:"https://{a-d}.basemaps.cartocdn.com/rastertiles/voyager_only_labels/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO",maxZoom:20}),zIndex:100}),x=new rh({properties:{title:"TMK 1850",type:"base"},visible:!1,source:new Ef({url:"https://s.map5.nl/map/gast/tiles/tmk_1850/EPSG3857/{z}/{x}/{y}.png",attributions:" Kadaster / Map5.nl",crossOrigin:"anonymous",maxZoom:14})}),E=new rh({properties:{title:"Bonnebladen 1900",type:"base"},visible:!1,source:new Ef({url:"https://s.map5.nl/map/gast/tiles/bonne_1900/EPSG3857/{z}/{x}/{y}.png",attributions:" Kadaster / Map5.nl",crossOrigin:"anonymous",maxZoom:14})});t.addLayer(f),t.addLayer(g),t.addLayer(y),t.addLayer(v),t.addLayer(x),t.addLayer(E),console.log(" Base layers added:",{osm:f.getVisible(),cartodb:g.getVisible(),satellite:y.getVisible()}),r("OpenStreetMap",f),r("CartoDB (licht)",g),r("Luchtfoto",y),r("Labels Overlay",v),r("TMK 1850",x),r("Bonnebladen 1900",E),t.updateSize(),console.log(" Map size:",t.getSize()),console.log(" Map center:",t.getView().getCenter()),console.log(" Map zoom:",t.getView().getZoom()),a()},[t,r]);async function a(){if(!t){console.error(" Cannot load layers: map is null");return}const f=lK();console.log(` Loading ${f.length} immediate-load layers (WMS/Tile)...`);const g=await Promise.allSettled(f.map(async v=>{try{const x=await v.factory();return x?{name:v.name,layer:x}:null}catch(x){return console.warn(` Failed to create ${v.name}:`,x),null}}));let y=0;g.forEach(v=>{if(v.status==="fulfilled"&&v.value){const{name:x,layer:E}=v.value;t.addLayer(E),r(x,E),y++,console.log(`   ${x}`)}}),console.log(` Immediate layers loaded: ${y}/${f.length}`),console.log(` Total layers on map: ${t.getLayers().getLength()}`),console.log(" Vector layers will load on first toggle (lazy loading enabled)")}ne.useEffect(()=>{if(!t||e.current)return;const f=setTimeout(()=>{const g=s||"CartoDB (licht)";e3.forEach(y=>{i(y,!1)}),e3.includes(g)?i(g,!0):i("CartoDB (licht)",!0),e.current=!0,console.log(` Default background: ${g}`)},100);return()=>clearTimeout(f)},[t,s,i]);const o=Mr(f=>f.gpsAutoStart),l=ss(f=>f.startTracking),u=ne.useRef(!1);ne.useEffect(()=>{if(!(!t||u.current)&&o){const f=setTimeout(()=>{l(),u.current=!0,console.log(" GPS autostart enabled - tracking started")},500);return()=>clearTimeout(f)}},[t,o,l]);const h={width:"100%",height:"100vh"};return m.jsx("div",{id:"map",ref:n,style:h})}const VA=ne.createContext({});function GA(n){const e=ne.useRef(null);return e.current===null&&(e.current=n()),e.current}const Cw=ne.createContext(null),BA=ne.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});class hte extends ne.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=t.offsetHeight||0,r.width=t.offsetWidth||0,r.top=t.offsetTop,r.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function dte({children:n,isPresent:e}){const t=ne.useId(),r=ne.useRef(null),i=ne.useRef({width:0,height:0,top:0,left:0}),{nonce:s}=ne.useContext(BA);return ne.useInsertionEffect(()=>{const{width:a,height:o,top:l,left:u}=i.current;if(e||!r.current||!a||!o)return;r.current.dataset.motionPopId=t;const h=document.createElement("style");return s&&(h.nonce=s),document.head.appendChild(h),h.sheet&&h.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${a}px !important;
            height: ${o}px !important;
            top: ${l}px !important;
            left: ${u}px !important;
          }
        `),()=>{document.head.removeChild(h)}},[e]),m.jsx(hte,{isPresent:e,childRef:r,sizeRef:i,children:ne.cloneElement(n,{ref:r})})}const fte=({children:n,initial:e,isPresent:t,onExitComplete:r,custom:i,presenceAffectsLayout:s,mode:a})=>{const o=GA(gte),l=ne.useId(),u=ne.useCallback(f=>{o.set(f,!0);for(const g of o.values())if(!g)return;r&&r()},[o,r]),h=ne.useMemo(()=>({id:l,initial:e,isPresent:t,custom:i,onExitComplete:u,register:f=>(o.set(f,!1),()=>o.delete(f))}),s?[Math.random(),u]:[t,u]);return ne.useMemo(()=>{o.forEach((f,g)=>o.set(g,!1))},[t]),ne.useEffect(()=>{!t&&!o.size&&r&&r()},[t]),a==="popLayout"&&(n=m.jsx(dte,{isPresent:t,children:n})),m.jsx(Cw.Provider,{value:h,children:n})};function gte(){return new Map}function W8(n=!0){const e=ne.useContext(Cw);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:r,register:i}=e,s=ne.useId();ne.useEffect(()=>{n&&i(s)},[n]);const a=ne.useCallback(()=>n&&r&&r(s),[s,r,n]);return!t&&r?[!1,a]:[!0]}const s_=n=>n.key||"";function t3(n){const e=[];return ne.Children.forEach(n,t=>{ne.isValidElement(t)&&e.push(t)}),e}const UA=typeof window<"u",H8=UA?ne.useLayoutEffect:ne.useEffect,mr=({children:n,custom:e,initial:t=!0,onExitComplete:r,presenceAffectsLayout:i=!0,mode:s="sync",propagate:a=!1})=>{const[o,l]=W8(a),u=ne.useMemo(()=>t3(n),[n]),h=a&&!o?[]:u.map(s_),f=ne.useRef(!0),g=ne.useRef(u),y=GA(()=>new Map),[v,x]=ne.useState(u),[E,T]=ne.useState(u);H8(()=>{f.current=!1,g.current=u;for(let M=0;M<E.length;M++){const F=s_(E[M]);h.includes(F)?y.delete(F):y.get(F)!==!0&&y.set(F,!1)}},[E,h.length,h.join("-")]);const b=[];if(u!==v){let M=[...u];for(let F=0;F<E.length;F++){const z=E[F],P=s_(z);h.includes(P)||(M.splice(F,0,z),b.push(z))}s==="wait"&&b.length&&(M=b),T(t3(M)),x(u);return}const{forceRender:I}=ne.useContext(VA);return m.jsx(m.Fragment,{children:E.map(M=>{const F=s_(M),z=a&&!o?!1:u===E||h.includes(F),P=()=>{if(y.has(F))y.set(F,!0);else return;let C=!0;y.forEach(k=>{k||(C=!1)}),C&&(I?.(),T(g.current),a&&l?.(),r&&r())};return m.jsx(fte,{isPresent:z,initial:!f.current||t?void 0:!1,custom:z?void 0:e,presenceAffectsLayout:i,mode:s,onExitComplete:z?void 0:P,children:M},F)})})},Js=n=>n;let K8=Js;function zA(n){let e;return()=>(e===void 0&&(e=n()),e)}const R0=(n,e,t)=>{const r=e-n;return r===0?1:(t-n)/r},Ll=n=>n*1e3,Ol=n=>n/1e3,mte={useManualTiming:!1};function pte(n){let e=new Set,t=new Set,r=!1,i=!1;const s=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1};function o(u){s.has(u)&&(l.schedule(u),n()),u(a)}const l={schedule:(u,h=!1,f=!1)=>{const y=f&&r?e:t;return h&&s.add(u),y.has(u)||y.add(u),u},cancel:u=>{t.delete(u),s.delete(u)},process:u=>{if(a=u,r){i=!0;return}r=!0,[e,t]=[t,e],e.forEach(o),e.clear(),r=!1,i&&(i=!1,l.process(u))}};return l}const a_=["read","resolveKeyframes","update","preRender","render","postRender"],yte=40;function Y8(n,e){let t=!1,r=!0;const i={delta:0,timestamp:0,isProcessing:!1},s=()=>t=!0,a=a_.reduce((T,b)=>(T[b]=pte(s),T),{}),{read:o,resolveKeyframes:l,update:u,preRender:h,render:f,postRender:g}=a,y=()=>{const T=performance.now();t=!1,i.delta=r?1e3/60:Math.max(Math.min(T-i.timestamp,yte),1),i.timestamp=T,i.isProcessing=!0,o.process(i),l.process(i),u.process(i),h.process(i),f.process(i),g.process(i),i.isProcessing=!1,t&&e&&(r=!1,n(y))},v=()=>{t=!0,r=!0,i.isProcessing||n(y)};return{schedule:a_.reduce((T,b)=>{const I=a[b];return T[b]=(M,F=!1,z=!1)=>(t||v(),I.schedule(M,F,z)),T},{}),cancel:T=>{for(let b=0;b<a_.length;b++)a[a_[b]].cancel(T)},state:i,steps:a}}const{schedule:lr,cancel:mu,state:Ti,steps:_S}=Y8(typeof requestAnimationFrame<"u"?requestAnimationFrame:Js,!0),X8=ne.createContext({strict:!1}),n3={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},C0={};for(const n in n3)C0[n]={isEnabled:e=>n3[n].some(t=>!!e[t])};function _te(n){for(const e in n)C0[e]={...C0[e],...n[e]}}const xte=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Kx(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||xte.has(n)}let q8=n=>!Kx(n);function vte(n){n&&(q8=e=>e.startsWith("on")?!Kx(e):n(e))}try{vte(require("@emotion/is-prop-valid").default)}catch{}function wte(n,e,t){const r={};for(const i in n)i==="values"&&typeof n.values=="object"||(q8(i)||t===!0&&Kx(i)||!e&&!Kx(i)||n.draggable&&i.startsWith("onDrag"))&&(r[i]=n[i]);return r}function Ete(n){if(typeof Proxy>"u")return n;const e=new Map,t=(...r)=>n(...r);return new Proxy(t,{get:(r,i)=>i==="create"?n:(e.has(i)||e.set(i,n(i)),e.get(i))})}const kw=ne.createContext({});function wp(n){return typeof n=="string"||Array.isArray(n)}function Pw(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}const $A=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],WA=["initial",...$A];function Mw(n){return Pw(n.animate)||WA.some(e=>wp(n[e]))}function Z8(n){return!!(Mw(n)||n.variants)}function Ste(n,e){if(Mw(n)){const{initial:t,animate:r}=n;return{initial:t===!1||wp(t)?t:void 0,animate:wp(r)?r:void 0}}return n.inherit!==!1?e:{}}function Tte(n){const{initial:e,animate:t}=Ste(n,ne.useContext(kw));return ne.useMemo(()=>({initial:e,animate:t}),[r3(e),r3(t)])}function r3(n){return Array.isArray(n)?n.join(" "):n}const bte=Symbol.for("motionComponentSymbol");function Nf(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function Ite(n,e,t){return ne.useCallback(r=>{r&&n.onMount&&n.onMount(r),e&&(r?e.mount(r):e.unmount()),t&&(typeof t=="function"?t(r):Nf(t)&&(t.current=r))},[e])}const HA=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),Ate="framerAppearId",Q8="data-"+HA(Ate),{schedule:KA}=Y8(queueMicrotask,!1),J8=ne.createContext({});function Rte(n,e,t,r,i){var s,a;const{visualElement:o}=ne.useContext(kw),l=ne.useContext(X8),u=ne.useContext(Cw),h=ne.useContext(BA).reducedMotion,f=ne.useRef(null);r=r||l.renderer,!f.current&&r&&(f.current=r(n,{visualState:e,parent:o,props:t,presenceContext:u,blockInitialAnimation:u?u.initial===!1:!1,reducedMotionConfig:h}));const g=f.current,y=ne.useContext(J8);g&&!g.projection&&i&&(g.type==="html"||g.type==="svg")&&Cte(f.current,t,i,y);const v=ne.useRef(!1);ne.useInsertionEffect(()=>{g&&v.current&&g.update(t,u)});const x=t[Q8],E=ne.useRef(!!x&&!(!((s=window.MotionHandoffIsComplete)===null||s===void 0)&&s.call(window,x))&&((a=window.MotionHasOptimisedAnimation)===null||a===void 0?void 0:a.call(window,x)));return H8(()=>{g&&(v.current=!0,window.MotionIsMounted=!0,g.updateFeatures(),KA.render(g.render),E.current&&g.animationState&&g.animationState.animateChanges())}),ne.useEffect(()=>{g&&(!E.current&&g.animationState&&g.animationState.animateChanges(),E.current&&(queueMicrotask(()=>{var T;(T=window.MotionHandoffMarkAsComplete)===null||T===void 0||T.call(window,x)}),E.current=!1))}),g}function Cte(n,e,t,r){const{layoutId:i,layout:s,drag:a,dragConstraints:o,layoutScroll:l,layoutRoot:u}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:ej(n.parent)),n.projection.setOptions({layoutId:i,layout:s,alwaysMeasureLayout:!!a||o&&Nf(o),visualElement:n,animationType:typeof s=="string"?s:"both",initialPromotionConfig:r,layoutScroll:l,layoutRoot:u})}function ej(n){if(n)return n.options.allowProjection!==!1?n.projection:ej(n.parent)}function kte({preloadedFeatures:n,createVisualElement:e,useRender:t,useVisualState:r,Component:i}){var s,a;n&&_te(n);function o(u,h){let f;const g={...ne.useContext(BA),...u,layoutId:Pte(u)},{isStatic:y}=g,v=Tte(u),x=r(u,y);if(!y&&UA){Mte();const E=Nte(g);f=E.MeasureLayout,v.visualElement=Rte(i,x,g,e,E.ProjectionNode)}return m.jsxs(kw.Provider,{value:v,children:[f&&v.visualElement?m.jsx(f,{visualElement:v.visualElement,...g}):null,t(i,u,Ite(x,v.visualElement,h),x,y,v.visualElement)]})}o.displayName=`motion.${typeof i=="string"?i:`create(${(a=(s=i.displayName)!==null&&s!==void 0?s:i.name)!==null&&a!==void 0?a:""})`}`;const l=ne.forwardRef(o);return l[bte]=i,l}function Pte({layoutId:n}){const e=ne.useContext(VA).id;return e&&n!==void 0?e+"-"+n:n}function Mte(n,e){ne.useContext(X8).strict}function Nte(n){const{drag:e,layout:t}=C0;if(!e&&!t)return{};const r={...e,...t};return{MeasureLayout:e?.isEnabled(n)||t?.isEnabled(n)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}const Lte=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function YA(n){return typeof n!="string"||n.includes("-")?!1:!!(Lte.indexOf(n)>-1||/[A-Z]/u.test(n))}function i3(n){const e=[{},{}];return n?.values.forEach((t,r)=>{e[0][r]=t.get(),e[1][r]=t.getVelocity()}),e}function XA(n,e,t,r){if(typeof e=="function"){const[i,s]=i3(r);e=e(t!==void 0?t:n.custom,i,s)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[i,s]=i3(r);e=e(t!==void 0?t:n.custom,i,s)}return e}const sb=n=>Array.isArray(n),Ote=n=>!!(n&&typeof n=="object"&&n.mix&&n.toValue),Dte=n=>sb(n)?n[n.length-1]||0:n,Ki=n=>!!(n&&n.getVelocity);function z_(n){const e=Ki(n)?n.get():n;return Ote(e)?e.toValue():e}function Fte({scrapeMotionValuesFromProps:n,createRenderState:e,onUpdate:t},r,i,s){const a={latestValues:jte(r,i,s,n),renderState:e()};return t&&(a.onMount=o=>t({props:r,current:o,...a}),a.onUpdate=o=>t(o)),a}const tj=n=>(e,t)=>{const r=ne.useContext(kw),i=ne.useContext(Cw),s=()=>Fte(n,e,r,i);return t?s():GA(s)};function jte(n,e,t,r){const i={},s=r(n,{});for(const g in s)i[g]=z_(s[g]);let{initial:a,animate:o}=n;const l=Mw(n),u=Z8(n);e&&u&&!l&&n.inherit!==!1&&(a===void 0&&(a=e.initial),o===void 0&&(o=e.animate));let h=t?t.initial===!1:!1;h=h||a===!1;const f=h?o:a;if(f&&typeof f!="boolean"&&!Pw(f)){const g=Array.isArray(f)?f:[f];for(let y=0;y<g.length;y++){const v=XA(n,g[y]);if(v){const{transitionEnd:x,transition:E,...T}=v;for(const b in T){let I=T[b];if(Array.isArray(I)){const M=h?I.length-1:0;I=I[M]}I!==null&&(i[b]=I)}for(const b in x)i[b]=x[b]}}}return i}const $0=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],yd=new Set($0),nj=n=>e=>typeof e=="string"&&e.startsWith(n),rj=nj("--"),Vte=nj("var(--"),qA=n=>Vte(n)?Gte.test(n.split("/*")[0].trim()):!1,Gte=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,ij=(n,e)=>e&&typeof n=="number"?e.transform(n):n,$l=(n,e,t)=>t>e?e:t<n?n:t,W0={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},Ep={...W0,transform:n=>$l(0,1,n)},o_={...W0,default:1},x1=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),Oc=x1("deg"),Wo=x1("%"),Ft=x1("px"),Bte=x1("vh"),Ute=x1("vw"),s3={...Wo,parse:n=>Wo.parse(n)/100,transform:n=>Wo.transform(n*100)},zte={borderWidth:Ft,borderTopWidth:Ft,borderRightWidth:Ft,borderBottomWidth:Ft,borderLeftWidth:Ft,borderRadius:Ft,radius:Ft,borderTopLeftRadius:Ft,borderTopRightRadius:Ft,borderBottomRightRadius:Ft,borderBottomLeftRadius:Ft,width:Ft,maxWidth:Ft,height:Ft,maxHeight:Ft,top:Ft,right:Ft,bottom:Ft,left:Ft,padding:Ft,paddingTop:Ft,paddingRight:Ft,paddingBottom:Ft,paddingLeft:Ft,margin:Ft,marginTop:Ft,marginRight:Ft,marginBottom:Ft,marginLeft:Ft,backgroundPositionX:Ft,backgroundPositionY:Ft},$te={rotate:Oc,rotateX:Oc,rotateY:Oc,rotateZ:Oc,scale:o_,scaleX:o_,scaleY:o_,scaleZ:o_,skew:Oc,skewX:Oc,skewY:Oc,distance:Ft,translateX:Ft,translateY:Ft,translateZ:Ft,x:Ft,y:Ft,z:Ft,perspective:Ft,transformPerspective:Ft,opacity:Ep,originX:s3,originY:s3,originZ:Ft},a3={...W0,transform:Math.round},ZA={...zte,...$te,zIndex:a3,size:Ft,fillOpacity:Ep,strokeOpacity:Ep,numOctaves:a3},Wte={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},Hte=$0.length;function Kte(n,e,t){let r="",i=!0;for(let s=0;s<Hte;s++){const a=$0[s],o=n[a];if(o===void 0)continue;let l=!0;if(typeof o=="number"?l=o===(a.startsWith("scale")?1:0):l=parseFloat(o)===0,!l||t){const u=ij(o,ZA[a]);if(!l){i=!1;const h=Wte[a]||a;r+=`${h}(${u}) `}t&&(e[a]=u)}}return r=r.trim(),t?r=t(e,i?"":r):i&&(r="none"),r}function QA(n,e,t){const{style:r,vars:i,transformOrigin:s}=n;let a=!1,o=!1;for(const l in e){const u=e[l];if(yd.has(l)){a=!0;continue}else if(rj(l)){i[l]=u;continue}else{const h=ij(u,ZA[l]);l.startsWith("origin")?(o=!0,s[l]=h):r[l]=h}}if(e.transform||(a||t?r.transform=Kte(e,n.transform,t):r.transform&&(r.transform="none")),o){const{originX:l="50%",originY:u="50%",originZ:h=0}=s;r.transformOrigin=`${l} ${u} ${h}`}}const Yte={offset:"stroke-dashoffset",array:"stroke-dasharray"},Xte={offset:"strokeDashoffset",array:"strokeDasharray"};function qte(n,e,t=1,r=0,i=!0){n.pathLength=1;const s=i?Yte:Xte;n[s.offset]=Ft.transform(-r);const a=Ft.transform(e),o=Ft.transform(t);n[s.array]=`${a} ${o}`}function o3(n,e,t){return typeof n=="string"?n:Ft.transform(e+t*n)}function Zte(n,e,t){const r=o3(e,n.x,n.width),i=o3(t,n.y,n.height);return`${r} ${i}`}function JA(n,{attrX:e,attrY:t,attrScale:r,originX:i,originY:s,pathLength:a,pathSpacing:o=1,pathOffset:l=0,...u},h,f){if(QA(n,u,f),h){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:g,style:y,dimensions:v}=n;g.transform&&(v&&(y.transform=g.transform),delete g.transform),v&&(i!==void 0||s!==void 0||y.transform)&&(y.transformOrigin=Zte(v,i!==void 0?i:.5,s!==void 0?s:.5)),e!==void 0&&(g.x=e),t!==void 0&&(g.y=t),r!==void 0&&(g.scale=r),a!==void 0&&qte(g,a,o,l,!1)}const eR=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),sj=()=>({...eR(),attrs:{}}),tR=n=>typeof n=="string"&&n.toLowerCase()==="svg";function aj(n,{style:e,vars:t},r,i){Object.assign(n.style,e,i&&i.getProjectionStyles(r));for(const s in t)n.style.setProperty(s,t[s])}const oj=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function lj(n,e,t,r){aj(n,e,void 0,r);for(const i in e.attrs)n.setAttribute(oj.has(i)?i:HA(i),e.attrs[i])}const Yx={};function Qte(n){Object.assign(Yx,n)}function cj(n,{layout:e,layoutId:t}){return yd.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!Yx[n]||n==="opacity")}function nR(n,e,t){var r;const{style:i}=n,s={};for(const a in i)(Ki(i[a])||e.style&&Ki(e.style[a])||cj(a,n)||((r=t?.getValue(a))===null||r===void 0?void 0:r.liveStyle)!==void 0)&&(s[a]=i[a]);return s}function uj(n,e,t){const r=nR(n,e,t);for(const i in n)if(Ki(n[i])||Ki(e[i])){const s=$0.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;r[s]=n[i]}return r}function Jte(n,e){try{e.dimensions=typeof n.getBBox=="function"?n.getBBox():n.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const l3=["x","y","width","height","cx","cy","r"],ene={useVisualState:tj({scrapeMotionValuesFromProps:uj,createRenderState:sj,onUpdate:({props:n,prevProps:e,current:t,renderState:r,latestValues:i})=>{if(!t)return;let s=!!n.drag;if(!s){for(const o in i)if(yd.has(o)){s=!0;break}}if(!s)return;let a=!e;if(e)for(let o=0;o<l3.length;o++){const l=l3[o];n[l]!==e[l]&&(a=!0)}a&&lr.read(()=>{Jte(t,r),lr.render(()=>{JA(r,i,tR(t.tagName),n.transformTemplate),lj(t,r)})})}})},tne={useVisualState:tj({scrapeMotionValuesFromProps:nR,createRenderState:eR})};function hj(n,e,t){for(const r in e)!Ki(e[r])&&!cj(r,t)&&(n[r]=e[r])}function nne({transformTemplate:n},e){return ne.useMemo(()=>{const t=eR();return QA(t,e,n),Object.assign({},t.vars,t.style)},[e])}function rne(n,e){const t=n.style||{},r={};return hj(r,t,n),Object.assign(r,nne(n,e)),r}function ine(n,e){const t={},r=rne(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=r,t}function sne(n,e,t,r){const i=ne.useMemo(()=>{const s=sj();return JA(s,e,tR(r),n.transformTemplate),{...s.attrs,style:{...s.style}}},[e]);if(n.style){const s={};hj(s,n.style,n),i.style={...s,...i.style}}return i}function ane(n=!1){return(t,r,i,{latestValues:s},a)=>{const l=(YA(t)?sne:ine)(r,s,a,t),u=wte(r,typeof t=="string",n),h=t!==ne.Fragment?{...u,...l,ref:i}:{},{children:f}=r,g=ne.useMemo(()=>Ki(f)?f.get():f,[f]);return ne.createElement(t,{...h,children:g})}}function one(n,e){return function(r,{forwardMotionProps:i}={forwardMotionProps:!1}){const a={...YA(r)?ene:tne,preloadedFeatures:n,useRender:ane(i),createVisualElement:e,Component:r};return kte(a)}}function dj(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let r=0;r<t;r++)if(e[r]!==n[r])return!1;return!0}function Nw(n,e,t){const r=n.getProps();return XA(r,e,t!==void 0?t:r.custom,n)}const lne=zA(()=>window.ScrollTimeline!==void 0);class cne{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,t){for(let r=0;r<this.animations.length;r++)this.animations[r][e]=t}attachTimeline(e,t){const r=this.animations.map(i=>{if(lne()&&i.attachTimeline)return i.attachTimeline(e);if(typeof t=="function")return t(i)});return()=>{r.forEach((i,s)=>{i&&i(),this.animations[s].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let t=0;t<this.animations.length;t++)e=Math.max(e,this.animations[t].duration);return e}runAll(e){this.animations.forEach(t=>t[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class une extends cne{then(e,t){return Promise.all(this.animations).then(e).catch(t)}}function rR(n,e){return n?n[e]||n.default||n:void 0}const ab=2e4;function fj(n){let e=0;const t=50;let r=n.next(e);for(;!r.done&&e<ab;)e+=t,r=n.next(e);return e>=ab?1/0:e}function iR(n){return typeof n=="function"}function c3(n,e){n.timeline=e,n.onfinish=null}const sR=n=>Array.isArray(n)&&typeof n[0]=="number",hne={linearEasing:void 0};function dne(n,e){const t=zA(n);return()=>{var r;return(r=hne[e])!==null&&r!==void 0?r:t()}}const Xx=dne(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),gj=(n,e,t=10)=>{let r="";const i=Math.max(Math.round(e/t),2);for(let s=0;s<i;s++)r+=n(R0(0,i-1,s))+", ";return`linear(${r.substring(0,r.length-2)})`};function mj(n){return!!(typeof n=="function"&&Xx()||!n||typeof n=="string"&&(n in ob||Xx())||sR(n)||Array.isArray(n)&&n.every(mj))}const om=([n,e,t,r])=>`cubic-bezier(${n}, ${e}, ${t}, ${r})`,ob={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:om([0,.65,.55,1]),circOut:om([.55,0,1,.45]),backIn:om([.31,.01,.66,-.59]),backOut:om([.33,1.53,.69,.99])};function pj(n,e){if(n)return typeof n=="function"&&Xx()?gj(n,e):sR(n)?om(n):Array.isArray(n)?n.map(t=>pj(t,e)||ob.easeOut):ob[n]}const $a={x:!1,y:!1};function yj(){return $a.x||$a.y}function fne(n,e,t){var r;if(n instanceof Element)return[n];if(typeof n=="string"){let i=document;const s=(r=void 0)!==null&&r!==void 0?r:i.querySelectorAll(n);return s?Array.from(s):[]}return Array.from(n)}function _j(n,e){const t=fne(n),r=new AbortController,i={passive:!0,...e,signal:r.signal};return[t,i,()=>r.abort()]}function u3(n){return e=>{e.pointerType==="touch"||yj()||n(e)}}function gne(n,e,t={}){const[r,i,s]=_j(n,t),a=u3(o=>{const{target:l}=o,u=e(o);if(typeof u!="function"||!l)return;const h=u3(f=>{u(f),l.removeEventListener("pointerleave",h)});l.addEventListener("pointerleave",h,i)});return r.forEach(o=>{o.addEventListener("pointerenter",a,i)}),s}const xj=(n,e)=>e?n===e?!0:xj(n,e.parentElement):!1,aR=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,mne=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function pne(n){return mne.has(n.tagName)||n.tabIndex!==-1}const lm=new WeakSet;function h3(n){return e=>{e.key==="Enter"&&n(e)}}function xS(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const yne=(n,e)=>{const t=n.currentTarget;if(!t)return;const r=h3(()=>{if(lm.has(t))return;xS(t,"down");const i=h3(()=>{xS(t,"up")}),s=()=>xS(t,"cancel");t.addEventListener("keyup",i,e),t.addEventListener("blur",s,e)});t.addEventListener("keydown",r,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",r),e)};function d3(n){return aR(n)&&!yj()}function _ne(n,e,t={}){const[r,i,s]=_j(n,t),a=o=>{const l=o.currentTarget;if(!d3(o)||lm.has(l))return;lm.add(l);const u=e(o),h=(y,v)=>{window.removeEventListener("pointerup",f),window.removeEventListener("pointercancel",g),!(!d3(y)||!lm.has(l))&&(lm.delete(l),typeof u=="function"&&u(y,{success:v}))},f=y=>{h(y,t.useGlobalTarget||xj(l,y.target))},g=y=>{h(y,!1)};window.addEventListener("pointerup",f,i),window.addEventListener("pointercancel",g,i)};return r.forEach(o=>{!pne(o)&&o.getAttribute("tabindex")===null&&(o.tabIndex=0),(t.useGlobalTarget?window:o).addEventListener("pointerdown",a,i),o.addEventListener("focus",u=>yne(u,i),i)}),s}function xne(n){return n==="x"||n==="y"?$a[n]?null:($a[n]=!0,()=>{$a[n]=!1}):$a.x||$a.y?null:($a.x=$a.y=!0,()=>{$a.x=$a.y=!1})}const vj=new Set(["width","height","top","left","right","bottom",...$0]);let $_;function vne(){$_=void 0}const Ho={now:()=>($_===void 0&&Ho.set(Ti.isProcessing||mte.useManualTiming?Ti.timestamp:performance.now()),$_),set:n=>{$_=n,queueMicrotask(vne)}};function oR(n,e){n.indexOf(e)===-1&&n.push(e)}function lR(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}class cR{constructor(){this.subscriptions=[]}add(e){return oR(this.subscriptions,e),()=>lR(this.subscriptions,e)}notify(e,t,r){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,t,r);else for(let s=0;s<i;s++){const a=this.subscriptions[s];a&&a(e,t,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function wj(n,e){return e?n*(1e3/e):0}const f3=30,wne=n=>!isNaN(parseFloat(n));class Ene{constructor(e,t={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(r,i=!0)=>{const s=Ho.now();this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),i&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=Ho.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=wne(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new cR);const r=this.events[e].add(t);return e==="change"?()=>{r(),lr.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e,t=!0){!t||!this.passiveEffect?this.updateAndNotify(e,t):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,t,r){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=Ho.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>f3)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,f3);return wj(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Sp(n,e){return new Ene(n,e)}function Sne(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,Sp(t))}function Tne(n,e){const t=Nw(n,e);let{transitionEnd:r={},transition:i={},...s}=t||{};s={...s,...r};for(const a in s){const o=Dte(s[a]);Sne(n,a,o)}}function bne(n){return!!(Ki(n)&&n.add)}function lb(n,e){const t=n.getValue("willChange");if(bne(t))return t.add(e)}function Ej(n){return n.props[Q8]}const Sj=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,Ine=1e-7,Ane=12;function Rne(n,e,t,r,i){let s,a,o=0;do a=e+(t-e)/2,s=Sj(a,r,i)-n,s>0?t=a:e=a;while(Math.abs(s)>Ine&&++o<Ane);return a}function v1(n,e,t,r){if(n===e&&t===r)return Js;const i=s=>Rne(s,0,1,n,t);return s=>s===0||s===1?s:Sj(i(s),e,r)}const Tj=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,bj=n=>e=>1-n(1-e),Ij=v1(.33,1.53,.69,.99),uR=bj(Ij),Aj=Tj(uR),Rj=n=>(n*=2)<1?.5*uR(n):.5*(2-Math.pow(2,-10*(n-1))),hR=n=>1-Math.sin(Math.acos(n)),Cj=bj(hR),kj=Tj(hR),Pj=n=>/^0[^.\s]+$/u.test(n);function Cne(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||Pj(n):!0}const Im=n=>Math.round(n*1e5)/1e5,dR=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function kne(n){return n==null}const Pne=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,fR=(n,e)=>t=>!!(typeof t=="string"&&Pne.test(t)&&t.startsWith(n)||e&&!kne(t)&&Object.prototype.hasOwnProperty.call(t,e)),Mj=(n,e,t)=>r=>{if(typeof r!="string")return r;const[i,s,a,o]=r.match(dR);return{[n]:parseFloat(i),[e]:parseFloat(s),[t]:parseFloat(a),alpha:o!==void 0?parseFloat(o):1}},Mne=n=>$l(0,255,n),vS={...W0,transform:n=>Math.round(Mne(n))},Sh={test:fR("rgb","red"),parse:Mj("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:r=1})=>"rgba("+vS.transform(n)+", "+vS.transform(e)+", "+vS.transform(t)+", "+Im(Ep.transform(r))+")"};function Nne(n){let e="",t="",r="",i="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),r=n.substring(5,7),i=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),r=n.substring(3,4),i=n.substring(4,5),e+=e,t+=t,r+=r,i+=i),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}}const cb={test:fR("#"),parse:Nne,transform:Sh.transform},Lf={test:fR("hsl","hue"),parse:Mj("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:r=1})=>"hsla("+Math.round(n)+", "+Wo.transform(Im(e))+", "+Wo.transform(Im(t))+", "+Im(Ep.transform(r))+")"},Ui={test:n=>Sh.test(n)||cb.test(n)||Lf.test(n),parse:n=>Sh.test(n)?Sh.parse(n):Lf.test(n)?Lf.parse(n):cb.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?Sh.transform(n):Lf.transform(n)},Lne=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function One(n){var e,t;return isNaN(n)&&typeof n=="string"&&(((e=n.match(dR))===null||e===void 0?void 0:e.length)||0)+(((t=n.match(Lne))===null||t===void 0?void 0:t.length)||0)>0}const Nj="number",Lj="color",Dne="var",Fne="var(",g3="${}",jne=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Tp(n){const e=n.toString(),t=[],r={color:[],number:[],var:[]},i=[];let s=0;const o=e.replace(jne,l=>(Ui.test(l)?(r.color.push(s),i.push(Lj),t.push(Ui.parse(l))):l.startsWith(Fne)?(r.var.push(s),i.push(Dne),t.push(l)):(r.number.push(s),i.push(Nj),t.push(parseFloat(l))),++s,g3)).split(g3);return{values:t,split:o,indexes:r,types:i}}function Oj(n){return Tp(n).values}function Dj(n){const{split:e,types:t}=Tp(n),r=e.length;return i=>{let s="";for(let a=0;a<r;a++)if(s+=e[a],i[a]!==void 0){const o=t[a];o===Nj?s+=Im(i[a]):o===Lj?s+=Ui.transform(i[a]):s+=i[a]}return s}}const Vne=n=>typeof n=="number"?0:n;function Gne(n){const e=Oj(n);return Dj(n)(e.map(Vne))}const pu={test:One,parse:Oj,createTransformer:Dj,getAnimatableNone:Gne},Bne=new Set(["brightness","contrast","saturate","opacity"]);function Une(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[r]=t.match(dR)||[];if(!r)return n;const i=t.replace(r,"");let s=Bne.has(e)?1:0;return r!==t&&(s*=100),e+"("+s+i+")"}const zne=/\b([a-z-]*)\(.*?\)/gu,ub={...pu,getAnimatableNone:n=>{const e=n.match(zne);return e?e.map(Une).join(" "):n}},$ne={...ZA,color:Ui,backgroundColor:Ui,outlineColor:Ui,fill:Ui,stroke:Ui,borderColor:Ui,borderTopColor:Ui,borderRightColor:Ui,borderBottomColor:Ui,borderLeftColor:Ui,filter:ub,WebkitFilter:ub},gR=n=>$ne[n];function Fj(n,e){let t=gR(n);return t!==ub&&(t=pu),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const Wne=new Set(["auto","none","0"]);function Hne(n,e,t){let r=0,i;for(;r<n.length&&!i;){const s=n[r];typeof s=="string"&&!Wne.has(s)&&Tp(s).values.length&&(i=n[r]),r++}if(i&&t)for(const s of e)n[s]=Fj(t,i)}const m3=n=>n===W0||n===Ft,p3=(n,e)=>parseFloat(n.split(", ")[e]),y3=(n,e)=>(t,{transform:r})=>{if(r==="none"||!r)return 0;const i=r.match(/^matrix3d\((.+)\)$/u);if(i)return p3(i[1],e);{const s=r.match(/^matrix\((.+)\)$/u);return s?p3(s[1],n):0}},Kne=new Set(["x","y","z"]),Yne=$0.filter(n=>!Kne.has(n));function Xne(n){const e=[];return Yne.forEach(t=>{const r=n.getValue(t);r!==void 0&&(e.push([t,r.get()]),r.set(t.startsWith("scale")?1:0))}),e}const k0={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:y3(4,13),y:y3(5,14)};k0.translateX=k0.x;k0.translateY=k0.y;const Mh=new Set;let hb=!1,db=!1;function jj(){if(db){const n=Array.from(Mh).filter(r=>r.needsMeasurement),e=new Set(n.map(r=>r.element)),t=new Map;e.forEach(r=>{const i=Xne(r);i.length&&(t.set(r,i),r.render())}),n.forEach(r=>r.measureInitialState()),e.forEach(r=>{r.render();const i=t.get(r);i&&i.forEach(([s,a])=>{var o;(o=r.getValue(s))===null||o===void 0||o.set(a)})}),n.forEach(r=>r.measureEndState()),n.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}db=!1,hb=!1,Mh.forEach(n=>n.complete()),Mh.clear()}function Vj(){Mh.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(db=!0)})}function qne(){Vj(),jj()}class mR{constructor(e,t,r,i,s,a=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=r,this.motionValue=i,this.element=s,this.isAsync=a}scheduleResolve(){this.isScheduled=!0,this.isAsync?(Mh.add(this),hb||(hb=!0,lr.read(Vj),lr.resolveKeyframes(jj))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:r,motionValue:i}=this;for(let s=0;s<e.length;s++)if(e[s]===null)if(s===0){const a=i?.get(),o=e[e.length-1];if(a!==void 0)e[0]=a;else if(r&&t){const l=r.readValue(t,o);l!=null&&(e[0]=l)}e[0]===void 0&&(e[0]=o),i&&a===void 0&&i.set(e[0])}else e[s]=e[s-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),Mh.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,Mh.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const Gj=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n),Zne=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Qne(n){const e=Zne.exec(n);if(!e)return[,];const[,t,r,i]=e;return[`--${t??r}`,i]}function Bj(n,e,t=1){const[r,i]=Qne(n);if(!r)return;const s=window.getComputedStyle(e).getPropertyValue(r);if(s){const a=s.trim();return Gj(a)?parseFloat(a):a}return qA(i)?Bj(i,e,t+1):i}const Uj=n=>e=>e.test(n),Jne={test:n=>n==="auto",parse:n=>n},zj=[W0,Ft,Wo,Oc,Ute,Bte,Jne],_3=n=>zj.find(Uj(n));class $j extends mR{constructor(e,t,r,i,s){super(e,t,r,i,s,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:r}=this;if(!t||!t.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let u=e[l];if(typeof u=="string"&&(u=u.trim(),qA(u))){const h=Bj(u,t.current);h!==void 0&&(e[l]=h),l===e.length-1&&(this.finalKeyframe=u)}}if(this.resolveNoneKeyframes(),!vj.has(r)||e.length!==2)return;const[i,s]=e,a=_3(i),o=_3(s);if(a!==o)if(m3(a)&&m3(o))for(let l=0;l<e.length;l++){const u=e[l];typeof u=="string"&&(e[l]=parseFloat(u))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,r=[];for(let i=0;i<e.length;i++)Cne(e[i])&&r.push(i);r.length&&Hne(e,r,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:r}=this;if(!e||!e.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=k0[r](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const i=t[t.length-1];i!==void 0&&e.getValue(r,i).jump(i,!1)}measureEndState(){var e;const{element:t,name:r,unresolvedKeyframes:i}=this;if(!t||!t.current)return;const s=t.getValue(r);s&&s.jump(this.measuredOrigin,!1);const a=i.length-1,o=i[a];i[a]=k0[r](t.measureViewportBox(),window.getComputedStyle(t.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([l,u])=>{t.getValue(l).set(u)}),this.resolveNoneKeyframes()}}const x3=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(pu.test(n)||n==="0")&&!n.startsWith("url("));function ere(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function tre(n,e,t,r){const i=n[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const s=n[n.length-1],a=x3(i,e),o=x3(s,e);return!a||!o?!1:ere(n)||(t==="spring"||iR(t))&&r}const nre=n=>n!==null;function Lw(n,{repeat:e,repeatType:t="loop"},r){const i=n.filter(nre),s=e&&t!=="loop"&&e%2===1?0:i.length-1;return!s||r===void 0?i[s]:r}const rre=40;class Wj{constructor({autoplay:e=!0,delay:t=0,type:r="keyframes",repeat:i=0,repeatDelay:s=0,repeatType:a="loop",...o}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=Ho.now(),this.options={autoplay:e,delay:t,type:r,repeat:i,repeatDelay:s,repeatType:a,...o},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>rre?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&qne(),this._resolved}onKeyframesResolved(e,t){this.resolvedAt=Ho.now(),this.hasAttemptedResolve=!0;const{name:r,type:i,velocity:s,delay:a,onComplete:o,onUpdate:l,isGenerator:u}=this.options;if(!u&&!tre(e,r,i,s))if(a)this.options.duration=0;else{l&&l(Lw(e,this.options,t)),o&&o(),this.resolveFinishedPromise();return}const h=this.initPlayback(e,t);h!==!1&&(this._resolved={keyframes:e,finalKeyframe:t,...h},this.onPostResolved())}onPostResolved(){}then(e,t){return this.currentFinishedPromise.then(e,t)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const Sr=(n,e,t)=>n+(e-n)*t;function wS(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function ire({hue:n,saturation:e,lightness:t,alpha:r}){n/=360,e/=100,t/=100;let i=0,s=0,a=0;if(!e)i=s=a=t;else{const o=t<.5?t*(1+e):t+e-t*e,l=2*t-o;i=wS(l,o,n+1/3),s=wS(l,o,n),a=wS(l,o,n-1/3)}return{red:Math.round(i*255),green:Math.round(s*255),blue:Math.round(a*255),alpha:r}}function qx(n,e){return t=>t>0?e:n}const ES=(n,e,t)=>{const r=n*n,i=t*(e*e-r)+r;return i<0?0:Math.sqrt(i)},sre=[cb,Sh,Lf],are=n=>sre.find(e=>e.test(n));function v3(n){const e=are(n);if(!e)return!1;let t=e.parse(n);return e===Lf&&(t=ire(t)),t}const w3=(n,e)=>{const t=v3(n),r=v3(e);if(!t||!r)return qx(n,e);const i={...t};return s=>(i.red=ES(t.red,r.red,s),i.green=ES(t.green,r.green,s),i.blue=ES(t.blue,r.blue,s),i.alpha=Sr(t.alpha,r.alpha,s),Sh.transform(i))},ore=(n,e)=>t=>e(n(t)),w1=(...n)=>n.reduce(ore),fb=new Set(["none","hidden"]);function lre(n,e){return fb.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function cre(n,e){return t=>Sr(n,e,t)}function pR(n){return typeof n=="number"?cre:typeof n=="string"?qA(n)?qx:Ui.test(n)?w3:dre:Array.isArray(n)?Hj:typeof n=="object"?Ui.test(n)?w3:ure:qx}function Hj(n,e){const t=[...n],r=t.length,i=n.map((s,a)=>pR(s)(s,e[a]));return s=>{for(let a=0;a<r;a++)t[a]=i[a](s);return t}}function ure(n,e){const t={...n,...e},r={};for(const i in t)n[i]!==void 0&&e[i]!==void 0&&(r[i]=pR(n[i])(n[i],e[i]));return i=>{for(const s in r)t[s]=r[s](i);return t}}function hre(n,e){var t;const r=[],i={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const a=e.types[s],o=n.indexes[a][i[a]],l=(t=n.values[o])!==null&&t!==void 0?t:0;r[s]=l,i[a]++}return r}const dre=(n,e)=>{const t=pu.createTransformer(e),r=Tp(n),i=Tp(e);return r.indexes.var.length===i.indexes.var.length&&r.indexes.color.length===i.indexes.color.length&&r.indexes.number.length>=i.indexes.number.length?fb.has(n)&&!i.values.length||fb.has(e)&&!r.values.length?lre(n,e):w1(Hj(hre(r,i),i.values),t):qx(n,e)};function Kj(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?Sr(n,e,t):pR(n)(n,e)}const fre=5;function Yj(n,e,t){const r=Math.max(e-fre,0);return wj(t-n(r),e-r)}const Ar={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},SS=.001;function gre({duration:n=Ar.duration,bounce:e=Ar.bounce,velocity:t=Ar.velocity,mass:r=Ar.mass}){let i,s,a=1-e;a=$l(Ar.minDamping,Ar.maxDamping,a),n=$l(Ar.minDuration,Ar.maxDuration,Ol(n)),a<1?(i=u=>{const h=u*a,f=h*n,g=h-t,y=gb(u,a),v=Math.exp(-f);return SS-g/y*v},s=u=>{const f=u*a*n,g=f*t+t,y=Math.pow(a,2)*Math.pow(u,2)*n,v=Math.exp(-f),x=gb(Math.pow(u,2),a);return(-i(u)+SS>0?-1:1)*((g-y)*v)/x}):(i=u=>{const h=Math.exp(-u*n),f=(u-t)*n+1;return-SS+h*f},s=u=>{const h=Math.exp(-u*n),f=(t-u)*(n*n);return h*f});const o=5/n,l=pre(i,s,o);if(n=Ll(n),isNaN(l))return{stiffness:Ar.stiffness,damping:Ar.damping,duration:n};{const u=Math.pow(l,2)*r;return{stiffness:u,damping:a*2*Math.sqrt(r*u),duration:n}}}const mre=12;function pre(n,e,t){let r=t;for(let i=1;i<mre;i++)r=r-n(r)/e(r);return r}function gb(n,e){return n*Math.sqrt(1-e*e)}const yre=["duration","bounce"],_re=["stiffness","damping","mass"];function E3(n,e){return e.some(t=>n[t]!==void 0)}function xre(n){let e={velocity:Ar.velocity,stiffness:Ar.stiffness,damping:Ar.damping,mass:Ar.mass,isResolvedFromDuration:!1,...n};if(!E3(n,_re)&&E3(n,yre))if(n.visualDuration){const t=n.visualDuration,r=2*Math.PI/(t*1.2),i=r*r,s=2*$l(.05,1,1-(n.bounce||0))*Math.sqrt(i);e={...e,mass:Ar.mass,stiffness:i,damping:s}}else{const t=gre(n);e={...e,...t,mass:Ar.mass},e.isResolvedFromDuration=!0}return e}function Xj(n=Ar.visualDuration,e=Ar.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:r,restDelta:i}=t;const s=t.keyframes[0],a=t.keyframes[t.keyframes.length-1],o={done:!1,value:s},{stiffness:l,damping:u,mass:h,duration:f,velocity:g,isResolvedFromDuration:y}=xre({...t,velocity:-Ol(t.velocity||0)}),v=g||0,x=u/(2*Math.sqrt(l*h)),E=a-s,T=Ol(Math.sqrt(l/h)),b=Math.abs(E)<5;r||(r=b?Ar.restSpeed.granular:Ar.restSpeed.default),i||(i=b?Ar.restDelta.granular:Ar.restDelta.default);let I;if(x<1){const F=gb(T,x);I=z=>{const P=Math.exp(-x*T*z);return a-P*((v+x*T*E)/F*Math.sin(F*z)+E*Math.cos(F*z))}}else if(x===1)I=F=>a-Math.exp(-T*F)*(E+(v+T*E)*F);else{const F=T*Math.sqrt(x*x-1);I=z=>{const P=Math.exp(-x*T*z),C=Math.min(F*z,300);return a-P*((v+x*T*E)*Math.sinh(C)+F*E*Math.cosh(C))/F}}const M={calculatedDuration:y&&f||null,next:F=>{const z=I(F);if(y)o.done=F>=f;else{let P=0;x<1&&(P=F===0?Ll(v):Yj(I,F,z));const C=Math.abs(P)<=r,k=Math.abs(a-z)<=i;o.done=C&&k}return o.value=o.done?a:z,o},toString:()=>{const F=Math.min(fj(M),ab),z=gj(P=>M.next(F*P).value,F,30);return F+"ms "+z}};return M}function S3({keyframes:n,velocity:e=0,power:t=.8,timeConstant:r=325,bounceDamping:i=10,bounceStiffness:s=500,modifyTarget:a,min:o,max:l,restDelta:u=.5,restSpeed:h}){const f=n[0],g={done:!1,value:f},y=C=>o!==void 0&&C<o||l!==void 0&&C>l,v=C=>o===void 0?l:l===void 0||Math.abs(o-C)<Math.abs(l-C)?o:l;let x=t*e;const E=f+x,T=a===void 0?E:a(E);T!==E&&(x=T-f);const b=C=>-x*Math.exp(-C/r),I=C=>T+b(C),M=C=>{const k=b(C),L=I(C);g.done=Math.abs(k)<=u,g.value=g.done?T:L};let F,z;const P=C=>{y(g.value)&&(F=C,z=Xj({keyframes:[g.value,v(g.value)],velocity:Yj(I,C,g.value),damping:i,stiffness:s,restDelta:u,restSpeed:h}))};return P(0),{calculatedDuration:null,next:C=>{let k=!1;return!z&&F===void 0&&(k=!0,M(C),P(C)),F!==void 0&&C>=F?z.next(C-F):(!k&&M(C),g)}}}const vre=v1(.42,0,1,1),wre=v1(0,0,.58,1),qj=v1(.42,0,.58,1),Ere=n=>Array.isArray(n)&&typeof n[0]!="number",Sre={linear:Js,easeIn:vre,easeInOut:qj,easeOut:wre,circIn:hR,circInOut:kj,circOut:Cj,backIn:uR,backInOut:Aj,backOut:Ij,anticipate:Rj},T3=n=>{if(sR(n)){K8(n.length===4);const[e,t,r,i]=n;return v1(e,t,r,i)}else if(typeof n=="string")return Sre[n];return n};function Tre(n,e,t){const r=[],i=t||Kj,s=n.length-1;for(let a=0;a<s;a++){let o=i(n[a],n[a+1]);if(e){const l=Array.isArray(e)?e[a]||Js:e;o=w1(l,o)}r.push(o)}return r}function bre(n,e,{clamp:t=!0,ease:r,mixer:i}={}){const s=n.length;if(K8(s===e.length),s===1)return()=>e[0];if(s===2&&e[0]===e[1])return()=>e[1];const a=n[0]===n[1];n[0]>n[s-1]&&(n=[...n].reverse(),e=[...e].reverse());const o=Tre(e,r,i),l=o.length,u=h=>{if(a&&h<n[0])return e[0];let f=0;if(l>1)for(;f<n.length-2&&!(h<n[f+1]);f++);const g=R0(n[f],n[f+1],h);return o[f](g)};return t?h=>u($l(n[0],n[s-1],h)):u}function Ire(n,e){const t=n[n.length-1];for(let r=1;r<=e;r++){const i=R0(0,e,r);n.push(Sr(t,1,i))}}function Are(n){const e=[0];return Ire(e,n.length-1),e}function Rre(n,e){return n.map(t=>t*e)}function Cre(n,e){return n.map(()=>e||qj).splice(0,n.length-1)}function Zx({duration:n=300,keyframes:e,times:t,ease:r="easeInOut"}){const i=Ere(r)?r.map(T3):T3(r),s={done:!1,value:e[0]},a=Rre(t&&t.length===e.length?t:Are(e),n),o=bre(a,e,{ease:Array.isArray(i)?i:Cre(e,i)});return{calculatedDuration:n,next:l=>(s.value=o(l),s.done=l>=n,s)}}const kre=n=>{const e=({timestamp:t})=>n(t);return{start:()=>lr.update(e,!0),stop:()=>mu(e),now:()=>Ti.isProcessing?Ti.timestamp:Ho.now()}},Pre={decay:S3,inertia:S3,tween:Zx,keyframes:Zx,spring:Xj},Mre=n=>n/100;class yR extends Wj{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:l}=this.options;l&&l()};const{name:t,motionValue:r,element:i,keyframes:s}=this.options,a=i?.KeyframeResolver||mR,o=(l,u)=>this.onKeyframesResolved(l,u);this.resolver=new a(s,o,t,r,i),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:t="keyframes",repeat:r=0,repeatDelay:i=0,repeatType:s,velocity:a=0}=this.options,o=iR(t)?t:Pre[t]||Zx;let l,u;o!==Zx&&typeof e[0]!="number"&&(l=w1(Mre,Kj(e[0],e[1])),e=[0,100]);const h=o({...this.options,keyframes:e});s==="mirror"&&(u=o({...this.options,keyframes:[...e].reverse(),velocity:-a})),h.calculatedDuration===null&&(h.calculatedDuration=fj(h));const{calculatedDuration:f}=h,g=f+i,y=g*(r+1)-i;return{generator:h,mirroredGenerator:u,mapPercentToKeyframes:l,calculatedDuration:f,resolvedDuration:g,totalDuration:y}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,t=!1){const{resolved:r}=this;if(!r){const{keyframes:C}=this.options;return{done:!0,value:C[C.length-1]}}const{finalKeyframe:i,generator:s,mirroredGenerator:a,mapPercentToKeyframes:o,keyframes:l,calculatedDuration:u,totalDuration:h,resolvedDuration:f}=r;if(this.startTime===null)return s.next(0);const{delay:g,repeat:y,repeatType:v,repeatDelay:x,onUpdate:E}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-h/this.speed,this.startTime)),t?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const T=this.currentTime-g*(this.speed>=0?1:-1),b=this.speed>=0?T<0:T>h;this.currentTime=Math.max(T,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=h);let I=this.currentTime,M=s;if(y){const C=Math.min(this.currentTime,h)/f;let k=Math.floor(C),L=C%1;!L&&C>=1&&(L=1),L===1&&k--,k=Math.min(k,y+1),k%2&&(v==="reverse"?(L=1-L,x&&(L-=x/f)):v==="mirror"&&(M=a)),I=$l(0,1,L)*f}const F=b?{done:!1,value:l[0]}:M.next(I);o&&(F.value=o(F.value));let{done:z}=F;!b&&u!==null&&(z=this.speed>=0?this.currentTime>=h:this.currentTime<=0);const P=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&z);return P&&i!==void 0&&(F.value=Lw(l,this.options,i)),E&&E(F.value),P&&this.finish(),F}get duration(){const{resolved:e}=this;return e?Ol(e.calculatedDuration):0}get time(){return Ol(this.currentTime)}set time(e){e=Ll(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=Ol(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=kre,onPlay:t,startTime:r}=this.options;this.driver||(this.driver=e(s=>this.tick(s))),t&&t();const i=this.driver.now();this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=i):this.startTime=r??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const Nre=new Set(["opacity","clipPath","filter","transform"]);function Lre(n,e,t,{delay:r=0,duration:i=300,repeat:s=0,repeatType:a="loop",ease:o="easeInOut",times:l}={}){const u={[e]:t};l&&(u.offset=l);const h=pj(o,i);return Array.isArray(h)&&(u.easing=h),n.animate(u,{delay:r,duration:i,easing:Array.isArray(h)?"linear":h,fill:"both",iterations:s+1,direction:a==="reverse"?"alternate":"normal"})}const Ore=zA(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Qx=10,Dre=2e4;function Fre(n){return iR(n.type)||n.type==="spring"||!mj(n.ease)}function jre(n,e){const t=new yR({...e,keyframes:n,repeat:0,delay:0,isGenerator:!0});let r={done:!1,value:n[0]};const i=[];let s=0;for(;!r.done&&s<Dre;)r=t.sample(s),i.push(r.value),s+=Qx;return{times:void 0,keyframes:i,duration:s-Qx,ease:"linear"}}const Zj={anticipate:Rj,backInOut:Aj,circInOut:kj};function Vre(n){return n in Zj}class b3 extends Wj{constructor(e){super(e);const{name:t,motionValue:r,element:i,keyframes:s}=this.options;this.resolver=new $j(s,(a,o)=>this.onKeyframesResolved(a,o),t,r,i),this.resolver.scheduleResolve()}initPlayback(e,t){let{duration:r=300,times:i,ease:s,type:a,motionValue:o,name:l,startTime:u}=this.options;if(!o.owner||!o.owner.current)return!1;if(typeof s=="string"&&Xx()&&Vre(s)&&(s=Zj[s]),Fre(this.options)){const{onComplete:f,onUpdate:g,motionValue:y,element:v,...x}=this.options,E=jre(e,x);e=E.keyframes,e.length===1&&(e[1]=e[0]),r=E.duration,i=E.times,s=E.ease,a="keyframes"}const h=Lre(o.owner.current,l,e,{...this.options,duration:r,times:i,ease:s});return h.startTime=u??this.calcStartTime(),this.pendingTimeline?(c3(h,this.pendingTimeline),this.pendingTimeline=void 0):h.onfinish=()=>{const{onComplete:f}=this.options;o.set(Lw(e,this.options,t)),f&&f(),this.cancel(),this.resolveFinishedPromise()},{animation:h,duration:r,times:i,type:a,ease:s,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:t}=e;return Ol(t)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:t}=e;return Ol(t.currentTime||0)}set time(e){const{resolved:t}=this;if(!t)return;const{animation:r}=t;r.currentTime=Ll(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:t}=e;return t.playbackRate}set speed(e){const{resolved:t}=this;if(!t)return;const{animation:r}=t;r.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:t}=e;return t.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:t}=e;return t.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:t}=this;if(!t)return Js;const{animation:r}=t;c3(r,e)}return Js}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.playState==="finished"&&this.updateFinishedPromise(),t.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:t,keyframes:r,duration:i,type:s,ease:a,times:o}=e;if(t.playState==="idle"||t.playState==="finished")return;if(this.time){const{motionValue:u,onUpdate:h,onComplete:f,element:g,...y}=this.options,v=new yR({...y,keyframes:r,duration:i,type:s,ease:a,times:o,isGenerator:!0}),x=Ll(this.time);u.setWithVelocity(v.sample(x-Qx).value,v.sample(x).value,Qx)}const{onStop:l}=this.options;l&&l(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:t,name:r,repeatDelay:i,repeatType:s,damping:a,type:o}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:u}=t.owner.getProps();return Ore()&&r&&Nre.has(r)&&!l&&!u&&!i&&s!=="mirror"&&a!==0&&o!=="inertia"}}const Gre={type:"spring",stiffness:500,damping:25,restSpeed:10},Bre=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),Ure={type:"keyframes",duration:.8},zre={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},$re=(n,{keyframes:e})=>e.length>2?Ure:yd.has(n)?n.startsWith("scale")?Bre(e[1]):Gre:zre;function Wre({when:n,delay:e,delayChildren:t,staggerChildren:r,staggerDirection:i,repeat:s,repeatType:a,repeatDelay:o,from:l,elapsed:u,...h}){return!!Object.keys(h).length}const _R=(n,e,t,r={},i,s)=>a=>{const o=rR(r,n)||{},l=o.delay||r.delay||0;let{elapsed:u=0}=r;u=u-Ll(l);let h={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...o,delay:-u,onUpdate:g=>{e.set(g),o.onUpdate&&o.onUpdate(g)},onComplete:()=>{a(),o.onComplete&&o.onComplete()},name:n,motionValue:e,element:s?void 0:i};Wre(o)||(h={...h,...$re(n,h)}),h.duration&&(h.duration=Ll(h.duration)),h.repeatDelay&&(h.repeatDelay=Ll(h.repeatDelay)),h.from!==void 0&&(h.keyframes[0]=h.from);let f=!1;if((h.type===!1||h.duration===0&&!h.repeatDelay)&&(h.duration=0,h.delay===0&&(f=!0)),f&&!s&&e.get()!==void 0){const g=Lw(h.keyframes,o);if(g!==void 0)return lr.update(()=>{h.onUpdate(g),h.onComplete()}),new une([])}return!s&&b3.supports(h)?new b3(h):new yR(h)};function Hre({protectedKeys:n,needsAnimating:e},t){const r=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,r}function Qj(n,e,{delay:t=0,transitionOverride:r,type:i}={}){var s;let{transition:a=n.getDefaultTransition(),transitionEnd:o,...l}=e;r&&(a=r);const u=[],h=i&&n.animationState&&n.animationState.getState()[i];for(const f in l){const g=n.getValue(f,(s=n.latestValues[f])!==null&&s!==void 0?s:null),y=l[f];if(y===void 0||h&&Hre(h,f))continue;const v={delay:t,...rR(a||{},f)};let x=!1;if(window.MotionHandoffAnimation){const T=Ej(n);if(T){const b=window.MotionHandoffAnimation(T,f,lr);b!==null&&(v.startTime=b,x=!0)}}lb(n,f),g.start(_R(f,g,y,n.shouldReduceMotion&&vj.has(f)?{type:!1}:v,n,x));const E=g.animation;E&&u.push(E)}return o&&Promise.all(u).then(()=>{lr.update(()=>{o&&Tne(n,o)})}),u}function mb(n,e,t={}){var r;const i=Nw(n,e,t.type==="exit"?(r=n.presenceContext)===null||r===void 0?void 0:r.custom:void 0);let{transition:s=n.getDefaultTransition()||{}}=i||{};t.transitionOverride&&(s=t.transitionOverride);const a=i?()=>Promise.all(Qj(n,i,t)):()=>Promise.resolve(),o=n.variantChildren&&n.variantChildren.size?(u=0)=>{const{delayChildren:h=0,staggerChildren:f,staggerDirection:g}=s;return Kre(n,e,h+u,f,g,t)}:()=>Promise.resolve(),{when:l}=s;if(l){const[u,h]=l==="beforeChildren"?[a,o]:[o,a];return u().then(()=>h())}else return Promise.all([a(),o(t.delay)])}function Kre(n,e,t=0,r=0,i=1,s){const a=[],o=(n.variantChildren.size-1)*r,l=i===1?(u=0)=>u*r:(u=0)=>o-u*r;return Array.from(n.variantChildren).sort(Yre).forEach((u,h)=>{u.notify("AnimationStart",e),a.push(mb(u,e,{...s,delay:t+l(h)}).then(()=>u.notify("AnimationComplete",e)))}),Promise.all(a)}function Yre(n,e){return n.sortNodePosition(e)}function Xre(n,e,t={}){n.notify("AnimationStart",e);let r;if(Array.isArray(e)){const i=e.map(s=>mb(n,s,t));r=Promise.all(i)}else if(typeof e=="string")r=mb(n,e,t);else{const i=typeof e=="function"?Nw(n,e,t.custom):e;r=Promise.all(Qj(n,i,t))}return r.then(()=>{n.notify("AnimationComplete",e)})}const qre=WA.length;function Jj(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?Jj(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<qre;t++){const r=WA[t],i=n.props[r];(wp(i)||i===!1)&&(e[r]=i)}return e}const Zre=[...$A].reverse(),Qre=$A.length;function Jre(n){return e=>Promise.all(e.map(({animation:t,options:r})=>Xre(n,t,r)))}function eie(n){let e=Jre(n),t=I3(),r=!0;const i=l=>(u,h)=>{var f;const g=Nw(n,h,l==="exit"?(f=n.presenceContext)===null||f===void 0?void 0:f.custom:void 0);if(g){const{transition:y,transitionEnd:v,...x}=g;u={...u,...x,...v}}return u};function s(l){e=l(n)}function a(l){const{props:u}=n,h=Jj(n.parent)||{},f=[],g=new Set;let y={},v=1/0;for(let E=0;E<Qre;E++){const T=Zre[E],b=t[T],I=u[T]!==void 0?u[T]:h[T],M=wp(I),F=T===l?b.isActive:null;F===!1&&(v=E);let z=I===h[T]&&I!==u[T]&&M;if(z&&r&&n.manuallyAnimateOnMount&&(z=!1),b.protectedKeys={...y},!b.isActive&&F===null||!I&&!b.prevProp||Pw(I)||typeof I=="boolean")continue;const P=tie(b.prevProp,I);let C=P||T===l&&b.isActive&&!z&&M||E>v&&M,k=!1;const L=Array.isArray(I)?I:[I];let O=L.reduce(i(T),{});F===!1&&(O={});const{prevResolvedValues:U={}}=b,j={...U,...O},Te=Ne=>{C=!0,g.has(Ne)&&(k=!0,g.delete(Ne)),b.needsAnimating[Ne]=!0;const le=n.getValue(Ne);le&&(le.liveStyle=!1)};for(const Ne in j){const le=O[Ne],ue=U[Ne];if(y.hasOwnProperty(Ne))continue;let Se=!1;sb(le)&&sb(ue)?Se=!dj(le,ue):Se=le!==ue,Se?le!=null?Te(Ne):g.add(Ne):le!==void 0&&g.has(Ne)?Te(Ne):b.protectedKeys[Ne]=!0}b.prevProp=I,b.prevResolvedValues=O,b.isActive&&(y={...y,...O}),r&&n.blockInitialAnimation&&(C=!1),C&&(!(z&&P)||k)&&f.push(...L.map(Ne=>({animation:Ne,options:{type:T}})))}if(g.size){const E={};g.forEach(T=>{const b=n.getBaseTarget(T),I=n.getValue(T);I&&(I.liveStyle=!0),E[T]=b??null}),f.push({animation:E})}let x=!!f.length;return r&&(u.initial===!1||u.initial===u.animate)&&!n.manuallyAnimateOnMount&&(x=!1),r=!1,x?e(f):Promise.resolve()}function o(l,u){var h;if(t[l].isActive===u)return Promise.resolve();(h=n.variantChildren)===null||h===void 0||h.forEach(g=>{var y;return(y=g.animationState)===null||y===void 0?void 0:y.setActive(l,u)}),t[l].isActive=u;const f=a(l);for(const g in t)t[g].protectedKeys={};return f}return{animateChanges:a,setActive:o,setAnimateFunction:s,getState:()=>t,reset:()=>{t=I3(),r=!0}}}function tie(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!dj(e,n):!1}function eh(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function I3(){return{animate:eh(!0),whileInView:eh(),whileHover:eh(),whileTap:eh(),whileDrag:eh(),whileFocus:eh(),exit:eh()}}class Au{constructor(e){this.isMounted=!1,this.node=e}update(){}}class nie extends Au{constructor(e){super(e),e.animationState||(e.animationState=eie(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();Pw(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let rie=0;class iie extends Au{constructor(){super(...arguments),this.id=rie++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const i=this.node.animationState.setActive("exit",!e);t&&!e&&i.then(()=>t(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const sie={animation:{Feature:nie},exit:{Feature:iie}};function bp(n,e,t,r={passive:!0}){return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t)}function E1(n){return{point:{x:n.pageX,y:n.pageY}}}const aie=n=>e=>aR(e)&&n(e,E1(e));function Am(n,e,t,r){return bp(n,e,aie(t),r)}const A3=(n,e)=>Math.abs(n-e);function oie(n,e){const t=A3(n.x,e.x),r=A3(n.y,e.y);return Math.sqrt(t**2+r**2)}class e9{constructor(e,t,{transformPagePoint:r,contextWindow:i,dragSnapToOrigin:s=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const f=bS(this.lastMoveEventInfo,this.history),g=this.startEvent!==null,y=oie(f.offset,{x:0,y:0})>=3;if(!g&&!y)return;const{point:v}=f,{timestamp:x}=Ti;this.history.push({...v,timestamp:x});const{onStart:E,onMove:T}=this.handlers;g||(E&&E(this.lastMoveEvent,f),this.startEvent=this.lastMoveEvent),T&&T(this.lastMoveEvent,f)},this.handlePointerMove=(f,g)=>{this.lastMoveEvent=f,this.lastMoveEventInfo=TS(g,this.transformPagePoint),lr.update(this.updatePoint,!0)},this.handlePointerUp=(f,g)=>{this.end();const{onEnd:y,onSessionEnd:v,resumeAnimation:x}=this.handlers;if(this.dragSnapToOrigin&&x&&x(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const E=bS(f.type==="pointercancel"?this.lastMoveEventInfo:TS(g,this.transformPagePoint),this.history);this.startEvent&&y&&y(f,E),v&&v(f,E)},!aR(e))return;this.dragSnapToOrigin=s,this.handlers=t,this.transformPagePoint=r,this.contextWindow=i||window;const a=E1(e),o=TS(a,this.transformPagePoint),{point:l}=o,{timestamp:u}=Ti;this.history=[{...l,timestamp:u}];const{onSessionStart:h}=t;h&&h(e,bS(o,this.history)),this.removeListeners=w1(Am(this.contextWindow,"pointermove",this.handlePointerMove),Am(this.contextWindow,"pointerup",this.handlePointerUp),Am(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),mu(this.updatePoint)}}function TS(n,e){return e?{point:e(n.point)}:n}function R3(n,e){return{x:n.x-e.x,y:n.y-e.y}}function bS({point:n},e){return{point:n,delta:R3(n,t9(e)),offset:R3(n,lie(e)),velocity:cie(e,.1)}}function lie(n){return n[0]}function t9(n){return n[n.length-1]}function cie(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,r=null;const i=t9(n);for(;t>=0&&(r=n[t],!(i.timestamp-r.timestamp>Ll(e)));)t--;if(!r)return{x:0,y:0};const s=Ol(i.timestamp-r.timestamp);if(s===0)return{x:0,y:0};const a={x:(i.x-r.x)/s,y:(i.y-r.y)/s};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}const n9=1e-4,uie=1-n9,hie=1+n9,r9=.01,die=0-r9,fie=0+r9;function ra(n){return n.max-n.min}function gie(n,e,t){return Math.abs(n-e)<=t}function C3(n,e,t,r=.5){n.origin=r,n.originPoint=Sr(e.min,e.max,n.origin),n.scale=ra(t)/ra(e),n.translate=Sr(t.min,t.max,n.origin)-n.originPoint,(n.scale>=uie&&n.scale<=hie||isNaN(n.scale))&&(n.scale=1),(n.translate>=die&&n.translate<=fie||isNaN(n.translate))&&(n.translate=0)}function Rm(n,e,t,r){C3(n.x,e.x,t.x,r?r.originX:void 0),C3(n.y,e.y,t.y,r?r.originY:void 0)}function k3(n,e,t){n.min=t.min+e.min,n.max=n.min+ra(e)}function mie(n,e,t){k3(n.x,e.x,t.x),k3(n.y,e.y,t.y)}function P3(n,e,t){n.min=e.min-t.min,n.max=n.min+ra(e)}function Cm(n,e,t){P3(n.x,e.x,t.x),P3(n.y,e.y,t.y)}function pie(n,{min:e,max:t},r){return e!==void 0&&n<e?n=r?Sr(e,n,r.min):Math.max(n,e):t!==void 0&&n>t&&(n=r?Sr(t,n,r.max):Math.min(n,t)),n}function M3(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function yie(n,{top:e,left:t,bottom:r,right:i}){return{x:M3(n.x,t,i),y:M3(n.y,e,r)}}function N3(n,e){let t=e.min-n.min,r=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,r]=[r,t]),{min:t,max:r}}function _ie(n,e){return{x:N3(n.x,e.x),y:N3(n.y,e.y)}}function xie(n,e){let t=.5;const r=ra(n),i=ra(e);return i>r?t=R0(e.min,e.max-r,n.min):r>i&&(t=R0(n.min,n.max-i,e.min)),$l(0,1,t)}function vie(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const pb=.35;function wie(n=pb){return n===!1?n=0:n===!0&&(n=pb),{x:L3(n,"left","right"),y:L3(n,"top","bottom")}}function L3(n,e,t){return{min:O3(n,e),max:O3(n,t)}}function O3(n,e){return typeof n=="number"?n:n[e]||0}const D3=()=>({translate:0,scale:1,origin:0,originPoint:0}),Of=()=>({x:D3(),y:D3()}),F3=()=>({min:0,max:0}),Dr=()=>({x:F3(),y:F3()});function ya(n){return[n("x"),n("y")]}function i9({top:n,left:e,right:t,bottom:r}){return{x:{min:e,max:t},y:{min:n,max:r}}}function Eie({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function Sie(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),r=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:r.y,right:r.x}}function IS(n){return n===void 0||n===1}function yb({scale:n,scaleX:e,scaleY:t}){return!IS(n)||!IS(e)||!IS(t)}function lh(n){return yb(n)||s9(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function s9(n){return j3(n.x)||j3(n.y)}function j3(n){return n&&n!=="0%"}function Jx(n,e,t){const r=n-t,i=e*r;return t+i}function V3(n,e,t,r,i){return i!==void 0&&(n=Jx(n,i,r)),Jx(n,t,r)+e}function _b(n,e=0,t=1,r,i){n.min=V3(n.min,e,t,r,i),n.max=V3(n.max,e,t,r,i)}function a9(n,{x:e,y:t}){_b(n.x,e.translate,e.scale,e.originPoint),_b(n.y,t.translate,t.scale,t.originPoint)}const G3=.999999999999,B3=1.0000000000001;function Tie(n,e,t,r=!1){const i=t.length;if(!i)return;e.x=e.y=1;let s,a;for(let o=0;o<i;o++){s=t[o],a=s.projectionDelta;const{visualElement:l}=s.options;l&&l.props.style&&l.props.style.display==="contents"||(r&&s.options.layoutScroll&&s.scroll&&s!==s.root&&Ff(n,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),a&&(e.x*=a.x.scale,e.y*=a.y.scale,a9(n,a)),r&&lh(s.latestValues)&&Ff(n,s.latestValues))}e.x<B3&&e.x>G3&&(e.x=1),e.y<B3&&e.y>G3&&(e.y=1)}function Df(n,e){n.min=n.min+e,n.max=n.max+e}function U3(n,e,t,r,i=.5){const s=Sr(n.min,n.max,i);_b(n,e,t,s,r)}function Ff(n,e){U3(n.x,e.x,e.scaleX,e.scale,e.originX),U3(n.y,e.y,e.scaleY,e.scale,e.originY)}function o9(n,e){return i9(Sie(n.getBoundingClientRect(),e))}function bie(n,e,t){const r=o9(n,t),{scroll:i}=e;return i&&(Df(r.x,i.offset.x),Df(r.y,i.offset.y)),r}const l9=({current:n})=>n?n.ownerDocument.defaultView:null,Iie=new WeakMap;class Aie{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Dr(),this.visualElement=e}start(e,{snapToCursor:t=!1}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const i=h=>{const{dragSnapToOrigin:f}=this.getProps();f?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(E1(h).point)},s=(h,f)=>{const{drag:g,dragPropagation:y,onDragStart:v}=this.getProps();if(g&&!y&&(this.openDragLock&&this.openDragLock(),this.openDragLock=xne(g),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),ya(E=>{let T=this.getAxisMotionValue(E).get()||0;if(Wo.test(T)){const{projection:b}=this.visualElement;if(b&&b.layout){const I=b.layout.layoutBox[E];I&&(T=ra(I)*(parseFloat(T)/100))}}this.originPoint[E]=T}),v&&lr.postRender(()=>v(h,f)),lb(this.visualElement,"transform");const{animationState:x}=this.visualElement;x&&x.setActive("whileDrag",!0)},a=(h,f)=>{const{dragPropagation:g,dragDirectionLock:y,onDirectionLock:v,onDrag:x}=this.getProps();if(!g&&!this.openDragLock)return;const{offset:E}=f;if(y&&this.currentDirection===null){this.currentDirection=Rie(E),this.currentDirection!==null&&v&&v(this.currentDirection);return}this.updateAxis("x",f.point,E),this.updateAxis("y",f.point,E),this.visualElement.render(),x&&x(h,f)},o=(h,f)=>this.stop(h,f),l=()=>ya(h=>{var f;return this.getAnimationState(h)==="paused"&&((f=this.getAxisMotionValue(h).animation)===null||f===void 0?void 0:f.play())}),{dragSnapToOrigin:u}=this.getProps();this.panSession=new e9(e,{onSessionStart:i,onStart:s,onMove:a,onSessionEnd:o,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,contextWindow:l9(this.visualElement)})}stop(e,t){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:i}=t;this.startAnimation(i);const{onDragEnd:s}=this.getProps();s&&lr.postRender(()=>s(e,t))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,r){const{drag:i}=this.getProps();if(!r||!l_(e,i,this.currentDirection))return;const s=this.getAxisMotionValue(e);let a=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(a=pie(a,this.constraints[e],this.elastic[e])),s.set(a)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:r}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,s=this.constraints;t&&Nf(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&i?this.constraints=yie(i.layoutBox,t):this.constraints=!1,this.elastic=wie(r),s!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&ya(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=vie(i.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!Nf(e))return!1;const r=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const s=bie(r,i.root,this.visualElement.getTransformPagePoint());let a=_ie(i.layout.layoutBox,s);if(t){const o=t(Eie(a));this.hasMutatedConstraints=!!o,o&&(a=i9(o))}return a}startAnimation(e){const{drag:t,dragMomentum:r,dragElastic:i,dragTransition:s,dragSnapToOrigin:a,onDragTransitionEnd:o}=this.getProps(),l=this.constraints||{},u=ya(h=>{if(!l_(h,t,this.currentDirection))return;let f=l&&l[h]||{};a&&(f={min:0,max:0});const g=i?200:1e6,y=i?40:1e7,v={type:"inertia",velocity:r?e[h]:0,bounceStiffness:g,bounceDamping:y,timeConstant:750,restDelta:1,restSpeed:10,...s,...f};return this.startAxisValueAnimation(h,v)});return Promise.all(u).then(o)}startAxisValueAnimation(e,t){const r=this.getAxisMotionValue(e);return lb(this.visualElement,e),r.start(_R(e,r,0,t,this.visualElement,!1))}stopAnimation(){ya(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){ya(e=>{var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.pause()})}getAnimationState(e){var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,r=this.visualElement.getProps(),i=r[t];return i||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){ya(t=>{const{drag:r}=this.getProps();if(!l_(t,r,this.currentDirection))return;const{projection:i}=this.visualElement,s=this.getAxisMotionValue(t);if(i&&i.layout){const{min:a,max:o}=i.layout.layoutBox[t];s.set(e[t]-Sr(a,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:r}=this.visualElement;if(!Nf(t)||!r||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};ya(a=>{const o=this.getAxisMotionValue(a);if(o&&this.constraints!==!1){const l=o.get();i[a]=xie({min:l,max:l},this.constraints[a])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),ya(a=>{if(!l_(a,e,null))return;const o=this.getAxisMotionValue(a),{min:l,max:u}=this.constraints[a];o.set(Sr(l,u,i[a]))})}addListeners(){if(!this.visualElement.current)return;Iie.set(this.visualElement,this);const e=this.visualElement.current,t=Am(e,"pointerdown",l=>{const{drag:u,dragListener:h=!0}=this.getProps();u&&h&&this.start(l)}),r=()=>{const{dragConstraints:l}=this.getProps();Nf(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,s=i.addEventListener("measure",r);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),lr.read(r);const a=bp(window,"resize",()=>this.scalePositionWithinConstraints()),o=i.addEventListener("didUpdate",(({delta:l,hasLayoutChanged:u})=>{this.isDragging&&u&&(ya(h=>{const f=this.getAxisMotionValue(h);f&&(this.originPoint[h]+=l[h].translate,f.set(f.get()+l[h].translate))}),this.visualElement.render())}));return()=>{a(),t(),s(),o&&o()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:r=!1,dragPropagation:i=!1,dragConstraints:s=!1,dragElastic:a=pb,dragMomentum:o=!0}=e;return{...e,drag:t,dragDirectionLock:r,dragPropagation:i,dragConstraints:s,dragElastic:a,dragMomentum:o}}}function l_(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function Rie(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class Cie extends Au{constructor(e){super(e),this.removeGroupControls=Js,this.removeListeners=Js,this.controls=new Aie(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Js}unmount(){this.removeGroupControls(),this.removeListeners()}}const z3=n=>(e,t)=>{n&&lr.postRender(()=>n(e,t))};class kie extends Au{constructor(){super(...arguments),this.removePointerDownListener=Js}onPointerDown(e){this.session=new e9(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:l9(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:r,onPanEnd:i}=this.node.getProps();return{onSessionStart:z3(e),onStart:z3(t),onMove:r,onEnd:(s,a)=>{delete this.session,i&&lr.postRender(()=>i(s,a))}}}mount(){this.removePointerDownListener=Am(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const W_={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function $3(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const Kg={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(Ft.test(n))n=parseFloat(n);else return n;const t=$3(n,e.target.x),r=$3(n,e.target.y);return`${t}% ${r}%`}},Pie={correct:(n,{treeScale:e,projectionDelta:t})=>{const r=n,i=pu.parse(n);if(i.length>5)return r;const s=pu.createTransformer(n),a=typeof i[0]!="number"?1:0,o=t.x.scale*e.x,l=t.y.scale*e.y;i[0+a]/=o,i[1+a]/=l;const u=Sr(o,l,.5);return typeof i[2+a]=="number"&&(i[2+a]/=u),typeof i[3+a]=="number"&&(i[3+a]/=u),s(i)}};class Mie extends ne.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r,layoutId:i}=this.props,{projection:s}=e;Qte(Nie),s&&(t.group&&t.group.add(s),r&&r.register&&i&&r.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),W_.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:r,drag:i,isPresent:s}=this.props,a=r.projection;return a&&(a.isPresent=s,i||e.layoutDependency!==t||t===void 0?a.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?a.promote():a.relegate()||lr.postRender(()=>{const o=a.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),KA.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r}=this.props,{projection:i}=e;i&&(i.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(i),r&&r.deregister&&r.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function c9(n){const[e,t]=W8(),r=ne.useContext(VA);return m.jsx(Mie,{...n,layoutGroup:r,switchLayoutGroup:ne.useContext(J8),isPresent:e,safeToRemove:t})}const Nie={borderRadius:{...Kg,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Kg,borderTopRightRadius:Kg,borderBottomLeftRadius:Kg,borderBottomRightRadius:Kg,boxShadow:Pie};function Lie(n,e,t){const r=Ki(n)?n:Sp(n);return r.start(_R("",r,e,t)),r.animation}function Oie(n){return n instanceof SVGElement&&n.tagName!=="svg"}const Die=(n,e)=>n.depth-e.depth;class Fie{constructor(){this.children=[],this.isDirty=!1}add(e){oR(this.children,e),this.isDirty=!0}remove(e){lR(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(Die),this.isDirty=!1,this.children.forEach(e)}}function jie(n,e){const t=Ho.now(),r=({timestamp:i})=>{const s=i-t;s>=e&&(mu(r),n(s-e))};return lr.read(r,!0),()=>mu(r)}const u9=["TopLeft","TopRight","BottomLeft","BottomRight"],Vie=u9.length,W3=n=>typeof n=="string"?parseFloat(n):n,H3=n=>typeof n=="number"||Ft.test(n);function Gie(n,e,t,r,i,s){i?(n.opacity=Sr(0,t.opacity!==void 0?t.opacity:1,Bie(r)),n.opacityExit=Sr(e.opacity!==void 0?e.opacity:1,0,Uie(r))):s&&(n.opacity=Sr(e.opacity!==void 0?e.opacity:1,t.opacity!==void 0?t.opacity:1,r));for(let a=0;a<Vie;a++){const o=`border${u9[a]}Radius`;let l=K3(e,o),u=K3(t,o);if(l===void 0&&u===void 0)continue;l||(l=0),u||(u=0),l===0||u===0||H3(l)===H3(u)?(n[o]=Math.max(Sr(W3(l),W3(u),r),0),(Wo.test(u)||Wo.test(l))&&(n[o]+="%")):n[o]=u}(e.rotate||t.rotate)&&(n.rotate=Sr(e.rotate||0,t.rotate||0,r))}function K3(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const Bie=h9(0,.5,Cj),Uie=h9(.5,.95,Js);function h9(n,e,t){return r=>r<n?0:r>e?1:t(R0(n,e,r))}function Y3(n,e){n.min=e.min,n.max=e.max}function ma(n,e){Y3(n.x,e.x),Y3(n.y,e.y)}function X3(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function q3(n,e,t,r,i){return n-=e,n=Jx(n,1/t,r),i!==void 0&&(n=Jx(n,1/i,r)),n}function zie(n,e=0,t=1,r=.5,i,s=n,a=n){if(Wo.test(e)&&(e=parseFloat(e),e=Sr(a.min,a.max,e/100)-a.min),typeof e!="number")return;let o=Sr(s.min,s.max,r);n===s&&(o-=e),n.min=q3(n.min,e,t,o,i),n.max=q3(n.max,e,t,o,i)}function Z3(n,e,[t,r,i],s,a){zie(n,e[t],e[r],e[i],e.scale,s,a)}const $ie=["x","scaleX","originX"],Wie=["y","scaleY","originY"];function Q3(n,e,t,r){Z3(n.x,e,$ie,t?t.x:void 0,r?r.x:void 0),Z3(n.y,e,Wie,t?t.y:void 0,r?r.y:void 0)}function J3(n){return n.translate===0&&n.scale===1}function d9(n){return J3(n.x)&&J3(n.y)}function eL(n,e){return n.min===e.min&&n.max===e.max}function Hie(n,e){return eL(n.x,e.x)&&eL(n.y,e.y)}function tL(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function f9(n,e){return tL(n.x,e.x)&&tL(n.y,e.y)}function nL(n){return ra(n.x)/ra(n.y)}function rL(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class Kie{constructor(){this.members=[]}add(e){oR(this.members,e),e.scheduleRender()}remove(e){if(lR(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(i=>e===i);if(t===0)return!1;let r;for(let i=t;i>=0;i--){const s=this.members[i];if(s.isPresent!==!1){r=s;break}}return r?(this.promote(r),!0):!1}promote(e,t){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,t&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:r}=e;t.onExitComplete&&t.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function Yie(n,e,t){let r="";const i=n.x.translate/e.x,s=n.y.translate/e.y,a=t?.z||0;if((i||s||a)&&(r=`translate3d(${i}px, ${s}px, ${a}px) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:u,rotate:h,rotateX:f,rotateY:g,skewX:y,skewY:v}=t;u&&(r=`perspective(${u}px) ${r}`),h&&(r+=`rotate(${h}deg) `),f&&(r+=`rotateX(${f}deg) `),g&&(r+=`rotateY(${g}deg) `),y&&(r+=`skewX(${y}deg) `),v&&(r+=`skewY(${v}deg) `)}const o=n.x.scale*e.x,l=n.y.scale*e.y;return(o!==1||l!==1)&&(r+=`scale(${o}, ${l})`),r||"none"}const ch={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},cm=typeof window<"u"&&window.MotionDebug!==void 0,AS=["","X","Y","Z"],Xie={visibility:"hidden"},iL=1e3;let qie=0;function RS(n,e,t,r){const{latestValues:i}=e;i[n]&&(t[n]=i[n],e.setStaticValue(n,0),r&&(r[n]=0))}function g9(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=Ej(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:i,layoutId:s}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",lr,!(i||s))}const{parent:r}=n;r&&!r.hasCheckedOptimisedAppear&&g9(r)}function m9({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:r,resetTransform:i}){return class{constructor(a={},o=e?.()){this.id=qie++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,cm&&(ch.totalNodes=ch.resolvedTargetDeltas=ch.recalculatedProjection=0),this.nodes.forEach(Jie),this.nodes.forEach(ise),this.nodes.forEach(sse),this.nodes.forEach(ese),cm&&window.MotionDebug.record(ch)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new Fie)}addEventListener(a,o){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new cR),this.eventHandlers.get(a).add(o)}notifyListeners(a,...o){const l=this.eventHandlers.get(a);l&&l.notify(...o)}hasListeners(a){return this.eventHandlers.has(a)}mount(a,o=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=Oie(a),this.instance=a;const{layoutId:l,layout:u,visualElement:h}=this.options;if(h&&!h.current&&h.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),o&&(u||l)&&(this.isLayoutDirty=!0),n){let f;const g=()=>this.root.updateBlockedByResize=!1;n(a,()=>{this.root.updateBlockedByResize=!0,f&&f(),f=jie(g,250),W_.hasAnimatedSinceResize&&(W_.hasAnimatedSinceResize=!1,this.nodes.forEach(aL))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&h&&(l||u)&&this.addEventListener("didUpdate",({delta:f,hasLayoutChanged:g,hasRelativeTargetChanged:y,layout:v})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const x=this.options.transition||h.getDefaultTransition()||use,{onLayoutAnimationStart:E,onLayoutAnimationComplete:T}=h.getProps(),b=!this.targetLayout||!f9(this.targetLayout,v)||y,I=!g&&y;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||I||g&&(b||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(f,I);const M={...rR(x,"layout"),onPlay:E,onComplete:T};(h.shouldReduceMotion||this.options.layoutRoot)&&(M.delay=0,M.type=!1),this.startAnimation(M)}else g||aL(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=v})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,mu(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(ase),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&g9(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let h=0;h<this.path.length;h++){const f=this.path[h];f.shouldResetTransform=!0,f.updateScroll("snapshot"),f.options.layoutRoot&&f.willUpdate(!1)}const{layoutId:o,layout:l}=this.options;if(o===void 0&&!l)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(sL);return}this.isUpdating||this.nodes.forEach(nse),this.isUpdating=!1,this.nodes.forEach(rse),this.nodes.forEach(Zie),this.nodes.forEach(Qie),this.clearAllSnapshots();const o=Ho.now();Ti.delta=$l(0,1e3/60,o-Ti.timestamp),Ti.timestamp=o,Ti.isProcessing=!0,_S.update.process(Ti),_S.preRender.process(Ti),_S.render.process(Ti),Ti.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,KA.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(tse),this.sharedNodes.forEach(ose)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,lr.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){lr.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Dr(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(o=!1),o){const l=r(this.instance);this.scroll={animationId:this.root.animationId,phase:a,isRoot:l,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!i)return;const a=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!d9(this.projectionDelta),l=this.getTransformTemplate(),u=l?l(this.latestValues,""):void 0,h=u!==this.prevTransformTemplateValue;a&&(o||lh(this.latestValues)||h)&&(i(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const o=this.measurePageBox();let l=this.removeElementScroll(o);return a&&(l=this.removeTransform(l)),hse(l),{animationId:this.root.animationId,measuredBox:o,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var a;const{visualElement:o}=this.options;if(!o)return Dr();const l=o.measureViewportBox();if(!(((a=this.scroll)===null||a===void 0?void 0:a.wasRoot)||this.path.some(dse))){const{scroll:h}=this.root;h&&(Df(l.x,h.offset.x),Df(l.y,h.offset.y))}return l}removeElementScroll(a){var o;const l=Dr();if(ma(l,a),!((o=this.scroll)===null||o===void 0)&&o.wasRoot)return l;for(let u=0;u<this.path.length;u++){const h=this.path[u],{scroll:f,options:g}=h;h!==this.root&&f&&g.layoutScroll&&(f.wasRoot&&ma(l,a),Df(l.x,f.offset.x),Df(l.y,f.offset.y))}return l}applyTransform(a,o=!1){const l=Dr();ma(l,a);for(let u=0;u<this.path.length;u++){const h=this.path[u];!o&&h.options.layoutScroll&&h.scroll&&h!==h.root&&Ff(l,{x:-h.scroll.offset.x,y:-h.scroll.offset.y}),lh(h.latestValues)&&Ff(l,h.latestValues)}return lh(this.latestValues)&&Ff(l,this.latestValues),l}removeTransform(a){const o=Dr();ma(o,a);for(let l=0;l<this.path.length;l++){const u=this.path[l];if(!u.instance||!lh(u.latestValues))continue;yb(u.latestValues)&&u.updateSnapshot();const h=Dr(),f=u.measurePageBox();ma(h,f),Q3(o,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,h)}return lh(this.latestValues)&&Q3(o,this.latestValues),o}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Ti.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var o;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==l;if(!(a||u&&this.isSharedProjectionDirty||this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:f,layoutId:g}=this.options;if(!(!this.layout||!(f||g))){if(this.resolvedRelativeTargetAt=Ti.timestamp,!this.targetDelta&&!this.relativeTarget){const y=this.getClosestProjectingParent();y&&y.layout&&this.animationProgress!==1?(this.relativeParent=y,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Dr(),this.relativeTargetOrigin=Dr(),Cm(this.relativeTargetOrigin,this.layout.layoutBox,y.layout.layoutBox),ma(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Dr(),this.targetWithTransforms=Dr()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),mie(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):ma(this.target,this.layout.layoutBox),a9(this.target,this.targetDelta)):ma(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const y=this.getClosestProjectingParent();y&&!!y.resumingFrom==!!this.resumingFrom&&!y.options.layoutScroll&&y.target&&this.animationProgress!==1?(this.relativeParent=y,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Dr(),this.relativeTargetOrigin=Dr(),Cm(this.relativeTargetOrigin,this.target,y.target),ma(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}cm&&ch.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||yb(this.parent.latestValues)||s9(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var a;const o=this.getLead(),l=!!this.resumingFrom||this!==o;let u=!0;if((this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty)&&(u=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===Ti.timestamp&&(u=!1),u)return;const{layout:h,layoutId:f}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(h||f))return;ma(this.layoutCorrected,this.layout.layoutBox);const g=this.treeScale.x,y=this.treeScale.y;Tie(this.layoutCorrected,this.treeScale,this.path,l),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=Dr());const{target:v}=o;if(!v){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(X3(this.prevProjectionDelta.x,this.projectionDelta.x),X3(this.prevProjectionDelta.y,this.projectionDelta.y)),Rm(this.projectionDelta,this.layoutCorrected,v,this.latestValues),(this.treeScale.x!==g||this.treeScale.y!==y||!rL(this.projectionDelta.x,this.prevProjectionDelta.x)||!rL(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",v)),cm&&ch.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){var o;if((o=this.options.visualElement)===null||o===void 0||o.scheduleRender(),a){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Of(),this.projectionDelta=Of(),this.projectionDeltaWithTransform=Of()}setAnimationOrigin(a,o=!1){const l=this.snapshot,u=l?l.latestValues:{},h={...this.latestValues},f=Of();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const g=Dr(),y=l?l.source:void 0,v=this.layout?this.layout.source:void 0,x=y!==v,E=this.getStack(),T=!E||E.members.length<=1,b=!!(x&&!T&&this.options.crossfade===!0&&!this.path.some(cse));this.animationProgress=0;let I;this.mixTargetDelta=M=>{const F=M/1e3;oL(f.x,a.x,F),oL(f.y,a.y,F),this.setTargetDelta(f),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Cm(g,this.layout.layoutBox,this.relativeParent.layout.layoutBox),lse(this.relativeTarget,this.relativeTargetOrigin,g,F),I&&Hie(this.relativeTarget,I)&&(this.isProjectionDirty=!1),I||(I=Dr()),ma(I,this.relativeTarget)),x&&(this.animationValues=h,Gie(h,u,this.latestValues,F,b,T)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=F},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(mu(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=lr.update(()=>{W_.hasAnimatedSinceResize=!0,this.currentAnimation=Lie(0,iL,{...a,onUpdate:o=>{this.mixTargetDelta(o),a.onUpdate&&a.onUpdate(o)},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(iL),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:o,target:l,layout:u,latestValues:h}=a;if(!(!o||!l||!u)){if(this!==a&&this.layout&&u&&p9(this.options.animationType,this.layout.layoutBox,u.layoutBox)){l=this.target||Dr();const f=ra(this.layout.layoutBox.x);l.x.min=a.target.x.min,l.x.max=l.x.min+f;const g=ra(this.layout.layoutBox.y);l.y.min=a.target.y.min,l.y.max=l.y.min+g}ma(o,l),Ff(o,h),Rm(this.projectionDeltaWithTransform,this.layoutCorrected,o,h)}}registerSharedNode(a,o){this.sharedNodes.has(a)||this.sharedNodes.set(a,new Kie),this.sharedNodes.get(a).add(o);const u=o.options.initialPromotionConfig;o.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(o):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var a;const{layoutId:o}=this.options;return o?((a=this.getStack())===null||a===void 0?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:o}=this.options;return o?(a=this.getStack())===null||a===void 0?void 0:a.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:o,preserveFollowOpacity:l}={}){const u=this.getStack();u&&u.promote(this,l),a&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetSkewAndRotation(){const{visualElement:a}=this.options;if(!a)return;let o=!1;const{latestValues:l}=a;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(o=!0),!o)return;const u={};l.z&&RS("z",a,u,this.animationValues);for(let h=0;h<AS.length;h++)RS(`rotate${AS[h]}`,a,u,this.animationValues),RS(`skew${AS[h]}`,a,u,this.animationValues);a.render();for(const h in u)a.setStaticValue(h,u[h]),this.animationValues&&(this.animationValues[h]=u[h]);a.scheduleRender()}getProjectionStyles(a){var o,l;if(!this.instance||this.isSVG)return;if(!this.isVisible)return Xie;const u={visibility:""},h=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,u.opacity="",u.pointerEvents=z_(a?.pointerEvents)||"",u.transform=h?h(this.latestValues,""):"none",u;const f=this.getLead();if(!this.projectionDelta||!this.layout||!f.target){const x={};return this.options.layoutId&&(x.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,x.pointerEvents=z_(a?.pointerEvents)||""),this.hasProjected&&!lh(this.latestValues)&&(x.transform=h?h({},""):"none",this.hasProjected=!1),x}const g=f.animationValues||f.latestValues;this.applyTransformsToTarget(),u.transform=Yie(this.projectionDeltaWithTransform,this.treeScale,g),h&&(u.transform=h(g,u.transform));const{x:y,y:v}=this.projectionDelta;u.transformOrigin=`${y.origin*100}% ${v.origin*100}% 0`,f.animationValues?u.opacity=f===this?(l=(o=g.opacity)!==null&&o!==void 0?o:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:g.opacityExit:u.opacity=f===this?g.opacity!==void 0?g.opacity:"":g.opacityExit!==void 0?g.opacityExit:0;for(const x in Yx){if(g[x]===void 0)continue;const{correct:E,applyTo:T}=Yx[x],b=u.transform==="none"?g[x]:E(g[x],f);if(T){const I=T.length;for(let M=0;M<I;M++)u[T[M]]=b}else u[x]=b}return this.options.layoutId&&(u.pointerEvents=f===this?z_(a?.pointerEvents)||"":"none"),u}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var o;return(o=a.currentAnimation)===null||o===void 0?void 0:o.stop()}),this.root.nodes.forEach(sL),this.root.sharedNodes.clear()}}}function Zie(n){n.updateLayout()}function Qie(n){var e;const t=((e=n.resumeFrom)===null||e===void 0?void 0:e.snapshot)||n.snapshot;if(n.isLead()&&n.layout&&t&&n.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:i}=n.layout,{animationType:s}=n.options,a=t.source!==n.layout.source;s==="size"?ya(f=>{const g=a?t.measuredBox[f]:t.layoutBox[f],y=ra(g);g.min=r[f].min,g.max=g.min+y}):p9(s,t.layoutBox,r)&&ya(f=>{const g=a?t.measuredBox[f]:t.layoutBox[f],y=ra(r[f]);g.max=g.min+y,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[f].max=n.relativeTarget[f].min+y)});const o=Of();Rm(o,r,t.layoutBox);const l=Of();a?Rm(l,n.applyTransform(i,!0),t.measuredBox):Rm(l,r,t.layoutBox);const u=!d9(o);let h=!1;if(!n.resumeFrom){const f=n.getClosestProjectingParent();if(f&&!f.resumeFrom){const{snapshot:g,layout:y}=f;if(g&&y){const v=Dr();Cm(v,t.layoutBox,g.layoutBox);const x=Dr();Cm(x,r,y.layoutBox),f9(v,x)||(h=!0),f.options.layoutRoot&&(n.relativeTarget=x,n.relativeTargetOrigin=v,n.relativeParent=f)}}}n.notifyListeners("didUpdate",{layout:r,snapshot:t,delta:l,layoutDelta:o,hasLayoutChanged:u,hasRelativeTargetChanged:h})}else if(n.isLead()){const{onExitComplete:r}=n.options;r&&r()}n.options.transition=void 0}function Jie(n){cm&&ch.totalNodes++,n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function ese(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function tse(n){n.clearSnapshot()}function sL(n){n.clearMeasurements()}function nse(n){n.isLayoutDirty=!1}function rse(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function aL(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function ise(n){n.resolveTargetDelta()}function sse(n){n.calcProjection()}function ase(n){n.resetSkewAndRotation()}function ose(n){n.removeLeadSnapshot()}function oL(n,e,t){n.translate=Sr(e.translate,0,t),n.scale=Sr(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function lL(n,e,t,r){n.min=Sr(e.min,t.min,r),n.max=Sr(e.max,t.max,r)}function lse(n,e,t,r){lL(n.x,e.x,t.x,r),lL(n.y,e.y,t.y,r)}function cse(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const use={duration:.45,ease:[.4,0,.1,1]},cL=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),uL=cL("applewebkit/")&&!cL("chrome/")?Math.round:Js;function hL(n){n.min=uL(n.min),n.max=uL(n.max)}function hse(n){hL(n.x),hL(n.y)}function p9(n,e,t){return n==="position"||n==="preserve-aspect"&&!gie(nL(e),nL(t),.2)}function dse(n){var e;return n!==n.root&&((e=n.scroll)===null||e===void 0?void 0:e.wasRoot)}const fse=m9({attachResizeListener:(n,e)=>bp(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),CS={current:void 0},y9=m9({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!CS.current){const n=new fse({});n.mount(window),n.setOptions({layoutScroll:!0}),CS.current=n}return CS.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),gse={pan:{Feature:kie},drag:{Feature:Cie,ProjectionNode:y9,MeasureLayout:c9}};function dL(n,e,t){const{props:r}=n;n.animationState&&r.whileHover&&n.animationState.setActive("whileHover",t==="Start");const i="onHover"+t,s=r[i];s&&lr.postRender(()=>s(e,E1(e)))}class mse extends Au{mount(){const{current:e}=this.node;e&&(this.unmount=gne(e,t=>(dL(this.node,t,"Start"),r=>dL(this.node,r,"End"))))}unmount(){}}class pse extends Au{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=w1(bp(this.node.current,"focus",()=>this.onFocus()),bp(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function fL(n,e,t){const{props:r}=n;n.animationState&&r.whileTap&&n.animationState.setActive("whileTap",t==="Start");const i="onTap"+(t==="End"?"":t),s=r[i];s&&lr.postRender(()=>s(e,E1(e)))}class yse extends Au{mount(){const{current:e}=this.node;e&&(this.unmount=_ne(e,t=>(fL(this.node,t,"Start"),(r,{success:i})=>fL(this.node,r,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const xb=new WeakMap,kS=new WeakMap,_se=n=>{const e=xb.get(n.target);e&&e(n)},xse=n=>{n.forEach(_se)};function vse({root:n,...e}){const t=n||document;kS.has(t)||kS.set(t,{});const r=kS.get(t),i=JSON.stringify(e);return r[i]||(r[i]=new IntersectionObserver(xse,{root:n,...e})),r[i]}function wse(n,e,t){const r=vse(e);return xb.set(n,t),r.observe(n),()=>{xb.delete(n),r.unobserve(n)}}const Ese={some:0,all:1};class Sse extends Au{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:r,amount:i="some",once:s}=e,a={root:t?t.current:void 0,rootMargin:r,threshold:typeof i=="number"?i:Ese[i]},o=l=>{const{isIntersecting:u}=l;if(this.isInView===u||(this.isInView=u,s&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:h,onViewportLeave:f}=this.node.getProps(),g=u?h:f;g&&g(l)};return wse(this.node.current,a,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(Tse(e,t))&&this.startObserver()}unmount(){}}function Tse({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const bse={inView:{Feature:Sse},tap:{Feature:yse},focus:{Feature:pse},hover:{Feature:mse}},Ise={layout:{ProjectionNode:y9,MeasureLayout:c9}},vb={current:null},_9={current:!1};function Ase(){if(_9.current=!0,!!UA)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>vb.current=n.matches;n.addListener(e),e()}else vb.current=!1}const Rse=[...zj,Ui,pu],Cse=n=>Rse.find(Uj(n)),gL=new WeakMap;function kse(n,e,t){for(const r in e){const i=e[r],s=t[r];if(Ki(i))n.addValue(r,i);else if(Ki(s))n.addValue(r,Sp(i,{owner:n}));else if(s!==i)if(n.hasValue(r)){const a=n.getValue(r);a.liveStyle===!0?a.jump(i):a.hasAnimated||a.set(i)}else{const a=n.getStaticValue(r);n.addValue(r,Sp(a!==void 0?a:i,{owner:n}))}}for(const r in t)e[r]===void 0&&n.removeValue(r);return e}const mL=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class Pse{scrapeMotionValuesFromProps(e,t,r){return{}}constructor({parent:e,props:t,presenceContext:r,reducedMotionConfig:i,blockInitialAnimation:s,visualState:a},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=mR,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const y=Ho.now();this.renderScheduledAt<y&&(this.renderScheduledAt=y,lr.render(this.render,!1,!0))};const{latestValues:l,renderState:u,onUpdate:h}=a;this.onUpdate=h,this.latestValues=l,this.baseTarget={...l},this.initialValues=t.initial?{...l}:{},this.renderState=u,this.parent=e,this.props=t,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=o,this.blockInitialAnimation=!!s,this.isControllingVariants=Mw(t),this.isVariantNode=Z8(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:f,...g}=this.scrapeMotionValuesFromProps(t,{},this);for(const y in g){const v=g[y];l[y]!==void 0&&Ki(v)&&v.set(l[y],!1)}}mount(e){this.current=e,gL.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,r)=>this.bindToMotionValue(r,t)),_9.current||Ase(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:vb.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){gL.delete(this.current),this.projection&&this.projection.unmount(),mu(this.notifyUpdate),mu(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const r=yd.has(e),i=t.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&lr.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0)}),s=t.on("renderRequest",this.scheduleRender);let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{i(),s(),a&&a(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in C0){const t=C0[e];if(!t)continue;const{isEnabled:r,Feature:i}=t;if(!this.features[e]&&i&&r(this.props)&&(this.features[e]=new i(this)),this.features[e]){const s=this.features[e];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Dr()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let r=0;r<mL.length;r++){const i=mL[r];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const s="on"+i,a=e[s];a&&(this.propEventSubscriptions[i]=this.on(i,a))}this.prevMotionValues=kse(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const r=this.values.get(e);t!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&t!==void 0&&(r=Sp(t===null?void 0:t,{owner:this}),this.addValue(e,r)),r}readValue(e,t){var r;let i=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(r=this.getBaseTargetFromProps(this.props,e))!==null&&r!==void 0?r:this.readValueFromInstance(this.current,e,this.options);return i!=null&&(typeof i=="string"&&(Gj(i)||Pj(i))?i=parseFloat(i):!Cse(i)&&pu.test(t)&&(i=Fj(e,t)),this.setBaseTarget(e,Ki(i)?i.get():i)),Ki(i)?i.get():i}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;const{initial:r}=this.props;let i;if(typeof r=="string"||typeof r=="object"){const a=XA(this.props,r,(t=this.presenceContext)===null||t===void 0?void 0:t.custom);a&&(i=a[e])}if(r&&i!==void 0)return i;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!Ki(s)?s:this.initialValues[e]!==void 0&&i===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new cR),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}}class x9 extends Pse{constructor(){super(...arguments),this.KeyframeResolver=$j}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:r}){delete t[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Ki(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function Mse(n){return window.getComputedStyle(n)}class Nse extends x9{constructor(){super(...arguments),this.type="html",this.renderInstance=aj}readValueFromInstance(e,t){if(yd.has(t)){const r=gR(t);return r&&r.default||0}else{const r=Mse(e),i=(rj(t)?r.getPropertyValue(t):r[t])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:t}){return o9(e,t)}build(e,t,r){QA(e,t,r.transformTemplate)}scrapeMotionValuesFromProps(e,t,r){return nR(e,t,r)}}class Lse extends x9{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Dr}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(yd.has(t)){const r=gR(t);return r&&r.default||0}return t=oj.has(t)?t:HA(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,r){return uj(e,t,r)}build(e,t,r){JA(e,t,this.isSVGTag,r.transformTemplate)}renderInstance(e,t,r,i){lj(e,t,r,i)}mount(e){this.isSVGTag=tR(e.tagName),super.mount(e)}}const Ose=(n,e)=>YA(n)?new Lse(e):new Nse(e,{allowProjection:n!==ne.Fragment}),Dse=one({...sie,...bse,...gse,...Ise},Ose),Ct=Ete(Dse);const Fse=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),jse=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),pL=n=>{const e=jse(n);return e.charAt(0).toUpperCase()+e.slice(1)},v9=(...n)=>n.filter((e,t,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===t).join(" ").trim(),Vse=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var Gse={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Bse=ne.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:i="",children:s,iconNode:a,...o},l)=>ne.createElement("svg",{ref:l,...Gse,width:e,height:e,stroke:n,strokeWidth:r?Number(t)*24/Number(e):t,className:v9("lucide",i),...!s&&!Vse(o)&&{"aria-hidden":"true"},...o},[...a.map(([u,h])=>ne.createElement(u,h)),...Array.isArray(s)?s:[s]]));const dt=(n,e)=>{const t=ne.forwardRef(({className:r,...i},s)=>ne.createElement(Bse,{ref:s,iconNode:e,className:v9(`lucide-${Fse(pL(n))}`,`lucide-${n}`,r),...i}));return t.displayName=pL(n),t};const Use=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h2",key:"tvwodi"}],["path",{d:"M20 8v11a2 2 0 0 1-2 2h-2",key:"1gkqxj"}],["path",{d:"m9 15 3-3 3 3",key:"1pd0qc"}],["path",{d:"M12 12v9",key:"192myk"}]],zse=dt("archive-restore",Use);const $se=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],w9=dt("archive",$se);const Wse=[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Hse=dt("ban",Wse);const Kse=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],Yse=dt("book-open",Kse);const Xse=[["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M14 7a4 4 0 0 1 4 4v3a6 6 0 0 1-12 0v-3a4 4 0 0 1 4-4z",key:"uouzyp"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M21 21a4 4 0 0 0-3.81-4",key:"1b0z45"}],["path",{d:"M21 5a4 4 0 0 1-3.55 3.97",key:"5cxbf6"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M3 21a4 4 0 0 1 3.81-4",key:"1fjd4g"}],["path",{d:"M3 5a4 4 0 0 0 3.55 3.97",key:"1d7oge"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M9 7.13V6a3 3 0 1 1 6 0v1.13",key:"1vgav8"}]],E9=dt("bug",Xse);const qse=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Zse=dt("calendar",qse);const Qse=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],xR=dt("camera",Qse);const Jse=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],S9=dt("chart-column",Jse);const eae=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Wl=dt("check",eae);const tae=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],vR=dt("chevron-down",tae);const nae=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],rae=dt("chevron-left",nae);const iae=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Ow=dt("chevron-right",iae);const sae=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],T9=dt("chevron-up",sae);const aae=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],b9=dt("circle-alert",aae);const oae=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],lae=dt("circle-check-big",oae);const cae=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],uae=dt("clock",cae);const hae=[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5.782 5.782A7 7 0 0 0 9 19h8.5a4.5 4.5 0 0 0 1.307-.193",key:"yfwify"}],["path",{d:"M21.532 16.5A4.5 4.5 0 0 0 17.5 10h-1.79A7.008 7.008 0 0 0 10 5.07",key:"jlfiyv"}]],dae=dt("cloud-off",hae);const fae=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]],wb=dt("cloud",fae);const gae=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],mae=dt("code",gae);const pae=[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],yae=dt("compass",pae);const _ae=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"22",x2:"18",y1:"12",y2:"12",key:"l9bcsi"}],["line",{x1:"6",x2:"2",y1:"12",y2:"12",key:"13hhkx"}],["line",{x1:"12",x2:"12",y1:"6",y2:"2",key:"10w3f3"}],["line",{x1:"12",x2:"12",y1:"22",y2:"18",key:"15g9kq"}]],Eb=dt("crosshair",_ae);const xae=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Sb=dt("download",xae);const vae=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],S1=dt("external-link",vae);const wae=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],I9=dt("eye-off",wae);const Eae=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],A9=dt("eye",Eae);const Sae=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],R9=dt("file-text",Sae);const Tae=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],bae=dt("folder-open",Tae);const Iae=[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],Aae=dt("folder-plus",Iae);const Rae=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],Cae=dt("folder",Rae);const kae=[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]],Pae=dt("gauge",kae);const Mae=[["path",{d:"M10.5 3 8 9l4 13 4-13-2.5-6",key:"b3dvk1"}],["path",{d:"M17 3a2 2 0 0 1 1.6.8l3 4a2 2 0 0 1 .013 2.382l-7.99 10.986a2 2 0 0 1-3.247 0l-7.99-10.986A2 2 0 0 1 2.4 7.8l2.998-3.997A2 2 0 0 1 7 3z",key:"7w4byz"}],["path",{d:"M2 9h20",key:"16fsjt"}]],Nae=dt("gem",Mae);const Lae=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],Oae=dt("grid-3x3",Lae);const Dae=[["path",{d:"M16 5h6",key:"1vod17"}],["path",{d:"M19 2v6",key:"4bpg5p"}],["path",{d:"M21 11.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7.5",key:"1ue2ih"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}]],Fae=dt("image-plus",Dae);const jae=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],C9=dt("info",jae);const Vae=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],io=dt("layers",Vae);const Gae=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],Bae=dt("list",Gae);const Uae=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],wR=dt("loader-circle",Uae);const zae=[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],$ae=dt("locate-fixed",zae);const Wae=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],Tb=dt("lock",Wae);const Hae=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],ER=dt("log-out",Hae);const Kae=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Hl=dt("map-pin",Kae);const Yae=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],SR=dt("map",Yae);const Xae=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],qae=dt("menu",Xae);const Zae=[["path",{d:"M5 12h14",key:"1ays0h"}]],Qae=dt("minus",Zae);const Jae=[["path",{d:"m8 3 4 8 5-5 5 15H2L8 3z",key:"otkl63"}]],bb=dt("mountain",Jae);const eoe=[["path",{d:"M12.586 12.586 19 19",key:"ea5xo7"}],["path",{d:"M3.688 3.037a.497.497 0 0 0-.651.651l6.5 15.999a.501.501 0 0 0 .947-.062l1.569-6.083a2 2 0 0 1 1.448-1.479l6.124-1.579a.5.5 0 0 0 .063-.947z",key:"277e5u"}]],toe=dt("mouse-pointer",eoe);const noe=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],TR=dt("navigation",noe);const roe=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],ioe=dt("pause",roe);const soe=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],yL=dt("pen-line",soe);const aoe=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],ooe=dt("pen",aoe);const loe=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Ip=dt("pencil",loe);const coe=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],uoe=dt("play",coe);const hoe=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],co=dt("plus",hoe);const doe=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],foe=dt("rotate-ccw",doe);const goe=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],moe=dt("rotate-cw",goe);const poe=[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]],k9=dt("route",poe);const yoe=[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]],P9=dt("ruler",yoe);const _oe=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],M9=dt("save",_oe);const xoe=[["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"m19 8 3 8a5 5 0 0 1-6 0zV7",key:"zcdpyk"}],["path",{d:"M3 7h1a17 17 0 0 0 8-2 17 17 0 0 0 8 2h1",key:"1yorad"}],["path",{d:"m5 8 3 8a5 5 0 0 1-6 0zV7",key:"eua70x"}],["path",{d:"M7 21h10",key:"1b0cd5"}]],voe=dt("scale",xoe);const woe=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Ib=dt("search",woe);const Eoe=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Ab=dt("settings",Eoe);const Soe=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],Toe=dt("settings-2",Soe);const boe=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],Ioe=dt("shield",boe);const Aoe=[["path",{d:"M10 5H3",key:"1qgfaw"}],["path",{d:"M12 19H3",key:"yhmn1j"}],["path",{d:"M14 3v4",key:"1sua03"}],["path",{d:"M16 17v4",key:"1q0r14"}],["path",{d:"M21 12h-9",key:"1o4lsq"}],["path",{d:"M21 19h-5",key:"1rlt1p"}],["path",{d:"M21 5h-7",key:"1oszz2"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M8 12H3",key:"a7s4jb"}]],Roe=dt("sliders-horizontal",Aoe);const Coe=[["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M12 21v-9",key:"17s77i"}],["path",{d:"M12 8V3",key:"13r4qs"}],["path",{d:"M17 16h4",key:"h1uq16"}],["path",{d:"M19 12V3",key:"o1uvq1"}],["path",{d:"M19 21v-5",key:"qua636"}],["path",{d:"M3 14h4",key:"bcjad9"}],["path",{d:"M5 10V3",key:"cb8scm"}],["path",{d:"M5 21v-7",key:"1w1uti"}]],koe=dt("sliders-vertical",Coe);const Poe=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],Moe=dt("smartphone",Poe);const Noe=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],Loe=dt("square",Noe);const Ooe=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],Doe=dt("tag",Ooe);const Foe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],joe=dt("target",Foe);const Voe=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],_d=dt("trash-2",Voe);const Goe=[["path",{d:"M13 8c0-2.76-2.46-5-5.5-5S2 5.24 2 8h2l1-1 1 1h4",key:"foxbe7"}],["path",{d:"M13 7.14A5.82 5.82 0 0 1 16.5 6c3.04 0 5.5 2.24 5.5 5h-3l-1-1-1 1h-3",key:"18arnh"}],["path",{d:"M5.89 9.71c-2.15 2.15-2.3 5.47-.35 7.43l4.24-4.25.7-.7.71-.71 2.12-2.12c-1.95-1.96-5.27-1.8-7.42.35",key:"ywahnh"}],["path",{d:"M11 15.5c.5 2.5-.17 4.5-1 6.5h4c2-5.5-.5-12-1-14",key:"ft0feo"}]],Boe=dt("tree-palm",Goe);const Uoe=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],zoe=dt("type",Uoe);const $oe=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Dw=dt("upload",$oe);const Woe=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],bR=dt("user",Woe);const Hoe=[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]],Koe=dt("waves",Hoe);const Yoe=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Ni=dt("x",Yoe);function Xoe(){const{tracking:n,startTracking:e,stopTracking:t,updatePosition:r,setWatchId:i,resetFirstFix:s}=ss(),a=ne.useCallback(l=>{r(l)},[r]),o=ne.useCallback(l=>{console.error("GPS error:",l),alert(`GPS fout: ${l.message}`),t()},[t]);return ne.useEffect(()=>{if(!n)return;if(!navigator.geolocation){alert("Geolocation wordt niet ondersteund door deze browser"),t();return}const l=navigator.geolocation.watchPosition(a,o,{enableHighAccuracy:!0,maximumAge:1e3,timeout:15e3});return i(l),()=>{navigator.geolocation.clearWatch(l)}},[n,a,o,i,t]),{tracking:n,start:e,stop:t,toggle:()=>n?t():e()}}function qoe(){const{tracking:n,toggle:e}=Xoe();return m.jsx(Ct.button,{className:`
        fixed bottom-2 right-2 z-[1000]
        w-11 h-11 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${n?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},animate:n?{scale:[1,1.02,1]}:{},transition:n?{scale:{duration:2,repeat:1/0,ease:"easeInOut"}}:{},"aria-label":n?"GPS tracking actief":"GPS tracking starten",title:n?"GPS tracking actief":"GPS tracking starten",children:m.jsx($ae,{size:22,strokeWidth:2})})}const Zoe="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48">
    <polygon points="24,6 38,38 24,30 10,38" fill="#4285F4" stroke="white" stroke-width="3" stroke-linejoin="round"/>
  </svg>`);function Qoe(){const n=Ji(y=>y.map),e=ss(y=>y.position),t=ss(y=>y.accuracy),r=ss(y=>y.tracking),i=ss(y=>y.smoothHeading),s=Mr(y=>y.showAccuracyCircle),a=ss(y=>y.firstFix),o=ss(y=>y.resetFirstFix),l=ss(y=>y.config.centerOnUser),u=ne.useRef(null),h=ne.useRef(null),f=ne.useRef(null),g=ne.useMemo(()=>y=>new $n({image:new qp({src:Zoe,scale:.9,rotation:y,rotateWithView:!1,anchor:[.5,.5]})}),[]);return ne.useEffect(()=>{if(!n||!r&&!e)return;const y=oo([5.1214,52.0907]);return u.current=new Cs({geometry:new ds(y)}),u.current.setStyle(g(0)),h.current=new Cs({geometry:new ds(y)}),f.current=new F0({source:new O0({features:[h.current,u.current]}),zIndex:1e3}),n.addLayer(f.current),()=>{f.current&&n&&n.removeLayer(f.current)}},[n,r,e,g]),ne.useEffect(()=>{if(!n||!e||!u.current||!h.current)return;const y=oo([e.lng,e.lat]);if(u.current.getGeometry()?.setCoordinates(y),h.current.getGeometry()?.setCoordinates(y),s&&t){const v=n.getView().getResolution()||1,x=Math.min(t/v,80);h.current.setStyle(new $n({image:new ka({radius:x,fill:new kr({color:"rgba(66, 133, 244, 0.12)"})})}))}else h.current.setStyle(new $n({}));if(a&&r){n.getView().setCenter(y),n.getView().setZoom(17),o();return}r&&l&&!a&&n.getView().animate({center:y,duration:150})},[n,r,e,t,a,o,l,s]),ne.useEffect(()=>{if(!u.current)return;const y=i!==null?i*Math.PI/180:0;u.current.setStyle(g(y))},[i,g]),null}function Joe(){const n=jr(t=>t.themesPanelOpen),e=jr(t=>t.toggleThemesPanel);return m.jsx(Ct.button,{className:`
        fixed bottom-[60px] right-2 z-[1000]
        w-11 h-11 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${n?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":n?"Kaartlagen sluiten":"Kaartlagen openen",title:"Kaartlagen",children:m.jsx(SR,{size:22,strokeWidth:2})})}function ele(){return m.jsx(Joe,{})}const c_=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899"],Fc=["Mineraal","Fossiel","Erfgoed","Monument","Overig"],Ka="default-vondsten",N9={id:Ka,name:"Mijn vondsten",color:"#f97316",categories:["Munt","Aardewerk","Gesp","Fibula","Ring","Speld","Sieraad","Gereedschap","Wapen","Anders"],points:[],visible:!0,archived:!1,createdAt:new Date().toISOString()},tle=n=>n.some(t=>t.id===Ka)?n:[{...N9,createdAt:new Date().toISOString()},...n],Xi=sa()(pd((n,e)=>({layers:[{...N9}],colorIndex:0,addLayer:(t,r=Fc)=>{const i=crypto.randomUUID(),s=c_[e().colorIndex%c_.length];return n(a=>({layers:[...a.layers,{id:i,name:t,color:s,categories:[...r],points:[],visible:!0,archived:!1,createdAt:new Date().toISOString()}],colorIndex:a.colorIndex+1})),i},removeLayer:t=>{n(r=>({layers:r.layers.filter(i=>i.id!==t)}))},updateLayer:(t,r)=>{n(i=>({layers:i.layers.map(s=>s.id===t?{...s,...r}:s)}))},toggleVisibility:t=>{n(r=>({layers:r.layers.map(i=>i.id===t?{...i,visible:!i.visible}:i)}))},toggleArchived:t=>{n(r=>({layers:r.layers.map(i=>i.id===t?{...i,archived:!i.archived,visible:i.archived?i.visible:!1}:i)}))},addPoint:(t,r)=>{const i={...r,status:r.status||"todo",id:crypto.randomUUID(),createdAt:new Date().toISOString()};n(s=>({layers:s.layers.map(a=>a.id===t?{...a,points:[...a.points,i]}:a)}))},removePoint:(t,r)=>{n(i=>({layers:i.layers.map(s=>s.id===t?{...s,points:s.points.filter(a=>a.id!==r)}:s)}))},updatePoint:(t,r,i)=>{n(s=>({layers:s.layers.map(a=>a.id===t?{...a,points:a.points.map(o=>o.id===r?{...o,...i}:o)}:a)}))},setPointStatus:(t,r,i)=>{n(s=>({layers:s.layers.map(a=>a.id===t?{...a,points:a.points.map(o=>o.id===r?{...o,status:i}:o)}:a)}))},addCategory:(t,r)=>{n(i=>({layers:i.layers.map(s=>s.id===t&&!s.categories.includes(r)?{...s,categories:[...s.categories,r]}:s)}))},removeCategory:(t,r)=>{n(i=>({layers:i.layers.map(s=>s.id===t?{...s,categories:s.categories.filter(a=>a!==r)}:s)}))},addPhotoToPoint:(t,r,i)=>{n(s=>({layers:s.layers.map(a=>a.id===t?{...a,points:a.points.map(o=>o.id===r?{...o,photos:[...o.photos||[],i]}:o)}:a)}))},removePhotoFromPoint:(t,r,i)=>{n(s=>({layers:s.layers.map(a=>a.id===t?{...a,points:a.points.map(o=>o.id===r?{...o,photos:(o.photos||[]).filter(l=>l.id!==i)}:o)}:a)}))},updatePhotoInPoint:(t,r,i,s)=>{n(a=>({layers:a.layers.map(o=>o.id===t?{...o,points:o.points.map(l=>l.id===r?{...l,photos:(l.photos||[]).map(u=>u.id===i?{...u,...s}:u)}:l)}:o)}))},exportLayerAsGeoJSON:t=>{const r=e().layers.find(l=>l.id===t);if(!r)return;const i={type:"FeatureCollection",properties:{name:r.name,color:r.color,categories:r.categories,createdAt:r.createdAt,exportedAt:new Date().toISOString()},features:r.points.map(l=>({type:"Feature",geometry:{type:"Point",coordinates:l.coordinates},properties:{id:l.id,name:l.name,category:l.category,notes:l.notes,url:l.url,status:l.status,sourceLayer:l.sourceLayer,sourceId:l.sourceId,photos:l.photos,createdAt:l.createdAt}}))},s=new Blob([JSON.stringify(i,null,2)],{type:"application/geo+json"}),a=URL.createObjectURL(s),o=document.createElement("a");o.href=a,o.download=`${r.name.replace(/[^a-zA-Z0-9]/g,"-")}-${new Date().toISOString().split("T")[0]}.geojson`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(a)},importLayerFromGeoJSON:t=>{try{const r=JSON.parse(t);if(r.type!=="FeatureCollection")return{success:!1,error:"Ongeldig GeoJSON formaat"};const i=r.properties||{},s=i.name||`Gemporteerd ${new Date().toLocaleDateString("nl-NL")}`,a=i.categories||Fc,o=i.color||c_[e().colorIndex%c_.length],l=(r.features||[]).filter(h=>h.geometry?.type==="Point").map(h=>({id:h.properties?.id||crypto.randomUUID(),name:h.properties?.name||"Naamloos",category:h.properties?.category||"Overig",notes:h.properties?.notes||"",url:h.properties?.url,status:h.properties?.status||"todo",sourceLayer:h.properties?.sourceLayer,sourceId:h.properties?.sourceId,photos:h.properties?.photos,coordinates:h.geometry.coordinates,createdAt:h.properties?.createdAt||new Date().toISOString()})),u=crypto.randomUUID();return n(h=>({layers:[...h.layers,{id:u,name:s,color:o,categories:a,points:l,visible:!0,archived:!1,createdAt:new Date().toISOString()}],colorIndex:h.colorIndex+1})),{success:!0,layerId:u}}catch{return{success:!1,error:"Fout bij parsen van GeoJSON"}}},getLayer:t=>e().layers.find(r=>r.id===t),getActiveLayerCount:()=>e().layers.filter(t=>!t.archived).length,getArchivedLayerCount:()=>e().layers.filter(t=>t.archived).length,clearAll:()=>{n(t=>({layers:t.layers.map(r=>r.id===Ka?{...r,points:[]}:r).filter(r=>r.id===Ka),colorIndex:0}))}}),{name:"detectorapp-custom-point-layers",version:3,migrate:(n,e)=>{const t=n;return e<2?{...t,layers:tle(t.layers||[])}:e<3?{...t,layers:(t.layers||[]).map(r=>r.id===Ka?{...r,name:"Mijn vondsten"}:r)}:t}}));function Jr({title:n,children:e,defaultExpanded:t=!0,layerNames:r}){const[i,s]=ne.useState(t),a=fi(E=>E.visible),o=fi(E=>E.setLayerVisibility),l=jA(E=>E.isLayerUnlocked),u=E=>{const T=qv[E],b=T?.tier??"free",I=T?.regions??["nl"];return l(E,b,I)},h=r?.filter(E=>u(E))||[],f=h.filter(E=>a[E]).length,g=h.length,y=g>0&&f===g,v=f>0&&f<g,x=E=>{if(E.stopPropagation(),!r||h.length===0)return;const T=!y;h.forEach(b=>{o(b,T)})};return m.jsxs("div",{className:"mb-0.5",children:[m.jsxs("div",{className:"flex items-center gap-1 py-1 px-1 hover:bg-blue-50 transition-colors",children:[m.jsxs("button",{onClick:E=>{E.stopPropagation(),s(!i)},className:"flex-1 flex items-center gap-1 bg-transparent border-0 outline-none text-left",style:{fontSize:"inherit"},children:[m.jsx(Ct.span,{animate:{rotate:i?90:0},transition:{duration:.15},className:"text-gray-400",children:m.jsx(Ow,{size:14})}),i?m.jsx(bae,{size:16,className:"text-blue-500"}):m.jsx(Cae,{size:16,className:"text-blue-500"}),m.jsx("span",{className:"text-gray-700 font-medium",style:{fontSize:"1em"},children:n}),f>0&&m.jsx("span",{className:"ml-1 px-1.5 py-0.5 font-medium bg-blue-100 text-blue-600 rounded-full",style:{fontSize:"0.7em"},children:f})]}),r&&r.length>0&&m.jsx("button",{onClick:x,className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:y?"#3b82f6":v?"#93c5fd":"white",border:y?"2px solid #3b82f6":"2px solid #60a5fa",color:"white"},children:(y||v)&&m.jsx("svg",{width:"10",height:"10",viewBox:"0 0 10 10",children:m.jsx("path",{d:"M2 5 L4 7 L8 3",stroke:"currentColor",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),m.jsx(mr,{initial:!1,children:i&&m.jsx(Ct.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.15},style:{overflow:"hidden"},className:"ml-5",children:e})})]})}function lt({name:n,type:e,hasOverlay:t}){const r=fi(I=>I.visible[n]),i=fi(I=>I.visible["Labels Overlay"]),s=fi(I=>I.loadingState[n]),a=fi(I=>I.toggleLayer),o=fi(I=>I.setLayerVisibility),l=jA(I=>I.isLayerUnlocked),u=s==="loading",h=s==="error",f=qv[n],g=f?.tier??"free",y=f?.regions??["nl"],x=!l(n,g,y),E=I=>{I.stopPropagation(),!(u||x)&&(e==="overlay"?a(n):["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"].forEach(F=>{o(F,F===n)}))},T=I=>{I.stopPropagation(),o("Labels Overlay",!i)},b=r??!1;return m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsxs("button",{onClick:E,disabled:u||x,className:`flex-1 flex items-center justify-between py-1 pl-3 pr-2 border-0 outline-none transition-colors text-left ${x?"opacity-50 cursor-not-allowed bg-gray-50":u?"opacity-70 cursor-wait bg-transparent":b?"bg-blue-50 hover:bg-blue-100":"bg-transparent hover:bg-blue-50"}`,style:{fontSize:"inherit"},title:x?"Premium laag - upgrade om te ontgrendelen":void 0,children:[m.jsxs("span",{className:`flex items-center gap-1 ${h?"text-red-500":x?"text-gray-400":"text-gray-600"}`,children:[n,h&&m.jsx(b9,{size:12,className:"text-red-500"}),x&&m.jsx(Tb,{size:12,className:"text-amber-500"})]}),m.jsx("div",{className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:x?"#e5e7eb":u?"#93c5fd":b?"#3b82f6":"white",border:x?"2px solid #d1d5db":u?"2px solid #93c5fd":b?"2px solid #3b82f6":"2px solid #60a5fa",color:"white"},children:x?m.jsx(Tb,{size:10,strokeWidth:3,className:"text-gray-400"}):u?m.jsx(wR,{size:10,strokeWidth:3,className:"animate-spin"}):b?m.jsx(Wl,{size:12,strokeWidth:3}):null})]}),t&&b&&m.jsx("button",{onClick:T,className:`p-1 rounded transition-colors border-0 outline-none ${i?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-400 hover:bg-gray-200"}`,title:i?"Labels verbergen":"Labels tonen",children:m.jsx(Doe,{size:12})})]})}const nle=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899","#6b7280"];function L9({layer:n,compact:e=!1}){const{toggleVisibility:t,removeLayer:r,updateLayer:i,setColor:s}=_1(),[a,o]=ne.useState(!1),[l,u]=ne.useState(!1),[h,f]=ne.useState(n.name),[g,y]=ne.useState(!1),v=ne.useRef(null),x=ne.useRef(null),E=n.features.features.length,T=[...new Set(n.features.features.map(P=>P.geometry?.type).filter(Boolean))];ne.useEffect(()=>{l&&v.current&&(v.current.focus(),v.current.select())},[l]),ne.useEffect(()=>{const P=C=>{x.current&&!x.current.contains(C.target)&&y(!1)};if(g)return document.addEventListener("mousedown",P),()=>document.removeEventListener("mousedown",P)},[g]);const b=()=>{a?r(n.id):(o(!0),setTimeout(()=>o(!1),3e3))},I=()=>{const P=h.trim();P&&P!==n.name&&i(n.id,{name:P}),u(!1)},M=()=>{f(n.name),u(!1)},F=P=>{P.key==="Enter"?I():P.key==="Escape"&&M()},z=P=>{s(n.id,P),y(!1)};return e?m.jsxs("div",{className:"flex items-center gap-1 py-0.5 px-1 hover:bg-blue-50 transition-colors rounded",children:[m.jsx("button",{onClick:()=>t(n.id),className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:n.visible?n.color:"white",border:`2px solid ${n.color}`},title:n.visible?"Verbergen":"Tonen",children:n.visible&&m.jsx("svg",{width:"10",height:"10",viewBox:"0 0 10 10",children:m.jsx("path",{d:"M2 5 L4 7 L8 3",stroke:"white",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})})}),m.jsx("span",{className:"text-gray-700 truncate flex-1 cursor-pointer",style:{fontSize:"0.9em"},onClick:()=>t(n.id),children:n.name}),m.jsx("span",{className:"text-[10px] text-gray-400 flex-shrink-0",children:E})]}):m.jsxs("div",{className:"flex items-center justify-between py-1.5 group",children:[m.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[m.jsxs("div",{className:"relative",ref:x,children:[m.jsx("button",{onClick:()=>y(!g),className:"w-5 h-5 rounded border-2 border-white shadow-sm flex-shrink-0 hover:scale-110 transition-transform",style:{backgroundColor:n.color},title:"Kleur wijzigen"}),g&&m.jsx("div",{className:"absolute top-6 left-0 z-50 bg-white rounded-lg shadow-lg border p-2 grid grid-cols-3 gap-1",children:nle.map(P=>m.jsx("button",{onClick:()=>z(P),className:`w-6 h-6 rounded border-2 transition-transform hover:scale-110 ${P===n.color?"border-gray-800 scale-110":"border-white"}`,style:{backgroundColor:P},title:P},P))})]}),m.jsx("div",{className:"flex-1 min-w-0",children:l?m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx("input",{ref:v,type:"text",value:h,onChange:P=>f(P.target.value),onKeyDown:F,className:"flex-1 text-sm px-1 py-0.5 border rounded min-w-0"}),m.jsx("button",{onClick:I,className:"p-0.5 text-green-600 hover:bg-green-50 rounded",title:"Opslaan",children:m.jsx(Wl,{size:14})}),m.jsx("button",{onClick:M,className:"p-0.5 text-gray-400 hover:bg-gray-100 rounded",title:"Annuleren",children:m.jsx(Ni,{size:14})})]}):m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx("span",{className:"text-sm text-gray-700 truncate",children:n.name}),m.jsx("button",{onClick:()=>u(!0),className:"p-0.5 text-gray-400 hover:text-blue-500 opacity-0 group-hover:opacity-100 transition-opacity",title:"Naam wijzigen",children:m.jsx(Ip,{size:12})})]}),m.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-400",children:[m.jsxs("span",{children:[E," ",E===1?"feature":"features"]}),T.length>0&&m.jsxs(m.Fragment,{children:[m.jsx("span",{className:"mx-0.5",children:""}),m.jsx("span",{children:T.join(", ")})]})]})]})})]}),m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx("button",{onClick:()=>t(n.id),className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:n.visible?n.color:"white",border:`2px solid ${n.visible?n.color:"#9ca3af"}`},title:n.visible?"Verbergen":"Tonen",children:n.visible&&m.jsx("svg",{width:"10",height:"10",viewBox:"0 0 10 10",children:m.jsx("path",{d:"M2 5 L4 7 L8 3",stroke:"white",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})})}),m.jsx("button",{onClick:b,className:`p-1 rounded transition-colors border-0 outline-none ${a?"text-white bg-red-500 hover:bg-red-600":"text-gray-400 hover:text-red-500 hover:bg-red-50"}`,title:a?"Klik nogmaals om te verwijderen":"Verwijderen",children:m.jsx(_d,{size:14})})]})]})}function rle(){const{themesPanelOpen:n,toggleThemesPanel:e,toggleSettingsPanel:t}=jr(),{layers:r,toggleVisibility:i}=Xi(),s=_1(h=>h.layers),a=ne.useRef(null),o=Mr(h=>h.layerPanelFontScale),l=Mr(h=>h.setLayerPanelFontScale),u=13*o/100;return ne.useEffect(()=>{if(!n)return;const h=g=>{a.current&&!a.current.contains(g.target)&&e()},f=setTimeout(()=>{document.addEventListener("click",h)},100);return()=>{clearTimeout(f),document.removeEventListener("click",h)}},[n,e]),m.jsx(mr,{children:n&&m.jsxs(Ct.div,{ref:a,className:"fixed top-2.5 right-2 z-[1101] bg-white rounded-lg shadow-lg overflow-hidden w-[300px] max-h-[calc(100vh-200px)] flex flex-col",initial:{opacity:0,x:10},animate:{opacity:1,x:0},exit:{opacity:0,x:10},transition:{duration:.15},children:[m.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-blue-500",style:{fontSize:`${u}px`},children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(io,{size:14,className:"text-white"}),m.jsx("span",{className:"font-medium text-white",children:"Kaartlagen"})]}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("span",{className:"text-[10px] text-blue-200",children:"T"}),m.jsx("input",{type:"range",min:"80",max:"130",step:"10",value:o,onInput:h=>{l(parseInt(h.target.value))},onChange:h=>l(parseInt(h.target.value)),className:"w-20 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${o}%`}),m.jsx("span",{className:"text-xs text-blue-200",children:"T"}),m.jsx("button",{onClick:e,className:"p-0.5 rounded border-0 outline-none bg-blue-400/50 hover:bg-blue-400 transition-colors ml-1",children:m.jsx(Ni,{size:16,className:"text-white",strokeWidth:2.5})})]})]}),m.jsxs("div",{className:"p-2 overflow-y-auto flex-1",style:{fontSize:`${u}px`},children:[r.filter(h=>!h.archived).length>0&&m.jsxs("div",{className:"mb-2 pb-1 border-b border-gray-100",children:[m.jsx("div",{className:"flex items-center gap-1 py-0.5 px-1 mb-1",children:m.jsx("span",{className:"text-orange-600 font-medium",style:{fontSize:"0.9em"},children:"Mijn lagen"})}),r.filter(h=>!h.archived).map(h=>m.jsxs("button",{onClick:f=>{f.stopPropagation(),i(h.id)},className:`w-full flex items-center justify-between py-1 pl-3 pr-2 border-0 outline-none transition-colors text-left ${h.visible?"bg-orange-50 hover:bg-orange-100":"bg-transparent hover:bg-orange-50"}`,style:{fontSize:"inherit"},children:[m.jsxs("span",{className:"flex items-center gap-2 text-gray-600",children:[h.name,m.jsxs("span",{className:"text-xs text-gray-400",children:["(",h.points.length,")"]})]}),m.jsx("div",{className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:h.visible?"#f97316":"white",border:h.visible?"2px solid #f97316":"2px solid #fb923c",color:"white"},children:h.visible&&m.jsx(Wl,{size:12,strokeWidth:3})})]},h.id))]}),s.length>0&&m.jsxs("div",{className:"mb-2 pb-1 border-b border-gray-100",children:[m.jsxs("div",{className:"flex items-center gap-1 py-0.5 px-1 mb-1",children:[m.jsx(Dw,{size:12,className:"text-cyan-600"}),m.jsx("span",{className:"text-cyan-600 font-medium",style:{fontSize:"0.9em"},children:"Gemporteerde lagen"})]}),s.map(h=>m.jsx(L9,{layer:h,compact:!0},h.id)),m.jsx("button",{onClick:()=>{e(),t()},className:"w-full text-left py-1 pl-3 text-xs text-cyan-500 hover:text-cyan-700 hover:bg-cyan-50 transition-colors",children:"+ Laag importeren..."})]}),m.jsxs("div",{className:"mb-2",children:[m.jsx("div",{className:"flex items-center gap-1 py-1 px-1 mb-1",children:m.jsx("span",{className:"text-blue-600 font-medium",style:{fontSize:"0.95em"},children:"Basislaag"})}),m.jsxs("div",{className:"space-y-0",children:[m.jsx(lt,{name:"CartoDB (licht)",type:"base"}),m.jsx(lt,{name:"OpenStreetMap",type:"base"}),m.jsx(lt,{name:"Luchtfoto",type:"base",hasOverlay:!0}),m.jsx(lt,{name:"TMK 1850",type:"base",hasOverlay:!0}),m.jsx(lt,{name:"Bonnebladen 1900",type:"base",hasOverlay:!0})]})]}),m.jsxs("div",{className:"mb-2",children:[m.jsx("div",{className:"flex items-center gap-1 py-1 px-1 mb-1 border-t border-gray-100 pt-2",children:m.jsx("span",{className:"text-blue-600 font-medium",style:{fontSize:"0.95em"},children:"Thema's"})}),m.jsxs(Jr,{title:"Steentijd & Prehistorie",defaultExpanded:!1,layerNames:["Hunebedden","FAMKE Steentijd","Grafheuvels","Terpen","Paleokaart 9000 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 500 v.Chr.","Paleokaart 100 n.Chr.","Paleokaart 800 n.Chr."],children:[m.jsx(lt,{name:"Hunebedden",type:"overlay"}),m.jsx(lt,{name:"FAMKE Steentijd",type:"overlay"}),m.jsx(lt,{name:"Grafheuvels",type:"overlay"}),m.jsx(lt,{name:"Terpen",type:"overlay"}),m.jsxs(Jr,{title:"Paleokaarten",defaultExpanded:!1,layerNames:["Paleokaart 9000 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 500 v.Chr.","Paleokaart 100 n.Chr.","Paleokaart 800 n.Chr."],children:[m.jsx(lt,{name:"Paleokaart 9000 v.Chr.",type:"overlay"}),m.jsx(lt,{name:"Paleokaart 5500 v.Chr.",type:"overlay"}),m.jsx(lt,{name:"Paleokaart 2750 v.Chr.",type:"overlay"}),m.jsx(lt,{name:"Paleokaart 1500 v.Chr.",type:"overlay"}),m.jsx(lt,{name:"Paleokaart 500 v.Chr.",type:"overlay"}),m.jsx(lt,{name:"Paleokaart 100 n.Chr.",type:"overlay"}),m.jsx(lt,{name:"Paleokaart 800 n.Chr.",type:"overlay"})]})]}),m.jsxs(Jr,{title:"Archeologische lagen",defaultExpanded:!1,layerNames:["AMK Monumenten","AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig","Archeo Onderzoeken","Romeinse wegen (regio)","Romeinse wegen (Wereld)","Romeinse Forten","Romeinse Forten Lijnen","IKAW","Archeo Landschappen","UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling"],children:[m.jsx(lt,{name:"AMK Monumenten",type:"overlay"}),m.jsxs(Jr,{title:"AMK per periode",defaultExpanded:!1,layerNames:["AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig"],children:[m.jsx(lt,{name:"AMK Romeins",type:"overlay"}),m.jsx(lt,{name:"AMK Steentijd",type:"overlay"}),m.jsx(lt,{name:"AMK Vroege ME",type:"overlay"}),m.jsx(lt,{name:"AMK Late ME",type:"overlay"}),m.jsx(lt,{name:"AMK Overig",type:"overlay"})]}),m.jsx(lt,{name:"Archeo Onderzoeken",type:"overlay"}),m.jsxs(Jr,{title:"Romeinse tijd",defaultExpanded:!1,layerNames:["Romeinse wegen (regio)","Romeinse wegen (Wereld)","Romeinse Forten","Romeinse Forten Lijnen"],children:[m.jsxs(Jr,{title:"Romeinse wegen",defaultExpanded:!1,layerNames:["Romeinse wegen (regio)","Romeinse wegen (Wereld)"],children:[m.jsx(lt,{name:"Romeinse wegen (regio)",type:"overlay"}),m.jsx(lt,{name:"Romeinse wegen (Wereld)",type:"overlay"})]}),m.jsxs(Jr,{title:"Romeinse forten",defaultExpanded:!1,layerNames:["Romeinse Forten","Romeinse Forten Lijnen"],children:[m.jsx(lt,{name:"Romeinse Forten",type:"overlay"}),m.jsx(lt,{name:"Romeinse Forten Lijnen",type:"overlay"})]})]}),m.jsx(lt,{name:"IKAW",type:"overlay"}),m.jsx(lt,{name:"Archeo Landschappen",type:"overlay"}),m.jsxs(Jr,{title:"Verwachtingen uiterwaarden",defaultExpanded:!1,layerNames:["UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling"],children:[m.jsx(lt,{name:"UIKAV Punten",type:"overlay"}),m.jsx(lt,{name:"UIKAV Vlakken",type:"overlay"}),m.jsx(lt,{name:"UIKAV Expert",type:"overlay"}),m.jsx(lt,{name:"UIKAV Buffer",type:"overlay"}),m.jsx(lt,{name:"UIKAV Indeling",type:"overlay"})]})]}),m.jsxs(Jr,{title:"Erfgoed & Monumenten",defaultExpanded:!1,layerNames:["Rijksmonumenten","Werelderfgoed","Religieus Erfgoed","Kastelen","Runes"],children:[m.jsx(lt,{name:"Rijksmonumenten",type:"overlay"}),m.jsx(lt,{name:"Werelderfgoed",type:"overlay"}),m.jsx(lt,{name:"Religieus Erfgoed",type:"overlay"}),m.jsx(lt,{name:"Kastelen",type:"overlay"}),m.jsx(lt,{name:"Runes",type:"overlay"})]}),m.jsxs(Jr,{title:"WOII & Militair",defaultExpanded:!1,layerNames:["WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Militaire Objecten","Inundatiegebieden"],children:[m.jsx(lt,{name:"WWII Bunkers",type:"overlay"}),m.jsx(lt,{name:"Slagvelden",type:"overlay"}),m.jsx(lt,{name:"Militaire Vliegvelden",type:"overlay"}),m.jsx(lt,{name:"Verdedigingslinies",type:"overlay"}),m.jsx(lt,{name:"Militaire Objecten",type:"overlay"}),m.jsx(lt,{name:"Inundatiegebieden",type:"overlay"})]}),m.jsxs(Jr,{title:"Hillshade & LiDAR",defaultExpanded:!1,layerNames:["AHN4 Hoogtekaart Kleur","AHN4 Hillshade NL","AHN4 Multi-Hillshade NL","AHN 0.5m"],children:[m.jsx(lt,{name:"AHN4 Hoogtekaart Kleur",type:"overlay"}),m.jsx(lt,{name:"AHN4 Hillshade NL",type:"overlay"}),m.jsx(lt,{name:"AHN4 Multi-Hillshade NL",type:"overlay"}),m.jsx(lt,{name:"AHN 0.5m",type:"overlay"})]}),m.jsxs(Jr,{title:"Terrein & Bodem",defaultExpanded:!1,layerNames:["Veengebieden","Geomorfologie","Bodemkaart","Essen"],children:[m.jsx(lt,{name:"Veengebieden",type:"overlay"}),m.jsx(lt,{name:"Geomorfologie",type:"overlay"}),m.jsx(lt,{name:"Bodemkaart",type:"overlay"}),m.jsx(lt,{name:"Essen",type:"overlay"})]}),m.jsxs(Jr,{title:"Percelen",defaultExpanded:!1,layerNames:["Gewaspercelen","Kadastrale Grenzen"],children:[m.jsx(lt,{name:"Gewaspercelen",type:"overlay"}),m.jsx(lt,{name:"Kadastrale Grenzen",type:"overlay"})]}),m.jsxs(Jr,{title:"Provinciale Thema's",defaultExpanded:!1,layerNames:["Scheepswrakken","Woonheuvels ZH","Windmolens","Erfgoedlijnen","Oude Kernen","Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken","Verdronken Dorpen"],children:[m.jsxs(Jr,{title:"Zuid-Holland",defaultExpanded:!1,layerNames:["Scheepswrakken","Woonheuvels ZH","Windmolens","Erfgoedlijnen","Oude Kernen"],children:[m.jsx(lt,{name:"Scheepswrakken",type:"overlay"}),m.jsx(lt,{name:"Woonheuvels ZH",type:"overlay"}),m.jsx(lt,{name:"Windmolens",type:"overlay"}),m.jsx(lt,{name:"Erfgoedlijnen",type:"overlay"}),m.jsx(lt,{name:"Oude Kernen",type:"overlay"})]}),m.jsxs(Jr,{title:"Gelderland",defaultExpanded:!1,layerNames:["Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken"],children:[m.jsx(lt,{name:"Relictenkaart Punten",type:"overlay"}),m.jsx(lt,{name:"Relictenkaart Lijnen",type:"overlay"}),m.jsx(lt,{name:"Relictenkaart Vlakken",type:"overlay"})]}),m.jsx(Jr,{title:"Zeeland",defaultExpanded:!1,layerNames:["Verdronken Dorpen"],children:m.jsx(lt,{name:"Verdronken Dorpen",type:"overlay"})})]}),m.jsxs(Jr,{title:"Fossielen, Mineralen & Goud",defaultExpanded:!1,layerNames:["Fossiel Hotspots","Mineralen Hotspots","Goudrivieren","Fossielen Nederland","Fossielen Belgi","Fossielen Duitsland","Fossielen Frankrijk"],children:[m.jsx(lt,{name:"Fossiel Hotspots",type:"overlay"}),m.jsx(lt,{name:"Mineralen Hotspots",type:"overlay"}),m.jsx(lt,{name:"Goudrivieren",type:"overlay"}),m.jsx(lt,{name:"Fossielen Nederland",type:"overlay"}),m.jsx(lt,{name:"Fossielen Belgi",type:"overlay"}),m.jsx(lt,{name:"Fossielen Duitsland",type:"overlay"}),m.jsx(lt,{name:"Fossielen Frankrijk",type:"overlay"})]}),m.jsxs(Jr,{title:"Recreatie",defaultExpanded:!1,layerNames:["Wandelroutes","Parken","Speeltuinen","Musea","Strandjes","Kringloopwinkels"],children:[m.jsx(lt,{name:"Wandelroutes",type:"overlay"}),m.jsx(lt,{name:"Parken",type:"overlay"}),m.jsx(lt,{name:"Speeltuinen",type:"overlay"}),m.jsx(lt,{name:"Musea",type:"overlay"}),m.jsx(lt,{name:"Strandjes",type:"overlay"}),m.jsx(lt,{name:"Kringloopwinkels",type:"overlay"})]})]})]})]})})}function ile(n){n("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),n("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),n("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs");for(var e=1;e<=60;++e)n("EPSG:"+(32600+e),"+proj=utm +zone="+e+" +datum=WGS84 +units=m"),n("EPSG:"+(32700+e),"+proj=utm +zone="+e+" +south +datum=WGS84 +units=m");n("EPSG:5041","+title=WGS 84 / UPS North (E,N) +proj=stere +lat_0=90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m"),n("EPSG:5042","+title=WGS 84 / UPS South (E,N) +proj=stere +lat_0=-90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m"),n.WGS84=n["EPSG:4326"],n["EPSG:3785"]=n["EPSG:3857"],n.GOOGLE=n["EPSG:3857"],n["EPSG:900913"]=n["EPSG:3857"],n["EPSG:102113"]=n["EPSG:3857"]}var ed=1,td=2,Jf=3,sle=4,Rb=5,_L=6378137,ale=6356752314e-3,xL=.0066943799901413165,km=484813681109536e-20,We=Math.PI/2,ole=.16666666666666666,lle=.04722222222222222,cle=.022156084656084655,st=1e-10,Ir=.017453292519943295,Rs=57.29577951308232,Ln=Math.PI/4,Ap=Math.PI*2,Fr=3.14159265359,Ls={};Ls.greenwich=0;Ls.lisbon=-9.131906111111;Ls.paris=2.337229166667;Ls.bogota=-74.080916666667;Ls.madrid=-3.687938888889;Ls.rome=12.452333333333;Ls.bern=7.439583333333;Ls.jakarta=106.807719444444;Ls.ferro=-17.666666666667;Ls.brussels=4.367975;Ls.stockholm=18.058277777778;Ls.athens=23.7163375;Ls.oslo=10.722916666667;const ule={mm:{to_meter:.001},cm:{to_meter:.01},ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937},fath:{to_meter:1.8288},kmi:{to_meter:1852},"us-ch":{to_meter:20.1168402336805},"us-mi":{to_meter:1609.34721869444},km:{to_meter:1e3},"ind-ft":{to_meter:.30479841},"ind-yd":{to_meter:.91439523},mi:{to_meter:1609.344},yd:{to_meter:.9144},ch:{to_meter:20.1168},link:{to_meter:.201168},dm:{to_meter:.1},in:{to_meter:.0254},"ind-ch":{to_meter:20.11669506},"us-in":{to_meter:.025400050800101},"us-yd":{to_meter:.914401828803658}};var vL=/[\s_\-\/\(\)]/g;function yu(n,e){if(n[e])return n[e];for(var t=Object.keys(n),r=e.toLowerCase().replace(vL,""),i=-1,s,a;++i<t.length;)if(s=t[i],a=s.toLowerCase().replace(vL,""),a===r)return n[s]}function Cb(n){var e={},t=n.split("+").map(function(o){return o.trim()}).filter(function(o){return o}).reduce(function(o,l){var u=l.split("=");return u.push(!0),o[u[0].toLowerCase()]=u[1],o},{}),r,i,s,a={proj:"projName",datum:"datumCode",rf:function(o){e.rf=parseFloat(o)},lat_0:function(o){e.lat0=o*Ir},lat_1:function(o){e.lat1=o*Ir},lat_2:function(o){e.lat2=o*Ir},lat_ts:function(o){e.lat_ts=o*Ir},lon_0:function(o){e.long0=o*Ir},lon_1:function(o){e.long1=o*Ir},lon_2:function(o){e.long2=o*Ir},alpha:function(o){e.alpha=parseFloat(o)*Ir},gamma:function(o){e.rectified_grid_angle=parseFloat(o)*Ir},lonc:function(o){e.longc=o*Ir},x_0:function(o){e.x0=parseFloat(o)},y_0:function(o){e.y0=parseFloat(o)},k_0:function(o){e.k0=parseFloat(o)},k:function(o){e.k0=parseFloat(o)},a:function(o){e.a=parseFloat(o)},b:function(o){e.b=parseFloat(o)},r:function(o){e.a=e.b=parseFloat(o)},r_a:function(){e.R_A=!0},zone:function(o){e.zone=parseInt(o,10)},south:function(){e.utmSouth=!0},towgs84:function(o){e.datum_params=o.split(",").map(function(l){return parseFloat(l)})},to_meter:function(o){e.to_meter=parseFloat(o)},units:function(o){e.units=o;var l=yu(ule,o);l&&(e.to_meter=l.to_meter)},from_greenwich:function(o){e.from_greenwich=o*Ir},pm:function(o){var l=yu(Ls,o);e.from_greenwich=(l||parseFloat(o))*Ir},nadgrids:function(o){o==="@null"?e.datumCode="none":e.nadgrids=o},axis:function(o){var l="ewnsud";o.length===3&&l.indexOf(o.substr(0,1))!==-1&&l.indexOf(o.substr(1,1))!==-1&&l.indexOf(o.substr(2,1))!==-1&&(e.axis=o)},approx:function(){e.approx=!0},over:function(){e.over=!0}};for(r in t)i=t[r],r in a?(s=a[r],typeof s=="function"?s(i):e[s]=i):e[r]=i;return typeof e.datumCode=="string"&&e.datumCode!=="WGS84"&&(e.datumCode=e.datumCode.toLowerCase()),e.projStr=n,e}class O9{static getId(e){const t=e.find(r=>Array.isArray(r)&&r[0]==="ID");return t&&t.length>=3?{authority:t[1],code:parseInt(t[2],10)}:null}static convertUnit(e,t="unit"){if(!e||e.length<3)return{type:t,name:"unknown",conversion_factor:null};const r=e[1],i=parseFloat(e[2])||null,s=e.find(o=>Array.isArray(o)&&o[0]==="ID"),a=s?{authority:s[1],code:parseInt(s[2],10)}:null;return{type:t,name:r,conversion_factor:i,id:a}}static convertAxis(e){const t=e[1]||"Unknown";let r;const i=t.match(/^\((.)\)$/);if(i){const u=i[1].toUpperCase();if(u==="E")r="east";else if(u==="N")r="north";else if(u==="U")r="up";else throw new Error(`Unknown axis abbreviation: ${u}`)}else r=e[2]?e[2].toLowerCase():"unknown";const s=e.find(u=>Array.isArray(u)&&u[0]==="ORDER"),a=s?parseInt(s[1],10):null,o=e.find(u=>Array.isArray(u)&&(u[0]==="LENGTHUNIT"||u[0]==="ANGLEUNIT"||u[0]==="SCALEUNIT")),l=this.convertUnit(o);return{name:t,direction:r,unit:l,order:a}}static extractAxes(e){return e.filter(t=>Array.isArray(t)&&t[0]==="AXIS").map(t=>this.convertAxis(t)).sort((t,r)=>(t.order||0)-(r.order||0))}static convert(e,t={}){switch(e[0]){case"PROJCRS":t.type="ProjectedCRS",t.name=e[1],t.base_crs=e.find(g=>Array.isArray(g)&&g[0]==="BASEGEOGCRS")?this.convert(e.find(g=>Array.isArray(g)&&g[0]==="BASEGEOGCRS")):null,t.conversion=e.find(g=>Array.isArray(g)&&g[0]==="CONVERSION")?this.convert(e.find(g=>Array.isArray(g)&&g[0]==="CONVERSION")):null;const r=e.find(g=>Array.isArray(g)&&g[0]==="CS");r&&(t.coordinate_system={type:r[1],axis:this.extractAxes(e)});const i=e.find(g=>Array.isArray(g)&&g[0]==="LENGTHUNIT");if(i){const g=this.convertUnit(i);t.coordinate_system.unit=g}t.id=this.getId(e);break;case"BASEGEOGCRS":case"GEOGCRS":t.type="GeographicCRS",t.name=e[1];const s=e.find(g=>Array.isArray(g)&&(g[0]==="DATUM"||g[0]==="ENSEMBLE"));if(s){const g=this.convert(s);s[0]==="ENSEMBLE"?t.datum_ensemble=g:t.datum=g;const y=e.find(v=>Array.isArray(v)&&v[0]==="PRIMEM");y&&y[1]!=="Greenwich"&&(g.prime_meridian={name:y[1],longitude:parseFloat(y[2])})}t.coordinate_system={type:"ellipsoidal",axis:this.extractAxes(e)},t.id=this.getId(e);break;case"DATUM":t.type="GeodeticReferenceFrame",t.name=e[1],t.ellipsoid=e.find(g=>Array.isArray(g)&&g[0]==="ELLIPSOID")?this.convert(e.find(g=>Array.isArray(g)&&g[0]==="ELLIPSOID")):null;break;case"ENSEMBLE":t.type="DatumEnsemble",t.name=e[1],t.members=e.filter(g=>Array.isArray(g)&&g[0]==="MEMBER").map(g=>({type:"DatumEnsembleMember",name:g[1],id:this.getId(g)}));const a=e.find(g=>Array.isArray(g)&&g[0]==="ENSEMBLEACCURACY");a&&(t.accuracy=parseFloat(a[1]));const o=e.find(g=>Array.isArray(g)&&g[0]==="ELLIPSOID");o&&(t.ellipsoid=this.convert(o)),t.id=this.getId(e);break;case"ELLIPSOID":t.type="Ellipsoid",t.name=e[1],t.semi_major_axis=parseFloat(e[2]),t.inverse_flattening=parseFloat(e[3]),e.find(g=>Array.isArray(g)&&g[0]==="LENGTHUNIT")&&this.convert(e.find(g=>Array.isArray(g)&&g[0]==="LENGTHUNIT"),t);break;case"CONVERSION":t.type="Conversion",t.name=e[1],t.method=e.find(g=>Array.isArray(g)&&g[0]==="METHOD")?this.convert(e.find(g=>Array.isArray(g)&&g[0]==="METHOD")):null,t.parameters=e.filter(g=>Array.isArray(g)&&g[0]==="PARAMETER").map(g=>this.convert(g));break;case"METHOD":t.type="Method",t.name=e[1],t.id=this.getId(e);break;case"PARAMETER":t.type="Parameter",t.name=e[1],t.value=parseFloat(e[2]),t.unit=this.convertUnit(e.find(g=>Array.isArray(g)&&(g[0]==="LENGTHUNIT"||g[0]==="ANGLEUNIT"||g[0]==="SCALEUNIT"))),t.id=this.getId(e);break;case"BOUNDCRS":t.type="BoundCRS";const l=e.find(g=>Array.isArray(g)&&g[0]==="SOURCECRS");if(l){const g=l.find(y=>Array.isArray(y));t.source_crs=g?this.convert(g):null}const u=e.find(g=>Array.isArray(g)&&g[0]==="TARGETCRS");if(u){const g=u.find(y=>Array.isArray(y));t.target_crs=g?this.convert(g):null}const h=e.find(g=>Array.isArray(g)&&g[0]==="ABRIDGEDTRANSFORMATION");h?t.transformation=this.convert(h):t.transformation=null;break;case"ABRIDGEDTRANSFORMATION":if(t.type="Transformation",t.name=e[1],t.method=e.find(g=>Array.isArray(g)&&g[0]==="METHOD")?this.convert(e.find(g=>Array.isArray(g)&&g[0]==="METHOD")):null,t.parameters=e.filter(g=>Array.isArray(g)&&(g[0]==="PARAMETER"||g[0]==="PARAMETERFILE")).map(g=>{if(g[0]==="PARAMETER")return this.convert(g);if(g[0]==="PARAMETERFILE")return{name:g[1],value:g[2],id:{authority:"EPSG",code:8656}}}),t.parameters.length===7){const g=t.parameters[6];g.name==="Scale difference"&&(g.value=Math.round((g.value-1)*1e12)/1e6)}t.id=this.getId(e);break;case"AXIS":t.coordinate_system||(t.coordinate_system={type:"unspecified",axis:[]}),t.coordinate_system.axis.push(this.convertAxis(e));break;case"LENGTHUNIT":const f=this.convertUnit(e,"LinearUnit");t.coordinate_system&&t.coordinate_system.axis&&t.coordinate_system.axis.forEach(g=>{g.unit||(g.unit=f)}),f.conversion_factor&&f.conversion_factor!==1&&t.semi_major_axis&&(t.semi_major_axis={value:t.semi_major_axis,unit:f});break;default:t.keyword=e[0];break}return t}}class hle extends O9{static convert(e,t={}){return super.convert(e,t),t.coordinate_system&&t.coordinate_system.subtype==="Cartesian"&&delete t.coordinate_system,t.usage&&delete t.usage,t}}class dle extends O9{static convert(e,t={}){super.convert(e,t);const r=e.find(s=>Array.isArray(s)&&s[0]==="CS");r&&(t.coordinate_system={subtype:r[1],axis:this.extractAxes(e)});const i=e.find(s=>Array.isArray(s)&&s[0]==="USAGE");if(i){const s=i.find(l=>Array.isArray(l)&&l[0]==="SCOPE"),a=i.find(l=>Array.isArray(l)&&l[0]==="AREA"),o=i.find(l=>Array.isArray(l)&&l[0]==="BBOX");t.usage={},s&&(t.usage.scope=s[1]),a&&(t.usage.area=a[1]),o&&(t.usage.bbox=o.slice(1))}return t}}function fle(n){return n.find(e=>Array.isArray(e)&&e[0]==="USAGE")?"2019":(n.find(e=>Array.isArray(e)&&e[0]==="CS")||n[0]==="BOUNDCRS"||n[0]==="PROJCRS"||n[0]==="GEOGCRS","2015")}function gle(n){return(fle(n)==="2019"?dle:hle).convert(n)}function mle(n){const e=n.toUpperCase();return e.includes("PROJCRS")||e.includes("GEOGCRS")||e.includes("BOUNDCRS")||e.includes("VERTCRS")||e.includes("LENGTHUNIT")||e.includes("ANGLEUNIT")||e.includes("SCALEUNIT")?"WKT2":(e.includes("PROJCS")||e.includes("GEOGCS")||e.includes("LOCAL_CS")||e.includes("VERT_CS")||e.includes("UNIT"),"WKT1")}var Rp=1,D9=2,F9=3,ev=4,j9=5,IR=-1,ple=/\s/,yle=/[A-Za-z]/,_le=/[A-Za-z84_]/,Fw=/[,\]]/,V9=/[\d\.E\-\+]/;function Ql(n){if(typeof n!="string")throw new Error("not a string");this.text=n.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=Rp}Ql.prototype.readCharicter=function(){var n=this.text[this.place++];if(this.state!==ev)for(;ple.test(n);){if(this.place>=this.text.length)return;n=this.text[this.place++]}switch(this.state){case Rp:return this.neutral(n);case D9:return this.keyword(n);case ev:return this.quoted(n);case j9:return this.afterquote(n);case F9:return this.number(n);case IR:return}};Ql.prototype.afterquote=function(n){if(n==='"'){this.word+='"',this.state=ev;return}if(Fw.test(n)){this.word=this.word.trim(),this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in afterquote yet, index '+this.place)};Ql.prototype.afterItem=function(n){if(n===","){this.word!==null&&this.currentObject.push(this.word),this.word=null,this.state=Rp;return}if(n==="]"){this.level--,this.word!==null&&(this.currentObject.push(this.word),this.word=null),this.state=Rp,this.currentObject=this.stack.pop(),this.currentObject||(this.state=IR);return}};Ql.prototype.number=function(n){if(V9.test(n)){this.word+=n;return}if(Fw.test(n)){this.word=parseFloat(this.word),this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in number yet, index '+this.place)};Ql.prototype.quoted=function(n){if(n==='"'){this.state=j9;return}this.word+=n};Ql.prototype.keyword=function(n){if(_le.test(n)){this.word+=n;return}if(n==="["){var e=[];e.push(this.word),this.level++,this.root===null?this.root=e:this.currentObject.push(e),this.stack.push(this.currentObject),this.currentObject=e,this.state=Rp;return}if(Fw.test(n)){this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in keyword yet, index '+this.place)};Ql.prototype.neutral=function(n){if(yle.test(n)){this.word=n,this.state=D9;return}if(n==='"'){this.word="",this.state=ev;return}if(V9.test(n)){this.word=n,this.state=F9;return}if(Fw.test(n)){this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in neutral yet, index '+this.place)};Ql.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===IR)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function xle(n){var e=new Ql(n);return e.output()}function PS(n,e,t){Array.isArray(e)&&(t.unshift(e),e=null);var r=e?{}:n,i=t.reduce(function(s,a){return jf(a,s),s},r);e&&(n[e]=i)}function jf(n,e){if(!Array.isArray(n)){e[n]=!0;return}var t=n.shift();if(t==="PARAMETER"&&(t=n.shift()),n.length===1){if(Array.isArray(n[0])){e[t]={},jf(n[0],e[t]);return}e[t]=n[0];return}if(!n.length){e[t]=!0;return}if(t==="TOWGS84"){e[t]=n;return}if(t==="AXIS"){t in e||(e[t]=[]),e[t].push(n);return}Array.isArray(t)||(e[t]={});var r;switch(t){case"UNIT":case"PRIMEM":case"VERT_DATUM":e[t]={name:n[0].toLowerCase(),convert:n[1]},n.length===3&&jf(n[2],e[t]);return;case"SPHEROID":case"ELLIPSOID":e[t]={name:n[0],a:n[1],rf:n[2]},n.length===4&&jf(n[3],e[t]);return;case"EDATUM":case"ENGINEERINGDATUM":case"LOCAL_DATUM":case"DATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":n[0]=["name",n[0]],PS(e,t,n);return;case"COMPD_CS":case"COMPOUNDCRS":case"FITTED_CS":case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"ENGCRS":case"ENGINEERINGCRS":n[0]=["name",n[0]],PS(e,t,n),e[t].type=t;return;default:for(r=-1;++r<n.length;)if(!Array.isArray(n[r]))return jf(n,e[t]);return PS(e,t,n)}}var vle=.017453292519943295;function Wa(n){return n*vle}function G9(n){const e=(n.projName||"").toLowerCase().replace(/_/g," ");!n.long0&&n.longc&&(e==="albers conic equal area"||e==="lambert azimuthal equal area")&&(n.long0=n.longc),!n.lat_ts&&n.lat1&&(e==="stereographic south pole"||e==="polar stereographic (variant b)")?(n.lat0=Wa(n.lat1>0?90:-90),n.lat_ts=n.lat1,delete n.lat1):!n.lat_ts&&n.lat0&&(e==="polar stereographic"||e==="polar stereographic (variant a)")&&(n.lat_ts=n.lat0,n.lat0=Wa(n.lat0>0?90:-90),delete n.lat1)}function wL(n){let e={units:null,to_meter:void 0};return typeof n=="string"?(e.units=n.toLowerCase(),e.units==="metre"&&(e.units="meter"),e.units==="meter"&&(e.to_meter=1)):n&&n.name&&(e.units=n.name.toLowerCase(),e.units==="metre"&&(e.units="meter"),e.to_meter=n.conversion_factor),e}function EL(n){return typeof n=="object"?n.value*n.unit.conversion_factor:n}function SL(n,e){n.ellipsoid.radius?(e.a=n.ellipsoid.radius,e.rf=0):(e.a=EL(n.ellipsoid.semi_major_axis),n.ellipsoid.inverse_flattening!==void 0?e.rf=n.ellipsoid.inverse_flattening:n.ellipsoid.semi_major_axis!==void 0&&n.ellipsoid.semi_minor_axis!==void 0&&(e.rf=e.a/(e.a-EL(n.ellipsoid.semi_minor_axis))))}function tv(n,e={}){return!n||typeof n!="object"?n:n.type==="BoundCRS"?(tv(n.source_crs,e),n.transformation&&(n.transformation.method&&n.transformation.method.name==="NTv2"?e.nadgrids=n.transformation.parameters[0].value:e.datum_params=n.transformation.parameters.map(t=>t.value)),e):(Object.keys(n).forEach(t=>{const r=n[t];if(r!==null)switch(t){case"name":if(e.srsCode)break;e.name=r,e.srsCode=r;break;case"type":r==="GeographicCRS"?e.projName="longlat":r==="ProjectedCRS"&&n.conversion&&n.conversion.method&&(e.projName=n.conversion.method.name);break;case"datum":case"datum_ensemble":r.ellipsoid&&(e.ellps=r.ellipsoid.name,SL(r,e)),r.prime_meridian&&(e.from_greenwich=r.prime_meridian.longitude*Math.PI/180);break;case"ellipsoid":e.ellps=r.name,SL(r,e);break;case"prime_meridian":e.long0=(r.longitude||0)*Math.PI/180;break;case"coordinate_system":if(r.axis){if(e.axis=r.axis.map(i=>{const s=i.direction;if(s==="east")return"e";if(s==="north")return"n";if(s==="west")return"w";if(s==="south")return"s";throw new Error(`Unknown axis direction: ${s}`)}).join("")+"u",r.unit){const{units:i,to_meter:s}=wL(r.unit);e.units=i,e.to_meter=s}else if(r.axis[0]&&r.axis[0].unit){const{units:i,to_meter:s}=wL(r.axis[0].unit);e.units=i,e.to_meter=s}}break;case"id":r.authority&&r.code&&(e.title=r.authority+":"+r.code);break;case"conversion":r.method&&r.method.name&&(e.projName=r.method.name),r.parameters&&r.parameters.forEach(i=>{const s=i.name.toLowerCase().replace(/\s+/g,"_"),a=i.value;i.unit&&i.unit.conversion_factor?e[s]=a*i.unit.conversion_factor:i.unit==="degree"?e[s]=a*Math.PI/180:e[s]=a});break;case"unit":r.name&&(e.units=r.name.toLowerCase(),e.units==="metre"&&(e.units="meter")),r.conversion_factor&&(e.to_meter=r.conversion_factor);break;case"base_crs":tv(r,e),e.datumCode=r.id?r.id.authority+"_"+r.id.code:r.name;break}}),e.latitude_of_false_origin!==void 0&&(e.lat0=e.latitude_of_false_origin),e.longitude_of_false_origin!==void 0&&(e.long0=e.longitude_of_false_origin),e.latitude_of_standard_parallel!==void 0&&(e.lat0=e.latitude_of_standard_parallel,e.lat1=e.latitude_of_standard_parallel),e.latitude_of_1st_standard_parallel!==void 0&&(e.lat1=e.latitude_of_1st_standard_parallel),e.latitude_of_2nd_standard_parallel!==void 0&&(e.lat2=e.latitude_of_2nd_standard_parallel),e.latitude_of_projection_centre!==void 0&&(e.lat0=e.latitude_of_projection_centre),e.longitude_of_projection_centre!==void 0&&(e.longc=e.longitude_of_projection_centre),e.easting_at_false_origin!==void 0&&(e.x0=e.easting_at_false_origin),e.northing_at_false_origin!==void 0&&(e.y0=e.northing_at_false_origin),e.latitude_of_natural_origin!==void 0&&(e.lat0=e.latitude_of_natural_origin),e.longitude_of_natural_origin!==void 0&&(e.long0=e.longitude_of_natural_origin),e.longitude_of_origin!==void 0&&(e.long0=e.longitude_of_origin),e.false_easting!==void 0&&(e.x0=e.false_easting),e.easting_at_projection_centre&&(e.x0=e.easting_at_projection_centre),e.false_northing!==void 0&&(e.y0=e.false_northing),e.northing_at_projection_centre&&(e.y0=e.northing_at_projection_centre),e.standard_parallel_1!==void 0&&(e.lat1=e.standard_parallel_1),e.standard_parallel_2!==void 0&&(e.lat2=e.standard_parallel_2),e.scale_factor_at_natural_origin!==void 0&&(e.k0=e.scale_factor_at_natural_origin),e.scale_factor_at_projection_centre!==void 0&&(e.k0=e.scale_factor_at_projection_centre),e.scale_factor_on_pseudo_standard_parallel!==void 0&&(e.k0=e.scale_factor_on_pseudo_standard_parallel),e.azimuth!==void 0&&(e.alpha=e.azimuth),e.azimuth_at_projection_centre!==void 0&&(e.alpha=e.azimuth_at_projection_centre),e.angle_from_rectified_to_skew_grid&&(e.rectified_grid_angle=e.angle_from_rectified_to_skew_grid),G9(e),e)}var wle=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function Ele(n,e){var t=e[0],r=e[1];!(t in n)&&r in n&&(n[t]=n[r],e.length===3&&(n[t]=e[2](n[t])))}function B9(n){for(var e=Object.keys(n),t=0,r=e.length;t<r;++t){var i=e[t];wle.indexOf(i)!==-1&&Sle(n[i]),typeof n[i]=="object"&&B9(n[i])}}function Sle(n){if(n.AUTHORITY){var e=Object.keys(n.AUTHORITY)[0];e&&e in n.AUTHORITY&&(n.title=e+":"+n.AUTHORITY[e])}if(n.type==="GEOGCS"?n.projName="longlat":n.type==="LOCAL_CS"?(n.projName="identity",n.local=!0):typeof n.PROJECTION=="object"?n.projName=Object.keys(n.PROJECTION)[0]:n.projName=n.PROJECTION,n.AXIS){for(var t="",r=0,i=n.AXIS.length;r<i;++r){var s=[n.AXIS[r][0].toLowerCase(),n.AXIS[r][1].toLowerCase()];s[0].indexOf("north")!==-1||(s[0]==="y"||s[0]==="lat")&&s[1]==="north"?t+="n":s[0].indexOf("south")!==-1||(s[0]==="y"||s[0]==="lat")&&s[1]==="south"?t+="s":s[0].indexOf("east")!==-1||(s[0]==="x"||s[0]==="lon")&&s[1]==="east"?t+="e":(s[0].indexOf("west")!==-1||(s[0]==="x"||s[0]==="lon")&&s[1]==="west")&&(t+="w")}t.length===2&&(t+="u"),t.length===3&&(n.axis=t)}n.UNIT&&(n.units=n.UNIT.name.toLowerCase(),n.units==="metre"&&(n.units="meter"),n.UNIT.convert&&(n.type==="GEOGCS"?n.DATUM&&n.DATUM.SPHEROID&&(n.to_meter=n.UNIT.convert*n.DATUM.SPHEROID.a):n.to_meter=n.UNIT.convert));var a=n.GEOGCS;n.type==="GEOGCS"&&(a=n),a&&(a.DATUM?n.datumCode=a.DATUM.name.toLowerCase():n.datumCode=a.name.toLowerCase(),n.datumCode.slice(0,2)==="d_"&&(n.datumCode=n.datumCode.slice(2)),n.datumCode==="new_zealand_1949"&&(n.datumCode="nzgd49"),(n.datumCode==="wgs_1984"||n.datumCode==="world_geodetic_system_1984")&&(n.PROJECTION==="Mercator_Auxiliary_Sphere"&&(n.sphere=!0),n.datumCode="wgs84"),n.datumCode==="belge_1972"&&(n.datumCode="rnb72"),a.DATUM&&a.DATUM.SPHEROID&&(n.ellps=a.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),n.ellps.toLowerCase().slice(0,13)==="international"&&(n.ellps="intl"),n.a=a.DATUM.SPHEROID.a,n.rf=parseFloat(a.DATUM.SPHEROID.rf,10)),a.DATUM&&a.DATUM.TOWGS84&&(n.datum_params=a.DATUM.TOWGS84),~n.datumCode.indexOf("osgb_1936")&&(n.datumCode="osgb36"),~n.datumCode.indexOf("osni_1952")&&(n.datumCode="osni52"),(~n.datumCode.indexOf("tm65")||~n.datumCode.indexOf("geodetic_datum_of_1965"))&&(n.datumCode="ire65"),n.datumCode==="ch1903+"&&(n.datumCode="ch1903"),~n.datumCode.indexOf("israel")&&(n.datumCode="isr93")),n.b&&!isFinite(n.b)&&(n.b=n.a),n.rectified_grid_angle&&(n.rectified_grid_angle=Wa(n.rectified_grid_angle));function o(h){var f=n.to_meter||1;return h*f}var l=function(h){return Ele(n,h)},u=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",Wa],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",Wa],["x0","false_easting",o],["y0","false_northing",o],["long0","central_meridian",Wa],["lat0","latitude_of_origin",Wa],["lat0","standard_parallel_1",Wa],["lat1","standard_parallel_1",Wa],["lat2","standard_parallel_2",Wa],["azimuth","Azimuth"],["alpha","azimuth",Wa],["srsCode","name"]];u.forEach(l),G9(n)}function nv(n){if(typeof n=="object")return tv(n);const e=mle(n);var t=xle(n);if(e==="WKT2"){const s=gle(t);return tv(s)}var r=t[0],i={};return jf(t,i),B9(i),i[r]}function Si(n){var e=this;if(arguments.length===2){var t=arguments[1];typeof t=="string"?t.charAt(0)==="+"?Si[n]=Cb(arguments[1]):Si[n]=nv(arguments[1]):t&&typeof t=="object"&&!("projName"in t)?Si[n]=nv(arguments[1]):(Si[n]=t,t||delete Si[n])}else if(arguments.length===1){if(Array.isArray(n))return n.map(function(r){return Array.isArray(r)?Si.apply(e,r):Si(r)});if(typeof n=="string"){if(n in Si)return Si[n]}else"EPSG"in n?Si["EPSG:"+n.EPSG]=n:"ESRI"in n?Si["ESRI:"+n.ESRI]=n:"IAU2000"in n?Si["IAU2000:"+n.IAU2000]=n:console.log(n);return}}ile(Si);function Tle(n){return typeof n=="string"}function ble(n){return n in Si}function Ile(n){return n.indexOf("+")!==0&&n.indexOf("[")!==-1||typeof n=="object"&&!("srsCode"in n)}var Ale=["3857","900913","3785","102113"];function Rle(n){var e=yu(n,"authority");if(e){var t=yu(e,"epsg");return t&&Ale.indexOf(t)>-1}}function Cle(n){var e=yu(n,"extension");if(e)return yu(e,"proj4")}function kle(n){return n[0]==="+"}function Ple(n){if(Tle(n)){if(ble(n))return Si[n];if(Ile(n)){var e=nv(n);if(Rle(e))return Si["EPSG:3857"];var t=Cle(e);return t?Cb(t):e}if(kle(n))return Cb(n)}else return"projName"in n?n:nv(n)}function TL(n,e){n=n||{};var t,r;if(!e)return n;for(r in e)t=e[r],t!==void 0&&(n[r]=t);return n}function Jo(n,e,t){var r=n*e;return t/Math.sqrt(1-r*r)}function T1(n){return n<0?-1:1}function ht(n,e){return e||Math.abs(n)<=Fr?n:n-T1(n)*Ap}function so(n,e,t){var r=n*t,i=.5*n;return r=Math.pow((1-r)/(1+r),i),Math.tan(.5*(We-e))/r}function Cp(n,e){for(var t=.5*n,r,i,s=We-2*Math.atan(e),a=0;a<=15;a++)if(r=n*Math.sin(s),i=We-2*Math.atan(e*Math.pow((1-r)/(1+r),t))-s,s+=i,Math.abs(i)<=1e-10)return s;return-9999}function Mle(){var n=this.b/this.a;this.es=1-n*n,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=Jo(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function Nle(n){var e=n.x,t=n.y;if(t*Rs>90&&t*Rs<-90&&e*Rs>180&&e*Rs<-180)return null;var r,i;if(Math.abs(Math.abs(t)-We)<=st)return null;if(this.sphere)r=this.x0+this.a*this.k0*ht(e-this.long0,this.over),i=this.y0+this.a*this.k0*Math.log(Math.tan(Ln+.5*t));else{var s=Math.sin(t),a=so(this.e,t,s);r=this.x0+this.a*this.k0*ht(e-this.long0,this.over),i=this.y0-this.a*this.k0*Math.log(a)}return n.x=r,n.y=i,n}function Lle(n){var e=n.x-this.x0,t=n.y-this.y0,r,i;if(this.sphere)i=We-2*Math.atan(Math.exp(-t/(this.a*this.k0)));else{var s=Math.exp(-t/(this.a*this.k0));if(i=Cp(this.e,s),i===-9999)return null}return r=ht(this.long0+e/(this.a*this.k0),this.over),n.x=r,n.y=i,n}var Ole=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","Mercator_Variant_A","merc"];const Dle={init:Mle,forward:Nle,inverse:Lle,names:Ole};function Fle(){}function bL(n){return n}var U9=["longlat","identity"];const jle={init:Fle,forward:bL,inverse:bL,names:U9};var Vle=[Dle,jle],uh={},Vf=[];function z9(n,e){var t=Vf.length;return n.names?(Vf[t]=n,n.names.forEach(function(r){uh[r.toLowerCase()]=t}),this):(console.log(e),!0)}function $9(n){return n.replace(/[-\(\)\s]+/g," ").trim().replace(/ /g,"_")}function Gle(n){if(!n)return!1;var e=n.toLowerCase();if(typeof uh[e]<"u"&&Vf[uh[e]]||(e=$9(e),e in uh&&Vf[uh[e]]))return Vf[uh[e]]}function Ble(){Vle.forEach(z9)}const Ule={start:Ble,add:z9,get:Gle};var W9={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563396e-3,b:635625691e-2,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340189e-3,b:6356034446e-3,ellipseName:"Modified Airy"},andrae:{a:637710443e-2,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397155e-3,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483865e-3,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:63782064e-1,b:63565838e-1,ellipseName:"Clarke 1866"},clrk80:{a:6378249145e-3,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk80ign:{a:63782492e-1,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"},clrk58:{a:6378293645208759e-9,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:63757387e-1,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:637813605e-2,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276345e-3,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304063e-3,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301243e-3,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295664e-3,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298556e-3,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:63781575e-1,b:63567722e-1,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:63567733205e-4,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:63558348467e-4,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"},WGS84:{a:6378137,rf:298.257223563,ellipseName:"WGS 84"},sphere:{a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}};const zle=W9.WGS84;function $le(n,e,t,r){var i=n*n,s=e*e,a=(i-s)/i,o=0;r?(n*=1-a*(ole+a*(lle+a*cle)),i=n*n,a=0):o=Math.sqrt(a);var l=(i-s)/s;return{es:a,e:o,ep2:l}}function Wle(n,e,t,r,i){if(!n){var s=yu(W9,r);s||(s=zle),n=s.a,e=s.b,t=s.rf}return t&&!e&&(e=(1-1/t)*n),(t===0||Math.abs(n-e)<st)&&(i=!0,e=n),{a:n,b:e,rf:t,sphere:i}}var H_={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},mgi:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Ordnance Survey of Great Britain 1936"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"},EPSG_5451:{towgs84:"6.41,-49.05,-11.28,1.5657,0.5242,6.9718,-5.7649"},IGNF_LURESG:{towgs84:"-192.986,13.673,-39.309,-0.4099,-2.9332,2.6881,0.43"},EPSG_4614:{towgs84:"-119.4248,-303.65872,-11.00061,1.164298,0.174458,1.096259,3.657065"},EPSG_4615:{towgs84:"-494.088,-312.129,279.877,-1.423,-1.013,1.59,-0.748"},ESRI_37241:{towgs84:"-76.822,257.457,-12.817,2.136,-0.033,-2.392,-0.031"},ESRI_37249:{towgs84:"-440.296,58.548,296.265,1.128,10.202,4.559,-0.438"},ESRI_37245:{towgs84:"-511.151,-181.269,139.609,1.05,2.703,1.798,3.071"},EPSG_4178:{towgs84:"24.9,-126.4,-93.2,-0.063,-0.247,-0.041,1.01"},EPSG_4622:{towgs84:"-472.29,-5.63,-304.12,0.4362,-0.8374,0.2563,1.8984"},EPSG_4625:{towgs84:"126.93,547.94,130.41,-2.7867,5.1612,-0.8584,13.8227"},EPSG_5252:{towgs84:"0.023,0.036,-0.068,0.00176,0.00912,-0.01136,0.00439"},EPSG_4314:{towgs84:"597.1,71.4,412.1,0.894,0.068,-1.563,7.58"},EPSG_4282:{towgs84:"-178.3,-316.7,-131.5,5.278,6.077,10.979,19.166"},EPSG_4231:{towgs84:"-83.11,-97.38,-117.22,0.0276,-0.2167,0.2147,0.1218"},EPSG_4274:{towgs84:"-230.994,102.591,25.199,0.633,-0.239,0.9,1.95"},EPSG_4134:{towgs84:"-180.624,-225.516,173.919,-0.81,-1.898,8.336,16.71006"},EPSG_4254:{towgs84:"18.38,192.45,96.82,0.056,-0.142,-0.2,-0.0013"},EPSG_4159:{towgs84:"-194.513,-63.978,-25.759,-3.4027,3.756,-3.352,-0.9175"},EPSG_4687:{towgs84:"0.072,-0.507,-0.245,0.0183,-0.0003,0.007,-0.0093"},EPSG_4227:{towgs84:"-83.58,-397.54,458.78,-17.595,-2.847,4.256,3.225"},EPSG_4746:{towgs84:"599.4,72.4,419.2,-0.062,-0.022,-2.723,6.46"},EPSG_4745:{towgs84:"612.4,77,440.2,-0.054,0.057,-2.797,2.55"},EPSG_6311:{towgs84:"8.846,-4.394,-1.122,-0.00237,-0.146528,0.130428,0.783926"},EPSG_4289:{towgs84:"565.7381,50.4018,465.2904,-1.91514,1.60363,-9.09546,4.07244"},EPSG_4230:{towgs84:"-68.863,-134.888,-111.49,-0.53,-0.14,0.57,-3.4"},EPSG_4154:{towgs84:"-123.02,-158.95,-168.47"},EPSG_4156:{towgs84:"570.8,85.7,462.8,4.998,1.587,5.261,3.56"},EPSG_4299:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4179:{towgs84:"33.4,-146.6,-76.3,-0.359,-0.053,0.844,-0.84"},EPSG_4313:{towgs84:"-106.8686,52.2978,-103.7239,0.3366,-0.457,1.8422,-1.2747"},EPSG_4194:{towgs84:"163.511,127.533,-159.789"},EPSG_4195:{towgs84:"105,326,-102.5"},EPSG_4196:{towgs84:"-45,417,-3.5"},EPSG_4611:{towgs84:"-162.619,-276.959,-161.764,0.067753,-2.243649,-1.158827,-1.094246"},EPSG_4633:{towgs84:"137.092,131.66,91.475,-1.9436,-11.5993,-4.3321,-7.4824"},EPSG_4641:{towgs84:"-408.809,366.856,-412.987,1.8842,-0.5308,2.1655,-121.0993"},EPSG_4643:{towgs84:"-480.26,-438.32,-643.429,16.3119,20.1721,-4.0349,-111.7002"},EPSG_4300:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4188:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4660:{towgs84:"982.6087,552.753,-540.873,32.39344,-153.25684,-96.2266,16.805"},EPSG_4662:{towgs84:"97.295,-263.247,310.882,-1.5999,0.8386,3.1409,13.3259"},EPSG_3906:{towgs84:"577.88891,165.22205,391.18289,4.9145,-0.94729,-13.05098,7.78664"},EPSG_4307:{towgs84:"-209.3622,-87.8162,404.6198,0.0046,3.4784,0.5805,-1.4547"},EPSG_6892:{towgs84:"-76.269,-16.683,68.562,-6.275,10.536,-4.286,-13.686"},EPSG_4690:{towgs84:"221.597,152.441,176.523,2.403,1.3893,0.884,11.4648"},EPSG_4691:{towgs84:"218.769,150.75,176.75,3.5231,2.0037,1.288,10.9817"},EPSG_4629:{towgs84:"72.51,345.411,79.241,-1.5862,-0.8826,-0.5495,1.3653"},EPSG_4630:{towgs84:"165.804,216.213,180.26,-0.6251,-0.4515,-0.0721,7.4111"},EPSG_4692:{towgs84:"217.109,86.452,23.711,0.0183,-0.0003,0.007,-0.0093"},EPSG_9333:{towgs84:"0,0,0,-8.393,0.749,-10.276,0"},EPSG_9059:{towgs84:"0,0,0"},EPSG_4312:{towgs84:"601.705,84.263,485.227,4.7354,1.3145,5.393,-2.3887"},EPSG_4123:{towgs84:"-96.062,-82.428,-121.753,4.801,0.345,-1.376,1.496"},EPSG_4309:{towgs84:"-124.45,183.74,44.64,-0.4384,0.5446,-0.9706,-2.1365"},ESRI_104106:{towgs84:"-283.088,-70.693,117.445,-1.157,0.059,-0.652,-4.058"},EPSG_4281:{towgs84:"-219.247,-73.802,269.529"},EPSG_4322:{towgs84:"0,0,4.5"},EPSG_4324:{towgs84:"0,0,1.9"},EPSG_4284:{towgs84:"43.822,-108.842,-119.585,1.455,-0.761,0.737,0.549"},EPSG_4277:{towgs84:"446.448,-125.157,542.06,0.15,0.247,0.842,-20.489"},EPSG_4207:{towgs84:"-282.1,-72.2,120,-1.529,0.145,-0.89,-4.46"},EPSG_4688:{towgs84:"347.175,1077.618,2623.677,33.9058,-70.6776,9.4013,186.0647"},EPSG_4689:{towgs84:"410.793,54.542,80.501,-2.5596,-2.3517,-0.6594,17.3218"},EPSG_4720:{towgs84:"0,0,4.5"},EPSG_4273:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},EPSG_4240:{towgs84:"204.64,834.74,293.8"},EPSG_4817:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},ESRI_104131:{towgs84:"426.62,142.62,460.09,4.98,4.49,-12.42,-17.1"},EPSG_4265:{towgs84:"-104.1,-49.1,-9.9,0.971,-2.917,0.714,-11.68"},EPSG_4263:{towgs84:"-111.92,-87.85,114.5,1.875,0.202,0.219,0.032"},EPSG_4298:{towgs84:"-689.5937,623.84046,-65.93566,-0.02331,1.17094,-0.80054,5.88536"},EPSG_4270:{towgs84:"-253.4392,-148.452,386.5267,0.15605,0.43,-0.1013,-0.0424"},EPSG_4229:{towgs84:"-121.8,98.1,-10.7"},EPSG_4220:{towgs84:"-55.5,-348,-229.2"},EPSG_4214:{towgs84:"12.646,-155.176,-80.863"},EPSG_4232:{towgs84:"-345,3,223"},EPSG_4238:{towgs84:"-1.977,-13.06,-9.993,0.364,0.254,0.689,-1.037"},EPSG_4168:{towgs84:"-170,33,326"},EPSG_4131:{towgs84:"199,931,318.9"},EPSG_4152:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_5228:{towgs84:"572.213,85.334,461.94,4.9732,1.529,5.2484,3.5378"},EPSG_8351:{towgs84:"485.021,169.465,483.839,7.786342,4.397554,4.102655,0"},EPSG_4683:{towgs84:"-127.62,-67.24,-47.04,-3.068,4.903,1.578,-1.06"},EPSG_4133:{towgs84:"0,0,0"},EPSG_7373:{towgs84:"0.819,-0.5762,-1.6446,-0.00378,-0.03317,0.00318,0.0693"},EPSG_9075:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9072:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9294:{towgs84:"1.16835,-1.42001,-2.24431,-0.00822,-0.05508,0.01818,0.23388"},EPSG_4212:{towgs84:"-267.434,173.496,181.814,-13.4704,8.7154,7.3926,14.7492"},EPSG_4191:{towgs84:"-44.183,-0.58,-38.489,2.3867,2.7072,-3.5196,-8.2703"},EPSG_4237:{towgs84:"52.684,-71.194,-13.975,-0.312,-0.1063,-0.3729,1.0191"},EPSG_4740:{towgs84:"-1.08,-0.27,-0.9"},EPSG_4124:{towgs84:"419.3836,99.3335,591.3451,0.850389,1.817277,-7.862238,-0.99496"},EPSG_5681:{towgs84:"584.9636,107.7175,413.8067,1.1155,0.2824,-3.1384,7.9922"},EPSG_4141:{towgs84:"23.772,17.49,17.859,-0.3132,-1.85274,1.67299,-5.4262"},EPSG_4204:{towgs84:"-85.645,-273.077,-79.708,2.289,-1.421,2.532,3.194"},EPSG_4319:{towgs84:"226.702,-193.337,-35.371,-2.229,-4.391,9.238,0.9798"},EPSG_4200:{towgs84:"24.82,-131.21,-82.66"},EPSG_4130:{towgs84:"0,0,0"},EPSG_4127:{towgs84:"-82.875,-57.097,-156.768,-2.158,1.524,-0.982,-0.359"},EPSG_4149:{towgs84:"674.374,15.056,405.346"},EPSG_4617:{towgs84:"-0.991,1.9072,0.5129,1.25033e-7,4.6785e-8,5.6529e-8,0"},EPSG_4663:{towgs84:"-210.502,-66.902,-48.476,2.094,-15.067,-5.817,0.485"},EPSG_4664:{towgs84:"-211.939,137.626,58.3,-0.089,0.251,0.079,0.384"},EPSG_4665:{towgs84:"-105.854,165.589,-38.312,-0.003,-0.026,0.024,-0.048"},EPSG_4666:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},EPSG_4756:{towgs84:"-192.873,-39.382,-111.202,-0.00205,-0.0005,0.00335,0.0188"},EPSG_4723:{towgs84:"-179.483,-69.379,-27.584,-7.862,8.163,6.042,-13.925"},EPSG_4726:{towgs84:"8.853,-52.644,180.304,-0.393,-2.323,2.96,-24.081"},EPSG_4267:{towgs84:"-8.0,160.0,176.0"},EPSG_5365:{towgs84:"-0.16959,0.35312,0.51846,0.03385,-0.16325,0.03446,0.03693"},EPSG_4218:{towgs84:"304.5,306.5,-318.1"},EPSG_4242:{towgs84:"-33.722,153.789,94.959,-8.581,-4.478,4.54,8.95"},EPSG_4216:{towgs84:"-292.295,248.758,429.447,4.9971,2.99,6.6906,1.0289"},ESRI_104105:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},ESRI_104129:{towgs84:"0,0,0"},EPSG_4673:{towgs84:"174.05,-25.49,112.57"},EPSG_4202:{towgs84:"-124,-60,154"},EPSG_4203:{towgs84:"-117.763,-51.51,139.061,0.292,0.443,0.277,-0.191"},EPSG_3819:{towgs84:"595.48,121.69,515.35,4.115,-2.9383,0.853,-3.408"},EPSG_8694:{towgs84:"-93.799,-132.737,-219.073,-1.844,0.648,-6.37,-0.169"},EPSG_4145:{towgs84:"275.57,676.78,229.6"},EPSG_4283:{towgs84:"61.55,-10.87,-40.19,39.4924,32.7221,32.8979,-9.994"},EPSG_4317:{towgs84:"2.3287,-147.0425,-92.0802,-0.3092483,0.32482185,0.49729934,5.68906266"},EPSG_4272:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993"},EPSG_4248:{towgs84:"-307.7,265.3,-363.5"},EPSG_5561:{towgs84:"24,-121,-76"},EPSG_5233:{towgs84:"-0.293,766.95,87.713,0.195704,1.695068,3.473016,-0.039338"},ESRI_104130:{towgs84:"-86,-98,-119"},ESRI_104102:{towgs84:"682,-203,480"},ESRI_37207:{towgs84:"7,-10,-26"},EPSG_4675:{towgs84:"59.935,118.4,-10.871"},ESRI_104109:{towgs84:"-89.121,-348.182,260.871"},ESRI_104112:{towgs84:"-185.583,-230.096,281.361"},ESRI_104113:{towgs84:"25.1,-275.6,222.6"},IGNF_WGS72G:{towgs84:"0,12,6"},IGNF_NTFG:{towgs84:"-168,-60,320"},IGNF_EFATE57G:{towgs84:"-127,-769,472"},IGNF_PGP50G:{towgs84:"324.8,153.6,172.1"},IGNF_REUN47G:{towgs84:"94,-948,-1262"},IGNF_CSG67G:{towgs84:"-186,230,110"},IGNF_GUAD48G:{towgs84:"-467,-16,-300"},IGNF_TAHI51G:{towgs84:"162,117,154"},IGNF_TAHAAG:{towgs84:"65,342,77"},IGNF_NUKU72G:{towgs84:"84,274,65"},IGNF_PETRELS72G:{towgs84:"365,194,166"},IGNF_WALL78G:{towgs84:"253,-133,-127"},IGNF_MAYO50G:{towgs84:"-382,-59,-262"},IGNF_TANNAG:{towgs84:"-139,-967,436"},IGNF_IGN72G:{towgs84:"-13,-348,292"},IGNF_ATIGG:{towgs84:"1118,23,66"},IGNF_FANGA84G:{towgs84:"150.57,158.33,118.32"},IGNF_RUSAT84G:{towgs84:"202.13,174.6,-15.74"},IGNF_KAUE70G:{towgs84:"126.74,300.1,-75.49"},IGNF_MOP90G:{towgs84:"-10.8,-1.8,12.77"},IGNF_MHPF67G:{towgs84:"338.08,212.58,-296.17"},IGNF_TAHI79G:{towgs84:"160.61,116.05,153.69"},IGNF_ANAA92G:{towgs84:"1.5,3.84,4.81"},IGNF_MARQUI72G:{towgs84:"330.91,-13.92,58.56"},IGNF_APAT86G:{towgs84:"143.6,197.82,74.05"},IGNF_TUBU69G:{towgs84:"237.17,171.61,-77.84"},IGNF_STPM50G:{towgs84:"11.363,424.148,373.13"},EPSG_4150:{towgs84:"674.374,15.056,405.346"},EPSG_4754:{towgs84:"-208.4058,-109.8777,-2.5764"},ESRI_104101:{towgs84:"374,150,588"},EPSG_4693:{towgs84:"0,-0.15,0.68"},EPSG_6207:{towgs84:"293.17,726.18,245.36"},EPSG_4153:{towgs84:"-133.63,-157.5,-158.62"},EPSG_4132:{towgs84:"-241.54,-163.64,396.06"},EPSG_4221:{towgs84:"-154.5,150.7,100.4"},EPSG_4266:{towgs84:"-80.7,-132.5,41.1"},EPSG_4193:{towgs84:"-70.9,-151.8,-41.4"},EPSG_5340:{towgs84:"-0.41,0.46,-0.35"},EPSG_4246:{towgs84:"-294.7,-200.1,525.5"},EPSG_4318:{towgs84:"-3.2,-5.7,2.8"},EPSG_4121:{towgs84:"-199.87,74.79,246.62"},EPSG_4223:{towgs84:"-260.1,5.5,432.2"},EPSG_4158:{towgs84:"-0.465,372.095,171.736"},EPSG_4285:{towgs84:"-128.16,-282.42,21.93"},EPSG_4613:{towgs84:"-404.78,685.68,45.47"},EPSG_4607:{towgs84:"195.671,332.517,274.607"},EPSG_4475:{towgs84:"-381.788,-57.501,-256.673"},EPSG_4208:{towgs84:"-157.84,308.54,-146.6"},EPSG_4743:{towgs84:"70.995,-335.916,262.898"},EPSG_4710:{towgs84:"-323.65,551.39,-491.22"},EPSG_7881:{towgs84:"-0.077,0.079,0.086"},EPSG_4682:{towgs84:"283.729,735.942,261.143"},EPSG_4739:{towgs84:"-156,-271,-189"},EPSG_4679:{towgs84:"-80.01,253.26,291.19"},EPSG_4750:{towgs84:"-56.263,16.136,-22.856"},EPSG_4644:{towgs84:"-10.18,-350.43,291.37"},EPSG_4695:{towgs84:"-103.746,-9.614,-255.95"},EPSG_4292:{towgs84:"-355,21,72"},EPSG_4302:{towgs84:"-61.702,284.488,472.052"},EPSG_4143:{towgs84:"-124.76,53,466.79"},EPSG_4606:{towgs84:"-153,153,307"},EPSG_4699:{towgs84:"-770.1,158.4,-498.2"},EPSG_4247:{towgs84:"-273.5,110.6,-357.9"},EPSG_4160:{towgs84:"8.88,184.86,106.69"},EPSG_4161:{towgs84:"-233.43,6.65,173.64"},EPSG_9251:{towgs84:"-9.5,122.9,138.2"},EPSG_9253:{towgs84:"-78.1,101.6,133.3"},EPSG_4297:{towgs84:"-198.383,-240.517,-107.909"},EPSG_4269:{towgs84:"0,0,0"},EPSG_4301:{towgs84:"-147,506,687"},EPSG_4618:{towgs84:"-59,-11,-52"},EPSG_4612:{towgs84:"0,0,0"},EPSG_4678:{towgs84:"44.585,-131.212,-39.544"},EPSG_4250:{towgs84:"-130,29,364"},EPSG_4144:{towgs84:"214,804,268"},EPSG_4147:{towgs84:"-17.51,-108.32,-62.39"},EPSG_4259:{towgs84:"-254.1,-5.36,-100.29"},EPSG_4164:{towgs84:"-76,-138,67"},EPSG_4211:{towgs84:"-378.873,676.002,-46.255"},EPSG_4182:{towgs84:"-422.651,-172.995,84.02"},EPSG_4224:{towgs84:"-143.87,243.37,-33.52"},EPSG_4225:{towgs84:"-205.57,168.77,-4.12"},EPSG_5527:{towgs84:"-67.35,3.88,-38.22"},EPSG_4752:{towgs84:"98,390,-22"},EPSG_4310:{towgs84:"-30,190,89"},EPSG_9248:{towgs84:"-192.26,65.72,132.08"},EPSG_4680:{towgs84:"124.5,-63.5,-281"},EPSG_4701:{towgs84:"-79.9,-158,-168.9"},EPSG_4706:{towgs84:"-146.21,112.63,4.05"},EPSG_4805:{towgs84:"682,-203,480"},EPSG_4201:{towgs84:"-165,-11,206"},EPSG_4210:{towgs84:"-157,-2,-299"},EPSG_4183:{towgs84:"-104,167,-38"},EPSG_4139:{towgs84:"11,72,-101"},EPSG_4668:{towgs84:"-86,-98,-119"},EPSG_4717:{towgs84:"-2,151,181"},EPSG_4732:{towgs84:"102,52,-38"},EPSG_4280:{towgs84:"-377,681,-50"},EPSG_4209:{towgs84:"-138,-105,-289"},EPSG_4261:{towgs84:"31,146,47"},EPSG_4658:{towgs84:"-73,46,-86"},EPSG_4721:{towgs84:"265.025,384.929,-194.046"},EPSG_4222:{towgs84:"-136,-108,-292"},EPSG_4601:{towgs84:"-255,-15,71"},EPSG_4602:{towgs84:"725,685,536"},EPSG_4603:{towgs84:"72,213.7,93"},EPSG_4605:{towgs84:"9,183,236"},EPSG_4621:{towgs84:"137,248,-430"},EPSG_4657:{towgs84:"-28,199,5"},EPSG_4316:{towgs84:"103.25,-100.4,-307.19"},EPSG_4642:{towgs84:"-13,-348,292"},EPSG_4698:{towgs84:"145,-187,103"},EPSG_4192:{towgs84:"-206.1,-174.7,-87.7"},EPSG_4311:{towgs84:"-265,120,-358"},EPSG_4135:{towgs84:"58,-283,-182"},ESRI_104138:{towgs84:"198,-226,-347"},EPSG_4245:{towgs84:"-11,851,5"},EPSG_4142:{towgs84:"-125,53,467"},EPSG_4213:{towgs84:"-106,-87,188"},EPSG_4253:{towgs84:"-133,-77,-51"},EPSG_4129:{towgs84:"-132,-110,-335"},EPSG_4713:{towgs84:"-77,-128,142"},EPSG_4239:{towgs84:"217,823,299"},EPSG_4146:{towgs84:"295,736,257"},EPSG_4155:{towgs84:"-83,37,124"},EPSG_4165:{towgs84:"-173,253,27"},EPSG_4672:{towgs84:"175,-38,113"},EPSG_4236:{towgs84:"-637,-549,-203"},EPSG_4251:{towgs84:"-90,40,88"},EPSG_4271:{towgs84:"-2,374,172"},EPSG_4175:{towgs84:"-88,4,101"},EPSG_4716:{towgs84:"298,-304,-375"},EPSG_4315:{towgs84:"-23,259,-9"},EPSG_4744:{towgs84:"-242.2,-144.9,370.3"},EPSG_4244:{towgs84:"-97,787,86"},EPSG_4293:{towgs84:"616,97,-251"},EPSG_4714:{towgs84:"-127,-769,472"},EPSG_4736:{towgs84:"260,12,-147"},EPSG_6883:{towgs84:"-235,-110,393"},EPSG_6894:{towgs84:"-63,176,185"},EPSG_4205:{towgs84:"-43,-163,45"},EPSG_4256:{towgs84:"41,-220,-134"},EPSG_4262:{towgs84:"639,405,60"},EPSG_4604:{towgs84:"174,359,365"},EPSG_4169:{towgs84:"-115,118,426"},EPSG_4620:{towgs84:"-106,-129,165"},EPSG_4184:{towgs84:"-203,141,53"},EPSG_4616:{towgs84:"-289,-124,60"},EPSG_9403:{towgs84:"-307,-92,127"},EPSG_4684:{towgs84:"-133,-321,50"},EPSG_4708:{towgs84:"-491,-22,435"},EPSG_4707:{towgs84:"114,-116,-333"},EPSG_4709:{towgs84:"145,75,-272"},EPSG_4712:{towgs84:"-205,107,53"},EPSG_4711:{towgs84:"124,-234,-25"},EPSG_4718:{towgs84:"230,-199,-752"},EPSG_4719:{towgs84:"211,147,111"},EPSG_4724:{towgs84:"208,-435,-229"},EPSG_4725:{towgs84:"189,-79,-202"},EPSG_4735:{towgs84:"647,1777,-1124"},EPSG_4722:{towgs84:"-794,119,-298"},EPSG_4728:{towgs84:"-307,-92,127"},EPSG_4734:{towgs84:"-632,438,-609"},EPSG_4727:{towgs84:"912,-58,1227"},EPSG_4729:{towgs84:"185,165,42"},EPSG_4730:{towgs84:"170,42,84"},EPSG_4733:{towgs84:"276,-57,149"},ESRI_37218:{towgs84:"230,-199,-752"},ESRI_37240:{towgs84:"-7,215,225"},ESRI_37221:{towgs84:"252,-209,-751"},ESRI_4305:{towgs84:"-123,-206,219"},ESRI_104139:{towgs84:"-73,-247,227"},EPSG_4748:{towgs84:"51,391,-36"},EPSG_4219:{towgs84:"-384,664,-48"},EPSG_4255:{towgs84:"-333,-222,114"},EPSG_4257:{towgs84:"-587.8,519.75,145.76"},EPSG_4646:{towgs84:"-963,510,-359"},EPSG_6881:{towgs84:"-24,-203,268"},EPSG_6882:{towgs84:"-183,-15,273"},EPSG_4715:{towgs84:"-104,-129,239"},IGNF_RGF93GDD:{towgs84:"0,0,0"},IGNF_RGM04GDD:{towgs84:"0,0,0"},IGNF_RGSPM06GDD:{towgs84:"0,0,0"},IGNF_RGTAAF07GDD:{towgs84:"0,0,0"},IGNF_RGFG95GDD:{towgs84:"0,0,0"},IGNF_RGNCG:{towgs84:"0,0,0"},IGNF_RGPFGDD:{towgs84:"0,0,0"},IGNF_ETRS89G:{towgs84:"0,0,0"},IGNF_RGR92GDD:{towgs84:"0,0,0"},EPSG_4173:{towgs84:"0,0,0"},EPSG_4180:{towgs84:"0,0,0"},EPSG_4619:{towgs84:"0,0,0"},EPSG_4667:{towgs84:"0,0,0"},EPSG_4075:{towgs84:"0,0,0"},EPSG_6706:{towgs84:"0,0,0"},EPSG_7798:{towgs84:"0,0,0"},EPSG_4661:{towgs84:"0,0,0"},EPSG_4669:{towgs84:"0,0,0"},EPSG_8685:{towgs84:"0,0,0"},EPSG_4151:{towgs84:"0,0,0"},EPSG_9702:{towgs84:"0,0,0"},EPSG_4758:{towgs84:"0,0,0"},EPSG_4761:{towgs84:"0,0,0"},EPSG_4765:{towgs84:"0,0,0"},EPSG_8997:{towgs84:"0,0,0"},EPSG_4023:{towgs84:"0,0,0"},EPSG_4670:{towgs84:"0,0,0"},EPSG_4694:{towgs84:"0,0,0"},EPSG_4148:{towgs84:"0,0,0"},EPSG_4163:{towgs84:"0,0,0"},EPSG_4167:{towgs84:"0,0,0"},EPSG_4189:{towgs84:"0,0,0"},EPSG_4190:{towgs84:"0,0,0"},EPSG_4176:{towgs84:"0,0,0"},EPSG_4659:{towgs84:"0,0,0"},EPSG_3824:{towgs84:"0,0,0"},EPSG_3889:{towgs84:"0,0,0"},EPSG_4046:{towgs84:"0,0,0"},EPSG_4081:{towgs84:"0,0,0"},EPSG_4558:{towgs84:"0,0,0"},EPSG_4483:{towgs84:"0,0,0"},EPSG_5013:{towgs84:"0,0,0"},EPSG_5264:{towgs84:"0,0,0"},EPSG_5324:{towgs84:"0,0,0"},EPSG_5354:{towgs84:"0,0,0"},EPSG_5371:{towgs84:"0,0,0"},EPSG_5373:{towgs84:"0,0,0"},EPSG_5381:{towgs84:"0,0,0"},EPSG_5393:{towgs84:"0,0,0"},EPSG_5489:{towgs84:"0,0,0"},EPSG_5593:{towgs84:"0,0,0"},EPSG_6135:{towgs84:"0,0,0"},EPSG_6365:{towgs84:"0,0,0"},EPSG_5246:{towgs84:"0,0,0"},EPSG_7886:{towgs84:"0,0,0"},EPSG_8431:{towgs84:"0,0,0"},EPSG_8427:{towgs84:"0,0,0"},EPSG_8699:{towgs84:"0,0,0"},EPSG_8818:{towgs84:"0,0,0"},EPSG_4757:{towgs84:"0,0,0"},EPSG_9140:{towgs84:"0,0,0"},EPSG_8086:{towgs84:"0,0,0"},EPSG_4686:{towgs84:"0,0,0"},EPSG_4737:{towgs84:"0,0,0"},EPSG_4702:{towgs84:"0,0,0"},EPSG_4747:{towgs84:"0,0,0"},EPSG_4749:{towgs84:"0,0,0"},EPSG_4674:{towgs84:"0,0,0"},EPSG_4755:{towgs84:"0,0,0"},EPSG_4759:{towgs84:"0,0,0"},EPSG_4762:{towgs84:"0,0,0"},EPSG_4763:{towgs84:"0,0,0"},EPSG_4764:{towgs84:"0,0,0"},EPSG_4166:{towgs84:"0,0,0"},EPSG_4170:{towgs84:"0,0,0"},EPSG_5546:{towgs84:"0,0,0"},EPSG_7844:{towgs84:"0,0,0"},EPSG_4818:{towgs84:"589,76,480"}};for(var Hle in H_){var MS=H_[Hle];MS.datumName&&(H_[MS.datumName]=MS)}function Kle(n,e,t,r,i,s,a){var o={};return n===void 0||n==="none"?o.datum_type=Rb:o.datum_type=sle,e&&(o.datum_params=e.map(parseFloat),(o.datum_params[0]!==0||o.datum_params[1]!==0||o.datum_params[2]!==0)&&(o.datum_type=ed),o.datum_params.length>3&&(o.datum_params[3]!==0||o.datum_params[4]!==0||o.datum_params[5]!==0||o.datum_params[6]!==0)&&(o.datum_type=td,o.datum_params[3]*=km,o.datum_params[4]*=km,o.datum_params[5]*=km,o.datum_params[6]=o.datum_params[6]/1e6+1)),a&&(o.datum_type=Jf,o.grids=a),o.a=t,o.b=r,o.es=i,o.ep2=s,o}var AR={};function Yle(n,e,t){return e instanceof ArrayBuffer?Xle(n,e,t):{ready:qle(n,e)}}function Xle(n,e,t){var r=!0;t!==void 0&&t.includeErrorFields===!1&&(r=!1);var i=new DataView(e),s=Jle(i),a=ece(i,s),o=tce(i,a,s,r),l={header:a,subgrids:o};return AR[n]=l,l}async function qle(n,e){for(var t=[],r=await e.getImageCount(),i=r-1;i>=0;i--){var s=await e.getImage(i),a=await s.readRasters(),o=a,l=[s.getWidth(),s.getHeight()],u=s.getBoundingBox().map(IL),h=[s.fileDirectory.ModelPixelScale[0],s.fileDirectory.ModelPixelScale[1]].map(IL),f=u[0]+(l[0]-1)*h[0],g=u[3]-(l[1]-1)*h[1],y=o[0],v=o[1],x=[];for(let b=l[1]-1;b>=0;b--)for(let I=l[0]-1;I>=0;I--){var E=b*l[0]+I;x.push([-qc(v[E]),qc(y[E])])}t.push({del:h,lim:l,ll:[-f,g],cvs:x})}var T={header:{nSubgrids:r},subgrids:t};return AR[n]=T,T}function Zle(n){if(n===void 0)return null;var e=n.split(",");return e.map(Qle)}function Qle(n){if(n.length===0)return null;var e=n[0]==="@";return e&&(n=n.slice(1)),n==="null"?{name:"null",mandatory:!e,grid:null,isNull:!0}:{name:n,mandatory:!e,grid:AR[n]||null,isNull:!1}}function IL(n){return n*Math.PI/180}function qc(n){return n/3600*Math.PI/180}function Jle(n){var e=n.getInt32(8,!1);return e===11?!1:(e=n.getInt32(8,!0),e!==11&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}function ece(n,e){return{nFields:n.getInt32(8,e),nSubgridFields:n.getInt32(24,e),nSubgrids:n.getInt32(40,e),shiftType:kb(n,56,64).trim(),fromSemiMajorAxis:n.getFloat64(120,e),fromSemiMinorAxis:n.getFloat64(136,e),toSemiMajorAxis:n.getFloat64(152,e),toSemiMinorAxis:n.getFloat64(168,e)}}function kb(n,e,t){return String.fromCharCode.apply(null,new Uint8Array(n.buffer.slice(e,t)))}function tce(n,e,t,r){for(var i=176,s=[],a=0;a<e.nSubgrids;a++){var o=rce(n,i,t),l=ice(n,i,o,t,r),u=Math.round(1+(o.upperLongitude-o.lowerLongitude)/o.longitudeInterval),h=Math.round(1+(o.upperLatitude-o.lowerLatitude)/o.latitudeInterval);s.push({ll:[qc(o.lowerLongitude),qc(o.lowerLatitude)],del:[qc(o.longitudeInterval),qc(o.latitudeInterval)],lim:[u,h],count:o.gridNodeCount,cvs:nce(l)});var f=16;r===!1&&(f=8),i+=176+o.gridNodeCount*f}return s}function nce(n){return n.map(function(e){return[qc(e.longitudeShift),qc(e.latitudeShift)]})}function rce(n,e,t){return{name:kb(n,e+8,e+16).trim(),parent:kb(n,e+24,e+24+8).trim(),lowerLatitude:n.getFloat64(e+72,t),upperLatitude:n.getFloat64(e+88,t),lowerLongitude:n.getFloat64(e+104,t),upperLongitude:n.getFloat64(e+120,t),latitudeInterval:n.getFloat64(e+136,t),longitudeInterval:n.getFloat64(e+152,t),gridNodeCount:n.getInt32(e+168,t)}}function ice(n,e,t,r,i){var s=e+176,a=16;i===!1&&(a=8);for(var o=[],l=0;l<t.gridNodeCount;l++){var u={latitudeShift:n.getFloat32(s+l*a,r),longitudeShift:n.getFloat32(s+l*a+4,r)};i!==!1&&(u.latitudeAccuracy=n.getFloat32(s+l*a+8,r),u.longitudeAccuracy=n.getFloat32(s+l*a+12,r)),o.push(u)}return o}function Aa(n,e){if(!(this instanceof Aa))return new Aa(n);this.forward=null,this.inverse=null,this.init=null,this.name,this.names=null,this.title,e=e||function(u){if(u)throw u};var t=Ple(n);if(typeof t!="object"){e("Could not parse to valid json: "+n);return}var r=Aa.projections.get(t.projName);if(!r){e("Could not get projection name from: "+n);return}if(t.datumCode&&t.datumCode!=="none"){var i=yu(H_,t.datumCode);i&&(t.datum_params=t.datum_params||(i.towgs84?i.towgs84.split(","):null),t.ellps=i.ellipse,t.datumName=i.datumName?i.datumName:t.datumCode)}t.k0=t.k0||1,t.axis=t.axis||"enu",t.ellps=t.ellps||"wgs84",t.lat1=t.lat1||t.lat0;var s=Wle(t.a,t.b,t.rf,t.ellps,t.sphere),a=$le(s.a,s.b,s.rf,t.R_A),o=Zle(t.nadgrids),l=t.datum||Kle(t.datumCode,t.datum_params,s.a,s.b,a.es,a.ep2,o);TL(this,t),TL(this,r),this.a=s.a,this.b=s.b,this.rf=s.rf,this.sphere=s.sphere,this.es=a.es,this.e=a.e,this.ep2=a.ep2,this.datum=l,"init"in this&&typeof this.init=="function"&&this.init(),e(null,this)}Aa.projections=Ule;Aa.projections.start();function sce(n,e){return n.datum_type!==e.datum_type||n.a!==e.a||Math.abs(n.es-e.es)>5e-11?!1:n.datum_type===ed?n.datum_params[0]===e.datum_params[0]&&n.datum_params[1]===e.datum_params[1]&&n.datum_params[2]===e.datum_params[2]:n.datum_type===td?n.datum_params[0]===e.datum_params[0]&&n.datum_params[1]===e.datum_params[1]&&n.datum_params[2]===e.datum_params[2]&&n.datum_params[3]===e.datum_params[3]&&n.datum_params[4]===e.datum_params[4]&&n.datum_params[5]===e.datum_params[5]&&n.datum_params[6]===e.datum_params[6]:!0}function H9(n,e,t){var r=n.x,i=n.y,s=n.z?n.z:0,a,o,l,u;if(i<-We&&i>-1.001*We)i=-We;else if(i>We&&i<1.001*We)i=We;else{if(i<-We)return{x:-1/0,y:-1/0,z:n.z};if(i>We)return{x:1/0,y:1/0,z:n.z}}return r>Math.PI&&(r-=2*Math.PI),o=Math.sin(i),u=Math.cos(i),l=o*o,a=t/Math.sqrt(1-e*l),{x:(a+s)*u*Math.cos(r),y:(a+s)*u*Math.sin(r),z:(a*(1-e)+s)*o}}function K9(n,e,t,r){var i=1e-12,s=i*i,a=30,o,l,u,h,f,g,y,v,x,E,T,b,I,M=n.x,F=n.y,z=n.z?n.z:0,P,C,k;if(o=Math.sqrt(M*M+F*F),l=Math.sqrt(M*M+F*F+z*z),o/t<i){if(P=0,l/t<i)return C=We,k=-r,{x:n.x,y:n.y,z:n.z}}else P=Math.atan2(F,M);u=z/l,h=o/l,f=1/Math.sqrt(1-e*(2-e)*h*h),v=h*(1-e)*f,x=u*f,I=0;do I++,y=t/Math.sqrt(1-e*x*x),k=o*v+z*x-y*(1-e*x*x),g=e*y/(y+k),f=1/Math.sqrt(1-g*(2-g)*h*h),E=h*(1-g)*f,T=u*f,b=T*v-E*x,v=E,x=T;while(b*b>s&&I<a);return C=Math.atan(T/Math.abs(E)),{x:P,y:C,z:k}}function ace(n,e,t){if(e===ed)return{x:n.x+t[0],y:n.y+t[1],z:n.z+t[2]};if(e===td){var r=t[0],i=t[1],s=t[2],a=t[3],o=t[4],l=t[5],u=t[6];return{x:u*(n.x-l*n.y+o*n.z)+r,y:u*(l*n.x+n.y-a*n.z)+i,z:u*(-o*n.x+a*n.y+n.z)+s}}}function oce(n,e,t){if(e===ed)return{x:n.x-t[0],y:n.y-t[1],z:n.z-t[2]};if(e===td){var r=t[0],i=t[1],s=t[2],a=t[3],o=t[4],l=t[5],u=t[6],h=(n.x-r)/u,f=(n.y-i)/u,g=(n.z-s)/u;return{x:h+l*f-o*g,y:-l*h+f+a*g,z:o*h-a*f+g}}}function u_(n){return n===ed||n===td}function lce(n,e,t){if(sce(n,e)||n.datum_type===Rb||e.datum_type===Rb)return t;var r=n.a,i=n.es;if(n.datum_type===Jf){var s=AL(n,!1,t);if(s!==0)return;r=_L,i=xL}var a=e.a,o=e.b,l=e.es;if(e.datum_type===Jf&&(a=_L,o=ale,l=xL),i===l&&r===a&&!u_(n.datum_type)&&!u_(e.datum_type))return t;if(t=H9(t,i,r),u_(n.datum_type)&&(t=ace(t,n.datum_type,n.datum_params)),u_(e.datum_type)&&(t=oce(t,e.datum_type,e.datum_params)),t=K9(t,l,a,o),e.datum_type===Jf){var u=AL(e,!0,t);if(u!==0)return}return t}function AL(n,e,t){if(n.grids===null||n.grids.length===0)return console.log("Grid shift grids not found"),-1;var r={x:-t.x,y:t.y},i={x:Number.NaN,y:Number.NaN},s=[];e:for(var a=0;a<n.grids.length;a++){var o=n.grids[a];if(s.push(o.name),o.isNull){i=r;break}if(o.grid===null){if(o.mandatory)return console.log("Unable to find mandatory grid '"+o.name+"'"),-1;continue}for(var l=o.grid.subgrids,u=0,h=l.length;u<h;u++){var f=l[u],g=(Math.abs(f.del[1])+Math.abs(f.del[0]))/1e4,y=f.ll[0]-g,v=f.ll[1]-g,x=f.ll[0]+(f.lim[0]-1)*f.del[0]+g,E=f.ll[1]+(f.lim[1]-1)*f.del[1]+g;if(!(v>r.y||y>r.x||E<r.y||x<r.x)&&(i=cce(r,e,f),!isNaN(i.x)))break e}}return isNaN(i.x)?(console.log("Failed to find a grid shift table for location '"+-r.x*Rs+" "+r.y*Rs+" tried: '"+s+"'"),-1):(t.x=-i.x,t.y=i.y,0)}function cce(n,e,t){var r={x:Number.NaN,y:Number.NaN};if(isNaN(n.x))return r;var i={x:n.x,y:n.y};i.x-=t.ll[0],i.y-=t.ll[1],i.x=ht(i.x-Math.PI)+Math.PI;var s=RL(i,t);if(e){if(isNaN(s.x))return r;s.x=i.x-s.x,s.y=i.y-s.y;var a=9,o=1e-12,l,u;do{if(u=RL(s,t),isNaN(u.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}l={x:i.x-(u.x+s.x),y:i.y-(u.y+s.y)},s.x+=l.x,s.y+=l.y}while(a--&&Math.abs(l.x)>o&&Math.abs(l.y)>o);if(a<0)return console.log("Inverse grid shift iterator failed to converge."),r;r.x=ht(s.x+t.ll[0]),r.y=s.y+t.ll[1]}else isNaN(s.x)||(r.x=n.x+s.x,r.y=n.y+s.y);return r}function RL(n,e){var t={x:n.x/e.del[0],y:n.y/e.del[1]},r={x:Math.floor(t.x),y:Math.floor(t.y)},i={x:t.x-1*r.x,y:t.y-1*r.y},s={x:Number.NaN,y:Number.NaN},a;if(r.x<0||r.x>=e.lim[0]||r.y<0||r.y>=e.lim[1])return s;a=r.y*e.lim[0]+r.x;var o={x:e.cvs[a][0],y:e.cvs[a][1]};a++;var l={x:e.cvs[a][0],y:e.cvs[a][1]};a+=e.lim[0];var u={x:e.cvs[a][0],y:e.cvs[a][1]};a--;var h={x:e.cvs[a][0],y:e.cvs[a][1]},f=i.x*i.y,g=i.x*(1-i.y),y=(1-i.x)*(1-i.y),v=(1-i.x)*i.y;return s.x=y*o.x+g*l.x+v*h.x+f*u.x,s.y=y*o.y+g*l.y+v*h.y+f*u.y,s}function CL(n,e,t){var r=t.x,i=t.y,s=t.z||0,a,o,l,u={};for(l=0;l<3;l++)if(!(e&&l===2&&t.z===void 0))switch(l===0?(a=r,"ew".indexOf(n.axis[l])!==-1?o="x":o="y"):l===1?(a=i,"ns".indexOf(n.axis[l])!==-1?o="y":o="x"):(a=s,o="z"),n.axis[l]){case"e":u[o]=a;break;case"w":u[o]=-a;break;case"n":u[o]=a;break;case"s":u[o]=-a;break;case"u":t[o]!==void 0&&(u.z=a);break;case"d":t[o]!==void 0&&(u.z=-a);break;default:return null}return u}function Y9(n){var e={x:n[0],y:n[1]};return n.length>2&&(e.z=n[2]),n.length>3&&(e.m=n[3]),e}function uce(n){kL(n.x),kL(n.y)}function kL(n){if(typeof Number.isFinite=="function"){if(Number.isFinite(n))return;throw new TypeError("coordinates must be finite numbers")}if(typeof n!="number"||n!==n||!isFinite(n))throw new TypeError("coordinates must be finite numbers")}function hce(n,e){return(n.datum.datum_type===ed||n.datum.datum_type===td||n.datum.datum_type===Jf)&&e.datumCode!=="WGS84"||(e.datum.datum_type===ed||e.datum.datum_type===td||e.datum.datum_type===Jf)&&n.datumCode!=="WGS84"}function rv(n,e,t,r){var i;Array.isArray(t)?t=Y9(t):t={x:t.x,y:t.y,z:t.z,m:t.m};var s=t.z!==void 0;if(uce(t),n.datum&&e.datum&&hce(n,e)&&(i=new Aa("WGS84"),t=rv(n,i,t,r),n=i),r&&n.axis!=="enu"&&(t=CL(n,!1,t)),n.projName==="longlat")t={x:t.x*Ir,y:t.y*Ir,z:t.z||0};else if(n.to_meter&&(t={x:t.x*n.to_meter,y:t.y*n.to_meter,z:t.z||0}),t=n.inverse(t),!t)return;if(n.from_greenwich&&(t.x+=n.from_greenwich),t=lce(n.datum,e.datum,t),!!t)return t=t,e.from_greenwich&&(t={x:t.x-e.from_greenwich,y:t.y,z:t.z||0}),e.projName==="longlat"?t={x:t.x*Rs,y:t.y*Rs,z:t.z||0}:(t=e.forward(t),e.to_meter&&(t={x:t.x/e.to_meter,y:t.y/e.to_meter,z:t.z||0})),r&&e.axis!=="enu"?CL(e,!0,t):(t&&!s&&delete t.z,t)}var PL=Aa("WGS84");function NS(n,e,t,r){var i,s,a;return Array.isArray(t)?(i=rv(n,e,t,r)||{x:NaN,y:NaN},t.length>2?typeof n.name<"u"&&n.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"?typeof i.z=="number"?[i.x,i.y,i.z].concat(t.slice(3)):[i.x,i.y,t[2]].concat(t.slice(3)):[i.x,i.y].concat(t.slice(2)):[i.x,i.y]):(s=rv(n,e,t,r),a=Object.keys(t),a.length===2||a.forEach(function(o){if(typeof n.name<"u"&&n.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"){if(o==="x"||o==="y"||o==="z")return}else if(o==="x"||o==="y")return;s[o]=t[o]}),s)}function h_(n){return n instanceof Aa?n:typeof n=="object"&&"oProj"in n?n.oProj:Aa(n)}function dce(n,e,t){var r,i,s=!1,a;return typeof e>"u"?(i=h_(n),r=PL,s=!0):(typeof e.x<"u"||Array.isArray(e))&&(t=e,i=h_(n),r=PL,s=!0),r||(r=h_(n)),i||(i=h_(e)),t?NS(r,i,t):(a={forward:function(o,l){return NS(r,i,o,l)},inverse:function(o,l){return NS(i,r,o,l)}},s&&(a.oProj=i),a)}var ML=6,X9="AJSAJS",q9="AFAFAF",Gf=65,xs=73,_a=79,um=86,hm=90;const fce={forward:Z9,inverse:gce,toPoint:Q9};function Z9(n,e){return e=e||5,yce(mce({lat:n[1],lon:n[0]}),e)}function gce(n){var e=RR(e7(n.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat,e.lon,e.lat]:[e.left,e.bottom,e.right,e.top]}function Q9(n){var e=RR(e7(n.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}function LS(n){return n*(Math.PI/180)}function NL(n){return 180*(n/Math.PI)}function mce(n){var e=n.lat,t=n.lon,r=6378137,i=.00669438,s=.9996,a,o,l,u,h,f,g,y=LS(e),v=LS(t),x,E;E=Math.floor((t+180)/6)+1,t===180&&(E=60),e>=56&&e<64&&t>=3&&t<12&&(E=32),e>=72&&e<84&&(t>=0&&t<9?E=31:t>=9&&t<21?E=33:t>=21&&t<33?E=35:t>=33&&t<42&&(E=37)),a=(E-1)*6-180+3,x=LS(a),o=i/(1-i),l=r/Math.sqrt(1-i*Math.sin(y)*Math.sin(y)),u=Math.tan(y)*Math.tan(y),h=o*Math.cos(y)*Math.cos(y),f=Math.cos(y)*(v-x),g=r*((1-i/4-3*i*i/64-5*i*i*i/256)*y-(3*i/8+3*i*i/32+45*i*i*i/1024)*Math.sin(2*y)+(15*i*i/256+45*i*i*i/1024)*Math.sin(4*y)-35*i*i*i/3072*Math.sin(6*y));var T=s*l*(f+(1-u+h)*f*f*f/6+(5-18*u+u*u+72*h-58*o)*f*f*f*f*f/120)+5e5,b=s*(g+l*Math.tan(y)*(f*f/2+(5-u+9*h+4*h*h)*f*f*f*f/24+(61-58*u+u*u+600*h-330*o)*f*f*f*f*f*f/720));return e<0&&(b+=1e7),{northing:Math.round(b),easting:Math.round(T),zoneNumber:E,zoneLetter:pce(e)}}function RR(n){var e=n.northing,t=n.easting,r=n.zoneLetter,i=n.zoneNumber;if(i<0||i>60)return null;var s=.9996,a=6378137,o=.00669438,l,u=(1-Math.sqrt(1-o))/(1+Math.sqrt(1-o)),h,f,g,y,v,x,E,T,b,I=t-5e5,M=e;r<"N"&&(M-=1e7),E=(i-1)*6-180+3,l=o/(1-o),x=M/s,T=x/(a*(1-o/4-3*o*o/64-5*o*o*o/256)),b=T+(3*u/2-27*u*u*u/32)*Math.sin(2*T)+(21*u*u/16-55*u*u*u*u/32)*Math.sin(4*T)+151*u*u*u/96*Math.sin(6*T),h=a/Math.sqrt(1-o*Math.sin(b)*Math.sin(b)),f=Math.tan(b)*Math.tan(b),g=l*Math.cos(b)*Math.cos(b),y=a*(1-o)/Math.pow(1-o*Math.sin(b)*Math.sin(b),1.5),v=I/(h*s);var F=b-h*Math.tan(b)/y*(v*v/2-(5+3*f+10*g-4*g*g-9*l)*v*v*v*v/24+(61+90*f+298*g+45*f*f-252*l-3*g*g)*v*v*v*v*v*v/720);F=NL(F);var z=(v-(1+2*f+g)*v*v*v/6+(5-2*g+28*f-3*g*g+8*l+24*f*f)*v*v*v*v*v/120)/Math.cos(b);z=E+NL(z);var P;if(n.accuracy){var C=RR({northing:n.northing+n.accuracy,easting:n.easting+n.accuracy,zoneLetter:n.zoneLetter,zoneNumber:n.zoneNumber});P={top:C.lat,right:C.lon,bottom:F,left:z}}else P={lat:F,lon:z};return P}function pce(n){var e="Z";return 84>=n&&n>=72?e="X":72>n&&n>=64?e="W":64>n&&n>=56?e="V":56>n&&n>=48?e="U":48>n&&n>=40?e="T":40>n&&n>=32?e="S":32>n&&n>=24?e="R":24>n&&n>=16?e="Q":16>n&&n>=8?e="P":8>n&&n>=0?e="N":0>n&&n>=-8?e="M":-8>n&&n>=-16?e="L":-16>n&&n>=-24?e="K":-24>n&&n>=-32?e="J":-32>n&&n>=-40?e="H":-40>n&&n>=-48?e="G":-48>n&&n>=-56?e="F":-56>n&&n>=-64?e="E":-64>n&&n>=-72?e="D":-72>n&&n>=-80&&(e="C"),e}function yce(n,e){var t="00000"+n.easting,r="00000"+n.northing;return n.zoneNumber+n.zoneLetter+_ce(n.easting,n.northing,n.zoneNumber)+t.substr(t.length-5,e)+r.substr(r.length-5,e)}function _ce(n,e,t){var r=J9(t),i=Math.floor(n/1e5),s=Math.floor(e/1e5)%20;return xce(i,s,r)}function J9(n){var e=n%ML;return e===0&&(e=ML),e}function xce(n,e,t){var r=t-1,i=X9.charCodeAt(r),s=q9.charCodeAt(r),a=i+n-1,o=s+e,l=!1;a>hm&&(a=a-hm+Gf-1,l=!0),(a===xs||i<xs&&a>xs||(a>xs||i<xs)&&l)&&a++,(a===_a||i<_a&&a>_a||(a>_a||i<_a)&&l)&&(a++,a===xs&&a++),a>hm&&(a=a-hm+Gf-1),o>um?(o=o-um+Gf-1,l=!0):l=!1,(o===xs||s<xs&&o>xs||(o>xs||s<xs)&&l)&&o++,(o===_a||s<_a&&o>_a||(o>_a||s<_a)&&l)&&(o++,o===xs&&o++),o>um&&(o=o-um+Gf-1);var u=String.fromCharCode(a)+String.fromCharCode(o);return u}function e7(n){if(n&&n.length===0)throw"MGRSPoint coverting from nothing";for(var e=n.length,t=null,r="",i,s=0;!/[A-Z]/.test(i=n.charAt(s));){if(s>=2)throw"MGRSPoint bad conversion from: "+n;r+=i,s++}var a=parseInt(r,10);if(s===0||s+3>e)throw"MGRSPoint bad conversion from: "+n;var o=n.charAt(s++);if(o<="A"||o==="B"||o==="Y"||o>="Z"||o==="I"||o==="O")throw"MGRSPoint zone letter "+o+" not handled: "+n;t=n.substring(s,s+=2);for(var l=J9(a),u=vce(t.charAt(0),l),h=wce(t.charAt(1),l);h<Ece(o);)h+=2e6;var f=e-s;if(f%2!==0)throw`MGRSPoint has to have an even number 
of digits after the zone letter and two 100km letters - front 
half for easting meters, second half for 
northing meters`+n;var g=f/2,y=0,v=0,x,E,T,b,I;return g>0&&(x=1e5/Math.pow(10,g),E=n.substring(s,s+g),y=parseFloat(E)*x,T=n.substring(s+g),v=parseFloat(T)*x),b=y+u,I=v+h,{easting:b,northing:I,zoneLetter:o,zoneNumber:a,accuracy:x}}function vce(n,e){for(var t=X9.charCodeAt(e-1),r=1e5,i=!1;t!==n.charCodeAt(0);){if(t++,t===xs&&t++,t===_a&&t++,t>hm){if(i)throw"Bad character: "+n;t=Gf,i=!0}r+=1e5}return r}function wce(n,e){if(n>"V")throw"MGRSPoint given invalid Northing "+n;for(var t=q9.charCodeAt(e-1),r=0,i=!1;t!==n.charCodeAt(0);){if(t++,t===xs&&t++,t===_a&&t++,t>um){if(i)throw"Bad character: "+n;t=Gf,i=!0}r+=1e5}return r}function Ece(n){var e;switch(n){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+n}function P0(n,e,t){if(!(this instanceof P0))return new P0(n,e,t);if(Array.isArray(n))this.x=n[0],this.y=n[1],this.z=n[2]||0;else if(typeof n=="object")this.x=n.x,this.y=n.y,this.z=n.z||0;else if(typeof n=="string"&&typeof e>"u"){var r=n.split(",");this.x=parseFloat(r[0]),this.y=parseFloat(r[1]),this.z=parseFloat(r[2])||0}else this.x=n,this.y=e,this.z=t||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}P0.fromMGRS=function(n){return new P0(Q9(n))};P0.prototype.toMGRS=function(n){return Z9([this.x,this.y],n)};var Sce=1,Tce=.25,LL=.046875,OL=.01953125,DL=.01068115234375,bce=.75,Ice=.46875,Ace=.013020833333333334,Rce=.007120768229166667,Cce=.3645833333333333,kce=.005696614583333333,Pce=.3076171875;function CR(n){var e=[];e[0]=Sce-n*(Tce+n*(LL+n*(OL+n*DL))),e[1]=n*(bce-n*(LL+n*(OL+n*DL)));var t=n*n;return e[2]=t*(Ice-n*(Ace+n*Rce)),t*=n,e[3]=t*(Cce-n*kce),e[4]=t*n*Pce,e}function H0(n,e,t,r){return t*=e,e*=e,r[0]*n-t*(r[1]+e*(r[2]+e*(r[3]+e*r[4])))}var Mce=20;function kR(n,e,t){for(var r=1/(1-e),i=n,s=Mce;s;--s){var a=Math.sin(i),o=1-e*a*a;if(o=(H0(i,a,Math.cos(i),t)-n)*(o*Math.sqrt(o))*r,i-=o,Math.abs(o)<st)return i}return i}function Nce(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.es&&(this.en=CR(this.es),this.ml0=H0(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))}function Lce(n){var e=n.x,t=n.y,r=ht(e-this.long0,this.over),i,s,a,o=Math.sin(t),l=Math.cos(t);if(this.es){var h=l*r,f=Math.pow(h,2),g=this.ep2*Math.pow(l,2),y=Math.pow(g,2),v=Math.abs(l)>st?Math.tan(t):0,x=Math.pow(v,2),E=Math.pow(x,2);i=1-this.es*Math.pow(o,2),h=h/Math.sqrt(i);var T=H0(t,o,l,this.en);s=this.a*(this.k0*h*(1+f/6*(1-x+g+f/20*(5-18*x+E+14*g-58*x*g+f/42*(61+179*E-E*x-479*x)))))+this.x0,a=this.a*(this.k0*(T-this.ml0+o*r*h/2*(1+f/12*(5-x+9*g+4*y+f/30*(61+E-58*x+270*g-330*x*g+f/56*(1385+543*E-E*x-3111*x))))))+this.y0}else{var u=l*Math.sin(r);if(Math.abs(Math.abs(u)-1)<st)return 93;if(s=.5*this.a*this.k0*Math.log((1+u)/(1-u))+this.x0,a=l*Math.cos(r)/Math.sqrt(1-Math.pow(u,2)),u=Math.abs(a),u>=1){if(u-1>st)return 93;a=0}else a=Math.acos(a);t<0&&(a=-a),a=this.a*this.k0*(a-this.lat0)+this.y0}return n.x=s,n.y=a,n}function Oce(n){var e,t,r,i,s=(n.x-this.x0)*(1/this.a),a=(n.y-this.y0)*(1/this.a);if(this.es)if(e=this.ml0+a/this.k0,t=kR(e,this.es,this.en),Math.abs(t)<We){var f=Math.sin(t),g=Math.cos(t),y=Math.abs(g)>st?Math.tan(t):0,v=this.ep2*Math.pow(g,2),x=Math.pow(v,2),E=Math.pow(y,2),T=Math.pow(E,2);e=1-this.es*Math.pow(f,2);var b=s*Math.sqrt(e)/this.k0,I=Math.pow(b,2);e=e*y,r=t-e*I/(1-this.es)*.5*(1-I/12*(5+3*E-9*v*E+v-4*x-I/30*(61+90*E-252*v*E+45*T+46*v-I/56*(1385+3633*E+4095*T+1574*T*E)))),i=ht(this.long0+b*(1-I/6*(1+2*E+v-I/20*(5+28*E+24*T+8*v*E+6*v-I/42*(61+662*E+1320*T+720*T*E))))/g,this.over)}else r=We*T1(a),i=0;else{var o=Math.exp(s/this.k0),l=.5*(o-1/o),u=this.lat0+a/this.k0,h=Math.cos(u);e=Math.sqrt((1-Math.pow(h,2))/(1+Math.pow(l,2))),r=Math.asin(e),a<0&&(r=-r),l===0&&h===0?i=0:i=ht(Math.atan2(l,h)+this.long0,this.over)}return n.x=i,n.y=r,n}var Dce=["Fast_Transverse_Mercator","Fast Transverse Mercator"];const K_={init:Nce,forward:Lce,inverse:Oce,names:Dce};function t7(n){var e=Math.exp(n);return e=(e-1/e)/2,e}function bs(n,e){n=Math.abs(n),e=Math.abs(e);var t=Math.max(n,e),r=Math.min(n,e)/(t||1);return t*Math.sqrt(1+Math.pow(r,2))}function Fce(n){var e=1+n,t=e-1;return t===0?n:n*Math.log(e)/t}function jce(n){var e=Math.abs(n);return e=Fce(e*(1+e/(bs(1,e)+1))),n<0?-e:e}function PR(n,e){for(var t=2*Math.cos(2*e),r=n.length-1,i=n[r],s=0,a;--r>=0;)a=-s+t*i+n[r],s=i,i=a;return e+a*Math.sin(2*e)}function Vce(n,e){for(var t=2*Math.cos(e),r=n.length-1,i=n[r],s=0,a;--r>=0;)a=-s+t*i+n[r],s=i,i=a;return Math.sin(e)*a}function Gce(n){var e=Math.exp(n);return e=(e+1/e)/2,e}function n7(n,e,t){for(var r=Math.sin(e),i=Math.cos(e),s=t7(t),a=Gce(t),o=2*i*a,l=-2*r*s,u=n.length-1,h=n[u],f=0,g=0,y=0,v,x;--u>=0;)v=g,x=f,g=h,f=y,h=-v+o*g-l*f+n[u],y=-x+l*g+o*f;return o=r*a,l=i*s,[o*h-l*y,o*y+l*h]}function Bce(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(K_.init.apply(this),this.forward=K_.forward,this.inverse=K_.inverse),this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var n=this.es/(1+Math.sqrt(1-this.es)),e=n/(2-n),t=e;this.cgb[0]=e*(2+e*(-2/3+e*(-2+e*(116/45+e*(26/45+e*(-2854/675)))))),this.cbg[0]=e*(-2+e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725)))))),t=t*e,this.cgb[1]=t*(7/3+e*(-8/5+e*(-227/45+e*(2704/315+e*(2323/945))))),this.cbg[1]=t*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945))))),t=t*e,this.cgb[2]=t*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835)))),this.cbg[2]=t*(-26/15+e*(34/21+e*(8/5+e*(-12686/2835)))),t=t*e,this.cgb[3]=t*(4279/630+e*(-332/35+e*(-399572/14175))),this.cbg[3]=t*(1237/630+e*(-12/5+e*(-24832/14175))),t=t*e,this.cgb[4]=t*(4174/315+e*(-144838/6237)),this.cbg[4]=t*(-734/315+e*(109598/31185)),t=t*e,this.cgb[5]=t*(601676/22275),this.cbg[5]=t*(444337/155925),t=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+t*(1/4+t*(1/64+t/256))),this.utg[0]=e*(-.5+e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800)))))),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800)))))),this.utg[1]=t*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720))))),this.gtu[1]=t*(13/48+e*(-3/5+e*(557/1440+e*(281/630+e*(-1983433/1935360))))),t=t*e,this.utg[2]=t*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720)))),this.gtu[2]=t*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440)))),t=t*e,this.utg[3]=t*(-4397/161280+e*(11/504+e*(830251/7257600))),this.gtu[3]=t*(49561/161280+e*(-179/168+e*(6601661/7257600))),t=t*e,this.utg[4]=t*(-4583/161280+e*(108847/3991680)),this.gtu[4]=t*(34729/80640+e*(-3418889/1995840)),t=t*e,this.utg[5]=t*(-20648693/638668800),this.gtu[5]=t*(212378941/319334400);var r=PR(this.cbg,this.lat0);this.Zb=-this.Qn*(r+Vce(this.gtu,2*r))}function Uce(n){var e=ht(n.x-this.long0,this.over),t=n.y;t=PR(this.cbg,t);var r=Math.sin(t),i=Math.cos(t),s=Math.sin(e),a=Math.cos(e);t=Math.atan2(r,a*i),e=Math.atan2(s*i,bs(r,i*a)),e=jce(Math.tan(e));var o=n7(this.gtu,2*t,2*e);t=t+o[0],e=e+o[1];var l,u;return Math.abs(e)<=2.623395162778?(l=this.a*(this.Qn*e)+this.x0,u=this.a*(this.Qn*t+this.Zb)+this.y0):(l=1/0,u=1/0),n.x=l,n.y=u,n}function zce(n){var e=(n.x-this.x0)*(1/this.a),t=(n.y-this.y0)*(1/this.a);t=(t-this.Zb)/this.Qn,e=e/this.Qn;var r,i;if(Math.abs(e)<=2.623395162778){var s=n7(this.utg,2*t,2*e);t=t+s[0],e=e+s[1],e=Math.atan(t7(e));var a=Math.sin(t),o=Math.cos(t),l=Math.sin(e),u=Math.cos(e);t=Math.atan2(a*u,bs(l,u*o)),e=Math.atan2(l,u*o),r=ht(e+this.long0,this.over),i=PR(this.cgb,t)}else r=1/0,i=1/0;return n.x=r,n.y=i,n}var $ce=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"];const Y_={init:Bce,forward:Uce,inverse:zce,names:$ce};function Wce(n,e){if(n===void 0){if(n=Math.floor((ht(e)+Math.PI)*30/Math.PI)+1,n<0)return 0;if(n>60)return 60}return n}var Hce="etmerc";function Kce(){var n=Wce(this.zone,this.long0);if(n===void 0)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(n)-183)*Ir,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,Y_.init.apply(this),this.forward=Y_.forward,this.inverse=Y_.inverse}var Yce=["Universal Transverse Mercator System","utm"];const Xce={init:Kce,names:Yce,dependsOn:Hce};function MR(n,e){return Math.pow((1-n)/(1+n),e)}var qce=20;function Zce(){var n=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*n*n),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(n/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+Ln)/(Math.pow(Math.tan(.5*this.lat0+Ln),this.C)*MR(this.e*n,this.ratexp))}function Qce(n){var e=n.x,t=n.y;return n.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*t+Ln),this.C)*MR(this.e*Math.sin(t),this.ratexp))-We,n.x=this.C*e,n}function Jce(n){for(var e=1e-14,t=n.x/this.C,r=n.y,i=Math.pow(Math.tan(.5*r+Ln)/this.K,1/this.C),s=qce;s>0&&(r=2*Math.atan(i*MR(this.e*Math.sin(n.y),-.5*this.e))-We,!(Math.abs(r-n.y)<e));--s)n.y=r;return s?(n.x=t,n.y=r,n):null}const NR={init:Zce,forward:Qce,inverse:Jce};function eue(){NR.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))}function tue(n){var e,t,r,i;return n.x=ht(n.x-this.long0,this.over),NR.forward.apply(this,[n]),e=Math.sin(n.y),t=Math.cos(n.y),r=Math.cos(n.x),i=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*t*r),n.x=i*t*Math.sin(n.x),n.y=i*(this.cosc0*e-this.sinc0*t*r),n.x=this.a*n.x+this.x0,n.y=this.a*n.y+this.y0,n}function nue(n){var e,t,r,i,s;if(n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,n.x/=this.k0,n.y/=this.k0,s=bs(n.x,n.y)){var a=2*Math.atan2(s,this.R2);e=Math.sin(a),t=Math.cos(a),i=Math.asin(t*this.sinc0+n.y*e*this.cosc0/s),r=Math.atan2(n.x*e,s*this.cosc0*t-n.y*this.sinc0*e)}else i=this.phic0,r=0;return n.x=r,n.y=i,NR.inverse.apply(this,[n]),n.x=ht(n.x+this.long0,this.over),n}var rue=["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"];const iue={init:eue,forward:tue,inverse:nue,names:rue};function LR(n,e,t){return e*=t,Math.tan(.5*(We+n))*Math.pow((1-e)/(1+e),.5*t)}function sue(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=st&&(this.k0=.5*(1+T1(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=st&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=st&&Math.abs(Math.cos(this.lat_ts))>st&&(this.k0=.5*this.cons*Jo(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/so(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=Jo(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(LR(this.lat0,this.sinlat0,this.e))-We,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function aue(n){var e=n.x,t=n.y,r=Math.sin(t),i=Math.cos(t),s,a,o,l,u,h,f=ht(e-this.long0,this.over);return Math.abs(Math.abs(e-this.long0)-Math.PI)<=st&&Math.abs(t+this.lat0)<=st?(n.x=NaN,n.y=NaN,n):this.sphere?(s=2*this.k0/(1+this.sinlat0*r+this.coslat0*i*Math.cos(f)),n.x=this.a*s*i*Math.sin(f)+this.x0,n.y=this.a*s*(this.coslat0*r-this.sinlat0*i*Math.cos(f))+this.y0,n):(a=2*Math.atan(LR(t,r,this.e))-We,l=Math.cos(a),o=Math.sin(a),Math.abs(this.coslat0)<=st?(u=so(this.e,t*this.con,this.con*r),h=2*this.a*this.k0*u/this.cons,n.x=this.x0+h*Math.sin(e-this.long0),n.y=this.y0-this.con*h*Math.cos(e-this.long0),n):(Math.abs(this.sinlat0)<st?(s=2*this.a*this.k0/(1+l*Math.cos(f)),n.y=s*o):(s=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*o+this.cosX0*l*Math.cos(f))),n.y=s*(this.cosX0*o-this.sinX0*l*Math.cos(f))+this.y0),n.x=s*l*Math.sin(f)+this.x0,n))}function oue(n){n.x-=this.x0,n.y-=this.y0;var e,t,r,i,s,a=Math.sqrt(n.x*n.x+n.y*n.y);if(this.sphere){var o=2*Math.atan(a/(2*this.a*this.k0));return e=this.long0,t=this.lat0,a<=st?(n.x=e,n.y=t,n):(t=Math.asin(Math.cos(o)*this.sinlat0+n.y*Math.sin(o)*this.coslat0/a),Math.abs(this.coslat0)<st?this.lat0>0?e=ht(this.long0+Math.atan2(n.x,-1*n.y),this.over):e=ht(this.long0+Math.atan2(n.x,n.y),this.over):e=ht(this.long0+Math.atan2(n.x*Math.sin(o),a*this.coslat0*Math.cos(o)-n.y*this.sinlat0*Math.sin(o)),this.over),n.x=e,n.y=t,n)}else if(Math.abs(this.coslat0)<=st){if(a<=st)return t=this.lat0,e=this.long0,n.x=e,n.y=t,n;n.x*=this.con,n.y*=this.con,r=a*this.cons/(2*this.a*this.k0),t=this.con*Cp(this.e,r),e=this.con*ht(this.con*this.long0+Math.atan2(n.x,-1*n.y),this.over)}else i=2*Math.atan(a*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,a<=st?s=this.X0:(s=Math.asin(Math.cos(i)*this.sinX0+n.y*Math.sin(i)*this.cosX0/a),e=ht(this.long0+Math.atan2(n.x*Math.sin(i),a*this.cosX0*Math.cos(i)-n.y*this.sinX0*Math.sin(i)),this.over)),t=-1*Cp(this.e,Math.tan(.5*(We+s)));return n.x=e,n.y=t,n}var lue=["stere","Stereographic_South_Pole","Polar_Stereographic_variant_A","Polar_Stereographic_variant_B","Polar_Stereographic"];const cue={init:sue,forward:aue,inverse:oue,names:lue,ssfn_:LR};function uue(){var n=this.lat0;this.lambda0=this.long0;var e=Math.sin(n),t=this.a,r=this.rf,i=1/r,s=2*i-Math.pow(i,2),a=this.e=Math.sqrt(s);this.R=this.k0*t*Math.sqrt(1-s)/(1-s*Math.pow(e,2)),this.alpha=Math.sqrt(1+s/(1-s)*Math.pow(Math.cos(n),4)),this.b0=Math.asin(e/this.alpha);var o=Math.log(Math.tan(Math.PI/4+this.b0/2)),l=Math.log(Math.tan(Math.PI/4+n/2)),u=Math.log((1+a*e)/(1-a*e));this.K=o-this.alpha*l+this.alpha*a/2*u}function hue(n){var e=Math.log(Math.tan(Math.PI/4-n.y/2)),t=this.e/2*Math.log((1+this.e*Math.sin(n.y))/(1-this.e*Math.sin(n.y))),r=-this.alpha*(e+t)+this.K,i=2*(Math.atan(Math.exp(r))-Math.PI/4),s=this.alpha*(n.x-this.lambda0),a=Math.atan(Math.sin(s)/(Math.sin(this.b0)*Math.tan(i)+Math.cos(this.b0)*Math.cos(s))),o=Math.asin(Math.cos(this.b0)*Math.sin(i)-Math.sin(this.b0)*Math.cos(i)*Math.cos(s));return n.y=this.R/2*Math.log((1+Math.sin(o))/(1-Math.sin(o)))+this.y0,n.x=this.R*a+this.x0,n}function due(n){for(var e=n.x-this.x0,t=n.y-this.y0,r=e/this.R,i=2*(Math.atan(Math.exp(t/this.R))-Math.PI/4),s=Math.asin(Math.cos(this.b0)*Math.sin(i)+Math.sin(this.b0)*Math.cos(i)*Math.cos(r)),a=Math.atan(Math.sin(r)/(Math.cos(this.b0)*Math.cos(r)-Math.sin(this.b0)*Math.tan(i))),o=this.lambda0+a/this.alpha,l=0,u=s,h=-1e3,f=0;Math.abs(u-h)>1e-7;){if(++f>20)return;l=1/this.alpha*(Math.log(Math.tan(Math.PI/4+s/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(u))/2)),h=u,u=2*Math.atan(Math.exp(l))-Math.PI/2}return n.x=o,n.y=u,n}var fue=["somerc"];const gue={init:uue,forward:hue,inverse:due,names:fue};var Cf=1e-7;function mue(n){var e=["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"],t=typeof n.projName=="object"?Object.keys(n.projName)[0]:n.projName;return"no_uoff"in n||"no_off"in n||e.indexOf(t)!==-1||e.indexOf($9(t))!==-1}function pue(){var n,e,t,r,i,s,a,o,l,u,h=0,f,g=0,y=0,v=0,x=0,E=0,T=0;this.no_off=mue(this),this.no_rot="no_rot"in this;var b=!1;"alpha"in this&&(b=!0);var I=!1;if("rectified_grid_angle"in this&&(I=!0),b&&(T=this.alpha),I&&(h=this.rectified_grid_angle),b||I)g=this.longc;else if(y=this.long1,x=this.lat1,v=this.long2,E=this.lat2,Math.abs(x-E)<=Cf||(n=Math.abs(x))<=Cf||Math.abs(n-We)<=Cf||Math.abs(Math.abs(this.lat0)-We)<=Cf||Math.abs(Math.abs(E)-We)<=Cf)throw new Error;var M=1-this.es;e=Math.sqrt(M),Math.abs(this.lat0)>st?(o=Math.sin(this.lat0),t=Math.cos(this.lat0),n=1-this.es*o*o,this.B=t*t,this.B=Math.sqrt(1+this.es*this.B*this.B/M),this.A=this.B*this.k0*e/n,r=this.B*e/(t*Math.sqrt(n)),i=r*r-1,i<=0?i=0:(i=Math.sqrt(i),this.lat0<0&&(i=-i)),this.E=i+=r,this.E*=Math.pow(so(this.e,this.lat0,o),this.B)):(this.B=1/e,this.A=this.k0,this.E=r=i=1),b||I?(b?(f=Math.asin(Math.sin(T)/r),I||(h=T)):(f=h,T=Math.asin(r*Math.sin(f))),this.lam0=g-Math.asin(.5*(i-1/i)*Math.tan(f))/this.B):(s=Math.pow(so(this.e,x,Math.sin(x)),this.B),a=Math.pow(so(this.e,E,Math.sin(E)),this.B),i=this.E/s,l=(a-s)/(a+s),u=this.E*this.E,u=(u-a*s)/(u+a*s),n=y-v,n<-Math.PI?v-=Ap:n>Math.PI&&(v+=Ap),this.lam0=ht(.5*(y+v)-Math.atan(u*Math.tan(.5*this.B*(y-v))/l)/this.B,this.over),f=Math.atan(2*Math.sin(this.B*ht(y-this.lam0,this.over))/(i-1/i)),h=T=Math.asin(r*Math.sin(f))),this.singam=Math.sin(f),this.cosgam=Math.cos(f),this.sinrot=Math.sin(h),this.cosrot=Math.cos(h),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(r*r-1)/Math.cos(T))),this.lat0<0&&(this.u_0=-this.u_0)),i=.5*f,this.v_pole_n=this.ArB*Math.log(Math.tan(Ln-i)),this.v_pole_s=this.ArB*Math.log(Math.tan(Ln+i))}function yue(n){var e={},t,r,i,s,a,o,l,u;if(n.x=n.x-this.lam0,Math.abs(Math.abs(n.y)-We)>st){if(a=this.E/Math.pow(so(this.e,n.y,Math.sin(n.y)),this.B),o=1/a,t=.5*(a-o),r=.5*(a+o),s=Math.sin(this.B*n.x),i=(t*this.singam-s*this.cosgam)/r,Math.abs(Math.abs(i)-1)<st)throw new Error;u=.5*this.ArB*Math.log((1-i)/(1+i)),o=Math.cos(this.B*n.x),Math.abs(o)<Cf?l=this.A*n.x:l=this.ArB*Math.atan2(t*this.cosgam+s*this.singam,o)}else u=n.y>0?this.v_pole_n:this.v_pole_s,l=this.ArB*n.y;return this.no_rot?(e.x=l,e.y=u):(l-=this.u_0,e.x=u*this.cosrot+l*this.sinrot,e.y=l*this.cosrot-u*this.sinrot),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e}function _ue(n){var e,t,r,i,s,a,o,l={};if(n.x=(n.x-this.x0)*(1/this.a),n.y=(n.y-this.y0)*(1/this.a),this.no_rot?(t=n.y,e=n.x):(t=n.x*this.cosrot-n.y*this.sinrot,e=n.y*this.cosrot+n.x*this.sinrot+this.u_0),r=Math.exp(-this.BrA*t),i=.5*(r-1/r),s=.5*(r+1/r),a=Math.sin(this.BrA*e),o=(a*this.cosgam+i*this.singam)/s,Math.abs(Math.abs(o)-1)<st)l.x=0,l.y=o<0?-We:We;else{if(l.y=this.E/Math.sqrt((1+o)/(1-o)),l.y=Cp(this.e,Math.pow(l.y,1/this.B)),l.y===1/0)throw new Error;l.x=-this.rB*Math.atan2(i*this.cosgam-a*this.singam,Math.cos(this.BrA*e))}return l.x+=this.lam0,l}var xue=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Variant_B","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"];const vue={init:pue,forward:yue,inverse:_ue,names:xue};function wue(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<st)){var n=this.b/this.a;this.e=Math.sqrt(1-n*n);var e=Math.sin(this.lat1),t=Math.cos(this.lat1),r=Jo(this.e,e,t),i=so(this.e,this.lat1,e),s=Math.sin(this.lat2),a=Math.cos(this.lat2),o=Jo(this.e,s,a),l=so(this.e,this.lat2,s),u=Math.abs(Math.abs(this.lat0)-We)<st?0:so(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>st?this.ns=Math.log(r/o)/Math.log(i/l):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=r/(this.ns*Math.pow(i,this.ns)),this.rh=this.a*this.f0*Math.pow(u,this.ns),this.title||(this.title="Lambert Conformal Conic")}}function Eue(n){var e=n.x,t=n.y;Math.abs(2*Math.abs(t)-Math.PI)<=st&&(t=T1(t)*(We-2*st));var r=Math.abs(Math.abs(t)-We),i,s;if(r>st)i=so(this.e,t,Math.sin(t)),s=this.a*this.f0*Math.pow(i,this.ns);else{if(r=t*this.ns,r<=0)return null;s=0}var a=this.ns*ht(e-this.long0,this.over);return n.x=this.k0*(s*Math.sin(a))+this.x0,n.y=this.k0*(this.rh-s*Math.cos(a))+this.y0,n}function Sue(n){var e,t,r,i,s,a=(n.x-this.x0)/this.k0,o=this.rh-(n.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(a*a+o*o),t=1):(e=-Math.sqrt(a*a+o*o),t=-1);var l=0;if(e!==0&&(l=Math.atan2(t*a,t*o)),e!==0||this.ns>0){if(t=1/this.ns,r=Math.pow(e/(this.a*this.f0),t),i=Cp(this.e,r),i===-9999)return null}else i=-We;return s=ht(l/this.ns+this.long0,this.over),n.x=s,n.y=i,n}var Tue=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"];const bue={init:wue,forward:Eue,inverse:Sue,names:Tue};function Iue(){this.a=6377397155e-3,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.7417649320975901-.308341501185665),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq}function Aue(n){var e,t,r,i,s,a,o,l=n.x,u=n.y,h=ht(l-this.long0,this.over);return e=Math.pow((1+this.e*Math.sin(u))/(1-this.e*Math.sin(u)),this.alfa*this.e/2),t=2*(Math.atan(this.k*Math.pow(Math.tan(u/2+this.s45),this.alfa)/e)-this.s45),r=-h*this.alfa,i=Math.asin(Math.cos(this.ad)*Math.sin(t)+Math.sin(this.ad)*Math.cos(t)*Math.cos(r)),s=Math.asin(Math.cos(t)*Math.sin(r)/Math.cos(i)),a=this.n*s,o=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(i/2+this.s45),this.n),n.y=o*Math.cos(a)/1,n.x=o*Math.sin(a)/1,this.czech||(n.y*=-1,n.x*=-1),n}function Rue(n){var e,t,r,i,s,a,o,l,u=n.x;n.x=n.y,n.y=u,this.czech||(n.y*=-1,n.x*=-1),a=Math.sqrt(n.x*n.x+n.y*n.y),s=Math.atan2(n.y,n.x),i=s/Math.sin(this.s0),r=2*(Math.atan(Math.pow(this.ro0/a,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(r)-Math.sin(this.ad)*Math.cos(r)*Math.cos(i)),t=Math.asin(Math.cos(r)*Math.sin(i)/Math.cos(e)),n.x=this.long0-t/this.alfa,o=e,l=0;var h=0;do n.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(o))/(1-this.e*Math.sin(o)),this.e/2))-this.s45),Math.abs(o-n.y)<1e-10&&(l=1),o=n.y,h+=1;while(l===0&&h<15);return h>=15?null:n}var Cue=["Krovak","krovak"];const kue={init:Iue,forward:Aue,inverse:Rue,names:Cue};function cs(n,e,t,r,i){return n*i-e*Math.sin(2*i)+t*Math.sin(4*i)-r*Math.sin(6*i)}function b1(n){return 1-.25*n*(1+n/16*(3+1.25*n))}function I1(n){return .375*n*(1+.25*n*(1+.46875*n))}function A1(n){return .05859375*n*n*(1+.75*n)}function R1(n){return n*n*n*(35/3072)}function OR(n,e,t){var r=e*t;return n/Math.sqrt(1-r*r)}function Ru(n){return Math.abs(n)<We?n:n-T1(n)*Math.PI}function iv(n,e,t,r,i){var s,a;s=n/e;for(var o=0;o<15;o++)if(a=(n-(e*s-t*Math.sin(2*s)+r*Math.sin(4*s)-i*Math.sin(6*s)))/(e-2*t*Math.cos(2*s)+4*r*Math.cos(4*s)-6*i*Math.cos(6*s)),s+=a,Math.abs(a)<=1e-10)return s;return NaN}function Pue(){this.sphere||(this.e0=b1(this.es),this.e1=I1(this.es),this.e2=A1(this.es),this.e3=R1(this.es),this.ml0=this.a*cs(this.e0,this.e1,this.e2,this.e3,this.lat0))}function Mue(n){var e,t,r=n.x,i=n.y;if(r=ht(r-this.long0,this.over),this.sphere)e=this.a*Math.asin(Math.cos(i)*Math.sin(r)),t=this.a*(Math.atan2(Math.tan(i),Math.cos(r))-this.lat0);else{var s=Math.sin(i),a=Math.cos(i),o=OR(this.a,this.e,s),l=Math.tan(i)*Math.tan(i),u=r*Math.cos(i),h=u*u,f=this.es*a*a/(1-this.es),g=this.a*cs(this.e0,this.e1,this.e2,this.e3,i);e=o*u*(1-h*l*(1/6-(8-l+8*f)*h/120)),t=g-this.ml0+o*s/a*h*(.5+(5-l+6*f)*h/24)}return n.x=e+this.x0,n.y=t+this.y0,n}function Nue(n){n.x-=this.x0,n.y-=this.y0;var e=n.x/this.a,t=n.y/this.a,r,i;if(this.sphere){var s=t+this.lat0;r=Math.asin(Math.sin(s)*Math.cos(e)),i=Math.atan2(Math.tan(e),Math.cos(s))}else{var a=this.ml0/this.a+t,o=iv(a,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(o)-We)<=st)return n.x=this.long0,n.y=We,t<0&&(n.y*=-1),n;var l=OR(this.a,this.e,Math.sin(o)),u=l*l*l/this.a/this.a*(1-this.es),h=Math.pow(Math.tan(o),2),f=e*this.a/l,g=f*f;r=o-l*Math.tan(o)/u*f*f*(.5-(1+3*h)*f*f/24),i=f*(1-g*(h/3+(1+3*h)*h*g/15))/Math.cos(o)}return n.x=ht(i+this.long0,this.over),n.y=Ru(r),n}var Lue=["Cassini","Cassini_Soldner","cass"];const Oue={init:Pue,forward:Mue,inverse:Nue,names:Lue};function ou(n,e){var t;return n>1e-7?(t=n*e,(1-n*n)*(e/(1-t*t)-.5/n*Math.log((1-t)/(1+t)))):2*e}var Pb=1,Mb=2,Nb=3,X_=4;function Due(){var n=Math.abs(this.lat0);if(Math.abs(n-We)<st?this.mode=this.lat0<0?Pb:Mb:Math.abs(n)<st?this.mode=Nb:this.mode=X_,this.es>0){var e;switch(this.qp=ou(this.e,1),this.mmf=.5/(1-this.es),this.apa=Wue(this.es),this.mode){case Mb:this.dd=1;break;case Pb:this.dd=1;break;case Nb:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case X_:this.rq=Math.sqrt(.5*this.qp),e=Math.sin(this.lat0),this.sinb1=ou(this.e,e)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*e*e)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd;break}}else this.mode===X_&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function Fue(n){var e,t,r,i,s,a,o,l,u,h,f=n.x,g=n.y;if(f=ht(f-this.long0,this.over),this.sphere){if(s=Math.sin(g),h=Math.cos(g),r=Math.cos(f),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(t=this.mode===this.EQUIT?1+h*r:1+this.sinph0*s+this.cosph0*h*r,t<=st)return null;t=Math.sqrt(2/t),e=t*h*Math.sin(f),t*=this.mode===this.EQUIT?s:this.cosph0*s-this.sinph0*h*r}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(r=-r),Math.abs(g+this.lat0)<st)return null;t=Ln-g*.5,t=2*(this.mode===this.S_POLE?Math.cos(t):Math.sin(t)),e=t*Math.sin(f),t*=r}}else{switch(o=0,l=0,u=0,r=Math.cos(f),i=Math.sin(f),s=Math.sin(g),a=ou(this.e,s),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(o=a/this.qp,l=Math.sqrt(1-o*o)),this.mode){case this.OBLIQ:u=1+this.sinb1*o+this.cosb1*l*r;break;case this.EQUIT:u=1+l*r;break;case this.N_POLE:u=We+g,a=this.qp-a;break;case this.S_POLE:u=g-We,a=this.qp+a;break}if(Math.abs(u)<st)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:u=Math.sqrt(2/u),this.mode===this.OBLIQ?t=this.ymf*u*(this.cosb1*o-this.sinb1*l*r):t=(u=Math.sqrt(2/(1+l*r)))*o*this.ymf,e=this.xmf*u*l*i;break;case this.N_POLE:case this.S_POLE:a>=0?(e=(u=Math.sqrt(a))*i,t=r*(this.mode===this.S_POLE?u:-u)):e=t=0;break}}return n.x=this.a*e+this.x0,n.y=this.a*t+this.y0,n}function jue(n){n.x-=this.x0,n.y-=this.y0;var e=n.x/this.a,t=n.y/this.a,r,i,s,a,o,l,u;if(this.sphere){var h=0,f,g=0;if(f=Math.sqrt(e*e+t*t),i=f*.5,i>1)return null;switch(i=2*Math.asin(i),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(g=Math.sin(i),h=Math.cos(i)),this.mode){case this.EQUIT:i=Math.abs(f)<=st?0:Math.asin(t*g/f),e*=g,t=h*f;break;case this.OBLIQ:i=Math.abs(f)<=st?this.lat0:Math.asin(h*this.sinph0+t*g*this.cosph0/f),e*=g*this.cosph0,t=(h-Math.sin(i)*this.sinph0)*f;break;case this.N_POLE:t=-t,i=We-i;break;case this.S_POLE:i-=We;break}r=t===0&&(this.mode===this.EQUIT||this.mode===this.OBLIQ)?0:Math.atan2(e,t)}else{if(u=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(e/=this.dd,t*=this.dd,l=Math.sqrt(e*e+t*t),l<st)return n.x=this.long0,n.y=this.lat0,n;a=2*Math.asin(.5*l/this.rq),s=Math.cos(a),e*=a=Math.sin(a),this.mode===this.OBLIQ?(u=s*this.sinb1+t*a*this.cosb1/l,o=this.qp*u,t=l*this.cosb1*s-t*this.sinb1*a):(u=t*a/l,o=this.qp*u,t=l*s)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(t=-t),o=e*e+t*t,!o)return n.x=this.long0,n.y=this.lat0,n;u=1-o/this.qp,this.mode===this.S_POLE&&(u=-u)}r=Math.atan2(e,t),i=Hue(Math.asin(u),this.apa)}return n.x=ht(this.long0+r,this.over),n.y=i,n}var Vue=.3333333333333333,Gue=.17222222222222222,Bue=.10257936507936508,Uue=.06388888888888888,zue=.0664021164021164,$ue=.016415012942191543;function Wue(n){var e,t=[];return t[0]=n*Vue,e=n*n,t[0]+=e*Gue,t[1]=e*Uue,e*=n,t[0]+=e*Bue,t[1]+=e*zue,t[2]=e*$ue,t}function Hue(n,e){var t=n+n;return n+e[0]*Math.sin(t)+e[1]*Math.sin(t+t)+e[2]*Math.sin(t+t+t)}var Kue=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"];const Yue={init:Due,forward:Fue,inverse:jue,names:Kue,S_POLE:Pb,N_POLE:Mb,EQUIT:Nb,OBLIQ:X_};function _u(n){return Math.abs(n)>1&&(n=n>1?1:-1),Math.asin(n)}function Xue(){Math.abs(this.lat1+this.lat2)<st||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=Jo(this.e3,this.sin_po,this.cos_po),this.qs1=ou(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=Jo(this.e3,this.sin_po,this.cos_po),this.qs2=ou(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=ou(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>st?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function que(n){var e=n.x,t=n.y;this.sin_phi=Math.sin(t),this.cos_phi=Math.cos(t);var r=ou(this.e3,this.sin_phi),i=this.a*Math.sqrt(this.c-this.ns0*r)/this.ns0,s=this.ns0*ht(e-this.long0,this.over),a=i*Math.sin(s)+this.x0,o=this.rh-i*Math.cos(s)+this.y0;return n.x=a,n.y=o,n}function Zue(n){var e,t,r,i,s,a;return n.x-=this.x0,n.y=this.rh-n.y+this.y0,this.ns0>=0?(e=Math.sqrt(n.x*n.x+n.y*n.y),r=1):(e=-Math.sqrt(n.x*n.x+n.y*n.y),r=-1),i=0,e!==0&&(i=Math.atan2(r*n.x,r*n.y)),r=e*this.ns0/this.a,this.sphere?a=Math.asin((this.c-r*r)/(2*this.ns0)):(t=(this.c-r*r)/this.ns0,a=this.phi1z(this.e3,t)),s=ht(i/this.ns0+this.long0,this.over),n.x=s,n.y=a,n}function Que(n,e){var t,r,i,s,a,o=_u(.5*e);if(n<st)return o;for(var l=n*n,u=1;u<=25;u++)if(t=Math.sin(o),r=Math.cos(o),i=n*t,s=1-i*i,a=.5*s*s/r*(e/(1-l)-t/s+.5/n*Math.log((1-i)/(1+i))),o=o+a,Math.abs(a)<=1e-7)return o;return null}var Jue=["Albers_Conic_Equal_Area","Albers_Equal_Area","Albers","aea"];const ehe={init:Xue,forward:que,inverse:Zue,names:Jue,phi1z:Que};function the(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1}function nhe(n){var e,t,r,i,s,a,o,l,u=n.x,h=n.y;return r=ht(u-this.long0,this.over),e=Math.sin(h),t=Math.cos(h),i=Math.cos(r),a=this.sin_p14*e+this.cos_p14*t*i,s=1,a>0||Math.abs(a)<=st?(o=this.x0+this.a*s*t*Math.sin(r)/a,l=this.y0+this.a*s*(this.cos_p14*e-this.sin_p14*t*i)/a):(o=this.x0+this.infinity_dist*t*Math.sin(r),l=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*t*i)),n.x=o,n.y=l,n}function rhe(n){var e,t,r,i,s,a;return n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,n.x/=this.k0,n.y/=this.k0,(e=Math.sqrt(n.x*n.x+n.y*n.y))?(i=Math.atan2(e,this.rc),t=Math.sin(i),r=Math.cos(i),a=_u(r*this.sin_p14+n.y*t*this.cos_p14/e),s=Math.atan2(n.x*t,e*this.cos_p14*r-n.y*this.sin_p14*t),s=ht(this.long0+s,this.over)):(a=this.phic0,s=0),n.x=s,n.y=a,n}var ihe=["gnom"];const she={init:the,forward:nhe,inverse:rhe,names:ihe};function ahe(n,e){var t=1-(1-n*n)/(2*n)*Math.log((1-n)/(1+n));if(Math.abs(Math.abs(e)-t)<1e-6)return e<0?-1*We:We;for(var r=Math.asin(.5*e),i,s,a,o,l=0;l<30;l++)if(s=Math.sin(r),a=Math.cos(r),o=n*s,i=Math.pow(1-o*o,2)/(2*a)*(e/(1-n*n)-s/(1-o*o)+.5/n*Math.log((1-o)/(1+o))),r+=i,Math.abs(i)<=1e-10)return r;return NaN}function ohe(){this.sphere||(this.k0=Jo(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))}function lhe(n){var e=n.x,t=n.y,r,i,s=ht(e-this.long0,this.over);if(this.sphere)r=this.x0+this.a*s*Math.cos(this.lat_ts),i=this.y0+this.a*Math.sin(t)/Math.cos(this.lat_ts);else{var a=ou(this.e,Math.sin(t));r=this.x0+this.a*this.k0*s,i=this.y0+this.a*a*.5/this.k0}return n.x=r,n.y=i,n}function che(n){n.x-=this.x0,n.y-=this.y0;var e,t;return this.sphere?(e=ht(this.long0+n.x/this.a/Math.cos(this.lat_ts),this.over),t=Math.asin(n.y/this.a*Math.cos(this.lat_ts))):(t=ahe(this.e,2*n.y*this.k0/this.a),e=ht(this.long0+n.x/(this.a*this.k0),this.over)),n.x=e,n.y=t,n}var uhe=["cea"];const hhe={init:ohe,forward:lhe,inverse:che,names:uhe};function dhe(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)}function fhe(n){var e=n.x,t=n.y,r=ht(e-this.long0,this.over),i=Ru(t-this.lat0);return n.x=this.x0+this.a*r*this.rc,n.y=this.y0+this.a*i,n}function ghe(n){var e=n.x,t=n.y;return n.x=ht(this.long0+(e-this.x0)/(this.a*this.rc),this.over),n.y=Ru(this.lat0+(t-this.y0)/this.a),n}var mhe=["Equirectangular","Equidistant_Cylindrical","Equidistant_Cylindrical_Spherical","eqc"];const phe={init:dhe,forward:fhe,inverse:ghe,names:mhe};var FL=20;function yhe(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=b1(this.es),this.e1=I1(this.es),this.e2=A1(this.es),this.e3=R1(this.es),this.ml0=this.a*cs(this.e0,this.e1,this.e2,this.e3,this.lat0)}function _he(n){var e=n.x,t=n.y,r,i,s,a=ht(e-this.long0,this.over);if(s=a*Math.sin(t),this.sphere)Math.abs(t)<=st?(r=this.a*a,i=-1*this.a*this.lat0):(r=this.a*Math.sin(s)/Math.tan(t),i=this.a*(Ru(t-this.lat0)+(1-Math.cos(s))/Math.tan(t)));else if(Math.abs(t)<=st)r=this.a*a,i=-1*this.ml0;else{var o=OR(this.a,this.e,Math.sin(t))/Math.tan(t);r=o*Math.sin(s),i=this.a*cs(this.e0,this.e1,this.e2,this.e3,t)-this.ml0+o*(1-Math.cos(s))}return n.x=r+this.x0,n.y=i+this.y0,n}function xhe(n){var e,t,r,i,s,a,o,l,u;if(r=n.x-this.x0,i=n.y-this.y0,this.sphere)if(Math.abs(i+this.a*this.lat0)<=st)e=ht(r/this.a+this.long0,this.over),t=0;else{a=this.lat0+i/this.a,o=r*r/this.a/this.a+a*a,l=a;var h;for(s=FL;s;--s)if(h=Math.tan(l),u=-1*(a*(l*h+1)-l-.5*(l*l+o)*h)/((l-a)/h-1),l+=u,Math.abs(u)<=st){t=l;break}e=ht(this.long0+Math.asin(r*Math.tan(l)/this.a)/Math.sin(t),this.over)}else if(Math.abs(i+this.ml0)<=st)t=0,e=ht(this.long0+r/this.a,this.over);else{a=(this.ml0+i)/this.a,o=r*r/this.a/this.a+a*a,l=a;var f,g,y,v,x;for(s=FL;s;--s)if(x=this.e*Math.sin(l),f=Math.sqrt(1-x*x)*Math.tan(l),g=this.a*cs(this.e0,this.e1,this.e2,this.e3,l),y=this.e0-2*this.e1*Math.cos(2*l)+4*this.e2*Math.cos(4*l)-6*this.e3*Math.cos(6*l),v=g/this.a,u=(a*(f*v+1)-v-.5*f*(v*v+o))/(this.es*Math.sin(2*l)*(v*v+o-2*a*v)/(4*f)+(a-v)*(f*y-2/Math.sin(2*l))-y),l-=u,Math.abs(u)<=st){t=l;break}f=Math.sqrt(1-this.es*Math.pow(Math.sin(t),2))*Math.tan(t),e=ht(this.long0+Math.asin(r*f/this.a)/Math.sin(t),this.over)}return n.x=e,n.y=t,n}var vhe=["Polyconic","American_Polyconic","poly"];const whe={init:yhe,forward:_he,inverse:xhe,names:vhe};function Ehe(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function She(n){var e,t=n.x,r=n.y,i=r-this.lat0,s=t-this.long0,a=i/km*1e-5,o=s,l=1,u=0;for(e=1;e<=10;e++)l=l*a,u=u+this.A[e]*l;var h=u,f=o,g=1,y=0,v,x,E=0,T=0;for(e=1;e<=6;e++)v=g*h-y*f,x=y*h+g*f,g=v,y=x,E=E+this.B_re[e]*g-this.B_im[e]*y,T=T+this.B_im[e]*g+this.B_re[e]*y;return n.x=T*this.a+this.x0,n.y=E*this.a+this.y0,n}function The(n){var e,t=n.x,r=n.y,i=t-this.x0,s=r-this.y0,a=s/this.a,o=i/this.a,l=1,u=0,h,f,g=0,y=0;for(e=1;e<=6;e++)h=l*a-u*o,f=u*a+l*o,l=h,u=f,g=g+this.C_re[e]*l-this.C_im[e]*u,y=y+this.C_im[e]*l+this.C_re[e]*u;for(var v=0;v<this.iterations;v++){var x=g,E=y,T,b,I=a,M=o;for(e=2;e<=6;e++)T=x*g-E*y,b=E*g+x*y,x=T,E=b,I=I+(e-1)*(this.B_re[e]*x-this.B_im[e]*E),M=M+(e-1)*(this.B_im[e]*x+this.B_re[e]*E);x=1,E=0;var F=this.B_re[1],z=this.B_im[1];for(e=2;e<=6;e++)T=x*g-E*y,b=E*g+x*y,x=T,E=b,F=F+e*(this.B_re[e]*x-this.B_im[e]*E),z=z+e*(this.B_im[e]*x+this.B_re[e]*E);var P=F*F+z*z;g=(I*F+M*z)/P,y=(M*F-I*z)/P}var C=g,k=y,L=1,O=0;for(e=1;e<=9;e++)L=L*C,O=O+this.D[e]*L;var U=this.lat0+O*km*1e5,j=this.long0+k;return n.x=j,n.y=U,n}var bhe=["New_Zealand_Map_Grid","nzmg"];const Ihe={init:Ehe,forward:She,inverse:The,names:bhe};function Ahe(){}function Rhe(n){var e=n.x,t=n.y,r=ht(e-this.long0,this.over),i=this.x0+this.a*r,s=this.y0+this.a*Math.log(Math.tan(Math.PI/4+t/2.5))*1.25;return n.x=i,n.y=s,n}function Che(n){n.x-=this.x0,n.y-=this.y0;var e=ht(this.long0+n.x/this.a,this.over),t=2.5*(Math.atan(Math.exp(.8*n.y/this.a))-Math.PI/4);return n.x=e,n.y=t,n}var khe=["Miller_Cylindrical","mill"];const Phe={init:Ahe,forward:Rhe,inverse:Che,names:khe};var Mhe=20;function Nhe(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=CR(this.es)}function Lhe(n){var e,t,r=n.x,i=n.y;if(r=ht(r-this.long0,this.over),this.sphere){if(!this.m)i=this.n!==1?Math.asin(this.n*Math.sin(i)):i;else for(var s=this.n*Math.sin(i),a=Mhe;a;--a){var o=(this.m*i+Math.sin(i)-s)/(this.m+Math.cos(i));if(i-=o,Math.abs(o)<st)break}e=this.a*this.C_x*r*(this.m+Math.cos(i)),t=this.a*this.C_y*i}else{var l=Math.sin(i),u=Math.cos(i);t=this.a*H0(i,l,u,this.en),e=this.a*r*u/Math.sqrt(1-this.es*l*l)}return n.x=e,n.y=t,n}function Ohe(n){var e,t,r,i;return n.x-=this.x0,r=n.x/this.a,n.y-=this.y0,e=n.y/this.a,this.sphere?(e/=this.C_y,r=r/(this.C_x*(this.m+Math.cos(e))),this.m?e=_u((this.m*e+Math.sin(e))/this.n):this.n!==1&&(e=_u(Math.sin(e)/this.n)),r=ht(r+this.long0,this.over),e=Ru(e)):(e=kR(n.y/this.a,this.es,this.en),i=Math.abs(e),i<We?(i=Math.sin(e),t=this.long0+n.x*Math.sqrt(1-this.es*i*i)/(this.a*Math.cos(e)),r=ht(t,this.over)):i-st<We&&(r=this.long0)),n.x=r,n.y=e,n}var Dhe=["Sinusoidal","sinu"];const Fhe={init:Nhe,forward:Lhe,inverse:Ohe,names:Dhe};function jhe(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0}function Vhe(n){for(var e=n.x,t=n.y,r=ht(e-this.long0,this.over),i=t,s=Math.PI*Math.sin(t);;){var a=-(i+Math.sin(i)-s)/(1+Math.cos(i));if(i+=a,Math.abs(a)<st)break}i/=2,Math.PI/2-Math.abs(t)<st&&(r=0);var o=.900316316158*this.a*r*Math.cos(i)+this.x0,l=1.4142135623731*this.a*Math.sin(i)+this.y0;return n.x=o,n.y=l,n}function Ghe(n){var e,t;n.x-=this.x0,n.y-=this.y0,t=n.y/(1.4142135623731*this.a),Math.abs(t)>.999999999999&&(t=.999999999999),e=Math.asin(t);var r=ht(this.long0+n.x/(.900316316158*this.a*Math.cos(e)),this.over);r<-Math.PI&&(r=-Math.PI),r>Math.PI&&(r=Math.PI),t=(2*e+Math.sin(2*e))/Math.PI,Math.abs(t)>1&&(t=1);var i=Math.asin(t);return n.x=r,n.y=i,n}var Bhe=["Mollweide","moll"];const Uhe={init:jhe,forward:Vhe,inverse:Ghe,names:Bhe};function zhe(){Math.abs(this.lat1+this.lat2)<st||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=b1(this.es),this.e1=I1(this.es),this.e2=A1(this.es),this.e3=R1(this.es),this.sin_phi=Math.sin(this.lat1),this.cos_phi=Math.cos(this.lat1),this.ms1=Jo(this.e,this.sin_phi,this.cos_phi),this.ml1=cs(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<st?this.ns=this.sin_phi:(this.sin_phi=Math.sin(this.lat2),this.cos_phi=Math.cos(this.lat2),this.ms2=Jo(this.e,this.sin_phi,this.cos_phi),this.ml2=cs(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=cs(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))}function $he(n){var e=n.x,t=n.y,r;if(this.sphere)r=this.a*(this.g-t);else{var i=cs(this.e0,this.e1,this.e2,this.e3,t);r=this.a*(this.g-i)}var s=this.ns*ht(e-this.long0,this.over),a=this.x0+r*Math.sin(s),o=this.y0+this.rh-r*Math.cos(s);return n.x=a,n.y=o,n}function Whe(n){n.x-=this.x0,n.y=this.rh-n.y+this.y0;var e,t,r,i;this.ns>=0?(t=Math.sqrt(n.x*n.x+n.y*n.y),e=1):(t=-Math.sqrt(n.x*n.x+n.y*n.y),e=-1);var s=0;if(t!==0&&(s=Math.atan2(e*n.x,e*n.y)),this.sphere)return i=ht(this.long0+s/this.ns,this.over),r=Ru(this.g-t/this.a),n.x=i,n.y=r,n;var a=this.g-t/this.a;return r=iv(a,this.e0,this.e1,this.e2,this.e3),i=ht(this.long0+s/this.ns,this.over),n.x=i,n.y=r,n}var Hhe=["Equidistant_Conic","eqdc"];const Khe={init:zhe,forward:$he,inverse:Whe,names:Hhe};function Yhe(){this.R=this.a}function Xhe(n){var e=n.x,t=n.y,r=ht(e-this.long0,this.over),i,s;Math.abs(t)<=st&&(i=this.x0+this.R*r,s=this.y0);var a=_u(2*Math.abs(t/Math.PI));(Math.abs(r)<=st||Math.abs(Math.abs(t)-We)<=st)&&(i=this.x0,t>=0?s=this.y0+Math.PI*this.R*Math.tan(.5*a):s=this.y0+Math.PI*this.R*-Math.tan(.5*a));var o=.5*Math.abs(Math.PI/r-r/Math.PI),l=o*o,u=Math.sin(a),h=Math.cos(a),f=h/(u+h-1),g=f*f,y=f*(2/u-1),v=y*y,x=Math.PI*this.R*(o*(f-v)+Math.sqrt(l*(f-v)*(f-v)-(v+l)*(g-v)))/(v+l);r<0&&(x=-x),i=this.x0+x;var E=l+f;return x=Math.PI*this.R*(y*E-o*Math.sqrt((v+l)*(l+1)-E*E))/(v+l),t>=0?s=this.y0+x:s=this.y0-x,n.x=i,n.y=s,n}function qhe(n){var e,t,r,i,s,a,o,l,u,h,f,g,y;return n.x-=this.x0,n.y-=this.y0,f=Math.PI*this.R,r=n.x/f,i=n.y/f,s=r*r+i*i,a=-Math.abs(i)*(1+s),o=a-2*i*i+r*r,l=-2*a+1+2*i*i+s*s,y=i*i/l+(2*o*o*o/l/l/l-9*a*o/l/l)/27,u=(a-o*o/3/l)/l,h=2*Math.sqrt(-u/3),f=3*y/u/h,Math.abs(f)>1&&(f>=0?f=1:f=-1),g=Math.acos(f)/3,n.y>=0?t=(-h*Math.cos(g+Math.PI/3)-o/3/l)*Math.PI:t=-(-h*Math.cos(g+Math.PI/3)-o/3/l)*Math.PI,Math.abs(r)<st?e=this.long0:e=ht(this.long0+Math.PI*(s-1+Math.sqrt(1+2*(r*r-i*i)+s*s))/2/r,this.over),n.x=e,n.y=t,n}var Zhe=["Van_der_Grinten_I","VanDerGrinten","Van_der_Grinten","vandg"];const Qhe={init:Yhe,forward:Xhe,inverse:qhe,names:Zhe};function Jhe(n,e,t,r,i,s){const a=r-e,o=Math.atan((1-s)*Math.tan(n)),l=Math.atan((1-s)*Math.tan(t)),u=Math.sin(o),h=Math.cos(o),f=Math.sin(l),g=Math.cos(l);let y=a,v,x=100,E,T,b,I,M,F,z,P,C,k,L,O,U,j;do{if(E=Math.sin(y),T=Math.cos(y),b=Math.sqrt(g*E*(g*E)+(h*f-u*g*T)*(h*f-u*g*T)),b===0)return{azi1:0,s12:0};I=u*f+h*g*T,M=Math.atan2(b,I),F=h*g*E/b,z=1-F*F,P=z!==0?I-2*u*f/z:0,C=s/16*z*(4+s*(4-3*z)),v=y,y=a+(1-C)*s*F*(M+C*b*(P+C*I*(-1+2*P*P)))}while(Math.abs(y-v)>1e-12&&--x>0);return x===0?{azi1:NaN,s12:NaN}:(k=z*(i*i-i*(1-s)*(i*(1-s)))/(i*(1-s)*(i*(1-s))),L=1+k/16384*(4096+k*(-768+k*(320-175*k))),O=k/1024*(256+k*(-128+k*(74-47*k))),U=O*b*(P+O/4*(I*(-1+2*P*P)-O/6*P*(-3+4*b*b)*(-3+4*P*P))),j=i*(1-s)*L*(M-U),{azi1:Math.atan2(g*E,h*f-u*g*T),s12:j})}function ede(n,e,t,r,i,s){const a=Math.atan((1-s)*Math.tan(n)),o=Math.sin(a),l=Math.cos(a),u=Math.sin(t),h=Math.cos(t),f=Math.atan2(o,l*h),g=l*u,y=1-g*g,v=y*(i*i-i*(1-s)*(i*(1-s)))/(i*(1-s)*(i*(1-s))),x=1+v/16384*(4096+v*(-768+v*(320-175*v))),E=v/1024*(256+v*(-128+v*(74-47*v)));let T=r/(i*(1-s)*x),b,I=100,M,F,z,P;do M=Math.cos(2*f+T),F=Math.sin(T),z=Math.cos(T),P=E*F*(M+E/4*(z*(-1+2*M*M)-E/6*M*(-3+4*F*F)*(-3+4*M*M))),b=T,T=r/(i*(1-s)*x)+P;while(Math.abs(T-b)>1e-12&&--I>0);if(I===0)return{lat2:NaN,lon2:NaN};const C=o*F-l*z*h,k=Math.atan2(o*z+l*F*h,(1-s)*Math.sqrt(g*g+C*C)),L=Math.atan2(F*u,l*z-o*F*h),O=s/16*y*(4+s*(4-3*y)),U=L-(1-O)*s*g*(T+O*F*(M+O*z*(-1+2*M*M))),j=e+U;return{lat2:k,lon2:j}}function tde(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0),this.f=this.es/(1+Math.sqrt(1-this.es))}function nde(n){var e=n.x,t=n.y,r=Math.sin(n.y),i=Math.cos(n.y),s=ht(e-this.long0,this.over),a,o,l,u,h,f,g,y,v,x,E;return this.sphere?Math.abs(this.sin_p12-1)<=st?(n.x=this.x0+this.a*(We-t)*Math.sin(s),n.y=this.y0-this.a*(We-t)*Math.cos(s),n):Math.abs(this.sin_p12+1)<=st?(n.x=this.x0+this.a*(We+t)*Math.sin(s),n.y=this.y0+this.a*(We+t)*Math.cos(s),n):(v=this.sin_p12*r+this.cos_p12*i*Math.cos(s),g=Math.acos(v),y=g?g/Math.sin(g):1,n.x=this.x0+this.a*y*i*Math.sin(s),n.y=this.y0+this.a*y*(this.cos_p12*r-this.sin_p12*i*Math.cos(s)),n):(a=b1(this.es),o=I1(this.es),l=A1(this.es),u=R1(this.es),Math.abs(this.sin_p12-1)<=st?(h=this.a*cs(a,o,l,u,We),f=this.a*cs(a,o,l,u,t),n.x=this.x0+(h-f)*Math.sin(s),n.y=this.y0-(h-f)*Math.cos(s),n):Math.abs(this.sin_p12+1)<=st?(h=this.a*cs(a,o,l,u,We),f=this.a*cs(a,o,l,u,t),n.x=this.x0+(h+f)*Math.sin(s),n.y=this.y0+(h+f)*Math.cos(s),n):Math.abs(e)<st&&Math.abs(t-this.lat0)<st?(n.x=n.y=0,n):(x=Jhe(this.lat0,this.long0,t,e,this.a,this.f),E=x.azi1,n.x=x.s12*Math.sin(E),n.y=x.s12*Math.cos(E),n))}function rde(n){n.x-=this.x0,n.y-=this.y0;var e,t,r,i,s,a,o,l,u,h,f,g,y,v,x,E;return this.sphere?(e=Math.sqrt(n.x*n.x+n.y*n.y),e>2*We*this.a?void 0:(t=e/this.a,r=Math.sin(t),i=Math.cos(t),s=this.long0,Math.abs(e)<=st?a=this.lat0:(a=_u(i*this.sin_p12+n.y*r*this.cos_p12/e),o=Math.abs(this.lat0)-We,Math.abs(o)<=st?this.lat0>=0?s=ht(this.long0+Math.atan2(n.x,-n.y),this.over):s=ht(this.long0-Math.atan2(-n.x,n.y),this.over):s=ht(this.long0+Math.atan2(n.x*r,e*this.cos_p12*i-n.y*this.sin_p12*r),this.over)),n.x=s,n.y=a,n)):(l=b1(this.es),u=I1(this.es),h=A1(this.es),f=R1(this.es),Math.abs(this.sin_p12-1)<=st?(g=this.a*cs(l,u,h,f,We),e=Math.sqrt(n.x*n.x+n.y*n.y),y=g-e,a=iv(y/this.a,l,u,h,f),s=ht(this.long0+Math.atan2(n.x,-1*n.y),this.over),n.x=s,n.y=a,n):Math.abs(this.sin_p12+1)<=st?(g=this.a*cs(l,u,h,f,We),e=Math.sqrt(n.x*n.x+n.y*n.y),y=e-g,a=iv(y/this.a,l,u,h,f),s=ht(this.long0+Math.atan2(n.x,n.y),this.over),n.x=s,n.y=a,n):(v=Math.atan2(n.x,n.y),x=Math.sqrt(n.x*n.x+n.y*n.y),E=ede(this.lat0,this.long0,v,x,this.a,this.f),n.x=E.lon2,n.y=E.lat2,n))}var ide=["Azimuthal_Equidistant","aeqd"];const sde={init:tde,forward:nde,inverse:rde,names:ide};function ade(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)}function ode(n){var e,t,r,i,s,a,o,l,u=n.x,h=n.y;return r=ht(u-this.long0,this.over),e=Math.sin(h),t=Math.cos(h),i=Math.cos(r),a=this.sin_p14*e+this.cos_p14*t*i,s=1,(a>0||Math.abs(a)<=st)&&(o=this.a*s*t*Math.sin(r),l=this.y0+this.a*s*(this.cos_p14*e-this.sin_p14*t*i)),n.x=o,n.y=l,n}function lde(n){var e,t,r,i,s,a,o;return n.x-=this.x0,n.y-=this.y0,e=Math.sqrt(n.x*n.x+n.y*n.y),t=_u(e/this.a),r=Math.sin(t),i=Math.cos(t),a=this.long0,Math.abs(e)<=st?(o=this.lat0,n.x=a,n.y=o,n):(o=_u(i*this.sin_p14+n.y*r*this.cos_p14/e),s=Math.abs(this.lat0)-We,Math.abs(s)<=st?(this.lat0>=0?a=ht(this.long0+Math.atan2(n.x,-n.y),this.over):a=ht(this.long0-Math.atan2(-n.x,n.y),this.over),n.x=a,n.y=o,n):(a=ht(this.long0+Math.atan2(n.x*r,e*this.cos_p14*i-n.y*this.sin_p14*r),this.over),n.x=a,n.y=o,n))}var cde=["ortho"];const ude={init:ade,forward:ode,inverse:lde,names:cde};var wr={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},On={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function hde(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=We-Ln/2?this.face=wr.TOP:this.lat0<=-(We-Ln/2)?this.face=wr.BOTTOM:Math.abs(this.long0)<=Ln?this.face=wr.FRONT:Math.abs(this.long0)<=We+Ln?this.face=this.long0>0?wr.RIGHT:wr.LEFT:this.face=wr.BACK,this.es!==0&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)}function dde(n){var e={x:0,y:0},t,r,i,s,a,o,l={value:0};if(n.x-=this.long0,this.es!==0?t=Math.atan(this.one_minus_f_squared*Math.tan(n.y)):t=n.y,r=n.x,this.face===wr.TOP)s=We-t,r>=Ln&&r<=We+Ln?(l.value=On.AREA_0,i=r-We):r>We+Ln||r<=-(We+Ln)?(l.value=On.AREA_1,i=r>0?r-Fr:r+Fr):r>-(We+Ln)&&r<=-Ln?(l.value=On.AREA_2,i=r+We):(l.value=On.AREA_3,i=r);else if(this.face===wr.BOTTOM)s=We+t,r>=Ln&&r<=We+Ln?(l.value=On.AREA_0,i=-r+We):r<Ln&&r>=-Ln?(l.value=On.AREA_1,i=-r):r<-Ln&&r>=-(We+Ln)?(l.value=On.AREA_2,i=-r-We):(l.value=On.AREA_3,i=r>0?-r+Fr:-r-Fr);else{var u,h,f,g,y,v,x;this.face===wr.RIGHT?r=e0(r,+We):this.face===wr.BACK?r=e0(r,+Fr):this.face===wr.LEFT&&(r=e0(r,-We)),g=Math.sin(t),y=Math.cos(t),v=Math.sin(r),x=Math.cos(r),u=y*x,h=y*v,f=g,this.face===wr.FRONT?(s=Math.acos(u),i=d_(s,f,h,l)):this.face===wr.RIGHT?(s=Math.acos(h),i=d_(s,f,-u,l)):this.face===wr.BACK?(s=Math.acos(-u),i=d_(s,f,-h,l)):this.face===wr.LEFT?(s=Math.acos(-h),i=d_(s,f,u,l)):(s=i=0,l.value=On.AREA_0)}return o=Math.atan(12/Fr*(i+Math.acos(Math.sin(i)*Math.cos(Ln))-We)),a=Math.sqrt((1-Math.cos(s))/(Math.cos(o)*Math.cos(o))/(1-Math.cos(Math.atan(1/Math.cos(i))))),l.value===On.AREA_1?o+=We:l.value===On.AREA_2?o+=Fr:l.value===On.AREA_3&&(o+=1.5*Fr),e.x=a*Math.cos(o),e.y=a*Math.sin(o),e.x=e.x*this.a+this.x0,e.y=e.y*this.a+this.y0,n.x=e.x,n.y=e.y,n}function fde(n){var e={lam:0,phi:0},t,r,i,s,a,o,l,u,h,f={value:0};if(n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,r=Math.atan(Math.sqrt(n.x*n.x+n.y*n.y)),t=Math.atan2(n.y,n.x),n.x>=0&&n.x>=Math.abs(n.y)?f.value=On.AREA_0:n.y>=0&&n.y>=Math.abs(n.x)?(f.value=On.AREA_1,t-=We):n.x<0&&-n.x>=Math.abs(n.y)?(f.value=On.AREA_2,t=t<0?t+Fr:t-Fr):(f.value=On.AREA_3,t+=We),h=Fr/12*Math.tan(t),a=Math.sin(h)/(Math.cos(h)-1/Math.sqrt(2)),o=Math.atan(a),i=Math.cos(t),s=Math.tan(r),l=1-i*i*s*s*(1-Math.cos(Math.atan(1/Math.cos(o)))),l<-1?l=-1:l>1&&(l=1),this.face===wr.TOP)u=Math.acos(l),e.phi=We-u,f.value===On.AREA_0?e.lam=o+We:f.value===On.AREA_1?e.lam=o<0?o+Fr:o-Fr:f.value===On.AREA_2?e.lam=o-We:e.lam=o;else if(this.face===wr.BOTTOM)u=Math.acos(l),e.phi=u-We,f.value===On.AREA_0?e.lam=-o+We:f.value===On.AREA_1?e.lam=-o:f.value===On.AREA_2?e.lam=-o-We:e.lam=o<0?-o-Fr:-o+Fr;else{var g,y,v;g=l,h=g*g,h>=1?v=0:v=Math.sqrt(1-h)*Math.sin(o),h+=v*v,h>=1?y=0:y=Math.sqrt(1-h),f.value===On.AREA_1?(h=y,y=-v,v=h):f.value===On.AREA_2?(y=-y,v=-v):f.value===On.AREA_3&&(h=y,y=v,v=-h),this.face===wr.RIGHT?(h=g,g=-y,y=h):this.face===wr.BACK?(g=-g,y=-y):this.face===wr.LEFT&&(h=g,g=y,y=-h),e.phi=Math.acos(-v)-We,e.lam=Math.atan2(y,g),this.face===wr.RIGHT?e.lam=e0(e.lam,-We):this.face===wr.BACK?e.lam=e0(e.lam,-Fr):this.face===wr.LEFT&&(e.lam=e0(e.lam,+We))}if(this.es!==0){var x,E,T;x=e.phi<0?1:0,E=Math.tan(e.phi),T=this.b/Math.sqrt(E*E+this.one_minus_f_squared),e.phi=Math.atan(Math.sqrt(this.a*this.a-T*T)/(this.one_minus_f*T)),x&&(e.phi=-e.phi)}return e.lam+=this.long0,n.x=e.lam,n.y=e.phi,n}function d_(n,e,t,r){var i;return n<st?(r.value=On.AREA_0,i=0):(i=Math.atan2(e,t),Math.abs(i)<=Ln?r.value=On.AREA_0:i>Ln&&i<=We+Ln?(r.value=On.AREA_1,i-=We):i>We+Ln||i<=-(We+Ln)?(r.value=On.AREA_2,i=i>=0?i-Fr:i+Fr):(r.value=On.AREA_3,i+=We)),i}function e0(n,e){var t=n+e;return t<-Fr?t+=Ap:t>+Fr&&(t-=Ap),t}var gde=["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"];const mde={init:hde,forward:dde,inverse:fde,names:gde};var Lb=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-986701e-12],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,18736e-12],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,934959e-12],[.7986,-.00755338,-500009e-10,935324e-12],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],dm=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-126793e-14,422642e-15],[.124,.0124,507171e-14,-160604e-14],[.186,.0123999,-190189e-13,600152e-14],[.248,.0124002,710039e-13,-224e-10],[.31,.0123992,-264997e-12,835986e-13],[.372,.0124029,988983e-12,-311994e-12],[.434,.0123893,-369093e-11,-435621e-12],[.4958,.0123198,-102252e-10,-345523e-12],[.5571,.0121916,-154081e-10,-582288e-12],[.6176,.0119938,-241424e-10,-525327e-12],[.6769,.011713,-320223e-10,-516405e-12],[.7346,.0113541,-397684e-10,-609052e-12],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-140374e-14],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],r7=.8487,i7=1.3523,s7=Rs/5,pde=1/s7,Bf=18,sv=function(n,e){return n[0]+e*(n[1]+e*(n[2]+e*n[3]))},yde=function(n,e){return n[1]+e*(2*n[2]+e*3*n[3])};function _de(n,e,t,r){for(var i=e;r;--r){var s=n(i);if(i-=s,Math.abs(s)<t)break}return i}function xde(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"}function vde(n){var e=ht(n.x-this.long0,this.over),t=Math.abs(n.y),r=Math.floor(t*s7);r<0?r=0:r>=Bf&&(r=Bf-1),t=Rs*(t-pde*r);var i={x:sv(Lb[r],t)*e,y:sv(dm[r],t)};return n.y<0&&(i.y=-i.y),i.x=i.x*this.a*r7+this.x0,i.y=i.y*this.a*i7+this.y0,i}function wde(n){var e={x:(n.x-this.x0)/(this.a*r7),y:Math.abs(n.y-this.y0)/(this.a*i7)};if(e.y>=1)e.x/=Lb[Bf][0],e.y=n.y<0?-We:We;else{var t=Math.floor(e.y*Bf);for(t<0?t=0:t>=Bf&&(t=Bf-1);;)if(dm[t][0]>e.y)--t;else if(dm[t+1][0]<=e.y)++t;else break;var r=dm[t],i=5*(e.y-r[0])/(dm[t+1][0]-r[0]);i=_de(function(s){return(sv(r,s)-e.y)/yde(r,s)},i,st,100),e.x/=sv(Lb[t],i),e.y=(5*t+i)*Ir,n.y<0&&(e.y=-e.y)}return e.x=ht(e.x+this.long0,this.over),e}var Ede=["Robinson","robin"];const Sde={init:xde,forward:vde,inverse:wde,names:Ede};function Tde(){this.name="geocent"}function bde(n){var e=H9(n,this.es,this.a);return e}function Ide(n){var e=K9(n,this.es,this.a,this.b);return e}var Ade=["Geocentric","geocentric","geocent","Geocent"];const Rde={init:Tde,forward:bde,inverse:Ide,names:Ade};var $i={N_POLE:0,S_POLE:1,EQUIT:2,OBLIQ:3},Yg={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};function Cde(){if(Object.keys(Yg).forEach((function(t){if(typeof this[t]>"u")this[t]=Yg[t].def;else{if(Yg[t].num&&isNaN(this[t]))throw new Error("Invalid parameter value, must be numeric "+t+" = "+this[t]);Yg[t].num&&(this[t]=parseFloat(this[t]))}Yg[t].degrees&&(this[t]=this[t]*Ir)}).bind(this)),Math.abs(Math.abs(this.lat0)-We)<st?this.mode=this.lat0<0?$i.S_POLE:$i.N_POLE:Math.abs(this.lat0)<st?this.mode=$i.EQUIT:(this.mode=$i.OBLIQ,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var n=this.tilt,e=this.azi;this.cg=Math.cos(e),this.sg=Math.sin(e),this.cw=Math.cos(n),this.sw=Math.sin(n)}function kde(n){n.x-=this.long0;var e=Math.sin(n.y),t=Math.cos(n.y),r=Math.cos(n.x),i,s;switch(this.mode){case $i.OBLIQ:s=this.sinph0*e+this.cosph0*t*r;break;case $i.EQUIT:s=t*r;break;case $i.S_POLE:s=-e;break;case $i.N_POLE:s=e;break}switch(s=this.pn1/(this.p-s),i=s*t*Math.sin(n.x),this.mode){case $i.OBLIQ:s*=this.cosph0*e-this.sinph0*t*r;break;case $i.EQUIT:s*=e;break;case $i.N_POLE:s*=-(t*r);break;case $i.S_POLE:s*=t*r;break}var a,o;return a=s*this.cg+i*this.sg,o=1/(a*this.sw*this.h1+this.cw),i=(i*this.cg-s*this.sg)*this.cw*o,s=a*o,n.x=i*this.a,n.y=s*this.a,n}function Pde(n){n.x/=this.a,n.y/=this.a;var e={x:n.x,y:n.y},t,r,i;i=1/(this.pn1-n.y*this.sw),t=this.pn1*n.x*i,r=this.pn1*n.y*this.cw*i,n.x=t*this.cg+r*this.sg,n.y=r*this.cg-t*this.sg;var s=bs(n.x,n.y);if(Math.abs(s)<st)e.x=0,e.y=n.y;else{var a,o;switch(o=1-s*s*this.pfact,o=(this.p-Math.sqrt(o))/(this.pn1/s+s/this.pn1),a=Math.sqrt(1-o*o),this.mode){case $i.OBLIQ:e.y=Math.asin(a*this.sinph0+n.y*o*this.cosph0/s),n.y=(a-this.sinph0*Math.sin(e.y))*s,n.x*=o*this.cosph0;break;case $i.EQUIT:e.y=Math.asin(n.y*o/s),n.y=a*s,n.x*=o;break;case $i.N_POLE:e.y=Math.asin(a),n.y=-n.y;break;case $i.S_POLE:e.y=-Math.asin(a);break}e.x=Math.atan2(n.x,n.y)}return n.x=e.x+this.long0,n.y=e.y,n}var Mde=["Tilted_Perspective","tpers"];const Nde={init:Cde,forward:kde,inverse:Pde,names:Mde};function Lde(){if(this.flip_axis=this.sweep==="x"?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,this.es!==0){var n=1-this.es,e=1/n;this.radius_p=Math.sqrt(n),this.radius_p2=n,this.radius_p_inv2=e,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")}function Ode(n){var e=n.x,t=n.y,r,i,s,a;if(e=e-this.long0,this.shape==="ellipse"){t=Math.atan(this.radius_p2*Math.tan(t));var o=this.radius_p/bs(this.radius_p*Math.cos(t),Math.sin(t));if(i=o*Math.cos(e)*Math.cos(t),s=o*Math.sin(e)*Math.cos(t),a=o*Math.sin(t),(this.radius_g-i)*i-s*s-a*a*this.radius_p_inv2<0)return n.x=Number.NaN,n.y=Number.NaN,n;r=this.radius_g-i,this.flip_axis?(n.x=this.radius_g_1*Math.atan(s/bs(a,r)),n.y=this.radius_g_1*Math.atan(a/r)):(n.x=this.radius_g_1*Math.atan(s/r),n.y=this.radius_g_1*Math.atan(a/bs(s,r)))}else this.shape==="sphere"&&(r=Math.cos(t),i=Math.cos(e)*r,s=Math.sin(e)*r,a=Math.sin(t),r=this.radius_g-i,this.flip_axis?(n.x=this.radius_g_1*Math.atan(s/bs(a,r)),n.y=this.radius_g_1*Math.atan(a/r)):(n.x=this.radius_g_1*Math.atan(s/r),n.y=this.radius_g_1*Math.atan(a/bs(s,r))));return n.x=n.x*this.a,n.y=n.y*this.a,n}function Dde(n){var e=-1,t=0,r=0,i,s,a,o;if(n.x=n.x/this.a,n.y=n.y/this.a,this.shape==="ellipse"){this.flip_axis?(r=Math.tan(n.y/this.radius_g_1),t=Math.tan(n.x/this.radius_g_1)*bs(1,r)):(t=Math.tan(n.x/this.radius_g_1),r=Math.tan(n.y/this.radius_g_1)*bs(1,t));var l=r/this.radius_p;if(i=t*t+l*l+e*e,s=2*this.radius_g*e,a=s*s-4*i*this.C,a<0)return n.x=Number.NaN,n.y=Number.NaN,n;o=(-s-Math.sqrt(a))/(2*i),e=this.radius_g+o*e,t*=o,r*=o,n.x=Math.atan2(t,e),n.y=Math.atan(r*Math.cos(n.x)/e),n.y=Math.atan(this.radius_p_inv2*Math.tan(n.y))}else if(this.shape==="sphere"){if(this.flip_axis?(r=Math.tan(n.y/this.radius_g_1),t=Math.tan(n.x/this.radius_g_1)*Math.sqrt(1+r*r)):(t=Math.tan(n.x/this.radius_g_1),r=Math.tan(n.y/this.radius_g_1)*Math.sqrt(1+t*t)),i=t*t+r*r+e*e,s=2*this.radius_g*e,a=s*s-4*i*this.C,a<0)return n.x=Number.NaN,n.y=Number.NaN,n;o=(-s-Math.sqrt(a))/(2*i),e=this.radius_g+o*e,t*=o,r*=o,n.x=Math.atan2(t,e),n.y=Math.atan(r*Math.cos(n.x)/e)}return n.x=n.x+this.long0,n}var Fde=["Geostationary Satellite View","Geostationary_Satellite","geos"];const jde={init:Lde,forward:Ode,inverse:Dde,names:Fde};var Pm=1.340264,Mm=-.081106,Nm=893e-6,Lm=.003796,av=Math.sqrt(3)/2;function Vde(){this.es=0,this.long0=this.long0!==void 0?this.long0:0,this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0}function Gde(n){var e=ht(n.x-this.long0,this.over),t=n.y,r=Math.asin(av*Math.sin(t)),i=r*r,s=i*i*i;return n.x=e*Math.cos(r)/(av*(Pm+3*Mm*i+s*(7*Nm+9*Lm*i))),n.y=r*(Pm+Mm*i+s*(Nm+Lm*i)),n.x=this.a*n.x+this.x0,n.y=this.a*n.y+this.y0,n}function Bde(n){n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a;var e=1e-9,t=12,r=n.y,i,s,a,o,l,u;for(u=0;u<t&&(i=r*r,s=i*i*i,a=r*(Pm+Mm*i+s*(Nm+Lm*i))-n.y,o=Pm+3*Mm*i+s*(7*Nm+9*Lm*i),r-=l=a/o,!(Math.abs(l)<e));++u);return i=r*r,s=i*i*i,n.x=av*n.x*(Pm+3*Mm*i+s*(7*Nm+9*Lm*i))/Math.cos(r),n.y=Math.asin(Math.sin(r)/av),n.x=ht(n.x+this.long0,this.over),n}var Ude=["eqearth","Equal Earth","Equal_Earth"];const zde={init:Vde,forward:Gde,inverse:Bde,names:Ude};var kp=1e-10;function $de(){var n;if(this.phi1=this.lat1,Math.abs(this.phi1)<kp)throw new Error;this.es?(this.en=CR(this.es),this.m1=H0(this.phi1,this.am1=Math.sin(this.phi1),n=Math.cos(this.phi1),this.en),this.am1=n/(Math.sqrt(1-this.es*this.am1*this.am1)*this.am1),this.inverse=Hde,this.forward=Wde):(Math.abs(this.phi1)+kp>=We?this.cphi1=0:this.cphi1=1/Math.tan(this.phi1),this.inverse=Yde,this.forward=Kde)}function Wde(n){var e=ht(n.x-(this.long0||0),this.over),t=n.y,r,i,s;return r=this.am1+this.m1-H0(t,i=Math.sin(t),s=Math.cos(t),this.en),i=s*e/(r*Math.sqrt(1-this.es*i*i)),n.x=r*Math.sin(i),n.y=this.am1-r*Math.cos(i),n.x=this.a*n.x+(this.x0||0),n.y=this.a*n.y+(this.y0||0),n}function Hde(n){n.x=(n.x-(this.x0||0))/this.a,n.y=(n.y-(this.y0||0))/this.a;var e,t,r,i;if(t=bs(n.x,n.y=this.am1-n.y),i=kR(this.am1+this.m1-t,this.es,this.en),(e=Math.abs(i))<We)e=Math.sin(i),r=t*Math.atan2(n.x,n.y)*Math.sqrt(1-this.es*e*e)/Math.cos(i);else if(Math.abs(e-We)<=kp)r=0;else throw new Error;return n.x=ht(r+(this.long0||0),this.over),n.y=Ru(i),n}function Kde(n){var e=ht(n.x-(this.long0||0),this.over),t=n.y,r,i;return i=this.cphi1+this.phi1-t,Math.abs(i)>kp?(n.x=i*Math.sin(r=e*Math.cos(t)/i),n.y=this.cphi1-i*Math.cos(r)):n.x=n.y=0,n.x=this.a*n.x+(this.x0||0),n.y=this.a*n.y+(this.y0||0),n}function Yde(n){n.x=(n.x-(this.x0||0))/this.a,n.y=(n.y-(this.y0||0))/this.a;var e,t,r=bs(n.x,n.y=this.cphi1-n.y);if(t=this.cphi1+this.phi1-r,Math.abs(t)>We)throw new Error;return Math.abs(Math.abs(t)-We)<=kp?e=0:e=r*Math.atan2(n.x,n.y)/Math.cos(t),n.x=ht(e+(this.long0||0),this.over),n.y=Ru(t),n}var Xde=["bonne","Bonne (Werner lat_1=90)"];const qde={init:$de,names:Xde},jL={OBLIQUE:{forward:tfe,inverse:rfe},TRANSVERSE:{forward:nfe,inverse:ife}},ov={ROTATE:{o_alpha:"oAlpha",o_lon_c:"oLongC",o_lat_c:"oLatC"},NEW_POLE:{o_lat_p:"oLatP",o_lon_p:"oLongP"},NEW_EQUATOR:{o_lon_1:"oLong1",o_lat_1:"oLat1",o_lon_2:"oLong2",o_lat_2:"oLat2"}};function Zde(){if(this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.title=this.title||"General Oblique Transformation",this.isIdentity=U9.includes(this.o_proj),!this.o_proj)throw new Error("Missing parameter: o_proj");if(this.o_proj==="ob_tran")throw new Error("Invalid value for o_proj: "+this.o_proj);const n=this.projStr.replace("+proj=ob_tran","").replace("+o_proj=","+proj=").trim(),e=Aa(n);if(!e)throw new Error("Invalid parameter: o_proj. Unknown projection "+this.o_proj);e.long0=0,this.obliqueProjection=e;let t;const r=Object.keys(ov),i=o=>{if(typeof this[o]>"u")return;const l=parseFloat(this[o])*Ir;if(isNaN(l))throw new Error("Invalid value for "+o+": "+this[o]);return l};for(let o=0;o<r.length;o++){const l=r[o],u=ov[l],h=Object.entries(u);if(h.some(([g])=>typeof this[g]<"u")){t=u;for(let g=0;g<h.length;g++){const[y,v]=h[g],x=i(y);if(typeof x>"u")throw new Error("Missing parameter: "+y+".");this[v]=x}break}}if(!t)throw new Error("No valid parameters provided for ob_tran projection.");const{lamp:s,phip:a}=efe(this,t);this.lamp=s,Math.abs(a)>st?(this.cphip=Math.cos(a),this.sphip=Math.sin(a),this.projectionType=jL.OBLIQUE):this.projectionType=jL.TRANSVERSE}function Qde(n){return this.projectionType.forward(this,n)}function Jde(n){return this.projectionType.inverse(this,n)}function efe(n,e){let t,r;if(e===ov.ROTATE){let i=n.oLongC,s=n.oLatC,a=n.oAlpha;if(Math.abs(Math.abs(s)-We)<=st)throw new Error("Invalid value for o_lat_c: "+n.o_lat_c+" should be < 90");r=i+Math.atan2(-1*Math.cos(a),-1*Math.sin(a)*Math.sin(s)),t=Math.asin(Math.cos(s)*Math.sin(a))}else if(e===ov.NEW_POLE)r=n.oLongP,t=n.oLatP;else{let i=n.oLong1,s=n.oLat1,a=n.oLong2,o=n.oLat2,l=Math.abs(s);if(Math.abs(s)>We-st)throw new Error("Invalid value for o_lat_1: "+n.o_lat_1+" should be < 90");if(Math.abs(o)>We-st)throw new Error("Invalid value for o_lat_2: "+n.o_lat_2+" should be < 90");if(Math.abs(s-o)<st)throw new Error("Invalid value for o_lat_1 and o_lat_2: o_lat_1 should be different from o_lat_2");if(l<st)throw new Error("Invalid value for o_lat_1: o_lat_1 should be different from zero");r=Math.atan2(Math.cos(s)*Math.sin(o)*Math.cos(i)-Math.sin(s)*Math.cos(o)*Math.cos(a),Math.sin(s)*Math.cos(o)*Math.sin(a)-Math.cos(s)*Math.sin(o)*Math.sin(i)),t=Math.atan(-1*Math.cos(r-i)/Math.tan(s))}return{lamp:r,phip:t}}function tfe(n,e){let{x:t,y:r}=e;t+=n.long0;const i=Math.cos(t),s=Math.sin(r),a=Math.cos(r);e.x=ht(Math.atan2(a*Math.sin(t),n.sphip*a*i+n.cphip*s)+n.lamp),e.y=Math.asin(n.sphip*s-n.cphip*a*i);const o=n.obliqueProjection.forward(e);return n.isIdentity&&(o.x*=Rs,o.y*=Rs),o}function nfe(n,e){let{x:t,y:r}=e;t+=n.long0;const i=Math.cos(r),s=Math.cos(t);e.x=ht(Math.atan2(i*Math.sin(t),Math.sin(r))+n.lamp),e.y=Math.asin(-1*i*s);const a=n.obliqueProjection.forward(e);return n.isIdentity&&(a.x*=Rs,a.y*=Rs),a}function rfe(n,e){n.isIdentity&&(e.x*=Ir,e.y*=Ir);const t=n.obliqueProjection.inverse(e);let{x:r,y:i}=t;if(r<Number.MAX_VALUE){r-=n.lamp;const s=Math.cos(r),a=Math.sin(i),o=Math.cos(i);e.x=Math.atan2(o*Math.sin(r),n.sphip*o*s-n.cphip*a),e.y=Math.asin(n.sphip*a+n.cphip*o*s)}return e.x=ht(e.x+n.long0),e}function ife(n,e){n.isIdentity&&(e.x*=Ir,e.y*=Ir);const t=n.obliqueProjection.inverse(e);let{x:r,y:i}=t;if(r<Number.MAX_VALUE){const s=Math.cos(i);r-=n.lamp,e.x=Math.atan2(s*Math.sin(r),-1*Math.sin(i)),e.y=Math.asin(s*Math.cos(r))}return e.x=ht(e.x+n.long0),e}var sfe=["General Oblique Transformation","General_Oblique_Transformation","ob_tran"];const afe={init:Zde,forward:Qde,inverse:Jde,names:sfe};function ofe(n){n.Proj.projections.add(K_),n.Proj.projections.add(Y_),n.Proj.projections.add(Xce),n.Proj.projections.add(iue),n.Proj.projections.add(cue),n.Proj.projections.add(gue),n.Proj.projections.add(vue),n.Proj.projections.add(bue),n.Proj.projections.add(kue),n.Proj.projections.add(Oue),n.Proj.projections.add(Yue),n.Proj.projections.add(ehe),n.Proj.projections.add(she),n.Proj.projections.add(hhe),n.Proj.projections.add(phe),n.Proj.projections.add(whe),n.Proj.projections.add(Ihe),n.Proj.projections.add(Phe),n.Proj.projections.add(Fhe),n.Proj.projections.add(Uhe),n.Proj.projections.add(Khe),n.Proj.projections.add(Qhe),n.Proj.projections.add(sde),n.Proj.projections.add(ude),n.Proj.projections.add(mde),n.Proj.projections.add(Sde),n.Proj.projections.add(Rde),n.Proj.projections.add(Nde),n.Proj.projections.add(jde),n.Proj.projections.add(zde),n.Proj.projections.add(qde),n.Proj.projections.add(afe)}const vn=Object.assign(dce,{defaultDatum:"WGS84",Proj:Aa,WGS84:new Aa("WGS84"),Point:P0,toPoint:Y9,defs:Si,nadgrid:Yle,transform:rv,mgrs:fce,version:"__VERSION__"});ofe(vn);class a7{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=Cs,this.supportedMediaTypes=null}getReadOptions(e,t){if(t){let r=t.dataProjection?qn(t.dataProjection):this.readProjection(e);t.extent&&r&&r.getUnits()==="tile-pixels"&&(r=qn(r),r.setWorldExtent(t.extent)),t={dataProjection:r,featureProjection:t.featureProjection}}return this.adaptOptions(t)}adaptOptions(e){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},e)}getType(){return Vt()}readFeature(e,t){return Vt()}readFeatures(e,t){return Vt()}readGeometry(e,t){return Vt()}readProjection(e){return Vt()}writeFeature(e,t){return Vt()}writeFeatures(e,t){return Vt()}writeGeometry(e,t){return Vt()}}function uo(n,e,t){const r=t?qn(t.featureProjection):null,i=t?qn(t.dataProjection):null;let s=n;if(r&&i&&!Ah(r,i)){e&&(s=n.clone());const a=e?r:i,o=e?i:r;a.getUnits()==="tile-pixels"?s.transform(a,o):s.applyTransform(Ym(a,o))}if(e&&t&&t.decimals!==void 0){const a=Math.pow(10,t.decimals),o=function(l){for(let u=0,h=l.length;u<h;++u)l[u]=Math.round(l[u]*a)/a;return l};s===n&&(s=n.clone()),s.applyTransform(o)}return s}const lfe={Point:ds,LineString:Ra,Polygon:Ca,MultiPoint:cd,MultiLineString:Vl,MultiPolygon:Vh};function cfe(n,e,t){return Array.isArray(e[0])?(L5(n,0,e,t)||(n=n.slice(),hT(n,0,e,t)),n):(pI(n,0,e,t)||(n=n.slice(),ux(n,0,e,t)),n)}function o7(n,e){const t=n.geometry;if(!t)return[];if(Array.isArray(t))return t.map(s=>o7({...n,geometry:s})).flat();const r=t.type==="MultiPolygon"?"Polygon":t.type;if(r==="GeometryCollection"||r==="Circle")throw new Error("Unsupported geometry type: "+r);const i=t.layout.length;return uo(new Ks(r,r==="Polygon"?cfe(t.flatCoordinates,t.ends,i):t.flatCoordinates,t.ends?.flat(),i,n.properties||{},n.id).enableSimplifyTransformed(),!1,e)}function DR(n,e){if(!n)return null;if(Array.isArray(n)){const r=n.map(i=>DR(i,e));return new no(r)}const t=lfe[n.type];return uo(new t(n.flatCoordinates,n.layout||"XY",n.ends),!1,e)}class ufe extends a7{constructor(){super()}getType(){return"json"}readFeature(e,t){return this.readFeatureFromObject(f_(e),this.getReadOptions(e,t))}readFeatures(e,t){return this.readFeaturesFromObject(f_(e),this.getReadOptions(e,t))}readFeatureFromObject(e,t){return Vt()}readFeaturesFromObject(e,t){return Vt()}readGeometry(e,t){return this.readGeometryFromObject(f_(e),this.getReadOptions(e,t))}readGeometryFromObject(e,t){return Vt()}readProjection(e){return this.readProjectionFromObject(f_(e))}readProjectionFromObject(e){return Vt()}writeFeature(e,t){return JSON.stringify(this.writeFeatureObject(e,t))}writeFeatureObject(e,t){return Vt()}writeFeatures(e,t){return JSON.stringify(this.writeFeaturesObject(e,t))}writeFeaturesObject(e,t){return Vt()}writeGeometry(e,t){return JSON.stringify(this.writeGeometryObject(e,t))}writeGeometryObject(e,t){return Vt()}}function f_(n){if(typeof n=="string"){const e=JSON.parse(n);return e||null}return n!==null?n:null}class FR extends ufe{constructor(e){e=e||{},super(),this.dataProjection=qn(e.dataProjection?e.dataProjection:"EPSG:4326"),e.featureProjection&&(this.defaultFeatureProjection=qn(e.featureProjection)),e.featureClass&&(this.featureClass=e.featureClass),this.geometryName_=e.geometryName,this.extractGeometryName_=e.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(e,t){let r=null;e.type==="Feature"?r=e:r={type:"Feature",geometry:e,properties:null};const i=jR(r.geometry);if(this.featureClass===Ks)return o7({geometry:i,id:r.id,properties:r.properties},t);const s=new Cs;return this.geometryName_?s.setGeometryName(this.geometryName_):this.extractGeometryName_&&r.geometry_name&&s.setGeometryName(r.geometry_name),s.setGeometry(DR(i,t)),"id"in r&&s.setId(r.id),r.properties&&s.setProperties(r.properties,!0),s}readFeaturesFromObject(e,t){const r=e;let i=null;if(r.type==="FeatureCollection"){const s=e;i=[];const a=s.features;for(let o=0,l=a.length;o<l;++o){const u=this.readFeatureFromObject(a[o],t);u&&i.push(u)}}else i=[this.readFeatureFromObject(e,t)];return i.flat()}readGeometryFromObject(e,t){return hfe(e,t)}readProjectionFromObject(e){const t=e.crs;let r;if(t)if(t.type=="name")r=qn(t.properties.name);else if(t.type==="EPSG")r=qn("EPSG:"+t.properties.code);else throw new Error("Unknown SRS type");else r=this.dataProjection;return r}writeFeatureObject(e,t){t=this.adaptOptions(t);const r={type:"Feature",geometry:null,properties:null},i=e.getId();if(i!==void 0&&(r.id=i),!e.hasProperties())return r;const s=e.getProperties(),a=e.getGeometry();return a&&(r.geometry=Ob(a,t),delete s[e.getGeometryName()]),Lh(s)||(r.properties=s),r}writeFeaturesObject(e,t){t=this.adaptOptions(t);const r=[];for(let i=0,s=e.length;i<s;++i)r.push(this.writeFeatureObject(e[i],t));return{type:"FeatureCollection",features:r}}writeGeometryObject(e,t){return Ob(e,this.adaptOptions(t))}}function jR(n,e){if(!n)return null;let t;switch(n.type){case"Point":{t=ffe(n);break}case"LineString":{t=gfe(n);break}case"Polygon":{t=_fe(n);break}case"MultiPoint":{t=pfe(n);break}case"MultiLineString":{t=mfe(n);break}case"MultiPolygon":{t=yfe(n);break}case"GeometryCollection":{t=dfe(n);break}default:throw new Error("Unsupported GeoJSON type: "+n.type)}return t}function hfe(n,e){const t=jR(n);return DR(t,e)}function dfe(n,e){return n.geometries.map(function(r){return jR(r)})}function ffe(n){const e=n.coordinates;return{type:"Point",flatCoordinates:e,layout:ld(e.length)}}function gfe(n){const e=n.coordinates,t=e.flat();return{type:"LineString",flatCoordinates:t,ends:[t.length],layout:ld(e[0]?.length||2)}}function mfe(n){const e=n.coordinates,t=e[0]?.[0]?.length||2,r=[],i=Kp(r,0,e,t);return{type:"MultiLineString",flatCoordinates:r,ends:i,layout:ld(t)}}function pfe(n){const e=n.coordinates;return{type:"MultiPoint",flatCoordinates:e.flat(),layout:ld(e[0]?.length||2)}}function yfe(n){const e=n.coordinates,t=[],r=e[0]?.[0]?.[0].length||2,i=u5(t,0,e,r);return{type:"MultiPolygon",flatCoordinates:t,ends:i,layout:ld(r)}}function _fe(n){const e=n.coordinates,t=[],r=e[0]?.[0]?.length,i=Kp(t,0,e,r);return{type:"Polygon",flatCoordinates:t,ends:i,layout:ld(r)}}function Ob(n,e){n=uo(n,!0,e);const t=n.getType();let r;switch(t){case"Point":{r=Tfe(n);break}case"LineString":{r=vfe(n);break}case"Polygon":{r=bfe(n,e);break}case"MultiPoint":{r=Efe(n);break}case"MultiLineString":{r=wfe(n);break}case"MultiPolygon":{r=Sfe(n,e);break}case"GeometryCollection":{r=xfe(n,e);break}case"Circle":{r={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+t)}return r}function xfe(n,e){return e=Object.assign({},e),delete e.featureProjection,{type:"GeometryCollection",geometries:n.getGeometriesArray().map(function(r){return Ob(r,e)})}}function vfe(n,e){return{type:"LineString",coordinates:n.getCoordinates()}}function wfe(n,e){return{type:"MultiLineString",coordinates:n.getCoordinates()}}function Efe(n,e){return{type:"MultiPoint",coordinates:n.getCoordinates()}}function Sfe(n,e){let t;return e&&(t=e.rightHanded),{type:"MultiPolygon",coordinates:n.getCoordinates(t)}}function Tfe(n,e){return{type:"Point",coordinates:n.getCoordinates()}}function bfe(n,e){let t;return e&&(t=e.rightHanded),{type:"Polygon",coordinates:n.getCoordinates(t)}}const lv="http://www.w3.org/2001/XMLSchema-instance";function xd(n,e){return K0().createElementNS(n,e)}function ho(n,e){return l7(n,e,[]).join("")}function l7(n,e,t){if(n.nodeType==Node.CDATA_SECTION_NODE||n.nodeType==Node.TEXT_NODE)t.push(n.nodeValue);else{let r;for(r=n.firstChild;r;r=r.nextSibling)l7(r,e,t)}return t}function Al(n){return"documentElement"in n}function Rl(n){return new DOMParser().parseFromString(n,"application/xml")}function VL(n,e){return(function(t,r){const i=n.call(e??this,t,r);if(i!==void 0){const s=r[r.length-1];Nn(s,i)}})}function qa(n,e){return(function(t,r){const i=n.call(e??this,t,r);i!==void 0&&r[r.length-1].push(i)})}function VR(n,e){return(function(t,r){const i=n.call(this,t,r);i!==void 0&&(r[r.length-1]=i)})}function Fe(n,e,t){return(function(r,i){const s=n.call(this,r,i);if(s!==void 0){const a=i[i.length-1],o=e!==void 0?e:r.localName;a[o]=s}})}function Qe(n,e){return(function(t,r,i){n.call(this,t,r,i),i[i.length-1].node.appendChild(t)})}function c7(n,e){let t,r;return function(i,s,a){if(t===void 0){t={};const o={};o[i.localName]=n,t[i.namespaceURI]=o,r=fo(i.localName)}u7(t,r,s,a)}}function fo(n,e){return(function(t,r,i){const a=r[r.length-1].node;let o=n;o===void 0&&(o=i);const l=a.namespaceURI;return xd(l,o)})}const qi=fo();function Ps(n,e){const t=e.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=n[e[i]];return r}function ut(n,e,t){t=t!==void 0?t:{};let r,i;for(r=0,i=n.length;r<i;++r)t[n[r]]=e;return t}function Cu(n,e,t,r){let i;for(i=e.firstElementChild;i;i=i.nextElementSibling){const s=n[i.namespaceURI];if(s!==void 0){const a=s[i.localName];a!==void 0&&a.call(r,i,t)}}}function fn(n,e,t,r,i){return r.push(n),Cu(e,t,r,i),r.pop()}function u7(n,e,t,r,i,s){const a=(i!==void 0?i:t).length;let o,l;for(let u=0;u<a;++u)o=t[u],o!==void 0&&(l=e.call(s,o,r,i!==void 0?i[u]:void 0),l!==void 0&&n[l.namespaceURI][l.localName].call(s,l,o,r))}function er(n,e,t,r,i,s,a){return i.push(n),u7(e,t,r,i,s,a),i.pop()}let OS;function Ife(){return OS===void 0&&typeof XMLSerializer<"u"&&(OS=new XMLSerializer),OS}let DS;function K0(){return DS===void 0&&typeof document<"u"&&(DS=document.implementation.createDocument("","",null)),DS}class h7 extends a7{constructor(){super(),this.xmlSerializer_=Ife()}getType(){return"xml"}readFeature(e,t){if(!e)return null;if(typeof e=="string"){const r=Rl(e);return this.readFeatureFromDocument(r,t)}return Al(e)?this.readFeatureFromDocument(e,t):this.readFeatureFromNode(e,t)}readFeatureFromDocument(e,t){const r=this.readFeaturesFromDocument(e,t);return r.length>0?r[0]:null}readFeatureFromNode(e,t){return null}readFeatures(e,t){if(!e)return[];if(typeof e=="string"){const r=Rl(e);return this.readFeaturesFromDocument(r,t)}return Al(e)?this.readFeaturesFromDocument(e,t):this.readFeaturesFromNode(e,t)}readFeaturesFromDocument(e,t){const r=[];for(let i=e.firstChild;i;i=i.nextSibling)i.nodeType==Node.ELEMENT_NODE&&Nn(r,this.readFeaturesFromNode(i,t));return r}readFeaturesFromNode(e,t){return Vt()}readGeometry(e,t){if(!e)return null;if(typeof e=="string"){const r=Rl(e);return this.readGeometryFromDocument(r,t)}return Al(e)?this.readGeometryFromDocument(e,t):this.readGeometryFromNode(e,t)}readGeometryFromDocument(e,t){return null}readGeometryFromNode(e,t){return null}readProjection(e){if(!e)return null;if(typeof e=="string"){const t=Rl(e);return this.readProjectionFromDocument(t)}return Al(e)?this.readProjectionFromDocument(e):this.readProjectionFromNode(e)}readProjectionFromDocument(e){return this.dataProjection}readProjectionFromNode(e){return this.dataProjection}writeFeature(e,t){const r=this.writeFeatureNode(e,t);return this.xmlSerializer_.serializeToString(r)}writeFeatureNode(e,t){return null}writeFeatures(e,t){const r=this.writeFeaturesNode(e,t);return this.xmlSerializer_.serializeToString(r)}writeFeaturesNode(e,t){return null}writeGeometry(e,t){const r=this.writeGeometryNode(e,t);return this.xmlSerializer_.serializeToString(r)}writeGeometryNode(e,t){return null}}function xu(n){const e=ho(n,!1);return Afe(e)}function Afe(n){const e=/^\s*(true|1)|(false|0)\s*$/.exec(n);if(e)return e[1]!==void 0||!1}function jw(n){const e=ho(n,!1),t=Date.parse(e);return isNaN(t)?void 0:t/1e3}function Tn(n){const e=ho(n,!1);return Rfe(e)}function Rfe(n){const e=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(n);if(e)return parseFloat(e[1])}function Pp(n){const e=ho(n,!1);return Cfe(e)}function Cfe(n){const e=/^\s*(\d+)\s*$/.exec(n);if(e)return parseInt(e[1],10)}function rn(n){return ho(n,!1).trim()}function M0(n,e){Cn(n,e?"1":"0")}function kfe(n,e){n.appendChild(K0().createCDATASection(e))}function Pfe(n,e){const t=new Date(e*1e3),r=t.getUTCFullYear()+"-"+Og(t.getUTCMonth()+1,2)+"-"+Og(t.getUTCDate(),2)+"T"+Og(t.getUTCHours(),2)+":"+Og(t.getUTCMinutes(),2)+":"+Og(t.getUTCSeconds(),2)+"Z";n.appendChild(K0().createTextNode(r))}function vs(n,e){const t=e.toPrecision();n.appendChild(K0().createTextNode(t))}function cv(n,e){const t=e.toString();n.appendChild(K0().createTextNode(t))}const Mfe=/^\s/,Nfe=/\s$/,Lfe=/(\n|\t|\r|<|&| {2})/;function Cn(n,e){typeof e=="string"&&(Mfe.test(e)||Nfe.test(e)||Lfe.test(e))?e.split("]]>").forEach((t,r,i)=>{r<i.length-1&&(t+="]]"),r>0&&(t=">"+t),kfe(n,t)}):n.appendChild(K0().createTextNode(e))}const or=[null,"http://www.topografix.com/GPX/1/0","http://www.topografix.com/GPX/1/1"],Ofe="http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd",Dfe={rte:d7,trk:f7,wpt:g7},Ffe=ut(or,{rte:qa(d7),trk:qa(f7),wpt:qa(g7)}),jfe=ut(or,{text:Fe(rn,"linkText"),type:Fe(rn,"linkType")}),Vfe=ut(or,{name:Fe(rn),email:d0e,link:C1}),Gfe=ut(or,{name:Fe(rn),desc:Fe(rn),author:Fe(c0e),copyright:Fe(u0e),link:C1,time:Fe(jw),keywords:Fe(rn),bounds:h0e,extensions:Vw}),Bfe=ut(or,{year:Fe(Pp),license:Fe(rn)}),Ufe=ut(or,{rte:Qe(p0e),trk:Qe(y0e),wpt:Qe(x0e)});class zfe extends h7{constructor(e){super(),e=e||{},this.dataProjection=qn("EPSG:4326"),this.readExtensions_=e.readExtensions}handleReadExtensions_(e){e||(e=[]);for(let t=0,r=e.length;t<r;++t){const i=e[t];if(this.readExtensions_){const s=i.get("extensionsNode_")||null;this.readExtensions_(i,s)}i.set("extensionsNode_",void 0)}}readMetadata(e){return e?typeof e=="string"?this.readMetadataFromDocument(Rl(e)):Al(e)?this.readMetadataFromDocument(e):this.readMetadataFromNode(e):null}readMetadataFromDocument(e){for(let t=e.firstChild;t;t=t.nextSibling)if(t.nodeType===Node.ELEMENT_NODE){const r=this.readMetadataFromNode(t);if(r)return r}return null}readMetadataFromNode(e){if(!or.includes(e.namespaceURI))return null;for(let t=e.firstElementChild;t;t=t.nextElementSibling)if(or.includes(t.namespaceURI)&&t.localName==="metadata")return fn({},Gfe,t,[]);return null}readFeatureFromNode(e,t){if(!or.includes(e.namespaceURI))return null;const r=Dfe[e.localName];if(!r)return null;const i=r(e,[this.getReadOptions(e,t)]);return i?(this.handleReadExtensions_([i]),i):null}readFeaturesFromNode(e,t){if(!or.includes(e.namespaceURI))return[];if(e.localName=="gpx"){const r=fn([],Ffe,e,[this.getReadOptions(e,t)]);return r?(this.handleReadExtensions_(r),r):[]}return[]}writeFeaturesNode(e,t){t=this.adaptOptions(t);const r=xd("http://www.topografix.com/GPX/1/1","gpx");return r.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xsi",lv),r.setAttributeNS(lv,"xsi:schemaLocation",Ofe),r.setAttribute("version","1.1"),r.setAttribute("creator","OpenLayers"),er({node:r},Ufe,l0e,e,[t]),r}}const $fe=ut(or,{name:Fe(rn),cmt:Fe(rn),desc:Fe(rn),src:Fe(rn),link:C1,number:Fe(Pp),extensions:Vw,type:Fe(rn),rtept:f0e}),Wfe=ut(or,{ele:Fe(Tn),time:Fe(jw)}),Hfe=ut(or,{name:Fe(rn),cmt:Fe(rn),desc:Fe(rn),src:Fe(rn),link:C1,number:Fe(Pp),type:Fe(rn),extensions:Vw,trkseg:m0e}),Kfe=ut(or,{trkpt:g0e}),Yfe=ut(or,{ele:Fe(Tn),time:Fe(jw)}),Xfe=ut(or,{ele:Fe(Tn),time:Fe(jw),magvar:Fe(Tn),geoidheight:Fe(Tn),name:Fe(rn),cmt:Fe(rn),desc:Fe(rn),src:Fe(rn),link:C1,sym:Fe(rn),type:Fe(rn),fix:Fe(rn),sat:Fe(Pp),hdop:Fe(Tn),vdop:Fe(Tn),pdop:Fe(Tn),ageofdgpsdata:Fe(Tn),dgpsid:Fe(Pp),extensions:Vw}),qfe=["text","type"],Zfe=ut(or,{text:Qe(Cn),type:Qe(Cn)}),Qfe=ut(or,["name","cmt","desc","src","link","number","type","rtept"]),Jfe=ut(or,{name:Qe(Cn),cmt:Qe(Cn),desc:Qe(Cn),src:Qe(Cn),link:Qe(UR),number:Qe(cv),type:Qe(Cn),rtept:c7(Qe(zR))}),e0e=ut(or,["ele","time"]),t0e=ut(or,["name","cmt","desc","src","link","number","type","trkseg"]),n0e=ut(or,{name:Qe(Cn),cmt:Qe(Cn),desc:Qe(Cn),src:Qe(Cn),link:Qe(UR),number:Qe(cv),type:Qe(Cn),trkseg:c7(Qe(_0e))}),r0e=fo("trkpt"),i0e=ut(or,{trkpt:Qe(zR)}),s0e=ut(or,["ele","time","magvar","geoidheight","name","cmt","desc","src","link","sym","type","fix","sat","hdop","vdop","pdop","ageofdgpsdata","dgpsid"]),a0e=ut(or,{ele:Qe(vs),time:Qe(Pfe),magvar:Qe(vs),geoidheight:Qe(vs),name:Qe(Cn),cmt:Qe(Cn),desc:Qe(Cn),src:Qe(Cn),link:Qe(UR),sym:Qe(Cn),type:Qe(Cn),fix:Qe(Cn),sat:Qe(cv),hdop:Qe(vs),vdop:Qe(vs),pdop:Qe(vs),ageofdgpsdata:Qe(vs),dgpsid:Qe(cv)}),o0e={Point:"wpt",LineString:"rte",MultiLineString:"trk"};function l0e(n,e,t){const r=n.getGeometry();if(r){const i=o0e[r.getType()];if(i){const s=e[e.length-1].node;return xd(s.namespaceURI,i)}}}function GR(n,e,t,r){return n.push(parseFloat(t.getAttribute("lon")),parseFloat(t.getAttribute("lat"))),"ele"in r?(n.push(r.ele),delete r.ele,e.hasZ=!0):n.push(0),"time"in r?(n.push(r.time),delete r.time,e.hasM=!0):n.push(0),n}function BR(n,e,t){let r="XY",i=2;if(n.hasZ&&n.hasM?(r="XYZM",i=4):n.hasZ?(r="XYZ",i=3):n.hasM&&(r="XYM",i=3),i!==4){for(let s=0,a=e.length/4;s<a;s++)e[s*i]=e[s*4],e[s*i+1]=e[s*4+1],n.hasZ&&(e[s*i+2]=e[s*4+2]),n.hasM&&(e[s*i+2]=e[s*4+3]);if(e.length=e.length/4*i,t)for(let s=0,a=t.length;s<a;s++)t[s]=t[s]/4*i}return r}function c0e(n,e){const t=fn({},Vfe,n,e);if(t)return t}function u0e(n,e){const t=fn({},Bfe,n,e);if(t){const r=n.getAttribute("author");return r!==null&&(t.author=r),t}}function h0e(n,e){const t=e[e.length-1],r=n.getAttribute("minlat"),i=n.getAttribute("minlon"),s=n.getAttribute("maxlat"),a=n.getAttribute("maxlon");i!==null&&r!==null&&a!==null&&s!==null&&(t.bounds=[[parseFloat(i),parseFloat(r)],[parseFloat(a),parseFloat(s)]])}function d0e(n,e){const t=e[e.length-1],r=n.getAttribute("id"),i=n.getAttribute("domain");r!==null&&i!==null&&(t.email=`${r}@${i}`)}function C1(n,e){const t=e[e.length-1],r=n.getAttribute("href");r!==null&&(t.link=r),Cu(jfe,n,e)}function Vw(n,e){const t=e[e.length-1];t.extensionsNode_=n}function f0e(n,e){const t=fn({},Wfe,n,e);if(t){const r=e[e.length-1],i=r.flatCoordinates,s=r.layoutOptions;GR(i,s,n,t)}}function g0e(n,e){const t=fn({},Yfe,n,e);if(t){const r=e[e.length-1],i=r.flatCoordinates,s=r.layoutOptions;GR(i,s,n,t)}}function m0e(n,e){const t=e[e.length-1];Cu(Kfe,n,e);const r=t.flatCoordinates;t.ends.push(r.length)}function d7(n,e){const t=e[0],r=fn({flatCoordinates:[],layoutOptions:{}},$fe,n,e);if(!r)return;const i=r.flatCoordinates;delete r.flatCoordinates;const s=r.layoutOptions;delete r.layoutOptions;const a=BR(s,i),o=new Ra(i,a);uo(o,!1,t);const l=new Cs(o);return l.setProperties(r,!0),l}function f7(n,e){const t=e[0],r=fn({flatCoordinates:[],ends:[],layoutOptions:{}},Hfe,n,e);if(!r)return;const i=r.flatCoordinates;delete r.flatCoordinates;const s=r.ends;delete r.ends;const a=r.layoutOptions;delete r.layoutOptions;const o=BR(a,i,s),l=new Vl(i,o,s);uo(l,!1,t);const u=new Cs(l);return u.setProperties(r,!0),u}function g7(n,e){const t=e[0],r=fn({},Xfe,n,e);if(!r)return;const i={},s=GR([],i,n,r),a=BR(i,s),o=new ds(s,a);uo(o,!1,t);const l=new Cs(o);return l.setProperties(r,!0),l}function UR(n,e,t){n.setAttribute("href",e);const i=t[t.length-1].properties,s=[i.linkText,i.linkType];er({node:n},Zfe,qi,s,t,qfe)}function zR(n,e,t){const r=t[t.length-1],s=r.node.namespaceURI,a=r.properties;switch(n.setAttributeNS(null,"lat",String(e[1])),n.setAttributeNS(null,"lon",String(e[0])),r.geometryLayout){case"XYZM":e[3]!==0&&(a.time=e[3]);case"XYZ":e[2]!==0&&(a.ele=e[2]);break;case"XYM":e[2]!==0&&(a.time=e[2]);break}const l=n.nodeName=="rtept"?e0e[s]:s0e[s],u=Ps(a,l);er({node:n,properties:a},a0e,qi,u,t,l)}function p0e(n,e,t){const r=t[0],i=e.getProperties(),s={node:n};s.properties=i;const a=e.getGeometry();if(a.getType()=="LineString"){const h=uo(a,!0,r);s.geometryLayout=h.getLayout(),i.rtept=h.getCoordinates()}const o=t[t.length-1].node,l=Qfe[o.namespaceURI],u=Ps(i,l);er(s,Jfe,qi,u,t,l)}function y0e(n,e,t){const r=t[0],i=e.getProperties(),s={node:n};s.properties=i;const a=e.getGeometry();if(a.getType()=="MultiLineString"){const h=uo(a,!0,r);i.trkseg=h.getLineStrings()}const o=t[t.length-1].node,l=t0e[o.namespaceURI],u=Ps(i,l);er(s,n0e,qi,u,t,l)}function _0e(n,e,t){const r={node:n};r.geometryLayout=e.getLayout(),r.properties={},er(r,i0e,r0e,e.getCoordinates(),t)}function x0e(n,e,t){const r=t[0],i=t[t.length-1];i.properties=e.getProperties();const s=e.getGeometry();if(s.getType()=="Point"){const a=uo(s,!0,r);i.geometryLayout=a.getLayout(),zR(n,a.getCoordinates(),t)}}const Jl=["http://www.google.com/kml/ext/2.2"],bt=[null,"http://earth.google.com/kml/2.0","http://earth.google.com/kml/2.1","http://earth.google.com/kml/2.2","http://www.opengis.net/kml/2.2"],v0e="http://www.opengis.net/kml/2.2 https://developers.google.com/kml/schema/kml22gx.xsd",GL={fraction:"fraction",pixels:"pixels",insetPixels:"pixels"},w0e=ut(bt,{ExtendedData:C7,Region:k7,MultiGeometry:Fe(I7,"geometry"),LineString:Fe(T7,"geometry"),LinearRing:Fe(b7,"geometry"),Point:Fe(A7,"geometry"),Polygon:Fe(R7,"geometry"),Style:Fe(HR),StyleMap:ige,address:Fe(rn),description:Fe(rn),name:Fe(rn),open:Fe(xu),phoneNumber:Fe(rn),styleUrl:Fe(x7),visibility:Fe(xu)},ut(Jl,{MultiTrack:Fe(W0e,"geometry"),Track:Fe(S7,"geometry")})),E0e=ut(bt,{ExtendedData:C7,Region:k7,Link:pge,address:Fe(rn),description:Fe(rn),name:Fe(rn),open:Fe(xu),phoneNumber:Fe(rn),visibility:Fe(xu)}),S0e=ut(bt,{href:Fe(_7)}),T0e=ut(bt,{Altitude:Fe(Tn),Longitude:Fe(Tn),Latitude:Fe(Tn),Tilt:Fe(Tn),AltitudeMode:Fe(rn),Heading:Fe(Tn),Roll:Fe(Tn)}),m7=ut(bt,{LatLonAltBox:cge,Lod:hge}),b0e=ut(bt,["Document","Placemark"]),I0e=ut(bt,{Document:Qe(Tge),Placemark:Qe(N7)});let t0,q_=null,Db,Om,Dm,Fm,uv,Fb=null,$R,jb=null,Vb,Th=null,BL=null,Gb=null;function hv(n){return 32/Math.min(n[0],n[1])}function A0e(){t0=[255,255,255,1],q_=new kr({color:t0}),Db=[20,2],Om="pixels",Dm="pixels",Fm=[64,64],uv="https://maps.google.com/mapfiles/kml/pushpin/ylw-pushpin.png",Fb=new qp({anchor:Db,anchorOrigin:"bottom-left",anchorXUnits:Om,anchorYUnits:Dm,crossOrigin:"anonymous",rotation:0,scale:hv(Fm),size:Fm,src:uv}),$R="NO_IMAGE",jb=new Hr({color:t0,width:1}),Vb=new Hr({color:[51,51,51,1],width:2}),Th=new ud({font:"bold 16px Helvetica",fill:q_,stroke:Vb,scale:.8}),BL=new $n({fill:q_,image:Fb,text:Th,stroke:jb,zIndex:0}),Gb=[BL]}let g_;function R0e(n){return n}class C0e extends h7{constructor(e){super(),e=e||{},Gb||A0e(),this.dataProjection=qn("EPSG:4326"),this.defaultStyle_=e.defaultStyle?e.defaultStyle:Gb,this.extractStyles_=e.extractStyles!==void 0?e.extractStyles:!0,this.writeStyles_=e.writeStyles!==void 0?e.writeStyles:!0,this.sharedStyles_={},this.showPointNames_=e.showPointNames!==void 0?e.showPointNames:!0,this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",this.iconUrlFunction_=e.iconUrlFunction?e.iconUrlFunction:R0e,this.supportedMediaTypes=["application/vnd.google-earth.kml+xml"]}readDocumentOrFolder_(e,t){const r=ut(bt,{Document:VL(this.readDocumentOrFolder_,this),Folder:VL(this.readDocumentOrFolder_,this),Placemark:qa(this.readPlacemark_,this),Style:this.readSharedStyle_.bind(this),StyleMap:this.readSharedStyleMap_.bind(this)}),i=fn([],r,e,t,this);if(i)return i}readPlacemark_(e,t){const r=fn({geometry:null},w0e,e,t,this);if(!r)return;const i=new Cs,s=e.getAttribute("id");s!==null&&i.setId(s);const a=t[0],o=r.geometry;if(o&&uo(o,!1,a),i.setGeometry(o),delete r.geometry,this.extractStyles_){const l=r.Style,u=r.styleUrl,h=P0e(l,u,this.defaultStyle_,this.sharedStyles_,this.showPointNames_);i.setStyle(h)}return delete r.Style,i.setProperties(r,!0),i}readSharedStyle_(e,t){const r=e.getAttribute("id");if(r!==null){const i=HR.call(this,e,t);if(i){let s,a=e.baseURI;(!a||a=="about:blank")&&(a=window.location.href),a?s=new URL("#"+r,a).href:s="#"+r,this.sharedStyles_[s]=i}}}readSharedStyleMap_(e,t){const r=e.getAttribute("id");if(r===null)return;const i=w7.call(this,e,t);if(!i)return;let s,a=e.baseURI;(!a||a=="about:blank")&&(a=window.location.href),a?s=new URL("#"+r,a).href:s="#"+r,this.sharedStyles_[s]=i}readFeatureFromNode(e,t){if(!bt.includes(e.namespaceURI))return null;const r=this.readPlacemark_(e,[this.getReadOptions(e,t)]);return r||null}readFeaturesFromNode(e,t){if(!bt.includes(e.namespaceURI))return[];let r;const i=e.localName;if(i=="Document"||i=="Folder")return r=this.readDocumentOrFolder_(e,[this.getReadOptions(e,t)]),r||[];if(i=="Placemark"){const s=this.readPlacemark_(e,[this.getReadOptions(e,t)]);return s?[s]:[]}if(i=="kml"){r=[];for(let s=e.firstElementChild;s;s=s.nextElementSibling){const a=this.readFeaturesFromNode(s,t);a&&Nn(r,a)}return r}return[]}readName(e){if(e){if(typeof e=="string"){const t=Rl(e);return this.readNameFromDocument(t)}return Al(e)?this.readNameFromDocument(e):this.readNameFromNode(e)}}readNameFromDocument(e){for(let t=e.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE){const r=this.readNameFromNode(t);if(r)return r}}readNameFromNode(e){for(let t=e.firstElementChild;t;t=t.nextElementSibling)if(bt.includes(t.namespaceURI)&&t.localName=="name")return rn(t);for(let t=e.firstElementChild;t;t=t.nextElementSibling){const r=t.localName;if(bt.includes(t.namespaceURI)&&(r=="Document"||r=="Folder"||r=="Placemark"||r=="kml")){const i=this.readNameFromNode(t);if(i)return i}}}readNetworkLinks(e){const t=[];if(typeof e=="string"){const r=Rl(e);Nn(t,this.readNetworkLinksFromDocument(r))}else Al(e)?Nn(t,this.readNetworkLinksFromDocument(e)):Nn(t,this.readNetworkLinksFromNode(e));return t}readNetworkLinksFromDocument(e){const t=[];for(let r=e.firstChild;r;r=r.nextSibling)r.nodeType==Node.ELEMENT_NODE&&Nn(t,this.readNetworkLinksFromNode(r));return t}readNetworkLinksFromNode(e){const t=[];for(let r=e.firstElementChild;r;r=r.nextElementSibling)if(bt.includes(r.namespaceURI)&&r.localName=="NetworkLink"){const i=fn({},E0e,r,[]);t.push(i)}for(let r=e.firstElementChild;r;r=r.nextElementSibling){const i=r.localName;bt.includes(r.namespaceURI)&&(i=="Document"||i=="Folder"||i=="kml")&&Nn(t,this.readNetworkLinksFromNode(r))}return t}readRegion(e){const t=[];if(typeof e=="string"){const r=Rl(e);Nn(t,this.readRegionFromDocument(r))}else Al(e)?Nn(t,this.readRegionFromDocument(e)):Nn(t,this.readRegionFromNode(e));return t}readRegionFromDocument(e){const t=[];for(let r=e.firstChild;r;r=r.nextSibling)r.nodeType==Node.ELEMENT_NODE&&Nn(t,this.readRegionFromNode(r));return t}readRegionFromNode(e){const t=[];for(let r=e.firstElementChild;r;r=r.nextElementSibling)if(bt.includes(r.namespaceURI)&&r.localName=="Region"){const i=fn({},m7,r,[]);t.push(i)}for(let r=e.firstElementChild;r;r=r.nextElementSibling){const i=r.localName;bt.includes(r.namespaceURI)&&(i=="Document"||i=="Folder"||i=="kml")&&Nn(t,this.readRegionFromNode(r))}return t}readCamera(e){const t=[];if(typeof e=="string"){const r=Rl(e);Nn(t,this.readCameraFromDocument(r))}else Al(e)?Nn(t,this.readCameraFromDocument(e)):Nn(t,this.readCameraFromNode(e));return t}readCameraFromDocument(e){const t=[];for(let r=e.firstChild;r;r=r.nextSibling)r.nodeType===Node.ELEMENT_NODE&&Nn(t,this.readCameraFromNode(r));return t}readCameraFromNode(e){const t=[];for(let r=e.firstElementChild;r;r=r.nextElementSibling)if(bt.includes(r.namespaceURI)&&r.localName==="Camera"){const i=fn({},T0e,r,[]);t.push(i)}for(let r=e.firstElementChild;r;r=r.nextElementSibling){const i=r.localName;bt.includes(r.namespaceURI)&&(i==="Document"||i==="Folder"||i==="Placemark"||i==="kml")&&Nn(t,this.readCameraFromNode(r))}return t}writeFeaturesNode(e,t){t=this.adaptOptions(t);const r=xd(bt[4],"kml"),i="http://www.w3.org/2000/xmlns/";r.setAttributeNS(i,"xmlns:gx",Jl[0]),r.setAttributeNS(i,"xmlns:xsi",lv),r.setAttributeNS(lv,"xsi:schemaLocation",v0e);const s={node:r},a={};e.length>1?a.Document=e:e.length==1&&(a.Placemark=e[0]);const o=b0e[r.namespaceURI],l=Ps(a,o);return er(s,I0e,qi,l,[t],o,this),r}}function k0e(n,e){const t=[0,0];let r="start";const i=n.getImage();if(i){const o=i.getSize();if(o&&o.length==2){const l=i.getScaleArray(),u=i.getAnchor();t[0]=l[0]*(o[0]-u[0]),t[1]=l[1]*(o[1]/2-u[1]),r="left"}}let s=n.getText();return s?(s=s.clone(),s.setFont(s.getFont()||Th.getFont()),s.setScale(s.getScale()||Th.getScale()),s.setFill(s.getFill()||Th.getFill()),s.setStroke(s.getStroke()||Vb)):s=Th.clone(),s.setText(e),s.setOffsetX(t[0]),s.setOffsetY(t[1]),s.setTextAlign(r),new $n({image:i,text:s})}function P0e(n,e,t,r,i){return(function(s,a){let o=i,l="",u=[];if(o){const f=s.getGeometry();if(f)if(f instanceof no)u=f.getGeometriesArrayRecursive().filter(function(g){const y=g.getType();return y==="Point"||y==="MultiPoint"}),o=u.length>0;else{const g=f.getType();o=g==="Point"||g==="MultiPoint"}}o&&(l=s.get("name"),o=o&&!!l,o&&/&[^&]+;/.test(l)&&(g_||(g_=document.createElement("textarea")),g_.innerHTML=l,l=g_.value));let h=t;if(n?h=n:e&&(h=p7(e,t,r)),o){const f=k0e(h[0],l);if(u.length>0){f.setGeometry(new no(u));const g=new $n({geometry:h[0].getGeometry(),image:null,fill:h[0].getFill(),stroke:h[0].getStroke(),text:null});return[f,g].concat(h.slice(1))}return f}return h})}function p7(n,e,t){return Array.isArray(n)?n:typeof n=="string"?p7(t[n],e,t):e}function Gw(n){const e=ho(n,!1),t=/^\s*#?\s*([0-9A-Fa-f]{8})\s*$/.exec(e);if(t){const r=t[1];return[parseInt(r.substr(6,2),16),parseInt(r.substr(4,2),16),parseInt(r.substr(2,2),16),parseInt(r.substr(0,2),16)/255]}}function y7(n){let e=ho(n,!1);const t=[];e=e.replace(/\s*,\s*/g,",");const r=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?),([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s+|,|$)(?:([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s+|$))?\s*/i;let i;for(;i=r.exec(e);){const s=parseFloat(i[1]),a=parseFloat(i[2]),o=i[3]?parseFloat(i[3]):0;t.push(s,a,o),e=e.substr(i[0].length)}if(e==="")return t}function _7(n){const e=ho(n,!1).trim();let t=n.baseURI;return(!t||t=="about:blank")&&(t=window.location.href),t?new URL(e,t).href:e}function x7(n){const e=ho(n,!1).trim().replace(/^(?!.*#)/,"#");let t=n.baseURI;return(!t||t=="about:blank")&&(t=window.location.href),t?new URL(e,t).href:e}function M0e(n){const e=n.getAttribute("xunits"),t=n.getAttribute("yunits");let r;return e!=="insetPixels"?t!=="insetPixels"?r="bottom-left":r="top-left":t!=="insetPixels"?r="bottom-right":r="top-right",{x:parseFloat(n.getAttribute("x")),xunits:GL[e],y:parseFloat(n.getAttribute("y")),yunits:GL[t],origin:r}}function v7(n){return Tn(n)}const N0e=ut(bt,{Pair:rge});function w7(n,e){return fn(void 0,N0e,n,e,this)}const L0e=ut(bt,{Icon:Fe(Y0e),color:Fe(Gw),heading:Fe(Tn),hotSpot:Fe(M0e),scale:Fe(v7)});function O0e(n,e){const t=fn({},L0e,n,e);if(!t)return;const r=e[e.length-1],i="Icon"in t?t.Icon:{},s=!("Icon"in t)||Object.keys(i).length>0;let a;const o=i.href;o?a=o:s&&(a=uv);let l,u,h,f="bottom-left";const g=t.hotSpot;g?(l=[g.x,g.y],u=g.xunits,h=g.yunits,f=g.origin):/^https?:\/\/maps\.(?:google|gstatic)\.com\//.test(a)&&(a.includes("pushpin")?(l=Db,u=Om,h=Dm):a.includes("arrow-reverse")?(l=[54,42],u=Om,h=Dm):a.includes("paddle")&&(l=[32,1],u=Om,h=Dm));let y;const v=i.x,x=i.y;v!==void 0&&x!==void 0&&(y=[v,x]);let E;const T=i.w,b=i.h;T!==void 0&&b!==void 0&&(E=[T,b]);let I;const M=t.heading;M!==void 0&&(I=Pl(M));const F=t.scale,z=t.color;if(s){a==uv&&(E=Fm);const P=new qp({anchor:l,anchorOrigin:f,anchorXUnits:u,anchorYUnits:h,crossOrigin:this.crossOrigin_,offset:y,offsetOrigin:"bottom-left",rotation:I,scale:F,size:E,src:this.iconUrlFunction_(a),color:z}),C=P.getScaleArray()[0],k=P.getSize();if(k===null){const L=P.getImageState();if(L===vt.IDLE||L===vt.LOADING){const O=function(){const U=P.getImageState();if(!(U===vt.IDLE||U===vt.LOADING)){const j=P.getSize();if(j&&j.length==2){const Te=hv(j);P.setScale(C*Te)}P.unlistenImageChange(O)}};P.listenImageChange(O),L===vt.IDLE&&P.load()}}else if(k.length==2){const L=hv(k);P.setScale(C*L)}r.imageStyle=P}else r.imageStyle=$R}const D0e=ut(bt,{color:Fe(Gw),scale:Fe(v7)});function F0e(n,e){const t=fn({},D0e,n,e);if(!t)return;const r=e[e.length-1],i=new ud({fill:new kr({color:"color"in t?t.color:t0}),scale:t.scale});r.textStyle=i}const j0e=ut(bt,{color:Fe(Gw),width:Fe(Tn)});function V0e(n,e){const t=fn({},j0e,n,e);if(!t)return;const r=e[e.length-1],i=new Hr({color:"color"in t?t.color:t0,width:"width"in t?t.width:1});r.strokeStyle=i}const G0e=ut(bt,{color:Fe(Gw),fill:Fe(xu),outline:Fe(xu)});function B0e(n,e){const t=fn({},G0e,n,e);if(!t)return;const r=e[e.length-1],i=new kr({color:"color"in t?t.color:t0});r.fillStyle=i;const s=t.fill;s!==void 0&&(r.fill=s);const a=t.outline;a!==void 0&&(r.outline=a)}const U0e=ut(bt,{coordinates:VR(y7)});function E7(n,e){return fn(null,U0e,n,e)}function z0e(n,e){const r=e[e.length-1].coordinates,i=ho(n,!1),a=/^\s*([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s*$/i.exec(i);if(a){const o=parseFloat(a[1]),l=parseFloat(a[2]),u=parseFloat(a[3]);r.push([o,l,u])}else r.push([])}const $0e=ut(Jl,{Track:qa(S7)});function W0e(n,e){const t=fn([],$0e,n,e);if(t)return new Vl(t)}const H0e=ut(bt,{when:yge},ut(Jl,{coord:z0e}));function S7(n,e){const t=fn({coordinates:[],whens:[]},H0e,n,e);if(!t)return;const r=[],i=t.coordinates,s=t.whens;for(let a=0,o=Math.min(i.length,s.length);a<o;++a)i[a].length==3&&r.push(i[a][0],i[a][1],i[a][2],s[a]);return new Ra(r,"XYZM")}const K0e=ut(bt,{href:Fe(_7)},ut(Jl,{x:Fe(Tn),y:Fe(Tn),w:Fe(Tn),h:Fe(Tn)}));function Y0e(n,e){const t=fn({},K0e,n,e);return t||null}const X0e=ut(bt,{coordinates:VR(y7)});function WR(n,e){return fn(null,X0e,n,e)}const Bw=ut(bt,{extrude:Fe(xu),tessellate:Fe(xu),altitudeMode:Fe(rn)});function T7(n,e){const t=fn({},Bw,n,e),r=WR(n,e);if(r){const i=new Ra(r,"XYZ");return i.setProperties(t,!0),i}}function b7(n,e){const t=fn({},Bw,n,e),r=WR(n,e);if(r){const i=new Ca(r,"XYZ",[r.length]);return i.setProperties(t,!0),i}}const q0e=ut(bt,{LineString:qa(T7),LinearRing:qa(b7),MultiGeometry:qa(I7),Point:qa(A7),Polygon:qa(R7)});function I7(n,e){const t=fn([],q0e,n,e);if(!t)return null;if(t.length===0)return new no(t);let r,i=!0;const s=t[0].getType();let a;for(let o=1,l=t.length;o<l;++o)if(a=t[o],a.getType()!=s){i=!1;break}if(i){let o,l;if(s=="Point"){const u=t[0];o=u.getLayout(),l=u.getFlatCoordinates();for(let h=1,f=t.length;h<f;++h)a=t[h],Nn(l,a.getFlatCoordinates());r=new cd(l,o),FS(r,t)}else if(s=="LineString")r=new Vl(t),FS(r,t);else if(s=="Polygon")r=new Vh(t),FS(r,t);else if(s=="GeometryCollection"||s.startsWith("Multi"))r=new no(t);else throw new Error("Unknown geometry type found")}else r=new no(t);return r}function A7(n,e){const t=fn({},Bw,n,e),r=WR(n,e);if(r){const i=new ds(r,"XYZ");return i.setProperties(t,!0),i}}const Z0e=ut(bt,{innerBoundaryIs:fge,outerBoundaryIs:mge});function R7(n,e){const t=fn({},Bw,n,e),r=fn([null],Z0e,n,e);if(r&&r[0]){const i=r[0],s=[i.length];for(let o=1,l=r.length;o<l;++o)Nn(i,r[o]),s.push(i.length);const a=new Ca(i,"XYZ",s);return a.setProperties(t,!0),a}}const Q0e=ut(bt,{IconStyle:O0e,LabelStyle:F0e,LineStyle:V0e,PolyStyle:B0e});function HR(n,e){const t=fn({},Q0e,n,e,this);if(!t)return null;let r="fillStyle"in t?t.fillStyle:q_;const i=t.fill;i!==void 0&&!i&&(r=null);let s;"imageStyle"in t?t.imageStyle!=$R&&(s=t.imageStyle):s=Fb;const a="textStyle"in t?t.textStyle:Th,o="strokeStyle"in t?t.strokeStyle:jb,l=t.outline;return l!==void 0&&!l?[new $n({geometry:function(u){const h=u.getGeometry(),f=h.getType();if(f==="GeometryCollection"){const g=h;return new no(g.getGeometriesArrayRecursive().filter(function(y){const v=y.getType();return v!=="Polygon"&&v!=="MultiPolygon"}))}if(f!=="Polygon"&&f!=="MultiPolygon")return h},fill:r,image:s,stroke:o,text:a,zIndex:void 0}),new $n({geometry:function(u){const h=u.getGeometry(),f=h.getType();if(f==="GeometryCollection"){const g=h;return new no(g.getGeometriesArrayRecursive().filter(function(y){const v=y.getType();return v==="Polygon"||v==="MultiPolygon"}))}if(f==="Polygon"||f==="MultiPolygon")return h},fill:r,stroke:null,zIndex:void 0})]:[new $n({fill:r,image:s,stroke:o,text:a,zIndex:void 0})]}function FS(n,e){const t=e.length,r=new Array(e.length),i=new Array(e.length),s=new Array(e.length);let a,o,l;a=!1,o=!1,l=!1;for(let u=0;u<t;++u){const h=e[u];r[u]=h.get("extrude"),i[u]=h.get("tessellate"),s[u]=h.get("altitudeMode"),a=a||r[u]!==void 0,o=o||i[u]!==void 0,l=l||s[u]}a&&n.set("extrude",r),o&&n.set("tessellate",i),l&&n.set("altitudeMode",s)}const J0e=ut(bt,{displayName:Fe(rn),value:Fe(rn)});function ege(n,e){const t=n.getAttribute("name");Cu(J0e,n,e);const r=e[e.length-1];t&&r.displayName?r[t]={value:r.value,displayName:r.displayName,toString:function(){return r.value}}:t!==null?r[t]=r.value:r.displayName!==null&&(r[r.displayName]=r.value),delete r.value}const tge=ut(bt,{Data:ege,SchemaData:age});function C7(n,e){Cu(tge,n,e)}function k7(n,e){Cu(m7,n,e)}const nge=ut(bt,{Style:Fe(HR),key:Fe(rn),styleUrl:Fe(x7)});function rge(n,e){const t=fn({},nge,n,e,this);if(!t)return;const r=t.key;if(r&&r=="normal"){const i=t.styleUrl;i&&(e[e.length-1]=i);const s=t.Style;s&&(e[e.length-1]=s)}}function ige(n,e){const t=w7.call(this,n,e);if(!t)return;const r=e[e.length-1];if(Array.isArray(t))r.Style=t;else if(typeof t=="string")r.styleUrl=t;else throw new Error("`styleMapValue` has an unknown type")}const sge=ut(bt,{SimpleData:oge});function age(n,e){Cu(sge,n,e)}function oge(n,e){const t=n.getAttribute("name");if(t!==null){const r=rn(n),i=e[e.length-1];i[t]=r}}const lge=ut(bt,{altitudeMode:Fe(rn),minAltitude:Fe(Tn),maxAltitude:Fe(Tn),north:Fe(Tn),south:Fe(Tn),east:Fe(Tn),west:Fe(Tn)});function cge(n,e){const t=fn({},lge,n,e);if(!t)return;const r=e[e.length-1],i=[parseFloat(t.west),parseFloat(t.south),parseFloat(t.east),parseFloat(t.north)];r.extent=i,r.altitudeMode=t.altitudeMode,r.minAltitude=parseFloat(t.minAltitude),r.maxAltitude=parseFloat(t.maxAltitude)}const uge=ut(bt,{minLodPixels:Fe(Tn),maxLodPixels:Fe(Tn),minFadeExtent:Fe(Tn),maxFadeExtent:Fe(Tn)});function hge(n,e){const t=fn({},uge,n,e);if(!t)return;const r=e[e.length-1];r.minLodPixels=parseFloat(t.minLodPixels),r.maxLodPixels=parseFloat(t.maxLodPixels),r.minFadeExtent=parseFloat(t.minFadeExtent),r.maxFadeExtent=parseFloat(t.maxFadeExtent)}const dge=ut(bt,{LinearRing:qa(E7)});function fge(n,e){const t=fn([],dge,n,e);t.length>0&&e[e.length-1].push(...t)}const gge=ut(bt,{LinearRing:VR(E7)});function mge(n,e){const t=fn(void 0,gge,n,e);if(t){const r=e[e.length-1];r[0]=t}}function pge(n,e){Cu(S0e,n,e)}function yge(n,e){const r=e[e.length-1].whens,i=ho(n,!1),s=Date.parse(i);r.push(isNaN(s)?0:s)}function Uw(n,e){const t=jh(e),i=[(t.length==4?t[3]:1)*255,t[2],t[1],t[0]];for(let s=0;s<4;++s){const a=Math.floor(i[s]).toString(16);i[s]=a.length==1?"0"+a:a}Cn(n,i.join(""))}function _ge(n,e,t){const r=t[t.length-1],i=r.layout,s=r.stride;let a;if(i=="XY"||i=="XYM")a=2;else if(i=="XYZ"||i=="XYZM")a=3;else throw new Error("Invalid geometry layout");const o=e.length;let l="";if(o>0){l+=e[0];for(let u=1;u<a;++u)l+=","+e[u];for(let u=s;u<o;u+=s){l+=" "+e[u];for(let h=1;h<a;++h)l+=","+e[u+h]}}Cn(n,l)}const Z_=ut(bt,{Data:Qe(xge),value:Qe(wge),displayName:Qe(vge)});function xge(n,e,t){n.setAttribute("name",e.name);const r={node:n},i=e.value;typeof i=="object"?(i!==null&&i.displayName&&er(r,Z_,qi,[i.displayName],t,["displayName"]),i!==null&&i.value&&er(r,Z_,qi,[i.value],t,["value"])):er(r,Z_,qi,[i],t,["value"])}function vge(n,e){Cn(n,e)}function wge(n,e){Cn(n,e)}const Ege=ut(bt,{Placemark:Qe(N7)}),Sge=function(n,e,t){const r=e[e.length-1].node;return xd(r.namespaceURI,"Placemark")};function Tge(n,e,t){er({node:n},Ege,Sge,e,t,void 0,this)}const bge=fo("Data");function Ige(n,e,t){const r={node:n},i=e.names,s=e.values,a=i.length;for(let o=0;o<a;o++)er(r,Z_,bge,[{name:i[o],value:s[o]}],t)}const UL=ut(bt,["href"],ut(Jl,["x","y","w","h"])),zL=ut(bt,{href:Qe(Cn)},ut(Jl,{x:Qe(vs),y:Qe(vs),w:Qe(vs),h:Qe(vs)})),Age=function(n,e,t){return xd(Jl[0],"gx:"+t)};function Rge(n,e,t){const r={node:n},i=t[t.length-1].node;let s=UL[i.namespaceURI],a=Ps(e,s);er(r,zL,qi,a,t,s),s=UL[Jl[0]],a=Ps(e,s),er(r,zL,Age,a,t,s)}const Cge=ut(bt,["scale","heading","Icon","color","hotSpot"]),kge=ut(bt,{Icon:Qe(Rge),color:Qe(Uw),heading:Qe(vs),hotSpot:Qe(rme),scale:Qe(O7)});function Pge(n,e,t){const r={node:n},i={},s=e.getSrc(),a=e.getSize(),o=e.getImageSize(),l={href:s};if(a){l.w=a[0],l.h=a[1];const E=e.getAnchor(),T=e.getOrigin();if(T&&o&&T[0]!==0&&T[1]!==a[1]&&(l.x=T[0],l.y=o[1]-(T[1]+a[1])),E&&(E[0]!==a[0]/2||E[1]!==a[1]/2)){const b={x:E[0],xunits:"pixels",y:a[1]-E[1],yunits:"pixels"};i.hotSpot=b}}i.Icon=l;let u=e.getScaleArray()[0],h=a;if(h===null&&(h=Fm),h.length==2){const E=hv(h);u=u/E}u!==1&&(i.scale=u);const f=e.getRotation();f!==0&&(i.heading=f);const g=e.getColor();g&&(i.color=g);const y=t[t.length-1].node,v=Cge[y.namespaceURI],x=Ps(i,v);er(r,kge,qi,x,t,v)}const Mge=ut(bt,["color","scale"]),Nge=ut(bt,{color:Qe(Uw),scale:Qe(O7)});function Lge(n,e,t){const r={node:n},i={},s=e.getFill();s&&(i.color=s.getColor());const a=e.getScale();a&&a!==1&&(i.scale=a);const o=t[t.length-1].node,l=Mge[o.namespaceURI],u=Ps(i,l);er(r,Nge,qi,u,t,l)}const Oge=ut(bt,["color","width"]),Dge=ut(bt,{color:Qe(Uw),width:Qe(vs)});function Fge(n,e,t){const r={node:n},i={color:e.getColor(),width:Number(e.getWidth())||1},s=t[t.length-1].node,a=Oge[s.namespaceURI],o=Ps(i,a);er(r,Dge,qi,o,t,a)}const jge={Point:"Point",LineString:"LineString",LinearRing:"LinearRing",Polygon:"Polygon",MultiPoint:"MultiGeometry",MultiLineString:"MultiGeometry",MultiPolygon:"MultiGeometry",GeometryCollection:"MultiGeometry"},P7=function(n,e,t){if(n){const r=e[e.length-1].node;return xd(r.namespaceURI,jge[n.getType()])}},Vge=fo("Point"),Gge=fo("LineString"),Bge=fo("LinearRing"),Uge=fo("Polygon"),zge=ut(bt,{LineString:Qe(n0),Point:Qe(n0),Polygon:Qe(L7),GeometryCollection:Qe(M7)});function M7(n,e,t){const r={node:n},i=e.getType();let s=[],a;if(i==="GeometryCollection")e.getGeometriesArrayRecursive().forEach(function(o){const l=o.getType();if(l==="MultiPoint")s=s.concat(o.getPoints());else if(l==="MultiLineString")s=s.concat(o.getLineStrings());else if(l==="MultiPolygon")s=s.concat(o.getPolygons());else if(l==="Point"||l==="LineString"||l==="Polygon")s.push(o);else throw new Error("Unknown geometry type")}),a=P7;else if(i==="MultiPoint")s=e.getPoints(),a=Vge;else if(i==="MultiLineString")s=e.getLineStrings(),a=Gge;else if(i==="MultiPolygon")s=e.getPolygons(),a=Uge;else throw new Error("Unknown geometry type");er(r,zge,a,s,t)}const $ge=ut(bt,{LinearRing:Qe(n0)});function $L(n,e,t){er({node:n},$ge,Bge,[e],t)}const jS=ut(bt,{ExtendedData:Qe(Ige),MultiGeometry:Qe(M7),LineString:Qe(n0),LinearRing:Qe(n0),Point:Qe(n0),Polygon:Qe(L7),Style:Qe(nme),address:Qe(Cn),description:Qe(Cn),name:Qe(Cn),open:Qe(M0),phoneNumber:Qe(Cn),styleUrl:Qe(Cn),visibility:Qe(M0)}),Wge=ut(bt,["name","open","visibility","address","phoneNumber","description","styleUrl","Style"]),Hge=fo("ExtendedData");function N7(n,e,t){const r={node:n};e.getId()&&n.setAttribute("id",e.getId());const i=e.getProperties(),s={address:1,description:1,name:1,open:1,phoneNumber:1,styleUrl:1,visibility:1};s[e.getGeometryName()]=1;const a=Object.keys(i||{}).sort().filter(function(y){return!s[y]}),o=e.getStyleFunction();if(o){const y=o(e,0);if(y){const v=Array.isArray(y)?y:[y];let x=v;if(e.getGeometry()&&(x=v.filter(function(E){const T=E.getGeometryFunction()(e);if(T){const b=T.getType();return b==="GeometryCollection"?T.getGeometriesArrayRecursive().filter(function(I){const M=I.getType();return M==="Point"||M==="MultiPoint"}).length:b==="Point"||b==="MultiPoint"}})),this.writeStyles_){let E=v,T=v;e.getGeometry()&&(E=v.filter(function(b){const I=b.getGeometryFunction()(e);if(I){const M=I.getType();return M==="GeometryCollection"?I.getGeometriesArrayRecursive().filter(function(F){const z=F.getType();return z==="LineString"||z==="MultiLineString"}).length:M==="LineString"||M==="MultiLineString"}}),T=v.filter(function(b){const I=b.getGeometryFunction()(e);if(I){const M=I.getType();return M==="GeometryCollection"?I.getGeometriesArrayRecursive().filter(function(F){const z=F.getType();return z==="Polygon"||z==="MultiPolygon"}).length:M==="Polygon"||M==="MultiPolygon"}})),i.Style={pointStyles:x,lineStyles:E,polyStyles:T}}if(x.length&&i.name===void 0){const E=x[0].getText();E&&(i.name=E.getText())}}}const l=t[t.length-1].node,u=Wge[l.namespaceURI],h=Ps(i,u);if(er(r,jS,qi,h,t,u),a.length>0){const y=Ps(i,a);er(r,jS,Hge,[{names:a,values:y}],t)}const f=t[0];let g=e.getGeometry();g&&(g=uo(g,!0,f)),er(r,jS,P7,[g],t)}const Kge=ut(bt,["extrude","tessellate","altitudeMode","coordinates"]),Yge=ut(bt,{extrude:Qe(M0),tessellate:Qe(M0),altitudeMode:Qe(Cn),coordinates:Qe(_ge)});function n0(n,e,t){const r=e.getFlatCoordinates(),i={node:n};i.layout=e.getLayout(),i.stride=e.getStride();const s=e.getProperties();s.coordinates=r;const a=t[t.length-1].node,o=Kge[a.namespaceURI],l=Ps(s,o);er(i,Yge,qi,l,t,o)}const Xge=ut(bt,["color","fill","outline"]),WL=ut(bt,{outerBoundaryIs:Qe($L),innerBoundaryIs:Qe($L)}),qge=fo("innerBoundaryIs"),Zge=fo("outerBoundaryIs");function L7(n,e,t){const r=e.getLinearRings(),i=r.shift(),s={node:n};er(s,WL,qge,r,t),er(s,WL,Zge,[i],t)}const Qge=ut(bt,{color:Qe(Uw),fill:Qe(M0),outline:Qe(M0)});function Jge(n,e,t){const r={node:n},i=e.getFill(),s=e.getStroke(),a={color:i?i.getColor():void 0,fill:i?void 0:!1,outline:s?void 0:!1},o=t[t.length-1].node,l=Xge[o.namespaceURI],u=Ps(a,l);er(r,Qge,qi,u,t,l)}function O7(n,e){vs(n,Math.round(e*1e6)/1e6)}const eme=ut(bt,["IconStyle","LabelStyle","LineStyle","PolyStyle"]),tme=ut(bt,{IconStyle:Qe(Pge),LabelStyle:Qe(Lge),LineStyle:Qe(Fge),PolyStyle:Qe(Jge)});function nme(n,e,t){const r={node:n},i={};if(e.pointStyles.length){const l=e.pointStyles[0].getText();l&&(i.LabelStyle=l);const u=e.pointStyles[0].getImage();u&&typeof u.getSrc=="function"&&(i.IconStyle=u)}if(e.lineStyles.length){const l=e.lineStyles[0].getStroke();l&&(i.LineStyle=l)}if(e.polyStyles.length){const l=e.polyStyles[0].getStroke();l&&!i.LineStyle&&(i.LineStyle=l),i.PolyStyle=e.polyStyles[0]}const s=t[t.length-1].node,a=eme[s.namespaceURI],o=Ps(i,a);er(r,tme,qi,o,t,a)}function rme(n,e){n.setAttribute("x",String(e.x)),n.setAttribute("y",String(e.y)),n.setAttribute("xunits",e.xunits),n.setAttribute("yunits",e.yunits)}function D7(n){const e=Object.keys(n.defs),t=e.length;let r,i;for(r=0;r<t;++r){const s=e[r];if(!T_(s)){const a=n.defs(s);let o=a.units;!o&&a.projName==="longlat"&&(o="degrees"),ix(new Lv({code:s,axisOrientation:a.axis,metersPerUnit:a.to_meter,units:o}))}}for(r=0;r<t;++r){const s=e[r],a=T_(s);for(i=0;i<t;++i){const o=e[i],l=T_(o);if(!b_(s,o))if(n.defs[s]===n.defs[o])nT([a,l]);else{const u=n(s,o);IU(a,l,WP(a,l,u.forward),WP(l,a,u.inverse))}}}}console.log(" parcelHighlight.ts v3.1 loaded - fixed pixelRatio for Android");vn.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs");D7(vn);let bh=null,jm=null,kf=null;function Bb(n){bh&&(n.removeLayer(bh),bh=null),jm&&(n.removeLayer(jm),jm=null),kf=null}async function ime(n,e){try{const t=xn(e);console.log(` Click (3857): ${e[0].toFixed(0)}, ${e[1].toFixed(0)}`),console.log(` LonLat (WGS84): ${t[0].toFixed(5)}, ${t[1].toFixed(5)}`);const r=vn("EPSG:4326","EPSG:28992",t);if(console.log(` RD (28992): ${r?r[0].toFixed(0)+", "+r[1].toFixed(0):"FAILED"}`),!r||r[0]<7e3||r[0]>3e5||r[1]<289e3||r[1]>629e3)return console.error(" Coordinate outside Netherlands or transformation failed:",r),!1;Bb(n);const i=1,s=`${r[0]-i},${r[1]-i},${r[0]+i},${r[1]+i}`,a=Date.now(),o=`https://service.pdok.nl/rvo/brpgewaspercelen/wfs/v1_0?SERVICE=WFS&VERSION=2.0.0&REQUEST=GetFeature&TYPENAMES=brpgewaspercelen:BrpGewas&OUTPUTFORMAT=json&SRSNAME=EPSG:28992&BBOX=${s},EPSG:28992&_=${a}`;console.log(" WFS URL:",o);const l=new AbortController,u=setTimeout(()=>l.abort(),1e4),h=await fetch(o,{signal:l.signal});if(clearTimeout(u),!h.ok)return console.error("WFS request failed:",h.status),!1;const f=await h.json();if(console.log(" WFS RESPONSE:",JSON.stringify(f).substring(0,500)),!f.features||f.features.length===0)return console.log("No parcel found at location"),!1;const g=f.features[0];console.log(" PARCEL ID:",g.id||g.properties?.id||"geen ID"),console.log(" PARCEL BBOX:",JSON.stringify(g.bbox||"geen bbox"));const v=new FR().readFeature(g,{dataProjection:"EPSG:28992",featureProjection:"EPSG:3857"}),x=v.getGeometry();if(!x)return console.log("No geometry in parcel feature"),!1;const E=g.properties||{};console.log(` Parcel: ${E.category||"unknown"} - ${E.gewasnaam||E.gewas||"geen gewas"}`),console.log(` Geometry type: ${x.getType()}, extent: ${x.getExtent().map(k=>k.toFixed(0)).join(", ")}`);const T=x.getExtent(),b=T[2]-T[0],I=T[3]-T[1],M=Math.max(b,I)*.05,F=[T[0]-M,T[1]-M,T[2]+M,T[3]+M],z=Math.max(b,I)*.3,P=[T[0]-z,T[1]-z,T[2]+z,T[3]+z];kf=x,bh=new vW({source:new KW({url:"https://ahn.arcgisonline.nl/arcgis/rest/services/Hoogtebestand/AHN4_DTM_50cm/ImageServer",params:{renderingRule:JSON.stringify({rasterFunction:"AHN - Color Ramp D"})},crossOrigin:"anonymous"}),extent:F,zIndex:998}),bh.on("prerender",k=>{if(!kf)return;const L=k.context;if(!L)return;const O=k.frameState;if(!O)return;L.save(),L.beginPath(),(kf.getType()==="Polygon"?kf.getCoordinates()[0]:kf.getCoordinates()[0][0]).forEach((j,Te)=>{const Ce=n.getPixelFromCoordinate(j);if(!Ce)return;const Ue=O.pixelRatio,Ne=Ce[0]*Ue,le=Ce[1]*Ue;Te===0?L.moveTo(Ne,le):L.lineTo(Ne,le)}),L.closePath(),L.clip()}),bh.on("postrender",k=>{const L=k.context;L&&L.restore()}),n.addLayer(bh);const C=new O0({features:[v]});return jm=new F0({source:C,style:new $n({fill:new kr({color:"rgba(0, 0, 0, 0)"}),stroke:new Hr({color:"#dc2626",width:3})}),zIndex:999}),n.addLayer(jm),console.log(" Parcel height map displayed"),!0}catch(t){return console.error("Failed to show parcel height map:",t),!1}}var dv={};dv.version="0.18.5";var F7=1252,sme=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],j7=function(n){sme.indexOf(n)!=-1&&(F7=n)};function ame(){j7(1252)}var Mp=function(n){j7(n)};function ome(){Mp(1200),ame()}var m_=function(e){return String.fromCharCode(e)},HL=function(e){return String.fromCharCode(e)},fv,Zc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Np(n){for(var e="",t=0,r=0,i=0,s=0,a=0,o=0,l=0,u=0;u<n.length;)t=n.charCodeAt(u++),s=t>>2,r=n.charCodeAt(u++),a=(t&3)<<4|r>>4,i=n.charCodeAt(u++),o=(r&15)<<2|i>>6,l=i&63,isNaN(r)?o=l=64:isNaN(i)&&(l=64),e+=Zc.charAt(s)+Zc.charAt(a)+Zc.charAt(o)+Zc.charAt(l);return e}function Kl(n){var e="",t=0,r=0,i=0,s=0,a=0,o=0,l=0;n=n.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<n.length;)s=Zc.indexOf(n.charAt(u++)),a=Zc.indexOf(n.charAt(u++)),t=s<<2|a>>4,e+=String.fromCharCode(t),o=Zc.indexOf(n.charAt(u++)),r=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(r)),l=Zc.indexOf(n.charAt(u++)),i=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var Rn=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),ec=(function(){if(typeof Buffer<"u"){var n=!Buffer.from;if(!n)try{Buffer.from("foo","utf8")}catch{n=!0}return n?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}})();function nd(n){return Rn?Buffer.alloc?Buffer.alloc(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}function KL(n){return Rn?Buffer.allocUnsafe?Buffer.allocUnsafe(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}var Za=function(e){return Rn?ec(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)&255})};function zw(n){if(typeof ArrayBuffer>"u")return Za(n);for(var e=new ArrayBuffer(n.length),t=new Uint8Array(e),r=0;r!=n.length;++r)t[r]=n.charCodeAt(r)&255;return e}function k1(n){if(Array.isArray(n))return n.map(function(r){return String.fromCharCode(r)}).join("");for(var e=[],t=0;t<n.length;++t)e[t]=String.fromCharCode(n[t]);return e.join("")}function lme(n){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(n)}var Ri=Rn?function(n){return Buffer.concat(n.map(function(e){return Buffer.isBuffer(e)?e:ec(e)}))}:function(n){if(typeof Uint8Array<"u"){var e=0,t=0;for(e=0;e<n.length;++e)t+=n[e].length;var r=new Uint8Array(t),i=0;for(e=0,t=0;e<n.length;t+=i,++e)if(i=n[e].length,n[e]instanceof Uint8Array)r.set(n[e],t);else{if(typeof n[e]=="string")throw"wtf";r.set(new Uint8Array(n[e]),t)}return r}return[].concat.apply([],n.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function cme(n){for(var e=[],t=0,r=n.length+250,i=nd(n.length+255),s=0;s<n.length;++s){var a=n.charCodeAt(s);if(a<128)i[t++]=a;else if(a<2048)i[t++]=192|a>>6&31,i[t++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=n.charCodeAt(++s)&1023;i[t++]=240|a>>8&7,i[t++]=128|a>>2&63,i[t++]=128|o>>6&15|(a&3)<<4,i[t++]=128|o&63}else i[t++]=224|a>>12&15,i[t++]=128|a>>6&63,i[t++]=128|a&63;t>r&&(e.push(i.slice(0,t)),t=0,i=nd(65535),r=65530)}return e.push(i.slice(0,t)),Ri(e)}var Vm=/\u0000/g,p_=/[\u0001-\u0006]/g;function r0(n){for(var e="",t=n.length-1;t>=0;)e+=n.charAt(t--);return e}function eo(n,e){var t=""+n;return t.length>=e?t:Rr("0",e-t.length)+t}function KR(n,e){var t=""+n;return t.length>=e?t:Rr(" ",e-t.length)+t}function gv(n,e){var t=""+n;return t.length>=e?t:t+Rr(" ",e-t.length)}function ume(n,e){var t=""+Math.round(n);return t.length>=e?t:Rr("0",e-t.length)+t}function hme(n,e){var t=""+n;return t.length>=e?t:Rr("0",e-t.length)+t}var YL=Math.pow(2,32);function pf(n,e){if(n>YL||n<-YL)return ume(n,e);var t=Math.round(n);return hme(t,e)}function mv(n,e){return e=e||0,n.length>=7+e&&(n.charCodeAt(e)|32)===103&&(n.charCodeAt(e+1)|32)===101&&(n.charCodeAt(e+2)|32)===110&&(n.charCodeAt(e+3)|32)===101&&(n.charCodeAt(e+4)|32)===114&&(n.charCodeAt(e+5)|32)===97&&(n.charCodeAt(e+6)|32)===108}var XL=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],VS=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function dme(n){return n||(n={}),n[0]="General",n[1]="0",n[2]="0.00",n[3]="#,##0",n[4]="#,##0.00",n[9]="0%",n[10]="0.00%",n[11]="0.00E+00",n[12]="# ?/?",n[13]="# ??/??",n[14]="m/d/yy",n[15]="d-mmm-yy",n[16]="d-mmm",n[17]="mmm-yy",n[18]="h:mm AM/PM",n[19]="h:mm:ss AM/PM",n[20]="h:mm",n[21]="h:mm:ss",n[22]="m/d/yy h:mm",n[37]="#,##0 ;(#,##0)",n[38]="#,##0 ;[Red](#,##0)",n[39]="#,##0.00;(#,##0.00)",n[40]="#,##0.00;[Red](#,##0.00)",n[45]="mm:ss",n[46]="[h]:mm:ss",n[47]="mmss.0",n[48]="##0.0E+0",n[49]="@",n[56]='"/ "hh""mm""ss" "',n}var Pr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},qL={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},fme={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function pv(n,e,t){for(var r=n<0?-1:1,i=n*r,s=0,a=1,o=0,l=1,u=0,h=0,f=Math.floor(i);u<e&&(f=Math.floor(i),o=f*a+s,h=f*u+l,!(i-f<5e-8));)i=1/(i-f),s=a,a=o,l=u,u=h;if(h>e&&(u>e?(h=l,o=s):(h=u,o=a)),!t)return[0,r*o,h];var g=Math.floor(r*o/h);return[g,r*o-g*h,h]}function y_(n,e,t){if(n>2958465||n<0)return null;var r=n|0,i=Math.floor(86400*(n-r)),s=0,a=[],o={D:r,T:i,u:86400*(n-r)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(r+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++r,++o.D)),r===60)a=t?[1317,10,29]:[1900,2,29],s=3;else if(r===0)a=t?[1317,8,29]:[1900,1,0],s=6;else{r>60&&--r;var l=new Date(1900,0,1);l.setDate(l.getDate()+r-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),r<60&&(s=(s+6)%7),t&&(s=vme(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var V7=new Date(1899,11,31,0,0,0),gme=V7.getTime(),mme=new Date(1900,2,1,0,0,0);function G7(n,e){var t=n.getTime();return e?t-=1461*24*60*60*1e3:n>=mme&&(t+=1440*60*1e3),(t-(gme+(n.getTimezoneOffset()-V7.getTimezoneOffset())*6e4))/(1440*60*1e3)}function YR(n){return n.indexOf(".")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function pme(n){return n.indexOf("E")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function yme(n){var e=n<0?12:11,t=YR(n.toFixed(12));return t.length<=e||(t=n.toPrecision(10),t.length<=e)?t:n.toExponential(5)}function _me(n){var e=YR(n.toFixed(11));return e.length>(n<0?12:11)||e==="0"||e==="-0"?n.toPrecision(6):e}function xme(n){var e=Math.floor(Math.log(Math.abs(n))*Math.LOG10E),t;return e>=-4&&e<=-1?t=n.toPrecision(10+e):Math.abs(e)<=9?t=yme(n):e===10?t=n.toFixed(10).substr(0,12):t=_me(n),YR(pme(t.toUpperCase()))}function Ub(n,e){switch(typeof n){case"string":return n;case"boolean":return n?"TRUE":"FALSE";case"number":return(n|0)===n?n.toString(10):xme(n);case"undefined":return"";case"object":if(n==null)return"";if(n instanceof Date)return vu(14,G7(n,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+n)}function vme(n,e){e[0]-=581;var t=n.getDay();return n<60&&(t=(t+6)%7),t}function wme(n,e,t,r){var i="",s=0,a=0,o=t.y,l,u=0;switch(n){case 98:o=t.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,u=2;break;default:l=o%1e4,u=4;break}break;case 109:switch(e.length){case 1:case 2:l=t.m,u=e.length;break;case 3:return VS[t.m-1][1];case 5:return VS[t.m-1][0];default:return VS[t.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=t.d,u=e.length;break;case 3:return XL[t.q][0];default:return XL[t.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(t.H+11)%12,u=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=t.H,u=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=t.M,u=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return t.u===0&&(e=="s"||e=="ss")?eo(t.S,e.length):(r>=2?a=r===3?1e3:100:a=r===1?10:1,s=Math.round(a*(t.S+t.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(i=eo(s,2+r),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=t.D*24+t.H;break;case"[m]":case"[mm]":l=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":l=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+e}u=e.length===3?1:2;break;case 101:l=o,u=1;break}var h=u>0?eo(l,u):"";return h}function Qc(n){var e=3;if(n.length<=e)return n;for(var t=n.length%e,r=n.substr(0,t);t!=n.length;t+=e)r+=(r.length>0?",":"")+n.substr(t,e);return r}var B7=/%/g;function Eme(n,e,t){var r=e.replace(B7,""),i=e.length-r.length;return Dl(n,r,t*Math.pow(10,2*i))+Rr("%",i)}function Sme(n,e,t){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return Dl(n,e.substr(0,r),t/Math.pow(10,3*(e.length-r)))}function U7(n,e){var t,r=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+U7(n,-e);var i=n.indexOf(".");i===-1&&(i=n.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),t=(e/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),t.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(a-t.length+s):t+="E+"+(a-s);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,i)+"."+t.substr(2+i),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,h){return l+u+h.substr(0,(i+s)%i)+"."+h.substr(s)+"E"})}else t=e.toExponential(r);return n.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),n.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var z7=/# (\?+)( ?)\/( ?)(\d+)/;function Tme(n,e,t){var r=parseInt(n[4],10),i=Math.round(e*r),s=Math.floor(i/r),a=i-s*r,o=r;return t+(s===0?"":""+s)+" "+(a===0?Rr(" ",n[1].length+1+n[4].length):KR(a,n[1].length)+n[2]+"/"+n[3]+eo(o,n[4].length))}function bme(n,e,t){return t+(e===0?"":""+e)+Rr(" ",n[1].length+2+n[4].length)}var $7=/^#*0*\.([0#]+)/,W7=/\).*[0#]/,H7=/\(###\) ###\\?-####/;function rs(n){for(var e="",t,r=0;r!=n.length;++r)switch(t=n.charCodeAt(r)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(t)}return e}function ZL(n,e){var t=Math.pow(10,e);return""+Math.round(n*t)/t}function QL(n,e){var t=n-Math.floor(n),r=Math.pow(10,e);return e<(""+Math.round(t*r)).length?0:Math.round(t*r)}function Ime(n,e){return e<(""+Math.round((n-Math.floor(n))*Math.pow(10,e))).length?1:0}function Ame(n){return n<2147483647&&n>-2147483648?""+(n>=0?n|0:n-1|0):""+Math.floor(n)}function pa(n,e,t){if(n.charCodeAt(0)===40&&!e.match(W7)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?pa("n",r,t):"("+pa("n",r,-t)+")"}if(e.charCodeAt(e.length-1)===44)return Sme(n,e,t);if(e.indexOf("%")!==-1)return Eme(n,e,t);if(e.indexOf("E")!==-1)return U7(e,t);if(e.charCodeAt(0)===36)return"$"+pa(n,e.substr(e.charAt(1)==" "?2:1),t);var i,s,a,o,l=Math.abs(t),u=t<0?"-":"";if(e.match(/^00+$/))return u+pf(l,e.length);if(e.match(/^[#?]+$/))return i=pf(t,0),i==="0"&&(i=""),i.length>e.length?i:rs(e.substr(0,e.length-i.length))+i;if(s=e.match(z7))return Tme(s,l,u);if(e.match(/^#+0+$/))return u+pf(l,e.length-e.indexOf("0"));if(s=e.match($7))return i=ZL(t,s[1].length).replace(/^([^\.]+)$/,"$1."+rs(s[1])).replace(/\.$/,"."+rs(s[1])).replace(/\.(\d*)$/,function(v,x){return"."+x+Rr("0",rs(s[1]).length-x.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+ZL(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+Qc(pf(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+pa(n,e,-t):Qc(""+(Math.floor(t)+Ime(t,s[1].length)))+"."+eo(QL(t,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return pa(n,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=r0(pa(n,e.replace(/[\\-]/g,""),t)),a=0,r0(r0(e.replace(/\\/g,"")).replace(/[0#]/g,function(v){return a<i.length?i.charAt(a++):v==="0"?"0":""}));if(e.match(H7))return i=pa(n,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=pv(l,Math.pow(10,a)-1,!1),i=""+u,h=Dl("n",s[1],o[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+s[2]+"/"+s[3],h=gv(o[2],a),h.length<s[4].length&&(h=rs(s[4].substr(s[4].length-h.length))+h),i+=h,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=pv(l,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?KR(o[1],a)+s[2]+"/"+s[3]+gv(o[2],a):Rr(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=pf(t,0),e.length<=i.length?i:rs(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var f=e.indexOf(".")-a,g=e.length-i.length-f;return rs(e.substr(0,f)+i+e.substr(e.length-g))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=QL(t,s[1].length),t<0?"-"+pa(n,e,-t):Qc(Ame(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?eo(0,3-v.length):"")+v})+"."+eo(a,s[1].length);switch(e){case"###,##0.00":return pa(n,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var y=Qc(pf(l,0));return y!=="0"?u+y:"";case"###,###.00":return pa(n,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return pa(n,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function Rme(n,e,t){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return Dl(n,e.substr(0,r),t/Math.pow(10,3*(e.length-r)))}function Cme(n,e,t){var r=e.replace(B7,""),i=e.length-r.length;return Dl(n,r,t*Math.pow(10,2*i))+Rr("%",i)}function K7(n,e){var t,r=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+K7(n,-e);var i=n.indexOf(".");i===-1&&(i=n.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),t=(e/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),!t.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(a-t.length+s):t+="E+"+(a-s),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,h){return l+u+h.substr(0,(i+s)%i)+"."+h.substr(s)+"E"})}else t=e.toExponential(r);return n.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),n.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Po(n,e,t){if(n.charCodeAt(0)===40&&!e.match(W7)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Po("n",r,t):"("+Po("n",r,-t)+")"}if(e.charCodeAt(e.length-1)===44)return Rme(n,e,t);if(e.indexOf("%")!==-1)return Cme(n,e,t);if(e.indexOf("E")!==-1)return K7(e,t);if(e.charCodeAt(0)===36)return"$"+Po(n,e.substr(e.charAt(1)==" "?2:1),t);var i,s,a,o,l=Math.abs(t),u=t<0?"-":"";if(e.match(/^00+$/))return u+eo(l,e.length);if(e.match(/^[#?]+$/))return i=""+t,t===0&&(i=""),i.length>e.length?i:rs(e.substr(0,e.length-i.length))+i;if(s=e.match(z7))return bme(s,l,u);if(e.match(/^#+0+$/))return u+eo(l,e.length-e.indexOf("0"));if(s=e.match($7))return i=(""+t).replace(/^([^\.]+)$/,"$1."+rs(s[1])).replace(/\.$/,"."+rs(s[1])),i=i.replace(/\.(\d*)$/,function(v,x){return"."+x+Rr("0",rs(s[1]).length-x.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+Qc(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Po(n,e,-t):Qc(""+t)+"."+Rr("0",s[1].length);if(s=e.match(/^#,#*,#0/))return Po(n,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=r0(Po(n,e.replace(/[\\-]/g,""),t)),a=0,r0(r0(e.replace(/\\/g,"")).replace(/[0#]/g,function(v){return a<i.length?i.charAt(a++):v==="0"?"0":""}));if(e.match(H7))return i=Po(n,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=pv(l,Math.pow(10,a)-1,!1),i=""+u,h=Dl("n",s[1],o[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+s[2]+"/"+s[3],h=gv(o[2],a),h.length<s[4].length&&(h=rs(s[4].substr(s[4].length-h.length))+h),i+=h,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=pv(l,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?KR(o[1],a)+s[2]+"/"+s[3]+gv(o[2],a):Rr(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+t,e.length<=i.length?i:rs(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var f=e.indexOf(".")-a,g=e.length-i.length-f;return rs(e.substr(0,f)+i+e.substr(e.length-g))}if(s=e.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Po(n,e,-t):Qc(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?eo(0,3-v.length):"")+v})+"."+eo(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var y=Qc(""+l);return y!=="0"?u+y:"";default:if(e.match(/\.[0#?]*$/))return Po(n,e.slice(0,e.lastIndexOf(".")),t)+rs(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Dl(n,e,t){return(t|0)===t?Po(n,e,t):pa(n,e,t)}function kme(n){for(var e=[],t=!1,r=0,i=0;r<n.length;++r)switch(n.charCodeAt(r)){case 34:t=!t;break;case 95:case 42:case 92:++r;break;case 59:e[e.length]=n.substr(i,r-i),i=r+1}if(e[e.length]=n.substr(i),t===!0)throw new Error("Format |"+n+"| unterminated string ");return e}var Y7=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function X7(n){for(var e=0,t="",r="";e<n.length;)switch(t=n.charAt(e)){case"G":mv(n,e)&&(e+=6),e++;break;case'"':for(;n.charCodeAt(++e)!==34&&e<n.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(n.charAt(e+1)==="1"||n.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(n.substr(e,3).toUpperCase()==="A/P"||n.substr(e,5).toUpperCase()==="AM/PM"||n.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(r=t;n.charAt(e++)!=="]"&&e<n.length;)r+=n.charAt(e);if(r.match(Y7))return!0;break;case".":case"0":case"#":for(;e<n.length&&("0#?.,E+-%".indexOf(t=n.charAt(++e))>-1||t=="\\"&&n.charAt(e+1)=="-"&&"0#".indexOf(n.charAt(e+2))>-1););break;case"?":for(;n.charAt(++e)===t;);break;case"*":++e,(n.charAt(e)==" "||n.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<n.length&&"0123456789".indexOf(n.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function Pme(n,e,t,r){for(var i=[],s="",a=0,o="",l="t",u,h,f,g="H";a<n.length;)switch(o=n.charAt(a)){case"G":if(!mv(n,a))throw new Error("unrecognized character "+o+" in "+n);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(f=n.charCodeAt(++a))!==34&&a<n.length;)s+=String.fromCharCode(f);i[i.length]={t:"t",v:s},++a;break;case"\\":var y=n.charAt(++a),v=y==="("||y===")"?y:"t";i[i.length]={t:v,v:y},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:e},++a;break;case"B":case"b":if(n.charAt(a+1)==="1"||n.charAt(a+1)==="2"){if(u==null&&(u=y_(e,t,n.charAt(a+1)==="2"),u==null))return"";i[i.length]={t:"X",v:n.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||u==null&&(u=y_(e,t),u==null))return"";for(s=o;++a<n.length&&n.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=g),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var x={t:o,v:o};if(u==null&&(u=y_(e,t)),n.substr(a,3).toUpperCase()==="A/P"?(u!=null&&(x.v=u.H>=12?"P":"A"),x.t="T",g="h",a+=3):n.substr(a,5).toUpperCase()==="AM/PM"?(u!=null&&(x.v=u.H>=12?"PM":"AM"),x.t="T",a+=5,g="h"):n.substr(a,5).toUpperCase()==="/"?(u!=null&&(x.v=u.H>=12?"":""),x.t="T",a+=5,g="h"):(x.t="t",++a),u==null&&x.t==="T")return"";i[i.length]=x,l=o;break;case"[":for(s=o;n.charAt(a++)!=="]"&&a<n.length;)s+=n.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(Y7)){if(u==null&&(u=y_(e,t),u==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",X7(n)||(i[i.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=o;++a<n.length&&(o=n.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<n.length&&"0#?.,E+-%".indexOf(o=n.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;n.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(n.charAt(a)==" "||n.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:r===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<n.length&&"0123456789".indexOf(n.charAt(++a))>-1;)s+=n.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+n);i[i.length]={t:"t",v:o},++a;break}var E=0,T=0,b;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=g,l="h",E<1&&(E=1);break;case"s":(b=i[a].v.match(/\.0+$/))&&(T=Math.max(T,b[0].length-1)),E<3&&(E=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",E<2&&(E=2));break;case"X":break;case"Z":E<1&&i[a].v.match(/[Hh]/)&&(E=1),E<2&&i[a].v.match(/[Mm]/)&&(E=2),E<3&&i[a].v.match(/[Ss]/)&&(E=3)}switch(E){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var I="",M;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=wme(i[a].t.charCodeAt(0),i[a].v,u,T),i[a].t="t";break;case"n":case"?":for(M=a+1;i[M]!=null&&((o=i[M].t)==="?"||o==="D"||(o===" "||o==="t")&&i[M+1]!=null&&(i[M+1].t==="?"||i[M+1].t==="t"&&i[M+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[M].v==="/"||i[M].v===" "&&i[M+1]!=null&&i[M+1].t=="?"));)i[a].v+=i[M].v,i[M]={v:"",t:";"},++M;I+=i[a].v,a=M-1;break;case"G":i[a].t="t",i[a].v=Ub(e,t);break}var F="",z,P;if(I.length>0){I.charCodeAt(0)==40?(z=e<0&&I.charCodeAt(0)===45?-e:e,P=Dl("n",I,z)):(z=e<0&&r>1?-e:e,P=Dl("n",I,z),z<0&&i[0]&&i[0].t=="t"&&(P=P.substr(1),i[0].v="-"+i[0].v)),M=P.length-1;var C=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){C=a;break}var k=i.length;if(C===i.length&&P.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(M>=i[a].v.length-1?(M-=i[a].v.length,i[a].v=P.substr(M+1,i[a].v.length)):M<0?i[a].v="":(i[a].v=P.substr(0,M+1),M=-1),i[a].t="t",k=a);M>=0&&k<i.length&&(i[k].v=P.substr(0,M+1)+i[k].v)}else if(C!==i.length&&P.indexOf("E")===-1){for(M=P.indexOf(".")-1,a=C;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(h=i[a].v.indexOf(".")>-1&&a===C?i[a].v.indexOf(".")-1:i[a].v.length-1,F=i[a].v.substr(h+1);h>=0;--h)M>=0&&(i[a].v.charAt(h)==="0"||i[a].v.charAt(h)==="#")&&(F=P.charAt(M--)+F);i[a].v=F,i[a].t="t",k=a}for(M>=0&&k<i.length&&(i[k].v=P.substr(0,M+1)+i[k].v),M=P.indexOf(".")+1,a=C;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==C)){for(h=i[a].v.indexOf(".")>-1&&a===C?i[a].v.indexOf(".")+1:0,F=i[a].v.substr(0,h);h<i[a].v.length;++h)M<P.length&&(F+=P.charAt(M++));i[a].v=F,i[a].t="t",k=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(z=r>1&&e<0&&a>0&&i[a-1].v==="-"?-e:e,i[a].v=Dl(i[a].t,i[a].v,z),i[a].t="t");var L="";for(a=0;a!==i.length;++a)i[a]!=null&&(L+=i[a].v);return L}var JL=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function eO(n,e){if(e==null)return!1;var t=parseFloat(e[2]);switch(e[1]){case"=":if(n==t)return!0;break;case">":if(n>t)return!0;break;case"<":if(n<t)return!0;break;case"<>":if(n!=t)return!0;break;case">=":if(n>=t)return!0;break;case"<=":if(n<=t)return!0;break}return!1}function Mme(n,e){var t=kme(n),r=t.length,i=t[r-1].indexOf("@");if(r<4&&i>-1&&--r,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof e!="number")return[4,t.length===4||i>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=i>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=i>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=i>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var s=e>0?t[0]:e<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[r,s];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var a=t[0].match(JL),o=t[1].match(JL);return eO(e,a)?[r,t[0]]:eO(e,o)?[r,t[1]]:[r,t[a!=null&&o!=null?2:1]]}return[r,s]}function vu(n,e,t){t==null&&(t={});var r="";switch(typeof n){case"string":n=="m/d/yy"&&t.dateNF?r=t.dateNF:r=n;break;case"number":n==14&&t.dateNF?r=t.dateNF:r=(t.table!=null?t.table:Pr)[n],r==null&&(r=t.table&&t.table[qL[n]]||Pr[qL[n]]),r==null&&(r=fme[n]||"General");break}if(mv(r,0))return Ub(e,t);e instanceof Date&&(e=G7(e,t.date1904));var i=Mme(r,e);if(mv(i[1]))return Ub(e,t);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return Pme(i[1],e,t,i[0])}function q7(n,e){if(typeof e!="number"){e=+e||-1;for(var t=0;t<392;++t){if(Pr[t]==null){e<0&&(e=t);continue}if(Pr[t]==n){e=t;break}}e<0&&(e=391)}return Pr[e]=n,e}function $w(n){for(var e=0;e!=392;++e)n[e]!==void 0&&q7(n[e],e)}function Ww(){Pr=dme()}var Z7=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Nme(n){var e=typeof n=="number"?Pr[n]:n;return e=e.replace(Z7,"(\\d+)"),new RegExp("^"+e+"$")}function Lme(n,e,t){var r=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(e.match(Z7)||[]).forEach(function(f,g){var y=parseInt(t[g+1],10);switch(f.toLowerCase().charAt(0)){case"y":r=y;break;case"d":s=y;break;case"h":a=y;break;case"s":l=y;break;case"m":a>=0?o=y:i=y;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var u=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var h=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?u:r==-1&&i==-1&&s==-1?h:u+"T"+h}var Ome=(function(){var n={};n.version="1.2.0";function e(){for(var P=0,C=new Array(256),k=0;k!=256;++k)P=k,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,C[k]=P;return typeof Int32Array<"u"?new Int32Array(C):C}var t=e();function r(P){var C=0,k=0,L=0,O=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(L=0;L!=256;++L)O[L]=P[L];for(L=0;L!=256;++L)for(k=P[L],C=256+L;C<4096;C+=256)k=O[C]=k>>>8^P[k&255];var U=[];for(L=1;L!=16;++L)U[L-1]=typeof Int32Array<"u"?O.subarray(L*256,L*256+256):O.slice(L*256,L*256+256);return U}var i=r(t),s=i[0],a=i[1],o=i[2],l=i[3],u=i[4],h=i[5],f=i[6],g=i[7],y=i[8],v=i[9],x=i[10],E=i[11],T=i[12],b=i[13],I=i[14];function M(P,C){for(var k=C^-1,L=0,O=P.length;L<O;)k=k>>>8^t[(k^P.charCodeAt(L++))&255];return~k}function F(P,C){for(var k=C^-1,L=P.length-15,O=0;O<L;)k=I[P[O++]^k&255]^b[P[O++]^k>>8&255]^T[P[O++]^k>>16&255]^E[P[O++]^k>>>24]^x[P[O++]]^v[P[O++]]^y[P[O++]]^g[P[O++]]^f[P[O++]]^h[P[O++]]^u[P[O++]]^l[P[O++]]^o[P[O++]]^a[P[O++]]^s[P[O++]]^t[P[O++]];for(L+=15;O<L;)k=k>>>8^t[(k^P[O++])&255];return~k}function z(P,C){for(var k=C^-1,L=0,O=P.length,U=0,j=0;L<O;)U=P.charCodeAt(L++),U<128?k=k>>>8^t[(k^U)&255]:U<2048?(k=k>>>8^t[(k^(192|U>>6&31))&255],k=k>>>8^t[(k^(128|U&63))&255]):U>=55296&&U<57344?(U=(U&1023)+64,j=P.charCodeAt(L++)&1023,k=k>>>8^t[(k^(240|U>>8&7))&255],k=k>>>8^t[(k^(128|U>>2&63))&255],k=k>>>8^t[(k^(128|j>>6&15|(U&3)<<4))&255],k=k>>>8^t[(k^(128|j&63))&255]):(k=k>>>8^t[(k^(224|U>>12&15))&255],k=k>>>8^t[(k^(128|U>>6&63))&255],k=k>>>8^t[(k^(128|U&63))&255]);return~k}return n.table=t,n.bstr=M,n.buf=F,n.str=z,n})(),Xn=(function(){var e={};e.version="1.2.1";function t(B,Q){for(var K=B.split("/"),Y=Q.split("/"),ee=0,te=0,_e=Math.min(K.length,Y.length);ee<_e;++ee){if(te=K[ee].length-Y[ee].length)return te;if(K[ee]!=Y[ee])return K[ee]<Y[ee]?-1:1}return K.length-Y.length}function r(B){if(B.charAt(B.length-1)=="/")return B.slice(0,-1).indexOf("/")===-1?B:r(B.slice(0,-1));var Q=B.lastIndexOf("/");return Q===-1?B:B.slice(0,Q+1)}function i(B){if(B.charAt(B.length-1)=="/")return i(B.slice(0,-1));var Q=B.lastIndexOf("/");return Q===-1?B:B.slice(Q+1)}function s(B,Q){typeof Q=="string"&&(Q=new Date(Q));var K=Q.getHours();K=K<<6|Q.getMinutes(),K=K<<5|Q.getSeconds()>>>1,B.write_shift(2,K);var Y=Q.getFullYear()-1980;Y=Y<<4|Q.getMonth()+1,Y=Y<<5|Q.getDate(),B.write_shift(2,Y)}function a(B){var Q=B.read_shift(2)&65535,K=B.read_shift(2)&65535,Y=new Date,ee=K&31;K>>>=5;var te=K&15;K>>>=4,Y.setMilliseconds(0),Y.setFullYear(K+1980),Y.setMonth(te-1),Y.setDate(ee);var _e=Q&31;Q>>>=5;var ke=Q&63;return Q>>>=6,Y.setHours(Q),Y.setMinutes(ke),Y.setSeconds(_e<<1),Y}function o(B){Ws(B,0);for(var Q={},K=0;B.l<=B.length-4;){var Y=B.read_shift(2),ee=B.read_shift(2),te=B.l+ee,_e={};switch(Y){case 21589:K=B.read_shift(1),K&1&&(_e.mtime=B.read_shift(4)),ee>5&&(K&2&&(_e.atime=B.read_shift(4)),K&4&&(_e.ctime=B.read_shift(4))),_e.mtime&&(_e.mt=new Date(_e.mtime*1e3));break}B.l=te,Q[Y]=_e}return Q}var l;function u(){return l||(l={})}function h(B,Q){if(B[0]==80&&B[1]==75)return Z(B,Q);if((B[0]|32)==109&&(B[1]|32)==105)return St(B,Q);if(B.length<512)throw new Error("CFB file size "+B.length+" < 512");var K=3,Y=512,ee=0,te=0,_e=0,ke=0,ye=0,ve=[],Ee=B.slice(0,512);Ws(Ee,0);var Ke=f(Ee);switch(K=Ke[0],K){case 3:Y=512;break;case 4:Y=4096;break;case 0:if(Ke[1]==0)return Z(B,Q);default:throw new Error("Major Version: Expected 3 or 4 saw "+K)}Y!==512&&(Ee=B.slice(0,Y),Ws(Ee,28));var tt=B.slice(0,Y);g(Ee,K);var gt=Ee.read_shift(4,"i");if(K===3&&gt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+gt);Ee.l+=4,_e=Ee.read_shift(4,"i"),Ee.l+=4,Ee.chk("00100000","Mini Stream Cutoff Size: "),ke=Ee.read_shift(4,"i"),ee=Ee.read_shift(4,"i"),ye=Ee.read_shift(4,"i"),te=Ee.read_shift(4,"i");for(var Ye=-1,Xe=0;Xe<109&&(Ye=Ee.read_shift(4,"i"),!(Ye<0));++Xe)ve[Xe]=Ye;var zt=y(B,Y);E(ye,te,zt,Y,ve);var Mn=b(zt,_e,ve,Y);Mn[_e].name="!Directory",ee>0&&ke!==j&&(Mn[ke].name="!MiniFAT"),Mn[ve[0]].name="!FAT",Mn.fat_addrs=ve,Mn.ssz=Y;var jn={},dr=[],Na=[],aa=[];I(_e,Mn,zt,dr,ee,jn,Na,ke),v(Na,aa,dr),dr.shift();var Os={FileIndex:Na,FullPaths:aa};return Q&&Q.raw&&(Os.raw={header:tt,sectors:zt}),Os}function f(B){if(B[B.l]==80&&B[B.l+1]==75)return[0,0];B.chk(Te,"Header Signature: "),B.l+=16;var Q=B.read_shift(2,"u");return[B.read_shift(2,"u"),Q]}function g(B,Q){var K=9;switch(B.l+=2,K=B.read_shift(2)){case 9:if(Q!=3)throw new Error("Sector Shift: Expected 9 saw "+K);break;case 12:if(Q!=4)throw new Error("Sector Shift: Expected 12 saw "+K);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+K)}B.chk("0600","Mini Sector Shift: "),B.chk("000000000000","Reserved: ")}function y(B,Q){for(var K=Math.ceil(B.length/Q)-1,Y=[],ee=1;ee<K;++ee)Y[ee-1]=B.slice(ee*Q,(ee+1)*Q);return Y[K-1]=B.slice(K*Q),Y}function v(B,Q,K){for(var Y=0,ee=0,te=0,_e=0,ke=0,ye=K.length,ve=[],Ee=[];Y<ye;++Y)ve[Y]=Ee[Y]=Y,Q[Y]=K[Y];for(;ke<Ee.length;++ke)Y=Ee[ke],ee=B[Y].L,te=B[Y].R,_e=B[Y].C,ve[Y]===Y&&(ee!==-1&&ve[ee]!==ee&&(ve[Y]=ve[ee]),te!==-1&&ve[te]!==te&&(ve[Y]=ve[te])),_e!==-1&&(ve[_e]=Y),ee!==-1&&Y!=ve[Y]&&(ve[ee]=ve[Y],Ee.lastIndexOf(ee)<ke&&Ee.push(ee)),te!==-1&&Y!=ve[Y]&&(ve[te]=ve[Y],Ee.lastIndexOf(te)<ke&&Ee.push(te));for(Y=1;Y<ye;++Y)ve[Y]===Y&&(te!==-1&&ve[te]!==te?ve[Y]=ve[te]:ee!==-1&&ve[ee]!==ee&&(ve[Y]=ve[ee]));for(Y=1;Y<ye;++Y)if(B[Y].type!==0){if(ke=Y,ke!=ve[ke])do ke=ve[ke],Q[Y]=Q[ke]+"/"+Q[Y];while(ke!==0&&ve[ke]!==-1&&ke!=ve[ke]);ve[Y]=-1}for(Q[0]+="/",Y=1;Y<ye;++Y)B[Y].type!==2&&(Q[Y]+="/")}function x(B,Q,K){for(var Y=B.start,ee=B.size,te=[],_e=Y;K&&ee>0&&_e>=0;)te.push(Q.slice(_e*U,_e*U+U)),ee-=U,_e=ph(K,_e*4);return te.length===0?Re(0):Ri(te).slice(0,B.size)}function E(B,Q,K,Y,ee){var te=j;if(B===j){if(Q!==0)throw new Error("DIFAT chain shorter than expected")}else if(B!==-1){var _e=K[B],ke=(Y>>>2)-1;if(!_e)return;for(var ye=0;ye<ke&&(te=ph(_e,ye*4))!==j;++ye)ee.push(te);E(ph(_e,Y-4),Q-1,K,Y,ee)}}function T(B,Q,K,Y,ee){var te=[],_e=[];ee||(ee=[]);var ke=Y-1,ye=0,ve=0;for(ye=Q;ye>=0;){ee[ye]=!0,te[te.length]=ye,_e.push(B[ye]);var Ee=K[Math.floor(ye*4/Y)];if(ve=ye*4&ke,Y<4+ve)throw new Error("FAT boundary crossed: "+ye+" 4 "+Y);if(!B[Ee])break;ye=ph(B[Ee],ve)}return{nodes:te,data:lO([_e])}}function b(B,Q,K,Y){var ee=B.length,te=[],_e=[],ke=[],ye=[],ve=Y-1,Ee=0,Ke=0,tt=0,gt=0;for(Ee=0;Ee<ee;++Ee)if(ke=[],tt=Ee+Q,tt>=ee&&(tt-=ee),!_e[tt]){ye=[];var Ye=[];for(Ke=tt;Ke>=0;){Ye[Ke]=!0,_e[Ke]=!0,ke[ke.length]=Ke,ye.push(B[Ke]);var Xe=K[Math.floor(Ke*4/Y)];if(gt=Ke*4&ve,Y<4+gt)throw new Error("FAT boundary crossed: "+Ke+" 4 "+Y);if(!B[Xe]||(Ke=ph(B[Xe],gt),Ye[Ke]))break}te[tt]={nodes:ke,data:lO([ye])}}return te}function I(B,Q,K,Y,ee,te,_e,ke){for(var ye=0,ve=Y.length?2:0,Ee=Q[B].data,Ke=0,tt=0,gt;Ke<Ee.length;Ke+=128){var Ye=Ee.slice(Ke,Ke+128);Ws(Ye,64),tt=Ye.read_shift(2),gt=JR(Ye,0,tt-ve),Y.push(gt);var Xe={name:gt,type:Ye.read_shift(1),color:Ye.read_shift(1),L:Ye.read_shift(4,"i"),R:Ye.read_shift(4,"i"),C:Ye.read_shift(4,"i"),clsid:Ye.read_shift(16),state:Ye.read_shift(4,"i"),start:0,size:0},zt=Ye.read_shift(2)+Ye.read_shift(2)+Ye.read_shift(2)+Ye.read_shift(2);zt!==0&&(Xe.ct=M(Ye,Ye.l-8));var Mn=Ye.read_shift(2)+Ye.read_shift(2)+Ye.read_shift(2)+Ye.read_shift(2);Mn!==0&&(Xe.mt=M(Ye,Ye.l-8)),Xe.start=Ye.read_shift(4,"i"),Xe.size=Ye.read_shift(4,"i"),Xe.size<0&&Xe.start<0&&(Xe.size=Xe.type=0,Xe.start=j,Xe.name=""),Xe.type===5?(ye=Xe.start,ee>0&&ye!==j&&(Q[ye].name="!StreamData")):Xe.size>=4096?(Xe.storage="fat",Q[Xe.start]===void 0&&(Q[Xe.start]=T(K,Xe.start,Q.fat_addrs,Q.ssz)),Q[Xe.start].name=Xe.name,Xe.content=Q[Xe.start].data.slice(0,Xe.size)):(Xe.storage="minifat",Xe.size<0?Xe.size=0:ye!==j&&Xe.start!==j&&Q[ye]&&(Xe.content=x(Xe,Q[ye].data,(Q[ke]||{}).data))),Xe.content&&Ws(Xe.content,0),te[gt]=Xe,_e.push(Xe)}}function M(B,Q){return new Date((Xs(B,Q+4)/1e7*Math.pow(2,32)+Xs(B,Q)/1e7-11644473600)*1e3)}function F(B,Q){return u(),h(l.readFileSync(B),Q)}function z(B,Q){var K=Q&&Q.type;switch(K||Rn&&Buffer.isBuffer(B)&&(K="buffer"),K||"base64"){case"file":return F(B,Q);case"base64":return h(Za(Kl(B)),Q);case"binary":return h(Za(B),Q)}return h(B,Q)}function P(B,Q){var K=Q||{},Y=K.root||"Root Entry";if(B.FullPaths||(B.FullPaths=[]),B.FileIndex||(B.FileIndex=[]),B.FullPaths.length!==B.FileIndex.length)throw new Error("inconsistent CFB structure");B.FullPaths.length===0&&(B.FullPaths[0]=Y+"/",B.FileIndex[0]={name:Y,type:5}),K.CLSID&&(B.FileIndex[0].clsid=K.CLSID),C(B)}function C(B){var Q="Sh33tJ5";if(!Xn.find(B,"/"+Q)){var K=Re(4);K[0]=55,K[1]=K[3]=50,K[2]=54,B.FileIndex.push({name:Q,type:2,content:K,size:4,L:69,R:69,C:69}),B.FullPaths.push(B.FullPaths[0]+Q),k(B)}}function k(B,Q){P(B);for(var K=!1,Y=!1,ee=B.FullPaths.length-1;ee>=0;--ee){var te=B.FileIndex[ee];switch(te.type){case 0:Y?K=!0:(B.FileIndex.pop(),B.FullPaths.pop());break;case 1:case 2:case 5:Y=!0,isNaN(te.R*te.L*te.C)&&(K=!0),te.R>-1&&te.L>-1&&te.R==te.L&&(K=!0);break;default:K=!0;break}}if(!(!K&&!Q)){var _e=new Date(1987,1,19),ke=0,ye=Object.create?Object.create(null):{},ve=[];for(ee=0;ee<B.FullPaths.length;++ee)ye[B.FullPaths[ee]]=!0,B.FileIndex[ee].type!==0&&ve.push([B.FullPaths[ee],B.FileIndex[ee]]);for(ee=0;ee<ve.length;++ee){var Ee=r(ve[ee][0]);Y=ye[Ee],Y||(ve.push([Ee,{name:i(Ee).replace("/",""),type:1,clsid:Ue,ct:_e,mt:_e,content:null}]),ye[Ee]=!0)}for(ve.sort(function(gt,Ye){return t(gt[0],Ye[0])}),B.FullPaths=[],B.FileIndex=[],ee=0;ee<ve.length;++ee)B.FullPaths[ee]=ve[ee][0],B.FileIndex[ee]=ve[ee][1];for(ee=0;ee<ve.length;++ee){var Ke=B.FileIndex[ee],tt=B.FullPaths[ee];if(Ke.name=i(tt).replace("/",""),Ke.L=Ke.R=Ke.C=-(Ke.color=1),Ke.size=Ke.content?Ke.content.length:0,Ke.start=0,Ke.clsid=Ke.clsid||Ue,ee===0)Ke.C=ve.length>1?1:-1,Ke.size=0,Ke.type=5;else if(tt.slice(-1)=="/"){for(ke=ee+1;ke<ve.length&&r(B.FullPaths[ke])!=tt;++ke);for(Ke.C=ke>=ve.length?-1:ke,ke=ee+1;ke<ve.length&&r(B.FullPaths[ke])!=r(tt);++ke);Ke.R=ke>=ve.length?-1:ke,Ke.type=1}else r(B.FullPaths[ee+1]||"")==r(tt)&&(Ke.R=ee+1),Ke.type=2}}}function L(B,Q){var K=Q||{};if(K.fileType=="mad")return sn(B,K);switch(k(B),K.fileType){case"zip":return ce(B,K)}var Y=(function(gt){for(var Ye=0,Xe=0,zt=0;zt<gt.FileIndex.length;++zt){var Mn=gt.FileIndex[zt];if(Mn.content){var jn=Mn.content.length;jn>0&&(jn<4096?Ye+=jn+63>>6:Xe+=jn+511>>9)}}for(var dr=gt.FullPaths.length+3>>2,Na=Ye+7>>3,aa=Ye+127>>7,Os=Na+Xe+dr+aa,Nr=Os+127>>7,tc=Nr<=109?0:Math.ceil((Nr-109)/127);Os+Nr+tc+127>>7>Nr;)tc=++Nr<=109?0:Math.ceil((Nr-109)/127);var _r=[1,tc,Nr,aa,dr,Xe,Ye,0];return gt.FileIndex[0].size=Ye<<6,_r[7]=(gt.FileIndex[0].start=_r[0]+_r[1]+_r[2]+_r[3]+_r[4]+_r[5])+(_r[6]+7>>3),_r})(B),ee=Re(Y[7]<<9),te=0,_e=0;{for(te=0;te<8;++te)ee.write_shift(1,Ce[te]);for(te=0;te<8;++te)ee.write_shift(2,0);for(ee.write_shift(2,62),ee.write_shift(2,3),ee.write_shift(2,65534),ee.write_shift(2,9),ee.write_shift(2,6),te=0;te<3;++te)ee.write_shift(2,0);for(ee.write_shift(4,0),ee.write_shift(4,Y[2]),ee.write_shift(4,Y[0]+Y[1]+Y[2]+Y[3]-1),ee.write_shift(4,0),ee.write_shift(4,4096),ee.write_shift(4,Y[3]?Y[0]+Y[1]+Y[2]-1:j),ee.write_shift(4,Y[3]),ee.write_shift(-4,Y[1]?Y[0]-1:j),ee.write_shift(4,Y[1]),te=0;te<109;++te)ee.write_shift(-4,te<Y[2]?Y[1]+te:-1)}if(Y[1])for(_e=0;_e<Y[1];++_e){for(;te<236+_e*127;++te)ee.write_shift(-4,te<Y[2]?Y[1]+te:-1);ee.write_shift(-4,_e===Y[1]-1?j:_e+1)}var ke=function(gt){for(_e+=gt;te<_e-1;++te)ee.write_shift(-4,te+1);gt&&(++te,ee.write_shift(-4,j))};for(_e=te=0,_e+=Y[1];te<_e;++te)ee.write_shift(-4,Ne.DIFSECT);for(_e+=Y[2];te<_e;++te)ee.write_shift(-4,Ne.FATSECT);ke(Y[3]),ke(Y[4]);for(var ye=0,ve=0,Ee=B.FileIndex[0];ye<B.FileIndex.length;++ye)Ee=B.FileIndex[ye],Ee.content&&(ve=Ee.content.length,!(ve<4096)&&(Ee.start=_e,ke(ve+511>>9)));for(ke(Y[6]+7>>3);ee.l&511;)ee.write_shift(-4,Ne.ENDOFCHAIN);for(_e=te=0,ye=0;ye<B.FileIndex.length;++ye)Ee=B.FileIndex[ye],Ee.content&&(ve=Ee.content.length,!(!ve||ve>=4096)&&(Ee.start=_e,ke(ve+63>>6)));for(;ee.l&511;)ee.write_shift(-4,Ne.ENDOFCHAIN);for(te=0;te<Y[4]<<2;++te){var Ke=B.FullPaths[te];if(!Ke||Ke.length===0){for(ye=0;ye<17;++ye)ee.write_shift(4,0);for(ye=0;ye<3;++ye)ee.write_shift(4,-1);for(ye=0;ye<12;++ye)ee.write_shift(4,0);continue}Ee=B.FileIndex[te],te===0&&(Ee.start=Ee.size?Ee.start-1:j);var tt=te===0&&K.root||Ee.name;if(ve=2*(tt.length+1),ee.write_shift(64,tt,"utf16le"),ee.write_shift(2,ve),ee.write_shift(1,Ee.type),ee.write_shift(1,Ee.color),ee.write_shift(-4,Ee.L),ee.write_shift(-4,Ee.R),ee.write_shift(-4,Ee.C),Ee.clsid)ee.write_shift(16,Ee.clsid,"hex");else for(ye=0;ye<4;++ye)ee.write_shift(4,0);ee.write_shift(4,Ee.state||0),ee.write_shift(4,0),ee.write_shift(4,0),ee.write_shift(4,0),ee.write_shift(4,0),ee.write_shift(4,Ee.start),ee.write_shift(4,Ee.size),ee.write_shift(4,0)}for(te=1;te<B.FileIndex.length;++te)if(Ee=B.FileIndex[te],Ee.size>=4096)if(ee.l=Ee.start+1<<9,Rn&&Buffer.isBuffer(Ee.content))Ee.content.copy(ee,ee.l,0,Ee.size),ee.l+=Ee.size+511&-512;else{for(ye=0;ye<Ee.size;++ye)ee.write_shift(1,Ee.content[ye]);for(;ye&511;++ye)ee.write_shift(1,0)}for(te=1;te<B.FileIndex.length;++te)if(Ee=B.FileIndex[te],Ee.size>0&&Ee.size<4096)if(Rn&&Buffer.isBuffer(Ee.content))Ee.content.copy(ee,ee.l,0,Ee.size),ee.l+=Ee.size+63&-64;else{for(ye=0;ye<Ee.size;++ye)ee.write_shift(1,Ee.content[ye]);for(;ye&63;++ye)ee.write_shift(1,0)}if(Rn)ee.l=ee.length;else for(;ee.l<ee.length;)ee.write_shift(1,0);return ee}function O(B,Q){var K=B.FullPaths.map(function(ye){return ye.toUpperCase()}),Y=K.map(function(ye){var ve=ye.split("/");return ve[ve.length-(ye.slice(-1)=="/"?2:1)]}),ee=!1;Q.charCodeAt(0)===47?(ee=!0,Q=K[0].slice(0,-1)+Q):ee=Q.indexOf("/")!==-1;var te=Q.toUpperCase(),_e=ee===!0?K.indexOf(te):Y.indexOf(te);if(_e!==-1)return B.FileIndex[_e];var ke=!te.match(p_);for(te=te.replace(Vm,""),ke&&(te=te.replace(p_,"!")),_e=0;_e<K.length;++_e)if((ke?K[_e].replace(p_,"!"):K[_e]).replace(Vm,"")==te||(ke?Y[_e].replace(p_,"!"):Y[_e]).replace(Vm,"")==te)return B.FileIndex[_e];return null}var U=64,j=-2,Te="d0cf11e0a1b11ae1",Ce=[208,207,17,224,161,177,26,225],Ue="00000000000000000000000000000000",Ne={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:j,FREESECT:-1,HEADER_SIGNATURE:Te,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ue,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function le(B,Q,K){u();var Y=L(B,K);l.writeFileSync(Q,Y)}function ue(B){for(var Q=new Array(B.length),K=0;K<B.length;++K)Q[K]=String.fromCharCode(B[K]);return Q.join("")}function Se(B,Q){var K=L(B,Q);switch(Q&&Q.type||"buffer"){case"file":return u(),l.writeFileSync(Q.filename,K),K;case"binary":return typeof K=="string"?K:ue(K);case"base64":return Np(typeof K=="string"?K:ue(K));case"buffer":if(Rn)return Buffer.isBuffer(K)?K:ec(K);case"array":return typeof K=="string"?Za(K):K}return K}var se;function V(B){try{var Q=B.InflateRaw,K=new Q;if(K._processChunk(new Uint8Array([3,0]),K._finishFlushFlag),K.bytesRead)se=B;else throw new Error("zlib does not expose bytesRead")}catch(Y){console.error("cannot use native zlib: "+(Y.message||Y))}}function J(B,Q){if(!se)return Pt(B,Q);var K=se.InflateRaw,Y=new K,ee=Y._processChunk(B.slice(B.l),Y._finishFlushFlag);return B.l+=Y.bytesRead,ee}function re(B){return se?se.deflateRawSync(B):Gr(B)}var q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],he=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Me=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function je(B){var Q=(B<<1|B<<11)&139536|(B<<5|B<<15)&558144;return(Q>>16|Q>>8|Q)&255}for(var De=typeof Uint8Array<"u",Be=De?new Uint8Array(256):[],Gt=0;Gt<256;++Gt)Be[Gt]=je(Gt);function Kt(B,Q){var K=Be[B&255];return Q<=8?K>>>8-Q:(K=K<<8|Be[B>>8&255],Q<=16?K>>>16-Q:(K=K<<8|Be[B>>16&255],K>>>24-Q))}function wn(B,Q){var K=Q&7,Y=Q>>>3;return(B[Y]|(K<=6?0:B[Y+1]<<8))>>>K&3}function Bt(B,Q){var K=Q&7,Y=Q>>>3;return(B[Y]|(K<=5?0:B[Y+1]<<8))>>>K&7}function Fn(B,Q){var K=Q&7,Y=Q>>>3;return(B[Y]|(K<=4?0:B[Y+1]<<8))>>>K&15}function Qt(B,Q){var K=Q&7,Y=Q>>>3;return(B[Y]|(K<=3?0:B[Y+1]<<8))>>>K&31}function ot(B,Q){var K=Q&7,Y=Q>>>3;return(B[Y]|(K<=1?0:B[Y+1]<<8))>>>K&127}function Zn(B,Q,K){var Y=Q&7,ee=Q>>>3,te=(1<<K)-1,_e=B[ee]>>>Y;return K<8-Y||(_e|=B[ee+1]<<8-Y,K<16-Y)||(_e|=B[ee+2]<<16-Y,K<24-Y)||(_e|=B[ee+3]<<24-Y),_e&te}function on(B,Q,K){var Y=Q&7,ee=Q>>>3;return Y<=5?B[ee]|=(K&7)<<Y:(B[ee]|=K<<Y&255,B[ee+1]=(K&7)>>8-Y),Q+3}function en(B,Q,K){var Y=Q&7,ee=Q>>>3;return K=(K&1)<<Y,B[ee]|=K,Q+1}function Qn(B,Q,K){var Y=Q&7,ee=Q>>>3;return K<<=Y,B[ee]|=K&255,K>>>=8,B[ee+1]=K,Q+8}function mt(B,Q,K){var Y=Q&7,ee=Q>>>3;return K<<=Y,B[ee]|=K&255,K>>>=8,B[ee+1]=K&255,B[ee+2]=K>>>8,Q+16}function jt(B,Q){var K=B.length,Y=2*K>Q?2*K:Q+5,ee=0;if(K>=Q)return B;if(Rn){var te=KL(Y);if(B.copy)B.copy(te);else for(;ee<B.length;++ee)te[ee]=B[ee];return te}else if(De){var _e=new Uint8Array(Y);if(_e.set)_e.set(B);else for(;ee<K;++ee)_e[ee]=B[ee];return _e}return B.length=Y,B}function Pn(B){for(var Q=new Array(B),K=0;K<B;++K)Q[K]=0;return Q}function _t(B,Q,K){var Y=1,ee=0,te=0,_e=0,ke=0,ye=B.length,ve=De?new Uint16Array(32):Pn(32);for(te=0;te<32;++te)ve[te]=0;for(te=ye;te<K;++te)B[te]=0;ye=B.length;var Ee=De?new Uint16Array(ye):Pn(ye);for(te=0;te<ye;++te)ve[ee=B[te]]++,Y<ee&&(Y=ee),Ee[te]=0;for(ve[0]=0,te=1;te<=Y;++te)ve[te+16]=ke=ke+ve[te-1]<<1;for(te=0;te<ye;++te)ke=B[te],ke!=0&&(Ee[te]=ve[ke+16]++);var Ke=0;for(te=0;te<ye;++te)if(Ke=B[te],Ke!=0)for(ke=Kt(Ee[te],Y)>>Y-Ke,_e=(1<<Y+4-Ke)-1;_e>=0;--_e)Q[ke|_e<<Ke]=Ke&15|te<<4;return Y}var Jt=De?new Uint16Array(512):Pn(512),Rt=De?new Uint16Array(32):Pn(32);if(!De){for(var rr=0;rr<512;++rr)Jt[rr]=0;for(rr=0;rr<32;++rr)Rt[rr]=0}(function(){for(var B=[],Q=0;Q<32;Q++)B.push(5);_t(B,Rt,32);var K=[];for(Q=0;Q<=143;Q++)K.push(8);for(;Q<=255;Q++)K.push(9);for(;Q<=279;Q++)K.push(7);for(;Q<=287;Q++)K.push(8);_t(K,Jt,288)})();var ai=(function(){for(var Q=De?new Uint8Array(32768):[],K=0,Y=0;K<Me.length-1;++K)for(;Y<Me[K+1];++Y)Q[Y]=K;for(;Y<32768;++Y)Q[Y]=29;var ee=De?new Uint8Array(259):[];for(K=0,Y=0;K<he.length-1;++K)for(;Y<he[K+1];++Y)ee[Y]=K;function te(ke,ye){for(var ve=0;ve<ke.length;){var Ee=Math.min(65535,ke.length-ve),Ke=ve+Ee==ke.length;for(ye.write_shift(1,+Ke),ye.write_shift(2,Ee),ye.write_shift(2,~Ee&65535);Ee-- >0;)ye[ye.l++]=ke[ve++]}return ye.l}function _e(ke,ye){for(var ve=0,Ee=0,Ke=De?new Uint16Array(32768):[];Ee<ke.length;){var tt=Math.min(65535,ke.length-Ee);if(tt<10){for(ve=on(ye,ve,+(Ee+tt==ke.length)),ve&7&&(ve+=8-(ve&7)),ye.l=ve/8|0,ye.write_shift(2,tt),ye.write_shift(2,~tt&65535);tt-- >0;)ye[ye.l++]=ke[Ee++];ve=ye.l*8;continue}ve=on(ye,ve,+(Ee+tt==ke.length)+2);for(var gt=0;tt-- >0;){var Ye=ke[Ee];gt=(gt<<5^Ye)&32767;var Xe=-1,zt=0;if((Xe=Ke[gt])&&(Xe|=Ee&-32768,Xe>Ee&&(Xe-=32768),Xe<Ee))for(;ke[Xe+zt]==ke[Ee+zt]&&zt<250;)++zt;if(zt>2){Ye=ee[zt],Ye<=22?ve=Qn(ye,ve,Be[Ye+1]>>1)-1:(Qn(ye,ve,3),ve+=5,Qn(ye,ve,Be[Ye-23]>>5),ve+=3);var Mn=Ye<8?0:Ye-4>>2;Mn>0&&(mt(ye,ve,zt-he[Ye]),ve+=Mn),Ye=Q[Ee-Xe],ve=Qn(ye,ve,Be[Ye]>>3),ve-=3;var jn=Ye<4?0:Ye-2>>1;jn>0&&(mt(ye,ve,Ee-Xe-Me[Ye]),ve+=jn);for(var dr=0;dr<zt;++dr)Ke[gt]=Ee&32767,gt=(gt<<5^ke[Ee])&32767,++Ee;tt-=zt-1}else Ye<=143?Ye=Ye+48:ve=en(ye,ve,1),ve=Qn(ye,ve,Be[Ye]),Ke[gt]=Ee&32767,++Ee}ve=Qn(ye,ve,0)-1}return ye.l=(ve+7)/8|0,ye.l}return function(ye,ve){return ye.length<8?te(ye,ve):_e(ye,ve)}})();function Gr(B){var Q=Re(50+Math.floor(B.length*1.1)),K=ai(B,Q);return Q.slice(0,K)}var Ut=De?new Uint16Array(32768):Pn(32768),es=De?new Uint16Array(32768):Pn(32768),Oe=De?new Uint16Array(128):Pn(128),we=1,pe=1;function kt(B,Q){var K=Qt(B,Q)+257;Q+=5;var Y=Qt(B,Q)+1;Q+=5;var ee=Fn(B,Q)+4;Q+=4;for(var te=0,_e=De?new Uint8Array(19):Pn(19),ke=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ye=1,ve=De?new Uint8Array(8):Pn(8),Ee=De?new Uint8Array(8):Pn(8),Ke=_e.length,tt=0;tt<ee;++tt)_e[q[tt]]=te=Bt(B,Q),ye<te&&(ye=te),ve[te]++,Q+=3;var gt=0;for(ve[0]=0,tt=1;tt<=ye;++tt)Ee[tt]=gt=gt+ve[tt-1]<<1;for(tt=0;tt<Ke;++tt)(gt=_e[tt])!=0&&(ke[tt]=Ee[gt]++);var Ye=0;for(tt=0;tt<Ke;++tt)if(Ye=_e[tt],Ye!=0){gt=Be[ke[tt]]>>8-Ye;for(var Xe=(1<<7-Ye)-1;Xe>=0;--Xe)Oe[gt|Xe<<Ye]=Ye&7|tt<<3}var zt=[];for(ye=1;zt.length<K+Y;)switch(gt=Oe[ot(B,Q)],Q+=gt&7,gt>>>=3){case 16:for(te=3+wn(B,Q),Q+=2,gt=zt[zt.length-1];te-- >0;)zt.push(gt);break;case 17:for(te=3+Bt(B,Q),Q+=3;te-- >0;)zt.push(0);break;case 18:for(te=11+ot(B,Q),Q+=7;te-- >0;)zt.push(0);break;default:zt.push(gt),ye<gt&&(ye=gt);break}var Mn=zt.slice(0,K),jn=zt.slice(K);for(tt=K;tt<286;++tt)Mn[tt]=0;for(tt=Y;tt<30;++tt)jn[tt]=0;return we=_t(Mn,Ut,286),pe=_t(jn,es,30),Q}function N(B,Q){if(B[0]==3&&!(B[1]&3))return[nd(Q),2];for(var K=0,Y=0,ee=KL(Q||1<<18),te=0,_e=ee.length>>>0,ke=0,ye=0;(Y&1)==0;){if(Y=Bt(B,K),K+=3,Y>>>1)Y>>1==1?(ke=9,ye=5):(K=kt(B,K),ke=we,ye=pe);else{K&7&&(K+=8-(K&7));var ve=B[K>>>3]|B[(K>>>3)+1]<<8;if(K+=32,ve>0)for(!Q&&_e<te+ve&&(ee=jt(ee,te+ve),_e=ee.length);ve-- >0;)ee[te++]=B[K>>>3],K+=8;continue}for(;;){!Q&&_e<te+32767&&(ee=jt(ee,te+32767),_e=ee.length);var Ee=Zn(B,K,ke),Ke=Y>>>1==1?Jt[Ee]:Ut[Ee];if(K+=Ke&15,Ke>>>=4,(Ke>>>8&255)===0)ee[te++]=Ke;else{if(Ke==256)break;Ke-=257;var tt=Ke<8?0:Ke-4>>2;tt>5&&(tt=0);var gt=te+he[Ke];tt>0&&(gt+=Zn(B,K,tt),K+=tt),Ee=Zn(B,K,ye),Ke=Y>>>1==1?Rt[Ee]:es[Ee],K+=Ke&15,Ke>>>=4;var Ye=Ke<4?0:Ke-2>>1,Xe=Me[Ke];for(Ye>0&&(Xe+=Zn(B,K,Ye),K+=Ye),!Q&&_e<gt&&(ee=jt(ee,gt+100),_e=ee.length);te<gt;)ee[te]=ee[te-Xe],++te}}}return Q?[ee,K+7>>>3]:[ee.slice(0,te),K+7>>>3]}function Pt(B,Q){var K=B.slice(B.l||0),Y=N(K,Q);return B.l+=Y[1],Y[0]}function W(B,Q){if(B)typeof console<"u"&&console.error(Q);else throw new Error(Q)}function Z(B,Q){var K=B;Ws(K,0);var Y=[],ee=[],te={FileIndex:Y,FullPaths:ee};P(te,{root:Q.root});for(var _e=K.length-4;(K[_e]!=80||K[_e+1]!=75||K[_e+2]!=5||K[_e+3]!=6)&&_e>=0;)--_e;K.l=_e+4,K.l+=4;var ke=K.read_shift(2);K.l+=6;var ye=K.read_shift(4);for(K.l=ye,_e=0;_e<ke;++_e){K.l+=20;var ve=K.read_shift(4),Ee=K.read_shift(4),Ke=K.read_shift(2),tt=K.read_shift(2),gt=K.read_shift(2);K.l+=8;var Ye=K.read_shift(4),Xe=o(K.slice(K.l+Ke,K.l+Ke+tt));K.l+=Ke+tt+gt;var zt=K.l;K.l=Ye+4,X(K,ve,Ee,te,Xe),K.l=zt}return te}function X(B,Q,K,Y,ee){B.l+=2;var te=B.read_shift(2),_e=B.read_shift(2),ke=a(B);if(te&8257)throw new Error("Unsupported ZIP encryption");for(var ye=B.read_shift(4),ve=B.read_shift(4),Ee=B.read_shift(4),Ke=B.read_shift(2),tt=B.read_shift(2),gt="",Ye=0;Ye<Ke;++Ye)gt+=String.fromCharCode(B[B.l++]);if(tt){var Xe=o(B.slice(B.l,B.l+tt));(Xe[21589]||{}).mt&&(ke=Xe[21589].mt),((ee||{})[21589]||{}).mt&&(ke=ee[21589].mt)}B.l+=tt;var zt=B.slice(B.l,B.l+ve);switch(_e){case 8:zt=J(B,Ee);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+_e)}var Mn=!1;te&8&&(ye=B.read_shift(4),ye==134695760&&(ye=B.read_shift(4),Mn=!0),ve=B.read_shift(4),Ee=B.read_shift(4)),ve!=Q&&W(Mn,"Bad compressed size: "+Q+" != "+ve),Ee!=K&&W(Mn,"Bad uncompressed size: "+K+" != "+Ee),cn(Y,gt,zt,{unsafe:!0,mt:ke})}function ce(B,Q){var K=Q||{},Y=[],ee=[],te=Re(1),_e=K.compression?8:0,ke=0,ye=0,ve=0,Ee=0,Ke=0,tt=B.FullPaths[0],gt=tt,Ye=B.FileIndex[0],Xe=[],zt=0;for(ye=1;ye<B.FullPaths.length;++ye)if(gt=B.FullPaths[ye].slice(tt.length),Ye=B.FileIndex[ye],!(!Ye.size||!Ye.content||gt=="Sh33tJ5")){var Mn=Ee,jn=Re(gt.length);for(ve=0;ve<gt.length;++ve)jn.write_shift(1,gt.charCodeAt(ve)&127);jn=jn.slice(0,jn.l),Xe[Ke]=Ome.buf(Ye.content,0);var dr=Ye.content;_e==8&&(dr=re(dr)),te=Re(30),te.write_shift(4,67324752),te.write_shift(2,20),te.write_shift(2,ke),te.write_shift(2,_e),Ye.mt?s(te,Ye.mt):te.write_shift(4,0),te.write_shift(-4,Xe[Ke]),te.write_shift(4,dr.length),te.write_shift(4,Ye.content.length),te.write_shift(2,jn.length),te.write_shift(2,0),Ee+=te.length,Y.push(te),Ee+=jn.length,Y.push(jn),Ee+=dr.length,Y.push(dr),te=Re(46),te.write_shift(4,33639248),te.write_shift(2,0),te.write_shift(2,20),te.write_shift(2,ke),te.write_shift(2,_e),te.write_shift(4,0),te.write_shift(-4,Xe[Ke]),te.write_shift(4,dr.length),te.write_shift(4,Ye.content.length),te.write_shift(2,jn.length),te.write_shift(2,0),te.write_shift(2,0),te.write_shift(2,0),te.write_shift(2,0),te.write_shift(4,0),te.write_shift(4,Mn),zt+=te.l,ee.push(te),zt+=jn.length,ee.push(jn),++Ke}return te=Re(22),te.write_shift(4,101010256),te.write_shift(2,0),te.write_shift(2,0),te.write_shift(2,Ke),te.write_shift(2,Ke),te.write_shift(4,zt),te.write_shift(4,Ee),te.write_shift(2,0),Ri([Ri(Y),Ri(ee),te])}var de={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ve(B,Q){if(B.ctype)return B.ctype;var K=B.name||"",Y=K.match(/\.([^\.]+)$/);return Y&&de[Y[1]]||Q&&(Y=(K=Q).match(/[\.\\]([^\.\\])+$/),Y&&de[Y[1]])?de[Y[1]]:"application/octet-stream"}function be(B){for(var Q=Np(B),K=[],Y=0;Y<Q.length;Y+=76)K.push(Q.slice(Y,Y+76));return K.join(`\r
`)+`\r
`}function $e(B){var Q=B.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ve){var Ee=ve.charCodeAt(0).toString(16).toUpperCase();return"="+(Ee.length==1?"0"+Ee:Ee)});Q=Q.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Q.charAt(0)==`
`&&(Q="=0D"+Q.slice(1)),Q=Q.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var K=[],Y=Q.split(`\r
`),ee=0;ee<Y.length;++ee){var te=Y[ee];if(te.length==0){K.push("");continue}for(var _e=0;_e<te.length;){var ke=76,ye=te.slice(_e,_e+ke);ye.charAt(ke-1)=="="?ke--:ye.charAt(ke-2)=="="?ke-=2:ye.charAt(ke-3)=="="&&(ke-=3),ye=te.slice(_e,_e+ke),_e+=ke,_e<te.length&&(ye+="="),K.push(ye)}}return K.join(`\r
`)}function et(B){for(var Q=[],K=0;K<B.length;++K){for(var Y=B[K];K<=B.length&&Y.charAt(Y.length-1)=="=";)Y=Y.slice(0,Y.length-1)+B[++K];Q.push(Y)}for(var ee=0;ee<Q.length;++ee)Q[ee]=Q[ee].replace(/[=][0-9A-Fa-f]{2}/g,function(te){return String.fromCharCode(parseInt(te.slice(1),16))});return Za(Q.join(`\r
`))}function ft(B,Q,K){for(var Y="",ee="",te="",_e,ke=0;ke<10;++ke){var ye=Q[ke];if(!ye||ye.match(/^\s*$/))break;var ve=ye.match(/^(.*?):\s*([^\s].*)$/);if(ve)switch(ve[1].toLowerCase()){case"content-location":Y=ve[2].trim();break;case"content-type":te=ve[2].trim();break;case"content-transfer-encoding":ee=ve[2].trim();break}}switch(++ke,ee.toLowerCase()){case"base64":_e=Za(Kl(Q.slice(ke).join("")));break;case"quoted-printable":_e=et(Q.slice(ke));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ee)}var Ee=cn(B,Y.slice(K.length),_e,{unsafe:!0});te&&(Ee.ctype=te)}function St(B,Q){if(ue(B.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var K=Q&&Q.root||"",Y=(Rn&&Buffer.isBuffer(B)?B.toString("binary"):ue(B)).split(`\r
`),ee=0,te="";for(ee=0;ee<Y.length;++ee)if(te=Y[ee],!!/^Content-Location:/i.test(te)&&(te=te.slice(te.indexOf("file")),K||(K=te.slice(0,te.lastIndexOf("/")+1)),te.slice(0,K.length)!=K))for(;K.length>0&&(K=K.slice(0,K.length-1),K=K.slice(0,K.lastIndexOf("/")+1),te.slice(0,K.length)!=K););var _e=(Y[1]||"").match(/boundary="(.*?)"/);if(!_e)throw new Error("MAD cannot find boundary");var ke="--"+(_e[1]||""),ye=[],ve=[],Ee={FileIndex:ye,FullPaths:ve};P(Ee);var Ke,tt=0;for(ee=0;ee<Y.length;++ee){var gt=Y[ee];gt!==ke&&gt!==ke+"--"||(tt++&&ft(Ee,Y.slice(Ke,ee),K),Ke=ee)}return Ee}function sn(B,Q){var K=Q||{},Y=K.boundary||"SheetJS";Y="------="+Y;for(var ee=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Y.slice(2)+'"',"","",""],te=B.FullPaths[0],_e=te,ke=B.FileIndex[0],ye=1;ye<B.FullPaths.length;++ye)if(_e=B.FullPaths[ye].slice(te.length),ke=B.FileIndex[ye],!(!ke.size||!ke.content||_e=="Sh33tJ5")){_e=_e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(zt){return"_x"+zt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(zt){return"_u"+zt.charCodeAt(0).toString(16)+"_"});for(var ve=ke.content,Ee=Rn&&Buffer.isBuffer(ve)?ve.toString("binary"):ue(ve),Ke=0,tt=Math.min(1024,Ee.length),gt=0,Ye=0;Ye<=tt;++Ye)(gt=Ee.charCodeAt(Ye))>=32&&gt<128&&++Ke;var Xe=Ke>=tt*4/5;ee.push(Y),ee.push("Content-Location: "+(K.root||"file:///C:/SheetJS/")+_e),ee.push("Content-Transfer-Encoding: "+(Xe?"quoted-printable":"base64")),ee.push("Content-Type: "+Ve(ke,_e)),ee.push(""),ee.push(Xe?$e(Ee):be(Ee))}return ee.push(Y+`--\r
`),ee.join(`\r
`)}function ur(B){var Q={};return P(Q,B),Q}function cn(B,Q,K,Y){var ee=Y&&Y.unsafe;ee||P(B);var te=!ee&&Xn.find(B,Q);if(!te){var _e=B.FullPaths[0];Q.slice(0,_e.length)==_e?_e=Q:(_e.slice(-1)!="/"&&(_e+="/"),_e=(_e+Q).replace("//","/")),te={name:i(Q),type:2},B.FileIndex.push(te),B.FullPaths.push(_e),ee||Xn.utils.cfb_gc(B)}return te.content=K,te.size=K?K.length:0,Y&&(Y.CLSID&&(te.clsid=Y.CLSID),Y.mt&&(te.mt=Y.mt),Y.ct&&(te.ct=Y.ct)),te}function hr(B,Q){P(B);var K=Xn.find(B,Q);if(K){for(var Y=0;Y<B.FileIndex.length;++Y)if(B.FileIndex[Y]==K)return B.FileIndex.splice(Y,1),B.FullPaths.splice(Y,1),!0}return!1}function yr(B,Q,K){P(B);var Y=Xn.find(B,Q);if(Y){for(var ee=0;ee<B.FileIndex.length;++ee)if(B.FileIndex[ee]==Y)return B.FileIndex[ee].name=i(K),B.FullPaths[ee]=K,!0}return!1}function Li(B){k(B,!0)}return e.find=O,e.read=z,e.parse=h,e.write=Se,e.writeFile=le,e.utils={cfb_new:ur,cfb_add:cn,cfb_del:hr,cfb_mov:yr,cfb_gc:Li,ReadShift:Bm,CheckField:mV,prep_blob:Ws,bconcat:Ri,use_zlib:V,_deflateRaw:Gr,_inflateRaw:Pt,consts:Ne},e})();function Dme(n){return typeof n=="string"?zw(n):Array.isArray(n)?lme(n):n}function P1(n,e,t){if(typeof Deno<"u"){if(t&&typeof e=="string")switch(t){case"utf8":e=new TextEncoder(t).encode(e);break;case"binary":e=zw(e);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(n,e)}var r=t=="utf8"?Op(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(r,n);if(typeof Blob<"u"){var i=new Blob([Dme(r)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,n);if(typeof saveAs<"u")return saveAs(i,n);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:n,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=n,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(n);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=k1(e)),o.write(e),o.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+n)}function Mi(n){for(var e=Object.keys(n),t=[],r=0;r<e.length;++r)Object.prototype.hasOwnProperty.call(n,e[r])&&t.push(e[r]);return t}function tO(n,e){for(var t=[],r=Mi(n),i=0;i!==r.length;++i)t[n[r[i]][e]]==null&&(t[n[r[i]][e]]=r[i]);return t}function XR(n){for(var e=[],t=Mi(n),r=0;r!==t.length;++r)e[n[t[r]]]=t[r];return e}function Hw(n){for(var e=[],t=Mi(n),r=0;r!==t.length;++r)e[n[t[r]]]=parseInt(t[r],10);return e}function Fme(n){for(var e=[],t=Mi(n),r=0;r!==t.length;++r)e[n[t[r]]]==null&&(e[n[t[r]]]=[]),e[n[t[r]]].push(t[r]);return e}var yv=new Date(1899,11,30,0,0,0);function Ms(n,e){var t=n.getTime(),r=yv.getTime()+(n.getTimezoneOffset()-yv.getTimezoneOffset())*6e4;return(t-r)/(1440*60*1e3)}var Q7=new Date,jme=yv.getTime()+(Q7.getTimezoneOffset()-yv.getTimezoneOffset())*6e4,nO=Q7.getTimezoneOffset();function J7(n){var e=new Date;return e.setTime(n*24*60*60*1e3+jme),e.getTimezoneOffset()!==nO&&e.setTime(e.getTime()+(e.getTimezoneOffset()-nO)*6e4),e}var rO=new Date("2017-02-19T19:06:09.000Z"),eV=isNaN(rO.getFullYear())?new Date("2/19/17"):rO,Vme=eV.getFullYear()==2017;function hs(n,e){var t=new Date(n);if(Vme)return e>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):e<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(n instanceof Date)return n;if(eV.getFullYear()==1917&&!isNaN(t.getFullYear())){var r=t.getFullYear();return n.indexOf(""+r)>-1||t.setFullYear(t.getFullYear()+100),t}var i=n.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return n.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Kw(n,e){if(Rn&&Buffer.isBuffer(n))return n.toString("binary");if(typeof TextDecoder<"u")try{var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(n)&&(n=new Uint8Array(n)),new TextDecoder("latin1").decode(n).replace(/[]/g,function(s){return t[s]||s})}catch{}for(var r=[],i=0;i!=n.length;++i)r.push(String.fromCharCode(n[i]));return r.join("")}function Ns(n){if(typeof JSON<"u"&&!Array.isArray(n))return JSON.parse(JSON.stringify(n));if(typeof n!="object"||n==null)return n;if(n instanceof Date)return new Date(n.getTime());var e={};for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=Ns(n[t]));return e}function Rr(n,e){for(var t="";t.length<e;)t+=n;return t}function Fl(n){var e=Number(n);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(n))return e;var t=1,r=n.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(e=Number(r))||(r=r.replace(/[(](.*)[)]/,function(i,s){return t=-t,s}),!isNaN(e=Number(r)))?e/t:e}var Gme=["january","february","march","april","may","june","july","august","september","october","november","december"];function Lp(n){var e=new Date(n),t=new Date(NaN),r=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return t;var a=n.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&Gme.indexOf(a)==-1)return t}else if(a.match(/[a-z]/))return t;return r<0||r>8099?t:(i>0||s>1)&&r!=101?e:n.match(/[^-0-9:,\/\\]/)?t:e}function nn(n,e,t){if(n.FullPaths){if(typeof t=="string"){var r;return Rn?r=ec(t):r=cme(t),Xn.utils.cfb_add(n,e,r)}Xn.utils.cfb_add(n,e,t)}else n.file(e,t)}function qR(){return Xn.utils.cfb_new()}var qr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Bme={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},ZR=XR(Bme),QR=/[&<>'"]/g,Ume=/[\u0000-\u0008\u000b-\u001f]/g;function Hn(n){var e=n+"";return e.replace(QR,function(t){return ZR[t]}).replace(Ume,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function iO(n){return Hn(n).replace(/ /g,"_x0020_")}var tV=/[\u0000-\u001f]/g;function zme(n){var e=n+"";return e.replace(QR,function(t){return ZR[t]}).replace(/\n/g,"<br/>").replace(tV,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function $me(n){var e=n+"";return e.replace(QR,function(t){return ZR[t]}).replace(tV,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}function Wme(n){return n.replace(/(\r\n|[\r\n])/g,"&#10;")}function Hme(n){switch(n){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function GS(n){for(var e="",t=0,r=0,i=0,s=0,a=0,o=0;t<n.length;){if(r=n.charCodeAt(t++),r<128){e+=String.fromCharCode(r);continue}if(i=n.charCodeAt(t++),r>191&&r<224){a=(r&31)<<6,a|=i&63,e+=String.fromCharCode(a);continue}if(s=n.charCodeAt(t++),r<240){e+=String.fromCharCode((r&15)<<12|(i&63)<<6|s&63);continue}a=n.charCodeAt(t++),o=((r&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function sO(n){var e=nd(2*n.length),t,r,i=1,s=0,a=0,o;for(r=0;r<n.length;r+=i)i=1,(o=n.charCodeAt(r))<128?t=o:o<224?(t=(o&31)*64+(n.charCodeAt(r+1)&63),i=2):o<240?(t=(o&15)*4096+(n.charCodeAt(r+1)&63)*64+(n.charCodeAt(r+2)&63),i=3):(i=4,t=(o&7)*262144+(n.charCodeAt(r+1)&63)*4096+(n.charCodeAt(r+2)&63)*64+(n.charCodeAt(r+3)&63),t-=65536,a=55296+(t>>>10&1023),t=56320+(t&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=t%256,e[s++]=t>>>8;return e.slice(0,s).toString("ucs2")}function aO(n){return ec(n,"binary").toString("utf8")}var __="foo bar baz",Gm=Rn&&(aO(__)==GS(__)&&aO||sO(__)==GS(__)&&sO)||GS,Op=Rn?function(n){return ec(n,"utf8").toString("binary")}:function(n){for(var e=[],t=0,r=0,i=0;t<n.length;)switch(r=n.charCodeAt(t++),!0){case r<128:e.push(String.fromCharCode(r));break;case r<2048:e.push(String.fromCharCode(192+(r>>6))),e.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,i=n.charCodeAt(t++)-56320+(r<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(r>>12))),e.push(String.fromCharCode(128+(r>>6&63))),e.push(String.fromCharCode(128+(r&63)))}return e.join("")},Kme=(function(){var n=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var r=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<n.length;++i)r=r.replace(n[i][0],n[i][1]);return r}})(),nV=/(^\s|\s$|\n)/;function Ci(n,e){return"<"+n+(e.match(nV)?' xml:space="preserve"':"")+">"+e+"</"+n+">"}function Dp(n){return Mi(n).map(function(e){return" "+e+'="'+n[e]+'"'}).join("")}function nt(n,e,t){return"<"+n+(t!=null?Dp(t):"")+(e!=null?(e.match(nV)?' xml:space="preserve"':"")+">"+e+"</"+n:"/")+">"}function zb(n,e){try{return n.toISOString().replace(/\.\d*/,"")}catch(t){if(e)throw t}return""}function Yme(n,e){switch(typeof n){case"string":var t=nt("vt:lpwstr",Hn(n));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return nt((n|0)==n?"vt:i4":"vt:r8",Hn(String(n)));case"boolean":return nt("vt:bool",n?"true":"false")}if(n instanceof Date)return nt("vt:filetime",zb(n));throw new Error("Unable to serialize "+n)}var gi={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Y0=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Ys={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Xme(n,e){for(var t=1-2*(n[e+7]>>>7),r=((n[e+7]&127)<<4)+(n[e+6]>>>4&15),i=n[e+6]&15,s=5;s>=0;--s)i=i*256+n[e+s];return r==2047?i==0?t*(1/0):NaN:(r==0?r=-1022:(r-=1023,i+=Math.pow(2,52)),t*Math.pow(2,r-52)*i)}function qme(n,e,t){var r=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,a=r?-e:e;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)n[t+o]=s&255;n[t+6]=(i&15)<<4|s&15,n[t+7]=i>>4|r}var oO=function(n){for(var e=[],t=10240,r=0;r<n[0].length;++r)if(n[0][r])for(var i=0,s=n[0][r].length;i<s;i+=t)e.push.apply(e,n[0][r].slice(i,i+t));return e},lO=Rn?function(n){return n[0].length>0&&Buffer.isBuffer(n[0][0])?Buffer.concat(n[0].map(function(e){return Buffer.isBuffer(e)?e:ec(e)})):oO(n)}:oO,cO=function(n,e,t){for(var r=[],i=e;i<t;i+=2)r.push(String.fromCharCode(fm(n,i)));return r.join("").replace(Vm,"")},JR=Rn?function(n,e,t){return Buffer.isBuffer(n)?n.toString("utf16le",e,t).replace(Vm,""):cO(n,e,t)}:cO,uO=function(n,e,t){for(var r=[],i=e;i<e+t;++i)r.push(("0"+n[i].toString(16)).slice(-2));return r.join("")},rV=Rn?function(n,e,t){return Buffer.isBuffer(n)?n.toString("hex",e,e+t):uO(n,e,t)}:uO,hO=function(n,e,t){for(var r=[],i=e;i<t;i++)r.push(String.fromCharCode(Pf(n,i)));return r.join("")},M1=Rn?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf8",t,r):hO(e,t,r)}:hO,iV=function(n,e){var t=Xs(n,e);return t>0?M1(n,e+4,e+4+t-1):""},sV=iV,aV=function(n,e){var t=Xs(n,e);return t>0?M1(n,e+4,e+4+t-1):""},oV=aV,lV=function(n,e){var t=2*Xs(n,e);return t>0?M1(n,e+4,e+4+t-1):""},cV=lV,uV=function(e,t){var r=Xs(e,t);return r>0?JR(e,t+4,t+4+r):""},hV=uV,dV=function(n,e){var t=Xs(n,e);return t>0?M1(n,e+4,e+4+t):""},fV=dV,gV=function(n,e){return Xme(n,e)},_v=gV,eC=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Rn&&(sV=function(e,t){if(!Buffer.isBuffer(e))return iV(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},oV=function(e,t){if(!Buffer.isBuffer(e))return aV(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},cV=function(e,t){if(!Buffer.isBuffer(e))return lV(e,t);var r=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r-1)},hV=function(e,t){if(!Buffer.isBuffer(e))return uV(e,t);var r=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r)},fV=function(e,t){if(!Buffer.isBuffer(e))return dV(e,t);var r=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+r)},_v=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):gV(e,t)},eC=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Pf=function(n,e){return n[e]},fm=function(n,e){return n[e+1]*256+n[e]},Zme=function(n,e){var t=n[e+1]*256+n[e];return t<32768?t:(65535-t+1)*-1},Xs=function(n,e){return n[e+3]*(1<<24)+(n[e+2]<<16)+(n[e+1]<<8)+n[e]},ph=function(n,e){return n[e+3]<<24|n[e+2]<<16|n[e+1]<<8|n[e]},Qme=function(n,e){return n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3]};function Bm(n,e){var t="",r,i,s=[],a,o,l,u;switch(e){case"dbcs":if(u=this.l,Rn&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*n).toString("utf16le");else for(l=0;l<n;++l)t+=String.fromCharCode(fm(this,u)),u+=2;n*=2;break;case"utf8":t=M1(this,this.l,this.l+n);break;case"utf16le":n*=2,t=JR(this,this.l,this.l+n);break;case"wstr":return Bm.call(this,n,"dbcs");case"lpstr-ansi":t=sV(this,this.l),n=4+Xs(this,this.l);break;case"lpstr-cp":t=oV(this,this.l),n=4+Xs(this,this.l);break;case"lpwstr":t=cV(this,this.l),n=4+2*Xs(this,this.l);break;case"lpp4":n=4+Xs(this,this.l),t=hV(this,this.l),n&2&&(n+=2);break;case"8lpp4":n=4+Xs(this,this.l),t=fV(this,this.l),n&3&&(n+=4-(n&3));break;case"cstr":for(n=0,t="";(a=Pf(this,this.l+n++))!==0;)s.push(m_(a));t=s.join("");break;case"_wstr":for(n=0,t="";(a=fm(this,this.l+n))!==0;)s.push(m_(a)),n+=2;n+=2,t=s.join("");break;case"dbcs-cont":for(t="",u=this.l,l=0;l<n;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return a=Pf(this,u),this.l=u+1,o=Bm.call(this,n-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(m_(fm(this,u))),u+=2}t=s.join(""),n*=2;break;case"cpstr":case"sbcs-cont":for(t="",u=this.l,l=0;l!=n;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return a=Pf(this,u),this.l=u+1,o=Bm.call(this,n-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(m_(Pf(this,u))),u+=1}t=s.join("");break;default:switch(n){case 1:return r=Pf(this,this.l),this.l++,r;case 2:return r=(e==="i"?Zme:fm)(this,this.l),this.l+=2,r;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(r=(n>0?ph:Qme)(this,this.l),this.l+=4,r):(i=Xs(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return n==8?i=_v(this,this.l):i=_v([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;n=8;case 16:t=rV(this,this.l,n);break}}return this.l+=n,t}var Jme=function(n,e,t){n[t]=e&255,n[t+1]=e>>>8&255,n[t+2]=e>>>16&255,n[t+3]=e>>>24&255},epe=function(n,e,t){n[t]=e&255,n[t+1]=e>>8&255,n[t+2]=e>>16&255,n[t+3]=e>>24&255},tpe=function(n,e,t){n[t]=e&255,n[t+1]=e>>>8&255};function npe(n,e,t){var r=0,i=0;if(t==="dbcs"){for(i=0;i!=e.length;++i)tpe(this,e.charCodeAt(i),this.l+2*i);r=2*e.length}else if(t==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;r=e.length}else if(t==="hex"){for(;i<n;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(t==="utf16le"){var s=Math.min(this.l+n,this.length);for(i=0;i<Math.min(e.length,n);++i){var a=e.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(n){case 1:r=1,this[this.l]=e&255;break;case 2:r=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:r=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:r=4,Jme(this,e,this.l);break;case 8:if(r=8,t==="f"){qme(this,e,this.l);break}case 16:break;case-4:r=4,epe(this,e,this.l);break}return this.l+=r,this}function mV(n,e){var t=rV(this,this.l,n.length>>1);if(t!==n)throw new Error(e+"Expected "+n+" saw "+t);this.l+=n.length>>1}function Ws(n,e){n.l=e,n.read_shift=Bm,n.chk=mV,n.write_shift=npe}function el(n,e){n.l+=e}function Re(n){var e=nd(n);return Ws(e,0),e}function ks(){var n=[],e=Rn?256:2048,t=function(u){var h=Re(u);return Ws(h,0),h},r=t(e),i=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&n.push(r),r=null)},s=function(u){return r&&u<r.length-r.l?r:(i(),r=t(Math.max(u+1,e)))},a=function(){return i(),Ri(n)},o=function(u){i(),r=u,r.l==null&&(r.l=r.length),s(e)};return{next:s,push:o,end:a,_bufs:n}}function Ge(n,e,t,r){var i=+e,s;if(!isNaN(i)){r||(r=Xve[i].p||(t||[]).length||0),s=1+(i>=128?1:0)+1,r>=128&&++s,r>=16384&&++s,r>=2097152&&++s;var a=n.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(r>=128)a.write_shift(1,(r&127)+128),r>>=7;else{a.write_shift(1,r);break}r>0&&eC(t)&&n.push(t)}}function Um(n,e,t){var r=Ns(n);if(e.s?(r.cRel&&(r.c+=e.s.c),r.rRel&&(r.r+=e.s.r)):(r.cRel&&(r.c+=e.c),r.rRel&&(r.r+=e.r)),!t||t.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function dO(n,e,t){var r=Ns(n);return r.s=Um(r.s,e.s,t),r.e=Um(r.e,e.s,t),r}function zm(n,e){if(n.cRel&&n.c<0)for(n=Ns(n);n.c<0;)n.c+=e>8?16384:256;if(n.rRel&&n.r<0)for(n=Ns(n);n.r<0;)n.r+=e>8?1048576:e>5?65536:16384;var t=Yn(n);return!n.cRel&&n.cRel!=null&&(t=spe(t)),!n.rRel&&n.rRel!=null&&(t=rpe(t)),t}function BS(n,e){return n.s.r==0&&!n.s.rRel&&n.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!n.e.rRel?(n.s.cRel?"":"$")+Zi(n.s.c)+":"+(n.e.cRel?"":"$")+Zi(n.e.c):n.s.c==0&&!n.s.cRel&&n.e.c==(e.biff>=12?16383:255)&&!n.e.cRel?(n.s.rRel?"":"$")+Pi(n.s.r)+":"+(n.e.rRel?"":"$")+Pi(n.e.r):zm(n.s,e.biff)+":"+zm(n.e,e.biff)}function tC(n){return parseInt(ipe(n),10)-1}function Pi(n){return""+(n+1)}function rpe(n){return n.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function ipe(n){return n.replace(/\$(\d+)$/,"$1")}function nC(n){for(var e=ape(n),t=0,r=0;r!==e.length;++r)t=26*t+e.charCodeAt(r)-64;return t-1}function Zi(n){if(n<0)throw new Error("invalid column "+n);var e="";for(++n;n;n=Math.floor((n-1)/26))e=String.fromCharCode((n-1)%26+65)+e;return e}function spe(n){return n.replace(/^([A-Z])/,"$$$1")}function ape(n){return n.replace(/^\$([A-Z])/,"$1")}function ope(n){return n.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function mi(n){for(var e=0,t=0,r=0;r<n.length;++r){var i=n.charCodeAt(r);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(t=26*t+(i-64))}return{c:t-1,r:e-1}}function Yn(n){for(var e=n.c+1,t="";e;e=(e-1)/26|0)t=String.fromCharCode((e-1)%26+65)+t;return t+(n.r+1)}function ia(n){var e=n.indexOf(":");return e==-1?{s:mi(n),e:mi(n)}:{s:mi(n.slice(0,e)),e:mi(n.slice(e+1))}}function Yr(n,e){return typeof e>"u"||typeof e=="number"?Yr(n.s,n.e):(typeof n!="string"&&(n=Yn(n)),typeof e!="string"&&(e=Yn(e)),n==e?n:n+":"+e)}function cr(n){var e={s:{c:0,r:0},e:{c:0,r:0}},t=0,r=0,i=0,s=n.length;for(t=0;r<s&&!((i=n.charCodeAt(r)-64)<1||i>26);++r)t=26*t+i;for(e.s.c=--t,t=0;r<s&&!((i=n.charCodeAt(r)-48)<0||i>9);++r)t=10*t+i;if(e.s.r=--t,r===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++r,t=0;r!=s&&!((i=n.charCodeAt(r)-64)<1||i>26);++r)t=26*t+i;for(e.e.c=--t,t=0;r!=s&&!((i=n.charCodeAt(r)-48)<0||i>9);++r)t=10*t+i;return e.e.r=--t,e}function fO(n,e){var t=n.t=="d"&&e instanceof Date;if(n.z!=null)try{return n.w=vu(n.z,t?Ms(e):e)}catch{}try{return n.w=vu((n.XF||{}).numFmtId||(t?14:0),t?Ms(e):e)}catch{return""+e}}function Yl(n,e,t){return n==null||n.t==null||n.t=="z"?"":n.w!==void 0?n.w:(n.t=="d"&&!n.z&&t&&t.dateNF&&(n.z=t.dateNF),n.t=="e"?N1[n.v]||n.v:e==null?fO(n,n.v):fO(n,e))}function vd(n,e){var t=e&&e.sheet?e.sheet:"Sheet1",r={};return r[t]=n,{SheetNames:[t],Sheets:r}}function pV(n,e,t){var r=t||{},i=n?Array.isArray(n):r.dense,s=n||(i?[]:{}),a=0,o=0;if(s&&r.origin!=null){if(typeof r.origin=="number")a=r.origin;else{var l=typeof r.origin=="string"?mi(r.origin):r.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var h=cr(s["!ref"]);u.s.c=h.s.c,u.s.r=h.s.r,u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),a==-1&&(u.e.r=a=h.e.r+1)}for(var f=0;f!=e.length;++f)if(e[f]){if(!Array.isArray(e[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var g=0;g!=e[f].length;++g)if(!(typeof e[f][g]>"u")){var y={v:e[f][g]},v=a+f,x=o+g;if(u.s.r>v&&(u.s.r=v),u.s.c>x&&(u.s.c=x),u.e.r<v&&(u.e.r=v),u.e.c<x&&(u.e.c=x),e[f][g]&&typeof e[f][g]=="object"&&!Array.isArray(e[f][g])&&!(e[f][g]instanceof Date))y=e[f][g];else if(Array.isArray(y.v)&&(y.f=e[f][g][1],y.v=y.v[0]),y.v===null)if(y.f)y.t="n";else if(r.nullError)y.t="e",y.v=0;else if(r.sheetStubs)y.t="z";else continue;else typeof y.v=="number"?y.t="n":typeof y.v=="boolean"?y.t="b":y.v instanceof Date?(y.z=r.dateNF||Pr[14],r.cellDates?(y.t="d",y.w=vu(y.z,Ms(y.v))):(y.t="n",y.v=Ms(y.v),y.w=vu(y.z,y.v))):y.t="s";if(i)s[v]||(s[v]=[]),s[v][x]&&s[v][x].z&&(y.z=s[v][x].z),s[v][x]=y;else{var E=Yn({c:x,r:v});s[E]&&s[E].z&&(y.z=s[E].z),s[E]=y}}}return u.s.c<1e7&&(s["!ref"]=Yr(u)),s}function X0(n,e){return pV(null,n,e)}function lpe(n){return n.read_shift(4,"i")}function ao(n,e){return e||(e=Re(4)),e.write_shift(4,n),e}function Qi(n){var e=n.read_shift(4);return e===0?"":n.read_shift(e,"dbcs")}function pi(n,e){var t=!1;return e==null&&(t=!0,e=Re(4+2*n.length)),e.write_shift(4,n.length),n.length>0&&e.write_shift(0,n,"dbcs"),t?e.slice(0,e.l):e}function cpe(n){return{ich:n.read_shift(2),ifnt:n.read_shift(2)}}function upe(n,e){return e||(e=Re(4)),e.write_shift(2,0),e.write_shift(2,0),e}function rC(n,e){var t=n.l,r=n.read_shift(1),i=Qi(n),s=[],a={t:i,h:i};if((r&1)!==0){for(var o=n.read_shift(4),l=0;l!=o;++l)s.push(cpe(n));a.r=s}else a.r=[{ich:0,ifnt:0}];return n.l=t+e,a}function hpe(n,e){var t=!1;return e==null&&(t=!0,e=Re(15+4*n.t.length)),e.write_shift(1,0),pi(n.t,e),t?e.slice(0,e.l):e}var dpe=rC;function fpe(n,e){var t=!1;return e==null&&(t=!0,e=Re(23+4*n.t.length)),e.write_shift(1,1),pi(n.t,e),e.write_shift(4,1),upe({},e),t?e.slice(0,e.l):e}function Ma(n){var e=n.read_shift(4),t=n.read_shift(2);return t+=n.read_shift(1)<<16,n.l++,{c:e,iStyleRef:t}}function wd(n,e){return e==null&&(e=Re(8)),e.write_shift(-4,n.c),e.write_shift(3,n.iStyleRef||n.s),e.write_shift(1,0),e}function Ed(n){var e=n.read_shift(2);return e+=n.read_shift(1)<<16,n.l++,{c:-1,iStyleRef:e}}function Sd(n,e){return e==null&&(e=Re(4)),e.write_shift(3,n.iStyleRef||n.s),e.write_shift(1,0),e}var gpe=Qi,yV=pi;function iC(n){var e=n.read_shift(4);return e===0||e===4294967295?"":n.read_shift(e,"dbcs")}function xv(n,e){var t=!1;return e==null&&(t=!0,e=Re(127)),e.write_shift(4,n.length>0?n.length:4294967295),n.length>0&&e.write_shift(0,n,"dbcs"),t?e.slice(0,e.l):e}var mpe=Qi,$b=iC,sC=xv;function _V(n){var e=n.slice(n.l,n.l+4),t=e[0]&1,r=e[0]&2;n.l+=4;var i=r===0?_v([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):ph(e,0)>>2;return t?i/100:i}function xV(n,e){e==null&&(e=Re(4));var t=0,r=0,i=n*100;if(n==(n|0)&&n>=-536870912&&n<1<<29?r=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(r=1,t=1),r)e.write_shift(-4,((t?i:n)<<2)+(t+2));else throw new Error("unsupported RkNumber "+n)}function vV(n){var e={s:{},e:{}};return e.s.r=n.read_shift(4),e.e.r=n.read_shift(4),e.s.c=n.read_shift(4),e.e.c=n.read_shift(4),e}function ppe(n,e){return e||(e=Re(16)),e.write_shift(4,n.s.r),e.write_shift(4,n.e.r),e.write_shift(4,n.s.c),e.write_shift(4,n.e.c),e}var Td=vV,q0=ppe;function Z0(n){if(n.length-n.l<8)throw"XLS Xnum Buffer underflow";return n.read_shift(8,"f")}function rd(n,e){return(e||Re(8)).write_shift(8,n,"f")}function ype(n){var e={},t=n.read_shift(1),r=t>>>1,i=n.read_shift(1),s=n.read_shift(2,"i"),a=n.read_shift(1),o=n.read_shift(1),l=n.read_shift(1);switch(n.l++,r){case 0:e.auto=1;break;case 1:e.index=i;var u=Ipe[i];u&&(e.rgb=TO(u));break;case 2:e.rgb=TO([a,o,l]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function vv(n,e){if(e||(e=Re(8)),!n||n.auto)return e.write_shift(4,0),e.write_shift(4,0),e;n.index!=null?(e.write_shift(1,2),e.write_shift(1,n.index)):n.theme!=null?(e.write_shift(1,6),e.write_shift(1,n.theme)):(e.write_shift(1,5),e.write_shift(1,0));var t=n.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),e.write_shift(2,t),!n.rgb||n.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var r=n.rgb||"FFFFFF";typeof r=="number"&&(r=("000000"+r.toString(16)).slice(-6)),e.write_shift(1,parseInt(r.slice(0,2),16)),e.write_shift(1,parseInt(r.slice(2,4),16)),e.write_shift(1,parseInt(r.slice(4,6),16)),e.write_shift(1,255)}return e}function _pe(n){var e=n.read_shift(1);n.l++;var t={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return t}function xpe(n,e){e||(e=Re(2));var t=(n.italic?2:0)|(n.strike?8:0)|(n.outline?16:0)|(n.shadow?32:0)|(n.condense?64:0)|(n.extend?128:0);return e.write_shift(1,t),e.write_shift(1,0),e}var wV=2,zs=3,x_=11,wv=19,v_=64,vpe=65,wpe=71,Epe=4108,Spe=4126,bi=80,gO={1:{n:"CodePage",t:wV},2:{n:"Category",t:bi},3:{n:"PresentationFormat",t:bi},4:{n:"ByteCount",t:zs},5:{n:"LineCount",t:zs},6:{n:"ParagraphCount",t:zs},7:{n:"SlideCount",t:zs},8:{n:"NoteCount",t:zs},9:{n:"HiddenCount",t:zs},10:{n:"MultimediaClipCount",t:zs},11:{n:"ScaleCrop",t:x_},12:{n:"HeadingPairs",t:Epe},13:{n:"TitlesOfParts",t:Spe},14:{n:"Manager",t:bi},15:{n:"Company",t:bi},16:{n:"LinksUpToDate",t:x_},17:{n:"CharacterCount",t:zs},19:{n:"SharedDoc",t:x_},22:{n:"HyperlinksChanged",t:x_},23:{n:"AppVersion",t:zs,p:"version"},24:{n:"DigSig",t:vpe},26:{n:"ContentType",t:bi},27:{n:"ContentStatus",t:bi},28:{n:"Language",t:bi},29:{n:"Version",t:bi},255:{},2147483648:{n:"Locale",t:wv},2147483651:{n:"Behavior",t:wv},1919054434:{}},mO={1:{n:"CodePage",t:wV},2:{n:"Title",t:bi},3:{n:"Subject",t:bi},4:{n:"Author",t:bi},5:{n:"Keywords",t:bi},6:{n:"Comments",t:bi},7:{n:"Template",t:bi},8:{n:"LastAuthor",t:bi},9:{n:"RevNumber",t:bi},10:{n:"EditTime",t:v_},11:{n:"LastPrinted",t:v_},12:{n:"CreatedDate",t:v_},13:{n:"ModifiedDate",t:v_},14:{n:"PageCount",t:zs},15:{n:"WordCount",t:zs},16:{n:"CharCount",t:zs},17:{n:"Thumbnail",t:wpe},18:{n:"Application",t:bi},19:{n:"DocSecurity",t:zs},255:{},2147483648:{n:"Locale",t:wv},2147483651:{n:"Behavior",t:wv},1919054434:{}};function Tpe(n){return n.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var bpe=Tpe([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ipe=Ns(bpe),N1={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Ape={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},w_={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function EV(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function SV(n,e){var t=Fme(Ape),r=[],i;r[r.length]=qr,r[r.length]=nt("Types",null,{xmlns:gi.CT,"xmlns:xsd":gi.xsd,"xmlns:xsi":gi.xsi}),r=r.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return nt("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){n[l]&&n[l].length>0&&(i=n[l][0],r[r.length]=nt("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:w_[l][e.bookType]||w_[l].xlsx}))},a=function(l){(n[l]||[]).forEach(function(u){r[r.length]=nt("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:w_[l][e.bookType]||w_[l].xlsx})})},o=function(l){(n[l]||[]).forEach(function(u){r[r.length]=nt("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:t[l][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),r.length>2&&(r[r.length]="</Types>",r[1]=r[1].replace("/>",">")),r.join("")}var Sn={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function TV(n){var e=n.lastIndexOf("/");return n.slice(0,e+1)+"_rels/"+n.slice(e+1)+".rels"}function i0(n){var e=[qr,nt("Relationships",null,{xmlns:gi.RELS})];return Mi(n["!id"]).forEach(function(t){e[e.length]=nt("Relationship",null,n["!id"][t])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Un(n,e,t,r,i,s){if(i||(i={}),n["!id"]||(n["!id"]={}),n["!idx"]||(n["!idx"]=1),e<0)for(e=n["!idx"];n["!id"]["rId"+e];++e);if(n["!idx"]=e+1,i.Id="rId"+e,i.Type=r,i.Target=t,[Sn.HLINK,Sn.XPATH,Sn.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),n["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return n["!id"][i.Id]=i,n[("/"+i.Target).replace("//","/")]=i,e}function Rpe(n){var e=[qr];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<n.length;++t)e.push('  <manifest:file-entry manifest:full-path="'+n[t][0]+'" manifest:media-type="'+n[t][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function pO(n,e,t){return['  <rdf:Description rdf:about="'+n+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function Cpe(n,e){return['  <rdf:Description rdf:about="'+n+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function kpe(n){var e=[qr];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=n.length;++t)e.push(pO(n[t][0],n[t][1])),e.push(Cpe("",n[t][0]));return e.push(pO("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function bV(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+dv.version+"</meta:generator></office:meta></office:document-meta>"}var Nh=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function US(n,e,t,r,i){i[n]!=null||e==null||e===""||(i[n]=e,e=Hn(e),r[r.length]=t?nt(n,e,t):Ci(n,e))}function IV(n,e){var t=e||{},r=[qr,nt("cp:coreProperties",null,{"xmlns:cp":gi.CORE_PROPS,"xmlns:dc":gi.dc,"xmlns:dcterms":gi.dcterms,"xmlns:dcmitype":gi.dcmitype,"xmlns:xsi":gi.xsi})],i={};if(!n&&!t.Props)return r.join("");n&&(n.CreatedDate!=null&&US("dcterms:created",typeof n.CreatedDate=="string"?n.CreatedDate:zb(n.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i),n.ModifiedDate!=null&&US("dcterms:modified",typeof n.ModifiedDate=="string"?n.ModifiedDate:zb(n.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i));for(var s=0;s!=Nh.length;++s){var a=Nh[s],o=t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:n?n[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&US(a[0],o,null,r,i)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var s0=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],AV=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function RV(n){var e=[],t=nt;return n||(n={}),n.Application="SheetJS",e[e.length]=qr,e[e.length]=nt("Properties",null,{xmlns:gi.EXT_PROPS,"xmlns:vt":gi.vt}),s0.forEach(function(r){if(n[r[1]]!==void 0){var i;switch(r[2]){case"string":i=Hn(String(n[r[1]]));break;case"bool":i=n[r[1]]?"true":"false";break}i!==void 0&&(e[e.length]=t(r[0],i))}}),e[e.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(n.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=t("TitlesOfParts",t("vt:vector",n.SheetNames.map(function(r){return"<vt:lpstr>"+Hn(r)+"</vt:lpstr>"}).join(""),{size:n.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}function CV(n){var e=[qr,nt("Properties",null,{xmlns:gi.CUST_PROPS,"xmlns:vt":gi.vt})];if(!n)return e.join("");var t=1;return Mi(n).forEach(function(i){++t,e[e.length]=nt("property",Yme(n[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:Hn(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var yO={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function Ppe(n,e){var t=[];return Mi(yO).map(function(r){for(var i=0;i<Nh.length;++i)if(Nh[i][1]==r)return Nh[i];for(i=0;i<s0.length;++i)if(s0[i][1]==r)return s0[i];throw r}).forEach(function(r){if(n[r[1]]!=null){var i=e&&e.Props&&e.Props[r[1]]!=null?e.Props[r[1]]:n[r[1]];switch(r[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),t.push(Ci(yO[r[1]]||r[1],i))}}),nt("DocumentProperties",t.join(""),{xmlns:Ys.o})}function Mpe(n,e){var t=["Worksheets","SheetNames"],r="CustomDocumentProperties",i=[];return n&&Mi(n).forEach(function(s){if(Object.prototype.hasOwnProperty.call(n,s)){for(var a=0;a<Nh.length;++a)if(s==Nh[a][1])return;for(a=0;a<s0.length;++a)if(s==s0[a][1])return;for(a=0;a<t.length;++a)if(s==t[a])return;var o=n[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push(nt(iO(s),o,{"dt:dt":l}))}}),e&&Mi(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(n&&Object.prototype.hasOwnProperty.call(n,s))){var a=e[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(nt(iO(s),a,{"dt:dt":o}))}}),"<"+r+' xmlns="'+Ys.o+'">'+i.join("")+"</"+r+">"}function Npe(n){var e=typeof n=="string"?new Date(Date.parse(n)):n,t=e.getTime()/1e3+11644473600,r=t%Math.pow(2,32),i=(t-r)/Math.pow(2,32);r*=1e7,i*=1e7;var s=r/Math.pow(2,32)|0;s>0&&(r=r%Math.pow(2,32),i+=s);var a=Re(8);return a.write_shift(4,r),a.write_shift(4,i),a}function _O(n,e){var t=Re(4),r=Re(4);switch(t.write_shift(4,n==80?31:n),n){case 3:r.write_shift(-4,e);break;case 5:r=Re(8),r.write_shift(8,e,"f");break;case 11:r.write_shift(4,e?1:0);break;case 64:r=Npe(e);break;case 31:case 80:for(r=Re(4+2*(e.length+1)+(e.length%2?0:2)),r.write_shift(4,e.length+1),r.write_shift(0,e,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+e)}return Ri([t,r])}var kV=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Lpe(n){switch(typeof n){case"boolean":return 11;case"number":return(n|0)==n?3:5;case"string":return 31;case"object":if(n instanceof Date)return 64;break}return-1}function xO(n,e,t){var r=Re(8),i=[],s=[],a=8,o=0,l=Re(8),u=Re(8);if(l.write_shift(4,2),l.write_shift(4,1200),u.write_shift(4,1),s.push(l),i.push(u),a+=8+l.length,!e){u=Re(8),u.write_shift(4,0),i.unshift(u);var h=[Re(4)];for(h[0].write_shift(4,n.length),o=0;o<n.length;++o){var f=n[o][0];for(l=Re(8+2*(f.length+1)+(f.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,f.length+1),l.write_shift(0,f,"dbcs");l.l!=l.length;)l.write_shift(1,0);h.push(l)}l=Ri(h),s.unshift(l),a+=8+l.length}for(o=0;o<n.length;++o)if(!(e&&!e[n[o][0]])&&!(kV.indexOf(n[o][0])>-1||AV.indexOf(n[o][0])>-1)&&n[o][1]!=null){var g=n[o][1],y=0;if(e){y=+e[n[o][0]];var v=t[y];if(v.p=="version"&&typeof g=="string"){var x=g.split(".");g=(+x[0]<<16)+(+x[1]||0)}l=_O(v.t,g)}else{var E=Lpe(g);E==-1&&(E=31,g=String(g)),l=_O(E,g)}s.push(l),u=Re(8),u.write_shift(4,e?y:2+o),i.push(u),a+=8+l.length}var T=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,T),T+=s[o].length;return r.write_shift(4,a),r.write_shift(4,s.length),Ri([r].concat(i).concat(s))}function vO(n,e,t,r,i,s){var a=Re(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,Xn.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,i?68:48);var l=xO(n,t,r);if(o.push(l),i){var u=xO(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+l.length),o.push(u)}return Ri(o)}function Ope(n,e){e||(e=Re(n));for(var t=0;t<n;++t)e.write_shift(1,0);return e}function Dpe(n,e){return n.read_shift(e)===1}function is(n,e){return e||(e=Re(2)),e.write_shift(2,+!!n),e}function PV(n){return n.read_shift(2,"u")}function xa(n,e){return e||(e=Re(2)),e.write_shift(2,n),e}function MV(n,e,t){return t||(t=Re(2)),t.write_shift(1,e=="e"?+n:+!!n),t.write_shift(1,e=="e"?1:0),t}function NV(n,e,t){var r=n.read_shift(t&&t.biff>=12?2:1),i="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var s=n.read_shift(1);s&&(i="dbcs-cont")}else t.biff==12&&(i="wstr");t.biff>=2&&t.biff<=5&&(i="cpstr");var a=r?n.read_shift(r,i):"";return a}function Fpe(n){var e=n.t||"",t=Re(3);t.write_shift(2,e.length),t.write_shift(1,1);var r=Re(2*e.length);r.write_shift(2*e.length,e,"utf16le");var i=[t,r];return Ri(i)}function jpe(n,e,t){var r;if(t){if(t.biff>=2&&t.biff<=5)return n.read_shift(e,"cpstr");if(t.biff>=12)return n.read_shift(e,"dbcs-cont")}var i=n.read_shift(1);return i===0?r=n.read_shift(e,"sbcs-cont"):r=n.read_shift(e,"dbcs-cont"),r}function Vpe(n,e,t){var r=n.read_shift(t&&t.biff==2?1:2);return r===0?(n.l++,""):jpe(n,r,t)}function Gpe(n,e,t){if(t.biff>5)return Vpe(n,e,t);var r=n.read_shift(1);return r===0?(n.l++,""):n.read_shift(r,t.biff<=4||!n.lens?"cpstr":"sbcs-cont")}function LV(n,e,t){return t||(t=Re(3+2*n.length)),t.write_shift(2,n.length),t.write_shift(1,1),t.write_shift(31,n,"utf16le"),t}function wO(n,e){e||(e=Re(6+n.length*2)),e.write_shift(4,1+n.length);for(var t=0;t<n.length;++t)e.write_shift(2,n.charCodeAt(t));return e.write_shift(2,0),e}function Bpe(n){var e=Re(512),t=0,r=n.Target;r.slice(0,7)=="file://"&&(r=r.slice(7));var i=r.indexOf("#"),s=i>-1?31:23;switch(r.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(t=0;t<a.length;++t)e.write_shift(4,a[t]);if(s==28)r=r.slice(1),wO(r,e);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<a.length;++t)e.write_shift(1,parseInt(a[t],16));var o=i>-1?r.slice(0,i):r;for(e.write_shift(4,2*(o.length+1)),t=0;t<o.length;++t)e.write_shift(2,o.charCodeAt(t));e.write_shift(2,0),s&8&&wO(i>-1?r.slice(i+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<a.length;++t)e.write_shift(1,parseInt(a[t],16));for(var l=0;r.slice(l*3,l*3+3)=="../"||r.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,r.length-3*l+1),t=0;t<r.length-3*l;++t)e.write_shift(1,r.charCodeAt(t+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),t=0;t<6;++t)e.write_shift(4,0)}return e.slice(0,e.l)}function id(n,e,t,r){return r||(r=Re(6)),r.write_shift(2,n),r.write_shift(2,e),r.write_shift(2,t||0),r}function Upe(n,e,t){var r=t.biff>8?4:2,i=n.read_shift(r),s=n.read_shift(r,"i"),a=n.read_shift(r,"i");return[i,s,a]}function zpe(n){var e=n.read_shift(2),t=n.read_shift(2),r=n.read_shift(2),i=n.read_shift(2);return{s:{c:r,r:e},e:{c:i,r:t}}}function OV(n,e){return e||(e=Re(8)),e.write_shift(2,n.s.r),e.write_shift(2,n.e.r),e.write_shift(2,n.s.c),e.write_shift(2,n.e.c),e}function aC(n,e,t){var r=1536,i=16;switch(t.bookType){case"biff8":break;case"biff5":r=1280,i=8;break;case"biff4":r=4,i=6;break;case"biff3":r=3,i=6;break;case"biff2":r=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=Re(i);return s.write_shift(2,r),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function $pe(n,e){var t=!e||e.biff==8,r=Re(t?112:54);for(r.write_shift(e.biff==8?2:1,7),t&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(t?0:536870912));r.l<r.length;)r.write_shift(1,t?0:32);return r}function Wpe(n,e){var t=!e||e.biff>=8?2:1,r=Re(8+t*n.name.length);r.write_shift(4,n.pos),r.write_shift(1,n.hs||0),r.write_shift(1,n.dt),r.write_shift(1,n.name.length),e.biff>=8&&r.write_shift(1,1),r.write_shift(t*n.name.length,n.name,e.biff<8?"sbcs":"utf16le");var i=r.slice(0,r.l);return i.l=r.l,i}function Hpe(n,e){var t=Re(8);t.write_shift(4,n.Count),t.write_shift(4,n.Unique);for(var r=[],i=0;i<n.length;++i)r[i]=Fpe(n[i]);var s=Ri([t].concat(r));return s.parts=[t.length].concat(r.map(function(a){return a.length})),s}function Kpe(){var n=Re(18);return n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,29280),n.write_shift(2,17600),n.write_shift(2,56),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,1),n.write_shift(2,500),n}function Ype(n){var e=Re(18),t=1718;return n&&n.RTL&&(t|=64),e.write_shift(2,t),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function Xpe(n,e){var t=n.name||"Arial",r=e&&e.biff==5,i=r?15+t.length:16+2*t.length,s=Re(i);return s.write_shift(2,n.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,t.length),r||s.write_shift(1,1),s.write_shift((r?1:2)*t.length,t,r?"sbcs":"utf16le"),s}function qpe(n,e,t,r){var i=Re(10);return id(n,e,r,i),i.write_shift(4,t),i}function Zpe(n,e,t,r,i){var s=!i||i.biff==8,a=Re(8+ +s+(1+s)*t.length);return id(n,e,r,a),a.write_shift(2,t.length),s&&a.write_shift(1,1),a.write_shift((1+s)*t.length,t,s?"utf16le":"sbcs"),a}function Qpe(n,e,t,r){var i=t&&t.biff==5;r||(r=Re(i?3+e.length:5+2*e.length)),r.write_shift(2,n),r.write_shift(i?1:2,e.length),i||r.write_shift(1,1),r.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=r.length>r.l?r.slice(0,r.l):r;return s.l==null&&(s.l=s.length),s}function Jpe(n,e){var t=e.biff==8||!e.biff?4:2,r=Re(2*t+6);return r.write_shift(t,n.s.r),r.write_shift(t,n.e.r+1),r.write_shift(2,n.s.c),r.write_shift(2,n.e.c+1),r.write_shift(2,0),r}function EO(n,e,t,r){var i=t&&t.biff==5;r||(r=Re(i?16:20)),r.write_shift(2,0),n.style?(r.write_shift(2,n.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,n.numFmtId||0),r.write_shift(2,e<<4));var s=0;return n.numFmtId>0&&i&&(s|=1024),r.write_shift(4,s),r.write_shift(4,0),i||r.write_shift(4,0),r.write_shift(2,0),r}function e1e(n){var e=Re(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function t1e(n,e,t,r,i,s){var a=Re(8);return id(n,e,r,a),MV(t,s,a),a}function n1e(n,e,t,r){var i=Re(14);return id(n,e,r,i),rd(t,i),i}function r1e(n,e,t){if(t.biff<8)return i1e(n,e,t);for(var r=[],i=n.l+e,s=n.read_shift(t.biff>8?4:2);s--!==0;)r.push(Upe(n,t.biff>8?12:6,t));if(n.l!=i)throw new Error("Bad ExternSheet: "+n.l+" != "+i);return r}function i1e(n,e,t){n[n.l+1]==3&&n[n.l]++;var r=NV(n,e,t);return r.charCodeAt(0)==3?r.slice(1):r}function s1e(n){var e=Re(2+n.length*8);e.write_shift(2,n.length);for(var t=0;t<n.length;++t)OV(n[t],e);return e}function a1e(n){var e=Re(24),t=mi(n[0]);e.write_shift(2,t.r),e.write_shift(2,t.r),e.write_shift(2,t.c),e.write_shift(2,t.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(r[i],16));return Ri([e,Bpe(n[1])])}function o1e(n){var e=n[1].Tooltip,t=Re(10+2*(e.length+1));t.write_shift(2,2048);var r=mi(n[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var i=0;i<e.length;++i)t.write_shift(2,e.charCodeAt(i));return t.write_shift(2,0),t}function l1e(n){return n||(n=Re(4)),n.write_shift(2,1),n.write_shift(2,1),n}function c1e(n,e,t){if(!t.cellStyles)return el(n,e);var r=t&&t.biff>=12?4:2,i=n.read_shift(r),s=n.read_shift(r),a=n.read_shift(r),o=n.read_shift(r),l=n.read_shift(2);r==2&&(n.l+=2);var u={s:i,e:s,w:a,ixfe:o,flags:l};return(t.biff>=5||!t.biff)&&(u.level=l>>8&7),u}function u1e(n,e){var t=Re(12);t.write_shift(2,e),t.write_shift(2,e),t.write_shift(2,n.width*256),t.write_shift(2,0);var r=0;return n.hidden&&(r|=1),t.write_shift(1,r),r=n.level||0,t.write_shift(1,r),t.write_shift(2,0),t}function h1e(n){for(var e=Re(2*n),t=0;t<n;++t)e.write_shift(2,t+1);return e}function d1e(n,e,t){var r=Re(15);return O1(r,n,e),r.write_shift(8,t,"f"),r}function f1e(n,e,t){var r=Re(9);return O1(r,n,e),r.write_shift(2,t),r}var g1e=(function(){var n={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=XR({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(o,l){var u=[],h=nd(1);switch(l.type){case"base64":h=Za(Kl(o));break;case"binary":h=Za(o);break;case"buffer":case"array":h=o;break}Ws(h,0);var f=h.read_shift(1),g=!!(f&136),y=!1,v=!1;switch(f){case 2:break;case 3:break;case 48:y=!0,g=!0;break;case 49:y=!0,g=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var x=0,E=521;f==2&&(x=h.read_shift(2)),h.l+=3,f!=2&&(x=h.read_shift(4)),x>1048576&&(x=1e6),f!=2&&(E=h.read_shift(2));var T=h.read_shift(2),b=l.codepage||1252;f!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(b=n[h[h.l]]),h.l+=1,h.l+=2),v&&(h.l+=36);for(var I=[],M={},F=Math.min(h.length,f==2?521:E-10-(y?264:0)),z=v?32:11;h.l<F&&h[h.l]!=13;)switch(M={},M.name=fv.utils.decode(b,h.slice(h.l,h.l+z)).replace(/[\u0000\r\n].*$/g,""),h.l+=z,M.type=String.fromCharCode(h.read_shift(1)),f!=2&&!v&&(M.offset=h.read_shift(4)),M.len=h.read_shift(1),f==2&&(M.offset=h.read_shift(2)),M.dec=h.read_shift(1),M.name.length&&I.push(M),f!=2&&(h.l+=v?13:14),M.type){case"B":(!y||M.len!=8)&&l.WTF&&console.log("Skipping "+M.name+":"+M.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+M.name+":"+M.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+M.type)}if(h[h.l]!==13&&(h.l=E-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=E;var P=0,C=0;for(u[0]=[],C=0;C!=I.length;++C)u[0][C]=I[C].name;for(;x-- >0;){if(h[h.l]===42){h.l+=T;continue}for(++h.l,u[++P]=[],C=0,C=0;C!=I.length;++C){var k=h.slice(h.l,h.l+I[C].len);h.l+=I[C].len,Ws(k,0);var L=fv.utils.decode(b,k);switch(I[C].type){case"C":L.trim().length&&(u[P][C]=L.replace(/\s+$/,""));break;case"D":L.length===8?u[P][C]=new Date(+L.slice(0,4),+L.slice(4,6)-1,+L.slice(6,8)):u[P][C]=L;break;case"F":u[P][C]=parseFloat(L.trim());break;case"+":case"I":u[P][C]=v?k.read_shift(-4,"i")^2147483648:k.read_shift(4,"i");break;case"L":switch(L.trim().toUpperCase()){case"Y":case"T":u[P][C]=!0;break;case"N":case"F":u[P][C]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+L+"|")}break;case"M":if(!g)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[P][C]="##MEMO##"+(v?parseInt(L.trim(),10):k.read_shift(4));break;case"N":L=L.replace(/\u0000/g,"").trim(),L&&L!="."&&(u[P][C]=+L||0);break;case"@":u[P][C]=new Date(k.read_shift(-8,"f")-621356832e5);break;case"T":u[P][C]=new Date((k.read_shift(4)-2440588)*864e5+k.read_shift(4));break;case"Y":u[P][C]=k.read_shift(4,"i")/1e4+k.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[P][C]=-k.read_shift(-8,"f");break;case"B":if(y&&I[C].len==8){u[P][C]=k.read_shift(8,"f");break}case"G":case"P":k.l+=I[C].len;break;case"0":if(I[C].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+I[C].type)}}}if(f!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=I,u}function r(o,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var h=X0(t(o,u),u);return h["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,h}function i(o,l){try{return vd(r(o,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var u=l||{};if(+u.codepage>=0&&Mp(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var h=ks(),f=Iv(o,{header:1,raw:!0,cellDates:!0}),g=f[0],y=f.slice(1),v=o["!cols"]||[],x=0,E=0,T=0,b=1;for(x=0;x<g.length;++x){if(((v[x]||{}).DBF||{}).name){g[x]=v[x].DBF.name,++T;continue}if(g[x]!=null){if(++T,typeof g[x]=="number"&&(g[x]=g[x].toString(10)),typeof g[x]!="string")throw new Error("DBF Invalid column name "+g[x]+" |"+typeof g[x]+"|");if(g.indexOf(g[x])!==x){for(E=0;E<1024;++E)if(g.indexOf(g[x]+"_"+E)==-1){g[x]+="_"+E;break}}}}var I=cr(o["!ref"]),M=[],F=[],z=[];for(x=0;x<=I.e.c-I.s.c;++x){var P="",C="",k=0,L=[];for(E=0;E<y.length;++E)y[E][x]!=null&&L.push(y[E][x]);if(L.length==0||g[x]==null){M[x]="?";continue}for(E=0;E<L.length;++E){switch(typeof L[E]){case"number":C="B";break;case"string":C="C";break;case"boolean":C="L";break;case"object":C=L[E]instanceof Date?"D":"C";break;default:C="C"}k=Math.max(k,String(L[E]).length),P=P&&P!=C?"C":C}k>250&&(k=250),C=((v[x]||{}).DBF||{}).type,C=="C"&&v[x].DBF.len>k&&(k=v[x].DBF.len),P=="B"&&C=="N"&&(P="N",z[x]=v[x].DBF.dec,k=v[x].DBF.len),F[x]=P=="C"||C=="N"?k:s[P]||0,b+=F[x],M[x]=P}var O=h.next(32);for(O.write_shift(4,318902576),O.write_shift(4,y.length),O.write_shift(2,296+32*T),O.write_shift(2,b),x=0;x<4;++x)O.write_shift(4,0);for(O.write_shift(4,0|(+e[F7]||3)<<8),x=0,E=0;x<g.length;++x)if(g[x]!=null){var U=h.next(32),j=(g[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);U.write_shift(1,j,"sbcs"),U.write_shift(1,M[x]=="?"?"C":M[x],"sbcs"),U.write_shift(4,E),U.write_shift(1,F[x]||s[M[x]]||0),U.write_shift(1,z[x]||0),U.write_shift(1,2),U.write_shift(4,0),U.write_shift(1,0),U.write_shift(4,0),U.write_shift(4,0),E+=F[x]||s[M[x]]||0}var Te=h.next(264);for(Te.write_shift(4,13),x=0;x<65;++x)Te.write_shift(4,0);for(x=0;x<y.length;++x){var Ce=h.next(b);for(Ce.write_shift(1,0),E=0;E<g.length;++E)if(g[E]!=null)switch(M[E]){case"L":Ce.write_shift(1,y[x][E]==null?63:y[x][E]?84:70);break;case"B":Ce.write_shift(8,y[x][E]||0,"f");break;case"N":var Ue="0";for(typeof y[x][E]=="number"&&(Ue=y[x][E].toFixed(z[E]||0)),T=0;T<F[E]-Ue.length;++T)Ce.write_shift(1,32);Ce.write_shift(1,Ue,"sbcs");break;case"D":y[x][E]?(Ce.write_shift(4,("0000"+y[x][E].getFullYear()).slice(-4),"sbcs"),Ce.write_shift(2,("00"+(y[x][E].getMonth()+1)).slice(-2),"sbcs"),Ce.write_shift(2,("00"+y[x][E].getDate()).slice(-2),"sbcs")):Ce.write_shift(8,"00000000","sbcs");break;case"C":var Ne=String(y[x][E]!=null?y[x][E]:"").slice(0,F[E]);for(Ce.write_shift(1,Ne,"sbcs"),T=0;T<F[E]-Ne.length;++T)Ce.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:i,to_sheet:r,from_sheet:a}})(),m1e=(function(){var n={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Mi(n).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(g,y){var v=n[y];return typeof v=="number"?HL(v):v},r=function(g,y,v){var x=y.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return x==59?g:HL(x)};n["|"]=254;function i(g,y){switch(y.type){case"base64":return s(Kl(g),y);case"binary":return s(g,y);case"buffer":return s(Rn&&Buffer.isBuffer(g)?g.toString("binary"):k1(g),y);case"array":return s(Kw(g),y)}throw new Error("Unrecognized type "+y.type)}function s(g,y){var v=g.split(/[\n\r]+/),x=-1,E=-1,T=0,b=0,I=[],M=[],F=null,z={},P=[],C=[],k=[],L=0,O;for(+y.codepage>=0&&Mp(+y.codepage);T!==v.length;++T){L=0;var U=v[T].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(e,t),j=U.replace(/;;/g,"\0").split(";").map(function(q){return q.replace(/\u0000/g,";")}),Te=j[0],Ce;if(U.length>0)switch(Te){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":j[1].charAt(0)=="P"&&M.push(U.slice(3).replace(/;;/g,";"));break;case"C":var Ue=!1,Ne=!1,le=!1,ue=!1,Se=-1,se=-1;for(b=1;b<j.length;++b)switch(j[b].charAt(0)){case"A":break;case"X":E=parseInt(j[b].slice(1))-1,Ne=!0;break;case"Y":for(x=parseInt(j[b].slice(1))-1,Ne||(E=0),O=I.length;O<=x;++O)I[O]=[];break;case"K":Ce=j[b].slice(1),Ce.charAt(0)==='"'?Ce=Ce.slice(1,Ce.length-1):Ce==="TRUE"?Ce=!0:Ce==="FALSE"?Ce=!1:isNaN(Fl(Ce))?isNaN(Lp(Ce).getDate())||(Ce=hs(Ce)):(Ce=Fl(Ce),F!==null&&X7(F)&&(Ce=J7(Ce))),Ue=!0;break;case"E":ue=!0;var V=fye(j[b].slice(1),{r:x,c:E});I[x][E]=[I[x][E],V];break;case"S":le=!0,I[x][E]=[I[x][E],"S5S"];break;case"G":break;case"R":Se=parseInt(j[b].slice(1))-1;break;case"C":se=parseInt(j[b].slice(1))-1;break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+U)}if(Ue&&(I[x][E]&&I[x][E].length==2?I[x][E][0]=Ce:I[x][E]=Ce,F=null),le){if(ue)throw new Error("SYLK shared formula cannot have own formula");var J=Se>-1&&I[Se][se];if(!J||!J[1])throw new Error("SYLK shared formula cannot find base");I[x][E][1]=gye(J[1],{r:x-Se,c:E-se})}break;case"F":var re=0;for(b=1;b<j.length;++b)switch(j[b].charAt(0)){case"X":E=parseInt(j[b].slice(1))-1,++re;break;case"Y":for(x=parseInt(j[b].slice(1))-1,O=I.length;O<=x;++O)I[O]=[];break;case"M":L=parseInt(j[b].slice(1))/20;break;case"F":break;case"G":break;case"P":F=M[parseInt(j[b].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(k=j[b].slice(1).split(" "),O=parseInt(k[0],10);O<=parseInt(k[1],10);++O)L=parseInt(k[2],10),C[O-1]=L===0?{hidden:!0}:{wch:L},oC(C[O-1]);break;case"C":E=parseInt(j[b].slice(1))-1,C[E]||(C[E]={});break;case"R":x=parseInt(j[b].slice(1))-1,P[x]||(P[x]={}),L>0?(P[x].hpt=L,P[x].hpx=GV(L)):L===0&&(P[x].hidden=!0);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+U)}re<1&&(F=null);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+U)}}return P.length>0&&(z["!rows"]=P),C.length>0&&(z["!cols"]=C),y&&y.sheetRows&&(I=I.slice(0,y.sheetRows)),[I,z]}function a(g,y){var v=i(g,y),x=v[0],E=v[1],T=X0(x,y);return Mi(E).forEach(function(b){T[b]=E[b]}),T}function o(g,y){return vd(a(g,y),y)}function l(g,y,v,x){var E="C;Y"+(v+1)+";X"+(x+1)+";K";switch(g.t){case"n":E+=g.v||0,g.f&&!g.F&&(E+=";E"+cC(g.f,{r:v,c:x}));break;case"b":E+=g.v?"TRUE":"FALSE";break;case"e":E+=g.w||g.v;break;case"d":E+='"'+(g.w||g.v)+'"';break;case"s":E+='"'+g.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return E}function u(g,y){y.forEach(function(v,x){var E="F;W"+(x+1)+" "+(x+1)+" ";v.hidden?E+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=Ev(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=Sv(v.wpx)),typeof v.wch=="number"&&(E+=Math.round(v.wch))),E.charAt(E.length-1)!=" "&&g.push(E)})}function h(g,y){y.forEach(function(v,x){var E="F;";v.hidden?E+="M0;":v.hpt?E+="M"+20*v.hpt+";":v.hpx&&(E+="M"+20*Tv(v.hpx)+";"),E.length>2&&g.push(E+"R"+(x+1))})}function f(g,y){var v=["ID;PWXL;N;E"],x=[],E=cr(g["!ref"]),T,b=Array.isArray(g),I=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),g["!cols"]&&u(v,g["!cols"]),g["!rows"]&&h(v,g["!rows"]),v.push("B;Y"+(E.e.r-E.s.r+1)+";X"+(E.e.c-E.s.c+1)+";D"+[E.s.c,E.s.r,E.e.c,E.e.r].join(" "));for(var M=E.s.r;M<=E.e.r;++M)for(var F=E.s.c;F<=E.e.c;++F){var z=Yn({r:M,c:F});T=b?(g[M]||[])[F]:g[z],!(!T||T.v==null&&(!T.f||T.F))&&x.push(l(T,g,M,F))}return v.join(I)+I+x.join(I)+I+"E"+I}return{to_workbook:o,to_sheet:a,from_sheet:f}})(),p1e=(function(){function n(s,a){switch(a.type){case"base64":return e(Kl(s),a);case"binary":return e(s,a);case"buffer":return e(Rn&&Buffer.isBuffer(s)?s.toString("binary"):k1(s),a);case"array":return e(Kw(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var o=s.split(`
`),l=-1,u=-1,h=0,f=[];h!==o.length;++h){if(o[h].trim()==="BOT"){f[++l]=[],u=0;continue}if(!(l<0)){var g=o[h].trim().split(","),y=g[0],v=g[1];++h;for(var x=o[h]||"";(x.match(/["]/g)||[]).length&1&&h<o.length-1;)x+=`
`+o[++h];switch(x=x.trim(),+y){case-1:if(x==="BOT"){f[++l]=[],u=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?f[l][u]=!0:x==="FALSE"?f[l][u]=!1:isNaN(Fl(v))?isNaN(Lp(v).getDate())?f[l][u]=v:f[l][u]=hs(v):f[l][u]=Fl(v),++u;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),f[l][u++]=x!==""?x:null;break}if(x==="EOD")break}}return a&&a.sheetRows&&(f=f.slice(0,a.sheetRows)),f}function t(s,a){return X0(n(s,a),a)}function r(s,a){return vd(t(s,a),a)}var i=(function(){var s=function(l,u,h,f,g){l.push(u),l.push(h+","+f),l.push('"'+g.replace(/"/g,'""')+'"')},a=function(l,u,h,f){l.push(u+","+h),l.push(u==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(l){var u=[],h=cr(l["!ref"]),f,g=Array.isArray(l);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,h.e.r-h.s.r+1,""),s(u,"TUPLES",0,h.e.c-h.s.c+1,""),s(u,"DATA",0,0,"");for(var y=h.s.r;y<=h.e.r;++y){a(u,-1,0,"BOT");for(var v=h.s.c;v<=h.e.c;++v){var x=Yn({r:y,c:v});if(f=g?(l[y]||[])[v]:l[x],!f){a(u,1,0,"");continue}switch(f.t){case"n":var E=f.w;!E&&f.v!=null&&(E=f.v),E==null?f.f&&!f.F?a(u,1,0,"="+f.f):a(u,1,0,""):a(u,0,E,"V");break;case"b":a(u,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":a(u,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=vu(f.z||Pr[14],Ms(hs(f.v)))),a(u,0,f.w,"V");break;default:a(u,1,0,"")}}}a(u,-1,0,"EOD");var T=`\r
`,b=u.join(T);return b}})();return{to_workbook:r,to_sheet:t,from_sheet:i}})(),DV=(function(){function n(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(f,g){for(var y=f.split(`
`),v=-1,x=-1,E=0,T=[];E!==y.length;++E){var b=y[E].trim().split(":");if(b[0]==="cell"){var I=mi(b[1]);if(T.length<=I.r)for(v=T.length;v<=I.r;++v)T[v]||(T[v]=[]);switch(v=I.r,x=I.c,b[2]){case"t":T[v][x]=n(b[3]);break;case"v":T[v][x]=+b[3];break;case"vtf":var M=b[b.length-1];case"vtc":switch(b[3]){case"nl":T[v][x]=!!+b[4];break;default:T[v][x]=+b[4];break}b[2]=="vtf"&&(T[v][x]=[T[v][x],M])}}}return g&&g.sheetRows&&(T=T.slice(0,g.sheetRows)),T}function r(f,g){return X0(t(f,g),g)}function i(f,g){return vd(r(f,g),g)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var g=[],y=[],v,x="",E=ia(f["!ref"]),T=Array.isArray(f),b=E.s.r;b<=E.e.r;++b)for(var I=E.s.c;I<=E.e.c;++I)if(x=Yn({r:b,c:I}),v=T?(f[b]||[])[I]:f[x],!(!v||v.v==null||v.t==="z")){switch(y=["cell",x,"t"],v.t){case"s":case"str":y.push(e(v.v));break;case"n":v.f?(y[2]="vtf",y[3]="n",y[4]=v.v,y[5]=e(v.f)):(y[2]="v",y[3]=v.v);break;case"b":y[2]="vt"+(v.f?"f":"c"),y[3]="nl",y[4]=v.v?"1":"0",y[5]=e(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var M=Ms(hs(v.v));y[2]="vtc",y[3]="nd",y[4]=""+M,y[5]=v.w||vu(v.z||Pr[14],M);break;case"e":continue}g.push(y.join(":"))}return g.push("sheet:c:"+(E.e.c-E.s.c+1)+":r:"+(E.e.r-E.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)}function h(f){return[s,a,o,a,u(f),l].join(`
`)}return{to_workbook:i,to_sheet:r,from_sheet:h}})(),y1e=(function(){function n(h,f,g,y,v){v.raw?f[g][y]=h:h===""||(h==="TRUE"?f[g][y]=!0:h==="FALSE"?f[g][y]=!1:isNaN(Fl(h))?isNaN(Lp(h).getDate())?f[g][y]=h:f[g][y]=hs(h):f[g][y]=Fl(h))}function e(h,f){var g=f||{},y=[];if(!h||h.length===0)return y;for(var v=h.split(/[\r\n]/),x=v.length-1;x>=0&&v[x].length===0;)--x;for(var E=10,T=0,b=0;b<=x;++b)T=v[b].indexOf(" "),T==-1?T=v[b].length:T++,E=Math.max(E,T);for(b=0;b<=x;++b){y[b]=[];var I=0;for(n(v[b].slice(0,E).trim(),y,b,I,g),I=1;I<=(v[b].length-E)/10+1;++I)n(v[b].slice(E+(I-1)*10,E+I*10).trim(),y,b,I,g)}return g.sheetRows&&(y=y.slice(0,g.sheetRows)),y}var t={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function i(h){for(var f={},g=!1,y=0,v=0;y<h.length;++y)(v=h.charCodeAt(y))==34?g=!g:!g&&v in t&&(f[v]=(f[v]||0)+1);v=[];for(y in f)Object.prototype.hasOwnProperty.call(f,y)&&v.push([f[y],y]);if(!v.length){f=r;for(y in f)Object.prototype.hasOwnProperty.call(f,y)&&v.push([f[y],y])}return v.sort(function(x,E){return x[0]-E[0]||r[x[1]]-r[E[1]]}),t[v.pop()[1]]||44}function s(h,f){var g=f||{},y="",v=g.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(y=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(y=h.charAt(4),h=h.slice(6)):y=i(h.slice(0,1024)):g&&g.FS?y=g.FS:y=i(h.slice(0,1024));var E=0,T=0,b=0,I=0,M=0,F=y.charCodeAt(0),z=!1,P=0,C=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var k=g.dateNF!=null?Nme(g.dateNF):null;function L(){var O=h.slice(I,M),U={};if(O.charAt(0)=='"'&&O.charAt(O.length-1)=='"'&&(O=O.slice(1,-1).replace(/""/g,'"')),O.length===0)U.t="z";else if(g.raw)U.t="s",U.v=O;else if(O.trim().length===0)U.t="s",U.v=O;else if(O.charCodeAt(0)==61)O.charCodeAt(1)==34&&O.charCodeAt(O.length-1)==34?(U.t="s",U.v=O.slice(2,-1).replace(/""/g,'"')):mye(O)?(U.t="n",U.f=O.slice(1)):(U.t="s",U.v=O);else if(O=="TRUE")U.t="b",U.v=!0;else if(O=="FALSE")U.t="b",U.v=!1;else if(!isNaN(b=Fl(O)))U.t="n",g.cellText!==!1&&(U.w=O),U.v=b;else if(!isNaN(Lp(O).getDate())||k&&O.match(k)){U.z=g.dateNF||Pr[14];var j=0;k&&O.match(k)&&(O=Lme(O,g.dateNF,O.match(k)||[]),j=1),g.cellDates?(U.t="d",U.v=hs(O,j)):(U.t="n",U.v=Ms(hs(O,j))),g.cellText!==!1&&(U.w=vu(U.z,U.v instanceof Date?Ms(U.v):U.v)),g.cellNF||delete U.z}else U.t="s",U.v=O;if(U.t=="z"||(g.dense?(v[E]||(v[E]=[]),v[E][T]=U):v[Yn({c:T,r:E})]=U),I=M+1,C=h.charCodeAt(I),x.e.c<T&&(x.e.c=T),x.e.r<E&&(x.e.r=E),P==F)++T;else if(T=0,++E,g.sheetRows&&g.sheetRows<=E)return!0}e:for(;M<h.length;++M)switch(P=h.charCodeAt(M)){case 34:C===34&&(z=!z);break;case F:case 10:case 13:if(!z&&L())break e;break}return M-I>0&&L(),v["!ref"]=Yr(x),v}function a(h,f){return!(f&&f.PRN)||f.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?s(h,f):X0(e(h,f),f)}function o(h,f){var g="",y=f.type=="string"?[0,0,0,0]:Cwe(h,f);switch(f.type){case"base64":g=Kl(h);break;case"binary":g=h;break;case"buffer":f.codepage==65001?g=h.toString("utf8"):f.codepage&&typeof fv<"u"||(g=Rn&&Buffer.isBuffer(h)?h.toString("binary"):k1(h));break;case"array":g=Kw(h);break;case"string":g=h;break;default:throw new Error("Unrecognized type "+f.type)}return y[0]==239&&y[1]==187&&y[2]==191?g=Gm(g.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?g=Gm(g):f.type=="binary"&&typeof fv<"u",g.slice(0,19)=="socialcalc:version:"?DV.to_sheet(f.type=="string"?g:Gm(g),f):a(g,f)}function l(h,f){return vd(o(h,f),f)}function u(h){for(var f=[],g=cr(h["!ref"]),y,v=Array.isArray(h),x=g.s.r;x<=g.e.r;++x){for(var E=[],T=g.s.c;T<=g.e.c;++T){var b=Yn({r:x,c:T});if(y=v?(h[x]||[])[T]:h[b],!y||y.v==null){E.push("          ");continue}for(var I=(y.w||(Yl(y),y.w)||"").slice(0,10);I.length<10;)I+=" ";E.push(I+(T===0?" ":""))}f.push(E.join(""))}return f.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:u}})(),SO=(function(){function n(V,J,re){if(V){Ws(V,V.l||0);for(var q=re.Enum||Se;V.l<V.length;){var he=V.read_shift(2),Me=q[he]||q[65535],je=V.read_shift(2),De=V.l+je,Be=Me.f&&Me.f(V,je,re);if(V.l=De,J(Be,Me,he))return}}}function e(V,J){switch(J.type){case"base64":return t(Za(Kl(V)),J);case"binary":return t(Za(V),J);case"buffer":case"array":return t(V,J)}throw"Unsupported type "+J.type}function t(V,J){if(!V)return V;var re=J||{},q=re.dense?[]:{},he="Sheet1",Me="",je=0,De={},Be=[],Gt=[],Kt={s:{r:0,c:0},e:{r:0,c:0}},wn=re.sheetRows||0;if(V[2]==0&&(V[3]==8||V[3]==9)&&V.length>=16&&V[14]==5&&V[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(V[2]==2)re.Enum=Se,n(V,function(ot,Zn,on){switch(on){case 0:re.vers=ot,ot>=4096&&(re.qpro=!0);break;case 6:Kt=ot;break;case 204:ot&&(Me=ot);break;case 222:Me=ot;break;case 15:case 51:re.qpro||(ot[1].v=ot[1].v.slice(1));case 13:case 14:case 16:on==14&&(ot[2]&112)==112&&(ot[2]&15)>1&&(ot[2]&15)<15&&(ot[1].z=re.dateNF||Pr[14],re.cellDates&&(ot[1].t="d",ot[1].v=J7(ot[1].v))),re.qpro&&ot[3]>je&&(q["!ref"]=Yr(Kt),De[he]=q,Be.push(he),q=re.dense?[]:{},Kt={s:{r:0,c:0},e:{r:0,c:0}},je=ot[3],he=Me||"Sheet"+(je+1),Me="");var en=re.dense?(q[ot[0].r]||[])[ot[0].c]:q[Yn(ot[0])];if(en){en.t=ot[1].t,en.v=ot[1].v,ot[1].z!=null&&(en.z=ot[1].z),ot[1].f!=null&&(en.f=ot[1].f);break}re.dense?(q[ot[0].r]||(q[ot[0].r]=[]),q[ot[0].r][ot[0].c]=ot[1]):q[Yn(ot[0])]=ot[1];break}},re);else if(V[2]==26||V[2]==14)re.Enum=se,V[2]==14&&(re.qpro=!0,V.l=0),n(V,function(ot,Zn,on){switch(on){case 204:he=ot;break;case 22:ot[1].v=ot[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ot[3]>je&&(q["!ref"]=Yr(Kt),De[he]=q,Be.push(he),q=re.dense?[]:{},Kt={s:{r:0,c:0},e:{r:0,c:0}},je=ot[3],he="Sheet"+(je+1)),wn>0&&ot[0].r>=wn)break;re.dense?(q[ot[0].r]||(q[ot[0].r]=[]),q[ot[0].r][ot[0].c]=ot[1]):q[Yn(ot[0])]=ot[1],Kt.e.c<ot[0].c&&(Kt.e.c=ot[0].c),Kt.e.r<ot[0].r&&(Kt.e.r=ot[0].r);break;case 27:ot[14e3]&&(Gt[ot[14e3][0]]=ot[14e3][1]);break;case 1537:Gt[ot[0]]=ot[1],ot[0]==je&&(he=ot[1]);break}},re);else throw new Error("Unrecognized LOTUS BOF "+V[2]);if(q["!ref"]=Yr(Kt),De[Me||he]=q,Be.push(Me||he),!Gt.length)return{SheetNames:Be,Sheets:De};for(var Bt={},Fn=[],Qt=0;Qt<Gt.length;++Qt)De[Be[Qt]]?(Fn.push(Gt[Qt]||Be[Qt]),Bt[Gt[Qt]]=De[Gt[Qt]]||De[Be[Qt]]):(Fn.push(Gt[Qt]),Bt[Gt[Qt]]={"!ref":"A1"});return{SheetNames:Fn,Sheets:Bt}}function r(V,J){var re=J||{};if(+re.codepage>=0&&Mp(+re.codepage),re.type=="string")throw new Error("Cannot write WK1 to JS string");var q=ks(),he=cr(V["!ref"]),Me=Array.isArray(V),je=[];rt(q,0,s(1030)),rt(q,6,l(he));for(var De=Math.min(he.e.r,8191),Be=he.s.r;Be<=De;++Be)for(var Gt=Pi(Be),Kt=he.s.c;Kt<=he.e.c;++Kt){Be===he.s.r&&(je[Kt]=Zi(Kt));var wn=je[Kt]+Gt,Bt=Me?(V[Be]||[])[Kt]:V[wn];if(!(!Bt||Bt.t=="z"))if(Bt.t=="n")(Bt.v|0)==Bt.v&&Bt.v>=-32768&&Bt.v<=32767?rt(q,13,y(Be,Kt,Bt.v)):rt(q,14,x(Be,Kt,Bt.v));else{var Fn=Yl(Bt);rt(q,15,f(Be,Kt,Fn.slice(0,239)))}}return rt(q,1),q.end()}function i(V,J){var re=J||{};if(+re.codepage>=0&&Mp(+re.codepage),re.type=="string")throw new Error("Cannot write WK3 to JS string");var q=ks();rt(q,0,a(V));for(var he=0,Me=0;he<V.SheetNames.length;++he)(V.Sheets[V.SheetNames[he]]||{})["!ref"]&&rt(q,27,ue(V.SheetNames[he],Me++));var je=0;for(he=0;he<V.SheetNames.length;++he){var De=V.Sheets[V.SheetNames[he]];if(!(!De||!De["!ref"])){for(var Be=cr(De["!ref"]),Gt=Array.isArray(De),Kt=[],wn=Math.min(Be.e.r,8191),Bt=Be.s.r;Bt<=wn;++Bt)for(var Fn=Pi(Bt),Qt=Be.s.c;Qt<=Be.e.c;++Qt){Bt===Be.s.r&&(Kt[Qt]=Zi(Qt));var ot=Kt[Qt]+Fn,Zn=Gt?(De[Bt]||[])[Qt]:De[ot];if(!(!Zn||Zn.t=="z"))if(Zn.t=="n")rt(q,23,L(Bt,Qt,je,Zn.v));else{var on=Yl(Zn);rt(q,22,P(Bt,Qt,je,on.slice(0,239)))}}++je}}return rt(q,1),q.end()}function s(V){var J=Re(2);return J.write_shift(2,V),J}function a(V){var J=Re(26);J.write_shift(2,4096),J.write_shift(2,4),J.write_shift(4,0);for(var re=0,q=0,he=0,Me=0;Me<V.SheetNames.length;++Me){var je=V.SheetNames[Me],De=V.Sheets[je];if(!(!De||!De["!ref"])){++he;var Be=ia(De["!ref"]);re<Be.e.r&&(re=Be.e.r),q<Be.e.c&&(q=Be.e.c)}}return re>8191&&(re=8191),J.write_shift(2,re),J.write_shift(1,he),J.write_shift(1,q),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(1,1),J.write_shift(1,2),J.write_shift(4,0),J.write_shift(4,0),J}function o(V,J,re){var q={s:{c:0,r:0},e:{c:0,r:0}};return J==8&&re.qpro?(q.s.c=V.read_shift(1),V.l++,q.s.r=V.read_shift(2),q.e.c=V.read_shift(1),V.l++,q.e.r=V.read_shift(2),q):(q.s.c=V.read_shift(2),q.s.r=V.read_shift(2),J==12&&re.qpro&&(V.l+=2),q.e.c=V.read_shift(2),q.e.r=V.read_shift(2),J==12&&re.qpro&&(V.l+=2),q.s.c==65535&&(q.s.c=q.e.c=q.s.r=q.e.r=0),q)}function l(V){var J=Re(8);return J.write_shift(2,V.s.c),J.write_shift(2,V.s.r),J.write_shift(2,V.e.c),J.write_shift(2,V.e.r),J}function u(V,J,re){var q=[{c:0,r:0},{t:"n",v:0},0,0];return re.qpro&&re.vers!=20768?(q[0].c=V.read_shift(1),q[3]=V.read_shift(1),q[0].r=V.read_shift(2),V.l+=2):(q[2]=V.read_shift(1),q[0].c=V.read_shift(2),q[0].r=V.read_shift(2)),q}function h(V,J,re){var q=V.l+J,he=u(V,J,re);if(he[1].t="s",re.vers==20768){V.l++;var Me=V.read_shift(1);return he[1].v=V.read_shift(Me,"utf8"),he}return re.qpro&&V.l++,he[1].v=V.read_shift(q-V.l,"cstr"),he}function f(V,J,re){var q=Re(7+re.length);q.write_shift(1,255),q.write_shift(2,J),q.write_shift(2,V),q.write_shift(1,39);for(var he=0;he<q.length;++he){var Me=re.charCodeAt(he);q.write_shift(1,Me>=128?95:Me)}return q.write_shift(1,0),q}function g(V,J,re){var q=u(V,J,re);return q[1].v=V.read_shift(2,"i"),q}function y(V,J,re){var q=Re(7);return q.write_shift(1,255),q.write_shift(2,J),q.write_shift(2,V),q.write_shift(2,re,"i"),q}function v(V,J,re){var q=u(V,J,re);return q[1].v=V.read_shift(8,"f"),q}function x(V,J,re){var q=Re(13);return q.write_shift(1,255),q.write_shift(2,J),q.write_shift(2,V),q.write_shift(8,re,"f"),q}function E(V,J,re){var q=V.l+J,he=u(V,J,re);if(he[1].v=V.read_shift(8,"f"),re.qpro)V.l=q;else{var Me=V.read_shift(2);M(V.slice(V.l,V.l+Me),he),V.l+=Me}return he}function T(V,J,re){var q=J&32768;return J&=-32769,J=(q?V:0)+(J>=8192?J-16384:J),(q?"":"$")+(re?Zi(J):Pi(J))}var b={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},I=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function M(V,J){Ws(V,0);for(var re=[],q=0,he="",Me="",je="",De="";V.l<V.length;){var Be=V[V.l++];switch(Be){case 0:re.push(V.read_shift(8,"f"));break;case 1:Me=T(J[0].c,V.read_shift(2),!0),he=T(J[0].r,V.read_shift(2),!1),re.push(Me+he);break;case 2:{var Gt=T(J[0].c,V.read_shift(2),!0),Kt=T(J[0].r,V.read_shift(2),!1);Me=T(J[0].c,V.read_shift(2),!0),he=T(J[0].r,V.read_shift(2),!1),re.push(Gt+Kt+":"+Me+he)}break;case 3:if(V.l<V.length){console.error("WK1 premature formula end");return}break;case 4:re.push("("+re.pop()+")");break;case 5:re.push(V.read_shift(2));break;case 6:{for(var wn="";Be=V[V.l++];)wn+=String.fromCharCode(Be);re.push('"'+wn.replace(/"/g,'""')+'"')}break;case 8:re.push("-"+re.pop());break;case 23:re.push("+"+re.pop());break;case 22:re.push("NOT("+re.pop()+")");break;case 20:case 21:De=re.pop(),je=re.pop(),re.push(["AND","OR"][Be-20]+"("+je+","+De+")");break;default:if(Be<32&&I[Be])De=re.pop(),je=re.pop(),re.push(je+I[Be]+De);else if(b[Be]){if(q=b[Be][1],q==69&&(q=V[V.l++]),q>re.length){console.error("WK1 bad formula parse 0x"+Be.toString(16)+":|"+re.join("|")+"|");return}var Bt=re.slice(-q);re.length-=q,re.push(b[Be][0]+"("+Bt.join(",")+")")}else return Be<=7?console.error("WK1 invalid opcode "+Be.toString(16)):Be<=24?console.error("WK1 unsupported op "+Be.toString(16)):Be<=30?console.error("WK1 invalid opcode "+Be.toString(16)):Be<=115?console.error("WK1 unsupported function opcode "+Be.toString(16)):console.error("WK1 unrecognized opcode "+Be.toString(16))}}re.length==1?J[1].f=""+re[0]:console.error("WK1 bad formula parse |"+re.join("|")+"|")}function F(V){var J=[{c:0,r:0},{t:"n",v:0},0];return J[0].r=V.read_shift(2),J[3]=V[V.l++],J[0].c=V[V.l++],J}function z(V,J){var re=F(V);return re[1].t="s",re[1].v=V.read_shift(J-4,"cstr"),re}function P(V,J,re,q){var he=Re(6+q.length);he.write_shift(2,V),he.write_shift(1,re),he.write_shift(1,J),he.write_shift(1,39);for(var Me=0;Me<q.length;++Me){var je=q.charCodeAt(Me);he.write_shift(1,je>=128?95:je)}return he.write_shift(1,0),he}function C(V,J){var re=F(V);re[1].v=V.read_shift(2);var q=re[1].v>>1;if(re[1].v&1)switch(q&7){case 0:q=(q>>3)*5e3;break;case 1:q=(q>>3)*500;break;case 2:q=(q>>3)/20;break;case 3:q=(q>>3)/200;break;case 4:q=(q>>3)/2e3;break;case 5:q=(q>>3)/2e4;break;case 6:q=(q>>3)/16;break;case 7:q=(q>>3)/64;break}return re[1].v=q,re}function k(V,J){var re=F(V),q=V.read_shift(4),he=V.read_shift(4),Me=V.read_shift(2);if(Me==65535)return q===0&&he===3221225472?(re[1].t="e",re[1].v=15):q===0&&he===3489660928?(re[1].t="e",re[1].v=42):re[1].v=0,re;var je=Me&32768;return Me=(Me&32767)-16446,re[1].v=(1-je*2)*(he*Math.pow(2,Me+32)+q*Math.pow(2,Me)),re}function L(V,J,re,q){var he=Re(14);if(he.write_shift(2,V),he.write_shift(1,re),he.write_shift(1,J),q==0)return he.write_shift(4,0),he.write_shift(4,0),he.write_shift(2,65535),he;var Me=0,je=0,De=0,Be=0;return q<0&&(Me=1,q=-q),je=Math.log2(q)|0,q/=Math.pow(2,je-31),Be=q>>>0,(Be&2147483648)==0&&(q/=2,++je,Be=q>>>0),q-=Be,Be|=2147483648,Be>>>=0,q*=Math.pow(2,32),De=q>>>0,he.write_shift(4,De),he.write_shift(4,Be),je+=16383+(Me?32768:0),he.write_shift(2,je),he}function O(V,J){var re=k(V);return V.l+=J-14,re}function U(V,J){var re=F(V),q=V.read_shift(4);return re[1].v=q>>6,re}function j(V,J){var re=F(V),q=V.read_shift(8,"f");return re[1].v=q,re}function Te(V,J){var re=j(V);return V.l+=J-10,re}function Ce(V,J){return V[V.l+J-1]==0?V.read_shift(J,"cstr"):""}function Ue(V,J){var re=V[V.l++];re>J-1&&(re=J-1);for(var q="";q.length<re;)q+=String.fromCharCode(V[V.l++]);return q}function Ne(V,J,re){if(!(!re.qpro||J<21)){var q=V.read_shift(1);V.l+=17,V.l+=1,V.l+=2;var he=V.read_shift(J-21,"cstr");return[q,he]}}function le(V,J){for(var re={},q=V.l+J;V.l<q;){var he=V.read_shift(2);if(he==14e3){for(re[he]=[0,""],re[he][0]=V.read_shift(2);V[V.l];)re[he][1]+=String.fromCharCode(V[V.l]),V.l++;V.l++}}return re}function ue(V,J){var re=Re(5+V.length);re.write_shift(2,14e3),re.write_shift(2,J);for(var q=0;q<V.length;++q){var he=V.charCodeAt(q);re[re.l++]=he>127?95:he}return re[re.l++]=0,re}var Se={0:{n:"BOF",f:PV},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:g},14:{n:"NUMBER",f:v},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:E},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Ce},222:{n:"SHEETNAMELP",f:Ue},65535:{n:""}},se={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:z},23:{n:"NUMBER17",f:k},24:{n:"NUMBER18",f:C},25:{n:"FORMULA19",f:O},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:le},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:U},38:{n:"??"},39:{n:"NUMBER27",f:j},40:{n:"FORMULA28",f:Te},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Ce},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Ne},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:i,to_workbook:e}})(),_1e=/^\s|\s$|[\t\n\r]/;function FV(n,e){if(!e.bookSST)return"";var t=[qr];t[t.length]=nt("sst",null,{xmlns:Y0[0],count:n.Count,uniqueCount:n.Unique});for(var r=0;r!=n.length;++r)if(n[r]!=null){var i=n[r],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(_1e)&&(s+=' xml:space="preserve"'),s+=">"+Hn(i.t)+"</t>"),s+="</si>",t[t.length]=s}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function x1e(n){return[n.read_shift(4),n.read_shift(4)]}function v1e(n,e){return e||(e=Re(8)),e.write_shift(4,n.Count),e.write_shift(4,n.Unique),e}var w1e=hpe;function E1e(n){var e=ks();Ge(e,159,v1e(n));for(var t=0;t<n.length;++t)Ge(e,19,w1e(n[t]));return Ge(e,160),e.end()}function S1e(n){for(var e=[],t=n.split(""),r=0;r<t.length;++r)e[r]=t[r].charCodeAt(0);return e}function jV(n){var e=0,t,r=S1e(n),i=r.length+1,s,a,o,l,u;for(t=nd(i),t[0]=r.length,s=1;s!=i;++s)t[s]=r[s-1];for(s=i-1;s>=0;--s)a=t[s],o=(e&16384)===0?0:1,l=e<<1&32767,u=o|l,e=u^a;return e^52811}var T1e=(function(){function n(i,s){switch(s.type){case"base64":return e(Kl(i),s);case"binary":return e(i,s);case"buffer":return e(Rn&&Buffer.isBuffer(i)?i.toString("binary"):k1(i),s);case"array":return e(Kw(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(h,f){Array.isArray(o)&&(o[f]=[]);for(var g=/\\\w+\b/g,y=0,v,x=-1;v=g.exec(h);){switch(v[0]){case"\\cell":var E=h.slice(y,g.lastIndex-v[0].length);if(E[0]==" "&&(E=E.slice(1)),++x,E.length){var T={v:E,t:"s"};Array.isArray(o)?o[f][x]=T:o[Yn({r:f,c:x})]=T}break}y=g.lastIndex}x>u.e.c&&(u.e.c=x)}),o["!ref"]=Yr(u),o}function t(i,s){return vd(n(i,s),s)}function r(i){for(var s=["{\\rtf1\\ansi"],a=cr(i["!ref"]),o,l=Array.isArray(i),u=a.s.r;u<=a.e.r;++u){s.push("\\trowd\\trautofit1");for(var h=a.s.c;h<=a.e.c;++h)s.push("\\cellx"+(h+1));for(s.push("\\pard\\intbl"),h=a.s.c;h<=a.e.c;++h){var f=Yn({r:u,c:h});o=l?(i[u]||[])[h]:i[f],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(Yl(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:t,to_sheet:n,from_sheet:r}})();function TO(n){for(var e=0,t=1;e!=3;++e)t=t*256+(n[e]>255?255:n[e]<0?0:n[e]);return t.toString(16).toUpperCase().slice(1)}var b1e=6,jl=b1e;function Ev(n){return Math.floor((n+Math.round(128/jl)/256)*jl)}function Sv(n){return Math.floor((n-5)/jl*100+.5)/100}function Wb(n){return Math.round((n*jl+5)/jl*256)/256}function oC(n){n.width?(n.wpx=Ev(n.width),n.wch=Sv(n.wpx),n.MDW=jl):n.wpx?(n.wch=Sv(n.wpx),n.width=Wb(n.wch),n.MDW=jl):typeof n.wch=="number"&&(n.width=Wb(n.wch),n.wpx=Ev(n.width),n.MDW=jl),n.customWidth&&delete n.customWidth}var I1e=96,VV=I1e;function Tv(n){return n*96/VV}function GV(n){return n*VV/96}function A1e(n){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var r=t[0];r<=t[1];++r)n[r]!=null&&(e[e.length]=nt("numFmt",null,{numFmtId:r,formatCode:Hn(n[r])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=nt("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function R1e(n){var e=[];return e[e.length]=nt("cellXfs",null),n.forEach(function(t){e[e.length]=nt("xf",null,t)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=nt("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function BV(n,e){var t=[qr,nt("styleSheet",null,{xmlns:Y0[0],"xmlns:vt":gi.vt})],r;return n.SSF&&(r=A1e(n.SSF))!=null&&(t[t.length]=r),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=R1e(e.cellXfs))&&(t[t.length]=r),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function C1e(n,e){var t=n.read_shift(2),r=Qi(n);return[t,r]}function k1e(n,e,t){t||(t=Re(6+4*e.length)),t.write_shift(2,n),pi(e,t);var r=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),r}function P1e(n,e,t){var r={};r.sz=n.read_shift(2)/20;var i=_pe(n);i.fItalic&&(r.italic=1),i.fCondense&&(r.condense=1),i.fExtend&&(r.extend=1),i.fShadow&&(r.shadow=1),i.fOutline&&(r.outline=1),i.fStrikeout&&(r.strike=1);var s=n.read_shift(2);switch(s===700&&(r.bold=1),n.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var a=n.read_shift(1);a!=0&&(r.underline=a);var o=n.read_shift(1);o>0&&(r.family=o);var l=n.read_shift(1);switch(l>0&&(r.charset=l),n.l++,r.color=ype(n),n.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=Qi(n),r}function M1e(n,e){e||(e=Re(153)),e.write_shift(2,n.sz*20),xpe(n,e),e.write_shift(2,n.bold?700:400);var t=0;n.vertAlign=="superscript"?t=1:n.vertAlign=="subscript"&&(t=2),e.write_shift(2,t),e.write_shift(1,n.underline||0),e.write_shift(1,n.family||0),e.write_shift(1,n.charset||0),e.write_shift(1,0),vv(n.color,e);var r=0;return r=2,e.write_shift(1,r),pi(n.name,e),e.length>e.l?e.slice(0,e.l):e}var N1e=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],zS,L1e=el;function bO(n,e){e||(e=Re(84)),zS||(zS=XR(N1e));var t=zS[n.patternType];t==null&&(t=40),e.write_shift(4,t);var r=0;if(t!=40)for(vv({auto:1},e),vv({auto:1},e);r<12;++r)e.write_shift(4,0);else{for(;r<4;++r)e.write_shift(4,0);for(;r<12;++r)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function O1e(n,e){var t=n.l+e,r=n.read_shift(2),i=n.read_shift(2);return n.l=t,{ixfe:r,numFmtId:i}}function UV(n,e,t){t||(t=Re(16)),t.write_shift(2,e||0),t.write_shift(2,n.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var r=0;return t.write_shift(1,r),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function Xg(n,e){return e||(e=Re(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var D1e=el;function F1e(n,e){return e||(e=Re(51)),e.write_shift(1,0),Xg(null,e),Xg(null,e),Xg(null,e),Xg(null,e),Xg(null,e),e.length>e.l?e.slice(0,e.l):e}function j1e(n,e){return e||(e=Re(52)),e.write_shift(4,n.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),xv(n.name||"",e),e.length>e.l?e.slice(0,e.l):e}function V1e(n,e,t){var r=Re(2052);return r.write_shift(4,n),xv(e,r),xv(t,r),r.length>r.l?r.slice(0,r.l):r}function G1e(n,e){if(e){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&++t}),t!=0&&(Ge(n,615,ao(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&Ge(n,44,k1e(i,e[i]))}),Ge(n,616))}}function B1e(n){var e=1;Ge(n,611,ao(e)),Ge(n,43,M1e({sz:12,color:{theme:1},name:"Calibri",family:2})),Ge(n,612)}function U1e(n){var e=2;Ge(n,603,ao(e)),Ge(n,45,bO({patternType:"none"})),Ge(n,45,bO({patternType:"gray125"})),Ge(n,604)}function z1e(n){var e=1;Ge(n,613,ao(e)),Ge(n,46,F1e()),Ge(n,614)}function $1e(n){var e=1;Ge(n,626,ao(e)),Ge(n,47,UV({numFmtId:0},65535)),Ge(n,627)}function W1e(n,e){Ge(n,617,ao(e.length)),e.forEach(function(t){Ge(n,47,UV(t,0))}),Ge(n,618)}function H1e(n){var e=1;Ge(n,619,ao(e)),Ge(n,48,j1e({xfId:0,name:"Normal"})),Ge(n,620)}function K1e(n){var e=0;Ge(n,505,ao(e)),Ge(n,506)}function Y1e(n){var e=0;Ge(n,508,V1e(e,"TableStyleMedium9","PivotStyleMedium4")),Ge(n,509)}function X1e(n,e){var t=ks();return Ge(t,278),G1e(t,n.SSF),B1e(t),U1e(t),z1e(t),$1e(t),W1e(t,e.cellXfs),H1e(t),K1e(t),Y1e(t),Ge(t,279),t.end()}function zV(n,e){if(e&&e.themeXLSX)return e.themeXLSX;if(n&&typeof n.raw=="string")return n.raw;var t=[qr];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function q1e(n,e){return{flags:n.read_shift(4),version:n.read_shift(4),name:Qi(n)}}function Z1e(n){var e=Re(12+2*n.name.length);return e.write_shift(4,n.flags),e.write_shift(4,n.version),pi(n.name,e),e.slice(0,e.l)}function Q1e(n){for(var e=[],t=n.read_shift(4);t-- >0;)e.push([n.read_shift(4),n.read_shift(4)]);return e}function J1e(n){var e=Re(4+8*n.length);e.write_shift(4,n.length);for(var t=0;t<n.length;++t)e.write_shift(4,n[t][0]),e.write_shift(4,n[t][1]);return e}function eye(n,e){var t=Re(8+2*e.length);return t.write_shift(4,n),pi(e,t),t.slice(0,t.l)}function tye(n){return n.l+=4,n.read_shift(4)!=0}function nye(n,e){var t=Re(8);return t.write_shift(4,n),t.write_shift(4,1),t}function rye(){var n=ks();return Ge(n,332),Ge(n,334,ao(1)),Ge(n,335,Z1e({name:"XLDAPR",version:12e4,flags:3496657072})),Ge(n,336),Ge(n,339,eye(1,"XLDAPR")),Ge(n,52),Ge(n,35,ao(514)),Ge(n,4096,ao(0)),Ge(n,4097,xa(1)),Ge(n,36),Ge(n,53),Ge(n,340),Ge(n,337,nye(1)),Ge(n,51,J1e([[1,0]])),Ge(n,338),Ge(n,333),n.end()}function $V(){var n=[qr];return n.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),n.join("")}function iye(n){var e={};e.i=n.read_shift(4);var t={};t.r=n.read_shift(4),t.c=n.read_shift(4),e.r=Yn(t);var r=n.read_shift(1);return r&2&&(e.l="1"),r&8&&(e.a="1"),e}var Uf=1024;function WV(n,e){for(var t=[21600,21600],r=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),i=[nt("xml",null,{"xmlns:v":Ys.v,"xmlns:o":Ys.o,"xmlns:x":Ys.x,"xmlns:mv":Ys.mv}).replace(/\/>/,">"),nt("o:shapelayout",nt("o:idmap",null,{"v:ext":"edit",data:n}),{"v:ext":"edit"}),nt("v:shapetype",[nt("v:stroke",null,{joinstyle:"miter"}),nt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:r})];Uf<n*1e3;)Uf+=1e3;return e.forEach(function(s){var a=mi(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?nt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=nt("v:fill",l,o),h={on:"t",obscured:"t"};++Uf,i=i.concat(["<v:shape"+Dp({id:"_x0000_s"+Uf,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,nt("v:shadow",null,h),nt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Ci("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),Ci("x:AutoFill","False"),Ci("x:Row",String(a.r)),Ci("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function HV(n){var e=[qr,nt("comments",null,{xmlns:Y0[0]})],t=[];return e.push("<authors>"),n.forEach(function(r){r[1].forEach(function(i){var s=Hn(i.a);t.indexOf(s)==-1&&(t.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&t.indexOf("tc="+i.ID)==-1&&(t.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),n.forEach(function(r){var i=0,s=[];if(r[1][0]&&r[1][0].T&&r[1][0].ID?i=t.indexOf("tc="+r[1][0].ID):r[1].forEach(function(l){l.a&&(i=t.indexOf(Hn(l.a))),s.push(l.t||"")}),e.push('<comment ref="'+r[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(Ci("t",Hn(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;e.push(Ci("t",Hn(a)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function sye(n,e,t){var r=[qr,nt("ThreadedComments",null,{xmlns:gi.TCMNT}).replace(/[\/]>/,">")];return n.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),r.push(nt("threadedComment",Ci("text",a.t||""),l))})}),r.push("</ThreadedComments>"),r.join("")}function aye(n){var e=[qr,nt("personList",null,{xmlns:gi.TCMNT,"xmlns:x":Y0[0]}).replace(/[\/]>/,">")];return n.forEach(function(t,r){e.push(nt("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:t,providerId:"None"}))}),e.push("</personList>"),e.join("")}function oye(n){var e={};e.iauthor=n.read_shift(4);var t=Td(n);return e.rfx=t.s,e.ref=Yn(t.s),n.l+=16,e}function lye(n,e){return e==null&&(e=Re(36)),e.write_shift(4,n[1].iauthor),q0(n[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var cye=Qi;function uye(n){return pi(n.slice(0,54))}function hye(n){var e=ks(),t=[];return Ge(e,628),Ge(e,630),n.forEach(function(r){r[1].forEach(function(i){t.indexOf(i.a)>-1||(t.push(i.a.slice(0,54)),Ge(e,632,uye(i.a)))})}),Ge(e,631),Ge(e,633),n.forEach(function(r){r[1].forEach(function(i){i.iauthor=t.indexOf(i.a);var s={s:mi(r[0]),e:mi(r[0])};Ge(e,635,lye([s,i])),i.t&&i.t.length>0&&Ge(e,637,fpe(i)),Ge(e,636),delete i.iauthor})}),Ge(e,634),Ge(e,629),e.end()}function dye(n,e){e.FullPaths.forEach(function(t,r){if(r!=0){var i=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Xn.utils.cfb_add(n,i,e.FileIndex[r].content)}})}var KV=["xlsb","xlsm","xlam","biff8","xla"],fye=(function(){var n=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function t(r,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,h=a.length>0?parseInt(a,10)|0:0;return o?h+=e.c:--h,l?u+=e.r:--u,i+(o?"":"$")+Zi(h)+(l?"":"$")+Pi(u)}return function(i,s){return e=s,i.replace(n,t)}})(),lC=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,cC=(function(){return function(e,t){return e.replace(lC,function(r,i,s,a,o,l){var u=nC(a)-(s?0:t.c),h=tC(l)-(o?0:t.r),f=h==0?"":o?h+1:"["+h+"]",g=u==0?"":s?u+1:"["+u+"]";return i+"R"+f+"C"+g})}})();function gye(n,e){return n.replace(lC,function(t,r,i,s,a,o){return r+(i=="$"?i+s:Zi(nC(s)+e.c))+(a=="$"?a+o:Pi(tC(o)+e.r))})}function mye(n){return n.length!=1}function zr(n){n.l+=1}function wu(n,e){var t=n.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function YV(n,e,t){var r=2;if(t){if(t.biff>=2&&t.biff<=5)return XV(n);t.biff==12&&(r=4)}var i=n.read_shift(r),s=n.read_shift(r),a=wu(n),o=wu(n);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function XV(n){var e=wu(n),t=wu(n),r=n.read_shift(1),i=n.read_shift(1);return{s:{r:e[0],c:r,cRel:e[1],rRel:e[2]},e:{r:t[0],c:i,cRel:t[1],rRel:t[2]}}}function pye(n,e,t){if(t.biff<8)return XV(n);var r=n.read_shift(t.biff==12?4:2),i=n.read_shift(t.biff==12?4:2),s=wu(n),a=wu(n);return{s:{r,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function qV(n,e,t){if(t&&t.biff>=2&&t.biff<=5)return yye(n);var r=n.read_shift(t&&t.biff==12?4:2),i=wu(n);return{r,c:i[0],cRel:i[1],rRel:i[2]}}function yye(n){var e=wu(n),t=n.read_shift(1);return{r:e[0],c:t,cRel:e[1],rRel:e[2]}}function _ye(n){var e=n.read_shift(2),t=n.read_shift(2);return{r:e,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function xye(n,e,t){var r=t&&t.biff?t.biff:8;if(r>=2&&r<=5)return vye(n);var i=n.read_shift(r>=12?4:2),s=n.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function vye(n){var e=n.read_shift(2),t=n.read_shift(1),r=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,r==1&&e>=8192&&(e=e-16384),i==1&&t>=128&&(t=t-256),{r:e,c:t,cRel:i,rRel:r}}function wye(n,e,t){var r=(n[n.l++]&96)>>5,i=YV(n,t.biff>=2&&t.biff<=5?6:8,t);return[r,i]}function Eye(n,e,t){var r=(n[n.l++]&96)>>5,i=n.read_shift(2,"i"),s=8;if(t)switch(t.biff){case 5:n.l+=12,s=6;break;case 12:s=12;break}var a=YV(n,s,t);return[r,i,a]}function Sye(n,e,t){var r=(n[n.l++]&96)>>5;return n.l+=t&&t.biff>8?12:t.biff<8?6:8,[r]}function Tye(n,e,t){var r=(n[n.l++]&96)>>5,i=n.read_shift(2),s=8;if(t)switch(t.biff){case 5:n.l+=12,s=6;break;case 12:s=12;break}return n.l+=s,[r,i]}function bye(n,e,t){var r=(n[n.l++]&96)>>5,i=pye(n,e-1,t);return[r,i]}function Iye(n,e,t){var r=(n[n.l++]&96)>>5;return n.l+=t.biff==2?6:t.biff==12?14:7,[r]}function IO(n){var e=n[n.l+1]&1,t=1;return n.l+=4,[e,t]}function Aye(n,e,t){n.l+=2;for(var r=n.read_shift(t&&t.biff==2?1:2),i=[],s=0;s<=r;++s)i.push(n.read_shift(t&&t.biff==2?1:2));return i}function Rye(n,e,t){var r=n[n.l+1]&255?1:0;return n.l+=2,[r,n.read_shift(t&&t.biff==2?1:2)]}function Cye(n,e,t){var r=n[n.l+1]&255?1:0;return n.l+=2,[r,n.read_shift(t&&t.biff==2?1:2)]}function kye(n){var e=n[n.l+1]&255?1:0;return n.l+=2,[e,n.read_shift(2)]}function Pye(n,e,t){var r=n[n.l+1]&255?1:0;return n.l+=t&&t.biff==2?3:4,[r]}function ZV(n){var e=n.read_shift(1),t=n.read_shift(1);return[e,t]}function Mye(n){return n.read_shift(2),ZV(n)}function Nye(n){return n.read_shift(2),ZV(n)}function Lye(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=qV(n,0,t);return[r,i]}function Oye(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=xye(n,0,t);return[r,i]}function Dye(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=n.read_shift(2);t&&t.biff==5&&(n.l+=12);var s=qV(n,0,t);return[r,i,s]}function Fye(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=n.read_shift(t&&t.biff<=3?1:2);return[F_e[i],eG[i],r]}function jye(n,e,t){var r=n[n.l++],i=n.read_shift(1),s=t&&t.biff<=3?[r==88?-1:0,n.read_shift(1)]:Vye(n);return[i,(s[0]===0?eG:D_e)[s[1]]]}function Vye(n){return[n[n.l+1]>>7,n.read_shift(2)&32767]}function Gye(n,e,t){n.l+=t&&t.biff==2?3:4}function Bye(n,e,t){if(n.l++,t&&t.biff==12)return[n.read_shift(4,"i"),0];var r=n.read_shift(2),i=n.read_shift(t&&t.biff==2?1:2);return[r,i]}function Uye(n){return n.l++,N1[n.read_shift(1)]}function zye(n){return n.l++,n.read_shift(2)}function $ye(n){return n.l++,n.read_shift(1)!==0}function Wye(n){return n.l++,Z0(n)}function Hye(n,e,t){return n.l++,NV(n,e-1,t)}function Kye(n,e){var t=[n.read_shift(1)];if(e==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=Dpe(n,1)?"TRUE":"FALSE",e!=12&&(n.l+=7);break;case 37:case 16:t[1]=N1[n[n.l]],n.l+=e==12?4:8;break;case 0:n.l+=8;break;case 1:t[1]=Z0(n);break;case 2:t[1]=Gpe(n,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function Yye(n,e,t){for(var r=n.read_shift(t.biff==12?4:2),i=[],s=0;s!=r;++s)i.push((t.biff==12?Td:zpe)(n));return i}function Xye(n,e,t){var r=0,i=0;t.biff==12?(r=n.read_shift(4),i=n.read_shift(4)):(i=1+n.read_shift(1),r=1+n.read_shift(2)),t.biff>=2&&t.biff<8&&(--r,--i==0&&(i=256));for(var s=0,a=[];s!=r&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=Kye(n,t.biff);return a}function qye(n,e,t){var r=n.read_shift(1)>>>5&3,i=!t||t.biff>=8?4:2,s=n.read_shift(i);switch(t.biff){case 2:n.l+=5;break;case 3:case 4:n.l+=8;break;case 5:n.l+=12;break}return[r,0,s]}function Zye(n,e,t){if(t.biff==5)return Qye(n);var r=n.read_shift(1)>>>5&3,i=n.read_shift(2),s=n.read_shift(4);return[r,i,s]}function Qye(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2,"i");n.l+=8;var r=n.read_shift(2);return n.l+=12,[e,t,r]}function Jye(n,e,t){var r=n.read_shift(1)>>>5&3;n.l+=t&&t.biff==2?3:4;var i=n.read_shift(t&&t.biff==2?1:2);return[r,i]}function e_e(n,e,t){var r=n.read_shift(1)>>>5&3,i=n.read_shift(t&&t.biff==2?1:2);return[r,i]}function t_e(n,e,t){var r=n.read_shift(1)>>>5&3;return n.l+=4,t.biff<8&&n.l--,t.biff==12&&(n.l+=2),[r]}function n_e(n,e,t){var r=(n[n.l++]&96)>>5,i=n.read_shift(2),s=4;if(t)switch(t.biff){case 5:s=15;break;case 12:s=6;break}return n.l+=s,[r,i]}var r_e=el,i_e=el,s_e=el;function L1(n,e,t){return n.l+=2,[_ye(n)]}function uC(n){return n.l+=6,[]}var a_e=L1,o_e=uC,l_e=uC,c_e=L1;function QV(n){return n.l+=2,[PV(n),n.read_shift(2)&1]}var u_e=L1,h_e=QV,d_e=uC,f_e=L1,g_e=L1,m_e=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function p_e(n){n.l+=2;var e=n.read_shift(2),t=n.read_shift(2),r=n.read_shift(4),i=n.read_shift(2),s=n.read_shift(2),a=m_e[t>>2&31];return{ixti:e,coltype:t&3,rt:a,idx:r,c:i,C:s}}function y_e(n){return n.l+=2,[n.read_shift(4)]}function __e(n,e,t){return n.l+=5,n.l+=2,n.l+=t.biff==2?1:4,["PTGSHEET"]}function x_e(n,e,t){return n.l+=t.biff==2?4:5,["PTGENDSHEET"]}function v_e(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2);return[e,t]}function w_e(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2);return[e,t]}function E_e(n){return n.l+=4,[0,0]}var AO={1:{n:"PtgExp",f:Bye},2:{n:"PtgTbl",f:s_e},3:{n:"PtgAdd",f:zr},4:{n:"PtgSub",f:zr},5:{n:"PtgMul",f:zr},6:{n:"PtgDiv",f:zr},7:{n:"PtgPower",f:zr},8:{n:"PtgConcat",f:zr},9:{n:"PtgLt",f:zr},10:{n:"PtgLe",f:zr},11:{n:"PtgEq",f:zr},12:{n:"PtgGe",f:zr},13:{n:"PtgGt",f:zr},14:{n:"PtgNe",f:zr},15:{n:"PtgIsect",f:zr},16:{n:"PtgUnion",f:zr},17:{n:"PtgRange",f:zr},18:{n:"PtgUplus",f:zr},19:{n:"PtgUminus",f:zr},20:{n:"PtgPercent",f:zr},21:{n:"PtgParen",f:zr},22:{n:"PtgMissArg",f:zr},23:{n:"PtgStr",f:Hye},26:{n:"PtgSheet",f:__e},27:{n:"PtgEndSheet",f:x_e},28:{n:"PtgErr",f:Uye},29:{n:"PtgBool",f:$ye},30:{n:"PtgInt",f:zye},31:{n:"PtgNum",f:Wye},32:{n:"PtgArray",f:Iye},33:{n:"PtgFunc",f:Fye},34:{n:"PtgFuncVar",f:jye},35:{n:"PtgName",f:qye},36:{n:"PtgRef",f:Lye},37:{n:"PtgArea",f:wye},38:{n:"PtgMemArea",f:Jye},39:{n:"PtgMemErr",f:r_e},40:{n:"PtgMemNoMem",f:i_e},41:{n:"PtgMemFunc",f:e_e},42:{n:"PtgRefErr",f:t_e},43:{n:"PtgAreaErr",f:Sye},44:{n:"PtgRefN",f:Oye},45:{n:"PtgAreaN",f:bye},46:{n:"PtgMemAreaN",f:v_e},47:{n:"PtgMemNoMemN",f:w_e},57:{n:"PtgNameX",f:Zye},58:{n:"PtgRef3d",f:Dye},59:{n:"PtgArea3d",f:Eye},60:{n:"PtgRefErr3d",f:n_e},61:{n:"PtgAreaErr3d",f:Tye},255:{}},S_e={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},T_e={1:{n:"PtgElfLel",f:QV},2:{n:"PtgElfRw",f:f_e},3:{n:"PtgElfCol",f:a_e},6:{n:"PtgElfRwV",f:g_e},7:{n:"PtgElfColV",f:c_e},10:{n:"PtgElfRadical",f:u_e},11:{n:"PtgElfRadicalS",f:d_e},13:{n:"PtgElfColS",f:o_e},15:{n:"PtgElfColSV",f:l_e},16:{n:"PtgElfRadicalLel",f:h_e},25:{n:"PtgList",f:p_e},29:{n:"PtgSxName",f:y_e},255:{}},b_e={0:{n:"PtgAttrNoop",f:E_e},1:{n:"PtgAttrSemi",f:Pye},2:{n:"PtgAttrIf",f:Cye},4:{n:"PtgAttrChoose",f:Aye},8:{n:"PtgAttrGoto",f:Rye},16:{n:"PtgAttrSum",f:Gye},32:{n:"PtgAttrBaxcel",f:IO},33:{n:"PtgAttrBaxcel",f:IO},64:{n:"PtgAttrSpace",f:Mye},65:{n:"PtgAttrSpaceSemi",f:Nye},128:{n:"PtgAttrIfError",f:kye},255:{}};function I_e(n,e,t,r){if(r.biff<8)return el(n,e);for(var i=n.l+e,s=[],a=0;a!==t.length;++a)switch(t[a][0]){case"PtgArray":t[a][1]=Xye(n,0,r),s.push(t[a][1]);break;case"PtgMemArea":t[a][2]=Yye(n,t[a][1],r),s.push(t[a][2]);break;case"PtgExp":r&&r.biff==12&&(t[a][1][1]=n.read_shift(4),s.push(t[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[a][0]}return e=i-n.l,e!==0&&s.push(el(n,e)),s}function A_e(n,e,t){for(var r=n.l+e,i,s,a=[];r!=n.l;)e=r-n.l,s=n[n.l],i=AO[s]||AO[S_e[s]],(s===24||s===25)&&(i=(s===24?T_e:b_e)[n[n.l+1]]),!i||!i.f?el(n,e):a.push([i.n,i.f(n,e,t)]);return a}function R_e(n){for(var e=[],t=0;t<n.length;++t){for(var r=n[t],i=[],s=0;s<r.length;++s){var a=r[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var C_e={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function k_e(n,e){if(!n&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(n)?"'"+n+"'":n}function JV(n,e,t){if(!n)return"SH33TJSERR0";if(t.biff>8&&(!n.XTI||!n.XTI[e]))return n.SheetNames[e];if(!n.XTI)return"SH33TJSERR6";var r=n.XTI[e];if(t.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":n.XTI[e-1];if(!r)return"SH33TJSERR1";var i="";if(t.biff>8)switch(n[r[0]][0]){case 357:return i=r[1]==-1?"#REF":n.SheetNames[r[1]],r[1]==r[2]?i:i+":"+n.SheetNames[r[2]];case 358:return t.SID!=null?n.SheetNames[t.SID]:"SH33TJSSAME"+n[r[0]][0];case 355:default:return"SH33TJSSRC"+n[r[0]][0]}switch(n[r[0]][0][0]){case 1025:return i=r[1]==-1?"#REF":n.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?i:i+":"+n.SheetNames[r[2]];case 14849:return n[r[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return n[r[0]][0][3]?(i=r[1]==-1?"#REF":n[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?i:i+":"+n[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function RO(n,e,t){var r=JV(n,e,t);return r=="#REF"?r:k_e(r,t)}function N0(n,e,t,r,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},o=[],l,u,h,f=0,g=0,y,v="";if(!n[0]||!n[0][0])return"";for(var x=-1,E="",T=0,b=n[0].length;T<b;++T){var I=n[0][T];switch(I[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),u=o.pop(),x>=0){switch(n[0][x][1][0]){case 0:E=Rr(" ",n[0][x][1][1]);break;case 1:E=Rr("\r",n[0][x][1][1]);break;default:if(E="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][x][1][0])}u=u+E,x=-1}o.push(u+C_e[I[0]]+l);break;case"PtgIsect":l=o.pop(),u=o.pop(),o.push(u+" "+l);break;case"PtgUnion":l=o.pop(),u=o.pop(),o.push(u+","+l);break;case"PtgRange":l=o.pop(),u=o.pop(),o.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=Um(I[1][1],a,i),o.push(zm(h,s));break;case"PtgRefN":h=t?Um(I[1][1],t,i):I[1][1],o.push(zm(h,s));break;case"PtgRef3d":f=I[1][1],h=Um(I[1][2],a,i),v=RO(r,f,i),o.push(v+"!"+zm(h,s));break;case"PtgFunc":case"PtgFuncVar":var M=I[1][0],F=I[1][1];M||(M=0),M&=127;var z=M==0?[]:o.slice(-M);o.length-=M,F==="User"&&(F=z.shift()),o.push(F+"("+z.join(",")+")");break;case"PtgBool":o.push(I[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(I[1]);break;case"PtgNum":o.push(String(I[1]));break;case"PtgStr":o.push('"'+I[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(I[1]);break;case"PtgAreaN":y=dO(I[1][1],t?{s:t}:a,i),o.push(BS(y,i));break;case"PtgArea":y=dO(I[1][1],a,i),o.push(BS(y,i));break;case"PtgArea3d":f=I[1][1],y=I[1][2],v=RO(r,f,i),o.push(v+"!"+BS(y,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":g=I[1][2];var P=(r.names||[])[g-1]||(r[0]||[])[g],C=P?P.Name:"SH33TJSNAME"+String(g);C&&C.slice(0,6)=="_xlfn."&&!i.xlfn&&(C=C.slice(6)),o.push(C);break;case"PtgNameX":var k=I[1][1];g=I[1][2];var L;if(i.biff<=5)k<0&&(k=-k),r[k]&&(L=r[k][g]);else{var O="";if(((r[k]||[])[0]||[])[0]==14849||(((r[k]||[])[0]||[])[0]==1025?r[k][g]&&r[k][g].itab>0&&(O=r.SheetNames[r[k][g].itab-1]+"!"):O=r.SheetNames[g-1]+"!"),r[k]&&r[k][g])O+=r[k][g].Name;else if(r[0]&&r[0][g])O+=r[0][g].Name;else{var U=(JV(r,k,i)||"").split(";;");U[g-1]?O=U[g-1]:O+="SH33TJSERRX"}o.push(O);break}L||(L={Name:"SH33TJSERRY"}),o.push(L.Name);break;case"PtgParen":var j="(",Te=")";if(x>=0){switch(E="",n[0][x][1][0]){case 2:j=Rr(" ",n[0][x][1][1])+j;break;case 3:j=Rr("\r",n[0][x][1][1])+j;break;case 4:Te=Rr(" ",n[0][x][1][1])+Te;break;case 5:Te=Rr("\r",n[0][x][1][1])+Te;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][x][1][0])}x=-1}o.push(j+o.pop()+Te);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":h={c:I[1][1],r:I[1][0]};var Ce={c:t.c,r:t.r};if(r.sharedf[Yn(h)]){var Ue=r.sharedf[Yn(h)];o.push(N0(Ue,a,Ce,r,i))}else{var Ne=!1;for(l=0;l!=r.arrayf.length;++l)if(u=r.arrayf[l],!(h.c<u[0].s.c||h.c>u[0].e.c)&&!(h.r<u[0].s.r||h.r>u[0].e.r)){o.push(N0(u[1],a,Ce,r,i)),Ne=!0;break}Ne||o.push(I[1])}break;case"PtgArray":o.push("{"+R_e(I[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=T;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+I[1].idx+"[#"+I[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(I));default:throw new Error("Unrecognized Formula Token: "+String(I))}var le=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&x>=0&&le.indexOf(n[0][T][0])==-1){I=n[0][x];var ue=!0;switch(I[1][0]){case 4:ue=!1;case 0:E=Rr(" ",I[1][1]);break;case 5:ue=!1;case 1:E=Rr("\r",I[1][1]);break;default:if(E="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+I[1][0])}o.push((ue?E:"")+o.pop()+(ue?"":E)),x=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function P_e(n){if(n==null){var e=Re(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof n=="number")return rd(n);return rd(0)}function M_e(n,e,t,r,i){var s=id(e,t,i),a=P_e(n.v),o=Re(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var u=Re(n.bf.length),h=0;h<n.bf.length;++h)u[h]=n.bf[h];var f=Ri([s,a,o,u]);return f}function Yw(n,e,t){var r=n.read_shift(4),i=A_e(n,r,t),s=n.read_shift(4),a=s>0?I_e(n,s,i,t):null;return[i,a]}var N_e=Yw,Xw=Yw,L_e=Yw,O_e=Yw,D_e={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},eG={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},F_e={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function j_e(n){var e="of:="+n.replace(lC,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function V_e(n){return n.replace(/\./,"!")}var $m=typeof Map<"u";function hC(n,e,t){var r=0,i=n.length;if(t){if($m?t.has(e):Object.prototype.hasOwnProperty.call(t,e)){for(var s=$m?t.get(e):t[e];r<s.length;++r)if(n[s[r]].t===e)return n.Count++,s[r]}}else for(;r<i;++r)if(n[r].t===e)return n.Count++,r;return n[i]={t:e},n.Count++,n.Unique++,t&&($m?(t.has(e)||t.set(e,[]),t.get(e).push(i)):(Object.prototype.hasOwnProperty.call(t,e)||(t[e]=[]),t[e].push(i))),i}function qw(n,e){var t={min:n+1,max:n+1},r=-1;return e.MDW&&(jl=e.MDW),e.width!=null?t.customWidth=1:e.wpx!=null?r=Sv(e.wpx):e.wch!=null&&(r=e.wch),r>-1?(t.width=Wb(r),t.customWidth=1):e.width!=null&&(t.width=e.width),e.hidden&&(t.hidden=!0),e.level!=null&&(t.outlineLevel=t.level=e.level),t}function tG(n,e){if(n){var t=[.7,.7,.75,.75,.3,.3];n.left==null&&(n.left=t[0]),n.right==null&&(n.right=t[1]),n.top==null&&(n.top=t[2]),n.bottom==null&&(n.bottom=t[3]),n.header==null&&(n.header=t[4]),n.footer==null&&(n.footer=t[5])}}function ku(n,e,t){var r=t.revssf[e.z!=null?e.z:"General"],i=60,s=n.length;if(r==null&&t.ssf){for(;i<392;++i)if(t.ssf[i]==null){q7(e.z,i),t.ssf[i]=e.z,t.revssf[e.z]=r=i;break}}for(i=0;i!=s;++i)if(n[i].numFmtId===r)return i;return n[s]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function G_e(n,e,t){if(n&&n["!ref"]){var r=cr(n["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+t+"): "+n["!ref"])}}function B_e(n){if(n.length===0)return"";for(var e='<mergeCells count="'+n.length+'">',t=0;t!=n.length;++t)e+='<mergeCell ref="'+Yr(n[t])+'"/>';return e+"</mergeCells>"}function U_e(n,e,t,r,i){var s=!1,a={},o=null;if(r.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[t];try{e.Workbook&&(l=e.Workbook.Sheets[t].CodeName||l)}catch{}s=!0,a.codeName=Op(Hn(l))}if(n&&n["!outline"]){var u={summaryBelow:1,summaryRight:1};n["!outline"].above&&(u.summaryBelow=0),n["!outline"].left&&(u.summaryRight=0),o=(o||"")+nt("outlinePr",null,u)}!s&&!o||(i[i.length]=nt("sheetPr",o,a))}var z_e=["objects","scenarios","selectLockedCells","selectUnlockedCells"],$_e=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function W_e(n){var e={sheet:1};return z_e.forEach(function(t){n[t]!=null&&n[t]&&(e[t]="1")}),$_e.forEach(function(t){n[t]!=null&&!n[t]&&(e[t]="0")}),n.password&&(e.password=jV(n.password).toString(16).toUpperCase()),nt("sheetProtection",null,e)}function H_e(n){return tG(n),nt("pageMargins",null,n)}function K_e(n,e){for(var t=["<cols>"],r,i=0;i!=e.length;++i)(r=e[i])&&(t[t.length]=nt("col",null,qw(i,r)));return t[t.length]="</cols>",t.join("")}function Y_e(n,e,t,r){var i=typeof n.ref=="string"?n.ref:Yr(n.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var s=t.Workbook.Names,a=ia(i);a.s.r==a.e.r&&(a.e.r=ia(e["!ref"]).e.r,i=Yr(a));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==r){l.Ref="'"+t.SheetNames[r]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+t.SheetNames[r]+"'!"+i}),nt("autoFilter",null,{ref:i})}function X_e(n,e,t,r){var i={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),nt("sheetViews",nt("sheetView",null,i),{})}function q_e(n,e,t,r){if(n.c&&t["!comments"].push([e,n.c]),n.v===void 0&&typeof n.f!="string"||n.t==="z"&&!n.f)return"";var i="",s=n.t,a=n.v;if(n.t!=="z")switch(n.t){case"b":i=n.v?"1":"0";break;case"n":i=""+n.v;break;case"e":i=N1[n.v];break;case"d":r&&r.cellDates?i=hs(n.v,-1).toISOString():(n=Ns(n),n.t="n",i=""+(n.v=Ms(hs(n.v)))),typeof n.z>"u"&&(n.z=Pr[14]);break;default:i=n.v;break}var o=Ci("v",Hn(i)),l={r:e},u=ku(r.cellXfs,n,r);switch(u!==0&&(l.s=u),n.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(n.v==null){delete n.t;break}if(n.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){o=Ci("v",""+hC(r.Strings,n.v,r.revStrings)),l.t="s";break}l.t="str";break}if(n.t!=s&&(n.t=s,n.v=a),typeof n.f=="string"&&n.f){var h=n.F&&n.F.slice(0,e.length)==e?{t:"array",ref:n.F}:null;o=nt("f",Hn(n.f),h)+(n.v!=null?o:"")}return n.l&&t["!links"].push([e,n.l]),n.D&&(l.cm=1),nt("c",o,l)}function Z_e(n,e,t,r){var i=[],s=[],a=cr(n["!ref"]),o="",l,u="",h=[],f=0,g=0,y=n["!rows"],v=Array.isArray(n),x={r:u},E,T=-1;for(g=a.s.c;g<=a.e.c;++g)h[g]=Zi(g);for(f=a.s.r;f<=a.e.r;++f){for(s=[],u=Pi(f),g=a.s.c;g<=a.e.c;++g){l=h[g]+u;var b=v?(n[f]||[])[g]:n[l];b!==void 0&&(o=q_e(b,l,n,e))!=null&&s.push(o)}(s.length>0||y&&y[f])&&(x={r:u},y&&y[f]&&(E=y[f],E.hidden&&(x.hidden=1),T=-1,E.hpx?T=Tv(E.hpx):E.hpt&&(T=E.hpt),T>-1&&(x.ht=T,x.customHeight=1),E.level&&(x.outlineLevel=E.level)),i[i.length]=nt("row",s.join(""),x))}if(y)for(;f<y.length;++f)y&&y[f]&&(x={r:f+1},E=y[f],E.hidden&&(x.hidden=1),T=-1,E.hpx?T=Tv(E.hpx):E.hpt&&(T=E.hpt),T>-1&&(x.ht=T,x.customHeight=1),E.level&&(x.outlineLevel=E.level),i[i.length]=nt("row","",x));return i.join("")}function nG(n,e,t,r){var i=[qr,nt("worksheet",null,{xmlns:Y0[0],"xmlns:r":gi.r})],s=t.SheetNames[n],a=0,o="",l=t.Sheets[s];l==null&&(l={});var u=l["!ref"]||"A1",h=cr(u);if(h.e.c>16383||h.e.r>1048575){if(e.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575),u=Yr(h)}r||(r={}),l["!comments"]=[];var f=[];U_e(l,t,n,e,i),i[i.length]=nt("dimension",null,{ref:u}),i[i.length]=X_e(l,e,n,t),e.sheetFormat&&(i[i.length]=nt("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=K_e(l,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=Z_e(l,e),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=W_e(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=Y_e(l["!autofilter"],l,t,n)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=B_e(l["!merges"]));var g=-1,y,v=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(x){x[1].Target&&(y={ref:x[0]},x[1].Target.charAt(0)!="#"&&(v=Un(r,-1,Hn(x[1].Target).replace(/#.*$/,""),Sn.HLINK),y["r:id"]="rId"+v),(g=x[1].Target.indexOf("#"))>-1&&(y.location=Hn(x[1].Target.slice(g+1))),x[1].Tooltip&&(y.tooltip=Hn(x[1].Tooltip)),i[i.length]=nt("hyperlink",null,y))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=H_e(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=Ci("ignoredErrors",nt("ignoredError",null,{numberStoredAsText:1,sqref:u}))),f.length>0&&(v=Un(r,-1,"../drawings/drawing"+(n+1)+".xml",Sn.DRAW),i[i.length]=nt("drawing",null,{"r:id":"rId"+v}),l["!drawing"]=f),l["!comments"].length>0&&(v=Un(r,-1,"../drawings/vmlDrawing"+(n+1)+".vml",Sn.VML),i[i.length]=nt("legacyDrawing",null,{"r:id":"rId"+v}),l["!legacy"]=v),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function Q_e(n,e){var t={},r=n.l+e;t.r=n.read_shift(4),n.l+=4;var i=n.read_shift(2);n.l+=1;var s=n.read_shift(1);return n.l=r,s&7&&(t.level=s&7),s&16&&(t.hidden=!0),s&32&&(t.hpt=i/20),t}function J_e(n,e,t){var r=Re(145),i=(t["!rows"]||[])[n]||{};r.write_shift(4,n),r.write_shift(4,0);var s=320;i.hpx?s=Tv(i.hpx)*20:i.hpt&&(s=i.hpt*20),r.write_shift(2,s),r.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),r.write_shift(1,a),r.write_shift(1,0);var o=0,l=r.l;r.l+=4;for(var u={r:n,c:0},h=0;h<16;++h)if(!(e.s.c>h+1<<10||e.e.c<h<<10)){for(var f=-1,g=-1,y=h<<10;y<h+1<<10;++y){u.c=y;var v=Array.isArray(t)?(t[u.r]||[])[u.c]:t[Yn(u)];v&&(f<0&&(f=y),g=y)}f<0||(++o,r.write_shift(4,f),r.write_shift(4,g))}var x=r.l;return r.l=l,r.write_shift(4,o),r.l=x,r.length>r.l?r.slice(0,r.l):r}function exe(n,e,t,r){var i=J_e(r,t,e);(i.length>17||(e["!rows"]||[])[r])&&Ge(n,0,i)}var txe=Td,nxe=q0;function rxe(){}function ixe(n,e){var t={},r=n[n.l];return++n.l,t.above=!(r&64),t.left=!(r&128),n.l+=18,t.name=gpe(n),t}function sxe(n,e,t){t==null&&(t=Re(84+4*n.length));var r=192;e&&(e.above&&(r&=-65),e.left&&(r&=-129)),t.write_shift(1,r);for(var i=1;i<3;++i)t.write_shift(1,0);return vv({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),yV(n,t),t.slice(0,t.l)}function axe(n){var e=Ma(n);return[e]}function oxe(n,e,t){return t==null&&(t=Re(8)),wd(e,t)}function lxe(n){var e=Ed(n);return[e]}function cxe(n,e,t){return t==null&&(t=Re(4)),Sd(e,t)}function uxe(n){var e=Ma(n),t=n.read_shift(1);return[e,t,"b"]}function hxe(n,e,t){return t==null&&(t=Re(9)),wd(e,t),t.write_shift(1,n.v?1:0),t}function dxe(n){var e=Ed(n),t=n.read_shift(1);return[e,t,"b"]}function fxe(n,e,t){return t==null&&(t=Re(5)),Sd(e,t),t.write_shift(1,n.v?1:0),t}function gxe(n){var e=Ma(n),t=n.read_shift(1);return[e,t,"e"]}function mxe(n,e,t){return t==null&&(t=Re(9)),wd(e,t),t.write_shift(1,n.v),t}function pxe(n){var e=Ed(n),t=n.read_shift(1);return[e,t,"e"]}function yxe(n,e,t){return t==null&&(t=Re(8)),Sd(e,t),t.write_shift(1,n.v),t.write_shift(2,0),t.write_shift(1,0),t}function _xe(n){var e=Ma(n),t=n.read_shift(4);return[e,t,"s"]}function xxe(n,e,t){return t==null&&(t=Re(12)),wd(e,t),t.write_shift(4,e.v),t}function vxe(n){var e=Ed(n),t=n.read_shift(4);return[e,t,"s"]}function wxe(n,e,t){return t==null&&(t=Re(8)),Sd(e,t),t.write_shift(4,e.v),t}function Exe(n){var e=Ma(n),t=Z0(n);return[e,t,"n"]}function Sxe(n,e,t){return t==null&&(t=Re(16)),wd(e,t),rd(n.v,t),t}function Txe(n){var e=Ed(n),t=Z0(n);return[e,t,"n"]}function bxe(n,e,t){return t==null&&(t=Re(12)),Sd(e,t),rd(n.v,t),t}function Ixe(n){var e=Ma(n),t=_V(n);return[e,t,"n"]}function Axe(n,e,t){return t==null&&(t=Re(12)),wd(e,t),xV(n.v,t),t}function Rxe(n){var e=Ed(n),t=_V(n);return[e,t,"n"]}function Cxe(n,e,t){return t==null&&(t=Re(8)),Sd(e,t),xV(n.v,t),t}function kxe(n){var e=Ma(n),t=rC(n);return[e,t,"is"]}function Pxe(n){var e=Ma(n),t=Qi(n);return[e,t,"str"]}function Mxe(n,e,t){return t==null&&(t=Re(12+4*n.v.length)),wd(e,t),pi(n.v,t),t.length>t.l?t.slice(0,t.l):t}function Nxe(n){var e=Ed(n),t=Qi(n);return[e,t,"str"]}function Lxe(n,e,t){return t==null&&(t=Re(8+4*n.v.length)),Sd(e,t),pi(n.v,t),t.length>t.l?t.slice(0,t.l):t}function Oxe(n,e,t){var r=n.l+e,i=Ma(n);i.r=t["!row"];var s=n.read_shift(1),a=[i,s,"b"];if(t.cellFormula){n.l+=2;var o=Xw(n,r-n.l,t);a[3]=N0(o,null,i,t.supbooks,t)}else n.l=r;return a}function Dxe(n,e,t){var r=n.l+e,i=Ma(n);i.r=t["!row"];var s=n.read_shift(1),a=[i,s,"e"];if(t.cellFormula){n.l+=2;var o=Xw(n,r-n.l,t);a[3]=N0(o,null,i,t.supbooks,t)}else n.l=r;return a}function Fxe(n,e,t){var r=n.l+e,i=Ma(n);i.r=t["!row"];var s=Z0(n),a=[i,s,"n"];if(t.cellFormula){n.l+=2;var o=Xw(n,r-n.l,t);a[3]=N0(o,null,i,t.supbooks,t)}else n.l=r;return a}function jxe(n,e,t){var r=n.l+e,i=Ma(n);i.r=t["!row"];var s=Qi(n),a=[i,s,"str"];if(t.cellFormula){n.l+=2;var o=Xw(n,r-n.l,t);a[3]=N0(o,null,i,t.supbooks,t)}else n.l=r;return a}var Vxe=Td,Gxe=q0;function Bxe(n,e){return e==null&&(e=Re(4)),e.write_shift(4,n),e}function Uxe(n,e){var t=n.l+e,r=Td(n),i=iC(n),s=Qi(n),a=Qi(n),o=Qi(n);n.l=t;var l={rfx:r,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function zxe(n,e){var t=Re(50+4*(n[1].Target.length+(n[1].Tooltip||"").length));q0({s:mi(n[0]),e:mi(n[0])},t),sC("rId"+e,t);var r=n[1].Target.indexOf("#"),i=r==-1?"":n[1].Target.slice(r+1);return pi(i||"",t),pi(n[1].Tooltip||"",t),pi("",t),t.slice(0,t.l)}function $xe(){}function Wxe(n,e,t){var r=n.l+e,i=vV(n),s=n.read_shift(1),a=[i];if(a[2]=s,t.cellFormula){var o=N_e(n,r-n.l,t);a[1]=o}else n.l=r;return a}function Hxe(n,e,t){var r=n.l+e,i=Td(n),s=[i];if(t.cellFormula){var a=O_e(n,r-n.l,t);s[1]=a,n.l=r}else n.l=r;return s}function Kxe(n,e,t){t==null&&(t=Re(18));var r=qw(n,e);t.write_shift(-4,n),t.write_shift(-4,n),t.write_shift(4,(r.width||10)*256),t.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof r.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),t.write_shift(2,i),t}var rG=["left","right","top","bottom","header","footer"];function Yxe(n){var e={};return rG.forEach(function(t){e[t]=Z0(n)}),e}function Xxe(n,e){return e==null&&(e=Re(48)),tG(n),rG.forEach(function(t){rd(n[t],e)}),e}function qxe(n){var e=n.read_shift(2);return n.l+=28,{RTL:e&32}}function Zxe(n,e,t){t==null&&(t=Re(30));var r=924;return(((e||{}).Views||[])[0]||{}).RTL&&(r|=32),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function Qxe(n){var e=Re(24);return e.write_shift(4,4),e.write_shift(4,1),q0(n,e),e}function Jxe(n,e){return e==null&&(e=Re(66)),e.write_shift(2,n.password?jV(n.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?e.write_shift(4,n[t[0]]!=null&&!n[t[0]]?1:0):e.write_shift(4,n[t[0]]!=null&&n[t[0]]?0:1)}),e}function eve(){}function tve(){}function nve(n,e,t,r,i,s,a){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=Ns(e),e.z=e.z||Pr[14],e.v=Ms(hs(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var l={r:t,c:r};switch(l.s=ku(i.cellXfs,e,i),e.l&&s["!links"].push([Yn(l),e.l]),e.c&&s["!comments"].push([Yn(l),e.c]),e.t){case"s":case"str":return i.bookSST?(o=hC(i.Strings,e.v,i.revStrings),l.t="s",l.v=o,a?Ge(n,18,wxe(e,l)):Ge(n,7,xxe(e,l))):(l.t="str",a?Ge(n,17,Lxe(e,l)):Ge(n,6,Mxe(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?Ge(n,13,Cxe(e,l)):Ge(n,2,Axe(e,l)):a?Ge(n,16,bxe(e,l)):Ge(n,5,Sxe(e,l)),!0;case"b":return l.t="b",a?Ge(n,15,fxe(e,l)):Ge(n,4,hxe(e,l)),!0;case"e":return l.t="e",a?Ge(n,14,yxe(e,l)):Ge(n,3,mxe(e,l)),!0}return a?Ge(n,12,cxe(e,l)):Ge(n,1,oxe(e,l)),!0}function rve(n,e,t,r){var i=cr(e["!ref"]||"A1"),s,a="",o=[];Ge(n,145);var l=Array.isArray(e),u=i.e.r;e["!rows"]&&(u=Math.max(i.e.r,e["!rows"].length-1));for(var h=i.s.r;h<=u;++h){a=Pi(h),exe(n,e,i,h);var f=!1;if(h<=i.e.r)for(var g=i.s.c;g<=i.e.c;++g){h===i.s.r&&(o[g]=Zi(g)),s=o[g]+a;var y=l?(e[h]||[])[g]:e[s];if(!y){f=!1;continue}f=nve(n,y,h,g,r,e,f)}}Ge(n,146)}function ive(n,e){!e||!e["!merges"]||(Ge(n,177,Bxe(e["!merges"].length)),e["!merges"].forEach(function(t){Ge(n,176,Gxe(t))}),Ge(n,178))}function sve(n,e){!e||!e["!cols"]||(Ge(n,390),e["!cols"].forEach(function(t,r){t&&Ge(n,60,Kxe(r,t))}),Ge(n,391))}function ave(n,e){!e||!e["!ref"]||(Ge(n,648),Ge(n,649,Qxe(cr(e["!ref"]))),Ge(n,650))}function ove(n,e,t){e["!links"].forEach(function(r){if(r[1].Target){var i=Un(t,-1,r[1].Target.replace(/#.*$/,""),Sn.HLINK);Ge(n,494,zxe(r,i))}}),delete e["!links"]}function lve(n,e,t,r){if(e["!comments"].length>0){var i=Un(r,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Sn.VML);Ge(n,551,sC("rId"+i)),e["!legacy"]=i}}function cve(n,e,t,r){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:Yr(i.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var a=t.Workbook.Names,o=ia(s);o.s.r==o.e.r&&(o.e.r=ia(e["!ref"]).e.r,s=Yr(o));for(var l=0;l<a.length;++l){var u=a[l];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==r){u.Ref="'"+t.SheetNames[r]+"'!"+s;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+t.SheetNames[r]+"'!"+s}),Ge(n,161,q0(cr(s))),Ge(n,162)}}function uve(n,e,t){Ge(n,133),Ge(n,137,Zxe(e,t)),Ge(n,138),Ge(n,134)}function hve(n,e){e["!protect"]&&Ge(n,535,Jxe(e["!protect"]))}function dve(n,e,t,r){var i=ks(),s=t.SheetNames[n],a=t.Sheets[s]||{},o=s;try{t&&t.Workbook&&(o=t.Workbook.Sheets[n].CodeName||o)}catch{}var l=cr(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],Ge(i,129),(t.vbaraw||a["!outline"])&&Ge(i,147,sxe(o,a["!outline"])),Ge(i,148,nxe(l)),uve(i,a,t.Workbook),sve(i,a),rve(i,a,n,e),hve(i,a),cve(i,a,t,n),ive(i,a),ove(i,a,r),a["!margins"]&&Ge(i,476,Xxe(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&ave(i,a),lve(i,a,n,r),Ge(i,130),i.end()}function fve(n,e){n.l+=10;var t=Qi(n);return{name:t}}var gve=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function mve(n){return!n.Workbook||!n.Workbook.WBProps?"false":Hme(n.Workbook.WBProps.date1904)?"true":"false"}var pve="][*?/\\".split("");function iG(n,e){if(n.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return pve.forEach(function(r){if(n.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function yve(n,e,t){n.forEach(function(r,i){iG(r);for(var s=0;s<i;++s)if(r==n[s])throw new Error("Duplicate Sheet Name: "+r);if(t){var a=e&&e[i]&&e[i].CodeName||r;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function _ve(n){if(!n||!n.SheetNames||!n.Sheets)throw new Error("Invalid Workbook");if(!n.SheetNames.length)throw new Error("Workbook is empty");var e=n.Workbook&&n.Workbook.Sheets||[];yve(n.SheetNames,e,!!n.vbaraw);for(var t=0;t<n.SheetNames.length;++t)G_e(n.Sheets[n.SheetNames[t]],n.SheetNames[t],t)}function sG(n){var e=[qr];e[e.length]=nt("workbook",null,{xmlns:Y0[0],"xmlns:r":gi.r});var t=n.Workbook&&(n.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};n.Workbook&&n.Workbook.WBProps&&(gve.forEach(function(o){n.Workbook.WBProps[o[0]]!=null&&n.Workbook.WBProps[o[0]]!=o[1]&&(r[o[0]]=n.Workbook.WBProps[o[0]])}),n.Workbook.WBProps.CodeName&&(r.codeName=n.Workbook.WBProps.CodeName,delete r.CodeName)),e[e.length]=nt("workbookPr",null,r);var i=n.Workbook&&n.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=n.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==n.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=n.SheetNames.length;++s){var a={name:Hn(n.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=nt("sheet",null,a)}return e[e.length]="</sheets>",t&&(e[e.length]="<definedNames>",n.Workbook&&n.Workbook.Names&&n.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(e[e.length]=nt("definedName",Hn(o.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function xve(n,e){var t={};return t.Hidden=n.read_shift(4),t.iTabID=n.read_shift(4),t.strRelID=$b(n),t.name=Qi(n),t}function vve(n,e){return e||(e=Re(127)),e.write_shift(4,n.Hidden),e.write_shift(4,n.iTabID),sC(n.strRelID,e),pi(n.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function wve(n,e){var t={},r=n.read_shift(4);t.defaultThemeVersion=n.read_shift(4);var i=e>8?Qi(n):"";return i.length>0&&(t.CodeName=i),t.autoCompressPictures=!!(r&65536),t.backupFile=!!(r&64),t.checkCompatibility=!!(r&4096),t.date1904=!!(r&1),t.filterPrivacy=!!(r&8),t.hidePivotFieldList=!!(r&1024),t.promptedSolutions=!!(r&16),t.publishItems=!!(r&2048),t.refreshAllConnections=!!(r&262144),t.saveExternalLinkValues=!!(r&128),t.showBorderUnselectedTables=!!(r&4),t.showInkAnnotation=!!(r&32),t.showObjects=["all","placeholders","none"][r>>13&3],t.showPivotChartFilter=!!(r&32768),t.updateLinks=["userSet","never","always"][r>>8&3],t}function Eve(n,e){e||(e=Re(72));var t=0;return n&&n.filterPrivacy&&(t|=8),e.write_shift(4,t),e.write_shift(4,0),yV(n&&n.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function Sve(n,e,t){var r=n.l+e;n.l+=4,n.l+=1;var i=n.read_shift(4),s=mpe(n),a=L_e(n,0,t),o=iC(n);n.l=r;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function Tve(n,e){Ge(n,143);for(var t=0;t!=e.SheetNames.length;++t){var r=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[t]&&e.Workbook.Sheets[t].Hidden||0,i={Hidden:r,iTabID:t+1,strRelID:"rId"+(t+1),name:e.SheetNames[t]};Ge(n,156,vve(i))}Ge(n,144)}function bve(n,e){e||(e=Re(127));for(var t=0;t!=4;++t)e.write_shift(4,0);return pi("SheetJS",e),pi(dv.version,e),pi(dv.version,e),pi("7262",e),e.length>e.l?e.slice(0,e.l):e}function Ive(n,e){e||(e=Re(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,n),e.write_shift(4,n);var t=120;return e.write_shift(1,t),e.length>e.l?e.slice(0,e.l):e}function Ave(n,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var t=e.Workbook.Sheets,r=0,i=-1,s=-1;r<t.length;++r)!t[r]||!t[r].Hidden&&i==-1?i=r:t[r].Hidden==1&&s==-1&&(s=r);s>i||(Ge(n,135),Ge(n,158,Ive(i)),Ge(n,136))}}function Rve(n,e){var t=ks();return Ge(t,131),Ge(t,128,bve()),Ge(t,153,Eve(n.Workbook&&n.Workbook.WBProps||null)),Ave(t,n),Tve(t,n),Ge(t,132),t.end()}function Cve(n,e,t){return(e.slice(-4)===".bin"?Rve:sG)(n)}function kve(n,e,t,r,i){return(e.slice(-4)===".bin"?dve:nG)(n,t,r,i)}function Pve(n,e,t){return(e.slice(-4)===".bin"?X1e:BV)(n,t)}function Mve(n,e,t){return(e.slice(-4)===".bin"?E1e:FV)(n,t)}function Nve(n,e,t){return(e.slice(-4)===".bin"?hye:HV)(n)}function Lve(n){return(n.slice(-4)===".bin"?rye:$V)()}function Ove(n,e){var t=[];return n.Props&&t.push(Ppe(n.Props,e)),n.Custprops&&t.push(Mpe(n.Props,n.Custprops)),t.join("")}function Dve(){return""}function Fve(n,e){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(r,i){var s=[];s.push(nt("NumberFormat",null,{"ss:Format":Hn(Pr[r.numFmtId])}));var a={"ss:ID":"s"+(21+i)};t.push(nt("Style",s.join(""),a))}),nt("Styles",t.join(""))}function aG(n){return nt("NamedRange",null,{"ss:Name":n.Name,"ss:RefersTo":"="+cC(n.Ref,{r:0,c:0})})}function jve(n){if(!((n||{}).Workbook||{}).Names)return"";for(var e=n.Workbook.Names,t=[],r=0;r<e.length;++r){var i=e[r];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||t.push(aG(i)))}return nt("Names",t.join(""))}function Vve(n,e,t,r){if(!n||!((r||{}).Workbook||{}).Names)return"";for(var i=r.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==t&&(o.Name.match(/^_xlfn\./)||s.push(aG(o)))}return s.join("")}function Gve(n,e,t,r){if(!n)return"";var i=[];if(n["!margins"]&&(i.push("<PageSetup>"),n["!margins"].header&&i.push(nt("Header",null,{"x:Margin":n["!margins"].header})),n["!margins"].footer&&i.push(nt("Footer",null,{"x:Margin":n["!margins"].footer})),i.push(nt("PageMargins",null,{"x:Bottom":n["!margins"].bottom||"0.75","x:Left":n["!margins"].left||"0.7","x:Right":n["!margins"].right||"0.7","x:Top":n["!margins"].top||"0.75"})),i.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[t])if(r.Workbook.Sheets[t].Hidden)i.push(nt("Visible",r.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<t&&!(r.Workbook.Sheets[s]&&!r.Workbook.Sheets[s].Hidden);++s);s==t&&i.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),n["!protect"]&&(i.push(Ci("ProtectContents","True")),n["!protect"].objects&&i.push(Ci("ProtectObjects","True")),n["!protect"].scenarios&&i.push(Ci("ProtectScenarios","True")),n["!protect"].selectLockedCells!=null&&!n["!protect"].selectLockedCells?i.push(Ci("EnableSelection","NoSelection")):n["!protect"].selectUnlockedCells!=null&&!n["!protect"].selectUnlockedCells&&i.push(Ci("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){n["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":nt("WorksheetOptions",i.join(""),{xmlns:Ys.x})}function Bve(n){return n.map(function(e){var t=Wme(e.t||""),r=nt("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return nt("Comment",r,{"ss:Author":e.a})}).join("")}function Uve(n,e,t,r,i,s,a){if(!n||n.v==null&&n.f==null)return"";var o={};if(n.f&&(o["ss:Formula"]="="+Hn(cC(n.f,a))),n.F&&n.F.slice(0,e.length)==e){var l=mi(n.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(n.l&&n.l.Target&&(o["ss:HRef"]=Hn(n.l.Target),n.l.Tooltip&&(o["x:HRefScreenTip"]=Hn(n.l.Tooltip))),t["!merges"])for(var u=t["!merges"],h=0;h!=u.length;++h)u[h].s.c!=a.c||u[h].s.r!=a.r||(u[h].e.c>u[h].s.c&&(o["ss:MergeAcross"]=u[h].e.c-u[h].s.c),u[h].e.r>u[h].s.r&&(o["ss:MergeDown"]=u[h].e.r-u[h].s.r));var f="",g="";switch(n.t){case"z":if(!r.sheetStubs)return"";break;case"n":f="Number",g=String(n.v);break;case"b":f="Boolean",g=n.v?"1":"0";break;case"e":f="Error",g=N1[n.v];break;case"d":f="DateTime",g=new Date(n.v).toISOString(),n.z==null&&(n.z=n.z||Pr[14]);break;case"s":f="String",g=$me(n.v||"");break}var y=ku(r.cellXfs,n,r);o["ss:StyleID"]="s"+(21+y),o["ss:Index"]=a.c+1;var v=n.v!=null?g:"",x=n.t=="z"?"":'<Data ss:Type="'+f+'">'+v+"</Data>";return(n.c||[]).length>0&&(x+=Bve(n.c)),nt("Cell",x,o)}function zve(n,e){var t='<Row ss:Index="'+(n+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=GV(e.hpt)),e.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(t+=' ss:Hidden="1"')),t+">"}function $ve(n,e,t,r){if(!n["!ref"])return"";var i=cr(n["!ref"]),s=n["!merges"]||[],a=0,o=[];n["!cols"]&&n["!cols"].forEach(function(E,T){oC(E);var b=!!E.width,I=qw(T,E),M={"ss:Index":T+1};b&&(M["ss:Width"]=Ev(I.width)),E.hidden&&(M["ss:Hidden"]="1"),o.push(nt("Column",null,M))});for(var l=Array.isArray(n),u=i.s.r;u<=i.e.r;++u){for(var h=[zve(u,(n["!rows"]||[])[u])],f=i.s.c;f<=i.e.c;++f){var g=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>f)&&!(s[a].s.r>u)&&!(s[a].e.c<f)&&!(s[a].e.r<u)){(s[a].s.c!=f||s[a].s.r!=u)&&(g=!0);break}if(!g){var y={r:u,c:f},v=Yn(y),x=l?(n[u]||[])[f]:n[v];h.push(Uve(x,v,n,e,t,r,y))}}h.push("</Row>"),h.length>2&&o.push(h.join(""))}return o.join("")}function Wve(n,e,t){var r=[],i=t.SheetNames[n],s=t.Sheets[i],a=s?Vve(s,e,n,t):"";return a.length>0&&r.push("<Names>"+a+"</Names>"),a=s?$ve(s,e,n,t):"",a.length>0&&r.push("<Table>"+a+"</Table>"),r.push(Gve(s,e,n,t)),r.join("")}function Hve(n,e){e||(e={}),n.SSF||(n.SSF=Ns(Pr)),n.SSF&&(Ww(),$w(n.SSF),e.revssf=Hw(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF,e.cellXfs=[],ku(e.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(Ove(n,e)),t.push(Dve()),t.push(""),t.push("");for(var r=0;r<n.SheetNames.length;++r)t.push(nt("Worksheet",Wve(r,e,n),{"ss:Name":Hn(n.SheetNames[r])}));return t[2]=Fve(n,e),t[3]=jve(n),qr+nt("Workbook",t.join(""),{xmlns:Ys.ss,"xmlns:o":Ys.o,"xmlns:x":Ys.x,"xmlns:ss":Ys.ss,"xmlns:dt":Ys.dt,"xmlns:html":Ys.html})}var $S={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Kve(n,e){var t=[],r=[],i=[],s=0,a,o=tO(gO,"n"),l=tO(mO,"n");if(n.Props)for(a=Mi(n.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?t:Object.prototype.hasOwnProperty.call(l,a[s])?r:i).push([a[s],n.Props[a[s]]]);if(n.Custprops)for(a=Mi(n.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(n.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?t:Object.prototype.hasOwnProperty.call(l,a[s])?r:i).push([a[s],n.Custprops[a[s]]]);var u=[];for(s=0;s<i.length;++s)kV.indexOf(i[s][0])>-1||AV.indexOf(i[s][0])>-1||i[s][1]!=null&&u.push(i[s]);r.length&&Xn.utils.cfb_add(e,"/SummaryInformation",vO(r,$S.SI,l,mO)),(t.length||u.length)&&Xn.utils.cfb_add(e,"/DocumentSummaryInformation",vO(t,$S.DSI,o,gO,u.length?u:null,$S.UDI))}function Yve(n,e){var t=e||{},r=Xn.utils.cfb_new({root:"R"}),i="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":i="/Workbook",t.biff=8;break;case"biff5":i="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return Xn.utils.cfb_add(r,i,oG(n,t)),t.biff==8&&(n.Props||n.Custprops)&&Kve(n,r),t.biff==8&&n.vbaraw&&dye(r,Xn.read(n.vbaraw,{type:typeof n.vbaraw=="string"?"binary":"buffer"})),r}var Xve={0:{f:Q_e},1:{f:axe},2:{f:Ixe},3:{f:gxe},4:{f:uxe},5:{f:Exe},6:{f:Pxe},7:{f:_xe},8:{f:jxe},9:{f:Fxe},10:{f:Oxe},11:{f:Dxe},12:{f:lxe},13:{f:Rxe},14:{f:pxe},15:{f:dxe},16:{f:Txe},17:{f:Nxe},18:{f:vxe},19:{f:rC},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Sve},40:{},42:{},43:{f:P1e},44:{f:C1e},45:{f:L1e},46:{f:D1e},47:{f:O1e},48:{},49:{f:lpe},50:{},51:{f:Q1e},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:c1e},62:{f:kxe},63:{f:iye},64:{f:eve},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:el,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:qxe},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:ixe},148:{f:txe,p:16},151:{f:$xe},152:{},153:{f:wve},154:{},155:{},156:{f:xve},157:{},158:{},159:{T:1,f:x1e},160:{T:-1},161:{T:1,f:Td},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Vxe},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:q1e},336:{T:-1},337:{f:tye,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:$b},357:{},358:{},359:{},360:{T:1},361:{},362:{f:r1e},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Wxe},427:{f:Hxe},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Yxe},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:rxe},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Uxe},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:$b},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:cye},633:{T:1},634:{T:-1},635:{T:1,f:oye},636:{T:-1},637:{f:dpe},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:fve},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:tve},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function rt(n,e,t,r){var i=e;if(!isNaN(i)){var s=r||(t||[]).length||0,a=n.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&eC(t)&&n.push(t)}}function qve(n,e,t,r){var i=(t||[]).length||0;if(i<=8224)return rt(n,e,t,i);var s=e;if(!isNaN(s)){for(var a=t.parts||[],o=0,l=0,u=0;u+(a[o]||8224)<=8224;)u+=a[o]||8224,o++;var h=n.next(4);for(h.write_shift(2,s),h.write_shift(2,u),n.push(t.slice(l,l+u)),l+=u;l<i;){for(h=n.next(4),h.write_shift(2,60),u=0;u+(a[o]||8224)<=8224;)u+=a[o]||8224,o++;h.write_shift(2,u),n.push(t.slice(l,l+u)),l+=u}}}function O1(n,e,t){return n||(n=Re(7)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,0),n.write_shift(1,0),n}function Zve(n,e,t,r){var i=Re(9);return O1(i,n,e),MV(t,r||"b",i),i}function Qve(n,e,t){var r=Re(8+2*t.length);return O1(r,n,e),r.write_shift(1,t.length),r.write_shift(t.length,t,"sbcs"),r.l<r.length?r.slice(0,r.l):r}function Jve(n,e,t,r){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?Ms(hs(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?rt(n,2,f1e(t,r,i)):rt(n,3,d1e(t,r,i));return;case"b":case"e":rt(n,5,Zve(t,r,e.v,e.t));return;case"s":case"str":rt(n,4,Qve(t,r,(e.v||"").slice(0,255)));return}rt(n,1,O1(null,t,r))}function ewe(n,e,t,r){var i=Array.isArray(e),s=cr(e["!ref"]||"A1"),a,o="",l=[];if(s.e.c>255||s.e.r>16383){if(r.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=Yr(s)}for(var u=s.s.r;u<=s.e.r;++u){o=Pi(u);for(var h=s.s.c;h<=s.e.c;++h){u===s.s.r&&(l[h]=Zi(h)),a=l[h]+o;var f=i?(e[u]||[])[h]:e[a];f&&Jve(n,f,u,h)}}}function twe(n,e){for(var t=e||{},r=ks(),i=0,s=0;s<n.SheetNames.length;++s)n.SheetNames[s]==t.sheet&&(i=s);if(i==0&&t.sheet&&n.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return rt(r,t.biff==4?1033:t.biff==3?521:9,aC(n,16,t)),ewe(r,n.Sheets[n.SheetNames[i]],i,t),rt(r,10),r.end()}function nwe(n,e,t){rt(n,49,Xpe({sz:12,name:"Arial"},t))}function rwe(n,e,t){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&rt(n,1054,Qpe(i,e[i],t))})}function iwe(n,e){var t=Re(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),rt(n,2151,t),t=Re(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),OV(cr(e["!ref"]||"A1"),t),t.write_shift(4,4),rt(n,2152,t)}function swe(n,e){for(var t=0;t<16;++t)rt(n,224,EO({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(r){rt(n,224,EO(r,0,e))})}function awe(n,e){for(var t=0;t<e["!links"].length;++t){var r=e["!links"][t];rt(n,440,a1e(r)),r[1].Tooltip&&rt(n,2048,o1e(r))}delete e["!links"]}function owe(n,e){if(e){var t=0;e.forEach(function(r,i){++t<=256&&r&&rt(n,125,u1e(qw(i,r),i))})}}function lwe(n,e,t,r,i){var s=16+ku(i.cellXfs,e,i);if(e.v==null&&!e.bf){rt(n,513,id(t,r,s));return}if(e.bf)rt(n,6,M_e(e,t,r,i,s));else switch(e.t){case"d":case"n":var a=e.t=="d"?Ms(hs(e.v)):e.v;rt(n,515,n1e(t,r,a,s));break;case"b":case"e":rt(n,517,t1e(t,r,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var o=hC(i.Strings,e.v,i.revStrings);rt(n,253,qpe(t,r,o,s))}else rt(n,516,Zpe(t,r,(e.v||"").slice(0,255),s,i));break;default:rt(n,513,id(t,r,s))}}function cwe(n,e,t){var r=ks(),i=t.SheetNames[n],s=t.Sheets[i]||{},a=(t||{}).Workbook||{},o=(a.Sheets||[])[n]||{},l=Array.isArray(s),u=e.biff==8,h,f="",g=[],y=cr(s["!ref"]||"A1"),v=u?65536:16384;if(y.e.c>255||y.e.r>=v){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");y.e.c=Math.min(y.e.c,255),y.e.r=Math.min(y.e.c,v-1)}rt(r,2057,aC(t,16,e)),rt(r,13,xa(1)),rt(r,12,xa(100)),rt(r,15,is(!0)),rt(r,17,is(!1)),rt(r,16,rd(.001)),rt(r,95,is(!0)),rt(r,42,is(!1)),rt(r,43,is(!1)),rt(r,130,xa(1)),rt(r,128,e1e()),rt(r,131,is(!1)),rt(r,132,is(!1)),u&&owe(r,s["!cols"]),rt(r,512,Jpe(y,e)),u&&(s["!links"]=[]);for(var x=y.s.r;x<=y.e.r;++x){f=Pi(x);for(var E=y.s.c;E<=y.e.c;++E){x===y.s.r&&(g[E]=Zi(E)),h=g[E]+f;var T=l?(s[x]||[])[E]:s[h];T&&(lwe(r,T,x,E,e),u&&T.l&&s["!links"].push([h,T.l]))}}var b=o.CodeName||o.name||i;return u&&rt(r,574,Ype((a.Views||[])[0])),u&&(s["!merges"]||[]).length&&rt(r,229,s1e(s["!merges"])),u&&awe(r,s),rt(r,442,LV(b)),u&&iwe(r,s),rt(r,10),r.end()}function uwe(n,e,t){var r=ks(),i=(n||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=t.biff==8,l=t.biff==5;if(rt(r,2057,aC(n,5,t)),t.bookType=="xla"&&rt(r,135),rt(r,225,o?xa(1200):null),rt(r,193,Ope(2)),l&&rt(r,191),l&&rt(r,192),rt(r,226),rt(r,92,$pe("SheetJS",t)),rt(r,66,xa(o?1200:1252)),o&&rt(r,353,xa(0)),o&&rt(r,448),rt(r,317,h1e(n.SheetNames.length)),o&&n.vbaraw&&rt(r,211),o&&n.vbaraw){var u=a.CodeName||"ThisWorkbook";rt(r,442,LV(u))}rt(r,156,xa(17)),rt(r,25,is(!1)),rt(r,18,is(!1)),rt(r,19,xa(0)),o&&rt(r,431,is(!1)),o&&rt(r,444,xa(0)),rt(r,61,Kpe()),rt(r,64,is(!1)),rt(r,141,xa(0)),rt(r,34,is(mve(n)=="true")),rt(r,14,is(!0)),o&&rt(r,439,is(!1)),rt(r,218,xa(0)),nwe(r,n,t),rwe(r,n.SSF,t),swe(r,t),o&&rt(r,352,is(!1));var h=r.end(),f=ks();o&&rt(f,140,l1e()),o&&t.Strings&&qve(f,252,Hpe(t.Strings)),rt(f,10);var g=f.end(),y=ks(),v=0,x=0;for(x=0;x<n.SheetNames.length;++x)v+=(o?12:11)+(o?2:1)*n.SheetNames[x].length;var E=h.length+v+g.length;for(x=0;x<n.SheetNames.length;++x){var T=s[x]||{};rt(y,133,Wpe({pos:E,hs:T.Hidden||0,dt:0,name:n.SheetNames[x]},t)),E+=e[x].length}var b=y.end();if(v!=b.length)throw new Error("BS8 "+v+" != "+b.length);var I=[];return h.length&&I.push(h),b.length&&I.push(b),g.length&&I.push(g),Ri(I)}function hwe(n,e){var t=e||{},r=[];n&&!n.SSF&&(n.SSF=Ns(Pr)),n&&n.SSF&&(Ww(),$w(n.SSF),t.revssf=Hw(n.SSF),t.revssf[n.SSF[65535]]=0,t.ssf=n.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,dC(t),t.cellXfs=[],ku(t.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={});for(var i=0;i<n.SheetNames.length;++i)r[r.length]=cwe(i,t,n);return r.unshift(uwe(n,r,t)),Ri(r)}function oG(n,e){for(var t=0;t<=n.SheetNames.length;++t){var r=n.Sheets[n.SheetNames[t]];if(!(!r||!r["!ref"])){var i=ia(r["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+n.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return hwe(n,e);case 4:case 3:case 2:return twe(n,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function dwe(n,e,t,r){for(var i=n["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,u=0;u<i.length;++u)if(!(i[u].s.r>t||i[u].s.c>a)&&!(i[u].e.r<t||i[u].e.c<a)){if(i[u].s.r<t||i[u].s.c<a){o=-1;break}o=i[u].e.r-i[u].s.r+1,l=i[u].e.c-i[u].s.c+1;break}if(!(o<0)){var h=Yn({r:t,c:a}),f=r.dense?(n[t]||[])[a]:n[h],g=f&&f.v!=null&&(f.h||zme(f.w||(Yl(f),f.w)||""))||"",y={};o>1&&(y.rowspan=o),l>1&&(y.colspan=l),r.editable?g='<span contenteditable="true">'+g+"</span>":f&&(y["data-t"]=f&&f.t||"z",f.v!=null&&(y["data-v"]=f.v),f.z!=null&&(y["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(g='<a href="'+f.l.Target+'">'+g+"</a>")),y.id=(r.id||"sjs")+"-"+h,s.push(nt("td",g,y))}}var v="<tr>";return v+s.join("")+"</tr>"}var fwe='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',gwe="</body></html>";function mwe(n,e,t){var r=[];return r.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function lG(n,e){var t=e||{},r=t.header!=null?t.header:fwe,i=t.footer!=null?t.footer:gwe,s=[r],a=ia(n["!ref"]);t.dense=Array.isArray(n),s.push(mwe(n,a,t));for(var o=a.s.r;o<=a.e.r;++o)s.push(dwe(n,a,o,t));return s.push("</table>"+i),s.join("")}function cG(n,e,t){var r=t||{},i=0,s=0;if(r.origin!=null)if(typeof r.origin=="number")i=r.origin;else{var a=typeof r.origin=="string"?mi(r.origin):r.origin;i=a.r,s=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(r.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:i,c:s}};if(n["!ref"]){var h=ia(n["!ref"]);u.s.r=Math.min(u.s.r,h.s.r),u.s.c=Math.min(u.s.c,h.s.c),u.e.r=Math.max(u.e.r,h.e.r),u.e.c=Math.max(u.e.c,h.e.c),i==-1&&(u.e.r=i=h.e.r+1)}var f=[],g=0,y=n["!rows"]||(n["!rows"]=[]),v=0,x=0,E=0,T=0,b=0,I=0;for(n["!cols"]||(n["!cols"]=[]);v<o.length&&x<l;++v){var M=o[v];if(CO(M)){if(r.display)continue;y[x]={hidden:!0}}var F=M.children;for(E=T=0;E<F.length;++E){var z=F[E];if(!(r.display&&CO(z))){var P=z.hasAttribute("data-v")?z.getAttribute("data-v"):z.hasAttribute("v")?z.getAttribute("v"):Kme(z.innerHTML),C=z.getAttribute("data-z")||z.getAttribute("z");for(g=0;g<f.length;++g){var k=f[g];k.s.c==T+s&&k.s.r<x+i&&x+i<=k.e.r&&(T=k.e.c+1-s,g=-1)}I=+z.getAttribute("colspan")||1,((b=+z.getAttribute("rowspan")||1)>1||I>1)&&f.push({s:{r:x+i,c:T+s},e:{r:x+i+(b||1)-1,c:T+s+(I||1)-1}});var L={t:"s",v:P},O=z.getAttribute("data-t")||z.getAttribute("t")||"";P!=null&&(P.length==0?L.t=O||"z":r.raw||P.trim().length==0||O=="s"||(P==="TRUE"?L={t:"b",v:!0}:P==="FALSE"?L={t:"b",v:!1}:isNaN(Fl(P))?isNaN(Lp(P).getDate())||(L={t:"d",v:hs(P)},r.cellDates||(L={t:"n",v:Ms(L.v)}),L.z=r.dateNF||Pr[14]):L={t:"n",v:Fl(P)})),L.z===void 0&&C!=null&&(L.z=C);var U="",j=z.getElementsByTagName("A");if(j&&j.length)for(var Te=0;Te<j.length&&!(j[Te].hasAttribute("href")&&(U=j[Te].getAttribute("href"),U.charAt(0)!="#"));++Te);U&&U.charAt(0)!="#"&&(L.l={Target:U}),r.dense?(n[x+i]||(n[x+i]=[]),n[x+i][T+s]=L):n[Yn({c:T+s,r:x+i})]=L,u.e.c<T+s&&(u.e.c=T+s),T+=I}}++x}return f.length&&(n["!merges"]=(n["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,x-1+i),n["!ref"]=Yr(u),x>=l&&(n["!fullref"]=Yr((u.e.r=o.length-v+x-1+i,u))),n}function uG(n,e){var t=e||{},r=t.dense?[]:{};return cG(r,n,e)}function pwe(n,e){return vd(uG(n,e),e)}function CO(n){var e="",t=ywe(n);return t&&(e=t(n).getPropertyValue("display")),e||(e=n.style&&n.style.display),e==="none"}function ywe(n){return n.ownerDocument.defaultView&&typeof n.ownerDocument.defaultView.getComputedStyle=="function"?n.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var _we=(function(){var n=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+Dp({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+n+"</office:document-styles>";return function(){return qr+e}})(),kO=(function(){var n=function(s){return Hn(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,r=function(s,a,o){var l=[];l.push('      <table:table table:name="'+Hn(a.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,h=0,f=ia(s["!ref"]||"A1"),g=s["!merges"]||[],y=0,v=Array.isArray(s);if(s["!cols"])for(h=0;h<=f.e.c;++h)l.push("        <table:table-column"+(s["!cols"][h]?' table:style-name="co'+s["!cols"][h].ods+'"':"")+`></table:table-column>
`);var x="",E=s["!rows"]||[];for(u=0;u<f.s.r;++u)x=E[u]?' table:style-name="ro'+E[u].ods+'"':"",l.push("        <table:table-row"+x+`></table:table-row>
`);for(;u<=f.e.r;++u){for(x=E[u]?' table:style-name="ro'+E[u].ods+'"':"",l.push("        <table:table-row"+x+`>
`),h=0;h<f.s.c;++h)l.push(e);for(;h<=f.e.c;++h){var T=!1,b={},I="";for(y=0;y!=g.length;++y)if(!(g[y].s.c>h)&&!(g[y].s.r>u)&&!(g[y].e.c<h)&&!(g[y].e.r<u)){(g[y].s.c!=h||g[y].s.r!=u)&&(T=!0),b["table:number-columns-spanned"]=g[y].e.c-g[y].s.c+1,b["table:number-rows-spanned"]=g[y].e.r-g[y].s.r+1;break}if(T){l.push(t);continue}var M=Yn({r:u,c:h}),F=v?(s[u]||[])[h]:s[M];if(F&&F.f&&(b["table:formula"]=Hn(j_e(F.f)),F.F&&F.F.slice(0,M.length)==M)){var z=ia(F.F);b["table:number-matrix-columns-spanned"]=z.e.c-z.s.c+1,b["table:number-matrix-rows-spanned"]=z.e.r-z.s.r+1}if(!F){l.push(e);continue}switch(F.t){case"b":I=F.v?"TRUE":"FALSE",b["office:value-type"]="boolean",b["office:boolean-value"]=F.v?"true":"false";break;case"n":I=F.w||String(F.v||0),b["office:value-type"]="float",b["office:value"]=F.v||0;break;case"s":case"str":I=F.v==null?"":F.v,b["office:value-type"]="string";break;case"d":I=F.w||hs(F.v).toISOString(),b["office:value-type"]="date",b["office:date-value"]=hs(F.v).toISOString(),b["table:style-name"]="ce1";break;default:l.push(e);continue}var P=n(I);if(F.l&&F.l.Target){var C=F.l.Target;C=C.charAt(0)=="#"?"#"+V_e(C.slice(1)):C,C.charAt(0)!="#"&&!C.match(/^\w+:/)&&(C="../"+C),P=nt("text:a",P,{"xlink:href":C.replace(/&/g,"&amp;")})}l.push("          "+nt("table:table-cell",nt("text:p",P,{}),b)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var h=0;h<u["!cols"].length;++h)if(u["!cols"][h]){var f=u["!cols"][h];if(f.width==null&&f.wpx==null&&f.wch==null)continue;oC(f),f.ods=o;var g=u["!cols"][h].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+g+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var h=0;h<u["!rows"].length;++h)if(u["!rows"][h]){u["!rows"][h].ods=l;var f=u["!rows"][h].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var l=[qr],u=Dp({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),h=Dp({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+u+h+`>
`),l.push(bV().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+u+`>
`),i(l,a),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var f=0;f!=a.SheetNames.length;++f)l.push(r(a.Sheets[a.SheetNames[f]],a,f));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}})();function hG(n,e){if(e.bookType=="fods")return kO(n,e);var t=qR(),r="",i=[],s=[];return r="mimetype",nn(t,r,"application/vnd.oasis.opendocument.spreadsheet"),r="content.xml",nn(t,r,kO(n,e)),i.push([r,"text/xml"]),s.push([r,"ContentFile"]),r="styles.xml",nn(t,r,_we(n,e)),i.push([r,"text/xml"]),s.push([r,"StylesFile"]),r="meta.xml",nn(t,r,qr+bV()),i.push([r,"text/xml"]),s.push([r,"MetadataFile"]),r="manifest.rdf",nn(t,r,kpe(s)),i.push([r,"application/rdf+xml"]),r="META-INF/manifest.xml",nn(t,r,Rpe(i)),t}function bv(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}function xwe(n){return typeof TextEncoder<"u"?new TextEncoder().encode(n):Za(Op(n))}function vwe(n,e){e:for(var t=0;t<=n.length-e.length;++t){for(var r=0;r<e.length;++r)if(n[t+r]!=e[r])continue e;return!0}return!1}function Eu(n){var e=n.reduce(function(i,s){return i+s.length},0),t=new Uint8Array(e),r=0;return n.forEach(function(i){t.set(i,r),r+=i.length}),t}function wwe(n,e,t){var r=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,i=t/Math.pow(10,r-6176);n[e+15]|=r>>7,n[e+14]|=(r&127)<<1;for(var s=0;i>=1;++s,i/=256)n[e+s]=i&255;n[e+15]|=t>=0?0:128}function Fp(n,e){var t=e?e[0]:0,r=n[t]&127;e:if(n[t++]>=128&&(r|=(n[t]&127)<<7,n[t++]<128||(r|=(n[t]&127)<<14,n[t++]<128)||(r|=(n[t]&127)<<21,n[t++]<128)||(r+=(n[t]&127)*Math.pow(2,28),++t,n[t++]<128)||(r+=(n[t]&127)*Math.pow(2,35),++t,n[t++]<128)||(r+=(n[t]&127)*Math.pow(2,42),++t,n[t++]<128)))break e;return e&&(e[0]=t),r}function Bn(n){var e=new Uint8Array(7);e[0]=n&127;var t=1;e:if(n>127){if(e[t-1]|=128,e[t]=n>>7&127,++t,n<=16383||(e[t-1]|=128,e[t]=n>>14&127,++t,n<=2097151)||(e[t-1]|=128,e[t]=n>>21&127,++t,n<=268435455)||(e[t-1]|=128,e[t]=n/256>>>21&127,++t,n<=34359738367)||(e[t-1]|=128,e[t]=n/65536>>>21&127,++t,n<=4398046511103))break e;e[t-1]|=128,e[t]=n/16777216>>>21&127,++t}return e.slice(0,t)}function a0(n){var e=0,t=n[e]&127;e:if(n[e++]>=128){if(t|=(n[e]&127)<<7,n[e++]<128||(t|=(n[e]&127)<<14,n[e++]<128)||(t|=(n[e]&127)<<21,n[e++]<128))break e;t|=(n[e]&127)<<28}return t}function ei(n){for(var e=[],t=[0];t[0]<n.length;){var r=t[0],i=Fp(n,t),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=t[0];n[t[0]++]>=128;);o=n.slice(l,t[0])}break;case 5:a=4,o=n.slice(t[0],t[0]+a),t[0]+=a;break;case 1:a=8,o=n.slice(t[0],t[0]+a),t[0]+=a;break;case 2:a=Fp(n,t),o=n.slice(t[0],t[0]+a),t[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(r))}var u={data:o,type:s};e[i]==null?e[i]=[u]:e[i].push(u)}return e}function Ei(n){var e=[];return n.forEach(function(t,r){t.forEach(function(i){i.data&&(e.push(Bn(r*8+i.type)),i.type==2&&e.push(Bn(i.data.length)),e.push(i.data))})}),Eu(e)}function Ua(n){for(var e,t=[],r=[0];r[0]<n.length;){var i=Fp(n,r),s=ei(n.slice(r[0],r[0]+i));r[0]+=i;var a={id:a0(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=ei(o.data),u=a0(l[3][0].data);a.messages.push({meta:l,data:n.slice(r[0],r[0]+u)}),r[0]+=u}),(e=s[3])!=null&&e[0]&&(a.merge=a0(s[3][0].data)>>>0>0),t.push(a)}return t}function yf(n){var e=[];return n.forEach(function(t){var r=[];r[1]=[{data:Bn(t.id),type:0}],r[2]=[],t.merge!=null&&(r[3]=[{data:Bn(+!!t.merge),type:0}]);var i=[];t.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:Bn(a.data.length)}],r[2].push({data:Ei(a.meta),type:2})});var s=Ei(r);e.push(Bn(s.length)),e.push(s),i.forEach(function(a){return e.push(a)})}),Eu(e)}function Ewe(n,e){if(n!=0)throw new Error("Unexpected Snappy chunk type ".concat(n));for(var t=[0],r=Fp(e,t),i=[];t[0]<e.length;){var s=e[t[0]]&3;if(s==0){var a=e[t[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[t[0]],o>1&&(a|=e[t[0]+1]<<8),o>2&&(a|=e[t[0]+2]<<16),o>3&&(a|=e[t[0]+3]<<24),a>>>=0,a++,t[0]+=o}i.push(e.slice(t[0],t[0]+a)),t[0]+=a;continue}else{var l=0,u=0;if(s==1?(u=(e[t[0]]>>2&7)+4,l=(e[t[0]++]&224)<<3,l|=e[t[0]++]):(u=(e[t[0]++]>>2)+1,s==2?(l=e[t[0]]|e[t[0]+1]<<8,t[0]+=2):(l=(e[t[0]]|e[t[0]+1]<<8|e[t[0]+2]<<16|e[t[0]+3]<<24)>>>0,t[0]+=4)),i=[Eu(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(i.push(i[0].slice(-l)),u-=l;u>=i[i.length-1].length;)i.push(i[i.length-1]),u-=i[i.length-1].length;i.push(i[0].slice(-l,-l+u))}}var h=Eu(i);if(h.length!=r)throw new Error("Unexpected length: ".concat(h.length," != ").concat(r));return h}function za(n){for(var e=[],t=0;t<n.length;){var r=n[t++],i=n[t]|n[t+1]<<8|n[t+2]<<16;t+=3,e.push(Ewe(r,n.slice(t,t+i))),t+=i}if(t!==n.length)throw new Error("data is not a valid framed stream!");return Eu(e)}function _f(n){for(var e=[],t=0;t<n.length;){var r=Math.min(n.length-t,268435455),i=new Uint8Array(4);e.push(i);var s=Bn(r),a=s.length;e.push(s),r<=60?(a++,e.push(new Uint8Array([r-1<<2]))):r<=256?(a+=2,e.push(new Uint8Array([240,r-1&255]))):r<=65536?(a+=3,e.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(a+=4,e.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(a+=5,e.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),e.push(n.slice(t,t+r)),a+=r,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,t+=r}return Eu(e)}function WS(n,e){var t=new Uint8Array(32),r=bv(t),i=12,s=0;switch(t[0]=5,n.t){case"n":t[1]=2,wwe(t,i,n.v),s|=1,i+=16;break;case"b":t[1]=6,r.setFloat64(i,n.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(n.v)==-1)throw new Error("Value ".concat(n.v," missing from SST!"));t[1]=3,r.setUint32(i,e.indexOf(n.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+n.t}return r.setUint32(8,s,!0),t.slice(0,i)}function HS(n,e){var t=new Uint8Array(32),r=bv(t),i=12,s=0;switch(t[0]=3,n.t){case"n":t[2]=2,r.setFloat64(i,n.v,!0),s|=32,i+=8;break;case"b":t[2]=6,r.setFloat64(i,n.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(n.v)==-1)throw new Error("Value ".concat(n.v," missing from SST!"));t[2]=3,r.setUint32(i,e.indexOf(n.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+n.t}return r.setUint32(4,s,!0),t.slice(0,i)}function Mc(n){var e=ei(n);return Fp(e[1][0].data)}function Swe(n,e,t){var r,i,s,a;if(!((r=n[6])!=null&&r[0])||!((i=n[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=n[8])==null?void 0:s[0])==null?void 0:a.data)&&a0(n[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,u=bv(n[7][0].data),h=0,f=[],g=bv(n[4][0].data),y=0,v=[],x=0;x<e.length;++x){if(e[x]==null){u.setUint16(x*2,65535,!0),g.setUint16(x*2,65535);continue}u.setUint16(x*2,h,!0),g.setUint16(x*2,y,!0);var E,T;switch(typeof e[x]){case"string":E=WS({t:"s",v:e[x]},t),T=HS({t:"s",v:e[x]},t);break;case"number":E=WS({t:"n",v:e[x]},t),T=HS({t:"n",v:e[x]},t);break;case"boolean":E=WS({t:"b",v:e[x]},t),T=HS({t:"b",v:e[x]},t);break;default:throw new Error("Unsupported value "+e[x])}f.push(E),h+=E.length,v.push(T),y+=T.length,++l}for(n[2][0].data=Bn(l);x<n[7][0].data.length/2;++x)u.setUint16(x*2,65535,!0),g.setUint16(x*2,65535,!0);return n[6][0].data=Eu(f),n[3][0].data=Eu(v),l}function Twe(n,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=n.Sheets[n.SheetNames[0]];n.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=ia(t["!ref"]);r.s.r=r.s.c=0;var i=!1;r.e.c>9&&(i=!0,r.e.c=9),r.e.r>49&&(i=!0,r.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(Yr(r)));var s=Iv(t,{range:r,header:1}),a=["~Sh33tJ5~"];s.forEach(function(J){return J.forEach(function(re){typeof re=="string"&&a.push(re)})});var o={},l=[],u=Xn.read(e.numbers,{type:"base64"});u.FileIndex.map(function(J,re){return[J,u.FullPaths[re]]}).forEach(function(J){var re=J[0],q=J[1];if(re.type==2&&re.name.match(/\.iwa/)){var he=re.content,Me=za(he),je=Ua(Me);je.forEach(function(De){l.push(De.id),o[De.id]={deps:[],location:q,type:a0(De.messages[0].meta[1][0].data)}})}}),l.sort(function(J,re){return J-re});var h=l.filter(function(J){return J>1}).map(function(J){return[J,Bn(J)]});u.FileIndex.map(function(J,re){return[J,u.FullPaths[re]]}).forEach(function(J){var re=J[0];if(J[1],!!re.name.match(/\.iwa/)){var q=Ua(za(re.content));q.forEach(function(he){he.messages.forEach(function(Me){h.forEach(function(je){he.messages.some(function(De){return a0(De.meta[1][0].data)!=11006&&vwe(De.data,je[1])})&&o[je[0]].deps.push(he.id)})})})}});for(var f=Xn.find(u,o[1].location),g=Ua(za(f.content)),y,v=0;v<g.length;++v){var x=g[v];x.id==1&&(y=x)}var E=Mc(ei(y.messages[0].data)[1][0].data);for(f=Xn.find(u,o[E].location),g=Ua(za(f.content)),v=0;v<g.length;++v)x=g[v],x.id==E&&(y=x);for(E=Mc(ei(y.messages[0].data)[2][0].data),f=Xn.find(u,o[E].location),g=Ua(za(f.content)),v=0;v<g.length;++v)x=g[v],x.id==E&&(y=x);for(E=Mc(ei(y.messages[0].data)[2][0].data),f=Xn.find(u,o[E].location),g=Ua(za(f.content)),v=0;v<g.length;++v)x=g[v],x.id==E&&(y=x);var T=ei(y.messages[0].data);{T[6][0].data=Bn(r.e.r+1),T[7][0].data=Bn(r.e.c+1);var b=Mc(T[46][0].data),I=Xn.find(u,o[b].location),M=Ua(za(I.content));{for(var F=0;F<M.length&&M[F].id!=b;++F);if(M[F].id!=b)throw"Bad ColumnRowUIDMapArchive";var z=ei(M[F].messages[0].data);z[1]=[],z[2]=[],z[3]=[];for(var P=0;P<=r.e.c;++P){var C=[];C[1]=C[2]=[{type:0,data:Bn(P+420690)}],z[1].push({type:2,data:Ei(C)}),z[2].push({type:0,data:Bn(P)}),z[3].push({type:0,data:Bn(P)})}z[4]=[],z[5]=[],z[6]=[];for(var k=0;k<=r.e.r;++k)C=[],C[1]=C[2]=[{type:0,data:Bn(k+726270)}],z[4].push({type:2,data:Ei(C)}),z[5].push({type:0,data:Bn(k)}),z[6].push({type:0,data:Bn(k)});M[F].messages[0].data=Ei(z)}I.content=_f(yf(M)),I.size=I.content.length,delete T[46];var L=ei(T[4][0].data);{L[7][0].data=Bn(r.e.r+1);var O=ei(L[1][0].data),U=Mc(O[2][0].data);I=Xn.find(u,o[U].location),M=Ua(za(I.content));{if(M[0].id!=U)throw"Bad HeaderStorageBucket";var j=ei(M[0].messages[0].data);for(k=0;k<s.length;++k){var Te=ei(j[2][0].data);Te[1][0].data=Bn(k),Te[4][0].data=Bn(s[k].length),j[2][k]={type:j[2][0].type,data:Ei(Te)}}M[0].messages[0].data=Ei(j)}I.content=_f(yf(M)),I.size=I.content.length;var Ce=Mc(L[2][0].data);I=Xn.find(u,o[Ce].location),M=Ua(za(I.content));{if(M[0].id!=Ce)throw"Bad HeaderStorageBucket";for(j=ei(M[0].messages[0].data),P=0;P<=r.e.c;++P)Te=ei(j[2][0].data),Te[1][0].data=Bn(P),Te[4][0].data=Bn(r.e.r+1),j[2][P]={type:j[2][0].type,data:Ei(Te)};M[0].messages[0].data=Ei(j)}I.content=_f(yf(M)),I.size=I.content.length;var Ue=Mc(L[4][0].data);(function(){for(var J=Xn.find(u,o[Ue].location),re=Ua(za(J.content)),q,he=0;he<re.length;++he){var Me=re[he];Me.id==Ue&&(q=Me)}var je=ei(q.messages[0].data);{je[3]=[];var De=[];a.forEach(function(Kt,wn){De[1]=[{type:0,data:Bn(wn)}],De[2]=[{type:0,data:Bn(1)}],De[3]=[{type:2,data:xwe(Kt)}],je[3].push({type:2,data:Ei(De)})})}q.messages[0].data=Ei(je);var Be=yf(re),Gt=_f(Be);J.content=Gt,J.size=J.content.length})();var Ne=ei(L[3][0].data);{var le=Ne[1][0];delete Ne[2];var ue=ei(le.data);{var Se=Mc(ue[2][0].data);(function(){for(var J=Xn.find(u,o[Se].location),re=Ua(za(J.content)),q,he=0;he<re.length;++he){var Me=re[he];Me.id==Se&&(q=Me)}var je=ei(q.messages[0].data);{delete je[6],delete Ne[7];var De=new Uint8Array(je[5][0].data);je[5]=[];for(var Be=0,Gt=0;Gt<=r.e.r;++Gt){var Kt=ei(De);Be+=Swe(Kt,s[Gt],a),Kt[1][0].data=Bn(Gt),je[5].push({data:Ei(Kt),type:2})}je[1]=[{type:0,data:Bn(r.e.c+1)}],je[2]=[{type:0,data:Bn(r.e.r+1)}],je[3]=[{type:0,data:Bn(Be)}],je[4]=[{type:0,data:Bn(r.e.r+1)}]}q.messages[0].data=Ei(je);var wn=yf(re),Bt=_f(wn);J.content=Bt,J.size=J.content.length})()}le.data=Ei(ue)}L[3][0].data=Ei(Ne)}T[4][0].data=Ei(L)}y.messages[0].data=Ei(T);var se=yf(g),V=_f(se);return f.content=V,f.size=f.content.length,u}function bwe(n){return function(t){for(var r=0;r!=n.length;++r){var i=n[r];t[i[0]]===void 0&&(t[i[0]]=i[1]),i[2]==="n"&&(t[i[0]]=Number(t[i[0]]))}}}function dC(n){bwe([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(n)}function Iwe(n,e){return e.bookType=="ods"?hG(n,e):e.bookType=="numbers"?Twe(n,e):e.bookType=="xlsb"?Awe(n,e):Rwe(n,e)}function Awe(n,e){Uf=1024,n&&!n.SSF&&(n.SSF=Ns(Pr)),n&&n.SSF&&(Ww(),$w(n.SSF),e.revssf=Hw(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,$m?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t=e.bookType=="xlsb"?"bin":"xml",r=KV.indexOf(e.bookType)>-1,i=EV();dC(e=e||{});var s=qR(),a="",o=0;if(e.cellXfs=[],ku(e.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),a="docProps/core.xml",nn(s,a,IV(n.Props,e)),i.coreprops.push(a),Un(e.rels,2,a,Sn.CORE_PROPS),a="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var l=[],u=0;u<n.SheetNames.length;++u)(n.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(n.SheetNames[u]);n.Props.SheetNames=l}for(n.Props.Worksheets=n.Props.SheetNames.length,nn(s,a,RV(n.Props)),i.extprops.push(a),Un(e.rels,3,a,Sn.EXT_PROPS),n.Custprops!==n.Props&&Mi(n.Custprops||{}).length>0&&(a="docProps/custom.xml",nn(s,a,CV(n.Custprops)),i.custprops.push(a),Un(e.rels,4,a,Sn.CUST_PROPS)),o=1;o<=n.SheetNames.length;++o){var h={"!id":{}},f=n.Sheets[n.SheetNames[o-1]],g=(f||{})["!type"]||"sheet";switch(g){case"chart":default:a="xl/worksheets/sheet"+o+"."+t,nn(s,a,kve(o-1,a,e,n,h)),i.sheets.push(a),Un(e.wbrels,-1,"worksheets/sheet"+o+"."+t,Sn.WS[0])}if(f){var y=f["!comments"],v=!1,x="";y&&y.length>0&&(x="xl/comments"+o+"."+t,nn(s,x,Nve(y,x)),i.comments.push(x),Un(h,-1,"../comments"+o+"."+t,Sn.CMNT),v=!0),f["!legacy"]&&v&&nn(s,"xl/drawings/vmlDrawing"+o+".vml",WV(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}h["!id"].rId1&&nn(s,TV(a),i0(h))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+t,nn(s,a,Mve(e.Strings,a,e)),i.strs.push(a),Un(e.wbrels,-1,"sharedStrings."+t,Sn.SST)),a="xl/workbook."+t,nn(s,a,Cve(n,a)),i.workbooks.push(a),Un(e.rels,1,a,Sn.WB),a="xl/theme/theme1.xml",nn(s,a,zV(n.Themes,e)),i.themes.push(a),Un(e.wbrels,-1,"theme/theme1.xml",Sn.THEME),a="xl/styles."+t,nn(s,a,Pve(n,a,e)),i.styles.push(a),Un(e.wbrels,-1,"styles."+t,Sn.STY),n.vbaraw&&r&&(a="xl/vbaProject.bin",nn(s,a,n.vbaraw),i.vba.push(a),Un(e.wbrels,-1,"vbaProject.bin",Sn.VBA)),a="xl/metadata."+t,nn(s,a,Lve(a)),i.metadata.push(a),Un(e.wbrels,-1,"metadata."+t,Sn.XLMETA),nn(s,"[Content_Types].xml",SV(i,e)),nn(s,"_rels/.rels",i0(e.rels)),nn(s,"xl/_rels/workbook."+t+".rels",i0(e.wbrels)),delete e.revssf,delete e.ssf,s}function Rwe(n,e){Uf=1024,n&&!n.SSF&&(n.SSF=Ns(Pr)),n&&n.SSF&&(Ww(),$w(n.SSF),e.revssf=Hw(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,$m?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t="xml",r=KV.indexOf(e.bookType)>-1,i=EV();dC(e=e||{});var s=qR(),a="",o=0;if(e.cellXfs=[],ku(e.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),a="docProps/core.xml",nn(s,a,IV(n.Props,e)),i.coreprops.push(a),Un(e.rels,2,a,Sn.CORE_PROPS),a="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var l=[],u=0;u<n.SheetNames.length;++u)(n.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(n.SheetNames[u]);n.Props.SheetNames=l}n.Props.Worksheets=n.Props.SheetNames.length,nn(s,a,RV(n.Props)),i.extprops.push(a),Un(e.rels,3,a,Sn.EXT_PROPS),n.Custprops!==n.Props&&Mi(n.Custprops||{}).length>0&&(a="docProps/custom.xml",nn(s,a,CV(n.Custprops)),i.custprops.push(a),Un(e.rels,4,a,Sn.CUST_PROPS));var h=["SheetJ5"];for(e.tcid=0,o=1;o<=n.SheetNames.length;++o){var f={"!id":{}},g=n.Sheets[n.SheetNames[o-1]],y=(g||{})["!type"]||"sheet";switch(y){case"chart":default:a="xl/worksheets/sheet"+o+"."+t,nn(s,a,nG(o-1,e,n,f)),i.sheets.push(a),Un(e.wbrels,-1,"worksheets/sheet"+o+"."+t,Sn.WS[0])}if(g){var v=g["!comments"],x=!1,E="";if(v&&v.length>0){var T=!1;v.forEach(function(b){b[1].forEach(function(I){I.T==!0&&(T=!0)})}),T&&(E="xl/threadedComments/threadedComment"+o+"."+t,nn(s,E,sye(v,h,e)),i.threadedcomments.push(E),Un(f,-1,"../threadedComments/threadedComment"+o+"."+t,Sn.TCMNT)),E="xl/comments"+o+"."+t,nn(s,E,HV(v)),i.comments.push(E),Un(f,-1,"../comments"+o+"."+t,Sn.CMNT),x=!0}g["!legacy"]&&x&&nn(s,"xl/drawings/vmlDrawing"+o+".vml",WV(o,g["!comments"])),delete g["!comments"],delete g["!legacy"]}f["!id"].rId1&&nn(s,TV(a),i0(f))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+t,nn(s,a,FV(e.Strings,e)),i.strs.push(a),Un(e.wbrels,-1,"sharedStrings."+t,Sn.SST)),a="xl/workbook."+t,nn(s,a,sG(n)),i.workbooks.push(a),Un(e.rels,1,a,Sn.WB),a="xl/theme/theme1.xml",nn(s,a,zV(n.Themes,e)),i.themes.push(a),Un(e.wbrels,-1,"theme/theme1.xml",Sn.THEME),a="xl/styles."+t,nn(s,a,BV(n,e)),i.styles.push(a),Un(e.wbrels,-1,"styles."+t,Sn.STY),n.vbaraw&&r&&(a="xl/vbaProject.bin",nn(s,a,n.vbaraw),i.vba.push(a),Un(e.wbrels,-1,"vbaProject.bin",Sn.VBA)),a="xl/metadata."+t,nn(s,a,$V()),i.metadata.push(a),Un(e.wbrels,-1,"metadata."+t,Sn.XLMETA),h.length>1&&(a="xl/persons/person.xml",nn(s,a,aye(h)),i.people.push(a),Un(e.wbrels,-1,"persons/person.xml",Sn.PEOPLE)),nn(s,"[Content_Types].xml",SV(i,e)),nn(s,"_rels/.rels",i0(e.rels)),nn(s,"xl/_rels/workbook."+t+".rels",i0(e.wbrels)),delete e.revssf,delete e.ssf,s}function Cwe(n,e){var t="";switch((e||{}).type||"base64"){case"buffer":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];case"base64":t=Kl(n.slice(0,12));break;case"binary":t=n;break;case"array":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function dG(n,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return P1(e.file,Xn.write(n,{type:Rn?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Xn.write(n,e)}function kwe(n,e){var t=Ns(e||{}),r=Iwe(n,t);return Pwe(r,t)}function Pwe(n,e){var t={},r=Rn?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(t.compression="DEFLATE"),e.password)t.type=r;else switch(e.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":t.type=r;break;default:throw new Error("Unrecognized type "+e.type)}var i=n.FullPaths?Xn.write(n,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!e.compression}):n.generate(t);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(zw(i))}return e.password&&typeof encrypt_agile<"u"?dG(encrypt_agile(i,e.password),e):e.type==="file"?P1(e.file,i):e.type=="string"?Gm(i):i}function Mwe(n,e){var t=e||{},r=Yve(n,t);return dG(r,t)}function Mo(n,e,t){t||(t="");var r=t+n;switch(e.type){case"base64":return Np(Op(r));case"binary":return Op(r);case"string":return n;case"file":return P1(e.file,r,"utf8");case"buffer":return Rn?ec(r,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(r):Mo(r,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Nwe(n,e){switch(e.type){case"base64":return Np(n);case"binary":return n;case"string":return n;case"file":return P1(e.file,n,"binary");case"buffer":return Rn?ec(n,"binary"):n.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function E_(n,e){switch(e.type){case"string":case"base64":case"binary":for(var t="",r=0;r<n.length;++r)t+=String.fromCharCode(n[r]);return e.type=="base64"?Np(t):e.type=="string"?Gm(t):t;case"file":return P1(e.file,n);case"buffer":return n;default:throw new Error("Unrecognized type "+e.type)}}function fG(n,e){ome(),_ve(n);var t=Ns(e||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var r=fG(n,t);return t.type="array",zw(r)}var i=0;if(t.sheet&&(typeof t.sheet=="number"?i=t.sheet:i=n.SheetNames.indexOf(t.sheet),!n.SheetNames[i]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return Mo(Hve(n,t),t);case"slk":case"sylk":return Mo(m1e.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"htm":case"html":return Mo(lG(n.Sheets[n.SheetNames[i]],t),t);case"txt":return Nwe(gG(n.Sheets[n.SheetNames[i]],t),t);case"csv":return Mo(fC(n.Sheets[n.SheetNames[i]],t),t,"\uFEFF");case"dif":return Mo(p1e.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"dbf":return E_(g1e.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"prn":return Mo(y1e.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"rtf":return Mo(T1e.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"eth":return Mo(DV.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"fods":return Mo(hG(n,t),t);case"wk1":return E_(SO.sheet_to_wk1(n.Sheets[n.SheetNames[i]],t),t);case"wk3":return E_(SO.book_to_wk3(n,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),E_(oG(n,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),Mwe(n,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return kwe(n,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function Lwe(n){if(!n.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=n.file.slice(n.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(n.bookType=t.slice(1)),n.bookType=e[n.bookType]||n.bookType}}function Owe(n,e,t){var r={};return r.type="file",r.file=e,Lwe(r),fG(n,r)}function Dwe(n,e,t,r,i,s,a,o){var l=Pi(t),u=o.defval,h=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,g=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(g,"__rowNum__",{value:t,enumerable:!1})}catch{g.__rowNum__=t}else g.__rowNum__=t;if(!a||n[t])for(var y=e.s.c;y<=e.e.c;++y){var v=a?n[t][y]:n[r[y]+l];if(v===void 0||v.t===void 0){if(u===void 0)continue;s[y]!=null&&(g[s[y]]=u);continue}var x=v.v;switch(v.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(s[y]!=null){if(x==null)if(v.t=="e"&&x===null)g[s[y]]=null;else if(u!==void 0)g[s[y]]=u;else if(h&&x===null)g[s[y]]=null;else continue;else g[s[y]]=h&&(v.t!=="n"||v.t==="n"&&o.rawNumbers!==!1)?x:Yl(v,x,o);x!=null&&(f=!1)}}return{row:g,isempty:f}}function Iv(n,e){if(n==null||n["!ref"]==null)return[];var t={t:"n",v:0},r=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},u=e||{},h=u.range!=null?u.range:n["!ref"];switch(u.header===1?r=1:u.header==="A"?r=2:Array.isArray(u.header)?r=3:u.header==null&&(r=0),typeof h){case"string":l=cr(h);break;case"number":l=cr(n["!ref"]),l.s.r=h;break;default:l=h}r>0&&(i=0);var f=Pi(l.s.r),g=[],y=[],v=0,x=0,E=Array.isArray(n),T=l.s.r,b=0,I={};E&&!n[T]&&(n[T]=[]);var M=u.skipHidden&&n["!cols"]||[],F=u.skipHidden&&n["!rows"]||[];for(b=l.s.c;b<=l.e.c;++b)if(!(M[b]||{}).hidden)switch(g[b]=Zi(b),t=E?n[T][b]:n[g[b]+f],r){case 1:s[b]=b-l.s.c;break;case 2:s[b]=g[b];break;case 3:s[b]=u.header[b-l.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),o=a=Yl(t,null,u),x=I[a]||0,!x)I[a]=1;else{do o=a+"_"+x++;while(I[o]);I[a]=x,I[o]=1}s[b]=o}for(T=l.s.r+i;T<=l.e.r;++T)if(!(F[T]||{}).hidden){var z=Dwe(n,l,T,g,r,s,E,u);(z.isempty===!1||(r===1?u.blankrows!==!1:u.blankrows))&&(y[v++]=z.row)}return y.length=v,y}var PO=/"/g;function Fwe(n,e,t,r,i,s,a,o){for(var l=!0,u=[],h="",f=Pi(t),g=e.s.c;g<=e.e.c;++g)if(r[g]){var y=o.dense?(n[t]||[])[g]:n[r[g]+f];if(y==null)h="";else if(y.v!=null){l=!1,h=""+(o.rawNumbers&&y.t=="n"?y.v:Yl(y,null,o));for(var v=0,x=0;v!==h.length;++v)if((x=h.charCodeAt(v))===i||x===s||x===34||o.forceQuotes){h='"'+h.replace(PO,'""')+'"';break}h=="ID"&&(h='"ID"')}else y.f!=null&&!y.F?(l=!1,h="="+y.f,h.indexOf(",")>=0&&(h='"'+h.replace(PO,'""')+'"')):h="";u.push(h)}return o.blankrows===!1&&l?null:u.join(a)}function fC(n,e){var t=[],r=e??{};if(n==null||n["!ref"]==null)return"";var i=cr(n["!ref"]),s=r.FS!==void 0?r.FS:",",a=s.charCodeAt(0),o=r.RS!==void 0?r.RS:`
`,l=o.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),h="",f=[];r.dense=Array.isArray(n);for(var g=r.skipHidden&&n["!cols"]||[],y=r.skipHidden&&n["!rows"]||[],v=i.s.c;v<=i.e.c;++v)(g[v]||{}).hidden||(f[v]=Zi(v));for(var x=0,E=i.s.r;E<=i.e.r;++E)(y[E]||{}).hidden||(h=Fwe(n,i,E,f,a,l,s,r),h!=null&&(r.strip&&(h=h.replace(u,"")),(h||r.blankrows!==!1)&&t.push((x++?o:"")+h)));return delete r.dense,t.join("")}function gG(n,e){e||(e={}),e.FS="	",e.RS=`
`;var t=fC(n,e);return t}function jwe(n){var e="",t,r="";if(n==null||n["!ref"]==null)return[];var i=cr(n["!ref"]),s="",a=[],o,l=[],u=Array.isArray(n);for(o=i.s.c;o<=i.e.c;++o)a[o]=Zi(o);for(var h=i.s.r;h<=i.e.r;++h)for(s=Pi(h),o=i.s.c;o<=i.e.c;++o)if(e=a[o]+s,t=u?(n[h]||[])[o]:n[e],r="",t!==void 0){if(t.F!=null){if(e=t.F,!t.f)continue;r=t.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(t.f!=null)r=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)r=""+t.v;else if(t.t=="b")r=t.v?"TRUE":"FALSE";else if(t.w!==void 0)r="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?r="'"+t.v:r=""+t.v}}l[l.length]=e+"="+r}return l}function mG(n,e,t){var r=t||{},i=+!r.skipHeader,s=n||{},a=0,o=0;if(s&&r.origin!=null)if(typeof r.origin=="number")a=r.origin;else{var l=typeof r.origin=="string"?mi(r.origin):r.origin;a=l.r,o=l.c}var u,h={s:{c:0,r:0},e:{c:o,r:a+e.length-1+i}};if(s["!ref"]){var f=cr(s["!ref"]);h.e.c=Math.max(h.e.c,f.e.c),h.e.r=Math.max(h.e.r,f.e.r),a==-1&&(a=f.e.r+1,h.e.r=a+e.length-1+i)}else a==-1&&(a=0,h.e.r=e.length-1+i);var g=r.header||[],y=0;e.forEach(function(x,E){Mi(x).forEach(function(T){(y=g.indexOf(T))==-1&&(g[y=g.length]=T);var b=x[T],I="z",M="",F=Yn({c:o+y,r:a+E+i});u=jp(s,F),b&&typeof b=="object"&&!(b instanceof Date)?s[F]=b:(typeof b=="number"?I="n":typeof b=="boolean"?I="b":typeof b=="string"?I="s":b instanceof Date?(I="d",r.cellDates||(I="n",b=Ms(b)),M=r.dateNF||Pr[14]):b===null&&r.nullError&&(I="e",b=0),u?(u.t=I,u.v=b,delete u.w,delete u.R,M&&(u.z=M)):s[F]=u={t:I,v:b},M&&(u.z=M))})}),h.e.c=Math.max(h.e.c,o+g.length-1);var v=Pi(a);if(i)for(y=0;y<g.length;++y)s[Zi(y+o)+v]={t:"s",v:g[y]};return s["!ref"]=Yr(h),s}function Vwe(n,e){return mG(null,n,e)}function jp(n,e,t){if(typeof e=="string"){if(Array.isArray(n)){var r=mi(e);return n[r.r]||(n[r.r]=[]),n[r.r][r.c]||(n[r.r][r.c]={t:"z"})}return n[e]||(n[e]={t:"z"})}return typeof e!="number"?jp(n,Yn(e)):jp(n,Yn({r:e,c:t||0}))}function Gwe(n,e){if(typeof e=="number"){if(e>=0&&n.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var t=n.SheetNames.indexOf(e);if(t>-1)return t;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function Bwe(){return{SheetNames:[],Sheets:{}}}function Uwe(n,e,t,r){var i=1;if(!t)for(;i<=65535&&n.SheetNames.indexOf(t="Sheet"+i)!=-1;++i,t=void 0);if(!t||n.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&n.SheetNames.indexOf(t)>=0){var s=t.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||t;for(++i;i<=65535&&n.SheetNames.indexOf(t=a+i)!=-1;++i);}if(iG(t),n.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return n.SheetNames.push(t),n.Sheets[t]=e,t}function zwe(n,e,t){n.Workbook||(n.Workbook={}),n.Workbook.Sheets||(n.Workbook.Sheets=[]);var r=Gwe(n,e);switch(n.Workbook.Sheets[r]||(n.Workbook.Sheets[r]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}n.Workbook.Sheets[r].Hidden=t}function $we(n,e){return n.z=e,n}function pG(n,e,t){return e?(n.l={Target:e},t&&(n.l.Tooltip=t)):delete n.l,n}function Wwe(n,e,t){return pG(n,"#"+e,t)}function Hwe(n,e,t){n.c||(n.c=[]),n.c.push({t:e,a:t||"SheetJS"})}function Kwe(n,e,t,r){for(var i=typeof e!="string"?e:cr(e),s=typeof e=="string"?e:Yr(e),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=jp(n,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=t,r&&(l.D=!0))}return n}var KS={encode_col:Zi,encode_row:Pi,encode_cell:Yn,encode_range:Yr,decode_col:nC,decode_row:tC,split_cell:ope,decode_cell:mi,decode_range:ia,format_cell:Yl,sheet_add_aoa:pV,sheet_add_json:mG,sheet_add_dom:cG,aoa_to_sheet:X0,json_to_sheet:Vwe,table_to_sheet:uG,table_to_book:pwe,sheet_to_csv:fC,sheet_to_txt:gG,sheet_to_json:Iv,sheet_to_html:lG,sheet_to_formulae:jwe,sheet_to_row_object_array:Iv,sheet_get_cell:jp,book_new:Bwe,book_append_sheet:Uwe,book_set_sheet_visibility:zwe,cell_set_number_format:$we,cell_set_hyperlink:pG,cell_set_internal_link:Wwe,cell_add_comment:Hwe,sheet_set_array_formula:Kwe,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Ko=sa()(pd((n,e)=>({vondsten:[],addVondst:t=>n(r=>({vondsten:[...r.vondsten,{...t,id:crypto.randomUUID(),timestamp:new Date().toISOString()}]})),removeVondst:t=>n(r=>({vondsten:r.vondsten.filter(i=>i.id!==t)})),updateVondst:(t,r)=>n(i=>({vondsten:i.vondsten.map(s=>s.id===t?{...s,...r}:s)})),clearAll:()=>n({vondsten:[]}),exportAsGeoJSON:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const r={type:"FeatureCollection",features:t.map(o=>({type:"Feature",geometry:{type:"Point",coordinates:[o.location.lng,o.location.lat]},properties:{id:o.id,objectType:o.objectType,material:o.material,period:o.period,depth:o.depth,notes:o.notes,timestamp:o.timestamp,photoUrl:o.photoUrl,condition:o.condition,weight:o.weight,length:o.length}}))},i=new Blob([JSON.stringify(r,null,2)],{type:"application/json"}),s=URL.createObjectURL(i),a=document.createElement("a");a.href=s,a.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.geojson`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(s)},exportAsCSV:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const r=`ID,Latitude,Longitude,Datum,Type,Materiaal,Periode,Diepte (cm),Conditie,Gewicht (g),Lengte (mm),Notities,Foto URL
`,i=t.map(u=>{const h=new Date(u.timestamp).toLocaleDateString("nl-NL"),f=u.notes?`"${u.notes.replace(/"/g,'""')}"`:"";return`${u.id},${u.location.lat},${u.location.lng},${h},${u.objectType},${u.material},${u.period},${u.depth||""},${u.condition||""},${u.weight||""},${u.length||""},${f},${u.photoUrl||""}`}).join(`
`),s=r+i,a=new Blob([s],{type:"text/csv;charset=utf-8;"}),o=URL.createObjectURL(a),l=document.createElement("a");l.href=o,l.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(o)},exportAsExcel:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const r=t.map(o=>({ID:o.id,Latitude:o.location.lat,Longitude:o.location.lng,Datum:new Date(o.timestamp).toLocaleDateString("nl-NL"),Type:o.objectType,Materiaal:o.material,Periode:o.period,"Diepte (cm)":o.depth||"",Conditie:o.condition||"","Gewicht (g)":o.weight||"","Lengte (mm)":o.length||"",Notities:o.notes||"","Foto URL":o.photoUrl||""})),i=KS.json_to_sheet(r),s=KS.book_new();KS.book_append_sheet(s,i,"Vondsten");const a=[{wch:36},{wch:12},{wch:12},{wch:12},{wch:15},{wch:12},{wch:25},{wch:12},{wch:12},{wch:12},{wch:12},{wch:40},{wch:50}];i["!cols"]=a,Owe(s,`mijn-vondsten-${new Date().toISOString().split("T")[0]}.xlsx`)},exportAsGPX:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const r=t.map(l=>{const u=new Date(l.timestamp).toISOString();return`  <wpt lat="${l.location.lat}" lon="${l.location.lng}">
    <name>${l.objectType} - ${l.material}</name>
    <desc>${l.period}${l.depth?`, ${l.depth}cm diep`:""}${l.condition&&l.condition!=="Onbekend"?`, ${l.condition}`:""}${l.weight?`, ${l.weight}g`:""}${l.length?`, ${l.length}mm`:""}${l.notes?`. ${l.notes}`:""}</desc>
    <time>${u}</time>
    <sym>Pin</sym>
  </wpt>`}).join(`
`),i=`<?xml version="1.0" encoding="UTF-8"?>
<gpx version="1.1" creator="DetectorApp NL" xmlns="http://www.topografix.com/GPX/1/1">
  <metadata>
    <name>Mijn Vondsten</name>
    <desc>Geexporteerd uit DetectorApp NL</desc>
    <time>${new Date().toISOString()}</time>
  </metadata>
${r}
</gpx>`,s=new Blob([i],{type:"application/gpx+xml"}),a=URL.createObjectURL(s),o=document.createElement("a");o.href=a,o.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.gpx`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(a)},exportAsKML:()=>{const t=e().vondsten;if(t.length===0){alert("Geen vondsten om te exporteren");return}const i=`<?xml version="1.0" encoding="UTF-8"?>
<kml xmlns="http://www.opengis.net/kml/2.2">
  <Document>
    <name>Mijn Vondsten</name>
    <description>Geexporteerd uit DetectorApp NL</description>
${t.map(l=>{const u=new Date(l.timestamp).toLocaleDateString("nl-NL"),h=`<![CDATA[
            <b>Type:</b> ${l.objectType}<br/>
            <b>Materiaal:</b> ${l.material}<br/>
            <b>Periode:</b> ${l.period}<br/>
            ${l.depth?`<b>Diepte:</b> ${l.depth} cm<br/>`:""}
            ${l.condition&&l.condition!=="Onbekend"?`<b>Conditie:</b> ${l.condition}<br/>`:""}
            ${l.weight?`<b>Gewicht:</b> ${l.weight} gram<br/>`:""}
            ${l.length?`<b>Lengte:</b> ${l.length} mm<br/>`:""}
            <b>Datum:</b> ${u}<br/>
            ${l.notes?`<b>Notities:</b> ${l.notes}<br/>`:""}
            ${l.photoUrl?`<a href="${l.photoUrl}">Bekijk foto</a>`:""}
          ]]>`;return`    <Placemark>
      <name>${l.objectType} - ${l.material}</name>
      <description>${h}</description>
      <Point>
        <coordinates>${l.location.lng},${l.location.lat},0</coordinates>
      </Point>
    </Placemark>`}).join(`
`)}
  </Document>
</kml>`,s=new Blob([i],{type:"application/vnd.google-earth.kml+xml"}),a=URL.createObjectURL(s),o=document.createElement("a");o.href=a,o.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.kml`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(a)}}),{name:"detectorapp-local-vondsten"})),Ywe={Fectio:{naam:"Fectio",latinNaam:"Fectio",type:"castellum",periode:"4/5 n.Chr. - ca. 270 n.Chr.",beschrijving:"Fectio was een van de belangrijkste Romeinse legerbases in Nederland. Het fort lag bij de splitsing van de Rijn en de Vecht, een strategisch punt.",watWasHier:"Hier was een groot castellum (legerplaats) met ruimte voor ongeveer 500 soldaten. Er waren barakken, een badhuis, een hospitaal en pakhuizen. Buiten het fort woonden handelaren en families van soldaten.",watTeZien:"Archeologisch Park Castellum Hoge Woerd toont de contouren van het fort. In het museum zijn veel vondsten te zien, waaronder een Romeins schip.",verwachteVondsten:"Munten, fibulae (mantelspelden), aardewerk, wapens, paardentuig, en militaire uitrusting. Door de natte bodem zijn hier ook organische materialen zoals leer en hout bewaard.",betekenis:"Fectio was onderdeel van de Limes, de noordgrens van het Romeinse Rijk. Vanaf hier werden troepen en goederen vervoerd over de Rijn.",bronnen:["https://www.hogewoerd.nl","https://www.livius.org/articles/place/fectio-vechten/"]},Traiectum:{naam:"Traiectum",latinNaam:"Traiectum",type:"castellum",periode:"47 n.Chr. - ca. 270 n.Chr.",beschrijving:'Traiectum is het huidige Utrecht. De naam betekent "oversteekplaats". Hier stak een belangrijke weg de Rijn over.',watWasHier:"Een klein castellum met een bezetting van enkele honderden soldaten. Het fort bewaakte de oversteek van de Rijn. Er was een brug of veerpont.",watTeZien:"De Domkerk staat deels op de fundamenten van het Romeinse fort. In het Centraal Museum zijn Romeinse vondsten te zien. Onder het Domplein zijn resten gevonden.",verwachteVondsten:"Munten, sieraden, aardewerk, bouwmateriaal (tegels, bakstenen), en offers aan de rivier. Bij de brug werden vaak munten geofferd.",betekenis:"Traiectum was een belangrijk knooppunt waar de landweg de rivier kruiste. Later groeide het uit tot de stad Utrecht.",bronnen:["https://www.livius.org/articles/place/traiectum-utrecht/"]},Laurum:{naam:"Laurum",latinNaam:"Laurum",type:"castellum",periode:"ca. 40 n.Chr. - ca. 270 n.Chr.",beschrijving:"Laurum lag in het huidige Woerden. Het was een middelgroot fort aan de Rijn.",watWasHier:"Een castellum met ruimte voor ongeveer 500 soldaten. Er zijn resten gevonden van houten barakken, een badhuis en pakhuizen. Buiten het fort lag een vicus (burgerdorp).",watTeZien:"In het Stadsmuseum Woerden zijn vondsten te zien, waaronder een bijzondere Romeinse boot. De contouren van het fort zijn in het stratenpatroon te herkennen.",verwachteVondsten:"Militaria, aardewerk, munten, en schrijfplankjes. Door de natte veengrond zijn ook houten voorwerpen en leren schoenen bewaard gebleven.",betekenis:"Laurum toont hoe de Romeinen in het veengebied bouwden. De soldaten moesten constant vechten tegen het water.",bronnen:["https://www.castellumwoerden.nl"]},"Castellum Praetorium Agrippinae":{naam:"Praetorium Agrippinae",latinNaam:"Praetorium Agrippinae",type:"castellum",periode:"40 n.Chr. - ca. 270 n.Chr.",beschrijving:"Dit fort lag in Valkenburg (ZH). De naam verwijst naar Agrippina, de moeder van keizer Nero.",watWasHier:"Een middelgroot castellum met barakken voor hulptroepen. Er waren ook werkplaatsen en opslagruimtes. Het fort werd meerdere keren herbouwd na overstromingen.",watTeZien:"Het Archeologisch Steunpunt Valkenburg toont de geschiedenis. Delen van het fort zijn opgegraven en worden beschermd.",verwachteVondsten:"Militaire uitrusting, aardewerk uit het Rijnland en Galli, munten, en bouwmateriaal. Hier zijn ook inscripties gevonden.",betekenis:"Een van de best onderzochte forten aan de Rijn. Geeft veel informatie over het dagelijks leven van Romeinse soldaten.",bronnen:["https://www.livius.org/articles/place/praetorium-agrippinae-valkenburg/"]},"Castra Hunnerberg":{naam:"Castra Hunnerberg",latinNaam:"Castra",type:"legerkamp",periode:"19 v.Chr. - ca. 70 n.Chr.",beschrijving:"Op de Hunnerberg bij Nijmegen lag een groot legerkamp. Hier waren tijdelijk twee volledige legioenen (10.000 soldaten) gestationeerd.",watWasHier:"Een enorm legerkamp van 42 hectare, een van de grootste ten noorden van de Alpen. Hier werden veldtochten naar Germani voorbereid.",watTeZien:"Op de Hunnerberg zijn de wallen nog zichtbaar in het landschap. Het Museum Het Valkhof toont veel vondsten.",verwachteVondsten:"Militaire uitrusting van hoge kwaliteit, munten van Augustus en Tiberius, legioenstempels op dakpannen, en resten van wapens.",betekenis:"Dit was de belangrijkste legerbasis in het vroege Romeinse Nederland. Vanaf hier werden de oorlogen tegen de Germanen gevoerd.",bronnen:["https://www.livius.org/articles/place/noviomagus-nijmegen-hunnerberg/"]},"Castellum Kops Plateau":{naam:"Kops Plateau",latinNaam:"Oppidum Batavorum",type:"castellum",periode:"ca. 10 v.Chr. - 70 n.Chr.",beschrijving:"Op het Kops Plateau in Nijmegen lag een vroege militaire basis, later de hoofdstad van de Bataven.",watWasHier:"Eerst een Romeins kamp, later de civiele hoofdstad Oppidum Batavorum. Hier woonden Romeinen en Bataven samen.",watTeZien:"Het Kops Plateau is nu een natuurgebied. Opgravingen hebben veel informatie opgeleverd. Museum Het Valkhof toont de vondsten.",verwachteVondsten:"Vroege Romeinse militaria, Keltisch-Bataafse voorwerpen, importaardewerk, en munten uit de tijd van Augustus.",betekenis:"Dit was het eerste contactpunt tussen Romeinen en Bataven. Hier begon de romanisering van Nederland.",bronnen:["https://www.livius.org/articles/place/noviomagus-nijmegen-kops-plateau/"]},"Nijmegen, Valkhof":{naam:"Valkhof Nijmegen",latinNaam:"Valkhof",type:"versterking",periode:"ca. 270 n.Chr. - 400 n.Chr.",beschrijving:"Op het Valkhof stond een laat-Romeinse versterking. Later bouwde Karel de Grote hier een palts.",watWasHier:"Een versterkte positie uit de tijd dat het Romeinse Rijk onder druk stond. De soldaten bewaakten de Waaloever.",watTeZien:"Het Valkhofpark met de Sint-Nicolaaskapel (deels Karolingisch). Museum Het Valkhof toont de geschiedenis.",verwachteVondsten:"Laat-Romeinse munten, gordeltjes en riemtongen, aardewerk uit de 3e en 4e eeuw, en militaire gespen.",betekenis:"Toont de overgang van het Romeinse Rijk naar de vroege middeleeuwen. Nijmegen bleef een belangrijk centrum.",bronnen:["https://www.museumhetvalkhof.nl"]},"Castellum Op de Hoge Woerd":{naam:"Hoge Woerd",latinNaam:"Castellum",type:"castellum",periode:"ca. 50 n.Chr. - 270 n.Chr.",beschrijving:"Dit fort lag in Leidsche Rijn bij Utrecht. Het is nu een archeologisch park.",watWasHier:"Een middengroot castellum met houten gebouwen. Buiten de muren lag een burgerdorp. Hier is een compleet Romeins schip gevonden.",watTeZien:"Archeologisch Park Castellum Hoge Woerd met de reconstructie van het fort en een museum. Je kunt over de fundamenten lopen.",verwachteVondsten:"Militaire uitrusting, scheepsonderdelen, aardewerk, munten, en door de natte grond ook organisch materiaal.",betekenis:"Een van de best bewaarde en gepresenteerde Romeinse forten in Nederland. Ideaal om te zien hoe een fort eruitzag.",bronnen:["https://www.hogewoerd.nl"]},Lugdunum:{naam:"Lugdunum Batavorum",latinNaam:"Lugdunum Batavorum",type:"castellum",periode:"ca. 40 n.Chr. - 270 n.Chr.",beschrijving:"Lugdunum lag in Katwijk, aan de monding van de Rijn in zee. Het was het westelijkste fort van de Limes.",watWasHier:"Een castellum dat de riviermonding bewaakte. Hier eindigde de Rijn en begon de zee. Er was ook een vuurtoren.",watTeZien:"Het fort is door de zee weggespoeld. In het Rijksmuseum van Oudheden in Leiden zijn vondsten te zien.",verwachteVondsten:"Op het strand worden soms voorwerpen gevonden na stormen. Munten, aardewerk en militaria.",betekenis:"Het westelijke eindpunt van de Limes. Hier begonnen zeereizen naar Britannia.",bronnen:["https://www.livius.org/articles/place/lugdunum-batavorum-katwijk/"]},"Vlootbasis Naaldwijk":{naam:"Vlootbasis Naaldwijk",type:"vlootbasis",periode:"1e eeuw n.Chr.",beschrijving:"Bij Naaldwijk lag mogelijk een basis voor de Romeinse vloot (Classis Germanica).",watWasHier:"Een haven met schepen die langs de kust patrouilleerden en troepen naar Britannia vervoerden.",watTeZien:"Het gebied is nu landbouwgrond. Vondsten zijn in lokale musea te zien.",verwachteVondsten:"Scheepsonderdelen, ankers, militaire uitrusting voor mariniers, importaardewerk.",betekenis:"Toont het belang van de Romeinse vloot voor de verdediging van de kust.",bronnen:[]},"Minifort Ockenburg":{naam:"Minifort Ockenburg",type:"minifort",periode:"ca. 150 n.Chr.",beschrijving:"Bij Ockenburg in Den Haag stond een klein Romeins fortje dat de kust bewaakte.",watWasHier:"Een kleine wachtpost met ruimte voor een handvol soldaten. Het lag op een strandwal.",watTeZien:"Het terrein is beschermd maar niet toegankelijk. Vondsten zijn in het Haags Historisch Museum.",verwachteVondsten:"Kleine hoeveelheden militaria, aardewerk, en munten.",betekenis:"Toont dat de Romeinen ook de kust bewaakten, niet alleen de rivieren.",bronnen:[]},"Castellum Ceuclum":{naam:"Ceuclum",latinNaam:"Ceuclum",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Ceuclum lag bij Cuijk aan de Maas. Het bewaakte een brug over de rivier.",watWasHier:"Een middelgroot castellum bij een belangrijke rivierovergang. De weg naar het noorden liep hier.",watTeZien:"In Cuijk zijn restanten gevonden. Het Maasmuseum toont lokale vondsten.",verwachteVondsten:"Munten, fibulae, aardewerk, en materiaal gerelateerd aan de brug.",betekenis:"Een belangrijke schakel in het Romeinse wegennet langs de Maas.",bronnen:["https://www.livius.org/articles/place/ceuclum-cuijk/"]},"Castellum Meinerswijk":{naam:"Meinerswijk",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Bij Arnhem-Meinerswijk lag een Romeins fort aan de Rijn.",watWasHier:"Een castellum dat de rivierroute bewaakte. Het lag in de uiterwaarden.",watTeZien:"Het terrein is nu natuurgebied. Vondsten zijn in Museum Arnhem te zien.",verwachteVondsten:"Militaria, aardewerk, munten, en scheepsresten.",betekenis:"Onderdeel van de keten van forten langs de Rijn.",bronnen:[]},Levefanum:{naam:"Levefanum",latinNaam:"Levefanum",type:"versterking",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Levefanum lag bij Wijk bij Duurstede, waar de Rijn splitste in de Lek en de Kromme Rijn.",watWasHier:"Een militaire post bij een strategische riviersplitsing. Mogelijk ook een haven.",watTeZien:"Het terrein is bebouwd. Dorestad Museum toont de latere geschiedenis van deze plek.",verwachteVondsten:"Munten, aardewerk, militaria, en handelsproducten.",betekenis:"Een belangrijk controlepunt voor het scheepvaartverkeer.",bronnen:[]},"Nigrum Pullum":{naam:"Nigrum Pullum",latinNaam:"Nigrum Pullum",type:"minifort",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Nigrum Pullum (Zwarte Poel) lag bij Zwammerdam. Het was een klein fortje in het veengebied.",watWasHier:"Een klein fort met pakhuizen. Er zijn meerdere Romeinse schepen gevonden.",watTeZien:"De schepen zijn in het Rijksmuseum van Oudheden in Leiden. Het terrein zelf is niet te bezoeken.",verwachteVondsten:"Scheepsonderdelen, bouwmaterialen, aardewerk, en door de natte grond organisch materiaal.",betekenis:"Beroemd om de goed bewaarde Romeinse schepen. Toont transport over water.",bronnen:["https://www.rmo.nl"]},"Stenen wachttoren Vleuterweide":{naam:"Wachttoren Vleuterweide",type:"wachttoren",periode:"ca. 150 n.Chr.",beschrijving:"In Vleuterweide bij Utrecht stond een stenen wachttoren. Dit was ongebruikelijk - de meeste waren van hout.",watWasHier:"Een versterkte toren met uitzicht over de omgeving. Mogelijk woonden hier ook families van soldaten.",watTeZien:"De fundamenten zijn gemarkeerd in de wijk. Vondsten zijn in het Centraal Museum Utrecht.",verwachteVondsten:"Bouwmaterialen (dakpannen, stenen), aardewerk, en persoonlijke bezittingen.",betekenis:"Een van de weinige bekende stenen wachttorens. Toont variatie in Romeinse bouwwijzen.",bronnen:[]},"Wachttoren Bunnik":{naam:"Wachttoren Bunnik",type:"wachttoren",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Bij Bunnik stond een houten wachttoren aan de Rijn.",watWasHier:"Een uitkijkpost waar soldaten de rivier in de gaten hielden en signalen doorgaven.",watTeZien:"De exacte locatie is niet precies bekend. Het gebied is nu bebouwd.",verwachteVondsten:"Kleine hoeveelheden militaria en aardewerk.",betekenis:"Onderdeel van het signaleringssysteem langs de Limes.",bronnen:[]},"Castellum Maastricht":{naam:"Castellum Maastricht",latinNaam:"Mosae Trajectum",type:"versterking",periode:"3e - 4e eeuw n.Chr.",beschrijving:"In het centrum van Maastricht stond een laat-Romeinse versterking bij de brug over de Maas.",watWasHier:"Een verdedigingswerk uit de tijd dat het Rijk onder druk stond. Het bewaakte de rivierovergang.",watTeZien:"Onder het Vrijthof zijn resten gevonden. Centre Ceramique toont de Romeinse geschiedenis.",verwachteVondsten:"Laat-Romeinse munten, militaire riembeslag, aardewerk, en bouwmaterialen.",betekenis:"Toont de continuiteit - Maastricht bleef belangrijk van de Romeinse tijd tot nu.",bronnen:["https://www.centreceramique.nl"]},Roompot:{naam:"Roompot Fort",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Bij de Roompot in Zeeland lag een Romeins fort dat de zeeroute bewaakte.",watWasHier:"Een versterking aan de kust die schepen beschermde en piraterij teginging.",watTeZien:"Het fort is door de zee verzwolgen. Soms spoelen vondsten aan.",verwachteVondsten:"Door erosie kunnen munten en voorwerpen op het strand gevonden worden.",betekenis:"Toont dat de Romeinen ook de Zeeuwse wateren controleerden.",bronnen:[]},"Castellum Carvium":{naam:"Carvium",latinNaam:"Carvium",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Carvium lag bij Herwen, waar de Rijn en de Waal samenkwamen.",watWasHier:"Een fort bij een strategisch punt waar twee grote rivieren samenkwamen.",watTeZien:"Het gebied is nu natuurgebied. Vondsten zijn in Museum Het Valkhof in Nijmegen.",verwachteVondsten:"Militaria, aardewerk, munten, en scheepsresten.",betekenis:"Controleerde een belangrijk knooppunt van waterwegen.",bronnen:[]}},Xwe={naam:"Romeins fort",type:"versterking",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Een Romeinse militaire versterking langs de noordgrens van het Rijk.",watWasHier:"Een militaire post met soldaten die de grens bewaakten. Vaak was er ook een burgerdorp (vicus) in de buurt.",watTeZien:"De meeste forten zijn nu verdwenen of overbouwd. Lokale musea tonen vaak vondsten.",verwachteVondsten:"Munten, fibulae (mantelspelden), aardewerk, wapens en gereedschap.",betekenis:"Onderdeel van de Limes, de noordelijke grens van het Romeinse Rijk die door Nederland liep."},qwe={castellum:"Castellum (legerplaats)",wachttoren:"Wachttoren (signaalpost)",vlootbasis:"Vlootbasis (haven)",legerkamp:"Legerkamp (castra)",minifort:"Minifort (wachtpost)",versterking:"Versterking",villa:"Villa (militair gebruikt)"};vn.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs");function Zwe(n){if(!n)return n;const e={Mo:"ma",Tu:"di",We:"wo",Th:"do",Fr:"vr",Sa:"za",Su:"zo",Mon:"ma",Tue:"di",Wed:"wo",Thu:"do",Fri:"vr",Sat:"za",Sun:"zo",PH:"feestdagen",SH:"schoolvakantie"};let t=n;return Object.entries(e).forEach(([r,i])=>{t=t.replace(new RegExp(`\\b${r}\\b`,"gi"),i)}),t=t.replace(/\boff\b/gi,"gesloten").replace(/\bclosed\b/gi,"gesloten").replace(/\bopen\b/gi,"open"),t}async function Qwe(n){try{const e=xn(n),t=vn("EPSG:4326","EPSG:28992",e);if(t[0]<7e3||t[0]>3e5||t[1]<289e3||t[1]>629e3)return null;const r=1,s=`https://service.pdok.nl/rws/ahn/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=dtm_05m&QUERY_LAYERS=dtm_05m&INFO_FORMAT=application/json&CRS=EPSG:28992&BBOX=${`${t[0]-r},${t[1]-r},${t[0]+r},${t[1]+r}`}&WIDTH=1&HEIGHT=1&I=0&J=0`,o=await(await fetch(s)).json();if(o.features&&o.features.length>0){const l=o.features[0].properties,u=l?.value_list??l?.GRAY_INDEX??l?.value??l?.gray_index;if(u!=null){const h=typeof u=="number"?u:parseFloat(u);if(!isNaN(h))return h}}}catch(e){console.warn("AHN height query failed:",e)}return null}const Jwe={ABG:"Alphen-Chaam",ACM:"Alkmaar",ALF:"Alfen",ALK:"Alkemade",AML:"Ameland",AMR:"Amerongen",AMS:"Amsterdam",ANL:"Anloo",APD:"Apeldoorn",ARN:"Arnhem",ASN:"Assen",AVW:"Avenhorn",BDA:"Breda",BLK:"Blokker",BRN:"Barneveld",DEL:"Delft",DHG:"Den Haag",DRD:"Dordrecht",EHV:"Eindhoven",EMN:"Emmen",EPE:"Epe",GNP:"Gennep",GRN:"Groningen",GRV:"Grave",GTB:"Giethoorn",HDK:"Harderwijk",HLM:"Haarlem",HLN:"Heiloo",HRL:"Harlingen",HTN:"Houten",LDN:"Leiden",LWR:"Leeuwarden",MST:"Maastricht",NKK:"Nijkerk",NMG:"Nijmegen",OTM:"Ootmarsum",RTD:"Rotterdam",SND:"Sneek",TBG:"Tilburg",UTR:"Utrecht",VLO:"Venlo",WGN:"Wageningen",ZWL:"Zwolle",ZTP:"Zutphen",444:"Houten",811:"Gouda",310:"Utrecht",344:"Amsterdam",363:"Rotterdam",518:"Den Haag",758:"Eindhoven",772:"Tilburg",855:"Breda",85:"Arnhem",268:"Nijmegen",14:"Groningen",80:"Leeuwarden",995:"Maastricht",106:"Enschede",153:"Zwolle",34:"Almere"},eEe={1:"Zeer lage trefkans op archeologische resten",2:"Lage trefkans op archeologische resten",3:"Middelhoge trefkans op archeologische resten",4:"Hoge trefkans op archeologische resten",5:"Lage trefkans (water)",6:"Middelhoge trefkans (water)",7:"Hoge trefkans (water)",8:"Water",9:"Niet gekarteerd"};function MO(n,e){const t=[],r=n.toLowerCase(),i=(e||"").toLowerCase();return r.includes("kalkhoudend")||i.endsWith("a")?t.push("Kalkhoudend = goede metaalconservering"):(r.includes("kalkarm")||r.includes("kalkloos"))&&t.push("Kalkarm = meer corrosie op metalen"),r.includes("poldervaag")?t.push("Poldervaaggrond = jonge rivierklei, ingepolderd gebied"):r.includes("enkeerdgrond")||r.includes("enk")?t.push("Enkeerdgrond = oude akkers met plaggenbemesting - archeologisch interessant!"):r.includes("podzol")?t.push("Podzolgrond = uitgeloogde zandgrond, vaak zuur"):(r.includes("veengrond")||r.includes("veen"))&&t.push("Veengrond = zuur, slechte metaalconservering (tenzij waterverzadigd)"),r.includes("zware klei")?t.push("Zware klei = moeilijk graven, goede conservering"):r.includes("lichte klei")||r.includes("zavel")?t.push("Zavel/lichte klei = redelijk te graven"):r.includes("zand")&&!r.includes("zavel")&&t.push("Zandgrond = makkelijk graven"),r.includes("rivierklei")||i.startsWith("r")?t.push("Rivierafzetting"):(r.includes("zeeklei")||i.startsWith("m"))&&t.push("Zeekleiafzetting"),t}function tEe(){const n=Ji(mt=>mt.map),e=Ko(mt=>mt.removeVondst),t=Ko(mt=>mt.updateVondst),r=Ko(mt=>mt.vondsten),{layers:i,addPoint:s,addLayer:a}=Xi(),[o,l]=ne.useState([]),[u,h]=ne.useState(0),[f,g]=ne.useState(!1),[y,v]=ne.useState(null),[x,E]=ne.useState(!1),[T,b]=ne.useState(!1),[I,M]=ne.useState(null),[F,z]=ne.useState(null),[P,C]=ne.useState(null),[k,L]=ne.useState(!1),[O,U]=ne.useState(null),[j,Te]=ne.useState(null),[Ce,Ue]=ne.useState(null),[Ne,le]=ne.useState(!1),[ue,Se]=ne.useState(""),[se,V]=ne.useState([]),J=se[u]||null,[re,q]=ne.useState(()=>{const mt=localStorage.getItem("popupTextScale");return mt?parseInt(mt):100}),he=mt=>{q(mt),localStorage.setItem("popupTextScale",mt.toString())},Me=o[u]||"",je=o.length>1,De=mt=>{const jt=mt.match(/<strong[^>]*>(.*?)<\/strong>/);if(jt){const Pn=jt[1].replace(/<[^>]+>/g,""),_t=mt.replace(jt[0],"").replace(/^(<br\s*\/?>)+/,"");return{title:Pn,contentWithoutTitle:_t}}return{title:"",contentWithoutTitle:mt}},Be=mt=>mt.replace(/class="([^"]*)"/g,(Pn,_t)=>{if(_t.includes("text-xs")){const Jt=_t.replace(/\btext-xs\b/g,"").trim();return Jt?`style="font-size:0.857em" class="${Jt}"`:'style="font-size:0.857em"'}if(_t.includes("text-sm")){const Jt=_t.replace(/\btext-sm\b/g,"").trim();return Jt?`class="${Jt}"`:""}return Pn}).replace(/class=""/g,""),{title:Gt,contentWithoutTitle:Kt}=De(Me),wn=Be(Kt),Bt=Me.includes("Landbouwperceel"),Fn=Me.includes("data-vondst-id="),Qt=()=>{h(mt=>(mt-1+o.length)%o.length)},ot=()=>{h(mt=>(mt+1)%o.length)},Zn=async()=>{if(console.log(" HOOGTEKAART KNOP GEKLIKT"),console.log(" parcelCoordinate uit state:",y),!n||!y||T){console.log(" STOP - map:",!!n,"coord:",y,"loading:",T);return}console.log(` DOORGEVEN AAN showParcelHeightMap: [${y[0]}, ${y[1]}]`),b(!0);try{await ime(n,y)&&E(!0)}catch(mt){console.error("Failed to load height map:",mt)}finally{b(!1)}},on=()=>{n&&(Bb(n),E(!1))};ne.useEffect(()=>{if(!n)return;const mt=_t=>{let Jt='<strong class="text-purple-800">AMK Monument</strong>';if(_t.toponiem&&(Jt+=`<br/><span class="text-sm font-semibold">${_t.toponiem}</span>`),_t.kwaliteitswaarde&&(Jt+=`<br/><span class="text-sm text-purple-700">${_t.kwaliteitswaarde}</span>`),_t.omschrijving&&(Jt+=`<br/><span class="text-xs text-gray-600 mt-1 block">${_t.omschrijving}</span>`),_t.txt_label){const Rt=_t.txt_label.split(", ").slice(0,3).join(", ");Jt+=`<br/><span class="text-xs text-gray-500 italic">${Rt}${_t.txt_label.split(", ").length>3?"...":""}</span>`}return Jt},jt=async(_t,Jt)=>{const Rt=[],rr=n.getLayers().getArray().filter(ai=>ai instanceof rh&&ai.getVisible()?ai.getSource()instanceof tH:!1);for(const ai of rr){const Gr=ai.getSource();if(!Gr)continue;const Ut=ai.get("title")||"";if(Ut.startsWith("Paleokaart"))continue;if(Ut==="Archeo Landschappen"){try{const Oe=xn(_t),we=vn("EPSG:4326","EPSG:28992",Oe),pe=100,N=`https://services.rce.geovoorziening.nl/landschappenkaart/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=landschappenkaart_nl&QUERY_LAYERS=landschappenkaart_nl&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${we[0]-pe},${we[1]-pe},${we[0]+pe},${we[1]+pe}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties,X=Z.landschapsnaam||Z.naam||"Archeologisch Landschap",ce=Z.omschrijving||"";let de=`<strong class="text-green-800">${X}</strong>`;ce&&(de+=`<br/><span class="text-sm text-gray-600">${ce}</span>`),de+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',de+='<div class="text-sm text-gray-700 mt-1">Een archeologisch landschap is een gebied waar het landschap nog sporen draagt van menselijke activiteit uit het verleden. Denk aan oude akkers, nederzettingen of verdedigingswerken.</div>',de+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',de+='<div class="text-sm text-gray-700 mt-1">Aardewerk, munten, gereedschap en andere voorwerpen van vroegere bewoners. De kans op vondsten hangt af van het type landschap.</div>',de+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',de+='<div class="text-sm text-gray-700 mt-1"><a href="https://www.cultureelerfgoed.nl/onderwerpen/bronnen-en-kaarten/overzicht/landschappenkaart" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">RCE Landschappenkaart</a></div>',de+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Landschapstypen_van_Nederland" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia: Landschapstypen</a></div>',Rt.push(de)}}catch(Oe){console.warn("Archeo Landschappen WMS query failed:",Oe)}continue}if(Ut==="Essen"){try{const Oe=xn(_t),we=vn("EPSG:4326","EPSG:28992",Oe),pe=100,N=`https://services.rce.geovoorziening.nl/landschapsatlas/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=essen&QUERY_LAYERS=essen&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${we[0]-pe},${we[1]-pe},${we[0]+pe},${we[1]+pe}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties;let X='<strong class="text-amber-800">Es (historisch akkercomplex)</strong>';(Z.naam||Z.Naam||Z.NAME)&&(X+=`<br/><span class="text-sm font-semibold text-amber-700">${Z.naam||Z.Naam||Z.NAME}</span>`),(Z.type||Z.Type||Z.TYPE)&&(X+=`<br/><span class="text-xs text-gray-600">${Z.type||Z.Type||Z.TYPE}</span>`),(Z.omschrijving||Z.Omschrijving)&&(X+=`<br/><span class="text-xs text-gray-500">${Z.omschrijving||Z.Omschrijving}</span>`),X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is een es?</span></div>',X+='<div class="text-sm text-gray-700 mt-1">Een es is een oud akkercomplex op hogere zandgronden. Eeuwenlang werden hier gewassen verbouwd. De bodem werd bemest met plaggen en mest, waardoor de grond donker en vruchtbaar werd.</div>',X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',X+='<div class="text-sm text-gray-700 mt-1">Munten, gespen, knopen, aardewerk en soms bijzondere voorwerpen die door bemesting op het land terechtkwamen. Essen behoren tot de beste vindplaatsen voor metaaldetectie.</div>',X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Conservering</span></div>',X+='<div class="text-sm text-gray-700 mt-1 italic">De zure zandgrond tast metaal aan. IJzer en koper zijn vaak slecht bewaard. Zilver en brons houden zich beter.</div>',X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',X+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Es_(geografie)" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia: Es (geografie)</a></div>',Rt.push(X)}}catch(Oe){console.warn("Essen WMS query failed:",Oe)}continue}if(Ut==="FAMKE Steentijd"){try{const Oe=xn(_t),we=vn("EPSG:4326","EPSG:28992",Oe),pe=100,N=`https://geoportaal.fryslan.nl/arcgis/services/Themas/cultuurhistorie/MapServer/WMSServer?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=FAMKE_Advies_steentijd-bronstijd3339&QUERY_LAYERS=FAMKE_Advies_steentijd-bronstijd3339&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${we[0]-pe},${we[1]-pe},${we[0]+pe},${we[1]+pe}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties;let X='<strong class="text-amber-800">FAMKE Steentijd-Bronstijd</strong>';X+='<br/><span class="text-sm text-gray-500">Friese verwachtingskaart voor oude vondsten</span>';const ce=Z.advies||Z.Advies||"";if(ce){X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat betekent dit?</span></div>',X+=`<div class="text-sm text-amber-700 mt-1">${ce}</div>`;const de=ce.toLowerCase();let Ve="",be="text-gray-600",$e="";de.includes("karterend")?(Ve="Op deze plek verwachten archeologen vondsten uit de steentijd of bronstijd. Bij graafwerk moet er eerst onderzoek komen.",$e="Goede kans op oude vondsten (vuursteen, bijlen, aardewerk)",be="text-amber-600"):de.includes("waarderend")?(Ve="Hier zijn mogelijk belangrijke vindplaatsen. Proefsleuven zijn nodig om te kijken wat er precies zit.",$e="Mogelijk interessante vondsten uit de prehistorie",be="text-orange-600"):de.includes("geen")?(Ve="De kans op prehistorische vondsten is hier klein. De grond is waarschijnlijk te jong of te veel verstoord.",$e="Weinig kans op steentijd-vondsten",be="text-green-600"):de.includes("quickscan")&&(Ve="Hier is eerst bureau-onderzoek nodig. Er kunnen vondsten zitten, maar dat is nog niet zeker.",$e="Onbekend, nader onderzoek nodig",be="text-blue-600"),Ve&&(X+=`<div class="text-sm ${be} mt-1">${Ve}</div>`),$e&&(X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',X+=`<div class="text-sm text-gray-700 mt-1">${$e}</div>`),X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is FAMKE?</span></div>',X+='<div class="text-sm text-gray-700 mt-1">FAMKE is de Friese Archeologische Monumentenkaart Extra. Deze kaart toont waar in Friesland vondsten uit de steentijd en bronstijd te verwachten zijn.</div>'}Rt.push(X)}}catch(Oe){console.warn("FAMKE WMS query failed:",Oe)}continue}if(Ut==="Archeo Onderzoeken"){try{const Oe=xn(_t),we=vn("EPSG:4326","EPSG:28992",Oe),pe=100,N=`https://data.geo.cultureelerfgoed.nl/openbaar/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=archeologische_onderzoeksmeldingen_openbaar_rd&QUERY_LAYERS=archeologische_onderzoeksmeldingen_openbaar_rd&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${we[0]-pe},${we[1]-pe},${we[0]+pe},${we[1]+pe}`}&FEATURE_COUNT=20`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0)for(const Z of W.features){const X=Z.properties;let ce='<strong class="text-blue-800">Archeologisch Onderzoek</strong>';const de=X.type_onderzoek||"";de&&(ce+=`<br/><span class="text-sm font-semibold text-blue-700">${de}</span>`);const Ve=X.projectnaam||X.project_naam||X.naam||"";if(Ve&&(ce+=`<br/><span class="text-sm text-gray-800">${Ve}</span>`),X.onderzoeksmeldingnummer&&(ce+=`<br/><span class="text-xs text-gray-500 font-mono">OM: ${X.onderzoeksmeldingnummer}</span>`),X.uitvoerder&&(ce+=`<br/><span class="text-sm text-gray-700">Uitvoerder: ${X.uitvoerder}</span>`),X.startdatum||X.einddatum){const $e=[X.startdatum,X.einddatum].filter(Boolean).join(" - ");ce+=`<br/><span class="text-xs text-gray-600">Periode: ${$e}</span>`}X.gemeente&&(ce+=`<br/><span class="text-xs text-gray-500">${X.gemeente}</span>`);const be=[];if(X.periode_paleolithicum&&be.push("Paleolithicum"),X.periode_mesolithicum&&be.push("Mesolithicum"),X.periode_neolithicum&&be.push("Neolithicum"),X.periode_bronstijd&&be.push("Bronstijd"),X.periode_ijzertijd&&be.push("IJzertijd"),X.periode_romeins&&be.push("Romeins"),X.periode_middeleeuwen&&be.push("Middeleeuwen"),X.periode_nieuwe_tijd&&be.push("Nieuwe tijd"),be.length>0&&(ce+=`<br/><span class="text-sm text-purple-700">Datering: ${be.join(", ")}</span>`),ce+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat betekent dit?</span></div>',de.toLowerCase().includes("opgraving")?ce+='<div class="text-sm text-gray-700 mt-1">Hier is een archeologische opgraving gedaan. Professionele archeologen hebben vondsten en sporen gedocumenteerd en geborgen.</div>':de.toLowerCase().includes("bureauonderzoek")?ce+='<div class="text-sm text-gray-700 mt-1">Een bureauonderzoek naar de archeologische verwachting op basis van historische bronnen en kaarten.</div>':de.toLowerCase().includes("booronderzoek")?ce+='<div class="text-sm text-gray-700 mt-1">Met boringen is onderzocht wat er in de grond zit. Vaak de eerste stap om te bepalen of er verder onderzoek nodig is.</div>':de.toLowerCase().includes("proefsleuven")?ce+='<div class="text-sm text-gray-700 mt-1">Proefsleuven zijn gegraven om te kijken of er archeologische sporen in de grond zitten.</div>':de.toLowerCase().includes("begeleiding")?ce+='<div class="text-sm text-gray-700 mt-1">Archeologische begeleiding bij graafwerk. Een archeoloog was aanwezig om te controleren of er vondsten naar boven kwamen.</div>':de.toLowerCase().includes("inventariserend")?ce+='<div class="text-sm text-gray-700 mt-1">Verkennend onderzoek om te bepalen of er archeologische resten in de grond kunnen zitten.</div>':ce+='<div class="text-sm text-gray-700 mt-1">Op deze locatie is archeologisch onderzoek uitgevoerd. De resultaten zijn opgeslagen in het landelijke archief.</div>',ce+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Interessant voor detectie?</span></div>',ce+='<div class="text-sm text-gray-700 mt-1 italic">Onderzoekslocaties kunnen interessant zijn: archeologen vinden vaak niet alles. Maar check altijd eerst of je daar mag zoeken.</div>',ce+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Rapport opzoeken</span></div>',X.onderzoeksmeldingnummer){const $e=X.onderzoeksmeldingnummer;ce+=`<div class="text-sm text-gray-700 mt-1"><a href="https://easy.dans.knaw.nl/ui/datasets?q=${encodeURIComponent($e)}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Zoek rapport in DANS-EASY</a></div>`,ce+='<div class="text-sm text-gray-700 mt-1"><a href="https://archis.cultureelerfgoed.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Zoek in ARCHIS</a></div>'}ce+='<div class="text-sm text-gray-700 mt-1"><a href="https://bibliotheek.cultureelerfgoed.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Bibliotheek voor Archeologie</a></div>',Rt.push(ce)}}catch(Oe){console.warn("Archeo Onderzoeken WMS query failed:",Oe)}continue}if(Ut==="IKAW"){try{const Oe=xn(_t),we=vn("EPSG:4326","EPSG:28992",Oe),pe=500,N=`https://services.rce.geovoorziening.nl/ikaw/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=IKAW3Indicatievekaartarcheologischewaarden2008&QUERY_LAYERS=IKAW3Indicatievekaartarcheologischewaarden2008&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${we[0]-pe},${we[1]-pe},${we[0]+pe},${we[1]+pe}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties,X=Math.round(Z.PALETTE_INDEX||Z.palette_index||0),ce=eEe[X]||`Trefkans onbekend (${X})`;let de='<strong class="text-orange-800">IKAW Verwachtingskaart</strong>';de+='<br/><span class="text-sm text-gray-500">Kaart met kansen op archeologische vondsten</span>',de+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat betekent dit?</span></div>',de+=`<div class="text-sm text-orange-700 mt-1">${ce}</div>`;const be={1:{tekst:"De kans op archeologische vondsten is hier zeer klein. De grond is waarschijnlijk verstoord of te jong.",vondsten:"Niet veel te verwachten, maar verrassingen zijn altijd mogelijk.",kleur:"text-gray-600"},2:{tekst:"De kans op vondsten is laag, maar niet uitgesloten. Soms worden hier toch interessante objecten gevonden.",vondsten:"Af en toe losse vondsten uit verschillende periodes.",kleur:"text-yellow-600"},3:{tekst:"Dit is een interessant gebied met een redelijke kans op vondsten. Hier woonden of werkten mensen in het verleden.",vondsten:"Aardewerk, munten, metalen voorwerpen uit verschillende tijdperken.",kleur:"text-amber-600"},4:{tekst:"Dit is een zeer kansrijk gebied! Hier zijn waarschijnlijk resten van oude bewoning of activiteit. Let op: bij graafwerk kan een vergunning nodig zijn.",vondsten:"Grote kans op interessante vondsten: aardewerk, munten, sieraden, gereedschap.",kleur:"text-orange-600"},5:{tekst:"Dit is een waterbodem. Vondsten zijn hier moeilijker te bereiken maar kunnen goed bewaard zijn gebleven.",vondsten:"Scheepswrakken, verloren lading, gedumpte voorwerpen.",kleur:"text-blue-600"},6:{tekst:"Waterbodem met archeologische potentie. Hier kunnen interessante vondsten liggen die door het water goed bewaard zijn.",vondsten:"Scheepsresten, ankers, aardewerk, metalen voorwerpen.",kleur:"text-blue-600"},7:{tekst:"Waterbodem met hoge archeologische waarde. Hier zijn bekende vindplaatsen of scheepswrakken.",vondsten:"Belangrijke maritieme vondsten, beschermd gebied.",kleur:"text-blue-700"}}[X];be&&(de+=`<div class="text-sm ${be.kleur} mt-1">${be.tekst}</div>`,de+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',de+=`<div class="text-sm text-gray-700 mt-1">${be.vondsten}</div>`),de+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is de IKAW?</span></div>',de+='<div class="text-sm text-gray-700 mt-1">De IKAW (Indicatieve Kaart Archeologische Waarden) toont de kans op archeologische vondsten in heel Nederland. De kaart is gemaakt door de Rijksdienst voor het Cultureel Erfgoed.</div>',Rt.push(de)}}catch(Oe){console.warn("IKAW WMS query failed:",Oe)}continue}if(Ut==="Inundatiegebieden"){try{const Oe=xn(_t),we=vn("EPSG:4326","EPSG:28992",Oe),pe=100,N=`https://services.rce.geovoorziening.nl/liniesenstellingen/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=inundaties&QUERY_LAYERS=inundaties&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${we[0]-pe},${we[1]-pe},${we[0]+pe},${we[1]+pe}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties;let X='<strong class="text-blue-800">Inundatiegebied</strong>';(Z["linie-naam"]||Z.linie_naam)&&(X+=`<br/><span class="text-sm font-semibold text-blue-700">${Z["linie-naam"]||Z.linie_naam}</span>`),Z.naam&&(X+=`<br/><span class="text-sm text-gray-700">${Z.naam}</span>`),Z.periode&&(X+=`<br/><span class="text-xs text-gray-500">${Z.periode}</span>`),Z.lin_period&&(X+=`<br/><span class="text-xs text-gray-400">${Z.lin_period}</span>`),Rt.push(X)}}catch(Oe){console.warn("Inundatiegebieden WMS query failed:",Oe)}continue}if(Ut==="Militaire Objecten"){try{const Oe=xn(_t),we=vn("EPSG:4326","EPSG:28992",Oe),pe=50,N=`https://services.rce.geovoorziening.nl/liniesenstellingen/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=objecten&QUERY_LAYERS=objecten&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${we[0]-pe},${we[1]-pe},${we[0]+pe},${we[1]+pe}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties,X=Z.obj_soort||"",ce=Z.obj_naam||"",de=Z.lin_period||"",Ve=Z["linie-naam"]||Z.linie_naam||"";let be=X||"Militair Object",$e="Dit is een historisch militair object uit de Nederlandse verdedigingsgeschiedenis.",et="";const ft=X.toLowerCase();ft.includes("fort")?($e="Een fort is een versterkte verdedigingspost, vaak met dikke muren en geschutsopstellingen. Forten maakten deel uit van grotere verdedigingslinies.",et="Rond forten worden soms kogels, knopen van uniformen, muntjes of andere militaire voorwerpen gevonden."):ft.includes("schans")?($e="Een schans is een kleinere versterking, vaak gemaakt van aarde en palissaden. Schansen werden gebruikt om strategische punten te verdedigen.",et="Bij schansen kun je musketkogels, knopen en soms munten uit de 17e-18e eeuw tegenkomen."):ft.includes("batterij")||ft.includes("battery")?($e="Een batterij is een geschutsopstelling, vaak op een strategische plek om vijanden onder vuur te nemen.",et="Bij batterijen worden soms kanonkogels of onderdelen van geschut gevonden."):ft.includes("bunker")||ft.includes("kazemat")?($e="Een bunker of kazemat is een versterkte betonnen schuilplaats. Veel werden gebouwd rond 1940 als onderdeel van verdedigingslinies.",et="Bij bunkers worden soms militaire voorwerpen uit WOII gevonden, zoals knopen, gespen of munitieresten."):ft.includes("sluis")||ft.includes("inlaatwerk")?($e="Militaire sluizen en inlaatwerken werden gebruikt om land onder water te zetten (inunderen). Dit was een belangrijke verdedigingstactiek.",et="Bij historische sluizen worden soms voorwerpen gevonden van soldaten die deze bewaakten."):ft.includes("toren")||ft.includes("wachttoren")?($e="Wachttorens werden gebruikt om de omgeving in de gaten te houden en vijandelijke bewegingen te signaleren.",et="Bij torens worden soms persoonlijke voorwerpen van soldaten gevonden."):ft.includes("kazerne")&&($e="Een kazerne is een gebouw waar soldaten gelegerd waren. Hier woonden, aten en oefenden de troepen.",et="Rond kazernes worden regelmatig knopen, gespen en andere persoonlijke voorwerpen gevonden.");let St=`<strong class="text-stone-800">${be}</strong>`;ce&&(St+=`<br/><span class="text-sm font-semibold text-stone-700">${ce}</span>`),Ve&&(St+=`<br/><span class="text-sm text-blue-600">${Ve}</span>`),de&&(St+=`<br/><span class="text-xs text-gray-500">${de}</span>`),St+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',St+=`<div class="text-sm text-gray-700 mt-1">${$e}</div>`,et&&(St+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',St+=`<div class="text-sm text-gray-700 mt-1">${et}</div>`),St+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',St+='<div class="text-sm text-gray-700 mt-1">',St+='<a href="https://erfgoedenlocatie.nl/linies-en-stellingen" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">RCE Linies en Stellingen</a>',St+="</div>",Rt.push(St)}}catch(Oe){console.warn("Militaire Objecten WMS query failed:",Oe)}continue}if(Ut==="Verdedigingslinies"){try{const Oe=xn(_t),we=vn("EPSG:4326","EPSG:28992",Oe),pe=100,N=`https://services.rce.geovoorziening.nl/liniesenstellingen/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=linies&QUERY_LAYERS=linies&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${we[0]-pe},${we[1]-pe},${we[0]+pe},${we[1]+pe}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties;let X='<strong class="text-amber-800">Verdedigingslinie</strong>';const ce={"Hollandse Waterlinie":"Verdedigingsstelsel (1815-1940) dat gebruik maakte van inundaties om Holland te beschermen. UNESCO Werelderfgoed.","Nieuwe Hollandse Waterlinie":"Uitgebreide versie (1815-1940) met forten en inundatiegebieden van Muiden tot Gorinchem.","Stelling van Amsterdam":"Ringverdediging rond Amsterdam (1880-1920) met 42 forten. UNESCO Werelderfgoed.",Grebbelinie:"Verdedigingslinie langs de Grebbe (17e-20e eeuw). Zware gevechten in mei 1940.",IJssellinie:"Koude Oorlog verdediging (1950-1968) langs de IJssel tegen Sovjet-invasie.",Atlantikwall:"Duitse kustverdediging WOII (1942-1945) van Noorwegen tot Spanje.","Peel-Raamstelling":"Verdedigingslinie in Brabant/Limburg. Gevechten mei 1940.","Maas-Waalstelling":"Linie tussen Maas en Waal, onderdeel landsverdediging.",Zuiderwaterlinie:"Waterlinie in West-Brabant en Zeeland (17e-19e eeuw).","Staats-Spaanse Linies":"Vestingwerken uit de 80-jarige oorlog (1568-1648)."},de=Z.naam||Z.lin_naam||"";if(de){X+=`<br/><span class="text-sm font-semibold text-amber-700">${de}</span>`;const Ve=Object.entries(ce).find(([be])=>de.toLowerCase().includes(be.toLowerCase())||be.toLowerCase().includes(de.toLowerCase()));Ve&&(X+=`<br/><span class="text-sm text-gray-700">${Ve[1]}</span>`)}Z.lin_period&&(X+=`<br/><span class="text-xs text-purple-600">${Z.lin_period}</span>`),Z.status&&(X+=`<br/><span class="text-xs text-gray-400">${Z.status}</span>`),Rt.push(X)}}catch(Oe){console.warn("Verdedigingslinies WMS query failed:",Oe)}continue}if(Ut==="Rijksmonumenten"){try{const Oe=xn(_t),we=vn("EPSG:4326","EPSG:28992",Oe),pe=50,N=`https://data.geo.cultureelerfgoed.nl/openbaar/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=rijksmonumentpunten&QUERY_LAYERS=rijksmonumentpunten&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${we[0]-pe},${we[1]-pe},${we[0]+pe},${we[1]+pe}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties;let X='<strong class="text-red-800">Rijksmonument</strong>';(Z.cbsNaam||Z.cbs_naam)&&(X+=`<br/><span class="text-sm font-semibold">${Z.cbsNaam||Z.cbs_naam}</span>`),Z.hoofdcategorie&&(X+=`<br/><span class="text-sm text-red-700">${Z.hoofdcategorie}</span>`),Z.subcategorie&&(X+=`<br/><span class="text-xs text-gray-600">${Z.subcategorie}</span>`),Z.rijksmonumentnummer&&(X+=`<br/><span class="text-xs text-gray-500">Nr: ${Z.rijksmonumentnummer}</span>`),(Z.bouwjaar||Z.oorspronkelijkebouwjaar)&&(X+=`<br/><span class="text-xs text-gray-500">Bouwjaar: ${Z.bouwjaar||Z.oorspronkelijkebouwjaar}</span>`),X+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',Z.rijksmonumentnummer&&(X+=`<div class="text-sm text-gray-700 mt-1"><a href="https://monumentenregister.cultureelerfgoed.nl/monumenten/${Z.rijksmonumentnummer}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Bekijk in Monumentenregister</a></div>`),X+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Rijksmonument" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia: Rijksmonument</a></div>',Rt.push(X)}}catch(Oe){console.warn("Rijksmonumenten WMS query failed:",Oe)}continue}if(Ut==="Werelderfgoed"){try{const Oe=xn(_t),we=vn("EPSG:4326","EPSG:28992",Oe),pe=500,N=`https://service.pdok.nl/rce/ps-ch/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=PS.ProtectedSite&QUERY_LAYERS=PS.ProtectedSite&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${we[0]-pe},${we[1]-pe},${we[0]+pe},${we[1]+pe}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties;let X='<strong class="text-cyan-800">UNESCO Werelderfgoed</strong>';(Z.siteName||Z.naam)&&(X+=`<br/><span class="text-sm font-semibold text-cyan-700">${Z.siteName||Z.naam}</span>`),Z.siteDesignation&&(X+=`<br/><span class="text-xs text-gray-600">${Z.siteDesignation}</span>`),Rt.push(X)}}catch(Oe){console.warn("Werelderfgoed WMS query failed:",Oe)}continue}if(Ut==="Terpen"){try{const Oe=xn(_t),we=vn("EPSG:4326","EPSG:28992",Oe),pe=100,N=`https://geoportaal.fryslan.nl/arcgis/services/Themas/cultuurhistorie/MapServer/WMSServer?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=terpen3335&QUERY_LAYERS=terpen3335&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${we[0]-pe},${we[1]-pe},${we[0]+pe},${we[1]+pe}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties,X=Z.naam||Z.NAAM||Z.Naam||"Terp",ce=Z.plaats||Z.PLAATS||Z.Plaats||"";let de=`<strong class="text-orange-800">${X}</strong>`;ce&&(de+=`<br/><span class="text-sm text-gray-500">${ce}</span>`),de+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',de+='<div class="text-sm text-gray-700 mt-1">Een terp is een kunstmatige heuvel. Mensen bouwden deze heuvels om droog te wonen in het vlakke, natte land. Terpen zijn vaak meer dan 2000 jaar oud.</div>',de+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',de+='<div class="text-sm text-gray-700 mt-1">Op en rond terpen worden vaak vondsten gedaan:</div>',de+='<ul class="list-disc list-inside text-sm text-gray-700 mt-1 space-y-0.5">',de+="<li>Middeleeuws aardewerk en botten</li>",de+="<li>Munten uit verschillende periodes</li>",de+="<li>Metalen voorwerpen (gespen, fibulae, sieraden)</li>",de+="<li>Soms Romeinse of zelfs prehistorische vondsten</li>",de+="</ul>",de+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Waarom zijn terpen interessant?</span></div>',de+='<div class="text-sm text-gray-700 mt-1">Terpen waren vaak dorpskernen waar mensen eeuwenlang woonden. Door de ophoging bleven veel voorwerpen goed bewaard. Let op: sommige terpen zijn beschermd monument!</div>',de+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bezoeken</span></div>',de+='<div class="text-sm text-gray-700 mt-1">Veel terpen zijn nog zichtbaar in het landschap. Vraag altijd toestemming aan de grondeigenaar voordat je gaat detecteren.</div>',Rt.push(de)}}catch(Oe){console.warn("Terpen WMS query failed:",Oe)}continue}if(Ut==="Religieus Erfgoed"){try{const Oe=xn(_t),we=vn("EPSG:4326","EPSG:28992",Oe),pe=50,N=`https://services.rce.geovoorziening.nl/landschapsatlas_view/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=religieuserfgoed&QUERY_LAYERS=religieuserfgoed&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${we[0]-pe},${we[1]-pe},${we[0]+pe},${we[1]+pe}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties,X=Z.naam||Z.NAAM||Z.name||Z.NAME||"Onbekend",ce=Z.denominatie||Z.DENOMINATIE||Z.religie||"",de=Z.type||Z.TYPE||Z.functie||"",Ve=Z.bouwjaar||Z.BOUWJAAR||Z.jaar||"",be=Z.gemeente||Z.GEMEENTE||Z.plaats||"";let $e=`<strong class="text-purple-800">${X}</strong>`;const et=de.toLowerCase();let ft="Een religieus gebouw of heilige plek.",St="Munten van kerkgangers, knopen, gespen, religieuze voorwerpen";et.includes("kerk")||et.includes("church")?(ft="Een kerk was het hart van de gemeenschap. Hier kwamen mensen samen voor diensten, maar ook voor belangrijke gebeurtenissen.",St="Munten uit de collecte, knopen, gespen, pelgrimsinsignes, loden zegels"):et.includes("kapel")||et.includes("chapel")?(ft="Een kapel is een klein gebedshuis, vaak bij een landgoed, langs een weg, of op een bijzondere plek.",St="Devotionalia, munten, kruisjes, rozenkransen"):et.includes("synagoge")?(ft="Een synagoge is een Joods gebedshuis. Veel synagogen in Nederland zijn verwoest of herbestemd na de Tweede Wereldoorlog.",St="Munten, knopen, kleine religieuze voorwerpen"):et.includes("klooster")||et.includes("monastery")?(ft="Een klooster was een woon- en werkplek voor monniken of nonnen. Veel kloosters hadden eigen werkplaatsen en landerijen.",St="Religieuze voorwerpen, zegels, gereedschap, aardewerk, middeleeuwse munten"):et.includes("toren")||et.includes("tower")?(ft="Een kerktoren of klokkentoren. Soms is alleen de toren nog over van een verdwenen kerk.",St="Munten, knopen, bouwmateriaal"):(et.includes("begraafplaats")||et.includes("cemetery"))&&(ft="Een historische begraafplaats. Detecteren op begraafplaatsen is niet toegestaan zonder toestemming.",St="Detecteren hier niet toegestaan"),ce&&($e+=`<br/><span class="text-sm text-purple-600">${ce}</span>`),de&&($e+=`<br/><span class="text-sm text-gray-600">${de}</span>`),Ve&&($e+=`<br/><span class="text-sm text-gray-500">Bouwjaar: ${Ve}</span>`),be&&($e+=`<br/><span class="text-xs text-gray-400">${be}</span>`),$e+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',$e+=`<div class="text-sm text-gray-700 mt-1">${ft}</div>`,$e+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',$e+=`<div class="text-sm text-gray-700 mt-1">${St}</div>`,$e+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bezoeken</span></div>',et.includes("begraafplaats")?$e+='<div class="text-sm text-red-600 mt-1">Detecteren op begraafplaatsen is niet toegestaan. Respecteer de rust van de overledenen.</div>':$e+='<div class="text-sm text-gray-700 mt-1">Veel kerken en religieuze gebouwen zijn beschermd monument. Vraag altijd toestemming voordat je gaat detecteren op het terrein.</div>',Rt.push($e)}}catch(Oe){console.warn("Religieus Erfgoed WMS query failed:",Oe)}continue}if(Ut==="Gewaspercelen"){try{const Oe=xn(_t),we=vn("EPSG:4326","EPSG:28992",Oe),pe=50,kt=`${we[0]-pe},${we[1]-pe},${we[0]+pe},${we[1]+pe}`,N=`https://service.pdok.nl/rvo/brpgewaspercelen/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=BrpGewas&QUERY_LAYERS=BrpGewas&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${kt}`,Pt=`https://service.pdok.nl/bzk/bro-bodemkaart/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=soilarea&QUERY_LAYERS=soilarea&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${kt}`,[W,Z]=await Promise.all([fetch(N),fetch(Pt).catch(()=>null)]),X=await W.json();if(X.features&&X.features.length>0){const ce=X.features[0].properties;let de='<strong class="text-green-800">Landbouwperceel</strong>';if((ce.gewas||ce.gewasnaam)&&(de+=`<br/><span class="text-sm font-semibold text-green-700">${ce.gewas||ce.gewasnaam}</span>`),(ce.categorie||ce.category)&&(de+=`<br/><span class="text-xs text-gray-600">${ce.categorie||ce.category}</span>`),ce.oppervlakte&&(de+=`<br/><span class="text-xs text-gray-500">${ce.oppervlakte} ha</span>`),Z)try{const Ve=await Z.json();if(Ve.features&&Ve.features.length>0){const be=Ve.features[0].properties,$e=be.first_soilname||be.soilname||be.bodemtype,et=be.first_soilcode||be.soilcode||be.maparea_soilcode;if($e){de+=`<br/><span class="text-xs text-amber-700 font-medium">Grondsoort: ${$e}</span>`;const ft=MO($e,et);ft.length>0&&(de+=`<br/><span class="text-xs text-gray-500 italic">${ft.join("  ")}</span>`)}}}catch{}Rt.push(de)}}catch(Oe){console.warn("BRP Gewaspercelen WMS query failed:",Oe)}continue}if(Ut==="Kadastrale Grenzen"){try{const Oe=xn(_t),we=vn("EPSG:4326","EPSG:28992",Oe),pe=20,N=`https://service.pdok.nl/kadaster/kadastralekaart/wms/v5_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=Perceel&QUERY_LAYERS=Perceel&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${we[0]-pe},${we[1]-pe},${we[0]+pe},${we[1]+pe}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties,X=Z.kadastraleGemeenteWaarde||Z.kadastrale_gemeente_waarde||Z.kadastraleGemeente||Jwe[String(Z.kadastraleGemeenteCode)]||Z.kadastraleGemeenteCode,ce=Z.sectie||Z.Sectie||"",de=Z.perceelnummer||Z.perceelNummer||Z.Perceelnummer||"",Ve=Z.kadastraleGrootteWaarde||Z.kadastrale_grootte_waarde||Z.kadastraleGrootte||Z.oppervlakte,be=Z.AKRKadastraleGemeenteCodeWaarde||Z.akrKadastraleGemeenteCodeWaarde||"",$e=[X,ce,de].filter(Boolean).join(" "),et=be&&ce&&de?`${be}-${ce}-${de}`:"";let ft='<strong class="text-indigo-800">Kadastraal Perceel</strong>';if($e&&(ft+=`<br/><span class="text-sm text-indigo-700">${$e}</span>`),et&&(ft+=`<br/><span class="text-sm font-bold text-gray-800 font-mono">${et}</span>`),Ve){const St=typeof Ve=="number"?Ve:parseFloat(Ve);isNaN(St)||(ft+=`<br/><span class="text-xs text-gray-600">${St.toLocaleString("nl-NL")} m</span>`)}ft+='<br/><br/><span class="text-xs text-gray-600">Eigenaar opzoeken? Kopieer bovenstaande code, ga naar </span><a href="https://www.kadaster.nl/winkel" target="_blank" rel="noopener" class="text-xs text-blue-600 hover:underline">kadaster.nl/winkel</a><span class="text-xs text-gray-600"> en klik "Zoek op aanduiding"</span><span class="text-xs text-gray-400"> (betaalde dienst)</span>',Rt.push(ft)}}catch(Oe){console.warn("Kadastrale Grenzen WMS query failed:",Oe)}continue}if(Ut==="Scheepswrakken"){try{const Oe=xn(_t),we=vn("EPSG:4326","EPSG:28992",Oe),pe=100,N=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_SCHEEPSRESTANTEN&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_SCHEEPSRESTANTEN&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${we[0]-pe},${we[1]-pe},${we[0]+pe},${we[1]+pe}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties;let X='<strong class="text-cyan-800">Scheepswrak</strong>';(Z.naam||Z.NAAM)&&(X+=`<br/><span class="text-sm font-semibold text-cyan-700">${Z.naam||Z.NAAM}</span>`),(Z.type||Z.TYPE)&&(X+=`<br/><span class="text-sm text-gray-700">${Z.type||Z.TYPE}</span>`),(Z.datering||Z.DATERING)&&(X+=`<br/><span class="text-xs text-gray-500">Datering: ${Z.datering||Z.DATERING}</span>`),(Z.bron||Z.BRON)&&(X+=`<br/><span class="text-xs text-gray-400">${Z.bron||Z.BRON}</span>`),Rt.push(X)}}catch(Oe){console.warn("Scheepswrakken WMS query failed:",Oe)}continue}if(Ut==="Woonheuvels ZH"){try{const Oe=xn(_t),we=vn("EPSG:4326","EPSG:28992",Oe),pe=100,N=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_WOONHEUVEL&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_WOONHEUVEL&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${we[0]-pe},${we[1]-pe},${we[0]+pe},${we[1]+pe}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties;let X='<strong class="text-orange-800">Woonheuvel</strong>';(Z.naam||Z.NAAM)&&(X+=`<br/><span class="text-sm font-semibold text-orange-700">${Z.naam||Z.NAAM}</span>`),(Z.type||Z.TYPE)&&(X+=`<br/><span class="text-sm text-gray-700">${Z.type||Z.TYPE}</span>`),Rt.push(X)}}catch(Oe){console.warn("Woonheuvels WMS query failed:",Oe)}continue}if(Ut==="Romeinse Forten"){try{const Oe=xn(_t),we=vn("EPSG:4326","EPSG:28992",Oe),pe=200,N=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_ROMEINSFORT&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_ROMEINSFORT&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${we[0]-pe},${we[1]-pe},${we[0]+pe},${we[1]+pe}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties;let X='<strong class="text-red-800">Romeins Fort</strong>';(Z.naam||Z.NAAM)&&(X+=`<br/><span class="text-sm font-semibold text-red-700">${Z.naam||Z.NAAM}</span>`),(Z.type||Z.TYPE)&&(X+=`<br/><span class="text-sm text-gray-700">${Z.type||Z.TYPE}</span>`),(Z.periode||Z.PERIODE)&&(X+=`<br/><span class="text-xs text-gray-500">${Z.periode||Z.PERIODE}</span>`),Rt.push(X)}}catch(Oe){console.warn("Romeinse Forten WMS query failed:",Oe)}continue}if(Ut==="Windmolens"){try{const Oe=xn(_t),we=vn("EPSG:4326","EPSG:28992",Oe),pe=50,N=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_NEDERZETTING_WINDMOLENS&QUERY_LAYERS=CHS_2015_NEDERZETTING_WINDMOLENS&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${we[0]-pe},${we[1]-pe},${we[0]+pe},${we[1]+pe}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties;let X='<strong class="text-amber-800">Windmolen</strong>';(Z.naam||Z.NAAM)&&(X+=`<br/><span class="text-sm font-semibold text-amber-700">${Z.naam||Z.NAAM}</span>`),(Z.type||Z.TYPE||Z.functie||Z.FUNCTIE)&&(X+=`<br/><span class="text-sm text-gray-700">${Z.type||Z.TYPE||Z.functie||Z.FUNCTIE}</span>`),(Z.bouwjaar||Z.BOUWJAAR)&&(X+=`<br/><span class="text-xs text-gray-500">Bouwjaar: ${Z.bouwjaar||Z.BOUWJAAR}</span>`),Rt.push(X)}}catch(Oe){console.warn("Windmolens WMS query failed:",Oe)}continue}if(Ut==="Erfgoedlijnen"){try{const Oe=xn(_t),we=vn("EPSG:4326","EPSG:28992",Oe),pe=200,N=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_ERFGOEDLIJN_HOOFDSTRUCTUUR&QUERY_LAYERS=CHS_ERFGOEDLIJN_HOOFDSTRUCTUUR&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${we[0]-pe},${we[1]-pe},${we[0]+pe},${we[1]+pe}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties;let X='<strong class="text-purple-800">Erfgoedlijn</strong>';(Z.naam||Z.NAAM||Z.erfgoedlijn)&&(X+=`<br/><span class="text-sm font-semibold text-purple-700">${Z.naam||Z.NAAM||Z.erfgoedlijn}</span>`),(Z.type||Z.TYPE)&&(X+=`<br/><span class="text-sm text-gray-700">${Z.type||Z.TYPE}</span>`),(Z.omschrijving||Z.OMSCHRIJVING)&&(X+=`<br/><span class="text-xs text-gray-500">${Z.omschrijving||Z.OMSCHRIJVING}</span>`),Rt.push(X)}}catch(Oe){console.warn("Erfgoedlijnen WMS query failed:",Oe)}continue}if(Ut==="Oude Kernen"){try{const Oe=xn(_t),we=vn("EPSG:4326","EPSG:28992",Oe),pe=200,N=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_KERNEN&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_KERNEN&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${we[0]-pe},${we[1]-pe},${we[0]+pe},${we[1]+pe}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties;let X='<strong class="text-stone-800">Historische Kern</strong>';(Z.naam||Z.NAAM)&&(X+=`<br/><span class="text-sm font-semibold text-stone-700">${Z.naam||Z.NAAM}</span>`),(Z.type||Z.TYPE)&&(X+=`<br/><span class="text-sm text-gray-700">${Z.type||Z.TYPE}</span>`),(Z.periode||Z.PERIODE)&&(X+=`<br/><span class="text-xs text-gray-500">${Z.periode||Z.PERIODE}</span>`),Rt.push(X)}}catch(Oe){console.warn("Oude Kernen WMS query failed:",Oe)}continue}if(Ut==="Relictenkaart Punten"){try{const Oe=xn(_t),we=vn("EPSG:4326","EPSG:28992",Oe),pe=50,N=`https://geoserver.gelderland.nl/geoserver/ngr_a/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=ChAr_Relictenkaart_p&QUERY_LAYERS=ChAr_Relictenkaart_p&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${we[0]-pe},${we[1]-pe},${we[0]+pe},${we[1]+pe}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties,X={KV:"Kasteel/Vesting",K:"Kapel",KE:"Kerkhof",B:"Buitenhuis",OB:"Oud Bebouwingsrelict",OV:"Oude Verkaveling",NR:"Nijverheidsrelict",GH:"Grafheuvel",BP:"Begraafplaats",HH:"Havezate",RM:"Rosmolen",WM:"Windmolen",PM:"Poldermolen",EK:"Eendenkooi",SH:"Scholtenhoeve"},ce=Z.type?.replace(/[0-9]/g,"")||"",de=X[ce]||Z.type||"Cultuurhistorisch object";let Ve='<strong class="text-emerald-800">Relict</strong>';Ve+=`<br/><span class="text-sm font-semibold text-emerald-700">${de}</span>`,Z.type&&ce!==Z.type&&(Ve+=`<br/><span class="text-xs text-gray-500">Code: ${Z.type}</span>`),Z.streek&&(Ve+=`<br/><span class="text-xs text-gray-400">Streek: ${Z.streek}</span>`),Rt.push(Ve)}}catch(Oe){console.warn("Relictenkaart Punten WMS query failed:",Oe)}continue}if(Ut==="Relictenkaart Lijnen"){try{const Oe=xn(_t),we=vn("EPSG:4326","EPSG:28992",Oe),pe=50,N=`https://geoserver.gelderland.nl/geoserver/ngr_a/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=ChAr_Relictenkaart_l&QUERY_LAYERS=ChAr_Relictenkaart_l&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${we[0]-pe},${we[1]-pe},${we[0]+pe},${we[1]+pe}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties,ce={1:"Sprengenbeek",2:"Oude waterloop",3:"Doorgaande weg",4:"Hessenweg",5:"Oude weg",6:"Historische grens",7:"Trekpad",8:"Jaagpad"}[Z.klasse]||`Historisch lijnrelict (${Z.klasse})`;let de='<strong class="text-teal-800">Lijnrelict</strong>';de+=`<br/><span class="text-sm font-semibold text-teal-700">${ce}</span>`,Rt.push(de)}}catch(Oe){console.warn("Relictenkaart Lijnen WMS query failed:",Oe)}continue}if(Ut==="Relictenkaart Vlakken"){try{const Oe=xn(_t),we=vn("EPSG:4326","EPSG:28992",Oe),pe=100,N=`https://geoserver.gelderland.nl/geoserver/ngr_a/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=ChAr_Relictenkaart_v&QUERY_LAYERS=ChAr_Relictenkaart_v&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${we[0]-pe},${we[1]-pe},${we[0]+pe},${we[1]+pe}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties,ce={1:"Onveranderd agrarisch (voor 1850)",2:"Jonge heideontginning (1850-1950)",3:"Open essencomplex",4:"Kampenlandschap",5:"Heiderelict (1850)",6:"Bosrelict (1850)",7:"Stuifzandrelict",8:"Oud bouwland",9:"Historisch grasland",10:"Beekdal"}[Z.klasse]||`Historisch landschap (${Z.klasse})`;let de='<strong class="text-lime-800">Landschapsrelict</strong>';if(de+=`<br/><span class="text-sm font-semibold text-lime-700">${ce}</span>`,Z.st_area_shape_){const Ve=(Z.st_area_shape_/1e4).toFixed(1);de+=`<br/><span class="text-xs text-gray-500">${Ve} ha</span>`}Rt.push(de)}}catch(Oe){console.warn("Relictenkaart Vlakken WMS query failed:",Oe)}continue}if(Ut==="Verdronken Dorpen"){try{const Oe=xn(_t),we=vn("EPSG:4326","EPSG:28992",Oe),pe=200,N=`https://opengeodata.zeeland.nl/geoserver/chs/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=geocmd_vrddrppnt&QUERY_LAYERS=geocmd_vrddrppnt&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${we[0]-pe},${we[1]-pe},${we[0]+pe},${we[1]+pe}`}`,W=await(await fetch(N)).json();if(W.features&&W.features.length>0){const Z=W.features[0].properties;let X='<strong class="text-blue-800">Verdronken Dorp</strong>';(Z.naam||Z.NAAM)&&(X+=`<br/><span class="text-sm font-semibold text-blue-700">${Z.naam||Z.NAAM}</span>`),(Z.verdronken||Z.VERDRONKEN||Z.jaar||Z.JAAR)&&(X+=`<br/><span class="text-xs text-gray-600">Verdronken: ${Z.verdronken||Z.VERDRONKEN||Z.jaar||Z.JAAR}</span>`),(Z.gemeente||Z.GEMEENTE)&&(X+=`<br/><span class="text-xs text-gray-500">${Z.gemeente||Z.GEMEENTE}</span>`),(Z.bron||Z.BRON)&&(X+=`<br/><span class="text-xs text-gray-400">${Z.bron||Z.BRON}</span>`),Rt.push(X)}}catch(Oe){console.warn("Verdronken Dorpen WMS query failed:",Oe)}continue}const es=Gr.getFeatureInfoUrl(_t,Jt,"EPSG:3857",{INFO_FORMAT:"application/json"});if(es)try{const we=await(await fetch(es)).json();if(we.features&&we.features.length>0){const pe=we.features[0].properties;if(Ut==="AHN 0.5m"){let W='<strong class="text-blue-800">AHN Hoogtekaart</strong>';const Z=pe.value_list??pe.GRAY_INDEX??pe.value??pe.gray_index??pe.dtm_05m??pe.DTM_05M??pe.hoogte??pe.HOOGTE??pe.elevation??pe.ELEVATION;if(Z!=null&&!isNaN(Number(Z))){const X=typeof Z=="number"?Z.toFixed(2):Number(Z).toFixed(2);W+=`<br/><span class="text-sm text-blue-700">Hoogte: ${X} m NAP</span>`,Rt.push(W)}else{let X=!1;const ce=["geometry","id","fid","gml_id","bbox"];for(const[de,Ve]of Object.entries(pe))!ce.includes(de.toLowerCase())&&Ve!==null&&Ve!==""&&(W+=`<br/><span class="text-xs text-gray-600">${de}: ${Ve}</span>`,X=!0);X&&Rt.push(W)}continue}if(Ut==="Geomorfologie"){let W='<strong class="text-green-800">Geomorfologie</strong>',Z=!1;const X=pe.landform_subgroup_description,ce=pe.relief_klasse,de=pe.relief_subklasse,Ve=pe.genese_description,be=pe.active_process;if(X&&(W+=`<br/><span class="text-sm text-green-700">${X}</span>`,Z=!0),ce){const $e=de&&de!==ce?`${ce} (${de})`:ce;W+=`<br/><span class="text-xs text-gray-600">Relief: ${$e}</span>`,Z=!0}if(Ve&&(W+=`<br/><span class="text-xs text-gray-500">Ontstaan: ${Ve}</span>`,Z=!0),be&&be!=="onbekend"&&(W+=`<br/><span class="text-xs text-gray-500">Actief proces: ${be}</span>`,Z=!0),!Z){const $e=["geometry","id","fid","gml_id","bbox","fuuid","geom","collection_id"];for(const[et,ft]of Object.entries(pe))!$e.includes(et.toLowerCase())&&ft!==null&&ft!==""&&!et.includes("validfrom")&&!et.includes("validto")&&(W+=`<br/><span class="text-xs text-gray-600">${et}: ${ft}</span>`)}W+='<br/><a href="https://legendageomorfologie.wur.nl/" target="_blank" rel="noopener" class="text-xs text-blue-600 hover:underline">Meer over geomorfologie</a>',Rt.push(W);continue}let kt=`<strong>${Ut}</strong>`;const N=pe.first_soilname||pe.soilname,Pt=pe.soilcode||pe.first_soilcode;if(N&&(kt+=`<br/><span class="text-sm text-amber-700">${N}</span>`,Ut==="Bodemkaart")){const W=MO(N,Pt);W.length>0&&(kt+=`<br/><span class="text-xs text-gray-500 italic">${W.join("  ")}</span>`)}if(pe.soilslope&&pe.soilslope!=="Niet opgenomen"&&(kt+=`<br/><span class="text-xs text-gray-500">Helling: ${pe.soilslope}</span>`),!N){const W=["geometry","id","fid","gml_id","GRAY_INDEX","gray_index","value"];for(const[Z,X]of Object.entries(pe))!W.includes(Z)&&X&&X!=="Niet opgenomen"&&(kt+=`<br/><span class="text-xs text-gray-600">${Z}: ${X}</span>`)}Rt.push(kt)}}catch(Oe){console.warn("WMS GetFeatureInfo failed:",Oe)}}return Rt},Pn=async _t=>{const Jt=[],Rt=[],rr=we=>{if(!we)return;const pe=we.getType(),N=we.clone().transform("EPSG:3857","EPSG:4326").getCoordinates();return{type:pe,coordinates:N}},ai=Qwe(_t.coordinate),Gr=[];n.forEachFeatureAtPixel(_t.pixel,we=>{Gr.push(we)});for(const we of Gr){const pe=we.getProperties(),{geometry:kt,...N}=pe;if(N.vondst){const X=N.vondst,ce=`<strong>${X.objectType}</strong>
            <div data-vondst-id="${X.id}"></div>
            <br/><span class="text-sm text-gray-600"><strong>Materiaal:</strong> ${X.material}</span>
            <br/><span class="text-sm text-gray-600"><strong>Periode:</strong> ${X.period}</span>
            ${X.depth?`<br/><span class="text-sm text-gray-600"><strong>Diepte:</strong> ${X.depth} cm</span>`:""}
            ${X.condition&&X.condition!=="Onbekend"?`<br/><span class="text-sm text-gray-600"><strong>Conditie:</strong> ${X.condition}</span>`:""}
            ${X.weight?`<br/><span class="text-sm text-gray-600"><strong>Gewicht:</strong> ${X.weight} gram</span>`:""}
            ${X.notes?`<br/><span class="text-sm text-gray-600"><strong>Notities:</strong> ${X.notes}</span>`:""}
            ${X.photoUrl?`<br/><a href="${X.photoUrl}" target="_blank" rel="noopener" class="text-blue-600 hover:underline text-sm"> Bekijk foto</a>`:""}
            <br/><span class="text-xs text-gray-400">${new Date(X.timestamp).toLocaleDateString("nl-NL")}</span>`;Jt.push(ce),Rt.push(null),M(X.id);continue}if(N.layerType==="customPoint"&&N.customPoint){const X=N.customPoint,ce=N.customLayerName||"Mijn Laag",de=N.customLayerColor||"#f97316";let Ve="";if(X.popupContent?(Ve=`<div class="flex items-center gap-2 mb-2 pb-2 border-b border-gray-100">
              <span class="w-3 h-3 rounded-full flex-shrink-0" style="background-color: ${de}"></span>
              <span class="text-xs font-medium" style="color: ${de}">${ce}</span>
            </div>`,Ve+=X.popupContent):(Ve=`<strong>${X.name}</strong>`,Ve+=`<br/><span class="text-xs text-gray-500">${ce}</span>`,X.category&&X.category!=="Overig"&&(Ve+=`<br/><span class="text-sm text-gray-600"><strong>Categorie:</strong> ${X.category}</span>`)),X.photos&&X.photos.length>0){Ve+='<div class="flex flex-wrap gap-1 my-2">';for(const be of X.photos.slice(0,3)){const $e=be.thumbnailUrl||be.thumbnailBase64;$e&&(Ve+=`<img src="${$e}" alt="Foto" class="w-16 h-16 object-cover rounded border border-gray-200" />`)}X.photos.length>3&&(Ve+=`<span class="text-xs text-gray-400 self-end">+${X.photos.length-3} meer</span>`),Ve+="</div>"}X.notes&&!X.popupContent&&(Ve+=`<br/><span class="text-sm text-gray-600 mt-1">${X.notes}</span>`),X.url&&(Ve+=`<br/><a href="${X.url}" target="_blank" rel="noopener" class="text-blue-600 hover:underline text-sm">Meer info</a>`),Ve+=`<br/><span class="text-xs text-gray-400">${new Date(X.createdAt).toLocaleDateString("nl-NL")}</span>`,Jt.push(Ve),Rt.push(null);continue}if(N.layerType==="importedLayer"){const X=N.layerName||"Gemporteerde laag",ce=N.layerColor||"#8b5cf6",de=["layerType","layerId","layerName","layerColor","featureIndex","geometry"],Ve=N.name||N.Name||N.naam||N.title||N.NAAM||N.NAME||N.label||N.description||"Feature";let be=`<strong style="color: ${ce}">${Ve}</strong>`;be+=`<br/><span class="text-xs text-gray-500">${X}</span>`;const $e=Object.entries(N).filter(([et])=>!de.includes(et)&&et!=="name"&&et!=="Name");if($e.length>0){be+='<div class="mt-2 space-y-1">';for(const[et,ft]of $e)if(ft!=null&&ft!==""){const St=et.replace(/_/g," ").replace(/([a-z])([A-Z])/g,"$1 $2").replace(/^./,ur=>ur.toUpperCase());let sn=String(ft);sn.length>200&&(sn=sn.substring(0,200)+"..."),sn.startsWith("http://")||sn.startsWith("https://")?be+=`<div class="text-sm"><span class="text-gray-500">${St}:</span> <a href="${sn}" target="_blank" rel="noopener" class="text-blue-600 hover:underline">Link</a></div>`:be+=`<div class="text-sm"><span class="text-gray-500">${St}:</span> <span class="text-gray-700">${sn}</span></div>`}be+="</div>"}Jt.push(be),Rt.push({geometry:rr(kt),properties:N,popupHtml:be});continue}if(N.kwaliteitswaarde&&N.kwaliteitswaarde.includes("archeologische waarde")){const X=mt(N);Jt.push(X),Rt.push({geometry:rr(kt),properties:N,popupHtml:X});continue}if(N.layerType==="romeinsFort"||N.layerType==="romeinsFortLijn"){const X=N.Name||N.name||"",ce=N.description||"",de=Ywe[X]||null,Ve=de||Xwe;let be=`<strong class="text-red-800">${de?Ve.naam:X||"Romeins Fort"}</strong>`;de?.latinNaam&&de.latinNaam!==Ve.naam&&(be+=`<br/><span class="text-sm text-red-600 italic">${de.latinNaam}</span>`),be+=`<br/><span class="text-sm text-gray-600">${qwe[Ve.type]||Ve.type}</span>`,be+=`<br/><span class="text-xs text-gray-500">${Ve.periode}</span>`,N.layerType==="romeinsFortLijn"&&(be+='<br/><span class="text-xs text-red-700 mt-1"> Gereconstrueerde fortomtrek</span>'),be+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Over dit fort</span></div>',be+=`<div class="text-sm text-gray-700 mt-1">${Ve.beschrijving}</div>`,be+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat was hier?</span></div>',be+=`<div class="text-sm text-gray-700 mt-1">${Ve.watWasHier}</div>`,be+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is er nu nog te zien?</span></div>',be+=`<div class="text-sm text-gray-700 mt-1">${Ve.watTeZien}</div>`,be+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',be+=`<div class="text-sm text-gray-700 mt-1">${Ve.verwachteVondsten}</div>`,be+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Historische betekenis</span></div>',be+=`<div class="text-sm text-gray-700 mt-1">${Ve.betekenis}</div>`,de?.bronnen&&de.bronnen.length>0?(be+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bronnen</span></div>',be+='<div class="text-sm text-gray-700 mt-1">',de.bronnen.forEach($e=>{const et=$e.replace(/^https?:\/\//,"").split("/")[0];be+=`<a href="${$e}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline block">${et}</a>`}),be+="</div>"):(be+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',be+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Limes_(Romeinse_Rijk)" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia: Romeinse Limes</a></div>'),!de&&ce&&(be+=`<div class="mt-3"><span class="text-xs text-gray-500 italic">${ce}</span></div>`),Jt.push(be),Rt.push({geometry:rr(kt),properties:N,popupHtml:be});continue}let Pt=N.name||N.Name||N.naam||N.title||N.NAAM||N.NAME||N.label||N.route_name||N.road_name;Pt||(N.leisure==="playground"?Pt="Speeltuin":N.leisure==="park"?Pt="Park":N.leisure==="swimming_area"||N.sport==="swimming"?Pt="Zwemplek":N.tourism==="museum"?Pt="Museum":N.amenity==="cafe"||N.amenity==="restaurant"?Pt=N.amenity==="cafe"?"Caf":"Restaurant":N.historic==="castle"?Pt="Kasteel":Pt="Info"),(N.bunker_type||N.name&&(N.name.toLowerCase().includes("bunker")||N.name.toLowerCase().includes("kazemat")||N.name.toLowerCase().includes("schuilplaats")))&&(Pt="Bunker"),N.historic==="battlefield"&&(Pt="Historisch slagveld");let W=`<strong>${Pt}</strong>`;if(N.category&&(W+=`<br/><span class="text-sm text-gray-600">Categorie: ${N.category}</span>`),N.from_to&&N.from_to!==Pt&&(W+=`<br/><span class="text-sm text-gray-600">${N.from_to}</span>`),N.route&&N.route!==Pt&&(W+=`<br/><span class="text-sm text-gray-600">${N.route}</span>`),N.TOPONIEM&&(W+=`<br/><span class="text-sm font-semibold text-gray-800">${N.TOPONIEM}</span>`,N.PLAATS&&(W+=`<br/><span class="text-xs text-gray-500">${N.PLAATS}</span>`)),(N.AARD_VINDP||N.Aard_vindp)&&(W+=`<br/><span class="text-sm text-gray-700">Aard: ${N.AARD_VINDP||N.Aard_vindp}</span>`),N.BEGIN_PER&&N.EIND_PER&&(W+=`<br/><span class="text-sm text-purple-700">Periode: ${N.BEGIN_PER} - ${N.EIND_PER}</span>`),(N.AARD_OPM||N.Aard_opmer)&&(W+=`<br/><span class="text-xs text-gray-600 italic">${N.AARD_OPM||N.Aard_opmer}</span>`),N.Gemeente&&(W+=`<br/><span class="text-sm text-gray-600">Gemeente: ${N.Gemeente}</span>`),N.Bron&&(W+=`<br/><span class="text-xs text-gray-500">Bron: ${N.Bron}</span>`),N.Bron_besch&&(W+=`<br/><span class="text-xs text-gray-500">${N.Bron_besch}</span>`),N.Dat_st_z&&N.Dat_ei_z&&(W+=`<br/><span class="text-sm text-purple-700">Datering: ${N.Dat_st_z} - ${N.Dat_ei_z}</span>`),N.Begin&&N.Einde&&(W+=`<br/><span class="text-sm text-purple-700">Periode: ${N.Begin} - ${N.Einde}</span>`),N.Uiterwaard&&(W+=`<br/><span class="text-sm font-semibold">${N.Uiterwaard}</span>`),N.rivier&&(W+=`<br/><span class="text-sm text-blue-600">Rivier: ${N.rivier}</span>`),N.Beschrijvi&&(W+=`<br/><span class="text-sm text-gray-700">${N.Beschrijvi}</span>`),N.leisure&&N.name){const X=N.leisure==="playground"?"Speeltuin":N.leisure==="park"?"Park":N.leisure==="swimming_area"?"Zwemplek":null;X&&(W+=`<br/><span class="text-xs text-green-600">${X}</span>`)}if((N.tourism==="museum"||N.museum)&&N.name&&(W+='<br/><span class="text-xs text-purple-600">Museum</span>'),(N.leisure==="swimming_area"||N.sport==="swimming")&&N.name&&(W+='<br/><span class="text-xs text-cyan-600">Zwemplek</span>'),N.osm_id&&N.address!==void 0&&(W+='<br/><span class="text-xs text-lime-600">Kringloopwinkel</span>',N.address&&(W+=`<br/><span class="text-xs text-gray-500">${N.address}</span>`),N.phone&&(W+=`<br/><span class="text-xs text-gray-600">${N.phone}</span>`)),N.site_type==="tumulus"){const X=we.getGeometry()?.getCoordinates();let ce="",de="";if(X){const Ve=xn(X),be=Ve[0],$e=Ve[1];be>5.5&&be<6.3&&$e>52&&$e<52.5?(ce="Veluwe",de="De Veluwe heeft de grootste concentratie grafheuvels van Nederland. Veel heuvels liggen in grafvelden met tientallen heuvels bij elkaar."):be>6.2&&be<7.1&&$e>52.6&&$e<53.3?(ce="Drenthe",de="Drenthe is beroemd om zijn prehistorische monumenten. Naast hunebedden liggen hier honderden grafheuvels uit de Bronstijd."):be>4.5&&be<6&&$e>51.3&&$e<51.9?(ce="Noord-Brabant",de="Op de Brabantse zandgronden liggen veel grafheuvels, vaak in kleine groepjes op hogere gronden."):be>5.5&&be<6.3&&$e>50.7&&$e<51.6?(ce="Limburg",de="De Limburgse heuvels en plateaus herbergen grafheuvels uit verschillende periodes, van Bronstijd tot Romeinse tijd."):be>5&&be<5.6&&$e>52&&$e<52.4&&(ce="Utrechtse Heuvelrug",de="De stuwwallen van de Utrechtse Heuvelrug en het Gooi waren al in de prehistorie bewoond. Grafheuvels markeren de laatste rustplaats van de vroege bewoners.")}W+='<br/><span class="text-sm text-amber-700">Grafheuvel uit de Bronstijd of IJzertijd</span>',ce&&(W+=`<br/><span class="text-sm text-gray-500">${ce}</span>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',W+='<div class="text-sm text-gray-700 mt-1">Een grafheuvel is een kunstmatige heuvel over een of meerdere graven. De meeste Nederlandse grafheuvels zijn 3000 tot 4000 jaar oud, uit de Bronstijd (2000-800 v.Chr.) of vroege IJzertijd.</div>',de&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Over deze regio</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${de}</div>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe herken je een grafheuvel?</span></div>',W+='<div class="text-sm text-gray-700 mt-1">Grafheuvels zijn vaak ronde, lage heuvels van 10-30 meter doorsnee en 1-3 meter hoog. Ze liggen meestal op zandgronden, vaak in groepjes (grafvelden). Let op de kenmerkende ronde vorm in het landschap.</div>',N.wikidata?(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer informatie</span></div>',W+=`<div class="text-sm text-gray-700 mt-1"><a href="https://www.wikidata.org/wiki/${N.wikidata}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Bekijk op Wikidata</a></div>`):(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer informatie</span></div>',W+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Grafheuvel" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Lees meer over grafheuvels op Wikipedia</a></div>')}if(N.historic==="castle"||N.castle_type){const X={manor:{label:"Landhuis",uitleg:"Een landhuis of havezate was het woonhuis van een adellijke familie. Vaak met een landgoed eromheen.",vondsten:"Sieraden, gespen, munten, aardewerk van rijke bewoners"},stately:{label:"Statig huis",uitleg:"Een groot en deftig woonhuis, vaak van welgestelde families. Soms met kasteelachtige kenmerken.",vondsten:"Huishoudelijke voorwerpen, munten, knopen, aardewerk"},fortress:{label:"Fort/Vesting",uitleg:"Een versterkte militaire bouwwerk, gebouwd om een gebied te verdedigen.",vondsten:"Militaire voorwerpen, kogels, gespen, uniformonderdelen"},defensive:{label:"Verdedigingskasteel",uitleg:"Een kasteel gebouwd voor verdediging, met dikke muren, een gracht en torens.",vondsten:"Wapens, harnasonderdelen, pijlpunten, middeleeuwse munten"},palace:{label:"Paleis",uitleg:"Een groot en luxueus gebouw voor koningen, prinsen of zeer rijke families.",vondsten:"Luxe voorwerpen, sieraden, zegels, zeldzame munten"},castrum:{label:"Romeins fort",uitleg:"Een Romeins legerkamp of fort. Deze zijn bijna 2000 jaar oud!",vondsten:"Romeinse munten, fibulae, militaria, aardewerk"},citadel:{label:"Citadel",uitleg:"Een sterk versterkte kern binnen een stad, als laatste verdedigingslinie.",vondsten:"Militaire voorwerpen uit verschillende periodes"}},ce=N.castle_type?X[N.castle_type]:null,de=ce?.label||"Kasteel";if(W+=`<br/><span class="text-sm text-purple-600">${de}</span>`,N.start_date&&(W+=`<br/><span class="text-sm text-gray-500">Bouwjaar: ${N.start_date}</span>`),N.heritage&&(W+='<br/><span class="text-sm text-amber-600">Rijksmonument</span>'),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',ce?W+=`<div class="text-sm text-gray-700 mt-1">${ce.uitleg}</div>`:W+='<div class="text-sm text-gray-700 mt-1">Een historisch kasteel of adellijk huis. Kastelen waren vaak het middelpunt van macht en rijkdom in een gebied.</div>',W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',ce?W+=`<div class="text-sm text-gray-700 mt-1">${ce.vondsten}</div>`:W+='<div class="text-sm text-gray-700 mt-1">Munten, sieraden, gespen, aardewerk en andere voorwerpen van de vroegere bewoners.</div>',N.wikipedia||N.website){if(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',N.wikipedia){const Ve=N.wikipedia.startsWith("http")?N.wikipedia:`https://nl.wikipedia.org/wiki/${N.wikipedia.replace(/^nl:/,"")}`;W+=`<div class="text-sm text-gray-700 mt-1"><a href="${Ve}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`}N.website&&(W+=`<div class="text-sm text-gray-700 mt-1"><a href="${N.website}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Website bezoeken</a></div>`)}}if(N.historic==="ruins"){const X=N.ruins_type||"";let ce="Rune",de="Een rune is wat overblijft van een oud gebouw. Het kan een kerk, kasteel, molen of ander bouwwerk zijn geweest.",Ve="Baksteenfragmenten, aardewerk, metalen voorwerpen van vroegere bewoners of gebruikers";if(X.toLowerCase().includes("church")||X.toLowerCase().includes("kerk")?(ce="Kerkrune",de="De overblijfselen van een oude kerk. Vaak nog te herkennen aan de fundering of een paar muren.",Ve="Religieuze voorwerpen, munten van kerkgangers, knopen, gespen"):X.toLowerCase().includes("castle")||X.toLowerCase().includes("kasteel")?(ce="Kasteelrune",de="De resten van een middeleeuws kasteel. Soms is alleen de gracht of fundering nog zichtbaar.",Ve="Middeleeuwse munten, sieraden, harnasonderdelen, pijlpunten"):X.toLowerCase().includes("mill")||X.toLowerCase().includes("molen")?(ce="Molenrune",de="Wat rest van een oude molen. Vaak nog te zien aan de stenen fundering of de molenberg.",Ve="Gereedschap, munten, huishoudelijke voorwerpen"):X.toLowerCase().includes("fort")&&(ce="Fortrune",de="De overblijfselen van een militair fort of verdedigingswerk.",Ve="Militaire voorwerpen, kogels, gespen, uniformonderdelen"),W+=`<br/><span class="text-sm text-gray-600">${ce}</span>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${de}</div>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${Ve}</div>`,N.description&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Beschrijving</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${N.description}</div>`),N.wikipedia){const be=N.wikipedia.startsWith("http")?N.wikipedia:`https://${N.wikipedia.split(":")[0]||"nl"}.wikipedia.org/wiki/${N.wikipedia.replace(/^[a-z]{2}:/,"")}`;W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">Lees meer op <a href="${be}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`}}if(N.bunker_type||N.name&&(N.name.toLowerCase().includes("bunker")||N.name.toLowerCase().includes("kazemat")||N.name.toLowerCase().includes("schuilplaats"))){const X={munitions:"Munitiebunker",personnel_shelter:"Personeelsschuilplaats",personell_shelter:"Personeelsschuilplaats",command:"Commandobunker",gun_emplacement:"Geschutsbunker",mg_nest:"Mitrailleursnest",technical:"Technische bunker",storage:"Opslagbunker",tobruk:"Tobruk",kazemat:"Kazemat",Flak:"Luchtafweerstelling",hardened_aircraft_shelter:"Vliegtuigshelter",shelter:"Schuilkelder",observation:"Observatiebunker",anti_aircraft:"Luchtafweerstelling"},ce=N.name||"",de=N.bunker_type?X[N.bunker_type]||N.bunker_type:"";ce&&ce!=="Bunker"&&(W+=`<br/><span class="text-sm font-semibold text-gray-700">${ce}</span>`),de&&de!==ce&&(W+=`<br/><span class="text-xs text-gray-500">${de}</span>`);const Ve=we.getGeometry()?.getCoordinates();let be="",$e="",et="";if(Ve){const ft=xn(Ve),St=ft[0],sn=ft[1],ur=St<4.8||St<5.2&&sn>51.8&&sn<53.5,cn=St>4.2&&St<4.4&&sn>52&&sn<52.15,hr=St>4.5&&St<4.7&&sn>52.4&&sn<52.5,yr=St>4&&St<4.2&&sn>51.95&&sn<52.05,Li=St<4.2&&sn<51.6,B=St>5.2&&St<5.8&&sn>51.9&&sn<52.3;cn?(be="Deze bunker maakt deel uit van de Atlantikwall bij Scheveningen. De Duitsers bouwden hier tijdens WOII zo'n 80 bunkers in de duinen. De muren zijn soms 3 meter dik beton. Voor deze bunkers moesten 138.000 mensen uit Den Haag en Scheveningen hun huis verlaten.",$e="https://nl.wikipedia.org/wiki/Atlantikwall_Museum_Scheveningen",et="Atlantikwall Museum Scheveningen"):hr?(be="Deze bunker hoort bij Festung IJmuiden, een van de zwaarst verdedigde punten van de Atlantikwall. De Duitsers bouwden hier bunkers om de haventoegang te beschermen. Er zijn nu rondleidingen door het Bunkermuseum.",$e="https://www.bunkermuseum.nl/",et="Bunkermuseum IJmuiden"):yr?(be="Deze bunker maakt deel uit van de Atlantikwall bij Hoek van Holland. Dit was een strategisch punt voor de Duitsers vanwege de Nieuwe Waterweg. Veel bunkers zijn nog te bezoeken.",$e="https://www.atlantikwallhoekvanholland.nl/",et="Atlantikwall Hoek van Holland"):Li?(be="Deze bunker hoort bij de Atlantikwall in Zeeland. De Duitsers verdedigden hier de Westerschelde en de kust. Bij Zoutelande en Westkapelle zijn veel bunkers bewaard gebleven.",$e="https://www.bunkermuseumzoutelande.nl/",et="Bunkermuseum Zoutelande"):ur?(be="Deze bunker maakt deel uit van de Atlantikwall: de Duitse verdedigingslinie langs de hele kust van Europa. In Nederland bouwden de Duitsers duizenden bunkers tussen 1942 en 1944.",$e="https://nl.wikipedia.org/wiki/Atlantikwall",et="Atlantikwall (Wikipedia)"):B?(be="Deze bunker hoort mogelijk bij de Grebbelinie of de Nieuwe Hollandse Waterlinie. Dit waren Nederlandse verdedigingslinies die de Duitsers na 1940 versterkten met bunkers.",$e="https://nl.wikipedia.org/wiki/Grebbelinie",et="Grebbelinie (Wikipedia)"):(be="Een bunker uit de Tweede Wereldoorlog. De meeste bunkers in Nederland zijn gebouwd tussen 1940 en 1944, als onderdeel van de Duitse verdediging of langs bestaande Nederlandse linies.",$e="https://nl.wikipedia.org/wiki/Atlantikwall",et="WOII bunkers (Wikipedia)")}else be="Een bunker uit de Tweede Wereldoorlog.",$e="https://nl.wikipedia.org/wiki/Atlantikwall",et="WOII bunkers (Wikipedia)";W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${be}</div>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je vinden?</span></div>',W+='<div class="text-sm text-gray-700 mt-1">Bij bunkers worden soms voorwerpen gevonden zoals patronen, uniformknopen, gespen en persoonlijke spullen van soldaten.</div>',W+='<div class="mt-2 text-xs text-gray-500 italic">Let op: betreed nooit een bunker zonder toestemming. Raak munitieresten niet aan.</div>',W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bronnen</span></div>',W+='<div class="text-sm text-gray-700 mt-1">',W+=`<a href="${$e}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">${et}</a>`,N.website?W+=`<br/><a href="${N.website}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">TracesOfWar</a>`:W+='<br/><a href="https://www.tracesofwar.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">TracesOfWar</a>',W+="</div>"}if(N.historic==="battlefield"){const X=N.name||"Onbekend slagveld",de={"Slag om Arnhem":{periode:"September 1944",samenvatting:"De Slag om Arnhem was onderdeel van Operatie Market Garden. Geallieerde parachutisten probeerden de brug over de Rijn te veroveren. Na negen dagen hevige gevechten moesten ze zich terugtrekken. Van de 10.000 Britse soldaten werden er 1.500 gedood en 6.500 krijgsgevangen gemaakt.",watZieJe:"Er zijn veel monumenten en infoborden. Het Airborne Museum in Oosterbeek vertelt het hele verhaal. Elk jaar in september is er een herdenking.",uitkomst:"De geallieerden verloren de slag. Nederland bleef nog tot mei 1945 bezet.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_om_Arnhem"},"Slag om de Sloedam":{periode:"1-2 november 1944",samenvatting:"Canadese soldaten vielen de Sloedam aan om Walcheren te bevrijden. De dam was smal en de Duitsers verdedigden fel. Veel soldaten sneuvelden bij deze bloedige aanval.",watZieJe:"Bij de dam staat een monument voor de gevallen Canadezen. Er zijn infoborden die de slag uitleggen.",uitkomst:"De Canadezen wonnen na zware verliezen. Dit opende de weg naar de bevrijding van Walcheren.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_om_de_Sloedam"},"Slag bij Heiligerlee (1568)":{periode:"23 mei 1568",samenvatting:"De eerste veldslag van de Tachtigjarige Oorlog. Lodewijk van Nassau versloeg het Spaanse leger. Zijn broer Adolf sneuvelde tijdens de strijd.",watZieJe:"In Heiligerlee staat het Slag bij Heiligerlee monument. Het klooster waar Adolf van Nassau begraven ligt is nog te bezoeken.",uitkomst:"De opstandelingen wonnen, maar dit was pas het begin van 80 jaar oorlog.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_bij_Heiligerlee_(1568)"},Overloon:{periode:"Oktober 1944",samenvatting:"Bij Overloon vochten Britten en Amerikanen tegen de Duitsers. Het was een van de zwaarste tankgevechten op Nederlandse bodem. Het dorp werd volledig verwoest.",watZieJe:"Het Oorlogsmuseum Overloon staat op het voormalige slagveld. Je kunt tanks, vliegtuigen en andere voertuigen zien.",uitkomst:"De geallieerden wonnen na wekenlange gevechten.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_om_Overloon"},"Slagveld Lanakerveld":{periode:"1568",samenvatting:"Onderdeel van de Nederlandse opstand tegen Spanje. Hier vonden gevechten plaats tijdens de beginjaren van de Tachtigjarige Oorlog.",watZieJe:"Het gebied is nu grotendeels landbouwgrond. Lokaal zijn er soms infoborden.",uitkomst:"Onderdeel van de lange strijd tegen de Spaanse overheersing.",wikiUrl:"https://nl.wikipedia.org/wiki/Tachtigjarige_Oorlog"},Blessebrugschans:{periode:"Diverse periodes",samenvatting:"Een historische schans die meerdere keren werd gebruikt in militaire conflicten.",watZieJe:"De resten van de schans zijn nog zichtbaar in het landschap.",uitkomst:"De schans speelde een rol in verschillende conflicten.",wikiUrl:"https://nl.wikipedia.org/wiki/Schans_(vestingwerk)"}}[X];if(X!=="Onbekend slagveld"&&X!=="Historisch slagveld"&&(W+=`<br/><span class="text-sm font-semibold text-red-700">${X}</span>`),de)W+=`<br/><span class="text-xs text-gray-500">${de.periode}</span>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat gebeurde hier?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${de.samenvatting}</div>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe liep het af?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${de.uitkomst}</div>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je zien?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${de.watZieJe}</div>`,W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bronnen</span></div>',W+='<div class="text-sm text-gray-700 mt-1">',W+=`<a href="${de.wikiUrl}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a>`,X.includes("Arnhem")&&(W+='<br/><a href="https://www.airbornemuseum.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Airborne Museum Oosterbeek</a>'),X.includes("Overloon")&&(W+='<br/><a href="https://www.oorlogsmuseum.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Oorlogsmuseum Overloon</a>'),W+="</div>";else if(N.date&&(W+=`<br/><span class="text-xs text-gray-500">${N.date}</span>`),N.description?(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat gebeurde hier?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${N.description}</div>`):(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat gebeurde hier?</span></div>',W+='<div class="text-sm text-gray-700 mt-1">Op deze plek vonden historische gevechten plaats. Zoek lokaal naar infoborden of monumenten.</div>'),N.wikipedia){const Ve=N.wikipedia.startsWith("http")?N.wikipedia:`https://nl.wikipedia.org/wiki/${N.wikipedia.replace("nl:","")}`;W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bronnen</span></div>',W+=`<div class="text-sm text-gray-700 mt-1"><a href="${Ve}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`}}if(N.bron==="Paleobiology Database"){const X=be=>{const $e={Mollusca:"weekdieren zoals schelpen en slakken",Brachiopoda:"armpotigen, schelp-achtige dieren",Echinodermata:"stekelhuidigen zoals zee-egels en zeesterren",Chordata:"gewervelde dieren",Arthropoda:"geleedpotigen zoals kreeften en trilobieten",Cnidaria:"neteldieren zoals koralen en kwallen",Bryozoa:"mosdiertjes",Foraminifera:"eencellige schelpdieren",Plantae:"planten",Crinoidea:"zeelelies",Gastropoda:"slakken",Bivalvia:"tweekleppigen zoals mossels en oesters",Cephalopoda:"koppotigen zoals inktvissen en ammonieten",Trilobita:"trilobieten, uitgestorven kreeftachtigen",Mammalia:"zoogdieren",Reptilia:"reptielen",Pisces:"vissen",Amphibia:"amfibien"};for(const[et,ft]of Object.entries($e))if(be.toLowerCase().includes(et.toLowerCase()))return ft;return""},ce=be=>{const $e={Cambrium:"541-485 miljoen jaar geleden",Ordovicium:"485-444 miljoen jaar geleden",Siluur:"444-419 miljoen jaar geleden",Devoon:"419-359 miljoen jaar geleden",Carboon:"359-299 miljoen jaar geleden",Perm:"299-252 miljoen jaar geleden",Trias:"252-201 miljoen jaar geleden",Jura:"201-145 miljoen jaar geleden",Krijt:"145-66 miljoen jaar geleden",Paleogeen:"66-23 miljoen jaar geleden",Neogeen:"23-2,6 miljoen jaar geleden",Kwartair:"2,6 miljoen jaar - nu",Pleistoceen:"2,6 miljoen - 11.700 jaar geleden",Holoceen:"11.700 jaar geleden - nu"};for(const[et,ft]of Object.entries($e))if(be.toLowerCase().includes(et.toLowerCase()))return ft;return""},de=be=>{const $e={limestone:"kalksteen",sandstone:"zandsteen",shale:"schalie",clay:"klei",sand:"zand",gravel:"grind",marl:"mergel",chalk:"krijt",mudstone:"moddersteen",siltstone:"siltsteen"};let et=be;for(const[ft,St]of Object.entries($e))et=et.replace(new RegExp(ft,"gi"),St);return et},Ve=be=>{const $e={marine:"zee",coastal:"kust",terrestrial:"land",fluvial:"rivier",lacustrine:"meer",reef:"rif",deltaic:"delta",shallow:"ondiep water",deep:"diep water"};let et=be;for(const[ft,St]of Object.entries($e))et=et.replace(new RegExp(ft,"gi"),St);return et};if(N.vindplaats&&(W+=`<br/><span class="text-xs text-gray-600">${N.vindplaats}</span>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is hier gevonden?</span></div>',N.taxonomie&&N.taxonomie!=="Onbekend"){const be=X(N.taxonomie);be?(W+=`<div class="text-sm text-gray-700 mt-1">${be}</div>`,W+=`<div class="text-xs text-gray-500 italic">(${N.taxonomie})</div>`):W+=`<div class="text-sm text-gray-700 mt-1">${N.taxonomie}</div>`}if(N.aantal_fossielen){const be=parseInt(N.aantal_fossielen),$e=be>100?"Veel fossielen gevonden op deze locatie.":be>10?"Meerdere fossielen gevonden op deze locatie.":`${N.aantal_fossielen} fossiel${be>1?"en":""} gevonden op deze locatie.`;W+=`<div class="text-sm text-gray-600 mt-1">${$e}</div>`}if(N.periode&&N.periode!=="Onbekend"){W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wanneer leefden deze dieren?</span></div>';const be=ce(N.periode);W+=`<div class="text-sm text-gray-700 mt-1">${N.periode}</div>`,be&&(W+=`<div class="text-sm text-gray-600">${be}</div>`),N.ouderdom&&N.ouderdom!=="Onbekend"&&(W+=`<div class="text-sm text-gray-600">Ouderdom: ${N.ouderdom}</div>`)}(N.gesteente||N.formatie||N.milieu)&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">In wat voor gesteente?</span></div>',N.gesteente&&(W+=`<div class="text-sm text-gray-700 mt-1">${de(N.gesteente)}</div>`),N.formatie&&(W+=`<div class="text-sm text-gray-600">Formatie: ${N.formatie}</div>`,N.lid&&(W+=`<div class="text-sm text-gray-600 ml-3">Lid: ${N.lid}</div>`)),N.milieu&&(W+=`<div class="text-sm text-gray-600">Leefomgeving: ${Ve(N.milieu)}</div>`))}if(N.layerType==="fossielHotspot"){const X=[];if(N.type&&X.push(N.type),N.region&&X.push(N.region),N.country){const ce={NL:"Nederland",BE:"Belgi",DE:"Duitsland",FR:"Frankrijk"};X.push(ce[N.country]||N.country)}if(X.length>0&&(W+=`<br/><span class="text-xs text-gray-600">${X.join("  ")}</span>`),(N.finds||N.period)&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kan ik er vinden?</span></div>',N.finds&&(W+=`<div class="text-sm text-gray-700 mt-1">${N.finds}</div>`),N.period&&(W+=`<div class="text-sm text-gray-600 mt-1">Periode: ${N.period}</div>`),N.geology&&(W+=`<div class="text-sm text-gray-600 mt-1">Geologie: ${N.geology}</div>`)),N.access||N.tips){if(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe kom ik er?</span></div>',N.access){const de=N.access.toLowerCase().includes("verboden")||N.access.toLowerCase().includes("niet toegankelijk")?"text-red-600":"text-gray-700";W+=`<div class="text-sm ${de} mt-1">${N.access}</div>`}N.tips&&(W+=`<div class="text-sm text-gray-600 mt-1 italic">Tip: ${N.tips}</div>`)}}if(N.layerType==="mineralenHotspot"){const X=[];if(N.region&&X.push(N.region),N.country){const ce={NL:"Nederland",BE:"Belgi",DE:"Duitsland",FR:"Frankrijk"};X.push(ce[N.country]||N.country)}if(X.length>0&&(W+=`<br/><span class="text-xs text-gray-600">${X.join("  ")}</span>`),N.minerals&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kan ik er vinden?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${N.minerals}</div>`,N.geology&&(W+=`<div class="text-sm text-gray-600 mt-1">Geologie: ${N.geology}</div>`)),N.access||N.tips){if(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe kom ik er?</span></div>',N.access){const de=N.access.toLowerCase().includes("verboden")||N.access.toLowerCase().includes("niet toegankelijk")||N.access.toLowerCase().includes("gesloten")?"text-red-600":"text-gray-700";W+=`<div class="text-sm ${de} mt-1">${N.access}</div>`}N.tips&&(W+=`<div class="text-sm text-gray-600 mt-1 italic">Tip: ${N.tips}</div>`)}}if(N.layerType==="goudrivier"){const X=[];if(N.river&&X.push(N.river),N.region&&X.push(N.region),N.country){const ce={NL:"Nederland",BE:"Belgi",DE:"Duitsland",FR:"Frankrijk"};X.push(ce[N.country]||N.country)}if(X.length>0&&(W+=`<br/><span class="text-xs text-gray-600">${X.join("  ")}</span>`),(N.goldType||N.origin)&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kan ik er vinden?</span></div>',N.goldType&&(W+=`<div class="text-sm text-gray-700 mt-1">${N.goldType}</div>`),N.origin&&(W+=`<div class="text-sm text-gray-600 mt-1">Herkomst: ${N.origin}</div>`)),N.legal||N.tips){if(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Mag ik hier zoeken?</span></div>',N.legal){const de=N.legal.includes("VERBODEN")?"text-red-600 font-semibold":"text-gray-700";W+=`<div class="text-sm ${de} mt-1">${N.legal}</div>`}N.tips&&(W+=`<div class="text-sm text-gray-600 mt-1 italic">Tip: ${N.tips}</div>`)}}if(N.layerType==="wandelroute"){const X=[];if(N.region&&X.push(N.region),N.country){const ce={NL:"Nederland",BE:"Belgi"};X.push(ce[N.country]||N.country)}if(X.length>0&&(W+=`<br/><span class="text-xs text-gray-600">${X.join("  ")}</span>`),N.distance||N.duration){const ce=N.distance?`${N.distance} km`:"",de=N.duration?`${N.duration}`:"",Ve=[ce,de].filter(Boolean).join("  ");Ve&&(W+=`<br/><span class="text-sm text-green-700 font-medium">${Ve}</span>`)}(N.description||N.highlights)&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat ga je zien?</span></div>',N.description&&(W+=`<div class="text-sm text-gray-700 mt-1">${N.description}</div>`),N.highlights&&(W+=`<div class="text-sm text-gray-600 mt-1">Hoogtepunten: ${N.highlights}</div>`)),N.startAddress&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Waar begin ik?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${N.startAddress}</div>`),N.url&&(W+=`<div class="mt-3"><a href="${N.url}" target="_blank" class="text-sm text-blue-600 hover:underline">Bekijk route en download GPX</a></div>`)}if(N.layerType==="hunebed"){N.period&&(W+=`<br/><span class="text-sm text-purple-700">Periode: ${N.period}</span>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',N.description&&(W+=`<div class="text-sm text-gray-700 mt-1">${N.description}</div>`);const X=[];if(N.stones){const ce=N.stones.toLowerCase(),de=ce.match(/(\d+)\s*dekst[^\s,]*/i),Ve=ce.match(/(\d+)\s*draagst[^\s,]*/i),be=ce.match(/(\d+)\s*sluitst[^\s,]*/i),$e=ce.match(/(\d+)\s*poortst[^\s,]*/i),et=ce.match(/(\d+)\s*gangdekst[^\s,]*/i),ft=ce.match(/(\d+)\s*gangzijst[^\s,]*/i);de&&X.push(`${de[1]} deksteen${parseInt(de[1])>1?"en":""} (de grote steen${parseInt(de[1])>1?"en":""} bovenop)`),Ve&&X.push(`${Ve[1]} draagstenen (de stenen die de dekstenen dragen)`),be&&X.push(`${be[1]} sluitsteen${parseInt(be[1])>1?"en":""} (afsluiting aan de korte zijden)`),$e&&X.push(`${$e[1]} poortsteen${parseInt($e[1])>1?"en":""} (bij de ingang)`),et&&X.push(`${et[1]} gangdeksteen${parseInt(et[1])>1?"en":""} (boven de toegangsgang)`),ft&&X.push(`${ft[1]} gangzijstenen (langs de toegangsgang)`)}if(N.length&&X.push(`Een grafkamer van ${N.length} lang`),N.width&&X.push(`${N.width}`),X.length>0&&(W+='<div class="text-sm text-gray-700 mt-1">Het hunebed heeft:</div>',W+='<ul class="list-disc list-inside text-sm text-gray-700 mt-1 space-y-0.5">',X.forEach(ce=>{W+=`<li>${ce}</li>`}),W+="</ul>"),N.notable){const ce=N.notable.toLowerCase();let de="Wat is hier bijzonder?";ce.includes("grootste")?de="Waarom is dit het grootste hunebed?":ce.includes("klein")||ce.includes("kindhunebed")?de="Waarom is dit hunebed zo klein?":ce.includes("cluster")||ce.includes("naast elkaar")?de="Waarom liggen hier meerdere hunebedden?":(ce.includes("enige")||ce.includes("westelijk")||ce.includes("noordelijk"))&&(de="Wat maakt deze locatie bijzonder?"),W+=`<div class="mt-3"><span class="text-sm font-semibold text-gray-800">${de}</span></div>`,W+=`<div class="text-sm text-gray-700 mt-1">${N.notable}</div>`}W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is de Trechterbeker cultuur?</span></div>',W+='<div class="text-sm text-gray-700 mt-1">De Trechterbeker cultuur is de naam voor de mensen die 5.000 jaar geleden in Nederland woonden. Ze maakten potten met een trechter-vorm. Daarom heten ze zo. Deze mensen bouwden de hunebedden als graven voor hun doden.</div>',N.finds&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is hier gevonden?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${N.finds}</div>`),N.museum&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Museum in de buurt</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">${N.museum}</div>`),W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bezoeken</span></div>',N.access?W+=`<div class="text-sm text-gray-700 mt-1">${N.access}</div>`:W+='<div class="text-sm text-gray-700 mt-1">Je kunt dit hunebed gratis bezoeken.</div>',N.wikipedia&&(W+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',W+=`<div class="text-sm text-gray-700 mt-1">Lees meer op <a href="${N.wikipedia}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`)}if((N.inventarisnummer||N.locatie_naam)&&(N.locatie_naam&&(W+=`<br/><span class="text-sm font-semibold">${N.locatie_naam}</span>`),N.inventarisnummer&&(W+=`<br/><span class="text-xs text-gray-500">CAI: ${N.inventarisnummer}</span>`),N.datering_tekst&&(W+=`<br/><span class="text-sm text-purple-700">${N.datering_tekst}</span>`)),(N.veensoort||N.dikte)&&(N.veensoort&&(W+=`<br/><span class="text-sm text-amber-700">${N.veensoort}</span>`),N.dikte&&(W+=`<br/><span class="text-xs text-gray-600">Dikte: ${N.dikte}</span>`)),N.nature&&N.debut){W+=`<br/><span class="text-sm text-purple-700">${N.nature}</span>`;const X=N.debut===N.fin?N.debut:`${N.debut} - ${N.fin}`;X&&(W+=`<br/><span class="text-sm text-gray-700">Periode: ${X}</span>`),N.structure&&(W+=`<br/><span class="text-xs text-gray-600">${N.structure}</span>`),N.commune&&(W+=`<br/><span class="text-xs text-gray-500">${N.commune}</span>`),N.decouvert&&(W+=`<br/><span class="text-xs text-gray-400">Ontdekt: ${N.decouvert}</span>`),N.numero&&(W+=`<br/><span class="text-xs text-gray-400">${N.numero}</span>`)}if((N.NATURE_OPE||N.CODE_OPERA)&&(N.TITRE&&(W+=`<br/><span class="text-sm font-semibold">${N.TITRE}</span>`),N.NATURE_OPE&&(W+=`<br/><span class="text-sm text-amber-700">${N.NATURE_OPE}</span>`),N.AUTEUR&&(W+=`<br/><span class="text-xs text-gray-600">Auteur: ${N.AUTEUR}</span>`),N.DATE&&(W+=`<br/><span class="text-xs text-gray-500">Datum: ${N.DATE}</span>`),N.COMMUNE&&(W+=`<br/><span class="text-xs text-gray-500">${N.COMMUNE}</span>`)),N.type_protection&&(N.n_site||N.t_site)){const X=N.type_protection==="Classe"?"text-red-700":"text-amber-700";W+=`<br/><span class="text-sm ${X}">${N.type_protection}</span>`,N.n_site&&(W+=`<br/><span class="text-sm font-semibold">${N.n_site}</span>`),N.t_site&&(W+=`<br/><span class="text-xs text-gray-600">${N.t_site}</span>`),N.c_site&&(W+=`<br/><span class="text-xs text-gray-500">Code: ${N.c_site}</span>`),N.d_creation&&(W+=`<br/><span class="text-xs text-gray-400">Beschermd sinds: ${N.d_creation}</span>`)}if(N.type_protection&&N.cod_diren){const X=N.type_protection==="Classe"?"text-red-700":"text-amber-700";if(W+=`<br/><span class="text-sm ${X}">${N.type_protection}</span>`,N.proced&&(W+=`<br/><span class="text-xs text-gray-600">${N.proced}</span>`),N.d_proced&&(W+=`<br/><span class="text-xs text-gray-500">Date: ${N.d_proced}</span>`),N.comment){const ce=String(N.comment).slice(0,150);W+=`<br/><span class="text-xs text-gray-600 italic">${ce}${String(N.comment).length>150?"...":""}</span>`}}if(N.type_protection&&N.nomsite){const X=N.type_protection==="Classe"?"text-red-700":"text-amber-700";if(W+=`<br/><span class="text-sm ${X}">${N.type_protection}</span>`,N.caractere&&(W+=`<br/><span class="text-xs text-gray-600">${N.caractere}</span>`),N.datedecis&&(W+=`<br/><span class="text-xs text-gray-500">Date: ${N.datedecis}</span>`),N.descriptio){const ce=String(N.descriptio).slice(0,150);W+=`<br/><span class="text-xs text-gray-600 italic">${ce}${String(N.descriptio).length>150?"...":""}</span>`}}if(N.secteur&&N.style){if(W+=`<br/><span class="text-sm text-gray-700">${N.secteur}</span>`,N["sous-secteur"]&&(W+=`<br/><span class="text-xs text-gray-600">${N["sous-secteur"]}</span>`),N.description){const X=String(N.description).slice(0,150);W+=`<br/><span class="text-xs text-gray-600 italic">${X}${String(N.description).length>150?"...":""}</span>`}N.url&&(W+=`<br/><a href="${N.url}" target="_blank" class="text-xs text-blue-600 hover:underline">Meer info</a>`)}if(N.nature_operation||N.synthese){N.nature_operation&&(W+=`<br/><span class="text-sm text-red-700">${N.nature_operation}</span>`),N.responsable_operation&&(W+=`<br/><span class="text-xs text-gray-600">Responsable: ${N.responsable_operation}</span>`),N.date_operation&&(W+=`<br/><span class="text-xs text-gray-500">Datum: ${N.date_operation}</span>`);const X=[];if(N.prehistoire==="Oui"&&X.push("Prehistorie"),N.protohistoire==="Oui"&&X.push("Protohistorie"),N.antiquite==="Oui"&&X.push("Romeins"),N.moyen_age==="Oui"&&X.push("Middeleeuwen"),N.temps_modernes==="Oui"&&X.push("Moderne tijd"),X.length>0&&(W+=`<br/><span class="text-sm text-purple-700">${X.join(", ")}</span>`),N.adresse&&(W+=`<br/><span class="text-xs text-gray-500">${N.adresse}</span>`),N.synthese){const ce=String(N.synthese).slice(0,200);W+=`<br/><span class="text-xs text-gray-600 italic">${ce}${String(N.synthese).length>200?"...":""}</span>`}}if(N.operator&&(W+=`<br/><span class="text-sm text-gray-600">${N.operator}</span>`),N.opening_hours){const X=Zwe(String(N.opening_hours));W+=`<br/><span class="text-xs text-green-600">Open: ${X}</span>`}if(N.website&&(W+=`<br/><a href="${N.website}" target="_blank" class="text-xs text-blue-600 underline">Website</a>`),N.addr_street){const X=[N.addr_street,N.addr_housenumber,N.addr_postcode].filter(Boolean).join(" ");W+=`<br/><span class="text-xs text-gray-500">${X}</span>`}const Z=N.description||N.omschrijving||N.descr||N.info;Z&&Z!==Pt&&(W+=`<br/><span class="text-sm text-gray-600">${Z}</span>`),Jt.push(W),Rt.push({geometry:rr(kt),properties:N,popupHtml:W})}const Ut=n.getView().getResolution()||1,es=await jt(_t.coordinate,Ut);Jt.push(...es);for(const we of es)Rt.push(null);const Oe=await ai;if(Jt.length===0&&Oe!==null){const we=`<strong class="text-blue-800">Terrein</strong>
          <br/><div class="mt-2 pt-2 border-t border-gray-100 flex items-center gap-1">
            <span class="text-xs text-gray-400">Hoogte:</span>
            <span class="text-sm font-medium text-blue-600">${Oe.toFixed(2)} m NAP</span>
          </div>`;Jt.push(we),Rt.push(null)}if(Jt.length>0&&Oe!==null&&(Jt[0]+=`<br/><div class="mt-2 pt-2 border-t border-gray-100 flex items-center gap-1">
          <span class="text-xs text-gray-400">Hoogte:</span>
          <span class="text-sm font-medium text-blue-600">${Oe.toFixed(2)} m NAP</span>
        </div>`),Jt.length>0){l(Jt),V(Rt),h(0),console.log(` KLIK OPGESLAGEN: [${_t.coordinate[0].toFixed(0)}, ${_t.coordinate[1].toFixed(0)}]`),v(_t.coordinate),E(!1),L(!1),le(!1),Se(""),U(null);const we=xn(_t.coordinate);Te(we),C(`https://www.google.com/maps/dir/?api=1&destination=${we[1]},${we[0]}`),g(!0)}};return n.on("click",Pn),()=>{n.un("click",Pn)}},[n]);const en=()=>{g(!1),n&&x&&(Bb(n),E(!1))},Qn=(mt,jt)=>{jt.offset.y>100&&en()};return m.jsx(mr,{children:f&&m.jsxs(m.Fragment,{children:[m.jsx(Ct.div,{className:"fixed inset-0 z-[1500]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:en}),m.jsxs(Ct.div,{className:"fixed bottom-0 left-0 right-0 z-[1501] bg-white rounded-t-2xl shadow-2xl",style:{fontSize:`${14*re/100}px`},initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",damping:25,stiffness:300},drag:"y",dragConstraints:{top:0},dragElastic:.2,onDragEnd:Qn,children:[m.jsx("div",{className:"flex justify-center pt-2 pb-1",children:m.jsx("div",{className:"w-10 h-1 bg-gray-300 rounded-full"})}),m.jsxs("div",{className:"flex items-center gap-2 px-3 pb-2 border-b border-gray-100",children:[je&&m.jsxs("div",{className:"flex items-center gap-0.5 flex-shrink-0",children:[m.jsx("button",{onClick:Qt,className:"p-1 text-blue-500 hover:text-blue-600 transition-colors border-0 outline-none bg-transparent","aria-label":"Vorige laag",children:m.jsx(rae,{size:18})}),m.jsxs("span",{className:"text-gray-500 font-medium min-w-[32px] text-center",style:{fontSize:"0.857em"},children:[u+1,"/",o.length]}),m.jsx("button",{onClick:ot,className:"p-1 text-blue-500 hover:text-blue-600 transition-colors border-0 outline-none bg-transparent","aria-label":"Volgende laag",children:m.jsx(Ow,{size:18})})]}),m.jsx("span",{className:"flex-1 font-semibold text-gray-800 truncate",style:{fontSize:"1em"},children:Gt||"Info"}),j&&m.jsxs("div",{className:"relative",children:[m.jsx("button",{onClick:()=>L(!k),className:`p-1.5 transition-colors flex-shrink-0 border-0 outline-none bg-transparent ${O?"text-green-500":"text-orange-500 hover:text-orange-600"}`,title:"Toevoegen aan mijn laag","aria-label":"Toevoegen aan mijn laag",children:O?m.jsx(Wl,{size:18}):m.jsx(co,{size:18})}),k&&m.jsxs("div",{className:"absolute right-0 top-8 z-50 bg-white rounded-lg shadow-md py-1 min-w-[180px] max-w-[220px]",children:[m.jsx("div",{className:"px-3 py-1 text-xs text-gray-400 font-medium",children:"Toevoegen aan:"}),m.jsx("div",{className:"max-h-[200px] overflow-y-auto",children:i.filter(mt=>!mt.archived).map(mt=>m.jsxs("button",{onClick:()=>{const jt=J;s(mt.id,{name:Gt||"Punt",category:"Overig",notes:"",url:void 0,coordinates:[j[0],j[1]],sourceLayer:Gt,geometry:jt?.geometry,sourceProperties:jt?.properties,popupContent:jt?.popupHtml}),L(!1),U(mt.name),setTimeout(()=>U(null),2e3)},className:"w-full px-3 py-1.5 text-left text-sm text-gray-700 hover:bg-blue-50 border-0 outline-none bg-transparent flex items-center gap-2",children:[m.jsx("span",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{backgroundColor:mt.color}}),m.jsx("span",{className:"truncate",children:mt.name})]},mt.id))}),m.jsx("div",{className:"border-t border-gray-100 mt-1 pt-1",children:Ne?m.jsxs("div",{className:"px-2 py-1",children:[m.jsx("input",{type:"text",value:ue,onChange:mt=>Se(mt.target.value),placeholder:"Naam nieuwe laag...",className:"w-full px-2 py-1 text-sm border border-gray-200 rounded focus:outline-none focus:border-orange-400",autoFocus:!0,onKeyDown:mt=>{if(mt.key==="Enter"&&ue.trim()){const jt=a(ue.trim()),Pn=J;s(jt,{name:Gt||"Punt",category:"Overig",notes:"",url:void 0,coordinates:[j[0],j[1]],sourceLayer:Gt,geometry:Pn?.geometry,sourceProperties:Pn?.properties,popupContent:Pn?.popupHtml}),L(!1),le(!1),Se(""),U(ue.trim()),setTimeout(()=>U(null),2e3)}else mt.key==="Escape"&&(le(!1),Se(""))}}),m.jsxs("div",{className:"flex gap-1 mt-1",children:[m.jsx("button",{onClick:()=>{if(ue.trim()){const mt=a(ue.trim()),jt=J;s(mt,{name:Gt||"Punt",category:"Overig",notes:"",url:void 0,coordinates:[j[0],j[1]],sourceLayer:Gt,geometry:jt?.geometry,sourceProperties:jt?.properties,popupContent:jt?.popupHtml}),L(!1),le(!1),Se(""),U(ue.trim()),setTimeout(()=>U(null),2e3)}},disabled:!ue.trim(),className:"flex-1 px-2 py-1 text-xs bg-orange-500 text-white rounded disabled:opacity-50",children:"Toevoegen"}),m.jsx("button",{onClick:()=>{le(!1),Se("")},className:"px-2 py-1 text-xs text-gray-500 hover:text-gray-700",children:"Annuleer"})]})]}):m.jsxs("button",{onClick:()=>le(!0),className:"w-full px-3 py-1.5 text-left text-sm text-orange-600 hover:bg-orange-50 border-0 outline-none bg-transparent flex items-center gap-2",children:[m.jsx(co,{size:14}),m.jsx("span",{children:"Nieuwe laag maken..."})]})})]})]}),P&&m.jsx("a",{href:P,target:"_blank",rel:"noopener noreferrer",className:"p-1.5 text-blue-500 hover:text-blue-600 transition-colors flex-shrink-0",title:"Open in Google Maps","aria-label":"Open in Google Maps",children:m.jsx(S1,{size:18})}),m.jsx("button",{onClick:en,className:"p-1.5 text-gray-400 hover:text-gray-600 transition-colors flex-shrink-0 border-0 outline-none bg-transparent","aria-label":"Sluiten",children:m.jsx(Ni,{size:18})})]}),m.jsx("div",{className:"px-4 py-3 max-h-[45vh] overflow-y-auto select-text",style:{userSelect:"text",WebkitUserSelect:"text"},dangerouslySetInnerHTML:{__html:wn}}),m.jsxs("div",{className:"px-4 py-2 border-t border-gray-100 flex items-center gap-2",children:[m.jsx(zoe,{size:14,className:"text-gray-400 flex-shrink-0"}),m.jsx("input",{type:"range",min:"80",max:"150",value:re,onChange:mt=>he(parseInt(mt.target.value)),className:"flex-1 h-1.5 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500"}),m.jsxs("span",{className:"text-gray-400 w-8 text-right",style:{fontSize:"0.857em"},children:[re,"%"]})]}),Fn&&I&&!F&&m.jsxs("div",{className:"px-4 pb-4 flex gap-2",children:[m.jsxs("button",{onClick:()=>{const mt=r.find(jt=>jt.id===I);mt&&z(mt)},className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-white bg-blue-500 hover:bg-blue-600 rounded-lg transition-colors border-0 outline-none",children:[m.jsx(Ip,{size:16}),m.jsx("span",{children:"Bewerken"})]}),m.jsxs("button",{onClick:()=>{e(I),g(!1),M(null)},className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-white bg-red-500 hover:bg-red-600 rounded-lg transition-colors border-0 outline-none",children:[m.jsx(_d,{size:16}),m.jsx("span",{children:"Verwijderen"})]})]}),F&&m.jsxs("div",{className:"px-4 pb-4 space-y-3 border-t border-gray-100 pt-3",children:[m.jsx("div",{className:"text-sm font-medium text-blue-600",children:"Vondst bewerken"}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500",children:"Objecttype"}),m.jsx("input",{type:"text",value:F.objectType,onChange:mt=>z({...F,objectType:mt.target.value}),className:"w-full px-2 py-1 text-sm bg-gray-50 rounded border-0 outline-none focus:bg-blue-50"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500",children:"Materiaal"}),m.jsx("input",{type:"text",value:F.material,onChange:mt=>z({...F,material:mt.target.value}),className:"w-full px-2 py-1 text-sm bg-gray-50 rounded border-0 outline-none focus:bg-blue-50"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500",children:"Periode"}),m.jsx("input",{type:"text",value:F.period,onChange:mt=>z({...F,period:mt.target.value}),className:"w-full px-2 py-1 text-sm bg-gray-50 rounded border-0 outline-none focus:bg-blue-50"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500",children:"Notities"}),m.jsx("textarea",{value:F.notes,onChange:mt=>z({...F,notes:mt.target.value}),className:"w-full px-2 py-1 text-sm bg-gray-50 rounded border-0 outline-none focus:bg-blue-50 resize-none h-16"})]}),m.jsxs("div",{className:"flex gap-2",children:[m.jsx("button",{onClick:()=>z(null),className:"flex-1 px-3 py-2 text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors border-0 outline-none text-sm",children:"Annuleren"}),m.jsx("button",{onClick:()=>{t(F.id,{objectType:F.objectType,material:F.material,period:F.period,notes:F.notes}),z(null),g(!1)},className:"flex-1 px-3 py-2 text-white bg-blue-500 hover:bg-blue-600 rounded-lg transition-colors border-0 outline-none text-sm",children:"Opslaan"})]})]}),Bt&&y&&m.jsx("div",{className:"px-4 pb-4 border-t border-gray-100",children:x?m.jsxs("button",{onClick:on,className:"w-full flex items-center justify-center gap-2 px-3 py-2 mt-3 text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors border-0 outline-none",children:[m.jsx(bb,{size:16}),m.jsx("span",{children:"Hoogtekaart verbergen"})]}):m.jsx("button",{onClick:Zn,disabled:T,className:`w-full flex items-center justify-center gap-2 px-3 py-2 mt-3 text-white rounded-lg transition-colors border-0 outline-none ${T?"bg-blue-400 cursor-wait":"bg-blue-500 hover:bg-blue-600"}`,children:T?m.jsxs(m.Fragment,{children:[m.jsx(wR,{size:16,className:"animate-spin"}),m.jsx("span",{children:"Laden..."})]}):m.jsxs(m.Fragment,{children:[m.jsx(bb,{size:16}),m.jsx("span",{children:"Hoogtekaart tonen"})]})})})]})]})})}const NO=1e-4;function nEe(n,e){return n.points.some(t=>{const r=Math.abs(t.coordinates[0]-e[0]),i=Math.abs(t.coordinates[1]-e[1]);return r<NO&&i<NO})}function rEe(){const n=Ji(k=>k.map),e=jr(k=>k.openVondstForm),{openAddPointModal:t,openCreateLayerModal:r,openLayerManagerModal:i}=jr(),s=Xi(k=>k.layers),[a,o]=ne.useState(null),[l,u]=ne.useState(!1),[h,f]=ne.useState(!1),[g,y]=ne.useState(!1),v=ne.useRef(null),x=ne.useRef(null);ne.useEffect(()=>{if(!n){console.log(" LongPressMenu: map not ready");return}const k=n.getViewport();if(!k){console.log(" LongPressMenu: viewport not ready");return}console.log(" LongPressMenu: attached to viewport",k);const L=600,O=15,U=ue=>{if(console.log(" Touch start, touches:",ue.touches.length),ue.touches.length!==1)return;const Se=ue.touches[0];x.current={x:Se.clientX,y:Se.clientY},console.log(" Starting long press timer at:",x.current),v.current&&clearTimeout(v.current),v.current=window.setTimeout(()=>{if(console.log(" Timer fired! startPos:",x.current),!x.current)return;const se=window.__olMap;if(!se){console.log(" Map not available (global)");return}const V=k.getBoundingClientRect(),J=[x.current.x-V.left,x.current.y-V.top],re=se.getCoordinateFromPixel(J);if(re){const q=xn(re);ue.preventDefault(),o({pixel:[x.current.x,x.current.y],coordinate:q}),u(!0),f(!1),setTimeout(()=>f(!0),300),"vibrate"in navigator&&navigator.vibrate(50),console.log(" Long press detected at:",q)}},L)},j=ue=>{if(!v.current||!x.current)return;const Se=ue.touches[0],se=Se.clientX-x.current.x,V=Se.clientY-x.current.y,J=Math.sqrt(se*se+V*V);J>O&&(console.log(" Touch moved too much, cancelling. Distance:",J),clearTimeout(v.current),v.current=null)},Te=()=>{console.log(" Touch end, timer active:",!!v.current),v.current&&(console.log(" Cancelling timer on touch end"),clearTimeout(v.current),v.current=null),x.current=null},Ce=ue=>{l&&ue.preventDefault()},Ue=ue=>{ue.button===0&&(console.log(" Mouse down"),x.current={x:ue.clientX,y:ue.clientY},v.current&&clearTimeout(v.current),v.current=window.setTimeout(()=>{if(console.log(" Mouse timer fired!"),!x.current)return;const Se=window.__olMap;if(console.log(" __olMap:",Se),console.log(" __olMap constructor:",Se?.constructor?.name),console.log(" has getCoordinateAtPixel:",typeof Se?.getCoordinateAtPixel),!Se){console.log(" Map not available (global)");return}const se=k.getBoundingClientRect(),V=[x.current.x-se.left,x.current.y-se.top];console.log(" Pixel:",V);const J=Se.getCoordinateFromPixel(V);if(console.log(" Coordinate:",J),J){const re=xn(J);o({pixel:[x.current.x,x.current.y],coordinate:re}),u(!0),f(!1),setTimeout(()=>f(!0),300),console.log(" Long press (mouse) detected at:",re)}},L))},Ne=ue=>{if(!v.current||!x.current)return;const Se=ue.clientX-x.current.x,se=ue.clientY-x.current.y;Math.sqrt(Se*Se+se*se)>O&&(console.log(" Mouse moved, cancelling"),clearTimeout(v.current),v.current=null)},le=()=>{console.log(" Mouse up"),v.current&&(clearTimeout(v.current),v.current=null),x.current=null};return k.addEventListener("touchstart",U,{passive:!1}),k.addEventListener("touchmove",j,{passive:!0}),k.addEventListener("touchend",Te),k.addEventListener("touchcancel",Te),k.addEventListener("contextmenu",Ce),k.addEventListener("mousedown",Ue),k.addEventListener("mousemove",Ne),k.addEventListener("mouseup",le),k.addEventListener("mouseleave",le),()=>{k.removeEventListener("touchstart",U),k.removeEventListener("touchmove",j),k.removeEventListener("touchend",Te),k.removeEventListener("touchcancel",Te),k.removeEventListener("contextmenu",Ce),k.removeEventListener("mousedown",Ue),k.removeEventListener("mousemove",Ne),k.removeEventListener("mouseup",le),k.removeEventListener("mouseleave",le),v.current&&clearTimeout(v.current)}},[n,l]);const E=()=>{h&&(u(!1),o(null),f(!1),y(!1))},T=()=>{u(!1),o(null),f(!1),y(!1)},b=k=>{if(!a)return;const[L,O]=a.coordinate;t(k,{lat:O,lng:L}),T()},I=()=>{r(),T()},M=()=>{if(!a)return;const[k,L]=a.coordinate;e({lat:L,lng:k}),u(!1),o(null),f(!1)},F=()=>{if(!a)return;const[k,L]=a.coordinate,O=`https://www.google.com/maps?q=${L},${k}`;window.open(O,"_blank"),u(!1),o(null),f(!1)},z=()=>{if(!a)return;const k=document.createElement("input");k.type="file",k.accept="image/*",k.capture="environment",k.onchange=async L=>{const O=L.target.files?.[0];if(!O)return;const[U,j]=a.coordinate;e({lat:j,lng:U},O)},k.click(),T()},P=()=>{i(),T()},C=k=>{const[L,O]=k;return`${O.toFixed(5)}N, ${L.toFixed(5)}E`};return m.jsx(mr,{children:l&&a&&m.jsxs(m.Fragment,{children:[m.jsx(Ct.div,{className:"fixed inset-0 z-[1600]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:E}),m.jsxs(Ct.div,{className:"fixed z-[1601] bg-white rounded-xl shadow-md overflow-hidden min-w-[200px] border-0 outline-none",style:{left:Math.min(a.pixel[0],window.innerWidth-220),top:Math.min(a.pixel[1],window.innerHeight-240)},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.15},children:[m.jsx("div",{className:"px-4 py-3 bg-white border-b border-gray-100",children:m.jsxs("div",{className:"flex items-center gap-2 text-blue-600",children:[m.jsx(Hl,{size:16}),m.jsx("span",{className:"text-xs font-mono",children:C(a.coordinate)})]})}),m.jsxs("div",{className:"bg-white",children:[m.jsxs("button",{onClick:M,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-orange-50 text-gray-700 bg-white border-0 outline-none",children:[m.jsx(Eb,{size:20,className:"text-orange-500"}),m.jsx("span",{className:"font-medium",children:"Vondst toevoegen"})]}),m.jsxs("button",{onClick:z,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-green-50 text-gray-700 bg-white border-0 outline-none",children:[m.jsx(xR,{size:20,className:"text-green-500"}),m.jsx("span",{className:"font-medium",children:"Foto maken"})]}),m.jsxs("div",{className:"relative",children:[m.jsxs("button",{onClick:()=>y(!g),className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-blue-50 text-gray-700 bg-white border-0 outline-none",children:[m.jsx(io,{size:20,className:"text-purple-500"}),m.jsx("span",{className:"font-medium flex-1 text-left",children:"Voeg toe aan laag..."}),m.jsx(Ow,{size:16,className:`text-gray-400 transition-transform ${g?"rotate-90":""}`})]}),m.jsx(mr,{children:g&&m.jsx(Ct.div,{className:"bg-gray-50 border-t border-gray-100",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},children:s.length===0?m.jsxs("button",{onClick:I,className:"w-full px-4 py-2 pl-11 flex items-center gap-2 text-sm text-purple-600 hover:bg-purple-50 bg-transparent border-0 outline-none",children:[m.jsx(co,{size:14}),m.jsx("span",{children:"Maak eerst een laag aan"})]}):m.jsxs(m.Fragment,{children:[s.map(k=>{const L=a?nEe(k,a.coordinate):!1;return m.jsxs("button",{onClick:()=>!L&&b(k.id),className:`w-full px-4 py-2 pl-11 flex items-center gap-2 text-sm bg-transparent border-0 outline-none ${L?"text-gray-400 cursor-not-allowed":"text-gray-700 hover:bg-gray-100"}`,title:L?"Al toegevoegd aan deze laag":void 0,disabled:L,children:[L&&m.jsx(Wl,{size:14,className:"text-green-500 flex-shrink-0"}),m.jsx("span",{className:"truncate",children:k.name}),m.jsx("span",{className:"text-xs text-gray-400 ml-auto",children:L?"al toegevoegd":`(${k.points.length})`})]},k.id)}),m.jsxs("button",{onClick:I,className:"w-full px-4 py-2 pl-11 flex items-center gap-2 text-sm text-purple-600 hover:bg-purple-50 bg-transparent border-0 outline-none border-t border-gray-200",children:[m.jsx(co,{size:14}),m.jsx("span",{children:"Nieuwe laag..."})]})]})})})]}),m.jsxs("button",{onClick:P,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-purple-50 text-gray-700 bg-white border-0 outline-none",children:[m.jsx(Toe,{size:20,className:"text-purple-500"}),m.jsx("span",{className:"font-medium",children:"Lagen beheren"})]}),m.jsxs("button",{onClick:F,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-blue-50 text-gray-700 bg-white border-0 outline-none",children:[m.jsx(S1,{size:20,className:"text-blue-600"}),m.jsx("span",{className:"font-medium",children:"Open in Google Maps"})]})]}),m.jsx("div",{className:"bg-white",children:m.jsxs("button",{onClick:T,className:"w-full px-4 py-3 flex items-center justify-center gap-2 text-gray-500 hover:bg-blue-50 transition-colors bg-white border-0 outline-none",children:[m.jsx(Ni,{size:18}),m.jsx("span",{children:"Annuleren"})]})})]})]})})}const iEe={Compass:yae,TreePalm:Boe,Mountain:bb,Waves:Koe,Search:Ib,Target:joe,Layers:io,Grid:Oae},sEe={Compass:"text-purple-600",Waves:"text-cyan-600",TreePalm:"text-green-600",Mountain:"text-stone-600",Search:"text-amber-600",Target:"text-red-600",Layers:"text-blue-600",Grid:"text-lime-600"},aEe={Compass:"hover:bg-purple-50",Waves:"hover:bg-cyan-50",TreePalm:"hover:bg-green-50",Mountain:"hover:bg-stone-50",Search:"hover:bg-amber-50",Target:"hover:bg-red-50",Layers:"hover:bg-blue-50",Grid:"hover:bg-lime-50"},LO=["Mijn Vondsten","Labels Overlay","TMK 1850","Bonnebladen 1900","Hunebedden","FAMKE Steentijd","Grafheuvels","Terpen","AMK Monumenten","AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig","Romeinse wegen (regio)","Romeinse wegen (Wereld)","Romeinse Forten","Romeinse Forten Lijnen","Kastelen","IKAW","Archeo Landschappen","Rijksmonumenten","Werelderfgoed","Religieus Erfgoed","Essen","Runes","WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Inundatiegebieden","Militaire Objecten","Paleokaart 800 n.Chr.","Paleokaart 100 n.Chr.","Paleokaart 500 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 9000 v.Chr.","UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling","AHN4 Hoogtekaart Kleur","AHN4 Hillshade NL","AHN4 Multi-Hillshade NL","AHN 0.5m","Veengebieden","Geomorfologie","Bodemkaart","Fossiel Hotspots","Mineralen Hotspots","Goudrivieren","Fossielen Nederland","Fossielen Belgi","Fossielen Duitsland","Fossielen Frankrijk","Wandelroutes","Parken","Speeltuinen","Musea","Strandjes","Kringloopwinkels","Gewaspercelen","Kadastrale Grenzen","Scheepswrakken","Woonheuvels ZH","Windmolens","Erfgoedlijnen","Oude Kernen","Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken","Verdronken Dorpen"],oEe=["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"],lEe=[5.2913,52.1326],cEe=8;function uEe(){const n=fi(L=>L.setLayerVisibility),e=ss(L=>L.stopTracking),t=Ji(L=>L.map),{presetsPanelOpen:r,togglePresetsPanel:i,closeAllPanels:s}=jr(),{presets:a,applyPreset:o,updatePreset:l,createPreset:u,resetToDefaults:h}=$8(),f=fi(L=>L.visible),g=Mr(L=>L.presetPanelFontScale),y=Mr(L=>L.setPresetPanelFontScale),v=12*g/100,[x,E]=ne.useState(null),[T,b]=ne.useState(!1),[I,M]=ne.useState(""),F=()=>{s(),LO.forEach(L=>n(L,!1)),oEe.forEach(L=>{n(L,L==="CartoDB (licht)")}),e(),t&&t.getView().animate({center:oo(lEe),zoom:cEe,duration:500}),console.log(" Reset: CartoDB, alle lagen uit, GPS uit, zoom naar Nederland")},z=L=>{o(L),s()},P=(L,O)=>{L.stopPropagation();const U=Object.entries(f).filter(([j,Te])=>Te&&LO.includes(j)).map(([j])=>j);l(O,{layers:U}),E(O),setTimeout(()=>E(null),2e3),console.log(" Lagen opgeslagen naar preset")},C=()=>{I.trim()&&(u(I.trim(),"Layers"),M(""),b(!1))},k=()=>{confirm("Alle presets terugzetten naar standaard? Dit verwijdert aangepaste presets.")&&h()};return m.jsxs(m.Fragment,{children:[m.jsx(Ct.button,{onClick:F,className:"fixed bottom-2 left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Reset - CartoDB, alle lagen uit, GPS uit",children:m.jsx(foe,{size:20,className:"text-gray-600"})}),m.jsx(Ct.button,{onClick:i,className:"fixed bottom-[60px] left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Presets",children:r?m.jsx(T9,{size:20,className:"text-blue-600"}):m.jsx(io,{size:20,className:"text-blue-600"})}),m.jsx(mr,{children:r&&m.jsxs(m.Fragment,{children:[m.jsx(Ct.div,{className:"fixed inset-0 z-[800]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:i}),m.jsxs(Ct.div,{initial:{opacity:0,x:-10,scale:.95},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:-10,scale:.95},transition:{duration:.15},className:"fixed bottom-[60px] left-[56px] bg-white/95 rounded-xl shadow-lg overflow-hidden w-[240px] backdrop-blur-sm z-[801]",children:[m.jsxs("div",{className:"flex items-center justify-between gap-2 px-3 py-1.5 bg-blue-500",style:{fontSize:`${v}px`},children:[m.jsx("span",{className:"font-medium text-white",children:"Presets"}),m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx("span",{className:"text-[9px] text-blue-200",children:"T"}),m.jsx("input",{type:"range",min:"80",max:"130",step:"10",value:g,onInput:L=>{y(parseInt(L.target.value))},onChange:L=>y(parseInt(L.target.value)),className:"w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${g}%`}),m.jsx("span",{className:"text-[11px] text-blue-200",children:"T"})]})]}),m.jsx("div",{className:"p-2 max-h-[300px] overflow-y-auto",children:a.map(L=>{const O=iEe[L.icon]||io,U=sEe[L.icon]||"text-blue-600",j=aEe[L.icon]||"hover:bg-blue-50",Te=x===L.id;return m.jsxs("button",{onClick:()=>z(L.id),className:`w-full h-8 flex items-center gap-2 px-2 ${j} rounded text-left transition-colors border-0 outline-none bg-transparent overflow-hidden ${Te?"bg-green-50":""}`,style:{fontSize:`${v}px`},children:[m.jsx(O,{size:14,className:`${U} flex-shrink-0`}),m.jsx("span",{className:"text-gray-700 truncate flex-1",children:L.name}),Te?m.jsx("span",{className:"ml-auto p-1 flex-shrink-0",children:m.jsx(Wl,{size:14,className:"text-green-500"})}):m.jsx("span",{onClick:Ce=>P(Ce,L.id),className:"ml-auto p-1 hover:bg-gray-200 rounded transition-colors flex-shrink-0",title:"Huidige lagen opslaan naar deze preset",children:m.jsx(M9,{size:12,className:"text-gray-400 hover:text-blue-500"})})]},L.id)})}),m.jsx("div",{className:"border-t border-gray-200 p-2",children:T?m.jsxs("div",{className:"flex gap-1",children:[m.jsx("input",{type:"text",value:I,onChange:L=>M(L.target.value),onKeyDown:L=>{L.key==="Enter"&&C(),L.key==="Escape"&&b(!1)},placeholder:"Naam preset...",autoFocus:!0,className:"flex-1 px-2 py-1 text-sm rounded bg-gray-50 border-0 outline-none focus:ring-1 focus:ring-blue-400",style:{fontSize:`${v}px`}}),m.jsx("button",{onClick:C,disabled:!I.trim(),className:"px-2 py-1 bg-blue-500 text-white rounded text-sm disabled:opacity-50 border-0 outline-none",children:m.jsx(Wl,{size:14})})]}):m.jsxs("div",{className:"flex gap-1",children:[m.jsxs("button",{onClick:()=>b(!0),className:"flex-1 flex items-center justify-center gap-1 px-2 py-1.5 text-sm text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",style:{fontSize:`${v}px`},children:[m.jsx(co,{size:14}),m.jsx("span",{children:"Nieuwe preset"})]}),m.jsx("button",{onClick:k,className:"p-1.5 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded transition-colors border-0 outline-none",title:"Presets terugzetten naar standaard",children:m.jsx(moe,{size:14})})]})})]})]})})]})}function hEe(){const n=Ji(a=>a.map),[e,t]=ne.useState(0),[r,i]=ne.useState(!1);ne.useEffect(()=>{if(!n)return;const a=n.getView(),o=()=>{const l=a.getRotation(),u=l*180/Math.PI;t(u),i(Math.abs(l)>.087)};return o(),a.on("change:rotation",o),()=>{a.un("change:rotation",o)}},[n]);const s=()=>{n&&n.getView().animate({rotation:0,duration:300})};return m.jsx(mr,{children:r&&m.jsx(Ct.button,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.2},onClick:s,className:"fixed top-[60px] right-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",title:"Klik om noorden te herstellen",children:m.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",style:{transform:`rotate(${-e}deg)`},children:[m.jsx("path",{d:"M12 2 L14.5 12 L12 10 L9.5 12 Z",fill:"#EA4335"}),m.jsx("path",{d:"M12 22 L9.5 12 L12 14 L14.5 12 Z",fill:"white",stroke:"#9CA3AF",strokeWidth:"0.5"}),m.jsx("circle",{cx:"12",cy:"12",r:"2",fill:"#374151"})]})})})}const dEe=[{name:"AHN4 Hoogtekaart Kleur",color:"blue",default:.85},{name:"AHN4 Hillshade NL",color:"blue",default:.7},{name:"AHN4 Multi-Hillshade NL",color:"blue",default:.7},{name:"AHN 0.5m",color:"blue",default:.7},{name:"TMK 1850",color:"amber",default:.8},{name:"Bonnebladen 1900",color:"amber",default:.8},{name:"Geomorfologie",color:"green",default:.5},{name:"Bodemkaart",color:"amber",default:.6},{name:"Veengebieden",color:"amber",default:.6},{name:"IKAW",color:"orange",default:.5},{name:"Archeo Landschappen",color:"green",default:.5},{name:"Terpen",color:"orange",default:.7},{name:"Essen",color:"amber",default:.6},{name:"Paleokaart 9000 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 5500 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 2750 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 1500 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 500 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 100 n.Chr.",color:"indigo",default:.7},{name:"Paleokaart 800 n.Chr.",color:"indigo",default:.7},{name:"Verdedigingslinies",color:"red",default:.7},{name:"Inundatiegebieden",color:"red",default:.5},{name:"Gewaspercelen",color:"green",default:.6},{name:"Erfgoedlijnen",color:"purple",default:.7},{name:"Oude Kernen",color:"orange",default:.6},{name:"Relictenkaart Vlakken",color:"green",default:.5}],fEe={blue:"accent-blue-500",amber:"accent-amber-500",red:"accent-red-500",indigo:"accent-indigo-500",green:"accent-green-500",orange:"accent-orange-500",purple:"accent-purple-500"};function gEe(){const[n,e]=ne.useState(!1),[t,r]=ne.useState(!1),i=fi(h=>h.visible),s=fi(h=>h.opacity),a=fi(h=>h.setLayerOpacity),o=dEe.filter(h=>i[h.name]);if(o.length===0)return null;const l=t?o:o.slice(0,3),u=o.length>3;return m.jsxs("div",{className:"fixed bottom-[112px] right-2 z-[900]",children:[m.jsxs(Ct.button,{onClick:()=>e(!n),className:"w-11 h-11 bg-white/80 rounded-xl backdrop-blur-sm shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none hover:bg-white/90 transition-colors",whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":"Opacity sliders",title:n?"Sluit opacity sliders":"Open opacity sliders",children:[m.jsx(Roe,{size:22,strokeWidth:2,className:"text-gray-500"}),o.length>0&&m.jsx("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-blue-500 text-white text-[10px] rounded-full flex items-center justify-center",children:o.length})]}),m.jsx(mr,{children:n&&m.jsxs(m.Fragment,{children:[m.jsx(Ct.div,{className:"fixed inset-0 z-[-1]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>e(!1)}),m.jsxs(Ct.div,{initial:{opacity:0,x:20,scale:.9},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:20,scale:.9},transition:{duration:.2},className:"absolute bottom-0 right-14 bg-white/95 rounded-lg shadow-lg p-3 min-w-[220px] max-h-[60vh] overflow-y-auto",children:[m.jsx("div",{className:"text-xs font-semibold text-gray-500 mb-2 uppercase tracking-wide",children:"Transparantie"}),m.jsx("div",{className:"space-y-3",children:l.map(h=>{const f=s[h.name]??h.default;return m.jsxs("div",{children:[m.jsx("label",{className:"text-xs font-medium text-gray-700 mb-1 block truncate",title:h.name,children:h.name}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("input",{type:"range",min:"0",max:"100",value:f*100,onChange:g=>a(h.name,parseInt(g.target.value)/100),className:`flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer ${fEe[h.color]}`}),m.jsxs("span",{className:"text-xs text-gray-500 w-8 text-right select-none pointer-events-none",children:[Math.round(f*100),"%"]})]})]},h.name)})}),u&&m.jsx("button",{onClick:()=>r(!t),className:"w-full mt-3 pt-2 border-t border-gray-200 flex items-center justify-center gap-1 text-xs text-gray-500 hover:text-gray-700",children:t?m.jsxs(m.Fragment,{children:[m.jsx(T9,{size:14}),"Minder tonen"]}):m.jsxs(m.Fragment,{children:[m.jsx(vR,{size:14}),o.length-3," meer..."]})})]})]})})]})}function mEe(){const n=Ji(I=>I.map),[e,t]=ne.useState(!1),[r,i]=ne.useState(""),[s,a]=ne.useState([]),[o,l]=ne.useState(!1),[u,h]=ne.useState(!1),f=ne.useRef(null),g=ne.useRef(null),y=ne.useRef();ne.useEffect(()=>{e&&f.current&&f.current.focus()},[e]),ne.useEffect(()=>{if(!e)return;const I=M=>{g.current&&!g.current.contains(M.target)&&v()};return document.addEventListener("mousedown",I),()=>document.removeEventListener("mousedown",I)},[e]),ne.useEffect(()=>{if(!e)return;const I=M=>{M.key==="Escape"&&v()};return document.addEventListener("keydown",I),()=>document.removeEventListener("keydown",I)},[e]),ne.useEffect(()=>{if(y.current&&clearTimeout(y.current),r.length<2){a([]);return}return y.current=window.setTimeout(async()=>{h(!0);try{const M=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/suggest?q=${encodeURIComponent(r)}&rows=7`)).json();M.response?.docs&&a(M.response.docs)}catch(I){console.error("Search error:",I),a([])}finally{h(!1)}},300),()=>{y.current&&clearTimeout(y.current)}},[r]);const v=()=>{t(!1),i(""),a([]),l(!1)},x=async I=>{try{const F=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/lookup?id=${encodeURIComponent(I)}`)).json();if(F.response?.docs?.[0]?.centroide_ll){const P=F.response.docs[0].centroide_ll.match(/POINT\(([^ ]+) ([^)]+)\)/);if(P)return{lng:parseFloat(P[1]),lat:parseFloat(P[2])}}}catch(M){console.error("Lookup error:",M)}return null},E=async I=>{if(!n)return;const M=await x(I.id);M&&n.getView().animate({center:oo([M.lng,M.lat]),zoom:16,duration:1e3}),v()},T=async(I,M)=>{M.stopPropagation();const F=await x(I.id);if(F){const z=`https://www.google.com/maps?q=${F.lat},${F.lng}`;window.open(z,"_blank")}v()},b={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"};return e?m.jsxs("div",{ref:g,className:"fixed left-[52px] right-14 z-[850]",style:b,children:[m.jsxs(Ct.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"search-input-wrapper",children:[m.jsx(Ib,{size:18,className:"search-icon"}),m.jsx("input",{ref:f,type:"text",value:r,onChange:I=>{i(I.target.value),l(!0)},onFocus:()=>l(!0),placeholder:"Zoek adres of plaats...",className:"search-input"}),m.jsx("button",{onClick:v,className:"search-clear",title:"Sluiten",children:m.jsx(Ni,{size:18})})]}),m.jsx(mr,{children:o&&s.length>0&&m.jsx(Ct.ul,{className:"search-results",initial:{opacity:0,y:-8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},children:s.map(I=>m.jsxs("li",{className:"search-result-item",children:[m.jsx("div",{className:"search-result-content",onClick:()=>E(I),children:m.jsx("span",{className:"search-result-text",children:I.weergavenaam})}),m.jsx("button",{className:"search-navigate-btn",onClick:M=>T(I,M),title:"Open in Google Maps",children:m.jsx(S1,{size:20})})]},I.id))})}),o&&u&&m.jsx("div",{className:"search-loading",children:"Zoeken..."})]}):m.jsx(Ct.button,{className:"fixed right-14 z-[800] w-11 h-11 flex items-center justify-center bg-white/90 hover:bg-white rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",style:b,onClick:()=>t(!0),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Zoeken",children:m.jsx(Ib,{size:22,className:"text-gray-600"})})}function pEe(){const n=Ji(r=>r.map),e=()=>{if(!n)return;const r=n.getView(),i=r.getZoom();i!==void 0&&r.animate({zoom:i+1,duration:200})},t=()=>{if(!n)return;const r=n.getView(),i=r.getZoom();i!==void 0&&r.animate({zoom:i-1,duration:200})};return m.jsxs("div",{className:"fixed top-2 left-2 z-[800] flex flex-col gap-1",children:[m.jsx(Ct.button,{className:"w-9 h-9 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},title:"Inzoomen",children:m.jsx(co,{size:18,className:"text-gray-600"})}),m.jsx(Ct.button,{className:"w-9 h-9 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",onClick:t,whileHover:{scale:1.05},whileTap:{scale:.95},title:"Uitzoomen",children:m.jsx(Qae,{size:18,className:"text-gray-600"})})]})}const yEe="detector2024",Hb="detectorapp-auth";function _Ee({children:n}){const[e,t]=ne.useState(!1),[r,i]=ne.useState(""),[s,a]=ne.useState(!1),[o,l]=ne.useState(""),[u,h]=ne.useState(!0);ne.useEffect(()=>{localStorage.getItem(Hb)==="authenticated"&&t(!0),h(!1)},[]);const f=g=>{g.preventDefault(),l(""),r===yEe?(localStorage.setItem(Hb,"authenticated"),t(!0)):(l("Onjuist wachtwoord"),i(""))};return u?m.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-blue-600 to-blue-800 flex items-center justify-center",children:m.jsx("div",{className:"text-white text-lg",children:"Laden..."})}):e?m.jsx(m.Fragment,{children:n}):m.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-blue-600 to-blue-800 flex items-center justify-center p-4",children:m.jsxs(Ct.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-sm",children:[m.jsxs("div",{className:"text-center mb-6",children:[m.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:m.jsx(Tb,{size:32,className:"text-blue-600"})}),m.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"DetectorApp"}),m.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Test versie - Toegang beveiligd"})]}),m.jsxs("form",{onSubmit:f,className:"space-y-4",children:[m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Wachtwoord"}),m.jsxs("div",{className:"relative",children:[m.jsx("input",{type:s?"text":"password",value:r,onChange:g=>i(g.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none pr-12",placeholder:"Voer wachtwoord in",autoFocus:!0}),m.jsx("button",{type:"button",onClick:()=>a(!s),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:s?m.jsx(I9,{size:20}):m.jsx(A9,{size:20})})]})]}),o&&m.jsx(Ct.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-red-500 text-sm text-center",children:o}),m.jsx("button",{type:"submit",className:"w-full py-3 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors",children:"Inloggen"})]}),m.jsx("p",{className:"text-center text-xs text-gray-400 mt-6",children:"Alleen voor testers"})]})})}function xEe(){localStorage.removeItem(Hb),window.location.reload()}function vEe({isOpen:n,onClose:e}){const t=Ko(l=>l.vondsten),r={total:t.length,byType:{},byMaterial:{},byPeriod:{},byCondition:{},avgDepth:0,totalWeight:0,recent:t.slice(-5).reverse()};let i=0,s=0;t.forEach(l=>{r.byType[l.objectType]=(r.byType[l.objectType]||0)+1,r.byMaterial[l.material]=(r.byMaterial[l.material]||0)+1,r.byPeriod[l.period]=(r.byPeriod[l.period]||0)+1,l.condition&&(r.byCondition[l.condition]=(r.byCondition[l.condition]||0)+1),l.depth&&(i+=l.depth,s++),l.weight&&(r.totalWeight+=l.weight)}),r.avgDepth=s>0?Math.round(i/s):0;const a=l=>Object.entries(l).sort((u,h)=>h[1]-u[1]),o=l=>Math.max(...Object.values(l),1);return m.jsx(mr,{children:n&&m.jsxs(m.Fragment,{children:[m.jsx(Ct.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),m.jsxs(Ct.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-md mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},children:[m.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(S9,{size:18}),m.jsx("span",{className:"font-medium",children:"Mijn Vondsten Dashboard"})]}),m.jsx("button",{onClick:e,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none",children:m.jsx(Ni,{size:18})})]}),m.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-5",children:t.length===0?m.jsxs("div",{className:"text-center py-8 text-gray-500",children:[m.jsx(Hl,{size:48,className:"mx-auto mb-3 opacity-30"}),m.jsx("p",{className:"font-medium",children:"Nog geen vondsten"}),m.jsx("p",{className:"text-sm mt-1",children:"Voeg je eerste vondst toe via de oranje knop of long-press op de kaart"})]}):m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[m.jsx(YS,{icon:m.jsx(Hl,{size:20}),value:r.total,label:"Totaal",color:"bg-orange-100 text-orange-700"}),m.jsx(YS,{icon:m.jsx(P9,{size:20}),value:r.avgDepth>0?`${r.avgDepth}cm`:"-",label:"Gem. diepte",color:"bg-blue-100 text-blue-700"}),m.jsx(YS,{icon:m.jsx(voe,{size:20}),value:r.totalWeight>0?`${r.totalWeight.toFixed(1)}g`:"-",label:"Tot. gewicht",color:"bg-green-100 text-green-700"})]}),m.jsx(S_,{title:"Per Type",data:a(r.byType),max:o(r.byType),color:"bg-orange-500"}),m.jsx(S_,{title:"Per Periode",data:a(r.byPeriod),max:o(r.byPeriod),color:"bg-amber-500"}),m.jsx(S_,{title:"Per Materiaal",data:a(r.byMaterial),max:o(r.byMaterial),color:"bg-blue-500"}),Object.keys(r.byCondition).length>0&&m.jsx(S_,{title:"Per Conditie",data:a(r.byCondition),max:o(r.byCondition),color:"bg-green-500"}),m.jsxs("div",{children:[m.jsxs("h3",{className:"text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2",children:[m.jsx(Zse,{size:14}),"Recente Vondsten"]}),m.jsx("div",{className:"space-y-2",children:r.recent.map(l=>m.jsxs("div",{className:"flex items-center justify-between py-2 px-3 bg-gray-50 rounded-lg",children:[m.jsxs("div",{children:[m.jsx("span",{className:"font-medium text-sm text-gray-800",children:l.objectType}),m.jsx("span",{className:"text-gray-400 mx-1",children:"-"}),m.jsx("span",{className:"text-sm text-gray-600",children:l.material})]}),m.jsx("span",{className:"text-xs text-gray-400",children:new Date(l.timestamp).toLocaleDateString("nl-NL")})]},l.id))})]})]})})]})]})})}function YS({icon:n,value:e,label:t,color:r}){return m.jsxs("div",{className:`rounded-lg p-3 ${r}`,children:[m.jsx("div",{className:"flex items-center gap-2 mb-1 opacity-70",children:n}),m.jsx("div",{className:"text-xl font-bold",children:e}),m.jsx("div",{className:"text-xs opacity-70",children:t})]})}function S_({title:n,data:e,max:t,color:r}){return e.length===0?null:m.jsxs("div",{children:[m.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:n}),m.jsx("div",{className:"space-y-1.5",children:e.slice(0,6).map(([i,s])=>m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("div",{className:"w-24 text-xs text-gray-600 truncate",title:i,children:i}),m.jsx("div",{className:"flex-1 h-4 bg-gray-100 rounded-full overflow-hidden",children:m.jsx(Ct.div,{className:`h-full ${r} rounded-full`,initial:{width:0},animate:{width:`${s/t*100}%`},transition:{duration:.5,ease:"easeOut"}})}),m.jsx("div",{className:"w-6 text-xs text-gray-600 text-right font-medium",children:s})]},i))})]})}function wEe(n){const{type:e,coordinates:t}=n,r=o=>oo(o),i=o=>o.map(r),s=o=>o.map(i),a=o=>o.map(s);switch(e){case"Point":return new ds(r(t));case"LineString":return new Ra(i(t));case"Polygon":return new Ca(s(t));case"MultiPoint":return new cd(i(t));case"MultiLineString":return new Vl(s(t));case"MultiPolygon":return new Vh(a(t));default:return console.warn(`Unsupported geometry type: ${e}`),null}}function EEe(n,e,t){const r=n.color,i=10,s=5,a=14;let o=i;if(t>50?o=s:t>10?o=Math.max(s,i-(t-10)/10):t<2&&(o=a),e==="Point"||e==="MultiPoint")return new $n({image:new ka({radius:o,fill:new kr({color:r}),stroke:new Hr({color:"#ffffff",width:2})})});if(e==="LineString"||e==="MultiLineString")return new $n({stroke:new Hr({color:r,width:3})});if(e==="Polygon"||e==="MultiPolygon"){const l=SEe(r,.3);return new $n({fill:new kr({color:l}),stroke:new Hr({color:r,width:2})})}return new $n({image:new ka({radius:o,fill:new kr({color:r}),stroke:new Hr({color:"#ffffff",width:2})})})}function SEe(n,e){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(n);if(t){const r=parseInt(t[1],16),i=parseInt(t[2],16),s=parseInt(t[3],16);return`rgba(${r}, ${i}, ${s}, ${e})`}return n}function TEe(){const n=Ji(r=>r.map),e=_1(r=>r.layers),t=ne.useRef(new Map);return ne.useEffect(()=>{if(!n)return;const r=new Set;e.forEach(i=>{r.add(i.id);const s=new O0;i.features.features.forEach((o,l)=>{if(!o.geometry)return;const u=wEe(o.geometry);if(!u)return;const h=new Cs({geometry:u,...o.properties,layerType:"importedLayer",layerId:i.id,layerName:i.name,layerColor:i.color,featureIndex:l});h.setStyle((f,g)=>EEe(i,o.geometry.type,g)),s.addFeature(h)});const a=t.current.get(i.id);if(a)a.setSource(s),a.setVisible(i.visible),a.setOpacity(i.opacity);else{const o=new F0({source:s,zIndex:900,visible:i.visible,opacity:i.opacity,properties:{title:i.name,customLayerId:i.id}});n.addLayer(o),t.current.set(i.id,o)}}),t.current.forEach((i,s)=>{r.has(s)||(n.removeLayer(i),t.current.delete(s))})},[n,e]),ne.useEffect(()=>()=>{n&&(t.current.forEach(r=>{n.removeLayer(r)}),t.current.clear())},[n]),null}vn.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs");D7(vn);function bEe(n){if(!n||n.length<2)return"unknown";const[e,t]=n;return e>=7e3&&e<=3e5&&t>=289e3&&t<=629e3?"RD":Math.abs(e)<=180&&Math.abs(t)<=90?"WGS84":"unknown"}function IEe(n){const[e,t]=n;return vn("EPSG:28992","EPSG:4326",[e,t])}function yG(n,e){return typeof n[0]=="number"?e(n):n.map(t=>yG(t,e))}function AEe(n){const e=n.coordinates;return!e||Array.isArray(e)&&e.length===0?null:n.type==="Point"?e:n.type==="LineString"||n.type==="MultiPoint"?e[0]:n.type==="Polygon"||n.type==="MultiLineString"?e[0]?.[0]:n.type==="MultiPolygon"?e[0]?.[0]?.[0]:null}async function REe(n){const e=[],t=[];try{const r=await n.text(),i=JSON.parse(r);if(!i.type)return e.push('Ongeldig GeoJSON: geen "type" veld gevonden'),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:t,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}};let s=[];i.type==="FeatureCollection"?s=i.features||[]:i.type==="Feature"?s=[i]:i.type==="GeometryCollection"?s=(i.geometries||[]).map((u,h)=>({type:"Feature",geometry:u,properties:{id:h}})):s=[{type:"Feature",geometry:i,properties:{}}],s.length===0&&t.push("Geen features gevonden in bestand");let a="unknown",o=!1;if(s.length>0&&s[0].geometry){const u=AEe(s[0].geometry);u&&(a=bEe(u))}a==="RD"&&(t.push("Rijksdriehoek coordinaten gedetecteerd, worden omgezet naar WGS84"),o=!0,s=s.map(u=>{if(!u.geometry)return u;const h=yG(u.geometry.coordinates,IEe);return{...u,geometry:{...u.geometry,coordinates:h}}}),a="WGS84");const l=[...new Set(s.filter(u=>u.geometry).map(u=>u.geometry.type))];return{success:!0,features:{type:"FeatureCollection",features:s},errors:e,warnings:t,metadata:{featureCount:s.length,geometryTypes:l,coordinateSystem:a,transformed:o}}}catch(r){return e.push(`Fout bij parsen: ${r instanceof Error?r.message:"Onbekende fout"}`),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:t,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}async function CEe(n){const e=[],t=[];try{const r=await n.text(),s=new C0e({extractStyles:!1}).readFeatures(r,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"});s.length===0&&t.push("Geen features gevonden in KML bestand");const l=new FR().writeFeaturesObject(s,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"}).features.map((h,f)=>{const g={...h.properties},y=g.name||g.Name||`Feature ${f+1}`,v=g.description||g.Description||"";return{type:"Feature",geometry:h.geometry,properties:{...g,name:y,description:v}}}),u=[...new Set(l.filter(h=>h.geometry).map(h=>h.geometry.type))];return{success:!0,features:{type:"FeatureCollection",features:l},errors:e,warnings:t,metadata:{featureCount:l.length,geometryTypes:u,coordinateSystem:"WGS84",transformed:!1}}}catch(r){return e.push(`Fout bij parsen KML: ${r instanceof Error?r.message:"Onbekende fout"}`),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:t,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}async function kEe(n){const e=[],t=[];try{const r=await n.text(),s=new zfe().readFeatures(r,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"});s.length===0&&t.push("Geen features gevonden in GPX bestand");const l=new FR().writeFeaturesObject(s,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"}).features.map((h,f)=>{const g={...h.properties},y=g.name||g.Name||`Waypoint ${f+1}`,v=g.desc||g.description||"",x=g.time||null,E=g.ele||null;return{type:"Feature",geometry:h.geometry,properties:{...g,name:y,description:v,time:x,elevation:E}}}),u=[...new Set(l.filter(h=>h.geometry).map(h=>h.geometry.type))];return u.includes("LineString")&&t.push("GPX track routes worden als lijnen weergegeven"),{success:!0,features:{type:"FeatureCollection",features:l},errors:e,warnings:t,metadata:{featureCount:l.length,geometryTypes:u,coordinateSystem:"WGS84",transformed:!1}}}catch(r){return e.push(`Fout bij parsen GPX: ${r instanceof Error?r.message:"Onbekende fout"}`),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:t,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}function gC(n){switch(n.split(".").pop()?.toLowerCase()){case"geojson":case"json":return"geojson";case"kml":case"kmz":return"kml";case"gpx":return"gpx";default:return"unsupported"}}function PEe(){return".geojson,.json,.kml,.gpx"}function mC(){return"GeoJSON, KML (Google My Maps), GPX"}async function MEe(n){switch(gC(n.name)){case"geojson":return REe(n);case"kml":return CEe(n);case"gpx":return kEe(n);case"unsupported":default:return{success:!1,features:{type:"FeatureCollection",features:[]},errors:[`Niet-ondersteund bestandsformaat: ${n.name}. Ondersteunde formaten: ${mC()}`],warnings:[],metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}function NEe(n){return n.size>10485760?{valid:!1,error:`Bestand te groot (${(n.size/1024/1024).toFixed(1)} MB). Maximum is 10 MB.`}:gC(n.name)==="unsupported"?{valid:!1,error:`Niet-ondersteund bestandsformaat. Ondersteunde formaten: ${mC()}`}:n.name.toLowerCase().endsWith(".kmz")?{valid:!1,error:"KMZ bestanden worden nog niet ondersteund. Pak het bestand uit en importeer het .kml bestand."}:{valid:!0}}function LEe({isOpen:n,onClose:e}){const t=_1(C=>C.addLayer),r=ne.useRef(null),[i,s]=ne.useState("idle"),[a,o]=ne.useState(null),[l,u]=ne.useState(null),[h,f]=ne.useState(""),[g,y]=ne.useState(null),[v,x]=ne.useState(!1),E=ne.useCallback(()=>{s("idle"),o(null),u(null),f(""),y(null),r.current&&(r.current.value="")},[]),T=ne.useCallback(()=>{E(),e()},[E,e]),b=ne.useCallback(async C=>{const k=NEe(C);if(!k.valid){y(k.error||"Ongeldig bestand"),s("error");return}o(C),s("parsing"),y(null);const L=C.name.replace(/\.[^/.]+$/,"");f(L);try{const O=await MEe(C);if(!O.success){y(O.errors.join(`
`)),s("error");return}if(O.features.features.length===0){y("Geen features gevonden in het bestand"),s("error");return}u(O),s("preview")}catch(O){y(O instanceof Error?O.message:"Onbekende fout bij parsen"),s("error")}},[]),I=ne.useCallback(C=>{const k=C.target.files?.[0];k&&b(k)},[b]),M=ne.useCallback(C=>{C.preventDefault(),x(!0)},[]),F=ne.useCallback(C=>{C.preventDefault(),x(!1)},[]),z=ne.useCallback(C=>{C.preventDefault(),x(!1);const k=C.dataTransfer.files?.[0];k&&b(k)},[b]),P=ne.useCallback(()=>{if(!l||!h.trim())return;const C=a?gC(a.name):"geojson";t({name:h.trim(),type:C==="unsupported"?"geojson":C,features:l.features,visible:!0,opacity:1,color:"",sourceFileName:a?.name||"unknown"}),T()},[l,h,a,t,T]);return m.jsx(mr,{children:n&&m.jsxs(m.Fragment,{children:[m.jsx(Ct.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:T}),m.jsxs(Ct.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-md mx-auto my-auto max-h-[80vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[m.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-purple-500 to-purple-600 text-white",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(Dw,{size:18}),m.jsx("span",{className:"font-medium",children:"Laag Importeren"})]}),m.jsx("button",{onClick:T,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none",children:m.jsx(Ni,{size:18})})]}),m.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[i==="idle"&&m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${v?"border-purple-500 bg-purple-50":"border-gray-300 hover:border-gray-400"}`,onDragOver:M,onDragLeave:F,onDrop:z,children:[m.jsx(R9,{size:40,className:"mx-auto text-gray-400 mb-3"}),m.jsx("p",{className:"text-gray-600 mb-2",children:"Sleep een bestand hierheen"}),m.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"of"}),m.jsx("button",{onClick:()=>r.current?.click(),className:"px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors border-0 outline-none",children:"Bestand kiezen"}),m.jsx("input",{ref:r,type:"file",accept:PEe(),onChange:I,className:"hidden"})]}),m.jsxs("div",{className:"text-xs text-gray-500 text-center",children:[m.jsx("p",{className:"font-medium",children:"Ondersteunde formaten:"}),m.jsx("p",{children:mC()})]})]}),i==="parsing"&&m.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[m.jsx(wR,{size:40,className:"text-purple-500 animate-spin mb-4"}),m.jsx("p",{className:"text-gray-600",children:"Bestand verwerken..."}),m.jsx("p",{className:"text-gray-400 text-sm",children:a?.name})]}),i==="error"&&m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"flex items-start gap-3 p-4 bg-red-50 rounded-lg",children:[m.jsx(b9,{size:20,className:"text-red-500 flex-shrink-0 mt-0.5"}),m.jsxs("div",{children:[m.jsx("p",{className:"font-medium text-red-700",children:"Import mislukt"}),m.jsx("p",{className:"text-sm text-red-600 mt-1 whitespace-pre-wrap",children:g})]})]}),m.jsx("button",{onClick:E,className:"w-full px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors border-0 outline-none",children:"Opnieuw proberen"})]}),i==="preview"&&l&&m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"flex items-start gap-3 p-3 bg-green-50 rounded-lg",children:[m.jsx(lae,{size:20,className:"text-green-500 flex-shrink-0 mt-0.5"}),m.jsxs("div",{children:[m.jsx("p",{className:"font-medium text-green-700",children:"Bestand geladen"}),m.jsx("p",{className:"text-sm text-green-600",children:a?.name})]})]}),l.warnings.length>0&&m.jsxs("div",{className:"p-3 bg-amber-50 rounded-lg",children:[m.jsx("p",{className:"font-medium text-amber-700 text-sm",children:"Let op:"}),m.jsx("ul",{className:"text-sm text-amber-600 mt-1 list-disc list-inside",children:l.warnings.map((C,k)=>m.jsx("li",{children:C},k))})]}),m.jsx("div",{className:"p-3 bg-gray-50 rounded-lg text-sm",children:m.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[m.jsxs("div",{children:[m.jsx("span",{className:"text-gray-500",children:"Features:"}),m.jsx("span",{className:"ml-2 font-medium",children:l.metadata.featureCount})]}),m.jsxs("div",{children:[m.jsx("span",{className:"text-gray-500",children:"Types:"}),m.jsx("span",{className:"ml-2 font-medium",children:l.metadata.geometryTypes.join(", ")||"-"})]})]})}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Naam van de laag"}),m.jsx("input",{type:"text",value:h,onChange:C=>f(C.target.value),placeholder:"Bijv. Mijn locaties",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]})]}),i==="preview"&&m.jsxs("div",{className:"px-4 py-3 border-t border-gray-100 flex gap-2",children:[m.jsx("button",{onClick:E,className:"flex-1 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors border-0 outline-none",children:"Annuleren"}),m.jsx("button",{onClick:P,disabled:!h.trim(),className:"flex-1 px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors border-0 outline-none disabled:opacity-50 disabled:cursor-not-allowed",children:"Importeren"})]})]})]})})}function OEe(){const{user:n,loading:e,error:t,signInWithGoogle:r,logout:i,initAuth:s}=Rw();return ne.useEffect(()=>{s()},[s]),e?m.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-white rounded-lg text-gray-500",children:[m.jsx(wb,{size:16,className:"animate-pulse"}),m.jsx("span",{className:"text-sm",children:"Laden..."})]}):n?m.jsxs("div",{className:"flex items-center gap-3 px-3 py-2.5 bg-green-50 rounded-lg",children:[n.photoURL?m.jsx("img",{src:n.photoURL,alt:n.displayName||"User",className:"w-8 h-8 rounded-full border-2 border-green-200",referrerPolicy:"no-referrer"}):m.jsx("div",{className:"w-8 h-8 rounded-full bg-green-200 flex items-center justify-center",children:m.jsx(bR,{size:16,className:"text-green-600"})}),m.jsxs("div",{className:"flex-1 min-w-0",children:[m.jsx("div",{className:"text-sm font-medium text-green-800 truncate",children:n.displayName||n.email}),m.jsxs("div",{className:"text-xs text-green-600 flex items-center gap-1",children:[m.jsx(wb,{size:12}),"Cloud sync actief"]})]}),m.jsx("button",{onClick:i,className:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none bg-transparent",title:"Uitloggen",children:m.jsx(ER,{size:16})})]}):m.jsxs("div",{className:"space-y-2",children:[m.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-gray-50 rounded-lg text-gray-500",children:[m.jsx(dae,{size:16}),m.jsx("span",{className:"text-sm",children:"Alleen lokale opslag"})]}),m.jsxs("button",{onClick:r,className:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-white hover:bg-blue-50 rounded-lg transition-colors border-0 outline-none",children:[m.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",children:[m.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),m.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),m.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),m.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),m.jsx("span",{className:"text-sm text-gray-700",children:"Inloggen met Google"})]}),t&&m.jsx("div",{className:"px-3 py-2 bg-red-50 text-red-700 text-xs rounded-lg",children:t})]})}const DEe="https://forms.gle/R5LCk11Bzu5XrkBj8";function FEe(){const{settingsPanelOpen:n,toggleSettingsPanel:e,vondstDashboardOpen:t,toggleVondstDashboard:r,openLayerManagerModal:i}=jr(),s=Mr(),{presets:a,createPreset:o,deletePreset:l,updatePreset:u}=$8(),h=Ko(J=>J.vondsten),f=_1(J=>J.layers),{layers:g,updateLayer:y}=Xi(),{devMode:v,setDevMode:x,tier:E}=jA(),[T,b]=ne.useState(""),[I,M]=ne.useState(!1),[F,z]=ne.useState(!1),[P,C]=ne.useState(null),[k,L]=ne.useState(""),[O,U]=ne.useState(null),[j,Te]=ne.useState(""),[Ce,Ue]=ne.useState("algemeen"),Ne=14*s.fontScale/100,le=()=>{T.trim()&&(o(T.trim(),"Layers"),b(""),M(!1))},ue=(J,re)=>{C(J),L(re)},Se=J=>{k.trim()&&(u(J,{name:k.trim()}),console.log(` Preset hernoemd naar "${k.trim()}"`)),C(null),L("")},se=()=>{C(null),L("")},V=[{id:"algemeen",label:"Algemeen",icon:m.jsx(koe,{size:14})},{id:"lagen",label:"Lagen",icon:m.jsx(io,{size:14})},{id:"vondsten",label:"Vondsten",icon:m.jsx(Hl,{size:14})}];return m.jsxs(m.Fragment,{children:[m.jsx(mr,{children:n&&m.jsxs(m.Fragment,{children:[m.jsx(Ct.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),m.jsxs(Ct.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-sm mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[m.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-blue-500",style:{fontSize:`${Ne}px`},children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(Ab,{size:18,className:"text-white"}),m.jsx("span",{className:"font-medium text-white",children:"Instellingen"})]}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("span",{className:"text-[10px] text-blue-200",children:"T"}),m.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:s.fontScale,onInput:J=>{s.setFontScale(parseInt(J.target.value))},onChange:J=>s.setFontScale(parseInt(J.target.value)),className:"w-20 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${s.fontScale}%`}),m.jsx("span",{className:"text-xs text-blue-200",children:"T"}),m.jsx("button",{onClick:e,className:"p-1 rounded bg-blue-400/50 hover:bg-blue-400 transition-colors border-0 outline-none ml-1",children:m.jsx(Ni,{size:18,className:"text-white",strokeWidth:2.5})})]})]}),m.jsx("div",{className:"flex border-b border-gray-200",children:V.map(J=>m.jsxs("button",{onClick:()=>Ue(J.id),className:`flex-1 flex items-center justify-center gap-1.5 px-3 py-2.5 text-sm font-medium transition-colors border-0 outline-none ${Ce===J.id?"text-blue-600 border-b-2 border-blue-600 bg-blue-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[J.icon,J.label]},J.id))}),m.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-5",style:{fontSize:`${Ne}px`},children:[Ce==="algemeen"&&m.jsxs(m.Fragment,{children:[m.jsx(ko,{title:"Account",icon:m.jsx(bR,{size:16}),children:m.jsx(OEe,{})}),m.jsxs(ko,{title:"Kaart",icon:m.jsx(SR,{size:16}),children:[m.jsx(jEe,{label:"Standaard achtergrond",children:m.jsxs("select",{value:s.defaultBackground,onChange:J=>s.setDefaultBackground(J.target.value),className:"px-2 py-1 bg-gray-100 rounded border-0 outline-none",style:{fontSize:"0.9em"},children:[m.jsx("option",{value:"CartoDB (licht)",children:"Licht"}),m.jsx("option",{value:"OpenStreetMap",children:"OSM"}),m.jsx("option",{value:"Luchtfoto",children:"Luchtfoto"})]})}),m.jsx(th,{label:"Schaalbalk tonen",checked:s.showScaleBar,onChange:s.setShowScaleBar})]}),m.jsxs(ko,{title:"GPS",icon:m.jsx(TR,{size:16}),children:[m.jsx(th,{label:"GPS aan bij start",checked:s.gpsAutoStart,onChange:s.setGpsAutoStart}),m.jsx(th,{label:"Nauwkeurigheidscirkel",checked:s.showAccuracyCircle,onChange:s.setShowAccuracyCircle})]}),m.jsx(ko,{title:"Feedback",icon:m.jsx(Moe,{size:16}),children:m.jsx(th,{label:"Trillen bij acties",checked:s.hapticFeedback,onChange:s.setHapticFeedback})}),m.jsxs(ko,{title:"Development",icon:m.jsx(mae,{size:16}),children:[m.jsx(th,{label:"Dev Mode (alles ontgrendeld)",checked:v,onChange:x}),m.jsxs("p",{className:"text-gray-500 mt-1",style:{fontSize:"0.75em"},children:["Huidige tier: ",m.jsx("span",{className:"font-medium text-blue-600",children:E}),v&&m.jsx("span",{className:"text-green-600",children:" (alle lagen ontgrendeld)"})]})]})]}),Ce==="lagen"&&m.jsxs(m.Fragment,{children:[m.jsx(ko,{title:"Mijn lagen",icon:m.jsx(io,{size:16}),isOwn:!0,children:m.jsxs("div",{className:"space-y-1",children:[g.filter(J=>!J.archived).length===0?m.jsx("p",{className:"text-gray-500 py-1",style:{fontSize:"0.75em"},children:"Nog geen eigen lagen aangemaakt."}):g.filter(J=>!J.archived).map(J=>m.jsx("div",{className:"flex items-center gap-2 py-1.5 px-2 hover:bg-gray-50 rounded",children:O===J.id?m.jsx("input",{type:"text",value:j,onChange:re=>Te(re.target.value),onKeyDown:re=>{re.key==="Enter"?(j.trim()&&y(J.id,{name:j.trim()}),U(null)):re.key==="Escape"&&U(null)},onBlur:()=>{j.trim()&&y(J.id,{name:j.trim()}),U(null)},autoFocus:!0,className:"flex-1 px-1.5 py-0.5 text-sm bg-orange-50 rounded outline-none focus:ring-1 focus:ring-orange-400"}):m.jsxs(m.Fragment,{children:[m.jsx("span",{className:"flex-1 text-sm text-gray-700 truncate",children:J.name}),m.jsxs("span",{className:"text-xs text-gray-400",children:[J.points.length," punten"]}),m.jsx("button",{onClick:()=>{U(J.id),Te(J.name)},className:"p-1 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none bg-transparent",title:"Naam bewerken",children:m.jsx(Ip,{size:12})})]})},J.id)),m.jsxs("button",{onClick:()=>{i(),e()},className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[m.jsx(Ab,{size:14}),m.jsx("span",{children:"Lagen beheren"})]})]})}),m.jsx(ko,{title:"Lagen importeren",icon:m.jsx(Dw,{size:16}),children:m.jsxs("div",{className:"space-y-1",children:[f.length>0&&m.jsxs(m.Fragment,{children:[f.map(J=>m.jsx(L9,{layer:J},J.id)),m.jsx("div",{className:"border-t border-gray-100 my-2"})]}),m.jsxs("button",{onClick:()=>z(!0),className:"flex items-center gap-2 px-2 py-1.5 text-cyan-600 hover:bg-cyan-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[m.jsx(co,{size:14}),m.jsx("span",{children:"Nieuwe laag importeren"})]}),m.jsx("p",{className:"text-gray-400 mt-1",style:{fontSize:"0.7em"},children:"GeoJSON, KML (Google My Maps), GPX"})]})}),m.jsx(ko,{title:"Presets",icon:m.jsx(io,{size:16}),children:m.jsxs("div",{className:"space-y-2",children:[a.map(J=>m.jsx("div",{className:"flex items-center justify-between py-1",children:P===J.id?m.jsxs("div",{className:"flex-1 flex items-center gap-1",children:[m.jsx("input",{type:"text",value:k,onChange:re=>L(re.target.value),onKeyDown:re=>{re.key==="Enter"&&Se(J.id),re.key==="Escape"&&se()},className:"flex-1 px-2 py-0.5 bg-blue-50 rounded border border-blue-300 outline-none",style:{fontSize:"0.9em"},autoFocus:!0}),m.jsx("button",{onClick:()=>Se(J.id),className:"px-2 py-0.5 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors border-0 outline-none",style:{fontSize:"0.7em"},children:"OK"}),m.jsx("button",{onClick:se,className:"px-2 py-0.5 bg-gray-200 text-gray-600 rounded hover:bg-gray-300 transition-colors border-0 outline-none",style:{fontSize:"0.7em"},children:""})]}):m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:"flex-1 min-w-0",children:[m.jsxs("span",{className:"text-gray-600",style:{fontSize:"0.9em"},children:[J.name,J.isBuiltIn&&m.jsx("span",{className:"ml-1 text-gray-400",style:{fontSize:"0.7em"},children:"(standaard)"})]}),m.jsxs("span",{className:"ml-1 text-gray-400",style:{fontSize:"0.7em"},children:["(",J.layers.length," lagen)"]})]}),!J.isBuiltIn&&m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx("button",{onClick:()=>ue(J.id,J.name),className:"p-1 text-blue-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",title:"Naam wijzigen",children:m.jsx(Ip,{size:14})}),m.jsx("button",{onClick:()=>l(J.id),className:"p-1 text-red-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors border-0 outline-none",title:"Verwijderen",children:m.jsx(_d,{size:14})})]})]})},J.id)),I?m.jsxs("div",{className:"flex gap-2 mt-2",children:[m.jsx("input",{type:"text",value:T,onChange:J=>b(J.target.value),placeholder:"Naam nieuwe preset",className:"flex-1 px-2 py-1 bg-gray-100 rounded border-0 outline-none",style:{fontSize:"0.9em"},onKeyDown:J=>J.key==="Enter"&&le(),autoFocus:!0}),m.jsx("button",{onClick:le,className:"px-2 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors border-0 outline-none",style:{fontSize:"0.75em"},children:"Opslaan"}),m.jsx("button",{onClick:()=>M(!1),className:"px-2 py-1 bg-gray-200 text-gray-600 rounded hover:bg-gray-300 transition-colors border-0 outline-none",style:{fontSize:"0.75em"},children:"Annuleren"})]}):m.jsxs("button",{onClick:()=>M(!0),className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[m.jsx(co,{size:14}),m.jsx("span",{children:"Huidige lagen als preset opslaan"})]})]})})]}),Ce==="vondsten"&&m.jsxs(m.Fragment,{children:[m.jsxs(ko,{title:"Vondsten",icon:m.jsx(Hl,{size:16}),isOwn:!0,children:[m.jsx(th,{label:"Vondsten knop tonen",checked:s.showVondstButton,onChange:s.setShowVondstButton}),m.jsx("p",{className:"text-gray-500 mt-1 py-1",style:{fontSize:"0.75em"},children:"Vondsten worden altijd lokaal op dit apparaat opgeslagen."}),m.jsxs("button",{onClick:r,className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[m.jsx(S9,{size:14}),m.jsxs("span",{children:["Dashboard (",h.length," vondsten)"]})]}),m.jsx(VEe,{})]}),m.jsxs(ko,{title:"Route opnemen",icon:m.jsx(k9,{size:16}),isOwn:!0,children:[m.jsx(th,{label:"Route knop tonen",checked:s.showRouteRecordButton,onChange:s.setShowRouteRecordButton}),m.jsx("p",{className:"text-gray-500 mt-1",style:{fontSize:"0.75em"},children:"Neem je route op tijdens het detecteren of wandelen. Routes worden lokaal opgeslagen en kunnen als GPX gexporteerd worden."})]})]})]}),m.jsxs("div",{className:"px-4 py-3 border-t border-gray-100 space-y-2",style:{fontSize:`${Ne}px`},children:[m.jsxs("a",{href:DEe,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 w-full px-3 py-2 text-orange-600 hover:bg-orange-50 rounded-lg transition-colors border-0 outline-none",style:{fontSize:"0.9em"},children:[m.jsx(E9,{size:16}),m.jsx("span",{children:"Meld een bug"})]}),m.jsxs("button",{onClick:xEe,className:"flex items-center justify-center gap-2 w-full px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none",style:{fontSize:"0.9em"},children:[m.jsx(ER,{size:16}),m.jsx("span",{children:"Uitloggen"})]}),m.jsx("p",{className:"text-gray-400 text-center",style:{fontSize:"0.75em"},children:"Instellingen worden lokaal opgeslagen"})]})]})]})}),m.jsx(vEe,{isOpen:t,onClose:r}),m.jsx(LEe,{isOpen:F,onClose:()=>z(!1)})]})}function ko({title:n,icon:e,children:t,isOwn:r}){return m.jsxs("section",{children:[m.jsxs("div",{className:"flex items-center gap-2 mb-2 pb-1 border-b border-gray-100",children:[m.jsx("span",{className:r?"text-orange-600":"text-blue-600",children:e}),m.jsx("span",{className:`font-medium ${r?"text-orange-600":"text-gray-800"}`,style:{fontSize:"1em"},children:n})]}),m.jsx("div",{className:"space-y-2",children:t})]})}function jEe({label:n,children:e}){return m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("span",{className:"text-gray-600",style:{fontSize:"0.9em"},children:n}),e]})}function th({label:n,checked:e,onChange:t}){return m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("span",{className:"text-gray-600",style:{fontSize:"0.9em"},children:n}),m.jsx("button",{onClick:()=>t(!e),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${e?"bg-gradient-to-r from-blue-500 to-blue-600":"bg-gray-300"}`,children:m.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${e?"left-[22px]":"left-0.5"}`})})]})}function VEe(){const[n,e]=ne.useState(!1),{vondsten:t,exportAsGeoJSON:r,exportAsCSV:i,exportAsExcel:s,exportAsGPX:a,exportAsKML:o}=Ko(),l=[{label:"Excel (.xlsx)",action:s,desc:"Spreadsheet"},{label:"CSV",action:i,desc:"Comma-separated"},{label:"GeoJSON",action:r,desc:"GIS software"},{label:"GPX",action:a,desc:"GPS apparaten"},{label:"KML",action:o,desc:"Google Earth"}],u=h=>{h(),e(!1)};return t.length===0?m.jsxs("div",{className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-gray-400 bg-gray-100 rounded w-full cursor-not-allowed",style:{fontSize:"0.9em"},children:[m.jsx(Sb,{size:14}),m.jsx("span",{children:"Geen vondsten om te exporteren"})]}):m.jsxs("div",{className:"relative mt-2",children:[m.jsxs("button",{onClick:()=>e(!n),className:"flex items-center justify-between gap-2 px-2 py-1.5 text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(Sb,{size:14}),m.jsxs("span",{children:["Exporteer vondsten (",t.length,")"]})]}),m.jsx("span",{style:{fontSize:"0.8em"},children:""})]}),n&&m.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg z-10 overflow-hidden",children:l.map((h,f)=>m.jsxs("button",{onClick:()=>u(h.action),className:"w-full px-3 py-2 text-left hover:bg-blue-50 transition-colors border-0 outline-none flex justify-between items-center",style:{fontSize:"0.9em"},children:[m.jsx("span",{className:"text-gray-700",children:h.label}),m.jsx("span",{className:"text-gray-400",style:{fontSize:"0.8em"},children:h.desc})]},f))})]})}const Av="2.27.7";function GEe({size:n=18}){return m.jsxs("svg",{viewBox:"0 0 24 24",width:n,height:n,children:[m.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),m.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),m.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),m.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]})}function BEe(){const[n,e]=ne.useState(!1),{user:t,loading:r,signInWithGoogle:i,logout:s}=Rw(),{toggleInfoPanel:a,toggleSettingsPanel:o}=jr(),l=Mr(T=>T.menuFontScale),u=Mr(T=>T.setMenuFontScale),h={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"},f=()=>e(!1),g=()=>{f(),a()},y=()=>{f(),o()},v=()=>{f(),i()},x=()=>{f(),s()},E=13*l/100;return m.jsxs(m.Fragment,{children:[m.jsx(Ct.button,{className:`fixed right-2 z-[800] w-11 h-11 flex items-center justify-center rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm ${n?"bg-blue-500 hover:bg-blue-600":"bg-white/90 hover:bg-white"}`,style:h,onClick:()=>e(!n),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Menu",children:n?m.jsx(Ni,{size:22,className:"text-white"}):m.jsx(qae,{size:22,className:"text-gray-600"})}),m.jsx(mr,{children:n&&m.jsxs(m.Fragment,{children:[m.jsx(Ct.div,{className:"fixed inset-0 z-[799]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:f}),m.jsxs(Ct.div,{initial:{opacity:0,y:-8,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-8,scale:.95},transition:{duration:.15},className:"fixed right-2 z-[801] w-64 bg-white rounded-xl shadow-lg overflow-hidden flex flex-col",style:{top:"calc(max(0.5rem, env(safe-area-inset-top, 0.5rem)) + 52px)",fontSize:`${E}px`},children:[m.jsxs("div",{className:"flex items-center justify-between gap-2 px-3 py-1.5 bg-blue-500",children:[m.jsx("span",{className:"font-medium text-white",style:{fontSize:`${E}px`},children:"Menu"}),m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx("span",{className:"text-[9px] text-blue-200",children:"T"}),m.jsx("input",{type:"range",min:"80",max:"130",step:"10",value:l,onInput:T=>u(parseInt(T.target.value)),onChange:T=>u(parseInt(T.target.value)),className:"w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${l}%`}),m.jsx("span",{className:"text-[11px] text-blue-200",children:"T"})]})]}),r?m.jsx("div",{className:"px-3 py-4 flex items-center justify-center",children:m.jsx("div",{className:"w-5 h-5 border-2 border-gray-300 border-t-blue-500 rounded-full animate-spin"})}):t?m.jsx("div",{className:"px-3 py-3 border-b border-gray-100",children:m.jsxs("div",{className:"flex items-center gap-3",children:[t.photoURL?m.jsx("img",{src:t.photoURL,alt:t.displayName||"User",className:"w-8 h-8 rounded-full",referrerPolicy:"no-referrer"}):m.jsx("div",{className:"w-8 h-8 rounded-full bg-green-500 flex items-center justify-center",children:m.jsx(bR,{size:16,className:"text-white"})}),m.jsxs("div",{className:"flex-1 min-w-0",children:[m.jsx("div",{className:"font-medium text-gray-800 truncate",style:{fontSize:"0.85em"},children:t.displayName||"Gebruiker"}),m.jsx("div",{className:"text-green-600",style:{fontSize:"0.7em"},children:"Cloud sync actief"})]}),m.jsx("button",{onClick:x,className:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none bg-transparent",title:"Uitloggen",children:m.jsx(ER,{size:16})})]})}):m.jsxs("button",{onClick:v,className:"w-full px-3 py-3 flex items-center gap-3 hover:bg-blue-50 transition-colors border-0 outline-none bg-transparent",children:[m.jsx(GEe,{size:18}),m.jsx("span",{className:"text-gray-700",style:{fontSize:"0.9em"},children:"Inloggen met Google"})]}),m.jsx("div",{className:"py-1",children:m.jsxs("button",{onClick:g,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-blue-50",style:{fontSize:"0.95em"},children:[m.jsx(C9,{size:18,className:"text-blue-500"}),m.jsx("span",{children:"Info & handleiding"})]})}),m.jsx("div",{className:"mt-auto border-t border-gray-100",children:m.jsxs("button",{onClick:y,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-gray-50",style:{fontSize:"0.95em"},children:[m.jsx(Ab,{size:18,className:"text-gray-500"}),m.jsx("span",{children:"Instellingen"})]})}),m.jsxs("div",{className:"px-3 py-1.5 bg-gray-50 text-center text-gray-400",style:{fontSize:"0.65em"},children:["DetectorApp NL v",Av]})]})]})})]})}const UEe="https://forms.gle/R5LCk11Bzu5XrkBj8";function zEe(){const{infoPanelOpen:n,toggleInfoPanel:e}=jr(),[t,r]=ne.useState("info"),i=[{id:"info",label:"Info",icon:m.jsx(C9,{size:14})},{id:"functies",label:"Functies",icon:m.jsx(R9,{size:14})},{id:"handleiding",label:"Handleiding",icon:m.jsx(Yse,{size:14})}];return m.jsx(mr,{children:n&&m.jsxs(m.Fragment,{children:[m.jsx(Ct.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),m.jsxs(Ct.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[m.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-blue-500",children:[m.jsxs("span",{className:"font-medium text-white",children:["DetectorApp NL v",Av]}),m.jsx("button",{onClick:e,className:"p-1 rounded bg-blue-400/50 hover:bg-blue-400 transition-colors border-0 outline-none",children:m.jsx(Ni,{size:18,className:"text-white",strokeWidth:2.5})})]}),m.jsx("div",{className:"flex border-b border-gray-200",children:i.map(s=>m.jsxs("button",{onClick:()=>r(s.id),className:`flex-1 flex items-center justify-center gap-1.5 px-3 py-2.5 text-sm font-medium transition-colors border-0 outline-none ${t===s.id?"text-blue-600 border-b-2 border-blue-600 bg-blue-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[s.icon,s.label]},s.id))}),m.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 text-sm",children:[t==="info"&&m.jsx($Ee,{}),t==="functies"&&m.jsx(WEe,{}),t==="handleiding"&&m.jsx(HEe,{}),m.jsxs("section",{className:"pt-2 border-t border-gray-200 space-y-2",children:[m.jsxs("a",{href:UEe,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 w-full px-3 py-2 text-orange-600 hover:bg-orange-50 rounded-lg transition-colors",children:[m.jsx(E9,{size:14}),m.jsx("span",{className:"text-sm",children:"Meld een bug of geef feedback"})]}),m.jsxs("p",{className:"text-xs text-gray-400 text-center",children:["DetectorApp NL v",Av," - Gratis en zonder tracking"]})]})]})]})]})})}function $Ee(){return m.jsxs(m.Fragment,{children:[m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Over deze app"}),m.jsx("p",{className:"text-gray-600",children:"DetectorApp NL is d gratis kaartapplicatie voor metaaldetectie, fossielen zoeken en archeologische verkenning in Nederland. Met 70+ kaartlagen, GPS tracking met richtingspijl, eigen lagen, cloud sync en uitgebreid vondstenbeheer."})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Databronnen & Licenties"}),m.jsxs("ul",{className:"space-y-2 text-gray-600",children:[m.jsxs("li",{children:[m.jsx("strong",{children:"RCE / Cultureelerfgoed.nl"})," (CC0/CC-BY)",m.jsx("br",{}),m.jsx("span",{className:"text-xs",children:"AMK Monumenten, Rijksmonumenten, Werelderfgoed, Paleokaarten, Religieus Erfgoed, Essen, Archeo Onderzoeken"})]}),m.jsxs("li",{children:[m.jsx("strong",{children:"PDOK / Kadaster"})," (CC0/CC-BY)",m.jsx("br",{}),m.jsx("span",{className:"text-xs",children:"Luchtfoto, AHN Hoogtekaarten, IKAW, Bodemkaart, Geomorfologie, Kadastrale Grenzen, Gewaspercelen"})]}),m.jsxs("li",{children:[m.jsx("strong",{children:"OpenStreetMap"})," (ODbL)",m.jsx("br",{}),m.jsx("span",{className:"text-xs",children:"Hunebedden, Grafheuvels, Bunkers, Kastelen, Terpen, Parken, Kringloopwinkels, Musea, Speeltuinen, Strandjes"})]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Itiner-E / Wetenschappelijk"})," (CC BY 4.0)",m.jsx("br",{}),m.jsx("span",{className:"text-xs",children:"Romeinse wegen - Brughmans, Paout, de Soto & Bjerregaard Vahlstrup"})]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Mindat.org"}),m.jsx("br",{}),m.jsx("span",{className:"text-xs",children:"Mineralen hotspots en vindplaatsen"})]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Paleontica / Fossielen data"}),m.jsx("br",{}),m.jsx("span",{className:"text-xs",children:"Fossiel hotspots en vindplaatsen"})]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Map5.nl / Kadaster"}),m.jsx("br",{}),m.jsx("span",{className:"text-xs",children:"Historische kaarten (TMK 1850, Bonnebladen 1900)"})]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Provinciale data"}),m.jsx("br",{}),m.jsx("span",{className:"text-xs",children:"Relictenkaart (Gelderland), Scheepswrakken (Zuid-Holland), Verdronken Dorpen (Zeeland)"})]}),m.jsxs("li",{children:[m.jsx("strong",{children:"UIKAV / Rijkswaterstaat"}),m.jsx("br",{}),m.jsx("span",{className:"text-xs",children:"Uiterwaarden archeologische data, Expert advies, Bufferlagen"})]})]})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Privacy & Opslag"}),m.jsxs("div",{className:"text-gray-600 space-y-2",children:[m.jsxs("p",{children:[m.jsx("strong",{children:"Locatiegegevens:"})," Alleen voor navigatie, niet opgeslagen of gedeeld."]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Geen tracking:"})," Geen analytics, cookies of gebruiksstatistieken."]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Lokale opslag:"})," Standaard blijft alle data op je apparaat."]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Google sync (optioneel):"})," Met Google login worden lagen en vondsten veilig gesynchroniseerd. Alleen jij hebt toegang."]})]})]})]})}function WEe(){return m.jsxs(m.Fragment,{children:[m.jsxs("section",{children:[m.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[m.jsx(SR,{size:16,className:"text-blue-600"}),"Kaartlagen (70+)"]}),m.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[m.jsxs("li",{children:[m.jsx("strong",{children:"Basis:"})," CartoDB, OpenStreetMap, PDOK Luchtfoto"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Historisch:"})," TMK 1850, Bonnebladen 1900"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Hoogtekaarten:"})," AHN4 Hillshade, Multi-Hillshade, Hoogtekaart Kleur, AHN 0.5m"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Archeologie:"})," AMK Monumenten (per periode), Archeo Onderzoeken, IKAW, Essen"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Romeins:"})," Romeinse wegen, Romeinse Forten met historische info, Limesweg"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Prehistorie:"})," Hunebedden, Grafheuvels, Terpen, Paleokaarten (7 periodes)"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Militair:"})," WWII Bunkers, Slagvelden, Vliegvelden, Verdedigingslinies"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Erfgoed:"})," Rijksmonumenten, Kastelen, Runes, Religieus Erfgoed"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Terrein:"})," Veengebieden, Geomorfologie, Bodemkaart"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Percelen:"})," Gewaspercelen (met bouwplantoelichting), Kadastrale Grenzen"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Recreatie:"})," Parken, Musea, Kringloopwinkels, Strandjes, Wandelroutes"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Provinciaal:"})," Relictenkaart, Scheepswrakken, Verdronken Dorpen"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"UIKAV:"})," Uiterwaard data, Expert advies, Vlakken, Punten, Bufferlagen"]})]})]}),m.jsxs("section",{children:[m.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[m.jsx(Nae,{size:16,className:"text-purple-600"}),"Mineralen & Fossielen"]}),m.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[m.jsxs("li",{children:[m.jsx("strong",{children:"Mineralen hotspots:"})," Vindplaatsen uit Mindat.org met mineralenlijst"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Goudrivieren:"})," Bekende locaties voor goud zoeken"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Fossiel hotspots:"})," Vindplaatsen met fossieltypen en periodes"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Premium lagen:"})," Gedetailleerde data (beschikbaar met account)"]})]})]}),m.jsxs("section",{children:[m.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[m.jsx(Aae,{size:16,className:"text-orange-600"}),"Mijn Lagen"]}),m.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[m.jsxs("li",{children:[m.jsx("strong",{children:"Eigen lagen:"})," Maak lagen voor vakantie, projecten, etc."]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Toevoegen:"})," Tik op + in popup om monument/locatie aan laag toe te voegen"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Polygonen:"})," Hele monumentgebieden worden opgeslagen, niet alleen een punt"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Originele info:"})," Popup content blijft behouden"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Kleuren:"})," Elke laag krijgt eigen kleur (aanpasbaar)"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Import:"})," Laad GeoJSON, KML of GPX bestanden"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Export:"})," Exporteer lagen als GeoJSON"]})]})]}),m.jsxs("section",{children:[m.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[m.jsx(wb,{size:16,className:"text-green-600"}),"Google Cloud Sync"]}),m.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[m.jsxs("li",{children:[m.jsx("strong",{children:"Inloggen:"})," Via hamburger menu rechtsboven"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Synchronisatie:"})," Lagen en vondsten automatisch naar cloud"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Meerdere apparaten:"})," Altijd toegang tot je data"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Veilig:"})," Alleen jij hebt toegang tot je gegevens"]})]})]}),m.jsxs("section",{children:[m.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[m.jsx(TR,{size:16,className:"text-green-600"}),"GPS & Navigatie"]}),m.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[m.jsx("li",{children:"Live GPS tracking met nauwkeurigheidscirkel"}),m.jsx("li",{children:"Richtingspijl draait mee met je telefoon"}),m.jsx("li",{children:"Kaart handmatig draaien + kompasknop naar noorden"}),m.jsx("li",{children:"Schaalbalk onderaan (aan/uit in Instellingen)"}),m.jsx("li",{children:"Open locatie in Google Maps vanuit popup"}),m.jsx("li",{children:"Zoekbalk voor adressen en plaatsen"})]})]}),m.jsxs("section",{children:[m.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[m.jsx(Hl,{size:16,className:"text-orange-600"}),"Vondsten"]}),m.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[m.jsx("li",{children:"Toevoegen via GPS locatie, long-press of handmatig"}),m.jsx("li",{children:"Velden: type, materiaal, periode, diepte, conditie, gewicht"}),m.jsx("li",{children:"Foto's toevoegen (link of upload)"}),m.jsx("li",{children:"Export: Excel, CSV, GeoJSON, GPX, KML"}),m.jsx("li",{children:"Dashboard met statistieken"}),m.jsx("li",{children:"Cloud sync met Google account"})]})]}),m.jsxs("section",{children:[m.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[m.jsx(io,{size:16,className:"text-purple-600"}),"Presets"]}),m.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[m.jsxs("li",{children:[m.jsx("strong",{children:"Standaard:"})," Detectie, Steentijd, Romeins, Middeleeuwen, WOII, Analyse, Fossielen, Mineralen"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Aanpasbaar:"})," Overschrijf preset met huidige lagen (diskette-icoon)"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Eigen presets:"})," Maak nieuwe via Instellingen"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Tekstgrootte:"})," Aanpasbaar per panel via slider"]})]})]}),m.jsxs("section",{children:[m.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[m.jsx(toe,{size:16,className:"text-cyan-600"}),"Perceelinformatie"]}),m.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[m.jsx("li",{children:"Kadastrale aanduiding (gemeente, sectie, nummer)"}),m.jsx("li",{children:"Oppervlakte in m en hectare"}),m.jsx("li",{children:"Gewas en bouwplan met uitleg"}),m.jsx("li",{children:"Bodemtype met beschrijving"}),m.jsx("li",{children:"AHN hoogte in meters NAP"}),m.jsx("li",{children:"Hoogtekaart per perceel (bergje-icoon)"}),m.jsx("li",{children:"Link naar eigenaar opzoeken (Kadaster)"})]})]}),m.jsxs("section",{children:[m.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[m.jsx(Ioe,{size:16,className:"text-red-600"}),"Monumenten & Erfgoed"]}),m.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[m.jsxs("li",{children:[m.jsx("strong",{children:"AMK:"})," Archeologische Monumenten per periode"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Romeinse Forten:"})," Uitgebreide historische info per fort"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Rijksmonumenten:"})," Met bescherming en historie"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Verdedigingswerken:"})," Linies, forten, schansen"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Popup info:"})," Directe uitleg over archeologische waarde"]})]})]})]})}function HEe(){return m.jsxs(m.Fragment,{children:[m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Eerste stappen"}),m.jsxs("ol",{className:"text-gray-600 space-y-2 text-xs list-decimal list-inside",children:[m.jsxs("li",{children:["Tik op de ",m.jsx("strong",{children:"GPS knop"})," (rechtsonder, oranje) om je locatie te zien"]}),m.jsxs("li",{children:["Kies een ",m.jsx("strong",{children:"preset"})," (linksonder, laagjes-icoon) voor een snelle start"]}),m.jsxs("li",{children:["Of open ",m.jsx("strong",{children:"Kaartlagen"})," om individuele lagen aan te zetten"]}),m.jsx("li",{children:"Tik op objecten op de kaart voor gedetailleerde informatie"})]})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Hamburger Menu"}),m.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[m.jsx("p",{children:"Rechtsboven vind je het menu met:"}),m.jsxs("ul",{className:"list-disc list-inside ml-2 space-y-1",children:[m.jsxs("li",{children:[m.jsx("strong",{children:"Google Login:"})," Synchroniseer je data naar de cloud"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Vondst toevoegen:"})," Registreer een nieuwe vondst"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Info & Handleiding:"})," Dit scherm"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Instellingen:"})," Presets, export, weergave"]})]})]})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"GPS & Navigatie"}),m.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[m.jsxs("p",{children:[m.jsx("strong",{children:"GPS knop (oranje):"})," Aan/uit toggle voor locatie tracking."]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Richtingspijl:"})," Blauwe pijl toont de richting van je telefoon."]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Kaart draaien:"})," Met twee vingers of via kompas."]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Kompasknop:"})," Verschijnt rechtsboven als kaart gedraaid is. Tik om naar noorden te draaien."]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Google Maps:"})," Vanuit elke popup kun je direct navigeren."]})]})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Locaties opslaan in Mijn Lagen"}),m.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[m.jsxs("p",{children:[m.jsx("strong",{children:"Stap 1:"})," Tik op een object op de kaart (monument, bunker, etc.)"]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Stap 2:"})," Tik op de ",m.jsx("strong",{children:"oranje +"})," knop in de popup header"]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Stap 3:"})," Kies een bestaande laag of maak een nieuwe aan"]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Resultaat:"})," De locatie inclusief vorm (polygoon) en info wordt opgeslagen!"]}),m.jsx("p",{className:"text-gray-500 italic",children:"Tip: Maak lagen voor vakantiebestemmingen, projecten of interessante locaties."})]})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Vondst registreren"}),m.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[m.jsxs("p",{children:[m.jsx("strong",{children:"Via GPS:"})," Open menu  Vondst toevoegen. Je locatie wordt automatisch ingevuld."]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Via long-press:"}),' Houd je vinger op de kaart  kies "Vondst toevoegen".']}),m.jsxs("p",{children:[m.jsx("strong",{children:"Handmatig:"}),' In het formulier  "Kies op kaart" voor exacte locatie.']}),m.jsxs("p",{children:[m.jsx("strong",{children:"Foto's:"})," Voeg foto-links toe of upload direct."]})]})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Presets gebruiken"}),m.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[m.jsxs("p",{children:[m.jsx("strong",{children:"Toepassen:"})," Linksonder  preset kiezen."]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Aanpassen:"})," Zet gewenste lagen aan  tik diskette-icoon naast preset."]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Nieuw maken:"}),' Instellingen  Presets  "Huidige lagen opslaan".']})]})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Cloud Sync instellen"}),m.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[m.jsxs("p",{children:[m.jsx("strong",{children:"Stap 1:"})," Open hamburger menu rechtsboven"]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Stap 2:"}),' Tik op "Inloggen met Google"']}),m.jsxs("p",{children:[m.jsx("strong",{children:"Stap 3:"})," Kies je Google account"]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Klaar!"})," Je lagen en vondsten worden automatisch gesynchroniseerd."]}),m.jsx("p",{className:"text-gray-500 italic",children:"Je data is veilig en alleen voor jou toegankelijk."})]})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Lagen importeren"}),m.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[m.jsxs("p",{children:[m.jsx("strong",{children:"Stap 1:"})," Ga naar Instellingen (hamburger menu)"]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Stap 2:"}),' Scroll naar "Lagen importeren"']}),m.jsxs("p",{children:[m.jsx("strong",{children:"Stap 3:"})," Kies een GeoJSON, KML of GPX bestand"]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Resultaat:"})," Nieuwe laag met je geimporteerde data!"]}),m.jsx("p",{className:"text-gray-500 italic",children:"Handig voor routes, waypoints of eigen datasets."})]})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Tips voor detectie"}),m.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs list-disc list-inside",children:[m.jsxs("li",{children:["Gebruik ",m.jsx("strong",{children:"AHN Hillshade"})," om relif te zien (grafheuvels, wallen)"]}),m.jsxs("li",{children:["Combineer ",m.jsx("strong",{children:"AMK"})," met ",m.jsx("strong",{children:"Gewaspercelen"})," voor slimme zoeklocaties"]}),m.jsxs("li",{children:["Check ",m.jsx("strong",{children:"IKAW"})," voor archeologische verwachting"]}),m.jsxs("li",{children:["Gebruik ",m.jsx("strong",{children:"historische kaarten"})," (TMK 1850) om oude structuren te vinden"]}),m.jsxs("li",{children:["Bekijk ",m.jsx("strong",{children:"Archeo Onderzoeken"})," voor eerdere vondsten in het gebied"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Bodemkaart"})," toont of grond geschikt is (popup legt uit)"]})]})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Tips voor fossielen"}),m.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs list-disc list-inside",children:[m.jsxs("li",{children:["Zet ",m.jsx("strong",{children:"Fossiel hotspots"})," aan voor bekende vindplaatsen"]}),m.jsxs("li",{children:["Bekijk ",m.jsx("strong",{children:"Paleokaarten"})," voor historische kustlijnen"]}),m.jsxs("li",{children:["Check ",m.jsx("strong",{children:"Geomorfologie"})," voor oude zeebodems en rivieren"]}),m.jsx("li",{children:"Popup toont welke fossielen op elke locatie gevonden zijn"})]})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Tips voor mineralen"}),m.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs list-disc list-inside",children:[m.jsxs("li",{children:["Zet ",m.jsx("strong",{children:"Mineralen hotspots"})," aan voor vindplaatsen"]}),m.jsxs("li",{children:["Bekijk ",m.jsx("strong",{children:"Goudrivieren"})," voor goudzoekmogelijkheden"]}),m.jsx("li",{children:"Popup toont welke mineralen op elke locatie voorkomen"}),m.jsx("li",{children:"Links naar Mindat.org voor gedetailleerde info"})]})]}),m.jsxs("section",{children:[m.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[m.jsx(S1,{size:16,className:"text-blue-600"}),"Handige links"]}),m.jsxs("ul",{className:"text-gray-600 space-y-2 text-xs",children:[m.jsxs("li",{children:[m.jsx("a",{href:"https://legendageomorfologie.wur.nl/",target:"_blank",rel:"noopener",className:"text-blue-600 hover:underline font-medium",children:"Geomorfologie legenda (WUR)"}),m.jsx("br",{}),m.jsx("span",{className:"text-gray-500",children:"Uitgebreide uitleg over landvormen"})]}),m.jsxs("li",{children:[m.jsx("a",{href:"https://legenda-bodemkaart.bodemdata.nl/",target:"_blank",rel:"noopener",className:"text-blue-600 hover:underline font-medium",children:"Bodemkaart legenda (BRO)"}),m.jsx("br",{}),m.jsx("span",{className:"text-gray-500",children:"Volledige bodemclassificatie"})]}),m.jsxs("li",{children:[m.jsx("a",{href:"https://www.mindat.org/",target:"_blank",rel:"noopener",className:"text-blue-600 hover:underline font-medium",children:"Mindat.org - Mineralen database"}),m.jsx("br",{}),m.jsx("span",{className:"text-gray-500",children:"Wereldwijde mineralen informatie"})]}),m.jsxs("li",{children:[m.jsx("a",{href:"https://www.cultureelerfgoed.nl/",target:"_blank",rel:"noopener",className:"text-blue-600 hover:underline font-medium",children:"Rijksdienst voor Cultureel Erfgoed"}),m.jsx("br",{}),m.jsx("span",{className:"text-gray-500",children:"Officile monumenten informatie"})]})]})]})]})}function XS({label:n,value:e,onChange:t,options:r,required:i=!1,placeholder:s="Typ hier..."}){const[a,o]=ne.useState(!1),[l,u]=ne.useState(!1),[h,f]=ne.useState(""),g=e&&!r.includes(e),y=()=>{u(!0),f(g?e:""),o(!1)},v=()=>{h.trim()&&t(h.trim()),u(!1)};return l?m.jsxs("div",{children:[m.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:[n,i&&m.jsx("span",{className:"text-orange-500 ml-0.5",children:"*"})]}),m.jsx("input",{type:"text",value:h,onChange:x=>f(x.target.value),onKeyDown:x=>{x.key==="Enter"&&(x.preventDefault(),v()),x.key==="Escape"&&u(!1)},onBlur:v,placeholder:s,autoFocus:!0,className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all",style:{border:"none",outline:"none"}})]}):m.jsxs("div",{className:"relative",children:[m.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:[n,i&&m.jsx("span",{className:"text-orange-500 ml-0.5",children:"*"})]}),m.jsxs("button",{type:"button",onClick:()=>o(!a),className:"w-full flex items-center justify-between px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors text-left",style:{border:"none",outline:"none"},children:[m.jsxs("span",{className:e?"":"text-gray-400",children:[e||"Selecteer...",g&&m.jsx(yL,{size:12,className:"inline ml-1 text-orange-500"})]}),m.jsx(vR,{size:16,className:`text-gray-400 transition-transform ${a?"rotate-180":""}`})]}),a&&m.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-white rounded-lg shadow-lg max-h-48 overflow-y-auto",children:[m.jsxs("button",{type:"button",onClick:y,className:"w-full px-3 py-2 text-left text-sm text-orange-600 hover:bg-orange-50 transition-colors flex items-center gap-2",style:{border:"none",outline:"none"},children:[m.jsx(yL,{size:12}),"Eigen invoer..."]}),m.jsx("div",{className:"border-t border-gray-100"}),r.map(x=>m.jsx("button",{type:"button",onClick:()=>{t(x),o(!1)},className:`w-full px-3 py-2 text-left text-sm transition-colors ${x===e?"bg-orange-50 text-orange-600":"text-gray-600 hover:bg-gray-50"}`,style:{border:"none",outline:"none"},children:x},x))]})]})}function _G({onClose:n,initialLocation:e}){const t=ss(q=>q.position),r=Ji(q=>q.map),i=jr(q=>q.vondstFormPhoto),s=Xi(q=>q.layers),a=Xi(q=>q.addPoint),[o,l]=ne.useState(""),[u,h]=ne.useState(""),[f,g]=ne.useState(""),[y,v]=ne.useState(""),[x,E]=ne.useState(!1),[T,b]=ne.useState(void 0),[I,M]=ne.useState(void 0),[F,z]=ne.useState(Ka),[P,C]=ne.useState(i),[k,L]=ne.useState(null);ne.useEffect(()=>{if(P){const q=URL.createObjectURL(P);return L(q),()=>URL.revokeObjectURL(q)}else L(null)},[P]);const[O,U]=ne.useState(e?"map-pick":t?"gps":"map-center"),[j,Te]=ne.useState(e||null),[Ce,Ue]=ne.useState(!1),Ne=()=>{if(O==="gps"&&t)return{lat:t.lat,lng:t.lng};if(O==="map-pick"&&j)return j;if(r){const q=r.getView().getCenter();if(q){const[he,Me]=xn(q);return{lat:Me,lng:he}}}return null},le=Ne();ne.useEffect(()=>{if(!Ce||!r)return;const q=he=>{const[Me,je]=xn(he.coordinate);Te({lat:je,lng:Me}),U("map-pick"),Ue(!1)};return r.on("click",q),()=>r.un("click",q)},[Ce,r]);const ue=()=>Ue(!0),Se=()=>{t&&(U("gps"),Te(null))},se=()=>{const q=document.createElement("input");q.type="file",q.accept="image/*",q.capture="environment",q.onchange=he=>{const Me=he.target.files?.[0];Me&&C(Me)},q.click()},V=()=>C(null),J=async q=>{q.preventDefault();const he=Ne();if(!he){alert("Geen locatie beschikbaar");return}if(!u){alert("Vul een naam/type in");return}E(!0);try{let Me=o||"";if(F===Ka){const De=[];f&&De.push(`Materiaal: ${f}`),y&&De.push(`Periode: ${y}`),T&&De.push(`Gewicht: ${T}g`),I&&De.push(`Lengte: ${I}mm`),De.length>0&&(Me=De.join(" | ")+(o?` | ${o}`:""))}a(F,{coordinates:[he.lng,he.lat],name:u,category:F===Ka?u:"Overig",notes:Me||""});const je=s.find(De=>De.id===F)?.name||"Vondsten";alert(`Toegevoegd aan ${je}! `),n()}catch(Me){alert("Fout bij opslaan: "+Me.message)}finally{E(!1)}},re=ne.useMemo(()=>s.map(q=>({id:q.id,name:q.name,color:q.color})),[s]);return Ce?m.jsx(Ct.div,{className:"fixed bottom-0 left-0 right-0 z-[2000] p-4",initial:{y:100},animate:{y:0},exit:{y:100},children:m.jsxs("div",{className:"bg-orange-500 text-white rounded-xl shadow-xl p-4 flex items-center justify-between max-w-md mx-auto",children:[m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx(Eb,{size:24,className:"animate-pulse"}),m.jsxs("div",{children:[m.jsx("div",{className:"font-medium",children:"Tik op de kaart"}),m.jsx("div",{className:"text-sm opacity-90",children:"om locatie te kiezen"})]})]}),m.jsx("button",{onClick:()=>Ue(!1),className:"px-4 py-2 bg-white/20 hover:bg-white/30 rounded-lg transition-colors border-0 outline-none",children:"Annuleren"})]})}):m.jsx(Ct.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:m.jsxs(Ct.div,{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full max-h-[90vh] overflow-hidden flex flex-col",initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},children:[m.jsxs("div",{className:"bg-gradient-to-r from-orange-500 to-orange-600 text-white px-5 py-4 flex justify-between items-center flex-shrink-0",children:[m.jsx("h2",{className:"text-lg font-semibold",children:"Nieuwe Vondst"}),m.jsx("button",{onClick:n,className:"w-8 h-8 flex items-center justify-center rounded-full hover:bg-white/20 transition-colors border-0 outline-none",children:m.jsx(Ni,{size:20})})]}),m.jsxs("form",{onSubmit:J,className:"flex-1 overflow-y-auto",children:[m.jsxs("div",{className:"p-5 space-y-4",children:[m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Foto"}),k?m.jsxs("div",{className:"relative",children:[m.jsx("img",{src:k,alt:"Vondst",className:"w-full h-40 object-cover rounded-xl"}),m.jsx("button",{type:"button",onClick:V,className:"absolute top-2 right-2 w-8 h-8 bg-red-500 text-white rounded-full flex items-center justify-center hover:bg-red-600 transition-colors border-0 outline-none shadow-lg",children:m.jsx(_d,{size:16})})]}):m.jsxs("button",{type:"button",onClick:se,className:"w-full h-32 bg-gray-50 rounded-xl flex flex-col items-center justify-center gap-2 hover:bg-gray-100 transition-colors text-gray-500 border-2 border-dashed border-gray-200",style:{outline:"none"},children:[m.jsx(xR,{size:32}),m.jsx("span",{className:"text-sm",children:"Maak een foto"})]})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Locatie"}),le&&m.jsxs("div",{className:"bg-orange-50 rounded-xl px-4 py-3 mb-2",children:[m.jsxs("div",{className:"text-sm text-orange-800 font-mono",children:[le.lat.toFixed(6),"N, ",le.lng.toFixed(6),"E"]}),m.jsx("div",{className:"text-xs text-orange-600 mt-1",children:O==="gps"?" GPS locatie":O==="map-pick"?" Gekozen op kaart":" Kaart midden"})]}),!le&&m.jsx("div",{className:"bg-red-50 rounded-xl px-4 py-3 mb-2",children:m.jsx("div",{className:"text-sm text-red-600",children:"Geen locatie beschikbaar"})}),m.jsxs("div",{className:"flex gap-2",children:[t&&O!=="gps"&&m.jsxs("button",{type:"button",onClick:Se,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-sm bg-green-50 text-green-700 rounded-lg hover:bg-green-100 transition-colors border-0 outline-none",children:[m.jsx(TR,{size:16}),"GPS"]}),m.jsxs("button",{type:"button",onClick:ue,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-sm bg-blue-50 text-blue-700 rounded-lg hover:bg-blue-100 transition-colors border-0 outline-none",children:[m.jsx(Eb,{size:16}),"Kies op kaart"]})]})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Opslaan naar"}),m.jsx("div",{className:"flex flex-wrap gap-2",children:re.map(q=>m.jsx("button",{type:"button",onClick:()=>z(q.id),className:`px-3 py-2 rounded-lg text-sm font-medium transition-all border-0 outline-none ${F===q.id?"bg-gray-800 text-white shadow-md":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:q.name},q.id))})]}),F===Ka&&m.jsx(XS,{label:"Type vondst",value:u,onChange:h,options:["Munt","Aardewerk","Gesp","Fibula","Ring","Speld","Sieraad","Gereedschap","Wapen","Anders"],required:!0,placeholder:"Typ type vondst..."}),F!==Ka&&m.jsxs("div",{children:[m.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:["Naam",m.jsx("span",{className:"text-orange-500 ml-0.5",children:"*"})]}),m.jsx("input",{type:"text",value:u,onChange:q=>h(q.target.value),placeholder:"Naam van het punt...",className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all",style:{border:"none",outline:"none"}})]}),F===Ka&&m.jsxs(m.Fragment,{children:[m.jsx(XS,{label:"Materiaal",value:f,onChange:g,options:["Brons","IJzer","Zilver","Goud","Koper","Lood","Tin","Keramiek","Steen","Glas","Bot","Hout","Leer","Onbekend"],placeholder:"Typ materiaal..."}),m.jsx(XS,{label:"Periode",value:y,onChange:v,options:["Steentijd","Bronstijd","IJzertijd","Romeins","Middeleeuws","Nieuwetijd","Modern","Onbekend"],placeholder:"Typ periode..."}),m.jsxs("div",{className:"flex gap-3",children:[m.jsxs("div",{className:"flex-1",children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Gewicht (g)"}),m.jsx("input",{type:"number",value:T??"",onChange:q=>b(q.target.value?parseFloat(q.target.value):void 0),className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all",style:{border:"none",outline:"none"},min:"0",step:"0.1"})]}),m.jsxs("div",{className:"flex-1",children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Lengte (mm)"}),m.jsx("input",{type:"number",value:I??"",onChange:q=>M(q.target.value?parseFloat(q.target.value):void 0),className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all",style:{border:"none",outline:"none"},min:"0",step:"0.1"})]})]})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Notities"}),m.jsx("textarea",{value:o,onChange:q=>l(q.target.value),className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all resize-none h-20",style:{border:"none",outline:"none"},placeholder:"Beschrijving, context, vindplaats details..."})]}),m.jsx("div",{className:"rounded-xl px-4 py-3 bg-orange-50",children:m.jsx("p",{className:"text-sm text-orange-700",children:' Opgeslagen in "Mijn Lagen" op dit apparaat'})})]}),m.jsxs("div",{className:"p-5 pt-0 flex gap-3",children:[m.jsx("button",{type:"button",onClick:n,className:"flex-1 px-4 py-3 bg-gray-100 text-gray-700 rounded-xl hover:bg-gray-200 transition-colors font-medium border-0 outline-none",children:"Annuleren"}),m.jsx("button",{type:"submit",disabled:x||!le||Ce||!u,className:"flex-1 px-4 py-3 bg-orange-500 text-white rounded-xl hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium border-0 outline-none",children:x?"Opslaan...":"Opslaan"})]})]})]})})}function KEe(){const{user:n,setUser:e,setLoading:t}=Rw();return ne.useEffect(()=>{const s=u6(Qf,a=>{e(a),t(!1)});return()=>s()},[e,t]),{user:n,loginAnonymous:async()=>{try{await EX(Qf)}catch(s){console.error("Login failed:",s)}},logout:async()=>{try{await h6(Qf)}catch(s){console.error("Logout failed:",s)}},isAuthenticated:!!n}}function YEe(){const{isAuthenticated:n,loginAnonymous:e}=KEe(),t=Mr(u=>u.vondstenLocalOnly),r=Mr(u=>u.showVondstButton),i=jr(u=>u.vondstFormOpen),s=jr(u=>u.vondstFormLocation),a=jr(u=>u.openVondstForm),o=jr(u=>u.closeVondstForm);if(!r)return null;const l=()=>{if(t){a();return}if(!n){confirm("Je moet ingelogd zijn om vondsten in de cloud op te slaan. Anoniem inloggen?")&&e();return}a()};return m.jsxs(m.Fragment,{children:[m.jsx(Ct.button,{className:"fixed bottom-2 right-[60px] z-[1000] w-11 h-11 bg-orange-500 hover:bg-orange-600 text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},onClick:l,title:"Vondst toevoegen",children:m.jsx(Hl,{size:22,strokeWidth:2})}),m.jsx(mr,{children:i&&m.jsx(_G,{onClose:o,initialLocation:s||void 0})})]})}function xG(n,e,t,r){const s=(r-e)*Math.PI/180,a=(t-n)*Math.PI/180,o=Math.sin(s/2)*Math.sin(s/2)+Math.cos(e*Math.PI/180)*Math.cos(r*Math.PI/180)*Math.sin(a/2)*Math.sin(a/2);return 6371e3*(2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o)))}function OO(n){let e=0;for(let t=1;t<n.length;t++)e+=xG(n[t-1].coordinates[0],n[t-1].coordinates[1],n[t].coordinates[0],n[t].coordinates[1]);return e}const vG=sa()(pd((n,e)=>({state:"idle",currentPoints:[],startTime:null,pauseStartTime:null,totalPausedTime:0,savedRoutes:[],startRecording:()=>{n({state:"recording",currentPoints:[],startTime:Date.now(),pauseStartTime:null,totalPausedTime:0})},pauseRecording:()=>{const{state:t}=e();t==="recording"&&n({state:"paused",pauseStartTime:Date.now()})},resumeRecording:()=>{const{state:t,pauseStartTime:r,totalPausedTime:i}=e();if(t!=="paused"||!r)return;const s=Date.now()-r;n({state:"recording",pauseStartTime:null,totalPausedTime:i+s})},stopRecording:t=>{const{state:r,currentPoints:i,startTime:s,totalPausedTime:a,pauseStartTime:o}=e();if(r==="idle"||!s||i.length<2)return n({state:"idle",currentPoints:[],startTime:null,pauseStartTime:null,totalPausedTime:0}),null;const l=Date.now();let u=a;o&&(u+=l-o);const h=l-s-u,f=OO(i),g={id:crypto.randomUUID(),name:t||`Route ${new Date().toLocaleDateString("nl-NL")} ${new Date().toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"})}`,points:i,startTime:s,endTime:l,totalDistance:f,totalDuration:h,pausedDuration:u,createdAt:new Date().toISOString()};return n(y=>({state:"idle",currentPoints:[],startTime:null,pauseStartTime:null,totalPausedTime:0,savedRoutes:[g,...y.savedRoutes]})),g},cancelRecording:()=>{n({state:"idle",currentPoints:[],startTime:null,pauseStartTime:null,totalPausedTime:0})},addPoint:(t,r,i)=>{const{state:s,currentPoints:a}=e();if(s!=="recording")return;if(a.length>0){const l=a[a.length-1];if(xG(l.coordinates[0],l.coordinates[1],t,r)<2)return}const o={coordinates:[t,r],timestamp:Date.now(),accuracy:i};n({currentPoints:[...a,o]})},deleteRoute:t=>{n(r=>({savedRoutes:r.savedRoutes.filter(i=>i.id!==t)}))},renameRoute:(t,r)=>{n(i=>({savedRoutes:i.savedRoutes.map(s=>s.id===t?{...s,name:r}:s)}))},clearAllRoutes:()=>{n({savedRoutes:[]})},getCurrentDistance:()=>{const{currentPoints:t}=e();return OO(t)},getCurrentDuration:()=>{const{state:t,startTime:r,totalPausedTime:i,pauseStartTime:s}=e();if(!r)return 0;const a=Date.now();let o=i;return t==="paused"&&s&&(o+=a-s),a-r-o},getAverageSpeed:()=>{const t=e().getCurrentDistance(),r=e().getCurrentDuration();return r===0?0:t/1e3/(r/36e5)}}),{name:"detectorapp-route-recording",version:1,partialize:n=>({savedRoutes:n.savedRoutes})}));function XEe(n){const e=`<?xml version="1.0" encoding="UTF-8"?>
<gpx version="1.1" creator="DetectorApp NL"
  xmlns="http://www.topografix.com/GPX/1/1"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd">
  <metadata>
    <name>${n.name}</name>
    <time>${new Date(n.startTime).toISOString()}</time>
  </metadata>
  <trk>
    <name>${n.name}</name>
    <trkseg>
${n.points.map(s=>`      <trkpt lat="${s.coordinates[1]}" lon="${s.coordinates[0]}">
        <time>${new Date(s.timestamp).toISOString()}</time>
      </trkpt>`).join(`
`)}
    </trkseg>
  </trk>
</gpx>`,t=new Blob([e],{type:"application/gpx+xml"}),r=URL.createObjectURL(t),i=document.createElement("a");i.href=r,i.download=`${n.name.replace(/[^a-zA-Z0-9]/g,"-")}.gpx`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(r)}function qEe(){const n=Mr(ue=>ue.showRouteRecordButton),{state:e,startRecording:t,pauseRecording:r,resumeRecording:i,stopRecording:s,cancelRecording:a,addPoint:o,getCurrentDistance:l,getCurrentDuration:u,getAverageSpeed:h,currentPoints:f,savedRoutes:g}=vG(),[y,v]=ne.useState(!1),[x,E]=ne.useState(""),[T,b]=ne.useState(!1),I=ne.useRef(null),M=ue=>{const Se=Math.floor(ue/1e3),se=Math.floor(Se/3600),V=Math.floor(Se%3600/60),J=Se%60;return se>0?`${se}:${V.toString().padStart(2,"0")}:${J.toString().padStart(2,"0")}`:`${V}:${J.toString().padStart(2,"0")}`},F=ue=>ue<1e3?`${Math.round(ue)} m`:`${(ue/1e3).toFixed(2)} km`,z=ue=>`${ue.toFixed(1)} km/h`;if(ne.useEffect(()=>(e==="recording"?"geolocation"in navigator&&I.current===null&&(I.current=navigator.geolocation.watchPosition(ue=>{o(ue.coords.longitude,ue.coords.latitude,ue.coords.accuracy)},ue=>{console.error("GPS error:",ue)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:1e3})):I.current!==null&&(navigator.geolocation.clearWatch(I.current),I.current=null),()=>{I.current!==null&&(navigator.geolocation.clearWatch(I.current),I.current=null)}),[e,o]),!n)return null;const P=()=>{t(),b(!0)},C=()=>{r()},k=()=>{i()},L=()=>{E(`Route ${new Date().toLocaleDateString("nl-NL")}`),v(!0)},O=()=>{const ue=s(x);v(!1),b(!1),E(""),ue&&confirm(`Route "${ue.name}" opgeslagen! (${F(ue.totalDistance)})

Direct exporteren als GPX?`)&&XEe(ue)},U=()=>{f.length>2&&!confirm("Weet je zeker dat je de opname wilt annuleren? De route wordt niet opgeslagen.")||(a(),v(!1),b(!1))},j=l(),Te=u(),Ce=h(),Ue=ue=>{switch(ue){case"recording":return"bg-red-500 hover:bg-red-600";case"paused":return"bg-yellow-500 hover:bg-yellow-600";default:return"bg-purple-500 hover:bg-purple-600"}},Ne=ue=>{switch(ue){case"recording":return m.jsx(ioe,{size:22,strokeWidth:2});case"paused":return m.jsx(uoe,{size:22,strokeWidth:2});default:return m.jsx(k9,{size:22,strokeWidth:2})}},le=()=>{switch(e){case"idle":P();break;case"recording":C();break;case"paused":k();break}};return m.jsxs(m.Fragment,{children:[m.jsxs(Ct.button,{className:`fixed bottom-2 right-[114px] z-[1000] w-11 h-11 ${Ue(e)} text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none backdrop-blur-sm`,whileHover:{scale:1.05},whileTap:{scale:.95},onClick:le,title:e==="idle"?"Route opnemen":e==="recording"?"Pauzeren":"Hervatten",children:[Ne(e),e==="recording"&&m.jsx(Ct.div,{className:"absolute inset-0 rounded-xl bg-red-400",animate:{opacity:[.5,0,.5]},transition:{duration:1.5,repeat:1/0}})]}),m.jsx(mr,{children:(e==="recording"||e==="paused")&&m.jsx(Ct.button,{className:"fixed bottom-2 right-[168px] z-[1000] w-11 h-11 bg-gray-700 hover:bg-gray-800 text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none",initial:{opacity:0,scale:.8,x:20},animate:{opacity:1,scale:1,x:0},exit:{opacity:0,scale:.8,x:20},whileHover:{scale:1.05},whileTap:{scale:.95},onClick:L,title:"Stoppen en opslaan",children:m.jsx(Loe,{size:18,strokeWidth:2,fill:"currentColor"})})}),m.jsx(mr,{children:T&&e!=="idle"&&m.jsxs(Ct.div,{className:"fixed bottom-16 right-2 z-[999] bg-white/95 backdrop-blur-sm rounded-xl shadow-lg p-3 min-w-[180px]",initial:{opacity:0,y:20,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.9},children:[m.jsxs("div",{className:"flex items-center justify-between mb-2",children:[m.jsx("span",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:e==="recording"?" Opname":" Gepauzeerd"}),m.jsx("button",{onClick:()=>b(!1),className:"p-0.5 text-gray-400 hover:text-gray-600 border-0 outline-none bg-transparent",children:m.jsx(Ni,{size:14})})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(P9,{size:16,className:"text-purple-500"}),m.jsx("span",{className:"text-lg font-semibold text-gray-800",children:F(j)})]}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(uae,{size:16,className:"text-blue-500"}),m.jsx(ZEe,{duration:Te,recordingState:e,formatTime:M})]}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(Pae,{size:16,className:"text-green-500"}),m.jsx("span",{className:"text-sm text-gray-600",children:z(Ce)})]}),m.jsxs("div",{className:"text-xs text-gray-400 pt-1 border-t border-gray-100",children:[f.length," punten opgenomen"]})]})]})}),m.jsx(mr,{children:y&&m.jsxs(m.Fragment,{children:[m.jsx(Ct.div,{className:"fixed inset-0 z-[1500] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>v(!1)}),m.jsxs(Ct.div,{className:"fixed left-4 right-4 top-1/2 z-[1501] bg-white rounded-xl shadow-2xl p-4 max-w-sm mx-auto",initial:{opacity:0,scale:.9,y:"-40%"},animate:{opacity:1,scale:1,y:"-50%"},exit:{opacity:0,scale:.9,y:"-40%"},children:[m.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Route opslaan"}),m.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 mb-4 space-y-1",children:[m.jsxs("div",{className:"flex justify-between text-sm",children:[m.jsx("span",{className:"text-gray-500",children:"Afstand:"}),m.jsx("span",{className:"font-medium",children:F(j)})]}),m.jsxs("div",{className:"flex justify-between text-sm",children:[m.jsx("span",{className:"text-gray-500",children:"Duur:"}),m.jsx("span",{className:"font-medium",children:M(Te)})]}),m.jsxs("div",{className:"flex justify-between text-sm",children:[m.jsx("span",{className:"text-gray-500",children:"Gem. snelheid:"}),m.jsx("span",{className:"font-medium",children:z(Ce)})]}),m.jsxs("div",{className:"flex justify-between text-sm",children:[m.jsx("span",{className:"text-gray-500",children:"Punten:"}),m.jsx("span",{className:"font-medium",children:f.length})]})]}),m.jsxs("div",{className:"mb-4",children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Naam van de route"}),m.jsx("input",{type:"text",value:x,onChange:ue=>E(ue.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Route naam...",autoFocus:!0})]}),m.jsxs("div",{className:"flex gap-2",children:[m.jsx("button",{onClick:U,className:"flex-1 px-4 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none",children:"Annuleren"}),m.jsxs("button",{onClick:O,disabled:f.length<2,className:"flex-1 px-4 py-2 bg-purple-500 hover:bg-purple-600 disabled:bg-gray-300 text-white rounded-lg transition-colors border-0 outline-none flex items-center justify-center gap-2",children:[m.jsx(M9,{size:16}),"Opslaan"]})]}),f.length<2&&m.jsx("p",{className:"text-xs text-red-500 text-center mt-2",children:"Minimaal 2 punten nodig om op te slaan"})]})]})})]})}function ZEe({duration:n,recordingState:e,formatTime:t}){const[r,i]=ne.useState(n);return ne.useEffect(()=>{if(e!=="recording"){i(n);return}const s=setInterval(()=>{i(a=>a+1e3)},1e3);return()=>clearInterval(s)},[e,n]),ne.useEffect(()=>{i(n)},[n]),m.jsx("span",{className:"text-lg font-semibold text-gray-800",children:t(r)})}function QEe(){const n=Ji(s=>s.map),{currentPoints:e,state:t}=vG(),r=ne.useRef(null),i=ne.useRef(null);return ne.useEffect(()=>{if(!n)return;const s=new O0;i.current=s;const a=new F0({source:s,zIndex:999,properties:{name:"route-recording-layer"}});return r.current=a,n.addLayer(a),()=>{r.current&&n&&n.removeLayer(r.current)}},[n]),ne.useEffect(()=>{if(!i.current||(i.current.clear(),t==="idle"||e.length===0))return;const s=e.map(a=>oo(a.coordinates));if(s.length>=2){const a=new Cs({geometry:new Ra(s)});a.setStyle(new $n({stroke:new Hr({color:t==="paused"?"rgba(234, 179, 8, 0.8)":"rgba(168, 85, 247, 0.8)",width:4,lineCap:"round",lineJoin:"round"})})),i.current.addFeature(a)}if(s.length>=1){const a=new Cs({geometry:new ds(s[0])});a.setStyle(new $n({image:new ka({radius:8,fill:new kr({color:"rgba(34, 197, 94, 1)"}),stroke:new Hr({color:"white",width:2})})})),i.current.addFeature(a)}if(s.length>=1){const a=new Cs({geometry:new ds(s[s.length-1])});a.setStyle(new $n({image:new ka({radius:6,fill:new kr({color:t==="paused"?"rgba(234, 179, 8, 1)":"rgba(168, 85, 247, 1)"}),stroke:new Hr({color:"white",width:2})})})),i.current.addFeature(a)}},[e,t]),null}const DO={Munt:"#f59e0b",Aardewerk:"#a16207",Gesp:"#6b7280",Fibula:"#8b5cf6",Ring:"#ec4899",Speld:"#6366f1",Sieraad:"#f43f5e",Gereedschap:"#64748b",Wapen:"#ef4444",Anders:"#3b82f6"},JEe={Munt:"M",Aardewerk:"A",Gesp:"G",Fibula:"F",Ring:"R",Speld:"S",Sieraad:"Si",Gereedschap:"Gr",Wapen:"W",Anders:"?"};function e2e(){const n=Ji(i=>i.map),e=Ko(i=>i.vondsten),t=Mr(i=>i.showLocalVondsten),r=ne.useRef(null);return ne.useEffect(()=>{if(!n)return;const i=new O0;return e.forEach(s=>{const a=new Cs({geometry:new ds(oo([s.location.lng,s.location.lat])),vondst:s}),o=DO[s.objectType]||DO.Anders,l=JEe[s.objectType]||"?";a.setStyle((u,h)=>{let v=12;h>50?v=6:h>10?v=Math.max(6,12-(h-10)/10):h<2&&(v=14);const x=Math.max(8,Math.min(12,v-2));return new $n({image:new ka({radius:v,fill:new kr({color:o}),stroke:new Hr({color:"#ffffff",width:v>8?2:1})}),text:v>=8?new ud({text:l,font:`bold ${x}px sans-serif`,fill:new kr({color:"#ffffff"}),offsetY:1}):void 0})}),i.addFeature(a)}),r.current?r.current.setSource(i):(r.current=new F0({source:i,zIndex:1e3,properties:{title:"Mijn Vondsten"}}),r.current.setVisible(t),n.addLayer(r.current)),()=>{r.current&&n&&(n.removeLayer(r.current),r.current=null)}},[n,e]),ne.useEffect(()=>{r.current&&r.current.setVisible(t)},[t]),null}const t2e={Mineraal:"M",Fossiel:"F",Erfgoed:"E",Monument:"Mo",Overig:""};function n2e(n){const{type:e,coordinates:t}=n,r=s=>typeof s[0]=="number"?oo(s):s.map(r),i=r(t);switch(e){case"Point":return new ds(i);case"LineString":return new Ra(i);case"Polygon":return new Ca(i);case"MultiPoint":return new cd(i);case"MultiLineString":return new Vl(i);case"MultiPolygon":return new Vh(i);default:return new ds(oo(t))}}function r2e(){const n=Ji(i=>i.map),e=Xi(i=>i.layers),t=Mr(i=>i.showCustomPointLayers),r=ne.useRef(new Map);return ne.useEffect(()=>{if(!n)return;const i=new Set(e.map(s=>s.id));return r.current.forEach((s,a)=>{i.has(a)||(n.removeLayer(s),r.current.delete(a))}),e.forEach(s=>{const a=new O0;s.points.forEach(l=>{let u;const h=l.geometry&&l.geometry.type!=="Point";l.geometry?u=n2e(l.geometry):u=new ds(oo(l.coordinates));const f=new Cs({geometry:u,layerType:"customPoint",customPoint:l,customLayerId:s.id,customLayerName:s.name,customLayerColor:s.color}),g=t2e[l.category]||l.category.charAt(0).toUpperCase();if(h){const y=l.geometry.type;f.setStyle(()=>y==="Polygon"||y==="MultiPolygon"?new $n({fill:new kr({color:s.color+"40"}),stroke:new Hr({color:s.color,width:2})}):y==="LineString"||y==="MultiLineString"?new $n({stroke:new Hr({color:s.color,width:3})}):new $n({image:new ka({radius:8,fill:new kr({color:s.color}),stroke:new Hr({color:"#ffffff",width:2})})}))}else f.setStyle((y,v)=>{let b=12;v>50?b=6:v>10?b=Math.max(6,12-(v-10)/10):v<2&&(b=14);const I=Math.max(8,Math.min(12,b-2));return new $n({image:new ka({radius:b,fill:new kr({color:s.color}),stroke:new Hr({color:"#ffffff",width:b>8?2:1})}),text:b>=8?new ud({text:g,font:`bold ${I}px sans-serif`,fill:new kr({color:"#ffffff"}),offsetY:1}):void 0})});a.addFeature(f)});const o=r.current.get(s.id);if(o)o.setSource(a),o.setVisible(t&&s.visible);else{const l=new F0({source:a,zIndex:950,properties:{title:s.name,customPointLayerId:s.id},visible:t&&s.visible});n.addLayer(l),r.current.set(s.id,l)}}),()=>{r.current.forEach(s=>{n&&n.removeLayer(s)}),r.current.clear()}},[n,e,t]),null}function i2e(){const{createLayerModalOpen:n,closeCreateLayerModal:e}=jr(),{addLayer:t}=Xi(),r=Mr(),[i,s]=ne.useState(""),[a,o]=ne.useState([...Fc]),[l,u]=ne.useState(""),h=14*r.fontScale/100,f=()=>{const E=l.trim();E&&!a.includes(E)&&(o([...a,E]),u(""))},g=E=>{o(a.filter(T=>T!==E))},y=E=>{a.includes(E)?o(a.filter(T=>T!==E)):o([...a,E])},v=()=>{i.trim()&&(t(i.trim(),a),s(""),o([...Fc]),u(""),e())},x=()=>{s(""),o([...Fc]),u(""),e()};return m.jsx(mr,{children:n&&m.jsxs(m.Fragment,{children:[m.jsx(Ct.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:x}),m.jsxs(Ct.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-sm mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[m.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(io,{size:18}),m.jsx("span",{className:"font-medium",children:"Nieuwe laag"})]}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),m.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:r.fontScale,onChange:E=>r.setFontScale(parseInt(E.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${r.fontScale}%`}),m.jsx("span",{className:"text-xs opacity-70",children:"T"}),m.jsx("button",{onClick:x,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:m.jsx(Ni,{size:18})})]})]}),m.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",style:{fontSize:`${h}px`},children:[m.jsxs("div",{children:[m.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Naam van de laag"}),m.jsx("input",{type:"text",value:i,onChange:E=>s(E.target.value),placeholder:"bijv. Vakantie Frankrijk 2026",className:"w-full px-3 py-2 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"},autoFocus:!0})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block font-medium text-gray-700 mb-2",style:{fontSize:"0.9em"},children:"Categorien"}),m.jsx("div",{className:"flex flex-wrap gap-2",children:Fc.map(E=>m.jsx("button",{onClick:()=>y(E),className:`px-3 py-1 rounded-full transition-colors border-0 outline-none ${a.includes(E)?"bg-orange-500 text-white":"bg-white text-gray-600 hover:bg-blue-50"}`,style:{fontSize:"0.9em"},children:E},E))})]}),a.filter(E=>!Fc.includes(E)).length>0&&m.jsxs("div",{children:[m.jsx("label",{className:"block font-medium text-gray-700 mb-2",style:{fontSize:"0.9em"},children:"Eigen categorien"}),m.jsx("div",{className:"flex flex-wrap gap-2",children:a.filter(E=>!Fc.includes(E)).map(E=>m.jsxs("div",{className:"flex items-center",children:[m.jsx("button",{onClick:()=>y(E),className:"px-3 py-1 rounded-l-full bg-orange-500 text-white hover:bg-orange-600 transition-colors border-0 outline-none",style:{fontSize:"0.9em"},children:E}),m.jsx("button",{onClick:()=>g(E),className:"px-2 py-1 rounded-r-full bg-orange-600 text-white hover:bg-orange-700 transition-colors border-0 outline-none",title:"Verwijder categorie",children:m.jsx(_d,{size:12})})]},E))})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Eigen categorie toevoegen"}),m.jsxs("div",{className:"flex gap-2",children:[m.jsx("input",{type:"text",value:l,onChange:E=>u(E.target.value),placeholder:"bijv. Grot, Bron, ...",className:"flex-1 px-3 py-2 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"},onKeyDown:E=>E.key==="Enter"&&f()}),m.jsx("button",{onClick:f,disabled:!l.trim(),className:"px-3 py-2 bg-white hover:bg-blue-50 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg transition-colors border-0 outline-none text-gray-600",children:m.jsx(co,{size:20})})]})]})]}),m.jsxs("div",{className:"p-4 flex gap-3",style:{fontSize:`${h}px`},children:[m.jsx("button",{onClick:x,className:"flex-1 px-4 py-2 bg-white hover:bg-blue-50 rounded-lg transition-colors border-0 outline-none text-gray-600",style:{fontSize:"1em"},children:"Annuleren"}),m.jsx("button",{onClick:v,disabled:!i.trim(),className:"flex-1 px-4 py-2 bg-orange-500 hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg transition-colors border-0 outline-none",style:{fontSize:"1em"},children:"Aanmaken"})]})]})]})})}const wG=200,s2e=.7;async function a2e(n,e=wG){return new Promise((t,r)=>{const i=new Image,s=document.createElement("canvas"),a=s.getContext("2d");i.onload=()=>{let o=i.width,l=i.height;o>l?o>e&&(l=Math.round(l*e/o),o=e):l>e&&(o=Math.round(o*e/l),l=e),s.width=o,s.height=l,a?.drawImage(i,0,0,o,l),s.toBlob(u=>{u?t(u):r(new Error("Failed to create blob from canvas"))},"image/jpeg",s2e)},i.onerror=()=>r(new Error("Failed to load image")),i.src=URL.createObjectURL(n)})}function o2e(n){return new Promise((e,t)=>{const r=new FileReader;r.onloadend=()=>{typeof r.result=="string"?e(r.result):t(new Error("Failed to convert blob to base64"))},r.onerror=()=>t(new Error("Failed to read blob")),r.readAsDataURL(n)})}async function l2e(n){const e=await a2e(n,wG),t=await o2e(e);return{thumbnailBlob:e,thumbnailBase64:t}}function c2e(){return`photo_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}const qS=5;function u2e({photos:n,onAddPhoto:e,onRemovePhoto:t,disabled:r}){const i=ne.useRef(null),s=ne.useRef(null),a=async l=>{const u=l.target.files;if(!u||u.length===0)return;const h=qS-n.length,f=Array.from(u).slice(0,h);for(const g of f)try{const{thumbnailBase64:y}=await l2e(g),v={id:c2e(),thumbnailBase64:y,createdAt:new Date().toISOString(),pendingUpload:!0};e(v)}catch(y){console.error("Failed to process image:",y)}l.target.value=""},o=n.length<qS;return m.jsxs("div",{className:"space-y-2",children:[m.jsxs("label",{className:"block font-medium text-gray-700",style:{fontSize:"0.9em"},children:["Foto's (",n.length,"/",qS,")"]}),m.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.map(l=>m.jsxs("div",{className:"relative w-16 h-16 rounded-lg overflow-hidden bg-gray-100 border border-gray-200",children:[m.jsx("img",{src:l.thumbnailUrl||l.thumbnailBase64,alt:"Foto",className:"w-full h-full object-cover"}),!r&&m.jsx("button",{type:"button",onClick:()=>t(l.id),className:"absolute top-0.5 right-0.5 w-5 h-5 bg-red-500 rounded-full flex items-center justify-center border-0 outline-none",children:m.jsx(Ni,{size:12,className:"text-white"})}),l.pendingUpload&&m.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-orange-500/80 text-white text-center py-0.5",style:{fontSize:"0.6em"},children:"Wacht..."})]},l.id)),o&&!r&&m.jsxs(m.Fragment,{children:[m.jsxs("button",{type:"button",onClick:()=>s.current?.click(),className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 hover:border-orange-400 hover:bg-orange-50 flex flex-col items-center justify-center gap-1 transition-colors bg-transparent outline-none",title:"Maak foto",children:[m.jsx(xR,{size:20,className:"text-gray-400"}),m.jsx("span",{className:"text-gray-400",style:{fontSize:"0.6em"},children:"Camera"})]}),m.jsxs("button",{type:"button",onClick:()=>i.current?.click(),className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 hover:border-orange-400 hover:bg-orange-50 flex flex-col items-center justify-center gap-1 transition-colors bg-transparent outline-none",title:"Kies foto",children:[m.jsx(Fae,{size:20,className:"text-gray-400"}),m.jsx("span",{className:"text-gray-400",style:{fontSize:"0.6em"},children:"Gallerij"})]})]})]}),m.jsx("input",{ref:s,type:"file",accept:"image/*",capture:"environment",onChange:a,className:"hidden"}),m.jsx("input",{ref:i,type:"file",accept:"image/*",multiple:!0,onChange:a,className:"hidden"})]})}function h2e(){const{addPointModalOpen:n,addPointModalLayerId:e,addPointModalLocation:t,closeAddPointModal:r}=jr(),{addPoint:i,getLayer:s}=Xi(),a=Mr(),[o,l]=ne.useState(""),[u,h]=ne.useState(""),[f,g]=ne.useState(""),[y,v]=ne.useState([]),x=e?s(e):null,E=14*a.fontScale/100,T=()=>{!o.trim()||!e||!t||(i(e,{name:o.trim(),category:"Overig",notes:u.trim(),url:f.trim()||void 0,coordinates:[t.lng,t.lat],photos:y.length>0?y:void 0}),l(""),h(""),g(""),v([]),r())},b=()=>{l(""),h(""),g(""),v([]),r()};return x?m.jsx(mr,{children:n&&m.jsxs(m.Fragment,{children:[m.jsx(Ct.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:b}),m.jsxs(Ct.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-sm mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[m.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(Hl,{size:18}),m.jsx("span",{className:"font-medium",children:"Punt toevoegen"})]}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),m.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:a.fontScale,onChange:I=>a.setFontScale(parseInt(I.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${a.fontScale}%`}),m.jsx("span",{className:"text-xs opacity-70",children:"T"}),m.jsx("button",{onClick:b,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:m.jsx(Ni,{size:18})})]})]}),m.jsx("div",{className:"px-4 py-1.5",children:m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:x.color}}),m.jsx("span",{className:"text-sm text-gray-600",children:x.name})]})}),m.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",style:{fontSize:`${E}px`},children:[m.jsxs("div",{children:[m.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Naam *"}),m.jsx("input",{type:"text",value:o,onChange:I=>l(I.target.value),className:"w-full px-3 py-1.5 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"},autoFocus:!0})]}),m.jsx(u2e,{photos:y,onAddPhoto:I=>v([...y,I]),onRemovePhoto:I=>v(y.filter(M=>M.id!==I))}),m.jsxs("div",{children:[m.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Notities"}),m.jsx("textarea",{value:u,onChange:I=>h(I.target.value),placeholder:"Beschrijving, tips, opmerkingen...",rows:2,className:"w-full px-3 py-1.5 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors resize-none",style:{fontSize:"1em"}})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Link"}),m.jsx("input",{type:"url",value:f,onChange:I=>g(I.target.value),placeholder:"https://...",className:"w-full px-3 py-1.5 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"}})]})]}),m.jsxs("div",{className:"p-3 flex gap-3",style:{fontSize:`${E}px`},children:[m.jsx("button",{onClick:b,className:"flex-1 px-4 py-1.5 bg-white hover:bg-blue-50 rounded-lg transition-colors border-0 outline-none text-gray-600",style:{fontSize:"1em"},children:"Annuleren"}),m.jsx("button",{onClick:T,disabled:!o.trim(),className:"flex-1 px-4 py-1.5 bg-orange-500 hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg transition-colors border-0 outline-none",style:{fontSize:"1em"},children:"Toevoegen"})]})]})]})}):null}function d2e(){const{layerManagerModalOpen:n,closeLayerManagerModal:e,openCreateLayerModal:t,openLayerDashboard:r}=jr(),{layers:i,removeLayer:s,toggleVisibility:a,toggleArchived:o,exportLayerAsGeoJSON:l,importLayerFromGeoJSON:u}=Xi(),h=Mr(),f=14*h.fontScale/100,[g,y]=ne.useState(null),[v,x]=ne.useState(null),[E,T]=ne.useState(null),[b,I]=ne.useState(!1),M=i.filter(j=>!j.archived),F=i.filter(j=>j.archived),z=b?F:M,P=j=>{v===j?(s(j),x(null)):(x(j),setTimeout(()=>x(null),3e3))},C=j=>{l(j)},k=async j=>{const Te=j.target.files?.[0];if(Te){try{const Ce=await Te.text(),Ue=u(Ce);Ue.success||(T(Ue.error||"Import mislukt"),setTimeout(()=>T(null),3e3))}catch{T("Kon bestand niet lezen"),setTimeout(()=>T(null),3e3)}j.target.value=""}},L=()=>{y(null),x(null),T(null),I(!1),e()},O=j=>{r(j)},U=()=>{L(),t()};return m.jsx(mr,{children:n&&m.jsxs(m.Fragment,{children:[m.jsx(Ct.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:L}),m.jsxs(Ct.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[m.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(io,{size:18}),m.jsx("span",{className:"font-medium",children:"Mijn Lagen beheren"})]}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),m.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:h.fontScale,onChange:j=>h.setFontScale(parseInt(j.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${h.fontScale}%`}),m.jsx("span",{className:"text-xs opacity-70",children:"T"}),m.jsx("button",{onClick:L,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:m.jsx(Ni,{size:18})})]})]}),m.jsxs("div",{className:"flex border-b border-gray-100",children:[m.jsxs("button",{onClick:()=>I(!1),className:`flex-1 px-3 py-2 text-sm transition-colors border-0 outline-none ${b?"text-gray-500 hover:text-gray-700 hover:bg-gray-50":"text-orange-600 border-b-2 border-orange-500 bg-orange-50/50"}`,children:["Actief (",M.length,")"]}),m.jsxs("button",{onClick:()=>I(!0),className:`flex-1 px-3 py-2 text-sm transition-colors border-0 outline-none flex items-center justify-center gap-1 ${b?"text-orange-600 border-b-2 border-orange-500 bg-orange-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[m.jsx(w9,{size:14}),"Archief (",F.length,")"]})]}),m.jsxs("div",{className:"flex-1 overflow-y-auto",style:{fontSize:`${f}px`},children:[z.length===0?m.jsx("div",{className:"p-8 text-center text-gray-500",children:b?m.jsx("p",{style:{fontSize:"1em"},children:"Geen gearchiveerde lagen."}):m.jsxs(m.Fragment,{children:[m.jsx("p",{className:"mb-4",style:{fontSize:"1em"},children:"Je hebt nog geen eigen lagen."}),m.jsxs("button",{onClick:U,className:"px-4 py-2 bg-orange-500 hover:bg-orange-600 text-white rounded-lg transition-colors border-0 outline-none",style:{fontSize:"1em"},children:[m.jsx(co,{size:16,className:"inline mr-2"}),"Nieuwe laag aanmaken"]})]})}):m.jsx("div",{className:"divide-y divide-gray-100",children:z.map(j=>m.jsx(g2e,{layer:j,isExpanded:g===j.id,onToggleExpand:()=>y(g===j.id?null:j.id),onToggleVisibility:()=>a(j.id),onToggleArchived:()=>o(j.id),onOpenDashboard:()=>O(j.id),onExport:()=>C(j.id),onDelete:()=>P(j.id),confirmDelete:v===j.id,onRename:Te=>Xi.getState().updateLayer(j.id,{name:Te}),onChangeColor:Te=>Xi.getState().updateLayer(j.id,{color:Te})},j.id))}),E&&m.jsx("div",{className:"mx-4 my-2 p-3 bg-red-50 text-red-700 text-sm rounded-lg",children:E})]}),m.jsxs("div",{className:"p-4 flex gap-3",style:{fontSize:`${f}px`},children:[m.jsxs("label",{className:"flex-1 px-4 py-2 bg-white hover:bg-blue-50 rounded-lg transition-colors cursor-pointer flex items-center justify-center gap-2 border-0 outline-none text-gray-600",children:[m.jsx(Dw,{size:16}),m.jsx("span",{style:{fontSize:"1em"},children:"Importeren"}),m.jsx("input",{type:"file",accept:".geojson,.json",onChange:k,className:"hidden"})]}),m.jsxs("button",{onClick:U,className:"flex-1 px-4 py-2 bg-orange-500 hover:bg-orange-600 text-white rounded-lg transition-colors border-0 outline-none flex items-center justify-center gap-2",style:{fontSize:"1em"},children:[m.jsx(co,{size:16}),m.jsx("span",{children:"Nieuwe laag"})]})]})]})]})})}const f2e=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899"];function g2e({layer:n,isExpanded:e,onToggleExpand:t,onToggleVisibility:r,onToggleArchived:i,onOpenDashboard:s,onExport:a,onDelete:o,confirmDelete:l,onRename:u,onChangeColor:h}){const[f,g]=ne.useState(!1),[y,v]=ne.useState(n.name),[x,E]=ne.useState(!1),T=ne.useRef(null);ne.useEffect(()=>{f&&T.current&&(T.current.focus(),T.current.select())},[f]);const b=()=>{v(n.name),g(!0)},I=()=>{const C=y.trim();C&&C!==n.name&&u(C),g(!1)},M=()=>{v(n.name),g(!1)},F=C=>{C.key==="Enter"?I():C.key==="Escape"&&M()},z=n.points.filter(C=>C.status==="completed").length,P=n.points.length;return m.jsxs("div",{className:"bg-white",children:[m.jsxs("div",{className:"flex items-center gap-3 px-4 py-3",children:[m.jsx("button",{onClick:t,className:"p-1 text-gray-400 hover:text-gray-600 transition-colors border-0 outline-none bg-transparent",children:e?m.jsx(vR,{size:16}):m.jsx(Ow,{size:16})}),m.jsxs("div",{className:"relative",children:[m.jsx("button",{onClick:()=>E(!x),className:"w-5 h-5 rounded-full flex-shrink-0 border-2 border-white shadow-sm hover:scale-110 transition-transform cursor-pointer",style:{backgroundColor:n.color},title:"Kleur wijzigen"}),x&&m.jsx("div",{className:"absolute top-7 left-0 z-50 bg-white rounded-lg shadow-lg p-2 flex flex-wrap gap-1 w-24",children:f2e.map(C=>m.jsx("button",{onClick:()=>{h(C),E(!1)},className:`w-5 h-5 rounded-full border-2 hover:scale-110 transition-transform ${C===n.color?"border-gray-800":"border-white"}`,style:{backgroundColor:C}},C))})]}),f?m.jsxs("div",{className:"flex-1 min-w-0 flex items-center gap-2",children:[m.jsx("input",{ref:T,type:"text",value:y,onChange:C=>v(C.target.value),onKeyDown:F,onBlur:I,className:"flex-1 px-2 py-1 text-gray-800 font-medium bg-orange-50 rounded outline-none focus:ring-2 focus:ring-orange-400"}),m.jsx("button",{onClick:I,className:"p-1 text-green-600 hover:bg-green-50 rounded transition-colors border-0 outline-none",title:"Opslaan",children:m.jsx(Wl,{size:16})})]}):m.jsxs("button",{onClick:s,className:"flex-1 min-w-0 text-left border-0 outline-none bg-transparent hover:bg-orange-50 rounded px-2 py-1 -ml-2 transition-colors",title:"Bekijk dashboard",children:[m.jsx("div",{className:"font-medium text-gray-800 truncate hover:text-orange-600",children:n.name}),m.jsx("div",{className:"text-xs text-gray-500",children:P>0?m.jsxs("span",{className:z===P?"text-green-600":"",children:[z,"/",P," voltooid"]}):"Geen punten"})]}),!f&&m.jsx("button",{onClick:b,className:"p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",title:"Naam bewerken",children:m.jsx(Ip,{size:16})}),m.jsx("button",{onClick:s,className:"p-2 text-orange-400 hover:text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none",title:"Open dashboard",children:m.jsx(Bae,{size:18})}),!n.archived&&m.jsx("button",{onClick:r,className:`p-2 rounded transition-colors border-0 outline-none ${n.visible?"text-blue-500 hover:bg-blue-50":"text-gray-400 hover:bg-gray-100"}`,title:n.visible?"Verbergen":"Tonen",children:n.visible?m.jsx(A9,{size:18}):m.jsx(I9,{size:18})}),m.jsx("button",{onClick:i,className:`p-2 rounded transition-colors border-0 outline-none ${n.archived?"text-green-500 hover:text-green-600 hover:bg-green-50":"text-gray-400 hover:text-amber-600 hover:bg-amber-50"}`,title:n.archived?"Herstellen":"Archiveren",children:n.archived?m.jsx(zse,{size:18}):m.jsx(w9,{size:18})}),m.jsx("button",{onClick:a,className:"p-2 text-gray-400 hover:text-green-600 hover:bg-green-50 rounded transition-colors border-0 outline-none",title:"Exporteren als GeoJSON",children:m.jsx(Sb,{size:18})}),m.jsx("button",{onClick:o,className:`p-2 rounded transition-colors border-0 outline-none ${l?"text-white bg-red-500 hover:bg-red-600":"text-gray-400 hover:text-red-600 hover:bg-red-50"}`,title:l?"Klik nogmaals om te verwijderen":"Verwijderen",children:m.jsx(_d,{size:18})})]}),m.jsx(mr,{children:e&&m.jsx(Ct.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:m.jsxs("div",{className:"px-4 pb-3 pl-12 space-y-2",children:[n.categories.length>0&&m.jsx("div",{className:"flex flex-wrap gap-1",children:n.categories.map(C=>m.jsx("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-600 text-xs rounded-full",children:C},C))}),n.points.length>0&&m.jsxs("div",{className:"text-xs text-gray-500 space-y-1 max-h-32 overflow-y-auto",children:[n.points.slice(0,5).map(C=>m.jsx("div",{className:"flex items-center gap-2",children:m.jsx("span",{className:`font-medium ${C.status==="completed"?"text-green-600 line-through":C.status==="skipped"?"text-gray-400 line-through":"text-gray-700"}`,children:C.name})},C.id)),n.points.length>5&&m.jsxs("div",{className:"text-gray-400",children:["...en ",n.points.length-5," meer"]})]}),m.jsxs("div",{className:"text-xs text-gray-400",children:["Aangemaakt: ",new Date(n.createdAt).toLocaleDateString("nl-NL")]})]})})})]})}function m2e(){const{layerDashboardOpen:n,layerDashboardLayerId:e,closeLayerDashboard:t}=jr(),{getLayer:r,setPointStatus:i,updatePoint:s,removePoint:a}=Xi(),o=Mr(),[l,u]=ne.useState("all"),[h,f]=ne.useState(null),[g,y]=ne.useState(""),[v,x]=ne.useState(null),E=e?r(e):null,T=14*o.fontScale/100;if(!E)return null;const b=E.points.filter(O=>l==="all"?!0:O.status===l),I=E.points.length,M=E.points.filter(O=>O.status==="completed").length,F=E.points.filter(O=>O.status==="todo").length,z=E.points.filter(O=>O.status==="skipped").length,P=(O,U)=>{i(E.id,O,U)},C=O=>{s(E.id,O,{notes:g}),f(null),y("")},k=O=>{v===O?(a(E.id,O),x(null)):(x(O),setTimeout(()=>x(null),3e3))},L=()=>{f(null),x(null),t()};return m.jsx(mr,{children:n&&m.jsxs(m.Fragment,{children:[m.jsx(Ct.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:L}),m.jsxs(Ct.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[m.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("div",{className:"w-4 h-4 rounded-full border-2 border-white/50",style:{backgroundColor:E.color}}),m.jsx("span",{className:"font-medium truncate",children:E.name})]}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),m.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:o.fontScale,onChange:O=>o.setFontScale(parseInt(O.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${o.fontScale}%`}),m.jsx("span",{className:"text-xs opacity-70",children:"T"}),m.jsx("button",{onClick:L,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:m.jsx(Ni,{size:18})})]})]}),m.jsxs("div",{className:"px-4 py-2 bg-orange-50 flex items-center justify-between text-sm",children:[m.jsxs("span",{className:"text-orange-800 font-medium",children:[M,"/",I," voltooid"]}),m.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[m.jsxs("span",{className:"text-orange-600",children:[F," te doen"]}),z>0&&m.jsxs("span",{className:"text-gray-500",children:[z," overgeslagen"]})]})]}),m.jsx("div",{className:"flex border-b border-gray-100",children:["all","todo","completed","skipped"].map(O=>m.jsxs("button",{onClick:()=>u(O),className:`flex-1 px-3 py-2 text-sm transition-colors border-0 outline-none ${l===O?"text-orange-600 border-b-2 border-orange-500 bg-orange-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[O==="all"&&"Alles",O==="todo"&&"Te doen",O==="completed"&&"Voltooid",O==="skipped"&&"Overgeslagen"]},O))}),m.jsx("div",{className:"flex-1 overflow-y-auto",style:{fontSize:`${T}px`},children:b.length===0?m.jsx("div",{className:"p-8 text-center text-gray-500",children:m.jsx("p",{children:"Geen punten gevonden"})}):m.jsx("div",{className:"divide-y divide-gray-100",children:b.map(O=>m.jsx("div",{className:"p-3",children:m.jsxs("div",{className:"flex items-start gap-3",children:[m.jsxs("div",{className:"flex flex-col gap-1 pt-0.5",children:[m.jsx("button",{onClick:()=>P(O.id,O.status==="completed"?"todo":"completed"),className:`w-6 h-6 flex items-center justify-center rounded border-0 outline-none transition-colors ${O.status==="completed"?"bg-green-100 hover:bg-green-200":"bg-gray-100 hover:bg-green-100"}`,title:O.status==="completed"?"Markeer als te doen":"Markeer als voltooid",children:m.jsx(Wl,{size:14,className:O.status==="completed"?"text-green-600":"text-gray-400"})}),m.jsx("button",{onClick:()=>P(O.id,O.status==="skipped"?"todo":"skipped"),className:`w-6 h-6 flex items-center justify-center rounded border-0 outline-none transition-colors ${O.status==="skipped"?"bg-gray-200 hover:bg-gray-300":"bg-gray-100 hover:bg-gray-200"}`,title:O.status==="skipped"?"Markeer als te doen":"Overslaan",children:m.jsx(Hse,{size:14,className:O.status==="skipped"?"text-gray-600":"text-gray-400"})})]}),O.photos&&O.photos.length>0&&m.jsxs("div",{className:"relative flex-shrink-0",children:[m.jsx("img",{src:O.photos[0].thumbnailUrl||O.photos[0].thumbnailBase64,alt:"Foto",className:"w-12 h-12 object-cover rounded border border-gray-200"}),O.photos.length>1&&m.jsxs("span",{className:"absolute -bottom-1 -right-1 bg-orange-500 text-white text-[9px] px-1 rounded-full",children:["+",O.photos.length-1]})]}),m.jsxs("div",{className:"flex-1 min-w-0",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("span",{className:`font-medium truncate ${O.status==="completed"?"text-green-700 line-through":O.status==="skipped"?"text-gray-400 line-through":"text-gray-800"}`,children:O.name}),O.sourceLayer&&m.jsxs("span",{className:"text-xs text-gray-400 truncate",children:["via ",O.sourceLayer]})]}),h===O.id?m.jsxs("div",{className:"mt-2",children:[m.jsx("textarea",{value:g,onChange:U=>y(U.target.value),placeholder:"Notities...",rows:2,className:"w-full px-2 py-1 bg-white rounded border-0 outline-none hover:bg-blue-50 transition-colors resize-none text-sm",autoFocus:!0}),m.jsxs("div",{className:"flex gap-2 mt-1",children:[m.jsx("button",{onClick:()=>C(O.id),className:"px-2 py-1 text-xs bg-orange-500 text-white rounded hover:bg-orange-600 border-0 outline-none",children:"Opslaan"}),m.jsx("button",{onClick:()=>{f(null),y("")},className:"px-2 py-1 text-xs bg-white text-gray-600 rounded hover:bg-blue-50 border-0 outline-none",children:"Annuleren"})]})]}):O.notes?m.jsx("p",{className:"text-sm text-gray-600 mt-1",children:O.notes}):null,O.url&&m.jsxs("a",{href:O.url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-xs text-blue-500 hover:text-blue-700 mt-1",children:[m.jsx(S1,{size:12}),"Link"]})]}),m.jsxs("div",{className:"flex flex-col gap-1",children:[m.jsx("button",{onClick:()=>{f(O.id),y(O.notes)},className:"w-6 h-6 flex items-center justify-center text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded border-0 outline-none",title:"Notities bewerken",children:m.jsx(ooe,{size:14})}),m.jsx("button",{onClick:()=>{window.open(`https://www.google.com/maps/dir/?api=1&destination=${O.coordinates[1]},${O.coordinates[0]}`,"_blank")},className:"w-6 h-6 flex items-center justify-center text-blue-400 hover:text-blue-600 hover:bg-blue-50 rounded border-0 outline-none",title:"Navigeer naar",children:m.jsx(Hl,{size:14})}),m.jsx("button",{onClick:()=>k(O.id),className:`w-6 h-6 flex items-center justify-center rounded border-0 outline-none ${v===O.id?"text-white bg-red-500 hover:bg-red-600":"text-gray-400 hover:text-red-600 hover:bg-red-50"}`,title:v===O.id?"Klik nogmaals":"Verwijderen",children:m.jsx(_d,{size:14})})]})]})},O.id))})})]})]})})}class FO{buffer=[];size;weights;constructor(e=8){this.size=e,this.weights=Array.from({length:e},(r,i)=>Math.pow(2,i));const t=this.weights.reduce((r,i)=>r+i,0);this.weights=this.weights.map(r=>r/t)}add(e){if(this.buffer.length>0){const t=this.buffer[this.buffer.length-1];let r=e-t;r>180&&(e-=360),r<-180&&(e+=360)}this.buffer.push(e),this.buffer.length>this.size&&this.buffer.shift()}getSmoothed(){if(this.buffer.length===0)return null;if(this.buffer.length===1)return this.normalizeHeading(this.buffer[0]);let e=0,t=0;const r=this.size-this.buffer.length;for(let i=0;i<this.buffer.length;i++){const s=this.weights[r+i];e+=this.buffer[i]*s,t+=s}return this.normalizeHeading(e/t)}normalizeHeading(e){return(e%360+360)%360}clear(){this.buffer=[]}}function p2e(){const n=ss(u=>u.tracking),e=ss(u=>u.headingSource);ss(u=>u.speed);const t=ss(u=>u.setSmoothedHeading),r=ne.useRef(new FO(6)),i=ne.useRef(new FO(10)),s=ne.useRef(0),a=ne.useRef(null),o=33,l=ne.useCallback((u,h)=>{const f=performance.now();if(f-s.current<o)return;const g=h==="gps"?r.current:i.current;g.add(u);const y=g.getSmoothed();y!==null&&(s.current=f,t(y))},[t]);ne.useEffect(()=>{if(!n)return;const u=f=>{f.coords.heading!==null&&f.coords.speed!==null&&f.coords.speed>.8&&f.coords.accuracy<20&&l(f.coords.heading,"gps")},h=navigator.geolocation.watchPosition(u,()=>{},{enableHighAccuracy:!0,maximumAge:500,timeout:1e4});return()=>navigator.geolocation.clearWatch(h)},[n,l]),ne.useEffect(()=>{if(!n||e!=="compass")return;let u=0;const h=50,f=y=>{const v=performance.now();if(!(v-u<h)&&(u=v,y.alpha!==null)){const x=(360-y.alpha)%360;l(x,"compass")}},g=y=>{const v=performance.now();v-u<h||(u=v,y.webkitCompassHeading!==void 0&&l(y.webkitCompassHeading,"compass"))};return window.addEventListener("deviceorientationabsolute",f),window.addEventListener("deviceorientation",g),()=>{window.removeEventListener("deviceorientationabsolute",f),window.removeEventListener("deviceorientation",g)}},[n,e,l]),ne.useEffect(()=>{n||(r.current.clear(),i.current.clear())},[n]),ne.useEffect(()=>()=>{a.current&&cancelAnimationFrame(a.current)},[])}function y2e(){const n=Ji(i=>i.map),e=fi(i=>i.setLayerOpacity),t=fi(i=>i.visible),r=ne.useRef(null);ne.useEffect(()=>{if(!n)return;const i=()=>{const s=n.getView().getZoom();if(!s||r.current!==null&&Math.abs(s-r.current)<.5)return;r.current=s;const a=t["AHN 0.5m"],o=t["AHN4 Multi-Hillshade NL"];!a&&!o||(a&&(s>=18?e("AHN 0.5m",.85):s>=16?e("AHN 0.5m",.75):s>=14?e("AHN 0.5m",.65):e("AHN 0.5m",.55)),o&&(s>=18?e("AHN4 Multi-Hillshade NL",.8):s>=16?e("AHN4 Multi-Hillshade NL",.7):s>=14?e("AHN4 Multi-Hillshade NL",.6):e("AHN4 Multi-Hillshade NL",.5)))};return n.on("moveend",i),i(),()=>{n.un("moveend",i)}},[n,t,e])}const jO=2e3;function _2e(){const n=Rw(g=>g.user),{layers:e,clearAll:t}=Xi(),{vondsten:r,clearAll:i}=Ko(),s=ne.useRef(null),a=ne.useRef(!0),o=ne.useRef(""),l=ne.useRef(""),u=ne.useCallback(async g=>{if(n)try{const y=qf(Xc,"users",n.uid);await WN(y,{layers:g,layersUpdatedAt:HN()},{merge:!0}),console.log(" Lagen gesynchroniseerd naar cloud")}catch(y){console.error(" Fout bij synchroniseren lagen:",y)}},[n]),h=ne.useCallback(async g=>{if(n)try{const y=qf(Xc,"users",n.uid);await WN(y,{vondsten:g,vondstenUpdatedAt:HN()},{merge:!0}),console.log(" Vondsten gesynchroniseerd naar cloud")}catch(y){console.error(" Fout bij synchroniseren vondsten:",y)}},[n]),f=ne.useCallback(async()=>{if(n)try{const g=qf(Xc,"users",n.uid),y=await wee(g);if(y.exists()){const v=y.data();if(v.layers&&Array.isArray(v.layers)){const x=v.layers,E=Xi.getState().layers,T=[...x],b=new Set(x.map(I=>I.id));E.forEach(I=>{b.has(I.id)||T.push(I)}),Xi.setState({layers:T}),o.current=JSON.stringify(T),console.log(` ${x.length} lagen geladen uit cloud`)}if(v.vondsten&&Array.isArray(v.vondsten)){const x=v.vondsten,E=Ko.getState().vondsten,T=[...x],b=new Set(x.map(I=>I.id));E.forEach(I=>{b.has(I.id)||T.push(I)}),Ko.setState({vondsten:T}),l.current=JSON.stringify(T),console.log(` ${x.length} vondsten geladen uit cloud`)}}else console.log(" Geen cloud data gevonden, lokale data wordt gesynchroniseerd..."),await u(e),await h(r);a.current=!1}catch(g){console.error(" Fout bij laden uit cloud:",g),a.current=!1}},[n,e,r,u,h]);return ne.useEffect(()=>{n?(a.current=!0,f()):(a.current=!0,o.current="",l.current="")},[n?.uid]),ne.useEffect(()=>{if(!n||a.current)return;const g=JSON.stringify(e);if(g!==o.current)return s.current&&clearTimeout(s.current),s.current=setTimeout(()=>{o.current=g,u(e)},jO),()=>{s.current&&clearTimeout(s.current)}},[n,e,u]),ne.useEffect(()=>{if(!n||a.current)return;const g=JSON.stringify(r);if(g!==l.current)return s.current&&clearTimeout(s.current),s.current=setTimeout(()=>{l.current=g,h(r)},jO),()=>{s.current&&clearTimeout(s.current)}},[n,r,h]),{isLoggedIn:!!n,syncLayersToCloud:u,syncVondstenToCloud:h}}function x2e(){p2e(),y2e(),_2e();const e=14*Mr(s=>s.fontScale)/100,t=jr(s=>s.vondstFormOpen),r=jr(s=>s.vondstFormLocation),i=jr(s=>s.closeVondstForm);return m.jsx(_Ee,{children:m.jsxs("div",{style:{fontSize:`${e}px`},children:[m.jsx(ute,{}),m.jsx(Qoe,{}),m.jsx(e2e,{}),m.jsx(TEe,{}),m.jsx(r2e,{}),m.jsx(QEe,{}),m.jsx(tEe,{}),m.jsx(rEe,{}),m.jsx(mEe,{}),m.jsx(qoe,{}),m.jsx(YEe,{}),m.jsx(qEe,{}),m.jsx(pEe,{}),m.jsx(ele,{}),m.jsx(rle,{}),m.jsx(gEe,{}),m.jsx(BEe,{}),m.jsx(uEe,{}),m.jsx(zEe,{}),m.jsx(hEe,{}),m.jsx(FEe,{}),m.jsx(i2e,{}),m.jsx(h2e,{}),m.jsx(d2e,{}),m.jsx(m2e,{}),m.jsx(mr,{children:t&&m.jsx(_G,{onClose:i,initialLocation:r||void 0})})]})})}console.log(`%c DetectorApp v${Av}`,"background: #4CAF50; color: white; padding: 4px 8px; border-radius: 4px; font-weight: bold;");FB.createRoot(document.getElementById("root")).render(m.jsx(x2e,{}));export{ka as C,kr as F,FR as G,vW as I,Ra as L,ds as P,$n as S,rh as T,O0 as V,tH as a,KW as b,F0 as c,Hr as d,ud as e,Cs as f,oo as g,qp as h,vn as p,D7 as r};
//# sourceMappingURL=index-BPGqw0mp.js.map
